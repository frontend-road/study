{"id":2273,"title":"13 | 集中式配置中心的作用和原理是什么？","content":"<p>无</p>\n","comments":[{"had_liked":false,"id":2382,"user_name":"LMD","can_delete":false,"product_type":"c3","uid":1013443,"ip_address":"","ucode":"7626FBB7A4E771","user_header":"","comment_is_top":true,"comment_ctime":1516964840,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"关于《微服务架构核心20讲》课程讲义（PDF 文件），学员可复制下面链接到浏览器下载获取。 http:&#47;&#47;t.cn&#47;RQs9iTw","like_count":15},{"had_liked":false,"id":15943,"user_name":"meijing0114","can_delete":false,"product_type":"c3","uid":1012416,"ip_address":"","ucode":"B349D33E2F3ECC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/c0/b09911a0.jpg","comment_is_top":false,"comment_ctime":1531666180,"is_pvip":false,"replies":[{"id":5717,"content":"你对配置和apollo理解很深入👍","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1531973359,"ip_address":"","comment_id":15943,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"感悟1：共享内存缓存+落地可以是利器，落地一般就是文件，文件没有那么土，并不一定数据库\n感悟2：Apollo的问题是否在于多了一个客户端，这样本地就太热闹了。但是如果应用程序自己做，又稍微显得重了一些，没有抽象为本地通讯。","like_count":3,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420609,"discussion_content":"你对配置和apollo理解很深入👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531973359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10210,"user_name":"Geek_ysedro","can_delete":false,"product_type":"c3","uid":1072823,"ip_address":"","ucode":"ED2FE2FCD0F5B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5e/b7/e762deb7.jpg","comment_is_top":false,"comment_ctime":1527350612,"is_pvip":false,"replies":[{"id":3371,"content":"apollo是偏微服务应用配置的，也可以应用到如nginx或网关等偏运维场景的动态配置，但是需要一定的编程定制能力，我团队负责的网关是集成apollo动态配置的。另外偏运维配置常用ansible&#47;chef&#47;saltstack等。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1527611504,"ip_address":"","comment_id":10210,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"这个配置中心能做到也管理类似nginx、网关的配置问题吗，就是可以减轻批量部署，部分配置改动这样情况的运维痛点，因为我看到apollo是可以管理集群配置的，如果可以的话怎么做比较好呢？老师有思考过类似的偏运维的问题吗","like_count":3,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418392,"discussion_content":"apollo是偏微服务应用配置的，也可以应用到如nginx或网关等偏运维场景的动态配置，但是需要一定的编程定制能力，我团队负责的网关是集成apollo动态配置的。另外偏运维配置常用ansible/chef/saltstack等。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1527611504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191333,"user_name":"华仔","can_delete":false,"product_type":"c3","uid":1047435,"ip_address":"","ucode":"241962BCA71674","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/8b/a1feb0bf.jpg","comment_is_top":false,"comment_ctime":1584764205,"is_pvip":false,"replies":[{"id":74958,"content":"我认为apollo是目前唯一可称为企业级的开源配置中心产品。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585571359,"ip_address":"","comment_id":191333,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"disconf也挺好用","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488152,"discussion_content":"我认为apollo是目前唯一可称为企业级的开源配置中心产品。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585571359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181447,"user_name":"钱","can_delete":false,"product_type":"c3","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1582542441,"is_pvip":false,"replies":[{"id":74747,"content":"apollo是目前唯一可以称为企业级的开源配置中心","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585483328,"ip_address":"","comment_id":181447,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"集中式配置中心，我们有基于zk实现的UCC，作用确实大，各种开关线上生效，Apollo是开源的可以研究下。\n原理简单讲就是动态修改对象的属性值，通过网络通信集中的修改。","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485002,"discussion_content":"apollo是目前唯一可以称为企业级的开源配置中心","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585483328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141385,"user_name":"水心梦","can_delete":false,"product_type":"c3","uid":1355665,"ip_address":"","ucode":"6AB3FCEEECE094","user_header":"https://static001.geekbang.org/account/avatar/00/14/af/91/bcee2d6d.jpg","comment_is_top":false,"comment_ctime":1571146910,"is_pvip":false,"replies":[{"id":74647,"content":"理论上讲会有时间差和极端case，所以业务上通常要考虑配置更新&#47;生效的最终一致性。实际使用中未见明显的极端case。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585406244,"ip_address":"","comment_id":141385,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"老师，想问一下配置变更推送到各个客户端会有一些时间差吧，这样的话会有一些极端case吧","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470741,"discussion_content":"理论上讲会有时间差和极端case，所以业务上通常要考虑配置更新/生效的最终一致性。实际使用中未见明显的极端case。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585406244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21880,"user_name":"暮雨","can_delete":false,"product_type":"c3","uid":1176426,"ip_address":"","ucode":"4B7F4932446EF7","user_header":"https://static001.geekbang.org/account/avatar/00/11/f3/6a/6d82e7a3.jpg","comment_is_top":false,"comment_ctime":1535382762,"is_pvip":false,"replies":[{"id":8667,"content":"像apollo这样的配置中心，它的客户端支持配置热更新，应用引入客户端即可","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1536641921,"ip_address":"","comment_id":21880,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"配置中心，怎么保证应用服务的热加载","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422904,"discussion_content":"像apollo这样的配置中心，它的客户端支持配置热更新，应用引入客户端即可","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1536641921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9344,"user_name":"LN","can_delete":false,"product_type":"c3","uid":1096213,"ip_address":"","ucode":"B74620E8F2C6A1","user_header":"https://static001.geekbang.org/account/avatar/00/10/ba/15/cdc663fe.jpg","comment_is_top":false,"comment_ctime":1526803429,"is_pvip":false,"replies":[{"id":2857,"content":"如果用apollo配置中心，它提供客户端支持配置动态实时更新，详见其github上文档。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1526913893,"ip_address":"","comment_id":9344,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"推下去的配置，本地容器如何实现动态加载？动态加载类时这，除了通过重构classloader，还有没有更好的方式？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418037,"discussion_content":"如果用apollo配置中心，它提供客户端支持配置动态实时更新，详见其github上文档。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1526913893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":8331,"user_name":"Tony Yao","can_delete":false,"product_type":"c3","uid":1000521,"ip_address":"","ucode":"DF1C79D4F513FC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/44/49/03a70bba.jpg","comment_is_top":false,"comment_ctime":1526094651,"is_pvip":false,"replies":[{"id":2454,"content":"微服务建议用集中式配置中心，推荐携程开源的apollo，自带完善的配置管理界面","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1526137341,"ip_address":"","comment_id":8331,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"配置修改一般推荐用什么方式，文件发布还是自己做界面？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":417674,"discussion_content":"微服务建议用集中式配置中心，推荐携程开源的apollo，自带完善的配置管理界面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1526137341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214376,"user_name":"xcbeyond","can_delete":false,"product_type":"c3","uid":1585810,"ip_address":"","ucode":"96150D447BECF7","user_header":"https://static001.geekbang.org/account/avatar/00/18/32/92/8247f434.jpg","comment_is_top":false,"comment_ctime":1588733114,"is_pvip":false,"replies":[{"id":79431,"content":"你是说traefik吗，那个是一个近年比较热的反向代理(reverse proxy)，是一个云原生项目。traefik可以用做api网关，不能用做配置中心。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1588772800,"ip_address":"","comment_id":214376,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100003901,"comment_content":"对于treakfik也拥有一定的配置中心的功能，能不能简单说一下，建议使用么","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494038,"discussion_content":"你是说traefik吗，那个是一个近年比较热的反向代理(reverse proxy)，是一个云原生项目。traefik可以用做api网关，不能用做配置中心。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588772800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200878,"user_name":"郭新鹏","can_delete":false,"product_type":"c3","uid":1154281,"ip_address":"","ucode":"F9D76691B335FC","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/e9/5ba8b1a3.jpg","comment_is_top":false,"comment_ctime":1585666194,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"pull 优点一定能pull到，但有延迟，即使有网络抖动，下次也会拉到\npush 保证实时，但是有网络抖动，就不会更新到\n\n总结非常到位，之前没有思考过。","like_count":5},{"had_liked":false,"id":193150,"user_name":"程序员二师兄","can_delete":false,"product_type":"c3","uid":1205697,"ip_address":"","ucode":"C9E3B5B3358BDF","user_header":"https://static001.geekbang.org/account/avatar/00/12/65/c1/afcd981b.jpg","comment_is_top":false,"comment_ctime":1584884908,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"感谢老师推荐分享 Apollo，很nice","like_count":2},{"had_liked":false,"id":191338,"user_name":"华仔","can_delete":false,"product_type":"c3","uid":1047435,"ip_address":"","ucode":"241962BCA71674","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/8b/a1feb0bf.jpg","comment_is_top":false,"comment_ctime":1584764536,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"缓存提升高可用👍","like_count":1},{"had_liked":false,"id":375316,"user_name":"何斌","can_delete":false,"product_type":"c3","uid":1057235,"ip_address":"重庆","ucode":"674A572C4CC681","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/d3/511551e6.jpg","comment_is_top":false,"comment_ctime":1685329936,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"配置中心不可能使用push的方式，应该使用订阅的方式。","like_count":0},{"had_liked":false,"id":351506,"user_name":"青阳","can_delete":false,"product_type":"c3","uid":2139807,"ip_address":"","ucode":"3591D366BAB0B9","user_header":"https://static001.geekbang.org/account/avatar/00/20/a6/9f/3c60fffd.jpg","comment_is_top":false,"comment_ctime":1657855345,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"数据库连接池的配置都是在init后就确定了的，配置中心修改后，应该不生效吧，需要应用端做特殊处理吧","like_count":0},{"had_liked":false,"id":279743,"user_name":"旭东(Frank)","can_delete":false,"product_type":"c3","uid":1024486,"ip_address":"","ucode":"176FA629800062","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg","comment_is_top":false,"comment_ctime":1613953522,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"看来Apollo的高可用优先","like_count":0},{"had_liked":false,"id":50862,"user_name":"石头剪刀布","can_delete":false,"product_type":"c3","uid":1080353,"ip_address":"","ucode":"7659B10D189153","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq6tsM65SmllxicEqqbaHcnqOw6O541JJ8ib75qyZ0zAGLxFOpV9L5kwr1dLCvgeL1V52cOu3yZLN2g/132","comment_is_top":false,"comment_ctime":1545056444,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"disconf，和百度没有关系的。此项目处于停止维护状态。谢谢。","like_count":0},{"had_liked":false,"id":39384,"user_name":"张闯","can_delete":false,"product_type":"c3","uid":1090513,"ip_address":"","ucode":"D5AD46A8DD6FB7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a3/d1/a30a4d06.jpg","comment_is_top":false,"comment_ctime":1542260859,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100003901,"comment_content":"开发的应用程序一般都有配置文件。在运行时修改配置文件很不方便，另外在集群环境下，散落的配置文件不便于维护。\n配置中心的机制下，每个应用内不再有配置文件，而是集成了配置中心的客户端。应用程序从本地客户端中读取配置参数。配置中心客户端以某种机制与配置中心进行配置参数同步。\n开发人员登陆配置中心的管理系统调整配置参数。参数的变动会被推送到配置中心客户端，配置中心客户端也会定时去配置中心拉取最新的配置参数。","like_count":0}]}