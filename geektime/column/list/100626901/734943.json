{"id":734943,"title":"24ï½œRustå›¾åƒè¯†åˆ«ï¼šåˆ©ç”¨YOLOv8è¯†åˆ«å¯¹è±¡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨Rustå¯¹å›¾ç‰‡ä¸­çš„å¯¹è±¡è¿›è¡Œè¯†åˆ«ã€‚</p><p>å›¾åƒè¯†åˆ«æ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­çš„é‡è¦è¯¾é¢˜ï¼Œè€Œè®¡ç®—æœºè§†è§‰åˆæ˜¯AIçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç›¸å½“äºAIçš„çœ¼ç›ã€‚ç›®å‰å›¾åƒè¯†åˆ«é¢†åŸŸä½¿ç”¨æœ€å¹¿æ³›çš„æ¡†æ¶æ˜¯ YOLOï¼Œç°åœ¨å·²ç»è¿­ä»£åˆ°äº†v8ç‰ˆæœ¬ã€‚è€ŒåŸºäºRustæœºå™¨å­¦ä¹ æ¡†æ¶Candleï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç°YOLOv8ç®—æ³•ã€‚å› æ­¤ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬ç»§ç»­ä½¿ç”¨Candleæ¡†æ¶æ¥å®ç°å›¾ç‰‡çš„è¯†åˆ«ã€‚</p><p>Candleæ¡†æ¶æœ‰ä¸€ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†YOLOv8çš„ä¸€ä¸ªç®€åŒ–å®ç°ã€‚æˆ‘åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå°†è¿™ä¸ªæºç ä¸­çš„ç¤ºä¾‹ç‹¬ç«‹å‡ºæ¥ï¼Œåšæˆäº†ä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®ï¼Œæ–¹ä¾¿ä½ å­¦ä¹ ï¼ˆæŸ¥çœ‹<a href=\"https://github.com/miketang84/jikeshijian/tree/master/24-candle_yolov8\">ä»£ç åœ°å€</a>ï¼‰ã€‚</p><p><span class=\"reference\">æ³¨ï¼šè¿™èŠ‚è¯¾çš„ä»£ç é€‚ç”¨äº candle_core v0.3 ç‰ˆæœ¬ã€‚</span></p><h2>YOLOç®€ä»‹</h2><p>YOLOï¼ˆYou Only Look Onceï¼‰æ˜¯ä¸€ç§ç›®æ ‡æ£€æµ‹ç®—æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä¸€æ¬¡å‰å‘ä¼ é€’ä¸­æ£€æµ‹å‡ºå›¾åƒä¸­çš„æ‰€æœ‰ç‰©ä½“çš„ä½ç½®å’Œç±»åˆ«ã€‚å› ä¸ºåªéœ€è¦çœ‹ä¸€æ¬¡ï¼ŒYOLOè¢«ç§°ä¸ºRegion-freeæ–¹æ³•ï¼Œç›¸æ¯”äºRegion-basedæ–¹æ³•ï¼ŒYOLOä¸éœ€è¦æå‰æ‰¾åˆ°å¯èƒ½å­˜åœ¨ç›®æ ‡çš„åŒºåŸŸï¼ˆRegionï¼‰ã€‚YOLOåœ¨2016å¹´è¢«æå‡ºï¼Œå‘è¡¨åœ¨è®¡ç®—æœºè§†è§‰é¡¶ä¼šCVPRï¼ˆComputer Vision and Pattern Recognitionï¼‰ä¸Šã€‚YOLOå¯¹æ•´ä¸ªå›¾ç‰‡è¿›è¡Œé¢„æµ‹ï¼Œå¹¶ä¸”å®ƒä¼šä¸€æ¬¡æ€§è¾“å‡ºæ‰€æœ‰æ£€æµ‹åˆ°çš„ç›®æ ‡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»åˆ«å’Œä½ç½®ã€‚</p><!-- [[[read_end]]] --><p>YOLOä¹Ÿä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œå›¾åƒè¯†åˆ«ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæ˜¯æ¨ç†çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¥ç»ç½‘ç»œçš„é¢„è®­ç»ƒæ¨¡å‹æ–‡ä»¶ã€‚ä¸‹é¢ä½ ä¼šçœ‹åˆ°ï¼Œåœ¨è¿è¡Œç¤ºä¾‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨ä»HuggingFaceä¸‹è½½å¯¹åº”çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</p><p>YOLOv8çš„æ¨¡å‹ç»“æ„æ¯”èµ·ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä¼šå¤æ‚ä¸€äº›ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®˜æ–¹æ•´ç†çš„å›¾ç‰‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9e/18/9eaeb50e93568443412d894bcfe87018.jpg?wh=3250x3402\" alt=\"\" title=\"å›¾ç‰‡æ¥æºï¼šhttps://github.com/ultralytics/ultralytics/issues/189\"></p><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä¸»è¦æ˜¯å»ä½¿ç”¨ï¼Œä¸å±•å¼€å…³äºè¿™ä¸ªæ¨¡å‹çš„è®²è§£ã€‚ç›®å‰å®˜æ–¹çš„é¢„è®­ç»ƒæ¨¡å‹åˆ†æˆ5ä¸ªã€‚</p><ul>\n<li>Nï¼šnanoã€‚æ¨¡å‹æœ€å°ã€‚æ¢æµ‹é€Ÿåº¦æœ€å¿«ï¼Œç²¾åº¦æœ€ä½ã€‚</li>\n<li>Sï¼šsmallï¼Œæ¨¡å‹æ¯”nanoå¤§ã€‚</li>\n<li>Mï¼šmiddleï¼Œæ¨¡å‹æ¯”smallå¤§ã€‚</li>\n<li>Lï¼šlargeï¼Œæ¨¡å‹æ¯”middleå¤§ï¼Œæ¯”xå°ã€‚</li>\n<li>Xï¼šextra largeï¼Œæ¨¡å‹æœ€å¤§ã€‚æ¢æµ‹é€Ÿåº¦æœ€æ…¢ï¼Œç²¾åº¦æœ€é«˜ã€‚</li>\n</ul><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°æ¥æŒ‡å®šé€‰æ‹©å“ªä¸ªæ¨¡å‹ã€‚</p><h2>YOLOv8çš„èƒ½åŠ›</h2><p>YOLOå‘å±•åˆ°ç¬¬8ä»£å·²ç»å¾ˆå¼ºå¤§äº†ã€‚å®ƒå¯ä»¥å¯¹å›¾åƒåšåˆ†ç±»ã€æ¢æµ‹ã€åˆ†æ®µã€è½¨è¿¹ã€å§¿åŠ¿ç­‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/01/a26647d656430b8574405c35bcd94b01.png?wh=1920x480\" alt=\"å›¾ç‰‡\" title=\"å›¾ç‰‡æ¥æºï¼šhttps://raw.githubusercontent.com/ultralytics/assets/main/im/banner-tasks.png\"></p><p>äº†è§£äº†YOLOçš„èƒ½åŠ›ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹å®é™…ç”¨èµ·æ¥ã€‚</p><h2>åŠ¨æ‰‹å®éªŒ</h2><p>ä¸‹è½½æºç ï¼š</p><pre><code class=\"language-plain\">git clone https://github.com/miketang84/jikeshijian\ncd jikeshijian/24-candle_yolov8\n</code></pre><h3>ç‰©ä½“æ¢æµ‹</h3><p>å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/44/b8/44442ec72a66cf7c88dd4be951d043b8.jpg?wh=800x533\" alt=\"å›¾ç‰‡\"></p><p>ç¼–è¯‘è¿è¡Œä¸‹é¢è¿™è¡Œä»£ç ã€‚</p><pre><code class=\"language-plain\">cargo run --release -- assets/football.jpg --which m\n</code></pre><p>è¯·æ³¨æ„ï¼Œè¿™ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šè”ç½‘ä»HuggingFaceä¸Šä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼Œéœ€è¦ç§‘å­¦ä¸Šç½‘ç¯å¢ƒã€‚</p><p>è¿è¡Œè¾“å‡ºï¼š</p><pre><code class=\"language-plain\">$ cargo run --release -- assets/football.jpg --which m\nProxyChains-3.1 (http://proxychains.sf.net)\n&nbsp; &nbsp; Finished release [optimized] target(s) in 0.08s\n&nbsp; &nbsp; &nbsp;Running `target/release/candle_demo_yolov8 assets/football.jpg --which m`\nRunning on CPU, to run on GPU, build this example with `--features cuda`\nmodel loaded\nprocessing assets/football.jpg\ngenerated predictions Tensor[dims 84, 5460; f32]\nperson: Bbox { xmin: 0.15629578, ymin: 81.735344, xmax: 99.46689, ymax: 281.7202, confidence: 0.94353473, data: [] }\nperson: Bbox { xmin: 433.88196, ymin: 92.59643, xmax: 520.25476, ymax: 248.76715, confidence: 0.933658, data: [] }\nperson: Bbox { xmin: 569.20465, ymin: 34.737877, xmax: 639.8049, ymax: 269.4999, confidence: 0.927611, data: [] }\nperson: Bbox { xmin: 209.33649, ymin: 16.313568, xmax: 388.09424, ymax: 388.7763, confidence: 0.92696583, data: [] }\nperson: Bbox { xmin: 169.212, ymin: 15.2717285, xmax: 312.59946, ymax: 345.16046, confidence: 0.900463, data: [] }\nperson: Bbox { xmin: 626.709, ymin: 65.91608, xmax: 639.791, ymax: 86.72856, confidence: 0.33487964, data: [] }\nsports ball: Bbox { xmin: 417.45734, ymin: 315.16333, xmax: 484.62384, ymax: 372.86432, confidence: 0.93880117, data: [] }\nwriting \"assets/football.pp.jpg\"\n</code></pre><p>åœ¨ assets ç›®å½•ä¸‹ç”Ÿæˆ football.pp.jpg æ–‡ä»¶ï¼Œæ‰“å¼€åæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/da/07/da8d52a0e6677977701cfe339d2d3007.jpg?wh=800x533\" alt=\"å›¾ç‰‡\"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒYolo æ­£ç¡®è¯†åˆ«äº†6ä¸ªäººï¼Œå’Œä¸€ä¸ªè¿åŠ¨çƒã€‚</p><h3>å§¿åŠ¿æ¢æµ‹</h3><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå¯¹åŒä¸€å¼ å›¾ç‰‡ï¼Œè¿è¡Œå§¿åŠ¿æ¢æµ‹çš„æ•ˆæœã€‚</p><pre><code class=\"language-plain\">cargo run --release -- assets/football.jpg --which m --task pose\n</code></pre><p>æˆ‘ä»¬çš„å·¥å…·åœ¨ assets ç›®å½•ä¸‹ç”Ÿæˆ football.pp.jpg æ–‡ä»¶ï¼Œæ‰“å¼€åæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/72/25/7239ed2af26ed0908560833838696025.png?wh=800x533\" alt=\"å›¾ç‰‡\"></p><p>æ•ˆæœæ˜¯ä¸æ˜¯å¾ˆcoolã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™æ¬¡å®æˆ˜çš„ä»£ç ã€‚</p><h2>æºç è§£é‡Š</h2><p>YOLOv8 ç¥ç»ç½‘ç»œæ¨¡å‹çš„åŸç†æ¯”è¾ƒå¤æ‚ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬ä¸»è¦è®²è§£è¿™ä¸ªç¤ºä¾‹ä¸­Rustçš„ç”¨æ³•ï¼Œä»ä¸­å¯ä»¥å­¦åˆ°ä¸å°‘Rustç›¸å…³çŸ¥è¯†ã€‚</p><pre><code class=\"language-plain\">// #[cfg(feature = \"mkl\")]\n// extern crate intel_mkl_src;\n\n// #[cfg(feature = \"accelerate\")]\n// extern crate accelerate_src;\n\nmod model;\nuse model::{Multiples, YoloV8, YoloV8Pose};\nmod coco_classes;\n\nuse candle_core::utils::{cuda_is_available, metal_is_available};\nuse candle_core::{DType, Device, IndexOp, Result, Tensor};\nuse candle_nn::{Module, VarBuilder};\nuse candle_transformers::object_detection::{non_maximum_suppression, Bbox, KeyPoint};\nuse clap::{Parser, ValueEnum};\nuse image::DynamicImage;\n\n// Keypoints as reported by ChatGPT :)\n// Nose\n// Left Eye\n// Right Eye\n// Left Ear\n// Right Ear\n// Left Shoulder\n// Right Shoulder\n// Left Elbow\n// Right Elbow\n// Left Wrist\n// Right Wrist\n// Left Hip\n// Right Hip\n// Left Knee\n// Right Knee\n// Left Ankle\n// Right Ankle\nconst KP_CONNECTIONS: [(usize, usize); 16] = [\n&nbsp; &nbsp; (0, 1),\n&nbsp; &nbsp; (0, 2),\n&nbsp; &nbsp; (1, 3),\n&nbsp; &nbsp; (2, 4),\n&nbsp; &nbsp; (5, 6),\n&nbsp; &nbsp; (5, 11),\n&nbsp; &nbsp; (6, 12),\n&nbsp; &nbsp; (11, 12),\n&nbsp; &nbsp; (5, 7),\n&nbsp; &nbsp; (6, 8),\n&nbsp; &nbsp; (7, 9),\n&nbsp; &nbsp; (8, 10),\n&nbsp; &nbsp; (11, 13),\n&nbsp; &nbsp; (12, 14),\n&nbsp; &nbsp; (13, 15),\n&nbsp; &nbsp; (14, 16),\n];\n\n\n\n// è·å–è®¾å¤‡ï¼ŒCpuè¿˜æ˜¯Cudaæˆ–Metal\npub fn get_device(cpu: bool) -&gt; Result&lt;Device&gt; {\n&nbsp; &nbsp; if cpu {\n&nbsp; &nbsp; &nbsp; &nbsp; Ok(Device::Cpu)\n&nbsp; &nbsp; } else if cuda_is_available() {\n&nbsp; &nbsp; &nbsp; &nbsp; Ok(Device::new_cuda(0)?)\n&nbsp; &nbsp; } else if metal_is_available() {\n&nbsp; &nbsp; &nbsp; &nbsp; Ok(Device::new_metal(0)?)\n&nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; #[cfg(all(target_os = \"macos\", target_arch = \"aarch64\"))]\n&nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; println!(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"Running on CPU, to run on GPU(metal), build this example with `--features metal`\"\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; #[cfg(not(all(target_os = \"macos\", target_arch = \"aarch64\")))]\n&nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; println!(\"Running on CPU, to run on GPU, build this example with `--features cuda`\");\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; Ok(Device::Cpu)\n&nbsp; &nbsp; }\n}\n// æŠ¥å‘Šå¯¹è±¡æ¢æµ‹çš„ç»“æœï¼Œä»¥åŠç”¨å›¾åƒå¤„ç†å·¥å…·åœ¨å›¾ä¸Šç”»å‡ºæ¥æ ‡æ³¨\npub fn report_detect(\n&nbsp; &nbsp; pred: &amp;Tensor,\n&nbsp; &nbsp; img: DynamicImage,\n&nbsp; &nbsp; w: usize,\n&nbsp; &nbsp; h: usize,\n&nbsp; &nbsp; confidence_threshold: f32,\n&nbsp; &nbsp; nms_threshold: f32,\n&nbsp; &nbsp; legend_size: u32,\n) -&gt; Result&lt;DynamicImage&gt; {\n&nbsp; &nbsp; let pred = pred.to_device(&amp;Device::Cpu)?;\n&nbsp; &nbsp; let (pred_size, npreds) = pred.dims2()?;\n&nbsp; &nbsp; let nclasses = pred_size - 4;\n&nbsp; &nbsp; \n&nbsp; &nbsp; let mut bboxes: Vec&lt;Vec&lt;Bbox&lt;Vec&lt;KeyPoint&gt;&gt;&gt;&gt; = (0..nclasses).map(|_| vec![]).collect();\n&nbsp; &nbsp; // é€‰å‡ºç¬¦åˆç½®ä¿¡åŒºé—´çš„ç»“æœ\n&nbsp; &nbsp; for index in 0..npreds {\n&nbsp; &nbsp; &nbsp; &nbsp; let pred = Vec::&lt;f32&gt;::try_from(pred.i((.., index))?)?;\n&nbsp; &nbsp; &nbsp; &nbsp; let confidence = *pred[4..].iter().max_by(|x, y| x.total_cmp(y)).unwrap();\n&nbsp; &nbsp; &nbsp; &nbsp; if confidence &gt; confidence_threshold {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let mut class_index = 0;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for i in 0..nclasses {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if pred[4 + i] &gt; pred[4 + class_index] {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; class_index = i\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if pred[class_index + 4] &gt; 0. {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let bbox = Bbox {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmin: pred[0] - pred[2] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ymin: pred[1] - pred[3] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmax: pred[0] + pred[2] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ymax: pred[1] + pred[3] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; confidence,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data: vec![],\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bboxes[class_index].push(bbox)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; non_maximum_suppression(&amp;mut bboxes, nms_threshold);\n\n&nbsp; &nbsp; // åœ¨åŸå›¾ä¸Šæ ‡æ³¨ï¼Œå¹¶æ‰“å°æ ‡æ³¨çš„æ¡†çš„ä¿¡æ¯\n&nbsp; &nbsp; let (initial_h, initial_w) = (img.height(), img.width());\n&nbsp; &nbsp; let w_ratio = initial_w as f32 / w as f32;\n&nbsp; &nbsp; let h_ratio = initial_h as f32 / h as f32;\n&nbsp; &nbsp; let mut img = img.to_rgb8();\n&nbsp; &nbsp; let font = Vec::from(include_bytes!(\"roboto-mono-stripped.ttf\") as &amp;[u8]);\n&nbsp; &nbsp; let font = rusttype::Font::try_from_vec(font);\n&nbsp; &nbsp; for (class_index, bboxes_for_class) in bboxes.iter().enumerate() {\n&nbsp; &nbsp; &nbsp; &nbsp; for b in bboxes_for_class.iter() {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; println!(\"{}: {:?}\", coco_classes::NAMES[class_index], b);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let xmin = (b.xmin * w_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let ymin = (b.ymin * h_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let dx = (b.xmax - b.xmin) * w_ratio;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let dy = (b.ymax - b.ymin) * h_ratio;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if dx &gt;= 0. &amp;&amp; dy &gt;= 0. {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_hollow_rect_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::rect::Rect::at(xmin, ymin).of_size(dx as u32, dy as u32),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([255, 0, 0]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if legend_size &gt; 0 {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if let Some(font) = font.as_ref() {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_filled_rect_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::rect::Rect::at(xmin, ymin).of_size(dx as u32, legend_size),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([170, 0, 0]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let legend = format!(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"{}&nbsp; &nbsp;{:.0}%\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; coco_classes::NAMES[class_index],\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100. * b.confidence\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_text_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([255, 255, 255]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmin,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ymin,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rusttype::Scale::uniform(legend_size as f32 - 1.),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;legend,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n&nbsp; &nbsp; Ok(DynamicImage::ImageRgb8(img))\n}\n// æŠ¥å‘Šå§¿æ€æ¢æµ‹çš„ç»“æœï¼Œä»¥åŠç”¨å›¾åƒå¤„ç†å·¥å…·åœ¨å›¾ä¸Šç”»å‡ºæ¥æ ‡æ³¨\npub fn report_pose(\n&nbsp; &nbsp; pred: &amp;Tensor,\n&nbsp; &nbsp; img: DynamicImage,\n&nbsp; &nbsp; w: usize,\n&nbsp; &nbsp; h: usize,\n&nbsp; &nbsp; confidence_threshold: f32,\n&nbsp; &nbsp; nms_threshold: f32,\n) -&gt; Result&lt;DynamicImage&gt; {\n&nbsp; &nbsp; let pred = pred.to_device(&amp;Device::Cpu)?;\n&nbsp; &nbsp; let (pred_size, npreds) = pred.dims2()?;\n&nbsp; &nbsp; if pred_size != 17 * 3 + 4 + 1 {\n&nbsp; &nbsp; &nbsp; &nbsp; candle_core::bail!(\"unexpected pred-size {pred_size}\");\n&nbsp; &nbsp; }\n&nbsp; &nbsp; let mut bboxes = vec![];\n&nbsp; &nbsp; // é€‰å‡ºç¬¦åˆç½®ä¿¡åŒºé—´çš„ç»“æœ\n&nbsp; &nbsp; for index in 0..npreds {\n&nbsp; &nbsp; &nbsp; &nbsp; let pred = Vec::&lt;f32&gt;::try_from(pred.i((.., index))?)?;\n&nbsp; &nbsp; &nbsp; &nbsp; let confidence = pred[4];\n&nbsp; &nbsp; &nbsp; &nbsp; if confidence &gt; confidence_threshold {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let keypoints = (0..17)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .map(|i| KeyPoint {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x: pred[3 * i + 5],\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y: pred[3 * i + 6],\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mask: pred[3 * i + 7],\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .collect::&lt;Vec&lt;_&gt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let bbox = Bbox {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmin: pred[0] - pred[2] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ymin: pred[1] - pred[3] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xmax: pred[0] + pred[2] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ymax: pred[1] + pred[3] / 2.,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; confidence,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data: keypoints,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bboxes.push(bbox)\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; let mut bboxes = vec![bboxes];\n&nbsp; &nbsp; non_maximum_suppression(&amp;mut bboxes, nms_threshold);\n&nbsp; &nbsp; let bboxes = &amp;bboxes[0];\n\n&nbsp; &nbsp; // åœ¨åŸå›¾ä¸Šæ ‡æ³¨ï¼Œå¹¶æ‰“å°æ ‡æ³¨çš„æ¡†å’Œå§¿åŠ¿çš„ä¿¡æ¯\n&nbsp; &nbsp; let (initial_h, initial_w) = (img.height(), img.width());\n&nbsp; &nbsp; let w_ratio = initial_w as f32 / w as f32;\n&nbsp; &nbsp; let h_ratio = initial_h as f32 / h as f32;\n&nbsp; &nbsp; let mut img = img.to_rgb8();\n&nbsp; &nbsp; for b in bboxes.iter() {\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"{b:?}\");\n&nbsp; &nbsp; &nbsp; &nbsp; let xmin = (b.xmin * w_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; let ymin = (b.ymin * h_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; let dx = (b.xmax - b.xmin) * w_ratio;\n&nbsp; &nbsp; &nbsp; &nbsp; let dy = (b.ymax - b.ymin) * h_ratio;\n&nbsp; &nbsp; &nbsp; &nbsp; if dx &gt;= 0. &amp;&amp; dy &gt;= 0. {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_hollow_rect_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::rect::Rect::at(xmin, ymin).of_size(dx as u32, dy as u32),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([255, 0, 0]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; for kp in b.data.iter() {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if kp.mask &lt; 0.6 {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let x = (kp.x * w_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let y = (kp.y * h_ratio) as i32;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_filled_circle_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (x, y),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([0, 255, 0]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; for &amp;(idx1, idx2) in KP_CONNECTIONS.iter() {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let kp1 = &amp;b.data[idx1];\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let kp2 = &amp;b.data[idx2];\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if kp1.mask &lt; 0.6 || kp2.mask &lt; 0.6 {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; imageproc::drawing::draw_line_segment_mut(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mut img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (kp1.x * w_ratio, kp1.y * h_ratio),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (kp2.x * w_ratio, kp2.y * h_ratio),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::Rgb([255, 255, 0]),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n&nbsp; &nbsp; Ok(DynamicImage::ImageRgb8(img))\n}\n// é€‰æ‹©æ¨¡å‹å°ºå¯¸\n#[derive(Clone, Copy, ValueEnum, Debug)]\nenum Which {\n&nbsp; &nbsp; N,\n&nbsp; &nbsp; S,\n&nbsp; &nbsp; M,\n&nbsp; &nbsp; L,\n&nbsp; &nbsp; X,\n}\n// å¯¹è±¡æ¢æµ‹ä»»åŠ¡è¿˜æ˜¯å§¿åŠ¿æ¢æµ‹ä»»åŠ¡\n#[derive(Clone, Copy, ValueEnum, Debug)]\nenum YoloTask {\n&nbsp; &nbsp; Detect,\n&nbsp; &nbsp; Pose,\n}\n// å‘½ä»¤è¡Œå‚æ•°å®šä¹‰ï¼ŒåŸºäºClap\n#[derive(Parser, Debug)]\n#[command(author, version, about, long_about = None)]\npub struct Args {\n&nbsp; &nbsp; /// æ˜¯å¦è¿è¡Œåœ¨CPUä¸Šé¢\n&nbsp; &nbsp; #[arg(long)]\n&nbsp; &nbsp; cpu: bool,\n\n&nbsp; &nbsp; /// æ˜¯å¦è®°å½•æ—¥å¿—\n&nbsp; &nbsp; #[arg(long)]\n&nbsp; &nbsp; tracing: bool,\n\n&nbsp; &nbsp; /// æ¨¡å‹æ–‡ä»¶è·¯å¾„\n&nbsp; &nbsp; #[arg(long)]\n&nbsp; &nbsp; model: Option&lt;String&gt;,\n\n&nbsp; &nbsp; /// ç”¨å“ªä¸€ä¸ªæ¨¡å‹\n&nbsp; &nbsp; #[arg(long, value_enum, default_value_t = Which::S)]\n&nbsp; &nbsp; which: Which,\n\n&nbsp; &nbsp; images: Vec&lt;String&gt;,\n\n&nbsp; &nbsp; /// æ¨¡å‹ç½®ä¿¡é—¨æ§›\n&nbsp; &nbsp; #[arg(long, default_value_t = 0.25)]\n&nbsp; &nbsp; confidence_threshold: f32,\n\n&nbsp; &nbsp; /// non-maximum suppressionçš„é˜ˆå€¼\n&nbsp; &nbsp; #[arg(long, default_value_t = 0.45)]\n&nbsp; &nbsp; nms_threshold: f32,\n\n&nbsp; &nbsp; /// è¦æ‰§è¡Œçš„ä»»åŠ¡\n&nbsp; &nbsp; #[arg(long, default_value = \"detect\")]\n&nbsp; &nbsp; task: YoloTask,\n\n&nbsp; &nbsp; /// æ ‡æ³¨çš„å­—ä½“çš„å¤§å°\n&nbsp; &nbsp; #[arg(long, default_value_t = 14)]\n&nbsp; &nbsp; legend_size: u32,\n}\n\nimpl Args {\n&nbsp; &nbsp; fn model(&amp;self) -&gt; anyhow::Result&lt;std::path::PathBuf&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; let path = match &amp;self.model {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Some(model) =&gt; std::path::PathBuf::from(model),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; None =&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let api = hf_hub::api::sync::Api::new()?;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let api = api.model(\"lmz/candle-yolo-v8\".to_string());\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let size = match self.which {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Which::N =&gt; \"n\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Which::S =&gt; \"s\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Which::M =&gt; \"m\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Which::L =&gt; \"l\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Which::X =&gt; \"x\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let task = match self.task {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; YoloTask::Pose =&gt; \"-pose\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; YoloTask::Detect =&gt; \"\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; api.get(&amp;format!(\"yolov8{size}{task}.safetensors\"))?\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; Ok(path)\n&nbsp; &nbsp; }\n}\n\npub trait Task: Module + Sized {\n&nbsp; &nbsp; fn load(vb: VarBuilder, multiples: Multiples) -&gt; Result&lt;Self&gt;;\n&nbsp; &nbsp; fn report(\n&nbsp; &nbsp; &nbsp; &nbsp; pred: &amp;Tensor,\n&nbsp; &nbsp; &nbsp; &nbsp; img: DynamicImage,\n&nbsp; &nbsp; &nbsp; &nbsp; w: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; h: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; confidence_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; nms_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; legend_size: u32,\n&nbsp; &nbsp; ) -&gt; Result&lt;DynamicImage&gt;;\n}\n// Yolov8ä¸ºå¯¹è±¡æ¢æµ‹çš„ç±»å‹è½½ä½“\nimpl Task for YoloV8 {\n&nbsp; &nbsp; fn load(vb: VarBuilder, multiples: Multiples) -&gt; Result&lt;Self&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; YoloV8::load(vb, multiples, /* num_classes=*/ 80)\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; fn report(\n&nbsp; &nbsp; &nbsp; &nbsp; pred: &amp;Tensor,\n&nbsp; &nbsp; &nbsp; &nbsp; img: DynamicImage,\n&nbsp; &nbsp; &nbsp; &nbsp; w: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; h: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; confidence_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; nms_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; legend_size: u32,\n&nbsp; &nbsp; ) -&gt; Result&lt;DynamicImage&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; report_detect(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pred,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; img,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; w,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; confidence_threshold,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nms_threshold,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; legend_size,\n&nbsp; &nbsp; &nbsp; &nbsp; )\n&nbsp; &nbsp; }\n}\n// YoloV8Poseä¸ºå§¿åŠ¿æ¢æµ‹çš„ç±»å‹è½½ä½“\nimpl Task for YoloV8Pose {\n&nbsp; &nbsp; fn load(vb: VarBuilder, multiples: Multiples) -&gt; Result&lt;Self&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; YoloV8Pose::load(vb, multiples, /* num_classes=*/ 1, (17, 3))\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; fn report(\n&nbsp; &nbsp; &nbsp; &nbsp; pred: &amp;Tensor,\n&nbsp; &nbsp; &nbsp; &nbsp; img: DynamicImage,\n&nbsp; &nbsp; &nbsp; &nbsp; w: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; h: usize,\n&nbsp; &nbsp; &nbsp; &nbsp; confidence_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; nms_threshold: f32,\n&nbsp; &nbsp; &nbsp; &nbsp; _legend_size: u32,\n&nbsp; &nbsp; ) -&gt; Result&lt;DynamicImage&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; report_pose(pred, img, w, h, confidence_threshold, nms_threshold)\n&nbsp; &nbsp; }\n}\n// ä¸»ä½“è¿è¡Œé€»è¾‘\npub fn run&lt;T: Task&gt;(args: Args) -&gt; anyhow::Result&lt;()&gt; {\n&nbsp; &nbsp; let device = get_device(args.cpu)?;\n&nbsp; &nbsp; // é€‰æ‹©æ¨¡å‹å°ºå¯¸ï¼ŒåŠ è½½æ¨¡å‹æƒé‡å‚æ•°è¿›æ¥\n&nbsp; &nbsp; let multiples = match args.which {\n&nbsp; &nbsp; &nbsp; &nbsp; Which::N =&gt; Multiples::n(),\n&nbsp; &nbsp; &nbsp; &nbsp; Which::S =&gt; Multiples::s(),\n&nbsp; &nbsp; &nbsp; &nbsp; Which::M =&gt; Multiples::m(),\n&nbsp; &nbsp; &nbsp; &nbsp; Which::L =&gt; Multiples::l(),\n&nbsp; &nbsp; &nbsp; &nbsp; Which::X =&gt; Multiples::x(),\n&nbsp; &nbsp; };\n&nbsp; &nbsp; let model = args.model()?;\n&nbsp; &nbsp; let vb = unsafe { VarBuilder::from_mmaped_safetensors(&amp;[model], DType::F32, &amp;device)? };\n&nbsp; &nbsp; let model = T::load(vb, multiples)?;\n&nbsp; &nbsp; println!(\"model loaded\");\n&nbsp; &nbsp; for image_name in args.images.iter() {\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"processing {image_name}\");\n&nbsp; &nbsp; &nbsp; &nbsp; let mut image_name = std::path::PathBuf::from(image_name);\n&nbsp; &nbsp; &nbsp; &nbsp; let original_image = image::io::Reader::open(&amp;image_name)?\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .decode()\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .map_err(candle_core::Error::wrap)?;\n&nbsp; &nbsp; &nbsp; &nbsp; let (width, height) = {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let w = original_image.width() as usize;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let h = original_image.height() as usize;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if w &lt; h {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let w = w * 640 / h;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (w / 32 * 32, 640)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let h = h * 640 / w;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (640, h / 32 * 32)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; let image_t = {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let img = original_image.resize_exact(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width as u32,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height as u32,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; image::imageops::FilterType::CatmullRom,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let data = img.to_rgb8().into_raw();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tensor::from_vec(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (img.height() as usize, img.width() as usize, 3),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;device,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )?\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .permute((2, 0, 1))?\n&nbsp; &nbsp; &nbsp; &nbsp; };\n&nbsp; &nbsp; &nbsp; &nbsp; let image_t = (image_t.unsqueeze(0)?.to_dtype(DType::F32)? * (1. / 255.))?;\n&nbsp; &nbsp; &nbsp; &nbsp; let predictions = model.forward(&amp;image_t)?.squeeze(0)?;\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"generated predictions {predictions:?}\");\n&nbsp; &nbsp; &nbsp; &nbsp; let image_t = T::report(\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;predictions,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; original_image,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args.confidence_threshold,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args.nms_threshold,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; args.legend_size,\n&nbsp; &nbsp; &nbsp; &nbsp; )?;\n&nbsp; &nbsp; &nbsp; &nbsp; image_name.set_extension(\"pp.jpg\");\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"writing {image_name:?}\");\n&nbsp; &nbsp; &nbsp; &nbsp; image_t.save(image_name)?\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; Ok(())\n}\n// ç¨‹åºå…¥å£\npub fn main() -&gt; anyhow::Result&lt;()&gt; {\n&nbsp; &nbsp; use tracing_chrome::ChromeLayerBuilder;\n&nbsp; &nbsp; use tracing_subscriber::prelude::*;\n\n&nbsp; &nbsp; let args = Args::parse();\n\n&nbsp; &nbsp; let _guard = if args.tracing {\n&nbsp; &nbsp; &nbsp; &nbsp; let (chrome_layer, guard) = ChromeLayerBuilder::new().build();\n&nbsp; &nbsp; &nbsp; &nbsp; tracing_subscriber::registry().with(chrome_layer).init();\n&nbsp; &nbsp; &nbsp; &nbsp; Some(guard)\n&nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; None\n&nbsp; &nbsp; };\n\n&nbsp; &nbsp; match args.task {\n&nbsp; &nbsp; &nbsp; &nbsp; YoloTask::Detect =&gt; run::&lt;YoloV8&gt;(args)?,\n&nbsp; &nbsp; &nbsp; &nbsp; YoloTask::Pose =&gt; run::&lt;YoloV8Pose&gt;(args)?,\n&nbsp; &nbsp; }\n&nbsp; &nbsp; Ok(())\n}\n</code></pre><p>æˆ‘æŒ‘é€‰é‡Œé¢ä¸€äº›é‡è¦çš„å†…å®¹æ¥è®²è§£ä¸€ä¸‹ã€‚</p><p>ç¬¬7ï½8è¡Œï¼ŒåŠ è½½æ¨¡å‹æ¨¡å—ã€‚YOLOv8çš„æ¨¡å‹å®ç°éƒ½æ”¾åœ¨è¿™é‡Œé¢ï¼Œå®ƒåœ¨Candleçš„å¹³å°åŸºç¡€ä¸Šå®ç°äº†ä¸€ä¸ªç®€æ˜“ç‰ˆæœ¬çš„ Darknet ç¥ç»ç½‘ç»œå¼•æ“ã€‚ç¬¬9è¡Œï¼ŒåŠ è½½cocoæ•°æ®é›†åˆ†ç±»è¡¨ã€‚YOLOv8å¯¹æ•°æ®åˆ†æˆ80ç§ç±»åˆ«ã€‚ä½ å¯ä»¥æ‰“å¼€ coco_classes.rs æ–‡ä»¶æŸ¥çœ‹ã€‚</p><p>ç¬¬11ï½14è¡Œï¼Œå¼•å…¥ Candle åŸºç¡€ç»„ä»¶ã€‚ç¬¬15è¡Œå¼•ç”¨clapèµ‹èƒ½å‘½ä»¤è¡ŒåŠŸèƒ½ã€‚è¿™ä¸ªåœ¨ä¸Šä¸€è®²ä¸­å·²ç»è®²è¿‡äº†ã€‚ç¬¬16è¡Œå¼•å…¥ image crateã€‚æˆ‘ä»¬åœ¨è¿™ä¸ªä¾‹å­é‡Œå¤„ç†å›¾ç‰‡ä½¿ç”¨çš„æ˜¯ image å’Œ imageproc ä¸¤ä¸ª crateã€‚</p><p>ç¬¬36ï½53è¡Œæ˜¯äººä½“å§¿åŠ¿çš„å‚æ•°é…ç½® â€KP_CONNECTIONSã€‚</p><p>ç¬¬57ï½77è¡Œï¼Œæ˜¯åœ¨ candle ä¸­è·å–èƒ½ä½¿ç”¨çš„è®¾å¤‡çš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒLinuxå’ŒWindowsä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ CUDAï¼Œmacä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Metalã€‚</p><p>ç¬¬79ï½167è¡Œï¼Œreport_detect æ˜¯ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå¯¹è±¡æ¢æµ‹çš„ä¸šåŠ¡ä»£ç ã€‚ç¬¬169ï½258è¡Œï¼Œreport_pose æ˜¯ç¬¬äºŒä¸ªä»»åŠ¡ï¼Œå§¿åŠ¿æ¢æµ‹çš„ä¸šåŠ¡ä»£ç ã€‚è¿™ä¸¤ä¸ªä»»åŠ¡æˆ‘ä»¬ç­‰ä¼šå„¿è¿˜ä¼šå†è¯´åˆ°ã€‚</p><p>ç¬¬260ï½267è¡Œï¼Œå®šä¹‰é€‰ç”¨å“ªä¸ªæ¨¡å‹ï¼Œåˆ†åˆ«å¯¹åº”å‰é¢è®²åˆ°çš„ Nã€Sã€Mã€Lã€Xã€‚ç¬¬269ï½273è¡Œï¼Œå®šä¹‰å¯¹è±¡æ¢æµ‹å’Œå§¿åŠ¿æ¢æµ‹ä¸¤ä¸ªä¸åŒçš„ä»»åŠ¡ã€‚ç¬¬275ï½311è¡Œï¼Œå®šä¹‰å‘½ä»¤è¡Œå‚æ•°å¯¹è±¡Argsï¼Œä½ å¯ä»¥å…³æ³¨ä¸€ä¸‹å„ä¸ªå­—æ®µçš„é»˜è®¤å€¼ã€‚ç¬¬313ï½336è¡Œï¼Œå®šä¹‰modelå‡½æ•°ï¼Œå®é™…æ˜¯åŠ è½½åˆ°æ¨¡å‹çš„æ­£ç¡®è·¯å¾„ï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œå°±ä¼šä»HuggingFaceä¸Šä¸‹è½½ã€‚</p><p>ç¬¬338ï½349è¡Œï¼Œå®šä¹‰Task traitï¼Œå®ƒä¾èµ–å¦å¤–ä¸¤ä¸ªtraitï¼šModuleå’ŒSizedã€‚Moduleæ¥è‡ª <a href=\"https://docs.rs/candle-nn/latest/candle_nn/trait.Module.html\">candle_nn crate</a>ï¼Œè¡¨ç¤ºç¥ç»ç½‘ç»œä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæœ‰å‘å‰æ¨ç†forwardçš„åŠŸèƒ½ã€‚Sizedæ¥è‡ª <a href=\"https://doc.rust-lang.org/std/marker/trait.Sized.html\">Rust std æ ‡å‡†åº“</a>ï¼Œè¡¨ç¤ºè¢«å®ç°çš„ç±»å‹æ˜¯å›ºå®šå°ºå¯¸çš„ã€‚</p><p>ç¬¬351ï½375è¡Œï¼Œä¸ºYOLOv8å®ç°Task traitï¼ŒYOLOv8 å°±æ˜¯æˆ‘ä»¬ç”¨äºç›®æ ‡æ¢æµ‹çš„ä»»åŠ¡æ‰¿è½½ç±»å‹ã€‚ç¬¬377ï½393ï¼Œä¸ºYOLOv8Poseå®ç°Task traitï¼ŒYOLOv8Poseå°±æ˜¯æˆ‘ä»¬ç”¨äºå§¿åŠ¿æ¢æµ‹çš„ä»»åŠ¡æ‰¿è½½ç±»å‹ã€‚</p><p>ç¬¬395ï½459è¡Œæ˜¯ä¸šåŠ¡å†…å®¹ã€‚ç¬¬461ï½480è¡Œæ˜¯mainå‡½æ•°ï¼Œé‡Œé¢åšäº†ä¸€äº›æ—¥å¿—é…ç½®ï¼Œå¹¶ä¸”æ ¹æ®ä»»åŠ¡ç±»å‹åˆ†é…åˆ°YOLOv8æˆ–YOLOv8Poseä¸¤ä¸ªä¸åŒçš„ä»»åŠ¡å»ã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™é‡Œä½¿ç”¨äº† <code>run::&lt;YoloV8&gt;(args)</code> è¿™ç§å†™æ³•ï¼Œå†å¯¹ç…§runçš„å‡½æ•°ç­¾åï¼š</p><pre><code class=\"language-plain\">pub fn run&lt;T: Task&gt;(args: Args) -&gt; anyhow::Result&lt;()&gt; {\n</code></pre><p>è¿™ä¸ªå‡½æ•°ç­¾åä¸­æœ‰ä¸€ä¸ªç±»å‹å‚æ•°Tï¼Œè¢«Taskçº¦æŸã€‚æ ¹æ®<a href=\"https://time.geekbang.org/column/article/724776\">ç¬¬ 10 è®²</a>çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ç±»å‹Tå…·æœ‰Taskçš„èƒ½åŠ›ã€‚<code>::&lt;&gt;</code> æ˜¯ turbofish è¯­æ³•ï¼Œç”¨æ¥å°†å…·ä½“çš„ç±»å‹ä¼ é€’è¿›å‡½æ•°çš„ç±»å‹å‚æ•°ä¸­ã€‚</p><p>è¿›å…¥ <code>run()</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ã€‚ç¬¬405ã€406è¡Œï¼Œæ ¹æ®æŒ‡å®šçš„ä¸åŒçš„æ¨¡å‹ï¼Œå°†é¢„è®­ç»ƒæ¨¡å‹çš„å†…å®¹åŠ è½½æˆ model å®ä¾‹ã€‚ç¬¬407è¡Œæœ‰ä¸ª <code>T::load()</code> å†™æ³•ï¼Œå®é™…å°±æ˜¯ YOLOv8 å’Œ YOLOv8Pose ä¸Šéƒ½å®ç°äº† <code>load()</code> å…³è”å‡½æ•°ï¼Œå®ƒå®šä¹‰åœ¨Task traitä¸­ã€‚</p><p>ç„¶åç¬¬409è¡Œå¯ä»¥æ‰¹é‡å¯¹å¤šä¸ªå›¾ç‰‡è¿›è¡Œæ“ä½œï¼Œè¿™ä¸ªéœ€è¦ä½ åœ¨å‘½ä»¤è¡Œä¸­ä¼ å‚æ•°æŒ‡å®šã€‚æˆ‘ä»¬å‰é¢çš„ç¤ºä¾‹åªå¤„ç†ä¸€å¼ å›¾ç‰‡ã€‚ç„¶åä¸‹é¢ç¬¬415ï½426è¡Œï¼Œæ˜¯å¯¹å›¾ç‰‡å°ºå¯¸çš„è§„çº¦åŒ–å¤„ç†ã€‚å› ä¸ºYOLOV8åªèƒ½åœ¨640px x 640px çš„å›¾ç‰‡ä¸Šè¿›è¡Œæ£€æµ‹ï¼Œæ‰€ä»¥éœ€è¦åœ¨ä»£ç ä¸­é¢„å¤„ç†ä¸€ä¸‹ã€‚</p><p>ç¬¬427ï½440è¡Œæ˜¯å°†å¤„ç†åçš„å›¾ç‰‡åŠ è½½æˆ Tensor å¯¹è±¡ã€‚ç¬¬441ï½442è¡Œï¼Œæ‰§è¡Œæ¨ç†é¢„æµ‹ã€‚ç¬¬444ï½452è¡Œï¼Œè°ƒç”¨å„è‡ªä»»åŠ¡çš„æ±‡æŠ¥ä¸šåŠ¡ã€‚ç¬¬453ï½455è¡Œï¼Œç”Ÿæˆå¤„ç†åçš„å›¾ç‰‡ï¼Œå†™å…¥ç£ç›˜ä¸­ã€‚</p><p>ç¬¬444è¡Œå‡ºç°äº† <code>T::report()</code>ï¼Œè§£é‡Šè·Ÿå‰é¢ä¸€æ ·ï¼Œå®é™…å°±æ˜¯ YOLOv8 å’Œ YOLOv8Pose ä¸Šéƒ½å®ç°äº† <code>report()</code> å…³è”å‡½æ•°ï¼Œå®ƒå®šä¹‰åœ¨Task traitä¸­ã€‚ç„¶åè¿™ä¸ª <code>T::report()</code> ä¼šè¿›ä¸€æ­¥è·¯ç”±åˆ° <code>report_detect()</code> å’Œ <code>report_pose()</code> å‡½æ•°ä¸­ï¼Œå„è‡ªè°ƒç”¨ã€‚</p><p>åœ¨å„è‡ªçš„ report å‡½æ•°ä¸­ï¼Œä¼šå¯¹ä¸Šä¸€æ­¥YOLOv8é¢„æµ‹çš„è¾¹æ¡†å€¼æŒ‰ç½®ä¿¡åŒºé—´è¿›è¡Œç­›é€‰ï¼Œç„¶åå¯¹å›¾ç‰‡æ·»åŠ æ ‡æ³¨ï¼Œä¹Ÿå°±æ˜¯ç”»é‚£äº›çº¿å’Œæ¡†ã€‚è¿™æ ·å°±ç”Ÿæˆäº†æˆ‘ä»¬çœ‹åˆ°çš„æ•ˆæœå›¾çš„å†…å­˜å¯¹è±¡ã€‚</p><p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œå…¨éƒ¨ä»£ç å°±è®²è§£å®Œæˆäº†ã€‚ç»†èŠ‚æ¯”è¾ƒç”Ÿç¡¬ï¼Œè¿˜æ˜¯å›¾ç‰‡å¥½ç©ï¼</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä½¿ç”¨Rustå®ç°äº†Yolov8ç®—æ³•æ¢æµ‹å›¾åƒä¸­çš„å¯¹è±¡å’Œäººç‰©çš„å§¿åŠ¿ã€‚ä»å®ç°è¿‡ç¨‹æ¥è¯´ï¼Œå¹¶ä¸æ¯”Pythonç‰ˆæœ¬çš„å®ç°å¤æ‚å¤šå°‘ã€‚è€Œä¸”ä»éƒ¨ç½²ä¸Šæ¥è®²ï¼ŒRustç¼–è¯‘åå°±ä¸€ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯¹äºåšæˆä¸€ä¸ªè½¯ä»¶ï¼ˆåé¢ä¸¤è®²æˆ‘ä»¬ä¼šè®²å¦‚ä½•ç”¨GUIç•Œé¢ï¼‰è¦æ–¹ä¾¿å¾ˆå¤šã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œä»£ç ä¸­å¯¹äºå‡½æ•°çš„è¿”å›å€¼ï¼Œä½¿ç”¨äº† <code>anyhow::Result&lt;T&gt;</code>ã€‚ä¸ŠèŠ‚è¯¾æˆ‘ä»¬è®²è¿‡ï¼Œä½¿ç”¨anyhowçš„è¿”å›ç±»å‹èƒ½å¤Ÿå¤§å¤§å‡å°‘æˆ‘ä»¬çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</p><p>è¿™ä¸ªç‰ˆæœ¬çš„Yolov8çš„ç®—æ³•ï¼Œæ˜¯å®ç°åœ¨Candleæ¡†æ¶è¿™ä¸ªå¹³å°ä¸Šçš„ï¼Œä½ å¯ä»¥ç ”ç©¶ä¸€ä¸‹ model.rs æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä»£ç é‡éå¸¸å°‘ã€‚å› ä¸ºæœ‰äº†Candleçš„åŸºç¡€è®¾æ–½ï¼Œå®ç°ä¸€ä¸ªæ–°çš„ç¥ç»ç½‘ç»œç®—æ³•å…¶å®éå¸¸ç®€å•ã€‚</p><p>ä»¥å‰ï¼Œå½“æˆ‘ä»¬æƒ³å­¦ä¹ å›¾åƒè¯†åˆ«çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¾—æ±‚åŠ©äºPythonæˆ–C++ã€‚ä»¥åä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Rustç©èµ·æ¥äº†ï¼Œæˆ‘ä»¥åä¼šæŒç»­åœ°è¾“å‡ºå…³äºRuståœ¨AIé¢†åŸŸçš„åº”ç”¨ï¼Œä½ å¯ä»¥æŒç»­å…³æ³¨ï¼Œæˆ‘ä»¬ä¸€èµ·æ¨è¿›Ruståœ¨AIé¢†åŸŸçš„å½±å“åŠ›ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯·ä½ å¼€å¯ cuda æˆ– metal ç‰¹æ€§å°è¯•ä¸€ä¸‹ï¼Œä½¿ç”¨ä¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹çœ‹ä¸€ä¸‹æ•ˆæœå·®å¼‚ã€‚å¦å¤–ä½ è¿˜å¯ä»¥æ¢ç”¨ä¸åŒçš„å›¾ç‰‡æ¥æµ‹è¯•ä¸€ä¸‹å„ç§è¯†åˆ«æ•ˆæœã€‚</p><p>æ¬¢è¿ä½ æŠŠä½ å®éªŒçš„ç»“æœåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œé‚€ä»–ä¸€èµ·å­¦ä¹ Rustï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":387255,"user_name":"æ¸¡é¸¦10086","can_delete":false,"product_type":"c1","uid":2491000,"ip_address":"é™•è¥¿","ucode":"58D72C8B5E9B98","user_header":"https://static001.geekbang.org/account/avatar/00/26/02/78/4d40b4b2.jpg","comment_is_top":false,"comment_ctime":1706781032,"is_pvip":false,"replies":[{"id":141163,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1707198568,"ip_address":"å››å·","comment_id":387255,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ç½‘é¡µä¸‹è½½æ¨¡å‹åˆ°æœ¬åœ°åé€šè¿‡--modelså‚æ•°å³å¯ä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼Œæ¯”å¦‚\ncargo run --release -- assets&#47;football.jpg --which m --model .&#47;model&#47;yolov8m.safetensors","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636897,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1707198569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å››å·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388917,"user_name":"Jump","can_delete":false,"product_type":"c1","uid":1139482,"ip_address":"å¹¿ä¸œ","ucode":"6C229DD3AE29A8","user_header":"https://static001.geekbang.org/account/avatar/00/11/63/1a/367ebeac.jpg","comment_is_top":false,"comment_ctime":1711162361,"is_pvip":false,"replies":[{"id":141748,"content":"ğŸ‘ä½ ä¼šäº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1713028632,"ip_address":"åŠ æ‹¿å¤§","comment_id":388917,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"å¯ç”¨cudaéœ€è¦åœ¨cargo.tomlé‡Œé¢å¼€å¯ç‰¹æ€§\n[dependencies]\ncandle-core = {version= &quot;0.3.1&quot;,features=[&quot;cuda&quot;]}\ncandle-nn = {version= &quot;0.3.1&quot;,features=[&quot;cuda&quot;]}\ncandle-transformers = {version= &quot;0.3.1&quot;,features=[&quot;cuda&quot;]}","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641830,"discussion_content":"ğŸ‘ä½ ä¼šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1713028632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŠ æ‹¿å¤§","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388391,"user_name":"Geek_118351","can_delete":false,"product_type":"c1","uid":3842809,"ip_address":"å››å·","ucode":"EDAE2B93EA8B70","user_header":"","comment_is_top":false,"comment_ctime":1710121706,"is_pvip":false,"replies":[{"id":141472,"content":"çœ‹æå®¢æ—¶é—´è¿™è¾¹çš„å®‰æ’å“ˆã€‚ å¯¹äºrust aiçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘åç»­ä¼šæŒç»­è¾“å‡ºï¼Œé¢‘ç‡ä¸å®šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1710434331,"ip_address":"åŠ æ‹¿å¤§","comment_id":388391,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œä¼šè€ƒè™‘å‡ºä¸€ä¸ªé’ˆå¯¹è§†é¢‘æµçš„ç›®æ ‡è¯†åˆ«è¯¾ç¨‹å—ã€‚","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":639283,"discussion_content":"çœ‹æå®¢æ—¶é—´è¿™è¾¹çš„å®‰æ’å“ˆã€‚ å¯¹äºrust aiçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘åç»­ä¼šæŒç»­è¾“å‡ºï¼Œé¢‘ç‡ä¸å®šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1710434331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŠ æ‹¿å¤§","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386488,"user_name":"Geek_e72251","can_delete":false,"product_type":"c1","uid":3733050,"ip_address":"å¹¿ä¸œ","ucode":"894904DE2E6AC0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","comment_is_top":false,"comment_ctime":1704950927,"is_pvip":false,"replies":[{"id":140912,"content":"ä½ å¯ä»¥åœ¨æµè§ˆå™¨é‡Œé¢æ‰“å¼€è¿™ä¸ª https:&#47;&#47;huggingface.co&#47;lmz&#47;candle-yolo-v8&#47;tree&#47;main ä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼Œç„¶åæ”¹ \nhttps:&#47;&#47;github.com&#47;rustai-solutions&#47;slint-yolov8-demo&#47;blob&#47;main&#47;src&#47;yolov8engine&#47;mod.rs#L307C41-L307C41\nå®ä¾‹çš„ model å­—æ®µä¸ºå…·ä½“çš„è·¯å¾„ï¼Œå°±æ˜¯ä½ æœ¬åœ°ç›®å½•çš„Pathã€‚æ­£å¥½å¯ä»¥ç»ƒæ‰‹ä¸€ä¸‹å“ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1705068538,"ip_address":"é‡åº†","comment_id":386488,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆå¯ä»¥è´´ä¸€æ®µæ€ä¹ˆä»æœ¬åœ°åŠ è½½ yolo æ¨¡å‹çš„ä»£ç å—ï¼Ÿå®åœ¨ä¸‹è½½ä¸ä¸‹æ¥ğŸ˜®â€ğŸ’¨","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635717,"discussion_content":"ä½ å¯ä»¥åœ¨æµè§ˆå™¨é‡Œé¢æ‰“å¼€è¿™ä¸ª https://huggingface.co/lmz/candle-yolo-v8/tree/main ä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼Œç„¶åæ”¹ \nhttps://github.com/rustai-solutions/slint-yolov8-demo/blob/main/src/yolov8engine/mod.rs#L307C41-L307C41\nå®ä¾‹çš„ model å­—æ®µä¸ºå…·ä½“çš„è·¯å¾„ï¼Œå°±æ˜¯ä½ æœ¬åœ°ç›®å½•çš„Pathã€‚æ­£å¥½å¯ä»¥ç»ƒæ‰‹ä¸€ä¸‹å“ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705068538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3733050,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","nickname":"Geek_e72251","note":"","ucode":"894904DE2E6AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635656,"discussion_content":"å·²ç»è§£å†³äº†ğŸ˜ƒåŠ ä¸ªå‚æ•°å°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705026980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386277,"user_name":"Geek_e72251","can_delete":false,"product_type":"c1","uid":3733050,"ip_address":"å¹¿ä¸œ","ucode":"894904DE2E6AC0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","comment_is_top":false,"comment_ctime":1704431038,"is_pvip":false,"replies":[{"id":140795,"content":"å¯ä»¥åƒå‰é¢ä¸€èŠ‚ä¸€æ ·ï¼Œç”¨hfçš„å·¥å…·ä»é•œåƒä¸‹è½½ã€‚æˆ–è€…å¼€å…¨å±€ä»£ç†ä¸‹è½½","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1704497628,"ip_address":"é‡åº†","comment_id":386277,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"Error: request error: https:&#47;&#47;huggingface.co&#47;lmz&#47;candle-yolo-v8&#47;resolve&#47;main&#47;yolov8m.safetensors: Connection Failed: Connect error: connection timed out\n\nCaused by:\n    0: https:&#47;&#47;huggingface.co&#47;lmz&#47;candle-yolo-v8&#47;resolve&#47;main&#47;yolov8m.safetensors: Connection Failed: Connect error: connection timed out\n    1: connection timed out ä¸€ç›´ä¸‹ä¸æ¥è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æå‰ä¸‹è½½ä¸‹æ¥ç„¶åæ”¾åˆ°é¡¹ç›®é‡Œé¢å—ï¼Ÿæµè§ˆå™¨å¯ä»¥æ­£å¸¸ä¸‹è½½","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635173,"discussion_content":"å¯ä»¥åƒå‰é¢ä¸€èŠ‚ä¸€æ ·ï¼Œç”¨hfçš„å·¥å…·ä»é•œåƒä¸‹è½½ã€‚æˆ–è€…å¼€å…¨å±€ä»£ç†ä¸‹è½½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704497628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":3733050,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","nickname":"Geek_e72251","note":"","ucode":"894904DE2E6AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":635209,"discussion_content":"å¼€äº†å…¨å±€ä»£ç†ä¹Ÿä¸è¡Œã€‚æˆ‘å·²ç»ä»æµè§ˆå™¨ä¸‹è½½ä¸‹æ¥äº†ï¼Œåº”è¯¥æ”¾åˆ°å“ªä¸ªæ–‡ä»¶å¤¹ï¼Ÿæˆ–è€…ä¿®æ”¹å“ªä¸ªé…ç½®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704543939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":635173,"ip_address":"å¹¿ä¸œ","group_id":0},"score":635209,"extra":""}]},{"author":{"id":3227310,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ibD5qS2OcJj7aWf4SVJFUVLicicDkSkmzTHRhTSd2cXKzYO1LRDwcoEOo7EjV8KFaSzmgqA1ZcXLWBUibHsKTovWHA/132","nickname":"Geek_706285","note":"","ucode":"22C6EAFEB84E04","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635298,"discussion_content":"è€å“¥æˆ‘ä¹Ÿç¢°åˆ°åŒæ ·çš„é—®é¢˜äº†ï¼Œæˆ‘é…ç½®äº†ä»£ç†å’ŒæŒ‚äº†å…¨å±€éƒ½ä¸‹è½½ä¸äº†ï¼Œç„¶åä¸æ¸…æ¥šstd::pathçš„å…·ä½“è·¯å¾„è¯¥åœ¨å“ªï¼Œä½ åé¢ç»“å±€äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704703556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":3733050,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","nickname":"Geek_e72251","note":"","ucode":"894904DE2E6AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3227310,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ibD5qS2OcJj7aWf4SVJFUVLicicDkSkmzTHRhTSd2cXKzYO1LRDwcoEOo7EjV8KFaSzmgqA1ZcXLWBUibHsKTovWHA/132","nickname":"Geek_706285","note":"","ucode":"22C6EAFEB84E04","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635469,"discussion_content":"ä¸çŸ¥é“ è€å¸ˆä¹Ÿæ²¡å›ç­”ğŸ˜®â€ğŸ’¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704870052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":635298,"ip_address":"å¹¿ä¸œ","group_id":0},"score":635469,"extra":""},{"author":{"id":3733050,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","nickname":"Geek_e72251","note":"","ucode":"894904DE2E6AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3227310,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ibD5qS2OcJj7aWf4SVJFUVLicicDkSkmzTHRhTSd2cXKzYO1LRDwcoEOo7EjV8KFaSzmgqA1ZcXLWBUibHsKTovWHA/132","nickname":"Geek_706285","note":"","ucode":"22C6EAFEB84E04","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635474,"discussion_content":"åº”è¯¥æ˜¯ä¸‹è½½ä¸‹æ¥ç”¨ æ ‡å‡†åº“çš„ File è¯»å–ï¼Œåªæ˜¯ä¸çŸ¥é“æ€ä¹ˆè¯»å–ğŸ¥²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704870718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":635298,"ip_address":"å¹¿ä¸œ","group_id":0},"score":635474,"extra":""}]}]},{"had_liked":false,"id":386036,"user_name":"å‡¤  æ¢¨  ğŸ","can_delete":false,"product_type":"c1","uid":3801970,"ip_address":"å¹¿ä¸œ","ucode":"9A019F064B79A5","user_header":"https://static001.geekbang.org/account/avatar/00/3a/03/72/666d9a55.jpg","comment_is_top":false,"comment_ctime":1703867428,"is_pvip":false,"replies":[{"id":140724,"content":"æˆ‘ä»£ç é‡Œé¢æœ‰, ç”¨ huggingface-cli ä¸‹è½½,æŒ‡å®šé•œåƒ. å¯ä»¥ä¸‹è½½çš„.  è½¬æ¢æ ¼å¼çš„è¯å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ¡ˆ: https:&#47;&#47;github.com&#47;ToluClassics&#47;candle-tutorial","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1704170612,"ip_address":"é‡åº†","comment_id":386036,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"pytorchæ€ä¹ˆè½¬safetensorsï¼Œæ²¡å·¥å…·ä¸‹è½½ä¸äº†å¤–é¢çš„æ¨¡å‹","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634873,"discussion_content":"æˆ‘ä»£ç é‡Œé¢æœ‰, ç”¨ huggingface-cli ä¸‹è½½,æŒ‡å®šé•œåƒ. å¯ä»¥ä¸‹è½½çš„.  è½¬æ¢æ ¼å¼çš„è¯å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ¡ˆ: https://github.com/ToluClassics/candle-tutorial","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704170612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3733050,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","nickname":"Geek_e72251","note":"","ucode":"894904DE2E6AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636259,"discussion_content":"å…„å¼Ÿè½¬æˆåŠŸäº†å—ï¼Ÿè¿™ä¸ªæ•™ç¨‹å¯¹æ–°æ‰‹å¤ªä¸å‹å¥½äº†ğŸ¥²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705913400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385851,"user_name":"unistart","can_delete":false,"product_type":"c1","uid":1524770,"ip_address":"æ¹–å—","ucode":"C51E5D242530D2","user_header":"https://static001.geekbang.org/account/avatar/00/17/44/22/403a340a.jpg","comment_is_top":false,"comment_ctime":1703509911,"is_pvip":false,"replies":[{"id":140633,"content":"å› ä¸ºå§¿åŠ¿æ¢æµ‹å¥½åƒåªæ”¯æŒäººã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703577837,"ip_address":"é‡åº†","comment_id":385851,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯çŒ«çŒ«é‚£å¼ å›¾æ‰§è¡Œå§¿åŠ¿æ¢æµ‹ä»»åŠ¡æ—¶æ— æ³•æ­£ç¡®è¯†åˆ«ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå•Šï¼Ÿ\n\ncargo run --release -- assets&#47;cats.jpg --model candle-yolo-v8&#47;yolov8x-pose.safetensors --which x --task pose\n   Compiling candle_demo_yolov8 v0.1.0 (E:\\Project\\rust-jikeshijian\\24-candle_yolov8)\n    Finished release [optimized] target(s) in 12.69s\n     Running `target\\release\\candle_demo_yolov8.exe assets&#47;cats.jpg --model candle-yolo-v8&#47;yolov8x-pose.safetensors --which x --task pose`\nRunning on CPU, to run on GPU, build this example with `--features cuda`\nmodel loaded\nprocessing &quot;assets&#47;cats.jpg&quot;\ngenerated predictions Tensor[dims 56, 6300; f32]\nwriting &quot;assets&#47;cats.pp.jpg&quot;","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634499,"discussion_content":"å› ä¸ºå§¿åŠ¿æ¢æµ‹å¥½åƒåªæ”¯æŒäººã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703577837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385671,"user_name":"è•¨ç«","can_delete":false,"product_type":"c1","uid":2230590,"ip_address":"é’æµ·","ucode":"34AE1F36258BA4","user_header":"https://static001.geekbang.org/account/avatar/00/22/09/3e/5021e8a1.jpg","comment_is_top":false,"comment_ctime":1703073971,"is_pvip":false,"replies":[{"id":140565,"content":"è®­ç»ƒyoloè·Ÿè”ç½‘å…³ç³»ä¸å¤§ï¼Œå¯ä»¥å…ˆæŠŠé¢„è®­ç»ƒæ¨¡å‹ä¸‹è½½ä¸‹æ¥ï¼Œå‡†å¤‡å¥½ç¯å¢ƒï¼Œå†æŠŠç½‘ç»œæ–­æ‰è®­ç»ƒã€‚è®­ç»ƒçš„è¿‡ç¨‹æœ¬èº«ä¸ä¾èµ–äºç½‘ç»œï¼Œåªæ˜¯å‰æœŸèµ„æ–™ï¼ˆåˆå§‹æ¨¡å‹æ–‡ä»¶ï¼Œä½ çš„æ•°æ®é›†ï¼Œrust appç¼–è¯‘å¥½ï¼Œç­‰ç­‰ï¼‰å‡†å¤‡ä½ å¾—å‡†å¤‡å¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703123499,"ip_address":"é‡åº†","comment_id":385671,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"åŒé—®ï¼Œä¸è”ç½‘æ€ä¹ˆåšï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634241,"discussion_content":"è®­ç»ƒyoloè·Ÿè”ç½‘å…³ç³»ä¸å¤§ï¼Œå¯ä»¥å…ˆæŠŠé¢„è®­ç»ƒæ¨¡å‹ä¸‹è½½ä¸‹æ¥ï¼Œå‡†å¤‡å¥½ç¯å¢ƒï¼Œå†æŠŠç½‘ç»œæ–­æ‰è®­ç»ƒã€‚è®­ç»ƒçš„è¿‡ç¨‹æœ¬èº«ä¸ä¾èµ–äºç½‘ç»œï¼Œåªæ˜¯å‰æœŸèµ„æ–™ï¼ˆåˆå§‹æ¨¡å‹æ–‡ä»¶ï¼Œä½ çš„æ•°æ®é›†ï¼Œrust appç¼–è¯‘å¥½ï¼Œç­‰ç­‰ï¼‰å‡†å¤‡ä½ å¾—å‡†å¤‡å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703123499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385580,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"å››å·","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1702950837,"is_pvip":false,"replies":[{"id":140562,"content":"è¿™å—å„¿è¿˜æ²¡æœ‰ç¤ºä¾‹ï¼Œç®€å•çš„è¯´ï¼Œpytorchæ˜¯æ€ä¹ˆè®­ç»ƒçš„ï¼Œåœ¨candleä¸­å°±å¯¹åº”çš„å®ç°å°±è¡Œäº†ã€‚åŸç†éƒ½æ˜¯ç¥ç»ç½‘ç»œã€‚Ruståœ¨AIè¿™å—å„¿è¿˜æœ‰å¤§é‡çš„å·¥ä½œè¦åšï¼Œè€ŒRustç¤¾åŒºåé¢ä¼šåœ¨è¿™å—å„¿æŠ•å…¥å·¨å¤§çš„ç²¾åŠ›ã€‚æ¬¢è¿æŒç»­å…³æ³¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703123310,"ip_address":"é‡åº†","comment_id":385580,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ç”¨rustæ€ä¹ˆè®­ç»ƒå½•åƒèµ„æºå•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634238,"discussion_content":"è¿™å—å„¿è¿˜æ²¡æœ‰ç¤ºä¾‹ï¼Œç®€å•çš„è¯´ï¼Œpytorchæ˜¯æ€ä¹ˆè®­ç»ƒçš„ï¼Œåœ¨candleä¸­å°±å¯¹åº”çš„å®ç°å°±è¡Œäº†ã€‚åŸç†éƒ½æ˜¯ç¥ç»ç½‘ç»œã€‚Ruståœ¨AIè¿™å—å„¿è¿˜æœ‰å¤§é‡çš„å·¥ä½œè¦åšï¼Œè€ŒRustç¤¾åŒºåé¢ä¼šåœ¨è¿™å—å„¿æŠ•å…¥å·¨å¤§çš„ç²¾åŠ›ã€‚æ¬¢è¿æŒç»­å…³æ³¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703123311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385579,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"å››å·","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1702950773,"is_pvip":false,"replies":[{"id":140561,"content":"è®­ç»ƒyoloè·Ÿè”ç½‘å…³ç³»ä¸å¤§ï¼Œå¯ä»¥å…ˆæŠŠé¢„è®­ç»ƒæ¨¡å‹ä¸‹è½½ä¸‹æ¥ï¼Œå‡†å¤‡å¥½ç¯å¢ƒï¼Œå†æŠŠç½‘ç»œæ–­æ‰è®­ç»ƒã€‚è®­ç»ƒçš„è¿‡ç¨‹æœ¬èº«ä¸ä¾èµ–äºç½‘ç»œï¼Œåªæ˜¯å‰æœŸèµ„æ–™å‡†å¤‡ä½ å¾—å‡†å¤‡å¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703123210,"ip_address":"é‡åº†","comment_id":385579,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"å¦‚æœæˆ‘ä»¬çš„ç”µè„‘ä¸è”ç½‘çš„æƒ…å†µä¸‹ï¼Œç”¨yoloè®­ç»ƒå›¾ç‰‡èµ„æºå•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634237,"discussion_content":"è®­ç»ƒyoloè·Ÿè”ç½‘å…³ç³»ä¸å¤§ï¼Œå¯ä»¥å…ˆæŠŠé¢„è®­ç»ƒæ¨¡å‹ä¸‹è½½ä¸‹æ¥ï¼Œå‡†å¤‡å¥½ç¯å¢ƒï¼Œå†æŠŠç½‘ç»œæ–­æ‰è®­ç»ƒã€‚è®­ç»ƒçš„è¿‡ç¨‹æœ¬èº«ä¸ä¾èµ–äºç½‘ç»œï¼Œåªæ˜¯å‰æœŸèµ„æ–™å‡†å¤‡ä½ å¾—å‡†å¤‡å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703123211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3570665,"avatar":"","nickname":"Geek_72807e","note":"","ucode":"9E9A6277605048","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634076,"discussion_content":"åŒé—®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702971638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å±±è¥¿","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385578,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"å››å·","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1702950642,"is_pvip":false,"replies":[{"id":140560,"content":"ä½ æŒ‡çš„åœ¨è‡ªå·±çš„å›¾ç‰‡è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒå—ï¼Ÿç›®å‰ç½‘ä¸Šæœ‰å¾ˆå¤šç›¸å…³èµ„æ–™ï¼šhttps:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;650002512 https:&#47;&#47;blog.csdn.net&#47;weixin_45921929&#47;article&#47;details&#47;132450479  https:&#47;&#47;blog.csdn.net&#47;qq_40716944&#47;article&#47;details&#47;128648001 \nCandleè¿™è¾¹èµ„æ–™ç°åœ¨éå¸¸å°‘ï¼Œæ¯•ç«Ÿæ˜¯æœ€æ–°åˆšå‡ºçš„ä¸œè¥¿ï¼Œè¿˜åœ¨é£é€Ÿå‘å±•ä¸­ã€‚ä¸è¿‡ï¼Œåé¢æˆ‘ä¼šåœ¨è¿™å—å„¿æŒç»­è¾“å‡ºç›¸å…³å†…å®¹ï¼ŒåŒ…å«yolov8çš„è®­ç»ƒã€‚æ¬¢è¿æŒç»­å…³æ³¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1703123117,"ip_address":"é‡åº†","comment_id":385578,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"æ€ä¹ˆä½¿ç”¨yoloè®­ç»ƒå›¾ç‰‡ï¼Ÿè¯·è€å¸ˆè¯·ä¸€ä¸‹","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634236,"discussion_content":"ä½ æŒ‡çš„åœ¨è‡ªå·±çš„å›¾ç‰‡è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒå—ï¼Ÿç›®å‰ç½‘ä¸Šæœ‰å¾ˆå¤šç›¸å…³èµ„æ–™ï¼šhttps://zhuanlan.zhihu.com/p/650002512 https://blog.csdn.net/weixin_45921929/article/details/132450479  https://blog.csdn.net/qq_40716944/article/details/128648001 \nCandleè¿™è¾¹èµ„æ–™ç°åœ¨éå¸¸å°‘ï¼Œæ¯•ç«Ÿæ˜¯æœ€æ–°åˆšå‡ºçš„ä¸œè¥¿ï¼Œè¿˜åœ¨é£é€Ÿå‘å±•ä¸­ã€‚ä¸è¿‡ï¼Œåé¢æˆ‘ä¼šåœ¨è¿™å—å„¿æŒç»­è¾“å‡ºç›¸å…³å†…å®¹ï¼ŒåŒ…å«yolov8çš„è®­ç»ƒã€‚æ¬¢è¿æŒç»­å…³æ³¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703123117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}