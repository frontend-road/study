{"id":475959,"title":"31ï½œå¹¶å‘ï¼šGoçš„å¹¶å‘æ–¹æ¡ˆå®ç°æ–¹æ¡ˆæ˜¯æ€æ ·çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Tony Baiã€‚</p><p>ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ è¿™é—¨è¯¾çš„æœ€åä¸€ä¸ªè¯­æ³•çŸ¥è¯†ï¼š<strong>Goå¹¶å‘</strong>ã€‚åœ¨<a href=\"https://time.geekbang.org/column/article/426740\">02è®²</a>ä¸­æˆ‘ä»¬æåˆ°è¿‡ï¼šGoçš„è®¾è®¡è€…æ•é”åœ°æŠŠæ¡äº†CPUå‘å¤šæ ¸æ–¹å‘å‘å±•çš„è¿™ä¸€è¶‹åŠ¿ï¼Œåœ¨å†³å®šå»åˆ›å»ºGoè¯­è¨€çš„æ—¶å€™ï¼Œä»–ä»¬æœæ–­å°†é¢å‘å¤šæ ¸ã€<strong>åŸç”Ÿæ”¯æŒå¹¶å‘</strong>ä½œä¸ºäº†Goè¯­è¨€çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€ï¼Œå¹¶å°†é¢å‘å¹¶å‘ä½œä¸ºGoçš„è®¾è®¡å“²å­¦ã€‚å½“Goè¯­è¨€é¦–æ¬¡å¯¹å¤–å‘å¸ƒæ—¶ï¼Œå¯¹å¹¶å‘çš„åŸç”Ÿæ”¯æŒæˆä¸ºäº†Goæœ€ä»¤å¼€å‘è€…ç€è¿·çš„è¯­æ³•ç‰¹æ€§ä¹‹ä¸€ã€‚</p><p>é‚£ä¹ˆï¼Œæ€ä¹ˆå»å­¦ä¹ Goå¹¶å‘å‘¢ï¼Ÿæˆ‘çš„æ–¹æ³•æ˜¯å°†â€œGoå¹¶å‘â€è¿™ä¸ªè¯æ‹†å¼€æ¥çœ‹ï¼Œå®ƒåŒ…å«ä¸¤æ–¹é¢å†…å®¹ï¼Œä¸€ä¸ªæ˜¯å¹¶å‘çš„æ¦‚å¿µï¼Œå¦ä¸€ä¸ªæ˜¯Goé’ˆå¯¹å¹¶å‘è®¾è®¡ç»™å‡ºçš„è‡ªèº«çš„å®ç°æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯goroutineã€channelã€selectè¿™äº›Goå¹¶å‘çš„è¯­æ³•ç‰¹æ€§ã€‚</p><p>ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å…ˆæ¥äº†è§£ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Œä»¥åŠGoå¹¶å‘æ–¹æ¡ˆä¸­æœ€é‡è¦çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯goroutineï¼Œå›´ç»•å®ƒåŸºæœ¬ç”¨æ³•å’Œæ³¨æ„äº‹é¡¹ï¼Œè®©ä½ å¯¹Goå¹¶å‘æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œåé¢æˆ‘ä»¬å†å±‚å±‚æ·±å…¥ã€‚</p><h2>ä»€ä¹ˆæ˜¯å¹¶å‘ï¼Ÿ</h2><p>è¯¾ç¨‹ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°±ç»å¸¸æåˆ°å¹¶å‘ï¼ˆconcurrencyï¼‰è¿™ä¸ªè¯ã€‚è¯´äº†è¿™ä¹ˆé•¿æ—¶é—´çš„å¹¶å‘ï¼Œé‚£ç©¶ç«Ÿä»€ä¹ˆæ˜¯å¹¶å‘å‘¢ï¼Ÿå®ƒåˆä¸å¹¶è¡Œï¼ˆparallelismï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿè¦æƒ³ææ¸…æ¥šè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•å›é¡¾ä¸€ä¸‹æ“ä½œç³»ç»Ÿçš„åŸºæœ¬è°ƒåº¦å•å…ƒçš„å˜è¿ï¼Œä»¥åŠè®¡ç®—æœºå¤„ç†å™¨çš„æ¼”åŒ–å¯¹åº”ç”¨è®¾è®¡çš„å½±å“ã€‚</p><!-- [[[read_end]]] --><p>å¾ˆä¹…ä»¥å‰ï¼Œé¢å‘å¤§ä¼—æ¶ˆè´¹è€…çš„ä¸»æµå¤„ç†å™¨ï¼ˆCPUï¼‰éƒ½æ˜¯å•æ ¸çš„ï¼Œæ“ä½œç³»ç»Ÿçš„åŸºæœ¬è°ƒåº¦ä¸æ‰§è¡Œå•å…ƒæ˜¯è¿›ç¨‹ï¼ˆprocessï¼‰ã€‚è¿™ä¸ªæ—¶å€™ï¼Œç”¨æˆ·å±‚çš„åº”ç”¨æœ‰ä¸¤ç§è®¾è®¡æ–¹å¼ï¼Œä¸€ç§æ˜¯å•è¿›ç¨‹åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å¯åŠ¨ä¸€ä¸ªåº”ç”¨ï¼Œæ“ä½œç³»ç»Ÿéƒ½åªå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹æ¥è¿è¡Œè¿™ä¸ªåº”ç”¨ã€‚</p><p>å•è¿›ç¨‹åº”ç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å±‚åº”ç”¨ã€æ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠå¤„ç†å™¨ä¹‹é—´çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/80/fa/80b2d27586eea8e6cd04224807c471fa.jpg?wh=1920x1047\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™ä¸ªè®¾è®¡ä¸‹ï¼Œæ¯ä¸ªå•è¿›ç¨‹åº”ç”¨å¯¹åº”ä¸€ä¸ªæ“ä½œç³»ç»Ÿè¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿå†…çš„å¤šä¸ªè¿›ç¨‹æŒ‰æ—¶é—´ç‰‡å¤§å°ï¼Œè¢«è½®æµè°ƒåº¦åˆ°ä»…æœ‰çš„ä¸€é¢—å•æ ¸å¤„ç†å™¨ä¸Šæ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œè¿™é¢—å•æ ¸å¤„ç†å™¨åœ¨æŸä¸ªæ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹å¯¹åº”çš„ç¨‹åºä»£ç ï¼Œä¸¤ä¸ªè¿›ç¨‹ä¸å­˜åœ¨å¹¶è¡Œæ‰§è¡Œçš„å¯èƒ½ã€‚</p><p>è¿™é‡Œè¯´çš„<strong>å¹¶è¡Œï¼ˆparallelismï¼‰ï¼ŒæŒ‡çš„å°±æ˜¯åœ¨åŒä¸€æ—¶åˆ»ï¼Œæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„ä»»åŠ¡ï¼ˆè¿™é‡ŒæŒ‡è¿›ç¨‹ï¼‰çš„ä»£ç åœ¨å¤„ç†å™¨ä¸Šæ‰§è¡Œ</strong>ã€‚ä»è¿™ä¸ªæ¦‚å¿µæˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œå¤šä¸ªå¤„ç†å™¨æˆ–å¤šæ ¸å¤„ç†å™¨æ˜¯å¹¶è¡Œæ‰§è¡Œçš„å¿…è¦æ¡ä»¶ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå•è¿›ç¨‹åº”ç”¨çš„è®¾è®¡æ¯”è¾ƒç®€å•ï¼Œå®ƒçš„å†…éƒ¨ä»…æœ‰ä¸€æ¡ä»£ç æ‰§è¡Œæµï¼Œä»£ç ä»å¤´æ‰§è¡Œåˆ°å°¾ï¼Œä¸å­˜åœ¨ç«æ€ï¼Œæ— éœ€è€ƒè™‘åŒæ­¥é—®é¢˜ã€‚</p><p>ç”¨æˆ·å±‚çš„å¦å¤–ä¸€ç§è®¾è®¡æ–¹å¼ï¼Œå°±æ˜¯å¤šè¿›ç¨‹åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨é€šè¿‡forkç­‰ç³»ç»Ÿè°ƒç”¨åˆ›å»ºå¤šä¸ªå­è¿›ç¨‹ï¼Œå…±åŒå®ç°åº”ç”¨çš„åŠŸèƒ½ã€‚å¤šè¿›ç¨‹åº”ç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å±‚åº”ç”¨ã€æ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠå¤„ç†å™¨ä¹‹é—´çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b8/c6/b82486d70620519a7a9e756892d8bcc6.jpg?wh=1920x1047\" alt=\"å›¾ç‰‡\"></p><p>ä»¥å›¾ä¸­çš„App1ä¸ºä¾‹ï¼Œè¿™ä¸ªåº”ç”¨è®¾è®¡è€…å°†åº”ç”¨å†…éƒ¨åˆ’åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ç”¨ä¸€ä¸ªè¿›ç¨‹æ‰¿è½½æ‰§è¡Œï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ‰§è¡Œæµï¼Œè¿™æ ·ï¼ŒApp1å†…éƒ¨å°±æœ‰äº†å¤šä¸ªç‹¬ç«‹çš„ä»£ç æ‰§è¡Œæµã€‚</p><p>ä½†é™äºå½“å‰ä»…æœ‰ä¸€é¢—å•æ ¸å¤„ç†å™¨ï¼Œè¿™äº›è¿›ç¨‹ï¼ˆæ‰§è¡Œæµï¼‰ä¾æ—§æ— æ³•å¹¶è¡Œæ‰§è¡Œï¼Œæ— è®ºæ˜¯App1å†…éƒ¨çš„æŸä¸ªæ¨¡å—å¯¹åº”çš„è¿›ç¨‹ï¼Œè¿˜æ˜¯å…¶ä»–Appå¯¹åº”çš„è¿›ç¨‹ï¼Œéƒ½å¾—é€ä¸ªæŒ‰æ—¶é—´ç‰‡è¢«æ“ä½œç³»ç»Ÿè°ƒåº¦åˆ°å¤„ç†å™¨ä¸Šæ‰§è¡Œã€‚</p><p><strong>ç²—ç•¥çœ‹èµ·æ¥ï¼Œå¤šè¿›ç¨‹åº”ç”¨ä¸å•è¿›ç¨‹åº”ç”¨ç›¸æ¯”å¹¶æ²¡æœ‰ä»€ä¹ˆè´¨çš„æå‡ã€‚é‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦å°†åº”ç”¨è®¾è®¡ä¸ºå¤šè¿›ç¨‹å‘¢ï¼Ÿ</strong></p><p>è¿™æ›´å¤šæ˜¯ä»åº”ç”¨çš„ç»“æ„è§’åº¦å»è€ƒè™‘çš„ï¼Œå¤šè¿›ç¨‹åº”ç”¨ç”±äºå°†åŠŸèƒ½èŒè´£åšäº†åˆ’åˆ†ï¼Œå¹¶æŒ‡å®šä¸“é—¨çš„æ¨¡å—æ¥è´Ÿè´£ï¼Œæ‰€ä»¥ä»ç»“æ„ä¸Šæ¥çœ‹ï¼Œè¦æ¯”å•è¿›ç¨‹æ›´ä¸ºæ¸…æ™°ç®€æ´ï¼Œå¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ä¹Ÿæ›´å¥½ã€‚<strong>è¿™ç§å°†ç¨‹åºåˆ†æˆå¤šä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„éƒ¨åˆ†çš„ç»“æ„åŒ–ç¨‹åºçš„è®¾è®¡æ–¹æ³•ï¼Œå°±æ˜¯å¹¶å‘è®¾è®¡</strong>ã€‚é‡‡ç”¨äº†å¹¶å‘è®¾è®¡çš„åº”ç”¨ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ç»„ç‹¬ç«‹æ‰§è¡Œçš„æ¨¡å—çš„ç»„åˆã€‚</p><p>ä¸è¿‡ï¼Œè¿›ç¨‹å¹¶ä¸é€‚åˆç”¨äºæ‰¿è½½é‡‡ç”¨äº†å¹¶å‘è®¾è®¡çš„åº”ç”¨çš„æ¨¡å—æ‰§è¡Œæµã€‚å› ä¸ºè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­èµ„æºæ‹¥æœ‰çš„åŸºæœ¬å•ä½ï¼Œå®ƒä¸ä»…åŒ…å«åº”ç”¨çš„ä»£ç å’Œæ•°æ®ï¼Œè¿˜æœ‰ç³»ç»Ÿçº§çš„èµ„æºï¼Œæ¯”å¦‚æ–‡ä»¶æè¿°ç¬¦ã€å†…å­˜åœ°å€ç©ºé—´ç­‰ç­‰ã€‚è¿›ç¨‹çš„â€œåŒ…è¢±â€å¤ªé‡ï¼Œè¿™å¯¼è‡´å®ƒçš„åˆ›å»ºã€åˆ‡æ¢ä¸æ’¤é”€çš„ä»£ä»·éƒ½å¾ˆå¤§ã€‚</p><p>äºæ˜¯çº¿ç¨‹ä¾¿èµ°å…¥äº†äººä»¬çš„è§†é‡ï¼Œçº¿ç¨‹å°±æ˜¯è¿è¡Œäºè¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„æ›´è½»é‡çº§çš„æ‰§è¡Œæµã€‚åŒæ—¶éšç€å¤„ç†å™¨æŠ€æœ¯çš„å‘å±•ï¼Œå¤šæ ¸å¤„ç†å™¨ç¡¬ä»¶æˆä¸ºäº†ä¸»æµï¼Œè¿™è®©çœŸæ­£çš„å¹¶è¡Œæˆä¸ºäº†å¯èƒ½ï¼Œäºæ˜¯ä¸»æµçš„åº”ç”¨è®¾è®¡æ¨¡å‹å˜æˆäº†è¿™æ ·ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/86/f3/865900c852bd4d18f31e41dc152839f3.jpg?wh=1920x1047\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬çœ‹åˆ°ï¼ŒåŸºäºçº¿ç¨‹çš„åº”ç”¨é€šå¸¸é‡‡ç”¨å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å‹ï¼Œä¸€ä¸ªåº”ç”¨å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œåº”ç”¨é€šè¿‡å¹¶å‘è®¾è®¡å°†è‡ªå·±åˆ’åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ç”±ä¸€ä¸ªçº¿ç¨‹ç‹¬ç«‹æ‰¿è½½æ‰§è¡Œã€‚å¤šä¸ªçº¿ç¨‹å…±äº«è¿™ä¸ªè¿›ç¨‹æ‰€æ‹¥æœ‰çš„èµ„æºï¼Œä½†çº¿ç¨‹ä½œä¸ºæ‰§è¡Œå•å…ƒå¯è¢«ç‹¬ç«‹è°ƒåº¦åˆ°å¤„ç†å™¨ä¸Šè¿è¡Œã€‚</p><p>çº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ä¸æ’¤é”€çš„ä»£ä»·ç›¸å¯¹äºè¿›ç¨‹æ˜¯è¦å°å¾—å¤šã€‚å½“è¿™ä¸ªåº”ç”¨çš„å¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«è°ƒåº¦åˆ°ä¸åŒçš„å¤„ç†å™¨æ ¸ä¸Šæ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªåº”ç”¨æ˜¯å¹¶è¡Œçš„ã€‚</p><p>è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¹¶å‘ä¸å¹¶è¡Œä¸¤ä¸ªæ¦‚å¿µåšä¸€äº›åŒºåˆ†äº†ã€‚å°±åƒGoè¯­è¨€ä¹‹çˆ¶Rob Pikeæ›¾è¯´è¿‡é‚£æ ·ï¼š<strong>å¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼Œå¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œå…³ä¹æ‰§è¡Œ</strong>ã€‚</p><p>ç»“åˆä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå¹¶å‘æ˜¯åœ¨åº”ç”¨è®¾è®¡ä¸å®ç°é˜¶æ®µè¦è€ƒè™‘çš„é—®é¢˜ã€‚å¹¶å‘è€ƒè™‘çš„æ˜¯å¦‚ä½•å°†åº”ç”¨åˆ’åˆ†ä¸ºå¤šä¸ªäº’ç›¸é…åˆçš„ã€å¯ç‹¬ç«‹æ‰§è¡Œçš„æ¨¡å—çš„é—®é¢˜ã€‚é‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºå¹¶ä¸ä¸€å®šæ˜¯å¹¶è¡Œæ‰§è¡Œçš„ã€‚</p><p>åœ¨ä¸æ»¡è¶³å¹¶è¡Œå¿…è¦æ¡ä»¶çš„æƒ…å†µä¸‹ï¼ˆä¹Ÿå°±æ˜¯ä»…æœ‰ä¸€ä¸ªå•æ ¸CPUçš„æƒ…å†µä¸‹ï¼‰ï¼Œå³ä¾¿æ˜¯é‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºï¼Œä¾æ—§ä¸å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚è€Œåœ¨æ»¡è¶³å¹¶è¡Œå¿…è¦æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºæ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ã€‚è€Œé‚£äº›æ²¡æœ‰é‡‡ç”¨å¹¶å‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œé™¤éæ˜¯å¯åŠ¨å¤šä¸ªç¨‹åºå®ä¾‹ï¼Œå¦åˆ™æ˜¯æ— æ³•å¹¶è¡Œæ‰§è¡Œçš„ã€‚</p><p>åœ¨å¤šæ ¸å¤„ç†å™¨æˆä¸ºä¸»æµçš„æ—¶ä»£ï¼Œå³ä½¿é‡‡ç”¨å¹¶å‘è®¾è®¡çš„åº”ç”¨ç¨‹åºä»¥å•å®ä¾‹çš„æ–¹å¼è¿è¡Œï¼Œå…¶ä¸­çš„æ¯ä¸ªå†…éƒ¨æ¨¡å—ä¹Ÿéƒ½æ˜¯è¿è¡Œäºä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­çš„ï¼Œå¤šæ ¸èµ„æºä¹Ÿå¯ä»¥å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚è€Œä¸”ï¼Œå¹¶å‘è®©å¹¶è¡Œå˜å¾—æ›´åŠ å®¹æ˜“ï¼Œé‡‡ç”¨å¹¶å‘è®¾è®¡çš„åº”ç”¨å¯ä»¥å°†è´Ÿè½½è‡ªç„¶æ‰©å±•åˆ°å„ä¸ªCPUæ ¸ä¸Šï¼Œä»è€Œæå‡å¤„ç†å™¨çš„åˆ©ç”¨æ•ˆç‡ã€‚</p><p>åœ¨ä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Cã€C++ç­‰ï¼‰ä¸­ï¼ŒåŸºäº<strong>å¤šçº¿ç¨‹æ¨¡å‹</strong>çš„åº”ç”¨è®¾è®¡å°±æ˜¯ä¸€ç§å…¸å‹çš„å¹¶å‘ç¨‹åºè®¾è®¡ã€‚ä½†ä¼ ç»Ÿç¼–ç¨‹è¯­è¨€å¹¶éé¢å‘å¹¶å‘è€Œç”Ÿï¼Œæ²¡æœ‰å¯¹å¹¶å‘è®¾è®¡æä¾›è¿‡å¤šçš„å¸®åŠ©ã€‚å¹¶ä¸”ï¼Œè¿™äº›è¯­è¨€å¤šä»¥æ“ä½œç³»ç»Ÿçº¿ç¨‹ä½œä¸ºæ‰¿è½½åˆ†è§£åçš„ä»£ç ç‰‡æ®µï¼ˆæ¨¡å—ï¼‰çš„æ‰§è¡Œå•å…ƒï¼Œç”±æ“ä½œç³»ç»Ÿæ‰§è¡Œè°ƒåº¦ã€‚è¿™ç§ä¼ ç»Ÿæ”¯æŒå¹¶å‘çš„æ–¹å¼æœ‰å¾ˆå¤šä¸è¶³ï¼š</p><p><strong>é¦–å…ˆå°±æ˜¯å¤æ‚ã€‚</strong></p><p>åˆ›å»ºå®¹æ˜“é€€å‡ºéš¾ã€‚å¦‚æœä½ åšè¿‡C/C++ç¼–ç¨‹ï¼Œé‚£ä½ è‚¯å®šçŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ©ç”¨libpthreadåº“ä¸­æä¾›çš„APIåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè™½ç„¶è¦ä¼ å…¥çš„å‚æ•°ä¸ªæ•°ä¸å°‘ï¼Œä½†å¥½æ­¹è¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä½†ä¸€æ—¦æ¶‰åŠçº¿ç¨‹çš„é€€å‡ºï¼Œå°±è¦è€ƒè™‘æ–°åˆ›å»ºçš„çº¿ç¨‹æ˜¯å¦è¦ä¸ä¸»çº¿ç¨‹åˆ†ç¦»ï¼ˆdetachï¼‰ï¼Œè¿˜æ˜¯éœ€è¦ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹ç»ˆæ­¢ï¼ˆjoinï¼‰å¹¶è·å–å…¶ç»ˆæ­¢çŠ¶æ€ï¼Ÿåˆæˆ–è€…æ˜¯å¦éœ€è¦åœ¨æ–°çº¿ç¨‹ä¸­è®¾ç½®å–æ¶ˆç‚¹ï¼ˆcancel pointï¼‰æ¥ä¿è¯è¢«ä¸»çº¿ç¨‹å–æ¶ˆï¼ˆcancelï¼‰çš„æ—¶å€™èƒ½é¡ºåˆ©é€€å‡ºã€‚</p><p>è€Œä¸”ï¼Œå¹¶å‘æ‰§è¡Œå•å…ƒé—´çš„é€šä¿¡å›°éš¾ä¸”æ˜“é”™ã€‚å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡è™½ç„¶æœ‰å¤šç§æœºåˆ¶å¯é€‰ï¼Œä½†ç”¨èµ·æ¥ä¹Ÿæ˜¯ç›¸å½“å¤æ‚ã€‚å¹¶ä¸”ä¸€æ—¦æ¶‰åŠå…±äº«å†…å­˜ï¼Œå°±ä¼šç”¨åˆ°å„ç§é”äº’æ–¥æœºåˆ¶ï¼Œæ­»é”ä¾¿æˆä¸ºå®¶å¸¸ä¾¿é¥­ã€‚å¦å¤–ï¼Œçº¿ç¨‹æ ˆå¤§å°ä¹Ÿéœ€è¦è®¾å®šï¼Œå¼€å‘äººå‘˜éœ€è¦é€‰æ‹©ä½¿ç”¨é»˜è®¤çš„ï¼Œè¿˜æ˜¯è‡ªå®šä¹‰è®¾ç½®ã€‚</p><p><strong>ç¬¬äºŒå°±æ˜¯éš¾äºè§„æ¨¡åŒ–ï¼ˆscaleï¼‰ã€‚</strong></p><p>çº¿ç¨‹çš„ä½¿ç”¨ä»£ä»·è™½ç„¶å·²ç»æ¯”è¿›ç¨‹å°äº†å¾ˆå¤šï¼Œä½†æˆ‘ä»¬ä¾ç„¶ä¸èƒ½å¤§é‡åˆ›å»ºçº¿ç¨‹ï¼Œå› ä¸ºé™¤äº†æ¯ä¸ªçº¿ç¨‹å ç”¨çš„èµ„æºä¸å°ä¹‹å¤–ï¼Œæ“ä½œç³»ç»Ÿè°ƒåº¦åˆ‡æ¢çº¿ç¨‹çš„ä»£ä»·ä¹Ÿä¸å°ã€‚</p><p>å¯¹äºå¾ˆå¤šç½‘ç»œæœåŠ¡ç¨‹åºæ¥è¯´ï¼Œç”±äºä¸èƒ½å¤§é‡åˆ›å»ºçº¿ç¨‹ï¼Œåªèƒ½é€‰æ‹©åœ¨å°‘é‡çº¿ç¨‹é‡Œåšç½‘ç»œå¤šè·¯å¤ç”¨çš„æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨epoll/kqueue/IoCompletionPortè¿™å¥—æœºåˆ¶ï¼Œå³ä¾¿æœ‰åƒ<a href=\"https://github.com/libevent/libevent\">libevent</a>å’Œ<a href=\"http://software.schmorp.de/pkg/libev.html\">libev</a>è¿™æ ·çš„ç¬¬ä¸‰æ–¹åº“å¸®å¿™ï¼Œå†™èµ·è¿™æ ·çš„ç¨‹åºä¹Ÿæ˜¯å¾ˆä¸å®¹æ˜“çš„ï¼Œå­˜åœ¨å¤§é‡é’©å­å›è°ƒï¼Œç»™å¼€å‘äººå‘˜å¸¦æ¥ä¸å°çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</p><p>é‚£ä¹ˆä»¥â€œåŸç”Ÿæ”¯æŒå¹¶å‘â€è‘—ç§°çš„Goè¯­è¨€åœ¨å¹¶å‘æ–¹é¢çš„å®ç°æ–¹æ¡ˆåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç›¸å¯¹äºåŸºäºçº¿ç¨‹çš„å¹¶å‘è®¾è®¡æ¨¡å‹åˆæœ‰å“ªäº›æ”¹å–„å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ã€‚</p><h2>Goçš„å¹¶å‘æ–¹æ¡ˆï¼šgoroutine</h2><p>Goå¹¶æ²¡æœ‰ä½¿ç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ä½œä¸ºæ‰¿è½½åˆ†è§£åçš„ä»£ç ç‰‡æ®µï¼ˆæ¨¡å—ï¼‰çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œè€Œæ˜¯å®ç°äº† <code>goroutine</code> è¿™ä¸€<strong>ç”±Goè¿è¡Œæ—¶ï¼ˆruntimeï¼‰è´Ÿè´£è°ƒåº¦çš„ã€è½»é‡çš„ç”¨æˆ·çº§çº¿ç¨‹</strong>ï¼Œä¸ºå¹¶å‘ç¨‹åºè®¾è®¡æä¾›åŸç”Ÿæ”¯æŒã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸€æ–¹æ¡ˆæœ‰å•¥ä¼˜åŠ¿ã€‚ç›¸æ¯”ä¼ ç»Ÿæ“ä½œç³»ç»Ÿçº¿ç¨‹æ¥è¯´ï¼Œgoroutineçš„ä¼˜åŠ¿ä¸»è¦æ˜¯ï¼š</p><ul>\n<li>èµ„æºå ç”¨å°ï¼Œæ¯ä¸ªgoroutineçš„åˆå§‹æ ˆå¤§å°ä»…ä¸º2kï¼›</li>\n<li>ç”±Goè¿è¡Œæ—¶è€Œä¸æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œgoroutineä¸Šä¸‹æ–‡åˆ‡æ¢åœ¨ç”¨æˆ·å±‚å®Œæˆï¼Œå¼€é”€æ›´å°ï¼›</li>\n<li>åœ¨è¯­è¨€å±‚é¢è€Œä¸æ˜¯é€šè¿‡æ ‡å‡†åº“æä¾›ã€‚goroutineç”±<code>go</code>å…³é”®å­—åˆ›å»ºï¼Œä¸€é€€å‡ºå°±ä¼šè¢«å›æ”¶æˆ–é”€æ¯ï¼Œå¼€å‘ä½“éªŒæ›´ä½³ï¼›</li>\n<li>è¯­è¨€å†…ç½®channelä½œä¸ºgoroutineé—´é€šä¿¡åŸè¯­ï¼Œä¸ºå¹¶å‘è®¾è®¡æä¾›äº†å¼ºå¤§æ”¯æ’‘ã€‚</li>\n</ul><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œå’Œä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ä¸åŒçš„æ˜¯ï¼ŒGoè¯­è¨€æ˜¯é¢å‘å¹¶å‘è€Œç”Ÿçš„ï¼Œæ‰€ä»¥ï¼Œåœ¨ç¨‹åºçš„ç»“æ„è®¾è®¡é˜¶æ®µï¼Œ<strong>Goçš„æƒ¯ä¾‹æ˜¯ä¼˜å…ˆè€ƒè™‘å¹¶å‘è®¾è®¡</strong>ã€‚è¿™æ ·åšçš„ç›®çš„æ›´å¤šæ˜¯è€ƒè™‘éšç€å¤–ç•Œç¯å¢ƒçš„å˜åŒ–ï¼Œé€šè¿‡å¹¶å‘è®¾è®¡çš„Goåº”ç”¨å¯ä»¥æ›´å¥½åœ°ã€æ›´è‡ªç„¶åœ°é€‚åº”<strong>è§„æ¨¡åŒ–ï¼ˆscaleï¼‰</strong>ã€‚</p><p>æ¯”å¦‚ï¼Œå½“åº”ç”¨è¢«åˆ†é…åˆ°æ›´å¤šè®¡ç®—èµ„æºï¼Œæˆ–è€…è®¡ç®—å¤„ç†ç¡¬ä»¶å¢é…åï¼ŒGoåº”ç”¨ä¸éœ€è¦å†è¿›è¡Œç»“æ„è°ƒæ•´ï¼Œå°±å¯ä»¥å……åˆ†åˆ©ç”¨æ–°å¢çš„è®¡ç®—èµ„æºã€‚è€Œä¸”ï¼Œç»è¿‡å¹¶å‘è®¾è®¡åçš„Goåº”ç”¨ä¹Ÿä¼šæ›´åŠ å¥‘åˆGopherä»¬çš„å¼€å‘åˆ†å·¥åä½œã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨Goä¸­ç©¶ç«Ÿå¦‚ä½•ä½¿ç”¨goroutineã€‚</p><h3>goroutineçš„åŸºæœ¬ç”¨æ³•</h3><p><strong>å¹¶å‘</strong>æ˜¯ä¸€ç§èƒ½åŠ›ï¼Œå®ƒè®©ä½ çš„ç¨‹åºå¯ä»¥ç”±è‹¥å¹²ä¸ªä»£ç ç‰‡æ®µ<strong>ç»„åˆ</strong>è€Œæˆï¼Œå¹¶ä¸”æ¯ä¸ªç‰‡æ®µéƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„ã€‚goroutineæ°æ°å°±æ˜¯GoåŸç”Ÿæ”¯æŒå¹¶å‘çš„ä¸€ä¸ªå…·ä½“å®ç°ã€‚æ— è®ºæ˜¯Goè‡ªèº«è¿è¡Œæ—¶ä»£ç è¿˜æ˜¯ç”¨æˆ·å±‚Goä»£ç ï¼Œéƒ½æ— ä¸€ä¾‹å¤–åœ°è¿è¡Œåœ¨goroutineä¸­ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªgoroutineã€‚</p><p>Goè¯­è¨€é€šè¿‡<code>goå…³é”®å­—+å‡½æ•°/æ–¹æ³•</code>çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªgoroutineã€‚åˆ›å»ºåï¼Œæ–°goroutineå°†æ‹¥æœ‰ç‹¬ç«‹çš„ä»£ç æ‰§è¡Œæµï¼Œå¹¶ä¸åˆ›å»ºå®ƒçš„goroutineä¸€èµ·è¢«Goè¿è¡Œæ—¶è°ƒåº¦ã€‚</p><p>è¿™é‡Œæˆ‘ç»™å‡ºäº†ä¸€äº›åˆ›å»ºgoroutineçš„ä»£ç ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">go fmt.Println(\"I am a goroutine\")\n\nvar c = make(chan int)\ngo func(a, b int) {\n    c &lt;- a + b\n}(3,4)\n \n// $GOROOT/src/net/http/server.go\nc := srv.newConn(rw)\ngo c.serve(connCtx)\n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œé€šè¿‡goå…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå·²æœ‰çš„å…·åå‡½æ•°/æ–¹æ³•åˆ›å»ºgoroutineï¼Œä¹Ÿå¯ä»¥åŸºäºåŒ¿åå‡½æ•°/é—­åŒ…åˆ›å»ºgoroutineã€‚</p><p>åœ¨å‰é¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬æ›¾è¯´è¿‡ï¼Œåˆ›å»ºgoroutineåï¼Œgoå…³é”®å­—ä¸ä¼šè¿”å›goroutine idä¹‹ç±»çš„å”¯ä¸€æ ‡è¯†goroutineçš„idï¼Œä½ ä¹Ÿä¸è¦å°è¯•å»å¾—åˆ°è¿™æ ·çš„idå¹¶ä¾èµ–å®ƒã€‚å¦å¤–ï¼Œå’Œçº¿ç¨‹ä¸€æ ·ï¼Œä¸€ä¸ªåº”ç”¨å†…éƒ¨å¯åŠ¨çš„æ‰€æœ‰goroutineå…±äº«è¿›ç¨‹ç©ºé—´çš„èµ„æºï¼Œå¦‚æœå¤šä¸ªgoroutineè®¿é—®åŒä¸€å—å†…å­˜æ•°æ®ï¼Œå°†ä¼šå­˜åœ¨ç«äº‰ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œgoroutineé—´çš„åŒæ­¥ã€‚</p><p>äº†è§£äº†æ€ä¹ˆåˆ›å»ºï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆé€€å‡ºgoroutineå‘¢ï¼Ÿ</p><p>goroutineçš„ä½¿ç”¨ä»£ä»·å¾ˆä½ï¼ŒGoå®˜æ–¹ä¹Ÿæ¨èä½ å¤šå¤šä½¿ç”¨goroutineã€‚è€Œä¸”ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘å¯¹goroutineçš„é€€å‡ºè¿›è¡Œæ§åˆ¶ï¼š<strong>goroutineçš„æ‰§è¡Œå‡½æ•°çš„è¿”å›ï¼Œå°±æ„å‘³ç€goroutineé€€å‡ºã€‚</strong></p><p>å¦‚æœmain goroutineé€€å‡ºäº†ï¼Œé‚£ä¹ˆä¹Ÿæ„å‘³ç€æ•´ä¸ªåº”ç”¨ç¨‹åºçš„é€€å‡ºã€‚æ­¤å¤–ï¼Œä½ è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œgoroutineæ‰§è¡Œçš„å‡½æ•°æˆ–æ–¹æ³•å³ä¾¿æœ‰è¿”å›å€¼ï¼ŒGoä¹Ÿä¼šå¿½ç•¥è¿™äº›è¿”å›å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ è¦è·å–goroutineæ‰§è¡Œåçš„è¿”å›å€¼ï¼Œä½ éœ€è¦å¦è¡Œè€ƒè™‘å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚é€šè¿‡goroutineé—´çš„é€šä¿¡æ¥å®ç°ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥è¯´è¯´goroutineé—´çš„é€šä¿¡æ–¹å¼ã€‚</p><h3>goroutineé—´çš„é€šä¿¡</h3><p>ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼ˆæ¯”å¦‚ï¼šC++ã€Javaã€Pythonç­‰ï¼‰å¹¶éé¢å‘å¹¶å‘è€Œç”Ÿçš„ï¼Œæ‰€ä»¥ä»–ä»¬é¢å¯¹å¹¶å‘çš„é€»è¾‘å¤šæ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ã€‚å¹¶å‘çš„æ‰§è¡Œå•å…ƒï¼ˆçº¿ç¨‹ï¼‰ä¹‹é—´çš„é€šä¿¡ï¼Œåˆ©ç”¨çš„ä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹æˆ–è¿›ç¨‹é—´é€šä¿¡çš„åŸè¯­ï¼Œæ¯”å¦‚ï¼šå…±äº«å†…å­˜ã€ä¿¡å·ï¼ˆsignalï¼‰ã€ç®¡é“ï¼ˆpipeï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¥—æ¥å­—ï¼ˆsocketï¼‰ç­‰ã€‚</p><p>åœ¨è¿™äº›é€šä¿¡åŸè¯­ä¸­ï¼Œä½¿ç”¨æœ€å¤šã€æœ€å¹¿æ³›çš„ï¼ˆä¹Ÿæ˜¯æœ€é«˜æ•ˆçš„ï¼‰æ˜¯ç»“åˆäº†çº¿ç¨‹åŒæ­¥åŸè¯­ï¼ˆæ¯”å¦‚ï¼šé”ä»¥åŠæ›´ä¸ºä½çº§çš„åŸå­æ“ä½œï¼‰çš„å…±äº«å†…å­˜æ–¹å¼ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä¼ ç»Ÿè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯<strong>åŸºäºå¯¹å†…å­˜çš„å…±äº«çš„</strong>ã€‚</p><p>ä¸è¿‡ï¼Œè¿™ç§ä¼ ç»Ÿçš„åŸºäºå…±äº«å†…å­˜çš„å¹¶å‘æ¨¡å‹å¾ˆ<strong>éš¾ç”¨</strong>ï¼Œä¸”<strong>æ˜“é”™</strong>ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹æˆ–å¤æ‚ç¨‹åºä¸­ï¼Œå¼€å‘äººå‘˜åœ¨è®¾è®¡å¹¶å‘ç¨‹åºæ—¶ï¼Œéœ€è¦æ ¹æ®çº¿ç¨‹æ¨¡å‹å¯¹ç¨‹åºè¿›è¡Œå»ºæ¨¡ï¼ŒåŒæ—¶è§„åˆ’çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡æ–¹å¼ã€‚å¦‚æœé€‰æ‹©çš„æ˜¯é«˜æ•ˆçš„åŸºäºå…±äº«å†…å­˜çš„æœºåˆ¶ï¼Œé‚£ä¹ˆä»–ä»¬è¿˜è¦èŠ±è´¹å¤§é‡å¿ƒæ€è®¾è®¡çº¿ç¨‹é—´çš„åŒæ­¥æœºåˆ¶ï¼Œå¹¶ä¸”åœ¨è®¾è®¡åŒæ­¥æœºåˆ¶çš„æ—¶å€™ï¼Œè¿˜è¦è€ƒè™‘å¤šçº¿ç¨‹é—´å¤æ‚çš„å†…å­˜ç®¡ç†ï¼Œä»¥åŠå¦‚ä½•é˜²æ­¢æ­»é”ç­‰æƒ…å†µã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å‘äººå‘˜æ‰¿å—ç€å·¨å¤§çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œå¹¶ä¸”åŸºäºè¿™ç±»ä¼ ç»Ÿå¹¶å‘æ¨¡å‹çš„ç¨‹åºéš¾äºç¼–å†™ã€é˜…è¯»ã€ç†è§£å’Œç»´æŠ¤ã€‚ä¸€æ—¦ç¨‹åºå‘ç”Ÿé—®é¢˜ï¼ŒæŸ¥æ‰¾Bugçš„è¿‡ç¨‹æ›´æ˜¯æ¼«é•¿å’Œè‰°è¾›ã€‚</p><p>ä½†Goè¯­è¨€å°±ä¸ä¸€æ ·äº†ï¼Goè¯­è¨€ä»è®¾è®¡ä¼Šå§‹ï¼Œå°±å°†è§£å†³ä¸Šé¢è¿™ä¸ªä¼ ç»Ÿå¹¶å‘æ¨¡å‹çš„é—®é¢˜ä½œä¸ºGoçš„ä¸€ä¸ªç›®æ ‡ï¼Œå¹¶åœ¨æ–°å¹¶å‘æ¨¡å‹è®¾è®¡ä¸­å€Ÿé‰´äº†è‘—åè®¡ç®—æœºç§‘å­¦å®¶<a href=\"https://en.wikipedia.org/wiki/Tony_Hoare\">Tony Hoare</a>æå‡ºçš„ <strong>CSPï¼ˆCommunicating Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹ï¼‰</strong>å¹¶å‘æ¨¡å‹ã€‚</p><p>Tony Hoareçš„CSPæ¨¡å‹æ—¨åœ¨ç®€åŒ–å¹¶å‘ç¨‹åºçš„ç¼–å†™ï¼Œè®©å¹¶å‘ç¨‹åºçš„ç¼–å†™ä¸ç¼–å†™é¡ºåºç¨‹åºä¸€æ ·ç®€å•ã€‚Tony Hoareè®¤ä¸ºè¾“å…¥è¾“å‡ºåº”è¯¥æ˜¯åŸºæœ¬çš„ç¼–ç¨‹åŸè¯­ï¼Œæ•°æ®å¤„ç†é€»è¾‘ï¼ˆä¹Ÿå°±æ˜¯CSPä¸­çš„Pï¼‰åªéœ€è°ƒç”¨è¾“å…¥åŸè¯­è·å–æ•°æ®ï¼Œé¡ºåºåœ°å¤„ç†æ•°æ®ï¼Œå¹¶å°†ç»“æœæ•°æ®é€šè¿‡è¾“å‡ºåŸè¯­è¾“å‡ºå°±å¯ä»¥äº†ã€‚</p><p>å› æ­¤ï¼Œåœ¨Tony Hoareçœ¼ä¸­ï¼Œ<strong>ä¸€ä¸ªç¬¦åˆCSPæ¨¡å‹çš„å¹¶å‘ç¨‹åºåº”è¯¥æ˜¯ä¸€ç»„é€šè¿‡è¾“å…¥è¾“å‡ºåŸè¯­è¿æ¥èµ·æ¥çš„Pçš„é›†åˆ</strong>ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼ŒCSPç†è®ºä¸ä»…æ˜¯ä¸€ä¸ªå¹¶å‘å‚è€ƒæ¨¡å‹ï¼Œä¹Ÿæ˜¯ä¸€ç§å¹¶å‘ç¨‹åºçš„ç¨‹åºç»„ç»‡æ–¹æ³•ã€‚å®ƒçš„ç»„åˆæ€æƒ³ä¸Goçš„è®¾è®¡å“²å­¦ä¸è°‹è€Œåˆã€‚</p><p>Tony Hoareçš„CSPç†è®ºä¸­çš„Pï¼Œä¹Ÿå°±æ˜¯â€œProcessï¼ˆè¿›ç¨‹ï¼‰â€ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå®ƒä»£è¡¨ä»»ä½•é¡ºåºå¤„ç†é€»è¾‘çš„å°è£…ï¼Œå®ƒè·å–è¾“å…¥æ•°æ®ï¼ˆæˆ–ä»å…¶ä»–Pçš„è¾“å‡ºè·å–ï¼‰ï¼Œå¹¶ç”Ÿäº§å‡ºå¯ä»¥è¢«å…¶ä»–Pæ¶ˆè´¹çš„è¾“å‡ºæ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç®€å•çœ‹ä¸‹CSPé€šä¿¡æ¨¡å‹çš„ç¤ºæ„å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e7/8c/e7c4fcc00ece399601de800e3a7f598c.jpg?wh=1920x465\" alt=\"å›¾ç‰‡\"></p><p>æ³¨æ„äº†ï¼Œè¿™é‡Œçš„På¹¶ä¸ä¸€å®šä¸æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹æˆ–çº¿ç¨‹åˆ’ç­‰å·ã€‚åœ¨Goä¸­ï¼Œä¸â€œProcessâ€å¯¹åº”çš„æ˜¯goroutineã€‚ä¸ºäº†å®ç°CSPå¹¶å‘æ¨¡å‹ä¸­çš„è¾“å…¥å’Œè¾“å‡ºåŸè¯­ï¼ŒGoè¿˜å¼•å…¥äº†goroutineï¼ˆPï¼‰ä¹‹é—´çš„é€šä¿¡åŸè¯­ <code>channel</code>ã€‚goroutineå¯ä»¥ä»channelè·å–è¾“å…¥æ•°æ®ï¼Œå†å°†å¤„ç†åå¾—åˆ°çš„ç»“æœæ•°æ®é€šè¿‡channelè¾“å‡ºã€‚é€šè¿‡channelå°†goroutineï¼ˆPï¼‰ç»„åˆè¿æ¥åœ¨ä¸€èµ·ï¼Œè®©è®¾è®¡å’Œç¼–å†™å¤§å‹å¹¶å‘ç³»ç»Ÿå˜å¾—æ›´åŠ ç®€å•å’Œæ¸…æ™°ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨ä¸ºé‚£äº›ä¼ ç»Ÿå…±äº«å†…å­˜å¹¶å‘æ¨¡å‹ä¸­çš„é—®é¢˜è€Œä¼¤è„‘ç­‹äº†ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬ä¸Šé¢æåˆ°çš„è·å–goroutineçš„é€€å‡ºçŠ¶æ€ï¼Œå°±å¯ä»¥ä½¿ç”¨channelåŸè¯­å®ç°ï¼š</p><pre><code class=\"language-plain\">func spawn(f func() error) &lt;-chan error {\n    c := make(chan error)\n\n    go func() {\n        c &lt;- f()\n    }()\n\n    return c\n}\n\nfunc main() {\n    c := spawn(func() error {\n        time.Sleep(2 * time.Second)\n        return errors.New(\"timeout\")\n    })\n    fmt.Println(&lt;-c)\n}\n</code></pre><p>è¿™ä¸ªç¤ºä¾‹åœ¨main goroutineä¸å­goroutineä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªå…ƒç´ ç±»å‹ä¸ºerrorçš„channelï¼Œå­goroutineé€€å‡ºæ—¶ï¼Œä¼šå°†å®ƒæ‰§è¡Œçš„å‡½æ•°çš„é”™è¯¯è¿”å›å€¼å†™å…¥è¿™ä¸ªchannelï¼Œmain goroutineå¯ä»¥é€šè¿‡è¯»å–channelçš„å€¼æ¥è·å–å­goroutineçš„é€€å‡ºçŠ¶æ€ã€‚</p><p>è™½ç„¶CSPæ¨¡å‹å·²ç»æˆä¸ºGoè¯­è¨€æ”¯æŒçš„ä¸»æµå¹¶å‘æ¨¡å‹ï¼Œä½†Goä¹Ÿæ”¯æŒä¼ ç»Ÿçš„ã€åŸºäºå…±äº«å†…å­˜çš„å¹¶å‘æ¨¡å‹ï¼Œå¹¶æä¾›äº†åŸºæœ¬çš„ä½çº§åˆ«åŒæ­¥åŸè¯­ï¼ˆä¸»è¦æ˜¯syncåŒ…ä¸­çš„äº’æ–¥é”ã€æ¡ä»¶å˜é‡ã€è¯»å†™é”ã€åŸå­æ“ä½œç­‰ï¼‰ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨å®è·µä¸­åº”è¯¥é€‰æ‹©å“ªä¸ªæ¨¡å‹çš„å¹¶å‘åŸè¯­å‘¢ï¼Ÿæ˜¯ä½¿ç”¨channelï¼Œè¿˜æ˜¯åœ¨ä½çº§åŒæ­¥åŸè¯­ä¿æŠ¤ä¸‹çš„å…±äº«å†…å­˜å‘¢ï¼Ÿ</p><p>æ¯«æ— ç–‘é—®ï¼Œä»ç¨‹åºçš„æ•´ä½“ç»“æ„æ¥çœ‹ï¼Œ<strong>Goå§‹ç»ˆæ¨èä»¥CSPå¹¶å‘æ¨¡å‹é£æ ¼æ„å»ºå¹¶å‘ç¨‹åº</strong>ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„ä¸šåŠ¡å±‚é¢ï¼Œè¿™èƒ½æå‡ç¨‹åºçš„é€»è¾‘æ¸…æ™°åº¦ï¼Œå¤§å¤§é™ä½å¹¶å‘è®¾è®¡çš„å¤æ‚æ€§ï¼Œå¹¶è®©ç¨‹åºæ›´å…·å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><p>ä¸è¿‡ï¼Œå¯¹äºå±€éƒ¨æƒ…å†µï¼Œæ¯”å¦‚æ¶‰åŠæ€§èƒ½æ•æ„Ÿçš„åŒºåŸŸæˆ–éœ€è¦ä¿æŠ¤çš„ç»“æ„ä½“æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´ä¸ºé«˜æ•ˆçš„ä½çº§åŒæ­¥åŸè¯­ï¼ˆå¦‚mutexï¼‰ï¼Œä¿è¯goroutineå¯¹æ•°æ®çš„åŒæ­¥è®¿é—®ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„è¯¾è®²åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œç°åœ¨æˆ‘ä»¬ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹å§ã€‚</p><p>è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹äº†å¯¹Goå¹¶å‘çš„å­¦ä¹ ï¼Œäº†è§£äº†å¹¶å‘çš„å«ä¹‰ï¼Œä»¥åŠå¹¶å‘ä¸å¹¶è¡Œä¸¤ä¸ªæ¦‚å¿µçš„åŒºåˆ«ã€‚ä½ ä¸€å®šè¦è®°ä½ï¼š<strong>å¹¶å‘ä¸æ˜¯å¹¶è¡Œ</strong>ã€‚å¹¶å‘æ˜¯åº”ç”¨ç»“æ„è®¾è®¡ç›¸å…³çš„æ¦‚å¿µï¼Œè€Œå¹¶è¡Œåªæ˜¯ç¨‹åºæ‰§è¡ŒæœŸçš„æ¦‚å¿µï¼Œå¹¶è¡Œçš„å¿…è¦æ¡ä»¶æ˜¯å…·æœ‰å¤šä¸ªå¤„ç†å™¨æˆ–å¤šæ ¸å¤„ç†å™¨ï¼Œå¦åˆ™æ— è®ºæ˜¯å¦æ˜¯å¹¶å‘çš„è®¾è®¡ï¼Œç¨‹åºæ‰§è¡Œæ—¶éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥è¢«è°ƒåº¦åˆ°å¤„ç†å™¨ä¸Šæ‰§è¡Œã€‚</p><p>ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼ˆæ¯”å¦‚ï¼šCã€C++ï¼‰çš„å¹¶å‘ç¨‹åºè®¾è®¡æ–¹æ¡ˆæ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦æ¨¡å‹çš„ï¼Œè¿™ç§æ¨¡å‹ä¸æ“ä½œç³»ç»Ÿçš„è°ƒåº¦å¼ºè€¦åˆï¼Œå¹¶ä¸”å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ååˆ†å¤æ‚ï¼Œå¼€å‘ä½“éªŒè¾ƒå·®å¹¶ä¸”æ˜“é”™ã€‚</p><p>è€ŒGoç»™å‡ºçš„å¹¶å‘æ–¹æ¡ˆæ˜¯åŸºäºè½»é‡çº§çº¿ç¨‹goroutineçš„ã€‚goroutineå ç”¨çš„èµ„æºéå¸¸å°ï¼Œåˆ›å»ºã€åˆ‡æ¢ä»¥åŠé”€æ¯çš„å¼€é”€å¾ˆå°ã€‚å¹¶ä¸”Goåœ¨è¯­æ³•å±‚é¢åŸç”Ÿæ”¯æŒåŸºäºgoroutineçš„å¹¶å‘ï¼Œé€šè¿‡ä¸€ä¸ªgoå…³é”®å­—ä¾¿å¯ä»¥è½»æ¾åˆ›å»ºgoroutineï¼Œgoroutineå ç”¨çš„èµ„æºéå¸¸å°ï¼Œåˆ›å»ºã€åˆ‡æ¢ä»¥åŠé”€æ¯çš„å¼€é”€å¾ˆå°ã€‚è¿™ç»™å¼€å‘è€…å¸¦æ¥æä½³çš„å¼€å‘ä½“éªŒã€‚</p><h2>æ€è€ƒé¢˜</h2><p>goroutineä½œä¸ºGoåº”ç”¨çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œå®ƒçš„åˆ›å»ºã€é€€å‡ºä»¥åŠgoroutineé—´çš„é€šä¿¡éƒ½æœ‰å¾ˆå¤šå¸¸è§çš„æ¨¡å¼å¯å¾ªã€‚ä½ å¯ä»¥åˆ†äº«ä¸€ä¸‹æ—¥å¸¸å¼€å‘ä¸­ä½ è§è¿‡çš„å®ç”¨çš„goroutineä½¿ç”¨æ¨¡å¼å—ï¼Ÿ</p><p>æ¬¢è¿æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šå¯¹Goå¹¶å‘æ„Ÿå…´è¶£çš„æœ‹å‹ã€‚æˆ‘æ˜¯Tony Baiï¼Œä¸‹èŠ‚è¯¾è§ã€‚</p>","comments":[{"had_liked":false,"id":343876,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1651109611,"is_pvip":false,"replies":[{"id":125661,"content":"ç¬¬ä¸€, goroutineæ˜¯è½»é‡çº§çº¿ç¨‹(G)ï¼Œå®ƒè¢«è°ƒåº¦åˆ°æ‰§è¡Œå™¨Mä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯cpuä¸Šã€‚Mä¼šè¢«osè°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œã€‚\nç¬¬äºŒï¼Œå¯è¿è¡Œçš„Gå…ˆè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªPç»‘å®šä¸€ä¸ªå¯ä»¥ç”¨äºæ‰§è¡ŒGçš„Mã€‚ä¹‹åè°ƒåº¦ç¨‹åºå¯ä»¥ä»Pé˜Ÿåˆ—ä¸­å–å‡ºGæ”¾åœ¨Mä¸Šæ‰§è¡Œã€‚ä¸€ä¸ªGæ‰§è¡Œä¸€å®šæ—¶é—´åï¼Œå†ä»é˜Ÿåˆ—ä¸­å–å‡ºå¦ä¸€ä¸ªGè¿è¡Œã€‚\n\nåŸºäºä¸Šè¿°æè¿°ï¼Œä½ çš„é—®é¢˜ï¼Œå½“mainä¸­é€šè¿‡go funcå¯åŠ¨ä¸€ä¸ªæ–°goroutineåï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªå¯è¿è¡Œçš„(runnable)çš„Gï¼Œæ–°Gä¼šè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—å¹¶ç­‰å¾…è¢«è°ƒåº¦ã€‚è‡³äºæ–°Gæ˜¯å¦ä¼šä¸åŸå…ˆçš„main Gåˆ†é…åˆ°ä¸€ä¸ªPä¸Šï¼Œä¸ç¡®å®šã€‚å¦‚æœæœºå™¨åªæœ‰ä¸€ä¸ªcpu coreã€‚é‚£ä¹ˆæ˜¾ç„¶å°±å¦‚ä½ æ‰€è¯´çš„ï¼Œæ–°Gä¸main Gè½®æµè¢«è°ƒåº¦æ‰§è¡Œã€‚å¦‚æœæœ‰å¤šä¸ªcpu coreï¼Œé‚£ä¹ˆæ–°Gä¸main Gå¯èƒ½å°±æ˜¯å¹¶è¡Œ(paralell)æ‰§è¡Œçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1651288697,"ip_address":"","comment_id":343876,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³ä¸å¤§æ¸…æ¥šï¼šå½“mainé‡Œé¢æœ‰go funcçš„æ—¶å€™ï¼Œæ˜¯ä¼šå°†go func æ”¾åˆ°å¦å¤–ä¸€ä¸ªå¤„ç†å™¨æ‰§è¡Œï¼›è¿˜æ˜¯è¯´å½“å‰å¤„ç†å™¨å…ˆæ‰§è¡Œgo funcï¼Œç„¶åä¸€æ®µæ—¶é—´åå›æ¥ç»§ç»­æ‰§è¡Œmainï¼Œè¿™æ ·åˆ‡æ¢æ¥åˆ‡æ¢å»çš„ã€‚","like_count":24},{"had_liked":false,"id":329927,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1641653374,"is_pvip":false,"replies":[{"id":120484,"content":"1. å¯¹ï¼Œn,måªæ˜¯åºå·ã€‚\n2.å¯¹ã€‚é€šå¸¸æˆ‘ä»¬ç”¨structæ¥æŠ½è±¡äº‹ç‰©ã€‚ä¿æŠ¤çš„ä¹Ÿæ˜¯é€šå¸¸ä¹Ÿæ˜¯è¿™ç§ç±»å‹æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042149,"ip_address":"","comment_id":329927,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆå¾ˆæ“…é•¿å°†å¤æ‚çš„çŸ¥è¯†æ·±å…¥æµ…å‡ºçš„è®²è§£å‡ºæ¥ï¼Œè¿™æ˜¯å¾ˆå¤šæ•™ç¨‹æ²¡æœ‰åšåˆ°çš„ã€‚è¯»äº†è¿™ä¸€ç¯‡ï¼Œå¯¹äºGoçš„å¹¶å‘è®¾è®¡æœ‰äº†æ–°çš„è®¤è¯†ï¼Œæ„çŠ¹æœªå°½ã€‚å¦æœ‰ä¸¤å¤„æ¨¡ç³Šçš„åœ°æ–¹ï¼š\n\n1. æ–‡ä¸­çš„ P-nã€P-mï¼Œè¿™é‡Œçš„nå’Œmåº”è¯¥æ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰å§ï¼Ÿ å°±æ˜¯æŒ‡ä»£ä¸€ä¸ªProcessè€Œå·²å§ï¼Ÿ\n\n2. æ–‡ä¸­è¯´ï¼šâ€œæ¯”å¦‚æ¶‰åŠæ€§èƒ½æ•æ„Ÿçš„åŒºåŸŸæˆ–éœ€è¦ä¿æŠ¤çš„ç»“æ„ä½“æ•°æ®æ—¶â€ï¼Œè¿™é‡Œçš„ï¼šç»“æ„ä½“æ•°æ®ï¼Œåº”è¯¥å°±æ˜¯Goçš„ struct å§ï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569010,"discussion_content":"ç¬¬ä¸€, goroutineæ˜¯è½»é‡çº§çº¿ç¨‹(G)ï¼Œå®ƒè¢«è°ƒåº¦åˆ°æ‰§è¡Œå™¨Mä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯cpuä¸Šã€‚Mä¼šè¢«osè°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œã€‚\nç¬¬äºŒï¼Œå¯è¿è¡Œçš„Gå…ˆè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªPç»‘å®šä¸€ä¸ªå¯ä»¥ç”¨äºæ‰§è¡ŒGçš„Mã€‚ä¹‹åè°ƒåº¦ç¨‹åºå¯ä»¥ä»Pé˜Ÿåˆ—ä¸­å–å‡ºGæ”¾åœ¨Mä¸Šæ‰§è¡Œã€‚ä¸€ä¸ªGæ‰§è¡Œä¸€å®šæ—¶é—´åï¼Œå†ä»é˜Ÿåˆ—ä¸­å–å‡ºå¦ä¸€ä¸ªGè¿è¡Œã€‚\n\nåŸºäºä¸Šè¿°æè¿°ï¼Œä½ çš„é—®é¢˜ï¼Œå½“mainä¸­é€šè¿‡go funcå¯åŠ¨ä¸€ä¸ªæ–°goroutineåï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªå¯è¿è¡Œçš„(runnable)çš„Gï¼Œæ–°Gä¼šè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—å¹¶ç­‰å¾…è¢«è°ƒåº¦ã€‚è‡³äºæ–°Gæ˜¯å¦ä¼šä¸åŸå…ˆçš„main Gåˆ†é…åˆ°ä¸€ä¸ªPä¸Šï¼Œä¸ç¡®å®šã€‚å¦‚æœæœºå™¨åªæœ‰ä¸€ä¸ªcpu coreã€‚é‚£ä¹ˆæ˜¾ç„¶å°±å¦‚ä½ æ‰€è¯´çš„ï¼Œæ–°Gä¸main Gè½®æµè¢«è°ƒåº¦æ‰§è¡Œã€‚å¦‚æœæœ‰å¤šä¸ªcpu coreï¼Œé‚£ä¹ˆæ–°Gä¸main Gå¯èƒ½å°±æ˜¯å¹¶è¡Œ(paralell)æ‰§è¡Œçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651288697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1039140,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/24/c3844db1.jpg","nickname":"æˆ‘æœ‰ç—…æˆ‘é«˜å…´ğŸ’¯","note":"","ucode":"4AA33757B8F09E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":579285,"discussion_content":"çœ‹åˆ°äº†ä¸‹ä¸€è¯¾ï¼Œå‘ç°è‡ªå·±é—®äº†ä¸ªæ²¡çœ‹æ‡‚çš„é—®é¢˜ã€‚ä¸Šæ¡é—®é¢˜å·²åˆ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657285373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":569010,"ip_address":"","group_id":0},"score":579285,"extra":""}]}]},{"had_liked":false,"id":348754,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1655369762,"is_pvip":false,"replies":[{"id":127017,"content":"å¥½é—®é¢˜ï¼\n\næˆ‘çš„ç†è§£æ˜¯ï¼šé‚£å°±éœ€è¦é‚£ä¸ªæ…¢ä¸šåŠ¡è°ƒç”¨æœ¬èº«ä¹Ÿæ”¯æŒContextã€‚å¾ˆå¤šäººè¯´context.Contextæœ‰â€œä¼ æŸ“â€æ•ˆåº”ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":1026224,"ctime":1655537758,"ip_address":"","comment_id":348754,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸‹å„ä½ã€‚\n\nfunc main() {\n    ctx, cancel := context.WithCancel(context.Background())\n\n    go func() {\n        defer func() {\n            fmt.Println(&quot;goroutine exit&quot;)\n        }()\n\n        for {\n            select {\n            case &lt;-ctx.Done():\n                return\n            default:\n                time.Sleep(time.Second)\n            }\n        }\n    }()\n\n    time.Sleep(time.Second)\n    cancel()\n    time.Sleep(2 * time.Second)\n}\n\n\næœ€è¿‘çœ‹å¹¶å‘åŸè¯­è¿™å—ã€‚ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯é€šè¿‡cancelContext æ¥ä¸­æ­¢ä¸€ä¸ª æ‰§è¡Œæ…¢ä¸šåŠ¡çš„groutineã€‚ æœ‰ä¸ªé—®é¢˜ä¸è§£ï¼Œé€šè¿‡select è¯­å¥ ç›‘å¬ä¸¤ä¸ª case ã€‚ å…¶ä¸­ä¸€ä¸ªcase ç”¨äºç›‘å¬ ctxå–æ¶ˆçš„ï¼Œç„¶åè¿”å›ç»ˆæ­¢å½“å‰groutineæ‰§è¡Œã€‚å¦ä¸€ä¸ªcase ç”¨æˆ·æ‰§è¡Œæ…¢ä¸šåŠ¡é€»è¾‘ã€‚\n\nè¿™é‡Œé—®é¢˜æ˜¯ï¼Œè¿™ä¸ªç›‘å¬çš„åŠ¨ä½œéœ€è¦ä¸åœçš„å»forå¾ªç¯ æ£€æŸ¥ctx.Done ï¼Œä½†æ˜¯çœŸæ­£çš„æ…¢ä¸šåŠ¡ ä¼šé˜»å¡ selectå•Šã€‚ä¹Ÿå°±æ£€æŸ¥ä¸åˆ° ctx.Doneå•Šï¼Œè¿˜æ€ä¹ˆèµ·åˆ° é€šè¿‡ctx æ§åˆ¶å–æ¶ˆæ…¢ä¸šåŠ¡groutineçš„ä½œç”¨å‘¢ï¼Ÿ\næ¯”å¦‚è¿™é‡Œçš„defaultè¯­å¥ å¦‚æœé‡Œé¢çš„ä¸šåŠ¡ä¸æ˜¯ç¡çœ 1ç§’è€Œæ˜¯å‘èµ·äº†ä¸€ä¸ªç½‘ç»œè°ƒç”¨éœ€è¦å¾ˆä¹…ï¼Œé‚£å³ä½¿ ä¸‹é¢cancel() è¢«è°ƒç”¨ selectè¯­å¥ä¸­ä¾ç„¶ä¼šè¢«é˜»å¡åœ¨ ç½‘ç»œè°ƒç”¨é‡Œã€‚","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545703,"discussion_content":"1. å¯¹ï¼Œn,måªæ˜¯åºå·ã€‚\n2.å¯¹ã€‚é€šå¸¸æˆ‘ä»¬ç”¨structæ¥æŠ½è±¡äº‹ç‰©ã€‚ä¿æŠ¤çš„ä¹Ÿæ˜¯é€šå¸¸ä¹Ÿæ˜¯è¿™ç§ç±»å‹æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348375,"user_name":"Junior Programmer","can_delete":false,"product_type":"c1","uid":2395539,"ip_address":"","ucode":"C56FF19934512E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tVrFvKWxQAuL7DE911OmlcqnfEkBnx14dBmCdI8eOx6ziaQB4Pgml65tcIDO4ePfW5yPTyAxGovYQmXLZHAPe2Q/132","comment_is_top":false,"comment_ctime":1655030451,"is_pvip":false,"replies":[{"id":126936,"content":"åŒæ­¥ä¸å¼‚æ­¥çš„æ¦‚å¿µåº”ç”¨å¾ˆå¹¿ï¼Œåœ¨å¾ˆå¤šé¢†åŸŸéƒ½æœ‰åº”ç”¨ã€‚æ¯”å¦‚é€šä¿¡é¢†åŸŸï¼Œæ¯”å¦‚å¹¶å‘ç¼–ç¨‹é¢†åŸŸã€‚\n\nè¿™ä¸€è®²çš„åŒæ­¥è®¾è®¡ä¸­çš„â€œåŒæ­¥(sync)â€æŒ‡çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­å¯¹ä¸´ç•ŒåŒºè¿›è¡Œâ€œäº’æ–¥â€è®¿é—®çš„æ¦‚å¿µï¼Œå³æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªgoroutineå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ“ä½œä¸´ç•ŒåŒºçš„æ•°æ®ã€‚å…¶ä»–goroutineåªèƒ½åœ¨ä¸´ç•ŒåŒºå¤–â€œæ’é˜Ÿâ€ç­‰å¾…æ—¶æœºè¿›å…¥ã€‚\n\nä¸è¿‡æ— è®ºç”¨åœ¨é‚£ä¸ªé¢†åŸŸï¼Œâ€œåŒæ­¥â€ä¸â€œå¼‚æ­¥â€çš„é€šç”¨å«ä¹‰æ˜¯ï¼š\n\nåŒæ­¥æ“ä½œï¼šæ‰§è¡Œæµ åªæœ‰ç­‰å¾…å‘èµ·çš„åŒæ­¥æ“ä½œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚\nå¼‚æ­¥æ“ä½œï¼šå‘èµ·å¼‚æ­¥æ“ä½œåï¼ŒåŸæ‰§è¡Œæµå¯ä»¥æ— éœ€ç­‰å¾…ï¼Œå³å¯å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1655102714,"ip_address":"","comment_id":348375,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä¹Ÿæƒ³è¯·é—®ä¸€ä¸‹è€å¸ˆï¼Œèƒ½ä¸èƒ½é¡ºä¾¿è®²è§£ä¸€ä¸‹ï¼ŒåŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575771,"discussion_content":"åŒæ­¥ä¸å¼‚æ­¥çš„æ¦‚å¿µåº”ç”¨å¾ˆå¹¿ï¼Œåœ¨å¾ˆå¤šé¢†åŸŸéƒ½æœ‰åº”ç”¨ã€‚æ¯”å¦‚é€šä¿¡é¢†åŸŸï¼Œæ¯”å¦‚å¹¶å‘ç¼–ç¨‹é¢†åŸŸã€‚\n\nè¿™ä¸€è®²çš„åŒæ­¥è®¾è®¡ä¸­çš„â€œåŒæ­¥(sync)â€æŒ‡çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­å¯¹ä¸´ç•ŒåŒºè¿›è¡Œâ€œäº’æ–¥â€è®¿é—®çš„æ¦‚å¿µï¼Œå³æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªgoroutineå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ“ä½œä¸´ç•ŒåŒºçš„æ•°æ®ã€‚å…¶ä»–goroutineåªèƒ½åœ¨ä¸´ç•ŒåŒºå¤–â€œæ’é˜Ÿâ€ç­‰å¾…æ—¶æœºè¿›å…¥ã€‚\n\nä¸è¿‡æ— è®ºç”¨åœ¨é‚£ä¸ªé¢†åŸŸï¼Œâ€œåŒæ­¥â€ä¸â€œå¼‚æ­¥â€çš„é€šç”¨å«ä¹‰æ˜¯ï¼š\n\nåŒæ­¥æ“ä½œï¼šæ‰§è¡Œæµ åªæœ‰ç­‰å¾…å‘èµ·çš„åŒæ­¥æ“ä½œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚\nå¼‚æ­¥æ“ä½œï¼šå‘èµ·å¼‚æ­¥æ“ä½œåï¼ŒåŸæ‰§è¡Œæµå¯ä»¥æ— éœ€ç­‰å¾…ï¼Œå³å¯å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655102714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329853,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1641599711,"is_pvip":false,"replies":[{"id":120486,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042163,"ip_address":"","comment_id":329853,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä½œä¸ºä¸€ä¸ªå¼€å‘è€…ï¼Œè¿˜æ˜¯è¦å°½æ—©äº†è§£å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ï¼Œè¿™èŠ‚è¯¾è¦å¥½å¥½çš„å­¦ä¹ å’Œç†è§£ã€‚","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545705,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361479,"user_name":"å·¦è€³æœµä¸œ","can_delete":false,"product_type":"c1","uid":1160678,"ip_address":"åŒ—äº¬","ucode":"60134ACF12BB52","user_header":"https://static001.geekbang.org/account/avatar/00/11/b5/e6/c67f12bd.jpg","comment_is_top":false,"comment_ctime":1667534672,"is_pvip":false,"replies":[{"id":131598,"content":"æœ‰ç‚¹è¿™ä¸ªæ„æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1667817990,"ip_address":"åŒ—äº¬","comment_id":361479,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¯ä¸å¯ä»¥è¿™æ ·ç†è§£ï¼šè¾“å…¥è¾“å‡ºåŸè¯­åº”ç”¨åœ¨å‡½æ•°ä¸Šå°±æ˜¯å‡½æ•°ç­¾åï¼ˆå‚æ•°ã€è¿”å›å€¼ï¼‰ï¼Œåº”ç”¨åˆ° goroutine ä¹‹é—´å°±æ˜¯ channelã€‚å…·ä½“ä¸€ç‚¹ï¼Œåœ¨å‡½æ•°åœºæ™¯æƒ³è¦è¾“å…¥é©¬ä¸Šæƒ³åˆ°é€šè¿‡å‚æ•°ä¼ å…¥ï¼Œæƒ³è¦è¾“å‡ºé€šè¿‡è¿”å›å€¼ç»™ï¼›åœ¨ goroutine ä¹‹é—´ï¼Œæƒ³è¦è¾“å…¥åˆ™é©¬ä¸Šæƒ³åˆ°é€šè¿‡ channel æ‹¿ï¼Œæƒ³è¦æŠŠå¤„ç†ç»“æœè¾“å‡ºï¼Œæ”¾åˆ° channel ä¸­å°±è¡Œäº†ã€‚","like_count":5,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592951,"discussion_content":"æœ‰ç‚¹è¿™ä¸ªæ„æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667817990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348374,"user_name":"Junior Programmer","can_delete":false,"product_type":"c1","uid":2395539,"ip_address":"","ucode":"C56FF19934512E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tVrFvKWxQAuL7DE911OmlcqnfEkBnx14dBmCdI8eOx6ziaQB4Pgml65tcIDO4ePfW5yPTyAxGovYQmXLZHAPe2Q/132","comment_is_top":false,"comment_ctime":1655030243,"is_pvip":false,"replies":[{"id":126935,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1655101308,"ip_address":"","comment_id":348374,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯»äº†è¿™èŠ‚è¯¾ï¼Œè®©æˆ‘æ¸…æ™°è®¤è¯†åˆ°ä¹‹å‰çš„çš„ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ã€‚å¹¶å‘ï¼šé’ˆå¯¹çš„æ˜¯ç¨‹åºç»“æ„è®¾è®¡ï¼Œå°†ä¸€ä¸ªç¨‹åºåˆ†æˆè‹¥å¹²ä¸ªæ¨¡å—ï¼Œä¸åŒæ¨¡å—å•ç‹¬æ‰§è¡Œï¼Œç”±å¤šä¸ªæ¨¡å—ç›¸äº’äº¤æ›¿æ‰§è¡Œï¼Œå®ç°ç¨‹åºçš„è¿è¡Œã€‚å¹¶è¡Œï¼šé’ˆå¯¹çš„ç¨‹åºçš„æ‰§è¡Œï¼ŒæŒ‡çš„æ˜¯åŒä¸€æ—¶é—´ç‚¹ï¼Œæœ‰ä¸ªå¤šä¸ªä»»åŠ¡åœ¨è¢«å¤šä¸ªæˆ–è€…å¤šæ ¸çš„CPUä¸‹è°ƒåº¦æ‰§è¡Œã€‚","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592951,"discussion_content":"æœ‰ç‚¹è¿™ä¸ªæ„æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667817990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366845,"user_name":"é˜¿æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1136547,"ip_address":"å››å·","ucode":"C5B7FA33365A28","user_header":"https://static001.geekbang.org/account/avatar/00/11/57/a3/09efc7cb.jpg","comment_is_top":false,"comment_ctime":1674446009,"is_pvip":false,"replies":[{"id":133707,"content":"âœ…ğŸ‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1674692637,"ip_address":"è¾½å®","comment_id":366845,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"\nfunc spawn(f func() error) &lt;-chan error {\n    c := make(chan error)\n\n    go func() {\n        c &lt;- f()\n    }()\n\n    return c\n}\n\nfunc main() {\n    c := spawn(func() error {\n        time.Sleep(2 * time.Second)\n        return errors.New(&quot;timeout&quot;)\n    })\n    fmt.Println(&quot;hello,world1&quot;)\n    fmt.Println(&lt;-c)\n    fmt.Println(&quot;hello,world2&quot;)\n}\n\n\né€šè¿‡å¯¹ä¸Šé¢çš„ä»£ç æµ‹è¯•åæˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„: \nspawnä¸­çš„ go func() æ˜¯å¼‚æ­¥æ‰§è¡Œ(å¯èƒ½ä¸ä¸»çº¿ç¨‹æ˜¯å¹¶è¡Œ), æ‰€ä»¥åœ¨ä¸»çº¿ç¨‹ä¸­çš„spawnä¸ä¼šé˜»å¡ï¼Œå…ˆæ‰“å°å‡ºäº† &quot;hello,world1&quot;, ç­‰åˆ°æ‰“å° &lt;-c çš„æ—¶å€™å°±é˜»å¡äº†ï¼Œç­‰ä»c ä¸­è¯»å‡ºæ•°æ®æ‰“å°ç»“æŸåæ‰ä¼šç»§ç»­æ‰§è¡Œåç»­çš„æ‰“å° &quot;hello,world2&quot;ã€‚ æ‰€ä»¥è¯´ä»channel ä¸­è¯»å–æ•°æ®å¯ä»¥è®¤ä¸ºè‚¯å®šæ˜¯ä¸€ä¸ªé˜»å¡çš„åŒæ­¥æ•°æ®æ“ä½œï¼Œä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600652,"discussion_content":"âœ…ğŸ‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674692637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330239,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1641876923,"is_pvip":false,"replies":[{"id":120545,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050585,"ip_address":"","comment_id":330239,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"CSPã€å“åº”å¼ç¼–ç¨‹ç®€ä»‹ï¼š\nCSPï¼ˆCommunicationing Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹ï¼‰å¹¶å‘æ¨¡å‹\nå“åº”å¼ç¼–ç¨‹æˆ–ååº”å¼ç¼–ç¨‹ï¼ˆè‹±è¯­ï¼šReactive programmingï¼‰æ˜¯ä¸€ç§é¢å‘æ•°æ®æµå’Œå˜åŒ–ä¼ æ’­çš„å£°æ˜å¼ç¼–ç¨‹èŒƒå¼ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å¾ˆæ–¹ä¾¿åœ°è¡¨è¾¾é™æ€æˆ–åŠ¨æ€çš„æ•°æ®æµï¼Œè€Œç›¸å…³çš„è®¡ç®—æ¨¡å‹ä¼šè‡ªåŠ¨å°†å˜åŒ–çš„å€¼é€šè¿‡æ•°æ®æµè¿›è¡Œä¼ æ’­ã€‚\n\nCSPã€å“åº”å¼ç¼–ç¨‹ä¸¤è€…çš„æ€æƒ³éå¸¸åƒï¼ˆä»¥æˆ‘ç›®å‰çš„ç†è§£æ²¡çœ‹å‡ºåŒºåˆ«ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨Javaã€Scalaä¹‹ç±»çš„è¯­è¨€å®ç°å“åº”å¼ç¼–ç¨‹ä¸€èˆ¬éœ€è¦å€ŸåŠ©é¢å¤–çš„æ¡†æ¶ç¼–ç¨‹ï¼ˆä¾‹å¦‚ Reactorï¼‰ã€‚\nä½†ä½¿ç”¨ Go ç¼–ç¨‹å±…ç„¶æ˜¯è¯­è¨€è‡ªå¸¦çš„ç‰¹æ€§ï¼Œä¸€ä¸ªå…³é”®å­— go å°±è¡Œäº†ï¼","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600652,"discussion_content":"âœ…ğŸ‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674692637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356638,"user_name":"è èå¹é›ªâ€”Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"åŒ—äº¬","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1662459997,"is_pvip":false,"replies":[{"id":129873,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1662684219,"ip_address":"åŒ—äº¬","comment_id":356638,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¿™èŠ‚è®²çš„å¤ªå¥½äº†ï¼Œå¹¶å‘å’Œå¹¶è¡Œç†è§£é€äº†","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545788,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343876,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1651109611,"is_pvip":false,"replies":[{"id":125661,"content":"ç¬¬ä¸€, goroutineæ˜¯è½»é‡çº§çº¿ç¨‹(G)ï¼Œå®ƒè¢«è°ƒåº¦åˆ°æ‰§è¡Œå™¨Mä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯cpuä¸Šã€‚Mä¼šè¢«osè°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œã€‚\nç¬¬äºŒï¼Œå¯è¿è¡Œçš„Gå…ˆè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªPç»‘å®šä¸€ä¸ªå¯ä»¥ç”¨äºæ‰§è¡ŒGçš„Mã€‚ä¹‹åè°ƒåº¦ç¨‹åºå¯ä»¥ä»Pé˜Ÿåˆ—ä¸­å–å‡ºGæ”¾åœ¨Mä¸Šæ‰§è¡Œã€‚ä¸€ä¸ªGæ‰§è¡Œä¸€å®šæ—¶é—´åï¼Œå†ä»é˜Ÿåˆ—ä¸­å–å‡ºå¦ä¸€ä¸ªGè¿è¡Œã€‚\n\nåŸºäºä¸Šè¿°æè¿°ï¼Œä½ çš„é—®é¢˜ï¼Œå½“mainä¸­é€šè¿‡go funcå¯åŠ¨ä¸€ä¸ªæ–°goroutineåï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªå¯è¿è¡Œçš„(runnable)çš„Gï¼Œæ–°Gä¼šè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—å¹¶ç­‰å¾…è¢«è°ƒåº¦ã€‚è‡³äºæ–°Gæ˜¯å¦ä¼šä¸åŸå…ˆçš„main Gåˆ†é…åˆ°ä¸€ä¸ªPä¸Šï¼Œä¸ç¡®å®šã€‚å¦‚æœæœºå™¨åªæœ‰ä¸€ä¸ªcpu coreã€‚é‚£ä¹ˆæ˜¾ç„¶å°±å¦‚ä½ æ‰€è¯´çš„ï¼Œæ–°Gä¸main Gè½®æµè¢«è°ƒåº¦æ‰§è¡Œã€‚å¦‚æœæœ‰å¤šä¸ªcpu coreï¼Œé‚£ä¹ˆæ–°Gä¸main Gå¯èƒ½å°±æ˜¯å¹¶è¡Œ(paralell)æ‰§è¡Œçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1651288697,"ip_address":"","comment_id":343876,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³ä¸å¤§æ¸…æ¥šï¼šå½“mainé‡Œé¢æœ‰go funcçš„æ—¶å€™ï¼Œæ˜¯ä¼šå°†go func æ”¾åˆ°å¦å¤–ä¸€ä¸ªå¤„ç†å™¨æ‰§è¡Œï¼›è¿˜æ˜¯è¯´å½“å‰å¤„ç†å™¨å…ˆæ‰§è¡Œgo funcï¼Œç„¶åä¸€æ®µæ—¶é—´åå›æ¥ç»§ç»­æ‰§è¡Œmainï¼Œè¿™æ ·åˆ‡æ¢æ¥åˆ‡æ¢å»çš„ã€‚","like_count":24,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569010,"discussion_content":"ç¬¬ä¸€, goroutineæ˜¯è½»é‡çº§çº¿ç¨‹(G)ï¼Œå®ƒè¢«è°ƒåº¦åˆ°æ‰§è¡Œå™¨Mä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯cpuä¸Šã€‚Mä¼šè¢«osè°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œã€‚\nç¬¬äºŒï¼Œå¯è¿è¡Œçš„Gå…ˆè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªPç»‘å®šä¸€ä¸ªå¯ä»¥ç”¨äºæ‰§è¡ŒGçš„Mã€‚ä¹‹åè°ƒåº¦ç¨‹åºå¯ä»¥ä»Pé˜Ÿåˆ—ä¸­å–å‡ºGæ”¾åœ¨Mä¸Šæ‰§è¡Œã€‚ä¸€ä¸ªGæ‰§è¡Œä¸€å®šæ—¶é—´åï¼Œå†ä»é˜Ÿåˆ—ä¸­å–å‡ºå¦ä¸€ä¸ªGè¿è¡Œã€‚\n\nåŸºäºä¸Šè¿°æè¿°ï¼Œä½ çš„é—®é¢˜ï¼Œå½“mainä¸­é€šè¿‡go funcå¯åŠ¨ä¸€ä¸ªæ–°goroutineåï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªå¯è¿è¡Œçš„(runnable)çš„Gï¼Œæ–°Gä¼šè¢«æ”¾å…¥Pçš„é˜Ÿåˆ—å¹¶ç­‰å¾…è¢«è°ƒåº¦ã€‚è‡³äºæ–°Gæ˜¯å¦ä¼šä¸åŸå…ˆçš„main Gåˆ†é…åˆ°ä¸€ä¸ªPä¸Šï¼Œä¸ç¡®å®šã€‚å¦‚æœæœºå™¨åªæœ‰ä¸€ä¸ªcpu coreã€‚é‚£ä¹ˆæ˜¾ç„¶å°±å¦‚ä½ æ‰€è¯´çš„ï¼Œæ–°Gä¸main Gè½®æµè¢«è°ƒåº¦æ‰§è¡Œã€‚å¦‚æœæœ‰å¤šä¸ªcpu coreï¼Œé‚£ä¹ˆæ–°Gä¸main Gå¯èƒ½å°±æ˜¯å¹¶è¡Œ(paralell)æ‰§è¡Œçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651288697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1039140,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/24/c3844db1.jpg","nickname":"æˆ‘æœ‰ç—…æˆ‘é«˜å…´ğŸ’¯","note":"","ucode":"4AA33757B8F09E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":579285,"discussion_content":"çœ‹åˆ°äº†ä¸‹ä¸€è¯¾ï¼Œå‘ç°è‡ªå·±é—®äº†ä¸ªæ²¡çœ‹æ‡‚çš„é—®é¢˜ã€‚ä¸Šæ¡é—®é¢˜å·²åˆ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657285373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":569010,"ip_address":"","group_id":0},"score":579285,"extra":""}]}]},{"had_liked":false,"id":329927,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1641653374,"is_pvip":false,"replies":[{"id":120484,"content":"1. å¯¹ï¼Œn,måªæ˜¯åºå·ã€‚\n2.å¯¹ã€‚é€šå¸¸æˆ‘ä»¬ç”¨structæ¥æŠ½è±¡äº‹ç‰©ã€‚ä¿æŠ¤çš„ä¹Ÿæ˜¯é€šå¸¸ä¹Ÿæ˜¯è¿™ç§ç±»å‹æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042149,"ip_address":"","comment_id":329927,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆå¾ˆæ“…é•¿å°†å¤æ‚çš„çŸ¥è¯†æ·±å…¥æµ…å‡ºçš„è®²è§£å‡ºæ¥ï¼Œè¿™æ˜¯å¾ˆå¤šæ•™ç¨‹æ²¡æœ‰åšåˆ°çš„ã€‚è¯»äº†è¿™ä¸€ç¯‡ï¼Œå¯¹äºGoçš„å¹¶å‘è®¾è®¡æœ‰äº†æ–°çš„è®¤è¯†ï¼Œæ„çŠ¹æœªå°½ã€‚å¦æœ‰ä¸¤å¤„æ¨¡ç³Šçš„åœ°æ–¹ï¼š\n\n1. æ–‡ä¸­çš„ P-nã€P-mï¼Œè¿™é‡Œçš„nå’Œmåº”è¯¥æ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰å§ï¼Ÿ å°±æ˜¯æŒ‡ä»£ä¸€ä¸ªProcessè€Œå·²å§ï¼Ÿ\n\n2. æ–‡ä¸­è¯´ï¼šâ€œæ¯”å¦‚æ¶‰åŠæ€§èƒ½æ•æ„Ÿçš„åŒºåŸŸæˆ–éœ€è¦ä¿æŠ¤çš„ç»“æ„ä½“æ•°æ®æ—¶â€ï¼Œè¿™é‡Œçš„ï¼šç»“æ„ä½“æ•°æ®ï¼Œåº”è¯¥å°±æ˜¯Goçš„ struct å§ï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545703,"discussion_content":"1. å¯¹ï¼Œn,måªæ˜¯åºå·ã€‚\n2.å¯¹ã€‚é€šå¸¸æˆ‘ä»¬ç”¨structæ¥æŠ½è±¡äº‹ç‰©ã€‚ä¿æŠ¤çš„ä¹Ÿæ˜¯é€šå¸¸ä¹Ÿæ˜¯è¿™ç§ç±»å‹æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348754,"user_name":"è·¯è¾¹çš„çŒª","can_delete":false,"product_type":"c1","uid":2057354,"ip_address":"","ucode":"92F7C082E44FC4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","comment_is_top":false,"comment_ctime":1655369762,"is_pvip":false,"replies":[{"id":127017,"content":"å¥½é—®é¢˜ï¼\n\næˆ‘çš„ç†è§£æ˜¯ï¼šé‚£å°±éœ€è¦é‚£ä¸ªæ…¢ä¸šåŠ¡è°ƒç”¨æœ¬èº«ä¹Ÿæ”¯æŒContextã€‚å¾ˆå¤šäººè¯´context.Contextæœ‰â€œä¼ æŸ“â€æ•ˆåº”ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":1026224,"ctime":1655537758,"ip_address":"","comment_id":348754,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"æœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸‹å„ä½ã€‚\n\nfunc main() {\n    ctx, cancel := context.WithCancel(context.Background())\n\n    go func() {\n        defer func() {\n            fmt.Println(&quot;goroutine exit&quot;)\n        }()\n\n        for {\n            select {\n            case &lt;-ctx.Done():\n                return\n            default:\n                time.Sleep(time.Second)\n            }\n        }\n    }()\n\n    time.Sleep(time.Second)\n    cancel()\n    time.Sleep(2 * time.Second)\n}\n\n\næœ€è¿‘çœ‹å¹¶å‘åŸè¯­è¿™å—ã€‚ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯é€šè¿‡cancelContext æ¥ä¸­æ­¢ä¸€ä¸ª æ‰§è¡Œæ…¢ä¸šåŠ¡çš„groutineã€‚ æœ‰ä¸ªé—®é¢˜ä¸è§£ï¼Œé€šè¿‡select è¯­å¥ ç›‘å¬ä¸¤ä¸ª case ã€‚ å…¶ä¸­ä¸€ä¸ªcase ç”¨äºç›‘å¬ ctxå–æ¶ˆçš„ï¼Œç„¶åè¿”å›ç»ˆæ­¢å½“å‰groutineæ‰§è¡Œã€‚å¦ä¸€ä¸ªcase ç”¨æˆ·æ‰§è¡Œæ…¢ä¸šåŠ¡é€»è¾‘ã€‚\n\nè¿™é‡Œé—®é¢˜æ˜¯ï¼Œè¿™ä¸ªç›‘å¬çš„åŠ¨ä½œéœ€è¦ä¸åœçš„å»forå¾ªç¯ æ£€æŸ¥ctx.Done ï¼Œä½†æ˜¯çœŸæ­£çš„æ…¢ä¸šåŠ¡ ä¼šé˜»å¡ selectå•Šã€‚ä¹Ÿå°±æ£€æŸ¥ä¸åˆ° ctx.Doneå•Šï¼Œè¿˜æ€ä¹ˆèµ·åˆ° é€šè¿‡ctx æ§åˆ¶å–æ¶ˆæ…¢ä¸šåŠ¡groutineçš„ä½œç”¨å‘¢ï¼Ÿ\næ¯”å¦‚è¿™é‡Œçš„defaultè¯­å¥ å¦‚æœé‡Œé¢çš„ä¸šåŠ¡ä¸æ˜¯ç¡çœ 1ç§’è€Œæ˜¯å‘èµ·äº†ä¸€ä¸ªç½‘ç»œè°ƒç”¨éœ€è¦å¾ˆä¹…ï¼Œé‚£å³ä½¿ ä¸‹é¢cancel() è¢«è°ƒç”¨ selectè¯­å¥ä¸­ä¾ç„¶ä¼šè¢«é˜»å¡åœ¨ ç½‘ç»œè°ƒç”¨é‡Œã€‚","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576425,"discussion_content":"å¥½é—®é¢˜ï¼\n\næˆ‘çš„ç†è§£æ˜¯ï¼šé‚£å°±éœ€è¦é‚£ä¸ªæ…¢ä¸šåŠ¡è°ƒç”¨æœ¬èº«ä¹Ÿæ”¯æŒContextã€‚å¾ˆå¤šäººè¯´context.Contextæœ‰â€œä¼ æŸ“â€æ•ˆåº”ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655537758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070729,"avatar":"https://static001.geekbang.org/account/avatar/00/10/56/89/30c2f416.jpg","nickname":"Tal.Huang","note":"","ucode":"9486C855060FAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631413,"discussion_content":"contextæ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªgoroutineä¸Šä¼ æ’­æ¯”è¾ƒå¥½ å¤šä¸ªgoroutine ä½¿ç”¨channel","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699511153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2057354,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","nickname":"è·¯è¾¹çš„çŒª","note":"","ucode":"92F7C082E44FC4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607815,"discussion_content":"withtimeout ä¹Ÿä¸€æ ·è§£å†³ä¸äº†è¿™ä¸ªé—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1678118317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591281,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼Œä¸šåŠ¡ä¸èƒ½æ— é™åˆ¶çš„å¤„ç†ï¼Œæ‰€ä»¥ä½ çš„ctxåº”è¯¥æ˜¯withtimeoutç”Ÿæˆçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666423521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348375,"user_name":"Junior Programmer","can_delete":false,"product_type":"c1","uid":2395539,"ip_address":"","ucode":"C56FF19934512E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tVrFvKWxQAuL7DE911OmlcqnfEkBnx14dBmCdI8eOx6ziaQB4Pgml65tcIDO4ePfW5yPTyAxGovYQmXLZHAPe2Q/132","comment_is_top":false,"comment_ctime":1655030451,"is_pvip":false,"replies":[{"id":126936,"content":"åŒæ­¥ä¸å¼‚æ­¥çš„æ¦‚å¿µåº”ç”¨å¾ˆå¹¿ï¼Œåœ¨å¾ˆå¤šé¢†åŸŸéƒ½æœ‰åº”ç”¨ã€‚æ¯”å¦‚é€šä¿¡é¢†åŸŸï¼Œæ¯”å¦‚å¹¶å‘ç¼–ç¨‹é¢†åŸŸã€‚\n\nè¿™ä¸€è®²çš„åŒæ­¥è®¾è®¡ä¸­çš„â€œåŒæ­¥(sync)â€æŒ‡çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­å¯¹ä¸´ç•ŒåŒºè¿›è¡Œâ€œäº’æ–¥â€è®¿é—®çš„æ¦‚å¿µï¼Œå³æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªgoroutineå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ“ä½œä¸´ç•ŒåŒºçš„æ•°æ®ã€‚å…¶ä»–goroutineåªèƒ½åœ¨ä¸´ç•ŒåŒºå¤–â€œæ’é˜Ÿâ€ç­‰å¾…æ—¶æœºè¿›å…¥ã€‚\n\nä¸è¿‡æ— è®ºç”¨åœ¨é‚£ä¸ªé¢†åŸŸï¼Œâ€œåŒæ­¥â€ä¸â€œå¼‚æ­¥â€çš„é€šç”¨å«ä¹‰æ˜¯ï¼š\n\nåŒæ­¥æ“ä½œï¼šæ‰§è¡Œæµ åªæœ‰ç­‰å¾…å‘èµ·çš„åŒæ­¥æ“ä½œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚\nå¼‚æ­¥æ“ä½œï¼šå‘èµ·å¼‚æ­¥æ“ä½œåï¼ŒåŸæ‰§è¡Œæµå¯ä»¥æ— éœ€ç­‰å¾…ï¼Œå³å¯å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1655102714,"ip_address":"","comment_id":348375,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä¹Ÿæƒ³è¯·é—®ä¸€ä¸‹è€å¸ˆï¼Œèƒ½ä¸èƒ½é¡ºä¾¿è®²è§£ä¸€ä¸‹ï¼ŒåŒæ­¥å’Œå¼‚æ­¥çš„æ¦‚å¿µ","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576425,"discussion_content":"å¥½é—®é¢˜ï¼\n\næˆ‘çš„ç†è§£æ˜¯ï¼šé‚£å°±éœ€è¦é‚£ä¸ªæ…¢ä¸šåŠ¡è°ƒç”¨æœ¬èº«ä¹Ÿæ”¯æŒContextã€‚å¾ˆå¤šäººè¯´context.Contextæœ‰â€œä¼ æŸ“â€æ•ˆåº”ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655537758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070729,"avatar":"https://static001.geekbang.org/account/avatar/00/10/56/89/30c2f416.jpg","nickname":"Tal.Huang","note":"","ucode":"9486C855060FAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631413,"discussion_content":"contextæ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªgoroutineä¸Šä¼ æ’­æ¯”è¾ƒå¥½ å¤šä¸ªgoroutine ä½¿ç”¨channel","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699511153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2057354,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/64/8a/bc8cb43c.jpg","nickname":"è·¯è¾¹çš„çŒª","note":"","ucode":"92F7C082E44FC4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607815,"discussion_content":"withtimeout ä¹Ÿä¸€æ ·è§£å†³ä¸äº†è¿™ä¸ªé—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1678118317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591281,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼Œä¸šåŠ¡ä¸èƒ½æ— é™åˆ¶çš„å¤„ç†ï¼Œæ‰€ä»¥ä½ çš„ctxåº”è¯¥æ˜¯withtimeoutç”Ÿæˆçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666423521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329853,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1641599711,"is_pvip":false,"replies":[{"id":120486,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042163,"ip_address":"","comment_id":329853,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"ä½œä¸ºä¸€ä¸ªå¼€å‘è€…ï¼Œè¿˜æ˜¯è¦å°½æ—©äº†è§£å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ï¼Œè¿™èŠ‚è¯¾è¦å¥½å¥½çš„å­¦ä¹ å’Œç†è§£ã€‚","like_count":6,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575771,"discussion_content":"åŒæ­¥ä¸å¼‚æ­¥çš„æ¦‚å¿µåº”ç”¨å¾ˆå¹¿ï¼Œåœ¨å¾ˆå¤šé¢†åŸŸéƒ½æœ‰åº”ç”¨ã€‚æ¯”å¦‚é€šä¿¡é¢†åŸŸï¼Œæ¯”å¦‚å¹¶å‘ç¼–ç¨‹é¢†åŸŸã€‚\n\nè¿™ä¸€è®²çš„åŒæ­¥è®¾è®¡ä¸­çš„â€œåŒæ­¥(sync)â€æŒ‡çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­å¯¹ä¸´ç•ŒåŒºè¿›è¡Œâ€œäº’æ–¥â€è®¿é—®çš„æ¦‚å¿µï¼Œå³æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªgoroutineå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ“ä½œä¸´ç•ŒåŒºçš„æ•°æ®ã€‚å…¶ä»–goroutineåªèƒ½åœ¨ä¸´ç•ŒåŒºå¤–â€œæ’é˜Ÿâ€ç­‰å¾…æ—¶æœºè¿›å…¥ã€‚\n\nä¸è¿‡æ— è®ºç”¨åœ¨é‚£ä¸ªé¢†åŸŸï¼Œâ€œåŒæ­¥â€ä¸â€œå¼‚æ­¥â€çš„é€šç”¨å«ä¹‰æ˜¯ï¼š\n\nåŒæ­¥æ“ä½œï¼šæ‰§è¡Œæµ åªæœ‰ç­‰å¾…å‘èµ·çš„åŒæ­¥æ“ä½œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚\nå¼‚æ­¥æ“ä½œï¼šå‘èµ·å¼‚æ­¥æ“ä½œåï¼ŒåŸæ‰§è¡Œæµå¯ä»¥æ— éœ€ç­‰å¾…ï¼Œå³å¯å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655102714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361479,"user_name":"å·¦è€³æœµä¸œ","can_delete":false,"product_type":"c1","uid":1160678,"ip_address":"åŒ—äº¬","ucode":"60134ACF12BB52","user_header":"https://static001.geekbang.org/account/avatar/00/11/b5/e6/c67f12bd.jpg","comment_is_top":false,"comment_ctime":1667534672,"is_pvip":false,"replies":[{"id":131598,"content":"æœ‰ç‚¹è¿™ä¸ªæ„æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1667817990,"ip_address":"åŒ—äº¬","comment_id":361479,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"å¯ä¸å¯ä»¥è¿™æ ·ç†è§£ï¼šè¾“å…¥è¾“å‡ºåŸè¯­åº”ç”¨åœ¨å‡½æ•°ä¸Šå°±æ˜¯å‡½æ•°ç­¾åï¼ˆå‚æ•°ã€è¿”å›å€¼ï¼‰ï¼Œåº”ç”¨åˆ° goroutine ä¹‹é—´å°±æ˜¯ channelã€‚å…·ä½“ä¸€ç‚¹ï¼Œåœ¨å‡½æ•°åœºæ™¯æƒ³è¦è¾“å…¥é©¬ä¸Šæƒ³åˆ°é€šè¿‡å‚æ•°ä¼ å…¥ï¼Œæƒ³è¦è¾“å‡ºé€šè¿‡è¿”å›å€¼ç»™ï¼›åœ¨ goroutine ä¹‹é—´ï¼Œæƒ³è¦è¾“å…¥åˆ™é©¬ä¸Šæƒ³åˆ°é€šè¿‡ channel æ‹¿ï¼Œæƒ³è¦æŠŠå¤„ç†ç»“æœè¾“å‡ºï¼Œæ”¾åˆ° channel ä¸­å°±è¡Œäº†ã€‚","like_count":5,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545705,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348374,"user_name":"Junior Programmer","can_delete":false,"product_type":"c1","uid":2395539,"ip_address":"","ucode":"C56FF19934512E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tVrFvKWxQAuL7DE911OmlcqnfEkBnx14dBmCdI8eOx6ziaQB4Pgml65tcIDO4ePfW5yPTyAxGovYQmXLZHAPe2Q/132","comment_is_top":false,"comment_ctime":1655030243,"is_pvip":false,"replies":[{"id":126935,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1655101308,"ip_address":"","comment_id":348374,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¯»äº†è¿™èŠ‚è¯¾ï¼Œè®©æˆ‘æ¸…æ™°è®¤è¯†åˆ°ä¹‹å‰çš„çš„ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ã€‚å¹¶å‘ï¼šé’ˆå¯¹çš„æ˜¯ç¨‹åºç»“æ„è®¾è®¡ï¼Œå°†ä¸€ä¸ªç¨‹åºåˆ†æˆè‹¥å¹²ä¸ªæ¨¡å—ï¼Œä¸åŒæ¨¡å—å•ç‹¬æ‰§è¡Œï¼Œç”±å¤šä¸ªæ¨¡å—ç›¸äº’äº¤æ›¿æ‰§è¡Œï¼Œå®ç°ç¨‹åºçš„è¿è¡Œã€‚å¹¶è¡Œï¼šé’ˆå¯¹çš„ç¨‹åºçš„æ‰§è¡Œï¼ŒæŒ‡çš„æ˜¯åŒä¸€æ—¶é—´ç‚¹ï¼Œæœ‰ä¸ªå¤šä¸ªä»»åŠ¡åœ¨è¢«å¤šä¸ªæˆ–è€…å¤šæ ¸çš„CPUä¸‹è°ƒåº¦æ‰§è¡Œã€‚","like_count":4,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575769,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655101308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1479120,"avatar":"https://static001.geekbang.org/account/avatar/00/16/91/d0/35bc62b1.jpg","nickname":"æ— å’","note":"","ucode":"B9759B5646F3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":603786,"discussion_content":"æ„æ€ç›¸åŒï¼Œä¸è¿‡å¯¹äºç°åœ¨å¤šæ ¸CPUæ¥è¯´ï¼Œå®é™…æ•ˆæœå°±æˆé«˜å¹¶å‘ä¸”é«˜å¹¶è¡Œäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676291895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1660533,"avatar":"https://static001.geekbang.org/account/avatar/00/19/56/75/28a29e7c.jpg","nickname":"å®‰è²å°”å¾·","note":"","ucode":"A7B310463C15F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583631,"discussion_content":"é‚£é«˜å¹¶å‘æ€ä¹ˆæè¿°å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660261721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366845,"user_name":"é˜¿æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1136547,"ip_address":"å››å·","ucode":"C5B7FA33365A28","user_header":"https://static001.geekbang.org/account/avatar/00/11/57/a3/09efc7cb.jpg","comment_is_top":false,"comment_ctime":1674446009,"is_pvip":false,"replies":[{"id":133707,"content":"âœ…ğŸ‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1674692637,"ip_address":"è¾½å®","comment_id":366845,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"\nfunc spawn(f func() error) &lt;-chan error {\n    c := make(chan error)\n\n    go func() {\n        c &lt;- f()\n    }()\n\n    return c\n}\n\nfunc main() {\n    c := spawn(func() error {\n        time.Sleep(2 * time.Second)\n        return errors.New(&quot;timeout&quot;)\n    })\n    fmt.Println(&quot;hello,world1&quot;)\n    fmt.Println(&lt;-c)\n    fmt.Println(&quot;hello,world2&quot;)\n}\n\n\né€šè¿‡å¯¹ä¸Šé¢çš„ä»£ç æµ‹è¯•åæˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„: \nspawnä¸­çš„ go func() æ˜¯å¼‚æ­¥æ‰§è¡Œ(å¯èƒ½ä¸ä¸»çº¿ç¨‹æ˜¯å¹¶è¡Œ), æ‰€ä»¥åœ¨ä¸»çº¿ç¨‹ä¸­çš„spawnä¸ä¼šé˜»å¡ï¼Œå…ˆæ‰“å°å‡ºäº† &quot;hello,world1&quot;, ç­‰åˆ°æ‰“å° &lt;-c çš„æ—¶å€™å°±é˜»å¡äº†ï¼Œç­‰ä»c ä¸­è¯»å‡ºæ•°æ®æ‰“å°ç»“æŸåæ‰ä¼šç»§ç»­æ‰§è¡Œåç»­çš„æ‰“å° &quot;hello,world2&quot;ã€‚ æ‰€ä»¥è¯´ä»channel ä¸­è¯»å–æ•°æ®å¯ä»¥è®¤ä¸ºè‚¯å®šæ˜¯ä¸€ä¸ªé˜»å¡çš„åŒæ­¥æ•°æ®æ“ä½œï¼Œä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575769,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655101308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1479120,"avatar":"https://static001.geekbang.org/account/avatar/00/16/91/d0/35bc62b1.jpg","nickname":"æ— å’","note":"","ucode":"B9759B5646F3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":603786,"discussion_content":"æ„æ€ç›¸åŒï¼Œä¸è¿‡å¯¹äºç°åœ¨å¤šæ ¸CPUæ¥è¯´ï¼Œå®é™…æ•ˆæœå°±æˆé«˜å¹¶å‘ä¸”é«˜å¹¶è¡Œäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676291895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1660533,"avatar":"https://static001.geekbang.org/account/avatar/00/19/56/75/28a29e7c.jpg","nickname":"å®‰è²å°”å¾·","note":"","ucode":"A7B310463C15F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583631,"discussion_content":"é‚£é«˜å¹¶å‘æ€ä¹ˆæè¿°å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660261721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330239,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1641876923,"is_pvip":false,"replies":[{"id":120545,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050585,"ip_address":"","comment_id":330239,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"CSPã€å“åº”å¼ç¼–ç¨‹ç®€ä»‹ï¼š\nCSPï¼ˆCommunicationing Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹ï¼‰å¹¶å‘æ¨¡å‹\nå“åº”å¼ç¼–ç¨‹æˆ–ååº”å¼ç¼–ç¨‹ï¼ˆè‹±è¯­ï¼šReactive programmingï¼‰æ˜¯ä¸€ç§é¢å‘æ•°æ®æµå’Œå˜åŒ–ä¼ æ’­çš„å£°æ˜å¼ç¼–ç¨‹èŒƒå¼ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å¾ˆæ–¹ä¾¿åœ°è¡¨è¾¾é™æ€æˆ–åŠ¨æ€çš„æ•°æ®æµï¼Œè€Œç›¸å…³çš„è®¡ç®—æ¨¡å‹ä¼šè‡ªåŠ¨å°†å˜åŒ–çš„å€¼é€šè¿‡æ•°æ®æµè¿›è¡Œä¼ æ’­ã€‚\n\nCSPã€å“åº”å¼ç¼–ç¨‹ä¸¤è€…çš„æ€æƒ³éå¸¸åƒï¼ˆä»¥æˆ‘ç›®å‰çš„ç†è§£æ²¡çœ‹å‡ºåŒºåˆ«ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨Javaã€Scalaä¹‹ç±»çš„è¯­è¨€å®ç°å“åº”å¼ç¼–ç¨‹ä¸€èˆ¬éœ€è¦å€ŸåŠ©é¢å¤–çš„æ¡†æ¶ç¼–ç¨‹ï¼ˆä¾‹å¦‚ Reactorï¼‰ã€‚\nä½†ä½¿ç”¨ Go ç¼–ç¨‹å±…ç„¶æ˜¯è¯­è¨€è‡ªå¸¦çš„ç‰¹æ€§ï¼Œä¸€ä¸ªå…³é”®å­— go å°±è¡Œäº†ï¼","like_count":3,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545788,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356638,"user_name":"è èå¹é›ªâ€”Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"åŒ—äº¬","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1662459997,"is_pvip":false,"replies":[{"id":129873,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1662684219,"ip_address":"åŒ—äº¬","comment_id":356638,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100093501,"comment_content":"è¿™èŠ‚è®²çš„å¤ªå¥½äº†ï¼Œå¹¶å‘å’Œå¹¶è¡Œç†è§£é€äº†","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587009,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662684219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337717,"user_name":"ivhong","can_delete":false,"product_type":"c1","uid":2659871,"ip_address":"","ucode":"9947B228807AC9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8ic8eLTo5rnqIMJicUfpkVBrOUJAW4fANicKIbHdC54O9SOdwSoeK6o8icibaUbh7ZUXAkGF9zwHqo0Q/132","comment_is_top":false,"comment_ctime":1646986881,"is_pvip":false,"replies":[{"id":123515,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647089374,"ip_address":"","comment_id":337717,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"åšäº†å¦‚ä¸‹çš„è”ç³»ï¼Œå®ç°äº†ç­‰å¾…é”å’Œå¹¶å‘é”\n\ntype Lock struct {\n\tlock chan int\n}\n\nfunc NewLock() (l Lock) {\n\tl = Lock{make(chan int, 1)}\n\tl.lock &lt;- 1\n\treturn\n}\n\nfunc (l *Lock) locked() {\n\t&lt;-l.lock\n}\n\nfunc (l *Lock) unlocked() {\n\tl.lock &lt;- 1\n}\n\ntype GroupLock struct {\n\tgGroup chan int\n\tlock   chan int\n\tn int\n}\n\nfunc (gl *GroupLock) Set(n int) {\n\tgl.gGroup = make(chan int, n)\n\tgl.lock = make(chan int, n)\n\tgl.n = n\n\tfor i := 0; i &lt; n; i++ {\n\t\tgl.gGroup &lt;- i\n\t}\n}\n\nfunc (gl *GroupLock) Done() {\n\tn := &lt;- gl.gGroup\n\tgl.lock &lt;- n\n}\n\nfunc (gl *GroupLock) Wait(){\n\ti := 0\n\tFOR:for {\n\t\tselect {\n\t\tcase  &lt;-gl.lock:\n\t\t\ti++\n\t\t\tif i == gl.n {\n\t\t\t\tclose(gl.gGroup)\n\t\t\t\tclose(gl.lock)\n\t\t\t\tbreak FOR\n\t\t\t}\n\t\t}\n\t}\n\n}\nfunc main() {\n\tvar gl GroupLock\n\tgl.Set(1000)\n\tp := 1\n\tl := NewLock()\n\tfor i := 0; i &lt; 1000; i++ {\n\t\tgo func(i int) {\n\t\t\tl.locked()\n\t\t\tp = p + 1\n\t\t\tl.unlocked()\n\t\t\tgl.Done()\n\t\t}(i)\n\t}\n\n\tgl.Wait()\n\tfmt.Println(p)\n}","like_count":2},{"had_liked":false,"id":334254,"user_name":"å°å®î„¼","can_delete":false,"product_type":"c1","uid":1402330,"ip_address":"","ucode":"A7223A477C60C9","user_header":"https://static001.geekbang.org/account/avatar/00/15/65/da/29fe3dde.jpg","comment_is_top":false,"comment_ctime":1644829030,"is_pvip":false,"replies":[{"id":122148,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1644916709,"ip_address":"","comment_id":334254,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"é¦–å…ˆï¼Œè®²è§£äº†å¹¶å‘ä¸å¹¶è¡Œçš„æ¦‚å¿µ:\nç®€å•è®²å¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œå…³ä¹ç‰©ç†æ‰§è¡Œï¼›\né‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºï¼Œä¾æ—§ä¸å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼ˆå•æ ¸CPUï¼‰ã€‚è€Œåœ¨æ»¡è¶³å¹¶è¡Œå¿…è¦æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºæ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ã€‚è€Œé‚£äº›æ²¡æœ‰é‡‡ç”¨å¹¶å‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œé™¤éæ˜¯å¯åŠ¨å¤šä¸ªç¨‹åºå®ä¾‹ï¼Œå¦åˆ™æ˜¯æ— æ³•å¹¶è¡Œæ‰§è¡Œçš„ã€‚\nå…¶æ¬¡ï¼Œå¯¹æ¯”äº†Goè¯­è¨€å¹¶å‘ä¸å…¶ä»–è¯­è¨€å¹¶å‘çš„å·®å¼‚;\n1. åº•å±‚å®ç°ï¼›\nGo å¹¶æ²¡æœ‰ä½¿ç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ä½œä¸ºæ‰¿è½½åˆ†è§£åçš„ä»£ç ç‰‡æ®µï¼ˆæ¨¡å—ï¼‰çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œè€Œæ˜¯å®ç°äº†goroutineè¿™ä¸€ç”± Go è¿è¡Œæ—¶ï¼ˆruntimeï¼‰è´Ÿè´£è°ƒåº¦çš„ã€è½»é‡çš„ç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¸ºå¹¶å‘ç¨‹åºè®¾è®¡æä¾›åŸç”Ÿæ”¯æŒã€‚\n2. é€šä¿¡æœºåˆ¶\nä¼ ç»Ÿè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯åŸºäºå¯¹å†…å­˜çš„å…±äº«çš„ã€‚\nGoé‡‡ç”¨CSP(Communicationing Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹)\næœ€ågoroutine çš„åŸºæœ¬ç”¨æ³•\ngo å…³é”®å­—ä»¥åŠ\nchannel\n","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551174,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644916709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330189,"user_name":"Julien","can_delete":false,"product_type":"c1","uid":1204568,"ip_address":"","ucode":"2A3F0CF46B4034","user_header":"https://static001.geekbang.org/account/avatar/00/12/61/58/7b078879.jpg","comment_is_top":false,"comment_ctime":1641859105,"is_pvip":false,"replies":[{"id":120542,"content":"åŸºæœ¬æ–¹æ³•ï¼šåŸºäºchannelé€šä¿¡ã€‚é€šè¿‡channelå‘é‚£ä¸ªgoroutineå‘ä¸€ä¸ªé€€å‡ºä¿¡å·ã€‚åè€…æ¥æ”¶åˆ°åä¸»åŠ¨é€€å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050559,"ip_address":"","comment_id":330189,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆä½ å¥½ã€‚å¦‚æœä¸€ä¸ªgoroutineéœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œç¨‹åºé€€å‡ºæ—¶å¸Œæœ›å®ƒå°½å¿«é€€å‡ºï¼Œåº”è¯¥æ€æ ·åšå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551174,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644916709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329839,"user_name":"bearlu","can_delete":false,"product_type":"c1","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1641563901,"is_pvip":true,"replies":[{"id":120483,"content":"å¹¶å‘æ˜¯ç»“æ„è®¾è®¡ï¼Œæ˜¯è®¾è®¡é˜¶æ®µè€ƒè™‘çš„é—®é¢˜ã€‚å¹¶å‘è®¾è®¡çš„ç¨‹åºå³ä¾¿æ˜¯å•æ ¸cpuä¹Ÿèƒ½è¿è¡Œã€‚æ‰€ä»¥ç†è®ºä¸Šåªè¦æ˜¯æ­£ç¡®çš„å¹¶å‘è®¾è®¡ï¼Œä¸åº”è¯¥å¿…é¡»ä¾èµ–å¿…é¡»å¹¶è¡Œè¿™æ ·çš„æ¡ä»¶ã€‚\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042085,"ip_address":"","comment_id":329839,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œè®¾è®¡å¹¶å‘çš„ç¨‹åºï¼Œä¸ä¸€å®šå¹¶è¡Œï¼Œé‚£æ ·å­˜ä¸å­˜åœ¨ä¸€ç§å¹¶å‘éœ€è¦å¹¶è¡Œæ‰å¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545785,"discussion_content":"åŸºæœ¬æ–¹æ³•ï¼šåŸºäºchannelé€šä¿¡ã€‚é€šè¿‡channelå‘é‚£ä¸ªgoroutineå‘ä¸€ä¸ªé€€å‡ºä¿¡å·ã€‚åè€…æ¥æ”¶åˆ°åä¸»åŠ¨é€€å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1711967,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/GJXKh8OG00U5ial64plAIibbIuwkzhPc8uYic9Hibl8SbqvhnS2JImHgCD4JGvTktiaVnCjHQWbA5wicaxRUN5aTEWnQ/132","nickname":"Geek_a6104e","note":"","ucode":"29A56792216DC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579014,"discussion_content":"ç¨‹åºé€€å‡ºçš„æ—¶å€™goroutineä¸å°±è·Ÿç€é€€å‡ºäº†å— ä¸éœ€è¦å¤„ç†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657120795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1711967,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/GJXKh8OG00U5ial64plAIibbIuwkzhPc8uYic9Hibl8SbqvhnS2JImHgCD4JGvTktiaVnCjHQWbA5wicaxRUN5aTEWnQ/132","nickname":"Geek_a6104e","note":"","ucode":"29A56792216DC8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591282,"discussion_content":"é‡ç”Ÿgoroutine äº†è§£ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666423849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579014,"ip_address":"æ±Ÿè‹","group_id":0},"score":591282,"extra":""},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621960,"discussion_content":"åŒå­¦ï¼Œä»€ä¹ˆæ˜¯é‡ç”Ÿgoroutineå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687793246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591282,"ip_address":"å¹¿ä¸œ","group_id":0},"score":621960,"extra":""}]}]},{"had_liked":false,"id":335013,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1645256345,"is_pvip":false,"replies":[{"id":122597,"content":"ğŸ‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1645597769,"ip_address":"","comment_id":335013,"utype":1}],"discussion_count":1,"race_medal":2,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„çœŸå¥½ï¼Œå¹¶è¡Œå’Œå¹¶å‘æ¦‚å¿µçš„åŒºåˆ†å¾ˆå®¹æ˜“ç†è§£ï¼Œä¼ ç»Ÿç¼–ç¨‹è¯­è¨€å’ŒGoè¯­è¨€çš„å¹¶å‘è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å·®å¼‚ä¹Ÿå¾ˆæ¸…æ™°ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552801,"discussion_content":"ğŸ‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645597769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330616,"user_name":"BinyGo","can_delete":false,"product_type":"c1","uid":2639381,"ip_address":"","ucode":"182ADA4532C98B","user_header":"https://static001.geekbang.org/account/avatar/00/28/46/15/0f215f66.jpg","comment_is_top":false,"comment_ctime":1642070813,"is_pvip":true,"replies":[{"id":121547,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643448456,"ip_address":"","comment_id":330616,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ï¼Œä¸€å‘é€šé€ï¼Œç‰›ï¼","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552801,"discussion_content":"ğŸ‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645597769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330181,"user_name":"Bynow","can_delete":false,"product_type":"c1","uid":2735072,"ip_address":"","ucode":"1E4F3ADD65CF18","user_header":"https://static001.geekbang.org/account/avatar/00/29/bb/e0/c7cd5170.jpg","comment_is_top":false,"comment_ctime":1641831802,"is_pvip":false,"replies":[{"id":120536,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642049083,"ip_address":"","comment_id":330181,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆçš„è¿™ç¯‡è®²ä¹‰ï¼Œæ€’èµï¼ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæœç„¶æ˜¯è§†é‡æ¸…æ™°ï¼","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545772,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642049083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330038,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1641746254,"is_pvip":false,"replies":[{"id":120543,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050568,"ip_address":"","comment_id":330038,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ã€‚\nå¹¶å‘æ˜¯åº”ç”¨ç»“æ„è®¾è®¡ç›¸å…³çš„æ¦‚å¿µï¼Œ è¿™ä¸ªç¡®å®ç¬¬ä¸€æ¬¡çœ‹åˆ°ï¼Œè¿˜éœ€è¦è‡ªå·±å¥½å¥½ç†è§£ã€‚\nè¾“å…¥è¾“å‡ºï¼Œé€šè¿‡ channel å°† goroutineï¼ˆPï¼‰ç»„åˆè¿æ¥åœ¨ä¸€èµ·ã€‚ è¿™ä¸ª ä¸€ä¸‹å­å°± æŠŠå“²å­¦ä¸²è”èµ·æ¥äº†ã€‚\næ¯”å¾ˆå¤šæ–‡ç«  å•çº¯è®² channelæ˜¯ç”¨æ¥é€šä¿¡çš„ï¼Œ æ›´ç³»ç»Ÿï¼Œæ›´å¥½é¢†ä¼šã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545786,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329864,"user_name":"LiWZ","can_delete":false,"product_type":"c1","uid":2175116,"ip_address":"","ucode":"18406E7E3BA475","user_header":"https://static001.geekbang.org/account/avatar/00/21/30/8c/6c86eaac.jpg","comment_is_top":false,"comment_ctime":1641609876,"is_pvip":false,"replies":[{"id":120485,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042155,"ip_address":"","comment_id":329864,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ–‡ç« è´¨é‡å¾ˆé«˜ è°¢è°¢è€å¸ˆğŸ‘","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545704,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391177,"user_name":"äººè¨€æœ‰åŠ›","can_delete":false,"product_type":"c1","uid":1690736,"ip_address":"æµ™æ±Ÿ","ucode":"3708FBBFB641FE","user_header":"https://static001.geekbang.org/account/avatar/00/19/cc/70/64045bc0.jpg","comment_is_top":false,"comment_ctime":1717552554,"is_pvip":false,"replies":[{"id":142279,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1717656013,"ip_address":"åŒ—äº¬","comment_id":391177,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æœ¬èŠ‚è®²è¿°äº†goè¯­è¨€åŸç”Ÿæ”¯æŒå¹¶å‘çš„åˆ©å™¨â€”go routine.\n1.é¦–å…ˆå¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼Œå¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œåœ¨æ„æ‰§è¡Œ\n2.goroutineçš„è°ƒåº¦å•ä½ä¸æ˜¯ä¼ ç»Ÿçš„è¿›ç¨‹æˆ–è€…çº¿ç¨‹ï¼Œè€Œæ˜¯goè¿è¡Œæ—¶è´Ÿè´£çš„ä¸€ä¸ªåç¨‹ï¼Œå¼€é”€æå°\n3.goroutineä¹‹é—´çš„é€šä¿¡å€ŸåŠ©CSPåŸåˆ™ï¼Œé€šè¿‡channelè¿›è¡Œé€šä¿¡ï¼Œè§„é¿ä¼ ç»Ÿç¼–ç¨‹éœ€è¦çš„å…±äº«å†…å­˜åŒæ­¥çš„å„ç§æ­»é”é—®é¢˜","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545704,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337717,"user_name":"ivhong","can_delete":false,"product_type":"c1","uid":2659871,"ip_address":"","ucode":"9947B228807AC9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8ic8eLTo5rnqIMJicUfpkVBrOUJAW4fANicKIbHdC54O9SOdwSoeK6o8icibaUbh7ZUXAkGF9zwHqo0Q/132","comment_is_top":false,"comment_ctime":1646986881,"is_pvip":false,"replies":[{"id":123515,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1647089374,"ip_address":"","comment_id":337717,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"åšäº†å¦‚ä¸‹çš„è”ç³»ï¼Œå®ç°äº†ç­‰å¾…é”å’Œå¹¶å‘é”\n\ntype Lock struct {\n\tlock chan int\n}\n\nfunc NewLock() (l Lock) {\n\tl = Lock{make(chan int, 1)}\n\tl.lock &lt;- 1\n\treturn\n}\n\nfunc (l *Lock) locked() {\n\t&lt;-l.lock\n}\n\nfunc (l *Lock) unlocked() {\n\tl.lock &lt;- 1\n}\n\ntype GroupLock struct {\n\tgGroup chan int\n\tlock   chan int\n\tn int\n}\n\nfunc (gl *GroupLock) Set(n int) {\n\tgl.gGroup = make(chan int, n)\n\tgl.lock = make(chan int, n)\n\tgl.n = n\n\tfor i := 0; i &lt; n; i++ {\n\t\tgl.gGroup &lt;- i\n\t}\n}\n\nfunc (gl *GroupLock) Done() {\n\tn := &lt;- gl.gGroup\n\tgl.lock &lt;- n\n}\n\nfunc (gl *GroupLock) Wait(){\n\ti := 0\n\tFOR:for {\n\t\tselect {\n\t\tcase  &lt;-gl.lock:\n\t\t\ti++\n\t\t\tif i == gl.n {\n\t\t\t\tclose(gl.gGroup)\n\t\t\t\tclose(gl.lock)\n\t\t\t\tbreak FOR\n\t\t\t}\n\t\t}\n\t}\n\n}\nfunc main() {\n\tvar gl GroupLock\n\tgl.Set(1000)\n\tp := 1\n\tl := NewLock()\n\tfor i := 0; i &lt; 1000; i++ {\n\t\tgo func(i int) {\n\t\t\tl.locked()\n\t\t\tp = p + 1\n\t\t\tl.unlocked()\n\t\t\tgl.Done()\n\t\t}(i)\n\t}\n\n\tgl.Wait()\n\tfmt.Println(p)\n}","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555872,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647089374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334254,"user_name":"å°å®î„¼","can_delete":false,"product_type":"c1","uid":1402330,"ip_address":"","ucode":"A7223A477C60C9","user_header":"https://static001.geekbang.org/account/avatar/00/15/65/da/29fe3dde.jpg","comment_is_top":false,"comment_ctime":1644829030,"is_pvip":false,"replies":[{"id":122148,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1644916709,"ip_address":"","comment_id":334254,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"é¦–å…ˆï¼Œè®²è§£äº†å¹¶å‘ä¸å¹¶è¡Œçš„æ¦‚å¿µ:\nç®€å•è®²å¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œå…³ä¹ç‰©ç†æ‰§è¡Œï¼›\né‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºï¼Œä¾æ—§ä¸å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼ˆå•æ ¸CPUï¼‰ã€‚è€Œåœ¨æ»¡è¶³å¹¶è¡Œå¿…è¦æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨å¹¶å‘è®¾è®¡çš„ç¨‹åºæ˜¯å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„ã€‚è€Œé‚£äº›æ²¡æœ‰é‡‡ç”¨å¹¶å‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œé™¤éæ˜¯å¯åŠ¨å¤šä¸ªç¨‹åºå®ä¾‹ï¼Œå¦åˆ™æ˜¯æ— æ³•å¹¶è¡Œæ‰§è¡Œçš„ã€‚\nå…¶æ¬¡ï¼Œå¯¹æ¯”äº†Goè¯­è¨€å¹¶å‘ä¸å…¶ä»–è¯­è¨€å¹¶å‘çš„å·®å¼‚;\n1. åº•å±‚å®ç°ï¼›\nGo å¹¶æ²¡æœ‰ä½¿ç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ä½œä¸ºæ‰¿è½½åˆ†è§£åçš„ä»£ç ç‰‡æ®µï¼ˆæ¨¡å—ï¼‰çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œè€Œæ˜¯å®ç°äº†goroutineè¿™ä¸€ç”± Go è¿è¡Œæ—¶ï¼ˆruntimeï¼‰è´Ÿè´£è°ƒåº¦çš„ã€è½»é‡çš„ç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¸ºå¹¶å‘ç¨‹åºè®¾è®¡æä¾›åŸç”Ÿæ”¯æŒã€‚\n2. é€šä¿¡æœºåˆ¶\nä¼ ç»Ÿè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯åŸºäºå¯¹å†…å­˜çš„å…±äº«çš„ã€‚\nGoé‡‡ç”¨CSP(Communicationing Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹)\næœ€ågoroutine çš„åŸºæœ¬ç”¨æ³•\ngo å…³é”®å­—ä»¥åŠ\nchannel\n","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555872,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647089374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330189,"user_name":"Julien","can_delete":false,"product_type":"c1","uid":1204568,"ip_address":"","ucode":"2A3F0CF46B4034","user_header":"https://static001.geekbang.org/account/avatar/00/12/61/58/7b078879.jpg","comment_is_top":false,"comment_ctime":1641859105,"is_pvip":false,"replies":[{"id":120542,"content":"åŸºæœ¬æ–¹æ³•ï¼šåŸºäºchannelé€šä¿¡ã€‚é€šè¿‡channelå‘é‚£ä¸ªgoroutineå‘ä¸€ä¸ªé€€å‡ºä¿¡å·ã€‚åè€…æ¥æ”¶åˆ°åä¸»åŠ¨é€€å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050559,"ip_address":"","comment_id":330189,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆä½ å¥½ã€‚å¦‚æœä¸€ä¸ªgoroutineéœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œç¨‹åºé€€å‡ºæ—¶å¸Œæœ›å®ƒå°½å¿«é€€å‡ºï¼Œåº”è¯¥æ€æ ·åšå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545785,"discussion_content":"åŸºæœ¬æ–¹æ³•ï¼šåŸºäºchannelé€šä¿¡ã€‚é€šè¿‡channelå‘é‚£ä¸ªgoroutineå‘ä¸€ä¸ªé€€å‡ºä¿¡å·ã€‚åè€…æ¥æ”¶åˆ°åä¸»åŠ¨é€€å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1711967,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/GJXKh8OG00U5ial64plAIibbIuwkzhPc8uYic9Hibl8SbqvhnS2JImHgCD4JGvTktiaVnCjHQWbA5wicaxRUN5aTEWnQ/132","nickname":"Geek_a6104e","note":"","ucode":"29A56792216DC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579014,"discussion_content":"ç¨‹åºé€€å‡ºçš„æ—¶å€™goroutineä¸å°±è·Ÿç€é€€å‡ºäº†å— ä¸éœ€è¦å¤„ç†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657120795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1711967,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/GJXKh8OG00U5ial64plAIibbIuwkzhPc8uYic9Hibl8SbqvhnS2JImHgCD4JGvTktiaVnCjHQWbA5wicaxRUN5aTEWnQ/132","nickname":"Geek_a6104e","note":"","ucode":"29A56792216DC8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591282,"discussion_content":"é‡ç”Ÿgoroutine äº†è§£ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666423849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579014,"ip_address":"æ±Ÿè‹","group_id":0},"score":591282,"extra":""},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1102656,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg","nickname":"AKAä¸‰çš®","note":"","ucode":"D3BC5C60025E9D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621960,"discussion_content":"åŒå­¦ï¼Œä»€ä¹ˆæ˜¯é‡ç”Ÿgoroutineå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687793246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591282,"ip_address":"å¹¿ä¸œ","group_id":0},"score":621960,"extra":""}]}]},{"had_liked":false,"id":329839,"user_name":"bearlu","can_delete":false,"product_type":"c1","uid":1030862,"ip_address":"","ucode":"14F260C8B24E27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ce/fd45714f.jpg","comment_is_top":false,"comment_ctime":1641563901,"is_pvip":true,"replies":[{"id":120483,"content":"å¹¶å‘æ˜¯ç»“æ„è®¾è®¡ï¼Œæ˜¯è®¾è®¡é˜¶æ®µè€ƒè™‘çš„é—®é¢˜ã€‚å¹¶å‘è®¾è®¡çš„ç¨‹åºå³ä¾¿æ˜¯å•æ ¸cpuä¹Ÿèƒ½è¿è¡Œã€‚æ‰€ä»¥ç†è®ºä¸Šåªè¦æ˜¯æ­£ç¡®çš„å¹¶å‘è®¾è®¡ï¼Œä¸åº”è¯¥å¿…é¡»ä¾èµ–å¿…é¡»å¹¶è¡Œè¿™æ ·çš„æ¡ä»¶ã€‚\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042085,"ip_address":"","comment_id":329839,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆï¼Œè®¾è®¡å¹¶å‘çš„ç¨‹åºï¼Œä¸ä¸€å®šå¹¶è¡Œï¼Œé‚£æ ·å­˜ä¸å­˜åœ¨ä¸€ç§å¹¶å‘éœ€è¦å¹¶è¡Œæ‰å¯ä»¥è¿è¡Œçš„ç¨‹åºï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545702,"discussion_content":"å¹¶å‘æ˜¯ç»“æ„è®¾è®¡ï¼Œæ˜¯è®¾è®¡é˜¶æ®µè€ƒè™‘çš„é—®é¢˜ã€‚å¹¶å‘è®¾è®¡çš„ç¨‹åºå³ä¾¿æ˜¯å•æ ¸cpuä¹Ÿèƒ½è¿è¡Œã€‚æ‰€ä»¥ç†è®ºä¸Šåªè¦æ˜¯æ­£ç¡®çš„å¹¶å‘è®¾è®¡ï¼Œä¸åº”è¯¥å¿…é¡»ä¾èµ–å¿…é¡»å¹¶è¡Œè¿™æ ·çš„æ¡ä»¶ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335013,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1645256345,"is_pvip":false,"replies":[{"id":122597,"content":"ğŸ‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1645597769,"ip_address":"","comment_id":335013,"utype":1}],"discussion_count":1,"race_medal":2,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„çœŸå¥½ï¼Œå¹¶è¡Œå’Œå¹¶å‘æ¦‚å¿µçš„åŒºåˆ†å¾ˆå®¹æ˜“ç†è§£ï¼Œä¼ ç»Ÿç¼–ç¨‹è¯­è¨€å’ŒGoè¯­è¨€çš„å¹¶å‘è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å·®å¼‚ä¹Ÿå¾ˆæ¸…æ™°ã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545702,"discussion_content":"å¹¶å‘æ˜¯ç»“æ„è®¾è®¡ï¼Œæ˜¯è®¾è®¡é˜¶æ®µè€ƒè™‘çš„é—®é¢˜ã€‚å¹¶å‘è®¾è®¡çš„ç¨‹åºå³ä¾¿æ˜¯å•æ ¸cpuä¹Ÿèƒ½è¿è¡Œã€‚æ‰€ä»¥ç†è®ºä¸Šåªè¦æ˜¯æ­£ç¡®çš„å¹¶å‘è®¾è®¡ï¼Œä¸åº”è¯¥å¿…é¡»ä¾èµ–å¿…é¡»å¹¶è¡Œè¿™æ ·çš„æ¡ä»¶ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642042085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330616,"user_name":"BinyGo","can_delete":false,"product_type":"c1","uid":2639381,"ip_address":"","ucode":"182ADA4532C98B","user_header":"https://static001.geekbang.org/account/avatar/00/28/46/15/0f215f66.jpg","comment_is_top":false,"comment_ctime":1642070813,"is_pvip":true,"replies":[{"id":121547,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1643448456,"ip_address":"","comment_id":330616,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ï¼Œä¸€å‘é€šé€ï¼Œç‰›ï¼","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548929,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643448456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330181,"user_name":"Bynow","can_delete":false,"product_type":"c1","uid":2735072,"ip_address":"","ucode":"1E4F3ADD65CF18","user_header":"https://static001.geekbang.org/account/avatar/00/29/bb/e0/c7cd5170.jpg","comment_is_top":false,"comment_ctime":1641831802,"is_pvip":false,"replies":[{"id":120536,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642049083,"ip_address":"","comment_id":330181,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"å¤§ç™½è€å¸ˆçš„è¿™ç¯‡è®²ä¹‰ï¼Œæ€’èµï¼ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæœç„¶æ˜¯è§†é‡æ¸…æ™°ï¼","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548929,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643448456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330038,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1641746254,"is_pvip":false,"replies":[{"id":120543,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642050568,"ip_address":"","comment_id":330038,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"è€å¸ˆè®²çš„å¤ªå¥½äº†ã€‚\nå¹¶å‘æ˜¯åº”ç”¨ç»“æ„è®¾è®¡ç›¸å…³çš„æ¦‚å¿µï¼Œ è¿™ä¸ªç¡®å®ç¬¬ä¸€æ¬¡çœ‹åˆ°ï¼Œè¿˜éœ€è¦è‡ªå·±å¥½å¥½ç†è§£ã€‚\nè¾“å…¥è¾“å‡ºï¼Œé€šè¿‡ channel å°† goroutineï¼ˆPï¼‰ç»„åˆè¿æ¥åœ¨ä¸€èµ·ã€‚ è¿™ä¸ª ä¸€ä¸‹å­å°± æŠŠå“²å­¦ä¸²è”èµ·æ¥äº†ã€‚\næ¯”å¾ˆå¤šæ–‡ç«  å•çº¯è®² channelæ˜¯ç”¨æ¥é€šä¿¡çš„ï¼Œ æ›´ç³»ç»Ÿï¼Œæ›´å¥½é¢†ä¼šã€‚","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545772,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642049083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329864,"user_name":"LiWZ","can_delete":false,"product_type":"c1","uid":2175116,"ip_address":"","ucode":"18406E7E3BA475","user_header":"https://static001.geekbang.org/account/avatar/00/21/30/8c/6c86eaac.jpg","comment_is_top":false,"comment_ctime":1641609876,"is_pvip":false,"replies":[{"id":120485,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1642042155,"ip_address":"","comment_id":329864,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æ–‡ç« è´¨é‡å¾ˆé«˜ è°¢è°¢è€å¸ˆğŸ‘","like_count":1,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545786,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642050568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391177,"user_name":"äººè¨€æœ‰åŠ›","can_delete":false,"product_type":"c1","uid":1690736,"ip_address":"æµ™æ±Ÿ","ucode":"3708FBBFB641FE","user_header":"https://static001.geekbang.org/account/avatar/00/19/cc/70/64045bc0.jpg","comment_is_top":false,"comment_ctime":1717552554,"is_pvip":false,"replies":[{"id":142279,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1026224,"ctime":1717656013,"ip_address":"åŒ—äº¬","comment_id":391177,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100093501,"comment_content":"æœ¬èŠ‚è®²è¿°äº†goè¯­è¨€åŸç”Ÿæ”¯æŒå¹¶å‘çš„åˆ©å™¨â€”go routine.\n1.é¦–å…ˆå¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼Œå¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œåœ¨æ„æ‰§è¡Œ\n2.goroutineçš„è°ƒåº¦å•ä½ä¸æ˜¯ä¼ ç»Ÿçš„è¿›ç¨‹æˆ–è€…çº¿ç¨‹ï¼Œè€Œæ˜¯goè¿è¡Œæ—¶è´Ÿè´£çš„ä¸€ä¸ªåç¨‹ï¼Œå¼€é”€æå°\n3.goroutineä¹‹é—´çš„é€šä¿¡å€ŸåŠ©CSPåŸåˆ™ï¼Œé€šè¿‡channelè¿›è¡Œé€šä¿¡ï¼Œè§„é¿ä¼ ç»Ÿç¼–ç¨‹éœ€è¦çš„å…±äº«å†…å­˜åŒæ­¥çš„å„ç§æ­»é”é—®é¢˜","like_count":0,"discussions":[{"author":{"id":1026224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a8/b0/6f87ab08.jpg","nickname":"Tony Bai","note":"","ucode":"B6B08985F6FA89","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646274,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717656013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}