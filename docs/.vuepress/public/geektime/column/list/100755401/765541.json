{"id":765541,"title":"15ï½œä½¿ç”¨LLMç”Ÿæˆä»£ç å’Œæµ‹è¯•","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ˜Šï¼Œä»Šå¤©æˆ‘ä»¬æ¥ç»§ç»­å­¦ä¹ AIæ—¶ä»£çš„è½¯ä»¶å·¥ç¨‹ã€‚</p><p>é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬äº†è§£äº†å¦‚ä½•ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Modelï¼ŒLLMï¼‰è¾…åŠ©è¿›è¡Œä¸šåŠ¡çŸ¥è¯†ç®¡ç†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­å­¦ä¹ ä½¿ç”¨LLMè¾…åŠ©è½¯ä»¶äº¤ä»˜çš„æ•´ä½“æµç¨‹ï¼Œä»¥åŠå…¶ä¸­æ¶‰åŠåˆ°çš„çŸ¥è¯†ç®¡ç†ã€‚</p><p>ä»ä»Šå¤©è¿™èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥å¦‚ä½•ä½¿ç”¨LLMè¾…åŠ©è½¯ä»¶å¼€å‘çš„ç¯èŠ‚ã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚</p><h2>å‘½ä»¤è¡Œå‚æ•°è§£æ</h2><p>æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ä¾‹å­æºè‡ªRobert C. Martinçš„ <em>Clean Code</em> ç¬¬åå››ç« ï¼Œä¹Ÿæ˜¯æˆ‘çš„æµ‹è¯•é©±åŠ¨ä¸“æ <a href=\"https://time.geekbang.org/column/intro/100109401\">ã€ŠTDDé¡¹ç›®å®æˆ˜70è®²ã€‹</a>è®²è¿‡çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œéœ€æ±‚æè¿°å¦‚ä¸‹ï¼š</p><blockquote>\n<p>æˆ‘ä»¬ä¸­çš„å¤§å¤šæ•°äººéƒ½ä¸å¾—ä¸æ—¶ä¸æ—¶åœ°è§£æä¸€ä¸‹å‘½ä»¤è¡Œå‚æ•°ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç®€å•åœ°å¤„ç†ä¸€ä¸‹ä¼ å…¥mainå‡½æ•°çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚æœ‰å¾ˆå¤šå¼€æºå·¥å…·å¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä½†å®ƒä»¬å¯èƒ½å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚æ‰€ä»¥æˆ‘ä»¬å†å†™ä¸€ä¸ªå§ã€‚<br>\n&nbsp;<br>\nä¼ é€’ç»™ç¨‹åºçš„å‚æ•°ç”±æ ‡å¿—å’Œå€¼ç»„æˆã€‚æ ‡å¿—åº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œå‰é¢æœ‰ä¸€ä¸ªå‡å·ã€‚æ¯ä¸ªæ ‡å¿—éƒ½åº”è¯¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªä¸ä¹‹ç›¸å…³çš„å€¼ã€‚ä¾‹å¦‚ï¼š<br>\n&nbsp;<br>\n-l -p 8080 -d /usr/logs<br>\n&nbsp;<br>\nâ€œlâ€ï¼ˆæ—¥å¿—ï¼‰æ²¡æœ‰ç›¸å…³çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸ºtrueï¼Œä¸å­˜åœ¨åˆ™ä¸ºfalseã€‚â€œpâ€ï¼ˆç«¯å£ï¼‰æœ‰ä¸€ä¸ªæ•´æ•°å€¼ï¼Œâ€œdâ€ï¼ˆç›®å½•ï¼‰æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚æ ‡å¿—åé¢å¦‚æœå­˜åœ¨å¤šä¸ªå€¼ï¼Œåˆ™è¯¥æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼š<br>\n&nbsp;<br>\n-g this is a list -d 1 2 -3 5<br>\n&nbsp;<br>\nâ€œgâ€ è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨[â€œthisâ€, â€œisâ€, â€œaâ€, â€œlistâ€]ï¼Œ\"d\"æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨[1, 2, -3, 5]ã€‚<br>\n&nbsp;<br>\nå¦‚æœå‚æ•°ä¸­æ²¡æœ‰æŒ‡å®šæŸä¸ªæ ‡å¿—ï¼Œé‚£ä¹ˆè§£æå™¨åº”è¯¥æŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ã€‚ä¾‹å¦‚ï¼Œfalseä»£è¡¨å¸ƒå°”å€¼ï¼Œ0ä»£è¡¨æ•°å­—ï¼Œ <code>\"\"</code> ä»£è¡¨å­—ç¬¦ä¸²ï¼Œ[]ä»£è¡¨åˆ—è¡¨ã€‚å¦‚æœç»™å‡ºçš„å‚æ•°ä¸æ¨¡å¼ä¸åŒ¹é…ï¼Œé‡è¦çš„æ˜¯ç»™å‡ºä¸€ä¸ªå¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œå‡†ç¡®åœ°è§£é‡Šä»€ä¹ˆæ˜¯é”™è¯¯çš„ã€‚<br>\n&nbsp;<br>\nç¡®ä¿ä½ çš„ä»£ç æ˜¯å¯æ‰©å±•çš„ï¼Œå³å¦‚ä½•å¢åŠ æ–°çš„æ•°å€¼ç±»å‹æ˜¯ç›´æ¥å’Œæ˜æ˜¾çš„ã€‚</p>\n</blockquote><!-- [[[read_end]]] --><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç›´æ¥å°†è¿™æ®µéœ€æ±‚æ‰”åˆ°LLMä¸­ï¼Œçœ‹çœ‹LLMä¼šç”Ÿæˆæ€æ ·çš„ä»£ç ã€‚å½“ç„¶åœ¨é‚£ä¹‹å‰æˆ‘ä»¬éœ€è¦å°†å®ƒè½¬åŒ–ä¸ºæç¤ºè¯æ¨¡æ¿ï¼š</p><blockquote>\n<p>éœ€æ±‚<br>\n====<br>\n{requirement}<br>\n&nbsp;<br>\nå®ç°è¦æ±‚<br>\n====<br>\nä½¿ç”¨Javaè¯­è¨€å®ç°ä¸Šé¢çš„éœ€æ±‚</p>\n</blockquote><p>å½“ç„¶ä½ å¯ä»¥å°†Javaè¯­è¨€æ¢æˆä»»ä½•ä½ æ‰€ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆã€‚æˆ‘åœ¨è¿™é‡Œä»…ä»…æ˜¯ç”¨Javaä¸¾ä¾‹ã€‚ChatGPTç»™å‡ºçš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-plain\">import java.util.*;\n\npublic class CommandLineParser {\n\n    public static void main(String[] args) {\n        // ç¤ºä¾‹ç”¨æ³•\n        Map&lt;String, Object&gt; parsedArgs = parseArgs(args);\n        System.out.println(parsedArgs);\n    }\n\n    public static Map&lt;String, Object&gt; parseArgs(String[] args) {\n        Map&lt;String, Object&gt; parsedArgs = new HashMap&lt;&gt;();\n        String currentFlag = null;\n        List&lt;Object&gt; currentValues = new ArrayList&lt;&gt;();\n        for (String arg : args) {\n          if (arg.startsWith(\"-\")) {\n              // å¤„ç†ä¹‹å‰çš„æ ‡å¿—å’Œå€¼\n              if (currentFlag != null) {\n                  parsedArgs.put(currentFlag, parseValues(currentValues));\n              }\n              // å¼€å§‹å¤„ç†æ–°çš„æ ‡å¿—\n              currentFlag = arg.substring(1);\n              currentValues = new ArrayList&lt;&gt;();\n            } else {\n              // å¤„ç†æ ‡å¿—å¯¹åº”çš„å€¼\n              currentValues.add(arg);\n            }\n        }\n        // å¤„ç†æœ€åä¸€ä¸ªæ ‡å¿—å’Œå€¼\n        if (currentFlag != null) {\n            parsedArgs.put(currentFlag, parseValues(currentValues));\n        }\n        return parsedArgs;\n    }\n\n    private static Object parseValues(List&lt;Object&gt; values) {\n        if (values.isEmpty()) {\n            // å¦‚æœå€¼ä¸ºç©ºï¼Œé»˜è®¤ä¸ºå¸ƒå°”å€¼false\n            return false;\n        } else if (values.size() == 1) {\n            // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n            return parseSingleValue(values.get(0));\n        } else {\n            // å¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›å€¼çš„åˆ—è¡¨\n            List&lt;Object&gt; parsedList = new ArrayList&lt;&gt;();\n            for (Object value : values) {\n                parsedList.add(parseSingleValue(value));\n            }\n            return parsedList;\n        }\n    }\n\n    private static Object parseSingleValue(Object value) {\n        // è§£æå•ä¸ªå€¼çš„ç±»å‹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•\n        if (value instanceof String) {\n            // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿”å›åŸå§‹å­—ç¬¦ä¸²\n            return value;\n        } else {\n            try {\n                // å°è¯•è§£æä¸ºæ•´æ•°\n                return Integer.parseInt(value.toString());\n            } catch (NumberFormatException e) {\n                // å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›åŸå§‹å€¼\n                return value;\n            }\n         }\n    }\n}\n\n</code></pre><p>æ— è®ºä½ æ˜¯å¦äº†è§£Javaï¼Œä½ éƒ½å¯ä»¥æ„Ÿå—åˆ°ï¼Œè¿™æ®µä»£ç çš„é€»è¾‘æ˜¯æœ‰ä¸€å®šå¤æ‚åº¦çš„ã€‚è€ŒChatGPTç”Ÿæˆè¿™æ®µä»£ç ä¹Ÿå°±åªè¦å‡ ç§’é’Ÿçš„æ—¶é—´ï¼Œæ˜¾ç„¶æˆ‘ä»¬æ— æ³•åœ¨å‡ ç§’é’Ÿå†…åˆ¤æ–­è¿™æ®µä»£ç æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚</p><p>è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“è¿™æ®µä»£ç æ˜¯å¦å®Œæˆäº†åŠŸèƒ½ã€‚æˆ‘ä»¬ä»ç„¶è¦å›å½’åˆ°ä¸ºè¿™æ®µä»£ç æ„é€ æµ‹è¯•ï¼Œå¹¶éªŒè¯å®ƒæ˜¯å¦æ­£ç¡®çš„é“è·¯ä¸Šã€‚<strong>æ‰€ä»¥å“ªæ€•ä½ å¯¹äºæµ‹è¯•é©±åŠ¨å¼€å‘ä¸€æ— æ‰€çŸ¥ï¼ŒLLMçš„ç‰¹æ€§ä»ç„¶ä¼šå°†ä½ çš„æ³¨æ„åŠ›å¼•å¯¼åˆ°æµ‹è¯•ä¸Šã€‚</strong>æˆ‘ä»¬å¯ä»¥åœ¨ç°åœ¨çš„ä»£ç åŸºç¡€ä¸Šï¼Œè®©LLMå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆæµ‹è¯•ã€‚</p><blockquote>\n<p>è¯·æ ¹æ®éœ€æ±‚ï¼Œä¸ºè¿™æ®µä»£ç ç”Ÿæˆç›¸åº”çš„æµ‹è¯•</p>\n</blockquote><p>ChatGPTç”Ÿæˆçš„ç»“æœæ˜¯ï¼š</p><pre><code class=\"language-plain\">import org.junit.jupiter.api.Test;\nimport java.util.List;\nimport java.util.Map;\nimport static org.junit.jupiter.api.Assertions.*;\nclass CommandLineParserTest {\n    @Test\n    void testParseArgs() {\n        // æµ‹è¯•åŸºæœ¬çš„å‘½ä»¤è¡Œå‚æ•°è§£æ\n        String[] args1 = {\"-l\", \"-p\", \"8080\", \"-d\", \"/usr/logs\"};\n        Map&lt;String, Object&gt; result1 = CommandLineParser.parseArgs(args1);\n        assertEquals(true, result1.get(\"l\"));\n        assertEquals(8080, result1.get(\"p\"));\n        assertEquals(\"/usr/logs\", result1.get(\"d\"));\n        \n        // æµ‹è¯•å¸¦æœ‰åˆ—è¡¨çš„å‘½ä»¤è¡Œå‚æ•°è§£æ\n        String[] args2 = {\"-g\", \"this\", \"is\", \"a\", \"list\", \"-d\", \"1\", \"2\", \"-3\", \"5\"};\n        Map&lt;String, Object&gt; result2 = CommandLineParser.parseArgs(args2);\n        assertEquals(List.of(\"this\", \"is\", \"a\", \"list\"), result2.get(\"g\"));\n        assertEquals(List.of(1, 2, -3, 5), result2.get(\"d\"));\n        \n        // æµ‹è¯•é»˜è®¤å€¼\n        String[] args3 = {};\n        Map&lt;String, Object&gt; result3 = CommandLineParser.parseArgs(args3);\n        assertEquals(false, result3.get(\"l\"));\n        assertEquals(0, result3.get(\"p\"));\n        assertEquals(\"\", result3.get(\"d\"));\n        \n        // æµ‹è¯•æ— æ•ˆå‚æ•°\n        String[] args4 = {\"-p\", \"abc\"};\n        assertThrows(NumberFormatException.class, () -&gt; CommandLineParser.parseArgs(args4));\n        // æ·»åŠ æ›´å¤šçš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•\n    }\n}\n</code></pre><p>æˆ‘ä»¬å…ˆå¿½ç•¥ChatGPTç”Ÿæˆæµ‹è¯•çš„é£æ ¼é—®é¢˜ï¼Œæ¯”å¦‚ä¸åŒçš„åœºæ™¯åº”è¯¥æ„é€ æˆä¸åŒçš„æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥æš‚æ—¶ä¸è€ƒè™‘è¿™äº›æµ‹è¯•çš„å®Œå¤‡æ€§é—®é¢˜ï¼Œæ¯”å¦‚ç¼ºå°‘è¾¹ç•Œæ¡ä»¶ã€‚å…ˆçœ‹çœ‹ChatGPTç»™å‡ºçš„ä»£ç æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³è¿™äº›æµ‹è¯•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/00/38/0095bd8b5945270a4363939cda7c4e38.jpg?wh=2910x2072\" alt=\"\"></p><h2>ç¬¬ä¸€æ¬¡è°ƒè¯•</h2><p>ç„¶è€Œç»“æœæ˜¯å¹¶ä¸èƒ½ï¼ŒæŒ‰ç…§æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œå½“æˆ‘ä»¬ä¼ å…¥å‚æ•° â€œ-lâ€ çš„æ—¶å€™ï¼ŒChatGPTç”Ÿæˆçš„ä»£ç å¹¶æ²¡æœ‰æŒ‰ç…§é¢˜ç›®è¦æ±‚çš„é€»è¾‘è½¬åŒ–ä¸ºtrueã€‚é‚£ä¹ˆæˆ‘ä»¬å°±è¦å»å›çœ‹ChatGPTç”Ÿæˆçš„ä»£ç äº†ï¼Œå¹¶å°è¯•å®šä½è¿™ä¸ªé—®é¢˜äº§ç”Ÿçš„æ ¹æºã€‚ä¸éš¾å‘ç°é—®é¢˜å‡ºåœ¨è¿™ä¸ªåœ°æ–¹ï¼š</p><pre><code class=\"language-plain\">private static Object parseValues(List&lt;Object&gt; values) {\n    if (values.isEmpty()) {\n        // å¦‚æœå€¼ä¸ºç©ºï¼Œé»˜è®¤ä¸ºå¸ƒå°”å€¼false\n        return false;\n    } else if (values.size() == 1) {\n        // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n        return parseSingleValue(values.get(0));\n    } else {\n        // å¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›å€¼çš„åˆ—è¡¨\n        List&lt;Object&gt; parsedList = new ArrayList&lt;&gt;();\n        for (Object value : values) {\n            parsedList.add(parseSingleValue(value));\n        }\n        return parsedList;\n    }\n}\n</code></pre><p>è¿™é‡ŒChatGPTç»™å‡ºçš„é€»è¾‘æ˜¯é”™è¯¯çš„ï¼Œå½“æˆ‘ä»¬ç»™å‡ºå‚æ•° â€œ-lâ€ çš„æ—¶å€™ï¼Œå®é™…çš„å€¼æ˜¯[â€œ-lâ€]ï¼Œæ‰€ä»¥valuesæ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œé‚£ä¹ˆè¿”å›å€¼åº”è¯¥æ˜¯trueã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§è¿™ä¸ªå‘ChatGPTæå‡ºå»ºè®®ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥æŠŠé”™è¯¯ä¿¡æ¯æä¾›ç»™ChatGPTï¼Œè®©å®ƒæ ¹æ®é”™è¯¯ä¿¡æ¯ä¿®æ”¹ä»£ç ï¼š</p><blockquote>\n<p>æ‰§è¡Œæµ‹è¯•çš„é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼Œè¯·æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œä¿®æ”¹CommandLineParserçš„ä»£ç ï¼š<br>\n&nbsp;<br>\nExpected :true<br>\nActual &nbsp; :false<br>\n<click to=\"\" see=\"\" difference=\"\"><br>\n&nbsp;<br>\norg.opentest4j.AssertionFailedError: expected: <true> but was: <false><br>\nat org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)<br>\nat org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)<br>\nat org.junit.jupiter.api.AssertEquals.failNotEqual(AssertEquals.java:197)<br>\nat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:182)<br>\nat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:177)<br>\nat org.junit.jupiter.api.Assertions.assertEquals(Assertions.java:1141)<br>\nat CommandLineParserTest.testParseArgs(CommandLineParserTest.java:15)<br>\nat java.base/java.lang.reflect.Method.invoke(Method.java:580)<br>\nat java.base/java.util.ArrayList.forEach(ArrayList.java:1596)<br>\nat java.base/java.util.ArrayList.forEach(ArrayList.java:1596)</false></true></click></p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/45/35/45a751578ac9b6c1831c839ae195e835.jpg?wh=1404x456\" alt=\"\"></p><pre><code class=\"language-plain\">import java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class CommandLineParser {\n\n&nbsp; &nbsp; public static void main(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; // ç¤ºä¾‹ç”¨æ³•\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = parseArgs(args);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(parsedArgs);\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; public static Map&lt;String, Object&gt; parseArgs(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = new HashMap&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; String currentFlag = null;\n&nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; currentValues = new ArrayList&lt;&gt;();\n\n&nbsp; &nbsp; &nbsp; &nbsp; for (String arg : args) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (arg.startsWith(\"-\")) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†ä¹‹å‰çš„æ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¼€å§‹å¤„ç†æ–°çš„æ ‡å¿—\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentFlag = arg.substring(1);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æ ‡å¿—å¯¹åº”çš„å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues.add(arg);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æœ€åä¸€ä¸ªæ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues));\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; return parsedArgs;\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static Object parseValues(List&lt;Object&gt; values) {\n&nbsp; &nbsp; &nbsp; &nbsp; if (values.isEmpty()) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœå€¼ä¸ºç©ºï¼Œé»˜è®¤ä¸ºå¸ƒå°”å€¼true\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;\n&nbsp; &nbsp; &nbsp; &nbsp; } else if (values.size() == 1) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parseSingleValue(values.get(0));\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›å€¼çš„åˆ—è¡¨\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; parsedList = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (Object value : values) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedList.add(parseSingleValue(value));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parsedList;\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static Object parseSingleValue(Object value) {\n&nbsp; &nbsp; &nbsp; &nbsp; // è§£æå•ä¸ªå€¼çš„ç±»å‹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; if (value instanceof String) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œè¿”å›åŸå§‹å­—ç¬¦ä¸²\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return value;\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å°è¯•è§£æä¸ºæ•´æ•°\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Integer.parseInt(value.toString());\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (NumberFormatException e) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›åŸå§‹å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return value;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n}\n\n</code></pre><p>å†æ¬¡æ‰§è¡Œæµ‹è¯•ï¼Œä¾ç„¶å­˜åœ¨é”™è¯¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fd/30/fdffe163b783560byy69e8e04b980430.jpg?wh=2932x2132\" alt=\"\"></p><h2>ç¬¬äºŒæ¬¡è°ƒè¯•</h2><p>è¿™æ¬¡çš„é—®é¢˜è¦æ›´ä¸¥é‡ä¸€äº›ï¼Œä»é”™è¯¯ç»“æœä¸Šçœ‹ï¼Œæˆ‘ä»¬æœŸå¾…ä¼ å…¥ â€œ-p 8080â€ æ—¶ï¼Œå¾—åˆ°å‚æ•°çš„ç±»å‹æ˜¯æ•´å‹ï¼Œè€ŒChatGPTç”Ÿæˆçš„ä»£ç ç»™å‡ºçš„ç»“æœæ˜¯å­—ç¬¦ä¸²ã€‚åŒæ ·æˆ‘ä»¬ä¸éš¾å®šä½åˆ°é”™è¯¯åœ¨ä»€ä¹ˆåœ°æ–¹ï¼š</p><pre><code class=\"language-plain\">    } else if (values.size() == 1) {\n        // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n        return parseSingleValue(values.get(0));\n    } else {\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒChatGPTå°†ä»»ä½•çš„å•å€¼å‚æ•°éƒ½å½“ä½œäº†å­—ç¬¦ä¸²ç±»å‹ã€‚è¿™èƒŒååæ˜ çš„æ˜¯ <strong>ChatGPTç»™å‡ºçš„ä»£ç åœ¨è®¾è®¡ä¸Šçš„ç¼ºé™·</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´æ˜¯ï¼Œä¸åŒçš„å‚æ•° â€œ-lâ€, â€œ-pâ€ å’Œ â€œ-dâ€ å¯¹åº”äº†ä¸åŒçš„ç±»å‹ï¼ˆboolï¼Œintå’Œstringï¼‰ã€‚è€ŒChatGPTç»™å‡ºçš„ä»£ç å¿½ç•¥äº†ç±»å‹çš„å·®å¼‚ï¼Œå°è¯•ä»ç»“æœä¸Šå»æ¨æ–­ç±»å‹ï¼Œè¿™è‡ªç„¶æ˜¯ä¸èƒ½æˆåŠŸçš„ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ä»ç„¶æŒ‰ç…§å‰é¢çš„åšæ³•ï¼Œè®©ChatGPTè‡ªè¡Œè§£å†³ï¼Œå®ƒä¼šå‘ç°è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p><blockquote>\n<p>æ‰§è¡Œæµ‹è¯•çš„é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼Œè¯·æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œä¿®æ”¹CommandLineParserçš„ä»£ç ï¼š<br>\n&nbsp;<br>\nExpected :8080<br>\nActual &nbsp; :8080<br>\n<click to=\"\" see=\"\" difference=\"\"><br>\n&nbsp;<br>\norg.opentest4j.AssertionFailedError: expected: java.lang.Integer@1c5920df&lt;8080&gt; but was: java.lang.String@17f9d882&lt;8080&gt;<br>\nat org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)<br>\nat org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)<br>\nat org.junit.jupiter.api.AssertEquals.failNotEqual(AssertEquals.java:197)<br>\nat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:182)<br>\nat org.junit.jupiter.api.AssertEquals.assertEquals(AssertEquals.java:177)<br>\nat org.junit.jupiter.api.Assertions.assertEquals(Assertions.java:1141)<br>\nat CommandLineParserTest.testParseArgs(CommandLineParserTest.java:16)<br>\nat java.base/java.lang.reflect.Method.invoke(Method.java:580)<br>\nat java.base/java.util.ArrayList.forEach(ArrayList.java:1596)<br>\nat java.base/java.util.ArrayList.forEach(ArrayList.java:1596)</click></p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/63/6a/63203311acec12805f1b8078c507d36a.jpg?wh=1372x1608\" alt=\"\"></p><p>å¾ˆæ˜¾ç„¶ï¼Œå®ƒæ²¡å‘ç°è¿™æ˜¯ä¸ªè®¾è®¡é—®é¢˜ï¼Œä½†æ˜¯å®ƒç»™å‡ºäº†ä¸€ä¸ªèƒ½é€šè¿‡æµ‹è¯•çš„æœ€ç®€å•çš„åŠæ³•ã€‚è¿™ç§åšæ³•ä¹Ÿè›®ç¬¦åˆæµ‹è¯•é©±åŠ¨å¼€å‘å¯¹äºèŠ‚å¥çš„è¦æ±‚ã€‚é‚£ä¹ˆè¿™æ—¶å€™ï¼Œåº”è¯¥ç”±æˆ‘ä»¬ç»™å‡ºè®¾è®¡ä¸Šçš„å»ºè®®å’Œæ”¹è¿›äº†ã€‚</p><blockquote>\n<p>éœ€æ±‚ä¸­ç»™å‡ºçš„å‚æ•°å…·æœ‰ä¸åŒç±»å‹ï¼Œæ¯”å¦‚ï¼š<br>\n-l æ˜¯bool<br>\n-p æ˜¯ int<br>\n-d æ˜¯ string<br>\n-g æ˜¯ list<br>\næˆ‘ä»¬éœ€è¦æŒ‡å®šä¸åŒå‚æ•°çš„ä¸åŒç±»å‹ã€‚ç„¶åæ ¹æ®ç±»å‹å»è§£æå‚æ•°ã€‚è¯·æŒ‰ç…§è¿™ä¸ªæ€è·¯é‡æ–°ç¼–å†™CommandLineParser</p>\n</blockquote><p>æä¾›å»ºè®®ä»¥åï¼ŒGPTè¿”å›çš„ä¿®æ”¹ç»“æœå¦‚ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/72/9e/7272e7e8cf264153cc9616f794f2529e.jpg?wh=1372x318\" alt=\"\"></p><pre><code class=\"language-plain\">import java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class CommandLineParser {\n\n&nbsp; &nbsp; // å®šä¹‰å‚æ•°ç±»å‹çš„æšä¸¾\n&nbsp; &nbsp; public enum ArgType {\n&nbsp; &nbsp; &nbsp; &nbsp; BOOLEAN, INTEGER, STRING, LIST\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; public static void main(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; // ç¤ºä¾‹ç”¨æ³•\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = parseArgs(args);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(parsedArgs);\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; public static Map&lt;String, Object&gt; parseArgs(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = new HashMap&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; String currentFlag = null;\n&nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; currentValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; ArgType currentType = null;\n\n&nbsp; &nbsp; &nbsp; &nbsp; for (String arg : args) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (arg.startsWith(\"-\")) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†ä¹‹å‰çš„æ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues, currentType));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¼€å§‹å¤„ç†æ–°çš„æ ‡å¿—\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentFlag = arg.substring(1);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentType = determineArgType(currentFlag);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æ ‡å¿—å¯¹åº”çš„å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues.add(arg);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æœ€åä¸€ä¸ªæ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues, currentType));\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; return parsedArgs;\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static ArgType determineArgType(String flag) {\n&nbsp; &nbsp; &nbsp; &nbsp; // æ ¹æ®æ ‡å¿—ç¡®å®šå‚æ•°ç±»å‹\n&nbsp; &nbsp; &nbsp; &nbsp; switch (flag) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"l\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return ArgType.BOOLEAN;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"p\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return ArgType.INTEGER;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"d\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return ArgType.STRING;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"g\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return ArgType.LIST;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // æ·»åŠ æ›´å¤šçš„ç±»å‹ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Unknown flag: \" + flag);\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static Object parseValues(List&lt;Object&gt; values, ArgType type) {\n&nbsp; &nbsp; &nbsp; &nbsp; if (values.isEmpty()) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœå€¼ä¸ºç©ºï¼Œé»˜è®¤ä¸ºå¸ƒå°”å€¼true\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;\n&nbsp; &nbsp; &nbsp; &nbsp; } else if (values.size() == 1) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parseSingleValue(values.get(0), type);\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›å€¼çš„åˆ—è¡¨\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; parsedList = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (Object value : values) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedList.add(parseSingleValue(value, type));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parsedList;\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static Object parseSingleValue(Object value, ArgType type) {\n&nbsp; &nbsp; &nbsp; &nbsp; // è§£æå•ä¸ªå€¼çš„ç±»å‹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; switch (type) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case BOOLEAN:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;&nbsp; // ç›®å‰å¸ƒå°”å€¼éƒ½è®¾ä¸ºtrueï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case INTEGER:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Integer.parseInt(value.toString());\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (NumberFormatException e) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Invalid integer value: \" + value);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case STRING:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return value.toString();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case LIST:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parseListValue(value);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // æ·»åŠ æ›´å¤šçš„ç±»å‹ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Unsupported type: \" + type);\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private static List&lt;Object&gt; parseListValue(Object value) {\n&nbsp; &nbsp; &nbsp; &nbsp; // è§£æåˆ—è¡¨ç±»å‹çš„å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; if (value instanceof String) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼ŒæŒ‰ç©ºæ ¼åˆ†å‰²\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String[] parts = ((String) value).split(\" \");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; listValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (String part : parts) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listValues.add(part);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return listValues;\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Invalid list value: \" + value);\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n}\n\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/33/77/338b6e8c85b26ec9039ed7d538a06a77.jpg?wh=1392x298\" alt=\"\"></p><h2>ç¬¬ä¸‰æ¬¡è°ƒè¯•</h2><p>æŒ‰ç…§ChatGPTç»™å‡ºçš„ä¿®æ”¹ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡èƒ½é€šè¿‡å…¨éƒ¨çš„æµ‹è¯•ã€‚æ–°çš„é”™è¯¯ç»§ç»­å‡ºç°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b4/da/b4bec30568d84f5b9958dbd9ab0e93da.jpg?wh=2888x2081\" alt=\"\"></p><p>ç°åœ¨æµ‹è¯•å¤±è´¥çš„åœ°æ–¹åœ¨äºï¼ŒChatGPTç”Ÿæˆçš„ä»£ç å°†-3çœ‹ä½œäº†å‚æ•°åï¼Œè€Œä¸æ˜¯å‚æ•°å€¼ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥å‘Šè¯‰ChatGPTç°åœ¨çš„é—®é¢˜åœ¨å“ªï¼Œé—®é¢˜å‡ºåœ¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ä¸­å°†å‚æ•°ç±»å‹ç¡¬ç¼–ç äº†ï¼ˆhard-codedï¼‰ï¼š</p><pre><code class=\"language-plain\">private static ArgType determineArgType(String flag) {\n        // æ ¹æ®æ ‡å¿—ç¡®å®šå‚æ•°ç±»å‹\n        switch (flag) {\n            case \"l\":\n                return ArgType.BOOLEAN;\n            case \"p\":\n                return ArgType.INTEGER;\n            case \"d\":\n                return ArgType.STRING;\n            case \"g\":\n                return ArgType.LIST;\n            // æ·»åŠ æ›´å¤šçš„ç±»å‹ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•\n            default:\n                throw new IllegalArgumentException(\"Unknown flag: \" + flag);\n        }\n    }\n</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¯ä»¥å‘Šè¯‰ChatGPTè¿™ä¸ªé—®é¢˜ï¼Œå¹¶è®©å®ƒé‡æ–°ç”Ÿæˆä»£ç ï¼š</p><blockquote>\n<p>ç›®å‰determineArgTypeä¸­é™å®šäº†å¯ä»¥ä½¿ç”¨çš„å‚æ•°ï¼Œå°†å®ƒæ”¹ç¼–ä¸ºå¯é…ç½®çš„æƒ…å†µã€‚ä¹Ÿå°±æ˜¯å½“ç”¨æˆ·åˆå§‹åŒ–CommandLineParseræ—¶ï¼Œå¯ä»¥æŒ‡å®šæ”¯æŒçš„å‚æ•°åŠå…¶ç±»å‹ã€‚</p>\n</blockquote><p>GPTçš„å›å¤å¦‚ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c3/39/c32f763bc08f7610e3886a7ff0f68839.jpg?wh=1372x288\" alt=\"\"></p><pre><code class=\"language-plain\">import java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\npublic class CommandLineParser {\n\n&nbsp; &nbsp; // å®šä¹‰å‚æ•°ç±»å‹çš„æšä¸¾\n&nbsp; &nbsp; public enum ArgType {\n&nbsp; &nbsp; &nbsp; &nbsp; BOOLEAN, INTEGER, STRING, LIST\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; // å¯é…ç½®çš„å‚æ•°ç±»å‹æ˜ å°„\n&nbsp; &nbsp; private final Map&lt;String, ArgType&gt; argTypeMap;\n\n&nbsp; &nbsp; public CommandLineParser(Map&lt;String, ArgType&gt; argTypeMap) {\n&nbsp; &nbsp; &nbsp; &nbsp; // åˆå§‹åŒ–å‚æ•°ç±»å‹æ˜ å°„\n&nbsp; &nbsp; &nbsp; &nbsp; this.argTypeMap = new HashMap&lt;&gt;(argTypeMap);\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; public static void main(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; // ç¤ºä¾‹ç”¨æ³•\n&nbsp; &nbsp; &nbsp; &nbsp; // åˆå§‹åŒ–å‚æ•°ç±»å‹æ˜ å°„ï¼Œå¯ä»¥æ ¹æ®éœ€è¦é…ç½®\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, ArgType&gt; customArgTypeMap = new HashMap&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; customArgTypeMap.put(\"l\", ArgType.BOOLEAN);\n&nbsp; &nbsp; &nbsp; &nbsp; customArgTypeMap.put(\"p\", ArgType.INTEGER);\n&nbsp; &nbsp; &nbsp; &nbsp; customArgTypeMap.put(\"d\", ArgType.STRING);\n&nbsp; &nbsp; &nbsp; &nbsp; customArgTypeMap.put(\"g\", ArgType.LIST);\n\n&nbsp; &nbsp; &nbsp; &nbsp; // åˆ›å»º CommandLineParser å®ä¾‹æ—¶ä¼ å…¥è‡ªå®šä¹‰çš„å‚æ•°ç±»å‹æ˜ å°„\n&nbsp; &nbsp; &nbsp; &nbsp; CommandLineParser parser = new CommandLineParser(customArgTypeMap);\n\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = parser.parseArgs(args);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(parsedArgs);\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; public Map&lt;String, Object&gt; parseArgs(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; Map&lt;String, Object&gt; parsedArgs = new HashMap&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; String currentFlag = null;\n&nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; currentValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; ArgType currentType = null;\n\n&nbsp; &nbsp; &nbsp; &nbsp; for (String arg : args) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (arg.startsWith(\"-\")) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†ä¹‹å‰çš„æ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues, currentType));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¼€å§‹å¤„ç†æ–°çš„æ ‡å¿—\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentFlag = arg.substring(1);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentType = determineArgType(currentFlag);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æ ‡å¿—å¯¹åº”çš„å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; currentValues.add(arg);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; // å¤„ç†æœ€åä¸€ä¸ªæ ‡å¿—å’Œå€¼\n&nbsp; &nbsp; &nbsp; &nbsp; if (currentFlag != null) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedArgs.put(currentFlag, parseValues(currentValues, currentType));\n&nbsp; &nbsp; &nbsp; &nbsp; }\n\n&nbsp; &nbsp; &nbsp; &nbsp; return parsedArgs;\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private ArgType determineArgType(String flag) {\n&nbsp; &nbsp; &nbsp; &nbsp; // æ ¹æ®æ ‡å¿—ç¡®å®šå‚æ•°ç±»å‹ï¼Œå¦‚æœæœªé…ç½®ï¼Œé»˜è®¤ä¸ºSTRINGç±»å‹\n&nbsp; &nbsp; &nbsp; &nbsp; return argTypeMap.getOrDefault(flag, ArgType.STRING);\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private Object parseValues(List&lt;Object&gt; values, ArgType type) {\n&nbsp; &nbsp; &nbsp; &nbsp; if (values.isEmpty()) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœå€¼ä¸ºç©ºï¼Œé»˜è®¤ä¸ºå¸ƒå°”å€¼true\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;\n&nbsp; &nbsp; &nbsp; &nbsp; } else if (values.size() == 1) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœåªæœ‰ä¸€ä¸ªå€¼ï¼Œè¿”å›è¯¥å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parseSingleValue(values.get(0), type);\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›å€¼çš„åˆ—è¡¨\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; parsedList = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (Object value : values) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parsedList.add(parseSingleValue(value, type));\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parsedList;\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private Object parseSingleValue(Object value, ArgType type) {\n&nbsp; &nbsp; &nbsp; &nbsp; // è§£æå•ä¸ªå€¼çš„ç±»å‹ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; switch (type) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case BOOLEAN:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;&nbsp; // ç›®å‰å¸ƒå°”å€¼éƒ½è®¾ä¸ºtrueï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case INTEGER:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Integer.parseInt(value.toString());\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (NumberFormatException e) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Invalid integer value: \" + value);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case STRING:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return value.toString();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case LIST:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return parseListValue(value);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // æ·»åŠ æ›´å¤šçš„ç±»å‹ï¼Œæ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Unsupported type: \" + type);\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n\n&nbsp; &nbsp; private List&lt;Object&gt; parseListValue(Object value) {\n&nbsp; &nbsp; &nbsp; &nbsp; // è§£æåˆ—è¡¨ç±»å‹çš„å€¼\n&nbsp; &nbsp; &nbsp; &nbsp; if (value instanceof String) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼ŒæŒ‰ç©ºæ ¼åˆ†å‰²\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String[] parts = ((String) value).split(\" \");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&lt;Object&gt; listValues = new ArrayList&lt;&gt;();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (String part : parts) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listValues.add(part);\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return listValues;\n&nbsp; &nbsp; &nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalArgumentException(\"Invalid list value: \" + value);\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/yy/f6/yyf4a222257dacf4f2f35a0833c03ff6.jpg?wh=1372x284\" alt=\"\"></p><p>æˆ‘ä»¬çœ‹åˆ°è¿™é‡ŒChatGPTåœ¨mainæ–¹æ³•ä¸­ç»™å‡ºäº†é…ç½®CommandLineParserçš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ”¹åˆ°æˆ‘ä»¬çš„æµ‹è¯•ä¸­ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ChatGPTä¿®æ”¹æˆ‘ä»¬çš„æµ‹è¯•ï¼Œä½†å…¶å®æ²¡æœ‰è¿™ä¸ªå¿…è¦ã€‚</p><h2>å°ç»“</h2><p>æŒ‰ç…§ChatGPTç»™å‡ºçš„ä¿®æ”¹ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡èƒ½é€šè¿‡å…¨éƒ¨çš„æµ‹è¯•ã€‚æ–°çš„é”™è¯¯ç»§ç»­å‡ºç°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7a/1f/7a724809834fd15fa3ee36b5fb5f7a1f.jpg?wh=2911x2089\" alt=\"\"></p><p>è¿™æ¬¡æ˜¯åˆ—è¡¨çš„ç»“æ„é”™è¯¯ã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å‘Šè¯‰ChatGPTï¼Œé”™è¯¯å‘ç”Ÿåœ¨å“ªï¼Œç„¶åè®©ChatGPTå†é‡å†™ä»£ç ã€‚è¿‡ç¨‹ä¸å‰é¢çš„ç±»ä¼¼ï¼Œæˆ‘ä»¬å°±ä¸å†é‡å¤äº†ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘å¹¶ä¸æ˜¯æƒ³è¯´ChatGPTç”Ÿæˆçš„ä»£ç æœ‰å¤šä¹ˆçš„ä¸é è°±ã€‚æ°æ°ç›¸åï¼Œå“ªæ€•æ¼æ´ç™¾å‡ºï¼Œè¿™ä»ç„¶å±•ç¤ºäº†å·¨å¤§çš„æ•ˆç‡æå‡ã€‚ä½ å¯ä»¥è¯•è¯•è‡ªå·±ä»å¤´å¼€å§‹ç¼–å†™è¿™ä¹ˆä¸€æ®µåŠŸèƒ½ï¼Œå†æ¯”è¾ƒä¸€ä¸‹è¿™èŠ‚è¯¾å±•ç¤ºçš„æ–¹æ³•ï¼Œå°±ä¼šæ˜ç™½æˆ‘çš„æ„æ€ã€‚</p><p>è¿™é‡Œæˆ‘æƒ³æé†’ä½ çš„æ˜¯ï¼Œ<strong>LLMå¿«åˆ™å¿«çŸ£ï¼Œè´¨é‡å ªå¿§ã€‚å½“æˆ‘ä»¬ä½¿ç”¨LLMè¾…åŠ©è½¯ä»¶å¼€å‘çš„æ—¶å€™ï¼Œæ›´å¤šçš„ç²¾åŠ›è¦æ”¾åˆ°è´¨é‡çš„æ§åˆ¶ä¸Šã€‚è€Œä¸æ˜¯ä¸€å‘³åœ°å…³æ³¨æ•ˆç‡ã€‚</strong></p><p>é‚£ä¹ˆä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±æ¥è®²è®²æ€ä¹ˆåœ¨æé«˜æ•ˆç‡çš„åŒæ—¶ä¿æŒè´¨é‡ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯·è·ŸLLMä¸€èµ·å®Œæˆè¯¾ç¨‹ä¸­çš„è¿™ä¸ªé¢˜ç›®ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºåˆ†äº«è‡ªå·±çš„æ€è€ƒæˆ–ç–‘æƒ‘ï¼Œæˆ‘ä»¬ä¼šæŠŠç²¾å½©å†…å®¹ç½®é¡¶ä¾›å¤§å®¶å­¦ä¹ è®¨è®ºã€‚</p>","comments":[{"had_liked":false,"id":389485,"user_name":"ç©¿é´å­çš„åŠ è²çŒ«","can_delete":false,"product_type":"c1","uid":1003965,"ip_address":"ä¸Šæµ·","ucode":"D0FA3B15E061F1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkdXSdtiahZTGT2ArFNGa93OaDf9dRE96Vz82YwUDsFJOWXYkGFibkjNHhQ7CPITERuicv6MHKS2Kxw/132","comment_is_top":false,"comment_ctime":1712726963,"is_pvip":false,"replies":[{"id":141691,"content":"åŸæœ¬éœ€æ±‚å°±è¿™æ ·","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2537798,"ctime":1712731186,"ip_address":"æµ™æ±Ÿ","comment_id":389485,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"â€œlâ€ï¼ˆæ—¥å¿—ï¼‰æ²¡æœ‰ç›¸å…³çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”æ ‡å¿—ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¸º trueï¼Œä¸å­˜åœ¨åˆ™ä¸º falseã€‚â€œpâ€ï¼ˆç«¯å£ï¼‰æœ‰ä¸€ä¸ªæ•´æ•°å€¼ï¼Œâ€œdâ€ï¼ˆç›®å½•ï¼‰æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚æ ‡å¿—åé¢å¦‚æœå­˜åœ¨å¤šä¸ªå€¼ï¼Œåˆ™è¯¥æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼š\nÂ \n-g this is a list -d 1 2 -3 5\nÂ \nâ€œgâ€ è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨[â€œthisâ€, â€œisâ€, â€œaâ€, â€œlistâ€]ï¼Œ&quot;d&quot;æ ‡å¿—è¡¨ç¤ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨[1, 2, -3, 5]ã€‚\nÂ \nè¿™é‡Œç¬¬äºŒä¸ªdæ˜¯ä¸æ˜¯æ¢ä¸ªå­—æ¯å¥½ç‚¹ï¼Œåæ–‡ç¬¬äºŒæ¬¡è°ƒè¯•æ—¶dä»£è¡¨å­—ç¬¦ä¸²ï¼Œä¼šå¢åŠ ç†è§£æˆæœ¬","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641521,"discussion_content":"åŸæœ¬éœ€æ±‚å°±è¿™æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712731186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389473,"user_name":"æœ¯å­ç±³å¾·","can_delete":false,"product_type":"c1","uid":1898023,"ip_address":"æ—¥æœ¬","ucode":"382EA7E2AF0B56","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg","comment_is_top":false,"comment_ctime":1712704138,"is_pvip":true,"replies":[{"id":141688,"content":"å› ä¸ºåœ¨ä½ è¯´è¿™çš„è¿™äº›ä¹‹å‰ï¼Œéœ€è¦æŠŠæŠ€æœ¯çŸ¥è¯†å¤„ç†æ‰ã€‚æ¯”å¦‚ä½ è¯´æ‹†ä»»åŠ¡è¿™ä¸ª é‚£éœ€è¦æŠŠæ¶æ„å’Œæµ‹è¯•ç­–ç•¥ æ”¾åˆ°llmé‡Œæ‰è¡Œã€‚åç»­è¯¾ç¨‹é‡Œè¿™ä¸ªä¾‹å­è¿˜ä¼šå†åšä¸€éï¼Œåˆ°æ—¶å¯ä»¥ä»”ç»†å¯¹æ¯”ä¸€ä¸‹ä¸¤ç§æ–¹å¼çš„ä¸åŒã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":1501385,"ctime":1712719147,"ip_address":"åŒ—äº¬","comment_id":389473,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"ğŸ¤”â˜•ï¸ğŸ¤”â˜•ï¸ğŸ¤”\nã€Qã€‘å‰é¢çš„è¯¾ç¨‹ï¼Œæ‹‰æ¥è®¤çŸ¥æ¨¡å‹ï¼Œæ‹‰å‡ºLLMè¾…åŠ©å»ºæ¨¡å’Œç”¨æˆ·æ•…äº‹ï¼Œåšäº†è¿™ä¹ˆå¤šå‡†å¤‡ï¼Œæ€ä¹ˆå°±è·³è·ƒåˆ°CleanCodeçš„parseCmdLineArgsï¼Œè¿™æ˜¯å‡ºç°å¹»è§‰äº†å˜›ï¼Ÿé¡¹ç›®é‡Œï¼Œéš¾é“ä¸æ˜¯åŸºäºç”¨æˆ·æ•…äº‹å’Œå»ºå‡ºæ¥çš„æ¨¡å‹ï¼Œå¼€å§‹æ‹†è§£åˆ°ä»»åŠ¡åˆ—è¡¨ï¼Œè®©LLMæµ¸æ³¡åœ¨è¿™ä¸ªKnowledgeContexté‡ŒæŒç»­è¾…åŠ©ï¼Œç„¶åç”¨TDDçš„æ–¹æ³•è¾¹éªŒè¯ã€è¾¹å®ç°ã€è¾¹è¯¦ç»†è®¾è®¡ã€è¾¹èºæ—‹è¿­ä»£å˜›ï¼Ÿ å¿½ç„¶é—´åˆ‡æ¢KnowledgeContextï¼Œè¿™ä¸ªäººä¹Ÿé€‚ç”¨ä¸äº†ï¼Œæ›´ä½•å†µLLMæ€ä¹ˆé€‚åº”ï¼Œè¿™ä¸ªè·³è·ƒçœŸä¸æ‡‚ã€‚\nâ€” by æœ¯å­ç±³å¾·@2024å¹´4æœˆ10æ—¥","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641512,"discussion_content":"å› ä¸ºåœ¨ä½ è¯´è¿™çš„è¿™äº›ä¹‹å‰ï¼Œéœ€è¦æŠŠæŠ€æœ¯çŸ¥è¯†å¤„ç†æ‰ã€‚æ¯”å¦‚ä½ è¯´æ‹†ä»»åŠ¡è¿™ä¸ª é‚£éœ€è¦æŠŠæ¶æ„å’Œæµ‹è¯•ç­–ç•¥ æ”¾åˆ°llmé‡Œæ‰è¡Œã€‚åç»­è¯¾ç¨‹é‡Œè¿™ä¸ªä¾‹å­è¿˜ä¼šå†åšä¸€éï¼Œåˆ°æ—¶å¯ä»¥ä»”ç»†å¯¹æ¯”ä¸€ä¸‹ä¸¤ç§æ–¹å¼çš„ä¸åŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712719147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389520,"user_name":"æœ¯å­ç±³å¾·","can_delete":false,"product_type":"c1","uid":1898023,"ip_address":"æ—¥æœ¬","ucode":"382EA7E2AF0B56","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg","comment_is_top":false,"comment_ctime":1712761451,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"\n&#47;&#47;BEGIN UT CODE GENERATED BY GITHUB COPILOT, EXCEPT FIRST LINE COMMENT\n&#47;&#47;use gtest to test the function CC_parseCmdLineArgs defined in CC_parseCmdLineArgs.h\n#include &quot;CC_parseCmdLineArgs.h&quot;\n#include &lt;gtest&#47;gtest.h&gt;\n\nTEST(CC_parseCmdLineArgs, NullCmdLineArgs) {\n  CC_CmdLineArgs_T CmdLineArgs;\n  EXPECT_EQ(CC_FAIL, CC_parseCmdLineArgs(0, NULL, &amp;CmdLineArgs));\n}\n\nTEST(CC_parseCmdLineArgs, NullCmdLineArgsPtr) {\n  EXPECT_EQ(CC_FAIL, CC_parseCmdLineArgs(0, NULL, NULL));\n}\n\nTEST(CC_parseCmdLineArgs, NoArgs) {\n  CC_CmdLineArgs_T CmdLineArgs;\n  char *argv[] = { (char *)&quot;test&quot; };\n  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(1, argv, &amp;CmdLineArgs));\n  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);\n  EXPECT_EQ(0, CmdLineArgs.RecvPort);\n  EXPECT_EQ(NULL, CmdLineArgs.pLogSavingDir);\n}\n\n...\n\nTEST(CC_parseCmdLineArgs, RecvPort) {\n  CC_CmdLineArgs_T CmdLineArgs;\n  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-p&quot;, (char *)&quot;1234&quot; };\n  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(3, argv, &amp;CmdLineArgs));\n  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);\n  EXPECT_EQ(1234, CmdLineArgs.RecvPort);\n  EXPECT_EQ(NULL, CmdLineArgs.pLogSavingDir);\n}\n\nTEST(CC_parseCmdLineArgs, LogSavingDir) {\n  CC_CmdLineArgs_T CmdLineArgs;\n  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-d&quot;, (char *)&quot;&#47;tmp&quot; };\n  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(3, argv, &amp;CmdLineArgs));\n  EXPECT_FALSE(CmdLineArgs.IsLoggingEnabled);\n  EXPECT_EQ(0, CmdLineArgs.RecvPort);\n  EXPECT_STREQ(&quot;&#47;tmp&quot;, CmdLineArgs.pLogSavingDir);\n}\n\nTEST(CC_parseCmdLineArgs, AllArgs) {\n  CC_CmdLineArgs_T CmdLineArgs;\n  char *argv[] = { (char *)&quot;test&quot;, (char *)&quot;-l&quot;, (char *)&quot;-p&quot;, (char *)&quot;1234&quot;, (char *)&quot;-d&quot;, (char *)&quot;&#47;tmp&quot; };\n  EXPECT_EQ(CC_SUCCESS, CC_parseCmdLineArgs(7, argv, &amp;CmdLineArgs));\n  EXPECT_TRUE(CmdLineArgs.IsLoggingEnabled);\n  EXPECT_EQ(1234, CmdLineArgs.RecvPort);\n  EXPECT_STREQ(&quot;&#47;tmp&quot;, CmdLineArgs.pLogSavingDir);\n}\n\nint main(int argc, char **argv) {\n  testing::InitGoogleTest(&amp;argc, argv);\n  return RUN_ALL_TESTS();\n}","like_count":0},{"had_liked":false,"id":389519,"user_name":"æœ¯å­ç±³å¾·","can_delete":false,"product_type":"c1","uid":1898023,"ip_address":"æ—¥æœ¬","ucode":"382EA7E2AF0B56","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg","comment_is_top":false,"comment_ctime":1712761410,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"&#47;&#47;BEGIN CODE&amp;COMMENT BY ME\n\ntypedef enum {\n  CC_SUCCESS = 0,\n  CC_FAIL    = 1,\n} CC_Result_T;\n\ntypedef struct {\n  bool IsLoggingEnabled;  &#47;&#47;-l\n  int RecvPort;           &#47;&#47;-p &lt;port&gt;\n  char *pLogSavingDir;    &#47;&#47;-d &lt;dir&gt;\n} CC_CmdLineArgs_T;\n\n&#47;**\n * @brief: Use CC_parseCmdLineArgs to parse command line arguments and save them in CC_CmdLingArgs_T.\n *\n * @param argc same as main\n * @param argv same as main\n * @param pCmdLineArgs pointer to CC_CmdLineArgs_T\n * @return CC_SUCCESS if successful, CC_FAIL otherwise in CC_Result_T\n *&#47;\nCC_Result_T CC_parseCmdLineArgs(int argc, char *argv[], CC_CmdLineArgs_T *pCmdLineArgs);\n","like_count":0},{"had_liked":false,"id":389480,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"æµ™æ±Ÿ","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1712713490,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"ä½¿ç”¨ AI ç”Ÿæˆçš„æµ‹è¯•é€šè¿‡ 9 ä¸ªï¼Œå¤±è´¥ 7 ä¸ªã€‚åœ¨å·²æœ‰ä»£ç ä¸Šä¿®è¡¥ï¼Œæ¯”è‡ªå·±ä» 0 åˆ° 1 å®ç°å¿«äº†éå¸¸å¤šï¼Œè¿™ä¸ªåªç”¨äº†åå‡ åˆ†é’Ÿï¼\n\nä¸»è¦æ­¥éª¤ï¼š\n1. 15 è¯¾çš„ä¾‹å­æ‰”ç»™ coze çš„ GPT4ï¼Œå¾—åˆ°çš„ä»£ç ç®€å•ç²—æš´\n2. ä½¿ç”¨ Optimize åŠŸèƒ½ä¼˜åŒ–ä¸€ä¸‹ prompt\n3. åœ¨ä¼˜åŒ–çš„ prompt ä¸Šæ·»åŠ è‡ªå·±çš„æƒ³æ³•\n4. å› è¿”å› token é™åˆ¶ï¼Œéœ€è¦å¤šæ¬¡å¯¹è¯å®Œæˆç»“æœ\n  4.1 è¯·ç»™å‡º CommandLineParser çš„å®Œæ•´ä»£ç \n  4.2 è¯·ç»™å‡ºå®Œæ•´æµ‹è¯•ä»£ç \n  4.3 è¡¥å…¨æµ‹è¯•ä»£ç ï¼šæµ‹è¯•ç”¨ä¾‹å¯ä»¥ç»§ç»­å¢åŠ ï¼ŒåŒ…æ‹¬å„ç§è¾¹ç•Œæƒ…å†µå’Œæ— æ•ˆè¾“å…¥\n5. æœ€ç»ˆå¾—åˆ°çš„ä»£ç è™½ç„¶æµ‹è¯•æ²¡è·‘é€šï¼Œä½†åŠŸèƒ½å¼ºå¤§","like_count":0,"discussions":[{"author":{"id":3845368,"avatar":"","nickname":"Geek_615be5","note":"","ucode":"F35C8C3BBFF395","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641665,"discussion_content":"è®°å¾—å½“æ—¶è‡ªå·±tddä»0åˆ°1æ—¶ï¼Œç”¨äº†æŒºé•¿æ—¶é—´ï¼Œå…·ä½“è®°ä¸æ¸…äº†ï¼ŒåŠä¸ªå°æ—¶åˆ°ä¸€ä¸ªå°æ—¶å§ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1712879297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³å—","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}