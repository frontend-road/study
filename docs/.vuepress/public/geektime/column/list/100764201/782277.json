{"id":782277,"title":"11ï½œé•¿PDFæ–‡æ¡£çš„æ€»ç»“ä¸è¯„ä¼°ç­–ç•¥","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é»„ä½³ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥æ¢ç´¢å¤§è¯­è¨€æ¨¡å‹åœ¨å¦ä¸€ä¸ªä¼ ç»Ÿè‡ªç„¶è¯­è¨€å¤„ç†åº”ç”¨åœºæ™¯ä¸­çš„çªç ´ï¼Œå°±æ˜¯é•¿æ–‡æ¡£çš„æ€»ç»“å’Œè¯„ä¼°ï¼Œè¿™ä¹Ÿæ˜¯å¤§è¯­è¨€æ¨¡å‹çš„ä¸€ä¸ªé‡è¦åº”ç”¨æ–¹å‘ã€‚æˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹çš„å¼ºå¤§èƒ½åŠ›ï¼Œå®ç°é«˜è´¨é‡çš„æ–‡æ¡£æ€»ç»“ï¼Œå¹¶å¯¹æ€»ç»“ç»“æœè¿›è¡Œå…¨é¢è¯„ä¼°ã€‚</p><h2>æ–°ä¸€ä»£å¤§æ¨¡å‹å‡ºç°ä¹‹å‰çš„æ–‡æ¡£æ€»ç»“</h2><p>æ–‡æ¡£æ€»ç»“æ˜¯ä¸€ä¸ªç»å…¸è¯¾é¢˜ã€‚ä¼ ç»Ÿçš„æ–‡æ¡£æ€»ç»“æ–¹æ³•é€šå¸¸åŸºäºç»Ÿè®¡å­¦å’Œä¿¡æ¯æ£€ç´¢ç†è®ºï¼Œå¦‚æå–å…³é”®è¯ã€å¥å­æ’åºç­‰ã€‚è¿™äº›æ–¹æ³•è™½ç„¶ç®€å•é«˜æ•ˆï¼Œä½†åœ¨å¤„ç†é•¿æ–‡æ¡£ã€å¤æ‚è¯­ä¹‰æ—¶å¾€å¾€åŠ›ä¸ä»å¿ƒã€‚</p><p>è€ä¸€ä»£çš„å¤§æ¨¡å‹æ–‡æ¡£æ€»ç»“é€šå¸¸é‡‡ç”¨ä¸¤ç§èŒƒå¼ï¼šæ–‡æœ¬æŠ½å–å¼ï¼ˆExtractiveï¼‰å’Œæ‘˜è¦ç”Ÿæˆå¼ï¼ˆAbstractiveï¼‰ã€‚</p><ul>\n<li>æŠ½å–å¼æ–¹æ³•æ˜¯ä»åŸæ–‡ä¸­é€‰å–å…³é”®å¥ä½œä¸ºæ‘˜è¦ã€‚æ¯”å¦‚åŸºäºBERTçš„æ–‡æ¡£æ€»ç»“å°±å¸¸å¸¸ä½¿ç”¨è¿™ä¸ªèŒƒå¼ã€‚</li>\n<li>ç”Ÿæˆå¼æ–¹æ³•åˆ™æ ¹æ®å¯¹åŸæ–‡çš„ç†è§£ï¼Œç”Ÿæˆæ–°çš„æ‘˜è¦æ–‡æœ¬ã€‚æ¯”å¦‚åŸºäºåˆä»£GPTã€T5ã€BARTç­‰ç”Ÿæˆå¼æ¨¡å‹çš„æ–‡æ¡£æ€»ç»“å°±åŸºäºè¿™ä¸ªèŒƒå¼ã€‚</li>\n</ul><p>ä¸‹é¢ï¼Œè®©æˆ‘å¸¦ç€ä½ ç”¨ä¸€ä¸ªç»å…¸â€œè€â€NLPæ¨¡å‹ T5ï¼Œæ¥åšä¸€ä¸ªè®ºæ–‡çš„æ‘˜è¦æ€»ç»“ã€‚è®ºæ–‡æˆ‘ä»¬éšä¾¿é€‰æ‹©ä¸€ä¸ªå°±å¯ä»¥äº†ï¼Œè¿™é‡Œï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ <a href=\"https://arxiv.org/abs/2401.02385\">Tiny Llama</a> è¿™ç¯‡è®ºæ–‡ï¼Œå…ˆçœ‹çœ‹å®ƒä¸»è¦è¯´äº†ä»€ä¹ˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/09/7f/0934ef4b0f0d7faa77a3411a0b2cd27f.png?wh=1286x692\" alt=\"å›¾ç‰‡\"></p><p>è¿™ç¯‡è®ºæ–‡ä»‹ç»çš„TinyLlamaæ˜¯ä¸€ä¸ª1.1Bå‚æ•°çš„å°å‹è¯­è¨€æ¨¡å‹ï¼Œåœ¨çº¦1ä¸‡äº¿Tokenä¸Šé¢„è®­ç»ƒäº†3ä¸ªEpochã€‚å®ƒé‡‡ç”¨äº†Llama 2çš„æ¶æ„å’Œåˆ†è¯å™¨ï¼Œå¹¶åˆ©ç”¨äº†å¼€æºç¤¾åŒºè´¡çŒ®çš„å„ç§è¿›å±•ï¼ˆå¦‚FlashAttentionï¼‰ä»¥æé«˜è®¡ç®—æ•ˆç‡ã€‚å°½ç®¡è§„æ¨¡ç›¸å¯¹è¾ƒå°ï¼Œä½†TinyLlamaåœ¨ä¸€ç³»åˆ—ä¸‹æ¸¸ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ï¼Œä¼˜äºå…·æœ‰ç›¸ä¼¼è§„æ¨¡çš„ç°æœ‰å¼€æºè¯­è¨€æ¨¡å‹ã€‚</p><!-- [[[read_end]]] --><p>é¦–å…ˆï¼Œå¯¼å…¥PyPDF2åŒ…ï¼Œæ‰“å¼€è®ºæ–‡æ–‡ä»¶ï¼Œè¯»å–PDFæ–‡ä»¶å†…å®¹ã€‚</p><pre><code class=\"language-plain\"># å¯¼å…¥PyPDF2åŒ…\nimport PyPDF2\n\n# è¯»å–PDFæ–‡ä»¶å†…å®¹\npdf_path = \"99_data\\\\pdf\\\\2401.02385-TinyLlama.pdf\"\ndef read_pdf(file_path):\n&nbsp; &nbsp; with open(file_path, 'rb') as file:\n&nbsp; &nbsp; &nbsp; &nbsp; reader = PyPDF2.PdfReader(file)\n&nbsp; &nbsp; &nbsp; &nbsp; text = \"\"\n&nbsp; &nbsp; &nbsp; &nbsp; for page in reader.pages:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; text += page.extract_text()\n&nbsp; &nbsp; return text\n</code></pre><p>ç„¶åï¼Œå¯¼å…¥T5æ¨¡å‹å’Œåˆ†è¯å™¨ï¼Œ å®šä¹‰å‡½æ•°æ¥åŠ è½½æ¨¡å‹å’Œåˆ†è¯å™¨ã€‚</p><pre><code class=\"language-plain\"># å¯¼å…¥T5æ¨¡å‹å’Œåˆ†è¯å™¨\nfrom transformers import T5Tokenizer, T5ForConditionalGeneration\n\n# å®šä¹‰å‡½æ•°æ¥åŠ è½½æ¨¡å‹å’Œåˆ†è¯å™¨\ndef load_model(model_name='t5-small'):\n&nbsp; &nbsp; tokenizer = T5Tokenizer.from_pretrained(model_name)\n&nbsp; &nbsp; model = T5ForConditionalGeneration.from_pretrained(model_name)\n&nbsp; &nbsp; return tokenizer, model\n</code></pre><p>æœ€åï¼Œå°±å¯ä»¥é€šè¿‡T5æ¨¡å‹æ¥åšæ–‡æ¡£æ€»ç»“å•¦ï¼</p><pre><code class=\"language-plain\"># å®šä¹‰å‡½æ•°è¿›è¡Œæ–‡æœ¬æ€»ç»“\ndef summarize_text(text, tokenizer, model):\n&nbsp; &nbsp; # ä½¿ç”¨T5çš„å‰ç¼€æ¥æŒ‡å®šä»»åŠ¡ç±»å‹\n&nbsp; &nbsp; text = \"summarize: \" + text\n&nbsp; &nbsp; \n&nbsp; &nbsp; # å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç \n&nbsp; &nbsp; inputs = tokenizer.encode(text, return_tensors=\"pt\", max_length=512, truncation=True)\n&nbsp; &nbsp; \n&nbsp; &nbsp; # ä½¿ç”¨æ¨¡å‹ç”Ÿæˆæ€»ç»“\n&nbsp; &nbsp; summary_ids = model.generate(inputs, max_length=150, min_length=40, length_penalty=2.0, num_beams=4, early_stopping=True)\n&nbsp; &nbsp; \n&nbsp; &nbsp; # è§£ç ç”Ÿæˆçš„æ€»ç»“\n&nbsp; &nbsp; summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)\n&nbsp; &nbsp; \n&nbsp; &nbsp; return summary\n\n# åŠ è½½é¢„è®­ç»ƒçš„T5æ¨¡å‹\ntokenizer, model = load_model('t5-small')\n\n# å¯¹PDFå†…å®¹è¿›è¡Œæ€»ç»“\npdf_summary = summarize_text(pdf_text, tokenizer, model)\nprint(\"Generated Summary:\", pdf_summary)\n\n# ä¿å­˜ç”Ÿæˆçš„æ‘˜è¦åˆ°æ–‡ä»¶\nwith open(\"t5_summary.txt\", \"w\", encoding=\"utf-8\") as file:\n&nbsp; &nbsp; file.write(t5_summary)\n</code></pre><p>ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">TinyLlama is a compact 1.1B language model pretrained on around 1 trillion tokens for approximately 3 epochs. despite its relatively small size, it significantly outperforms existing open-source language models with compara-ble sizes.\n</code></pre><p>ç»“æœçœ‹èµ·æ¥ä¸é”™ï¼Œå¯¹å—ï¼Ÿå…¶å®ä¸ç„¶ã€‚</p><p>é¦–å…ˆï¼ŒT5çš„æ€»ç»“ç»“æœå…¶å®æ›´åƒæ˜¯è®ºæ–‡å¼€å¤´éƒ¨åˆ†çš„ç…§æ¬ç…§æŠ„ã€‚å¦å¤–ï¼Œä½ åœ¨ç¨‹åºä¸­åº”è¯¥æ³¨æ„åˆ°max_length=512è¿™ä¸ªå‚æ•°ï¼Œå…¶å®ä¼ ç»Ÿçš„â€œå¤§â€è¯­è¨€æ¨¡å‹ï¼Œå¦‚BERTã€T5ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªèƒ½å¤Ÿæ¥å—512ï¼Œæœ€å¤š1024ä¸ªTokenï¼Œå¯ä¸åƒæ–°ä¸€ä»£çš„æ¨¡å‹åŠ¨ä¸åŠ¨å°±å¯ä»¥æ¥å—å‡ ä¸‡ã€å‡ åä¸‡çš„Tokenä½œä¸ºä¸Šä¸‹æ–‡ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æ‰€çœ‹åˆ°çš„Summaryç»“æœï¼Œåªä¸è¿‡æ˜¯å¯¹æ•´ä¸ªè®ºæ–‡ç¬¬ä¸€æ®µè¯çš„æ€»ç»“ã€‚ğŸ˜</p><p>å¯¹äºè€ä¸€ä»£æ¨¡å‹æ¥è¯´ï¼Œé’ˆå¯¹æ–‡æ¡£æ€»ç»“ä»»åŠ¡å¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼ˆFine-tuneï¼‰ï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥æå‡å®ƒä»¬çš„æ‘˜è¦è´¨é‡ã€‚å¾®è°ƒä½¿æ¨¡å‹æ›´åŠ é€‚åº”ç‰¹å®šé¢†åŸŸçš„æ–‡æœ¬ï¼Œå­¦ä¹ æ€»ç»“çš„æ ¼å¼å’Œé£æ ¼ã€‚åœ¨ä¸€äº›ç ”ç©¶ä¸­è¿˜æå‡ºäº†å¤æ‚çš„Promptè®¾è®¡ï¼Œå¼•å¯¼æ¨¡å‹ç”Ÿæˆæ»¡è¶³ç‰¹å®šéœ€æ±‚çš„æ‘˜è¦ã€‚</p><p>å½“ç„¶ï¼Œç°åœ¨æœ‰äº†çœŸæ­£çš„å¤§æ¨¡å‹ï¼Œè¿™ç§å¾®è°ƒä¹Ÿå·²ç»æ˜¯æ˜¨æ—¥é»„èŠ±äº†ã€‚</p><h2>ç”¨æ–°ä¸€ä»£çš„å¤§æ¨¡å‹åšæ–‡æ¡£æ€»ç»“</h2><p>ChatGPTç­‰æ–°ä¸€ä»£å¤§è¯­è¨€æ¨¡å‹çš„å‡ºç°ï¼Œä¸ºæ–‡æ¡£æ€»ç»“å¸¦æ¥äº†æ–°çš„çªç ´ã€‚è¿™äº›æ¨¡å‹åœ¨æµ·é‡æ–‡æœ¬æ•°æ®ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œå­¦ä¹ åˆ°äº†ä¸°å¯Œçš„è¯­è¨€çŸ¥è¯†å’Œé€šç”¨è¡¨ç¤ºã€‚å®ƒä»¬èƒ½å¤Ÿæ·±å…¥ç†è§£æ–‡æœ¬çš„è¯­ä¹‰ã€ç»“æ„ã€æ ·å¼ç­‰å„ä¸ªæ–¹é¢ï¼Œç”Ÿæˆè¿è´¯ã€é€šé¡ºçš„æ‘˜è¦ã€‚</p><p>å¥½å•¦ï¼Œè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ç°åœ¨åˆ©ç”¨å¼ºå¤§çš„Claude-3 Opusï¼Œæ¥ç”ŸæˆçœŸæ­£é«˜æ•ˆçš„PDFè®ºæ–‡æ€»ç»“ã€‚</p><p>é¦–å…ˆï¼Œå¯¼å…¥PyPDF2åŒ…ï¼Œæ‰“å¼€è®ºæ–‡æ–‡ä»¶ï¼Œè¯»å–PDFæ–‡ä»¶å†…å®¹ã€‚è¿™ä¸ªæ­¥éª¤å’Œä»£ç å‰é¢å·²ä»‹ç»ã€‚</p><p>ç„¶åï¼Œå¯¼å…¥anthropicåº“ï¼Œå¹¶è®¾ç½®APIå¯†é’¥ã€‚</p><pre><code class=\"language-plain\">from dotenv import load_dotenv\nload_dotenv()\n\nimport os \nimport anthropic\nos.environ[\"ANTHROPIC_API_KEY\"] = \"&lt;your_api_key&gt;\"\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªåä¸ºgenerate_summaryçš„å‡½æ•°ï¼Œç”¨äºåˆ©ç”¨Claudeæ¨¡å‹ç”Ÿæˆç ”ç©¶è®ºæ–‡çš„æ‘˜è¦ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•°textï¼Œå³è¦æ€»ç»“çš„è®ºæ–‡å…¨æ–‡ï¼Œç„¶åä¼šè¿”å›å…¨æ–‡çš„æ€»ç»“ã€‚</p><pre><code class=\"language-plain\">def generate_summary(text):\n&nbsp; &nbsp; client = anthropic.Anthropic()\n&nbsp; &nbsp; \n&nbsp; &nbsp; system_prompt = \"ä½ æ˜¯ä¸€ä¸ªç”¨äºæ€»ç»“ç ”ç©¶è®ºæ–‡çš„AIåŠ©æ‰‹ã€‚\"\n&nbsp; &nbsp; \n&nbsp; &nbsp; messages = [\n&nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"role\": \"user\", \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"content\": [\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"type\": \"text\",\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"text\": f\"\"\"\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; è¯·æ€»ç»“ä»¥ä¸‹ç ”ç©¶è®ºæ–‡,é‡ç‚¹å…³æ³¨å…¶å…³é”®å‘ç°ã€æ–¹æ³•å’Œç»“è®º:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {text}\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; è¯·ç”¨å¤§çº¦150å­—æä¾›ä¸€ä¸ªç®€æ˜æ‰¼è¦çš„è‹±æ–‡æ‘˜è¦ã€‚\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"\"\"\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; ]\n&nbsp; &nbsp; \n&nbsp; &nbsp; message = client.messages.create(\n&nbsp; &nbsp; &nbsp; &nbsp; model=\"claude-3-opus-20240229\",\n&nbsp; &nbsp; &nbsp; &nbsp; max_tokens=1000,\n&nbsp; &nbsp; &nbsp; &nbsp; messages=messages,\n&nbsp; &nbsp; &nbsp; &nbsp; system=system_prompt\n&nbsp; &nbsp; )\n&nbsp; &nbsp; \n&nbsp; &nbsp; return message.content[0].text.strip()\n\n</code></pre><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªAnthropicå®¢æˆ·ç«¯å¯¹è±¡ï¼Œç”¨äºä¸Claudeæ¨¡å‹è¿›è¡Œäº¤äº’ã€‚åœ¨ç³»ç»Ÿæç¤ºä¸­ï¼Œæˆ‘ä»¬å‘Šè¯‰Claudeå®ƒæ˜¯ä¸€ä¸ªç”¨äºæ€»ç»“ç ”ç©¶è®ºæ–‡çš„AIåŠ©æ‰‹ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ„é€ äº†ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯ï¼Œå¹¶åœ¨æ¶ˆæ¯çš„å†…éƒ¨ä¸­é€šè¿‡ {text} å˜é‡åµŒå…¥äº†è¦æ€»ç»“çš„è®ºæ–‡å…¨æ–‡ã€‚æˆ‘ä»¬è¿˜åœ¨æ¶ˆæ¯ä¸­æä¾›äº†ä¸€äº›æŒ‡ç¤ºï¼Œè¦æ±‚Claudeå…³æ³¨è®ºæ–‡çš„å…³é”®å‘ç°ã€æ–¹æ³•å’Œç»“è®ºï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå¤§çº¦150å­—çš„ç®€æ´æ‘˜è¦ã€‚</p><p>client.messages.createæ–¹æ³•ä¼šå°†æ‰€æ„é€ çš„æ¶ˆæ¯åˆ—è¡¨ã€ç³»ç»Ÿæç¤ºä»¥åŠå…¶ä»–å‚æ•°ä¼ é€’ç»™Claudeã€‚Claudeä¼šæ ¹æ®è¿™äº›ä¿¡æ¯ç”Ÿæˆè®ºæ–‡çš„æ‘˜è¦ï¼Œå¹¶è¿”å›ç»“æœã€‚</p><p>æœ€åï¼Œä½¿ç”¨Claudeç”Ÿæˆæ€»ç»“å¹¶ä¿å­˜ã€‚</p><pre><code class=\"language-plain\"># ä½¿ç”¨Claudeç”Ÿæˆæ€»ç»“\nclaude_summary = generate_summary(pdf_text)\nprint(\"Summary:\", claude_summary)\n\n# ä¿å­˜ç”Ÿæˆçš„æ‘˜è¦åˆ°æ–‡ä»¶\nwith open(\"claude_summary.txt\", \"w\", encoding=\"utf-8\") as file:\n&nbsp; &nbsp; file.write(claude_summary)\n</code></pre><p>è¿è¡Œç¨‹åºåï¼Œå¾—åˆ°çš„æ€»ç»“æ–‡å­—å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2c/98/2c1415ba8edf7782594d32a7d27d8d98.png?wh=1041x163\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Summary:\nTinyLlama is an open-source 1.1B parameter language model pretrained on approximately 1 trillion tokens for 3 epochs. It leverages advances from the open-source community to achieve better computational efficiency. Despite its small size, TinyLlama significantly outperforms existing open-source language models of comparable sizes on various downstream tasks measuring commonsense reasoning and problem-solving capabilities. The authors tracked TinyLlama's performance on benchmarks during pretraining and found that its accuracy generally improves with more compute, surpassing Pythia-1.4B. TinyLlama's pretraining code, intermediate checkpoints, and data processing details have been publicly released. The authors believe TinyLlama's compact size and strong performance make it an attractive platform for researchers to test innovative ideas related to language models. They plan to develop future versions of TinyLlama with enhanced capabilities based on the experience gained from this open research project.\n</code></pre><p>ç¿»è¯‘æˆä¸­æ–‡ï¼š</p><blockquote>\n<p>TinyLlamaæ˜¯ä¸€ä¸ªå¼€æºçš„11äº¿å‚æ•°è¯­è¨€æ¨¡å‹ï¼Œåœ¨å¤§çº¦1ä¸‡äº¿ä¸ªæ ‡è®°ä¸Šé¢„è®­ç»ƒäº†3ä¸ªå‘¨æœŸã€‚å®ƒåˆ©ç”¨äº†å¼€æºç¤¾åŒºçš„è¿›å±•æ¥å®ç°æ›´å¥½çš„è®¡ç®—æ•ˆç‡ã€‚å°½ç®¡å…¶è§„æ¨¡è¾ƒå°ï¼Œä½†TinyLlamaåœ¨è¡¡é‡å¸¸è¯†æ¨ç†å’Œè§£å†³é—®é¢˜èƒ½åŠ›çš„å„ç§ä¸‹æ¸¸ä»»åŠ¡ä¸Šæ˜¾è‘—ä¼˜äºç°æœ‰çš„ç›¸ä¼¼è§„æ¨¡çš„å¼€æºè¯­è¨€æ¨¡å‹ã€‚ä½œè€…åœ¨é¢„è®­ç»ƒæœŸé—´è·Ÿè¸ªäº†TinyLlamaåœ¨åŸºå‡†æµ‹è¯•ä¸­çš„è¡¨ç°ï¼Œå‘ç°å…¶å‡†ç¡®æ€§é€šå¸¸éšç€è®¡ç®—é‡çš„å¢åŠ è€Œæé«˜ï¼Œè¶…è¿‡äº†Pythia-1.4Bã€‚TinyLlamaçš„é¢„è®­ç»ƒä»£ç ã€ä¸­é—´æ£€æŸ¥ç‚¹å’Œæ•°æ®å¤„ç†ç»†èŠ‚å·²ç»å…¬å¼€å‘å¸ƒã€‚ä½œè€…è®¤ä¸ºï¼ŒTinyLlamaçš„ç´§å‡‘å°ºå¯¸å’Œå¼ºå¤§æ€§èƒ½ä½¿å…¶æˆä¸ºç ”ç©¶äººå‘˜æµ‹è¯•ä¸è¯­è¨€æ¨¡å‹ç›¸å…³çš„åˆ›æ–°æƒ³æ³•çš„æœ‰å¸å¼•åŠ›çš„å¹³å°ã€‚ä»–ä»¬è®¡åˆ’æ ¹æ®ä»è¿™ä¸ªå¼€æ”¾ç ”ç©¶é¡¹ç›®ä¸­è·å¾—çš„ç»éªŒï¼Œå¼€å‘å…·æœ‰å¢å¼ºåŠŸèƒ½çš„TinyLlamaçš„æœªæ¥ç‰ˆæœ¬ã€‚</p>\n</blockquote><p>è¿™ä¸ªæ€»ç»“éå¸¸éå¸¸ä¼˜ç§€ã€‚å®ƒå¹¶ä¸æ˜¯åƒåˆšæ‰ T5 æ¨¡å‹é‚£æ ·ï¼Œåªæ˜¯å¯¹å¤´å‡ è¡Œæ–‡å­—çš„ç®€å•copyï¼Œè€Œæ˜¯è¯¦å®åœ°ä»‹ç»å‡ºäº†TinyLlamaè¿™ç¯‡è®ºæ–‡çš„ä¸»è¦å·¥ä½œã€æ„ä¹‰å’Œåˆ›æ–°ç‚¹ï¼Œä»¥åŠä½œè€…çš„è¯„è¿°åŠæœªæ¥è®¡åˆ’ã€‚</p><h2>è¯„ä¼°æ–‡æ¡£æ€»ç»“çš„ä¼˜åŠ£</h2><p>ä¸è¿‡ï¼Œå£è¯´æ— å‡­ï¼Œæˆ‘ä»¬éœ€è¦æƒ³ä¸€äº›åŠæ³•æ¥é‡åŒ–è¿™ä¸ªæ€»ç»“çš„ä¼˜è´¨ç¨‹åº¦ã€‚è¿™ä¸ä»…å¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£æ€»ç»“çš„æ•ˆæœï¼Œè¿˜å¯ä»¥ä¸ºè¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹æä¾›ä¾æ®ã€‚</p><p>æ‰€ä»¥ï¼Œä¸‹é¢æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯é€šè¿‡ä¸åŒçš„æ–¹æ³•æ¥é‡åŒ–æ–‡æ¡£æ€»ç»“çš„ä¼˜è´¨ç¨‹åº¦ã€‚</p><h3>åŸºäºçœŸå€¼çš„è¯„ä¼°</h3><p>åœ¨æ–‡æ¡£æ€»ç»“é¢†åŸŸï¼ŒåŸºäºçœŸå€¼çš„è¯„ä¼°æ˜¯å¸¸è§çš„æ–¹æ³•ã€‚æ–‡æ¡£æ€»ç»“çš„çœŸå€¼å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“è·å¾—çš„ï¼Œå¥½åœ¨å¯¹äºè®ºæ–‡æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>è®ºæ–‡æ‘˜è¦</strong>ä½œä¸ºçœŸå€¼ï¼Œç„¶åé€šè¿‡è®¡ç®—ç”Ÿæˆçš„æ€»ç»“ä¸çœŸå€¼ä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥è¯„ä¼°è´¨é‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/09/b0/092dc4a0973yy8c28c3yy5c894cd8eb0.jpg?wh=1833x1089\" alt=\"å›¾ç‰‡\" title=\"arxiv ç½‘ç«™ä¸­çš„æ¯ä¸€ç¯‡è®ºæ–‡éƒ½æœ‰ä½œè€…å¯¹è®ºæ–‡çš„æ€»ç»“\"></p><p>æœ‰äº†çœŸå€¼ä¹‹åï¼Œå¸¸ç”¨çš„ç»å…¸è¯„ä¼°æŒ‡æ ‡åŒ…æ‹¬ ROUGE å’Œ BERTScoreã€‚</p><h3>ROUGE è¯„ä¼°</h3><p>ROUGEï¼ˆRecall-Oriented Understudy for Gisting Evaluationï¼‰æ˜¯ä¸€ç»„ç”¨äºè‡ªåŠ¨åŒ–è¯„ä¼°æœºå™¨ç¿»è¯‘å’Œè‡ªåŠ¨æ‘˜è¦ç³»ç»Ÿæ€§èƒ½çš„æŒ‡æ ‡ï¼Œè¦è¡¡é‡ç”Ÿæˆæ‘˜è¦ä¸å‚è€ƒæ‘˜è¦ä¹‹é—´çš„é‡å æƒ…å†µï¼Œç‰¹åˆ«å…³æ³¨å›å¿†ç‡ï¼ˆRecallï¼‰ã€‚</p><p>ROUGEä¸»è¦æœ‰ä¸‰ç§å˜ä½“ï¼šROUGE-Nã€ROUGE-Lå’ŒROUGE-Sï¼Œä»ä¸åŒçš„è§’åº¦è¯„ä¼°æ‘˜è¦çš„è´¨é‡ã€‚</p><h4>1. ROUGE-N</h4><p>ROUGE-Næ˜¯åŸºäºN-gramçš„åŒ¹é…æ¥è¯„ä¼°ç”Ÿæˆæ‘˜è¦ä¸å‚è€ƒæ‘˜è¦ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚N-gramå¯ä»¥æ˜¯å•ä¸ªè¯ï¼ˆunigramï¼‰ã€åŒè¯ï¼ˆbigramï¼‰ã€ä¸‰è¯ï¼ˆtrigramï¼‰ç­‰ã€‚å¸¸è§çš„ROUGE-NæŒ‡æ ‡åŒ…æ‹¬ROUGE-1å’ŒROUGE-2ï¼Œåˆ†åˆ«è¡¨ç¤ºåŸºäºunigramå’Œbigramçš„åŒ¹é…æƒ…å†µã€‚</p><ul>\n<li>ROUGE-1ï¼šè®¡ç®—ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„unigramåŒ¹é…ã€‚</li>\n<li>ROUGE-2ï¼šè®¡ç®—ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„bigramåŒ¹é…ã€‚</li>\n</ul><p>ROUGE-Nçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/41/92/41dcb92990b9e5d87f07f6e239ba9992.png?wh=451x59\" alt=\"å›¾ç‰‡\"></p><p>å…¶ä¸­ï¼ŒCountmatch(gram) è¡¨ç¤ºç”Ÿæˆæ‘˜è¦ä¸­ N-gram çš„åŒ¹é…æ¬¡æ•°ï¼ŒCountRef(gram) åˆ™è¡¨ç¤ºå‚è€ƒæ‘˜è¦ä¸­N-gramçš„æ€»æ¬¡æ•°ã€‚</p><h4>2. ROUGE-L</h4><p>ROUGE-LåŸºäºæœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLongest Common Subsequence, LCSï¼‰æ¥è¯„ä¼°ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚é€šè¿‡è®¡ç®—ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„æœ€é•¿å…¬å…±å­åºåˆ—åŒ¹é…æƒ…å†µï¼ŒLCSèƒ½å¤Ÿæ•æ‰åˆ°å…¨å±€åºåˆ—ä¿¡æ¯ï¼Œè€Œä¸ä»…ä»…æ˜¯å±€éƒ¨çš„N-gramåŒ¹é…ã€‚</p><p>ROUGE-Lçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6e/96/6ef232ddbf606b05f9ff318218870596.png?wh=244x57\" alt=\"å›¾ç‰‡\"></p><p>â€‹å…¶ä¸­ï¼ŒLCS(Ref,Cand) è¡¨ç¤ºç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ï¼ŒLength(Ref)è¡¨ç¤ºå‚è€ƒæ‘˜è¦çš„é•¿åº¦ã€‚</p><h4>3. ROUGE-S</h4><p>ROUGE-Sï¼ˆSkip-Bigramï¼‰åŸºäºè·³è·ƒåŒè¯ï¼ˆskip-bigramï¼‰æ¥è¯„ä¼°ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚é€šè¿‡è®¡ç®—ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„è·³è·ƒåŒè¯åŒ¹é…æƒ…å†µï¼Œè·³è·ƒåŒè¯å…è®¸åœ¨ä¸æ”¹å˜è¯åºçš„æƒ…å†µä¸‹è·³è¿‡ä¸€äº›è¯ï¼Œè¿™æ ·å¯ä»¥æ›´çµæ´»åœ°æ•æ‰æ‘˜è¦ä¸­çš„è¯å¯¹å…³ç³»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5a/d4/5a4f1e880dec1b6de098915341d1f8d4.png?wh=551x55\" alt=\"å›¾ç‰‡\"></p><p>å› æ­¤ï¼ŒROUGEè¯„ä¼°æŒ‡æ ‡èƒ½å¤Ÿä»ä¸åŒçš„è§’åº¦è¯„ä¼°ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæ¶µç›–äº†å±€éƒ¨N-gramåŒ¹é…ï¼ˆROUGE-Nï¼‰ã€å…¨å±€åºåˆ—ä¿¡æ¯ï¼ˆROUGE-Lï¼‰å’Œçµæ´»è¯å¯¹å…³ç³»ï¼ˆROUGE-Sï¼‰ã€‚ç»“åˆè¿™äº›æŒ‡æ ‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å…¨é¢è¡¡é‡ç”Ÿæˆæ‘˜è¦çš„è´¨é‡ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨ROUGEè¯„ä¼°ç”Ÿæˆæ‘˜è¦çš„ç¤ºä¾‹ä»£ç ã€‚</p><pre><code class=\"language-plain\"># è¯»å–æ‘˜è¦æ–‡ä»¶\ndef read_summary(file_path):\n    with open(file_path, 'r', encoding='utf-8') as file:\n        return file.read()\nt5_summary = read_summary(\"t5_summary.txt\")\nclaude_summary = read_summary(\"claude_summary.txt\")\nref_summary = read_summary(\"ref_summary.txt\")\n\nfrom rouge import Rouge\n\n# Rougeè¯„ä¼°å‡½æ•°\ndef get_rouge_scores(text1, text2):\n&nbsp; &nbsp; rouge = Rouge()\n&nbsp; &nbsp; return rouge.get_scores(text1, text2)\n\n# ç¤ºä¾‹ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦\neval_summary = \"...\" # æŠŠæ€»ç»“ç»“æœæ”¾è¿›æ¥\nref_summary = \"...\" æŠŠè®ºæ–‡çš„åŸå§‹æ€»ç»“æ”¾è¿›æ¥\n\n# è®¡ç®—ROUGEåˆ†æ•°\nrouge_scores = get_rouge_scores(eval_summary, ref_summary)\n\n# æå–å¹¶æ˜¾ç¤ºå…³é”®çš„ROUGEæŒ‡æ ‡\nfor metric, scores in rouge_scores[0].items():\n&nbsp; &nbsp; print(f\"{metric} - Precision: {scores['p']}, Recall: {scores['r']}, F1-Score: {scores['f']}\")\n</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">ROUGE Scores:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;T5 Summary&nbsp; Claude Summary\nMetric\nrouge-1 (f)&nbsp; &nbsp; 0.568421&nbsp; &nbsp; &nbsp; &nbsp; 0.421875\nrouge-1 (p)&nbsp; &nbsp; 0.843750&nbsp; &nbsp; &nbsp; &nbsp; 0.415385\nrouge-1 (r)&nbsp; &nbsp; 0.428571&nbsp; &nbsp; &nbsp; &nbsp; 0.428571\nrouge-2 (f)&nbsp; &nbsp; 0.466019&nbsp; &nbsp; &nbsp; &nbsp; 0.178082\nrouge-2 (p)&nbsp; &nbsp; 0.727273&nbsp; &nbsp; &nbsp; &nbsp; 0.171053\nrouge-2 (r)&nbsp; &nbsp; 0.342857&nbsp; &nbsp; &nbsp; &nbsp; 0.185714\nrouge-l (f)&nbsp; &nbsp; 0.568421&nbsp; &nbsp; &nbsp; &nbsp; 0.406250\nrouge-l (p)&nbsp; &nbsp; 0.843750&nbsp; &nbsp; &nbsp; &nbsp; 0.400000\nrouge-l (r)&nbsp; &nbsp; 0.428571&nbsp; &nbsp; &nbsp; &nbsp; 0.412698\n</code></pre><p>è¿™æ ·ï¼Œå°±å¯ä»¥è®¡ç®—ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦çš„ROUGEåˆ†æ•°ï¼Œå¹¶ä»ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ã€å¬å›ç‡ï¼ˆRecallï¼‰å’ŒF1åˆ†æ•°ï¼ˆF1-Scoreï¼‰ä¸‰ä¸ªæ–¹é¢è¿›è¡Œåˆ†æã€‚å¦‚æœä»…ä»ROUGEæŒ‡æ ‡çœ‹ï¼ŒT5ç«Ÿç„¶æ¯”Claudeè¿™ç§å¤§æ¨¡å‹æ€»ç»“å¾—è¿˜è¦å¥½ï¼ŸçœŸçš„å¦‚æ­¤å—ï¼Ÿæˆ‘ä»¬ç»§ç»­çœ‹å…¶ä»–æŒ‡æ ‡ã€‚</p><h3>BERTScore è¯„ä¼°</h3><p>BERTScoreåˆ™æ˜¯å¦ä¸€ç§è¯„ä¼°æ–¹æ³•ï¼Œå®ƒé€šè¿‡è®¡ç®—ç”Ÿæˆçš„æ‘˜è¦å’Œå‚è€ƒæ‘˜è¦çš„BERTåµŒå…¥è¡¨ç¤ºä¹‹é—´çš„ç›¸ä¼¼åº¦æ¥è¯„ä¼°æ‘˜è¦çš„è´¨é‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/38/9e/38a4f580d4d88dfe40d8a6e5aedbyy9e.png?wh=1986x852\" alt=\"å›¾ç‰‡\" title=\"è¯å‘é‡ç¤ºæ„\"></p><p>ç›¸æ¯”äºROUGEï¼ŒBERTScoreåˆ©ç”¨äº†è¯å‘é‡çš„æ€æƒ³ï¼Œå› æ­¤å°±èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼åº¦ã€‚</p><pre><code class=\"language-plain\">from bert_score import BERTScorer\n\n# BERTScoreè¯„ä¼°\nscorer = BERTScorer(lang=\"en\")\nP1, R1, F1_1 = scorer.score([eval_summary_1], [ref_summary])\nprint(f\"\\nSummary 1 BERTScore F1: {F1_1.tolist()[0]}\")\nprint(f\"Summary 2 BERTScore F1: {F2_2.tolist()[0]}\")\n</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">T5 Summary BERTScore F1: 0.9143788814544678\nClaude Summary BERTScore F1: 0.9115773439407349\n</code></pre><p>æˆ‘ä»¬å¾—åˆ°ç”Ÿæˆæ‘˜è¦å’Œå‚è€ƒæ‘˜è¦çš„BERTScoreåˆ†æ•°ï¼Œä»¥æ­¤æ¥è¡¡é‡å®ƒä»¬çš„è¯­ä¹‰ç›¸ä¼¼åº¦ã€‚ä»è¿™ä¸ªæŒ‡æ ‡æ¥çœ‹ï¼ŒT5å’Œå¤§æ¨¡å‹æ€»ç»“å¾—åˆ†å¾ˆç›¸ä¼¼ã€‚</p><h3>ä½¿ç”¨ Claude è¿›è¡Œè¯„ä¼°</h3><p>é™¤äº†ä½¿ç”¨ä¼ ç»Ÿçš„è¯„ä¼°æŒ‡æ ‡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨Claude/GPT-4è¿™æ ·çš„æ–°ä¸€ä»£å¤§æ¨¡å‹æ¥è¿›è¡Œæ›´å…¨é¢çš„è¯„ä¼°ã€‚å¤§æ¨¡å‹ä¸ä»…èƒ½å¤Ÿç”Ÿæˆé«˜è´¨é‡çš„æ–‡æ¡£æ€»ç»“ï¼Œè¿˜èƒ½å¤Ÿæ ¹æ®ä½ è‡ªå·±å®šåˆ¶çš„è¯„ä¼°æ ‡å‡†å¯¹æ€»ç»“è¿›è¡Œè¯„åˆ†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰å‡ ä¸ªå…³é”®çš„è¯„ä¼°æ ‡å‡†ï¼ŒåŒ…æ‹¬ç›¸å…³æ€§ã€å‡†ç¡®æ€§ã€ç®€æ´æ€§ã€è¿è´¯æ€§ã€ä¸€è‡´æ€§ã€æµç•…æ€§ç­‰ã€‚</p><p>æ¯ä¸ªæ ‡å‡†éƒ½ä¼šæœ‰å®ƒå…·ä½“çš„è¯„åˆ†è§„åˆ™ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹©å‡ ä¸ªã€‚</p><ul>\n<li>ç›¸å…³æ€§ï¼šè¯„ä¼°æ‘˜è¦æ˜¯å¦æ¶µç›–äº†åŸæ–‡ä¸­æœ€é‡è¦å’Œæ ¸å¿ƒçš„ä¿¡æ¯ã€‚</li>\n<li>å‡†ç¡®æ€§ï¼šè¯„ä¼°æ‘˜è¦ä¸­çš„ä¿¡æ¯æ˜¯å¦å‡†ç¡®åæ˜ äº†åŸæ–‡çš„å†…å®¹ï¼Œæ˜¯å¦å­˜åœ¨è¯¯å¯¼æˆ–é”™è¯¯ä¿¡æ¯ã€‚</li>\n<li>ç®€æ´æ€§ï¼šè¯„ä¼°æ‘˜è¦æ˜¯å¦åœ¨ç®€æ˜æ‰¼è¦çš„åŸºç¡€ä¸Šä¼ è¾¾äº†ä¸»è¦ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å†—é•¿æˆ–é‡å¤ã€‚</li>\n</ul><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨Claudeï¼ˆä½ å¯ä»¥é€‰æ‹©GPTæˆ–è€…å…¶ä»–å›½å†…å¤§æ¨¡å‹ï¼Œå¯¹Claudeçš„æ€»ç»“è¿›è¡Œäº¤å‰è¯„ä¼°ï¼‰è¿›è¡Œè¯„ä¼°çš„ç¤ºä¾‹ä»£ç ã€‚</p><pre><code class=\"language-plain\"># Claudeè¯„ä¼°å‡½æ•°\nimport anthropic\nimport re\ndef get_claude_score(criteria, document, summary, metric_name):\n&nbsp; &nbsp; prompt = f\"\"\"\n&nbsp; &nbsp; ä½ å°†ä¼šè¢«æä¾›ä¸€æ®µæ–‡ç« å’Œä¸€æ®µæ‘˜è¦ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ä»¥ä¸‹æ ‡å‡†å¯¹æ‘˜è¦è¿›è¡Œè¯„åˆ†ï¼ˆ1åˆ°5åˆ†ï¼‰ï¼š\n\n&nbsp; &nbsp; è¯„ä»·æ ‡å‡†ï¼š\n&nbsp; &nbsp; {criteria}\n\n&nbsp; &nbsp; ç¤ºä¾‹ï¼š\n&nbsp; &nbsp; åŸæ–‡ï¼š\n&nbsp; &nbsp; {document}\n\n&nbsp; &nbsp; æ‘˜è¦ï¼š\n&nbsp; &nbsp; {summary}\n\n&nbsp; &nbsp; è¯·ç»™å‡º{metric_name}çš„è¯„åˆ†ï¼ˆ1åˆ°5åˆ†ï¼‰ï¼š\"\"\"\n\n&nbsp; &nbsp; client = anthropic.Anthropic(api_key=os.getenv(\"ANTHROPIC_API_KEY\"))\n&nbsp; &nbsp; response = client.completions.create(\n&nbsp; &nbsp; &nbsp; &nbsp; prompt=prompt,\n&nbsp; &nbsp; &nbsp; &nbsp; stop=[\"\\n\"],\n&nbsp; &nbsp; &nbsp; &nbsp; model=\"claude-v1\",\n&nbsp; &nbsp; &nbsp; &nbsp; max_tokens=1000\n&nbsp; &nbsp; )\n&nbsp; &nbsp; result = response[\"choices\"][0][\"text\"]\n&nbsp; &nbsp; score = int(re.findall(r'\\d+', result)[0])\n&nbsp; &nbsp; return score\n\nevaluation_metrics = {\n&nbsp; &nbsp; \"ç›¸å…³æ€§\": \"ç›¸å…³æ€§(1-5) - æ‘˜è¦æ˜¯å¦æ¶µç›–äº†åŸæ–‡ä¸­æœ€é‡è¦å’Œæ ¸å¿ƒçš„ä¿¡æ¯ã€‚\",\n&nbsp; &nbsp; \"å‡†ç¡®æ€§\": \"å‡†ç¡®æ€§(1-5) - æ‘˜è¦ä¸­çš„ä¿¡æ¯æ˜¯å¦å‡†ç¡®åæ˜ äº†åŸæ–‡çš„å†…å®¹ï¼Œæ˜¯å¦å­˜åœ¨è¯¯å¯¼æˆ–é”™è¯¯ä¿¡æ¯ã€‚\",\n&nbsp; &nbsp; \"ç®€æ´æ€§\": \"ç®€æ´æ€§(1-5) - æ‘˜è¦æ˜¯å¦åœ¨ç®€æ˜æ‰¼è¦çš„åŸºç¡€ä¸Šä¼ è¾¾äº†ä¸»è¦ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å†—é•¿æˆ–é‡å¤ã€‚\",\n}\n\nsummaries = {\"T5 Summary\": t5_summary, \"Claude Summary\": claude_summary}\n\nclaude_scores = {\"Metric\": [], \"T5 Summary\": [], \"Claude Summary\": []}\n\nfor metric, criteria in evaluation_metrics.items():\n&nbsp; &nbsp; claude_scores[\"Metric\"].append(metric)\n&nbsp; &nbsp; for summ_id, summ in summaries.items():\n&nbsp; &nbsp; &nbsp; &nbsp; score = get_claude_score(criteria, ref_summary, summ, metric)\n&nbsp; &nbsp; &nbsp; &nbsp; claude_scores[summ_id].append(score)\n\nimport pandas as pd\nclaude_df = pd.DataFrame(claude_scores).set_index(\"Metric\")\nprint(\"\\nClaude Evaluation Scores:\")\nprint(claude_df)\n</code></pre><p>ClaudeåŸºäºå¯¹åŸæ–‡å’Œæ‘˜è¦çš„æ·±åº¦ç†è§£ï¼Œä»å¤šä¸ªè§’åº¦å¯¹æ‘˜è¦è´¨é‡åšå‡ºäº†åˆ¤æ–­ã€‚</p><pre><code class=\"language-plain\">Claude Evaluation Scores:\n&nbsp; &nbsp; &nbsp; &nbsp; T5 Summary&nbsp; Claude Summary\nMetric\nç›¸å…³æ€§&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5\nå‡†ç¡®æ€§&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4\nç®€æ´æ€§&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4\n</code></pre><p>æ­¤æ—¶ï¼Œç»ˆäºï¼ŒClaudeè¿™ç§æ–°ä¸€ä»£å¤§æ¨¡å‹çš„æ€»ç»“èƒ½åŠ›ï¼Œåœ¨è¯„ä¼°æŒ‡æ ‡ä¸Šè¶…è¶Šäº†T5ã€‚å¯è§ï¼Œè¿™ç§å…¨æ–¹ä½çš„è¯„ä¼°æ›´æ¥è¿‘äºæˆ‘ä»¬äººç±»çš„è¯„ä¼°æ°´å‡†ï¼Œè¿™å°±æœ‰åŠ©äºæˆ‘ä»¬ä¼˜åŒ–æ‘˜è¦æ¨¡å‹ï¼Œç”Ÿæˆæ›´é«˜è´¨é‡çš„æ‘˜è¦ã€‚</p><p>ä»¥ä¸Šï¼Œå°±æ˜¯å‡ ç§å¸¸ç”¨çš„æ–‡æ¡£æ€»ç»“è¯„ä¼°æ–¹å¼ã€‚è¿™äº›è¯„ä¼°æ–¹æ³•ï¼Œå¯¹å…¶ä»–NLPä»»åŠ¡ï¼Œæ¯”å¦‚æœºå™¨ç¿»è¯‘ã€å¥å­é…å¯¹ç­‰ç­‰ï¼Œäº¦æœ‰å¯å‘ã€‚ç»¼åˆåˆ©ç”¨è¿™äº›è¯„ä¼°æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°äº†è§£æ–‡æ¡£æ€»ç»“çš„æ•ˆæœï¼Œå¹¶è¿›ä¸€æ­¥ä¼˜åŒ–æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>ä»Šå¤©ï¼Œæˆ‘ä»¬æ¢è®¨äº†å¦‚ä½•åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹å®ç°æ™ºèƒ½åŒ–çš„æ–‡æ¡£æ€»ç»“ä¸è¯„ä¼°ã€‚æˆ‘ä»‹ç»äº†å¤§æ¨¡å‹æ–‡æ¡£æ€»ç»“çš„ç†è®ºåŸºç¡€ï¼Œå±•ç¤ºäº†ä½¿ç”¨Claudeç”Ÿæˆå’Œè¯„ä¼°æ‘˜è¦çš„å®æˆ˜ç¤ºä¾‹ï¼Œå¦‚æœä½ æ²¡æœ‰Claude APIï¼Œä½ å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–å¤§æ¨¡å‹æ¥å°è¯•åšç›¸åŒçš„å·¥ä½œã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯ç”Ÿæˆæ‘˜è¦ï¼Œè¿˜æ˜¯è¯„ä¼°æ‘˜è¦ï¼ŒPromptè®¾è®¡åœ¨å¼•å¯¼æ¨¡å‹å®Œæˆç‰¹å®šä»»åŠ¡ä¸­è‡³å…³é‡è¦ã€‚</p><p>å¾—ç›Šäºå¤§æ¨¡å‹å¼ºå¤§çš„è¯­è¨€ç†è§£å’Œç”Ÿæˆèƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°é«˜è´¨é‡çš„æ‘˜è¦ç”Ÿæˆï¼Œå¹¶å¯¹æ‘˜è¦è¿›è¡Œå…¨é¢ã€å®¢è§‚çš„è¯„ä¼°ã€‚ä¼ ç»Ÿçš„åŸºäºçœŸå€¼çš„è¯„ä¼°æ–¹æ³•ï¼ˆå¦‚ROUGEå’ŒBERTScoreï¼‰å¯ä»¥æä¾›ä¸€å®šçš„é‡åŒ–æŒ‡æ ‡ï¼Œè€Œæ–°ä¸€ä»£çš„å¤§æ¨¡å‹ï¼ˆå¦‚Claudeï¼‰åˆ™å¯ä»¥æä¾›æ›´ä¸°å¯Œå’Œæ·±å…¥çš„è¯„ä¼°ä¿¡æ¯ã€‚</p><p>æœªæ¥ï¼Œéšç€å¤§è¯­è¨€æ¨¡å‹çš„è¿›ä¸€æ­¥å‘å±•ï¼Œå…¶åœ¨æ–‡æ¡£æ€»ç»“é¢†åŸŸçš„åº”ç”¨å°†æ›´åŠ å¹¿æ³›å’Œæ·±å…¥ã€‚ç»“åˆçŸ¥è¯†å›¾è°±ã€å¤šæ¨¡æ€ç­‰æŠ€æœ¯ï¼Œèƒ½å®ç°æ›´åŠ æ™ºèƒ½ã€ä¸ªæ€§åŒ–çš„æ‘˜è¦æœåŠ¡ã€‚åŒæ—¶ï¼Œå¯¹è¯å¼æ‘˜è¦ã€å¢é‡å¼æ‘˜è¦ç­‰æ–°å‹äº¤äº’å’Œä¼˜åŒ–èŒƒå¼å€¼å¾—å…³æ³¨å’Œæ¢ç´¢ã€‚</p><h2>æ€è€ƒé¢˜</h2><ol>\n<li>\n<p>æ–°ä¸€ä»£å¤§æ¨¡å‹çš„æ€»ç»“æ¯”æ—§çš„è¯­è¨€æ¨¡å‹æ€»ç»“èƒ½åŠ›å¼ºï¼Œè¿™æ˜¯æ¯«æ— ç–‘é—®çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬çš„è¯„ä¼°ç»“æœä¸­ï¼Œä¼¼ä¹æ˜¯T5æ€»ç»“å¾—æ›´å¥½? ä»ROUGEä¸Šçœ‹ï¼Œå°¤å…¶å¦‚æ­¤ã€‚è¿™å…¶å®æ˜¯æœ‰åŸå› çš„ï¼Œä½ èƒ½æ‰¾å‡ºå…³é”®åŸå› ä¹ˆï¼Ÿ</p>\n</li>\n<li>\n<p>å¦‚ä½•æ‹“å±•å¤§è¯­è¨€æ¨¡å‹æ‘˜è¦è¯„ä¼°çš„ç»´åº¦? æ¯”å¦‚ï¼Œä½ å¯ä»¥ç»“åˆä¸“å®¶çŸ¥è¯†ï¼Œè®¾è®¡å‡ºæ›´åŠ å…¨é¢ã€æ›´ç»†ç²’åº¦çš„è¯„ä¼°æŒ‡æ ‡å’Œè¯„ä¼°æç¤ºè¯ã€‚</p>\n</li>\n<li>\n<p>é™¤äº†å­¦æœ¯è®ºæ–‡ï¼Œå¤§è¯­è¨€æ¨¡å‹Claudeå½“ç„¶è¿˜å¯ä»¥åº”ç”¨äºå¤šç§æ–‡æ¡£æ€»ç»“ä»»åŠ¡ï¼Œå¦‚æ–°é—»ã€è´¢æŠ¥ã€åŒ»ç–—ç—…å†ï¼Œè¯·ä½ åŸºäºæ‰‹å¤´çš„ä¸šåŠ¡æ•°æ®å°è¯•ä¸€ä¸‹ï¼å°¤å…¶æ˜¯æ€è€ƒçœŸå€¼å¦‚ä½•è·å–ã€‚</p>\n</li>\n</ol><p>æœŸå¾…ä½ çš„åˆ†äº«ï¼Œæ¬¢è¿ä¸æˆ‘äº¤æµã€‚å¦‚æœä»Šå¤©çš„å†…å®¹è®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾è½¬å‘ç»™æœ‰éœ€è¦çš„æœ‹å‹ï¼æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"10ï½œé€šè¿‡Embeddingæ„å»ºåŸºäºå…³é”®è¯çš„æ¨èç³»ç»Ÿ","id":781915},"right":{"article_title":"12ï½œç”¨Assistantsè‡ªä¸»æ€è€ƒç”Ÿæˆå•†ä¸šæŠ¥å‘ŠPPT","id":783123}},"comments":[]}