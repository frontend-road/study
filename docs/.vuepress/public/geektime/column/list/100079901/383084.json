{"id":383084,"title":"08ï½œå¤æ‚çŠ¶æ€å¤„ç†ï¼šå¦‚ä½•ä¿è¯çŠ¶æ€ä¸€è‡´æ€§ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹æ²›ã€‚ä»Šå¤©æˆ‘ä»¬èŠèŠ React ä¸­çš„çŠ¶æ€ç®¡ç†ã€‚</p><p>ä»è¿™èŠ‚è¯¾å¼€å§‹ï¼Œæˆ‘ä»¬å°±è¿›å…¥åˆ°äº†å®æˆ˜ç¯‡çš„è®­ç»ƒã€‚React Hooks ä¸­å…¶å®æœ‰ä¸€äº›é€šç”¨åŸåˆ™å’Œå¸¸è§è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘è®¾è®¡äº†å‡ ä¸ªå…¸å‹çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å¯¹è¿™äº›åŸåˆ™å’Œæ¨¡å¼æœ‰ä¸€ä¸ªå…·ä½“çš„å°è±¡ï¼Œä¹‹ååœ¨é‡åˆ°ç±»ä¼¼åœºæ™¯æ—¶ï¼Œä¹Ÿèƒ½ä»å®¹åº”å¯¹ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å…ˆä»çŠ¶æ€ä¸€è‡´æ€§è¿™ä¸ªéœ€æ±‚å¼€å§‹è®²èµ·ã€‚æˆ‘åœ¨åŸºç¡€ç¯‡å°±åå¤æåˆ°è¿‡ï¼ŒReact ä¸­ UI å®Œå…¨æ˜¯é€šè¿‡çŠ¶æ€é©±åŠ¨çš„ã€‚æ‰€ä»¥åœ¨ä»»ä½•æ—¶åˆ»ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€æ•°æ®å°±å®Œå…¨å†³å®šäº†å½“å‰ UI ä¸Šçš„å±•ç°ã€‚æ¯«ä¸å¤¸å¼ åœ°è¯´ï¼ŒReact çš„å¼€å‘å…¶å®å°±æ˜¯å¤æ‚åº”ç”¨ç¨‹åºçŠ¶æ€çš„ç®¡ç†å’Œå¼€å‘ã€‚å› æ­¤ï¼Œè¿™å°±éœ€è¦ä½ å»ä»”ç»†æ€è€ƒï¼Œ<strong>è¯¥æ€ä¹ˆå»ç”¨æœ€ä¼˜ã€æœ€åˆç†çš„æ–¹å¼ï¼Œå»ç®¡ç†ä½ çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚</strong></p><p>æ‰€ä»¥ä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä¼šå¸¦ä½ å›´ç»•çŠ¶æ€ä¸€è‡´æ€§è¿™ä¸ªéœ€æ±‚ï¼Œä»‹ç»ä¸¤ä¸ªåŸºæœ¬åŸåˆ™ï¼Œå®ƒä»¬èƒ½å¸®åŠ©æˆ‘ä»¬é¿å…å¾ˆå¤šå¤æ‚çš„çŠ¶æ€ç®¡ç†é€»è¾‘ï¼Œç®€åŒ–åº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚</p><h1>åŸåˆ™ä¸€ï¼šä¿è¯çŠ¶æ€æœ€å°åŒ–</h1><p>æ–°æ¥è§¦ React çš„åŒå­¦ç»å¸¸ä¼šæœ‰ä¸€ä¸ªé”™è¯¯çš„ä¹ æƒ¯ï¼Œå°±æ˜¯æŠŠ State å½“å˜é‡ç”¨ï¼Œå¾ˆå®¹æ˜“æŠŠè¿‡å¤šçš„æ•°æ®æ”¾åˆ° State é‡Œï¼Œå¯ä»¥è¯´è¿™æ˜¯å¯¹ State çš„ä¸€ç§æ»¥ç”¨ã€‚</p><p>é‚£åˆ°åº•è¯¥æ€ä¹ˆä½¿ç”¨ State å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦éµå¾ªä¸€ä¸ªåŸåˆ™ï¼Œå³ï¼š<strong>åœ¨ä¿è¯ State å®Œæ•´æ€§çš„åŒæ—¶ï¼Œä¹Ÿè¦ä¿è¯å®ƒçš„æœ€å°åŒ–ã€‚</strong>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><p>å°±æ˜¯è¯´ï¼ŒæŸäº›æ•°æ®å¦‚æœèƒ½ä»å·²æœ‰çš„ State ä¸­è®¡ç®—å¾—åˆ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å§‹ç»ˆåœ¨ç”¨çš„æ—¶å€™å»è®¡ç®—ï¼Œè€Œä¸è¦æŠŠè®¡ç®—çš„ç»“æœå­˜åˆ°æŸä¸ª State ä¸­ã€‚è¿™æ ·çš„è¯ï¼Œæ‰èƒ½ç®€åŒ–æˆ‘ä»¬çš„çŠ¶æ€å¤„ç†é€»è¾‘ã€‚</p><!-- [[[read_end]]] --><p>ä¸¾ä¸ªä¾‹å­ã€‚ä½ è¦åšä¸€ä¸ªåŠŸèƒ½ï¼Œéœ€è¦å¯¹ä¸€ä¸ªåˆ—è¡¨çš„ç»“æœè¿›è¡Œå…³é”®å­—æœç´¢ï¼Œæˆ‘ä»¬å‡è®¾æ˜¯ä¸€ä¸ªæ˜¾ç¤ºç”µå½±æ ‡é¢˜çš„åˆ—è¡¨ï¼Œéœ€è¦èƒ½å¤Ÿå¯¹æ ‡é¢˜è¿›è¡Œæœç´¢ã€‚æœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/80/10/80eb70a42a50b47a131f5af57130d210.png?wh=678*532\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªåŠŸèƒ½åŒ…æ‹¬ä¸€ä¸ªæœç´¢æ¡†å’Œä¸€ä¸ªç”µå½±æ ‡é¢˜çš„åˆ—è¡¨ã€‚é‚£ä¹ˆï¼Œåœ¨è€ƒè™‘æ€ä¹ˆå®ç°è¿™ä¸ªåŠŸèƒ½çš„æ—¶å€™ï¼Œåº”è¯¥ä»å“ªé‡Œç€æ‰‹å‘¢ï¼Ÿ</p><p>æŒ‰ç…§ React çš„çŠ¶æ€é©±åŠ¨ UI çš„æ€æƒ³ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯<strong>è¦è€ƒè™‘æ•´ä¸ªåŠŸèƒ½æœ‰å“ªå‡ ä¸ªçŠ¶æ€</strong>ã€‚ç›´è§‚ä¸Šæ¥è¯´ï¼Œé¡µé¢å¯èƒ½åŒ…å«ä¸‰ä¸ªçŠ¶æ€ï¼š</p><ol>\n<li>ç”µå½±åˆ—è¡¨çš„æ•°æ®ï¼šå¯èƒ½æ¥è‡ªæŸä¸ª API è¯·æ±‚ï¼›</li>\n<li>ç”¨æˆ·è¾“å…¥çš„å…³é”®å­—ï¼šæ¥è‡ªç”¨æˆ·çš„è¾“å…¥ï¼›</li>\n<li>æœç´¢çš„ç»“æœæ•°æ®ï¼šæ¥è‡ªåŸå§‹æ•°æ®ç»“åˆå…³é”®å­—çš„è¿‡æ»¤ç»“æœã€‚</li>\n</ol><p>é‚£ä¹ˆå¾ˆå¤šåŒå­¦è¿™æ—¶å€™å°±ä¼šåœ¨ç»„ä»¶ä¸­å»å®šä¹‰è¿™ä¸‰ä¸ªçŠ¶æ€ï¼Œä¸€èˆ¬çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>function FilterList({ data }) {\n  // è®¾ç½®å…³é”®å­—çš„ State\n  const [searchKey, setSearchKey] = useState('');\n  // è®¾ç½®æœ€ç»ˆè¦å±•ç¤ºçš„æ•°æ®çŠ¶æ€ï¼Œå¹¶ç”¨åŸå§‹æ•°æ®ä½œä¸ºåˆå§‹å€¼\n  const [filtered, setFiltered] = useState(data);\n\n  // å¤„ç†ç”¨æˆ·çš„æœç´¢å…³é”®å­—\n  const handleSearch = useCallback(evt =&gt; {\n    setSearchKey(evt.target.value);\n    setFiltered(data.filter(item =&gt; {\n      return item.title.includes(evt.target.value)));\n    }));\n  }, [filtered])\n  return (\n    &lt;div&gt;\n      &lt;input value={searchKey} onChange={handleSearch} /&gt;\n      {/* æ ¹æ® filtered æ•°æ®æ¸²æŸ“ UI */}\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>çœ‹ä¸Šå»æ²¡æœ‰å¤ªå¤§é—®é¢˜ï¼Œæ•´æ®µä»£ç ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯å¦‚æœä»”ç»†æ€è€ƒï¼Œä½ ä¼šå‘ç°å…¶ä¸­éšè—çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼šå±•ç¤ºçš„ç»“æœæ•°æ®å®Œå…¨ç”±åŸå§‹æ•°æ®å’Œå…³é”®å­—å†³å®šï¼Œè€Œç°åœ¨å´ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„çŠ¶æ€å»ç»´æŠ¤äº†ã€‚è¿™æ„å‘³ç€ä½ å§‹ç»ˆè¦åœ¨åŸå§‹æ•°æ®ã€å…³é”®å­—å’Œç»“æœæ•°æ®ä¹‹é—´ä¿è¯ä¸€è‡´æ€§ã€‚</p><p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»åšäº†ä¸€éƒ¨åˆ†ç»´æŠ¤ä¸€è‡´æ€§çš„å·¥ä½œï¼Œé‚£å°±æ˜¯å½“å…³é”®å­—å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬ä¼šåŒæ—¶æ›´æ–°å…³é”®å­—å’Œæœ€ç»ˆç»“æœè¿™ä¸¤ä¸ªçŠ¶æ€ï¼Œä»è€Œè®©è¿™ä¸¤ä¸ªçŠ¶æ€å§‹ç»ˆä¿æŒä¸€è‡´ã€‚</p><p>ä¸è¿‡è¿˜æœ‰éƒ¨åˆ†ä¸€è‡´æ€§çš„å·¥ä½œæ²¡æœ‰è¢«è€ƒè™‘åˆ°ï¼Œé‚£å°±æ˜¯å¦‚æœåŸå§‹æ•°æ® data å±æ€§å˜åŒ–äº†ï¼Œæœ€ç»ˆçš„ç»“æœå´æ²¡æœ‰ä½¿ç”¨æ–°çš„æ•°æ®ã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½ å¯èƒ½å°±åˆä¼šé—®äº†ï¼šæˆ‘åœ¨å¤„ç†å…³é”®å­—å˜åŒ–çš„åŒæ—¶ï¼Œå†å¤„ç†ä¸€ä¸‹ data å±æ€§å˜åŒ–çš„åœºæ™¯ï¼Œè¿™æ ·ä¸å°±å¯ä»¥ä¿è¯ä¸‰ä¸ªçŠ¶æ€çš„ä¸€è‡´æ€§äº†å—ï¼Ÿæ¯”å¦‚å†åŠ ä¸Šä¸‹é¢è¿™æ®µä»£ç ã€‚</p><pre><code>function FilterList({ data }) {\n  // ...\n  // åœ¨ data å˜åŒ–çš„æ—¶å€™ï¼Œä¹Ÿé‡æ–°ç”Ÿæˆæœ€ç»ˆæ•°æ®\n  useEffect(() =&gt; {\n    setFiltered(data =&gt; {...})\n  }, [data, searchKey])\n  // ...\n}\n</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬ç»ˆäºèƒ½å¤Ÿä¿è¯ä¸‰ä¸ªçŠ¶æ€çš„ä¸€è‡´æ€§äº†ï¼Œæ•´ä¸ªæœç´¢åˆ—è¡¨ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œäº†ï¼ä½†æ˜¯æˆ‘ä»¬åœ¨è·å¾—ä¸€äº›æˆå°±æ„Ÿçš„åŒæ—¶ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿæœ‰ä¸€äº›å°å°çš„æŠ±æ€¨ï¼šè¿™çŠ¶æ€ç®¡ç†ç¡®å®è¿˜æŒºå¤æ‚çš„ï¼Œéœ€è¦å†™è¿™ä¹ˆå¤šçš„é€»è¾‘æ¥ä¿è¯ä¸€è‡´æ€§ï¼Œä»è€Œè®©åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘æƒ³è¯´çš„æ˜¯ï¼Œè¿™ç§å¤æ‚æ€§å…¶å®å®Œå…¨ä¸éœ€è¦ã€‚å› ä¸ºå¤æ‚æ€§çš„æ ¹æºå°±åœ¨äºæ²¡æœ‰éµå¾ªçŠ¶æ€æœ€å°åŒ–çš„åŸåˆ™ï¼Œè€Œæ˜¯è®¾è®¡äº†ä¸€ä¸ªå¤šä½™çš„çŠ¶æ€ï¼š<strong>è¿‡æ»¤åçš„ç»“æœæ•°æ®</strong>ã€‚ç”±äºè¿™ä¸ªç»“æœæ•°æ®å®é™…ä¸Šå®Œå…¨ç”±åŸå§‹æ•°æ®å’Œè¿‡æ»¤å…³é”®å­—å†³å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨éœ€è¦çš„æ—¶å€™æ¯æ¬¡é‡æ–°è®¡ç®—å¾—å‡ºå°±å¯ä»¥äº†ã€‚</p><p>é‚£æ—¶å€™ä½ å¯èƒ½åˆæœ‰ç–‘é—®äº†ï¼Œå¦‚æœæ¯æ¬¡éƒ½è®¡ç®—ï¼Œä¸æ˜¯ä¼šæœ‰æ€§èƒ½é—®é¢˜å—ï¼Ÿå…¶å®åœ¨ç¬¬4è®²æˆ‘å·²ç»æåˆ°ï¼ŒReact æä¾›çš„ useMemo è¿™ä¸ª Hook æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç¼“å­˜è®¡ç®—çš„ç»“æœã€‚æ‰€ä»¥å®ç°çš„ä»£ç å¯ä»¥ä¿®æ”¹å¦‚ä¸‹ï¼š</p><pre><code>import React, { useState, useMemo } from &quot;react&quot;;\n\nfunction FilterList({ data }) {\n  const [searchKey, setSearchKey] = useState(&quot;&quot;);\n  \n  // æ¯å½“ searchKey æˆ–è€… data å˜åŒ–çš„æ—¶å€™ï¼Œé‡æ–°è®¡ç®—æœ€ç»ˆç»“æœ\n  const filtered = useMemo(() =&gt; {\n    return data.filter((item) =&gt;\n      item.title.toLowerCase().includes(searchKey.toLowerCase())\n    );\n  }, [searchKey, data]);\n\n  return (\n    &lt;div className=&quot;08-filter-list&quot;&gt;\n      &lt;h2&gt;Movies&lt;/h2&gt;\n      &lt;input\n        value={searchKey}\n        placeholder=&quot;Search...&quot;\n        onChange={(evt) =&gt; setSearchKey(evt.target.value)}\n      /&gt;\n      &lt;ul style={{ marginTop: 20 }}&gt;\n        {filtered.map((item) =&gt; (\n          &lt;li key={item.id}&gt;{item.title}&lt;/li&gt;\n        ))}\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†é€šè¿‡å±æ€§ä¼ é€’è¿›æ¥çš„ data çŠ¶æ€ï¼Œæˆ‘ä»¬åªå®šä¹‰äº†ä¸€ä¸ª searchKey è¿™ä¸ªçŠ¶æ€ã€‚ç„¶åé€šè¿‡è®¡ç®—çš„æ–¹å¼ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€ç»ˆéœ€è¦å±•ç°çš„ç»“æœã€‚è¿™æ ·ï¼ŒçŠ¶æ€çš„ä¸€è‡´æ€§å°±å¾—åˆ°äº†å¤©ç„¶çš„ä¿è¯ã€‚ä½ çœ‹ï¼Œé€šè¿‡ä½¿ç”¨çŠ¶æ€æœ€å°åŒ–çš„åŸåˆ™ï¼Œç®¡ç†å°±å˜å¾—éå¸¸ç®€å•äº†ã€‚</p><p>è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ä¾‹å­ï¼Œä½†æ˜¯åœ¨å®é™…å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šå¤æ‚åœºæ™¯ä¹‹æ‰€ä»¥å˜å¾—å¤æ‚ï¼Œå¦‚æœæŠ½ä¸å‰¥èŒ§æ¥çœ‹ï¼Œä½ ä¼šå‘ç°å®ƒä»¬éƒ½æœ‰<strong>å®šä¹‰å¤šä½™çŠ¶æ€ç°è±¡</strong>çš„å½±å­ï¼Œè€Œé—®é¢˜çš„æ ¹æºå°±åœ¨äº<strong>å®ƒä»¬æ²¡æœ‰éµå¾ªçŠ¶æ€æœ€å°åŒ–çš„åŸåˆ™</strong>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨å®šä¹‰ä¸€ä¸ªæ–°çš„çŠ¶æ€ä¹‹å‰ï¼Œéƒ½è¦å†ä¸‰æ‹·é—®è‡ªå·±ï¼š<strong>è¿™ä¸ªçŠ¶æ€æ˜¯å¿…é¡»çš„å—ï¼Ÿæ˜¯å¦èƒ½é€šè¿‡è®¡ç®—å¾—åˆ°å‘¢ï¼Ÿ</strong>åœ¨å¾—åˆ°è‚¯å®šçš„å›ç­”åï¼Œæˆ‘ä»¬å†å»å®šä¹‰æ–°çš„çŠ¶æ€ï¼Œå°±èƒ½é¿å…å¤§éƒ¨åˆ†å¤šä½™çš„çŠ¶æ€å®šä¹‰é—®é¢˜äº†ï¼Œä¹Ÿå°±èƒ½åœ¨ç®€åŒ–çŠ¶æ€ç®¡ç†çš„åŒæ—¶ï¼Œä¿è¯çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p><h1>åŸåˆ™äºŒï¼šé¿å…ä¸­é—´çŠ¶æ€ï¼Œç¡®ä¿å”¯ä¸€æ•°æ®æº</h1><p>ä¸Šé¢çš„ä¾‹å­å…¶å®å®šä¹‰çš„å¤šä½™çŠ¶æ€æ¯”è¾ƒæ˜æ˜¾ï¼Œä½†åœ¨æœ‰çš„åœºæ™¯ä¸‹ï¼Œç‰¹åˆ«æ˜¯åŸå§‹çŠ¶æ€æ•°æ®æ¥è‡ªæŸä¸ªå¤–éƒ¨æ•°æ®æºï¼Œè€Œé state æˆ–è€… props çš„æ—¶å€™ï¼Œå†—ä½™çŠ¶æ€å°±æ²¡é‚£ä¹ˆæ˜æ˜¾ã€‚è¿™æ—¶å€™ä½ å°±éœ€è¦å‡†ç¡®å®šä½çŠ¶æ€çš„æ•°æ®æºç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”åœ¨å¼€å‘ä¸­ç¡®ä¿å®ƒå§‹ç»ˆæ˜¯å”¯ä¸€çš„æ•°æ®æºï¼Œä»¥æ­¤é¿å…å®šä¹‰ä¸­é—´çŠ¶æ€ã€‚</p><p>è¿˜æ˜¯æ‹¿åˆšæ‰è®²çš„å¯æœç´¢ç”µå½±åˆ—è¡¨çš„ä¾‹å­æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·ä½“éªŒä¸Šåšä¸€ä¸ªæ”¹è¿›ï¼Œè¦è®©æœç´¢çš„ç»“æœåšåˆ°å¯åˆ†äº«ã€‚è¿™ä¸ªåŠŸèƒ½å°±ç±»ä¼¼ Baidu è¿™æ ·çš„æœç´¢å¼•æ“ï¼Œé€šè¿‡ä¸€ä¸ªé“¾æ¥å°±èƒ½åˆ†äº«æœç´¢ç»“æœã€‚æ¯”å¦‚è¯´ï¼Œä½ é€šè¿‡â€œ<a href=\"http://www.baidu.com/s?wd=%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4\">http://www.baidu.com/s?wd=æå®¢æ—¶é—´</a>â€å°±å¯ä»¥çœ‹åˆ°æå®¢æ—¶é—´çš„æœç´¢ç»“æœã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœç´¢å¼•æ“æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œé‚£ä½¿ç”¨èµ·æ¥ä¼šæœ‰å¤šä¹ˆä¸æ–¹ä¾¿ã€‚æ¯æ¬¡è¦åˆ†äº«ä¸€ä¸ªæœç´¢ç»“æœï¼Œéƒ½å¿…é¡»å‘Šè¯‰åˆ«äººå…³é”®å­—æ˜¯ä»€ä¹ˆï¼Œè®©ä»–/å¥¹è‡ªå·±æ‰“å¼€ Baidu å»æœç´¢ã€‚æ‰€ä»¥å°†å…³é”®å­—æ”¾åˆ° URL ä¸­ä¹Ÿæ˜¯å®é™…å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªéœ€æ±‚ã€‚</p><p>é‚£ä¹ˆè¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±éœ€è¦è®© URL ä¸­åŒ…å«æœç´¢å…³é”®å­—çš„ä¿¡æ¯ï¼Œè¿™æ ·ä»»ä½•äººç”¨è¿™ä¸ª URL ï¼Œå°±éƒ½èƒ½çœ‹åˆ°å’Œæˆ‘ä¸€æ ·çš„æœç´¢å…³é”®å­—å’Œç»“æœäº†ã€‚</p><p>åœ¨è€ƒè™‘è¿™ä¸ªåŠŸèƒ½å®ç°ï¼Œå°¤å…¶æ˜¯åŸºäºå·²æœ‰åŠŸèƒ½åšæ”¹è¿›çš„æ—¶å€™ï¼Œé€šå¸¸æ¥è¯´ï¼Œç›´è§‚çš„æ€è·¯éƒ½æ˜¯ï¼šé¦–å…ˆæŠŠ URL ä¸Šçš„å‚æ•°æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ª State ä¸­ï¼Œå½“URL å˜åŒ–æ—¶ï¼Œå°±å»æ”¹å˜è¿™ä¸ª Stateã€‚ç„¶ååœ¨ç»„ä»¶ä¸­å†æ ¹æ®è¿™ä¸ª State æ¥å®ç°æœç´¢çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥æ”¹è¿›ç”µå½±åˆ—è¡¨çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç±»ä¼¼ä¸‹é¢çš„ä»£ç æ¥å®ç°ï¼š</p><pre><code>// getQuery å‡½æ•°ç”¨æˆ·è·å– URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²\nimport getQuery from './getQuery';\n// history å·¥å…·å¯ä»¥ç”¨äºæ”¹å˜æµè§ˆå™¨åœ°å€\nimport history from './history';\n\nfunction SearchBox({ data }) {\n  // å®šä¹‰å…³é”®å­—è¿™ä¸ªçŠ¶æ€ï¼Œç”¨ URL ä¸Šçš„æŸ¥è¯¢å‚æ•°ä½œä¸ºåˆå§‹å€¼\n  const [searchKey, setSearchKey] = useState(getQuery('key'));\n  // å¤„ç†ç”¨æˆ·è¾“å…¥çš„å…³é”®å­—\n  const handleSearchChange = useCallback(evt =&gt; {\n    const key = evt.target.value;\n    // è®¾ç½®å½“å‰çš„æŸ¥è¯¢å…³é”®çŠ¶æ€\n    setSearchKey(key);\n    // æ”¹å˜ URL çš„æŸ¥è¯¢å‚æ•°\n    history.push(`/movie-list?key=${key}`);\n  })\n  // ....\n  return (\n    &lt;div className=&quot;08-search-box&quot;&gt;\n      &lt;input\n        value={searchKey}\n        placeholder=&quot;Search...&quot;\n        onChange={handleSearchChange}\n      /&gt;\n      {/* å…¶å®ƒæ¸²æŸ“é€»è¾‘*/}\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œç»„ä»¶çš„æ ¸å¿ƒé€»è¾‘åŸºæœ¬æ²¡å˜ï¼Œåªæ˜¯åšäº†ä¸¤ä¸ªå°çš„å˜åŒ–ï¼š</p><ol>\n<li>æŠŠ URL ä¸Šçš„æŸ¥è¯¢å‚æ•°ä½œä¸ºå…³é”®å­—çš„é»˜è®¤å€¼ï¼›</li>\n<li>å½“ç”¨æˆ·è¾“å…¥æœç´¢å…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬ä¸ä½†æ›´æ–°äº†å†…éƒ¨ Stateï¼ŒåŒæ—¶è¿˜æ”¹å˜äº† URL çš„æŸ¥è¯¢å‚æ•°ã€‚</li>\n</ol><p>é€šè¿‡è¿™ä¸¤ä¸ªå°çš„å˜åŒ–ï¼Œæˆ‘ä»¬å°±å®ç°äº†æœç´¢ç»“æœçš„å¯åˆ†äº«ã€‚çœ‹ä¸Šå»ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼šä¿è¯äº†å…³é”®å­—çŠ¶æ€ï¼Œè¿˜æœ‰ URL å‚æ•°çš„ä¸€è‡´æ€§ã€‚ä½†æ˜¯æ­£å¦‚æˆ‘åˆšæ‰å¼ºè°ƒçš„ï¼Œä¸€æ—¦æ¶‰åŠåˆ°ä¸»åŠ¨ä¿æŒä¸€è‡´æ€§çš„é€»è¾‘ï¼Œæˆ‘ä»¬å°±è¦è€ƒè™‘çŠ¶æ€æ˜¯å¦çœŸçš„æœ‰å¿…è¦ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å†ä»”ç»†æ€è€ƒä¸‹ï¼Œå°±ä¼šå‘ç°ä¸Šé¢çš„é€»è¾‘æ˜¯æœ‰æ¼æ´çš„ã€‚å› ä¸ºä» URL å‚æ•°åˆ°å†…éƒ¨ State çš„åŒæ­¥åªæœ‰ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“æ‰ä¼šå‘ç”Ÿï¼Œè€Œåé¢çš„åŒæ­¥åˆ™æ˜¯ç”±è¾“å…¥æ¡†çš„ onChange äº‹ä»¶ä¿è¯çš„ï¼Œé‚£ä¹ˆä¸€è‡´æ€§å°±å¾ˆå®¹æ˜“è¢«ç ´åã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ URL ä¸æ˜¯ç”±ç”¨æˆ·åœ¨ç»„ä»¶å†…æœç´¢æ å»æ”¹å˜çš„ï¼Œè€Œæ˜¯å…¶å®ƒåœ°æ–¹ï¼Œæ¯”å¦‚è¯´ç»„ä»¶å¤–çš„æŸä¸ªæŒ‰é’®å»è§¦å‘æ”¹å˜çš„ï¼Œé‚£ä¹ˆç»„ä»¶ç”±äºå·²ç»æ¸²æŸ“è¿‡äº†ï¼Œå…¶å®å†…éƒ¨çš„ searchKey è¿™ä¸ª State æ˜¯ä¸ä¼šè¢«æ›´æ–°çš„ï¼Œä¸€è‡´æ€§å°±ä¼šè¢«ç ´åã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°çš„æ€è·¯å°±æ˜¯<strong>æˆ‘ä»¬è¦æœ‰æ›´åŠ å®Œå–„çš„æœºåˆ¶ï¼Œè®©åœ¨ URL ä¸ç®¡å› ä¸ºä»€ä¹ˆåŸå› è€Œå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œéƒ½èƒ½åŒæ­¥æŸ¥è¯¢å‚æ•°åˆ° searchKey è¿™ä¸ª State</strong>ã€‚ä½†æ˜¯å¦‚æœæ²¿ç€è¿™ä¸ªæ€è·¯ï¼Œé‚£ä¹ˆçŠ¶æ€ç®¡ç†å°±ä¼šä¸€ä¸‹å­å˜å¾—éå¸¸å¤æ‚ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸‰ä¸ªçŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p><p>å…¶å®ï¼Œä»æ ¹æºä¸Šæ¥è¯´ï¼Œäº§ç”Ÿè¿™ä¸ªå¤æ‚åº¦çš„é—®é¢˜åœ¨äºæˆ‘ä»¬å®šä¹‰äº† searchKey è¿™æ ·ä¸€ä¸ªå¤šä½™çš„ä¸­é—´çŠ¶æ€ï¼Œè€Œä¸”è¿™ä¸ª searchKey çŠ¶æ€æ¥æºäºä¸¤ä¸ªæ•°æ®æºï¼šä¸€æ˜¯ç”¨æˆ·è¾“å…¥ï¼›äºŒæ˜¯ URL ä¸Šçš„å‚æ•°ã€‚è¿™å°±å¯¼è‡´é€»è¾‘éå¸¸å¤æ‚ã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬éµå¾ªå”¯ä¸€æ•°æ®æºè¿™ä¸ªåŸåˆ™ï¼ŒæŠŠ URL ä¸Šçš„æŸ¥è¯¢å…³é”®å­—ä½œä¸ºå”¯ä¸€æ•°æ®æºï¼Œé€»è¾‘å°±ä¼šå˜å¾—ç®€å•äº†ï¼šåªéœ€è¦åœ¨ç”¨æˆ·è¾“å…¥æŸ¥è¯¢å…³é”®å­—æ—¶ï¼Œç›´æ¥å»æ”¹å˜ URL ä¸Šçš„æŸ¥è¯¢å­—ç¬¦ä¸²å°±è¡Œã€‚è¿™ä¸ªè½¬å˜å¯ä»¥ç”¨ä¸‹é¢çš„å›¾åšä¸€ä¸ªå¯¹æ¯”ï¼Œä½ ä¼šæ›´ç›´è§‚åœ°ç†è§£ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/9f/de/9f534fa5235d0a45cafec91cbfa9e4de.png?wh=1462*572\" alt=\"\"></p><p>é€šè¿‡å¯¹æ¯”å¯ä»¥çœ‹åˆ°ï¼Œå·¦è¾¹å¼•å…¥äº†ä¸€ä¸ªå¤šä½™çš„ State ä½œä¸ºå…³é”®å­—è¿™ä¸ªçŠ¶æ€ï¼Œè€Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œå°±éœ€è¦å¾ˆå¤šå¤æ‚çš„åŒæ­¥é€»è¾‘ï¼Œæ¯”å¦‚è¯´ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul>\n<li>URL å˜åŒ–æ—¶ï¼ŒåŒæ­¥æŸ¥è¯¢å…³é”®å­—åˆ° Stateï¼›</li>\n<li>State å˜åŒ–æ—¶ï¼ŒåŒæ­¥æŸ¥è¯¢å…³é”®å­—åˆ°è¾“å…¥æ¡†ï¼›</li>\n<li>ç”¨æˆ·åœ¨è¾“å…¥æ¡†è¾“å…¥çš„æ—¶å€™ï¼ŒåŒæ­¥å…³é”®å­—åˆ° URL å’Œ Stateã€‚</li>\n</ul><p>ä½†æ˜¯ï¼Œåœ¨å»æ‰å¤šä½™çš„ State åï¼Œæˆ‘ä»¬å°±åªéœ€è¦åœ¨è¾“å…¥æ¡†å’Œ URL çš„æŸ¥è¯¢å‚æ•°ä¹‹é—´åšä¸€ä¸ªåŒæ­¥ã€‚é‚£ä¹ˆå®ç°çš„ä»£ç å¯ä»¥ç®€åŒ–å¦‚ä¸‹ï¼š</p><pre><code>import React, { useCallback, useMemo } from &quot;react&quot;;\nimport { useSearchParam } from &quot;react-use&quot;;\n\nfunction SearchBox({ data }) {\n  // ä½¿ç”¨ useSearchParam è¿™ä¸ª Hook ç”¨äºç›‘å¬æŸ¥è¯¢å‚æ•°å˜åŒ–\n  const searchKey = useSearchParam(&quot;key&quot;) || &quot;&quot;;\n  const filtered = useMemo(() =&gt; {\n    return data.filter((item) =&gt;\n      item.title.toLowerCase().includes(searchKey.toLowerCase())\n    );\n  }, [searchKey, data]);\n\n  const handleSearch = useCallback((evt) =&gt; {\n    // å½“ç”¨æˆ·è¾“å…¥æ—¶ï¼Œç›´æ¥æ”¹å˜ URL\n    window.history.pushState(\n      {},\n      &quot;&quot;,\n      `${window.location.pathname}?key=${evt.target.value}`\n    );\n  }, []);\n  return (\n    &lt;div className=&quot;08-filter-list&quot;&gt;\n      &lt;h2&gt;Movies (Search key from URL)&lt;/h2&gt;\n      &lt;input\n        value={searchKey}\n        placeholder=&quot;Search...&quot;\n        onChange={handleSearch}\n      /&gt;\n      &lt;ul style={{ marginTop: 20 }}&gt;\n        {filtered.map((item) =&gt; (\n          &lt;li key={item.id}&gt;{item.title}&lt;/li&gt;\n        ))}\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ç”¨æˆ·è¾“å…¥å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥æ”¹å˜å½“å‰çš„ URLï¼Œè€Œä¸æ˜¯å»æ”¹å˜ä¸€ä¸ªå†…éƒ¨çš„çŠ¶æ€ã€‚æ‰€ä»¥å½“ URL å˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† useSearchParam è¿™æ ·ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ Hook å»ç»‘å®šæŸ¥è¯¢å‚æ•°ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†å†…ï¼Œä»è€Œå®ç°äº†è¾“å…¥æ¡†å†…å®¹å’ŒæŸ¥è¯¢å…³é”®å­—è¿™ä¸ªçŠ¶æ€çš„åŒæ­¥ã€‚</p><p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œè¿™ä¸ªä¾‹å­å±•ç¤ºäº†ç¡®ä¿çŠ¶æ€å”¯ä¸€æ•°æ®æºçš„é‡è¦æ€§ã€‚æˆ‘ä»¬æ˜¯ç›´æ¥å°† URL ä½œä¸ºå”¯ä¸€çš„æ•°æ®æ¥æºï¼Œé‚£ä¹ˆçŠ¶æ€çš„è¯»å–å’Œä¿®æ”¹éƒ½æ˜¯å¯¹ URL ç›´æ¥è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é€šè¿‡ä¸€ä¸ªä¸­é—´çš„çŠ¶æ€ã€‚è¿™æ ·å°±ç®€åŒ–äº†çŠ¶æ€çš„ç®¡ç†ï¼Œä¿è¯äº†çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p><h1>å®æˆ˜æ¼”ç»ƒï¼šåˆ›å»ºè‡ªå®šä¹‰å—æ§ç»„ä»¶</h1><p>åœ¨å‰é¢ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œä½ çœ‹åˆ°äº†çŠ¶æ€ç®¡ç†çš„ä¸¤ä¸ªå¾ˆé‡è¦çš„åŸåˆ™ï¼Œä¸€ä¸ªæ˜¯ç¡®ä¿çŠ¶æ€æœ€å°åŒ–ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯æ‰¾åˆ°æ­£ç¡®çš„çŠ¶æ€æ¥æºï¼Œå¹¶ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ¥æºï¼Œé¿å…ä¸­é—´çŠ¶æ€ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘å†é€šè¿‡ä¸€ä¸ªæ—¥å¸¸å¼€å‘ä¸­éå¸¸å¸¸è§çš„ä¾‹å­ï¼Œæ¥å¸®åŠ©ä½ ç†è§£å’ŒæŒæ¡è¿™ä¸¤ä¸ªåŸåˆ™çš„å®é™…åº”ç”¨ã€‚</p><p>è¿™ä¸ªä¾‹å­å°±æ˜¯åˆ›å»ºä¸€ä¸ªå—æ§è¡¨å•ç»„ä»¶ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç”¨äºè¾“å…¥ä»·æ ¼çš„è¡¨å•ç»„ä»¶ï¼Œéœ€è¦ç”¨æˆ·æ—¢èƒ½è¾“å…¥ä»·æ ¼çš„æ•°é‡ï¼Œè¿˜èƒ½é€‰æ‹©è´§å¸çš„ç§ç±»ï¼Œæœ€ç»ˆçš„æ•ˆæœç±»ä¼¼ä¸‹é¢è¿™ä¸ªå›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/02/53/02e4012e1fb549eyyaa8ccb433344753.png?wh=480*92\" alt=\"\"></p><p>é¦–å…ˆæˆ‘è¦è§£é‡Šä¸‹ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶ã€‚åœ¨ React ä¸­ï¼Œå¯¹è¡¨å•ç»„ä»¶çš„å¤„ç†å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œå—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶ï¼š</p><ol>\n<li>å—æ§ç»„ä»¶ï¼šç»„ä»¶çš„å±•ç¤ºå®Œå…¨ç”±ä¼ å…¥çš„å±æ€§å†³å®šã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœä¸€ä¸ªè¾“å…¥æ¡†ä¸­çš„å€¼å®Œå…¨ç”±ä¼ å…¥çš„ value å±æ€§å†³å®šï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·è¾“å…¥å†³å®šï¼Œé‚£ä¹ˆå°±æ˜¯å—æ§ç»„ä»¶ï¼Œå†™æ³•æ˜¯ï¼š&lt; input value={value} onChange={handleChange} /&gt;ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåªç»™ &lt; input/&gt; ä¼ äº†ä¸€ä¸ª value å€¼ä½†æ˜¯æ²¡æœ‰ä¼  onChange äº‹ä»¶ï¼Œé‚£ä¹ˆé”®ç›˜æ€ä¹ˆè¾“å…¥éƒ½æ²¡æœ‰ååº”ã€‚</li>\n<li>éå—æ§ç»„ä»¶ï¼šè¡¨å•ç»„ä»¶å¯ä»¥æœ‰è‡ªå·±çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œä¸”å®ƒçš„å±•ç¤ºå€¼æ˜¯ä¸å—æ§çš„ã€‚æ¯”å¦‚ input åœ¨éå—æ§çŠ¶æ€ä¸‹çš„å†™æ³•æ˜¯ï¼š&lt; input onChange={handleChange}/&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçˆ¶ç»„ä»¶ä¸ä¼šæŠŠ value ç›´æ¥ä¼ é€’ç»™ input ç»„ä»¶ã€‚</li>\n</ol><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§éƒ¨åˆ†çš„è¡¨å•å…ƒç´ å…¶å®éƒ½æ˜¯å—æ§ç»„ä»¶ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡å¤–éƒ¨çš„çŠ¶æ€å®Œå…¨æ§åˆ¶å½“å‰ç»„ä»¶çš„è¡Œä¸ºã€‚</p><p>é‚£ä¹ˆå¯¹äºè¿™ä¸ªä¾‹å­ï¼Œä»·æ ¼è¾“å…¥æ¡†ä½œä¸ºä¸€ä¸ªå—æ§ç»„ä»¶ï¼Œå®ƒéœ€è¦å®šä¹‰ä¸¤ä¸ªå±æ€§ï¼švalue å’Œ onChangeã€‚è¿™æ ·å®ƒå°±å’Œä¸€ä¸ªæ™®é€šçš„è¡¨å•å…ƒç´ å…·æœ‰ç›¸åŒç”¨æ³•äº†ã€‚å…¶ä¸­ value çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶åŒ…å«æ•°å€¼å’Œè´§å¸ä¸¤ä¸ªå±æ€§ï¼Œæ¯”å¦‚ï¼š</p><pre><code>{\n  amount: 0,\n  currency: 'rmb',\n}\n</code></pre><p>é‚£ç°åœ¨æˆ‘ä»¬å°±æ¥çœ‹å¦‚ä½•å®ç°è¿™ä¸ªå—æ§ç»„ä»¶ã€‚åœ¨è¿™é‡Œæˆ‘å°±ä¸å†æ¼”ç¤ºé”™è¯¯çš„å†™æ³•æ˜¯ä»€ä¹ˆæ ·çš„äº†ï¼Œè€Œæ˜¯ç›´æ¥ç»™ä½ çœ‹æ­£ç¡®çš„å®ç°æ–¹å¼ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ç»å¸¸çœ‹åˆ°å¾ˆå¤šåŒå­¦ä¼šæŠŠè¿™ä¸ªç®€å•çš„åŠŸèƒ½åšå¾—é€»è¾‘éå¸¸å¤æ‚ï¼Œç”šè‡³è¿˜ä¸æ–­å‡ºç° Bugï¼Œæ€»ä¸èƒ½ä¿è¯ UI å’Œæ•°æ®çš„ä¸€è‡´æ€§ã€‚è¿™å…¶å®éƒ½æ˜¯å› ä¸ºæ²¡æœ‰ä»”ç»†æ€è€ƒçŠ¶æ€çš„å‡†ç¡®æ¥æºæ˜¯ä»€ä¹ˆï¼Œä»¥åŠæ˜¯å¦å®šä¹‰äº†å¤šä½™çš„çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬å…ˆç›´æ¥æ¥çœ‹æ­£ç¡®çš„å®ç°ï¼š</p><pre><code>import React, { useState, useCallback } from &quot;react&quot;;\n\nfunction PriceInput({\n  // å®šä¹‰é»˜è®¤çš„ value çš„æ•°æ®ç»“æ„\n  value = { amount: 0, currency: &quot;rmb&quot; },\n  // é»˜è®¤ä¸å¤„ç† onChange äº‹ä»¶\n  onChange = () =&gt; {}\n}) {\n  // å®šä¹‰ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ç»Ÿä¸€å¤„ç† amount æˆ–è€… currency å˜åŒ–çš„åœºæ™¯\n  const handleChange = useCallback(\n    (deltaValue) =&gt; {\n      // ç›´æ¥ä¿®æ”¹å¤–éƒ¨çš„ value å€¼ï¼Œè€Œä¸æ˜¯å®šä¹‰å†…éƒ¨ state\n      onChange({\n        ...value,\n        ...deltaValue\n      });\n    },\n    [value, onChange]\n  );\n  return (\n    &lt;div className=&quot;exp-02-price-input&quot;&gt;\n      {/* è¾“å…¥ä»·æ ¼çš„æ•°é‡ */}\n      &lt;input\n        value={value.amount}\n        onChange={(evt) =&gt; handleChange({ amount: evt.target.value })}\n      /&gt;\n      {/* é€‰æ‹©è´§å¸ç§ç±»*/}\n      &lt;select\n        value={value.currency}\n        onChange={(evt) =&gt; handleChange({ currency: evt.target.value })}\n      &gt;\n        &lt;option value=&quot;rmb&quot;&gt;RMB&lt;/option&gt;\n        &lt;option value=&quot;dollar&quot;&gt;Dollar&lt;/option&gt;\n      &lt;/select&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªè‡ªå®šä¹‰ç»„ä»¶åŒ…å«äº† input å’Œ select ä¸¤ä¸ªåŸºç¡€ç»„ä»¶ï¼Œåˆ†åˆ«ç”¨æ¥è¾“å…¥ä»·æ ¼æ•°é‡å’Œé€‰æ‹©è´§å¸ã€‚åœ¨å®ƒä»¬å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œç›´æ¥å»è§¦å‘ onChange äº‹ä»¶è®©çˆ¶ç»„ä»¶å»ä¿®æ”¹ value å€¼ï¼›åŒæ ·çš„ï¼Œå®ƒä»¬è‡ªå·±æ˜¾ç¤ºçš„å€¼ï¼Œåˆ™å®Œå…¨æ¥è‡ªäºä¼ é€’è¿›æ¥çš„ value å±æ€§ã€‚æ‰€ä»¥è¿™å…¶ä¸­çš„æ€è€ƒé€»è¾‘åœ¨äºï¼š</p><ol>\n<li>é¿å…å¤šä½™çš„çŠ¶æ€ï¼šæˆ‘ä»¬ä¸éœ€è¦åœ¨ PriceInput è¿™ä¸ªè‡ªå®šä¹‰ç»„ä»¶å†…éƒ¨ï¼Œå»å®šä¹‰çŠ¶æ€ç”¨äºä¿å­˜çš„ amount æˆ–è€… currencyã€‚</li>\n<li>æ‰¾åˆ°å‡†ç¡®çš„å”¯ä¸€æ•°æ®æºï¼šè¿™é‡Œå†…éƒ¨ä¸¤ä¸ªåŸºç¡€ç»„ä»¶çš„å€¼ï¼Œå…¶å‡†ç¡®ä¸”å”¯ä¸€çš„æ¥æºå°±æ˜¯ value å±æ€§ï¼Œè€Œä¸æ˜¯å…¶å®ƒçš„ä»»ä½•ä¸­é—´çŠ¶æ€ã€‚</li>\n</ol><p>å› æ­¤ï¼Œé€šè¿‡è¿™æ ·çš„åšæ³•ï¼Œæ•´ä¸ªè‡ªå®šä¹‰çš„ç»„ä»¶é€»è¾‘å°±å˜å¾—éå¸¸ç®€å•ï¼Œç”šè‡³ä¸éœ€è¦ä»»ä½•å†…éƒ¨çš„çŠ¶æ€ï¼Œå°±å®ç°äº†è¿™æ ·ä¸€ä¸ªéå¸¸å¸¸è§çš„éœ€æ±‚ã€‚</p><p>è€Œåœ¨æˆ‘çœ‹åˆ°çš„å®é™…é¡¹ç›®ä»£ç ä¸­ï¼Œå‘ç°å¾ˆå¤šåŒå­¦éƒ½ä¹ æƒ¯äºç”¨å¤šä½™çš„å†…éƒ¨çŠ¶æ€å»åˆ†åˆ«ä¿å­˜ amount å’Œ currencyï¼Œç„¶åå†å’Œå¤–éƒ¨ä¼ è¿›æ¥çš„ value å±æ€§è¿›è¡ŒåŒæ­¥ï¼Œä»¥æ­¤æ¥ä¿è¯ä¸€è‡´æ€§ï¼Œè¿™å°±é€ æˆäº†çŠ¶æ€é€»è¾‘çš„å¤æ‚ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨åšç±»ä¼¼åŠŸèƒ½çš„æ—¶å€™ï¼Œä¸€å®šè¦é¿å…è¿™ç§ä¸åˆç†çš„åšæ³•ï¼Œå°½é‡ç”¨æœ€ç®€æ´çš„é€»è¾‘å»å®ç°éœ€è¦çš„åŠŸèƒ½ã€‚</p><h1>å°ç»“</h1><p>å¥½äº†ï¼Œè¿™èŠ‚è¯¾çš„å†…å®¹å°±æ˜¯è¿™äº›ï¼Œæˆ‘ç®€å•å°ç»“ä¸€ä¸‹ã€‚ä½ å¯ä»¥æŠŠ React çš„å¼€å‘çœ‹ä½œæ˜¯å¤æ‚çŠ¶æ€çš„ç®¡ç†å’Œç»´æŠ¤ã€‚é‚£ä¹ˆä¸ºäº†ä¿è¯çŠ¶æ€çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å°±ä¸€å®šè¦ç®€åŒ–çŠ¶æ€å¤„ç†çš„é€»è¾‘ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„åŸåˆ™éœ€è¦éµå¾ªï¼š</p><ul>\n<li>ä¸€ä¸ªæ˜¯çŠ¶æ€æœ€å°åŒ–åŸåˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´è¦é¿å…å†—ä½™çš„çŠ¶æ€ï¼›</li>\n<li>å¦ä¸€ä¸ªåˆ™æ˜¯å”¯ä¸€æ•°æ®æºåŸåˆ™ï¼Œé¿å…ä¸­é—´çŠ¶æ€ã€‚</li>\n</ul><p>æ‰€ä»¥ï¼Œåœ¨ä»»ä½•æ—¶å€™æƒ³è¦å®šä¹‰æ–°çŠ¶æ€çš„æ—¶å€™ï¼Œéƒ½è¦é—®è‡ªå·±ä¸€ä¸‹ï¼šè¿™ä¸ªçŠ¶æ€æœ‰å¿…è¦å—ï¼Ÿæ˜¯å¦èƒ½é€šè¿‡è®¡ç®—å¾—åˆ°ï¼Ÿæ˜¯å¦åªæ˜¯ä¸€ä¸ªä¸­é—´çŠ¶æ€ï¼Ÿåªæœ‰æ¯æ¬¡éƒ½ä»”ç»†æ€è€ƒäº†ï¼Œæ‰èƒ½æ‰¾åˆ°éœ€è¦å®šä¹‰çš„æœ€æœ¬è´¨çš„çŠ¶æ€ã€‚ç„¶åå›´ç»•è¿™ä¸ªæœ€æœ¬è´¨çš„çŠ¶æ€å»æ€è€ƒæŸä¸ªåŠŸèƒ½å…·ä½“çš„å®ç°ï¼Œä»è€Œè®© React çš„å¼€å‘æ›´åŠ ç®€æ´å’Œé«˜æ•ˆã€‚</p><p>è¿™èŠ‚è¯¾æ‰€æœ‰çš„ç¤ºä¾‹ä»£ç ï¼Œä½ å¯ä»¥é€šè¿‡ codesandbox æŸ¥çœ‹ï¼š<a href=\"https://codesandbox.io/s/react-hooks-course-20vzg?file=/src/08/PriceInput.js:0-802\">https://codesandbox.io/s/react-hooks-course-20vzg</a>.</p><h1>æ€è€ƒé¢˜</h1><p>åœ¨ç¬¬äºŒä¸ªåœ¨URL ä¸­åŒ…å«æŸ¥è¯¢å…³é”®å­—çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº† userSearchParams è¿™æ ·ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ Hookï¼Œç”¨äºç»‘å®š URL ä¸Šçš„æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ã€‚å¦‚æœè®©ä½ å®ç°è¿™ä¸ª Hookï¼Œä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>æ¬¢è¿åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒå’Œæƒ³æ³•ï¼Œæˆ‘ä¼šå’Œä½ äº¤æµè®¨è®ºã€‚å¦‚æœä»Šå¤©çš„å®æˆ˜æ¼”ç»ƒè®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠè¯¾ç¨‹åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ï¼Œæˆ‘ä»¬å…±åŒè¿›æ­¥ï¼</p>","neighbors":{"left":{"article_title":"07ï½œå…¨å±€çŠ¶æ€ç®¡ç†ï¼šå¦‚ä½•åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ Reduxï¼Ÿ","id":382459},"right":{"article_title":"ç­”ç–‘è§£æƒ‘01ï½œå¦‚ä½•è½¬æ¢åº”ç”¨React Hooks çš„æ€è·¯ï¼Ÿ","id":384252}},"comments":[{"had_liked":false,"id":339836,"user_name":"Geek_e6b8eb","can_delete":false,"product_type":"c1","uid":2955055,"ip_address":"","ucode":"C675EB2AACE319","user_header":"","comment_is_top":true,"comment_ctime":1648432182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720385032008e+18","product_id":100079901,"comment_content":"çœŸçš„åæ‚”æ²¡æœ‰æ—©ä¸€ç‚¹çœ‹åˆ°è¿™ä¸ªè¯¾ç¨‹ï¼Œä¹‹å‰æˆ‘å°±ç»´æŠ¤äº†å¾ˆå¤šä¸­é—´ä»£ç ï¼Œæœ€åå¼„å¾—ä¸€ä¸ªç»„ä»¶è¶…çº§å¤æ‚ã€‚ &#47;(ã„’oã„’)&#47;~~","like_count":0},{"had_liked":false,"id":297055,"user_name":"Isaac","can_delete":false,"product_type":"c1","uid":1110607,"ip_address":"","ucode":"038C349AB508AB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","comment_is_top":false,"comment_ctime":1623292079,"is_pvip":false,"replies":[{"id":"107973","content":"èµ~ history API æ˜¯æ¯”è¾ƒç‰¹åˆ«çš„ï¼Œåªèƒ½ç”¨ patch çš„æ–¹æ³•æ¥ç›‘å¬ url å˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623470272,"ip_address":"","comment_id":297055,"utype":1}],"discussion_count":5,"race_medal":0,"score":"48867932335","product_id":100079901,"comment_content":"æ€è€ƒé¢˜å›ç­”ï¼š<br>ç”±äº hisgory.pushState ä¸ä¼šè§¦å‘é¡µé¢é‡æ–°æ¸²æŸ“ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ç»„ä»¶æ›´æ–°ï¼Œæ‰€ä»¥ï¼Œé»˜è®¤çš„ userSearchParams åªä¼šè·å–ç¬¬ä¸€æ¬¡çš„ URL ä¸Šçš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ç›‘å¬ pushstateã€replaceState ç­‰äº‹ä»¶ï¼Œå¯¹çŠ¶æ€è¿›è¡ŒåŒæ­¥ã€‚<br><br>å…¶å®å»é˜…è¯» react-us çš„æºç å®ç°ï¼Œä¹Ÿæ˜¯é‡‡ç”¨äº†è¿™ç§åŠæ³•ã€‚<br>https:&#47;&#47;github.com&#47;streamich&#47;react-use&#47;blob&#47;90e72a5340460816e2159b2c461254661b00e1d3&#47;src&#47;useSearchParam.ts#L8","like_count":12,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521699,"discussion_content":"èµ~ history API æ˜¯æ¯”è¾ƒç‰¹åˆ«çš„ï¼Œåªèƒ½ç”¨ patch çš„æ–¹æ³•æ¥ç›‘å¬ url å˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623470272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378727,"discussion_content":"è¿™é‡Œè¡¥å……ä¸€ä¸‹ï¼Œå…¶å®æµè§ˆå™¨é»˜è®¤ä¸æ”¯æŒç›‘å¬ pushState çš„ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬å¯¹ history å¯¹è±¡åšä¸€å±‚åŠ«æŒã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623374545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2936579,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJgN2pOV8RpojoWiaF4zfv963IiaSsNtby4FQB4NZgKEdbHJNpuV3m47ezpr2Be0UnibPnx1P3a4hgg/132","nickname":"Geek_73e833","note":"","ucode":"4132C0B36A016D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579114,"discussion_content":"å¤§ä½¬è§£é‡Šä¸€ä¸‹ï¼Œåœ¨å“ªé‡Œåšçš„åŠ«æŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657179080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378727,"ip_address":""},"score":579114,"extra":""}]},{"author":{"id":2936579,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJgN2pOV8RpojoWiaF4zfv963IiaSsNtby4FQB4NZgKEdbHJNpuV3m47ezpr2Be0UnibPnx1P3a4hgg/132","nickname":"Geek_73e833","note":"","ucode":"4132C0B36A016D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579120,"discussion_content":"å¥¥ï¼Œæ˜ç™½äº†ï¼Œreact-use æºç åœ¨è¿™é‡Œï¼ŒåŠ«æŒåœ¨è¿™é‡Œ\nconst patchHistoryMethod = (method) =&gt; {\n  const history = window.history;\n  const original = history[method];\n\n  history[method] = function (state) {\n    const result = original.apply(this, arguments);\n    const event = new Event(method.toLowerCase());\n\n    (event as any).state = state;\n\n    window.dispatchEvent(event);\n\n    return result;\n  };\n};\n\nif (isBrowser) {\n  patchHistoryMethod(&#39;pushState&#39;);\n  patchHistoryMethod(&#39;replaceState&#39;);\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657180929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2936579,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJgN2pOV8RpojoWiaF4zfv963IiaSsNtby4FQB4NZgKEdbHJNpuV3m47ezpr2Be0UnibPnx1P3a4hgg/132","nickname":"Geek_73e833","note":"","ucode":"4132C0B36A016D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579113,"discussion_content":"è‡ªå·±ç”¨addEventListenerç›‘å¬popstateï¼Œpushstateï¼Œ replacestateï¼Œè¿™ä¸‰ä¸ªéƒ½æ²¡æœ‰ç”¨ï¼Œçœ‹react-useä¹Ÿæ˜¯è¿™ä¸‰ä¸ªï¼Œâ€œpatchçš„æ–¹æ³•â€ æ˜¯å•¥æ„æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657179018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297126,"user_name":"Jerryz","can_delete":false,"product_type":"c1","uid":1232276,"ip_address":"","ucode":"9DAEEAAE70FA00","user_header":"https://static001.geekbang.org/account/avatar/00/12/cd/94/0d44361e.jpg","comment_is_top":false,"comment_ctime":1623320044,"is_pvip":false,"replies":[{"id":"107950","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623388876,"ip_address":"","comment_id":297126,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35983058412","product_id":100079901,"comment_content":"é»˜è®¤ history.pushState å’Œ history.replaceState éƒ½æ²¡æœ‰å¯¹åº”çš„ç›‘å¬äº‹ä»¶ã€‚react-use patch äº†history å¯¹è±¡ã€‚","like_count":8,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521729,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623388876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1089037,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9e/0d/743ba4ef.jpg","nickname":"GENTAR RAY","note":"","ucode":"4ABA3939EA184F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393569,"discussion_content":"åº”è¯¥æ˜¯æˆ‘åª import äº† useSearchParams è€Œç›¸å…³çš„ patch åœ¨ useLocation é‡Œï¼Œæœ€å npm run build çš„æ—¶å€™æ˜¯ production æ¨¡å¼çš„ webpackï¼Œç›´æ¥ tree-shaking ç»™æŠ–æ‰äº†ï¼Œè€Œå¼€å‘ç¯å¢ƒæ²¡æœ‰ tree-shakingï¼Œ å‘ç°ä¸äº†é—®é¢˜ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631498214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1089037,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9e/0d/743ba4ef.jpg","nickname":"GENTAR RAY","note":"","ucode":"4ABA3939EA184F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393461,"discussion_content":"æœ€è¿‘ç”¨ useSearchParams é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œç”¨ create-react-app åˆ›å»ºå‡ºæ¥çš„é¡¹ç›®æ‰“åŒ…ä¹‹åå‘ç° useSearchParams ä¸èƒ½æ­£å¸¸å·¥ä½œï¼ŒåŸå› æ˜¯ react-use æºç é‡Œæœ‰è¿™æ ·ä¸€æ®µä»£ç (https://github.com/streamich/react-use/blob/master/src/useLocation.ts#L20)\nå…·ä½“åŸå› è¿˜æ²¡å¼„æ¸…æ¥šï¼Œä½†æ˜¯ root cause å°±åœ¨è¿™äº†ï¼Œä»…ä¾›å‚è€ƒ ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631441386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303053,"user_name":"Geek_0330fe","can_delete":false,"product_type":"c1","uid":2377130,"ip_address":"","ucode":"3324AF1AD2DC8C","user_header":"","comment_is_top":false,"comment_ctime":1626557577,"is_pvip":false,"replies":[{"id":"109867","content":"ç¬¬ä¸‰æ–¹åº“çš„ç›®çš„æ­£æ˜¯ç®€åŒ–ä½ çš„åº”ç”¨é€»è¾‘ã€‚å…¶å†…éƒ¨å¦‚ä½•å®ç°éƒ½ä¸ä¼šå½±å“ä½ çš„åº”ç”¨çš„å¤æ‚åº¦ï¼Œä¹Ÿæ— éœ€å…³ç³»å®ƒå†…éƒ¨å¦‚ä½•å®ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1626854464,"ip_address":"","comment_id":303053,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18806426761","product_id":100079901,"comment_content":"react-use çš„ useSearchParams ä¸­ä¹Ÿä½¿ç”¨äº†ä¸€ä¸ª state å»ç»´æŠ¤äº†ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™æ˜¯ä¸æ˜¯è¯´æ˜å¤æ‚åº¦ä¸ä¼šæ¶ˆå¤±ï¼Œåªä¼šè½¬ç§»å‘¢ï¼Ÿæˆ‘ä»¬åªæ˜¯æŠŠæˆ‘ä»¬æœ¬æ¥è¦ç»´æŠ¤çš„é‚£ä¸ªçŠ¶æ€äº¤ç»™ç¬¬ä¸‰æ–¹åº“å»ç»´æŠ¤äº†ã€‚","like_count":4,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523536,"discussion_content":"ç¬¬ä¸‰æ–¹åº“çš„ç›®çš„æ­£æ˜¯ç®€åŒ–ä½ çš„åº”ç”¨é€»è¾‘ã€‚å…¶å†…éƒ¨å¦‚ä½•å®ç°éƒ½ä¸ä¼šå½±å“ä½ çš„åº”ç”¨çš„å¤æ‚åº¦ï¼Œä¹Ÿæ— éœ€å…³ç³»å®ƒå†…éƒ¨å¦‚ä½•å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626854464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297009,"user_name":"Geeker","can_delete":false,"product_type":"c1","uid":1032345,"ip_address":"","ucode":"9937127DE96D78","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c0/99/259a412f.jpg","comment_is_top":false,"comment_ctime":1623281190,"is_pvip":true,"replies":[{"id":"107952","content":"å¯ä»¥è¯´ï¼Œç›´æ¥é™ä½äº†ä»£ç å¤æ‚åº¦~","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623388930,"ip_address":"","comment_id":297009,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18803150374","product_id":100079901,"comment_content":"çŠ¶æ€æœ€å°åŒ–åŸåˆ™ç›´æ¥å½±å“äº†ä»£ç çš„å¤æ‚åº¦","like_count":4,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521680,"discussion_content":"å¯ä»¥è¯´ï¼Œç›´æ¥é™ä½äº†ä»£ç å¤æ‚åº¦~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623388930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297048,"user_name":"Isaac","can_delete":false,"product_type":"c1","uid":1110607,"ip_address":"","ucode":"038C349AB508AB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","comment_is_top":false,"comment_ctime":1623291029,"is_pvip":false,"replies":[{"id":"107974","content":"æ˜¯çš„ï¼Œè·¨ç»„ä»¶çš„æ•°æ®å…±äº«å°±éœ€è¦ Redux è¿™æ ·çš„å…¨å±€çŠ¶æ€ç®¡ç†æœºåˆ¶äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623470309,"ip_address":"","comment_id":297048,"utype":1}],"discussion_count":7,"race_medal":0,"score":"14508192917","product_id":100079901,"comment_content":"è€å¸ˆï¼Œæ–‡ç« ä¸­çš„åˆ—è¡¨ç­›é€‰çš„ä¾‹å­ï¼Œè™½ç„¶ä½¿ç”¨ useMemo å¯ä»¥ç¼“å­˜ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªç»„ä»¶å®ä¾‹ç”¨åˆ°ï¼Œå²‚ä¸æ˜¯è¿˜æ˜¯ä¼šå‡ºç°å¤šæ¬¡è®¡ç®—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521694,"discussion_content":"æ˜¯çš„ï¼Œè·¨ç»„ä»¶çš„æ•°æ®å…±äº«å°±éœ€è¦ Redux è¿™æ ·çš„å…¨å±€çŠ¶æ€ç®¡ç†æœºåˆ¶äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623470309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378899,"discussion_content":"å—¯å—¯ æ˜ç™½ ï¼Œè°¢è°¢åŒå­¦å’Œè€å¸ˆçš„å›å¤äº¤æµ ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623498031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168127,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/ff/99d2e7f5.jpg","nickname":"|G. XIAO|","note":"","ucode":"75DA0B3047A2F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378657,"discussion_content":"å¦‚æœå¤šä¸ªç»„ä»¶å®ä¾‹ç”¨åˆ°ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥æŠŠåˆ—è¡¨ç­›é€‰çš„è¿™ä¸ªæ–¹æ³•ï¼ŒæŠ½è±¡æˆä¸€ä¸ª  Hooksï¼Œç„¶åå¤šä¸ªç»„ä»¶å®ä¾‹å¼•ç”¨å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623325376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1168127,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/ff/99d2e7f5.jpg","nickname":"|G. XIAO|","note":"","ucode":"75DA0B3047A2F0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378726,"discussion_content":"è¿™ä¸ªå·²ç»æ˜¯ä¸€ä¸ª hook äº†å‘€ï¼ŒæŠ½è±¡æˆä¸€ä¸ª Hooks ï¼Œæ„æ€æ˜¯å•ç‹¬å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œå—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œæœ¬è´¨æ²¡å•¥åŒºåˆ«ï¼Œæ¯ä¸ªç»„ä»¶å»ä½¿ç”¨çš„æ—¶å€™ä¼šéƒ½æ‰§è¡Œä¸€éã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623374372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378657,"ip_address":""},"score":378726,"extra":""},{"author":{"id":1168127,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/ff/99d2e7f5.jpg","nickname":"|G. XIAO|","note":"","ucode":"75DA0B3047A2F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378730,"discussion_content":"1.å—¯å—¯ï¼Œæˆ‘æ˜¯è¿™é‡Œç†è§£çš„ï¼Œåœ¨æŠ½å–ä¸€ä¸ª Hooks é—®é¢˜ä¸å¤§ï¼Œè¿™æ ·ä¹Ÿèƒ½ä¿è¯æ•°æ®æºçš„å”¯ä¸€æ€§\n2.ä½¿ç”¨ useMemoï¼Œä¾èµ–æ²¡æœ‰å˜åŒ–ï¼Œä½¿ç”¨ç¼“å­˜çš„æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623375895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378726,"ip_address":""},"score":378730,"extra":""},{"author":{"id":1110607,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/4f/59bd4141.jpg","nickname":"Isaac","note":"","ucode":"038C349AB508AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1168127,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/ff/99d2e7f5.jpg","nickname":"|G. XIAO|","note":"","ucode":"75DA0B3047A2F0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378843,"discussion_content":"æˆ‘è¿™é‡Œä¸»è¦çº ç»“çš„åœ°æ–¹åœ¨äºï¼Œå‡è®¾æˆ‘æœ‰Aã€B ä¸¤ä¸ªç»„ä»¶ï¼Œéƒ½è°ƒç”¨äº†è¿™ä¸ª Hook ï¼Œé‚£ä¹ˆ Aã€B ä¸¤ä¸ªç»„ä»¶éƒ½ä¼šæ‰§è¡Œä¸€éè¿‡æ»¤ list çš„æ“ä½œï¼Œå³ä½¿ä½ ç”¨äº† useMemoã€‚\næ‰€ä»¥ï¼Œæˆ‘ç†è§£çš„æ˜¯ï¼Œå¦‚æœæœ‰å¤šä¸ªç»„ä»¶éœ€è¦ä½¿ç”¨çš„ filterListï¼ˆè¿‡æ»¤åçš„ listï¼‰ï¼Œé‚£ä¹ˆæ˜¯å¦å°† filterList ç›´æ¥å­˜å‚¨åˆ° redux ä¸­æ›´å¥½ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623462379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378730,"ip_address":""},"score":378843,"extra":""}]}]},{"had_liked":false,"id":297362,"user_name":"å¯‡äº‘","can_delete":false,"product_type":"c1","uid":1001332,"ip_address":"","ucode":"87181F16F83543","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/74/5e292ded.jpg","comment_is_top":false,"comment_ctime":1623483885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10213418477","product_id":100079901,"comment_content":"è€å¸ˆç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæ•°æ®çš„è¯·æ±‚æ”¾åˆ°å½“å‰ç»„ä»¶ä¸­å¥½è¿˜æ˜¯ç”±å¤–éƒ¨ä¼ å…¥å¥½ï¼Ÿ","like_count":2},{"had_liked":false,"id":297156,"user_name":"å®ˆæœ›","can_delete":false,"product_type":"c1","uid":1560187,"ip_address":"","ucode":"09FD14D30F26CB","user_header":"https://static001.geekbang.org/account/avatar/00/17/ce/7b/f9b418d8.jpg","comment_is_top":false,"comment_ctime":1623332485,"is_pvip":false,"replies":[{"id":"107948","content":"è™½ç„¶çœ‹ä¸Šå»æœ‰ç‚¹åƒï¼Œä½†ä¸å¤ªä¸€æ ·å“¦~","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623388694,"ip_address":"","comment_id":297156,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10213267077","product_id":100079901,"comment_content":"è¿™æ˜¯ä¸æ˜¯å’Œå•å‘æ•°æ®æµå·®ä¸å¤šå‘€ï¼ï¼ï¼<br>æ•°æ®æµå‘æ€»æ˜¯ä¸€æ¡çº¿ï¼Œä¸è¦å¼€æ–°åˆ†æ”¯","like_count":2,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521737,"discussion_content":"è™½ç„¶çœ‹ä¸Šå»æœ‰ç‚¹åƒï¼Œä½†ä¸å¤ªä¸€æ ·å“¦~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623388694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297153,"user_name":"å‚»å­æ¥äº†å¿«è·‘ä¸¶","can_delete":false,"product_type":"c1","uid":1282777,"ip_address":"","ucode":"662624121A1DFA","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/d9/84c1de45.jpg","comment_is_top":false,"comment_ctime":1623330771,"is_pvip":false,"replies":[{"id":"107949","content":"æ•°æ®å¤„ç†ä¸ºä»€ä¹ˆè¦åœ¨çˆ¶ç»„ä»¶å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Nate","uid":"1018676","ctime":1623388838,"ip_address":"","comment_id":297153,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10213265363","product_id":100079901,"comment_content":"&#47;&#47; æ¯å½“ searchKey æˆ–è€… data å˜åŒ–çš„æ—¶å€™ï¼Œé‡æ–°è®¡ç®—æœ€ç»ˆç»“æœ<br>è€å¸ˆè¿™ä¸ªåœ°æ–¹æœ‰é—®é¢˜å§ï¼Œä¸€èˆ¬æˆ‘ä»¬æ˜¯é€šè¿‡å…³é”®å­—å»æ‹¿æ¥å£çš„dataæ•°æ®ï¼Œä½ è¿™ä¸ªdemo dataæ•°æ®å¹¶ä¸æ˜¯é€šè¿‡keywordè·å–è¿‡æ¥çš„ï¼Œè€Œæ˜¯ç›´æ¥ä¼ å…¥çš„ä¸€ä¸ªdataï¼Œæ˜¯æœ‰é—®é¢˜çš„ï¼Œåº”è¯¥é€šè¿‡çŠ¶æ€æå‡ï¼Œä¹Ÿå°±æ˜¯<br>const filtered = useMemo(() =&gt; { return data.filter((item) =&gt; item.title.toLowerCase().includes(searchKey.toLowerCase()) ); }, [searchKey, data]);<br>è¿™æ®µä»£ç åº”è¯¥åœ¨çˆ¶ç»„ä»¶ä¸­ï¼Œæ‹¿åˆ°dataæ•°æ®ä¹‹åå†ä¼ è¿›å»","like_count":2,"discussions":[{"author":{"id":1018676,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8b/34/61035278.jpg","nickname":"Nate","note":"","ucode":"844B4C20BB3D6E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521736,"discussion_content":"æ•°æ®å¤„ç†ä¸ºä»€ä¹ˆè¦åœ¨çˆ¶ç»„ä»¶å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623388838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1374957,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fa/ed/0742b854.jpg","nickname":"Jun Ma","note":"","ucode":"0C5E2AB51E6A83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584467,"discussion_content":"æˆ‘è§‰å¾—ä»–ä»¬åœ¨è¯´ä¸¤ä¸ªä¸œè¥¿ã€‚ \nä¸€ä¸ªæ˜¯å·²çŸ¥æ•°æ®æºï¼Œé€šè¿‡å‰ç«¯æ¥åšè¿‡æ»¤ï¼›\nä¸€ä¸ªæ˜¯æ‹¿åˆ°å…³é”®å­—ï¼Œç›´æ¥å»åç«¯è¯·æ±‚ï¼›\nä¸çŸ¥é“æˆ‘ç†è§£å¯¹æ²¡æœ‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660838145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2177627,"avatar":"https://static001.geekbang.org/account/avatar/00/21/3a/5b/e59f76a6.jpg","nickname":"å©§å­é…±.","note":"","ucode":"B47F87EFA8F8F5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378702,"discussion_content":"è¿™é‡Œè²Œä¼¼åªæ˜¯ä¸ªæ ·ä¾‹å§ dataæ¥æºæ—¢çˆ¶ç»„ä»¶propsä¼ å…¥ ä¹Ÿå¯ä»¥åœ¨å½“å‰ç»„ä»¶è·å–åˆ°æ”¾åˆ°stateé‡Œé¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623346171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1282777,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/d9/84c1de45.jpg","nickname":"å‚»å­æ¥äº†å¿«è·‘ä¸¶","note":"","ucode":"662624121A1DFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2177627,"avatar":"https://static001.geekbang.org/account/avatar/00/21/3a/5b/e59f76a6.jpg","nickname":"å©§å­é…±.","note":"","ucode":"B47F87EFA8F8F5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378728,"discussion_content":"æ˜¯å‘¢ï¼Œæœ€ä¼˜çš„æ–¹å¼å°±æ˜¯è€å¸ˆæœ€åç»™å‡ºçš„é‚£ä¸ªä¾‹å­ï¼ŒçŠ¶æ€æå‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623375847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378702,"ip_address":""},"score":378728,"extra":""}]}]},{"had_liked":false,"id":348902,"user_name":"é²æ»¨é€Š","can_delete":false,"product_type":"c1","uid":1387826,"ip_address":"","ucode":"AD58F1115DF311","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/32/43595745.jpg","comment_is_top":false,"comment_ctime":1655529163,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655529163","product_id":100079901,"comment_content":"1. &#47;&#47; getQuery å‡½æ•°ç”¨æˆ·è·å– URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²  åº”è¯¥æ˜¯  ç”¨äºè·å– URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚<br>2. å—æ§ç»„ä»¶çš„ä¾‹å­ä¸­ï¼Œ handleChange çš„ä»£ç å†™åœ¨çˆ¶ç»„ä»¶ä¸­æ˜¯ä¸æ˜¯æ›´å¥½ ï¼Ÿ","like_count":0},{"had_liked":false,"id":328459,"user_name":"Light èƒ–è™","can_delete":false,"product_type":"c1","uid":2876591,"ip_address":"","ucode":"D5FCFE14172D31","user_header":"https://static001.geekbang.org/account/avatar/00/2b/e4/af/f8cf4bc2.jpg","comment_is_top":false,"comment_ctime":1640743729,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640743729","product_id":100079901,"comment_content":"const handleSearchChange = useCallback(evt =&gt; { const key = evt.target.value; &#47;&#47; è®¾ç½®å½“å‰çš„æŸ¥è¯¢å…³é”®çŠ¶æ€ setSearchKey(key); &#47;&#47; æ”¹å˜ URL çš„æŸ¥è¯¢å‚æ•° history.push(`&#47;movie-list?key=${key}`); })<br>è¿™ä¸ªæ–¹æ³•æ”¾åœ¨äº†inputçš„onChangeäº‹ä»¶ä¸Šé¢ï¼Œä¼šä¸ä¼šåªè¦è¾“å…¥å€¼æœ‰å˜åŒ–é¡µé¢å°±è·³è½¬å‡ºå»äº†å‘¢","like_count":0},{"had_liked":false,"id":321570,"user_name":"é˜¿é˜³","can_delete":false,"product_type":"c1","uid":1165817,"ip_address":"","ucode":"20A35FB86B1C5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg","comment_is_top":false,"comment_ctime":1636949529,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636949529","product_id":100079901,"comment_content":"å¯¹äºè¿™èŠ‚è¯¾çš„å†…å®¹ï¼Œæˆ‘æœ€è¿‘ä¸€å¹´å¤šçš„é¡¹ç›®å®è·µï¼Œæœ‰æ·±åˆ»çš„ä½“ä¼šã€‚ä¸Šä¸€æ¬¡è¿­ä»£ï¼Œå› ä¸ºå®šä¹‰äº†å¾ˆå¤šä¸­é—´çŠ¶æ€å’Œå†—ä½™çŠ¶æ€ï¼Œä¹Ÿæ²¡æœ‰ä»”ç»†æ€è€ƒå“ªäº›æ•°æ®æ˜¯å¿…é¡»çš„æ•°æ®ï¼Œå“ªäº›æ˜¯éå¿…é¡»çš„æ•°æ®ï¼Œå¯¼è‡´çŠ¶æ€ä¹‹é—´çš„åŒæ­¥éå¸¸å¤æ‚ï¼Œè€Œä¸”éå¸¸å®¹æ˜“å‡ºé”™ã€‚å½“æ—¶é™·å…¥äº†æ³¥æ½­ï¼Œæ— æ³•è‡ªæ‹”ã€‚è¿™æ¬¡é‡æ„é¡¹ç›®ï¼Œè™½ç„¶ç”¨çš„æ˜¯vue3é‡æ„çš„é¡¹ç›®ï¼Œä½†æ˜¯reactçš„å¼€å‘æ€æƒ³ï¼Œä»¥åŠè¿™èŠ‚è¯¾è®²æˆçš„ç»éªŒï¼Œæˆ‘é‡æ–°åœ¨æ–°çš„è¿­ä»£å¼€å‘ä¸­ï¼Œå»å°è¯•ä½¿ç”¨ï¼Œå»æ€è€ƒé€»è¾‘èƒŒåçš„æ•°æ®ï¼Œä¸€ä¸‹å­æ„Ÿè§‰åˆ°è±ç„¶å¼€æœ—äº†ï¼Œè€Œä¸”è¶Šåšæ„Ÿè§‰è¶Šé¡ºç•…ã€‚<br>æ„Ÿè°¢è€å¸ˆï¼","like_count":0},{"had_liked":false,"id":317067,"user_name":"é™ˆæå®¢","can_delete":false,"product_type":"c1","uid":1393500,"ip_address":"","ucode":"F01811019654CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7ZuleMUiarkal8u7r2jiajt1kiaicCiaWxHlmOicI4NLcqWQC9iar9y46oXv0W2oNQanUUwwPJQdFzZVfQ/132","comment_is_top":false,"comment_ctime":1634655547,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634655547","product_id":100079901,"comment_content":"å®æˆ˜ä¾‹å­éå¸¸ç”ŸåŠ¨ï¼å­¦ä¹ åˆ°äº†","like_count":0},{"had_liked":false,"id":312220,"user_name":"æå…‹å‹¤","can_delete":false,"product_type":"c1","uid":2660079,"ip_address":"","ucode":"78917017E984FB","user_header":"","comment_is_top":false,"comment_ctime":1631689986,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631689986","product_id":100079901,"comment_content":"ä½¿ç”¨userSearchParamsç»´æŠ¤searchkey,å¹¶æš´éœ²ç»™SearchBoxå§","like_count":0},{"had_liked":false,"id":311997,"user_name":"å¼ æ´ªæ°¸","can_delete":false,"product_type":"c1","uid":2717457,"ip_address":"","ucode":"F144992D9CAD5C","user_header":"","comment_is_top":false,"comment_ctime":1631587164,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631587164","product_id":100079901,"comment_content":"const handleSearch = useCallback(evt =&gt; { setSearchKey(evt.target.value); setFiltered(data.filter(item =&gt; { return item.title.includes(evt.target.value))); })); }, [filtered])<br>filtered æ²¡æœ‰è¢«æ”¹å˜ï¼ŒhandleSearchå¯ä»¥è¢«è®¤ä¸ºæ²¡æœ‰æ”¹å˜ï¼Œè¿™é‡Œæ˜¯å¦ä¼šæœ‰é—®é¢˜å‘¢","like_count":0},{"had_liked":false,"id":311376,"user_name":"æ–‡å°æ–‡","can_delete":false,"product_type":"c1","uid":2689886,"ip_address":"","ucode":"65C20A6A8D0459","user_header":"https://static001.geekbang.org/account/avatar/00/29/0b/5e/08c8465c.jpg","comment_is_top":false,"comment_ctime":1631193389,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631193389","product_id":100079901,"comment_content":"è€å¸ˆè®²å¾—å¤ªå¥½äº†ï¼Œæµ…æ˜¾æ˜“æ‡‚ï¼ æ„Ÿè°¢è€å¸ˆçš„è¾›å‹¤ä»˜å‡º","like_count":0},{"had_liked":false,"id":301785,"user_name":"æµ©æ˜å•¦","can_delete":false,"product_type":"c1","uid":1377422,"ip_address":"","ucode":"120ED8FC45B992","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/8e/e75ecc5e.jpg","comment_is_top":false,"comment_ctime":1625881771,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1625881771","product_id":100079901,"comment_content":"è€å¸ˆæƒ³è¯·æ•™ä¸€ä¸‹å¦‚æœä¸€ä¸ªç»„ä»¶å†…éƒ¨æœ‰å¤šä¸ª useState çš„çŠ¶æ€ è­¬å¦‚<br><br>ç¬¬ä¸€ç§<br>const [list,setList] = useState([])<br>const [loading,setLoading] = useState(false)<br>const [error,setError] = useState(false)<br><br><br>ç¬¬äºŒç§<br>const [state,setState] = useState({<br>    list:[],<br>    loading:false,<br>    error:false<br>})<br><br>ä»¥ä¸Šå“ªä¸¤ç§ä¼šæ›´åŠ æ¨èå‘¢ï¼Ÿ<br><br>åœ¨ä¸€äº›åœºæ™¯ä¸‹<br><br>æ¯”å¦‚æˆ‘åœ¨æŸä¸ªæ–¹æ³•ä¸­æ‰§è¡Œäº†ä¸€äº›æ–¹æ³•<br><br>ä½¿ç”¨ç¬¬ä¸€ç§<br><br>useCallback(()=&gt;{<br>    setLoading(true)  <br>    fetch(&#39;http:xxx&#39;).then((res)=&gt;{<br>        setList(res)<br>        setLoading(false) <br>    }).catch(()=&gt;{<br>        setError(true) <br>    })<br>})<br><br><br>ä½¿ç”¨ç¬¬äºŒç§<br>useCallback(()=&gt;{<br>    setState({...state,loading:true})  <br>    fetch(&#39;http:xxx&#39;).then((res)=&gt;{<br>        setState({...state,loading:false,list:res})  <br>    }).catch(()=&gt;{<br>        setState({...state,error:true})  <br>    })<br>})<br><br>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ç§æ–¹æ³•åœ¨  fetch(&#39;http:xxx&#39;) å®Œä¹‹åæœ‰ä¸¤æ­¥æ“ä½œï¼Œä»¥ä¸ºå‡½æ•°è¦è¿è¡Œä¸¤éï¼Œå¦‚æœé‡‡ç”¨ç¬¬äºŒç§å‡½æ•°åªéœ€è¦æ‰§è¡Œä¸€éï¼Œæ˜¯ä¸æ˜¯ç¬¬äºŒç§çš„ç»„ç»‡æ–¹å¼æ›´å¥½å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2003923,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/93/d3/97497cbe.jpg","nickname":"OriX","note":"","ucode":"EEC1CF06115CD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387656,"discussion_content":"å¤šstateä¸”stateäº’ç›¸å½±å“çš„æ—¶å€™,å¯ä»¥ä½¿ç”¨useReducer æ¥ä»£æ›¿,ä¼šæ›´å¥½äº›å“¦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628324798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299352,"user_name":"JuntÃ­ng","can_delete":false,"product_type":"c1","uid":1039290,"ip_address":"","ucode":"F6A3B528D6F3FD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/db/ba/304a9a4a.jpg","comment_is_top":false,"comment_ctime":1624591005,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1624591005","product_id":100079901,"comment_content":"SearchBox æœ¬è´¨ä¸Šè¿˜æ˜¯ç»´æŠ¤äº†ä¸€ä¸ª searchKey çš„çŠ¶æ€ï¼Œåªæ˜¯é€šè¿‡æå–è®© useSearchParam è¿™ä¸ª hook å»ç»´æŠ¤äº†ï¼ŒSearchBox ç»„ä»¶ä¸éœ€è¦å»å…³æ³¨äº†ã€‚","like_count":0,"discussions":[{"author":{"id":2377130,"avatar":"","nickname":"Geek_0330fe","note":"","ucode":"3324AF1AD2DC8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384390,"discussion_content":"æ­£æ˜¯æˆ‘çœ‹åˆ°æ–‡ç« åæƒ³è¯´çš„ï¼ŒçŠ¶æ€å®é™…ä¸Šä¸æ˜¯æ¶ˆå¤±åªä¼šè½¬ç§»ã€‚ä½†æ˜¯æŒ‰ç…§è€å¸ˆä¿®æ”¹åçš„æ€è·¯ï¼Œç¡®å®æ•°æ®æµæ›´æ¸…æ™°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626558100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200447,"avatar":"https://static001.geekbang.org/account/avatar/00/12/51/3f/41c68054.jpg","nickname":"æˆ‘è¦çš„é£ç¿”","note":"","ucode":"41C51DBC8372BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381454,"discussion_content":"ç¡®å®æ˜¯ï¼Œä½†æ˜¯useSearchParamè¿™ä¸ªhookçš„stateä¹Ÿåªæ˜¯é€šè¿‡ç›‘å¬urlæ¥æ”¹å˜ï¼Œæ‰€ä»¥è¿˜æ˜¯ç¡®ä¿äº†å”¯ä¸€æ•°æ®æºï¼Œè¿™ä¸ªæ€è·¯æ²¡é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625062214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}