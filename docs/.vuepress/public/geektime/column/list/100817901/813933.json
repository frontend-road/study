{"id":813933,"title":"14｜模糊检索：支持模糊检索，让RAG应用如虎添翼","content":"<p>你好，我是叶伟民。</p><p>现在我们已经讲解过两个实战案例了，相信你对RAG的应用也更加熟悉了。但是这两个实战案例都只支持精确检索，不支持模糊检索。</p><p>以实战案例1为例，我们输入“客户广州神机妙算有限公司的款项到账了多少？”，此时系统能够根据关键词“广州神机妙算有限公司”精确检索到相关数据。</p><p>但是如果不输入公司全名，只输入“广州神机妙算的款项到账了多少？”。那么系统则无法根据“广州神机妙算”模糊检索到相关数据。</p><p>实战案例2也同样，目前我们只能查看今天、昨天、前天的IT新闻，还不能只查看AI类的新闻。其中按日期检索IT新闻属于精确检索，而按类别，比如检索AI类的新闻则属于模糊检索。</p><p>但是在现实工作中，需要支持模糊检索的场景很多。因此仅仅掌握精确检索知识的技术是不够的，还需要掌握模糊检索知识的技术。我们从这节课开始就来学习模糊检索。</p><p>为了帮你更全面地了解模糊检索知识的技术，我们这一章的实战案例选择了工单辅助系统，这个案例将会以模糊检索知识为核心。</p><h2>实战案例3成果展示</h2><p>我们先来看看实战案例3的成果。在案例界面呈现这个部分，我们将沿用实战案例1的代码。也就是说实战案例3的界面跟实战案例1是一样的。</p><p>然后在它的基础上，再添加三块功能。</p><!-- [[[read_end]]] --><p>第一块功能我们从前端是看不见的，但却是最关键的，就是<strong>支持模糊检索功能</strong>。</p><p>第二块功能是我们经常看见的，给出参考链接的功能。具体效果如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/07/6b47979e1ace5803ef0d7b96cae75307.jpg?wh=2592x889\" alt=\"\"></p><p>第三块功能也是我们经常看见的，用户可以点击按钮给予反馈，另外还提供了复制功能，具体效果如下图所示。</p><p><img src=\"https://static001.geekbang.org/resource/image/b2/b8/b29506ebed3c9e00f8f6e4731104f3b8.jpg?wh=2608x845\" alt=\"\"></p><h2>知识点拆解</h2><p>了解了要实现的功能，我们再来看看实战案例3要用到的知识点有哪些。</p><p>模糊检索知识主要分三步，分别是：</p><ol>\n<li>将知识编码成向量，并且保存起来。（第15节课 向量与嵌入模型）</li>\n<li>将用户问题编码成向量。（第16节课 向量数据库）</li>\n<li>然后根据两者的相似度进行检索。（第17节课 通过相似度来检索知识）</li>\n</ol><p>首先我们会讲解一下什么是向量，以及如何将知识和用户问题编码成向量。然后我们会讲解如何保存和检索向量。了解了这两个基础概念之后，我们就可以根据知识和用户问题的向量相似度进行检索了。</p><p>之后，我们就能开始动手实战。我们首先会基于学到的基础概念改造实战案例1，以支持模糊检索。然后完成实战案例3。</p><h2>选择合适自己的RAG应用立项</h2><p>目前来讲，网络上讲得最多的RAG应用是客服系统。那么，为什么我们选择工单辅助系统而不是客服系统做为实战案例呢？主要是后面这几点考量。</p><p>首先，其实这个工单辅助系统本质上就是客服系统。相比于面向大众用户，一旦出错就会带来较大影响的客服系统，我们这个工单辅助系统面向企业内部用户，一旦出错，影响较小，最多就是企业内部矛盾。</p><p>其次，因为模糊检索知识想做到十分精确，需要花很多功夫。这些功夫仅仅通过一门课是远远不能涵盖的。那在此之前，我们就不做RAG应用了吗？</p><p>当然不是，学习学习，既要学也要习。结合我的RAG应用开发路径，推荐你用<strong>边学边做</strong>的方法来稳步推进。</p><p>因此我们采用以下思路——就像任何程序都会有bug一样，RAG应用也是程序，同样也会有bug，检索知识不精确也是bug的一种。我们所能做到的，就是将bug带来的影响降到最小。</p><p>因此在学习的早期阶段，我们先选择一旦出错，影响更小的工单辅助系统作为同学们的学习案例，而没有选择一旦出错，影响比较大的客服系统。等你的RAG能力到了一定水平，我们再考虑技术难度高的RAG应用。</p><p>这里就引申出一个话题，在现实工作中，如何选择合适自己的RAG应用立项？</p><p>结合我的经验，主要有四个基础和一个原则。</p><p>我们先来看四个基础。</p><p>第一，要明白所使用的<strong>大模型的能力边界</strong>。知道自己所使用的大模型能干什么，不能干什么。这一点可能对于目前的你还有点难，但是下一点就比较容易做到了。</p><p>第二，要明白<strong>自己当前的能力边界</strong>。同学们可以根据自己所掌握的技术点，还有这门课里提供的三个实战案例实现的RAG应用，来评估自己能做什么样的RAG应用，不能做什么样的RAG应用。</p><p>第三，从<strong>实用和业务角度</strong>出发。业务价值比较大的RAG应用技术难度不一定高，说不定还很容易实现。技术难度高的RAG应用，业务价值不一定高。我们先前讲实战案例1的时候，就讨论过用RAG改造系统所带来的收益，这种思路在你推动其他RAG项目的时候也可以借鉴。</p><p>第四，<strong>求稳为上</strong>。如果对大模型和自己的能力没有信心，那么选择一旦出错，影响更小的RAG应用会更稳妥。</p><p>结合这四个基础，就得到了RAG理想的一个原则——我们要根据自己当前的能力边界，选择技术难度低、业务价值高的RAG应用立项，而且要尽量选择一旦出错，影响更小的RAG应用。</p><h2>小结</h2><p>好了，今天这一讲到这里就结束了，最后我们来回顾一下。这一讲我们学会了三件事情。</p><p>第一件事情是如果要针对更多的场景开发RAG应用，我们仅仅会精确检索知识是不够的，很多场景需要模糊检索知识。以实战案例1为例，如果用户没有输入客户公司全名，我们也能根据简称从数据库里面模糊检索出对应的数据。</p><p>第二件事情是模糊检索知识主要分三步。分别是将知识编码成向量，将用户问题编码成向量，然后根据两者的相似度进行检索。</p><p>第三件事情是在现实工作中，建议根据四个基础和一个原则选择合适自己的RAG应用立项。我们要根据自己当前的能力边界，选择<strong>技术难度低、业务价值高的RAG应用</strong>立项，而且要尽量选择一旦出错，影响更小的RAG应用。</p><p>下一节课我们将会学习向量与嵌入模型，这是把知识和用户问题编码成向量的重要概念，敬请期待。</p><h2>思考题</h2><p>请同学们发挥自己的想象力，想象一下自己工作中有哪些RAG应用场景会是业务价值比较大，技术难度比较低的？业务价值具体是什么，会有多大？会用到哪些技术点，会有多难？</p><p>欢迎你在留言区和我交流互动，如果这节课对你有启发，也推荐分享给身边更多朋友。</p>","neighbors":{"left":{"article_title":"加餐1｜前两章课后题答案","id":813827},"right":{"article_title":"15｜向量与嵌入模型：揭秘人类与机器语言转化的奥秘","id":813934}},"comments":[{"had_liked":false,"id":394886,"user_name":"花花Binki","can_delete":false,"product_type":"c1","uid":2152448,"ip_address":"辽宁","ucode":"79F32B3953D83E","user_header":"https://static001.geekbang.org/account/avatar/00/20/d8/00/bbf2f87d.jpg","comment_is_top":false,"comment_ctime":1728653174,"is_pvip":false,"replies":[{"id":143515,"content":"赞👍","user_name":"作者回复","user_name_real":"编辑","uid":1337319,"ctime":1730263031,"ip_address":"广东","comment_id":394886,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100817901,"comment_content":"CMS吧，快速检索文档和知识库对于创作者来说，很有帮助。","like_count":0,"discussions":[{"author":{"id":1337319,"avatar":"https://static001.geekbang.org/account/avatar/00/14/67/e7/0d92745d.jpg","nickname":"Billy火炎焱燚(不羁的风)","note":"","ucode":"63DED1EB2CF6AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653110,"discussion_content":"赞👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1730263032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394830,"user_name":"峰回路转","can_delete":false,"product_type":"c1","uid":1217230,"ip_address":"浙江","ucode":"59B9805D7C2D92","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/ce/9d24cb2c.jpg","comment_is_top":false,"comment_ctime":1728527397,"is_pvip":false,"replies":[{"id":143516,"content":"不能","user_name":"作者回复","user_name_real":"编辑","uid":1337319,"ctime":1730263050,"ip_address":"广东","comment_id":394830,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100817901,"comment_content":"叶老师 加密后的数据 可以使用向量数据库进行模糊搜索吗","like_count":0,"discussions":[{"author":{"id":1337319,"avatar":"https://static001.geekbang.org/account/avatar/00/14/67/e7/0d92745d.jpg","nickname":"Billy火炎焱燚(不羁的风)","note":"","ucode":"63DED1EB2CF6AE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653111,"discussion_content":"不能","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1730263050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394763,"user_name":"痴痴笑笑(Bruce)","can_delete":false,"product_type":"c1","uid":1355659,"ip_address":"上海","ucode":"569D7B23A91130","user_header":"https://static001.geekbang.org/account/avatar/00/14/af/8b/0a2fdaa4.jpg","comment_is_top":false,"comment_ctime":1728190520,"is_pvip":false,"replies":[{"id":143631,"content":"目前已经结课啦","user_name":"编辑回复","user_name_real":"编辑","uid":1501385,"ctime":1731397469,"ip_address":"北京","comment_id":394763,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100817901,"comment_content":"还有更新吗？","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"听水的湖","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653684,"discussion_content":"目前已经结课啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1731397469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395531,"user_name":"kevin","can_delete":false,"product_type":"c1","uid":3920101,"ip_address":"广东","ucode":"19E83C631DF25E","user_header":"https://static001.geekbang.org/account/avatar/00/3b/d0/e5/0a3ee17c.jpg","comment_is_top":false,"comment_ctime":1731120580,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100817901,"comment_content":"各种家用电器的操作小助手，比如说路由器助手就可以回答用户提出的任何操作问题。","like_count":0}]}