{"id":793385,"title":"05ï½œK8sæœ€å°éƒ¨ç½²èµ„æºå¯¹è±¡Pod","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é›ªé£ã€‚</p><p>ä¸Šä¸€è¯¾æˆ‘ä»¬å­¦ä¹ äº† YAML æ–‡ä»¶çš„ç›¸å…³çŸ¥è¯†ï¼ŒåŒæ—¶åŠ¨æ‰‹ç¼–å†™äº† YAML æ–‡ä»¶ï¼Œç°åœ¨ä½ å°±å¯ä»¥ä½¿ç”¨ YAML æ–‡ä»¶æ¥ä¸ K8s é›†ç¾¤æ²Ÿé€šï¼Œä»è€Œå®ç°åº”ç”¨éƒ¨ç½²å’Œé›†ç¾¤ç®¡ç†çš„éœ€æ±‚ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘å°†ç»§ç»­æ·±å…¥ä»‹ç» K8s ä¸­å¸¸ç”¨çš„èµ„æºå¯¹è±¡ï¼Œè¿™äº›èµ„æºå¯¹è±¡æä¾›äº†åº”ç”¨éƒ¨ç½²ã€å‚æ•°é…ç½®ã€ç½‘ç»œè®¿é—®ã€æŒä¹…åŒ–å­˜å‚¨ã€å®‰å…¨ç­–ç•¥ç­‰ç­‰åŠŸèƒ½ï¼Œæ»¡è¶³å„ç§å®é™…çš„åº”ç”¨åœºæ™¯ã€‚å¯¹äº K8s èµ„æºå¯¹è±¡çš„ç®¡ç†ï¼Œæˆ‘ä¼šåŒæ—¶ä½¿ç”¨ kubectl å‘½ä»¤å’Œ YAML æ–‡ä»¶è¿™ä¸¤ç§æ–¹å¼æ¥åŠ æ·±ä½ çš„ç†è§£å’Œè®°å¿†ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ç»™ä½ è®²ä¸€ä¸‹ K8s ä¸­æœ€æ ¸å¿ƒçš„èµ„æºå¯¹è±¡â€”â€”Podï¼Œå®ƒæ˜¯ K8s ç®¡ç†çš„æœ€å°å¯éƒ¨ç½²èµ„æºå¯¹è±¡ã€‚å…¶ä»–å¾ˆå¤šèµ„æºå¯¹è±¡éƒ½æ˜¯åŸºäº Pod æ¥å®ç°æ›´å¤æ‚çš„åº”ç”¨éƒ¨ç½²å’Œç®¡ç†ã€‚ä¾‹å¦‚ï¼ŒDeployment å°±æ˜¯é€šè¿‡ç®¡ç†å¤šä¸ª Pod æ¥å®ç°åº”ç”¨çš„é«˜å¯ç”¨æ€§å’Œæ»šåŠ¨æ›´æ–°ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Podã€‚</p><h2>è®¤è¯† Pod</h2><p>Pod çš„ä¸­æ–‡æ„æ€ä¸ºè±Œè±†èšï¼Œå› ä¸º Pod ä¸­åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œå®¹å™¨å’Œ Pod çš„å…³ç³»å¾ˆåƒè±Œè±†å’Œè±†èšçš„å…³ç³»ï¼Œæ‰€ä»¥è¿™å°±æ˜¯ Pod åç§°çš„æ¥å†ã€‚åœ¨ K8s ä¸­ï¼ŒPod æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µï¼Œè€Œå®¹å™¨æ‰æ˜¯è¿è¡Œç€åº”ç”¨é•œåƒçš„å®é™…è½½ä½“ï¼Œé‚£ä¸ºå•¥ K8s ä¸ç›´æ¥ç®¡ç†å®¹å™¨ï¼Œè€Œæ˜¯è¿˜è¦æå‡ºä¸€ä¸ª Pod å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/a9/04/a9059aeyyc92yyffbc54897809a49e04.jpg?wh=300x205\" alt=\"å›¾ç‰‡\"></p><p>æœ€é‡è¦çš„åŸå› å°±æ˜¯ï¼šåœ¨ä¸€äº›å¸¸è§çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œå®¹å™¨å¹¶ä¸æ˜¯å­¤é›¶é›¶çš„å­˜åœ¨ï¼Œå®ƒå¯èƒ½ä¼šè·Ÿå…¶ä»–å®¹å™¨ä¹‹é—´æœ‰ç€å¾ˆäº²å¯†çš„å…³ç³»ï¼Œå®ƒä»¬ç›¸äº’åä½œï¼Œä¸€èµ·å¯åŠ¨ï¼Œä¸€èµ·åœæ­¢ï¼Œä¸€èµ·æä¾›æœåŠ¡ï¼ŒåŒæ—¶å®ƒä»¬éœ€è¦å½¼æ­¤é—´å¯ä»¥æ–¹ä¾¿çš„é€šä¿¡ä»¥åŠè®¿é—®ç›¸åŒçš„æ•°æ®ã€‚æ‰€ä»¥ K8s å°±åœ¨å®¹å™¨çš„åŸºç¡€ä¸Šåˆ›å»ºäº† Pod è¿™ä¸ªæ›´é«˜å±‚çº§çš„èµ„æºå¯¹è±¡ï¼ŒPod å¯ä»¥å°†å¤šä¸ªå®¹å™¨ç»„åˆåˆ°ä¸€èµ·éƒ¨ç½²å’Œç®¡ç†ï¼ŒåŒä¸€ Pod ä¸­çš„å®¹å™¨å¯ä»¥å…±äº«ç½‘ç»œå’Œå­˜å‚¨ç©ºé—´ï¼Œè¿™ç§æœºåˆ¶ä¿è¯äº†å¯¹å®¹å™¨ç®¡ç†çš„ä¸€è‡´æ€§å’Œçµæ´»æ€§ã€‚</p><!-- [[[read_end]]] --><p>ä¸¾ä¸ªå…·ä½“ä¾‹å­ï¼Œ Pod ä¸­å¤šå®¹å™¨å¸¸ç”¨äºè¾¹è½¦æ¨¡å¼ï¼ˆSidecarï¼‰ï¼Œè¿™ç§æ¨¡å¼åŒ…å«ä¸»å®¹å™¨å’Œè¾…åŠ©å®¹å™¨ï¼Œä¸»å®¹å™¨è¿è¡Œæ ¸å¿ƒä¸šåŠ¡åº”ç”¨ï¼Œè€Œè¾…åŠ©å®¹å™¨åˆ™è´Ÿè´£æ—¥å¿—æ”¶é›†ã€ç›‘æ§ç­‰ä»»åŠ¡ï¼Œåœ¨ä¸å½±å“ä¸»ä¸šåŠ¡çš„æƒ…å†µä¸‹æ‰©å±•äº†åº”ç”¨åŠŸèƒ½ã€‚è¿™ç§å…³ç³»ç±»ä¼¼ä¸‰è½®æ‘©æ‰˜è½¦ï¼Œåœ¨æ‘©æ‰˜è½¦çš„ä¸€ä¾§åŠ è£…ä¸€ä¸ªè¾¹è½¦æ¥å¢åŠ é¢å¤–çš„ç©ºé—´ï¼Œæ‰€ä»¥è¢«å«åšè¾¹è½¦æ¨¡å¼ã€‚æ­¤å¤–ï¼Œæ–°ä¸€ä»£ Service Meshï¼ˆæœåŠ¡ç½‘æ ¼ï¼‰æŠ€æœ¯ä¹Ÿåˆ©ç”¨äº†è¿™ç§è¾¹è½¦æ¨¡å¼æ¥å¢å¼ºæœåŠ¡é—´çš„é€šä¿¡å’Œç®¡ç†èƒ½åŠ›ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/51/6e/51309a427a528f3644ea54de17108a6e.jpg?wh=1190x466\" alt=\"\"></p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒPod å¯ä»¥åŒ…å«ä¸€ä¸ªå®¹å™¨ä¹Ÿå¯ä»¥åŒ…å«å¤šä¸ªå®¹å™¨ï¼Œéå¸¸çµæ´»ã€‚å¯¹äºå¤šä¸ªå®¹å™¨ï¼ŒPod å®ç°äº†å®¹å™¨é—´å…±äº«ç½‘ç»œå’Œå­˜å‚¨ç©ºé—´çš„æœºåˆ¶ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹ Pod æ˜¯å¦‚ä½•å®ç°è¿™ä¸¤ç§æœºåˆ¶ã€‚</p><h3>å…±äº«ç½‘ç»œ</h3><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹ Pod ä¸­å®¹å™¨å…±äº«ç½‘ç»œçš„æœºåˆ¶ã€‚K8s ä½¿ç”¨äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥å®ç°å…±äº«ç½‘ç»œï¼Œé‚£å°±æ˜¯åœ¨ Pod ä¸­çš„å®¹å™¨å¯åŠ¨ä¹‹å‰ï¼Œå…ˆè‡ªåŠ¨è¿è¡Œä¸€ä¸ª Infra Containerï¼ˆåŸºç¡€å®¹å™¨ï¼‰ï¼Œè¿™ä¸ªå®¹å™¨è¿è¡Œäº†ä¸€ä¸ªéå¸¸å°çš„é•œåƒï¼Œå¤§æ¦‚å‡ ç™¾ KBï¼Œæ˜¯ä¸€ä¸ª C è¯­è¨€å†™çš„æ°¸è¿œå¤„äº pauseï¼ˆæš‚åœï¼‰çŠ¶æ€çš„å®¹å™¨ï¼Œåˆå« pause å®¹å™¨ã€‚ç„¶åï¼Œå½“ Pod ä¸­çš„å…¶ä»–å®¹å™¨å¯åŠ¨æ—¶ï¼Œå®ƒä»¬éƒ½ä¼šåŠ å…¥åˆ° Infra Container çš„ç½‘ç»œä¸­ï¼Œä»è€Œä½¿ç”¨ Infra Container çš„ç½‘ç»œä¸­çš„ç½‘ç»œè®¾å¤‡ã€IP åœ°å€ç­‰ç½‘ç»œç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™æ ·å°±å®ç°äº†å®¹å™¨ä¹‹é—´å…±äº«ç½‘ç»œã€‚è¿™æœ‰ç‚¹åƒæ˜¯ä¸€ä¸ªç”µè„‘ä¸ŠåŒæ—¶æœ‰ä¸¤ä¸ªç½‘ç»œåº”ç”¨ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨è¿™ä¸ªç”µè„‘çš„åŒä¸€å—ç½‘å¡æ¥å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œæ‰€ä»¥é€šè¿‡ localhost ä¹Ÿå°±èƒ½ç›¸äº’è®¿é—®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3d/5d/3dc9921ef04eda18ed56b268yy5c8c5d.jpg?wh=1030x520\" alt=\"\"></p><h3>å…±äº«å­˜å‚¨</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹ Pod ä¸­å¤šä¸ªå®¹å™¨å…±äº«å­˜å‚¨ï¼ŒPod æ˜¯é€šè¿‡å¤šä¸ªå®¹å™¨æŒ‚è½½å…±åŒçš„æ•°æ®å· Volumeï¼ˆæ•°æ®å·ï¼‰æ¥å®ç°å…±äº«å­˜å‚¨çš„ã€‚ä½ å¯ä»¥æŠŠæ•°æ®å·æƒ³è±¡æˆä¸€ä¸ªå…±äº«ç½‘ç›˜ï¼ŒPod ä¸­çš„å®¹å™¨éƒ½å¯ä»¥é€šè¿‡å®ƒæ¥å­˜å–æ–‡ä»¶ã€‚ä¾‹å¦‚ä¹‹å‰è¯´åˆ°çš„è¾¹è½¦æ¨¡å¼ï¼Œä¸»å®¹å™¨å¯ä»¥å°†æ—¥å¿—æ–‡ä»¶å†™åˆ°å…±äº«å­˜å‚¨ç©ºé—´ï¼Œç„¶åè¾¹è½¦å®¹å™¨å¯ä»¥ç›´æ¥è¯»å–å…±äº«å­˜å‚¨ç©ºé—´çš„æ–‡ä»¶æ¥è·å–æ—¥å¿—ä¿¡æ¯ï¼Œä»è€Œå®ç°ä¸šåŠ¡åŠŸèƒ½å’Œç»Ÿè®¡åˆ†æåŠŸèƒ½çš„åˆ†ç¦»ï¼Œå°±åƒä¸¤ä¸ªåŒäº‹å…±ç”¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸€æ ·æ–¹ä¾¿ã€‚è¿™æ ·ï¼Œä¸ä»…èƒ½è®©å„ä¸ªå®¹å™¨å„å¸å…¶èŒï¼Œè¿˜èƒ½è®©æ•´ä¸ªç³»ç»Ÿæ›´åŠ çµæ´»å’Œæ˜“äºç®¡ç†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/68/1e/6829b76c9fccfa89ac36154c7499e11e.jpg?wh=1004x546\" alt=\"\"></p><h3><strong>éƒ¨ç½²ä¸€ä¸ªå¤šå®¹å™¨çš„ Pod</strong></h3><p>äº†è§£äº† Pod çš„å…±äº«åŸç†ï¼Œä¸‹é¢æˆ‘ä»¬å°±åŠ¨æ‰‹éƒ¨ç½²ä¸€ä¸ªå¤šå®¹å™¨çš„ Podï¼Œæ¥éªŒè¯ä¸€ä¸‹å®¹å™¨é—´çš„å…±äº«ç½‘ç»œå’Œå…±äº«å­˜å‚¨ã€‚éƒ¨ç½²å¤šå®¹å™¨çš„ Pod æ˜¯ CKA è€ƒè¯•çš„æ ¸å¿ƒè€ƒç‚¹ï¼Œè€ƒè¯•ä¸­éœ€è¦ç”¨ YAML æ–‡ä»¶çš„æ–¹å¼éƒ¨ç½² Podï¼Œæ‰€ä»¥ä½ è¦äº†è§£è¿™ä¸ª YAML æ–‡ä»¶çš„å†™æ³•ã€‚</p><p>é¦–å…ˆï¼Œç¼–å†™ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå®¹å™¨çš„ Pod çš„ YAML æ–‡ä»¶ï¼ˆtwo_container_pod.yamlï¼‰ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ Web æœåŠ¡åº”ç”¨ Nginxï¼Œå¦ä¸€ä¸ªæ˜¯ Busyboxã€‚Busybox æ˜¯ä¸€ä¸ªå·¥å…·é•œåƒï¼Œå…¶ä¸­åŒ…å«äº† Linux ç³»ç»Ÿå‘½ä»¤è¡Œå·¥å…·ï¼Œåœ¨Busyboxå®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œäº†ä¸€æ¡ sleep ä¼‘çœ å‘½ä»¤ï¼Œç”¨äºä¿æŒå®¹å™¨æŒç»­è¿è¡Œã€‚</p><p><strong>æ³¨æ„ï¼š</strong>è¯¾ç¨‹ä¸­çš„ä¾‹å­æˆ‘éƒ½æ”¾åˆ°äº†å…¬å¼€çš„ <a href=\"https://github.com/wwwangxuefei/cka.git\">GitHub ä»“åº“</a>ä¸­ä¾›ä½ å‚è€ƒï¼Œä½ å¯ä»¥ä½¿ç”¨ Git å·¥å…·æŠŠä»“åº“æ‹‰åˆ°æœ¬åœ°æŸ¥çœ‹ç¤ºä¾‹ã€‚</p><p>æˆ‘åœ¨ Pod çš„ spec å±æ€§é‡Œåˆ›å»ºäº†ä¸€ä¸ªåä¸º data çš„æœ¬åœ°ä¸´æ—¶ Volumeï¼ˆæ•°æ®å·ç±»å‹æ˜¯ emptyDirï¼‰ï¼ŒåŒæ—¶åœ¨ Pod çš„æ¯ä¸ªå®¹å™¨ä¸­éƒ½æŒ‚è½½äº†è¿™ä¸ª Volumeã€‚</p><pre><code class=\"language-yaml\"># two_container_pod.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n&nbsp; name: test\nspec:\n&nbsp; containers:\n  - image: nginx\n    name: nginx\n    volumeMounts:   # å®¹å™¨ Nginx æŒ‚è½½ Volume\n    - name: data\n      mountPath: /data\n&nbsp; - image: busybox\n&nbsp; &nbsp; name: busybox\n&nbsp; &nbsp; command: [\"/bin/sh\",\"-c\",\"sleep 3600\"]\n&nbsp; &nbsp; volumeMounts:   # å®¹å™¨ Busybox æŒ‚è½½ Volume\n&nbsp; &nbsp; - name: data\n&nbsp; &nbsp; &nbsp; mountPath: /data\n&nbsp; volumes:          # å®šä¹‰äº†ä¸€ä¸ªä¸´æ—¶ Volume\n&nbsp; - name: data\n    emptyDir: {}\n</code></pre><p>ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤éƒ¨ç½² YAML æ–‡ä»¶ï¼Œç­‰å¾… Pod è¿è¡ŒæˆåŠŸã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# kubectl apply -f two_container_pod.yaml&nbsp;\npod/test created\n</code></pre><p>é€šè¿‡ â€œkubectl get pod -o wideâ€ å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ Pod éƒ¨ç½²çš„è¯¦ç»†åˆ—è¡¨ä¿¡æ¯ã€‚æ­¤æ—¶ï¼Œå¯ä»¥çœ‹åˆ° Pod å·²ç»æˆåŠŸéƒ¨ç½²åˆ°äº† k8s-worker1 èŠ‚ç‚¹ä¸Šã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# kubectl get pod -o wide\nNAME&nbsp; READY&nbsp; STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE&nbsp; &nbsp;IP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NODE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOMINATED NODE&nbsp; &nbsp;READINESS GATES\ntest&nbsp; 2/2&nbsp; &nbsp; Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 92s&nbsp; &nbsp;10.244.194.68&nbsp; &nbsp;k8s-worker1&nbsp; &nbsp;&lt;none&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;none&gt;\n</code></pre><p><strong>1. éªŒè¯å…±äº«ç½‘ç»œ</strong></p><p>æˆ‘ä»¬è¿œç¨‹ç™»å½•åˆ° k8s-worker1 èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä½¿ç”¨ â€œdocker psâ€ å‘½ä»¤æŸ¥çœ‹èŠ‚ç‚¹ä¸Šæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤åœ¨ k8s-worker1 èŠ‚ç‚¹ä¸Šè¿è¡Œç€ pause å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯æä¾›å…±äº«ç½‘ç»œçš„ Infra Containerã€‚</p><pre><code class=\"language-bash\">[root@k8s-worker1 ~]# docker ps | grep test\naab5e75d353f&nbsp; &nbsp;busybox&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"/bin/sh -c 'sleep 3â€¦\"&nbsp; &nbsp;5 minutes ago&nbsp; &nbsp; &nbsp; &nbsp;Up 5 minutes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;k8s_busybox_test_default_e20592c1-79fa-41f7-9f1a-f79e851db4dc_0\n87a6c4de517d&nbsp; &nbsp;nginx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"/docker-entrypoint.â€¦\"&nbsp; &nbsp;6 minutes ago&nbsp; &nbsp; &nbsp; &nbsp;Up 5 minutes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;k8s_nginx_test_default_e20592c1-79fa-41f7-9f1a-f79e851db4dc_0\n438f772319e5&nbsp; &nbsp;registry.aliyuncs.com/google_containers/pause:3.9&nbsp; &nbsp; \"/pause\"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6 minutes ago&nbsp; &nbsp; &nbsp; &nbsp;Up 6 minutes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;k8s_POD_test_default_e20592c1-79fa-41f7-9f1a-f79e851db4dc_0\n</code></pre><p>å›åˆ° Master èŠ‚ç‚¹ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ â€œkubectl exec -itâ€ å‘½ä»¤è¿›å…¥ Busybox å®¹å™¨å†…éƒ¨ã€‚</p><pre><code class=\"language-bash\">kubectl exec -it test -c busybox -- sh\n</code></pre><ul>\n<li><strong>-itï¼š</strong>è¡¨ç¤ºä½¿ç”¨ç»ˆç«¯åº”ç”¨ä½œä¸ºè®¿é—®å®¹å™¨çš„æ ‡å‡†è¾“å…¥ã€‚</li>\n<li><strong>-cï¼š</strong>è¡¨ç¤ºè¦è¿›å…¥çš„å®¹å™¨åç§°ï¼Œå¦‚æœ Pod é‡Œåªæœ‰ä¸€ä¸ªå®¹å™¨ï¼Œå°±ä¸éœ€è¦è¿™ä¸ªå‚æ•°ã€‚</li>\n<li><strong>-- shï¼š</strong>è¡¨ç¤ºè¿›å…¥å®¹å™¨ä¹‹åæ‰“å¼€ shell ç»ˆç«¯åº”ç”¨ã€‚</li>\n</ul><p>Nginx å®¹å™¨éƒ¨ç½²æˆåŠŸåï¼Œå°±ä¼šå¯åŠ¨äº†ä¸€ä¸ª Web æœåŠ¡ï¼Œè®¿é—® Nginx å®¹å™¨çš„ 80 ç«¯å£ï¼Œå°±å¯ä»¥è®¿é—®åˆ°å®ƒçš„é»˜è®¤ â€œindex.htmlâ€ æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ Busybox å®¹å™¨çš„ç»ˆç«¯åº”ç”¨ä¸­ï¼Œä½¿ç”¨ wget å‘½ä»¤æ¥è¯·æ±‚æœ¬åœ°ç½‘ç»œåœ°å€ Localhost çš„ 80 ç«¯å£ï¼Œè¿™ä¸ªå‘½ä»¤é€šå¸¸ç”¨æ¥è¿œç¨‹è·å–æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° wget å‘½ä»¤è·å–åˆ°äº† Nginx å®¹å™¨çš„ 80 ç«¯å£è¿”å›çš„ â€œindex.htmlâ€ æ–‡ä»¶ï¼Œè¿™è¯æ˜äº†ä¸¤ä¸ªå®¹å™¨å…±äº«åŒä¸€ä¸ªç½‘ç»œç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ Localhost åœ°å€äº’ç›¸é€šä¿¡ã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# kubectl exec -it test -c busybox -- sh\n/ # wget localhost:80\nConnecting to localhost:80 (127.0.0.1:80)\nsaving to 'index.html'\nindex.html&nbsp; &nbsp; 100% |****************************|&nbsp; &nbsp;615&nbsp; 0:00:00 ETA\n'index.html' saved\n</code></pre><p><strong>2. éªŒè¯å…±äº«å­˜å‚¨</strong></p><p>æˆ‘ä»¬ç»§ç»­åœ¨ Busybox å®¹å™¨å†…ï¼Œè¿›å…¥åˆ° â€œ/dataâ€ ç›®å½•ï¼Œè¿™ä¸ªå°±æ˜¯å®¹å™¨æŒ‚è½½æ•°æ®å·çš„ç›®å½•ï¼Œåœ¨è¿™ä¸ªç›®å½•å†…åˆ›å»ºä¸€ä¸ªå†…å®¹ä¸º â€œHello, I am Busyboxâ€ çš„æ–‡æœ¬æ–‡ä»¶ï¼ˆhello.txtï¼‰ã€‚</p><pre><code class=\"language-bash\">/ # cd /data\n/ # echo \"Hello, I am Busybox\" &gt; hello.txt\n</code></pre><p>ç„¶åé€€å‡º Busybox å®¹å™¨ã€‚åªéœ€è¾“å…¥ exit å‘½ä»¤ï¼Œå°±å¯ä»¥å›åˆ°é›†ç¾¤ Master èŠ‚ç‚¹çš„ç»ˆç«¯ã€‚</p><pre><code class=\"language-bash\">/ # exit\n[root@k8s-master ~]#\n</code></pre><p>è¿™æ—¶ï¼Œæˆ‘ä»¬å·²ç»åœ¨å…±äº«å­˜å‚¨ç©ºé—´ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç°åœ¨å°±è¦å» Nginx å®¹å™¨ä¸­å»çœ‹çœ‹æ˜¯å¦èƒ½æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ â€œkubectl exec -itâ€ å‘½ä»¤è¿›å…¥åˆ° Nginx å®¹å™¨å†…éƒ¨ï¼Œç„¶åé€šè¿‡ â€œcatâ€ å‘½ä»¤ç›´æ¥æŸ¥çœ‹ â€œ/data/hello.txtâ€ æ–‡ä»¶å†…å®¹ã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# kubectl exec -it test -c nginx -- sh\n/ # cat /data/hello.txt\nHello, I am Busybox\n</code></pre><p>æ­¤æ—¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ Nginx å®¹å™¨æŒ‚è½½çš„ â€œ/dataâ€ ç›®å½•ä¸‹ï¼Œå·²ç»å¯ä»¥è¯»å–åˆ°åœ¨ Busybox å®¹å™¨ä¸­åˆ›å»ºçš„ â€œ/data/hello.txtâ€ æ–‡ä»¶å†…å®¹äº†ã€‚è¿™è¯æ˜äº†åŒä¸€ä¸ª Pod ä¸‹çš„å¤šä¸ªå®¹å™¨é€šè¿‡æŒ‚è½½ç›¸åŒçš„æ•°æ®å· Volume å®ç°äº†å…±äº«å­˜å‚¨ç©ºé—´ã€‚</p><h2>ä½¿ç”¨ kubectl å‘½ä»¤ç®¡ç† Pod</h2><p>åˆšæ‰æˆ‘ä»¬ç”¨ YAML æ–‡ä»¶çš„æ–¹å¼æ¥åˆ›å»ºäº†å¤šå®¹å™¨çš„ Podï¼Œç„¶è€Œé€šè¿‡ kubectl å‘½ä»¤æ˜¯ä¸èƒ½ç›´æ¥åˆ›å»ºå¤šå®¹å™¨çš„ Podï¼Œå®ƒåªèƒ½åˆ›å»ºå•å®¹å™¨çš„ç®€å• Podï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºä½¿ç”¨ kubectl å‘½ä»¤ä¸ YAML æ–‡ä»¶çš„ä¸€ä¸ªåŒºåˆ«ï¼ŒYAML æ–‡ä»¶æ›´é€‚åˆå®ç°å¤æ‚çš„éƒ¨ç½²è¦æ±‚ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°±æ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Kubectl å‘½ä»¤æ¥ç®¡ç† Podã€‚</p><h3>åˆ›å»º Pod</h3><p>ä½¿ç”¨ â€œkubectl runâ€ å‘½ä»¤å¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªç®€å•çš„ Podï¼Œå‘½ä»¤åé¢å¯ä»¥æ ¹æ®ä¸åŒçš„å®¹å™¨é•œåƒåº”ç”¨ç±»å‹è€Œå¢åŠ ä¸åŒå‚æ•°ã€‚</p><pre><code class=\"language-bash\">kubectl run &lt;podåç§°&gt; --image=nginx [--port=80]\nkubectl run &lt;podåç§°&gt; --image=busybox [-- sleep 3600]\n</code></pre><ul>\n<li><strong>&lt;podåç§°&gt;</strong>ï¼šè¿™æ˜¯æ–°åˆ›å»ºçš„ Pod çš„åç§°ã€‚</li>\n<li><strong>â€“image=nginx</strong>ï¼šæŒ‡å®š Pod ä½¿ç”¨çš„å®¹å™¨é•œåƒæ˜¯ nginxã€‚</li>\n<li><strong>â€“port=80</strong>ï¼šè®¾ç½®å®¹å™¨æš´éœ²çš„ç«¯å£ä¸º 80ï¼Œå¯¹äº Web ç±»å‹åº”ç”¨ï¼Œå¤–éƒ¨è¯·æ±‚ä¼šé€šè¿‡è¯¥ç«¯å£å·è®¿é—®åˆ°å®¹å™¨ã€‚å¦‚æœä¸éœ€è¦ç«¯å£è®¿é—®ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨è¯¥å‚æ•°ã€‚</li>\n<li><strong>â€“ sleep 3600</strong>ï¼šâ€“å‚æ•°å¯ä»¥æŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™é‡Œæ˜¯æ‰§è¡Œ â€œsleep 3600â€ å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è®© Busybox å®¹å™¨ä¿æŒè¿è¡Œ3600ç§’ã€‚å¦‚æœå®¹å™¨å¯åŠ¨æ—¶ä¸éœ€è¦æ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨è¯¥å‚æ•°ã€‚</li>\n</ul><h3>æŸ¥çœ‹ Pod</h3><p>ä½¿ç”¨ â€œkubectl get podâ€ å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Pod åˆ—è¡¨ä¿¡æ¯ï¼Œç”±äº Pod çš„ç¼©å†™ï¼ˆSHORTNAMESï¼‰æ˜¯ poï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤ä¸­ä½¿ç”¨ po ä»£æ›¿ podã€‚å‘½ä»¤åé¢å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ ä¸åŒå‚æ•°ã€‚</p><pre><code class=\"language-bash\">kubectl get pod\nkubectl get pod [-o wide] [-n &lt;namespaceåç§°&gt;]\nkubectl get pod &lt;podåç§°&gt; [-o yaml]\n</code></pre><ul>\n<li><strong>-o wideï¼š</strong>ç”¨æ¥æŸ¥çœ‹åˆ°æ›´å¤šçš„ Pod ä¿¡æ¯ï¼Œä¾‹å¦‚ Pod çš„ IP åœ°å€ã€éƒ¨ç½²æ‰€åœ¨èŠ‚ç‚¹ç­‰ç­‰ã€‚</li>\n<li><strong>-n &lt;namespaceåç§°&gt;ï¼š</strong>-n å‚æ•°å¯ä»¥æŒ‡å®šå‘½åç©ºé—´åç§°ï¼Œå‘½åç©ºé—´æ˜¯å¯¹èµ„æºå¯¹è±¡çš„ä¸€ç§é€»è¾‘åˆ†ç»„éš”ç¦»æ–¹å¼ï¼ŒPod å¯ä»¥åˆ›å»ºåˆ°ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œè¿™æ—¶å°±éœ€è¦å¢åŠ  -n å‚æ•°æ¥æŒ‡å®š Pod æ‰€åœ¨çš„å‘½åç©ºé—´ï¼Œä¸åŠ  -n å‚æ•°åˆ™æ˜¯æŸ¥çœ‹é»˜è®¤å‘½åç©ºé—´ï¼ˆdefaultï¼‰ä¸‹çš„ Podã€‚</li>\n<li><strong>-o yamlï¼š</strong>ç”¨æ¥ä»¥ YAML æ–‡ä»¶çš„æ–¹å¼æŸ¥çœ‹æŒ‡å®šçš„ Podã€‚</li>\n</ul><p>ä½¿ç”¨ â€œkubectl describe podâ€ å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Pod çš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœ Pod ä¸åœ¨é»˜è®¤å‘½åç©ºé—´ï¼Œéœ€è¦ä½¿ç”¨ â€œ-nâ€ å‚æ•°æŒ‡å®š Pod æ‰€åœ¨çš„å‘½åç©ºé—´ã€‚</p><pre><code class=\"language-bash\">kubectl describe pod &lt;podåç§°&gt; [-n &lt;namespaceåç§°&gt;]\n</code></pre><p>å‘½ä»¤è¿”å›ç»“æœï¼ˆè¿”å›ä¿¡æ¯å¤ªå¤šï¼Œæˆ‘ç”¨ â€œâ€¦â€ åšäº†çœç•¥ï¼‰ä¸­çœ‹åˆ°çš„ Pod ä¿¡æ¯éå¸¸ä¸°å¯Œï¼ŒåŒ…æ‹¬åŸºç¡€ä¿¡æ¯ã€å®¹å™¨ä¿¡æ¯ã€çŠ¶æ€ä¿¡æ¯ã€æŒ‚è½½å­˜å‚¨å·ä¿¡æ¯ã€è°ƒåº¦ç­–ç•¥ä¿¡æ¯ã€äº‹ä»¶ä¿¡æ¯ç­‰ç­‰ã€‚è¿™äº›æ•°æ®å¯¹ Pod çš„æ•…éšœæ’æŸ¥éå¸¸æœ‰ç”¨ï¼Œåç»­æˆ‘ä»¬ä¹Ÿä¼šç»å¸¸ä½¿ç”¨ã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# kubectl describe pod test\nName:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;test\nNamespace:&nbsp; &nbsp; &nbsp; &nbsp; default\n......\nContainers:\n&nbsp; nginx:\n......\nConditions:\n&nbsp; Type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status\n&nbsp; Initialized&nbsp; &nbsp; &nbsp; &nbsp;True&nbsp;\n......\nVolumes:\n&nbsp; data:\n......\nQoS Class:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BestEffort\nNode-Selectors:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;none&gt;\nTolerations:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.kubernetes.io/not-ready:NoExecute op=Exists for 300s\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;node.kubernetes.io/unreachable:NoExecute op=Exists for 300s\nEvents:\n&nbsp; Type&nbsp; &nbsp; Reason&nbsp; &nbsp; &nbsp;Age&nbsp; &nbsp;From&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Message\n&nbsp; ----&nbsp; &nbsp; ------&nbsp; &nbsp; &nbsp;----&nbsp; ----&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-------\n&nbsp; Normal&nbsp; Scheduled&nbsp; 56s&nbsp; &nbsp;default-scheduler&nbsp; Successfully assigned default/test to k8s-worker1\n&nbsp; Normal&nbsp; Pulling&nbsp; &nbsp; 55s&nbsp; &nbsp;kubelet&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pulling image \"nginx\"&nbsp;&nbsp; &nbsp;\n</code></pre><h3></h3><h3>å…¶ä»–å‘½ä»¤</h3><p>ç®¡ç† Pod çš„å…¶ä»–å‘½ä»¤å‚è€ƒä»¥ä¸‹å°å¡ç‰‡ï¼Œæœ‰äº›å‘½ä»¤å·²ç»å‡ºç°è¿‡å¾ˆå¤šæ¬¡ï¼Œç›¸ä¿¡ä½ å·²ç»å¾ˆç†Ÿæ‚‰äº†ã€‚å¦‚æœ Pod ä¸åœ¨é»˜è®¤å‘½åç©ºé—´ï¼ˆdefaultï¼‰ï¼Œè¿™äº›å‘½ä»¤éƒ½éœ€è¦ä½¿ç”¨ â€œ-nâ€ å‚æ•°æŒ‡å®š Pod æ‰€åœ¨çš„å‘½åç©ºé—´ï¼Œå¦åˆ™ä¼šæç¤º Pod æ²¡æ‰¾åˆ°ã€‚</p><pre><code class=\"language-bash\">åˆ é™¤ Podï¼škubectl delete pod &lt;podåç§°&gt;\nç¼–è¾‘ Podï¼Œä¿®æ”¹ YAML æ–‡ä»¶åè‡ªåŠ¨ç”Ÿæ•ˆï¼škubectl edit pod &lt;podåç§°&gt;\nè¿›å…¥ Pod å†…éƒ¨ï¼škubectl exec -it &lt;podåç§°&gt; -- sh\næŸ¥çœ‹ Pod æ—¥å¿—ï¼škubectl logs &lt;podåç§°&gt;\n</code></pre><p>äº†è§£äº† Pod çš„å…±äº«æœºåˆ¶å’Œç›¸å…³å‘½ä»¤ï¼Œæˆ‘ä»¬å¯¹ Pod å·²ç»æœ‰äº†ä¸€ä¸ªå…¨é¢çš„è®¤è¯†ã€‚æœ€åæˆ‘å†ç»™ä½ è®²ä¸€ç§ç‰¹æ®Šçš„ Pod â€”â€” é™æ€ Podã€‚</p><h2>é™æ€ Pod</h2><p>åœ¨ K8s ä¸­ï¼Œé™æ€ Pod æ˜¯ä¸€ç§éå¸¸ç‰¹æ®Šçš„ Podï¼Œå®ƒçš„ YAML æ–‡ä»¶å°±ç›´æ¥å­˜æ”¾åœ¨é›†ç¾¤å„èŠ‚ç‚¹çš„æŒ‡å®šç›®å½•ä½ç½®ï¼ˆâ€œ/etc/kubernetes/manifestsâ€ï¼‰ï¼Œé™æ€ Pod ä¼šè‡ªåŠ¨éƒ¨ç½²ï¼Œè€Œä¸æ˜¯é€šè¿‡ K8s çš„ API Server åˆ›å»ºã€‚é™æ€ Pod é€šå¸¸ç”¨äºéƒ¨ç½²é›†ç¾¤çº§åˆ«çš„ç³»ç»Ÿç»„ä»¶ï¼Œå¦‚ K8s é›†ç¾¤è‡ªå·±çš„å¾ˆå¤šç³»ç»Ÿç»„ä»¶å°±æ˜¯é™æ€ Podï¼Œè¿™äº›ç»„ä»¶éœ€è¦åœ¨é›†ç¾¤å¯åŠ¨æ—¶å°±å¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥éšç€èŠ‚ç‚¹é‡å¯è€Œè‡ªåŠ¨é‡å¯ã€‚å¯¹äºé™æ€ Pod çš„ä»»ä½•æ›´æ–°éƒ½éœ€è¦ç®¡ç†å‘˜æ‰‹åŠ¨ä¿®æ”¹å®ƒçš„ YAML æ–‡ä»¶å¹¶é‡å¯ Podã€‚</p><p>åˆ›å»ºé™æ€ Pod ä¸éœ€è¦ä½¿ç”¨ä»»ä½•å‘½ä»¤ï¼Œåªéœ€è¦æŠŠ Pod çš„ YAML æ–‡ä»¶æ”¾åˆ°è¯¥èŠ‚ç‚¹çš„â€œ/etc/kubernetes/manifestsâ€ ç›®å½•ä¸‹ï¼ŒèŠ‚ç‚¹çš„ kubelet ç»„ä»¶å°±ä¼šè‡ªåŠ¨åˆ›å»ºé™æ€ Podã€‚å…¶å®é›†ç¾¤æ­å»ºçš„æ—¶å€™æˆ‘ä»¬å·²ç»éƒ¨ç½²äº†ä¸€äº›é™æ€ Podï¼Œæˆ‘ä»¬å°±å»çœ‹ä¸€ä¸‹å§ã€‚</p><pre><code class=\"language-bash\">[root@k8s-master ~]# cd /etc/kubernetes/manifests/\n[root@k8s-master manifests]# ls\netcd.yaml&nbsp; kube-apiserver.yaml&nbsp; kube-controller-manager.yaml&nbsp; kube-scheduler.yaml\n</code></pre><p>åœ¨ç®¡ç†èŠ‚ç‚¹ä¸Šçš„ manifests ç›®å½•ä¸­ï¼Œå¯ä»¥çœ‹åˆ° etcdã€kube-apiserverã€kube-controller-managerã€kube-scheduler è¿™äº› K8s ç»„ä»¶å°±æ˜¯ä»¥é™æ€ Pod çš„æ–¹å¼éƒ¨ç½²åˆ°é›†ç¾¤ kube-system çš„å‘½åç©ºé—´ä¸‹ã€‚</p><h2><strong>å°ç»“</strong></h2><p>ä»Šå¤©ï¼Œæˆ‘é‡ç‚¹ä»‹ç»äº† K8s ä¸­çš„æ ¸å¿ƒèµ„æºå¯¹è±¡â€”â€”Podã€‚åœ¨ K8s ä¸­ï¼ŒPod æ˜¯å®¹å™¨ç®¡ç†çš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ª Pod å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œè¿™äº›å®¹å™¨é€šè¿‡ Infra Containerï¼ˆåŸºç¡€å®¹å™¨ï¼‰å…±äº«ç½‘ç»œï¼ŒåŒæ—¶é€šè¿‡æŒ‚è½½ç›¸åŒçš„æ•°æ®å· Volume æ¥å®ç°å…±äº«å­˜å‚¨ï¼Œè¿™ä¸¤ç§æœºåˆ¶ä¿è¯äº† Pod å¯¹å®¹å™¨ç®¡ç†çš„ä¸€è‡´æ€§å’Œçµæ´»æ€§ï¼Œç®€åŒ–äº†å¯¹å®¹å™¨çš„ç®¡ç†ã€‚</p><p>æ¥ç€ï¼Œæˆ‘å¸¦ä½ ä½¿ç”¨ YAML æ–‡ä»¶çš„æ–¹å¼éƒ¨ç½²äº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå®¹å™¨çš„ Pod ï¼Œå¹¶ä¸”éªŒè¯äº† Pod çš„å…±äº«ç½‘ç»œå’Œå…±äº«å­˜å‚¨çš„æœºåˆ¶ã€‚éƒ¨ç½²å¤šå®¹å™¨ Pod æ˜¯ CKA çš„è€ƒç‚¹ï¼Œä½ ä¸€å®šè¦ç†Ÿæ‚‰å®ƒçš„ YAML æ–‡ä»¶çš„å†™æ³•ã€‚ä½ ä¹Ÿéœ€è¦ç†Ÿæ‚‰ Pod ç›¸å…³çš„ kubectl å‘½ä»¤ï¼Œç‰¹åˆ«æ˜¯åˆ›å»º Pod ä½¿ç”¨çš„ â€œkubectl  runâ€ å‘½ä»¤ï¼Œä»¥åŠæŸ¥çœ‹ Pod ä¿¡æ¯ä½¿ç”¨çš„ â€œkubectl get podâ€ å’Œ â€œkubectl describe podâ€ å‘½ä»¤ã€‚</p><p>æœ€åï¼Œæˆ‘ä»‹ç»äº†é™æ€ Podã€‚é™æ€ Pod æ˜¯ä¸€ç§é€šè¿‡èŠ‚ç‚¹ä¸ŠæŒ‡å®šç›®å½•ï¼ˆâ€œ/etc/kubernetes/manifestsâ€ï¼‰ä¸­çš„ YAML æ–‡ä»¶è‡ªåŠ¨éƒ¨ç½²çš„ç‰¹æ®Š Podï¼Œåœ¨é›†ç¾¤å¯åŠ¨æ—¶å°±å¯ç”¨ï¼Œå¹¶ä¸”å¯ä»¥éšç€èŠ‚ç‚¹é‡å¯è€Œè‡ªåŠ¨é‡å¯ï¼Œé€šå¸¸ç”¨äºéƒ¨ç½²é›†ç¾¤çº§åˆ«çš„ç³»ç»Ÿç»„ä»¶ï¼ŒK8s çš„ç»„ä»¶å°±æ˜¯ä»¥é™æ€ Pod çš„æ–¹å¼è¿è¡Œã€‚åˆ›å»ºé™æ€ Pod åªéœ€è¦æŠŠ Pod çš„ YAML æ–‡ä»¶æ”¾åˆ°è¯¥èŠ‚ç‚¹çš„æŒ‡å®šç›®å½•ä¸‹ï¼ŒèŠ‚ç‚¹çš„ kubelet ç»„ä»¶å°±ä¼šè‡ªåŠ¨åˆ›å»ºé™æ€ Podã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¿™å°±æ˜¯ä»Šå¤©çš„å…¨éƒ¨å†…å®¹ï¼Œè¿™èŠ‚è¯¾é€šå¸¸ä¼šæœ‰ä¸€ä¸ªè€ƒç‚¹ï¼Œå°±æ˜¯ç»™ Pod é…ç½®å¤šä¸ªå®¹å™¨ï¼Œæ‰€ä»¥æœ€åç•™ä¸¤é“ç»ƒä¹ é¢˜ç»™ä½ ã€‚</p><ol>\n<li>åˆ›å»ºä¸€ä¸ª Podï¼Œå…¶ä¸­è¿è¡Œç€ Nginxã€Redisã€Memcache 3 ä¸ªå®¹å™¨ã€‚</li>\n<li>åœ¨èŠ‚ç‚¹ k8s-worker1 ä¸­è¿è¡Œä¸€ä¸ª Nginx çš„é™æ€ Podã€‚</li>\n</ol><p>ç›¸ä¿¡ç»è¿‡åŠ¨æ‰‹å®è·µï¼Œä¼šè®©ä½ å¯¹çŸ¥è¯†çš„ç†è§£æ›´åŠ æ·±åˆ»ã€‚</p>","comments":[{"had_liked":false,"id":392555,"user_name":"Y","can_delete":false,"product_type":"c1","uid":1179432,"ip_address":"å¹¿ä¸œ","ucode":"952AA9B2CD91CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/28/040f6f01.jpg","comment_is_top":false,"comment_ctime":1721212943,"is_pvip":true,"replies":[{"id":142676,"content":"æ²¡é—®é¢˜ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1209006,"ctime":1721287429,"ip_address":"åŒ—äº¬","comment_id":392555,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100780501,"comment_content":"# three_container_pod.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - image: nginx\n    name: nginx\n    volumeMounts:   # å®¹å™¨ Nginx æŒ‚è½½ Volume\n    - name: data\n      mountPath: &#47;data\n  - image: memcached\n    name: memcached\n    volumeMounts:   # å®¹å™¨ memcached æŒ‚è½½ Volume\n    - name: data\n      mountPath: &#47;data\n  - image: redis\n    name: redis\n    volumeMounts:   # å®¹å™¨ redis æŒ‚è½½ Volume\n    - name: data\n      mountPath: &#47;data\n  volumes:          # å®šä¹‰äº†ä¸€ä¸ªä¸´æ—¶ Volume\n  - name: data\n    emptyDir: {}","like_count":0,"discussions":[{"author":{"id":1209006,"avatar":"https://static001.geekbang.org/account/avatar/00/12/72/ae/cef8a848.jpg","nickname":"é›ªé£","note":"","ucode":"36BDFD1E35E9DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648256,"discussion_content":"æ²¡é—®é¢˜ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721287429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}