{"id":120351,"title":"31ä¸¨ä¸ºä»€ä¹ˆå¤§éƒ¨åˆ†RDBMSéƒ½ä¼šæ”¯æŒMVCCï¼Ÿ","content":"<p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†é”çš„åˆ’åˆ†ï¼Œä»¥åŠä¹è§‚é”å’Œæ‚²è§‚é”çš„æ€æƒ³ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹ä¸‹MVCCï¼Œå®ƒå°±æ˜¯é‡‡ç”¨ä¹è§‚é”æ€æƒ³çš„ä¸€ç§æ–¹å¼ã€‚é‚£ä¹ˆå®ƒåˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“äº‹åŠ¡æœ‰4ä¸ªéš”ç¦»çº§åˆ«ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ä¸‰ç§å¼‚å¸¸é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/9b/c2e9a4ce5793b031f3846890d0f6189b.png?wh=1331*694\" alt=\"\"><br>\nåœ¨MySQLä¸­ï¼Œé»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯å¯é‡å¤è¯»ï¼Œå¯ä»¥è§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œä½†ä¸èƒ½è§£å†³å¹»è¯»é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦è§£å†³å¹»è¯»é—®é¢˜ï¼Œå°±éœ€è¦é‡‡ç”¨ä¸²è¡ŒåŒ–çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å°†éš”ç¦»çº§åˆ«æå‡åˆ°æœ€é«˜ï¼Œä½†è¿™æ ·ä¸€æ¥å°±ä¼šå¤§å¹…é™ä½æ•°æ®åº“çš„äº‹åŠ¡å¹¶å‘èƒ½åŠ›ã€‚</p><p>æœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥ä¸é‡‡ç”¨é”æœºåˆ¶ï¼Œè€Œæ˜¯é€šè¿‡ä¹è§‚é”çš„æ–¹å¼æ¥è§£å†³ä¸å¯é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜å‘¢ï¼Ÿå®é™…ä¸ŠMVCCæœºåˆ¶çš„è®¾è®¡ï¼Œå°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒå¯ä»¥åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ›¿ä»£è¡Œçº§é”ï¼Œé™ä½ç³»ç»Ÿçš„å¼€é”€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/a0/568bb507e1edb431d8121a2cb5c7caa0.png?wh=1500*552\" alt=\"\"><br>\nä»Šå¤©çš„è¯¾ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„å†…å®¹ï¼š</p><ol>\n<li>MVCCæœºåˆ¶çš„æ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆRDBMSä¼šé‡‡ç”¨MVCCæœºåˆ¶ï¼Ÿ</li>\n<li>åœ¨InnoDBä¸­ï¼ŒMVCCæœºåˆ¶æ˜¯å¦‚ä½•å®ç°çš„ ï¼Ÿ</li>\n<li>Read Viewæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</li>\n</ol><h2>MVCCæ˜¯ä»€ä¹ˆï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜</h2><p>MVCCçš„è‹±æ–‡å…¨ç§°æ˜¯Multiversion Concurrency Controlï¼Œä¸­æ–‡ç¿»è¯‘è¿‡æ¥å°±æ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æŠ€æœ¯ã€‚ä»åå­—ä¸­ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼ŒMVCCæ˜¯é€šè¿‡æ•°æ®è¡Œçš„å¤šä¸ªç‰ˆæœ¬ç®¡ç†æ¥å®ç°æ•°æ®åº“çš„å¹¶å‘æ§åˆ¶ï¼Œç®€å•æ¥è¯´å®ƒçš„æ€æƒ³å°±æ˜¯ä¿å­˜æ•°æ®çš„å†å²ç‰ˆæœ¬ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ¯”è¾ƒç‰ˆæœ¬å·å†³å®šæ•°æ®æ˜¯å¦æ˜¾ç¤ºå‡ºæ¥ï¼ˆå…·ä½“çš„è§„åˆ™åé¢ä¼šä»‹ç»åˆ°ï¼‰ï¼Œè¯»å–æ•°æ®çš„æ—¶å€™ä¸éœ€è¦åŠ é”ä¹Ÿå¯ä»¥ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ•ˆæœã€‚</p><!-- [[[read_end]]] --><p>é€šè¿‡MVCCæˆ‘ä»¬å¯ä»¥è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ol>\n<li>è¯»å†™ä¹‹é—´é˜»å¡çš„é—®é¢˜ï¼Œé€šè¿‡MVCCå¯ä»¥è®©è¯»å†™äº’ç›¸ä¸é˜»å¡ï¼Œå³è¯»ä¸é˜»å¡å†™ï¼Œå†™ä¸é˜»å¡è¯»ï¼Œè¿™æ ·å°±å¯ä»¥æå‡äº‹åŠ¡å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</li>\n<li>é™ä½äº†æ­»é”çš„æ¦‚ç‡ã€‚è¿™æ˜¯å› ä¸ºMVCCé‡‡ç”¨äº†ä¹è§‚é”çš„æ–¹å¼ï¼Œè¯»å–æ•°æ®æ—¶å¹¶ä¸éœ€è¦åŠ é”ï¼Œå¯¹äºå†™æ“ä½œï¼Œä¹Ÿåªé”å®šå¿…è¦çš„è¡Œã€‚</li>\n<li>è§£å†³ä¸€è‡´æ€§è¯»çš„é—®é¢˜ã€‚ä¸€è‡´æ€§è¯»ä¹Ÿè¢«ç§°ä¸ºå¿«ç…§è¯»ï¼Œå½“æˆ‘ä»¬æŸ¥è¯¢æ•°æ®åº“åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§æ—¶ï¼Œåªèƒ½çœ‹åˆ°è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹å‰äº‹åŠ¡æäº¤æ›´æ–°çš„ç»“æœï¼Œè€Œä¸èƒ½çœ‹åˆ°è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹åäº‹åŠ¡æäº¤çš„æ›´æ–°ç»“æœã€‚</li>\n</ol><h3>ä»€ä¹ˆæ˜¯å¿«ç…§è¯»ï¼Œä»€ä¹ˆæ˜¯å½“å‰è¯»</h3><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯å¿«ç…§è¯»å‘¢ï¼Ÿå¿«ç…§è¯»è¯»å–çš„æ˜¯å¿«ç…§æ•°æ®ã€‚ä¸åŠ é”çš„ç®€å•çš„SELECTéƒ½å±äºå¿«ç…§è¯»ï¼Œæ¯”å¦‚è¿™æ ·ï¼š</p><pre><code>SELECT * FROM player WHERE ...\n</code></pre><p>å½“å‰è¯»å°±æ˜¯è¯»å–æœ€æ–°æ•°æ®ï¼Œè€Œä¸æ˜¯å†å²ç‰ˆæœ¬çš„æ•°æ®ã€‚åŠ é”çš„SELECTï¼Œæˆ–è€…å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹éƒ½ä¼šè¿›è¡Œå½“å‰è¯»ï¼Œæ¯”å¦‚ï¼š</p><pre><code>SELECT * FROM player LOCK IN SHARE MODE;\n</code></pre><pre><code>SELECT * FROM player FOR UPDATE;\n</code></pre><pre><code>INSERT INTO player values ...\n</code></pre><pre><code>DELETE FROM player WHERE ...\n</code></pre><pre><code>UPDATE player SET ...\n</code></pre><p>è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¿«ç…§è¯»å°±æ˜¯æ™®é€šçš„è¯»æ“ä½œï¼Œè€Œå½“å‰è¯»åŒ…æ‹¬äº†åŠ é”çš„è¯»å–å’ŒDMLæ“ä½œã€‚</p><p>ä¸Šé¢è®²MVCCçš„ä½œç”¨ï¼Œä½ å¯èƒ½è§‰å¾—æœ‰äº›æŠ½è±¡ã€‚æˆ‘ä»¬ç”¨å…·ä½“çš„ä¾‹å­ä½“ä¼šä¸€ä¸‹ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸ªè´¦æˆ·é‡‘é¢è¡¨user_balanceï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯usernameç”¨æˆ·åã€balanceä½™é¢å’Œbankcardå¡å·ï¼Œå…·ä½“çš„æ•°æ®ç¤ºæ„å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/be/46/bec7af5d84bc7d4295fd205491d85e46.png?wh=904*365\" alt=\"\"><br>\nä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å‡è®¾user_balanceè¡¨ä¸­åªæœ‰ç”¨æˆ·Aå’ŒBæœ‰ä½™é¢ï¼Œå…¶ä»–äººçš„è´¦æˆ·ä½™é¢å‡ä¸º0ã€‚ä¸‹é¢æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªä½¿ç”¨åœºæ™¯ã€‚</p><p>ç”¨æˆ·Aå’Œç”¨æˆ·Bä¹‹é—´è¿›è¡Œè½¬è´¦ï¼Œæ­¤æ—¶æ•°æ®åº“ç®¡ç†å‘˜æƒ³è¦æŸ¥è¯¢user_balanceè¡¨ä¸­çš„æ€»é‡‘é¢ï¼š</p><pre><code>SELECT SUM(balance) FROM user_balance\n</code></pre><p>ä½ å¯ä»¥æ€è€ƒä¸‹ï¼Œå¦‚æœæ•°æ®åº“ä¸æ”¯æŒMVCCæœºåˆ¶ï¼Œè€Œæ˜¯é‡‡ç”¨è‡ªèº«çš„é”æœºåˆ¶æ¥å®ç°çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°æ€æ ·çš„æƒ…å†µå‘¢ï¼Ÿ</p><p>æƒ…å†µ1ï¼šå› ä¸ºéœ€è¦é‡‡ç”¨åŠ è¡Œé”çš„æ–¹å¼ï¼Œç”¨æˆ·Aç»™Bè½¬è´¦æ—¶é—´ç­‰å¾…å¾ˆä¹…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2d/27/2df06836628ce9735364ca932003f927.png?wh=922*430\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦ç»™ç»Ÿè®¡åˆ°çš„æ•°æ®è¡Œéƒ½åŠ ä¸Šè¡Œé”ã€‚è¿™æ—¶å¦‚æœAæ‰€åœ¨çš„æ•°æ®è¡ŒåŠ ä¸Šäº†è¡Œé”ï¼Œå°±ä¸èƒ½ç»™Bè½¬è´¦äº†ï¼Œåªèƒ½ç­‰åˆ°æ‰€æœ‰æ“ä½œå®Œæˆä¹‹åï¼Œé‡Šæ”¾è¡Œé”å†ç»§ç»­è¿›è¡Œè½¬è´¦ï¼Œè¿™æ ·å°±ä¼šé€ æˆç”¨æˆ·äº‹åŠ¡å¤„ç†çš„ç­‰å¾…æ—¶é—´è¿‡é•¿ã€‚</p><p>æƒ…å†µ2ï¼šå½“æˆ‘ä»¬è¯»å–çš„æ—¶å€™ç”¨äº†åŠ è¡Œé”ï¼Œå¯èƒ½ä¼šå‡ºç°æ­»é”çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ¯”å¦‚å½“æˆ‘ä»¬è¯»åˆ°Aæœ‰1000å…ƒçš„æ—¶å€™ï¼Œæ­¤æ—¶Bå¼€å§‹æ‰§è¡Œç»™Aè½¬è´¦ï¼š</p><pre><code>UPDATE user_balance SET balance=balance-100 WHERE username ='B'\n\n</code></pre><p>æ‰§è¡Œå®Œä¹‹åé©¬ä¸Šæ‰§è¡Œä¸‹ä¸€æ­¥ï¼š</p><pre><code>UPDATE user_balance SET balance=balance+100 WHERE username ='A'\n</code></pre><p>æˆ‘ä»¬ä¼šå‘ç°æ­¤æ—¶Aè¢«é”ä½äº†ï¼Œè€Œç®¡ç†å‘˜äº‹åŠ¡è¿˜éœ€è¦å¯¹Bè¿›è¡Œè®¿é—®ï¼Œä½†Bè¢«ç”¨æˆ·äº‹åŠ¡é”ä½äº†ï¼Œæ­¤æ—¶å°±å‘ç”Ÿäº†æ­»é”ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/41/3b6c7ae9db7e1952fd9ae264e7147b41.png?wh=886*430\" alt=\"\"><br>\nMVCCå¯ä»¥è§£å†³è¯»å†™äº’ç›¸é˜»å¡çš„é—®é¢˜ï¼Œè¿™æ ·æå‡äº†æ•ˆç‡ï¼ŒåŒæ—¶å› ä¸ºé‡‡ç”¨äº†ä¹è§‚é”çš„æ€æƒ³ï¼Œé™ä½äº†æ­»é”çš„æ¦‚ç‡ã€‚</p><h2>InnoDBä¸­çš„MVCCæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h2><p>æˆ‘åˆšæ‰è®²è§£äº†MVCCçš„æ€æƒ³å’Œä½œç”¨ï¼Œå®é™…ä¸ŠMVCCæ²¡æœ‰æ­£å¼çš„æ ‡å‡†ï¼Œæ‰€ä»¥åœ¨ä¸åŒçš„DBMSä¸­ï¼ŒMVCCçš„å®ç°æ–¹å¼å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œä½ å¯ä»¥å‚è€ƒç›¸å…³çš„DBMSæ–‡æ¡£ã€‚ä»Šå¤©æˆ‘æ¥è®²ä¸€ä¸‹InnoDBä¸­MVCCçš„å®ç°æœºåˆ¶ã€‚</p><p>åœ¨äº†è§£InnoDBä¸­MVCCçš„å®ç°æ–¹å¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£InnoDBæ˜¯å¦‚ä½•å­˜å‚¨è®°å½•çš„å¤šä¸ªç‰ˆæœ¬çš„ã€‚è¿™é‡Œçš„å¤šç‰ˆæœ¬å¯¹åº”çš„å°±æ˜¯MVCCå‰ä¸¤ä¸ªå­—æ¯çš„é‡Šä¹‰ï¼šMulti Versionï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å’Œå®ƒç›¸å…³çš„æ•°æ®éƒ½æœ‰å“ªäº›ï¼Œå­˜å‚¨åœ¨å“ªé‡Œã€‚è¿™äº›æ•°æ®åŒ…æ‹¬äº‹åŠ¡ç‰ˆæœ¬å·ã€è¡Œè®°å½•ä¸­çš„éšè—åˆ—å’ŒUndo Logã€‚</p><h3>äº‹åŠ¡ç‰ˆæœ¬å·</h3><p>æ¯å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œæˆ‘ä»¬éƒ½ä¼šä»æ•°æ®åº“ä¸­è·å¾—ä¸€ä¸ªäº‹åŠ¡IDï¼ˆä¹Ÿå°±æ˜¯äº‹åŠ¡ç‰ˆæœ¬å·ï¼‰ï¼Œè¿™ä¸ªäº‹åŠ¡IDæ˜¯è‡ªå¢é•¿çš„ï¼Œé€šè¿‡IDå¤§å°ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­äº‹åŠ¡çš„æ—¶é—´é¡ºåºã€‚</p><h3>è¡Œè®°å½•çš„éšè—åˆ—</h3><p>InnoDBçš„å¶å­æ®µå­˜å‚¨äº†æ•°æ®é¡µï¼Œæ•°æ®é¡µä¸­ä¿å­˜äº†è¡Œè®°å½•ï¼Œè€Œåœ¨è¡Œè®°å½•ä¸­æœ‰ä¸€äº›é‡è¦çš„éšè—å­—æ®µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><ol>\n<li>db_row_idï¼šéšè—çš„è¡ŒIDï¼Œç”¨æ¥ç”Ÿæˆé»˜è®¤èšé›†ç´¢å¼•ã€‚å¦‚æœæˆ‘ä»¬åˆ›å»ºæ•°æ®è¡¨çš„æ—¶å€™æ²¡æœ‰æŒ‡å®šèšé›†ç´¢å¼•ï¼Œè¿™æ—¶InnoDBå°±ä¼šç”¨è¿™ä¸ªéšè—IDæ¥åˆ›å»ºèšé›†ç´¢å¼•ã€‚é‡‡ç”¨èšé›†ç´¢å¼•çš„æ–¹å¼å¯ä»¥æå‡æ•°æ®çš„æŸ¥æ‰¾æ•ˆç‡ã€‚</li>\n<li>db_trx_idï¼šæ“ä½œè¿™ä¸ªæ•°æ®çš„äº‹åŠ¡IDï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ªå¯¹è¯¥æ•°æ®è¿›è¡Œæ’å…¥æˆ–æ›´æ–°çš„äº‹åŠ¡IDã€‚</li>\n<li>db_roll_ptrï¼šå›æ»šæŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘è¿™ä¸ªè®°å½•çš„Undo Logä¿¡æ¯ã€‚</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/d1/20/d15a5d0a313492b208d2aad410173b20.png?wh=838*178\" alt=\"\"></p><h3>Undo Log</h3><p>InnoDBå°†è¡Œè®°å½•å¿«ç…§ä¿å­˜åœ¨äº†Undo Logé‡Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›æ»šæ®µä¸­æ‰¾åˆ°å®ƒä»¬ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/47/81/4799c77b8cdfda50e49a391fea727281.png?wh=838*538\" alt=\"\"><br>\nä»å›¾ä¸­ä½ èƒ½çœ‹åˆ°å›æ»šæŒ‡é’ˆå°†æ•°æ®è¡Œçš„æ‰€æœ‰å¿«ç…§è®°å½•éƒ½é€šè¿‡é“¾è¡¨çš„ç»“æ„ä¸²è”äº†èµ·æ¥ï¼Œæ¯ä¸ªå¿«ç…§çš„è®°å½•éƒ½ä¿å­˜äº†å½“æ—¶çš„db_trx_idï¼Œä¹Ÿæ˜¯é‚£ä¸ªæ—¶é—´ç‚¹æ“ä½œè¿™ä¸ªæ•°æ®çš„äº‹åŠ¡IDã€‚è¿™æ ·å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰¾å†å²å¿«ç…§ï¼Œå°±å¯ä»¥é€šè¿‡éå†å›æ»šæŒ‡é’ˆçš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾ã€‚</p><h2>Read Viewæ˜¯å¦‚ä½•å·¥ä½œçš„</h2><p>åœ¨MVCCæœºåˆ¶ä¸­ï¼Œå¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªè¡Œè®°å½•è¿›è¡Œæ›´æ–°ä¼šäº§ç”Ÿå¤šä¸ªå†å²å¿«ç…§ï¼Œè¿™äº›å†å²å¿«ç…§ä¿å­˜åœ¨Undo Logé‡Œã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æƒ³è¦æŸ¥è¯¢è¿™ä¸ªè¡Œè®°å½•ï¼Œéœ€è¦è¯»å–å“ªä¸ªç‰ˆæœ¬çš„è¡Œè®°å½•å‘¢ï¼Ÿè¿™æ—¶å°±éœ€è¦ç”¨åˆ°Read Viewäº†ï¼Œå®ƒå¸®æˆ‘ä»¬è§£å†³äº†è¡Œçš„å¯è§æ€§é—®é¢˜ã€‚Read Viewä¿å­˜äº†å½“å‰äº‹åŠ¡å¼€å¯æ—¶æ‰€æœ‰æ´»è·ƒï¼ˆè¿˜æ²¡æœ‰æäº¤ï¼‰çš„äº‹åŠ¡åˆ—è¡¨ï¼Œæ¢ä¸ªè§’åº¦ä½ å¯ä»¥ç†è§£ä¸ºRead Viewä¿å­˜äº†ä¸åº”è¯¥è®©è¿™ä¸ªäº‹åŠ¡çœ‹åˆ°çš„å…¶ä»–çš„äº‹åŠ¡IDåˆ—è¡¨ã€‚</p><p>åœ¨Read VIewä¸­æœ‰å‡ ä¸ªé‡è¦çš„å±æ€§ï¼š</p><ol>\n<li>trx_idsï¼Œç³»ç»Ÿå½“å‰æ­£åœ¨æ´»è·ƒçš„äº‹åŠ¡IDé›†åˆã€‚</li>\n<li>low_limit_idï¼Œæ´»è·ƒçš„äº‹åŠ¡ä¸­æœ€å¤§çš„äº‹åŠ¡IDã€‚</li>\n<li>up_limit_idï¼Œæ´»è·ƒçš„äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡IDã€‚</li>\n<li>creator_trx_idï¼Œåˆ›å»ºè¿™ä¸ªRead Viewçš„äº‹åŠ¡IDã€‚</li>\n</ol><p>å¦‚å›¾æ‰€ç¤ºï¼Œtrx_idsä¸ºtrx2ã€trx3ã€trx5å’Œtrx8çš„é›†åˆï¼Œæ´»è·ƒçš„æœ€å¤§äº‹åŠ¡IDï¼ˆlow_limit_idï¼‰ä¸ºtrx8ï¼Œæ´»è·ƒçš„æœ€å°äº‹åŠ¡IDï¼ˆup_limit_idï¼‰ä¸ºtrx2ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/00/a7fe7d4a0e25fce469c3d00e5e3ec600.png?wh=760*223\" alt=\"\"><br>\nå‡è®¾å½“å‰æœ‰äº‹åŠ¡creator_trx_idæƒ³è¦è¯»å–æŸä¸ªè¡Œè®°å½•ï¼Œè¿™ä¸ªè¡Œè®°å½•çš„äº‹åŠ¡IDä¸ºtrx_idï¼Œé‚£ä¹ˆä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µã€‚</p><p>å¦‚æœtrx_id &lt; æ´»è·ƒçš„æœ€å°äº‹åŠ¡IDï¼ˆup_limit_idï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹å‰å°±å·²ç»æäº¤äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹è¯¥äº‹åŠ¡æ˜¯å¯è§çš„ã€‚</p><p>å¦‚æœtrx_id &gt; æ´»è·ƒçš„æœ€å¤§äº‹åŠ¡IDï¼ˆlow_limit_idï¼‰ï¼Œè¿™è¯´æ˜è¯¥è¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹åæ‰åˆ›å»ºï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚</p><p>å¦‚æœup_limit_id &lt; trx_id &lt; low_limit_idï¼Œè¯´æ˜è¯¥è¡Œè®°å½•æ‰€åœ¨çš„äº‹åŠ¡trx_idåœ¨ç›®å‰creator_trx_idè¿™ä¸ªäº‹åŠ¡åˆ›å»ºçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜å¤„äºæ´»è·ƒçš„çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨trx_idsé›†åˆä¸­è¿›è¡Œéå†ï¼Œå¦‚æœtrx_idå­˜åœ¨äºtrx_idsé›†åˆä¸­ï¼Œè¯æ˜è¿™ä¸ªäº‹åŠ¡trx_idè¿˜å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œä¸å¯è§ã€‚å¦åˆ™ï¼Œå¦‚æœtrx_idä¸å­˜åœ¨äºtrx_idsé›†åˆä¸­ï¼Œè¯æ˜äº‹åŠ¡trx_idå·²ç»æäº¤äº†ï¼Œè¯¥è¡Œè®°å½•å¯è§ã€‚</p><p>äº†è§£äº†è¿™äº›æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å½“æŸ¥è¯¢ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œç³»ç»Ÿå¦‚ä½•é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æŠ€æœ¯æ‰¾åˆ°å®ƒï¼š</p><ol>\n<li>é¦–å…ˆè·å–äº‹åŠ¡è‡ªå·±çš„ç‰ˆæœ¬å·ï¼Œä¹Ÿå°±æ˜¯äº‹åŠ¡IDï¼›</li>\n<li>è·å–Read Viewï¼›</li>\n<li>æŸ¥è¯¢å¾—åˆ°çš„æ•°æ®ï¼Œç„¶åä¸Read Viewä¸­çš„äº‹åŠ¡ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒï¼›</li>\n<li>å¦‚æœä¸ç¬¦åˆReadViewè§„åˆ™ï¼Œå°±éœ€è¦ä»Undo Logä¸­è·å–å†å²å¿«ç…§ï¼›</li>\n<li>æœ€åè¿”å›ç¬¦åˆè§„åˆ™çš„æ•°æ®ã€‚</li>\n</ol><p>ä½ èƒ½çœ‹åˆ°InnoDBä¸­ï¼ŒMVCCæ˜¯é€šè¿‡Undo Log + Read Viewè¿›è¡Œæ•°æ®è¯»å–ï¼ŒUndo Logä¿å­˜äº†å†å²å¿«ç…§ï¼Œè€ŒRead Viewè§„åˆ™å¸®æˆ‘ä»¬åˆ¤æ–­å½“å‰ç‰ˆæœ¬çš„æ•°æ®æ˜¯å¦å¯è§ã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨éš”ç¦»çº§åˆ«ä¸ºè¯»å·²æäº¤ï¼ˆRead Commitï¼‰æ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ¯ä¸€æ¬¡SELECTæŸ¥è¯¢éƒ½ä¼šè·å–ä¸€æ¬¡Read Viewã€‚å¦‚è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/5c/5dfd6b7491484ad49efc5f08b214bf5c.png?wh=1203*398\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°ï¼Œåœ¨è¯»å·²æäº¤çš„éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒæ ·çš„æŸ¥è¯¢è¯­å¥éƒ½ä¼šé‡æ–°è·å–ä¸€æ¬¡Read Viewï¼Œè¿™æ—¶å¦‚æœRead Viewä¸åŒï¼Œå°±å¯èƒ½äº§ç”Ÿä¸å¯é‡å¤è¯»æˆ–è€…å¹»è¯»çš„æƒ…å†µã€‚</p><p>å½“éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»çš„æ—¶å€™ï¼Œå°±é¿å…äº†ä¸å¯é‡å¤è¯»ï¼Œè¿™æ˜¯å› ä¸ºä¸€ä¸ªäº‹åŠ¡åªåœ¨ç¬¬ä¸€æ¬¡SELECTçš„æ—¶å€™ä¼šè·å–ä¸€æ¬¡Read Viewï¼Œè€Œåé¢æ‰€æœ‰çš„SELECTéƒ½ä¼šå¤ç”¨è¿™ä¸ªRead Viewï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7b/f2/7b9c80fb892f858e08a64fc8ef7257f2.png?wh=1012*341\" alt=\"\"></p><h2>InnoDBæ˜¯å¦‚ä½•è§£å†³å¹»è¯»çš„</h2><p>ä¸è¿‡è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨å¯é‡å¤è¯»çš„æƒ…å†µä¸‹ï¼ŒInnoDBå¯ä»¥é€šè¿‡Next-Keyé”+MVCCæ¥è§£å†³å¹»è¯»é—®é¢˜ã€‚</p><p>åœ¨è¯»å·²æäº¤çš„æƒ…å†µä¸‹ï¼Œå³ä½¿é‡‡ç”¨äº†MVCCæ–¹å¼ä¹Ÿä¼šå‡ºç°å¹»è¯»ã€‚å¦‚æœæˆ‘ä»¬åŒæ—¶å¼€å¯äº‹åŠ¡Aå’Œäº‹åŠ¡Bï¼Œå…ˆåœ¨äº‹åŠ¡Aä¸­è¿›è¡ŒæŸä¸ªæ¡ä»¶èŒƒå›´çš„æŸ¥è¯¢ï¼Œè¯»å–çš„æ—¶å€™é‡‡ç”¨æ’å®ƒé”ï¼Œåœ¨äº‹åŠ¡Bä¸­å¢åŠ ä¸€æ¡ç¬¦åˆè¯¥æ¡ä»¶èŒƒå›´çš„æ•°æ®ï¼Œå¹¶è¿›è¡Œæäº¤ï¼Œç„¶åæˆ‘ä»¬åœ¨äº‹åŠ¡Aä¸­å†æ¬¡æŸ¥è¯¢è¯¥æ¡ä»¶èŒƒå›´çš„æ•°æ®ï¼Œå°±ä¼šå‘ç°ç»“æœé›†ä¸­å¤šå‡ºä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œè¿™æ ·å°±å‡ºç°äº†å¹»è¯»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/cb/4f112ba8411db336f58c8db9c9e8f0cb.png?wh=864*485\" alt=\"\"><br>\nå‡ºç°å¹»è¯»çš„åŸå› æ˜¯åœ¨è¯»å·²æäº¤çš„æƒ…å†µä¸‹ï¼ŒInnoDBåªé‡‡ç”¨è®°å½•é”ï¼ˆRecord Lockingï¼‰ã€‚è¿™é‡Œè¦ä»‹ç»ä¸‹InnoDBä¸‰ç§è¡Œé”çš„æ–¹å¼ï¼š</p><ol>\n<li>è®°å½•é”ï¼šé’ˆå¯¹å•ä¸ªè¡Œè®°å½•æ·»åŠ é”ã€‚</li>\n<li>é—´éš™é”ï¼ˆGap Lockingï¼‰ï¼šå¯ä»¥å¸®æˆ‘ä»¬é”ä½ä¸€ä¸ªèŒƒå›´ï¼ˆç´¢å¼•ä¹‹é—´çš„ç©ºéš™ï¼‰ï¼Œä½†ä¸åŒ…æ‹¬è®°å½•æœ¬èº«ã€‚é‡‡ç”¨é—´éš™é”çš„æ–¹å¼å¯ä»¥é˜²æ­¢å¹»è¯»æƒ…å†µçš„äº§ç”Ÿã€‚</li>\n<li>Next-Keyé”ï¼šå¸®æˆ‘ä»¬é”ä½ä¸€ä¸ªèŒƒå›´ï¼ŒåŒæ—¶é”å®šè®°å½•æœ¬èº«ï¼Œç›¸å½“äºé—´éš™é”+è®°å½•é”ï¼Œå¯ä»¥è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚</li>\n</ol><p>åœ¨éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»æ—¶ï¼ŒInnoDBä¼šé‡‡ç”¨Next-Keyé”çš„æœºåˆ¶ï¼Œå¸®æˆ‘ä»¬è§£å†³å¹»è¯»é—®é¢˜ã€‚</p><p>è¿˜æ˜¯è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°å½“æˆ‘ä»¬æƒ³è¦æ’å…¥çƒå‘˜è‰¾åˆ©å…‹æ–¯Â·ä¼¦ï¼ˆèº«é«˜2.16ç±³ï¼‰çš„æ—¶å€™ï¼Œäº‹åŠ¡Bä¼šè¶…æ—¶ï¼Œæ— æ³•æ’å…¥è¯¥æ•°æ®ã€‚è¿™æ˜¯å› ä¸ºé‡‡ç”¨äº†Next-Keyé”ï¼Œä¼šå°†height&gt;2.08çš„èŒƒå›´éƒ½è¿›è¡Œé”å®šï¼Œå°±æ— æ³•æ’å…¥ç¬¦åˆè¿™ä¸ªèŒƒå›´çš„æ•°æ®äº†ã€‚ç„¶åäº‹åŠ¡Aé‡æ–°è¿›è¡Œæ¡ä»¶èŒƒå›´çš„æŸ¥è¯¢ï¼Œå°±ä¸ä¼šå‡ºç°å¹»è¯»çš„æƒ…å†µã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/4e/3b876d3a4d5c11352ba10cebf9c7ab4e.png?wh=1816*1018\" alt=\"\"></p><h2>æ€»ç»“</h2><p>ä»Šå¤©å…³äºMVCCçš„å†…å®¹æœ‰äº›å¤šï¼Œé€šè¿‡å­¦ä¹ ä½ åº”è¯¥èƒ½å¯¹é‡‡ç”¨MVCCè¿™ç§ä¹è§‚é”çš„æ–¹å¼æ¥ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ•ˆæœæ›´æœ‰ä½“ä¼šã€‚</p><p>æˆ‘ä»¬éœ€è¦è®°ä½ï¼ŒMVCCçš„æ ¸å¿ƒå°±æ˜¯Undo Log+ Read Viewï¼Œâ€œMVâ€å°±æ˜¯é€šè¿‡Undo Logæ¥ä¿å­˜æ•°æ®çš„å†å²ç‰ˆæœ¬ï¼Œå®ç°å¤šç‰ˆæœ¬çš„ç®¡ç†ï¼Œâ€œCCâ€æ˜¯é€šè¿‡Read Viewæ¥å®ç°ç®¡ç†ï¼Œé€šè¿‡Read ViewåŸåˆ™æ¥å†³å®šæ•°æ®æ˜¯å¦æ˜¾ç¤ºã€‚åŒæ—¶é’ˆå¯¹ä¸åŒçš„éš”ç¦»çº§åˆ«ï¼ŒRead Viewçš„ç”Ÿæˆç­–ç•¥ä¸åŒï¼Œä¹Ÿå°±å®ç°äº†ä¸åŒçš„éš”ç¦»çº§åˆ«ã€‚</p><p>MVCCæ˜¯ä¸€ç§æœºåˆ¶ï¼ŒMySQLã€Oracleã€SQL Serverå’ŒPostgreSQLçš„å®ç°æ–¹å¼å‡æœ‰ä¸åŒï¼Œæˆ‘ä»¬åœ¨å­¦ä¹ çš„æ—¶å€™ï¼Œæ›´ä¸»è¦çš„æ˜¯è¦ç†è§£MVCCçš„è®¾è®¡æ€æƒ³ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/5a/4f1cb2414cae9216ee6b3a5fa19a855a.jpg?wh=2366*2313\" alt=\"\"><br>\næœ€åç»™ä½ ç•™å‡ é“æ€è€ƒé¢˜å§ï¼Œä¸ºä»€ä¹ˆéš”ç¦»çº§åˆ«ä¸ºè¯»æœªæäº¤æ—¶ï¼Œä¸é€‚ç”¨äºMVCCæœºåˆ¶å‘¢ï¼Ÿç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œè¯»å·²æäº¤å’Œå¯é‡å¤è¯»è¿™ä¸¤ä¸ªéš”ç¦»çº§åˆ«çš„Read Viewç­–ç•¥æœ‰ä½•ä¸åŒï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ è¿›æ­¥ã€‚</p>","neighbors":{"left":{"article_title":"30ä¸¨é”ï¼šæ‚²è§‚é”å’Œä¹è§‚é”æ˜¯ä»€ä¹ˆï¼Ÿ","id":119044},"right":{"article_title":"32ä¸¨æŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ","id":125429}},"comments":[{"had_liked":false,"id":126300,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1566358899,"is_pvip":false,"replies":[{"id":"47667","content":"å¯¹çš„ è¯»æœªæäº¤ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶","user_name":"ä½œè€…å›å¤","comment_id":126300,"uid":"1306094","ip_address":"","utype":1,"ctime":1566901126,"user_name_real":"cy"}],"discussion_count":4,"race_medal":0,"score":"160480148851","product_id":100029501,"comment_content":"æˆ‘æ¥å›ç­”ä¸€ä¸‹æ€è€ƒé¢˜ï¼š<br>ä¸ºä»€ä¹ˆéš”ç¦»çº§åˆ«ä¸ºè¯»æœªæäº¤æ—¶ï¼Œä¸é€‚ç”¨äº MVCC æœºåˆ¶å‘¢ï¼Ÿ<br>å› ä¸ºéš”ç¦»çº§åˆ«æ˜¯è¯»æœªæäº¤ï¼Œæ‰€ä»¥è·Ÿæœ¬å°±ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼Œç›´æ¥è¯»å–æœ€æ–°çš„æ•°æ®å°±å¥½äº†ã€‚<br><br>è¯»å·²æäº¤å’Œå¯é‡å¤è¯»è¿™ä¸¤ä¸ªéš”ç¦»çº§åˆ«çš„ Read View ç­–ç•¥æœ‰ä½•ä¸åŒï¼Ÿ<br>è¯»å·²æäº¤æ¯ä¸€æ¬¡Selectéƒ½ä¼šé‡æ–°æŸ¥è¯¢Read Viewï¼Œä¿è¯å¯ä»¥è¯»åˆ°å…¶å®ƒäº‹åŠ¡çš„æäº¤ã€‚<br>å¯é‡å¤è¯»ä¼šå¤ç”¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢åˆ°çš„Read View,ä¸ä¼šè¯»åˆ°å…¶å®ƒäº‹åŠ¡çš„æäº¤ï¼ŒåŠ ä¸ŠNext-Keyé”çš„é…åˆï¼Œä»è€Œé¿å…å¹»è¯»ã€‚","like_count":38,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463932,"discussion_content":"å¯¹çš„ è¯»æœªæäº¤ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566901126,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1721278,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLAhj2fB8NI2TPI1SNicgiciczuMUHyAb9HHBkkKJHrgtR162fsicaTqdAneHfuVX7icDXaVibDHstM9L47g/132","nickname":"Geek_0c1732","note":"","ucode":"6276D0412CCE51","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258105,"discussion_content":"read viewæ˜¯å¿«ç…§è¯»æ—¶ä½¿ç”¨çš„ï¼Œnext-keyé”æ˜¯å½“å‰è¯»ä½¿ç”¨çš„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1588647153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1572636,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ff/1c/d049776e.jpg","nickname":"wonderq_gk","note":"","ucode":"9A10DDC39DBB6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6724,"discussion_content":"ç‰›çš®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567069321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1127175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","nickname":"JustDoDT","note":"","ucode":"6AF0B80F00EAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5892,"discussion_content":"ä¼˜ç§€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566529243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127173,"user_name":"DZ","can_delete":false,"product_type":"c1","uid":1132240,"ip_address":"","ucode":"452555FA0F9E0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/46/d0/6bafd7d4.jpg","comment_is_top":false,"comment_ctime":1566576778,"is_pvip":false,"replies":[{"id":"47083","content":"å¯¹çš„ åˆ†ææ€»ç»“çš„å¾ˆå¥½","user_name":"ä½œè€…å›å¤","comment_id":127173,"uid":"1306094","ip_address":"","utype":1,"ctime":1566623812,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"83170955402","product_id":100029501,"comment_content":"1. ä¸ºä»€ä¹ˆéš”ç¦»çº§åˆ«ä¸ºè¯»æœªæäº¤æ—¶ï¼Œä¸é€‚ç”¨äº MVCC æœºåˆ¶å‘¢ï¼Ÿ<br><br>â€œè¯»æœªæäº¤â€éš”ç¦»çº§åˆ«ä¸éœ€è¦å¤šç‰ˆæœ¬æ•°æ®ã€‚æ¯ä¸ªäº‹åŠ¡éƒ½è¯»å–æœ€æ–°æ•°æ®ï¼Œå‡è®¾äº‹åŠ¡AæŠŠXä»0æ”¹æˆ1ï¼Œæ— è®ºäº‹åŠ¡Aæ˜¯å¦æäº¤ï¼Œäº‹åŠ¡Bè¯»åˆ°Xä¸º1ï¼Œå¦‚æœäº‹åŠ¡Aå›æ»šï¼Œäº‹åŠ¡Bå†æ¬¡è¯»Xï¼Œè‡ªç„¶å°±å¾—åˆ°0ï¼Œæ ¹æœ¬ä¸éœ€è¦MVCCå¸®è¡¬ã€‚<br><br>2. è¯»å·²æäº¤å’Œå¯é‡å¤è¯»è¿™ä¸¤ä¸ªéš”ç¦»çº§åˆ«çš„ Read View ç­–ç•¥æœ‰ä½•ä¸åŒï¼Ÿ<br><br>â€œè¯»å·²æäº¤â€æ—¶ï¼Œæ¯æ¬¡SELECTæ“ä½œéƒ½åˆ›å»ºRead Viewï¼Œæ— è®ºSELECTæ˜¯å¦ç›¸åŒï¼Œæ‰€ä»¥å¯èƒ½å‡ºç°å‰åä¸¤æ¬¡è¯»åˆ°çš„ç»“æœä¸ç­‰ï¼Œå³ä¸å¯é‡å¤è¯»ã€‚<br>â€œå¯é‡å¤è¯»â€æ—¶ï¼Œé¦–æ¬¡SELECTæ“ä½œæ‰åˆ›å»ºRead Viewå¹¶å¤ç”¨ç»™åç»­çš„ç›¸åŒSELECTæ“ä½œï¼Œå‰åä¸¤æ¬¡è¯»åˆ°çš„ç»“æœä¸€å®šç›¸ç­‰ï¼Œé¿å…äº†ä¸å¯é‡å¤è¯»ã€‚","like_count":20,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464354,"discussion_content":"å¯¹çš„ åˆ†ææ€»ç»“çš„å¾ˆå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566623812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222347,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1590756161,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53130363713","product_id":100029501,"comment_content":"ä»¥ä¸ºæˆ‘çœ‹ä¸æ‡‚ï¼Œå´åŸæ¥åªæ˜¯ææƒ§å­¦ä¹ mvccï¼Œä»”ç»†çœ‹ï¼Œ3ã€5éå†ç»“åˆã€Šmysql45è®²ã€‹çš„å‡ èŠ‚ï¼Œæ…¢æ…¢ç¢ç£¨å“å‘³ï¼Œç»ˆäºæ˜ç™½äº›äº†ã€‚ç»§ç»­å­¦ä¹ ï¼Œæ¯”æ˜¨å¤©çš„è‡ªå·±æ›´ä¼˜ç§€","like_count":13},{"had_liked":false,"id":126146,"user_name":"asdf100","can_delete":false,"product_type":"c1","uid":1043738,"ip_address":"","ucode":"39D8D71453E575","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/ce7f7d54.jpg","comment_is_top":false,"comment_ctime":1566330317,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"27336134093","product_id":100029501,"comment_content":"å¦‚å›¾æ‰€ç¤ºï¼Œtrx_ids ä¸º trx2ã€trx3ã€trx5 å’Œ trx8 çš„é›†åˆï¼Œæ´»è·ƒçš„æœ€å¤§äº‹åŠ¡ IDï¼ˆlow_limit_idï¼‰ä¸º trx10ï¼Œæ´»è·ƒçš„æœ€å°äº‹åŠ¡ IDï¼ˆup_limit_idï¼‰ä¸º trx4ã€‚<br><br>æ²¡ç†è§£è¿™ä¸ª10å’Œ4æ€ä¹ˆæ¥çš„ï¼Œä¸æ˜¯è¯´å°±2 3 5 8è¿™ä¸ªæ´»è·ƒäº‹åŠ¡å—ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1133918,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/5e/c5c62933.jpg","nickname":"lmtoo","note":"","ucode":"FCD5B9C941D448","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5549,"discussion_content":"å“ˆå“ˆå“ˆï¼Œæˆ‘æœ‰åŒæ ·çš„ç–‘é—®ï¼Ÿè§‰å¾—è«åå…¶å¦™","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566351936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"éª‘è¡Œçš„æŒæŸœJ","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265741,"discussion_content":"æˆ‘è¿™é‡Œå·²ç»æ”¹äº†å“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589432781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1344431,"avatar":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","nickname":"é©¬ä»¥","note":"","ucode":"3FEA06CA14DE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5545,"discussion_content":"åº”è¯¥æ˜¯ä¸ªç¬”è¯¯å§\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566350820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237931,"user_name":"å®‹é›„æ–Œ","can_delete":false,"product_type":"c1","uid":1433647,"ip_address":"","ucode":"52FA63AA616319","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/2f/3aee5f24.jpg","comment_is_top":false,"comment_ctime":1596008491,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"14480910379","product_id":100029501,"comment_content":"RR  ä¸ºä»€ä¹ˆè¿˜æ˜¯ä¼šäº§ç”Ÿå¹»è¯»å‘€ï¼Œåé¢äº‹åŠ¡æ’å…¥çš„æ•°æ®å®ƒä»¬çš„äº‹åŠ¡IDä¸åº”è¯¥æ¯”ç¬¬ä¸€æ¬¡è·å–çš„Read View çš„äº‹åŠ¡IDå¤§å—ï¼Œé‚£ä¹ˆåé¢æ’å…¥çš„æ•°æ®ä¸åº”è¯¥çœ‹ä¸åˆ°çš„å—ï¼Ÿï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1640978,"avatar":"https://static001.geekbang.org/account/avatar/00/19/0a/12/f8b988b8.jpg","nickname":"Kyle(","note":"","ucode":"0C14C4C086CAA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344688,"discussion_content":"è€å¸ˆä¸¾å¾—ä¾‹å­åº”è¯¥æ˜¯åŠ äº†é”çš„å½“å‰è¯»ï¼Œå¦‚æœæ˜¯å¿«ç…§è¯»çš„è¯ä¸åŠ é”å°±æ˜¯ç”¨MVCCï¼Œå‰è€…æ˜¯åé¢æ’å…¥çš„æ•°æ®å¤±è´¥æ¥å®ç°å½“å‰è¯»å–çš„æ•°æ®ä¸€è‡´æ€§ï¼Œåè€…æ˜¯åé¢æ’å…¥çš„æ•°æ®ä¸å¯è§æ¥å®ç°ç‰ˆæœ¬è¯»å–çš„ä¸€è‡´æ€§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611559314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1961927,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLz44WGtTHNfFfZfzaGRpbYib9xKiamIeKDzQfb7xzu9jEot7507MKGtyiaU3Y8PnO7UZFNI45eR9PWw/132","nickname":"guo_splane","note":"","ucode":"7CA77FE4BA3488","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335201,"discussion_content":"è¡Œé”ä¸ä¼šå¯¹èŒƒå›´çš„å€¼èµ·ä½œç”¨é‚£ï¼›æ‰€ä»¥åŠ next key ï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608115061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1084993,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","nickname":"è¢å¸…","note":"","ucode":"A71A89B9F1BD69","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316006,"discussion_content":"å¯¹å‘€ï¼Œæˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œ è€Œä¸”æˆ‘ä¹ŸéªŒè¯äº†ï¼Œå…¨è¡¨æ‰«æï¼Œåæ’å…¥çš„æ•°æ®ä¹ŸæŸ¥ä¸åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603347662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1640978,"avatar":"https://static001.geekbang.org/account/avatar/00/19/0a/12/f8b988b8.jpg","nickname":"Kyle(","note":"","ucode":"0C14C4C086CAA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1084993,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","nickname":"è¢å¸…","note":"","ucode":"A71A89B9F1BD69","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":344685,"discussion_content":"åæ’å…¥çš„æ•°æ®æŸ¥ä¸åˆ°ä¸åº”è¯¥æ˜¯å¯¹çš„å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611559193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":316006,"ip_address":""},"score":344685,"extra":""}]}]},{"had_liked":false,"id":129780,"user_name":"ç©ºçŸ¥","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1567247439,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14452149327","product_id":100029501,"comment_content":"è€å¸ˆ é—®ä¸‹ï¼š<br>1ã€å¦‚æœRVä¸ç¬¦åˆ å°±éœ€è¦å»Undo Logé‡Œé¢å»åˆ¤æ–­å¿«ç…§è®°å½•äº†ï¼Œè¿™é‡Œå¯¹äºå¿«ç…§è®°å½• ä¼šä¸€ç›´æ¯”è¾ƒä¸‹å»ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå¯è§ç‰ˆæœ¬ æˆ–è€…æŸ¥è¯¢å…¨éƒ¨å†å²ç‰ˆæœ¬ä¸ºæ­¢ï¼Ÿ<br>2ã€é—´éš™é” é”ä½ä¸€ä¸ªèŒƒå›´ä¸åŒ…å« è¡Œè®°å½•æœ¬èº«ï¼Œæ˜¯æŒ‡ å¯¹æŸæ¡è®°å½•æ·»åŠ é—´éš™é”ä¹‹å è¿˜å¯ä»¥é’ˆå¯¹è¿™æ¡è®°å½•æœ¬èº«åšä¿®æ”¹æ“ä½œå—ï¼Ÿ","like_count":3},{"had_liked":false,"id":126986,"user_name":"å®‰é™çš„boy","can_delete":false,"product_type":"c1","uid":1196475,"ip_address":"","ucode":"F5F44B75228A85","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/bb/21ce60d2.jpg","comment_is_top":false,"comment_ctime":1566530578,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14451432466","product_id":100029501,"comment_content":"æƒ³è¯´ä¸€ä¸‹æœ€åä¸€ä¸ªåˆ—å­ï¼Œinnodbæ˜¯å¦‚ä½•è§£å†³å¹»è¯»çš„ã€‚ä½œè€…ä¸¾çš„ä¾‹å­æ˜¯innodbåœ¨å½“å‰è¯»çš„æƒ…å†µä¸‹å¦‚ä½•è§£å†³å¹»è¯»ï¼ˆé€šè¿‡åŠ next-key é”ï¼‰ã€‚å¦‚æœåœ¨å¿«ç…§è¯»ä¸‹ï¼Œåˆ©ç”¨readViewå°±å¯ä»¥è§£å†³äº†ã€‚","like_count":3,"discussions":[{"author":{"id":1815965,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/b5/9d/43fdda38.jpg","nickname":"å¥¥æ²™è¥¿æ³®","note":"","ucode":"07BDBAAA2F2305","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211608,"discussion_content":"read-viewè§£å†³ä¸äº†å¹»è¯» UNDO LOGåˆ†ä¸º  UPDATEå’ŒINSERT","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584869837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1196475,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/bb/21ce60d2.jpg","nickname":"å®‰é™çš„boy","note":"","ucode":"F5F44B75228A85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1815965,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/b5/9d/43fdda38.jpg","nickname":"å¥¥æ²™è¥¿æ³®","note":"","ucode":"07BDBAAA2F2305","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211619,"discussion_content":"è¿™ä¸ªæ€ä¹ˆè¯´ èƒ½è¯¦ç»†è§£é‡Šä¸‹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584870352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":211608,"ip_address":""},"score":211619,"extra":""}]}]},{"had_liked":false,"id":232000,"user_name":"å²›ã®èŒ¶","can_delete":false,"product_type":"c1","uid":1511263,"ip_address":"","ucode":"09E0782C238E2A","user_header":"https://static001.geekbang.org/account/avatar/00/17/0f/5f/355f409e.jpg","comment_is_top":false,"comment_ctime":1593828445,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10183763037","product_id":100029501,"comment_content":"æ—¢ç„¶åœ¨InnoDBçš„äº‹åŠ¡éš”ç¦»çº§åˆ«å¯é‡å¤è¯»æƒ…å†µï¼ŒåŒä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ¯ä¸€æ¬¡å¿«ç…§æŸ¥éƒ½ä¼šå¤ç”¨ç¬¬ä¸€æ¬¡å¿«ç…§æŸ¥çš„ReadVIewï¼Œé‚£ä¹ˆåº”è¯¥çœ‹ä¸åˆ°å…¶ä»–äº‹åŠ¡å·²æäº¤çš„å†…å®¹å‘€ï¼Œæ€ä¹ˆè¿˜ä¼šå‡ºç°å¹»è¯»é—®é¢˜å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1640978,"avatar":"https://static001.geekbang.org/account/avatar/00/19/0a/12/f8b988b8.jpg","nickname":"Kyle(","note":"","ucode":"0C14C4C086CAA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344689,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼šè€å¸ˆä¸¾å¾—ä¾‹å­åº”è¯¥æ˜¯åŠ äº†é”çš„å½“å‰è¯»ï¼Œå¦‚æœæ˜¯å¿«ç…§è¯»çš„è¯ä¸åŠ é”å°±æ˜¯ç”¨MVCCï¼Œå‰è€…æ˜¯åé¢æ’å…¥çš„æ•°æ®å¤±è´¥æ¥å®ç°å½“å‰è¯»å–çš„æ•°æ®ä¸€è‡´æ€§ï¼Œåè€…æ˜¯åé¢æ’å…¥çš„æ•°æ®ä¸å¯è§æ¥å®ç°ç‰ˆæœ¬è¯»å–çš„ä¸€è‡´æ€§ï¼Œå› ä¸ºæˆ‘åœ¨å…¶ä»–æ–‡ç« ä¸­çœ‹åˆ°è¿‡ï¼Œè¿™åº”è¯¥æ˜¯ä¸¤ç§è¯»å–æ–¹å¼ éƒ½å¯ä»¥è§£å†³å¹»è¯»çš„ï¼Œåªæ˜¯ä¸€ä¸ªæ˜¯ç”¨äº†æ‚²è§‚é”æ€æƒ³ä¸€ä¸ªæ˜¯ç”¨äº†ä¹è§‚é”æ€æƒ³","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611559410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2027690,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f0/aa/6ba4a1ab.jpg","nickname":"â„¡ã„¨å’Œå°šãµ","note":"","ucode":"E26B2BC7D8E4FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293032,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ï¼šå¯é‡å¤è¯»æ˜¯æŒ‡åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰è®°å½•ï¼Œç»™è¿™äº›æŸ¥åˆ°çš„æ¯ä¸€æ¡è®°å½•éƒ½åŠ ä¸Šäº†æ’å®ƒé”ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å¯¹è¿™äº›å·²ç»æŸ¥åˆ°çš„è®°å½•è¿›è¡Œè¯»å†™æ“ä½œï¼Œä½†æ˜¯å¦‚æœå†æ’å…¥ä¸€æ¡è®°å½•çš„è¯ï¼Œè¿™æ¡æ’å…¥çš„è®°å½•æ˜¯ä¸å±äºä¸Šä¸€æ¬¡æŸ¥è¯¢åˆ°çš„è®°å½•å½“ä¸­çš„ä»»ä½•ä¸€æ¡çš„ï¼Œå³æ’å®ƒé”èµ·ä¸åˆ°ä½œç”¨ï¼Œè€Œä¸”åæ’å…¥çš„è®°å½•çš„è¿™ä¸ªäº‹åŠ¡åº”è¯¥æ˜¯æ²¡æœ‰è¿›å…¥readViewçš„ï¼Œå› ä¸ºreadViewä¸­çš„äº‹åŠ¡éƒ½æ˜¯å½“å‰ä¸å¯è§çš„äº‹åŠ¡ï¼Œæ‰€ä»¥äº§ç”Ÿäº†å¹»è¯»ã€‚\nçº¯å±ä¸ªäººç†è§£ï¼Œä»…é™å‚è€ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595418322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221445,"user_name":"é™ˆé€¸æ–°","can_delete":false,"product_type":"c1","uid":1243628,"ip_address":"","ucode":"33B93A77DAAEA9","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/ec/9587eb26.jpg","comment_is_top":false,"comment_ctime":1590500401,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"10180434993","product_id":100029501,"comment_content":"RCä¸‹MVVCçš„ä¸€ä¸ªç–‘æƒ‘ç‚¹ã€‚<br><br>å‡è®¾ä¸¤ä¸ªäº‹åŠ¡å…ˆåå¼€å§‹ï¼Œäº‹åŠ¡Aï¼ˆäº‹åŠ¡ID100ï¼‰ã€äº‹åŠ¡Bï¼ˆäº‹åŠ¡ID101ï¼‰ã€‚<br>äº‹åŠ¡Bæ›´æ–°äº†ä¸€æ¡è®°å½•ï¼Œç„¶åæäº¤ï¼Œæ­¤æ—¶è¯¥è®°å½•çš„trx_id=101ã€‚<br>æ¥ç€äº‹åŠ¡Aå¯¹è¯¥è®°å½•è¿›è¡ŒæŸ¥è¯¢ï¼Œç”Ÿæˆè§†å›¾ï¼Œæ´»è·ƒçš„äº‹åŠ¡åˆ—è¡¨ä¸º [100]ï¼Œè€Œ101&gt;100ï¼ŒæŒ‰ç…§å¯è§è§„åˆ™ï¼Œç†åº”ä¸è®¿é—®ã€‚<br>æŒ‰ç…§MVVCçš„è§„åˆ™ï¼Œå¾—å‡ºçš„ç»“è®ºå’ŒRCåº”æœ‰çš„ç»“è®ºçŸ›ç›¾ã€‚<br><br>è¿™é‡Œçš„çŸ›ç›¾ï¼Œæ•°æ®åº“å…·ä½“æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2978255,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/71/cf/6ab03210.jpg","nickname":"åœ¨æ„å†å¿†ï¼","note":"","ucode":"2DDCD765DB85AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573995,"discussion_content":"è¿™ä¸ªè€å¸ˆè®²çš„æœ‰é—®é¢˜ï¼Œæˆ‘åœ¨åˆ«çš„åœ°æ–¹çœ‹åˆ°çš„read viewæ ¼å¼æ˜¯è¿™æ ·çš„ï¼Œmax_trx_idæŒ‡çš„æ˜¯é‚£ä¸ªå…¨å±€äº‹ç‰©idï¼Œä¹Ÿå°±æ˜¯åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹ç‰©çš„IDï¼Œè¿™æ ·çš„è¯å°±èƒ½è§£é‡Šä½ çš„è¿™ä¸ªé—®é¢˜äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653789721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1480419,"avatar":"https://static001.geekbang.org/account/avatar/00/16/96/e3/dd40ec58.jpg","nickname":"ç«è½¦æ—¥è®°","note":"","ucode":"62C57DFA6CDF74","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556925,"discussion_content":"æ„Ÿè§‰trx_idsä¼šé‡æ–°ç»Ÿè®¡ä¸‹ï¼Œæœ€å¤§äº‹ç‰©idå’Œæœ€å°äº‹ç‰©idä¸ä¼šå˜ï¼Œè¿™æ ·å°±èƒ½è¯´å¾—é€šäº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647573477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2815900,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/f7/9c/69c5c5dc.jpg","nickname":"è¶Šé”‹åˆ©","note":"","ucode":"63E9E3F3C7D53D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411918,"discussion_content":"æˆ‘æ„Ÿè§‰æ˜¯ RC çš„åå­—èµ·çš„ä¸å¥½ï¼ŒRC è¿™ä¸ªçº§åˆ«çš„æ„æ€æ˜¯ï¼Œä¿è¯ä½ ä¸ä¼šè¯»åˆ°è¿˜æ²¡ commit çš„æ•°æ®ï¼Œä½†ä¸æ˜¯è¯´ï¼Œåªè¦å·²ç» commit çš„ä½ å°±ä¸€å®šèƒ½è¯»åˆ°ã€‚è¦æ˜¯èƒ½è¯»åˆ°ï¼Œå…¶å®æ„Ÿè§‰æ˜¯å¹»è¯»ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636032743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028952,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/98/c490d236.jpg","nickname":"å°å›¢","note":"","ucode":"B81FD9742B1F22","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292234,"discussion_content":" rcä¸‹æ¯æ¬¡æŸ¥è¯¢ä¼šé‡æ–°è®¡ç®—è§†å›¾ã€‚æ‰€ä»¥bæäº¤åaæŸ¥è¯¢çš„äº‹åŠ¡è§†å›¾æ˜¯ã€100ï¼Œ101ã€‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595149394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2101081,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI5a9ianL7JOjmEKTEw075rKDeBD0YqD5cBlgY6nbdPiaskIVqa1HHYm7pibeVnoPqibEWr6a3rqc0xdA/132","nickname":"ä½•æ—¶ä¸æ¼‚æ³Š","note":"","ucode":"4C47064E5B6C14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2028952,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/98/c490d236.jpg","nickname":"å°å›¢","note":"","ucode":"B81FD9742B1F22","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371534,"discussion_content":"å¯æ˜¯101è¿™ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†å‘€ï¼Œä¸æ˜¯æ´»è·ƒçš„äº‹åŠ¡äº†ï¼Œæ€ä¹ˆèƒ½æŸ¥å‡ºåˆ°è§†å›¾å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619831043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292234,"ip_address":""},"score":371534,"extra":""}]}]},{"had_liked":false,"id":206807,"user_name":"æ¡‚å† è¿œèˆª","can_delete":false,"product_type":"c1","uid":1155463,"ip_address":"","ucode":"5959E1A1DAA05D","user_header":"https://static001.geekbang.org/account/avatar/00/11/a1/87/259ab5a3.jpg","comment_is_top":false,"comment_ctime":1586938949,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10176873541","product_id":100029501,"comment_content":"è€å¸ˆåº”è¯¥å°‘è¯´äº†ä¸€ä¸ªç»†èŠ‚ï¼Œå°±æ˜¯è¦å¯¹heightåŠ ç´¢å¼•ï¼Œå› ä¸ºä¸åŠ ç´¢å¼•çš„updateæ“ä½œæ˜¯è¡¨é”ã€‚","like_count":3},{"had_liked":false,"id":194649,"user_name":"æ±ªzZ","can_delete":false,"product_type":"c1","uid":1234757,"ip_address":"","ucode":"8B93062A683902","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/45/d1621188.jpg","comment_is_top":false,"comment_ctime":1585095112,"is_pvip":true,"replies":[{"id":"75464","content":"åŠ æ²¹ è¿™ç¯‡ç¡®å®æœ‰ä¸€å®šéš¾åº¦ ^_^","user_name":"ä½œè€…å›å¤","comment_id":194649,"uid":"1306094","ip_address":"","utype":1,"ctime":1585875069,"user_name_real":"cy"}],"discussion_count":1,"race_medal":1,"score":"10175029704","product_id":100029501,"comment_content":"å†…å®¹é‡å¤§ï¼Œçœ‹äº†ä¸‰éï¼Œæ„Ÿè§‰æœ‰ç‚¹æ‡‚äº†","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488865,"discussion_content":"åŠ æ²¹ è¿™ç¯‡ç¡®å®æœ‰ä¸€å®šéš¾åº¦ ^_^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585875069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169834,"user_name":"é¥­å›¢","can_delete":false,"product_type":"c1","uid":1332557,"ip_address":"","ucode":"E24F240CC91BE8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erbY9UsqHZhhVoI69yXNibBBg0TRdUVsKLMg2UZ1R3NJxXdMicqceI5yhdKZ5Ad6CJYO0XpFHlJzIYQ/132","comment_is_top":false,"comment_ctime":1578454066,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10168388658","product_id":100029501,"comment_content":"é‡è¯»ç¬¬äºŒé  æ‰ç†è§£äº†çœŸè°›  çœŸæ˜¯è¯»ä¹¦ç™¾é  å…¶ä¹‰è‡ªè§ï¼","like_count":3},{"had_liked":false,"id":136802,"user_name":"Yuhui","can_delete":false,"product_type":"c1","uid":1110470,"ip_address":"","ucode":"811933B016179F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/c6/6f39a982.jpg","comment_is_top":false,"comment_ctime":1569512417,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10159447009","product_id":100029501,"comment_content":"è¯·æ•™è€å¸ˆä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š<br>1. MVCCæœºåˆ¶åœ¨å„ä¸ªæ•°æ®åº“ä¸­é»˜è®¤æ˜¯æ‰“å¼€çš„è¿˜æ˜¯å…³é—­çš„ï¼Ÿ<br>2. æ˜¯å¦å¯ä»¥æ§åˆ¶MVCCæœºåˆ¶çš„æ‰“å¼€å’Œå…³é—­ï¼Ÿ<br>3. å¦‚ä½•æŸ¥çœ‹æ•°æ®è®°å½•çš„éšè—åˆ—ï¼Ÿ<br>è°¢è°¢ï¼","like_count":2,"discussions":[{"author":{"id":1815965,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/b5/9d/43fdda38.jpg","nickname":"å¥¥æ²™è¥¿æ³®","note":"","ucode":"07BDBAAA2F2305","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211607,"discussion_content":"Innodbå°±æ˜¯ç”¨MVCCçš„åªè¦è¾¾åˆ°è¯»æäº¤å°±ä¼šå¼€å¯MVCCå’Œè®°å½•é”ï¼Œè¾¾åˆ°å¯é‡å¤è¯»å°±ä¼šå¼€å¿ƒMVCC+NEXT-KEYé”","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584869776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1024164,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","nickname":"é˜¿æ–¯è’‚èŠ¬","note":"","ucode":"61D5E3BDA4EBC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1815965,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/b5/9d/43fdda38.jpg","nickname":"å¥¥æ²™è¥¿æ³®","note":"","ucode":"07BDBAAA2F2305","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280646,"discussion_content":"é‚£æ€ä¹ˆç†è§£å¯é‡å¤è¯»ä¼šå‡ºç°å¹»è¯»ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591585798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":211607,"ip_address":""},"score":280646,"extra":""}]}]},{"had_liked":false,"id":136421,"user_name":"å³»é“­","can_delete":false,"product_type":"c1","uid":1106202,"ip_address":"","ucode":"63AB23BADACA88","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/1a/20977779.jpg","comment_is_top":false,"comment_ctime":1569428156,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10159362748","product_id":100029501,"comment_content":"æµ‹è¯•ç»“æœå‘ç°æ¯”2.08çŸ®çš„æ’å…¥æ˜¯ä¹Ÿä¼šé˜»å¡","like_count":2,"discussions":[{"author":{"id":1155463,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a1/87/259ab5a3.jpg","nickname":"æ¡‚å† è¿œèˆª","note":"","ucode":"5959E1A1DAA05D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":233685,"discussion_content":"è€å¸ˆåº”è¯¥å°‘è¯´äº†ä¸€ä¸ªç»†èŠ‚ï¼Œå°±æ˜¯è¦å¯¹heightåŠ ç´¢å¼•ï¼Œå› ä¸ºä¸åŠ ç´¢å¼•çš„updateæ“ä½œæ˜¯è¡¨é”ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586938930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126510,"user_name":"Alpha","can_delete":false,"product_type":"c1","uid":1001861,"ip_address":"","ucode":"60CA15A25EC796","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/85/3f161d95.jpg","comment_is_top":false,"comment_ctime":1566398485,"is_pvip":false,"replies":[{"id":"63517","content":"Read Viewçš„è§„åˆ™ï¼š<br>å¦‚æœ trx_id &lt; æ´»è·ƒçš„æœ€å°äº‹åŠ¡ IDï¼ˆup_limit_idï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹å‰å°±å·²ç»æäº¤äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹è¯¥äº‹åŠ¡æ˜¯å¯è§çš„ã€‚<br><br>å¦‚æœ trx_id &gt; æ´»è·ƒçš„æœ€å¤§äº‹åŠ¡ IDï¼ˆlow_limit_idï¼‰ï¼Œè¿™è¯´æ˜è¯¥è¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹åæ‰åˆ›å»ºï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚<br><br>å¦‚æœ up_limit_id &lt; trx_id &lt; low_limit_idï¼Œè¯´æ˜è¯¥è¡Œè®°å½•æ‰€åœ¨çš„äº‹åŠ¡ trx_id åœ¨ç›®å‰ creator_trx_id è¿™ä¸ªäº‹åŠ¡åˆ›å»ºçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜å¤„äºæ´»è·ƒçš„çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ trx_ids é›†åˆä¸­è¿›è¡Œéå†ï¼Œå¦‚æœ trx_id å­˜åœ¨äº trx_ids é›†åˆä¸­ï¼Œè¯æ˜è¿™ä¸ªäº‹åŠ¡ trx_id è¿˜å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œä¸å¯è§ã€‚å¦åˆ™ï¼Œå¦‚æœ trx_id ä¸å­˜åœ¨äº trx_ids é›†åˆä¸­ï¼Œè¯æ˜äº‹åŠ¡ trx_id å·²ç»æäº¤äº†ï¼Œè¯¥è¡Œè®°å½•å¯è§ã€‚","user_name":"ä½œè€…å›å¤","comment_id":126510,"uid":"1306094","ip_address":"","utype":1,"ctime":1577516357,"user_name_real":"cy"}],"discussion_count":4,"race_medal":0,"score":"10156333077","product_id":100029501,"comment_content":"Step 4. å¦‚æœä¸ç¬¦åˆRead View è§„åˆ™ï¼Œå°±éœ€è¦ä»Undo Logä¸­è·å–å†å²å¿«ç…§ã€‚ä¸å¤ªæ˜ç™½è¿™é‡Œçš„&quot;Read Viewè§„åˆ™&quot;æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464025,"discussion_content":"Read Viewçš„è§„åˆ™ï¼š\nå¦‚æœ trx_id &amp;lt; æ´»è·ƒçš„æœ€å°äº‹åŠ¡ IDï¼ˆup_limit_idï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹å‰å°±å·²ç»æäº¤äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹è¯¥äº‹åŠ¡æ˜¯å¯è§çš„ã€‚\n\nå¦‚æœ trx_id &amp;gt; æ´»è·ƒçš„æœ€å¤§äº‹åŠ¡ IDï¼ˆlow_limit_idï¼‰ï¼Œè¿™è¯´æ˜è¯¥è¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹åæ‰åˆ›å»ºï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚\n\nå¦‚æœ up_limit_id &amp;lt; trx_id &amp;lt; low_limit_idï¼Œè¯´æ˜è¯¥è¡Œè®°å½•æ‰€åœ¨çš„äº‹åŠ¡ trx_id åœ¨ç›®å‰ creator_trx_id è¿™ä¸ªäº‹åŠ¡åˆ›å»ºçš„æ—¶å€™ï¼Œå¯èƒ½è¿˜å¤„äºæ´»è·ƒçš„çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ trx_ids é›†åˆä¸­è¿›è¡Œéå†ï¼Œå¦‚æœ trx_id å­˜åœ¨äº trx_ids é›†åˆä¸­ï¼Œè¯æ˜è¿™ä¸ªäº‹åŠ¡ trx_id è¿˜å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œä¸å¯è§ã€‚å¦åˆ™ï¼Œå¦‚æœ trx_id ä¸å­˜åœ¨äº trx_ids é›†åˆä¸­ï¼Œè¯æ˜äº‹åŠ¡ trx_id å·²ç»æäº¤äº†ï¼Œè¯¥è¡Œè®°å½•å¯è§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577516357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1084993,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","nickname":"è¢å¸…","note":"","ucode":"A71A89B9F1BD69","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316002,"discussion_content":"ä¸ç¬¦åˆRead View è§„åˆ™   ä¸  å¯è§|ä¸å¯è§çš„å…³ç³»æ˜¯ä»€ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603347451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1084993,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","nickname":"è¢å¸…","note":"","ucode":"A71A89B9F1BD69","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":377700,"discussion_content":"ReadViewå°±æ˜¯ç”¨æ¥åˆ¤æ–­è¿™æ¡æ•°æ®æ˜¯å¦å¯è§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622780492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":316002,"ip_address":""},"score":377700,"extra":""}]},{"author":{"id":1000060,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/7c/8ef14715.jpg","nickname":"ğŸ„½ğŸ„¸ğŸ…‡ğŸ…„ğŸ…‚","note":"","ucode":"853763C229A5AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7519,"discussion_content":"Read Viewçš„è§„åˆ™ï¼Œå°±æ˜¯å‰é¢çš„ä¸‰ä¸ªå¦‚æœï¼šå¦‚æœtrx_id<up_limit_id...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567527849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212652,"user_name":"steve","can_delete":false,"product_type":"c1","uid":1354489,"ip_address":"","ucode":"AB6D3E9FF8E77C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJETibDh9wrP19gj9VdlLRmppuG1FibI7nyUGldEXCnoqKibKIB18UMxyEHBkZNlf5vibLNeofiaN5U6Hw/132","comment_is_top":false,"comment_ctime":1588170369,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5883137665","product_id":100029501,"comment_content":"äº‰å“¥æ±‚è§£ç­”ï¼Œæˆ‘çœ‹è¿™ä¸ªæºç ï¼š<br>http:&#47;&#47;www.iskm.org&#47;mysql56&#47;read0read_8cc_source.html<br>view-&gt;low_limit_no = trx_sys-&gt;max_trx_id;ï¼Œ<br>è²Œä¼¼low_limit_noåº”è¯¥æ˜¯å½“å‰ç³»ç»Ÿæœ€å¤§çš„trx_idæ‰å¯¹å•Šï¼Œå¦‚æœæ˜¯æ´»è·ƒidåˆ—è¡¨çš„æœ€å¤§å€¼è²Œä¼¼ä¸å¤ªåˆç†ã€‚","like_count":1,"discussions":[{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"éª‘è¡Œçš„æŒæŸœJ","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265712,"discussion_content":"å“¥ä»¬ä½ æ˜¯ä¸æ˜¯èµ°é”™åœºäº†ï¼Ÿäº‰å“¥ï¼ŸğŸ˜‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589429572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160634,"user_name":"æœ±æˆäº®","can_delete":false,"product_type":"c1","uid":1008920,"ip_address":"","ucode":"669B049357B3FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJqWuvuicHD7RVlEDJamWNmwVdkjeH4pLxPXoicwqbnpOibI1MFFz9SIVJmQeKSZQRP9np1NUV3wpmnA/132","comment_is_top":false,"comment_ctime":1575990285,"is_pvip":true,"replies":[{"id":"62600","content":"å¯¹çš„ ç¨å¾®æœ‰äº›éš¾ç†è§£ï¼Œæ…¢æ…¢æ¥","user_name":"ä½œè€…å›å¤","comment_id":160634,"uid":"1306094","ip_address":"","utype":1,"ctime":1577072898,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"5870957581","product_id":100029501,"comment_content":"è¿™å—æœ‰ç‚¹éš¾~","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477441,"discussion_content":"å¯¹çš„ ç¨å¾®æœ‰äº›éš¾ç†è§£ï¼Œæ…¢æ…¢æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577072898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135743,"user_name":"Lè€","can_delete":false,"product_type":"c1","uid":1156395,"ip_address":"","ucode":"0D8827D9F6032D","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/2b/e876e7d4.jpg","comment_is_top":false,"comment_ctime":1569251346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5864218642","product_id":100029501,"comment_content":"ä¸ç†è§£çš„è¯·æ•™ä¸‹ä½œè€…å¤§ç¥ï¼š1.å¯é‡å¤è¯»çº§åˆ«ä¸‹ï¼Œæ–°åŠ å…¥çš„è¡Œï¼Œç‰ˆæœ¬å·é«˜äºå½“å‰äº‹ç‰©ç‰ˆæœ¬å·ï¼Œä¸ç”¨next-keyé”ï¼Œåº”è¯¥ä¹Ÿä¸ä¼šå‡ºç°å¹»è¯»ï¼Œè¿™ä¸ªæ€ä¹ˆç†è§£å•Šã€‚2.ä¾‹å­ä¸­ä¸ºä»€ä¹ˆåŠ äº†for update è¯»é”å‘€ï¼Œä¸æ˜¯åº”è¯¥ä¸ç”¨é”çš„ä¹ˆ","like_count":1},{"had_liked":false,"id":134620,"user_name":"Ryoma","can_delete":false,"product_type":"c1","uid":1130590,"ip_address":"","ucode":"7F692369239692","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","comment_is_top":false,"comment_ctime":1568880840,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"5863848136","product_id":100029501,"comment_content":"å¦‚æœæœ‰çš„åŒå­¦çœ‹äº†å‰é¢çš„ï¼Œæ²¡æœ‰çœ‹åˆ°è¿™ä¸€ç«  MVCCã€‚æ˜¯ä¸æ˜¯å°±ä¼šäº§ç”Ÿè¯¯è§£ï¼Œæ¯”å¦‚ MySQL Innodb åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¼šå‘ç”Ÿå¹»è¯»ç°è±¡ï¼Ÿè¿™ç±»è§‚ç‚¹ï¼Œåœ¨ä¹‹å‰è¯´çš„æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯éœ€è¦æå‰è¯´ä¸€ä¸‹ï¼Ÿ","like_count":1},{"had_liked":false,"id":133549,"user_name":"innovationmech","can_delete":false,"product_type":"c1","uid":1232321,"ip_address":"","ucode":"9377EAD5C6373E","user_header":"https://static001.geekbang.org/account/avatar/00/12/cd/c1/19531313.jpg","comment_is_top":false,"comment_ctime":1568602802,"is_pvip":false,"replies":[{"id":"53366","content":"åŠ æ²¹","user_name":"ä½œè€…å›å¤","comment_id":133549,"uid":"1306094","ip_address":"","utype":1,"ctime":1570428989,"user_name_real":"cy"}],"discussion_count":1,"race_medal":0,"score":"5863570098","product_id":100029501,"comment_content":"çœ‹äº†å‡ éæ–‡ç« å’Œç•™è¨€ï¼Œæœ‰ç‚¹æ‡‚äº†ã€‚ã€‚ã€‚","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467422,"discussion_content":"åŠ æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570428989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344543,"user_name":"è·¯åœ¨å“ª","can_delete":false,"product_type":"c1","uid":1816609,"ip_address":"","ucode":"A4822AD07AD102","user_header":"https://static001.geekbang.org/account/avatar/00/1b/b8/21/f692bdb0.jpg","comment_is_top":false,"comment_ctime":1651638703,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651638703","product_id":100029501,"comment_content":"å¥½éš¾ï¼Œçœ‹ä¸æ˜ç™½","like_count":0},{"had_liked":false,"id":338568,"user_name":"ç«è½¦æ—¥è®°","can_delete":false,"product_type":"c1","uid":1480419,"ip_address":"","ucode":"62C57DFA6CDF74","user_header":"https://static001.geekbang.org/account/avatar/00/16/96/e3/dd40ec58.jpg","comment_is_top":false,"comment_ctime":1647573895,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647573895","product_id":100029501,"comment_content":"æœ€årcçº§åˆ«çš„å¿«ç…§è¯»å…¶å®å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜ï¼Œå½“å‰è¯»æ‰ä¸å¯ä»¥å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":319997,"user_name":"è¶Šé”‹åˆ©","can_delete":false,"product_type":"c1","uid":2815900,"ip_address":"","ucode":"63E9E3F3C7D53D","user_header":"https://static001.geekbang.org/account/avatar/00/2a/f7/9c/69c5c5dc.jpg","comment_is_top":false,"comment_ctime":1636032168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636032168","product_id":100029501,"comment_content":"æ‰€ä»¥ InnoDB åœ¨å¯é‡å¤è¯»è¿™ä¸ªçº§åˆ«æ—¢å¯ä»¥é¿å…å¹»è¯»äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":307095,"user_name":"çˆ±å¾å°š","can_delete":false,"product_type":"c1","uid":2602405,"ip_address":"","ucode":"049C04B6BD9D11","user_header":"https://static001.geekbang.org/account/avatar/00/27/b5/a5/1c62fe9c.jpg","comment_is_top":false,"comment_ctime":1628858019,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628858019","product_id":100029501,"comment_content":"ä½ å¥½ï¼Œæƒ³é—®ä¸‹MVCCå®ç°è¿‡ç¨‹çš„ç¬¬å››æ­¥å’Œç¬¬äº”æ­¥æˆ‘çš„ç†è§£å¯¹ä¸å¯¹ï¼Œå°±æ˜¯éå†undo logåˆ—è¡¨å°†ç‰ˆæœ¬å·è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœå¯è§åˆ™è¿”å›ç»“æœï¼Œå¦‚æœä¸å¯è§åˆ™æ²¿ç€å›æ»šæŒ‡é’ˆç»§ç»­å¯»æ‰¾åˆ¤æ–­","like_count":0},{"had_liked":false,"id":298721,"user_name":"æ–‡é‡","can_delete":false,"product_type":"c1","uid":1857196,"ip_address":"","ucode":"6193A3648DD557","user_header":"","comment_is_top":false,"comment_ctime":1624276369,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624276369","product_id":100029501,"comment_content":"drop table if exists `test`;<br>CREATE TABLE `test` (<br>   `id` bigint NOT NULL AUTO_INCREMENT COMMENT &#39;ç¼–å·&#39;,<br>   `aa` bigint unsigned NOT NULL COMMENT &#39;aa&#39;,<br>   PRIMARY KEY (`id`),<br>   KEY `idx_aa` (`aa`),<br>) ENGINE=InnoDB COMMENT=&#39;æµ‹è¯•&#39;;<br><br>tx1ï¼š<br>update test set aa = 15 where id = 100;<br>select * from test where aa = 15 limit 10; <br><br>tx1çš„ç¬¬äºŒæ¡æŸ¥è¯¢çš„æ—¶å€™æ˜¯æ€ä¹ˆç”¨ç´¢å¼•æŸ¥çš„å‘¢","like_count":0},{"had_liked":false,"id":290881,"user_name":"ä½•æ—¶ä¸æ¼‚æ³Š","can_delete":false,"product_type":"c1","uid":2101081,"ip_address":"","ucode":"4C47064E5B6C14","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI5a9ianL7JOjmEKTEw075rKDeBD0YqD5cBlgY6nbdPiaskIVqa1HHYm7pibeVnoPqibEWr6a3rqc0xdA/132","comment_is_top":false,"comment_ctime":1619831349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619831349","product_id":100029501,"comment_content":"RCä¸‹MVVCçš„ä¸€ä¸ªç–‘æƒ‘ç‚¹ã€‚<br><br>å‡è®¾ä¸¤ä¸ªäº‹åŠ¡å…ˆåå¼€å§‹ï¼Œäº‹åŠ¡Aï¼ˆäº‹åŠ¡ID100ï¼‰ã€äº‹åŠ¡Bï¼ˆäº‹åŠ¡ID101ï¼‰ã€‚<br>äº‹åŠ¡Bæ›´æ–°äº†ä¸€æ¡è®°å½•ï¼Œç„¶åæäº¤ï¼Œæ­¤æ—¶è¯¥è®°å½•çš„trx_id=101ã€‚<br>æ¥ç€äº‹åŠ¡Aå¯¹è¯¥è®°å½•è¿›è¡ŒæŸ¥è¯¢ï¼Œç”Ÿæˆè§†å›¾ï¼Œæ´»è·ƒçš„äº‹åŠ¡åˆ—è¡¨ä¸º [100]ï¼Œè€Œ101&gt;100ï¼ŒæŒ‰ç…§å¯è§è§„åˆ™ï¼Œç†åº”ä¸è®¿é—®ã€‚<br>æŒ‰ç…§MVVCçš„è§„åˆ™ï¼Œå¾—å‡ºçš„ç»“è®ºå’ŒRCåº”æœ‰çš„ç»“è®ºçŸ›ç›¾ã€‚<br><br>è¿™é‡Œçš„çŸ›ç›¾ï¼Œæ•°æ®åº“å…·ä½“æ˜¯å¦‚ä½•å¤„ç†çš„ï¼Ÿ<br>æˆ‘æ„Ÿè§‰è¿™ä¸ªå’Œè§†å›¾ä¸­æœ€å¤§äº‹åŠ¡idçš„ç”±æ¥æœ‰å…³ç³»ï¼Œä½†æ˜¯æƒ³ä¸æ˜ç™½<br><br>æˆ‘è¿™ä¸ªé—®é¢˜å’Œé™ˆé€¸æ–°åŒå­¦çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œå¸Œæœ›ä½œè€…è§£ç­”ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":260708,"user_name":"å‡¯æ–‡å°çŒª","can_delete":false,"product_type":"c1","uid":1980201,"ip_address":"","ucode":"36D8AD0229547F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","comment_is_top":false,"comment_ctime":1605086997,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605086997","product_id":100029501,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šè¯»çº¿ç¨‹å®é™…ä¸Šçœ‹çš„æ˜¯è„é¡µï¼Œæ­¤æ—¶ä¸ä½œä»»ä½•æœ‰æ•ˆæ€§ä¿è¯ï¼Œè‡ªç„¶MVCCä¹Ÿæ˜¯å¤šä½™çš„ã€‚æ¯”è¾ƒå¸¸è§çš„å°±æ˜¯ms sqlçš„with (nolock)<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼šç”ŸæˆreadVIewæ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰éš”ç¦»çº§åˆ«æ˜¯å¦ä¸ºRCï¼Œå¦‚æ˜¯ï¼Œåˆ™è°ƒç”¨read_view_close_for_mysql()ï¼Œé‚£ä¹ˆè‡ªç„¶æ¯æ¬¡rcéƒ½è¦é‡æ–°ç”Ÿæˆread viewï¼Œä¹Ÿå°±æ— æ³•è§£å†³å¯é‡å¤è¯»äº†","like_count":0},{"had_liked":false,"id":255443,"user_name":"è¢å¸…","can_delete":false,"product_type":"c1","uid":1084993,"ip_address":"","ucode":"A71A89B9F1BD69","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","comment_is_top":false,"comment_ctime":1603346223,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1603346223","product_id":100029501,"comment_content":"é‚£è¿™ä¹ˆè¯´ï¼Œåœ¨å¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œmysql ä¸å­˜åœ¨å¹»è¯»é—®é¢˜äº†ï¼Œæ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2815900,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/f7/9c/69c5c5dc.jpg","nickname":"è¶Šé”‹åˆ©","note":"","ucode":"63E9E3F3C7D53D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411919,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636032863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255439,"user_name":"ç™½èœ","can_delete":false,"product_type":"c1","uid":2230467,"ip_address":"","ucode":"C3AE527ECE970E","user_header":"https://static001.geekbang.org/account/avatar/00/22/08/c3/bf4fe285.jpg","comment_is_top":false,"comment_ctime":1603344351,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1603344351","product_id":100029501,"comment_content":"å…³äºä¸‰ä¸ªéšè—å­—æ®µï¼Œæˆ‘çœ‹äº†ä¸‹æ–‡æ¡£ï¼š<br>https:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;5.7&#47;en&#47;innodb-multi-versioning.html<br><br>Internally, InnoDB adds three fields to each row stored in the database. A 6-byte DB_TRX_ID field indicates the transaction identifier for the last transaction that inserted or updated the row. Also, a deletion is treated internally as an update where a special bit in the row is set to mark it as deleted. Each row also contains a 7-byte DB_ROLL_PTR field called the roll pointer. The roll pointer points to an undo log record written to the rollback segment. If the row was updated, the undo log record contains the information necessary to rebuild the content of the row before it was updated. A 6-byte DB_ROW_ID field contains a row ID that increases monotonically as new rows are inserted. If InnoDB generates a clustered index automatically, the index contains row ID values. Otherwise, the DB_ROW_ID column does not appear in any index.<br><br>å…¶ä¸­è¿˜æåˆ° â€œåˆ é™¤åœ¨å†…éƒ¨è¢«è§†ä¸ºæ›´æ–°ï¼Œå…¶ä¸­è¡Œä¸­çš„ä¸€ä¸ªç‰¹æ®Šä½è¢«è®¾ç½®ä¸ºå·²åˆ é™¤â€ï¼Œè¿™ä¸ªç‰¹æ®Šä½æ˜¯åœ¨è¿™ä¸‰ä¸ªéšè—å­—æ®µä¸­å—ï¼Ÿè¿˜æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å­—æ®µï¼ˆä¹Ÿå°±æ˜¯è¯´æœ‰å››ä¸ªéšè—å­—æ®µï¼‰ï¼Ÿ","like_count":0},{"had_liked":false,"id":251289,"user_name":"åº“æ·˜æ·˜","can_delete":false,"product_type":"c1","uid":1310240,"ip_address":"","ucode":"90813B0C46E978","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqibSwKPg7hiapc49qoM4dibhM3fYANPjfltF2ibBZ3dHX2hibjg5EIIcziahrmjO5R2XrcRibvU39TQS7jg/132","comment_is_top":false,"comment_ctime":1601451289,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601451289","product_id":100029501,"comment_content":"çœ‹äº†å¾ˆå¤šmvccä»‹ç»ï¼Œæ€»æ„Ÿè§‰ç†è§£ä¸é€å½»ï¼Œçœ‹åˆ°è€å¸ˆæ€»ç»“ï¼Œæ„Ÿè§‰æç„¶å¤§æ‚Ÿ  å‰å®³","like_count":0},{"had_liked":false,"id":249470,"user_name":"è¢å¸…","can_delete":false,"product_type":"c1","uid":1084993,"ip_address":"","ucode":"A71A89B9F1BD69","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/41/709e9677.jpg","comment_is_top":false,"comment_ctime":1600667242,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600667242","product_id":100029501,"comment_content":"&quot;è¿™æ˜¯å› ä¸ºé‡‡ç”¨äº† Next-Key é”ï¼Œä¼šå°† height&gt;2.08 çš„èŒƒå›´éƒ½è¿›è¡Œé”å®šï¼Œå°±æ— æ³•æ’å…¥ç¬¦åˆè¿™ä¸ªèŒƒå›´çš„æ•°æ®äº†&quot;<br><br>è¿™é‡Œheight  æ˜¯ä¸ªç´¢å¼•é”®æ‰ä¼š  é‡‡ç”¨ Next-Key å—ï¼Ÿ  å¦‚æœæ²¡åŠ ç´¢å¼•æ¥ç€ä¼šæœ‰  å¹»è¯»çš„æƒ…å†µå§<br>","like_count":0},{"had_liked":false,"id":248784,"user_name":"voyager.life","can_delete":false,"product_type":"c1","uid":1322902,"ip_address":"","ucode":"F4ED5FE161BFF0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoVYQQcjNoJVfvic0vicfHjgTD5ERr3Hax4v9CLsBackq1urO0jM9wcnlH4rQ8WBPd5dQ3zFy4icInsQ/132","comment_is_top":false,"comment_ctime":1600309509,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600309509","product_id":100029501,"comment_content":"ä¸€ä¸ªç–‘é—®ï¼šup_limit_id &lt; trx_id &lt; low_limit_id ä¸” creator_trx_id &lt; trx_id ä¸” trx_idä¸åœ¨ trx_idsé›†åˆï¼Œè¯´æ˜è¯¥æ¡è®°å½•ä½äº creator_trx_idäº‹åŠ¡ä¹‹ååˆ›å»ºçš„äº‹åŠ¡ä¹‹ä¸­å¹¶ä¸”è¯¥äº‹åŠ¡å·²ç»æäº¤ï¼Œè¿™æ—¶çš„è¡Œè®°å½•åº”è¯¥å¯¹creator_trx_idäº‹åŠ¡ä¸å¯è§ï¼Ÿé€»è¾‘å¦‚åŒ &quot;å¦‚æœ trx_id &gt; æ´»è·ƒçš„æœ€å¤§äº‹åŠ¡ IDï¼ˆlow_limit_idï¼‰ï¼Œè¿™è¯´æ˜è¯¥è¡Œè®°å½•åœ¨è¿™äº›æ´»è·ƒçš„äº‹åŠ¡åˆ›å»ºä¹‹åæ‰åˆ›å»ºï¼Œé‚£ä¹ˆè¿™ä¸ªè¡Œè®°å½•å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚&quot;","like_count":0},{"had_liked":false,"id":232569,"user_name":"charles rong","can_delete":false,"product_type":"c1","uid":2042738,"ip_address":"","ucode":"3E1ABB7C26A0F1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/BreNqD709wsLj9uaQRXZxPwibPSibs1ylH1OKVl2QV5deCJricFVqXDRJFNBIb59wiasmvMnrgqcvZ8RLwhOkszCww/132","comment_is_top":false,"comment_ctime":1594040450,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594040450","product_id":100029501,"comment_content":"æ˜¯å¦å¯ä»¥è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆå¯é‡å¤è¯»éš”ç¦»çº§åˆ«çš„MVCCçš„undo logå’Œread-viewä¸èƒ½è§£å†³å¹»è¯»ï¼Ÿæˆ‘æ„Ÿè§‰å¯ä»¥å•Šã€‚<br>å‡è®¾äº‹åŠ¡10ç¬¬ä¸€æ¬¡ç»Ÿè®¡é«˜åº¦å¤§äº2.08çš„æ•°æ®é¡¹ä¸ªæ•°ï¼Œç„¶åäº‹åŠ¡11æ’å…¥ä¸€æ¡é«˜åº¦å¤§äº2.08çš„æ•°æ®é¡¹Xï¼Œç„¶åäº‹åŠ¡10ç¬¬äºŒæ¬¡ç»Ÿè®¡é«˜åº¦å¤§äº2.08çš„æ•°æ®é¡¹ä¸ªæ•°ã€‚ç”±äºç¬¬ä¸€æ¬¡è¯»å’Œç¬¬äºŒæ¬¡è¯»ç”¨äº†åŒä¸€ä¸ªread-viewï¼Œé‚£ä¹ˆåˆ›å»ºæ•°æ®é¡¹Xçš„äº‹åŠ¡11åº”è¯¥æ˜¯read-viewçš„æ´»è·ƒäº‹åŠ¡ï¼Œç¬¬äºŒæ¬¡è¯»ä¹Ÿä¸ä¼šè¢«è¯»å‡ºæ¥ï¼Œé‚£è¿™æ ·ä¹Ÿä¸ä¼šæœ‰å¹»è¯»çš„é”™è¯¯å•Šï¼Ÿï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":228718,"user_name":"Marvin","can_delete":false,"product_type":"c1","uid":1138706,"ip_address":"","ucode":"D955A98C48CBEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/12/268826e6.jpg","comment_is_top":false,"comment_ctime":1592794077,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592794077","product_id":100029501,"comment_content":"æœ€åå‡ ä¸ªä¾‹å­çš„ä¸­å¿ƒæ€æƒ³ï¼Œä¸çŸ¥é“å¯¹ä¸å¯¹ã€‚<br><br>1. æ™®é€šçš„selectè¯­å¥ï¼Œåˆ©ç”¨mvccçš„read viewå°±å¯ä»¥è§£å†³å¹»è¯»ï¼Œå› ä¸ºè¯»å–çš„æ˜¯&quot;å†å²è®°å½•&quot;ã€‚<br>2. slelectåŠ ä¸Šfor updateçš„å­å¥ï¼Œå…¶å®æ˜¯åŠ ä¸Šäº†æ’ä»–é”ï¼Œæ­¤æ—¶å¦‚æœæ˜¯&quot;è¯»å·²æäº¤&quot;çš„éš”ç¦»çº§åˆ«ï¼Œå…¶ä»–äº‹åŠ¡æ˜¯å¯ä»¥insertçš„ï¼Œå› ä¸ºå½“å‰è¡Œé”çš„å®ç°æ˜¯è®°å½•é”, é€ æˆå¹»è¯»ã€‚ä½†æ˜¯å¦‚æœä¿®æ”¹ä¸º&quot;å¯é‡å¤è¯»çš„&quot;éš”ç¦»çº§åˆ«ï¼Œè¡Œé”å®ç°ä¿®æ”¹ä¸ºnext-key,  æ­¤æ—¶å…¶ä»–çº¿ç¨‹çš„insertä¼šè¢«é˜»æ­¢ï¼Œæ— æ³•å¹¶å‘ï¼Œè§£å†³äº†å¹»è¯»çš„é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":222392,"user_name":"é›©è€Œé›¨","can_delete":false,"product_type":"c1","uid":1879570,"ip_address":"","ucode":"0311B11F806AFB","user_header":"https://static001.geekbang.org/account/avatar/00/1c/ae/12/a7c1f5da.jpg","comment_is_top":false,"comment_ctime":1590775236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590775236","product_id":100029501,"comment_content":"æœ‰é”™ï¼šmax_trx_idåº”è¯¥æ˜¯ä¸‹ä¸€ä¸ªæœªè¢«åˆ†é…çš„äº‹åŠ¡ID<br>MySQL5.6ï¼š<br>view-&gt;low_limit_no = trx_sys-&gt;max_trx_id;<br>max_trx_idï¼šThe smallest number not yet assigned as a transaction id or transaction number","like_count":0},{"had_liked":false,"id":201554,"user_name":"æ—æ—","can_delete":false,"product_type":"c1","uid":1613227,"ip_address":"","ucode":"7B6318B971E430","user_header":"https://static001.geekbang.org/account/avatar/00/18/9d/ab/6589d91a.jpg","comment_is_top":false,"comment_ctime":1585803109,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585803109","product_id":100029501,"comment_content":"è¯»å·²æäº¤çš„read viewæ˜¯åªåœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶åšé™åˆ¶ï¼Œå¯é‡å¤è¯»çš„read viewæ˜¯åœ¨æ¯ä¸€æ¬¡æŸ¥è¯¢æ—¶éƒ½åšé™åˆ¶","like_count":0,"discussions":[{"author":{"id":1613227,"avatar":"https://static001.geekbang.org/account/avatar/00/18/9d/ab/6589d91a.jpg","nickname":"æ—æ—","note":"","ucode":"7B6318B971E430","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219762,"discussion_content":"åè¿‡æ¥äº†ï¼Œè¯»å·²æäº¤æ—¶ï¼Œæ˜¯æ¯æ¬¡selectéƒ½åˆ›å»ºread viewï¼Œè€Œå¯é‡å¤è¯»æ˜¯ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡selectæ—¶æ‰åˆ›å»ºread view","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585803768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177813,"user_name":"Geek_ade3cb","can_delete":false,"product_type":"c1","uid":1815632,"ip_address":"","ucode":"5DD2BAF1E1DDF3","user_header":"","comment_is_top":false,"comment_ctime":1581507126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581507126","product_id":100029501,"comment_content":"è¯·é—®ä¸€ä¸‹ï¼Œå¦‚æœæŸè¡Œè®°å½•xå½“å‰çš„æ´»è·ƒäº‹åŠ¡æ˜¯[2,3]ã€‚æ­¤æ—¶ç‰ˆæœ¬å·ä¸º4çš„äº‹åŠ¡æƒ³è¦ä¿®æ”¹è¯¥è¡Œè®°å½•ï¼Œæ ¹æ®mvccï¼Œä»–ä¼šæ‹¿åˆ°ç‰ˆæœ¬å·ä¸º1çš„xï¼Œè¿›è¡Œä¿®æ”¹ï¼Œæäº¤ä¿®æ”¹ï¼Œå¹¶å°†xçš„ç‰ˆæœ¬å·å˜ä¸º4ã€‚ä¹‹åç‰ˆæœ¬å·ä¸º5çš„äº‹åŠ¡æŸ¥è¯¢äº‹åŠ¡xæ—¶ï¼Œæ˜¯å¦ä¹Ÿåªèƒ½æ‹¿åˆ°ç‰ˆæœ¬å·ä¸º1çš„xï¼ˆå› ä¸ºç‰ˆæœ¬å·4å¤§äºå½“å‰æ´»è·ƒäº‹åŠ¡[2,3]ï¼‰ï¼Ÿé‚£è¿™æ ·æ˜¯å¦ä¼šå¯¼è‡´æ•°æ®åº“æŸ¥è¯¢ä¸åˆ°ä¹‹å‰è‡ªå·±ä¿®æ”¹å¹¶å·²æäº¤çš„æ•°æ®ï¼Ÿæ±‚è€å¸ˆè§£ç­”","like_count":0},{"had_liked":false,"id":169488,"user_name":"rike","can_delete":false,"product_type":"c1","uid":1583833,"ip_address":"","ucode":"920AAD0BD9245C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","comment_is_top":false,"comment_ctime":1578364471,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578364471","product_id":100029501,"comment_content":"äº‹åŠ¡å¹¶å‘å¤„ç†çš„3ä¸ªå¼‚å¸¸ï¼Œåœ¨15è®²ä¸­çš„ä¾‹å­æˆ‘è¯•äº†ï¼ŒæŠŠäº‹åŠ¡éš”ç¦»çº§åˆ«ä¿®æ”¹åï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«ä¸äº‹åŠ¡å¹¶å‘å¤„ç†å›¾ä¸­çš„ç°è±¡ä¸å®é™…çš„æ‰§è¡Œç»“æœæ— æ³•å¯¹åº”ï¼Œæˆ‘ä¸Šç½‘æŸ¥äº†å¾ˆå¤šæ–‡ç« ï¼Œçœ‹ä¸æ˜ç™½ï¼Œä¹Ÿè¯¢é—®äº†ä¸€äº›dbaï¼Œä»–ä»¬éƒ½è®²ä¸æ˜ç™½ï¼Œä»–ä»¬è¯´äº‹åŠ¡å¹¶å‘å¤„ç†çš„3ä¸ªå¼‚å¸¸åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä»–ä»¬åªæ˜¯åœç•™åœ¨ç†è®ºçš„å±‚é¢ä¸Šï¼Œå› ä¸ºæ•°æ®åº“ä¸æ˜¯æˆ‘å¼€å‘çš„ï¼Œè¿™ä¸ªæˆ‘ä¹Ÿä¸æ‡‚ã€‚","like_count":0},{"had_liked":false,"id":165295,"user_name":"ballgod","can_delete":false,"product_type":"c1","uid":1584098,"ip_address":"","ucode":"C20E95E98EAC43","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIR9QrAn9TZOrJMSYMyN96PAuAjETVrN5SPp3hMbfUAGIWtHceWPEoQtPdXeuBn7VB7dagtxynAIA/132","comment_is_top":false,"comment_ctime":1577195122,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1577195122","product_id":100029501,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼Œè§£å†³æ–¹æ³•æ˜¯æœ‰ä¸¤ç§ï¼š1ï¼‰è®¾ç½®ä¸²è¡ŒåŒ– 2ï¼‰è®¾ç½®ä¸ºå¯é‡å¤è¯»ï¼ŒåŒæ—¶é‡‡ç”¨mvcc + next-keyè§£å†³ã€‚ç¬¬ä¸€ç§æ˜¯å¯ä»¥é€šè¿‡è®¾ç½®éš”ç¦»æ–¹å¼å®ç°ã€‚ç¬¬äºŒç§æ˜¯å¦‚ä½•å®ç°ï¼Ÿæ˜¯è®¾ç½®ä¸ºå¯é‡å¤è¯»åç„¶åå†æ€ä¹ˆæ“ä½œæ‰èƒ½ä½¿ç”¨mvccæœºåˆ¶æˆ–è€…è¯´å…·ä½“æ˜¯å¦‚ä½•å®ç°ï¼Ÿ  ä¸çŸ¥é“è¿™æ ·è¡¨è¿°æ˜¯å¦æ­£ç¡®ï¼Œéº»çƒ¦è€å¸ˆæŒ‡ç‚¹ï¼Œè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1024164,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","nickname":"é˜¿æ–¯è’‚èŠ¬","note":"","ucode":"61D5E3BDA4EBC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280647,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œå¦‚æœmvccå’Œé”éƒ½æ˜¯InnoDBè‡ªåŠ¨è§¦å‘çš„ï¼Œé‚£ä¹ˆæŒ‰ç†å¯é‡å¤è¯»å°±å·²ç»è§£å†³äº†å¹»è¯»é—®é¢˜ï¼Œä½†æ˜¯å®é™…ä¸Šæ‰€æœ‰çš„èµ„æ–™éƒ½è¡¨ç¤ºå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹è¿˜æ˜¯æœ‰å¹»è¯»çš„å¯èƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591585878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137770,"user_name":"GLADIATOR","can_delete":false,"product_type":"c1","uid":1448564,"ip_address":"","ucode":"6FE14E0BCD6240","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/74/8f7f8786.jpg","comment_is_top":false,"comment_ctime":1569840888,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569840888","product_id":100029501,"comment_content":"MySQLå¯é‡å¤è¯»åŠ next keyæ˜¯å¯ä»¥è§£å†³å¹»è¯»çš„","like_count":0},{"had_liked":false,"id":133972,"user_name":"studyï½","can_delete":false,"product_type":"c1","uid":1621959,"ip_address":"","ucode":"6EFD4E284CD22F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJBG6cXQGiayJlFxTeN3IPOichoX5NjdhqTt8rmyiaJDfd5VytLSrjwrufDAOdpoxFuROOLiawFh0mnBg/132","comment_is_top":false,"comment_ctime":1568709283,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1568709283","product_id":100029501,"comment_content":"æ—¢ç„¶ äº‹åŠ¡Aå·²ç»ä¸Šäº† æ’ä»–é”ï¼Œï¼Œå…¶ä»–ç”¨æˆ·æ€ä¹ˆå¯ä»¥å¯¹ä¸Šé”çš„è®°å½•è¿›è¡Œä¿®æ”¹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1188679,"avatar":"https://static001.geekbang.org/account/avatar/00/12/23/47/b44e3e80.jpg","nickname":"Guan","note":"","ucode":"EDE51DBE7A736D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":38052,"discussion_content":"å› ä¸ºåªé”äº†è¡Œï¼Œæ²¡æœ‰é”åŒºé—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571717528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132805,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1568243127,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568243127","product_id":100029501,"comment_content":"åœ¨ Read VIew ä¸­æœ‰å‡ ä¸ªé‡è¦çš„å±æ€§ï¼š<br><br>trx_idsï¼Œç³»ç»Ÿå½“å‰æ­£åœ¨æ´»è·ƒçš„äº‹åŠ¡ ID é›†åˆã€‚è¿™ä¸ªäº‹åŠ¡IDé›†åˆæ˜¯é’ˆå¯¹è¿™ä¸€è¡Œçš„äº‹ç‰©é›†åˆå§ï¼Œä¸æ˜¯æ•´ä¸ªmysqlçš„ç³»ç»Ÿäº‹åŠ¡é›†åˆ","like_count":0},{"had_liked":false,"id":126270,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1566355365,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566355365","product_id":100029501,"comment_content":"InnoDBçš„MVCCä¸å¯ä»¥é˜²æ­¢å‡ºç°å¹»è¯»å—ï¼Ÿæ¯”å¦‚æ–‡ä¸­çš„ä¾‹å­ï¼ŒAäº‹ä»¶åœ¨å¼€å¯çš„æ—¶å€™ï¼ŒBäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼Œåœ¨Aäº‹ä»¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­Bäº‹åŠ¡æäº¤äº†ï¼Œåœ¨Aäº‹åŠ¡è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œé€šè¿‡æŸ¥è¯¢Read Viewï¼Œåº”è¯¥ä¼šå‘ç°Bæäº¤çš„è¡Œè®°å½•æ˜¯æ´»è·ƒçš„æˆ–è€…æœªæäº¤çš„äº‹åŠ¡idï¼Œæ‰€ä»¥å°±ç®—æ²¡æœ‰Next-keyé”ï¼ŒAäº‹åŠ¡ä¹Ÿè¯»ä¸åˆ°Bäº‹åŠ¡æäº¤çš„æ•°æ®å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":126267,"user_name":"LW","can_delete":false,"product_type":"c1","uid":1325297,"ip_address":"","ucode":"89820332658E98","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/f1/996a070d.jpg","comment_is_top":false,"comment_ctime":1566355231,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566355231","product_id":100029501,"comment_content":"è¯»æœªæäº¤çš„æ„æ€å°±æ˜¯æ‰€æœ‰æ›´æ–°éƒ½å¯è§ï¼Œæ‰€ä»¥æ²¡å¿…è¦ç”¨MVCCæœºåˆ¶äº†ã€‚è¯»å·²æäº¤æ¯æ¬¡è¯»éƒ½è¦æ£€æŸ¥å½“å‰çš„æ´»è·ƒäº‹åŠ¡æ›´æ–°Read Viewï¼Œä¿è¯å¯ä»¥è¯»åˆ°å…¶ä»–äº‹åŠ¡æäº¤çš„æœ€æ–°æ•°æ®ã€‚å¯é‡å¤è¯»çš„Read Viewæ˜¯è®°å½•å½“å‰äº‹åŠ¡å¼€å§‹æ—¶çš„æ´»è·ƒäº‹åŠ¡ï¼Œè¿™æ ·åœ¨å½“å‰äº‹åŠ¡å¤„ç†æœŸé—´ï¼Œæ‰èƒ½é¿å…å…¶ä»–äº‹åŠ¡æäº¤åå‡ºç°å¹»è¯»ã€‚","like_count":0},{"had_liked":false,"id":126253,"user_name":"æˆ‘è¡Œæˆ‘ç´ ","can_delete":false,"product_type":"c1","uid":1224678,"ip_address":"","ucode":"4C69542FAB0671","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/e6/9c77acff.jpg","comment_is_top":false,"comment_ctime":1566353438,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566353438","product_id":100029501,"comment_content":"2.è¯»å·²æäº¤çš„éš”ç¦»çº§åˆ«ä¸‹ï¼ŒåŒæ ·çš„æŸ¥è¯¢è¯­å¥éƒ½ä¼šé‡æ–°è·å–Read Viewï¼Œ<br>å¯é‡å¤çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸€ä¸ªäº‹ç‰©åªåœ¨ç¬¬ä¸€æ¬¡SELECTçš„æ—¶å€™è·å–ä¸€æ¬¡Read View","like_count":0},{"had_liked":false,"id":126219,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1566350972,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566350972","product_id":100029501,"comment_content":"æœ€åä¸€ä¸ªå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼Œå½“äº‹åŠ¡Aè¯»çš„æ—¶å€™ï¼Œå¦‚æœäº‹åŠ¡Bæ–°å¢çš„æ—¶å€™é¦–å…ˆæ˜¯ä¼šé˜»å¡å§ï¼Ÿå¦‚æœé˜»å¡æ—¶é—´è¶…è¿‡æœ€å¤§äº‹åŠ¡è¶…æ—¶æ—¶é—´æ‰ä¼šæŠ¥é”™ï¼Œæ„Ÿè§‰è¿™ä¸ªåœ°æ–¹è¯´ç›´æ¥æŠ¥é”™ï¼Œå¯èƒ½æœ‰äº›ç«¥é‹ä¼šæœ‰è¯¯è§£ï½","like_count":0}]}