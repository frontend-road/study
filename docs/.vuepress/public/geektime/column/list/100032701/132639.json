{"id":132639,"title":"17 | TCPå¹¶ä¸æ€»æ˜¯â€œå¯é â€çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç››å»¶æ•ï¼Œè¿™é‡Œæ˜¯ç½‘ç»œç¼–ç¨‹å®æˆ˜ç¬¬17è®²ï¼Œæ¬¢è¿å›æ¥ã€‚</p><p>åœ¨å‰é¢ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°å¦‚ä½•ç†è§£TCPæ•°æ®æµçš„æœ¬è´¨ï¼Œè¿›è€Œå¼•å‡ºäº†æŠ¥æ–‡æ ¼å¼å’Œè§£æã€‚åœ¨è¿™ä¸€è®²é‡Œï¼Œæˆ‘ä»¬è®¨è®ºé€šè¿‡å¦‚ä½•å¢å¼ºè¯»å†™æ“ä½œï¼Œä»¥å¤„ç†å„ç§â€œä¸å¯é â€çš„åœºæ™¯ã€‚</p><h2>TCPæ˜¯å¯é çš„ï¼Ÿ</h2><p>ä½ å¯èƒ½ä¼šè®¤ä¸ºï¼ŒTCPæ˜¯ä¸€ç§å¯é çš„åè®®ï¼Œè¿™ç§å¯é ä½“ç°åœ¨ç«¯åˆ°ç«¯çš„é€šä¿¡ä¸Šã€‚è¿™ä¼¼ä¹ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€ç§é”™è§‰ï¼Œä»å‘é€ç«¯æ¥çœ‹ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡è°ƒç”¨sendå‡½æ•°å‘é€çš„æ•°æ®æµæ€»èƒ½å¯é åœ°åˆ°è¾¾æ¥æ”¶ç«¯ï¼›è€Œä»æ¥æ”¶ç«¯æ¥çœ‹ï¼Œæ€»æ˜¯å¯ä»¥æŠŠå¯¹ç«¯å‘é€çš„æ•°æ®æµå®Œæ•´æ— æŸåœ°ä¼ é€’ç»™åº”ç”¨ç¨‹åºæ¥å¤„ç†ã€‚</p><p>äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å¯¹TCPä¼ è¾“ç¯èŠ‚è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œä½ å°±ä¼šæ²®ä¸§åœ°å‘ç°ï¼Œä¸Šè¿°è®ºæ–­æ˜¯ä¸æ­£ç¡®çš„ã€‚</p><p>å‰é¢æˆ‘ä»¬å·²ç»äº†è§£ï¼Œå‘é€ç«¯é€šè¿‡è°ƒç”¨sendå‡½æ•°ä¹‹åï¼Œæ•°æ®æµå¹¶æ²¡æœ‰é©¬ä¸Šé€šè¿‡ç½‘ç»œä¼ è¾“å‡ºå»ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨å¥—æ¥å­—çš„å‘é€ç¼“å†²åŒºä¸­ï¼Œç”±ç½‘ç»œåè®®æ ˆå†³å®šä½•æ—¶å‘é€ã€å¦‚ä½•å‘é€ã€‚å½“å¯¹åº”çš„æ•°æ®å‘é€ç»™æ¥æ”¶ç«¯ï¼Œæ¥æ”¶ç«¯å›åº”ACKï¼Œå­˜å‚¨åœ¨å‘é€ç¼“å†²åŒºçš„è¿™éƒ¨åˆ†æ•°æ®å°±å¯ä»¥åˆ é™¤äº†ï¼Œä½†æ˜¯ï¼Œå‘é€ç«¯å¹¶æ— æ³•è·å–å¯¹åº”æ•°æ®æµçš„ACKæƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ç«¯æ²¡æœ‰åŠæ³•åˆ¤æ–­å¯¹ç«¯çš„æ¥æ”¶æ–¹æ˜¯å¦å·²ç»æ¥æ”¶å‘é€çš„æ•°æ®æµï¼Œå¦‚æœéœ€è¦çŸ¥é“è¿™éƒ¨åˆ†ä¿¡æ¯ï¼Œå°±å¿…é¡»åœ¨åº”ç”¨å±‚è‡ªå·±æ·»åŠ å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚æ˜¾å¼çš„æŠ¥æ–‡ç¡®è®¤æœºåˆ¶ã€‚</p><p>ä»æ¥æ”¶ç«¯æ¥è¯´ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•ä¿è¯ACKè¿‡çš„æ•°æ®éƒ¨åˆ†å¯ä»¥è¢«åº”ç”¨ç¨‹åºå¤„ç†ï¼Œå› ä¸ºæ•°æ®éœ€è¦æ¥æ”¶ç«¯ç¨‹åºä»æ¥æ”¶ç¼“å†²åŒºä¸­æ‹·è´ï¼Œå¯èƒ½å‡ºç°çš„çŠ¶å†µæ˜¯ï¼Œå·²ç»ACKçš„æ•°æ®ä¿å­˜åœ¨æ¥æ”¶ç«¯ç¼“å†²åŒºä¸­ï¼Œæ¥æ”¶ç«¯å¤„ç†ç¨‹åºçªç„¶å´©æºƒäº†ï¼Œè¿™éƒ¨åˆ†æ•°æ®å°±æ²¡æœ‰åŠæ³•è¢«åº”ç”¨ç¨‹åºç»§ç»­å¤„ç†ã€‚</p><!-- [[[read_end]]] --><p>ä½ æœ‰æ²¡æœ‰å‘ç°ï¼ŒTCPåè®®å®ç°å¹¶æ²¡æœ‰æä¾›ç»™ä¸Šå±‚åº”ç”¨ç¨‹åºè¿‡å¤šçš„å¼‚å¸¸å¤„ç†ç»†èŠ‚ï¼Œæˆ–è€…è¯´ï¼ŒTCPåè®®åæ˜ é“¾è·¯å¼‚å¸¸çš„èƒ½åŠ›åå¼±ï¼Œè¿™å…¶å®æ˜¯æœ‰åŸå› çš„ã€‚è¦çŸ¥é“ï¼ŒTCPè¯ç”Ÿä¹‹åˆï¼Œå°±æ˜¯ä¸ºç¾å›½å›½é˜²éƒ¨æœåŠ¡çš„ï¼Œè€ƒè™‘åˆ°å†›äº‹ä½œæˆ˜çš„å®é™…éœ€è¦ï¼ŒTCPä¸å¸Œæœ›æš´éœ²æ›´å¤šçš„å¼‚å¸¸ç»†èŠ‚ï¼Œè€Œæ˜¯èƒ½å¤Ÿä»¥æ— äººå€¼å®ˆã€è‡ªæˆ‘æ¢å¤çš„æ–¹å¼è¿ä½œã€‚</p><p>TCPè¿æ¥å»ºç«‹ä¹‹åï¼Œèƒ½æ„ŸçŸ¥TCPé“¾è·¯çš„æ–¹å¼æ˜¯æœ‰é™çš„ï¼Œä¸€ç§æ˜¯ä»¥readä¸ºæ ¸å¿ƒçš„è¯»æ“ä½œï¼Œå¦ä¸€ç§æ˜¯ä»¥writeä¸ºæ ¸å¿ƒçš„å†™æ“ä½œã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±çœ‹ä¸‹å¦‚ä½•é€šè¿‡è¯»å†™æ“ä½œæ¥æ„ŸçŸ¥å¼‚å¸¸æƒ…å†µï¼Œä»¥åŠå¯¹åº”çš„å¤„ç†æ–¹å¼ã€‚</p><h2>æ•…éšœæ¨¡å¼æ€»ç»“</h2><p>åœ¨å®é™…æƒ…æ™¯ä¸­ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°å„ç§å¼‚å¸¸çš„æƒ…å†µã€‚åœ¨è¿™é‡Œæˆ‘æŠŠè¿™å‡ ç§å¼‚å¸¸æƒ…å†µå½’ç»“ä¸ºä¸¤å¤§ç±»ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/39/af/39b060fa90628db95fd33305dc6fc7af.png?wh=1466*490\" alt=\"\"><br>\nç¬¬ä¸€ç±»ï¼Œæ˜¯å¯¹ç«¯æ— FINåŒ…å‘é€å‡ºæ¥çš„æƒ…å†µï¼›ç¬¬äºŒç±»æ˜¯å¯¹ç«¯æœ‰FINåŒ…å‘é€å‡ºæ¥ã€‚è€Œè¿™ä¸¤å¤§ç±»æƒ…å†µåˆå¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºçš„åœºæ™¯ç»†åˆ†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†è®¨è®ºã€‚</p><h2>ç½‘ç»œä¸­æ–­é€ æˆçš„å¯¹ç«¯æ— FINåŒ…</h2><p>å¾ˆå¤šåŸå› éƒ½ä¼šé€ æˆç½‘ç»œä¸­æ–­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒTCPç¨‹åºå¹¶ä¸èƒ½åŠæ—¶æ„ŸçŸ¥åˆ°å¼‚å¸¸ä¿¡æ¯ã€‚é™¤éç½‘ç»œä¸­çš„å…¶ä»–è®¾å¤‡ï¼Œå¦‚è·¯ç”±å™¨å‘å‡ºä¸€æ¡ICMPæŠ¥æ–‡ï¼Œè¯´æ˜ç›®çš„ç½‘ç»œæˆ–ä¸»æœºä¸å¯è¾¾ï¼Œè¿™ä¸ªæ—¶å€™é€šè¿‡readæˆ–writeè°ƒç”¨å°±ä¼šè¿”å›Unreachableçš„é”™è¯¯ã€‚</p><p>å¯æƒœå¤§å¤šæ•°æ—¶å€™å¹¶ä¸æ˜¯å¦‚æ­¤ï¼Œåœ¨æ²¡æœ‰ICMPæŠ¥æ–‡çš„æƒ…å†µä¸‹ï¼ŒTCPç¨‹åºå¹¶ä¸èƒ½ç†è§£æ„Ÿåº”åˆ°è¿æ¥å¼‚å¸¸ã€‚å¦‚æœç¨‹åºæ˜¯é˜»å¡åœ¨readè°ƒç”¨ä¸Šï¼Œé‚£ä¹ˆå¾ˆä¸å¹¸ï¼Œç¨‹åºæ— æ³•ä»å¼‚å¸¸ä¸­æ¢å¤ã€‚è¿™æ˜¾ç„¶æ˜¯éå¸¸ä¸åˆç†çš„ï¼Œä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™readæ“ä½œè®¾ç½®è¶…æ—¶æ¥è§£å†³ï¼Œåœ¨æ¥ä¸‹æ¥çš„ç¬¬18è®²ä¸­ï¼Œæˆ‘ä¼šè®²åˆ°å…·ä½“çš„æ–¹æ³•ã€‚</p><p>å¦‚æœç¨‹åºå…ˆè°ƒç”¨äº†writeæ“ä½œå‘é€äº†ä¸€æ®µæ•°æ®æµï¼Œæ¥ä¸‹æ¥é˜»å¡åœ¨readè°ƒç”¨ä¸Šï¼Œç»“æœä¼šéå¸¸ä¸åŒã€‚Linuxç³»ç»Ÿçš„TCPåè®®æ ˆä¼šä¸æ–­å°è¯•å°†å‘é€ç¼“å†²åŒºçš„æ•°æ®å‘é€å‡ºå»ï¼Œå¤§æ¦‚åœ¨é‡ä¼ 12æ¬¡ã€åˆè®¡æ—¶é—´çº¦ä¸º9åˆ†é’Ÿä¹‹åï¼Œåè®®æ ˆä¼šæ ‡è¯†è¯¥è¿æ¥å¼‚å¸¸ï¼Œè¿™æ—¶ï¼Œé˜»å¡çš„readè°ƒç”¨ä¼šè¿”å›ä¸€æ¡TIMEOUTçš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ­¤æ—¶ç¨‹åºè¿˜æ‰§ç€åœ°å¾€è¿™æ¡è¿æ¥å†™æ•°æ®ï¼Œå†™æ“ä½œä¼šç«‹å³å¤±è´¥ï¼Œè¿”å›ä¸€ä¸ªSIGPIPEä¿¡å·ç»™åº”ç”¨ç¨‹åºã€‚</p><h2>ç³»ç»Ÿå´©æºƒé€ æˆçš„å¯¹ç«¯æ— FINåŒ…</h2><p>å½“ç³»ç»Ÿçªç„¶å´©æºƒï¼Œå¦‚æ–­ç”µæ—¶ï¼Œç½‘ç»œè¿æ¥ä¸Šæ¥ä¸åŠå‘å‡ºä»»ä½•ä¸œè¥¿ã€‚è¿™é‡Œå’Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨æ€æ­»åº”ç”¨ç¨‹åºéå¸¸ä¸åŒçš„æ˜¯ï¼Œæ²¡æœ‰ä»»ä½•FINåŒ…è¢«å‘é€å‡ºæ¥ã€‚</p><p>è¿™ç§æƒ…å†µå’Œç½‘ç»œä¸­æ–­é€ æˆçš„ç»“æœéå¸¸ç±»ä¼¼ï¼Œåœ¨æ²¡æœ‰ICMPæŠ¥æ–‡çš„æƒ…å†µä¸‹ï¼ŒTCPç¨‹åºåªèƒ½é€šè¿‡readå’Œwriteè°ƒç”¨å¾—åˆ°ç½‘ç»œè¿æ¥å¼‚å¸¸çš„ä¿¡æ¯ï¼Œè¶…æ—¶é”™è¯¯æ˜¯ä¸€ä¸ªå¸¸è§çš„ç»“æœã€‚</p><p>ä¸è¿‡è¿˜æœ‰ä¸€ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼Œé‚£å°±æ˜¯ç³»ç»Ÿåœ¨å´©æºƒä¹‹ååˆé‡å¯ï¼Œå½“é‡ä¼ çš„TCPåˆ†ç»„åˆ°è¾¾é‡å¯åçš„ç³»ç»Ÿï¼Œç”±äºç³»ç»Ÿä¸­æ²¡æœ‰è¯¥TCPåˆ†ç»„å¯¹åº”çš„è¿æ¥æ•°æ®ï¼Œç³»ç»Ÿä¼šè¿”å›ä¸€ä¸ªRSTé‡ç½®åˆ†èŠ‚ï¼ŒTCPç¨‹åºé€šè¿‡readæˆ–writeè°ƒç”¨å¯ä»¥åˆ†åˆ«å¯¹RSTè¿›è¡Œé”™è¯¯å¤„ç†ã€‚</p><p>å¦‚æœæ˜¯é˜»å¡çš„readè°ƒç”¨ï¼Œä¼šç«‹å³è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ä¸ºè¿æ¥é‡ç½®ï¼ˆConnection Resetï¼‰ã€‚</p><p>å¦‚æœæ˜¯ä¸€æ¬¡writeæ“ä½œï¼Œä¹Ÿä¼šç«‹å³å¤±è´¥ï¼Œåº”ç”¨ç¨‹åºä¼šè¢«è¿”å›ä¸€ä¸ªSIGPIPEä¿¡å·ã€‚</p><h2>å¯¹ç«¯æœ‰FINåŒ…å‘å‡º</h2><p>å¯¹ç«¯å¦‚æœæœ‰FINåŒ…å‘å‡ºï¼Œå¯èƒ½çš„åœºæ™¯æ˜¯å¯¹ç«¯è°ƒç”¨äº†closeæˆ–shutdownæ˜¾å¼åœ°å…³é—­äº†è¿æ¥ï¼Œä¹Ÿå¯èƒ½æ˜¯å¯¹ç«¯åº”ç”¨ç¨‹åºå´©æºƒï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä»£ä¸ºæ¸…ç†æ‰€å‘å‡ºçš„ã€‚ä»åº”ç”¨ç¨‹åºè§’åº¦ä¸Šçœ‹ï¼Œæ— æ³•åŒºåˆ†æ˜¯å“ªç§æƒ…å½¢ã€‚</p><p>é˜»å¡çš„readæ“ä½œåœ¨å®Œæˆæ­£å¸¸æ¥æ”¶çš„æ•°æ®è¯»å–ä¹‹åï¼ŒFINåŒ…ä¼šé€šè¿‡è¿”å›ä¸€ä¸ªEOFæ¥å®Œæˆé€šçŸ¥ï¼Œæ­¤æ—¶ï¼Œreadè°ƒç”¨è¿”å›å€¼ä¸º0ã€‚è¿™é‡Œå¼ºè°ƒä¸€ç‚¹ï¼Œæ”¶åˆ°FINåŒ…ä¹‹åreadæ“ä½œä¸ä¼šç«‹å³è¿”å›ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ”¶åˆ°FINåŒ…ç›¸å½“äºå¾€æ¥æ”¶ç¼“å†²åŒºé‡Œæ”¾ç½®äº†ä¸€ä¸ªEOFç¬¦å·ï¼Œä¹‹å‰å·²ç»åœ¨æ¥æ”¶ç¼“å†²åŒºçš„æœ‰æ•ˆæ•°æ®ä¸ä¼šå—åˆ°å½±å“ã€‚</p><p>ä¸ºäº†å±•ç¤ºè¿™äº›ç‰¹æ€§ï¼Œæˆ‘åˆ†åˆ«ç¼–å†™äº†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºã€‚</p><pre><code>//æœåŠ¡ç«¯ç¨‹åº\nint main(int argc, char **argv) {\n    int connfd;\n    char buf[1024];\n\n    connfd = tcp_server(SERV_PORT);\n\n    for (;;) {\n        int n = read(connfd, buf, 1024);\n        if (n &lt; 0) {\n            error(1, errno, &quot;error read&quot;);\n        } else if (n == 0) {\n            error(1, 0, &quot;client closed \\n&quot;);\n        }\n\n        sleep(5);\n\n        int write_nc = send(connfd, buf, n, 0);\n        printf(&quot;send bytes: %zu \\n&quot;, write_nc);\n        if (write_nc &lt; 0) {\n            error(1, errno, &quot;error write&quot;);\n        }\n    }\n\n    exit(0);\n}\n</code></pre><p>æœåŠ¡ç«¯ç¨‹åºæ˜¯ä¸€ä¸ªç®€å•çš„åº”ç­”ç¨‹åºï¼Œåœ¨æ”¶åˆ°æ•°æ®æµä¹‹åå›æ˜¾ç»™å®¢æˆ·ç«¯ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œä¼‘çœ 5ç§’ï¼Œä»¥ä¾¿å®Œæˆåé¢çš„å®éªŒéªŒè¯ã€‚</p><p>å®¢æˆ·ç«¯ç¨‹åºä»æ ‡å‡†è¾“å…¥è¯»å…¥ï¼Œå°†è¯»å…¥çš„å­—ç¬¦ä¸²ä¼ è¾“ç»™æœåŠ¡å™¨ç«¯ï¼š</p><pre><code>//å®¢æˆ·ç«¯ç¨‹åº\nint main(int argc, char **argv) {\n    if (argc != 2) {\n        error(1, 0, &quot;usage: reliable_client01 &lt;IPaddress&gt;&quot;);\n    }\n\n    int socket_fd = tcp_client(argv[1], SERV_PORT);\n    char buf[128];\n    int len;\n    int rc;\n\n    while (fgets(buf, sizeof(buf), stdin) != NULL) {\n        len = strlen(buf);\n        rc = send(socket_fd, buf, len, 0);\n        if (rc &lt; 0)\n            error(1, errno, &quot;write failed&quot;);\n        rc = read(socket_fd, buf, sizeof(buf));\n        if (rc &lt; 0)\n            error(1, errno, &quot;read failed&quot;);\n        else if (rc == 0)\n            error(1, 0, &quot;peer connection closed\\n&quot;);\n        else\n            fputs(buf, stdout);\n    }\n    exit(0);\n}\n</code></pre><h3>readç›´æ¥æ„ŸçŸ¥FINåŒ…</h3><p>æˆ‘ä»¬ä¾æ¬¡å¯åŠ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºï¼Œåœ¨å®¢æˆ·ç«¯è¾“å…¥goodå­—ç¬¦ä¹‹åï¼Œè¿…é€Ÿç»“æŸæ‰æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œè¿™é‡Œéœ€è¦èµ¶åœ¨æœåŠ¡å™¨ç«¯ä»ç¡çœ ä¸­è‹é†’ä¹‹å‰æ€æ­»æœåŠ¡å™¨ç¨‹åºã€‚</p><p>å±å¹•ä¸Šæ‰“å°å‡ºï¼špeer connection closedã€‚å®¢æˆ·ç«¯ç¨‹åºæ­£å¸¸é€€å‡ºã€‚</p><pre><code>$./reliable_client01 127.0.0.1\n$ good\n$ peer connection closed\n</code></pre><p>è¿™è¯´æ˜å®¢æˆ·ç«¯ç¨‹åºé€šè¿‡readè°ƒç”¨ï¼Œæ„ŸçŸ¥åˆ°äº†æœåŠ¡ç«¯å‘é€çš„FINåŒ…ï¼Œäºæ˜¯æ­£å¸¸é€€å‡ºäº†å®¢æˆ·ç«¯ç¨‹åºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/ec/b0922e1b1824f1e4735f2788eb3527ec.png?wh=636*466\" alt=\"\"><br>\næ³¨æ„å¦‚æœæˆ‘ä»¬çš„é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œå¯¼è‡´æœåŠ¡å™¨ç«¯ä»ç¡çœ ä¸­è‹é†’ï¼Œå¹¶æˆåŠŸå°†æŠ¥æ–‡å‘é€å‡ºæ¥åï¼Œå®¢æˆ·ç«¯ä¼šæ­£å¸¸æ˜¾ç¤ºï¼Œæ­¤æ—¶æˆ‘ä»¬åœç•™ï¼Œç­‰å¾…æ ‡å‡†è¾“å…¥ã€‚å¦‚æœä¸ç»§ç»­é€šè¿‡readæˆ–writeæ“ä½œå¯¹å¥—æ¥å­—è¿›è¡Œè¯»å†™ï¼Œæ˜¯æ— æ³•æ„ŸçŸ¥æœåŠ¡å™¨ç«¯å·²ç»å…³é—­å¥—æ¥å­—è¿™ä¸ªäº‹å®çš„ã€‚</p><h3>é€šè¿‡writeäº§ç”ŸRSTï¼Œreadè°ƒç”¨æ„ŸçŸ¥RST</h3><p>è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬ä»ç„¶ä¾æ¬¡å¯åŠ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºï¼Œåœ¨å®¢æˆ·ç«¯è¾“å…¥badå­—ç¬¦ä¹‹åï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç›´åˆ°å®¢æˆ·ç«¯æ­£ç¡®æ˜¾ç¤ºäº†æœåŠ¡ç«¯çš„å›åº”â€œbadâ€å­—ç¬¦ä¹‹åï¼Œå†æ€æ­»æœåŠ¡å™¨ç¨‹åºã€‚å®¢æˆ·ç«¯å†æ¬¡è¾“å…¥bad2ï¼Œè¿™æ—¶å±å¹•ä¸Šæ‰“å°å‡ºâ€peer connection closedâ€œã€‚</p><p>è¿™æ˜¯è¿™ä¸ªæ¡ˆä¾‹çš„å±å¹•è¾“å‡ºå’Œæ—¶åºå›¾ã€‚</p><pre><code>$./reliable_client01 127.0.0.1\n$bad\n$bad\n$bad2\n$peer connection closed\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/a9/f2/a95d3b87a9a93421774d7aeade8efbf2.png?wh=1438*760\" alt=\"\"><br>\nåœ¨å¾ˆå¤šä¹¦ç±å’Œæ–‡ç« ä¸­ï¼Œå¯¹è¿™ä¸ªç¨‹åºçš„è§£è¯»æ˜¯ï¼Œæ”¶åˆ°FINåŒ…çš„å®¢æˆ·ç«¯ç»§ç»­åˆæ³•åœ°å‘æœåŠ¡å™¨ç«¯å‘é€æ•°æ®ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ— æ³•å®šä½è¯¥TCPè¿æ¥ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå‘é€äº†RSTä¿¡æ¯ï¼Œå½“ç¨‹åºè°ƒç”¨readæ“ä½œæ—¶ï¼Œå†…æ ¸ä¼šå°†RSTé”™è¯¯ä¿¡æ¯é€šçŸ¥ç»™åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„writeæ“ä½œé€ æˆå¼‚å¸¸ï¼Œå†é€šè¿‡readæ“ä½œæ¥æ„ŸçŸ¥å¼‚å¸¸çš„æ ·ä¾‹ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘åœ¨Linux 4.4å†…æ ¸ä¸Šå®éªŒè¿™ä¸ªç¨‹åºï¼Œå¤šæ¬¡çš„ç»“æœéƒ½æ˜¯ï¼Œå†…æ ¸æ­£å¸¸å°†EOFä¿¡æ¯é€šçŸ¥ç»™åº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯RSTé”™è¯¯ä¿¡æ¯ã€‚</p><p>æˆ‘åˆåœ¨Max OS 10.13.6ä¸Šå°è¯•è¿™ä¸ªç¨‹åºï¼Œreadæ“ä½œå¯ä»¥è¿”å›RSTå¼‚å¸¸ä¿¡æ¯ã€‚è¾“å‡ºå’Œæ—¶åºå›¾ä¹Ÿå·²ç»ç»™å‡ºã€‚</p><pre><code>$./reliable_client01 127.0.0.1\n$bad\n$bad\n$bad2\n$read failed: Connection reset by peer (54)\n</code></pre><h3>å‘ä¸€ä¸ªå·²å…³é—­è¿æ¥è¿ç»­å†™ï¼Œæœ€ç»ˆå¯¼è‡´SIGPIPE</h3><p>ä¸ºäº†æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘å¯¹æœåŠ¡å™¨ç«¯ç¨‹åºå’Œå®¢æˆ·ç«¯ç¨‹åºéƒ½åšäº†å¦‚ä¸‹ä¿®æ”¹ã€‚</p><pre><code>nt main(int argc, char **argv) {\n    int connfd;\n    char buf[1024];\n    int time = 0;\n\n    connfd = tcp_server(SERV_PORT);\n\n    while (1) {\n        int n = read(connfd, buf, 1024);\n        if (n &lt; 0) {\n            error(1, errno, &quot;error read&quot;);\n        } else if (n == 0) {\n            error(1, 0, &quot;client closed \\n&quot;);\n        }\n\n        time++;\n        fprintf(stdout, &quot;1K read for %d \\n&quot;, time);\n        usleep(1000);\n    }\n\n    exit(0);\n}\n</code></pre><p>æœåŠ¡å™¨ç«¯æ¯æ¬¡è¯»å–1Kæ•°æ®åä¼‘çœ 1ç§’ï¼Œä»¥æ¨¡æ‹Ÿå¤„ç†æ•°æ®çš„è¿‡ç¨‹ã€‚</p><p>å®¢æˆ·ç«¯ç¨‹åºåœ¨ç¬¬8è¡Œæ³¨å†Œäº†SIGPIPEçš„ä¿¡å·å¤„ç†ç¨‹åºï¼Œåœ¨ç¬¬14-22è¡Œå®¢æˆ·ç«¯ç¨‹åºä¸€ç›´å¾ªç¯å‘é€æ•°æ®æµã€‚</p><pre><code>int main(int argc, char **argv) {\n    if (argc != 2) {\n        error(1, 0, &quot;usage: reliable_client02 &lt;IPaddress&gt;&quot;);\n    }\n\n    int socket_fd = tcp_client(argv[1], SERV_PORT);\n\n    signal(SIGPIPE, SIG_IGN);\n\n    char *msg = &quot;network programming&quot;;\n    ssize_t n_written;\n\n    int count = 10000000;\n    while (count &gt; 0) {\n        n_written = send(socket_fd, msg, strlen(msg), 0);\n        fprintf(stdout, &quot;send into buffer %ld \\n&quot;, n_written);\n        if (n_written &lt;= 0) {\n            error(1, errno, &quot;send error&quot;);\n            return -1;\n        }\n        count--;\n    }\n    return 0;\n}\n</code></pre><p>å¦‚æœåœ¨æœåŠ¡ç«¯è¯»å–æ•°æ®å¹¶å¤„ç†è¿‡ç¨‹ä¸­ï¼Œçªç„¶æ€æ­»æœåŠ¡å™¨è¿›ç¨‹ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®¢<strong>æˆ·ç«¯å¾ˆå¿«ä¹Ÿä¼šé€€å‡º</strong>ï¼Œå¹¶åœ¨å±å¹•ä¸Šæ‰“å°å‡ºâ€œConnection reset by peerâ€çš„æç¤ºã€‚</p><pre><code>$./reliable_client02 127.0.0.1\n$send into buffer 5917291\n$send into buffer -1\n$send: Connection reset by peer\n</code></pre><p>è¿™æ˜¯å› ä¸ºæœåŠ¡ç«¯ç¨‹åºè¢«æ€æ­»ä¹‹åï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä¼šåšä¸€äº›æ¸…ç†çš„äº‹æƒ…ï¼Œä¸ºè¿™ä¸ªå¥—æ¥å­—å‘é€ä¸€ä¸ªFINåŒ…ï¼Œä½†æ˜¯ï¼Œå®¢æˆ·ç«¯åœ¨æ”¶åˆ°FINåŒ…ä¹‹åï¼Œæ²¡æœ‰readæ“ä½œï¼Œè¿˜æ˜¯ä¼šç»§ç»­å¾€è¿™ä¸ªå¥—æ¥å­—å†™å…¥æ•°æ®ã€‚è¿™æ˜¯å› ä¸ºæ ¹æ®TCPåè®®ï¼Œè¿æ¥æ˜¯åŒå‘çš„ï¼Œæ”¶åˆ°å¯¹æ–¹çš„FINåŒ…åªæ„å‘³ç€<strong>å¯¹æ–¹ä¸ä¼šå†å‘é€ä»»ä½•æ¶ˆæ¯</strong>ã€‚ åœ¨ä¸€ä¸ªåŒæ–¹æ­£å¸¸å…³é—­çš„æµç¨‹ä¸­ï¼Œæ”¶åˆ°FINåŒ…çš„ä¸€ç«¯å°†å‰©ä½™æ•°æ®å‘é€ç»™å¯¹é¢ï¼ˆé€šè¿‡ä¸€æ¬¡æˆ–å¤šæ¬¡writeï¼‰ï¼Œç„¶åå…³é—­å¥—æ¥å­—ã€‚</p><p>å½“æ•°æ®åˆ°è¾¾æœåŠ¡å™¨ç«¯æ—¶ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸å‘ç°è¿™æ˜¯ä¸€ä¸ªæŒ‡å‘å…³é—­çš„å¥—æ¥å­—ï¼Œä¼šå†æ¬¡å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªRSTåŒ…ï¼Œå¯¹äºå‘é€ç«¯è€Œè¨€å¦‚æœæ­¤æ—¶å†æ‰§è¡Œwriteæ“ä½œï¼Œç«‹å³ä¼šè¿”å›ä¸€ä¸ªRSTé”™è¯¯ä¿¡æ¯ã€‚</p><p>ä½ å¯ä»¥çœ‹åˆ°é’ˆå¯¹è¿™ä¸ªå…¨è¿‡ç¨‹çš„ä¸€å¼ æè¿°å›¾ï¼Œä½ å¯ä»¥å‚è€ƒè¿™å¼ å›¾å¥½å¥½ç†è§£ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/42/ebf533a453573b85ff03a46103fc5b42.png?wh=1436*528\" alt=\"\"><br>\nä»¥ä¸Šæ˜¯åœ¨Linux 4.4å†…æ ¸ä¸Šæµ‹è¯•çš„ç»“æœã€‚</p><p>åœ¨å¾ˆå¤šä¹¦ç±å’Œæ–‡ç« ä¸­ï¼Œå¯¹è¿™ä¸ªå®éªŒçš„æœŸæœ›ç»“æœä¸æ˜¯è¿™æ ·çš„ã€‚å¤§éƒ¨åˆ†çš„æ•™ç¨‹æ˜¯è¿™æ ·è¯´çš„ï¼šåœ¨ç¬¬äºŒæ¬¡writeæ“ä½œæ—¶ï¼Œç”±äºæœåŠ¡å™¨ç«¯æ— æ³•æŸ¥è¯¢åˆ°å¯¹åº”çš„TCPè¿æ¥ä¿¡æ¯ï¼Œäºæ˜¯å‘é€äº†ä¸€ä¸ªRSTåŒ…ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ç¬¬äºŒæ¬¡æ“ä½œæ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šæ”¶åˆ°ä¸€ä¸ªSIGPIPEä¿¡å·ã€‚å¦‚æœä¸æ•æ‰è¿™ä¸ªä¿¡å·ï¼Œåº”ç”¨ç¨‹åºä¼šåœ¨æ¯«æ— å¾å…†çš„æƒ…å†µä¸‹ç›´æ¥é€€å‡ºã€‚</p><p>æˆ‘åœ¨Max OS 10.13.6ä¸Šå°è¯•è¿™ä¸ªç¨‹åºï¼Œå¾—åˆ°çš„ç»“æœç¡®å®å¦‚æ­¤ã€‚ä½ å¯ä»¥çœ‹åˆ°å±å¹•æ˜¾ç¤ºå’Œæ—¶åºå›¾ã€‚</p><pre><code>#send into buffer 19 \n#send into buffer -1 \n#send error: Broken pipe (32)\n</code></pre><p>è¿™è¯´æ˜ï¼ŒLinux4.4çš„å®ç°å’Œç±»BSDçš„å®ç°å·²ç»éå¸¸ä¸ä¸€æ ·äº†ã€‚é™äºæ—¶é—´çš„å…³ç³»ï¼Œæˆ‘æ²¡æœ‰ä»”ç»†å¯¹æ¯”å…¶ä»–ç‰ˆæœ¬çš„Linuxï¼Œè¿˜ä¸æ¸…æ¥šæ˜¯æ–°çš„å†…æ ¸ç‰¹æ€§ï¼Œä½†æœ‰ä¸€ç‚¹æ˜¯å¯ä»¥è‚¯å®šçš„ï¼Œæˆ‘ä»¬éœ€è¦è®°å¾—ä¸ºSIGPIPEæ³¨å†Œå¤„ç†å‡½æ•°ï¼Œé€šè¿‡writeæ“ä½œæ„ŸçŸ¥RSTçš„é”™è¯¯ä¿¡æ¯ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨Linux 4.4å’ŒMac OSä¸Šéƒ½èƒ½æ­£å¸¸å¤„ç†å¼‚å¸¸ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬æ„è¯†åˆ°TCPå¹¶ä¸æ˜¯é‚£ä¹ˆâ€œå¯é â€çš„ã€‚æˆ‘æŠŠæ•…éšœåˆ†ä¸ºä¸¤å¤§ç±»ï¼Œä¸€ç±»æ˜¯å¯¹ç«¯æ— FINåŒ…ï¼Œéœ€è¦é€šè¿‡å·¡æ£€æˆ–è¶…æ—¶æ¥å‘ç°ï¼›å¦ä¸€ç±»æ˜¯å¯¹ç«¯æœ‰FINåŒ…å‘å‡ºï¼Œéœ€è¦é€šè¿‡å¢å¼ºreadæˆ–writeæ“ä½œçš„å¼‚å¸¸å¤„ç†ï¼Œå¸®åŠ©æˆ‘ä»¬å‘ç°æ­¤ç±»å¼‚å¸¸ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å’Œå¾€å¸¸ä¸€æ ·ï¼Œç»™å¤§å®¶å¸ƒç½®ä¸¤é“æ€è€ƒé¢˜ã€‚</p><p>ç¬¬ä¸€é“ï¼Œä½ ä¸å¦¨åœ¨ä½ çš„Linuxç³»ç»Ÿä¸­é‡æ–°æ¨¡æ‹Ÿä¸€ä¸‹ä»Šå¤©æ–‡ç« é‡Œçš„å®éªŒï¼Œçœ‹çœ‹è¿è¡Œç»“æœæ˜¯å¦å’Œæˆ‘çš„ä¸€æ ·ã€‚æ¬¢è¿ä½ æŠŠå†…æ ¸ç‰ˆæœ¬å’Œç»“æœè´´åœ¨è¯„è®ºé‡Œã€‚</p><p>ç¬¬äºŒé“é¢˜æ˜¯ï¼Œå¦‚æœæœåŠ¡å™¨ä¸»æœºæ­£å¸¸å…³é—­ï¼Œå·²è¿æ¥çš„ç¨‹åºä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ ä¸å¦¨æ€è€ƒä¸€ä¸‹è¿™ä¸¤é“é¢˜ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ¨¡æ‹Ÿç»“æœå’Œæ€è€ƒï¼Œæˆ‘ä¼šå’Œä½ ä¸€èµ·äº¤æµï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµä¸€ä¸‹ã€‚</p>","comments":[{"had_liked":false,"id":134974,"user_name":"å¼ ç«‹å","can_delete":false,"product_type":"c1","uid":1231713,"ip_address":"","ucode":"173B938DD9478A","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/61/b62d8a3b.jpg","comment_is_top":false,"comment_ctime":1568966112,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"100353213920","product_id":100032701,"comment_content":"è¿™ç¯‡æ–‡ç« æé†’æˆ‘ä»¬çš„æ˜¯ï¼Œä»ä»£ç çš„è§’åº¦å°†æ³¨æ„ä¸‰ç‚¹ï¼š<br>1ï¼Œç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œå¿½ç•¥ SIGPIPE<br>2ï¼Œread, write è¦åˆ¤æ–­è¿”å›å€¼ï¼Œæ ¹æ®è¿”å›å€¼çŸ¥é“socketæ–­å¼€äº†<br>3ï¼Œåº”ç”¨å±‚ä½¿ç”¨ å¿ƒè·³åŒ…ï¼Œå¿ƒè·³åŒ…è¾¾åˆ°è¶…æ—¶é˜€å€¼ï¼Œåˆ™è®¤å®šsocketæ–­å¼€äº†<br>","like_count":24},{"had_liked":false,"id":132084,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1568020617,"is_pvip":false,"replies":[{"id":"50780","content":"æ­£è§£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568189197,"ip_address":"","comment_id":132084,"utype":1}],"discussion_count":4,"race_medal":0,"score":"74582464649","product_id":100032701,"comment_content":"çœ‹åˆ°åé¢æˆ‘å¥½åƒç†è§£äº†æˆ‘ä¸Šé¢é‚£ä¸ªæé—®,å½“å´©æºƒé‡å¯è¿‡åæ˜¯é‡æ–°ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥,åˆ›å»ºæ–°çš„å¥—æ¥å­—,åªæ˜¯åœ¨ç½‘ç»œä¸Šä¼ è¾“çš„åŒ…,å› ä¸ºæ˜¯é€šè¿‡ipåœ°å€å’Œç«¯å£æ–¹å¼è¿›è¡Œçš„å¯»å€,æ‰€ä»¥æ–°è¿æ¥ä¸Šå»çš„å®¢æˆ·ç«¯ä¼šæ¥æ”¶åˆ°ä¹‹å‰è¿˜æ²¡æ¥æ”¶åˆ°çš„åŒ…,ç„¶åæ–°è¿æ¥çš„å®¢æˆ·ç«¯æ²¡æœ‰è¿™äº›åŒ…çš„tcpåˆ†ç»„ä¿¡æ¯æ‰€ä»¥å°±ä¼šç»™æœåŠ¡å™¨ç«¯(å¯¹ç«¯)å‘é€ä¸€ä¸ªRST","like_count":17,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466754,"discussion_content":"æ­£è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568189197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2109519,"avatar":"https://static001.geekbang.org/account/avatar/00/20/30/4f/8684040d.jpg","nickname":"Jason Â°","note":"","ucode":"77AE294DE60497","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376129,"discussion_content":"tcpæ˜¯é€šè¿‡ä¸¤ç«¯çš„ipå’Œç«¯å£æ¥åŒºåˆ†é“¾æ¥çš„ï¼Œå¦‚æœä¸¤è¾¹itå’Œç«¯å£ä¸€è‡´ï¼Œä¼šè®¤ä¸ºæ˜¯ä¸€æ¡é“¾æ¥ï¼Œè¿™æ—¶å€™æ”¶åˆ°rstä¸æ˜¯å› ä¸ºæ²¡æœ‰åˆ†ç»„ä¿¡æ¯ï¼Œè€Œæ˜¯å› ä¸ºæ•°æ®çš„åºåˆ—å·ä¸å¯¹","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1621988392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1688939,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAia6hRmnSZyuLtKvxxXvg9vgUfwSReCOaHKGLKuRcNX2BCNdmCFSlXyBZvpSXia5LXKjAZKeBXKuw/132","nickname":"Geek_guan","note":"","ucode":"592603EB5F042D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":220880,"discussion_content":"æ–°è¿æ¥çš„å®¢æˆ·ç«¯ä¸æ˜¯ä¼šé‡æ–°åˆ†é…ç«¯å£å—ï¼Ÿæ€ä¹ˆè¿˜èƒ½æ¥å—åˆ°ä¹‹å‰æ²¡æœ‰æ¥æ”¶åˆ°çš„åŒ…å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585927652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1307067,"avatar":"","nickname":"super-ck","note":"","ucode":"02F036E53E1130","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1688939,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAia6hRmnSZyuLtKvxxXvg9vgUfwSReCOaHKGLKuRcNX2BCNdmCFSlXyBZvpSXia5LXKjAZKeBXKuw/132","nickname":"Geek_guan","note":"","ucode":"592603EB5F042D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263165,"discussion_content":"é‡‡ç”¨éšæœºåˆ†é…è¿˜æ˜¯æœ‰å¯èƒ½åˆ†é…åˆ°åŒä¸€ä¸ª\nå¦‚æœæŒ‡å®šç«¯å£ï¼Œè‚¯å®šå°±æ˜¯åŒä¸€ä¸ªäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589181924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":220880,"ip_address":""},"score":263165,"extra":""}]}]},{"had_liked":false,"id":234683,"user_name":"melon","can_delete":false,"product_type":"c1","uid":1023773,"ip_address":"","ucode":"7A80C20EBCAAA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg","comment_is_top":false,"comment_ctime":1594773452,"is_pvip":false,"replies":[{"id":"86816","content":"æ‰€ä»¥éœ€è¦åœ¨å®¢æˆ·ç«¯ç¨‹åºé‡ŒåŠ sleepå°±å¯ä»¥äº†ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1594908072,"ip_address":"","comment_id":234683,"utype":1}],"discussion_count":3,"race_medal":0,"score":"44544446412","product_id":100032701,"comment_content":"æœ€åçš„ä¾‹å­æ²¡æœ‰è§¦å‘SIGPIPEï¼Œæ˜¯å› ä¸ºè€å¸ˆä¾‹å­è®¾è®¡çš„æœ‰ç‚¹å„¿ç‘•ç–µã€‚client åœ¨ä¸æ–­çš„å‘é€æ•°æ®ï¼Œserver åˆ™æ¯æ¬¡æ¥å—æ•°æ®ä¹‹åéƒ½ sleep ä¸€ä¼šï¼Œä¹Ÿå°±å¯¼è‡´æ¥æ”¶é€Ÿåº¦å°äºå‘é€é€Ÿåº¦ï¼Œè¿›è€Œå¯¼è‡´ server ç»ˆæ­¢çš„æ—¶å€™æ¥æ”¶ç¼“å†²åŒºè¿˜æœ‰æ•°æ®æ²¡æœ‰è¢«è¯»å–ï¼Œserver ç»ˆæ­¢è§¦å‘ close è°ƒç”¨ï¼Œclose è°ƒç”¨æ—¶å¦‚æœæ¥æ”¶ç¼“å†²åŒºæœ‰å°šæœªè¢«åº”ç”¨ç¨‹åºè¯»å–çš„æ•°æ®æ—¶ï¼Œä¸å‘ FIN åŒ…ï¼Œç›´æ¥å‘ RST åŒ…ã€‚client æ¯æ¬¡å‘é€æ•°æ®ä¹‹å sleep 2ç§’ï¼Œå†è¯•å°±ä¼šå‡ºSIGPIPE äº†ã€‚","like_count":10,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501466,"discussion_content":"æ‰€ä»¥éœ€è¦åœ¨å®¢æˆ·ç«¯ç¨‹åºé‡ŒåŠ sleepå°±å¯ä»¥äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594908072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023773,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg","nickname":"melon","note":"","ucode":"7A80C20EBCAAA4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291689,"discussion_content":"å¯¹çš„ï¼Œæœ¬è´¨å°±æ˜¯è®©æœåŠ¡å™¨ç«¯ç¨‹åºç»ˆæ­¢çš„æ—¶å€™ï¼Œå¥—æ¥å­—æ¥æ”¶ç¼“å†²åŒºçš„æ•°æ®éƒ½è¢«åº”ç”¨è¯»èµ°äº†ï¼Œè¿™æ ·åè®®æ ˆå°±ä¼šå‘å‡ºFINåŒ…äº†ï¼Œå¦åˆ™åè®®æ ˆå°±ç›´æ¥ç²—æš´çš„å‘RSTåŒ…äº†äº‹ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1594908927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2944638,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/ee/7e/519b6808.jpg","nickname":"å“¦","note":"","ucode":"8DC2C012FEFA68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1023773,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg","nickname":"melon","note":"","ucode":"7A80C20EBCAAA4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564229,"discussion_content":"æœåŠ¡ç«¯ç»ˆæ­¢æ—¶ç›´æ¥å‘é€RSTçš„è¯ï¼Œä¸ºä»€ä¹ˆå®¢æˆ·ç«¯çš„writeä¸ç›´æ¥å‡ºSIGPIPEå‘€ï¼Ÿè¿™ä¸ªæ—¶å€™ä¸æ˜¯åœ¨å¯¹å·²ç»æ¥æ”¶äº†RSTçš„socketåšwriteå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650195480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":291689,"ip_address":""},"score":564229,"extra":""}]}]},{"had_liked":false,"id":191753,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1584794589,"is_pvip":false,"replies":[{"id":"73532","content":"è¯´æ˜æ–°ç‰ˆçš„å†…æ ¸åœ¨è¿™äº›ç‰¹æ€§ä¸Šæœ‰æ‰€æ”¹è¿›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1584863295,"ip_address":"","comment_id":191753,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35944532957","product_id":100032701,"comment_content":"æˆ‘çš„ç”µè„‘ï¼Œç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œ<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒæœåŠ¡å™¨æ­£å¸¸å…³é—­ï¼Œå®¢æˆ·ç«¯åº”è¯¥æ˜¯å—åˆ°äº†finåŒ…ï¼Œreadè¿”å›eOF,wirteè¿”å›rst","like_count":8,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488248,"discussion_content":"è¯´æ˜æ–°ç‰ˆçš„å†…æ ¸åœ¨è¿™äº›ç‰¹æ€§ä¸Šæœ‰æ‰€æ”¹è¿›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584863295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134288,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4e/d0/d8a5f720.jpg","nickname":"Kenå¼ äº‘å¿ ","note":"","ucode":"D0BAC9FC17DE2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329845,"discussion_content":"å®¢æˆ·ç«¯åœ¨æ”¶åˆ°FINåŒ…å,writeä¼šæŠŠå‰©ä½™çš„åŒ…ç»§ç»­å‘å®Œ,å†å‘é€ACKåŒ…å’Œè‡ªå·±çš„FINåŒ…,æœ€ååœ¨æ”¶åˆ°è‡ªå·±FINåŒ…çš„ACKåŒ…åå…³é—­è¿æ¥","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606467406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169191,"user_name":"ç›˜å°¼è¥¿æ—","can_delete":false,"product_type":"c1","uid":1197347,"ip_address":"","ucode":"B59569FC25144F","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/23/28311447.jpg","comment_is_top":false,"comment_ctime":1578289433,"is_pvip":false,"replies":[{"id":"68081","content":"ä¸€ä¸ªæ˜¯TCP RSTçš„çŠ¶æ€å¼‚å¸¸ï¼Œä¸€ä¸ªæ˜¯SIGPIPE ä¿¡å·å°†è¿›ç¨‹è¿›è¡Œå›æ”¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1580631476,"ip_address":"","comment_id":169191,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18758158617","product_id":100032701,"comment_content":"æ²¡æœ‰ç†è§£ reset by peer å’Œ broken pipe çš„åŒºåˆ«ã€‚ã€‚","like_count":5,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480451,"discussion_content":"ä¸€ä¸ªæ˜¯TCP RSTçš„çŠ¶æ€å¼‚å¸¸ï¼Œä¸€ä¸ªæ˜¯SIGPIPE ä¿¡å·å°†è¿›ç¨‹è¿›è¡Œå›æ”¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580631476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139270,"user_name":"tim","can_delete":false,"product_type":"c1","uid":1065570,"ip_address":"","ucode":"50F90216B4640B","user_header":"https://static001.geekbang.org/account/avatar/00/10/42/62/536aef06.jpg","comment_is_top":false,"comment_ctime":1570598054,"is_pvip":false,"replies":[{"id":"54323","content":"è¿™é‡Œæ˜¯ä»åº”ç”¨å±‚æŠ¥æ–‡æ•°æ®è§’åº¦å‡ºå‘æ¥è¯´çš„ï¼Œå› ä¸ºæ•°æ®æ˜¯ä¸€ä¸ªæµï¼Œæ²¡æœ‰åŠæ³•åˆ¤æ–­æ•°æ®çš„å“ªäº›éƒ¨åˆ†æ²¡å¯¹ç«¯æ”¶åˆ°ã€‚<br><br>ä»TCPè§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯é€šè¿‡ACKæ¥æ„ŸçŸ¥TCPåŒ…çš„æ¥æ”¶æƒ…å†µçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570973415,"ip_address":"","comment_id":139270,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18750467238","product_id":100032701,"comment_content":"&gt;&gt;&quot;ä½†æ˜¯ï¼Œå‘é€ç«¯å¹¶æ— æ³•è·å–å¯¹åº”æ•°æ®æµçš„ ACK æƒ…å†µ&quot;<br>å¯¹ä¸Šé¢è¿™æ®µè¯ä¸ç†è§£ï¼ŒTCP çš„ ACKä¸æ˜¯å¸¦ç€åºå·çš„å—ï¼Ÿå‘é€ç«¯æ ¹æ®è¿™ä¸ªåºå·èƒ½è®¡ç®—å‡ºæ˜¯å“ªæ¬¡å‘é€çš„ACKã€‚<br>å“ªä½å¤§ç‰›èƒ½è§£é‡Šä¸€ä¸‹å—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469869,"discussion_content":"è¿™é‡Œæ˜¯ä»åº”ç”¨å±‚æŠ¥æ–‡æ•°æ®è§’åº¦å‡ºå‘æ¥è¯´çš„ï¼Œå› ä¸ºæ•°æ®æ˜¯ä¸€ä¸ªæµï¼Œæ²¡æœ‰åŠæ³•åˆ¤æ–­æ•°æ®çš„å“ªäº›éƒ¨åˆ†æ²¡å¯¹ç«¯æ”¶åˆ°ã€‚\n\nä»TCPè§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯é€šè¿‡ACKæ¥æ„ŸçŸ¥TCPåŒ…çš„æ¥æ”¶æƒ…å†µçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570973415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1170796,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dd/6c/abb7bfe3.jpg","nickname":"JAMES","note":"","ucode":"63015120144DDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":30960,"discussion_content":"åŒé—®","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570873336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1154146,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","nickname":"é…¸è‘¡è„","note":"","ucode":"9D059C4FB327C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":30271,"discussion_content":"åŒé—®ï¼Œè€å¸ˆèƒ½è§£ç­”ä¸‹å—ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570808847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1245504,"avatar":"https://static001.geekbang.org/account/avatar/00/13/01/40/a203a3b9.jpg","nickname":"çˆ±å­¦ä¹ ä¸å®³æ€•","note":"","ucode":"BE325C02E4C92F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297692,"discussion_content":"æˆ‘æƒ³è€å¸ˆçš„æ„æ€æ˜¯è¯´ï¼šå‘é€ç«¯ä¸æ¸…æ¥šæ¥æ”¶ç«¯çš„åº”ç”¨å±‚åˆ°åº•å®é™…å¤„ç†äº†æ•°æ®æ²¡æœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597025296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232361,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1053390,"ip_address":"","ucode":"ABB3F1A63E102A","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/ce/a8c8b5e8.jpg","comment_is_top":false,"comment_ctime":1593966046,"is_pvip":false,"replies":[{"id":"86787","content":"æ ¹æ®é”™è¯¯ç æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥é€€å‡ºå½“å‰ç¨‹åºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1594903857,"ip_address":"","comment_id":232361,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5888933342","product_id":100032701,"comment_content":"error(1, 0, &quot;usage: reliable_client01 &lt;IPaddress&gt;&quot;);è¿™ä¸ªerrorå‡½æ•°ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆä½œç”¨ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500611,"discussion_content":"æ ¹æ®é”™è¯¯ç æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥é€€å‡ºå½“å‰ç¨‹åºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594903857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140393,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1570927123,"is_pvip":false,"replies":[{"id":"54287","content":"åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œéƒ½æ˜¯é˜»å¡çš„ï¼Œåé¢ä¼šåˆ‡æˆéé˜»å¡çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570968250,"ip_address":"","comment_id":140393,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5865894419","product_id":100032701,"comment_content":"è€å¸ˆï¼Œä½ æ–‡ç« çš„æ¡ˆä¾‹é»˜è®¤fdéƒ½æ˜¯é˜»å¡çš„å§ï¼Œå¦‚æœæ˜¯éé˜»å¡çš„è¯ï¼Œè¿”å›çš„n &lt; 0 ä¸ä¸€å®šæ˜¯é”™è¯¯å•Š","like_count":2,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470370,"discussion_content":"åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œéƒ½æ˜¯é˜»å¡çš„ï¼Œåé¢ä¼šåˆ‡æˆéé˜»å¡çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570968250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1512599,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/88nXicqmkJWm3IXVfPfGQSk8SKIBVKjuC4qhzaCkf5Ud88uvKgS4Vf5AzCJ1uaFO0gpPnxdh4CowfhpxV1kSbXw/132","nickname":"lixin","note":"","ucode":"94D99DAFB6C929","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584745,"discussion_content":"è¶…å“¥ï¼Œå³åˆ»æ´»è·ƒä»»åŠ¡\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661074834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133523,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1568596997,"is_pvip":false,"replies":[{"id":"51614","content":"è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨selectã€pollç­‰äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼Œæ­£ç¡®çš„è§£æ³•æ˜¯ä¸€æ—¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œæ¯”å¦‚è¿™é‡Œreadè¯»åˆ°EOFï¼Œå°±åº”ç”¨ç›´æ¥å»å¤„ç†æ­¤ç±»äº‹ä»¶ï¼Œè€Œä¸æ˜¯é˜»å¡åœ¨è¿™é‡Œç­‰å¾…ç”¨æˆ·çš„è¾“å…¥ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œå¾ˆå¿«æˆ‘ä»¬å°±ä¼šè¯¦ç»†å­¦ä¹ è¿™éƒ¨åˆ†å†…å®¹äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568886088,"ip_address":"","comment_id":133523,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5863564293","product_id":100032701,"comment_content":"è€å¸ˆ æˆ‘æä¸€ä¸ªreadç›´æ¥æ„ŸçŸ¥FINåŒ…çš„ç–‘é—®å“ˆ:<br><br>æˆ‘åœç•™åœ¨ stdinè¿™é‡Œ ç­‰æˆ‘è¾“å…¥å®Œä¹‹åï¼Œå°±èƒ½è°ƒç”¨readæ„ŸçŸ¥åˆ°å¯¹ç«¯å·²ç»å…³é—­äº†å‘€ï¼Ÿ æ˜¯å› ä¸ºç­‰åˆ°stdinä¹‹åï¼Œå†æ„ŸçŸ¥æ˜¯ä¸æ˜¯å¤ªæ™šäº†å‘€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467412,"discussion_content":"è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨selectã€pollç­‰äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼Œæ­£ç¡®çš„è§£æ³•æ˜¯ä¸€æ—¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œæ¯”å¦‚è¿™é‡Œreadè¯»åˆ°EOFï¼Œå°±åº”ç”¨ç›´æ¥å»å¤„ç†æ­¤ç±»äº‹ä»¶ï¼Œè€Œä¸æ˜¯é˜»å¡åœ¨è¿™é‡Œç­‰å¾…ç”¨æˆ·çš„è¾“å…¥ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œå¾ˆå¿«æˆ‘ä»¬å°±ä¼šè¯¦ç»†å­¦ä¹ è¿™éƒ¨åˆ†å†…å®¹äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568886088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132677,"user_name":"å¾å‡¯","can_delete":false,"product_type":"c1","uid":1244991,"ip_address":"","ucode":"12F82BA3649CD5","user_header":"https://static001.geekbang.org/account/avatar/00/12/ff/3f/bbb8a88c.jpg","comment_is_top":false,"comment_ctime":1568190602,"is_pvip":false,"replies":[{"id":"51754","content":"æˆ‘çŒœæƒ³æ˜¯ä¼šç›´æ¥å…³é—­çš„ï¼Œæ²¡æœ‰å¯¹ACKçš„ACKåŒ…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568960537,"ip_address":"","comment_id":132677,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5863157898","product_id":100032701,"comment_content":"ç¬¬äºŒé¢˜  å®¢æˆ·ç«¯--------æœåŠ¡å™¨<br><br>1.Â  å®¢æˆ·ç«¯å‘é€FINåŒ…ï¼Œå¤„äºå‘é€ç¼“å†²åŒºçš„æ•°æ®ä¼šé€ä¸€å‘é€ï¼ˆå¯èƒ½é€šè¿‡ä¸€æ¬¡æˆ–å¤šæ¬¡writeæ“ä½œå‘é€ï¼‰ï¼ŒFINåŒ…å¤„äºè¿™æ®µæ•°æ®çš„æœ«å°¾ï¼Œå½“æ•°æ®åˆ°è¾¾æ¥æ”¶ç«¯çš„æ¥æ”¶ç¼“å†²åŒºæ—¶ï¼ŒFINèµ·åˆ°äº†ä¸€ä¸ªç»“æŸç¬¦çš„ä½œç”¨ï¼Œå½“æ¥æ”¶ç«¯æ¥æ”¶æ•°æ®æ—¶é‡åˆ°FINåŒ…ï¼Œreadæ“ä½œè¿”å›EOFé€šçŸ¥åº”ç”¨å±‚ã€‚ç„¶åæ¥æ”¶ç«¯è¿”å›ä¸€ä¸ªACKè¡¨ç¤ºå¯¹è¿™æ¬¡å‘é€çš„ç¡®è®¤ã€‚ï¼ˆæ­¤æ—¶å®¢æˆ·ç«¯è¿›å…¥FIN_WAIT1ï¼ŒæœåŠ¡ç«¯è¿›å…¥CLOSE_WAITçŠ¶æ€ï¼‰<br><br>2.Â  å®¢æˆ·ç«¯æ¥æ”¶åˆ°ACKä¹‹åï¼Œå…³é—­è‡ªå·±çš„å‘é€é€šé“ï¼Œå®¢æˆ·ç«¯æ­¤æ—¶å¤„äºåŠå…³é—­çŠ¶æ€ã€‚ç­‰å¾…æœåŠ¡å™¨å‘é€FINåŒ…ã€‚<br><br>Â  (å®¢æˆ·ç«¯è¿›å…¥FIN_WAIT2çŠ¶æ€)<br><br>3.Â  æœåŠ¡ç«¯å‘é€FINåŒ…ï¼ŒåŒä¸Šç±»ä¼¼å¤„äºå‘é€ç¼“å†²åŒºçš„å†…å®¹ä¼šè¿åŒFINåŒ…ä¸€èµ·å‘è¿‡å»ï¼Œå½“å®¢æˆ·ç«¯æ¥æ”¶æˆåŠŸååŒæ—¶å°†FINè§£æä¸ºEOFä¿¡å·ä½¿å¾—ä¸Šå±‚è°ƒç”¨è¿”å›ã€‚ï¼ˆå®¢æˆ·ç«¯è¿›å…¥TIME_WAITçŠ¶æ€ æœåŠ¡ç«¯è¿›å…¥LAST_ACKçŠ¶æ€ï¼‰<br><br>4. å®¢æˆ·ç«¯ç­‰å¾…2MSLçš„æ—¶é—´ï¼Œåœ¨æ­¤æœŸé—´å‘æœåŠ¡å™¨å‘é€ACKã€‚å¦‚æœä¸¢åŒ…è¿›è¡Œé‡ä¼ ã€‚å¦‚æœæœåŠ¡å™¨æ”¶åˆ°ACKå æœåŠ¡å™¨è¿›å…¥CLOSEDçŠ¶æ€ å®¢æˆ·ç«¯ä¹Ÿè¿›å…¥CLOSEDçŠ¶æ€ã€‚<br><br>5. è¿æ¥å…³é—­<br>æˆ‘æƒ³é—®ä¸€ä¸‹  å¦‚æœæœ€åä¸€æ¬¡æŒ¥æ‰‹ä¸€ç›´ä¸¢åŒ…  åœ¨2MSLçš„æ—¶é—´å†…éƒ½æ²¡åˆ°  TCPä¼šå’‹åŠ  ä¼šé‡ç½®è®¡æ—¶å™¨ä¹ˆ è¿˜æ˜¯å°±ä¸ç®¡äº†ç›´æ¥å…³é—­å‘¢","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467063,"discussion_content":"æˆ‘çŒœæƒ³æ˜¯ä¼šç›´æ¥å…³é—­çš„ï¼Œæ²¡æœ‰å¯¹ACKçš„ACKåŒ…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568960537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452675,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJhbjhkN9mVxxA3wfMCmZ5BmoFVHXyaOkqDH5uRXGQNFngDdJDYqkf82ictdicZ9WibLjoiapcom4XbGw/132","nickname":"æœ¨æ˜“","note":"","ucode":"7CCA6255570E6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296956,"discussion_content":"FINä¹Ÿä¼šé‡ä¼ å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596714135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131977,"user_name":"yusuf","can_delete":false,"product_type":"c1","uid":1170784,"ip_address":"","ucode":"9F32149B2ADDA0","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/60/eae432c6.jpg","comment_is_top":false,"comment_ctime":1567997910,"is_pvip":false,"replies":[{"id":"50779","content":"åŸºæœ¬å’Œæˆ‘çš„Linuxä¸‹ç»“æœä¸€è‡´ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568189103,"ip_address":"","comment_id":131977,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862965206","product_id":100032701,"comment_content":"# uname -a<br>Linux tst 3.10.0-957.21.3.el7.x86_64 #1 SMP Tue Jun 18 16:35:19 UTC 2019 x86_64 x86_64 x86_64 GNU&#47;Linux<br># <br># .&#47;reliable_client01 127.0.0.1<br>good<br>peer connection closed<br># <br># .&#47;reliable_client01 127.0.0.1<br>bad<br>bad<br>bad2<br>peer connection closed<br># <br># .&#47;reliable_client02 127.0.0.1<br>send into buffer 19 <br>send into buffer -1 <br>send error: Connection reset by peer (104)<br>","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466707,"discussion_content":"åŸºæœ¬å’Œæˆ‘çš„Linuxä¸‹ç»“æœä¸€è‡´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568189103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350133,"user_name":"Geek_573990","can_delete":false,"product_type":"c1","uid":3035685,"ip_address":"","ucode":"D004FB1694442A","user_header":"","comment_is_top":false,"comment_ctime":1656587634,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656587634","product_id":100032701,"comment_content":"åšå®éªŒæ—¶æƒ³æŠ“åŒ…ï¼Œè¾“å…¥<br>#sudo tcpdump host 127.0.0.1<br>ç„¶ååˆ†åˆ«å¼€å¯serverå’Œclientåšå®éªŒï¼Œå®Œæˆåå¾—åˆ°ç»“æœ<br>0 packet captured<br>è¯·é—®è€å¸ˆè¿™ä¸ªæŠ“åŒ…å‘½ä»¤åº”è¯¥æ€ä¹ˆå†™","like_count":0},{"had_liked":false,"id":329823,"user_name":"Bin Watson","can_delete":false,"product_type":"c1","uid":2622364,"ip_address":"","ucode":"33E3487896E859","user_header":"https://static001.geekbang.org/account/avatar/00/28/03/9c/5a0b8825.jpg","comment_is_top":false,"comment_ctime":1641552630,"is_pvip":false,"replies":[{"id":"120798","content":"å†…æ ¸çš„ç‰ˆæœ¬ï¼Œç¡®å®æ˜¯ä¼šå½±å“æŸäº›ç»†å¾®çš„è¡Œä¸ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1642310186,"ip_address":"","comment_id":329823,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641552630","product_id":100032701,"comment_content":"åœ¨å†…æ ¸4.15.0-158-genericç‰ˆæœ¬ä¸­ï¼Œåœ¨æœåŠ¡å™¨å…³é—­åï¼Œå®¢æˆ·ç«¯æ˜¯è¿”SIGPIPEé”™è¯¯ã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546438,"discussion_content":"å†…æ ¸çš„ç‰ˆæœ¬ï¼Œç¡®å®æ˜¯ä¼šå½±å“æŸäº›ç»†å¾®çš„è¡Œä¸ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642310186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307757,"user_name":"ä¹”çº³æ£®","can_delete":false,"product_type":"c1","uid":1045107,"ip_address":"","ucode":"51EC9FAE071388","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/73/1c7bceae.jpg","comment_is_top":false,"comment_ctime":1629248351,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1629248351","product_id":100032701,"comment_content":"å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯keep-alive çš„timeout æ—¶é—´ä¸åŒçš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½å‡ºç°è€å¸ˆè¯´çš„åœºæ™¯ï¼ŒæœåŠ¡ç«¯keep-alive è¶…æ—¶æ—¶é—´å°äºå®¢æˆ·ç«¯ï¼Œå…ˆå‘FIN æŠ¥æ–‡ï¼Œåœ¨æœåŠ¡ç«¯å‘FIN æŠ¥æ–‡çš„åŒæ—¶ï¼Œå®¢æˆ·ç«¯ä¹Ÿæƒ³æœåŠ¡ç«¯å‘é€P æ•°æ®åŒ…ï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±ä¼šæ”¶åˆ°Pæ•°æ®æŠ¥åï¼Œå°±ä¼šå‘å®¢æˆ·ç«¯å›å¤ä¸€ä¸ªRåŒ…ï¼›","like_count":0},{"had_liked":false,"id":303771,"user_name":"æ—æ—","can_delete":false,"product_type":"c1","uid":1613227,"ip_address":"","ucode":"7B6318B971E430","user_header":"https://static001.geekbang.org/account/avatar/00/18/9d/ab/6589d91a.jpg","comment_is_top":false,"comment_ctime":1626973162,"is_pvip":false,"replies":[{"id":"111682","content":"è¿™é‡Œæƒ³è¦è¡¨è¾¾çš„æ˜¯ï¼Œä»åº”ç”¨å±‚åè®®å‡ºå‘ï¼Œæ²¡æœ‰åŠæ³•ä¿è¯åº”ç”¨å±‚æ•°æ®æµï¼Œè¢«å®Œç¾çš„å¤„ç†è¿‡å’Œåº”ç­”è¿‡ï¼Œå¦‚æœè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯éœ€è¦åº”ç”¨å±‚åŠ ä»¥å¤„ç†é€»è¾‘çš„ã€‚è€ŒTCPè¿™ä¸€å±‚ï¼Œåªèƒ½åšåˆ°æŠ¥æ–‡çº§åˆ«çš„æ¥æ”¶å’Œå‘é€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„ç¨‹åºå¤„ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1629637244,"ip_address":"","comment_id":303771,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626973162","product_id":100032701,"comment_content":"å½“å¯¹åº”çš„æ•°æ®å‘é€ç»™æ¥æ”¶ç«¯ï¼Œæ¥æ”¶ç«¯å›åº” ACKï¼Œå­˜å‚¨åœ¨å‘é€ç¼“å†²åŒºçš„è¿™éƒ¨åˆ†æ•°æ®å°±å¯ä»¥åˆ é™¤äº†ï¼Œä½†æ˜¯ï¼Œå‘é€ç«¯å¹¶æ— æ³•è·å–å¯¹åº”æ•°æ®æµçš„ ACK æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€ç«¯æ²¡æœ‰åŠæ³•åˆ¤æ–­å¯¹ç«¯çš„æ¥æ”¶æ–¹æ˜¯å¦å·²ç»æ¥æ”¶å‘é€çš„æ•°æ®æµï¼Œå¦‚æœéœ€è¦çŸ¥é“è¿™éƒ¨åˆ†ä¿¡æ¯ï¼Œå°±å¿…é¡»åœ¨åº”ç”¨å±‚è‡ªå·±æ·»åŠ å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚æ˜¾å¼çš„æŠ¥æ–‡ç¡®è®¤æœºåˆ¶<br><br><br>ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œä¸ºä»€ä¹ˆå‘é€ç«¯æ— æ³•è·å–å¯¹åº”æ•°æ®æµçš„ACKæƒ…å†µï¼Ÿ  ä¸æ˜¯æ”¶åˆ°å¯¹æ–¹å›çš„ACKåŒ…äº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523816,"discussion_content":"è¿™é‡Œæƒ³è¦è¡¨è¾¾çš„æ˜¯ï¼Œä»åº”ç”¨å±‚åè®®å‡ºå‘ï¼Œæ²¡æœ‰åŠæ³•ä¿è¯åº”ç”¨å±‚æ•°æ®æµï¼Œè¢«å®Œç¾çš„å¤„ç†è¿‡å’Œåº”ç­”è¿‡ï¼Œå¦‚æœè¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯éœ€è¦åº”ç”¨å±‚åŠ ä»¥å¤„ç†é€»è¾‘çš„ã€‚è€ŒTCPè¿™ä¸€å±‚ï¼Œåªèƒ½åšåˆ°æŠ¥æ–‡çº§åˆ«çš„æ¥æ”¶å’Œå‘é€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„ç¨‹åºå¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629637244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296938,"user_name":"highfly029","can_delete":false,"product_type":"c1","uid":2038039,"ip_address":"","ucode":"F1B0BE5097B61A","user_header":"","comment_is_top":false,"comment_ctime":1623230903,"is_pvip":false,"replies":[{"id":"108673","content":"ä½ éƒ½å·²ç»ç½‘ç»œä¸­æ–­äº†ï¼Œåªèƒ½æ˜¯é€šè¿‡å®¢æˆ·ç«¯çš„responseæ¥ç¡®å®šæœåŠ¡ç«¯æ¶ˆæ¯æ˜¯ä¸æ˜¯å‘é€å‡ºå»äº†ï¼Œè‚¯å®šæ²¡åŠæ³•ä¿è¯æ¶ˆæ¯ä¸ä¸¢äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1624805150,"ip_address":"","comment_id":296938,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623230903","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œå¯¹äºç½‘ç»œä¸­æ–­å¯¼è‡´çš„æ•…éšœï¼Œæˆ‘ä»¬çš„å¤„ç†æ˜¯æœåŠ¡ç«¯å› ä¸ºtimeoutè€Œä¸»åŠ¨closeè¿æ¥ï¼Œåœ¨timeoutä¹‹å‰çš„è¿™æ®µæ—¶é—´å†…ï¼ŒæœåŠ¡ç«¯ä¼šä¸æ–­çš„å‘é€æ¶ˆæ¯ï¼Œå¦‚æœä¿è¯è¿™æ®µæ—¶é—´çš„æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521657,"discussion_content":"ä½ éƒ½å·²ç»ç½‘ç»œä¸­æ–­äº†ï¼Œåªèƒ½æ˜¯é€šè¿‡å®¢æˆ·ç«¯çš„responseæ¥ç¡®å®šæœåŠ¡ç«¯æ¶ˆæ¯æ˜¯ä¸æ˜¯å‘é€å‡ºå»äº†ï¼Œè‚¯å®šæ²¡åŠæ³•ä¿è¯æ¶ˆæ¯ä¸ä¸¢äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624805150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283637,"user_name":"James","can_delete":false,"product_type":"c1","uid":1036309,"ip_address":"","ucode":"7A0DC75746CB3A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d0/15/c5dc2b0d.jpg","comment_is_top":false,"comment_ctime":1615862120,"is_pvip":false,"replies":[{"id":"103188","content":"å¯¹äºå¾ˆå¤šé«˜å¯é æ€§çš„åœºæ™¯ï¼Œè€ƒè™‘åˆ°å„ç§å¤æ‚çš„æ¡ä»¶ï¼Œåº”ç”¨å±‚æ˜¯éœ€è¦ä¿è¯çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1616314066,"ip_address":"","comment_id":283637,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615862120","product_id":100032701,"comment_content":"æƒ³é—®ä¸‹æ¥æ”¶ç«¯ä¸ºä»€ä¹ˆæ¥å—ä¸åˆ°ACK,ä½ è¯´ä»åº”ç”¨å±‚çš„è§’åº¦çœ‹ï¼Œç½‘ç»œå±‚ä¿è¯å¯é æ€§å°±å¯ä»¥äº†ï¼Œåº”ç”¨å±‚è¿˜éœ€è¦å†æ¬¡ä¿è¯å—","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517101,"discussion_content":"å¯¹äºå¾ˆå¤šé«˜å¯é æ€§çš„åœºæ™¯ï¼Œè€ƒè™‘åˆ°å„ç§å¤æ‚çš„æ¡ä»¶ï¼Œåº”ç”¨å±‚æ˜¯éœ€è¦ä¿è¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616314066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276453,"user_name":"Steiner","can_delete":false,"product_type":"c1","uid":1622329,"ip_address":"","ucode":"232C1C75207A1E","user_header":"https://static001.geekbang.org/account/avatar/00/18/c1/39/11904266.jpg","comment_is_top":false,"comment_ctime":1611931970,"is_pvip":false,"replies":[{"id":"100428","content":"å¦‚æœæ²¡æœ‰æ•æ‰åˆ°è¿™ä¸ªä¿¡å·ï¼Œå°±ä¼šè‡ªåŠ¨é€€å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1612101829,"ip_address":"","comment_id":276453,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611931970","product_id":100032701,"comment_content":"writeè§¦å‘SIGPIPEåï¼Œç¨‹åºä¼šè‡ªåŠ¨é€€å‡ºï¼Œè¿˜æ˜¯ç»§ç»­æ‰§è¡Œï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514707,"discussion_content":"å¦‚æœæ²¡æœ‰æ•æ‰åˆ°è¿™ä¸ªä¿¡å·ï¼Œå°±ä¼šè‡ªåŠ¨é€€å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612101829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266947,"user_name":"duckman","can_delete":false,"product_type":"c1","uid":2184325,"ip_address":"","ucode":"0184C26C4B6C1B","user_header":"https://static001.geekbang.org/account/avatar/00/21/54/85/ab5148ce.jpg","comment_is_top":false,"comment_ctime":1607532042,"is_pvip":false,"replies":[{"id":"98877","content":"åŸºæœ¬æ˜¯ç­‰ä»·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1610286104,"ip_address":"","comment_id":266947,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1607532042","product_id":100032701,"comment_content":"æœ¬ç³»åˆ—çš„ä»£ç ä¸­send å’Œ write éƒ½æœ‰ç”¨ï¼Œæœäº†ä¸€ä¸‹, ç¡®å®å¯ä»¥æ›¿æ¢<br><br>There should be no difference. Quoting from man 2 send:<br><br>The only difference between send() and write() is the presence of flags. With zero flags parameter, send() is equivalent to write().<br><br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;1100432&#47;performance-impact-of-using-write-instead-of-send-when-writing-to-a-socket","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511457,"discussion_content":"åŸºæœ¬æ˜¯ç­‰ä»·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610286104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":241014,"user_name":"Passion","can_delete":false,"product_type":"c1","uid":1365412,"ip_address":"","ucode":"71EC499C1315CF","user_header":"https://static001.geekbang.org/account/avatar/00/14/d5/a4/5dd93357.jpg","comment_is_top":false,"comment_ctime":1597151060,"is_pvip":false,"replies":[{"id":"89398","content":"å¯ä»¥é€šè¿‡æŠ“åŒ…æ¥çœ‹","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1597640869,"ip_address":"","comment_id":241014,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1597151060","product_id":100032701,"comment_content":"è€å¸ˆ æˆ‘çš„æ•°æ®é€šè¿‡sendå‡½æ•°å†™å…¥å†…æ ¸å‘é€ç¼“å†²åŒºæ²¡é—®é¢˜ï¼Œ æˆ‘æŠ“å–å‘é€çš„ç«¯å£ å‘ç°ä¸æˆ‘å†™å…¥çš„æ•°æ®å¯¹ä¸ä¸Š æ€ä¹ˆå®šä½  æ¯”å¦‚æˆ‘å†™å…¥ç¼“å†²åŒº100sql  å‘å‡ºå»çš„åªæ‰¾åˆ°80ä¸ªsql","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503620,"discussion_content":"å¯ä»¥é€šè¿‡æŠ“åŒ…æ¥çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597640869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238426,"user_name":"Simple life","can_delete":false,"product_type":"c1","uid":1571460,"ip_address":"","ucode":"1902D7F72FB43F","user_header":"https://static001.geekbang.org/account/avatar/00/17/fa/84/f01d203a.jpg","comment_is_top":false,"comment_ctime":1596164822,"is_pvip":false,"replies":[{"id":"89340","content":"readã€writeæ“ä½œå¯èƒ½è¿”å›çš„é”™è¯¯å’Œå¼‚å¸¸åŒ…å«äº†FINã€RSTç­‰è¿™äº›æ“ä½œå¾—åˆ°çš„ç»“æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1597585298,"ip_address":"","comment_id":238426,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1596164822","product_id":100032701,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼ŒFINåŒ…è¿™äº›åº•å±‚æ“ä½œï¼Œæ€ä¹ˆä¸READ,WRITEæœ‰å…³ï¼Œä¸æ˜¯TCPåº•å±‚ç›´æ¥å¤„ç†å¥½äº†å—ï¼Ÿread,writeä¸æ˜¯æ“ä½œç”¨æˆ·åº”ç”¨å±‚çš„æ•°æ®å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502746,"discussion_content":"readã€writeæ“ä½œå¯èƒ½è¿”å›çš„é”™è¯¯å’Œå¼‚å¸¸åŒ…å«äº†FINã€RSTç­‰è¿™äº›æ“ä½œå¾—åˆ°çš„ç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597585298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231348,"user_name":"éƒ‘ç¥–ç…Œ","can_delete":false,"product_type":"c1","uid":1469608,"ip_address":"","ucode":"49A0D2E3279826","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/a8/1922a0f5.jpg","comment_is_top":false,"comment_ctime":1593656012,"is_pvip":false,"replies":[{"id":"85728","content":"ç¡®å®æœ‰å¯èƒ½ï¼Œæˆ‘å†MAC OS 10.13.6å’ŒLinux 4.4ä¸Šçš„ç»“æœå°±ä¸ä¸€æ ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1593954390,"ip_address":"","comment_id":231348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593656012","product_id":100032701,"comment_content":"ç¬¬ä¸€é¢˜æˆ‘çš„æœåŠ¡å™¨å…³é—­ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å¹¶æ²¡æœ‰æ‰“å°Connection reset by peerï¼Œè€Œæ˜¯æ‰“å°send into buffer 4294967295,åŒæ—¶æ‰“å°send errorã€‚æ˜¯ä¸æ˜¯ç‰ˆæœ¬çš„åŸå› ã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500269,"discussion_content":"ç¡®å®æœ‰å¯èƒ½ï¼Œæˆ‘å†MAC OS 10.13.6å’ŒLinux 4.4ä¸Šçš„ç»“æœå°±ä¸ä¸€æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593954390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222634,"user_name":"Geek_76f04f","can_delete":false,"product_type":"c1","uid":2020720,"ip_address":"","ucode":"2A3D34C303E19A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/d5/70/93a34aa5.jpg","comment_is_top":false,"comment_ctime":1590853358,"is_pvip":false,"replies":[{"id":"82177","content":"ä½ å†…æ ¸çš„ç‰ˆæœ¬ï¼Ÿç¯å¢ƒï¼Ÿ<br><br>è€Œä¸”æ€æ­»æœåŠ¡ç«¯çš„æ—¶é—´ä¹Ÿå¾ˆå…³é”®ï¼Œåœ¨å®¢æˆ·ç«¯è¾“å…¥ bad å­—ç¬¦ä¹‹åï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç›´åˆ°å®¢æˆ·ç«¯æ­£ç¡®æ˜¾ç¤ºäº†æœåŠ¡ç«¯çš„å›åº”â€œbadâ€å­—ç¬¦ä¹‹åï¼Œå†æ€æ­»æœåŠ¡å™¨ç¨‹åºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1590931284,"ip_address":"","comment_id":222634,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590853358","product_id":100032701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘åœ¨è¿è¡Œç¬¬äºŒä¸ªç¨‹åºçš„æ—¶å€™ï¼Œå½“å…³é—­æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯å¾ˆå¤§çš„æ¦‚ç‡ä¸ä¼šæ”¶åˆ°RSTï¼Œç›¸åä¼šæŒç»­çš„writeï¼Œç›´åˆ°wiresharkæŠ“åŒ…æ˜¾ç¤ºçª—å£ä¸º0 ã€‚ è¯·æ•™è€å¸ˆä¸ºä»€ä¹ˆå®¢æˆ·ç«¯æ”¶ä¸åˆ°RSTï¼Œçª—å£ä¸º0æ˜¯ä¸æ˜¯å› ä¸ºå†…æ ¸ç¼“å†²åŒºæ»¡äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496870,"discussion_content":"ä½ å†…æ ¸çš„ç‰ˆæœ¬ï¼Ÿç¯å¢ƒï¼Ÿ\n\nè€Œä¸”æ€æ­»æœåŠ¡ç«¯çš„æ—¶é—´ä¹Ÿå¾ˆå…³é”®ï¼Œåœ¨å®¢æˆ·ç«¯è¾“å…¥ bad å­—ç¬¦ä¹‹åï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç›´åˆ°å®¢æˆ·ç«¯æ­£ç¡®æ˜¾ç¤ºäº†æœåŠ¡ç«¯çš„å›åº”â€œbadâ€å­—ç¬¦ä¹‹åï¼Œå†æ€æ­»æœåŠ¡å™¨ç¨‹åºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590931284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210650,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1134539,"ip_address":"","ucode":"11C598D0723D08","user_header":"https://static001.geekbang.org/account/avatar/00/11/4f/cb/ede92cd5.jpg","comment_is_top":false,"comment_ctime":1587802718,"is_pvip":false,"replies":[{"id":"79183","content":"æ˜¯çš„ï¼ŒçœŸæ­£é²æ£’çš„ç¨‹åºæ˜¯éœ€è¦å„ç§å¼‚å¸¸å’Œæç«¯æƒ…å†µçš„è€ƒéªŒçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1588497918,"ip_address":"","comment_id":210650,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587802718","product_id":100032701,"comment_content":"SIGPIPEçš„å¤„ç†å¯¹å‡ºé”™å¤„ç†å¾ˆé‡è¦ï¼Œæ·±æœ‰ä½“ä¼š","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493075,"discussion_content":"æ˜¯çš„ï¼ŒçœŸæ­£é²æ£’çš„ç¨‹åºæ˜¯éœ€è¦å„ç§å¼‚å¸¸å’Œæç«¯æƒ…å†µçš„è€ƒéªŒçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588497918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185847,"user_name":"å´å‘å…µ","can_delete":false,"product_type":"c1","uid":1350398,"ip_address":"","ucode":"918DFE98556A05","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/fe/c451a509.jpg","comment_is_top":false,"comment_ctime":1583711777,"is_pvip":false,"replies":[{"id":"72376","content":"æˆ‘è®¤ä¸ºepollä¸éœ€è¦æ„ŸçŸ¥tcpè¿æ¥çš„å¼‚å¸¸ï¼Œtcpè¿æ¥å¼‚å¸¸åº”è¯¥æ˜¯åº”ç”¨ç¨‹åºåˆ©ç”¨è½®è¯¢æˆ–è€…tcpè‡ªèº«çš„æœºåˆ¶æ¥å‘ç°ï¼Œè½¬è€Œè°ƒç”¨epollçš„æ¥å£è¿›è¡Œè¿æ¥å¥—æ¥å­—çš„æ¸…ç†å·¥ä½œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1584174071,"ip_address":"","comment_id":185847,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583711777","product_id":100032701,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œepollèƒ½æ„ŸçŸ¥åˆ°tcpè¿æ¥çš„å¼‚å¸¸å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486524,"discussion_content":"æˆ‘è®¤ä¸ºepollä¸éœ€è¦æ„ŸçŸ¥tcpè¿æ¥çš„å¼‚å¸¸ï¼Œtcpè¿æ¥å¼‚å¸¸åº”è¯¥æ˜¯åº”ç”¨ç¨‹åºåˆ©ç”¨è½®è¯¢æˆ–è€…tcpè‡ªèº«çš„æœºåˆ¶æ¥å‘ç°ï¼Œè½¬è€Œè°ƒç”¨epollçš„æ¥å£è¿›è¡Œè¿æ¥å¥—æ¥å­—çš„æ¸…ç†å·¥ä½œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584174071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170174,"user_name":"HerofH","can_delete":false,"product_type":"c1","uid":1480252,"ip_address":"","ucode":"84EB3243FAB432","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/86QEF74Mhc6ECbBBMr62hVz0ezOicI2Kbv8QBA7qR7KepeoDib9W6KLxxMPuQ24JGusvjC03NNr8uj8GyK0DxKiaw/132","comment_is_top":false,"comment_ctime":1578543048,"is_pvip":false,"replies":[{"id":"68063","content":"ä¸ºå•¥è¦åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µå‘¢ï¼Ÿç¨‹åºè¿™ç«¯éƒ½æ˜¯è¿æ¥æ— æ•ˆï¼Œæ— æ³•è¿›è¡Œæ•°æ®çš„æœ‰æ•ˆä¼ è¾“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1580630463,"ip_address":"","comment_id":170174,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578543048","product_id":100032701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³è¯·é—®ä¸€ä¸ªå…³äºæ„ŸçŸ¥åˆ°RSTåçš„ä¸€ä¸ªå¤„ç†é—®é¢˜ã€‚<br>å¦‚å‰æ‰€è¿°ï¼Œå¦‚æœå¯¹ç«¯è°ƒç”¨shutdown(SD_RD)å…³é—­è¯»ç«¯ï¼Œé‚£ä¹ˆæ­¤æ—¶æœ¬ç«¯å‘å¯¹ç«¯è¿›è¡Œå†™æ“ä½œåæ”¶åˆ°å¯¹ç«¯çš„RSTï¼›è€Œå¦‚æœå¯¹ç«¯æ˜¯çªç„¶å´©æºƒåé‡å¯ï¼Œç”±äºæœ¬ç«¯ä¸çŸ¥é“å¯¹ç«¯å·²ç»å´©æºƒï¼Œæ­¤æ—¶æœ¬ç«¯å‘é€çš„æ•°æ®åˆ°è¾¾å¯¹ç«¯ï¼Œä¹Ÿä¼šæ”¶åˆ°RSTã€‚<br>é’ˆå¯¹è¿™ä¸¤ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ï¼Œæ ¹æ®æˆ‘çš„ç†è§£ï¼Œå‰è€…åº”è¯¥æ˜¯å…³é—­æœ¬ç«¯çš„å†™ï¼Œè€Œåè€…åˆ™åº”è¯¥ç›´æ¥å…³é—­æœ¬ç«¯åˆ°å¯¹ç«¯çš„è¿æ¥ã€‚é‚£ä¹ˆå¦‚ä½•åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µå‘¢ï¼Ÿæˆ‘æ„Ÿè§‰åœ¨æœ¬ç«¯çš„ååº”éƒ½æ˜¯åŒæ ·çš„readè¿”å›ï¼Œç„¶åerrnoè¢«è®¾ç½®ä¸ºECONNRESETï¼Œæˆ‘è¯¥æ€ä¹ˆçŸ¥é“åˆ°åº•æ˜¯å“ªç§æƒ…å†µå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480871,"discussion_content":"ä¸ºå•¥è¦åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µå‘¢ï¼Ÿç¨‹åºè¿™ç«¯éƒ½æ˜¯è¿æ¥æ— æ•ˆï¼Œæ— æ³•è¿›è¡Œæ•°æ®çš„æœ‰æ•ˆä¼ è¾“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580630463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154697,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1574514105,"is_pvip":false,"replies":[{"id":"60387","content":"è¿™ä¸ªé—®é¢˜å¾ˆå¤§ã€‚ã€‚ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1575189317,"ip_address":"","comment_id":154697,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574514105","product_id":100032701,"comment_content":"å‡å¦‚è®©ä½ è®¾è®¡ä¸€ä¸ªç½‘ç»œé€šä¿¡åè®®ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475551,"discussion_content":"è¿™ä¸ªé—®é¢˜å¾ˆå¤§ã€‚ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575189317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153562,"user_name":"æ—æ—","can_delete":false,"product_type":"c1","uid":1613227,"ip_address":"","ucode":"7B6318B971E430","user_header":"https://static001.geekbang.org/account/avatar/00/18/9d/ab/6589d91a.jpg","comment_is_top":false,"comment_ctime":1574258809,"is_pvip":false,"replies":[{"id":"59336","content":"killæ‰Aè¿›ç¨‹åï¼ŒBè¿›ç¨‹å¦‚æœæ”¶ä¸åˆ°FINåŒ…ï¼Œå®ƒçš„å´èƒ½ä¿æŒESTABLISHEDçŠ¶æ€ï¼Œé€šè¿‡å¯¹é“¾è·¯è¿›è¡Œè¯»å†™å¯ä»¥æ„ŸçŸ¥é“¾è·¯çš„çŠ¶æ€ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åŠ ä¸Šå¿ƒè·³æ£€æµ‹ï¼Œæ£€æµ‹å‡ºé“¾è·¯çš„çŠ¶æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1574498924,"ip_address":"","comment_id":153562,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574258809","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³è¯·æ•™ä¸‹ã€‚<br>æœ‰è¿›ç¨‹Aå’ŒB(åœ¨åŒä¸€ç‰©ç†æœºä¸‹)ï¼ŒAä¼šç›‘å¬Bçš„è¿æ¥ã€‚åœ¨æˆ‘å¯¹è¿›ç¨‹A kill -2åï¼ŒBä¸Açš„è¿æ¥ä¸€ç›´ä¿æŒç€ESTABILISH,  è¿›ç¨‹Aé‡å¯æ—¶ï¼Œç»‘å®šç›‘å¬ç«¯å£ä¼šå‡ºç°ç«¯å£è¢«å ç”¨çš„å¼‚å¸¸ã€‚<br><br>è¿™ç§æƒ…å†µæ˜¯å¦è¡¨ç¤ºBæ²¡æœ‰æ”¶åˆ°Açš„finåŒ…ï¼Œæ‰€ä»¥æ‰ä¸€ç›´ä¿æŒç€ESTABILISHçš„çŠ¶æ€ï¼Ÿ è¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆè§£å†³ï¼Ÿ<br><br>å¦‚æœæˆ‘ç»™è¿›ç¨‹BåŠ ä¸Šä¸€ä¸ªå¯¹Açš„å¿ƒè·³æ£€æµ‹ï¼Œèƒ½å¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ<br><br>æœŸå¾…è€å¸ˆèƒ½ç»™æˆ‘ç­”ç–‘","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475211,"discussion_content":"killæ‰Aè¿›ç¨‹åï¼ŒBè¿›ç¨‹å¦‚æœæ”¶ä¸åˆ°FINåŒ…ï¼Œå®ƒçš„å´èƒ½ä¿æŒESTABLISHEDçŠ¶æ€ï¼Œé€šè¿‡å¯¹é“¾è·¯è¿›è¡Œè¯»å†™å¯ä»¥æ„ŸçŸ¥é“¾è·¯çš„çŠ¶æ€ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åŠ ä¸Šå¿ƒè·³æ£€æµ‹ï¼Œæ£€æµ‹å‡ºé“¾è·¯çš„çŠ¶æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574498924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141779,"user_name":"JasonZhi","can_delete":false,"product_type":"c1","uid":1282818,"ip_address":"","ucode":"6C23DCD592636D","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/02/fcab58d1.jpg","comment_is_top":false,"comment_ctime":1571223593,"is_pvip":true,"replies":[{"id":"55110","content":"å¦‚æ–‡ä¸­æ‰€è¯´ï¼Œæˆ‘åœ¨MACç³»ç»Ÿä¸Šå®éªŒçš„ç»“æœå´æ˜¯æ˜¯SIGPIPEï¼Œä½†æ˜¯åœ¨Linux 4.4å†…æ ¸ä¸Šçš„å®éªŒç»“æœå´æ˜¯ç›´æ¥è¿”å›äº†RSTç»“æœï¼Œä¼ ç»Ÿæ•™ç§‘ä¹¦éƒ½æ˜¯è¯´åº”è¯¥è¿”å›SIGPIPEï¼Œä½†æ˜¯æˆ‘å¾—åˆ°çš„Linux 4.4ä¸Šçš„ç»“æœå´ä¸æ˜¯è¿™æ ·çš„ã€‚<br><br>æˆ‘å»ºè®®ä½ é€šè¿‡å®éªŒå†å°è¯•ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1571455504,"ip_address":"","comment_id":141779,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571223593","product_id":100032701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæ–‡ç« çš„æœ€åä¸€ä¸ªä¾‹å­è¿˜æœ‰ä¸€äº›ç–‘é—®ã€‚æˆ‘çš„ç†è§£æ˜¯å¯¹äºä¸€ä¸ªå·²ç»å…³é—­çš„socket ï¼Œæ‰§è¡Œä¸¤æ¬¡write ï¼Œç¬¬ä¸€æ¬¡write ä¼šå¯¼è‡´å¯¹ç«¯è¿”å›RSTï¼Œç¬¬äºŒæ¬¡write ç”±äºå¯¹æ”¶åˆ°RSTçš„socket æ‰§è¡Œå†™æ“ä½œï¼Œä¼šè§¦å‘SIGPIPEã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆä¾‹å­å´è¯´ä¼šè¿”å›peer resetçš„é”™è¯¯å‘¢ï¼Ÿæ˜¯ä¸æ˜¯æˆ‘å“ªé‡Œç†è§£é”™äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470885,"discussion_content":"å¦‚æ–‡ä¸­æ‰€è¯´ï¼Œæˆ‘åœ¨MACç³»ç»Ÿä¸Šå®éªŒçš„ç»“æœå´æ˜¯æ˜¯SIGPIPEï¼Œä½†æ˜¯åœ¨Linux 4.4å†…æ ¸ä¸Šçš„å®éªŒç»“æœå´æ˜¯ç›´æ¥è¿”å›äº†RSTç»“æœï¼Œä¼ ç»Ÿæ•™ç§‘ä¹¦éƒ½æ˜¯è¯´åº”è¯¥è¿”å›SIGPIPEï¼Œä½†æ˜¯æˆ‘å¾—åˆ°çš„Linux 4.4ä¸Šçš„ç»“æœå´ä¸æ˜¯è¿™æ ·çš„ã€‚\n\næˆ‘å»ºè®®ä½ é€šè¿‡å®éªŒå†å°è¯•ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571455504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139144,"user_name":"JasonZhi","can_delete":false,"product_type":"c1","uid":1282818,"ip_address":"","ucode":"6C23DCD592636D","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/02/fcab58d1.jpg","comment_is_top":false,"comment_ctime":1570556614,"is_pvip":true,"replies":[{"id":"54319","content":"ä¼‘çœ 4ç§’ä¹‹åå¾€ä¸€ä¸ªå·²ç»å…³é—­çš„å¥—æ¥å­—è®°ä¸‹å†™æ•°æ®ï¼Œäºæ˜¯å¾—åˆ°äº†SIGPIPEä¿¡å·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570973157,"ip_address":"","comment_id":139144,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1570556614","product_id":100032701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘åœ¨linuxç¯å¢ƒä¸‹æµ‹è¯•æœ€åä¸€ä¸ªä¾‹å­æ—¶ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç çš„count--åé¢åŠ ä¸Šsleep(4)ï¼Œé‚£ä¹ˆå…³é—­æœåŠ¡ç«¯åï¼Œè¿ç»­å‘æœåŠ¡ç«¯å†™å…¥å°±ä¼šè¿”å›PIPIEé”™è¯¯ï¼Œå¹¶ä¸”ä¼šæ”¶åˆ°SIGPIPIEä¿¡å·ï¼Œèƒ½è§£é‡Šå…¶ä¸­åŸå› å—ï¼Ÿ<br>è´´ä¸Šä»£ç ï¼š<br> while (count &gt; 0) {<br>        n_written = send(socket_fd, msg, strlen(msg), 0);<br>        fprintf(stdout, &quot;send into buffer %ld \\n&quot;, n_written);<br><br>        if (n_written &lt;= 0) {<br>            error(1, errno, &quot;send error&quot;);<br>            return -1;<br>        }<br>        count--;<br><br>        sleep(4);<br>    }","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469811,"discussion_content":"ä¼‘çœ 4ç§’ä¹‹åå¾€ä¸€ä¸ªå·²ç»å…³é—­çš„å¥—æ¥å­—è®°ä¸‹å†™æ•°æ®ï¼Œäºæ˜¯å¾—åˆ°äº†SIGPIPEä¿¡å·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570973157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1282818,"avatar":"https://static001.geekbang.org/account/avatar/00/13/93/02/fcab58d1.jpg","nickname":"JasonZhi","note":"","ucode":"6C23DCD592636D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":34132,"discussion_content":"è¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªæ˜ç™½ï¼Œè¿™ç§æƒ…å†µè·Ÿè€å¸ˆä½ ä¸¾çš„æœ€åä¸€ä¸ªä¾‹å­æœ‰ä»€ä¹ˆä¸ä¸€æ ·å—ï¼Ÿæˆ‘çš„ç†è§£å®ƒä»¬éƒ½åº”è¯¥å±äºåŒä¸€ç§æƒ…å†µæ‰å¯¹å§ï¼Ÿç¬¬ä¸€æ¬¡writeè¿”å›RSTï¼Œç¬¬äºŒæ¬¡writeè§¦å‘SIGPIPE","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571166209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135316,"user_name":"å¾®æ€","can_delete":false,"product_type":"c1","uid":1004349,"ip_address":"","ucode":"853C48AA183A7B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/53/3d/1189e48a.jpg","comment_is_top":false,"comment_ctime":1569124509,"is_pvip":true,"replies":[{"id":"52192","content":"æ˜¯æ‰“å°å‡ºæ¥çš„errorä¿¡æ¯ï¼Œ<br>if (err)<br>   fprintf(stderr, &quot;: %s (%d)\\n&quot;, strerror(err), err);","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1569406376,"ip_address":"","comment_id":135316,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1569124509","product_id":100032701,"comment_content":"è€å¸ˆï¼Œæœ€åä¸€è¡Œçš„Connection reset by peeræ˜¯ä»å“ªé‡Œæ‰“å°è¾“å‡ºçš„ï¼Ÿæ˜¯å†…æ ¸åè®®æ ˆæ‰“å°è¾“å‡ºåˆ°ç»ˆç«¯ä¸Šçš„å—ï¼Ÿåœ¨ç¨‹åºä»£ç ä¸­æ²¡æ‰¾åˆ°å¯¹åº”çš„printfè¯­å¥","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468140,"discussion_content":"æ˜¯æ‰“å°å‡ºæ¥çš„errorä¿¡æ¯ï¼Œ\nif (err)\n   fprintf(stderr, &amp;quot;: %s (%d)\\n&amp;quot;, strerror(err), err);","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569406376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132152,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1568033405,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568033405","product_id":100032701,"comment_content":"Linux VM-0-13-ubuntu 4.15.0-54-generic #58-Ubuntu SMP Mon Jun 24 10:55:24 UTC 2019 x86_64 x86_64 x86_64 GNU&#47;Linux<br>è¿™ä¸ªæ˜¯å®¢æˆ·ç«¯ä¸åœçš„å‘é€ç„¶åæœåŠ¡å™¨ç«¯çªç„¶å…³é—­<br>.&#47;client: send error: Connection reset by peer","like_count":0},{"had_liked":false,"id":132137,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1568030160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568030160","product_id":100032701,"comment_content":"ç¬¬ä¸€é—®å› ä¸ºè¦å†™ä»£ç æ‰€ä»¥ç­‰ä¼šæ¥å›ç­”å…ˆå›ç­”ç¬¬äºŒé—®<br>å…¶å®æœåŠ¡å™¨æ­£å¸¸é€€å‡ºå’Œå¼‚å¸¸çªå‡ºæˆ‘è§‰å¾—éƒ½å·®ä¸å¤š,éƒ½éœ€è¦é readæˆ–è€…writeå»æ„ŸçŸ¥,å¦‚æœå¯¹æ–¹å·²ç»æ–­å¼€è¿æ¥å°±ä¼šå‘é€ä¸€ä¸ªfinåˆ°æœ¬æ–¹çš„æ¥æ”¶ç¼“å†²åŒºå˜ä¸ºeof,readå‡½æ•°ä¹Ÿè¿”å›0,è°ƒç”¨writeä¼šå¤±è´¥","like_count":0},{"had_liked":false,"id":132065,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1568017849,"is_pvip":false,"replies":[{"id":"50781","content":"ä½ å·²ç»å›ç­”è‡ªå·±çš„é—®é¢˜äº†ï¼Œå½“ç„¶æ˜¯æ–°çš„è¿æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568189225,"ip_address":"","comment_id":132065,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568017849","product_id":100032701,"comment_content":"å…¶å®æˆ‘ä¹Ÿä¸€ç›´æƒ³é—® æ¯”å¦‚ æˆ‘å®¢æˆ·ç«¯çªç„¶å´©æºƒäº† ç„¶åå†å¯åŠ¨å®¢æˆ·ç«¯è¿æ¥ä¸ŠæœåŠ¡å™¨ åˆ°åº•æ˜¯æ–°å»ºç«‹ä¸€ä¸ªé“¾æ¥ è¿˜æ˜¯è€çš„è¿æ¥ å¹¶ä¸”å‘é€rst?","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466742,"discussion_content":"ä½ å·²ç»å›ç­”è‡ªå·±çš„é—®é¢˜äº†ï¼Œå½“ç„¶æ˜¯æ–°çš„è¿æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568189225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131966,"user_name":"çŸ³å°†ä»","can_delete":false,"product_type":"c1","uid":1375617,"ip_address":"","ucode":"12F43E643D1D58","user_header":"https://static001.geekbang.org/account/avatar/00/14/fd/81/1864f266.jpg","comment_is_top":false,"comment_ctime":1567994245,"is_pvip":false,"replies":[{"id":"50784","content":"å› ä¸ºTCPæ˜¯åŒå‘çš„ï¼Œå¯¹ç«¯æ˜¯ä¸€ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œè¿æ¥å»ºç«‹ä¹‹åï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å½¼æ­¤äº’ä¸ºå¯¹æ–¹çš„å¯¹ç«¯ã€‚<br><br>å»ºè®®ä½ å†å¤šç†å‡ éï¼Œæ¬¢è¿æå…·ä½“çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568189518,"ip_address":"","comment_id":131966,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1567994245","product_id":100032701,"comment_content":"è¿™ç¯‡è¯»äº†å‡ éè¿˜æ˜¯å¾ˆæ‡µï¼Œå¾ˆå¤šæ¦‚å¿µç†ä¸æ¸…æ¥šï¼Œä¸çŸ¥é“å¯¹ç«¯åˆ°åº•æ˜¯æœåŠ¡å™¨ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œéƒ½æ··æ·†äº†","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466699,"discussion_content":"å› ä¸ºTCPæ˜¯åŒå‘çš„ï¼Œå¯¹ç«¯æ˜¯ä¸€ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œè¿æ¥å»ºç«‹ä¹‹åï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å½¼æ­¤äº’ä¸ºå¯¹æ–¹çš„å¯¹ç«¯ã€‚\n\nå»ºè®®ä½ å†å¤šç†å‡ éï¼Œæ¬¢è¿æå…·ä½“çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568189518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1236766,"avatar":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","nickname":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","note":"","ucode":"103543D6E706BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8643,"discussion_content":"æˆ‘è§‰å¾—å¹¶ä¸ä¸€å®šéè¦åˆ†æ¸… æœåŠ¡å™¨è¿˜æ˜¯å®¢æˆ·ç«¯ æ¯”å¦‚ ä½ å…³é—­äº†è¿æ¥ æˆ‘è°ƒç”¨recvæˆ–è€…writeçš„ç°è±¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568030490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131911,"user_name":"J.M.Liu","can_delete":false,"product_type":"c1","uid":1200037,"ip_address":"","ucode":"B2CB84B8E923A6","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/a5/71358d7b.jpg","comment_is_top":false,"comment_ctime":1567962217,"is_pvip":false,"replies":[{"id":"50785","content":"è¿™é‡Œæƒ³è¦è¡¨è¾¾çš„å°±æ˜¯é€šè¿‡read&#47;writeæ¥æ„ŸçŸ¥TCPé“¾è·¯çš„çŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡readæ¥æ„ŸçŸ¥ï¼Œä¸€ä¸ªæ˜¯åœ¨æ²¡æœ‰readçš„æƒ…å†µä¸‹ä½¿ç”¨writeæ¥æ„ŸçŸ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568189643,"ip_address":"","comment_id":131911,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1567962217","product_id":100032701,"comment_content":"æ²¡æœ‰çœ‹å‡ºâ€œé€šè¿‡ write äº§ç”Ÿ RSTï¼Œread è°ƒç”¨æ„ŸçŸ¥ RSTâ€å’Œâ€œå‘ä¸€ä¸ªå·²å…³é—­è¿æ¥è¿ç»­å†™ï¼Œäº§ç”ŸSIGPIPEâ€äºŒè€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘€ã€‚å‰è€…ä¸¤ä¸ªwriteä¹‹é—´å¤šäº†ä¸€æ¬¡readï¼Œä¸ºä½•åœ¨linuxä¸‹çš„è¿”å›ç»“æœå°±ä¸ä¸€æ ·äº†å‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466677,"discussion_content":"è¿™é‡Œæƒ³è¦è¡¨è¾¾çš„å°±æ˜¯é€šè¿‡read/writeæ¥æ„ŸçŸ¥TCPé“¾è·¯çš„çŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡readæ¥æ„ŸçŸ¥ï¼Œä¸€ä¸ªæ˜¯åœ¨æ²¡æœ‰readçš„æƒ…å†µä¸‹ä½¿ç”¨writeæ¥æ„ŸçŸ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568189643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1101226,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cd/aa/33d48789.jpg","nickname":"å«æ±Ÿ","note":"","ucode":"DE2F7A6916F1A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8483,"discussion_content":"linuxå†…æ ¸æ”¶åˆ°tcpåˆ†ç»„ï¼Œå°±ä¼šæŸ¥æ‰¾å¯¹åº”çš„è¿æ¥ï¼Œå¦‚æœæ‰¾ä¸åˆ°æˆ–å·²ç»å…³é—­ç­‰éƒ½ä¼šå›å¤rstï¼Œå¯¹ç«¯çš„linuxå†…æ ¸æ”¶åˆ°ä¹‹åï¼Œå°±ä¼šæ ‡è®°æœ¬åœ°å¯¹åº”çš„è¿æ¥çš„çŠ¶æ€ï¼Œæ¯”å¦‚å·²ç»æ¥å—äº†rstï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œå†æ¬¡è¿›è¡Œwriteï¼Œå†…æ ¸ä¼šç›´æ¥äº§ç”Ÿsigpipeä¿¡å·ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œè¿›è¡Œreadï¼Œä¹Ÿä¼šç«‹å³è¿”å›ï¼Œå¹¶é€šè¿‡è¿”å›å€¼å’Œé”™è¯¯ç æ¥æ ‡è¯†åŸå› ã€‚æ‰€ä»¥ï¼Œä¸Šé¢å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåªæ˜¯æƒ³è¯´ï¼Œå¯¹äºæ”¶åˆ°rstçš„è¿æ¥ï¼Œå†æ¬¡writeä¼šäº§ç”Ÿsigpipeä¿¡å·ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œç»§ç»­readå’Œæ”¶åˆ°rstä¹‹åreadæ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œæ‰€ä»¥ï¼Œä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡readå’Œwriteæ¥æ„ŸçŸ¥å¼‚å¸¸æƒ…å†µï¼Œä¸è¿‡ä¸»è¦è¿˜æ˜¯éœ€è¦readï¼ŒåŒæ—¶å› ä¸ºç½‘ç»œä¸­æ–­ï¼Œæœºå™¨æŒ‚æ‰ç­‰å½±å“å¯¹tcpåˆ†ç»„çš„å›å¤ï¼Œä»è€Œåªèƒ½ä¾èµ–è¶…æ—¶æ¥é…åˆå®Œå–„æ‰€æœ‰å¯èƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬åº”ç”¨å±‚ä¸­çš„å¿ƒè·³åŒ…ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1568009324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}