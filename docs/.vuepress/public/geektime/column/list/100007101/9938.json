{"id":9938,"title":"第19讲 | HttpDNS：网络世界的地址簿也会指错路","content":"<p>上一节我们知道了DNS的两项功能，第一是根据名称查到具体的地址，另外一个是可以针对多个地址做负载均衡，而且可以在多个地址中选择一个距离你近的地方访问。</p><p>然而有时候这个地址簿也经常给你指错路，明明距离你500米就有个吃饭的地方，非要把你推荐到5公里外。为什么会出现这样的情况呢？</p><p>还记得吗？当我们发出请求解析DNS的时候，首先，会先连接到运营商本地的DNS服务器，由这个服务器帮我们去整棵DNS树上进行解析，然后将解析的结果返回给客户端。但是本地的DNS服务器，作为一个本地导游，往往有自己的“小心思”。</p><h2>传统DNS存在哪些问题？</h2><h3>1.域名缓存问题</h3><p>它可以在本地做一个缓存，也就是说，不是每一个请求，它都会去访问权威DNS服务器，而是访问过一次就把结果缓存到自己本地，当其他人来问的时候，直接就返回这个缓存数据。</p><p>这就相当于导游去过一个饭店，自己脑子记住了地址，当有一个游客问的时候，他就凭记忆回答了，不用再去查地址簿。这样经常存在的一个问题是，人家那个饭店明明都已经搬了，结果作为导游，他并没有刷新这个缓存，结果你辛辛苦苦到了这个地点，发现饭店已经变成了服装店，你是不是会非常失望？</p><p>另外，有的运营商会把一些静态页面，缓存到本运营商的服务器内，这样用户请求的时候，就不用跨运营商进行访问，这样既加快了速度，也减少了运营商之间流量计算的成本。在域名解析的时候，不会将用户导向真正的网站，而是指向这个缓存的服务器。</p><!-- [[[read_end]]] --><p>很多情况下是看不出问题的，但是当页面更新，用户会访问到老的页面，问题就出来了。例如，你听说一个餐馆推出了一个新菜，你想去尝一下。结果导游告诉你，在这里吃也是一样的。有的游客会觉得没问题，但是对于想尝试新菜的人来说，如果导游说带你去，但其实并没有吃到新菜，你是不是也会非常失望呢？</p><p>再就是本地的缓存，往往使得全局负载均衡失败，因为上次进行缓存的时候，缓存中的地址不一定是这次访问离客户最近的地方，如果把这个地址返回给客户，那肯定就会绕远路。</p><p>就像上一次客户要吃西湖醋鱼的事，导游知道西湖边有一家，因为当时游客就在西湖边，可是，下一次客户在灵隐寺，想吃西湖醋鱼的时候，导游还指向西湖边的那一家，那这就绕得太远了。</p><p><img src=\"https://static001.geekbang.org/resource/image/8b/eb/8b5e670e22c459e859293db1bed643eb.jpg?wh=1383*965\" alt=\"\"></p><h3>2.域名转发问题</h3><p>缓存问题还是说本地域名解析服务，还是会去权威DNS服务器中查找，只不过不是每次都要查找。可以说这还是大导游、大中介。还有一些小导游、小中介，有了请求之后，直接转发给其他运营商去做解析，自己只是外包了出去。</p><p>这样的问题是，如果是A运营商的客户，访问自己运营商的DNS服务器，如果A运营商去权威DNS服务器查询的话，权威DNS服务器知道你是A运营商的，就返回给一个部署在A运营商的网站地址，这样针对相同运营商的访问，速度就会快很多。</p><p>但是A运营商偷懒，将解析的请求转发给B运营商，B运营商去权威DNS服务器查询的话，权威服务器会误认为，你是B运营商的，那就返回给你一个在B运营商的网站地址吧，结果客户的每次访问都要跨运营商，速度就会很慢。</p><p><img src=\"https://static001.geekbang.org/resource/image/cf/f1/cfde4b3bc5c0aabaaa81f3a26cd99cf1.jpg?wh=1645*1055\" alt=\"\"></p><h3>3.出口NAT问题</h3><p>前面讲述网关的时候，我们知道，出口的时候，很多机房都会配置<strong>NAT</strong>，也即<strong>网络地址转换</strong>，使得从这个网关出去的包，都换成新的IP地址，当然请求返回的时候，在这个网关，再将IP地址转换回去，所以对于访问来说是没有任何问题。</p><p>但是一旦做了网络地址的转换，权威的DNS服务器，就没办法通过这个地址，来判断客户到底是来自哪个运营商，而且极有可能因为转换过后的地址，误判运营商，导致跨运营商的访问。</p><h3>4.域名更新问题</h3><p>本地DNS服务器是由不同地区、不同运营商独立部署的。对域名解析缓存的处理上，实现策略也有区别，有的会偷懒，忽略域名解析结果的TTL时间限制，在权威DNS服务器解析变更的时候，解析结果在全网生效的周期非常漫长。但是有的时候，在DNS的切换中，场景对生效时间要求比较高。</p><p>例如双机房部署的时候，跨机房的负载均衡和容灾多使用DNS来做。当一个机房出问题之后，需要修改权威DNS，将域名指向新的IP地址，但是如果更新太慢，那很多用户都会出现访问异常。</p><p>这就像，有的导游比较勤快、敬业，时时刻刻关注酒店、餐馆、交通的变化，问他的时候，往往会得到最新情况。有的导游懒一些，8年前背的导游词就没换过，问他的时候，指的路往往就是错的。</p><h3>5.解析延迟问题</h3><p>从上一节的DNS查询过程来看，DNS的查询过程需要递归遍历多个DNS服务器，才能获得最终的解析结果，这会带来一定的时延，甚至会解析超时。</p><h2>HttpDNS的工作模式</h2><p>既然DNS解析中有这么多问题，那怎么办呢？难不成退回到直接用IP地址？这样显然不合适，所以就有了<strong> HttpDNS</strong>。</p><p>HttpDNS其实就是，不走传统的DNS解析，而是自己搭建基于HTTP协议的DNS服务器集群，分布在多个地点和多个运营商。当客户端需要DNS解析的时候，直接通过HTTP协议进行请求这个服务器集群，得到就近的地址。</p><p>这就相当于每家基于HTTP协议，自己实现自己的域名解析，自己做一个自己的地址簿，而不使用统一的地址簿。但是默认的域名解析都是走DNS的，因而使用HttpDNS需要绕过默认的DNS路径，就不能使用默认的客户端。使用HttpDNS的，往往是手机应用，需要在手机端嵌入支持HttpDNS的客户端SDK。</p><p>通过自己的HttpDNS服务器和自己的SDK，实现了从依赖本地导游，到自己上网查询做旅游攻略，进行自由行，爱怎么玩怎么玩。这样就能够避免依赖导游，而导游又不专业，你还不能把他怎么样的尴尬。</p><p>下面我来解析一下<strong> HttpDNS的工作模式</strong>。</p><p>在客户端的SDK里动态请求服务端，获取HttpDNS服务器的IP列表，缓存到本地。随着不断地解析域名，SDK也会在本地缓存DNS域名解析的结果。</p><p>当手机应用要访问一个地址的时候，首先看是否有本地的缓存，如果有就直接返回。这个缓存和本地DNS的缓存不一样的是，这个是手机应用自己做的，而非整个运营商统一做的。如何更新、何时更新，手机应用的客户端可以和服务器协调来做这件事情。</p><p>如果本地没有，就需要请求HttpDNS的服务器，在本地HttpDNS服务器的IP列表中，选择一个发出HTTP的请求，会返回一个要访问的网站的IP列表。</p><p>请求的方式是这样的。</p><pre><code>curl http://106.2.xxx.xxx/d?dn=c.m.163.com\n{&quot;dns&quot;:[{&quot;host&quot;:&quot;c.m.163.com&quot;,&quot;ips&quot;:[&quot;223.252.199.12&quot;],&quot;ttl&quot;:300,&quot;http2&quot;:0}],&quot;client&quot;:{&quot;ip&quot;:&quot;106.2.81.50&quot;,&quot;line&quot;:269692944}}\n</code></pre><p>手机客户端自然知道手机在哪个运营商、哪个地址。由于是直接的HTTP通信，HttpDNS服务器能够准确知道这些信息，因而可以做精准的全局负载均衡。</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/75/aa45cf8a07b563ccea376f712b2e8975.jpg?wh=1581*1261\" alt=\"\"></p><p>当然，当所有这些都不工作的时候，可以切换到传统的LocalDNS来解析，慢也比访问不到好。那HttpDNS是如何解决上面的问题的呢？</p><p>其实归结起来就是两大问题。一是解析速度和更新速度的平衡问题，二是智能调度的问题，对应的解决方案是HttpDNS的缓存设计和调度设计。</p><h3>HttpDNS的缓存设计</h3><p>解析DNS过程复杂，通信次数多，对解析速度造成很大影响。为了加快解析，因而有了缓存，但是这又会产生缓存更新速度不及时的问题。最要命的是，这两个方面都掌握在别人手中，也即本地DNS服务器手中，它不会为你定制，你作为客户端干着急没办法。</p><p>而HttpDNS就是将解析速度和更新速度全部掌控在自己手中。一方面，解析的过程，不需要本地DNS服务递归的调用一大圈，一个HTTP的请求直接搞定，要实时更新的时候，马上就能起作用；另一方面为了提高解析速度，本地也有缓存，缓存是在客户端SDK维护的，过期时间、更新时间，都可以自己控制。</p><p>HttpDNS的缓存设计策略也是咱们做应用架构中常用的缓存设计模式，也即分为客户端、缓存、数据源三层。</p><ul>\n<li>\n<p>对于应用架构来讲，就是应用、缓存、数据库。常见的是Tomcat、Redis、MySQL。</p>\n</li>\n<li>\n<p>对于HttpDNS来讲，就是手机客户端、DNS缓存、HttpDNS服务器。</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/9e/56/9e0141a2939e7c194689e990859ed456.jpg?wh=871*868\" alt=\"\"></p><p>只要是缓存模式，就存在缓存的过期、更新、不一致的问题，解决思路也是很像的。</p><p>例如DNS缓存在内存中，也可以持久化到存储上，从而APP重启之后，能够尽快从存储中加载上次累积的经常访问的网站的解析结果，就不需要每次都全部解析一遍，再变成缓存。这有点像Redis是基于内存的缓存，但是同样提供持久化的能力，使得重启或者主备切换的时候，数据不会完全丢失。</p><p>SDK中的缓存会严格按照缓存过期时间，如果缓存没有命中，或者已经过期，而且客户端不允许使用过期的记录，则会发起一次解析，保障记录是更新的。</p><p>解析可以<strong>同步进行</strong>，也就是直接调用HttpDNS的接口，返回最新的记录，更新缓存；也可以<strong>异步进行</strong>，添加一个解析任务到后台，由后台任务调用HttpDNS的接口。</p><p><strong>同步更新</strong>的<strong>优点</strong>是实时性好，缺点是如果有多个请求都发现过期的时候，同时会请求HttpDNS多次，其实是一种浪费。</p><p>同步更新的方式对应到应用架构中缓存的<strong>Cache-Aside机制</strong>，也即先读缓存，不命中读数据库，同时将结果写入缓存。</p><img style=\"margin: 0 auto\" src=\"https://static001.geekbang.org/resource/image/34/b4/346a1bf30fb56ef918d708f422dc3bb4.jpg?wh=664*801\"><p><strong>异步更新</strong>的<strong>优点</strong>是，可以将多个请求都发现过期的情况，合并为一个对于HttpDNS的请求任务，只执行一次，减少HttpDNS的压力。同时可以在即将过期的时候，就创建一个任务进行预加载，防止过期之后再刷新，称为<strong>预加载</strong>。</p><p>它的<strong>缺点</strong>是当前请求拿到过期数据的时候，如果客户端允许使用过期数据，需要冒一次风险。如果过期的数据还能请求，就没问题；如果不能请求，则失败一次，等下次缓存更新后，再请求方能成功。</p><p><img src=\"https://static001.geekbang.org/resource/image/df/98/df65059e9b66c32bbbca6febf6ecb298.jpg?wh=472*826\" alt=\"\"></p><p>异步更新的机制对应到应用架构中缓存的<strong>Refresh-Ahead机制</strong>，即业务仅仅访问缓存，当过期的时候定期刷新。在著名的应用缓存Guava Cache中，有个RefreshAfterWrite机制，对于并发情况下，多个缓存访问不命中从而引发并发回源的情况，可以采取只有一个请求回源的模式。在应用架构的缓存中，也常常用<strong>数据预热</strong>或者<strong>预加载</strong>的机制。</p><p><img src=\"https://static001.geekbang.org/resource/image/16/28/161a14f41b3547739982ec551aa26928.jpg?wh=626*770\" alt=\"\"></p><h3>HttpDNS的调度设计</h3><p>由于客户端嵌入了SDK，因而就不会因为本地DNS的各种缓存、转发、NAT，让权威DNS服务器误会客户端所在的位置和运营商，而可以拿到第一手资料。</p><p>在<strong>客户端</strong>，可以知道手机是哪个国家、哪个运营商、哪个省，甚至哪个市，HttpDNS服务端可以根据这些信息，选择最佳的服务节点访问。</p><p>如果有多个节点，还会考虑错误率、请求时间、服务器压力、网络状况等，进行综合选择，而非仅仅考虑地理位置。当有一个节点宕机或者性能下降的时候，可以尽快进行切换。</p><p>要做到这一点，需要客户端使用HttpDNS返回的IP访问业务应用。客户端的SDK会收集网络请求数据，如错误率、请求时间等网络请求质量数据，并发送到统计后台，进行分析、聚合，以此查看不同的IP的服务质量。</p><p>在<strong>服务端</strong>，应用可以通过调用HttpDNS的管理接口，配置不同服务质量的优先级、权重。HttpDNS会根据这些策略综合地理位置和线路状况算出一个排序，优先访问当前那些优质的、时延低的IP地址。</p><p>HttpDNS通过智能调度之后返回的结果，也会缓存在客户端。为了不让缓存使得调度失真，客户端可以根据不同的移动网络运营商WIFI的SSID来分维度缓存。不同的运营商或者WIFI解析出来的结果会不同。</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/ae/3b368yy7a4f2319bd6491bc4e66e55ae.jpg?wh=1937*1634\" alt=\"\"></p><h2>小结</h2><p>好了，这节就到这里了，我们来总结一下，你需要记住这两个重点：</p><ul>\n<li>\n<p>传统的DNS有很多问题，例如解析慢、更新不及时。因为缓存、转发、NAT问题导致客户端误会自己所在的位置和运营商，从而影响流量的调度。</p>\n</li>\n<li>\n<p>HttpDNS通过客户端SDK和服务端，通过HTTP直接调用解析DNS的方式，绕过了传统DNS的这些缺点，实现了智能的调度。</p>\n</li>\n</ul><p>最后，给你留两个思考题。</p><ol>\n<li>\n<p>使用HttpDNS，需要向HttpDNS服务器请求解析域名，可是客户端怎么知道HttpDNS服务器的地址或者域名呢？</p>\n</li>\n<li>\n<p>HttpDNS的智能调度，主要是让客户端选择最近的服务器，而有另一种机制，使得资源分发到离客户端更近的位置，从而加快客户端的访问，你知道是什么技术吗？</p>\n</li>\n</ol><p>我们的专栏更新过半了，不知你掌握得如何？每节课后我留的思考题，你都有没有认真思考，并在留言区写下答案呢？我会从已发布的文章中选出一批认真留言的同学，赠送学习奖励礼券和我整理的独家网络协议知识图谱。</p><p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>","neighbors":{"left":{"article_title":"第18讲 | DNS协议：网络世界的地址簿","id":9895},"right":{"article_title":"第20讲 | CDN：你去小卖部取过快递么？","id":10085}},"comments":[{"had_liked":false,"id":14196,"user_name":"赵强强","can_delete":false,"product_type":"c1","uid":1073596,"ip_address":"","ucode":"1B8AE07484C69A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/bc/88a905a5.jpg","comment_is_top":false,"comment_ctime":1530232357,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"551286046245","product_id":100007101,"comment_content":"老师能不能写个专题介绍一下国内几大运营商网络状况和互联关系😬 ","like_count":129,"discussions":[{"author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201593,"discussion_content":"我觉得这个没必要了解吧，面试时也不可能问这个吧。。。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1583812893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1717549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/35/2d/a2bde67e.jpg","nickname":"SapereAude","note":"","ucode":"C5D61C535B7B10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":62926,"discussion_content":"同学们可以把这条顶上去了！","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1574864160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1344431,"avatar":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","nickname":"马以","note":"","ucode":"3FEA06CA14DE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230357,"discussion_content":"我顶","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586740997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575994,"discussion_content":"+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655220076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14187,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1530231277,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"375192386029","product_id":100007101,"comment_content":"1.httpdns服务器的地址一般不变 可以使用dns的方式获取httpdns服务器的ip地址 也可以直接把httpdns服务器的ip地址写死在客户端中。<br><br>2.让用户获取离用户最近的资源 一般是静态资源 这使用的是cdn技术","like_count":87,"discussions":[{"author":{"id":1120583,"avatar":"https://static001.geekbang.org/account/avatar/00/11/19/47/b27f1314.jpg","nickname":"kissrain","note":"","ucode":"2177C53E3B2DCC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":184048,"discussion_content":"个人觉得准确点应该是httpdns服务器的lvs地址","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582542107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14320,"user_name":"xyz","can_delete":false,"product_type":"c1","uid":1016059,"ip_address":"","ucode":"CA183740FB5C9D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/fb/ffa57759.jpg","comment_is_top":false,"comment_ctime":1530286216,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"181918912648","product_id":100007101,"comment_content":"1. HTTPDNS 服务器的地址或者域名（和网站域名类似）一般不变，所以可以写死在SDK里；<br><br>2..为方便用户近源访问，使用CDN技术（content distribution network，内容分发网络）。<br><br><br>一点题外话：作者的每一期讲解都有好好学习，讲的都挺通俗易懂的，不过如果能加入一些相关的经典的参考链接，应该会更好，授人以鱼的同时也授人以渔。","like_count":42},{"had_liked":false,"id":40399,"user_name":"silence","can_delete":false,"product_type":"c1","uid":1199026,"ip_address":"","ucode":"22AF051009A1A7","user_header":"https://static001.geekbang.org/account/avatar/00/12/4b/b2/7f600f9e.jpg","comment_is_top":false,"comment_ctime":1542615036,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"117506732028","product_id":100007101,"comment_content":"之前在软件公司干活，有个大客户，有很多站点，但是他们原先的系统不支持调度。希望我们给他出个方案，做到智能调度。当时我出的方案是给他们搞一个类似 HTTPDNS 的系统。根据运营商、地理位置、站点负载进行调度。一次返回多个服务列表。让客户端进行缓存，定期更新。今天看了这个文章，在回想起当时我给他们做的方案，当时只做了服务器上的调度，客户端因为无法控制，当时没考虑进行改造，添加反馈。看了文章，看到还是有可以再优化的点的。","like_count":28},{"had_liked":false,"id":28001,"user_name":"quanbove","can_delete":false,"product_type":"c1","uid":1142051,"ip_address":"","ucode":"77E0A2F5F932C3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIu1n1DhUGGKS1obrPQicEHlhC7A5zuu6fCQVR4PNx06LNEgfITQqic9fRGYicI0TkFMQUfDAnR7YVLA/132","comment_is_top":false,"comment_ctime":1537974339,"is_pvip":false,"replies":[{"id":"10104","content":"谢谢指正","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1538009726,"ip_address":"","comment_id":28001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"83142352963","product_id":100007101,"comment_content":"HTTPNDS 其实就是，不走传统的 DNS 解析，而是自己搭建基于 HTTP 协议的 DNS 服务器集群，分布在多个地点和多个运营商。<br>发现一个笔误的地方，HTTPDNS，而不是HTTPNDS，我是又多无聊[捂脸]","like_count":19,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425110,"discussion_content":"谢谢指正","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538009726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14178,"user_name":"upstream","can_delete":false,"product_type":"c1","uid":1000385,"ip_address":"","ucode":"2B106D3D4D9F85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/c1/576c01a1.jpg","comment_is_top":false,"comment_ctime":1530230001,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"65954739441","product_id":100007101,"comment_content":"3.出口nat问题这段个人认为说的不准确。客户端的dns服务器指向一般都是一个运营商的localdns，不考虑edns的情况下，权威服务器拿到的是localdns地址。<br>如果递归dns支持edns，权威服务器能看到客户端出口nat地址。<br>只有像长城宽带这类流氓二道贩子，会把用户出口nat地址全国飘","like_count":15},{"had_liked":false,"id":18332,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1533259265,"is_pvip":true,"discussion_count":3,"race_medal":1,"score":"48777899521","product_id":100007101,"comment_content":"我想问的是:HttpDns服务器的域名地址簿，也是通过递归根域名，顶级域名，权威域名服务器获取的吗？","like_count":11,"discussions":[{"author":{"id":1268264,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5a/28/732d3f2f.jpg","nickname":"GEEKBANG_6638780","note":"","ucode":"952194E56FD8C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384369,"discussion_content":"自己的DNS服务器不需要递归查找啊，直接配置域名对应的IP就行了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626528966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2032840,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/04/c8/3c7af100.jpg","nickname":"Javatar","note":"","ucode":"E216645CDF632C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296865,"discussion_content":"这个取决于具体实现吧，反正做出来也只是给你们自己用。你们想设计成分层的也可以。不过个人感觉没必要。DNS分层设计主要解决域名太多不能放到一台机器上。也就是单点问题。一般公司域名都没多少吧，不分层多台机器感觉足够","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596691375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1196694,"avatar":"https://static001.geekbang.org/account/avatar/00/12/42/96/d4477372.jpg","nickname":"小宝","note":"","ucode":"43A2CDA06FF7CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281563,"discussion_content":"我理解可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591765606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":17574,"user_name":"摩诃不思议","can_delete":false,"product_type":"c1","uid":1132427,"ip_address":"","ucode":"2BC7CC50218C59","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/8b/a5dfb558.jpg","comment_is_top":false,"comment_ctime":1532755280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48777395536","product_id":100007101,"comment_content":"非计算机专业同学，学的比较慢，老师能送我一份网络协议知识图谱吗？","like_count":11},{"had_liked":false,"id":20973,"user_name":"公告-SRE运维实践","can_delete":false,"product_type":"c1","uid":1010344,"ip_address":"","ucode":"86F4E48AE1D9D8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","comment_is_top":false,"comment_ctime":1534846762,"is_pvip":false,"replies":[{"id":"7384","content":"httpdns需要自己的客户端","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1534895650,"ip_address":"","comment_id":20973,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31599617834","product_id":100007101,"comment_content":"这个文章看起来感觉httpdns能解决传统的dns问题，但是前提是有自己的客户端，这种要对业务进行全部改造。那么如果就是浏览器访问，有没有什么方案，在不使用cdn的情况下","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422476,"discussion_content":"httpdns需要自己的客户端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534895650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14308,"user_name":"Fisher","can_delete":false,"product_type":"c1","uid":1138887,"ip_address":"","ucode":"F3063BCEBC9F14","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/c7/a147b71b.jpg","comment_is_top":false,"comment_ctime":1530280935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27300084711","product_id":100007101,"comment_content":"最近几篇文章都很赞啊，这一篇讲清楚了为什么跨运营商速度会慢的原因，之前知道这个问题但是不知道答案，其次httpdns这个新技术第一次听说，赞一个","like_count":6},{"had_liked":false,"id":104194,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1560679333,"is_pvip":false,"replies":[{"id":"49034","content":"可以的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567582376,"ip_address":"","comment_id":104194,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18740548517","product_id":100007101,"comment_content":"HTTPDNS能支持HTTPS 不<br>","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454167,"discussion_content":"可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567582376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103589,"user_name":"送普选","can_delete":false,"product_type":"c1","uid":1220775,"ip_address":"","ucode":"AB2C98BB9C3A5D","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/a7/db7a7c50.jpg","comment_is_top":false,"comment_ctime":1560475239,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18740344423","product_id":100007101,"comment_content":"咨询一下httpdns如何获取权威dns上的IP地址？每次有客户端httpdns请求来了就查一下，还是每1秒定期轮询后缓存？谢谢","like_count":4,"discussions":[{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335508,"discussion_content":"dns服务地址一般不变，可以写死在客户端，也可以通过传统的dns服务进行域名解析找到，反正不会变，传统dns服务也是很有效的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608210029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101149,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1559727195,"is_pvip":false,"replies":[{"id":"37044","content":"买了课程的，最后一节都有","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1560255580,"ip_address":"","comment_id":101149,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18739596379","product_id":100007101,"comment_content":"非计算机专业同学，老师能送我一份网络协议知识图谱吗？<br>","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452822,"discussion_content":"买了课程的，最后一节都有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560255580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14739,"user_name":"凡凡","can_delete":false,"product_type":"c1","uid":1056142,"ip_address":"","ucode":"134C1E1E6B22BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/8e/0a546871.jpg","comment_is_top":false,"comment_ctime":1530625569,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18710494753","product_id":100007101,"comment_content":"1、可以是通过域名解析，也可以是直接配置所有httpdns服务器节点。阿里云采用的是配置ip列表的方式。2、cdn内容分发网络","like_count":4,"discussions":[{"author":{"id":1000007,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/47/1b83120d.jpg","nickname":"锟斤拷","note":"","ucode":"0F21566056D704","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1170,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562330275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77637,"user_name":"Marco","can_delete":false,"product_type":"c1","uid":1397516,"ip_address":"","ucode":"796A4B9D1DE55D","user_header":"https://static001.geekbang.org/account/avatar/00/15/53/0c/b4907516.jpg","comment_is_top":false,"comment_ctime":1552975937,"is_pvip":false,"replies":[{"id":"50236","content":"考虑，httpdns里面也可以配置负载均衡策略的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567827471,"ip_address":"","comment_id":77637,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14437877825","product_id":100007101,"comment_content":"那httpdns不需要考虑负载均衡么?","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443804,"discussion_content":"考虑，httpdns里面也可以配置负载均衡策略的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335504,"discussion_content":"httpdns服务器就可以负载均衡了，dns请求都来了，给它返回那台机器的ip还不是自己定 =v=","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608209525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67306,"user_name":"哈哈哈","can_delete":false,"product_type":"c1","uid":1397912,"ip_address":"","ucode":"81903089275B3D","user_header":"","comment_is_top":false,"comment_ctime":1550127565,"is_pvip":false,"replies":[{"id":"25980","content":"一般是多个数据中心分布式部署，适用于手机客户端的情况","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551440684,"ip_address":"","comment_id":67306,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14435029453","product_id":100007101,"comment_content":"请问老师：文中的在不同运营商或地区部署httpdns服务，根据客户端位置返回最优应用地址，httpdns服务端部署方式是如何的？如何达到不同运营商或地区效果？httpdns适用场景只有哪些呢？谢谢","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439138,"discussion_content":"一般是多个数据中心分布式部署，适用于手机客户端的情况","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551440684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335505,"discussion_content":"httpdns 有自己的客户端，就可以获取到用户的运营商和地区了， httpdns服务器再针对的返回对应运营商或者地区的服务器ip就行了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608209635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65716,"user_name":"克里斯","can_delete":false,"product_type":"c1","uid":1181844,"ip_address":"","ucode":"00B755C10AC1C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/94/2c22bd4e.jpg","comment_is_top":false,"comment_ctime":1549599479,"is_pvip":true,"replies":[{"id":"25964","content":"很少变","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551438733,"ip_address":"","comment_id":65716,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14434501367","product_id":100007101,"comment_content":"权威DNS服务器的ip地址不会变吗？","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438562,"discussion_content":"很少变","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551438733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64805,"user_name":"桃子妈妈","can_delete":false,"product_type":"c1","uid":1141504,"ip_address":"","ucode":"16E7D2FBAE452F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yy4cUibeUfPHPkXXZQnQwjXY7m5rXY5ib6a7pC1vkupj1icibF305N4pJSdqw0fO1ibvyfKCQ7HWggLhwiaNbbRPBsKg/132","comment_is_top":false,"comment_ctime":1548915703,"is_pvip":false,"replies":[{"id":"25957","content":"不会的，直接返回了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551438296,"ip_address":"","comment_id":64805,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14433817591","product_id":100007101,"comment_content":"老师好，很想了解HTTPDNS服务端仍然会使用递归的方式依次通过根域名、顶级域名、权威域名去递归查询吗？","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438186,"discussion_content":"不会的，直接返回了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551438296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335506,"discussion_content":"我理解的httpdns服务 其实就和普通的http服务没啥区别，无非就是拿到客户端的信息结合自己服务器地址做个分析和计算，然后返回给客户端计算所得的机器ip而已。所以名字才带个http呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608209743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85671,"user_name":"whats your name","can_delete":false,"product_type":"c1","uid":1226307,"ip_address":"","ucode":"6BD436B21D79D3","user_header":"https://static001.geekbang.org/account/avatar/00/12/b6/43/c23a38b2.jpg","comment_is_top":false,"comment_ctime":1555169451,"is_pvip":false,"replies":[{"id":"49694","content":"管理员配置，反正httpdns服务器也是你自己搭建的，如果你用公有云，他也让你配置的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567697783,"ip_address":"","comment_id":85671,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10145104043","product_id":100007101,"comment_content":"老师，有一个疑惑点：HTTPDNS的域名&#47;ip地址簿是从哪里来的呢？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446761,"discussion_content":"管理员配置，反正httpdns服务器也是你自己搭建的，如果你用公有云，他也让你配置的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567697783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84823,"user_name":"supermouse","can_delete":false,"product_type":"c1","uid":1321860,"ip_address":"","ucode":"88072D5F881827","user_header":"https://static001.geekbang.org/account/avatar/00/14/2b/84/07f0c0d6.jpg","comment_is_top":false,"comment_ctime":1554912669,"is_pvip":false,"replies":[{"id":"49738","content":"你可以自己搭建，也可以去公有云买","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567699051,"ip_address":"","comment_id":84823,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10144847261","product_id":100007101,"comment_content":"想问一下老师，HTTPDNS服务器集群是谁来搭建的？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446460,"discussion_content":"你可以自己搭建，也可以去公有云买","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567699051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":18308,"user_name":"Nicole","can_delete":false,"product_type":"c1","uid":1154755,"ip_address":"","ucode":"3C947870E210BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/9e/c3/c321541c.jpg","comment_is_top":false,"comment_ctime":1533255772,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10123190364","product_id":100007101,"comment_content":"1.写死在SDK中，支持DNS over HTTPS方案<br>2.CDN内容分发服务","like_count":2},{"had_liked":false,"id":278295,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1612860648,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5907827944","product_id":100007101,"comment_content":"为什么A运营商会偷懒，将请求转发给B运营商，有什么历史案例吗","like_count":1,"discussions":[{"author":{"id":1188280,"avatar":"https://static001.geekbang.org/account/avatar/00/12/21/b8/aca814dd.jpg","nickname":"江山如画","note":"","ucode":"BEB6228E6135B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410697,"discussion_content":"有些小运营商，为了节省资源，会把解析请求直接转发到其它运营商的 dns 上，导致用户访问变慢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635760114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206746,"user_name":"吴贤龙","can_delete":false,"product_type":"c1","uid":1220566,"ip_address":"","ucode":"45085FE86D6030","user_header":"https://static001.geekbang.org/account/avatar/00/12/9f/d6/f66133b4.jpg","comment_is_top":false,"comment_ctime":1586926936,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5881894232","product_id":100007101,"comment_content":"老师，要实现httpDNS，除了手机端，PC端怎么办呢？","like_count":1},{"had_liked":false,"id":176390,"user_name":"倡印","can_delete":false,"product_type":"c1","uid":1455958,"ip_address":"","ucode":"4F53AA5D017D89","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/56/11068390.jpg","comment_is_top":false,"comment_ctime":1581047282,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5876014578","product_id":100007101,"comment_content":"问个问题。移动端使用流量的时候使用HTTPDNS这好理解，但是移动端也可以接入家庭网络Wi-Fi家庭网络又是传统的DNS解析，这种情况下移动端还是会使用HTTPDNS来解析吗？？？？？？","like_count":1,"discussions":[{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335507,"discussion_content":"为什么不用httpdns呢  手机上的客户端是自己的，我让它走我的httpdns服务，跟手机所处的网络是什么有啥关系呢？ ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1608209950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123351,"user_name":"J.M.Liu","can_delete":false,"product_type":"c1","uid":1200037,"ip_address":"","ucode":"B2CB84B8E923A6","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/a5/71358d7b.jpg","comment_is_top":false,"comment_ctime":1565661016,"is_pvip":false,"replies":[{"id":"46304","content":"会提供配置界面的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566283277,"ip_address":"","comment_id":123351,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860628312","product_id":100007101,"comment_content":"老师，那httpdns服务器自己的地址簿，他怎么更新呢？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462632,"discussion_content":"会提供配置界面的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566283277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91310,"user_name":"程序员大天地","can_delete":false,"product_type":"c1","uid":1249001,"ip_address":"","ucode":"7A21F15FEE2D5B","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/e9/98b6ea61.jpg","comment_is_top":false,"comment_ctime":1556973821,"is_pvip":false,"replies":[{"id":"49485","content":"不用递归，其实就是普通的http服务器了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567675129,"ip_address":"","comment_id":91310,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5851941117","product_id":100007101,"comment_content":"第一次听说HTTPDNS，没有听懂。HTTPDNS服务器是如何部署的，服务器是如何知道域名的对应ip，难度它不用递归向权威DNS服务器查询吗？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448881,"discussion_content":"不用递归，其实就是普通的http服务器了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567675129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47917,"user_name":"若丶相依","can_delete":false,"product_type":"c1","uid":1325101,"ip_address":"","ucode":"6482339C859C40","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/2d/9c971119.jpg","comment_is_top":false,"comment_ctime":1544256363,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5839223659","product_id":100007101,"comment_content":"HTTPDNS 服务器的地址或者域名由传统DNS做第一次的解析，获取到HTTPDNS服务器地址后由HTTPDNS重新解析自己的地址为最优节点 ?","like_count":1},{"had_liked":false,"id":15787,"user_name":"破晓","can_delete":false,"product_type":"c1","uid":1153316,"ip_address":"","ucode":"13C33DE0CFD43B","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/24/e1cb609e.jpg","comment_is_top":false,"comment_ctime":1531490029,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5826457325","product_id":100007101,"comment_content":"1，写死域名<br>2，cdn","like_count":1},{"had_liked":false,"id":14556,"user_name":"云学","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":false,"comment_ctime":1530529583,"is_pvip":false,"replies":[{"id":"4917","content":"没有关系吧","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1530610255,"ip_address":"","comment_id":14556,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5825496879","product_id":100007101,"comment_content":"httpdns和反向代理有什么区别呢？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420048,"discussion_content":"没有关系吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530610255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1755152,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","nickname":"Info_E","note":"","ucode":"97207B2CC4C776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335509,"discussion_content":"一个作用主要是进行域名解析，一个主要作用是做一个中间层代理、保护后台服务，没啥关系吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608210135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14202,"user_name":"feifei","can_delete":false,"product_type":"c1","uid":1105431,"ip_address":"","ucode":"B1F8AE3AD82C51","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/17/75e2b624.jpg","comment_is_top":false,"comment_ctime":1530232990,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825200286","product_id":100007101,"comment_content":"使用 HTTPDNS，需要向 HTTPDNS 服务器请求解析域名，可是客户端怎么知道 HTTPDNS 服务器的地址或者域名呢？<br><br>我的理解是服务端会对外公布一个基于ip的服务，客户端固定从这个服务获取信息<br><br>HTTPDNS 的智能调度，主要是让客户端选择最近的服务器，而有另一种机制，使得资源分发到离客户端更近的位置，从而加快客户端的访问，你知道是什么技术吗？<br><br>比如一个跨地域的应用系统，存在北京，上海2个机房<br>可使用全局负载均衡来实现<br>可配置使用用户的ip来进行划分，比如某地址段访问北京机房，另外的访问上海机房<br>也可以感知用户的访问时间来进行负载均衡<br>需要按照业务特点来选择算法<br>","like_count":1},{"had_liked":false,"id":14200,"user_name":"肖飞码字","can_delete":false,"product_type":"c1","uid":1000696,"ip_address":"","ucode":"53D821F2F0F1DA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/44/f8/6fdb50ab.jpg","comment_is_top":false,"comment_ctime":1530232821,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825200117","product_id":100007101,"comment_content":"HTTPDNS这种只适用于手机app，对于电脑这种是没办法的吧？","like_count":1},{"had_liked":false,"id":14191,"user_name":"free","can_delete":false,"product_type":"c1","uid":1063817,"ip_address":"","ucode":"65F3F0ADD38D19","user_header":"","comment_is_top":false,"comment_ctime":1530231907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825199203","product_id":100007101,"comment_content":"配置ip<br>cdn","like_count":1},{"had_liked":false,"id":14189,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1112202,"ip_address":"","ucode":"8CA4CB2745A427","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/8a/07cdeaf9.jpg","comment_is_top":false,"comment_ctime":1530231802,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825199098","product_id":100007101,"comment_content":"域名选择方面，我改选择.cn的还是.com的？.cn的域名访问速度是不是比.com快？","like_count":1},{"had_liked":false,"id":345798,"user_name":"LIKE","can_delete":false,"product_type":"c1","uid":1254252,"ip_address":"","ucode":"9DAB7F9051648A","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/6c/82ba5e1f.jpg","comment_is_top":false,"comment_ctime":1652601506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652601506","product_id":100007101,"comment_content":"题外话集成第三方的HttpDNS一般是要收费的，老师好，关于httpDNS 在手机切换网络时（4g切换到wifi）一般是怎么处理的，会重新请求更新ip吗？","like_count":0},{"had_liked":false,"id":341636,"user_name":"半点茶凉","can_delete":false,"product_type":"c1","uid":2520742,"ip_address":"","ucode":"188BB33969D2D2","user_header":"https://static001.geekbang.org/account/avatar/00/26/76/a6/aac72751.jpg","comment_is_top":false,"comment_ctime":1649746043,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649746043","product_id":100007101,"comment_content":"httpdns很像微服务中注册中心的理论基础","like_count":0},{"had_liked":false,"id":335652,"user_name":"小黄鸭","can_delete":false,"product_type":"c1","uid":2708370,"ip_address":"","ucode":"2800E3A723AEBD","user_header":"https://static001.geekbang.org/account/avatar/00/29/53/92/21c78176.jpg","comment_is_top":false,"comment_ctime":1645614745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645614745","product_id":100007101,"comment_content":"不太明白，那HTTPDNS服务器里面的域名和ip映射关系，是从哪里来的？","like_count":0},{"had_liked":false,"id":317757,"user_name":"蝴蝶","can_delete":false,"product_type":"c1","uid":1193167,"ip_address":"","ucode":"8019924D99182F","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/cf/0a316b48.jpg","comment_is_top":false,"comment_ctime":1634946794,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1634946794","product_id":100007101,"comment_content":"1. 内置好地址如8.8.8.8 2.CDN","like_count":0},{"had_liked":false,"id":293294,"user_name":"奋斗","can_delete":false,"product_type":"c1","uid":2047392,"ip_address":"","ucode":"C84C2D030ACA51","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3d/a0/acf6b165.jpg","comment_is_top":false,"comment_ctime":1621325936,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621325936","product_id":100007101,"comment_content":"如果在阿里买一个域名，怎么同步到httpDNS","like_count":0},{"had_liked":false,"id":288509,"user_name":"红薯板栗","can_delete":false,"product_type":"c1","uid":2413071,"ip_address":"","ucode":"236BE91291A575","user_header":"https://static001.geekbang.org/account/avatar/00/24/d2/0f/8f14c85b.jpg","comment_is_top":false,"comment_ctime":1618497610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618497610","product_id":100007101,"comment_content":"传统dns，由于缓存，转发，nat，导致不可控，httpdns自己搭建类似dns服务，可以自由在调度，缓存，更新上控制。","like_count":0},{"had_liked":false,"id":285181,"user_name":"dog_brother","can_delete":false,"product_type":"c1","uid":1619597,"ip_address":"","ucode":"9F64D3C6D815FB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6OV33jHia3U9LYlZEx2HrpsELeh3KMlqFiaKpSAaaZeBttXRAVvDXUgcufpqJ60bJWGYGNpT7752w/132","comment_is_top":false,"comment_ctime":1616659174,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1616659174","product_id":100007101,"comment_content":"第一次接触HTTP DNS的概念，觉得跟服务发现要解决的问题很类似","like_count":0},{"had_liked":false,"id":282938,"user_name":"青冈","can_delete":false,"product_type":"c1","uid":1080446,"ip_address":"","ucode":"8E54B939937E6D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoYBX95GZxEdKz9LQJVwohUiaRxNge5WpHRbeOC2tGc2rsdpfYKCTKdQicBn8MvSrlZTX7HY2jS3YFA/132","comment_is_top":false,"comment_ctime":1615470249,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1615470249","product_id":100007101,"comment_content":"老师，iOS客户端有时做网络请求会有未能找到主机名的问题。这个就是dns导致的么？","like_count":0,"discussions":[{"author":{"id":1080446,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoYBX95GZxEdKz9LQJVwohUiaRxNge5WpHRbeOC2tGc2rsdpfYKCTKdQicBn8MvSrlZTX7HY2jS3YFA/132","nickname":"青冈","note":"","ucode":"8E54B939937E6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357366,"discussion_content":"有什么好的方法能解决吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615795103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257927,"user_name":"赛飞","can_delete":false,"product_type":"c1","uid":1372006,"ip_address":"","ucode":"189B7A3231B06C","user_header":"https://static001.geekbang.org/account/avatar/00/14/ef/66/dc3f4555.jpg","comment_is_top":false,"comment_ctime":1604216570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604216570","product_id":100007101,"comment_content":"听着想是只有在手机端安装SDK才能使用httpDNS，这个在PC端可以用吗？","like_count":0},{"had_liked":false,"id":247721,"user_name":"IMER","can_delete":false,"product_type":"c1","uid":1546993,"ip_address":"","ucode":"4F250DD48D18A0","user_header":"https://static001.geekbang.org/account/avatar/00/17/9a/f1/fac9924a.jpg","comment_is_top":false,"comment_ctime":1599806957,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599806957","product_id":100007101,"comment_content":"传统 DNS 存在哪些问题<br>只有 1 2 4 5，没有 3？","like_count":0},{"had_liked":false,"id":242997,"user_name":"郑祖煌","can_delete":false,"product_type":"c1","uid":1469608,"ip_address":"","ucode":"49A0D2E3279826","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/a8/1922a0f5.jpg","comment_is_top":false,"comment_ctime":1597914438,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597914438","product_id":100007101,"comment_content":"应该HttpDNS服务器是自己安装和使用的，所以可以自己把HttpDNS的地址写到配置中去。","like_count":0},{"had_liked":false,"id":241198,"user_name":"奥佛铎","can_delete":false,"product_type":"c1","uid":1234919,"ip_address":"","ucode":"A1D544E5F22B7F","user_header":"","comment_is_top":false,"comment_ctime":1597213222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597213222","product_id":100007101,"comment_content":"1不经常变化，所以可以作为一种配置文件写在客户端中<br>2 CDN","like_count":0},{"had_liked":false,"id":234971,"user_name":"连边","can_delete":false,"product_type":"c1","uid":1391748,"ip_address":"","ucode":"54B5DA38449728","user_header":"https://static001.geekbang.org/account/avatar/00/15/3c/84/608f679b.jpg","comment_is_top":false,"comment_ctime":1594861243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594861243","product_id":100007101,"comment_content":"HttpDNS域名配置hosts","like_count":0},{"had_liked":false,"id":223205,"user_name":"起风了001","can_delete":false,"product_type":"c1","uid":1529929,"ip_address":"","ucode":"8DCDBA40B8CC9F","user_header":"","comment_is_top":false,"comment_ctime":1591021475,"is_pvip":false,"replies":[{"id":"83035","content":"不懂比特币。。。","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591755700,"ip_address":"","comment_id":223205,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591021475","product_id":100007101,"comment_content":"httpdns的ip地址列表是真的可以直接写死在客户端的, 比特币的原始节点服务器的ip就是写死的代码里的, 人家还是玩得好好的.","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497055,"discussion_content":"不懂比特币。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591755700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215091,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1588902955,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588902955","product_id":100007101,"comment_content":"1.对于HttpDNS的获取,应该是类似着CA权威认证服务器一样,是直接写死在客户端里面的,方便直接调用<br>2.对于所使用的的技术,应该是CDN","like_count":0},{"had_liked":false,"id":207288,"user_name":"Lucky  Guy","can_delete":false,"product_type":"c1","uid":1202375,"ip_address":"","ucode":"44B4688D764475","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/c7/a65f5080.jpg","comment_is_top":false,"comment_ctime":1587042690,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587042690","product_id":100007101,"comment_content":"老师如果我的app现在已经使用了CDN做加速， 如果我再使用httpdns做解析的话，我需要在httpdns里面配置cname的解析记录。 httpdns也支持cname解析么？","like_count":0},{"had_liked":false,"id":204432,"user_name":"柳十三","can_delete":false,"product_type":"c1","uid":1385852,"ip_address":"","ucode":"FE50C9778914C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tKvmZ3Vs4t6RZ3X7cAliaW47Zatxhn1aV5PcCYT9NZ9k9WWqRrEBGHicGtRWvsG6yQqHnaWw6cGNSbicNLjZebcHA/132","comment_is_top":false,"comment_ctime":1586399257,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586399257","product_id":100007101,"comment_content":"1.客户端请求，内部做了个拦截，拦截后转发到httpdns<br>2.使用cdn","like_count":0},{"had_liked":false,"id":197014,"user_name":"Geek_f0bd6b","can_delete":false,"product_type":"c1","uid":1905495,"ip_address":"","ucode":"54C2BD14F77F72","user_header":"","comment_is_top":false,"comment_ctime":1585349461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585349461","product_id":100007101,"comment_content":"pc端如果也使用httpdns，就必须安装客户端了吧？","like_count":0},{"had_liked":false,"id":193718,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1584953939,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584953939","product_id":100007101,"comment_content":"平常接触到DNS，考虑的都是通过域名去解析出IP进行访问，没去思考传统DNS的一些缺点：解析慢、缓存不更新等问题。同时对于手机端去访问网站也是没有去关注的，文中提到的httpDNS来快速进行解析和访问的智能调度，这些优点也是传统DNS的进一步解决方案。不断拜读文章，也是不断丰富自己的知识面，当然其中知识点的很多细节，需要自己在接下来的岁月不断打磨和完善。","like_count":0},{"had_liked":false,"id":190964,"user_name":"25ma","can_delete":false,"product_type":"c1","uid":1303713,"ip_address":"","ucode":"AB5435B9DB52C9","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/a1/178387da.jpg","comment_is_top":false,"comment_ctime":1584713611,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584713611","product_id":100007101,"comment_content":"问题2，应该是大名鼎鼎的cdn网络资源分发","like_count":0},{"had_liked":false,"id":183822,"user_name":"yvanbu","can_delete":false,"product_type":"c1","uid":1474816,"ip_address":"","ucode":"49294808179081","user_header":"https://static001.geekbang.org/account/avatar/00/16/81/00/1df7bb5d.jpg","comment_is_top":false,"comment_ctime":1583140891,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583140891","product_id":100007101,"comment_content":"请教一个问题：如果需要使用 HTTPDNS 服务，除了使用 阿里云 和 腾讯云 提供好的服务之外，可以自己搭建HTTPDNS 服务吗，成本大不大，需要不同的国家不同运营商搭建吗","like_count":0},{"had_liked":false,"id":182166,"user_name":"肖小强","can_delete":false,"product_type":"c1","uid":1245065,"ip_address":"","ucode":"A929A8D1DAD3C4","user_header":"https://static001.geekbang.org/account/avatar/00/12/ff/89/32e3f682.jpg","comment_is_top":false,"comment_ctime":1582724199,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582724199","product_id":100007101,"comment_content":"DNS协议发出的解析请求也是基于http的吗？","like_count":0},{"had_liked":false,"id":176341,"user_name":"涤生","can_delete":false,"product_type":"c1","uid":1796720,"ip_address":"","ucode":"09084D994BEFA4","user_header":"","comment_is_top":false,"comment_ctime":1581039248,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581039248","product_id":100007101,"comment_content":"第一个问题，把httpdns域名写死在sdk中，那么这个域名服务器全国就只有这一台吗？假设httpdns的域名为A，移动用户在B省、C省，B和C都通过A来获取域名？","like_count":0},{"had_liked":false,"id":176339,"user_name":"涤生","can_delete":false,"product_type":"c1","uid":1796720,"ip_address":"","ucode":"09084D994BEFA4","user_header":"","comment_is_top":false,"comment_ctime":1581039056,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581039056","product_id":100007101,"comment_content":"httpdns它也是向本地域名服务器请求结果的，如果本地域名服务器没有，也得向上一级域名服务器请求呀！为嘛这个说可以直接搞定？","like_count":0},{"had_liked":false,"id":173075,"user_name":"小鸟淫太","can_delete":false,"product_type":"c1","uid":1247186,"ip_address":"","ucode":"AC44F552DDF93E","user_header":"https://static001.geekbang.org/account/avatar/00/13/07/d2/d7a200d5.jpg","comment_is_top":false,"comment_ctime":1579420740,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579420740","product_id":100007101,"comment_content":"我们公司做的私有DNS感觉和这个类似，但是只是配置一个IP地址对应一个域名，没这么复杂。。","like_count":0},{"had_liked":false,"id":166442,"user_name":"哇哈哈","can_delete":false,"product_type":"c1","uid":1175537,"ip_address":"","ucode":"47453D1C96A1DD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/f1/8b06801a.jpg","comment_is_top":false,"comment_ctime":1577449142,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577449142","product_id":100007101,"comment_content":"刘超老师，最近对云计算感兴趣，有没有入门科普类的书推荐一下","like_count":0},{"had_liked":false,"id":162643,"user_name":"DFighting","can_delete":false,"product_type":"c1","uid":1233193,"ip_address":"","ucode":"F3BA2426FF8582","user_header":"https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg","comment_is_top":false,"comment_ctime":1576571714,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1576571714","product_id":100007101,"comment_content":"1、httpdns服务器一般不需要太多的变化，所以可以考虑定死为某个IP;如果需要考虑容灾和负载均衡，可以将httpdns注册到zk中，以一种服务的方式提供调度和多活<br>2、cdn","like_count":0},{"had_liked":false,"id":157974,"user_name":"饭粒","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1575291944,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575291944","product_id":100007101,"comment_content":"“同步更新的优点是实时性好，缺点是如果有多个请求都发现过期的时候，同时会请求 HTTPDNS 多次，其实是一种浪费。”<br>老师，请问下，这里的多个请求都发现过期是什么意思？感觉做了 HTTPDNS 的应该是特定的应用，需要通过 HTTPDNS 解析的域名也不会太多，而且一般手机客户端一次发起的请求也不会太多吧。","like_count":0},{"had_liked":false,"id":115905,"user_name":"陈泽坛","can_delete":false,"product_type":"c1","uid":1394861,"ip_address":"","ucode":"C81B402868E9E2","user_header":"https://static001.geekbang.org/account/avatar/00/15/48/ad/8be724da.jpg","comment_is_top":false,"comment_ctime":1563765141,"is_pvip":false,"replies":[{"id":"46538","content":"是的，但是公有云有这种服务的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566354973,"ip_address":"","comment_id":115905,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563765141","product_id":100007101,"comment_content":"httpdns自己的dns服务器  成本好高吧？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459341,"discussion_content":"是的，但是公有云有这种服务的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566354973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106485,"user_name":"天王","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1561334447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561334447","product_id":100007101,"comment_content":"HTTPDNS，DNS是网络地址的地址簿，给一个域名，找到对应服务器的ip地址，也可以用DNS在多台服务器之间做负载均衡。1DNS也有一些问题，1 .1域名缓存问题，DNS解析的过程，首先运营商去本地DNS缓存服务器去看有没有，没有去DNS树去一级级的查找，如果缓存的地址或者资源文件变了，访问会出错 或者是过期的文件，另外DNS缓存缓存的地址，会使就近原则的负载均衡失效。1.2域名转发问题 很多网络运营商会把请求导到其他运营商，DNS服务器会认为是转发之后的运营商，给的ip也是转发以后运营商的ip，跨运营商会比较慢 1.3 ip地址转换问题 很多机房出口ip会进行转换成新ip，DNS服务器会识别出错误的运营商网络，跨网络请求会比较慢1.4 域名更新问题    域名解析策略，不同的地区，不同的运营商都有差异，但有时候需要新解析立刻生效，比如容错的双机房的一个机房出故障，需要全部解析到第二个机房。1.5 解析延迟问题。 2 2.1 HTTPDNS解析是自己搭建DNS解析服务器集群，分布在不同的地区和不同的运营商，域名走自己的解析，不走运营商的，绕过传统的DNS解析，需要客户端安装支持HTTPDNS的sdk。2.2 HTTPDNS的缓存策略 首先去访问HTTPDNS服务器，获取到ip列表，缓存在手机客户端本地，请求的时候，如果发现本地有，直接从本地获取，没有去httpdns服务器获取，因为手机客户端肯定知道在哪个地区和哪个运营商，选择最优的，更新缓存策略可以自己制定。","like_count":0},{"had_liked":false,"id":101178,"user_name":"cheetah","can_delete":false,"product_type":"c1","uid":1482596,"ip_address":"","ucode":"76D54EF2053B5E","user_header":"https://static001.geekbang.org/account/avatar/00/16/9f/64/a0a0904d.jpg","comment_is_top":false,"comment_ctime":1559735240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559735240","product_id":100007101,"comment_content":"1、域名写死<br>2、CDN<br><br>HTTPDNS的自己的数据也是递归获取到的吗，从根域名到顶级域名再到权威域名","like_count":0},{"had_liked":false,"id":101150,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1559727432,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559727432","product_id":100007101,"comment_content":"1    httpdns服务器的IP地址是不变的，可 从DNS服务器查到 。<br>2    CDN(content  distribution  network   内容分发网络)","like_count":0},{"had_liked":false,"id":88224,"user_name":"古夜","can_delete":false,"product_type":"c1","uid":1341612,"ip_address":"","ucode":"0A82D3CFCEDF07","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","comment_is_top":false,"comment_ctime":1555896011,"is_pvip":false,"replies":[{"id":"49573","content":"好多劫持的方法，dns劫持是一种方式","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567689109,"ip_address":"","comment_id":88224,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555896011","product_id":100007101,"comment_content":"有人知道网页劫持是咋回事吗","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447772,"discussion_content":"好多劫持的方法，dns劫持是一种方式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567689109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82532,"user_name":"超超","can_delete":false,"product_type":"c1","uid":1476077,"ip_address":"","ucode":"D0751F29553481","user_header":"https://static001.geekbang.org/account/avatar/00/16/85/ed/905b052f.jpg","comment_is_top":false,"comment_ctime":1554249418,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554249418","product_id":100007101,"comment_content":"答问题1：在客户端SDK中配置HTTPSDNS的域名","like_count":0},{"had_liked":false,"id":67327,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1550130041,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1550130041","product_id":100007101,"comment_content":"域名缓存问题的那段的配图有点问题，游客的位置放在灵隐寺，更好吧？","like_count":0},{"had_liked":false,"id":54668,"user_name":"空知","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1545928223,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545928223","product_id":100007101,"comment_content":"分维度那个,不能直接用IP,因为IP可能是私网的,不一定准确,还是得用WIFI的SSID来区分","like_count":0},{"had_liked":false,"id":33113,"user_name":"半城","can_delete":false,"product_type":"c1","uid":1228812,"ip_address":"","ucode":"056C084A558B88","user_header":"https://static001.geekbang.org/account/avatar/00/12/c0/0c/c978bd7c.jpg","comment_is_top":false,"comment_ctime":1539745798,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539745798","product_id":100007101,"comment_content":"通过httpdns建立一个本地地址簿，问题是这个地址簿的内容是怎么获取到的呢？","like_count":0},{"had_liked":false,"id":17399,"user_name":"Yesterday","can_delete":false,"product_type":"c1","uid":1010409,"ip_address":"","ucode":"6A416B7906C1E0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/e9/d76511d8.jpg","comment_is_top":false,"comment_ctime":1532614763,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532614763","product_id":100007101,"comment_content":"如何解决 httpdns 访问 https 的问题？因为 https 会做 hostname 检验，而使用 httpdns 之后是直接访问的服务器 ip, 导致检验失败。<br><br>一些客户端，比如 apache http client 可以重写域名检验部分的代码，但是很多库不会保留修改的接口。grpc 的我就没找到。","like_count":0},{"had_liked":false,"id":15074,"user_name":"shanshan","can_delete":false,"product_type":"c1","uid":1022191,"ip_address":"","ucode":"F0BA8E2049F551","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/ef/bf392cc0.jpg","comment_is_top":false,"comment_ctime":1530843862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530843862","product_id":100007101,"comment_content":"苹果手机APP有时候会提示 “找不到主机名称”（a server with the specified hostname could not be found） 这个是DNS Pollution 导致的吗，<br>网上有人说 “这是苹果手机的问题， DNS过期了，它不能及时更新，系统又不使用过期的，所以就不能联系上服务器了 我觉得iPhone可能为了省流量或者是电，所以是有个间隔”统一更新DNS缓存，而我们域名默认的过期时间小于“统一更新时间 ，这时候问题就发生了” 但是这个DNS缓存不是在运营商那里吗，那导致这个问题的原因什么,希望老师能指点一下。","like_count":0},{"had_liked":false,"id":14521,"user_name":"颇忒妥","can_delete":false,"product_type":"c1","uid":1026448,"ip_address":"","ucode":"AA86AD1049BC2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a9/90/0c5ed3d9.jpg","comment_is_top":false,"comment_ctime":1530506052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530506052","product_id":100007101,"comment_content":"这么看来httpdns 和spring cloud 的client side load balance 有异曲同工之妙","like_count":0},{"had_liked":false,"id":14496,"user_name":"曹源","can_delete":false,"product_type":"c1","uid":1042459,"ip_address":"","ucode":"A0A982159FF758","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/1b/9d1c6077.jpg","comment_is_top":false,"comment_ctime":1530494678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530494678","product_id":100007101,"comment_content":"1，可以在sdk中写死，或者用传统dns解析","like_count":0},{"had_liked":false,"id":14427,"user_name":"悟空聊架构","can_delete":false,"product_type":"c1","uid":1123163,"ip_address":"","ucode":"C2F482A0CF8AF1","user_header":"https://static001.geekbang.org/account/avatar/00/11/23/5b/983408b9.jpg","comment_is_top":false,"comment_ctime":1530425561,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530425561","product_id":100007101,"comment_content":"第二个问题：CDN","like_count":0},{"had_liked":false,"id":14419,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1530417644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530417644","product_id":100007101,"comment_content":"Httpdns的地址一般不变，所以可以配置在客户端。第二个问题说的是cdn技术","like_count":0},{"had_liked":false,"id":14300,"user_name":"aha","can_delete":false,"product_type":"c1","uid":1134332,"ip_address":"","ucode":"4EFE5FE77AA6AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/fc/a10213cf.jpg","comment_is_top":false,"comment_ctime":1530276557,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530276557","product_id":100007101,"comment_content":"sdk可以内置IP或者域名<br>cdn","like_count":0},{"had_liked":false,"id":14229,"user_name":"khooh","can_delete":false,"product_type":"c1","uid":1134820,"ip_address":"","ucode":"161C6B715055DB","user_header":"","comment_is_top":false,"comment_ctime":1530236349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530236349","product_id":100007101,"comment_content":"第二个是CDN，内容分发网络","like_count":0},{"had_liked":false,"id":14226,"user_name":"张磊","can_delete":false,"product_type":"c1","uid":1130931,"ip_address":"","ucode":"196CC3C2C27462","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/b3/3ba14f9d.jpg","comment_is_top":false,"comment_ctime":1530235853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530235853","product_id":100007101,"comment_content":"问题一: 客户端如果要通过httpdns域名解析，应该通过编码的方式，指向httpdns服务器。或使用三方的httpdns的sdk。使用提供的api请求得到所访问域名的ip地址。缓存在客户端。<br>","like_count":0},{"had_liked":false,"id":14223,"user_name":"oddrock","can_delete":false,"product_type":"c1","uid":1037506,"ip_address":"","ucode":"55BADA192250B0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d4/c2/910d231e.jpg","comment_is_top":false,"comment_ctime":1530235376,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"1530235376","product_id":100007101,"comment_content":"请教老师几个问题：\r<br>1、为什么客户端要根据不同的移动网络运营商 WIFI 的 SSID 来分维度缓存，这个根据客户端发起请求的IP地址不就可以区分了吗？\r<br>2、DNS是基于什么协议的？TCP吗？","like_count":0,"discussions":[{"author":{"id":1000018,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/52/19553613.jpg","nickname":"刘培培","note":"","ucode":"77D1914E50E7E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6573,"discussion_content":"默认 UDP，但是 DNS 服务返回数据报太大的话有可能会走 TCP。 具体参考：https://en.wikipedia.org/wiki/Domain_Name_System#DNS_protocol_transport","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566980991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188280,"avatar":"https://static001.geekbang.org/account/avatar/00/12/21/b8/aca814dd.jpg","nickname":"江山如画","note":"","ucode":"BEB6228E6135B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410673,"discussion_content":"同一个网络，不同时间接入，分配的 ip 可能会发生变化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635756602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}