{"id":7154,"title":"12 | 实验一扩展环节","content":"无","comments":[{"had_liked":false,"id":9506,"user_name":"鲁云飞","can_delete":false,"product_type":"c3","uid":1125649,"ip_address":"","ucode":"539FCF30F68B3E","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/11/870c1c70.jpg","comment_is_top":false,"comment_ctime":1526919261,"is_pvip":false,"replies":[{"id":3052,"content":"如果没有领域经验，或者没有专家指导，则一般没有特别的捷径，老老实实调研，刚开始要收集各种渠道资料进行学习，做demo，根据你的经验，一般要花费些时间的，然后是小规模生产试点，根据用户反馈不断优化调整。随着你对问题域理解的不断深入，你对要引入什么功能会越来越有把握。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1527163382,"ip_address":"","comment_id":9506,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"想请教老师一个问题：通常我们借助于官方文档或者技术博客，来引入某功能，希望老师能够分享一下自己的经验，如何正规地引入自己想要的功能（通常技术博客比较杂乱，还有版本问题；而官方文档又比较简要，无针对性）","like_count":4,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418091,"discussion_content":"如果没有领域经验，或者没有专家指导，则一般没有特别的捷径，老老实实调研，刚开始要收集各种渠道资料进行学习，做demo，根据你的经验，一般要花费些时间的，然后是小规模生产试点，根据用户反馈不断优化调整。随着你对问题域理解的不断深入，你对要引入什么功能会越来越有把握。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527163382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117033,"user_name":"乐凡","can_delete":false,"product_type":"c3","uid":1239260,"ip_address":"","ucode":"918C9997EB6537","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/dc/32e78f02.jpg","comment_is_top":false,"comment_ctime":1563957660,"is_pvip":false,"replies":[{"id":42821,"content":"这个错误是提示：使用refresh_token刷新令牌，需要clientId&#47;secret认证，你看看相关信息是否正确填写，看看HTTP请求头Authorization: Basic是否有？","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1563973034,"ip_address":"","comment_id":117033,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，我基于密码模式使用了refresh_token，在OAuth2AuthorizationServer类中增加了 .accessTokenValiditySeconds((int)TimeUnit.SECONDS.toSeconds(30))\n                .refreshTokenValiditySeconds((int)TimeUnit.SECONDS.toSeconds(100));第一次获取access_token时refresh_token是一起返回的，\n{\n    &quot;access_token&quot;: &quot;435a1b63-e6d2-452d-84fb-339b12ce424f&quot;,\n    &quot;token_type&quot;: &quot;bearer&quot;,\n    &quot;refresh_token&quot;: &quot;177605ef-90cd-4fa6-b514-13c600b2bbca&quot;,\n    &quot;expires_in&quot;: 29,\n    &quot;scope&quot;: &quot;read_userinfo read_contacts&quot;\n}；但是我使用refresh_token刷新令牌一直不成功，\n{\n    &quot;timestamp&quot;: 1563957426377,\n    &quot;status&quot;: 401,\n    &quot;error&quot;: &quot;Unauthorized&quot;,\n    &quot;message&quot;: &quot;Full authentication is required to access this resource&quot;,\n    &quot;path&quot;: &quot;&#47;oauth&#47;token&quot;\n}\n希望老师能帮我解答。","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459787,"discussion_content":"这个错误是提示：使用refresh_token刷新令牌，需要clientId/secret认证，你看看相关信息是否正确填写，看看HTTP请求头Authorization: Basic是否有？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563973034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175961,"user_name":"陈天柱","can_delete":false,"product_type":"c3","uid":1696225,"ip_address":"","ucode":"917BFDC845760D","user_header":"https://static001.geekbang.org/account/avatar/00/19/e1/e1/441df85d.jpg","comment_is_top":false,"comment_ctime":1580893279,"is_pvip":false,"replies":[{"id":68458,"content":"根据需要，refreshToken也可以设置过期时间(这个过期时间肯定要比accessToken的过期时间长)，如果refreshToken超过过期时间，可以重走登录授权流程。\n\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1580984269,"ip_address":"","comment_id":175961,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师您好，有一个问题需要请教一下，token端点拿到了accessToken, 还有expireTime, expireTime过期后，accessToken也过期了，这个时候去调用refreshToken端点拿到新的accessToken，那我的理解是第一次需要授权信息相关，比如在登录接口做，后续访问受保护的接口时带上accessToken, 如果过期，前端调用refreshToken拿到新的accessToken, 那这不就意味着前端登录一次，拿到token以后，就可以无限刷新token，会有安全性问题吗？ 我们有地方可以去设置refreshToken的有效期，或者是可以设置一个总授权有效期，期间可以刷新token， 过期后需要重新走一下整体授权流程？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482972,"discussion_content":"根据需要，refreshToken也可以设置过期时间(这个过期时间肯定要比accessToken的过期时间长)，如果refreshToken超过过期时间，可以重走登录授权流程。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580984269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36662,"user_name":"天敌","can_delete":false,"product_type":"c3","uid":1059944,"ip_address":"","ucode":"CD29A622197197","user_header":"https://static001.geekbang.org/account/avatar/00/10/2c/68/c299bc71.jpg","comment_is_top":false,"comment_ctime":1541223773,"is_pvip":false,"replies":[{"id":13173,"content":"课程的最后（一般是最后一节）有相关参考资源介绍","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1541423296,"ip_address":"","comment_id":36662,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，有没有相关的资料可以参考一下？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427961,"discussion_content":"课程的最后（一般是最后一节）有相关参考资源介绍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541423296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}