{"id":41350,"title":"26 | sync.Mutexä¸sync.RWMutex","content":"<p>æˆ‘åœ¨å‰é¢ç”¨20å¤šç¯‡æ–‡ç« ï¼Œä¸ºä½ è¯¦ç»†åœ°å‰–æäº†Goè¯­è¨€æœ¬èº«çš„ä¸€äº›ä¸œè¥¿ï¼Œè¿™åŒ…æ‹¬äº†åŸºç¡€æ¦‚å¿µã€é‡è¦è¯­æ³•ã€é«˜çº§æ•°æ®ç±»å‹ã€ç‰¹è‰²è¯­å¥ã€æµ‹è¯•æ–¹æ¡ˆç­‰ç­‰ã€‚</p><p>è¿™äº›éƒ½æ˜¯Goè¯­è¨€ä¸ºæˆ‘ä»¬æä¾›çš„æœ€æ ¸å¿ƒçš„æŠ€æœ¯ã€‚æˆ‘æƒ³ï¼Œè¿™å·²ç»è¶³å¤Ÿè®©ä½ å¯¹Goè¯­è¨€æœ‰ä¸€ä¸ªæ¯”è¾ƒæ·±åˆ»çš„ç†è§£äº†ã€‚</p><p>ä»æœ¬ç¯‡æ–‡ç« å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ¢è®¨Goè¯­è¨€è‡ªå¸¦æ ‡å‡†åº“ä¸­ä¸€äº›æ¯”è¾ƒæ ¸å¿ƒçš„ä»£ç åŒ…ã€‚è¿™ä¼šæ¶‰åŠè¿™äº›ä»£ç åŒ…çš„æ ‡å‡†ç”¨æ³•ã€ä½¿ç”¨ç¦å¿Œã€èƒŒååŸç†ä»¥åŠå‘¨è¾¹çš„çŸ¥è¯†ã€‚</p><hr></hr><p>æ—¢ç„¶Goè¯­è¨€æ˜¯ä»¥ç‹¬ç‰¹çš„å¹¶å‘ç¼–ç¨‹æ¨¡å‹å‚²è§†ç¾¤é›„çš„è¯­è¨€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆæ¥å­¦ä¹ ä¸å¹¶å‘ç¼–ç¨‹å…³ç³»æœ€ç´§å¯†çš„ä»£ç åŒ…ã€‚</p><h2>å‰å¯¼å†…å®¹ï¼š ç«æ€æ¡ä»¶ã€ä¸´ç•ŒåŒºä¸åŒæ­¥å·¥å…·</h2><p>æˆ‘ä»¬é¦–å…ˆè¦çœ‹çš„å°±æ˜¯<code>sync</code>åŒ…ã€‚è¿™é‡Œçš„â€œsyncâ€çš„ä¸­æ–‡æ„æ€æ˜¯â€œåŒæ­¥â€ã€‚æˆ‘ä»¬ä¸‹é¢å°±ä»åŒæ­¥è®²èµ·ã€‚</p><p>ç›¸æ¯”äºGoè¯­è¨€å®£æ‰¬çš„â€œç”¨é€šè®¯çš„æ–¹å¼å…±äº«æ•°æ®â€ï¼Œé€šè¿‡å…±äº«æ•°æ®çš„æ–¹å¼æ¥ä¼ é€’ä¿¡æ¯å’Œåè°ƒçº¿ç¨‹è¿è¡Œçš„åšæ³•å…¶å®æ›´åŠ ä¸»æµï¼Œæ¯•ç«Ÿå¤§å¤šæ•°çš„ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½æ˜¯ç”¨åä¸€ç§æ–¹å¼ä½œä¸ºå¹¶å‘ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆçš„ï¼ˆè¿™ç§æ–¹æ¡ˆçš„å†å²éå¸¸æ‚ ä¹…ï¼Œææ€•å¯ä»¥è¿½æº¯åˆ°ä¸Šä¸ªä¸–çºªå¤šè¿›ç¨‹ç¼–ç¨‹æ—¶ä»£ä¼Šå§‹äº†ï¼‰ã€‚</p><p>ä¸€æ—¦æ•°æ®è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œé‚£ä¹ˆå°±å¾ˆå¯èƒ½ä¼šäº§ç”Ÿäº‰ç”¨å’Œå†²çªçš„æƒ…å†µã€‚è¿™ç§æƒ…å†µä¹Ÿè¢«ç§°ä¸º<strong>ç«æ€æ¡ä»¶ï¼ˆrace conditionï¼‰</strong>ï¼Œè¿™å¾€å¾€ä¼šç ´åå…±äº«æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p>å…±äº«æ•°æ®çš„ä¸€è‡´æ€§ä»£è¡¨ç€æŸç§çº¦å®šï¼Œå³ï¼šå¤šä¸ªçº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„æ“ä½œæ€»æ˜¯å¯ä»¥è¾¾åˆ°å®ƒä»¬å„è‡ªé¢„æœŸçš„æ•ˆæœã€‚</p><!-- [[[read_end]]] --><p>å¦‚æœè¿™ä¸ªä¸€è‡´æ€§å¾—ä¸åˆ°ä¿è¯ï¼Œé‚£ä¹ˆå°†ä¼šå½±å“åˆ°ä¸€äº›çº¿ç¨‹ä¸­ä»£ç å’Œæµç¨‹çš„æ­£ç¡®æ‰§è¡Œï¼Œç”šè‡³ä¼šé€ æˆæŸç§ä¸å¯é¢„çŸ¥çš„é”™è¯¯ã€‚è¿™ç§é”™è¯¯ä¸€èˆ¬éƒ½å¾ˆéš¾å‘ç°å’Œå®šä½ï¼Œæ’æŸ¥èµ·æ¥çš„æˆæœ¬ä¹Ÿæ˜¯éå¸¸é«˜çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦å°½é‡é¿å…ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼ŒåŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹è¿ç»­å‘åŒä¸€ä¸ªç¼“å†²åŒºå†™å…¥æ•°æ®å—ï¼Œå¦‚æœæ²¡æœ‰ä¸€ä¸ªæœºåˆ¶å»åè°ƒè¿™äº›çº¿ç¨‹çš„å†™å…¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆè¢«å†™å…¥çš„æ•°æ®å—å°±å¾ˆå¯èƒ½ä¼šå‡ºç°é”™ä¹±ã€‚æ¯”å¦‚ï¼Œåœ¨çº¿ç¨‹Aè¿˜æ²¡æœ‰å†™å®Œä¸€ä¸ªæ•°æ®å—çš„æ—¶å€™ï¼Œçº¿ç¨‹Bå°±å¼€å§‹å†™å…¥å¦å¤–ä¸€ä¸ªæ•°æ®å—äº†ã€‚</p><p>æ˜¾ç„¶ï¼Œè¿™ä¸¤ä¸ªæ•°æ®å—ä¸­çš„æ•°æ®ä¼šè¢«æ··åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”å·²ç»å¾ˆéš¾åˆ†æ¸…äº†ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦é‡‡å–ä¸€äº›æªæ–½æ¥åè°ƒå®ƒä»¬å¯¹ç¼“å†²åŒºçš„ä¿®æ”¹ã€‚è¿™é€šå¸¸å°±ä¼šæ¶‰åŠåŒæ­¥ã€‚</p><p>æ¦‚æ‹¬æ¥è®²ï¼Œ<strong>åŒæ­¥çš„ç”¨é€”æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯é¿å…å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»æ“ä½œåŒä¸€ä¸ªæ•°æ®å—ï¼Œå¦ä¸€ä¸ªæ˜¯åè°ƒå¤šä¸ªçº¿ç¨‹ï¼Œä»¥é¿å…å®ƒä»¬åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡ŒåŒä¸€ä¸ªä»£ç å—ã€‚</strong></p><p>ç”±äºè¿™æ ·çš„æ•°æ®å—å’Œä»£ç å—çš„èƒŒåéƒ½éšå«ç€ä¸€ç§æˆ–å¤šç§èµ„æºï¼ˆæ¯”å¦‚å­˜å‚¨èµ„æºã€è®¡ç®—èµ„æºã€I/Oèµ„æºã€ç½‘ç»œèµ„æºç­‰ç­‰ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬çœ‹åšæ˜¯å…±äº«èµ„æºï¼Œæˆ–è€…è¯´å…±äº«èµ„æºçš„ä»£è¡¨ã€‚æˆ‘ä»¬æ‰€è¯´çš„åŒæ­¥å…¶å®å°±æ˜¯åœ¨æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚</p><p>ä¸€ä¸ªçº¿ç¨‹åœ¨æƒ³è¦è®¿é—®æŸä¸€ä¸ªå…±äº«èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦å…ˆç”³è¯·å¯¹è¯¥èµ„æºçš„è®¿é—®æƒé™ï¼Œå¹¶ä¸”åªæœ‰åœ¨ç”³è¯·æˆåŠŸä¹‹åï¼Œè®¿é—®æ‰èƒ½çœŸæ­£å¼€å§‹ã€‚</p><p>è€Œå½“çº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ç»“æŸæ—¶ï¼Œå®ƒè¿˜å¿…é¡»å½’è¿˜å¯¹è¯¥èµ„æºçš„è®¿é—®æƒé™ï¼Œè‹¥è¦å†æ¬¡è®¿é—®ä»éœ€ç”³è¯·ã€‚</p><p>ä½ å¯ä»¥æŠŠè¿™é‡Œæ‰€è¯´çš„è®¿é—®æƒé™æƒ³è±¡æˆä¸€å—ä»¤ç‰Œï¼Œçº¿ç¨‹ä¸€æ—¦æ‹¿åˆ°äº†ä»¤ç‰Œï¼Œå°±å¯ä»¥è¿›å…¥æŒ‡å®šçš„åŒºåŸŸï¼Œä»è€Œè®¿é—®åˆ°èµ„æºï¼Œè€Œä¸€æ—¦çº¿ç¨‹è¦ç¦»å¼€è¿™ä¸ªåŒºåŸŸäº†ï¼Œå°±éœ€è¦æŠŠä»¤ç‰Œè¿˜å›å»ï¼Œç»ä¸èƒ½æŠŠä»¤ç‰Œå¸¦èµ°ã€‚</p><p>å¦‚æœé’ˆå¯¹æŸä¸ªå…±äº«èµ„æºçš„è®¿é—®ä»¤ç‰Œåªæœ‰ä¸€å—ï¼Œé‚£ä¹ˆåœ¨åŒä¸€æ—¶åˆ»ï¼Œå°±æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åˆ°é‚£ä¸ªåŒºåŸŸï¼Œå¹¶è®¿é—®åˆ°è¯¥èµ„æºã€‚</p><p>è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œå¤šä¸ªå¹¶å‘è¿è¡Œçš„çº¿ç¨‹å¯¹è¿™ä¸ªå…±äº«èµ„æºçš„è®¿é—®æ˜¯å®Œå…¨ä¸²è¡Œçš„ã€‚åªè¦ä¸€ä¸ªä»£ç ç‰‡æ®µéœ€è¦å®ç°å¯¹å…±äº«èµ„æºçš„ä¸²è¡ŒåŒ–è®¿é—®ï¼Œå°±å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªä¸´ç•ŒåŒºï¼ˆcritical sectionï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘åˆšåˆšè¯´çš„ï¼Œç”±äºè¦è®¿é—®åˆ°èµ„æºè€Œå¿…é¡»è¿›å…¥çš„é‚£ä¸ªåŒºåŸŸã€‚</p><p>æ¯”å¦‚ï¼Œåœ¨æˆ‘å‰é¢ä¸¾çš„é‚£ä¸ªä¾‹å­ä¸­ï¼Œå®ç°äº†æ•°æ®å—å†™å…¥æ“ä½œçš„ä»£ç å°±å…±åŒç»„æˆäº†ä¸€ä¸ªä¸´ç•ŒåŒºã€‚å¦‚æœé’ˆå¯¹åŒä¸€ä¸ªå…±äº«èµ„æºï¼Œè¿™æ ·çš„ä»£ç ç‰‡æ®µæœ‰å¤šä¸ªï¼Œé‚£ä¹ˆå®ƒä»¬å°±å¯ä»¥è¢«ç§°ä¸ºç›¸å…³ä¸´ç•ŒåŒºã€‚</p><p>å®ƒä»¬å¯ä»¥æ˜¯ä¸€ä¸ªå†…å«äº†å…±äº«æ•°æ®çš„ç»“æ„ä½“åŠå…¶æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯æ“ä½œåŒä¸€å—å…±äº«æ•°æ®çš„å¤šä¸ªå‡½æ•°ã€‚ä¸´ç•ŒåŒºæ€»æ˜¯éœ€è¦å—åˆ°ä¿æŠ¤çš„ï¼Œå¦åˆ™å°±ä¼šäº§ç”Ÿç«æ€æ¡ä»¶ã€‚<strong>æ–½åŠ ä¿æŠ¤çš„é‡è¦æ‰‹æ®µä¹‹ä¸€ï¼Œå°±æ˜¯ä½¿ç”¨å®ç°äº†æŸç§åŒæ­¥æœºåˆ¶çš„å·¥å…·ï¼Œä¹Ÿç§°ä¸ºåŒæ­¥å·¥å…·ã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/73/6c/73d3313640e62bb95855d40c988c2e6c.png?wh=1145*618\" alt=\"\"></p><p>ï¼ˆç«æ€æ¡ä»¶ã€ä¸´ç•ŒåŒºä¸åŒæ­¥å·¥å…·ï¼‰</p><p><strong>åœ¨Goè¯­è¨€ä¸­ï¼Œå¯ä¾›æˆ‘ä»¬é€‰æ‹©çš„åŒæ­¥å·¥å…·å¹¶ä¸å°‘ã€‚å…¶ä¸­ï¼Œæœ€é‡è¦ä¸”æœ€å¸¸ç”¨çš„åŒæ­¥å·¥å…·å½“å±äº’æ–¥é‡ï¼ˆmutual exclusionï¼Œç®€ç§°mutexï¼‰ã€‚</strong><code>sync</code>åŒ…ä¸­çš„<code>Mutex</code>å°±æ˜¯ä¸å…¶å¯¹åº”çš„ç±»å‹ï¼Œè¯¥ç±»å‹çš„å€¼å¯ä»¥è¢«ç§°ä¸ºäº’æ–¥é‡æˆ–è€…äº’æ–¥é”ã€‚</p><p>ä¸€ä¸ªäº’æ–¥é”å¯ä»¥è¢«ç”¨æ¥ä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºæˆ–è€…ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥ä¿è¯ï¼Œåœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªgoroutineå¤„äºè¯¥ä¸´ç•ŒåŒºä¹‹å†…ã€‚</p><p>ä¸ºäº†å…‘ç°è¿™ä¸ªä¿è¯ï¼Œæ¯å½“æœ‰goroutineæƒ³è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œéƒ½éœ€è¦å…ˆå¯¹å®ƒè¿›è¡Œé”å®šï¼Œå¹¶ä¸”ï¼Œæ¯ä¸ªgoroutineç¦»å¼€ä¸´ç•ŒåŒºæ—¶ï¼Œéƒ½è¦åŠæ—¶åœ°å¯¹å®ƒè¿›è¡Œè§£é”ã€‚</p><p>é”å®šæ“ä½œå¯ä»¥é€šè¿‡è°ƒç”¨äº’æ–¥é”çš„<code>Lock</code>æ–¹æ³•å®ç°ï¼Œè€Œè§£é”æ“ä½œå¯ä»¥è°ƒç”¨äº’æ–¥é”çš„<code>Unlock</code>æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯demo58.goæ–‡ä»¶ä¸­é‡ç‚¹ä»£ç ç»è¿‡ç®€åŒ–ä¹‹åçš„ç‰‡æ®µï¼š</p><pre><code>mu.Lock()\n_, err := writer.Write([]byte(data))\nif err != nil {\n log.Printf(&quot;error: %s [%d]&quot;, err, id)\n}\nmu.Unlock()\n</code></pre><p>ä½ å¯èƒ½å·²ç»çœ‹å‡ºæ¥äº†ï¼Œè¿™é‡Œçš„äº’æ–¥é”å°±ç›¸å½“äºæˆ‘ä»¬å‰é¢è¯´çš„é‚£å—è®¿é—®ä»¤ç‰Œã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€æ ·æ‰èƒ½ç”¨å¥½è¿™å—è®¿é—®ä»¤ç‰Œå‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢çš„é—®é¢˜ã€‚</p><p><strong>æˆ‘ä»¬ä»Šå¤©çš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬ä½¿ç”¨äº’æ–¥é”æ—¶æœ‰å“ªäº›æ³¨æ„äº‹é¡¹ï¼Ÿ</strong></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå…¸å‹å›ç­”ã€‚</p><p>ä½¿ç”¨äº’æ–¥é”çš„æ³¨æ„äº‹é¡¹å¦‚ä¸‹ï¼š</p><ol>\n<li>ä¸è¦é‡å¤é”å®šäº’æ–¥é”ï¼›</li>\n<li>ä¸è¦å¿˜è®°è§£é”äº’æ–¥é”ï¼Œå¿…è¦æ—¶ä½¿ç”¨<code>defer</code>è¯­å¥ï¼›</li>\n<li>ä¸è¦å¯¹å°šæœªé”å®šæˆ–è€…å·²è§£é”çš„äº’æ–¥é”è§£é”ï¼›</li>\n<li>ä¸è¦åœ¨å¤šä¸ªå‡½æ•°ä¹‹é—´ç›´æ¥ä¼ é€’äº’æ–¥é”ã€‚</li>\n</ol><h2>é—®é¢˜è§£æ</h2><p>é¦–å…ˆï¼Œä½ è¿˜æ˜¯è¦æŠŠäº’æ–¥é”çœ‹ä½œæ˜¯é’ˆå¯¹æŸä¸€ä¸ªä¸´ç•ŒåŒºæˆ–æŸä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºçš„å”¯ä¸€è®¿é—®ä»¤ç‰Œã€‚</p><p>è™½ç„¶æ²¡æœ‰ä»»ä½•å¼ºåˆ¶è§„å®šæ¥é™åˆ¶ï¼Œä½ ç”¨åŒä¸€ä¸ªäº’æ–¥é”ä¿æŠ¤å¤šä¸ªæ— å…³çš„ä¸´ç•ŒåŒºï¼Œä½†æ˜¯è¿™æ ·åšï¼Œä¸€å®šä¼šè®©ä½ çš„ç¨‹åºå˜å¾—å¾ˆå¤æ‚ï¼Œå¹¶ä¸”ä¹Ÿä¼šæ˜æ˜¾åœ°å¢åŠ ä½ çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</p><p>ä½ è¦çŸ¥é“ï¼Œå¯¹ä¸€ä¸ªå·²ç»è¢«é”å®šçš„äº’æ–¥é”è¿›è¡Œé”å®šï¼Œæ˜¯ä¼šç«‹å³é˜»å¡å½“å‰çš„goroutineçš„ã€‚è¿™ä¸ªgoroutineæ‰€æ‰§è¡Œçš„æµç¨‹ï¼Œä¼šä¸€ç›´åœæ»åœ¨è°ƒç”¨è¯¥äº’æ–¥é”çš„<code>Lock</code>æ–¹æ³•çš„é‚£è¡Œä»£ç ä¸Šã€‚</p><p>ç›´åˆ°è¯¥äº’æ–¥é”çš„<code>Unlock</code>æ–¹æ³•è¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¿™é‡Œçš„é”å®šæ“ä½œæˆåŠŸå®Œæˆï¼Œåç»­çš„ä»£ç ï¼ˆä¹Ÿå°±æ˜¯ä¸´ç•ŒåŒºä¸­çš„ä»£ç ï¼‰æ‰ä¼šå¼€å§‹æ‰§è¡Œã€‚è¿™ä¹Ÿæ­£æ˜¯äº’æ–¥é”èƒ½å¤Ÿä¿æŠ¤ä¸´ç•ŒåŒºçš„åŸå› æ‰€åœ¨ã€‚</p><p>ä¸€æ—¦ï¼Œä½ æŠŠä¸€ä¸ªäº’æ–¥é”åŒæ—¶ç”¨åœ¨äº†å¤šä¸ªåœ°æ–¹ï¼Œå°±å¿…ç„¶ä¼šæœ‰æ›´å¤šçš„goroutineäº‰ç”¨è¿™æŠŠé”ã€‚è¿™ä¸ä½†ä¼šè®©ä½ çš„ç¨‹åºå˜æ…¢ï¼Œè¿˜ä¼šå¤§å¤§å¢åŠ æ­»é”ï¼ˆdeadlockï¼‰çš„å¯èƒ½æ€§ã€‚</p><p>æ‰€è°“çš„æ­»é”ï¼ŒæŒ‡çš„å°±æ˜¯å½“å‰ç¨‹åºä¸­çš„ä¸»goroutineï¼Œä»¥åŠæˆ‘ä»¬å¯ç”¨çš„é‚£äº›goroutineéƒ½å·²ç»è¢«é˜»å¡ã€‚è¿™äº›goroutineå¯ä»¥è¢«ç»Ÿç§°ä¸ºç”¨æˆ·çº§çš„goroutineã€‚è¿™å°±ç›¸å½“äºæ•´ä¸ªç¨‹åºéƒ½å·²ç»åœæ»ä¸å‰äº†ã€‚</p><p>Goè¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿæ˜¯ä¸å…è®¸è¿™ç§æƒ…å†µå‡ºç°çš„ï¼Œåªè¦å®ƒå‘ç°æ‰€æœ‰çš„ç”¨æˆ·çº§goroutineéƒ½å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå°±ä¼šè‡ªè¡ŒæŠ›å‡ºä¸€ä¸ªå¸¦æœ‰å¦‚ä¸‹ä¿¡æ¯çš„panicï¼š</p><pre><code>fatal error: all goroutines are asleep - deadlock!\n</code></pre><p><strong>æ³¨æ„ï¼Œè¿™ç§ç”±Goè¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿè‡ªè¡ŒæŠ›å‡ºçš„panicéƒ½å±äºè‡´å‘½é”™è¯¯ï¼Œéƒ½æ˜¯æ— æ³•è¢«æ¢å¤çš„ï¼Œè°ƒç”¨<code>recover</code>å‡½æ•°å¯¹å®ƒä»¬èµ·ä¸åˆ°ä»»ä½•ä½œç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦äº§ç”Ÿæ­»é”ï¼Œç¨‹åºå¿…ç„¶å´©æºƒã€‚</strong></p><p>å› æ­¤ï¼Œæˆ‘ä»¬ä¸€å®šè¦å°½é‡é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚è€Œæœ€ç®€å•ã€æœ‰æ•ˆçš„æ–¹å¼å°±æ˜¯è®©æ¯ä¸€ä¸ªäº’æ–¥é”éƒ½åªä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºæˆ–ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºã€‚</p><p>åœ¨è¿™ä¸ªå‰æä¹‹ä¸‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ï¼Œå¯¹äºåŒä¸€ä¸ªgoroutineè€Œè¨€ï¼Œæ—¢ä¸è¦é‡å¤é”å®šä¸€ä¸ªäº’æ–¥é”ï¼Œä¹Ÿä¸è¦å¿˜è®°å¯¹å®ƒè¿›è¡Œè§£é”ã€‚</p><p>ä¸€ä¸ªgoroutineå¯¹æŸä¸€ä¸ªäº’æ–¥é”çš„é‡å¤é”å®šï¼Œå°±æ„å‘³ç€å®ƒè‡ªå·±é”æ­»äº†è‡ªå·±ã€‚å…ˆä¸è¯´è¿™ç§åšæ³•æœ¬èº«å°±æ˜¯é”™è¯¯çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæƒ³è®©å…¶ä»–çš„goroutineæ¥å¸®å®ƒè§£é”æ˜¯éå¸¸éš¾ä»¥ä¿è¯å…¶æ­£ç¡®æ€§çš„ã€‚</p><p>æˆ‘ä»¥å‰å°±åœ¨å›¢é˜Ÿä»£ç åº“ä¸­è§åˆ°è¿‡è¿™æ ·çš„ä»£ç ã€‚é‚£ä¸ªä½œè€…çš„æœ¬æ„æ˜¯å…ˆè®©ä¸€ä¸ªgoroutineè‡ªå·±é”æ­»è‡ªå·±ï¼Œç„¶åå†è®©ä¸€ä¸ªè´Ÿè´£è°ƒåº¦çš„goroutineå®šæ—¶åœ°è§£é”é‚£ä¸ªäº’æ–¥é”ï¼Œä»è€Œè®©å‰ä¸€ä¸ªgoroutineå‘¨æœŸæ€§åœ°å»åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æœåŠ¡å™¨çŠ¶æ€ï¼Œæˆ–è€…æ¯å¤©æ¸…ç†ä¸€æ¬¡æ—¥å¿—ã€‚</p><p>è¿™ä¸ªæƒ³æ³•æœ¬èº«æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†å´é€‰é”™äº†å®ç°çš„å·¥å…·ã€‚å¯¹äºäº’æ–¥é”è¿™ç§éœ€è¦ç²¾ç»†åŒ–æ§åˆ¶çš„åŒæ­¥å·¥å…·è€Œè¨€ï¼Œè¿™æ ·çš„ä»»åŠ¡å¹¶ä¸é€‚åˆå®ƒã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿é€‰ç”¨é€šé“æˆ–è€…<code>time.Ticker</code>ç±»å‹ï¼Œç„¶åè‡ªè¡Œå®ç°åŠŸèƒ½éƒ½æ˜¯å¯ä»¥çš„ï¼Œç¨‹åºçš„å¤æ‚åº¦å’Œæˆ‘ä»¬çš„å¿ƒæ™ºè´Ÿæ‹…ä¹Ÿä¼šå°å¾ˆå¤šï¼Œæ›´ä½•å†µè¿˜æœ‰ä¸å°‘å·²ç»å¾ˆå®Œå¤‡çš„è§£å†³æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ã€‚</p><p>è¯è¯´å›æ¥ï¼Œå…¶å®æˆ‘ä»¬è¯´â€œä¸è¦å¿˜è®°è§£é”äº’æ–¥é”â€çš„ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯ï¼š<strong>é¿å…é‡å¤é”å®šã€‚</strong></p><p>å› ä¸ºåœ¨ä¸€ä¸ªgoroutineæ‰§è¡Œçš„æµç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°è¯¸å¦‚â€œé”å®šã€è§£é”ã€å†é”å®šã€å†è§£é”â€çš„æ“ä½œï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¿˜è®°äº†ä¸­é—´çš„è§£é”æ“ä½œï¼Œé‚£å°±ä¸€å®šä¼šé€ æˆé‡å¤é”å®šã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¿˜è®°è§£é”è¿˜ä¼šä½¿å…¶ä»–çš„goroutineæ— æ³•è¿›å…¥åˆ°è¯¥äº’æ–¥é”ä¿æŠ¤çš„ä¸´ç•ŒåŒºï¼Œè¿™è½»åˆ™ä¼šå¯¼è‡´ä¸€äº›ç¨‹åºåŠŸèƒ½çš„å¤±æ•ˆï¼Œé‡åˆ™ä¼šé€ æˆæ­»é”å’Œç¨‹åºå´©æºƒã€‚</p><p>åœ¨å¾ˆå¤šæ—¶å€™ï¼Œä¸€ä¸ªå‡½æ•°æ‰§è¡Œçš„æµç¨‹å¹¶ä¸æ˜¯å•ä¸€çš„ï¼Œæµç¨‹ä¸­é—´å¯èƒ½ä¼šæœ‰åˆ†å‰ï¼Œä¹Ÿå¯èƒ½ä¼šè¢«ä¸­æ–­ã€‚</p><p>å¦‚æœä¸€ä¸ªæµç¨‹åœ¨é”å®šäº†æŸä¸ªäº’æ–¥é”ä¹‹ååˆ†å‰äº†ï¼Œæˆ–è€…æœ‰è¢«ä¸­æ–­çš„å¯èƒ½ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨<code>defer</code>è¯­å¥æ¥å¯¹å®ƒè¿›è¡Œè§£é”ï¼Œè€Œä¸”è¿™æ ·çš„<code>defer</code>è¯­å¥åº”è¯¥ç´§è·Ÿåœ¨é”å®šæ“ä½œä¹‹åã€‚è¿™æ˜¯æœ€ä¿é™©çš„ä¸€ç§åšæ³•ã€‚</p><p>å¿˜è®°è§£é”å¯¼è‡´çš„é—®é¢˜æœ‰æ—¶å€™æ˜¯æ¯”è¾ƒéšç§˜çš„ï¼Œå¹¶ä¸ä¼šé‚£ä¹ˆå¿«å°±æš´éœ²å‡ºæ¥ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦ç‰¹åˆ«å…³æ³¨å®ƒçš„åŸå› ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè§£é”æœªé”å®šçš„äº’æ–¥é”ä¼šç«‹å³å¼•å‘panicã€‚</p><p>å¹¶ä¸”ï¼Œä¸æ­»é”å¯¼è‡´çš„panicä¸€æ ·ï¼Œå®ƒä»¬æ˜¯æ— æ³•è¢«æ¢å¤çš„ã€‚<strong>å› æ­¤ï¼Œæˆ‘ä»¬æ€»æ˜¯åº”è¯¥ä¿è¯ï¼Œå¯¹äºæ¯ä¸€ä¸ªé”å®šæ“ä½œï¼Œéƒ½è¦æœ‰ä¸”åªæœ‰ä¸€ä¸ªå¯¹åº”çš„è§£é”æ“ä½œã€‚</strong></p><p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥è®©å®ƒä»¬æˆå¯¹å‡ºç°ã€‚è¿™ä¹Ÿç®—æ˜¯äº’æ–¥é”çš„ä¸€ä¸ªå¾ˆé‡è¦çš„ä½¿ç”¨åŸåˆ™äº†ã€‚åœ¨å¾ˆå¤šæ—¶å€™ï¼Œåˆ©ç”¨<code>defer</code>è¯­å¥è¿›è¡Œè§£é”å¯ä»¥æ›´å®¹æ˜“åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/0d/4f86467d09ffca6e0c02602a9cb7480d.png?wh=1610*1052\" alt=\"\"></p><p>ï¼ˆäº’æ–¥é”çš„é‡å¤é”å®šå’Œé‡å¤è§£é”ï¼‰</p><p>æœ€åï¼Œå¯èƒ½ä½ å·²ç»çŸ¥é“ï¼ŒGoè¯­è¨€ä¸­çš„äº’æ–¥é”æ˜¯å¼€ç®±å³ç”¨çš„ã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ—¦æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ª<code>sync.Mutex</code>ç±»å‹çš„å˜é‡ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒäº†ã€‚</p><p>ä¸è¿‡è¦æ³¨æ„ï¼Œè¯¥ç±»å‹æ˜¯ä¸€ä¸ªç»“æ„ä½“ç±»å‹ï¼Œå±äºå€¼ç±»å‹ä¸­çš„ä¸€ç§ã€‚æŠŠå®ƒä¼ ç»™ä¸€ä¸ªå‡½æ•°ã€å°†å®ƒä»å‡½æ•°ä¸­è¿”å›ã€æŠŠå®ƒèµ‹ç»™å…¶ä»–å˜é‡ã€è®©å®ƒè¿›å…¥æŸä¸ªé€šé“éƒ½ä¼šå¯¼è‡´å®ƒçš„å‰¯æœ¬çš„äº§ç”Ÿã€‚</p><p>å¹¶ä¸”ï¼ŒåŸå€¼å’Œå®ƒçš„å‰¯æœ¬ï¼Œä»¥åŠå¤šä¸ªå‰¯æœ¬ä¹‹é—´éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸åŒçš„äº’æ–¥é”ã€‚</p><p>å¦‚æœä½ æŠŠä¸€ä¸ªäº’æ–¥é”ä½œä¸ºå‚æ•°å€¼ä¼ ç»™äº†ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå‡½æ•°ä¸­å¯¹ä¼ å…¥çš„é”çš„æ‰€æœ‰æ“ä½œï¼Œéƒ½ä¸ä¼šå¯¹å­˜åœ¨äºè¯¥å‡½æ•°ä¹‹å¤–çš„é‚£ä¸ªåŸé”äº§ç”Ÿä»»ä½•çš„å½±å“ã€‚</p><p>æ‰€ä»¥ï¼Œä½ åœ¨è¿™æ ·åšä¹‹å‰ï¼Œä¸€å®šè¦è€ƒè™‘æ¸…æ¥šï¼Œè¿™ç§ç»“æœæ˜¯ä½ æƒ³è¦çš„å—ï¼Ÿæˆ‘æƒ³ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åº”è¯¥éƒ½ä¸æ˜¯ã€‚å³ä½¿ä½ çœŸçš„å¸Œæœ›ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ä½¿ç”¨å¦å¤–ä¸€ä¸ªäº’æ–¥é”ä¹Ÿä¸è¦è¿™æ ·åšï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰ã€‚</p><p>ä»¥ä¸Šè¿™äº›ï¼Œå°±æ˜¯æˆ‘æƒ³è¦å‘Šè¯‰ä½ çš„å…³äºäº’æ–¥é”çš„é”å®šã€è§£é”ï¼Œä»¥åŠä¼ é€’æ–¹é¢çš„çŸ¥è¯†ã€‚è¿™å…¶ä¸­è¿˜åŒ…æ‹¬äº†æˆ‘çš„ä¸€äº›ç†è§£ã€‚å¸Œæœ›èƒ½å¤Ÿå¯¹ä½ æœ‰ç”¨ã€‚ç›¸å…³çš„ä¾‹å­æˆ‘å·²ç»å†™åœ¨demo59.goæ–‡ä»¶ä¸­äº†ï¼Œä½ å¯ä»¥å»é˜…è¯»ä¸€ç•ªï¼Œå¹¶è¿è¡Œèµ·æ¥çœ‹çœ‹ã€‚</p><h2>çŸ¥è¯†æ‰©å±•</h2><p>é—®é¢˜1ï¼šè¯»å†™é”ä¸äº’æ–¥é”æœ‰å“ªäº›å¼‚åŒï¼Ÿ</p><p>è¯»å†™é”æ˜¯è¯»/å†™äº’æ–¥é”çš„ç®€ç§°ã€‚åœ¨Goè¯­è¨€ä¸­ï¼Œè¯»å†™é”ç”±<code>sync.RWMutex</code>ç±»å‹çš„å€¼ä»£è¡¨ã€‚ä¸<code>sync.Mutex</code>ç±»å‹ä¸€æ ·ï¼Œè¿™ä¸ªç±»å‹ä¹Ÿæ˜¯å¼€ç®±å³ç”¨çš„ã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œè¯»å†™é”æ˜¯æŠŠå¯¹å…±äº«èµ„æºçš„â€œè¯»æ“ä½œâ€å’Œâ€œå†™æ“ä½œâ€åŒºåˆ«å¯¹å¾…äº†ã€‚å®ƒå¯ä»¥å¯¹è¿™ä¸¤ç§æ“ä½œæ–½åŠ ä¸åŒç¨‹åº¦çš„ä¿æŠ¤ã€‚æ¢å¥è¯è¯´ï¼Œç›¸æ¯”äºäº’æ–¥é”ï¼Œè¯»å†™é”å¯ä»¥å®ç°æ›´åŠ ç»†è…»çš„è®¿é—®æ§åˆ¶ã€‚</p><p>ä¸€ä¸ªè¯»å†™é”ä¸­å®é™…ä¸ŠåŒ…å«äº†ä¸¤ä¸ªé”ï¼Œå³ï¼šè¯»é”å’Œå†™é”ã€‚<code>sync.RWMutex</code>ç±»å‹ä¸­çš„<code>Lock</code>æ–¹æ³•å’Œ<code>Unlock</code>æ–¹æ³•åˆ†åˆ«ç”¨äºå¯¹å†™é”è¿›è¡Œé”å®šå’Œè§£é”ï¼Œè€Œå®ƒçš„<code>RLock</code>æ–¹æ³•å’Œ<code>RUnlock</code>æ–¹æ³•åˆ™åˆ†åˆ«ç”¨äºå¯¹è¯»é”è¿›è¡Œé”å®šå’Œè§£é”ã€‚</p><p>å¦å¤–ï¼Œå¯¹äºåŒä¸€ä¸ªè¯»å†™é”æ¥è¯´æœ‰å¦‚ä¸‹è§„åˆ™ã€‚</p><ol>\n<li>åœ¨å†™é”å·²è¢«é”å®šçš„æƒ…å†µä¸‹å†è¯•å›¾é”å®šå†™é”ï¼Œä¼šé˜»å¡å½“å‰çš„goroutineã€‚</li>\n<li>åœ¨å†™é”å·²è¢«é”å®šçš„æƒ…å†µä¸‹è¯•å›¾é”å®šè¯»é”ï¼Œä¹Ÿä¼šé˜»å¡å½“å‰çš„goroutineã€‚</li>\n<li>åœ¨è¯»é”å·²è¢«é”å®šçš„æƒ…å†µä¸‹è¯•å›¾é”å®šå†™é”ï¼ŒåŒæ ·ä¼šé˜»å¡å½“å‰çš„goroutineã€‚</li>\n<li>åœ¨è¯»é”å·²è¢«é”å®šçš„æƒ…å†µä¸‹å†è¯•å›¾é”å®šè¯»é”ï¼Œå¹¶ä¸ä¼šé˜»å¡å½“å‰çš„goroutineã€‚</li>\n</ol><p>æ¢ä¸€ä¸ªè§’åº¦æ¥è¯´ï¼Œå¯¹äºæŸä¸ªå—åˆ°è¯»å†™é”ä¿æŠ¤çš„å…±äº«èµ„æºï¼Œå¤šä¸ªå†™æ“ä½œä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œå†™æ“ä½œå’Œè¯»æ“ä½œä¹Ÿä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œä½†å¤šä¸ªè¯»æ“ä½œå´å¯ä»¥åŒæ—¶è¿›è¡Œã€‚</p><p>å½“ç„¶äº†ï¼Œåªæœ‰åœ¨æˆ‘ä»¬æ­£ç¡®ä½¿ç”¨è¯»å†™é”çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½è¾¾åˆ°è¿™ç§æ•ˆæœã€‚è¿˜æ˜¯é‚£å¥è¯ï¼Œæˆ‘ä»¬éœ€è¦è®©æ¯ä¸€ä¸ªé”éƒ½åªä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œæˆ–è€…ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºï¼Œå¹¶ä»¥æ­¤å°½é‡å‡å°‘è¯¯ç”¨çš„å¯èƒ½æ€§ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠè¿™ç§ä¸èƒ½åŒæ—¶è¿›è¡Œçš„æ“ä½œç§°ä¸ºäº’æ–¥æ“ä½œã€‚</p><p>å†æ¥çœ‹å¦ä¸€ä¸ªæ–¹é¢ã€‚å¯¹å†™é”è¿›è¡Œè§£é”ï¼Œä¼šå”¤é†’â€œæ‰€æœ‰å› è¯•å›¾é”å®šè¯»é”ï¼Œè€Œè¢«é˜»å¡çš„goroutineâ€ï¼Œå¹¶ä¸”ï¼Œè¿™é€šå¸¸ä¼šä½¿å®ƒä»¬éƒ½æˆåŠŸå®Œæˆå¯¹è¯»é”çš„é”å®šã€‚</p><p>ç„¶è€Œï¼Œå¯¹è¯»é”è¿›è¡Œè§£é”ï¼Œåªä¼šåœ¨æ²¡æœ‰å…¶ä»–è¯»é”é”å®šçš„å‰æä¸‹ï¼Œå”¤é†’â€œå› è¯•å›¾é”å®šå†™é”ï¼Œè€Œè¢«é˜»å¡çš„goroutineâ€ï¼›å¹¶ä¸”ï¼Œæœ€ç»ˆåªä¼šæœ‰ä¸€ä¸ªè¢«å”¤é†’çš„goroutineèƒ½å¤ŸæˆåŠŸå®Œæˆå¯¹å†™é”çš„é”å®šï¼Œå…¶ä»–çš„goroutineè¿˜è¦åœ¨åŸå¤„ç»§ç»­ç­‰å¾…ã€‚è‡³äºæ˜¯å“ªä¸€ä¸ªgoroutineï¼Œé‚£å°±è¦çœ‹è°çš„ç­‰å¾…æ—¶é—´æœ€é•¿äº†ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¯»å†™é”å¯¹å†™æ“ä½œä¹‹é—´çš„äº’æ–¥ï¼Œå…¶å®æ˜¯é€šè¿‡å®ƒå†…å«çš„ä¸€ä¸ªäº’æ–¥é”å®ç°çš„ã€‚å› æ­¤ï¼Œä¹Ÿå¯ä»¥è¯´ï¼ŒGoè¯­è¨€çš„è¯»å†™é”æ˜¯äº’æ–¥é”çš„ä¸€ç§æ‰©å±•ã€‚</p><p>æœ€åï¼Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œä¸äº’æ–¥é”ç±»ä¼¼ï¼Œè§£é”â€œè¯»å†™é”ä¸­æœªè¢«é”å®šçš„å†™é”â€ï¼Œä¼šç«‹å³å¼•å‘panicï¼Œå¯¹äºå…¶ä¸­çš„è¯»é”ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¹¶ä¸”åŒæ ·æ˜¯ä¸å¯æ¢å¤çš„ã€‚</p><p>æ€»ä¹‹ï¼Œè¯»å†™é”ä¸äº’æ–¥é”çš„ä¸åŒï¼Œéƒ½æºäºå®ƒæŠŠå¯¹å…±äº«èµ„æºçš„å†™æ“ä½œå’Œè¯»æ“ä½œåŒºåˆ«å¯¹å¾…äº†ã€‚è¿™ä¹Ÿä½¿å¾—å®ƒå®ç°çš„äº’æ–¥è§„åˆ™è¦æ›´å¤æ‚ä¸€äº›ã€‚</p><p>ä¸è¿‡ï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒå¯¹å…±äº«èµ„æºçš„æ“ä½œï¼Œå®è¡Œæ›´åŠ ç»†è…»çš„æ§åˆ¶ã€‚å¦å¤–ï¼Œç”±äºè¿™é‡Œçš„è¯»å†™é”æ˜¯äº’æ–¥é”çš„ä¸€ç§æ‰©å±•ï¼Œæ‰€ä»¥åœ¨æœ‰äº›æ–¹é¢å®ƒè¿˜æ˜¯æ²¿ç”¨äº†äº’æ–¥é”çš„è¡Œä¸ºæ¨¡å¼ã€‚æ¯”å¦‚ï¼Œåœ¨è§£é”æœªé”å®šçš„å†™é”æˆ–è¯»é”æ—¶çš„è¡¨ç°ï¼Œåˆæ¯”å¦‚ï¼Œå¯¹å†™æ“ä½œä¹‹é—´äº’æ–¥çš„å®ç°æ–¹å¼ã€‚</p><h2>æ€»ç»“</h2><p>æˆ‘ä»¬ä»Šå¤©è®¨è®ºäº†å¾ˆå¤šä¸å¤šçº¿ç¨‹ã€å…±äº«èµ„æºä»¥åŠåŒæ­¥æœ‰å…³çš„çŸ¥è¯†ã€‚å…¶ä¸­æ¶‰åŠäº†ä¸å°‘é‡è¦çš„å¹¶å‘ç¼–ç¨‹æ¦‚å¿µï¼Œæ¯”å¦‚ï¼Œç«æ€æ¡ä»¶ã€ä¸´ç•ŒåŒºã€äº’æ–¥é‡ã€æ­»é”ç­‰ã€‚</p><p>è™½ç„¶Goè¯­è¨€æ˜¯ä»¥â€œç”¨é€šè®¯çš„æ–¹å¼å…±äº«æ•°æ®â€ä¸ºäº®ç‚¹çš„ï¼Œä½†æ˜¯å®ƒä¾ç„¶æä¾›äº†ä¸€äº›æ˜“ç”¨çš„åŒæ­¥å·¥å…·ã€‚å…¶ä¸­ï¼Œäº’æ–¥é”æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ä¸€ä¸ªã€‚</p><p>äº’æ–¥é”å¸¸å¸¸è¢«ç”¨æ¥ï¼šä¿è¯å¤šä¸ªgoroutineå¹¶å‘åœ°è®¿é—®åŒä¸€ä¸ªå…±äº«èµ„æºæ—¶çš„å®Œå…¨ä¸²è¡Œï¼Œè¿™æ˜¯é€šè¿‡ä¿æŠ¤é’ˆå¯¹æ­¤å…±äº«èµ„æºçš„ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œæˆ–ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºå®ç°çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯goroutineè¿›å…¥ç›¸å…³ä¸´ç•ŒåŒºæ—¶ï¼Œå¿…é¡»æ‹¿åˆ°çš„è®¿é—®ä»¤ç‰Œã€‚</p><p>ä¸ºäº†ç”¨å¯¹å¹¶ä¸”ç”¨å¥½äº’æ–¥é”ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å®ƒå®ç°çš„äº’æ–¥è§„åˆ™ï¼Œæ›´è¦ç†è§£ä¸€äº›å…³äºå®ƒçš„æ³¨æ„äº‹é¡¹ã€‚</p><p>æ¯”å¦‚ï¼Œä¸è¦é‡å¤é”å®šæˆ–å¿˜è®°è§£é”ï¼Œå› ä¸ºè¿™ä¼šé€ æˆgoroutineä¸å¿…è¦çš„é˜»å¡ï¼Œç”šè‡³å¯¼è‡´ç¨‹åºçš„æ­»é”ã€‚</p><p>åˆæ¯”å¦‚ï¼Œä¸è¦ä¼ é€’äº’æ–¥é”ï¼Œå› ä¸ºè¿™ä¼šäº§ç”Ÿå®ƒçš„å‰¯æœ¬ï¼Œä»è€Œå¼•èµ·æ­§ä¹‰å¹¶å¯èƒ½å¯¼è‡´äº’æ–¥æ“ä½œçš„å¤±æ•ˆã€‚</p><p>å†æ¬¡å¼ºè°ƒï¼Œæˆ‘ä»¬æ€»æ˜¯åº”è¯¥è®©æ¯ä¸€ä¸ªäº’æ–¥é”éƒ½åªä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œæˆ–ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºã€‚</p><p>è‡³äºè¯»å†™é”ï¼Œå®ƒæ˜¯äº’æ–¥é”çš„ä¸€ç§æ‰©å±•ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“å®ƒä¸äº’æ–¥é”çš„å¼‚åŒï¼Œå°¤å…¶æ˜¯äº’æ–¥è§„åˆ™å’Œè¡Œä¸ºæ¨¡å¼æ–¹é¢çš„å¼‚åŒã€‚ä¸€ä¸ªè¯»å†™é”ä¸­åŒæ—¶åŒ…å«äº†è¯»é”å’Œå†™é”ï¼Œç”±æ­¤ä¹Ÿå¯ä»¥çœ‹å‡ºå®ƒå¯¹äºé’ˆå¯¹å…±äº«èµ„æºçš„è¯»æ“ä½œå’Œå†™æ“ä½œæ˜¯åŒºåˆ«å¯¹å¾…çš„ã€‚æˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä»¶äº‹ï¼Œå¯¹å…±äº«èµ„æºå®æ–½æ›´åŠ ç»†è‡´çš„è®¿é—®æ§åˆ¶ã€‚</p><p>æœ€åï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯äº’æ–¥é”è¿˜æ˜¯è¯»å†™é”ï¼Œæˆ‘ä»¬éƒ½ä¸è¦è¯•å›¾å»è§£é”æœªé”å®šçš„é”ï¼Œå› ä¸ºè¿™æ ·ä¼šå¼•å‘ä¸å¯æ¢å¤çš„panicã€‚</p><h2>æ€è€ƒé¢˜</h2><ol>\n<li>ä½ çŸ¥é“äº’æ–¥é”å’Œè¯»å†™é”çš„æŒ‡é’ˆç±»å‹éƒ½å®ç°äº†å“ªä¸€ä¸ªæ¥å£å—ï¼Ÿ</li>\n<li>æ€æ ·è·å–è¯»å†™é”ä¸­çš„è¯»é”ï¼Ÿ</li>\n</ol><p><a href=\"https://github.com/hyper0x/Golang_Puzzlers\">æˆ³æ­¤æŸ¥çœ‹Goè¯­è¨€ä¸“æ æ–‡ç« é…å¥—è¯¦ç»†ä»£ç ã€‚</a></p><p></p>","neighbors":{"left":{"article_title":"25 | æ›´å¤šçš„æµ‹è¯•æ‰‹æ³•","id":41255},"right":{"article_title":"27 | æ¡ä»¶å˜é‡sync.Cond ï¼ˆä¸Šï¼‰","id":41588}},"comments":[{"had_liked":false,"id":31298,"user_name":"å±é›¨","can_delete":false,"product_type":"c1","uid":1202624,"ip_address":"","ucode":"700236847A5C94","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/c0/6f02c096.jpg","comment_is_top":false,"comment_ctime":1539144466,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"130388163346","product_id":100013101,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>Lockæ¥å£ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>å˜é‡.Rlock()","like_count":30,"discussions":[{"author":{"id":1272825,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/f9/da3ee7a8.jpg","nickname":"Onyanga","note":"","ucode":"DF4D22F0D51881","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300406,"discussion_content":"RLocker","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1598083807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362833,"discussion_content":"RLock()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617035421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82774,"user_name":"é˜³ä»”","can_delete":false,"product_type":"c1","uid":1046920,"ip_address":"","ucode":"79F73D85EDF3E2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/88/cdda9e6f.jpg","comment_is_top":false,"comment_ctime":1554303732,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"117518420724","product_id":100013101,"comment_content":"å­¦ä¹ å°†è¿‘ä¸€åŠçš„è¯¾ç¨‹äº†å‘ç°:<br>1. å†…å®¹ä¸å¤Ÿç®€æ´ï¼Œå¾ˆå¤šçŸ¥è¯†ç‚¹å…¶å®ç”»å›¾å‡ºæ¥æ›´å®¹æ˜“è®©è¯»è€…ç†è§£<br>2. æ„Ÿè§‰ä¸å¤§é€‚åˆåˆå­¦è€…ï¼Œåè€Œå¯¹å·²ç»å…¥é—¨æœ‰ä¸€å®šç»éªŒçš„å­¦ä¹ è€…ä¼šå¸®åŠ©æ›´å¤§ä¸€äº›<br>3. å¯ä»¥çœ‹å‡ºæ¥ä½œè€…æ˜¯éå¸¸ç²¾é€šgoçš„","like_count":27,"discussions":[{"author":{"id":1203834,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5e/7a/028dc1a9.jpg","nickname":"ä¿®ç½—","note":"","ucode":"9C25F94C40285F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":191966,"discussion_content":"åŒæ„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583050555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1210386,"avatar":"https://static001.geekbang.org/account/avatar/00/12/78/12/7df38a54.jpg","nickname":"helloworld2018","note":"","ucode":"2AE40C0DF5A9F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560939,"discussion_content":"å†™çš„å¤ªå•°å—¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649494956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2948592,"avatar":"","nickname":"woJA1wCgAA_-wbFKSNXFkMtE_zcssu9g","note":"","ucode":"3F0EFFE9DB2E2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557810,"discussion_content":"ç¡®å®æœ‰å¾ˆäº›ç»†èŠ‚å¯èƒ½æ²¡ä¸¾ä¾‹åˆ°ï¼Œä½†æ˜¯å…¨æ–‡çœŸçš„æ»¡æ»¡çš„å¹²è´§ã€‚çœ‹äº†ä¸€æ®µæ—¶é—´goçŸ¥è¯†äº†ï¼Œçœ‹äº†è¿™ç¯‡ï¼Œæ”¶è·è¿˜æ˜¯æŒºå¤§çš„ï¼Œä¸€ç§çŸ¥è¯†éªŒè¯çš„æ„Ÿè§‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647962679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541070,"discussion_content":"çœ‹äº†è¿™ä¸ªè¯¾ç¨‹ï¼Œ æˆ‘è§‰å¾—ä½œè€…æœ‰å¤§æ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640248598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31480,"user_name":"Geek_cd5dcf","can_delete":false,"product_type":"c1","uid":1074596,"ip_address":"","ucode":"4B6499FBABA8BC","user_header":"","comment_is_top":false,"comment_ctime":1539217030,"is_pvip":false,"replies":[{"id":"11820","content":"å¯¹ï¼Œä¸ä¼šï¼Œè¿™æ˜¯deferçš„æœºåˆ¶ä¿è¯çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1539577295,"ip_address":"","comment_id":31480,"utype":1}],"discussion_count":6,"race_medal":0,"score":"83143595654","product_id":100013101,"comment_content":"è®²çš„é€šä¿—æ˜“æ‡‚ï¼Œè¿˜æ˜¯æŒºå¥½ç†è§£çš„ï¼Œæƒ³é—®ä¸‹mutexå¦‚æœåŠ é”å<br>mutex.lockï¼ˆï¼‰<br>defer mutex.unlockï¼ˆï¼‰<br>åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½ä¸ä¼šå‡ºé”™å—ï¼Ÿ","like_count":19,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426362,"discussion_content":"å¯¹ï¼Œä¸ä¼šï¼Œè¿™æ˜¯deferçš„æœºåˆ¶ä¿è¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539577295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1295596,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIBJYQ73yYqmiaU7Zg0BHPh9gpSglI79Dzcbob7I2tZOhTjbTTCw13KzVusYhLbKkukV9Ru5UfJMxQ/132","nickname":"Geek_2d276a","note":"","ucode":"866B39EBE71356","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294157,"discussion_content":"æƒ³ç¡®è®¤ä¸€ä¸‹ï¼Œè¿™ä¸ªdeferçš„æ‰§è¡Œæ—¶æœºæ˜¯ï¼Œå½“å‰å‡½æ•°è¿”å›æ—¶å—ï¼Ÿå…±äº«ä¸´ç•ŒåŒºæ˜¯å¦ä¼šè·¨å‡½æ•°å­˜åœ¨ï¼Œå³åŠ é”å’Œè§£é”ä¸åœ¨åŒä¸€å‡½æ•°ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595812090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083782,"avatar":"https://static001.geekbang.org/account/avatar/00/10/89/86/4a7b4d03.jpg","nickname":"ç‹ç¿”","note":"","ucode":"5F967EA510E231","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20519,"discussion_content":"æˆ‘è®¤ä¸ºä¸æ˜¯è¿™æ ·çš„ã€‚å¦‚æœè¿™ä¸ªå‡½æ•°åœ¨å†…éƒ¨å¦‚æœè¿˜æœ‰å…¶ä»–çš„å‡½æ•°è°ƒç”¨ï¼Œå¦‚æœè¢«è°ƒç”¨çš„å‡½æ•°ä¹Ÿæœ‰ç›¸åŒçš„mutex.Lock()å°±ä¼šå¯¼è‡´æ­»é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569324348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1807836,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/95/dc/07195a63.jpg","nickname":"é”‹","note":"","ucode":"F26BC1F14AB0D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1083782,"avatar":"https://static001.geekbang.org/account/avatar/00/10/89/86/4a7b4d03.jpg","nickname":"ç‹ç¿”","note":"","ucode":"5F967EA510E231","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":198126,"discussion_content":"é”å¥—é”çš„è®¾è®¡ä¸€èˆ¬å¾ˆå°‘ä¼šç”¨ï¼Œå¾ˆå®¹æ˜“é€ æˆæ­»é”\n\nå¹¶ä¸”å¦‚æœä½ æ˜¯å‡½æ•°ä¼ é€’çš„mutexï¼Œé‚£ä¹ˆè¢«è°ƒç”¨å‡½æ•°é‡Œé¢çš„mutexè·Ÿå½“å‰è¿™ä¸ªmutexä¹Ÿä¸æ˜¯åŒä¸€ä¸ªå•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583476725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":20519,"ip_address":""},"score":198126,"extra":""},{"author":{"id":1295596,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIBJYQ73yYqmiaU7Zg0BHPh9gpSglI79Dzcbob7I2tZOhTjbTTCw13KzVusYhLbKkukV9Ru5UfJMxQ/132","nickname":"Geek_2d276a","note":"","ucode":"866B39EBE71356","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1807836,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/95/dc/07195a63.jpg","nickname":"é”‹","note":"","ucode":"F26BC1F14AB0D7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294155,"discussion_content":"ä¸ç”¨å‡½æ•°ä¼ é€’ï¼Œäº’æ–¥é”å°±æ˜¯ä¸€å…¨å±€å˜é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595811833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":198126,"ip_address":""},"score":294155,"extra":""},{"author":{"id":2630632,"avatar":"https://static001.geekbang.org/account/avatar/00/28/23/e8/9f445339.jpg","nickname":"ç« æ½˜","note":"","ucode":"1A24E1B3084450","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1083782,"avatar":"https://static001.geekbang.org/account/avatar/00/10/89/86/4a7b4d03.jpg","nickname":"ç‹ç¿”","note":"","ucode":"5F967EA510E231","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":584037,"discussion_content":"éƒå¤§ä¸€å†å¼ºè°ƒå°å¿ƒç”¨é”ï¼Œä¸è¦é‡å¤åŠ é”ã€‚å¦‚æœéå¾—åµŒå¥—ï¼Œåªèƒ½è¯´æ˜  æ‰›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660570829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":20519,"ip_address":"å¹¿ä¸œ"},"score":584037,"extra":""}]}]},{"had_liked":false,"id":76741,"user_name":"ğŸ»","can_delete":false,"product_type":"c1","uid":1043072,"ip_address":"","ucode":"534EDAD496A0E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ea/80/8759e4c1.jpg","comment_is_top":false,"comment_ctime":1552699147,"is_pvip":false,"replies":[{"id":"28877","content":"âˆš","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1553399050,"ip_address":"","comment_id":76741,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61682241291","product_id":100013101,"comment_content":"1. Locker æ¥å£<br>2. func (rw *RWMutex) RLocker() Locker","like_count":14,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443427,"discussion_content":"âˆš","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553399050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185563,"user_name":"Pana","can_delete":false,"product_type":"c1","uid":1016571,"ip_address":"","ucode":"6E016D4966B187","user_header":"https://static001.geekbang.org/account/avatar/00/0f/82/fb/9d232a7a.jpg","comment_is_top":false,"comment_ctime":1583634451,"is_pvip":false,"replies":[{"id":"71693","content":"å¦‚æœCPUåªæœ‰ä¸€ä¸ªæ ¸å¿ƒï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰çœŸæ­£çš„å¹¶è¡Œè®¡ç®—äº†ã€‚ä½†æ˜¯ï¼Œå¹¶å‘è¿˜æ˜¯ä¼šæœ‰çš„ã€‚è¿™æ˜¯å› ä¸ºä»ç„¶å¯ä»¥åŒæ—¶æœ‰å¤šä¸ªgoroutineå­˜åœ¨ï¼ˆå®ƒä»¬å¯ä»¥åŒæ—¶å¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼‰ï¼Œåªä¸è¿‡Goè¯­è¨€çš„è¿è¡Œæ—¶ç³»ç»Ÿæ— æ³•è®©å®ƒä»¬åœ¨åŒä¸€æ—¶åˆ»éƒ½è¿è¡Œç½¢äº†ã€‚<br><br>å¹¶å‘å’Œå¹¶è¡Œè¿™ä¸¤ä¸ªè¯çš„å«ä¹‰æ˜¯ä¸åŒçš„ï¼Œéœ€è¦æˆ‘ä»¬åˆ†æ¸…æ¥šã€‚ç®€å•æ¥è¯´ï¼Œå¹¶å‘æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªæ—¶é—´æ®µå†…æäº¤å¤šä¸ªä»»åŠ¡ç»™ç³»ç»Ÿï¼Œå¹¶è¡Œæ˜¯æŒ‡åœ¨åŒä¸€æ—¶åˆ»ç³»ç»Ÿèƒ½æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1583649450,"ip_address":"","comment_id":185563,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31648405523","product_id":100013101,"comment_content":"å¦‚æœcpuåªæœ‰ä¸€ä¸ªæ ¸å¿ƒï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä¼šäº§ç”Ÿå¹¶å‘çš„æƒ…å†µï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486416,"discussion_content":"å¦‚æœCPUåªæœ‰ä¸€ä¸ªæ ¸å¿ƒï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰çœŸæ­£çš„å¹¶è¡Œè®¡ç®—äº†ã€‚ä½†æ˜¯ï¼Œå¹¶å‘è¿˜æ˜¯ä¼šæœ‰çš„ã€‚è¿™æ˜¯å› ä¸ºä»ç„¶å¯ä»¥åŒæ—¶æœ‰å¤šä¸ªgoroutineå­˜åœ¨ï¼ˆå®ƒä»¬å¯ä»¥åŒæ—¶å¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼‰ï¼Œåªä¸è¿‡Goè¯­è¨€çš„è¿è¡Œæ—¶ç³»ç»Ÿæ— æ³•è®©å®ƒä»¬åœ¨åŒä¸€æ—¶åˆ»éƒ½è¿è¡Œç½¢äº†ã€‚\n\nå¹¶å‘å’Œå¹¶è¡Œè¿™ä¸¤ä¸ªè¯çš„å«ä¹‰æ˜¯ä¸åŒçš„ï¼Œéœ€è¦æˆ‘ä»¬åˆ†æ¸…æ¥šã€‚ç®€å•æ¥è¯´ï¼Œå¹¶å‘æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªæ—¶é—´æ®µå†…æäº¤å¤šä¸ªä»»åŠ¡ç»™ç³»ç»Ÿï¼Œå¹¶è¡Œæ˜¯æŒ‡åœ¨åŒä¸€æ—¶åˆ»ç³»ç»Ÿèƒ½æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583649450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188793,"avatar":"https://static001.geekbang.org/account/avatar/00/12/23/b9/8d182f13.jpg","nickname":"èµ·é£äº†","note":"","ucode":"9A8A2E51E198EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291323,"discussion_content":"å¹¶è¡Œæ˜¯è®©å¤šä¸ªå¤„ç†å™¨æˆ–è€…å¤šæ ¸å¤„ç†å™¨åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼ŒåŒä¸€æ—¶é—´æœ‰å¤šä¸ªä»»åŠ¡è°ƒåº¦ã€‚\nå¹¶å‘æ˜¯ CPU å†…æ ¸é€šè¿‡æ—¶é—´ç‰‡æˆ–ä¸­æ–­æ¥æ§åˆ¶ï¼Œé‡åˆ° IO é˜»å¡æˆ–è€…æ—¶é—´ç‰‡ç”¨å®Œæ—¶ä¼šäº¤å‡ºçº¿ç¨‹çš„ä½¿ç”¨æƒï¼Œä»è€Œå®ç°ä¸€ä¸ªå†…æ ¸ä¸Šå¤„ç†å¤šä¸ªä»»åŠ¡ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1594780231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135282,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1569117170,"is_pvip":false,"replies":[{"id":"51902","content":"ä¼ ç»Ÿçš„åç¨‹åªæ˜¯çº¿ç¨‹å†…çš„æµç¨‹æ§åˆ¶å·¥å…·ã€‚å®ƒæ²¡æ³•åšåˆ°ä¸€ä¸ªçº¿ç¨‹å†…æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šæ§åˆ¶æµåŒæ—¶è¿›è¡Œï¼Œåªèƒ½æ˜¯è¿™ä¸€ä¸ªæŒ‚èµ·é‚£ä¸€ä¸ªè¿è¡Œç„¶åé‚£ä¸€ä¸ªæŒ‚èµ·è¿™ä¸€ä¸ªå†è¿è¡Œã€‚åŒæ—¶å®ƒä¹Ÿä¸å±äºå¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œæ²¡æ³•ç»Ÿä¸€è°ƒåº¦å¤šä¸ªçº¿ç¨‹å†…çš„æ§åˆ¶æµã€‚<br><br>goroutine æˆ‘å°±ä¸ç”¨å¤šè¯´äº†ï¼Œå®ƒå±äºç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¸ç³»ç»Ÿçº§çº¿ç¨‹æ­é…ä½¿ç”¨ï¼Œå¾ˆå¼ºå¤§ä¹Ÿå¾ˆçµæ´»ã€‚æ·±å…¥çš„ä¸œè¥¿å¯ä»¥çœ‹æˆ‘çš„é‚£æœ¬ã€ŠGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1569125460,"ip_address":"","comment_id":135282,"utype":1}],"discussion_count":3,"race_medal":0,"score":"23043953650","product_id":100013101,"comment_content":"goroutineå’Œåç¨‹æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«å•Šï¼Œæœäº†ç½‘ä¸Šä¹Ÿæ²¡çœ‹å‡ºæ¥å•¥æœ¬è´¨åŒºåˆ«ï¼Œæœ‰è¿™æ–¹é¢çš„èµ„æ–™å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468125,"discussion_content":"ä¼ ç»Ÿçš„åç¨‹åªæ˜¯çº¿ç¨‹å†…çš„æµç¨‹æ§åˆ¶å·¥å…·ã€‚å®ƒæ²¡æ³•åšåˆ°ä¸€ä¸ªçº¿ç¨‹å†…æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šæ§åˆ¶æµåŒæ—¶è¿›è¡Œï¼Œåªèƒ½æ˜¯è¿™ä¸€ä¸ªæŒ‚èµ·é‚£ä¸€ä¸ªè¿è¡Œç„¶åé‚£ä¸€ä¸ªæŒ‚èµ·è¿™ä¸€ä¸ªå†è¿è¡Œã€‚åŒæ—¶å®ƒä¹Ÿä¸å±äºå¤šçº¿ç¨‹ç¼–ç¨‹ï¼Œæ²¡æ³•ç»Ÿä¸€è°ƒåº¦å¤šä¸ªçº¿ç¨‹å†…çš„æ§åˆ¶æµã€‚\n\ngoroutine æˆ‘å°±ä¸ç”¨å¤šè¯´äº†ï¼Œå®ƒå±äºç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¸ç³»ç»Ÿçº§çº¿ç¨‹æ­é…ä½¿ç”¨ï¼Œå¾ˆå¼ºå¤§ä¹Ÿå¾ˆçµæ´»ã€‚æ·±å…¥çš„ä¸œè¥¿å¯ä»¥çœ‹æˆ‘çš„é‚£æœ¬ã€ŠGo å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569125460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3042134,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/6b/56/dce3cda9.jpg","nickname":"éŸ©å‹‡","note":"","ucode":"6412857673E60D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579902,"discussion_content":"Goroutineå’Œå…¶ä»–è¯­è¨€çš„åç¨‹ï¼ˆcoroutineï¼‰åœ¨ä½¿ç”¨æ–¹å¼ä¸Šç±»ä¼¼ï¼Œä½†ä»å­—é¢æ„ä¹‰ä¸Šæ¥çœ‹ä¸åŒï¼ˆä¸€ä¸ªæ˜¯Goroutineï¼Œä¸€ä¸ªæ˜¯coroutineï¼‰ï¼Œå†å°±æ˜¯åç¨‹æ˜¯ä¸€ç§åä½œä»»åŠ¡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨æœ€ç®€å•çš„æ„ä¹‰ä¸Šï¼Œåç¨‹ä¸æ˜¯å¹¶å‘çš„ï¼Œè€ŒGoroutineæ”¯æŒå¹¶å‘çš„ã€‚å› æ­¤Goroutineå¯ä»¥ç†è§£ä¸ºä¸€ç§Goè¯­è¨€çš„åç¨‹ã€‚åŒæ—¶å®ƒå¯ä»¥è¿è¡Œåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¸Šã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1657764787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362834,"discussion_content":"åç¨‹æ˜¯çº¿ç¨‹å®ç°å¤šä»»åŠ¡ï¼Œä¸€ä¸ªä»»åŠ¡ç§°ä¸ºä¸€ä¸ªåç¨‹ã€‚goroutineæ˜¯å®ç°åç¨‹çš„ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡Gä¸Mçš„ç»“åˆå®ç°å¤šä»»åŠ¡ï¼Œé™¤äº†goroutineï¼Œå®ç°åç¨‹è¿˜æœ‰yieldã€‚ä¸ªäººç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617035626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95224,"user_name":"Hector","can_delete":false,"product_type":"c1","uid":1496889,"ip_address":"","ucode":"110CAF87ADDC01","user_header":"https://static001.geekbang.org/account/avatar/00/16/d7/39/6698b6a9.jpg","comment_is_top":false,"comment_ctime":1557991536,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23032828016","product_id":100013101,"comment_content":"è¯»å†™é”æ€»ç»“ï¼Œ1ã€å¯ä»¥éšä¾¿è¯»ï¼Œå³ä½¿åŠ é”å¤šä¸ªgoroutineåŒæ—¶è¯»  2ã€åŠ é”å†™çš„æ—¶å€™ï¼Œå•¥ä¹Ÿä¸èƒ½å¹²ï¼Œä¸èƒ½å†™ã€‚å³ä½¿æ²¡åŠ è¯»é”ä¹Ÿä¸èƒ½è¯»ã€‚è€å¸ˆå†™çš„æœ‰ç‚¹ç»•è’™äº†ã€‚<br>å¼•ç”¨åŸæ–‡ï¼šå¯¹å†™é”è¿›è¡Œè§£é”ï¼Œä¼šå”¤é†’â€œæ‰€æœ‰å› è¯•å›¾é”å®šè¯»é”ï¼Œè€Œè¢«é˜»å¡çš„ goroutineâ€ï¼Œå¹¶ä¸”ï¼Œè¿™é€šå¸¸ä¼šä½¿å®ƒä»¬éƒ½æˆåŠŸå®Œæˆå¯¹è¯»é”çš„é”å®šã€‚æ„æ€å°±æ˜¯åœ¨å¯¹èµ„æºçš„å†™é”è¿›è¡Œè§£é”æ—¶ï¼ŒåŸæ¥ä½ åœ¨å¯¹è¯¥èµ„æºä¸Šå†™é”çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„è¯»é”ä¼šé”å®šæ¥é…åˆå†™æ“ä½œï¼Œç›´åˆ°å†™é”è§£é™¤é”å®šæ—¶ï¼Œè¿™äº›è¯»é”æ‰ä¼šè§£é”ã€‚","like_count":5,"discussions":[{"author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3821,"discussion_content":"è¿˜æ˜¯æŠŠè€å¸ˆè®²çš„ç†è§£é€å½»å§ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯åº”è¯¥æŠŠé˜»å¡å’Œé”å®šåŒºåˆ«å¼€æ¥ï¼šå› ä¸ºèµ„æºè¢«é”äº†ï¼Œæ‰€ä»¥å…¶ä»–Gå†å»é”å®šï¼Œå°±ä¼šè¢«é˜»å¡ï¼Œç­‰å¾…è§£é”æ“ä½œæ¥å”¤é†’ã€‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1564845669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291559,"user_name":"æˆäººä»¥ğŸŸï¼Œä¸å¦‚æˆäººä»¥æ¸”","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1620362438,"is_pvip":true,"replies":[{"id":"105653","content":"1. æˆ‘åˆçœ‹äº†ä¸‹æºç ã€‚è¿™æ˜¯ä¸ºäº†é¿å…â€œè¿­ä»£è¯»é”å®šâ€çš„é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜æœ€ç»ˆä¼šå¯¼è‡´å½“å‰è¯»å†™é”æ°¸ä¸å¯ç”¨ã€‚ä½ æƒ³æƒ³ï¼Œå¦‚æœä¸€ä¸ª goroutine ä¸€ç›´åœ¨ä¸æ–­åœ°è¯»é”å®šåŒä¸€ä¸ªè¯»å†™é”ï¼Œé‚£ä¹ˆæƒ³è¦å†™é”å®šè¿™ä¸ªè¯»å†™é”çš„ goroutine å°±ä¼šæ°¸è¿œé˜»å¡åœ¨é‚£é‡Œã€‚<br><br>2. main goroutine é‡Šæ”¾è¯»é”ä¹‹åï¼Œgoroutine 1 ä¼šé¦–å…ˆå¾—åˆ°å†™é”å®šçš„æœºä¼šã€‚è¿™åŒæ ·æ˜¯ä¸ºäº†é¿å…â€œè¿­ä»£è¯»é”å®šâ€ã€‚å› ä¸ºå¦‚æœå…ˆç»™ goroutine 2 æœºä¼šï¼Œé‚£ goroutine 1 çš„å†™é”å®šä¸æ˜¯è¿˜å¾—ç­‰å—ï¼Ÿè¦çœŸæ˜¯è¿™æ ·çš„è¯ï¼Œå‡å¦‚ main goroutine å’Œ goroutine 1 éƒ½åœ¨ä¸æ–­åœ°è¯•å›¾è¯»é”å®šï¼Œé‚£ä¹ˆ goroutine 2 å°±ä¼šä¸€ç›´é˜»å¡ä¸‹å»ã€‚<br><br>æ‰€ä»¥è¯´ï¼Œå¦‚æœè¿™ä¸ªäº‹æƒ…è®©ä½ çš„ç¨‹åºåœæ»äº†ï¼Œé‚£ä¹ˆä½ å°±è¦æ£€æŸ¥ä¸€ä¸‹ç¨‹åºä¸­æ˜¯ä¸æ˜¯æœ‰â€œè¿­ä»£è¯»é”å®šâ€çš„æƒ…å†µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1620458198,"ip_address":"","comment_id":291559,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18800231622","product_id":100013101,"comment_content":"è€å¸ˆï¼Œéº»çƒ¦åˆ†æä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼šmain goroutine æ‹¿åˆ°è¯»é”ï¼Œæ­¤æ—¶ goroutine 1 è¯•å›¾æ‹¿åˆ°å†™é”ä½†è¢«é˜»å¡ï¼Œç´§æ¥ç€ goroutine 2 è¯•å›¾æ‹¿åˆ°è¯»é”ã€‚æˆ‘æƒ³çŸ¥é“ goroutine 2 ä¸ºä»€ä¹ˆä¹Ÿä¼šè¢«é˜»å¡ï¼Œå¦å¤– main goroutine è¯»é”è¢«é‡Šæ”¾åï¼Œå“ªä¸ª goroutine ä¼šç»§ç»­è¿è¡Œï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519507,"discussion_content":"1. æˆ‘åˆçœ‹äº†ä¸‹æºç ã€‚è¿™æ˜¯ä¸ºäº†é¿å…â€œè¿­ä»£è¯»é”å®šâ€çš„é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜æœ€ç»ˆä¼šå¯¼è‡´å½“å‰è¯»å†™é”æ°¸ä¸å¯ç”¨ã€‚ä½ æƒ³æƒ³ï¼Œå¦‚æœä¸€ä¸ª goroutine ä¸€ç›´åœ¨ä¸æ–­åœ°è¯»é”å®šåŒä¸€ä¸ªè¯»å†™é”ï¼Œé‚£ä¹ˆæƒ³è¦å†™é”å®šè¿™ä¸ªè¯»å†™é”çš„ goroutine å°±ä¼šæ°¸è¿œé˜»å¡åœ¨é‚£é‡Œã€‚\n\n2. main goroutine é‡Šæ”¾è¯»é”ä¹‹åï¼Œgoroutine 1 ä¼šé¦–å…ˆå¾—åˆ°å†™é”å®šçš„æœºä¼šã€‚è¿™åŒæ ·æ˜¯ä¸ºäº†é¿å…â€œè¿­ä»£è¯»é”å®šâ€ã€‚å› ä¸ºå¦‚æœå…ˆç»™ goroutine 2 æœºä¼šï¼Œé‚£ goroutine 1 çš„å†™é”å®šä¸æ˜¯è¿˜å¾—ç­‰å—ï¼Ÿè¦çœŸæ˜¯è¿™æ ·çš„è¯ï¼Œå‡å¦‚ main goroutine å’Œ goroutine 1 éƒ½åœ¨ä¸æ–­åœ°è¯•å›¾è¯»é”å®šï¼Œé‚£ä¹ˆ goroutine 2 å°±ä¼šä¸€ç›´é˜»å¡ä¸‹å»ã€‚\n\næ‰€ä»¥è¯´ï¼Œå¦‚æœè¿™ä¸ªäº‹æƒ…è®©ä½ çš„ç¨‹åºåœæ»äº†ï¼Œé‚£ä¹ˆä½ å°±è¦æ£€æŸ¥ä¸€ä¸‹ç¨‹åºä¸­æ˜¯ä¸æ˜¯æœ‰â€œè¿­ä»£è¯»é”å®šâ€çš„æƒ…å†µã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620458198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1460961,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4a/e1/2a498473.jpg","nickname":"æå¨","note":"","ucode":"3409A9390BD1FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389963,"discussion_content":"è¿™é‡Œçš„â€œè¿­ä»£è¯»é”å®šâ€æ˜¯sync\\rwmutex.goæºç ä¸­çš„recursive read locking","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629541556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2647265,"avatar":"https://static001.geekbang.org/account/avatar/00/28/64/e1/97fba9a0.jpg","nickname":"Jesse Stutler","note":"","ucode":"9E172A6635EB48","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543782,"discussion_content":"ç¿»è¯‘æˆâ€œé¥¥é¥¿â€å¯èƒ½æ›´å¥½ä¸€ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641301683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1650748,"avatar":"https://static001.geekbang.org/account/avatar/00/19/30/3c/0668d6ae.jpg","nickname":"ç›˜èƒ§","note":"","ucode":"5386CC4C92ECC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394242,"discussion_content":"æ˜¯æœ‰ç‚¹ç¿»è¯‘çš„åˆ»æ¿äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631799110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34513,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1082187,"ip_address":"","ucode":"FC323371453C97","user_header":"https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg","comment_is_top":false,"comment_ctime":1540196257,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18720065441","product_id":100013101,"comment_content":"éƒå¤§ å…³äºdemo59è¿™ä¸ªæ¡ˆä¾‹èƒ½å¤§æ¦‚æè¿°ä¸‹å…·ä½“çš„åŠŸèƒ½æµç¨‹å— ä»£ç çœ‹èµ·æ¥æ²¡æœ‰æ–¹å‘æ„Ÿå•Š ","like_count":4,"discussions":[{"author":{"id":1099513,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/f9/caf27bd3.jpg","nickname":"å¤§ç‹å«æˆ‘æ¥å·¡å±±","note":"","ucode":"1B8D0C701BC95E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10879,"discussion_content":"ä½ ä¸æ˜ç™½çš„åªæ˜¯é€šé“çš„é‚£éƒ¨åˆ†ä»£ç ï¼Œé‚£éƒ¨åˆ†ä»£ç åªæ˜¯ä¸ºäº†ä¿è¯ä¸»åç¨‹çš„æœ€åé€€å‡ºï¼Œå¦å¤–å†™æ•°æ®çš„é‚£éƒ¨åˆ†ä»£ç ä½ ä¹Ÿå¯ä»¥ä¸è¦ï¼Œåªç”¨å†™ä¸ªheaderå°±å¥½äº†ï¼Œè¿™æ ·å°±æ¸…æ™°äº†ï¼Œæœ€ç²—æš´çš„åšæ³•å°±æ˜¯æŠŠé€šé“é‚£æ®µä»£ç æ‹¿æ‰ï¼Œç„¶åè®©ä¸»åç¨‹sleep","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568332980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202418,"user_name":"NoTryNoSuccess","can_delete":false,"product_type":"c1","uid":1372735,"ip_address":"","ucode":"89EE8B4CEECC1F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKOM6tVLSiciaQeQst0g3iboWO74ibicicVAia9qno0X6cf65pEKLgdKkUdcpCWpjAB5e6semrFrruiaGQWhg/132","comment_is_top":false,"comment_ctime":1585986035,"is_pvip":false,"replies":[{"id":"75959","content":"äº’æ–¥é”ã€æ¡ä»¶å˜é‡å’ŒåŸå­æ“ä½œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå’ŒCPUæŒ‡ä»¤é›†æ”¯æ’‘çš„ï¼Œæ‰€ä»¥Goè¯­è¨€çš„è¿™äº›åŒæ­¥å·¥å…·æ˜¯å¯ä»¥åœ¨å¤šçº¿ç¨‹ä»¥åŠå¤šæ ¸CPUç”šè‡³å¤šCPUä¸Šæ­£ç¡®æ‰§è¡Œçš„ã€‚æ— éœ€æ‹…å¿ƒã€‚ç›¸åï¼Œè¿™äº›åŒæ­¥å·¥å…·æ°æ°é’ˆå¯¹çš„å°±æ˜¯å¹¶å‘å’Œå¹¶è¡Œçš„åº”ç”¨åœºæ™¯ã€‚è¿™æ­£æ˜¯å®ƒä»¬çš„ç”¨æ­¦ä¹‹åœ°å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1586173951,"ip_address":"","comment_id":202418,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14470887923","product_id":100013101,"comment_content":"è¯·é—®è€å¸ˆï¼Œå¤šæ ¸å¿ƒæ¡ä»¶ä¸‹å¦‚æœä¸¤ä¸ªgoroutineåº•å±‚åŒæ—¶è¿è¡Œåœ¨ä¸¤ä¸ªçº¿ç¨‹ä¸Šï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™ä¸¤ä¸ªgoroutineå®é™…ä¸Šæ˜¯å®Œå…¨å¹¶è¡Œçš„ã€‚æ­¤æ—¶å®ƒä»¬å¦‚æœåŒæ—¶è¿›è¡Œäº’æ–¥é”çš„é”å®šæ“ä½œï¼ˆéšåå¯èƒ½åŒæ—¶å¯¹åŒä¸€èµ„æºè¿›è¡Œå†™æ“ä½œï¼‰å²‚ä¸æ˜¯ä¸èƒ½è¾¾åˆ°å¯¹ä¸´ç•ŒåŒºçš„ä¿æŠ¤ç›®çš„äº†å—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490578,"discussion_content":"äº’æ–¥é”ã€æ¡ä»¶å˜é‡å’ŒåŸå­æ“ä½œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå’ŒCPUæŒ‡ä»¤é›†æ”¯æ’‘çš„ï¼Œæ‰€ä»¥Goè¯­è¨€çš„è¿™äº›åŒæ­¥å·¥å…·æ˜¯å¯ä»¥åœ¨å¤šçº¿ç¨‹ä»¥åŠå¤šæ ¸CPUç”šè‡³å¤šCPUä¸Šæ­£ç¡®æ‰§è¡Œçš„ã€‚æ— éœ€æ‹…å¿ƒã€‚ç›¸åï¼Œè¿™äº›åŒæ­¥å·¥å…·æ°æ°é’ˆå¯¹çš„å°±æ˜¯å¹¶å‘å’Œå¹¶è¡Œçš„åº”ç”¨åœºæ™¯ã€‚è¿™æ­£æ˜¯å®ƒä»¬çš„ç”¨æ­¦ä¹‹åœ°å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586173951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1199601,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4d/f1/a56fefba.jpg","nickname":"bin","note":"","ucode":"B5AC8B5993AB76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273475,"discussion_content":"è€å¸ˆï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼çš„å‘¢ï¼Ÿä¹Ÿèƒ½è¾¾åˆ°é”å®šæ•ˆæœå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590460047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1199601,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4d/f1/a56fefba.jpg","nickname":"bin","note":"","ucode":"B5AC8B5993AB76","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362835,"discussion_content":"â€¦â€¦åˆ†å¸ƒå¼è‚¯å®šç”¨åˆ†å¸ƒå¼é”å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617035859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":273475,"ip_address":""},"score":362835,"extra":""}]}]},{"had_liked":false,"id":200626,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1585626061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14470527949","product_id":100013101,"comment_content":"ä»Šæ—¥æ€»ç»“<br>ä»Šå¤©ä¸»è¦æ˜¯è®²äº† å…³äºå¹¶å‘åŒæ­¥é—®é¢˜<br>ä¸¤ç§æ–¹å¼<br>1. äº’æ–¥é” sync&#47;Mutex<br>   ä¿è¯ä»–ä»¬å¯¹åŒä¸€ä¸ªä¸´ç•ŒåŒºçš„è®¿é—®æ˜¯ä¸²è¡Œçš„<br>2. è¯»å†™é” <br>   åˆ†ä¸ºè¯»é”å’Œå†™é”<br>   å½“è¯»å†™é”å®šæ—¶ ä»»ä½•å°è¯•çš„å†™çš„é”éƒ½ä¼šè¢«é˜»å¡ è€Œå…¶ä»–çš„è¯»å´ä¸ä¼š åŸå› åœ¨äºå†™çš„æ—¶å€™ä¼šæ”¹å˜å†…å­˜åŒºåŸŸçš„æ•°æ®<br> å½“å†™é”é”å®šæ—¶ æ— è®ºæ˜¯è¯»è¿˜æ˜¯å†™åŠ é”éƒ½ä¼šé˜»å¡  åŸå› åŒä¸Š<br>å½“å†™é”è¿›è¡Œè§£é”æ—¶ ä¼šå”¤é†’æ‰€æœ‰è¯»é”é˜»å¡çš„goroutine <br>è€Œè¯»é”è§£é”æ—¶ ä¼šå”¤é†’æŸä¸€ä¸ªå†™é” å…·ä½“æ˜¯å“ªä¸€ä¸ªå†™é” å°±çœ‹é‚£ä¸ªå†™é”ç­‰å¾…çš„äº‹ä»¶æœ€é•¿<br>å°¤å…¶è¦æ³¨æ„ <br>ä¸€ä¸ªé”åº”è¯¥åªä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºåŸŸ<br>ä¸è¦å°è¯•é‡å¤é”å®š(æœ‰å¯èƒ½ä¼šå¯¼è‡´æ­»é”) å¼•å‘ç³»ç»Ÿè¿è¡Œæ—¶è‡ªåŠ¨çš„panic å¹¶ä¸”è¿™ä¸ªpanicæ— æ³•è¢«æ¢å¤<br>ä¸è¦å¯¹æœªåŠ é”çš„é”è¿›è¡Œ ä¼šå¼•å‘panic å¹¶ä¸”æ— æ³•æ¢å¤<br>ä¸è¦ä¼ é€’é” å› ä¸ºé”æ—¶ç»“æ„ä½“ç±»å‹ ä¼ é€’æ—¶ æ˜¯å€¼ä¼ é€’ ä¼šäº§ç”Ÿå¾ˆå¤šå‰¯æœ¬ å¯¼è‡´ é”ä¸æ˜¯ä¸€ä¸ªé”äº†<br>ä¸€å®šè¦é‡Šæ”¾é” æœ€å¥½çš„åŠæ³•è¿˜æ˜¯ deferè¯­å¥è§£é” åŠ é”å’Œè§£é”è¯­å¥æˆå¯¹å‡ºç°<br>å…³äºæ€è€ƒé¢˜<br>Lockæ¥å£<br>2func (rw *RWMutex) RLocker() Locker","like_count":3},{"had_liked":false,"id":172410,"user_name":"CcczzZ","can_delete":false,"product_type":"c1","uid":1019568,"ip_address":"","ucode":"5F46DA5053D2BB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","comment_is_top":false,"comment_ctime":1579171703,"is_pvip":false,"replies":[{"id":"66904","content":"ç®€å•ä¸€å¥è¯ï¼šè¯»å†™é”ä¸­çš„è¯»é”é”å®šæ“ä½œä¹‹é—´æ˜¯ä¸äº’æ–¥çš„ã€‚å¦å¤–ï¼Œå¯¹äºè¯»å†™é”ï¼Œè¯»é”é”å®šæ“ä½œä¼šä¸å†™é”é”å®šæ“ä½œäº’æ–¥ï¼Œå†™é”é”å®šæ“ä½œä¹‹é—´ä¹Ÿä¼šäº’æ–¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1579228427,"ip_address":"","comment_id":172410,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14464073591","product_id":100013101,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œæ–‡ä¸­è¯´çš„è¿™å¥ï¼šã€Œå¯¹è¯»é”è¿›è¡Œè§£é”ï¼Œåªä¼šåœ¨æ²¡æœ‰å…¶ä»–è¯»é”é”å®šçš„å‰æä¸‹ï¼Œå”¤é†’â€œå› è¯•å›¾é”å®šå†™é”ï¼Œè€Œè¢«é˜»å¡çš„ goroutineâ€ã€ã€‚<br>æˆ‘çš„ç†è§£æ˜¯ï¼Œå¯¹è¯»é”è¿›è¡Œè§£é”æ—¶ï¼Œæ­¤åˆ»è‹¥å­˜åœ¨å…¶ä»–è¯»é”ç­‰å¾…çš„è¯ï¼Œæ˜¯ä¼šä¼˜å…ˆå”¤é†’è¯»é”çš„ï¼Œå¦‚æœä¸å­˜åœ¨å…¶ä»–ç­‰å¾…çš„è¯»é”ï¼Œæ‰ä¼šå”¤é†’å†™é”ã€‚ä¸çŸ¥é“è¿™æ ·ç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿ<br><br>è€ŒåŸºäºä¸Šé¢çš„ç†è§£ï¼Œæˆ‘å†™äº†æ®µä»£ç æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ç»“æœå¹¶ä¸æ˜¯è¿™æ ·ï¼Œå®é™…æƒ…å†µæ˜¯ï¼šã€Œå½“è¯»é”è¿›è¡Œè§£é”æ—¶ï¼Œè‹¥æ­¤åˆ»å­˜åœ¨å…¶ä»–çš„è¯»é”å’Œå†™é”ï¼Œä¼šæ ¹æ®ä»–ä»¬å®é™…é˜»å¡ç­‰å¾…çš„æ—¶é—´é•¿çŸ­ï¼Œä¼˜å…ˆå”¤é†’å¹¶æ‰§è¡Œã€<br>å°±åƒä¸‹é¢ï¼Œå†™é”åœ¨å‰é¢æ‰§è¡Œï¼Œç­‰å¾…çš„æ—¶é—´ä¹Ÿæ¯”è¯»é”åœºï¼Œæ‰€ä»¥å½“è¯»é”è§£é”æ—¶ï¼Œä¼˜å…ˆå”¤é†’çš„æ˜¯ç­‰å¾…æ—¶é—´è¾ƒé•¿çš„å†™é”ã€‚<br><br>func main() {<br><br>    var rwMu sync.RWMutex<br><br>    &#47;&#47; æ¨¡æ‹Ÿå¤šä¸ªå†™&#47;è¯»é”è¿›è¡Œé˜»å¡ï¼Œå½“é‡Šæ”¾è¯»é”çš„æ—¶å€™çœ‹è°å…ˆè·å–åˆ°é”ï¼ˆä¼šåœ¨æ²¡æœ‰å…¶ä»–è¯»é”çš„æ—¶å€™ï¼Œå”¤é†’å†™é”ï¼‰<br><br>    rwMu.RLock()<br>    fmt.Println(&quot;start RLock&quot;)<br><br>    &#47;&#47; å†™<br>    go func() {<br>        defer func() {<br>            rwMu.Unlock()<br>            fmt.Println(&quot;get UnLock&quot;)<br>        }()<br>        rwMu.Lock()<br>        fmt.Println(&quot;get Lock&quot;)<br>    }()<br>    time.Sleep(time.Millisecond * 200)<br><br>    &#47;&#47; è¯»<br>    go func() {<br>        defer func() {<br>            rwMu.RUnlock()<br>            fmt.Println(&quot;get RUnLock&quot;)<br>        }()<br>        rwMu.RLock()<br>        fmt.Println(&quot;get RLock&quot;)<br>    }()<br>    time.Sleep(time.Millisecond * 200)<br><br>    rwMu.RUnlock()<br>    fmt.Println(&quot;start RUnLock&quot;)<br>    time.Sleep(time.Second * 1)<br>}<br><br>è¿è¡Œç»“æœï¼ˆç­‰å¾…æ—¶é—´è¾ƒé•¿çš„å†™æ“ä½œå…ˆæ‰§è¡Œäº†ï¼‰ï¼š<br>start RLock<br>start RUnLock<br>get Lock<br>get UnLock<br>get RLock<br>get RUnLock","like_count":3,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481734,"discussion_content":"ç®€å•ä¸€å¥è¯ï¼šè¯»å†™é”ä¸­çš„è¯»é”é”å®šæ“ä½œä¹‹é—´æ˜¯ä¸äº’æ–¥çš„ã€‚å¦å¤–ï¼Œå¯¹äºè¯»å†™é”ï¼Œè¯»é”é”å®šæ“ä½œä¼šä¸å†™é”é”å®šæ“ä½œäº’æ–¥ï¼Œå†™é”é”å®šæ“ä½œä¹‹é—´ä¹Ÿä¼šäº’æ–¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579228427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019568,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","nickname":"CcczzZ","note":"","ucode":"5F46DA5053D2BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":137064,"discussion_content":"æˆ‘å¤§æ¦‚çŸ¥é“é—®é¢˜åœ¨å“ªé‡Œäº†ğŸ˜‚ å¿˜äº†ä¸‹é¢è¿™ä¸ªçŸ¥è¯†ç‚¹\n\nè¯»å†™é”ï¼Œå½“æœ‰è¯»é”æ—¶ï¼Œå…¶ä»–è¯»é”æ­¤æ—¶å¹¶ä¸ä¼šè¢«é˜»å¡ï¼","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1579177067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1193874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","nickname":"æˆäººä»¥ğŸŸï¼Œä¸å¦‚æˆäººä»¥æ¸”","note":"","ucode":"BD53829E924B66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372516,"discussion_content":"CcczzZï¼Œä½ ä¸Šé¢è´´å‡ºæ¥çš„ä»£ç æ˜¯æ²¡é—®é¢˜çš„ï¼åŸå› æ˜¯ï¼šLock() å…ˆäº RLock() æ‰§è¡Œï¼Œæ­¤æ—¶ ä¸¤ä¸ªç”¨æˆ· goroutine éƒ½ä¼šè¢«é˜»å¡ã€‚é‚£å¦‚æœä½ æŠŠ å†™å’Œè¯»çš„  goroutine äº¤æ¢ä½ç½®ï¼Œç»“æœçš„è¾“å‡ºå°±ä¼šä¸åŒã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620362063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38593,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1542078731,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14426980619","product_id":100013101,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹å¤šåç¨‹å¹¶å‘æƒ…å†µæ€ä¹ˆè°ƒè¯•æ—¥å¿—ï¼Œgoogleå®˜æ–¹ä¼¼ä¹ä¹Ÿä¸æ¨èæˆ‘ä»¬åœ¨æ—¥å¿—ä¸­æŠŠåç¨‹å·æ‰“å°å‡ºæ¥ï¼Œåªèƒ½é€šè¿‡æ·»åŠ å”¯ä¸€åºåˆ—å·è¯†åˆ«å—","like_count":3,"discussions":[{"author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3822,"discussion_content":"åç¨‹å·æ‰“å°å‡ºæ¥æ²¡å•¥æ„ä¹‰å§ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564845769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173128,"user_name":"Geek_b5876e","can_delete":false,"product_type":"c1","uid":1649594,"ip_address":"","ucode":"DE272DE44DCF03","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK66wjYZxVSnSJ33hbBCzSgHXsyQia8JrvJvibeH6Fcficu1lx83K0gzc3lpcxYllqH9ficibqanqKWGrA/132","comment_is_top":false,"comment_ctime":1579429367,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10169363959","product_id":100013101,"comment_content":"é€šè¿‡straceè§‚å¯Ÿäº†ä¸€ä¸‹é”çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå‘ç°äº† futex ï¼Œgo è¯­è¨€é”çš„å®ç°ä¹Ÿæ˜¯ä¾èµ–äºæ“ä½œç³»ç»ŸåŸè¯­å’Œä¿¡å·é‡çš„","like_count":2},{"had_liked":false,"id":133041,"user_name":"å¤§ç‹å«æˆ‘æ¥å·¡å±±","can_delete":false,"product_type":"c1","uid":1099513,"ip_address":"","ucode":"1B8D0C701BC95E","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/f9/caf27bd3.jpg","comment_is_top":false,"comment_ctime":1568334281,"is_pvip":false,"replies":[{"id":"51014","content":"å¯¹äºéç¼“å†²é€šé“ï¼Œå†™çš„ goroutine å¿…ç„¶ä¼šå…ˆå®Œæˆæ“ä½œã€‚é”æœ¬èº«åªä¿è¯äº’æ–¥ã€‚è¢«é˜»å¡çš„ goroutine ä¹Ÿä¼šæœ‰å…ˆæœ‰åï¼Œä½†ä¼šæ ¹æ®è¢«é˜»å¡é‚£ä¸€åˆ»çš„å…ˆåï¼Œè€Œä¸æ˜¯ä»€ä¹ˆè¯»å†™çš„å…ˆåã€‚<br><br>å¦å¤–äº’æ–¥é”è·ŸåŸå­æ“ä½œæœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œä¸è¦ææ··ã€‚<br><br>å†å¦å¤–ï¼Œgoroutine ä¸åç¨‹ä¹Ÿæœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œä¸è¦ææ··ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1568437840,"ip_address":"","comment_id":133041,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10158268873","product_id":100013101,"comment_content":"éœ€è¦è¯·æ•™è€å¸ˆçš„æ˜¯ï¼Œä¸»åç¨‹æ”¶åˆ°ä¿¡å·å°±è¢«å”¤é†’äº†ï¼Œè®¤ä¸ºå¯ä»¥è¯»äº†ï¼Œä½†æ˜¯è¢«é˜»å¡çš„å†™åç¨‹æ”¶åˆ°é”é‡Šæ”¾çš„æ¶ˆæ¯ä¼šä¸ä¼šæ¯”ä¸»åç¨‹è¦æ—©ï¼Œç„¶åç»§ç»­è·å¾—å†™çš„æœºä¼šï¼Œä¸»åç¨‹ä¼šä¸ä¼šè¢«é˜»å¡ï¼Ÿæˆ‘è®¤ä¸ºæ˜¯ä¸ä¼šçš„ï¼Œæ­¤å¤„çš„é”åªæ˜¯ä¿è¯äº†ä¸åŒå†™åç¨‹äº’æ–¥çš„å†™å…¥ï¼Œä¹Ÿå°±æ˜¯å†™æ“ä½œæ˜¯åŸå­çš„ï¼Œä½†æ˜¯å¹¶ä¸ä¿è¯è¯»æ“ä½œä¸€å®šåœ¨å†™å®Œåå°±è¯»å§","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467234,"discussion_content":"å¯¹äºéç¼“å†²é€šé“ï¼Œå†™çš„ goroutine å¿…ç„¶ä¼šå…ˆå®Œæˆæ“ä½œã€‚é”æœ¬èº«åªä¿è¯äº’æ–¥ã€‚è¢«é˜»å¡çš„ goroutine ä¹Ÿä¼šæœ‰å…ˆæœ‰åï¼Œä½†ä¼šæ ¹æ®è¢«é˜»å¡é‚£ä¸€åˆ»çš„å…ˆåï¼Œè€Œä¸æ˜¯ä»€ä¹ˆè¯»å†™çš„å…ˆåã€‚\n\nå¦å¤–äº’æ–¥é”è·ŸåŸå­æ“ä½œæœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œä¸è¦ææ··ã€‚\n\nå†å¦å¤–ï¼Œgoroutine ä¸åç¨‹ä¹Ÿæœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œä¸è¦ææ··ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568437840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099513,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/f9/caf27bd3.jpg","nickname":"å¤§ç‹å«æˆ‘æ¥å·¡å±±","note":"","ucode":"1B8D0C701BC95E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":11864,"discussion_content":"è°¢è°¢è€å¸ˆï¼Œçœ‹æ˜ç™½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568437916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120378,"user_name":"èŠå£«è€çˆ¹","can_delete":false,"product_type":"c1","uid":1071316,"ip_address":"","ucode":"5F2935967574D0","user_header":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","comment_is_top":false,"comment_ctime":1564849040,"is_pvip":false,"replies":[{"id":"44306","content":"é‚£è¦çœ‹è°å…ˆç­‰å¾…äº†ï¼Œè¿™é‡Œçš„ç­‰å¾…é˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡ºçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1564973131,"ip_address":"","comment_id":120378,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10154783632","product_id":100013101,"comment_content":"å¦‚æœä¸€ç›´æœ‰æ–°çš„è¯»é”è¯·æ±‚ï¼Œä¼šä¸ä¼šå¯¼è‡´å†™é”é”ä¸äº†ï¼Ÿ<br>è¿˜æ˜¯è¯´å¦‚æœæœ‰äº†ä¸€ä¸ªwlocké”è¯·æ±‚äº†ï¼Œç°åœ¨å› ä¸ºæœ‰rlockæœªé‡Šæ”¾é”ï¼Œwlockçš„åç¨‹è¢«é˜»å¡ï¼Œåé¢å†æœ‰æ–°çš„rlocké”è¯·æ±‚ä¹Ÿä¼šå…ˆè¢«é˜»å¡ï¼Œç­‰å¾…wlocké”åç¨‹å…ˆæ¢å¤ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461307,"discussion_content":"é‚£è¦çœ‹è°å…ˆç­‰å¾…äº†ï¼Œè¿™é‡Œçš„ç­‰å¾…é˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡ºçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564973131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008348,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/dc/8876c73b.jpg","nickname":"moooofly","note":"","ucode":"4A20795C281B6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7950,"discussion_content":"ä¸Šé¢çš„è¯»è€…çš„é—®é¢˜åº”è¯¥æ˜¯è¯´ï¼šå½“å‰å¤„äº rlock é”å®šçŠ¶æ€ï¼Œä¹‹åæœ‰æ¥äº†ä¸€ä¸ª wlock ï¼Œå¦‚æœè¿™æ—¶å†æ¥ä¸€ä¸ªæˆ– N ä¸ª rlock ä¸Šé”ï¼Œé‚£ä¹ˆå½“ç¬¬ä¸€ä¸ª rlock è¢«è§£é”æ—¶ï¼Œæ˜¯ wlock è¢«å”¤é†’ï¼Œè¿˜æ˜¯ç”±äºæœ‰æ–°çš„ rlock å­˜åœ¨çš„åŸå› ï¼Œå¯¼è‡´ wlock ä»æ—§æ— æ³•è¢«å”¤é†’ï¼›\n\næŒ‰ç…§ä½œè€…çš„æ–‡ç« ä¸­çš„è¯´æ³•ï¼Œæˆ‘è§‰å¾—åº”è¯¥æ˜¯åªè¦å½“ rlock è¢«è§£é”æ—¶ï¼Œå‘ç°ä»æ—§å­˜åœ¨å…¶ä»– rlock ï¼Œé‚£ä¹ˆ wlock å°±æ— æ³•è¢«å”¤é†’ï¼›å› ä¸º rlock å¹¶ä¸ä¼šé˜»å¡å…¶ä»– rlock ï¼Œå› æ­¤ rlock æ—¶æ²¡æœ‰æ’é˜Ÿæ¦‚å¿µçš„ï¼Œè€Œ wlock ä¼šé˜»å¡å…¶ä»– wlock ï¼Œæ‰€ä»¥æœ‰æ’é˜Ÿæ¦‚å¿µï¼›","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1567736793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008348,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/dc/8876c73b.jpg","nickname":"moooofly","note":"","ucode":"4A20795C281B6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7944,"discussion_content":"&#34;å¯¹è¯»é”è¿›è¡Œè§£é”ï¼Œåªä¼šåœ¨æ²¡æœ‰å…¶ä»–è¯»é”é”å®šçš„å‰æä¸‹ï¼Œå”¤é†’â€œå› è¯•å›¾é”å®šå†™é”ï¼Œè€Œè¢«é˜»å¡çš„ goroutineâ€ï¼›å¹¶ä¸”ï¼Œæœ€ç»ˆåªä¼šæœ‰ä¸€ä¸ªè¢«å”¤é†’çš„ goroutine èƒ½å¤ŸæˆåŠŸå®Œæˆå¯¹å†™é”çš„é”å®šï¼Œå…¶ä»–çš„ goroutine è¿˜è¦åœ¨åŸå¤„ç»§ç»­ç­‰å¾…ã€‚è‡³äºæ˜¯å“ªä¸€ä¸ª goroutineï¼Œé‚£å°±è¦çœ‹è°çš„ç­‰å¾…æ—¶é—´æœ€é•¿äº†ã€‚&#34;--æˆ‘å¯¹ä¸Šé¢è¿™æ®µè¯çš„ç†è§£æ˜¯ï¼šå¦‚æœå­˜åœ¨ N ä¸ª rlock å¤„äºé”å®šçŠ¶æ€ï¼ˆN>1ï¼‰ï¼Œå¹¶ä¸”å­˜åœ¨ M ä¸ª wlock å¤„äºé”å®šçŠ¶æ€ï¼ˆM>1ï¼‰ï¼Œåˆ™å¯¹ä¸€ä¸ª rlock è§£é”ï¼Œæ— æ³•å”¤é†’å…¶ä»– wlock ï¼Œåªæœ‰ N ä¸ª rlock éƒ½è¢«è§£é”åï¼Œwlock æ‰ä¼šè¢«å”¤é†’ï¼Œå¹¶ä¸” wlock çš„å”¤é†’é¡ºåºæ˜¯çœ‹å…¶åœ¨é˜Ÿåˆ—ä¸­çš„é¡ºåºçš„ï¼Œå…ˆè¿›çš„å…ˆå”¤é†’ï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567736463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99696,"user_name":"soooldier","can_delete":false,"product_type":"c1","uid":1000746,"ip_address":"","ucode":"04EC4C01DD06FD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/45/2a/c4413de4.jpg","comment_is_top":false,"comment_ctime":1559281654,"is_pvip":false,"replies":[{"id":"35823","content":"çœ‹è¿™é‡Œå§ï¼šhttps:&#47;&#47;github.com&#47;hyper0x&#47;Golang_Puzzlers&#47;tree&#47;master&#47;src&#47;puzzlers&#47;article22<br><br>ä½ å¯ä»¥æŠŠè¿™é‡Œçš„ article ç†è§£æˆ topicã€‚ä¸€äº›æ¯”è¾ƒé•¿çš„ topic å¯èƒ½ä¼šè¢«ç¼–è¾‘æ‹†åˆ†ä¸ºå¤šç¯‡æ–‡ç« ï¼Œæ‰€ä»¥å°±å‡ºç°äº†è¿™ç§æƒ…å†µã€‚å¤ªé•¿çš„æ–‡ç« å¯¹è¯»è€…ä»¬ä¸å¤ªå‹å¥½ï¼Œä¸å®¹æ˜“é›†ä¸­ç²¾åŠ›è¯»ä¸‹å»ã€‚<br><br>ä½ å¯ä»¥å¯¹ç…§ç€ä¸“æ çš„ç›®å½•ï¼ŒæŒ‰ç…§ä¸»é¢˜ï¼Œæ‰¾ä¸€ä¸‹å¯¹åº”çš„ articleXX ç›®å½•ã€‚<br><br>Update:<br>æˆ‘åˆšåˆšæ·»åŠ äº†ä¸€ä¸ªåºå·æ˜ å°„è¡¨ï¼šhttps:&#47;&#47;github.com&#47;hyper0x&#47;Golang_Puzzlers&#47;blob&#47;master&#47;mapping_table.md ã€‚ä½ ç”¨è¿™ä¸ªå°±å¯ä»¥æ–¹ä¾¿åœ°å¯¹ç…§äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1559292144,"ip_address":"","comment_id":99696,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10149216246","product_id":100013101,"comment_content":"é…å¥—ä»£ç é‡Œpuzzlers&#47;article26ä¸‹å¹¶æ²¡æœ‰demo58.goï¼Œä¹Ÿæ²¡æœ‰demo59.goï¼Œæ‡µåœˆä¸­ã€‚ã€‚ã€‚","like_count":2,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452229,"discussion_content":"çœ‹è¿™é‡Œå§ï¼šhttps://github.com/hyper0x/Golang_Puzzlers/tree/master/src/puzzlers/article22\n\nä½ å¯ä»¥æŠŠè¿™é‡Œçš„ article ç†è§£æˆ topicã€‚ä¸€äº›æ¯”è¾ƒé•¿çš„ topic å¯èƒ½ä¼šè¢«ç¼–è¾‘æ‹†åˆ†ä¸ºå¤šç¯‡æ–‡ç« ï¼Œæ‰€ä»¥å°±å‡ºç°äº†è¿™ç§æƒ…å†µã€‚å¤ªé•¿çš„æ–‡ç« å¯¹è¯»è€…ä»¬ä¸å¤ªå‹å¥½ï¼Œä¸å®¹æ˜“é›†ä¸­ç²¾åŠ›è¯»ä¸‹å»ã€‚\n\nä½ å¯ä»¥å¯¹ç…§ç€ä¸“æ çš„ç›®å½•ï¼ŒæŒ‰ç…§ä¸»é¢˜ï¼Œæ‰¾ä¸€ä¸‹å¯¹åº”çš„ articleXX ç›®å½•ã€‚\n\nUpdate:\næˆ‘åˆšåˆšæ·»åŠ äº†ä¸€ä¸ªåºå·æ˜ å°„è¡¨ï¼šhttps://github.com/hyper0x/Golang_Puzzlers/blob/master/mapping_table.md ã€‚ä½ ç”¨è¿™ä¸ªå°±å¯ä»¥æ–¹ä¾¿åœ°å¯¹ç…§äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559292144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32472,"user_name":"timmy21","can_delete":false,"product_type":"c1","uid":1174860,"ip_address":"","ucode":"9D6DED247B1F38","user_header":"https://static001.geekbang.org/account/avatar/00/11/ed/4c/8674b6ad.jpg","comment_is_top":false,"comment_ctime":1539584182,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10129518774","product_id":100013101,"comment_content":"éƒè€å¸ˆï¼Œä¹‹å‰é—®äº†ä¸€ä¸ªæ˜¯å¦éœ€è¦ä¸Šé”çš„é—®é¢˜ã€‚æœ‰ä¸€ä¸ªç»†èŠ‚æˆ‘å¿˜è¯´äº†ï¼Œä¸€ä¸ªå†™è€…ï¼Œä¸€ä¸ªè¯»è€…ï¼Œå¹¶ä¸”â€œè¯»è€…â€è¯»å–å˜é‡æ—¶ä¸éœ€è¦ä¿è¯è¿”å›æœ€æ–°å€¼ã€‚è¿™ç§åœºæ™¯ä¸‹æ˜¯å¦å¯ä»¥ä¸ä¸Šé”ï¼Ÿæˆ–è€…ä¸ä¸Šé”ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿä¼španicå—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1417824,"avatar":"https://static001.geekbang.org/account/avatar/00/15/a2/60/f3939ab4.jpg","nickname":"å“ˆå“¼","note":"","ucode":"C1108406573D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12360,"discussion_content":"çœ‹ä¸šåŠ¡é€»è¾‘ï¼Œä½ è¿™ä¸ªåœºæ™¯ï¼Œå¯ä»¥ä¸ç”¨é”ã€‚\nå¦‚æœæ˜¯æ“ä½œå¾ˆå¤šä¸ªå˜é‡ï¼Œä¸€åŠæ–°ï¼Œä¸€åŠæ—§ä¼šå¼•å‘ä¸šåŠ¡é€»è¾‘é—®é¢˜ï¼Œæ¯”å¦‚è½¬è´¦ç»“ç®—ï¼Œé‚£ä¸€å®šè¦é”ã€‚\nå¦‚æœæ˜¯é‚£ç§å‘¨æœŸæ€§åŠ¨ä½œï¼Œä¸€æ¬¡æœ‰é—®é¢˜ï¼Œä¸‹ä¸€æ¬¡èƒ½ä¿®å¤ï¼Œå¯ä»¥ä¸åŠ é”ï¼Œä½†æœ€å¥½åŠ ä¸‹ï¼Œå¿ƒé‡Œè´Ÿæ‹…å°ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568525102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1202828,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5a/8c/cee414db.jpg","nickname":"å‡¯","note":"","ucode":"4CA509DA58B3A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7258,"discussion_content":"æ˜¯å¦å¯ä»¥è¯»å†™åˆ†ç¦»ï¼Œè¯»æ“ä½œ-->å†™é”-->å†™-->è§£å†™é”ï¼Œè¿™è²Œä¼¼å¯ä»¥ç›´æ¥ç”¨äº’æ–¥é”ï¼Œä¸éœ€è¦ç”¨åˆ°è¯»å†™é”ã€‚æŒ‰æˆ‘çš„ç†è§£ï¼Œè¯»å†™é”åº”è¯¥æ˜¯ä¸ºäº†åœ¨äº’æ–¥é”çš„åŸºç¡€ä¸Šä¸ºäº†ä½¿é”çš„æ—¶é—´å˜çŸ­ï¼Œå¹¶ä¸”å¯ä»¥ä¿è¯è¯»åˆ°çš„éƒ½æ˜¯æœ€æ–°æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567436103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195489,"user_name":"ç»™åŠ›","can_delete":false,"product_type":"c1","uid":1113645,"ip_address":"","ucode":"646EE4AFC17224","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/2d/2c9177ca.jpg","comment_is_top":false,"comment_ctime":1585191263,"is_pvip":false,"replies":[{"id":"74284","content":"sema å®é™…ä¸Šä»£è¡¨ç€åŸºäºå†…å­˜åœ°å€çš„é”æœºåˆ¶ã€‚ç›¸å…³çš„ä»£ç åœ¨ sync åŒ…çš„ runtime.go æ–‡ä»¶å’Œ runtime åŒ…çš„ seme.go æ–‡ä»¶ä¸­ã€‚ä½ æœ‰å…´è¶£çš„è¯å¯ä»¥çœ‹ä¸€çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1585194719,"ip_address":"","comment_id":195489,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880158559","product_id":100013101,"comment_content":"å¯¹äºä½¿ç”¨é”æœ‰ä¸ªç–‘é—®ï¼š<br>type Mutex struct {<br>\tstate int32<br>\tsema  uint32<br>}<br>stateè¡¨ç¤ºé”çš„ä¸€ä¸ªçŠ¶æ€<br><br>semaè¿™ä¸ªå˜é‡æ²¡å¤ªç†æ¸…æ˜¯åšä»€ä¹ˆçš„ï¼Ÿä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨","like_count":1,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489089,"discussion_content":"sema å®é™…ä¸Šä»£è¡¨ç€åŸºäºå†…å­˜åœ°å€çš„é”æœºåˆ¶ã€‚ç›¸å…³çš„ä»£ç åœ¨ sync åŒ…çš„ runtime.go æ–‡ä»¶å’Œ runtime åŒ…çš„ seme.go æ–‡ä»¶ä¸­ã€‚ä½ æœ‰å…´è¶£çš„è¯å¯ä»¥çœ‹ä¸€çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585194719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37473,"user_name":"jacke","can_delete":false,"product_type":"c1","uid":1161209,"ip_address":"","ucode":"05F355E1FF88C5","user_header":"https://static001.geekbang.org/account/avatar/00/11/b7/f9/a8f26b10.jpg","comment_is_top":false,"comment_ctime":1541600414,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5836567710","product_id":100013101,"comment_content":"é—®ä¸‹è€å¸ˆ,è¯»å†™é”è§£é”éƒ¨åˆ†æœ‰ç‚¹ä¸æ˜ç™½ï¼šå†™é”è§£é”çš„æ—¶å€™å¦‚æœåŒæ—¶æœ‰å†™é”å’Œè¯»é”åœ¨ç­‰å¾…ï¼Œæ˜¯ä¼˜å…ˆå”¤é†’è¯»é”æ˜¯æŠŠï¼Ÿ<br>è¿™ä¸ªè§„å®šå¯¹è¯»é”è§£é”ä¹Ÿé€‚ç”¨æ˜¯æŠŠ?","like_count":1,"discussions":[{"author":{"id":1019568,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","nickname":"CcczzZ","note":"","ucode":"5F46DA5053D2BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":136881,"discussion_content":"å¯¹ï¼Œé€‚ç”¨çš„ï¼Œå¯ä»¥å†™ä»£ç è¯•ä¸€ä¸‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579170184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356400,"user_name":"é»„ä»²è¾‰","can_delete":false,"product_type":"c1","uid":1593521,"ip_address":"åŒ—äº¬","ucode":"D7EB3C3ADD99DA","user_header":"https://static001.geekbang.org/account/avatar/00/18/50/b1/7b701518.jpg","comment_is_top":false,"comment_ctime":1662266796,"is_pvip":false,"replies":[{"id":"129765","content":"å¯é‡å…¥é”ç›¸å½“äºä¸€ä¸ªè¯­æ³•ç³–ã€‚å®ƒåœ¨å¾ˆå¤šæ—¶å€™ä¼šæ©ç›–åº”ç”¨ç¨‹åºç¼–å†™ä¸Šçš„é—®é¢˜ï¼Œä»ç¨‹åºè®¾è®¡çš„è§’åº¦è®²ä¼šèµ·åˆ°ä¸å¥½çš„ä½œç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1662345918,"ip_address":"åŒ—äº¬","comment_id":356400,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662266796","product_id":100013101,"comment_content":"åŒä¸€ä¸ªgoroutineä¹Ÿä¸èƒ½å¤šæ¬¡æ‰§è¡Œä¸€ä¸ªmutexçš„lockï¼Œè¿™æ˜¯ä¸å¯é‡å…¥é”ï¼Œgoä¸ºä½•æ²¡æœ‰åŸç”Ÿå®ç°å¯é‡å…¥é”ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586563,"discussion_content":"å¯é‡å…¥é”ç›¸å½“äºä¸€ä¸ªè¯­æ³•ç³–ã€‚å®ƒåœ¨å¾ˆå¤šæ—¶å€™ä¼šæ©ç›–åº”ç”¨ç¨‹åºç¼–å†™ä¸Šçš„é—®é¢˜ï¼Œä»ç¨‹åºè®¾è®¡çš„è§’åº¦è®²ä¼šèµ·åˆ°ä¸å¥½çš„ä½œç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662345918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350898,"user_name":"MClink","can_delete":false,"product_type":"c1","uid":1435733,"ip_address":"","ucode":"F479190923355C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","comment_is_top":false,"comment_ctime":1657298055,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657298055","product_id":100013101,"comment_content":"ä¸´ç•ŒåŒºç«äº‰çš„ä¾‹å­<br>package main<br><br>import (<br>\t&quot;fmt&quot;<br>\t&quot;sync&quot;<br>)<br><br>func main() {<br>\taddWithLock()<br>\taddWithNotLock()<br>}<br><br>func addWithNotLock() {<br>\tvar count int<br>\tvar wg sync.WaitGroup<br>\twg.Add(10) &#47;&#47;æ·»åŠ 10ä¸ªç­‰å¾…<br>\tfor i := 0; i &lt; 10; i++ {<br>\t\tgo func() {<br>\t\t\tdefer wg.Done() &#47;&#47;æ‰§è¡Œå®Œä¸€ä¸ªåç¨‹å»æ‰ä¸€ä¸ªç­‰å¾…<br>\t\t\t&#47;&#47;å¯¹countè¿›è¡Œ10ä¸‡æ¬¡åŠ 1<br>\t\t\tfor j := 0; j &lt; 100000; j++ {<br>\t\t\t\tcount++ &#47;&#47;æ­¤å¤„ä¸ºä¸´ç•ŒåŒºåŸŸ<br>\t\t\t}<br>\t\t}()<br>\t}<br>\twg.Wait()<br>\tfmt.Println(count)<br>}<br><br>func addWithLock() {<br>\tvar count = 0 &#47;&#47;å…¬å…±ä¿®æ”¹çš„å˜é‡<br>\tvar mu = sync.Mutex{}<br>\t&#47;&#47;ä½¿ç”¨WaitGroupç­‰å¾…10ä¸ªgoroutineå®Œæˆ<br>\tvar wg sync.WaitGroup<br>\twg.Add(10) &#47;&#47;æ·»åŠ 10ä¸ªç­‰å¾…<br>\t&#47;&#47;å¾ªç¯æ‰§è¡Œ10ä¸ªåç¨‹<br>\tfor i := 0; i &lt; 10; i++ {<br>\t\tgo func() {<br>\t\t\tdefer wg.Done() &#47;&#47;æ‰§è¡Œå®Œä¸€ä¸ªåç¨‹å»æ‰ä¸€ä¸ªç­‰å¾…<br>\t\t\t&#47;&#47;å¯¹countè¿›è¡Œ10ä¸‡æ¬¡åŠ 1<br>\t\t\tfor j := 0; j &lt; 100000; j++ {<br>\t\t\t\t&#47;&#47;å¼€å§‹æ‰§è¡Œåˆ°ä¸´ç•ŒåŒºåŸŸ åŠ é”<br>\t\t\t\tmu.Lock()<br>\t\t\t\tcount++ &#47;&#47;æ­¤å¤„ä¸ºä¸´ç•ŒåŒºåŸŸ<br>\t\t\t\t&#47;&#47;ä¸´ç•ŒåŒºåŸŸæ‰§è¡Œç»“æŸ é‡Šæ”¾é”<br>\t\t\t\tmu.Unlock()<br>\t\t\t}<br>\t\t}()<br>\t}<br>\t&#47;&#47;ä¸»çº¿ç¨‹ç­‰å¾…10ä¸ªåç¨‹å®Œæˆ<br>\twg.Wait()<br>\tfmt.Println(count)<br>}<br>","like_count":0},{"had_liked":false,"id":350897,"user_name":"MClink","can_delete":false,"product_type":"c1","uid":1435733,"ip_address":"","ucode":"F479190923355C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","comment_is_top":false,"comment_ctime":1657298036,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657298036","product_id":100013101,"comment_content":"ä¸´ç•ŒåŒºç«äº‰å®ä¾‹","like_count":0},{"had_liked":false,"id":327192,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1639972523,"is_pvip":false,"replies":[{"id":"119013","content":"å¯¹ï¼Œè¿™æ˜¯æœ‰ä¸€æ•´å¥—è§„åˆ™çš„ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œåœ¨å„ä¸ªè¯­å¥æ‰§è¡Œçš„ä»»æ„é—´éš”ã€åœ¨åŒæ­¥å·¥å…·é€ æˆçš„é˜»å¡æ—¶ã€åœ¨è¯­å¥è°ƒç”¨å†…æ ¸æ€çš„ä»£ç å¹¶éœ€è¦ç­‰å¾…æ—¶ï¼Œä»¥åŠå½“å‰çš„goroutineæ‰§è¡Œæ—¶é—´è¿‡ä¹…éœ€è¦åˆ‡æ¢æ—¶ã€‚<br><br>è¿™ä¸ªæœºåˆ¶æ­£å¼è®²èµ·æ¥ç¯‡å¹…ä¼šéå¸¸å¤§ã€‚<br><br>æˆ‘è®°å¾—æˆ‘ä¹‹å‰è·Ÿä½ è¯´è¿‡å§ï¼Œå¯ä»¥çœ‹æˆ‘é‚£æœ¬ã€ŠGoå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ã€‚<br><br>å¦ä¸€ä¸ªæ–¹å¼æ˜¯ç›´æ¥çœ‹Goè¯­è¨€çš„æºç ã€‚å…¶å®ã€ŠGoå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹æ˜¯å¯ä»¥å¸®åŠ©ä½ çœ‹æ‡‚Goè¯­è¨€æºç çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1639984636,"ip_address":"","comment_id":327192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639972523","product_id":100013101,"comment_content":"æ ¹æ®æ‰§è¡Œgo run demo58.go -protecting=0çš„ç»“æœæ¥çœ‹ï¼Œgoç¨‹åºè¿è¡Œæ—¶è°ƒåº¦æ—¶æœºå¹¶ä¸æ˜¯æŸä¸ªgoroutineé˜»å¡ï¼ˆå³ä½¿ä¸é˜»å¡ä¹Ÿä¼šå¯èƒ½è¢«Pä»Mä¸Šåˆ†ç¦»ï¼‰ï¼Œè€Œæ˜¯æœ‰å®ƒè‡ªå·±åˆ¤æ–­æœºåˆ¶ï¼Œå¯¹å—ï¼Œé‚£ä¹ˆä»–çš„è°ƒåº¦æœºåˆ¶æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Œæ˜¯å¦ç±»ä¼¼åŸç†çš„å‚è€ƒèµ„æ–™","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540188,"discussion_content":"å¯¹ï¼Œè¿™æ˜¯æœ‰ä¸€æ•´å¥—è§„åˆ™çš„ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œåœ¨å„ä¸ªè¯­å¥æ‰§è¡Œçš„ä»»æ„é—´éš”ã€åœ¨åŒæ­¥å·¥å…·é€ æˆçš„é˜»å¡æ—¶ã€åœ¨è¯­å¥è°ƒç”¨å†…æ ¸æ€çš„ä»£ç å¹¶éœ€è¦ç­‰å¾…æ—¶ï¼Œä»¥åŠå½“å‰çš„goroutineæ‰§è¡Œæ—¶é—´è¿‡ä¹…éœ€è¦åˆ‡æ¢æ—¶ã€‚\n\nè¿™ä¸ªæœºåˆ¶æ­£å¼è®²èµ·æ¥ç¯‡å¹…ä¼šéå¸¸å¤§ã€‚\n\næˆ‘è®°å¾—æˆ‘ä¹‹å‰è·Ÿä½ è¯´è¿‡å§ï¼Œå¯ä»¥çœ‹æˆ‘é‚£æœ¬ã€ŠGoå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ã€‚\n\nå¦ä¸€ä¸ªæ–¹å¼æ˜¯ç›´æ¥çœ‹Goè¯­è¨€çš„æºç ã€‚å…¶å®ã€ŠGoå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹æ˜¯å¯ä»¥å¸®åŠ©ä½ çœ‹æ‡‚Goè¯­è¨€æºç çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639984637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327175,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1639967909,"is_pvip":false,"replies":[{"id":"119012","content":"sync.Mutexæ˜¯ä¸åˆ†è¯»å’Œå†™çš„ï¼ŒåŸåˆ™ä¸Šä½ ç”¨å®ƒæ¥ä¿æŠ¤ä»€ä¹ˆæ“ä½œéƒ½å¯ä»¥ï¼Œåªæ˜¯æœ‰æ—¶å€™æ•ˆç‡ä¼šä¸å¤ªå¥½ï¼ˆä¸‹é¢ä¼šæåˆ°ï¼‰ã€‚sync.RWMutexåˆ†è¯»å†™ã€‚é¦–å…ˆè¦æ˜ç¡®ï¼Œæ‰€è°“å†™å°±æ˜¯ä¼šæ”¹å˜èµ„æºçš„å†…å®¹æˆ–çŠ¶æ€ï¼Œæ‰€è°“è¯»å°±æ˜¯åªä¼šè®¿é—®ä½†ä¸ä¼šæ”¹å˜ã€‚<br><br>sync.RWMutexä¸­åŒ…å«äº†ä¸¤ä¸ªé”ï¼Œç”¨å†™é”å¯ä»¥ä¿è¯ä¸¤ä¸ªï¼ˆå†™ï¼‰æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨è¯»é”ä¸ä¼šä¿è¯ä¸¤ä¸ªï¼ˆè¯»ï¼‰æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ã€‚è€Œä¸”ï¼Œæ›´é‡è¦çš„æ˜¯ï¼ŒåŒä¸€ä¸ªè¯»å†™é”çš„å†™é”å’Œè¯»é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼ˆè¯»-å†™æ“ä½œäº’æ–¥ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¯»å†™é”æ¥å®æ–½åŒºåˆ«åŒ–çš„ä¿æŠ¤ã€‚<br><br>ä½ éœ€è¦æ ¹æ®è¿™å¥—è§„åˆ™æ¥è®¾è®¡ä½ ä½¿ç”¨çš„æ–¹å¼ã€‚<br><br>å½“ä½ ä¼šå¯¹æŸä¸€ä¸ªå…±äº«èµ„æºæ—¢è®¿é—®åˆæ”¹å˜ï¼Œè€Œä¸”è¿™ä¸¤ç§æ“ä½œåˆ†åˆ«ç”±ä¸åŒçš„ä»£ç å—æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±åº”è¯¥ç”¨è¯»å†™é”ï¼Œå› ä¸ºè¯»å†™é”å¯ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹æé«˜æ•ˆç‡ã€‚å¦‚æœåœ¨äº’æ–¥é”ä¸‹æ‰§è¡Œè¯»æ“ä½œå’Œå†™æ“ä½œï¼Œé‚£ä¹ˆè¯»-è¯»ä¹‹é—´å°±ä¼šäº’æ–¥ï¼ˆè¿™å…¶å®æ˜¯æ²¡å¿…è¦çš„ï¼‰ã€‚å¦‚æœç”¨è¯»å†™é”ï¼Œé‚£ä¹ˆè¯»-è¯»ä¹‹é—´å°±ä¸ä¼šäº’æ–¥ï¼Œè¿™å°±æé«˜äº†æ•ˆç‡ï¼ˆå°¤å…¶æ˜¯åœ¨è¯»æ“ä½œå¹¶å‘é‡å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1639984352,"ip_address":"","comment_id":327175,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639967909","product_id":100013101,"comment_content":"&#47;&#47; 2 åªæœ‰è¯»çš„æƒ…å†µä¸‹å°±æ˜¯ç”¨è¯»é”,åŒæ—¶åˆè¯»å†™çš„æƒ…å†µä¸‹,å°±æ˜¯ç”¨è¯»å†™é”å¹¶åˆ†åˆ«ç”¨è¯»é”ä¿æŠ¤è¯»æ“ä½œ,å†™é”ä¿æŠ¤å†™æ“ä½œ,æ˜¯è¿™æ ·å—?<br>\t&#47;&#47; è¡ç”Ÿçš„é—®é¢˜:<br>\t\t&#47;&#47; å¦‚æœåªç”¨è¯»é”ï¼Œä¿æŠ¤å†™æ“ä½œï¼Œæ˜¯å¦æœ‰ä»€ä¹ˆé—®é¢˜<br>\t\t&#47;&#47; è¯»å†™é”å¼•å…¥äº†æ›´å¤šçš„å¤æ‚åº¦ï¼Œæ˜¯å¦è¦ç»“åˆå®é™…æƒ…å†µç¡®å®šè¯»å†™æƒ…å†µä¸‹ï¼Œæ˜¯å¦ä¸€å®šè¦å¼•å…¥è¯»å†™é”<br>\t\t&#47;&#47; æ˜¯å¦æœ‰ä¸€å®šéœ€è¦ä½¿ç”¨è¯»å†™é”è€Œä¸é€‚ç”¨è¯»é”çš„åœºæ™¯ï¼Œå¯å¦ä¸¾ä¾‹","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540186,"discussion_content":"sync.Mutexæ˜¯ä¸åˆ†è¯»å’Œå†™çš„ï¼ŒåŸåˆ™ä¸Šä½ ç”¨å®ƒæ¥ä¿æŠ¤ä»€ä¹ˆæ“ä½œéƒ½å¯ä»¥ï¼Œåªæ˜¯æœ‰æ—¶å€™æ•ˆç‡ä¼šä¸å¤ªå¥½ï¼ˆä¸‹é¢ä¼šæåˆ°ï¼‰ã€‚sync.RWMutexåˆ†è¯»å†™ã€‚é¦–å…ˆè¦æ˜ç¡®ï¼Œæ‰€è°“å†™å°±æ˜¯ä¼šæ”¹å˜èµ„æºçš„å†…å®¹æˆ–çŠ¶æ€ï¼Œæ‰€è°“è¯»å°±æ˜¯åªä¼šè®¿é—®ä½†ä¸ä¼šæ”¹å˜ã€‚\n\nsync.RWMutexä¸­åŒ…å«äº†ä¸¤ä¸ªé”ï¼Œç”¨å†™é”å¯ä»¥ä¿è¯ä¸¤ä¸ªï¼ˆå†™ï¼‰æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨è¯»é”ä¸ä¼šä¿è¯ä¸¤ä¸ªï¼ˆè¯»ï¼‰æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ã€‚è€Œä¸”ï¼Œæ›´é‡è¦çš„æ˜¯ï¼ŒåŒä¸€ä¸ªè¯»å†™é”çš„å†™é”å’Œè¯»é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼ˆè¯»-å†™æ“ä½œäº’æ–¥ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¯»å†™é”æ¥å®æ–½åŒºåˆ«åŒ–çš„ä¿æŠ¤ã€‚\n\nä½ éœ€è¦æ ¹æ®è¿™å¥—è§„åˆ™æ¥è®¾è®¡ä½ ä½¿ç”¨çš„æ–¹å¼ã€‚\n\nå½“ä½ ä¼šå¯¹æŸä¸€ä¸ªå…±äº«èµ„æºæ—¢è®¿é—®åˆæ”¹å˜ï¼Œè€Œä¸”è¿™ä¸¤ç§æ“ä½œåˆ†åˆ«ç”±ä¸åŒçš„ä»£ç å—æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±åº”è¯¥ç”¨è¯»å†™é”ï¼Œå› ä¸ºè¯»å†™é”å¯ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹æé«˜æ•ˆç‡ã€‚å¦‚æœåœ¨äº’æ–¥é”ä¸‹æ‰§è¡Œè¯»æ“ä½œå’Œå†™æ“ä½œï¼Œé‚£ä¹ˆè¯»-è¯»ä¹‹é—´å°±ä¼šäº’æ–¥ï¼ˆè¿™å…¶å®æ˜¯æ²¡å¿…è¦çš„ï¼‰ã€‚å¦‚æœç”¨è¯»å†™é”ï¼Œé‚£ä¹ˆè¯»-è¯»ä¹‹é—´å°±ä¸ä¼šäº’æ–¥ï¼Œè¿™å°±æé«˜äº†æ•ˆç‡ï¼ˆå°¤å…¶æ˜¯åœ¨è¯»æ“ä½œå¹¶å‘é‡å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639984352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327174,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1639967874,"is_pvip":false,"replies":[{"id":"119011","content":"ä¸€ä¸ªé’ˆå¯¹çš„æ˜¯æ•°æ®å—ï¼ˆå…±äº«èµ„æºï¼‰ï¼Œå¦ä¸€ä¸ªé’ˆå¯¹çš„æ˜¯ä»£ç å—ï¼ˆä¸´ç•ŒåŒºï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1026643","ctime":1639983574,"ip_address":"","comment_id":327174,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639967874","product_id":100013101,"comment_content":"1 ä¸€ä¸ªæ˜¯é¿å…å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»æ“ä½œåŒä¸€ä¸ªæ•°æ®å—ï¼Œå¦ä¸€ä¸ªæ˜¯åè°ƒå¤šä¸ªçº¿ç¨‹ï¼Œä»¥é¿å…å®ƒä»¬åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡ŒåŒä¸€ä¸ªä»£ç å—ã€‚è¿™2ä¸ªæè¿°çš„åŒºåˆ«åœ¨å“ªï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540184,"discussion_content":"ä¸€ä¸ªé’ˆå¯¹çš„æ˜¯æ•°æ®å—ï¼ˆå…±äº«èµ„æºï¼‰ï¼Œå¦ä¸€ä¸ªé’ˆå¯¹çš„æ˜¯ä»£ç å—ï¼ˆä¸´ç•ŒåŒºï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639983574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317068,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1634655748,"is_pvip":false,"replies":[{"id":"114895","content":"è¿™è¦çœ‹ä½ çš„è¯‰æ±‚æ˜¯ä»€ä¹ˆã€‚<br><br>å¦‚æœä½ å°±æ˜¯éœ€è¦æŒç»­ä¸æ–­åœ°è¯•å›¾ä»æŸå¤„è¯»å–æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¸åº”è¯¥â€œè§åˆ° io.EOF å breakâ€ã€‚å› ä¸ºè¿™å¯èƒ½ä¼šè®© for è¯­å¥è¿‡æ—©çš„ç»“æŸæ‰§è¡Œã€‚<br><br>å¦‚æœä½ çš„ for è¯­å¥åªéœ€è¦è¯»å–â€œç°å­˜çš„å‰©ä½™æ•°æ®â€åç»“æŸæ‰§è¡Œï¼Œé‚£ä¹ˆå°±éœ€è¦â€œè§åˆ° io.EOF å breakâ€ã€‚<br><br>æ‰€ä»¥ï¼Œå³ä½¿åƒä½ å†™çš„è¿™æ®µæ— ç»“æŸæ¡ä»¶çš„ for è¯­å¥ï¼Œä»ç„¶éœ€è¦è¿™æ ·è€ƒè™‘ã€‚å…³é”®é—®é¢˜æ˜¯ï¼Œä½ çš„æ ¸å¿ƒè¯‰æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1634709205,"ip_address":"","comment_id":317068,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634655748","product_id":100013101,"comment_content":"å¦‚æœæ‰€æœ‰å†™å…¥æ•°æ®éƒ½è¢«è¯»å®Œäº†ï¼Œreaderæ˜¯å¦å¯èƒ½å› ä¸ºè¯»å–ä¸åˆ°æ•°æ®è¿”å›EOF,è€Œä¸€ç›´æ— æ³•é€€å‡ºforå¾ªç¯å‘¢<br>for {<br>\tdata, n, err = readConfig.handler()<br>\tif err == nil || err != io.EOF {<br>\t    break<br>\t}<br>        ....<br>}","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528637,"discussion_content":"è¿™è¦çœ‹ä½ çš„è¯‰æ±‚æ˜¯ä»€ä¹ˆã€‚\n\nå¦‚æœä½ å°±æ˜¯éœ€è¦æŒç»­ä¸æ–­åœ°è¯•å›¾ä»æŸå¤„è¯»å–æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¸åº”è¯¥â€œè§åˆ° io.EOF å breakâ€ã€‚å› ä¸ºè¿™å¯èƒ½ä¼šè®© for è¯­å¥è¿‡æ—©çš„ç»“æŸæ‰§è¡Œã€‚\n\nå¦‚æœä½ çš„ for è¯­å¥åªéœ€è¦è¯»å–â€œç°å­˜çš„å‰©ä½™æ•°æ®â€åç»“æŸæ‰§è¡Œï¼Œé‚£ä¹ˆå°±éœ€è¦â€œè§åˆ° io.EOF å breakâ€ã€‚\n\næ‰€ä»¥ï¼Œå³ä½¿åƒä½ å†™çš„è¿™æ®µæ— ç»“æŸæ¡ä»¶çš„ for è¯­å¥ï¼Œä»ç„¶éœ€è¦è¿™æ ·è€ƒè™‘ã€‚å…³é”®é—®é¢˜æ˜¯ï¼Œä½ çš„æ ¸å¿ƒè¯‰æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634709205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317061,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1634654475,"is_pvip":false,"replies":[{"id":"114896","content":"å…¶å®ä¸éœ€è¦è¿‡å¤šå…³æ³¨è¿™ä¸ªæ—¶é—´æˆ³ã€‚è¿™åªæ˜¯æ¦‚ç‡é—®é¢˜ï¼Œå¤šæ ¸CPUä¸­çš„å¹¶å‘æ‰§è¡Œæ›´æœ‰å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µã€‚<br><br>ä½ è¿è¡Œç¨‹åºçš„CPUçš„ä¸»é¢‘æ˜¯å¤šå°‘ï¼Ÿå…¶ä¸­å…±ç”¨å¤šå°‘ä¸ªCPUæ ¸å¿ƒï¼Ÿç„¶åä½ ç®—ä¸€ç®—ï¼Œè¿™é¢—CPUåœ¨ 1 çº³ç§’ä¹‹å†…ä¸€å…±å¯ä»¥è¿›è¡Œå¤šå°‘æ¬¡è¿ç®—ï¼Ÿ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1634710225,"ip_address":"","comment_id":317061,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634654475","product_id":100013101,"comment_content":"å‘ç°ä¸åŒgoroutineå†™å…¥æ“ä½œæ—¶å¯èƒ½ä¼šå†™å…¥ç›¸åŒçš„æ—¶é—´æ•°æ®ï¼š<br>2021&#47;10&#47;19 22:34:29 writer [2-4]: Oct 19 22:34:29.119490600      (total: 494)<br>2021&#47;10&#47;19 22:34:29 writer [5-4]: Oct 19 22:34:29.119490600      (total: 520)<br>ä»¥ä¸ºæ˜¯å› ä¸ºgenWriterä¸­mu.Lock()å¹¶æ²¡æœ‰æŠŠäº§ç”Ÿdataçš„ä»£ç åŒ…æ‹¬åœ¨ä¸´ç•ŒåŒºä¸­ï¼Œäºæ˜¯å°†è¿™è¡Œä»£ç åŠ å…¥åˆ°mu.Lock()ä¸­ï¼Œä½†æ˜¯æµ‹è¯•å‡ºæ¥çš„æ•°æ®è¿˜æ˜¯ä¼šå†™å…¥ç›¸åŒçš„æ•°æ®ï¼Œéš¾é“ä¸åº”è¯¥æ˜¯å½“ä¸€ä¸ªgoroutineè·å–ä»¤ç‰Œè¿›å…¥ä¸´ç•ŒåŒºå†™å…¥æ•°æ®ï¼Œå…¶å®ƒgoroutineç­‰å¾…å—ï¼Œè¿™ä¸ªçš„è¯æ€ä¹ˆä¼šå‡ºç°ä¸åŒgoroutineå†™å…¥çš„æ—¶é—´ä¸€æ ·çš„æƒ…å†µå‘¢ï¼Œæ±‚è§£","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528633,"discussion_content":"å…¶å®ä¸éœ€è¦è¿‡å¤šå…³æ³¨è¿™ä¸ªæ—¶é—´æˆ³ã€‚è¿™åªæ˜¯æ¦‚ç‡é—®é¢˜ï¼Œå¤šæ ¸CPUä¸­çš„å¹¶å‘æ‰§è¡Œæ›´æœ‰å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µã€‚\n\nä½ è¿è¡Œç¨‹åºçš„CPUçš„ä¸»é¢‘æ˜¯å¤šå°‘ï¼Ÿå…¶ä¸­å…±ç”¨å¤šå°‘ä¸ªCPUæ ¸å¿ƒï¼Ÿç„¶åä½ ç®—ä¸€ç®—ï¼Œè¿™é¢—CPUåœ¨ 1 çº³ç§’ä¹‹å†…ä¸€å…±å¯ä»¥è¿›è¡Œå¤šå°‘æ¬¡è¿ç®—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634710225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314653,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1633303055,"is_pvip":false,"replies":[{"id":"114108","content":"Channel å…¶å®å°±æ˜¯åŸºäºäº’æ–¥é”ã€ä¿¡å·é‡ç­‰å»ºç«‹èµ·æ¥çš„é«˜å±‚æŠ½è±¡ã€‚åƒäº’æ–¥é”ã€åŸå­æ“ä½œè¿™äº›åœ¨ channel é¢å‰å°±ç®—æ˜¯ä½å±‚æŠ½è±¡äº†ã€‚<br><br>ä½ åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼ŒæŒ‰ç…§å®é™…éœ€è¦æ¥é€‰æ‹©å°±å¯ä»¥äº†ï¼Œä¸ç”¨å¤ªåœ¨ä¹è¿™é‡Œæ‰€è¯´çš„â€œä½å±‚â€ã€â€œé«˜å±‚â€ã€‚å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™ä¸¤å±‚åŸºæœ¬ä¸Šæ²¡æœ‰åŒºåˆ«ã€‚ä½ åº”è¯¥æ›´å…³æ³¨â€œåŒæ­¥â€å’Œâ€œå¼‚æ­¥â€ä¹‹é—´çš„å·®åˆ«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1633681517,"ip_address":"","comment_id":314653,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633303055","product_id":100013101,"comment_content":"&#47;&#47; Package sync provides basic synchronization primitives such as mutual<br>&#47;&#47; exclusion locks. Other than the Once and WaitGroup types, most are intended<br>&#47;&#47; for use by low-level library routines. Higher-level synchronization is<br>&#47;&#47; better done via channels and communication.<br>è¿™æ®µæ³¨é‡Šä¸­æè¿°çš„low-levelå’Œhigh-levelçš„åŒºåˆ«æ˜¯æŒ‡åº•å±‚å’Œä¸Šå±‚å—ï¼Œè¿™ä¸ªæ„æ€æ˜¯goåº•å±‚å¯¹å¹¶å‘æ§åˆ¶çš„å®ç°æ˜¯ç”¨çš„æ˜¯mutual exclusion locks. è€Œç”¨æˆ·è¦ä½¿ç”¨çš„è¯æ¨èè¿˜æ˜¯ç”¨channelæˆ–è€…é€šä¿¡çš„æœºåˆ¶å—","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527753,"discussion_content":"Channel å…¶å®å°±æ˜¯åŸºäºäº’æ–¥é”ã€ä¿¡å·é‡ç­‰å»ºç«‹èµ·æ¥çš„é«˜å±‚æŠ½è±¡ã€‚åƒäº’æ–¥é”ã€åŸå­æ“ä½œè¿™äº›åœ¨ channel é¢å‰å°±ç®—æ˜¯ä½å±‚æŠ½è±¡äº†ã€‚\n\nä½ åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼ŒæŒ‰ç…§å®é™…éœ€è¦æ¥é€‰æ‹©å°±å¯ä»¥äº†ï¼Œä¸ç”¨å¤ªåœ¨ä¹è¿™é‡Œæ‰€è¯´çš„â€œä½å±‚â€ã€â€œé«˜å±‚â€ã€‚å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™ä¸¤å±‚åŸºæœ¬ä¸Šæ²¡æœ‰åŒºåˆ«ã€‚ä½ åº”è¯¥æ›´å…³æ³¨â€œåŒæ­¥â€å’Œâ€œå¼‚æ­¥â€ä¹‹é—´çš„å·®åˆ«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633681517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314406,"user_name":"æ˜Ÿæ¸Šç‹","can_delete":false,"product_type":"c1","uid":1199987,"ip_address":"","ucode":"947249B4A5B079","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/73/b1db99da.jpg","comment_is_top":false,"comment_ctime":1633000426,"is_pvip":false,"replies":[{"id":"113952","content":"ä¸¤ä¸ªå˜é‡åœ¨å†…å­˜é‡Œè‚¯å®šä¼šæœ‰ä¸åŒçš„åœ°å€å•Šï¼Œå¦åˆ™å°±ä¸æ˜¯â€œä¸¤ä¸ªâ€å˜é‡äº†ã€‚ä½†æ˜¯ï¼Œä¸å®ƒä»¬ç»‘å®šçš„å€¼å´æ˜¯ç›¸åŒçš„å•Šï¼ˆæ³¨æ„ï¼Œä¸æ˜¯åŒä¸€ä¸ªï¼Œä½†å´æ˜¯ç›¸åŒçš„ï¼‰ã€‚<br><br>æ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰ä¼šè¯´â€œå½“æŠŠä¸€ä¸ªå˜é‡çš„å€¼èµ‹ç»™å¦ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œè¿™ä¸ªå€¼ä¼šè¢«æ‹·è´â€ã€‚æˆ–è€…è¯´ï¼Œæ­£å› ä¸ºæœ‰â€œå¦ä¸€ä¸ªåœ°æ–¹åŒæ—¶éœ€è¦è¿™ä¸ªå€¼â€è¿™ç§éœ€æ±‚ï¼Œæ‰æœ‰äº†â€œæ‹·è´å‡ºä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶æŠŠè¿™ä¸ªå‰¯æœ¬ç»™åˆ°å¦ä¸€ä¸ªåœ°æ–¹â€è¿™ç§è§£å†³æ–¹æ¡ˆã€‚<br><br>æœ€åï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œèµ‹å€¼ä¹Ÿä¼šæ‹·è´å€¼ï¼Œæ‰€ä»¥äº’æ–¥é”åœ¨ä½¿ç”¨åå°±ä¸è¦å†åšèµ‹å€¼æ“ä½œäº†ï¼Œå¦åˆ™å°±ä¼šé€ æˆäº’æ–¥é”åŠŸèƒ½ä¸Šçš„å¼‚å¸¸ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1633244042,"ip_address":"","comment_id":314406,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633000426","product_id":100013101,"comment_content":"var sy sync.Mutex<br><br>func main() {<br>\trouter := gin.Default()<br><br>\trouter.GET(&quot;&#47;&quot;, func(c *gin.Context) {<br>\t\tnum := c.Query(&quot;num&quot;)<br><br>\t\tnum2,err := strconv.Atoi(num)<br>\t\tif err != nil {<br>\t\t\tc.JSON(200,gin.H{<br>\t\t\t\t&quot;name&quot;:&quot;maogou&quot; + err.Error(),<br>\t\t\t})<br>\t\t}<br>\t\tdemo(num2)<br>\t\tc.JSON(200,gin.H{<br>\t\t\t&quot;name&quot;:&quot;maogou&quot;,<br>\t\t})<br>\t})<br><br>\trouter.GET(&quot;&#47;demo1&quot;, func(c *gin.Context) {<br>\t\tsy2 := sy<br><br>\t\tfmt.Printf(&quot;%p\\n&quot;,&amp;sy)<br>\t\tfmt.Printf(&quot;%p\\n&quot;,&amp;sy2)<br>\t\tfmt.Println(sy == sy2)<br>}<br><br>æœ€ç»ˆè¾“å‡ºç»“æœ<br>0xa87858<br>0xc0003060a0<br>true   ä¸å¤ªç†è§£è¿™ä¸¤ä¸ªä¸ºä»€ä¹ˆä¼šç›¸ç­‰ ? ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527674,"discussion_content":"ä¸¤ä¸ªå˜é‡åœ¨å†…å­˜é‡Œè‚¯å®šä¼šæœ‰ä¸åŒçš„åœ°å€å•Šï¼Œå¦åˆ™å°±ä¸æ˜¯â€œä¸¤ä¸ªâ€å˜é‡äº†ã€‚ä½†æ˜¯ï¼Œä¸å®ƒä»¬ç»‘å®šçš„å€¼å´æ˜¯ç›¸åŒçš„å•Šï¼ˆæ³¨æ„ï¼Œä¸æ˜¯åŒä¸€ä¸ªï¼Œä½†å´æ˜¯ç›¸åŒçš„ï¼‰ã€‚\n\næ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰ä¼šè¯´â€œå½“æŠŠä¸€ä¸ªå˜é‡çš„å€¼èµ‹ç»™å¦ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œè¿™ä¸ªå€¼ä¼šè¢«æ‹·è´â€ã€‚æˆ–è€…è¯´ï¼Œæ­£å› ä¸ºæœ‰â€œå¦ä¸€ä¸ªåœ°æ–¹åŒæ—¶éœ€è¦è¿™ä¸ªå€¼â€è¿™ç§éœ€æ±‚ï¼Œæ‰æœ‰äº†â€œæ‹·è´å‡ºä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶æŠŠè¿™ä¸ªå‰¯æœ¬ç»™åˆ°å¦ä¸€ä¸ªåœ°æ–¹â€è¿™ç§è§£å†³æ–¹æ¡ˆã€‚\n\næœ€åï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œèµ‹å€¼ä¹Ÿä¼šæ‹·è´å€¼ï¼Œæ‰€ä»¥äº’æ–¥é”åœ¨ä½¿ç”¨åå°±ä¸è¦å†åšèµ‹å€¼æ“ä½œäº†ï¼Œå¦åˆ™å°±ä¼šé€ æˆäº’æ–¥é”åŠŸèƒ½ä¸Šçš„å¼‚å¸¸ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633244042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302015,"user_name":"æ— åæ— å§“","can_delete":false,"product_type":"c1","uid":2621412,"ip_address":"","ucode":"487BD5AA2CD305","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/e4/927547a9.jpg","comment_is_top":false,"comment_ctime":1626019549,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626019549","product_id":100013101,"comment_content":"è®²çš„ä¸é”™","like_count":0},{"had_liked":false,"id":294353,"user_name":"æ¨ä¸","can_delete":false,"product_type":"c1","uid":1008597,"ip_address":"","ucode":"D469B0BCA86587","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/d5/a300899a.jpg","comment_is_top":false,"comment_ctime":1621911108,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621911108","product_id":100013101,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1. Lockeræ¥å£","like_count":0},{"had_liked":false,"id":289587,"user_name":"å¹¼å„¿ç¼–ç¨‹æ•™å­¦","can_delete":false,"product_type":"c1","uid":1237199,"ip_address":"","ucode":"F13F3150E6CAE9","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/cf/43f201f2.jpg","comment_is_top":false,"comment_ctime":1619090389,"is_pvip":false,"replies":[{"id":"105088","content":"é”çš„èŒƒå›´å¤ªå¤§ï¼Œå¾€å¾€ä¸æ˜¯é”™ç”¨äº†deferè¯­å¥ï¼Œè€Œæ˜¯å‡½æ•°åˆ‡åˆ†æ–¹é¢æœ‰é—®é¢˜ï¼Œæ²¡æœ‰åˆç†åˆ‡åˆ†ï¼Œæˆ–è€…åˆ‡å¾—å¤ªå¤§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1619155894,"ip_address":"","comment_id":289587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619090389","product_id":100013101,"comment_content":"éƒè€å¸ˆï¼Œè¯·æ•™ä¸‹ã€‚<br>çœ‹æ–‡ç« ï¼Œæ¨èç”¨deferçš„æ–¹å¼å»è§£é”ã€‚<br>ä½†ï¼Œè¿™æ ·çš„è¯ï¼Œé”çš„èŒƒå›´ä¼šå¤§ä¸€ç‚¹ã€‚ä½†ï¼Œå¥½åƒè¿™æ˜¯æœ€ä¿é™©çš„æ–¹æ³•ï¼Œå¥½åƒä¹Ÿæ²¡åŠæ³•ï¼Œæ˜¯å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518959,"discussion_content":"é”çš„èŒƒå›´å¤ªå¤§ï¼Œå¾€å¾€ä¸æ˜¯é”™ç”¨äº†deferè¯­å¥ï¼Œè€Œæ˜¯å‡½æ•°åˆ‡åˆ†æ–¹é¢æœ‰é—®é¢˜ï¼Œæ²¡æœ‰åˆç†åˆ‡åˆ†ï¼Œæˆ–è€…åˆ‡å¾—å¤ªå¤§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619155894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279640,"user_name":"mkii","can_delete":false,"product_type":"c1","uid":1674466,"ip_address":"","ucode":"534914EC7EA304","user_header":"https://static001.geekbang.org/account/avatar/00/19/8c/e2/48f4e4fa.jpg","comment_is_top":false,"comment_ctime":1613885872,"is_pvip":false,"replies":[{"id":"101641","content":"è¿™ä¸ªæ²¡æœ‰å›ºå®šçš„å”¤é†’ä¼˜å…ˆçº§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1613980638,"ip_address":"","comment_id":279640,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1613885872","product_id":100013101,"comment_content":"è€å¸ˆï¼Œå¦‚æœå½“å‰å†™é”è¢«é”å®šï¼Œè§£é”æ—¶è¿™2è€…æœ‰æ²¡æœ‰å”¤é†’çš„ä¼˜å…ˆçº§ã€‚ç­‰å¾…è¯»é”çš„goroutineå’Œç­‰å¾…å†™é”çš„goroutine","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515809,"discussion_content":"è¿™ä¸ªæ²¡æœ‰å›ºå®šçš„å”¤é†’ä¼˜å…ˆçº§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613980638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1132878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/4e/8798cd01.jpg","nickname":"é¡·","note":"","ucode":"096B6859C1FA80","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536763,"discussion_content":"è€å¸ˆçš„è¿™ä¸ªå›ç­”ï¼Œæ˜¯å¦å’ŒåŸæ–‡ä¸­æè¿°çš„ ã€å¯¹å†™é”è¿›è¡Œè§£é”ï¼Œä¼šå”¤é†’â€œæ‰€æœ‰å› è¯•å›¾é”å®šè¯»é”ï¼Œè€Œè¢«é˜»å¡çš„ goroutineâ€ï¼Œå¹¶ä¸”ï¼Œè¿™é€šå¸¸ä¼šä½¿å®ƒä»¬éƒ½æˆåŠŸå®Œæˆå¯¹è¯»é”çš„é”å®šã€‚ã€‘è¿™å¥æœ‰æ­§ä¹‰å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638864468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":515809,"ip_address":""},"score":536763,"extra":""}]}]},{"had_liked":false,"id":273017,"user_name":"æˆ‘çš„è…¿è…¿","can_delete":false,"product_type":"c1","uid":1239277,"ip_address":"","ucode":"2AAA36A7C3AD75","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/ed/f9347e5e.jpg","comment_is_top":false,"comment_ctime":1610414175,"is_pvip":false,"replies":[{"id":"98956","content":"ä½ è¿™ä¹ˆè¯´è°ä¹Ÿå¸®ä¸äº†ä½ ã€‚ä½ éœ€è¦ç”¨ä»£ç æè¿°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1610445412,"ip_address":"","comment_id":273017,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1610414175","product_id":100013101,"comment_content":"æˆ‘ç”¨åŒä¸€æŠŠäº’æ–¥é”ï¼Œåœ¨ä¸¤ä¸ªåç¨‹é‡Œé¢ç”¨ï¼Œéƒ½æœ‰å¯¹åº”çš„åŠ é”è§£é”æ“ä½œï¼Œå¦ä¸€ä¸ªåç¨‹è«åå°±é˜»å¡äº†ï¼Ÿå’‹å›äº‹","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513460,"discussion_content":"ä½ è¿™ä¹ˆè¯´è°ä¹Ÿå¸®ä¸äº†ä½ ã€‚ä½ éœ€è¦ç”¨ä»£ç æè¿°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610445412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435733,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","nickname":"MClink","note":"","ucode":"F479190923355C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380886,"discussion_content":"ä½ è¿™ç§åº”è¯¥æ˜¯å¶ç°çš„ï¼Œå°±æ˜¯åŒä¸ªé”ä½ ä¸¤ä¸ªåç¨‹éƒ½è¿›è¡Œçš„é”æ“ä½œå¯¼è‡´çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624777491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1239277,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e8/ed/f9347e5e.jpg","nickname":"æˆ‘çš„è…¿è…¿","note":"","ucode":"2AAA36A7C3AD75","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341814,"discussion_content":"dog","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610530448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267118,"user_name":"åˆå­¦è€…","can_delete":false,"product_type":"c1","uid":2052670,"ip_address":"","ucode":"5E404009761B90","user_header":"https://static001.geekbang.org/account/avatar/00/1f/52/3e/f74da7bd.jpg","comment_is_top":false,"comment_ctime":1607601071,"is_pvip":false,"replies":[{"id":"97252","content":"APIæœ¬èº«è‚¯å®šæ— æ³•è¿™ä¹ˆç²¾ç»†åœ°ä»‹å…¥ä½ çš„ç¨‹åºã€‚è¯»é”å’Œå†™é”å…·ä½“ä¿æŠ¤ä»€ä¹ˆæ˜¯éœ€è¦åº”ç”¨ç¨‹åºçš„å¼€å‘è€…è‡ªå·±å»è®¾è®¡å’Œæ‰§è¡Œçš„ã€‚<br><br>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯»é”çš„ä¸´ç•ŒåŒºé‡Œåªåº”è¯¥åŒ…å«å¯¹æŸä¸ªå…±äº«èµ„æºçš„è·å–æ“ä½œï¼›åªè¦æ¶‰åŠåˆ°äº†å¯¹å…±äº«èµ„æºçš„ä¿®æ”¹ï¼Œå°±åº”è¯¥ä½¿ç”¨å†™é”è€Œä¸æ˜¯è¯»é”ï¼Œå³ä½¿å…¶ä¸­åŒ…å«äº†è¯»æ“ä½œä¹Ÿæ˜¯å¦‚æ­¤","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1607914807,"ip_address":"","comment_id":267118,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1607601071","product_id":100013101,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸‹è¯»å†™é”çš„è¯»é”å’Œå†™é”å…·ä½“æ“ä½œçš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œæ¯”å¦‚åŠ è¯»é”çš„ä»£ç å—ï¼Œè¿™æ®µä»£ç å—é‡Œé¢çš„å…³äºè¯»çš„å†…å®¹éƒ½ä¼šè¢«è¯»é”åŒºåˆ†å‡ºæ¥å—ï¼Œä»£ç å—ä¸­çš„è¯»å’Œå†™å…·ä½“æŒ‡ä»€ä¹ˆå‘¢","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511513,"discussion_content":"APIæœ¬èº«è‚¯å®šæ— æ³•è¿™ä¹ˆç²¾ç»†åœ°ä»‹å…¥ä½ çš„ç¨‹åºã€‚è¯»é”å’Œå†™é”å…·ä½“ä¿æŠ¤ä»€ä¹ˆæ˜¯éœ€è¦åº”ç”¨ç¨‹åºçš„å¼€å‘è€…è‡ªå·±å»è®¾è®¡å’Œæ‰§è¡Œçš„ã€‚\n\nç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯»é”çš„ä¸´ç•ŒåŒºé‡Œåªåº”è¯¥åŒ…å«å¯¹æŸä¸ªå…±äº«èµ„æºçš„è·å–æ“ä½œï¼›åªè¦æ¶‰åŠåˆ°äº†å¯¹å…±äº«èµ„æºçš„ä¿®æ”¹ï¼Œå°±åº”è¯¥ä½¿ç”¨å†™é”è€Œä¸æ˜¯è¯»é”ï¼Œå³ä½¿å…¶ä¸­åŒ…å«äº†è¯»æ“ä½œä¹Ÿæ˜¯å¦‚æ­¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607914807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155065,"user_name":"ç–¯ç´","can_delete":false,"product_type":"c1","uid":1099379,"ip_address":"","ucode":"82ACAA4A27753D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1574642790,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574642790","product_id":100013101,"comment_content":"è®²å¾—æŒºæ¸…æ™°çš„","like_count":0},{"had_liked":false,"id":102670,"user_name":"ç³Šæç³Šæ¶‚","can_delete":false,"product_type":"c1","uid":1197625,"ip_address":"","ucode":"E0F6064CBA32B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/39/e545c885.jpg","comment_is_top":false,"comment_ctime":1560295172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560295172","product_id":100013101,"comment_content":"Lockerå’ŒRLocker","like_count":0},{"had_liked":false,"id":91630,"user_name":"å¼ sir","can_delete":false,"product_type":"c1","uid":1209431,"ip_address":"","ucode":"52958DF6705208","user_header":"https://static001.geekbang.org/account/avatar/00/12/74/57/7b828263.jpg","comment_is_top":false,"comment_ctime":1557063379,"is_pvip":false,"replies":[{"id":"32768","content":"ä½ å¯ä»¥ç†è§£ä¸ºåŒä¸€æŠŠé”ä¿æŠ¤çš„å¤šä¸ªä»£ç æ®µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1557109106,"ip_address":"","comment_id":91630,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557063379","product_id":100013101,"comment_content":"ä¸€ç»„ä¸´ç•ŒåŒºæ˜¯ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šï¼Œèƒ½ä¸¾ä¸ªä¾‹å­å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448972,"discussion_content":"ä½ å¯ä»¥ç†è§£ä¸ºåŒä¸€æŠŠé”ä¿æŠ¤çš„å¤šä¸ªä»£ç æ®µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557109106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69022,"user_name":"...","can_delete":false,"product_type":"c1","uid":1142098,"ip_address":"","ucode":"9D73E00133C236","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/52/404912c3.jpg","comment_is_top":false,"comment_ctime":1550647811,"is_pvip":false,"replies":[{"id":"25263","content":"è¿™é‡Œè¯´çš„å°±æ˜¯å¯é‡å…¥é”å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1551184351,"ip_address":"","comment_id":69022,"utype":1}],"discussion_count":6,"race_medal":0,"score":"1550647811","product_id":100013101,"comment_content":"è€å¸ˆ goæœ‰æ²¡æœ‰å¯é‡å…¥é”çš„æ¦‚å¿µ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439919,"discussion_content":"è¿™é‡Œè¯´çš„å°±æ˜¯å¯é‡å…¥é”å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551184351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1417824,"avatar":"https://static001.geekbang.org/account/avatar/00/15/a2/60/f3939ab4.jpg","nickname":"å“ˆå“¼","note":"","ucode":"C1108406573D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12351,"discussion_content":"ä¸è¡Œï¼Œjavaé‡Œæœ‰ã€‚åœ¨goé‡Œè¿™å°±æ˜¯é‡å¤åŠ é”ï¼Œæ˜¯bug","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568524658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3824,"discussion_content":"Pythoné‡Œé¢çš„é‚£ç§é€’å½’é”ï¼Ÿå¯ä»¥è¿ç»­é”å¤šæ¬¡ï¼ŸGOé‡Œé¢æ²¡å¾—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564845946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1650748,"avatar":"https://static001.geekbang.org/account/avatar/00/19/30/3c/0668d6ae.jpg","nickname":"ç›˜èƒ§","note":"","ucode":"5386CC4C92ECC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394243,"discussion_content":"æœ‰å•Š  ä¸€æ ·çš„ã€‚ä¸æ˜¯bug","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631799756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3824,"ip_address":""},"score":394243,"extra":""},{"author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1650748,"avatar":"https://static001.geekbang.org/account/avatar/00/19/30/3c/0668d6ae.jpg","nickname":"ç›˜èƒ§","note":"","ucode":"5386CC4C92ECC2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406235,"discussion_content":"åŒä¸€ä¸ªé”å®ä¾‹ï¼Œå¤šæ¬¡lockï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634726660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":394243,"ip_address":""},"score":406235,"extra":""},{"author":{"id":1650748,"avatar":"https://static001.geekbang.org/account/avatar/00/19/30/3c/0668d6ae.jpg","nickname":"ç›˜èƒ§","note":"","ucode":"5386CC4C92ECC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406524,"discussion_content":"å®³ï¼Œä½ æŸ¥ä¸€ä¸‹å°±çŸ¥é“äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634785202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":406235,"ip_address":""},"score":406524,"extra":""}]}]},{"had_liked":false,"id":47013,"user_name":"é™ä»¥å‚¨åŠ¿Â·Shuke","can_delete":false,"product_type":"c1","uid":1119090,"ip_address":"","ucode":"98736831B73028","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/72/434a40f1.jpg","comment_is_top":false,"comment_ctime":1544018983,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1544018983","product_id":100013101,"comment_content":"Golangå¯ä»¥ç”¨mutexåƒjavaä¸€æ ·åµŒå¥—åŠ é”ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1417824,"avatar":"https://static001.geekbang.org/account/avatar/00/15/a2/60/f3939ab4.jpg","nickname":"å“ˆå“¼","note":"","ucode":"C1108406573D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12349,"discussion_content":"ä¸è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568524590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071316,"avatar":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","nickname":"èŠå£«è€çˆ¹","note":"","ucode":"5F2935967574D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3825,"discussion_content":"ä¸å¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564845966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39492,"user_name":"ç”Ÿæ´»åœ¨åˆ«å¤„","can_delete":false,"product_type":"c1","uid":1096441,"ip_address":"","ucode":"E7F60026F2737A","user_header":"https://static001.geekbang.org/account/avatar/00/10/ba/f9/351e4fc0.jpg","comment_is_top":false,"comment_ctime":1542289563,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1542289563","product_id":100013101,"comment_content":"è¯»å†™é”æ˜¯å…¬å¹³çš„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362836,"discussion_content":"ä¸å…¬å¹³ï¼ŒæŠ¢å çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617035971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31672,"user_name":"timmy21","can_delete":false,"product_type":"c1","uid":1174860,"ip_address":"","ucode":"9D6DED247B1F38","user_header":"https://static001.geekbang.org/account/avatar/00/11/ed/4c/8674b6ad.jpg","comment_is_top":false,"comment_ctime":1539260649,"is_pvip":false,"replies":[{"id":"11816","content":"å¿…é¡»ä¸Šé”ï¼Œç¨‹åºç°åœ¨è¿è¡Œæ²¡é—®é¢˜ä¸ä»£è¡¨åˆ°æœåŠ¡å™¨ä¸Šæ²¡é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1539577101,"ip_address":"","comment_id":31672,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539260649","product_id":100013101,"comment_content":"éƒè€å¸ˆï¼Œæˆ‘ä½¿ç”¨raceè¿›è¡Œç«äº‰æ£€æµ‹ï¼Œå‘ç°æœ‰äº›å˜é‡åªæœ‰ä¸€ä¸ªå†™è€…ï¼Œä¸€ä¸ªè¯»è€…ã€‚ç¨‹åºè¿è¡Œæ²¡æœ‰é—®é¢˜ï¼Œä¸Šé”æˆ‘æ‹…å¿ƒæ€§èƒ½ä¸‹é™ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦å»ä¸Šé”å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426461,"discussion_content":"å¿…é¡»ä¸Šé”ï¼Œç¨‹åºç°åœ¨è¿è¡Œæ²¡é—®é¢˜ä¸ä»£è¡¨åˆ°æœåŠ¡å™¨ä¸Šæ²¡é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539577101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31605,"user_name":"CBBIOT","can_delete":false,"product_type":"c1","uid":1200298,"ip_address":"","ucode":"542339EECA68B9","user_header":"","comment_is_top":false,"comment_ctime":1539244610,"is_pvip":false,"replies":[{"id":"11819","content":"æå®¢æ—¶é—´è¿™ä¸¤å¤©ä¼šå¼€é€šè¿™ä¸ªä¸“æ çš„å°å¯†åœˆã€‚æ•¬è¯·æœŸå¾…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"éƒæ—","uid":"1026643","ctime":1539577257,"ip_address":"","comment_id":31605,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539244610","product_id":100013101,"comment_content":"éƒè€å¸ˆä½ çš„è¿™ä¸ªå­¦ä¹ ç¾¤æ€ä¹ˆåŠ ?æœ‰ä¹°ä½ çš„ä¹¦è¿˜æ²¡æœ‰çœ‹ï¼Œç›®å‰è¿˜åœ¨å­¦åŸºç¡€ã€‚","like_count":0,"discussions":[{"author":{"id":1026643,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/53/768aec0a.jpg","nickname":"éƒæ—","note":"","ucode":"F66BA62BA56FFA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426427,"discussion_content":"æå®¢æ—¶é—´è¿™ä¸¤å¤©ä¼šå¼€é€šè¿™ä¸ªä¸“æ çš„å°å¯†åœˆã€‚æ•¬è¯·æœŸå¾…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539577257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}