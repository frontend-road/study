{"id":117149,"title":"59 | æ•°æ®ä¸­å¿ƒæ“ä½œç³»ç»Ÿï¼šä¸Šå¸‚æ•²é’Ÿ","content":"<p>åœ¨è¿™é—¨è¯¾ç¨‹é‡Œé¢ï¼Œæˆ‘ä»¬è¯´äº†ï¼Œå†…æ ¸æ€æœ‰å¾ˆå¤šçš„æ¨¡å—ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†ç¡¬ä»¶è®¾å¤‡ï¼Œæœ€é‡è¦çš„å››ç§ç¡¬ä»¶èµ„æºæ˜¯CPUã€å†…å­˜ã€å­˜å‚¨å’Œç½‘ç»œã€‚</p><p>æœ€åˆä½¿ç”¨æ±‡ç¼–è¯­è¨€çš„å‰è¾ˆï¼Œåœ¨ç¨‹åºä¸­éœ€è¦æŒ‡å®šä½¿ç”¨çš„ç¡¬ä»¶èµ„æºï¼Œä¾‹å¦‚ï¼ŒæŒ‡å®šä½¿ç”¨å“ªä¸ªå¯„å­˜å™¨ã€æ”¾åœ¨å†…å­˜çš„å“ªä¸ªä½ç½®ã€å†™å…¥æˆ–è€…è¯»å–å“ªä¸ªä¸²å£ç­‰ç­‰ã€‚å¯¹äºè¿™äº›èµ„æºçš„ä½¿ç”¨ï¼Œéœ€è¦ç¨‹åºå‘˜è‡ªå·±å¿ƒé‡Œéå¸¸åœ°æ¸…æ¥šï¼Œè¦ä¸ç„¶ä¸€æ—¦jumpé”™äº†ä½ç½®ï¼Œç¨‹åºå°±æ— æ³•è¿è¡Œã€‚</p><p>ä¸ºäº†å°†ç¨‹åºå‘˜ä»å¯¹ç¡¬ä»¶çš„ç›´æ¥æ“ä½œä¸­è§£æ”¾å‡ºæ¥ï¼Œæå‡ç¨‹åºè®¾è®¡çš„æ•ˆç‡ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬æœ‰äº†æ“ä½œç³»ç»Ÿè¿™ä¸€å±‚ï¼Œç”¨æ¥å®ç°å¯¹äºç¡¬ä»¶èµ„æºçš„ç»Ÿä¸€ç®¡ç†ã€‚æŸä¸ªç¨‹åºåº”è¯¥ä½¿ç”¨å“ªä¸ªCPUã€å“ªéƒ¨åˆ†å†…å­˜ã€å“ªéƒ¨åˆ†ç¡¬ç›˜ï¼Œåªéœ€è¦è°ƒç”¨APIå°±å¯ä»¥äº†ï¼Œè¿™äº›éƒ½ç”±æ“ä½œç³»ç»Ÿè‡ªè¡Œåˆ†é…å’Œç®¡ç†ã€‚</p><p>å…¶å®æ“ä½œç³»ç»Ÿæœ€é‡è¦çš„äº‹æƒ…ï¼Œå°±æ˜¯è°ƒåº¦ã€‚å› æ­¤ï¼Œåœ¨å†…æ ¸æ€å°±äº§ç”Ÿäº†è¿™äº›æ¨¡å—ï¼šè¿›ç¨‹ç®¡ç†å­ç³»ç»Ÿã€å†…å­˜ç®¡ç†å­ç³»ç»Ÿã€æ–‡ä»¶å­ç³»ç»Ÿã€è®¾å¤‡å­ç³»ç»Ÿå’Œç½‘ç»œå­ç³»ç»Ÿã€‚</p><p>è¿™äº›æ¨¡å—é€šè¿‡ç»Ÿä¸€çš„APIï¼Œä¹Ÿå°±æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œå¯¹ä¸Šæä¾›æœåŠ¡ã€‚åŸºäºè¿™äº›APIï¼Œç”¨æˆ·æ€æœ‰å¾ˆå¤šçš„å·¥å…·å¯ä»¥å¸®æˆ‘ä»¬ä½¿ç”¨å¥½Linuxæ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚ç”¨æˆ·ç®¡ç†ã€è½¯ä»¶å®‰è£…ã€è½¯ä»¶è¿è¡Œã€å‘¨æœŸæ€§è¿›ç¨‹ã€æ–‡ä»¶ç®¡ç†ã€ç½‘ç»œç®¡ç†å’Œå­˜å‚¨ç®¡ç†ã€‚</p><p>ä½†æ˜¯åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬èƒ½ç®¡ç†çš„è¿˜æ˜¯å°‘æ•°å‡ å°æœºå™¨ã€‚å½“æˆ‘ä»¬é¢ä¸´æ•°æ®ä¸­å¿ƒæˆåƒä¸Šä¸‡å°æœºå™¨çš„æ—¶å€™ï¼Œä»ç„¶éå¸¸â€œç—›è‹¦â€ã€‚å¦‚æœæˆ‘ä»¬è¿ç»´æ•°æ®ä¸­å¿ƒä¾ç„¶åƒè¿ç»´ä¸€å°å°ç‰©ç†æœºçš„å‰è¾ˆä¸€æ ·ï¼Œå¤©å¤©å…³å¿ƒå“ªä¸ªç¨‹åºæ”¾åœ¨äº†å“ªå°æœºå™¨ä¸Šï¼Œä½¿ç”¨å¤šå°‘å†…å­˜ã€å¤šå°‘ç¡¬ç›˜ï¼Œæ¯å°æœºå™¨æ€»å…±æœ‰å¤šå°‘å†…å­˜ã€å¤šå°‘ç¡¬ç›˜ï¼Œè¿˜å‰©å¤šå°‘å†…å­˜å’Œç¡¬ç›˜ï¼Œé‚£å¤´å°±å¤§äº†ã€‚</p><!-- [[[read_end]]] --><p>å› è€Œå¯¹åº”åˆ°æ•°æ®ä¸­å¿ƒï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ä¸ªè°ƒåº¦å™¨ï¼Œå°†è¿ç»´äººå‘˜ä»æŒ‡å®šç‰©ç†æœºæˆ–è€…è™šæ‹Ÿæœºçš„ç—›è‹¦ä¸­è§£æ”¾å‡ºæ¥ï¼Œå®ç°å¯¹äºç‰©ç†èµ„æºçš„ç»Ÿä¸€ç®¡ç†ï¼Œè¿™å°±æ˜¯Kubernetesã€‚</p><p>Kubernetesç©¶ç«Ÿæœ‰å“ªäº›åŠŸèƒ½ï¼Œå¯ä»¥è§£æ”¾è¿ç»´äººå‘˜å‘¢ï¼Ÿä¸ºä»€ä¹ˆå®ƒèƒ½åšæ•°æ®ä¸­å¿ƒçš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ</p><p>æˆ‘åˆ—äº†ä¸¤ä¸ªè¡¨æ ¼ï¼Œå°†æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½å’Œæ¨¡å—ä¸Kubernetesçš„åŠŸèƒ½å’Œæ¨¡å—åšäº†ä¸€ä¸ªå¯¹æ¯”ï¼Œä½ å¯ä»¥çœ‹çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/49/47/497c8c2c0cb193e0380ed1d7c82ac147.jpeg?wh=2023*2161\" alt=\"\"></p><p>Kubernetesä½œä¸ºæ•°æ®ä¸­å¿ƒçš„æ“ä½œç³»ç»Ÿè¿˜æ˜¯ä¸»è¦ç®¡ç†æ•°æ®ä¸­å¿ƒé‡Œé¢çš„å››ç§ç¡¬ä»¶èµ„æºï¼šCPUã€å†…å­˜ã€å­˜å‚¨ã€ç½‘ç»œã€‚</p><p>å¯¹äºCPUå’Œå†…å­˜è¿™ä¸¤ç§è®¡ç®—èµ„æºçš„ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡DockeræŠ€æœ¯å®Œæˆã€‚å®ƒå¯ä»¥å°†CPUå’Œå†…å­˜èµ„æºï¼Œé€šè¿‡namespaceå’Œcgroupï¼Œä»å¤§çš„èµ„æºæ± é‡Œé¢éš”ç¦»å‡ºæ¥ï¼Œå¹¶é€šè¿‡é•œåƒæŠ€æœ¯ï¼Œå®ç°è®¡ç®—èµ„æºåœ¨æ•°æ®ä¸­å¿ƒé‡Œé¢çš„è‡ªç”±æ¼‚ç§»ã€‚</p><p>å°±åƒæˆ‘ä»¬ä¸Šé¢è¯´çš„ä¸€æ ·ï¼Œæ²¡æœ‰æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œæ±‡ç¼–ç¨‹åºå‘˜éœ€è¦æŒ‡å®šç¨‹åºè¿è¡Œçš„CPUå’Œå†…å­˜ç‰©ç†åœ°å€ã€‚åŒç†ï¼Œæ•°æ®ä¸­å¿ƒçš„ç®¡ç†å‘˜ï¼ŒåŸæ¥è¿˜éœ€è¦æŒ‡å®šç¨‹åºè¿è¡Œçš„æœåŠ¡å™¨åŠä½¿ç”¨çš„CPUå’Œå†…å­˜ã€‚ç°åœ¨ï¼ŒKubernetesé‡Œé¢æœ‰ä¸€ä¸ªè°ƒåº¦å™¨Schedulerï¼Œä½ åªéœ€è¦å‘Šè¯‰å®ƒï¼Œä½ æƒ³è¿è¡Œ10ä¸ª4æ ¸8Gçš„Javaç¨‹åºï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ é€‰æ‹©ç©ºé—²çš„ã€æœ‰è¶³å¤Ÿèµ„æºçš„æœåŠ¡å™¨ï¼Œå»è¿è¡Œè¿™äº›ç¨‹åºã€‚</p><p>å¯¹äºæ“ä½œç³»ç»Ÿä¸Šçš„è¿›ç¨‹æ¥è®²ï¼Œæœ‰ä¸»çº¿ç¨‹åšä¸»è¦çš„å·¥ä½œï¼Œè¿˜æœ‰å…¶å®ƒçº¿ç¨‹åšè¾…åŠ©çš„å·¥ä½œã€‚å¯¹äºæ•°æ®ä¸­å¿ƒé‡Œé¢çš„è¿è¡Œçš„ç¨‹åºæ¥è®²ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªä¸»è¦æä¾›æœåŠ¡çš„ç¨‹åºï¼Œä¾‹å¦‚ä¸Šé¢çš„Javaç¨‹åºï¼Œä¹Ÿä¼šæœ‰ä¸€äº›æä¾›è¾…åŠ©åŠŸèƒ½çš„ç¨‹åºï¼›ä¾‹å¦‚ç›‘æ§ã€ç¯å¢ƒé¢„è®¾å€¼ç­‰ã€‚Kuberneteså°†å¤šä¸ªDockerç»„è£…æˆä¸€ä¸ªPodçš„æ¦‚å¿µã€‚åœ¨ä¸€ä¸ªPodé‡Œé¢ï¼Œå¾€å¾€æœ‰ä¸€ä¸ªDockerä¸ºä¸»ï¼Œå¤šä¸ªDockerä¸ºè¾…ã€‚</p><p>æ“ä½œç³»ç»Ÿä¸Šçš„è¿›ç¨‹ä¼šåœ¨CPUä¸Šåˆ‡æ¢æ¥åˆ‡æ¢å»ï¼Œå®ƒä½¿ç”¨çš„å†…å­˜ä¹Ÿä¼šæ¢å…¥æ¢å‡ºã€‚åœ¨æ•°æ®ä¸­å¿ƒé‡Œé¢ï¼Œè¿™äº›è¿è¡Œä¸­çš„ç¨‹åºèƒ½ä¸èƒ½åœ¨æœºå™¨ä¹‹é—´è¿ç§»å‘¢ï¼Ÿèƒ½ä¸èƒ½åœ¨ä¸€å°æœåŠ¡å™¨æ•…éšœçš„æ—¶å€™ï¼Œé€‰æ‹©å…¶å®ƒçš„æœåŠ¡å™¨è¿è¡Œå‘¢ï¼Ÿåæ­£æˆ‘å…³å¿ƒçš„æ˜¯è¿è¡Œ10ä¸ª4æ ¸8Gçš„Javaç¨‹åºï¼Œåˆä¸åœ¨ä¹å®ƒåœ¨å“ªå°ä¸Šè¿è¡Œã€‚</p><p>Kubernetesé‡Œé¢æœ‰Controllerçš„æ¦‚å¿µï¼Œå¯ä»¥æ§åˆ¶Podä»¬çš„è¿è¡ŒçŠ¶æ€ä»¥åŠå ç”¨çš„èµ„æºã€‚å¦‚æœ10ä¸ªå˜9ä¸ªäº†ï¼Œå°±é€‰ä¸€å°æœºå™¨æ·»åŠ ä¸€ä¸ªï¼›å¦‚æœ10ä¸ªå˜11ä¸ªäº†ï¼Œå°±éšæœºåˆ é™¤ä¸€ä¸ªã€‚</p><p>æ“ä½œç³»ç»Ÿä¸Šçš„è¿›ç¨‹æœ‰æ—¶å€™æœ‰äº²å’Œæ€§çš„è¦æ±‚ï¼Œæ¯”å¦‚å®ƒå¯èƒ½å¸Œæœ›åœ¨æŸä¸€ä¸ªCPUä¸Šè¿è¡Œï¼Œä¸åˆ‡æ¢CPUï¼Œä»è€Œæé«˜è¿è¡Œæ•ˆç‡ã€‚æˆ–è€…ï¼Œä¸¤ä¸ªçº¿ç¨‹è¦æ±‚åœ¨ä¸€ä¸ªCPUä¸Šï¼Œä»è€Œå¯ä»¥ä½¿ç”¨Per CPUå˜é‡ä¸åŠ é”ï¼Œäº¤äº’å’Œåä½œæ¯”è¾ƒæ–¹ä¾¿ã€‚æœ‰çš„æ—¶å€™ï¼Œä¸€ä¸ªçº¿ç¨‹æƒ³é¿å¼€å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸è¦å…±ç”¨CPUï¼Œä»¥é˜²ç›¸äº’å¹²æ‰°ã€‚Kubernetesçš„Schedulerä¹Ÿæ˜¯æœ‰äº²å’Œæ€§åŠŸèƒ½çš„ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸¤ä¸ªPodæ°¸è¿œè¿è¡Œåœ¨ä¸€å°ç‰©ç†æœºä¸Šï¼Œè¿™æ ·æœ¬åœ°é€šä¿¡å°±éå¸¸æ–¹ä¾¿äº†ï¼›ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸¤ä¸ªPodæ°¸è¿œä¸è¦è¿è¡Œåœ¨åŒä¸€å°ç‰©ç†æœºä¸Šï¼Œè¿™æ ·ä¸€ä¸ªæŒ‚äº†ä¸å½±å“å¦ä¸€ä¸ªã€‚</p><p>ä½ å¯èƒ½ä¼šé—®ï¼ŒDockerå¯ä»¥å°†CPUå†…å­˜èµ„æºè¿›è¡ŒæŠ½è±¡ï¼Œåœ¨æœåŠ¡å™¨ä¹‹é—´è¿ç§»ï¼Œé‚£æ•°æ®åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¦‚æœæ•°æ®æ”¾åœ¨æ¯ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå…¶å®å°±åƒæ•£è½åœ¨æ±ªæ´‹å¤§æµ·é‡Œé¢ï¼Œç”¨çš„æ—¶å€™æ ¹æœ¬æ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰ç»Ÿä¸€çš„å­˜å‚¨ã€‚æ­£åƒä¸€å°æ“ä½œç³»ç»Ÿä¸Šå¤šä¸ªè¿›ç¨‹ä¹‹é—´ï¼Œè¦é€šè¿‡æ–‡ä»¶ç³»ç»Ÿä¿å­˜æŒä¹…åŒ–çš„æ•°æ®å¹¶ä¸”å®ç°å…±äº«ï¼Œåœ¨æ•°æ®ä¸­å¿ƒé‡Œé¢ä¹Ÿéœ€è¦ä¸€ä¸ªè¿™æ ·çš„åŸºç¡€è®¾æ–½ã€‚</p><p>ç»Ÿä¸€çš„å­˜å‚¨å¸¸å¸¸æœ‰ä¸‰ç§å½¢å¼ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥çœ‹ã€‚</p><p>ç¬¬ä¸€ç§æ–¹å¼æ˜¯<strong>å¯¹è±¡å­˜å‚¨</strong>ã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œè¿™ç§æ–¹å¼æ˜¯å°†æ–‡ä»¶ä½œä¸ºä¸€ä¸ªå®Œæ•´å¯¹è±¡çš„æ–¹å¼æ¥ä¿å­˜ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œéƒ½åº”è¯¥æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†è¿™ä¸ªå¯¹è±¡çš„keyï¼Œè€Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯valueã€‚å¯¹è±¡å¯ä»¥åˆ†é—¨åˆ«ç±»åœ°ä¿å­˜åœ¨ä¸€ä¸ªå«ä½œå­˜å‚¨ç©ºé—´ï¼ˆBucketï¼‰çš„åœ°æ–¹ï¼Œæœ‰ç‚¹å„¿åƒæ–‡ä»¶å¤¹ã€‚</p><p>å¯¹äºä»»ä½•ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡HTTP RESTful APIæ¥è¿œç¨‹è·å–å¯¹è±¡ã€‚ç”±äºæ˜¯ç®€å•çš„key-valueæ¨¡å¼ï¼Œå½“éœ€è¦ä¿å­˜å¤§å®¹é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æ¯”è¾ƒå®¹æ˜“æ ¹æ®å”¯ä¸€çš„keyè¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œæ‰€ä»¥å¯¹è±¡å­˜å‚¨èƒ½å¤Ÿå®¹çº³çš„æ•°æ®é‡å¾€å¾€éå¸¸å¤§ã€‚åœ¨æ•°æ®ä¸­å¿ƒé‡Œé¢ä¿å­˜æ–‡æ¡£ã€è§†é¢‘ç­‰æ˜¯å¾ˆå¥½çš„æ–¹å¼ï¼Œå½“ç„¶ç¼ºç‚¹å°±æ˜¯ï¼Œä½ æ²¡åŠæ³•åƒæ“ä½œæ–‡ä»¶ä¸€æ ·æ“ä½œå®ƒï¼Œè€Œæ˜¯è¦å°†valueå½“æˆæ•´ä¸ªçš„æ¥å¯¹å¾…ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯<strong>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</strong>ã€‚</p><p>è¿™ç§æ˜¯æœ€å®¹æ˜“ä¹ æƒ¯çš„ï¼Œå› ä¸ºä½¿ç”¨å®ƒå’Œä½¿ç”¨æœ¬åœ°çš„æ–‡ä»¶ç³»ç»Ÿå‡ ä¹æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªä¸è¿‡æ˜¯é€šè¿‡ç½‘ç»œçš„æ–¹å¼è®¿é—®è¿œç¨‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¤šä¸ªå®¹å™¨èƒ½çœ‹åˆ°ç»Ÿä¸€çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¸€ä¸ªå®¹å™¨å†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼Œå¦ä¸€ä¸ªå®¹å™¨èƒ½å¤Ÿçœ‹åˆ°ï¼Œå¯ä»¥å®ç°å…±äº«ã€‚ç¼ºç‚¹æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½å’Œè§„æ¨¡æ˜¯ä¸ªçŸ›ç›¾ï¼Œè§„æ¨¡ä¸€å¤§æ€§èƒ½å°±éš¾ä»¥ä¿è¯ï¼Œæ€§èƒ½å¥½åˆ™è§„æ¨¡ä¸ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥ä¸åƒå¯¹è±¡å­˜å‚¨ä¸€æ ·èƒ½å¤Ÿä¿æŒæµ·é‡çš„æ•°æ®ã€‚</p><p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯<strong>åˆ†å¸ƒå¼å—å­˜å‚¨</strong>ã€‚</p><p>è¿™å°±ç›¸å½“äºäº‘ç¡¬ç›˜ï¼Œä¹Ÿå³å­˜å‚¨è™šæ‹ŸåŒ–çš„æ–¹å¼ï¼Œåªä¸è¿‡å°†ç›˜æŒ‚è½½ç»™å®¹å™¨è€Œä¸æ˜¯è™šæ‹Ÿæœºã€‚å—å­˜å‚¨æ²¡æœ‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¿™ä¸€å±‚ï¼Œä¸€æ—¦æŒ‚è½½åˆ°æŸä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥æœ‰æœ¬åœ°çš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸åŒå®¹å™¨æŒ‚è½½çš„å—å­˜å‚¨éƒ½æ˜¯ä¸å…±äº«çš„ï¼Œå¥½å¤„æ˜¯åœ¨åŒæ ·è§„æ¨¡çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½ç›¸å¯¹åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¦å¥½ã€‚å¦‚æœä¸ºäº†è§£å†³ä¸€ä¸ªå®¹å™¨ä»ä¸€å°æœåŠ¡å™¨è¿ç§»åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œå¦‚ä½•ä¿æŒæ•°æ®å­˜å‚¨çš„é—®é¢˜ï¼Œå—å­˜å‚¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚å®ƒä¸ç”¨è§£å†³å¤šä¸ªå®¹å™¨å…±äº«æ•°æ®çš„é—®é¢˜ã€‚</p><p>è¿™ä¸‰ç§å½¢å¼ï¼Œå¯¹è±¡å­˜å‚¨ä½¿ç”¨HTTPè¿›è¡Œè®¿é—®ï¼Œå½“ç„¶ä»»ä½•å®¹å™¨éƒ½èƒ½è®¿é—®åˆ°ï¼Œä¸éœ€è¦Kuberneteså»ç®¡ç†å®ƒã€‚è€Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼å—å­˜å‚¨ï¼Œå°±éœ€è¦å¯¹æ¥åˆ°Kubernetesï¼Œè®©Kuberneteså¯ä»¥ç®¡ç†å®ƒä»¬ã€‚å¦‚ä½•å¯¹æ¥å‘¢ï¼ŸKubernetesæä¾›Container Storage Interfaceï¼ˆCSIï¼‰æ¥å£ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†æ¥å£ï¼Œä¸åŒçš„å­˜å‚¨å¯ä»¥å®ç°è¿™ä¸ªæ¥å£æ¥å¯¹æ¥Kubernetesã€‚æ˜¯ä¸æ˜¯ç‰¹åˆ«åƒè®¾å¤‡é©±åŠ¨ç¨‹åºå‘€ï¼Ÿæ“ä½œç³»ç»Ÿåªè¦å®šä¹‰ç»Ÿä¸€çš„æ¥å£ï¼Œä¸åŒçš„å­˜å‚¨è®¾å¤‡çš„é©±åŠ¨å®ç°è¿™äº›æ¥å£ï¼Œå°±èƒ½è¢«æ“ä½œç³»ç»Ÿä½¿ç”¨äº†ã€‚</p><p>å­˜å‚¨çš„é—®é¢˜è§£å†³äº†ï¼Œæ¥ä¸‹æ¥æ˜¯ç½‘ç»œã€‚å› ä¸ºä¸åŒçš„æœåŠ¡å™¨ä¸Šçš„Dockerè¿˜æ˜¯éœ€è¦äº’ç›¸é€šä¿¡çš„ã€‚</p><p>Kubernetesæœ‰è‡ªå·±çš„ç½‘ç»œæ¨¡å‹ï¼Œé‡Œé¢æ˜¯è¿™æ ·è§„å®šçš„ã€‚</p><p>1.IP-per-Podï¼Œæ¯ä¸ª Pod éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹ IP åœ°å€ï¼ŒPod å†…æ‰€æœ‰å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ã€‚<br>\n2.é›†ç¾¤å†…æ‰€æœ‰ Pod éƒ½åœ¨ä¸€ä¸ªç›´æ¥è¿é€šçš„æ‰å¹³ç½‘ç»œä¸­ï¼Œå¯é€šè¿‡ IP ç›´æ¥è®¿é—®ã€‚</p><ul>\n<li>æ‰€æœ‰å®¹å™¨ä¹‹é—´æ— éœ€ NAT å°±å¯ä»¥ç›´æ¥äº’ç›¸è®¿é—®ã€‚</li>\n<li>æ‰€æœ‰ Node å’Œæ‰€æœ‰å®¹å™¨ä¹‹é—´æ— éœ€ NAT å°±å¯ä»¥ç›´æ¥äº’ç›¸è®¿é—®ã€‚</li>\n<li>å®¹å™¨è‡ªå·±çœ‹åˆ°çš„ IP è·Ÿå…¶å®ƒå®¹å™¨çœ‹åˆ°çš„ä¸€æ ·ã€‚</li>\n</ul><p>è¿™å…¶å®æ˜¯è¯´ï¼Œé‡Œé¢çš„æ¯ä¸€ä¸ªDockerè®¿é—®å¦ä¸€ä¸ªDockerçš„æ—¶å€™ï¼Œéƒ½æ˜¯æ„Ÿè§‰åœ¨ä¸€ä¸ªæ‰å¹³çš„ç½‘ç»œé‡Œé¢ã€‚</p><p>è¦å®ç°è¿™æ ·çš„ç½‘ç»œæ¨¡å‹ï¼Œæœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œä¾‹å¦‚Kubernetesè‡ªå·±æä¾›Calicoã€Flannelã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å¯¹æ¥Openvswitchè¿™æ ·çš„è™šæ‹Ÿäº¤æ¢æœºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨brctlè¿™ç§ä¼ ç»Ÿçš„æ¡¥æ¥æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥å¯¹æ¥ç¡¬ä»¶äº¤æ¢æœºã€‚</p><p>çœ‹ï¼Œè¿™åˆæ˜¯ä¸€ç§ç±»ä¼¼é©±åŠ¨çš„æ¨¡å¼ï¼Œå’Œæ“ä½œç³»ç»Ÿé¢ä¸´çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ã€‚KubernetesåŒæ ·æ˜¯æä¾›ç»Ÿä¸€çš„æ¥å£Container Network Interfaceï¼ˆCNIï¼Œå®¹å™¨ç½‘ç»œæ¥å£ï¼‰ã€‚æ— è®ºä½ ç”¨å“ªç§æ–¹å¼å®ç°ç½‘ç»œæ¨¡å‹ï¼Œåªè¦å¯¹æ¥è¿™ä¸ªç»Ÿä¸€çš„æ¥å£ï¼ŒKuberneteså°±å¯ä»¥ç®¡ç†å®¹å™¨çš„ç½‘ç»œã€‚</p><p>è‡³æ­¤ï¼ŒKubernetesä½œä¸ºæ•°æ®ä¸­å¿ƒçš„æ“ä½œç³»ç»Ÿï¼Œå†…æ ¸çš„é—®é¢˜è§£å†³äº†ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ç”¨æˆ·æ€çš„å·¥ä½œæ¨¡å¼é—®é¢˜äº†ã€‚æˆ‘ä»¬èƒ½ä¸èƒ½åƒæ“ä½œä¸€å°æœåŠ¡å™¨é‚£æ ·æ“ä½œæ•°æ®ä¸­å¿ƒå‘¢ï¼Ÿ</p><p>ä½¿ç”¨æ“ä½œç³»ç»Ÿï¼Œéœ€è¦å®‰è£…ä¸€äº›è½¯ä»¶ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦yumä¹‹ç±»çš„åŒ…ç®¡ç†ç³»ç»Ÿï¼Œä½¿å¾—è½¯ä»¶çš„ä½¿ç”¨è€…å’Œè½¯ä»¶çš„ç¼–è¯‘è€…åˆ†éš”å¼€æ¥ï¼Œè½¯ä»¶çš„ç¼–è¯‘è€…éœ€è¦çŸ¥é“è¿™ä¸ªè½¯ä»¶éœ€è¦å®‰è£…å“ªäº›åŒ…ï¼ŒåŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»æ˜¯ä»€ä¹ˆï¼Œè½¯ä»¶å®‰è£…åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œè€Œè½¯ä»¶çš„ä½¿ç”¨è€…ä»…ä»…éœ€è¦yum installå°±å¯ä»¥äº†ã€‚Kuberneteså°±æœ‰è¿™æ ·ä¸€å¥—åŒ…ç®¡ç†è½¯ä»¶Helmï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥å¾ˆæ–¹ä¾¿åœ°å®‰è£…ã€å‡çº§ã€æ‰©å®¹ä¸€äº›æ•°æ®ä¸­å¿ƒé‡Œé¢çš„å¸¸ç”¨è½¯ä»¶ï¼Œä¾‹å¦‚æ•°æ®åº“ã€ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><p>ä½¿ç”¨æ“ä½œç³»ç»Ÿï¼Œè¿è¡Œä¸€ä¸ªè¿›ç¨‹æ˜¯æœ€å¸¸è§çš„éœ€æ±‚ã€‚ç¬¬ä¸€ç§è¿›ç¨‹æ˜¯<strong>äº¤äº’å¼å‘½ä»¤è¡Œ</strong>ï¼Œè¿è¡Œèµ·æ¥å°±æ˜¯æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œç»“æŸäº†é©¬ä¸Šè¿”å›ç»“æœã€‚åœ¨Kubernetesé‡Œé¢æœ‰å¯¹åº”çš„æ¦‚å¿µå«ä½œJobï¼ŒJob è´Ÿè´£æ‰¹é‡å¤„ç†çŸ­æš‚çš„ä¸€æ¬¡æ€§ä»»åŠ¡ (Short Lived One-off Tasks)ï¼Œå³ä»…æ‰§è¡Œä¸€æ¬¡çš„ä»»åŠ¡ï¼Œå®ƒä¿è¯æ‰¹å¤„ç†ä»»åŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ª Pod æˆåŠŸç»“æŸã€‚</p><p>ç¬¬äºŒç§è¿›ç¨‹æ˜¯<strong>nohupï¼ˆé•¿æœŸè¿è¡Œï¼‰</strong>çš„è¿›ç¨‹ã€‚åœ¨Kubernetesé‡Œå¯¹åº”çš„æ¦‚å¿µæ˜¯Deploymentï¼Œä½¿ç”¨ Deployment æ¥åˆ›å»º ReplicaSetã€‚ReplicaSet åœ¨åå°åˆ›å»º Podã€‚ä¹Ÿå³ï¼ŒDoploymenté‡Œé¢ä¼šå£°æ˜æˆ‘å¸Œæœ›æŸä¸ªè¿›ç¨‹ä»¥Nçš„Podå‰¯æœ¬çš„å½¢å¼è¿è¡Œï¼Œå¹¶ä¸”é•¿æœŸè¿è¡Œï¼Œä¸€æ—¦å‰¯æœ¬å˜å°‘å°±ä¼šè‡ªåŠ¨æ·»åŠ ã€‚</p><p>ç¬¬ä¸‰ç§è¿›ç¨‹æ˜¯<strong>ç³»ç»ŸæœåŠ¡</strong>ã€‚åœ¨Kubernetesé‡Œé¢å¯¹åº”çš„æ¦‚å¿µæ˜¯DaemonSetï¼Œå®ƒä¿è¯åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œä¸€ä¸ªå®¹å™¨å‰¯æœ¬ï¼Œå¸¸ç”¨æ¥éƒ¨ç½²ä¸€äº›é›†ç¾¤çš„æ—¥å¿—ã€ç›‘æ§æˆ–è€…å…¶ä»–ç³»ç»Ÿç®¡ç†åº”ç”¨ã€‚</p><p>ç¬¬å››ç§è¿›ç¨‹æ˜¯<strong>å‘¨æœŸæ€§è¿›ç¨‹</strong>ï¼Œä¹Ÿå³Crontabï¼Œå¸¸å¸¸ç”¨æ¥è®¾ç½®ä¸€äº›å‘¨æœŸæ€§çš„ä»»åŠ¡ã€‚åœ¨Kubernetesé‡Œé¢å¯¹åº”çš„æ¦‚å¿µæ˜¯CronJobï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰ï¼Œå°±ç±»ä¼¼äº Linux ç³»ç»Ÿçš„ Crontabï¼Œåœ¨æŒ‡å®šçš„æ—¶é—´å‘¨æœŸè¿è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚</p><p>ä½¿ç”¨æ“ä½œç³»ç»Ÿï¼Œæˆ‘ä»¬è¿˜éœ€ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ–è€…ä½¿ç”¨ç½‘ç»œå‘é€æ•°æ®ã€‚è™½ç„¶åœ¨Kubernetesé‡Œé¢æœ‰CSIå’ŒCNIæ¥å¯¹æ¥å­˜å‚¨å’Œç½‘ç»œï¼Œä½†æ˜¯åœ¨ç”¨æˆ·æ€ï¼Œä¸èƒ½è®©ç”¨æˆ·æ„è¯†åˆ°åé¢å…·ä½“è®¾å¤‡ï¼Œè€Œæ˜¯åº”è¯¥æœ‰æŠ½è±¡çš„æ¦‚å¿µã€‚</p><p>å¯¹äºå­˜å‚¨æ¥è®²ï¼ŒKubernetesæœ‰Volumeçš„æ¦‚å¿µã€‚Kubernetes Volume çš„ç”Ÿå‘½å‘¨æœŸä¸ Pod ç»‘å®šåœ¨ä¸€èµ·ï¼Œå®¹å™¨æŒ‚æ‰åï¼ŒKubelet å†æ¬¡é‡å¯å®¹å™¨æ—¶ï¼ŒVolume çš„æ•°æ®ä¾ç„¶è¿˜åœ¨ï¼Œè€Œ Pod åˆ é™¤æ—¶ï¼ŒVolume æ‰ä¼šçœŸçš„è¢«æ¸…ç†ã€‚æ•°æ®æ˜¯å¦ä¸¢å¤±å–å†³äºå…·ä½“çš„ Volume ç±»å‹ã€‚Volumeçš„æ¦‚å¿µæ˜¯å¯¹å…·ä½“å­˜å‚¨è®¾å¤‡çš„æŠ½è±¡ï¼Œå°±åƒå½“æˆ‘ä»¬ä½¿ç”¨ext4æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œä¸ç”¨ç®¡å®ƒæ˜¯åŸºäºä»€ä¹ˆç¡¬ç›˜ä¸€æ ·ã€‚</p><p>å¯¹äºç½‘ç»œæ¥è®²ï¼ŒKubernetesæœ‰è‡ªå·±çš„DNSï¼Œæœ‰Serviceçš„æ¦‚å¿µã€‚Kubernetes Serviceæ˜¯ä¸€ä¸ª Pod çš„é€»è¾‘åˆ†ç»„ï¼Œè¿™ä¸€ç»„ Pod èƒ½å¤Ÿè¢« Service è®¿é—®ã€‚æ¯ä¸€ä¸ªServiceéƒ½ä¸€ä¸ªåå­—ï¼ŒKubernetesä¼šå°†Serviceçš„åå­—ä½œä¸ºåŸŸåè§£ææˆä¸ºä¸€ä¸ªè™šæ‹Ÿçš„Cluster IPï¼Œç„¶åé€šè¿‡è´Ÿè½½å‡è¡¡ï¼Œè½¬å‘åˆ°åç«¯çš„Podã€‚è™½ç„¶Podå¯èƒ½æ¼‚ç§»ï¼ŒIPä¼šå˜ï¼Œä½†æ˜¯Serviceä¼šä¸€ç›´ä¸å˜ã€‚</p><p>å¯¹åº”åˆ°Linuxæ“ä½œç³»ç»Ÿçš„iptablesï¼ŒKubernetes åœ¨æœ‰ä¸ªæ¦‚å¿µå«Network Policyï¼ŒNetwork Policy æä¾›äº†åŸºäºç­–ç•¥çš„ç½‘ç»œæ§åˆ¶ï¼Œç”¨äºéš”ç¦»åº”ç”¨å¹¶å‡å°‘æ”»å‡»é¢ã€‚å®ƒä½¿ç”¨æ ‡ç­¾é€‰æ‹©å™¨æ¨¡æ‹Ÿä¼ ç»Ÿçš„åˆ†æ®µç½‘ç»œï¼Œå¹¶é€šè¿‡ç­–ç•¥æ§åˆ¶å®ƒä»¬ä¹‹é—´çš„æµé‡ä»¥åŠæ¥è‡ªå¤–éƒ¨çš„æµé‡ã€‚</p><p>çœ‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Ÿæœ‰äº†Kubernetesï¼Œæˆ‘ä»¬å°±èƒ½åƒç®¡ç†ä¸€å°LinuxæœåŠ¡å™¨é‚£æ ·ï¼Œå»ç®¡ç†æ•°æ®ä¸­å¿ƒäº†ã€‚</p><p>å¦‚æœæƒ³æ·±å…¥äº†è§£Kubernetesè¿™ä¸ªæ•°æ®ä¸­å¿ƒçš„æ“ä½œç³»ç»Ÿï¼Œä½ å¯ä»¥è®¢é˜…æå®¢æ—¶é—´çš„ä¸“æ â€œ<a href=\"https://time.geekbang.org/column/article/114197\">æ·±å…¥å‰–æKubernetes</a>â€ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>ä¸‹é¢ï¼Œä½ å¯ä»¥å¯¹ç…§ç€è¿™ä¸ªå›¾ï¼Œæ¥æ€»ç»“ä¸€ä¸‹è¿™ä¸ªæ•°æ®ä¸­å¿ƒæ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/e5/1a8450f1fcda83b75c9ba301ebf9fbe5.jpg?wh=2629*1333\" alt=\"\"></p><h2>è¯¾å ‚ç»ƒä¹ </h2><p>Kubernetesæœ‰ä¸€ä¸ªç®€å•çš„ç‰ˆæœ¬ï¼Œä½ å¯ä»¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ï¼Œç”¨ä¸€å°è™šæ‹Ÿæœºå®‰è£…ä¸€ä¸ªï¼Œè¯•éªŒä¸€ä¸‹ã€‚</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„ç–‘æƒ‘å’Œè§è§£ï¼Œä¹Ÿæ¬¢è¿æ”¶è—æœ¬èŠ‚å†…å®¹ï¼Œåå¤ç ”è¯»ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œå’Œä»–ä¸€èµ·å­¦ä¹ å’Œè¿›æ­¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/37/8c0a95fa07a8b9a1abfd394479bdd637.jpg?wh=1110*659\" alt=\"\"></p>","neighbors":{"left":{"article_title":"58 | cgroupæŠ€æœ¯ï¼šå†…éƒ¨åˆ›ä¸šå…¬å¸åº”è¯¥ç‹¬ç«‹æ ¸ç®—æˆæœ¬","id":115582},"right":{"article_title":"60 | æ­å»ºæ“ä½œç³»ç»Ÿå®éªŒç¯å¢ƒï¼ˆä¸Šï¼‰ï¼šæˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”","id":117924}},"comments":[{"had_liked":false,"id":123551,"user_name":"Boyang","can_delete":false,"product_type":"c1","uid":1115100,"ip_address":"","ucode":"E0767E5767F670","user_header":"https://static001.geekbang.org/account/avatar/00/11/03/dc/f3347b1e.jpg","comment_is_top":false,"comment_ctime":1565699878,"is_pvip":false,"replies":[{"id":"46298","content":"æ²¡æœ‰ï¼Œæˆ‘æ˜¯å†™ä¸“æ å ç”¨å¤ªå¤šæ—¶é—´äº†ï¼Œæ‰€ä»¥æ²¡æ¥å¾—åŠå›","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566282937,"ip_address":"","comment_id":123551,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27335503654","product_id":100024701,"comment_content":"æˆ‘ä¹‹å‰çš„ç•™è¨€ï¼Œæåˆ°çš„æ˜¯ä¸æ˜¯é—®é¢˜ï¼Œå¦‚æœä¸å¯¹å“ªæ€•æ¢è®¨ä¸€ä¸‹å‘¢ã€‚ã€‚ã€‚","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462723,"discussion_content":"æ²¡æœ‰ï¼Œæˆ‘æ˜¯å†™ä¸“æ å ç”¨å¤ªå¤šæ—¶é—´äº†ï¼Œæ‰€ä»¥æ²¡æ¥å¾—åŠå›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566282937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297619,"user_name":"é™âœ¨","can_delete":false,"product_type":"c1","uid":1658413,"ip_address":"","ucode":"1B33229C206339","user_header":"https://static001.geekbang.org/account/avatar/00/19/4e/2d/06d3f9f5.jpg","comment_is_top":false,"comment_ctime":1623673565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18803542749","product_id":100024701,"comment_content":"è¿™èŠ‚çœŸæ˜¯å¤ªæ£’äº†ï¼ï¼ï¼","like_count":5},{"had_liked":false,"id":123192,"user_name":"fy","can_delete":false,"product_type":"c1","uid":1152186,"ip_address":"","ucode":"EDB661C3A05910","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/jsMMDDzhbsTzhicsGZiaeV0PWSnAS0fBlb1r6CsuB32vr3hRwV9UubmfHQx45v7jtaXajPlQ8kQ17b3zpQzHmqVw/132","comment_is_top":false,"comment_ctime":1565623165,"is_pvip":false,"replies":[{"id":"46308","content":"èµï¼ŒåŠ æ²¹","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566283415,"ip_address":"","comment_id":123192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18745492349","product_id":100024701,"comment_content":"èƒ½åšæŒä¸‹æ¥å°±æ˜¯å¯¹è€å¸ˆå¯¹æœ€å¤§çš„æ©èµ","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462574,"discussion_content":"èµï¼ŒåŠ æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566283415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125069,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1566054283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14450956171","product_id":100024701,"comment_content":"æœ‰è¶£çš„å¯¹æ¯”ğŸ‘","like_count":4},{"had_liked":false,"id":123101,"user_name":"D","can_delete":false,"product_type":"c1","uid":1027596,"ip_address":"","ucode":"5BB4D16FE39BFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/0c/f39f847a.jpg","comment_is_top":false,"comment_ctime":1565604807,"is_pvip":false,"replies":[{"id":"46314","content":"ä¸å°‘é—®å¾®å†…æ ¸çš„äº†ï¼Œæˆ‘ç ”ç©¶ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566286755,"ip_address":"","comment_id":123101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155539399","product_id":100024701,"comment_content":"è€å¸ˆï¼Œèƒ½å¦è®²è®²æœ€è¿‘æ¯”è¾ƒç«çš„å¾®å†…æ ¸ï¼ŒåŠ ä¸ªé¤?","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462540,"discussion_content":"ä¸å°‘é—®å¾®å†…æ ¸çš„äº†ï¼Œæˆ‘ç ”ç©¶ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566286755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123043,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1565596814,"is_pvip":false,"replies":[{"id":"46315","content":"åŠ æ²¹","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566286765,"ip_address":"","comment_id":123043,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10155531406","product_id":100024701,"comment_content":"è€å¸ˆè®²å¾—å¥½å•Šï¼Œæ·±å…¥æµ…å‡ºï¼Œè·Ÿç€è€å¸ˆä¸€èµ·ç²¾è¿›ã€‚","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462513,"discussion_content":"åŠ æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566286765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122841,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1565540179,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10155474771","product_id":100024701,"comment_content":"é€šä¿—æ˜“æ‡‚","like_count":2},{"had_liked":false,"id":300866,"user_name":"songyy","can_delete":false,"product_type":"c1","uid":1007201,"ip_address":"","ucode":"34D6443B91676D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/61/985f3eb7.jpg","comment_is_top":false,"comment_ctime":1625410432,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5920377728","product_id":100024701,"comment_content":"è¿™ä¸€èŠ‚çš„ç¡®å¾ˆæ£’ã€‚ä»é«˜å¤„ç€çœ¼ï¼ŒæŠŠKubernetesçš„æ¦‚å¿µè®²æ¸…æ¥šäº†ã€‚<br><br>ï¼ˆç›¸æ¯”ä¹‹ä¸‹â€¦â€¦ä¸Šä¸€èŠ‚ cgroupæˆ‘è§‰å¾—å°±æ²¡ä»é«˜å¤„ç€çœ¼ï¼Œå¤ªç»†èŠ‚äº†ã€‚ã€‚ï¼‰","like_count":1,"discussions":[{"author":{"id":1292330,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/VX0ib4CV0m7fwxB2xFcIJaYYWXXpfxxYbfBErqBej9395hgZszqS3dz9bThCxOuFfJ8Xibx9HbdNmZJwL5m33wIw/132","nickname":"chaoxifuchen","note":"","ucode":"95DCC5C4994F68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389625,"discussion_content":"ä¸ªäººæ„Ÿè§‰ï¼Œæœ‰å¾ˆå¤šç« èŠ‚ï¼Œè·Ÿè¸ªè°ƒç”¨ï¼Œéå¸¸ç»†èŠ‚ï¼Œä½†æ˜¯ç¼ºå°‘ä»é«˜å¤„ç€çœ¼çš„æè¿°ï¼Œè¿™ä¸€èŠ‚æ²¡æœ‰ç»†èŠ‚è®²k8sæ²¡æœ‰ç»†èŠ‚æ˜¯åº”è¯¥çš„ï¼Œåƒnamespaceé‚£ä¸€èŠ‚ï¼Œæœ‰æ¦‚æ‹¬æè¿°æœ‰ä»£ç ç»†èŠ‚ï¼Œéå¸¸å¥½ï¼Œå¦‚æœå…¶ä»–ç« èŠ‚ä¹Ÿèƒ½é‚£æ ·ï¼Œè¿™ä¸ªä¸“æ å°±æ›´ç»å…¸äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629361836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347487,"user_name":"Geek_278a2c","can_delete":false,"product_type":"c1","uid":2379572,"ip_address":"","ucode":"7EC0366896F0E6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/zWLzhGrHubcMJnNFz0s0akeMpefNBVy2jic3rxetxHIjy1icPjJBXFQc78AW10icVN47BLrWicHcSm9MOfG38J2kKw/132","comment_is_top":false,"comment_ctime":1654072649,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654072649","product_id":100024701,"comment_content":"è€å¸ˆï¼Œä½ è®²çš„linuxå†…æ ¸æ˜¯åŸºäºå“ªä¸ªç‰ˆæœ¬å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":331059,"user_name":"Run","can_delete":false,"product_type":"c1","uid":1371941,"ip_address":"","ucode":"6738D2F36ACFF6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLMDBq7lqg9ZasC4f21R0axKJRVCBImPKlQF8yOicLLXIsNgsZxsVyN1mbvFOL6eVPluTNgJofwZeA/132","comment_is_top":false,"comment_ctime":1642404172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642404172","product_id":100024701,"comment_content":"çš„ç¡®,k8sè¿™ä¹ˆå¯¹æ¯”è¿‡æ¥,å’Œæ“ä½œç³»ç»Ÿä¹Ÿæ²¡å•¥åŒºåˆ«,éƒ½æ˜¯åŸºäºèµ„æºçš„è°ƒåº¦","like_count":0},{"had_liked":false,"id":308150,"user_name":"æœ±ç†™","can_delete":false,"product_type":"c1","uid":1039029,"ip_address":"","ucode":"2B9E2B8645A844","user_header":"https://static001.geekbang.org/account/avatar/00/0f/da/b5/9d1f2f55.jpg","comment_is_top":false,"comment_ctime":1629430059,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629430059","product_id":100024701,"comment_content":"äºŒåˆ·åˆ°è¿™é‡Œäº†~å†è¿‡ä¸€éæ€»ç»“å»","like_count":0},{"had_liked":false,"id":277839,"user_name":"ç´«æ°”è¿·åŸ2","can_delete":false,"product_type":"c1","uid":2216392,"ip_address":"","ucode":"D390B73D070E7B","user_header":"","comment_is_top":false,"comment_ctime":1612617492,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612617492","product_id":100024701,"comment_content":"æ„Ÿè°¢åˆ†äº«","like_count":0},{"had_liked":false,"id":226540,"user_name":"Frame","can_delete":false,"product_type":"c1","uid":1628712,"ip_address":"","ucode":"57865AC3A1BAD5","user_header":"https://static001.geekbang.org/account/avatar/00/18/da/28/b09d3747.jpg","comment_is_top":false,"comment_ctime":1592133740,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592133740","product_id":100024701,"comment_content":"æ¢¦å¹»è”åŠ¨","like_count":0},{"had_liked":false,"id":144075,"user_name":"è«å","can_delete":false,"product_type":"c1","uid":1007254,"ip_address":"","ucode":"E28F2602BA25DD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/96/a03175bc.jpg","comment_is_top":false,"comment_ctime":1571840075,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571840075","product_id":100024701,"comment_content":"ä¸é”™çš„å¯¹æ¯”å½¢å¼ã€‚","like_count":0},{"had_liked":false,"id":136064,"user_name":"å°šå¢¨","can_delete":false,"product_type":"c1","uid":1300116,"ip_address":"","ucode":"114EE139168CB9","user_header":"http://thirdwx.qlogo.cn/mmopen/uqaRIfRCAhJ6t1z92XYEzXpqpgpS1veBc5DNGhfRHFsHgE19qHqG0cevcIJRRsjIKxsSEcIPVP1nOkaVKLibb2xFq04A4KMY3/132","comment_is_top":false,"comment_ctime":1569338233,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569338233","product_id":100024701,"comment_content":"è€å¸ˆå¯¹äº Mesos æ€ä¹ˆçœ‹å‘¢ï¼ŸMesos åœ¨æœ€åˆçš„è®¾æƒ³ä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®ä¸­å¿ƒæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚æˆ‘åœ¨åšå®¢å›­çœ‹è§æ‚¨çš„ Mesos æºç é˜…è¯»åˆ†äº«ã€‚","like_count":0},{"had_liked":false,"id":131599,"user_name":"æ½‡æ˜¯æ½‡æ´’çš„æ´’","can_delete":false,"product_type":"c1","uid":1250652,"ip_address":"","ucode":"CB950E0A655AA0","user_header":"https://static001.geekbang.org/account/avatar/00/13/15/5c/aa3f8306.jpg","comment_is_top":false,"comment_ctime":1567822875,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1567822875","product_id":100024701,"comment_content":"å¦‚æœ 10 ä¸ªå˜ 9 ä¸ªå°±é€‰ä¸€å°æœºå™¨æ·»åŠ ä¸€ä¸ªï¼Œ10 ä¸ªå˜ 11ä¸ª å°±åˆ é™¤ä¸€ä¸ªï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯å†™åäº†","like_count":0,"discussions":[{"author":{"id":1334409,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjRETqRjvLESLDZkNTjIiaSibtNYBaS1o8WMUicOFn3ycF3Mgh6LRJibqSBjVBjiaO2ibW0gHkafATb21A/132","nickname":"lmdcx","note":"","ucode":"F2CDD0091ADFD7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8313,"discussion_content":"â€œå…¶å®æ“ä½œç³»ç»Ÿæœ€æ€»è¦çš„äº‹æƒ…â€ï¼Œå—¯æœ€æ€»è¦ ^_^ï¼Œå°ç¼–ä½ è¿‡æ¥ï¼Œä½ å¿µçš„æ—¶å€™ä¸ä¼šå¤§èˆŒå¤´å—ï¼Ÿ\nåˆ˜è€å¸ˆçœ‹äº†30+æœ¬ä¹¦æ—å¾åšå¼•å¿™ä¸è¿‡æ¥ï¼Œå°ç¼–ä½ è¿‡æ¥ï¼Œè®©æˆ‘æ•²æ•²å°è„‘è¢‹ï¼Œä½ æ˜¯å’‹ä¸ªå®¡æ ¸çŸ«æ­£çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567914449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123443,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1565678023,"is_pvip":false,"replies":[{"id":"46302","content":"å¤šçœ‹å‡ éï¼Œæ€»ä¼šæœ‰æ”¶è·","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…@ç½‘æ˜“äº‘","uid":"1001590","ctime":1566283004,"ip_address":"","comment_id":123443,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565678023","product_id":100024701,"comment_content":"      ç°åœ¨å®Œå…¨åœ¨ç”¨åˆ˜è€å¸ˆä»‹ç»çš„å­¦ä¹ æ–¹æ³•åœ¨å­¦ä¹ ï¼šå¸Œæœ›åœ¨æ•°éä¹‹åèƒ½æ”¶è·åˆ°æƒ³è¦çš„ä¸œè¥¿ã€‚","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462675,"discussion_content":"å¤šçœ‹å‡ éï¼Œæ€»ä¼šæœ‰æ”¶è·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566283004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}