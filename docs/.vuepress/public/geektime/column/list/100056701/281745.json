{"id":281745,"title":"13 | GEOæ˜¯ä»€ä¹ˆï¼Ÿè¿˜å¯ä»¥å®šä¹‰æ–°çš„æ•°æ®ç±»å‹å—ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è’‹å¾·é’§ã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/268253\">ç¬¬2è®²</a>ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†Redisçš„5å¤§åŸºæœ¬æ•°æ®ç±»å‹ï¼šStringã€Listã€Hashã€Setå’ŒSorted Setï¼Œå®ƒä»¬å¯ä»¥æ»¡è¶³å¤§å¤šæ•°çš„æ•°æ®å­˜å‚¨éœ€æ±‚ï¼Œä½†æ˜¯åœ¨é¢å¯¹æµ·é‡æ•°æ®ç»Ÿè®¡æ—¶ï¼Œå®ƒä»¬çš„å†…å­˜å¼€é”€å¾ˆå¤§ï¼Œè€Œä¸”å¯¹äºä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ï¼Œå®ƒä»¬æ˜¯æ— æ³•æ”¯æŒçš„ã€‚æ‰€ä»¥ï¼ŒRedisè¿˜æä¾›äº†3ç§æ‰©å±•æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«æ˜¯Bitmapã€HyperLogLogå’ŒGEOã€‚å‰ä¸¤ç§æˆ‘åœ¨ä¸ŠèŠ‚è¯¾å·²ç»é‡ç‚¹ä»‹ç»è¿‡äº†ï¼Œä»Šå¤©ï¼Œæˆ‘å†å…·ä½“è®²ä¸€è®²GEOã€‚</p><p>å¦å¤–ï¼Œæˆ‘è¿˜ä¼šç»™ä½ ä»‹ç»å¼€å‘è‡ªå®šä¹‰çš„æ–°æ•°æ®ç±»å‹çš„åŸºæœ¬æ­¥éª¤ã€‚æŒæ¡äº†è‡ªå®šä¹‰æ•°æ®ç±»å‹çš„å¼€å‘æ–¹æ³•ï¼Œå½“ä½ é¢ä¸´ä¸€äº›å¤æ‚çš„åœºæ™¯æ—¶ï¼Œå°±ä¸ç”¨å—åŸºæœ¬æ•°æ®ç±»å‹çš„é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥åœ¨Redisä¸­å¢åŠ å®šåˆ¶åŒ–çš„æ•°æ®ç±»å‹ï¼Œæ¥æ»¡è¶³ä½ çš„ç‰¹æ®Šéœ€æ±‚ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å…ˆæ¥äº†è§£ä¸‹æ‰©å±•æ•°æ®ç±»å‹GEOçš„å®ç°åŸç†å’Œä½¿ç”¨æ–¹æ³•ã€‚</p><h2>é¢å‘LBSåº”ç”¨çš„GEOæ•°æ®ç±»å‹</h2><p>åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šä¾èµ–æœç´¢â€œé™„è¿‘çš„é¤é¦†â€ã€åœ¨æ‰“è½¦è½¯ä»¶ä¸Šå«è½¦ï¼Œè¿™äº›éƒ½ç¦»ä¸å¼€åŸºäºä½ç½®ä¿¡æ¯æœåŠ¡ï¼ˆLocation-Based Serviceï¼ŒLBSï¼‰çš„åº”ç”¨ã€‚LBSåº”ç”¨è®¿é—®çš„æ•°æ®æ˜¯å’Œäººæˆ–ç‰©å…³è”çš„ä¸€ç»„ç»çº¬åº¦ä¿¡æ¯ï¼Œè€Œä¸”è¦èƒ½æŸ¥è¯¢ç›¸é‚»çš„ç»çº¬åº¦èŒƒå›´ï¼ŒGEOå°±éå¸¸é€‚åˆåº”ç”¨åœ¨LBSæœåŠ¡çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„åº•å±‚ç»“æ„ã€‚</p><!-- [[[read_end]]] --><h3>GEOçš„åº•å±‚ç»“æ„</h3><p><strong>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨è®¾è®¡ä¸€ä¸ªæ•°æ®ç±»å‹çš„åº•å±‚ç»“æ„æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“ï¼Œè¦å¤„ç†çš„æ•°æ®æœ‰ä»€ä¹ˆè®¿é—®ç‰¹ç‚¹</strong>ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆææ¸…æ¥šä½ç½®ä¿¡æ¯åˆ°åº•æ˜¯æ€ä¹ˆè¢«å­˜å–çš„ã€‚</p><p>æˆ‘ä»¥å«è½¦æœåŠ¡ä¸ºä¾‹ï¼Œæ¥åˆ†æä¸‹LBSåº”ç”¨ä¸­ç»çº¬åº¦çš„å­˜å–ç‰¹ç‚¹ã€‚</p><ol>\n<li>æ¯ä¸€è¾†ç½‘çº¦è½¦éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼ˆä¾‹å¦‚33ï¼‰ï¼Œç½‘çº¦è½¦éœ€è¦å°†è‡ªå·±çš„ç»åº¦ä¿¡æ¯ï¼ˆä¾‹å¦‚116.034579ï¼‰å’Œçº¬åº¦ä¿¡æ¯ï¼ˆä¾‹å¦‚39.000452 ï¼‰å‘ç»™å«è½¦åº”ç”¨ã€‚</li>\n<li>ç”¨æˆ·åœ¨å«è½¦çš„æ—¶å€™ï¼Œå«è½¦åº”ç”¨ä¼šæ ¹æ®ç”¨æˆ·çš„ç»çº¬åº¦ä½ç½®ï¼ˆä¾‹å¦‚ç»åº¦116.054579ï¼Œçº¬åº¦39.030452ï¼‰ï¼ŒæŸ¥æ‰¾ç”¨æˆ·çš„é™„è¿‘è½¦è¾†ï¼Œå¹¶è¿›è¡ŒåŒ¹é…ã€‚</li>\n<li>ç­‰æŠŠä½ç½®ç›¸è¿‘çš„ç”¨æˆ·å’Œè½¦è¾†åŒ¹é…ä¸Šä»¥åï¼Œå«è½¦åº”ç”¨å°±ä¼šæ ¹æ®è½¦è¾†çš„ç¼–å·ï¼Œè·å–è½¦è¾†çš„ä¿¡æ¯ï¼Œå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚</li>\n</ol><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸€è¾†è½¦ï¼ˆæˆ–ä¸€ä¸ªç”¨æˆ·ï¼‰å¯¹åº”ä¸€ç»„ç»çº¬åº¦ï¼Œå¹¶ä¸”éšç€è½¦ï¼ˆæˆ–ç”¨æˆ·ï¼‰çš„ä½ç½®ç§»åŠ¨ï¼Œç›¸åº”çš„ç»çº¬åº¦ä¹Ÿä¼šå˜åŒ–ã€‚</p><p>è¿™ç§æ•°æ®è®°å½•æ¨¡å¼å±äºä¸€ä¸ªkeyï¼ˆä¾‹å¦‚è½¦IDï¼‰å¯¹åº”ä¸€ä¸ªvalueï¼ˆä¸€ç»„ç»çº¬åº¦ï¼‰ã€‚å½“æœ‰å¾ˆå¤šè½¦è¾†ä¿¡æ¯è¦ä¿å­˜æ—¶ï¼Œå°±éœ€è¦æœ‰ä¸€ä¸ªé›†åˆæ¥ä¿å­˜ä¸€ç³»åˆ—çš„keyå’Œvalueã€‚Hashé›†åˆç±»å‹å¯ä»¥å¿«é€Ÿå­˜å–ä¸€ç³»åˆ—çš„keyå’Œvalueï¼Œæ­£å¥½å¯ä»¥ç”¨æ¥è®°å½•ä¸€ç³»åˆ—è½¦è¾†IDå’Œç»çº¬åº¦çš„å¯¹åº”å…³ç³»ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸åŒè½¦è¾†çš„IDå’Œå®ƒä»¬å¯¹åº”çš„ç»çº¬åº¦ä¿¡æ¯å­˜åœ¨Hashé›†åˆä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c8/0e/c8d3f1951874da0d916ed51ccdce9e0e.jpg?wh=2461*1445\" alt=\"\"></p><p>åŒæ—¶ï¼ŒHashç±»å‹çš„HSETæ“ä½œå‘½ä»¤ï¼Œä¼šæ ¹æ®keyæ¥è®¾ç½®ç›¸åº”çš„valueå€¼ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¿«é€Ÿåœ°æ›´æ–°è½¦è¾†å˜åŒ–çš„ç»çº¬åº¦ä¿¡æ¯ã€‚</p><p>åˆ°è¿™é‡Œï¼ŒHashç±»å‹çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä½†é—®é¢˜æ˜¯ï¼Œå¯¹äºä¸€ä¸ªLBSåº”ç”¨æ¥è¯´ï¼Œé™¤äº†è®°å½•ç»çº¬åº¦ä¿¡æ¯ï¼Œè¿˜éœ€è¦æ ¹æ®ç”¨æˆ·çš„ç»çº¬åº¦ä¿¡æ¯åœ¨è½¦è¾†çš„Hashé›†åˆä¸­è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ã€‚ä¸€æ—¦æ¶‰åŠåˆ°èŒƒå›´æŸ¥è¯¢ï¼Œå°±æ„å‘³ç€é›†åˆä¸­çš„å…ƒç´ éœ€è¦æœ‰åºï¼Œä½†Hashç±»å‹çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œæ˜¾ç„¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ä½¿ç”¨<strong>Sorted Setç±»å‹</strong>æ˜¯ä¸æ˜¯åˆé€‚ã€‚</p><p>Sorted Setç±»å‹ä¹Ÿæ”¯æŒä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueçš„è®°å½•æ¨¡å¼ï¼Œå…¶ä¸­ï¼Œkeyå°±æ˜¯Sorted Setä¸­çš„å…ƒç´ ï¼Œè€Œvalueåˆ™æ˜¯å…ƒç´ çš„æƒé‡åˆ†æ•°ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒSorted Setå¯ä»¥æ ¹æ®å…ƒç´ çš„æƒé‡åˆ†æ•°æ’åºï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚è¿™å°±èƒ½æ»¡è¶³LBSæœåŠ¡ä¸­æŸ¥æ‰¾ç›¸é‚»ä½ç½®çš„éœ€æ±‚äº†ã€‚</p><p>å®é™…ä¸Šï¼ŒGEOç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„å°±æ˜¯ç”¨Sorted Setæ¥å®ç°çš„ã€‚å’±ä»¬è¿˜æ˜¯å€Ÿç€å«è½¦åº”ç”¨çš„ä¾‹å­æ¥åŠ æ·±ä¸‹ç†è§£ã€‚</p><p>ç”¨Sorted Setæ¥ä¿å­˜è½¦è¾†çš„ç»çº¬åº¦ä¿¡æ¯æ—¶ï¼ŒSorted Setçš„å…ƒç´ æ˜¯è½¦è¾†IDï¼Œå…ƒç´ çš„æƒé‡åˆ†æ•°æ˜¯ç»çº¬åº¦ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a9/4e/a9a6bc78ea3bb652ef1404020dd2934e.jpg?wh=2356*1403\" alt=\"\"></p><p>è¿™æ—¶é—®é¢˜æ¥äº†ï¼ŒSorted Setå…ƒç´ çš„æƒé‡åˆ†æ•°æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ˆfloatç±»å‹ï¼‰ï¼Œè€Œä¸€ç»„ç»çº¬åº¦åŒ…å«çš„æ˜¯ç»åº¦å’Œçº¬åº¦ä¸¤ä¸ªå€¼ï¼Œæ˜¯æ²¡æ³•ç›´æ¥ä¿å­˜ä¸ºä¸€ä¸ªæµ®ç‚¹æ•°çš„ï¼Œé‚£å…·ä½“è¯¥æ€ä¹ˆè¿›è¡Œä¿å­˜å‘¢ï¼Ÿ</p><p>è¿™å°±è¦ç”¨åˆ°GEOç±»å‹ä¸­çš„GeoHashç¼–ç äº†ã€‚</p><h3>GeoHashçš„ç¼–ç æ–¹æ³•</h3><p>ä¸ºäº†èƒ½é«˜æ•ˆåœ°å¯¹ç»çº¬åº¦è¿›è¡Œæ¯”è¾ƒï¼ŒRedisé‡‡ç”¨äº†ä¸šç•Œå¹¿æ³›ä½¿ç”¨çš„GeoHashç¼–ç æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„åŸºæœ¬åŸç†å°±æ˜¯â€œäºŒåˆ†åŒºé—´ï¼ŒåŒºé—´ç¼–ç â€ã€‚</p><p>å½“æˆ‘ä»¬è¦å¯¹ä¸€ç»„ç»çº¬åº¦è¿›è¡ŒGeoHashç¼–ç æ—¶ï¼Œæˆ‘ä»¬è¦å…ˆå¯¹ç»åº¦å’Œçº¬åº¦åˆ†åˆ«ç¼–ç ï¼Œç„¶åå†æŠŠç»çº¬åº¦å„è‡ªçš„ç¼–ç ç»„åˆæˆä¸€ä¸ªæœ€ç»ˆç¼–ç ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ç»åº¦å’Œçº¬åº¦çš„å•ç‹¬ç¼–ç è¿‡ç¨‹ã€‚</p><p>å¯¹äºä¸€ä¸ªåœ°ç†ä½ç½®ä¿¡æ¯æ¥è¯´ï¼Œå®ƒçš„ç»åº¦èŒƒå›´æ˜¯[-180,180]ã€‚GeoHashç¼–ç ä¼šæŠŠä¸€ä¸ªç»åº¦å€¼ç¼–ç æˆä¸€ä¸ªNä½çš„äºŒè¿›åˆ¶å€¼ï¼Œæˆ‘ä»¬æ¥å¯¹ç»åº¦èŒƒå›´[-180,180]åšNæ¬¡çš„äºŒåˆ†åŒºæ“ä½œï¼Œå…¶ä¸­Nå¯ä»¥è‡ªå®šä¹‰ã€‚</p><p>åœ¨è¿›è¡Œç¬¬ä¸€æ¬¡äºŒåˆ†åŒºæ—¶ï¼Œç»åº¦èŒƒå›´[-180,180]ä¼šè¢«åˆ†æˆä¸¤ä¸ªå­åŒºé—´ï¼š[-180,0)å’Œ[0,180]ï¼ˆæˆ‘ç§°ä¹‹ä¸ºå·¦ã€å³åˆ†åŒºï¼‰ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹è¦ç¼–ç çš„ç»åº¦å€¼è½åœ¨äº†å·¦åˆ†åŒºè¿˜æ˜¯å³åˆ†åŒºã€‚å¦‚æœæ˜¯è½åœ¨å·¦åˆ†åŒºï¼Œæˆ‘ä»¬å°±ç”¨0è¡¨ç¤ºï¼›å¦‚æœè½åœ¨å³åˆ†åŒºï¼Œå°±ç”¨1è¡¨ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯åšå®Œä¸€æ¬¡äºŒåˆ†åŒºï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°1ä½ç¼–ç å€¼ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å†å¯¹ç»åº¦å€¼æ‰€å±çš„åˆ†åŒºå†åšä¸€æ¬¡äºŒåˆ†åŒºï¼ŒåŒæ—¶å†æ¬¡æŸ¥çœ‹ç»åº¦å€¼è½åœ¨äº†äºŒåˆ†åŒºåçš„å·¦åˆ†åŒºè¿˜æ˜¯å³åˆ†åŒºï¼ŒæŒ‰ç…§åˆšæ‰çš„è§„åˆ™å†åš1ä½ç¼–ç ã€‚å½“åšå®ŒNæ¬¡çš„äºŒåˆ†åŒºåï¼Œç»åº¦å€¼å°±å¯ä»¥ç”¨ä¸€ä¸ªN bitçš„æ•°æ¥è¡¨ç¤ºäº†ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦ç¼–ç çš„ç»åº¦å€¼æ˜¯116.37ï¼Œæˆ‘ä»¬ç”¨5ä½ç¼–ç å€¼ï¼ˆä¹Ÿå°±æ˜¯N=5ï¼Œåš5æ¬¡åˆ†åŒºï¼‰ã€‚</p><p>æˆ‘ä»¬å…ˆåšç¬¬ä¸€æ¬¡äºŒåˆ†åŒºæ“ä½œï¼ŒæŠŠç»åº¦åŒºé—´[-180,180]åˆ†æˆäº†å·¦åˆ†åŒº[-180,0)å’Œå³åˆ†åŒº[0,180]ï¼Œæ­¤æ—¶ï¼Œç»åº¦å€¼116.37æ˜¯å±äºå³åˆ†åŒº[0,180]ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ç”¨1è¡¨ç¤ºç¬¬ä¸€æ¬¡äºŒåˆ†åŒºåçš„ç¼–ç å€¼ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšç¬¬äºŒæ¬¡äºŒåˆ†åŒºï¼šæŠŠç»åº¦å€¼116.37æ‰€å±çš„[0,180]åŒºé—´ï¼Œåˆ†æˆ[0,90)å’Œ[90, 180]ã€‚æ­¤æ—¶ï¼Œç»åº¦å€¼116.37è¿˜æ˜¯å±äºå³åˆ†åŒº[90,180]ï¼Œæ‰€ä»¥ï¼Œç¬¬äºŒæ¬¡åˆ†åŒºåçš„ç¼–ç å€¼ä»ç„¶ä¸º1ã€‚ç­‰åˆ°ç¬¬ä¸‰æ¬¡å¯¹[90,180]è¿›è¡ŒäºŒåˆ†åŒºï¼Œç»åº¦å€¼116.37è½åœ¨äº†åˆ†åŒºåçš„å·¦åˆ†åŒº[90, 135)ä¸­ï¼Œæ‰€ä»¥ï¼Œç¬¬ä¸‰æ¬¡åˆ†åŒºåçš„ç¼–ç å€¼å°±æ˜¯0ã€‚</p><p>æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œåšå®Œ5æ¬¡åˆ†åŒºåï¼Œæˆ‘ä»¬æŠŠç»åº¦å€¼116.37å®šä½åœ¨[112.5, 123.75]è¿™ä¸ªåŒºé—´ï¼Œå¹¶ä¸”å¾—åˆ°äº†ç»åº¦å€¼çš„5ä½ç¼–ç å€¼ï¼Œå³11010ã€‚è¿™ä¸ªç¼–ç è¿‡ç¨‹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/f2/3cb007yy63c820d6dd2e4999608683f2.jpg?wh=2890*850\" alt=\"\"></p><p>å¯¹çº¬åº¦çš„ç¼–ç æ–¹å¼ï¼Œå’Œå¯¹ç»åº¦çš„ä¸€æ ·ï¼Œåªæ˜¯çº¬åº¦çš„èŒƒå›´æ˜¯[-90ï¼Œ90]ï¼Œä¸‹é¢è¿™å¼ è¡¨æ˜¾ç¤ºäº†å¯¹çº¬åº¦å€¼39.86çš„ç¼–ç è¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/65/6d/65f41469866cb94963b4c9afbf2b016d.jpg?wh=2887*838\" alt=\"\"></p><p>å½“ä¸€ç»„ç»çº¬åº¦å€¼éƒ½ç¼–å®Œç åï¼Œæˆ‘ä»¬å†æŠŠå®ƒä»¬çš„å„è‡ªç¼–ç å€¼ç»„åˆåœ¨ä¸€èµ·ï¼Œç»„åˆçš„è§„åˆ™æ˜¯ï¼šæœ€ç»ˆç¼–ç å€¼çš„å¶æ•°ä½ä¸Šä¾æ¬¡æ˜¯ç»åº¦çš„ç¼–ç å€¼ï¼Œå¥‡æ•°ä½ä¸Šä¾æ¬¡æ˜¯çº¬åº¦çš„ç¼–ç å€¼ï¼Œå…¶ä¸­ï¼Œå¶æ•°ä½ä»0å¼€å§‹ï¼Œå¥‡æ•°ä½ä»1å¼€å§‹ã€‚</p><p>æˆ‘ä»¬åˆšåˆšè®¡ç®—çš„ç»çº¬åº¦ï¼ˆ116.37ï¼Œ39.86ï¼‰çš„å„è‡ªç¼–ç å€¼æ˜¯11010å’Œ10111ï¼Œç»„åˆä¹‹åï¼Œç¬¬0ä½æ˜¯ç»åº¦çš„ç¬¬0ä½1ï¼Œç¬¬1ä½æ˜¯çº¬åº¦çš„ç¬¬0ä½1ï¼Œç¬¬2ä½æ˜¯ç»åº¦çš„ç¬¬1ä½1ï¼Œç¬¬3ä½æ˜¯çº¬åº¦çš„ç¬¬1ä½0ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå°±èƒ½å¾—åˆ°æœ€ç»ˆç¼–ç å€¼1110011101ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4a/87/4a8296e841f18ed4f3a554703ebd5887.jpg?wh=3000*1441\" alt=\"\"></p><p>ç”¨äº†GeoHashç¼–ç åï¼ŒåŸæ¥æ— æ³•ç”¨ä¸€ä¸ªæƒé‡åˆ†æ•°è¡¨ç¤ºçš„ä¸€ç»„ç»çº¬åº¦ï¼ˆ116.37ï¼Œ39.86ï¼‰å°±å¯ä»¥ç”¨1110011101è¿™ä¸€ä¸ªå€¼æ¥è¡¨ç¤ºï¼Œå°±å¯ä»¥ä¿å­˜ä¸ºSorted Setçš„æƒé‡åˆ†æ•°äº†ã€‚</p><p>å½“ç„¶ï¼Œä½¿ç”¨GeoHashç¼–ç åï¼Œæˆ‘ä»¬ç›¸å½“äºæŠŠæ•´ä¸ªåœ°ç†ç©ºé—´åˆ’åˆ†æˆäº†ä¸€ä¸ªä¸ªæ–¹æ ¼ï¼Œæ¯ä¸ªæ–¹æ ¼å¯¹åº”äº†GeoHashä¸­çš„ä¸€ä¸ªåˆ†åŒºã€‚</p><p>ä¸¾ä¸ªä¾‹å­ã€‚æˆ‘ä»¬æŠŠç»åº¦åŒºé—´[-180,180]åšä¸€æ¬¡äºŒåˆ†åŒºï¼ŒæŠŠçº¬åº¦åŒºé—´[-90,90]åšä¸€æ¬¡äºŒåˆ†åŒºï¼Œå°±ä¼šå¾—åˆ°4ä¸ªåˆ†åŒºã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒä»¬çš„ç»åº¦å’Œçº¬åº¦èŒƒå›´ä»¥åŠå¯¹åº”çš„GeoHashç»„åˆç¼–ç ã€‚</p><ul>\n<li>åˆ†åŒºä¸€ï¼š[-180,0)å’Œ[-90,0)ï¼Œç¼–ç 00ï¼›</li>\n<li>åˆ†åŒºäºŒï¼š[-180,0)å’Œ[0,90]ï¼Œç¼–ç 01ï¼›</li>\n<li>åˆ†åŒºä¸‰ï¼š[0,180]å’Œ[-90,0)ï¼Œç¼–ç 10ï¼›</li>\n<li>åˆ†åŒºå››ï¼š[0,180]å’Œ[0,90]ï¼Œç¼–ç 11ã€‚</li>\n</ul><p>è¿™4ä¸ªåˆ†åŒºå¯¹åº”äº†4ä¸ªæ–¹æ ¼ï¼Œæ¯ä¸ªæ–¹æ ¼è¦†ç›–äº†ä¸€å®šèŒƒå›´å†…çš„ç»çº¬åº¦å€¼ï¼Œåˆ†åŒºè¶Šå¤šï¼Œæ¯ä¸ªæ–¹æ ¼èƒ½è¦†ç›–åˆ°çš„åœ°ç†ç©ºé—´å°±è¶Šå°ï¼Œä¹Ÿå°±è¶Šç²¾å‡†ã€‚æˆ‘ä»¬æŠŠæ‰€æœ‰æ–¹æ ¼çš„ç¼–ç å€¼æ˜ å°„åˆ°ä¸€ç»´ç©ºé—´æ—¶ï¼Œç›¸é‚»æ–¹æ ¼çš„GeoHashç¼–ç å€¼åŸºæœ¬ä¹Ÿæ˜¯æ¥è¿‘çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/74/2a2a650086acf9700c0603a4be8ceb74.jpg?wh=2187*1761\" alt=\"\"></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä½¿ç”¨Sorted SetèŒƒå›´æŸ¥è¯¢å¾—åˆ°çš„ç›¸è¿‘ç¼–ç å€¼ï¼Œåœ¨å®é™…çš„åœ°ç†ç©ºé—´ä¸Šï¼Œä¹Ÿæ˜¯ç›¸é‚»çš„æ–¹æ ¼ï¼Œè¿™å°±å¯ä»¥å®ç°LBSåº”ç”¨â€œæœç´¢é™„è¿‘çš„äººæˆ–ç‰©â€çš„åŠŸèƒ½äº†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘è¦æé†’ä½ ä¸€å¥ï¼Œæœ‰çš„ç¼–ç å€¼è™½ç„¶åœ¨å¤§å°ä¸Šæ¥è¿‘ï¼Œä½†å®é™…å¯¹åº”çš„æ–¹æ ¼å´è·ç¦»æ¯”è¾ƒè¿œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç”¨4ä½æ¥åšGeoHashç¼–ç ï¼ŒæŠŠç»åº¦åŒºé—´[-180,180]å’Œçº¬åº¦åŒºé—´[-90,90]å„åˆ†æˆäº†4ä¸ªåˆ†åŒºï¼Œä¸€å…±16ä¸ªåˆ†åŒºï¼Œå¯¹åº”äº†16ä¸ªæ–¹æ ¼ã€‚ç¼–ç å€¼ä¸º0111å’Œ1000çš„ä¸¤ä¸ªæ–¹æ ¼å°±ç¦»å¾—æ¯”è¾ƒè¿œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/0d/ba/0d64c9765ab72a50abef16a0275bc0ba.jpg?wh=2871*2250\" alt=\"\"></p><p>æ‰€ä»¥ï¼Œä¸ºäº†é¿å…æŸ¥è¯¢ä¸å‡†ç¡®é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æŸ¥è¯¢ç»™å®šç»çº¬åº¦æ‰€åœ¨çš„æ–¹æ ¼å‘¨å›´çš„4ä¸ªæˆ–8ä¸ªæ–¹æ ¼ã€‚</p><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†ï¼ŒGEOç±»å‹æ˜¯æŠŠç»çº¬åº¦æ‰€åœ¨çš„åŒºé—´ç¼–ç ä½œä¸ºSorted Setä¸­å…ƒç´ çš„æƒé‡åˆ†æ•°ï¼ŒæŠŠå’Œç»çº¬åº¦ç›¸å…³çš„è½¦è¾†IDä½œä¸ºSorted Setä¸­å…ƒç´ æœ¬èº«çš„å€¼ä¿å­˜ä¸‹æ¥ï¼Œè¿™æ ·ç›¸é‚»ç»çº¬åº¦çš„æŸ¥è¯¢å°±å¯ä»¥é€šè¿‡ç¼–ç å€¼çš„å¤§å°èŒƒå›´æŸ¥è¯¢æ¥å®ç°äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥èŠèŠå…·ä½“å¦‚ä½•æ“ä½œGEOç±»å‹ã€‚</p><h3>å¦‚ä½•æ“ä½œGEOç±»å‹ï¼Ÿ</h3><p>åœ¨ä½¿ç”¨GEOç±»å‹æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ä¸¤ä¸ªå‘½ä»¤ï¼Œåˆ†åˆ«æ˜¯GEOADDå’ŒGEORADIUSã€‚</p><ul>\n<li>GEOADDå‘½ä»¤ï¼šç”¨äºæŠŠä¸€ç»„ç»çº¬åº¦ä¿¡æ¯å’Œç›¸å¯¹åº”çš„ä¸€ä¸ªIDè®°å½•åˆ°GEOç±»å‹é›†åˆä¸­ï¼›</li>\n<li>GEORADIUSå‘½ä»¤ï¼šä¼šæ ¹æ®è¾“å…¥çš„ç»çº¬åº¦ä½ç½®ï¼ŒæŸ¥æ‰¾ä»¥è¿™ä¸ªç»çº¬åº¦ä¸ºä¸­å¿ƒçš„ä¸€å®šèŒƒå›´å†…çš„å…¶ä»–å…ƒç´ ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰è¿™ä¸ªèŒƒå›´ã€‚</li>\n</ul><p>æˆ‘è¿˜æ˜¯ä»¥å«è½¦åº”ç”¨çš„è½¦è¾†åŒ¹é…åœºæ™¯ä¸ºä¾‹ï¼Œä»‹ç»ä¸‹å…·ä½“å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªå‘½ä»¤ã€‚</p><p>å‡è®¾è½¦è¾†IDæ˜¯33ï¼Œç»çº¬åº¦ä½ç½®æ˜¯ï¼ˆ116.034579ï¼Œ39.030452ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªGEOé›†åˆä¿å­˜æ‰€æœ‰è½¦è¾†çš„ç»çº¬åº¦ï¼Œé›†åˆkeyæ˜¯cars:locationsã€‚æ‰§è¡Œä¸‹é¢çš„è¿™ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥æŠŠIDå·ä¸º33çš„è½¦è¾†çš„å½“å‰ç»çº¬åº¦ä½ç½®å­˜å…¥GEOé›†åˆä¸­ï¼š</p><pre><code>GEOADD cars:locations 116.034579 39.030452 33\n</code></pre><p>å½“ç”¨æˆ·æƒ³è¦å¯»æ‰¾è‡ªå·±é™„è¿‘çš„ç½‘çº¦è½¦æ—¶ï¼ŒLBSåº”ç”¨å°±å¯ä»¥ä½¿ç”¨GEORADIUSå‘½ä»¤ã€‚</p><p>ä¾‹å¦‚ï¼ŒLBSåº”ç”¨æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ—¶ï¼ŒRedisä¼šæ ¹æ®è¾“å…¥çš„ç”¨æˆ·çš„ç»çº¬åº¦ä¿¡æ¯ï¼ˆ116.054579ï¼Œ39.030452 ï¼‰ï¼ŒæŸ¥æ‰¾ä»¥è¿™ä¸ªç»çº¬åº¦ä¸ºä¸­å¿ƒçš„5å…¬é‡Œå†…çš„è½¦è¾†ä¿¡æ¯ï¼Œå¹¶è¿”å›ç»™LBSåº”ç”¨ã€‚å½“ç„¶ï¼Œ ä½ å¯ä»¥ä¿®æ”¹â€œ5â€è¿™ä¸ªå‚æ•°ï¼Œæ¥è¿”å›æ›´å¤§æˆ–æ›´å°èŒƒå›´å†…çš„è½¦è¾†ä¿¡æ¯ã€‚</p><pre><code>GEORADIUS cars:locations 116.054579 39.030452 5 km ASC COUNT 10\n</code></pre><p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿›ä¸€æ­¥é™å®šè¿”å›çš„è½¦è¾†ä¿¡æ¯ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ASCé€‰é¡¹ï¼Œè®©è¿”å›çš„è½¦è¾†ä¿¡æ¯æŒ‰ç…§è·ç¦»è¿™ä¸ªä¸­å¿ƒä½ç½®ä»è¿‘åˆ°è¿œçš„æ–¹å¼æ¥æ’åºï¼Œä»¥æ–¹ä¾¿é€‰æ‹©æœ€è¿‘çš„è½¦è¾†ï¼›è¿˜å¯ä»¥ä½¿ç”¨COUNTé€‰é¡¹ï¼ŒæŒ‡å®šè¿”å›çš„è½¦è¾†ä¿¡æ¯çš„æ•°é‡ã€‚æ¯•ç«Ÿï¼Œ5å…¬é‡ŒèŒƒå›´å†…çš„è½¦è¾†å¯èƒ½æœ‰å¾ˆå¤šï¼Œå¦‚æœè¿”å›å…¨éƒ¨ä¿¡æ¯ï¼Œä¼šå ç”¨æ¯”è¾ƒå¤šçš„æ•°æ®å¸¦å®½ï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥å¸®åŠ©æ§åˆ¶è¿”å›çš„æ•°æ®é‡ï¼ŒèŠ‚çœå¸¦å®½ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨GEOæ•°æ®ç±»å‹å¯ä»¥éå¸¸è½»æ¾åœ°æ“ä½œç»çº¬åº¦è¿™ç§ä¿¡æ¯ã€‚</p><p>è™½ç„¶æˆ‘ä»¬æœ‰äº†5ç§åŸºæœ¬ç±»å‹å’Œ3ç§æ‰©å±•æ•°æ®ç±»å‹ï¼Œä½†æ˜¯æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯¹æ•°æ®ç±»å‹ä¼šæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç±»å‹æ—¢èƒ½åƒHashé‚£æ ·æ”¯æŒå¿«é€Ÿçš„å•é”®æŸ¥è¯¢ï¼Œåˆèƒ½åƒSorted Seté‚£æ ·æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„è¿™äº›æ•°æ®ç±»å‹å°±æ— æ³•æ»¡è¶³éœ€æ±‚äº†ã€‚é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°±å†å‘ä½ ä»‹ç»ä¸‹Redisæ‰©å±•æ•°æ®ç±»å‹çš„ç»ˆæç‰ˆâ€”â€”è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥å®šåˆ¶ç¬¦åˆè‡ªå·±éœ€æ±‚çš„æ•°æ®ç±»å‹äº†ï¼Œä¸ç®¡ä½ çš„åº”ç”¨åœºæ™¯æ€ä¹ˆå˜åŒ–ï¼Œä½ éƒ½ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰åˆé€‚çš„æ•°æ®ç±»å‹ã€‚</p><h2>å¦‚ä½•è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Ÿ</h2><p>ä¸ºäº†å®ç°è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£Redisçš„åŸºæœ¬å¯¹è±¡ç»“æ„RedisObjectï¼Œå› ä¸ºRedisé”®å€¼å¯¹ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ç”¨RedisObjectä¿å­˜çš„ã€‚</p><p>æˆ‘åœ¨<a href=\"https://time.geekbang.org/column/article/279649\">ç¬¬11è®²</a>ä¸­è¯´è¿‡ï¼ŒRedisObjectåŒ…æ‹¬å…ƒæ•°æ®å’ŒæŒ‡é’ˆã€‚å…¶ä¸­ï¼Œå…ƒæ•°æ®çš„ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒçš„æ•°æ®ç±»å‹ï¼ŒæŒ‡é’ˆç”¨æ¥æŒ‡å‘å…·ä½“çš„æ•°æ®ç±»å‹çš„å€¼ã€‚æ‰€ä»¥ï¼Œè¦æƒ³å¼€å‘æ–°æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å°±å…ˆæ¥äº†è§£ä¸‹RedisObjectçš„å…ƒæ•°æ®å’ŒæŒ‡é’ˆã€‚</p><h3>Redisçš„åŸºæœ¬å¯¹è±¡ç»“æ„</h3><p>RedisObjectçš„å†…éƒ¨ç»„æˆåŒ…æ‹¬äº†typeã€encodingã€lruå’Œrefcount 4ä¸ªå…ƒæ•°æ®ï¼Œä»¥åŠ1ä¸ª<code>*ptr</code>æŒ‡é’ˆã€‚</p><ul>\n<li>typeï¼šè¡¨ç¤ºå€¼çš„ç±»å‹ï¼Œæ¶µç›–äº†æˆ‘ä»¬å‰é¢å­¦ä¹ çš„äº”å¤§åŸºæœ¬ç±»å‹ï¼›</li>\n<li>encodingï¼šæ˜¯å€¼çš„ç¼–ç æ–¹å¼ï¼Œç”¨æ¥è¡¨ç¤ºRedisä¸­å®ç°å„ä¸ªåŸºæœ¬ç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚SDSã€å‹ç¼©åˆ—è¡¨ã€å“ˆå¸Œè¡¨ã€è·³è¡¨ç­‰ï¼›</li>\n<li>lruï¼šè®°å½•äº†è¿™ä¸ªå¯¹è±¡æœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´ï¼Œç”¨äºæ·˜æ±°è¿‡æœŸçš„é”®å€¼å¯¹ï¼›</li>\n<li>refcountï¼šè®°å½•äº†å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼›</li>\n<li>*ptrï¼šæ˜¯æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/05/af/05c2d546e507d8a863c002e2173c71af.jpg?wh=1096*1521\" alt=\"\"></p><p>RedisObjectç»“æ„å€ŸåŠ©<code>*ptr</code>æŒ‡é’ˆï¼Œå°±å¯ä»¥æŒ‡å‘ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ï¼Œ<code>*ptr</code>æŒ‡å‘ä¸€ä¸ªSDSæˆ–ä¸€ä¸ªè·³è¡¨ï¼Œå°±è¡¨ç¤ºé”®å€¼å¯¹ä¸­çš„å€¼æ˜¯Stringç±»å‹æˆ–Sorted Setç±»å‹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰äº†æ–°çš„æ•°æ®ç±»å‹åï¼Œä¹Ÿåªè¦åœ¨RedisObjectä¸­è®¾ç½®å¥½æ–°ç±»å‹çš„typeå’Œencodingï¼Œå†ç”¨<code>*ptr</code>æŒ‡å‘æ–°ç±»å‹çš„å®ç°ï¼Œå°±è¡Œäº†ã€‚</p><h3>å¼€å‘ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹</h3><p>äº†è§£äº†RedisObjectç»“æ„åï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ä¹Ÿå°±ä¸éš¾äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ–°æ•°æ®ç±»å‹å®šä¹‰å¥½å®ƒçš„åº•å±‚ç»“æ„ã€typeå’Œencodingå±æ€§å€¼ï¼Œç„¶åå†å®ç°æ–°æ•°æ®ç±»å‹çš„åˆ›å»ºã€é‡Šæ”¾å‡½æ•°å’ŒåŸºæœ¬å‘½ä»¤ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¥å¼€å‘ä¸€ä¸ªåå­—å«ä½œNewTypeObjectçš„æ–°æ•°æ®ç±»å‹ä¸ºä¾‹ï¼Œæ¥è§£é‡Šä¸‹å…·ä½“çš„4ä¸ªæ“ä½œæ­¥éª¤ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/88/99/88702464f8bc80ea11b26ab157926199.jpg?wh=3000*505\" alt=\"\"></p><p><strong>ç¬¬ä¸€æ­¥ï¼šå®šä¹‰æ–°æ•°æ®ç±»å‹çš„åº•å±‚ç»“æ„</strong></p><p>æˆ‘ä»¬ç”¨newtype.hæ–‡ä»¶æ¥ä¿å­˜è¿™ä¸ªæ–°ç±»å‹çš„å®šä¹‰ï¼Œå…·ä½“å®šä¹‰çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>struct NewTypeObject {\n    struct NewTypeNode *head; \n    size_t len; \n}NewTypeObject;\n</code></pre><p>å…¶ä¸­ï¼ŒNewTypeNodeç»“æ„å°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–°ç±»å‹çš„åº•å±‚ç»“æ„ã€‚æˆ‘ä»¬ä¸ºåº•å±‚ç»“æ„è®¾è®¡ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼šä¸€ä¸ªæ˜¯Longç±»å‹çš„valueå€¼ï¼Œç”¨æ¥ä¿å­˜å®é™…æ•°æ®ï¼›ä¸€ä¸ªæ˜¯<code>*next</code>æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªNewTypeNodeç»“æ„ã€‚</p><pre><code>struct NewTypeNode {\n    long value;\n    struct NewTypeNode *next;\n};\n</code></pre><p>ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒNewTypeObjectç±»å‹çš„åº•å±‚ç»“æ„å…¶å®å°±æ˜¯ä¸€ä¸ªLongç±»å‹çš„å•å‘é“¾è¡¨ã€‚å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼ŒæŠŠNewTypeObjectçš„åº•å±‚ç»“æ„å®šä¹‰ä¸ºå…¶ä»–ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦NewTypeObjectçš„æŸ¥è¯¢æ•ˆç‡æ¯”é“¾è¡¨é«˜ï¼Œå°±å¯ä»¥æŠŠå®ƒçš„åº•å±‚ç»“æ„è®¾è®¡æˆä¸€é¢—B+æ ‘ã€‚</p><p><strong>ç¬¬äºŒæ­¥ï¼šåœ¨RedisObjectçš„typeå±æ€§ä¸­ï¼Œå¢åŠ è¿™ä¸ªæ–°ç±»å‹çš„å®šä¹‰</strong></p><p>è¿™ä¸ªå®šä¹‰æ˜¯åœ¨Redisçš„server.hæ–‡ä»¶ä¸­ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªå«ä½œOBJ_NEWTYPEçš„å®å®šä¹‰ï¼Œç”¨æ¥åœ¨ä»£ç ä¸­æŒ‡ä»£NewTypeObjectè¿™ä¸ªæ–°ç±»å‹ã€‚</p><pre><code>#define OBJ_STRING 0    /* String object. */\n#define OBJ_LIST 1      /* List object. */\n#define OBJ_SET 2       /* Set object. */\n#define OBJ_ZSET 3      /* Sorted set object. */\nâ€¦\n#define OBJ_NEWTYPE 7\n</code></pre><p><strong>ç¬¬ä¸‰æ­¥ï¼šå¼€å‘æ–°ç±»å‹çš„åˆ›å»ºå’Œé‡Šæ”¾å‡½æ•°</strong></p><p>RedisæŠŠæ•°æ®ç±»å‹çš„åˆ›å»ºå’Œé‡Šæ”¾å‡½æ•°éƒ½å®šä¹‰åœ¨äº†object.cæ–‡ä»¶ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å¢åŠ NewTypeObjectçš„åˆ›å»ºå‡½æ•°createNewTypeObjectï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>robj *createNewTypeObject(void){\n   NewTypeObject *h = newtypeNew(); \n   robj *o = createObject(OBJ_NEWTYPE,h);\n   return o;\n}\n</code></pre><p>createNewTypeObjectåˆ†åˆ«è°ƒç”¨äº†newtypeNewå’ŒcreateObjectä¸¤ä¸ªå‡½æ•°ï¼Œæˆ‘åˆ†åˆ«æ¥ä»‹ç»ä¸‹ã€‚</p><p>å…ˆè¯´newtypeNewå‡½æ•°ã€‚å®ƒæ˜¯ç”¨æ¥ä¸ºæ–°æ•°æ®ç±»å‹åˆå§‹åŒ–å†…å­˜ç»“æ„çš„ã€‚è¿™ä¸ªåˆå§‹åŒ–è¿‡ç¨‹ä¸»è¦æ˜¯ç”¨zmallocåšåº•å±‚ç»“æ„åˆ†é…ç©ºé—´ï¼Œä»¥ä¾¿å†™å…¥æ•°æ®ã€‚</p><pre><code>NewTypeObject *newtypeNew(void){\n    NewTypeObject *n = zmalloc(sizeof(*n));\n    n-&gt;head = NULL;\n    n-&gt;len = 0;\n    return n;\n}\n</code></pre><p>newtypeNewå‡½æ•°æ¶‰åŠåˆ°æ–°æ•°æ®ç±»å‹çš„å…·ä½“åˆ›å»ºï¼Œè€ŒRedisé»˜è®¤ä¼šä¸ºæ¯ä¸ªæ•°æ®ç±»å‹å®šä¹‰ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ï¼Œå®ç°è¿™ä¸ªç±»å‹çš„åˆ›å»ºå’Œå‘½ä»¤æ“ä½œï¼Œä¾‹å¦‚ï¼Œt_string.cå’Œt_list.cåˆ†åˆ«å¯¹åº”Stringå’ŒListç±»å‹ã€‚æŒ‰ç…§Redisçš„æƒ¯ä¾‹ï¼Œæˆ‘ä»¬å°±æŠŠnewtypeNewå‡½æ•°å®šä¹‰åœ¨åä¸ºt_newtype.cçš„æ–‡ä»¶ä¸­ã€‚</p><p>createObjectæ˜¯Redisæœ¬èº«æä¾›çš„RedisObjectåˆ›å»ºå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯æ•°æ®ç±»å‹çš„typeå’ŒæŒ‡å‘æ•°æ®ç±»å‹å®ç°çš„æŒ‡é’ˆ<code>*ptr</code>ã€‚</p><p>æˆ‘ä»¬ç»™createObjectå‡½æ•°ä¸­ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ–°ç±»å‹çš„typeå€¼OBJ_NEWTYPEï¼Œä»¥åŠæŒ‡å‘ä¸€ä¸ªåˆå§‹åŒ–è¿‡çš„NewTypeObjecçš„æŒ‡é’ˆã€‚è¿™æ ·ä¸€æ¥ï¼Œåˆ›å»ºçš„RedisObjectå°±èƒ½æŒ‡å‘æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–°æ•°æ®ç±»å‹äº†ã€‚</p><pre><code>robj *createObject(int type, void *ptr) {\n    robj *o = zmalloc(sizeof(*o));\n    o-&gt;type = type;\n    o-&gt;ptr = ptr;\n    ...\n    return o;\n}\n</code></pre><p>å¯¹äºé‡Šæ”¾å‡½æ•°æ¥è¯´ï¼Œå®ƒæ˜¯åˆ›å»ºå‡½æ•°çš„åè¿‡ç¨‹ï¼Œæ˜¯ç”¨zfreeå‘½ä»¤æŠŠæ–°ç»“æ„çš„å†…å­˜ç©ºé—´é‡Šæ”¾æ‰ã€‚</p><p><strong>ç¬¬å››æ­¥ï¼šå¼€å‘æ–°ç±»å‹çš„å‘½ä»¤æ“ä½œ</strong></p><p>ç®€å•æ¥è¯´ï¼Œå¢åŠ ç›¸åº”çš„å‘½ä»¤æ“ä½œçš„è¿‡ç¨‹å¯ä»¥åˆ†æˆä¸‰å°æ­¥ï¼š</p><p>1.åœ¨t_newtype.cæ–‡ä»¶ä¸­å¢åŠ å‘½ä»¤æ“ä½œçš„å®ç°ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å®šä¹‰ntinsertCommandå‡½æ•°ï¼Œç”±å®ƒå®ç°å¯¹NewTypeObjectå•å‘é“¾è¡¨çš„æ’å…¥æ“ä½œï¼š</p><pre><code>void ntinsertCommand(client *c){\n  //åŸºäºå®¢æˆ·ç«¯ä¼ é€’çš„å‚æ•°ï¼Œå®ç°åœ¨NewTypeObjecté“¾è¡¨å¤´æ’å…¥å…ƒç´ \n}\n</code></pre><p>2.åœ¨server.hæ–‡ä»¶ä¸­ï¼Œå£°æ˜æˆ‘ä»¬å·²ç»å®ç°çš„å‘½ä»¤ï¼Œä»¥ä¾¿åœ¨server.cæ–‡ä»¶å¼•ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p><pre><code>void ntinsertCommand(client *c)\n</code></pre><p>3.åœ¨server.cæ–‡ä»¶ä¸­çš„redisCommandTableé‡Œé¢ï¼ŒæŠŠæ–°å¢å‘½ä»¤å’Œå®ç°å‡½æ•°å…³è”èµ·æ¥ã€‚ä¾‹å¦‚ï¼Œæ–°å¢çš„ntinsertå‘½ä»¤ç”±ntinsertCommandå‡½æ•°å®ç°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ntinsertå‘½ä»¤ç»™NewTypeObjectæ•°æ®ç±»å‹æ’å…¥å…ƒç´ äº†ã€‚</p><pre><code>struct redisCommand redisCommandTable[] = { \n...\n{&quot;ntinsert&quot;,ntinsertCommand,2,&quot;m&quot;,...}\n}\n</code></pre><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„NewTypeObjectæ•°æ®ç±»å‹ï¼Œå¯ä»¥å®ç°åŸºæœ¬çš„å‘½ä»¤æ“ä½œäº†ã€‚å½“ç„¶ï¼Œå¦‚æœä½ è¿˜å¸Œæœ›æ–°çš„æ•°æ®ç±»å‹èƒ½è¢«æŒä¹…åŒ–ä¿å­˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨Redisçš„RDBå’ŒAOFæ¨¡å—ä¸­å¢åŠ å¯¹æ–°æ•°æ®ç±»å‹è¿›è¡ŒæŒä¹…åŒ–ä¿å­˜çš„ä»£ç ï¼Œæˆ‘ä¼šåœ¨åé¢çš„åŠ é¤ä¸­å†å’Œä½ åˆ†äº«ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†Redisçš„æ‰©å±•æ•°æ®ç±»å‹GEOã€‚GEOå¯ä»¥è®°å½•ç»çº¬åº¦å½¢å¼çš„åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œè¢«å¹¿æ³›åœ°åº”ç”¨åœ¨LBSæœåŠ¡ä¸­ã€‚GEOæœ¬èº«å¹¶æ²¡æœ‰è®¾è®¡æ–°çš„åº•å±‚æ•°æ®ç»“æ„ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨äº†Sorted Seté›†åˆç±»å‹ã€‚</p><p>GEOç±»å‹ä½¿ç”¨GeoHashç¼–ç æ–¹æ³•å®ç°äº†ç»çº¬åº¦åˆ°Sorted Setä¸­å…ƒç´ æƒé‡åˆ†æ•°çš„è½¬æ¢ï¼Œè¿™å…¶ä¸­çš„ä¸¤ä¸ªå…³é”®æœºåˆ¶å°±æ˜¯å¯¹äºŒç»´åœ°å›¾åšåŒºé—´åˆ’åˆ†ï¼Œä»¥åŠå¯¹åŒºé—´è¿›è¡Œç¼–ç ã€‚ä¸€ç»„ç»çº¬åº¦è½åœ¨æŸä¸ªåŒºé—´åï¼Œå°±ç”¨åŒºé—´çš„ç¼–ç å€¼æ¥è¡¨ç¤ºï¼Œå¹¶æŠŠç¼–ç å€¼ä½œä¸ºSorted Setå…ƒç´ çš„æƒé‡åˆ†æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠç»çº¬åº¦ä¿å­˜åˆ°Sorted Setä¸­ï¼Œåˆ©ç”¨Sorted Setæä¾›çš„â€œæŒ‰æƒé‡è¿›è¡Œæœ‰åºèŒƒå›´æŸ¥æ‰¾â€çš„ç‰¹æ€§ï¼Œå®ç°LBSæœåŠ¡ä¸­é¢‘ç¹ä½¿ç”¨çš„â€œæœç´¢é™„è¿‘â€çš„éœ€æ±‚ã€‚</p><p>GEOå±äºRedisæä¾›çš„æ‰©å±•æ•°æ®ç±»å‹ã€‚æ‰©å±•æ•°æ®ç±»å‹æœ‰ä¸¤ç§å®ç°é€”å¾„ï¼šä¸€ç§æ˜¯åŸºäºç°æœ‰çš„æ•°æ®ç±»å‹ï¼Œé€šè¿‡æ•°æ®ç¼–ç æˆ–æ˜¯å®ç°æ–°çš„æ“ä½œçš„æ–¹å¼ï¼Œæ¥å®ç°æ‰©å±•æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚åŸºäºSorted Setå’ŒGeoHashç¼–ç å®ç°GEOï¼Œä»¥åŠåŸºäºStringå’Œä½æ“ä½œå®ç°Bitmapï¼›å¦ä¸€ç§å°±æ˜¯å¼€å‘è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå…·ä½“çš„æ“ä½œæ˜¯å¢åŠ æ–°æ•°æ®ç±»å‹çš„å®šä¹‰ï¼Œå®ç°åˆ›å»ºå’Œé‡Šæ”¾å‡½æ•°ï¼Œå®ç°æ–°æ•°æ®ç±»å‹æ”¯æŒçš„å‘½ä»¤æ“ä½œï¼Œå»ºè®®ä½ å°è¯•ç€æŠŠä»Šå¤©å­¦åˆ°çš„å†…å®¹çµæ´»åœ°åº”ç”¨åˆ°ä½ çš„å·¥ä½œåœºæ™¯ä¸­ã€‚</p><h2>æ¯è¯¾ä¸€é—®</h2><p>åˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ Redisçš„5å¤§åŸºæœ¬æ•°æ®ç±»å‹å’Œ3ä¸ªæ‰©å±•æ•°æ®ç±»å‹ï¼Œæˆ‘æƒ³è¯·ä½ æ¥èŠä¸€èŠï¼Œä½ åœ¨æ—¥å¸¸çš„å®è·µè¿‡ç¨‹ä¸­ï¼Œè¿˜ç”¨è¿‡Redisçš„å…¶ä»–æ•°æ®ç±»å‹å—ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ ä½¿ç”¨è¿‡çš„å…¶ä»–æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥äº¤æµå­¦ä¹ ã€‚å¦‚æœä½ èº«è¾¹è¿˜æœ‰æƒ³è¦è‡ªå·±å¼€å‘Redisçš„æ–°æ•°æ®ç±»å‹çš„æœ‹å‹ï¼Œä¹Ÿå¸Œæœ›ä½ å¸®æˆ‘æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™ä»–/å¥¹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","comments":[{"had_liked":false,"id":246078,"user_name":"Kaito","can_delete":false,"product_type":"c1","uid":1020042,"ip_address":"","ucode":"79775FA35A95F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","comment_is_top":false,"comment_ctime":1599159207,"is_pvip":true,"discussion_count":33,"race_medal":0,"score":"1418938366887","product_id":100056701,"comment_content":"Redisä¹Ÿå¯ä»¥ä½¿ç”¨Listæ•°æ®ç±»å‹å½“åšé˜Ÿåˆ—ä½¿ç”¨ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨rpushç”Ÿäº§æ•°æ®åˆ°Redisä¸­ï¼Œå¦ä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨lpopå–å‡ºæ•°æ®è¿›è¡Œæ¶ˆè´¹ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨Listå½“åšé˜Ÿåˆ—ï¼Œç¼ºç‚¹æ˜¯æ²¡æœ‰ackæœºåˆ¶å’Œä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…ã€‚æ²¡æœ‰ackæœºåˆ¶ä¼šå¯¼è‡´ä»Redisä¸­å–å‡ºçš„æ•°æ®åï¼Œå¦‚æœå®¢æˆ·ç«¯å¤„ç†å¤±è´¥äº†ï¼Œå–å‡ºçš„è¿™ä¸ªæ•°æ®ç›¸å½“äºä¸¢å¤±äº†ï¼Œæ— æ³•é‡æ–°æ¶ˆè´¹ã€‚æ‰€ä»¥ä½¿ç”¨Listç”¨ä½œé˜Ÿåˆ—é€‚åˆäºå¯¹äºä¸¢å¤±æ•°æ®ä¸æ•æ„Ÿçš„ä¸šåŠ¡åœºæ™¯ï¼Œä½†å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼Œå› ä¸ºéƒ½æ˜¯å†…å­˜æ“ä½œï¼Œæ‰€ä»¥éå¸¸å¿«å’Œè½»é‡ã€‚<br><br>è€ŒRedisæä¾›çš„PubSubï¼Œå¯ä»¥æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œç”Ÿäº§è€…å‘å¸ƒä¸€æ¡æ¶ˆæ¯ï¼Œå¤šä¸ªæ¶ˆè´¹è€…åŒæ—¶è®¢é˜…æ¶ˆè´¹ã€‚ä½†æ˜¯å®ƒçš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœä»»æ„ä¸€ä¸ªæ¶ˆè´¹è€…æŒ‚äº†ï¼Œç­‰æ¢å¤è¿‡æ¥åï¼Œåœ¨è¿™æœŸé—´çš„ç”Ÿäº§è€…çš„æ•°æ®å°±ä¸¢å¤±äº†ã€‚PubSubåªæŠŠæ•°æ®å‘ç»™åœ¨çº¿çš„æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…ä¸€æ—¦ä¸‹çº¿ï¼Œå°±ä¼šä¸¢å¼ƒæ•°æ®ã€‚å¦ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼ŒPubSubä¸­çš„æ•°æ®ä¸æ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œå½“Rediså®•æœºæ¢å¤åï¼Œå…¶ä»–ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ä»RDBå’ŒAOFä¸­æ¢å¤å›æ¥ï¼Œä½†PubSubä¸è¡Œï¼Œå®ƒå°±æ˜¯ç®€å•çš„åŸºäºå†…å­˜çš„å¤šæ’­æœºåˆ¶ã€‚<br><br>ä¹‹åRedis 5.0æ¨å‡ºäº†Streamæ•°æ®ç»“æ„ï¼Œå®ƒå€Ÿé‰´äº†Kafkaçš„è®¾è®¡æ€æƒ³ï¼Œå¼¥è¡¥äº†Listå’ŒPubSubçš„ä¸è¶³ã€‚Streamç±»å‹æ•°æ®å¯ä»¥æŒä¹…åŒ–ã€æ”¯æŒackæœºåˆ¶ã€æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…ã€æ”¯æŒå›æº¯æ¶ˆè´¹ï¼ŒåŸºæœ¬ä¸Šå®ç°äº†é˜Ÿåˆ—ä¸­é—´ä»¶å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œæ¯”Listå’ŒPubSubæ›´å¯é ã€‚<br><br>å¦ä¸€ä¸ªç»å¸¸ä½¿ç”¨çš„æ˜¯åŸºäºRediså®ç°çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå…¶åº•å±‚å®ç°åˆ©ç”¨çš„æ˜¯Stringæ•°æ®ç»“æ„å’Œä½è¿ç®—ï¼Œå¯ä»¥è§£å†³ä¸šåŠ¡å±‚ç¼“å­˜ç©¿é€çš„é—®é¢˜ï¼Œè€Œä¸”å†…å­˜å ç”¨éå¸¸å°ï¼Œæ“ä½œéå¸¸é«˜æ•ˆã€‚","like_count":331,"discussions":[{"author":{"id":1411096,"avatar":"https://static001.geekbang.org/account/avatar/00/15/88/18/9744d5ec.jpg","nickname":"å°è¶…äºº","note":"","ucode":"0D8A433F3E3737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339317,"discussion_content":"æˆ‘æ˜¯ list + lua æ¥å®ç°æ¶ˆæ¯çš„ ack çš„ã€‚ã€‚\n","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1609602045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303735,"discussion_content":"æ¥¼ä¸»Rediså®ç°çš„å¸ƒéš†è¿‡æ»¤å™¨å…·ä½“æ–¹æ¡ˆèƒ½è®²ä¸€ä¸‹å—","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599364847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303751,"discussion_content":"Rediså®˜ç½‘ï¼Œmoduleæ¨¡å—æœ‰å¸ƒéš†è¿‡æ»¤å™¨çš„å…·ä½“å®ç°å’Œä½¿ç”¨ã€‚","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1599371150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303735,"ip_address":""},"score":303751,"extra":""},{"author":{"id":2277195,"avatar":"https://static001.geekbang.org/account/avatar/00/22/bf/4b/2acf59c1.jpg","nickname":"æˆ‘","note":"","ucode":"49C9AFFB997A3F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338514,"discussion_content":"è¿˜æœ‰å¸ƒè°·é¸Ÿè¿‡æ»¤å™¨å’Œtopkç­‰éƒ½åœ¨ä¸€ä¸ªæ’ä»¶äº†ï¼Œredisbloom","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609304781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303735,"ip_address":""},"score":338514,"extra":""}]},{"author":{"id":1879262,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ac/de/68f35320.jpg","nickname":"å°æ¥å­","note":"","ucode":"4EDAF31E43B211","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339436,"discussion_content":"è¯¾ä»£è¡¨æœ‰åˆ©ç”¨Redisçš„pub/subå®ç°æœ¬åœ°ç¼“å­˜çš„æ›´æ–°çš„ç»å†å—ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609670908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099321,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/39/0b837f63.jpg","nickname":"ä¸éå‹è² ","note":"","ucode":"A1CB36404DB884","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327395,"discussion_content":"lpoprpush  serverç«¯åŸå­æ€§æ“ä½œ  æ¶ˆè´¹æˆåŠŸå æ¸…é™¤rä¸­æ•°æ®  å¦åˆ™è½®è¯¢å‡ºæ¥ç»§ç»­æ¶ˆè´¹  é¿å…ä¸¢å¤±","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605828940,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1103875,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d8/03/04af3e17.jpg","nickname":"å¼ æ²›","note":"","ucode":"0EB2143BC61F1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1099321,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/39/0b837f63.jpg","nickname":"ä¸éå‹è² ","note":"","ucode":"A1CB36404DB884","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573227,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆç”¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653281815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":327395,"ip_address":""},"score":573227,"extra":""},{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1099321,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/39/0b837f63.jpg","nickname":"ä¸éå‹è² ","note":"","ucode":"A1CB36404DB884","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576890,"discussion_content":"è¿™æ ·é”ä¸¥é‡å§, ä¸€ç›´é”åˆ°ä¸šåŠ¡ç¡®è®¤æ¶ˆè´¹æˆåŠŸ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655825485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":327395,"ip_address":""},"score":576890,"extra":""}]},{"author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308232,"discussion_content":"å…¶å®å¯ä»¥åœ¨ç¼–ç å±‚é¢è§£å†³è¿™ç§æ²¡æ¶ˆè´¹çš„é—®é¢˜,å¦‚æœæ²¡æœ‰æ¶ˆè´¹,æˆ–è€…å‡ºå¼‚å¸¸äº†,å†æ’å…¥åˆ°é˜Ÿåˆ—å°¾éƒ¨...  ä½†æ˜¯è¿™æ ·å­åªé€‚åˆå¯¹æ•°æ®å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„æ•°æ®;\nå¤šä¸ªæ¶ˆè´¹çš„è¯,ç¼–ç å±‚é¢ä¹Ÿå¯ä»¥å¤åˆ¶ç»™å¤šä¸ªæ¶ˆè´¹è€…,é…±ç´«; è¿˜æ˜¯çœ‹åœºæ™¯,æ¯•ç«Ÿredisä¸æ˜¯ä¸“é—¨ç”¨æ¥åšæ¶ˆæ¯é˜Ÿåˆ—çš„.\n\nè¯¾ä»£è¡¨nb...","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600872799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1768852,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fd/94/8704d2b0.jpg","nickname":"spoofer","note":"","ucode":"6723F64ACC3F27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323126,"discussion_content":"ackæœºåˆ¶è·Ÿè¿™ä¸ªè‡ªå·±æ¶ˆè´¹å¤±è´¥æ’å…¥åˆ°å°¾éƒ¨æ˜¯ä¸ä¸€æ ·ï¼Œå› ä¸ºå¤„ç†æœŸé—´å¯èƒ½å‡ºç°é—®é¢˜è€Œä¸¢å¤±ï¼Œä¸è¿‡æˆ‘å¾ˆå¤šæ•°æ®ä¸æ•æ„Ÿçš„åœºæ™¯éƒ½è¿™æ ·ç”¨çš„ï¼Œæ‡’å¾—mqã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604888551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":308232,"ip_address":""},"score":323126,"extra":""}]},{"author":{"id":1441606,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ff/46/7e4039ea.jpg","nickname":"ä¼Ÿå¹³","note":"","ucode":"2D3E55238FC8B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305039,"discussion_content":"æ¥¼ä¸»æœ‰è‡ªå·±çš„åšå®¢ä¹ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1599747635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303456,"discussion_content":"è¯·æ•™ä¸‹è¯¾ä»£è¡¨å•Šï¼ŒRedis é”®å€¼å¯¹ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ç”¨ RedisObject ä¿å­˜\n-------------------------\né‚£ä¹ˆ redis çš„é”®ç”¨ä»€ä¹ˆä¿å­˜çš„å‘¢ï¼Ÿ ä¹Ÿæ˜¯ RedisObject å—ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1599273544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1653021,"avatar":"","nickname":"Geek_013147","note":"","ucode":"CDA474EC7DE06C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"discussion":{"id":307440,"discussion_content":"æ˜¯çš„ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯redisObject","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1600651486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303456,"ip_address":""},"score":307440,"extra":""},{"author":{"id":1013669,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/77/a5/c5ae871d.jpg","nickname":"zenk","note":"","ucode":"B235D5EBCF49BC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1653021,"avatar":"","nickname":"Geek_013147","note":"","ucode":"CDA474EC7DE06C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328618,"discussion_content":"å¥½åƒä¸æ˜¯ï¼Œçœ‹åˆ°é¢„å®šä¹‰çš„dictTypeæœ‰sdsä½œä¸ºkeyçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606195574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307440,"ip_address":""},"score":328618,"extra":""},{"author":{"id":1584786,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2e/92/e1c38ca6.jpg","nickname":"KamTo  Hung","note":"","ucode":"00D5A6479DB784","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"discussion":{"id":347146,"discussion_content":"æ˜¯çš„ï¼Œä¹Ÿæ˜¯RedisObjectã€‚keyæŒ‡é’ˆæŒ‡å‘çš„æ‰€ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯sdsã€‚å¯¹äºæ‰€æœ‰key-valueï¼Œkeyéƒ½æ˜¯RedisObjectæŒ‡å‘sdsæ•°æ®ç»“æ„ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1612164366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303456,"ip_address":""},"score":347146,"extra":""}]},{"author":{"id":1645430,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiauonyMORA2s43W7mogGDH4WYjW0gBJtYmUa9icTB6aMPGqibicEKlLoQmLKLWEctwHzthbTZkKR20w/132","nickname":"Spring4J","note":"","ucode":"06F056085A2564","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303207,"discussion_content":"ä¸€ä¸ªlistä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…ï¼Œå¤šä¸ªlistæ˜¯ä¸æ˜¯å°±æ”¯æŒå¤šæ¶ˆè´¹è€…äº†è€å“¥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1599185893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1645430,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiauonyMORA2s43W7mogGDH4WYjW0gBJtYmUa9icTB6aMPGqibicEKlLoQmLKLWEctwHzthbTZkKR20w/132","nickname":"Spring4J","note":"","ucode":"06F056085A2564","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303214,"discussion_content":"å‡†ç¡®çš„è¯´æ˜¯ï¼Œä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€æ‰¹æ•°æ®ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1599187921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303207,"ip_address":""},"score":303214,"extra":""},{"author":{"id":2165529,"avatar":"","nickname":"Geek_529ac5","note":"","ucode":"5B17D44B9A33E0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":303564,"discussion_content":"åº”è¯¥æ˜¯ä¸åŒçš„æ¶ˆè´¹è€…ç»„å§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1599299168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303214,"ip_address":""},"score":303564,"extra":""},{"author":{"id":2996016,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/b7/30/c1e4f5b5.jpg","nickname":"å¾®å¾®è¶…çº§ä¸¹ğŸ’«","note":"","ucode":"ABEFC2FA673BE4","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":1645430,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiauonyMORA2s43W7mogGDH4WYjW0gBJtYmUa9icTB6aMPGqibicEKlLoQmLKLWEctwHzthbTZkKR20w/132","nickname":"Spring4J","note":"","ucode":"06F056085A2564","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589475,"discussion_content":"åº”è¯¥æ˜¯ List ä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€æ¡æ¶ˆæ¯ï¼Œä½†æ˜¯å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹ä¸€ä¸ªListä¸­çš„ä¸åŒæ¶ˆæ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665027942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303207,"ip_address":"åŒ—äº¬"},"score":589475,"extra":""}]},{"author":{"id":1281857,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8f/41/307555ff.jpg","nickname":"ä¼Šè¯º","note":"","ucode":"709E038DD01C17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573498,"discussion_content":"å¸ƒéš†è¿‡æ»¤å™¨ï¼Œä½¿ç”¨åœºæ™¯å¯ä»¥ä¸¾ä¾‹ä¹ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653466434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2649276,"avatar":"https://static001.geekbang.org/account/avatar/00/28/6c/bc/f751786b.jpg","nickname":"Leo","note":"","ucode":"CEBAD9CDCFC2A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556503,"discussion_content":"å¸ƒéš†è¿‡æ»¤å™¨åº•å±‚ä¸ä¾ç„¶æ˜¯bitmapå—ï¼Œä½ è¯´é”™äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647403722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2948634,"avatar":"","nickname":"Geek_275fa9","note":"","ucode":"E08AB55F59EF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2649276,"avatar":"https://static001.geekbang.org/account/avatar/00/28/6c/bc/f751786b.jpg","nickname":"Leo","note":"","ucode":"CEBAD9CDCFC2A3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557816,"discussion_content":"bitmapçš„åº•å±‚å°±æ˜¯ string ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1647968903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":556503,"ip_address":""},"score":557816,"extra":""}]},{"author":{"id":2109265,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2f/51/6cde3858.jpg","nickname":"éš”å£è€ç‹","note":"","ucode":"F5A4A33BC2474D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328412,"discussion_content":"åˆšç™¾åº¦äº†ä¸€ä¸‹å‘ç°geoadd å‘½ä»¤çš„memberå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„valueï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±ä¼šæ›´æ–°ï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606135832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2109265,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2f/51/6cde3858.jpg","nickname":"éš”å£è€ç‹","note":"","ucode":"F5A4A33BC2474D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369703,"discussion_content":"å’Œ sortset ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619140145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328412,"ip_address":""},"score":369703,"extra":""},{"author":{"id":2354537,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKHTfq9c3GG4DdJtHnvyib3eX7Q5IzqQ0U65vpqsibyJzwsROUtEOEhWl58X1aaQ0R3dNIibUYyD6PyQ/132","nickname":"Geek_d77d44","note":"","ucode":"DD8C35E40AD976","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":371015,"discussion_content":"zadd å¹¶ä¸è¡Œï¼Œå¯ä»¥ç”¨zincrby","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619610964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369703,"ip_address":""},"score":371015,"extra":""},{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2354537,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKHTfq9c3GG4DdJtHnvyib3eX7Q5IzqQ0U65vpqsibyJzwsROUtEOEhWl58X1aaQ0R3dNIibUYyD6PyQ/132","nickname":"Geek_d77d44","note":"","ucode":"DD8C35E40AD976","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576891,"discussion_content":"zaddå¯ä»¥æ›´æ–°valueçš„åˆ†æ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655825804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":371015,"ip_address":""},"score":576891,"extra":""}]},{"author":{"id":2109265,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2f/51/6cde3858.jpg","nickname":"éš”å£è€ç‹","note":"","ucode":"F5A4A33BC2474D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328408,"discussion_content":"é—®ä¸€ä¸‹æ¥¼ä¸»ï¼Œä½œè€…è®²çš„geoç±»å‹çš„æ•°æ®ï¼Œæ˜¯æ€ä¹ˆç»çº¬åº¦å¯¹åº”çš„é‚£ä¸ªvalueçš„å‘€ï¼Œåˆæˆ–è€…è¯´ï¼ŒæŸä¸€ä¸ªvalueçš„ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘è¯¥æ€ä¹ˆæ›´æ–°å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606135600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2568744,"avatar":"https://static001.geekbang.org/account/avatar/00/27/32/28/078ec46c.jpg","nickname":"topå•¦å®ƒ","note":"","ucode":"1F2656293D1B9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2109265,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2f/51/6cde3858.jpg","nickname":"éš”å£è€ç‹","note":"","ucode":"F5A4A33BC2474D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378894,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623493396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328408,"ip_address":""},"score":378894,"extra":""},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2109265,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2f/51/6cde3858.jpg","nickname":"éš”å£è€ç‹","note":"","ucode":"F5A4A33BC2474D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385041,"discussion_content":"åŠ  CH å‚æ•°å³å¯æ›´æ–°ï¼Œæ¯”å¦‚ï¼š GEOADD cars:locations CH 116.034579 39.030459 33","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1626860248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328408,"ip_address":""},"score":385041,"extra":""}]},{"author":{"id":1547776,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/wqu0v0PZUmPfBgOAMA8J54zsC8HbblbpibMRbGepLErgg70E81fKQn7oaoiaqNszibxrC5XyAjBSJXnGYialicWvQeQ/132","nickname":"Geek_c79c5c","note":"","ucode":"0E15A545F30A63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327973,"discussion_content":"å­¦åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606032398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325816,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","nickname":"å›å“¥èŠæŠ€æœ¯","note":"","ucode":"2C9A22BCE4C79E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303176,"discussion_content":"å‰å®³ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599178987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1284487,"avatar":"","nickname":"å•Šå•Šå•Š","note":"","ucode":"81B03655CFFE98","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1325816,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","nickname":"å›å“¥èŠæŠ€æœ¯","note":"","ucode":"2C9A22BCE4C79E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375798,"discussion_content":"å“ˆå“ˆ å…³æ³¨ä½ å…¬ä¼—å·äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621850710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303176,"ip_address":""},"score":375798,"extra":""}]}]},{"had_liked":false,"id":248845,"user_name":"æ³¨å®šéå‡¡","can_delete":false,"product_type":"c1","uid":1113597,"ip_address":"","ucode":"80673056E131B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/fd/fd/326be9bb.jpg","comment_is_top":false,"comment_ctime":1600332913,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"263593337969","product_id":100056701,"comment_content":"1ï¼Œä½œè€…è®²äº†ä»€ä¹ˆï¼Ÿ<br>    Redisçš„ä¸‰ç§æ‰©å±•æ•°æ®ç±»å‹ä¹‹ä¸€ï¼šGEOï¼Œä¸€ç§å¯ä»¥å®ç°LBSæœåŠ¡çš„æ•°æ®ç»“æ„<br><br>2ï¼Œä½œè€…æ˜¯æ€ä¹ˆæŠŠè¿™äº‹ç»™è®²æ˜ç™½çš„ï¼Ÿ<br>    1ï¼Œæå‡ºä¸€ä¸ªçœŸé—®é¢˜ï¼šæ‰“è½¦è½¯ä»¶æ˜¯æ€ä¹ˆåŸºäºä½ç½®æä¾›æœåŠ¡çš„<br>    2ï¼Œé€šè¿‡GEOåŸç†è®²è§£ï¼Œè¯´æ˜GEOä¸ºä»€ä¹ˆå¯ä»¥<br><br>3ï¼Œä½œè€…ä¸ºäº†æŠŠè¿™äº‹ç»™è®²æ¸…æ¥šï¼Œè®²äº†é‚£äº›è¦ç‚¹ï¼Ÿæœ‰å“ªäº›äº®ç‚¹ï¼Ÿ<br>    1ï¼Œäº®ç‚¹1ï¼šGEOçš„åŸç†ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä¹‹å‰æ‰€ä¸çŸ¥é“çš„ï¼Œå­¦å®Œåå¯¹GEOæœ‰äº†ä¸€äº›è®¤çŸ¥<br>    2ï¼Œäº®ç‚¹2ï¼šRediså±…ç„¶æ”¯æŒè‡ªå®šä¹‰æ•°æ®å­˜å‚¨ç»“æ„ï¼Œè¿™æ‰“å¼€äº†æˆ‘çš„çœ¼ç•Œ<br>    3ï¼Œè¦ç‚¹1ï¼šGEOçš„åº•å±‚å®ç°ï¼Œæ˜¯sortSetï¼Œå…ƒç´ æ˜¯è½¦è¾†ä¿¡æ¯ï¼Œæƒé‡æ˜¯è½¦è¾†ç»çº¬åº¦è½¬æ¢è¿‡æ¥çš„floatå€¼<br>    4ï¼Œè¦ç‚¹2ï¼šGEOHashç¼–ç ï¼ŒåŸºæœ¬åŸç†â€œäºŒåˆ†åŒºé—´ï¼ŒåŒºé—´ç¼–ç â€ï¼ˆäºŒåˆ†æ³•çš„åº”ç”¨ï¼Œå°†ä¸€ä¸ªå€¼ç¼–ç æˆNä½çš„äºŒè¿›åˆ¶å€¼ï¼‰<br>    5ï¼Œè¦ç‚¹3ï¼šGEOä½¿ç”¨GEOHashç¼–ç åï¼Œå°†ç»çº¬åº¦ï¼ŒæŒ‰ç…§çº¬å¥‡ç»å¶ä½åˆ†åˆ«å¡«å……ç»„åˆï¼Œå¾—åˆ°ä¸€ä¸ªè½¦è¾†çš„ç»çº¬åº¦ç¼–ç å€¼<br>    6ï¼Œè¦ç‚¹4ï¼šGEOHashç¼–ç å®ç°çš„æ•ˆæœæ˜¯å°†ä¸€ä¸ªç©ºé—´åˆ†å‰²æˆä¸ºä¸€ä¸ªä¸ªæ–¹å—ï¼Œå¯ä»¥å®ç°LBSæœåŠ¡ï¼ˆä½†ç¼–ç å€¼ç›¸è¿‘ï¼Œä¸ä¸€å®šä½ç½®ç›¸è¿‘ï¼‰<br><br>4ï¼Œå¯¹äºä½œè€…æ‰€è®²ï¼Œæˆ‘æœ‰å“ªäº›å‘æ•£æ€§æ€è€ƒï¼Ÿ<br>   â‘ ï¼šè¿™ä¸€ç¯‡è®²äº†é€šè¿‡Redisçš„GEOæ•°æ®ç±»å‹å¯ä»¥å®ç°LBSæœåŠ¡ï¼Œè®©æˆ‘ä½“éªŒåˆ°äº†ç®—æ³•çš„å·§å¦™åº”ç”¨å¸¦æ¥çš„å·¨å¤§ä¾¿åˆ©ï¼ˆè¿™åº”æ˜¯ç§‘æŠ€è®©ç”Ÿæ´»æ›´ç¾å¥½çš„å®ä¾‹ï¼‰ã€‚<br>   â‘¡ï¼šä¸è¿‡ï¼Œæˆ‘è§‰å¾—æœ€å¤§çš„æƒŠå–œåœ¨äºä½œè€…ä»‹ç»äº†å¦‚ä½•è‡ªå®šä¹‰ä¸€ç§æ–°çš„æ•°æ®ç±»å‹ï¼Œè™½ç„¶æˆ‘å°šæœªæŒæ¡å¼€å‘æ–°æ•°æ®ç±»å‹çš„èƒ½åŠ›ã€‚<br>   â‘¢ï¼šé€šè¿‡ä½œè€…çš„è®²è§£ï¼Œæ‹“å®½äº†æˆ‘äº†è§è¯†ï¼Œè¿™è®©æˆ‘ä½“éªŒåˆ°äº†è´­ä¹°ä¸“æ çš„ä»·å€¼ï¼ˆå¦‚æœéƒ½æ˜¯æœç´¢å¼•æ“èƒ½è§£å†³çš„äº‹ï¼Œä½•å¿…ä¹°ä¸“æ ï¼‰ã€‚<br>   â‘£ï¼šä½œè€…ç»†è‡´çš„è®²è§£å¼€å‘è¿‡ç¨‹ï¼Œä¹Ÿè®©æˆ‘å¯¹Redisçš„æ•°æ®ç»“æ„ï¼ŒRedisObjectiæœ‰äº†è¿›ä¸€æ­¥è®¤è¯†ï¼ˆé¢å‘å¯¹è±¡ç­‰ï¼‰<br><br>5ï¼Œåœ¨æœªæ¥çš„é‚£äº›åœºæ™¯ä¸­ï¼Œæˆ‘èƒ½å¤Ÿä½¿ç”¨å®ƒï¼Ÿ<br>    redisé‡‡ç”¨çš„GEOHashç®—æ³•ï¼Œè²Œä¼¼å¯ä»¥ååŠ©æˆ‘ä»¬å¤„ç†åˆ†çœçš„ä¸€äº›ä¸šåŠ¡<br><br>6ï¼Œç•™è¨€åŒºçš„æ”¶è·","like_count":62,"discussions":[{"author":{"id":1070901,"avatar":"https://static001.geekbang.org/account/avatar/00/10/57/35/0e66265d.jpg","nickname":"Jason","note":"","ucode":"BFBA1C05A2921A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333560,"discussion_content":"å­¦éœ¸çš„å¥—è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607563820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246169,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1599197065,"is_pvip":false,"discussion_count":7,"race_medal":0,"score":"160512987017","product_id":100056701,"comment_content":"ç°åœ¨å¾ˆå¤šå…¬å¸å¦‚æœæ²¡æœ‰ç‰¹æ®Šåœºæ™¯ï¼Œéƒ½æ˜¯ä¸€ä¸ªStringèµ°å¤©ä¸‹ï½","like_count":38,"discussions":[{"author":{"id":1641326,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDdmHm6txEVtEXEDibSdIsRLEpghOoMt2kfZHetY9QLWHygicKCfhVoYiaylAZJoXbcCMBhXqMF4icgw/132","nickname":"æ´—æ´—ç¡å§","note":"","ucode":"DE7F8B4CA512F6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385301,"discussion_content":"æ˜¯çš„ï¼Œæˆ‘ä»¬æŠŠå¯¹è±¡è½¬json,ç”¨Stringå­˜","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1626973242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1164531,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c4/f3/92f654f1.jpg","nickname":"Bug? Feature!","note":"","ucode":"F8FA8A0094FBA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336487,"discussion_content":"çœ‹è§è€å“¥äº†ï¼Œå“ˆå“ˆï¼","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1608607043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310141,"discussion_content":"å“ªæ¥åšç¼“å­˜ç”¨ï¼Œåªç”¨äº†String","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601641795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2786848,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/86/20/1f1221f5.jpg","nickname":"å¬é£","note":"","ucode":"EC2EB012E8DB6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588715,"discussion_content":"ç­¾åˆ°é¢†ç¤¼å“å¯ä»¥ç”¨hashå•Š\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664012550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1811277,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a3/4d/59390ba9.jpg","nickname":"æ’éª¨","note":"","ucode":"A413CF46211E1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582048,"discussion_content":"æˆ‘ä»¬ä¹Ÿæ˜¯ä¸€ä¸ªstringä¸‡é‡‘æ²¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659164978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2161554,"avatar":"https://static001.geekbang.org/account/avatar/00/20/fb/92/17923e19.jpg","nickname":"å›¢åœ†ä¸","note":"","ucode":"23DD0146F43C7D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580045,"discussion_content":"æ‰€ä»¥memcacheæ‰ä¸€ç›´å­˜åœ¨ç€......","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657849027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2806043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBFkSq1oiaEMRjtyyv4ZpCI0OuaSsqs04ODm0OkZF6QhsAh3SvqhxibS2n7PLAVZE3QRSn5Hic0DyXg/132","nickname":"ddh","note":"","ucode":"8E852375365F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545800,"discussion_content":"å“ˆå“ˆå“ˆï¼Œ çœŸå®äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642053399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256549,"user_name":"èŒƒé—²","can_delete":false,"product_type":"c1","uid":1073125,"ip_address":"","ucode":"F21FD7DF6BA53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg","comment_is_top":false,"comment_ctime":1603676232,"is_pvip":false,"replies":[{"id":"98028","content":"æ˜¯çš„ï¼Œå¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥å¸®åŠ©åˆ¤æ–­æ•°æ®æ˜¯å¦åœ¨ç¼“å­˜ä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1609084408,"ip_address":"","comment_id":256549,"utype":1}],"discussion_count":1,"race_medal":0,"score":"91797989448","product_id":100056701,"comment_content":"BloomFilterç”¨çš„æ¯”è¾ƒå¤šã€‚ç¼“å­˜ç©¿é€å¯ä»¥ç”¨è¿™ä¸ªé˜²æ­¢","like_count":22,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508050,"discussion_content":"æ˜¯çš„ï¼Œå¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥å¸®åŠ©åˆ¤æ–­æ•°æ®æ˜¯å¦åœ¨ç¼“å­˜ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609084408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246585,"user_name":"è¿·è¿·å¾’","can_delete":false,"product_type":"c1","uid":2107618,"ip_address":"","ucode":"5B65708B7E2DC1","user_header":"https://static001.geekbang.org/account/avatar/00/20/28/e2/fbf76ae6.jpg","comment_is_top":false,"comment_ctime":1599413947,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"61728956091","product_id":100056701,"comment_content":"geohashçœŸæ˜¯å¦™å‘€","like_count":15,"discussions":[{"author":{"id":2948634,"avatar":"","nickname":"Geek_275fa9","note":"","ucode":"E08AB55F59EF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557818,"discussion_content":"å¦™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647969085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247407,"user_name":"Geek2014","can_delete":false,"product_type":"c1","uid":2028957,"ip_address":"","ucode":"9EB356D8DF287E","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f5/9d/104bb8ea.jpg","comment_is_top":false,"comment_ctime":1599702766,"is_pvip":false,"discussion_count":10,"race_medal":0,"score":"44549375726","product_id":100056701,"comment_content":"æƒ³é—®ä¸€ä¸ªæ‰©å±•çš„é—®é¢˜ï¼Œè¿˜è¯·è€å¸ˆè§£ç­”ã€‚<br>å› ä¸ºè½¦è¾†æ˜¯ä¸æ–­ç§»åŠ¨çš„ï¼Œé‚£å¦‚ä½•ç»´æŠ¤è½¦è¾†ä½ç½®çš„GEOHASHå‘¢ã€‚","like_count":11,"discussions":[{"author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337528,"discussion_content":"ä¹‹å‰åšä¸ªä¸€ä¸ªLBSç±»çš„ä¸šåŠ¡å®ç°åŸç†æ˜¯ç§»åŠ¨è¶…è¿‡ä¸€å®šè·ç¦»å°±ä¸ŠæŠ¥æ›´æ–°ä¸€æ¬¡ä½ç½®ä¿¡æ¯","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1608963608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2278542,"avatar":"https://static001.geekbang.org/account/avatar/00/22/c4/8e/89f8d85e.jpg","nickname":"ç¬‘ å®¹","note":"","ucode":"9E72450E9719ED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540405,"discussion_content":"è¿™ä¸ªå¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640053813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":337528,"ip_address":""},"score":540405,"extra":""}]},{"author":{"id":1634466,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f0/a2/e5d7dfd8.jpg","nickname":"è€å¤«å­ç©¿è¢ˆè£Ÿ","note":"","ucode":"3238BDAE0CDAF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550598,"discussion_content":"ä¹‹å‰æ¥è§¦è¿‡é¡ºé£è½¦çš„é¡¹ç›®ï¼Œè®¡åˆ’æ˜¯é‡‡ç”¨å‰ç«¯é•¿è¿æ¥æ¯5ç§’ä¸ŠæŠ¥ä¸€æ¬¡ä½ç½®ä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644634324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2350812,"avatar":"","nickname":"xyzker","note":"","ucode":"CC897FFF51A1A9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550342,"discussion_content":"é•¿è¿æ¥å®šæ—¶ä¸ŠæŠ¥æ›´æ–°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644488599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206229,"avatar":"https://static001.geekbang.org/account/avatar/00/12/67/d5/1b26b725.jpg","nickname":"Gopher","note":"","ucode":"3C1F9012BB486D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341260,"discussion_content":"è¿™ä¸ªè‚¯å®šæ˜¯å‰ç«¯å®æ—¶ä¸ŠæŠ¥æ•°æ®å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610364740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1337717,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJfySwRreOLI6feibPQ6nAnkvsLUmibSDYxvChxXyDQanGGpibYBgACO6ibUbYTLJ4Uvoc6MlyjibIf9Wg/132","nickname":"Bigchen","note":"","ucode":"224A5FA18ABA96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1206229,"avatar":"https://static001.geekbang.org/account/avatar/00/12/67/d5/1b26b725.jpg","nickname":"Gopher","note":"","ucode":"3C1F9012BB486D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354685,"discussion_content":"åˆ†ä¸åŒåœºæ™¯å§ï½ç‰©æµè¿è¾“è½¦è¾†å¯ä»¥å®šæ—¶ï½æ»´æ»´æ‰“è½¦è¿™ç§åœºæ™¯å¯èƒ½å°±å®æ—¶äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615335586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":341260,"ip_address":""},"score":354685,"extra":""}]},{"author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308234,"discussion_content":"åŒé—®~ çŒœæµ‹åº”è¯¥å®šæ—¶å‘æœåŠ¡å‘é€å§,æˆ–è€…è½¦è¾†è·ç¦»é¦–æ¬¡ä½ç½®æˆ–è¶…è¿‡å¤šå°‘è·ç¦»åæ›´æ–°æˆ–è€…åˆ é™¤å§.... ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600873265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2140871,"avatar":"","nickname":"Geek_77da6a","note":"","ucode":"2E7102E0005A42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310855,"discussion_content":"ä¼šä¸ä¼šä¸€ä¸ªé•¿è¿æ¥ ä¸€ç›´ä¿æŒé“¾æ¥  äº‹å®åˆ·æ–°ä½ç½®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602079076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":308234,"ip_address":""},"score":310855,"extra":""},{"author":{"id":1216284,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8f/1c/1c728388.jpg","nickname":"çš®å¡çš®å¡","note":"","ucode":"D440EEC7301C76","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2140871,"avatar":"","nickname":"Geek_77da6a","note":"","ucode":"2E7102E0005A42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327562,"discussion_content":"å¯¼èˆªæ—¶åº”è¯¥ä¼šæœ‰é•¿é“¾æ¥å®æ—¶åˆ·æ–°ï¼Œå…¶ä»–åœºæ™¯åˆ™æ˜¯å®šæ—¶è·å–ã€‚å½“ç„¶å¹¶éè¡Œä¸šä»ä¸šäººå‘˜åªæ˜¯çŒœæµ‹è¿™æ ·åš","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605862723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":310855,"ip_address":""},"score":327562,"extra":""},{"author":{"id":1690758,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cc/86/c7f71b1c.jpg","nickname":"tiptok","note":"","ucode":"EAB2145853774F","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":1216284,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8f/1c/1c728388.jpg","nickname":"çš®å¡çš®å¡","note":"","ucode":"D440EEC7301C76","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":351226,"discussion_content":"æ²¡é”™å“¦ï¼Œè½¦è½½ç»ˆç«¯é‡‡é›†å®Œå®šæ—¶ä¸ŠæŠ¥ç»™ç³»ç»Ÿï¼Œé€šè¿‡çº¦å®šçš„åè®®ï¼Œèµ°tcp/udpç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614180605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":327562,"ip_address":""},"score":351226,"extra":""}]}]},{"had_liked":false,"id":246311,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1599273516,"is_pvip":true,"replies":[{"id":"90537","content":"æ˜¯çš„ï¼ŒRedisçš„é”®ä¹Ÿæ˜¯ç”¨RedisObjectä¿å­˜çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1599349374,"ip_address":"","comment_id":246311,"utype":1}],"discussion_count":2,"race_medal":1,"score":"40253979180","product_id":100056701,"comment_content":"Redis é”®å€¼å¯¹ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ç”¨ RedisObject ä¿å­˜<br>-------------------------<br>é‚£ä¹ˆ redis çš„é”®ç”¨ä»€ä¹ˆä¿å­˜çš„å‘¢ï¼Ÿ ä¹Ÿæ˜¯ RedisObject å—ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505109,"discussion_content":"æ˜¯çš„ï¼ŒRedisçš„é”®ä¹Ÿæ˜¯ç”¨RedisObjectä¿å­˜çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599349374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435733,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","nickname":"MClink","note":"","ucode":"F479190923355C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303572,"discussion_content":"é”®éƒ½æ˜¯ string ç±»å‹ï¼Œè‚¯å®šä¹Ÿæ˜¯è¿™æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599300710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246697,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1599456009,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"31664227081","product_id":100056701,"comment_content":"1ã€ä½œè€…è®²äº†ä»€ä¹ˆï¼Ÿ<br>GEO çš„æ•°æ®ç»“æ„åŸç†ï¼ŒåŠç‰¹ç‚¹ã€‚è¿˜æœ‰ç¼–å†™ Redis æ–°æ•°æ®ç»“æ„å’Œå‘½ä»¤çš„æ­¥éª¤ï¼ˆæ­¤éƒ¨åˆ†æˆ‘æ²¡ç»†çœ‹ï¼‰ã€‚<br>2ã€ä½œè€…æ˜¯æ€ä¹ˆæŠŠäº‹æƒ…è¯´æ˜ç™½çš„ï¼Ÿ<br>é€šè¿‡åˆ©ç”¨ LBS(Location-Based Service)Â  ä½ç½®ä¿¡æ¯æœåŠ¡ æ¥è¯´å¼•å…¥ GEO è¿™ä¸ªæ•°æ®ç»“æ„å¦‚ä½•ç¼–ç åœ°ç†ä½ç½®çš„ç»çº¬åº¦ä¿¡æ¯ï¼Œå†™æˆä¸€ä¸ªæ•°å€¼ï¼Œå†åˆ©ç”¨ Sorted Set è¿›è¡Œå­˜å‚¨ã€‚<br>3ã€ä¸ºäº†è®²æ˜ç™½ï¼Œä½œè€…è®²äº†å“ªäº›è¦ç‚¹ï¼Ÿå“ªäº›æ˜¯äº®ç‚¹ï¼Ÿ<br>ä¸¾ä¾‹å­è¯´æ˜ï¼ŒHashã€Sorted Set å¦‚ä½•æ— æ³•æ»¡è¶³ LBS æœåŠ¡ï¼›<br>è®²è¿° Geo Hash çš„è¿‡ç¨‹ï¼ˆäºŒåˆ†åŒºé—´ï¼ŒåŒºé—´ç¼–ç ï¼‰ï¼š<br>å°†ä¸€ä¸ªæ•°å€¼é€šè¿‡äºŒåˆ†æ‹†è§£ï¼Œå½¢æˆä¸€ä¸ªäºŒå‰æ ‘ç»“æ„ï¼Œå¾—åˆ°æ¯å±‚çš„ bool å€¼ï¼Œä»è€Œé€šè¿‡Nä½ bit å¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œå­˜å‚¨ã€‚N è¶Šå¤§ï¼Œç²¾åº¦è¶Šé«˜ï¼›<br>å°†ç»çº¬åº¦ï¼Œåˆ†åˆ«æŒ‰ç…§ step1 è·å¾—ä¸¤ä¸ª N ä½bitï¼Œåœ¨è¿›è¡Œäº¤å‰ç»„åˆï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ï¼Œå°±æ˜¯ Geo Hash å€¼ã€‚<br>è¿™ä¸ª Geo Hash å€¼æ˜¯è¿ç»­çš„ï¼Œä½†ä½ç½®ä¸ä¸€å®šæ˜¯è¿ç»­çš„ã€‚æ•…éœ€è¦è®¡ç®—å¤šä¸ªç»çº¬åº¦æ‰€åœ¨çš„æ–¹æ ¼ï¼Œåœ¨æ±‚å¾—é‚»å±…èŠ‚ç‚¹çš„è¾ƒä½ï¼Œå·²æé«˜ LBS å‡†ç¡®ç‡ã€‚<br>4ã€å¯¹äºä½œè€…æ‰€è®²ï¼Œæˆ‘æœ‰å“ªäº›å‘æ•£æ€§æ€è€ƒï¼Ÿ<br>è½¦è¾†çš„ä½ç½®ä¿¡æ¯å·²ç»å­˜å‚¨åœ¨ GEO é›†åˆä¸­äº†ï¼ŒæŠ•å…¥ä¸€ä¸ª GEO çš„å€¼ï¼Œå¦‚ä½•è·å¾—å®ƒå‘¨å›´çš„èŒƒå›´å€¼å‘¢ï¼Ÿ<br>5ã€åœ¨æœªæ¥å“ªäº›åœºæ™¯ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨å®ƒï¼Ÿ<br>LBS æœåŠ¡å¯ä»¥è€ƒè™‘å®ç°å®ƒï¼Œå·²å’Œå…¬å¸çš„ä¸€ä¸ªä¸Šå¸æ²Ÿé€šä¸ªï¼Œå¤§å®¶å°±è¿™ä¸ªé—®é¢˜æœ‰äº†å…±è¯†ã€‚nice","like_count":7,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310138,"discussion_content":"éå‡¡å“¥2å·","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1601641318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310249,"discussion_content":"å“ˆå“ˆå“ˆï¼Œç¡®å®æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç¬”è®°","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1601708811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":310138,"ip_address":""},"score":310249,"extra":""}]}]},{"had_liked":false,"id":246730,"user_name":"æ™–","can_delete":false,"product_type":"c1","uid":1498664,"ip_address":"","ucode":"D12C7EBDCD4236","user_header":"https://static001.geekbang.org/account/avatar/00/16/de/28/acb248d6.jpg","comment_is_top":false,"comment_ctime":1599466857,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"18779336041","product_id":100056701,"comment_content":"ä¸¥æ ¼æ¥è¯´ï¼Œæ ¹æ®Redisæ–‡æ¡£: &quot;There are limits to the coordinates that can be indexed: areas very near to the poles are not indexable. Valid latitudes are from -85.05112878 to 85.05112878 degrees.&quot; æ‰€ä»¥çº¬åº¦çš„æå€¼åº”è¯¥ä¸èƒ½åˆ°æ­£è´Ÿ90åº¦ã€‚","like_count":4,"discussions":[{"author":{"id":1337717,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJfySwRreOLI6feibPQ6nAnkvsLUmibSDYxvChxXyDQanGGpibYBgACO6ibUbYTLJ4Uvoc6MlyjibIf9Wg/132","nickname":"Bigchen","note":"","ucode":"224A5FA18ABA96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354690,"discussion_content":"è¿™ä¸ªçœ‹æŠ•å½±ï¼Œä¸åŒæŠ•å½±å¯¹äºä¸œè¥¿ç»åº¦ï¼Œå—åŒ—çº¬åº¦çš„è¡¨ç¤ºæ–¹å¼ä¸ä¸€æ ·ã€‚ä½œè€…æ–‡ä¸­æåˆ°çš„æ˜¯æ­£ç¡®çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615336472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293645,"user_name":"LQS  KF","can_delete":false,"product_type":"c1","uid":1364737,"ip_address":"","ucode":"3C0A07A8220094","user_header":"https://static001.geekbang.org/account/avatar/00/14/d3/01/716d45b6.jpg","comment_is_top":false,"comment_ctime":1621475807,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14506377695","product_id":100056701,"comment_content":"å¸ƒéš†è¿‡æ»¤å™¨RedisBloomå’ŒRedisCellæä¾›çš„é™æµæ“ä½œ","like_count":3},{"had_liked":false,"id":289679,"user_name":"å¤å¤©","can_delete":false,"product_type":"c1","uid":2542376,"ip_address":"","ucode":"5F224DDAC94DFF","user_header":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","comment_is_top":false,"comment_ctime":1619141858,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14504043746","product_id":100056701,"comment_content":"ç»™å¤§å®¶è¡¥ä¸€ä¸ª<br><br>ElasticSearch çš„ geo_distance ä¹Ÿå¯ä»¥ç”¨æ¥åšè·ç¦»è®¡ç®—<br><br>æŒ‰æ€§èƒ½è€Œè¨€ï¼Œè‚¯å®šæ˜¯ Redis å¥½ã€‚<br><br>ElasticSearch å¯¹äºæœç´¢ï¼Œæ›´çµæ´»ï¼Œæ”¯æŒåŠŸèƒ½æ›´å¤šã€‚<br><br>è®¾è®¡æ–¹æ¡ˆå¯ä»¥è€ƒè™‘","like_count":4},{"had_liked":false,"id":314371,"user_name":"ä¿¯ç°é£æ™¯.","can_delete":false,"product_type":"c1","uid":1044166,"ip_address":"","ucode":"A6DB68B7B84AEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/c6/bebcbcf0.jpg","comment_is_top":false,"comment_ctime":1632989018,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10222923610","product_id":100056701,"comment_content":"å¯¹äºâ€œæœç´¢é™„è¿‘çš„é¤é¦†â€å’Œâ€œæœç´¢é™„è¿‘çš„è½¦è¾†â€ç­‰åŸºäºåœ°ç†ä½ç½®ä¿¡æ¯çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæƒ³è¦æ”¯æŒè¿™ç§éœ€æ±‚ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯è·å–åœ°ç†ä½ç½®ä¿¡æ¯å¹¶è¿›è¡Œç¼–ç ï¼ŒæŠŠâ€œæ¯”è¾ƒè·ç¦»è¿œè¿‘â€çš„é—®é¢˜æŠ½è±¡ä¸ºâ€œæ¯”è¾ƒæ•°å€¼çš„å·®å€¼â€çš„é—®é¢˜ï¼Œå› ä¸ºåœ°å€ä¿¡æ¯æ˜¯äºŒç»´ç©ºé—´ä¸­çš„é—®é¢˜ï¼Œæ•°å€¼ç¼–ç æ˜¯ä¸€ç»´çš„ï¼Œé‚£ä¹ˆé¦–å…ˆè¦åšçš„äº‹æƒ…å°±æ˜¯â€œæ•°æ®é™ç»´â€ï¼Œé€šè¿‡GeoHashç¼–ç æ–¹å¼æŠŠäºŒç»´æ•°æ®é™ç»´åˆ°ä¸€ç»´ï¼Œç„¶åå†è¿›è¡Œæ¯”è¾ƒã€‚è€ŒèŒƒå›´æ¯”è¾ƒéœ€æ±‚å°±å¯ä»¥ä½¿ç”¨Sorteed Setç±»å‹æ¥æ”¯æŒäº†ã€‚","like_count":2},{"had_liked":false,"id":285597,"user_name":"è¾¾å”ç¬","can_delete":false,"product_type":"c1","uid":2404887,"ip_address":"","ucode":"5CCBAF13548F02","user_header":"https://static001.geekbang.org/account/avatar/00/24/b2/17/3161b49c.jpg","comment_is_top":false,"comment_ctime":1616913356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10206847948","product_id":100056701,"comment_content":"äº†è§£ä¸‹ æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿  å®³","like_count":2},{"had_liked":false,"id":284097,"user_name":"å®ˆæœ›è€…","can_delete":false,"product_type":"c1","uid":1623487,"ip_address":"","ucode":"DEE375A5F2D57A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/sPORo6cN3GSVxjHj9nqSAPn7KG4wtSTqNUommjNndpf8qd7bHKHquuldXZfxD5nF1ldy4LeoAQNwSsOgcmWG9w/132","comment_is_top":false,"comment_ctime":1616062673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10205997265","product_id":100056701,"comment_content":"çº¬åº¦è¶Šé«˜(å¤§)çš„åœ°æ–¹ï¼Œå•ä½ç»åº¦æ‰€å¯¹åº”çš„åœ°é¢å®é™…è·ç¦»ä¼šè¶Šå°ï¼Œå³ç»åº¦ä¸è·ç¦»å¹¶ä¸æ˜¯æ’å®šç­‰æ¯”çš„ã€‚æ‰€ä»¥æˆ‘æƒ³é—®çš„æ˜¯ï¼ŒGEORADIUSå‘½ä»¤ä¸­çš„å‚æ•°ï¼Œ5kmæ˜¯å¦‚ä½•åœ¨redisä¸­ä½¿ç”¨çš„å‘¢?","like_count":2},{"had_liked":false,"id":263355,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1606113592,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10196048184","product_id":100056701,"comment_content":"è€å¸ˆ   åŸºäºä½ç½®ä¿¡æ¯æœå®é™…ç”¨ä»€ä¹ˆæ•°æ®åº“æ¥åšå‘¢ï¼ŸçœŸæ˜¯ç”¨rediså— ï¼Ÿ è¿˜æ˜¯ç”¨postgresqlè¿˜æ˜¯å…¶ä»–çš„æ•°æ®å•Š","like_count":2,"discussions":[{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369718,"discussion_content":"çœ‹åœºæ™¯ã€‚çœ‹ä¸¢å¤±æ•°æ®çš„å®¹å¿åº¦ã€‚çœ‹æ€§èƒ½éœ€æ±‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619141178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341428,"user_name":"é˜¿æ˜•","can_delete":false,"product_type":"c1","uid":1012906,"ip_address":"","ucode":"F3AD093B68E074","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/aa/178a6797.jpg","comment_is_top":false,"comment_ctime":1649600203,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5944567499","product_id":100056701,"comment_content":"1.ç­¾åˆ°çš„åœºæ™¯ï¼Œä½¿ç”¨äº†BitMapç»“æ„ï¼›<br>2.æ’è¡Œæ¦œåœºæ™¯ï¼Œä½¿ç”¨äº†SortSetç»“æ„ï¼›<br>3.è´­ç‰©è½¦åœºæ™¯ï¼Œä½¿ç”¨äº†HashSetç»“æ„ï¼›","like_count":1},{"had_liked":false,"id":315146,"user_name":"ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€","can_delete":false,"product_type":"c1","uid":1658786,"ip_address":"","ucode":"A380B0756CB306","user_header":"https://static001.geekbang.org/account/avatar/00/19/4f/a2/694cde4c.jpg","comment_is_top":false,"comment_ctime":1633701904,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5928669200","product_id":100056701,"comment_content":"è¿˜æœ‰ä¸€ç‚¹ä¸æ˜¯å¤ªæ¸…æ¥šï¼Œgeohashæ˜¯æ€ä¹ˆè®¡ç®—è·ç¦»çš„äº†","like_count":1,"discussions":[{"author":{"id":2925210,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Nq86sJRY7bXLAydQbfBM4iajfwKVowAkXPJNlj20VGBpOicze0Za561AicickuobZdkNqrSRuU50V7sbmicM1I9aib6g/132","nickname":"Geek_563045","note":"","ucode":"0B2C8636C3B68C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584405,"discussion_content":"æ„Ÿè§‰è¿™ä¸ªä¸œè¥¿æœ‰ç‚¹ç±»ä¼¼äºäºŒåˆ†æŸ¥æ‰¾æ³•ï¼Œå…ˆå°†ç»åº¦äºŒåˆ†æŸ¥æ‰¾å®šä½ï¼Œç„¶åçº¬åº¦å®šä½äºŒåˆ†æŸ¥æ‰¾ã€‚éƒ½æ˜¯lognã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660807693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ¹–å—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2797976,"avatar":"","nickname":"Geek_323a60","note":"","ucode":"CDC276EC255411","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581956,"discussion_content":"æ²¡æœ‰è®¡ç®—è·ç¦»å•Šï¼Œæ˜¯é€šè¿‡åˆ†åŒºæ‰¾åˆ°â€œç›¸é‚»â€çš„åŒºåŸŸå•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659084754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1272026,"avatar":"https://static001.geekbang.org/account/avatar/00/13/68/da/5bcb83b1.jpg","nickname":"ç™½æ™¨","note":"","ucode":"6D6171B8ECEDDD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547863,"discussion_content":"åˆ†åŒºçš„ç²’åº¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642915115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308241,"user_name":"Geek_c37e49","can_delete":false,"product_type":"c1","uid":1844885,"ip_address":"","ucode":"BCE0AD860241C7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo6waC1mF0VmQibDjnJLEgFnmEUSNJozibaUeYZkpQaqicVcXxGZ3kKtnY5XF0iblxT4oiam7ucuJ1bqgg/132","comment_is_top":false,"comment_ctime":1629466114,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5924433410","product_id":100056701,"comment_content":"ä¸ºä»€ä¹ˆgeoç»çº¬åº¦ç¼–ç ä¹‹åï¼Œè¦ä½¿ç”¨å¥‡æ•°ä½å’Œå¶æ•°ä½åˆ†åˆ«å­˜æ”¾ç»çº¬åº¦è¿™ç§äº¤é”™çš„æ–¹å¼å‘¢ï¼Ÿæœ‰ç‚¹æ²¡æƒ³é€š","like_count":2,"discussions":[{"author":{"id":2220763,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","nickname":"_patrick","note":"","ucode":"B24C6EEBCABB94","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560617,"discussion_content":"å®é™…ä¸Šå°±æ˜¯ç»†åˆ†ã€‚ å°†ç²¾åº¦å’Œçº¬åº¦åˆ†åˆ«ç»†åˆ†ã€‚å¦‚æœåªå…ˆè€ƒè™‘ç»åº¦ å†è€ƒè™‘çº¬åº¦ï¼Œå³ç¼–ç æ˜¯  ç»åº¦ç¼–ç +çº¬åº¦ç¼–ç  ï¼Œè¿™æ ·å»æ’åºçš„è¯ï¼Œé‚£ç¼–ç è¡¨ç¤ºçš„è·ç¦»è¯¯å·®ä¼šå¾ˆå¤§ã€‚æ˜æ˜è·ç¦»å¾ˆå° ä½†æ˜¯ç¼–ç çš„å·®è·å¯èƒ½éå¸¸å¤§ã€‚    ç”»åœ¨äºŒç»´çš„å¹³é¢ä¸Š å¥‡å¶äº¤é”™ é‚£ä¹ˆç¼–ç çš„æ’åºå ç›¸é‚»ç¼–ç å³å¯å¤§è‡´åæ˜ å‡ºè·ç¦»çš„è¿œè¿‘ï¼Œä½†æ˜¯ä¹Ÿæœ‰è¯¯å·®ã€‚ çœ‹å›¾çœ‹å›¾ å°±æ‡‚äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1649405044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284772,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1616466527,"is_pvip":true,"discussion_count":2,"race_medal":2,"score":"5911433823","product_id":100056701,"comment_content":"ä½ç½®ä¿¡æ¯æœåŠ¡ç°åœ¨å·²ç»æˆä¸ºäº†å„ç§æœåŠ¡çš„æ ‡é…ï¼Œå¦å¤–ï¼Œç”¨æˆ·çš„åœ°ç†ä½ç½®ä¿¡æ¯ä¹Ÿæ˜¯å¾ˆæœ‰ä»·å€¼çš„ï¼Œå…¶å®æˆ‘å€’æ˜¯éå¸¸çœ‹å¥½é«˜å¾·ï¼Œè¿™å¯èƒ½ä¹Ÿæ˜¯ç™¾åº¦å’Œå…¶ä»–ä¸€äº›å¤§å‚å§‹ç»ˆä¸æ”¾å¼ƒå¼€å‘åœ°å›¾å’Œå¯¼èˆªåº”ç”¨çš„åˆè¡·ã€‚<br><br>ä¸€å¼€å§‹ä¸ç†è§£ GeoHash çš„ç¼–ç ï¼Œä¸ºä»€ä¹ˆè¦ç»çº¬åº¦ç¼–ç äº¤å‰ç»„åˆï¼Œåæ¥çœ‹åˆ°é‚£ä¸ª 4 åˆ†åŒºå›¾ç¤ºï¼Œå°±åªèƒ½è¯´ï¼Œç¬¬ä¸€ä¸ªæƒ³åˆ°çš„äººå®åœ¨æ˜¯å¤©æ‰ã€‚<br><br>GEOADD å’Œ GEOADIUS å·²ç»æœ‰ç‚¹ç±»ä¼¼äº DSL äº†ï¼Œç®€åŒ–äº†å¾ˆå¤šæ“ä½œã€‚<br><br>ä¸“æ ä¸­è€å¸ˆæ‰‹æŠŠæ‰‹çš„æ•™äº†ä¸€éå¦‚ä½•è‡ªå®šä¹‰ç±»å‹ï¼Œè™½ç„¶æš‚æ—¶ç”¨ä¸åˆ°ï¼Œä½†æ˜¯çœ‹çš„è¿˜æ˜¯æ¯”è¾ƒè¿‡ç˜¾çš„ã€‚ä¸è¿‡å› ä¸ºå·²ç»çœ‹è¿‡äº†å…¨éƒ¨çš„åŠ é¤å†…å®¹ï¼Œè€å¸ˆæåˆ°åé¢ä¼šè®²åˆ°æŒä¹…åŒ–ä¿å­˜çš„ä»£ç ï¼Œæ˜æ˜¾ä¸åœ¨å…¶ä¸­ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨ä¸“æ çš„æ­£å¼æ–‡ç« é‡Œé¢ï¼Ÿ<br><br>ä¸ªäººçŒœæµ‹ï¼ŒåŸºäºä½ç½®æœåŠ¡çš„åº”ç”¨ä¸ä¼šåªç”¨ Redis æ¥æŸ¥è¯¢ï¼Œè¿˜ä¼šæœ‰æŒä¹…åŒ–åˆ°æ•°æ®åº“çš„éƒ¨åˆ†ï¼ŒRedis åªæ˜¯æä¾›æ¥è¿‘å®æ—¶çš„æŸ¥è¯¢åº”ç”¨ï¼ŒElastic ä¼¼ä¹ä¹Ÿæœ‰ç±»ä¼¼çš„åŠŸèƒ½ã€‚<br><br>å¦å¤–ï¼Œä»è€å¸ˆå›å¤ä¸­çŸ¥é“ï¼ŒRedis çš„é”®å’Œå€¼éƒ½æ˜¯ç”¨ RedisObject ä¿å­˜çš„ã€‚ç¨æœ‰ç–‘é—®ï¼Œé”®ç›´æ¥ç”¨ String æˆ–è€… SDS æ¥å­˜ä¸å¥½ä¹ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2948634,"avatar":"","nickname":"Geek_275fa9","note":"","ucode":"E08AB55F59EF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557822,"discussion_content":"åˆæ˜¯ å¤©æ‰ å­—çœ¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647969313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369721,"discussion_content":"è¿™å°±æ˜¯é¢å‘å¯¹è±¡çš„æ€æƒ³äº†ã€‚ç»Ÿä¸€å…¥å£ç»Ÿä¸€æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619141387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253821,"user_name":"è“å£«é’¦","can_delete":false,"product_type":"c1","uid":1229516,"ip_address":"","ucode":"726EB5C8EF1249","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","comment_is_top":false,"comment_ctime":1602906465,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5897873761","product_id":100056701,"comment_content":"å…³äºç”¨GEOæ¥å®ç°LBSæœ‰ä¸ªç–‘é—®ï¼Œç¼“å­˜å¤§å°æ˜¯çè´µä¸”æœ‰é™çš„ï¼Œä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ä½ç½®ä¿¡æ¯éƒ½å­˜åœ¨ç¼“å­˜ä¸­ä¸ç°å®å§ã€‚è¿‡æœŸæ·˜æ±°ç­–ç•¥è¯¥æ€ä¹ˆå®ç°ï¼Ÿæ˜¯ä¸æ˜¯è¦åœ¨ç¨‹åºä¸­å®šæœŸçš„åšä¸šåŠ¡æ£€æµ‹å’Œç¼“å­˜æ•°æ®æ‰¹é‡è½åº“ã€‚åªä¿è¯çƒ­ç‚¹åŒºåŸŸåœ¨ç¼“å­˜ä¸­å³å¯","like_count":1,"discussions":[{"author":{"id":1581294,"avatar":"","nickname":"Geek_be4cec","note":"","ucode":"C87642D655EAC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398590,"discussion_content":"æ»´æ»´å‡ºè¡ŒAPPæ‰“è½¦çš„æ—¶å€™,èƒ½çœ‹åˆ°å¥½å¤šå°è½¦å›¾æ ‡åœ¨åœ°å›¾ä¸Šçš„è¡Œä¸ºè½¨è¿¹ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ç”¨GEOæ¥å®ç°çš„å˜›","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632817407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369719,"discussion_content":"å…¨å­˜ä¹Ÿé—®é¢˜ä¸å¤§ï¼Œä¸è¡Œå°±åˆ†ç‰‡","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619141259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246448,"user_name":"D","can_delete":false,"product_type":"c1","uid":1027596,"ip_address":"","ucode":"5BB4D16FE39BFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/0c/f39f847a.jpg","comment_is_top":false,"comment_ctime":1599354006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5894321302","product_id":100056701,"comment_content":"è€å¸ˆï¼Œè¿™å—çš„ä»£ç æ”¹åŠ¨èƒ½å¦ç»™ä¸ªfork url çœ‹ä¸‹ï¼Ÿ","like_count":1},{"had_liked":false,"id":246127,"user_name":"é‚£æ—¶åˆ»","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1599185719,"is_pvip":false,"discussion_count":3,"race_medal":1,"score":"5894153015","product_id":100056701,"comment_content":"è¯·é—®è€å¸ˆï¼Œredisobjecté‡Œçš„ refcountï¼šè®°å½•äº†å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œè¿™ä¸ªå¯¹è±¡å¼•ç”¨è®¡æ•°åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘ç”Ÿå‘¢ï¼Ÿå…·ä½“ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310142,"discussion_content":"è¿™ä¸ªkeyè¢«è®¿é—®åˆ°çš„æ—¶å€™æ›´æ–°ï¼Œæ¯”å¦‚ GET xxxx.\nrefcountå¯ä»¥ç”¨äºRediså†…éƒ¨çš„LRUï¼ˆLeast Recently Used,æœ€è¿‘æœ€å°‘è¢«ä½¿ç”¨ï¼‰ç¼“å­˜æ·˜æ±°æœºåˆ¶ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1601641888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2640551,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4a/a7/ab7998b1.jpg","nickname":"zachary","note":"","ucode":"B22B95FCECD6E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380625,"discussion_content":"å—åˆ°javaçš„å½±å“ï¼ŒåŸå…ˆä»¥ä¸ºè¿™ä¸ªrefcountæ˜¯åšå†…å­˜å›æ”¶ç”¨çš„ï¼Œä½†æ˜¯cè¯­è¨€å¹¶æ²¡æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ã€‚æ‰€ä»¥ï¼Œåªå¯èƒ½ç”¨äºlfuç®—æ³•ç»Ÿè®¡è¢«è®¿é—®æ¬¡æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624609365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2031180,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/fe/4c/736bc949.jpg","nickname":"å³°å›è·¯è½¬","note":"","ucode":"382408FF40D99A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318382,"discussion_content":"redisObjectè¢«ä¸€ä¸ªæ–°ç¨‹åºä½¿ç”¨æ—¶ï¼Œ refcountå¢ä¸€; redisObjectä¸å†è¢«ä¸€ä¸ªç¨‹åºä½¿ç”¨æ—¶ï¼Œ refcountå‡ä¸€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603720738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346144,"user_name":"æœå…°ç‰¹æœ‰ä¸¶å°å¸…","can_delete":false,"product_type":"c1","uid":1320433,"ip_address":"","ucode":"9E1FA13BA68E87","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/f1/f7a11901.jpg","comment_is_top":false,"comment_ctime":1652856094,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652856094","product_id":100056701,"comment_content":"å…³äºgeohashæœ‰ä¸ªç‚¹æ²¡æ˜ç™½ï¼ŒredisæŠŠç»çº¬åº¦è½¬æ¢ä¸ºgeohashä½œä¸ºscoreå­˜å‚¨åœ¨sorted setä¸­ï¼Œé‚£ä¹ˆæ˜¯å¦‚ä½•è®¡ç®—é™„è¿‘çš„äººçš„ï¼Œæ¯”å¦‚ï¼Œæˆ‘æƒ³è®¡ç®—è·ç¦»å½“å‰ä½ç½®5kmå†…çš„äººï¼Œä½¿ç”¨GEORADIUSå‘½ä»¤ï¼Œé‚£ä¹ˆredisæ˜¯å¦‚ä½•è®¡ç®—å‡º5kmå†…çš„ç‚¹å‘¢ï¼Ÿå¯ä»¥ç›´æ¥é€šè¿‡scoreç®—å‡ºæ¥é•¿åº¦å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":339672,"user_name":"William Ning","can_delete":false,"product_type":"c1","uid":1592279,"ip_address":"","ucode":"4DB8D05E69E5F3","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","comment_is_top":false,"comment_ctime":1648285554,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"1648285554","product_id":100056701,"comment_content":"çœ‹å®Œäº†ï¼Œè§‰å¾—å¤§å®¶éƒ½å¾ˆå‰å®³å“¦ï½","like_count":0,"discussions":[{"author":{"id":3190922,"avatar":"","nickname":"Geek_590385","note":"","ucode":"BE5BDD9180FA0E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590227,"discussion_content":"å…„å¼Ÿï¼Œä½ æ‰æ˜¯æœ€å‰å®³çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665629978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè¥¿"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":3190922,"avatar":"","nickname":"Geek_590385","note":"","ucode":"BE5BDD9180FA0E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591995,"discussion_content":"AllğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667019513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":590227,"ip_address":"å››å·"},"score":591995,"extra":""}]}]},{"had_liked":false,"id":339200,"user_name":"Geek_275fa9","can_delete":false,"product_type":"c1","uid":2948634,"ip_address":"","ucode":"E08AB55F59EF59","user_header":"","comment_is_top":false,"comment_ctime":1647968758,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647968758","product_id":100056701,"comment_content":"çœŸæ˜¯å¹²æ´»æ»¡æ»¡","like_count":0},{"had_liked":false,"id":331944,"user_name":"ç™½æ™¨","can_delete":false,"product_type":"c1","uid":1272026,"ip_address":"","ucode":"6D6171B8ECEDDD","user_header":"https://static001.geekbang.org/account/avatar/00/13/68/da/5bcb83b1.jpg","comment_is_top":false,"comment_ctime":1642915162,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642915162","product_id":100056701,"comment_content":"è‡ªå®šä¹‰æ•°æ®ç±»å‹é‚£é‡Œï¼Œæ˜¯æ€ä¹ˆå»éƒ¨ç½²å’Œå®ç°çš„å‘¢ï¼Ÿå¥½åƒåªæ˜¯è¯´åˆ°ç¼–ç è€Œå·²ï¼Ÿ","like_count":0},{"had_liked":false,"id":322945,"user_name":"å—å¤©","can_delete":false,"product_type":"c1","uid":1796693,"ip_address":"","ucode":"DA26E76BC95F1B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ4QCWqGgMN4kp615f0Dlb8Ty61iaeOfMia7dyOic5mcgiarxGv8pyra1dibiajXicDLibxqsyM6uNabia4ckw/132","comment_is_top":false,"comment_ctime":1637667563,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637667563","product_id":100056701,"comment_content":"ç»çº¬åº¦(116.034579ï¼Œ39.030452)å–åŒºé—´ æ˜¯å¦å¯ä»¥ç”¨sortedsetæ¥å®ç°ï¼Œå…¶ä¸­æƒé‡å€¼è®¾ç½®æˆ11603457939030452<br>å…ˆç²¾åº¦èŒƒå›´å–ä¸€äº›åªï¼Œå†ç»´åº¦èŒƒå›´å–ä¸€äº›å€¼ï¼Œç„¶åå–äº¤é›†","like_count":0},{"had_liked":false,"id":305732,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1628135854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628135854","product_id":100056701,"comment_content":"ç”¨å¸ƒéš†è¿‡æ»¤å™¨åšé™æµåº”è¯¥ç®—æ˜¯å§","like_count":0},{"had_liked":false,"id":303661,"user_name":"Liujun","can_delete":false,"product_type":"c1","uid":1736462,"ip_address":"","ucode":"3DB1F3CA57B5B3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/7f/0e/e3a8dbd9.jpg","comment_is_top":false,"comment_ctime":1626919252,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626919252","product_id":100056701,"comment_content":"GEO ç”¨æ¥å¤„ç† LBS ç›¸å…³ä¸šåŠ¡åŠŸèƒ½ï¼Œåº•å±‚æ˜¯åŸºäº Sorted Set å®ç°çš„ï¼Œä½¿ç”¨ GEOHASH ç®—æ³•æŠŠç»çº¬åº¦è½¬æ¢æˆ Score å€¼ã€‚","like_count":0},{"had_liked":false,"id":302454,"user_name":"èŠ±å„¿å°‘å¹´","can_delete":false,"product_type":"c1","uid":1318540,"ip_address":"","ucode":"CFE4F64243673B","user_header":"https://static001.geekbang.org/account/avatar/00/14/1e/8c/450fe5cb.jpg","comment_is_top":false,"comment_ctime":1626229098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626229098","product_id":100056701,"comment_content":"ä¸€ä¸ªString èµ°å¤©ä¸‹<br>åŸå› æ˜¯ï¼šæ•°æ®çš„å±‚æ¬¡å¤šï¼Œæ‰¹é‡æŸ¥è¯¢ï¼Œè¦æ±‚æ—¶å»¶å°ï¼Œå•ä¸ªç”¨æˆ·çš„æ•°æ®é€‚åˆæ”¾åœ¨hashæ•°æ®ç»“æ„ä¸­ï¼Œä¾‹å¦‚ç”¨æˆ·åœ¨æŸä¸ªå•†å“ä¸‹çš„è®¢å•æ•°ï¼›ä½†æ˜¯å¤§å¤šæ•°æ—¶å€™éƒ½æ˜¯æ‰¹é‡æŸ¥ç”¨æˆ·çš„Nä¸ªå•†å“çš„è®¢å•æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸æ€ä¹ˆå¥½æ“ä½œï¼ŒåŒæ—¶ä¹Ÿå¤æ‚äº†ï¼Œæ•ˆç‡ä¸Šä¹Ÿä¸æ˜¯å¾ˆå¥½è¯„ä¼°ï¼Œè¿˜ä¸å¦‚MGETä¸€æ³¢","like_count":0},{"had_liked":false,"id":293170,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1621251949,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621251949","product_id":100056701,"comment_content":"æ‰€ä»¥ï¼Œä¸ºäº†é¿å…æŸ¥è¯¢ä¸å‡†ç¡®é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æŸ¥è¯¢ç»™å®šç»çº¬åº¦æ‰€åœ¨çš„æ–¹æ ¼å‘¨å›´çš„ 4 ä¸ªæˆ– 8 ä¸ªæ–¹æ ¼ã€‚<br><br>æ²¡å¤ªæ‡‚è¿™å¥è¯ï¼ŒæŸ¥å‘¨å›´ 4 ä¸ªæˆ– 8 ä¸ªæ–¹æ ¼ï¼Œæ€ä¹ˆèƒ½é¿å…æŸ¥è¯¢ä¸å‡†ç¡®é—®é¢˜å–ï¼Ÿè°¢è°¢","like_count":0},{"had_liked":false,"id":291974,"user_name":"é‡é¸­å­","can_delete":false,"product_type":"c1","uid":2227628,"ip_address":"","ucode":"F32A5164B081DE","user_header":"https://static001.geekbang.org/account/avatar/00/21/fd/ac/619e197b.jpg","comment_is_top":false,"comment_ctime":1620631060,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"1620631060","product_id":100056701,"comment_content":"è€å¸ˆ 16ä¸ªåˆ†åŒºå›¾ä¸­çš„ç¼–ç å€¼æ€ä¹ˆå¾—æ¥çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1316926,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/3e/f8632713.jpg","nickname":"EveryDayIsNew","note":"","ucode":"776B81EF6830FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389319,"discussion_content":"http://gk.link/a/10vX3","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629215937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2948634,"avatar":"","nickname":"Geek_275fa9","note":"","ucode":"E08AB55F59EF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1316926,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/3e/f8632713.jpg","nickname":"EveryDayIsNew","note":"","ucode":"776B81EF6830FA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557819,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647969250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":389319,"ip_address":""},"score":557819,"extra":""},{"author":{"id":2948634,"avatar":"","nickname":"Geek_275fa9","note":"","ucode":"E08AB55F59EF59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1316926,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/3e/f8632713.jpg","nickname":"EveryDayIsNew","note":"","ucode":"776B81EF6830FA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557820,"discussion_content":"å›ä½ ä¸€ä¸ª http://www.redis.cn/redis_memory/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647969259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":389319,"ip_address":""},"score":557820,"extra":""},{"author":{"id":1320433,"avatar":"https://static001.geekbang.org/account/avatar/00/14/25/f1/f7a11901.jpg","nickname":"æœå…°ç‰¹æœ‰ä¸¶å°å¸…","note":"","ucode":"9E1FA13BA68E87","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1316926,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/3e/f8632713.jpg","nickname":"EveryDayIsNew","note":"","ucode":"776B81EF6830FA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572561,"discussion_content":"æ„Ÿè°¢è€å“¥ï¼Œè¿˜æ˜¯è¦çœ‹åŸç†æ‰èƒ½æ¸…æ¥šåº•å±‚è®¡ç®—æ–¹å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652857057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":389319,"ip_address":""},"score":572561,"extra":""}]}]},{"had_liked":false,"id":290364,"user_name":"å¬é£","can_delete":false,"product_type":"c1","uid":1276183,"ip_address":"","ucode":"D0DAA9209C5DF5","user_header":"https://static001.geekbang.org/account/avatar/00/13/79/17/5cf39369.jpg","comment_is_top":false,"comment_ctime":1619515450,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619515450","product_id":100056701,"comment_content":"æ‚¨å¥½è€å¸ˆè¯·é—®ä¸€ä¸‹çœŸå®çš„å¤§é‡LBSè·ç¦»èŒƒå›´è¯·æ±‚ä¸­ï¼Œä¼šæœ‰å¤šå¤§çš„ CPUçš„æ€§èƒ½å½±å“ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ä¸ªæŠ€æœ¯çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¼šé€‰ç”¨Redisï¼Œè¿˜æ˜¯ESï¼Œè¿˜æ˜¯æœ‰å…¶ä»–æ›´åˆç†çš„æ–¹æ¡ˆé€‰æ‹©å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":281312,"user_name":"å¿µ","can_delete":false,"product_type":"c1","uid":1113818,"ip_address":"","ucode":"866A800D49C498","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/da/01cfbdc6.jpg","comment_is_top":false,"comment_ctime":1614685620,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614685620","product_id":100056701,"comment_content":"geoèƒ½ç”¨åœ¨ç­¾åˆ°æ‰“å¡ä¸Šé¢å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":275370,"user_name":"æµ“èŒ¶æ°´","can_delete":false,"product_type":"c1","uid":1080521,"ip_address":"","ucode":"1821A4FCB7B408","user_header":"https://static001.geekbang.org/account/avatar/00/10/7c/c9/3db4187e.jpg","comment_is_top":false,"comment_ctime":1611493725,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611493725","product_id":100056701,"comment_content":"è€å¸ˆè®²çš„çœŸä¸é”™ï¼Œè°¢è°¢!","like_count":0},{"had_liked":false,"id":267877,"user_name":"Geek5198","can_delete":false,"product_type":"c1","uid":2028945,"ip_address":"","ucode":"2BEBE6A39D9A0E","user_header":"","comment_is_top":false,"comment_ctime":1607959930,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1607959930","product_id":100056701,"comment_content":"æˆ‘æƒ³é—®ä¸ªå®é™…åº”ç”¨ä¸­çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¦ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·æ¯å¤©ç™»å½•æ¬¡æ•°ï¼Œè¦æ±‚æŒ‰å°æ—¶ç»Ÿè®¡ï¼Œå°±æ˜¯è®°å½•24å°æ—¶å†…è¿™ä¸ªç”¨æˆ·æ¯å°æ—¶åˆ†åˆ«ç™»å½•å‡ æ¬¡ã€‚æ¯æ™š24ç‚¹ï¼Œå®šæ—¶ä»»åŠ¡ä¼šæ±‡æ€»æ¯ä¸ªç”¨æˆ·å½“å¤©çš„ç™»å½•ä¿¡æ¯å…¥åº“(æ¯ä¸ªç”¨æˆ·æ¯å¤©ä¸€æ¡æ•°æ®ï¼‰ï¼Œç”¨æˆ·é‡ä¹Ÿæ¯”è¾ƒå¤§ï¼Œè¯¥ç”¨ä»€ä¹ˆç»“æ„å¥½å‘¢ã€‚","like_count":0,"discussions":[{"author":{"id":1602239,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyobcyicicCQoldZofsS36xrjA2R2hk2F89pu1hCqwjlRaRG4xKkgCicZibEVdOwpfN5rWjEchrsxicSQ/132","nickname":"Geek_e8d55e","note":"","ucode":"5F13626B0E1E45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335134,"discussion_content":"æœ‰ä¸ªæœ€ç®€å•ç²—æš´çš„æƒ³æ³•ï¼Œå°±æ˜¯ï¼Œç”¨æˆ·id+å°æ—¶åšä¸ºkeyï¼Œç„¶åç™»å½•æ¬¡æ•°åšä¸ºvalueï¼Œè¿™æ ·æ¯ä¸ªç”¨æˆ·æ¯ä¸ªå°æ—¶çš„ç™»å½•æ¬¡æ•°å°±æœ‰äº†ï¼Œæ±‡æ€»å…¥åº“åï¼Œå†å°†redisä¸­æ•°æ®æ¸…ç©ºï¼Œè¿™æ ·ä¸ä¼šå½±å“ç¬¬äºŒå¤©çš„å†…å­˜ä½¿ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608102676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1006735,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5c/8f/551b5624.jpg","nickname":"å°å¯","note":"","ucode":"8834AF621FA67D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1602239,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKyobcyicicCQoldZofsS36xrjA2R2hk2F89pu1hCqwjlRaRG4xKkgCicZibEVdOwpfN5rWjEchrsxicSQ/132","nickname":"Geek_e8d55e","note":"","ucode":"5F13626B0E1E45","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347837,"discussion_content":"è¿™æ ·ç±»å‹æ˜¯stringï¼Œç”¨æˆ·é‡å¤§å¤ªå å†…å­˜äº†ï¼Œå‚è€ƒç¬¬11è®²ï¼Œä¸ªäººè§‰å¾—ç”¨hashç±»å‹ï¼Œhset ç”¨æˆ·ID å°æ—¶ æ¬¡æ•°ï¼Œå†å®šæ—¶ä»»åŠ¡å…¥åº“","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1612337876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335134,"ip_address":""},"score":347837,"extra":""}]}]},{"had_liked":false,"id":257819,"user_name":"R","can_delete":false,"product_type":"c1","uid":1087403,"ip_address":"","ucode":"DD268315F54DB2","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/ab/dc5a47f3.jpg","comment_is_top":false,"comment_ctime":1604140182,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1604140182","product_id":100056701,"comment_content":"è¶…çº§å¹²è´§","like_count":0},{"had_liked":false,"id":250148,"user_name":"ä¹±åŒ ","can_delete":false,"product_type":"c1","uid":1197941,"ip_address":"","ucode":"9FAC4E465C3582","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/75/4d59b6b5.jpg","comment_is_top":false,"comment_ctime":1600952125,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600952125","product_id":100056701,"comment_content":"https:&#47;&#47;github.com&#47;redis&#47;redis&#47;issues&#47;2758 å¯¹äºGEO å¯¹è±¡ï¼Œredis è‡³ä»Šæ²¡èƒ½ç»™å‡ºåŒºåŸŸå†…ç‚¹èšåˆçš„å®ç°ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿™ä¸ªéœ€æ±‚ï¼Œæ˜¯æ€ä¹ˆåšçš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":246647,"user_name":"ä¸œ","can_delete":false,"product_type":"c1","uid":1043947,"ip_address":"","ucode":"0FF5018422CEA9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/eb/88cac7a5.jpg","comment_is_top":false,"comment_ctime":1599445760,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1599445760","product_id":100056701,"comment_content":"&quot;æœ‰çš„ç¼–ç å€¼è™½ç„¶åœ¨å¤§å°ä¸Šæ¥è¿‘ï¼Œä½†å®é™…å¯¹åº”çš„æ–¹æ ¼å´è·ç¦»æ¯”è¾ƒè¿œã€‚æ‰€ä»¥ï¼Œä¸ºäº†é¿å…æŸ¥è¯¢ä¸å‡†ç¡®é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æŸ¥è¯¢ç»™å®šç»çº¬åº¦æ‰€åœ¨çš„æ–¹æ ¼å‘¨å›´çš„ 4 ä¸ªæˆ– 8 ä¸ªæ–¹æ ¼&quot;ã€‚ å¯æ˜¯è¿™4ä¸ªæˆ–8ä¸ªé‡Œè¿˜æ˜¯åŒ…å«äº†è¿™ä¸ªæœ‰é—®é¢˜çš„æ–¹æ ¼ï¼Œå®è·µä¸­å¦‚ä½•å‰”é™¤æ‰è¿™ä¸ªåçš„æ–¹æ ¼å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2107375,"avatar":"https://static001.geekbang.org/account/avatar/00/20/27/ef/a7f94eda.jpg","nickname":"Jerry You","note":"","ucode":"679A44B505482F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304139,"discussion_content":"æ€ä¹ˆè®¡ç®—å‘¨å›´çš„4ä¸ªï¼Œæˆ–8ä¸ªæ–¹æ ¼ï¼Œä»–ä»¬ä¹‹å‰å¤§å°æœ‰ä»€ä¹ˆè”ç³»ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599479013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246610,"user_name":"ç‹      æ…ˆ","can_delete":false,"product_type":"c1","uid":1298139,"ip_address":"","ucode":"EACC3D086674D8","user_header":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","comment_is_top":false,"comment_ctime":1599438462,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1599438462","product_id":100056701,"comment_content":"è€å¸ˆï¼Œè¿™ç§é€šè¿‡æ›´æ”¹æºç å®ç°è‡ªå®šä¹‰ç±»å‹å’ŒåŠŸèƒ½çš„æ–¹å¼ï¼Œæ¯”è¾ƒå¥½çš„å¤„ç†redisç‰ˆæœ¬æ›´æ–°çš„æ–¹æ³•æœ‰ä»€ä¹ˆå‘¢ï¼Ÿæ¯”å¦‚åœ¨v0.1ç¨³å®šç‰ˆä¸Šå®ç°äº†åŠŸèƒ½ï¼Œåç»­å‡ºç°v0.2ç¨³å®šç‰ˆäº†æ˜¯å¦å¯ä»¥å‡çº§å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310139,"discussion_content":"è‡ªå·±fork redisæºç å‡ºæ¥æ”¹ã€‚rediså®˜æ–¹æºç æœ‰ç‰ˆæœ¬å‡çº§çš„è¯ï¼Œä»rediså®˜æ–¹ä»£ç åº“é‡ŒæŠŠæºç mergeåˆ°è‡ªå·±forkå‡ºæ¥çš„ä»£ç åº“é‡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601641636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246381,"user_name":"MClink","can_delete":false,"product_type":"c1","uid":1435733,"ip_address":"","ucode":"F479190923355C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","comment_is_top":false,"comment_ctime":1599302821,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1599302821","product_id":100056701,"comment_content":"è€å¸ˆåé¢ä¼šå¸¦æˆ‘ä»¬å»çœ‹æºç å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":246246,"user_name":"å°è¢","can_delete":false,"product_type":"c1","uid":1811495,"ip_address":"","ucode":"3F5D8721F577D9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","comment_is_top":false,"comment_ctime":1599222036,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1599222036","product_id":100056701,"comment_content":"å•¥ç»çº¬åº¦çš„ä½ä¿¡æ¯è¦äº¤æ›¿å­˜å‚¨ï¼Œå¯ä»¥ä¸äº¤æ›¿å­˜å‚¨ä¹ˆï¼ŸåŸæ–‡åªè¯´äº†ç›¸é‚»ç¼–ç å¯èƒ½åœ¨æ˜¯ç›¸é‚»åœ°åŒºï¼Œä½†ä¸ç›¸é‚»ç¼–ç å¯ä»¥æ˜¯ç›¸é‚»åœ°åŒºå§ã€‚æ—¢ç„¶è¿™æ ·ï¼Œèƒ½å¦ç”¨ç®—æ³•ç›´æ¥ç®—å‡ºç›¸é‚»çš„å…«æ ¼çš„ç¼–ç å‘¢ï¼Œç„¶åç›´æ¥æ ¹æ®æƒé‡æŸ¥ã€‚<br>","like_count":0,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310140,"discussion_content":"äº¤æ›¿å­˜å‚¨çš„è¯ï¼Œ2è¿›åˆ¶ç¼–ç çš„æ•°å€¼å¤§å°å·®å€¼å’Œå®é™…ç»çº¬åº¦è·ç¦»æ˜¯æ­£ç›¸å…³çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601641762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2107618,"avatar":"https://static001.geekbang.org/account/avatar/00/20/28/e2/fbf76ae6.jpg","nickname":"è¿·è¿·å¾’","note":"","ucode":"5B65708B7E2DC1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303949,"discussion_content":"ä¸äº¤æ›¿å­˜å‚¨æ€ä¹ˆç²¾ç¡®äºŒä½ä¿¡æ¯ï¼Ÿï¼Ÿï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599413918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}