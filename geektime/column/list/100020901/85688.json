{"id":85688,"title":"48 | æ¡ˆä¾‹ç¯‡ï¼šæœåŠ¡å™¨æ€»æ˜¯æ—¶ä¸æ—¶ä¸¢åŒ…ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿï¼ˆä¸‹ï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†å¦‚ä½•åˆ†æç½‘ç»œä¸¢åŒ…çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ä»é“¾è·¯å±‚ã€ç½‘ç»œå±‚ä»¥åŠä¼ è¾“å±‚ç­‰ä¸»è¦çš„åè®®æ ˆä¸­è¿›è¡Œåˆ†æã€‚</p><p>ä¸è¿‡ï¼Œé€šè¿‡å‰é¢è¿™å‡ å±‚çš„åˆ†æï¼Œæˆ‘ä»¬è¿˜æ˜¯æ²¡æœ‰æ‰¾å‡ºæœ€ç»ˆçš„æ€§èƒ½ç“¶é¢ˆã€‚çœ‹æ¥ï¼Œè¿˜æ˜¯è¦ç»§ç»­æ·±æŒ–æ‰å¯ä»¥ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥ç»§ç»­åˆ†æè¿™ä¸ªæœªæœçš„æ¡ˆä¾‹ã€‚</p><p>åœ¨å¼€å§‹ä¸‹é¢çš„å†…å®¹å‰ï¼Œä½ å¯ä»¥å…ˆå›å¿†ä¸€ä¸‹ä¸ŠèŠ‚è¯¾çš„å†…å®¹ï¼Œå¹¶ä¸”è‡ªå·±åŠ¨è„‘æƒ³ä¸€æƒ³ï¼Œé™¤äº†æˆ‘ä»¬æåˆ°çš„é“¾è·¯å±‚ã€ç½‘ç»œå±‚ä»¥åŠä¼ è¾“å±‚ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ½œåœ¨é—®é¢˜å¯èƒ½ä¼šå¯¼è‡´ä¸¢åŒ…å‘¢ï¼Ÿ</p><h3>iptables</h3><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œé™¤äº†ç½‘ç»œå±‚å’Œä¼ è¾“å±‚çš„å„ç§åè®®ï¼Œiptables å’Œå†…æ ¸çš„è¿æ¥è·Ÿè¸ªæœºåˆ¶ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´ä¸¢åŒ…ã€‚æ‰€ä»¥ï¼Œè¿™ä¹Ÿæ˜¯å‘ç”Ÿä¸¢åŒ…é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ’æŸ¥çš„ä¸€ä¸ªå› ç´ ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿æ¥è·Ÿè¸ªï¼Œæˆ‘å·²ç»åœ¨ <a href=\"https://time.geekbang.org/column/article/83189\">å¦‚ä½•ä¼˜åŒ–NATæ€§èƒ½</a>  æ–‡ç« ä¸­ï¼Œç»™ä½ è®²è¿‡è¿æ¥è·Ÿè¸ªçš„ä¼˜åŒ–æ€è·¯ã€‚è¦ç¡®è®¤æ˜¯ä¸æ˜¯è¿æ¥è·Ÿè¸ªå¯¼è‡´çš„é—®é¢˜ï¼Œå…¶å®åªéœ€è¦å¯¹æ¯”å½“å‰çš„è¿æ¥è·Ÿè¸ªæ•°å’Œæœ€å¤§è¿æ¥è·Ÿè¸ªæ•°å³å¯ã€‚</p><p>ä¸è¿‡ï¼Œç”±äºè¿æ¥è·Ÿè¸ªåœ¨ Linux å†…æ ¸ä¸­æ˜¯å…¨å±€çš„ï¼ˆä¸å±äºç½‘ç»œå‘½åç©ºé—´ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦é€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œå›åˆ°ä¸»æœºä¸­æ¥æŸ¥çœ‹ã€‚</p><p>ä½ å¯ä»¥åœ¨å®¹å™¨ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œ exit ï¼›ç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹è¿æ¥è·Ÿè¸ªæ•°ï¼š</p><pre><code># å®¹å™¨ç»ˆç«¯ä¸­æ‰§è¡Œexit\nroot@nginx:/# exit\nexit\n\n# ä¸»æœºç»ˆç«¯ä¸­æŸ¥è¯¢å†…æ ¸é…ç½®\n$ sysctl net.netfilter.nf_conntrack_max\nnet.netfilter.nf_conntrack_max = 262144\n$ sysctl net.netfilter.nf_conntrack_count\nnet.netfilter.nf_conntrack_count = 182\n</code></pre><p>ä»è¿™å„¿ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿æ¥è·Ÿè¸ªæ•°åªæœ‰ 182ï¼Œè€Œæœ€å¤§è¿æ¥è·Ÿè¸ªæ•°åˆ™æ˜¯ 262144ã€‚æ˜¾ç„¶ï¼Œè¿™é‡Œçš„ä¸¢åŒ…ï¼Œä¸å¯èƒ½æ˜¯è¿æ¥è·Ÿè¸ªå¯¼è‡´çš„ã€‚</p><!-- [[[read_end]]] --><p>æ¥ç€ï¼Œå†æ¥çœ‹ iptablesã€‚å›é¡¾ä¸€ä¸‹ iptables çš„åŸç†ï¼Œå®ƒåŸºäº Netfilter æ¡†æ¶ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„è§„åˆ™ï¼Œå¯¹ç½‘ç»œæ•°æ®åŒ…è¿›è¡Œè¿‡æ»¤ï¼ˆå¦‚é˜²ç«å¢™ï¼‰å’Œä¿®æ”¹ï¼ˆå¦‚ NATï¼‰ã€‚</p><p>è¿™äº› iptables è§„åˆ™ï¼Œç»Ÿä¸€ç®¡ç†åœ¨ä¸€ç³»åˆ—çš„è¡¨ä¸­ï¼ŒåŒ…æ‹¬ filterï¼ˆç”¨äºè¿‡æ»¤ï¼‰ã€natï¼ˆç”¨äºNATï¼‰ã€mangleï¼ˆç”¨äºä¿®æ”¹åˆ†ç»„æ•°æ®ï¼‰ å’Œ rawï¼ˆç”¨äºåŸå§‹æ•°æ®åŒ…ï¼‰ç­‰ã€‚è€Œæ¯å¼ è¡¨åˆå¯ä»¥åŒ…æ‹¬ä¸€ç³»åˆ—çš„é“¾ï¼Œç”¨äºå¯¹ iptables è§„åˆ™è¿›è¡Œåˆ†ç»„ç®¡ç†ã€‚</p><p>å¯¹äºä¸¢åŒ…é—®é¢˜æ¥è¯´ï¼Œæœ€å¤§çš„å¯èƒ½å°±æ˜¯è¢« filter è¡¨ä¸­çš„è§„åˆ™ç»™ä¸¢å¼ƒäº†ã€‚è¦å¼„æ¸…æ¥šè¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦æˆ‘ä»¬ç¡®è®¤ï¼Œé‚£äº›ç›®æ ‡ä¸º DROP å’Œ REJECT ç­‰ä¼šå¼ƒåŒ…çš„è§„åˆ™ï¼Œæœ‰æ²¡æœ‰è¢«æ‰§è¡Œåˆ°ã€‚</p><p>ä½ å¯ä»¥æŠŠæ‰€æœ‰çš„ iptables è§„åˆ™åˆ—å‡ºæ¥ï¼Œæ ¹æ®æ”¶å‘åŒ…çš„ç‰¹ç‚¹ï¼Œè·Ÿ iptables è§„åˆ™è¿›è¡ŒåŒ¹é…ã€‚ä¸è¿‡æ˜¾ç„¶ï¼Œå¦‚æœ iptables è§„åˆ™æ¯”è¾ƒå¤šï¼Œè¿™æ ·åšçš„æ•ˆç‡å°±ä¼šå¾ˆä½ã€‚</p><p>å½“ç„¶ï¼Œæ›´ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥æŸ¥è¯¢ DROP å’Œ REJECT ç­‰è§„åˆ™çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œçœ‹çœ‹æ˜¯å¦ä¸º 0ã€‚å¦‚æœç»Ÿè®¡å€¼ä¸æ˜¯ 0 ï¼Œå†æŠŠç›¸å…³çš„è§„åˆ™æ‹å‡ºæ¥è¿›è¡Œåˆ†æã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ iptables -nvL å‘½ä»¤ï¼ŒæŸ¥çœ‹å„æ¡è§„åˆ™çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„ docker exec å‘½ä»¤ï¼Œè¿›å…¥å®¹å™¨ç»ˆç«¯ï¼›ç„¶åå†æ‰§è¡Œä¸‹é¢çš„ iptables å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ° filter è¡¨çš„ç»Ÿè®¡æ•°æ®äº†ï¼š</p><pre><code># åœ¨ä¸»æœºä¸­æ‰§è¡Œ\n$ docker exec -it nginx bash\n\n# åœ¨å®¹å™¨ä¸­æ‰§è¡Œ\nroot@nginx:/# iptables -t filter -nvL\nChain INPUT (policy ACCEPT 25 packets, 1000 bytes)\n pkts bytes target     prot opt in     out     source               destination\n    6   240 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            statistic mode random probability 0.29999999981\n\nChain FORWARD (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n\nChain OUTPUT (policy ACCEPT 15 packets, 660 bytes)\n pkts bytes target     prot opt in     out     source               destination\n    6   264 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0            statistic mode random probability 0.29999999981\n</code></pre><p>ä» iptables çš„è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œä¸¤æ¡ DROP è§„åˆ™çš„ç»Ÿè®¡æ•°å€¼ä¸æ˜¯ 0ï¼Œå®ƒä»¬åˆ†åˆ«åœ¨ INPUT å’Œ OUTPUT é“¾ä¸­ã€‚è¿™ä¸¤æ¡è§„åˆ™å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ statistic æ¨¡å—ï¼Œè¿›è¡Œéšæœº 30% çš„ä¸¢åŒ…ã€‚</p><p>å†è§‚å¯Ÿä¸€ä¸‹å®ƒä»¬çš„åŒ¹é…è§„åˆ™ã€‚0.0.0.0/0 è¡¨ç¤ºåŒ¹é…æ‰€æœ‰çš„æº IP å’Œç›®çš„ IPï¼Œä¹Ÿå°±æ˜¯ä¼šå¯¹æ‰€æœ‰åŒ…éƒ½è¿›è¡Œéšæœº 30% çš„ä¸¢åŒ…ã€‚çœ‹èµ·æ¥ï¼Œè¿™åº”è¯¥å°±æ˜¯å¯¼è‡´éƒ¨åˆ†ä¸¢åŒ…çš„â€œç½ªé­ç¥¸é¦–â€äº†ã€‚</p><p>æ—¢ç„¶æ‰¾å‡ºäº†åŸå› ï¼Œæ¥ä¸‹æ¥çš„ä¼˜åŒ–å°±æ¯”è¾ƒç®€å•äº†ã€‚æ¯”å¦‚ï¼ŒæŠŠè¿™ä¸¤æ¡è§„åˆ™ç›´æ¥åˆ é™¤å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ä¸¤æ¡ iptables å‘½ä»¤ï¼Œåˆ é™¤è¿™ä¸¤æ¡ DROP è§„åˆ™ï¼š</p><pre><code>root@nginx:/# iptables -t filter -D INPUT -m statistic --mode random --probability 0.30 -j DROP\nroot@nginx:/# iptables -t filter -D OUTPUT -m statistic --mode random --probability 0.30 -j DROP\n</code></pre><p>åˆ é™¤åï¼Œé—®é¢˜æ˜¯å¦å°±è¢«è§£å†³äº†å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°ç»ˆç«¯äºŒä¸­ï¼Œé‡æ–°æ‰§è¡Œåˆšæ‰çš„ hping3 å‘½ä»¤ï¼Œçœ‹çœ‹ç°åœ¨æ˜¯å¦æ­£å¸¸ï¼š</p><pre><code>$ hping3 -c 10 -S -p 80 192.168.0.30\nHPING 192.168.0.30 (eth0 192.168.0.30): S set, 40 headers + 0 data bytes\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=0 win=5120 rtt=11.9 ms\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=1 win=5120 rtt=7.8 ms\n...\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=9 win=5120 rtt=15.0 ms\n\n--- 192.168.0.30 hping statistic ---\n10 packets transmitted, 10 packets received, 0% packet loss\nround-trip min/avg/max = 3.3/7.9/15.0 ms\n</code></pre><p>è¿™æ¬¡è¾“å‡ºä½ å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨å·²ç»æ²¡æœ‰ä¸¢åŒ…äº†ï¼Œå¹¶ä¸”å»¶è¿Ÿçš„æ³¢åŠ¨å˜åŒ–ä¹Ÿå¾ˆå°ã€‚çœ‹æ¥ï¼Œä¸¢åŒ…é—®é¢˜åº”è¯¥å·²ç»è§£å†³äº†ã€‚</p><p>ä¸è¿‡ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨çš„ hping3 å·¥å…·ï¼Œåªèƒ½éªŒè¯æ¡ˆä¾‹ Nginx çš„ 80 ç«¯å£å¤„äºæ­£å¸¸ç›‘å¬çŠ¶æ€ï¼Œå´è¿˜æ²¡æœ‰è®¿é—® Nginx çš„ HTTP æœåŠ¡ã€‚æ‰€ä»¥ï¼Œä¸è¦åŒ†å¿™ä¸‹ç»“è®ºç»“æŸè¿™æ¬¡ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›ä¸€æ­¥ç¡®è®¤ï¼ŒNginx èƒ½ä¸èƒ½æ­£å¸¸å“åº” HTTP è¯·æ±‚ã€‚</p><p>æˆ‘ä»¬ç»§ç»­åœ¨ç»ˆç«¯äºŒä¸­ï¼Œæ‰§è¡Œå¦‚ä¸‹çš„ curl å‘½ä»¤ï¼Œæ£€æŸ¥ Nginx å¯¹ HTTP è¯·æ±‚çš„å“åº”ï¼š</p><pre><code>$ curl --max-time 3 http://192.168.0.30\ncurl: (28) Operation timed out after 3000 milliseconds with 0 bytes received\n</code></pre><p>ä» curl çš„è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥å‘ç°ï¼Œè¿™æ¬¡è¿æ¥è¶…æ—¶äº†ã€‚å¯æ˜¯ï¼Œåˆšæ‰æˆ‘ä»¬æ˜æ˜ç”¨ hping3 éªŒè¯äº†ç«¯å£æ­£å¸¸ï¼Œç°åœ¨å´å‘ç° HTTP è¿æ¥è¶…æ—¶ï¼Œæ˜¯ä¸æ˜¯å› ä¸º Nginx çªç„¶å¼‚å¸¸é€€å‡ºäº†å‘¢ï¼Ÿ</p><p>ä¸å¦¨å†æ¬¡è¿è¡Œ hping3 æ¥ç¡®è®¤ä¸€ä¸‹ï¼š</p><pre><code>$ hping3 -c 3 -S -p 80 192.168.0.30\nHPING 192.168.0.30 (eth0 192.168.0.30): S set, 40 headers + 0 data bytes\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=0 win=5120 rtt=7.8 ms\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=1 win=5120 rtt=7.7 ms\nlen=44 ip=192.168.0.30 ttl=63 DF id=0 sport=80 flags=SA seq=2 win=5120 rtt=3.6 ms\n\n--- 192.168.0.30 hping statistic ---\n3 packets transmitted, 3 packets received, 0% packet loss\nround-trip min/avg/max = 3.6/6.4/7.8 ms\n</code></pre><p>å¥‡æ€ªï¼Œhping3 çš„ç»“æœæ˜¾ç¤ºï¼ŒNginx çš„ 80 ç«¯å£ç¡®ç¡®å®å®è¿˜æ˜¯æ­£å¸¸çŠ¶æ€ã€‚è¿™è¯¥å¦‚ä½•æ˜¯å¥½å‘¢ï¼Ÿåˆ«å¿˜äº†ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸ªå¤§æ€å™¨â€”â€”æŠ“åŒ…æ“ä½œã€‚çœ‹æ¥æœ‰å¿…è¦æŠ“åŒ…çœ‹çœ‹äº†ã€‚</p><h3>tcpdump</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ‡æ¢å›ç»ˆç«¯ä¸€ï¼Œåœ¨å®¹å™¨ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ tcpdump å‘½ä»¤ï¼ŒæŠ“å– 80 ç«¯å£çš„åŒ…ï¼š</p><pre><code>root@nginx:/# tcpdump -i eth0 -nn port 80\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes\n</code></pre><p>ç„¶åï¼Œåˆ‡æ¢åˆ°ç»ˆç«¯äºŒä¸­ï¼Œå†æ¬¡æ‰§è¡Œå‰é¢çš„ curl å‘½ä»¤ï¼š</p><pre><code>$ curl --max-time 3 http://192.168.0.30/\ncurl: (28) Operation timed out after 3000 milliseconds with 0 bytes received\n</code></pre><p>ç­‰åˆ°curl å‘½ä»¤ç»“æŸåï¼Œå†æ¬¡åˆ‡æ¢å›ç»ˆç«¯ä¸€ï¼ŒæŸ¥çœ‹ tcpdump çš„è¾“å‡ºï¼š</p><pre><code>14:40:00.589235 IP 10.255.255.5.39058 &gt; 172.17.0.2.80: Flags [S], seq 332257715, win 29200, options [mss 1418,sackOK,TS val 486800541 ecr 0,nop,wscale 7], length 0\n14:40:00.589277 IP 172.17.0.2.80 &gt; 10.255.255.5.39058: Flags [S.], seq 1630206251, ack 332257716, win 4880, options [mss 256,sackOK,TS val 2509376001 ecr 486800541,nop,wscale 7], length 0\n14:40:00.589894 IP 10.255.255.5.39058 &gt; 172.17.0.2.80: Flags [.], ack 1, win 229, options [nop,nop,TS val 486800541 ecr 2509376001], length 0\n14:40:03.589352 IP 10.255.255.5.39058 &gt; 172.17.0.2.80: Flags [F.], seq 76, ack 1, win 229, options [nop,nop,TS val 486803541 ecr 2509376001], length 0\n14:40:03.589417 IP 172.17.0.2.80 &gt; 10.255.255.5.39058: Flags [.], ack 1, win 40, options [nop,nop,TS val 2509379001 ecr 486800541,nop,nop,sack 1 {76:77}], length 0\n</code></pre><p>ç»è¿‡è¿™ä¹ˆä¸€ç³»åˆ—çš„æ“ä½œï¼Œä» tcpdump çš„è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼š</p><ul>\n<li>\n<p>å‰ä¸‰ä¸ªåŒ…æ˜¯æ­£å¸¸çš„ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™æ²¡é—®é¢˜ï¼›</p>\n</li>\n<li>\n<p>ä½†ç¬¬å››ä¸ªåŒ…å´æ˜¯åœ¨ 3 ç§’ä»¥åäº†ï¼Œå¹¶ä¸”è¿˜æ˜¯å®¢æˆ·ç«¯ï¼ˆVM2ï¼‰å‘é€è¿‡æ¥çš„ FIN åŒ…ï¼Œä¹Ÿå°±è¯´æ˜ï¼Œå®¢æˆ·ç«¯çš„è¿æ¥å…³é—­äº†ã€‚</p>\n</li>\n</ul><p>æˆ‘æƒ³ï¼Œæ ¹æ® curl è®¾ç½®çš„ 3 ç§’è¶…æ—¶é€‰é¡¹ï¼Œä½ åº”è¯¥èƒ½çŒœåˆ°ï¼Œè¿™æ˜¯å› ä¸º curl å‘½ä»¤è¶…æ—¶åé€€å‡ºäº†ã€‚</p><p>æˆ‘æŠŠè¿™ä¸€è¿‡ç¨‹ï¼Œç”¨ TCP äº¤äº’çš„æµç¨‹å›¾ï¼ˆå®é™…ä¸Šæ¥è‡ª Wireshark çš„ Flow Graphï¼‰æ¥è¡¨ç¤ºï¼Œä½ å¯ä»¥æ›´æ¸…æ¥šåœ°çœ‹åˆ°ä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a8/c2/a81bd7639a1f81c23bc6d2e030af97c2.png?wh=1314*364\" alt=\"\"><br>\nè¿™é‡Œæ¯”è¾ƒå¥‡æ€ªçš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æŠ“å–åˆ° curl å‘æ¥çš„ HTTP GET è¯·æ±‚ã€‚é‚£ä¹ˆï¼Œç©¶ç«Ÿæ˜¯ç½‘å¡ä¸¢åŒ…äº†ï¼Œè¿˜æ˜¯å®¢æˆ·ç«¯å‹æ ¹å„¿å°±æ²¡å‘è¿‡æ¥å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥é‡æ–°æ‰§è¡Œ netstat -i å‘½ä»¤ï¼Œç¡®è®¤ä¸€ä¸‹ç½‘å¡æœ‰æ²¡æœ‰ä¸¢åŒ…é—®é¢˜ï¼š</p><pre><code>root@nginx:/# netstat -i\nKernel Interface table\nIface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg\neth0       100      157      0    344 0            94      0      0      0 BMRU\nlo       65536        0      0      0 0             0      0      0      0 LRU\n</code></pre><p>ä» netstat çš„è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œæ¥æ”¶ä¸¢åŒ…æ•°ï¼ˆRX-DRPï¼‰æ˜¯ 344ï¼Œæœç„¶æ˜¯åœ¨ç½‘å¡æ¥æ”¶æ—¶ä¸¢åŒ…äº†ã€‚ä¸è¿‡é—®é¢˜ä¹Ÿæ¥äº†ï¼Œä¸ºä»€ä¹ˆåˆšæ‰ç”¨ hping3 æ—¶ä¸ä¸¢åŒ…ï¼Œç°åœ¨æ¢æˆ GET å°±æ”¶ä¸åˆ°äº†å‘¢ï¼Ÿ</p><p>è¿˜æ˜¯é‚£å¥è¯ï¼Œé‡åˆ°æä¸æ‡‚çš„ç°è±¡ï¼Œä¸å¦¨å…ˆå»æŸ¥æŸ¥å·¥å…·å’Œæ–¹æ³•çš„åŸç†ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤ä¸ªå·¥å…·ï¼š</p><ul>\n<li>\n<p>hping3 å®é™…ä¸Šåªå‘é€äº† SYN åŒ…ï¼›</p>\n</li>\n<li>\n<p>è€Œ curl åœ¨å‘é€ SYN åŒ…åï¼Œè¿˜ä¼šå‘é€ HTTP GET è¯·æ±‚ã€‚</p>\n</li>\n</ul><p>HTTP GET ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª TCP åŒ…ï¼Œä½†è·Ÿ SYN åŒ…ç›¸æ¯”ï¼Œå®ƒè¿˜æºå¸¦äº† HTTP GET çš„æ•°æ®ã€‚</p><p>é‚£ä¹ˆï¼Œé€šè¿‡è¿™ä¸ªå¯¹æ¯”ï¼Œä½ åº”è¯¥æƒ³åˆ°äº†ï¼Œè¿™å¯èƒ½æ˜¯ MTU é…ç½®é”™è¯¯å¯¼è‡´çš„ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å…¶å®ï¼Œä»”ç»†è§‚å¯Ÿä¸Šé¢ netstat çš„è¾“å‡ºç•Œé¢ï¼Œç¬¬äºŒåˆ—æ­£æ˜¯æ¯ä¸ªç½‘å¡çš„ MTU å€¼ã€‚eth0 çš„ MTU åªæœ‰ 100ï¼Œè€Œä»¥å¤ªç½‘çš„ MTU é»˜è®¤å€¼æ˜¯ 1500ï¼Œè¿™ä¸ª100 å°±æ˜¾å¾—å¤ªå°äº†ã€‚</p><p>å½“ç„¶ï¼ŒMTU é—®é¢˜æ˜¯å¾ˆå¥½è§£å†³çš„ï¼ŒæŠŠå®ƒæ”¹æˆ 1500 å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬ç»§ç»­åœ¨å®¹å™¨ç»ˆç«¯ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŠŠå®¹å™¨ eth0 çš„ MTU æ”¹æˆ 1500ï¼š</p><pre><code>root@nginx:/# ifconfig eth0 mtu 1500\n</code></pre><p>ä¿®æ”¹å®Œæˆåï¼Œå†åˆ‡æ¢åˆ°ç»ˆç«¯äºŒä¸­ï¼Œå†æ¬¡æ‰§è¡Œ curl å‘½ä»¤ï¼Œç¡®è®¤é—®é¢˜æ˜¯å¦çœŸçš„è§£å†³äº†ï¼š</p><pre><code>$ curl --max-time 3 http://192.168.0.30/\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n...\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>éå¸¸ä¸å®¹æ˜“å‘€ï¼Œè¿™æ¬¡ç»ˆäºçœ‹åˆ°äº†ç†Ÿæ‚‰çš„ Nginx å“åº”ï¼Œè¯´æ˜ä¸¢åŒ…çš„é—®é¢˜ç»ˆäºå½»åº•è§£å†³äº†ã€‚</p><p>å½“ç„¶ï¼Œæ¡ˆä¾‹ç»“æŸå‰ï¼Œä¸è¦å¿˜è®°åœæ­¢ä»Šå¤©çš„ Nginx åº”ç”¨ã€‚ä½ å¯ä»¥åˆ‡æ¢å›ç»ˆç«¯ä¸€ï¼Œåœ¨å®¹å™¨ç»ˆç«¯ä¸­æ‰§è¡Œ exit å‘½ä»¤ï¼Œé€€å‡ºå®¹å™¨ç»ˆç«¯ï¼š</p><pre><code>root@nginx:/# exit\nexit\n</code></pre><p>æœ€åï¼Œå†æ‰§è¡Œä¸‹é¢çš„ docker å‘½ä»¤ï¼Œåœæ­¢å¹¶åˆ é™¤ Nginx å®¹å™¨ï¼š</p><pre><code>$ docker rm -f nginx\n</code></pre><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘ç»§ç»­å¸¦ä½ åˆ†æäº†ç½‘ç»œä¸¢åŒ…çš„é—®é¢˜ã€‚ç‰¹åˆ«æ˜¯åœ¨æ—¶ä¸æ—¶ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œå®šä½å’Œä¼˜åŒ–éƒ½éœ€è¦æˆ‘ä»¬èŠ±å¿ƒæ€é‡ç‚¹æŠ•å…¥ã€‚</p><p>ç½‘ç»œä¸¢åŒ…é—®é¢˜çš„ä¸¥é‡æ€§ä¸è¨€è€Œå–»ã€‚ç¢°åˆ°ä¸¢åŒ…é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦ä» Linux ç½‘ç»œæ”¶å‘çš„æµç¨‹å…¥æ‰‹ï¼Œç»“åˆ TCP/IP åè®®æ ˆçš„åŸç†æ¥é€å±‚åˆ†æã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œæˆ‘æƒ³é‚€è¯·ä½ ä¸€èµ·æ¥èŠèŠï¼Œä½ ç¢°åˆ°è¿‡çš„ç½‘ç»œä¸¢åŒ…é—®é¢˜ã€‚ä½ æ˜¯æ€ä¹ˆåˆ†æå®ƒä»¬çš„æ ¹æºï¼Ÿåˆæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿä½ å¯ä»¥ç»“åˆæˆ‘çš„è®²è§£ï¼Œæ€»ç»“è‡ªå·±çš„æ€è·¯ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","comments":[{"had_liked":false,"id":76513,"user_name":"æ€€ç‰¹","can_delete":false,"product_type":"c1","uid":1072331,"ip_address":"","ucode":"3DACB205798ED3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5c/cb/3ebdcc49.jpg","comment_is_top":false,"comment_ctime":1552621954,"is_pvip":true,"replies":[{"id":"28061","content":"ä¹Ÿå¯ä»¥è®¾ç½®ä¸å…è®¸æ‹†åŒ…","user_name":"ä½œè€…å›å¤","comment_id":76513,"uid":"1001282","ip_address":"","utype":1,"ctime":1552750786,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"74567065986","product_id":100020901,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ä¸æ˜ç™½ï¼šIPåŒ…ä¸æ˜¯å¯ä»¥æ ¹æ®ç½‘ç»œè‡ªåŠ¨ç»„åˆå’Œæ‹†åˆ†çš„å—ï¼Ÿä¸ºä»€ä¹ˆä¼šç›´æ¥ä¸¢å¼ƒå‘¢ï¼Ÿ","like_count":18,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443335,"discussion_content":"ä¹Ÿå¯ä»¥è®¾ç½®ä¸å…è®¸æ‹†åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552750786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76630,"user_name":"ä½³","can_delete":false,"product_type":"c1","uid":1334190,"ip_address":"","ucode":"482C90C3DC17DB","user_header":"https://static001.geekbang.org/account/avatar/00/14/5b/ae/3d639ea4.jpg","comment_is_top":false,"comment_ctime":1552650098,"is_pvip":false,"replies":[{"id":"28063","content":"ğŸ‘è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":76630,"uid":"1001282","ip_address":"","utype":1,"ctime":1552750876,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"61682192242","product_id":100020901,"comment_content":"æˆ‘åœ¨ç”¨k8sä¸­è¿‡netfilterçš„æ‹›ã€‚é€šè¿‡service clusterè®¿é—®podï¼Œå‘ç°åŒ…åˆ°äº†podã€‚è¢«ä¸¢å¼ƒäº†ï¼Œtcpè¶…æ—¶ã€‚æŠ“åŒ…å‘ç°ç›®çš„åœ°å€æ²¡æœ‰ä¿®æ”¹ä¸ºpod ip.å®‰è£…è„šæœ¬æ²¡æœ‰é…ç½®centoså¼€æœºåŠ è½½netfilteré©±åŠ¨","like_count":15,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443384,"discussion_content":"ğŸ‘è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552750876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2982173,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/nN4uel4ia1n8oQW2LryIKT5B5w2kEBQz818IPsBwRoFfib0f24ks36r4jVBp4sXvoelYPe08MxhicDXeOy1N1EN2w/132","nickname":"Geek_e63d9e","note":"","ucode":"6B148801B2A100","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574682,"discussion_content":"è¿˜èƒ½æœ‰è¿™ç§æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654241678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85392,"user_name":"å¤§åç‹ç‹¸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1555051273,"is_pvip":false,"replies":[{"id":"30627","content":"ğŸ˜Š","user_name":"ä½œè€…å›å¤","comment_id":85392,"uid":"1001282","ip_address":"","utype":1,"ctime":1555074349,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"44504724233","product_id":100020901,"comment_content":"å­¦åˆ°è¿™ï¼Œçªç„¶æœ‰ç§è¿™ä¸ªè®¢é˜…æ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯ä¸­åšçš„ä¸€ä»¶å¾ˆæ­£ç¡®çš„äº‹æƒ…äº†çš„æ„Ÿè§‰ã€‚","like_count":11,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446655,"discussion_content":"ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555074349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76431,"user_name":"kissingers","can_delete":false,"product_type":"c1","uid":1135299,"ip_address":"","ucode":"615151808CF628","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKzqiaZnBw2myRWY802u48Rw3W2zDtKoFQ6vN63m4FdyjibM21FfaOYe8MbMpemUdxXJeQH6fRdVbZA/132","comment_is_top":false,"comment_ctime":1552611284,"is_pvip":false,"replies":[{"id":"28164","content":"åˆ†ç‰‡å¸¦æ¥çš„æˆæœ¬è¿˜æ˜¯è›®é«˜çš„","user_name":"ä½œè€…å›å¤","comment_id":76431,"uid":"1001282","ip_address":"","utype":1,"ctime":1552904248,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"44502284244","product_id":100020901,"comment_content":"è¿˜æœ‰ä¼ è¾“è®¾å¤‡å¼•å…¥çš„ä¸¢åŒ…ï¼Œæ¯”å¦‚æ¥å£æ¨¡å¼ä¸åŒ¹é…ï¼Œç‰©ç†æ¥å£æˆ–çº¿ç¼†ï¼Œå¹¿æ’­é£æš´å¤§æµé‡ç­‰ã€‚å¦å¤–æ¡ˆä¾‹è¿™é‡Œå¦‚æœget åŒ…å…è®¸åˆ†ç‰‡é‚£å°±ä¸ä¼šä¸¢åŒ…å§ï¼Ÿåªæ˜¯ä¼ è¾“æ•ˆç‡ä½ã€‚é‚£ä¹ˆæ—¢ç„¶å…è®¸åˆ†ç‰‡å¯ä»¥è§„é¿ä¸­é—´é“¾è·¯mtu è¿‡å°å¼•èµ·çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆå¾ˆå¤šåº”ç”¨é»˜è®¤å°±æ˜¯ä¸å…è®¸åˆ†ç‰‡å‘¢ï¼Ÿè°¢è°¢","like_count":11,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443305,"discussion_content":"åˆ†ç‰‡å¸¦æ¥çš„æˆæœ¬è¿˜æ˜¯è›®é«˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552904248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2291160,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg","nickname":"Woa ğŸ¤","note":"","ucode":"6033F496082F3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553676,"discussion_content":"æœ‰ä¸€ç§æ”»å‡»æ–¹æ³•å°±æ˜¯åŸºäºåˆ†ç‰‡çš„ã€‚æƒ³æƒ³ç»™ä½ åˆ†ç‰‡å‘äº†ä¸€ä¸ªè¶…çº§å¤§çš„åŒ…ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªè¿Ÿè¿Ÿä¸é€è¿‡æ¥ï¼Œé‚£å²‚ä¸æ˜¯å ç”¨äº†è‡ªå·±å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œç”¨ä¸äº†å‡ å›å°±æº¢å‡ºæ¥äº†ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646025268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76414,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1552607925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35912346293","product_id":100020901,"comment_content":"æ‰“å¡day51<br>çŸ¥è¯†æ²¡æœ‰èä¼šè´¯é€šï¼Œæˆ‘èƒ½æƒ³åˆ°iptablesçš„é—®é¢˜ï¼Œä¹Ÿèƒ½æƒ³åˆ°æŠ“åŒ…åˆ†æï¼Œä½†æ˜¯åé¢å®šä½åˆ°mtuçš„é—®é¢˜ï¼Œæˆ‘ä¼°è®¡åªèƒ½å‡­çµæ„Ÿäº†ï¼Œæ€ç»´ä¸èƒ½é©¬ä¸Šè·Ÿè¿™ä¸ªäº§ç”Ÿå…³è”","like_count":9},{"had_liked":false,"id":129155,"user_name":"éº¦å°æ—­","can_delete":false,"product_type":"c1","uid":1346575,"ip_address":"","ucode":"FDC132B4CDA0DB","user_header":"https://static001.geekbang.org/account/avatar/00/14/8c/0f/7516306e.jpg","comment_is_top":false,"comment_ctime":1567051092,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31631822164","product_id":100020901,"comment_content":"è€å¸ˆå…³äºmtu100çš„é—®é¢˜ï¼Œæˆ‘æƒ³é—®ä¸‹åœ¨ä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™ä¸æ˜¯ä¼šåå•†mtuçª—å£çš„å¤§å°å—ï¼Œå®¹å™¨çš„mtuæ˜æ˜æ˜¯100ä¸ºä»€ä¹ˆå®¹å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„ackåŒ…çš„msså€¼æ˜¯256ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1476507,"avatar":"https://static001.geekbang.org/account/avatar/00/16/87/9b/8bebc8b6.jpg","nickname":"Marshall","note":"","ucode":"0FB004E8163F44","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341362,"discussion_content":"mtuæ˜¯ipå±‚çš„æ¦‚å¿µï¼Œä½ è¯´çš„åº”è¯¥æ˜¯mssï¼Œä½†æ˜¯æ•°æ®åˆ°ipå±‚å°±æŒ‰ç…§mtuå¤§å°æ‹†åŒ…å‘é€ï¼Œå‘é€è¿‡ç¨‹ä¸­å¦‚æœå‘ç°å…¶ä»–ç½‘ç»œè®¾å¤‡mtuå° å¯ä»¥è¿›è¡Œåˆ†ç»„ä¼ é€’","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610410419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271384,"user_name":"Spoon","can_delete":false,"product_type":"c1","uid":1959822,"ip_address":"","ucode":"2FF9193AD482C2","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","comment_is_top":false,"comment_ctime":1609589571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10199524163","product_id":100020901,"comment_content":"ç”¨tcpdumpæŠ“åŒ…å‘ç°<br>1.åªæœ‰lengthï¼ˆtcpdumpè¾“å‡ºï¼Œè¡¨ç¤ºTCP playloadå€¼ä¸º0ï¼‰ä¸º0çš„tcpåŒ…æ‰èƒ½è¢«èµ°åˆ°tcpåè®®å±‚ï¼ŒIPå¤´20å­—èŠ‚ï¼ŒTCPå¤´40å­—èŠ‚åŠ èµ·æ¥å°±60å­—èŠ‚äº†<br>2.åœ¨clientç«¯æŠ“åŒ…å‘ç°tcp playloadä¸º76å­—èŠ‚ï¼ŒåŠ ä¸ŠIPå’ŒTCPå¤´è‚¯å®šæ˜¯è¶…è¿‡100å­—èŠ‚çš„MTU<br>3.å¯ä»¥åšä¸ªè¯•éªŒå°†MTUè®¾ç½®ä¸º137å­—èŠ‚","like_count":3},{"had_liked":false,"id":106095,"user_name":"ç‹èª Claire","can_delete":false,"product_type":"c1","uid":1090310,"ip_address":"","ucode":"0D9CC82C9F44D4","user_header":"https://static001.geekbang.org/account/avatar/00/10/a3/06/9fa93074.jpg","comment_is_top":false,"comment_ctime":1561173120,"is_pvip":false,"replies":[{"id":"38369","content":"1. è°¢è°¢æŒ‡å‡ºï¼Œwiresharkçš„å›¾ç‰‡æ ‡é”™äº†<br>2. ä¸æ˜¯çš„ï¼Œæ˜¯å› ä¸ºå®¹å™¨çš„eth0å®é™…ä¸Šåªæ˜¯veth pairï¼Œä¸ä¼šåˆ†åŒ…","user_name":"ä½œè€…å›å¤","comment_id":106095,"uid":"1001282","ip_address":"","utype":1,"ctime":1561214831,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10151107712","product_id":100020901,"comment_content":"1. ä¸åº”è¯¥æ˜¯0.2å‘0.30å‘é€è¯·æ±‚å—ï¼Ÿä¸ºä»€ä¹ˆwiresharkçš„å›¾SYNæ˜¯0.30å‘ç»™0.2çš„ï¼Ÿ2. MTUè¿‡å°ï¼Œæ˜¯å› ä¸ºè¦è¿›è¡Œå¤§é‡çš„æ•°æ®åˆ†ç‰‡åˆ†åŒ…ï¼Œæ‰€ä»¥å¯¼è‡´æœåŠ¡å™¨ç«¯æ¥æ”¶ä¸åˆ°curl http getè¯·æ±‚å—ï¼Ÿè°¢è°¢ã€‚","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454946,"discussion_content":"1. è°¢è°¢æŒ‡å‡ºï¼Œwiresharkçš„å›¾ç‰‡æ ‡é”™äº†\n2. ä¸æ˜¯çš„ï¼Œæ˜¯å› ä¸ºå®¹å™¨çš„eth0å®é™…ä¸Šåªæ˜¯veth pairï¼Œä¸ä¼šåˆ†åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561214831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97331,"user_name":"æŒºç›´è…°æ¿","can_delete":false,"product_type":"c1","uid":1178397,"ip_address":"","ucode":"B7DD679A3A4EEB","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/1d/12c7c021.jpg","comment_is_top":false,"comment_ctime":1558657182,"is_pvip":false,"replies":[{"id":"34969","content":"æŸ¥å†…æ ¸æºç ","user_name":"ä½œè€…å›å¤","comment_id":97331,"uid":"1001282","ip_address":"","utype":1,"ctime":1558793671,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10148591774","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè·Ÿè¸ªåˆ°å†…æ ¸å‡½æ•°ï¼Œä½†ä¸æ¸…æ¥šä»»ä½•å‡½æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Œæ€ä¹ˆæŸ¥ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451230,"discussion_content":"æŸ¥å†…æ ¸æºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558793671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76920,"user_name":"Huayra","can_delete":false,"product_type":"c1","uid":1031596,"ip_address":"","ucode":"5F8F6EF2783C1B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/ac/c9154dfe.jpg","comment_is_top":false,"comment_ctime":1552750952,"is_pvip":false,"replies":[{"id":"28099","content":"å—¯å—¯ï¼Œå¥½ä¸»æ„","user_name":"ä½œè€…å›å¤","comment_id":76920,"uid":"1001282","ip_address":"","utype":1,"ctime":1552834419,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10142685544","product_id":100020901,"comment_content":"é’ˆå¯¹è¿™é—®é¢˜ï¼Œtcpdumpæ•ˆç‡å¤ªä½äº†ï¼Œå€’ä¸å¦‚ä½¿ç”¨ç³»ç»ŸåŠ¨æ€è¿½è¸ªæˆ–è€…pcapæŠ€æœ¯æ¥å®ç°è¿™ä¹ˆä¸€ä¸ªä¸“é—¨çš„å·¥å…·","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443501,"discussion_content":"å—¯å—¯ï¼Œå¥½ä¸»æ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552834419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316292,"user_name":"AceslupK","can_delete":false,"product_type":"c1","uid":1284474,"ip_address":"","ucode":"048F84D019CBBB","user_header":"https://static001.geekbang.org/account/avatar/00/13/99/7a/558666a5.jpg","comment_is_top":false,"comment_ctime":1634262665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5929229961","product_id":100020901,"comment_content":"è€å¸ˆï¼Œ47ç¯‡ä¹Ÿæ‰§è¡Œè¿‡netstat -iï¼Œä¸ºå•¥é‚£ä¸ªæ—¶å€™æ²¡æ³¨æ„MTUå€¼å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":91232,"user_name":"æ— åè€å’","can_delete":false,"product_type":"c1","uid":1348261,"ip_address":"","ucode":"48874CE670E122","user_header":"","comment_is_top":false,"comment_ctime":1556940412,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5851907708","product_id":100020901,"comment_content":"iptablesæˆ‘åé¢æ˜¯æƒ³åˆ°äº†ï¼Œä½†æ˜¯mtuæ²¡æœ‰æƒ³åˆ°ã€‚æœ‰ä¸€ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¯´mtuå€¼ç­‰äº100æ˜¯å¤ªå°äº†ï¼Œæˆ‘æµ‹è¯•è¿‡è¿™ä¸ªæ¡ˆä¾‹ï¼Œå½“mtuå€¼å°äº127å€¼å°±ä¼šå‡ºç°å¼‚å¸¸ï¼Œç­‰äºä»¥åŠå¤§äº127è¿™ä¸ªå€¼å°±æ˜¯æ­£å¸¸çš„ï¼Œå€ªè€å¸ˆï¼Œè¿™ä¸ªå¯ä»¥è§£é‡Šä¸€ä¸‹å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1346575,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8c/0f/7516306e.jpg","nickname":"éº¦å°æ—­","note":"","ucode":"FDC132B4CDA0DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6689,"discussion_content":"å› ä¸ºæ¡ˆä¾‹çš„curlè¯·æ±‚çš„tcpåŒ…å¤§å°æ˜¯127","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567050978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":86057,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1555306822,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850274118","product_id":100020901,"comment_content":"DAY48ï¼Œæ‰“å¡","like_count":1},{"had_liked":false,"id":76422,"user_name":"è¥¿çº¢æŸ¿ç‰›è…©","can_delete":false,"product_type":"c1","uid":1152898,"ip_address":"","ucode":"DEC94B4A647A92","user_header":"https://static001.geekbang.org/account/avatar/00/11/97/82/394c88ad.jpg","comment_is_top":false,"comment_ctime":1552609788,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5847577084","product_id":100020901,"comment_content":"å¥½ç©ï¼ŒæŠ½ç©ºè¦æŠŠNetfilterå¥½å¥½ç©ä¸€é","like_count":1},{"had_liked":false,"id":335248,"user_name":"moooofly","can_delete":false,"product_type":"c1","uid":1008348,"ip_address":"","ucode":"4A20795C281B6F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/62/dc/8876c73b.jpg","comment_is_top":false,"comment_ctime":1645426641,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645426641","product_id":100020901,"comment_content":"ä»€ä¹ˆæƒ…å†µ&#47;æ¡ä»¶&#47;è®¾ç½®ä¸‹ï¼Œç³»ç»Ÿæ”¶å‘åŒ…çš„æ—¶å€™ä¼šæŒ‰ç…§ mtu å€¼è¿›è¡Œåˆ†ç‰‡å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":187874,"user_name":"å°è¢","can_delete":false,"product_type":"c1","uid":1811495,"ip_address":"","ucode":"3F5D8721F577D9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","comment_is_top":false,"comment_ctime":1584264064,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584264064","product_id":100020901,"comment_content":"å®šä½é—®é¢˜çš„æ€è·¯å¤ªæ¸…æ™°äº†ï¼Œæ²¡æœ‰ä¸€ç‚¹ç¢°è¿æ°”çš„æˆåˆ†ã€‚","like_count":0},{"had_liked":false,"id":158952,"user_name":"è®°äº‹æœ¬","can_delete":false,"product_type":"c1","uid":1362659,"ip_address":"","ucode":"76F2CAFA309437","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/e3/447aff89.jpg","comment_is_top":false,"comment_ctime":1575506390,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1575506390","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³é—®ä¸‹ï¼ŒæœåŠ¡ç«¯å‘é€äº†ä¸¤ç»„æ•°æ®åŒ…ï¼Œæˆ‘ç”¨txpdumpæŠ“åŒ…ç„¶åwiresharkçœ‹åˆ°çš„é‚£ä¸¤ç»„åŒ…åœ¨ä¸€ä¸ªtcpåŒ…é‡Œï¼Œè¿™ä¸ªæ˜¯åè®®æ ˆç»„åœ¨ä¸€èµ·çš„å—ï¼Ÿå¦å¤–è¿™ä¸ªç»„è¿‡åŒ…æˆ‘è°ƒç”¨recvæ¥å£æ¥æ”¶çš„æ—¶å€™åªæœ‰ç¬¬ä¸€åŒ…çš„æ•°æ®  æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæ„Ÿè°¢è€å¸ˆï¼ŒæœŸå¾…æ‚¨çš„å›å¤ã€‚","like_count":0},{"had_liked":false,"id":139486,"user_name":"ç¾ç¾","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1570667666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570667666","product_id":100020901,"comment_content":"ä¸ºä»€ä¹ˆæœ€åä¸€æ¬¡æ¡æ‰‹çš„æ—¶å€™ack=1è€Œä¸æ˜¯seq+1å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":103005,"user_name":"æ·±æµ·æå…‰","can_delete":false,"product_type":"c1","uid":1096111,"ip_address":"","ucode":"331024F7E99C64","user_header":"https://static001.geekbang.org/account/avatar/00/10/b9/af/f59b4c7c.jpg","comment_is_top":false,"comment_ctime":1560346996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560346996","product_id":100020901,"comment_content":"è€å¸ˆæœ€è¿‘åœ¨æŸ¥çº¿ä¸Šé—®é¢˜æ—¶ï¼Œå‘ç°æœåŠ¡åœ¨tcpå±‚æœ‰ä¸¢åŒ…ï¼Œé€šè¿‡netstat - så¯ä»¥çœ‹åˆ°ï¼Œå…·ä½“å¦‚ä¸‹: 32474 passive connections rejected because of time stamp<br>    71707 packets rejects in established connections because of timestamp<br>æŸ¥çœ‹æœºå™¨é…ç½®ï¼Œä¹Ÿç¡®å®æ˜¯å¼€å¯äº†tcp timestampå’Œrecycleï¼Œéƒ½ä¸º1ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯é€šè¿‡natè®¿é—®æ‰å›æœ‰è¿™ä¸ªé—®é¢˜å§ï¼Œæˆ‘ä»¬æ˜¯nginxç›´æ¥æ‰“ç»™æˆ‘çš„ç½‘å…³æœåŠ¡çš„ï¼Œç†è®ºä¸Šä¸å›æœ‰æ”¾å¼ƒé“¾æ¥å•¥ï¼Œè¿˜è¯·è€å¸ˆè§£ç­”ï¼Œè°¢è°¢äº†","like_count":0},{"had_liked":false,"id":78144,"user_name":"fran712","can_delete":false,"product_type":"c1","uid":1284429,"ip_address":"","ucode":"B09A1186FA1FA5","user_header":"","comment_is_top":false,"comment_ctime":1553077922,"is_pvip":false,"replies":[{"id":"28768","content":"å—¯ï¼Œè¿™æ˜¯ç›´æ¥ç¦æ­¢æ‰äº†","user_name":"ä½œè€…å›å¤","comment_id":78144,"uid":"1001282","ip_address":"","utype":1,"ctime":1553318690,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"1553077922","product_id":100020901,"comment_content":"æ›¾ç»è¢«è·Ÿè¸ªè¡¨å‘è¿‡ï¼Œç´¢æ€§å°±<br># cat &#47;etc&#47;modprobe.d&#47;conntrack.conf<br>install nf_conntrack &#47;bin&#47;false","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443983,"discussion_content":"å—¯ï¼Œè¿™æ˜¯ç›´æ¥ç¦æ­¢æ‰äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553318690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76556,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1552632146,"is_pvip":false,"replies":[{"id":"28062","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552750798,"ip_address":"","comment_id":76556,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552632146","product_id":100020901,"comment_content":"[D48æ‰“å¡]<br>ä¹‹å‰ç†åº”æƒ³åˆ° iptables .è¿™ä¸ªç›¸å½“äºæ˜¯ä¸ªé˜²ç«å¢™.<br>è¿˜æ˜¯è¿™ä¸ªå·¥å…·æ¥è§¦çš„å°‘äº†.<br><br>è¿™ä¸ªiptablesçš„é—®é¢˜æ²¡è§£å†³å‰,ç”¨ tcpdump èƒ½çœ‹å‡ºå•¥æ¥ä¸.<br>æˆ‘ç”¨tcpdumpçœ‹æ—¶åªæ˜¾ç¤ºå‡ºé‚£äº›è¿æ¥æˆåŠŸäº†çš„åŒ…ä¿¡æ¯,å¥½åƒæ²¡çœ‹åˆ°ä¸¢å¤±çš„ä¿¡æ¯.ğŸ˜<br><br>è¿æ¥è·Ÿè¸ªæ•°è¦åšå®¿ä¸»æœºä¸ŠæŸ¥çœ‹. å­¦ä¹ äº†.<br><br>é™¤æ­¤ä¹‹å¤–,è¿˜éœ€è¦é…åˆ`netstat -i`æŸ¥çœ‹ç½‘å¡åº•å±‚çš„ä¿¡æ¯.<br>","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443353,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552750798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76426,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1552610777,"is_pvip":false,"replies":[{"id":"28059","content":"çœ‹æ—¶é—´æˆ³","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552750694,"ip_address":"","comment_id":76426,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552610777","product_id":100020901,"comment_content":"tcpdumpæ€ä¹ˆçœ‹å‡ºç¬¬å››æ¬¡å‡ºç°é—®é¢˜ï¼Œå‰ä¸‰æ¬¡æ¡æ‰‹æ­£å¸¸ï¼Œå“ªé‡Œä½“ç°","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443302,"discussion_content":"çœ‹æ—¶é—´æˆ³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552750694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76387,"user_name":"Huayra","can_delete":false,"product_type":"c1","uid":1031596,"ip_address":"","ucode":"5F8F6EF2783C1B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/ac/c9154dfe.jpg","comment_is_top":false,"comment_ctime":1552581396,"is_pvip":false,"replies":[{"id":"28058","content":"æœ€ç®€å•çš„å°±æ˜¯tcpdumpæŠ“åŒ…","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552750614,"ip_address":"","comment_id":76387,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552581396","product_id":100020901,"comment_content":"è¯·é—®æœ‰æ²¡æœ‰ä¸“é—¨æ£€æµ‹ç½‘ç»œåŒ…å¤§å°å¼‚å¸¸çš„å·¥å…·å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443285,"discussion_content":"æœ€ç®€å•çš„å°±æ˜¯tcpdumpæŠ“åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552750614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}