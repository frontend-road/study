{"id":534762,"title":"17｜更真实的云原生：实际搭建多节点的Kubernetes集群","content":"<p>你好，我是Chrono。</p><p>到今天，你学习这个专栏的进度就已经过半了，在前面的“入门篇”我们了解了Docker和容器技术，在“初级篇”我们掌握了Kubernetes的基本对象、原理和操作方法，一路走下来收获很多。</p><p>现在你应该对Kubernetes和容器编排有了一些初步的认识，那么接下来，让我们继续深入研究Kubernetes的其他API对象，也就是那些在Docker中不存在的但对云计算、集群管理至关重要的概念。</p><p>不过在那之前，我们还需要有一个比minikube更真实的Kubernetes环境，它应该是一个多节点的Kubernetes集群，这样更贴近现实中的生产系统，能够让我们尽快地拥有实际的集群使用经验。</p><p>所以在今天的这节课里，我们就来暂时忘掉minikube，改用kubeadm（<a href=\"https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/\">https://kubernetes.io/zh/docs/reference/setup-tools/kubeadm/</a>）搭建出一个新的Kubernetes集群，一起来看看更真实的云原生环境。</p><h2>什么是kubeadm</h2><p>前面的几节课里我们使用的都是minikube，它非常简单易用，不需要什么配置工作，就能够在单机环境里创建出一个功能完善的Kubernetes集群，给学习、开发、测试都带来了极大的便利。</p><!-- [[[read_end]]] --><p>不过minikube还是太“迷你”了，方便的同时也隐藏了很多细节，离真正生产环境里的计算集群有一些差距，毕竟许多需求、任务只有在多节点的大集群里才能够遇到，相比起来，minikube真的只能算是一个“玩具”。</p><p>那么，多节点的Kubernetes集群是怎么从无到有地创建出来的呢？</p><p><a href=\"https://time.geekbang.org/column/article/529800\">第10讲</a>说过Kubernetes是很多模块构成的，而实现核心功能的组件像apiserver、etcd、scheduler等本质上都是可执行文件，所以也可以采用和其他系统差不多的方式，使用Shell脚本或者Ansible等工具打包发布到服务器上。</p><p>不过Kubernetes里的这些组件的配置和相互关系实在是太复杂了，用Shell、Ansible来部署的难度很高，需要具有相当专业的运维管理知识才能配置、搭建好集群，而且即使这样，搭建的过程也非常麻烦。</p><p>为了简化Kubernetes的部署工作，让它能够更“接地气”，社区里就出现了一个专门用来在集群中安装Kubernetes的工具，名字就叫“<strong>kubeadm</strong>”，意思就是“Kubernetes管理员”。</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/88/f27c7938cba21215621ac33635d63288.jpg?wh=1044x640\" alt=\"图片\"></p><p>kubeadm，原理和minikube类似，也是用容器和镜像来封装Kubernetes的各种组件，但它的目标不是单机部署，而是要能够轻松地在集群环境里部署Kubernetes，并且让这个集群接近甚至达到生产级质量。</p><p>而在保持这个高水准的同时，kubeadm还具有了和minikube一样的易用性，只要很少的几条命令，如 <code>init</code>、<code>join</code>、<code>upgrade</code>、<code>reset</code> 就能够完成Kubernetes集群的管理维护工作，这让它不仅适用于集群管理员，也适用于开发、测试人员。</p><h2>实验环境的架构是什么样的</h2><p>在使用kubeadm搭建实验环境之前，我们先来看看集群的架构设计，也就是说要准备好集群所需的硬件设施。</p><p>这里我画了一张系统架构图，图里一共有3台主机，当然它们都是使用虚拟机软件VirtualBox/VMWare虚拟出来的，下面我来详细说明一下：</p><p><img src=\"https://static001.geekbang.org/resource/image/yy/3e/yyf5db64d398b4d5dyyd5e8e23ece53e.jpg?wh=1920x1294\" alt=\"图片\"></p><p>所谓的多节点集群，要求服务器应该有两台或者更多，为了简化我们只取最小值，所以这个Kubernetes集群就只有两台主机，一台是Master节点，另一台是Worker节点。当然，在完全掌握了kubeadm的用法之后，你可以在这个集群里添加更多的节点。</p><p>Master节点需要运行apiserver、etcd、scheduler、controller-manager等组件，管理整个集群，所以对配置要求比较高，至少是2核CPU、4GB的内存。</p><p><img src=\"https://static001.geekbang.org/resource/image/d1/3c/d19a8ceafd4db10a5yy35c623384ba3c.png?wh=1504x920\" alt=\"图片\"></p><p>而Worker节点没有管理工作，只运行业务应用，所以配置可以低一些，为了节省资源我给它分配了1核CPU和1GB的内存，可以说是低到不能再低了。</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/f3/eeee60b6e29d7b6c4c74f913ac663ef3.png?wh=1504x1024\" alt=\"图片\"></p><p>基于模拟生产环境的考虑，在Kubernetes集群之外还需要有一台起辅助作用的服务器。</p><p>它的名字叫Console，意思是控制台，我们要在上面安装命令行工具kubectl，所有对Kubernetes集群的管理命令都是从这台主机发出去的。这也比较符合实际情况，因为安全的原因，集群里的主机部署好之后应该尽量少直接登录上去操作。</p><p>要提醒你的是，Console这台主机只是逻辑上的概念，不一定要是独立，你在实际安装部署的时候完全可以复用之前minikube的虚拟机，或者直接使用Master/Worker节点作为控制台。</p><p>这3台主机共同组成了我们的实验环境，所以在配置的时候要注意它们的网络选项，必须是在同一个网段，你可以再回顾一下<a href=\"https://time.geekbang.org/column/article/528614\">课前准备</a>，保证它们使用的是同一个“Host-Only”（VirtualBox）或者“自定”（VMWare Fusion）网络。</p><h2>安装前的准备工作</h2><p>不过有了架构图里的这些主机之后，我们还不能立即开始使用kubeadm安装Kubernetes，因为Kubernetes对系统有一些特殊要求，我们必须还要在Master和Worker节点上做一些准备。</p><p>这些工作的详细信息你都可以在Kubernetes的官网上找到，但它们分散在不同的文档里，比较凌乱，所以我把它们整合到了这里，包括改主机名、改Docker配置、改网络设置、改交换分区这四步。</p><p>第一，由于Kubernetes使用主机名来区分集群里的节点，所以每个节点的hostname必须不能重名。你需要修改“<strong>/etc/hostname</strong>”这个文件，把它改成容易辨识的名字，比如Master节点就叫 <code>master</code>，Worker节点就叫 <code>worker</code>：</p><pre><code class=\"language-plain\">sudo vi /etc/hostname\n</code></pre><p>第二，虽然Kubernetes目前支持多种容器运行时，但Docker还是最方便最易用的一种，所以我们仍然继续使用Docker作为Kubernetes的底层支持，使用 <code>apt</code> 安装Docker Engine（可参考<a href=\"https://time.geekbang.org/column/article/528619\">第1讲</a>）。</p><p>安装完成后需要你再对Docker的配置做一点修改，在“<strong>/etc/docker/daemon.json</strong>”里把cgroup的驱动程序改成 <code>systemd</code> ，然后重启Docker的守护进程，具体的操作我列在了下面：</p><pre><code class=\"language-bash\">cat &lt;&lt;EOF | sudo tee /etc/docker/daemon.json\n{\n&nbsp; \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n&nbsp; \"log-driver\": \"json-file\",\n&nbsp; \"log-opts\": {\n&nbsp; &nbsp; \"max-size\": \"100m\"\n&nbsp; },\n&nbsp; \"storage-driver\": \"overlay2\"\n}\nEOF\n\nsudo systemctl enable docker\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n</code></pre><p>第三，为了让Kubernetes能够检查、转发网络流量，你需要修改iptables的配置，启用“br_netfilter”模块：</p><pre><code class=\"language-bash\">cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\nbr_netfilter\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.ip_forward=1 # better than modify /etc/sysctl.conf\nEOF\n\nsudo sysctl --system\n</code></pre><p>第四，你需要修改“<strong>/etc/fstab</strong>”，关闭Linux的swap分区，提升Kubernetes的性能：</p><pre><code class=\"language-plain\">sudo swapoff -a\nsudo sed -ri '/\\sswap\\s/s/^#?/#/' /etc/fstab\n</code></pre><p>完成之后，最好记得重启一下系统，然后给虚拟机拍个快照做备份，避免后续的操作失误导致重复劳动。</p><h2>安装kubeadm</h2><p>好，现在我们就要安装kubeadm了，在Master节点和Worker节点上都要做这一步。</p><p>kubeadm可以直接从Google自己的软件仓库下载安装，但国内的网络不稳定，很难下载成功，需要改用其他的软件源，这里我选择了国内的某云厂商：</p><pre><code class=\"language-plain\">sudo apt install -y apt-transport-https ca-certificates curl\n\ncurl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -\n\ncat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list\ndeb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\nEOF\n\nsudo apt update\n</code></pre><p>更新了软件仓库，我们就可以用 <code>apt install</code> 获取kubeadm、kubelet和kubectl这三个安装必备工具了。apt默认会下载最新版本，但我们也可以指定版本号，比如使用和minikube相同的“1.23.3”：</p><pre><code class=\"language-plain\">sudo apt install -y kubeadm=1.23.3-00 kubelet=1.23.3-00 kubectl=1.23.3-00\n</code></pre><p>安装完成之后，你可以用 <code>kubeadm version</code>、<code>kubectl version</code> 来验证版本是否正确：</p><pre><code class=\"language-plain\">kubeadm version\nkubectl version --client\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/72/c9/72d79f46d9132af0dca110d982eff1c9.png?wh=1408x306\" alt=\"图片\"></p><p>另外按照Kubernetes官网的要求，我们最好再使用命令 <code>apt-mark hold</code> ，锁定这三个软件的版本，避免意外升级导致版本错误：</p><pre><code class=\"language-plain\">sudo apt-mark hold kubeadm kubelet kubectl\n</code></pre><h2>下载Kubernetes组件镜像</h2><p>前面我说过，kubeadm把apiserver、etcd、scheduler等组件都打包成了镜像，以容器的方式启动Kubernetes，但这些镜像不是放在Docker Hub上，而是放在Google自己的镜像仓库网站gcr.io，而它在国内的访问很困难，直接拉取镜像几乎是不可能的。</p><p>所以我们需要采取一些变通措施，提前把镜像下载到本地。</p><p>使用命令 <code>kubeadm config images list</code> 可以查看安装Kubernetes所需的镜像列表，参数 <code>--kubernetes-version</code> 可以指定版本号：</p><pre><code class=\"language-plain\">kubeadm config images list --kubernetes-version v1.23.3\n\nk8s.gcr.io/kube-apiserver:v1.23.3\nk8s.gcr.io/kube-controller-manager:v1.23.3\nk8s.gcr.io/kube-scheduler:v1.23.3\nk8s.gcr.io/kube-proxy:v1.23.3\nk8s.gcr.io/pause:3.6\nk8s.gcr.io/etcd:3.5.1-0\nk8s.gcr.io/coredns/coredns:v1.8.6\n</code></pre><p>知道了镜像的名字和标签就好办了，我们有两种方法可以比较容易地获取这些镜像。</p><p>第一种方法是利用minikube。因为minikube本身也打包了Kubernetes的组件镜像，所以完全可以从它的节点里把这些镜像导出之后再拷贝过来。</p><p>具体做法也很简单，先启动minikube，然后 <code>minikube ssh</code> 登录进虚拟节点，用 <code>docker save -o</code> 命令把相应版本的镜像都保存下来，再用 <code>minikube cp</code> 拷贝到本地，剩下的事情就不用我多说了：</p><p><img src=\"https://static001.geekbang.org/resource/image/66/4f/6609a62525bbf5d77eb7331f9835244f.png?wh=1848x484\" alt=\"图片\"></p><p>这种方法安全可靠，不过操作上麻烦了些，所以就有了第二种方法，从国内的镜像网站下载然后再用 <code>docker tag</code> 改名，能够使用Shell编程实现自动化：</p><pre><code class=\"language-plain\">repo=registry.aliyuncs.com/google_containers\n\nfor name in `kubeadm config images list --kubernetes-version v1.23.3`; do\n\n&nbsp; &nbsp; src_name=${name#k8s.gcr.io/}\n&nbsp; &nbsp; src_name=${src_name#coredns/}\n\n&nbsp; &nbsp; docker pull $repo/$src_name\n\n&nbsp; &nbsp; docker tag $repo/$src_name $name\n&nbsp; &nbsp; docker rmi $repo/$src_name\ndone\n</code></pre><p>第二种方法速度快，但也有隐患，万一网站不提供服务，或者改动了镜像就比较危险了。</p><p>所以你可以把这两种方法结合起来，先用脚本从国内镜像仓库下载，然后再用minikube里的镜像做对比，只要IMAGE ID是一样就说明镜像是正确的。</p><p>这张截图就是Kubernetes 1.23.3的镜像列表（amd64/arm64），你在安装时可以参考：</p><p><img src=\"https://static001.geekbang.org/resource/image/11/5c/11d9d4c91b08d95e82e75406a4d3aa5c.png?wh=1920x353\" alt=\"图片\" title=\"amd64\"></p><p><img src=\"https://static001.geekbang.org/resource/image/52/6c/528d9913620015f594988e648eeac66c.png?wh=1920x420\" alt=\"图片\" title=\"arm64\"></p><h2>安装Master节点</h2><p>准备工作都做好了，现在就可以开始正式安装Kubernetes了，我们先从Master节点开始。</p><p>kubeadm的用法非常简单，只需要一个命令 <code>kubeadm init</code> 就可以把组件在Master节点上运行起来，不过它还有很多参数用来调整集群的配置，你可以用 <code>-h</code> 查看。这里我只说一下我们实验环境用到的3个参数：</p><ul>\n<li><strong>--pod-network-cidr</strong>，设置集群里Pod的IP地址段。</li>\n<li><strong>--apiserver-advertise-address</strong>，设置apiserver的IP地址，对于多网卡服务器来说很重要（比如VirtualBox虚拟机就用了两块网卡），可以指定apiserver在哪个网卡上对外提供服务。</li>\n<li><strong>--kubernetes-version</strong>，指定Kubernetes的版本号。</li>\n</ul><p>下面的这个安装命令里，我指定了Pod的地址段是“10.10.0.0/16”，apiserver的服务地址是“192.168.10.210”，Kubernetes的版本号是“1.23.3”：</p><pre><code class=\"language-plain\">sudo kubeadm init \\\n&nbsp; &nbsp; --pod-network-cidr=10.10.0.0/16 \\\n&nbsp; &nbsp; --apiserver-advertise-address=192.168.10.210 \\\n&nbsp; &nbsp; --kubernetes-version=v1.23.3\n</code></pre><p>因为我们已经提前把镜像下载到了本地，所以kubeadm的安装过程很快就完成了，它还会提示出接下来要做的工作：</p><pre><code class=\"language-plain\">To start using your cluster, you need to run the following as a regular user:\n\n&nbsp; mkdir -p $HOME/.kube\n&nbsp; sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n&nbsp; sudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre><p>意思是要在本地建立一个“<strong>.kube</strong>”目录，然后拷贝kubectl的配置文件，你只要原样拷贝粘贴就行。</p><p>另外还有一个很重要的“<strong>kubeadm join</strong>”提示，其他节点要加入集群必须要用指令里的token和ca证书，所以这条命令务必拷贝后保存好：</p><pre><code class=\"language-plain\">Then you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\\n\t--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3\n</code></pre><p>安装完成后，你就可以使用 <code>kubectl version</code>、<code>kubectl get node</code> 来检查Kubernetes的版本和集群的节点状态了：</p><pre><code class=\"language-plain\">kubectl version\nkubectl get node\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/c6/09/c63ce96bfyy0e1bc2927d575a66ee209.png?wh=1482x366\" alt=\"图片\"></p><p>你会注意到Master节点的状态是“NotReady”，这是由于还缺少网络插件，集群的内部网络还没有正常运作。</p><h2>安装Flannel网络插件</h2><p>Kubernetes定义了CNI标准，有很多网络插件，这里我选择最常用的<strong>Flannel</strong>，可以在它的GitHub仓库里（<a href=\"https://github.com/flannel-io/flannel/\">https://github.com/flannel-io/flannel/</a>）找到相关文档。</p><p>它安装也很简单，只需要使用项目的“<strong>kube-flannel.yml</strong>”在Kubernetes里部署一下就好了。不过因为它应用了Kubernetes的网段地址，你需要修改文件里的“<strong>net-conf.json</strong>”字段，把 <code>Network</code> 改成刚才kubeadm的参数 <code>--pod-network-cidr</code> 设置的地址段。</p><p>比如在这里，就要修改成“10.10.0.0/16”：</p><pre><code class=\"language-plain\">&nbsp; net-conf.json: |\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; \"Network\": \"10.10.0.0/16\",\n&nbsp; &nbsp; &nbsp; \"Backend\": {\n&nbsp; &nbsp; &nbsp; &nbsp; \"Type\": \"vxlan\"\n&nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n</code></pre><p>改好后，你就可以用 <code>kubectl apply</code> 来安装Flannel网络了：</p><pre><code class=\"language-plain\">kubectl apply -f kube-flannel.yml\n</code></pre><p>稍等一小会，等镜像拉取下来并运行之后，你就可以执行 <code>kubectl get node</code> 来看节点状态：</p><pre><code class=\"language-plain\">kubectl get node\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/6a/7a/6a3c852abe5b193a6997b154163ed67a.png?wh=1434x184\" alt=\"图片\"></p><p>这时你应该能够看到Master节点的状态是“Ready”，表明节点网络也工作正常了。</p><h2>安装Worker节点</h2><p>如果你成功安装了Master节点，那么Worker节点的安装就简单多了，只需要用之前拷贝的那条 <code>kubeadm join</code> 命令就可以了，记得要用 <code>sudo</code> 来执行：</p><pre><code class=\"language-plain\">sudo \\\nkubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\\n\t--discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3\n</code></pre><p>它会连接Master节点，然后拉取镜像，安装网络插件，最后把节点加入集群。</p><p>当然，这个过程中同样也会遇到拉取镜像的问题，你可以如法炮制，提前把镜像下载到Worker节点本地，这样安装过程中就不会再有障碍了。</p><p>Worker节点安装完毕后，执行 <code>kubectl get node</code> ，就会看到两个节点都是“Ready”状态：</p><p><img src=\"https://static001.geekbang.org/resource/image/f7/26/f756ece9e81af80a7204243f15777026.png?wh=1430x246\" alt=\"图片\"></p><p>现在让我们用 <code>kubectl run</code> ，运行Nginx来测试一下：</p><pre><code class=\"language-plain\">kubectl run ngx --image=nginx:alpine\nkubectl get pod -o wide\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/73/e9/73651e5f178e2daf6eaf7ac262e230e9.png?wh=1584x188\" alt=\"图片\"></p><p>会看到Pod运行在Worker节点上，IP地址是“10.10.1.2”，表明我们的Kubernetes集群部署成功。</p><h2>小结</h2><p>好了，把Master节点和Worker节点都安装好，我们今天的任务就算是基本完成了。</p><p>后面Console节点的部署工作更加简单，它只需要安装一个kubectl，然后复制“config”文件就行，你可以直接在Master节点上用“scp”远程拷贝，例如：</p><pre><code class=\"language-plain\">scp `which kubectl` chrono@192.168.10.208:~/\nscp ~/.kube/config chrono@192.168.10.208:~/.kube\n</code></pre><p>今天的过程多一些，要点我列在了下面：</p><ol>\n<li>kubeadm是一个方便易用的Kubernetes工具，能够部署生产级别的Kubernetes集群。</li>\n<li>安装Kubernetes之前需要修改主机的配置，包括主机名、Docker配置、网络设置、交换分区等。</li>\n<li>Kubernetes的组件镜像存放在gcr.io，国内下载比较麻烦，可以考虑从minikube或者国内镜像网站获取。</li>\n<li>安装Master节点需要使用命令 <code>kubeadm init</code>，安装Worker节点需要使用命令 <code>kubeadm join</code>，还要部署Flannel等网络插件才能让集群正常工作。</li>\n</ol><p>因为这些操作都是各种Linux命令，全手动敲下来确实很繁琐，所以我把这些步骤都做成了Shell脚本放在了GitHub上（<a href=\"https://github.com/chronolaw/k8s_study/tree/master/admin\">https://github.com/chronolaw/k8s_study/tree/master/admin</a>），你可以下载后直接运行。</p><h2>课下作业</h2><p>最后的课下作业是实际动手操作，请你多花费一些时间，用虚拟机创建出集群节点，再用kubeadm部署出这个多节点的Kubernetes环境，在接下来的“中级篇”和“高级篇”里我们就会在这个Kubernetes集群里做实验。</p><p>安装部署过程中有任何疑问，欢迎在留言区留言，我会第一时间回复你。如果觉得有帮助，也欢迎分享给自己身边的朋友一起学习，下节课见。</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/41/d3d76937e5f4eb6545a07b96bc731e41.jpg?wh=1920x2513\" alt=\"图片\"></p>","neighbors":{"left":{"article_title":"16｜视频：初级篇实操总结","id":534688},"right":{"article_title":"18｜Deployment：让应用永不宕机","id":535209}},"comments":[{"had_liked":false,"id":352944,"user_name":"怀朔","can_delete":false,"product_type":"c1","uid":1006865,"ip_address":"陕西","ucode":"52FAC1C2FD37B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","comment_is_top":false,"comment_ctime":1659026416,"is_pvip":false,"replies":[{"id":"128324","content":"<br>1.一步步来，不要着急。<br><br>2.国内的我很少用，大家也都懂。<br><br>3.什么都讲就会显得内容太多太杂，毕竟专栏的目标是入门，不是上生产系统。<br><br>4.感谢建议，会和编辑考虑再改进。","user_name":"作者回复","user_name_real":"作者","uid":"1181974","ctime":1659060831,"ip_address":"陕西","comment_id":352944,"utype":1}],"discussion_count":2,"race_medal":0,"score":"36018764784","product_id":100114501,"comment_content":"本章质量略显不足 .主要如下几点<br>1、已经在考虑多节点不如把多集群考虑进去 这样才是真正的线上环境？<br>2、因为网络问题 考虑仓库不足 如何直接引用国内云厂商镜像仓库？ 讲解如何把海外镜像复制国内镜像岂不是更好？<br>3、生产中明显最关键是网络插件问题 和cidr块 网络冲突问题 通篇没有讲 令人略显单薄","like_count":8,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581887,"discussion_content":"\n1.一步步来，不要着急。\n\n2.国内的我很少用，大家也都懂。\n\n3.什么都讲就会显得内容太多太杂，毕竟专栏的目标是入门，不是上生产系统。\n\n4.感谢建议，会和编辑考虑再改进。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659060832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1032236,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c0/2c/87cc08ce.jpg","nickname":"baiyutang","note":"","ucode":"FD2436978BB447","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584586,"discussion_content":"我记得有一个参数可以指定国内镜像地址的，可以留意下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660957216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356417,"user_name":"Obscure","can_delete":false,"product_type":"c1","uid":3171798,"ip_address":"北京","ucode":"8A7464990F4178","user_header":"https://static001.geekbang.org/account/avatar/00/30/65/d6/20670fd5.jpg","comment_is_top":false,"comment_ctime":1662285807,"is_pvip":false,"replies":[{"id":"129762","content":"这个方法不错，感谢分享。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662341417,"ip_address":"北京","comment_id":356417,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18842154991","product_id":100114501,"comment_content":"不需要写脚本来下载镜像啊，一条命令搞定：<br>kubeadm init \\<br>--apiserver-advertise-address=192.168.137.100 \\<br>--image-repository registry.aliyuncs.com&#47;google_containers \\<br>--kubernetes-version v1.23.6 \\<br>--service-cidr=10.96.0.0&#47;12 \\<br>--pod-network-cidr=10.244.0.0&#47;16","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586558,"discussion_content":"这个方法不错，感谢分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662341417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2515285,"avatar":"https://static001.geekbang.org/account/avatar/00/26/61/55/ddfd2859.jpg","nickname":"MRKT","note":"","ucode":"24699CA844EC21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590853,"discussion_content":"非常感谢您的分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666110537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"安徽"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353383,"user_name":"朱雯","can_delete":false,"product_type":"c1","uid":1035744,"ip_address":"北京","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1659410379,"is_pvip":true,"replies":[{"id":"128476","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659421141,"ip_address":"北京","comment_id":353383,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18839279563","product_id":100114501,"comment_content":"终于跑起来了，提醒大家一件事，那就是新节点如何加入到k8s集群中，第一遍执行有提示，后续的话，可以执行kubeadm token create --print-join-command这条命令显示加入方式","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582389,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659421141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353211,"user_name":"hiDaLao","can_delete":false,"product_type":"c1","uid":2917100,"ip_address":"北京","ucode":"3C2DC2A3A377E4","user_header":"https://static001.geekbang.org/account/avatar/00/2c/82/ec/99b480e8.jpg","comment_is_top":false,"comment_ctime":1659266894,"is_pvip":true,"replies":[{"id":"128409","content":"great ","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659275542,"ip_address":"北京","comment_id":353211,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18839136078","product_id":100114501,"comment_content":"1. 装环境时可先装一台然后克隆；<br>2. kubeadm init时指定的apiserver的ip需要是自己环境上master节点的ip地址，如果指定错误，可通过sudo kubeadm reset重置；<br>3. kube-flannel.yml 文件在仓库的Documentation目录下，只用copy到环境上修改下net-config.json里面的Network的地址即可；<br>4. 执行scp ~&#47;.kube&#47;config到console节点时，需要先在console节点上通过mkdir ~&#47;.kube创建下目录","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582169,"discussion_content":"great ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659275542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354956,"user_name":"这里的人都叫我八进制","can_delete":false,"product_type":"c1","uid":1349002,"ip_address":"北京","ucode":"9F6C2D973E510E","user_header":"https://static001.geekbang.org/account/avatar/00/14/95/8a/d74cdda5.jpg","comment_is_top":false,"comment_ctime":1660906060,"is_pvip":false,"replies":[{"id":"129113","content":"欢迎经验分享。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1660911557,"ip_address":"北京","comment_id":354956,"utype":1}],"discussion_count":4,"race_medal":0,"score":"14545807948","product_id":100114501,"comment_content":"work节点NotReady解决办法<br><br>KubeletNotReady runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized<br>1.  mkdir -p &#47;etc&#47;cni&#47;net.d<br><br>2. vi 10-flannel.conflist<br><br>{<br>  &quot;name&quot;: &quot;cbr0&quot;,<br>  &quot;plugins&quot;: [<br>    {<br>      &quot;type&quot;: &quot;flannel&quot;,<br>      &quot;delegate&quot;: {<br>        &quot;hairpinMode&quot;: true,<br>        &quot;isDefaultGateway&quot;: true<br>      }<br>    },<br>    {<br>      &quot;type&quot;: &quot;portmap&quot;,<br>      &quot;capabilities&quot;: {<br>        &quot;portMappings&quot;: true<br>      }<br>    }<br>  ]<br>}<br><br><br>3.<br><br>systemctl daemon-reload<br><br>systemctl restart kubelet","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584558,"discussion_content":"欢迎经验分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660911557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1394115,"avatar":"https://static001.geekbang.org/account/avatar/00/15/45/c3/051ffe83.jpg","nickname":"rubys_","note":"","ucode":"931AD02864126A","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591524,"discussion_content":"遇到同样问题，完美解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666612795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"中国台湾"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020529,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/71/9fd7cd7a.jpg","nickname":"Daniel","note":"","ucode":"282E09B3146501","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587465,"discussion_content":"你咋这么牛B呀，完美解决我的问题，赞赞赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663067480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"海南"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2962899,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/35/d3/8de43dd5.jpg","nickname":"Breeze","note":"","ucode":"8B6711F5B9D112","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584573,"discussion_content":"果然管用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660918313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353036,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"陕西","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659084419,"is_pvip":true,"replies":[{"id":"128369","content":"good","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659098529,"ip_address":"陕西","comment_id":353036,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14543986307","product_id":100114501,"comment_content":"一定要关闭swap，不然kubelet无法启动！！！","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581983,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659098530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352997,"user_name":"小林子","can_delete":false,"product_type":"c1","uid":1145383,"ip_address":"陕西","ucode":"058C95ECBFE422","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/27/77ca2bc2.jpg","comment_is_top":false,"comment_ctime":1659071715,"is_pvip":true,"replies":[{"id":"128350","content":"后面高级篇会用，flannel简单，而且现在不是我们学习的重点。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659077473,"ip_address":"陕西","comment_id":352997,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14543973603","product_id":100114501,"comment_content":"老师为啥不用 Calico 网络插件了","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581932,"discussion_content":"后面高级篇会用，flannel简单，而且现在不是我们学习的重点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353301,"user_name":"星亦辰","can_delete":false,"product_type":"c1","uid":1284592,"ip_address":"北京","ucode":"B0388FBFFDEE7E","user_header":"https://static001.geekbang.org/account/avatar/00/13/99/f0/d9343049.jpg","comment_is_top":false,"comment_ctime":1659341070,"is_pvip":true,"replies":[{"id":"128446","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659351198,"ip_address":"北京","comment_id":353301,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10249275662","product_id":100114501,"comment_content":"cat &lt;&lt;EOF | sudo tee &#47;etc&#47;yum.repos.d&#47;kubernetes.repo<br>[kubernetes] <br>name=Kubernetes <br>baseurl=https:&#47;&#47;mirrors.aliyun.com&#47;kubernetes&#47;yum&#47;repos&#47;kubernetes-el7-x86_64 <br>enabled=1 <br>gpgcheck=0 <br>repo_gpgcheck=0 <br>EOF<br><br>补充一个 Yum 的源 <br>","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582289,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659351198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353296,"user_name":"新时代农民工","can_delete":false,"product_type":"c1","uid":1225689,"ip_address":"北京","ucode":"0AA60DEDF6C062","user_header":"https://static001.geekbang.org/account/avatar/00/12/b3/d9/cf061262.jpg","comment_is_top":false,"comment_ctime":1659337205,"is_pvip":false,"replies":[{"id":"128439","content":"应该是master节点不参与业务吧，可以试着把污点去掉。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659340241,"ip_address":"北京","comment_id":353296,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10249271797","product_id":100114501,"comment_content":"老师请问下，成功按文中操作搭建集群，在测试运行 Nginx 的时候，通过expose 端口在NodePort， 为何只能在worker的node上访问， 而在master节点上，通过本地ip访问不了呢","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582261,"discussion_content":"应该是master节点不参与业务吧，可以试着把污点去掉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659340242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353206,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"北京","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1659261750,"is_pvip":true,"replies":[{"id":"128408","content":"<br>1.这个属于shell编程了，因为coredns镜像的名字比较特别，做了特殊处理。<br><br>2.当然可以，但kubectl的config文件就得做个切换了。<br><br>3.是的，第一个IP地址是节点的地址，必须是你自己的，第二个是集群里的IP地址，可以用这个10.10.0.0。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659270660,"ip_address":"北京","comment_id":353206,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10249196342","product_id":100114501,"comment_content":"请教老师几个问题：<br>Q1：脚本为什么对src_name两次赋值？<br>       脚本的for循环里面有如下两行：<br>       src_name=${name#k8s.gcr.io&#47;}    <br>       src_name=${src_name#coredns&#47;}<br>       为什么对同一个src_name两次赋值？<br><br>Q2：同一个虚拟机上是否可以同时按照minikube和kubeadm？<br>Q3：apiserver的IP应该是自己的虚拟机的IP，Pod地址段和虚拟机IP无关，采用私有地址段即可，<br>        是这样吗？<br>        文中提到：“apiserver 的服务地址是“192.168.10.210””，这个地址是作者自己虚拟机的IP，<br>        读者应该换成自己虚拟机的IP，是这样吗？<br>        文中提到：“我指定了 Pod 的地址段是“10.10.0.0&#47;16””，Pod的IP段和虚拟机无关，读者的环境<br>        也可以采用，对吗？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582162,"discussion_content":"\n1.这个属于shell编程了，因为coredns镜像的名字比较特别，做了特殊处理。\n\n2.当然可以，但kubectl的config文件就得做个切换了。\n\n3.是的，第一个IP地址是节点的地址，必须是你自己的，第二个是集群里的IP地址，可以用这个10.10.0.0。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659270660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1055810,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1c/42/d3a0e33a.jpg","nickname":"希德小子","note":"","ucode":"0F3DA846858DBD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590772,"discussion_content":"这个src_name 有问题。无法正常从aliyun的镜像库拉取镜像，拼凑出来的：\ndocker pull  registry.cn-hangzhou.aliyuncs.com/google_containers/registry.k8s.io/kube-apiserver:v1.25.3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666074931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353108,"user_name":"Geek_b537b2","can_delete":false,"product_type":"c1","uid":2547775,"ip_address":"陕西","ucode":"2C1848B32987E8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqF6ViaDyAibEKbcKfWoGXe8lCbb8wqes5g3JezHWNLf4DIl92QwXX43HWv408BxzkOKmKb2HpKJuIw/132","comment_is_top":false,"comment_ctime":1659171857,"is_pvip":false,"replies":[{"id":"128393","content":"thanks","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659174309,"ip_address":"陕西","comment_id":353108,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10249106449","product_id":100114501,"comment_content":"入门好教程","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582061,"discussion_content":"thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352989,"user_name":"rexzhao","can_delete":false,"product_type":"c1","uid":1112101,"ip_address":"陕西","ucode":"EFDAAACBE6D755","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/25/06c86919.jpg","comment_is_top":false,"comment_ctime":1659066021,"is_pvip":false,"replies":[{"id":"128349","content":"可以在专栏的GitHub仓库里找到，或者直接去flannel项目上获取。<br><br>注意看YAML，它用的是“:|” ，表示的是一个长字符串，内容是json格式。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659077438,"ip_address":"陕西","comment_id":352989,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10249000613","product_id":100114501,"comment_content":"kube-flannel.yml 文件是在哪个位置？是从哪来的？ 修改的内容对吗好像不是 yml 文件格式。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581931,"discussion_content":"可以在专栏的GitHub仓库里找到，或者直接去flannel项目上获取。\n\n注意看YAML，它用的是“:|” ，表示的是一个长字符串，内容是json格式。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352959,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"陕西","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1659055588,"is_pvip":true,"replies":[{"id":"128327","content":"应该有的，不过我了解的不多。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659062221,"ip_address":"陕西","comment_id":352959,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10248990180","product_id":100114501,"comment_content":"为什么到目前为止，各大云计算公司大厂都没有做一个gcr.io  k8s的同步镜像站呢","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581892,"discussion_content":"应该有的，不过我了解的不多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659062221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583398,"discussion_content":"清华大学镜像 https://mirrors.tuna.tsinghua.edu.cn/help/kubernetes/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660097149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"新加坡"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808649,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoHXbWPZuBKJBYiayL1qFLwKZCM76CPEwXcREia71QCiaMJ5Im5Iibt9CvQBPunQ01VVOm9xU4ia0zasYQ/132","nickname":"Grour","note":"","ucode":"E688BDC7F305AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582255,"discussion_content":"有，但只限于购买云服务器的内网使用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659339222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"Frank","note":"","ucode":"9DADD72C193296","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1808649,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoHXbWPZuBKJBYiayL1qFLwKZCM76CPEwXcREia71QCiaMJ5Im5Iibt9CvQBPunQ01VVOm9xU4ia0zasYQ/132","nickname":"Grour","note":"","ucode":"E688BDC7F305AB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582283,"discussion_content":"哪个平台。什么服务？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659349069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":582255,"ip_address":"四川"},"score":582283,"extra":""}]}]},{"had_liked":false,"id":352950,"user_name":"Christopher","can_delete":false,"product_type":"c1","uid":1757265,"ip_address":"陕西","ucode":"1AC6035DFA4ECB","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d0/51/f1c9ae2d.jpg","comment_is_top":false,"comment_ctime":1659050727,"is_pvip":false,"replies":[{"id":"128326","content":"全程实录，笑。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659062181,"ip_address":"陕西","comment_id":352950,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10248985319","product_id":100114501,"comment_content":"还是挺翔实的搭建教程!","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581891,"discussion_content":"全程实录，笑。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659062181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359696,"user_name":"逐書寄年","can_delete":false,"product_type":"c1","uid":2894626,"ip_address":"北京","ucode":"FCB3F4C591481C","user_header":"https://static001.geekbang.org/account/avatar/00/2c/2b/22/441c4e51.jpg","comment_is_top":false,"comment_ctime":1665757445,"is_pvip":true,"replies":[{"id":"130853","content":"用describe查看pod的状态，应该有一些提示信息。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665833570,"ip_address":"北京","comment_id":359696,"utype":1}],"discussion_count":2,"race_medal":2,"score":"5960724741","product_id":100114501,"comment_content":"感謝老師詳盡的解說！我有的問題是：<br>當我部屬完cluster，也成功加入 woker node 後，想嘗試啟動 nginx pod，使用 `kubectl get pod -o wide` 檢查狀態後，卻發現一直處於 `ContainerCreating` 的狀態。不知道有沒有線索可以知道從何 debug 呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590513,"discussion_content":"用describe查看pod的状态，应该有一些提示信息。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1665833571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2894626,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/2b/22/441c4e51.jpg","nickname":"逐書寄年","note":"","ucode":"FCB3F4C591481C","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590655,"discussion_content":"非常感謝老師的提示！已經 debug 成功\n我看到的錯誤提示是 `network: open /run/flannel/subnet.env: no such file or directory`，經查詢後發現我的 master 跟 worker 不知道為什麼在指定目錄下都沒有 `subnet.env` 文件。於是照著網路上的案例在 master 跟 worker 都建立該文件便解決了\n\n附帶一提，我是在兩台樹莓派上各自裝 ubuntu server 作為 cluster 的練習，不曉得是不是因為這樣才會有一些區別。跟著這堂實戰課一路學下來感覺非常踏實，謝謝羅老師精心規劃的課程內容！\n\n```shell\n# subnet.env\nFLANNEL_NETWORK=10.10.0.0/16 # needs to be the private network of the cluster\nFLANNEL_SUBNET=10.10.0.1/24\nFLANNEL_MTU=1450\nFLANNEL_IPMASQ=true\n```","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665974162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"美国"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356721,"user_name":"xmr","can_delete":false,"product_type":"c1","uid":1009622,"ip_address":"北京","ucode":"1BBF165F91F10B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","comment_is_top":false,"comment_ctime":1662533157,"is_pvip":true,"replies":[{"id":"129833","content":"是的，这点一定要注意，192.168.10.210应该是master节点的IP地址。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662536233,"ip_address":"北京","comment_id":356721,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5957500453","product_id":100114501,"comment_content":"sudo kubeadm init \\<br>    --pod-network-cidr=10.10.0.0&#47;16 \\<br>    --apiserver-advertise-address=192.168.10.210 \\<br>    --kubernetes-version=v1.23.3<br><br>--apiserver-advertise-address=192.168.10.210要改为master虚拟机的ip，否则会报错","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586841,"discussion_content":"是的，这点一定要注意，192.168.10.210应该是master节点的IP地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662536233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355166,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661149673,"is_pvip":true,"replies":[{"id":"129238","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661158005,"ip_address":"北京","comment_id":355166,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5956116969","product_id":100114501,"comment_content":"安装成功！<br>中间遇到一个“坑”，提醒同学们。<br>在运行https:&#47;&#47;github.com&#47;chronolaw&#47;k8s_study&#47;blob&#47;master&#47;admin&#47;master.sh的时候，一定要把注释掉的# --apiserver-advertise-address=192.168.10.210 换成自己的IP地址，并添加进去，否则会以10.0.x.x的IP运行。<br>感谢罗老师，祝同学们学习顺利！","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584846,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661158005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353893,"user_name":"威","can_delete":false,"product_type":"c1","uid":1068542,"ip_address":"上海","ucode":"C921CDCB22B9A3","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg","comment_is_top":false,"comment_ctime":1659916995,"is_pvip":false,"replies":[{"id":"128698","content":"running不代表就正常，看看log，可以重启pod试试。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659924775,"ip_address":"上海","comment_id":353893,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954884291","product_id":100114501,"comment_content":"按照教程安装完后，节点能正常链接起来，但内部dns解析不了，基本检查了一下，k8s的dns pod是正常running","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583125,"discussion_content":"running不代表就正常，看看log，可以重启pod试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659924775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353422,"user_name":"Geek_8497e1","can_delete":false,"product_type":"c1","uid":2156419,"ip_address":"上海","ucode":"3289E378B9D331","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132","comment_is_top":false,"comment_ctime":1659429869,"is_pvip":true,"replies":[{"id":"128481","content":"这个可以上Kubernetes官网上找。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659430802,"ip_address":"上海","comment_id":353422,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954397165","product_id":100114501,"comment_content":"你好，有kubeadm，高可用k8s的搭建文档嘛","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582422,"discussion_content":"这个可以上Kubernetes官网上找。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659430802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353345,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"北京","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1659375928,"is_pvip":false,"replies":[{"id":"128461","content":"建议用kubeadm reset，弄个干净的环境再试试。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659405614,"ip_address":"北京","comment_id":353345,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5954343224","product_id":100114501,"comment_content":"老师，在配置 Master 节点的时候有问题，报错如下<br><br>ppeng@master:~$ sudo kubeadm init \\<br>    --pod-network-cidr=10.10.0.0&#47;16 \\<br>    --apiserver-advertise-address=192.168.10.210 \\<br>    --kubernetes-version=v1.23.3<br>[sudo] password for ppeng:<br>[init] Using Kubernetes version: v1.23.3<br>[preflight] Running pre-flight checks<br>error execution phase preflight: [preflight] Some fatal errors occurred:<br>\t[ERROR Port-10259]: Port 10259 is in use<br>\t[ERROR Port-10257]: Port 10257 is in use<br>\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-apiserver.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-apiserver.yaml already exists<br>\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-controller-manager.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-controller-manager.yaml already exists<br>\t[ERROR FileAvailable--etc-kubernetes-manifests-kube-scheduler.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;kube-scheduler.yaml already exists<br>\t[ERROR FileAvailable--etc-kubernetes-manifests-etcd.yaml]: &#47;etc&#47;kubernetes&#47;manifests&#47;etcd.yaml already exists<br>\t[ERROR Port-10250]: Port 10250 is in use<br>[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`<br>To see the stack trace of this error execute with --v=5 or higher<br><br>前面的步骤都已成功，docker 也成功拉取了镜像，不清楚这里报错的原因是什么","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582349,"discussion_content":"建议用kubeadm reset，弄个干净的环境再试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1646052,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/e4/517fbbbf.jpg","nickname":"白芷","note":"","ucode":"D37530955CF919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589576,"discussion_content":"借楼，--apiserver-advertise-address=192.168.10.210要改为master虚拟机的ip，否则会报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665135858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353086,"user_name":"Amosヾ","can_delete":false,"product_type":"c1","uid":1567014,"ip_address":"陕西","ucode":"833F6FCB4042AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e9/26/afc08398.jpg","comment_is_top":false,"comment_ctime":1659153088,"is_pvip":true,"replies":[{"id":"128394","content":"这个我觉得意义可能不是太大，掌握了kubeadm的用法，再看一下官方文档就可以会多节点了，再写出来感觉有点多余。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659174354,"ip_address":"陕西","comment_id":353086,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5954120384","product_id":100114501,"comment_content":"后面会有k8s多master安装教程吗？官方文档貌似需要一个外部lb吧？是否可以本地模拟呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582062,"discussion_content":"这个我觉得意义可能不是太大，掌握了kubeadm的用法，再看一下官方文档就可以会多节点了，再写出来感觉有点多余。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353066,"user_name":"西门吹牛","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"陕西","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1659110301,"is_pvip":false,"replies":[{"id":"128390","content":"good，云原生的意思还可以再参考一下09讲我的个人理解。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659138836,"ip_address":"陕西","comment_id":353066,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954077597","product_id":100114501,"comment_content":"云原生，开发人员只关心业务代码，所有部署，微服务治理相关的，运维相关都依托云基础设施，把原先微服务架构中，除业务代码之外的服务治理比如服务发现，负载均衡，熔断限流等从软件应用层面转移到云基础设施比如k8s上，虽然k8s底层容器技术依赖硬件基础设施，但容器之间的服务治理基础设施不能完全处理，k8s中各种编排对象也属于软件，只是让对开发人员透明化了，让程序员回归到以业务为主，只关心业务的本质上","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582018,"discussion_content":"good，云原生的意思还可以再参考一下09讲我的个人理解。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659138837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353051,"user_name":"你的笑忘书","can_delete":false,"product_type":"c1","uid":1521181,"ip_address":"北京","ucode":"9665D5E9EDBEA6","user_header":"https://static001.geekbang.org/account/avatar/00/17/36/1d/874dc1e3.jpg","comment_is_top":false,"comment_ctime":1659093452,"is_pvip":false,"replies":[{"id":"128388","content":"我是开发背景，对系统管理不是太了解，但显然生产中使用kubeadm要比我们课程里要考虑更多的东西，比如证书安全、高可用等等，建议去咨询更专业的同事。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659138715,"ip_address":"北京","comment_id":353051,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954060748","product_id":100114501,"comment_content":"希望老师补充下生产中，使用 kubeadm 部署集群的话，有哪些务必需要注意的点。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582016,"discussion_content":"我是开发背景，对系统管理不是太了解，但显然生产中使用kubeadm要比我们课程里要考虑更多的东西，比如证书安全、高可用等等，建议去咨询更专业的同事。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659138716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353009,"user_name":"进击的土豆","can_delete":false,"product_type":"c1","uid":1948043,"ip_address":"陕西","ucode":"52249892A6C203","user_header":"https://static001.geekbang.org/account/avatar/00/1d/b9/8b/d0763d9a.jpg","comment_is_top":false,"comment_ctime":1659075674,"is_pvip":true,"replies":[{"id":"128353","content":"kubeadm是Kubernetes的安装部署工具，RKE是rancher公司的Kubernetes发行版，类似GKE，可以搜一下。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659077618,"ip_address":"陕西","comment_id":353009,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954042970","product_id":100114501,"comment_content":"老师，kubeadm和rke的区别是什么","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581935,"discussion_content":"kubeadm是Kubernetes的安装部署工具，RKE是rancher公司的Kubernetes发行版，类似GKE，可以搜一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353001,"user_name":"Geek_8497e1","can_delete":false,"product_type":"c1","uid":2156419,"ip_address":"陕西","ucode":"3289E378B9D331","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoxAjJG76r6Qib0G1rcQvVOmPc70biapxg6ny3RFX7L5KKaJdib6zUIEicvYmhyiaQeHScVMc8KjHTHIQ/132","comment_is_top":false,"comment_ctime":1659073511,"is_pvip":true,"replies":[{"id":"128351","content":"我没有太多发言权，可能还是得具体运维部门拍板才行。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659077506,"ip_address":"陕西","comment_id":353001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954040807","product_id":100114501,"comment_content":"请问，生产环境，老师建议用二进制还是kubeadmin","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581933,"discussion_content":"我没有太多发言权，可能还是得具体运维部门拍板才行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659077506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352967,"user_name":"无名无姓","can_delete":false,"product_type":"c1","uid":2621412,"ip_address":"陕西","ucode":"487BD5AA2CD305","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/e4/927547a9.jpg","comment_is_top":false,"comment_ctime":1659058187,"is_pvip":true,"replies":[{"id":"128330","content":"继续努力。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659064147,"ip_address":"陕西","comment_id":352967,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954025483","product_id":100114501,"comment_content":"理解起来很方便","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581901,"discussion_content":"继续努力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659064147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352960,"user_name":"dst","can_delete":false,"product_type":"c1","uid":1861196,"ip_address":"陕西","ucode":"9177BBB6C8B905","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKx6EdicYYuYK745brMa9yAlkZs2YmzxRAm4BQ2kw9GbtcC8ebnQlyBfIJnGjH57ib4HVlQIpSbTrBw/132","comment_is_top":false,"comment_ctime":1659056129,"is_pvip":true,"replies":[{"id":"128322","content":"thanks。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659057368,"ip_address":"陕西","comment_id":352960,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5954023425","product_id":100114501,"comment_content":"终于到中级篇了，老师讲得很好，比较全面，尤其是画图的思维导图总结很实用","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581877,"discussion_content":"thanks。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659057368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352949,"user_name":"西门吹牛","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"陕西","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1659049865,"is_pvip":false,"replies":[{"id":"128325","content":"各人有各人的看法，最权威的就得看CNCF。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659060865,"ip_address":"陕西","comment_id":352949,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5954017161","product_id":100114501,"comment_content":"云原生三个字怎么理解","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581888,"discussion_content":"各人有各人的看法，最权威的就得看CNCF。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659060865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1521181,"avatar":"https://static001.geekbang.org/account/avatar/00/17/36/1d/874dc1e3.jpg","nickname":"你的笑忘书","note":"","ucode":"9665D5E9EDBEA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581974,"discussion_content":"云就是K8s，原生应用就是你用编程语言开发的应用。🫣上云那就是把你的原生应用托管到K8s中。云的方式不限制，公有云，私有云，以及混合云。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659093298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360699,"user_name":"安石","can_delete":false,"product_type":"c1","uid":1508755,"ip_address":"上海","ucode":"185AD0046CF1C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/93/3c3f2a6d.jpg","comment_is_top":false,"comment_ctime":1666766431,"is_pvip":false,"replies":[{"id":"131224","content":"可能是因为没有在worker节点上拷贝kubectl的config文件，如果拷贝了那么就行了。<br><br>注意kubectl和Kubernetes集群其实是彼此独立的，不能想当然认为Kubernetes集群节点上一定可以用kubectl，可以再看一下集群的网络结构图。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666772524,"ip_address":"上海","comment_id":360699,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1666766431","product_id":100114501,"comment_content":"我靠，这个问题困扰我好几天了<br>```<br>kubectl run ngx --image=nginx:alpine<br>```<br>这个命令式在master敲的，我一直在workder上敲<br>蠢哭了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591709,"discussion_content":"可能是因为没有在worker节点上拷贝kubectl的config文件，如果拷贝了那么就行了。\n\n注意kubectl和Kubernetes集群其实是彼此独立的，不能想当然认为Kubernetes集群节点上一定可以用kubectl，可以再看一下集群的网络结构图。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666772524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360562,"user_name":"老荀","can_delete":false,"product_type":"c1","uid":1214893,"ip_address":"上海","ucode":"C32E743518DECD","user_header":"https://static001.geekbang.org/account/avatar/00/12/89/ad/4efd929a.jpg","comment_is_top":false,"comment_ctime":1666663142,"is_pvip":true,"replies":[{"id":"131178","content":"要用kubectl就必须要拷贝.kube&#47;config文件，不管是在哪个节点上。<br><br>操作步骤就是kubeadm init之后的那几条命令，和master节点的类似。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666668911,"ip_address":"上海","comment_id":360562,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1666663142","product_id":100114501,"comment_content":"master 节点能显示正常<br>$ kubectl get node<br>NAME     STATUS   ROLES                  AGE     VERSION<br>master   Ready    control-plane,master   21m     v1.23.3<br>worker   Ready    &lt;none&gt;                 3m56s   v1.23.3<br><br>但是 worker 节点就显示<br>The connection to the server localhost:8080 was refused - did you specify the right host or port?<br><br>上面的教程里，worker 节点不就是提前下好镜像和 使用 join 加入集群吗？也没说要 拷贝 什么 配置文件啊，而且 worker 节点下 &#47;etc&#47;kubernetes 下也只有 kubelet.conf 这个配置文件，和 master 节点的不一样（admin.conf) 求助老师","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591577,"discussion_content":"要用kubectl就必须要拷贝.kube/config文件，不管是在哪个节点上。\n\n操作步骤就是kubeadm init之后的那几条命令，和master节点的类似。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666668911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360549,"user_name":"Anxuan","can_delete":false,"product_type":"c1","uid":2462391,"ip_address":"上海","ucode":"F807A526F56DE6","user_header":"https://static001.geekbang.org/account/avatar/00/25/92/b7/f3f9eba5.jpg","comment_is_top":false,"comment_ctime":1666630769,"is_pvip":true,"replies":[{"id":"131177","content":"在网上能够搜到一些，不过质量参差不齐，得自己鉴别一下了，建议学习的话还是用Ubuntu省事。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666668839,"ip_address":"上海","comment_id":360549,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1666630769","product_id":100114501,"comment_content":"有无大佬有centos安装文档","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591576,"discussion_content":"在网上能够搜到一些，不过质量参差不齐，得自己鉴别一下了，建议学习的话还是用Ubuntu省事。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666668839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2462391,"avatar":"https://static001.geekbang.org/account/avatar/00/25/92/b7/f3f9eba5.jpg","nickname":"Anxuan","note":"","ucode":"F807A526F56DE6","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591631,"discussion_content":"老师，master网络插件pod已经在running了，但是master状态还是notready，说是cni插件未初始化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666716028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591576,"ip_address":"广东"},"score":591631,"extra":""}]}]},{"had_liked":false,"id":360509,"user_name":"安石","can_delete":false,"product_type":"c1","uid":1508755,"ip_address":"上海","ucode":"185AD0046CF1C2","user_header":"https://static001.geekbang.org/account/avatar/00/17/05/93/3c3f2a6d.jpg","comment_is_top":false,"comment_ctime":1666605161,"is_pvip":false,"replies":[{"id":"131169","content":"感觉像是.kube目录里的config不对，是否正确拷贝了kubeadm初始化之后的配置文件？","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666610559,"ip_address":"上海","comment_id":360509,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1666605161","product_id":100114501,"comment_content":"console能正常获取worker node为ready状态，但是 run ngx的时候报错：<br>```<br> kubectl run ngx --image=nginx:alpine --v=5<br>W1024 17:51:09.689857   14003 loader.go:221] Config not found: &#47;etc&#47;kubernetes&#47;admin.conf<br>I1024 17:51:09.692504   14003 cached_discovery.go:121] skipped caching discovery info due to Get &quot;http:&#47;&#47;localhost:8080&#47;api?timeout=32s&quot;: dial tcp 127.0.0.1:8080: connect: connection refused<br>I1024 17:51:09.692585   14003 helpers.go:237] Connection error: Get http:&#47;&#47;localhost:8080&#47;api?timeout=32s: dial tcp 127.0.0.1:8080: connect: connection refused<br>The connection to the server localhost:8080 was refused - did you specify the right host or port?<br><br>```","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591521,"discussion_content":"感觉像是.kube目录里的config不对，是否正确拷贝了kubeadm初始化之后的配置文件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666610559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360211,"user_name":"哇哈哈","can_delete":false,"product_type":"c1","uid":1175537,"ip_address":"上海","ucode":"47453D1C96A1DD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/f1/8b06801a.jpg","comment_is_top":false,"comment_ctime":1666278900,"is_pvip":false,"replies":[{"id":"131015","content":"可能是.kube下面的config文件不对，检查一下。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666315987,"ip_address":"上海","comment_id":360211,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1666278900","product_id":100114501,"comment_content":"kubectl version执行提示“The connection to the server localhost:8080 was refused - did you specify the right host or port?”，但是 swap 的确已经关掉了，求解……","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591128,"discussion_content":"可能是.kube下面的config文件不对，检查一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666315987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360113,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"上海","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1666183271,"is_pvip":true,"replies":[{"id":"130997","content":"和master节点是一样的步骤。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1666232600,"ip_address":"上海","comment_id":360113,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1666183271","product_id":100114501,"comment_content":"worker 节点的 flannel 网络容器是怎么安装的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591026,"discussion_content":"和master节点是一样的步骤。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666232600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"Frank","note":"","ucode":"9DADD72C193296","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":591086,"discussion_content":"不行哦。  work 节点不能运行kubectl  apply -f ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666269000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591026,"ip_address":"四川"},"score":591086,"extra":""}]},{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"Frank","note":"","ucode":"9DADD72C193296","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591087,"discussion_content":"提示无法连接 APIserver ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666269048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359440,"user_name":"Xu.","can_delete":false,"product_type":"c1","uid":1817449,"ip_address":"北京","ucode":"7163195EA638FA","user_header":"https://static001.geekbang.org/account/avatar/00/1b/bb/69/a8bb7a4a.jpg","comment_is_top":false,"comment_ctime":1665544337,"is_pvip":false,"replies":[{"id":"130729","content":"应该是containerd吧，没有确切的数据，这些runtime都各有特点，没有绝对的好和坏。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665554346,"ip_address":"北京","comment_id":359440,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1665544337","product_id":100114501,"comment_content":"老师您好，我想问下现在生产环境中 container runtime 用 cri-o 多还是 containerd 多","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590143,"discussion_content":"应该是containerd吧，没有确切的数据，这些runtime都各有特点，没有绝对的好和坏。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665554346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359250,"user_name":"柳成荫","can_delete":false,"product_type":"c1","uid":2341748,"ip_address":"北京","ucode":"911F75C3D7AE02","user_header":"https://static001.geekbang.org/account/avatar/00/23/bb/74/edc07099.jpg","comment_is_top":false,"comment_ctime":1665374067,"is_pvip":true,"replies":[{"id":"130672","content":"个人感觉CentOS没有Ubuntu那么容易使用，对开发者不太友好，我用的比较少，sorry了。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665404736,"ip_address":"北京","comment_id":359250,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1665374067","product_id":100114501,"comment_content":"centos安装遇到了很多坑，worker节点加入后没有角色，不需要设置吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589937,"discussion_content":"个人感觉CentOS没有Ubuntu那么容易使用，对开发者不太友好，我用的比较少，sorry了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665404736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359121,"user_name":"MonsterCale","can_delete":false,"product_type":"c1","uid":1018253,"ip_address":"北京","ucode":"4B3C32DDDFEA37","user_header":"","comment_is_top":false,"comment_ctime":1665279226,"is_pvip":true,"replies":[{"id":"130645","content":"这个不应该啊，把worker删除重装试试吧。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665356068,"ip_address":"北京","comment_id":359121,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1665279226","product_id":100114501,"comment_content":"worker节点kubeadm join之后，worker节点上kubectl get nodes能看到master、worker节点，都Ready了<br>master节点kubectl get nodes只能看到master节点看不到worker节点，麻烦问下这是为什么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589840,"discussion_content":"这个不应该啊，把worker删除重装试试吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665356068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358876,"user_name":"西瓜","can_delete":false,"product_type":"c1","uid":1533190,"ip_address":"北京","ucode":"F6905075337E64","user_header":"https://static001.geekbang.org/account/avatar/00/17/65/06/9d997340.jpg","comment_is_top":false,"comment_ctime":1664958955,"is_pvip":true,"replies":[{"id":"130547","content":"great，解决问题的过程能够更好地学习Kubernetes，加深对它的认识。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665059964,"ip_address":"北京","comment_id":358876,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1664958955","product_id":100114501,"comment_content":"列一下自己flannel启动后节点还是not ready的解决过程<br>1、flannel daemonset和pod会启动在 kube-flannel namespace，使用命令 kubectl get ds -n kube-flannel 和 kubectl get pod -n kube-flannel 可以找到对应信息，而后使用 kubectl logs&#47;describle查看节点信息。<br>2、查看flannel 的pod列表发现其中一个未启动，查看日志Failed to pull image &quot;docker.io&#47;rancher&#47;mirrored-flannelcni-flannel:v0.19.2&quot;: rpc error: code = Unknown desc = Error response from daemon: Get &quot;https:&#47;&#47;registry-1.docker.io&#47;v2&#47;&quot;: net&#47;http: TLS handshake timeout<br>3、手动docker pull image  docker.io&#47;rancher&#47;mirrored-flannelcni-flannel:v0.19.2 尝试几次后成功，而后删除 flannel ds 和 pod，重新apply -f kube-flannel.yml <br>4、不行的话kubeadm reset重新配置一遍","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589527,"discussion_content":"great，解决问题的过程能够更好地学习Kubernetes，加深对它的认识。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665059964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358818,"user_name":"mamafeng","can_delete":false,"product_type":"c1","uid":3190249,"ip_address":"北京","ucode":"ED0AB11EAAC762","user_header":"https://static001.geekbang.org/account/avatar/00/30/ad/e9/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1664844965,"is_pvip":false,"replies":[{"id":"130536","content":"这个应该是没有正确拷贝kubeadm初始化的后的config文件吧，记得把config文件拷贝到kubectl所在的机器上，命令在kubeadm安装后有提示。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1664959300,"ip_address":"北京","comment_id":358818,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1664844965","product_id":100114501,"comment_content":"请问下老师，我使用 kubeadm init 之后正常启动了，但是使用 kubectl get node，出现的提示却是 “error: no server found for cluster &quot;minikube&quot;” , minikube之前都停止了，有人知道为什么吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589454,"discussion_content":"这个应该是没有正确拷贝kubeadm初始化的后的config文件吧，记得把config文件拷贝到kubectl所在的机器上，命令在kubeadm安装后有提示。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664959300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358125,"user_name":"alexgreenbar","can_delete":false,"product_type":"c1","uid":1003655,"ip_address":"北京","ucode":"87ED7233E2767C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/87/dde718fa.jpg","comment_is_top":false,"comment_ctime":1663924119,"is_pvip":true,"replies":[{"id":"130333","content":"这个不应该吧，也许是pod意外退出了。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1664006922,"ip_address":"北京","comment_id":358125,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663924119","product_id":100114501,"comment_content":"kubectl run ngx --image=nginx:alpine<br><br>安装成功有，尝试运行了nginx，检查了pod，一切正常，然后过了大概3个小时，再次检查了一下，发现nginx pod没有了，这是为啥？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588698,"discussion_content":"这个不应该吧，也许是pod意外退出了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664006922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357396,"user_name":"岁月长","can_delete":false,"product_type":"c1","uid":1297213,"ip_address":"北京","ucode":"CDD7BEC084AC51","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/3d/b290414d.jpg","comment_is_top":false,"comment_ctime":1663223377,"is_pvip":true,"replies":[{"id":"130079","content":"用describe看看pod的状态，是卡在了那个环节。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1663226701,"ip_address":"北京","comment_id":357396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663223377","product_id":100114501,"comment_content":"重启虚拟机之后，再运行  kubectl run ngx --image=nginx:alpine 发现 pod 一直是 pending 状态，不知道大家有没有遇到过这种情况？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587698,"discussion_content":"用describe看看pod的状态，是卡在了那个环节。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663226701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357328,"user_name":"Java-刘新漳","can_delete":false,"product_type":"c1","uid":2203253,"ip_address":"上海","ucode":"28F0BAA103CE6A","user_header":"https://static001.geekbang.org/account/avatar/00/21/9e/75/3ff9e7aa.jpg","comment_is_top":false,"comment_ctime":1663160224,"is_pvip":false,"replies":[{"id":"130064","content":"没有了解过，但这样的大厂商应该对Kubernetes有很多定制，kubeadm可能入不了眼，但最终的结果是一样的。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1663198704,"ip_address":"上海","comment_id":357328,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663160224","product_id":100114501,"comment_content":"老师，想问一下，像云厂商提供的企业级Kubernetes集群，比如像华为CCE（云容器引擎）是如何搭建的？也是通过kubeadm这种方式搭建的吗？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587646,"discussion_content":"没有了解过，但这样的大厂商应该对Kubernetes有很多定制，kubeadm可能入不了眼，但最终的结果是一样的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663198704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357224,"user_name":"wuyang","can_delete":false,"product_type":"c1","uid":1044517,"ip_address":"北京","ucode":"81000322FF96A7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f0/25/d3da7ca9.jpg","comment_is_top":false,"comment_ctime":1663078319,"is_pvip":true,"replies":[{"id":"130009","content":"good","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1663109746,"ip_address":"北京","comment_id":357224,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1663078319","product_id":100114501,"comment_content":"kubernetes的master和node都已正常运行<br>wuyang@master-1:~$ kubectl get node<br>NAME       STATUS   ROLES                  AGE     VERSION<br>master-1   Ready    control-plane,master   6h29m   v1.23.3<br>worker-1   Ready    &lt;none&gt;                 6h24m   v1.23.3<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587494,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663109746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357001,"user_name":"拾掇拾掇","can_delete":false,"product_type":"c1","uid":1051873,"ip_address":"北京","ucode":"D775F374C2A1D3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","comment_is_top":false,"comment_ctime":1662819331,"is_pvip":true,"replies":[{"id":"129910","content":"我也遇到过这种情况，只能把kube-system里的flannel重启了，比较麻烦。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662868183,"ip_address":"北京","comment_id":357001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662819331","product_id":100114501,"comment_content":"各位有没有遇到过，重启了虚拟机之后，网络插件pod就一直失败了，起不来了。。。等了很久也没自己恢复","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587176,"discussion_content":"我也遇到过这种情况，只能把kube-system里的flannel重启了，比较麻烦。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662868183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356974,"user_name":"黄马","can_delete":false,"product_type":"c1","uid":1019506,"ip_address":"北京","ucode":"93E391B4678EC2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/72/63c94eee.jpg","comment_is_top":false,"comment_ctime":1662771882,"is_pvip":true,"replies":[{"id":"129908","content":"我在Ubuntu上试验是没问题的，也许CentOS有一些特殊的设置，感谢经验分享。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662853587,"ip_address":"北京","comment_id":356974,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1662771882","product_id":100114501,"comment_content":"centos 7.9 <br><br>即使按照教程修改flannel.yml, 部署nginx，还是报错，如下<br><br>&#47;run&#47;flannel&#47;subnet.env: no such file or directory <br><br>需要在每个节点都添加<br><br>FLANNEL_NETWORK=10.244.0.0&#47;16<br>FLANNEL_SUBNET=10.244.0.1&#47;24<br>FLANNEL_MTU=1450<br>FLANNEL_IPMASQ=true<br><br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587156,"discussion_content":"我在Ubuntu上试验是没问题的，也许CentOS有一些特殊的设置，感谢经验分享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662853587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356716,"user_name":"xmr","can_delete":false,"product_type":"c1","uid":1009622,"ip_address":"北京","ucode":"1BBF165F91F10B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","comment_is_top":false,"comment_ctime":1662528014,"is_pvip":true,"replies":[{"id":"129832","content":"能上外网就简单多了，很多操作环节都可以省略。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662536203,"ip_address":"北京","comment_id":356716,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662528014","product_id":100114501,"comment_content":"方便上外网的话加google源：<br>curl -s https:&#47;&#47;packages.cloud.google.com&#47;apt&#47;doc&#47;apt-key.gpg | sudo apt-key add -<br><br>cat &lt;&lt;EOF | sudo tee &#47;etc&#47;apt&#47;sources.list.d&#47;kubernetes.list<br>deb http:&#47;&#47;apt.kubernetes.io&#47; kubernetes-xenial main<br>EOF","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586840,"discussion_content":"能上外网就简单多了，很多操作环节都可以省略。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662536203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356303,"user_name":"拾掇拾掇","can_delete":false,"product_type":"c1","uid":1051873,"ip_address":"北京","ucode":"D775F374C2A1D3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","comment_is_top":false,"comment_ctime":1662121448,"is_pvip":true,"replies":[{"id":"129690","content":"看看flannel是否工作正常，应该和taint没有关系。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662169944,"ip_address":"北京","comment_id":356303,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662121448","product_id":100114501,"comment_content":"master节点一直notready，删了taints还是notready，真的栓Q了<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586371,"discussion_content":"看看flannel是否工作正常，应该和taint没有关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662169945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356295,"user_name":"$侯","can_delete":false,"product_type":"c1","uid":1019939,"ip_address":"北京","ucode":"488B1BD3924E7E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/23/5c74e9b7.jpg","comment_is_top":false,"comment_ctime":1662114210,"is_pvip":false,"replies":[{"id":"129693","content":"需要理解Kubernetes的架构，kubelet调用容器运行时来创建容器，因为我们用的是docker，所以就是在docker里运行，Kubernetes只是管理调度容器，不关心是否是docker。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1662170103,"ip_address":"北京","comment_id":356295,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662114210","product_id":100114501,"comment_content":"老师，kubeadm init 安装好后也可以用docker ps命令看到运行的容器，那这些容器是在docekr中运行的还是在k8s中运行的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586374,"discussion_content":"需要理解Kubernetes的架构，kubelet调用容器运行时来创建容器，因为我们用的是docker，所以就是在docker里运行，Kubernetes只是管理调度容器，不关心是否是docker。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662170104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355959,"user_name":"kobe","can_delete":false,"product_type":"c1","uid":1165831,"ip_address":"北京","ucode":"AB8B599F3D5521","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","comment_is_top":false,"comment_ctime":1661868660,"is_pvip":true,"replies":[{"id":"129554","content":"这个应该是kubelet作为静态pod无法启动，健康检查出问题了，重启一下节点试试。 ","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661912380,"ip_address":"北京","comment_id":355959,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1661868660","product_id":100114501,"comment_content":"启动的时候卡在下面这里了，老师帮看下是什么原因呗：<br>[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;&#47;etc&#47;kubernetes&#47;manifests&quot;. This can take up to 4m0s<br>I0830 21:59:28.227253   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:28.727893   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:29.228213   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:29.728033   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:30.228033   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:30.756127   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:31.229119   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:31.728430   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:32.228035   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:32.728400   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:33.230932   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:33.742286   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:34.230284   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds<br>I0830 21:59:38.249748   16503 round_trippers.go:553] GET https:&#47;&#47;192.168.56.102:6443&#47;healthz?timeout=10s  in 0 milliseconds","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585931,"discussion_content":"这个应该是kubelet作为静态pod无法启动，健康检查出问题了，重启一下节点试试。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661912381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/64/a6/e5f674a9.jpg","nickname":"mh","note":"","ucode":"9179BBA1792CD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586035,"discussion_content":"我这边的问题是 kubeadm 之前安装的时候少了一个cri--tools导致报cgroup异常。 重新通过yum安装kubeadm后kubelet启动正常，再执行kubeadm init也正常了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661942701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/64/a6/e5f674a9.jpg","nickname":"mh","note":"","ucode":"9179BBA1792CD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586008,"discussion_content":"我这边也有这个情况，排查发现时kubelet服务没有起来，重启kubelet后发现启动失败，提示:failed to run Kubelet: misconfiguration: kubelet cgroup driver: &#34;cgroupfs&#34; is different from docker cgroup driver: &#34;systemd&#34; , 通过docker info 查看docker信息，对应Driver已经与之前配置是一致的：Storage Driver: overlay2  Logging Driver: json-file  Cgroup Driver: systemd  。 有哪位大神知道改怎么处理？ \n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661935163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165831,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","nickname":"kobe","note":"","ucode":"AB8B599F3D5521","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585968,"discussion_content":"我这个是执行kubeadm init的时候出现的 重启也没用 一直这样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661921277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355948,"user_name":"kobe","can_delete":false,"product_type":"c1","uid":1165831,"ip_address":"北京","ucode":"AB8B599F3D5521","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","comment_is_top":false,"comment_ctime":1661865526,"is_pvip":true,"replies":[{"id":"129558","content":"看docker image的名字是否与YAML 完全一样，另外就是每个节点都要预先下载，有可能pod调度到了没有镜像的节点。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661912561,"ip_address":"北京","comment_id":355948,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1661865526","product_id":100114501,"comment_content":"老师你好 我这也预先把镜像下载下来了 用docker images也看到了 但是在执行kubeadm init的时候还是会从k8s.gcr.io上去下载镜像 导致启动一直卡住 这个是什么原因啊<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585935,"discussion_content":"看docker image的名字是否与YAML 完全一样，另外就是每个节点都要预先下载，有可能pod调度到了没有镜像的节点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661912561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165831,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ca/07/22dd76bf.jpg","nickname":"kobe","note":"","ucode":"AB8B599F3D5521","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585969,"discussion_content":"我执行init的时候指定了镜像仓库就可以了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661921321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355768,"user_name":"骑着🚀看银河","can_delete":false,"product_type":"c1","uid":1074734,"ip_address":"上海","ucode":"8706A99A89F0CE","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","comment_is_top":false,"comment_ctime":1661739610,"is_pvip":true,"replies":[{"id":"129475","content":"如果reset失败可以考虑恢复虚拟机的快照。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661744005,"ip_address":"上海","comment_id":355768,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1661739610","product_id":100114501,"comment_content":"执行`kubeadm reset` 操作卡在这里不动了<br><br>ant@ant-vm:~&#47;workspace$ sudo kubeadm reset<br>[reset] Reading configuration from the cluster...<br>[reset] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;<br><br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585645,"discussion_content":"如果reset失败可以考虑恢复虚拟机的快照。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661744005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355171,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661152391,"is_pvip":true,"replies":[{"id":"129239","content":"是不是没有拷贝config文件？","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661176375,"ip_address":"北京","comment_id":355171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661152391","product_id":100114501,"comment_content":"请教老师个问题：<br>为什么在worker上执行`kubectl get pod`会得到连接服务器错误：<br>`The connection to the server localhost:8080 was refused - did you specify the right host or port?`<br>是因为worker不具备权限吗？那是不是说在worker上运行这条命令，本身就没有意义？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584874,"discussion_content":"是不是没有拷贝config文件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661176375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355126,"user_name":"陈四丰","can_delete":false,"product_type":"c1","uid":1610789,"ip_address":"北京","ucode":"A4463BFD52FB4F","user_header":"https://static001.geekbang.org/account/avatar/00/18/94/25/3bf277e5.jpg","comment_is_top":false,"comment_ctime":1661103608,"is_pvip":true,"replies":[{"id":"129233","content":"可以参考一下后面的视频课，对照一下哪些步骤有误。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661144574,"ip_address":"北京","comment_id":355126,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661103608","product_id":100114501,"comment_content":"请教：我在安装到worker join的时候出现了问题。<br>到了[preflight] Running pre-flight checks 就卡住了。后来用 &quot;--v=2&quot; 命令显示原因出现以下错误。<br>命令：<br>sudo kubeadm join --v=2 10.0.3.15:6443 --token mrs900.uf2fm5qbv08aqfiy --discovery-token-ca-cert-hash sha256:3fd27a63348669f3ce21746362c4a9031854c9e804a9a480871c0d601c85a584 <br><br>错误：<br>I0821 19:36:33.694450    3493 token.go:217] [discovery] Failed to request cluster-info, will try again: Get &quot;https:&#47;&#47;10.0.3.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info?timeout=10s&quot;: dial tcp 10.0.3.15:6443: connect: connection refused<br><br>访问被master拒绝了！！！可是master留给我的加入信息没错呀。<br>kubeadm join 10.0.3.15:6443 --token mrs900.uf2fm5qbv08aqfiy \\<br>\t--discovery-token-ca-cert-hash sha256:3fd27a63348669f3ce21746362c4a9031854c9e804a9a480871c0d601c85a584 <br><br>另外，我还注意到一点。这个join给的IP地址是10.0.x.x，而不是192.168.x.x。<br><br>卡在这里实在进行不下去了。请老师，同学们帮忙！<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584816,"discussion_content":"可以参考一下后面的视频课，对照一下哪些步骤有误。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661144574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355027,"user_name":"zahi","can_delete":false,"product_type":"c1","uid":1447887,"ip_address":"北京","ucode":"F64ABEB63C6D1F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","comment_is_top":false,"comment_ctime":1660985699,"is_pvip":true,"replies":[{"id":"129157","content":"用kubectl logs看看日志，如果有错误就删除pod重启。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1661040319,"ip_address":"北京","comment_id":355027,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1660985699","product_id":100114501,"comment_content":"kubectl apply -f flannel.yml  之后还是notReady状态， 看了下 flannel 的pod 是正常运行的，describe 也没看出异常。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584665,"discussion_content":"用kubectl logs看看日志，如果有错误就删除pod重启。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661040319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447887,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIofiaCAziajdQnbvrfpEkpCKVFgO62y6zicamhjF1BAWZSRcCVaTBXLIerLsGeZCic7XS7KOEkTN4fRg/132","nickname":"zahi","note":"","ucode":"F64ABEB63C6D1F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584964,"discussion_content":"\nlog 也没看出来有什么问题， 只有一个waring。\n\nW0823 09:47:40.400230       1 client_config.go:614] Neither --kubeconfig nor --master was specified.  Using the inClusterConfig.  This might not work.\n\n宿主机上也看到了flannel 的虚拟网卡，不过网络地址是 10.10.0.0/32, 这与我配置中 10.10.0.0/16 不一样，不知道是不是这个的问题。\n\n8: flannel.1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc noqueue state UNKNOWN group default\n    link/ether d6:c2:95:c1:5f:3f brd ff:ff:ff:ff:ff:ff\n    inet 10.10.0.0/32 scope global flannel.1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::d4c2:95ff:fec1:5f3f/64 scope link\n       valid_lft forever preferred_lft forever\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661248839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354970,"user_name":"Breeze","can_delete":false,"product_type":"c1","uid":2962899,"ip_address":"北京","ucode":"8B6711F5B9D112","user_header":"https://static001.geekbang.org/account/avatar/00/2d/35/d3/8de43dd5.jpg","comment_is_top":false,"comment_ctime":1660922048,"is_pvip":true,"replies":[{"id":"129124","content":"看样子是cni网络插件有问题，检查一下flannel的状态，重启试试。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1660956972,"ip_address":"北京","comment_id":354970,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660922048","product_id":100114501,"comment_content":"执行最后一步：kubectl run ngx --image=nginx:alpine时，pod启动不起来<br>Warning  FailedCreatePodSandBox  9s    kubelet  Failed to create pod sandbox: rpc error: code = Unknown desc = [failed to set up sandbox container &quot;d747752b65df694639aad0daed64c1b3c153e0d375b684b91d79c72a3701b536&quot; network for pod &quot;ngx&quot;: networkPlugin cni failed to set up pod &quot;ngx_default&quot; network: open &#47;run&#47;flannel&#47;subnet.env: no such file or directory, failed to clean up sandbox container &quot;d747752b65df694639aad0daed64c1b3c153e0d375b684b91d79c72a3701b536&quot; network for pod &quot;ngx&quot;: networkPlugin cni failed to teardown pod &quot;ngx_default&quot; network: invalid version &quot;&quot;: the version is empty]<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584585,"discussion_content":"看样子是cni网络插件有问题，检查一下flannel的状态，重启试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660956972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354879,"user_name":"扫地僧","can_delete":false,"product_type":"c1","uid":1129952,"ip_address":"上海","ucode":"EEDC2BA2FED1FF","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/e0/be2f1bf3.jpg","comment_is_top":false,"comment_ctime":1660842775,"is_pvip":false,"replies":[{"id":"129104","content":"看看flannel的pod是否正常，用describe、logs等命令。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1660890703,"ip_address":"上海","comment_id":354879,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660842775","product_id":100114501,"comment_content":"[root@master ~]# kubectl apply -f flannel.yml<br>podsecuritypolicy.policy&#47;psp.flannel.unprivileged created<br>clusterrole.rbac.authorization.k8s.io&#47;flannel created<br>clusterrolebinding.rbac.authorization.k8s.io&#47;flannel created<br>serviceaccount&#47;flannel created<br>configmap&#47;kube-flannel-cfg created<br>daemonset.apps&#47;kube-flannel-ds created<br>执行后，看着都是正常的，再执行[root@master ~]# kubectl get nodes<br>NAME     STATUS     ROLES    AGE   VERSION<br>master   NotReady   master   24m   v1.19.3<br>还是NotReady<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584520,"discussion_content":"看看flannel的pod是否正常，用describe、logs等命令。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660890703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354100,"user_name":"dao","can_delete":false,"product_type":"c1","uid":1087879,"ip_address":"北京","ucode":"4181FB270462CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","comment_is_top":false,"comment_ctime":1660097182,"is_pvip":true,"replies":[{"id":"128795","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1660108385,"ip_address":"北京","comment_id":354100,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660097182","product_id":100114501,"comment_content":"分享一个清华大学镜像 https:&#47;&#47;mirrors.tuna.tsinghua.edu.cn&#47;help&#47;kubernetes&#47;","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583415,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660108385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354062,"user_name":"ArcheanEon","can_delete":false,"product_type":"c1","uid":1989760,"ip_address":"北京","ucode":"02831EE928823C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/5c/80/d90e0151.jpg","comment_is_top":false,"comment_ctime":1660052839,"is_pvip":false,"replies":[{"id":"128792","content":"这个需要在查一下操作系统相关的资料了，在Ubuntu上是可以的。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1660092562,"ip_address":"北京","comment_id":354062,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1660052839","product_id":100114501,"comment_content":"准备工作第三点（修改 iptables 的配置，启用“br_netfilter”模块）<br>kernel.core_uses_pid = 1<br>net.ipv4.conf.default.rp_filter = 2<br>net.ipv4.conf.default.accept_source_route = 0<br>sysctl: setting key &quot;net.ipv4.conf.all.accept_source_route&quot;: 无效的参数<br>net.ipv4.conf.default.promote_secondaries = 1<br>sysctl: setting key &quot;net.ipv4.conf.all.promote_secondaries&quot;: 无效的参数<br>net.ipv4.ping_group_range = 0 2147483647<br>net.core.default_qdisc = fq_codel<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583388,"discussion_content":"这个需要在查一下操作系统相关的资料了，在Ubuntu上是可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660092562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1646052,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/e4/517fbbbf.jpg","nickname":"白芷","note":"","ucode":"D37530955CF919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589674,"discussion_content":"借楼，看了一下最后总结视频里也有的，不过是英文，所以应该没啥问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665227401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353819,"user_name":"DN","can_delete":false,"product_type":"c1","uid":1620299,"ip_address":"北京","ucode":"74BC2FB01FB89E","user_header":"https://static001.geekbang.org/account/avatar/00/18/b9/4b/2376a469.jpg","comment_is_top":false,"comment_ctime":1659838674,"is_pvip":false,"replies":[{"id":"128634","content":"应该是没有bash吧，用sh。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659872825,"ip_address":"北京","comment_id":353819,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659838674","product_id":100114501,"comment_content":"想请教一下老师，在master上 kubectl exec -it nginx-deployment-85658cc69f-l68tx -- &#47;bin&#47;bash 报错connect: connection refused， 但其他的命令 apply describe等都正常，有了解原因的吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583005,"discussion_content":"应该是没有bash吧，用sh。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659872825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353785,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"北京","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1659777939,"is_pvip":false,"replies":[{"id":"128630","content":"在用户目录下有一个隐藏目录.kube，里面是kubectl的配置文件，先把里面的config 做个备份，然后把kubeadm生成的config拷贝过来就行了。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659854863,"ip_address":"北京","comment_id":353785,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1659777939","product_id":100114501,"comment_content":"老师，现在遇到一个问题是，之前不是用minikube的时候装过kubectl吗？<br><br>这篇课程中又装了一次，现在用 执行命令： kubectl version --short<br><br>都会出现这个报这个错误：error: cluster &quot;minikube&quot; does not exist 。<br><br>你在评论区说：kubectl的config文件就得做个切换了。  我是要做这个切换吗？ 怎么切换呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582968,"discussion_content":"在用户目录下有一个隐藏目录.kube，里面是kubectl的配置文件，先把里面的config 做个备份，然后把kubeadm生成的config拷贝过来就行了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659854864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":583057,"discussion_content":"好，我好像是按照课程的操作步骤来的。今天再试试看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659888340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":582968,"ip_address":"广东"},"score":583057,"extra":""}]}]},{"had_liked":false,"id":353560,"user_name":"微客鸟窝","can_delete":false,"product_type":"c1","uid":1725209,"ip_address":"上海","ucode":"27D37AD921EC5D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/53/19/d21d256f.jpg","comment_is_top":false,"comment_ctime":1659565544,"is_pvip":false,"replies":[{"id":"128557","content":"加上-v参数，看有没有调试信息输出。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659579239,"ip_address":"上海","comment_id":353560,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659565544","product_id":100114501,"comment_content":"请问kubeadm init执行后，没有任何输出，直接运行结束了，这是什么情况？怎么排查一下错误呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582654,"discussion_content":"加上-v参数，看有没有调试信息输出。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659579239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353343,"user_name":"yhtyht308","can_delete":false,"product_type":"c1","uid":1230354,"ip_address":"北京","ucode":"9A054290B8B284","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/dotGbXAlAZg0bhCq4P96A40mdyavzR33jSqIHk8xLlic4B5PYNDIP5MEa1Fk9yxzdz9scHUM7IUNR71nVZNoV7Q/132","comment_is_top":false,"comment_ctime":1659368397,"is_pvip":false,"replies":[{"id":"128462","content":"是不是worker节点上没安装kubectl等其他组件？","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659405745,"ip_address":"北京","comment_id":353343,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1659368397","product_id":100114501,"comment_content":"安装worker节点，执行<br>sudo \\<br>kubeadm join 192.168.10.210:6443 --token tv9mkx.tw7it9vphe158e74 \\<br>  --discovery-token-ca-cert-hash sha256:e8721b8630d5b562e23c010c70559a6d3084f629abad6a2920e87855f8fb96f3后，<br>kubectl get node显示：“The connection to the server localhost:8080 was refused ”","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582350,"discussion_content":"是不是worker节点上没安装kubectl等其他组件？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1230354,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/dotGbXAlAZg0bhCq4P96A40mdyavzR33jSqIHk8xLlic4B5PYNDIP5MEa1Fk9yxzdz9scHUM7IUNR71nVZNoV7Q/132","nickname":"yhtyht308","note":"","ucode":"9A054290B8B284","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582420,"discussion_content":"手动把master的admin.conf复制并覆盖worker节点上.kube/config，并更改文件权限就OK了。应该在kubeadm join时会自动生成的，但试了几次都不会，不知是不是因为使用的用户不是&#39;root&#39;的原因？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659430197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1989760,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/5c/80/d90e0151.jpg","nickname":"ArcheanEon","note":"","ucode":"02831EE928823C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583803,"discussion_content":"官方文档有提示\nscp root@&lt;control-plane-host&gt;:/etc/kubernetes/admin.conf .\nkubectl --kubeconfig ./admin.conf get nodes\n觉得麻烦可以再配置下\necho &#34;export KUBECONFIG=/etc/kubernetes/admin.conf&#34; &gt;&gt; ~/.bash_profile\nsource ~/.bash_profile","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660393038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2898675,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","nickname":"努力学习不准懈怠","note":"","ucode":"60D2C77230655F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582355,"discussion_content":"这个是没有创建.kube文件导致的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659406881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"安徽"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353312,"user_name":"romance","can_delete":false,"product_type":"c1","uid":1029768,"ip_address":"北京","ucode":"393DC641CCE86E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/88/e8deccbc.jpg","comment_is_top":false,"comment_ctime":1659345994,"is_pvip":false,"replies":[{"id":"128458","content":"没问题，可以的。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659405470,"ip_address":"北京","comment_id":353312,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659345994","product_id":100114501,"comment_content":"老师，我实验环境直接把master节点当作console用，就不需要再额外做什么配置了是吧？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582346,"discussion_content":"没问题，可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659405470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353168,"user_name":"潜光隐耀","can_delete":false,"product_type":"c1","uid":1809457,"ip_address":"北京","ucode":"8A2FDDEFCB1863","user_header":"https://static001.geekbang.org/account/avatar/00/1b/9c/31/e4677275.jpg","comment_is_top":false,"comment_ctime":1659230675,"is_pvip":false,"replies":[{"id":"128407","content":"我想暂时应该不会，对于我们普通Kubernetes用户来说，下层的runtime是什么不应该关心，用起来都一样。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659270498,"ip_address":"北京","comment_id":353168,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659230675","product_id":100114501,"comment_content":"请问会加餐一个使用containerd的章节吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582159,"discussion_content":"我想暂时应该不会，对于我们普通Kubernetes用户来说，下层的runtime是什么不应该关心，用起来都一样。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659270498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353155,"user_name":"vapour","can_delete":false,"product_type":"c1","uid":2067353,"ip_address":"北京","ucode":"9972E95E64ACA4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4W98d4DBz5DnDZG4ib2KZzj82ibB1zuAeRMcA4e5iaq5BXkW7HU6KHiaewOypkmbTUItP5mopooEcr6fyXEDwIVHKg/132","comment_is_top":false,"comment_ctime":1659196026,"is_pvip":true,"replies":[{"id":"128406","content":"当然，它只是一个逻辑概念。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659270447,"ip_address":"北京","comment_id":353155,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659196026","product_id":100114501,"comment_content":"Console 节点是否不是必须的呢？直接使用master节点也可以吧","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582158,"discussion_content":"当然，它只是一个逻辑概念。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659270447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353091,"user_name":"romance","can_delete":false,"product_type":"c1","uid":1029768,"ip_address":"陕西","ucode":"393DC641CCE86E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/88/e8deccbc.jpg","comment_is_top":false,"comment_ctime":1659154444,"is_pvip":false,"replies":[{"id":"128396","content":"像是文件系统的问题，给不出具体的解决方案，只能网上搜索看看了。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659174460,"ip_address":"陕西","comment_id":353091,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659154444","product_id":100114501,"comment_content":"老师，我 kubeadm init 成功后，系统重启就提示 &#47;dev&#47;sda3:clean, XXX files, XXX blocks了，一直无法重启，不知道什么原因","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582064,"discussion_content":"像是文件系统的问题，给不出具体的解决方案，只能网上搜索看看了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353088,"user_name":"白云外","can_delete":false,"product_type":"c1","uid":1123378,"ip_address":"陕西","ucode":"403268BB9AEE26","user_header":"https://static001.geekbang.org/account/avatar/00/11/24/32/a82da906.jpg","comment_is_top":false,"comment_ctime":1659153710,"is_pvip":true,"replies":[{"id":"128395","content":"这个不应该吧，看看是不是版本不对。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659174403,"ip_address":"陕西","comment_id":353088,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659153710","product_id":100114501,"comment_content":"请教一下各位，为什么我已经把镜像拉取到本地了（名称、tag都确认了），结果在init时仍然会去远程拉取，然后就报超时错误了。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582063,"discussion_content":"这个不应该吧，看看是不是版本不对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659174403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353014,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"北京","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659079110,"is_pvip":true,"replies":[{"id":"128362","content":"要拷贝config文件到当前的.kube目录下才行。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659081931,"ip_address":"北京","comment_id":353014,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1659079110","product_id":100114501,"comment_content":"kubeadm init 成功后 kubectl get node 报错error: no server found for cluster &quot;minikube&quot;<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581950,"discussion_content":"要拷贝config文件到当前的.kube目录下才行。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659081931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2988749,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/1iaEzwaAJCf7Jk0uMia0g5Jh6NypbSicjK5zn6FH2rd2w3UbO9Qia7V1pMXEkpXQjj0CMnDJ3S5Q9YibWnyficD6akXA/132","nickname":"Ivan","note":"","ucode":"7A40D8B47717CB","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":583821,"discussion_content":"是master节点拷贝嘛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660405099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":581950,"ip_address":"广东"},"score":583821,"extra":""}]}]},{"had_liked":false,"id":353012,"user_name":"努力学习不准懈怠","can_delete":false,"product_type":"c1","uid":2898675,"ip_address":"陕西","ucode":"60D2C77230655F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJo05FofKFWYN3joX4OyCfVrU2kK7xvKdZ4Ho7bof893fE0jXk1OcB5sKLk4C1SviaNlibAiaCtp8aww/132","comment_is_top":false,"comment_ctime":1659076878,"is_pvip":true,"replies":[{"id":"128370","content":"确认操作系统版本，准备工作都做齐了，可能还是哪个步骤没做好。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659098618,"ip_address":"陕西","comment_id":353012,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1659076878","product_id":100114501,"comment_content":"安装失败了，报错信息如下，应该怎么解决呢<br>Unfortunately, an error has occurred:<br>\t\ttimed out waiting for the condition<br><br>\tThis error is likely caused by:<br>\t\t- The kubelet is not running<br>\t\t- The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)<br><br>\tIf you are on a systemd-powered system, you can try to troubleshoot the error with the following commands:<br>\t\t- &#39;systemctl status kubelet&#39;<br>\t\t- &#39;journalctl -xeu kubelet&#39;<br><br>\tAdditionally, a control plane component may have crashed or exited when started by the container runtime.<br>\tTo troubleshoot, list all containers using your preferred container runtimes CLI.<br><br>\tHere is one example how you may list all Kubernetes containers running in docker:<br>\t\t- &#39;docker ps -a | grep kube | grep -v pause&#39;<br>\t\tOnce you have found the failing container, you can inspect its logs with:<br>\t\t- &#39;docker logs CONTAINERID&#39;<br><br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581984,"discussion_content":"确认操作系统版本，准备工作都做齐了，可能还是哪个步骤没做好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659098618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"陕西"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009622,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","nickname":"xmr","note":"","ucode":"1BBF165F91F10B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586830,"discussion_content":"--apiserver-advertise-address要改为master主机的ip","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1662533203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2902096,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/48/50/d44bc924.jpg","nickname":"WalkRun","note":"","ucode":"24CBA276EC1513","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1009622,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg","nickname":"xmr","note":"","ucode":"1BBF165F91F10B","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":586856,"discussion_content":"研究了两天  果然改成master主机的ip就好了  网络架构还是没搞清楚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662541532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":586830,"ip_address":"江苏"},"score":586856,"extra":""}]},{"author":{"id":1849608,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/39/08/8b765174.jpg","nickname":"王浩","note":"","ucode":"CB8AEE94284882","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583903,"discussion_content":"我也遇到过相同的警告，因为--apiserver-advertise-address写错了，照抄了课件里的，reset后重新init就好了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660480530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"美国"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}