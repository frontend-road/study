{"id":435583,"title":"23 | Spark MLlibï¼šä»â€œæˆ¿ä»·é¢„æµ‹â€å¼€å§‹","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>ä»ä»Šå¤©è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬è¿›å…¥è¯¾ç¨‹çš„ç¬¬ä¸‰ä¸ªæ¨¡å—ï¼šSpark MLlibæœºå™¨å­¦ä¹ ã€‚åœ¨æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ ä¸äººå·¥æ™ºèƒ½ç«çƒ­çš„å½“ä¸‹ï¼Œç§¯ç´¯ä¸€äº›æœºå™¨å­¦ä¹ çš„çŸ¥è¯†å‚¨å¤‡ï¼Œæœ‰åˆ©äºæˆ‘ä»¬æ‹“å±•è§†é‡ï¼Œç”šè‡³ä¸ºèŒä¸šå‘å±•æä¾›æ–°çš„æ”¯ç‚¹ã€‚</p><p>åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä»ä¸€ä¸ªâ€œæˆ¿ä»·é¢„æµ‹â€çš„å°é¡¹ç›®å…¥æ‰‹ï¼Œæ¥åˆæ­¥äº†è§£æœºå™¨å­¦ä¹ ä»¥åŠSpark MLlibçš„åŸºæœ¬ç”¨æ³•ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šç€é‡è®²è§£æœºå™¨å­¦ä¹ çš„ä¸¤ä¸ªå…³é”®ç¯èŠ‚ï¼šç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹è°ƒä¼˜ï¼Œåœ¨æ·±å…¥å­¦ä¹ Spark MLlibçš„åŒæ—¶ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–â€œæˆ¿ä»·é¢„æµ‹â€çš„æ¨¡å‹æ•ˆæœï¼Œä»è€Œè®©æˆ¿ä»·çš„é¢„æµ‹è¶Šæ¥è¶Šå‡†ã€‚</p><p>ç†Ÿæ‚‰äº†å…³é”®ç¯èŠ‚ä¹‹åï¼Œæˆ‘ä»¬å†å»æ¢è®¨ï¼Œåœ¨Spark MLlibçš„æ¡†æ¶ä¹‹ä¸‹ï¼Œé«˜æ•ˆæ„å»ºæœºå™¨å­¦ä¹ æµæ°´çº¿çš„ä¸€èˆ¬æ–¹æ³•ã€‚å¥½å•¦ï¼Œè¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬å…ˆæ¥ä¸€èµ·çœ‹çœ‹â€œæˆ¿ä»·é¢„æµ‹â€è¿™ä¸ªå°é¡¹ç›®å§ã€‚</p><p>ä¸ºå…¼é¡¾é¡¹ç›®çš„æƒå¨æ€§ä¸ä»£è¡¨æ€§ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†Kaggleï¼ˆæ•°æ®ç§‘å­¦ç«èµ›å¹³å°ï¼‰çš„â€œ<a href=\"https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview\">House Prices - Advanced Regression Techniques</a>â€ç«èµ›é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®çš„è¦æ±‚æ˜¯ï¼Œç»™å®šæˆ¿å±‹çš„79ä¸ªå±æ€§ç‰¹å¾ä»¥åŠå†å²æˆ¿ä»·ï¼Œè®­ç»ƒæˆ¿ä»·é¢„æµ‹æ¨¡å‹ï¼Œå¹¶åœ¨æµ‹è¯•é›†ä¸ŠéªŒè¯æ¨¡å‹çš„é¢„æµ‹æ•ˆæœã€‚</p><h2>æ•°æ®å‡†å¤‡</h2><p>è™½ç„¶é¡¹ç›®çš„è¦æ±‚ç›¸å½“æ¸…æ™°æ˜äº†ï¼Œä¸è¿‡ä½ å¯èƒ½ä¼šè¯´ï¼šâ€œæˆ‘æ²¡æœ‰æœºå™¨å­¦ä¹ èƒŒæ™¯ï¼Œä¸Šé¢æåˆ°è¿™äº›ä»€ä¹ˆç‰¹å¾å•Šã€æ¨¡å‹å•Šï¼Œè¿˜æœ‰æµ‹è¯•é›†ã€æ•ˆæœéªŒè¯ï¼Œæˆ‘éƒ½æ²¡æœ‰æ¦‚å¿µï¼Œé‚£æ¥ä¸‹æ¥çš„è¯¾ç¨‹ï¼Œè¦æ€ä¹ˆå­¦å‘¢ï¼Ÿâ€åˆ«æ‹…å¿ƒï¼Œéšç€è¯¾ç¨‹çš„æ¨è¿›ï¼Œæˆ‘ä¼šé€æ¸æŠŠè¿™äº›æ¦‚å¿µç»™ä½ è®²æ¸…æ¥šã€‚</p><!-- [[[read_end]]] --><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆç›´è§‚äº†è§£ä¸€ä¸‹é¡¹ç›®ä¸­çš„æˆ¿å±‹æ•°æ®ã€‚</p><p>æˆ¿å±‹æ•°æ®è®°å½•ç€ç¾å›½çˆ±è·åå·2006å¹´åˆ°2010å¹´çš„æˆ¿å±‹äº¤æ˜“æ•°æ®ï¼Œå…¶ä¸­åŒ…å«ç€79ä¸ªæˆ¿å±‹å±æ€§ä»¥åŠå½“æ—¶çš„æˆäº¤ä»·æ ¼ï¼Œä½ å¯ä»¥é€šè¿‡<a href=\"https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data\">ç«èµ›é¡¹ç›®çš„dataé¡µé¢</a>è¿›è¡Œä¸‹è½½ã€‚</p><p>æ•°æ®ä¸‹è½½ã€è§£å‹ä¹‹åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°4ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯data_description.txtã€train.csvã€test.csvå’Œsample_submission.csvã€‚è¿™4ä¸ªæ–‡ä»¶çš„ä½“é‡å¾ˆå°ï¼Œæ€»å¤§å°ä¸è¶…è¿‡5MBï¼Œå®ƒä»¬çš„å†…å®¹ä¸å«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/08/07/08f32643a5145a2c612296c76ea7ba07.jpg?wh=1920x681\" alt=\"å›¾ç‰‡\" title=\"æˆ¿å±‹æ•°æ®ä¸­çš„ä¸åŒæ–‡ä»¶\"></p><p>å…¶ä¸­ï¼Œtrain.csvä¸test.csvçš„Schemaå®Œå…¨ä¸€è‡´ï¼Œéƒ½åŒ…å«79ä¸ªæˆ¿å±‹å±æ€§å­—æ®µä»¥åŠä¸€ä¸ªäº¤æ˜“ä»·æ ¼å­—æ®µï¼Œæè¿°æ–‡ä»¶åˆ™è¯¦ç»†åœ°è®°å½•ç€79ä¸ªå­—æ®µçš„å«ä¹‰ä¸å–å€¼èŒƒå›´ã€‚äºŒè€…çš„å”¯ä¸€åŒºåˆ«åœ¨äºç”¨é€”ï¼Œ<strong>train.csvç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œè€Œtest.csvç”¨äºéªŒè¯æ¨¡å‹æ•ˆæœ</strong>ã€‚<br>\nsample_submission.csvæ–‡ä»¶åˆ™ç”¨äºæäº¤æ¯”èµ›ç»“æœï¼Œç”±äºå’±ä»¬æš‚æ—¶ä¸æ‰“ç®—å‚èµ›ï¼Œå› æ­¤è¿™ä¸ªæ–‡ä»¶å¯ä»¥æš‚æ—¶å¿½ç•¥ã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åˆæåˆ°äº†ä¸æœºå™¨å­¦ä¹ æœ‰å…³çš„ä¸€äº›æœ¯è¯­ï¼Œå¦‚â€œè®­ç»ƒæ•°æ®â€ã€â€œæµ‹è¯•æ•°æ®â€ã€â€œæ¨¡å‹æ•ˆæœâ€ï¼Œç­‰ç­‰ã€‚ä¸ºäº†ç…§é¡¾ç¼ºå°‘æœºå™¨å­¦ä¹ èƒŒæ™¯çš„åŒå­¦ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹æœºå™¨åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚</p><h2>æœºå™¨å­¦ä¹ ç®€ä»‹</h2><p>ä¸è¿‡ï¼Œåœ¨å»æ­£å¼ä»‹ç»æœºå™¨å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆæ¥æƒ³ä¸€æƒ³äººç±»å­¦ä¹ çš„è¿‡ç¨‹ï¼Œç„¶åå†æ¥çœ‹çœ‹ï¼Œåœ¨å­¦ä¹ è¿™æ–¹é¢ï¼Œæœºå™¨ä¸äººç±»æœ‰å“ªäº›ç›¸ä¼¼ä¹‹å¤„ã€‚</p><p>æ¯ä¸ªäººåœ¨æˆé•¿çš„è¿‡ç¨‹ä¸­ï¼Œæˆ–æ˜¯é€šè¿‡ä¹¦æœ¬ï¼Œæˆ–æ˜¯ç»“åˆè¿‡å¾€çš„ç»å†ï¼Œéƒ½åœ¨ä¸æ–­åœ°å¸å–ç»éªŒæ•™è®­ï¼Œä»è€Œæ€»ç»“å‡ºä¸ºäººå¤„ä¸–ã€å¾…äººæ¥ç‰©çš„ä¸€èˆ¬åŸåˆ™ï¼Œç„¶åå†å°†è¿™äº›åŸåˆ™åº”ç”¨åˆ°ä½™ä¸‹çš„äººç”Ÿä¸­å»ã€‚äººç±»å­¦ä¹ ä¸æˆé•¿çš„è¿‡ç¨‹ï¼Œå¤§æŠµå¦‚æ­¤ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/04/86/0475f3a03cbcd54712c90ab23b4dbd86.jpg?wh=1920x1183\" alt=\"å›¾ç‰‡\"></p><p>å®é™…ä¸Šï¼Œæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚åŸºäºå†å²æ•°æ®ï¼Œæœºå™¨ä¼šæ ¹æ®ä¸€å®šçš„ç®—æ³•ï¼Œå°è¯•ä»å†å²æ•°æ®ä¸­æŒ–æ˜å¹¶æ•æ‰å‡ºä¸€èˆ¬è§„å¾‹ã€‚ç„¶åï¼Œå†æŠŠæ‰¾åˆ°çš„è§„å¾‹åº”ç”¨åˆ°æ–°äº§ç”Ÿçš„æ•°æ®ä¸­ï¼Œä»è€Œå®ç°åœ¨æ–°æ•°æ®ä¸Šçš„é¢„æµ‹ä¸åˆ¤æ–­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/45/15/45404c2aca2d370d5174bab39735c215.jpg?wh=1920x1335\" alt=\"å›¾ç‰‡\"></p><p>å¥½å•¦ï¼Œå¯¹äºæœºå™¨å­¦ä¹ æœ‰äº†åŸºæœ¬çš„è®¤çŸ¥ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œ æˆ‘ä»¬å°±ç»™å®ƒä¸‹ä¸€ä¸ªæ­£å¼çš„å®šä¹‰ï¼Œä»è€Œä»¥æ›´åŠ ä¸¥è°¨çš„æ–¹å¼ï¼Œæ¥è®¤è¯†æœºå™¨å­¦ä¹ ã€‚</p><p>æ‰€è°“æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰ï¼Œå®ƒæŒ‡çš„æ˜¯è¿™æ ·ä¸€ç§è®¡ç®—è¿‡ç¨‹ï¼šå¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®ï¼ˆTraining samplesï¼‰ï¼Œé€‰æ‹©ä¸€ç§å…ˆéªŒçš„æ•°æ®åˆ†å¸ƒæ¨¡å‹ï¼ˆModelsï¼‰ï¼Œç„¶åå€ŸåŠ©ä¼˜åŒ–ç®—æ³•ï¼ˆLearning Algorithmsï¼‰è‡ªåŠ¨åœ°æŒç»­è°ƒæ•´æ¨¡å‹å‚æ•°ï¼ˆModel Weights / Parametersï¼‰ï¼Œä»è€Œè®©æ¨¡å‹ä¸æ–­é€¼è¿‘è®­ç»ƒæ•°æ®çš„åŸå§‹åˆ†å¸ƒã€‚</p><p>è¿™ä¸ªæŒç»­è°ƒæ•´æ¨¡å‹å‚æ•°çš„è¿‡ç¨‹ç§°ä¸ºâ€œæ¨¡å‹è®­ç»ƒâ€ï¼ˆModel Trainingï¼‰ã€‚æ¨¡å‹çš„è®­ç»ƒä¾èµ–äºä¼˜åŒ–ç®—æ³•ï¼ŒåŸºäºè¿‡å¾€çš„è®¡ç®—è¯¯å·®ï¼ˆLossï¼‰ï¼Œä¼˜åŒ–ç®—æ³•ä»¥ä¸æ–­è¿­ä»£çš„æ–¹å¼ï¼Œè‡ªåŠ¨åœ°å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œè°ƒæ•´ã€‚ç”±äºæ¨¡å‹è®­ç»ƒæ˜¯ä¸€ä¸ªæŒç»­ä¸æ–­çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆè‡ªç„¶å°±éœ€è¦ä¸€ä¸ªæ”¶æ•›æ¡ä»¶ï¼ˆConvergence Conditionsï¼‰ï¼Œæ¥ç»ˆç»“æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚ä¸€æ—¦æ”¶æ•›æ¡ä»¶è§¦å‘ï¼Œå³å®£å‘Šæ¨¡å‹è®­ç»ƒå®Œæ¯•ã€‚</p><p>æ¨¡å‹è®­ç»ƒå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¾€å¾€ä¼šç”¨ä¸€ä»½æ–°çš„æ•°æ®é›†ï¼ˆTesting samplesï¼‰ï¼Œå»æµ‹è¯•æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ï¼Œä»è€ŒéªŒè¯æ¨¡å‹çš„è®­ç»ƒæ•ˆæœï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬æŠŠå®ƒå«ä½œâ€œæ¨¡å‹æµ‹è¯•â€ï¼ˆModel Testingï¼‰ã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œä½ çš„å¤§è„‘å¯èƒ½å¿«è¢«å„ç§å„æ ·çš„æœºå™¨å­¦ä¹ æœ¯è¯­æŒ¤çˆ†äº†ï¼Œä¸è¦ç´§ï¼Œæˆ‘ä»¬ç»“åˆæˆ¿ä»·é¢„æµ‹çš„ä¾‹å­ï¼Œæ¥æ›´å¥½åœ°ç†è§£è¿™äº›æ¦‚å¿µã€‚</p><p>å›é¡¾æˆ¿ä»·é¢„æµ‹é¡¹ç›®çš„4ä¸ªæ•°æ®æ–‡ä»¶ï¼Œå…¶ä¸­çš„train.csvå°±æ˜¯æˆ‘ä»¬è¯´çš„è®­ç»ƒæ•°æ®ï¼ˆTraining samplesï¼‰ï¼Œå®ƒç”¨äºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ç›¸åº”åœ°ï¼Œtest.csvæ˜¯æµ‹è¯•æ•°æ®ï¼ˆTesting samplesï¼‰ï¼Œå®ƒç”¨äºéªŒè¯æˆ‘ä»¬æ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚</p><p>æ›´ä¸¥è°¨åœ°è¯´ï¼Œ<strong>æµ‹è¯•æ•°æ®ç”¨äºè€ƒå¯Ÿæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼ˆGeneralizationï¼‰</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä»½æ¨¡å‹ä»æ¥æ²¡æœ‰â€œçœ‹è§è¿‡â€çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œæ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ä¸å®ƒåœ¨è®­ç»ƒæ•°æ®ä¸Šçš„è¡¨ç°æ˜¯å¦ä¸€è‡´ã€‚</p><p>train.csvå’Œtest.csvè¿™ä¸¤ä¸ªæ–‡ä»¶çš„Schemaå®Œå…¨ä¸€è‡´ï¼Œéƒ½åŒ…å«81ä¸ªå­—æ®µï¼Œé™¤äº†å…¶ä¸­çš„79ä¸ªæˆ¿å±‹å±æ€§ä¸1ä¸ªäº¤æ˜“ä»·æ ¼å¤–ï¼Œè¿˜åŒ…å«ä¸€ä¸ªIDå­—æ®µã€‚åœ¨æˆ¿ä»·é¢„æµ‹è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯äº‹å…ˆé€‰å®šä¸€ä¸ªæ•°æ®åˆ†å¸ƒæ¨¡å‹ï¼ˆModelsï¼‰ï¼Œç„¶ååœ¨è®­ç»ƒæ•°æ®ä¸Šå¯¹å®ƒè¿›è¡Œè®­ç»ƒï¼ˆModel Trainingï¼‰ï¼Œæ¨¡å‹å‚æ•°æ”¶æ•›ä¹‹åï¼Œå†ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå»æµ‹è¯•é›†ä¸ŠæŸ¥çœ‹å®ƒçš„è®­ç»ƒæ•ˆæœã€‚</p><h2>æˆ¿ä»·é¢„æµ‹</h2><p>ç†è®ºæ€»æ˜¯æ²¡æœ‰å®æˆ˜æ¥çš„æ›´ç›´æ¥ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å€ŸåŠ©Spark MLlibæœºå™¨å­¦ä¹ æ¡†æ¶ï¼Œå»å®Œæˆâ€œæˆ¿ä»·é¢„æµ‹â€è¿™ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®çš„å®ç°ã€‚ä¸æ­¤åŒæ—¶ï¼Œéšç€é¡¹ç›®çš„æ¨è¿›ï¼Œæˆ‘ä»¬å†ç»“åˆå…·ä½“å®ç°æ¥æ·±å…¥ç†è§£åˆšåˆšæåˆ°çš„åŸºæœ¬æ¦‚å¿µä¸å¸¸ç”¨æœ¯è¯­ã€‚</p><h3>æ¨¡å‹é€‰å‹</h3><p>é‚£ä¹ˆéƒ½æœ‰å“ªäº›æ¨¡å‹å¯ä¾›æˆ‘ä»¬é€‰æ‹©å‘¢ï¼Ÿå¯¹äºæˆ¿ä»·é¢„æµ‹çš„é¡¹ç›®ï¼Œæˆ‘ä»¬åˆè¯¥é€‰æ‹©å…¶ä¸­å“ªä¸€ä¸ªå‘¢ï¼Ÿåƒè¿™ç§å¦‚ä½•æŒ‘é€‰åˆé€‚æ¨¡å‹çš„é—®é¢˜ï¼Œæˆ‘ä»¬ç»Ÿä¸€æŠŠå®ƒç§°ä½œâ€œæ¨¡å‹é€‰å‹â€ã€‚</p><p>åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæ¨¡å‹çš„ç§ç±»éå¸¸å¤šï¼Œä¸ä»…å¦‚æ­¤ï¼Œæ¨¡å‹çš„åˆ†ç±»æ–¹æ³•ä¹Ÿå„æœ‰ä¸åŒã€‚æŒ‰ç…§æ‹Ÿåˆèƒ½åŠ›æ¥åˆ†ç±»ï¼Œæœ‰çº¿æ€§æ¨¡å‹ä¸éçº¿æ€§æ¨¡å‹ä¹‹åˆ†ï¼›æŒ‰ç…§é¢„æµ‹æ ‡çš„æ¥åˆ’åˆ†ï¼Œæœ‰å›å½’ã€åˆ†ç±»ã€èšç±»ã€æŒ–æ˜ä¹‹åˆ†ï¼›æŒ‰ç…§æ¨¡å‹å¤æ‚åº¦æ¥åŒºåˆ†ï¼Œæ¨¡å‹å¯ä»¥åˆ†ä¸ºç»å…¸ç®—æ³•ä¸æ·±åº¦å­¦ä¹ ï¼›æŒ‰ç…§æ¨¡å‹ç»“æ„æ¥è¯´ï¼Œåˆå¯ä»¥åˆ†ä¸ºå¹¿ä¹‰çº¿æ€§æ¨¡å‹ã€æ ‘æ¨¡å‹ã€ç¥ç»ç½‘ç»œï¼Œç­‰ç­‰ã€‚å¦‚æ­¤ç§ç§ï¼Œä¸ä¸€è€Œè¶³ã€‚</p><p>ä¸è¿‡ï¼Œå’±ä»¬å­¦ä¹ çš„é‡ç‚¹æ˜¯å…¥é—¨æœºå™¨å­¦ä¹ ã€å…¥é—¨Spark MLlibï¼Œå› æ­¤ï¼Œå…³äºæœºå™¨å­¦ä¹ çš„æ¨¡å‹ä¸ç®—æ³•éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç•™åˆ°ç¬¬24è®²å†å»å±•å¼€ã€‚åœ¨è¿™é‡Œï¼Œä½ åªè¦çŸ¥é“æœ‰â€œæ¨¡å‹é€‰å‹â€è¿™å›äº‹å°±å¯ä»¥äº†ã€‚</p><p>åœ¨â€œæˆ¿ä»·é¢„æµ‹â€è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬çš„é¢„æµ‹æ ‡çš„ï¼ˆLabelï¼‰æ˜¯æˆ¿ä»·ï¼Œè€Œæˆ¿ä»·æ˜¯è¿ç»­çš„æ•°å€¼å‹å­—æ®µï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å›å½’æ¨¡å‹ï¼ˆRegression Modelï¼‰æ¥æ‹Ÿåˆæ•°æ®ã€‚å†è€…ï¼Œåœ¨æ‰€æœ‰çš„æ¨¡å‹ä¸­ï¼Œçº¿æ€§æ¨¡å‹æ˜¯æœ€ç®€å•çš„ï¼Œå› æ­¤ï¼Œæœ¬ç€ç”±æµ…å…¥æ·±çš„åŸåˆ™ï¼Œåœ¨ç¬¬ä¸€ç‰ˆçš„å®ç°ä¸­ï¼Œå’±ä»¬ä¸å¦¨é€‰å®šçº¿æ€§å›å½’æ¨¡å‹ï¼ˆLinear Regressionï¼‰ï¼Œæ¥æ‹Ÿåˆæˆ¿ä»·ä¸æˆ¿å±‹å±æ€§ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚</p><h3>æ•°æ®æ¢ç´¢</h3><p>è¦æƒ³å‡†ç¡®åœ°é¢„æµ‹æˆ¿ä»·ï¼Œæˆ‘ä»¬å¾—å…ˆç¡®å®šï¼Œåœ¨ä¸æˆ¿å±‹ç›¸å…³çš„å±æ€§ä¸­ï¼Œå“ªäº›å› ç´ å¯¹äºæˆ¿ä»·çš„å½±å“æœ€å¤§ã€‚åœ¨æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©é‚£äº›å½±å“è¾ƒå¤§çš„å› ç´ ï¼Œè€Œå‰”é™¤é‚£äº›å½±å“è¾ƒå°çš„å¹²æ‰°é¡¹ã€‚</p><p>ç»“åˆè¿™é‡Œç”¨åˆ°çš„ä¾‹å­ï¼Œå¯¹æˆ¿ä»·æ¥è¯´ï¼Œæˆ¿å±‹çš„å»ºç­‘é¢ç§¯ä¸€å®šæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å› ç´ ã€‚ç›¸åï¼Œè¡—é“çš„è·¯é¢ç±»å‹ï¼ˆæ°´æ³¥è·¯é¢ã€æ²¥é’è·¯é¢è¿˜æ˜¯æ–¹ç –è·¯é¢ï¼‰ï¼Œå¯¹æˆ¿ä»·çš„å½±å“å°±æ²¡é‚£ä¹ˆé‡è¦äº†ã€‚</p><p>åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸä¸­ï¼Œä¸é¢„æµ‹æ ‡çš„ç›¸å…³çš„å±æ€§ï¼Œç»Ÿç§°ä¸ºâ€œæ•°æ®ç‰¹å¾â€ï¼ˆFeaturesï¼‰ï¼Œè€Œé€‰æ‹©æœ‰æ•ˆç‰¹å¾çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œç‰¹å¾é€‰æ‹©â€ï¼ˆFeatures Selectionï¼‰ã€‚åœ¨åšç‰¹æ€§é€‰æ‹©ä¹‹å‰ï¼Œæˆ‘ä»¬è‡ªç„¶å…ä¸äº†å…ˆå¯¹æ•°æ®åšä¸€ç•ªåˆæ­¥çš„æ¢ç´¢ï¼Œæ‰æœ‰å¯èƒ½å¾—å‡ºç»“è®ºã€‚</p><p>å…·ä½“çš„æ¢ç´¢è¿‡ç¨‹æ˜¯è¿™æ ·çš„ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨SparkSessionçš„read APIï¼Œä»train.csvæ–‡ä»¶åˆ›å»ºDataFrameï¼Œç„¶åè°ƒç”¨showä¸printSchemaå‡½æ•°ï¼Œæ¥è§‚å¯Ÿæ•°æ®çš„æ ·æœ¬æ„æˆä¸Schemaã€‚</p><p>ç”±äºæ•°æ®å­—æ®µè¾ƒå¤šï¼Œä¸æ–¹ä¾¿æŠŠæ‰“å°å‡ºçš„æ•°æ®æ ·æœ¬å’ŒSchemaå †æ”¾åœ¨æ–‡ç¨¿ä¸­ï¼Œå› æ­¤è¿™ä¸€æ­¥çš„æ¢ç´¢æˆ‘æŠŠå®ƒç•™ç»™ä½ è¯•éªŒï¼Œä½ ä¸å¦¨æŠŠä¸‹é¢çš„ä»£ç æ•²å…¥åˆ°spark-shellï¼Œè§‚å¯Ÿä¸€ä¸‹æ•°æ®åˆ°åº•â€œé•¿ä»€ä¹ˆæ¨¡æ ·â€ã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.sql.DataFrame\n&nbsp;\nval rootPath: String = _\nval filePath: String = s\"${rootPath}/train.csv\"\n&nbsp;\n// ä»CSVæ–‡ä»¶åˆ›å»ºDataFrame\nval trainDF: DataFrame = spark.read.format(\"csv\").option(\"header\", true).load(filePath)\n&nbsp;\ntrainDF.show\ntrainDF.printSchema\n</code></pre><p>é€šè¿‡è§‚å¯Ÿæ•°æ®ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ¿å±‹çš„å±æ€§éå¸¸ä¸°å¯Œï¼ŒåŒ…æ‹¬è¯¸å¦‚æˆ¿å±‹å»ºç­‘é¢ç§¯ã€å±…å®¤æ•°é‡ã€è¡—é“è·¯é¢æƒ…å†µã€æˆ¿å±‹ç±»å‹ï¼ˆå…¬å¯“è¿˜æ˜¯åˆ«å¢…ï¼‰ã€åŸºç¡€è®¾æ–½ï¼ˆæ°´ã€ç”µã€ç‡ƒæ°”ï¼‰ã€ç”Ÿæ´»å‘¨è¾¹ï¼ˆè¶…å¸‚ã€åŒ»é™¢ã€å­¦æ ¡ï¼‰ã€åœ°åŸºç±»å‹ï¼ˆç –æ··è¿˜æ˜¯é’¢æ··ï¼‰ã€åœ°ä¸‹å®¤é¢ç§¯ã€åœ°ä¸Šé¢ç§¯ã€å¨æˆ¿ç±»å‹ï¼ˆå¼€æ”¾è¿˜æ˜¯å°é—­ï¼‰ã€è½¦åº“é¢ç§¯ä¸ä½ç½®ã€æœ€è¿‘ä¸€æ¬¡äº¤æ˜“æ—¶é—´ï¼Œç­‰ç­‰ã€‚</p><h3>æ•°æ®æå–</h3><p>æŒ‰é“ç†æ¥è¯´ï¼Œè¦é´é€‰é‚£äº›å¯¹æˆ¿ä»·å½±å“è¾ƒå¤§çš„ç‰¹å¾ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸€ä¸ªç‰¹å¾ä¸æˆ¿ä»·ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ä¸è¿‡ï¼Œ<strong>åœ¨ç¬¬ä¸€ç‰ˆçš„å®ç°ä¸­ï¼Œå’±ä»¬é‡ç‚¹å…³æ³¨Spark MLlibçš„åŸºæœ¬ç”¨æ³•ï¼Œæš‚æ—¶ä¸çœ‹é‡æ¨¡å‹æ•ˆæœ</strong>ã€‚</p><p>æ‰€ä»¥ï¼Œå’±ä»¬ä¸å¦¨ä¸€åˆ‡ä»ç®€ï¼Œåªé€‰å–é‚£äº›æ•°å€¼å‹ç‰¹å¾ï¼ˆè¿™ç±»ç‰¹å¾ç®€å•ç›´æ¥ï¼Œé€‚åˆä¸Šæ‰‹ï¼‰ï¼Œå¦‚å»ºç­‘é¢ç§¯ã€åœ°ä¸Šé¢ç§¯ã€åœ°ä¸‹å®¤é¢ç§¯å’Œè½¦åº“é¢ç§¯ï¼Œå³\"LotArea\"ï¼Œâ€œGrLivAreaâ€ï¼Œâ€œTotalBsmtSF\"å’Œ\"GarageAreaâ€ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ä¸¥è°¨çš„ç‰¹å¾é€‰æ‹©ï¼Œæˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€è®²çš„ç‰¹å¾å·¥ç¨‹å†å»å±•å¼€ã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.sql.types.IntegerType\n&nbsp;\n// æå–ç”¨äºè®­ç»ƒçš„ç‰¹å¾å­—æ®µä¸é¢„æµ‹æ ‡çš„ï¼ˆæˆ¿ä»·SalePriceï¼‰\nval selectedFields: DataFrame = trainDF.select(\"LotArea\", \"GrLivArea\", \"TotalBsmtSF\", \"GarageArea\", \"SalePrice\")\n&nbsp;\n// å°†æ‰€æœ‰å­—æ®µéƒ½è½¬æ¢ä¸ºæ•´å‹Int\nval typedFields = selectedFields\n.withColumn(\"LotAreaInt\",col(\"LotArea\").cast(IntegerType)).drop(\"LotArea\")\n.withColumn(\"GrLivAreaInt\",col(\"GrLivArea\").cast(IntegerType)).drop(\"GrLivArea\")\n.withColumn(\"TotalBsmtSFInt\",col(\"TotalBsmtSF\").cast(IntegerType)).drop(\"TotalBsmtSF\")\n.withColumn(\"GarageAreaInt\",col(\"GarageArea\").cast(IntegerType)).drop(\"GarageArea\")\n.withColumn(\"SalePriceInt\",col(\"SalePrice\").cast(IntegerType)).drop(\"SalePrice\")\n&nbsp;\ntypedFields.printSchema\n&nbsp;\n/** ç»“æœæ‰“å°\nroot\n&nbsp;|-- LotAreaInt: integer (nullable = true)\n&nbsp;|-- GrLivAreaInt: integer (nullable = true)\n&nbsp;|-- TotalBsmtSFInt: integer (nullable = true)\n&nbsp;|-- GarageAreaInt: integer (nullable = true)\n&nbsp;|-- SalePriceInt: integer (nullable = true)\n*/\n</code></pre><p>ä»CSVåˆ›å»ºDataFrameï¼Œæ‰€æœ‰å­—æ®µçš„ç±»å‹é»˜è®¤éƒ½æ˜¯Stringï¼Œè€Œæ¨¡å‹åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œåªèƒ½æ¶ˆè´¹æ•°å€¼å‹æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿™é‡Œè¿˜è¦åšä¸€ä¸‹ç±»å‹è½¬æ¢ï¼ŒæŠŠæ‰€æœ‰å­—æ®µéƒ½è½¬æ¢ä¸ºæ•´å‹ã€‚</p><h3>å‡†å¤‡è®­ç»ƒæ ·æœ¬</h3><p>å¥½å•¦ï¼Œæ•°æ®å‡†å¤‡å°±ç»ªï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©Spark MLlibæ¡†æ¶ï¼Œå¼€å¯æœºå™¨å­¦ä¹ çš„å¼€å‘ä¹‹æ—…ã€‚é¦–å…ˆï¼Œç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬æŠŠå‡†å¤‡ç”¨äºè®­ç»ƒçš„å¤šä¸ªç‰¹å¾å­—æ®µï¼Œæåˆæˆä¸€ä¸ªç‰¹å¾å‘é‡ï¼ˆFeature Vectorsï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.ml.feature.VectorAssembler\n&nbsp;\n// å¾…æåˆçš„ç‰¹å¾å­—æ®µé›†åˆ\nval features: Array[String] = Array(\"LotAreaInt\", \"GrLivAreaInt\", \"TotalBsmtSFInt\", \"GarageAreaInt\")\n&nbsp;\n// å‡†å¤‡â€œæåˆå™¨â€ï¼ŒæŒ‡å®šè¾“å…¥ç‰¹å¾å­—æ®µé›†åˆï¼Œä¸æåˆåçš„ç‰¹å¾å‘é‡å­—æ®µå\nval assembler = new VectorAssembler().setInputCols(features).setOutputCol(\"features\")\n&nbsp;\n// è°ƒç”¨æåˆå™¨çš„transformå‡½æ•°ï¼Œå®Œæˆç‰¹å¾å‘é‡çš„æåˆ\nval featuresAdded: DataFrame = assembler.transform(typedFields)\n.drop(\"LotAreaInt\")\n.drop(\"GrLivAreaInt\")\n.drop(\"TotalBsmtSFInt\")\n.drop(\"GarageAreaInt\")\n&nbsp;\nfeaturesAdded.printSchema\n&nbsp;\n/** ç»“æœæ‰“å°\nroot\n&nbsp;|-- SalePriceInt: integer (nullable = true)\n&nbsp;|-- features: vector (nullable = true) // æ³¨æ„ï¼Œfeaturesçš„å­—æ®µç±»å‹æ˜¯Vector\n*/\n</code></pre><p>æåˆå®Œç‰¹å¾å‘é‡ä¹‹åï¼Œæˆ‘ä»¬å°±æœ‰äº†ç”¨äºæ¨¡å‹è®­ç»ƒçš„è®­ç»ƒæ ·æœ¬ï¼ˆTraining Samplesï¼‰ï¼Œå®ƒåŒ…å«ä¸¤ç±»æ•°æ®ï¼Œä¸€ç±»æ­£æ˜¯ç‰¹å¾å‘é‡featuresï¼Œå¦ä¸€ç±»æ˜¯é¢„æµ‹æ ‡çš„SalePriceIntã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠè®­ç»ƒæ ·æœ¬æˆæ¯”ä¾‹åœ°åˆ†æˆä¸¤ä»½ï¼Œä¸€ä»½ç”¨äºæ¨¡å‹è®­ç»ƒï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç”¨äºåˆæ­¥éªŒè¯æ¨¡å‹æ•ˆæœã€‚</p><pre><code class=\"language-scala\">val Array(trainSet, testSet) = featuresAdded.randomSplit(Array(0.7, 0.3))\n</code></pre><p>å°†è®­ç»ƒæ ·æœ¬æ‹†åˆ†ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†</p><h3>æ¨¡å‹è®­ç»ƒ</h3><p>è®­ç»ƒæ ·æœ¬å‡†å¤‡å°±ç»ªï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©Spark MLlibæ¥æ„å»ºçº¿æ€§å›å½’æ¨¡å‹äº†ã€‚å®é™…ä¸Šï¼Œä½¿ç”¨Spark MLlibæ„å»ºå¹¶è®­ç»ƒæ¨¡å‹ï¼Œéå¸¸ç®€å•ç›´æ¥ï¼Œåªéœ€3ä¸ªæ­¥éª¤å³å¯æå®šã€‚</p><p>ç¬¬ä¸€æ­¥æ˜¯å¯¼å…¥ç›¸å…³çš„æ¨¡å‹åº“ï¼Œåœ¨Spark MLlibä¸­ï¼Œçº¿æ€§å›å½’æ¨¡å‹ç”±LinearRegressionç±»å®ç°ã€‚ç¬¬äºŒæ­¥æ˜¯åˆ›å»ºæ¨¡å‹å®ä¾‹ï¼Œå¹¶æŒ‡å®šæ¨¡å‹è®­ç»ƒæ‰€éœ€çš„å¿…è¦ä¿¡æ¯ã€‚ç¬¬ä¸‰æ­¥æ˜¯è°ƒç”¨æ¨¡å‹çš„fitå‡½æ•°ï¼ŒåŒæ—¶æä¾›è®­ç»ƒæ•°æ®é›†ï¼Œå¼€å§‹è®­ç»ƒã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.ml.regression.LinearRegression\n&nbsp;\n// æ„å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼ŒæŒ‡å®šç‰¹å¾å‘é‡ã€é¢„æµ‹æ ‡çš„ä¸è¿­ä»£æ¬¡æ•°\nval lr = new LinearRegression()\n.setLabelCol(\"SalePriceInt\")\n.setFeaturesCol(\"features\")\n.setMaxIter(10)\n&nbsp;\n// ä½¿ç”¨è®­ç»ƒé›†trainSetè®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹\nval lrModel = lr.fit(trainSet)\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å…ˆæ˜¯åˆ›å»ºLinearRegressionå®ä¾‹ï¼Œç„¶åé€šè¿‡setLabelColå‡½æ•°å’ŒsetFeaturesColå‡½æ•°ï¼Œæ¥åˆ†åˆ«æŒ‡å®šé¢„æµ‹æ ‡çš„å­—æ®µä¸ç‰¹å¾å‘é‡å­—æ®µï¼Œä¹Ÿå³â€œSalePriceIntâ€å’Œâ€œfeaturesâ€ã€‚ç´§æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨setMaxIterå‡½æ•°æ¥æŒ‡å®šæ¨¡å‹è®­ç»ƒçš„è¿­ä»£æ¬¡æ•°ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘æœ‰å¿…è¦ç»™ä½ è§£é‡Šä¸€ä¸‹è¿­ä»£æ¬¡æ•°è¿™ä¸ªæ¦‚å¿µã€‚åœ¨å‰é¢ä»‹ç»æœºå™¨å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬æåˆ°ï¼Œæ¨¡å‹è®­ç»ƒæ˜¯ä¸€ä¸ªæŒç»­ä¸æ–­çš„è¿‡ç¨‹ï¼Œè®­ç»ƒè¿‡ç¨‹ä¼šåå¤æ‰«æåŒä¸€ä»½æ•°æ®ï¼Œä»è€Œä»¥è¿­ä»£çš„æ–¹å¼ï¼Œä¸€æ¬¡åˆä¸€æ¬¡åœ°æ›´æ–°æ¨¡å‹ä¸­çš„å‚æ•°ï¼ˆParametersï¼Œä¹Ÿå«ä½œæƒé‡ï¼ŒWeightsï¼‰ï¼Œç›´åˆ°æ¨¡å‹çš„é¢„æµ‹æ•ˆæœè¾¾åˆ°ä¸€å®šçš„æ ‡å‡†ï¼Œæ‰èƒ½ç»“æŸè®­ç»ƒã€‚</p><p>å…³äºè¿™ä¸ªæ ‡å‡†çš„åˆ¶å®šï¼Œæ¥è‡ªäºä¸¤ä¸ªæ–¹é¢ã€‚ä¸€æ–¹é¢æ˜¯å¯¹äº<strong>é¢„æµ‹è¯¯å·®</strong>çš„è¦æ±‚ï¼Œå½“æ¨¡å‹çš„é¢„æµ‹è¯¯å·®å°äºé¢„å…ˆè®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œæ¨¡å‹è¿­ä»£å³å¯æ”¶æ•›ã€ç»“æŸè®­ç»ƒã€‚å¦ä¸€ä¸ªæ–¹é¢å°±æ˜¯å¯¹äº<strong>è¿­ä»£æ¬¡æ•°</strong>çš„è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºé¢„æµ‹è¯¯å·®æ˜¯å¤šå°‘ï¼Œåªè¦è¾¾åˆ°äº†é¢„å…ˆè®¾å®šçš„è¿­ä»£æ¬¡æ•°ï¼Œæ¨¡å‹è®­ç»ƒå³å®£å‘Šç»“æŸã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šçœ‰å¤´ç´§é”ï¼šâ€œåˆå‡ºç°äº†äº›æ–°æ¦‚å¿µï¼Œæ¨¡å‹è¿­ä»£ã€æ¨¡å‹å‚æ•°ï¼Œæ¨¡å‹çš„è®­ç»ƒåˆ°åº•æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹å‘¢ï¼Ÿâ€ä¸ºäº†è®©ä½ æ›´å¥½åœ°ç†è§£æ¨¡å‹è®­ç»ƒï¼Œæˆ‘æ¥ç»™ä½ ä¸¾ä¸ªç”Ÿæ´»åŒ–çš„ä¾‹å­ã€‚</p><p>å®é™…ä¸Šï¼Œæœºå™¨å­¦ä¹ ä¸­çš„æ¨¡å‹è®­ç»ƒï¼Œä¸æˆ‘ä»¬ç”Ÿæ´»ä¸­ä½¿ç”¨å¾®æ³¢ç‚‰çš„è¿‡ç¨‹åˆ«æ— äºŒè‡´ã€‚å‡è®¾æˆ‘ä»¬æ‰‹å¤´ä¸Šæœ‰ä¸€æ¬¾è€å¼çš„å¾®æ³¢ç‚‰ï¼Œå¾®æ³¢ç‚‰ä¸Šåªæœ‰ä¸¤ä¸ªæ—‹é’®ï¼Œä¸€ä¸ªæ§åˆ¶æ¸©åº¦ï¼Œå¦ä¸€ä¸ªæ§åˆ¶åŠ çƒ­æ—¶é•¿ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦çƒ˜çƒ¤ä¸€å—é¦…é¥¼ï¼Œæ¥å½“æ™šé¥­å……é¥¥ã€‚æ™šé¥­åªæœ‰ä¸€å—é¦…é¥¼ï¼Œå¬ä¸Šå»ç¡®å®æ˜¯æƒ¨äº†äº›ï¼Œä¸è¿‡å’±ä»¬å¯¹äºå£æ„Ÿçš„è¦æ±‚è¿˜æ˜¯è›®é«˜çš„ï¼Œæˆ‘ä»¬æƒ³è¦å¾—åˆ°ä¸€å—å¤–é¢ç„¦è„†ã€é‡Œé¢æŸ”å«©çš„é¦…é¥¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/d9/2b5e6b20c0eaceb1c1f4d9924566c5d9.jpg?wh=1920x1357\" alt=\"å›¾ç‰‡\" title=\"è°ƒèŠ‚å¾®æ³¢ç‚‰å‚æ•°ï¼šæ¸©åº¦ã€æ—¶é•¿\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¯¹äºçƒ¹é¥ªç»éªŒä¸º0çš„æˆ‘ä»¬æ¥è¯´ï¼Œæƒ³è¦å¾—åˆ°ä¸€å¼ çƒ˜çƒ¤å®Œç¾çš„é¦…é¥¼ï¼Œåªèƒ½ä¸€æ¬¡æ¬¡åœ°å‡†å¤‡é¦…é¥¼èƒšå­ã€ä¸€æ¬¡æ¬¡æŠŠå®ƒä»¬é€è¿›å¾®æ³¢ç‚‰ï¼Œç„¶åä¸æ–­å°è¯•ä¸åŒçš„æ¸©åº¦ä¸æ—¶é•¿ç»„åˆï¼Œç›´åˆ°çƒ˜ç„™å‡ºå¤–ç„¦é‡Œå«©çš„ç¾å‘³é¦…é¥¼ï¼Œæ‰ä¼šå¾—åˆ°æœ€ä½³çš„æ¸©åº¦ä¸æ—¶é•¿ç»„åˆã€‚</p><p>åœ¨ç¡®å®šäº†æˆåŠŸçš„æ¸©åº¦ä¸æ—¶é•¿ç»„åˆä¹‹åï¼Œå½“æˆ‘ä»¬éœ€è¦å†æ¬¡çƒ˜çƒ¤å…¶ä»–ç±»ä¼¼é£Ÿç‰©ï¼ˆæ¯”å¦‚è‚‰é¥¼ã€æŠ«è¨ï¼‰çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠå®ƒä»¬é€è¿›å¾®æ³¢ç‚‰ï¼Œç„¶åç›´æ¥æŒ‰ä¸‹å¼€å¯é”®å°±å¯ä»¥äº†ã€‚</p><p>æ¨¡å‹è®­ç»ƒä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¸€æ¬¡æ¬¡åœ°æŠŠè®­ç»ƒæ•°æ®ï¼Œâ€œå–‚ç»™â€æ¨¡å‹ç®—æ³•ï¼Œä¸€æ¬¡æ¬¡åœ°è°ƒæ•´æ¨¡å‹å‚æ•°ï¼Œç›´åˆ°æŠŠé¢„æµ‹è¯¯å·®é™ä½åˆ°ä¸€å®šçš„èŒƒå›´ã€æˆ–æ˜¯æ¨¡å‹è¿­ä»£è¾¾åˆ°ä¸€å®šçš„æ¬¡æ•°ï¼Œå³å®£å‘Šè®­ç»ƒç»“æŸã€‚å½“æœ‰æ–°çš„æ•°æ®éœ€è¦é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå–‚ç»™è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæ¨¡å‹å°±èƒ½ç”Ÿæˆé¢„æµ‹ç»“æœã€‚</p><p>ä¸è¿‡ï¼Œä¸æˆ‘ä»¬ä¸åœåœ°æ‰‹åŠ¨è°ƒèŠ‚â€œæ¸©åº¦â€ä¸â€œæ—¶é•¿â€æ—‹é’®ä¸åŒï¼Œæ¨¡å‹æƒé‡çš„è°ƒæ•´ï¼Œä¾èµ–çš„å¾€å¾€æ˜¯ä¸€ç§å«ä½œâ€œ<strong>æ¢¯åº¦ä¸‹é™</strong>â€ï¼ˆGradient Descendï¼‰çš„ä¼˜åŒ–ç®—æ³•ã€‚åœ¨æ¨¡å‹çš„æ¯ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•ä¼šè‡ªåŠ¨åœ°è°ƒæ•´æ¨¡å‹æƒé‡ï¼Œè€Œä¸éœ€è¦äººä¸ºçš„å¹²é¢„ã€‚è¿™ä¸ªä¼˜åŒ–ç®—æ³•å’±ä»¬ç•™åˆ°ç¬¬24è®²æ¨¡å‹è®­ç»ƒé‚£é‡Œå†å±•å¼€ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œåœ¨ä¸Šé¢é¦…é¥¼çƒ˜ç„™è¿™ä¸ªç”Ÿæ´»åŒ–çš„ä¾‹å­ä¸­ï¼Œç›¸æ¯”æ¨¡å‹è®­ç»ƒï¼Œé¦…é¥¼èƒšå­å®é™…ä¸Šå°±æ˜¯è®­ç»ƒæ•°æ®ï¼Œå¾®æ³¢ç‚‰å°±æ˜¯æ¨¡å‹ç®—æ³•ï¼Œæ¸©åº¦ä¸æ—¶é•¿å°±æ˜¯æ¨¡å‹å‚æ•°ï¼Œé¢„æµ‹è¯¯å·®å°±æ˜¯å®é™…å£æ„Ÿä¸æœŸæœ›å£æ„Ÿä¹‹é—´çš„å·®è·ï¼Œè€Œå°è¯•çš„çƒ˜ç„™æ¬¡æ•°å°±æ˜¯è¿­ä»£æ¬¡æ•°ã€‚å…³äºé¦…é¥¼çƒ˜ç„™ä¸æ¨¡å‹è®­ç»ƒçš„å¯¹æ¯”ï¼Œæˆ‘æŠŠå®ƒæ•´ç†åˆ°äº†ä¸‹å›¾ä¸­ï¼Œä½ å¯ä»¥çœ‹çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/8c/2a2ef27737557b586afc3dfef234638c.jpg?wh=1920x568\" alt=\"å›¾ç‰‡\" title=\"é¦…é¥¼çƒ˜ç„™ä¸æ¨¡å‹è®­ç»ƒçš„å¯¹æ¯”å…³ç³»\"></p><p>ç†Ÿæ‚‰äº†ä¸æ¨¡å‹è®­ç»ƒç›¸å…³çš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹åˆšåˆšçš„çº¿æ€§å›å½’è®­ç»ƒä»£ç ã€‚é™¤äº†è¡¨ä¸­çš„3ä¸ªsetXXXå‡½æ•°ä»¥å¤–ï¼Œå…³äºæ¨¡å‹å®šä¹‰çš„æ›´å¤šé€‰é¡¹ï¼Œä½ å¯ä»¥å‚è€ƒ<a href=\"http://spark.apache.org/docs/latest/api/scala/org/apache/spark/ml/regression/LinearRegression.html\">å®˜ç½‘ä¸­çš„å¼€å‘API</a>æ¥è·å–å®Œæ•´å†…å®¹ã€‚æ¨¡å‹å®šä¹‰å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è°ƒç”¨fitå‡½æ•°ï¼Œæ¥å®Œæˆæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚</p><pre><code class=\"language-scala\">&nbsp;import org.apache.spark.ml.regression.LinearRegression\n&nbsp;\n// æ„å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼ŒæŒ‡å®šç‰¹å¾å‘é‡ã€é¢„æµ‹æ ‡çš„ä¸è¿­ä»£æ¬¡æ•°\nval lr = new LinearRegression()\n.setLabelCol(\"SalePriceInt\")\n.setFeaturesCol(\"features\")\n.setMaxIter(10)\n&nbsp;\n// ä½¿ç”¨è®­ç»ƒé›†trainSetè®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹\nval lrModel = lr.fit(trainSet)\n</code></pre><h3>æ¨¡å‹æ•ˆæœè¯„ä¼°</h3><p>æ¨¡å‹è®­ç»ƒå¥½ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¨¡å‹çš„æ•ˆæœè¿›è¡ŒéªŒè¯ã€è¯„ä¼°ï¼Œæ‰èƒ½åˆ¤å®šæ¨¡å‹çš„â€œå¥½â€ã€â€œåâ€ã€‚è¿™å°±å¥½æ¯”ï¼Œé¦…é¥¼çƒ¤ç†Ÿä¹‹åï¼Œæˆ‘ä»¬å¾—äº²è‡ªå°ä¸€å°ï¼Œæ‰èƒ½çŸ¥é“å®ƒçš„å‘³é“è·Ÿæˆ‘ä»¬æœŸå¾…çš„å£æ„Ÿæ˜¯å¦ä¸€è‡´ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ï¼Œæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„è¡¨ç°æ€ä¹ˆæ ·ã€‚åœ¨çº¿æ€§å›å½’æ¨¡å‹çš„è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šçš„æŒ‡æ ‡ï¼Œç”¨æ¥é‡åŒ–æ¨¡å‹çš„é¢„æµ‹è¯¯å·®ã€‚å…¶ä¸­æœ€å…·ä»£è¡¨æ€§çš„è¦æ•°RMSEï¼ˆRoot Mean Squared Errorï¼‰ï¼Œä¹Ÿå°±æ˜¯å‡æ–¹æ ¹è¯¯å·®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¨¡å‹ä¸Šè°ƒç”¨summaryå‡½æ•°ï¼Œæ¥è·å–æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„è¯„ä¼°æŒ‡æ ‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-scala\">val trainingSummary = lrModel.summary\nprintln(s\"RMSE: ${trainingSummary.rootMeanSquaredError}\")\n&nbsp;\n/** ç»“æœæ‰“å°\nRMSE: 45798.86\n*/\n</code></pre><p>åœ¨è®­ç»ƒé›†çš„æ•°æ®åˆ†å¸ƒä¸­ï¼Œæˆ¿ä»·çš„å€¼åŸŸåœ¨ï¼ˆ34900ï¼Œ755000ï¼‰ä¹‹é—´ï¼Œå› æ­¤ï¼Œ45798.86çš„é¢„æµ‹è¯¯å·®è¿˜æ˜¯ç›¸å½“å¤§çš„ã€‚è¿™è¯´æ˜æˆ‘ä»¬å¾—åˆ°çš„æ¨¡å‹ï¼Œç”šè‡³æ²¡æœ‰å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œè®­ç»ƒå¾—åˆ°çš„æ¨¡å‹ï¼Œå¤„åœ¨ä¸€ä¸ªâ€œæ¬ æ‹Ÿåˆâ€çš„çŠ¶æ€ã€‚</p><p>è¿™å…¶å®å¾ˆå¥½ç†è§£ï¼Œä¸€æ–¹é¢ï¼Œå’±ä»¬çš„æ¨¡å‹è¿‡äºç®€å•ï¼Œçº¿æ€§å›å½’çš„æ‹Ÿåˆèƒ½åŠ›æœ¬èº«å°±éå¸¸æœ‰é™ã€‚</p><p>å†è€…ï¼Œåœ¨æ•°æ®æ–¹é¢ï¼Œæˆ‘ä»¬ç›®å‰ä»…ä»…ä½¿ç”¨äº†4ä¸ªå­—æ®µï¼ˆLotAreaIntï¼ŒGrLivAreaIntï¼ŒTotalBsmtSFIntï¼ŒGarageAreaIntï¼‰ã€‚æˆ¿ä»·å½±å“å› ç´ ä¼—å¤šï¼Œä»…ç”¨4ä¸ªæˆ¿å±‹å±æ€§ï¼Œæ˜¯å¾ˆéš¾å‡†ç¡®åœ°é¢„æµ‹æˆ¿ä»·çš„ã€‚æ‰€ä»¥åœ¨åé¢çš„å‡ è®²ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šç»§ç»­æ·±å…¥ç ”ç©¶ç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹é€‰å‹å¯¹äºæ¨¡å‹æ‹Ÿåˆèƒ½åŠ›çš„å½±å“ã€‚</p><p>é¢å¯¹è¿™ç§æ¬ æ‹Ÿåˆçš„æƒ…å†µï¼Œæˆ‘ä»¬è‡ªç„¶è¿˜éœ€è¦è¿›ä¸€æ­¥è°ƒè¯•ã€ä¼˜åŒ–è¿™ä¸ªæ¨¡å‹ã€‚åœ¨åç»­çš„å‡ è®²ä¸­ï¼Œæˆ‘ä»¬ä¼šåˆ†åˆ«ä»ç‰¹å¾å·¥ç¨‹ä¸æ¨¡å‹è°ƒä¼˜è¿™ä¸¤ä¸ªè§’åº¦å‡ºå‘ï¼Œå»é€æ­¥å®Œå–„æˆ‘ä»¬çš„â€œæˆ¿ä»·é¢„æµ‹â€æ¨¡å‹ï¼Œæ‹­ç›®ä»¥å¾…å§ï¼</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åšä¸ªæ€»ç»“ã€‚ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¸»è¦å›´ç»•ç€â€œæˆ¿ä»·é¢„æµ‹â€è¿™ä¸ªå°é¡¹ç›®ï¼Œåˆ†åˆ«ä»‹ç»äº†æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•å€ŸåŠ©Spark MLlibæ¡†æ¶ï¼Œå®Œæˆæœºå™¨å­¦ä¹ å¼€å‘ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/df/7a/df544823e33f0179c9d8ac15fb35237a.jpg?wh=1920x738\" alt=\"å›¾ç‰‡\"></p><p>é¦–å…ˆï¼Œä½ éœ€è¦æŒæ¡æœºå™¨å­¦ä¹ æ˜¯æ€æ ·çš„ä¸€ä¸ªè®¡ç®—è¿‡ç¨‹ã€‚æ‰€è°“æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰ï¼Œå®ƒæŒ‡çš„æ˜¯è¿™æ ·ä¸€ç§è®¡ç®—è¿‡ç¨‹ã€‚å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®ï¼ˆTraining samplesï¼‰ï¼Œé€‰æ‹©ä¸€ç§å…ˆéªŒçš„æ•°æ®åˆ†å¸ƒæ¨¡å‹ï¼ˆModelsï¼‰ï¼Œç„¶åå€ŸåŠ©ä¼˜åŒ–ç®—æ³•ï¼ˆLearning Algorithmsï¼‰è‡ªåŠ¨åœ°æŒç»­è°ƒæ•´æ¨¡å‹å‚æ•°ï¼ˆModel Weights / Parametersï¼‰ï¼Œä»è€Œè®©æ¨¡å‹ä¸æ–­é€¼è¿‘è®­ç»ƒæ•°æ®çš„åŸå§‹åˆ†å¸ƒã€‚</p><p>ç„¶åï¼Œåœ¨Spark MLlibå­æ¡†æ¶ä¸‹ï¼Œä½ éœ€è¦æŒæ¡æœºå™¨å­¦ä¹ å¼€å‘çš„åŸºæœ¬æµç¨‹å’Œå…³é”®æ­¥éª¤ï¼Œæˆ‘æŠŠè¿™äº›æ­¥éª¤æ•´ç†åˆ°äº†å¦‚ä¸‹çš„è¡¨æ ¼ä¸­ï¼Œæ–¹ä¾¿ä½ éšæ—¶å›é¡¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b1/aa/b12df804cbaf8f709582990b172ce7aa.jpg?wh=1920x1184\" alt=\"å›¾ç‰‡\" title=\"æœºå™¨å­¦ä¹ å¼€å‘çš„å…³é”®æ­¥éª¤\"></p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†â€œæœºå™¨å­¦ä¹ åŸºç¡€çŸ¥è¯†â€ä¸â€œSpark MLlibå¼€å‘æµç¨‹â€ç›¸äº¤å‰çš„æ–¹å¼ï¼Œæ¥åŒæ—¶è®²è§£æœºå™¨å­¦ä¹ æœ¬èº«ä¸Spark MLlibå­æ¡†æ¶ã€‚å¯¹äºæœºå™¨å­¦ä¹ èƒŒæ™¯è¾ƒä¸ºè–„å¼±çš„åŒå­¦æ¥è¯´ï¼Œå­¦ä¹ ä»Šå¤©çš„å†…å®¹å¯èƒ½æœ‰äº›æŒ‘æˆ˜ã€‚</p><p>ä¸è¿‡ï¼Œä½ ä¸ç”¨æ‹…å¿ƒï¼Œå¯¹äºæœ¬è®²ä¸­æŒ–ä¸‹çš„â€œå‘â€ï¼Œæˆ‘ä»¬åœ¨åç»­çš„å‡ è®²ä¸­ï¼Œéƒ½ä¼šé™†ç»­è¡¥ä¸Šï¼ŒåŠ›äº‰è®©ä½ ç³»ç»ŸæŒæ¡æœºå™¨å­¦ä¹ çš„å¼€å‘æ–¹æ³•ä¸å¸¸è§„å¥—è·¯ã€‚</p><h2>æ¯æ—¥ä¸€ç»ƒ</h2><p>è¯·æŒ‰ç…§è¿™ä¸€è®²çš„è¡Œæ–‡é¡ºåºï¼Œæ•´ç†ä»åŠ è½½æ•°æ®åˆ°æ¨¡å‹è®­ç»ƒã€æ¨¡å‹è¯„ä¼°çš„æ‰€æœ‰ä»£ç ã€‚ç„¶åï¼Œè¯·ä½ ä»Kaggleï¼ˆæ•°æ®ç§‘å­¦ç«èµ›å¹³å°ï¼‰çš„â€œ<a href=\"https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview\">House Prices - Advanced Regression Techniques</a>â€ç«èµ›é¡¹ç›®ä¸‹è½½è®­ç»ƒæ•°æ®ï¼Œå®Œæˆä»æ•°æ®åŠ è½½åˆ°æ¨¡å‹è®­ç»ƒçš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµäº’åŠ¨ï¼Œä¹Ÿæ¨èä½ æŠŠè¿™ä¸€è®²åˆ†äº«ç»™æ›´å¤šåŒäº‹ã€æœ‹å‹ï¼Œä¸€èµ·åŠ¨æ‰‹è¯•è¯•ä»æ•°æ®åŠ è½½åˆ°æ¨¡å‹è®­ç»ƒçš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p>","comments":[{"had_liked":false,"id":333339,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1644300626,"is_pvip":false,"replies":[{"id":"121999","content":"æ„Ÿè°¢è€å¼Ÿæä¾›ä¸‹è½½é“¾æ¥ï¼Œéå¸¸æ„Ÿè°¢~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1644674454,"ip_address":"","comment_id":333339,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14529202514","product_id":100090001,"comment_content":"House Prices - Advanced Regression Techniques æ•°æ®éœ€è¦ä»£ç†æ’ä»¶æ‰èƒ½æ˜¾ç¤ºæ³¨å†Œç ã€‚å¦åˆ™æ— æ³•æ³¨å†Œè´¦å·ä¸‹è½½æ•°æ®ï¼Œæ•°æ®å¯åœ¨è¿™ä¸‹è½½ã€‚<br>é“¾æ¥ï¼šhttps:&#47;&#47;pan.baidu.com&#47;s&#47;1J4LklHyYz5S6d32uZPp6nA <br>æå–ç ï¼šxr96","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550696,"discussion_content":"æ„Ÿè°¢è€å¼Ÿæä¾›ä¸‹è½½é“¾æ¥ï¼Œéå¸¸æ„Ÿè°¢~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644674454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319824,"user_name":"Geek_995b78","can_delete":false,"product_type":"c1","uid":2758010,"ip_address":"","ucode":"F9BD1C78366081","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/w74m73icotZZEiasC6VzRUytfkFkgyYCGAcz16oBWuMXueWOxxVuAnH6IHaZFXkj5OqwlVO1fnocvn9gGYh8gGcw/132","comment_is_top":false,"comment_ctime":1635954642,"is_pvip":false,"replies":[{"id":"115987","content":"å¥½çš„ï¼Œ å›å¤´æˆ‘ä¸Šä¼ ä¸€ä¸‹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1636011347,"ip_address":"","comment_id":319824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5930921938","product_id":100090001,"comment_content":"è€å¸ˆ å¯ä»¥æŠŠç›¸å…³æ•°æ®ä¸Šä¼ åˆ°gitä¸€ä»½å—ï¼Œä¸å¥½ä¸‹è½½","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529783,"discussion_content":"å¥½çš„ï¼Œ å›å¤´æˆ‘ä¸Šä¼ ä¸€ä¸‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636011347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319731,"user_name":"markliang","can_delete":false,"product_type":"c1","uid":1214216,"ip_address":"","ucode":"0A13CEDC50ECAB","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/08/9fd313d7.jpg","comment_is_top":false,"comment_ctime":1635924752,"is_pvip":true,"replies":[{"id":"115943","content":"ç”Ÿæ´»åŒ–è”æƒ³ã€ç±»æ¯”ï¼Œè´¹æ›¼å­¦ä¹ æ³•ï¼Œç¡®å®å—ç›ŠåŒªæµ…~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635953508,"ip_address":"","comment_id":319731,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5930892048","product_id":100090001,"comment_content":"çœ‹æ–‡ç« å­¦ä¹ æŠ€æœ¯çš„åŒæ—¶ï¼Œé¡ºå¸¦å¯ä»¥å­¦ä¹ æ–‡ç« é‡Œçš„å†™ä½œæ–¹æ³•å’Œå­¦ä¹ æ–¹æ³•:è”æƒ³æ–¹æ³•ï¼Œç°å®ç”Ÿæ´»æ¨¡å‹ï¼Œè´¹æ›¼å­¦ä¹ æ³•ï¼Œç­‰ç­‰ã€‚å­¦åˆ°çš„è¿œä¸æ­¢æ˜¯æŠ€æœ¯ã€‚ğŸ‘æ ¼å±€æ‰“å¼€","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529746,"discussion_content":"ç”Ÿæ´»åŒ–è”æƒ³ã€ç±»æ¯”ï¼Œè´¹æ›¼å­¦ä¹ æ³•ï¼Œç¡®å®å—ç›ŠåŒªæµ…~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635953508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352368,"user_name":"æ—Curry","can_delete":false,"product_type":"c1","uid":1260911,"ip_address":"","ucode":"55FA1EE95A484F","user_header":"https://static001.geekbang.org/account/avatar/00/13/3d/6f/3a97712e.jpg","comment_is_top":false,"comment_ctime":1658587753,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658587753","product_id":100090001,"comment_content":"ä»£ç é‡Œå¥½åƒæ²¡æœ‰ä½“ç°éªŒè¯é›†çš„ç”¨æ³•å‘€è€å¸ˆ","like_count":0},{"had_liked":false,"id":346765,"user_name":"é˜¿æµ·","can_delete":false,"product_type":"c1","uid":1281585,"ip_address":"","ucode":"2589431F840C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/8e/31/28972804.jpg","comment_is_top":false,"comment_ctime":1653406203,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653406203","product_id":100090001,"comment_content":"åœ¨è®­ç»ƒé›†çš„æ•°æ®åˆ†å¸ƒä¸­ï¼Œæˆ¿ä»·çš„å€¼åŸŸåœ¨ï¼ˆ34900ï¼Œ755000ï¼‰ä¹‹é—´ï¼Œå› æ­¤ï¼Œ45798.86 çš„é¢„æµ‹è¯¯å·®è¿˜æ˜¯ç›¸å½“å¤§çš„ã€‚<br><br>45798ä¸æ˜¯è½åœ¨ä¸Šé¢çš„åŒºé—´å†…å—","like_count":0},{"had_liked":false,"id":338423,"user_name":"ç©ºde","can_delete":false,"product_type":"c1","uid":1202258,"ip_address":"","ucode":"DF59457D5932A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/52/f35f5265.jpg","comment_is_top":false,"comment_ctime":1647497241,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647497241","product_id":100090001,"comment_content":"spark3 çš„MLlibåº“æœ‰æ²¡æœ‰æä¾›æ—¶åºæ¨¡å‹ï¼Œå¯ä»¥å¤„ç†æ—¶åºæ•°æ®çš„å¼‚å¸¸æ£€æµ‹çš„éœ€æ±‚ï¼Ÿåœ¨ç”Ÿäº§ä¸­spark MLlib å¤„ç†æ—¶åºå¼‚å¸¸æ£€æµ‹æ˜¯æ€ä¹ˆåšçš„ï¼Œæœ‰æ²¡æœ‰æ¡ˆä¾‹æ¨èï¼Ÿ","like_count":0},{"had_liked":false,"id":324824,"user_name":"ä¸œå›´å±…å£«","can_delete":false,"product_type":"c1","uid":2144966,"ip_address":"","ucode":"0FDAC3E3053837","user_header":"https://static001.geekbang.org/account/avatar/00/20/ba/c6/10448065.jpg","comment_is_top":false,"comment_ctime":1638669785,"is_pvip":false,"replies":[{"id":"118126","content":"è¿™ä¸€ç« çš„æ•°æ®ï¼Œä»è¿™é‡Œä¸‹è½½å“ˆ~ <br>https:&#47;&#47;www.kaggle.com&#47;c&#47;house-prices-advanced-regression-techniques&#47;data","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1639045717,"ip_address":"","comment_id":324824,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638669785","product_id":100090001,"comment_content":"è€å¸ˆï¼Œæ•°æ®é›†ä¸Šä¼ åˆ°å“ªäº†å‘¢ï¼Œåœ¨ä½ çš„ github é‡Œé¢æ²¡æ‰¾åˆ°","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537379,"discussion_content":"è¿™ä¸€ç« çš„æ•°æ®ï¼Œä»è¿™é‡Œä¸‹è½½å“ˆ~ \nhttps://www.kaggle.com/c/house-prices-advanced-regression-techniques/data","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639045718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322237,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1637251789,"is_pvip":true,"replies":[{"id":"117230","content":"æ˜¯çš„~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1637662268,"ip_address":"","comment_id":322237,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637251789","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œâ€œé¢„æµ‹â€ ä½“ç°åœ¨å“ªé‡Œå‘¢ï¼Œæ˜¯æŒ‡æˆ‘ç»™ç‰¹å¾å‘é‡ï¼Œç„¶åæ ¹æ®æ¨¡å‹ç®—å‡ºæˆ¿ä»·å—","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532660,"discussion_content":"æ˜¯çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637662268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322235,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1637251578,"is_pvip":true,"replies":[{"id":"117231","content":"è®­ç»ƒé›†ä¸Šé¢çš„ç»“æœå—ï¼Ÿè¿˜æ˜¯æµ‹è¯•é›†çš„ç»“æœï¼Ÿè®²é“ç†ï¼Œè®­ç»ƒé›†çš„costï¼Œéšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œåº”è¯¥è¶Šæ¥è¶Šå°æ‰å¯¹ï¼›æµ‹è¯•é›†çš„costï¼Œå€’æ˜¯æœ‰å¯èƒ½å› ä¸ºè¿‡æ‹Ÿåˆï¼Œè€Œå¯¼è‡´è¶Šæ¥è¶Šé«˜~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1637662354,"ip_address":"","comment_id":322235,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637251578","product_id":100090001,"comment_content":"çœŸçš„è›®å¥½ç©çš„ï¼Œæˆ‘è¿­ä»£10æ¬¡æ˜¯40000å¤šï¼Œæˆ‘æƒ³è¯•è¯•è¿­ä»£100æ¬¡è¯•è¯•ï¼Œç»“æœ43000å¤š","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532662,"discussion_content":"è®­ç»ƒé›†ä¸Šé¢çš„ç»“æœå—ï¼Ÿè¿˜æ˜¯æµ‹è¯•é›†çš„ç»“æœï¼Ÿè®²é“ç†ï¼Œè®­ç»ƒé›†çš„costï¼Œéšç€è¿­ä»£æ¬¡æ•°å¢åŠ ï¼Œåº”è¯¥è¶Šæ¥è¶Šå°æ‰å¯¹ï¼›æµ‹è¯•é›†çš„costï¼Œå€’æ˜¯æœ‰å¯èƒ½å› ä¸ºè¿‡æ‹Ÿåˆï¼Œè€Œå¯¼è‡´è¶Šæ¥è¶Šé«˜~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637662354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321748,"user_name":"åƒé‡Œé©¬","can_delete":false,"product_type":"c1","uid":2034674,"ip_address":"","ucode":"829A075C14E5CA","user_header":"https://static001.geekbang.org/account/avatar/00/1f/0b/f2/a8b0d8a6.jpg","comment_is_top":false,"comment_ctime":1637029786,"is_pvip":false,"replies":[{"id":"116832","content":"å¥½çš„ï¼Œæˆ‘å›å¤´ä¸Šä¼ ä¸€ä»½åˆ°github","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1637039964,"ip_address":"","comment_id":321748,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637029786","product_id":100090001,"comment_content":"è€å¸ˆï¼Œæ•°æ®ä¸å¥½ä¸‹è½½ï¼Œèƒ½æä¾›ä¸€ä»½ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530345,"discussion_content":"å¥½çš„ï¼Œæˆ‘å›å¤´ä¸Šä¼ ä¸€ä»½åˆ°github","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637039964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319798,"user_name":"å¼º","can_delete":false,"product_type":"c1","uid":1035643,"ip_address":"","ucode":"D0A761E25B0740","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/7b/31a6bf42.jpg","comment_is_top":false,"comment_ctime":1635946411,"is_pvip":false,"replies":[{"id":"115942","content":"ä¸€èµ·åŠ æ²¹~ è€å¼Ÿï¼","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635953455,"ip_address":"","comment_id":319798,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635946411","product_id":100090001,"comment_content":"ä»æ€§èƒ½è°ƒä¼˜è¿‡æ¥çš„,æ‰“ç®—çœ‹å®Œä¹‹åã€‚æ‰¾å·¥ä½œäº†ï¼ˆè¢«å…¬å¸è£äº†ï¼‰","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529773,"discussion_content":"ä¸€èµ·åŠ æ²¹~ è€å¼Ÿï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635953455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1056982,"avatar":"https://static001.geekbang.org/account/avatar/00/10/20/d6/b9513db0.jpg","nickname":"kingcall","note":"","ucode":"508884DC684B5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413899,"discussion_content":"åŒæ˜¯ä»æ€§èƒ½è°ƒä¼˜è¿‡æ¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636600152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}