{"id":131652,"title":"30 | 如何使用guard来改善你的条件判断","content":"<p><strong>课件地址</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/swift-course\">https://gitee.com/geektime-geekbang/swift-course</a></p>","comments":[{"had_liked":false,"id":185407,"user_name":"小灰","can_delete":false,"product_type":"c3","uid":1586696,"ip_address":"","ucode":"679E11CE2645CC","user_header":"https://static001.geekbang.org/account/avatar/00/18/36/08/4674855c.jpg","comment_is_top":false,"comment_ctime":1583575794,"is_pvip":false,"replies":[{"id":79915,"content":"这没有问题，你这其实就是把if当guard来用。  但是if一般是和else配对使用的。","user_name":"作者回复","user_name_real":"Geek_f72435","uid":1341726,"ctime":1589165332,"ip_address":"","comment_id":185407,"utype":1}],"discussion_count":7,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"我在网上搜索了一下，都说guard 比起if 的优势是可以让代码更加可读， 但是我觉得下面的代码使用if 可读性也是可以的，哪swift为什么还要引入guard呢? 望老师给我涨涨姿势～ 他们还有其他的区别或优势么\n\nfunc isIpAddress(ipString: String) -&gt; (Int, String) {\n    let components = ipString.split(separator: &quot;.&quot;)\n    \n    if (components.count != 4) {\n        return (100, &quot;ip地址必须为四部分&quot;)\n    }\n    \n    if let first = Int(components[0]), (first &lt; 0 || first &gt; 255) {\n        return (1, &quot;ip地址第一部分不对&quot;)\n    }\n    \n    if let second = Int(components[1]), (second &lt; 0 || second &gt; 255) {\n        return (2, &quot;ip地址第二部分不对&quot;)\n    }\n    \n    if let third = Int(components[2]), (third &lt; 0 || third &gt; 255) {\n        return (3, &quot;ip地址第三部分不对&quot;)\n    }\n    \n    if let fourth = Int(components[3]), (fourth &lt; 0 || fourth &gt; 255) {\n        return (3, &quot;ip地址第四部分不对&quot;)\n    }\n    \n    return (0, &quot;IP 地址合法&quot;)\n}\n\nprint(isIpAddress(ipString: &quot;127.0.0.1&quot;))","like_count":0,"discussions":[{"author":{"id":1341726,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxtKhpmvzx2VB4iajicfJVFmQR3eP3xBpdpQEovpSqUfAOrNImvYwVb7P37ibI0ONziau9sbFEk8oDaA/132","nickname":"elfgate","note":"","ucode":"3C0B5F7C1F664C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486351,"discussion_content":"这没有问题，你这其实就是把if当guard来用。  但是if一般是和else配对使用的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589165332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461978,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4e/da/5b347cb8.jpg","nickname":"Jabir_Zhang","note":"","ucode":"55BCE733F8DD25","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209096,"discussion_content":"之前有看到过，if后面的条件一般最好不要!=之类的，老外说这样不好理解，你这边的可读性还行，但是if里的条件都是反着来，没有guard好理解","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1584608997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133415,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4b/67/9a9fc124.jpg","nickname":"七娃zinc💨💨","note":"","ucode":"C1225E2CC596D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613878,"discussion_content":"使用 if 和 guard 都能达到判断效果，但是拿这里的场景讨论，如果使用 if 的话，最后真正逻辑那里就没法使用 first、second 这些参数了，他们只能在被返回的分支中使用，所以后面又要重新再获取一遍。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681564169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1057332,"avatar":"https://static001.geekbang.org/account/avatar/00/10/22/34/580cdde0.jpg","nickname":"yalda","note":"","ucode":"1F782AB65DC0AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554444,"discussion_content":"你的这种方式属于配置表模式；即列出单个 if 语句的所有最细粒度的逻辑条件；只适合3个参数及其以下的场景，太复杂其他人读起来会很累；","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646382063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1457784,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep8unibCib9rdHib0D6Rf6TjecPQu1yic0G9sjzriczlTcwGHP6DaxtEmHyN7pCrD9zV7OSegyf7EUBvaA/132","nickname":"Geek__2099","note":"","ucode":"01444B60F18A66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373188,"discussion_content":"guard是断言，是保证逻辑的前提下，在语言层面强调必须符合某个场景，后续业务处理才有意义。if在语言层面缺少这种强调性，只有简单的逻辑内涵。\n可以对比其含义：\nguard:强调一下，ip地址必须有四个数\nif:如果ip地址不是四个数\n这种语言层面的强调，是在逻辑层面之上，含有人文，情绪的因素。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620645407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1330371,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c3/2ebdc487.jpg","nickname":"苹果娱乐选彩票","note":"","ucode":"F75D75EA23D311","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362221,"discussion_content":"用if更习惯, 多语言编程的话, 别的语言可没有guard","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616896110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1505243,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f7/db/4eb5da19.jpg","nickname":"star","note":"","ucode":"54D858422D1E27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241665,"discussion_content":"感觉还是if更好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587432939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136415,"user_name":"月巴 森","can_delete":false,"product_type":"c3","uid":1015619,"ip_address":"","ucode":"2AEED21352F28A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/43/4bfd8714.jpg","comment_is_top":false,"comment_ctime":1569427158,"is_pvip":false,"replies":[{"id":58048,"content":"对，代码里写错了","user_name":"作者回复","user_name_real":"Geek_f72435","uid":1341726,"ctime":1573635715,"ip_address":"","comment_id":136415,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"是component","like_count":0,"discussions":[{"author":{"id":1341726,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxtKhpmvzx2VB4iajicfJVFmQR3eP3xBpdpQEovpSqUfAOrNImvYwVb7P37ibI0ONziau9sbFEk8oDaA/132","nickname":"elfgate","note":"","ucode":"3C0B5F7C1F664C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468620,"discussion_content":"对，代码里写错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573635715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}