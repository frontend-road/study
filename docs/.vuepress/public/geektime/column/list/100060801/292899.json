{"id":292899,"title":"å›½åº†ç­–åˆ’ | æ·±åº¦å­¦ä¹ æ¨èç³»ç»ŸåŸºç¡€ï¼Œä½ æŒæ¡äº†å¤šå°‘ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹å–†ã€‚</p><p>ä»Šå¤©æ˜¯å›½åº†å‡æœŸçš„ç¬¬äºŒå¤©ï¼Œæˆ‘åœ¨åŸºç¡€æ¶æ„ç¯‡çš„åŸºç¡€ä¸Šï¼Œè®¾è®¡äº†ä¸€å¥—æµ‹è¯•é¢˜ï¼Œå¸Œæœ›ä½ èƒ½åœ¨å‡æœŸé‡Œè¯•åšä¸€ä¸‹ï¼Œæ¸©æ•…çŸ¥æ–°ï¼Œå·©å›ºæ‰€å­¦ã€‚</p><p>åœ¨è¿™å¥—æµ‹è¯•é¢˜ä¸­ï¼Œæœ‰ 10 é“é€‰æ‹©é¢˜ï¼Œæ¯é“é¢˜ 10 åˆ†ï¼Œæ»¡åˆ†ä¸º 100ã€‚è¿™äº›å†…å®¹å…¨éƒ¨æ¥è‡ªæˆ‘ä»¬ä¹‹å‰ä¸“æ æ‰€è®²çš„å†…å®¹ï¼Œéƒ½æ˜¯åŸºç¡€çŸ¥è¯†ï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ æŸ¥ç¼ºè¡¥æ¼ã€‚</p><p>æœ€åå‘¢ï¼Œæˆ‘è¿˜ä¸ºä½ å‡†å¤‡äº†ä¸¤é“å®è·µé¢˜ï¼Œè¿™ä¸¤é“é¢˜ä¸ºé€‰åšã€‚å¦‚æœä½ å¯¹è‡ªå·±æœ‰æ›´é«˜çš„è¦æ±‚ï¼Œæˆ‘å¸Œæœ›ä½ å¯ä»¥show me the codeï¼å½“ç„¶ï¼Œåœ¨ç­”é¢˜å’Œå®è·µä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œéƒ½å¯ä»¥åœ¨ç•™è¨€åŒºè¯„è®ºï¼Œæˆ‘ä»¬ä¸€èµ·æ¥æ¢è®¨ã€‚è¿˜ç­‰ä»€ä¹ˆï¼Œç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®å¼€å§‹æµ‹è¯•å§ï¼</p><h2>é€‰æ‹©é¢˜</h2><p><a href=\"http://time.geekbang.org/quiz/intro?act_id=216&exam_id=666\"><img src=\"https://static001.geekbang.org/resource/image/28/a4/28d1be62669b4f3cc01c36466bf811a4.png?wh=1142*201\" alt=\"\"></a></p><h2>é—®ç­”é¢˜</h2><p>ç¬¬ä¸€é¢˜ï¼šé€šè¿‡é˜…è¯»SparrowRecSysçš„ä»£ç ï¼Œä½ èƒ½æ‰¾åˆ°é¦–é¡µä¸­æ¯è¡Œå†…éƒ¨çš„ç”µå½±éƒ½æ˜¯æŒ‰ç…§ä»€ä¹ˆæ’åºçš„å—ï¼Ÿ</p><p>ç¬¬äºŒé“é¢˜ï¼šå¦‚æœä½ å·²ç»å‘ç°äº†æ’åºçš„è§„åˆ™ï¼Œä½ èƒ½åœ¨æ¨èæœåŠ¡å™¨çš„ä»£ç é‡Œæ·»åŠ ä¸€ä¸ªå«â€œçƒ­åº¦â€ï¼ˆpopularityï¼‰çš„æ’åºè§„åˆ™ï¼Œç„¶åè®©é¦–é¡µæŒ‰ç…§â€œçƒ­åº¦â€æ’åºå—ï¼ˆğŸ’¡è¡¥å……ï¼šçƒ­åº¦çš„å®šä¹‰æ˜¯â€œè¿™ä¸ªç”µå½±è¢«è¯„ä»·çš„æ¬¡æ•°â€ï¼‰ï¼Ÿ</p><p>æˆ‘ç›¸ä¿¡è¿™æ˜¯ç†Ÿæ‚‰movielensæ•°æ®ã€æ¨èæœåŠ¡å™¨ä»£ç çš„ä¸€ä¸ªéå¸¸å¥½çš„æœºä¼šï¼Œé‚£åœ¨å®ç°è¿‡ç¨‹ä¸­çš„ä»»ä½•é—®é¢˜ï¼Œéƒ½æ¬¢è¿ä½ ç•™è¨€å’Œæˆ‘äº¤æµï¼æˆ‘ä»¬10æœˆ9æ—¥å†è§ï¼</p><!-- [[[read_end]]] -->","comments":[{"had_liked":false,"id":263702,"user_name":"ç¥ç»è›™","can_delete":false,"product_type":"c1","uid":2242137,"ip_address":"","ucode":"9375BA98E03A8D","user_header":"https://static001.geekbang.org/account/avatar/00/22/36/59/010b3e60.jpg","comment_is_top":false,"comment_ctime":1606223394,"is_pvip":false,"replies":[{"id":"95680","content":"éå¸¸å¥½ã€‚å‰ç«¯å±•ç¤ºä»£ç ä¸ç”¨ä¿®æ”¹ï¼Œä¿®æ”¹jså°±å¯ä»¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1606246195,"ip_address":"","comment_id":263702,"utype":1}],"discussion_count":2,"race_medal":0,"score":"100390471202","product_id":100060801,"comment_content":"è¯¾åé¢˜ï¼š<br>1.æ’åºä¾æ®ï¼š<br>\tæ ¹æ®å½±ç‰‡å†å²å¹³å‡è¯„åˆ†ï¼Œé™åºæ’åˆ—ã€‚è¯¦ç»†è°ƒç”¨è¿‡ç¨‹ï¼š<br>\ta.index.htmlé‡Œé¢çš„jsä»£ç ï¼Œè°ƒç”¨åœ¨å¤´éƒ¨åŠ è½½çš„recsys.js çš„addGenreRow, ä¼ å…¥å‚æ•°(é¡µé¢ID,å½±ç‰‡ç±»åˆ«åç§°,rowId, æ¯è¡Œæ”¾ç½®å½±ç‰‡ä¸ªæ•°,baseUrl)<br>\tb.åœ¨addGenreRowè°ƒç”¨å·²æ³¨å†Œçš„ getrecommendation æœåŠ¡ï¼Œä¼ å‚çš„æ’åºä¾æ®ä¸ºrating.<br>\tc.æœåŠ¡getrecommendationç»‘å®šç±»RecommendationService, GETè¯·æ±‚æ•°æ®<br>\td.RecommendationService.doGet ä¸­ è°ƒç”¨ online.datamanager.DataManager#getMoviesByGenre,æ ¹æ®æ¯ä¸ªå½±ç‰‡çš„å†å²å¹³å‡rating,é™åºæ’åˆ—.<br>2.æ ¹æ®popularityæ’åº:<br>\ta.recsys.js<br>\t\tfunction addGenreRow(pageId, rowName, rowId, size, baseUrl) {<br>\t\t    addRowFrame(pageId, rowName, rowId, baseUrl);<br>\t\t    $.getJSON(baseUrl + &quot;getrecommendation?genre=&quot;+rowName+&quot;&amp;size=&quot;+size+&quot;&amp;sortby=popularity&quot;, function(result){<br>\t\t        $.each(result, function(i, movie){<br>\t\t          appendMovie2Row(rowId, movie.title, movie.movieId, movie.releaseYear, movie.averageRating.toPrecision(2), movie.ratingNumber, movie.genres,baseUrl);<br>\t\t        });<br>\t\t    });<br>\t\t};<br>\tb.com.wzhe.sparrowrecsys.online.datamanager.DataManager#getMoviesByGenre:<br>\t\tæ·»åŠ ä¸€è¡Œï¼š<br>\t\tcase &quot;popularity&quot;: movies.sort((m1, m2) -&gt; Integer.compare(m2.getRatingNumber(), m1.getRatingNumber()));break;<br><br>\t\tç”¨mmovie.getRatings.size() ä¹Ÿè¡Œï¼Œä½†åº”è¯¥æ•ˆç‡æ¯”ä¸Šé¢çš„ä½ã€‚<br>\tc.æ”¹æ”¹å‰ç«¯çš„å±•ç¤ºä»£ç <br>\t\tä¸å¤ªæ“…é•¿","like_count":24,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510275,"discussion_content":"éå¸¸å¥½ã€‚å‰ç«¯å±•ç¤ºä»£ç ä¸ç”¨ä¿®æ”¹ï¼Œä¿®æ”¹jså°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606246195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2871311,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d0/0f/734237b0.jpg","nickname":"Ramona","note":"","ucode":"C81B8CA448E1A4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557187,"discussion_content":"è¯·é—®ç…§ç€ä¿®æ”¹ä»¥åï¼Œä¸ºä»€ä¹ˆé¦–é¡µçš„æ¨èé¡ºåºæ²¡æœ‰æ”¹å˜å‘€ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647683769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290507,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":2598647,"ip_address":"","ucode":"E35C2300971FA2","user_header":"https://static001.geekbang.org/account/avatar/00/27/a6/f7/e434c375.jpg","comment_is_top":false,"comment_ctime":1619596368,"is_pvip":false,"replies":[{"id":"105354","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1619729695,"ip_address":"","comment_id":290507,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35979334736","product_id":100060801,"comment_content":"ç¬¬ä¸€é¢˜<br>æ˜¯æ ¹æ®ç”µå½±çš„åˆ†æ•°(rating)æ’åºçš„<br><br>ç¬¬äºŒé¢˜<br>1. å…ˆä»RecSysServer.javaè¿›å…¥ï¼Œæ‰¾åˆ°68è¡Œçš„RecommendationService<br>2. å†çœ‹åˆ°getMoviesByGenre.javaç¬¬35è¡Œçš„getMoviesByGenre()<br>3. åœ¨switchä¸­æ–°å¢: case &quot;popularity&quot;: movies.sort((m1, m2) -&gt; Integer.compare(m2.getRatingNumber(), m1.getRatingNumber()));break; å°±æ˜¯æŒ‰ç…§çƒ­åº¦æ’åºäº†<br>4. å†å›åˆ°RecommendationServiceçš„33è¡Œï¼Œ String sortby = request.getParameter(&quot;sortby&quot;); ä»£è¡¨æ’åºä¾æ®çš„å‚æ•°æ˜¯ç”±æŸä¸ªapiä¼ å…¥çš„<br>5. æ‰¾åˆ°recsys.jsç¬¬102è¡Œï¼ŒæŠŠsortby=ratingä¿®æ”¹ä¸ºsortby=popularityå³å¯ï¼š$.getJSON(baseUrl + &quot;getrecommendation?genre=&quot;+rowName+&quot;&amp;size=&quot;+size+&quot;&amp;sortby=popularity&quot;, function(result)","like_count":9,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519221,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619729695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2735741,"avatar":"https://static001.geekbang.org/account/avatar/00/29/be/7d/33f732f3.jpg","nickname":"Lennon.Lau","note":"","ucode":"515CD55F5E37D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582079,"discussion_content":"æ£’ï¼markä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659183564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252057,"user_name":"æœ±æœˆä¿Š","can_delete":false,"product_type":"c1","uid":1017707,"ip_address":"","ucode":"4DA0728B862FBD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/6b/0b6cd39a.jpg","comment_is_top":false,"comment_ctime":1602081408,"is_pvip":false,"replies":[{"id":"92247","content":"å…³æ³¨ä¸€ä¸‹addGenereRowæ–¹æ³•ä¸­çš„sortbyå‚æ•°<br>$.getJSON(baseUrl + &quot;getrecommendation?genre=&quot;+rowName+&quot;&amp;size=&quot;+size+&quot;&amp;sortby=rating&quot;","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602399613,"ip_address":"","comment_id":252057,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35961819776","product_id":100060801,"comment_content":"å…ˆè¯´ä¸€ä¸‹æ¯ä¸€ç§ç±»å‹çš„ç”µå½±æ˜¯å¦‚ä½•æ’åçš„ï¼š<br>é»˜è®¤æ˜¯æŒ‰ç…§æ‰“åˆ†å¹³å‡åˆ†æ•°ä»¥åŠå‘å¸ƒæ—¶é—´æ’åï¼Œåœ¨recsys.jsä¸­çš„addGenereRowå¤„æŒ‡å®šæ’åçš„æ–¹å¼ã€‚<br>å¦‚ä½•æ–°å¢æ’åç®—æ³•ï¼Œæ¯”å¦‚å¢åŠ çƒ­åº¦è¿™ä¸ªæŒ‡æ ‡ï¼Ÿ<br>éœ€è¦åœ¨DataManagerä¸­ç…§è‘«èŠ¦ç”»ç“¢å¢åŠ ratingNumberï¼Œç„¶ååœ¨jsä¸­æŒ‡å®šä¸€ä¸‹å³å¯ã€‚<br><br>è¿˜åœ¨ç ”ç©¶çš„é—®é¢˜ï¼šé¦–é¡µæ˜¯å¦‚ä½•è°ƒç”¨getrecommendationæ¥å£ä»¥åŠå¦‚ä½•ä¼ å…¥å‚æ•°çš„ã€‚éº»çƒ¦è€å¸ˆæŒ‡æ•™ä¸€ä¸‹ã€‚","like_count":8,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506702,"discussion_content":"å…³æ³¨ä¸€ä¸‹addGenereRowæ–¹æ³•ä¸­çš„sortbyå‚æ•°\n$.getJSON(baseUrl + &amp;quot;getrecommendation?genre=&amp;quot;+rowName+&amp;quot;&amp;amp;size=&amp;quot;+size+&amp;quot;&amp;amp;sortby=rating&amp;quot;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602399613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251814,"user_name":"ALAN","can_delete":false,"product_type":"c1","uid":1240164,"ip_address":"","ucode":"70E3B1C730E63F","user_header":"https://static001.geekbang.org/account/avatar/00/12/ec/64/7403c694.jpg","comment_is_top":false,"comment_ctime":1601886506,"is_pvip":false,"replies":[{"id":"92249","content":"æ˜¯çš„ï¼Œå¦‚æœéœ€è¦çœ‹åˆ°æ•ˆæœçš„è¯ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€äº›recsys.jsä¸­ç›¸å…³çš„jsä»£ç ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602399721,"ip_address":"","comment_id":251814,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14486788394","product_id":100060801,"comment_content":"é—®é¢˜ä¸€ï¼šæŒ‰ç”µå½±çš„å¹³å‡æ‰“åˆ†ä»é«˜åˆ°ä½æ’åº<br>é—®é¢˜äºŒï¼šä¿®æ”¹DataManager.javaä¸­221è¡Œä»£ç ã€‚å°†comparaå‡½æ•°ä¸­å‚æ•°getAverageRatingå‡½æ•°æ”¹æˆgetRatingNumberå‡½æ•°","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506623,"discussion_content":"æ˜¯çš„ï¼Œå¦‚æœéœ€è¦çœ‹åˆ°æ•ˆæœçš„è¯ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€äº›recsys.jsä¸­ç›¸å…³çš„jsä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602399721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277238,"user_name":"Kepler","can_delete":false,"product_type":"c1","uid":1877078,"ip_address":"","ucode":"C69A3248FB1AF6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/a4/56/29a05cb2.jpg","comment_is_top":false,"comment_ctime":1612325798,"is_pvip":false,"replies":[{"id":"100614","content":"éå¸¸å¥½ æ”¹jsç‰ˆæœ¬å¯æ˜¯é¿å…å¾ˆå¤šç¼“å­˜é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1612361233,"ip_address":"","comment_id":277238,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10202260390","product_id":100060801,"comment_content":"é—®é¢˜ï¼šå¦‚æœä¿®æ”¹jsåŠå¯¹åº”çš„RecommendationServiceåï¼Œä¸»é¡µä»æœªæ˜¾ç¤ºæ’åºæ•ˆæœ<br>è§£å†³ï¼š<br>æ–¹å¼1. æ‹‰æ–°githubï¼ˆæ¨èï¼Œé¿å…åç»­æœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜ï¼‰<br>æ–¹å¼2. ä¿®æ”¹index.htmlçš„&lt;script src=&quot;.&#47;js&#47;recsys.js&quot;&gt;&lt;&#47;script&gt;ï¼ŒåŸåŠ è½½jsæ–‡ä»¶ä¸ºrecsys.js?v=1.19","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514968,"discussion_content":"éå¸¸å¥½ æ”¹jsç‰ˆæœ¬å¯æ˜¯é¿å…å¾ˆå¤šç¼“å­˜é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612361233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252933,"user_name":"å¤§é’°å„¿","can_delete":false,"product_type":"c1","uid":1193551,"ip_address":"","ucode":"3E632100FAC52B","user_header":"https://static001.geekbang.org/account/avatar/00/12/36/4f/455ec47f.jpg","comment_is_top":false,"comment_ctime":1602518814,"is_pvip":false,"replies":[{"id":"92473","content":"good pointï¼Œå·²ç»æ”¹å›äº†é»˜è®¤ä»file loadæ•°æ®","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602634024,"ip_address":"","comment_id":252933,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10192453406","product_id":100060801,"comment_content":"ä»Šå¤©æ‹‰çš„ä¸»å¹²ä»£ç ï¼Œé»˜è®¤ç”¨äº†redisè½½å…¥embeddingå¯¼è‡´æ— æ³•å¯åŠ¨ï¼Œæ˜¯ä¸æ˜¯éœ€è¦æ”¹ä¸€ä¸‹ğŸ˜…","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506920,"discussion_content":"good pointï¼Œå·²ç»æ”¹å›äº†é»˜è®¤ä»file loadæ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602634024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251535,"user_name":"é‡‘é¹","can_delete":false,"product_type":"c1","uid":1019485,"ip_address":"","ucode":"916180E1699264","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/5d/562e90d6.jpg","comment_is_top":false,"comment_ctime":1601648246,"is_pvip":false,"replies":[{"id":"91979","content":"èµã€‚<br><br>è¦çœŸæ­£æ›´æ”¹æ’åºçš„æ–¹æ³•ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹å‰ç«¯jsçš„ä¸€äº›æ¡ä»¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1601678922,"ip_address":"","comment_id":251535,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10191582838","product_id":100060801,"comment_content":"é—®é¢˜ä¸€ï¼š<br>é¦–é¡µæ¯è¡Œï¼ˆä¸€ä¸ªç±»åˆ«ï¼‰æŒ‰ç”µå½±çš„AverageRatingå¹³å‡æ‰“åˆ†ä»é«˜åˆ°ä½åšä¸ºæ’åºä¾æ®ï¼›<br><br>é—®é¢˜äºŒï¼š<br>public List&lt;Movie&gt; getMoviesByGenre(String genre, int size, String sortBy){<br>        if (null != genre){<br>            List&lt;Movie&gt; movies = new ArrayList&lt;&gt;(this.genreReverseIndexMap.get(genre));<br>            switch (sortBy){<br>                case &quot;rating&quot;:movies.sort((m1, m2) -&gt; Double.compare(m2.getAverageRating(), m1.getAverageRating()));break;<br>                case &quot;releaseYear&quot;: movies.sort((m1, m2) -&gt; Integer.compare(m2.getReleaseYear(), m1.getReleaseYear()));break;<br>                case &quot;popularity&quot;:movies.sort((m1, m2) -&gt; Integer.compare(m2.getRatingNumber(), m1.getRatingNumber()));break;<br>                default:<br>            }<br>........","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506534,"discussion_content":"èµã€‚\n\nè¦çœŸæ­£æ›´æ”¹æ’åºçš„æ–¹æ³•ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹å‰ç«¯jsçš„ä¸€äº›æ¡ä»¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601678922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2207948,"avatar":"","nickname":"Geek_songjian","note":"","ucode":"4A07D79B6D885F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310831,"discussion_content":"å‰ç«¯çš„è¯ï¼Œç»™function addGenreRow(pageId, rowName, rowId, size, baseUrl,sortBy) å¢åŠ ä¸€ä¸ªsortByå‚æ•°ï¼Œä¸ºäº†é…åˆhtmlä¸Šå¯èƒ½å¢åŠ çš„æ’åºæŒ‰é’®ï¼š\n $.getJSON(baseUrl + &#34;getrecommendation?genre=&#34;+rowName+&#34;&amp;size=&#34;+size+&#34;&amp;sortby=&#34;+sortBy,\n ...","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602069233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314657,"user_name":"é—«é˜¿ä½³éœ€è¦å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1521723,"ip_address":"","ucode":"4993DCDE9B7CE4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epb9FCKSLYGUXxkYv4o1JMzES9Uia8rjbwwbR942y1lU2kKU3PGEaUmQ9icgl6lU8qZRb9yhic3DpZrQ/132","comment_is_top":false,"comment_ctime":1633307036,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5928274332","product_id":100060801,"comment_content":"ä¿®æ”¹index.htmlçš„&lt;script src=&quot;.&#47;js&#47;recsys.js&quot;&gt;&lt;&#47;script&gt; æ²¡æœ‰èµ·ä½œç”¨ï¼Œæœ€åè¿˜æ˜¯æ¸…æ¥šç¼“å­˜é‡æ–°åŠ è½½åæ˜¾ç¤ºçš„<br>æ­¥éª¤ï¼šï¼ˆchromeï¼‰F12-&gt;å‹¾é€‰&quot; Disable cache&quot; -&gt; åˆ·æ–°","like_count":1},{"had_liked":false,"id":272010,"user_name":"è½©","can_delete":false,"product_type":"c1","uid":2405529,"ip_address":"","ucode":"454CC1A0734A4C","user_header":"https://static001.geekbang.org/account/avatar/00/24/b4/99/79a21147.jpg","comment_is_top":false,"comment_ctime":1609909222,"is_pvip":false,"replies":[{"id":"98660","content":"è¿™æ ·ç†è§£ä¹Ÿæ²¡æœ‰é”™ã€‚åŸé¢˜é€‰é¡¹Dæ˜¯<br>â€œæ¨èç³»ç»Ÿå¯åˆ©ç”¨çš„ç‰¹å¾å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜åŒ–â€ï¼Œæˆ‘çš„æœ¬æ„æ˜¯æ¨èç³»ç»Ÿå¯åˆ©ç”¨çš„ç‰¹å¾åŸæ•°æ®å…¶å®æ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯å¤„ç†ç‰¹å¾çš„æ–¹å¼å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„æ”¹å˜ã€‚<br><br>åªæ˜¯ä¸€é“é€‰æ‹©é¢˜ï¼Œå¤§å®¶ç†è§£çŸ¥è¯†å°±å¥½ï¼Œä¸ç”¨è§£å†³äºè¯´æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1609956630,"ip_address":"","comment_id":272010,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5904876518","product_id":100060801,"comment_content":"è¯¾åé€‰æ‹©é¢˜ä¹ é¢˜ç¬¬äºŒé¢˜ï¼šæ„Ÿè§‰é€‰é¡¹Då…¶å®ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ å¸¦æ¥çš„é‡è¦å˜é©ã€‚<br>æ¨èç³»ç»Ÿæ˜¯è¿æ¥äººä¸ç‰©çš„ï¼Œé‚£ä¹ˆå¦‚ä½•è¡¨ç¤ºå’Œç¼–ç äººä¸ç‰©å°±æ˜¯éå¸¸é‡è¦çš„ï¼Œæ¯•ç«Ÿåªæœ‰æ›´å¥½çš„è®¤çŸ¥ï¼Œæ‰èƒ½å¸¦æ¥æ›´å¥½çš„è¿æ¥ï¼Œæ·±åº¦å­¦ä¹ å¸¦æ¥çš„è¡¨ç¤ºå­¦ä¹ æˆ‘è§‰çš„èƒ½ç®—æ˜¯é‡è¦å˜é©å§ï¼Ÿè™½ç„¶éæ·±åº¦å­¦ä¹ æ—¶ä»£çš„çŸ©é˜µåˆ†è§£ç­‰å¾—åˆ°çš„latent vectorä¹Ÿç®—æ˜¯embeddingå§ï¼Œä½†å’Œå¦‚ä»Šä¸‡ç‰©çš†å¯embeddingï¼Œåº”è¯¥ç®—æ˜¯ä¸ªé‡è¦å˜é©ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513118,"discussion_content":"è¿™æ ·ç†è§£ä¹Ÿæ²¡æœ‰é”™ã€‚åŸé¢˜é€‰é¡¹Dæ˜¯\nâ€œæ¨èç³»ç»Ÿå¯åˆ©ç”¨çš„ç‰¹å¾å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜åŒ–â€ï¼Œæˆ‘çš„æœ¬æ„æ˜¯æ¨èç³»ç»Ÿå¯åˆ©ç”¨çš„ç‰¹å¾åŸæ•°æ®å…¶å®æ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯å¤„ç†ç‰¹å¾çš„æ–¹å¼å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„æ”¹å˜ã€‚\n\nåªæ˜¯ä¸€é“é€‰æ‹©é¢˜ï¼Œå¤§å®¶ç†è§£çŸ¥è¯†å°±å¥½ï¼Œä¸ç”¨è§£å†³äºè¯´æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609956630,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335680,"user_name":"yangchao","can_delete":false,"product_type":"c1","uid":1009560,"ip_address":"","ucode":"41843ED0856819","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/98/d5e08eb7.jpg","comment_is_top":false,"comment_ctime":1645624077,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645624077","product_id":100060801,"comment_content":"æ€è€ƒé¢˜<br>1.é¦–é¡µä¸­æ¯è¡Œå†…éƒ¨çš„ç”µå½±éƒ½æ˜¯æŒ‰ç…§ratingå³è¯„åˆ†è¿›è¡Œæ’åºçš„<br><br>2.é¦–å…ˆä¿®æ”¹DataManagerç±»ä¸‹çš„getMoviesByGenre:<br>case &quot;popularity&quot;: movies.sort((m1, m2) -&gt; Integer.compare(m2.getRatingNumber(), m1.getRatingNumber()));break;<br><br>ç„¶ååœ¨recsys.jsé‡Œæ–°å¢æ–¹æ³•ï¼š<br>function addGenreRowByPopularitySort(pageId, rowName, rowId, size, baseUrl) {<br>     addRowFrame(pageId, rowName, rowId, baseUrl);<br>     $.getJSON(baseUrl + &quot;getrecommendation?genre=&quot;+rowName+&quot;&amp;size=&quot;+size+&quot;&amp;sortby=popularity&quot;, function(result){<br>         $.each(result, function(i, movie){<br>             appendMovie2Row(rowId, movie.title, movie.movieId, movie.releaseYear, movie.averageRating.toPrecision(2), movie.ratingNumber, movie.genres,baseUrl);<br>         });<br>     });<br> };<br><br>æœ€ååœ¨index.htmlé‡Œ å°†æ‰€æœ‰ addGenreRowæ›¿æ¢ä¸ºaddGenreRowByPopularitySort<br><br>æœ€åé‡æ–°ç¼–è¯‘é‡å¯goå³å¯<br>","like_count":0},{"had_liked":false,"id":335644,"user_name":"yangchao","can_delete":false,"product_type":"c1","uid":1009560,"ip_address":"","ucode":"41843ED0856819","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/98/d5e08eb7.jpg","comment_is_top":false,"comment_ctime":1645611628,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645611628","product_id":100060801,"comment_content":"è€ƒè¯•ç»“æœï¼š<br>https:&#47;&#47;time.geekbang.org&#47;quiz&#47;?act_id=216&amp;exam_id=666&amp;source=1009560","like_count":0},{"had_liked":false,"id":332013,"user_name":"Geek_0ea2ff","can_delete":false,"product_type":"c1","uid":2350339,"ip_address":"","ucode":"1490D985225CF5","user_header":"","comment_is_top":false,"comment_ctime":1642983082,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642983082","product_id":100060801,"comment_content":"ç¬¬äºŒé¢˜ï¼Œä¿®æ”¹æˆæŒ‰Popularityæ’åºï¼Œè·‘å‡ºæ¥çš„ç»“æœä¸å¯¹ï¼ŒåŒç±»å‹ç”µå½±æ²¡æœ‰æŒ‰ratingNumberé™åºå±•ç¤ºã€‚","like_count":0},{"had_liked":false,"id":323759,"user_name":"VICTOR","can_delete":false,"product_type":"c1","uid":2735716,"ip_address":"","ucode":"2EB9D8E02F2ED8","user_header":"https://static001.geekbang.org/account/avatar/00/29/be/64/f01a091c.jpg","comment_is_top":false,"comment_ctime":1638153388,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638153388","product_id":100060801,"comment_content":"é’ˆå¯¹ä¿®æ”¹å®Œåå‰ç«¯æ²¡æœ‰ç°å®çš„åŸå› ï¼Œå¯èƒ½æ˜¯å› ä¸ºjsç¼“å­˜çš„åŸå› ï¼Œå°è¯•Win: Ctrl+Shift+R &#47; Mac OS: Cmd+Shft+R å¼ºåˆ¶åˆ·æ–°ç¼“å­˜è¿›è¡Œåˆ·æ–°","like_count":1},{"had_liked":false,"id":321324,"user_name":"åœŸè±†æ˜¯å¤©ä½¿","can_delete":false,"product_type":"c1","uid":2829519,"ip_address":"","ucode":"ADB871E256F540","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2c/cf/9e727fa2.jpg","comment_is_top":false,"comment_ctime":1636792666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636792666","product_id":100060801,"comment_content":"è€å¸ˆï¼ŒæŒ‰ç…§åˆ«çš„åŒå­¦è¯´çš„æ”¹äº†ä»£ç ï¼Œä¹ŸæŒ‰ç…§ä¸èƒ½æ˜¾ç¤ºçš„æ–¹æ³•è¯•äº†ï¼Œæ’åºç»“æœè¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·","like_count":0},{"had_liked":false,"id":305764,"user_name":"Geek_8a732a","can_delete":false,"product_type":"c1","uid":2723806,"ip_address":"","ucode":"97A312D97F7B91","user_header":"","comment_is_top":false,"comment_ctime":1628152406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628152406","product_id":100060801,"comment_content":"1ã€æŒ‰ç…§ç”µå½±å¹³å‡å†å²è¯„åˆ†è¿›è¡Œæ’åº<br><br>2ã€RecSysServer.javaçš„68è¡Œæ‰¾åˆ°RecommendationService()ï¼Œè¿›å…¥åæ‰¾åˆ°35è¡ŒgetMoviesByGenreï¼Œå†è¿›å…¥åï¼Œåœ¨switché‡Œæ–°å¢ case &quot;popularity&quot;: movies.sort((m1,m2) -&gt; Integer.compare(m2.getRatingNumber(),m1.getRatingNumber()));break;<br><br>3ã€å›åˆ°RecommendationService.javaä¸­æ‰¾åˆ° <br>&#47;&#47;ranking algorithm<br>String sortby = request.getParameter(&quot;sortby&quot;);<br>é€‰ä¸­sortbyï¼Œå³é”®find in filesï¼Œ<br>æ‰¾åˆ°<br>$.getJSON(baseUrl + &quot;getrecommendation?genre=&quot;+rowName+&quot;&amp;size=&quot;+size+&quot;&amp;sortby=rating&quot;, function(result)<br>å°†å…¶ä¸­çš„sortby=ratingï¼Œæ”¹æˆsortby=popularity<br><br>4ã€ä¸ºçœ‹æ˜¾ç¤ºæ•ˆæœï¼Œå‚è€ƒäº†Kelperçš„â€œ ä¿®æ”¹index.htmlçš„&lt;script src=&quot;.&#47;js&#47;recsys.js&quot;&gt;&lt;&#47;script&gt;ï¼ŒåŸåŠ è½½jsæ–‡ä»¶ä¸ºrecsys.js?v=1.19â€ï¼Œç„¶åé‡æ–°run RecSysServer.javaå°±å¯ä»¥äº†","like_count":0},{"had_liked":false,"id":305278,"user_name":"me_hu","can_delete":false,"product_type":"c1","uid":1029258,"ip_address":"","ucode":"0D23A362D1A4B1","user_header":"","comment_is_top":false,"comment_ctime":1627900614,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627900614","product_id":100060801,"comment_content":"1. æŒ‰ç…§ç”µå½±è¯„åˆ†æ’åº<br>2. a. ä¿®æ”¹recsys.js, sortby=rating æ”¹ä¸º sortby=popularity<br>    b. DataManager.getMoviesByGenreæ–¹æ³•å¢åŠ  case popularity, æŒ‰ç…§ ratingNumberæ’åº","like_count":0},{"had_liked":false,"id":302299,"user_name":"82","can_delete":false,"product_type":"c1","uid":1716424,"ip_address":"","ucode":"C729C422DFE462","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqHa1TniaV1VibauX4iayvICUiclCibKCt9DwCM0jr3FE73mOMfHfAT5250c9JE6YBQbYnnib7dv1d52bpQ/132","comment_is_top":false,"comment_ctime":1626159185,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626159185","product_id":100060801,"comment_content":"è¿˜æœ‰è·Ÿä¸­ä»£ç çš„mainå¯åŠ¨æ–¹æ³• æ²¡çœ‹åˆ°ï¼Œæ·±åº¦å­¦ä¹ çš„å¼•æ“èµ·èµ·æ¥å•Šï¼Ÿè¿™å—ä»£ç åœ¨å“ªé‡Œèµ·çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":302244,"user_name":"82","can_delete":false,"product_type":"c1","uid":1716424,"ip_address":"","ucode":"C729C422DFE462","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqHa1TniaV1VibauX4iayvICUiclCibKCt9DwCM0jr3FE73mOMfHfAT5250c9JE6YBQbYnnib7dv1d52bpQ/132","comment_is_top":false,"comment_ctime":1626145224,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626145224","product_id":100060801,"comment_content":"public static double calculateSimilarScore(Movie movie, Movie candidate){<br>        int sameGenreCount = 0;<br>        for (String genre : movie.getGenres()){<br>            if (candidate.getGenres().contains(genre)){<br>                sameGenreCount++;<br>            }<br>        }<br>        double genreSimilarity = (double)sameGenreCount &#47; (movie.getGenres().size() + candidate.getGenres().size()) &#47; 2;<br>        double ratingScore = candidate.getAverageRating() &#47; 5;<br><br>        double similarityWeight = 0.7;<br>        double ratingScoreWeight = 0.3;<br><br>        return genreSimilarity * similarityWeight + ratingScore * ratingScoreWeight;<br>    }<br><br>ä¸Šé¢è¿™ä¸ªæ˜¯å¹²å˜›çš„å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":295409,"user_name":"è€å”å”å®‰æ£®","can_delete":false,"product_type":"c1","uid":1461122,"ip_address":"","ucode":"EF61ACAC9A44FE","user_header":"https://static001.geekbang.org/account/avatar/00/16/4b/82/5be29abf.jpg","comment_is_top":false,"comment_ctime":1622420946,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622420946","product_id":100060801,"comment_content":"1ã€é»˜è®¤æ˜¯æŒ‰ç…§æ¯ä¸ªç±»åˆ«çš„å½±ç‰‡çš„å†å²å¹³å‡è¯„åˆ†ï¼Œåœ¨ç±»åˆ«å†…æ’åºã€‚<br>2ã€åœ¨DataManagerç±»çš„GetMovieByGenreä¸­å¢åŠ å¤šä¸€ä¸ªåˆ¤æ–­ï¼šcase &quot;popularity&quot;:movies.sort((m1, m2) -&gt; Integer.compare(m2.getRatingNumber(), m1.getRatingNumber()));break;<br>å¹¶ä¿®æ”¹index.htmlæºç ä¸­jsçš„sortbyä¼ å‚ä¸ºpopularity","like_count":0}]}