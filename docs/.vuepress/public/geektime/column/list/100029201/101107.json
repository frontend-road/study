{"id":101107,"title":"06 | Kafka线上集群部署方案怎么做？","content":"<p>专栏前面几期内容，我分别从Kafka的定位、版本的变迁以及功能的演进等几个方面循序渐进地梳理了Apache Kafka的发展脉络。通过这些内容，我希望你能清晰地了解Kafka是用来做什么的，以及在实际生产环境中该如何选择Kafka版本，更快地帮助你入门Kafka。</p><p>现在我们就来看看在生产环境中的Kafka集群方案该怎么做。既然是集群，那必然就要有多个Kafka节点机器，因为只有单台机器构成的Kafka伪集群只能用于日常测试之用，根本无法满足实际的线上生产需求。而真正的线上环境需要仔细地考量各种因素，结合自身的业务需求而制定。下面我就分别从操作系统、磁盘、磁盘容量和带宽等方面来讨论一下。</p><h2>操作系统</h2><p>首先我们先看看要把Kafka安装到什么操作系统上。说起操作系统，可能你会问Kafka不是JVM系的大数据框架吗？Java又是跨平台的语言，把Kafka安装到不同的操作系统上会有什么区别吗？其实区别相当大！</p><p>的确，如你所知，Kafka由Scala语言和Java语言编写而成，编译之后的源代码就是普通的“.class”文件。本来部署到哪个操作系统应该都是一样的，但是不同操作系统的差异还是给Kafka集群带来了相当大的影响。目前常见的操作系统有3种：Linux、Windows和macOS。应该说部署在Linux上的生产环境是最多的，也有一些Kafka集群部署在Windows服务器上。Mac虽然也有macOS Server，但是我怀疑是否有人（特别是国内用户）真的把生产环境部署在Mac服务器上。</p><!-- [[[read_end]]] --><p>如果考虑操作系统与Kafka的适配性，Linux系统显然要比其他两个特别是Windows系统更加适合部署Kafka。虽然这个结论可能你不感到意外，但其中具体的原因你也一定要了解。主要是在下面这三个方面上，Linux的表现更胜一筹。</p><ul>\n<li>I/O模型的使用</li>\n<li>数据网络传输效率</li>\n<li>社区支持度</li>\n</ul><p>我分别来解释一下，首先来看I/O模型。什么是I/O模型呢？你可以近似地认为I/O模型就是操作系统执行I/O指令的方法。</p><p>主流的I/O模型通常有5种类型：阻塞式I/O、非阻塞式I/O、I/O多路复用、信号驱动I/O和异步I/O。每种I/O模型都有各自典型的使用场景，比如Java中Socket对象的阻塞模式和非阻塞模式就对应于前两种模型；而Linux中的系统调用select函数就属于I/O多路复用模型；大名鼎鼎的epoll系统调用则介于第三种和第四种模型之间；至于第五种模型，其实很少有Linux系统支持，反而是Windows系统提供了一个叫IOCP线程模型属于这一种。</p><p>你不必详细了解每一种模型的实现细节，通常情况下我们认为后一种模型会比前一种模型要高级，比如epoll就比select要好，了解到这一程度应该足以应付我们下面的内容了。</p><p>说了这么多，I/O模型与Kafka的关系又是什么呢？实际上Kafka客户端底层使用了Java的selector，selector在Linux上的实现机制是epoll，而在Windows平台上的实现机制是select。<strong>因此在这一点上将Kafka部署在Linux上是有优势的，因为能够获得更高效的I/O性能。</strong></p><p>其次是网络传输效率的差别。你知道的，Kafka生产和消费的消息都是通过网络传输的，而消息保存在哪里呢？肯定是磁盘。故Kafka需要在磁盘和网络间进行大量数据传输。如果你熟悉Linux，你肯定听过零拷贝（Zero Copy）技术，就是当数据在磁盘和网络进行传输时避免昂贵的内核态数据拷贝从而实现快速的数据传输。Linux平台实现了这样的零拷贝机制，但有些令人遗憾的是在Windows平台上必须要等到Java 8的60更新版本才能“享受”到这个福利。<strong>一句话总结一下，在Linux部署Kafka能够享受到零拷贝技术所带来的快速数据传输特性。</strong></p><p>最后是社区的支持度。这一点虽然不是什么明显的差别，但如果不了解的话可能比前两个因素对你的影响更大。简单来说就是，社区目前对Windows平台上发现的Kafka Bug不做任何承诺。虽然口头上依然保证尽力去解决，但根据我的经验，Windows上的Bug一般是不会修复的。<strong>因此，Windows平台上部署Kafka只适合于个人测试或用于功能验证，千万不要应用于生产环境。</strong></p><h2>磁盘</h2><p>如果问哪种资源对Kafka性能最重要，磁盘无疑是要排名靠前的。在对Kafka集群进行磁盘规划时经常面对的问题是，我应该选择普通的机械磁盘还是固态硬盘？前者成本低且容量大，但易损坏；后者性能优势大，不过单价高。我给出的建议是使用普通机械硬盘即可。</p><p>Kafka大量使用磁盘不假，可它使用的方式多是顺序读写操作，一定程度上规避了机械磁盘最大的劣势，即随机读写操作慢。从这一点上来说，使用SSD似乎并没有太大的性能优势，毕竟从性价比上来说，机械磁盘物美价廉，而它因易损坏而造成的可靠性差等缺陷，又由Kafka在软件层面提供机制来保证，故使用普通机械磁盘是很划算的。</p><p>关于磁盘选择另一个经常讨论的话题就是到底是否应该使用磁盘阵列（RAID）。使用RAID的两个主要优势在于：</p><ul>\n<li>提供冗余的磁盘存储空间</li>\n<li>提供负载均衡</li>\n</ul><p>以上两个优势对于任何一个分布式系统都很有吸引力。不过就Kafka而言，一方面Kafka自己实现了冗余机制来提供高可靠性；另一方面通过分区的概念，Kafka也能在软件层面自行实现负载均衡。如此说来RAID的优势就没有那么明显了。当然，我并不是说RAID不好，实际上依然有很多大厂确实是把Kafka底层的存储交由RAID的，只是目前Kafka在存储这方面提供了越来越便捷的高可靠性方案，因此在线上环境使用RAID似乎变得不是那么重要了。综合以上的考量，我给出的建议是：</p><ul>\n<li>追求性价比的公司可以不搭建RAID，使用普通磁盘组成存储空间即可。</li>\n<li>使用机械磁盘完全能够胜任Kafka线上环境。</li>\n</ul><h2>磁盘容量</h2><p>Kafka集群到底需要多大的存储空间？这是一个非常经典的规划问题。Kafka需要将消息保存在底层的磁盘上，这些消息默认会被保存一段时间然后自动被删除。虽然这段时间是可以配置的，但你应该如何结合自身业务场景和存储需求来规划Kafka集群的存储容量呢？</p><p>我举一个简单的例子来说明该如何思考这个问题。假设你所在公司有个业务每天需要向Kafka集群发送1亿条消息，每条消息保存两份以防止数据丢失，另外消息默认保存两周时间。现在假设消息的平均大小是1KB，那么你能说出你的Kafka集群需要为这个业务预留多少磁盘空间吗？</p><p>我们来计算一下：每天1亿条1KB大小的消息，保存两份且留存两周的时间，那么总的空间大小就等于1亿 * 1KB * 2 / 1000 / 1000 = 200GB。一般情况下Kafka集群除了消息数据还有其他类型的数据，比如索引数据等，故我们再为这些数据预留出10%的磁盘空间，因此总的存储容量就是220GB。既然要保存两周，那么整体容量即为220GB * 14，大约3TB左右。Kafka支持数据的压缩，假设压缩比是0.75，那么最后你需要规划的存储空间就是0.75 * 3 = 2.25TB。</p><p>总之在规划磁盘容量时你需要考虑下面这几个元素：</p><ul>\n<li>新增消息数</li>\n<li>消息留存时间</li>\n<li>平均消息大小</li>\n<li>备份数</li>\n<li>是否启用压缩</li>\n</ul><h2>带宽</h2><p>对于Kafka这种通过网络大量进行数据传输的框架而言，带宽特别容易成为瓶颈。事实上，在我接触的真实案例当中，带宽资源不足导致Kafka出现性能问题的比例至少占60%以上。如果你的环境中还涉及跨机房传输，那么情况可能就更糟了。</p><p>如果你不是超级土豪的话，我会认为你和我平时使用的都是普通的以太网络，带宽也主要有两种：1Gbps的千兆网络和10Gbps的万兆网络，特别是千兆网络应该是一般公司网络的标准配置了。下面我就以千兆网络举一个实际的例子，来说明一下如何进行带宽资源的规划。</p><p>与其说是带宽资源的规划，其实真正要规划的是所需的Kafka服务器的数量。假设你公司的机房环境是千兆网络，即1Gbps，现在你有个业务，其业务目标或SLA是在1小时内处理1TB的业务数据。那么问题来了，你到底需要多少台Kafka服务器来完成这个业务呢？</p><p>让我们来计算一下，由于带宽是1Gbps，即每秒处理1Gb的数据，假设每台Kafka服务器都是安装在专属的机器上，也就是说每台Kafka机器上没有混布其他服务，毕竟真实环境中不建议这么做。通常情况下你只能假设Kafka会用到70%的带宽资源，因为总要为其他应用或进程留一些资源。</p><p>根据实际使用经验，超过70%的阈值就有网络丢包的可能性了，故70%的设定是一个比较合理的值，也就是说单台Kafka服务器最多也就能使用大约700Mb的带宽资源。</p><p>稍等，这只是它能使用的最大带宽资源，你不能让Kafka服务器常规性使用这么多资源，故通常要再额外预留出2/3的资源，即单台服务器使用带宽700Mb / 3  ≈  240Mbps。需要提示的是，这里的2/3其实是相当保守的，你可以结合你自己机器的使用情况酌情减少此值。</p><p>好了，有了240Mbps，我们就可以计算1小时内处理1TB数据所需的服务器数量了。根据这个目标，我们每秒需要处理2336Mb的数据，除以240，约等于10台服务器。如果消息还需要额外复制两份，那么总的服务器台数还要乘以3，即30台。</p><p>怎么样，还是很简单的吧。用这种方法评估线上环境的服务器台数是比较合理的，而且这个方法能够随着你业务需求的变化而动态调整。</p><h2>小结</h2><p>所谓“兵马未动，粮草先行”。与其盲目上马一套Kafka环境然后事后费力调整，不如在一开始就思考好实际场景下业务所需的集群环境。在考量部署方案时需要通盘考虑，不能仅从单个维度上进行评估。相信今天我们聊完之后，你对如何规划Kafka生产环境一定有了一个清晰的认识。现在我来总结一下今天的重点：</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/04/bacf5700e4b145328f4d977575f28904.jpg?wh=3769*1533\" alt=\"\"></p><h2>开放讨论</h2><p>对于今天我所讲的这套评估方法，你有什么问题吗？你还能想出什么改进的方法吗？</p><p>欢迎你写下自己的思考或疑问，我们一起讨论 。如果你觉得有所收获，也欢迎把文章分享给你的朋友。</p>","neighbors":{"left":{"article_title":"05 | 聊聊Kafka的版本号","id":100726},"right":{"article_title":"07 | 最最最重要的集群参数配置（上）","id":101171}},"comments":[{"had_liked":false,"id":103913,"user_name":"mickle","can_delete":false,"product_type":"c1","uid":1201493,"ip_address":"","ucode":"1F89608B5E06C7","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/55/19ec7b0e.jpg","comment_is_top":true,"comment_ctime":1560564205,"is_pvip":false,"replies":[{"id":"37602","content":"277MB，乘以8，大致等于2300+Mb（小b）。带宽资源一般用Mbps而不是MBps衡量","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560571820,"ip_address":"","comment_id":103913,"utype":1}],"discussion_count":8,"race_medal":0,"score":"9.2233724507321999e+18","product_id":100029201,"comment_content":"1000*1000&#47;(60*60)=277,这个2336MB是怎么换算来的，还有什么要考虑的吗?","like_count":97,"discussions":[{"author":{"id":1243680,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fa/20/0f06b080.jpg","nickname":"凌空飞起的剪刀腿","note":"","ucode":"16FBBF4A3B54C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219154,"discussion_content":"1T＝1024GB。1GB＝1024MB，1MB＝1024KB，1KB＝1024B（字节）\n1TB=1024*1024MB=8*1024*1024Mb位\n那么8*1024*1024Mb/3600s=2330Mbps\n2330Mbps/234Mbps 约等于 10台服务器，每天需要2个副本，那么总共需要30台服务器","likes_number":24,"is_delete":false,"is_hidden":false,"ctime":1585740087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262533,"discussion_content":"预留2/3是因为备份2份,则需要对follower拉取预留一定带宽","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1589110518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"福","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399782,"discussion_content":"不是吧，预留的2/3用来给follower的话，那最后为什么用10*3，最后是30台，我觉得按道理10台就够了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633060224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":262533,"ip_address":""},"score":399782,"extra":""}]},{"author":{"id":2066119,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/hlgyFUQVCrhaO46VJkrR3fE9hvOWnnwKsAj9gzK4Yp70BmU1a06YkwS1vNexMqkttorodO2ZMtiajBMXo7seD8g/132","nickname":"Geek_Daniel","note":"","ucode":"9AC8E4D12FBC72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320227,"discussion_content":"工作了这么多年才知道带宽单位和存储单位有区别","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1604297887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262532,"discussion_content":"1Byte=8bit","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589110493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183964,"avatar":"https://static001.geekbang.org/account/avatar/00/12/10/dc/fc9efd01.jpg","nickname":"HELSING","note":"","ucode":"7F33BFCAA8219B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2155,"discussion_content":"最后这个为什么要乘8呀？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563291609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1012559,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/73/4f/abb7bfe3.jpg","nickname":"沙漠里的骆驼","note":"","ucode":"5EC18A71B3A594","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1183964,"avatar":"https://static001.geekbang.org/account/avatar/00/12/10/dc/fc9efd01.jpg","nickname":"HELSING","note":"","ucode":"7F33BFCAA8219B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4783,"discussion_content":"Byte=8bit","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1565738373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2155,"ip_address":""},"score":4783,"extra":""},{"author":{"id":1503506,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f1/12/7dac30d6.jpg","nickname":"你为啥那么牛","note":"","ucode":"1ABC604A54A8F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1183964,"avatar":"https://static001.geekbang.org/account/avatar/00/12/10/dc/fc9efd01.jpg","nickname":"HELSING","note":"","ucode":"7F33BFCAA8219B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342547,"discussion_content":"网络传输是按位传","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1610711219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2155,"ip_address":""},"score":342547,"extra":""}]}]},{"had_liked":false,"id":103947,"user_name":"A_NATE_👻","can_delete":false,"product_type":"c1","uid":1100176,"ip_address":"","ucode":"7AD5EF207B8395","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/90/c7fbf39e.jpg","comment_is_top":false,"comment_ctime":1560570160,"is_pvip":false,"replies":[{"id":"37730","content":"嗯嗯，专栏里面只是给出一个评估的方法。具体还要结合自己的实际情况来调整。通常我们认为SSD的顺序写TPS大约是HDD的4倍。除了纵向扩展使用SSD之外，也可以尝试一下横向扩展，增加更多的broker或HDD分散负载：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560686127,"ip_address":"","comment_id":103947,"utype":1}],"discussion_count":8,"race_medal":0,"score":"259258607920","product_id":100029201,"comment_content":"我们曾经也认为用普通硬盘就行，换成普通硬盘导致生产者堵塞写入负载偏高，换成SSD就没事了，我们每天消息数大概50亿。","like_count":61,"discussions":[{"author":{"id":1073829,"avatar":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","nickname":"TKbook","note":"","ucode":"F6E0E99CC79059","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32287,"discussion_content":"kafka这么高频的写入以及删除，ssd适合？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1571021826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454070,"discussion_content":"嗯嗯，专栏里面只是给出一个评估的方法。具体还要结合自己的实际情况来调整。通常我们认为SSD的顺序写TPS大约是HDD的4倍。除了纵向扩展使用SSD之外，也可以尝试一下横向扩展，增加更多的broker或HDD分散负载：）","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1560686127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2550743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","nickname":"if...else...","note":"","ucode":"D0565908C99695","race_medal":4,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385787,"discussion_content":"😂50亿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627274230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1027343,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/0f/cac1535a.jpg","nickname":"大水牛","note":"","ucode":"9CF2B21BA75C0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5948,"discussion_content":"想问 50 亿消息是什么业务啊\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566548234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2912918,"avatar":"","nickname":"Geek_284c06","note":"","ucode":"4BD6D4449D4F1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576868,"discussion_content":"50亿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655820346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2912918,"avatar":"","nickname":"Geek_284c06","note":"","ucode":"4BD6D4449D4F1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576867,"discussion_content":"你确实牛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655820340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104407,"avatar":"https://static001.geekbang.org/account/avatar/00/10/da/17/69cca649.jpg","nickname":"旗木卡卡","note":"","ucode":"2C05BFE91D6892","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":83744,"discussion_content":"这个量级完全不能按常规考虑了，最顶配的上。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576461105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1231713,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cb/61/b62d8a3b.jpg","nickname":"张立华","note":"","ucode":"173B938DD9478A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4689,"discussion_content":"能问下，每天50亿，你们实际部署用了多少台服务器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565662222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104311,"user_name":"蒙开强","can_delete":false,"product_type":"c1","uid":1317706,"ip_address":"","ucode":"61B3183781B9F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/4a/f9df2d06.jpg","comment_is_top":false,"comment_ctime":1560731666,"is_pvip":false,"replies":[{"id":"37794","content":"嗯嗯，对于producer而言，如果在乎数据持久性，那么应该设置acks=all，这样当出现你说的这个情况时，producer会被显式通知消息发送失败，从而可以重试。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560741057,"ip_address":"","comment_id":104311,"utype":1}],"discussion_count":1,"race_medal":0,"score":"199129227282","product_id":100029201,"comment_content":"老师，你好，你讲的这几个纬度很好，之前我们搭建一套kafka集群就不知道怎么去衡量，我再问一个相关问题，我个人觉得kafka会出现丢数据情况，比如某个分区的leader挂了，在切换选举到另外副本为leader时，这个副本还没同步之前的leader数据，这样数据就丢了","like_count":47,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454218,"discussion_content":"嗯嗯，对于producer而言，如果在乎数据持久性，那么应该设置acks=all，这样当出现你说的这个情况时，producer会被显式通知消息发送失败，从而可以重试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560741057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103936,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1560568527,"is_pvip":false,"replies":[{"id":"37603","content":"1. 这个700Mb只是经验值罢了。另外预留buffer的意思是即使你最好不要让broker常规占用700Mb的资源。一旦碰到峰值流量，很容易将带宽打满。故做了一些资源预留<br>2. 285M是大B，即字节啊，乘以8之后就是2336Mb。带宽资源一般用Mbps而非MBps衡量<br>3. 我没有谈及CPU，是因为通常情况下Kafka不太占用CPU，因此没有这方面的最佳实践出来。但有些情况下Kafka broker是很耗CPU的：1. server和client使用了不同的压缩算法；2. server和client版本不一致造成消息格式转换；3. broker端解压缩校验<br><br>其中前两个都能规避，第三个目前无法规避。不过相比带宽资源，CPU通常都不是瓶颈","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560572108,"ip_address":"","comment_id":103936,"utype":1}],"discussion_count":0,"race_medal":0,"score":"134704554703","product_id":100029201,"comment_content":"有三个问题请教一下老师:<br>1. 上文提到对于千兆网卡kafka服务器最多使用700M的带宽资源, 这700M的资源是单机使用的还是集群共用的, 为什么不能作为常规使用呢?<br>2. 文章举例是1小时1T的数据处理目标, 那一秒中是不是1024&#47;3600 = 0.284G = 285M, 请问下文章中的2336M是咋算出来的.<br>3. 文章中的例子kafka单机要达到240M的读写能力, CPU应该配几核的?","like_count":31},{"had_liked":false,"id":114179,"user_name":"李跃爱学习","can_delete":false,"product_type":"c1","uid":1347792,"ip_address":"","ucode":"F25C038C86324A","user_header":"https://static001.geekbang.org/account/avatar/00/14/90/d0/48037ba6.jpg","comment_is_top":false,"comment_ctime":1563246422,"is_pvip":false,"replies":[{"id":"41686","content":"为follower拉取留一些带宽","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1563274518,"ip_address":"","comment_id":114179,"utype":1}],"discussion_count":9,"race_medal":0,"score":"108937428822","product_id":100029201,"comment_content":"老师希望解答一下，之前也说明了Kafka 机器上没有混布其他服务，为什么常规需要预留2&#47;3，只能跑240Mbps，","like_count":26,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458542,"discussion_content":"为follower拉取留一些带宽","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563274518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"福","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399779,"discussion_content":"followe拉取预留2/3，那为什么最后面还要用10*3台，怎么感觉算重了","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1633059722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1453131,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4wiaKDwz4YI8B68hLd7qSa6SrIOqkBo67Y7gcIFevGHgaAKzbK5PoXcIJJhrmkzKyWvWOkYcMs66iav5EVbHZ9ag/132","nickname":"Geek__ILoveStudyAndWork","note":"","ucode":"47FFA5F59019CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"福","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":550562,"discussion_content":"同疑问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644587987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":399779,"ip_address":""},"score":550562,"extra":""},{"author":{"id":1119133,"avatar":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","nickname":"Andy","note":"","ucode":"4BCA899B8E4E85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"福","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":582028,"discussion_content":"同疑问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659147581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":399779,"ip_address":"陕西"},"score":582028,"extra":""}]},{"author":{"id":1102385,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d2/31/f1bec7fc.jpg","nickname":"汉斯·冯·拉特","note":"","ucode":"29F14B0D938A02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290141,"discussion_content":"原来如此，学习了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1594356262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1547667,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9d/93/4159edaa.jpg","nickname":"朴素柠檬c","note":"","ucode":"2D4CBB70D801B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327224,"discussion_content":"就那么一根网线，上传下载一起用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605771217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262530,"discussion_content":"原来如此!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589110443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1949479,"avatar":"","nickname":"张瑞松","note":"","ucode":"EB765ADCBF3049","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222127,"discussion_content":"我想问下，基于kafka 肖峰填谷的特性，是不是可以对网络和性能实时性要求可以降低一点？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586098229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1736462,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/7f/0e/e3a8dbd9.jpg","nickname":"Liujun","note":"","ucode":"3DB1F3CA57B5B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1949479,"avatar":"","nickname":"张瑞松","note":"","ucode":"EB765ADCBF3049","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389258,"discussion_content":"那当然了，实时性要求高MQ就不合适，RPC实时性高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629194176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222127,"ip_address":""},"score":389258,"extra":""}]}]},{"had_liked":false,"id":104440,"user_name":"Geek_Sue","can_delete":false,"product_type":"c1","uid":1580774,"ip_address":"","ucode":"B2C9400D72BB1D","user_header":"","comment_is_top":false,"comment_ctime":1560754624,"is_pvip":false,"replies":[{"id":"37836","content":"目前社区对Docker方案支持的并不是太好，主要都是一些第三方公司还有Confluent公司在提供解决方案。在Docker上部署我个人觉得没有太大的不同，只是注意带宽资源吧，因为常见的做法都是买一台性能超强的服务器然后在上面启动多个Docker容器，虽然CPU、RAM、磁盘都能承受，但单机还是受限于带宽的。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560818213,"ip_address":"","comment_id":104440,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78870165952","product_id":100029201,"comment_content":"胡老师，您好，我想请问下，我们公司的环境是基于Docker这种微服务架构，那么kafka部署在Docker容器中部署方案是否会有一些不同呢？","like_count":18,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454272,"discussion_content":"目前社区对Docker方案支持的并不是太好，主要都是一些第三方公司还有Confluent公司在提供解决方案。在Docker上部署我个人觉得没有太大的不同，只是注意带宽资源吧，因为常见的做法都是买一台性能超强的服务器然后在上面启动多个Docker容器，虽然CPU、RAM、磁盘都能承受，但单机还是受限于带宽的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560818213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103891,"user_name":"墙角儿的花","can_delete":false,"product_type":"c1","uid":1258474,"ip_address":"","ucode":"EE5CAD76175CCF","user_header":"","comment_is_top":false,"comment_ctime":1560560459,"is_pvip":false,"replies":[{"id":"37588","content":"这里是指单机带宽，机房总带宽不可能这么小的。。。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560566107,"ip_address":"","comment_id":103891,"utype":1}],"discussion_count":4,"race_medal":0,"score":"65985069899","product_id":100029201,"comment_content":"弱弱的问一句老师，“根据这个目标，我们每秒需要处理 2336Mb 的数据，除以 240，约等于 10 台服务器”，机房入口带宽1Gbps,怎么能做到1秒处理2336Mb的数据的","like_count":16,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454042,"discussion_content":"这里是指单机带宽，机房总带宽不可能这么小的。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560566107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564769,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Xibd2t0dbwmTUayQHxUSEicWvDCCW9u9laZoJRynntqVmj3Ywy0knwZSyb2G1u4qI5NtMAoQH9Iodt60QzK6TLoA/132","nickname":"Geek_dedf9a","note":"","ucode":"A484D98D595ED8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7903,"discussion_content":"也有同样问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567703810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1450353,"avatar":"https://static001.geekbang.org/account/avatar/00/16/21/71/f881973f.jpg","nickname":"乔康","note":"","ucode":"332B93AB67D6CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":562773,"discussion_content":"那么机房的总带宽一般为多少？需要考虑在内吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649894890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1503506,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f1/12/7dac30d6.jpg","nickname":"你为啥那么牛","note":"","ucode":"1ABC604A54A8F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342549,"discussion_content":"也就是说 集群每天机器的单机网络接口 处理速度要足够大","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610712252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104307,"user_name":"疯琴","can_delete":false,"product_type":"c1","uid":1099379,"ip_address":"","ucode":"82ACAA4A27753D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1560731290,"is_pvip":false,"replies":[{"id":"37764","content":"没有具体的关系。<br><br>“一块盘一个partiton比一块盘多个partiton要快么？” 没有实验数据支撑，单纯从分析角度来看我是认同的。当某块磁盘上有太多的分区时引入了很多随机IO拖慢了性能。事实上，阿里的RocketMQ一直宣称当单磁盘超过256分区时Kafka性能不如RocketMQ，原因也在于此。<br>数据来源：http:&#47;&#47;jm.taobao.org&#47;2016&#47;04&#47;07&#47;kafka-vs-rocketmq-topic-amout&#47;","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560733162,"ip_address":"","comment_id":104307,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57395306138","product_id":100029201,"comment_content":"老师，partitons的数量和硬盘的数量有匹配关系么？一块盘一个partiton比一块盘多个partiton要快么？是线性的关系么？","like_count":13,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454215,"discussion_content":"没有具体的关系。\n\n“一块盘一个partiton比一块盘多个partiton要快么？” 没有实验数据支撑，单纯从分析角度来看我是认同的。当某块磁盘上有太多的分区时引入了很多随机IO拖慢了性能。事实上，阿里的RocketMQ一直宣称当单磁盘超过256分区时Kafka性能不如RocketMQ，原因也在于此。\n数据来源：http://jm.taobao.org/2016/04/07/kafka-vs-rocketmq-topic-amout/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560733162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104472,"user_name":"南辕北辙","can_delete":false,"product_type":"c1","uid":1214502,"ip_address":"","ucode":"03EC406AE0D591","user_header":"https://static001.geekbang.org/account/avatar/00/12/88/26/b8c53cee.jpg","comment_is_top":false,"comment_ctime":1560760799,"is_pvip":false,"replies":[{"id":"37837","content":"Leader副本和Follower副本必然在不同的Broker上，而生产环境一般也不推荐将多台Broker混布到同一台服务器上。当然服务器性能强劲的话也未尝不可：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560818293,"ip_address":"","comment_id":104472,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44510433759","product_id":100029201,"comment_content":"这个假设是：follower与leader处于不同的broker而实际环境中不推荐单机多broker的架构  摘自老师回复其他同学。<br>老师这个的意思是不是生产上的架构通常一台服务器上只会有leader或者follow的分区，而不会二者存在一台服务器上，所以根据带宽计算服务器数量时，根据备份数为2，所以就直接✖️3了。","like_count":10,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454282,"discussion_content":"Leader副本和Follower副本必然在不同的Broker上，而生产环境一般也不推荐将多台Broker混布到同一台服务器上。当然服务器性能强劲的话也未尝不可：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560818293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103847,"user_name":"Royal","can_delete":false,"product_type":"c1","uid":1213755,"ip_address":"","ucode":"74BCA314755C69","user_header":"https://static001.geekbang.org/account/avatar/00/12/85/3b/cfdc8bf2.jpg","comment_is_top":false,"comment_ctime":1560529911,"is_pvip":false,"replies":[{"id":"37573","content":"kafka producer速率可以监控这个JMX指标：<br><br>kafka.producer:type=[consumer|producer|connect]-node-metrics,client-id=([-.\\w]+),node-id=([0-9]+)","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560558817,"ip_address":"","comment_id":103847,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44510202871","product_id":100029201,"comment_content":"您好，我想请教下kafka metric相关的知识，比如kafka produce速率获取等","like_count":10,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454020,"discussion_content":"kafka producer速率可以监控这个JMX指标：\n\nkafka.producer:type=[consumer|producer|connect]-node-metrics,client-id=([-.\\w]+),node-id=([0-9]+)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560558817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611787,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eru0Vb9yfvHic3P9nRz48Vo9jic3kdIeTModyhFa3bz3j0EdIRxVMtZzQUs3AJoiaQQQwmqdvgRbLecQ/132","nickname":"doubleWei","note":"","ucode":"C699100F076E76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5662,"discussion_content":"顺着这位兄弟的问题，请问有没有查看network和io请求处理时间的指标，通过这个来判断是服务处理网络请求慢了还是io请求满了，从而查看瓶颈点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566408291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104739,"user_name":"黄智荣","can_delete":false,"product_type":"c1","uid":1027823,"ip_address":"","ucode":"3C84C8654CCB11","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/ef/cbb8d881.jpg","comment_is_top":false,"comment_ctime":1560824884,"is_pvip":false,"replies":[{"id":"38013","content":"RAID-5具体有多少性能损失不好说，但肯定会有的，最好还是以测试结果为准。另外咱们是否可以更多地利用Kafka在软件层面提供的高可靠性来保证数据完整性呢？不用单纯依赖于硬件。<br><br>至于评估方法，磁盘要相对复杂一些。毕竟当topic数量很多的时候磁盘不一定都是顺序写。不过你姑且可以做这样的测试：做一个单partition的topic，测试一下该topic对应的TPS，然后用你磁盘的TPS去核算单块磁盘上大概能放多少个partition。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560903757,"ip_address":"","comment_id":104739,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35920563252","product_id":100029201,"comment_content":"老师您好,我们现在用的网络是10Gb,的万兆网.这样主要性能瓶性可会在硬盘IO上,我们配置了24坏的sas 机械盘。<br>刚才老师主要从容量跟网络性能,评估集群的规模。<br>我想问一下,怎么从硬盘的IO性能,去评估集群的规模?<br>还有做6个盘组成一个raid5,比直接用裸盘,性能会有多大的损失?","like_count":8,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454399,"discussion_content":"RAID-5具体有多少性能损失不好说，但肯定会有的，最好还是以测试结果为准。另外咱们是否可以更多地利用Kafka在软件层面提供的高可靠性来保证数据完整性呢？不用单纯依赖于硬件。\n\n至于评估方法，磁盘要相对复杂一些。毕竟当topic数量很多的时候磁盘不一定都是顺序写。不过你姑且可以做这样的测试：做一个单partition的topic，测试一下该topic对应的TPS，然后用你磁盘的TPS去核算单块磁盘上大概能放多少个partition。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560903757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336037,"avatar":"https://static001.geekbang.org/account/avatar/00/14/62/e5/d7583ce4.jpg","nickname":"bz","note":"","ucode":"FF7432FD129D7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2282,"discussion_content":"为什么当topic数量很多的时候磁盘不一定都是顺序写？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563436691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104276,"user_name":"Eagles","can_delete":false,"product_type":"c1","uid":1115950,"ip_address":"","ucode":"BADAC7969475F2","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/2e/f6a2dc27.jpg","comment_is_top":false,"comment_ctime":1560706172,"is_pvip":false,"replies":[{"id":"37762","content":"会占带宽的，这也是预留的部分之一，就是给非业务活动留的带宽资源，包括操作系统其他进程消耗的带宽啊。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560732904,"ip_address":"","comment_id":104276,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35920444540","product_id":100029201,"comment_content":"老师你好，Leader Follower 之间的数据冗余复制会不会占带宽？如果占带宽且有两个以上的follows，岂不是把预留的2&#47;3的带宽全部用掉了。","like_count":8,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454199,"discussion_content":"会占带宽的，这也是预留的部分之一，就是给非业务活动留的带宽资源，包括操作系统其他进程消耗的带宽啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560732904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172228,"user_name":"CDz","can_delete":false,"product_type":"c1","uid":1114779,"ip_address":"","ucode":"A23BEE1C4A5922","user_header":"https://static001.geekbang.org/account/avatar/00/11/02/9b/b1a3c60d.jpg","comment_is_top":false,"comment_ctime":1579136657,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31643907729","product_id":100029201,"comment_content":"<br>系统选择：Linux为主<br>原因：<br>* 社区支持<br>* IO模型<br>    * kafka底层是使用Java的NIO，在Linux在Java默认是用的epoll实现相比select更高效<br>* 数据传输<br>    * Linux环境下JavaNIO使用零拷贝技术（zero copy）<br>    * Win环境下只有在Java8 后面版本才支持<br><br>磁盘：<br>使用机械硬盘还是SSD？<br><br>因为kafka更多的是顺序读写，很大程度上避免了机械硬盘的随机读写慢问题。所以在数据量不多的情况下，使用机械硬盘物美价廉<br><br>机械硬盘是否需要RAID?<br><br>综合考虑，数据量并不是特别大的情况下，并不需要，因为kafka本身有集群备份的功能。<br><br>磁盘容量需要多大？<br><br>一般默认消息保存两周，根据自己的实际每天消息数量，进行换算。换算时留出10%的磁盘空间即可。<br><br>考虑点：<br>* 每日消息量、消息大小<br>* 保存时间<br>* 备份数量<br>* 是否开启压缩（消耗CPU）<br><br>宽带：<br><br>网络宽带单位与磁盘存储单位是什么关系？<br><br>存储单位一般使用的字节(Byte)为基本单位，数据传输大多使用的是“位”(bit)<br><br>1Byte = 8bit<br><br>所以换算下来，平时说的1Gbps的网络实际速度为：<br><br>1Gbps = 1024Mb(位)&#47;8=128MB(字节)&#47;s;<br><br>Over;<br><br>","like_count":7},{"had_liked":false,"id":103901,"user_name":"Nero","can_delete":false,"product_type":"c1","uid":1175079,"ip_address":"","ucode":"BEAE3A8AADDD67","user_header":"https://static001.geekbang.org/account/avatar/00/11/ee/27/5b15fa63.jpg","comment_is_top":false,"comment_ctime":1560562001,"is_pvip":false,"replies":[{"id":"37590","content":"1024*1024&#47;3600*8","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560566349,"ip_address":"","comment_id":103901,"utype":1}],"discussion_count":4,"race_medal":0,"score":"31625333073","product_id":100029201,"comment_content":"好了，有了 240Mbps，我们就可以计算 1 小时内处理 1TB 数据所需的服务器数量了。根据这个目标，我们每秒需要处理 2336Mb 的数据，         老师这一段中2334Mb是怎么算出来的，没看懂，能否解释一下，谢谢。","like_count":7,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454048,"discussion_content":"1024*1024/3600*8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560566349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023688,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","nickname":"yswang","note":"","ucode":"B9CB98838B215C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":68,"discussion_content":"这个就像我们在运行商办理宽带，告诉你是 100 兆带宽，其实是 100Mb （小 b），而不是 100 MB（大 B），1Byte = 8bit 。因此，你家的实际带宽是 100Mb/8 = 12MB，反映在下载下行速度最大是 10MB/s 左右，而不是感觉的 100MB/s。 呵呵。","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1561080383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"行则将至","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1023688,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","nickname":"yswang","note":"","ucode":"B9CB98838B215C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1308,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562550941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":68,"ip_address":""},"score":1308,"extra":""}]},{"author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"杯莫停","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294258,"discussion_content":"带宽的单位是bps换算成网速要除以8 变成B/s","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595842218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104065,"user_name":"QQ怪","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1560608556,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23035445036","product_id":100029201,"comment_content":"老师尽然把我模糊不清的GB和Gb的区别给复习了一遍😂","like_count":5,"discussions":[{"author":{"id":1023688,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","nickname":"yswang","note":"","ucode":"B9CB98838B215C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":69,"discussion_content":"呵呵，\bB = Byte 字节， b = bit 比特位， 1Byte=8bit","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1561080532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103897,"user_name":"坤蛰","can_delete":false,"product_type":"c1","uid":1285244,"ip_address":"","ucode":"48C1616B27A99F","user_header":"https://static001.geekbang.org/account/avatar/00/13/9c/7c/c92f8a53.jpg","comment_is_top":false,"comment_ctime":1560560848,"is_pvip":false,"replies":[{"id":"37589","content":"两个可能的原因，①就是没有新消息可供消费了，②某天消息格式有问题导致解析不了了，不过这种情况很罕见，一般是因为网络传输出问题导致","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560566218,"ip_address":"","comment_id":103897,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23035397328","product_id":100029201,"comment_content":"您好！我在使用Kafka中，出现消息阻塞不消费的问题，换了消费组之后过段时间又不消费了，不知什么原因，望老师解惑。谢谢！","like_count":5,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454045,"discussion_content":"两个可能的原因，①就是没有新消息可供消费了，②某天消息格式有问题导致解析不了了，不过这种情况很罕见，一般是因为网络传输出问题导致","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560566218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213190,"user_name":"Joe Black","can_delete":false,"product_type":"c1","uid":1052528,"ip_address":"","ucode":"21FE222A286445","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/70/c8680841.jpg","comment_is_top":false,"comment_ctime":1588326257,"is_pvip":false,"replies":[{"id":"79127","content":"很多公司的机器没有这么强劲的性能......","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1588399491,"ip_address":"","comment_id":213190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18768195441","product_id":100029201,"comment_content":"发现问的最多的竟然是Byte和Bit的问题...我们用的40Gb的网络，服务器内存290多G，24块万转SAS盘，按老师说的，几十台这样的服务器可以处理很大规模的数据量了吧，都不用怎么规划…","like_count":4,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493704,"discussion_content":"很多公司的机器没有这么强劲的性能......","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588399491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104501,"user_name":"疯琴","can_delete":false,"product_type":"c1","uid":1099379,"ip_address":"","ucode":"82ACAA4A27753D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1560767525,"is_pvip":false,"replies":[{"id":"37841","content":"是的，有这个可能。现在的分布式集群都倾向于使用普通性能的机器搭建，因此单台单Broker性价比很高的。<br><br>当然我也知道很多公司采购了超强的服务器，然后在上面跑多个实例。这么做的原因是因为机器价格其实很便宜，贵的是IDC机架位（至少在北京是这样），因此两个方案都有自己合理的地方吧。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560818655,"ip_address":"","comment_id":104501,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18740636709","product_id":100029201,"comment_content":"老师，如果单机起多个broker是否有可能造成同一个partition的多个副本在一台机器上，损失了容灾能力？","like_count":5,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454297,"discussion_content":"是的，有这个可能。现在的分布式集群都倾向于使用普通性能的机器搭建，因此单台单Broker性价比很高的。\n\n当然我也知道很多公司采购了超强的服务器，然后在上面跑多个实例。这么做的原因是因为机器价格其实很便宜，贵的是IDC机架位（至少在北京是这样），因此两个方案都有自己合理的地方吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560818655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253112,"user_name":"浮石沉木","can_delete":false,"product_type":"c1","uid":2223167,"ip_address":"","ucode":"D585768321B84A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mQddXC7nRiaKHTwdficicTB3bH0q5ic5UoSab51Omic7eyLBz0SNcvbLpQnNib7zP1yJFm7xxx4ia81iahfibRVnbTwHmhw/132","comment_is_top":false,"comment_ctime":1602601686,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14487503574","product_id":100029201,"comment_content":"带宽、磁盘单位问题看这个：<br>https:&#47;&#47;www.cnblogs.com&#47;linckle&#47;archive&#47;2007&#47;12&#47;03&#47;981396.html","like_count":3},{"had_liked":false,"id":189168,"user_name":"漩涡鸣人","can_delete":false,"product_type":"c1","uid":1503139,"ip_address":"","ucode":"0C02F07B2ABD5C","user_header":"https://wx.qlogo.cn/mmopen/vi_32/mvxl1xzYcAfJERgGHBCswnbeibZJmS1IlP1z9P7KsSh2EPuM78DqPKPicAmHXPYUib6RPcjGcf5vrXkQXAiaLorB2w/132","comment_is_top":false,"comment_ctime":1584462645,"is_pvip":false,"replies":[{"id":"73068","content":"说实话感觉不像是Kafka的问题，有可能是序列化&#47;反序列化的问题。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1584579667,"ip_address":"","comment_id":189168,"utype":1}],"discussion_count":4,"race_medal":0,"score":"14469364533","product_id":100029201,"comment_content":"老师您好，我遇到一个场景 kafka数据 网络丢包会不会 导致json 字段丢失。比如 {姓名，年龄，生日，{其他信息}  }  嵌套的其他信息数据丢失变成null ","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487623,"discussion_content":"说实话感觉不像是Kafka的问题，有可能是序列化/反序列化的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584579667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1736462,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/7f/0e/e3a8dbd9.jpg","nickname":"Liujun","note":"","ucode":"3DB1F3CA57B5B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389259,"discussion_content":"丢包之后，你连解析消息都会出错，不可能时丢包问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629194475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1503139,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/mvxl1xzYcAfJERgGHBCswnbeibZJmS1IlP1z9P7KsSh2EPuM78DqPKPicAmHXPYUib6RPcjGcf5vrXkQXAiaLorB2w/132","nickname":"漩涡鸣人","note":"","ucode":"0C02F07B2ABD5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217377,"discussion_content":"好的 谢谢老师 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585551120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1195258,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/fa/e2990931.jpg","nickname":"文敦复","note":"","ucode":"B8F4A6BD5D7805","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1503139,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/mvxl1xzYcAfJERgGHBCswnbeibZJmS1IlP1z9P7KsSh2EPuM78DqPKPicAmHXPYUib6RPcjGcf5vrXkQXAiaLorB2w/132","nickname":"漩涡鸣人","note":"","ucode":"0C02F07B2ABD5C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337094,"discussion_content":"Kafka 底层通信是基于 TCP，应该不会吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608795034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":217377,"ip_address":""},"score":337094,"extra":""}]}]},{"had_liked":false,"id":142361,"user_name":"夜影如歌","can_delete":false,"product_type":"c1","uid":1148115,"ip_address":"","ucode":"22D6B4BD4521C4","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/d3/ccaea6aa.jpg","comment_is_top":false,"comment_ctime":1571359744,"is_pvip":true,"replies":[{"id":"54914","content":"嗯嗯，是的。其实leader也是副本，副本有两类：leader和follower","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1571361445,"ip_address":"","comment_id":142361,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14456261632","product_id":100029201,"comment_content":"1亿条消息保存两份，是指一个leader一个副本吧<br>","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471082,"discussion_content":"嗯嗯，是的。其实leader也是副本，副本有两类：leader和follower","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571361445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104173,"user_name":"小头针","can_delete":false,"product_type":"c1","uid":1422920,"ip_address":"","ucode":"21EB7CDE48EC9B","user_header":"https://static001.geekbang.org/account/avatar/00/15/b6/48/1275e0ce.jpg","comment_is_top":false,"comment_ctime":1560674904,"is_pvip":false,"replies":[{"id":"37742","content":"不一定是带宽这么底层的问题，更像是Storm流处理的不正确导致的。Storm+Kafka要实现端到端的精确一次处理语义可谓是非常的难。事实上， 其他流处理框架也不敢保证百分之百的正确性。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560687724,"ip_address":"","comment_id":104173,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14445576792","product_id":100029201,"comment_content":"在生产环境，实时推送过来的数据一份是直接存储到oracle，一份是接收后写入到kafka 对应的topic，storm程序消费后写入到kafka和elasticsearch ，经常会出现当天的oracle存储数据和elasticsearch存储的数据量有差异，有时候能差异率达到15%，胡老师这里面是否有带宽的原因呢？","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454156,"discussion_content":"不一定是带宽这么底层的问题，更像是Storm流处理的不正确导致的。Storm+Kafka要实现端到端的精确一次处理语义可谓是非常的难。事实上， 其他流处理框架也不敢保证百分之百的正确性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560687724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1195258,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/fa/e2990931.jpg","nickname":"文敦复","note":"","ucode":"B8F4A6BD5D7805","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337095,"discussion_content":"消息还存在积压？消费逻辑导致数据一致？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608795117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336037,"avatar":"https://static001.geekbang.org/account/avatar/00/14/62/e5/d7583ce4.jpg","nickname":"bz","note":"","ucode":"FF7432FD129D7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2285,"discussion_content":"定位出问题了么？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563437357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103880,"user_name":"Fouy_飞虎","can_delete":false,"product_type":"c1","uid":1105376,"ip_address":"","ucode":"EF792D1A96BFDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/e0/034ce26f.jpg","comment_is_top":false,"comment_ctime":1560559113,"is_pvip":false,"replies":[{"id":"37587","content":"带宽单位一般是小B，也就是比特。另外字节就是BYTE啊","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560566032,"ip_address":"","comment_id":103880,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14445461001","product_id":100029201,"comment_content":"您好，对于“带宽是 1Gbps，即每秒处理 1Gb 的数据”。1Gbps传输的是byte，我们通常说的存储是字节为单位的。8byte=1字节，所以我认为应该是“带宽是 1Gbps，即每秒处理 1&#47;8 Gb 的数据”","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454037,"discussion_content":"带宽单位一般是小B，也就是比特。另外字节就是BYTE啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560566032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1050992,"avatar":"https://static001.geekbang.org/account/avatar/00/10/09/70/4b3cbed2.jpg","nickname":"王小邪","note":"","ucode":"25546DD16B8AF4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3366,"discussion_content":"应该是1byte=8bit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564444460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023688,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","nickname":"yswang","note":"","ucode":"B9CB98838B215C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":70,"discussion_content":"小 b 指的是 bit 比特位 ， 大 B 指的是 Byte 字节","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561080696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274988,"user_name":"nextforevershit","can_delete":false,"product_type":"c1","uid":1601052,"ip_address":"","ucode":"606F238E0F189B","user_header":"","comment_is_top":false,"comment_ctime":1611242954,"is_pvip":false,"replies":[{"id":"99827","content":"emmm...... 一般我们开发的时候确实不太容易接触到这些底层细节。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1611315687,"ip_address":"","comment_id":274988,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10201177546","product_id":100029201,"comment_content":"看了下大家的评论，好多都在纠结2336Mb，作为开发人员而且是要学习Kafka的开发人员，竟然连bit和byte都没搞清楚，唉.....，难道大家都没注意你们家里的实际宽带速度和购买的套餐速度差异很大嘛，就是计算单位不同呀！！！<br>最后，还是膜拜胡老师！","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514180,"discussion_content":"emmm...... 一般我们开发的时候确实不太容易接触到这些底层细节。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611315687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215819,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1589109908,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10179044500","product_id":100029201,"comment_content":"做下笔记<br><br>操作系统 Linux<br> I&#47;O 模型的使用(epoll 系统调用)<br> 数据网络传输效率(需要在磁盘和网络间进行大量数据传输,零拷贝（Zero Copy）技术,避免昂贵的内核态数据拷贝从而实现快速地数据传输)<br> 社区支持度<br>磁盘(机械硬盘)<br> 使用的方式多是顺序读写操作，一定程度上规避了机械磁盘最大的劣势，即随机读写操作慢<br>磁盘容量<br> 根据实际业务,消息数,消息大小,备份数,是否压缩,预留20%<br>带宽<br> 超过70%的带宽阈值可能会丢包可能<br> 1Gbps 的千兆网络,即每秒处理 1Gb 的数据<br> 预留2&#47;3网络资源给其他资源使用 <br> kafka使用的是 240Mbps,假设1小时处理1T数据,那么每秒处理的数据为 1000 * 1000  &#47; 3600 MBps * 8 = 2330Mbps<br> 2330 &#47; 240 = 10台服务器,额外备份则为30台<br>","like_count":2},{"had_liked":false,"id":140537,"user_name":"song218888","can_delete":false,"product_type":"c1","uid":1057087,"ip_address":"","ucode":"D6A0559B4709E1","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/3f/7e3e9dc4.jpg","comment_is_top":false,"comment_ctime":1570978113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10160912705","product_id":100029201,"comment_content":"读到本节为止，课程讲的非常好，特别是这一节关于部署集群需要考虑有哪些点，很受益","like_count":2},{"had_liked":false,"id":119493,"user_name":"Giant","can_delete":false,"product_type":"c1","uid":1158350,"ip_address":"","ucode":"132F0642464AF7","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/ce/a1939421.jpg","comment_is_top":false,"comment_ctime":1564619308,"is_pvip":true,"replies":[{"id":"43874","content":"嗯，没有绝对好的方案，根据实际需要选择合适的就行：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1564628045,"ip_address":"","comment_id":119493,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10154553900","product_id":100029201,"comment_content":"磁盘不做raid如果后面某台broker挂了，重新上线rebalance过程会消耗很多带宽，虽然可以减少topic保留时间来减少rebalance同步的数据量，但个人感觉还是做raid10比较靠谱，故障率低一些。不知道是否有关于这部分更好的解决方案？","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460928,"discussion_content":"嗯，没有绝对好的方案，根据实际需要选择合适的就行：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564628045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111363,"user_name":"金hb.Ryan 冷空氣駕到","can_delete":false,"product_type":"c1","uid":1222233,"ip_address":"","ucode":"CAD363576696E4","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/59/1689ea0c.jpg","comment_is_top":false,"comment_ctime":1562548149,"is_pvip":false,"replies":[{"id":"40698","content":"尽量大一点，最好10GB+以上的","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1562637308,"ip_address":"","comment_id":111363,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10152482741","product_id":100029201,"comment_content":"请问对线上内存会有要求么<br>","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457318,"discussion_content":"尽量大一点，最好10GB+以上的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562637308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103944,"user_name":"曹飞","can_delete":false,"product_type":"c1","uid":1527158,"ip_address":"","ucode":"9D0D2748560260","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/76/d47a65d8.jpg","comment_is_top":false,"comment_ctime":1560569527,"is_pvip":false,"replies":[{"id":"37649","content":"Kafka 1.1开始正式支持JBOD了。再说Kafka本身在软件层面也提供了冗余的机制来对抗磁盘损坏。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560642233,"ip_address":"","comment_id":103944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10150504119","product_id":100029201,"comment_content":"老师您好，您文章中讲到磁盘方面可以抛弃RAID,直接使用普通磁盘上去。那么一旦这块磁盘出问题了，数据不就丢失了吗。如果raid的话，还有其他磁盘有相应的冗余数据的。麻烦帮忙解答下，谢谢！！！","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454068,"discussion_content":"Kafka 1.1开始正式支持JBOD了。再说Kafka本身在软件层面也提供了冗余的机制来对抗磁盘损坏。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560642233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131163,"user_name":"megachilles","can_delete":false,"product_type":"c1","uid":1387714,"ip_address":"","ucode":"14911989EEC6CB","user_header":"https://static001.geekbang.org/account/avatar/00/15/2c/c2/b365bb96.jpg","comment_is_top":false,"comment_ctime":1567657794,"is_pvip":false,"replies":[{"id":"49810","content":"这只是保守估计，因为不想让kafka永远在这么高位吃这么多网卡","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1567731062,"ip_address":"","comment_id":131163,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862625090","product_id":100029201,"comment_content":"故通常要再额外预留出 2&#47;3 的资源<br>——————为什么要额外预留出呢？","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466318,"discussion_content":"这只是保守估计，因为不想让kafka永远在这么高位吃这么多网卡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567731062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126461,"user_name":"Geek_b809ff","can_delete":false,"product_type":"c1","uid":1288329,"ip_address":"","ucode":"F3F17E99F3AA0B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoPY23R9RRSfBeTJUlyc612VlodjAaWWBNiay9tPydkrd6b9NA8GNibdibnFibTsx94ItHE4jvQwprNzA/132","comment_is_top":false,"comment_ctime":1566388785,"is_pvip":false,"replies":[{"id":"46842","content":"你的主题test创建出了吗","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1566440927,"ip_address":"","comment_id":126461,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5861356081","product_id":100029201,"comment_content":"老师，请问一直报这个错是因为什么：<br> Error while fetching metadata with correlation id 101 : {test=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient)<br><br>另外，server.properties里面下面这几个参数应该怎么配置：<br>listeners=PLAINTEXT:&#47;&#47;:9092<br>advertised.listeners=PLAINTEXT:&#47;&#47;:9092<br>istener.security.protocol.map<br><br>老师看到帮忙回复下，困扰一天了","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464000,"discussion_content":"你的主题test创建出了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566440927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262526,"discussion_content":"官网有教程...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589110089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1288329,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoPY23R9RRSfBeTJUlyc612VlodjAaWWBNiay9tPydkrd6b9NA8GNibdibnFibTsx94ItHE4jvQwprNzA/132","nickname":"Geek_b809ff","note":"","ucode":"F3F17E99F3AA0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5721,"discussion_content":"test主题创建了，用其它的主题去试也是不行的，这个是否跟zookeeper有关","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566445230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104956,"user_name":"Bin滨","can_delete":false,"product_type":"c1","uid":1298294,"ip_address":"","ucode":"7F113EF3AF81E9","user_header":"https://static001.geekbang.org/account/avatar/00/13/cf/76/9e413c61.jpg","comment_is_top":false,"comment_ctime":1560894240,"is_pvip":true,"replies":[{"id":"38034","content":"是指30台broker的意思：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560906117,"ip_address":"","comment_id":104956,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855861536","product_id":100029201,"comment_content":"“根据这个目标，我们每秒需要处理 2336Mb 的数据，除以 240，约等于 10 台服务器， 如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3，即 30 台。<br><br>请问一下， 这里说的30台服务器是指 10 个kafka cluster， 每个cluster 有3 brokers? 消息写道leader broker 的topic partition 上， 然后用参数 replication.factor 去做topic的消息备份吗? 多谢！<br><br><br>","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454503,"discussion_content":"是指30台broker的意思：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560906117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104132,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1560662169,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5855629465","product_id":100029201,"comment_content":"感觉有几个知识盲点：I&#47;O模型、零拷贝和RAID。","like_count":1},{"had_liked":false,"id":359372,"user_name":"距离30米","can_delete":false,"product_type":"c1","uid":1516600,"ip_address":"四川","ucode":"5566D9AB9E47DE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wBjvGCCZmO0Bic0DrnG466y6hwPkibGevAV6E6FPfQEricvw5toL7a2HSgjhI83cCiadrUibIyVibkgbbMOHVxo7HA8Q/132","comment_is_top":false,"comment_ctime":1665481052,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665481052","product_id":100029201,"comment_content":"因为kafka是部署在java虚拟机的，所以jvm也需要考虑","like_count":0},{"had_liked":false,"id":353969,"user_name":"Geek_4a6e69","can_delete":false,"product_type":"c1","uid":2882400,"ip_address":"云南","ucode":"EE003DDF8BC99D","user_header":"","comment_is_top":false,"comment_ctime":1659962715,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1659962715","product_id":100029201,"comment_content":"老师你好，这里每秒处理2336Mb，这个数据已经超过了 1Gbms的带宽了。 是不是意味着每秒，网络传过来的数据最多1Gb，这个以是瓶颈，实际上可能还达不到1Gb","like_count":0},{"had_liked":false,"id":352187,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1658449727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658449727","product_id":100029201,"comment_content":"这课讲的真棒！","like_count":0},{"had_liked":false,"id":345734,"user_name":"村姑飞来了","can_delete":false,"product_type":"c1","uid":1043732,"ip_address":"","ucode":"AAA8915BED3645","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/maSS4JuE2bhE84ic3f8nYxQJtVAnzMGvy7MewliaVlgoS8ERLyg3Z1QUKQl1wHW8fTt1caRMtEzaYFPkYYbZdKgg/132","comment_is_top":false,"comment_ctime":1652534103,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652534103","product_id":100029201,"comment_content":"老师 kafka on k8s 部署会影响零拷贝等特性？如果k8s的持久化卷可以保证数据不丢失，那么partition 的flower 是不是可以不启用数据复制，可以保证高可用嘛？","like_count":0},{"had_liked":false,"id":337048,"user_name":"Geek_4a6e69","can_delete":false,"product_type":"c1","uid":2882400,"ip_address":"","ucode":"EE003DDF8BC99D","user_header":"","comment_is_top":false,"comment_ctime":1646566795,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1646566795","product_id":100029201,"comment_content":"老师你好，请问下我准备在云上搭建kafka 集群，但是只有一个公网ip，我尝试了几次没有成功，请问下，基于这样的环境能搭建集群？需要怎么处理？ ","like_count":0},{"had_liked":false,"id":334591,"user_name":"小文","can_delete":false,"product_type":"c1","uid":2156734,"ip_address":"","ucode":"E42DF2D72025A9","user_header":"https://static001.geekbang.org/account/avatar/00/20/e8/be/11937399.jpg","comment_is_top":false,"comment_ctime":1645010906,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645010906","product_id":100029201,"comment_content":"老师，你好，我们生产环境在使用Kafka的时候有一次需要修改Kafka的配置然后重启kafka，想问下，如果Java程序刚往kafka里写了数据然后就重启了，此时会不会丢数呢。","like_count":0},{"had_liked":false,"id":310468,"user_name":"shuifa","can_delete":false,"product_type":"c1","uid":1040063,"ip_address":"","ucode":"636733F5C88A7B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/bf/4df4224d.jpg","comment_is_top":false,"comment_ctime":1630664618,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1630664618","product_id":100029201,"comment_content":"操作系统：IO模型<br>磁盘类型：机械磁盘足矣<br>磁盘容量：根据消息量、消息大小、消息有效时间、服本数等，同时预留30%左右的磁盘空间<br>带宽：实际带宽和业务SLA预估，千兆网络按每台700Mbps计算","like_count":0},{"had_liked":false,"id":310101,"user_name":"hadoop_admin","can_delete":false,"product_type":"c1","uid":1300466,"ip_address":"","ucode":"7EAFA775505C7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGMphabeneYXs9otkAtr67RvxJClDa7jPe7w8yExg4YaS2FGJruDKMj5yN1E90o6MFibnicH8gM0ibg/132","comment_is_top":false,"comment_ctime":1630485333,"is_pvip":false,"replies":[{"id":"112524","content":"应该还不支持","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1630810071,"ip_address":"","comment_id":310101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630485333","product_id":100029201,"comment_content":"胡老师，kafka 现在支持ipv6的部署么？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526127,"discussion_content":"应该还不支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630810071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301614,"user_name":"钟","can_delete":false,"product_type":"c1","uid":2281904,"ip_address":"","ucode":"3D2ECD40D42044","user_header":"https://static001.geekbang.org/account/avatar/00/22/d1/b0/e8db9565.jpg","comment_is_top":false,"comment_ctime":1625788480,"is_pvip":true,"replies":[{"id":"109460","content":"大致是这个意思<br>","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1626242402,"ip_address":"","comment_id":301614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625788480","product_id":100029201,"comment_content":"“如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3，即 30 台”，不太明白这句话的意思，意思是如果分区是3副本，副本拉取数据需要占用带宽，所以要乘以3吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523042,"discussion_content":"大致是这个意思\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626242402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287547,"user_name":"一十六夜","can_delete":false,"product_type":"c1","uid":1606581,"ip_address":"","ucode":"41D4A6695B2A7B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJIIibocUHNRgafeNUvibW0YI2v1qDaiaZCVQ37FcrMs0ettIDD0snhsy4Ac2ADnLmjM7KGNeznj2hrg/132","comment_is_top":false,"comment_ctime":1618023009,"is_pvip":false,"replies":[{"id":"104422","content":"可以的","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1618026132,"ip_address":"","comment_id":287547,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618023009","product_id":100029201,"comment_content":"请教一下，生产环境如果部署3台服务器的kafka集群，那么zk可以和kafka部署在同一台服务器作为集群么？PS：使用kafka自带的zk","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518342,"discussion_content":"可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618026132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285628,"user_name":"招耳","can_delete":false,"product_type":"c1","uid":1001825,"ip_address":"","ucode":"D163E1A6377CF6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/61/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1616926447,"is_pvip":false,"replies":[{"id":"103779","content":"主要是受限于I&#47;O性能","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1617067689,"ip_address":"","comment_id":285628,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616926447","product_id":100029201,"comment_content":"老师，如果kafka部署在容器内，挂载远程存储，对性能有多大影响，怎么评估","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517736,"discussion_content":"主要是受限于I/O性能","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617067689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284604,"user_name":"威","can_delete":false,"product_type":"c1","uid":1068542,"ip_address":"","ucode":"C921CDCB22B9A3","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg","comment_is_top":false,"comment_ctime":1616384307,"is_pvip":false,"replies":[{"id":"103534","content":"1Gbps是单个网卡的带宽，上游交换机不能就1Gbps吧，这有点寒酸了。。。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1616721858,"ip_address":"","comment_id":284604,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616384307","product_id":100029201,"comment_content":"一台broker占用240Mbps带宽，最后算出来要30台broker，那30个broker就需要240Mbps * 30，已经超过内网的1Gbps带宽了，不是应该会有问题吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517403,"discussion_content":"1Gbps是单个网卡的带宽，上游交换机不能就1Gbps吧，这有点寒酸了。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616721858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284058,"user_name":"猪大强","can_delete":false,"product_type":"c1","uid":1542577,"ip_address":"","ucode":"2DD393D247798C","user_header":"https://static001.geekbang.org/account/avatar/00/17/89/b1/9f9cfc19.jpg","comment_is_top":false,"comment_ctime":1616053698,"is_pvip":false,"replies":[{"id":"103537","content":"没太懂这个问题。。。。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1616721989,"ip_address":"","comment_id":284058,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616053698","product_id":100029201,"comment_content":"老师你好，请问borker每次收到消息都会先写到硬盘在返回？怎么保证消息丢失问题","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517216,"discussion_content":"没太懂这个问题。。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616721989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278895,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1613450987,"is_pvip":true,"replies":[{"id":"101512","content":"副本数量","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1613780698,"ip_address":"","comment_id":278895,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1613450987","product_id":100029201,"comment_content":"老师好，“如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3，即 30 台” 。请教一下，这里的复制两份指的是副本数量还是说再搭两套独立的kafka集群呢。。。","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515547,"discussion_content":"副本数量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613780698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1319330,"avatar":"https://static001.geekbang.org/account/avatar/00/14/21/a2/0eb6710a.jpg","nickname":"b1gx","note":"","ucode":"3D86DBF17CC776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350140,"discussion_content":"副本数量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613724507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274486,"user_name":"hadoop_admin","can_delete":false,"product_type":"c1","uid":1300466,"ip_address":"","ucode":"7EAFA775505C7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGMphabeneYXs9otkAtr67RvxJClDa7jPe7w8yExg4YaS2FGJruDKMj5yN1E90o6MFibnicH8gM0ibg/132","comment_is_top":false,"comment_ctime":1611036386,"is_pvip":false,"replies":[{"id":"99666","content":"千兆网络下带宽更容易成为瓶颈。万兆下磁盘的IOPS能力更有可能变成性能问题点。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1611108154,"ip_address":"","comment_id":274486,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611036386","product_id":100029201,"comment_content":"这个网络资源估算还是有点保守，我们生产一般是磁盘IO有瓶颈，网络都是10Gbps的，每台服务配置10~12块HDD盘，基本上每块盘读写到200MB左右磁盘使用率就100% 了","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514031,"discussion_content":"千兆网络下带宽更容易成为瓶颈。万兆下磁盘的IOPS能力更有可能变成性能问题点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611108154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272883,"user_name":"初心","can_delete":false,"product_type":"c1","uid":2411335,"ip_address":"","ucode":"8E07F536CA65E5","user_header":"https://static001.geekbang.org/account/avatar/00/24/cb/47/a8ea74c5.jpg","comment_is_top":false,"comment_ctime":1610346969,"is_pvip":false,"replies":[{"id":"99092","content":"内网也是需要考虑带宽的，毕竟带宽资源如今是稀有资源","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1610620865,"ip_address":"","comment_id":272883,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610346969","product_id":100029201,"comment_content":"老师您好，请教一个问题，我这边的kafka集群是部署在内网中，数据交互都是私网中进行，因此是不是不需要考虑带宽问题？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513420,"discussion_content":"内网也是需要考虑带宽的，毕竟带宽资源如今是稀有资源","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610620865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258096,"user_name":"Geek_Daniel","can_delete":false,"product_type":"c1","uid":2066119,"ip_address":"","ucode":"9AC8E4D12FBC72","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/hlgyFUQVCrhaO46VJkrR3fE9hvOWnnwKsAj9gzK4Yp70BmU1a06YkwS1vNexMqkttorodO2ZMtiajBMXo7seD8g/132","comment_is_top":false,"comment_ctime":1604297163,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604297163","product_id":100029201,"comment_content":"Kafka入门小白，觉得内容讲的不错，希望以后可以用到","like_count":0},{"had_liked":false,"id":243728,"user_name":"阡陌","can_delete":false,"product_type":"c1","uid":1141254,"ip_address":"","ucode":"58634836C8E03F","user_header":"https://static001.geekbang.org/account/avatar/00/11/6a/06/66831563.jpg","comment_is_top":false,"comment_ctime":1598258728,"is_pvip":false,"replies":[{"id":"89834","content":"是想说利用Kafka的副本机制实现额外的数据备份","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1598316559,"ip_address":"","comment_id":243728,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598258728","product_id":100029201,"comment_content":"老师，请问带宽这里说的“如果消息还需要额外复制两份”是指的是kafka的副本机制备份还是说其他的业务需求方面的数据备份啊？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504374,"discussion_content":"是想说利用Kafka的副本机制实现额外的数据备份","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598316559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243241,"user_name":"lcf枫","can_delete":false,"product_type":"c1","uid":1144171,"ip_address":"","ucode":"D51E8F68BD41CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/75/6b/fd685164.jpg","comment_is_top":false,"comment_ctime":1598001342,"is_pvip":false,"replies":[{"id":"89767","content":"保存两份","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1598232845,"ip_address":"","comment_id":243241,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598001342","product_id":100029201,"comment_content":"每天 1 亿条 1KB 大小的消息，保存两份且留存两周的时间，那么总的空间大小就等于 1 亿 * 1KB * 2 &#47; 1000 &#47; 1000 = 200GB。<br> 文中算一天的存储量，为什么要 *2呢？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504237,"discussion_content":"保存两份","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598232845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237826,"user_name":"A_Tarnished","can_delete":false,"product_type":"c1","uid":1226034,"ip_address":"","ucode":"0125AB3B63F236","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/32/b9b4aefb.jpg","comment_is_top":false,"comment_ctime":1595983795,"is_pvip":false,"replies":[{"id":"87880","content":"千万别。根据我的经验，目前社区已经“放弃”Windows平台了。有bug也不会花精力修复了","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1596005139,"ip_address":"","comment_id":237826,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1595983795","product_id":100029201,"comment_content":"大领导选型的时候非要在生产Windows上用kafka😂现在各种出错，我该怎么破","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502557,"discussion_content":"千万别。根据我的经验，目前社区已经“放弃”Windows平台了。有bug也不会花精力修复了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596005139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226034,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b5/32/b9b4aefb.jpg","nickname":"A_Tarnished","note":"","ucode":"0125AB3B63F236","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295340,"discussion_content":"谢谢老师！您的专栏也提到过Windows平台有更好的iocp模型，最近微软也在开源软件上投入资源，未来社区有没有可能再重视Windows平台呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596169524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234925,"user_name":"时光守护者-基兰","can_delete":false,"product_type":"c1","uid":1554995,"ip_address":"","ucode":"F0B0887B1979D2","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","comment_is_top":false,"comment_ctime":1594826889,"is_pvip":false,"replies":[{"id":"86840","content":"1. 可以使用kafka的测试工具<br>2. 是的，follower副本数是2。坦率说，一般2~3足矣了<br>3. 我觉得是前者 ","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1594947367,"ip_address":"","comment_id":234925,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594826889","product_id":100029201,"comment_content":"老师我是后端开发，平时也会涉及到集群运维相关的工作，公司用的是CDH。最近数据量有点大，可能会考虑添加节点或磁盘。想问下：<br>1.文中&quot;1小时内处理 1TB 数据&quot;指的是1小时往kafka生产1T数据嘛？怎样测试kafka集群单位时间内可以生产的数据量呢<br>2.文中&quot;如果消息还需要额外复制两份&quot;值得是follow副本个数为2嘛，前几篇的文章有提到follow副本是N-1，那follow个数怎样在结合实际场景评估呢<br>3.hadoop集群一般是多台性能一般的服务器比少量性能好点的服务器性价比更高嘛，为啥呢，我们目前主要是hbase和kafka用的多点","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501548,"discussion_content":"1. 可以使用kafka的测试工具\n2. 是的，follower副本数是2。坦率说，一般2~3足矣了\n3. 我觉得是前者 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594947367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229476,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1593009528,"is_pvip":true,"replies":[{"id":"84790","content":"嗯嗯","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1593163369,"ip_address":"","comment_id":229476,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593009528","product_id":100029201,"comment_content":"windows对AIO的支持比linux好，linux对NIO支持比较好。","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499498,"discussion_content":"嗯嗯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593163369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229475,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1593009405,"is_pvip":true,"replies":[{"id":"84791","content":"不用深入到这么底层。事实上不是不同系统，而是不同芯片，因为指令集不一样","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1593163396,"ip_address":"","comment_id":229475,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593009405","product_id":100029201,"comment_content":"虽然都是.class文件，但不同系统的汇编是不一样的。","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499497,"discussion_content":"不用深入到这么底层。事实上不是不同系统，而是不同芯片，因为指令集不一样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593163396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229465,"user_name":"Katherine","can_delete":false,"product_type":"c1","uid":1898758,"ip_address":"","ucode":"C57AB0B17DA1A1","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f9/06/dea695ea.jpg","comment_is_top":false,"comment_ctime":1593005548,"is_pvip":false,"replies":[{"id":"84792","content":"可以尝试去官网走一遍Get started：）","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1593163428,"ip_address":"","comment_id":229465,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593005548","product_id":100029201,"comment_content":"完全没有接触过Kafka的小白还要继续听下去吗？？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499492,"discussion_content":"可以尝试去官网走一遍Get started：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593163428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":227398,"user_name":"yes","can_delete":false,"product_type":"c1","uid":1386201,"ip_address":"","ucode":"612BF6884ED6CC","user_header":"https://static001.geekbang.org/account/avatar/00/15/26/d9/f7e96590.jpg","comment_is_top":false,"comment_ctime":1592371487,"is_pvip":false,"replies":[{"id":"83937","content":"哦哦，当然是可以的。其实这里更在意的是估算的方法。实际场景中Broker上必须是多个副本的","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1592472897,"ip_address":"","comment_id":227398,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592371487","product_id":100029201,"comment_content":"如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3，即 30 台。<br><br>我对以上的话有些疑问，额外复制两份不能存在已有的10台中吗？既机器A是p1 leader同时是p2 follower这种吗？<br>难道线上环境的副本机不对外工作的嘛？只是做单纯的备机？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498619,"discussion_content":"哦哦，当然是可以的。其实这里更在意的是估算的方法。实际场景中Broker上必须是多个副本的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592472897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226470,"user_name":"magict4","can_delete":false,"product_type":"c1","uid":1043789,"ip_address":"","ucode":"CB6F063D881AAC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/4d/1d1a1a00.jpg","comment_is_top":false,"comment_ctime":1592114413,"is_pvip":false,"replies":[{"id":"83436","content":"不需要。一台broker既可以当某个分区的leader，也可以是其他分区的follower。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1592182894,"ip_address":"","comment_id":226470,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592114413","product_id":100029201,"comment_content":"老师您好，<br><br>我对 broker 跟 replica 的对应关系有所疑惑。假如一台服务器上有 Partition A 的 leader replica，我还想让它保存 Partition B 的 follower replica，那我是需要在这台服务器上启动两个 broker 吗？<br><br>在最佳实践中，一般是一台服务器，一个broker，一种 replicate(leader or follower) 吗？那是否意味着，2&#47;3 的服务器（假设一个 leader 有两个 follower)，本身不对外提供任何服务？ <br><br>谢谢！","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498253,"discussion_content":"不需要。一台broker既可以当某个分区的leader，也可以是其他分区的follower。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592182894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218733,"user_name":"鹏","can_delete":false,"product_type":"c1","uid":1134313,"ip_address":"","ucode":"7CD314347AC6DC","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/e9/5972d74d.jpg","comment_is_top":false,"comment_ctime":1589861284,"is_pvip":false,"replies":[{"id":"80949","content":"我又计算了一次，貌似没有问题。100,000,000 * 1KB * 2 = 200,000,000KB = 200,000MB = 200GB。","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1589942957,"ip_address":"","comment_id":218733,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589861284","product_id":100029201,"comment_content":"&quot;那么总的空间大小就等于 1 亿 * 1KB * 2 &#47; 1000 &#47; 1000 = 200GB。&quot;，这里换算结果是否有误？20GB","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495558,"discussion_content":"我又计算了一次，貌似没有问题。100,000,000 * 1KB * 2 = 200,000,000KB = 200,000MB = 200GB。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589942957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216494,"user_name":"Silence","can_delete":false,"product_type":"c1","uid":1630343,"ip_address":"","ucode":"831D83F17EE0B9","user_header":"https://static001.geekbang.org/account/avatar/00/18/e0/87/72c0af0c.jpg","comment_is_top":false,"comment_ctime":1589271500,"is_pvip":true,"replies":[{"id":"80177","content":"“消息复制2分，也就是一共有30个分区” --- 不是的。分区是10个，副本数是3而已。当然，我同意你说的相互备份，但实际应用中，核心业务的副本我们是不建议放在同一个broker上的，以免相互干扰~<br>","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1589332364,"ip_address":"","comment_id":216494,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1589271500","product_id":100029201,"comment_content":"胡老师，文章中的最后一段不明白，处理消息需要10台机器，为什么复制2分消息需要多加20台机器。<br><br>假设1个 topic 10台机器，10 个broker，一共有10个分区，全为leader节点；消息复制2分，也就是一共有30个分区，10个leader 20个follower，完全可以放入10个broker中相互备份， 并且在带宽处也预留了2&#47;3, 为什么还需要额外20台机器?<br><br>还有哪里没考虑到吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494840,"discussion_content":"“消息复制2分，也就是一共有30个分区” --- 不是的。分区是10个，副本数是3而已。当然，我同意你说的相互备份，但实际应用中，核心业务的副本我们是不建议放在同一个broker上的，以免相互干扰~\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589332364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1630343,"avatar":"https://static001.geekbang.org/account/avatar/00/18/e0/87/72c0af0c.jpg","nickname":"Silence","note":"","ucode":"831D83F17EE0B9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264685,"discussion_content":"好的，明白了，谢谢胡老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589343898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208472,"user_name":"扬一场远远的风","can_delete":false,"product_type":"c1","uid":1357801,"ip_address":"","ucode":"AB47E3D2EAB8A8","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/e9/5400cdf3.jpg","comment_is_top":false,"comment_ctime":1587366651,"is_pvip":false,"replies":[{"id":"77917","content":"如果是偶发的不用去管，因为某些TCP连接如果长时间没有请求流过，Kafka就会关闭它。等下次再用的时候重新创建连接，因此不是什么大事~","user_name":"作者回复","user_name_real":"胡夕","uid":"1288090","ctime":1587373366,"ip_address":"","comment_id":208472,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587366651","product_id":100029201,"comment_content":"&quot; WARN Attempting to send response via channel for which there is no open connection, connection id xxxxxxxx:9096-xxxxxxxxx:32794-1838 (kafka.network.Processor)&quot; 你好，请教一下，kafka时不时报这个错，是某些配置不当么 ？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492471,"discussion_content":"如果是偶发的不用去管，因为某些TCP连接如果长时间没有请求流过，Kafka就会关闭它。等下次再用的时候重新创建连接，因此不是什么大事~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587373366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195473,"user_name":"Evan","can_delete":false,"product_type":"c1","uid":1344281,"ip_address":"","ucode":"B877ABD0CF4661","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/19/0a3fe8c1.jpg","comment_is_top":false,"comment_ctime":1585190380,"is_pvip":false,"replies":[{"id":"74400","content":"可以参见官网的Get Started章节，遵循那里面的步骤可以快速地验证Kafka安装是否成功~","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1585270555,"ip_address":"","comment_id":195473,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1585190380","product_id":100029201,"comment_content":"胡老师，您好，本地有没有测试快速测试验证安装包kafka ?","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489081,"discussion_content":"可以参见官网的Get Started章节，遵循那里面的步骤可以快速地验证Kafka安装是否成功~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585270555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194096,"user_name":"扬一场远远的风","can_delete":false,"product_type":"c1","uid":1357801,"ip_address":"","ucode":"AB47E3D2EAB8A8","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/e9/5400cdf3.jpg","comment_is_top":false,"comment_ctime":1585024524,"is_pvip":false,"replies":[{"id":"74066","content":"hmmm.... 这个就没有统一的标准了。。。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1585096646,"ip_address":"","comment_id":194096,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585024524","product_id":100029201,"comment_content":"您好，在linux上使用docker容器布署kafka，heap分配6个G，那docker容器的内存建议给多少？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488756,"discussion_content":"hmmm.... 这个就没有统一的标准了。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585096646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191543,"user_name":"扬一场远远的风","can_delete":false,"product_type":"c1","uid":1357801,"ip_address":"","ucode":"AB47E3D2EAB8A8","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/e9/5400cdf3.jpg","comment_is_top":false,"comment_ctime":1584780038,"is_pvip":false,"replies":[{"id":"73522","content":"很怕回答这种问题，因为没有统一的答案。姑且推荐一个值：6GB<br>","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1584847585,"ip_address":"","comment_id":191543,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1584780038","product_id":100029201,"comment_content":"请教一下，如果在linux上使用docker容器布署kafka，容器的内存与heap内存比例大概是多少？或者heap建议多少，整个容器的内存给多少？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488199,"discussion_content":"很怕回答这种问题，因为没有统一的答案。姑且推荐一个值：6GB\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584847585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1357801,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b7/e9/5400cdf3.jpg","nickname":"扬一场远远的风","note":"","ucode":"AB47E3D2EAB8A8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212684,"discussion_content":"这是heap的值吧。那docker容器可以给多少？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585008340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173730,"user_name":"邓成林","can_delete":false,"product_type":"c1","uid":1461035,"ip_address":"","ucode":"99D65A14376786","user_header":"","comment_is_top":false,"comment_ctime":1579671341,"is_pvip":false,"replies":[{"id":"67908","content":"您指的部署是指什么方面的内容？<br>","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1580368477,"ip_address":"","comment_id":173730,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1579671341","product_id":100029201,"comment_content":"没有讲如何部署Kafka集群吗?","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482184,"discussion_content":"您指的部署是指什么方面的内容？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580368477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262527,"discussion_content":"官网有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589110153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173461,"user_name":"wgcris","can_delete":false,"product_type":"c1","uid":1527666,"ip_address":"","ucode":"842B76EB6B8320","user_header":"","comment_is_top":false,"comment_ctime":1579567229,"is_pvip":false,"replies":[{"id":"67910","content":"通常情况下一个集群上单Broker总分区数不超过2000个。之前写过一篇文章讨论过这个问题，可以看一下：https:&#47;&#47;www.cnblogs.com&#47;huxi2b&#47;p&#47;4757098.html","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1580368625,"ip_address":"","comment_id":173461,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1579567229","product_id":100029201,"comment_content":"老师，我想请教个问题，在生产环境，如何去规划一个broker上承载的partition数，以及一个partition应该承载的最大吞吐，有没有一个流量模型或者实践方法？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482075,"discussion_content":"通常情况下一个集群上单Broker总分区数不超过2000个。之前写过一篇文章讨论过这个问题，可以看一下：https://www.cnblogs.com/huxi2b/p/4757098.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580368625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1527666,"avatar":"","nickname":"wgcris","note":"","ucode":"842B76EB6B8320","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":163047,"discussion_content":"老师，您好，看了您的博客，关于计算partition个数的方式有一些疑惑，在测量一个partition的最大吞吐时，采用创建一个只有一个partition的topic进行压测，这种方式在实际生产环境感觉不可取，因为这是一种理想场景，没有资源竞争的时候测出来的值，但在实际生产环境，往往一个broker上有多个partition，是会存在网络带宽的竞争，所以实际可能会比这个值小很多，那这种情况下，估算出来的分区个数也会偏差很大，不知道我的理解是否合理。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581044230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168908,"user_name":"凡布莱.克","can_delete":false,"product_type":"c1","uid":1315824,"ip_address":"","ucode":"D82EF9FB41DD8D","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/f0/7606f8a5.jpg","comment_is_top":false,"comment_ctime":1578214586,"is_pvip":false,"replies":[{"id":"65580","content":"多核大内存肯定是首选：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1578279868,"ip_address":"","comment_id":168908,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578214586","product_id":100029201,"comment_content":"老师，您好，服务器的评估主要提到了磁盘和带宽，个人感觉如果是生产比较核心的业务，建议是固态硬盘，因为磁盘IO导致服务器负载飙高的一个重要维度，另外想咨询下，这里面提到了千兆网络，那么对于服务器选型来说，应该是要物理机的对嘛，物理机的规格在cpu和内存来说，应该怎么选择呢，谢谢。","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480368,"discussion_content":"多核大内存肯定是首选：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578279868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164751,"user_name":"张伯毅","can_delete":false,"product_type":"c1","uid":1099929,"ip_address":"","ucode":"E9EAF5ECFE32C7","user_header":"https://static001.geekbang.org/account/avatar/00/10/c8/99/22d2a6a7.jpg","comment_is_top":false,"comment_ctime":1577085856,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577085856","product_id":100029201,"comment_content":"2336Mb这个数值算的不准确吧.  ","like_count":0},{"had_liked":false,"id":150964,"user_name":"HZ","can_delete":false,"product_type":"c1","uid":1371862,"ip_address":"","ucode":"883D79CEEA9C66","user_header":"https://static001.geekbang.org/account/avatar/00/14/ee/d6/0142c3a3.jpg","comment_is_top":false,"comment_ctime":1573635675,"is_pvip":false,"replies":[{"id":"58204","content":"那就不需要了","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1573695403,"ip_address":"","comment_id":150964,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573635675","product_id":100029201,"comment_content":"老师，对带宽计算有个疑问：如果副本树是1， 也就没有了follower 和 leader 的同步，那么还应该预留 2&#47;3吗， 也就是 700Mb -&gt; 240Mb 这一步？ ","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474328,"discussion_content":"那就不需要了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573695403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141317,"user_name":"Kong","can_delete":false,"product_type":"c1","uid":1699383,"ip_address":"","ucode":"713F121F1CF103","user_header":"https://static001.geekbang.org/account/avatar/00/19/ee/37/f17451cc.jpg","comment_is_top":false,"comment_ctime":1571138979,"is_pvip":false,"replies":[{"id":"54649","content":"Byte变bit：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1571187894,"ip_address":"","comment_id":141317,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1571138979","product_id":100029201,"comment_content":"最后乘的那个8是什么呀，","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470716,"discussion_content":"Byte变bit：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571187894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1699383,"avatar":"https://static001.geekbang.org/account/avatar/00/19/ee/37/f17451cc.jpg","nickname":"Kong","note":"","ucode":"713F121F1CF103","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":34266,"discussion_content":"好哒。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571189071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132852,"user_name":"云师兄","can_delete":false,"product_type":"c1","uid":1010459,"ip_address":"","ucode":"4475AF1598FBFD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/1b/4b397b80.jpg","comment_is_top":false,"comment_ctime":1568252824,"is_pvip":false,"replies":[{"id":"51253","content":"抱歉，没太听懂。。。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1568594168,"ip_address":"","comment_id":132852,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568252824","product_id":100029201,"comment_content":"机器数量因为2个副本直接10×3，那原来10台中也可以互相存储副本，也有预留的2&#47;3的带宽供使用，为什么是直接×3，望老师解答一下","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467144,"discussion_content":"抱歉，没太听懂。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568594168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131661,"user_name":"五年","can_delete":false,"product_type":"c1","uid":1081224,"ip_address":"","ucode":"28A6F945FB0626","user_header":"https://static001.geekbang.org/account/avatar/00/10/7f/88/c4263c58.jpg","comment_is_top":false,"comment_ctime":1567839125,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567839125","product_id":100029201,"comment_content":"这章超级赞 站在架构的角度进行设计","like_count":0},{"had_liked":false,"id":129445,"user_name":"wvalianty","can_delete":false,"product_type":"c1","uid":1261407,"ip_address":"","ucode":"E5029CD900094B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL17yp3TmdQNXWELQvjIA2azwZ6ib7Riae9Hcf2YFl1uvnvocQoicTOtJLnvjUPtpbYhSng7DtPR9lfg/132","comment_is_top":false,"comment_ctime":1567129921,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567129921","product_id":100029201,"comment_content":"老师，有一点似乎应该在这一节提一下，kafka的并发能力。","like_count":0},{"had_liked":false,"id":126676,"user_name":"Geek_b809ff","can_delete":false,"product_type":"c1","uid":1288329,"ip_address":"","ucode":"F3F17E99F3AA0B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoPY23R9RRSfBeTJUlyc612VlodjAaWWBNiay9tPydkrd6b9NA8GNibdibnFibTsx94ItHE4jvQwprNzA/132","comment_is_top":false,"comment_ctime":1566445479,"is_pvip":false,"replies":[{"id":"46939","content":"通常情况下你不用配置listener.security.protocol.map。其他两个配置感觉也没什么问题。你能否用console producer试下能否发送消息？","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1566523045,"ip_address":"","comment_id":126676,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566445479","product_id":100029201,"comment_content":"老师，请问一直报这个错是因为什么：<br> Error while fetching metadata with correlation id 101 : {test=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient)<br><br>另外，server.properties里面下面这几个参数应该怎么配置：<br>listeners=PLAINTEXT:&#47;&#47;:9092<br>advertised.listeners=PLAINTEXT:&#47;&#47;:9092<br>istener.security.protocol.map<br><br>test主题有创建，用其它的主题去尝试也是有问题。而且这个不是偶尔发生，每次生产消息的时候都有这个问题。这个跟zookeeper是否有关，看这个错误是LEADER_NOT_AVAILABLE","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464114,"discussion_content":"通常情况下你不用配置listener.security.protocol.map。其他两个配置感觉也没什么问题。你能否用console producer试下能否发送消息？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566523045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126550,"user_name":"doubleWei","can_delete":false,"product_type":"c1","uid":1611787,"ip_address":"","ucode":"C699100F076E76","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eru0Vb9yfvHic3P9nRz48Vo9jic3kdIeTModyhFa3bz3j0EdIRxVMtZzQUs3AJoiaQQQwmqdvgRbLecQ/132","comment_is_top":false,"comment_ctime":1566408450,"is_pvip":false,"replies":[{"id":"46840","content":"通过kafka.network:type=RequestMetrics,name=RequestQueueTimeMs,request={Produce|FetchConsumer|FetchFollower} 判断是否需要调整num.network.threads","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1566440863,"ip_address":"","comment_id":126550,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1566408450","product_id":100029201,"comment_content":"请问有没有查看network和io请求处理时间的指标，通过这个来判断是服务处理网络请求慢了还是io请求满了，从而查看瓶颈点","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464052,"discussion_content":"通过kafka.network:type=RequestMetrics,name=RequestQueueTimeMs,request={Produce|FetchConsumer|FetchFollower} 判断是否需要调整num.network.threads","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566440863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611787,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eru0Vb9yfvHic3P9nRz48Vo9jic3kdIeTModyhFa3bz3j0EdIRxVMtZzQUs3AJoiaQQQwmqdvgRbLecQ/132","nickname":"doubleWei","note":"","ucode":"C699100F076E76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5851,"discussion_content":"感谢指点，io瓶颈有没有什么比较好的指标","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566485550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122883,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1565569167,"is_pvip":false,"replies":[{"id":"45061","content":"Java版本尽量选8，其他的没有太多参考依据。我觉得不需要到考虑内存条这一级吧。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1565571213,"ip_address":"","comment_id":122883,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565569167","product_id":100029201,"comment_content":"线上集群部署方案考量<br>1：软件<br>操作系统——觉得怎么和硬件打交道<br>2：硬件<br>硬盘——决定能存储多少数据，性能如何、带宽——决定网络传输的效率，以及是否会成为瓶颈<br><br>虽然都是顺序写，但是固态硬盘的性能还是比机械硬盘高的多，如果出于写磁盘性能的考虑，还是应该选固态硬盘。<br><br>至于jre、内存、CPU这些，我认为也是必须要考虑的，选择的依据又是什么呢？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462439,"discussion_content":"Java版本尽量选8，其他的没有太多参考依据。我觉得不需要到考虑内存条这一级吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565571213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":122782,"user_name":"shjdwxy","can_delete":false,"product_type":"c1","uid":1017625,"ip_address":"","ucode":"3822D979DC35F6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/19/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1565521100,"is_pvip":false,"replies":[{"id":"45065","content":"感觉不是。实际环境中用RAID0的机会其实非常少，毕竟一块坏了就废了","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1565571323,"ip_address":"","comment_id":122782,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1565521100","product_id":100029201,"comment_content":"我们线上遇到过这样的问题，多块磁盘之间负载不均衡，一块盘的io成了瓶颈。这样的话，是不是raid0是一个比较好的方案","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462402,"discussion_content":"感觉不是。实际环境中用RAID0的机会其实非常少，毕竟一块坏了就废了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565571323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1017625,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/87/19/abb7bfe3.jpg","nickname":"shjdwxy","note":"","ucode":"3822D979DC35F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4647,"discussion_content":"你们遇到过单机多盘之间io相差很大的情况吗\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565616231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1017625,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/87/19/abb7bfe3.jpg","nickname":"shjdwxy","note":"","ucode":"3822D979DC35F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4646,"discussion_content":"但是kafka自身有数据副本机制啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565616199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115932,"user_name":"shern","can_delete":false,"product_type":"c1","uid":1588321,"ip_address":"","ucode":"B7018DDF61B332","user_header":"https://static001.geekbang.org/account/avatar/00/18/3c/61/d4145bb6.jpg","comment_is_top":false,"comment_ctime":1563768501,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563768501","product_id":100029201,"comment_content":"一般数据流量都会先经过机房内的交换机然后再流到服务器。想请教下，实际规划过程中是不是还要考虑机房内的交换机与服务器的拓扑情况，这方面老师有经验或者案例分享吗？","like_count":0},{"had_liked":false,"id":114512,"user_name":"开水","can_delete":false,"product_type":"c1","uid":1528555,"ip_address":"","ucode":"651491C38B925B","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/eb/eec719f3.jpg","comment_is_top":false,"comment_ctime":1563327720,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563327720","product_id":100029201,"comment_content":"回过头来看，忽然想起一个问题。老师，一个kafka topic定partition数量的时候最好以什么为参考依据呢？","like_count":0,"discussions":[{"author":{"id":1580847,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1f/2f/73bc1aed.jpg","nickname":"辜放","note":"","ucode":"40E89B24CE64E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2348,"discussion_content":"同问，一个主题定几个分区由什么区权衡？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563505711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113391,"user_name":"文洲","can_delete":false,"product_type":"c1","uid":1298996,"ip_address":"","ucode":"E2CD38F88A53CB","user_header":"https://static001.geekbang.org/account/avatar/00/13/d2/34/39a3edef.jpg","comment_is_top":false,"comment_ctime":1562991209,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562991209","product_id":100029201,"comment_content":"老师有个点有点疑问，“SLA 是在 1 小时内处理 1TB 的业务数据”，这个估算是按照入流量，还是出流量，按照kafka的模式，比如3个消费组同时消费的话，出流量还需*3","like_count":0},{"had_liked":false,"id":110517,"user_name":"外星人","can_delete":false,"product_type":"c1","uid":1132861,"ip_address":"","ucode":"D8469B13F2AB37","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/3d/4ac37cc2.jpg","comment_is_top":false,"comment_ctime":1562289158,"is_pvip":false,"replies":[{"id":"40298","content":"1.1之前不好处理，只能下掉坏磁盘之后重新配置log.dirs再重启broker；1.1之后至少能保证部分磁盘坏掉后broker不宕机，你可以直接下掉坏磁盘。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1562370494,"ip_address":"","comment_id":110517,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562289158","product_id":100029201,"comment_content":"老师你好，麻烦问下，kafka的磁盘挂裸盘的话，如果出现磁盘坏的情况，该如何优雅的处理啊？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456919,"discussion_content":"1.1之前不好处理，只能下掉坏磁盘之后重新配置log.dirs再重启broker；1.1之后至少能保证部分磁盘坏掉后broker不宕机，你可以直接下掉坏磁盘。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562370494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110259,"user_name":"小猪","can_delete":false,"product_type":"c1","uid":1201662,"ip_address":"","ucode":"EAD6A4876CEF3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/fe/ab541300.jpg","comment_is_top":false,"comment_ctime":1562216022,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562216022","product_id":100029201,"comment_content":"老师，kafka有在k8s上部署的方案吗？","like_count":0},{"had_liked":false,"id":106948,"user_name":"icyricky","can_delete":false,"product_type":"c1","uid":1302556,"ip_address":"","ucode":"D63C285165309D","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/1c/aa50dc27.jpg","comment_is_top":false,"comment_ctime":1561427792,"is_pvip":false,"replies":[{"id":"38831","content":"这个要依据具体的使用情况来定了。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1561514995,"ip_address":"","comment_id":106948,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561427792","product_id":100029201,"comment_content":"想问下在万兆网10Gbps的情况下，单台Kafka处理数据会成为瓶颈吗，像文中的举例，此时会是只需要3台吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455296,"discussion_content":"这个要依据具体的使用情况来定了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561514995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106383,"user_name":"itzzy","can_delete":false,"product_type":"c1","uid":1058553,"ip_address":"","ucode":"25C4B6F6FDE945","user_header":"https://static001.geekbang.org/account/avatar/00/10/26/f9/2a7d80a3.jpg","comment_is_top":false,"comment_ctime":1561285139,"is_pvip":false,"replies":[{"id":"38516","content":"通过实测TPS和你的SLA共同决定 ","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1561340370,"ip_address":"","comment_id":106383,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561285139","product_id":100029201,"comment_content":"创建一个topic，partition的副本数设置为多少合适，从哪些方面考虑呢？老师会在后面讲到吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455070,"discussion_content":"通过实测TPS和你的SLA共同决定 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561340370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106120,"user_name":"silverhawk","can_delete":false,"product_type":"c1","uid":1018649,"ip_address":"","ucode":"BFBC8AF32868DA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8b/19/a15d060d.jpg","comment_is_top":false,"comment_ctime":1561180771,"is_pvip":false,"replies":[{"id":"38487","content":"Java NIO并没有使用IOCP，Java NIO 2使用了IOCP。Kafka源码中慢慢在切换成nio 2，比如对文件的操作","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1561338312,"ip_address":"","comment_id":106120,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561180771","product_id":100029201,"comment_content":"windows上为什么不用IOCP做呢？这才是真的async nonblocking","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454961,"discussion_content":"Java NIO并没有使用IOCP，Java NIO 2使用了IOCP。Kafka源码中慢慢在切换成nio 2，比如对文件的操作","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561338312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106106,"user_name":"Bitson","can_delete":false,"product_type":"c1","uid":1565077,"ip_address":"","ucode":"9C8EF990D47F07","user_header":"https://static001.geekbang.org/account/avatar/00/17/e1/95/29a5cb97.jpg","comment_is_top":false,"comment_ctime":1561176068,"is_pvip":false,"replies":[{"id":"38480","content":"一般是为副本同步之用","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1561337782,"ip_address":"","comment_id":106106,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561176068","product_id":100029201,"comment_content":"“不能让 Kafka 服务器常规性使用这么多资源，故通常要再额外预留出 2&#47;3 的资源”，请问预留这三分之二的带宽是出于什么考虑呢？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454952,"discussion_content":"一般是为副本同步之用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561337782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105329,"user_name":"祥哥","can_delete":false,"product_type":"c1","uid":1049238,"ip_address":"","ucode":"41B671537ED3F7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjiaeDudnGOBbBzoGaVDNlwnEUU5lgM5ABA2fc3oNg63GGsYsmHkAjODMXU0u9eN7EQwPsHOiaW9SQ/132","comment_is_top":false,"comment_ctime":1560987750,"is_pvip":false,"replies":[{"id":"38181","content":"从大B换算成了小B","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1561018145,"ip_address":"","comment_id":105329,"utype":1}],"discussion_count":0,"race_medal":0,"score":"1560987750","product_id":100029201,"comment_content":"你好，老师，弱弱问一下，每秒处理2336M数据，这个值如何计算出来的呢？谢谢","like_count":0},{"had_liked":false,"id":104926,"user_name":"黄智荣","can_delete":false,"product_type":"c1","uid":1027823,"ip_address":"","ucode":"3C84C8654CCB11","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/ef/cbb8d881.jpg","comment_is_top":false,"comment_ctime":1560872059,"is_pvip":false,"replies":[{"id":"38029","content":"本文介绍的是通用的评估方法，不限定一台机器上到底部署几台broker","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560905511,"ip_address":"","comment_id":104926,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560872059","product_id":100029201,"comment_content":"补充一下我的上个问题,如果机器单独做kafka ,一台机器broker 实例应该部署几个?根据什么标准去做估算?","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454486,"discussion_content":"本文介绍的是通用的评估方法，不限定一台机器上到底部署几台broker","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560905511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104753,"user_name":"风中花","can_delete":false,"product_type":"c1","uid":1085237,"ip_address":"","ucode":"067E0A1E116844","user_header":"https://static001.geekbang.org/account/avatar/00/10/8f/35/f1839bb2.jpg","comment_is_top":false,"comment_ctime":1560826800,"is_pvip":false,"replies":[{"id":"38020","content":"加油：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560904452,"ip_address":"","comment_id":104753,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560826800","product_id":100029201,"comment_content":"继续打卡 ，乐观学习，不懂装懂，继续前进，， 我这个windows 圈的老程，感觉压力颇大啊","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454408,"discussion_content":"加油：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560904452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104693,"user_name":"无菇朋友","can_delete":false,"product_type":"c1","uid":1035562,"ip_address":"","ucode":"80482C5F0464A3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/2a/bdbed6ed.jpg","comment_is_top":false,"comment_ctime":1560819067,"is_pvip":false,"replies":[{"id":"37871","content":"专栏前面有几篇讲基础的，可以读一读试试。如果觉得可以入门再继续往下看：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560822664,"ip_address":"","comment_id":104693,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560819067","product_id":100029201,"comment_content":"因为我基本上属于0基础 不知道看您这个教程会困难吗","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454378,"discussion_content":"专栏前面有几篇讲基础的，可以读一读试试。如果觉得可以入门再继续往下看：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560822664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104498,"user_name":"PK時頭髮不亂","can_delete":false,"product_type":"c1","uid":1207867,"ip_address":"","ucode":"08AAAC8F4DE71D","user_header":"https://static001.geekbang.org/account/avatar/00/12/6e/3b/88f14e2a.jpg","comment_is_top":false,"comment_ctime":1560765369,"is_pvip":false,"replies":[{"id":"37842","content":"要衡量的因素或方法是相通的。另外云服务商（特别是大厂）都有自己的Kafka PaaS服务。如果全部都上公有云，也可以考虑直接用这些大厂的服务：）","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560818789,"ip_address":"","comment_id":104498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560765369","product_id":100029201,"comment_content":"现在都是云服务，用的都是虚拟系统或虚拟系统的容器（docker），这种场景的部署方案跟这篇文章的物理机相差甚远，那要怎样衡量或要注意事项呢？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454294,"discussion_content":"要衡量的因素或方法是相通的。另外云服务商（特别是大厂）都有自己的Kafka PaaS服务。如果全部都上公有云，也可以考虑直接用这些大厂的服务：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560818789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104477,"user_name":"无菇朋友","can_delete":false,"product_type":"c1","uid":1035562,"ip_address":"","ucode":"80482C5F0464A3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/2a/bdbed6ed.jpg","comment_is_top":false,"comment_ctime":1560763056,"is_pvip":false,"replies":[{"id":"37838","content":"后面还会穿插讲到一些。不过您有什么疑问吗？我可以在这里再详细说说：0","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560818329,"ip_address":"","comment_id":104477,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560763056","product_id":100029201,"comment_content":"老师 关于分区，副本这些概念，后面会再详细讲解吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454285,"discussion_content":"后面还会穿插讲到一些。不过您有什么疑问吗？我可以在这里再详细说说：0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560818329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104340,"user_name":"莫问流年","can_delete":false,"product_type":"c1","uid":1249663,"ip_address":"","ucode":"23140E031AED4B","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/7f/80d56c1c.jpg","comment_is_top":false,"comment_ctime":1560734163,"is_pvip":false,"replies":[{"id":"37796","content":"预留的部分已经考虑了副本机制引入的带宽了。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560741197,"ip_address":"","comment_id":104340,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560734163","product_id":100029201,"comment_content":"分析带宽的时候，需要考虑副本机制带来的带宽损耗吗？或者说leader和follower之间采用不同网卡和宽带吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454235,"discussion_content":"预留的部分已经考虑了副本机制引入的带宽了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560741197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104324,"user_name":"Juc","can_delete":false,"product_type":"c1","uid":1217566,"ip_address":"","ucode":"EF82A73FAA7F8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/94/1e/973cda79.jpg","comment_is_top":false,"comment_ctime":1560733067,"is_pvip":false,"replies":[{"id":"37795","content":"预留的空间主要就是为Kafka索引文件预留的","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560741160,"ip_address":"","comment_id":104324,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560733067","product_id":100029201,"comment_content":"老师请解释下：磁盘容量实际使用中建议预留20%-30%的磁盘空间包不包括为其他类型的数据（比如索引数据等）预留出的10%的磁盘空间呢？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454226,"discussion_content":"预留的空间主要就是为Kafka索引文件预留的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560741160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104245,"user_name":"电光火石","can_delete":false,"product_type":"c1","uid":1013160,"ip_address":"","ucode":"3AD33BB4AA940F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/a8/dfe4cade.jpg","comment_is_top":false,"comment_ctime":1560697097,"is_pvip":false,"replies":[{"id":"37761","content":"Kafka metrics都是应用级别的监控指标，没有这种IT级别的指标（如果咱们理解的丢包率是相同的概念的话: ）<br><br>是否可以提供完整的Kafka Metrics名字我帮查查？","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560732844,"ip_address":"","comment_id":104245,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560697097","product_id":100029201,"comment_content":"在线上，通过kafka metric读到一个丢包率，之前一直没有想明白这个丢包是怎么出来的，broker也没有down过，是否就是由于网络带宽被打满造成的？谢谢了！","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454186,"discussion_content":"Kafka metrics都是应用级别的监控指标，没有这种IT级别的指标（如果咱们理解的丢包率是相同的概念的话: ）\n\n是否可以提供完整的Kafka Metrics名字我帮查查？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560732844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104198,"user_name":"Mango","can_delete":false,"product_type":"c1","uid":1564934,"ip_address":"","ucode":"073105303CB9FC","user_header":"https://static001.geekbang.org/account/avatar/00/17/e1/06/240fe348.jpg","comment_is_top":false,"comment_ctime":1560679960,"is_pvip":false,"replies":[{"id":"37745","content":"我想表达的是：如果副本数是1，消息只需要1份；如果还有两个follower，消息共保存3份，因此机器数变为了原来的3倍——这个假设是：follower与leader处于不同的broker而实际环境中不推荐单机多broker的架构","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560687997,"ip_address":"","comment_id":104198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560679960","product_id":100029201,"comment_content":"老师，消息要额外复制两份，那么机器数为何要乘以三？是因为三台机器之间要耗费贷款，所以可处理实际数据的带宽相当于缩小到三分之一吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454169,"discussion_content":"我想表达的是：如果副本数是1，消息只需要1份；如果还有两个follower，消息共保存3份，因此机器数变为了原来的3倍——这个假设是：follower与leader处于不同的broker而实际环境中不推荐单机多broker的架构","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560687997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104135,"user_name":"lh","can_delete":false,"product_type":"c1","uid":1139037,"ip_address":"","ucode":"369259533FA813","user_header":"https://static001.geekbang.org/account/avatar/00/11/61/5d/908ecfa5.jpg","comment_is_top":false,"comment_ctime":1560662768,"is_pvip":false,"replies":[{"id":"37738","content":"是的。因为follower必然与leader在不同的broker上，而实际生产环境中不推荐单机上部署多个broker——尽管你的服务器可能很强劲，起多个broker似乎没有问题，但对Kafka而言，带宽往往最先成为瓶颈，这个是单机规避不掉的。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560687544,"ip_address":"","comment_id":104135,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560662768","product_id":100029201,"comment_content":"如果消息还需要额外复制两份，那么总的服务器台数还要乘以 3。<br>请问这里额外复制两份的消息指的是什么消息，两个followers上从lead上同步的消息吗？为什么复制的消息需要重复计算？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454139,"discussion_content":"是的。因为follower必然与leader在不同的broker上，而实际生产环境中不推荐单机上部署多个broker——尽管你的服务器可能很强劲，起多个broker似乎没有问题，但对Kafka而言，带宽往往最先成为瓶颈，这个是单机规避不掉的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560687544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104031,"user_name":"zhisheng","can_delete":false,"product_type":"c1","uid":1132453,"ip_address":"","ucode":"4C5114A07352E4","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/a5/1aae0fec.jpg","comment_is_top":false,"comment_ctime":1560595851,"is_pvip":false,"replies":[{"id":"37735","content":"目前免费的方案就是Kafka自带的MirrorMaker了，不过据业界反映极不好用，主要是错误处理方面不太健壮。很多公司都或多或少地改写了MirrorMaker，比如Uber。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560687360,"ip_address":"","comment_id":104031,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560595851","product_id":100029201,"comment_content":"老师，如果要跨集群不停机迁移 Kafka 有什么可供参考的方案吗？<br><br>","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454097,"discussion_content":"目前免费的方案就是Kafka自带的MirrorMaker了，不过据业界反映极不好用，主要是错误处理方面不太健壮。很多公司都或多或少地改写了MirrorMaker，比如Uber。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560687360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103974,"user_name":"Royal","can_delete":false,"product_type":"c1","uid":1213755,"ip_address":"","ucode":"74BCA314755C69","user_header":"https://static001.geekbang.org/account/avatar/00/12/85/3b/cfdc8bf2.jpg","comment_is_top":false,"comment_ctime":1560578865,"is_pvip":false,"replies":[{"id":"37732","content":"这要取决于哪个JMX指标了，比如计算请求延时的JMX指标就是在producer端接收到响应之后计算的","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560687062,"ip_address":"","comment_id":103974,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560578865","product_id":100029201,"comment_content":"您好，我的意思是Kafka produce等metric是怎么计算的？老师可以解答下么","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454076,"discussion_content":"这要取决于哪个JMX指标了，比如计算请求延时的JMX指标就是在producer端接收到响应之后计算的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560687062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103927,"user_name":"刚子","can_delete":false,"product_type":"c1","uid":1017080,"ip_address":"","ucode":"7B55EC80A7A4A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/f8/c22d32b4.jpg","comment_is_top":false,"comment_ctime":1560567228,"is_pvip":false,"replies":[{"id":"37601","content":"通常不必这么细粒度。网上有一些分区制定的建议，我觉得这个粗粒度的方法就很好，值得一试：<br>1. 首先你要确定你业务的SLA，比如说你希望你的producer TPS是10万条消息&#47;秒，假设是T1<br>2. 在你的真实环境中创建一个单分区的topic测试一下TPS，假设是T2<br>3. 你需要的分区数大致可以等于T1 &#47; T2<br>3. ","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560571763,"ip_address":"","comment_id":103927,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560567228","product_id":100029201,"comment_content":"kafka 的分区数量的设置需要参考每秒传输的字节数计算吗？谢谢老师","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454059,"discussion_content":"通常不必这么细粒度。网上有一些分区制定的建议，我觉得这个粗粒度的方法就很好，值得一试：\n1. 首先你要确定你业务的SLA，比如说你希望你的producer TPS是10万条消息/秒，假设是T1\n2. 在你的真实环境中创建一个单分区的topic测试一下TPS，假设是T2\n3. 你需要的分区数大致可以等于T1 / T2\n3. ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560571763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103926,"user_name":"Nero","can_delete":false,"product_type":"c1","uid":1175079,"ip_address":"","ucode":"BEAE3A8AADDD67","user_header":"https://static001.geekbang.org/account/avatar/00/11/ee/27/5b15fa63.jpg","comment_is_top":false,"comment_ctime":1560566857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560566857","product_id":100029201,"comment_content":"明白了，这个是小转大要乘以8，谢谢老师","like_count":0},{"had_liked":false,"id":103908,"user_name":"兆祥","can_delete":false,"product_type":"c1","uid":1046438,"ip_address":"","ucode":"DE7CE5E558A210","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/a6/ce737777.jpg","comment_is_top":false,"comment_ctime":1560563162,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1560563162","product_id":100029201,"comment_content":"带宽是bit，规划的时候要除于八","like_count":0},{"had_liked":false,"id":103868,"user_name":"莱茵金属","can_delete":false,"product_type":"c1","uid":1202204,"ip_address":"","ucode":"896D833414E308","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/1c/8daf82d7.jpg","comment_is_top":false,"comment_ctime":1560556928,"is_pvip":false,"replies":[{"id":"37577","content":"直接敲命令有参数提示，可以详细看下。另外我的建议是：kafka-producer-perf-test脚本还不错，kafka-consumer-perf-test有点难用","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560559146,"ip_address":"","comment_id":103868,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560556928","product_id":100029201,"comment_content":"能讲讲kafka的性能测试脚本怎么使用吗？","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454033,"discussion_content":"直接敲命令有参数提示，可以详细看下。另外我的建议是：kafka-producer-perf-test脚本还不错，kafka-consumer-perf-test有点难用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560559146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103863,"user_name":"13501018051","can_delete":false,"product_type":"c1","uid":1218076,"ip_address":"","ucode":"D90E50B9C249AE","user_header":"","comment_is_top":false,"comment_ctime":1560554670,"is_pvip":false,"replies":[{"id":"37575","content":"如果配置好ZooKeeper事务日志（比如设置好autopurge.purgeInterval及定期删除snapshot等），它对IO的需求不大，混布也是可以的。","user_name":"作者回复","user_name_real":"huxi_2b","uid":"1288090","ctime":1560559053,"ip_address":"","comment_id":103863,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560554670","product_id":100029201,"comment_content":"zookeeper部署方案和kafka一样么？分开部署还是部署到一起？我们现在都是一个机器上部署一个zookeeper和一个kafka","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"胡夕","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454030,"discussion_content":"如果配置好ZooKeeper事务日志（比如设置好autopurge.purgeInterval及定期删除snapshot等），它对IO的需求不大，混布也是可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560559053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}