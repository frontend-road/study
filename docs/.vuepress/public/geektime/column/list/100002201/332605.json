{"id":332605,"title":"110 | Goç¼–ç¨‹æ¨¡å¼ï¼šå§”æ‰˜å’Œåè½¬æ§åˆ¶","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆçš“ï¼Œç½‘åå·¦è€³æœµè€—å­ã€‚</p><p>æ§åˆ¶åè½¬ï¼ˆ<a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\">Inversion of Control</a><a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\">ï¼ŒloC</a>  ï¼‰æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡çš„æ–¹æ³•ï¼Œå®ƒçš„ä¸»è¦æ€æƒ³æ˜¯æŠŠæ§åˆ¶é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†å¼€ï¼Œä¸è¦åœ¨ä¸šåŠ¡é€»è¾‘é‡Œå†™æ§åˆ¶é€»è¾‘ï¼Œå› ä¸ºè¿™æ ·ä¼šè®©æ§åˆ¶é€»è¾‘ä¾èµ–äºä¸šåŠ¡é€»è¾‘ï¼Œè€Œæ˜¯åè¿‡æ¥ï¼Œè®©ä¸šåŠ¡é€»è¾‘ä¾èµ–æ§åˆ¶é€»è¾‘ã€‚</p><p>æˆ‘ä¹‹å‰åœ¨ã€Š<a href=\"https://coolshell.cn/articles/9949.html\">IoC/DIPå…¶å®æ˜¯ä¸€ç§ç®¡ç†æ€æƒ³</a>ã€‹è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä¸¾è¿‡ä¸€ä¸ªå¼€å…³å’Œç”µç¯çš„ä¾‹å­ã€‚å…¶å®ï¼Œè¿™é‡Œçš„å¼€å…³å°±æ˜¯æ§åˆ¶é€»è¾‘ï¼Œç”µå™¨æ˜¯ä¸šåŠ¡é€»è¾‘ã€‚æˆ‘ä»¬ä¸è¦åœ¨ç”µå™¨ä¸­å®ç°å¼€å…³ï¼Œè€Œæ˜¯è¦æŠŠå¼€å…³æŠ½è±¡æˆä¸€ç§åè®®ï¼Œè®©ç”µå™¨éƒ½ä¾èµ–å®ƒã€‚è¿™æ ·çš„ç¼–ç¨‹æ–¹å¼å¯ä»¥æœ‰æ•ˆé™ä½ç¨‹åºå¤æ‚åº¦ï¼Œå¹¶æå‡ä»£ç é‡ç”¨åº¦ã€‚</p><p>é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼æˆ‘å°±ä¸æäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹Goè¯­è¨€ä½¿ç”¨Embedç»“æ„çš„ä¸€ä¸ªç¤ºä¾‹ã€‚</p><h2>åµŒå…¥å’Œå§”æ‰˜</h2><h3>ç»“æ„ä½“åµŒå…¥</h3><p>åœ¨Goè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾åœ°æŠŠä¸€ä¸ªç»“æ„ä½“åµŒåˆ°å¦ä¸€ä¸ªç»“æ„ä½“ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>type Widget struct {\n    X, Y int\n}\ntype Label struct {\n    Widget        // Embedding (delegation)\n    Text   string // Aggregation\n}\n</code></pre><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æŠŠ <code>Widget</code>åµŒå…¥åˆ°äº† <code>Label</code> ä¸­ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p><pre><code>label := Label{Widget{10, 10}, &quot;State:&quot;}\n\nlabel.X = 11\nlabel.Y = 12\n</code></pre><p>å¦‚æœåœ¨<code>Label</code> ç»“æ„ä½“é‡Œå‡ºç°äº†é‡åï¼Œå°±éœ€è¦è§£å†³é‡åé—®é¢˜ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæˆå‘˜ <code>X</code> é‡åï¼Œæˆ‘ä»¬å°±è¦ç”¨ <code>label.X</code>è¡¨æ˜æ˜¯è‡ªå·±çš„<code>X</code> ï¼Œç”¨ <code>label.Wedget.X</code> è¡¨æ˜æ˜¯åµŒå…¥è¿‡æ¥çš„ã€‚</p><p>æœ‰äº†è¿™æ ·çš„åµŒå…¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒUIç»„ä»¶ä¸€æ ·ï¼Œåœ¨ç»“æ„çš„è®¾è®¡ä¸Šè¿›è¡Œå±‚å±‚åˆ†è§£äº†ã€‚æ¯”å¦‚ï¼Œæˆ‘å¯ä»¥æ–°å†™å‡ºä¸¤ä¸ªç»“æ„ä½“ <code>Button</code> å’Œ <code>ListBox</code>ï¼š</p><!-- [[[read_end]]] --><pre><code>type Button struct {\n    Label // Embedding (delegation)\n}\n\ntype ListBox struct {\n    Widget          // Embedding (delegation)\n    Texts  []string // Aggregation\n    Index  int      // Aggregation\n}\n</code></pre><h3>æ–¹æ³•é‡å†™</h3><p>ç„¶åï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ¥å£ï¼šç”¨PainteræŠŠç»„ä»¶ç”»å‡ºæ¥ï¼›Clicker ç”¨äºè¡¨æ˜ç‚¹å‡»äº‹ä»¶ã€‚</p><pre><code>type Painter interface {\n    Paint()\n}\n \ntype Clicker interface {\n    Click()\n}\n</code></pre><p>å½“ç„¶ï¼Œå¯¹äº <code>Lable</code> æ¥è¯´ï¼Œåªæœ‰ <code>Painter</code> ï¼Œæ²¡æœ‰<code>Clicker</code>ï¼›å¯¹äº <code>Button</code> å’Œ <code>ListBox</code>æ¥è¯´ï¼Œ<code>Painter</code> å’Œ<code>Clicker</code>éƒ½æœ‰ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€äº›å®ç°ï¼š</p><pre><code>func (label Label) Paint() {\n  fmt.Printf(&quot;%p:Label.Paint(%q)\\n&quot;, &amp;label, label.Text)\n}\n\n//å› ä¸ºè¿™ä¸ªæ¥å£å¯ä»¥é€šè¿‡ Label çš„åµŒå…¥å¸¦åˆ°æ–°çš„ç»“æ„ä½“ï¼Œ\n//æ‰€ä»¥ï¼Œå¯ä»¥åœ¨ Button ä¸­é‡è½½è¿™ä¸ªæ¥å£æ–¹æ³•\nfunc (button Button) Paint() { // Override\n    fmt.Printf(&quot;Button.Paint(%s)\\n&quot;, button.Text)\n}\nfunc (button Button) Click() {\n    fmt.Printf(&quot;Button.Click(%s)\\n&quot;, button.Text)\n}\n\n\nfunc (listBox ListBox) Paint() {\n    fmt.Printf(&quot;ListBox.Paint(%q)\\n&quot;, listBox.Texts)\n}\nfunc (listBox ListBox) Click() {\n    fmt.Printf(&quot;ListBox.Click(%q)\\n&quot;, listBox.Texts)\n}\n</code></pre><p>è¯´åˆ°è¿™å„¿ï¼Œæˆ‘è¦é‡ç‚¹æé†’ä½ ä¸€ä¸‹ï¼Œ<code>Button.Paint()</code> æ¥å£å¯ä»¥é€šè¿‡ Label çš„åµŒå…¥å¸¦åˆ°æ–°çš„ç»“æ„ä½“ï¼Œå¦‚æœ <code>Button.Paint()</code> ä¸å®ç°çš„è¯ï¼Œä¼šè°ƒç”¨ <code>Label.Paint()</code> ï¼Œæ‰€ä»¥ï¼Œåœ¨ <code>Button</code> ä¸­å£°æ˜ <code>Paint()</code> æ–¹æ³•ï¼Œç›¸å½“äºOverrideã€‚</p><h3>åµŒå…¥ç»“æ„å¤šæ€</h3><p>ä»ä¸‹é¢çš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªå¤šæ€æ˜¯æ€ä¹ˆæ‰§è¡Œçš„ã€‚</p><pre><code>button1 := Button{Label{Widget{10, 70}, &quot;OK&quot;}}\nbutton2 := NewButton(50, 70, &quot;Cancel&quot;)\nlistBox := ListBox{Widget{10, 40}, \n    []string{&quot;AL&quot;, &quot;AK&quot;, &quot;AZ&quot;, &quot;AR&quot;}, 0}\n\nfor _, painter := range []Painter{label, listBox, button1, button2} {\n    painter.Paint()\n}\n \nfor _, widget := range []interface{}{label, listBox, button1, button2} {\n  widget.(Painter).Paint()\n  if clicker, ok := widget.(Clicker); ok {\n    clicker.Click()\n  }\n  fmt.Println() // print a empty line \n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£æ¥å¤šæ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹çš„ <code>interface{}</code> æ¥å¤šæ€ï¼Œä½†æ˜¯éœ€è¦æœ‰ä¸€ä¸ªç±»å‹è½¬æ¢ã€‚</p><h2>åè½¬æ§åˆ¶</h2><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ã€‚</p><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æ”¾æ•´æ•°çš„æ•°æ®ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>type IntSet struct {\n    data map[int]bool\n}\nfunc NewIntSet() IntSet {\n    return IntSet{make(map[int]bool)}\n}\nfunc (set *IntSet) Add(x int) {\n    set.data[x] = true\n}\nfunc (set *IntSet) Delete(x int) {\n    delete(set.data, x)\n}\nfunc (set *IntSet) Contains(x int) bool {\n    return set.data[x]\n}\n</code></pre><p>å…¶ä¸­å®ç°äº† <code>Add()</code> ã€<code>Delete()</code> å’Œ <code>Contains()</code> ä¸‰ä¸ªæ“ä½œï¼Œå‰ä¸¤ä¸ªæ˜¯å†™æ“ä½œï¼Œåä¸€ä¸ªæ˜¯è¯»æ“ä½œã€‚</p><h3>å®ç°UndoåŠŸèƒ½</h3><p>ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³å®ç°ä¸€ä¸ª Undo çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥å†åŒ…è£…ä¸€ä¸‹  <code>IntSet</code>  ï¼Œå˜æˆ <code>UndoableIntSet</code>  ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>type UndoableIntSet struct { // Poor style\n    IntSet    // Embedding (delegation)\n    functions []func()\n}\n \nfunc NewUndoableIntSet() UndoableIntSet {\n    return UndoableIntSet{NewIntSet(), nil}\n}\n \n\nfunc (set *UndoableIntSet) Add(x int) { // Override\n    if !set.Contains(x) {\n        set.data[x] = true\n        set.functions = append(set.functions, func() { set.Delete(x) })\n    } else {\n        set.functions = append(set.functions, nil)\n    }\n}\n\n\nfunc (set *UndoableIntSet) Delete(x int) { // Override\n    if set.Contains(x) {\n        delete(set.data, x)\n        set.functions = append(set.functions, func() { set.Add(x) })\n    } else {\n        set.functions = append(set.functions, nil)\n    }\n}\n\nfunc (set *UndoableIntSet) Undo() error {\n    if len(set.functions) == 0 {\n        return errors.New(&quot;No functions to undo&quot;)\n    }\n    index := len(set.functions) - 1\n    if function := set.functions[index]; function != nil {\n        function()\n        set.functions[index] = nil // For garbage collection\n    }\n    set.functions = set.functions[:index]\n    return nil\n}\n</code></pre><p>æˆ‘æ¥è§£é‡Šä¸‹è¿™æ®µä»£ç ã€‚</p><ul>\n<li>æˆ‘ä»¬åœ¨ <code>UndoableIntSet</code> ä¸­åµŒå…¥äº†<code>IntSet</code> ï¼Œç„¶åOverrideäº† å®ƒçš„ <code>Add()</code>å’Œ <code>Delete()</code> æ–¹æ³•ï¼›</li>\n<li><code>Contains()</code> æ–¹æ³•æ²¡æœ‰Overrideï¼Œæ‰€ä»¥ï¼Œå°±è¢«å¸¦åˆ° <code>UndoableInSet</code> ä¸­æ¥äº†ã€‚</li>\n<li>åœ¨Overrideçš„ <code>Add()</code>ä¸­ï¼Œè®°å½• <code>Delete</code> æ“ä½œï¼›</li>\n<li>åœ¨Overrideçš„ <code>Delete()</code> ä¸­ï¼Œè®°å½• <code>Add</code> æ“ä½œï¼›</li>\n<li>åœ¨æ–°åŠ å…¥çš„  <code>Undo()</code> ä¸­è¿›è¡ŒUndoæ“ä½œã€‚</li>\n</ul><p>ç”¨è¿™æ ·çš„æ–¹å¼ä¸ºå·²æœ‰çš„ä»£ç æ‰©å±•æ–°çš„åŠŸèƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥åœ¨é‡ç”¨åŸæœ‰ä»£ç åŠŸèƒ½å’Œæ–°çš„åŠŸèƒ½ä¸­è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼æœ€å¤§çš„é—®é¢˜æ˜¯ï¼ŒUndoæ“ä½œå…¶å®æ˜¯ä¸€ç§æ§åˆ¶é€»è¾‘ï¼Œå¹¶ä¸æ˜¯ä¸šåŠ¡é€»è¾‘ï¼Œæ‰€ä»¥ï¼Œåœ¨å¤ç”¨ Undoè¿™ä¸ªåŠŸèƒ½æ—¶ï¼Œæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå…¶ä¸­åŠ å…¥äº†å¤§é‡è·Ÿ <code>IntSet</code> ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><h3>åè½¬ä¾èµ–</h3><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å…ˆå£°æ˜ä¸€ç§å‡½æ•°æ¥å£ï¼Œè¡¨ç¤ºæˆ‘ä»¬çš„Undoæ§åˆ¶å¯ä»¥æ¥å—çš„å‡½æ•°ç­¾åæ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p><pre><code>type Undo []func()\n</code></pre><p>æœ‰äº†è¿™ä¸ªåè®®ä¹‹åï¼Œæˆ‘ä»¬çš„Undoæ§åˆ¶é€»è¾‘å°±å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>func (undo *Undo) Add(function func()) {\n  *undo = append(*undo, function)\n}\n\nfunc (undo *Undo) Undo() error {\n  functions := *undo\n  if len(functions) == 0 {\n    return errors.New(&quot;No functions to undo&quot;)\n  }\n  index := len(functions) - 1\n  if function := functions[index]; function != nil {\n    function()\n    functions[index] = nil // For garbage collection\n  }\n  *undo = functions[:index]\n  return nil\n}\n</code></pre><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¸å¿…è§‰å¾—å¥‡æ€ªï¼Œ <code>Undo</code> æœ¬æ¥å°±æ˜¯ä¸€ä¸ªç±»å‹ï¼Œä¸å¿…æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°æ•°ç»„ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨IntSeté‡ŒåµŒå…¥ Undoï¼Œæ¥ç€åœ¨ <code>Add()</code> å’Œ <code>Delete()</code> é‡Œä½¿ç”¨åˆšåˆšçš„æ–¹æ³•ï¼Œå°±å¯ä»¥å®ŒæˆåŠŸèƒ½äº†ã€‚</p><pre><code>type IntSet struct {\n    data map[int]bool\n    undo Undo\n}\n \nfunc NewIntSet() IntSet {\n    return IntSet{data: make(map[int]bool)}\n}\n\nfunc (set *IntSet) Undo() error {\n    return set.undo.Undo()\n}\n \nfunc (set *IntSet) Contains(x int) bool {\n    return set.data[x]\n}\n\nfunc (set *IntSet) Add(x int) {\n    if !set.Contains(x) {\n        set.data[x] = true\n        set.undo.Add(func() { set.Delete(x) })\n    } else {\n        set.undo.Add(nil)\n    }\n}\n \nfunc (set *IntSet) Delete(x int) {\n    if set.Contains(x) {\n        delete(set.data, x)\n        set.undo.Add(func() { set.Add(x) })\n    } else {\n        set.undo.Add(nil)\n    }\n}\n</code></pre><p>è¿™ä¸ªå°±æ˜¯æ§åˆ¶åè½¬ï¼Œä¸æ˜¯ç”±æ§åˆ¶é€»è¾‘ <code>Undo</code>  æ¥ä¾èµ–ä¸šåŠ¡é€»è¾‘ <code>IntSet</code>ï¼Œè€Œæ˜¯ç”±ä¸šåŠ¡é€»è¾‘ <code>IntSet</code> ä¾èµ– <code>Undo</code> ã€‚è¿™é‡Œä¾èµ–çš„æ˜¯å…¶å®æ˜¯ä¸€ä¸ªåè®®ï¼Œ<strong>è¿™ä¸ªåè®®æ˜¯ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°æ•°ç»„ã€‚</strong>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ Undo çš„ä»£ç å°±å¯ä»¥å¤ç”¨äº†ã€‚</p><p>å¥½äº†ï¼Œè¿™èŠ‚è¯¾å°±åˆ°è¿™é‡Œã€‚å¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ä½ å¸®æˆ‘åˆ†äº«ç»™æ›´å¤šäººã€‚</p>","neighbors":{"left":{"article_title":"109 | Go ç¼–ç¨‹æ¨¡å¼ï¼šFunctional Options","id":332603},"right":{"article_title":"111 | Go ç¼–ç¨‹æ¨¡å¼ï¼šMap-Reduce","id":332606}},"comments":[{"had_liked":false,"id":297361,"user_name":"debugtalk","can_delete":false,"product_type":"c1","uid":1005452,"ip_address":"","ucode":"D6F0E57E79808C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/8c/8fba0bdd.jpg","comment_is_top":false,"comment_ctime":1623483644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14508385532","product_id":100002201,"comment_content":"æ‰‹åŠ¨ç‚¹èµ","like_count":4},{"had_liked":false,"id":356673,"user_name":"limix","can_delete":false,"product_type":"c1","uid":1166614,"ip_address":"å®‰å¾½","ucode":"76401FF54AE0D8","user_header":"https://static001.geekbang.org/account/avatar/00/11/cd/16/981cc4f8.jpg","comment_is_top":false,"comment_ctime":1662497687,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662497687","product_id":100002201,"comment_content":"æ§åˆ¶é€»è¾‘çš„ç‰¹å¾æ˜¯å¯å¤ç”¨æ€§æ¯”è¾ƒé«˜ï¼Œå¤šåœºæ™¯å¯ç”¨ï¼Œè€Œä¸šåŠ¡é€»è¾‘çš„ç‰¹å¾æ˜¯ä¸“ç”¨æ€§ï¼Œæ§åˆ¶é€»è¾‘ï¼Œåº”è¯¥å¤ç”¨æ§åˆ¶é€»è¾‘ï¼Œè€Œä¸æ˜¯å¤ç”¨ä¹Ÿè®¸é€»è¾‘","like_count":1},{"had_liked":false,"id":355611,"user_name":"cvvz","can_delete":false,"product_type":"c1","uid":1943722,"ip_address":"æ—¥æœ¬","ucode":"FC55B0D628B266","user_header":"https://static001.geekbang.org/account/avatar/00/1d/a8/aa/de5e7d26.jpg","comment_is_top":false,"comment_ctime":1661563079,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661563079","product_id":100002201,"comment_content":"åè½¬æ§åˆ¶ï¼š<br>ç¬¬ä¸€ç§æ”¹å†™æ–¹æ³•â€”â€”ç»§æ‰¿ï¼Œå¥½å¤„æ˜¯åŸæœ‰ä»£ç å¯ä»¥å¤ç”¨ï¼Œæ§åˆ¶é€»è¾‘å’Œä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Œåå¤„æ˜¯é€šç”¨çš„æ§åˆ¶é€»è¾‘æ— æ³•å¤ç”¨<br>ç¬¬äºŒç§æ”¹å†™æ–¹æ³•â€”â€”åè½¬æ§åˆ¶ï¼Œå¥½å¤„æ˜¯å¤ç”¨é€šç”¨çš„æ§åˆ¶é€»è¾‘ï¼Œåå¤„æ˜¯è¦ä¿®æ”¹åŸæœ‰ä»£ç çš„é€»è¾‘ï¼ŒæŠŠæ§åˆ¶é€»è¾‘åµŒå…¥åˆ°äº†ä¸šåŠ¡é€»è¾‘ä¸­","like_count":0},{"had_liked":false,"id":331468,"user_name":"Geek_ce6971","can_delete":false,"product_type":"c1","uid":2016458,"ip_address":"","ucode":"8826A1C6BF8355","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAHCRt6dBUDTFX4EotyV5NDbYiaUXH109SOdRprLky1PUc9jm2K7QvoCpkZuCyqMCNSogUpdFzMJw/132","comment_is_top":false,"comment_ctime":1642595481,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642595481","product_id":100002201,"comment_content":"å®ç°undoåŠŸèƒ½ï¼Œæœ‰ä¸ªåœ°æ–¹æ˜¯å†™åäº†å—<br>åœ¨ Override çš„ Add()ä¸­ï¼Œè®°å½• Delete æ“ä½œï¼›åœ¨ Override çš„ Delete() ä¸­ï¼Œè®°å½• Add æ“ä½œï¼›","like_count":0,"discussions":[{"author":{"id":2941058,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/e0/82/17d214df.jpg","nickname":"ææµ·æ´‹","note":"","ucode":"5D642B3F9BF09B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570927,"discussion_content":"è®°å½•çš„æ˜¯undoè¦åšçš„äº‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651996807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327152,"user_name":"æ–¹å‹‡(gopher)","can_delete":false,"product_type":"c1","uid":1290625,"ip_address":"","ucode":"D199911C4CFEF5","user_header":"https://static001.geekbang.org/account/avatar/00/13/b1/81/13f23d1e.jpg","comment_is_top":false,"comment_ctime":1639963018,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639963018","product_id":100002201,"comment_content":"æ—¥å¸¸ä¸­æœ‰äº›è£…é¥°å™¨å…¶å®å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ›¿æ¢","like_count":0},{"had_liked":false,"id":323972,"user_name":"è¡¡å­","can_delete":false,"product_type":"c1","uid":1109433,"ip_address":"","ucode":"0AED79FC9D14BB","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/b9/825b2411.jpg","comment_is_top":false,"comment_ctime":1638244298,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638244298","product_id":100002201,"comment_content":"å‰å®³äº†ğŸ‘","like_count":0},{"had_liked":false,"id":306751,"user_name":"ä¸€å…‰å¹´","can_delete":false,"product_type":"c1","uid":1576620,"ip_address":"","ucode":"779FEC7C42C1F7","user_header":"https://static001.geekbang.org/account/avatar/00/18/0e/ac/198a5c0c.jpg","comment_is_top":false,"comment_ctime":1628690628,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628690628","product_id":100002201,"comment_content":"æ§åˆ¶é€»è¾‘ä¾èµ–ä¸šåŠ¡é€»è¾‘ï¼Œä¸å¦‚è®©ä¸šåŠ¡å®¹å™¨ä¾èµ–æ§åˆ¶é€»è¾‘","like_count":0},{"had_liked":false,"id":304262,"user_name":"Geek_46da16","can_delete":false,"product_type":"c1","uid":2707429,"ip_address":"","ucode":"C9A677461A979B","user_header":"","comment_is_top":false,"comment_ctime":1627309338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627309338","product_id":100002201,"comment_content":"ä¼šç©ï¼Œ","like_count":0}]}