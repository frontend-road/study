{"id":185189,"title":"17 | å‡½æ•°å¼ç¼–ç¨‹ï¼šä¸€ç§è¶Šæ¥è¶Šæµè¡Œçš„ç¼–ç¨‹èŒƒå¼","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´å’ç‚œã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬åˆæ­¥ä»‹ç»äº†å‡½æ•°å¯¹è±¡å’Œ lambda è¡¨è¾¾å¼ï¼Œä»Šå¤©æˆ‘ä»¬æ¥è®²è®²å®ƒä»¬çš„ä¸»è¦ç”¨é€”â€”â€”å‡½æ•°å¼ç¼–ç¨‹ã€‚</p><h2>ä¸€ä¸ªå°ä¾‹å­</h2><p>æŒ‰æƒ¯ä¾‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç»™å®šä¸€ç»„æ–‡ä»¶åï¼Œè¦æ±‚æ•°ä¸€ä¸‹æ–‡ä»¶é‡Œçš„æ€»æ–‡æœ¬è¡Œæ•°ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</p><p>æˆ‘ä»¬å…ˆè§„å®šä¸€ä¸‹å‡½æ•°çš„åŸå‹ï¼š</p><pre><code class=\"language-c++\">int count_lines(const char** begin,\n                const char** end);\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æœŸå¾…æ¥å—ä¸¤ä¸ª C å­—ç¬¦ä¸²çš„è¿­ä»£å™¨ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„æ–‡ä»¶åï¼›è¿”å›å€¼ä»£è¡¨æ–‡ä»¶ä¸­çš„æ€»è¡Œæ•°ã€‚</p><p>è¦æµ‹è¯•è¡Œä¸ºæ˜¯å¦æ­£å¸¸ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾ˆå°çš„ <code>main</code> å‡½æ•°ï¼š</p><pre><code class=\"language-c++\">int main(int argc,\n         const char** argv)\n{\n  int total_lines = count_lines(\n    argv + 1, argv + argc);\n  cout &lt;&lt; \"Total lines: \"\n       &lt;&lt; total_lines &lt;&lt; endl;\n}\n</code></pre><p>æœ€ä¼ ç»Ÿçš„å‘½ä»¤å¼ç¼–ç¨‹å¤§æ¦‚ä¼šè¿™æ ·å†™ä»£ç ï¼š</p><pre><code class=\"language-c++\">int count_file(const char* name)\n{\n  int count = 0;\n  ifstream ifs(name);\n  string line;\n  for (;;) {\n    getline(ifs, line);\n    if (!ifs) {\n      break;\n    }\n    ++count;\n  }\n  return count;\n}\n\nint count_lines(const char** begin,\n                const char** end)\n{\n  int count = 0;\n  for (; begin != end; ++begin) {\n    count += count_file(*begin);\n  }\n  return count;\n}\n</code></pre><!-- [[[read_end]]] --><p>æˆ‘ä»¬é©¬ä¸Šå¯ä»¥åšä¸€ä¸ªç®€å•çš„â€œè¯´æ˜å¼â€æ”¹é€ ã€‚ç”¨ <code>istream_line_reader</code> å¯ä»¥ç®€åŒ– <code>count_file</code> æˆï¼š</p><pre><code class=\"language-c++\">int count_file(const char* name)\n{\n  int count = 0;\n  ifstream ifs(name);\n  for (auto&amp;&amp; line :\n       istream_line_reader(ifs)) {\n    ++count;\n  }\n  return count;\n}\n</code></pre><p>åœ¨è¿™å„¿ï¼Œè¦è¯·ä½ åœä¸€ä¸‹ï¼Œæƒ³ä¸€æƒ³å¦‚ä½•è¿›ä¸€æ­¥ä¼˜åŒ–è¿™ä¸ªä»£ç ã€‚ç„¶åå†ç»§ç»­è¿›è¡Œå¾€ä¸‹çœ‹ã€‚</p><hr><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰å·²ç»å‡ºåœºè¿‡çš„ä¸¤ä¸ªå‡½æ•°ï¼Œ<code>transform</code> <span class=\"orange\">[1]</span> å’Œ <code>accumulate</code> <span class=\"orange\">[2]</span>ï¼Œä»£ç å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ä¸ºï¼š</p><pre><code class=\"language-c++\">int count_file(const char* name)\n{\n  ifstream ifs(name);\n  istream_line_reader reader(ifs);\n  return distance(reader.begin(),\n                  reader.end());\n}\n\nint count_lines(const char** begin,\n                const char** end)\n{\n  vector&lt;int&gt; count(end - begin);\n  transform(begin, end,\n            count.begin(),\n            count_file);\n  return accumulate(\n    count.begin(), count.end(),\n    0);\n}\n</code></pre><p>è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªéå¸¸å‡½æ•°å¼é£æ ¼çš„ç»“æœäº†ã€‚ä¸Šé¢è¿™ä¸ªå¤„ç†æ–¹å¼æ°æ°å°±æ˜¯ map-reduceã€‚<code>transform</code> å¯¹åº” mapï¼Œ<code>accumulate</code> å¯¹åº” reduceã€‚è€Œæ£€æŸ¥æœ‰å¤šå°‘è¡Œæ–‡æœ¬ï¼Œä¹Ÿæˆäº†ä»£è¡¨æ–‡ä»¶å¤´å°¾ä¸¤ä¸ªè¿­ä»£å™¨ä¹‹é—´çš„â€œè·ç¦»â€ï¼ˆdistanceï¼‰ã€‚</p><h2>å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹</h2><p>åœ¨æˆ‘ä»¬çš„ä»£ç é‡Œä¸é‚£ä¹ˆæ˜æ˜¾çš„ä¸€ç‚¹æ˜¯ï¼Œå‡½æ•°å¼ç¼–ç¨‹æœŸæœ›å‡½æ•°çš„è¡Œä¸ºåƒæ•°å­¦ä¸Šçš„å‡½æ•°ï¼Œè€Œéä¸€ä¸ªè®¡ç®—æœºä¸Šçš„å­ç¨‹åºã€‚è¿™æ ·çš„å‡½æ•°ä¸€èˆ¬è¢«ç§°ä¸ºçº¯å‡½æ•°ï¼ˆpure functionï¼‰ï¼Œè¦ç‚¹åœ¨äºï¼š</p><ul>\n<li>ä¼šå½±å“å‡½æ•°ç»“æœçš„åªæ˜¯å‡½æ•°çš„å‚æ•°ï¼Œæ²¡æœ‰å¯¹ç¯å¢ƒçš„ä¾èµ–</li>\n<li>è¿”å›çš„ç»“æœå°±æ˜¯å‡½æ•°æ‰§è¡Œçš„å”¯ä¸€åæœï¼Œä¸äº§ç”Ÿå¯¹ç¯å¢ƒçš„å…¶ä»–å½±å“</li>\n</ul><p>è¿™æ ·çš„ä»£ç çš„æœ€å¤§å¥½å¤„æ˜¯æ˜“äºç†è§£å’Œæ˜“äºæ¨ç†ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ä¹Ÿä¼šä½¿ä»£ç æ›´ç®€å•ã€‚åœ¨æˆ‘ä»¬ä¸Šé¢çš„ä»£ç é‡Œï¼Œ<code>count_file</code> å’Œ <code>accumulate</code> åŸºæœ¬ä¸Šå¯ä»¥çœ‹åšæ˜¯çº¯å‡½æ•°ï¼ˆè™½ç„¶å‰è€…å®é™…ä¸Šæœ‰ç€å¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¾èµ–ï¼‰ï¼Œä½† <code>transform</code> ä¸è¡Œï¼Œå› ä¸ºå®ƒæ”¹å˜äº†æŸä¸ªå‚æ•°ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªç»“æœã€‚ä¸‹ä¸€è®²æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œè¿™ä¼šå½±å“ä»£ç çš„ç»„åˆæ€§ã€‚</p><p>æˆ‘ä»¬çš„ä»£ç ä¸­ä¹Ÿä½“ç°äº†å…¶ä»–ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹ï¼š</p><ul>\n<li>å‡½æ•°å°±åƒæ™®é€šçš„å¯¹è±¡ä¸€æ ·è¢«ä¼ é€’ã€ä½¿ç”¨å’Œè¿”å›ã€‚</li>\n<li>ä»£ç ä¸ºè¯´æ˜å¼è€Œéå‘½ä»¤å¼ã€‚åœ¨ç†Ÿæ‚‰å‡½æ•°å¼ç¼–ç¨‹çš„åŸºæœ¬èŒƒå¼åï¼Œä½ ä¼šå‘ç°è¯´æ˜å¼ä»£ç çš„å¯è¯»æ€§é€šå¸¸æ¯”å‘½ä»¤å¼è¦é«˜ï¼Œä»£ç è¿˜çŸ­ã€‚</li>\n<li>ä¸€èˆ¬ä¸é¼“åŠ±ï¼ˆç”šè‡³å®Œå…¨ä¸ä½¿ç”¨ï¼‰å¯å˜é‡ã€‚ä¸Šé¢ä»£ç é‡Œåªæœ‰ <code>count</code> çš„å†…å®¹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¢«ä¿®æ”¹äº†ï¼Œè€Œä¸”è¿™ç§ä¿®æ”¹å®é™…æ˜¯ <code>transform</code> æ¥å£å¸¦æ¥çš„ã€‚å¦‚æœæ¥å£åƒ<a href=\"https://time.geekbang.org/column/article/181608\">[ç¬¬ 13 è®²]</a> å±•ç¤ºçš„ <code>fmap</code> å‡½æ•°ä¸€æ ·è¿”å›ä¸€ä¸ªå®¹å™¨çš„è¯ï¼Œå°±å¯ä»¥è¿è¿™ä¸ªé—®é¢˜éƒ½æ¶ˆé™¤äº†ã€‚ï¼ˆC++ æ¯•ç«Ÿä¸æ˜¯ä¸€é—¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œå¯¹çµæ´»æ€§çš„è¿½æ±‚å‹å€’äº†å…¶ä»–è€ƒè™‘ã€‚ï¼‰</li>\n</ul><h3>é«˜é˜¶å‡½æ•°</h3><p>æ—¢ç„¶å‡½æ•°ï¼ˆå¯¹è±¡ï¼‰å¯ä»¥è¢«ä¼ é€’ã€ä½¿ç”¨å’Œè¿”å›ï¼Œè‡ªç„¶å°±æœ‰å‡½æ•°ä¼šæ¥å—å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…æŠŠå‡½æ•°ä½œä¸ºè¿”å›å€¼ï¼Œè¿™æ ·çš„å‡½æ•°å°±è¢«ç§°ä¸ºé«˜é˜¶å‡½æ•°ã€‚æˆ‘ä»¬ç°åœ¨å·²ç»è§è¿‡ä¸å°‘é«˜é˜¶å‡½æ•°äº†ï¼Œå¦‚ï¼š</p><ul>\n<li><code>sort</code></li>\n<li><code>transform</code></li>\n<li><code>accumulate</code></li>\n<li><code>fmap</code></li>\n<li><code>adder</code></li>\n</ul><p>äº‹å®ä¸Šï¼ŒC++ é‡Œä»¥ algorithmï¼ˆç®—æ³•ï¼‰<span class=\"orange\">[3]</span> åä¹‰æä¾›çš„å¾ˆå¤šå‡½æ•°éƒ½æ˜¯é«˜é˜¶å‡½æ•°ã€‚</p><p>è®¸å¤šé«˜é˜¶å‡½æ•°åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­å·²æˆä¸ºåŸºæœ¬çš„æƒ¯ç”¨æ³•ï¼Œåœ¨ä¸åŒè¯­è¨€ä¸­éƒ½ä¼šå‡ºç°ï¼Œè™½ç„¶å¯èƒ½æ˜¯ä»¥ä¸åŒçš„åå­—ã€‚æˆ‘ä»¬åœ¨æ­¤ä»‹ç»éå¸¸å¸¸è§çš„ä¸‰ä¸ªï¼Œmapï¼ˆæ˜ å°„ï¼‰ã€reduceï¼ˆå½’å¹¶ï¼‰å’Œ filterï¼ˆè¿‡æ»¤ï¼‰ã€‚</p><p>Map åœ¨ C++ ä¸­çš„ç›´æ¥æ˜ å°„æ˜¯ <code>transform</code>ï¼ˆåœ¨ &lt;algorithm&gt; å¤´æ–‡ä»¶ä¸­æä¾›ï¼‰ã€‚å®ƒæ‰€åšçš„äº‹æƒ…ä¹Ÿæ˜¯æ•°å­¦ä¸Šçš„æ˜ å°„ï¼ŒæŠŠä¸€ä¸ªèŒƒå›´é‡Œçš„å¯¹è±¡è½¬æ¢æˆç›¸åŒæ•°é‡çš„å¦å¤–ä¸€äº›å¯¹è±¡ã€‚è¿™ä¸ªå‡½æ•°çš„åŸºæœ¬å®ç°éå¸¸ç®€å•ï¼Œä½†è¿™æ˜¯ä¸€ç§å¼ºå¤§çš„æŠ½è±¡ï¼Œåœ¨å¾ˆå¤šåœºåˆéƒ½ç”¨å¾—ä¸Šã€‚</p><p>Reduce åœ¨ C++ ä¸­çš„ç›´æ¥æ˜ å°„æ˜¯ <code>accumulate</code>ï¼ˆåœ¨ &lt;numeric&gt; å¤´æ–‡ä»¶ä¸­æä¾›ï¼‰ã€‚å®ƒçš„åŠŸèƒ½æ˜¯åœ¨æŒ‡å®šçš„èŒƒå›´é‡Œï¼Œä½¿ç”¨ç»™å®šçš„åˆå€¼å’Œå‡½æ•°å¯¹è±¡ï¼Œä»å·¦åˆ°å³å¯¹æ•°å€¼è¿›è¡Œå½’å¹¶ã€‚åœ¨ä¸æä¾›å‡½æ•°å¯¹è±¡ä½œä¸ºç¬¬å››ä¸ªå‚æ•°æ—¶ï¼ŒåŠŸèƒ½ä¸Šç›¸å½“äºé»˜è®¤æä¾›äº†åŠ æ³•å‡½æ•°å¯¹è±¡ï¼Œè¿™æ—¶ç›¸å½“äºåšç´¯åŠ ï¼›æä¾›äº†å…¶ä»–å‡½æ•°å¯¹è±¡æ—¶ï¼Œé‚£å½“ç„¶å°±æ˜¯ä½¿ç”¨è¯¥å‡½æ•°å¯¹è±¡è¿›è¡Œå½’å¹¶äº†ã€‚</p><p>Filter çš„åŠŸèƒ½æ˜¯è¿›è¡Œè¿‡æ»¤ï¼Œç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æˆå‘˜ã€‚å®ƒåœ¨å½“å‰ C++ï¼ˆC++20 ä¹‹å‰ï¼‰é‡Œçš„æ˜ å°„å¯ä»¥è®¤ä¸ºæœ‰ä¸¤ä¸ªï¼š<code>copy_if</code> å’Œ <code>partition</code>ã€‚è¿™æ˜¯å› ä¸ºåœ¨ C++20 å¸¦æ¥ ranges ä¹‹å‰ï¼Œåœ¨ C++ é‡Œå®ç°æƒ°æ€§æ±‚å€¼ä¸å¤ªæ–¹ä¾¿ã€‚ä¸Šé¢è¯´çš„ä¸¤ä¸ªå‡½æ•°é‡Œï¼Œ<code>copy_if</code> æ˜¯æŠŠæ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªè¿­ä»£å™¨é‡Œï¼›<code>partition</code> åˆ™æ˜¯æ ¹æ®è¿‡æ»¤æ¡ä»¶æ¥å¯¹èŒƒå›´é‡Œçš„å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼ŒæŠŠæ»¡è¶³æ¡ä»¶çš„æ”¾åœ¨è¿”å›å€¼è¿­ä»£å™¨çš„å‰é¢ã€‚å¦å¤–ï¼Œ<code>remove_if</code> ä¹Ÿæœ‰ç‚¹ç›¸è¿‘ï¼Œé€šå¸¸ç”¨äºåˆ é™¤æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚å®ƒç¡®ä¿æŠŠä¸æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ”¾åœ¨è¿”å›å€¼è¿­ä»£å™¨çš„å‰é¢ï¼ˆä½†ä¸ä¿è¯æ»¡è¶³æ¡ä»¶çš„å…ƒç´ åœ¨å‡½æ•°è¿”å›åä¸€å®šå­˜åœ¨ï¼‰ï¼Œç„¶åä½ ä¸€èˆ¬éœ€è¦ä½¿ç”¨å®¹å™¨çš„ <code>erase</code> æˆå‘˜å‡½æ•°æ¥å°†å¾…åˆ é™¤çš„å…ƒç´ çœŸæ­£åˆ é™¤ã€‚</p><h3>å‘½ä»¤å¼ç¼–ç¨‹å’Œè¯´æ˜å¼ç¼–ç¨‹</h3><p>ä¼ ç»Ÿä¸Š C++ å±äºå‘½ä»¤å¼ç¼–ç¨‹ã€‚å‘½ä»¤å¼ç¼–ç¨‹é‡Œï¼Œä»£ç ä¼šæè¿°ç¨‹åºçš„å…·ä½“æ‰§è¡Œæ­¥éª¤ã€‚å¥½å¤„æ˜¯ä»£ç æ˜¾å¾—æ¯”è¾ƒç›´æˆªäº†å½“ï¼›ç¼ºç‚¹å°±æ˜¯å®¹æ˜“è®©äººåªè§æ ‘æœ¨ã€ä¸è§æ£®æ—ï¼Œåªèƒ½çœ‹åˆ°ä»£ç å•°å—¦åœ°æ€ä¹ˆåšï¼ˆhowï¼‰ï¼Œè€Œä¸æ˜¯åšä»€ä¹ˆï¼ˆwhatï¼‰ï¼Œæ›´ä¸ç”¨è¯´ä¸ºä»€ä¹ˆï¼ˆwhyï¼‰äº†ã€‚</p><p>è¯´æ˜å¼ç¼–ç¨‹åˆ™ç›¸åã€‚ä»¥æ•°æ®åº“æŸ¥è¯¢è¯­è¨€ SQL ä¸ºä¾‹ï¼ŒSQL æè¿°çš„æ˜¯ç±»ä¼¼äºä¸‹é¢çš„æ“ä½œï¼šä½ æƒ³ä»ä»€ä¹ˆåœ°æ–¹ï¼ˆfromï¼‰é€‰æ‹©ï¼ˆselectï¼‰æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼ˆwhereï¼‰çš„ä»€ä¹ˆæ•°æ®ï¼Œå¹¶å¯é€‰æŒ‡å®šæ’åºï¼ˆorder byï¼‰æˆ–åˆ†ç»„ï¼ˆgroup byï¼‰æ¡ä»¶ã€‚ä½ ä¸éœ€è¦å‘Šè¯‰æ•°æ®åº“å¼•æ“å…·ä½“è¯¥å¦‚ä½•å»æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚äº‹å®ä¸Šï¼Œåœ¨é€‰æ‹©æŸ¥è¯¢ç­–ç•¥ä¸Šï¼Œå¤§éƒ¨åˆ†æ•°æ®åº“ç”¨æˆ·éƒ½ä¸åŠæ•°æ®åº“å¼•æ“â€œèªæ˜â€ï¼›æ­£å¦‚å¤§éƒ¨åˆ†å¼€å‘è€…åœ¨å†™å‡ºä¼˜åŒ–æ±‡ç¼–ä»£ç ä¸Šä¹Ÿä¸åŠç¼–è¯‘å™¨èªæ˜ä¸€æ ·ã€‚</p><p>è¿™å¹¶ä¸æ˜¯è¯´è¯´æ˜å¼ç¼–ç¨‹ä¸€å®šå°±ä¼˜äºå‘½ä»¤å¼ç¼–ç¨‹ã€‚äº‹å®ä¸Šï¼Œå¯¹äºå¾ˆå¤šç®—æ³•ï¼Œå‘½ä»¤å¼æ‰æ˜¯æœ€è‡ªç„¶çš„å®ç°ã€‚ä»¥å¿«é€Ÿæ’åºä¸ºä¾‹ï¼Œå¾ˆå¤šåœ°æ–¹åœ¨è®²åˆ°å‡½æ•°å¼ç¼–ç¨‹æ—¶ä¼šç»™å‡ºä¸‹é¢è¿™ä¸ª Haskellï¼ˆä¸€ç§çº¯å‡½æ•°å¼çš„ç¼–ç¨‹è¯­è¨€ï¼‰çš„ä¾‹å­æ¥è¯´æ˜å‡½æ•°å¼ç¼–ç¨‹çš„ç®€æ´æ€§ï¼š</p><pre><code class=\"language-haskell\">quicksort []     = []\nquicksort (p:xs) = (quicksort left)\n         ++ [p] ++ (quicksort right)\n  where\n    left  = filter (&lt; p) xs\n    right = filter (&gt;= p) xs\n</code></pre><p>è¿™æ®µä»£ç ç®€æ´æ€§ç¡®å®æ²¡è¯è¯´ï¼Œä½†é—®é¢˜æ˜¯ï¼Œä¸Šé¢çš„ä»£ç çš„æ€§èƒ½å…¶å®éå¸¸ç³Ÿç³•ã€‚çœŸæ­£æ¥è¿‘ C++ æ€§èƒ½çš„å¿«é€Ÿæ’åºï¼Œåœ¨ Haskell é‡Œå†™å‡ºæ¥ä¸€ç‚¹ä¸ä¼˜é›…ï¼Œåè€Œæ›´ä¸‘é™‹ <span class=\"orange\">[4]</span>ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºï¼Œè¯´æ˜å¼ç¼–ç¨‹è·Ÿå‘½ä»¤å¼ç¼–ç¨‹å¯ä»¥ç»“åˆèµ·æ¥äº§ç”Ÿæ—¢ä¼˜é›…åˆé«˜æ•ˆçš„ä»£ç ã€‚å¯¹äºä»å‘½ä»¤å¼ç¼–ç¨‹æˆé•¿èµ·æ¥çš„å¤§éƒ¨åˆ†ç¨‹åºå‘˜ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p><ul>\n<li>å†™è¡¨æ„çš„ä»£ç ï¼Œä¸è¦è¿‡äºä¸“æ³¨æ€§èƒ½è€Œè®©ä»£ç éš¾ä»¥ç»´æŠ¤â€”â€”è®°ä½é«˜å¾·çº³çš„åè¨€ï¼šâ€œè¿‡æ—©ä¼˜åŒ–æ˜¯ä¸‡æ¶ä¹‹æºã€‚â€</li>\n<li>ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡ï¼Œä½†å°½é‡ä¸è¦å»ä¿®æ”¹å˜é‡å†…å®¹â€”â€”å˜é‡çš„ä¿®æ”¹éå¸¸å®¹æ˜“å¯¼è‡´ç¨‹åºå‘˜çš„æ€ç»´é”™è¯¯ã€‚</li>\n<li>ç±»ä¼¼åœ°ï¼Œå°½é‡ä½¿ç”¨æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œå¹¶è®©ä½ å†™çš„ä»£ç ä¹Ÿå°½é‡æ²¡æœ‰å‰¯ä½œç”¨ï¼Œç”¨è¿”å›å€¼æ¥ä»£è¡¨çŠ¶æ€çš„å˜åŒ–â€”â€”æ²¡æœ‰å‰¯ä½œç”¨çš„ä»£ç æ›´å®¹æ˜“æ¨ç†ï¼Œæ›´ä¸å®¹æ˜“å‡ºé”™ã€‚</li>\n<li>ä»£ç çš„éšå¼ä¾èµ–è¶Šå°‘è¶Šå¥½ï¼Œå°¤å…¶æ˜¯ä¸è¦ä½¿ç”¨å…¨å±€å˜é‡â€”â€”éšå¼ä¾èµ–ä¼šè®©ä»£ç é‡Œçš„é”™è¯¯éš¾ä»¥æ’æŸ¥ï¼Œä¹Ÿä¼šè®©ä»£ç æ›´éš¾ä»¥æµ‹è¯•ã€‚</li>\n<li>ä½¿ç”¨çŸ¥åçš„é«˜çº§ç¼–ç¨‹ç»“æ„ï¼Œå¦‚åŸºäºèŒƒå›´çš„ for å¾ªç¯ã€æ˜ å°„ã€å½’å¹¶ã€è¿‡æ»¤â€”â€”è¿™å¯ä»¥è®©ä½ çš„ä»£ç æ›´ç®€æ´ï¼Œæ›´æ˜“äºæ¨ç†ï¼Œå¹¶å‡å°‘ç±»ä¼¼ä¸‹æ ‡è¶Šç•Œè¿™ç§ä½çº§é”™è¯¯çš„å¯èƒ½æ€§ã€‚</li>\n</ul><p>è¿™äº›è·Ÿå‡½æ•°å¼ç¼–ç¨‹æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿâ€”â€”è¿™äº›å·®ä¸å¤šéƒ½æ˜¯æ¥è‡ªå‡½æ•°å¼ç¼–ç¨‹çš„æœ€ä½³å®è·µã€‚å­¦ä¹ å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¹Ÿæ˜¯ä¸ºäº†æ›´å¥½åœ°ä½“ä¼šå¦‚ä½•ä»è¿™äº›åœ°æ–¹å…¥æ‰‹ï¼Œå†™å‡ºæ˜“è¯»è€Œåˆé«˜æ€§èƒ½çš„ä»£ç ã€‚</p><h3>ä¸å¯å˜æ€§å’Œå¹¶å‘</h3><p>åœ¨å¤šæ ¸çš„æ—¶ä»£é‡Œï¼Œå‡½æ•°å¼ç¼–ç¨‹æ¯”ä»¥å‰æ›´å—é’çï¼Œä¸€ä¸ªé‡è¦çš„åŸå› æ˜¯å‡½æ•°å¼ç¼–ç¨‹å¯¹å¹¶è¡Œå¹¶å‘å¤©ç„¶å‹å¥½ã€‚å½±å“å¤šæ ¸æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯æ•°æ®çš„ç«äº‰æ¡ä»¶â€”â€”ç”±äºå…±äº«å†…å­˜æ•°æ®éœ€è¦åŠ é”å¸¦æ¥çš„å»¶è¿Ÿã€‚å‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒä¸å¯å˜æ€§ï¼ˆimmutabilityï¼‰ã€æ— å‰¯ä½œç”¨ï¼Œå¤©ç„¶å°±é€‚åˆå¹¶å‘ã€‚æ›´å¦™çš„æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨é«˜å±‚æŠ½è±¡çš„è¯ï¼Œæœ‰æ—¶å¯ä»¥è½»è½»æ¾æ¾â€œå…è´¹â€å¾—åˆ°æ€§èƒ½æå‡ã€‚</p><p>æ‹¿æˆ‘ä»¬è¿™ä¸€è®²å¼€å¤´çš„ä¾‹å­æ¥è¯´ï¼Œå¯¹ä»£ç åšä¸‹é¢çš„æ”¹é€ ï¼Œå¯ç”¨ C++17 çš„å¹¶è¡Œæ‰§è¡Œç­–ç•¥ <span class=\"orange\">[5]</span>ï¼Œå°±èƒ½è‡ªåŠ¨è·å¾—åœ¨å¤šæ ¸ç¯å¢ƒä¸‹çš„æ€§èƒ½æå‡ï¼š</p><pre><code class=\"language-c++\">int count_lines(const char** begin,\n                const char** end)\n{\n  vector&lt;int&gt; count(end - begin);\n  transform(execution::par,\n            begin, end,\n            count.begin(),\n            count_file);\n  return reduce(\n    execution::par,\n    count.begin(), count.end());\n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªé«˜é˜¶å‡½æ•°çš„è°ƒç”¨ä¸­éƒ½åŠ å…¥äº† <code>execution::par</code>ï¼Œæ¥å¯åŠ¨è‡ªåŠ¨å¹¶è¡Œè®¡ç®—ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘æŠŠ <code>accumulate</code> æ¢æˆäº† <code>reduce</code> <span class=\"orange\">[6]</span>ï¼ŒåŸå› æ˜¯å‰è€…å·²ç»å®šä¹‰æˆä»å·¦åˆ°å³çš„å½’å¹¶ï¼Œæ— æ³•å¹¶è¡Œã€‚<code>reduce</code> åˆ™ä¸åŒï¼Œåˆå§‹å€¼å¯ä»¥çœç•¥ï¼Œæ“ä½œä¸Šæ²¡æœ‰è§„å®šé¡ºåºï¼Œå¹¶åè¿‡æ¥è¦æ±‚å¯¹å…ƒç´ çš„å½’å¹¶æ“ä½œæ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆç‡ï¼ˆåŠ æ³•å½“ç„¶æ˜¯æ»¡è¶³çš„ï¼‰ï¼Œå³ï¼š</p><p>$$<br>\n\\begin{aligned}<br>\nA\\ \\otimes\\ B &amp;= B\\ \\otimes\\ A\\\\\\<br>\n(A\\ \\otimes\\ B)\\ \\otimes\\ C &amp;= A\\ \\otimes\\ (B\\ \\otimes\\ C)<br>\n\\end{aligned}<br>\n$$</p><p>å½“ç„¶ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šæœ‰æµ·é‡æ–‡ä»¶ï¼Œå³ä½¿æœ‰æµ·é‡æ–‡ä»¶ï¼Œå¹¶è¡Œè¯»å–æ€§èƒ½ä¸€èˆ¬ä¹Ÿä¸ä¼šå¿«äºé¡ºåºè¯»å–ï¼Œæ‰€ä»¥æ„ä¹‰å¹¶ä¸æ˜¯å¾ˆå¤§ã€‚ä¸‹é¢è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†å¹¶è¡Œ <code>reduce</code> çš„å¨åŠ›ï¼š</p><pre><code class=\"language-c++\">#include &lt;chrono&gt;\n#include &lt;execution&gt;\n#include &lt;iostream&gt;\n#include &lt;numeric&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nint main()\n{\n  vector&lt;double&gt; v(10000000, 0.0625);\n\n  {\n    auto t1 = chrono::\n      high_resolution_clock::now();\n    double result = accumulate(\n      v.begin(), v.end(), 0.0);\n    auto t2 = chrono::\n      high_resolution_clock::now();\n    chrono::duration&lt;double, milli&gt;\n      ms = t2 - t1;\n    cout &lt;&lt; \"accumulate: result \"\n         &lt;&lt; result &lt;&lt; \" took \"\n         &lt;&lt; ms.count() &lt;&lt; \" ms\\n\";\n  }\n\n  {\n    auto t1 = chrono::\n      high_resolution_clock::now();\n    double result =\n      reduce(execution::par,\n             v.begin(), v.end());\n    auto t2 = chrono::\n      high_resolution_clock::now();\n    chrono::duration&lt;double, milli&gt;\n      ms = t2 - t1;\n    cout &lt;&lt; \"reduce:     result \"\n         &lt;&lt; result &lt;&lt; \" took \"\n         &lt;&lt; ms.count() &lt;&lt; \" ms\\n\";\n  }\n}\n</code></pre><p>åœ¨æˆ‘çš„ç”µè„‘ï¼ˆCore i7 å››æ ¸å…«çº¿ç¨‹ï¼‰ä¸Šçš„æŸæ¬¡æ‰§è¡Œç»“æœæ˜¯ï¼š</p><blockquote>\n<p><code>accumulate: result 625000 took 26.122 ms</code><br>\n<code>reduce: result 625000 took 4.485 ms</code></p>\n</blockquote><p>æ‰§è¡Œç­–ç•¥è¿˜æ¯”è¾ƒæ–°ï¼Œè¿˜æ²¡æœ‰è¢«æ‰€æœ‰ç¼–è¯‘å™¨æ”¯æŒã€‚æˆ‘ç›®å‰æµ‹è¯•ä¸‹æ¥ï¼ŒMSVC æ²¡æœ‰é—®é¢˜ï¼ŒClang ä¸è¡Œï¼ŒGCC éœ€è¦å¤–éƒ¨åº“ TBBï¼ˆThreading Building Blocksï¼‰<span class=\"orange\">[7]</span> çš„å¸®åŠ©ã€‚æˆ‘ä¸Šé¢æ˜¯ç”¨ GCC ç¼–è¯‘çš„ï¼Œå‘½ä»¤è¡Œæ˜¯ï¼š</p><blockquote>\n<p><code>g++-9 -std=c++17 -O3 test.cpp -ltbb</code></p>\n</blockquote><h2>Y ç»„åˆå­</h2><p>é™äºç¯‡å¹…ï¼Œè¿™ä¸€è®²æˆ‘ä»¬åªæ˜¯å¾ˆåˆæµ…åœ°æ¢è®¨äº†å‡½æ•°å¼ç¼–ç¨‹ã€‚å¯¹äº C++ çš„å‡½æ•°å¼ç¼–ç¨‹çš„æ·±å…¥æ¢è®¨æ˜¯æœ‰æ•´æœ¬ä¹¦çš„ï¼ˆè§å‚è€ƒèµ„æ–™ <span class=\"orange\">[8]</span>ï¼‰ï¼Œè€Œä»Šå¤©è®²çš„å†…å®¹åœ¨ä¹¦çš„æœ€å‰é¢å‡ ç« å°±è¦†ç›–å®Œäº†ã€‚åœ¨åé¢ï¼Œæˆ‘ä»¬è¿˜ä¼šæ¢è®¨éƒ¨åˆ†çš„å‡½æ•°å¼ç¼–ç¨‹è¯é¢˜ï¼›ä»Šå¤©æˆ‘ä»¬åªå†è®¨è®ºä¸€ä¸ªæœ‰ç‚¹æœ‰è¶£ã€ä¹Ÿæœ‰ç‚¹çƒ§è„‘çš„è¯é¢˜ï¼ŒY ç»„åˆå­ <span class=\"orange\">[9]</span>ã€‚ç¬¬ä¸€æ¬¡é˜…è¯»çš„æ—¶å€™ï¼Œå¦‚æœè§‰å¾—å›°éš¾ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘å¹¶ä¸æ‰“ç®—è®¨è®º Haskell Curry ä½¿ç”¨çš„ Y ç»„åˆå­å®šä¹‰â€”â€”è¿™ä¸ªæ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å†™ä¸€ç¯‡å®Œæ•´çš„æ–‡ç« æ¥è®¨è®ºï¼ˆ<span class=\"orange\">[10]</span>ï¼‰ï¼Œè€Œä¸”åœ¨ C++ ä¸­çš„å®ç”¨æ€§éå¸¸å¼±ã€‚æˆ‘ä»¬åªçœ‹å®ƒè§£å†³çš„é—®é¢˜ï¼šå¦‚ä½•åœ¨ lambda è¡¨è¾¾å¼ä¸­è¡¨ç°é€’å½’ã€‚</p><p>å›æƒ³ä¸€ä¸‹æˆ‘ä»¬ç”¨è¿‡çš„é˜¶ä¹˜çš„é€’å½’å®šä¹‰ï¼š</p><pre><code class=\"language-c++\">int factorial(int n)\n{\n  if (n == 0) {\n    return 1;\n  } else {\n    return n * factorial(n - 1);\n  }\n}\n</code></pre><p>æ³¨æ„é‡Œé¢ç”¨åˆ°äº†é€’å½’ï¼Œæ‰€ä»¥ä½ è¦æŠŠå®ƒå†™æˆ lambda è¡¨è¾¾å¼æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼š</p><pre><code class=\"language-c++\">auto factorial = [](int n) {\n  if (n == 0) {\n    return 1;\n  } else {\n    return n * ???(n - 1);\n  }\n}\n</code></pre><p>ä¸‹é¢æˆ‘ä»¬è®¨è®ºä½¿ç”¨ Y ç»„åˆå­çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„é«˜é˜¶å‡½æ•°ï¼Œå®šä¹‰ä¸ºï¼š</p><p>$$<br>\ny(f) = f(y(f))<br>\n$$</p><p>æ˜¾ç„¶ï¼Œè¿™ä¸ªå®šä¹‰æœ‰ç‚¹å¥‡æ€ªã€‚äº‹å®ä¸Šï¼Œå®ƒæ˜¯ä¼šå¯¼è‡´æ— é™å±•å¼€çš„â€”â€”è€Œå®ƒçš„å¨åŠ›ä¹Ÿåœ¨äºæ— é™å±•å¼€ã€‚æˆ‘ä»¬ä¹Ÿå› æ­¤å¿…é¡»ä½¿ç”¨æƒ°æ€§æ±‚å€¼çš„æ–¹å¼æ‰èƒ½ä½¿ç”¨è¿™ä¸ªå®šä¹‰ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰é˜¶ä¹˜ä¸ºï¼š</p><p>$$<br>\n\\mathrm{fact}(n) = \\mathrm{If\\ IsZero}(n)\\ \\mathrm{then}\\ 1\\ \\mathrm{else}\\ n \\times \\mathrm{fact}(n âˆ’ 1)<br>\n$$</p><p>å‡è®¾ $\\mathrm{fact}$ å¯ä»¥è¡¨ç¤ºæˆ $y(F)$ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åšä¸‹é¢çš„å˜å½¢ï¼š</p><p>$$<br>\n\\begin{aligned}<br>\ny(F)(n) &amp;= \\mathrm{If\\ IsZero}(n)\\ \\mathrm{then}\\ 1\\ \\mathrm{else}\\ n \\times y(F)(n âˆ’ 1)\\\\\\<br>\nF(y(F))(n) &amp;= \\mathrm{If\\ IsZero}(n)\\ \\mathrm{then}\\ 1\\ \\mathrm{else}\\ n \\times y(F)(n âˆ’ 1)<br>\n\\end{aligned}<br>\n$$</p><p>å†æŠŠ $y(F)$ æ›¿æ¢æˆ $f$ï¼Œæˆ‘ä»¬ä»ä¸Šé¢çš„ç¬¬äºŒä¸ªå¼å­å¾—åˆ°ï¼š</p><p>$$<br>\nF(f)(n) = \\mathrm{If\\ IsZero}(n)\\ \\mathrm{then}\\ 1\\ \\mathrm{else}\\ n \\times f(n âˆ’ 1)<br>\n$$</p><p>æˆ‘ä»¬å¾—åˆ°äº† $F$ çš„å®šä¹‰ï¼Œä¹Ÿå°±è‡ªç„¶å¾—åˆ°äº† $\\mathrm{fact}$ çš„å®šä¹‰ã€‚è€Œä¸”ï¼Œè¿™ä¸ªå®šä¹‰æ˜¯å¯ä»¥ç”¨ C++ è¡¨è¾¾å‡ºæ¥çš„ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç å®ç°ï¼š</p><pre><code class=\"language-c++\">#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n#include &lt;utility&gt;\n\nusing namespace std;\n\n// Y combinator as presented by Yegor Derevenets in P0200R0\n// &lt;url:http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0200r0.html&gt;\ntemplate &lt;class Fun&gt;\nclass y_combinator_result {\n  Fun fun_;\npublic:\n  template &lt;class T&gt;\n  explicit y_combinator_result(\n    T&amp;&amp; fun)\n    : fun_(std::forward&lt;T&gt;(fun))\n  {\n  }\n\n  template &lt;class... Args&gt;\n  decltype(auto)\n  operator()(Args&amp;&amp;... args)\n  {\n    // y(f) = f(y(f))\n    return fun_(\n      std::ref(*this),\n      std::forward&lt;Args&gt;(args)...);\n  }\n};\n\ntemplate &lt;class Fun&gt;\ndecltype(auto)\ny_combinator(Fun&amp;&amp; fun)\n{\n  return y_combinator_result&lt;\n    std::decay_t&lt;Fun&gt;&gt;(\n    std::forward&lt;Fun&gt;(fun));\n}\n\nint main()\n{\n  // ä¸Šé¢çš„é‚£ä¸ª F\n  auto almost_fact =\n    [](auto f, int n) -&gt; int {\n    if (n == 0)\n      return 1;\n    else\n      return n * f(n - 1);\n  };\n  // fact = y(F)\n  auto fact =\n    y_combinator(almost_fact);\n  cout &lt;&lt; fact(10) &lt;&lt; endl;\n}\n</code></pre><p>è¿™ä¸€èŠ‚ä¸å½±å“åé¢çš„å†…å®¹ï¼Œçœ‹ä¸æ‡‚çš„å¯ä»¥æš‚æ—¶ç•¥è¿‡ã€‚ğŸ˜</p><h2>å†…å®¹å°ç»“</h2><p>æœ¬è®²æˆ‘ä»¬å¯¹å‡½æ•°å¼ç¼–ç¨‹è¿›è¡Œäº†ä¸€ä¸ªå…¥é—¨å¼çš„ä»‹ç»ï¼Œå¸Œæœ›ä½ å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹ã€ä¼˜ç¼ºç‚¹æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£ã€‚ç„¶åï¼Œæˆ‘å¿«é€Ÿè®¨è®ºäº†ä¸€ä¸ªä¼šçƒ§è„‘çš„è¯é¢˜ï¼ŒY ç»„åˆå­ï¼Œè®©ä½ å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„å¨åŠ›å’Œéš¾åº¦ä¹Ÿæœ‰æ‰€äº†è§£ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>æƒ³ä¸€æƒ³ï¼Œä½ å¦‚ä½•å¯ä»¥å®ç°ä¸€ä¸ªæƒ°æ€§çš„è¿‡æ»¤å™¨ï¼Ÿä¸€ä¸ªæƒ°æ€§çš„è¿‡æ»¤å™¨åº”å½“è®©ä¸‹é¢çš„ä»£ç é€šè¿‡ç¼–è¯‘ï¼Œå¹¶ä¸”ä¸ä¼šå ç”¨è·Ÿæ•°æ®é›†å¤§å°ç›¸å…³çš„é¢å¤–ç©ºé—´ï¼š</p><pre><code class=\"language-c++\">#include &lt;iostream&gt;\n#include &lt;numeric&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\n// filter_view çš„å®šä¹‰\n\nint main()\n{\n  vector v{1, 2, 3, 4, 5};\n  auto&amp;&amp; fv = filter_view(\n    v.begin(), v.end(), [](int x) {\n      return x % 2 == 0;\n    });\n  cout &lt;&lt; accumulate(fv.begin(),\n                     fv.end(), 0)\n       &lt;&lt; endl;\n}\n</code></pre><p>ç»“æœè¾“å‡ºåº”è¯¥æ˜¯ <code>6</code>ã€‚</p><p><strong>æç¤ºï¼š</strong>å‚è€ƒ <code>istream_line_reader</code> çš„å®ç°ã€‚</p><p>å‘Šè¯‰æˆ‘ä½ æ˜¯å¦æˆåŠŸäº†ï¼Œæˆ–è€…ä½ é‡åˆ°äº†ä»€ä¹ˆæ ·çš„ç‰¹åˆ«å›°éš¾ã€‚</p><h2><span class=\"reference\">å‚è€ƒèµ„æ–™</span></h2><p><span class=\"reference\">[1] cppreference.com, â€œstd::transformâ€. <a href=\"https://en.cppreference.com/w/cpp/algorithm/transform\">https://en.cppreference.com/w/cpp/algorithm/transform</a> </span></p><p><span class=\"reference\">[1a] cppreference.com, â€œstd::transformâ€. <a href=\"https://zh.cppreference.com/w/cpp/algorithm/transform\">https://zh.cppreference.com/w/cpp/algorithm/transform</a> </span></p><p><span class=\"reference\">[2] cppreference.com, â€œstd::accumulateâ€. <a href=\"https://en.cppreference.com/w/cpp/algorithm/accumulate\">https://en.cppreference.com/w/cpp/algorithm/accumulate</a> </span></p><p><span class=\"reference\">[2a] cppreference.com, â€œstd::accumulateâ€. <a href=\"https://zh.cppreference.com/w/cpp/algorithm/accumulate\">https://zh.cppreference.com/w/cpp/algorithm/accumulate</a> </span></p><p><span class=\"reference\">[3] cppreference.com, â€œStandard library header &lt;algorithm&gt;â€. <a href=\"https://en.cppreference.com/w/cpp/header/algorithm\">https://en.cppreference.com/w/cpp/header/algorithm</a> </span></p><p><span class=\"reference\">[3a] cppreference.com, â€œæ ‡å‡†åº“å¤´æ–‡ä»¶ &lt;algorithm&gt;â€. <a href=\"https://zh.cppreference.com/w/cpp/header/algorithm\">https://zh.cppreference.com/w/cpp/header/algorithm</a> </span></p><p><span class=\"reference\">[4] è¢è‹±æ°, â€œImmutability: The Dark Sideâ€. <a href=\"https://www.jianshu.com/p/13cd4c650125\">https://www.jianshu.com/p/13cd4c650125</a> </span></p><p><span class=\"reference\">[5] cppreference.com, â€œStandard library header &lt;execution&gt;â€. <a href=\"https://en.cppreference.com/w/cpp/header/execution\">https://en.cppreference.com/w/cpp/header/execution</a> </span></p><p><span class=\"reference\">[5a] cppreference.com, â€œæ ‡å‡†åº“å¤´æ–‡ä»¶ &lt;execution&gt;â€. <a href=\"https://zh.cppreference.com/w/cpp/header/execution\">https://zh.cppreference.com/w/cpp/header/execution</a> </span></p><p><span class=\"reference\">[6] cppreference.com, â€œstd::reduceâ€. <a href=\"https://en.cppreference.com/w/cpp/algorithm/reduce\">https://en.cppreference.com/w/cpp/algorithm/reduce</a> </span></p><p><span class=\"reference\">[6a] cppreference.com, â€œstd::reduceâ€. <a href=\"https://zh.cppreference.com/w/cpp/algorithm/reduce\">https://zh.cppreference.com/w/cpp/algorithm/reduce</a> </span></p><p><span class=\"reference\">[7] Intel, tbb. <a href=\"https://github.com/intel/tbb\">https://github.com/intel/tbb</a> </span></p><p><span class=\"reference\">[8] Ivan ÄŒukiÄ‡, <em>Functional Programming in C++</em>. Manning, 2019, <a href=\"https://www.manning.com/books/functional-programming-in-c-plus-plus\">https://www.manning.com/books/functional-programming-in-c-plus-plus</a> </span></p><p><span class=\"reference\">[9] Wikipedia, â€œFixed-point combinatorâ€. <a href=\"https://en.wikipedia.org/wiki/Fixed-point_combinator\">https://en.wikipedia.org/wiki/Fixed-point_combinator</a> </span></p><p><span class=\"reference\">[10] å´å’ç‚œ, â€œ<em>Y</em> Combinator and C++â€. <a href=\"https://yongweiwu.wordpress.com/2014/12/14/y-combinator-and-cplusplus/\">https://yongweiwu.wordpress.com/2014/12/14/y-combinator-and-cplusplus/</a> </span></p>","neighbors":{"left":{"article_title":"16 | å‡½æ•°å¯¹è±¡å’Œlambdaï¼šè¿›å…¥å‡½æ•°å¼ç¼–ç¨‹","id":184018},"right":{"article_title":"18 | åº”ç”¨å¯å˜æ¨¡æ¿å’Œtupleçš„ç¼–è¯‘æœŸæŠ€å·§","id":185899}},"comments":[{"had_liked":false,"id":169547,"user_name":"ç‹å°å“","can_delete":false,"product_type":"c1","uid":1264741,"ip_address":"","ucode":"174F19F4040C92","user_header":"https://static001.geekbang.org/account/avatar/00/13/4c/65/1782ca15.jpg","comment_is_top":false,"comment_ctime":1578376827,"is_pvip":false,"replies":[{"id":"65787","content":"å“ˆå“ˆï¼Œæœ‰æ„æ€çš„æ¯”å–»ã€‚ä»¥å‰å­¦è¿‡å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578392348,"ip_address":"","comment_id":169547,"utype":1}],"discussion_count":2,"race_medal":0,"score":"190556937851","product_id":100040501,"comment_content":"Y-Combinatorè¢«ä½ è¯´é«˜æ·±äº†ã€‚é€’å½’å°±æ˜¯è‡ªå·±è°ƒç”¨è‡ªå·±ã€‚lamdaè¡¨è¾¾å¼æƒ³é€’å½’ï¼Œå›°éš¾åœ¨äºä¸çŸ¥é“è‡ªå·±çš„å‡½æ•°åï¼Œæ€ä¹ˆåŠï¼Ÿè°ƒç”¨ä¸äº†è‡ªå·±ï¼Œéš¾é“è¿˜è°ƒç”¨ä¸äº†åˆ«äººã€‚æ‰€ä»¥lamdaè¡¨è¾¾å¼è°ƒç”¨äº†Y-Combinatorå»é—´æ¥è°ƒç”¨è‡ªå·±ï¼Œè€ŒY-Combinatoråªä¸è¿‡ï¼šä¸€ï¼Œè®°å½•lamdaè¡¨è¾¾å¼ï¼›äºŒï¼Œè½¬è°ƒlamdaè¡¨è¾¾å¼ã€‚è¿™å°±å¥½æ¯”æ™®äº¬å—åˆ¶äºè¿ä»»æ—¶é—´é™åˆ¶ï¼Œå¦‚æœæƒ³ç»§ç»­è¿ä»»ï¼Œåˆ™æ‰¾ä¸ªä»£è¨€äººY-Combinatorç»§ä»»ã€‚ä»£è¨€äººçš„å”¯ä¸€ä½œç”¨å°±æ˜¯åˆ°æœŸä¼ ä½æ™®äº¬ã€‚","like_count":44,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480606,"discussion_content":"å“ˆå“ˆï¼Œæœ‰æ„æ€çš„æ¯”å–»ã€‚ä»¥å‰å­¦è¿‡å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578392348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1172090,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/7a/38a27e47.jpg","nickname":"è“¦ç„¶å›é¦–","note":"","ucode":"B17658DCFE6402","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345990,"discussion_content":"è¯´çš„çœŸæ˜¯å¤ªå¯¹äº†ï¼å“ˆå“ˆå“ˆï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611832427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168180,"user_name":"ç½— ä¹¾ æ—","can_delete":false,"product_type":"c1","uid":1188222,"ip_address":"","ucode":"D0406F95176ABA","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/7e/fb725950.jpg","comment_is_top":false,"comment_ctime":1578028251,"is_pvip":false,"replies":[{"id":"65332","content":"OKï¼Œæ²¡å•¥å¤§é—®é¢˜ã€‚<br><br>ä»£ç é£æ ¼è¦ç¨å¾®è¯´æ˜ä¸€ä¸‹ã€‚ä½ ä¼¼ä¹æ˜¯æ¨¡æ‹Ÿäº†åº“ä»£ç çš„é£æ ¼ï¼Œè¿™è¿˜æ˜¯æœ‰ç‚¹é£é™©çš„ã€‚åœ¨ä¸€èˆ¬çš„ç”¨æˆ·ä»£ç é‡Œï¼Œä¸åº”è¯¥å‡ºç°åŒä¸‹åˆ’çº¿æ‰“å¤´ã€æˆ–è€…ä¸‹åˆ’çº¿åŠ å¤§å†™å­—æ¯æ‰“å¤´çš„æ ‡è¯†ç¬¦â€”â€”è¿™æ˜¯ç»™ç³»ç»Ÿä¿ç•™çš„ã€‚<br><br>è¯¦è§ï¼š<br><br>https:&#47;&#47;zh.cppreference.com&#47;w&#47;cpp&#47;language&#47;identifiers","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578056220,"ip_address":"","comment_id":168180,"utype":1}],"discussion_count":4,"race_medal":0,"score":"23052864731","product_id":100040501,"comment_content":"å‚è€ƒ istream_line_reader å®ç°çš„ï¼Œæœ›è€å¸ˆæ–§æ­£<br><br>template&lt;typename _InIt, typename _Fun&gt;<br>class filter_view {<br>public:<br>\tclass iterator {  &#47;&#47;  å®ç°  InputIterator  <br>\tpublic:<br><br>\t\tusing iterator_category = input_iterator_tag;<br>\t\tusing value_type = typename _InIt::value_type;<br>\t\tusing difference_type = typename _InIt::difference_type;<br>\t\tusing pointer = typename _InIt::pointer;<br>\t\tusing reference = value_type&amp;;<br><br>\t\titerator(_InIt  _First, _InIt _Last, _Fun f)<br>\t\t\t:_First(_First), _Last(_Last), _fun(f) {<br>\t\t\t++(*this);<br>\t\t}<br><br>\t\treference operator*() const noexcept { return *_Cur; }<br>\t\t<br>\t\tpointer operator-&gt;() const noexcept { return &amp;(*_Cur); }<br><br>\t\titerator&amp; operator++() {<br>\t\t\twhile (_First != _Last &amp;&amp; !_fun(*_First)) {<br>\t\t\t\t_First++;<br>\t\t\t}<br>\t\t\t_Cur = _First;<br>\t\t\tif (_First != _Last) {<br>\t\t\t\t_First++;<br>\t\t\t}<br>\t\t\treturn *this;<br>\t\t}<br><br>\t\titerator operator++(int) {<br>\t\t\titerator temp(*this);<br>\t\t\t++(*this);<br>\t\t\treturn temp;<br>\t\t}<br><br>\t\tbool operator==(const iterator&amp; rhs)<br>\t\t\tconst noexcept<br>\t\t{<br>\t\t\treturn _Cur == rhs._Cur;<br>\t\t}<br>\t\tbool operator!=(const iterator&amp; rhs)<br>\t\t\tconst noexcept<br>\t\t{<br>\t\t\treturn !operator==(rhs);<br>\t\t}<br>\tprivate:<br>\t\t_InIt _First;<br>\t\t_InIt _Last;<br>\t\t_InIt _Cur;<br>\t\t_Fun _fun;<br><br>\t};<br><br>\tfilter_view(_InIt _First, _InIt _Last, _Fun f)<br>\t\t:_First(_First), _Last(_Last), _fun(f) {<br><br>\t}<br><br>\titerator begin() const noexcept {<br>\t\treturn iterator(_First, _Last, _fun);<br>\t}<br><br>\titerator end() const  noexcept {<br>\t\treturn iterator(_Last, _Last, _fun);<br>\t}<br>private:<br>\t_InIt _First;<br>\t_InIt _Last;<br>\t_Fun _fun;<br>};","like_count":5,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480163,"discussion_content":"OKï¼Œæ²¡å•¥å¤§é—®é¢˜ã€‚\n\nä»£ç é£æ ¼è¦ç¨å¾®è¯´æ˜ä¸€ä¸‹ã€‚ä½ ä¼¼ä¹æ˜¯æ¨¡æ‹Ÿäº†åº“ä»£ç çš„é£æ ¼ï¼Œè¿™è¿˜æ˜¯æœ‰ç‚¹é£é™©çš„ã€‚åœ¨ä¸€èˆ¬çš„ç”¨æˆ·ä»£ç é‡Œï¼Œä¸åº”è¯¥å‡ºç°åŒä¸‹åˆ’çº¿æ‰“å¤´ã€æˆ–è€…ä¸‹åˆ’çº¿åŠ å¤§å†™å­—æ¯æ‰“å¤´çš„æ ‡è¯†ç¬¦â€”â€”è¿™æ˜¯ç»™ç³»ç»Ÿä¿ç•™çš„ã€‚\n\nè¯¦è§ï¼š\n\nhttps://zh.cppreference.com/w/cpp/language/identifiers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578056220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2596026,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/2ibrq71Y5Ww3KDRibDxF1gt9YDEPuZkv4ITHEP1u4vvjpPDukkLoK4ngQy1hKKzccnsicLkUAda7sPpibR6Kyb0cfQ/132","nickname":"chang","note":"","ucode":"594EF8CB4477BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378400,"discussion_content":"è‹¥ç¬¬ä¸€ä¸ªå…ƒç´ åŒ¹é…ï¼Œä¼šè·³è¿‡ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623207319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1362403,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c9/e3/28c16afa.jpg","nickname":"ä¸‰å‘³","note":"","ucode":"A580F715D1CC96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":127000,"discussion_content":"è´´ä¸€ä¸‹æˆ‘çš„å®ç°,å®ç°ç›–æ¥¼ï¼š\n#include <iostream>\n#include <vector>\n\ntemplate <typename It, typename F>\nclass filter_view {\npublic:\n\n\tclass iterator {\n\tpublic:\n\t\tusing difference_type = ptrdiff_t;\n\t\tusing iterator_category = std::forward_iterator_tag;\n\t\tusing value_type = std::decay_t<decltype(*std::declval<It>())>;\n\t\tusing pointer = const value_type *;\n\t\tusing reference = const value_type&amp;;\n\n\n\t\texplicit iterator(It beg, It end, F f) \n\t\t\t: _itr(beg), _end(end), _f(f) {\n\t\t\twhile (_itr != _end &amp;&amp; !_f(*_itr))\n\t\t\t\t++_itr;\n\t\t}\n\n\t\tconst value_type&amp; operator*() const { return *_itr; }\n\n\t\tconst value_type* operator->() const { return &amp;(*_itr); }\n\n\t\t// ++iterator\n\t\titerator&amp; operator++() {\n\t\t\tassert(_itr != _end);\n\t\t\tnext();\n\t\t\treturn *this;\n\t\t}\n\n\t\t// iterator++\n\t\titerator operator++(int) {\n\t\t\tassert(_itr != _end);\n\t\t\titerator tmp = *this;\n\t\t\tnext();\n\t\t\treturn tmp;\n\t\t}\n\n\t\tbool operator==(const iterator&amp; rhs) const { return _itr == rhs._itr; }\n\n\t\tbool operator!=(const iterator&amp; rhs) const { return _itr != rhs._itr; }\n\n\tprivate:\n\t\tvoid next() {\n\t\t\t++_itr;\n\t\t\twhile (_itr != _end &amp;&amp; !_f(*_itr)) \n\t\t\t\t++_itr;\n\t\t}\n\n\t\tIt _itr;\n\t\tIt _end;\n\t\tF _f;\n\t};\n\n\texplicit filter_view(It beg, It end, F f) : _beg(beg, end, f), _end(end, end, f) {}\n\n\titerator begin() const { return _beg; }\n\n\titerator end() const { return _end; }\n\nprivate:\n\titerator _beg;\n\titerator _end;\n};\n\nint main()\n{\n\tstd::vector<int> v = {1,1,2,2,3,3,4,4,5,5}; \n\tfor (int i=0; i<v.size(); ++i) {\n\t\tfor (int j=i; j<v.size(); ++j) {\n\t\t\tauto beg = std::next(v.begin(), i);\n\t\t\tauto end = std::next(v.begin(), j);\n\t\t\tauto&amp;&amp; fv = filter_view(beg, end, [](int x) { return x%2 == 0; }); \n\t\t\tstd::cout << &#34;( &#34;;\n\t\t\tstd::copy(beg, end, std::ostream_iterator<int>(std::cout, &#34; &#34;));\n\t\t\tstd::cout << &#34;) => [ &#34;;\n\t\t\tstd::copy(fv.begin(), fv.end(), std::ostream_iterator<int>(std::cout, &#34; &#34;));\n\t\t\tstd::cout << &#3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578558212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188222,"avatar":"https://static001.geekbang.org/account/avatar/00/12/21/7e/fb725950.jpg","nickname":"ç½— ä¹¾ æ—","note":"","ucode":"D0406F95176ABA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":116319,"discussion_content":"æ”¶åˆ°ï¼Œæ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578059795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286146,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1015324,"ip_address":"","ucode":"2DF8932F07E24F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1617169228,"is_pvip":false,"replies":[{"id":"104028","content":"é¦–å…ˆï¼ŒæŒ‰ä½ ç›®å‰ä»£ç çš„å†™æ³•ï¼ˆévirtualæ–¹æ³•ï¼‰ï¼ŒæŠŠcreateå‡½æ•°çš„è¿”å›å€¼æ”¹æˆ Base å’Œ Derived æ˜¯å¯ä»¥å·¥ä½œçš„ã€‚å³ï¼Œå¦‚æœèƒ½åšåˆ°é™æ€å¤šæ€çš„è¯ï¼Œå„ä¸ªå‡½æ•°è¿”å›å®é™…ç±»å‹å³å¯ã€‚<br><br>å¯æ˜¯ï¼Œå¦‚æœæŒ‰ç…§ä¸€èˆ¬çš„åšæ³•ï¼ŒBase åŠ ä¸Šè™šææ„ï¼Œcreate æ ‡æˆ virtual çš„è¯ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚è™šå‡½æ•°å¿…é¡»è¿”å›åŒæ ·çš„ç±»å‹ï¼Œæˆ–è€…å¦‚æœæ˜¯æŒ‡é’ˆ&#47;å¼•ç”¨ç±»å‹çš„è¯ï¼ŒæŒ‰â€œåå˜â€çš„è¦æ±‚ï¼Œè¦†å†™çš„è™šå‡½æ•°è¿”å›çš„æŒ‡é’ˆ&#47;å¼•ç”¨æ˜¯è¢«è¦†å†™çš„è™šå‡½æ•°çš„è¿”å›ç±»å‹çš„å­ç±»ã€‚å› ä¸ºè™šå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨æ˜¯ä¸çŸ¥é“å®é™…è°ƒç”¨çš„æ˜¯å“ªä¸ªå‡½æ•°ï¼Œå¦‚æœè¿”å›éæŒ‡é’ˆ&#47;å¼•ç”¨çš„å­ç±»å¯¹è±¡çš„è¯ï¼Œç¼–è¯‘å™¨è¿æ€ä¹ˆæ‹·è´ã€ç§»åŠ¨è¿™ä¸ªå¯¹è±¡éƒ½ä¸çŸ¥é“äº†â€¦â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1617297025,"ip_address":"","comment_id":286146,"utype":1}],"discussion_count":6,"race_medal":0,"score":"10207103820","product_id":100040501,"comment_content":"å´è€å¸ˆï¼Œä¸ºä»€ä¹ˆc++ä¸èƒ½åœ¨è¿”å›å€¼ä¼˜åŒ–ï¼Œæ”¯æŒæŠŠrvalueé€šè¿‡moveæ„é€ ç»™ä¸€ä¸ªlvalueå¼•ç”¨ã€‚æˆ‘æƒ³å®ç°æ¨¡æ¿ä¸­çš„åå˜ï¼Œå‡½æ•°è¿”å›local variableï¼Œåªèƒ½é€šè¿‡å£°æ˜è¿”å›å€¼ç±»å‹ä¸ºå¼•ç”¨å’ŒæŒ‡é’ˆæ‰èƒ½åå˜æ”¯æŒè¿”å›å€¼å¤šæ€ã€‚æŠŠä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçŸ­çš„variableè‡ªåŠ¨moveç»™è¿”å›å€¼ä¸æ˜¯åº”è¯¥çš„å—ï¼Ÿè¿™ä¸ªåœºæ™¯åœ¨å·¥å‚åœºæ™¯ä¸‹åº”è¯¥å¾ˆå¸¸è§å§ã€‚<br>class Base{<br>}<br>class Derive : public Base {}<br><br>class Factory {<br> Bae &amp; create(){<br> return Base();<br>}<br>class SubFactory : public Factory{<br> Base &amp; create (){<br>    return Derive();<br>}<br>}<br>è¿™é‡Œçš„è¿”å›å€¼ç±»å‹ä¹Ÿæœ‰å¯èƒ½æ˜¯æ³›å‹å‚æ•°ï¼Œç°åœ¨çœ‹æ¥åªèƒ½ç”¨æ™ºèƒ½æŒ‡é’ˆåŒ…ä¸€å±‚ï¼Œé€šè¿‡moveæ„é€ è¿”å›ï¼Œè¿™çœ‹èµ·æ¥ä¸å¤ªæ–¹ä¾¿ã€‚<br>}","like_count":2,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517882,"discussion_content":"é¦–å…ˆï¼ŒæŒ‰ä½ ç›®å‰ä»£ç çš„å†™æ³•ï¼ˆévirtualæ–¹æ³•ï¼‰ï¼ŒæŠŠcreateå‡½æ•°çš„è¿”å›å€¼æ”¹æˆ Base å’Œ Derived æ˜¯å¯ä»¥å·¥ä½œçš„ã€‚å³ï¼Œå¦‚æœèƒ½åšåˆ°é™æ€å¤šæ€çš„è¯ï¼Œå„ä¸ªå‡½æ•°è¿”å›å®é™…ç±»å‹å³å¯ã€‚\n\nå¯æ˜¯ï¼Œå¦‚æœæŒ‰ç…§ä¸€èˆ¬çš„åšæ³•ï¼ŒBase åŠ ä¸Šè™šææ„ï¼Œcreate æ ‡æˆ virtual çš„è¯ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚è™šå‡½æ•°å¿…é¡»è¿”å›åŒæ ·çš„ç±»å‹ï¼Œæˆ–è€…å¦‚æœæ˜¯æŒ‡é’ˆ/å¼•ç”¨ç±»å‹çš„è¯ï¼ŒæŒ‰â€œåå˜â€çš„è¦æ±‚ï¼Œè¦†å†™çš„è™šå‡½æ•°è¿”å›çš„æŒ‡é’ˆ/å¼•ç”¨æ˜¯è¢«è¦†å†™çš„è™šå‡½æ•°çš„è¿”å›ç±»å‹çš„å­ç±»ã€‚å› ä¸ºè™šå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨æ˜¯ä¸çŸ¥é“å®é™…è°ƒç”¨çš„æ˜¯å“ªä¸ªå‡½æ•°ï¼Œå¦‚æœè¿”å›éæŒ‡é’ˆ/å¼•ç”¨çš„å­ç±»å¯¹è±¡çš„è¯ï¼Œç¼–è¯‘å™¨è¿æ€ä¹ˆæ‹·è´ã€ç§»åŠ¨è¿™ä¸ªå¯¹è±¡éƒ½ä¸çŸ¥é“äº†â€¦â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617297025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364380,"discussion_content":"ä¸Šæ¬¡çš„å›ç­”è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæ²¡æœ‰æŠ“ä½è¦ç‚¹ã€‚æ›´æ–°äº†ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617460427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1015324,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","nickname":"Frank","note":"","ucode":"2DF8932F07E24F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":364734,"discussion_content":"è¿™é‡Œçš„å·¥å‚å‡½æ•°è¿”å›çš„æ˜¯å­ç±»çš„å¼•ç”¨ï¼Œä½†æ˜¯æŒ‰ç…§c++çš„è¯­ä¹‰ï¼Œå¼•ç”¨åªèƒ½æŒ‡å‘ä¸€ä¸ªå·¦å€¼æ‰èƒ½é•¿æœŸä½¿ç”¨ï¼Œå·¥å‚å‡½æ•°è¿”å›å¼•ç”¨ä¼šåœ¨è¿”å›æ—¶è¢«ææ„ï¼Œä¸æ”¯æŒå³å€¼çš„é‚£ç§è¿”å›å€¼ä¼˜åŒ–ç§»åŠ¨è¯­ä¹‰ã€‚è¿™æ ·è¦åšä¸€ä¸ªæŠ½è±¡åŒ–çš„å·¥å‚å‡½æ•°å°±ä¸å¤ªæ–¹ä¾¿ï¼Œæˆ‘å¸Œæœ›é¡¶å±‚æŠ½è±¡ä¸€ä¸ªæ¥å£ï¼Œè‡³äºè¿”å›ç±»å‹åº”è¯¥ç”±å­ç±»å†³å®šã€‚ä¸çŸ¥é“æ™ºèƒ½æŒ‡é’ˆèƒ½ä¸èƒ½æ”¯æŒåå˜ï¼Œå³è™šå‡½æ•°è¿”å›shared_ptr<Base>ï¼Œå­ç±»è¿”å›shared_pt r<Derived>ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617588645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":364380,"ip_address":""},"score":364734,"extra":""},{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1015324,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","nickname":"Frank","note":"","ucode":"2DF8932F07E24F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364942,"discussion_content":"\næˆ‘çŸ¥é“ä½ è¦åšå•¥å•Šã€‚å›ç­”çš„å¦ä¸€ä¸ªè§’åº¦å°±æ˜¯ï¼Œä»ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„è§’åº¦ï¼Œä½ åŸå…ˆè¯´çš„åšä¸åˆ°ã€‚\n\næ™ºèƒ½æŒ‡é’ˆåå˜ä»æ¥å£çš„è§’åº¦æ˜¯ä¸è¡Œçš„ã€‚ä½†å¦‚æœ B ç»§æ‰¿ A çš„è¯ï¼Œä½ å¯ä»¥æŠŠ shared_ptr<B> åœ¨ä¸€ä¸ªæ¥å£å£°æ˜ä¸º shared_ptr<A> çš„å‡½æ•°é‡Œè¿”å›ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617669488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":364734,"ip_address":""},"score":364942,"extra":""},{"author":{"id":1015324,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","nickname":"Frank","note":"","ucode":"2DF8932F07E24F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":365019,"discussion_content":"äº†è§£äº†ï¼Œè°¢è°¢å´è€å¸ˆã€‚çœ‹æ¥c++åšé«˜åº¦æŠ½è±¡çš„åå˜é€†å˜è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617686883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":364942,"ip_address":""},"score":365019,"extra":""}]}]},{"had_liked":false,"id":168059,"user_name":"æ³°ä¼¦å¢","can_delete":false,"product_type":"c1","uid":1141994,"ip_address":"","ucode":"FEA6B43C8D4FF9","user_header":"https://static001.geekbang.org/account/avatar/00/11/6c/ea/e03fec22.jpg","comment_is_top":false,"comment_ctime":1578009155,"is_pvip":true,"replies":[{"id":"65270","content":"map-reduce æ˜¯ä¸€ç§æ–¹æ³•ï¼Œå·²ç»æœ‰å¾ˆä¹…äº†ã€‚åœ¨ C++ é‡Œçš„ç›´æ¥å¯¹åº”æ˜¯ transform å’Œ accumulateã€‚TBB è§å‚è€ƒèµ„æ–™ [7]ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578015418,"ip_address":"","comment_id":168059,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10167943747","product_id":100040501,"comment_content":"è¯·é—®è€å¸ˆï¼Œmapå’Œreduce.é‚£æ˜¯æœ€æ–°çš„è¯­å¥å—ï¼Ÿè¿˜æ˜¯æœ‰ç¬¬ä¸‰æ–¹åº“ï¼Ÿé‚£ä¸ªTBBï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480123,"discussion_content":"map-reduce æ˜¯ä¸€ç§æ–¹æ³•ï¼Œå·²ç»æœ‰å¾ˆä¹…äº†ã€‚åœ¨ C++ é‡Œçš„ç›´æ¥å¯¹åº”æ˜¯ transform å’Œ accumulateã€‚TBB è§å‚è€ƒèµ„æ–™ [7]ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578015418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283940,"user_name":"geek","can_delete":false,"product_type":"c1","uid":2401422,"ip_address":"","ucode":"FF0845140D72A9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/NyFOEueITjaGLpakMEuWAqVQjo1uDIXlpDdpCxXGfaWiaXzibLQ3WgOFCe8D9FvCmyjsGT7jDsLUbkt8jt2aVs9g/132","comment_is_top":false,"comment_ctime":1615989156,"is_pvip":true,"replies":[{"id":"103111","content":"çœ‹ä¸€ä¸‹â€œåŠ é¤â€é‡Œæˆ‘çš„å‚è€ƒå®ç°å§ã€‚ä½ çš„è¿™ä¸ªé—®é¢˜è¿˜ä¸å°‘ã€‚ä¸å¤Ÿé€šç”¨ï¼Œè€Œä¸”å‰ç½®å’Œåç½®++çš„ç†è§£åäº†ï¼Œè¿”å›ç±»å‹ä¹Ÿä¸å¯¹â€”â€”å‰ç½®åº”è¿”å›å¼•ç”¨ï¼Œåç½®è¿”å›å¯¹è±¡ã€‚åç½®++çš„å‚æ•°æ˜¯å‡çš„ï¼Œæ°¸è¿œä¸éœ€è¦ä¼ é€’ï¼Œä¹Ÿä¸åº”è¯¥ç»™å‡ºåå­—ã€‚ä½ å†™ it++; æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨ it.operator++(int)ï¼ˆç¤ºæ„ï¼Œä¸æ˜¯åˆæ³•ä»£ç ï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1616154429,"ip_address":"","comment_id":283940,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5910956452","product_id":100040501,"comment_content":"è¯¾åæ€è€ƒçš„ä¸€ç§å®ç°ï¼Œè¯·è€å¸ˆæŒ‡æ­£ä¸€ä¸‹å…¶ä¸­å­˜åœ¨çš„é—®é¢˜ã€‚<br>template &lt;typename T = std::vector&lt;int&gt;&gt;<br>    class filter_view {<br>    public:<br>        filter_view(){}<br>        filter_view(typename T::iterator begin, typename T::iterator end, std::function&lt;bool(int)&gt; func):begin_(begin),end_(end),func_(func){}<br><br>        class iterator {<br>        public:<br>            iterator(typename T::iterator end):end_(end){}<br>            iterator(typename T::iterator begin, std::function&lt;bool(int)&gt; func):begin_(begin), func_(func) {}<br><br>            int operator*() {<br>                if (!func_(*begin_)) return 0;<br>                return *begin_;<br>            }<br><br>            int operator-&gt;() {<br>                if (!func_(*begin_)) return 0;<br>                return *begin_;<br>            }<br><br>            iterator operator++(int n) {<br>                ++begin_;<br>                return *this;<br>            }<br><br>            iterator operator++() {<br>                iterator t = *this;<br>                operator++(0);<br>                return t;<br>            }<br><br>            bool operator==(const iterator&amp; o) const {<br>                return begin_ == o.begin_;<br>            }<br><br>            bool operator!=(const iterator&amp; o) const {<br>                return !(begin_ == o.end_);<br>            }<br>        private:<br>            typename T::iterator begin_;<br>            typename T::iterator end_;<br>            std::function&lt;bool(int)&gt; func_;<br>        };<br><br>        iterator begin() {<br>            if (!func_) {<br>                throw std::logic_error(&quot;func_ is null&quot;);<br>            }<br>            return iterator(begin_,func_);<br>        }<br><br>        iterator end() {<br>            if (!func_) {<br>                throw std::logic_error(&quot;func_ is null&quot;);<br>            }<br>            return iterator(end_);<br>        }<br><br>    private:<br>        typename T::iterator begin_;<br>        typename T::iterator end_;<br>        std::function&lt;bool(int)&gt; func_;<br>    };","like_count":1,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517186,"discussion_content":"çœ‹ä¸€ä¸‹â€œåŠ é¤â€é‡Œæˆ‘çš„å‚è€ƒå®ç°å§ã€‚ä½ çš„è¿™ä¸ªé—®é¢˜è¿˜ä¸å°‘ã€‚ä¸å¤Ÿé€šç”¨ï¼Œè€Œä¸”å‰ç½®å’Œåç½®++çš„ç†è§£åäº†ï¼Œè¿”å›ç±»å‹ä¹Ÿä¸å¯¹â€”â€”å‰ç½®åº”è¿”å›å¼•ç”¨ï¼Œåç½®è¿”å›å¯¹è±¡ã€‚åç½®++çš„å‚æ•°æ˜¯å‡çš„ï¼Œæ°¸è¿œä¸éœ€è¦ä¼ é€’ï¼Œä¹Ÿä¸åº”è¯¥ç»™å‡ºåå­—ã€‚ä½ å†™ it++; æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨ it.operator++(int)ï¼ˆç¤ºæ„ï¼Œä¸æ˜¯åˆæ³•ä»£ç ï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616154429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2401422,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/NyFOEueITjaGLpakMEuWAqVQjo1uDIXlpDdpCxXGfaWiaXzibLQ3WgOFCe8D9FvCmyjsGT7jDsLUbkt8jt2aVs9g/132","nickname":"geek","note":"","ucode":"FF0845140D72A9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359269,"discussion_content":"å¥½çš„ï¼ŒğŸ˜…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616154583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316361,"user_name":"å¸¸æŒ¯å","can_delete":false,"product_type":"c1","uid":2062252,"ip_address":"","ucode":"D61B40E1CCEFD5","user_header":"","comment_is_top":false,"comment_ctime":1634286745,"is_pvip":false,"replies":[{"id":"114624","content":"å¯è¯»æ€§é—®é¢˜ï¼Œä»è€…è§ä»ï¼Œæ™ºè€…è§æ™ºã€‚æˆ‘ä¸è®¤ä¸ºå‡½æ•°å¼ç¼–ç¨‹ä¸€å®šæ›´ä¼˜è¶Šï¼Œä½†æœ‰äº›åœºæ™¯ï¼Œå‡½æ•°å¼å†™æ³•å°±æ˜¯æœ‰ä¼˜åŠ¿çš„ï¼ˆåè¿‡æ¥çš„åœºåˆå½“ç„¶ä¹Ÿæœ‰ï¼‰ã€‚C++çš„å¤šèŒƒå¼ï¼Œå°±æ˜¯å…è®¸ä½ åœ¨åŒä¸€ç¨‹åºé‡Œæ ¹æ®éœ€æ±‚è‡ªç”±ä½¿ç”¨ä¸åŒçš„èŒƒå¼ã€‚<br><br>è¯´å‡½æ•°å¼ç¼–ç¨‹ä»£ç ç®€æ´æ€§ä¸å¦‚ç›´æ¥å‘½ä»¤å¼ï¼Œæˆ‘æƒ³æˆ‘å¼€å¤´çš„ä¾‹å­å·²ç»å¯ä»¥åé©³è¿™ä¸ªè§‚ç‚¹äº†ã€‚å‡½æ•°å¼é£æ ¼é€šå¸¸ä»£ç è¿˜å®¹æ˜“é‡ç”¨ï¼Œè¿™ä¹Ÿæ˜¯ç‰¹ç‚¹ä¹‹ä¸€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1634380401,"ip_address":"","comment_id":316361,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634286745","product_id":100040501,"comment_content":"å‡½æ•°å¼ç¼–ç¨‹åœ¨å¹¶å‘åœºåˆä¸‹çš„ç¡®æœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯æ™®é€šåº”ç”¨ï¼Œæ¯”å¦‚é€’å½’ï¼Œå®ç°èµ·æ¥æ¯”å‘½ä»¤å¼å¤æ‚é‚£ä¹ˆå¤šï¼Œå¯è¯»æ€§æ›´å·®ï¼Œæ„ä¹‰ä½•åœ¨ã€‚è€Œä¸”å‡½æ•°å¼ç¼–ç¨‹çš„ä»£ç ç®€æ´æ€§ä¸å¦‚ç›´æ¥å‘½ä»¤å¼+æ³¨é‡Š","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528369,"discussion_content":"å¯è¯»æ€§é—®é¢˜ï¼Œä»è€…è§ä»ï¼Œæ™ºè€…è§æ™ºã€‚æˆ‘ä¸è®¤ä¸ºå‡½æ•°å¼ç¼–ç¨‹ä¸€å®šæ›´ä¼˜è¶Šï¼Œä½†æœ‰äº›åœºæ™¯ï¼Œå‡½æ•°å¼å†™æ³•å°±æ˜¯æœ‰ä¼˜åŠ¿çš„ï¼ˆåè¿‡æ¥çš„åœºåˆå½“ç„¶ä¹Ÿæœ‰ï¼‰ã€‚C++çš„å¤šèŒƒå¼ï¼Œå°±æ˜¯å…è®¸ä½ åœ¨åŒä¸€ç¨‹åºé‡Œæ ¹æ®éœ€æ±‚è‡ªç”±ä½¿ç”¨ä¸åŒçš„èŒƒå¼ã€‚\n\nè¯´å‡½æ•°å¼ç¼–ç¨‹ä»£ç ç®€æ´æ€§ä¸å¦‚ç›´æ¥å‘½ä»¤å¼ï¼Œæˆ‘æƒ³æˆ‘å¼€å¤´çš„ä¾‹å­å·²ç»å¯ä»¥åé©³è¿™ä¸ªè§‚ç‚¹äº†ã€‚å‡½æ•°å¼é£æ ¼é€šå¸¸ä»£ç è¿˜å®¹æ˜“é‡ç”¨ï¼Œè¿™ä¹Ÿæ˜¯ç‰¹ç‚¹ä¹‹ä¸€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634380401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296869,"user_name":"chang","can_delete":false,"product_type":"c1","uid":2596026,"ip_address":"","ucode":"594EF8CB4477BD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/2ibrq71Y5Ww3KDRibDxF1gt9YDEPuZkv4ITHEP1u4vvjpPDukkLoK4ngQy1hKKzccnsicLkUAda7sPpibR6Kyb0cfQ/132","comment_is_top":false,"comment_ctime":1623207186,"is_pvip":false,"replies":[{"id":"107984","content":"OKï¼Œæ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚<br><br>è¦å®Œå…¨æ»¡è¶³å°†æ¥çš„æ¦‚å¿µæ£€æŸ¥çš„è¯ï¼Œæœ€å¥½å†åŠ ä¸Šåç½® ++ å’Œ -&gt; çš„å®ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1623478844,"ip_address":"","comment_id":296869,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623207186","product_id":100040501,"comment_content":"æˆ‘ä¹Ÿè´´ä¸‹æˆ‘çš„å®ç°ï¼Œå‚è€ƒäº†å‰é¢ä¸€äº›åŒå­¦çš„ï¼Œæœ›è€å¸ˆæŒ‡æ­£ä¸è¶³ä¹‹å¤„ï¼š<br><br>template&lt;typename It, typename Comp&gt;<br>class filter_view {<br>public:<br>    class iterator {<br>    public:<br>        &#47;&#47;æ”¯æŒå†…ç½®æŒ‡é’ˆ<br>        using value_type = typename std::iterator_traits&lt;It&gt;::value_type;<br>        using difference_type = typename std::iterator_traits&lt;It&gt;::difference_type;<br>        using pointer = value_type*;<br>        using reference = value_type&amp;;<br>        using iterator_category = std::input_iterator_tag;<br><br>        iterator(It it, It e, Comp cmp) : it_(it), e_(e), cmp_(cmp) {<br>            skipNoMatch();<br>        }<br><br>        iterator&amp; operator++() {<br>            ++it_;<br>            skipNoMatch();<br>            return *this;<br>        }<br><br>        auto operator*() {<br>            return *it_;<br>        }<br><br>        bool operator==(const iterator &amp;rhs) const {<br>            return it_ == rhs.it_;<br>        }<br><br>        bool operator!=(const iterator &amp;rhs) const {<br>            return !(*this == rhs);<br>        }<br><br>    private:<br>        void skipNoMatch() {<br>            while (it_ != e_ &amp;&amp; !cmp_(*it_)) {<br>                ++it_;<br>            }<br>        }<br><br>    private:<br>        It it_;<br>        It e_;<br>        Comp cmp_;<br>    };<br><br>    filter_view(It b, It e, Comp cmp) : b_(b), e_(e), cmp_(cmp) {}<br><br>    iterator begin() const {<br>        return iterator(b_, e_, cmp_);<br>    }<br><br>    iterator end() const {<br>        return iterator(e_, e_, cmp_);<br>    }<br><br>private:<br>    It b_;<br>    It e_;<br>    Comp cmp_;<br>};","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521620,"discussion_content":"OKï¼Œæ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚\n\nè¦å®Œå…¨æ»¡è¶³å°†æ¥çš„æ¦‚å¿µæ£€æŸ¥çš„è¯ï¼Œæœ€å¥½å†åŠ ä¸Šåç½® ++ å’Œ -&amp;gt; çš„å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623478844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286931,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1015324,"ip_address":"","ucode":"2DF8932F07E24F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1617687112,"is_pvip":false,"replies":[{"id":"104253","content":"å¯¹ä¸èµ·ï¼Œæˆ‘ç›®å‰æ²¡æ—¶é—´çœ‹è¿™ä¹ˆå¤æ‚çš„ä»£ç ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1617801600,"ip_address":"","comment_id":286931,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617687112","product_id":100040501,"comment_content":"å´è€å¸ˆï¼Œæˆ‘é‡å†™äº†map-reduceé€»è¾‘(lazy evaluation)ï¼Œä½†æ˜¯ç›®å‰çš„flattenåŠŸèƒ½è¾“å‡ºæœ‰ç‚¹æ··ä¹±ï¼Œæˆ‘æš‚æ—¶æ²¡æ’æŸ¥å‡ºç»“æœã€‚èƒ½å¸®æˆ‘çœ‹ä¸‹å—ï¼Ÿhttps:&#47;&#47;github.com&#47;franklucky001&#47;fp-map-reduce&#47;blob&#47;master&#47;main.cpp","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518135,"discussion_content":"å¯¹ä¸èµ·ï¼Œæˆ‘ç›®å‰æ²¡æ—¶é—´çœ‹è¿™ä¹ˆå¤æ‚çš„ä»£ç ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617801600,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015324,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","nickname":"Frank","note":"","ucode":"2DF8932F07E24F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365755,"discussion_content":"å¥½å§ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617875955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286161,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1015324,"ip_address":"","ucode":"2DF8932F07E24F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/1c/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1617172845,"is_pvip":false,"replies":[{"id":"104029","content":"è¿™è·Ÿå‰é¢çš„é—®é¢˜æœ¬è´¨ä¸Šæ˜¯ä¸€å›äº‹å§ï¼Ÿæ‰€ä»¥ï¼Œä½ è¦ä¹ˆä½¿ç”¨é™æ€å¤šæ€ï¼Œè¿™æ ·æ‰€æœ‰çš„ç±»å‹å¿…é¡»èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶åˆ†æå‡ºæ¥ï¼›è¦ä¹ˆä½¿ç”¨åŠ¨æ€å¤šæ€ï¼Œå¿…é¡»æŠŠå¯¹è±¡æ”¾å †ä¸Šï¼Œå¹¶ä¸”å¯¹è±¡æœ‰è™šææ„å‡½æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1617297118,"ip_address":"","comment_id":286161,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617172845","product_id":100040501,"comment_content":"å´è€å¸ˆï¼Œ æˆ‘æƒ³å®ç°ç±»ä¼¼rustçš„lazy evaluationç‰¹å¾çš„map reduce,ä»£ç https:&#47;&#47;github.com&#47;franklucky001&#47;template_programming&#47;blob&#47;master&#47;collection&#47;iterator.hpp<br>ä½†æ˜¯æ¨¡æ¿ä¸­ï¼Œä¸æ–¹ä¾¿å®ç°åå˜ï¼Œå£°æ˜æˆå¼•ç”¨å±€éƒ¨å˜é‡ä¼šææ„ï¼Œbeginå’Œendè™šå‡½æ•°å¿…é¡»å£°æ˜æˆæ™ºèƒ½æŒ‡é’ˆæ‰èƒ½é€šè¿‡moveæ„é€ è¿”å›å±€éƒ¨å˜é‡,æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼ã€‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517889,"discussion_content":"è¿™è·Ÿå‰é¢çš„é—®é¢˜æœ¬è´¨ä¸Šæ˜¯ä¸€å›äº‹å§ï¼Ÿæ‰€ä»¥ï¼Œä½ è¦ä¹ˆä½¿ç”¨é™æ€å¤šæ€ï¼Œè¿™æ ·æ‰€æœ‰çš„ç±»å‹å¿…é¡»èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶åˆ†æå‡ºæ¥ï¼›è¦ä¹ˆä½¿ç”¨åŠ¨æ€å¤šæ€ï¼Œå¿…é¡»æŠŠå¯¹è±¡æ”¾å †ä¸Šï¼Œå¹¶ä¸”å¯¹è±¡æœ‰è™šææ„å‡½æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617297118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269659,"user_name":"Geek_845be1","can_delete":false,"product_type":"c1","uid":1644657,"ip_address":"","ucode":"2B83B62C9D9C5D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDH0RbXvDGVoyRtxs3kLmwSmibqqic4EYYwSH12KqsrrKgpGic7cZXfsicpDMShFTAIT6p3jTJ3ypKzg/132","comment_is_top":false,"comment_ctime":1608730261,"is_pvip":false,"replies":[{"id":"97794","content":"ä½¿ç”¨å¼•ç”¨è¦å°å¿ƒç”Ÿå‘½å‘¨æœŸé—®é¢˜â€¦â€¦åˆ°ä¸‹ä¸€ä¸ª } å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡å°±è¢«é”€æ¯äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1608768602,"ip_address":"","comment_id":269659,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1608730261","product_id":100040501,"comment_content":"ç”¨ std::function ä¿å­˜ lambdaï¼Œé€šè¿‡å¼•ç”¨æ•è·ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°äº†lambda é€’å½’ã€‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512348,"discussion_content":"ä½¿ç”¨å¼•ç”¨è¦å°å¿ƒç”Ÿå‘½å‘¨æœŸé—®é¢˜â€¦â€¦åˆ°ä¸‹ä¸€ä¸ª } å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡å°±è¢«é”€æ¯äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608768602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231103,"user_name":"zhengfan","can_delete":false,"product_type":"c1","uid":1020160,"ip_address":"","ucode":"B3AC0E10BF7A14","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/00/2007d2f3.jpg","comment_is_top":false,"comment_ctime":1593583298,"is_pvip":false,"replies":[{"id":"85390","content":"å°±æ˜¯ä¸ä¿®æ”¹å˜é‡çš„å†…å®¹ï¼Œå‰é¢ä¸€ç§å«ä¹‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1593650853,"ip_address":"","comment_id":231103,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593583298","product_id":100040501,"comment_content":"å´è€å¸ˆï¼Œæ‚¨å¥½ã€‚<br>æ­¤è®²å†…å®¹å’Œä¹‹å‰å†…å®¹æ¯”è¾ƒï¼Œé¢‡æœ‰äº›é“ä¸æœ¯çš„åˆ†åˆ«ã€‚<br>ä¸ªäººæ„Ÿè§‰å‡½æ•°å¼ç¼–ç¨‹å’ŒADTèŒƒå¼å¼ºè°ƒçš„isolationæœ‰å‡ ä»½ç¥ä¼¼ã€‚<br>æ‚¨åœ¨æ–‡ä¸­çš„å‡ æ¡å»ºè®®ï¼Œæˆ‘æœ‰äº›å›°æƒ‘åœ°æ–¹ï¼Œå‘æ‚¨è¯·æ•™ï¼š<br>ç¬¬äºŒæ¡å»ºè®®ï¼šâ€ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡ï¼Œä½†å°½é‡ä¸è¦å»ä¿®æ”¹å˜é‡å†…å®¹â€”â€”å˜é‡çš„ä¿®æ”¹éå¸¸å®¹æ˜“å¯¼è‡´ç¨‹åºå‘˜çš„æ€ç»´é”™è¯¯â€œï¼›è¯·é—®æ‚¨æŒ‡çš„æ˜¯æŠ½è±¡å±‚é¢ä¸Šâ€ä¸è¦æ”¹å˜å˜é‡çš„å«ä¹‰&#47;æ„ä¹‰â€œï¼Ÿäº¦æˆ–æ˜¯å…·ä½“å±‚é¢ä¸Šâ€ä¸è¦æ”¹å˜ä¼ å…¥å‚æ•°ä»¥åŠç¯å¢ƒå˜é‡çš„å†…å®¹â€œï¼Ÿä»ä¸Šä¸‹æ–‡æ¥çœ‹ä¼¼ä¹æ˜¯åè€…ï¼Œä½†è¿™æ ·ä¸€æ¥å¥½åƒå’Œç¬¬ä¸‰æ¡å»ºè®®æœ‰äº›é‡å¤äº†ã€‚<br>è¯·æ‚¨æŒ‡æ•™ï¼Œå¤šè°¢ã€‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500158,"discussion_content":"å°±æ˜¯ä¸ä¿®æ”¹å˜é‡çš„å†…å®¹ï¼Œå‰é¢ä¸€ç§å«ä¹‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593650853,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226207,"user_name":"æ˜“è½»å°˜","can_delete":false,"product_type":"c1","uid":1136684,"ip_address":"","ucode":"0D0CB9D6D45A70","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","comment_is_top":false,"comment_ctime":1591991574,"is_pvip":true,"replies":[{"id":"83359","content":"ä¸ä¸€æ ·çš„åšæ³•ï¼Œä¹ŸæŒºå¥½ã€‚<br><br>ä¸è¿‡ï¼Œå†èŠ±ç‚¹åŠ›æ°”ï¼Œæ˜¯å¯ä»¥å»æ‰å¯¹ std::function çš„ä½¿ç”¨çš„ã€‚è¿™å¯ä»¥æå‡æç‚¹æ•ˆç‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1592066393,"ip_address":"","comment_id":226207,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591991574","product_id":100040501,"comment_content":"æ²¡æœ‰çœ‹istream_line_readerå‰ï¼Œä¸ªäººçš„å®ç°ï¼Œæœ‰ç‚¹ä¸‘é™‹ï¼š<br><br>template&lt;typename InputIt, typename Pred&gt;<br>auto filter_view(InputIt a, InputIt b, Pred pred) {<br>    struct {<br>        InputIt _begin, _end;<br>        function&lt;bool(decltype(*_begin))&gt; _pred;<br>        struct iterator {<br>            InputIt _it, _end;<br>            function&lt;bool(decltype(*_it))&gt; _pred;<br>            iterator(InputIt it, InputIt e, decltype(_pred) p):_it(it), _end(e), _pred(p){}<br>            bool operator != (const iterator&amp; other) {return _it != other._it;}<br>            bool operator == (const iterator&amp; other) {return _it == other._it;}<br><br>            auto operator*() {return *_it;}<br>            auto operator-&gt;() {return &amp;(*_it);}<br><br>            iterator&amp; operator ++ () {<br>                do {<br>                    if(_it == _end) break;<br>                    ++ _it;<br>                    if(_it == _end || _pred(*_it)) break;<br>                } while(true);<br>                return *this;<br>            }<br>        };<br>        <br>        iterator begin() {<br>            while(_begin != _end &amp;&amp; !_pred(*_begin))<br>                ++ _begin;<br>            return iterator(_begin, _end, _pred);<br>        }<br>        iterator end() {<br>            return iterator(_end, _end, _pred);<br>        }<br>    } object;<br>    object._begin = a;<br>    object._end = b;<br>    object._pred = [pred](decltype(*a) x){return pred(x);};<br>    return object;<br>}","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498148,"discussion_content":"ä¸ä¸€æ ·çš„åšæ³•ï¼Œä¹ŸæŒºå¥½ã€‚\n\nä¸è¿‡ï¼Œå†èŠ±ç‚¹åŠ›æ°”ï¼Œæ˜¯å¯ä»¥å»æ‰å¯¹ std::function çš„ä½¿ç”¨çš„ã€‚è¿™å¯ä»¥æå‡æç‚¹æ•ˆç‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592066393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":177372,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1581379818,"is_pvip":false,"replies":[{"id":"68873","content":"å•Šï¼Œç°åœ¨æ˜¯å› ä¸ºæ‰‹æœºå±å¹•å¤ªå°â€¦â€¦ğŸ˜<br><br>è¯»åˆ°ç¬¬ 21 è®²ä½ å°±è‡ªç„¶æ˜ç™½äº†ã€‚å¯ä»¥å…ˆå»è¯»ä¸€ä¸‹ï¼Œé‚£è®²æ˜¯ç‹¬ç«‹çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1581398661,"ip_address":"","comment_id":177372,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1581379818","product_id":100040501,"comment_content":"è€å¸ˆï¼Œæˆ‘é—®ä¸‹ï¼Œæ–‡ç« ä¸­è¿”å›ç±»å‹éƒ½æ˜¯å•ç‹¬ä¸€è¡Œï¼Œä»¥å‰æ˜¯ç”µè„‘å±å¹•å¤ªå°å†™ä¸ä¸‹ï¼Œæ‰€ä»¥å¾ˆå¤šè€ä»£ç éƒ½è¿™ä¹ˆå†™ï¼Œç°åœ¨éš¾é“åˆé‡æ–°æµè¡Œè¿™ç§å†™æ³•äº†å—","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483404,"discussion_content":"å•Šï¼Œç°åœ¨æ˜¯å› ä¸ºæ‰‹æœºå±å¹•å¤ªå°â€¦â€¦ğŸ˜\n\nè¯»åˆ°ç¬¬ 21 è®²ä½ å°±è‡ªç„¶æ˜ç™½äº†ã€‚å¯ä»¥å…ˆå»è¯»ä¸€ä¸‹ï¼Œé‚£è®²æ˜¯ç‹¬ç«‹çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581398661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174710,"user_name":"å¾®é£æ¼‚è¿‡","can_delete":false,"product_type":"c1","uid":1509168,"ip_address":"","ucode":"4F3E37C1E2FFF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/JGPabHDickBjMJwVoJ7ZRGiaT21BibxvCJ9DR9Gvn3G1iazHQPTJQtkWwfFssYfGJsPahEB7sOnXScibkrsr4gx6LeA/132","comment_is_top":false,"comment_ctime":1580358320,"is_pvip":false,"replies":[{"id":"67936","content":"å“¦ï¼Œè¿™ä¸ªæ˜¯æˆ‘å†™çš„ï¼Œä¸æ˜¯æ ‡å‡†åº“é‡Œçš„ã€‚<br><br>æºä»£ç åœ¨ç¬¬ 7 è®²è®²è§£äº†ã€‚<br><br>https:&#47;&#47;github.com&#47;adah1972&#47;nvwa&#47;blob&#47;master&#47;nvwa&#47;istream_line_reader.h","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1580397644,"ip_address":"","comment_id":174710,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1580358320","product_id":100040501,"comment_content":"istream_line_reader çš„å®ç°åœ¨å“ªé‡Œæ‰¾ï¼Ÿcppreferenceé‡Œé¢æ²¡æœ‰æœåˆ°ã€‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482497,"discussion_content":"å“¦ï¼Œè¿™ä¸ªæ˜¯æˆ‘å†™çš„ï¼Œä¸æ˜¯æ ‡å‡†åº“é‡Œçš„ã€‚\n\næºä»£ç åœ¨ç¬¬ 7 è®²è®²è§£äº†ã€‚\n\nhttps://github.com/adah1972/nvwa/blob/master/nvwa/istream_line_reader.h","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580397644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1509168,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/JGPabHDickBjMJwVoJ7ZRGiaT21BibxvCJ9DR9Gvn3G1iazHQPTJQtkWwfFssYfGJsPahEB7sOnXScibkrsr4gx6LeA/132","nickname":"å¾®é£æ¼‚è¿‡","note":"","ucode":"4F3E37C1E2FFF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":156828,"discussion_content":"å¥½å§ï¼Œè°¢è°¢ã€‚æ–­æ–­ç»­ç»­çœ‹çš„ï¼Œå‰é¢çš„å¿«å¿˜äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580397982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170570,"user_name":"ä¸‰å‘³","can_delete":false,"product_type":"c1","uid":1362403,"ip_address":"","ucode":"A580F715D1CC96","user_header":"https://static001.geekbang.org/account/avatar/00/14/c9/e3/28c16afa.jpg","comment_is_top":false,"comment_ctime":1578634595,"is_pvip":false,"replies":[{"id":"66133","content":"æ€§èƒ½ã€‚ä¸ç”¨å¼•ç”¨ï¼Œå¯¹äºæ¯”è¾ƒé‡ï¼ˆæ¯”å¦‚ï¼Œæœ‰è¾ƒå¤šæŒ‰å€¼æ•è·ï¼‰çš„å‡½æ•°å¯¹è±¡ï¼Œæ‹·è´çš„å¼€é”€å°±æ¯”è¾ƒå¤§äº†ã€‚ç”¨ Fun&amp;&amp; å’Œ std::forwardï¼Œå°±æ˜¯è¦æŠŠæ‹·è´å°½å¯èƒ½è½¬å˜æˆç§»åŠ¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578667136,"ip_address":"","comment_id":170570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578634595","product_id":100040501,"comment_content":"å…³äºè¿™ä¸ªy_combinator, ä»£ç ä¸­æœ‰å¾ˆå¤šæˆ‘ä¸å¤ªç†è§£çš„ï¼š<br>1. ä¸ºä»€ä¹ˆlambdaå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’çš„æ—¶å€™ï¼Œéƒ½æ˜¯Fun&amp;&amp;ï¼Ÿæˆ‘å®é™…æµ‹è¯•ç›´æ¥ç”¨Funï¼Œå¯¹äºå½“å‰ä»£ç æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œç›´æ¥ç”¨Funä¸å¥½ä¹ˆï¼Ÿï¼›<br>2. å…³äºforwardï¼Œé¢˜ç›®ä¸­æ‰€æœ‰å¸¦æœ‰forwardçš„åœ°æ–¹ï¼Œæˆ‘éƒ½ç›´æ¥æ›¿æ¢ä¸ºä¸å¸¦forwardçš„æ–¹å¼ï¼Œç¼–è¯‘å’Œè¿è¡Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚è¿™é‡Œçš„forwardä½œç”¨ç©¶ç«Ÿæ˜¯æ€æ ·çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481019,"discussion_content":"æ€§èƒ½ã€‚ä¸ç”¨å¼•ç”¨ï¼Œå¯¹äºæ¯”è¾ƒé‡ï¼ˆæ¯”å¦‚ï¼Œæœ‰è¾ƒå¤šæŒ‰å€¼æ•è·ï¼‰çš„å‡½æ•°å¯¹è±¡ï¼Œæ‹·è´çš„å¼€é”€å°±æ¯”è¾ƒå¤§äº†ã€‚ç”¨ Fun&amp;amp;&amp;amp; å’Œ std::forwardï¼Œå°±æ˜¯è¦æŠŠæ‹·è´å°½å¯èƒ½è½¬å˜æˆç§»åŠ¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578667136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":170260,"user_name":"ä¸‰å‘³","can_delete":false,"product_type":"c1","uid":1362403,"ip_address":"","ucode":"A580F715D1CC96","user_header":"https://static001.geekbang.org/account/avatar/00/14/c9/e3/28c16afa.jpg","comment_is_top":false,"comment_ctime":1578558056,"is_pvip":false,"replies":[{"id":"66132","content":"åŠŸèƒ½çœ‹èµ·æ¥æ²¡å•¥é—®é¢˜ã€‚å—¯ï¼Œå¤ªé•¿ï¼Œæ‰€ä»¥è´´åˆ°åˆ«çš„ç•™è¨€ä¸‹å»äº†ï¼Œè¿˜æ˜¯æœ‰ç‚¹æ€ªæ€ªçš„ã€‚<br><br>è¿˜æ˜¯è¦æé†’ï¼Œåœ¨ä¸€èˆ¬çš„ç”¨æˆ·ä»£ç é‡Œï¼Œä¸åº”è¯¥å‡ºç°åŒä¸‹åˆ’çº¿æ‰“å¤´ã€æˆ–è€…ä¸‹åˆ’çº¿åŠ å¤§å†™å­—æ¯æ‰“å¤´çš„æ ‡è¯†ç¬¦â€”â€”è¿™æ˜¯ç»™ç³»ç»Ÿä¿ç•™çš„ã€‚<br><br>è¯¦è§ï¼š<br><br>https:&#47;&#47;zh.cppreference.com&#47;w&#47;cpp&#47;language&#47;identifiers","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578667018,"ip_address":"","comment_id":170260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578558056","product_id":100040501,"comment_content":"è¿™ä¸€èŠ‚æ˜¯æˆ‘è€—æ—¶æœ€é•¿çš„ä¸€èŠ‚ã€‚ã€‚å› ä¸ºæ¥å›ç¿»é˜…è¿­ä»£å™¨é‚£ä¸€èŠ‚ã€‚ã€‚<br>å†™äº†ä¸ªstd::copy(fv.begin(), fv.end(), std::ostream_iterator&lt;int&gt;(std::cout, &quot; &quot;)); ç»“æœç¼–è¯‘å¤±è´¥ã€‚ã€‚æŸ¥äº†åŠå¤©ã€‚ã€‚å› ä¸ºæ²¡å®šä¹‰pointerå’Œreferenceç±»å‹ã€‚ã€‚<br>è¿˜æœ‰å°±æ˜¯ï¼Œä¹‹å‰çš„ç« èŠ‚çœ‹å¾—ä¸ä»”ç»†ï¼Œçœ‹åˆ«äººç­”æ¡ˆè§‰å¾—å¥½å¥‡æ€ªï¼Œä¸ºä»€ä¹ˆä¸€ä¸Šæ¥è¦++(*this)ã€‚ã€‚åæ¥å¯¹æ¯”è‡ªå·±çš„å®ç°ï¼Œæˆ‘æ˜¯æŒ‰ç…§forward_iterator_tagæ¥å®šä¹‰çš„ï¼Œæ‰€ä»¥å†™æ³•æœ‰äº›ä¸åŒã€‚ä»£ç æ¯”è¾ƒé•¿ã€‚ã€‚æˆ‘è¿˜æ˜¯è´´ä¸€ä¸‹ï¼Œæ”¾åˆ°ç•™è¨€çš„ç•™è¨€ä¸­å§ï¼Œä¸ç„¶å¤ªé•¿äº†ã€‚è‡ªå·±æµ‹è¯•æ²¡å•¥é—®é¢˜ï¼Œä¸è¿‡ä¸ä¿è¯ã€‚ã€‚æ²¡é—®é¢˜ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480910,"discussion_content":"åŠŸèƒ½çœ‹èµ·æ¥æ²¡å•¥é—®é¢˜ã€‚å—¯ï¼Œå¤ªé•¿ï¼Œæ‰€ä»¥è´´åˆ°åˆ«çš„ç•™è¨€ä¸‹å»äº†ï¼Œè¿˜æ˜¯æœ‰ç‚¹æ€ªæ€ªçš„ã€‚\n\nè¿˜æ˜¯è¦æé†’ï¼Œåœ¨ä¸€èˆ¬çš„ç”¨æˆ·ä»£ç é‡Œï¼Œä¸åº”è¯¥å‡ºç°åŒä¸‹åˆ’çº¿æ‰“å¤´ã€æˆ–è€…ä¸‹åˆ’çº¿åŠ å¤§å†™å­—æ¯æ‰“å¤´çš„æ ‡è¯†ç¬¦â€”â€”è¿™æ˜¯ç»™ç³»ç»Ÿä¿ç•™çš„ã€‚\n\nè¯¦è§ï¼š\n\nhttps://zh.cppreference.com/w/cpp/language/identifiers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578667018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169638,"user_name":"ã˜JRisenã¥ã‚¸","can_delete":false,"product_type":"c1","uid":1401105,"ip_address":"","ucode":"87EB43D4B0B19C","user_header":"https://static001.geekbang.org/account/avatar/00/15/61/11/85386508.jpg","comment_is_top":false,"comment_ctime":1578395214,"is_pvip":false,"replies":[{"id":"65867","content":"è·Ÿå­¦å¤–è¯­ä¸€æ ·ï¼ŒåŸºæœ¬è¯€çªå°±æ˜¯å¤šè¯»å¤šå†™ã€‚æ–‡æ¡£ç°åœ¨éƒ½å¾ˆé½å…¨çš„ï¼Œä½†é™¤äº†æå°‘æ•°å¤©æ‰å¼çš„äººç‰©ï¼Œçœ‹äº†ä¸ç”¨å°±ä¼šå¿˜æ‰å§ã€‚è€Œä¸”ï¼Œæ²¡çœŸæ­£ç”¨è¿‡ï¼Œç¢°åˆ°ä¸€äº›å‘ï¼Œçœ‹äº†çš„ç†è§£éƒ½ä¸ä¸€å®šæ­£ç¡®ã€‚<br><br>å¦å¤–å°±æ˜¯çœ‹ä¹¦äº†ã€‚ä¹¦æ¯”æ–‡æ¡£æ›´æœ‰ä½“ç³»æ€§ï¼Œæ›´é€‚åˆå®Œæ•´çš„å­¦ä¹ ï¼Œéœ€è¦æŠ•å…¥æ•´å—çš„æ—¶é—´ã€‚æ ‡å‡†åº“çš„ä¹¦ï¼Œåº”è¯¥å°±æ˜¯ Nicolai Josuttis çš„é‚£æœ¬ The C++ Standard Library ç¬¬äºŒç‰ˆäº†ã€‚ä¸­æ–‡ç‰ˆåˆšæŸ¥äº†ä¸€ä¸‹ï¼Œä¾¯æ·è¯‘ï¼Œä¸€åƒå¤šé¡µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578440020,"ip_address":"","comment_id":169638,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1578395214","product_id":100040501,"comment_content":"#include &lt;iostream&gt;<br>#include &lt;chrono&gt;<br>#include &lt;execution&gt;<br>#include &lt;numeric&gt;<br>#include &lt;vector&gt; è€å¸ˆæ€ä¹ˆå­¦ä¹ åº“çŸ¥è¯†ï¼Ÿ æç‚¹æ€è·¯","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480648,"discussion_content":"è·Ÿå­¦å¤–è¯­ä¸€æ ·ï¼ŒåŸºæœ¬è¯€çªå°±æ˜¯å¤šè¯»å¤šå†™ã€‚æ–‡æ¡£ç°åœ¨éƒ½å¾ˆé½å…¨çš„ï¼Œä½†é™¤äº†æå°‘æ•°å¤©æ‰å¼çš„äººç‰©ï¼Œçœ‹äº†ä¸ç”¨å°±ä¼šå¿˜æ‰å§ã€‚è€Œä¸”ï¼Œæ²¡çœŸæ­£ç”¨è¿‡ï¼Œç¢°åˆ°ä¸€äº›å‘ï¼Œçœ‹äº†çš„ç†è§£éƒ½ä¸ä¸€å®šæ­£ç¡®ã€‚\n\nå¦å¤–å°±æ˜¯çœ‹ä¹¦äº†ã€‚ä¹¦æ¯”æ–‡æ¡£æ›´æœ‰ä½“ç³»æ€§ï¼Œæ›´é€‚åˆå®Œæ•´çš„å­¦ä¹ ï¼Œéœ€è¦æŠ•å…¥æ•´å—çš„æ—¶é—´ã€‚æ ‡å‡†åº“çš„ä¹¦ï¼Œåº”è¯¥å°±æ˜¯ Nicolai Josuttis çš„é‚£æœ¬ The C++ Standard Library ç¬¬äºŒç‰ˆäº†ã€‚ä¸­æ–‡ç‰ˆåˆšæŸ¥äº†ä¸€ä¸‹ï¼Œä¾¯æ·è¯‘ï¼Œä¸€åƒå¤šé¡µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578440020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1401105,"avatar":"https://static001.geekbang.org/account/avatar/00/15/61/11/85386508.jpg","nickname":"ã˜JRisenã¥ã‚¸","note":"","ucode":"87EB43D4B0B19C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":124634,"discussion_content":"è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578446010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168078,"user_name":"å»–ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1141444,"ip_address":"","ucode":"8E8C475CD11FBC","user_header":"https://static001.geekbang.org/account/avatar/00/11/6a/c4/8679ca8a.jpg","comment_is_top":false,"comment_ctime":1578011602,"is_pvip":false,"replies":[{"id":"65269","content":"Y Combinator åªæ˜¯å¥½ç©å±•ç¤ºä¸€ä¸‹ï¼Œåˆºæ¿€ä¸€ä¸‹å¤§å®¶çš„å¥½å¥‡å¿ƒã€‚è¦è¿›ä¸€æ­¥äº†è§£ï¼Œæ˜¯éœ€è¦çœ‹å‚è€ƒèµ„æ–™ï¼Œæˆ–è€…å…¶ä»–ä¸­è‹±æ–‡èµ„æ–™çš„ã€‚ä½ è¯´çš„è¿™ç¯‡æˆ‘ä¹‹å‰æ²¡çœ‹è¿‡ï¼Œå†…å®¹ä¹Ÿä¸é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´å’ç‚œ","uid":"1645639","ctime":1578014020,"ip_address":"","comment_id":168078,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578011602","product_id":100040501,"comment_content":"Y-Combinatorä¸»è¦ç”¨åˆ°äº†ä¸€ä¸ªä¸åŠ¨ç‚¹ç†è®ºï¼Œåˆ˜æœªé¹è€å¸ˆçš„ã€Šåº·æ‰˜å°”ã€å“¥å¾·å°”ã€å›¾çµâ€”â€”æ°¸æ’çš„é‡‘è‰²å¯¹è§’çº¿ã€‹è¿™ç¯‡æ–‡ç« é‡Œé¢è¯´çš„ç›¸å¯¹è¯¦ç»†ä¸€äº›ã€‚ç©è¿‡ä¸€æ®µå‡½æ•°å¼...å°±åªæœ‰haskellé‚£æ®µä»£ç çœ‹æ‡‚äº†ğŸ˜‚","like_count":0,"discussions":[{"author":{"id":1645639,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/47/53c48284.jpg","nickname":"å´å’ç‚œ","note":"","ucode":"8C24C10AEC779F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480129,"discussion_content":"Y Combinator åªæ˜¯å¥½ç©å±•ç¤ºä¸€ä¸‹ï¼Œåˆºæ¿€ä¸€ä¸‹å¤§å®¶çš„å¥½å¥‡å¿ƒã€‚è¦è¿›ä¸€æ­¥äº†è§£ï¼Œæ˜¯éœ€è¦çœ‹å‚è€ƒèµ„æ–™ï¼Œæˆ–è€…å…¶ä»–ä¸­è‹±æ–‡èµ„æ–™çš„ã€‚ä½ è¯´çš„è¿™ç¯‡æˆ‘ä¹‹å‰æ²¡çœ‹è¿‡ï¼Œå†…å®¹ä¹Ÿä¸é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578014020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}