{"id":8846,"title":"38 | Apollo分布式部署指南","content":"无","comments":[{"had_liked":false,"id":131791,"user_name":"Geek_fc2cf2","can_delete":false,"product_type":"c3","uid":1640658,"ip_address":"","ucode":"7B4441B96C5DAD","user_header":"","comment_is_top":false,"comment_ctime":1567908160,"is_pvip":false,"replies":[{"id":50476,"content":"\n\n\n将Config Service和Admin Service注册到单独的Eureka Server上，可以参考官方文档：\n\nhttps:&#47;&#47;github.com&#47;ctripcorp&#47;apollo&#47;wiki&#47;部署&amp;开发遇到的常见问题，第8个问题。\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1568028619,"ip_address":"","comment_id":131791,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师，你好，我想问下我现在想把apollo部署到生产环境，我线上已经有一套自己的eureka，但是看见apollo自带了eureka，那么我想用我自己的，是直接修改apolloconfigdb库的serverconfig表的eureka.service.url这个字段地址变成我自己的eureka地址就行了吗？(比如我线上eureka是集群的，地址是域名，直接改成域名就行了吗？)","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466622,"discussion_content":"\n\n\n将Config Service和Admin Service注册到单独的Eureka Server上，可以参考官方文档：\n\nhttps://github.com/ctripcorp/apollo/wiki/部署&amp;amp;开发遇到的常见问题，第8个问题。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568028619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192276,"user_name":"Jason","can_delete":false,"product_type":"c3","uid":1085947,"ip_address":"","ucode":"6EECC0C25A9FCC","user_header":"https://static001.geekbang.org/account/avatar/00/10/91/fb/9b9d22a0.jpg","comment_is_top":false,"comment_ctime":1584844859,"is_pvip":false,"replies":[{"id":74015,"content":"携程生产部署将admin service还有config service部署在同一台机器上(两个不同的JVM实例)，这种部署方式考虑了资源利用率等因素。架构分离的思想没有必要拘泥，在实践中可以灵活运用。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585054662,"ip_address":"","comment_id":192276,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"admin 和 config 在一起违背了 apollo 管理和客户端分离思想吧？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488359,"discussion_content":"携程生产部署将admin service还有config service部署在同一台机器上(两个不同的JVM实例)，这种部署方式考虑了资源利用率等因素。架构分离的思想没有必要拘泥，在实践中可以灵活运用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585054662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64732,"user_name":"我已经设置了昵称","can_delete":false,"product_type":"c3","uid":1364034,"ip_address":"","ucode":"ED672C5EBDBDC4","user_header":"https://static001.geekbang.org/account/avatar/00/14/d0/42/6fd01fb9.jpg","comment_is_top":false,"comment_ctime":1548895512,"is_pvip":false,"replies":[{"id":23047,"content":"简单讲，eureka功能比较单一，专做服务发现用，AP模式，最大特定是支持跨数据中心部署；zk功能较多，实现较复杂，CA模式，zk也可以实现服务发现，但是一般不支持跨数据中心。如果你只是用来做服务发现，考虑eureka就可以，如果你还需要分布式KV，分布式协调，分布式锁之类功能，可以考虑zk。阿波罗选用eureka，我想主要因为阿波罗就想要一个服务发现功能，而且当时携程框架部已经使用和部署了eureka，他们不想麻烦再弄一套zk。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1549023293,"ip_address":"","comment_id":64732,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"eureka和zk怎么选，为什么阿波罗选了eureka","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438152,"discussion_content":"简单讲，eureka功能比较单一，专做服务发现用，AP模式，最大特定是支持跨数据中心部署；zk功能较多，实现较复杂，CA模式，zk也可以实现服务发现，但是一般不支持跨数据中心。如果你只是用来做服务发现，考虑eureka就可以，如果你还需要分布式KV，分布式协调，分布式锁之类功能，可以考虑zk。阿波罗选用eureka，我想主要因为阿波罗就想要一个服务发现功能，而且当时携程框架部已经使用和部署了eureka，他们不想麻烦再弄一套zk。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549023293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40002,"user_name":"Luke","can_delete":false,"product_type":"c3","uid":1093041,"ip_address":"","ucode":"1163BC279235A5","user_header":"https://static001.geekbang.org/account/avatar/00/10/ad/b1/ec93a079.jpg","comment_is_top":false,"comment_ctime":1542434914,"is_pvip":false,"replies":[{"id":15528,"content":"谢谢支持🌹","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1543237223,"ip_address":"","comment_id":40002,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"一直没时间看，最近才开始看，波波老师讲的不错","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429327,"discussion_content":"谢谢支持🌹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543237223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36802,"user_name":"Sam_Deep_Thinking","can_delete":false,"product_type":"c3","uid":1001152,"ip_address":"","ucode":"8E4EF6F24B821B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/c0/106d98e7.jpg","comment_is_top":false,"comment_ctime":1541337511,"is_pvip":false,"replies":[{"id":13182,"content":"可以直接用，我司也是用独立eureka集群，详见apollo文档。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1541423609,"ip_address":"","comment_id":36802,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"Eureka需要在单独部署一套高可用的Eureka集群吗？ 如果线上已经有一个拥有三个节点的高可用Eureka集群了，能直接用吗？？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428026,"discussion_content":"可以直接用，我司也是用独立eureka集群，详见apollo文档。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541423609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35814,"user_name":"明","can_delete":false,"product_type":"c3","uid":1119510,"ip_address":"","ucode":"D1159FBD019A50","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/16/0f57ce3b.jpg","comment_is_top":false,"comment_ctime":1540813534,"is_pvip":false,"replies":[{"id":13028,"content":"AdminService&#47;ConfigService&#47;Eureka每个环境都部置一份，主要是为隔离考虑，尤其是不影响生产环境。Portal只布一个，主要考虑是简化集中管理，且Portal设计就是支持多环境多集群的。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1541338114,"ip_address":"","comment_id":35814,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师讲解的精炼，很好！有个疑问：AdminService，ConfigService，Eureka每个环境部署一份主要是从高可用角度考虑的吗？还是因为只有Portal支持多环境，多集群，多命名空间？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427673,"discussion_content":"AdminService/ConfigService/Eureka每个环境都部置一份，主要是为隔离考虑，尤其是不影响生产环境。Portal只布一个，主要考虑是简化集中管理，且Portal设计就是支持多环境多集群的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541338114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1388421,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2f/85/9d1230c9.jpg","nickname":"Bootis","note":"","ucode":"834251DC0FE2E7","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6170,"discussion_content":"主要是如果你开发环境，测试环境，生产环境的配置都不一样，如何能保证你的代码在开发环境，测试环境测试通过后，能够直接上生产呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566740250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":23274,"user_name":"dududu","can_delete":false,"product_type":"c3","uid":1047008,"ip_address":"","ucode":"73E78AE92AD317","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/e0/fe87c6aa.jpg","comment_is_top":false,"comment_ctime":1536248027,"is_pvip":false,"replies":[{"id":8566,"content":"谢支持🌹","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1536547234,"ip_address":"","comment_id":23274,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100007001,"comment_content":"讲的真好","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423490,"discussion_content":"谢支持🌹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536547234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}