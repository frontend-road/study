{"id":772703,"title":"05ï½œåˆ†æ”¯è¯­å¥ï¼šæ§åˆ¶æµè®©ç¨‹åºå…·å¤‡åŸºæœ¬çš„è¿ç®—èƒ½åŠ›","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æµ·çº³ã€‚</p><p>ä¸Šä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬è®©è™šæ‹ŸæœºæˆåŠŸåœ°åŠ è½½å¹¶æ‰§è¡Œäº†æ ‡å‡†Python3.8ç‰ˆæœ¬çš„å­—èŠ‚ç ï¼Œæˆ‘çŸ¥é“ä½ å·²ç»è¿«ä¸åŠå¾…æƒ³ç»§ç»­å®ç°å¯¹è±¡ç³»ç»Ÿï¼Œä»¥æ”¯æŒæ•´æ•°å’Œå­—ç¬¦ä¸²ç­‰æ›´å¤šçš„æ•°æ®ç±»å‹äº†ã€‚ä½†åªå®ç°å®Œå¤‡çš„å¯¹è±¡ç³»ç»Ÿå¹¶ä¸èƒ½è®©è™šæ‹Ÿæœºçœ‹ä¸Šå»åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œè€Œæ§åˆ¶æµå´å¯ä»¥è®©æˆ‘ä»¬åšæ›´å¤šçš„æµ‹è¯•ï¼Œä¾‹å¦‚ï¼Œæ”¯æŒäº†åˆ†æ”¯å’Œå¾ªç¯è¯­å¥ä»¥åï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªè®¡ç®— fibonacci æ•°åˆ—çš„ç¨‹åºã€‚æ‰€ä»¥æˆ‘ä»¬å†³å®šå®ç°äº†æ§åˆ¶æµä¹‹åï¼Œå†é‡æ–°æ€è€ƒå¯¹è±¡ç³»ç»Ÿã€‚</p><p>å…¸å‹çš„ä¸¤ç§æ§åˆ¶æµç»“æ„æ˜¯åˆ†æ”¯é€‰æ‹©å’Œå¾ªç¯ç»“æ„ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬å…ˆç ”ç©¶åˆ†æ”¯è¯­å¥æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h2>åˆ†æ”¯è¯­å¥</h2><p>ä¸ºäº†ç ”ç©¶ Python å­—èŠ‚ç æ˜¯å¦‚ä½•è¡¨è¾¾åˆ†æ”¯ç»“æ„çš„ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«åˆ†æ”¯è¯­å¥çš„æµ‹è¯•æ–‡ä»¶ã€‚</p><pre><code class=\"language-python\"># test_if.py\nif 2 &gt; 1:\n&nbsp; &nbsp; print(2)\nelse:\n&nbsp; &nbsp; print(1)\n\nprint(3)\n</code></pre><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ŒæŠŠä¸Šè¿°æ–‡ä»¶ç¼–è¯‘æˆ pyc æ–‡ä»¶ã€‚</p><pre><code class=\"language-python\">python -m compileall test_if.py\n</code></pre><p>ç„¶åé€šè¿‡show_file.py æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ç»“æ„ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><pre><code class=\"language-python\">code\n&nbsp; &nbsp;argcount 0\n&nbsp; &nbsp;nlocals 0\n&nbsp; &nbsp;stacksize 2\n&nbsp; &nbsp;flags 0040\n&nbsp; &nbsp;code\n&nbsp; &nbsp; &nbsp; 640064016b04721265006400830101006e08650064018301010065006402\n&nbsp; &nbsp; &nbsp; 8301010064035300\n&nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 (2)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 (1)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 COMPARE_OP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4 (&gt;)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6 POP_JUMP_IF_FALSE&nbsp; &nbsp; &nbsp; &nbsp;18\n\n&nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 LOAD_NAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 (print)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 (2)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12 CALL_FUNCTION&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14 POP_TOP\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16 JUMP_FORWARD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8 (to 26)\n\n&nbsp; 4&nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp; &nbsp;18 LOAD_NAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 (print)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;20 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 (1)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;22 CALL_FUNCTION&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;24 POP_TOP\n\n&nbsp; 6&nbsp; &nbsp; &nbsp;&gt;&gt;&nbsp; &nbsp;26 LOAD_NAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 (print)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;28 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2 (3)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;30 CALL_FUNCTION&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;32 POP_TOP\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;34 LOAD_CONST&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3 (None)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;36 RETURN_VALUE\n&nbsp; &nbsp;consts\n&nbsp; &nbsp; &nbsp; 2\n&nbsp; &nbsp; &nbsp; 1\n&nbsp; &nbsp; &nbsp; 3\n&nbsp; &nbsp; &nbsp; None\n&nbsp; &nbsp;names ('print',)\n&nbsp; &nbsp;varnames ()\n&nbsp; &nbsp;freevars ()\n&nbsp; &nbsp;cellvars ()\n&nbsp; &nbsp;filename 'test_if.py'\n</code></pre><!-- [[[read_end]]] --><p>æˆ‘ä»¬çœ‹åˆ°ä»£ç ä¸­æ‰€ä½¿ç”¨çš„ä¸‰ä¸ªæ•´æ•°éƒ½å·²ç»æ”¾åœ¨äº† consts è¡¨ä¸­ã€‚åç¼–è¯‘å‡ºæ¥çš„å­—èŠ‚ç éƒ¨åˆ†åˆ™å‡ºç°äº†ä¸‰ä¸ªå°šæœªæ”¯æŒçš„å­—èŠ‚ç ï¼Œåˆ†åˆ«æ˜¯ COMPARE_OPã€POP_JUMP_IF_FALSE å’ŒJUMP_FORWARDã€‚ä» Python è™šæ‹Ÿæœºçš„æ ‡å‡†æ–‡æ¡£æˆ–è€… CPython çš„æºä»£ç é‡Œéƒ½å¯ä»¥æŸ¥åˆ°è¿™ä¸‰ä¸ªå­—èŠ‚ç çš„ç¼–å·ï¼Œåœ¨ bytecode.hpp é‡Œæ·»åŠ å®ƒä»¬ã€‚</p><pre><code class=\"language-c++\">    /* Comparison operator */\n    static const unsigned char COMPARE_OP = 107;\n    /* Number of bytes to skip */\n    static const unsigned char JUMP_FORWARD = 110;\n    static const unsigned char POP_JUMP_IF_FALSE = 114;\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹çœ‹è¿™ä¸‰ä¸ªå­—èŠ‚ç åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h2>å®ç°æ¯”è¾ƒæŒ‡ä»¤</h2><p>ç¬¬ä¸€ä¸ªè¦å¤„ç†çš„å­—èŠ‚ç æ˜¯ <strong>COMPARE_OP</strong>ï¼Œ<a href=\"https://time.geekbang.org/column/article/771985\">ç¬¬ 3 èŠ‚è¯¾</a>æˆ‘ä»¬æ›¾ç»æåˆ°å­—èŠ‚ç æ“ä½œæ•°ç¼–å·å¤§äº 90 çš„éƒ½æ˜¯å¸¦å‚æ•°çš„ã€‚COMPARE_OP çš„ç¼–å·æ˜¯ 107ï¼Œæ‰€ä»¥å®ƒæ˜¯å¸¦å‚æ•°çš„ã€‚åœ¨è¿™èŠ‚è¯¾çš„ä¾‹å­é‡Œï¼Œå®ƒçš„å‚æ•°æ˜¯ 4ï¼ˆåç¼–è¯‘ç»“æœçš„ç¬¬ 11 è¡Œï¼‰ã€‚è¿™ä¸ªå‚æ•°æ‰€ä»£è¡¨çš„æ˜¯æ¯”è¾ƒæ“ä½œç¬¦çš„ç±»å‹ï¼Œæ¯”å¦‚ 4 å°±ä»£è¡¨å¤§äºï¼Œ0 ä»£è¡¨å°äºï¼Œ2 ä»£è¡¨ç­‰äºã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹å®Œæ•´çš„æ¯”è¾ƒæ“ä½œæ‰€å¯¹åº”çš„ç±»å‹ã€‚</p><pre><code class=\"language-c++\">    enum COMPARE {\n        LESS = 0,\n        LESS_EQUAL,\n        EQUAL,\n        NOT_EQUAL,\n        GREATER,\n        GREATER_EQUAL\n    };\n</code></pre><p>æ¥ä¸‹æ¥å°±å¯ä»¥åœ¨ Interpreter é‡Œæ·»åŠ  COMPARE_OP çš„å®ç°äº†ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘éœ€è¦å¼•å…¥ä¸€ä¸ªå°çš„ä»£ç é‡æ„ã€‚ä¸ºäº†ä½¿ä»£ç æ›´ç®€æ´ï¼Œæˆ‘åœ¨ä»£ç é‡Œå®šä¹‰äº†å® PUSH å’Œ POPï¼Œè¿™æ ·å¯ä»¥é¿å…å¤§é‡çš„æ‰‹åŠ¨è¾“å…¥ã€‚</p><pre><code class=\"language-c++\">// runtime/interpreter.cpp\n#define PUSH(x)  _stack-&gt;add((x))\n#define POP()    _stack-&gt;pop()\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ Interpreter ä¸­å®ç°æˆ‘ä»¬è¿™èŠ‚è¯¾æåˆ°çš„ä¸‰ä¸ªå­—èŠ‚ç äº†ã€‚</p><pre><code class=\"language-c++\">            case ByteCode::COMPARE_OP:\n                w = POP();\n                v = POP();\n\n                switch(op_arg) {\n                case ByteCode::GREATER:\n                    PUSH(v-&gt;greater(w));\n                    break;\n\n                case ByteCode::LESS:\n                    PUSH(v-&gt;less(w));\n                    break;\n\n                case ByteCode::EQUAL:\n                    PUSH(v-&gt;equal(w));\n                    break;\n\n                case ByteCode::NOT_EQUAL:\n                    PUSH(v-&gt;not_equal(w));\n                    break;\n\n                case ByteCode::GREATER_EQUAL:\n                    PUSH(v-&gt;ge(w));\n                    break;\n               \n                case ByteCode::LESS_EQUAL: \n                    PUSH(v-&gt;le(w));\n                    break;\n\n                default:\n                    printf(\"Error: Unrecognized compare op %d\\n\", op_arg);\n\n                }\n                break;\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€ç§æ¯”è¾ƒæ“ä½œéƒ½æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œåˆå› ä¸ºå„ä¸ªå¯¹è±¡çš„æ¯”è¾ƒæ–¹å¼å„ä¸ç›¸åŒï¼Œæ‰€ä»¥æ¯ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰è‡ªå·±çš„å®ç°ã€‚è¦å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œè¿™äº›æ¯”è¾ƒæ–¹æ³•å¿…é¡»å’Œprintæ–¹æ³•ä¸€æ ·ï¼Œæ˜¯è™šå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»è¦ä½¿ç”¨ virtual å…³é”®å­—è¿›è¡Œä¿®é¥°ã€‚</p><pre><code class=\"language-c++\">class HiObject {\npublic:\n    virtual void print() {}\n\n    virtual HiObject* add(HiObject* x){}\n    virtual HiObject* greater  (HiObject* x) {};\n    virtual HiObject* less     (HiObject* x) {};\n    virtual HiObject* equal    (HiObject* x) {};\n    virtual HiObject* not_equal(HiObject* x) {};\n    virtual HiObject* ge       (HiObject* x) {};\n    virtual HiObject* le       (HiObject* x) {};\n};\n</code></pre><p>åœ¨ HiInteger ç±»ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æä¾›ç”¨äºæ•´æ•°æ¯”è¾ƒçš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨å­ç±»ä¸­è¦†å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘åªåˆ—å‡ºå¤§äºæ“ä½œæ‰€å¯¹åº”çš„greateræ–¹æ³•ï¼Œè€Œç­‰äºã€ä¸ç­‰äºã€å°äºç­‰æ“ä½œæ‰€å¯¹åº”çš„æ–¹æ³•ï¼Œä½ å¯ä»¥è‡ªå·±è¡¥å……ã€‚</p><pre><code class=\"language-c++\">HiObject* HiInteger::greater(HiObject* x) {\n    if (_value &gt; ((HiInteger*)x)-&gt;_value)\n        return new HiInteger(1);\n    else\n        return new HiInteger(0);\n}\n</code></pre><p>æ³¨æ„è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œåœ¨ Python ä¸­ True å’Œ False éƒ½æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰ç”¨äºæ¯”è¾ƒæ“ä½œçš„å‡ ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå®ƒçš„è¿”å›å€¼ä¹Ÿæ˜¯ HiObject ç±»å‹çš„æŒ‡é’ˆã€‚ä½†ç°åœ¨æˆ‘ä»¬çš„è™šæ‹Ÿæœºå¯¹è±¡ç±»å‹è¿˜ä¸å®Œæ•´ï¼Œæ²¡æœ‰çœŸæ­£çš„ True å’Œ False å¯¹è±¡ï¼Œå°±ä¸´æ—¶ä½¿ç”¨ 0 ä»£è¡¨ Falseï¼Œä½¿ç”¨ 1 ä»£è¡¨ Trueã€‚è¿™æ ·çš„æ›¿ä»£è™½ç„¶å¹¶ä¸å®Œå…¨ç¬¦åˆ Python è¯­ä¹‰ï¼Œä½†å°±ç›®å‰è€Œè¨€å·²ç»è¶³å¤Ÿäº†ã€‚</p><h2>å®ç°è·³è½¬åŠŸèƒ½</h2><p>åœ¨åˆšå¼€å§‹å®ç°æ‰§è¡Œå™¨çš„æ—¶å€™ï¼Œæˆ‘å°±è§£é‡Šè¿‡ pc å˜é‡çš„å«ä¹‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œä»£è¡¨è™šæ‹Ÿæœºå½“å‰æ‰§è¡Œåˆ°å“ªæ¡æŒ‡ä»¤äº†ã€‚å½“æ§åˆ¶æµå› ä¸ºåˆ†æ”¯é€‰æ‹©è€Œå‘ç”Ÿè·³è½¬çš„æ—¶å€™ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ”¹å˜è¿™ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œè®©å®ƒä¸å†é¡ºåºå‘ä¸‹å–æŒ‡ï¼Œè€Œæ˜¯è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç›®æ ‡åœ°å€ï¼Œå»æŠŠé‚£é‡Œçš„æŒ‡ä»¤å–å‡ºæ¥æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œæ‰€æœ‰çš„è·³è½¬æŒ‡ä»¤æœ¬è´¨ä¸Šå°±æ˜¯å¯¹ç¨‹åºè®¡æ•°å™¨çš„å¹²é¢„ï¼Œä½¿å®ƒæŒ‡å‘æˆ‘ä»¬æœŸæœ›çš„åœ°å€ã€‚</p><p>ç„¶åå†è€ƒå¯Ÿ POP_JUMP_IF_FALSE çš„å‚æ•°ï¼Œåœ¨è¿™èŠ‚è¯¾çš„ä¾‹å­é‡Œï¼Œå®ƒæ˜¯ 18ã€‚è¿™ä¸ªå‚æ•°ä»£è¡¨çš„æ˜¯ç»å¯¹åœ°å€ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚ç å‰é¢çš„ç¼–å·ã€‚ä½ çœ‹ä¸€ä¸‹åœ°å€ç¼–å·ä¸º 18 çš„é‚£æ¡æŒ‡ä»¤ï¼Œåç¼–è¯‘å·¥å…·å·²ç»å¾ˆè´´å¿ƒåœ°å¸®æˆ‘ä»¬æ ‡è®°äº† â€œ&gt;&gt;â€ ç¬¦å·ï¼Œåœ°å€ä¸º 18 çš„é‚£æ¡ LOAD_NAME æŒ‡ä»¤å°±æ˜¯æˆ‘ä»¬è¦è·³è½¬çš„ç›®æ ‡åœ°å€ã€‚ç»è¿‡åˆ†æï¼ŒPOP_JUMP_IF_FALSE çš„å®ç°å°±éå¸¸ç®€å•äº†ã€‚</p><pre><code class=\"language-c++\">            case ByteCode::POP_JUMP_IF_FALSE:\n                v = POP();\n                if (((HiInteger*)v)-&gt;value() == 0)\n                    pc = op_arg;\n                break;\n</code></pre><p>ä¸Šè¿°å®ç°åªåšäº†ä¸€ä¸ªåŠ¨ä½œï¼šå½“æ ˆé¡¶å€¼ä¸º 0 æ—¶ï¼ŒæŠŠ pc çš„å€¼ä¿®æ”¹æˆç›®æ ‡åœ°å€ï¼ˆç¬¬4è¡Œï¼‰ã€‚åˆšåˆšæˆ‘ä»¬è®²åˆ°ï¼Œç°é˜¶æ®µæˆ‘ä»¬ç”¨å€¼ä¸º 0 çš„æ•´æ•°ä»£è¡¨ Falseï¼Œæ‰€ä»¥å½“æ ˆé¡¶å€¼ä¸º False çš„æ—¶å€™ï¼Œå°±è·³è½¬åˆ°å‚æ•°æ‰€æŒ‡å®šçš„ç›®æ ‡åœ°å€ï¼Œå¦‚æœæ˜¯ Trueï¼Œå°±ä»€ä¹ˆä¹Ÿä¸åšï¼Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚</p><p>ä¸‰ä¸ªå­—èŠ‚ç ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†ä¸¤ä¸ªï¼Œè¿˜å‰©ä¸‹æœ€åä¸€ä¸ªï¼š<strong>JUMP_FORWARD</strong>ã€‚è¿™ä¸ªå­—èŠ‚ç å…¶å®æ˜¯æœ€ç®€å•çš„ï¼Œå®ƒä¹Ÿæ˜¯å¸¦å‚æ•°çš„ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ­£æ•°ï¼Œä»£è¡¨ç›¸å¯¹åœ°å€ï¼Œä¹Ÿå°±æ˜¯ç”¨å½“å‰çš„ pc åŠ ä¸Šè¿™ä¸ªå‚æ•°æ‰æ˜¯è¦è·³è½¬çš„ç›®æ ‡åœ°å€ã€‚å°±åƒå®ƒçš„åç§°æ‰€æŒ‡ç¤ºçš„ï¼Œè¿™ä¸ªå­—èŠ‚ç åªèƒ½å‘å‰è·³è½¬ï¼Œæ‰€ä»¥å®ƒçš„å‚æ•°ä¸€å®šæ˜¯ä¸€ä¸ªæ­£æ•°ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹å®ƒçš„ä»£ç ã€‚</p><pre><code class=\"language-c++\">            case ByteCode::JUMP_FORWARD:\n                pc += op_arg;\n                break;\n</code></pre><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æŠŠåˆ†æ”¯ç»“æ„æ‰€éœ€è¦çš„å­—èŠ‚ç å…¨éƒ½å®ç°äº†ã€‚ç°åœ¨å¯ä»¥ç¼–è¯‘æ‰§è¡Œä¸€ä¸‹ã€‚</p><pre><code class=\"language-plain\">src/build# make all\n...\nsrc/build# ./vm/pvm test_if.pyc \nmagic number is 0xa0df303\nmoddate is 0x5b66d766\nflags is 0x40\nparse OK!\n2\n3\n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œç»“æœæ˜¯æ‰“å°å‡ºäº† 2 å’Œ 3ï¼Œè¿™ä¸ªç»“æœç¬¦åˆé¢„æœŸã€‚ä½ ä¸å¦¨å°è¯•ä¸€ä¸‹ç­‰äºã€å°äºã€ä¸ç­‰äºç­‰å…¶ä»–æ¯”è¾ƒæ“ä½œï¼Œçœ‹çœ‹ç»“æœæ˜¯å¦æ­£ç¡®ã€‚</p><h2>å®ç°Trueã€Falseå’ŒNone</h2><p>åœ¨å‰é¢çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ True å’Œ False æ—¶ï¼Œéƒ½æ˜¯ä½¿ç”¨æ•´å‹çš„ 1 å’Œ 0 ä»£æ›¿çš„ã€‚è€Œä¸”æ¯æ¬¡ä½¿ç”¨çš„æ—¶å€™ï¼Œéƒ½è¦é‡æ–°åˆ›å»ºä¸€ä¸ªæ•´å‹å¯¹è±¡ã€‚å®é™…ä¸Šï¼Œæ•´ä¸ªè™šæ‹Ÿæœºä¸­åªéœ€è¦ä¸€ä¸ªå”¯ä¸€çš„ True å¯¹è±¡å’Œå”¯ä¸€çš„ False å¯¹è±¡ã€‚è¦å®ç°å…¨å±€å”¯ä¸€ï¼Œæˆ‘ä»¬è‡ªç„¶å°±ä¼šæƒ³åˆ° <strong>static å˜é‡</strong>ã€‚é™¤äº† True å’Œ Falseï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ None å¯¹è±¡ï¼Œå®ƒä¹Ÿæ˜¯å…¨å±€å”¯ä¸€çš„ã€‚</p><p>ç±»ä¼¼ True å’Œ False è¿™ç§å…¨å±€å”¯ä¸€å˜é‡ï¼Œæœªæ¥è¿˜ä¼šé‡åˆ°å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è¿™äº›å˜é‡éƒ½é›†ä¸­èµ·æ¥æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ã€‚æˆ‘ä»¬ä¸å¦¨æŠŠè¿™ä¸ªç±»å«ä½œ Universeï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹å®ƒçš„å®šä¹‰ã€‚</p><pre><code class=\"language-c++\">// runtime/universe.hpp\nclass Universe {\npublic:\n    static HiInteger* HiTrue;\n    static HiInteger* HiFalse;\n\n    static HiObject* HiNone;\n\npublic:\n    static void genesis();\n    static void destroy();\n};\n</code></pre><p>åœ¨ Universe ç±»ä¸­å®šä¹‰äº†ä¸‰ä¸ªé™æ€å˜é‡ï¼Œåˆ†åˆ«ä»£è¡¨ Trueã€False å’Œ Noneï¼Œåˆå®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªåä¸ºGenesisï¼Œæ„æ€æ˜¯åˆ›ä¸–çºªï¼Œå°±åƒå®‡å®™çš„è¯ç”Ÿï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­åˆ›å»ºè™šæ‹Ÿæœºæœ€åŸå§‹çš„å¯¹è±¡ç»“æ„ã€‚è™šæ‹Ÿæœºé‡Œçš„æ‰€æœ‰å¯¹è±¡ä»¥åéƒ½ä¼šä»¥è¿™ä¸ªæ–¹æ³•ä¸ºèµ·ç‚¹ã€‚å¦ä¸€ä¸ªæ˜¯ destroyï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨è™šæ‹Ÿæœºé€€å‡ºçš„æ—¶å€™è°ƒç”¨ï¼Œç”¨æ¥é”€æ¯å¯¹è±¡ï¼Œé‡Šæ”¾èµ„æºï¼Œæ¸…ç†ç©ºé—´ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªç±»çš„å…·ä½“å®ç°ã€‚</p><pre><code class=\"language-c++\">// runtime/universe.cpp\nHiInteger* Universe::HiTrue   = NULL;\nHiInteger* Universe::HiFalse  = NULL;\n\nHiObject*  Universe::HiNone   = NULL;\n\nvoid Universe::genesis() {\n    HiTrue       = new HiInteger(1);\n    HiFalse      = new HiInteger(0);\n\n    HiNone       = new HiObject();\n}\n\nvoid Universe::destroy() {\n}\n</code></pre><p>é¦–å…ˆï¼Œæ˜¯ Trueã€False å’Œ None å¯¹è±¡çš„åˆå§‹åŒ–ã€‚static å˜é‡åœ¨æºæ–‡ä»¶ä¸­å®šä¹‰åˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œæ˜¯ä¸ºäº†é¿å…å¤šä¸ªç›®æ ‡æ–‡ä»¶çš„é“¾æ¥å†²çªã€‚æˆ‘ä»¬åœ¨ genesis æ–¹æ³•é‡ŒåšçœŸæ­£çš„åˆå§‹åŒ–ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºå¯¹è±¡åˆå§‹åŒ–çš„æ—¶æœºæœ‰ç»å¯¹çš„æŒæ§æƒï¼Œè€Œä¸æ˜¯äº¤ç»™ç¼–è¯‘å™¨å»å†³å®šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>åªæœ‰æˆ‘ä»¬æ˜ç¡®åœ°è°ƒç”¨ genesis çš„æ—¶å€™ï¼Œå¯¹è±¡æ‰ä¼šçœŸæ­£å¼€å§‹åˆå§‹åŒ–</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰æœºä¼šåœ¨å¯¹è±¡åˆå§‹åŒ–ä¹‹å‰åšä¸€äº›é¢å¤–çš„å·¥ä½œã€‚</p><p>å®é™…ä¸Šï¼Œè¿™é‡Œå®Œå…¨å¯ä»¥æŠŠ HiTrue å’Œ HiFalse è¿™ä¸¤ä¸ªå˜é‡åˆå§‹åŒ–ä¸ºä»»æ„å¯¹è±¡ã€‚å¯¹äºè™šæ‹Ÿæœºæ¥è¯´ï¼ŒçœŸæ­£æœ‰æ„ä¹‰çš„æ˜¯å®ƒä»¬çš„åœ°å€ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œåªè¦æŒ‡å®šä¸€ä¸ªç»å¯¹åœ°å€ï¼Œç„¶åè¯´å®ƒå°±æ˜¯ Trueï¼Œæˆ–è€…è¯´å®ƒå°±æ˜¯ None å°±å¯ä»¥ã€‚</p><p>ç»è¿‡è¿™æ ·çš„æ”¹è¿›ï¼ŒBinaryFileParser åœ¨è§£æå¸¸é‡è¡¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠå­—æ¯â€œNâ€è§£ææˆ HiNoneï¼Œè€Œä¸æ˜¯ NULL æŒ‡é’ˆã€‚ä»¥æ­¤ç±»æ¨ï¼ŒHiInteger çš„ greater æ–¹æ³•ï¼Œä¹Ÿä¸ç”¨æ¯æ¬¡æ‰§è¡Œéƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œåªè¦è¿”å›ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ True å’Œ Falseå°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-c++\">// use HiTrue and HiFalse instead of creating a new \n// object everytime.\nHiObject* HiInteger::greater(HiObject* x) {\n    if (_value &gt; ((HiInteger*)x)-&gt;_value)\n        //return new HiInteger(1);\n        return Universe::HiTrue;\n    else\n        //return new HiInteger(0);\n        return Universe::HiFalse;\n}\n</code></pre><p>å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚ lessã€equal ç­‰éƒ½æœ‰ç›¸åŒçš„æ”¹åŠ¨ã€‚</p><p>è¿˜æœ‰ä¸€å¤„ä¿®æ”¹æ˜¯è¦æ³¨æ„çš„ï¼Œinterpreter ä¸­å¯¹ JUMP_IF_FALSE çš„å®ç°ï¼Œåœ¨åˆ¤æ–­ False æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¸ç”¨å†ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢äº†ï¼Œè€Œæ˜¯æ¢æˆæ›´åŠ ç®€å•çš„åœ°å€æ¯”è¾ƒã€‚</p><pre><code class=\"language-c++\">             case ByteCode::POP_JUMP_IF_FALSE:\n                v = POP();\n\t\t\t\t//if (((HiInteger*)v)-&gt;value() == 0)\n                if (v == Universe::HiFalse)\n                    pc = op_arg;\n                break;\n</code></pre><p>åˆ°è¿™é‡Œï¼Œåˆ†æ”¯æ“ä½œæ‰€éœ€è¦çš„æ¯”è¾ƒå’Œè·³è½¬åŠŸèƒ½å°±å…¨éƒ¨å®ç°äº†ã€‚</p><h2>æ€»ç»“</h2><p>æ§åˆ¶æµçš„ä½œç”¨æ˜¯æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œé¡ºåºï¼Œä¸»è¦åŒ…å«åˆ†æ”¯å’Œå¾ªç¯ä¸¤ç§ç»“æ„ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬é‡ç‚¹ä»‹ç»äº†åˆ†æ”¯è¯­å¥çš„å®ç°åŸç†ã€‚</p><p>æ¯”è¾ƒæŒ‡ä»¤å’Œè·³è½¬æŒ‡ä»¤æ˜¯å®ç°åˆ†æ”¯è¯­å¥çš„åŸºç¡€ã€‚Python å­—èŠ‚ç ä¸­ç”¨äºæ¯”è¾ƒåˆ¤æ–­çš„æŒ‡ä»¤æ˜¯ COMPARE_OPï¼Œè¿™èŠ‚è¯¾çš„ç¬¬äºŒéƒ¨åˆ†æˆ‘ä»¬å®ç°äº†è¿™ä¸ªå­—èŠ‚ç ã€‚æ¯ä¸ªæ¯”è¾ƒæŒ‡ä»¤ç»“æœéƒ½æ˜¯å¸ƒå°”å€¼ True æˆ–è€… Falseã€‚åœ¨ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸´æ—¶ä½¿ç”¨äº†æ•´å‹å˜é‡ 1 å’Œ 0 æ¥ä»£æ›¿ã€‚åé¢æˆ‘ä»¬åˆä½¿ç”¨å…¨å±€å˜é‡è¡¥å…¨äº† Trueã€False å’Œ None çš„å®ç°ã€‚</p><p>ç”¨äºè·³è½¬çš„æŒ‡ä»¤ï¼Œè¿™èŠ‚è¯¾ä¸­å‡ºç°ä¸¤æ¡ï¼Œç¬¬ä¸€æ¡æ˜¯<strong>POP_JUMP_IF_FALSE</strong>ï¼Œå®ƒçš„å«ä¹‰æ˜¯å–å‡ºæ ˆé¡¶å…ƒç´ å¹¶åˆ¤æ–­ï¼Œå¦‚æœæ ˆé¡¶å…ƒç´ æ˜¯ Trueï¼Œå°±ä¸å‘ç”Ÿè·³è½¬ï¼Œå¦‚æœæ ˆé¡¶å…ƒç´ æ˜¯ Falseï¼Œå°±è·³è½¬åˆ°è¿™æ¡å­—èŠ‚ç çš„å‚æ•°æ‰€æŒ‡å®šçš„ç›®æ ‡åœ°å€ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€æ¡ç»å¯¹è·³è½¬æŒ‡ä»¤ã€‚</p><p>è¿™èŠ‚è¯¾å‡ºç°çš„ç¬¬äºŒæ¡è·³è½¬æŒ‡ä»¤æ˜¯ <strong>JUMP_FORWARD</strong>ã€‚æ‰§è¡Œè¿™æ¡æŒ‡ä»¤ä¸éœ€è¦è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œä½†æ˜¯å®ƒçš„å‚æ•°å´æœ‰äº›ä¸ä¸€æ ·ã€‚è¿™æ¡å­—èŠ‚ç çš„å‚æ•°æ˜¯ç›®æ ‡åœ°å€ç›¸å¯¹äºå½“å‰æŒ‡ä»¤åœ°å€çš„åç§»é‡ï¼Œè®¡ç®—ç›®æ ‡åœ°å€çš„æ—¶å€™ï¼Œéœ€è¦ç”¨å½“å‰åœ°å€åŠ ä¸Šè¿™ä¸ªåç§»é‡ã€‚</p><p>å®ç°äº†è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿™èŠ‚è¯¾å¼€å¤´çš„ä¾‹å­å°±èƒ½æ­£ç¡®æ‰§è¡Œäº†ã€‚æˆåŠŸåœ°å®ç°åˆ†æ”¯è¯­å¥åï¼Œä¸‹èŠ‚è¯¾æˆ‘ä»¬ç»§ç»­å®ç°å¾ªç¯è¯­å¥ã€‚</p><p><span class=\"reference\">æ³¨ï¼šç‚¹å‡»é“¾æ¥æŸ¥çœ‹<a href=\"https://gitee.com/hinus/pythonvm/tree/geektime/\">è¯¾ç¨‹ä»£ç åœ°å€</a></span></p><h2>æ€è€ƒé¢˜</h2><p>None ä¹Ÿå¯ä»¥ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼ŒPythonè¯­è¨€æ˜¯å¦‚ä½•å¤„ç†å®ƒçš„å‘¢ï¼Ÿ</p><p>å¦‚æœæ‰§è¡Œæˆ‘ç»™å‡ºçš„è¿™æ®µä»£ç ï¼Œå®ƒçš„ç»“æœä¼šæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬çš„è™šæ‹Ÿæœºåˆè¯¥å¦‚ä½•ä¿®æ”¹ï¼Œæ¥æ”¯æŒè¿™ä¸ªç‰¹æ€§å‘¢ï¼Ÿ</p><pre><code class=\"language-python\">if None:\n    print(0)\nelse:\n    print(1)\n</code></pre><p>æ¬¢è¿ä½ æŠŠä½ çš„ç­”æ¡ˆåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":390622,"user_name":"ç»†é›¨å¹³æ¹–","can_delete":false,"product_type":"c1","uid":1144394,"ip_address":"åŒ—äº¬","ucode":"D7F571A24388F2","user_header":"https://static001.geekbang.org/account/avatar/00/11/76/4a/014c6775.jpg","comment_is_top":false,"comment_ctime":1715781380,"is_pvip":false,"replies":[{"id":142078,"content":"ğŸ‘ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1360512,"ctime":1715790821,"ip_address":"æµ™æ±Ÿ","comment_id":390622,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761401,"comment_content":"è®²å¾—å¾ˆä¸é”™ã€‚","like_count":1,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645134,"discussion_content":"ğŸ‘ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1715790822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391275,"user_name":"ç»†éœ²ä»”","can_delete":false,"product_type":"c1","uid":2054967,"ip_address":"å¹¿ä¸œ","ucode":"58A586052657A8","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5b/37/aedccd85.jpg","comment_is_top":false,"comment_ctime":1717788602,"is_pvip":false,"replies":[{"id":142358,"content":"å“¦ï¼Œæ˜¯ä»£ç ä»“é‡Œçš„ä¸€ä¸ªå°å·¥å…·ã€‚ä½äºtoolsç›®å½•ä¸‹ã€‚ä½ å»ä»£ç ä»“é‡Œçœ‹ã€‚ç”±äºæ˜¯ä¸ªå¼€æºå°å·¥å…·ï¼Œæˆ‘å°±æ²¡è¯¦ç»†ä»‹ç»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1360512,"ctime":1718338171,"ip_address":"æµ™æ±Ÿ","comment_id":391275,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761401,"comment_content":"å“ï¼Œè¿™ä¸ªshow_file.pyæ˜¯ä»€ä¹ˆæ—¶å€™å†’å‡ºæ¥çš„å•Šï¼Ÿæˆ‘å…¨å±€æœç´¢ä¹Ÿæ²¡å‘ç°å‰é¢çš„å“ªä¸ªç« èŠ‚æœ‰å®ç°è¿‡ä»–å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646615,"discussion_content":"å“¦ï¼Œæ˜¯ä»£ç ä»“é‡Œçš„ä¸€ä¸ªå°å·¥å…·ã€‚ä½äºtoolsç›®å½•ä¸‹ã€‚ä½ å»ä»£ç ä»“é‡Œçœ‹ã€‚ç”±äºæ˜¯ä¸ªå¼€æºå°å·¥å…·ï¼Œæˆ‘å°±æ²¡è¯¦ç»†ä»‹ç»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718338171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390718,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"ä¸Šæµ·","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1716098219,"is_pvip":true,"replies":[{"id":142111,"content":"æ˜¯çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æŒ‡å®šäº†3.8æ¥è®²è§£ã€‚3.10çš„æ“ä½œæ•°é™¤äº†2ï¼Œæ‰€ä»¥åˆ†æçš„æ—¶å€™è¦æŠŠæ“ä½œæ•°å…ˆä¹˜ä»¥2ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1360512,"ctime":1716176663,"ip_address":"ä¸Šæµ·","comment_id":390718,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100761401,"comment_content":"Python 3.10ç¼–è¯‘å‡ºçš„è·³è½¬æŒ‡ä»¤å‚æ•°æœ‰å·®åˆ«\n\n7212\n6 POP_JUMP_IF_FALSE 18\n\n7209\n6 POP_JUMP_IF_FALSE 9 (to 18)\n\n6e08\n16 JUMP_FORWARD 8 (to 26)\n\n6e04\n16 JUMP_FORWARD 4 (to 26)","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645446,"discussion_content":"æ˜¯çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æŒ‡å®šäº†3.8æ¥è®²è§£ã€‚3.10çš„æ“ä½œæ•°é™¤äº†2ï¼Œæ‰€ä»¥åˆ†æçš„æ—¶å€™è¦æŠŠæ“ä½œæ•°å…ˆä¹˜ä»¥2ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716176663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1038574,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d8/ee/6e7c2264.jpg","nickname":"Only now","note":"","ucode":"C617473A03AE27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":645479,"discussion_content":"è€å¸ˆï¼Œè¿™ç§æ”¹å˜çš„ç›Šå¤„æ˜¯ä»€ä¹ˆå‘¢?çœ‹æ‰‹å†Œè¯´å…¶æ“ä½œæ•°å«ä¹‰ç”±åŸå…ˆçš„å­—èŠ‚åç§»æ”¹ä¸ºäº†æŒ‡ä»¤æ•°çš„åç§»,ç°åœ¨ç‰ˆæœ¬çš„è§£é‡Šå™¨çš„å®ç°æ•°æŒ‡ä»¤æ¯”æ•°å­—èŠ‚æ›´é«˜æ•ˆäº†å—?è¿˜æ˜¯ä¸ºäº†æ ‡å‡†æ›´ç»Ÿä¸€?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716217439,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":645446,"ip_address":"åŒ—äº¬","group_id":0},"score":645479,"extra":""}]},{"author":{"id":1667175,"avatar":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","nickname":"qinsi","note":"","ucode":"090D9C4068FF12","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645399,"discussion_content":"Changed in version 3.10: The argument of jump, exception handling and loop instructions is now the instruction offset rather than the byte offset. https://docs.python.org/3/library/dis.html","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1716098413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395089,"user_name":"ifelse","can_delete":false,"product_type":"c1","uid":2550743,"ip_address":"æµ™æ±Ÿ","ucode":"D0565908C99695","user_header":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","comment_is_top":false,"comment_ctime":1729403211,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":3,"score":2,"product_id":100761401,"comment_content":"å­¦ä¹ æ‰“å¡","like_count":0}]}