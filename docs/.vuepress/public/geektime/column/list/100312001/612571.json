{"id":612571,"title":"02 | 如何将容器镜像部署到K8s？","content":"<p>你好，我是王炜。</p><p>上节课，我们学习了容器镜像的概念以及如何将业务构建成容器镜像。容器镜像是我们学习云原生的起点，同时也会贯穿在云原生的各个环节之中，希望你能多花点时间巩固。这节课，我们一起来看看如何将容器镜像部署到 K8s。</p><p>K8s 的系统设计非常复杂，这导致它的学习曲线非常陡峭。尤其是对于刚入门的同学而言，面对繁杂的概念时往往会不知所措，也无从下手。再加上学习过程缺乏实战性的反馈，很容易导致“从入门到放弃”的情况出现。</p><p>所以这节课，我打算摒弃概念先行的教学方法，从实战的角度出发，带你从零入门 K8s。</p><p><strong>我会继续延伸上一节课程的内容，带你把之前构建的容器镜像部署到 K8s 集群中。</strong>在实战的过程中，我也会讲解 K8s 的一些基本概念。</p><p>在开始实践之前，你需要做好以下准备：</p><ul>\n<li>准备一台电脑（首选 Linux 或 macOS，Windows 也适用，需要稍微注意一下操作上的差异）；</li>\n<li><a href=\"https://docs.docker.com/engine/install/\">安装 Docker</a>；</li>\n<li><a href=\"https://kubernetes.io/docs/tasks/tools/\">安装 Kubectl</a>。</li>\n</ul><h2>安装 Kubernetes</h2><p>如何获得一个 K8s 集群是每一个开发者需要熟练掌握的内容。</p><p>安装 K8s 的方法非常多，有生产级的安装方法，也有以测试为目标的安装方法。为了方便测试，这里我推荐一种在本地安装 K8s 集群的办法：Kind。</p><!-- [[[read_end]]] --><p>首先，你需要根据<a href=\"https://kind.sigs.k8s.io/docs/user/quick-start/#installation\">官方步骤</a>安装 Kind，它是一个命令行工具，使用非常简单。</p><p><strong>接下来，我们开始创建 K8s。</strong></p><p>将以下内容保存为 config.yaml：</p><pre><code class=\"language-yaml\">kind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: \"ingress-ready=true\"\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP\n</code></pre><p>执行 kind create 命令，创建 K8s 集群：</p><pre><code class=\"language-yaml\">❯ kind create cluster --config config.yaml\nCreating cluster \"kind\" ...\n&nbsp;✓ Ensuring node image (kindest/node:v1.23.4) 🖼\n&nbsp;✓ Preparing nodes 📦&nbsp;&nbsp;\n&nbsp;✓ Writing configuration 📜&nbsp;\n&nbsp;✓ Starting control-plane 🕹️&nbsp;\n&nbsp;✓ Installing CNI 🔌&nbsp;\n&nbsp;✓ Installing StorageClass 💾&nbsp;\nSet kubectl context to \"kind-kind\"\nYou can now use your cluster with:\n\nkubectl cluster-info --context kind-kind\n</code></pre><p>通过这两个简单的步骤，我们的本地 K8s 集群就创建好了。</p><h2>初识 Kubernetes</h2><p>K8s 的概念既多又复杂，如果像教科书一样把这些概念一条一条给你讲出来，最后你可能也记不住。所以，我也不打算这么做。</p><p><strong>我想先问你一个问题：Docker 已经挺好用了，我们为什么还需要 K8s 呢？你可以试着用 30 秒来思考一下。</strong></p><p>我用一个场景来给你解释一下。还记得我们在上节课提到的启动一个容器的方法吗？这条命令非常简单，只需要运行 docker run 就可以了。</p><p>但是试想一下，如果你需要同时启动 10 个不同的容器镜像，是不是需要运行 10 次 docker run 命令呢？此外，如果容器之间有依赖顺序，你是不是还需要额外记住这 10 条命令特定的启动顺序？</p><p>K8s 的独特之处在于，它为我们抽象了诸如“启动 10 个容器镜像”这样的过程式的命令，你只需要向 K8s 描述“我需要 10 个容器”。10 个容器是我期望的最终状态，我不管怎么执行命令，执行了多少次命令等过程，我想要的就是这个结果。</p><p><strong>用来向 K8s 描述“期望最终状态”的文件，就叫做 K8s Manifest，也可以称之为清单文件。</strong>Manifest 就好比餐厅的菜单，你只管点菜，做菜的过程我不管。</p><p>到这里，我们引出了第一个概念：<strong>Manifest。</strong>简单地说，它是用来描述如何将容器镜像部署到集群中的。Manifest 的概念非常重要，它会贯穿整个 K8s 的生态系统，所以请你务必要理解。</p><p><strong>现在，假设我们有了一个 Manifest，我要如何告诉 K8s呢？换句话说，我们怎么和 K8s 交流？这时候我们需要引入一个工具：Kubectl。</strong></p><p>Kubectl 是一个与 K8s 集群交互的工具，通过 Kubectl，我们可以非常方便地以 Manifest 为媒介操作 K8s 集群的对象。就像操作数据库一样，我们可以对 Manifest 所描述的对象进行创建、删除、修改、查找等操作。</p><p>接下来，我们从编写 Manifest 开始，看看怎么将上节课制作的容器镜像部署到 K8s 集群中。</p><h3>部署容器镜像到 K8s</h3><p>要将容器镜像部署到 K8s 集群中，我们首先需要书写 Manifest。我们需要将下面的内容保存为 flask-pod.yaml：</p><pre><code class=\"language-yaml\">apiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999/hello-world-flask:latest\n      ports:\n        - containerPort: 5000\n</code></pre><p>接下来，我们通过 kubectl apply 应用这段 Manifest：</p><pre><code class=\"language-powershell\">$ kubectl apply -f flask-pod.yaml\npod/hello-world-flask created\n</code></pre><p>需要注意的是，当使用 Kind 创建集群后，它会自动配置 Kubectl 和 Kind 集群的连接。如果连接配置不正确，你可以执行 kind export kubeconfig 来切换集群连接的上下文。</p><p>如果成功看到输出内容 pod/hello-world-flask created，说明我们已经把这段 Manifest 提交到集群里了。参数 -f 表示“指定一个 Manifest 文件”。</p><p>也就是说，<strong>当我们想要向 K8s 提交 Manifest 的时候，只需要记住一条命令，那就是 kubectl apply。</strong></p><p>我们对上面的 Manifest 做一些必要的解释。其实这里只需要聚焦四个字段，分别是<strong>Kind、Containers、Image、Ports。</strong></p><p>Kind 字段表示 K8s 的工作负载类型。在 K8s 中，我们不能像 Docker 一样直接运行一个容器镜像，镜像需要依赖于 K8s 更上层的封装方式运行，这种封装方式也就是工作负载，Pod 是工作负载的一种类型。</p><p>每个工作负载有自己的名字，也就是 Metadata 节点下的 Name 字段。</p><p>为了更好地帮助你理解，我们可以把 Pod 类比成虚拟化技术中的 VM ，或者是 Docker 技术的容器，它们都是一种调度对象，如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/81/d6/815da454855183b74507910ee3e567d6.jpg?wh=1920x875\" alt=\"图片\"></p><p><strong>在实际的项目中，我们一般不会直接创建 Pod 类型的工作负载</strong>，而是会通过其它的工作负载间接创建它们。如果你现在还不能理解 Pod 的概念也没关系，只需要记住<strong>它是 K8s 调度的最小单位就可以了。</strong></p><p>Containers 字段代表 Pod 要运行的容器配置，例如名称、镜像和端口等。细心的你会注意到，它是一个数组类型，这意味着我们可以在一个 Pod 里面配置多个容器。</p><p>Image 字段表示容器镜像。显然，这里我们希望启动的是上节课制作的镜像，也就是 lyzhang1999/hello-world-flask。需要注意将这里的 lyzhang1999 替换为你自己的 docker hub 账户 ID。</p><p>Ports 字段表示容器要暴露的端口。它有点像我们在上节课提到的启动镜像时暴露的容器端口，也就是 docker run 的 p 参数。很显然我们希望暴露 5000 端口，也就是业务进程的监听端口。</p><p><strong>接下来，我们继续回到实战环节。</strong></p><p>当我们把 Manifest 部署到 K8s 集群之后，会面临两个问题：</p><ol>\n<li>如何查看刚才提交的 Pod？</li>\n<li>如何访问 Pod？</li>\n</ol><h3>查看和访问 Pod</h3><p>先看第一个问题。要查看 K8s 集群正在运行中的 Pod，你可以使用 kubectl get pods ：</p><pre><code class=\"language-powershell\">$ kubectl get pods\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; READY&nbsp; &nbsp;STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE\nhello-world-flask&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1m\n</code></pre><p>可以看到，结果中返回了刚才部署名为 hello-world-flask 的 Pod，状态为“运行中”。还记得上节课我们提到怎么查看运行中容器的命令吗？是不是非常类似？</p><p>接下来我们尝试访问 Pod。要在本地访问集群内的 Pod，我们可以使用 kubectl port-forward 命令进行端口转发操作，打通容器和本地网络：</p><pre><code class=\"language-powershell\">$ kubectl port-forward pod/hello-world-flask 8000:5000\nForwarding from 127.0.0.1:8000 -&gt; 5000\nForwarding from [::1]:8000 -&gt; 5000\n</code></pre><p>你可能会问，既然已经在 Manifest 里定义了 Ports 参数，为什么还需要进行端口转发操作呢？那是因为 Ports 参数只定义了 Pod 在集群内部暴露的端口，这个端口可以在集群内部进行访问。<strong>但我们本地和集群的网络是隔离的，自然不能在集群外部，也就是本地电脑访问 Pod。</strong></p><p>执行 kubectl port-forward 之后，我们打开浏览器访问 127.0.0.1:8000 就可以看到输出了：</p><pre><code class=\"language-powershell\">Hello, my first docker images! hello-world-flask\n</code></pre><p>需要注意的是，端口转发的进程是在前台运行的，你可以使用 ctrl+c 终止转发进程。</p><p>除了访问 Pod 以外，上节课我们还提到可以用 docker exec 进入运行中的容器。同样，我们也可以进入到 Pod 运行中的容器内。</p><p><strong>你可以使用 kubectl exec 进入到 Pod 容器内部：</strong></p><pre><code class=\"language-powershell\">$ kubectl exec -it hello-world-flask -- bash\nroot@hello-world-flask:/app#\n</code></pre><p>可以看到，这里的 -it 参数和 docker exec 的参数是完全一致的。在进入容器后，你可以试着像第一节课那样，修改 app.py 的输出，保存后刷新浏览器，观察一下是不是也能立即看到修改结果呢？</p><p>最后，我们可以通过 kubectl delete 命令来删除 Pod：</p><pre><code class=\"language-powershell\">$ kubectl delete pod hello-world-flask\npod \"hello-world-flask\" deleted\n</code></pre><p>到这里，我们就完成了将容器镜像部署到 K8s，还有查看、访问和删除 Pod 这一系列操作。</p><h3>业务进程、容器镜像和工作负载之间的关系</h3><p>通过上面的实战，我们将一个容器镜像以工作负载的方式部署到了 K8s 集群中。那么如果再往前追溯到业务层面，业务进程、容器镜像和工作负载之间的关系又是怎么样的呢？</p><p>当我初次接触 K8s 的时候，我对业务进程、容器镜像和工作负载层层封装，以及他们相互之间的关系感到非常疑惑。或许你也有同样的疑问，我为你总结了一张图，可以帮助你梳理一下它们之间的关系。</p><p><img src=\"https://static001.geekbang.org/resource/image/9d/49/9d6f6144eff75c8ceac58372dd58c749.jpg?wh=1920x1160\" alt=\"图片\"></p><p>通过这张图可以看出，最内层是我们的业务应用进程，外层通过 Docker 镜像以容器化的形式运行，再往外是 K8s 的最小调度单位 Pod。</p><h2>总结</h2><p>这节课，我们通过 Kind 在本地创建了一个 K8s 集群。同时，在将容器镜像部署到 K8s 集群的过程中，我还给你介绍了 Manifest 以及 K8s 的最小调度单位 Pod 的概念。</p><p>此外，我们还介绍了与 K8s 集群交互的工具 Kubectl 及其简单操作，例如向集群提交 Manifest、端口转发、查看、进入以及删除 Pod 等。</p><p>最后，我们还梳理了业务进程、镜像、容器和 Pod 之间的关系，理解它们将有助于你未来学习 K8s 的其他复杂概念。</p><p>到这里，你可能会问：学习了这么多概念，也花了这么多努力把容器镜像部署到了 K8s 集群，可是为什么还没看到 K8s 究竟能给我们带来什么实际的好处呢？</p><p>别着急，下节课，我会带你直观地感受 K8s 的魅力和强大之处：<strong>自动扩容和自愈。</strong></p><h2>思考题</h2><p>最后，给你留两道思考题吧。</p><ol>\n<li>Kind 的全称是 Kubernetes in Docker，它的设计理念非常有意思。请你结合相关资料，说一说你对它的理解。</li>\n<li>请你尝试为 hello-world-flask Pod 增加第二个容器，镜像为 nginx，端口为 80，并通过端口转发访问 Nginx Pod。</li>\n</ol><p>欢迎你给我留言交流讨论，你也可以把这节课分享给更多的朋友。我们下节课见。</p>","neighbors":{"left":{"article_title":"01｜如何将业务代码构建为容器镜像？","id":612566},"right":{"article_title":"03 | 业务永不宕机，K8s如何实现自动扩容和自愈？","id":612574}},"comments":[{"had_liked":false,"id":364496,"user_name":"陈志成","can_delete":false,"product_type":"c1","uid":1150083,"ip_address":"广东","ucode":"4ACAC378EA2735","user_header":"https://static001.geekbang.org/account/avatar/00/11/8c/83/1974d757.jpg","comment_is_top":false,"comment_ctime":1671030985,"is_pvip":true,"replies":[{"id":132509,"content":"幽默又不失知识点，优秀！","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671095418,"ip_address":"广东","comment_id":364496,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"kind 有很多设计理念，比如\n1. 优雅降级\n因为 kind 是专为测试 k8s 设计的，所以自身很顽强。支持所有的 k8s 官方版本，并且如其名字所示，docker 里搞出来的 k8s，集群依赖的所有的镜像都打包在了它的节点镜像里，厉害的是，如果这些镜像损坏了或者丢失了，节点镜像还能帮你重新拉下来，真是打不死的小强。\n2. 不重复发明轮子\n虽然现在已经有了很多功能类似的软件，比如大名鼎鼎的 kubeadm，但是 kind 并不是来搅局的，他很谦虚的抱着协作的态度，能复用就复用，站稳巨人的肩膀，专注解决痛点，合作共赢。\n3. 最小化假设\nkind 表示只要求安装 docker 即可，剩下的就交给我了。避免做出任何不必要的假设，minikube 表示，你礼貌吗？\n4. 封闭原则，无状态原则\n力求操作幂等、避免依赖外部服务，本身不存储或管理状态。好家伙，低内聚，高耦合，本身还没有副作用，不愧是 kind，确实很友好。\n5. 避免伤害用户，遵循 k8s API 约定\n啥？还有这原则。来看看都啥内容，避免配置和命令行接口的不兼容性修改，严格遵守 k8s 的弃用政策，面向外部的特性考虑扩展性以及长期支持性，使用 k8s 的配置风格，减少参数个数...一上来就海誓山盟还真是不习惯。\n另外还有自动化和支持 CRI，感兴趣的可以了解了解 https:&#47;&#47;kind.sigs.k8s.io&#47;docs&#47;design&#47;principles&#47;\n\n","like_count":17,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596579,"discussion_content":"幽默又不失知识点，优秀！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671095418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364795,"user_name":"Librant","can_delete":false,"product_type":"c1","uid":1210476,"ip_address":"广东","ucode":"08173F7B9994C1","user_header":"https://static001.geekbang.org/account/avatar/00/12/78/6c/be47a916.jpg","comment_is_top":false,"comment_ctime":1671507597,"is_pvip":false,"replies":[{"id":132838,"content":"赞！","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671521086,"ip_address":"广东","comment_id":364795,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"每节课我都做了实验，有需要的可以参考，写的比较详细，github.com&#47;librant&#47;git-ops-learn，觉得有用帮忙star一下嘞","like_count":6,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597192,"discussion_content":"赞！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671521087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364377,"user_name":"fireshort","can_delete":false,"product_type":"c1","uid":1008312,"ip_address":"广东","ucode":"10550CA9C6C730","user_header":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","comment_is_top":false,"comment_ctime":1670913230,"is_pvip":false,"replies":[{"id":132497,"content":"✅","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671093631,"ip_address":"广东","comment_id":364377,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"Kind还没有看。\n\n说一下思考题2：\n将 flask-pod.yaml 更新为：\napiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999&#47;hello-world-flask:latest\n      ports:\n        - containerPort: 5000\n    - name: nginx\n      image: nginx:1.23.2\n      ports:\n        - containerPort: 80\n\n执行 kubectl apply -f .\\flask-pod.yaml 就可以。\n端口转发：kubectl port-forward pod&#47;hello-world-flask 80:80","like_count":4,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596565,"discussion_content":"✅","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671093631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380260,"user_name":"Yang","can_delete":false,"product_type":"c1","uid":3707300,"ip_address":"北京","ucode":"6DA1BA4F20D487","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/j7R1I8LzLicpbZRDA3zKDWamTC9lPgdXL751899vhHLpj81q4rnjuibF5icId6kLjictDmmB0qI6PSeqQVU9XJh473SUgR51Gniaj5B0I5WppOKE/132","comment_is_top":false,"comment_ctime":1693285115,"is_pvip":false,"replies":[{"id":138485,"content":"看着是机器的问题，可以开通一个云厂商的竞价型vm做实验。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1693297279,"ip_address":"广东","comment_id":380260,"utype":1}],"discussion_count":2,"race_medal":1,"score":2,"product_id":100312001,"comment_content":" kind create的时候这个错误是什么原因\n✓ Ensuring node image (kindest&#47;node:v1.27.3) 🖼 \n ✗ Preparing nodes 📦  \nDeleted nodes: [&quot;kind-control-plane&quot;]\nERROR: failed to create cluster: command &quot;docker run --name kind-control-plane --hostname kind-control-plane --label io.x-k8s.kind.role=control-plane --privileged --security-opt seccomp=unconfined --security-opt apparmor=unconfined --tmpfs &#47;tmp --tmpfs &#47;run --volume &#47;var --volume &#47;lib&#47;modules:&#47;lib&#47;modules:ro -e KIND_EXPERIMENTAL_CONTAINERD_SNAPSHOTTER --detach --tty --label io.x-k8s.kind.cluster=kind --net kind --restart=on-failure:1 --init=false --cgroupns=private --publish=0.0.0.0:80:80&#47;TCP --publish=0.0.0.0:443:443&#47;TCP --publish=127.0.0.1:43015:6443&#47;TCP -e KUBECONFIG=&#47;etc&#47;kubernetes&#47;admin.conf kindest&#47;node:v1.27.3@sha256:3966ac761ae0136263ffdb6cfd4db23ef8a83cba8a463690e98317add2c9ba72&quot; failed with error: exit status 125\nCommand Output: WARNING: Your kernel does not support cgroup namespaces.  Cgroup namespace setting discarded.\n47a75af79038f24098f20854447af6a83bc5a0037aea8dc6e2d7cb0706d57493\ndocker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: cgroup namespaces aren&#39;t enabled in the kernel: unknown.\n","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626715,"discussion_content":"看着是机器的问题，可以开通一个云厂商的竞价型vm做实验。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693297279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1442097,"avatar":"https://static001.geekbang.org/account/avatar/00/16/01/31/4d116521.jpg","nickname":"鹏鹏哥","note":"","ucode":"28452AB202EA9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635756,"discussion_content":"是内核不支持导致，可以试着升级内核后再试试，具体步骤可以参考（CentOS7.9）：\n\n#1 更新系统，确保所有安装的包都是最新的\nsudo yum update\n#2安装 elrepo 仓库，该仓库提供了最新的稳定内核\nsudo rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nsudo yum install -y https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm\n#3 安装新的内核（例如，最新的稳定版本是 kernel-ml）\nsudo yum --enablerepo=elrepo-kernel install kernel-ml -y\n#4 更新GRUB引导菜单\nsudo grub2-mkconfig -o /boot/grub2/grub.cfg\n#5 修改默认引导顺序，使新内核成为默认引导\nsudo grub2-set-default 0\n#6 重新启动系统，确认新内核成功安装并生效\nsudo reboot","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1705135684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365021,"user_name":"加多","can_delete":false,"product_type":"c1","uid":1101824,"ip_address":"广东","ucode":"B2192A2D58C444","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/00/9d05af66.jpg","comment_is_top":false,"comment_ctime":1671951808,"is_pvip":false,"replies":[{"id":132913,"content":"是的，一般我们认为云原生技术的核心是 Docker 和 K8s。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1672021800,"ip_address":"广东","comment_id":365021,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"云原生 和k8s之间是什么关系那？我理解k8s是实现云原生的一个工具？","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597554,"discussion_content":"是的，一般我们认为云原生技术的核心是 Docker 和 K8s。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1672021800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1675966,"avatar":"https://static001.geekbang.org/account/avatar/00/19/92/be/8de4e1fe.jpg","nickname":"kaizen","note":"","ucode":"313EEA97AEC7C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597649,"discussion_content":"云原生其实就是云厂商提出的，将 app留在云上，如何留，把除了 app 以外你需要考虑的事情我都给你做了，你只需要把 app 云上来即可，基于此目的而去探索各种技术和需求，最后的产出就是云原生产物，k8s则像孕育这些云原生产品或者技术的底座一般的存在吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672127670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380261,"user_name":"Yang","can_delete":false,"product_type":"c1","uid":3707300,"ip_address":"北京","ucode":"6DA1BA4F20D487","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/j7R1I8LzLicpbZRDA3zKDWamTC9lPgdXL751899vhHLpj81q4rnjuibF5icId6kLjictDmmB0qI6PSeqQVU9XJh473SUgR51Gniaj5B0I5WppOKE/132","comment_is_top":false,"comment_ctime":1693287229,"is_pvip":false,"replies":[{"id":138486,"content":"推荐使用云厂商的vm来做实验。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1693297321,"ip_address":"广东","comment_id":380261,"utype":1}],"discussion_count":4,"race_medal":1,"score":2,"product_id":100312001,"comment_content":"请问是不是开一台香港的云服务器就可以进行本课程的所有实验呢，ERROR: failed to create cluster: command &quot;docker run --name kind-control-plane --hostname kind-control-plane --label io.x-k8s.kind.role=control-plane --privileged --security-opt seccomp=unconfined --security-opt apparmor=unconfined --tmpfs &#47;tmp --tmpfs &#47;run --volume &#47;var --volume &#47;lib&#47;modules:&#47;lib&#47;modules:ro -e KIND_EXPERIMENTAL_CONTAINERD_SNAPSHOTTER --detach --tty --label io.x-k8s.kind.cluster=kind --net kind --restart=on-failure:1 --init=false --cgroupns=private --publish=0.0.0.0:80:80&#47;TCP --publish=0.0.0.0:443:443&#47;TCP --publish=127.0.0.1:43015:6443&#47;TCP -e KUBECONFIG=&#47;etc&#47;kubernetes&#47;admin.conf kindest&#47;node:v1.27.3@sha256:3966ac761ae0136263ffdb6cfd4db23ef8a83cba8a463690e98317add2c9ba72&quot; failed with error: exit status 125\ndocker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: cgroup namespaces aren&#39;t enabled in the kernel: unknown.\n这个错误是什么原因","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626716,"discussion_content":"推荐使用云厂商的vm来做实验。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693297321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":3,"child_discussions":[{"author":{"id":3707300,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/j7R1I8LzLicpbZRDA3zKDWamTC9lPgdXL751899vhHLpj81q4rnjuibF5icId6kLjictDmmB0qI6PSeqQVU9XJh473SUgR51Gniaj5B0I5WppOKE/132","nickname":"Yang","note":"","ucode":"6DA1BA4F20D487","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":626718,"discussion_content":"分别用阿里云华为云和自己电脑的vmware创建虚拟机 三次都有这个一模一样问题。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693298089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626716,"ip_address":"北京","group_id":0},"score":626718,"extra":""},{"author":{"id":3707300,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/j7R1I8LzLicpbZRDA3zKDWamTC9lPgdXL751899vhHLpj81q4rnjuibF5icId6kLjictDmmB0qI6PSeqQVU9XJh473SUgR51Gniaj5B0I5WppOKE/132","nickname":"Yang","note":"","ucode":"6DA1BA4F20D487","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":626719,"discussion_content":"请问您用的操作系统版本 和linux内核版本是多少？您是用的哪家云主机，想参考一下。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693298213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626716,"ip_address":"北京","group_id":0},"score":626719,"extra":""},{"author":{"id":3707300,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/j7R1I8LzLicpbZRDA3zKDWamTC9lPgdXL751899vhHLpj81q4rnjuibF5icId6kLjictDmmB0qI6PSeqQVU9XJh473SUgR51Gniaj5B0I5WppOKE/132","nickname":"Yang","note":"","ucode":"6DA1BA4F20D487","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":626724,"discussion_content":"这是只能在物理机上实验么，云厂商的试了都报这个错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693301212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626716,"ip_address":"北京","group_id":0},"score":626724,"extra":""}]}]},{"had_liked":false,"id":379436,"user_name":"Pin","can_delete":false,"product_type":"c1","uid":1096408,"ip_address":"上海","ucode":"250D0639EF69AF","user_header":"https://static001.geekbang.org/account/avatar/00/10/ba/d8/4a1bc4b5.jpg","comment_is_top":false,"comment_ctime":1691973712,"is_pvip":false,"replies":[{"id":138237,"content":"看起来是 Kind 没启动导致的，连不上集群。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1692008308,"ip_address":"广东","comment_id":379436,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"执行kubectl cluster-info --context kind-kind后报错\n\nTo further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.\nThe connection to the server 127.0.0.1:58723 was refused - did you specify the right host or port?\n\n请问这个问题怎么解决？","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625637,"discussion_content":"看起来是 Kind 没启动导致的，连不上集群。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692008309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374097,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1085659,"ip_address":"四川","ucode":"588EBC835D34B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/90/db/8429cdfa.jpg","comment_is_top":false,"comment_ctime":1683601303,"is_pvip":false,"replies":[{"id":136642,"content":"👍🏻","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1683625949,"ip_address":"广东","comment_id":374097,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"## 安装K8S仪表盘，方便对K8S网络进行管理和检查\n\n首先要科学上网，然后执行如下命令：\n\n```powershell\nkubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v2.7.0&#47;aio&#47;deploy&#47;recommended.yaml\n```\n\n执行如下命令创建一个连接到你的 K8S 集群的 Web 服务器（执行这个命令的窗口不能关）：\n\n```powershell\nkubectl proxy\n```\n\n创建 dashboard-adminuser.yaml 文件，内容如下，用来创建用户：\n\n```yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: admin-user\n  namespace: kubernetes-dashboard\n---\napiVersion: rbac.authorization.k8s.io&#47;v1\nkind: ClusterRoleBinding\nmetadata:\n  name: admin-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: admin-user\n  namespace: kubernetes-dashboard\n```\n\n然后在 Windows PowerShell 中执行如下命令，创建用户： \n\n```powershell\nkubectl apply -f dashboard-adminuser.yaml\n```\n\n执行如下命令，获取用户的登录令牌，每次登录都需要使用下面的命令来获取登录令牌：\n\n```powershell\nkubectl -n kubernetes-dashboard create token admin-user\n```\n\n打开浏览器访问 [http:&#47;&#47;localhost:8001&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;https:kubernetes-dashboard:&#47;proxy&#47;](http:&#47;&#47;localhost:8001&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;https:kubernetes-dashboard:&#47;proxy&#47;) 用上一步骤获取到的用户令牌登录管理控制台。","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617513,"discussion_content":"👍🏻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683625949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372202,"user_name":"渣渣辉","can_delete":false,"product_type":"c1","uid":1911235,"ip_address":"日本","ucode":"730838D9161579","user_header":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1680843321,"is_pvip":false,"replies":[{"id":135839,"content":"👍🏻非常细致的回答！","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1680862384,"ip_address":"广东","comment_id":372202,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"第一题\nKubernetes in Docker（Kind）是一个用于在 Docker 容器中运行 Kubernetes 集群的工具。它的设计理念是简化本地 Kubernetes 集群的部署和测试过程，特别是在持续集成（CI）环境中。使用 Kind，用户可以轻松地在本地机器或 CI 环境中创建和管理 Kubernetes 集群。\n\nKind 的主要优势在于它的便捷性和速度。由于它在 Docker 容器中运行 Kubernetes 集群，因此无需在物理机器或虚拟机上配置和管理复杂的 Kubernetes 环境。这使得 Kind 成为开发和测试 Kubernetes 应用程序的理想工具。\n\nKind 的工作原理是利用 Docker 提供的节点镜像，这些镜像包含了运行 Kubernetes 所需的所有组件。创建集群时，Kind 会启动一个或多个 Docker 容器，每个容器代表一个 Kubernetes 节点。这些节点通过 Docker 网络进行通信，并由 Kind 自动配置。这使得 Kubernetes 集群的创建和管理变得非常简单。\n\n总之，Kubernetes in Docker（Kind）是一个简化本地 Kubernetes 集群部署和测试的工具，它在 Docker 容器中运行 Kubernetes 集群，使得开发和测试过程更加高效和便捷。\n\n第二题\napiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999&#47;hello-world-flask:latest\n      ports:\n        - containerPort: 5000\n    # 添加nginx\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n        \n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612714,"discussion_content":"👍🏻非常细致的回答！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680862385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369479,"user_name":"tee","can_delete":false,"product_type":"c1","uid":1628215,"ip_address":"湖南","ucode":"82E8D03E34ADAD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIYeenVcfUP2PhW4V1y4EDptWibKBDia8lpic1KUuqaXwuydbyrnfXq9Emfbjxkddf10X6tk7vCTA6Fw/132","comment_is_top":false,"comment_ctime":1677577276,"is_pvip":false,"replies":[{"id":134671,"content":"另外检查一下本地是否有全局代理。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1677639058,"ip_address":"广东","comment_id":369479,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"kind 拉起集群之后  apiserver提示 tls链接被对端断开了。","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607141,"discussion_content":"另外检查一下本地是否有全局代理。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677639058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369478,"user_name":"tee","can_delete":false,"product_type":"c1","uid":1628215,"ip_address":"湖南","ucode":"82E8D03E34ADAD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIYeenVcfUP2PhW4V1y4EDptWibKBDia8lpic1KUuqaXwuydbyrnfXq9Emfbjxkddf10X6tk7vCTA6Fw/132","comment_is_top":false,"comment_ctime":1677576756,"is_pvip":false,"replies":[{"id":134667,"content":"看起来是 KiND 没有启动完成，可以通过 docker ps 查看一下容器的运行情况。如果实在无法启动，也可以尝试用 Minikube 来搭建 Kubernetes 集群。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1677638186,"ip_address":"广东","comment_id":369478,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"kubectl cluster-info --context kind-kind\nE0228 17:26:40.271993   14830 memcache.go:238] couldn&#39;t get current server API group list: Get &quot;https:&#47;&#47;127.0.0.1:39221&#47;api?timeout=32s&quot;: read tcp 127.0.0.1:39118-&gt;127.0.0.1:39221: read: connection reset by peer - error from a previous attempt: read tcp 127.0.0.1:39100-&gt;127.0.0.1:39221: read: connection reset by peer\n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607136,"discussion_content":"看起来是 KiND 没有启动完成，可以通过 docker ps 查看一下容器的运行情况。如果实在无法启动，也可以尝试用 Minikube 来搭建 Kubernetes 集群。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677638186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366835,"user_name":"农民园丁","can_delete":false,"product_type":"c1","uid":1155913,"ip_address":"内蒙古","ucode":"6A91EBBC9DCE6C","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/49/4a488f4c.jpg","comment_is_top":false,"comment_ctime":1674400327,"is_pvip":false,"replies":[{"id":133921,"content":"公开权限的时候是 OK 的吗？","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1675416501,"ip_address":"广东","comment_id":366835,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"请问老师，将改为私有仓库（harbor）后，拉取镜像失败，提示&quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;: failed to do request: Head &quot;https:&#47;&#47;harbor.imustyckz.com:8443&#47;v2&#47;richey&#47;hello-world-flask&#47;manifests&#47;latest&quot;: x509: certificate signed by unknown authority\n在集群外面是可以拉取镜像的。\n怎么解决，可以给个思路吗？\n\nEvents:\n  Type     Reason     Age                From               Message\n  ----     ------     ----               ----               -------\n  Normal   Scheduled  29s                default-scheduler  Successfully assigned default&#47;hello-world-flask to kind-control-plane\n  Normal   Pulling    15s (x2 over 29s)  kubelet            Pulling image &quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;\n  Warning  Failed     15s (x2 over 29s)  kubelet            Failed to pull image &quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;: rpc error: code = Unknown desc = failed to pull and unpack image &quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;: failed to resolve reference &quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;: failed to do request: Head &quot;https:&#47;&#47;harbor.imustyckz.com:8443&#47;v2&#47;richey&#47;hello-world-flask&#47;manifests&#47;latest&quot;: x509: certificate signed by unknown authority\n  Warning  Failed     15s (x2 over 29s)  kubelet            Error: ErrImagePull\n  Normal   BackOff    2s (x2 over 28s)   kubelet            Back-off pulling image &quot;harbor.imustyckz.com:8443&#47;richey&#47;hello-world-flask:latest&quot;\n  Warning  Failed     2s (x2 over 28s)   kubelet            Error: ImagePullBackOff","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601826,"discussion_content":"公开权限的时候是 OK 的吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675416502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365493,"user_name":"bob","can_delete":false,"product_type":"c1","uid":2057134,"ip_address":"广东","ucode":"26E2840FB5C048","user_header":"https://static001.geekbang.org/account/avatar/00/1f/63/ae/eb536e1d.jpg","comment_is_top":false,"comment_ctime":1672669678,"is_pvip":false,"replies":[{"id":133137,"content":"尝试参考这个文档使用本地私有仓库：https:&#47;&#47;kind.sigs.k8s.io&#47;docs&#47;user&#47;local-registry&#47;","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1672713041,"ip_address":"广东","comment_id":365493,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"请问各位大佬，使用kind搭建的k8s，在拉取私库镜像时怎么报错超时了？&#47;etc&#47;docker&#47;daemon.json已经设置了（&quot;insecure-registries&quot;:[&quot;192.168.10.116:80&quot;]）\nEvents:\n  Type     Reason     Age                  From               Message\n  ----     ------     ----                 ----               -------\n  Normal   Scheduled  4m25s                default-scheduler  Successfully assigned default&#47;hello-world-flask to kind-control-plane\n  Normal   Pulling    88s (x4 over 4m24s)  kubelet            Pulling image &quot;192.168.10.116:80&#47;repo&#47;hello-world-flask&quot;\n  Warning  Failed     58s (x4 over 3m54s)  kubelet            Failed to pull image &quot;192.168.10.116:80&#47;repo&#47;hello-world-flask&quot;: rpc error: code = Unknown desc = failed to pull and unpack image &quot;192.168.10.116:80&#47;repo&#47;hello-world-flask:latest&quot;: failed to resolve reference &quot;192.168.10.116:80&#47;repo&#47;hello-world-flask:latest&quot;: failed to do request: Head &quot;https:&#47;&#47;192.168.10.116:80&#47;v2&#47;repo&#47;hello-world-flask&#47;manifests&#47;latest&quot;: dial tcp 192.168.10.116:80: i&#47;o timeout\n  Warning  Failed     58s (x4 over 3m54s)  kubelet            Error: ErrImagePull\n  Warning  Failed     46s (x6 over 3m53s)  kubelet            Error: ImagePullBackOff\n  Normal   BackOff    32s (x7 over 3m53s)  kubelet            Back-off pulling image &quot;192.168.10.116:80&#47;repo&#47;hello-world-flask&quot;\n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598243,"discussion_content":"尝试参考这个文档使用本地私有仓库：https://kind.sigs.k8s.io/docs/user/local-registry/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672713042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2057134,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/63/ae/eb536e1d.jpg","nickname":"bob","note":"","ucode":"26E2840FB5C048","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":598265,"discussion_content":"谢谢老师！这样做是可以，不过操作起来要多几步。我是按以下步骤做的：\n1、在kind k8s（192.168.10.200）运行机器上先使用docker pull 指令从私库（192.168.10.116:80）拉取镜像到本地；\n2、将上一步拉取的镜像打上kind 的local-registry 仓库标签；\n3、将最新打完标签的镜像推送到kind 的local-registry 仓库；\n4、在待部署pod 的yaml 文件中指定镜像来自kind 的local-registry 仓库。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672721433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":598243,"ip_address":"广东","group_id":0},"score":598265,"extra":""}]}]},{"had_liked":false,"id":365460,"user_name":"燕去鸿归","can_delete":false,"product_type":"c1","uid":1440004,"ip_address":"广东","ucode":"6D2269CEAF24EE","user_header":"https://static001.geekbang.org/account/avatar/00/15/f9/04/d53db7d7.jpg","comment_is_top":false,"comment_ctime":1672585215,"is_pvip":false,"replies":[{"id":133126,"content":"你可以使用 kubectl 命令行工具来访问集群对象。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1672634136,"ip_address":"广东","comment_id":365460,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"我执行kubectl cluster-info --context kind-kind \n然后访问https:&#47;&#47;127.0.0.1:52857&#47;，403 了\n{\n  &quot;kind&quot;: &quot;Status&quot;,\n  &quot;apiVersion&quot;: &quot;v1&quot;,\n  &quot;metadata&quot;: {},\n  &quot;status&quot;: &quot;Failure&quot;,\n  &quot;message&quot;: &quot;forbidden: User \\&quot;system:anonymous\\&quot; cannot get path \\&quot;&#47;\\&quot;&quot;,\n  &quot;reason&quot;: &quot;Forbidden&quot;,\n  &quot;details&quot;: {},\n  &quot;code&quot;: 403\n}","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598155,"discussion_content":"你可以使用 kubectl 命令行工具来访问集群对象。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672634136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364986,"user_name":"booboo","can_delete":false,"product_type":"c1","uid":1016502,"ip_address":"广东","ucode":"A6670358603D7D","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRibTnDs0ZjFrAtfzcwDDFnaX1DEY8qKoFczP8e8ucAdTr7C33bYFDYxpN8VRhgEVsDrBwILO8Msw/132","comment_is_top":false,"comment_ctime":1671853803,"is_pvip":false,"replies":[{"id":132898,"content":"尝试先用 kubectl delete pod hello-world-flask 删除旧的 Pod，再修改 Yaml 增加新的容器并重新 Apply。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671942059,"ip_address":"广东","comment_id":364986,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"添加完nginx之后执行 kubectl apply -f flask-pod.yaml 为什么会报下面的错？\nThe Pod &quot;hello-world-flask&quot; is invalid: spec.containers: Forbidden: pod updates may not add or remove containers","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597509,"discussion_content":"尝试先用 kubectl delete pod hello-world-flask 删除旧的 Pod，再修改 Yaml 增加新的容器并重新 Apply。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671942059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364984,"user_name":"booboo","can_delete":false,"product_type":"c1","uid":1016502,"ip_address":"广东","ucode":"A6670358603D7D","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRibTnDs0ZjFrAtfzcwDDFnaX1DEY8qKoFczP8e8ucAdTr7C33bYFDYxpN8VRhgEVsDrBwILO8Msw/132","comment_is_top":false,"comment_ctime":1671853229,"is_pvip":false,"replies":[{"id":132899,"content":"尝试修改 App.py 中 return 的字符串，例如删除 Hello，保存后再使用 cat 命令确认一下文件内容修改是否成功修改。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671942389,"ip_address":"广东","comment_id":364984,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"修改 app.py 的输出，保存后刷新浏览器，看不到修改的结果。","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597510,"discussion_content":"尝试修改 App.py 中 return 的字符串，例如删除 Hello，保存后再使用 cat 命令确认一下文件内容修改是否成功修改。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671942389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364777,"user_name":"ghostwritten","can_delete":false,"product_type":"c1","uid":1308196,"ip_address":"广东","ucode":"AE512F2E24A1A0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/24/547439f1.jpg","comment_is_top":false,"comment_ctime":1671468521,"is_pvip":false,"replies":[{"id":132833,"content":"👍🏻👍🏻","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671505233,"ip_address":"广东","comment_id":364777,"utype":1}],"discussion_count":1,"race_medal":1,"score":3,"product_id":100312001,"comment_content":"1. 快速部署 kubernetes 除了 [kind](https:&#47;&#47;blog.csdn.net&#47;xixihahalelehehe&#47;article&#47;details&#47;121968488)\n还有：\n - [sealo](https:&#47;&#47;blog.csdn.net&#47;xixihahalelehehe&#47;article&#47;details&#47;127319638)\n - [minikube](https:&#47;&#47;blog.csdn.net&#47;xixihahalelehehe&#47;article&#47;details&#47;123796854)\n - [k3s](https:&#47;&#47;blog.csdn.net&#47;xixihahalelehehe&#47;article&#47;details&#47;127691897)\n\n访问pod：port-forward属于 NodePort，service还包含：NodePort、ClusterIP、LoadBalancer、\n\n创建第二个容器：\napiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999&#47;hello-world-flask:latest\n      ports:\n        - containerPort: 5000\n    - name: flask\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n        \n kubectl apply -f flask-pod.yaml\n kubectl port-forward pod&#47;hello-world-flask 80:80\n\ncontainerPort是在pod控制器中定义的、pod中的容器需要暴露的端口\nport和nodePort都是service的端口，前者暴露给k8s集群内部服务访问，后者暴露给k8s集群外部流量访问","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597166,"discussion_content":"👍🏻👍🏻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671505233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364345,"user_name":"Jack","can_delete":false,"product_type":"c1","uid":1529319,"ip_address":"广东","ucode":"DB7A509E726220","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","comment_is_top":false,"comment_ctime":1670848815,"is_pvip":false,"replies":[{"id":132492,"content":"看起来是镜像拉取失败了，建议开一台香港 Linux 主机实验。","user_name":"作者回复","user_name_real":"编辑","uid":1275456,"ctime":1671092496,"ip_address":"广东","comment_id":364345,"utype":1}],"discussion_count":9,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"MacBook-Pro-2 gitOps % kubectl get pods                            \nNAME                READY   STATUS         RESTARTS   AGE\nhello-world-flask   0&#47;1     ErrImagePull   0          4s\n\n老师，kubectl apply -f flask-pod.yaml之后运行的结果是失败的，如上图。这个如何解决呢？\n\nflask-pod.yaml的配置文件如下：\napiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999&#47;hello-world-flask:latest\n      ports:\n        - containerPort: 5000","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596558,"discussion_content":"看起来是镜像拉取失败了，建议开一台香港 Linux 主机实验。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671092496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1529319,"avatar":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","nickname":"Jack","note":"","ucode":"DB7A509E726220","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"王炜","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":596591,"discussion_content":"好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671099846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596558,"ip_address":"广东","group_id":0},"score":596591,"extra":""}]},{"author":{"id":1179432,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ff/28/040f6f01.jpg","nickname":"Y","note":"","ucode":"952AA9B2CD91CE","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596499,"discussion_content":"多等一会自己会成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671034146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2314854,"avatar":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","nickname":"includestdio.h","note":"","ucode":"5027BACE9319CD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596292,"discussion_content":"网络原因导致镜像拉失败了吧，可以尝试先手动把镜像拉下来，再启Pod","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670859961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1529319,"avatar":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","nickname":"Jack","note":"","ucode":"DB7A509E726220","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2314854,"avatar":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","nickname":"includestdio.h","note":"","ucode":"5027BACE9319CD","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":596294,"discussion_content":"就是拉不下来 试了好多次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670862484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596292,"ip_address":"广东","group_id":0},"score":596294,"extra":""},{"author":{"id":1324227,"avatar":"https://static001.geekbang.org/account/avatar/00/14/34/c3/e2aeb23b.jpg","nickname":"Xiaoniu","note":"","ucode":"3B4D621170485B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1529319,"avatar":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","nickname":"Jack","note":"","ucode":"DB7A509E726220","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596298,"discussion_content":"实在不行，本地写好代码和dockerfile自己打包成本地镜像，替换掉image就可以吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670889531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596294,"ip_address":"江苏","group_id":0},"score":596298,"extra":""},{"author":{"id":1529319,"avatar":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","nickname":"Jack","note":"","ucode":"DB7A509E726220","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1324227,"avatar":"https://static001.geekbang.org/account/avatar/00/14/34/c3/e2aeb23b.jpg","nickname":"Xiaoniu","note":"","ucode":"3B4D621170485B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596362,"discussion_content":"还是不行喔","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670916920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596298,"ip_address":"日本","group_id":0},"score":596362,"extra":""}]}]},{"had_liked":false,"id":370108,"user_name":"dulp","can_delete":false,"product_type":"c1","uid":1314877,"ip_address":"中国香港","ucode":"4CFC3CB87A6640","user_header":"https://static001.geekbang.org/account/avatar/00/14/10/3d/b3991de7.jpg","comment_is_top":false,"comment_ctime":1678381806,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"Kind是一个非常有用的工具，可以帮助开发人员更轻松地使用Kubernetes构建和测试应用程序。其设计理念非常有趣，因为它提供了一种在本地机器上运行Kubernetes集群的方法，使开发人员可以更灵活地工作，同时节省时间和金钱成本。","like_count":1},{"had_liked":false,"id":364463,"user_name":"Promise","can_delete":false,"product_type":"c1","uid":1038646,"ip_address":"浙江","ucode":"3E07E270EED2E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/36/92d8eb91.jpg","comment_is_top":false,"comment_ctime":1670996164,"is_pvip":true,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"1. Kind是一个使用Docker容器 &quot;节点 &quot;运行本地Kubernetes集群的工具。 Kind主要是为测试Kubernetes本身而设计，但也可用于本地开发或CI。\n2. \napiVersion: v1\nkind: Pod\nmetadata:\n  name: hello-world-flask\nspec:\n  containers:\n    - name: flask\n      image: lyzhang1999&#47;hello-world-flask:latest\n      ports:\n        - containerPort: 5000\n    - name: flask\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n        \n kubectl apply -f flask-pod.yaml\n kubectl port-forward pod&#47;hello-world-flask 80:80\n\n其实可以使用Service和Ingress来访问Nginx Pod\n","like_count":1,"discussions":[{"author":{"id":2037522,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/YbUxEV3741vKZAiasOXggWucQbmicJwIjg3HDE58oyibYXbSop9QQFqZ7X6OhynDoo6rDHwzK8njSeJjN9hx3pJXg/132","nickname":"黄堃健","note":"","ucode":"B4AD5250A41B3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597650,"discussion_content":"两个相同的name：flask 有点问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672128149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383656,"user_name":"dj","can_delete":false,"product_type":"c1","uid":1512964,"ip_address":"北京","ucode":"F6803089067D80","user_header":"https://static001.geekbang.org/account/avatar/00/17/16/04/3168b413.jpg","comment_is_top":false,"comment_ctime":1699414465,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"\n安装没成功\ngitops$ kubectl cluster-info --context kind-kind\nerror: context &quot;kind-kind&quot; does not exist\ndj@cs5-mas1:~&#47;gitops$ kubectl  get node\nE1108 03:33:08.756618   25787 memcache.go:265] couldn&#39;t get current server API group list: Get &quot;http:&#47;&#47;localhost:8080&#47;api?timeout=32s&quot;: dial tcp 127.0.0.1:8080: connect: connection refused\nE1108 03:33:08.756962   25787 memcache.go:265] couldn&#39;t get current server API group list: Get &quot;http:&#47;&#47;localhost:8080&#47;api?timeout=32s&quot;: dial tcp 127.0.0.1:8080: connect: connection refused\nE1108 03:33:08.758311   25787 memcache.go:265] couldn&#39;t get current server API group list: Get &quot;http:&#47;&#47;localhost:8080&#47;api?timeout=32s&quot;: dial tcp 127.0.0.1:8080: connect: connection refused\nE1108 03:33:08.758516   25787 memcache.go:265] couldn&#39;t get current server API ","like_count":0},{"had_liked":false,"id":382365,"user_name":"靠人品去赢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"广东","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1697113653,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"最后这个图，是我看到把K8S和docker之间的关系说的最清楚的一个。最后在pod里套一层，多标出一个docker。","like_count":0}]}