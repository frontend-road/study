{"id":484631,"title":"åŠ é¤ä¸‰ | ä»€ä¹ˆæ˜¯â€œä¸å˜æ€§æ€ç»´â€ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ¶›ã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/472129\">å¼€ç¯‡è¯</a>é‡Œï¼Œæˆ‘æåˆ°è¿‡å­¦ä¹ Kotlinçš„äº”ç§æ€ç»´è½¬å˜ï¼ŒåŒ…æ‹¬å‰é¢åŠ é¤ä¸­è®²è¿‡çš„å‡½æ•°æ€ç»´ã€è¡¨è¾¾å¼æ€ç»´ï¼Œä»¥åŠæ¥ä¸‹æ¥è¦ç»™ä½ ä»‹ç»çš„ä¸å˜æ€§æ€ç»´ã€ç©ºå®‰å…¨æ€ç»´ä»¥åŠåç¨‹æ€ç»´ã€‚æ‰€ä»¥ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥èŠèŠKotlinçš„ä¸å˜æ€§æ€ç»´ã€‚</p><p>Kotlinå°†ä¸å˜æ€§çš„æ€æƒ³å‘æŒ¥åˆ°äº†æè‡´ï¼Œå¹¶å°†å…¶èå…¥åˆ°äº†è¯­æ³•å½“ä¸­ã€‚å½“å¼€å‘è€…æƒ³è¦å®šä¹‰ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå¿…é¡»æ˜ç¡®è§„å®šè¿™ä¸ªå˜é‡æ˜¯<strong>å¯å˜çš„</strong>ï¼ˆvarï¼‰ï¼Œè¿˜æ˜¯<strong>ä¸å¯å˜çš„</strong>ï¼ˆvalï¼‰ã€‚åœ¨å®šä¹‰é›†åˆå˜é‡çš„æ—¶å€™ï¼Œä¹ŸåŒæ ·éœ€è¦æ˜ç¡®è§„å®šè¿™ä¸ªé›†åˆæ˜¯å¯å˜çš„ï¼ˆæ¯”å¦‚MutableListï¼‰ï¼Œè¿˜æ˜¯ä¸å¯å˜çš„ï¼ˆæ¯”å¦‚Listï¼‰ã€‚</p><p>ä¸è¿‡ï¼Œä¸å˜æ€§å…¶å®ä¼šè¢«å¾ˆå¤šKotlinåˆå­¦è€…æ‰€å¿½ç•¥ã€‚å°¤å…¶æ˜¯æœ‰Javaã€Cç»éªŒçš„å¼€å‘è€…ï¼Œå¾ˆå®¹æ˜“å°†è€ä¸€å¥—æ€æƒ³ç…§æ¬åˆ°Kotlinå½“ä¸­æ¥ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå†™å‡ºæ¥çš„å˜é‡å…¨éƒ¨éƒ½æ˜¯varçš„ï¼Œå†™å‡ºæ¥çš„é›†åˆéƒ½æ˜¯MutableXXXã€‚</p><p>äº‹å®ä¸Šï¼Œä¸å˜æ€§æ€ç»´ï¼Œå¯¹æˆ‘ä»¬å†™å‡ºä¼˜é›…ä¸”ç¨³å®šçš„Kotlinä»£ç å¾ˆå…³é”®ã€‚è¦çŸ¥é“ï¼Œæˆ‘ä»¬ä»£ç ä¸­å¾ˆå¤šçš„Bugéƒ½æ˜¯å› ä¸ºæŸä¸ªå˜é‡è¢«å¤šä¸ªè°ƒç”¨æ–¹æ”¹æ¥æ”¹å»ï¼Œæœ€åå¯¼è‡´çŠ¶æ€é”™è¯¯æ‰å‡ºé—®é¢˜çš„ã€‚æ¯•ç«Ÿï¼Œå˜åŠ¨è¶Šå¤šï¼Œå°±è¶Šå®¹æ˜“å‡ºé”™ï¼</p><p><strong>é‚£ä¹ˆï¼Œæ—¢ç„¶å¯å˜æ€§è¿™ä¹ˆâ€œå¯æ¶â€ï¼Œæˆ‘ä»¬ä¸ºä½•ä¸å¹²è„†ç›´æ¥åœ¨è¯­æ³•å±‚é¢æ¶ˆç­varã€MutableXXXè¿™æ ·çš„æ¦‚å¿µå‘¢</strong>ï¼Ÿ</p><!-- [[[read_end]]] --><p>è¿™å½“ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç¨‹åºæœ¬èº«å°±æ˜¯â€œä¸ºäº†äº§ç”Ÿå˜åŒ–è€Œç”Ÿçš„â€ã€‚ä½ æƒ³æƒ³ï¼Œå¦‚æœä½ çš„ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæ”¹å˜ä»»ä½•æ•°æ®ï¼Œé‚£ç¨‹åºè¿è¡Œè¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿè€Œä¸”ä½ å¯ä»¥å†æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ²¡æœ‰å¯å˜æ€§ï¼Œä½ æ‰“æ¸¸æˆçš„æ—¶å€™ï¼Œç”»é¢æ ¹æœ¬å°±ä¸ä¼šåŠ¨å•Šï¼æ¸¸æˆæ•°æ®ä¸å˜ï¼Œç”»é¢è‡ªç„¶ä¹Ÿä¸ä¼šåŠ¨äº†ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œ<strong>æ‰€è°“ä¸å˜æ€§æ€ç»´ï¼Œæ˜¯ä¸€ç§åç›´è§‰çš„æ€è·¯</strong>ã€‚è¿™ä¹Ÿæ˜¯Kotlinä»å‡½æ•°å¼ç¼–ç¨‹é¢†åŸŸå€Ÿé‰´è¿‡æ¥çš„æ€æƒ³ã€‚åœ¨Kotlinå½“ä¸­ï¼Œæ‰€è°“çš„ä¸å˜æ€§æ€ç»´ï¼Œå…¶å®å°±æ˜¯åœ¨æ»¡è¶³ç¨‹åºåŠŸèƒ½å¯å˜æ€§éœ€æ±‚çš„åŒæ—¶ï¼Œå°½å¯èƒ½åœ°æ¶ˆç­å¯å˜æ€§ã€‚</p><p>è¿™é¢‡æœ‰ä¸€ç§â€œæˆ´ç€é•£é“è·³èˆâ€çš„æ„å‘³ã€‚å…¶å®æ¢å¥è¯ç†è§£ä¸€ä¸‹ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬åº”è¯¥ï¼šå°½å¯èƒ½æ¶ˆç­é‚£äº›<strong>éå¿…è¦</strong>å¯å˜æ€§ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹å‡ ä¸ªä»£ç æ¡ˆä¾‹å§ï¼Œåœ¨è§£è¯»æ¡ˆä¾‹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¥å…·ä½“ç†è§£ä¸‹ç©¶ç«Ÿä»€ä¹ˆæ˜¯ä¸å˜æ€§æ€ç»´ã€‚</p><h2>è¡¨è¾¾å¼æ€ç»´æ¶ˆç­var</h2><p>é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±å˜æˆäº†<strong>å°½å¯èƒ½æ¶ˆç­é‚£äº›éå¿…è¦å¯å˜æ€§</strong>ã€‚æ²¿ç€è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æƒ³åˆ°ä¸€ä¸ªæ–¹å‘ï¼šå°½å¯èƒ½å°†varå˜æˆvalã€‚å°±æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><pre><code class=\"language-plain\">fun testExp(data: Any) {\n    var i = 0\n\n    if (data is Number) {\n        i = data.toInt()\n    } else if (data is String) {\n        i = data.length\n    } else {\n        i = 0\n    }\n}\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå¯å˜çš„å˜é‡iï¼Œå®ƒçš„åˆå§‹å€¼æ˜¯0ï¼Œå¦‚æœdataæ˜¯æ•°å­—ç±»å‹ï¼Œæˆ‘ä»¬å°±å°†å…¶è½¬æ¢æˆæ•´å‹ï¼Œèµ‹å€¼ç»™iï¼›å¦‚æœdataæ˜¯Stringç±»å‹ï¼Œæˆ‘ä»¬å°±å°†å­—ç¬¦ä¸²çš„é•¿åº¦èµ‹å€¼ç»™iï¼Œå¦åˆ™å°±ç”¨0èµ‹å€¼ã€‚</p><p>è¿™æ®µä»£ç è™½ç„¶æ²¡ä»€ä¹ˆå®é™…ç”¨é€”ï¼Œä½†å®ƒä»£è¡¨äº†Javaã€Cå½“ä¸­æ™®éå­˜åœ¨çš„ä»£ç æ¨¡å¼ã€‚è¿™é‡Œçš„iï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦æ¶ˆç­çš„<strong>éå¿…è¦</strong>å¯å˜æ€§ã€‚å…¶å®ï¼Œåœ¨å­¦äº†ä¸ŠèŠ‚è¯¾â€œè¡¨è¾¾å¼æ€ç»´â€ä»¥åï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¸è´¹å¹ç°ä¹‹åŠ›å°±å¯ä»¥è§£å†³äº†ï¼Œä¹Ÿå°±æ˜¯æŠŠæ•´ä½“çš„èµ‹å€¼é€»è¾‘å˜æˆä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-plain\">fun testExp(data: Any) {\n    val i = when (data) {\n        is Number -&gt; {\n            data.toInt()\n        }\n        is String -&gt; {\n            data.length\n        }\n        else -&gt; {\n            0\n        }\n    }\n}\n</code></pre><p>åœ¨è¿™é‡Œä½ è¦æ³¨æ„ï¼Œå¦‚æœä½ æŠŠè¿™ä¸ªå½“åšä¸€é“é¢˜ç›®æ¥åšçš„è¯ï¼Œå®ƒæ— ç–‘æ˜¯å¾ˆå®¹æ˜“çš„ã€‚ä½†æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼šåœ¨å†™Kotlinä»£ç çš„æ—¶å€™ï¼Œéœ€è¦<strong>ä¸€æ­¥åˆ°ä½</strong>ç›´æ¥å†™å‡ºä¸Šé¢è¿™æ ·çš„ä»£ç ã€‚è€Œæƒ³è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å°±ä¸€å®šè¦å°†ä¸å˜æ€§çš„æ€ç»´é“­è®°åœ¨å¿ƒã€‚å› ä¸ºè¦åšåˆ°è¿™ä¸€ç‚¹å…¶å®ä¸å¤ªå®¹æ˜“ï¼Œå°¤å…¶æ˜¯å¯¹Javaã€Cå¼€å‘è€…è€Œè¨€ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœä½ è¶³å¤Ÿç»†å¿ƒçš„è¯ï¼Œç›¸ä¿¡ä½ ä¹Ÿå‘ç°äº†ï¼šæˆ‘ä»¬ä¸ŠèŠ‚è¯¾åˆšå­¦çš„â€œè¡¨è¾¾å¼çš„æ€ç»´â€ï¼Œå¯¹äºæˆ‘ä»¬çš„ä¸å˜æ€§æ€ç»´ï¼Œä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p><p>å¥½ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ€»ç»“å‡ºä¸å˜æ€§æ€ç»´çš„ç¬¬ä¸€æ¡å‡†åˆ™ï¼š<strong>å°½å¯èƒ½ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼æ¶ˆç­varã€‚</strong></p><h2>æ¶ˆç­æ•°æ®ç±»å½“ä¸­çš„å¯å˜æ€§</h2><p>åœ¨<a href=\"https://time.geekbang.org/column/article/473349\">ç¬¬2è®²</a>é‡Œï¼Œæˆ‘ä»¬æ›¾ç»ç®€å•å­¦ä¹ è¿‡æ•°æ®ç±»ï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾æ•°æ®çš„ç±»ã€‚å®ƒä¸Javaå½“ä¸­çš„â€œJava Beanâ€æ˜¯ç±»ä¼¼çš„ï¼Œå®ƒçš„ä¼˜åŠ¿åœ¨äºç®€æ´ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»ç„¶è§è¿‡æœ‰äººåœ¨Kotlinå½“ä¸­å†™å‡ºç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class=\"language-plain\">class Person {\n    private var name: String? = null\n    private var age: Int? = 0\n\n    fun getName(): String? {\n        return name\n    }\n\n    fun setName(n: String?) {\n        name = n\n    }\n\n    fun getAge(): Int? {\n        return age\n    }\n\n    fun setAge(a: Int?) {\n        age = a\n    }\n}\n</code></pre><p>ä¸Šé¢çš„ä»£ç å°±æ˜¯æ˜æ˜¾åœ¨ç”¨Javaæ€ç»´å†™Kotlinä»£ç ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘è¿˜èƒ½çœ‹åˆ°è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class=\"language-plain\">class Person {\n    var name: String? = null\n    var age: Int? = 0\n}\n</code></pre><p>è¿™æ ·çš„ä»£ç å‘¢ï¼Œçœ‹èµ·æ¥é—®é¢˜è¦å°ä¸€äº›ï¼Œä½†å®é™…ä¸Šå‘¢ï¼Œå¼€å‘è€…è„‘å­é‡Œæƒ³çš„å¯èƒ½æ˜¯ç±»ä¼¼Javaè¿™æ ·çš„ä»£ç æ¨¡å¼ï¼š</p><pre><code class=\"language-java\">public class Person {\n    public String name = null;\n    public int age = 0;\n}\n</code></pre><p>ä¸è¿‡ï¼Œæ€»çš„æ¥è¯´ï¼Œå¤§éƒ¨åˆ†Kotlinå¼€å‘è€…éƒ½èƒ½å†™å‡ºç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š</p><pre><code class=\"language-plain\">data class Person(\n    var name: String?,\n    var age: Int?\n)\n</code></pre><p>ä½†è¿™æ®µä»£ç å…¶å®è¿˜å¯ä»¥ç»§ç»­ä¼˜åŒ–ã€‚æˆ‘ä»¬å¯ä»¥å°†varéƒ½æ”¹ä¸ºvalï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><pre><code class=\"language-plain\">// var -&gt; val\ndata class Person(\n    val name: String?, \n    val age: Int?\n)\n</code></pre><p>è€Œåˆ°è¿™é‡Œï¼Œä½ å¯èƒ½å°±ä¼šäº§ç”Ÿä¸€ä¸ªç–‘é—®ï¼š<strong>Personçš„æ‰€æœ‰å±æ€§éƒ½æ”¹ä¸ºvalä»¥åï¼Œä¸‡ä¸€æƒ³è¦ä¿®æ”¹å®ƒçš„å€¼è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</strong></p><p>æ¯”å¦‚è¯´ï¼Œç›´æ¥ä¿®æ”¹å®ƒçš„å€¼çš„è¯ï¼Œè¿™æ®µä»£ç å°±ä¼šæŠ¥é”™ï¼š</p><pre><code class=\"language-plain\">class ImmutableExample {\n    // ä¿®æ”¹Personçš„nameï¼Œç„¶åè¿”å›Personå¯¹è±¡\n    fun changeUserName(person: Person, newName: String): Person {\n        person.name = newName // æŠ¥é”™ï¼Œvalæ— æ³•ä¿®æ”¹\n        return person\n    }\n}\n</code></pre><p>è¿™ä¸€ç‚¹ä¹Ÿæ˜¯æˆ‘ä»¬è¦å°¤ä¸ºæ³¨æ„çš„ï¼šæˆ‘ä»¬ä»Javaã€Cé‚£è¾¹å¸¦æ¥çš„ä¹ æƒ¯ï¼Œä¼šä¿ƒä½¿æˆ‘ä»¬ç¬¬ä¸€æ—¶é—´æƒ³åˆ°ä¸Šé¢è¿™æ ·çš„è§£å†³æ–¹æ¡ˆã€‚ä½†å®é™…ä¸Šï¼ŒKotlinæ›´åŠ æ¨å´‡æˆ‘ä»¬ç”¨ä¸‹é¢çš„æ–¹å¼æ¥è§£å†³ï¼š</p><pre><code class=\"language-plain\">class ImmutableExample {\n    fun changeUserName(person: Person, newName: String): Person =\n        person.copy(name = newName)\n}\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥ä¿®æ”¹å‚æ•°personçš„å€¼ï¼Œè€Œæ˜¯è¿”å›äº†ä¸€ä¸ªæ–°çš„personå¯¹è±¡ã€‚æˆ‘ä»¬å€ŸåŠ©æ•°æ®ç±»çš„copyæ–¹æ³•ï¼Œå¿«é€Ÿåˆ›å»ºäº†ä¸€ä»½æ‹·è´çš„åŒæ—¶ï¼Œè¿˜å®Œæˆäº†å¯¹nameå±æ€§çš„ä¿®æ”¹ã€‚ç±»ä¼¼è¿™æ ·çš„ä»£ç æ¨¡å¼ï¼Œå°±å¯ä»¥æå¤§åœ°å‡å°‘ç¨‹åºå‡ºBugçš„å¯èƒ½ã€‚</p><p>é‚£ä¹ˆåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå°±èƒ½æ€»ç»“å‡ºKotlinä¸å˜æ€§æ€ç»´çš„ç¬¬äºŒæ¡å‡†åˆ™äº†ï¼š<strong>ä½¿ç”¨æ•°æ®ç±»æ¥å­˜å‚¨æ•°æ®ï¼Œæ¶ˆç­æ•°æ®ç±»çš„å¯å˜æ€§</strong>ã€‚</p><h2>é›†åˆçš„ä¸å˜æ€§</h2><p>åœ¨Kotlinå½“ä¸­ï¼Œæåˆ°ä¸å˜æ€§ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸è°ˆå®ƒçš„<strong>é›†åˆåº“</strong>ã€‚æˆ‘ä»¬åœ¨å­¦ä¹ æ•°æ®ç»“æ„çš„æ—¶å€™ï¼Œéƒ½ä¼šå­¦åˆ°ï¼šæ•°ç»„ã€åˆ—è¡¨ã€HashMapã€HashSetã€æ ˆã€é˜Ÿåˆ—ã€‚è¿™äº›æ¦‚å¿µåœ¨å¤§éƒ¨åˆ†çš„ç¼–ç¨‹è¯­è¨€é‡Œéƒ½ä¼šå­˜åœ¨ï¼Œä¸è¿‡Kotlinåœ¨è¿™æ–¹é¢çš„è®¾è®¡ï¼Œå´ä¸Javaä¹‹ç±»çš„è¯­è¨€ä¸å¤ªä¸€æ ·ã€‚</p><p>ä»¥æœ€å¸¸è§çš„åˆ—è¡¨ï¼ˆListï¼‰ä¸ºä¾‹ï¼š</p><ul>\n<li>åœ¨Javaå½“ä¸­ï¼ŒListæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå¯å˜çš„åˆ—è¡¨ï¼Œä¼šåŒ…å«add()ã€remove()æ–¹æ³•ï¼›</li>\n<li>åœ¨Kotlinå½“ä¸­ï¼ŒListä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯å®ƒä»£è¡¨äº†ä¸€ä¸ªä¸å¯å˜çš„åˆ—è¡¨ï¼Œæˆ–è€…è¯´æ˜¯â€œåªè¯»çš„åˆ—è¡¨â€ã€‚åœ¨å®ƒçš„æ¥å£å½“ä¸­ï¼Œæ˜¯æ²¡æœ‰add()ã€remove()æ–¹æ³•çš„ï¼Œå½“æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å¯å˜åˆ—è¡¨çš„æ—¶å€™ï¼Œå¿…é¡»ä½¿ç”¨MutableListã€‚</li>\n</ul><p>å…³äºé›†åˆçš„ä¸å˜æ€§ï¼Œæˆ‘ä»¬å…¶å®åœ¨ç¬¬9è®²<a href=\"https://time.geekbang.org/column/article/479112\">å§”æ‰˜</a>å½“ä¸­å°±æåˆ°äº†ï¼š</p><pre><code class=\"language-plain\">class Model {\n    val data: MutableList&lt;String&gt; = mutableListOf()\n\n    private fun load() {\n        // ç½‘ç»œè¯·æ±‚\n        data.add(\"Hello\")\n    }\n}\n\nfun main() {\n    val model = Model()\n    // ç±»çš„å¤–éƒ¨ä»ç„¶å¯ä»¥ä¿®æ”¹data\n    model.data.add(\"World\")\n}\n</code></pre><p>å½“æˆ‘ä»¬å°†ç±»å†…éƒ¨çš„é›†åˆå¯¹è±¡æš´éœ²ç»™å¤–éƒ¨ä»¥åï¼Œæˆ‘ä»¬å…¶å®æ²¡åŠæ³•é˜»æ­¢å¤–éƒ¨å¯¹é›†åˆçš„ä¿®æ”¹ã€‚åœ¨ç¬¬9è®²å½“ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡<strong>å±æ€§ä¹‹é—´çš„ç›´æ¥å§”æ‰˜</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼š</p><pre><code class=\"language-plain\">class Model {\n    val data: List&lt;String&gt; by ::_data\n    private val _data: MutableList&lt;String&gt; = mutableListOf()\n\n    fun load() {\n        _data.add(\"Hello\")\n    }\n}\n</code></pre><p>ä½†å…¶å®ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ©å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š</p><pre><code class=\"language-plain\">class Model {\n    val data: List&lt;String&gt;\n        get() = _data // è‡ªå®šä¹‰get\n    private val _data: MutableList&lt;String&gt; = mutableListOf()\n\n    fun load() {\n        _data.add(\"Hello\")\n    }\n}\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸ºdataå±æ€§è‡ªå®šä¹‰äº†get()æ–¹æ³•ï¼Œç„¶åè¿”å›äº†_dataè¿™ä¸ªé›†åˆçš„å€¼ã€‚è¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥å®ç°ç›®çš„ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬å…¶å®è¿˜æœ‰å…¶ä»–çš„åŠæ³•ï¼š</p><pre><code class=\"language-plain\">class Model {\n    private val data: MutableList&lt;String&gt; = mutableListOf()\n\n    fun load() {\n        data.add(\"Hello\")\n    }\n\n    // å˜åŒ–åœ¨è¿™é‡Œ\n    fun getData(): List&lt;String&gt; = data\n}\n</code></pre><p>ä¸Šé¢è¿™ç§è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹å¤–æš´éœ²äº†ä¸€ä¸ªæ–¹æ³•ï¼ŒæŠŠè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ”¹æˆäº†Listç±»å‹ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå¤–éƒ¨è®¿é—®è¿™ä¸ªé›†åˆä»¥åå°±æ— æ³•ç›´æ¥ä¿®æ”¹äº†ã€‚</p><p>ä»¥ä¸Šè¿™ä¸‰ç§æ–¹å¼ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹å¤–æš´éœ²äº†ä¸€ä¸ªâ€œä¸å¯å˜çš„é›†åˆâ€ï¼Œå®Œæˆäº†å¯å˜æ€§çš„å°è£…ï¼Œå®ƒä»¬åŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„ä½¿ç”¨éœ€æ±‚ã€‚ä¸è¿‡å•Šï¼Œè¿™ä¸‰ç§æ–¹å¼å…¶å®è¿˜æ˜¯ä¼š<strong>å­˜åœ¨ä¸€å®šçš„é£é™©</strong>ï¼Œé‚£å°±æ˜¯å¤–éƒ¨å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><pre><code class=\"language-plain\">fun main() {\n    val model = Model()\n    println(\"Before:${model.getData()}\")\n    val data = model.getData()\n    (data as? MutableList)?.add(\"Some data\")\n    println(\"After:${model.getData()}\")\n}\n\nç»“æœï¼š\nBefore:[]\nAfter:[Some data]\n</code></pre><p>é’ˆå¯¹è¿™ç§ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥å†³å®šæ˜¯å¦è¦è§„é¿è¿™ä¸ªé—®é¢˜ã€‚å…¶å®è¦è§£å†³è¿™ä¸ªé—®é¢˜çš„è¯ä¹Ÿå¾ˆå®¹æ˜“ï¼Œæˆ‘ä»¬åªéœ€è¦å€ŸåŠ©Kotlinæä¾›çš„toListå‡½æ•°ï¼Œè®©dataå˜æˆçœŸæ­£çš„Listç±»å‹å³å¯ã€‚</p><p>æ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š</p><pre><code class=\"language-plain\">class Model {\n    private val data: MutableList&lt;String&gt; = mutableListOf()\n\n    fun load() {\n        data.add(\"Hello\")\n    }\n\n    //                                 å˜åŒ–åœ¨è¿™é‡Œ\n    //                                    â†“\n    fun getData(): List&lt;String&gt; = data.toList()\n}\n\n// æ”¹å®Œä»¥åçš„è¾“å‡ºç»“æœ\nBefore:[]\nAfter:[]\n</code></pre><p>è¿™æ®µä»£ç åŸºæœ¬ä¸Šå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆé›†åˆå¯å˜æ€§çš„å°è£…ï¼Œä¸è¿‡åœ¨è¿™é‡Œï¼Œæœ‰ä¸€ç‚¹æˆ‘ä»¬éœ€è¦æ ¼å¤–<strong>æ³¨æ„</strong>ï¼šå½“dataé›†åˆæ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼ŒtoList()æ“ä½œå¯èƒ½ä¼šæ¯”è¾ƒè€—æ—¶ã€‚</p><p>å¥½äº†ï¼Œè‡³æ­¤ï¼Œç›¸ä¿¡ä½ å¾ˆå¿«å°±èƒ½æ€»ç»“å‡ºç¬¬ä¸‰æ¡å‡†åˆ™äº†ï¼š<strong>å°½å¯èƒ½å¯¹å¤–æš´éœ²åªè¯»é›†åˆ</strong>ã€‚</p><h2>åªè¯»é›†åˆä¸Java</h2><p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå½“åªè¯»é›†åˆåœ¨Javaä»£ç ä¸­è¢«è®¿é—®çš„æ—¶å€™ï¼Œå®ƒçš„ä¸å˜æ€§å°†ä¼šè¢«ç ´åï¼Œå› ä¸ºJavaå½“ä¸­ä¸å­˜åœ¨â€œä¸å¯å˜çš„é›†åˆâ€çš„æ¦‚å¿µã€‚æ¯”å¦‚è¯´ï¼Œä½ åœ¨Javaå½“ä¸­ï¼Œä»ç„¶å¯ä»¥è°ƒç”¨è¿™ä¸ªé›†åˆçš„set()æ–¹æ³•ã€‚</p><pre><code class=\"language-plain\">public List&lt;String&gt; test() {\n    Model model = new Model();\n    List&lt;String&gt; data = model.getData();\n    data.set(0ï¼Œ \"Some Data\"); // æŠ›å‡ºå¼‚å¸¸ UnsupportedOperationException\n    return data;\n}\n</code></pre><p>å› æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨ä¸Javaæ··åˆç¼–ç¨‹çš„æ—¶å€™ï¼ŒJavaé‡Œä½¿ç”¨Kotliné›†åˆçš„æ—¶å€™ä¸€å®šè¦è¶³å¤Ÿå°å¿ƒï¼Œæœ€å¥½è¦æœ‰è¯¦ç»†çš„æ–‡æ¡£ã€‚å°±æ¯”å¦‚è¯´åœ¨ä¸Šé¢çš„ä¾‹å­å½“ä¸­ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥åœ¨Javaå½“ä¸­è°ƒç”¨set()æ–¹æ³•ï¼Œä½†æ˜¯è¿™è¡Œä»£ç æœ€ç»ˆä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¼•èµ·å´©æºƒã€‚è€Œå¼•èµ·å´©æºƒçš„åŸå› ï¼Œæ˜¯Kotlinçš„Listæœ€ç»ˆä¼šå˜æˆJavaå½“ä¸­çš„â€œ<strong>SingletonList</strong>â€ï¼Œå®ƒæ˜¯Javaå½“ä¸­çš„ä¸å¯å˜Listï¼Œåœ¨å®ƒçš„add()ã€remove()æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p><p>ä¸å¾—ä¸è¯´ï¼ŒJavaè¿™æ ·çš„å®ç°æ–¹å¼çœŸçš„å¾ˆä¸‘é™‹ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¯èƒ½å¾ˆå¤šJavaå¼€å‘è€…ç”šè‡³éƒ½ä¸çŸ¥é“Javaå±…ç„¶è¿˜æœ‰SingletonListè¿™ä¸ªç§æœ‰çš„ç±»ã€‚</p><p>å¹¶ä¸”ï¼Œåªè¯»é›†åˆåœ¨å’ŒJavaæ··ç¼–çš„æ—¶å€™ï¼Œä¸ä»…ä»…åªæœ‰è¿™ä¸€ä¸ªé—®é¢˜ã€‚æ¯•ç«Ÿï¼Œå½“æˆ‘ä»¬å°è¯•ä¿®æ”¹åªè¯»é›†åˆçš„å€¼çš„æ—¶å€™ï¼ŒJavaå¯ä»¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸çš„è¯ï¼Œé‚£ä¹Ÿç®—æ˜¯ä¸€ä¸ªå¯ä»¥å‹‰å¼ºæ¥å—çš„ç»“å±€äº†ã€‚</p><p>ä½†å®é™…çš„æƒ…å†µè¿˜ä¼šæ›´å·®ï¼Œå¦‚æœæˆ‘ä»¬å°†ä»£ç æ”¹æˆè¿™æ ·ï¼š</p><pre><code class=\"language-plain\">class Model1 {\n    val list: List&lt;String&gt; = listOf(\"hello\", \"world\")\n}\n\npublic class ImmutableJava {\n    public List&lt;String&gt; test1() {\n        Model1 model = new Model1();\n        List&lt;String&gt; data = model.getList();\n        System.out.println(data.get(0));\n        data.set(0, \"some data\"); // æ³¨æ„è¿™é‡Œ\n        System.out.println(data.get(0));\n        return data;\n    }\n}\n\n// ç»“æœ\nhello\nsome data\n</code></pre><p>æˆ‘ä»¬åœ¨Javaä»£ç å½“ä¸­è°ƒç”¨data.set()æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰å¼•èµ·å¼‚å¸¸ï¼Œç¨‹åºä¹Ÿæ­£å¸¸æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶ä¸”ç»“æœä¹Ÿç¬¦åˆé¢„æœŸã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒKotlinçš„Listè¢«ç¼–è¯‘å™¨è½¬æ¢æˆäº† <code>java.util.Arrays$ArrayList</code> ç±»å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬Kotlinå½“ä¸­çš„åªè¯»é›†åˆï¼Œåœ¨Javaå½“ä¸­å°±å˜æˆäº†ä¸€ä¸ªæ™®é€šçš„å¯å˜é›†åˆäº†ã€‚</p><p>äº‹å®ä¸Šï¼Œå¯¹äºKotlinçš„Listç±»å‹æ¥è¯´ï¼Œåœ¨å®ƒè½¬æ¢æˆJavaå­—èŠ‚ç ä»¥åï¼Œå¯èƒ½ä¼šå˜æˆå¤šç§ç±»å‹ï¼Œæ¯”å¦‚å‰é¢æˆ‘ä»¬çœ‹åˆ°çš„SingletonListã€<code>java.util.Arrays$ArrayList</code>ï¼Œç”šè‡³è¿˜å¯èƒ½ä¼šå˜æˆjava.util.ArrayListã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®Œå…¨ä¸å¿…å»æ·±ç©¶ç¼–è¯‘å™¨èƒŒåçš„ç¿»è¯‘è§„åˆ™ï¼Œæˆ‘ä»¬åªéœ€è¦æ—¶åˆ»è®°ä½ï¼ŒKotlinå½“ä¸­çš„åªè¯»é›†åˆï¼Œåœ¨Javaçœ‹æ¥å’Œæ™®é€šçš„å¯å˜é›†åˆæ˜¯ä¸€æ ·çš„ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±èƒ½æ€»ç»“å‡ºç¬¬å››æ¡å‡†åˆ™äº†ï¼š<strong>åªè¯»é›†åˆåº•å±‚ä¸ä¸€å®šæ˜¯ä¸å¯å˜çš„ï¼Œè¦è­¦æƒ•Javaä»£ç ä¸­çš„åªè¯»é›†åˆè®¿é—®è¡Œä¸º</strong>ã€‚</p><h2>åæ€ï¼šval ä¸€å®šä¸å¯å˜å—ï¼Ÿ</h2><p>æœ€åï¼Œæˆ‘ä»¬å†æ¥åæ€ä¸€ä¸‹Kotlinçš„ä¸å˜æ€§ã€‚é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬ç”¨valå®šä¹‰çš„ä¸´æ—¶å˜é‡ï¼Œéƒ½ä¼šå°†å…¶çœ‹åšæ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ˜¯åªè¯»å˜é‡ã€‚ä½†æ˜¯åˆ«å¿˜äº†ï¼Œ<strong>valè¿˜å¯ä»¥å®šä¹‰æˆå‘˜å±æ€§</strong>ã€‚è€Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ„å‘³ç€ï¼šå±æ€§+ getæ–¹æ³•ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰get()æ–¹æ³•ã€‚</p><p>æ‰€ä»¥è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¦çå¤§çœ¼ç›çœ‹æ¸…æ¥šå®ƒçš„æœ¬è´¨äº†ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ¥çœ‹çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p><pre><code class=\"language-plain\">object TestVal {\n    val a: Double\n        get() = Random.nextDouble()\n\n    fun testVal() {\n        println(a)\n        println(a)\n    }\n}\n\n// ç»“æœ\n0.0071073054825220305\n0.6478886064282862\n</code></pre><p>å¾ˆæ˜æ˜¾ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰get()æ–¹æ³•ï¼Œæ‰“ç ´äº†valçš„ä¸å˜æ€§ã€‚æˆ‘ä»¬ä¸¤æ¬¡è®¿é—®å±æ€§aæ‰€å¾—åˆ°çš„å€¼éƒ½ä¸ä¸€æ ·ã€‚å¯¹äºvalå®šä¹‰çš„æˆå‘˜å±æ€§ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™æ ·çš„ç»“æœå¹¶ä¸ä¼šè§‰å¾—å¥‡æ€ªï¼Œä¸Šé¢ä»£ç çš„è¿è¡Œç»“æœä¹Ÿååˆ†ç¬¦åˆç›´è§‰ã€‚</p><p>é‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šè¿™æ ·æƒ³ï¼šæˆ‘ä»¬ç”¨valå®šä¹‰çš„<strong>å±€éƒ¨å˜é‡</strong>ï¼Œé‚£å°±ä¸€å®šæ˜¯ä¸å¯å˜çš„äº†å§ï¼Ÿ</p><p>ç­”æ¡ˆä»ç„¶æ˜¯<strong>å¦å®š</strong>çš„ï¼</p><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œè¿™é‡Œæˆ‘ä»¬åŒæ ·æ˜¯å€ŸåŠ©äº†å§”æ‰˜ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼š</p><pre><code class=\"language-plain\">class RandomDelegate() : ReadOnlyProperty&lt;Any?, Double&gt; {\n    override operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): Double {\n        return Random.nextDouble()\n    }\n}\n\nfun testLocalVal() {\n    val i: Double by RandomDelegate()\n\n    println(i)\n    println(i)\n}\n\n// è¾“å‡ºç»“æœ\n0.1959507495773669\n0.5166803777645403\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå§”æ‰˜RandomDelegateï¼Œç„¶åæŠŠå±€éƒ¨å˜é‡å§”æ‰˜ç»™äº†è¿™ä¸ªRandomDelegateï¼Œä¹‹åæ¯æ¬¡è®¿é—®iè¿™ä¸ªå˜é‡ï¼Œå®ƒçš„å€¼éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>é‚£ä¹ˆï¼Œåˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ é©¬ä¸Šå°±å¯ä»¥æ€»ç»“å‡ºç¬¬äº”æ¡å‡†åˆ™äº†ï¼š<strong>valå¹¶ä¸æ„å‘³ç€ç»å¯¹çš„ä¸å¯å˜</strong>ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªç®€å•çš„æ€»ç»“å§ã€‚æ‰€è°“Kotlinçš„ä¸å˜æ€§æ€ç»´ï¼Œå°±æ˜¯å°½å¯èƒ½æ¶ˆç­ä»£ç ä¸­<strong>éå¿…è¦</strong>çš„å¯å˜æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€å…±æœ‰5å¤§å‡†åˆ™ã€‚</p><ul>\n<li>ç¬¬ä¸€ï¼Œ<strong>å°½å¯èƒ½ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼æ¶ˆç­var</strong>ã€‚ç”±äºKotlinå½“ä¸­å¤§éƒ¨åˆ†è¯­å¥éƒ½æ˜¯è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©è¿™ç§æ€è·¯å‡å°‘varå˜é‡çš„å®šä¹‰ã€‚</li>\n<li>ç¬¬äºŒï¼Œ<strong>ä½¿ç”¨æ•°æ®ç±»æ¥å­˜å‚¨æ•°æ®ï¼Œæ¶ˆç­æ•°æ®ç±»çš„å¯å˜æ€§</strong>ã€‚æˆ‘ä»¬åº”è¯¥å……åˆ†å‘æŒ¥Kotlinæ•°æ®ç±»çš„ä¼˜åŠ¿ï¼Œå€ŸåŠ©å®ƒæä¾›çš„copyæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ä¸å˜æ€§ã€‚</li>\n<li>ç¬¬ä¸‰ï¼Œ<strong>å°½å¯èƒ½å¯¹å¤–æš´éœ²åªè¯»é›†åˆ</strong>ã€‚æ ¹æ®<a href=\"https://en.wikipedia.org/wiki/Open%25E2%2580%2593closed_principle\">å¼€æ”¾å°é—­åŸåˆ™</a>ï¼Œæˆ‘ä»¬çš„ç¨‹åºåº”è¯¥å°½é‡å¯¹ä¿®æ”¹å°é—­ã€‚å€ŸåŠ©Kotlinçš„åªè¯»é›†åˆï¼Œæˆ‘ä»¬åœ¨è¿™æ–¹é¢å¯ä»¥åšå¾—æ¯”Javaæ›´å¥½ã€‚</li>\n<li>ç¬¬å››ï¼Œ<strong>åªè¯»é›†åˆåº•å±‚ä¸ä¸€å®šæ˜¯ä¸å¯å˜çš„ï¼Œè¦è­¦æƒ•Javaä»£ç ä¸­çš„åªè¯»é›†åˆè®¿é—®è¡Œä¸º</strong>ã€‚Kotlinä¸ºäº†å…¼å®¹Javaï¼Œå®ƒçš„é›†åˆç±»å‹å¿…é¡»è¦ä¸Javaå…¼å®¹ï¼Œå› æ­¤å®ƒä¸èƒ½åˆ›é€ å‡ºJavaä»¥å¤–çš„é›†åˆç±»å‹ï¼Œè¿™ä¹Ÿå°±å†³å®šäº†å®ƒåªèƒ½æ˜¯è¯­æ³•å±‚é¢çš„ä¸å¯å˜æ€§ã€‚Kotlinå®˜æ–¹ä¹Ÿåœ¨è€ƒè™‘è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼ŒæœŸå¾…åç»­çš„ç‰ˆæœ¬èƒ½æœ‰æ›´åŠ ä¼˜é›…çš„å¤„ç†æ–¹å¼ã€‚</li>\n<li>ç¬¬äº”ï¼Œ<strong>valå¹¶ä¸æ„å‘³ç€ç»å¯¹çš„ä¸å¯å˜</strong>ã€‚åœ¨Kotlinå½“ä¸­å®šä¹‰çš„valå˜é‡ä¸å±æ€§ï¼Œå®ƒä»¬å¹¶éç»å¯¹ä¸å¯å˜çš„ã€‚ç”±äºKotlinçš„è¯­æ³•ååˆ†çµæ´»ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨valå†™å‡ºå¯å˜çš„å±€éƒ¨å˜é‡å’Œæˆå‘˜å±æ€§ã€‚è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä¸€å®šè¦å°å¿ƒã€‚</li>\n</ul><h2>æ€è€ƒé¢˜</h2><p>ç®€å•çš„äº”ä¸ªå‡†åˆ™ï¼Œæ˜¯ä¸å¯èƒ½å®Œå…¨æ¦‚æ‹¬å‡ºKotlinçš„ä¸å˜æ€§æ€ç»´çš„ã€‚è¯·é—®ä½ è¿˜èƒ½æƒ³åˆ°å…¶ä»–çš„ä¸å˜æ€§å‡†åˆ™å—ï¼Ÿæ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p>","comments":[{"had_liked":false,"id":346599,"user_name":"BUGå›","can_delete":false,"product_type":"c1","uid":1143211,"ip_address":"","ucode":"B7513F37026E5F","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/ab/b19a1ba2.jpg","comment_is_top":false,"comment_ctime":1653273719,"is_pvip":false,"replies":[{"id":"126596","content":"æ˜¯çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1653818289,"ip_address":"","comment_id":346599,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23128110199","product_id":100103401,"comment_content":"ä½¿ç”¨copy()æ–¹æ³•,  æ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡, å¦‚æœä¸æ³¨æ„åœ¨forå¾ªç¯é‡Œé¢ä½¿ç”¨è¯¥æ–¹æ³•, å¾ˆå¯èƒ½ä¼šé€ æˆå†…å­˜æŠ–åŠ¨","like_count":6,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574061,"discussion_content":"æ˜¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653818289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333302,"user_name":"é­å…¨è¿","can_delete":false,"product_type":"c1","uid":1090798,"ip_address":"","ucode":"3FED702C724E2A","user_header":"https://static001.geekbang.org/account/avatar/00/10/a4/ee/cffd8ee6.jpg","comment_is_top":false,"comment_ctime":1644280808,"is_pvip":false,"replies":[{"id":"121802","content":"è¯´çš„å¾ˆå¥½ï¼Œæ„Ÿè°¢è¿™ä½åŒå­¦çš„è¡¥å……ï¼<br><br>Kotlinä¸å˜æ€§æ€ç»´æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œåœ¨æœ‰äº›é«˜æ€§èƒ½åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬è¦è¿›è¡Œå–èˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644289738,"ip_address":"","comment_id":333302,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14529182696","product_id":100103401,"comment_content":"kotlin çš„å‡½æ•°å¼ä¸å˜æ€§æ€ç»´ä¹Ÿæœ‰ä¸€äº›ä¸å¥½çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¯¹é›†åˆä½¿ç”¨å„ç§å†…ç½®æ“ä½œç¬¦é“¾å¼è°ƒç”¨æ—¶ï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šnewä¸€ä¸ªæ–°çš„æ‹·è´ï¼Œè¿™æ—¶å€™å¯ä»¥æŠŠé›†åˆåœ¨å¼€å§‹æ—¶è½¬æˆsequence æ¥æ“ä½œï¼Œé¿å…æ„é€ å¤ªå¤šä¸­é—´å˜é‡ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œsequence æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œä¸èƒ½è¦†ç›–æ‰€æœ‰åœºæ™¯","like_count":4,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549900,"discussion_content":"è¯´çš„å¾ˆå¥½ï¼Œæ„Ÿè°¢è¿™ä½åŒå­¦çš„è¡¥å……ï¼\n\nKotlinä¸å˜æ€§æ€ç»´æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œåœ¨æœ‰äº›é«˜æ€§èƒ½åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬è¦è¿›è¡Œå–èˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644289738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1342000,"avatar":"https://static001.geekbang.org/account/avatar/00/14/7a/30/23fc4089.jpg","nickname":"24éš‹å¿ƒæ‰€æ¬²","note":"","ucode":"1B8B2789F68C94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591915,"discussion_content":"è¦æƒ³æ›´å¥å£®å°±ä¸å¾—ä¸ç‰ºç‰²ä¸€å®šç¨‹åº¦çš„æ€§èƒ½ï¼Œæœ‰ç‚¹æ—¶é—´æ¢ç©ºé—´çš„æ„Ÿè§‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666929485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³åŒ—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338976,"user_name":"çˆ±å­¦ä¹ çš„å°ç¾Š","can_delete":false,"product_type":"c1","uid":2883920,"ip_address":"","ucode":"9984EB84D7715B","user_header":"https://static001.geekbang.org/account/avatar/00/2c/01/50/c1556a25.jpg","comment_is_top":false,"comment_ctime":1647846410,"is_pvip":false,"replies":[{"id":"124013","content":"å¯ä»¥è¿™æ ·ï¼šCopyä¸€ä¸‹åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç„¶åç”¨æ–°çš„å¯¹è±¡æ›´æ–°UIï¼Œè¿™æ—¶å€™å¯èƒ½éœ€è¦è€ƒè™‘Diffã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1648030734,"ip_address":"","comment_id":338976,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5942813706","product_id":100103401,"comment_content":"è€å¸ˆå¥½ï¼Œå¦‚æœä¸€ä¸ªAPPï¼Œéœ€è¦æœ‰ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ä¿®æ”¹äº†ç”¨æˆ·ä¿¡æ¯é‡Œçš„èº«é«˜ï¼Œè¿™ä¸ªç”¨æ•°æ®ç±»æ€ä¹ˆå¤„ç†å‘€","like_count":2,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557959,"discussion_content":"å¯ä»¥è¿™æ ·ï¼šCopyä¸€ä¸‹åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç„¶åç”¨æ–°çš„å¯¹è±¡æ›´æ–°UIï¼Œè¿™æ—¶å€™å¯èƒ½éœ€è¦è€ƒè™‘Diffã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648030734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334326,"user_name":"Geek_66aa0c","can_delete":false,"product_type":"c1","uid":2881969,"ip_address":"","ucode":"372D66A4B962FC","user_header":"","comment_is_top":false,"comment_ctime":1644889245,"is_pvip":false,"replies":[{"id":"122169","content":"å¯ä»¥çœ‹çœ‹è¿™ä½åŒå­¦çš„è¡¥å……ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644938924,"ip_address":"","comment_id":334326,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5939856541","product_id":100103401,"comment_content":"SingletonListæ˜¯java.util.Collectionsç±»çš„å†…éƒ¨ç±»ï¼Œåªä¿å­˜ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨åˆå§‹åŒ–éœ€è¦èµ‹å€¼ï¼Œå¦‚ï¼š<br>List&lt;String&gt; list = Collections.singletonList(&quot;ok&quot;);<br>å¹¶ä¸”ä¸æ”¯æŒaddã€removeæ–¹æ³•","like_count":2,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551246,"discussion_content":"å¯ä»¥çœ‹çœ‹è¿™ä½åŒå­¦çš„è¡¥å……ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644938925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333293,"user_name":"A Lonely Cat","can_delete":false,"product_type":"c1","uid":2885349,"ip_address":"","ucode":"382EBFDD8E5115","user_header":"https://static001.geekbang.org/account/avatar/00/2c/06/e5/51ef9735.jpg","comment_is_top":false,"comment_ctime":1644251089,"is_pvip":false,"replies":[{"id":"121813","content":"æ€»ç»“å¾ˆåˆ°ä½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644296160,"ip_address":"","comment_id":333293,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5939218385","product_id":100103401,"comment_content":"æˆ‘å¯¹ val ä¸å¯å˜ç†è§£æ˜¯ï¼šåœ°å€ä¸å˜ï¼ˆåœ¨ kotlin ä¸‹æ— æ³•äºŒæ¬¡èµ‹å€¼ï¼Œç±»ä¼¼Javaä¸­çš„ final å…³é”®å­—ä¿®é¥°çš„å±æ€§ï¼‰ï¼Œä½†æ˜¯å€¼å¯èƒ½ä¼šå˜ï¼ˆé€šè¿‡è¯¥å¯¹è±¡çš„ç›¸å…³æ–¹æ³•ä¿®æ”¹å±æ€§ï¼‰","like_count":2,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549924,"discussion_content":"æ€»ç»“å¾ˆåˆ°ä½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644296160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352934,"user_name":"éƒ‘å³°","can_delete":false,"product_type":"c1","uid":1112517,"ip_address":"åŒ—äº¬","ucode":"4D4C0C020E507C","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/c5/95b97dfa.jpg","comment_is_top":false,"comment_ctime":1659022727,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1659022727","product_id":100103401,"comment_content":"ä¸ºä»€ä¹ˆå§”æ‰˜é‡Œé¢çš„byæ¯æ¬¡è®¿é—®æ¯æ¬¡æ‰§è¡Œï¼Œby lazyå°±åªæ‰§è¡Œä¸€æ¬¡å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1143211,"avatar":"https://static001.geekbang.org/account/avatar/00/11/71/ab/b19a1ba2.jpg","nickname":"BUGå›","note":"","ucode":"B7513F37026E5F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585053,"discussion_content":"å¯ä»¥çœ‹ä¸‹æºç , by lazy æœ‰åˆ¤ç©º","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1661311618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1128983,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3a/17/c5196bb7.jpg","nickname":"Yqhâ™¥","note":"","ucode":"BFF59A2F31722B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588494,"discussion_content":"by lazyè¿™ä¸ªå‡½æ•°ä½“ä¹Ÿä¼šæ‰§è¡Œå¤šæ¬¡å•Šï¼Œåªæ˜¯ç»™ä½ è¿”å›çš„å€¼åšäº†åˆ¤æ–­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663806368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338867,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1647766011,"is_pvip":false,"replies":[{"id":"124009","content":"æ˜¯çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1648030207,"ip_address":"","comment_id":338867,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647766011","product_id":100103401,"comment_content":"å°½é‡é¿å…å†™æ“ä½œï¼Œä¸å¾—ä¸å†™çš„æ—¶å€™ï¼Œä¼˜å…ˆè€ƒè™‘æ‹·è´è¿”å›ï¼Œæœ€åæ‰æ˜¯æä¾›è¯»å†™æ“ä½œã€‚è¯»å†™æ“ä½œæœ€ç›´è§‚ï¼Œä½†æ˜¯å¤ªå®¹æ˜“åˆ°å¤„å†™ï¼Œæœ€åå¾ˆå¯èƒ½å¯¼è‡´å…¨å±€å˜é‡ä¸€æ ·çš„æ¯›ç—…ï¼Œä¸çŸ¥é“å“ªé‡Œä¿®æ”¹äº†çŠ¶æ€ï¼Œå¦‚æœæœ‰å¤šçº¿ç¨‹å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ›´åŠ éš¾è°ƒè¯•ã€‚","like_count":1,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557955,"discussion_content":"æ˜¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648030207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336666,"user_name":"å±±æ²³å…¥æ¢¦","can_delete":false,"product_type":"c1","uid":1480185,"ip_address":"","ucode":"6B8C4896012092","user_header":"https://static001.geekbang.org/account/avatar/00/16/95/f9/0d4801ce.jpg","comment_is_top":false,"comment_ctime":1646280627,"is_pvip":false,"replies":[{"id":"123159","content":"ç›®å‰æˆ‘çš„åšæ³•æ˜¯ï¼šä½¿ç”¨Moshiè¿›è¡ŒJSONè§£æï¼Œå†æ­é…ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ã€‚ç”±äºæ–‡å­—è§£é‡Šèµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œå…·ä½“æ–¹æ¡ˆï¼Œæˆ‘ä¼šåœ¨Androidé¡¹ç›®ç¯‡çš„æ—¶å€™è¯¦ç»†ä»‹ç»çš„ï¼Œè¯·ç•™æ„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1646582075,"ip_address":"","comment_id":336666,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1646280627","product_id":100103401,"comment_content":"æƒ³è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œå¯¹äºæ•°æ®ç±»ç”¨valå£°æ˜çš„å­—æ®µå¦‚æœåå°è¿”å›äº†nullæ€ä¹ˆåŠï¼Œå°¤å…¶æ˜¯â€œé™ˆå¹´æ¥å£â€","like_count":0,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554765,"discussion_content":"ç›®å‰æˆ‘çš„åšæ³•æ˜¯ï¼šä½¿ç”¨Moshiè¿›è¡ŒJSONè§£æï¼Œå†æ­é…ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ã€‚ç”±äºæ–‡å­—è§£é‡Šèµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œå…·ä½“æ–¹æ¡ˆï¼Œæˆ‘ä¼šåœ¨Androidé¡¹ç›®ç¯‡çš„æ—¶å€™è¯¦ç»†ä»‹ç»çš„ï¼Œè¯·ç•™æ„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646582075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1174704,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ec/b0/4e22819f.jpg","nickname":"syz","note":"","ucode":"54AF17ACD72645","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555226,"discussion_content":"data class User(val name:String?=null)    è¿™æ ·å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646815030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335055,"user_name":"ç™½ä¹¾æ¶›","can_delete":false,"product_type":"c1","uid":1339841,"ip_address":"","ucode":"0C704B0B90C8D7","user_header":"https://static001.geekbang.org/account/avatar/00/14/71/c1/cbc55e06.jpg","comment_is_top":false,"comment_ctime":1645276103,"is_pvip":false,"replies":[{"id":"122416","content":"æ˜¯æœ‰è¿™ä¸ªå¯èƒ½çš„ï¼ŒKotlinåº•å±‚ç¼–è¯‘å™¨çš„è½¬æ¢è§„åˆ™æ˜¯ä¸é€æ˜çš„ã€‚<br><br>ä¸è¿‡ï¼Œä½ å¯ä»¥è¿è¡Œæ—¶æ‰“æ–­ç‚¹çœ‹çœ‹ï¼Œåç¼–è¯‘çš„ç±»å‹ä¸ä¸€å®šå°±æ˜¯è¿è¡Œæ—¶çš„ï¼Œå› ä¸ºSingletonListä¹Ÿç®—æ˜¯Listçš„å­ç±»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1645370717,"ip_address":"","comment_id":335055,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645276103","product_id":100103401,"comment_content":"å…³äºJavaä¸­çš„ä¸å˜æ€§é›†åˆï¼Œä¸ºä»€ä¹ˆæˆ‘è‡ªåŠ¨å¯¼äº† java.util.List è€Œä¸æ˜¯ SingletonListï¼Ÿ<br>è€Œä¸”æˆ‘æŠ¥çš„é”™æ˜¯ ClassCastException: java.lang.String cannot be cast to java.lang.Void ï¼Ÿ<br><br>import java.util.List;<br>class Test {<br>\tpublic static void main(String[] args) {<br>\t\tList&lt;String&gt; data = new Model().getData();<br>\t\tdata.add(&quot;bqt&quot;); &#47;&#47; ClassCastException: java.lang.String cannot be cast to java.lang.Void<br>\t}<br>}","like_count":1,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552277,"discussion_content":"æ˜¯æœ‰è¿™ä¸ªå¯èƒ½çš„ï¼ŒKotlinåº•å±‚ç¼–è¯‘å™¨çš„è½¬æ¢è§„åˆ™æ˜¯ä¸é€æ˜çš„ã€‚\n\nä¸è¿‡ï¼Œä½ å¯ä»¥è¿è¡Œæ—¶æ‰“æ–­ç‚¹çœ‹çœ‹ï¼Œåç¼–è¯‘çš„ç±»å‹ä¸ä¸€å®šå°±æ˜¯è¿è¡Œæ—¶çš„ï¼Œå› ä¸ºSingletonListä¹Ÿç®—æ˜¯Listçš„å­ç±»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645370717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333292,"user_name":"A Lonely Cat","can_delete":false,"product_type":"c1","uid":2885349,"ip_address":"","ucode":"382EBFDD8E5115","user_header":"https://static001.geekbang.org/account/avatar/00/2c/06/e5/51ef9735.jpg","comment_is_top":false,"comment_ctime":1644250661,"is_pvip":false,"replies":[{"id":"121811","content":"æ„Ÿè°¢è¿™ä¸ºåŒå­¦æŒ‡å‡ºçš„é—®é¢˜ï¼Œå½“æˆ‘è„‘å­é‡Œæƒ³çš„æ˜¯â€œå¯å˜æ€§â€çš„æ—¶å€™ï¼Œå†™å‡ºæ¥çš„å´æ˜¯â€œä¸å˜æ€§â€ï¼Œæ˜¯çœŸçš„æŠŠè‡ªå·±ç»•æ™•äº†ï¼Œä¼šæ”¹å›æ¥çš„ã€‚<br><br>PSï¼šè¡¥å……çš„å†…å®¹ä¹Ÿå¾ˆå¥½ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644295954,"ip_address":"","comment_id":333292,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1644250661","product_id":100103401,"comment_content":"æ„Ÿè§‰æœ±è€å¸ˆæŠŠè‡ªå·±å†™æ‡µäº†ã€‚ä¸€ä¼šå„¿æ¶ˆé™¤ä¸å˜æ€§ï¼Œä¸€ä¼šå„¿æ¶ˆé™¤å¯å˜æ€§ã€‚<br><br>ä¾‹ï¼š<br>1ã€æ¶ˆç­æ•°æ®ç±»ä¸­çš„ä¸å˜æ€§ã€‚<br>2ã€æ•°æ®ç±»æ¥å­˜å‚¨æ•°æ®ï¼Œæ¶ˆç­æ•°æ®çš„å¯å˜æ€§ã€‚<br><br>ç±»ä¼¼çš„é—®é¢˜è¿˜æœ‰å¥½å¤šå¤„ğŸ¤”ğŸ¤”<br><br>å¤§å®¶å¯ä»¥çœ‹çœ‹è€å¤–çš„è¿™ç¯‡æ–‡ç« ï¼šhttps:&#47;&#47;commonsware.com&#47;AndroidArch&#47;pages&#47;chap-immutability-001<br><br><br>Immutability is one way of imposing a contract upon yourself, as a developer, to avoid side effects. Calling a setter is a very casual act in programming, even if calling that setter introduces a side effect. Immutability enforces the creation of new objects, ideal for use in pure functions, where the function can create objects to return but cannot change the parametersâ€™ contents and cause side effects.<br><br>è¯‘ï¼š<br>ä¸å˜æ€§æ˜¯ä½œä¸ºå¼€å‘äººå‘˜å°†åˆåŒå¼ºåŠ äºè‡ªå·±ä»¥é¿å…å‰¯ä½œç”¨çš„ä¸€ç§æ–¹å¼ã€‚è°ƒç”¨ setter åœ¨ç¼–ç¨‹ä¸­æ˜¯ä¸€ç§éå¸¸éšæ„çš„è¡Œä¸ºï¼Œå³ä½¿è°ƒç”¨è¯¥ setter ä¼šå¸¦æ¥å‰¯ä½œç”¨ã€‚ä¸å˜æ€§å¼ºåˆ¶åˆ›å»ºæ–°å¯¹è±¡ï¼Œéå¸¸é€‚åˆåœ¨çº¯å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå…¶ä¸­å‡½æ•°å¯ä»¥åˆ›å»ºè¦è¿”å›çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½æ›´æ”¹å‚æ•°çš„å†…å®¹å¹¶å¯¼è‡´å‰¯ä½œç”¨ã€‚","like_count":0,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549922,"discussion_content":"æ„Ÿè°¢è¿™ä¸ºåŒå­¦æŒ‡å‡ºçš„é—®é¢˜ï¼Œå½“æˆ‘è„‘å­é‡Œæƒ³çš„æ˜¯â€œå¯å˜æ€§â€çš„æ—¶å€™ï¼Œå†™å‡ºæ¥çš„å´æ˜¯â€œä¸å˜æ€§â€ï¼Œæ˜¯çœŸçš„æŠŠè‡ªå·±ç»•æ™•äº†ï¼Œä¼šæ”¹å›æ¥çš„ã€‚\n\nPSï¼šè¡¥å……çš„å†…å®¹ä¹Ÿå¾ˆå¥½ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644295954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2885349,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/06/e5/51ef9735.jpg","nickname":"A Lonely Cat","note":"","ucode":"382EBFDD8E5115","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549926,"discussion_content":"å±äºæ˜¯æ‰‹æ¯”è„‘å­å¿«äº†ğŸ˜‚ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644296283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333275,"user_name":"better","can_delete":false,"product_type":"c1","uid":1169063,"ip_address":"","ucode":"AF1DB566EBB8A5","user_header":"https://static001.geekbang.org/account/avatar/00/11/d6/a7/ac23f5a6.jpg","comment_is_top":false,"comment_ctime":1644242741,"is_pvip":false,"replies":[{"id":"121812","content":"åŠ æ²¹å“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644295973,"ip_address":"","comment_id":333275,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644242741","product_id":100103401,"comment_content":"åŠ é¤çš„å†…å®¹ï¼Œéå¸¸ä¸é”™ã€‚","like_count":1,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549923,"discussion_content":"åŠ æ²¹å“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644295973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333247,"user_name":"å¢¨æ–¹","can_delete":false,"product_type":"c1","uid":1295549,"ip_address":"","ucode":"638AE114D4CAC5","user_header":"https://static001.geekbang.org/account/avatar/00/13/c4/bd/44757daf.jpg","comment_is_top":false,"comment_ctime":1644229215,"is_pvip":false,"replies":[{"id":"121771","content":"å¦‚æœä½ è¿½æ±‚â€œä¸å˜æ€§â€ï¼Œé‚£ä¹ˆæ•°æ®ç±»çš„copyå°±æ˜¯æœ€æ–¹ä¾¿çš„é€‰æ‹©äº†ã€‚å¦åˆ™ä½ å°±å¾—varæ¥å®ç°äº†ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§å–èˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1180670","ctime":1644250198,"ip_address":"","comment_id":333247,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1644229215","product_id":100103401,"comment_content":"æ•°æ®ç±»ç”¨copyåšæ›´æ”¹ï¼Œå¤ªéº»çƒ¦äº†å§ï¼Œéš¾é“æ²¡æœ‰æ›´å¥½çš„æ–¹å¼äº†å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1180670,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/fe/0f43ef35.jpg","nickname":"æœ±æ¶›","note":"","ucode":"5AB5AFE32B8008","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549834,"discussion_content":"å¦‚æœä½ è¿½æ±‚â€œä¸å˜æ€§â€ï¼Œé‚£ä¹ˆæ•°æ®ç±»çš„copyå°±æ˜¯æœ€æ–¹ä¾¿çš„é€‰æ‹©äº†ã€‚å¦åˆ™ä½ å°±å¾—varæ¥å®ç°äº†ï¼Œè¿™å…¶å®æ˜¯ä¸€ç§å–èˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644250199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020838,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/93/a6/679b3c6b.jpg","nickname":"Renext","note":"","ucode":"3C4418F7E86CD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549971,"discussion_content":"kotlinå¯ä»¥ç”¨copyã€‚é‚£javaç±»å¼•ç”¨è¿™ä¸ªå¯¹è±¡è¦ä¿®æ”¹å€¼æ€ä¹ˆåŠï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644314670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}