{"id":132851,"title":"42ä¸¨å¦‚ä½•ä½¿ç”¨Redisæ¥å®ç°å¤šç”¨æˆ·æŠ¢ç¥¨é—®é¢˜","content":"<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹Redisæœ‰äº†åˆæ­¥çš„è®¤è¯†ï¼Œäº†è§£åˆ°Redisé‡‡ç”¨Key-Valueçš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼Œåœ¨Rediså†…éƒ¨ï¼Œä½¿ç”¨çš„æ˜¯redisObjectå¯¹è±¡æ¥è¡¨ç¤ºæ‰€æœ‰çš„keyå’Œvalueã€‚åŒæ—¶æˆ‘ä»¬è¿˜äº†è§£åˆ°Redisæœ¬èº«ç”¨çš„æ˜¯å•çº¿ç¨‹çš„æœºåˆ¶ï¼Œé‡‡ç”¨äº†å¤šè·¯I/Oå¤ç”¨çš„æŠ€æœ¯ï¼Œåœ¨å¤„ç†å¤šä¸ªI/Oè¯·æ±‚çš„æ—¶å€™æ•ˆç‡å¾ˆé«˜ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬æ¥æ›´åŠ æ·±å…¥åœ°äº†è§£ä¸€ä¸‹Redisçš„åŸç†ï¼Œå†…å®¹åŒ…æ‹¬ä»¥ä¸‹å‡ æ–¹é¢ï¼š</p><ol>\n<li>Redisçš„äº‹åŠ¡å¤„ç†æœºåˆ¶æ˜¯æ€æ ·çš„ï¼Ÿä¸RDBMSæœ‰ä½•ä¸åŒï¼Ÿ</li>\n<li>Redisçš„äº‹åŠ¡å¤„ç†çš„å‘½ä»¤éƒ½æœ‰å“ªäº›ï¼Ÿå¦‚ä½•ä½¿ç”¨å®ƒä»¬å®Œæˆäº‹åŠ¡æ“ä½œï¼Ÿ</li>\n<li>å¦‚ä½•ä½¿ç”¨Pythonçš„å¤šçº¿ç¨‹æœºåˆ¶å’ŒRedisçš„äº‹åŠ¡å‘½ä»¤æ¨¡æ‹Ÿå¤šç”¨æˆ·æŠ¢ç¥¨ï¼Ÿ</li>\n</ol><h2>Redisçš„äº‹åŠ¡å¤„ç†æœºåˆ¶</h2><p>åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥å›å¿†ä¸‹RDBMSä¸­äº‹åŠ¡æ»¡è¶³çš„4ä¸ªç‰¹æ€§ACIDï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ã€‚</p><p>Redisçš„äº‹åŠ¡å¤„ç†ä¸RDBMSçš„äº‹åŠ¡æœ‰ä¸€äº›ä¸åŒã€‚</p><p>é¦–å…ˆRedisä¸æ”¯æŒäº‹åŠ¡çš„å›æ»šæœºåˆ¶ï¼ˆRollbackï¼‰ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å½“äº‹åŠ¡å‘ç”Ÿäº†é”™è¯¯ï¼ˆåªè¦ä¸æ˜¯è¯­æ³•é”™è¯¯ï¼‰ï¼Œæ•´ä¸ªäº‹åŠ¡ä¾ç„¶ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°äº‹åŠ¡é˜Ÿåˆ—ä¸­æ‰€æœ‰å‘½ä»¤éƒ½æ‰§è¡Œå®Œæ¯•ã€‚åœ¨<a href=\"https://redis.io/topics/transactions\">Rediså®˜æ–¹æ–‡æ¡£</a>ä¸­è¯´æ˜äº†ä¸ºä»€ä¹ˆRedisä¸æ”¯æŒäº‹åŠ¡å›æ»šã€‚</p><p>åªæœ‰å½“ç¼–ç¨‹è¯­æ³•é”™è¯¯çš„æ—¶å€™ï¼ŒRediså‘½ä»¤æ‰§è¡Œæ‰ä¼šå¤±è´¥ã€‚è¿™ç§é”™è¯¯é€šå¸¸å‡ºç°åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œè€Œå¾ˆå°‘å‡ºç°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ²¡æœ‰å¿…è¦å¼€å‘äº‹åŠ¡å›æ»šåŠŸèƒ½ã€‚</p><!-- [[[read_end]]] --><p>å¦å¤–ï¼ŒRedisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œä¸åŸºäºæ–‡ä»¶çš„RDBMSä¸åŒï¼Œé€šå¸¸åªè¿›è¡Œå†…å­˜è®¡ç®—å’Œæ“ä½œï¼Œæ— æ³•ä¿è¯æŒä¹…æ€§ã€‚ä¸è¿‡Redisä¹Ÿæä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯RDBå’ŒAOFæ¨¡å¼ã€‚</p><p>RDBï¼ˆRedis DataBaseï¼‰æŒä¹…åŒ–å¯ä»¥æŠŠå½“å‰è¿›ç¨‹çš„æ•°æ®ç”Ÿæˆå¿«ç…§ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼Œè§¦å‘RDBæŒä¹…åŒ–çš„æ–¹å¼åˆ†ä¸ºæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ã€‚å› ä¸ºæŒä¹…åŒ–æ“ä½œä¸å‘½ä»¤æ“ä½œä¸æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥æ— æ³•ä¿è¯äº‹åŠ¡çš„æŒä¹…æ€§ã€‚</p><p>AOFï¼ˆAppend Only Fileï¼‰æŒä¹…åŒ–é‡‡ç”¨æ—¥å¿—çš„å½¢å¼è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå¼¥è¡¥äº†RDBåœ¨æ•°æ®ä¸€è‡´æ€§ä¸Šçš„ä¸è¶³ï¼Œä½†æ˜¯é‡‡ç”¨AOFæ¨¡å¼ï¼Œå°±æ„å‘³ç€æ¯æ¡æ‰§è¡Œå‘½ä»¤éƒ½éœ€è¦å†™å…¥æ–‡ä»¶ä¸­ï¼Œä¼šå¤§å¤§é™ä½Redisçš„è®¿é—®æ€§èƒ½ã€‚å¯ç”¨AOFæ¨¡å¼éœ€è¦æ‰‹åŠ¨å¼€å¯ï¼Œæœ‰3ç§ä¸åŒçš„é…ç½®æ–¹å¼ï¼Œé»˜è®¤ä¸ºeverysecï¼Œä¹Ÿå°±æ˜¯æ¯ç§’é’ŸåŒæ­¥ä¸€æ¬¡ã€‚å…¶æ¬¡è¿˜æœ‰alwayså’Œnoæ¨¡å¼ï¼Œåˆ†åˆ«ä»£è¡¨åªè¦æœ‰æ•°æ®å‘ç”Ÿä¿®æ”¹å°±ä¼šå†™å…¥AOFæ–‡ä»¶ï¼Œä»¥åŠç”±æ“ä½œç³»ç»Ÿå†³å®šä»€ä¹ˆæ—¶å€™è®°å½•åˆ°AOFæ–‡ä»¶ä¸­ã€‚</p><p>è™½ç„¶Redisæä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æœºåˆ¶ï¼Œä½†æ˜¯ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼ŒæŒä¹…æ€§å¹¶ä¸æ˜¯å®ƒçš„æ“…é•¿ã€‚</p><p>Redisæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œæ—¶ä¸ä¼šä¸­æ–­äº‹åŠ¡ï¼Œå…¶ä»–å®¢æˆ·ç«¯æäº¤çš„å„ç§æ“ä½œéƒ½æ— æ³•æ‰§è¡Œï¼Œå› æ­¤ä½ å¯ä»¥ç†è§£ä¸ºRedisçš„äº‹åŠ¡å¤„ç†æ˜¯ä¸²è¡ŒåŒ–çš„æ–¹å¼ï¼Œæ€»æ˜¯å…·æœ‰éš”ç¦»æ€§çš„ã€‚</p><h2>Redisçš„äº‹åŠ¡å¤„ç†å‘½ä»¤</h2><p>äº†è§£äº†Redisçš„äº‹åŠ¡å¤„ç†æœºåˆ¶ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹Redisçš„äº‹åŠ¡å¤„ç†éƒ½åŒ…æ‹¬å“ªäº›å‘½ä»¤ã€‚</p><ol>\n<li>MULTIï¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼›</li>\n<li>EXECï¼šäº‹åŠ¡æ‰§è¡Œï¼Œå°†ä¸€æ¬¡æ€§æ‰§è¡Œäº‹åŠ¡å†…çš„æ‰€æœ‰å‘½ä»¤ï¼›</li>\n<li>DISCARDï¼šå–æ¶ˆäº‹åŠ¡ï¼›</li>\n<li>WATCHï¼šç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œå¦‚æœäº‹åŠ¡æ‰§è¡Œå‰æŸä¸ªé”®å‘ç”Ÿäº†æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¹Ÿä¼šè¢«æ‰“æ–­ï¼›</li>\n<li>UNWATCHï¼šå–æ¶ˆWATCHå‘½ä»¤å¯¹æ‰€æœ‰é”®çš„ç›‘è§†ã€‚</li>\n</ol><p>éœ€è¦è¯´æ˜çš„æ˜¯Rediså®ç°äº‹åŠ¡æ˜¯åŸºäºCOMMANDé˜Ÿåˆ—ï¼Œå¦‚æœRedisæ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Œé‚£ä¹ˆä»»ä½•çš„COMMANDéƒ½ä¼šç«‹å³æ‰§è¡Œå¹¶è¿”å›ç»“æœã€‚å¦‚æœRediså¼€å¯äº†äº‹åŠ¡ï¼ŒCOMMANDå‘½ä»¤ä¼šæ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”è¿”å›æ’é˜Ÿçš„çŠ¶æ€QUEUEDï¼Œåªæœ‰è°ƒç”¨EXECï¼Œæ‰ä¼šæ‰§è¡ŒCOMMANDé˜Ÿåˆ—ä¸­çš„å‘½ä»¤ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨äº‹åŠ¡çš„æ–¹å¼å­˜å‚¨5åç©å®¶æ‰€é€‰è‹±é›„çš„ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>MULTI\nhmset user:001 hero 'zhangfei' hp_max 8341 mp_max 100\nhmset user:002 hero 'guanyu' hp_max 7107 mp_max 10\nhmset user:003 hero 'liubei' hp_max 6900 mp_max 1742\nhmset user:004 hero 'dianwei' hp_max 7516 mp_max 1774\nhmset user:005 hero 'diaochan' hp_max 5611 mp_max 1960\nEXEC\n</code></pre><p>ä½ èƒ½çœ‹åˆ°åœ¨MULTIå’ŒEXECä¹‹é—´çš„COMMANDå‘½ä»¤éƒ½ä¼šè¢«æ”¾åˆ°COMMANDé˜Ÿåˆ—ä¸­ï¼Œå¹¶è¿”å›æ’é˜Ÿçš„çŠ¶æ€ï¼Œåªæœ‰å½“EXECè°ƒç”¨æ—¶æ‰ä¼šä¸€æ¬¡æ€§å…¨éƒ¨æ‰§è¡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4a/06/4aa62797167f41599b9e514d77fc0a06.png?wh=1730*868\" alt=\"\"><br>\næˆ‘ä»¬ç»å¸¸ä½¿ç”¨Redisçš„WATCHå’ŒMULTIå‘½ä»¤æ¥å¤„ç†å…±äº«èµ„æºçš„å¹¶å‘æ“ä½œï¼Œæ¯”å¦‚ç§’æ€ï¼ŒæŠ¢ç¥¨ç­‰ã€‚å®é™…ä¸ŠWATCH+MULTIå®ç°çš„æ˜¯ä¹è§‚é”ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨ä¸¤ä¸ªRediså®¢æˆ·ç«¯æ¥æ¨¡æ‹Ÿä¸‹æŠ¢ç¥¨çš„æµç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/95/41/95e294bfb6843ef65beff61ca0bc3a41.png?wh=829*388\" alt=\"\"><br>\næˆ‘ä»¬å¯åŠ¨Rediså®¢æˆ·ç«¯1ï¼Œæ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œç„¶ååœ¨æ‰§è¡ŒEXECå‰ï¼Œç­‰å¾…å®¢æˆ·ç«¯2å…ˆå®Œæˆä¸Šé¢çš„æ‰§è¡Œï¼Œå®¢æˆ·ç«¯2çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/1b/ebbadb4698e80d81dbf7c62a21dbec1b.png?wh=775*478\" alt=\"\"><br>\nç„¶åå®¢æˆ·ç«¯1æ‰§è¡ŒEXECï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/f8/6b23c9efcdbe1f349299fc32d41ab0f8.png?wh=766*506\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°å®é™…ä¸Šæœ€åä¸€å¼ ç¥¨è¢«å®¢æˆ·ç«¯2æŠ¢åˆ°äº†ï¼Œè¿™æ˜¯å› ä¸ºå®¢æˆ·ç«¯1WATCHçš„ç¥¨çš„å˜é‡åœ¨EXECä¹‹å‰å‘ç”Ÿäº†å˜åŒ–ï¼Œæ•´ä¸ªäº‹åŠ¡å°±è¢«æ‰“æ–­ï¼Œè¿”å›ç©ºå›å¤ï¼ˆnilï¼‰ã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯MULTIåä¸èƒ½å†æ‰§è¡ŒWATCHå‘½ä»¤ï¼Œå¦åˆ™ä¼šè¿”å›WATCH inside MULTI is not allowedé”™è¯¯ï¼ˆå› ä¸ºWATCHä»£è¡¨çš„å°±æ˜¯åœ¨æ‰§è¡Œäº‹åŠ¡å‰è§‚å¯Ÿå˜é‡æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœå˜é‡æ”¹å˜äº†å°±å°†äº‹åŠ¡æ‰“æ–­ï¼Œæ‰€ä»¥åœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯MULTIä¹‹å‰ï¼Œä½¿ç”¨WATCHï¼‰ã€‚åŒæ—¶ï¼Œå¦‚æœåœ¨æ‰§è¡Œå‘½ä»¤è¿‡ç¨‹ä¸­æœ‰è¯­æ³•é”™è¯¯ï¼ŒRedisä¹Ÿä¼šæŠ¥é”™ï¼Œæ•´ä¸ªäº‹åŠ¡ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œï¼ŒRedisä¼šå¿½ç•¥è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯ï¼Œä¸ä¼šå½±å“åˆ°åé¢çš„æ‰§è¡Œã€‚</p><h2>æ¨¡æ‹Ÿå¤šç”¨æˆ·æŠ¢ç¥¨</h2><p>æˆ‘ä»¬åˆšæ‰è®²è§£äº†Redisçš„äº‹åŠ¡å‘½ä»¤ï¼Œå¹¶ä¸”ä½¿ç”¨Rediså®¢æˆ·ç«¯çš„æ–¹å¼æ¨¡æ‹Ÿäº†ä¸¤ä¸ªç”¨æˆ·æŠ¢ç¥¨çš„æµç¨‹ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Pythonç»§ç»­æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸‰ç‚¹ã€‚</p><p>åœ¨Pythonä¸­ï¼ŒRedisäº‹åŠ¡æ˜¯é€šè¿‡pipelineå°è£…è€Œå®ç°çš„ï¼Œå› æ­¤åœ¨åˆ›å»ºRedisè¿æ¥åï¼Œéœ€è¦è·å–ç®¡é“pipelineï¼Œç„¶åé€šè¿‡pipelineä½¿ç”¨WATCHã€MULTIå’ŒEXECå‘½ä»¤ã€‚</p><p>å…¶æ¬¡ï¼Œç”¨æˆ·æ˜¯å¹¶å‘æ“ä½œçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°Pythonçš„å¤šçº¿ç¨‹ï¼Œè¿™é‡Œä½¿ç”¨threadingåº“æ¥åˆ›å»ºå¤šçº¿ç¨‹ã€‚</p><p>å¯¹äºç”¨æˆ·çš„æŠ¢ç¥¨ï¼Œæˆ‘ä»¬è®¾ç½®äº†sellå‡½æ•°ï¼Œç”¨äºæ¨¡æ‹Ÿç”¨æˆ·içš„æŠ¢ç¥¨ã€‚åœ¨æ‰§è¡ŒMULTIå‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä½¿ç”¨pipe.watch(KEY)ç›‘è§†ç¥¨æ•°ï¼Œå¦‚æœç¥¨æ•°ä¸å¤§äº0ï¼Œåˆ™è¯´æ˜ç¥¨å–å®Œäº†ï¼Œç”¨æˆ·æŠ¢ç¥¨å¤±è´¥ï¼›å¦‚æœç¥¨æ•°å¤§äº0ï¼Œè¯æ˜å¯ä»¥æŠ¢ç¥¨ï¼Œå†æ‰§è¡ŒMULTIï¼Œå°†ç¥¨æ•°å‡1å¹¶è¿›è¡Œæäº¤ã€‚ä¸è¿‡åœ¨æäº¤æ‰§è¡Œçš„æ—¶å€™å¯èƒ½ä¼šå¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœç›‘è§†çš„KEYå‘ç”Ÿäº†æ”¹å˜ï¼Œåˆ™ä¼šäº§ç”Ÿå¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ•è·å¼‚å¸¸ï¼Œæ¥æç¤ºç”¨æˆ·æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡ã€‚å¦‚æœæˆåŠŸæ‰§è¡Œäº‹åŠ¡ï¼Œåˆ™æç¤ºç”¨æˆ·æŠ¢ç¥¨æˆåŠŸï¼Œæ˜¾ç¤ºå½“å‰çš„å‰©ä½™ç¥¨æ•°ã€‚</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>import redis\nimport threading\n# åˆ›å»ºè¿æ¥æ± \npool = redis.ConnectionPool(host = '127.0.0.1', port=6379, db=0)\n# åˆå§‹åŒ– redis\nr = redis.StrictRedis(connection_pool = pool)\n\n# è®¾ç½®KEY\nKEY=&quot;ticket_count&quot;\n# æ¨¡æ‹Ÿç¬¬iä¸ªç”¨æˆ·è¿›è¡ŒæŠ¢ç¥¨\ndef sell(i):\n    # åˆå§‹åŒ– pipe\n    pipe = r.pipeline()\n    while True:\n        try:\n            # ç›‘è§†ç¥¨æ•°\n            pipe.watch(KEY)\n            # æŸ¥çœ‹ç¥¨æ•°\n            c = int(pipe.get(KEY))      \n            if c &gt; 0:\n                # å¼€å§‹äº‹åŠ¡\n                pipe.multi()            \n                c = c - 1\n                pipe.set(KEY, c)        \n                pipe.execute()\n                print('ç”¨æˆ· {} æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° {}'.format(i, c))\n                break\n            else:\n                print('ç”¨æˆ· {} æŠ¢ç¥¨å¤±è´¥ï¼Œç¥¨å–å®Œäº†'.format(i))\n                break\n        except Exception as e:\n            print('ç”¨æˆ· {} æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡'.format(i))\n            continue\n        finally:\n            pipe.unwatch()\n\nif __name__ == &quot;__main__&quot;:\n    # åˆå§‹åŒ–5å¼ ç¥¨\n    r.set(KEY, 5)  \n    # è®¾ç½®8ä¸ªäººæŠ¢ç¥¨\n    for i in range(8):\n        t = threading.Thread(target=sell, args=(i,))\n        t.start()\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>ç”¨æˆ· 0 æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° 4\nç”¨æˆ· 4 æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡\nç”¨æˆ· 1 æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° 3\nç”¨æˆ· 2 æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° 2\nç”¨æˆ· 4 æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡\nç”¨æˆ· 5 æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡\nç”¨æˆ· 6 æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° 1\nç”¨æˆ· 4 æŠ¢ç¥¨æˆåŠŸï¼Œå½“å‰ç¥¨æ•° 0\nç”¨æˆ· 5 æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡\nç”¨æˆ· 3 æŠ¢ç¥¨å¤±è´¥ï¼Œé‡è¯•ä¸€æ¬¡\nç”¨æˆ· 7 æŠ¢ç¥¨å¤±è´¥ï¼Œç¥¨å–å®Œäº†\nç”¨æˆ· 5 æŠ¢ç¥¨å¤±è´¥ï¼Œç¥¨å–å®Œäº†\nç”¨æˆ· 3 æŠ¢ç¥¨å¤±è´¥ï¼Œç¥¨å–å®Œäº†\n</code></pre><p>åœ¨Redisä¸­ä¸å­˜åœ¨æ‚²è§‚é”ï¼Œäº‹åŠ¡å¤„ç†è¦è€ƒè™‘åˆ°å¹¶å‘è¯·æ±‚çš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡WATCH+MULTIçš„æ–¹å¼æ¥å®ç°ä¹è§‚é”ï¼Œå¦‚æœç›‘è§†çš„KEYæ²¡æœ‰å‘ç”Ÿå˜åŒ–åˆ™å¯ä»¥é¡ºåˆ©æ‰§è¡Œäº‹åŠ¡ï¼Œå¦åˆ™è¯´æ˜äº‹åŠ¡çš„å®‰å…¨æ€§å·²ç»å—åˆ°äº†ç ´åï¼ŒæœåŠ¡å™¨å°±ä¼šæ”¾å¼ƒæ‰§è¡Œè¿™ä¸ªäº‹åŠ¡ï¼Œç›´æ¥å‘å®¢æˆ·ç«¯è¿”å›ç©ºå›å¤ï¼ˆnilï¼‰ï¼Œäº‹åŠ¡æ‰§è¡Œå¤±è´¥åï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°è¿›è¡Œå°è¯•ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘è®²è§£äº†Redisçš„äº‹åŠ¡æœºåˆ¶ï¼ŒRedisäº‹åŠ¡æ˜¯ä¸€ç³»åˆ—Rediså‘½ä»¤çš„é›†åˆï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šæŒ‰ç…§é¡ºåºè¿›è¡Œæ‰§è¡Œï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šå—åˆ°å…¶ä»–å®¢æˆ·ç«¯çš„å¹²æ‰°ã€‚ä¸è¿‡åœ¨äº‹åŠ¡çš„æ‰§è¡Œä¸­ï¼ŒRediså¯èƒ½ä¼šé‡åˆ°ä¸‹é¢ä¸¤ç§é”™è¯¯çš„æƒ…å†µï¼š</p><p>é¦–å…ˆæ˜¯è¯­æ³•é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯åœ¨Rediså‘½ä»¤å…¥é˜Ÿæ—¶å‘ç”Ÿçš„è¯­æ³•é”™è¯¯ã€‚Redisåœ¨äº‹åŠ¡æ‰§è¡Œå‰ä¸å…è®¸æœ‰è¯­æ³•é”™è¯¯ï¼Œå¦‚æœå‡ºç°ï¼Œåˆ™ä¼šå¯¼è‡´äº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚å¦‚å®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼Œé€šå¸¸è¿™ç§æƒ…å†µåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾ˆå°‘å‡ºç°ï¼Œä¸€èˆ¬ä¼šå‘ç”Ÿåœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¦‚æœé‡åˆ°äº†è¿™ç§è¯­æ³•é”™è¯¯ï¼Œå°±éœ€è¦å¼€å‘äººå‘˜è‡ªè¡Œçº é”™ã€‚</p><p>ç¬¬äºŒä¸ªæ˜¯æ‰§è¡Œæ—¶é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯åœ¨äº‹åŠ¡æ‰§è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯ï¼Œæ¯”å¦‚å¤„ç†äº†é”™è¯¯ç±»å‹çš„é”®ç­‰ï¼Œè¿™ç§é”™è¯¯å¹¶éè¯­æ³•é”™è¯¯ï¼ŒRedisåªæœ‰åœ¨å®é™…æ‰§è¡Œä¸­æ‰èƒ½åˆ¤æ–­å‡ºæ¥ã€‚ä¸è¿‡Redisä¸æä¾›å›æ»šæœºåˆ¶ï¼Œå› æ­¤å½“å‘ç”Ÿè¿™ç±»é”™è¯¯æ—¶Redisä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œä¿è¯å…¶ä»–å‘½ä»¤çš„æ­£å¸¸æ‰§è¡Œã€‚</p><p>åœ¨äº‹åŠ¡å¤„ç†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡é”çš„æœºåˆ¶æ¥è§£å†³å…±äº«èµ„æºå¹¶å‘è®¿é—®çš„æƒ…å†µã€‚åœ¨Redisä¸­æä¾›äº†WATCH+MULTIçš„ä¹è§‚é”æ–¹å¼ã€‚æˆ‘ä»¬ä¹‹å‰äº†è§£è¿‡ä¹è§‚é”æ˜¯ä¸€ç§æ€æƒ³ï¼Œå®ƒæ˜¯é€šè¿‡ç¨‹åºå®ç°çš„é”æœºåˆ¶ï¼Œåœ¨æ•°æ®æ›´æ–°çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ï¼ŒæˆåŠŸå°±æ‰§è¡Œï¼Œä¸æˆåŠŸå°±å¤±è´¥ï¼Œä¸éœ€è¦ç­‰å¾…å…¶ä»–äº‹åŠ¡æ¥é‡Šæ”¾é”ã€‚äº‹å®ä¸Šï¼Œåœ¨åœ¨Redisçš„è®¾è®¡ä¸­ï¼Œå¤„å¤„ä½“ç°äº†è¿™ç§ä¹è§‚ã€ç®€å•çš„è®¾è®¡ç†å¿µã€‚</p><p><img src=\"\" alt=\"\"></p><p>æœ€åæˆ‘ä»¬ä¸€èµ·æ€è€ƒä¸¤ä¸ªé—®é¢˜å§ã€‚Redisæ—¢ç„¶æ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œåœ¨æ‰§è¡Œäº‹åŠ¡è¿‡ç¨‹ä¸­æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šç”¨WATCH+MULTIçš„æ–¹å¼æ¥å®ç°ä¹è§‚é”çš„å¹¶å‘æ§åˆ¶å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬åœ¨è¿›è¡ŒæŠ¢ç¥¨æ¨¡æ‹Ÿçš„æ—¶å€™ï¼Œåˆ—ä¸¾äº†ä¸¤ä¸ªRediså®¢æˆ·ç«¯çš„ä¾‹å­ï¼Œå½“WATCHçš„é”®ticketå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œäº‹åŠ¡å°±ä¼šè¢«æ‰“æ–­ã€‚è¿™é‡Œæˆ‘å°†å®¢æˆ·ç«¯2çš„SET ticketè®¾ç½®ä¸º1ï¼Œä¹Ÿå°±æ˜¯ticketçš„æ•°å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè¯·é—®æ­¤æ—¶å®¢æˆ·ç«¯1å’Œå®¢æˆ·ç«¯2çš„æ‰§è¡Œç»“æœæ˜¯æ€æ ·çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/d4/44/d4bb30f5d415ea93980c465e4f110544.png?wh=899*421\" alt=\"\"></p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œæˆ‘ä¼šå’Œä½ ä¸€èµ·äº¤æµï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµä¸€ä¸‹ã€‚</p>","neighbors":{"left":{"article_title":"41ä¸¨åˆè¯†Redisï¼šRedisä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå¿«ï¼Ÿ","id":132412},"right":{"article_title":"43ä¸¨å¦‚ä½•ä½¿ç”¨Redisæ­å»ºç©å®¶æ’è¡Œæ¦œï¼Ÿ","id":134595}},"comments":[{"had_liked":false,"id":132204,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1568042220,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"100352290028","product_id":100029501,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1ã€redisæœåŠ¡å™¨åªæ”¯æŒå•è¿›ç¨‹å•çº¿ç¨‹ï¼Œä½†æ˜¯redisçš„å®¢æˆ·ç«¯å¯ä»¥æœ‰å¤šä¸ªï¼Œä¸ºäº†ä¿è¯ä¸€è¿ä¸²åŠ¨ä½œçš„åŸå­æ€§ï¼Œæ‰€ä»¥è¦æ”¯æŒäº‹åŠ¡ã€‚<br>2ã€å®¢æˆ·ç«¯2æˆåŠŸï¼Œå®¢æˆ·ç«¯1å¤±è´¥ã€‚è¿™ä¸ªé—®é¢˜ç±»ä¼¼äºJavaå¹¶å‘çš„CASçš„ABAé—®é¢˜ã€‚redisåº”è¯¥æ˜¯é™¤äº†çœ‹ticketçš„å€¼å¤–ï¼Œæ¯ä¸ªkeyè¿˜æœ‰ä¸€ä¸ªéšè—çš„ç±»ä¼¼äºç‰ˆæœ¬çš„å±æ€§ã€‚","like_count":24,"discussions":[{"author":{"id":1012325,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/65/68bd8177.jpg","nickname":"é›ªé£é¸¿","note":"","ucode":"65D7B030828809","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49474,"discussion_content":"Redisäº‹åŠ¡ä¿è¯çš„ä¸æ˜¯åŸå­æ€§ï¼Œåªä¿è¯åŒä¸€äº‹åŠ¡ä¸­çš„å‘½ä»¤ä¸é—´æ–­æ‰§è¡Œã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1573604801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131986,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1567999483,"is_pvip":false,"replies":[{"id":"50431","content":"å¯¹çš„ï¼Œå®¢æˆ·ç«¯2 å³ä½¿SET ticketçš„æ•°å€¼æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿæ˜¯å¯¹ticketè¿›è¡Œäº†â€œä¿®æ”¹â€ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„ç‰ˆæœ¬å‘ç”Ÿäº†å˜åŒ–ï¼Œå› æ­¤å’Œæ–‡ç« ä¸­çš„ä¾‹å­ä¸€æ ·ï¼Œå®¢æˆ·ç«¯2ä¼šè¿”å›OKï¼Œå®¢æˆ·ç«¯1æ˜¯ nil","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568004654,"ip_address":"","comment_id":131986,"utype":1}],"discussion_count":1,"race_medal":0,"score":"74582443515","product_id":100029501,"comment_content":"å®¢æˆ·ç«¯2é¦–å…ˆè¿”å› OKï¼Œå®¢æˆ·ç«¯1è¿”å› nil ã€‚","like_count":17,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466713,"discussion_content":"å¯¹çš„ï¼Œå®¢æˆ·ç«¯2 å³ä½¿SET ticketçš„æ•°å€¼æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿæ˜¯å¯¹ticketè¿›è¡Œäº†â€œä¿®æ”¹â€ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„ç‰ˆæœ¬å‘ç”Ÿäº†å˜åŒ–ï¼Œå› æ­¤å’Œæ–‡ç« ä¸­çš„ä¾‹å­ä¸€æ ·ï¼Œå®¢æˆ·ç«¯2ä¼šè¿”å›OKï¼Œå®¢æˆ·ç«¯1æ˜¯ nil","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568004654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131987,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1567999605,"is_pvip":false,"replies":[{"id":"50432","content":"å¯¹çš„ï¼Œå•çº¿ç¨‹ä¸ä¸€å®šä»£è¡¨è¦æ‰§è¡Œçš„äº‹åŠ¡çš„æ¡ä»¶éƒ½æ»¡è¶³ï¼Œå› ä¸ºå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤å¯èƒ½ä¼šåœ¨WATCHä¹‹åä¿®æ”¹äº†KEYçš„å€¼ï¼ˆå¦‚æ–‡ä¸­ä¾‹å­ï¼‰ï¼Œå¯¼è‡´äº‹åŠ¡æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‰“æ–­äº‹åŠ¡æ‰§è¡Œçš„æƒ…å†µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568004908,"ip_address":"","comment_id":131987,"utype":1}],"discussion_count":2,"race_medal":0,"score":"65992509045","product_id":100029501,"comment_content":"å•çº¿ç¨‹çš„REDISä¹Ÿé‡‡ç”¨äº‹ç‰©ï¼Œæˆ‘è§‰å¾—ä¸»è¦æ˜¯ç”¨æ¥ç›‘è§†è‡ªå·±æ˜¯å¦å¯ä»¥æ‰§è¡Œçš„æ¡ä»¶æ˜¯å¦å¾—ä»¥æ»¡è¶³ï¼Œå°¤å…¶æ˜¯è¿™ä¸ªæ¡ä»¶æœ‰å¯èƒ½ä¸åœ¨REDISè‡ªèº«çš„æ§åˆ¶èŒƒå›´ä¹‹å†…çš„æ—¶å€™ã€‚","like_count":15,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466714,"discussion_content":"å¯¹çš„ï¼Œå•çº¿ç¨‹ä¸ä¸€å®šä»£è¡¨è¦æ‰§è¡Œçš„äº‹åŠ¡çš„æ¡ä»¶éƒ½æ»¡è¶³ï¼Œå› ä¸ºå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤å¯èƒ½ä¼šåœ¨WATCHä¹‹åä¿®æ”¹äº†KEYçš„å€¼ï¼ˆå¦‚æ–‡ä¸­ä¾‹å­ï¼‰ï¼Œå¯¼è‡´äº‹åŠ¡æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‰“æ–­äº‹åŠ¡æ‰§è¡Œçš„æƒ…å†µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568004908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1582134,"avatar":"https://static001.geekbang.org/account/avatar/00/18/24/36/1c4af368.jpg","nickname":"TheOne","note":"","ucode":"2A359780156A8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392580,"discussion_content":"éš¾é“è¦çš„ä¸å°±æ˜¯æ‰“æ–­äº‹åŠ¡å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631065175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169654,"user_name":"èŠ±è§ç¬‘","can_delete":false,"product_type":"c1","uid":1219485,"ip_address":"","ucode":"8A5122BC11E695","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/9d/d487c368.jpg","comment_is_top":false,"comment_ctime":1578398322,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"27348202098","product_id":100029501,"comment_content":"æ¨èä½¿ç”¨ Redis è„šæœ¬åŠŸèƒ½ æ¥ä»£æ›¿äº‹åŠ¡ æ€§èƒ½é«˜å‡ºå¾ˆå¤š","like_count":6,"discussions":[{"author":{"id":1504671,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","nickname":"æ ¾~é¾Ÿè™½å¯¿ï¼","note":"","ucode":"219B38C08979FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257997,"discussion_content":"æœ€å°‘ä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œgoogleä»€ä¹ˆå…³é”®å­—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588639722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1436683,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ec/0b/009fe3f2.jpg","nickname":"å¼“è™½","note":"","ucode":"A466600EA184A4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1504671,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","nickname":"æ ¾~é¾Ÿè™½å¯¿ï¼","note":"","ucode":"219B38C08979FE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263273,"discussion_content":"æ¨èä½¿ç”¨luaä¸¤æœ¬è¿›è¡Œredisäº‹åŠ¡æ§åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589194599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":257997,"ip_address":""},"score":263273,"extra":""},{"author":{"id":1504671,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","nickname":"æ ¾~é¾Ÿè™½å¯¿ï¼","note":"","ucode":"219B38C08979FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1436683,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ec/0b/009fe3f2.jpg","nickname":"å¼“è™½","note":"","ucode":"A466600EA184A4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264592,"discussion_content":"æ„Ÿè°¢æ‚¨äº†ï¼Œè¿˜æ˜¯ä¸æ‡‚ï¼Œä¼°è®¡æ˜¯æˆ‘èƒ½åŠ›é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589335559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":263273,"ip_address":""},"score":264592,"extra":""}]},{"author":{"id":1794060,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/60/0c/e1f012cb.jpg","nickname":"frankie","note":"","ucode":"813D1352B68A21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":218036,"discussion_content":"è€å“¥ï¼Œæ·±å…¥è®²ä¸€ä¸‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585616096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1024164,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","nickname":"é˜¿æ–¯è’‚èŠ¬","note":"","ucode":"61D5E3BDA4EBC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1794060,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/60/0c/e1f012cb.jpg","nickname":"frankie","note":"","ucode":"813D1352B68A21","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281230,"discussion_content":"luaè„šæœ¬å¯ä»¥ä¿æŒåŸå­æ€§ï¼Œåœ¨redisæœåŠ¡ç«¯å±‚é¢ä¿è¯äº†åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè„šæœ¬è¢«è§£é‡Šè¿è¡Œ\nä¸­æ–‡ç›¸å…³ä¼ é€é—¨ï¼šhttp://redisdoc.com/script/eval.html#id1\næ›´å¤šä¿¡æ¯å»ºè®®ä¸Šå®˜ç½‘ https://redis.io/commands/eval#atomicity-of-scripts","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591696449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":218036,"ip_address":""},"score":281230,"extra":""}]}]},{"had_liked":false,"id":143381,"user_name":"godfish","can_delete":false,"product_type":"c1","uid":1103211,"ip_address":"","ucode":"6516636F5F764E","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/6b/03c290de.jpg","comment_is_top":false,"comment_ctime":1571702590,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27341506366","product_id":100029501,"comment_content":"æŠ¢ç¥¨é‚£ä¸ªæˆ‘æœ‰ä¸ªé—®é¢˜æ˜¯å¦‚æœticketå¤§äº1çš„æƒ…å†µï¼Œå› ä¸ºwatchäº†keyï¼Œå®¢æˆ·ç«¯1å²‚ä¸æ˜¯ä¹ŸæŠ¢ç¥¨å¤±è´¥äº†ï¼Ÿå®é™…ä¸Šä¸åº”è¯¥å¤±è´¥å§ã€‚æˆ–è€…æ˜¯è¿™é‡Œticketçš„1ä¸æ˜¯ä»£è¡¨æ•°é‡ä»£è¡¨å…¶ä¸­ä¸€å¼ ç¥¨ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1012325,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/65/68bd8177.jpg","nickname":"é›ªé£é¸¿","note":"","ucode":"65D7B030828809","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49476,"discussion_content":"åº”è¯¥åº“å­˜å‡ä¸€ï¼Œç»“æœå°äºç­‰äº0è¡¨ç¤ºæŠ¢ç¥¨å¤±è´¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573604986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131969,"user_name":"steve","can_delete":false,"product_type":"c1","uid":1354489,"ip_address":"","ucode":"AB6D3E9FF8E77C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJETibDh9wrP19gj9VdlLRmppuG1FibI7nyUGldEXCnoqKibKIB18UMxyEHBkZNlf5vibLNeofiaN5U6Hw/132","comment_is_top":false,"comment_ctime":1567996177,"is_pvip":false,"replies":[{"id":"50433","content":"å¯ä»¥çš„ï¼Œä½¿ç”¨DECR å¯ä»¥å®ç°åŸå­æ€§çš„é€’å‡","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568005055,"ip_address":"","comment_id":131969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23042832657","product_id":100029501,"comment_content":"æ˜¯å¦èƒ½ç”¨DECRå®ç°å‘¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466701,"discussion_content":"å¯ä»¥çš„ï¼Œä½¿ç”¨DECR å¯ä»¥å®ç°åŸå­æ€§çš„é€’å‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568005055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131949,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1567990662,"is_pvip":false,"replies":[{"id":"63506","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577515251,"ip_address":"","comment_id":131949,"utype":1}],"discussion_count":2,"race_medal":1,"score":"23042827142","product_id":100029501,"comment_content":"è¿”å›ç»“æœè·Ÿä¹‹å‰ä¸€æ ·ï¼Œå› ä¸ºå®¢æˆ·ç«¯1è¿˜æ˜¯å› ä¸ºkeyå˜åŒ–äº†æ‰§è¡Œå¤±è´¥","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466691,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577515251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1127175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","nickname":"JustDoDT","note":"","ucode":"6AF0B80F00EAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8396,"discussion_content":"ä¼˜ç§€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567995013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155950,"user_name":"ABC","can_delete":false,"product_type":"c1","uid":1054958,"ip_address":"","ucode":"7501AD9C0C4A70","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/ee/a1ed60d1.jpg","comment_is_top":false,"comment_ctime":1574781508,"is_pvip":false,"replies":[{"id":"62618","content":"å—¯ Dockerå¾ˆæ–¹ä¾¿","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577077973,"ip_address":"","comment_id":155950,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14459683396","product_id":100029501,"comment_content":"æ¨èå¤§å®¶åœ¨Dockerå®¹å™¨é‡Œé¢æ­å»ºå„ç§å¼€å‘ç¯å¢ƒ,æ–¹ä¾¿è€Œä¸”åˆä¸ç”¨é…ç½®ç‰¹åˆ«å¤šä¸œè¥¿.ä»¥å‰æˆ‘æ˜¯åœ¨Windowsä¸Šç›´æ¥éƒ¨ç½²MySQLä½œä¸ºå¼€å‘ç¯å¢ƒ,åæ¥å°±æ¢åˆ°Dockeräº†,æ‰å‘ç°é‚£ä¹ˆæ–¹ä¾¿!~","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475935,"discussion_content":"å—¯ Dockerå¾ˆæ–¹ä¾¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577077973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360284,"user_name":"æ˜æœˆ","can_delete":false,"product_type":"c1","uid":1070166,"ip_address":"é™•è¥¿","ucode":"E180B0EC24EFE8","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/56/5a5098d1.jpg","comment_is_top":false,"comment_ctime":1666398910,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666398910","product_id":100029501,"comment_content":"ä¸æ˜¯ä¸²è¡ŒåŒ–äº‹ç‰©äº†ä¹ˆï¼Œæ²¡æœ‰é—®é¢˜","like_count":0},{"had_liked":false,"id":315321,"user_name":"è´è¶","can_delete":false,"product_type":"c1","uid":1193167,"ip_address":"","ucode":"8019924D99182F","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/cf/0a316b48.jpg","comment_is_top":false,"comment_ctime":1633831695,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1633831695","product_id":100029501,"comment_content":"è™½ç„¶Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†æ˜¯å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œå¤šä¸ªæ“ä½œæ—¶å´æ— æ³•ä¿è¯åŸå­æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šä¸ªæŒ‡ä»¤æ˜¯äº¤å‰æ‰§è¡Œçš„","like_count":0,"discussions":[{"author":{"id":1193874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","nickname":"æˆäººä»¥ğŸŸï¼Œä¸å¦‚æˆäººä»¥æ¸”","note":"","ucode":"BD53829E924B66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531347,"discussion_content":"å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œå¤šä¸ªæ“ä½œRedisæ—¶ï¼Œä¹Ÿæ˜¯ç”±Rediså•çº¿ç¨‹æ¨¡å‹æ‰§è¡Œçš„ï¼Œä¸å­˜åœ¨ç›¸åŒèµ„æºçš„ç«æ€è®¿é—®ã€‚ä½ è¯´çš„è¿™ä¸ªåŸå› ä¸æˆç«‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637290743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255844,"user_name":"å¤§æ©˜ä¸ºé‡","can_delete":false,"product_type":"c1","uid":1104566,"ip_address":"","ucode":"E64EB8A9E23A18","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/b6/5f80d0dc.jpg","comment_is_top":false,"comment_ctime":1603442175,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1603442175","product_id":100029501,"comment_content":"ç”¨ redis lua script æ¥å®ç°æ›´æ–¹ä¾¿","like_count":0},{"had_liked":false,"id":231566,"user_name":"ä¸Šæ ¡","can_delete":false,"product_type":"c1","uid":1069548,"ip_address":"","ucode":"DEE1CEE9E4C680","user_header":"https://static001.geekbang.org/account/avatar/00/10/51/ec/3d51d5e6.jpg","comment_is_top":false,"comment_ctime":1593708889,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1593708889","product_id":100029501,"comment_content":"rediså†…æŠ¢å®Œç¥¨å¦‚ä½•åŒæ­¥åˆ°mysqlå‘¢ï¼Ÿå¦‚ä½•å’Œmysqlæœ€ç»ˆä¸€è‡´æ€§ï¼Ÿæ˜¯é€šè¿‡æŒä¹…åŒ–ï¼Ÿè¿˜æ˜¯è¯´æŠ¢ç¥¨æˆåŠŸå°±åŒæ­¥å‘¢ï¼Ÿè€å¸ˆæœ‰æ²¡æœ‰ç»éªŒåˆ†äº«ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":2172386,"avatar":"https://static001.geekbang.org/account/avatar/00/21/25/e2/cfb43a8e.jpg","nickname":"äº’è”ç½‘ç –ç“¦åŒ ","note":"","ucode":"107F18AD8E6DA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366982,"discussion_content":"æŠ¢ç¥¨æˆåŠŸæ‰”åˆ°æ¶ˆæ¯é˜Ÿåˆ—ç„¶åæ›´æ–°åˆ°æ•°æ®åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618230454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224538,"user_name":"å°ç™½èœ","can_delete":false,"product_type":"c1","uid":1568340,"ip_address":"","ucode":"ACD1267D329B96","user_header":"https://static001.geekbang.org/account/avatar/00/17/ee/54/dac0a6b6.jpg","comment_is_top":false,"comment_ctime":1591434294,"is_pvip":false,"replies":[{"id":"82642","content":"å—¯å—¯ åé¢æœ‰æœºä¼šå†æ‹“å±•å†™ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1591441907,"ip_address":"","comment_id":224538,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591434294","product_id":100029501,"comment_content":"æ€»æ„Ÿè§‰åé¢è¿™å‡ ç¯‡è®²çš„Redis,æœ‰ç‚¹æµ…æ˜¾ï¼ŒæŠ›ç –å¼•ç‰ä¸€ä¸‹ã€‚å¯èƒ½ç”±äºç¯‡å¹…çš„ç¼˜æ•…å§ï¼","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497514,"discussion_content":"å—¯å—¯ åé¢æœ‰æœºä¼šå†æ‹“å±•å†™ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591441907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195901,"user_name":"åšå¼ˆ","can_delete":false,"product_type":"c1","uid":1433344,"ip_address":"","ucode":"B1A69837E41972","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/EcYNib1bnDf5dz6JcrE8AoyZYMdqic2VNmbBtCcVZTO9EoDZZxqlQDEqQKo6klCCmklOtN9m0dTd2AOXqSneJYLw/132","comment_is_top":false,"comment_ctime":1585222958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585222958","product_id":100029501,"comment_content":"é—®é¢˜ä¸€ï¼šæˆ‘è®¤ä¸ºæ˜¯ç”¨æ¥åˆ¤æ–­å½“å‰äº‹åŠ¡æ‰§è¡Œå¾—æ¡ä»¶æ˜¯å¦æ»¡è¶³<br>é—®é¢˜äºŒï¼šè¿™æ˜¯ABAé—®é¢˜ï¼Œæ¯å˜åŒ–ä¸€æ¬¡ï¼Œç›¸åº”çš„ç‰ˆæœ¬ä¹Ÿä¼šè·Ÿç€å˜åŒ–","like_count":0},{"had_liked":false,"id":188598,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1584373285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584373285","product_id":100029501,"comment_content":"Redis é›†ç¾¤çš„æƒ…å†µä¸‹ï¼Œä¼šä¸ä¼šæŠ¢ç¥¨å°±å› æ­¤ä¸é€‚ç”¨ï¼Ÿ","like_count":0},{"had_liked":false,"id":146306,"user_name":"æ‰¶å¹½","can_delete":false,"product_type":"c1","uid":1322612,"ip_address":"","ucode":"1400EDFF8970D3","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/74/88c613e0.jpg","comment_is_top":false,"comment_ctime":1572493123,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572493123","product_id":100029501,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1ï¼ŒRedisæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œå¤šä¸ªå®¢æˆ·ç«¯åœ¨å¹¶å‘è®¿é—®çš„æ—¶å€™è¦åœ¨å¤šä¸ªçº¿ç¨‹é—´åˆ‡æ¢æ¥äº¤æ›¿æ‰§è¡Œï¼Œæ‰€ä»¥è¿˜æ˜¯è¦è¿›è¡Œå¹¶å‘æ§åˆ¶ã€‚<br>2ï¼Œï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":132482,"user_name":"æ°´å¦‚å¤©","can_delete":false,"product_type":"c1","uid":1069822,"ip_address":"","ucode":"50AE29168947CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/52/fe/1241bc83.jpg","comment_is_top":false,"comment_ctime":1568131922,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568131922","product_id":100029501,"comment_content":"èƒ½åˆ†æä¸‹JSONç±»å‹çš„å­˜å‚¨å’ŒæŸ¥è¯¢åŸç†å—","like_count":0},{"had_liked":false,"id":131985,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1567999432,"is_pvip":false,"replies":[{"id":"63505","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577515235,"ip_address":"","comment_id":131985,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567999432","product_id":100029501,"comment_content":"å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘è§‰å¾—åŸå› åœ¨äºWATCH+MULTIä¸»è¦æ˜¯äº‹ç‰©æ¥ç›‘è§†è‡ªèº«æ‰§è¡Œå¾—ä»¥çš„æ¡ä»¶æ˜¯å¦æ»¡è¶³çš„","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466712,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577515235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131971,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1567996552,"is_pvip":false,"replies":[{"id":"50430","content":"å¯¹ ä¸²è¡ŒåŒ–çš„ï¼Œæ‰€ä»¥åŒä¸€æ—¶åˆ»ä¹Ÿä¼šè¿›è¡Œä¸²è¡ŒåŒ–çš„å¤„ç†ï¼Œæ¯”å¦‚é¡ºåºä¸ºï¼šå®¢æˆ·ç«¯1 watch -&gt; å®¢æˆ·ç«¯2 watchï¼Œæˆ–è€…æ˜¯ å®¢æˆ·ç«¯2 watch -&gt; å®¢æˆ·ç«¯1watchï¼Œéƒ½æœ‰å¯èƒ½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568004474,"ip_address":"","comment_id":131971,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567996552","product_id":100029501,"comment_content":"ä¸Šé¢çš„æŠ¢ç¥¨æ—¶åºï¼ŒRedisæ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œä¸èƒ½åœ¨T2æ—¶åˆ»åŒæ—¶ä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½æ‰§è¡ŒWatchå§ã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466703,"discussion_content":"å¯¹ ä¸²è¡ŒåŒ–çš„ï¼Œæ‰€ä»¥åŒä¸€æ—¶åˆ»ä¹Ÿä¼šè¿›è¡Œä¸²è¡ŒåŒ–çš„å¤„ç†ï¼Œæ¯”å¦‚é¡ºåºä¸ºï¼šå®¢æˆ·ç«¯1 watch -&amp;gt; å®¢æˆ·ç«¯2 watchï¼Œæˆ–è€…æ˜¯ å®¢æˆ·ç«¯2 watch -&amp;gt; å®¢æˆ·ç«¯1watchï¼Œéƒ½æœ‰å¯èƒ½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568004474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}