{"id":189010,"title":"14丨性能测试场景：如何理解业务模型？","content":"<p>性能场景中的业务模型是性能测试工作中非常重要的一部分。而在我们真实的项目中，业务模型跟线上的业务模型不一样的情况实在是太多了。原因可能多种多样，这些原因大大降低了性能测试的价值。</p><p>有人说，就是因为这样才应该直接用生产流量的方式来做嘛，这样就不用管业务模型了，直接就有生产的业务模型了。没错，只要你能通过生产流量扩大回放的方式实现压力部分，确实可以不用考虑业务场景了。但这么做的前提也必须是你的生产流量来源是可以覆盖想要测试的业务场景的。</p><h2>回放的逻辑</h2><p>回放的逻辑是这样的。</p><p><img src=\"https://static001.geekbang.org/resource/image/3a/ce/3a64cf7335ffbc5cec29900354e918ce.jpg?wh=2962*1724\" alt=\"\"></p><p>如果你喜欢的话，还可以在每一个业务产品和基础架构的层面做接口的回放，甚至我们可以直接在数据库中回放SQL。而这些手段，都是为了模拟生产的业务模型。</p><p>这是非常容易理解的逻辑吧。</p><p>这里要批驳一个观点，就是有些人觉得只有通过生产流量回放的方式，才是真实地 模拟了线上的流量。事实上，这个观点是偏颇的。前几天有一个性能测试工程师问我一个流量回放过程中遇到的问题，谈到为什么要用流量回放。他说他们领导觉得这个最新潮最直接最正确，但实际上他得到的那段业务流量根本不能完全覆盖想测试的场景，最后折腾了一个月也是无功而返。</p><p>我知道，现在有很多人在各种场合说，可以直接在生产环境中，通过业务统计动态统计出业务场景，并实时实现到性能平台中去。这当然是一个很好的路子，但这个路子需要完整的技术实现，并且在不同的企业中，这种方式难就难在创建业务模型的统计算法，此外还要有高层领导的支持，才能真正实现完整的逻辑。</p><!-- [[[read_end]]] --><p>所以在今天的文章中，我想写的是最朴素的逻辑。那就是从生产数据统计，怎么转化到具体的场景中的业务模型。明白了这个逻辑之后，不管你是用生产流量回放，还是用实时业务量统计，还是线下业务量统计，你会发现原理都是一样的。</p><p>这是一个真实的案例，我已经把所有的业务名都替换掉了，同时对业务量级也做了降级调整，但这并不影响描述获取业务场景的完整性。</p><p>原系统的量级如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/be/c25bb69556b8f7f409bc620ef42c37be.png?wh=772*400\" alt=\"\"></p><p>这里我将降低10倍处理。</p><h2>生产数据统计</h2><p>首先我们从生产环境取出数据，粒度到秒级，取出所有业务的交易量数据。</p><p>业务量级按天统计的生成图如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/b1/43/b18ad11f4fb4ed38ff70aaf73d730843.png?wh=1049*527\" alt=\"\"></p><p>我为什么要取这一段时间的数据呢？答案很简单，因为这一段时间完整地体现了这个<strong>业务系统的峰值数据</strong>。</p><p>从这样的数据中取出业务量最高的一天，最大的业务量是2000万左右。</p><p>注意，我这里说的是业务量最高的一天，并不是说我们的业务场景只从这一天产生，还有别的时间，可能业务量不多，但是业务比例会完全不同，这也是要取出来的场景，所以这个统计数据到业务模型的分析过程会比较细致。我们把这一天的逻辑说完后，你就会明白其他的场景获取方式。</p><p>接着，我再以小时为单位统计出业务量比例。如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/48/3a/48a4a0d7b640ce14406f722999c6b63a.png?wh=1123*425\" alt=\"\"></p><p>从上图显然可以看出哪个小时的业务量最大，那就是9点。</p><p>但是呢，你不要忘记了，在16点的时候，明显蓝色表示的那个业务量是大于9点时的业务量的。这个也是要取出来的场景。</p><p>如果需要更细的数据，我们可以以分钟为单位看一下这个小时内的业务量分布。</p><p><img src=\"https://static001.geekbang.org/resource/image/78/13/78c8b548205520deb627dd033de0cb13.png?wh=1285*561\" alt=\"\"></p><p>如果你的业务有必要从分钟或秒来看的话，可以按分钟或秒来取场景比例。在我们今天的这个案例中，取到小时就已经足够。因为我要的是业务模型，而不是生产TPS量级。</p><p>另外，既然说到了这里，我再把生产TPS量级的统计说一下。有了上面的分钟统计比例，就可以很容易统计出生产环境中每个业务的最大TPS了。这里得到的TPS将是最有效的测试是否通过的SLA指标。</p><p>下面我们再以小时为单位做出百分比图。</p><p><img src=\"https://static001.geekbang.org/resource/image/8b/4e/8bf4cb8e7a949dd80eff31d9be03004e.png?wh=1263*585\" alt=\"\"></p><p>为什么要做百分比图呢？因为这个比例才是我们在性能场景中设置的TPS比例，是最直接有效的比例。</p><h2>业务模型计算过程</h2><p>针对这一天中的数据，我们将做出以下三个业务模型。</p><ol>\n<li>通用业务场景模型。就是将这一天的所有业务数加在一起，再将各业务整天的交易量加在一起，计算各业务量的比例。</li>\n<li>9点钟的业务模型。将9点钟的业务比例直接拿出来用。</li>\n<li>16点的业务模型。将16点钟的业务比例直接拿出来用。</li>\n</ol><p>首先我们看一下通用业务模型。</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/74/b0aa820312cb9eed421ca3cded00dd74.jpg?wh=1708*2042\" alt=\"\"></p><p>我们将上面的0%的业务全部删除，再计算一次百分比，得到测试场景中的业务比例。如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/e9/ce/e931d14ca74a7a5674687c1200306ace.png?wh=1147*692\" alt=\"\"></p><p>做为最基础的业务比例，这个可以覆盖大部分的业务时间了。</p><p>在通用的业务场景中，如果业务团队有给出明确的TPS指标，那就有依赖了。但是，如果没有给的话，也不要气馁。我们可以根据系统的运行时段，\b计算平均值即可。</p><p>因为我们这个系统是24小时系统，所以我用24小时来计算。得到如下值：</p><p>$TPS1 = \\frac{20000000}{24*3600} = 231$</p><p>也就是说通用场景中，TPS不能低于231。</p><p>接着我们看下9点的业务模型。计算方法和上面一样，最后得出比例。</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/fe/8f665c118fc36fe62167dcbcc8f8f2fe.png?wh=1155*695\" alt=\"\"></p><p>我们可以从小时图中看到，9点的业务量总和有120万左右。为了方便，这里我拿120万来计算。它的生产TPS就是：1,200,000 / 3600 = 333。</p><p>$TPS2 = \\frac{1200000}{3600} = 333$</p><p>显然，这个模型下做场景时就不能低于333TPS。</p><p>最后看一下16点的业务场景。</p><p><img src=\"https://static001.geekbang.org/resource/image/e3/26/e39e694cd9c0d77d613785dd4de9d426.png?wh=1144*696\" alt=\"\"></p><p>从小时图中，我们可以看到，16点的业务量总和有100万左右。为了方便，这里我拿100万来计算。它的生产TPS就是：</p><p>$TPS3 = \\frac{1,000,000}{3600} = 277$</p><p>显然，这个模型下做场景时就不能低于277TPS。</p><p>但是请注意，像9点业务模型中的业务11，占比达到30.25%；而16点业务模型中只有8.69%。虽然TPS差不多，但是业务比例差别大，这两种业务模型下，对系统资源的消耗会完全不一样。</p><p>最后我稍微说一下TPS的控制。</p><p>有了这个计算过程，当我们把这些比例设计到场景中去的时候，一定要注意这些TPS的比例在运行过程中，不能发生大的变化。一旦压力发起后，由于各业务的响应时间随着压力的增加发生的变化量不同，就会导致运行过程中业务比例出现很大的偏差。</p><p>我们做性能测试工程师的，都有过这样的经历。通常，在LoadRunner里，会用<code>pacing</code>来控制TPS，而用JMeter的，则会用<code>Constant Throughput Timer</code>来控制TPS。</p><h2>总结</h2><p>在这一篇中，我描述了业务模型的来源和计算过程。其实就是一些常规的求和平均计算，只要判断出哪一段业务是我们需要的就可以了。</p><p>另外我也强调了，不管用什么炫酷的手段来实现生产环境的流量模拟，最终的目标是实现和线上比较接近的业务模型。不是说一定用生产流量回放才是正确的，只有适合自己企业的手段才是最正确的。</p><h2>问题</h2><p>那么最后给你留两个问题，为什么业务比例对性能场景如此重要？以及如何在执行场景过程中控制TPS比例呢？</p><p>欢迎你在评论区写下你的思考，也欢迎把这篇文章分享给你的朋友或者同事，一起交流一下。</p>","comments":[{"had_liked":false,"id":259227,"user_name":"SeaYang","can_delete":false,"product_type":"c1","uid":1393840,"ip_address":"","ucode":"F44622A44CE8B9","user_header":"https://static001.geekbang.org/account/avatar/00/15/44/b0/c196c056.jpg","comment_is_top":false,"comment_ctime":1604656719,"is_pvip":false,"replies":[{"id":"94340","content":"一看就是有实践经验的。优秀！","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1604791710,"ip_address":"","comment_id":259227,"utype":1}],"discussion_count":1,"race_medal":0,"score":"70324133455","product_id":100042501,"comment_content":"1、为什么业务比例对性能场景如此重要？<br>业务比例一般都是从生产数据统计来的，设置这样的比例能够更真实地模拟生产流量模型<br>2、如何在执行场景过程中控制 TPS 比例呢？<br>以jmeter为例，我们使用的是Throughput Shaping Timer和Weighted Switch Controller这两个插件。Weighted Switch Controller是比例控制器，控制的是压力的比例，其实也是控制了TPS的比例了，这个时候随着线程数增加，TPS一般会往上增加直到达到最大TPS。另外，我们还会使用控制接口最大TPS的方式去压，这个时候就会用到Throughput Shaping Timer，这个是控制接口最大TPS的元件，如果多个接口都在一个线程组里面的话，需要和比例控制器一起使用，如果在不同的线程组，则不需要","like_count":16,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508881,"discussion_content":"一看就是有实践经验的。优秀！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604791710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171995,"user_name":"Taylor","can_delete":false,"product_type":"c1","uid":1117189,"ip_address":"","ucode":"6FD5A6268E9CAA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/05/21a1022a.jpg","comment_is_top":false,"comment_ctime":1579064797,"is_pvip":false,"replies":[{"id":"66689","content":"暂时没有计划说这一块的内容。等后期全部更新完毕之后，如果有更多人询问这个问题。再考虑是否加餐。<br>","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579069301,"ip_address":"","comment_id":171995,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31643835869","product_id":100042501,"comment_content":"Elk分析业务比例具体细节能介绍下吗","like_count":7,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481575,"discussion_content":"暂时没有计划说这一块的内容。等后期全部更新完毕之后，如果有更多人询问这个问题。再考虑是否加餐。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579069301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180107,"user_name":"顺利","can_delete":false,"product_type":"c1","uid":1618652,"ip_address":"","ucode":"C904941C8BA6DA","user_header":"https://static001.geekbang.org/account/avatar/00/18/b2/dc/67e0e985.jpg","comment_is_top":false,"comment_ctime":1582188299,"is_pvip":false,"replies":[{"id":"69959","content":"1，控制了时间的话，如果最大tps之前就达到了控股的时间，肯定就测试不出最大tps了呀。<br>2，是。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582194559,"ip_address":"","comment_id":180107,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27351992075","product_id":100042501,"comment_content":"老师我的问题如下，望得到解答：<br>1.用业务比例来进行容量测试时，用Constant Throughput Timer控制了tps，是不是就压不到最大值了，受限于所设置的tps值，觉得这里设置的tps和想要得到的最大TPS值冲突了<br>2.用业务比例来进行容量测试时，是不是需要同时使用吞吐量控制器（来控制业务的百分比）和常数吞吐量定时器（控制总TPS），如果不是，那应该怎么实现呢。","like_count":6,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484528,"discussion_content":"1，控制了时间的话，如果最大tps之前就达到了控股的时间，肯定就测试不出最大tps了呀。\n2，是。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582194559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1786499,"avatar":"","nickname":"一念","note":"","ucode":"E647C079BC894A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292124,"discussion_content":"控制了时间的话，这个是场景执行的时间吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595086992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248708,"user_name":"number717","can_delete":false,"product_type":"c1","uid":2053851,"ip_address":"","ucode":"FDFF2A6D090E15","user_header":"https://static001.geekbang.org/account/avatar/00/1f/56/db/00cc2977.jpg","comment_is_top":false,"comment_ctime":1600267755,"is_pvip":false,"replies":[{"id":"93961","content":"不同的角度。举个例子，在电商系统中要下一个订单，对用户就是点个按钮，对后面的每个系统都会产生调用。我们从这个按钮开始往后捊的话，就可以有一个业务路径图了。<br>直接从接口上是比较难统计出业务逻辑的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1604283136,"ip_address":"","comment_id":248708,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23075104235","product_id":100042501,"comment_content":"高老师，这里的业务肯定是包含了多个接口，你这里的业务是怎么统计的啊，在网关上只能看到每个接口的调用量，有的接口可能在多个业务中都有调用，这怎么统计啊？可不可以大概说说您的业务是怎么统计出来的啊？","like_count":6,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505720,"discussion_content":"不同的角度。举个例子，在电商系统中要下一个订单，对用户就是点个按钮，对后面的每个系统都会产生调用。我们从这个按钮开始往后捊的话，就可以有一个业务路径图了。\n直接从接口上是比较难统计出业务逻辑的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604283136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172615,"user_name":"律飛","can_delete":false,"product_type":"c1","uid":1462608,"ip_address":"","ucode":"65394E437AD2DF","user_header":"https://static001.geekbang.org/account/avatar/00/16/51/50/f5f2a121.jpg","comment_is_top":false,"comment_ctime":1579236348,"is_pvip":false,"replies":[{"id":"66935","content":"思路是对的。<br>问题1：按基准测试中获取的最优响应时间来计算。<br>问题2：递增的比例要看具体场景了，和响应时间，tps量级，业务特点都会有关。增加比例就参考我写的经验值就行了。<br>问题3：业务模型是要一直保持的。所以不能只看线程数，而应该强调tps比例的一致性。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579239991,"ip_address":"","comment_id":172615,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23054072828","product_id":100042501,"comment_content":"1.为什么业务比例对性能场景如此重要？<br>不同的业务对系统资源的消耗完全不一样，如果业务比例跟实际的业务比例不一样，就会导致运行过程中资源消耗出现很大的偏差，那么得到的结果不够真实正确，也大大降低了性能测试的价值。<br>另外，如果生产流量来源是可以覆盖想要测试的业务场景的，可以通过生产流量扩大回放的方式实现压力部分，就不用考虑业务场景了。<br>2.如何在执行场景过程中控制 TPS 比例呢？<br>通常，在 LoadRunner 里，会用pacing来控制 TPS，而用 JMeter 的，则会用Constant Throughput Timer来控制 TPS。注意，JMeter中，Throughput Controller并不控制TPS。<br>另外请教老师，根据业务模型推算出各业务的TPS，从而根据公式，结合响应时间推算出压力机线程数。这个思路对吗？如果对，如何进一步确定压力机线程数配置，具体来说，问题1，响应时间怎么获取？是业务提出的，还是基准测试中获得的最大TPS对应的响应时间？问题2，推算出来的压力机线程数就是测试中的最大值吗？是否需要适当加大一些呢？如果需要，增加多少合适？如果不是测试中的最大值，怎么取值？问题3，在一次场景测试中，业务模型是一直要保持吗？比如说，起始线程数的配置也是要按业务比例计算吗？中间任一时刻都得按业务比例设计吗？","like_count":5,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481793,"discussion_content":"思路是对的。\n问题1：按基准测试中获取的最优响应时间来计算。\n问题2：递增的比例要看具体场景了，和响应时间，tps量级，业务特点都会有关。增加比例就参考我写的经验值就行了。\n问题3：业务模型是要一直保持的。所以不能只看线程数，而应该强调tps比例的一致性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579239991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228409,"user_name":"败给了自己","can_delete":false,"product_type":"c1","uid":2040654,"ip_address":"","ucode":"05C7D9D2F36D97","user_header":"https://static001.geekbang.org/account/avatar/00/1f/23/4e/fa6e4e83.jpg","comment_is_top":false,"comment_ctime":1592660928,"is_pvip":false,"replies":[{"id":"84268","content":"1, 通用模型按有业务的平均来算即可，这个系统说是24小时的。<br>2，是偏高的。性能模型就是要偏高一点。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1592741822,"ip_address":"","comment_id":228409,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18772530112","product_id":100042501,"comment_content":"老师，你好，有两个疑问。1、上面按小时的统计中，业务集中在早上9点到凌晨，在凌晨到早上9点基本很少业务。而通用模型中，按照24小时来算tps指标，合适吗？ 2、每天的业务量2000万是估算的吗？ 实际上凌晨到早上这段时间系统业务量基本没有，对这段时间对性能测试来说基本就是无效时间吧。所以我认为一天的业务量没有两千万。 大约可以按照15小时有效时间，估算每小时70万（亦或计算平均值）。tps1=700000&#47;3600=194。 我刚觉tps1=231，是偏高了的 。","like_count":4,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499023,"discussion_content":"1, 通用模型按有业务的平均来算即可，这个系统说是24小时的。\n2，是偏高的。性能模型就是要偏高一点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592741822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236340,"user_name":"anti","can_delete":false,"product_type":"c1","uid":1067058,"ip_address":"","ucode":"6A14BBB9B9DEE7","user_header":"","comment_is_top":false,"comment_ctime":1595393542,"is_pvip":false,"replies":[{"id":"87952","content":"从接口层也可以统计。但事先你得知道哪些接口组成哪些业务。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1596069849,"ip_address":"","comment_id":236340,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14480295430","product_id":100042501,"comment_content":"老师，你这边是怎么做到业务统计的？api网关只有接口层的，无业务层的，这块需要怎么做？","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502028,"discussion_content":"从接口层也可以统计。但事先你得知道哪些接口组成哪些业务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596069849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2053851,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/56/db/00cc2977.jpg","nickname":"number717","note":"","ucode":"FDFF2A6D090E15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306432,"discussion_content":"同问啊，怎么做业务统计啊？网关看到的都是接口的调用统计，不是业务的啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600267583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202601,"user_name":"赫拉","can_delete":false,"product_type":"c1","uid":1700634,"ip_address":"","ucode":"F8368316AA6F01","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJrGia7c6VRslfS3YJfHib84mibKGnGshUn3cWFJxhm9MjEMuwJibsTpvZI2yW2LJO1bLBgcglVdRxMZA/132","comment_is_top":false,"comment_ctime":1586013410,"is_pvip":false,"replies":[{"id":"75761","content":"这个就是针对性的测试了，在我的逻辑中，不能做为容量场景的模型，可以做为基准测试的模型。因为业务覆盖不完整。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1586075055,"ip_address":"","comment_id":202601,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14470915298","product_id":100042501,"comment_content":"问题1：业务比例不一样，对系统的资源消耗可能不一样，性能的目的就是模拟生产的情况提前发现系统的问题从而解决掉它。<br><br>高老师，请教下：业务比例是针对系统的所有业务给出来的，但实际压测，并不是要压测所有的业务，例如，系统有4个业务分别为A、B、C、D，他们的业务比例分别为40%、30%、20%、10%，假如本次压测是业务B、C，A和D不做压测，那容量测试的业务比例是设置合适呢","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490628,"discussion_content":"这个就是针对性的测试了，在我的逻辑中，不能做为容量场景的模型，可以做为基准测试的模型。因为业务覆盖不完整。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586075055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171871,"user_name":"仲先生","can_delete":false,"product_type":"c1","uid":1195667,"ip_address":"","ucode":"32ED1502B34C8F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJIAsYWQZ6AlG9NG94C19FfzEhFU0RkF7iarQblNb2s8DAzB6mnQIR8ibQQRVI4lhNgPV6ssjlDNtQ/132","comment_is_top":false,"comment_ctime":1579048375,"is_pvip":false,"replies":[{"id":"66673","content":"elk就可以分析呀。比例图用excel就能画。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579063531,"ip_address":"","comment_id":171871,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14463950263","product_id":100042501,"comment_content":"高老师，有哪些好用的工具可以辅助分析业务比例么？文中的比例图是怎么画出来的呀？","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481535,"discussion_content":"elk就可以分析呀。比例图用excel就能画。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579063531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1701562,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLibCKJYwlyLEIWicNxJSuIwIbCZqfGIbzfF5mKicjWIrGkibBgM4E0dSNekhzdaoyzabmZPTxicTCv7TQ/132","nickname":"障碍物","note":"","ucode":"46872942956A1C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135137,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579071990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306832,"user_name":"jy","can_delete":false,"product_type":"c1","uid":1785172,"ip_address":"","ucode":"F4E179C435451B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJ6G2xZvNRmhyXBjmGbI5G8icGCCMPupr6yxZ1IcURwp7GTRHcpWGWpg9A0fLlyicmVdDwzqZqwiaOQ/132","comment_is_top":false,"comment_ctime":1628738832,"is_pvip":false,"replies":[{"id":"111134","content":"对，在这业务接口级别统计就不要管内部调用了。如果你是在测试的不是业务接口级别，就是每一个具体的请求级接口，那就进去统计细的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1628767555,"ip_address":"","comment_id":306832,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10218673424","product_id":100042501,"comment_content":"===================引用开始=======================<br>5.就拿登录来说，它下面应该包含多个get或post请求，有静态资源请求，有接口请求，其它4个业务查询商品、添加购物车、创建订单、支付下面也包含多个get、post请求，而且某些get或post请求在5个业务中都会被调用。这么多的请求在日志中混在一起，怎么才能得出业务比例20:40:20:10:10？我看老师提到用ELK，不过可以简单的说下背后的原理吗。（备注：我接触过的应用是单体应用nginx-tomcat-mysql，不是微服务。不过我想专栏中业务模型比例计算的逻辑是通用的，应该和架构没关系。）<br>作者回复:<br>5. 统计接口的比例，再对应相应的业务操作就可以了。<br>===================引用结束=======================<br><br>本来想群里问，但是想着老师答复后，大家看这个记录就可以了，群消息会被冲掉。<br>老师，你好，像这位同学说的，比如登录接口，可能内部调了其它接口，很多接口请求都在一个日志中，我们是只需要统计非内部调用的业务接口么？比如，我只需要统计“登录、查询商品、添加购物车、创建订单、支付”这几个业务接口的比例即可，内部调用的那些接口不管，是这样么？","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524938,"discussion_content":"对，在这业务接口级别统计就不要管内部调用了。如果你是在测试的不是业务接口级别，就是每一个具体的请求级接口，那就进去统计细的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628767555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211091,"user_name":"😁","can_delete":false,"product_type":"c1","uid":1978437,"ip_address":"","ucode":"2A5F982416D662","user_header":"https://static001.geekbang.org/account/avatar/00/1e/30/45/e6928eb3.jpg","comment_is_top":false,"comment_ctime":1587894078,"is_pvip":false,"replies":[{"id":"81996","content":"举例来说，如果一个业务有几个接口，那就单接口先测，再组合起来测试一个业务。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590751447,"ip_address":"","comment_id":211091,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10177828670","product_id":100042501,"comment_content":"老师，对于小白来说都有这样的基础问题，业务是怎么定义的，一个接口就是一个业务，还是某个功能的一系列接口统称为一个业务，后者的话是加一个事务控制器实现吗？望老师解惑","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493197,"discussion_content":"举例来说，如果一个业务有几个接口，那就单接口先测，再组合起来测试一个业务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590751447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172244,"user_name":"kubxy","can_delete":false,"product_type":"c1","uid":1514411,"ip_address":"","ucode":"EDA317D303CC42","user_header":"https://static001.geekbang.org/account/avatar/00/17/1b/ab/a5f88914.jpg","comment_is_top":false,"comment_ctime":1579139302,"is_pvip":false,"replies":[{"id":"66815","content":"你这1和2除了静态资源之外有什么区别？<br>如果静态资源线上是放在cdn上，那显然是选择2。<br>这个实施建议我不知道你说的是什么，这整个专栏中的都需要在实施中考虑的。像数据，业务比例，场景设计，监控设计等等。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579141519,"ip_address":"","comment_id":172244,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10169073894","product_id":100042501,"comment_content":"老师，您好。我是一名性能测试小白，想请教您一个问题。在做性能测试时，如何理解和定义业务？是实现这个业务逻辑的核心接口，还是完成这个业务操作所涉及到的所有接口？比如，我们目前打算上线一款APP，我想做一下接口的性能测试，评估服务器目前的承载能力，为后期服务器规划扩容提供数据支撑。由于目前没有实际的生产流量，因此我根据APP的特点，站在用户的角度分功能操作APP并用JMeter录制脚本，于是我设计了两个测试方案：<br>1.把每个功能看做一个业务，直接用录制的脚本做基准场景和容量场景的性能测试。<br>2.把每个功能看做一个业务，从录制的脚本中挑出完成这个功能的核心接口做基准场景和容量场景的性能测试。<br>对于我设计的方案，老师能说说您的看法吗？另外，能针对我的这个需求场景，给我一些实施的建议吗？","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481677,"discussion_content":"你这1和2除了静态资源之外有什么区别？\n如果静态资源线上是放在cdn上，那显然是选择2。\n这个实施建议我不知道你说的是什么，这整个专栏中的都需要在实施中考虑的。像数据，业务比例，场景设计，监控设计等等。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579141519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1334695,"avatar":"https://static001.geekbang.org/account/avatar/00/14/5d/a7/e4904afe.jpg","nickname":"echo","note":"","ucode":"350CDA2C0ED2C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":195763,"discussion_content":"老师，想就这这个问题请教一下，是把某个接口当成一个事务还是一个功能，事务是怎么拆分呢？而且拆分不同的话肯定涉及的tps不一样。比如登录业务只有一个接口即可完成，但是支付的话可能涉及提交订单，选择支付，确认这几个接口。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583305769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1942765,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/a4/ed/36fb05d1.jpg","nickname":"路","note":"","ucode":"1C8E84C36040C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1334695,"avatar":"https://static001.geekbang.org/account/avatar/00/14/5d/a7/e4904afe.jpg","nickname":"echo","note":"","ucode":"350CDA2C0ED2C0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281910,"discussion_content":"我也有同样的疑惑，望解答一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591840326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":195763,"ip_address":""},"score":281910,"extra":""}]}]},{"had_liked":false,"id":345274,"user_name":"汐度清风","can_delete":false,"product_type":"c1","uid":2033324,"ip_address":"","ucode":"CF8BE29576A371","user_header":"https://static001.geekbang.org/account/avatar/00/1f/06/ac/55fba20b.jpg","comment_is_top":false,"comment_ctime":1652168167,"is_pvip":false,"replies":[{"id":"126621","content":"不是使用哪种。而是哪种都要覆盖。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1653834614,"ip_address":"","comment_id":345274,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5947135463","product_id":100042501,"comment_content":"还是有点不明白，虽然罗列了三种业务模型，但什么情况下使用哪种并没有很好的说明。这块希望老师解答下。","like_count":2,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574116,"discussion_content":"不是使用哪种。而是哪种都要覆盖。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653834614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333801,"user_name":"Geek_a55bf0","can_delete":false,"product_type":"c1","uid":1463944,"ip_address":"","ucode":"96FCD7B9120CA6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Nv7iaxevWVukvxaZf6TjbcNicgatCUpUcp7hTah0JQxvr7ZjMlLbopEaveichKRLQJjKXR6geB5LBntf7XCP8F4kQ/132","comment_is_top":false,"comment_ctime":1644542669,"is_pvip":false,"replies":[{"id":"122544","content":"你这样做的话，有可能硬件资源要的比实际情况多出很多去。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1645578948,"ip_address":"","comment_id":333801,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5939509965","product_id":100042501,"comment_content":"高老师好。服务性能主要是能承载的并发量的多少。而且业务间的比例是随时在变化的。那是不是取各业务的峰值来作为业务比例，然后加压到各个业务都达到峰值。如果此时能满足响应时间等指标，是不是业务比例不管如何变，只要不超过业务峰值都不会有问题","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552710,"discussion_content":"你这样做的话，有可能硬件资源要的比实际情况多出很多去。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645578949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308511,"user_name":"jy","can_delete":false,"product_type":"c1","uid":1785172,"ip_address":"","ucode":"F4E179C435451B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJ6G2xZvNRmhyXBjmGbI5G8icGCCMPupr6yxZ1IcURwp7GTRHcpWGWpg9A0fLlyicmVdDwzqZqwiaOQ/132","comment_is_top":false,"comment_ctime":1629671718,"is_pvip":false,"replies":[{"id":"112002","content":"这两问题其实是同一个问题。<br>首先要判断的就是业务量的趋势图，如果是有明确峰值的，那就去看峰值，细化到秒。如果是没有明确峰值的，一直都比较平均的，可以直接拿小时业务量除以3600。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1630077210,"ip_address":"","comment_id":308511,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5924639014","product_id":100042501,"comment_content":"=================引用文中内容开始=================<br>如果你的业务有必要从分钟或秒来看的话，可以按分钟或秒来取场景比例。在我们今天的这个案例中，取到小时就已经足够。因为我要的是业务模型，而不是生产 TPS 量级。<br>=================引用文中内容结束=================<br><br>疑问：<br>1、如何确定业务是从小时、分钟还是秒来获取比例呢？<br>2、小时比例，tps为什么是小时业务量除以3600？（这样平均后tps应该峰值tps小吧？）而不是像性能工程中细分到秒，直接获取秒的最大业务量（也就是tps）<br>谢谢","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525513,"discussion_content":"这两问题其实是同一个问题。\n首先要判断的就是业务量的趋势图，如果是有明确峰值的，那就去看峰值，细化到秒。如果是没有明确峰值的，一直都比较平均的，可以直接拿小时业务量除以3600。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630077210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305914,"user_name":"johnny","can_delete":false,"product_type":"c1","uid":1210226,"ip_address":"","ucode":"54E78B7BBC6AF0","user_header":"https://static001.geekbang.org/account/avatar/00/12/77/72/8f77ddb0.jpg","comment_is_top":false,"comment_ctime":1628228583,"is_pvip":false,"replies":[{"id":"110758","content":"1. 这是典型的业务操作级别的事务。<br>2. 是。<br>3. 业务操作级别的。<br>4. 流程是由业务级别的事务组成的，所以流程显然是用户级别的事务。<br>5. 统计接口的比例，再对应相应的业务操作就可以了。<br>6. 接口就是业务级别的事务。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1628321916,"ip_address":"","comment_id":305914,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5923195879","product_id":100042501,"comment_content":"引用内容 开始=================================================================<br>2、3可以这么说：<br>比如，有这些接口：登录、查询商品、添加购物车、创建订单、支付<br>我们通过日志分析，都是这些接口的比例吧？假设比例分别是：20:40:20:10:10<br>实际业务场景可能是这样的：<br>1、登录--查询商品--添加购物车--创建订单--支付<br>2、登录--查询商品--添加购物车<br>3、查询商品<br><br>那以上3个流程，如何算分别是多少比例呢？<br>作者回复: 3个流程的比例是：<br>1. 25%<br>2. 25%<br>3. 50%<br>引用内容 结束==================================================================<br><br>老师，关于引用内容中有以下6个问题，麻烦老师再次解答下。<br>1.登录、查询商品、添加购物车、创建订单、支付。这5个业务我可不可以理解为业务操作级别的事务T？（第二个专栏中定义了事务T有请求级别、业务操作级别、用户级别）<br>2.登录、查询商品、添加购物车、创建订单、支付的比例20:40:20:10:10。这个比例是不是就是业务模型中的业务比例？<br>3.两个专栏都提到了业务模型。业务模型中的业务指的是哪个级别的事务？<br>4.3个流程的比例25%、25%、50%。这个比例我可不可以理解为用户级别事务T的比例？<br>5.就拿登录来说，它下面应该包含多个get或post请求，有静态资源请求，有接口请求，其它4个业务查询商品、添加购物车、创建订单、支付下面也包含多个get、post请求，而且某些get或post请求在5个业务中都会被调用。这么多的请求在日志中混在一起，怎么才能得出业务比例20:40:20:10:10？我看老师提到用ELK，不过可以简单的说下背后的原理吗。（备注：我接触过的应用是单体应用nginx-tomcat-mysql，不是微服务。不过我想专栏中业务模型比例计算的逻辑是通用的，应该和架构没关系。）<br>6.专栏中的接口该怎么理解，接口对应哪个级别的事务？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524560,"discussion_content":"1. 这是典型的业务操作级别的事务。\n2. 是。\n3. 业务操作级别的。\n4. 流程是由业务级别的事务组成的，所以流程显然是用户级别的事务。\n5. 统计接口的比例，再对应相应的业务操作就可以了。\n6. 接口就是业务级别的事务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628321916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1785172,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJ6G2xZvNRmhyXBjmGbI5G8icGCCMPupr6yxZ1IcURwp7GTRHcpWGWpg9A0fLlyicmVdDwzqZqwiaOQ/132","nickname":"jy","note":"","ucode":"F4E179C435451B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388031,"discussion_content":"25,25,50，怎么算的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628563585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305463,"user_name":"jy","can_delete":false,"product_type":"c1","uid":1785172,"ip_address":"","ucode":"F4E179C435451B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJ6G2xZvNRmhyXBjmGbI5G8icGCCMPupr6yxZ1IcURwp7GTRHcpWGWpg9A0fLlyicmVdDwzqZqwiaOQ/132","comment_is_top":false,"comment_ctime":1627982890,"is_pvip":false,"replies":[{"id":"110539","content":"1. 对。业务比例就是tps的比例，这里有一个前提就是tps中的t是和业务对应的。jmeter中用Constant Throughput Timer和Throughput Controller 都可以控制请求发出的比例，只是用Constant Throughput Timer还要考虑响应时间在执行过程中的变化。<br>2. 这个问题我没看明白。根据我的理解是，你是问串行的接口组成的流程时，各接口的比例怎么算。如果是这个问题的话，先假设这个接口是串行调用A -  B - C，并且都是调用一次的话，那我觉得你不用算ABC，直接从接口去压就行了。因为ABC不算是单独的业务。 <br>3. 这个问题似乎和第二个问题是一样的。你是要单独压每一个接口，还是要压业务？","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1628052916,"ip_address":"","comment_id":305463,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5922950186","product_id":100042501,"comment_content":"老师，你好，看了你两个专栏，关于场景设计这里，一直有几个疑问，烦请空了答复下：<br><br>1、<br>文中：“有了这个计算过程，当我们把这些比例设计到场景中去的时候，一定要注意这些 TPS 的比例在运行过程中，不能发生大的变化。一旦压力发起后，由于各业务的响应时间随着压力的增加发生的变化量不同，就会导致运行过程中业务比例出现很大的偏差。我们做性能测试工程师的，都有过这样的经历。通常，在 LoadRunner 里，会用pacing来控制 TPS，而用 JMeter 的，则会用Constant Throughput Timer来控制 TPS。”<br><br>说明业务比例是tps的比例吧？毕竟tps承载业务。<br>如果是，那为什么性能工程里面，第5课：“那应该如何控制这个比例关系呢？如果你是用 JMeter 的话，可以使用 Throughput Controller 来控制业务比例”，这里只说了请求的比例，并没有提到要确认tps的比例？甚至没有提到需要用Constant Throughput Timer来控制 TPS呢？<br>如果不确认tps是否成比例，那如何保证业务是符合比例的呢？只用吞吐量控制器能控制请求比例和tps比例？<br><br>2、<br>关于业务比例，我们统计的是nginx的日志吧？哪怕是elk，也是接的nginx的日志吧？而且都是接口请求的日志。如果我是要把一个个小流程（包含多个接口）作为一个业务，如果有流程ABC，那如何算出流程ABC的业务比例？<br><br>3、<br>假设每个接口就是一个业务，但是接口之间有依赖，比如接口C依赖接口B，接口B依赖接口A，而接口的业务比例统计出来是A:B:C=3：2：1，这种怎么设计场景？如果有依赖的接口都放一个吞吐量控制器下面，但是他们的比例又不一样，如果放不同的吞吐量控制器下面，这个依赖又如何解决？<br><br>谢谢老师","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524394,"discussion_content":"1. 对。业务比例就是tps的比例，这里有一个前提就是tps中的t是和业务对应的。jmeter中用Constant Throughput Timer和Throughput Controller 都可以控制请求发出的比例，只是用Constant Throughput Timer还要考虑响应时间在执行过程中的变化。\n2. 这个问题我没看明白。根据我的理解是，你是问串行的接口组成的流程时，各接口的比例怎么算。如果是这个问题的话，先假设这个接口是串行调用A -  B - C，并且都是调用一次的话，那我觉得你不用算ABC，直接从接口去压就行了。因为ABC不算是单独的业务。 \n3. 这个问题似乎和第二个问题是一样的。你是要单独压每一个接口，还是要压业务？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628052916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291972,"user_name":"安静。。。","can_delete":false,"product_type":"c1","uid":2069304,"ip_address":"","ucode":"4366269948B006","user_header":"https://static001.geekbang.org/account/avatar/00/1f/93/38/efb7eb38.jpg","comment_is_top":false,"comment_ctime":1620630390,"is_pvip":false,"replies":[{"id":"105721","content":"两个关键点。<br>1. 业务峰值的比例。<br>2. 资源使用率峰值时的比例。<br><br>如果业务峰值的比例可以覆盖资源使用率峰值，那设计一个就可以了。 ","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1620651673,"ip_address":"","comment_id":291972,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5915597686","product_id":100042501,"comment_content":"高老师，能向您请教一下，设置比例的时候 是不是只要考虑峰值的比例就可以了，对于不是峰值的比例也不会到达服务器的瓶颈，是不是就可以不考虑了呢？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519615,"discussion_content":"两个关键点。\n1. 业务峰值的比例。\n2. 资源使用率峰值时的比例。\n\n如果业务峰值的比例可以覆盖资源使用率峰值，那设计一个就可以了。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620651673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2069304,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/93/38/efb7eb38.jpg","nickname":"安静。。。","note":"","ucode":"4366269948B006","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373643,"discussion_content":"谢谢高老师的回复。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620810807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269820,"user_name":"勼乄児亓","can_delete":false,"product_type":"c1","uid":2379844,"ip_address":"","ucode":"D33120C9B88D26","user_header":"https://static001.geekbang.org/account/avatar/00/24/50/44/aab77728.jpg","comment_is_top":false,"comment_ctime":1608796868,"is_pvip":false,"replies":[{"id":"97868","content":"1，这两个控制器是完全不同的逻辑。Constant throughout Timer 只是一个定时器，它固定了指定线程在单位时间内发出去的请求数。<br>这个比例控制，我建议用throughout controller，它才在线程连续递增的过程中控制请求的比例。<br>2，看场景目标是什么，如果只是为了测试接口，那就只统计接口就可以了。如果要测试的包括静态资源，那就得都统计出来。<br>3，这个要先做基准测试，才能判断多少铺底数据是合理的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1608884664,"ip_address":"","comment_id":269820,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5903764164","product_id":100042501,"comment_content":"老师，有几个疑问，希望能解答:<br>1，业务比例我是用 控制器中的“吞吐量控制器”来控制的，这样做跟Constant Throughput Timer有什么区别吗？<br>2，业务模型统计的数据，是统计接口的请求次数，还是什么？<br>3，当压测环境与生产环境不是1:1时，运维大概估算一个环境比例，压测过程中，业务指标，铺底数据量也要做同比例缩放？还是铺底数据是根据存储服务网来做同比例缩放的？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512407,"discussion_content":"1，这两个控制器是完全不同的逻辑。Constant throughout Timer 只是一个定时器，它固定了指定线程在单位时间内发出去的请求数。\n这个比例控制，我建议用throughout controller，它才在线程连续递增的过程中控制请求的比例。\n2，看场景目标是什么，如果只是为了测试接口，那就只统计接口就可以了。如果要测试的包括静态资源，那就得都统计出来。\n3，这个要先做基准测试，才能判断多少铺底数据是合理的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608884664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231172,"user_name":"Geek_4d7100","can_delete":false,"product_type":"c1","uid":1746006,"ip_address":"","ucode":"651AA8DD3A449B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo89hTW7flS63tsicm5vlbQwV4t7QZibwHU8UqmdUswDzE608maicHAb6u5nEHP2m6IQl2JsJa82bnDA/132","comment_is_top":false,"comment_ctime":1593600443,"is_pvip":false,"replies":[{"id":"87981","content":"指标也要等比缩小才可以。但是还要看性能在递增过程中的损耗。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1596076994,"ip_address":"","comment_id":231172,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5888567739","product_id":100042501,"comment_content":"老师，关于生产环境和测试环境的差异如何处理呢，由于成本，很多时候生产环境和测试环境的配置不可能完全一样，鉴于这种情况，什么样的差异测试结果才有意义呢？有听说过可以做等比缩放的处理，根据硬件配置的差异，该如何界定其他指标的差异呢？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500188,"discussion_content":"指标也要等比缩小才可以。但是还要看性能在递增过程中的损耗。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596076994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":227101,"user_name":"丹","can_delete":false,"product_type":"c1","uid":1167671,"ip_address":"","ucode":"FC5BB2D441467B","user_header":"https://static001.geekbang.org/account/avatar/00/11/d1/37/e087a4ee.jpg","comment_is_top":false,"comment_ctime":1592287020,"is_pvip":false,"replies":[{"id":"84031","content":"看数据用在哪里了。如果存储不够可以降，如果在参数中的话其实是没有必要降的。但也有一个前提，就是硬件不够时，软件的配置是和正式环境一样的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1592532733,"ip_address":"","comment_id":227101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5887254316","product_id":100042501,"comment_content":"高老师，如果正式上的服务器有十几台，测试只有1台服务器，那么这个数据是不是也要做下降级处理，比如降10倍","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498496,"discussion_content":"看数据用在哪里了。如果存储不够可以降，如果在参数中的话其实是没有必要降的。但也有一个前提，就是硬件不够时，软件的配置是和正式环境一样的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592532733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222836,"user_name":"言希","can_delete":false,"product_type":"c1","uid":1785875,"ip_address":"","ucode":"87E80087CFECA8","user_header":"https://static001.geekbang.org/account/avatar/00/1b/40/13/3e77a4a0.jpg","comment_is_top":false,"comment_ctime":1590924512,"is_pvip":false,"replies":[{"id":"84044","content":"这里说的差不多是指总TPS。只是一个大概的说法。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1592533255,"ip_address":"","comment_id":222836,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5885891808","product_id":100042501,"comment_content":"今天又翻来看一看，发现一个问题，文末中写到：<br>但是请注意，像 9 点业务模型中的业务 11，占比达到 30.25%；而 16 点业务模型中只有 8.69%。虽然 TPS 差不多，但是业务比例差别大，这两种业务模型下，对系统资源的消耗会完全不一样。<br><br>9点业务模型tps为333，16点业务模型为277，9点业务模型根据比例计算为不到100个，16点根据计算为不到30个，这个TPS也算差不多吗，还是说我理解错了。","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496932,"discussion_content":"这里说的差不多是指总TPS。只是一个大概的说法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592533255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200719,"user_name":"凌空飞起的剪刀腿","can_delete":false,"product_type":"c1","uid":1243680,"ip_address":"","ucode":"16FBBF4A3B54C6","user_header":"https://static001.geekbang.org/account/avatar/00/12/fa/20/0f06b080.jpg","comment_is_top":false,"comment_ctime":1585643276,"is_pvip":false,"replies":[{"id":"75170","content":"我自己仔细看了一下，觉得逻辑应该是我能想到的最清楚的逻辑了。😃😃","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1585694482,"ip_address":"","comment_id":200719,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5880610572","product_id":100042501,"comment_content":"老师您好!说真的，这节课看不懂，感觉数据列的不太清晰，没有前面讲的清楚","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490117,"discussion_content":"我自己仔细看了一下，觉得逻辑应该是我能想到的最清楚的逻辑了。😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585694482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1243680,"avatar":"https://static001.geekbang.org/account/avatar/00/12/fa/20/0f06b080.jpg","nickname":"凌空飞起的剪刀腿","note":"","ucode":"16FBBF4A3B54C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":218749,"discussion_content":"还是我太弱了，理解不到那个层次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585696678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195172,"user_name":"小呀么小二郎","can_delete":false,"product_type":"c1","uid":1326905,"ip_address":"","ucode":"149540DCFDF43E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3f/39/b1558fc9.jpg","comment_is_top":false,"comment_ctime":1585143900,"is_pvip":false,"replies":[{"id":"74289","content":"也有瞎拍脑袋的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1585199596,"ip_address":"","comment_id":195172,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880111196","product_id":100042501,"comment_content":"今日思考题：<br>为什么业务比例对性能场景如此重要？<br>我们要保证性能测试场景符合真实生产环境，而业务模型是设计性能场景的前提。如果业务比例不准确或不正确，会导致性能测试的结果不准确，大大降低性能测试的价值。<br><br>如何在执行场景过程中控制 TPS 比例呢？<br>在 LoadRunner 里，用pacing控制 TPS；<br>在 JMeter 里，用Constant Throughput Timer控制 TPS。<br><br><br>今日感悟：<br>业务比例一般是业务部门给出的，如果业务部门未给出，那么我们可以分析生产数据，进而计算出业务比例。一般至少会有两个模型，一个是通用业务场景模型，一个是业务量最大时的场景模型。<br>回放的逻辑看上去很简单，但是感觉实际操作起来很复杂。<br><br><br>写着写着突然有个疑问，业务部门给出的业务比例也是这样计算的嘛？会存在业务部门给出的比例与真实比例不一致的情况吗？<br><br><br>感谢老师每天对我的鼓励！","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488995,"discussion_content":"也有瞎拍脑袋的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585199596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183356,"user_name":"hou","can_delete":false,"product_type":"c1","uid":1818999,"ip_address":"","ucode":"B86FDAE03B1C61","user_header":"https://static001.geekbang.org/account/avatar/00/1b/c1/77/bee24d2d.jpg","comment_is_top":false,"comment_ctime":1583028649,"is_pvip":false,"replies":[{"id":"70960","content":"资源不一致，和业务模型比例无关呀。不管在哪个环境中，业务比例都要保持，这是场景执行的基础。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1583032958,"ip_address":"","comment_id":183356,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5877995945","product_id":100042501,"comment_content":"测试环境与生产环境的资源很难保持一致，这样的情况下，业务模型如何进行比例控制，测试结果如何估算出生产的性能","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485660,"discussion_content":"资源不一致，和业务模型比例无关呀。不管在哪个环境中，业务比例都要保持，这是场景执行的基础。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583032958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796558,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIDhIpvB4hJnjCz9P1Qic42z9TJYISFQrdnu3bAahm86qibS60ca6AjaSbqhF9SzH3Tcdkn9qFK1EibA/132","nickname":"Nicole","note":"","ucode":"54C5D4C82F8B84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340607,"discussion_content":"测试和生产环境资源不一样，保持业务比例，那测试反应出来的性能效果可能是不一样的，如果根据测试环境的结果来估算生产的效果，有什么思路吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610077058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173536,"user_name":"Hanson","can_delete":false,"product_type":"c1","uid":1086785,"ip_address":"","ucode":"BBCC3C60241DDB","user_header":"","comment_is_top":false,"comment_ctime":1579591215,"is_pvip":false,"replies":[{"id":"67295","content":"生产日志统计来的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579611584,"ip_address":"","comment_id":173536,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5874558511","product_id":100042501,"comment_content":"高老师，请问业务数据是怎么统计出来的？","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482106,"discussion_content":"生产日志统计来的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579611584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173114,"user_name":"吴小喵","can_delete":false,"product_type":"c1","uid":1392780,"ip_address":"","ucode":"A8CB5407A89593","user_header":"https://static001.geekbang.org/account/avatar/00/15/40/8c/bc76ecd3.jpg","comment_is_top":false,"comment_ctime":1579425870,"is_pvip":false,"replies":[{"id":"67169","content":"这个直接统计就好了吧。ELK中有图可以生成，有时间段，有业务量的。<br>","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579484936,"ip_address":"","comment_id":173114,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5874393166","product_id":100042501,"comment_content":"Elk分析业务比例具体细节想了解一下","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481961,"discussion_content":"这个直接统计就好了吧。ELK中有图可以生成，有时间段，有业务量的。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579484936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172217,"user_name":"村夫","can_delete":false,"product_type":"c1","uid":1434041,"ip_address":"","ucode":"B70D4E421A281B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erdesQy0moaicYTicoHRQXzbmJm15wohb77qD1OdbuSqPCSUerbcZHzxJJunfmEhTx4kBLxbGaxQ9iag/132","comment_is_top":false,"comment_ctime":1579135073,"is_pvip":false,"replies":[{"id":"66817","content":"递增是所有场景的默认条件。我觉得前面已经强调的够重了。😃😃","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579141611,"ip_address":"","comment_id":172217,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5874102369","product_id":100042501,"comment_content":"问题一:首先只有混合容量性能测试场景下得出的tps才是最接近服务器能承载的最大或者说最佳容量，而混合容量场景却需要由事先确认好的业务比例来保证这个场景是有效的，最接近线上业务的。<br>问题二:我有个疑问，当我们使用Constant Throughput Timer时，肯定是需要事先设置好并发数的，我曾经试过在相同的请求数下，不同的线程数在刚开始跑的时候tps波动不一致，也就是说线程数越大，tps也越大，只不过随着时间推移慢慢接近设置的tps。而设置小的线程数整体的tps确实很平坦的。<br>还有就是老师这一次也没见您说递增式的场景？按我理解，无论是单交易还是混合容量，在压测时不应该都用递增式来逐渐达到最大tps吗？<br>请老师点评以及回答","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481667,"discussion_content":"递增是所有场景的默认条件。我觉得前面已经强调的够重了。😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579141611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172182,"user_name":"、H","can_delete":false,"product_type":"c1","uid":1164928,"ip_address":"","ucode":"841D9D872CCBC6","user_header":"https://static001.geekbang.org/account/avatar/00/11/c6/80/fa8a8476.jpg","comment_is_top":false,"comment_ctime":1579102402,"is_pvip":false,"replies":[{"id":"66820","content":"你这个也就是扫扫上了压力就出现的明显bug，其他没什么用。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579141793,"ip_address":"","comment_id":172182,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5874069698","product_id":100042501,"comment_content":"每上线一个新系统就要求压压看，然后这时候是没有什么业务峰值的，就根据当前配置代码做个压测得出最大TPS，那么这里说到没根据生产业务模型是没意义的？还有必要做吗","like_count":1,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481655,"discussion_content":"你这个也就是扫扫上了压力就出现的明显bug，其他没什么用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579141793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1164928,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/80/fa8a8476.jpg","nickname":"、H","note":"","ucode":"841D9D872CCBC6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":137160,"discussion_content":"但是可以知道某个接口某个业务当前可承受的TPS，这个可承受的数不能作为性能参考吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579180899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358169,"user_name":"刘志鹏","can_delete":false,"product_type":"c1","uid":2546103,"ip_address":"北京","ucode":"FBA7FA3A392D22","user_header":"","comment_is_top":false,"comment_ctime":1663995355,"is_pvip":false,"replies":[{"id":"130389","content":"指具体的业务流程，是用户级别，比接口粗。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1664191835,"ip_address":"北京","comment_id":358169,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663995355","product_id":100042501,"comment_content":"最难的一点，没说清楚。 这个业务的粒度是指？ 接口的粒度，还是比接口更粗的粒度（还是用户层面的粒度）","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588880,"discussion_content":"指具体的业务流程，是用户级别，比接口粗。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664191836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356690,"user_name":"樱峻小猴子","can_delete":false,"product_type":"c1","uid":2740008,"ip_address":"北京","ucode":"A464115D52BD3F","user_header":"https://static001.geekbang.org/account/avatar/00/29/cf/28/eb90fa13.jpg","comment_is_top":false,"comment_ctime":1662515056,"is_pvip":false,"replies":[{"id":"130284","content":"第二个和第三个专栏都是实践课程。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1663808295,"ip_address":"北京","comment_id":356690,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662515056","product_id":100042501,"comment_content":"老师 您有没有实践的课程可以分享","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588510,"discussion_content":"第二个和第三个专栏都是实践课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663808295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349373,"user_name":"小宝","can_delete":false,"product_type":"c1","uid":1944626,"ip_address":"北京","ucode":"FD504FA4E93CE6","user_header":"https://static001.geekbang.org/account/avatar/00/1d/ac/32/8c1799df.jpg","comment_is_top":false,"comment_ctime":1655914754,"is_pvip":true,"replies":[{"id":"129333","content":"你这个描述的好像是页面型的请求吧。那把一次点击所产生的请求做为业务级别的事务内容。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1661336267,"ip_address":"北京","comment_id":349373,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1655914754","product_id":100042501,"comment_content":"老师，通常前端调用的每个接口都是一个业务级别的事务么，还是前端某个操作调用的所有接口是一个业务级别的事务呢。前端调用一个接口(f12查看)是不是在服务器日志里可能表现为还调用了其他接口(f12看不到的)","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585133,"discussion_content":"你这个描述的好像是页面型的请求吧。那把一次点击所产生的请求做为业务级别的事务内容。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661336268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339400,"user_name":"素还真","can_delete":false,"product_type":"c1","uid":1269156,"ip_address":"","ucode":"9ABA456355F7E3","user_header":"https://static001.geekbang.org/account/avatar/00/13/5d/a4/2e4b6d33.jpg","comment_is_top":false,"comment_ctime":1648080139,"is_pvip":false,"replies":[{"id":"124350","content":"有多种方式。比如：分析日志、业务打点统计等等。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1648600854,"ip_address":"","comment_id":339400,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648080139","product_id":100042501,"comment_content":"业务的比例怎么弄出来的？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559058,"discussion_content":"有多种方式。比如：分析日志、业务打点统计等等。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648600854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318512,"user_name":"7.7","can_delete":false,"product_type":"c1","uid":2822891,"ip_address":"","ucode":"4912A3C424C70A","user_header":"https://static001.geekbang.org/account/avatar/00/2b/12/eb/8f3b0d13.jpg","comment_is_top":false,"comment_ctime":1635319370,"is_pvip":false,"replies":[{"id":"115768","content":"是的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1635742190,"ip_address":"","comment_id":318512,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635319370","product_id":100042501,"comment_content":"老师 您好,看到本章节说控制业务比例是控制TPS的比例,在我性能测试实践项目中,容量场景测试要控制交易的比例,比如A交易占比为20%,B交易占比为80%.当总并发数为60时,我一般是使用Throughput Controller 去分配比例,这种也是控制TPS比例的一种方式吗?","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529280,"discussion_content":"是的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635742190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311389,"user_name":"Geek_6bb","can_delete":false,"product_type":"c1","uid":2748610,"ip_address":"","ucode":"82CADDD4721CAD","user_header":"https://static001.geekbang.org/account/avatar/00/29/f0/c2/231d2f12.jpg","comment_is_top":false,"comment_ctime":1631197256,"is_pvip":false,"replies":[{"id":"112883","content":"如果是从最前端调用的业务级接口，那就是一个业务流程。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1631317107,"ip_address":"","comment_id":311389,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1631197256","product_id":100042501,"comment_content":"根据线上数据再根据通用业务模型。一共设计出了业务1  - 业务17这么多业务    我想问一下这个业务1 指的是一个业务流程，还是指每一个接口的调用次数","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526583,"discussion_content":"如果是从最前端调用的业务级接口，那就是一个业务流程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631317107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2748610,"avatar":"https://static001.geekbang.org/account/avatar/00/29/f0/c2/231d2f12.jpg","nickname":"Geek_6bb","note":"","ucode":"82CADDD4721CAD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393227,"discussion_content":"像这种统计线上数据生成的业务模型，我们是通常要考虑从前端调用算起，还是不从前端算起","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631318997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311387,"user_name":"Geek_6bb","can_delete":false,"product_type":"c1","uid":2748610,"ip_address":"","ucode":"82CADDD4721CAD","user_header":"https://static001.geekbang.org/account/avatar/00/29/f0/c2/231d2f12.jpg","comment_is_top":false,"comment_ctime":1631196993,"is_pvip":false,"replies":[{"id":"112884","content":"你要算整天的业务比例吗？","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1631317170,"ip_address":"","comment_id":311387,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1631196993","product_id":100042501,"comment_content":"通用业务场景模型。就是将这一天的所有业务数加在一起，再将各业务整天的交易量加在一起，计算各业务量的比例。   这个业务数，和  交易量  是什么意思","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526581,"discussion_content":"你要算整天的业务比例吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631317170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2710110,"avatar":"https://static001.geekbang.org/account/avatar/00/29/5a/5e/de904c17.jpg","nickname":"陈陈陈小芮","note":"","ucode":"ADEEC765F58819","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405267,"discussion_content":"+1，我也没太理解，我按自己的理解，用  一天中每个业务的业务量总和 除以 一天中所有业务的业务量总和 算出来跟后面列表里统计的不一样，也不知道是我计算方式错了，还是因为图片中业务量不全导致的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634544213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2748610,"avatar":"https://static001.geekbang.org/account/avatar/00/29/f0/c2/231d2f12.jpg","nickname":"Geek_6bb","note":"","ucode":"82CADDD4721CAD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393226,"discussion_content":"是的，但是我不明白这个业务数和交易量是什么意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631318654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293827,"user_name":"johnny","can_delete":false,"product_type":"c1","uid":1210226,"ip_address":"","ucode":"54E78B7BBC6AF0","user_header":"https://static001.geekbang.org/account/avatar/00/12/77/72/8f77ddb0.jpg","comment_is_top":false,"comment_ctime":1621566927,"is_pvip":false,"replies":[{"id":"106590","content":"要先看曲线图才能判断。<br>tps就是拿t除以s呀。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1621648456,"ip_address":"","comment_id":293827,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1621566927","product_id":100042501,"comment_content":"“如果你的业务有必要从分钟或秒来看的话，可以按分钟或秒来取场景比例。在我们今天的这个案例中，取到小时就已经足够。因为我要的是业务模型，而不是生产 TPS 量级。”<br>老师，对于这句话有两个问题。<br>1.以小时统计的业务量数据不能计算出生产TPS的量级吗<br>2.TPS量级的计算公式是怎样的","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520382,"discussion_content":"要先看曲线图才能判断。\ntps就是拿t除以s呀。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621648456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293130,"user_name":"张林霞","can_delete":false,"product_type":"c1","uid":1983609,"ip_address":"","ucode":"A2934C9286432B","user_header":"","comment_is_top":false,"comment_ctime":1621236221,"is_pvip":false,"replies":[{"id":"106111","content":"生产上的业务分析得来。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1621246442,"ip_address":"","comment_id":293130,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1621236221","product_id":100042501,"comment_content":"高老师请问这些业务统计分析从哪里来的？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520087,"discussion_content":"生产上的业务分析得来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621246442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285333,"user_name":"0909","can_delete":false,"product_type":"c1","uid":1969097,"ip_address":"","ucode":"79C60A8D2B809A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/0b/c9/b53037df.jpg","comment_is_top":false,"comment_ctime":1616744088,"is_pvip":false,"replies":[{"id":"103580","content":"是需要一些知识积累。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1616803835,"ip_address":"","comment_id":285333,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616744088","product_id":100042501,"comment_content":"性能测试做的太少，看着一知半解，只能多实践，有问题再回来复习","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517647,"discussion_content":"是需要一些知识积累。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616803835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280662,"user_name":"bolo","can_delete":false,"product_type":"c1","uid":1357170,"ip_address":"","ucode":"7C91CEA2F1970E","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/72/bb10f3d0.jpg","comment_is_top":false,"comment_ctime":1614307634,"is_pvip":false,"replies":[{"id":"103253","content":"可以出师了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1616422885,"ip_address":"","comment_id":280662,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1614307634","product_id":100042501,"comment_content":"1、为什么业务比例对性能场景如此重要？<br><br>因为我们要分析线上业务模型，来使得测试环境执行的业务模型更加的贴近生产。<br><br><br><br><br>2、如何在执行场景过程中控制 TPS 比例呢？<br>如果是指定某个TPS，使用过的是Jmeter的Constant Throughput Timer 组件来控制TPS，<br>不过有个需要注意的点是设置的线程产生的TPS要大于设置的TPS值才能起到固定TPS的效果。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516171,"discussion_content":"可以出师了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616422885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080894,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7e/3e/82202cc8.jpg","nickname":"月亮和六便士","note":"","ucode":"EFFCB9171D4B4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552609,"discussion_content":"高老师，他说的这个：“不过有个需要注意的点是设置的线程产生的TPS要大于设置的TPS值才能起到固定TPS的效果” 是什么意思，没看懂。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645524477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279579,"user_name":"null","can_delete":false,"product_type":"c1","uid":1284576,"ip_address":"","ucode":"D1887E49E69309","user_header":"https://static001.geekbang.org/account/avatar/00/13/99/e0/ee61a224.jpg","comment_is_top":false,"comment_ctime":1613830723,"is_pvip":false,"replies":[{"id":"103263","content":"当然是用不同帐户了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1616423157,"ip_address":"","comment_id":279579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613830723","product_id":100042501,"comment_content":"老师您好，有一下场景：超市收银员可以用一个账号给多个客人下收款单；客人也可以自助机上下收款单。下单接口是同一个。但是有token校验。请问是否可以用一个账号登录后，模拟多并发用户的单交易容量测试（即单接口的基线测试）如果用一个登录账号，共享登录后的token，做的基准场景测试结果和用大量不同账户登录，各用各的token，得到的结果，哪个更可信？<br>","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515779,"discussion_content":"当然是用不同帐户了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616423157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273855,"user_name":"kaixin","can_delete":false,"product_type":"c1","uid":2368627,"ip_address":"","ucode":"D80CE5F6963882","user_header":"https://static001.geekbang.org/account/avatar/00/24/24/73/91ef894b.jpg","comment_is_top":false,"comment_ctime":1610697137,"is_pvip":false,"replies":[{"id":"99170","content":"等哥写。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1610704088,"ip_address":"","comment_id":273855,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610697137","product_id":100042501,"comment_content":"同求elk 分析业务比例的细节操作","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513834,"discussion_content":"等哥写。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610704088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238241,"user_name":"莫西 👫 小妞儿 👼 🎵","can_delete":false,"product_type":"c1","uid":1165199,"ip_address":"","ucode":"553BF89ED22111","user_header":"https://static001.geekbang.org/account/avatar/00/11/c7/8f/fcfaf45a.jpg","comment_is_top":false,"comment_ctime":1596100474,"is_pvip":false,"replies":[{"id":"88147","content":"可以设置大一点的时间也能控制。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1596260730,"ip_address":"","comment_id":238241,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1596100474","product_id":100042501,"comment_content":"老师，不太明白什么时候需要用Constant Throughput Timer。如果接口性能比较好，响应时间在1s以下，是不是用Constant Throughput Timer会有效果，比如将Target throughput（in samples per minutes）设置为60，就能控制1s发送一个请求。但如果对于接口性能比较差的接口，例如响应时间在1s以上，设置Constant Throughput Timer是不是也没啥效果？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502681,"discussion_content":"可以设置大一点的时间也能控制。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596260730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226318,"user_name":"Geek_081377","can_delete":false,"product_type":"c1","uid":1712509,"ip_address":"","ucode":"62FC733855B002","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Cyuxk6Ej9B5G9icGd2h9OicjdbuWMsQsB0cOZoRXLN6zX5bfmCXB4yHiaicOcE5OUicGDIaodS9T4Ws6lGBibFWoSlKQ/132","comment_is_top":false,"comment_ctime":1592034040,"is_pvip":false,"replies":[{"id":"84036","content":"这个取决于业务需求。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1592532819,"ip_address":"","comment_id":226318,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592034040","product_id":100042501,"comment_content":"高楼老师，还有有一点迷惑，如果使用Constant Throughput Timer控制了tps，那么jmeter线程数设置多少才达到目标TPS呢","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498191,"discussion_content":"这个取决于业务需求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592532819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222289,"user_name":"蔡春晔","can_delete":false,"product_type":"c1","uid":1129276,"ip_address":"","ucode":"639A86591DEBE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/3b/3c/07ffe423.jpg","comment_is_top":false,"comment_ctime":1590738737,"is_pvip":false,"replies":[{"id":"82018","content":"有工具平台支撑的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590754706,"ip_address":"","comment_id":222289,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590738737","product_id":100042501,"comment_content":"高老师，这个用户行为建模，有工具平台来支撑嘛？还是纯手工的进行用户行为建模？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496739,"discussion_content":"有工具平台支撑的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590754706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207329,"user_name":"白菜","can_delete":false,"product_type":"c1","uid":1216648,"ip_address":"","ucode":"5C2CAF64A69ED9","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/88/1907a8b3.jpg","comment_is_top":false,"comment_ctime":1587048913,"is_pvip":false,"replies":[{"id":"82015","content":"你这个流程包括了好多微服务架构中的服务。<br>用户登录必然是一个业务。 ","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590754590,"ip_address":"","comment_id":207329,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587048913","product_id":100042501,"comment_content":"比如下订单是一个业务，加入流程是：用户登录-&gt; 将商品加入购物车-&gt; 下单。 “用户登录“也算作这个业务吗？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492087,"discussion_content":"你这个流程包括了好多微服务架构中的服务。\n用户登录必然是一个业务。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590754590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207003,"user_name":"旭东(Frank)","can_delete":false,"product_type":"c1","uid":1024486,"ip_address":"","ucode":"176FA629800062","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg","comment_is_top":false,"comment_ctime":1586992421,"is_pvip":false,"replies":[{"id":"82017","content":"性能测试的重要前提就是模拟真实。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1590754682,"ip_address":"","comment_id":207003,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586992421","product_id":100042501,"comment_content":"看起来，业务性能测试还需要把各个系统一起测试？这样真实性高。现实中看都是峰值测试，且独立业务测试。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491977,"discussion_content":"性能测试的重要前提就是模拟真实。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590754682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185144,"user_name":"千层酥","can_delete":false,"product_type":"c1","uid":1787426,"ip_address":"","ucode":"E5A59577DC2E29","user_header":"https://static001.geekbang.org/account/avatar/00/1b/46/22/eef377f6.jpg","comment_is_top":false,"comment_ctime":1583495068,"is_pvip":false,"replies":[{"id":"71525","content":"1. 不管用什么，只要控制得了比例就行，jmeter很灵活的。就看你怎么用了。<br>2. 我理解这个就是为了控制TPS。 <br>3. 是的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1583504947,"ip_address":"","comment_id":185144,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583495068","product_id":100042501,"comment_content":"老师您好，我有几个疑问，麻烦老师解答一下。1.这里所说的控制业务比例是控制TPS的比例，那么具体实现的话是只要用JMeter里的Constant Throughput Timer来控制TPS吗，还需要用到吞吐量控制器吗？2、网上还有实现混合业务比例用的是JMeter中的吞吐量控制器或（可以控制线程发送请求的比例），和控制TPS有什么区别呢？3、文章中举例TPS1=20000000​&#47;（24∗3600）=231，这个是总的tps吧？那业务1的tps=231*1.47%，是这样来计算每个业务的占比例然后换算到Constant Throughput Timer里面吗？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486267,"discussion_content":"1. 不管用什么，只要控制得了比例就行，jmeter很灵活的。就看你怎么用了。\n2. 我理解这个就是为了控制TPS。 \n3. 是的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583504947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184118,"user_name":"zwm","can_delete":false,"product_type":"c1","uid":1787187,"ip_address":"","ucode":"BDF98B3A1CD406","user_header":"https://static001.geekbang.org/account/avatar/00/1b/45/33/cdea4bca.jpg","comment_is_top":false,"comment_ctime":1583227265,"is_pvip":false,"replies":[{"id":"71275","content":"2. 我说到的是不用28比例这个原则。不是为了达到28比例应该如何做。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1583241971,"ip_address":"","comment_id":184118,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583227265","product_id":100042501,"comment_content":"那么最后给你留两个问题，为什么业务比例对性能场景如此重要？以及如何在执行场景过程中控制 TPS 比例呢？<br>（1）业务模型是模仿真实使用场景，是在真实使用的基础上进行的性能测试<br>（2）吞吐量控制器；  <br>【问题】还听说过一种是取余，比如28比例的话就用10&#47;5，余数为0请求一个接口，余数不为0请求另一个，达到业务比例（请求量）比例为2:8目的，但这个似乎控制的不是tps？貌似只是施压比例，楼哥帮忙看下谢谢","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485893,"discussion_content":"2. 我说到的是不用28比例这个原则。不是为了达到28比例应该如何做。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583241971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183596,"user_name":"麻辣秃头酱","can_delete":false,"product_type":"c1","uid":1119818,"ip_address":"","ucode":"9EDD8925AEB1EE","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/4a/77d24103.jpg","comment_is_top":false,"comment_ctime":1583073939,"is_pvip":false,"replies":[{"id":"71197","content":"可以联系我，我看一下，你的具体数据是什么。微信：Zee_7D","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1583160105,"ip_address":"","comment_id":183596,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1583073939","product_id":100042501,"comment_content":"老师您好，按您上面TPS2=1200000​&#47;3600=333 推算TPS的方式，如果我现在有一个直播系统，要做到20000个用户20分钟内全部都可以进来，这样计算通用TPS=20000&#47;20*60=16. <br>但是从大数据分析看，每秒最高用户数35.  这种情况我的通用TPS是用16还是35？<br>如果计算方式有问题的话，应该如何计算通用TPS？","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485726,"discussion_content":"可以联系我，我看一下，你的具体数据是什么。微信：Zee_7D","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583160105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1785875,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/40/13/3e77a4a0.jpg","nickname":"言希","note":"","ucode":"87E80087CFECA8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212787,"discussion_content":"16是通用场景，而35是一个峰值场景，我们再做性能测试中也不要忽略掉每一个具有特殊意义的场景，","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585015549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1787187,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/45/33/cdea4bca.jpg","nickname":"zwm","note":"","ucode":"BDF98B3A1CD406","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":193031,"discussion_content":"个人理解。    每秒最高实际就是上文说的9点对应的业务模型了。总的是16是时间段平均值。  35是另一个较少时间段峰值。  ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583117515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1242924,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f7/2c/5e549246.jpg","nickname":"C","note":"","ucode":"B9A0D51E0787B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194994,"discussion_content":"20000个用户在二十分钟进来，按照28原理，肯定是前面四分钟进来的并发量大，百分之八十的用户，在百分之二十的时间进来，个人观点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583247364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1712509,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Cyuxk6Ej9B5G9icGd2h9OicjdbuWMsQsB0cOZoRXLN6zX5bfmCXB4yHiaicOcE5OUicGDIaodS9T4Ws6lGBibFWoSlKQ/132","nickname":"Geek_081377","note":"","ucode":"62FC733855B002","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1242924,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f7/2c/5e549246.jpg","nickname":"C","note":"","ucode":"B9A0D51E0787B3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282638,"discussion_content":"都说了不要用28原理，什么都用28原理得话，那就不用监控拉，直接什么都用28原理得了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592034915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":194994,"ip_address":""},"score":282638,"extra":""}]}]},{"had_liked":false,"id":181958,"user_name":"志富","can_delete":false,"product_type":"c1","uid":1765077,"ip_address":"","ucode":"99DAF4CF1EFAB7","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ee/d5/1aa85ac8.jpg","comment_is_top":false,"comment_ctime":1582684575,"is_pvip":false,"replies":[{"id":"70493","content":"是的。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582713206,"ip_address":"","comment_id":181958,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582684575","product_id":100042501,"comment_content":"老师你好，我们测试前统计出的业务占比，在测试过程中这个比例指的是什么，是跑混合场景中单业务的请求数除于总业务请求数就是指这个比例吗","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485180,"discussion_content":"是的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582713206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180065,"user_name":"麦兜布熊","can_delete":false,"product_type":"c1","uid":1118352,"ip_address":"","ucode":"F46E3571FAE9FE","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/90/5cb92311.jpg","comment_is_top":false,"comment_ctime":1582178060,"is_pvip":false,"replies":[{"id":"69918","content":"当然可以自己搭建了。我觉得你需要搜索一下elk是个啥了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1582183066,"ip_address":"","comment_id":180065,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1582178060","product_id":100042501,"comment_content":"高老师在答学生问中提到“elk”，请问这个测试能自己搭建嘛，搭好了以后怎么让业务用呢","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484507,"discussion_content":"当然可以自己搭建了。我觉得你需要搜索一下elk是个啥了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582183066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1118352,"avatar":"https://static001.geekbang.org/account/avatar/00/11/10/90/5cb92311.jpg","nickname":"麦兜布熊","note":"","ucode":"F46E3571FAE9FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":183734,"discussion_content":"明白了，这个东东搭建过，好像里面的策略是用的ruby语言识别日志格式。曾经跟踪过一些新建系统，上线后的日志有15T，非常吃资源。测试没有那么多资源把日志同步过来。唉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582511827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176576,"user_name":"杜艳","can_delete":false,"product_type":"c1","uid":1168516,"ip_address":"","ucode":"8D46A8CF33E9C7","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/84/7f584cb2.jpg","comment_is_top":false,"comment_ctime":1581090083,"is_pvip":false,"replies":[{"id":"68596","content":"生产环境中统计来的。excel都行。你有工具可用那就更好了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1581165515,"ip_address":"","comment_id":176576,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1581090083","product_id":100042501,"comment_content":"这些图怎么来的 都不知道了","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483148,"discussion_content":"生产环境中统计来的。excel都行。你有工具可用那就更好了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581165515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172392,"user_name":"Geek_a98085","can_delete":false,"product_type":"c1","uid":1637292,"ip_address":"","ucode":"33BD817345C0C9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/z5OUcd5RD7jVxKTnqsokibptjib5sgO9fP4dg0I7kCI2ncvuxX99vM958ickdgthziaviajWGAIzI9tcZOwbNxxLBcw/132","comment_is_top":false,"comment_ctime":1579167298,"is_pvip":false,"replies":[{"id":"66871","content":"if控制器不能控制业务的请求比例呀。 我没有写if控制器哦。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579183603,"ip_address":"","comment_id":172392,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579167298","product_id":100042501,"comment_content":"老师讲的以tps来承载业务比例，和jmeter中按if控制器来配置不同业务的请求比例，很容易引起混淆。希望老师能澄清下这两个的区别。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481725,"discussion_content":"if控制器不能控制业务的请求比例呀。 我没有写if控制器哦。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579183603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172386,"user_name":"Geek_a98085","can_delete":false,"product_type":"c1","uid":1637292,"ip_address":"","ucode":"33BD817345C0C9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/z5OUcd5RD7jVxKTnqsokibptjib5sgO9fP4dg0I7kCI2ncvuxX99vM958ickdgthziaviajWGAIzI9tcZOwbNxxLBcw/132","comment_is_top":false,"comment_ctime":1579166183,"is_pvip":false,"replies":[{"id":"66872","content":"做下看看结果。会感觉很有意思的。<br>","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579184295,"ip_address":"","comment_id":172386,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579166183","product_id":100042501,"comment_content":"刚好拿到了一个项目高峰期间的ng日志，正好可以按老师说的实践分析下啦。然后和项目上线前的预估比例和指标进行对比看看偏差。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481721,"discussion_content":"做下看看结果。会感觉很有意思的。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579184295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172041,"user_name":"月亮和六便士","can_delete":false,"product_type":"c1","uid":1080894,"ip_address":"","ucode":"EFFCB9171D4B4E","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/3e/82202cc8.jpg","comment_is_top":false,"comment_ctime":1579077863,"is_pvip":false,"replies":[{"id":"66737","content":"根据tps承载比例。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579094612,"ip_address":"","comment_id":172041,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579077863","product_id":100042501,"comment_content":"高老师，看完文章有两个疑问：1 . 在jmeter中，业务比例是依靠什么承载的，是线程数吗？A业务占百分之八十，我就设置A为百分之八十的线程数吗？ 2.  那种按照一小时取平均tps 是不是太粗糙？ 比如 虽然一小时 是2000万的业务量，但是其中的1000万的业务量是在最高峰的10分钟产生的，高峰的tps其实是16000， ","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481599,"discussion_content":"根据tps承载比例。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579094612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171916,"user_name":"Imaginary","can_delete":false,"product_type":"c1","uid":1528943,"ip_address":"","ucode":"DBCFB1AAB977FE","user_header":"https://static001.geekbang.org/account/avatar/00/17/54/6f/476a3cd6.jpg","comment_is_top":false,"comment_ctime":1579053020,"is_pvip":false,"replies":[{"id":"66668","content":"看来是理解了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579063227,"ip_address":"","comment_id":171916,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579053020","product_id":100042501,"comment_content":"答：<br>1、通过对生产数据统计能够完整体现系统业务的峰值数据，然后转换成具体场景中的业务模型，模拟真实的生产环境中的业务比例。不同的业务对系统资源的消耗完全不一样，如果业务模型跟线上的业务模型不一样，就会导致运行过程中业务比例出现很大的偏差，那么得到的结果不够真实正确，也大大降低了性能测试的价值。<br>2、执行场景中控制TPS比例的方法： LoadRunner 里，会用pacing来控制 TPS，而用 JMeter 的，则会用Constant Throughput Timer来控制 TPS。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481544,"discussion_content":"看来是理解了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579063227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171886,"user_name":"NightClown","can_delete":false,"product_type":"c1","uid":1568951,"ip_address":"","ucode":"7E7E21B46FA0FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/YNzQ3Crxqph1Sv3uibGQKKYvqHZShibOmbRJZZibAQLjRIVBU5dWR21hE9ibZ3LkRnWOmY6ywH9yicy57NpqzvKgMGw/132","comment_is_top":false,"comment_ctime":1579050287,"is_pvip":false,"replies":[{"id":"66671","content":"理解的很对。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1579063394,"ip_address":"","comment_id":171886,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1579050287","product_id":100042501,"comment_content":"第一个问题我认为业务比例越趋近生产环境得到的性能数据越真实，生产流量的回放我理解的核心目的也是为了真实的覆盖所需要测试的性能场景，如果业务比例跟真实环境差距很大，那么得到的数据是没有意义的<br>第二个问题控制TPS比例需要根据线上的统计得到每个服务TPS的峰值及范围，不同的天数和时段TPS是不同的，需要根据线上的TPS的比例去测试系统的资源占用和性能指标，这样才能够真实的反应系统的性能情况，不论做系统当前性能测试还是未来系统的容量规划都是有意义的","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481538,"discussion_content":"理解的很对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579063394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1786500,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/42/84/e0a6fc1c.jpg","nickname":"wjh","note":"","ucode":"3504E24EC6D097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164492,"discussion_content":"也想了解下elk","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581176175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}