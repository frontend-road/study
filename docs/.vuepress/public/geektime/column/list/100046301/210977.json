{"id":210977,"title":"10 | 可复用架构案例（三）：中台是如何炼成的？","content":"<p>你好，我是王庆友。</p><p>在<a href=\"https://time.geekbang.org/column/article/209138\">第8讲</a>中，我通过一个实际的订单服务案例，和你介绍了如何设计一个基础服务。今天，我就继续带你了解，如何在实际的业务场景中，通过一步步的架构升级，最后落地一个中台，实现企业级能力的复用。</p><p>通过前面的介绍，我们已经很清楚了共享服务和中台的价值，但在实践中，要不要对系统做这样的升级，我们还需要结合业务来判断，比如说：</p><ol>\n<li><strong>业务上有什么重大变化，导致当前系统的弊端已经很明显，不能适应业务发展了呢？</strong></li>\n<li><strong>架构改造时，如何在业务、系统、资源三者之间做好平衡，对系统进行分步式的改造呢？</strong></li>\n</ol><p>我们知道，架构没有最好，只有最合适的。随着业务的发展，系统需要不断地升级，这是一个螺旋式上升的过程，如何结合当前的业务发展阶段，适时地推进架构改造，并能比较接地气地落地，是我们要追求的目标。</p><p>接下来，我以实际的订单系统改造为例，结合订单业务的发展和系统的痛点，为你介绍，如何推进架构从单体到共享服务、再到中台的改造过程，保证系统能够不断适配业务的升级。</p><p>先说下项目背景。公司作为供应商，为大型餐饮连锁企业打造O2O交易平台，包括三方聚合外卖、自有小程序、App点餐，这些线上用户的订单最终会落到门店的收银系统，由门店进行履单。</p><!-- [[[read_end]]] --><p>公司的业务发展有一个变化过程，一开始只提供聚合外卖服务，后来进一步提供小程序/App下单服务。你可以发现，整个订单处理的架构也是随着业务的变化而不断演变的，下面我就为你一一介绍。</p><h2>聚合外卖订单架构</h2><p>一开始，我们提供的是聚合外卖服务，相应地，系统整体架构如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/46/d3a670ed6f529c91a17603cd91733c46.jpg?wh=1142*600\" alt=\"\"></p><p>这里一共有三个系统，分别是三方外卖平台、门店收银系统以及外卖系统。其中，外卖系统是我们开发的，其他两个都是我们要对接的外部系统，接下来，我说下系统具体的交互过程。</p><p>首先，用户在三方外卖平台（如美团、饿了么）下单；然后，我们的外卖系统通过外卖平台的API拉取用户的订单，把订单落到本地数据库；最后，门店的收银系统访问外卖系统提供的接口获取订单，在门店内部完成履单。当然，门店履单后，收银系统会反过来同步订单状态给外卖系统，外卖系统再同步订单状态到第三方外卖平台。</p><p>你可以看到，这里的外卖系统是一个单体应用，内部包含外卖同步接口和POS接口两个模块。其中，<strong>外卖同步接口</strong>负责和第三方外卖平台对接，它主要是针对不同的外卖平台做接口适配；而 <strong>POS接口</strong>负责和门店的收银系统对接。这两个模块都是使用同一个外卖订单数据库。</p><p>从<strong>数据模型</strong>上看，系统的订单模型也是完全按照外卖订单的需求设计的，订单状态管理也相对比较简单，因为这些订单都是用户在第三方外卖平台已经完成支付的。所以，我们的外卖系统，主要是负责管理门店履单过程中带来的订单状态变化。</p><p>从<strong>系统架构</strong>上看，外卖系统从外卖平台接单，然后把订单推送给后面的收银系统，只需要一个应用、一个数据库、两套接口就可以支持，使用单体架构就能很好地满足外卖的接单需求。</p><h2>小程序下单架构</h2><p>接下来，随着公司业务的升级，除了提供聚合外卖服务之外，公司还提供自有小程序的下单服务。这样，消费者既可以在三方外卖平台下单，也可以在品牌自有的小程序里下单。</p><p><strong>不同于三方外卖订单，小程序下单平台是一个完整的业务</strong>，它包括小程序用户注册、商品和菜单浏览、商品加购物车、在线支付等等。相应地，这里会有多个基础服务对应具体业务的处理。比如，商品服务提供前台的商品浏览功能，支付服务提供用户的支付功能，这些基础服务都是由独立的小程序服务端负责整合，然后提供接口供小程序前端访问。</p><p>当用户在小程序提交订单后，小程序前端会调用服务端的下单接口，然后服务端调用订单服务，在小程序的订单库里落地订单。现在我们已经完成了前台用户的下单，但后台的订单履行怎么处理呢？这里有两种选择：</p><ol>\n<li>小程序订单和外卖订单的处理类似，收银系统除了对接外卖系统，同时也对接小程序的订单服务。但这样一来，收银系统需要同时对接两套订单接口，它需要做大的改造。由于这是第三方的系统，我们在实践中很难落地。</li>\n<li>我们把小程序订单当作一个特殊的外卖渠道，把小程序订单推送到外卖订单库里，最终还是由外卖系统来对接收银系统，也就是相当于小程序订单直接借用了外卖订单的履单通道。</li>\n</ol><p>当时由于项目上线的时间比较紧急，同时从系统稳定性的角度出发，避免对收银系统做大的改造，我们采用了<strong>第二种方式</strong>，小程序的订单处理就嫁接在已有的外卖系统上，整个系统架构如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/ef/ba/ef08a388d34ab936350efd52c1549cba.jpg?wh=1142*467\" alt=\"\"></p><p>你可以看到，小程序下单平台和外卖系统相对独立，同时为了更好地解耦，小程序订单服务和外卖系统之间是通过<strong>消息系统</strong>同步订单数据的。</p><p>这个方案是一个比较务实的选择，通过复用外卖订单的履单通路，我们也实现了小程序订单的闭环处理。表面上看，我们节省了重新搭建系统的成本，也快速落地了小程序交易这条新业务线。</p><p>但这样的架构<strong>实际上是一种妥协</strong>，在后续的系统运行过程中，给我们带来了很多问题：</p><ol>\n<li>这里有两套订单系统，一套针对小程序订单，一套针对外卖订单。我们知道，两者的字段属性和订单状态定义都有不同的地方，我们把小程序的订单硬生生地套在了外卖订单的模型里，这样限制了小程序订单能力的扩展。</li>\n<li>小程序订单处理链路过长，从小程序服务端-&gt;订单服务-&gt;小程序订单数据库-&gt;消息系统-&gt;外卖同步接口-&gt;外卖订单数据库-&gt; POS接口-&gt;收银系统，一共包含了8个处理环节，系统整体的性能和可用性都存在很大问题。比如，取餐码已经从收银系统同步给了外卖系统，但由于消息队列堵塞，外卖系统不能及时同步给小程序的订单服务，这样导致了小程序用户不能及时地看到取餐码。</li>\n<li>为了使两套订单系统解耦，我们使用了消息队列在两个库之间同步订单数据，这降低了系统整体的稳定性。实践中，也发生过多起消息队列故障导致的线上事故。</li>\n</ol><p>你可以发现，出现这些问题的根源是我们把小程序订单硬塞给外卖系统，一方面订单数据模型不匹配，另一方面由于这是两个系统的简单拼接，导致系统调用链路很长，影响了业务的扩展和系统的稳定性。</p><p><strong>那有没有更好的办法，能够把这两个系统有机地结合起来呢？</strong>接下来，我们就来看下，如何通过一个统一的订单服务对两个系统进行深度的融合，从而灵活地支持多种订单业务。</p><h2>统一订单服务架构</h2><p>这里，我们把小程序订单服务提升为统一共享的订单服务，由它来落地所有类型的订单。对于这个统一的订单服务来说，外卖订单、小程序订单，或者是其他的新订单，都是它的下单来源，所有订单汇总在订单服务里，然后统一提供给收银系统进行履单。具体架构如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/7c/b0/7c40a6fe7f17f17b28decf7b09cb0cb0.jpg?wh=1142*785\" alt=\"\"></p><p>你可以看到，系统架构经过调整，有两个大的变化：</p><ol>\n<li>原来外卖和小程序各自有一个订单库，现在合并为了一个订单库，由这个订单服务统一对外提供订单数据的访问和状态管理。</li>\n<li>原来外卖系统的两个模块“外卖同步接口”和“POS接口”，升级为了两个独立的应用。外卖同步接口变成外卖同步服务，对接外卖平台；POS接口变成POS服务，对接门店的收银系统。它们都是通过统一订单服务存取订单数据。</li>\n</ol><p><strong>经过升级，新的架构具备了明显的层次结构，自上而下分为三层：</strong>首先是各个渠道端，包括三方外卖平台、小程序前端和POS收银系统；然后，每个端都有相应的服务端来对接，比如外卖同步服务对接外卖平台、小程序服务端对接小程序、POS服务对接收银系统；最后，这些服务端都统一调用底层的订单服务。</p><p>在这个架构里，如果我们要增加新的下单渠道，就非常方便，比如要支持App下单，我们提供App服务端即可；要新增加后台履单方式也非常方便，比如对于新的电子卡券类订单，它不需要经过收银系统，可以直接由企业的OMS系统（Order Management System，订单管理系统）处理，要实现这样的业务，我们只需新增加一个和OMS系统的适配应用就可以了。所以，<strong>这里就不仅仅是一个外卖订单和小程序订单的处理平台，而是升级成了一个完整的全渠道交易平台。</strong></p><p>同时，订单处理的链路大大缩短，从小程序服务端-&gt;订单服务-&gt;订单数据库-&gt; POS服务-&gt;收银系统，只有5个节点，相比之前减少了3个，系统的可用性和端到端的性能得到了大幅度的提升。</p><p>最后，统一订单服务实现了统一的订单属性定义、统一的订单状态管理，以及订单数据的集中存储，这对后续的BI分析和数据中台建设非常有帮助。它们处理数据时，只需要从一个订单库拉取数据，解析一个订单数据模型就可以了。</p><h2>中台架构</h2><p>上面的统一订单服务整合了外卖和小程序的订单，并且为新的下单渠道预留扩展。按照同样的思路，我们可以构建统一的商品服务，同时满足外卖和小程序上商品的管理；可以构建统一的促销服务，同时支持线上和线下的促销活动；也可以构建统一的库存服务，实现线上和线下库存的同步和共享等等。</p><p><strong>通过构建这样一系列的共享服务，我们就实现了各个渠道业务规则和业务数据的统一管理，最终我们落地了一个强大的业务中台，可以很方便地扩展各个业务，实现企业整体业务能力的复用。</strong></p><p>最后，实际项目的中台架构如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/33/75/3319e45e76ed17eea808a6a4dcf8e575.jpg?wh=1142*606\" alt=\"\"></p><p>在这个架构中，<strong>前端</strong>有3个业务场景，分别是小程序点单、App商城下单、外卖平台下单，每个业务场景都有相应的<strong>服务端</strong>负责对接。在各个服务端下面，还有一些<strong>辅助的应用</strong>，如购物车、秒杀、拼团等等。同时这里还有一个<strong>订单控制服务</strong>（Order Control Service，OCS），负责订单逻辑的编排以及前后台之间的状态同步，你可以把它看作是基础服务之上的聚合服务。</p><p>再底下就是核心的<strong><span class=\"orange\">业务中台</span></strong>，它由9大服务中心组成，这些中心和商户内部系统进行对接。其中，商品中心和库存中心对接ERP系统，会员中心对接CRM系统，订单中心对接POS收银系统，这里的对接分别由对应的适配插件负责。</p><p>通过这个订单业务改造落地后的中台架构，你可以看到，中台由各个通用的基础服务构成，它是相对标准的；而插件是定制的，具体和每个企业的后台系统有关。这样，通过共享服务和中台，我们就把企业内部基础设施和线上业务场景有效地打通了，从系统架构的层面，为企业的全面数字化转型打下了良好的基础。</p><h2>总结</h2><p>今天，我从一个企业的订单业务变化出发，为你介绍了为什么要落地一个统一的订单服务，以及如何落地，并通过打造一系列类似的共享服务，逐步升级系统到中台架构。</p><p>相信通过这个实际案例，你进一步理解了如何通过共享服务和中台，实现业务能力的复用，并能根据公司的业务发展阶段，选择合适的时机、合适的架构，以接地气的方式对系统进行逐步改造。</p><p><strong>最后，给你留一道思考题：</strong>目前你的公司有没有落地共享服务，它是怎么逐步演变过来的呢？</p><p>欢迎你在留言区与大家分享你的答案，如果你在学习和实践的过程中，有什么问题或者思考，也欢迎给我留言，我们一起讨论。感谢阅读，我们下期再见。</p>","neighbors":{"left":{"article_title":"09 | 可复用架构案例（二）：如何对现有系统做微服务改造？","id":209597},"right":{"article_title":"11 | 技术架构：作为开发，你真的了解系统吗？","id":212066}},"comments":[{"had_liked":false,"id":187790,"user_name":"雨霖铃声声慢","can_delete":false,"product_type":"c1","uid":1052607,"ip_address":"","ucode":"656D98310C6DA3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/bf/ee93c4cf.jpg","comment_is_top":false,"comment_ctime":1584243324,"is_pvip":false,"replies":[{"id":"72526","content":"用户基本信息表就一张，同一个用户就一条记录。<br>然后有一个用户渠道表，一个用户一个渠道一条记录，比如小程序渠道，公众号渠道，支付宝渠道就有三条记录。用户基本信息表和用户渠道表1对多关联。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584278350,"ip_address":"","comment_id":187790,"utype":1}],"discussion_count":2,"race_medal":0,"score":"48828883580","product_id":100046301,"comment_content":"老师，请教一下在文中这套系统中，用户的数据结构应该是什么样子，因为这里有小程序用户，有外卖第三方平台用户，那么用户系统的数据表是不是一张大表，包含了所有小程序和外卖用户需要的信息？如果是这样，后面在对接其他新业务用户，那么就要修改数据表扩展新字段，这好像不是很好，那么是不是可以认为内部有多个表存储这这些用户数据，然后订单里面在关联不同的用户id？","like_count":11,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487242,"discussion_content":"用户基本信息表就一张，同一个用户就一条记录。\n然后有一个用户渠道表，一个用户一个渠道一条记录，比如小程序渠道，公众号渠道，支付宝渠道就有三条记录。用户基本信息表和用户渠道表1对多关联。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584278350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222051,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIgDicRj9LAvWUr6eJicuGEUlPPoibTdntEOztxlpNqPHXtflqTShnrTcjNQT0zjtbLFIVW1GtCTk3KQ/132","nickname":"商君","note":"","ucode":"B974FBE81FFF98","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217006,"discussion_content":"需要建索引的加字段，不需要的加extra里？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585494798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233233,"user_name":"，","can_delete":false,"product_type":"c1","uid":1701867,"ip_address":"","ucode":"A5543C8DFEB198","user_header":"https://static001.geekbang.org/account/avatar/00/19/f7/eb/e7127bb8.jpg","comment_is_top":false,"comment_ctime":1594266132,"is_pvip":true,"replies":[{"id":"86886","content":"是的","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1594966424,"ip_address":"","comment_id":233233,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27364069908","product_id":100046301,"comment_content":"   我对老师这次重构的理解是这样的,不知道对不对:<br>    最开始外卖系统只负责订单管理,像收银和用户等服务都在第三方平台处管理。<br>    然而在做小程序下单服务时,因为他是一个完整的业务流程,需要用户平台,收银平台,商品平台,所以延续以前对接第三方的做法,将收银服务,用户服务,等都放在小程序下单服务里,相当于将小程序做成一个第三方,对接外卖系统的订单服务。<br>      之后随着业务范围的扩大,逐渐出现了各渠道的业务体系,应用端从PC端到App再到小程序,他们分别有不同的业务流程,但业务域大同小异。为了减少重复开发,规范业务流程,快速上线新应用,于是决定下沉基础服务,基于面向对象的方式,建立通用的业务平台,于是就有了中台<br>    同时中台的上线,还必须满足这些假设:<br>    业务范围大,渠道足够多,但是业务域大同小异,如果任由其发展,不同渠道的服务将会出现重复开发的现象,这样才有做成中台的必要性","like_count":6,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500951,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594966424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187366,"user_name":"粗线条Jackie","can_delete":false,"product_type":"c1","uid":1077098,"ip_address":"","ucode":"8B430BF860FFEE","user_header":"https://static001.geekbang.org/account/avatar/00/10/6f/6a/3e8ce554.jpg","comment_is_top":false,"comment_ctime":1584092249,"is_pvip":true,"replies":[{"id":"72323","content":"赞一个，能够结合实际做很深入的思考。试着回答你的问题：<br>1. OMS是一个很重要的概念，说下我理解的OMS职责。当订单生成后，OMS就开始工作，比如对订单进行审核，决定订单流转到哪个仓库履行，交给哪个配送商进行配送，OMS是一个决策和调度中心，自己不具体干活。它和订单中心还不是一回事，一般说它在订单中心后面，会通过订单中心读取数据，并修改订单的状态。<br>#2，这个OMS看起来更像一个订单中心，不知它有没有提供后续订单如何处理的决策。<br>#3 业务中台，共享服务划分和业务紧密相关，DDD是一种方法和工具，可以使用它来划分，DDD概念拆的很细，给我们提供很清晰的分析思路，但也是有点繁琐，如果能够参考而不是照搬它那就最好。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584099601,"ip_address":"","comment_id":187366,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23058928729","product_id":100046301,"comment_content":"仔细研读了老师的每一期课程，受益匪浅。我们团队现有的Ecommerce平台，由最初的电话下单一体式应用，逐步演化成支持了PC Web、小程序、企业App和第三方外卖平台的SOA服务化架构。比对了老师的文中介绍，感觉目前我们的服务模块更像是一个&quot;应用平台&quot;+&quot;业务中台&quot;的结合体，供前端应用直接调用，向下与连锁门店和POS打通，为了适配业务的快速变化，现有服务模块的更新频次过高和模块间的紧耦合是比较突出的问题。后续，打算梳理和界定好业务的领域模型边界，把&quot;应用平台&quot;+&quot;业务中台&quot;尝试分离独立。<br><br>有两个小问题，请教一下老师，望指点迷津:<br>1. 老师文中提到了OMS系统，但在架构图中没有模块与之映射，通常情况下这个OMS与业务中台中的订单中心是同一回事情吗？<br><br>2.由问题(1)引申，我某位在零售公司做架构的朋友，他们出于在天猫&#47;京东开店的需求，采购了某外部商用的OMS产品进行私有化部署(需商用OMS公司做实施和二开)，并通过阿里接口与企业供应链WMS进行了打通。他们目前围绕这个商用的OMS做了一些二次开发，调用OMS的开放API可以批量导入更多小平台订单和手工单。请问这种模式下，这个OMS可以理解为业务中台的订单中心吗？还是仅仅做为一个抓单汇集的工具，企业中台需要重新做订单中心的规划建设？ <br><br>3.&quot;业务中台&quot;的边界划分，领域驱动设计(DDD)相关知识是否必需？老师后续课程是否有会有涉及呢？","like_count":5,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487087,"discussion_content":"赞一个，能够结合实际做很深入的思考。试着回答你的问题：\n1. OMS是一个很重要的概念，说下我理解的OMS职责。当订单生成后，OMS就开始工作，比如对订单进行审核，决定订单流转到哪个仓库履行，交给哪个配送商进行配送，OMS是一个决策和调度中心，自己不具体干活。它和订单中心还不是一回事，一般说它在订单中心后面，会通过订单中心读取数据，并修改订单的状态。\n#2，这个OMS看起来更像一个订单中心，不知它有没有提供后续订单如何处理的决策。\n#3 业务中台，共享服务划分和业务紧密相关，DDD是一种方法和工具，可以使用它来划分，DDD概念拆的很细，给我们提供很清晰的分析思路，但也是有点繁琐，如果能够参考而不是照搬它那就最好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584099601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210198,"user_name":"Geek_kevin","can_delete":false,"product_type":"c1","uid":1301274,"ip_address":"","ucode":"03B0253CA59582","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/1a/30201f1a.jpg","comment_is_top":false,"comment_ctime":1587696516,"is_pvip":false,"replies":[{"id":"78576","content":"业务中台的订单你可以认为面向C端的接单系统，ERP订单是面向企业B端的履单系统，用户下单后，中台订单同步给ERP，这个同步不需要实时；ERP履单后，订单状态同步给中台订单。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1587955311,"ip_address":"","comment_id":210198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14472598404","product_id":100046301,"comment_content":"老师,请教业务中台的订单和ERP的订单有什么关系? 如果是b2c, 促销订单非常多，均会进入ERP吗？ERP是单体应用，有性能瓶颈","like_count":3,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492967,"discussion_content":"业务中台的订单你可以认为面向C端的接单系统，ERP订单是面向企业B端的履单系统，用户下单后，中台订单同步给ERP，这个同步不需要实时；ERP履单后，订单状态同步给中台订单。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587955311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188558,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1024763,"ip_address":"","ucode":"F6B5C64BC99FB7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a2/fb/94af9cf1.jpg","comment_is_top":false,"comment_ctime":1584368420,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14469270308","product_id":100046301,"comment_content":"用户中心估计是大家第一个要动手的共享服务吧","like_count":3},{"had_liked":false,"id":187597,"user_name":"孙同学","can_delete":false,"product_type":"c1","uid":1676238,"ip_address":"","ucode":"C6C82400D15336","user_header":"https://static001.geekbang.org/account/avatar/00/19/93/ce/092acd6a.jpg","comment_is_top":false,"comment_ctime":1584168948,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14469070836","product_id":100046301,"comment_content":"https:&#47;&#47;www.processon.com&#47;view&#47;link&#47;5e51378ce4b0c037b5f9d1e3 学习整理更新 ","like_count":3},{"had_liked":false,"id":187208,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1584060319,"is_pvip":false,"replies":[{"id":"72298","content":"前端直接调中台的服务不合适，主要有两个原因:<br>1. 对于外部过来的请求，我们需要提供一些非业务性的功能，比如签名验证，协议和参数适配（外部的rest和内部的rpc）<br>2. 中台只是提供基础业务功能，前端过来的请求是代表一个业务场景，需要同时用到多个服务的功能，比如前台下单，需要用到用户服务，商品服务，库存服务，订单服务等，这不合适直接在前端做功能整合。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584086277,"ip_address":"","comment_id":187208,"utype":1}],"discussion_count":5,"race_medal":0,"score":"14468962207","product_id":100046301,"comment_content":"老师，从功能上看，第二层的应用平台层是否可以省掉，直接由前端比如小程序或者app等渠道直接发起request调用中台呢？第二层主要作用是什么？","like_count":3,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487031,"discussion_content":"前端直接调中台的服务不合适，主要有两个原因:\n1. 对于外部过来的请求，我们需要提供一些非业务性的功能，比如签名验证，协议和参数适配（外部的rest和内部的rpc）\n2. 中台只是提供基础业务功能，前端过来的请求是代表一个业务场景，需要同时用到多个服务的功能，比如前台下单，需要用到用户服务，商品服务，库存服务，订单服务等，这不合适直接在前端做功能整合。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584086277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":205219,"discussion_content":"我的理解是，中台包含了基础服务，以及之上的各种基础服务的典型聚合，这样简化了上层应用的使用，但各个偏定制的编排还是落到各个上层应用里。只有通用的鉴权可以落到独立的网关中，如果没有网关，就落到上层应用里。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584279830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251111,"avatar":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","nickname":"Jxin","note":"","ucode":"4C03928388C413","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204192,"discussion_content":"1.我也觉得不该直接调用基础服务。但不止是栏主提到的角度。\n\n2.假设bff直接调用基础服务，那么各个bff间将会有大量重复代码。抽一层可以更好的应用。\n\n3.我认为基础服务那层才是平台，追求的是可复用，实现上是高度抽象。而建设在基础平台上层的才是中台，追求的是易复用，实现上是针对多个系统领域重叠的问题域做统一的实现，是一种针对性的定制。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584121401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1489957,"avatar":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","nickname":"tt","note":"","ucode":"7753B79AD5A9AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203715,"discussion_content":"嗯，我也觉得基础服务都是比较原子的，而一个业务会有若干个需求，比如检验、鉴权等。需要把这些基础服务组合起来，就是图中说的服务编排吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584069917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1042354,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e7/b2/334bc992.jpg","nickname":"AlfredLover","note":"","ucode":"A3A998F362CC37","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203681,"discussion_content":"第二层会有相关的业务逻辑、校验等。如果去掉，都塞在中台里面，中台的职责就没那么清晰了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584065000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344284,"user_name":"Geek_741b0e","can_delete":false,"product_type":"c1","uid":2946336,"ip_address":"","ucode":"CCFCE37871A55A","user_header":"","comment_is_top":false,"comment_ctime":1651419191,"is_pvip":false,"replies":[{"id":"126480","content":"三方平台的主动推送目前看只有在支付情况下，会主动回调外部系统，保证业务及时可靠。<br>一般来说都是要外部系统主动查询平台方，不然平台要保证推送的时效和可靠性，外部系统的情况差异很大(比如经常挂掉)，三方平台不想由他自己来保证这点。另外，也不确定外部系统的需求，有可能一天只要查一次就可以。","user_name":"作者回复","user_name_real":"编辑","uid":"1268522","ctime":1653558891,"ip_address":"","comment_id":344284,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10241353783","product_id":100046301,"comment_content":"为什么对接三方外卖平台，是主动拉取？而不是平台主动推送呢。如果是为了对接成本或通用性考虑，主动推送也可以做成只配置推送目标地址，推送数据结构固定的方式。 想请教老师，外卖第三方主要是基于什么考虑，设计成主动拉取第三方数据？","like_count":2,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573638,"discussion_content":"三方平台的主动推送目前看只有在支付情况下，会主动回调外部系统，保证业务及时可靠。\n一般来说都是要外部系统主动查询平台方，不然平台要保证推送的时效和可靠性，外部系统的情况差异很大(比如经常挂掉)，三方平台不想由他自己来保证这点。另外，也不确定外部系统的需求，有可能一天只要查一次就可以。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653558891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244914,"user_name":"美美","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1598750834,"is_pvip":false,"replies":[{"id":"90875","content":"中台本质是共享复用，然后是连接前后台。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1599703278,"ip_address":"","comment_id":244914,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10188685426","product_id":100046301,"comment_content":"这个还不能算业务中台吧，叫共享服务比较Ok吧","like_count":2,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504733,"discussion_content":"中台本质是共享复用，然后是连接前后台。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599703278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295672,"user_name":"暮色晨春","can_delete":false,"product_type":"c1","uid":2612929,"ip_address":"","ucode":"24010A048648FC","user_header":"https://static001.geekbang.org/account/avatar/00/27/de/c1/450a0b52.jpg","comment_is_top":false,"comment_ctime":1622539864,"is_pvip":false,"replies":[{"id":"107448","content":"你的想法对的，中台把基础能力抽象化和通用化，支持之上复杂的业务场景，以有限的基础服务支持无限的业务场景。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1622715124,"ip_address":"","comment_id":295672,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5917507160","product_id":100046301,"comment_content":"我感觉老师举的这个例子也可以通过SOA架构实现，如果微服务模块数量没有那么多，业务应用互相数据调用交互更加频繁的话。<br>中台的建立构建在更大，服务场景更为复杂的企业或者政府机构中才更具有意义。譬如数字政府这类。<br>不知道想法对不对，如果把中台仅仅理解成为共享服务，那就可大可小了。","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521176,"discussion_content":"你的想法对的，中台把基础能力抽象化和通用化，支持之上复杂的业务场景，以有限的基础服务支持无限的业务场景。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622715124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233641,"user_name":"冬瓜蔡","can_delete":false,"product_type":"c1","uid":1117673,"ip_address":"","ucode":"2F04A446D28201","user_header":"https://static001.geekbang.org/account/avatar/00/11/0d/e9/2f02a383.jpg","comment_is_top":false,"comment_ctime":1594373578,"is_pvip":false,"replies":[{"id":"86888","content":"业务编排层如果功能简单，一个应用就可以。如果功能负责，体量大，可以按照业务场景划分下。<br><br>工作经验少，技术弱一点，抽象建模能力差一点的做编排。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1594966606,"ip_address":"","comment_id":233641,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5889340874","product_id":100046301,"comment_content":"老师你好，我有以下两个问题想请教下：<br> 1、业务编排层也是独立出来的多个应用吗？多个应用按照上面维度划分？按场景还是其他的？<br> 2、业务中台，有各自的核心业务领域，在人员划分上相对好隔离，如商品团队、订单团队等；<br> 但是编排层，没有具体的业务场景，主要是对底层的编排，感觉大家都不愿意负责这一块，那这块的人员划分和组队如何处理呢？","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501116,"discussion_content":"业务编排层如果功能简单，一个应用就可以。如果功能负责，体量大，可以按照业务场景划分下。\n\n工作经验少，技术弱一点，抽象建模能力差一点的做编排。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594966606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219828,"user_name":"王叫兽。","can_delete":false,"product_type":"c1","uid":1461445,"ip_address":"","ucode":"AB6328E9DFF8B0","user_header":"https://static001.geekbang.org/account/avatar/00/16/4c/c5/946244a8.jpg","comment_is_top":false,"comment_ctime":1590108409,"is_pvip":false,"replies":[{"id":"81243","content":"这是历史遗留问题，ERP里的包含各种各样的数据，就商品数据而言，数据模型和线上商品模型也不完全一致，线上商品信息包含很多额外字段。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1590158086,"ip_address":"","comment_id":219828,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5885075705","product_id":100046301,"comment_content":"老师你好，看了很多确实学到很多东西，但是这里有一个疑问，商品信息和ERP同步，这样的基础数据就变成了两套，很容易就造成脏数据问题。为什么不直接是使用ERP的数据呢","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495952,"discussion_content":"这是历史遗留问题，ERP里的包含各种各样的数据，就商品数据而言，数据模型和线上商品模型也不完全一致，线上商品信息包含很多额外字段。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590158086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209817,"user_name":"Robin康F","can_delete":false,"product_type":"c1","uid":1962437,"ip_address":"","ucode":"618F8686D1231D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyLCPnVq4gKMN5jPcd9wVVEXtZMibCNAkLrJf4uZKdV40Nelb3uPtCETfuw5hbbC693sUHQpRUMiaA/132","comment_is_top":false,"comment_ctime":1587620041,"is_pvip":false,"replies":[{"id":"78378","content":"很不错","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1587720463,"ip_address":"","comment_id":209817,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5882587337","product_id":100046301,"comment_content":"我们公司是做生鲜电商的。架构演变经历了3个阶段，一、刚开始时是外卖平台和H5拉新；二、然后开发了自己的app,接收订单；三、开发了小程序，更轻量级获取订单。架构刚开始是多烟囱的多系统，然后现在慢慢沉淀为各个服务平台，订单平台，商品中台，物流中台等，实现了分布式架构SOA服务，同时公司开发了自己的组件mq,redis的自有版本，进行业务适配，很好的应对业务快速发展的需要","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492873,"discussion_content":"很不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587720463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206066,"user_name":"风中舞者","can_delete":false,"product_type":"c1","uid":1070630,"ip_address":"","ucode":"BE0D480624CFC1","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/26/5f78314d.jpg","comment_is_top":false,"comment_ctime":1586783619,"is_pvip":false,"replies":[{"id":"77032","content":"对于通用的聚合服务，比如下单服务和商品详情服务（涉及商品服务，库存服务，价格服务），中台要提供，方便上层使用，考虑链路开销和可用性，服务调用层次不要太多，一般最多不超过三层服务。 应用-&gt;聚合服务-&gt;基础服务-&gt;系统服务（如短信通知）","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1586832935,"ip_address":"","comment_id":206066,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5881750915","product_id":100046301,"comment_content":"老师，中台中心内部的微服务架构是否需要设计聚合微服务，这样会不会产生链路开销？还是推荐将服务编排统一做到应用层。","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491657,"discussion_content":"对于通用的聚合服务，比如下单服务和商品详情服务（涉及商品服务，库存服务，价格服务），中台要提供，方便上层使用，考虑链路开销和可用性，服务调用层次不要太多，一般最多不超过三层服务。 应用-&amp;gt;聚合服务-&amp;gt;基础服务-&amp;gt;系统服务（如短信通知）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586832935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200768,"user_name":"风中舞者","can_delete":false,"product_type":"c1","uid":1070630,"ip_address":"","ucode":"BE0D480624CFC1","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/26/5f78314d.jpg","comment_is_top":false,"comment_ctime":1585648550,"is_pvip":false,"replies":[{"id":"75161","content":"数据库属于各中心，注册中心可以共享。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1585663481,"ip_address":"","comment_id":200768,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880615846","product_id":100046301,"comment_content":"老师，中台架构改造后各中心的注册中心和数据库也是按中心内的服务架构划分,还是共享。","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490132,"discussion_content":"数据库属于各中心，注册中心可以共享。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585663481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192757,"user_name":"noia_zhou","can_delete":false,"product_type":"c1","uid":1618397,"ip_address":"","ucode":"891092C37D06D5","user_header":"https://wx.qlogo.cn/mmopen/vi_32/71f7hSaAxibZicXvBVLqOwBTaRJ1hyYtAw1p6JYwQHpzj1Ssl1EaXaR2twkeyX4yv5vae8DepY8vic98L4aRRmxVQ/132","comment_is_top":false,"comment_ctime":1584871543,"is_pvip":false,"replies":[{"id":"73740","content":"可以跨层调用，比如根据订单ID查询订单信息，没有必要做多层包装。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584934838,"ip_address":"","comment_id":192757,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879838839","product_id":100046301,"comment_content":"想请教一下，对于简单的只涉及单个应用的查询或修改，网关层能直接调用共享服务吗？还是说必须是一个严格分层模式。","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488455,"discussion_content":"可以跨层调用，比如根据订单ID查询订单信息，没有必要做多层包装。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584934838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189058,"user_name":"AngryApe","can_delete":false,"product_type":"c1","uid":1414971,"ip_address":"","ucode":"E0125A8D2AC84B","user_header":"https://static001.geekbang.org/account/avatar/00/15/97/3b/c98b68c1.jpg","comment_is_top":false,"comment_ctime":1584451039,"is_pvip":false,"replies":[{"id":"73017","content":"业务流程偏定制，很难实现这个粒度的复用。<br>对于典型的比较通用的流程，可以有对应的聚合服务实现流程，但一般这样的聚合服务数量不会很大，大部分流程的逻辑在应用里自己实现。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584516497,"ip_address":"","comment_id":189058,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879418335","product_id":100046301,"comment_content":"王老师您好，前面能力复用讲到的业务实体、业务流程、产品，但是这篇的架构图中只画了业务实体，没有出现业务流程对应的服务。我的理解中台更多的是业务流程的复用，是我理解的不对吗？","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487600,"discussion_content":"业务流程偏定制，很难实现这个粒度的复用。\n对于典型的比较通用的流程，可以有对应的聚合服务实现流程，但一般这样的聚合服务数量不会很大，大部分流程的逻辑在应用里自己实现。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584516497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187190,"user_name":"阿男","can_delete":false,"product_type":"c1","uid":1103370,"ip_address":"","ucode":"25EBC42658CFE8","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/0a/875d892d.jpg","comment_is_top":false,"comment_ctime":1584057149,"is_pvip":false,"replies":[{"id":"72237","content":"可以根据当前c端最急需的，慢慢落地一个个能力，比如会员中台，营销中台，把前后台给打通。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584061866,"ip_address":"","comment_id":187190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879024445","product_id":100046301,"comment_content":"老师您好，如果是传统It公司，所做的系统没有这么大的体量，领导又想上个中台，有没有好的下手思路？","like_count":1,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487024,"discussion_content":"可以根据当前c端最急需的，慢慢落地一个个能力，比如会员中台，营销中台，把前后台给打通。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584061866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357338,"user_name":"问题究竟系边度","can_delete":false,"product_type":"c1","uid":1095284,"ip_address":"上海","ucode":"CA4F2C9A84F867","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/74/c63449b1.jpg","comment_is_top":false,"comment_ctime":1663163547,"is_pvip":true,"replies":[{"id":"130107","content":"中台定义企业核心的业务流程和数据模型，快速变更的需求的更应该在上层应用中实现，当然中台同时也要做好高度的抽象和通用化，一旦落地，变动相对少一些。","user_name":"作者回复","user_name_real":"编辑","uid":"1268522","ctime":1663325231,"ip_address":"上海","comment_id":357338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1663163547","product_id":100046301,"comment_content":"中台怎么支持快速变更的需求？ 中台流程中是否有定制位置？","like_count":0,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587861,"discussion_content":"中台定义企业核心的业务流程和数据模型，快速变更的需求的更应该在上层应用中实现，当然中台同时也要做好高度的抽象和通用化，一旦落地，变动相对少一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663325232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351849,"user_name":"carl.zhao","can_delete":false,"product_type":"c1","uid":1102371,"ip_address":"上海","ucode":"43101DCF854A99","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/23/5e5dde9b.jpg","comment_is_top":false,"comment_ctime":1658228450,"is_pvip":false,"replies":[{"id":"130120","content":"存储的话，最好是统一放在订单服务里，比如说用一个json字段，个性化字段都可以放进去；具体json解析交给外卖服务端或者小程序服务端。","user_name":"作者回复","user_name_real":"编辑","uid":"1268522","ctime":1663394211,"ip_address":"上海","comment_id":351849,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1658228450","product_id":100046301,"comment_content":"老师请问各个订单的个性化字段怎么保存？比如外卖订单和小程序的订单，是保存到外卖服务端或者小程序服务端吗？","like_count":0,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587917,"discussion_content":"存储的话，最好是统一放在订单服务里，比如说用一个json字段，个性化字段都可以放进去；具体json解析交给外卖服务端或者小程序服务端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663394212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346570,"user_name":"bigben","can_delete":false,"product_type":"c1","uid":1169313,"ip_address":"","ucode":"DBD15A6C8E2590","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkeOAC8k7aPMfQZ4ickiavpfR9mTQs1wGhGtIicotzAoszE5qkLfFTabkDU2E39ovSgoibJ1IiaLXtGicg/132","comment_is_top":false,"comment_ctime":1653233998,"is_pvip":false,"replies":[{"id":"126461","content":"门店端POS，图上有的","user_name":"作者回复","user_name_real":"编辑","uid":"1268522","ctime":1653389822,"ip_address":"","comment_id":346570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1653233998","product_id":100046301,"comment_content":"收银系统是什么。图上没有啊","like_count":0,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573402,"discussion_content":"门店端POS，图上有的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653389823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318073,"user_name":"流云追风","can_delete":false,"product_type":"c1","uid":2611950,"ip_address":"","ucode":"16D738406CB191","user_header":"https://static001.geekbang.org/account/avatar/00/27/da/ee/63090718.jpg","comment_is_top":false,"comment_ctime":1635140883,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635140883","product_id":100046301,"comment_content":"我们的共享服务组,目前主要是承接用户中心和支付服务,而交易负责了订单服务,各种基础服务正在分布构建中,之前不太明白公司这种大改造的原因。现在经过老师的课程,清晰了许多","like_count":0},{"had_liked":false,"id":214316,"user_name":"鲁正义","can_delete":false,"product_type":"c1","uid":1916005,"ip_address":"","ucode":"EA4AA39EBACEFB","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3c/65/87912180.jpg","comment_is_top":false,"comment_ctime":1588723719,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588723719","product_id":100046301,"comment_content":"平滑过度，圈表，业务价值，业务团队和服务团队","like_count":0},{"had_liked":false,"id":208933,"user_name":"密码123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1587466607,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1587466607","product_id":100046301,"comment_content":"我以为1.0的方案很好，很强大了。结果扔出2.0的方案。经过对比1.0好low啊！","like_count":0,"discussions":[{"author":{"id":1012100,"avatar":"","nickname":"Mongo","note":"","ucode":"3EED4257A8F8C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414732,"discussion_content":"每次都需要做适配，而且整体链路、消息同步都是问题看不到？？？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636879719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192857,"user_name":"Geek_kevin","can_delete":false,"product_type":"c1","uid":1301274,"ip_address":"","ucode":"03B0253CA59582","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/1a/30201f1a.jpg","comment_is_top":false,"comment_ctime":1584876151,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584876151","product_id":100046301,"comment_content":"目前公司还没有共享服务，业务服务复用率低","like_count":0},{"had_liked":false,"id":190450,"user_name":"刘楠","can_delete":false,"product_type":"c1","uid":1120773,"ip_address":"","ucode":"9F19D44CBEE039","user_header":"https://static001.geekbang.org/account/avatar/00/11/1a/05/f154d134.jpg","comment_is_top":false,"comment_ctime":1584662208,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584662208","product_id":100046301,"comment_content":"我们公司的模式有点像，可以学习下，按这个样搞下","like_count":0},{"had_liked":false,"id":187259,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1584070082,"is_pvip":false,"replies":[{"id":"72294","content":"一般来说，中台总体上是由一个供应商开发，其他供应商可以基于中台做具体业务场景开发。","user_name":"作者回复","user_name_real":"王庆友","uid":"1268522","ctime":1584085933,"ip_address":"","comment_id":187259,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1584070082","product_id":100046301,"comment_content":"老师，有一个问题，如果中台中的模块是由若干的不同的厂商开发的，要如何保证部署的独立性呢。一个基础服务版本升级，现有接口没有变化，增加若干新的接口，还如何组织测试呢？","like_count":0,"discussions":[{"author":{"id":1268522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2a/83c3cb2d.jpg","nickname":"王庆友","note":"","ucode":"90D8743C4A6C79","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487047,"discussion_content":"一般来说，中台总体上是由一个供应商开发，其他供应商可以基于中台做具体业务场景开发。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584085933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}