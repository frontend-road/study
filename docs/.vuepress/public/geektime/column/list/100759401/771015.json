{"id":771015,"title":"08ï½œç½‘é¡µæŒ‡æ ‡ï¼šå¦‚ä½•å¿«é€ŸæŠŠWeb Vitalsé›†æˆåˆ°å®é™…é¡¹ç›®ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸‰æ¡¥ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘å°†ä¸ºä½ ä»‹ç»å®ç°å‰ç«¯å…¨é“¾è·¯æŒ‡æ ‡æ•°æ®çš„ç¬¬ä¸€æ­¥ï¼ŒæŠŠWeb Vitalsé›†æˆåˆ°ä½ çš„é¡¹ç›®ã€‚</p><p>æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å‰ç«¯é¡¹ç›®çš„ç°çŠ¶ã€‚</p><p>è¿‘å¹´æ¥ï¼Œå‰ç«¯å¼€å‘è€…ä»0åˆ°1å¼€å‘æ–°é¡¹ç›®ï¼ŒæŠ€æœ¯é€‰å‹è¿™æ–¹é¢åŸºæœ¬ä¸Šä¼šå°†Vueå’ŒReactä½œä¸ºå‰ç«¯å¼€å‘é¦–é€‰æ¡†æ¶ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä»¬çš„æ¨¡å—åŒ–å¼€å‘æ¨¡å¼èƒ½è®©æˆ‘ä»¬æ–¹ä¾¿ã€å¿«é€Ÿåœ°å¼•å…¥ç¬¬ä¸‰æ–¹æ¡†æ¶æˆ–åº“ï¼Œä¸ºå¼€å‘æ›´å¤æ‚çš„åŠŸèƒ½æä¾›å¼ºå¤§çš„åç›¾ã€‚</p><p>å®é™…ä¸Šï¼Œå‰ç«¯å·¥ç¨‹å¸ˆéœ€è¦è´Ÿè´£çš„é¡¹ç›®å¹¶ä¸ä»…ä»…å±€é™äºVueå’ŒReactè¿™ä¸¤ç§æ¡†æ¶ï¼Œæœ‰äº›å…¬å¸è¿˜åœ¨ç»´æŠ¤ç€æœ€ä¼ ç»Ÿçš„æ—§å‰ç«¯ç³»ç»Ÿï¼Œä»–ä»¬ä»ç„¶ä½¿ç”¨ç€å¤è€çš„æŠ€æœ¯æ ˆï¼Œä¾‹å¦‚JSPã€ASPã€PHPä»¥åŠjQueryç­‰ã€‚</p><p>é‚£åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œå‰ç«¯åŒå­¦åº”è¯¥å¦‚ä½•æŠŠWeb Vitalçš„ç½‘é¡µæŒ‡æ ‡åº”ç”¨åˆ°ä¸åŒæ¶æ„çš„å‰ç«¯é¡¹ç›®ä¸Šï¼Œå¹¶å®ç°å…¨é“¾è·¯çš„åˆ†æå’Œä½“éªŒä¼˜åŒ–å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„é¢˜ç›®ã€‚</p><h2>ä½¿ç”¨Web Vitalsçš„ç¬¬ä¸€æ­¥</h2><p>Web Vitalsç½‘é¡µæŒ‡æ ‡æ˜¯ç”±Googleæå‡ºçš„ã€‚Googleè¿˜å¼€å‘äº†ä¸€å¥—å‰ç«¯SDKï¼Œæ–¹ä¾¿å‰ç«¯åŒå­¦ç›´æ¥é€šè¿‡å‡½æ•°è·å–ç½‘é¡µæŒ‡æ ‡æ•°æ®ã€‚</p><p>é€šå¸¸ï¼Œæƒ³è¦å‰ç«¯é¡¹ç›®ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¯ä»¥é€šè¿‡NPMå®‰è£…ä¾èµ–æˆ–è€…scripté“¾æ¥å¼•å…¥çš„æ–¹å¼å®ç°ã€‚è€ŒWeb Vitalsåº“æ­£å¥½å¯ä»¥æ”¯æŒè¿™ä¸¤ç§æ–¹å¼ã€‚</p><p>å¦‚æœå‰ç«¯é¡¹ç›®æ˜¯é€šè¿‡NPMå®‰è£…ä¾èµ–ï¼Œæ¯”å¦‚Vueæˆ–Reacté¡¹ç›®ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨npmã€yarnæˆ–pnpmå®‰è£…å‘½ä»¤æ¥å®‰è£…Web Vitalsã€‚</p><!-- [[[read_end]]] --><pre><code class=\"language-shell\">// ä½¿ç”¨npm \nnpm install web-vitals \n// ä½¿ç”¨yarn \nyarn add web-vitals \n// ä½¿ç”¨pnpm\npnpm add web-vitals\n</code></pre><p>ç¬¬äºŒç§ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„æ–¹æ³•æ˜¯é€šè¿‡ä¼ ç»Ÿçš„ <code>script</code> æ ‡ç­¾å¼•å…¥ä¸€ä¸ªJSæ–‡ä»¶ã€‚å¯¹äºä¸æ”¯æŒNPMå®‰è£…ä¾èµ–çš„å‰ç«¯é¡¹ç›®æ¥è¯´ï¼Œè¿™å°±æ˜¯æœ€ä½³çš„å¼•å…¥æ–¹å¼ã€‚</p><p>ç„¶è€Œï¼Œé€šè¿‡ <code>script</code> æ ‡ç­¾å¼•å…¥çš„Web Vitalsä¸èƒ½å®ç°ç»„ä»¶åŒ–ä¸­çš„importå¯¼å…¥ï¼Œåªèƒ½é€šè¿‡window.webVitalså¯¹è±¡æ¥è¯»å–ç½‘é¡µæŒ‡æ ‡æ•°æ®ã€‚</p><p>ä¸‹é¢æ˜¯å¼•å…¥å¤–éƒ¨é“¾æ¥web-vitals.iife.jsçš„ä»£ç ã€‚</p><pre><code class=\"language-xml\">&lt;script&gt; \n  (function () { \n    var script = document.createElement('script');\n    script.src = 'https://unpkg.com/web-vitals@3/dist/web-vitals.iife.js';\n    script.onload = function () {\n      window.webVitals.onCLS(console.log);\n      window.webVitals.onFID(console.log);\n      window.webVitals.onLCP(console.log); \n    };\n    document.head.appendChild(script); \n  })();\n&lt;/script&gt;\n</code></pre><p>ä¸Šé¢çš„ä»£ç é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯ä¾‹å­ä¸­ä½¿ç”¨çš„æ˜¯unpkg.comç«™ç‚¹çš„é“¾æ¥ã€‚ç”±äºè¿™ä¸ªç«™ç‚¹å½’å±äºæµ·å¤–æœåŠ¡å•†ï¼Œæ‰€ä»¥å¦‚æœä½ çš„ä¸šåŠ¡åªæœ‰å›½å†…ç”¨æˆ·ï¼Œé‚£è¿˜æ˜¯ä¸å»ºè®®ä½ ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚</p><p>é€šå¸¸çš„åšæ³•æ˜¯æŠŠè¿™ä¸ªé“¾æ¥çš„JSæ–‡ä»¶ä¸‹è½½æœ¬åœ°ï¼Œç„¶åæ”¾åˆ°å›½å†…å·²å¤‡æ¡ˆçš„ç«™ç‚¹ä¸Šã€‚ç›®å‰æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è®©ä½ æŠŠå®ƒæ‰˜ç®¡åˆ°ä»»æ„åœ°æ–¹ã€‚</p><ol>\n<li>å­˜æ”¾åœ¨ä½ å…¬å¸ä¸šåŠ¡çš„æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡WebæœåŠ¡å™¨æä¾›å¯è®¿é—®çš„é“¾æ¥ã€‚</li>\n<li>æ‰˜ç®¡åœ¨å…¬ç½‘æä¾›çš„é™æ€èµ„æºæœåŠ¡ä¸Šï¼Œä¾‹å¦‚é˜¿é‡Œäº‘OSSï¼Œè…¾è®¯äº‘çš„COSã€‚</li>\n</ol><p>æ— è®ºç”¨å“ªä¸€ç§æ–¹æ³•éƒ¨ç½²Javascriptæ–‡ä»¶ï¼Œæˆ‘ä»¬çš„ç›®çš„éƒ½æ˜¯ç¡®ä¿å‰ç«¯é¡µé¢èƒ½ç¨³å®šåœ°åŠ è½½JSæ–‡ä»¶ï¼Œä»è€Œä¿è¯å…¨é“¾è·¯ç›‘æ§æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><h2>å¦‚ä½•è·å–ç½‘é¡µæŒ‡æ ‡</h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Web Vitalsåº“ä»¥åŠæ€ä¹ˆè·å–ç½‘é¡µæŒ‡æ ‡ã€‚</p><p>æˆ‘ä»¬ä»¥NPMå¯¼å…¥ä½œä¸ºä¾‹å­ï¼Œçœ‹ä¸‹æ€ä¹ˆåœ¨Vueé¡¹ç›®é‡Œä½¿ç”¨å®ƒã€‚ä¸‹é¢æ˜¯ç®€å•çš„ä»£ç ç¤ºä¾‹ã€‚</p><pre><code class=\"language-xml\">&lt;!-- Vue Project --&gt;\n&lt;!-- web-vitals.vue --&gt;\n&lt;template&gt;\n&lt;!-- åœ¨è¿™é‡Œä¸å±•ç¤ºå†…å®¹ --&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nimport { onLCP } from \"web-vitals\";\nexport default {\n&nbsp; mounted(){\n&nbsp; &nbsp; onLCP(console.log);&nbsp;&nbsp;\n&nbsp; }\n};\n&lt;/script&gt;\n&lt;style&gt;\n&lt;/style&gt;\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯é€šè¿‡importå¼•å…¥onLCPçš„æ–¹æ³•ï¼Œå¹¶åœ¨mountedç”Ÿå‘½å‘¨æœŸå†…è°ƒç”¨ã€‚ç”±äºonLCPæ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ˜¯é€šè¿‡å‚æ•°å›è°ƒçš„ï¼Œæ‰€ä»¥è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šé˜»å¡mountedäº‹ä»¶ã€‚</p><p>åŒç†ï¼ŒReacté¡¹ç›®ä¹Ÿå¯ä»¥é€šè¿‡importå¼•å…¥Web Vitalsï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç ã€‚</p><pre><code class=\"language-javascript\">// React Project\n// app.js\nimport { useEffect } from 'react';\nimport { onFCP } from \"web-vitals\";\n\nfunction App() {\n\n&nbsp; const onVital = (vital) =&gt; {\n&nbsp; &nbsp; console.log(vital);\n&nbsp; }\n\n&nbsp; useEffect(() =&gt; {\n    onFCP(onVital);\n  }, [])\n\n&nbsp; return (\n&nbsp; &nbsp; &lt;div className=\"App\"&gt;\n&nbsp; &nbsp; &lt;/div&gt;\n&nbsp; );\n}\n\nexport default App;\n</code></pre><p>è¿™é‡Œéå¸¸ç®€å•ï¼Œåªéœ€é€šè¿‡importå¯¼å‡ºonLCPæ–¹æ³•ï¼Œç„¶åè°ƒç”¨å®ƒï¼Œå°±å¯ä»¥è·å–åˆ°LCPç½‘é¡µæŒ‡æ ‡æ•°æ®äº†ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç é‡Œï¼Œæˆ‘ä»¬åªä»‹ç»äº†å¦‚ä½•ä½¿ç”¨onFCPå‡½æ•°ã€‚Web Vitalsåº“ä¸€å…±æ”¯æŒè·å–6ç§ç½‘é¡µæŒ‡æ ‡çš„æ–¹æ³•ï¼Œå…¶ä½™5ç§æ–¹æ³•åˆ†åˆ«æ˜¯onCLSã€onFIDã€onINPã€onLCPå’ŒonTTFBã€‚Web Vitalsåº“åœ¨è®¾è®¡æ—¶è€ƒè™‘åˆ°è‡ªå·±æä¾›çš„åŠŸèƒ½ï¼Œä¸ºæ¯ä¸ªæŒ‡æ ‡åˆ†åˆ«æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨è¿™äº›æ–¹æ³•å°±å¯ä»¥è®¡ç®—å‡ºæ¯ä¸ªæŒ‡æ ‡çš„æ•°æ®äº†ã€‚</p><p>æˆ‘ä»¬å†è®¨è®ºä¸‹è¿™ä¸ªonXXXæ–¹æ³•ã€‚å®ƒæä¾›äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å›è°ƒå‡½æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯æŒ‡æ ‡æŠ¥å‘Šå‚æ•°ã€‚å‚è€ƒä¸‹é¢ä»£ç çš„ç±»å‹ç»“æ„å®šä¹‰ã€‚</p><pre><code class=\"language-typescript\">// onCls Function Type\ntype onCLS = (callback: CLSReportCallback, opts?: ReportOpts) =&gt; void;\n\n// onFCP Function Type\ntype onFCP = (callback: FCPReportCallback, opts?: ReportOpts) =&gt; void;\n\n// onFID Function Type\ntype onFID = (callback: FIDReportCallback, opts?: ReportOpts) =&gt; void;\n\n// onINP Function Type\ntype onINP = (callback: INPReportCallback, opts?: ReportOpts) =&gt; void;\n\n// onLCP Function Type\ntype onLCP = (callback: LCPReportCallback, opts?: ReportOpts) =&gt; void;\n\n// onTTFB Function Type\ntype onTTFB = (callback: TTFBReportCallback, opts?: ReportOpts) =&gt; void;\n</code></pre><p>ç”±äºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥console.logï¼Œä¹Ÿå¯ä»¥ä¼ å…¥è‡ªå®šä¹‰çš„å‡½æ•°ã€‚è€ŒonXXXå‡½æ•°åœ¨è®¡ç®—å‡ºç½‘é¡µæŒ‡æ ‡å€¼åï¼Œä¼šæŠŠæ•°æ®ä¼ å…¥è¿™ä¸ªå›è°ƒå‡½æ•°ï¼Œæä¾›ç»™å¤–å±‚ä¸šåŠ¡ä½¿ç”¨ã€‚</p><p>è‡³äºç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯å¯é€‰çš„ï¼Œå‚æ•°ç±»å‹æ˜¯ReportOptsã€‚å®ƒæä¾›äº†ä¸¤ä¸ªå‚æ•°å±æ€§ã€‚</p><ul>\n<li><code>reportAllChanges</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ç±»å‹å‚æ•°ï¼Œç”¨äºè®¾ç½®å½“åˆå§‹å€¼æˆ–é¡µé¢ç”Ÿå‘½å‘¨æœŸå†…å‘ç”Ÿå˜æ›´æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚</li>\n<li><code>durationThreshold</code>ï¼šè¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯è°ƒæ•´æŒ‡æ ‡æŠ¥å‘Šçš„é˜ˆå€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæœ‰ä¸€ä¸ªé»˜è®¤é˜ˆå€¼ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªå‚æ•°æ¥è°ƒæ•´æŒ‡æ ‡é˜ˆå€¼ã€‚</li>\n</ul><h2>å¦‚ä½•é›†æˆåˆ°å…¬å…±å…¨é“¾è·¯æ•°æ®æŒ‡æ ‡ï¼Ÿ</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å­¦ä¼šäº†ä½¿ç”¨Web Vitalsè·å–ç½‘é¡µæŒ‡æ ‡çš„æ–¹æ³•ï¼Œä½†è¿™éœ€è¦é€šè¿‡ç¼–å†™ä»£ç æ¥å®ç°é¡µé¢æŒ‡æ ‡çš„è®¡ç®—å’Œè¯»å–ã€‚é‚£æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•å¯ä»¥è‡ªåŠ¨æ”¶é›†å¹¶å­˜å‚¨åˆ°æˆ‘ä»¬è®¾è®¡çš„æ•°æ®æŒ‡æ ‡é‡Œå‘¢ï¼Ÿ</p><p>è¿˜è®°å¾—æˆ‘ä»¬åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­å­¦ä¹ è®¾è®¡æ•°æ®æŒ‡æ ‡æ—¶ï¼Œä¸“é—¨è®¾è®¡äº†ä¸€ä¸ªæ€§èƒ½å­—æ®µperfæ¥å­˜å‚¨ç½‘é¡µæŒ‡æ ‡å—ï¼Ÿ</p><p>æœ€å°‘å­—æ®µåŸåˆ™æ˜¯å…¨é“¾è·¯æ•°æ®æŒ‡æ ‡çš„è®¾è®¡åŸåˆ™ï¼Œè®¾è®¡perfå­—æ®µçš„ä¸»è¦ç›®çš„å°±æ˜¯é€šè¿‡ç½‘é¡µæŒ‡æ ‡å€¼æ¥æå‰å‘ç°æ€§èƒ½é—®é¢˜ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è®°å½•æ¯ä¸ªç½‘é¡µæŒ‡æ ‡çš„ä¸¤ä¸ªæ•°æ®ï¼Œå°±æ˜¯æŒ‡æ ‡å€¼å’ŒæŒ‡æ ‡è¡¡é‡å€¼ï¼Œè¿™æ ·å°±å¯ä»¥çŸ¥é“é¡µé¢çš„æ€§èƒ½çŠ¶å†µäº†ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•å®ç°Web Vitalså’Œå…¨é“¾è·¯æŒ‡æ ‡çš„æ•´åˆå‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥å®ç°onXXXçš„å›è°ƒå‡½æ•°ï¼Œé€šè¿‡å›è°ƒå‡½æ•°è·å–åˆ°æŒ‡æ ‡å€¼ï¼Œä»£ç å‚è€ƒå¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/typings/typing.d.ts\ntype TracePerfRating = 'good' | 'needs improvement' | 'poor'\n\ntype TracePerf = {\n&nbsp; &nbsp; id: string\n&nbsp; &nbsp; LCP?: number\n&nbsp; &nbsp; LCPRating?: TracePerfRating\n&nbsp; &nbsp; FID?: number\n&nbsp; &nbsp; FIDRating?: TracePerfRating\n&nbsp; &nbsp; FCP?: number\n&nbsp; &nbsp; FCPRating?: TracePerfRating\n&nbsp; &nbsp; TTFB?: number\n&nbsp; &nbsp; TTFBRating?: TracePerfRating\n&nbsp; &nbsp; CLS?: number\n&nbsp; &nbsp; CLSRating?: TracePerfRating\n&nbsp; &nbsp; INP?: number\n&nbsp; &nbsp; INPRating?: TracePerfRating\n}\n\n// src/baseTrace.ts\nexport class BaseTrace implements BaseTraceInterface {\n\n\t// æ€§èƒ½æ—¥å¿—æ•°æ®\n&nbsp; public perfData: TracePerf = {\n&nbsp; &nbsp; id: ''\n&nbsp; }\n&nbsp;&nbsp;\n\tcreatePerfReport() {\n\t&nbsp; const report = (metric) =&gt; {\n\t&nbsp; &nbsp; this.perfData = { ...this.perfData, ...mapMetric(metric) };\n\t&nbsp; };\n\t&nbsp; return report\n\t}\n}\n</code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨BaseTraceç±»ä¸­å®šä¹‰äº†perfDataå…¬å…±å±æ€§ï¼Œç”¨äºå­˜å‚¨å½“å‰é¡µé¢çš„ç½‘é¡µæŒ‡æ ‡æ•°æ®ã€‚</p><p>æ­¤å¤–ï¼ŒBaseTraceç±»æ–°å¢äº†createPerfReportå‡½æ•°ï¼Œå¹¶è¿”å›äº†ä¸€ä¸ªåä¸ºreportçš„å†…éƒ¨å‡½æ•°ã€‚reportå‡½æ•°æ˜¯æä¾›ç»™onXXXçš„å›è°ƒå‡½æ•°ï¼Œç”¨æ¥è·å–æŒ‡æ ‡å€¼çš„ã€‚</p><p>æˆ‘ä»¬è¿˜çœ‹åˆ°äº†mapMetricå‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡è·å–åˆ°çš„æŒ‡æ ‡æ•°æ®ï¼Œé‡æ–°æ„é€ å‡ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼ŒåŒæ—¶è¿”å›ç»™perfDataã€‚</p><p>ä»¥ä¸‹æ˜¯mapMetricå‡½æ•°çš„å®ç°ä»£ç å‚è€ƒã€‚</p><pre><code class=\"language-typescript\">// src/core/webvitals.ts\n\nexport function mapMetric(metric) {\n&nbsp; const isWebVital = ['FCP', 'TTFB', 'LCP', 'CLS', 'FID'].indexOf(metric.name) !== -1;\n&nbsp; return {\n&nbsp; &nbsp; [metric.name]: isWebVital ? round(metric.value, metric.name === 'CLS' ? 4 : 0) : metric.value,\n&nbsp; &nbsp; [`${metric.name}Rating`]: metric.rating\n&nbsp; }\n};\n</code></pre><p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨ç›‘å¬ç½‘é¡µæŒ‡æ ‡çš„è®¡ç®—ç»“æœäº†ã€‚</p><p>å…·ä½“çš„å®ç°æ–¹æ³•åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯å®ç°æ–°å‡½æ•°onVitalsï¼Œå¹¶è°ƒç”¨6ä¸ªæŒ‡æ ‡æ–¹æ³•ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯åœ¨åˆå§‹åŒ–SDKæ—¶ï¼Œæ‰§è¡ŒonVitalså‡½æ•°ã€‚</p><pre><code class=\"language-typescript\">// src/core/webvitals.ts\nexport const onVitals = (saveMetric) =&gt; {\n&nbsp; onLCP(saveMetric)\n&nbsp; onFID(saveMetric)\n&nbsp; onCLS(saveMetric)\n&nbsp; onTTFB(saveMetric)\n&nbsp; onINP(saveMetric)\n&nbsp; onFCP(saveMetric)\n}\n</code></pre><p>ç¬¬äºŒéƒ¨åˆ†æ˜¯å¢åŠ é“¾è·¯SDKçš„åˆå§‹åŒ–ä»¥åŠæ‰§è¡ŒonVitalsï¼Œä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-typescript\">// src/baseTrace.ts\nimport {&nbsp;onVitals } from './core/webvitals';\n\nexport class BaseTrace implements BaseTraceInterface {\n\t// åˆå§‹åŒ–å®ä¾‹\n&nbsp; public static init(options: TraceOptions): BaseTrace {\n&nbsp; &nbsp; const traceSdk = new BaseTrace(options)\n\n&nbsp; &nbsp; // ç›‘å¬é¡µé¢æ€§èƒ½\n&nbsp; &nbsp; onVitals(traceSdk.createPerfReport())\n\n&nbsp; &nbsp; window.traceSdk = traceSdk\n&nbsp; &nbsp; return traceSdk\n&nbsp; }\n}\n</code></pre><p>æ¯æ¬¡é¡µé¢åŠ è½½åï¼Œåªéœ€æ‰§è¡ŒBaseTrace.initæ–¹æ³•ï¼Œå°±èƒ½å¤Ÿåˆå§‹åŒ–ç›‘å¬6ä¸ªç½‘é¡µæŒ‡æ ‡æƒ…å†µäº†ï¼Œç„¶åæ ¹æ®è®¡ç®—å‡ºæ¥çš„æŒ‡æ ‡å€¼å›è°ƒç»™BaseTraceçš„å†…éƒ¨å‡½æ•°ï¼Œå¹¶å°†éœ€è¦è®°å½•çš„æŒ‡æ ‡å€¼å­˜å‚¨èµ·æ¥å°±å¥½äº†ã€‚</p><p>é€šè¿‡ä»¥ä¸Šçš„å®ç°ï¼Œæˆ‘ä»¬æˆåŠŸæŠŠWeb Vitalsåº“æ•´åˆåˆ°äº†å‰ç«¯å…¨é“¾è·¯SDKçš„å®ç°é€»è¾‘é‡Œã€‚è™½ç„¶è¿™é‡Œçš„å®ç°åªæ˜¯ä»‹ç»äº†å­˜å‚¨ç½‘é¡µæŒ‡æ ‡çš„æ–¹æ³•ï¼Œä½†å¹¶æ²¡æœ‰æåˆ°ä½•æ—¶æŠ¥å‘Šæ•°æ®ä»¥åŠæ€ä¹ˆä¸ŠæŠ¥ã€‚å…³äºè¿™éƒ¨åˆ†çš„å†…å®¹ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„è¯¾ç¨‹ä¸­è¯¦ç»†å­¦ä¹ ã€‚</p><h2><strong>Web Vitalsåº“çš„å±€é™æ€§</strong></h2><p>æœ€åï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆWeb Vitalså®˜æ–¹JSåº“çš„å±€é™æ€§ã€‚å®ƒçš„ç‰ˆæœ¬ç›®å‰è¿˜åœ¨ä¸æ–­æ›´æ–°è¿­ä»£ã€‚å› æ­¤ï¼Œæ— è®ºæ˜¯æŒ‡æ ‡çš„è®¡ç®—å…¬å¼ã€è¿˜æ˜¯æŒ‡æ ‡çš„è¡¡é‡æ ‡å‡†ï¼Œåœ¨æœªæ¥éƒ½æœ‰å¯èƒ½å˜åŒ–ã€‚</p><p>å¦å¤–ï¼Œç”±äºå¸‚åœºä¸Šæµè§ˆå™¨çš„å·®å¼‚æ€§ï¼Œä¾‹å¦‚Googleã€å¾®è½¯ã€Appleéƒ½æœ‰å„è‡ªä¸åŒçš„æµè§ˆå™¨å†…æ ¸ï¼Œå¯¹äºWeb Vitalsçš„æ”¯æŒä¹Ÿå­˜åœ¨è¾ƒå¤§å·®å¼‚ã€‚æ‰€ä»¥ï¼ŒWeb Vitalsåº“æä¾›çš„æ‰€æœ‰æŒ‡æ ‡ï¼Œå¹¶ä¸æ˜¯åœ¨æ¯ä¸ªæµè§ˆå™¨ç¯å¢ƒä¸‹éƒ½æ”¯æŒçš„ã€‚</p><p>åŸºäºChromuimï¼ˆGoogleçš„å¼€æºå†…æ ¸ï¼‰å†…æ ¸çš„æµè§ˆå™¨ï¼Œä¾‹å¦‚è°·æ­ŒChromeï¼Œå®ƒå¯¹Web Vitalsçš„æ”¯æŒæ›´åŠ å®Œå–„ã€‚å…¶ä½™ç±»ä¼¼Firefoxæˆ–Safariï¼Œåˆ™è¦æ ¹æ®ç”¨æˆ·ä½¿ç”¨çš„ç‰ˆæœ¬æ‰èƒ½åˆ¤æ–­æ˜¯å¦æ”¯æŒWeb Vitalsã€‚å¯¹äºè¿™ä¸€ç‚¹çš„å·®å¼‚ï¼Œå‰ç«¯å¼€å‘è€…éœ€è¦å…³æ³¨æµè§ˆå™¨çš„å…¼å®¹é—®é¢˜ã€‚</p><p>è€ŒåŸºäºç§»åŠ¨ç«¯åº”ç”¨çš„å‰ç«¯ç½‘é¡µï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å®‰å“ç³»ç»Ÿï¼Œè€Œä¸”å®ƒçš„æµè§ˆå™¨å†…æ ¸ä¹Ÿæ˜¯åŸºäºChromuimçš„æ¶æ„ã€‚æ‰€ä»¥ï¼Œåœ¨ä¸šåŠ¡ä¸Šå¯¹äºæˆ‘ä»¬ä½¿ç”¨Web Vitalsåº“æ¥è¯´ï¼Œæ”¶é›†ç”¨æˆ·ä½“éªŒæŒ‡æ ‡æ•°æ®çš„å½±å“ä¸å¤§ã€‚</p><p>æˆ‘è®¤ä¸ºï¼Œä¸ç®¡æµè§ˆå™¨çš„å·®å¼‚æ€§å¦‚ä½•ï¼Œæˆ‘ä»¬çš„ç”¨æˆ·é€šå¸¸éƒ½æ˜¯æ¥è‡ªä¸åŒè®¾å¤‡ä¸Šçš„æµè§ˆå™¨ï¼Œè‚¯å®šè‡³å°‘æœ‰ä¸€æ¬¾æµè§ˆå™¨èƒ½æ”¯æŒWeb Vitalsçš„ç‰¹æ€§ã€‚å¯¹äºå‰ç«¯åŒå­¦æ¥è¯´ï¼Œåªè¦èƒ½æ•è·åˆ°è¿™äº›æ•°æ®ï¼Œæ— è®ºæ”¶é›†æ•°æ®çš„æ¯”ä¾‹å¦‚ä½•ï¼Œåªè¦èƒ½å‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜ï¼Œè¿™äº›éƒ½ä¸æ˜¯é—®é¢˜ã€‚</p><p>åˆ†äº«ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ç ”å‘æ²Ÿé€šè¯æœ¯ï¼Œç ”å‘æ¥æ”¶åˆ°ä¸€äº›ç”¨æˆ·åé¦ˆé—®é¢˜çš„æ—¶å€™ï¼Œéƒ½ä¼šæŠ›å‡ºè¿™ç±»è¯æœ¯ï¼šè¿™ä¸ªç”¨æˆ·çš„é—®é¢˜æ˜¯æ€ä¹ˆé‡ç°çš„ï¼Ÿéº»çƒ¦æä¾›ä¸€ä¸‹é‡ç°è·¯å¾„ï¼Ÿæˆ‘åœ¨åå°çœ‹ä¸‹æ•°æ®æ˜¯å¦å¯ä»¥æ‰¾åˆ°Bugï¼Ÿ</p><p>å› æ­¤ï¼Œåªè¦æœ‰æ•°æ®ï¼Œæœ‰é‡ç°è·¯å¾„ï¼Œè§£å†³é—®é¢˜æ— éœ€1å¤©æˆ–3å¤©ï¼ŒåŠåˆ†é’Ÿå°±èƒ½é‡ç°é—®é¢˜ï¼Œ5åˆ†é’Ÿå†…è§£å†³ã€‚</p><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†æŠŠWeb Vitalsé›†æˆåˆ°å‰ç«¯å…¨é“¾è·¯çš„æ–¹æ³•ã€‚</p><p>æˆ‘é€‰ç”¨çš„æ˜¯Vueå’ŒReactè¿™ä¸¤ä¸ªæŠ€æœ¯æ ˆï¼Œé€šè¿‡NPMçš„æ–¹å¼å¼•å…¥Web Vitalsçš„å‡½æ•°ã€‚å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬é‡åˆ°ä½¿ç”¨æ—§æŠ€æœ¯æ ˆçš„å‰ç«¯é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨scriptå¼•å…¥é“¾æ¥çš„æ–¹å¼ä½¿ç”¨Web Vitalsã€‚</p><p>å¼•å…¥Web Vitalsåï¼Œæˆ‘ä»¬æœ‰6ç§onXXXæ–¹æ³•è·å–åˆ°ç½‘é¡µæŒ‡æ ‡å€¼ï¼Œä¾‹å¦‚è·å–FCPæŒ‡æ ‡å€¼çš„onFCPæ–¹æ³•ï¼Œè¿˜æœ‰onCLSã€onFIDç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬è¿˜å®Œæˆäº†å°†Web Vitalsåº“å’Œå…¨é“¾è·¯æŒ‡æ ‡æ•´åˆçš„å®ç°æ–¹æ¡ˆã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦å®šä¹‰ä¸€ä¸ªå­˜å‚¨å½“å‰é¡µé¢ç½‘é¡µæŒ‡æ ‡æ•°æ®çš„å±æ€§perfDataï¼Œæ¥ç€ï¼Œå®ç°ä¸€ä¸ªå›è°ƒå‡½æ•°reportï¼Œç”¨æ¥è·å–æŒ‡æ ‡å€¼ã€‚åŒæ—¶ï¼Œè¿˜éœ€è¦è®¾è®¡ä¸€ä¸ªå‡½æ•°mapMetricæ¥å¤„ç†è·å–åˆ°çš„æŒ‡æ ‡æ•°æ®ï¼Œå¹¶è¿”å›ç»™éœ€è¦è®°å½•çš„æŒ‡æ ‡å€¼ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬ä¹Ÿè®¨è®ºäº†Web Vitalsçš„å±€é™æ€§ï¼ŒåŒ…æ‹¬æœªæ¥å¯èƒ½å‘ç”Ÿçš„å˜åŒ–ä»¥åŠæµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚å°½ç®¡Web Vitalsåœ¨è®¡ç®—å…¬å¼ã€è¡¡é‡æ ‡å‡†ã€æµè§ˆå™¨å…¼å®¹é—®é¢˜ä»¥åŠæœªæ¥çš„å˜åŒ–éƒ½å­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œä½†æ˜¯è¿™äº›å¹¶ä¸å¦¨ç¢æˆ‘ä»¬é€šè¿‡å®ƒå‘ç°ç½‘é¡µæ€§èƒ½é—®é¢˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä»Šå¤©æˆ‘ä»‹ç»äº†å°†Web Vitalsåº“æ•´åˆåˆ°å‰ç«¯å…¨é“¾è·¯çš„å…¨è¿‡ç¨‹ï¼Œä½†å¹¶æ²¡æœ‰æåŠä½•æ—¶æŠ¥å‘Šæ•°æ®ä»¥åŠæ€ä¹ˆä¸ŠæŠ¥ã€‚ç°åœ¨ï¼Œæˆ‘ç»™ä½ ä¸€ä¸ªå°å°çš„æ€è€ƒé¢˜ï¼Œä½ è§‰å¾—æœ‰äº†ç½‘é¡µæŒ‡æ ‡åï¼Œåº”è¯¥åœ¨ä»€ä¹ˆæ—¶æœºä¸ŠæŠ¥è¿™äº›æ•°æ®å‘¢ï¼Ÿ</p><p>å…³äºåœ¨ä½¿ç”¨Web Vitalsè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œå»ºè®®ï¼Œéå¸¸æ¬¢è¿å’Œæˆ‘äº¤æµï¼Œä¸€èµ·å…±åŒè¿›æ­¥å’Œæˆé•¿ã€‚æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµã€‚å¦‚æœè§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿå¯ä»¥æŠŠè¯¾ç¨‹åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·å­¦ä¹ ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"07ï½œç½‘é¡µæŒ‡æ ‡ï¼šä¸ºä½•è¦ç”¨WebVitalsåˆ†æWebåº”ç”¨çš„ç”¨æˆ·ä½“éªŒï¼Ÿ","id":770674},"right":{"article_title":"09ï½œæ¥å£æŒ‡æ ‡ï¼šç›‘å¬æ¥å£çŠ¶æ€ï¼Œæ”¶é›†é¡µé¢æ¥å£å¼‚å¸¸æ•°æ®","id":771719}},"comments":[{"had_liked":false,"id":392575,"user_name":"è‹æœæœ","can_delete":false,"product_type":"c1","uid":2852467,"ip_address":"åŒ—äº¬","ucode":"12A62ED032F345","user_header":"https://static001.geekbang.org/account/avatar/00/2b/86/73/5190bbde.jpg","comment_is_top":true,"comment_ctime":1721270720,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"å®Œæ•´æºç å…¥å£ï¼š\nhttps:&#47;&#47;github.com&#47;sankyutang&#47;fontend-trace-geekbang-course","like_count":0},{"had_liked":false,"id":390571,"user_name":"blue","can_delete":false,"product_type":"c1","uid":1447292,"ip_address":"å¹¿ä¸œ","ucode":"BC183E857A0B8D","user_header":"https://static001.geekbang.org/account/avatar/00/16/15/7c/cfaaf421.jpg","comment_is_top":false,"comment_ctime":1715674968,"is_pvip":false,"replies":[{"id":142832,"content":"å•é¡µé¢çš„è·¯ç”±åˆ‡æ¢ï¼Œéœ€è¦æ‰‹åŠ¨å°è£…ä¸€ä¸‹ï¼Œè€Œä¸”ï¼ŒTTFBå’ŒFCPåªæœ‰é¡µé¢åˆ·æ–°æ‰èƒ½è·å–åˆ°æŒ‡æ ‡å€¼ï¼Œè·¯ç”±åˆ‡æ¢èƒ½æ‹¿åˆ°CLSã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1327155,"ctime":1723431322,"ip_address":"å¹¿ä¸œ","comment_id":390571,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"ä¸‰æ¡¥è€å¸ˆï¼Œè¿™äº›æ€§èƒ½æŒ‡æ ‡ï¼Œåªæœ‰åœ¨é¡µé¢åˆ·æ–°çš„æ—¶å€™æ‰èƒ½è°ƒç”¨web-vitalså›è°ƒï¼Œé‚£ä¹ˆå•é¡µåº”ç”¨çš„åˆ‡æ¢æ€ä¹ˆç›‘å¬æ¯ä¸ªé¡µé¢çš„æ€§èƒ½æŒ‡æ ‡ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1327155,"avatar":"https://static001.geekbang.org/account/avatar/00/14/40/33/11e434ba.jpg","nickname":"ä¸‰æ©‹sankyu ğŸ©","note":"","ucode":"2129405EA8D3D7","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649458,"discussion_content":"å•é¡µé¢çš„è·¯ç”±åˆ‡æ¢ï¼Œéœ€è¦æ‰‹åŠ¨å°è£…ä¸€ä¸‹ï¼Œè€Œä¸”ï¼ŒTTFBå’ŒFCPåªæœ‰é¡µé¢åˆ·æ–°æ‰èƒ½è·å–åˆ°æŒ‡æ ‡å€¼ï¼Œè·¯ç”±åˆ‡æ¢èƒ½æ‹¿åˆ°CLSã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723431322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390311,"user_name":"westfall","can_delete":false,"product_type":"c1","uid":1632773,"ip_address":"ä¸Šæµ·","ucode":"F3F5CB7DF695FC","user_header":"https://static001.geekbang.org/account/avatar/00/18/ea/05/9976b871.jpg","comment_is_top":false,"comment_ctime":1715064625,"is_pvip":false,"replies":[{"id":142066,"content":"ä¼šè¯¦ç»†è®²è§£çš„ã€‚å¯ä»¥ä»20å¼€å§‹å…³æ³¨è¿™éƒ¨åˆ†è¯¾ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1327155,"ctime":1715699405,"ip_address":"å¹¿ä¸œ","comment_id":390311,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"Helloï¼Œä¸‰æ¡¥è€å¸ˆï¼Œæˆ‘æ„Ÿè§‰å¼€å‘è€…æ›´å…³å¿ƒçš„åº”è¯¥æ˜¯å¦‚ä½•é€šè¿‡ web-vitals çš„æ•°æ®åˆ†æå’Œè§£å†³æ€§èƒ½é—®é¢˜ï¼Œåé¢ä¼šè¯¦ç»†è®²è§£å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1327155,"avatar":"https://static001.geekbang.org/account/avatar/00/14/40/33/11e434ba.jpg","nickname":"ä¸‰æ©‹sankyu ğŸ©","note":"","ucode":"2129405EA8D3D7","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645015,"discussion_content":"ä¼šè¯¦ç»†è®²è§£çš„ã€‚å¯ä»¥ä»20å¼€å§‹å…³æ³¨è¿™éƒ¨åˆ†è¯¾ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1715699405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392129,"user_name":"å°å°¤","can_delete":false,"product_type":"c1","uid":1607639,"ip_address":"åŒ—äº¬","ucode":"F26BA6D463E5B8","user_header":"https://static001.geekbang.org/account/avatar/00/18/87/d7/7202a499.jpg","comment_is_top":false,"comment_ctime":1720017628,"is_pvip":false,"replies":[{"id":142580,"content":"è¶³å¤Ÿã€‚FCPåŒ…å«äº†TTFBçš„é“¾è·¯ã€‚Safariä¸æ”¯æŒLCPï¼Œå¯ä»¥é€šè¿‡Chrome debugè§£å†³ã€‚\nLCPçš„é—®é¢˜ä¸»è¦æ˜¯èµ„æºåŠ è½½æ—¶é—´çš„ä¼˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1327155,"ctime":1720406206,"ip_address":"å¹¿ä¸œ","comment_id":392129,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100759401,"comment_content":"è€å¸ˆï¼Œ\nweb-vitals Safari åªæ”¯æŒ FCPå’ŒTTFBï¼Œå¯¹äºç§»åŠ¨ç«¯æ¥è¯´ï¼Œè¡¡é‡é¡µé¢é¦–å±æ¸²æŸ“æ˜¯å¦è¶³å¤Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1327155,"avatar":"https://static001.geekbang.org/account/avatar/00/14/40/33/11e434ba.jpg","nickname":"ä¸‰æ©‹sankyu ğŸ©","note":"","ucode":"2129405EA8D3D7","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647660,"discussion_content":"è¶³å¤Ÿã€‚FCPåŒ…å«äº†TTFBçš„é“¾è·¯ã€‚Safariä¸æ”¯æŒLCPï¼Œå¯ä»¥é€šè¿‡Chrome debugè§£å†³ã€‚\nLCPçš„é—®é¢˜ä¸»è¦æ˜¯èµ„æºåŠ è½½æ—¶é—´çš„ä¼˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720406206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}