{"id":88100,"title":"20 | Vuexæ ¸å¿ƒæ¦‚å¿µåŠåº•å±‚åŸç†","content":"<h1>æºä»£ç åŠè¯¾ä»¶åœ°å€</h1><p><a href=\"https://gitee.com/geektime-geekbang/geektime-vue-1\">https://gitee.com/geektime-geekbang/geektime-vue-1</a></p>","comments":[{"had_liked":false,"id":92330,"user_name":"Starry starry night","can_delete":false,"product_type":"c3","uid":1520539,"ip_address":"","ucode":"8DCEAF095FEC84","user_header":"https://static001.geekbang.org/account/avatar/00/17/33/9b/683f9c2a.jpg","comment_is_top":false,"comment_ctime":1557233928,"is_pvip":false,"replies":[{"id":33201,"content":"æˆ‘æƒ³è¿™æ ·æ•ˆæœä¼šæ›´å¥½ä¸€äº› æ„Ÿè°¢æ”¯æŒ","user_name":"ä½œè€…å›å¤","user_name_real":"å”","uid":1316874,"ctime":1557409908,"ip_address":"","comment_id":92330,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"è¿™å¥—è§†é¢‘å¯¹äºæ–°æ‰‹æ¥è¯´è·³è·ƒæ€§å¾ˆå¼ºï¼š\n                          1ï¼Œå¾ˆé€‚åˆå»æ ¹æ®è§†é¢‘ä¸­çš„çŸ¥è¯†ç‚¹å»è‡ªä¸»å­¦ä¹ ï¼Œè€Œä¸”è¿™æ ·å°è±¡æ‰ä¼šæ›´æ·±ã€‚                     \n                          2ï¼Œè§†é¢‘ä¸­å‡ºç°äº†å¾ˆå¤šå®é™…å·¥ç¨‹ä¸­å‡ºç°çš„é—®é¢˜ï¼Œå¹¶ç»™å‡ºäº†è§£å†³å·¥å…·ä¸è§£å†³æ–¹æ³•ã€‚\n                          3ï¼Œæœ€åå°±æ˜¯è€å¸ˆå¾ˆç§¯æçš„åœ¨åšå¥½æœ¬æ¬¡è¯¾ç¨‹ï¼Œä¼šåŠæ—¶ç»™ç•™è¨€åŒºç•™ä¸‹å›å¤ã€‚","like_count":5,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"å”é‡‘å·","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449217,"discussion_content":"æˆ‘æƒ³è¿™æ ·æ•ˆæœä¼šæ›´å¥½ä¸€äº› æ„Ÿè°¢æ”¯æŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557409908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1736720,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/80/10/2406a662.jpg","nickname":"å¸Œè¨€è‡ªç„¶","note":"","ucode":"8D99A82B05636B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":233675,"discussion_content":"è€å¸ˆæˆ‘çš„å›å¤å¾ˆç§¯æï¼Œä½†æ˜¯ä½ éƒ½æ²¡é¸Ÿæˆ‘ï¼Œæˆ‘çŸ¥é“å¾ˆå¤šé—®é¢˜å¾ˆç™½ç—´ï¼Œæˆ‘ä¼šæ…¢æ…¢åˆ é™¤çš„ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586938127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84637,"user_name":"èµ¤éœ„","can_delete":false,"product_type":"c3","uid":1464282,"ip_address":"","ucode":"892A7FDF9C9367","user_header":"https://static001.geekbang.org/account/avatar/00/16/57/da/4bfdbcb9.jpg","comment_is_top":false,"comment_ctime":1554888336,"is_pvip":false,"replies":[{"id":30446,"content":"æ˜¯$$state  è¿™ä¸ªåç§°æ˜¯è‡ªå·±åœ¨ dataä¸­è‡ªå·±å®šä¹‰çš„ å¯ä»¥ä»»æ„èµ·åå­—ï¼Œå½“ç„¶ä¸èƒ½å’Œvueä¿ç•™å­—å†²çª","user_name":"ä½œè€…å›å¤","user_name_real":"å”","uid":1316874,"ctime":1554896974,"ip_address":"","comment_id":84637,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"getå‡½æ•°ä¸‹é¢ return this._vm.data.$stateå§  çœ‹è€å¸ˆå†™æˆäº†  return this._vm.data.$$state","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"å”é‡‘å·","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446409,"discussion_content":"æ˜¯$$state  è¿™ä¸ªåç§°æ˜¯è‡ªå·±åœ¨ dataä¸­è‡ªå·±å®šä¹‰çš„ å¯ä»¥ä»»æ„èµ·åå­—ï¼Œå½“ç„¶ä¸èƒ½å’Œvueä¿ç•™å­—å†²çª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554896974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81084,"user_name":"ğŸ˜¶","can_delete":false,"product_type":"c3","uid":1391986,"ip_address":"","ucode":"1833882A000EFE","user_header":"https://static001.geekbang.org/account/avatar/00/15/3d/72/51ba3684.jpg","comment_is_top":false,"comment_ctime":1553810984,"is_pvip":false,"replies":[{"id":29471,"content":"ä¸­åå°ç®¡ç†ç³»ç»Ÿ  å¯ä»¥æœç´¢ä¸‹ ant-design-pro å·²ç»æœ‰reactç‰ˆçš„äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å”","uid":1316874,"ctime":1553847301,"ip_address":"","comment_id":81084,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"è€å¸ˆæœ€åä¸ªé¡¹ç›®æ˜¯ä»€ä¹ˆé¡¹ç›®ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"å”é‡‘å·","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445074,"discussion_content":"ä¸­åå°ç®¡ç†ç³»ç»Ÿ  å¯ä»¥æœç´¢ä¸‹ ant-design-pro å·²ç»æœ‰reactç‰ˆçš„äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553847301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207629,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6d/4d/ada0aa8a.jpg","nickname":"äºšä¸œ","note":"","ucode":"D76E7F593D6CBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":241762,"discussion_content":"è¿™ä¸ªæ˜¯vueè¯¾ç¨‹ï¼Œä¸ºä»€ä¹ˆè®²react?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587438676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91678,"user_name":"à¼ºæ²»æœ‹à¼»","can_delete":false,"product_type":"c3","uid":1379801,"ip_address":"","ucode":"6636FAB70BD566","user_header":"https://static001.geekbang.org/account/avatar/00/15/0d/d9/0a7d2f8f.jpg","comment_is_top":false,"comment_ctime":1557071598,"is_pvip":false,"replies":[{"id":35065,"content":"ä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½†å†…éƒ¨è¿˜æ˜¯æœ‰äº›å°é€»è¾‘çš„ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹çœ‹æºç ","user_name":"ä½œè€…å›å¤","user_name_real":"å”","uid":1316874,"ctime":1558879429,"ip_address":"","comment_id":91678,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"æ˜ç™½äº†,vuexè·Ÿvueè‡ªèº«çš„å®ä¾‹éƒ½æ˜¯ç‹¬ç«‹çš„å­˜åœ¨, åœ¨å¼•ç”¨vuexæ—¶å€™ æ˜¯ä¸æ˜¯åœ¨new Vueé‚£é‡ŒæŒ‚è½½åˆ°äº†,å½“å‰çš„vueå®ä¾‹ä¸Šè¾¹, æ‰€ä»¥åè¾¹ç”¨ this.$store ä¹‹ç±»çš„éƒ½èƒ½æ“ä½œå‘¢?","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"å”é‡‘å·","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448991,"discussion_content":"ä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½†å†…éƒ¨è¿˜æ˜¯æœ‰äº›å°é€»è¾‘çš„ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹çœ‹æºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558879429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":true,"id":210793,"user_name":"renderfan001","can_delete":false,"product_type":"c3","uid":1253485,"ip_address":"","ucode":"FB1A383E9DC256","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLX8ole5k6gIdCLibxtvDOAzvrQibIayjUsT852TOLl0NgYBIjD5X28Jkkb1j9S3s00rQUsIqQLe0JA/132","comment_is_top":false,"comment_ctime":1587825831,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"import Vue from &#39;vue&#39;;\nfunction Store(options={}) {\n    const{state = {}, mutations = {}, getters={}, actions={}} = options;    \n    this.vm = new Vue({\n        data:{\n            $$state: state\n        },\n    });\n    this.commit = function(type, payload) {\n        if(mutations[type]) {\n            mutations[type].call(this, state, payload);\n        }\n    }\n    this.dispatch = function(type, payload) {\n        if(actions[type]) {\n            let args = [state, payload];\n            actions[type].apply(null, args);\n        }\n    }\n    let thisGetters = {};\n    for(let p in getters) {\n        Object.defineProperty(thisGetters, p, {\n            get() { return getters[p](state);}\n        });\n    }\n    this.getters = thisGetters;\n    this.mutations = options.mutations;\n    this.state = state;\n}\nfunction init() {\n    let options = this.$options;\n    if(options.store) {\n        this.$store = options.store;\n    } else if(options.parent &amp;&amp; options.parent.$store) {\n        this.$store = options.parent.$store;\n    }\n}\nfunction install(Vue) {\n    Vue.mixin({beforeCreate: init});\n}\nexport default {\n    Store,\n    install\n}","like_count":14},{"had_liked":false,"id":81465,"user_name":"é›·æ©","can_delete":false,"product_type":"c3","uid":1469267,"ip_address":"","ucode":"D691F4E050AA99","user_header":"","comment_is_top":false,"comment_ctime":1553918603,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"è€å¸ˆï¼Œæä¸ªæ„è§ï¼Œæœ€å¥½èƒ½ç»“åˆä½ çš„ç»éªŒè®²ä¸‹æŠ€å·§ä¹‹ç±»çš„å†…å®¹ã€‚","like_count":13},{"had_liked":false,"id":133888,"user_name":"Geek_4e4ec2","can_delete":false,"product_type":"c3","uid":1603078,"ip_address":"","ucode":"6DAD5EE4FFB195","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/zAZv4NyuS21Y1qk45j8JiaoEYdA5Zgc1PqpJsBokz5bZVmdkf6kNWvT4cUAAKAdH6TgN52DWZhiaH6wNFhw14nRg/132","comment_is_top":false,"comment_ctime":1568691075,"is_pvip":false,"replies":null,"discussion_count":3,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"è€å¸ˆï¼Œstoreå‘éŸ³æ˜¯s duo ï¼Œreä¸å‘éŸ³ï¼Œä¸ç„¶è€æ˜¯è”æƒ³åˆ°story ^^","like_count":12,"discussions":[{"author":{"id":2686011,"avatar":"https://static001.geekbang.org/account/avatar/00/28/fc/3b/e4318cca.jpg","nickname":"é©¬æ™¶é‘«","note":"","ucode":"D12EA0AC700D2A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403897,"discussion_content":"ç¡®å® å¬ç€å¥½åˆ«æ‰­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634179941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1855159,"avatar":"","nickname":"Geek_84e1a5","note":"","ucode":"D24EA641D100EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263166,"discussion_content":"ç§€å„¿ä½ å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589181952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1498186,"avatar":"https://static001.geekbang.org/account/avatar/00/16/dc/4a/0f56e0ad.jpg","nickname":"LiKui","note":"","ucode":"7089F7F38D26A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1855159,"avatar":"","nickname":"Geek_84e1a5","note":"","ucode":"D24EA641D100EC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295561,"discussion_content":"ä½ ä¹Ÿå¾ˆç§€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596249813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":263166,"ip_address":"","group_id":0},"score":295561,"extra":""}]}]},{"had_liked":false,"id":90790,"user_name":"young","can_delete":false,"product_type":"c3","uid":1472571,"ip_address":"","ucode":"4B5285A404E637","user_header":"https://static001.geekbang.org/account/avatar/00/16/78/3b/19ef632a.jpg","comment_is_top":false,"comment_ctime":1556645188,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"è€å¸ˆï¼Œmin-vuex.jsä¸­ç”¨new Vue()åˆ›å»ºVueå®ä¾‹äº†ï¼Œ\nç„¶ååœ¨main.jsä¸­åˆç”¨new Vue()åˆ›å»ºVueå®ä¾‹äº†ï¼Œ\nVueæ˜¯å•æ€æ¨¡å¼å—ï¼Ÿè¿™ä¸¤æ¬¡åˆ›å»ºçš„Vueå®ä¾‹æ˜¯ä¸æ˜¯åŒä¸€ä¸ªVueå®ä¾‹å§ï¼Ÿå¦‚æœæ˜¯çš„è¯ä¸¤æ¬¡åˆ›å»ºVueå®ä¾‹æ—¶æ•°æ®ä¼šåˆå¹¶å—ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1684890,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJiaeTzf4V8ib4wibD5pbDY1GHBvUcfbof3fSxicW1HHiaqWhick7KFuwutZTA8AVUicgxDnTOUkDrlaTKag/132","nickname":"zh1164","note":"","ucode":"1B7B8BA25B50FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293192,"discussion_content":"ä¸æ˜¯ï¼Œå®ƒä»¬ä¸¤ä¸ªæ²¡æœ‰ä»»ä½•å…³ç³»å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595472618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89809,"user_name":"huanghui","can_delete":false,"product_type":"c3","uid":1464865,"ip_address":"","ucode":"AD2AC528E2C63A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ericUvFT5gl0eEJCjcMXub9d6Z8TPjZOibJCjIyibZKOlhsQWkgcSvOoA5S0Vn6z0B6BKv2zR8HvLArA/132","comment_is_top":false,"comment_ctime":1556269317,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"return this._vm._data.$$stateï¼Œä¸ºä»€ä¹ˆæ˜¯_dataï¼Œè€Œä¸æ˜¯data","like_count":4,"discussions":[{"author":{"id":1736720,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/80/10/2406a662.jpg","nickname":"å¸Œè¨€è‡ªç„¶","note":"","ucode":"8D99A82B05636B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":233853,"discussion_content":"$data = _dataï¼Œä½ å°±æ˜ç™½äº†\nä»¥ _ æˆ– $ å¼€å¤´çš„å±æ€§ä¸ä¼šè¢« Vue å®ä¾‹ä»£ç†ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å’Œ Vue å†…ç½®çš„å±æ€§ã€API æ–¹æ³•å†²çªã€‚\nconsole.log(this._vm._data === this._vm.$data);    // true æµ‹è¯•ä¸€ä¸‹åŠ æ·±å°è±¡","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586949184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1567745,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ec/01/7a2d7f84.jpg","nickname":"ãŸã ã®è¦³ã§ã™ã€‚","note":"","ucode":"D2EF872BEAF4C5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1204,"discussion_content":"å› ä¸ºVueçš„dataå¯¹å¤–ä¸æš´éœ²ï¼Œéœ€è¦ä½¿ç”¨_dataè¿›è¡Œè®¿é—®","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562401910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220424,"user_name":"èƒ–è¾¾","can_delete":false,"product_type":"c3","uid":1422517,"ip_address":"","ucode":"C930A33E1CEBCD","user_header":"https://static001.geekbang.org/account/avatar/00/15/b4/b5/b7ac4724.jpg","comment_is_top":false,"comment_ctime":1590240059,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"ä½œä¸šå¾ˆæœ‰æ·±åº¦.å¸®åŠ©æˆ‘ç†è§£äº†å¾ˆå¤šè§£æ„,æˆ‘ä¸ªäººç†è§£æŸ¥çœ‹æºä»£ç å¾—åˆ°çš„ä¿¡æ¯:\n1.getterså®é™…ä¸Šæ—¶ä¸€ä¸ªå†…éƒ¨å®ä¾‹vueçš„computed,æ‰€ä»¥åé¢ä½œä¸šæ˜¯è¦å®ç°gettersæŒ‚è½½å¯¹åº”å®ä¾‹çš„computed\n2.æ³¨å…¥$storeæ˜¯åœ¨storeä¸Š,æœ‰ä¸ªå¯¹åº”installçš„é’©å­å‡½æ•°.å®ç°çš„æŒ‚è½½\n","like_count":3},{"had_liked":false,"id":206877,"user_name":"å¸Œè¨€è‡ªç„¶","can_delete":false,"product_type":"c3","uid":1736720,"ip_address":"","ucode":"8D99A82B05636B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/80/10/2406a662.jpg","comment_is_top":false,"comment_ctime":1586949274,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"Store æ˜¯å¦‚ä½•åšåˆ°æˆ‘ä»¬çš„ä¸€ä¸ªå“åº”å¼çš„ï¼Ÿ\nå®é™…ä¸Šå®ƒè¿˜æ˜¯åˆ©ç”¨äº† Vueï¼Œæˆ‘ä»¬é€šè¿‡ `new Vue()` å‡½æ•°æ„å»ºäº†ä¸€ä¸ª Vue å®ä¾‹ï¼Œå¹¶å°† `state` å­˜æ”¾åœ¨äº†è¿™ä¸ªå®ä¾‹çš„é€‰é¡¹ data çš„ `$$state` å±æ€§é‡Œé¢ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„ `state` å·²ç»å˜æˆäº†ä¸€ä¸ªé—´æ¥çš„å“åº”å¼çš„æ•°æ®ã€‚\nObject.defineProperties(Store.prototype, {......})\nè¿™ä¸ªæ–¹æ³•ä¿®æ”¹ `Store` å¯¹è±¡ä¸Šçš„å±æ€§ `prototype`ï¼ˆå±æ€§ï¼‰ï¼Œä¿®æ”¹çš„å±æ€§æ˜¯ `state`ï¼Œä¿®æ”¹äº† `state` ä¸‹çš„ `get`ï¼ˆ`getter` å‡½æ•°ï¼‰ ï¼Œ`get` å‡½æ•°è¿”å›ä¸€ä¸ªç»“æœæ˜¯ `_vm` å®ä¾‹ä¸‹çš„é€‰é¡¹ `data` ä¸­çš„ `$$state` å±æ€§ï¼Œå…¶å®å°±æ˜¯ `Store` å¯¹è±¡ä¸‹çš„ `state` å¯¹è±¡ï¼Œåªä¸è¿‡ä» `_vm` å®ä¾‹ä¸­å–äº†ä¸€éï¼Œå°±ç¼–ç¨‹å“åº”å¼çš„äº†~","like_count":1},{"had_liked":false,"id":180904,"user_name":"å¤ä¸è§ç§‹","can_delete":false,"product_type":"c3","uid":1005105,"ip_address":"","ucode":"D1960FA9982D7F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/31/46103c86.jpg","comment_is_top":false,"comment_ctime":1582440401,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"ä¸€ä¸ªå¤´ä¸¤ä¸ªå¤§ï¼Œå¤ªå¤šä¸“ä¸šæ€§æœ¯è¯­ï¼Œå­¦æ¸£çš„æˆ‘è¦çœ‹å¥½å¤šéï¼Œè¿˜è¦æŠŠä¹‹å‰çš„è¿”å›æ¥çœ‹æ‰èƒ½å¤§è‡´ææ‡‚ã€‚","like_count":1},{"had_liked":false,"id":396276,"user_name":"Geek_330172","can_delete":false,"product_type":"c3","uid":4053101,"ip_address":"å±±ä¸œ","ucode":"1970B600457B9E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/R4xm4hCOtZR2wOOLnqISmdUHmgq9V2kevv6q5U4D0PEiasb48GdXuic8WYmmjR8fOE4QKh6f181WJY4axwTTib6Hg/132","comment_is_top":false,"comment_ctime":1733829348,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":3,"product_id":100024601,"comment_content":"const Vuex = {\n    Store,\n    install\n}\n\nexport default Vuex","like_count":0},{"had_liked":false,"id":396275,"user_name":"Geek_330172","can_delete":false,"product_type":"c3","uid":4053101,"ip_address":"å±±ä¸œ","ucode":"1970B600457B9E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/R4xm4hCOtZR2wOOLnqISmdUHmgq9V2kevv6q5U4D0PEiasb48GdXuic8WYmmjR8fOE4QKh6f181WJY4axwTTib6Hg/132","comment_is_top":false,"comment_ctime":1733829341,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":3,"product_id":100024601,"comment_content":"const install = function(Vue) {\n    Vue.mixin({\n        beforeCreate() {\n            if(this.$options &amp;&amp; this.$options.store) { &#47;&#47; å¦‚æœæ˜¯æ ¹ç»„ä»¶\n                this.$store = this.$options.store\n            } else { &#47;&#47; å¦‚æœæ˜¯å­ç»„ä»¶\n                this.$store = this.$parent &amp;&amp; this.$parent.$store\n            }\n        }\n    })\n}","like_count":0},{"had_liked":false,"id":396274,"user_name":"Geek_330172","can_delete":false,"product_type":"c3","uid":4053101,"ip_address":"å±±ä¸œ","ucode":"1970B600457B9E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/R4xm4hCOtZR2wOOLnqISmdUHmgq9V2kevv6q5U4D0PEiasb48GdXuic8WYmmjR8fOE4QKh6f181WJY4axwTTib6Hg/132","comment_is_top":false,"comment_ctime":1733829333,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":3,"product_id":100024601,"comment_content":"class Store {\n    constructor(options) {\n        this.vm = new Vue({\n            data: {\n                state: options.state || {}\n            }\n        })\n\n        &#47;&#47; ç”¨æˆ·æä¾›çš„ getters å‡½æ•°\n        const userGetters = options.getters || {}\n        &#47;&#47; Store å®ä¾‹ä¸Šçš„ getters å±æ€§\n        this.getters = {}\n        &#47;&#47; éå†ç”¨æˆ·æä¾›çš„ getter å‡½æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ª getter åˆ›å»ºè®¿é—®å™¨å±æ€§\n        Object.keys(userGetters).forEach(getterName =&gt; {\n            Object.defineProperty(this.getters, getterName, {\n                get: () =&gt; {\n                    return userGetters[getterName](this.state)\n                }\n            })\n        })\n\n        &#47;&#47; ç”¨æˆ·æä¾›çš„ mutations å‡½æ•°\n        const userMutations = options.mutations || {}\n        &#47;&#47; Store å®ä¾‹ä¸Šçš„ mutations å±æ€§\n        this.mutations = {}\n        &#47;&#47; éå†ç”¨æˆ·æä¾›çš„ mutations å‡½æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ª mutation åˆ›å»ºè®¿é—®å™¨å±æ€§\n        Object.keys(userMutations).forEach(mutationName =&gt; {\n            this.mutations[mutationName] = arg =&gt; {\n                userMutations[mutationName](this.state, arg)\n            }\n        })\n\n        &#47;&#47; ç”¨æˆ·æä¾›çš„ actions å‡½æ•°\n        const userActions = options.actions || {}\n        &#47;&#47; Store å®ä¾‹ä¸Šçš„ actions å±æ€§\n        this.actions = {}\n        &#47;&#47; éå†ç”¨æˆ·æä¾›çš„ actions å‡½æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ª action åˆ›å»ºè®¿é—®å™¨å±æ€§\n        Object.keys(userActions).forEach(actionName =&gt; {\n            this.actions[actionName] = arg =&gt; {\n                userActions[actionName](this, arg)\n            }\n        })\n\n    }\n\n    dispatch(method, arg) {\n        this.actions[method](arg)\n    }\n\n    &#47;&#47; åœ¨æ‰§è¡Œ dispatch è°ƒç”¨ commitï¼Œthis undefined æ”¹ä¸ºç®­å¤´å‡½æ•°\n    commit = (method, arg) =&gt; {\n        this.mutations[method](arg)\n    }\n\n    get state() {\n        return this.vm.state\n    }\n}","like_count":0},{"had_liked":false,"id":295605,"user_name":"å¯æƒœæ²¡æœ‰å¦‚æœï½R","can_delete":false,"product_type":"c3","uid":1661123,"ip_address":"","ucode":"17BEE46924E721","user_header":"https://static001.geekbang.org/account/avatar/00/19/58/c3/a9dcaa99.jpg","comment_is_top":false,"comment_ctime":1622510843,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"import Vue from &#39;vue&#39;;\n\nconst Store = function Store(option = {}) {\n    const {state = {}, mutations = {}, actions = {}, getters={}} = option;\n    this._vm = new Vue({\n        data: {\n            $sstate: state\n        }\n    })\n    this._mutations = mutations\n    this._actions = actions\n    this._getters = getters\n    const ref = this\n    const commit = ref.commit\n    const dispatch = ref.dispatch\n\n    this.commit = function boundCommit(type, paylod){\n        return commit.call(ref, type, paylod)\n    }\n\n    this.dispatch = function boundDispatch(type, paylod){\n        return dispatch.call(ref, type, paylod)\n    }\n}\n\nStore.prototype.commit = function(type, paylod) {\n    if(this._mutations[type]){\n        this._mutations[type](this.state, paylod)\n    }\n}\n\nStore.prototype.dispatch = function(type, paylod){\n    if(this._actions[type]){\n        this._actions[type]({\n            state: this.state,\n            commit: this.commit,\n            paylod,\n        })\n    }\n}\n\nStore.prototype.getters = function(type){\n    if(this._getters[type]){\n        this._getters[type](this.state)\n    }\n}\n\nObject.defineProperties(Store.prototype,{\n    state: {\n        get: function(){\n            return this._vm.$data.$sstate\n        }\n    }\n})\n\nexport default {Store}\n\nå…¶ä»–çš„æ²¡å†™å®Œï¼Œä¸»è¦å§ actionå†™å®Œäº†","like_count":0},{"had_liked":false,"id":277149,"user_name":"ä½ å¥½ï¼Œé˜³å…‰","can_delete":false,"product_type":"c3","uid":2145095,"ip_address":"","ucode":"1A2F487C57F7D9","user_header":"https://static001.geekbang.org/account/avatar/00/20/bb/47/b60ae3eb.jpg","comment_is_top":false,"comment_ctime":1612275751,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"é“¾æ¥ä»£ç ä¸­vueInitå‡½æ•°é‡Œé¢çš„options.parentåˆ¤æ–­åˆ†æ”¯æ˜¯å¦ä»£è¡¨ç»™éæ ¹ç»„ä»¶æ³¨å…¥$storeå±æ€§ï¼Ÿ","like_count":0},{"had_liked":false,"id":231772,"user_name":"è‘±æ²¹æ‹Œé¢","can_delete":false,"product_type":"c3","uid":1728866,"ip_address":"","ucode":"C8681C7AC91332","user_header":"https://static001.geekbang.org/account/avatar/00/1a/61/62/bdefba52.jpg","comment_is_top":false,"comment_ctime":1593767480,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"ä¸Šå®Œè¯¾çªç„¶é—ªç°è€å¸ˆçš„å¤§è„¸ä¹Ÿæ˜¯æœ‰ç‚¹çªå…€å“ˆå“ˆå“ˆå“ˆå“ˆ","like_count":0},{"had_liked":false,"id":190419,"user_name":"WinfyHo","can_delete":false,"product_type":"c3","uid":1376366,"ip_address":"","ucode":"1C1EBA315593A8","user_header":"https://static001.geekbang.org/account/avatar/00/15/00/6e/6982a56e.jpg","comment_is_top":false,"comment_ctime":1584645400,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"æ²¡æƒ³åˆ°è¿˜èƒ½è¿™ä¹ˆæ‰‹å†™vuexï¼Œåˆ©ç”¨vueåŸæ¥çš„å“åº”å¼ç³»ç»ŸæŒ‚è½½ï¼Œå‡å°‘å¾ˆå¤šä»£ç ","like_count":0},{"had_liked":false,"id":174325,"user_name":"é€’å½’æ¶›","can_delete":false,"product_type":"c3","uid":1578922,"ip_address":"","ucode":"0C5082BEBDA550","user_header":"https://static001.geekbang.org/account/avatar/00/18/17/aa/3e0508ae.jpg","comment_is_top":false,"comment_ctime":1580142119,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"const {mutations, state, getters} = option\n    let changeGetters = {}\n    &#47;&#47; getterså®ç°\n    Object.keys(getters).forEach(key =&gt; {\n        changeGetters[key] = () =&gt; getters[key](this._vm._data.$$data)\n    })\n    this._vm = new Vue({\n        data() {\n            return {\n                $$data: state\n            }\n        },\n        computed: changeGetters\n    })\n    this._mutations = mutations\nè¯•äº†ä¸€ä¸‹ï¼Œèƒ½ç”¨ã€‚","like_count":0,"discussions":[{"author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192128,"discussion_content":"åº”è¯¥è¿˜éœ€è¦åœ¨Store.prototypeä¸ŠåŠ ä¸€ä¸ªgetterså±æ€§å§ã€‚\nObject.defineProperties(Store.prototype, {\n    state: {\n        get: function () {\n            return this._vm._data.$$state;\n        }\n    },\n    getters: {\n        get: function () {\n            return this._vm;\n        }\n    }\n})","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583064501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149030,"user_name":"Saki","can_delete":false,"product_type":"c3","uid":1143138,"ip_address":"","ucode":"CEA2E5D15D400E","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/62/20df02b0.jpg","comment_is_top":false,"comment_ctime":1573129232,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"æš‚æ—¶ç”¨ä¸åˆ°ï¼Œå…ˆæ¥äº†è§£åŸç†ï¼Œçœ¼ç†Ÿçœ¼ç†Ÿ","like_count":0},{"had_liked":false,"id":118002,"user_name":"å‘¨åºçŒ¿","can_delete":false,"product_type":"c3","uid":1374169,"ip_address":"","ucode":"C6D09DBAA22F94","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/d9/3014889f.jpg","comment_is_top":false,"comment_ctime":1564209769,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œå¤§æ¦‚è¿‡äº†ä¸‹vuexçš„æºç ã€‚æœ‰ä¸ªåœ°æ–¹ä¸æ˜¯å¾ˆç†è§£ï¼Œä¸ºä»€ä¹ˆvuexå†…éƒ¨å­˜æ”¾mutationsã€actions éƒ½è¦ä»¥æ•°ç»„çš„å½¢å¼å­˜æ”¾å‘¢ã€‚æ¯ä¸ªæ¨¡å—ä¸­å­˜åœ¨çš„ mutations ä¸‹çš„æ“ä½œåº”è¯¥æ˜¯å”¯ä¸€çš„æ‰å¯¹å•Šï¼Œå³ä½¿æ˜¯ä¸åŒæ¨¡å—ä¸‹çš„åŒåçš„mutation å®ƒä»¬typeå€¼ä¹Ÿä¸ä¸€æ ·ï¼ŒçœŸçš„æƒ³ä¸æ˜è¯·è€å¸ˆä¸ºæˆ‘è§£æƒ‘ã€‚\næºç ï¼š\nfunction registerMutation (store, type, handler, local) {\n  const entry = store._mutations[type] || (store._mutations[type] = [])\n  entry.push(function wrappedMutationHandler (payload) {\n    handler.call(store, local.state, payload)\n  })\n}\nä¸ºä»€ä¹ˆä¸ç›´æ¥è¿™æ ·å†™ï¼š\nfunction registerMutation (store, type, handler, local) {\n  store._mutations[type] = function (payload) {\n    handler.call(store, local.state, payload)\n  }\n}","like_count":0},{"had_liked":false,"id":88781,"user_name":"novalnğŸ‰","can_delete":false,"product_type":"c3","uid":1231695,"ip_address":"","ucode":"EC544D448DA898","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/4f/feb5528f.jpg","comment_is_top":false,"comment_ctime":1555999384,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"min-vue.jsä¸­ç¬¬19è¡Œï¼šgetå‡½æ•°ä¸­ return this._vm._data.$$stateï¼Œä¸ºä»€ä¹ˆéœ€è¦æœ‰ä¸€å±‚_dataå‘¢ï¼Œnew Vueæ—¶dataå¯¹è±¡ä¸­çš„æ‰€æœ‰keyä¸æ˜¯éƒ½ä¼šæŒ‚è½½åˆ°å®ä¾‹ä¸Šå—ï¼Œç›´æ¥è®¿é—®this._vm.$stateå°±å¯ä»¥ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192022,"discussion_content":"å®ä¾‹ä»£ç†dataå¯¹è±¡ä¸­çš„å±æ€§ï¼Œé™¤äº†ä¸èƒ½ä¸methodså’Œpropsé‡åä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé™åˆ¶æ¡ä»¶ï¼šå±æ€§ä¸èƒ½æ˜¯ä»¥$æˆ–è€…_å¼€å¤´çš„ä¿ç•™å±æ€§ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè€å¸ˆä½¿ç”¨$$stateï¼Œvueä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªä¿ç•™å±æ€§ï¼Œå› æ­¤ä¸ä¼šä»£ç†ã€‚æ‰“å°this._vm_$$stateä¼šæ˜¾ç¤ºæ˜¯undefinedã€‚è€Œdataä¸­æ‰€æœ‰çš„æ•°æ®æœ€ç»ˆä¼šä¿å­˜åœ¨vm._dataä¸‹ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œå› æ­¤å¯ä»¥åœ¨éœ€è¦åœ¨_dataä¸‹å–ï¼Œ $dataä¹Ÿå¯ä»¥ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583055678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":86282,"user_name":"çƒŸé›¨æµ·èŠ±lwl","can_delete":false,"product_type":"c3","uid":1495437,"ip_address":"","ucode":"94106A70FF45A6","user_header":"https://static001.geekbang.org/account/avatar/00/16/d1/8d/d923fa4b.jpg","comment_is_top":false,"comment_ctime":1555337614,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"æ‰“å¡","like_count":0}]}