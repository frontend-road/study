{"id":158209,"title":"22 | 源码剖析：启动服务","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geek_netty\">https://gitee.com/geektime-geekbang/geek_netty</a></p>","comments":[{"had_liked":false,"id":149428,"user_name":"fanhang116","can_delete":false,"product_type":"c3","uid":1069555,"ip_address":"","ucode":"BD59FABFEF5DC6","user_header":"https://static001.geekbang.org/account/avatar/00/10/51/f3/96ae1b38.jpg","comment_is_top":false,"comment_ctime":1573216333,"is_pvip":false,"replies":[{"id":57923,"content":"三种境界吧，一是能解决问题，二是解决问题之外还知道原理，三是不仅知道原理还能说出来且让别人容易理解，第三种值得努力研究。","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573569009,"ip_address":"","comment_id":149428,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"讲的不是很好，老师自己可能很清楚，但是不能深入浅出的讲出来，为讲代码而讲代码！如何深入浅出的讲出来需要技巧！\n自己悟吧","like_count":33,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473860,"discussion_content":"三种境界吧，一是能解决问题，二是解决问题之外还知道原理，三是不仅知道原理还能说出来且让别人容易理解，第三种值得努力研究。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573569009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2063962,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7e/5a/da39f489.jpg","nickname":"Ethan New","note":"","ucode":"9CA2EF39E58030","race_medal":4,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410457,"discussion_content":"明显自己水平有限，还怪老师讲的不好，哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635692636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158370,"user_name":"再续啸傲","can_delete":false,"product_type":"c3","uid":1360184,"ip_address":"","ucode":"912987A17DCA92","user_header":"https://static001.geekbang.org/account/avatar/00/14/c1/38/e45bbb6b.jpg","comment_is_top":false,"comment_ctime":1575360981,"is_pvip":false,"replies":[{"id":61403,"content":"因为默认有一点了解的，所以很多细节一带而过了。这里补充说明下：\nchannel: 也就是连接；\neventloop：为连接服务的执行器，说白了，就是一个死循环（loop）轮训、处理channel上发生的事件（event）。一个channel只会绑定到一个eventloop,但是一个eventloop一般服务于多个channel.\neventloopgroup: 假设就一个eventloop服务于所有channel，肯定会有瓶颈，所以搞一个组，相当于多线程了。\n","user_name":"作者回复","user_name_real":"stroller","uid":1638649,"ctime":1576116492,"ip_address":"","comment_id":158370,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"听到这，对于netty的一些组件不是很了解，就很难跟上课程进度。比如channel、eventloop与eventloopgroup的关系，又来个selector，感觉很混乱。","like_count":28,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476693,"discussion_content":"因为默认有一点了解的，所以很多细节一带而过了。这里补充说明下：\nchannel: 也就是连接；\neventloop：为连接服务的执行器，说白了，就是一个死循环（loop）轮训、处理channel上发生的事件（event）。一个channel只会绑定到一个eventloop,但是一个eventloop一般服务于多个channel.\neventloopgroup: 假设就一个eventloop服务于所有channel，肯定会有瓶颈，所以搞一个组，相当于多线程了。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576116492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149833,"user_name":"nsn_huang","can_delete":false,"product_type":"c3","uid":1041796,"ip_address":"","ucode":"D8C6DA6530F3B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/84/4a01e18d.jpg","comment_is_top":false,"comment_ctime":1573397156,"is_pvip":false,"replies":[{"id":57934,"content":"是的，要有耐心，我打算课程结束，我也再从头到尾看一遍。哈哈","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573570368,"ip_address":"","comment_id":149833,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"一定要自己手动debug，debug之后看视频就感觉很熟悉，能吸收很多内容。看了好几遍才理解，要有耐心啊。","like_count":9,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473992,"discussion_content":"是的，要有耐心，我打算课程结束，我也再从头到尾看一遍。哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573570368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1655725,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","nickname":"雷刚","note":"","ucode":"115FE2BE1AAB61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":218897,"discussion_content":"看源码 debug 不是很好的办法，容易迷失。特别是 netty 中的调用过程确实有点绕 Channel -> ChannelPipeline -> Channel#Unsafe。老师是对代码很熟悉，一般人刚接触的话，往往一 debug 就陷入细节，看源码还是抓住主线看。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585711902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1041796,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e5/84/4a01e18d.jpg","nickname":"nsn_huang","note":"","ucode":"D8C6DA6530F3B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1655725,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","nickname":"雷刚","note":"","ucode":"115FE2BE1AAB61","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219519,"discussion_content":"多谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585757316,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":218897,"ip_address":"","group_id":0},"score":219519,"extra":""}]}]},{"had_liked":false,"id":155523,"user_name":"13761642169","can_delete":false,"product_type":"c3","uid":1232334,"ip_address":"","ucode":"68137695FC2120","user_header":"","comment_is_top":false,"comment_ctime":1574695422,"is_pvip":false,"replies":[{"id":59709,"content":"你说的太对了！hadoop的web hdfs http服务器就绑定了两个端口。不记得后面的课程有没有提，所以这里我直接告诉你这样的案例，谢谢","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574736881,"ip_address":"","comment_id":155523,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"忽然想到，server 绑定多个端口的情况，是不是就用到 bossGroup 多个线程了？","like_count":7,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475783,"discussion_content":"你说的太对了！hadoop的web hdfs http服务器就绑定了两个端口。不记得后面的课程有没有提，所以这里我直接告诉你这样的案例，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574736881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153419,"user_name":"夏露","can_delete":false,"product_type":"c3","uid":1387796,"ip_address":"","ucode":"6B923C3543BE3E","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/14/7c050e45.jpg","comment_is_top":false,"comment_ctime":1574233319,"is_pvip":false,"replies":[{"id":59045,"content":"是的，没有用，判断有没有用的标准，就是看绑定的端口多少，像服务器，一般都绑定一个地址启动，比如8080，所以其他的的用不到，但是你绑定2个端口起启动就会用到了，比如一个绑定8080，一个绑定443.","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574300279,"ip_address":"","comment_id":153419,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"老师帮我回答一个问题， 比如说我一个bossgroup有8个线程， 在启动过程中， 初始化了8个NioEventGroup作为executor， 注册serversocketchannel的时候采用power(2)方式选择了其中1个, 然后绑定了serversocketchannel， 问题是其他7个NioEventGroup是不是没有用？如果有用，用来干嘛？ ","like_count":5,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475157,"discussion_content":"是的，没有用，判断有没有用的标准，就是看绑定的端口多少，像服务器，一般都绑定一个地址启动，比如8080，所以其他的的用不到，但是你绑定2个端口起启动就会用到了，比如一个绑定8080，一个绑定443.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574300279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147874,"user_name":"交叉路口","can_delete":false,"product_type":"c3","uid":1125680,"ip_address":"","ucode":"D1A636F0F4E147","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/30/b840bd9e.jpg","comment_is_top":false,"comment_ctime":1572916397,"is_pvip":false,"replies":[{"id":57235,"content":"其实应该一口气把七个工序都读了，可能就清晰多了，回头我也画张图，再给大家串串，然后到时候(更新完后我集中把所有问题都处理)做个常见问题小册子给你们。最近在做课程，很多问题没来得及回复，不好意思","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573047162,"ip_address":"","comment_id":147874,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"老师，看完视频后感觉理解不是很好，能不能画个图讲解一下？比如一个请求过来经过各个组件，每个组件所做的事情都画出来，这样再结合源码去看会效果比较好，不然听完源码解析，感觉并没有理解透啊","like_count":5,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473327,"discussion_content":"其实应该一口气把七个工序都读了，可能就清晰多了，回头我也画张图，再给大家串串，然后到时候(更新完后我集中把所有问题都处理)做个常见问题小册子给你们。最近在做课程，很多问题没来得及回复，不好意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573047162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146275,"user_name":"鱼向北游","can_delete":false,"product_type":"c3","uid":1439908,"ip_address":"","ucode":"580EC7DCE57E9A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IPdZZXuHVMibwfZWmm7NiawzeEFGsaRoWjhuN99iaoj5amcRkiaOePo6rH1KJ3jictmNlic4OibkF4I20vOGfwDqcBxfA/132","comment_is_top":false,"comment_ctime":1572487646,"is_pvip":false,"replies":[{"id":57863,"content":"后面有，在业务处理那块，如果到时候哪里不清楚，可以留言，谢谢。\n\n这里可以简单说说：pipeline其实就像工厂的生产线，上面有很多道工序（channel handler），然后这个产线的开始就是接受到的原始数据，最终把产品加工，处理完，打包出去就结束了，本身还是很简单的，扩展性就在于这些工序可以随意定制，我们基于netty开发实际上就是写这些工序，然后有序组织起来。","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573549239,"ip_address":"","comment_id":146275,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"请问老师 以后会讲pipeline这块吗 ","like_count":4,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472777,"discussion_content":"后面有，在业务处理那块，如果到时候哪里不清楚，可以留言，谢谢。\n\n这里可以简单说说：pipeline其实就像工厂的生产线，上面有很多道工序（channel handler），然后这个产线的开始就是接受到的原始数据，最终把产品加工，处理完，打包出去就结束了，本身还是很简单的，扩展性就在于这些工序可以随意定制，我们基于netty开发实际上就是写这些工序，然后有序组织起来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573549239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":171690,"user_name":"yihang","can_delete":false,"product_type":"c3","uid":1012361,"ip_address":"","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1578992101,"is_pvip":false,"replies":[{"id":66657,"content":"io.netty.channel.ChannelInitializer：里面在执行完后，有这样一句：\npipeline.remove(this);\n就是这句移除掉自己的。\n\nprivate boolean initChannel(ChannelHandlerContext ctx) throws Exception {\n        if (initMap.add(ctx)) { &#47;&#47; Guard against re-entrance.\n            try {\n                initChannel((C) ctx.channel());\n            } catch (Throwable cause) {\n                &#47;&#47; Explicitly call exceptionCaught(...) as we removed the handler before calling initChannel(...).\n                &#47;&#47; We do so to prevent multiple calls to initChannel(...).\n                exceptionCaught(ctx, cause);\n            } finally {\n                ChannelPipeline pipeline = ctx.pipeline();\n                if (pipeline.context(this) != null) {\n                    pipeline.remove(this);\n                }\n            }\n            return true;\n        }\n        return false;\n    }","user_name":"作者回复","user_name_real":"stroller","uid":1638649,"ctime":1579053684,"ip_address":"","comment_id":171690,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"基本清楚了，需要对nio有一定掌握。一些细节自己下去再看。另外，channelnitializer 在哪里能看到是一次性的？没看到在哪里移除的？","like_count":3,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481472,"discussion_content":"io.netty.channel.ChannelInitializer：里面在执行完后，有这样一句：\npipeline.remove(this);\n就是这句移除掉自己的。\n\nprivate boolean initChannel(ChannelHandlerContext ctx) throws Exception {\n        if (initMap.add(ctx)) { // Guard against re-entrance.\n            try {\n                initChannel((C) ctx.channel());\n            } catch (Throwable cause) {\n                // Explicitly call exceptionCaught(...) as we removed the handler before calling initChannel(...).\n                // We do so to prevent multiple calls to initChannel(...).\n                exceptionCaught(ctx, cause);\n            } finally {\n                ChannelPipeline pipeline = ctx.pipeline();\n                if (pipeline.context(this) != null) {\n                    pipeline.remove(this);\n                }\n            }\n            return true;\n        }\n        return false;\n    }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579053684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1151978,"avatar":"https://static001.geekbang.org/account/avatar/00/11/93/ea/071fa8bf.jpg","nickname":"lisong","note":"","ucode":"B8018C53FD091C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300932,"discussion_content":"我疑问的也是这点,没想到有人帮问了 哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598326221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012361,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","nickname":"yihang","note":"","ucode":"A5506F085D1793","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":134889,"discussion_content":"感谢🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579053823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147083,"user_name":"大象佩奇","can_delete":false,"product_type":"c3","uid":1070165,"ip_address":"","ucode":"EAFB4FA3B9CFEF","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/55/f686c2ed.jpg","comment_is_top":false,"comment_ctime":1572790070,"is_pvip":false,"replies":[{"id":57927,"content":"不懂也没有关系，抓住主线和本质就行了，因为细节就算懂了，过段时间也忘记了，然后另外，如果ppt上的主线和本质不懂的话，那可能要补下相关的知识。加油！","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573569462,"ip_address":"","comment_id":147083,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"每次听老师解读源码都晕晕的，是我太菜还是大家都这样","like_count":3,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473135,"discussion_content":"不懂也没有关系，抓住主线和本质就行了，因为细节就算懂了，过段时间也忘记了，然后另外，如果ppt上的主线和本质不懂的话，那可能要补下相关的知识。加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573569462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146161,"user_name":"小小征","can_delete":false,"product_type":"c3","uid":1358930,"ip_address":"","ucode":"335380EFE0FC61","user_header":"https://static001.geekbang.org/account/avatar/00/14/bc/52/52745d32.jpg","comment_is_top":false,"comment_ctime":1572443646,"is_pvip":false,"replies":[{"id":59086,"content":"1 因为所有的pipeline都是以head开始，以tail结束。所以演示的时候，我知道核心逻辑在head中，所以为了节省跳转时间，直接定位到最后了。\n2 是的，启动后，就active了。\n3 没有OP_ACTIVE,注册的是readInterestOp，如果是ServerSocketChannel，就是指OP_ACCEPT,也就是16.\n4 16代表accept，表示开始监听连接请求的事件了。","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574306551,"ip_address":"","comment_id":146161,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100036701,"comment_content":"老师想请教几个问题：\n1.pipeline这块有点不太明白？为什么直接定位到head？\n2.active 状态是不是做为channel bind地址和端口完成的一种状态？\n3.selectionKey.interestOps(interestOps | readInterestOp); 这段代码代表了 注册OP_ACTIVE吗？并没有看到标识别啊\n4.readInterestOp 这个字段为16是什么意思？","like_count":1,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472731,"discussion_content":"1 因为所有的pipeline都是以head开始，以tail结束。所以演示的时候，我知道核心逻辑在head中，所以为了节省跳转时间，直接定位到最后了。\n2 是的，启动后，就active了。\n3 没有OP_ACTIVE,注册的是readInterestOp，如果是ServerSocketChannel，就是指OP_ACCEPT,也就是16.\n4 16代表accept，表示开始监听连接请求的事件了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574306551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259280,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/10/a8aa9acb.jpg","nickname":"jzdayz","note":"","ucode":"E84C0DFC53BE8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":42030,"discussion_content":"1:   默认的 DefaultChannelPipeline 会设置head为HeadContext\n2:   是的\n3: readInterestOp是在NioServerSocketChannel构造函数固定设置为SelectionKey.OP_ACTIVE的值\n4: 16就是SelectionKey.OP_ACTIVE","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572574152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182726,"user_name":"一条肥鱼","can_delete":false,"product_type":"c3","uid":1161009,"ip_address":"","ucode":"660FCC0FDD057E","user_header":"https://static001.geekbang.org/account/avatar/00/11/b7/31/4e7d7807.jpg","comment_is_top":false,"comment_ctime":1582856440,"is_pvip":false,"replies":[{"id":78835,"content":"是的，视频节奏很快，一般我们还加速1.25倍的话，看起来更快，但是真要深入理解，还是自己做一遍比较好。","user_name":"作者回复","user_name_real":"stroller","uid":1638649,"ctime":1588056867,"ip_address":"","comment_id":182726,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"视频节奏确实很快，一定要自己走一遍代码，并且跟一些作者跳过去的代码，然后再结合视频看，会更有体会一些。","like_count":0,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485430,"discussion_content":"是的，视频节奏很快，一般我们还加速1.25倍的话，看起来更快，但是真要深入理解，还是自己做一遍比较好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588056867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148753,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1573074824,"is_pvip":false,"replies":[{"id":57925,"content":"是的，启动的时候是这个，建立连接的时候，就是nio socket channel了，注意区分。","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1573569113,"ip_address":"","comment_id":148753,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":" selectionKey = javaChannel().register(eventLoop().unwrappedSelector(), 0, this);\n\n老师 这里的this 是nioserversocketchannel 是吧","like_count":0,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473596,"discussion_content":"是的，启动的时候是这个，建立连接的时候，就是nio socket channel了，注意区分。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573569113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148750,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1573074171,"is_pvip":false,"replies":[{"id":59057,"content":"可以是NioEventLoopGroup，也可以是别的（例如EpollEventLoopGroup），课程里面说的都是前者，实现execute在io.netty.util.concurrent.AbstractEventExecutorGroup#execute","user_name":"作者回复","user_name_real":"Geek_9bc307","uid":1638649,"ctime":1574301535,"ip_address":"","comment_id":148750,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"老师 在abstractChannel里边 register方法里边有\neventLoop.execute(new Runnable() {\n                        @Override\n                        public void run() {\n                            register0(promise);\n                        }\n                    });\n\neventloop 是哪个类呀，还有在哪里写了execute方法","like_count":0,"discussions":[{"author":{"id":1638649,"avatar":"https://static001.geekbang.org/account/avatar/00/19/00/f9/44a3e5bd.jpg","nickname":"傅健","note":"","ucode":"5EA8BB26F5B036","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473594,"discussion_content":"可以是NioEventLoopGroup，也可以是别的（例如EpollEventLoopGroup），课程里面说的都是前者，实现execute在io.netty.util.concurrent.AbstractEventExecutorGroup#execute","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574301535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246943,"user_name":"无争就是yk","can_delete":false,"product_type":"c3","uid":1019128,"ip_address":"","ucode":"8739E996ACD746","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/f8/d378c121.jpg","comment_is_top":false,"comment_ctime":1599535672,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"p.addLast(new ChannelInitializer&lt;Channel&gt;() { 中对 pipeline 添加ServerBootstrapAcceptor 为什么要通过ch.eventLoop().execute 来操作，而不是跟上一步一样同步调用pipeline.addLast(handler) 。","like_count":4},{"had_liked":false,"id":308253,"user_name":"人月聊IT","can_delete":false,"product_type":"c3","uid":1358609,"ip_address":"","ucode":"FDC7A0C6E08B02","user_header":"https://static001.geekbang.org/account/avatar/00/14/bb/11/28d86278.jpg","comment_is_top":false,"comment_ctime":1629473808,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"看不懂的同学们，可以看一下小弟的文章 。 欢迎拍砖     https:&#47;&#47;blog.csdn.net&#47;dgutliangxuan&#47;article&#47;details&#47;119605060","like_count":3},{"had_liked":false,"id":175975,"user_name":"fomy","can_delete":false,"product_type":"c3","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1580897009,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"老师，鼠标点进去就debug到那个地方，怎么做到的？","like_count":3,"discussions":[{"author":{"id":1024294,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","nickname":"null","note":"","ucode":"F9039EFED6B55D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320634,"discussion_content":"Run to Cursor （ 运行到当前光标指定处， 不用打断点就行）两种方式：\n1. 可以使用快捷键（windows：Alt + F9，mac：option + F9。\n2. 点击行号。（查找 Action：菜单栏 - Help - Find Action，输入“click line number to perform run to cursor”，回车，勾选该项）","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1604417242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308260,"user_name":"人月聊IT","can_delete":false,"product_type":"c3","uid":1358609,"ip_address":"","ucode":"FDC7A0C6E08B02","user_header":"https://static001.geekbang.org/account/avatar/00/14/bb/11/28d86278.jpg","comment_is_top":false,"comment_ctime":1629478358,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"有一定基础的人来看会比较好","like_count":1},{"had_liked":false,"id":228566,"user_name":"徐晓赫","can_delete":false,"product_type":"c3","uid":1564573,"ip_address":"","ucode":"0E89DAE571D9AB","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/9d/ec6f6f93.jpg","comment_is_top":false,"comment_ctime":1592737221,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"这篇文章对理解这个课很有用：http:&#47;&#47;ifeve.com&#47;selectors&#47;","like_count":1},{"had_liked":false,"id":212768,"user_name":"心浮天空","can_delete":false,"product_type":"c3","uid":1051609,"ip_address":"","ucode":"3B2D0E6CC51EE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/0b/d9/3328dd12.jpg","comment_is_top":false,"comment_ctime":1588208795,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"按照老师的思路DEBUG启动源码时发现, 在 bind 过程中调用了 pipeline.bind 函数, 而 pipeline.bind 调用了 tail.bind 函数, 在 DefaultChannelPipeline 具体实现\n@Override\npublic final ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) {\n    return tail.bind(localAddress, promise);\n}\n\n包括后面完成绑定后在 channelActive 事件中触发 read 完成 OP_ACCEPT 注册, 也是调用的 tail.read 函数，不明白为什么不是调用 head.bind 和 head.read 函数, 希望老师解答。","like_count":1},{"had_liked":false,"id":180101,"user_name":"辉煌码农","can_delete":false,"product_type":"c3","uid":1332799,"ip_address":"","ucode":"09779C2E06EA52","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIy5ULaodUwsLoPuk1wd22hqXsaBbibNEqXM0kgrCTYDGKYQkZICYEyH9wMj4hyUicuQwHdDuOKRj0g/132","comment_is_top":false,"comment_ctime":1582186992,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100036701,"comment_content":"老师，为什么不获取到selectionKey就立即注册OP_ACCEPT事件啊，干嘛要绕一大圈，还搞异步的方式来注册呢？","like_count":1,"discussions":[{"author":{"id":2817744,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/fe/d0/5d32abf3.jpg","nickname":"0xEFBFBD","note":"","ucode":"61F87C0537D064","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609648,"discussion_content":"我也有这样的疑问，为什么不直接注册ACCEPT呢，早晚都要注册。先注册一个0后续再往上加是为了解决什么问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679066689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145978,"user_name":"小不点","can_delete":false,"product_type":"c3","uid":1351860,"ip_address":"","ucode":"C307D44A185C34","user_header":"https://static001.geekbang.org/account/avatar/00/14/a0/b4/5173f1af.jpg","comment_is_top":false,"comment_ctime":1572411166,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"固定周三打卡，老师讲的很好","like_count":1},{"had_liked":false,"id":393207,"user_name":"Geek_309db4","can_delete":false,"product_type":"c3","uid":3790984,"ip_address":"广东","ucode":"0D220E06C36644","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/TiaI6dH29uPzxNYjLpQELvoQnuHVibLTE27MibTf8QMSbb7C4rmKqZKlv2YrabNUsHvxY3H2W9vPsZIibUtsU9magw/132","comment_is_top":false,"comment_ctime":1723127944,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"EventLoopGroup worker = new NioEventLoopGroup()之后，默认会创建2 * CPU Cores个NioEventLoop，那么在ServerBootstrap启动之后，在WorkerEventLoopGroup中的每个NioEventLoop（单线程）是什么时候提交到Execute中执行的？","like_count":0},{"had_liked":false,"id":356985,"user_name":"Geek_d22c9b","can_delete":false,"product_type":"c3","uid":3069069,"ip_address":"上海","ucode":"5DFA2396F10EF3","user_header":"","comment_is_top":false,"comment_ctime":1662794615,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"我感觉讲的很好，老师至少很清楚","like_count":0},{"had_liked":false,"id":349793,"user_name":"留得残荷听雨声","can_delete":false,"product_type":"c3","uid":1194192,"ip_address":"","ucode":"EFA3190EFC1B69","user_header":"https://static001.geekbang.org/account/avatar/00/12/38/d0/958685e8.jpg","comment_is_top":false,"comment_ctime":1656329356,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"读源码部分，我是先自己读了一遍大概，有了大概理解之后，再看老师的讲解，才能知道每次讲到啥地方了，然后发现自己看的时候漏掉了什么，搞错了什么，如果啥也不知道直接看，感觉会看不懂","like_count":0},{"had_liked":false,"id":327394,"user_name":"开心","can_delete":false,"product_type":"c3","uid":1517457,"ip_address":"","ucode":"C8E08E8724C7CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkzrezV2dOBAgickt9DLzabz3dNFYyDEVXENMQ5ibrWhFbFqXIOia3ZaR21pozvB7UfoxJx4Ar688sA/132","comment_is_top":false,"comment_ctime":1640097403,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"这样讲源码，前提是对netty各个类的作用和关联关系已经比较熟悉了才可以。 如果我都熟悉了，我已经具备自己看的能力了啊。","like_count":0},{"had_liked":false,"id":316561,"user_name":"受超凡","can_delete":false,"product_type":"c3","uid":2678558,"ip_address":"","ucode":"A2A160D483BBB0","user_header":"","comment_is_top":false,"comment_ctime":1634393807,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"pipeline应该提前讲一下没有基础还得去学一下","like_count":0},{"had_liked":false,"id":296682,"user_name":"何妨","can_delete":false,"product_type":"c3","uid":1385377,"ip_address":"","ucode":"EC3983BFF7992A","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg","comment_is_top":false,"comment_ctime":1623116123,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"debug 看源码是最差的方式","like_count":0},{"had_liked":false,"id":290901,"user_name":"张滔","can_delete":false,"product_type":"c3","uid":1322636,"ip_address":"","ucode":"87ABAFF0E861E0","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/8c/b261e15a.jpg","comment_is_top":false,"comment_ctime":1619843573,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"怎么可以在github上找到某个版本的netty源码？比如要找4.1.63.Final的源码","like_count":0},{"had_liked":false,"id":280000,"user_name":"Alpha 👀","can_delete":false,"product_type":"c3","uid":1200971,"ip_address":"","ucode":"3C0BAD36550718","user_header":"https://static001.geekbang.org/account/avatar/00/12/53/4b/28991f30.jpg","comment_is_top":false,"comment_ctime":1614050194,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"老师好，final SelectorTuple selectorTuple = openSelector();这边创建Selector的时候，如果是优化的了会弄一个包装了的Selector，这个有什么特殊用法吗，我看SelectedSelectionKeySetSelector里面接口除了增加selectionKeys.reset();，都是使用组合的Selector来操作。","like_count":0},{"had_liked":false,"id":268285,"user_name":"tongmin_tsai","can_delete":false,"product_type":"c3","uid":1045090,"ip_address":"","ucode":"D9423E770D5846","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/62/f873cd8f.jpg","comment_is_top":false,"comment_ctime":1608124830,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100036701,"comment_content":"老师，我看addListener都是后面调用的，netty是如何保障在addListener之前如果已经isDone的话，必定能触发后面添加的addListener的回调的？","like_count":0},{"had_liked":false,"id":267073,"user_name":"tongmin_tsai","can_delete":false,"product_type":"c3","uid":1045090,"ip_address":"","ucode":"D9423E770D5846","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/62/f873cd8f.jpg","comment_is_top":false,"comment_ctime":1607589311,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"老师，我在SingleThreadEventExecutor的源码中看到SingleThreadEventExecutor.this.run()，SingleThreadEventExecutor.this这种写法，为什么可以拿到NioEventLoop？对这种写法有些疑惑，应该是java基础吧？但平时基本没写过。。。望老师能帮忙解答一下","like_count":0},{"had_liked":false,"id":225331,"user_name":"一世繁华都是烟 จุ๊บ","can_delete":false,"product_type":"c3","uid":1132415,"ip_address":"","ucode":"15ADE2EE5FA5B6","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/7f/90ea5e69.jpg","comment_is_top":false,"comment_ctime":1591716142,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"没看到provider.openServerSocketChannel()方法，这个是在哪儿调用的呢？","like_count":0},{"had_liked":false,"id":212728,"user_name":"心浮天空","can_delete":false,"product_type":"c3","uid":1051609,"ip_address":"","ucode":"3B2D0E6CC51EE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/0b/d9/3328dd12.jpg","comment_is_top":false,"comment_ctime":1588203953,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"一直有个疑问, 希望老师解答:\n在源码中可以看到有很多处代码都使用了 eventLoop.inEventLoop() 函数判断当前线程是否为 EventLoop 线程, 如果不是则通过 eventLoop.execute(command) 提交任务的方式执行, 我能想到的原因是为了不阻塞当前线程, 将command操作异步执行, 不知道理解的对不对，请老师解答。","like_count":0},{"had_liked":false,"id":187846,"user_name":"石建","can_delete":false,"product_type":"c3","uid":1041013,"ip_address":"","ucode":"72339F0F3463E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e2/75/94039076.jpg","comment_is_top":false,"comment_ctime":1584258820,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"老师，应该要给大家说下：eventloop run 循环中，除过处理 selecte，还要处理task。不然execute添加task怎么执行？","like_count":0},{"had_liked":false,"id":178875,"user_name":"瓜瓜","can_delete":false,"product_type":"c3","uid":1108505,"ip_address":"","ucode":"F90A5135A9BB4B","user_header":"https://static001.geekbang.org/account/avatar/00/10/ea/19/14018371.jpg","comment_is_top":false,"comment_ctime":1581844103,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"eventLoop.execute(new Runnable() {\n                        @Override\n                        public void run() {\n                            register0(promise);\n                        }\n                    });\n老师在讲跟进execute的时候，怎么一步跳转到\n private void execute(Runnable task, boolean immediate) {\n        boolean inEventLoop = inEventLoop();\n        addTask(task); \n这个里面的？经常跟代码，跟着跟着就跟乱了","like_count":0,"discussions":[{"author":{"id":1161009,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b7/31/4e7d7807.jpg","nickname":"一条肥鱼","note":"","ucode":"660FCC0FDD057E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":189189,"discussion_content":"debug到eventLoop.execute()的时候按F7应该可以吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582856947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175331,"user_name":"punchline","can_delete":false,"product_type":"c3","uid":1314136,"ip_address":"","ucode":"32391B470CCD18","user_header":"https://static001.geekbang.org/account/avatar/00/14/0d/58/008173ad.jpg","comment_is_top":false,"comment_ctime":1580655773,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"老师您好，想问下netty启动服务 在open selector时，是每一个nioeventloop都会对应一个selector吗？ 也就是说服务端开启的时候，会创建多个selector吗？","like_count":0},{"had_liked":false,"id":157922,"user_name":"冬渐暖","can_delete":false,"product_type":"c3","uid":1586800,"ip_address":"","ucode":"907E41AAE9A36C","user_header":"https://static001.geekbang.org/account/avatar/00/18/36/70/00122b24.jpg","comment_is_top":false,"comment_ctime":1575283536,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100036701,"comment_content":"创建一个NioEventLoopGroup主线流程:\n              1.先创建Selector选择器去检查一个或多个NIO Channel（通道）的状态是否处于可读、可写，和这个NioEventLoopGroup绑定下\n 2.异步创建并初始化（主要是初始化SocketChannel---》就是以前说的设置keepAlive的那些child）jian听器ServerSocketChannel ，jian听新进来的TCP连接通道\n 3.通过jian听器 把workGroup和bossGroup拿出来\n 4.将这个jian听器通过task注册到一开始创建的selector上\n 5.绑定地址异步阻塞启动\n 6.死循环注册接受连接事件到选择器上去(类似于dubbo的初始化消费者)\n\n\n\n注册的时候 next() 是获取一个可用的 EventLoop.   inEventLoop是判断这个EventLoop是不是当前线程的\n\n你的io.netty.bootstrap.ChannelFactory泛型反射+工厂创建NioServerSocket已经被io.netty.channel.ChannelFactory替代了，搞不懂为什么名字都弄一样的。。而且还有继承关系。\n\n发现\neventLoop.execute(new Runnable() {\n    @Override\n    public void run() {\n        register0(promise);\n    }\n});\n这段代码有点想java实体类的构造器，先执行构造方法(这里是execute（）)，然后执行静态方法(这里是run() )\n","like_count":0}]}