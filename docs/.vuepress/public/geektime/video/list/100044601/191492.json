{"id":191492,"title":"10 | 环境变量配置提供程序：容器环境下配置注入的最佳途径","content":"<p><strong>各位亲爱的学员：</strong><br>\n推荐大家阅读一下配置框架的源码，代码量虽然不多，但这里面有不少可以借鉴的设计方法和代码风格，另外其中有一个ChainedConfigurationProvider，是课程里没有提到的，可以思考一下这个提供程序的使用场景。<br>\n源码下载地址：<a href=\"https://github.com/dotnet/extensions\">https://github.com/dotnet/extensions</a></p><p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/NET-Core\">https://gitee.com/geektime-geekbang/NET-Core</a></p>","comments":[{"had_liked":false,"id":187863,"user_name":"行走世间的都是妖怪","can_delete":false,"product_type":"c3","uid":1449694,"ip_address":"","ucode":"8ED0806F141FD8","user_header":"https://static001.geekbang.org/account/avatar/00/16/1e/de/6601a005.jpg","comment_is_top":false,"comment_ctime":1584261286,"is_pvip":false,"replies":[{"id":77168,"content":"调试环境变量，你可以修改launchSettings.json文件，添加环境变量，也可以在工程属性的界面设置调试环境变量","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1586877449,"ip_address":"","comment_id":187863,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"win10我添加了系统环境，用IConfigurationBuilder builder = new ConfigurationBuilder();读取不到。需要冲洗以下win10，才能读到，为什么呀？  如过在服务器上，是不是也要重启服务器","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487273,"discussion_content":"调试环境变量，你可以修改launchSettings.json文件，添加环境变量，也可以在工程属性的界面设置调试环境变量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586877449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1449694,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1e/de/6601a005.jpg","nickname":"行走世间的都是妖怪","note":"","ucode":"8ED0806F141FD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":205296,"discussion_content":"新添加的系统环境变量读取不到。需要系统重启，才能读取到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584284477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174360,"user_name":"ff","can_delete":false,"product_type":"c3","uid":1024545,"ip_address":"","ucode":"2CE7182F48FE01","user_header":"","comment_is_top":false,"comment_ctime":1580180181,"is_pvip":false,"replies":[{"id":67830,"content":"launchsetting.json仅仅在是调试开发时使用，并且不是有我们程序来读取消费的，因此应用程序的配置，都应该使用appsettings.json等其它配置文件。\n\n感谢提出建议，后面会改进呈现和表达。","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1580269341,"ip_address":"","comment_id":174360,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师好，有几个问题，请解答一下哈\n1.launchsetting.json里面可以嵌套json吗？还是说多层的话必须使用分层符的写法？\n2.launchsetting.json只有调试的时候能用吗，release发布的时候是不是只能读取到系统环境变量的值呢？\n3.还有一个小建议，就是用控制台输出来显示的话只能输出某几个内容，直接断点调试显示所有加载的配置项是不是更直观呢？","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482377,"discussion_content":"launchsetting.json仅仅在是调试开发时使用，并且不是有我们程序来读取消费的，因此应用程序的配置，都应该使用appsettings.json等其它配置文件。\n\n感谢提出建议，后面会改进呈现和表达。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580269341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174230,"user_name":"geffzhang","can_delete":false,"product_type":"c3","uid":1067792,"ip_address":"","ucode":"EE613594F92B08","user_header":"https://static001.geekbang.org/account/avatar/00/10/4b/10/da1eb7d3.jpg","comment_is_top":false,"comment_ctime":1580101085,"is_pvip":false,"replies":[{"id":67828,"content":"k8s下configmap是个不错的选择，当然也有其它配置中心的方案，提供更多的能力帮助团队协作。","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1580269039,"ip_address":"","comment_id":174230,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"k8s最好的是使用configmap吧","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482339,"discussion_content":"k8s下configmap是个不错的选择，当然也有其它配置中心的方案，提供更多的能力帮助团队协作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580269039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185793,"user_name":"小喵喵","can_delete":false,"product_type":"c3","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1583680189,"is_pvip":false,"replies":[{"id":72472,"content":"当你开始使用kubernetes时，你会喜欢上命令行和环境变量的","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1584243877,"ip_address":"","comment_id":185793,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"环境变量是啥东东，这个东东有什么用呢？貌似学.net的都不不喜欢命令行。","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486503,"discussion_content":"当你开始使用kubernetes时，你会喜欢上命令行和环境变量的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584243877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178395,"user_name":"路人甲","can_delete":false,"product_type":"c3","uid":1480119,"ip_address":"","ucode":"B720984454AFAF","user_header":"https://static001.geekbang.org/account/avatar/00/16/95/b7/15e157ec.jpg","comment_is_top":false,"comment_ctime":1581677918,"is_pvip":false,"replies":[{"id":69281,"content":"感谢建议","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1581753949,"ip_address":"","comment_id":178395,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"建议每个小例子用一对大括号 {} 包起来，这样容易阅读理解。","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483795,"discussion_content":"感谢建议","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581753949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174170,"user_name":"陈正文","can_delete":false,"product_type":"c3","uid":1107451,"ip_address":"","ucode":"D1DF7997BA4105","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/fb/5b186d20.jpg","comment_is_top":false,"comment_ctime":1580042805,"is_pvip":false,"replies":[{"id":67827,"content":"在ASP.NET Core中，默认已经注入了命令行和环境变量配置，如果你是简单的控制台程序，则需要像课程里讲的那样来注册这两个提供程序。","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1580268809,"ip_address":"","comment_id":174170,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"命令行或环境变量可以在程序启动时动态提供吗？如果可以，如何提供呢？","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482320,"discussion_content":"在ASP.NET Core中，默认已经注入了命令行和环境变量配置，如果你是简单的控制台程序，则需要像课程里讲的那样来注册这两个提供程序。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580268809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278028,"user_name":"RH999","can_delete":false,"product_type":"c3","uid":2209570,"ip_address":"","ucode":"7C927A58CCA850","user_header":"","comment_is_top":false,"comment_ctime":1612709506,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老師你好，在影片開頭有提到命令行及環境變量提供程序在早期是沒有容器化的，我想請問「容器化」是什麼意思，還有在沒有容器化時與現在配置的方式有什麼不同?\n","like_count":0},{"had_liked":false,"id":270177,"user_name":"秋水东行","can_delete":false,"product_type":"c3","uid":1104304,"ip_address":"","ucode":"57F2D2F81144B0","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/b0/16b8afd9.jpg","comment_is_top":false,"comment_ctime":1608971253,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"为什么我阅读的官方文档里面没看到这部分。。老师能贴个链接吗？. net基础知识和ASP. netcore里面的还有c#指南","like_count":0,"discussions":[{"author":{"id":1104304,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d9/b0/16b8afd9.jpg","nickname":"秋水东行","note":"","ucode":"57F2D2F81144B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337588,"discussion_content":"这三个印象里都没有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608983941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175880,"user_name":"😳","can_delete":false,"product_type":"c3","uid":1452857,"ip_address":"","ucode":"9AFB87EF308539","user_header":"https://static001.geekbang.org/account/avatar/00/16/2b/39/19041d78.jpg","comment_is_top":false,"comment_ctime":1580877672,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"获取的时候原来不区分大小写","like_count":0}]}