{"id":10579,"title":"51 | Zuul网关高级应用场景","content":"无","comments":[{"had_liked":false,"id":40170,"user_name":"西纳","can_delete":false,"product_type":"c3","uid":1103369,"ip_address":"","ucode":"9F7393B8038FB7","user_header":"","comment_is_top":false,"comment_ctime":1542534666,"is_pvip":false,"replies":[{"id":15527,"content":"网关需要做好隔离熔断限流，请继续学习第5模块《微服务容错限流Hystrix&#47;Turbine架构和实践》","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1543237208,"ip_address":"","comment_id":40170,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师全部走网关瓶颈会在网关上，如其中某个服务依赖三方返回比较慢一直占有连接不释放，会把网关连接占满导致其他服务不可以，怎么处理呢？","like_count":3,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429405,"discussion_content":"网关需要做好隔离熔断限流，请继续学习第5模块《微服务容错限流Hystrix/Turbine架构和实践》","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543237208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89249,"user_name":"superFan","can_delete":false,"product_type":"c3","uid":1103116,"ip_address":"","ucode":"AA0FFEF391488D","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/0c/8dd1791d.jpg","comment_is_top":false,"comment_ctime":1556116610,"is_pvip":false,"replies":[{"id":32049,"content":"你好， 复制分流功能可以在zuul上实现，但是一般需要定制，你理解了zuul filter的原理，可以自己定制filter实现复制分流，复制一份请求，把请求发到测试环境，响应回来的时候可以存(例如kafka)供后续比对，注意这个分流的响应最终要丢弃。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1556197446,"ip_address":"","comment_id":89249,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师,zuul可以复制流量么?比如把线上流量复制一份到测试环境,类似nginx的&quot;ngx_http_mirror_module&quot;","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448069,"discussion_content":"你好， 复制分流功能可以在zuul上实现，但是一般需要定制，你理解了zuul filter的原理，可以自己定制filter实现复制分流，复制一份请求，把请求发到测试环境，响应回来的时候可以存(例如kafka)供后续比对，注意这个分流的响应最终要丢弃。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556197446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63091,"user_name":"Asanz","can_delete":false,"product_type":"c3","uid":1005200,"ip_address":"","ucode":"430AB7ED59EE3F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/90/be01bb8d.jpg","comment_is_top":false,"comment_ctime":1548249800,"is_pvip":false,"replies":[{"id":22551,"content":"两周都可以做网关，实现类型功能。zuul本质是java servlet，经过pivotal封装成spring cloud zuul，门槛较低，适合大部分场景。kong是nginx改造，使用lua扩展，性能较高，门槛也高，适合中高级有研发能力用户。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1548506160,"ip_address":"","comment_id":63091,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师您好，请问Kong和Zuul如何做选型？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437468,"discussion_content":"两周都可以做网关，实现类型功能。zuul本质是java servlet，经过pivotal封装成spring cloud zuul，门槛较低，适合大部分场景。kong是nginx改造，使用lua扩展，性能较高，门槛也高，适合中高级有研发能力用户。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548506160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192311,"user_name":"Jason","can_delete":false,"product_type":"c3","uid":1085947,"ip_address":"","ucode":"6EECC0C25A9FCC","user_header":"https://static001.geekbang.org/account/avatar/00/10/91/fb/9b9d22a0.jpg","comment_is_top":false,"comment_ctime":1584846099,"is_pvip":false,"replies":[{"id":74017,"content":"zuul严格讲还不是一个完全开箱即用的网关产品，可以认为它是一个可编程的网关框架，有些功能它并不直接支持，但是可以很容易在zuul基础上进行扩展(可以通过filter扩展功能)。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585054947,"ip_address":"","comment_id":192311,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"zuul 有类似 envoy 支持 API 配置么？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488366,"discussion_content":"zuul严格讲还不是一个完全开箱即用的网关产品，可以认为它是一个可编程的网关框架，有些功能它并不直接支持，但是可以很容易在zuul基础上进行扩展(可以通过filter扩展功能)。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585054947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159380,"user_name":"💢 星星💢","can_delete":false,"product_type":"c3","uid":1254392,"ip_address":"","ucode":"A402B765222C35","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/f8/24fcccea.jpg","comment_is_top":false,"comment_ctime":1575611400,"is_pvip":false,"replies":[{"id":60948,"content":"网关和配置中心在微服务基础架构体系中扮演完全不同的角色。\n\n网络是流量入口(相当于微服务大门)，主要实现反向路由和负载均衡，同时实现安全，监控，限流熔断等跨横切面功能。\n\n配置中心则是统一提供微服务的动态(或静态)配置的。\n\n当然，网关的配置可以结合配置中心来实现。另外，网关和配置中心，一般都需要分环境多套部署。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1575632193,"ip_address":"","comment_id":159380,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师我感觉今天讲的zuul网关有部分点像上个模块的配置中心呀，配置中心不是也可以更改配置切换到不同的环境么，具体他们是怎么协作的呢？还有网关有点像nginx这种把控流量入口的东东。总体感觉网关就是流量的入口，然后在这里做跨横切面业务逻辑的处理。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477030,"discussion_content":"网关和配置中心在微服务基础架构体系中扮演完全不同的角色。\n\n网络是流量入口(相当于微服务大门)，主要实现反向路由和负载均衡，同时实现安全，监控，限流熔断等跨横切面功能。\n\n配置中心则是统一提供微服务的动态(或静态)配置的。\n\n当然，网关的配置可以结合配置中心来实现。另外，网关和配置中心，一般都需要分环境多套部署。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575632193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15502,"user_name":"alnssi","can_delete":false,"product_type":"c3","uid":1053877,"ip_address":"","ucode":"D45334DA1AA661","user_header":"","comment_is_top":false,"comment_ctime":1531235990,"is_pvip":false,"replies":[{"id":5319,"content":"一般网关全挂概念很小，如果某区域zuul全挂了，那只能依赖外界GSLB转发流量","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1531324581,"ip_address":"","comment_id":15502,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"网关的跨区高可用，如果某个区域的zuul都挂了呢，那流量如何转发到其他区域？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420411,"discussion_content":"一般网关全挂概念很小，如果某区域zuul全挂了，那只能依赖外界GSLB转发流量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531324581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}