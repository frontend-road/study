{"id":41017,"title":"18 | æ·±å…¥ç†è§£StatefulSetï¼ˆä¸€ï¼‰ï¼šæ‹“æ‰‘çŠ¶æ€","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šæ·±å…¥ç†è§£StatefulSetä¹‹æ‹“æ‰‘çŠ¶æ€ã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘åœ¨ç»“å°¾å¤„è®¨è®ºåˆ°äº†Deploymentå®é™…ä¸Šå¹¶ä¸è¶³ä»¥è¦†ç›–æ‰€æœ‰çš„åº”ç”¨ç¼–æ’é—®é¢˜ã€‚</p><p>é€ æˆè¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œåœ¨äºDeploymentå¯¹åº”ç”¨åšäº†ä¸€ä¸ªç®€å•åŒ–å‡è®¾ã€‚</p><p>å®ƒè®¤ä¸ºï¼Œä¸€ä¸ªåº”ç”¨çš„æ‰€æœ‰Podï¼Œæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æ‰€ä»¥ï¼Œå®ƒä»¬äº’ç›¸ä¹‹é—´æ²¡æœ‰é¡ºåºï¼Œä¹Ÿæ— æ‰€è°“è¿è¡Œåœ¨å“ªå°å®¿ä¸»æœºä¸Šã€‚éœ€è¦çš„æ—¶å€™ï¼ŒDeploymentå°±å¯ä»¥é€šè¿‡Podæ¨¡æ¿åˆ›å»ºæ–°çš„Podï¼›ä¸éœ€è¦çš„æ—¶å€™ï¼ŒDeploymentå°±å¯ä»¥â€œæ€æ‰â€ä»»æ„ä¸€ä¸ªPodã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨å®é™…çš„åœºæ™¯ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨éƒ½å¯ä»¥æ»¡è¶³è¿™æ ·çš„è¦æ±‚ã€‚</p><p>å°¤å…¶æ˜¯åˆ†å¸ƒå¼åº”ç”¨ï¼Œå®ƒçš„å¤šä¸ªå®ä¾‹ä¹‹é—´ï¼Œå¾€å¾€æœ‰ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚ï¼šä¸»ä»å…³ç³»ã€ä¸»å¤‡å…³ç³»ã€‚</p><p>è¿˜æœ‰å°±æ˜¯æ•°æ®å­˜å‚¨ç±»åº”ç”¨ï¼Œå®ƒçš„å¤šä¸ªå®ä¾‹ï¼Œå¾€å¾€éƒ½ä¼šåœ¨æœ¬åœ°ç£ç›˜ä¸Šä¿å­˜ä¸€ä»½æ•°æ®ã€‚è€Œè¿™äº›å®ä¾‹ä¸€æ—¦è¢«æ€æ‰ï¼Œå³ä¾¿é‡å»ºå‡ºæ¥ï¼Œå®ä¾‹ä¸æ•°æ®ä¹‹é—´çš„å¯¹åº”å…³ç³»ä¹Ÿå·²ç»ä¸¢å¤±ï¼Œä»è€Œå¯¼è‡´åº”ç”¨å¤±è´¥ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç§å®ä¾‹ä¹‹é—´æœ‰ä¸å¯¹ç­‰å…³ç³»ï¼Œä»¥åŠå®ä¾‹å¯¹å¤–éƒ¨æ•°æ®æœ‰ä¾èµ–å…³ç³»çš„åº”ç”¨ï¼Œå°±è¢«ç§°ä¸ºâ€œæœ‰çŠ¶æ€åº”ç”¨â€ï¼ˆStateful Applicationï¼‰ã€‚</p><p>å®¹å™¨æŠ€æœ¯è¯ç”Ÿåï¼Œå¤§å®¶å¾ˆå¿«å‘ç°ï¼Œå®ƒç”¨æ¥å°è£…â€œæ— çŠ¶æ€åº”ç”¨â€ï¼ˆStateless Applicationï¼‰ï¼Œå°¤å…¶æ˜¯WebæœåŠ¡ï¼Œéå¸¸å¥½ç”¨ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦ä½ æƒ³è¦ç”¨å®¹å™¨è¿è¡Œâ€œæœ‰çŠ¶æ€åº”ç”¨â€ï¼Œå…¶å›°éš¾ç¨‹åº¦å°±ä¼šç›´çº¿ä¸Šå‡ã€‚è€Œä¸”ï¼Œè¿™ä¸ªé—®é¢˜è§£å†³èµ·æ¥ï¼Œå•çº¯ä¾é å®¹å™¨æŠ€æœ¯æœ¬èº«å·²ç»æ— èƒ½ä¸ºåŠ›ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ï¼Œâ€œæœ‰çŠ¶æ€åº”ç”¨â€å‡ ä¹æˆäº†å®¹å™¨æŠ€æœ¯åœˆå­çš„â€œå¿Œè®³â€ï¼Œå¤§å®¶ä¸€å¬åˆ°è¿™ä¸ªè¯ï¼Œå°±çº·çº·æ‘‡å¤´ã€‚</p><!-- [[[read_end]]] --><p>ä¸è¿‡ï¼ŒKubernetesé¡¹ç›®è¿˜æ˜¯æˆä¸ºäº†â€œç¬¬ä¸€ä¸ªåƒèƒèŸ¹çš„äººâ€ã€‚</p><p>å¾—ç›Šäºâ€œæ§åˆ¶å™¨æ¨¡å¼â€çš„è®¾è®¡æ€æƒ³ï¼ŒKubernetesé¡¹ç›®å¾ˆæ—©å°±åœ¨Deploymentçš„åŸºç¡€ä¸Šï¼Œæ‰©å±•å‡ºäº†å¯¹â€œæœ‰çŠ¶æ€åº”ç”¨â€çš„åˆæ­¥æ”¯æŒã€‚è¿™ä¸ªç¼–æ’åŠŸèƒ½ï¼Œå°±æ˜¯ï¼šStatefulSetã€‚</p><p>StatefulSetçš„è®¾è®¡å…¶å®éå¸¸å®¹æ˜“ç†è§£ã€‚å®ƒæŠŠçœŸå®ä¸–ç•Œé‡Œçš„åº”ç”¨çŠ¶æ€ï¼ŒæŠ½è±¡ä¸ºäº†ä¸¤ç§æƒ…å†µï¼š</p><ol>\n<li>\n<p><strong>æ‹“æ‰‘çŠ¶æ€</strong>ã€‚è¿™ç§æƒ…å†µæ„å‘³ç€ï¼Œåº”ç”¨çš„å¤šä¸ªå®ä¾‹ä¹‹é—´ä¸æ˜¯å®Œå…¨å¯¹ç­‰çš„å…³ç³»ã€‚è¿™äº›åº”ç”¨å®ä¾‹ï¼Œå¿…é¡»æŒ‰ç…§æŸäº›é¡ºåºå¯åŠ¨ï¼Œæ¯”å¦‚åº”ç”¨çš„ä¸»èŠ‚ç‚¹Aè¦å…ˆäºä»èŠ‚ç‚¹Bå¯åŠ¨ã€‚è€Œå¦‚æœä½ æŠŠAå’ŒBä¸¤ä¸ªPodåˆ é™¤æ‰ï¼Œå®ƒä»¬å†æ¬¡è¢«åˆ›å»ºå‡ºæ¥æ—¶ä¹Ÿå¿…é¡»ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªé¡ºåºæ‰è¡Œã€‚å¹¶ä¸”ï¼Œæ–°åˆ›å»ºå‡ºæ¥çš„Podï¼Œå¿…é¡»å’ŒåŸæ¥Podçš„ç½‘ç»œæ ‡è¯†ä¸€æ ·ï¼Œè¿™æ ·åŸå…ˆçš„è®¿é—®è€…æ‰èƒ½ä½¿ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œè®¿é—®åˆ°è¿™ä¸ªæ–°Podã€‚</p>\n</li>\n<li>\n<p><strong>å­˜å‚¨çŠ¶æ€</strong>ã€‚è¿™ç§æƒ…å†µæ„å‘³ç€ï¼Œåº”ç”¨çš„å¤šä¸ªå®ä¾‹åˆ†åˆ«ç»‘å®šäº†ä¸åŒçš„å­˜å‚¨æ•°æ®ã€‚å¯¹äºè¿™äº›åº”ç”¨å®ä¾‹æ¥è¯´ï¼ŒPod Aç¬¬ä¸€æ¬¡è¯»å–åˆ°çš„æ•°æ®ï¼Œå’Œéš”äº†ååˆ†é’Ÿä¹‹åå†æ¬¡è¯»å–åˆ°çš„æ•°æ®ï¼Œåº”è¯¥æ˜¯åŒä¸€ä»½ï¼Œå“ªæ€•åœ¨æ­¤æœŸé—´Pod Aè¢«é‡æ–°åˆ›å»ºè¿‡ã€‚è¿™ç§æƒ…å†µæœ€å…¸å‹çš„ä¾‹å­ï¼Œå°±æ˜¯ä¸€ä¸ªæ•°æ®åº“åº”ç”¨çš„å¤šä¸ªå­˜å‚¨å®ä¾‹ã€‚</p>\n</li>\n</ol><p>æ‰€ä»¥ï¼Œ<strong>StatefulSetçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯é€šè¿‡æŸç§æ–¹å¼è®°å½•è¿™äº›çŠ¶æ€ï¼Œç„¶ååœ¨Podè¢«é‡æ–°åˆ›å»ºæ—¶ï¼Œèƒ½å¤Ÿä¸ºæ–°Podæ¢å¤è¿™äº›çŠ¶æ€ã€‚</strong></p><p>åœ¨å¼€å§‹è®²è¿°StatefulSetçš„å·¥ä½œåŸç†ä¹‹å‰ï¼Œæˆ‘å°±å¿…é¡»<span class=\"orange\">å…ˆä¸ºä½ è®²è§£ä¸€ä¸ªKubernetesé¡¹ç›®ä¸­éå¸¸å®ç”¨çš„æ¦‚å¿µï¼šHeadless Serviceã€‚</span></p><p>æˆ‘åœ¨å’Œä½ ä¸€èµ·è®¨è®ºKubernetesæ¶æ„çš„æ—¶å€™å°±æ›¾ä»‹ç»è¿‡ï¼ŒServiceæ˜¯Kubernetesé¡¹ç›®ä¸­ç”¨æ¥å°†ä¸€ç»„Podæš´éœ²ç»™å¤–ç•Œè®¿é—®çš„ä¸€ç§æœºåˆ¶ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªDeploymentæœ‰3ä¸ªPodï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªServiceã€‚ç„¶åï¼Œç”¨æˆ·åªè¦èƒ½è®¿é—®åˆ°è¿™ä¸ªServiceï¼Œå®ƒå°±èƒ½è®¿é—®åˆ°æŸä¸ªå…·ä½“çš„Podã€‚</p><p>é‚£ä¹ˆï¼Œè¿™ä¸ªServiceåˆæ˜¯å¦‚ä½•è¢«è®¿é—®çš„å‘¢ï¼Ÿ</p><p><strong>ç¬¬ä¸€ç§æ–¹å¼ï¼Œæ˜¯ä»¥Serviceçš„VIPï¼ˆVirtual IPï¼Œå³ï¼šè™šæ‹ŸIPï¼‰æ–¹å¼</strong>ã€‚æ¯”å¦‚ï¼šå½“æˆ‘è®¿é—®10.0.23.1è¿™ä¸ªServiceçš„IPåœ°å€æ—¶ï¼Œ10.0.23.1å…¶å®å°±æ˜¯ä¸€ä¸ªVIPï¼Œå®ƒä¼šæŠŠè¯·æ±‚è½¬å‘åˆ°è¯¥Serviceæ‰€ä»£ç†çš„æŸä¸€ä¸ªPodä¸Šã€‚è¿™é‡Œçš„å…·ä½“åŸç†ï¼Œæˆ‘ä¼šåœ¨åç»­çš„Serviceç« èŠ‚ä¸­è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p><p><strong>ç¬¬äºŒç§æ–¹å¼ï¼Œå°±æ˜¯ä»¥Serviceçš„DNSæ–¹å¼</strong>ã€‚æ¯”å¦‚ï¼šè¿™æ—¶å€™ï¼Œåªè¦æˆ‘è®¿é—®â€œmy-svc.my-namespace.svc.cluster.localâ€è¿™æ¡DNSè®°å½•ï¼Œå°±å¯ä»¥è®¿é—®åˆ°åå«my-svcçš„Serviceæ‰€ä»£ç†çš„æŸä¸€ä¸ªPodã€‚</p><p>è€Œåœ¨ç¬¬äºŒç§Service DNSçš„æ–¹å¼ä¸‹ï¼Œå…·ä½“è¿˜å¯ä»¥åˆ†ä¸ºä¸¤ç§å¤„ç†æ–¹æ³•ï¼š</p><p>ç¬¬ä¸€ç§å¤„ç†æ–¹æ³•ï¼Œæ˜¯Normal Serviceã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è®¿é—®â€œmy-svc.my-namespace.svc.cluster.localâ€è§£æåˆ°çš„ï¼Œæ­£æ˜¯my-svcè¿™ä¸ªServiceçš„VIPï¼Œåé¢çš„æµç¨‹å°±è·ŸVIPæ–¹å¼ä¸€è‡´äº†ã€‚</p><p>è€Œç¬¬äºŒç§å¤„ç†æ–¹æ³•ï¼Œæ­£æ˜¯Headless Serviceã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è®¿é—®â€œmy-svc.my-namespace.svc.cluster.localâ€è§£æåˆ°çš„ï¼Œç›´æ¥å°±æ˜¯my-svcä»£ç†çš„æŸä¸€ä¸ªPodçš„IPåœ°å€ã€‚<strong>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„åŒºåˆ«åœ¨äºï¼ŒHeadless Serviceä¸éœ€è¦åˆ†é…ä¸€ä¸ªVIPï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥ä»¥DNSè®°å½•çš„æ–¹å¼è§£æå‡ºè¢«ä»£ç†Podçš„IPåœ°å€ã€‚</strong></p><p>é‚£ä¹ˆï¼Œè¿™æ ·çš„è®¾è®¡åˆæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><p>æƒ³è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä»Headless Serviceçš„å®šä¹‰æ–¹å¼çœ‹èµ·ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Headless Serviceå¯¹åº”çš„YAMLæ–‡ä»¶ï¼š</p><pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n  - port: 80\n    name: web\n  clusterIP: None\n  selector:\n    app: nginx\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰€è°“çš„Headless Serviceï¼Œå…¶å®ä»æ˜¯ä¸€ä¸ªæ ‡å‡†Serviceçš„YAMLæ–‡ä»¶ã€‚åªä¸è¿‡ï¼Œå®ƒçš„clusterIPå­—æ®µçš„å€¼æ˜¯ï¼šNoneï¼Œå³ï¼šè¿™ä¸ªServiceï¼Œæ²¡æœ‰ä¸€ä¸ªVIPä½œä¸ºâ€œå¤´â€ã€‚è¿™ä¹Ÿå°±æ˜¯Headlessçš„å«ä¹‰ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªServiceè¢«åˆ›å»ºåå¹¶ä¸ä¼šè¢«åˆ†é…ä¸€ä¸ªVIPï¼Œè€Œæ˜¯ä¼šä»¥DNSè®°å½•çš„æ–¹å¼æš´éœ²å‡ºå®ƒæ‰€ä»£ç†çš„Podã€‚</p><p>è€Œå®ƒæ‰€ä»£ç†çš„Podï¼Œä¾ç„¶æ˜¯é‡‡ç”¨æˆ‘åœ¨å‰é¢ç¬¬12ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/40008\">ã€Šç‰›åˆ€å°è¯•ï¼šæˆ‘çš„ç¬¬ä¸€ä¸ªå®¹å™¨åŒ–åº”ç”¨ã€‹</a>ä¸­æåˆ°çš„Label Selectoræœºåˆ¶é€‰æ‹©å‡ºæ¥çš„ï¼Œå³ï¼šæ‰€æœ‰æºå¸¦äº†app=nginxæ ‡ç­¾çš„Podï¼Œéƒ½ä¼šè¢«è¿™ä¸ªServiceä»£ç†èµ·æ¥ã€‚</p><p>ç„¶åå…³é”®æ¥äº†ã€‚</p><p>å½“ä½ æŒ‰ç…§è¿™æ ·çš„æ–¹å¼åˆ›å»ºäº†ä¸€ä¸ªHeadless Serviceä¹‹åï¼Œå®ƒæ‰€ä»£ç†çš„æ‰€æœ‰Podçš„IPåœ°å€ï¼Œéƒ½ä¼šè¢«ç»‘å®šä¸€ä¸ªè¿™æ ·æ ¼å¼çš„DNSè®°å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>&lt;pod-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.local\n</code></pre><p>è¿™ä¸ªDNSè®°å½•ï¼Œæ­£æ˜¯Kubernetesé¡¹ç›®ä¸ºPodåˆ†é…çš„å”¯ä¸€çš„â€œå¯è§£æèº«ä»½â€ï¼ˆResolvable Identityï¼‰ã€‚</p><p>æœ‰äº†è¿™ä¸ªâ€œå¯è§£æèº«ä»½â€ï¼Œåªè¦ä½ çŸ¥é“äº†ä¸€ä¸ªPodçš„åå­—ï¼Œä»¥åŠå®ƒå¯¹åº”çš„Serviceçš„åå­—ï¼Œä½ å°±å¯ä»¥éå¸¸ç¡®å®šåœ°é€šè¿‡è¿™æ¡DNSè®°å½•è®¿é—®åˆ°Podçš„IPåœ°å€ã€‚</p><p>é‚£ä¹ˆï¼Œ<span class=\"orange\">StatefulSetåˆæ˜¯å¦‚ä½•ä½¿ç”¨è¿™ä¸ªDNSè®°å½•æ¥ç»´æŒPodçš„æ‹“æ‰‘çŠ¶æ€çš„å‘¢ï¼Ÿ</span></p><p>ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬å°±æ¥ç¼–å†™ä¸€ä¸ªStatefulSetçš„YAMLæ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  serviceName: &quot;nginx&quot;\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.9.1\n        ports:\n        - containerPort: 80\n          name: web\n</code></pre><p>è¿™ä¸ªYAMLæ–‡ä»¶ï¼Œå’Œæˆ‘ä»¬åœ¨å‰é¢æ–‡ç« ä¸­ç”¨åˆ°çš„nginx-deploymentçš„å”¯ä¸€åŒºåˆ«ï¼Œå°±æ˜¯å¤šäº†ä¸€ä¸ªserviceName=nginxå­—æ®µã€‚</p><p>è¿™ä¸ªå­—æ®µçš„ä½œç”¨ï¼Œå°±æ˜¯å‘Šè¯‰StatefulSetæ§åˆ¶å™¨ï¼Œåœ¨æ‰§è¡Œæ§åˆ¶å¾ªç¯ï¼ˆControl Loopï¼‰çš„æ—¶å€™ï¼Œè¯·ä½¿ç”¨nginxè¿™ä¸ªHeadless Serviceæ¥ä¿è¯Podçš„â€œå¯è§£æèº«ä»½â€ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½ é€šè¿‡kubectl createåˆ›å»ºäº†ä¸Šé¢è¿™ä¸ªServiceå’ŒStatefulSetä¹‹åï¼Œå°±ä¼šçœ‹åˆ°å¦‚ä¸‹ä¸¤ä¸ªå¯¹è±¡ï¼š</p><pre><code>$ kubectl create -f svc.yaml\n$ kubectl get service nginx\nNAME      TYPE         CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE\nnginx     ClusterIP    None         &lt;none&gt;        80/TCP    10s\n\n$ kubectl create -f statefulset.yaml\n$ kubectl get statefulset web\nNAME      DESIRED   CURRENT   AGE\nweb       2         1         19s\n</code></pre><p>è¿™æ—¶å€™ï¼Œå¦‚æœä½ æ‰‹æ¯”è¾ƒå¿«çš„è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡kubectlçš„-wå‚æ•°ï¼Œå³ï¼šWatchåŠŸèƒ½ï¼Œå®æ—¶æŸ¥çœ‹StatefulSetåˆ›å»ºä¸¤ä¸ªæœ‰çŠ¶æ€å®ä¾‹çš„è¿‡ç¨‹ï¼š</p><blockquote>\n<p>å¤‡æ³¨ï¼šå¦‚æœæ‰‹ä¸å¤Ÿå¿«çš„è¯ï¼ŒPodå¾ˆå¿«å°±åˆ›å»ºå®Œäº†ã€‚ä¸è¿‡ï¼Œä½ ä¾ç„¶å¯ä»¥é€šè¿‡è¿™ä¸ªStatefulSetçš„Eventsçœ‹åˆ°è¿™äº›ä¿¡æ¯ã€‚</p>\n</blockquote><pre><code>$ kubectl get pods -w -l app=nginx\nNAME      READY     STATUS    RESTARTS   AGE\nweb-0     0/1       Pending   0          0s\nweb-0     0/1       Pending   0         0s\nweb-0     0/1       ContainerCreating   0         0s\nweb-0     1/1       Running   0         19s\nweb-1     0/1       Pending   0         0s\nweb-1     0/1       Pending   0         0s\nweb-1     0/1       ContainerCreating   0         0s\nweb-1     1/1       Running   0         20s\n</code></pre><p>é€šè¿‡ä¸Šé¢è¿™ä¸ªPodçš„åˆ›å»ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¸éš¾çœ‹åˆ°ï¼ŒStatefulSetç»™å®ƒæ‰€ç®¡ç†çš„æ‰€æœ‰Podçš„åå­—ï¼Œè¿›è¡Œäº†ç¼–å·ï¼Œç¼–å·è§„åˆ™æ˜¯ï¼š<code>&lt;statefulset name&gt;-&lt;ordinal index&gt;</code>ã€‚</p><p>è€Œä¸”è¿™äº›ç¼–å·éƒ½æ˜¯ä»0å¼€å§‹ç´¯åŠ ï¼Œä¸StatefulSetçš„æ¯ä¸ªPodå®ä¾‹ä¸€ä¸€å¯¹åº”ï¼Œç»ä¸é‡å¤ã€‚</p><p>æ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›Podçš„åˆ›å»ºï¼Œä¹Ÿæ˜¯ä¸¥æ ¼æŒ‰ç…§ç¼–å·é¡ºåºè¿›è¡Œçš„ã€‚æ¯”å¦‚ï¼Œåœ¨web-0è¿›å…¥åˆ°RunningçŠ¶æ€ã€å¹¶ä¸”ç»†åˆ†çŠ¶æ€ï¼ˆConditionsï¼‰æˆä¸ºReadyä¹‹å‰ï¼Œweb-1ä¼šä¸€ç›´å¤„äºPendingçŠ¶æ€ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šReadyçŠ¶æ€å†ä¸€æ¬¡æé†’äº†æˆ‘ä»¬ï¼Œä¸ºPodè®¾ç½®livenessProbeå’ŒreadinessProbeçš„é‡è¦æ€§ã€‚</p>\n</blockquote><p>å½“è¿™ä¸¤ä¸ªPodéƒ½è¿›å…¥äº†RunningçŠ¶æ€ä¹‹åï¼Œä½ å°±å¯ä»¥æŸ¥çœ‹åˆ°å®ƒä»¬å„è‡ªå”¯ä¸€çš„â€œç½‘ç»œèº«ä»½â€äº†ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨kubectl execå‘½ä»¤è¿›å…¥åˆ°å®¹å™¨ä¸­æŸ¥çœ‹å®ƒä»¬çš„hostnameï¼š</p><pre><code>$ kubectl exec web-0 -- sh -c 'hostname'\nweb-0\n$ kubectl exec web-1 -- sh -c 'hostname'\nweb-1\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªPodçš„hostnameä¸Podåå­—æ˜¯ä¸€è‡´çš„ï¼Œéƒ½è¢«åˆ†é…äº†å¯¹åº”çš„ç¼–å·ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†è¯•ç€ä»¥DNSçš„æ–¹å¼ï¼Œè®¿é—®ä¸€ä¸‹è¿™ä¸ªHeadless Serviceï¼š</p><pre><code>$ kubectl run -i --tty --image busybox:1.28.4 dns-test --restart=Never --rm /bin/sh \n</code></pre><p>é€šè¿‡è¿™æ¡å‘½ä»¤ï¼Œæˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªä¸€æ¬¡æ€§çš„Podï¼Œå› ä¸º--rmæ„å‘³ç€Podé€€å‡ºåå°±ä¼šè¢«åˆ é™¤æ‰ã€‚ç„¶åï¼Œåœ¨è¿™ä¸ªPodçš„å®¹å™¨é‡Œé¢ï¼Œæˆ‘ä»¬å°è¯•ç”¨nslookupå‘½ä»¤ï¼Œè§£æä¸€ä¸‹Podå¯¹åº”çš„Headless Serviceï¼š</p><pre><code>$ kubectl run -i --tty --image busybox:1.28.4 dns-test --restart=Never --rm /bin/sh\n$ nslookup web-0.nginx\nServer:    10.0.0.10\nAddress 1: 10.0.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      web-0.nginx\nAddress 1: 10.244.1.7\n\n$ nslookup web-1.nginx\nServer:    10.0.0.10\nAddress 1: 10.0.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      web-1.nginx\nAddress 1: 10.244.2.7\n</code></pre><p>ä»nslookupå‘½ä»¤çš„è¾“å‡ºç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®¿é—®web-0.nginxçš„æ—¶å€™ï¼Œæœ€åè§£æåˆ°çš„ï¼Œæ­£æ˜¯web-0è¿™ä¸ªPodçš„IPåœ°å€ï¼›è€Œå½“è®¿é—®web-1.nginxçš„æ—¶å€™ï¼Œè§£æåˆ°çš„åˆ™æ˜¯web-1çš„IPåœ°å€ã€‚</p><p>è¿™æ—¶å€™ï¼Œå¦‚æœä½ åœ¨å¦å¤–ä¸€ä¸ªTerminalé‡ŒæŠŠè¿™ä¸¤ä¸ªâ€œæœ‰çŠ¶æ€åº”ç”¨â€çš„Podåˆ æ‰ï¼š</p><pre><code>$ kubectl delete pod -l app=nginx\npod &quot;web-0&quot; deleted\npod &quot;web-1&quot; deleted\n</code></pre><p>ç„¶åï¼Œå†åœ¨å½“å‰Terminalé‡ŒWatchä¸€ä¸‹è¿™ä¸¤ä¸ªPodçš„çŠ¶æ€å˜åŒ–ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š</p><pre><code>$ kubectl get pod -w -l app=nginx\nNAME      READY     STATUS              RESTARTS   AGE\nweb-0     0/1       ContainerCreating   0          0s\nNAME      READY     STATUS    RESTARTS   AGE\nweb-0     1/1       Running   0          2s\nweb-1     0/1       Pending   0         0s\nweb-1     0/1       ContainerCreating   0         0s\nweb-1     1/1       Running   0         32s\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªPodåˆ é™¤ä¹‹åï¼ŒKubernetesä¼šæŒ‰ç…§åŸå…ˆç¼–å·çš„é¡ºåºï¼Œåˆ›å»ºå‡ºäº†ä¸¤ä¸ªæ–°çš„Podã€‚å¹¶ä¸”ï¼ŒKubernetesä¾ç„¶ä¸ºå®ƒä»¬åˆ†é…äº†ä¸åŸæ¥ç›¸åŒçš„â€œç½‘ç»œèº«ä»½â€ï¼šweb-0.nginxå’Œweb-1.nginxã€‚</p><p>é€šè¿‡è¿™ç§ä¸¥æ ¼çš„å¯¹åº”è§„åˆ™ï¼Œ<strong>StatefulSetå°±ä¿è¯äº†Podç½‘ç»œæ ‡è¯†çš„ç¨³å®šæ€§</strong>ã€‚</p><p>æ¯”å¦‚ï¼Œå¦‚æœweb-0æ˜¯ä¸€ä¸ªéœ€è¦å…ˆå¯åŠ¨çš„ä¸»èŠ‚ç‚¹ï¼Œweb-1æ˜¯ä¸€ä¸ªåå¯åŠ¨çš„ä»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªStatefulSetä¸è¢«åˆ é™¤ï¼Œä½ è®¿é—®web-0.nginxæ—¶å§‹ç»ˆéƒ½ä¼šè½åœ¨ä¸»èŠ‚ç‚¹ä¸Šï¼Œè®¿é—®web-1.nginxæ—¶ï¼Œåˆ™å§‹ç»ˆéƒ½ä¼šè½åœ¨ä»èŠ‚ç‚¹ä¸Šï¼Œè¿™ä¸ªå…³ç³»ç»å¯¹ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å†ç”¨nslookupå‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–°Podå¯¹åº”çš„Headless Serviceçš„è¯ï¼š</p><pre><code>$ kubectl run -i --tty --image busybox dns-test --restart=Never --rm /bin/sh \n$ nslookup web-0.nginx\nServer:    10.0.0.10\nAddress 1: 10.0.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      web-0.nginx\nAddress 1: 10.244.1.8\n\n$ nslookup web-1.nginx\nServer:    10.0.0.10\nAddress 1: 10.0.0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      web-1.nginx\nAddress 1: 10.244.2.8\n</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªStatefulSetä¸­ï¼Œè¿™ä¸¤ä¸ªæ–°Podçš„â€œç½‘ç»œæ ‡è¯†â€ï¼ˆæ¯”å¦‚ï¼šweb-0.nginxå’Œweb-1.nginxï¼‰ï¼Œå†æ¬¡è§£æåˆ°äº†æ­£ç¡®çš„IPåœ°å€ï¼ˆæ¯”å¦‚ï¼šweb-0 Podçš„IPåœ°å€10.244.1.8ï¼‰ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œ<strong>Kuberneteså°±æˆåŠŸåœ°å°†Podçš„æ‹“æ‰‘çŠ¶æ€ï¼ˆæ¯”å¦‚ï¼šå“ªä¸ªèŠ‚ç‚¹å…ˆå¯åŠ¨ï¼Œå“ªä¸ªèŠ‚ç‚¹åå¯åŠ¨ï¼‰ï¼ŒæŒ‰ç…§Podçš„â€œåå­—+ç¼–å·â€çš„æ–¹å¼å›ºå®šäº†ä¸‹æ¥</strong>ã€‚æ­¤å¤–ï¼ŒKubernetesè¿˜ä¸ºæ¯ä¸€ä¸ªPodæä¾›äº†ä¸€ä¸ªå›ºå®šå¹¶ä¸”å”¯ä¸€çš„è®¿é—®å…¥å£ï¼Œå³ï¼šè¿™ä¸ªPodå¯¹åº”çš„DNSè®°å½•ã€‚</p><p>è¿™äº›çŠ¶æ€ï¼Œåœ¨StatefulSetçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œéƒ½ä¼šä¿æŒä¸å˜ï¼Œç»ä¸ä¼šå› ä¸ºå¯¹åº”Podçš„åˆ é™¤æˆ–è€…é‡æ–°åˆ›å»ºè€Œå¤±æ•ˆã€‚</p><p>ä¸è¿‡ï¼Œç›¸ä¿¡ä½ ä¹Ÿå·²ç»æ³¨æ„åˆ°äº†ï¼Œå°½ç®¡web-0.nginxè¿™æ¡è®°å½•æœ¬èº«ä¸ä¼šå˜ï¼Œä½†å®ƒè§£æåˆ°çš„Podçš„IPåœ°å€ï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¯¹äºâ€œæœ‰çŠ¶æ€åº”ç”¨â€å®ä¾‹çš„è®¿é—®ï¼Œä½ å¿…é¡»ä½¿ç”¨DNSè®°å½•æˆ–è€…hostnameçš„æ–¹å¼ï¼Œè€Œç»ä¸åº”è¯¥ç›´æ¥è®¿é—®è¿™äº›Podçš„IPåœ°å€ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘é¦–å…ˆå’Œä½ åˆ†äº«äº†StatefulSetçš„åŸºæœ¬æ¦‚å¿µï¼Œè§£é‡Šäº†ä»€ä¹ˆæ˜¯åº”ç”¨çš„â€œçŠ¶æ€â€ã€‚</p><p>ç´§æ¥ç€ ï¼Œæˆ‘ä¸ºä½ åˆ†æäº†StatefulSetå¦‚ä½•ä¿è¯åº”ç”¨å®ä¾‹ä¹‹é—´â€œæ‹“æ‰‘çŠ¶æ€â€çš„ç¨³å®šæ€§ã€‚</p><p>å¦‚æœç”¨ä¸€å¥è¯æ¥æ€»ç»“çš„è¯ï¼Œä½ å¯ä»¥è¿™ä¹ˆç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š</p><blockquote>\n<p>StatefulSetè¿™ä¸ªæ§åˆ¶å™¨çš„ä¸»è¦ä½œç”¨ä¹‹ä¸€ï¼Œå°±æ˜¯ä½¿ç”¨Podæ¨¡æ¿åˆ›å»ºPodçš„æ—¶å€™ï¼Œå¯¹å®ƒä»¬è¿›è¡Œç¼–å·ï¼Œå¹¶ä¸”æŒ‰ç…§ç¼–å·é¡ºåºé€ä¸€å®Œæˆåˆ›å»ºå·¥ä½œã€‚è€Œå½“StatefulSetçš„â€œæ§åˆ¶å¾ªç¯â€å‘ç°Podçš„â€œå®é™…çŠ¶æ€â€ä¸â€œæœŸæœ›çŠ¶æ€â€ä¸ä¸€è‡´ï¼Œéœ€è¦æ–°å»ºæˆ–è€…åˆ é™¤Podè¿›è¡Œâ€œè°ƒè°â€çš„æ—¶å€™ï¼Œå®ƒä¼šä¸¥æ ¼æŒ‰ç…§è¿™äº›Podç¼–å·çš„é¡ºåºï¼Œé€ä¸€å®Œæˆè¿™äº›æ“ä½œã€‚</p>\n</blockquote><p>æ‰€ä»¥ï¼ŒStatefulSetå…¶å®å¯ä»¥è®¤ä¸ºæ˜¯å¯¹Deploymentçš„æ”¹è‰¯ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼Œé€šè¿‡Headless Serviceçš„æ–¹å¼ï¼ŒStatefulSetä¸ºæ¯ä¸ªPodåˆ›å»ºäº†ä¸€ä¸ªå›ºå®šå¹¶ä¸”ç¨³å®šçš„DNSè®°å½•ï¼Œæ¥ä½œä¸ºå®ƒçš„è®¿é—®å…¥å£ã€‚</p><p>å®é™…ä¸Šï¼Œåœ¨éƒ¨ç½²â€œæœ‰çŠ¶æ€åº”ç”¨â€çš„æ—¶å€™ï¼Œåº”ç”¨çš„æ¯ä¸ªå®ä¾‹æ‹¥æœ‰å”¯ä¸€å¹¶ä¸”ç¨³å®šçš„â€œç½‘ç»œæ ‡è¯†â€ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å‡è®¾ã€‚</p><p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¼šç»§ç»­ä¸ºä½ å‰–æStatefulSetå¦‚ä½•å¤„ç†å­˜å‚¨çŠ¶æ€ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä½ æ›¾ç»è¿ç»´è¿‡å“ªäº›æœ‰æ‹“æ‰‘çŠ¶æ€çš„åº”ç”¨å‘¢ï¼ˆæ¯”å¦‚ï¼šä¸»ä»ã€ä¸»ä¸»ã€ä¸»å¤‡ã€ä¸€ä¸»å¤šä»ç­‰ç»“æ„ï¼‰ï¼Ÿä½ è§‰å¾—è¿™äº›åº”ç”¨å®ä¾‹ä¹‹é—´çš„æ‹“æ‰‘å…³ç³»ï¼Œèƒ½å¦å€ŸåŠ©è¿™ç§ä¸ºPodå®ä¾‹ç¼–å·çš„æ–¹å¼è¡¨è¾¾å‡ºæ¥å‘¢ï¼Ÿå¦‚æœä¸èƒ½ï¼Œä½ è§‰å¾—Kubernetesè¿˜åº”è¯¥ä¸ºä½ æä¾›å“ªäº›æ”¯æŒæ¥ç®¡ç†è¿™ä¸ªæ‹“æ‰‘çŠ¶æ€å‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p>","neighbors":{"left":{"article_title":"17 | ç»å…¸PaaSçš„è®°å¿†ï¼šä½œä¸šå‰¯æœ¬ä¸æ°´å¹³æ‰©å±•","id":40906},"right":{"article_title":"19 | æ·±å…¥ç†è§£StatefulSetï¼ˆäºŒï¼‰ï¼šå­˜å‚¨çŠ¶æ€","id":41154}},"comments":[{"had_liked":false,"id":32095,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1539413259,"is_pvip":false,"replies":[{"id":"11620","content":"çœ‹æ¥è¿™ä¸ªé•œåƒç¡®å®æœ‰é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539429157,"ip_address":"","comment_id":32095,"utype":1}],"discussion_count":4,"race_medal":0,"score":"431036142859","product_id":100015201,"comment_content":"ä»Šå¤©æŒ‰æ–‡ç« ä¸­çš„å†…å®¹æ¥, ç¡®å®ä¹Ÿé‡åˆ°äº†nslookup åé¦ˆå¤±è´¥çš„çŠ¶å†µ.<br>** server can&#39;t find web-0.nginx: NXDOMAIN<br>*** Can&#39;t find web-0.nginx: No answer<br>ä½†æ˜¯ç›´æ¥ping  web-0.nginx æ˜¯å¯ä»¥è·å–çœŸå®ipåœ°å€çš„.<br>ç¡®å®æ˜¯å¦‚æ¥¼ä¸‹çš„åŒå­¦æ‰€è¯´, éœ€è¦ç”¨ busybox:1.28.4 çš„é•œåƒ. è¿™ä¸ªæ˜¯æœ€æ–°ç‰ˆbusyboxçš„é—®é¢˜.<br>kubectl run -i --tty --image busybox:1.28.4 dns-test --restart=Never --rm &#47;bin&#47;sh<br>è¿™æ ·å°±å¯è·å¾—æœŸå¾…çš„ç»“æœäº†.<br>æˆ‘ä¹Ÿæ˜¯googleåˆ°äº† https:&#47;&#47;github.com&#47;kubernetes&#47;kubernetes&#47;issues&#47;66924 æ‰çŸ¥é“çš„.<br>å†çœ‹æ¥¼ä¸‹çš„è¯„è®º,æ‰å‘ç°æœ‰å…¶ä»–åŒå­¦ä¹Ÿé‡åˆ°äº†,ä¸”åœ¨å‡ å¤©å‰å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆ. ğŸ‘<br>æ–°æŠ€æœ¯ç¡®å®å˜åŒ–å¤ªå¿«äº†,ä½œè€…åœ¨å†™æ–‡ç« æ—¶ç”¨çš„æ²¡é—®é¢˜,ä¹Ÿè®¸éš”ä¸€å¤©å› ä¸ºæŸä¸ªé»˜è®¤é•œåƒä¿®æ”¹äº†,å°±ä¼šå‡ºç°æ–°çš„çŠ¶å†µ.","like_count":101,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426633,"discussion_content":"çœ‹æ¥è¿™ä¸ªé•œåƒç¡®å®æœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539429157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1320487,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","nickname":"ç½—æ°","note":"","ucode":"96BAFAA147341F","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362415,"discussion_content":"ç°åœ¨ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ç›´æ¥æ˜¯ connection timed outï¼›ä½¿ç”¨ 1.28.4 can&#39;t resolve &#39;web-0.nginx&#39;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616938724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"æˆ‘æ¥ä¹Ÿ","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1320487,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","nickname":"ç½—æ°","note":"","ucode":"96BAFAA147341F","race_medal":2,"user_type":1,"is_pvip":false},"discussion":{"id":362495,"discussion_content":"å…¶å®ä¸åŒæ—¶æœŸï¼Œé•œåƒtagç›¸åŒï¼Œå®é™…å†…å®¹ä¹Ÿå¯èƒ½ä¸åŒçš„ã€‚\næ„Ÿè°¢ä½ çš„åé¦ˆï¼Œä¹Ÿå»ºè®®æŠŠä½ çš„è§£å†³åŠæ³•åˆ†äº«å‡ºæ¥å“Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616947373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":362415,"ip_address":""},"score":362495,"extra":""}]},{"author":{"id":1435577,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e7/b9/fd311b4e.jpg","nickname":"èƒ½çŒ«æŒ¯æŒ¯ î’","note":"","ucode":"321D18C3A11147","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588010,"discussion_content":"æäº†åŠå¤©,åœ¨å¤–ç½‘æœç´¢å›æ¥è¿™é‡Œäº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663466072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30795,"user_name":"along2018","can_delete":false,"product_type":"c1","uid":1109053,"ip_address":"","ucode":"181A4C5266DCFE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/3d/a8b38ce3.jpg","comment_is_top":false,"comment_ctime":1538998931,"is_pvip":false,"replies":[{"id":"11075","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539004416,"ip_address":"","comment_id":30795,"utype":1}],"discussion_count":5,"race_medal":0,"score":"242057167507","product_id":100015201,"comment_content":"åˆ›å»ºstatefulsetå¿…é¡»è¦å…ˆåˆ›å»ºä¸€ä¸ªheadlessçš„service?åˆ†ä¸¤æ­¥æ“ä½œï¼Ÿ","like_count":57,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426101,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539004416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1702769,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTImicSGGrnTWbXu3snxpYJ1yMGhtwckV3sZq7K1YmscXxDBj2YOTGPA9t5hicGiaJjx3Zvm7ibickGynzg/132","nickname":"æ­¦ç¥","note":"","ucode":"EB424DA42D52B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398573,"discussion_content":"statefulsetéå¿…é¡»ä½¿ç”¨æ— å¤´serviceï¼Œå‰ææ˜¯æ²¡æœ‰é€šè¿‡dnsè®¿é—®å…·ä½“podçš„éœ€æ±‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1632814615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323652,"avatar":"","nickname":"sibyl","note":"","ucode":"0D142011860D69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41493,"discussion_content":"headless serviceç»™statefulsetæœ‰çŠ¶æ€podæä¾›äº†ç¨³å®šçš„ç»Ÿä¸€åŸŸåï¼Œè¿™æ˜¯æœ‰çŠ¶æ€æœåŠ¡çš„é‡è¦æ¡ä»¶ï¼Œè‡³äºä¸ºå•¥ï¼Œæ¥ç€çœ‹å§ï¼Œè€å¸ˆåé¢ä¸€å®šä¼šè®²çš„ï¼Œå“ˆå“ˆå“ˆ","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1572440277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354901,"discussion_content":"è¿™ä¸ªæ˜¯å¿…é¡»çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1615359492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1013003,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/75/0b/553d4ec4.jpg","nickname":"é€é¥","note":"","ucode":"570969BCFC96EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563370,"discussion_content":"æˆ‘ä¹Ÿæš‚æ—¶è¿˜æ²¡æ˜ç™½ä¸ºä»€ä¹ˆæ­£å¸¸ svc ä¸è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649986624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29715,"user_name":"Dillion","can_delete":false,"product_type":"c1","uid":1219687,"ip_address":"","ucode":"502EDF7ECA5569","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/67/c0128e6c.jpg","comment_is_top":false,"comment_ctime":1538500001,"is_pvip":false,"replies":[{"id":"10847","content":"ä»»ä½•ä¸€æ¬¡podçš„æ›´æ–°éƒ½ä¼šè§¦å‘statefulset æ»šåŠ¨æ›´æ–°ï¼Œæ›´æ–°ä¸€å®šä¼šæŒ‰ç¼–å·é¡ºåºã€‚ä½†å¦‚æœåªæ˜¯åˆ é™¤é‚£å°±ç›´æ¥é‡å»ºå½“å‰podå°±å¤Ÿäº†ï¼Œè¿™å¹¶ä¸ç ´åæ‹“æ‰‘çŠ¶æ€ã€‚å½“ç„¶ï¼Œå¿…è¦çš„æ—¶å€™ï¼Œä½ çš„podå¯åŠ¨å‘½ä»¤è¦èƒ½å¤ŸåŒºåˆ†ç¬¬ä¸€æ¬¡å¯åŠ¨å’Œé‡å¯ï¼Œè§ä¸‹ä¸€èŠ‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538694738,"ip_address":"","comment_id":29715,"utype":1}],"discussion_count":4,"race_medal":0,"score":"169042224545","product_id":100015201,"comment_content":"åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œweb-0ã€web-1å¯åŠ¨åï¼Œæ­¤æ—¶å¦‚æœweb-0æŒ‚äº†ï¼Œé‚£åœ¨åˆ›å»ºweb-0çš„è¿‡ç¨‹ä¸­ï¼Œweb-1ä¹Ÿä¼šè¢«é‡æ–°åˆ›å»ºä¸€æ¬¡ä¹ˆï¼Ÿï¼Ÿï¼Ÿä¹Ÿå°±æ˜¯å¦‚æœä¸€ä¸ªStatefulSetä¸­åªæœ‰æŸä¸ªPodæŒ‚äº†ï¼Œåœ¨é‡å¯å®ƒçš„æ—¶å€™ï¼Œå¦‚ä½•ç¡®ä¿æ–‡ä¸­è¯´çš„Podå¯åŠ¨é¡ºåºå‘¢ï¼Ÿï¼Ÿ","like_count":40,"discussions":[{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354902,"discussion_content":"æœ‰çŠ¶æ€åº”ç”¨ä¸­æœ‰ä¸»ä»èŠ‚ç‚¹ä¹‹åˆ†ï¼Œå¦‚æœåˆ é™¤ä¸»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹ä¸ä¼šå˜ä¸ºä¸»èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä¼šé‡æ–°åˆ›å»ºä¸»èŠ‚ç‚¹ï¼Œæ¯”å¦‚ï¼Œweb-0æ˜¯ä¸»èŠ‚ç‚¹ï¼Œåˆ é™¤åï¼Œk8sä¼šé‡æ–°åˆ›å»ºweb-0","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1615359619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425696,"discussion_content":"ä»»ä½•ä¸€æ¬¡podçš„æ›´æ–°éƒ½ä¼šè§¦å‘statefulset æ»šåŠ¨æ›´æ–°ï¼Œæ›´æ–°ä¸€å®šä¼šæŒ‰ç¼–å·é¡ºåºã€‚ä½†å¦‚æœåªæ˜¯åˆ é™¤é‚£å°±ç›´æ¥é‡å»ºå½“å‰podå°±å¤Ÿäº†ï¼Œè¿™å¹¶ä¸ç ´åæ‹“æ‰‘çŠ¶æ€ã€‚å½“ç„¶ï¼Œå¿…è¦çš„æ—¶å€™ï¼Œä½ çš„podå¯åŠ¨å‘½ä»¤è¦èƒ½å¤ŸåŒºåˆ†ç¬¬ä¸€æ¬¡å¯åŠ¨å’Œé‡å¯ï¼Œè§ä¸‹ä¸€èŠ‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1538694738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2326134,"avatar":"https://static001.geekbang.org/account/avatar/00/23/7e/76/368394bf.jpg","nickname":"å“¦","note":"","ucode":"C776659DED9D79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582122,"discussion_content":"æ‰€ä»¥è¿™ç§æ‹“æ‰‘å…³ç³»åªæ˜¯ä¿è¯podåœ¨å¯åŠ¨çš„æ—¶å€™æŒ‰ç…§é¡ºåºå¹¶ä¸”åç§°ä¸å˜.å•ä¸ªpodåœ¨é‡å»ºçš„æ—¶å€™å¹¶ä¸ä¼šå½±å“æ•´ä¸ªçš„æ‹“æ‰‘å…³ç³»,æ‰€ä»¥åº”è¯¥ä¸ç”¨é‡å»ºæ‰€æœ‰çš„pods","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659245938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2030670,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLrbCic7BckSd3xrawFH5KW0yYtI1uSsIEPFh0FIHxvHv9u6XBKgZCqH13qPbZDHTdqgevXLdGQlEw/132","nickname":"Geek_2a4536","note":"","ucode":"640A0D228B275C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296929,"discussion_content":"æˆ‘è¯•ç€åˆ é™¤äº†web-0ï¼Œå‘ç°k8såªåˆ›å»ºäº†web-0ï¼Œæ­£åœ¨ç–‘æƒ‘å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596706861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30968,"user_name":"åƒå¯»","can_delete":false,"product_type":"c1","uid":1058635,"ip_address":"","ucode":"44A559E38819C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/4b/170654bb.jpg","comment_is_top":false,"comment_ctime":1539054491,"is_pvip":false,"replies":[{"id":"11142","content":"è¿™å’‹è¿˜è·Ÿé•œåƒæœ‰å…³ç³»å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539057719,"ip_address":"","comment_id":30968,"utype":1}],"discussion_count":1,"race_medal":0,"score":"134683040667","product_id":100015201,"comment_content":"è¯´dnsè®¿é—®ä¸åˆ°é‚£ä¸ªç«¥é‹ï¼Œä¸è¦ç”¨latestæ ‡ç­¾çš„busyboxï¼Œç”¨busybox:1.28.4è¿™ä¸ªtagçš„å°±å¯ä»¥äº†ï¼Œæˆ‘ä¹Ÿæ˜¯è¿™æ ·ã€‚","like_count":32,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426162,"discussion_content":"è¿™å’‹è¿˜è·Ÿé•œåƒæœ‰å…³ç³»å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539057719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30354,"user_name":"å·©å¤«å»º","can_delete":false,"product_type":"c1","uid":1222958,"ip_address":"","ucode":"6B06A4399D2338","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/2e/01b2839e.jpg","comment_is_top":false,"comment_ctime":1538806305,"is_pvip":false,"replies":[{"id":"10995","content":"åªèƒ½è®¿é—®åˆ°å›ºå®šçš„ä¸€ä¸ªpodã€‚æ‰€ä»¥è¯´headless serviceä¸èƒ½æ›¿ä»£normal service ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538873567,"ip_address":"","comment_id":30354,"utype":1}],"discussion_count":6,"race_medal":0,"score":"104618021409","product_id":100015201,"comment_content":"Headless Serviceä¸­ä¸é€šè¿‡vipï¼Œå¤–éƒ¨è®¿é—®çš„æ—¶å€™ï¼Œæ˜¯è½®è¯¢è¿˜æ˜¯éšæœºè¿˜æ˜¯çƒ­å¤‡çš„æ–¹å¼è®¿é—®åˆ°web-0å’Œweb-1ï¼Œdnsè§£æå¥½åƒæ²¡æœ‰è½®è¯¢éšæœºæ¦‚å¿µå§ã€‚","like_count":25,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425955,"discussion_content":"åªèƒ½è®¿é—®åˆ°å›ºå®šçš„ä¸€ä¸ªpodã€‚æ‰€ä»¥è¯´headless serviceä¸èƒ½æ›¿ä»£normal service ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1538873567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1365153,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d4/a1/84b64b4e.jpg","nickname":"ethan","note":"","ucode":"C2E0C39659D4C5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385102,"discussion_content":"ping serviceçš„åŸŸåå‘ç°æ˜¯èƒ½å¤Ÿè§£æåˆ°å¤šä¸ªpodçš„ipçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626880048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1136329,"avatar":"https://static001.geekbang.org/account/avatar/00/11/56/c9/7b3cd3e0.jpg","nickname":"é©¬æŒ¯","note":"","ucode":"94234F533219C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381882,"discussion_content":"é‚£statefulsetä¸­replicas: 2ä¸æ˜¯æ¯«æ— æ„ä¹‰ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625276504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354903,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™æ ·çš„ç–‘æƒ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615359664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1027343,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/0f/cac1535a.jpg","nickname":"å¤§æ°´ç‰›","note":"","ucode":"9CF2B21BA75C0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531852,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637423905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":354903,"ip_address":""},"score":531852,"extra":"{\"user_type\":1}"},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"ä¸ç»æ„é—´","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1027343,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/0f/cac1535a.jpg","nickname":"å¤§æ°´ç‰›","note":"","ucode":"9CF2B21BA75C0D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533353,"discussion_content":"è¿™éƒ½ä¸æ˜¯ä¸€ä¸ªåœºæ™¯å§ã€‚statefulsetæè¿°çš„æ˜¯ä¸€ä¸ªä¸å¹³ç­‰å…³ç³»çš„æ‹“æ‰‘ã€‚ä¸ºå•¥è¦è½®è¯¢å‘¢","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1637844526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":531852,"ip_address":""},"score":533353,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":29761,"user_name":"fldhmily63319","can_delete":false,"product_type":"c1","uid":1220331,"ip_address":"","ucode":"6FFD779498970F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PUiby8MibibKcMd88OtDq1c0myEILZjap46fyiaOlML0UlNWzj9NTIEXOhXCCR1tcUibG0I6UoGp59Zj8H5EYwzkY9g/132","comment_is_top":false,"comment_ctime":1538533208,"is_pvip":false,"replies":[{"id":"10739","content":"æ˜¯ï¼Œå¿…é¡»ç”¨headless service","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613649,"ip_address":"","comment_id":29761,"utype":1}],"discussion_count":5,"race_medal":0,"score":"83142911832","product_id":100015201,"comment_content":"æˆ‘ä¹Ÿæƒ³é—®ï¼Œ &quot;Normal Service&quot;å’Œ&quot;Headless Serviceâ€œçš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ<br><br>æ ¹æ®æ–‡ç« æ‰€è¯´çš„ï¼Œâ€Headless Serviceä¸éœ€è¦åˆ†é…ä¸€ä¸ª VIPï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥ä»¥ DNS è®°å½•çš„æ–¹å¼è§£æå‡ºè¢«ä»£ç† Pod çš„ IP åœ°å€â€œï¼ŒåŒæ—¶ç”±äºå…¶ç¼–å·çš„ä¸¥æ ¼è§„å®šï¼Œä¼šæŒ‰ç…§ç¼–å·é¡ºåºå®Œæˆåˆ›å»ºå·¥ä½œã€‚<br><br>è¿™æ ·æ˜¯ä¸æ˜¯è¯´ï¼Œå¦‚æœåœ¨éƒ¨ç½²StatefulSetçš„æ—¶å€™ï¼Œå¤§éƒ¨åˆ†æ˜¯æ¨èä½¿ç”¨&quot;Headless Service&quot; ï¼Œè€Œä¸æ˜¯&quot;Normal Serviceâ€å‘¢ï¼Ÿ","like_count":20,"discussions":[{"author":{"id":1702769,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTImicSGGrnTWbXu3snxpYJ1yMGhtwckV3sZq7K1YmscXxDBj2YOTGPA9t5hicGiaJjx3Zvm7ibickGynzg/132","nickname":"æ­¦ç¥","note":"","ucode":"EB424DA42D52B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398977,"discussion_content":"è¿™ä¸ªå›ç­”æœ‰ç‚¹ä¸ä¸¥è°¨ï¼Œæ— å¤´serviceåœ¨statefulsetå¯¹è±¡ä¸‹éå¿…é¡»çš„ã€‚é™¤éæœ‰å¼ºéœ€æ±‚éœ€è¦é€šè¿‡dnsè®¿é—®å…·ä½“çš„pod","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1632882534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425707,"discussion_content":"æ˜¯ï¼Œå¿…é¡»ç”¨headless service","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1538613649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414190,"discussion_content":"ä¹‹å‰ç”¨normal serviceçš„æ–¹å¼éƒ¨ç½²çš„elasticsearchçš„statefulsetï¼Œå¥½åƒä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸€ç›´ç”¨åˆ°ç°åœ¨äº†ã€‚è€Œä¸”çœ‹ä½œè€…çš„åŸæ–‡ï¼Œå¥½åƒä¹Ÿæ²¡è¯´statefulsetæŒ‰ç¼–å·å¯åŠ¨podå’Œheadless serviceæœ‰å¿…ç„¶å…³ç³»ã€‚æ­å»ºçš„esé›†ç¾¤æ²¡ç”¨headless serviceï¼Œæ›´æ–°æ—¶ä¹Ÿæ˜¯æŒ‰ç…§ç¼–å·å¯åŠ¨çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636685547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1027343,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/0f/cac1535a.jpg","nickname":"å¤§æ°´ç‰›","note":"","ucode":"9CF2B21BA75C0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531855,"discussion_content":"åŒç–‘æƒ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637423999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":414190,"ip_address":""},"score":531855,"extra":"{\"user_type\":1}"}]},{"author":{"id":1201009,"avatar":"https://static001.geekbang.org/account/avatar/00/12/53/71/a4e9f20e.jpg","nickname":"è¨€åˆæœ¨æ‰","note":"","ucode":"300BEDC1B07DF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393070,"discussion_content":"Headless Service ä¸»è¦æ˜¯é’ˆå¯¹ statefulSet éƒ¨ç½²çš„æ—¶å€™æå‡ºçš„æ¦‚å¿µï¼Œæœ‰çŠ¶æ€çš„podä¸»è¦æ˜¯æŒ‡ï¼šæ‹“è¡¥å…³ç³»ï¼Œç½‘ç»œï¼Œå­˜å‚¨ã€‚æ¯”å¦‚æœ‰éƒ¨ç½²å…ˆåå…³ç³»çš„podï¼Œæœ‰éœ€è¦ç‰¹æ®Šç»‘å®špodçš„ hostname çš„ç½‘ç»œéœ€æ±‚ï¼Œå†æˆ–è€…è¿™ä¸ªpodçš„å¿…é¡»ç»‘å®šä¸€ä¸ªç‰¹å®šæŒä¹…åŒ–å­˜å‚¨ï¼Œè¿™äº›éƒ½ä¼šç”¨åˆ°æœ‰çŠ¶æ€çš„ statefulSet éƒ¨ç½²ã€‚è€Œæ— çŠ¶æ€åº”ç”¨ï¼Œæ¯”å¦‚webåˆ†å¸ƒå¼åº”ç”¨è¿™äº›ï¼Œä¸åœ¨ä¹æµé‡è½å…¥å“ªä¸ªpodçš„ï¼Œç›´æ¥ç”¨ deployment éƒ¨ç½²å°±è¡Œäº†ã€‚æˆ‘ç†è§£è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨è¿™é‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631240207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29914,"user_name":"åˆ˜æ¬£æ´²","can_delete":false,"product_type":"c1","uid":1020871,"ip_address":"","ucode":"767B7D80D01623","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/c7/1640226d.jpg","comment_is_top":false,"comment_ctime":1538604803,"is_pvip":false,"replies":[{"id":"10757","content":"dnsæ˜¯é»˜è®¤æ’ä»¶ã€‚ä½ æŒ‰æˆ‘å‰é¢çš„éƒ¨ç½²æµç¨‹ã€ä¹Ÿå°±æ˜¯å®˜æ–¹çš„éƒ¨ç½²æµç¨‹ï¼Œæ˜¯å¿…ç„¶æœ‰dnsçš„ã€‚çœ‹çœ‹podåˆ—è¡¨debugä¸€ä¸‹å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538618207,"ip_address":"","comment_id":29914,"utype":1}],"discussion_count":2,"race_medal":0,"score":"61668146947","product_id":100015201,"comment_content":"è®¿é—®ä¸åˆ°å•Š<br>&#47; # nslookup web-0.nginx<br>Server:\t\t10.96.0.10<br>Address:\t10.96.0.10:53<br><br>** server can&#39;t find web-0.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-0.nginx: No answer<br><br>æ˜¯ä¸æ˜¯éœ€è¦DNSæ’ä»¶å•Šï¼Œ è¯¥å¦‚ä½•å¯åŠ¨å‘¢ï¼Ÿ","like_count":15,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425777,"discussion_content":"dnsæ˜¯é»˜è®¤æ’ä»¶ã€‚ä½ æŒ‰æˆ‘å‰é¢çš„éƒ¨ç½²æµç¨‹ã€ä¹Ÿå°±æ˜¯å®˜æ–¹çš„éƒ¨ç½²æµç¨‹ï¼Œæ˜¯å¿…ç„¶æœ‰dnsçš„ã€‚çœ‹çœ‹podåˆ—è¡¨debugä¸€ä¸‹å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538618207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1676966,"avatar":"https://static001.geekbang.org/account/avatar/00/19/96/a6/32a286e0.jpg","nickname":"å¤§é›„","note":"","ucode":"5FCFDD3A940801","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52439,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™æ ·çš„é—®é¢˜ï¼Œä½ åé¢è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574051323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36726,"user_name":"jssfy","can_delete":false,"product_type":"c1","uid":1137238,"ip_address":"","ucode":"F16353CFE607B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/56/115c6433.jpg","comment_is_top":false,"comment_ctime":1541287162,"is_pvip":false,"replies":[{"id":"13035","content":"podé•œåƒæ˜¯ä¸€æ ·ï¼Œä½†å¯åŠ¨podçš„å‘½ä»¤å’Œåˆå§‹åŒ–æµç¨‹å¯ä»¥å®Œå…¨ä¸ä¸€æ ·å•Šã€‚å¯ä»¥å‚è€ƒåé¢çš„å®Œæ•´æ¡ˆä¾‹","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541338720,"ip_address":"","comment_id":36726,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57375862010","product_id":100015201,"comment_content":"é€šè¿‡è¿™ç§æ–¹æ³•ï¼ŒKubernetes å°±æˆåŠŸåœ°å°† Pod çš„æ‹“æ‰‘çŠ¶æ€ï¼ˆæ¯”å¦‚ï¼šå“ªä¸ªèŠ‚ç‚¹å…ˆå¯åŠ¨ï¼Œå“ªä¸ªèŠ‚ç‚¹åå¯åŠ¨ï¼‰ï¼ŒæŒ‰ç…§ Pod çš„â€œåå­— + ç¼–å·â€çš„æ–¹å¼å›ºå®šäº†ä¸‹æ¥ã€‚<br>å¦‚ä¸Šæ‰€è¿°ï¼Œ<br>1. æ˜¯å¦å¯ä»¥è¿™æ ·ç†è§£ï¼šstsåœ¨è¿™é‡Œåªæ˜¯ä¿ç•™äº†â€œåå­— + ç¼–å·â€è¿™ç§ç½‘ç»œèº«ä»½ï¼Œè€Œä¸åŒç½‘ç»œèº«ä»½å¯¹åº”çš„podå…¶å®æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªæ¨¡æ¿replicateå‡ºæ¥çš„ï¼Ÿ<br>2. è¿™é‡Œstsçš„ä¸»è¦æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼šä»…ä»…æ˜¯ä¿è¯ä¸åŒç½‘ç»œèº«ä»½çš„å¯åŠ¨é¡ºåºï¼Ÿ","like_count":14,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427983,"discussion_content":"podé•œåƒæ˜¯ä¸€æ ·ï¼Œä½†å¯åŠ¨podçš„å‘½ä»¤å’Œåˆå§‹åŒ–æµç¨‹å¯ä»¥å®Œå…¨ä¸ä¸€æ ·å•Šã€‚å¯ä»¥å‚è€ƒåé¢çš„å®Œæ•´æ¡ˆä¾‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541338720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44711,"user_name":"Lukri","can_delete":false,"product_type":"c1","uid":1224659,"ip_address":"","ucode":"31495D68FF0897","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/d3/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1543479546,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"35903217914","product_id":100015201,"comment_content":"åŠ ä¸Šnamespaceå°±å¯ä»¥äº†ã€‚<br>&#47; # ping web-0.nginx.default.svc.cluster.local<br>PING web-0.nginx.default.svc.cluster.local (10.44.0.2): 56 data bytes<br>64 bytes from 10.44.0.2: seq=0 ttl=64 time=0.138 ms<br>64 bytes from 10.44.0.2: seq=1 ttl=64 time=0.089 ms<br>64 bytes from 10.44.0.2: seq=2 ttl=64 time=0.091 ms<br>64 bytes from 10.44.0.2: seq=3 ttl=64 time=0.090 ms<br>64 bytes from 10.44.0.2: seq=4 ttl=64 time=0.093 ms<br>64 bytes from 10.44.0.2: seq=5 ttl=64 time=0.128 ms<br>64 bytes from 10.44.0.2: seq=6 ttl=64 time=0.093 ms<br>64 bytes from 10.44.0.2: seq=7 ttl=64 time=0.091 ms<br>^C<br>--- web-0.nginx.default.svc.cluster.local ping statistics ---<br>8 packets transmitted, 8 packets received, 0% packet loss<br>round-trip min&#47;avg&#47;max = 0.089&#47;0.101&#47;0.138 ms<br>&#47; # nslookup web-0.nginx.default.svc.cluster.local<br>Server:    10.96.0.10<br>Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local<br><br>Name:      web-0.nginx.default.svc.cluster.local<br>Address 1: 10.44.0.2 web-0.nginx.default.svc.cluster.local","like_count":9,"discussions":[{"author":{"id":1037514,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d4/ca/bdb348db.jpg","nickname":"law","note":"","ucode":"3B664E2667ED63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":179214,"discussion_content":"æˆ‘ä¹Ÿæ˜¯èƒ½pingï¼Œä½†nslookupä¸è¡Œï¼Œå¥½å¥‡æ€ªã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582210385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2441261,"avatar":"https://static001.geekbang.org/account/avatar/00/25/40/2d/9a766753.jpg","nickname":"éƒ­è´»é“–","note":"","ucode":"B14B1DB14031F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1037514,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d4/ca/bdb348db.jpg","nickname":"law","note":"","ucode":"3B664E2667ED63","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351012,"discussion_content":"ç”¨busybox:1.28.4çš„é•œåƒå°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614096434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":179214,"ip_address":""},"score":351012,"extra":""}]},{"author":{"id":1244496,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM49ONuR097wB6LqR8nn5kWiaQiaPic1y8UznibDOScQergTj5qeL6zQ4bIicYEkqlMiash3CUCAYmSt9tQA/132","nickname":"å“ˆå¸Œç¢°æ’","note":"","ucode":"DF82678E60095D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2608,"discussion_content":"åœ¨podså†…èƒ½pingé€šï¼Œä½†æ˜¯nslookup ä¸è¡Œ.\n\n[root@kube1 ~]# kubectl run -i --tty --image busybox dns-test --restart=Never --rm /bin/sh \n\n/ # ping web-0.nginx.default.svc.cluster.local \nPING web-0.nginx.default.svc.cluster.local (10.0.128.8): 56 data bytes\n64 bytes from 10.0.128.8: seq=0 ttl=64 time=0.417 ms\n64 bytes from 10.0.128.8: seq=1 ttl=64 time=0.225 ms\n64 bytes from 10.0.128.8: seq=2 ttl=64 time=0.188 ms\n^C\n--- web-0.nginx.default.svc.cluster.local ping statistics ---\n3 packets transmitted, 3 packets received, 0% packet loss\nround-trip min/avg/max = 0.188/0.276/0.417 ms\n/ # nslookup web-0.nginx.default.svc.cluster.local\nServer:         10.96.0.10\nAddress:        10.96.0.10:53\n\nName:   web-0.nginx.default.svc.cluster.local\nAddress: 10.0.128.8\n\n*** Can&#39;t find web-0.nginx.default.svc.cluster.local: No answer\n\n/ # \n\n\nåœ¨ç‰©ç†æœºä¸Šå°†DNSåŠ åˆ°/etc/resolv.confï¼Œå°è¯•dig ã€nslookupã€ping ä¸€åˆ‡æ­£å¸¸ã€‚\necho &#39;nameserver 10.96.0.10&#39; >/etc/resolv.conf\n\n[root@kube3 ~]# dig web-0.nginx.default.svc.cluster.local\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-74.el7_6.1 <<>> web-0.nginx.default.svc.cluster.local\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 45306\n;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n;; WARNING: recursion requested but not available\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;web-0.nginx.default.svc.cluster.local. IN A\n\n;; ANSWER SECTION:\nweb-0.nginx.default.svc.cluster.local. 5 IN A   10.0.128.8\n\n;; Query time: 1 msec\n;; SERVER: 10.96.0.10#53(10.96.0.10)\n;; WHEN: Mon Jul 22 17:11:05 CST 2019\n;; MSG SIZE  rcvd: 119\n\n[root@kube3 ~]# \n[root@kube3 ~]# \n[root@kube3 ~]# nslookup web-0.nginx.default.svc.cluster.local\nServer:         10.96.0.10\nAddress:        10.96.0.10#53\n\nNon-authoritative answer:\nName:   web-0.nginx.default.svc.cluster.local\nAddress: 10.0.128.8\n\n[root@kube3 ~]# \n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563786682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29951,"user_name":"Tim Zhang","can_delete":false,"product_type":"c1","uid":1214499,"ip_address":"","ucode":"4956AC5FE45EE1","user_header":"https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg","comment_is_top":false,"comment_ctime":1538614109,"is_pvip":false,"replies":[{"id":"10755","content":"å› ä¸ºæœ‰å¤ªå¤šäººæ˜¯è‡ªå·±æ‹¿äºŒè¿›åˆ¶æ–‡ä»¶DIYéƒ¨ç½²çš„ï¼Œä¸æŒ‰kubeadmçš„æµç¨‹æ¥","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538618046,"ip_address":"","comment_id":29951,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31603385181","product_id":100015201,"comment_content":"æ—¢ç„¶é»˜è®¤æœ‰å®‰è£…dns ä¸ºå•¥è¿˜è¦å¼€å¯dnsæ’ä»¶å‘¢","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425785,"discussion_content":"å› ä¸ºæœ‰å¤ªå¤šäººæ˜¯è‡ªå·±æ‹¿äºŒè¿›åˆ¶æ–‡ä»¶DIYéƒ¨ç½²çš„ï¼Œä¸æŒ‰kubeadmçš„æµç¨‹æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538618046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"æ™æœˆ520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284846,"discussion_content":"æˆ‘æ˜¯äºŒè¿›åˆ¶éƒ¨ç½²çš„ï¼Œç”¨äº†coredns ï¼Œk8s å†…éƒ¨æœåŠ¡å‘ç°å¿…é¡»è¦ç”¨ dns æ¥å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592659548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33716,"user_name":"Plantegg","can_delete":false,"product_type":"c1","uid":1140931,"ip_address":"","ucode":"4C2B78D41C7820","user_header":"https://static001.geekbang.org/account/avatar/00/11/68/c3/8e1a8dbf.jpg","comment_is_top":false,"comment_ctime":1539860476,"is_pvip":false,"replies":[{"id":"12112","content":"busyboxå°±æ˜¯è¿™ä¹ˆåšå‡ºæ¥çš„ï¼Œæ­£å¸¸","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539876008,"ip_address":"","comment_id":33716,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27309664252","product_id":100015201,"comment_content":"é¦–å…ˆbusyboxé•œåƒçš„&#47;bin&#47; ä¸‹å‡ ç™¾ä¸ªå¯æ‰§è¡Œå‘½ä»¤çš„md5ç­¾åéƒ½æ˜¯ä¸€æ ·çš„ã€‚ä¸èƒ½æŒ‰ç…§æ­£å¸¸çš„pingã€nslookupé€»è¾‘æ¥ç†è§£äº†ã€‚ ä¹Ÿå°±æ˜¯md5sum &#47;bin&#47;ping å’Œ md5sum &#47;bin&#47;nslookup ç­¾åä¸€æ ·ï¼Œæˆ‘çŒœæµ‹è¿™ä¸ªå¯æ‰§è¡Œå‘½ä»¤éƒ½æ˜¯ç©ºæ¶å­ï¼Œä¼šè¢«æ‹¦æˆªä¸‹æ¥ã€‚<br>å¦å¤–å°±æ˜¯1.28.4å’Œ1.29.3ï¼ˆlatest) çš„ nslookup ç­¾åä¹Ÿä¸ä¸€æ ·äº†","like_count":7,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427034,"discussion_content":"busyboxå°±æ˜¯è¿™ä¹ˆåšå‡ºæ¥çš„ï¼Œæ­£å¸¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539876008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30011,"user_name":"vx:jiancheng_goon","can_delete":false,"product_type":"c1","uid":1218615,"ip_address":"","ucode":"FD34901B061825","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/37/7f575aec.jpg","comment_is_top":false,"comment_ctime":1538623851,"is_pvip":false,"replies":[{"id":"10793","content":"kubernetes å½“ç„¶å…è®¸ä½ è‡ªå®šä¹‰åŸŸåäº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538648773,"ip_address":"","comment_id":30011,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27308427627","product_id":100015201,"comment_content":"serviceé‡Œçš„dnsä¿¡æ¯æ˜¯å­˜åœ¨etcdé‡Œçš„å˜›ï¼Ÿæœ‰äº›åº”ç”¨çš„podçš„åŸŸåæ˜¯è‡ªå·±å®šä¹‰çš„ã€‚è€Œä¸æ˜¯k8såˆ›å»ºå‡ºæ¥çš„å¸¦æœ‰localçš„åŸŸåã€‚æˆ‘å¯ä»¥æ›´æ”¹serviceé‡Œçš„dnsä¿¡æ¯å˜›ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425813,"discussion_content":"kubernetes å½“ç„¶å…è®¸ä½ è‡ªå®šä¹‰åŸŸåäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538648773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51182,"user_name":"Geek_6bab38","can_delete":false,"product_type":"c1","uid":1261301,"ip_address":"","ucode":"118ED65D80A6B5","user_header":"https://static001.geekbang.org/account/avatar/00/13/3e/f5/ba756775.jpg","comment_is_top":false,"comment_ctime":1545126681,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23019963161","product_id":100015201,"comment_content":"æ•™ç¨‹ä¸­ä¸¤ä¸ªnginxæ˜¯ä¸€å—å¯åŠ¨ï¼š<br>å¦‚æœæ˜¯æœ‰é¡ºåºçš„ï¼Œæ¯”å¦‚rediså…ˆå¯åŠ¨ï¼Œç„¶åå¯åŠ¨åœ¨å¯åŠ¨nginxè¿™æ ·å­ï¼Œéœ€è¦æ€æ ·è®¾ç½®å‘¢","like_count":5,"discussions":[{"author":{"id":1635895,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/dQZH4oEsCUjunqCIs4ls8nujhJKxjyJCibk5aXznM2dK2QdxZgLuZXnUZdjxb8XagD0yEPzXDnqFhoZDtpYIHiag/132","nickname":"Ironshuai","note":"","ucode":"392F5DE3762024","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339329,"discussion_content":"è¿™ä¸ªå¯èƒ½å¾—éœ€è¦è‡ªå·±è®¾è®¡æŒ‰é¡ºåºå¯åŠ¨çš„CRDäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609636992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218285,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/ed/56731acd.jpg","nickname":"ç‘","note":"","ucode":"26F7ABACE0CE69","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294220,"discussion_content":"è¿™ä¸ªå·²ç»è„±ç¦»äº†å®¹å™¨ç¼–æ’çš„èŒƒç•´äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595832783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30957,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1539052750,"is_pvip":false,"replies":[{"id":"11148","content":"è¿™è¯´æ˜ä½ ä¸éœ€è¦é€šè¿‡å¸¦ç¼–å·çš„dnsåå­—è®¿é—®è¿™ä¸ªèŠ‚ç‚¹å‘—ï¼Œæ²¡å•¥å¥‡æ€ªçš„","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539059594,"ip_address":"","comment_id":30957,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23013889230","product_id":100015201,"comment_content":"è¯·æ•™å¼ å¤§ä½¬ï¼Œå½“æˆ‘è·‘jenkins in k8sçš„æ—¶å€™æ˜¯ç”¨çš„statefulsetéƒ¨ç½²çš„jenkinsçš„masterï¼Œæˆ‘å…³è”çš„serviceä½†æ˜¯å´ä¸æ˜¯æ— å¤´æœåŠ¡å•Šï¼Œ  spec.ports æ˜¯ç”¨çš„nodeport  ä¹Ÿæ²¡æœ‰ç”¨clusterIPï¼šnoneè¿™æ ·ã€‚ä½†æ˜¯æ•´ä¸ªæœåŠ¡ä¹Ÿæ˜¯æ­£å¸¸çš„ã€‚è¿™ä¸æ˜¯å’Œä½ è®²çš„statefulsetå¿…é¡»æ˜¯å…³è”headless serviceè¿èƒŒäº†ä¹ˆï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426157,"discussion_content":"è¿™è¯´æ˜ä½ ä¸éœ€è¦é€šè¿‡å¸¦ç¼–å·çš„dnsåå­—è®¿é—®è¿™ä¸ªèŠ‚ç‚¹å‘—ï¼Œæ²¡å•¥å¥‡æ€ªçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539059594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414216,"discussion_content":"ä¹‹å‰é€šè¿‡statefulsetæ­å»ºçš„elasticsearché›†ç¾¤ä¹Ÿæ²¡ç”¨headless serviceï¼Œä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚åƒè€å¸ˆè¯´çš„ï¼Œè¿™æ—¶ä¸éœ€è¦é€šè¿‡å¸¦ç¼–å·çš„dnsåå­—è®¿é—®èŠ‚ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636693213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29813,"user_name":"å…½åŒ»","can_delete":false,"product_type":"c1","uid":1182170,"ip_address":"","ucode":"F6C3ADAA409245","user_header":"https://static001.geekbang.org/account/avatar/00/12/09/da/2fbd0760.jpg","comment_is_top":false,"comment_ctime":1538551133,"is_pvip":false,"replies":[{"id":"10742","content":"å½“ç„¶","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613746,"ip_address":"","comment_id":29813,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23013387613","product_id":100015201,"comment_content":"è¯·é—®å½“éœ€è¦å¯¹StatefulSetè¿›è¡Œç¼©å®¹åï¼Œå†æ‰©å®¹åˆ°åŸæœ‰è§„æ¨¡ã€‚åœ¨æ¶‰åŠå˜åŠ¨çš„Podä¸­ï¼ŒçŠ¶æ€ä¹Ÿä¼šè¢«ä¿æŒå—ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425726,"discussion_content":"å½“ç„¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538613746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29775,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1538537814,"is_pvip":false,"replies":[{"id":"10740","content":"æ»šåŠ¨æ›´æ–°çš„ç»“æœä¸€å®šæ˜¯ç‰ˆæœ¬ä¸€æ ·ï¼Œä½ è¯´çš„è¿™ä¸ªçŠ¶æ€åªå¯èƒ½æ˜¯ä¸­é—´çŠ¶æ€","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613705,"ip_address":"","comment_id":29775,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23013374294","product_id":100015201,"comment_content":"æ‚¨å¥½ã€‚æ»šåŠ¨å‡çº§çš„æ—¶å€™ï¼Œå¦‚æœæ–°çš„web-0å’Œè€çš„web-2åŒæ—¶readyï¼Œä½†æ–°è€ç‰ˆæœ¬ä¸å…¼å®¹æ€ä¹ˆåŠï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425713,"discussion_content":"æ»šåŠ¨æ›´æ–°çš„ç»“æœä¸€å®šæ˜¯ç‰ˆæœ¬ä¸€æ ·ï¼Œä½ è¯´çš„è¿™ä¸ªçŠ¶æ€åªå¯èƒ½æ˜¯ä¸­é—´çŠ¶æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538613705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95298,"user_name":"Rodinian","can_delete":false,"product_type":"c1","uid":1096181,"ip_address":"","ucode":"10A4E6138B838A","user_header":"https://static001.geekbang.org/account/avatar/00/10/b9/f5/ffc2bb23.jpg","comment_is_top":false,"comment_ctime":1558013397,"is_pvip":false,"replies":[{"id":"36302","content":"serviceéƒ¨åˆ†ä¼šè®²è§£","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1559619346,"ip_address":"","comment_id":95298,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18737882581","product_id":100015201,"comment_content":"ä¸€ç›´å¾ˆå¥½å¥‡ï¼Œnormal serviceå’Œheadless serviceéƒ½å¯ä»¥æŒ‡å®šDNS nameã€‚é‚£ä¸¤è€…çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450407,"discussion_content":"serviceéƒ¨åˆ†ä¼šè®²è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559619346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57780,"user_name":"å‡Œ","can_delete":false,"product_type":"c1","uid":1257995,"ip_address":"","ucode":"41369B360C794F","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/0b/81ae214b.jpg","comment_is_top":false,"comment_ctime":1546909689,"is_pvip":false,"replies":[{"id":"20978","content":"ipæ”¹æˆç”¨service vipæˆ–è€…dnsåå­—å³å¯","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1547019327,"ip_address":"","comment_id":57780,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18726778873","product_id":100015201,"comment_content":"æˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯é€šè¿‡å›ºå®šip+tcpçš„æ–¹å¼è®¿é—®çš„ï¼Œå¦‚æœæŒ‰ç…§kubernetesçš„ç†å¿µåº”è¯¥æ¯æ¬¡å…ˆç”¨æœåŠ¡å‘½å–å¾—ä¸€æ¬¡ipåœ¨å»ºè¿è®¿é—®ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435756,"discussion_content":"ipæ”¹æˆç”¨service vipæˆ–è€…dnsåå­—å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547019327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005431,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/77/046d310b.jpg","nickname":"æ˜æœˆå‡º","note":"","ucode":"F61BC34FDA802D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389264,"discussion_content":"è¿˜æœ‰ç”¨å›ºå®šIPçš„ï¼ŸIPå˜æ›´çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿæ‰€æœ‰æœåŠ¡æ›¿æ¢æ–°IPå—ï¼ŸåŸŸåå¤šçˆ½å•Šæ”¹ä¸ªè§£æå°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629196465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1027343,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/0f/cac1535a.jpg","nickname":"å¤§æ°´ç‰›","note":"","ucode":"9CF2B21BA75C0D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1005431,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/77/046d310b.jpg","nickname":"æ˜æœˆå‡º","note":"","ucode":"F61BC34FDA802D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531858,"discussion_content":"redis- clusterå°±å¾—ç»‘å®šç›‘å¬ip","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637424334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":389264,"ip_address":""},"score":531858,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":30210,"user_name":"vx:jiancheng_goon","can_delete":false,"product_type":"c1","uid":1218615,"ip_address":"","ucode":"FD34901B061825","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/37/7f575aec.jpg","comment_is_top":false,"comment_ctime":1538726985,"is_pvip":false,"replies":[{"id":"10903","content":"è‡ªå·±ç¼–å†™ç½‘ç»œæ’ä»¶ã€‚ä¸ºä»€ä¹ˆä¸èƒ½ç”¨è¿™ä¸ªå›ºå®šçš„DNSåå­—æ›¿ä»£IPï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538794804,"ip_address":"","comment_id":30210,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18718596169","product_id":100015201,"comment_content":"æ¯æ¬¡podè¢«é‡æ–°åˆ›å»ºåï¼Œéƒ½èƒ½å¤Ÿä¿è¯åŸæ¥çš„ç½‘ç»œæ ‡ç¤ºï¼Œé‚£æœ‰ä»€ä¹ˆåŠæ³•ï¼Œèƒ½å¤Ÿå›ºå®šipå‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425897,"discussion_content":"è‡ªå·±ç¼–å†™ç½‘ç»œæ’ä»¶ã€‚ä¸ºä»€ä¹ˆä¸èƒ½ç”¨è¿™ä¸ªå›ºå®šçš„DNSåå­—æ›¿ä»£IPï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538794804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34300,"user_name":"zoroyouxi","can_delete":false,"product_type":"c1","uid":1224745,"ip_address":"","ucode":"E0F0B0C5AAEBDF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIacvl2hoQU10YHABicE8cTu2IKiagWw9wXPiaRcvJfF1tL2ticJVzHGqd7LmTaDuIScvPDhhMOucjUtg/132","comment_is_top":false,"comment_ctime":1540093308,"is_pvip":false,"replies":[{"id":"12250","content":"å› ä¸ºå®ƒä¹Ÿä¾èµ–äºå®¹å™¨è‡ªåŠ¨é‡å¯æ¥æ¢å¤å®ä¾‹çŠ¶æ€ã€‚stså…¶å®å°±æ˜¯ä¸ªæ”¹é€ åçš„deploymentã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540103679,"ip_address":"","comment_id":34300,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14424995196","product_id":100015201,"comment_content":"å®è·µä¸­æœ‰ä¸€ç‚¹ç–‘é—®ï¼Œæ—¢ç„¶stsæ˜¯podçš„å®é™…æ‰€æœ‰è€…å¹¶ä¸ç»è¿‡rsï¼Œé‚£ä¸ºä»€ä¹ˆstså£°æ˜ä¸‹çš„podçš„restartpolicyä¹Ÿåªèƒ½è®¾ç½®æˆalwayså‘¢?å¸Œæœ›å¼ è€å¸ˆè§£ç­”è°¢è°¢","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427168,"discussion_content":"å› ä¸ºå®ƒä¹Ÿä¾èµ–äºå®¹å™¨è‡ªåŠ¨é‡å¯æ¥æ¢å¤å®ä¾‹çŠ¶æ€ã€‚stså…¶å®å°±æ˜¯ä¸ªæ”¹é€ åçš„deploymentã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540103679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32018,"user_name":"rnn","can_delete":false,"product_type":"c1","uid":1169811,"ip_address":"","ucode":"9DC14B9DCF477D","user_header":"https://static001.geekbang.org/account/avatar/00/11/d9/93/43c876e8.jpg","comment_is_top":false,"comment_ctime":1539385009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14424286897","product_id":100015201,"comment_content":"eureka éœ€è¦ç”¨åˆ°stateful set","like_count":4},{"had_liked":false,"id":29849,"user_name":"Tim Zhang","can_delete":false,"product_type":"c1","uid":1214499,"ip_address":"","ucode":"4956AC5FE45EE1","user_header":"https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg","comment_is_top":false,"comment_ctime":1538560978,"is_pvip":false,"replies":[{"id":"10743","content":"kubernetesçš„dnsæ—©å°±å·²ç»æ˜¯é»˜è®¤å®‰è£…çš„äº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613790,"ip_address":"","comment_id":29849,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14423462866","product_id":100015201,"comment_content":"statefulseté€šè¿‡dnsè®¿é—®pod æ˜¯å¦å¿…é¡»è¦å¯åŠ¨dnsæ’ä»¶ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425738,"discussion_content":"kubernetesçš„dnsæ—©å°±å·²ç»æ˜¯é»˜è®¤å®‰è£…çš„äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538613790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29777,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1538537919,"is_pvip":false,"replies":[{"id":"10741","content":"ç”¨æˆ·è®¿é—®serviceç¬¬ä¸€æ­¥ç¢°åˆ°çš„ä¸œè¥¿","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613736,"ip_address":"","comment_id":29777,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14423439807","product_id":100015201,"comment_content":"serviceæ²¡æœ‰VIPä½œä¸ºå¤´ã€‚è¿™ä¸ªå¤´åˆ°åº•æ€ä¹ˆç†è§£å‘¢ï¼Ÿè¿˜æ˜¯ä¸å¤ªæ‡‚ä»€ä¹ˆæ˜¯å¤´ã€‚","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425714,"discussion_content":"ç”¨æˆ·è®¿é—®serviceç¬¬ä¸€æ­¥ç¢°åˆ°çš„ä¸œè¥¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538613736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198354,"user_name":"Geek__5a7058c04741","can_delete":false,"product_type":"c1","uid":1459027,"ip_address":"","ucode":"2935CC8CEFD8D6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq5t5gxISDXa8kQ4enCotKzZfP12U52slq73MApKAy4hVq8y9uoqxmr23zRAEptHSMtBDySAsxl0g/132","comment_is_top":false,"comment_ctime":1585446973,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10175381565","product_id":100015201,"comment_content":"kubectl run -it --image busybox:1.28.4 dns-test --restart=Never --rm &#47;bin&#47;sh<br>è¿è¡Œè¿™ä¸ªå¯ä»¥æ­£å¸¸è§£æ","like_count":2},{"had_liked":false,"id":57174,"user_name":"å°è¥¿å‡ ","can_delete":false,"product_type":"c1","uid":1286375,"ip_address":"","ucode":"ED1DDE17534508","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjzTQ6HPGw2LWLiaiciaibfdMMlmxEwBkBjxOPxeYynZlBKCf6U1b0ezM9IZYibB6yKR7HpRuAOdtj29Q/132","comment_is_top":false,"comment_ctime":1546672128,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10136606720","product_id":100015201,"comment_content":"è¯´ä¸€ä¸ªæˆ‘çš„ç»éªŒå“ˆ:<br><br>ç¯å¢ƒ(ä¸€ä¸ªmaster, ä¸€ä¸ªnode, coredns)<br>1. busyboxçš„ç‰ˆæœ¬è¦æ§åˆ¶åœ¨1.28.4ä»¥ä¸‹  <br> kubectl run -i --tty --image busybox:1.28.4 dns-test --restart=Never --rm &#47;bin&#47;sh  <br>2. ä¸»ä»èŠ‚ç‚¹æ—¶é—´è¦ä¸€è‡´  <br>3. ä»èŠ‚ç‚¹æ‹·è´ä¸»èŠ‚ç‚¹çš„admin.confæ–‡ä»¶åˆ°ä»èŠ‚ç‚¹  <br>4. é‡å¯kubelet docker  <br>å®Œäº†ä¹‹åå‘ç° ä¸¤å¤©è§£æä¸åˆ°çš„dns ç«Ÿç„¶æˆåŠŸäº† ????","like_count":2,"discussions":[{"author":{"id":1069133,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg","nickname":"sam700000","note":"","ucode":"C2ABDDC56B2D50","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4746,"discussion_content":"å¤šè°¢ï¼Œæˆ‘ç›´æ¥é‡å¯ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œç„¶åé‡è£…pluginå°±å¥½äº†ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¹‹å‰æ›´æ”¹å†…æ ¸çš„net.bridge.bridge-nf-call-iptableséœ€è¦é‡å¯æ‰è¡Œâ€¦ æˆ‘è§‰å¾—æ˜¯å’Œè¿™ä¸ªæˆ–è€…æ˜¯æŸä¸ªé…ç½®éœ€è¦é‡å¯æœ‰å…³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565701350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34504,"user_name":"å¾éª‹","can_delete":false,"product_type":"c1","uid":1223167,"ip_address":"","ucode":"92B63EEE5BB0C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/ff/6b0260e1.jpg","comment_is_top":false,"comment_ctime":1540193277,"is_pvip":false,"replies":[{"id":"12358","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540260611,"ip_address":"","comment_id":34504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10130127869","product_id":100015201,"comment_content":"æ—¢ç„¶Headless serviceæ²¡æœ‰VIPï¼Œæ˜¯ä¸æ˜¯è¯´åªèƒ½åœ¨Kuberneteså†…éƒ¨è®¿é—®é€šè¿‡service nameå®ƒï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427231,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540260611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34453,"user_name":"Pixar","can_delete":false,"product_type":"c1","uid":1197659,"ip_address":"","ucode":"E653387BA8EA16","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/5b/07858c33.jpg","comment_is_top":false,"comment_ctime":1540176839,"is_pvip":false,"replies":[{"id":"12363","content":"ä¸»æ˜¯æ­£å¸¸çš„å½“ç„¶ä¸ç”¨ã€‚é‡å¯å–å†³äºä¸»æ˜¯ä¸æ˜¯è¿›å…¥å¼‚å¸¸äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540260792,"ip_address":"","comment_id":34453,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10130111431","product_id":100015201,"comment_content":"å¼ è€å¸ˆ, è¿˜æ˜¯æœ‰ä¸ªç–‘é—® &quot;statefulsetä¸­çš„pod templateéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£æ¯”å¦‚è¯´å¯¹äºä¸»ä»ç»“æ„ï¼Œåº”ç”¨å¦‚ä½•çŸ¥é“è‡ªå·±æ˜¯ä¸»è¿˜æ˜¯ä»å‘¢ï¼Ÿè€Œä¸”ä¸€æ—¦ä»æŒ‚æ‰äº†ï¼Œä¸ºäº†ä¿è¯å¯åŠ¨é¡ºåºï¼Œä¸»ä¹Ÿè¦é‡å¯ï¼Ÿ&quot;  è¿™ä¸ªé—®é¢˜æ‚¨çš„å›ç­”æ˜¯ ä¸»ä¹Ÿè¦é‡å¯. æœ‰ä¸€ä¸ªç–‘é—®, ä¸ºä»€ä¹ˆä¸»ä¹Ÿè¦é‡å¯, ä¸»æ˜¯å¥½çš„å‘€ RUNNING &amp;&amp; Ready, è¿™ä¸ªæ—¶å€™æ»¡è¶³äº†ä»çš„å¯åŠ¨æ¡ä»¶, ä»ç›´æ¥å¯åŠ¨ä¸å°±å¥½äº†å—? ä¸ºä»€ä¹ˆä¸»ä¹Ÿè¦è·Ÿç€å¯åŠ¨ä¸€æ¬¡?","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427214,"discussion_content":"ä¸»æ˜¯æ­£å¸¸çš„å½“ç„¶ä¸ç”¨ã€‚é‡å¯å–å†³äºä¸»æ˜¯ä¸æ˜¯è¿›å…¥å¼‚å¸¸äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540260792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354909,"discussion_content":"ä¸»å¼‚å¸¸äº†çš„è¯ï¼Œä»è¦è·Ÿç€é‡å¯å—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615360238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30099,"user_name":"åŒ—å¡","can_delete":false,"product_type":"c1","uid":1218128,"ip_address":"","ucode":"2D947A61689FC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/50/bde525b1.jpg","comment_is_top":false,"comment_ctime":1538661629,"is_pvip":false,"replies":[{"id":"10846","content":"å…·ä½“æ›´æ–°å“ªä¸ªpodï¼Œæ§åˆ¶å¾ªç¯ä¼šå†³å®šã€‚å¦‚æœåªæ˜¯åˆ é™¤æ“ä½œï¼Œé‚£è‚¯å®šé‡å»ºå½“å‰çš„podå°±å¤Ÿäº†ã€‚ä½†ä½ çš„podçš„å¯åŠ¨å‘½ä»¤è¦éœ€è¦åŒºåˆ†ç¬¬ä¸€æ¬¡å¯åŠ¨å’Œé‡å¯ï¼Œä¸‹ä¸€èŠ‚ä¼šè®²ã€‚è¿™å°±æ˜¯headless serviceè·Ÿnormal serviceçš„ä¸åŒã€‚æ‰€ä»¥ä½ å¿…ç„¶è¦ç”¨etcd-0.etcdã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538694120,"ip_address":"","comment_id":30099,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10128596221","product_id":100015201,"comment_content":"æœ‰ä¸¤ç‚¹ä¸å¤ªæ˜ç™½çš„ï¼Œè¯·æ•™ä¸€ä¸‹ã€‚<br>â€œä»»ä½•podçš„å˜åŒ–éƒ½ä¼šè§¦å‘ä¸€æ¬¡statefulsetçš„æ»šåŠ¨æ›´æ–°ã€‚â€<br>è¿™å¥è¯æ€ä¹ˆç†è§£å‘¢ï¼Ÿå®é™…ä½¿ç”¨ä¸Šï¼Œæ¯”å¦‚æˆ‘ç”¨statefulsetåˆ›å»ºäº†ä¸€ä¸ª3ä¸ªpodçš„etcdé›†ç¾¤ï¼Œæˆ‘åˆ æ‰etcd-1,etcd-1ä¼šé©¬ä¸Šé‡æ–°å¯åŠ¨ï¼Œä½†etcd-0å’Œetcd-2å¹¶ä¸ä¼šè¢«åˆ æ‰é‡å»ºå•Šã€‚<br><br>headless serveræ˜¯ä¸æ˜¯åªé€‚åˆäºè¿™ç§ç”¨æ¥åšé›†ç¾¤èŠ‚ç‚¹çš„å‘ç°ä½¿ç”¨ï¼Œä¸é€‚åˆåƒserviceé‚£æ ·ç”¨æ¥å¼€æ”¾æœåŠ¡è®¿é—®ï¼Ÿ<br>ç”¨nslookupæ¥æŸ¥çœ‹headless server, nslookup etcd, ä¼šè¿”å›3ä¸ªå¯¹åº”podçš„ipåœ°å€ï¼Œ ä½†ç›´æ¥å»ping etcdçš„è¯ï¼Œæ¯æ¬¡éƒ½ä¼šè¿”å›åŒä¸€ä¸ªpodçš„ipåœ°å€ï¼Œå…¶ä»–ä¸¤ä¸ªåœ°å€æ°¸è¿œä¸ä¼šè¢«pingåˆ°ã€‚<br>é‚£æˆ‘å»ºç«‹é›†ç¾¤çš„æ—¶å€™ï¼Œå»å‘ç°èŠ‚ç‚¹çš„ipæ—¶ï¼Œæ˜¯ä¸æ˜¯å°±ä¸èƒ½ç›´æ¥ç®€å•é…ç½®ä¸ºetcdäº†å‘¢ï¼Œè€Œè¦é…ç½®etcd-0.etcd, etcd-1.etcdè¿™æ ·æ¯ä¸ªéƒ½å»é…ç½®å‘¢ï¼Ÿ<br><br>","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425854,"discussion_content":"å…·ä½“æ›´æ–°å“ªä¸ªpodï¼Œæ§åˆ¶å¾ªç¯ä¼šå†³å®šã€‚å¦‚æœåªæ˜¯åˆ é™¤æ“ä½œï¼Œé‚£è‚¯å®šé‡å»ºå½“å‰çš„podå°±å¤Ÿäº†ã€‚ä½†ä½ çš„podçš„å¯åŠ¨å‘½ä»¤è¦éœ€è¦åŒºåˆ†ç¬¬ä¸€æ¬¡å¯åŠ¨å’Œé‡å¯ï¼Œä¸‹ä¸€èŠ‚ä¼šè®²ã€‚è¿™å°±æ˜¯headless serviceè·Ÿnormal serviceçš„ä¸åŒã€‚æ‰€ä»¥ä½ å¿…ç„¶è¦ç”¨etcd-0.etcdã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538694120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194261,"user_name":"Geek_c22199","can_delete":false,"product_type":"c1","uid":1441876,"ip_address":"","ucode":"1CE5B65513E360","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2vn8hyjICTCletGs0omz28lhriaZKX2XX9icYzAEon2IEoRnlXqyOia2bEPP0j7T6xexTnr77JJic8w/132","comment_is_top":false,"comment_ctime":1585043244,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880010540","product_id":100015201,"comment_content":"ç¬¬äºŒéçœ‹äº†ï¼Œå¾ˆè½»æ¾so easy ","like_count":1},{"had_liked":false,"id":63214,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1548299807,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5843267103","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘åœ¨busyboxæŸ¥çœ‹statefulsetçš„ä¸¤ä¸ªå®¹å™¨web-0ï¼Œ web-1ï¼Œçš„åœ°å€è§£æ<br>&#47; # nslookup web-0.nginx.test.svc.cluster.local<br>Server:\t\t10.62.45.10<br>Address:\t10.62.45.10:53<br><br>Name:\tweb-0.nginx.test.svc.cluster.local<br>Address: 10.128.31.25<br><br>*** Can&#39;t find web-0.nginx.test.svc.cluster.local: No answer<br><br>&#47; # ^C<br>&#47; # nslookup web-1.nginx.test.svc.cluster.local<br>Server:\t\t10.62.45.10<br>Address:\t10.62.45.10:53<br><br>Name:\tweb-1.nginx.test.svc.cluster.local<br>Address: 10.128.177.140<br><br>*** Can&#39;t find web-1.nginx.test.svc.cluster.local: No answer<br>è¿™ä¸ªæ˜¯åˆ°åº•æ˜¯è§£æå‡ºæ¥äº†è¿˜æ˜¯æ²¡è§£æå‡ºæ¥å•Š","like_count":1,"discussions":[{"author":{"id":1224659,"avatar":"https://static001.geekbang.org/account/avatar/00/12/af/d3/abb7bfe3.jpg","nickname":"Lukri","note":"","ucode":"31495D68FF0897","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":117475,"discussion_content":"ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æœ‰coredns podã€‚æˆ‘å°±æ˜¯masterèŠ‚ç‚¹ä¸Šæ²¡æœ‰corednsã€‚ç„¶åbusyboxèµ·åœ¨masterèŠ‚ç‚¹ä¸Šäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578119549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46936,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1305633,"ip_address":"","ucode":"338BA720880E4F","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg","comment_is_top":false,"comment_ctime":1544004571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5838971867","product_id":100015201,"comment_content":"busybox  latestçš„è¿™ä¸ªæ ‡ç­¾ç¡®å®ä¸èƒ½æ­£å¸¸è§£æï¼Œæ”¹æˆ1.28.4å°±å¯ä»¥æ­£å¸¸è§£æã€‚æ€ªäº†ã€‚","like_count":1},{"had_liked":false,"id":31368,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1539162045,"is_pvip":false,"replies":[{"id":"11288","content":"statefulset è¿˜ç»™podç¼–å·äº†ï¼Œè¿™å°±æ˜¯æ‹“æ‰‘çŠ¶æ€å•Š","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539173698,"ip_address":"","comment_id":31368,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834129341","product_id":100015201,"comment_content":"è¯·é—®ï¼Œâ€œæœ‰çŠ¶æ€çš„æ˜¯pvï¼Œä¸æ˜¯å‰¯æœ¬æ§åˆ¶å™¨ï¼Œstatefulsetä¸ç”¨pvåˆ›å»ºçš„podæ˜¯æ— çŠ¶æ€â€è¿™å¥è¯æ˜¯å¯¹çš„ä¹ˆï¼Ÿ  æ˜¯ä¸æ˜¯å…¶å®statefulsetæ˜¯æ— çŠ¶æ€çš„ï¼Œå…¶å®æ˜¯ç»™æœ‰çŠ¶æ€çš„æœåŠ¡æ‰©å®¹å’Œä¼¸ç¼©ï¼Ÿ é‚£ä¹ˆinitcontainerå…¶å®åªæ˜¯ç»´æŠ¤äº†æœ‰çŠ¶æ€æœåŠ¡çš„æ‹“æ‰‘çŠ¶æ€ï¼Ÿ<br><br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426309,"discussion_content":"statefulset è¿˜ç»™podç¼–å·äº†ï¼Œè¿™å°±æ˜¯æ‹“æ‰‘çŠ¶æ€å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539173698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30555,"user_name":"huan","can_delete":false,"product_type":"c1","uid":1012286,"ip_address":"","ucode":"46CB95F6E4E5FF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/3e/534db55d.jpg","comment_is_top":false,"comment_ctime":1538921720,"is_pvip":false,"replies":[{"id":"11064","content":"serviceéƒ¨åˆ†è®²è§£å¯ä»¥å…³æ³¨ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998817,"ip_address":"","comment_id":30555,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833889016","product_id":100015201,"comment_content":"å…³äºnslookupæ— æ³•è§£æçš„é—®é¢˜ï¼Œdebugäº†ä¸‹dnspodçš„logã€‚ä½¿ç”¨å‘½ä»¤ `kubectl logs -f kube-dns-86f4d74b45-28xdg kubedns -n kube-system` æ¥ç›‘è§†dns podçš„logã€‚<br>å½“ `kubectl delete -f svc.yaml` çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªlogå‡ºç°ï¼š<br>`I1007 14:12:32.818523       1 dns.go:555] Could not find endpoints for service &quot;nginx&quot; in namespace &quot;default&quot;. DNS records will be created once endpoints show up.`<br>æœŸå¾…è¿™ä¸ªé—®é¢˜ä¼šéšç€k8sçš„å­¦ä¹ æ·±å…¥å¾—åˆ°è§£å†³ã€‚<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426035,"discussion_content":"serviceéƒ¨åˆ†è®²è§£å¯ä»¥å…³æ³¨ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30377,"user_name":"huan","can_delete":false,"product_type":"c1","uid":1012286,"ip_address":"","ucode":"46CB95F6E4E5FF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/3e/534db55d.jpg","comment_is_top":false,"comment_ctime":1538816186,"is_pvip":false,"replies":[{"id":"10997","content":"çœ‹çœ‹dns podçš„logï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538876584,"ip_address":"","comment_id":30377,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833783482","product_id":100015201,"comment_content":"åŒæ¥¼ä¸Šçš„é—®é¢˜ï¼Œæˆ‘è¿™é‡Œæ˜¯æŒ‰ç…§kubeadmå®‰è£…çš„ï¼ˆkube-systemä¸­ä¹Ÿæ·»åŠ äº†weave-netï¼‰ï¼Œä½†æ˜¯nslookupä¹Ÿæ˜¯æŠ¥é”™ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚<br><br>ä¸è¿‡æˆ‘åœ¨dsn-testçš„podä¸­è¿è¡Œ `ping web-1.nginx` æˆ–è€… `ping web-1.nginx.default.svc.cluster.local` éƒ½æ˜¯å¯ä»¥æ‰¾å¾—åˆ°å¯¹åº”çš„ipçš„ã€‚","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425967,"discussion_content":"çœ‹çœ‹dns podçš„logï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538876584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30365,"user_name":"extraterrestrialï¼ï¼","can_delete":false,"product_type":"c1","uid":1017987,"ip_address":"","ucode":"74AE07CA68F6B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/GDYkD2X7pXSKUSaUFC8u3TBPaakaibnOBV2NYDc2TNfb8Su9icFMwSod6iaQX5iaGU2gT6xkPuhXeWvY8KaVEZAYzg/132","comment_is_top":false,"comment_ctime":1538809552,"is_pvip":true,"replies":[{"id":"10974","content":"çœ‹åé¢çš„å®è·µéƒ¨ä»½","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538840059,"ip_address":"","comment_id":30365,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833776848","product_id":100015201,"comment_content":"æœ‰åŒæ ·çš„é—®é¢˜ï¼Œstatefulsetçš„templateé…ç½®æ²¡æœ‰æŒ‡å®šä¸»ä»çš„é€‰é¡¹ï¼Œè¦æ€ä¹ˆé…ç½®ä¸»ä»ï¼Ÿ æ¯”å¦‚é…ä¸€ä¸ªredisçš„ä¸»ä»ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425960,"discussion_content":"çœ‹åé¢çš„å®è·µéƒ¨ä»½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538840059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29850,"user_name":"Tim Zhang","can_delete":false,"product_type":"c1","uid":1214499,"ip_address":"","ucode":"4956AC5FE45EE1","user_header":"https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg","comment_is_top":false,"comment_ctime":1538561006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5833528302","product_id":100015201,"comment_content":"é€šè¿‡dnsè®¿é—® å¿…é¡»å¼€å¯dnsæ’ä»¶å—","like_count":1},{"had_liked":false,"id":29752,"user_name":"å°å°ç¬‘å„¿","can_delete":false,"product_type":"c1","uid":1040354,"ip_address":"","ucode":"CA63CC50DC2091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/e2/823a04b4.jpg","comment_is_top":false,"comment_ctime":1538530539,"is_pvip":false,"replies":[{"id":"10738","content":"å½“ç„¶","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538613613,"ip_address":"","comment_id":29752,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833497835","product_id":100015201,"comment_content":"statefulsetä¸­çš„pod templateéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£æ¯”å¦‚è¯´å¯¹äºä¸»ä»ç»“æ„ï¼Œåº”ç”¨å¦‚ä½•çŸ¥é“è‡ªå·±æ˜¯ä¸»è¿˜æ˜¯ä»å‘¢ï¼Ÿè€Œä¸”ä¸€æ—¦ä»æŒ‚æ‰äº†ï¼Œä¸ºäº†ä¿è¯å¯åŠ¨é¡ºåºï¼Œä¸»ä¹Ÿè¦é‡å¯ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425702,"discussion_content":"å½“ç„¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538613613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29741,"user_name":"asdf100","can_delete":false,"product_type":"c1","uid":1043738,"ip_address":"","ucode":"39D8D71453E575","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/ce7f7d54.jpg","comment_is_top":false,"comment_ctime":1538528336,"is_pvip":false,"replies":[{"id":"10705","content":"serviceç›¸å…³è§åé¢è®²è§£","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538541089,"ip_address":"","comment_id":29741,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833495632","product_id":100015201,"comment_content":"é‚£ä¹ˆä¸¤ç§serviceæ¨¡å¼åº”ç”¨åœºæ™¯é€šå¸¸æœ‰å“ªäº›ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425699,"discussion_content":"serviceç›¸å…³è§åé¢è®²è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538541089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333667,"user_name":"Geek_a121ad","can_delete":false,"product_type":"c1","uid":1476022,"ip_address":"","ucode":"C102E85AE5F457","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIRiaWicYyZvuH6ROCAsbRjzGYVAvsGbLCUfcII5x3Z8SxhxPBEqm434g1TEUxhCztTJrJ7aR1068rw/132","comment_is_top":false,"comment_ctime":1644464325,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644464325","product_id":100015201,"comment_content":"å¦‚æœæ˜¯headlessä»£ç†çš„deploymentçš„æ–¹å¼ï¼Œdig myPodName.myService.myNameSpace.svc.cluster.localè§£æä¸åˆ°è®°å½•ã€‚","like_count":1},{"had_liked":false,"id":330057,"user_name":"æ— åæ— å§“","can_delete":false,"product_type":"c1","uid":2621412,"ip_address":"","ucode":"487BD5AA2CD305","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/e4/927547a9.jpg","comment_is_top":false,"comment_ctime":1641779415,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641779415","product_id":100015201,"comment_content":"ä¹Ÿå°±æ˜¯è¯´é€šè¿‡DNSè¿›è¡Œæ ‡è¯†æœ‰çŠ¶æ€çš„æœåŠ¡","like_count":0},{"had_liked":false,"id":329826,"user_name":"Chino","can_delete":false,"product_type":"c1","uid":1347181,"ip_address":"","ucode":"0240D89E5F74B4","user_header":"https://static001.geekbang.org/account/avatar/00/14/8e/6d/c68e07ef.jpg","comment_is_top":false,"comment_ctime":1641555498,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1641555498","product_id":100015201,"comment_content":"k8s 1.23.1<br>å‰é¢ä¸€ç›´è‹¦äºnslookup: can&#39;t resolve &#39;web-0.nginx&#39;<br><br>æ‰¾äº†ä¸€ç•ªè§£å†³äº†ã€‚ æ˜¯corednsçš„é—®é¢˜<br>å¯ä»¥å…ˆé€šè¿‡kubectl logs coredns-bf74ffdcb-2gklm -n kube-systemï¼ˆæ›¿æ¢è‡ªå·±çš„podï¼‰<br>çœ‹corednsçš„æ—¥å¿—ã€‚æˆ‘è¿™é‡Œæ˜¾ç¤ºè¶…æ—¶äº†<br>[ERROR] plugin&#47;errors: 2 2444215914457103011.8452912407871087454. HINFO: read udp 10.32.0.3:36779-&gt;183.60.83.19:53: i&#47;o timeout<br>äºæ˜¯æˆ‘é‡å¯äº†ä¸€æ³¢corednsï¼Œç”¨kubectl rollout restart deployment corednsï¼ˆæ›¿æ¢è‡ªå·±çš„deploymentï¼‰<br>æ¥ç€å°±å¥½äº†","like_count":1,"discussions":[{"author":{"id":1125834,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","nickname":"fomy","note":"","ucode":"CD87EA03B1F327","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560978,"discussion_content":"kubectl rollout restart deployment coredns -n kube-system","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649506535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525420,"avatar":"https://static001.geekbang.org/account/avatar/00/17/46/ac/9c324436.jpg","nickname":"æŠ–è…¿å† å†›","note":"","ucode":"66162C20658284","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550493,"discussion_content":"å¤šè°¢å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644568202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329358,"user_name":"å­™åŒå­¦","can_delete":false,"product_type":"c1","uid":1676238,"ip_address":"","ucode":"C6C82400D15336","user_header":"https://static001.geekbang.org/account/avatar/00/19/93/ce/092acd6a.jpg","comment_is_top":false,"comment_ctime":1641300262,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641300262","product_id":100015201,"comment_content":"ä¸¤ä¸ªpodæ˜¯ä¸€æ ·çš„ ä¿æŒé¡ºåºæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢","like_count":0},{"had_liked":false,"id":315105,"user_name":"é™ˆæ–¯ä½³","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1633688987,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633688987","product_id":100015201,"comment_content":"ç¬¬åå…«è¯¾:æ·±å…¥ç†è§£StatefulSetï¼ˆä¸€ï¼‰:æ‹“æ‰‘çŠ¶æ€<br>é€šè¿‡æ”¹è‰¯deployment,å½¢æˆäº†å¦ä¸€ä¸ªå¯ä»¥ç”¨äºâ€œæœ‰çŠ¶æ€â€åº”ç”¨çš„éƒ¨ç½²çš„æ§åˆ¶å™¨:StatefulSet.å®ƒé€šè¿‡Headless serviceçš„æ–¹å¼ä¸ºæ¯ä¸ªPodåˆ›å»ºäº†ä¸€ä¸ªå›ºå®šçš„DNSè®°å½•ï¼Œæ¥ä½œä¸ºè®¿é—®è·¯å£","like_count":0},{"had_liked":false,"id":314898,"user_name":"ç«å¨ƒå„¿","can_delete":false,"product_type":"c1","uid":1252132,"ip_address":"","ucode":"2704841763FD70","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/24/1006c208.jpg","comment_is_top":false,"comment_ctime":1633536800,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1633536800","product_id":100015201,"comment_content":"StatefulSet è¿™ä¸ªæ§åˆ¶å™¨çš„ä¸»è¦ä½œç”¨ä¹‹ä¸€ï¼Œå°±æ˜¯ä½¿ç”¨ Pod æ¨¡æ¿åˆ›å»º Pod çš„æ—¶å€™ï¼Œå¯¹å®ƒä»¬è¿›è¡Œç¼–å·ï¼Œå¹¶ä¸”æŒ‰ç…§ç¼–å·é¡ºåºé€ä¸€å®Œæˆåˆ›å»ºå·¥ä½œã€‚è€Œå½“ StatefulSet çš„â€œæ§åˆ¶å¾ªç¯â€å‘ç° Pod çš„â€œå®é™…çŠ¶æ€â€ä¸â€œæœŸæœ›çŠ¶æ€â€ä¸ä¸€è‡´ï¼Œéœ€è¦æ–°å»ºæˆ–è€…åˆ é™¤ Pod è¿›è¡Œâ€œè°ƒè°â€çš„æ—¶å€™ï¼Œå®ƒä¼šä¸¥æ ¼æŒ‰ç…§è¿™äº› Pod ç¼–å·çš„é¡ºåºï¼Œé€ä¸€å®Œæˆè¿™äº›æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":314598,"user_name":"å‡¡ä¿—","can_delete":false,"product_type":"c1","uid":1977570,"ip_address":"","ucode":"47FBCD66BE5AD4","user_header":"https://static001.geekbang.org/account/avatar/00/1e/2c/e2/afa3867c.jpg","comment_is_top":false,"comment_ctime":1633248601,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633248601","product_id":100015201,"comment_content":"æˆ‘ä»¬ç›®å‰ä½¿ç”¨statefulsetçš„åœºæ™¯å¤šåˆ©ç”¨äº†ä¸»æœºåå›ºå®šçš„ç‰¹æ€§ï¼Œä¹‹å‰æœ‰ä¸ªæ•°æ®æ”¶é›†æœåŠ¡ï¼Œå…¶æœ¬èº«ä½¿ç”¨äº†æ¶ˆæ¯é˜Ÿåˆ—ï¼›è‡ªå·±ç”Ÿäº§ç„¶åè‡ªå·±æ¶ˆè´¹ï¼Œä½†æ˜¯å®ƒä¸èƒ½åªåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¦åˆ™å¤šå‰¯æœ¬å·¥ä½œæ—¶ä¼šæœ‰é‡å¤æ¶ˆè´¹çš„æƒ…å†µï¼›æ‰€ä»¥åˆ©ç”¨ä¸»æœºåæˆ‘ä»¬å»ºäº†ä¸åŒçš„é˜Ÿåˆ—ï¼Œå„è‡ªç”Ÿäº§å„è‡ªæ¶ˆè´¹","like_count":0},{"had_liked":false,"id":313276,"user_name":"åˆ˜å¼·","can_delete":false,"product_type":"c1","uid":1035612,"ip_address":"","ucode":"B2E41BB894A727","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/5c/e09eac13.jpg","comment_is_top":false,"comment_ctime":1632362477,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632362477","product_id":100015201,"comment_content":"è¿™ä¸¤ä¸ªä¸ªpodçš„é¡ºåºå¯åŠ¨ä»€ä¹ˆæ—¶å€™æŒ‡å®šäº†ï¼Ÿçœ‹å¤§å®¶ç•™è¨€ï¼Œæ²¡æœ‰è¿™ä¸ªç–‘é—®å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":311032,"user_name":"çªçªå¤´","can_delete":false,"product_type":"c1","uid":1063866,"ip_address":"","ucode":"5C2635ED6484F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg","comment_is_top":false,"comment_ctime":1631025556,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1631025556","product_id":100015201,"comment_content":"å‡ ç§æ‹“æ‰‘çŠ¶æ€åŸºæœ¬éƒ½èƒ½é€šè¿‡ç¼–å·æ ‡è¯†ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸»ä¸»å°±æ²¡å¿…è¦äº†å§ï¼Œåªéœ€è¦æœ‰headless serviceå°±è¡Œäº†å§ï¼Œæ²¡å¿…è¦æœ‰statefulsetå§","like_count":0},{"had_liked":false,"id":304943,"user_name":"å‡‰å‡‰","can_delete":false,"product_type":"c1","uid":1325256,"ip_address":"","ucode":"FCCF976E41EF71","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/c8/972a5024.jpg","comment_is_top":false,"comment_ctime":1627713896,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627713896","product_id":100015201,"comment_content":"Kubernetes è¿˜ä¸ºæ¯ä¸€ä¸ª Pod æä¾›äº†ä¸€ä¸ªå›ºå®šå¹¶ä¸”å”¯ä¸€çš„è®¿é—®å…¥å£ï¼Œå³ï¼šè¿™ä¸ª Pod å¯¹åº”çš„ DNS è®°å½•ã€‚ è¿™ä¸ª DNS å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿå­˜åœ¨etcdä¸­ï¼Ÿ","like_count":1},{"had_liked":false,"id":301982,"user_name":"æ¢§æ¡æ ‘","can_delete":false,"product_type":"c1","uid":1349650,"ip_address":"","ucode":"D375A5223CC8E5","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/12/b82dd35b.jpg","comment_is_top":false,"comment_ctime":1626008684,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1626008684","product_id":100015201,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜ç™¾æ€ä¸å¾—å…¶è§£ã€‚ç›´æ¥åœ¨å®¿ä¸»æœºï¼Œå³K8SèŠ‚ç‚¹ä¸Šå»è§£æweb-1.nginxä¸ºå•¥ä¸æˆåŠŸå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1272730,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/9a/786b1ed8.jpg","nickname":"æœç²’æ©™","note":"","ucode":"000B15E28C68B6","race_medal":4,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":415198,"discussion_content":"dnsåœ°å€æ²¡æœ‰æŒ‡å®šä¸ºk8sçš„kube-dnsçš„åœ°å€å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637025628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296879,"user_name":"Geek_04e22a","can_delete":false,"product_type":"c1","uid":1184505,"ip_address":"","ucode":"B64FF12EA28BA6","user_header":"https://static001.geekbang.org/account/avatar/00/12/12/f9/7e6e3ac6.jpg","comment_is_top":false,"comment_ctime":1623209149,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1623209149","product_id":100015201,"comment_content":"ä¸¤ä¸ªé—®é¢˜<br>1.statefulsetå¦‚ä½•ç¡®è®¤ä¸»ä»<br>2.å‡è®¾mysqlæœ‰å¤šç»„ä¸»ä»ï¼Œè¿™ä¸ªéœ€è¦å¤šä¸ªstatefulset","like_count":0,"discussions":[{"author":{"id":2179383,"avatar":"https://static001.geekbang.org/account/avatar/00/21/41/37/b89f3d67.jpg","nickname":"æˆ‘åœ¨ç¡è§‰","note":"","ucode":"6503B611151D3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539965,"discussion_content":"è¿™ä¸ªé—®é¢˜åªç”¨statefulsetæ˜¯æ— æ³•è§£å†³çš„éœ€è¦ä¸€äº›æ›´é«˜çº§çš„ç‰¹æ€§ï¼Œæ¯”å¦‚crd","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639901762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291145,"user_name":"è‘£æ°¸åˆš","can_delete":false,"product_type":"c1","uid":1169147,"ip_address":"","ucode":"ADA792B226A6CD","user_header":"https://static001.geekbang.org/account/avatar/00/11/d6/fb/837af7bf.jpg","comment_is_top":false,"comment_ctime":1620050053,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620050053","product_id":100015201,"comment_content":"é€šè¿‡è¿™ä¸ªç»„åˆ<br>&lt;pod-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.local<br>æˆ‘è§£æå‡ºæ¥ä¸ºå•¥æ˜¯å®¶é‡Œå®½å¸¦çš„åœ°å€<br>æˆ‘æ˜¯ç”¨çš„vmè™šæ‹Ÿæœºå®‰è£…çš„k8sé›†ç¾¤","like_count":0},{"had_liked":false,"id":287029,"user_name":"å¤œè¡Œè¶å¤©å¼€","can_delete":false,"product_type":"c1","uid":1605567,"ip_address":"","ucode":"C4FE4617174415","user_header":"https://static001.geekbang.org/account/avatar/00/18/7f/bf/32e380e6.jpg","comment_is_top":false,"comment_ctime":1617751671,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1617751671","product_id":100015201,"comment_content":"è€å¸ˆï¼Œå¦‚ä½•ç¡®å®šPODçš„å¯åŠ¨é¡ºåºï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1025679,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a6/8f/12cfdaf8.jpg","nickname":"å¢™å£ä¸Šçš„å£è™","note":"","ucode":"05B8AF3F5B9B9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378459,"discussion_content":"-w  watchï¼Œæ¨¡å¼å¯ä»¥çœ‹åˆ°podçš„å¯åŠ¨é¡ºåº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623231753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285469,"user_name":"liyinda0000","can_delete":false,"product_type":"c1","uid":1198421,"ip_address":"","ucode":"12D5C62716DAB6","user_header":"https://static001.geekbang.org/account/avatar/00/12/49/55/b6c9c0f4.jpg","comment_is_top":false,"comment_ctime":1616830597,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616830597","product_id":100015201,"comment_content":"æ‚¨å¥½ï¼Œæˆ‘æµ‹è¯•ä¸€ä¸‹headless serviceï¼Œå‘ç°ç”©headless serviceä»»ç„¶å¯ä»¥è®¿é—®ï¼Œstatefulsetæ˜¯æ¨èä½¿ç”¨headless serviceçš„å§ï¼ŸåŸå› æ˜¯é˜²æ­¢æµªè´¹clusterIPå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":283509,"user_name":"æ¶‚","can_delete":false,"product_type":"c1","uid":1247775,"ip_address":"","ucode":"DC9F3B99A0B4E5","user_header":"https://static001.geekbang.org/account/avatar/00/13/0a/1f/cfeb036d.jpg","comment_is_top":false,"comment_ctime":1615801379,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615801379","product_id":100015201,"comment_content":"&#47; # nslookup web-1.nginx<br>Server:         10.1.0.10<br>Address:        10.1.0.10:53<br><br>** server can&#39;t find web-1.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-1.nginx: No answer","like_count":0},{"had_liked":false,"id":274931,"user_name":"å¤§é›„","can_delete":false,"product_type":"c1","uid":1676966,"ip_address":"","ucode":"5FCFDD3A940801","user_header":"https://static001.geekbang.org/account/avatar/00/19/96/a6/32a286e0.jpg","comment_is_top":false,"comment_ctime":1611220382,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611220382","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ã€‚ ç”¨dnsæ–¹å¼è®¿é—®ä¸åˆ°ã€‚ipåœ°å€æ˜¯å¯è¡Œçš„<br><br>[root@master01 Headless-Service]# kubectl exec -it web-0 -- bash<br>root@web-0:&#47;# more &#47;etc&#47;hosts <br># Kubernetes-managed hosts file.<br>127.0.0.1\tlocalhost<br>::1\tlocalhost ip6-localhost ip6-loopback<br>fe00::0\tip6-localnet<br>fe00::0\tip6-mcastprefix<br>fe00::1\tip6-allnodes<br>fe00::2\tip6-allrouters<br>192.168.241.87\tweb-0.nginx.default.svc.cluster.local\tweb-0<br>root@web-0:&#47;# exit<br>[root@master01 Headless-Service]# ping web-0.nginx.default.svc.cluster.local<br><br>^C<br>[root@master01 Headless-Service]# ping 192.168.241.87<br>PING 192.168.241.87 (192.168.241.87) 56(84) bytes of data.<br>64 bytes from 192.168.241.87: icmp_seq=1 ttl=64 time=0.057 ms<br>^C<br>--- 192.168.241.87 ping statistics ---<br>1 packets transmitted, 1 received, 0% packet loss, time 0ms<br>rtt min&#47;avg&#47;max&#47;mdev = 0.057&#47;0.057&#47;0.057&#47;0.000 ms","like_count":0},{"had_liked":false,"id":271783,"user_name":"JackYap","can_delete":false,"product_type":"c1","uid":1693865,"ip_address":"","ucode":"A24F4A944E3541","user_header":"https://wx.qlogo.cn/mmopen/vi_32/WKnAJ3VFxaBHmZR0IMZWic7QcjjNcBCY3NtToTC2LmROZA3OJzPHDT9WbNRplmxtTrrZNAzibsiaGzXlclUIbXksA/132","comment_is_top":false,"comment_ctime":1609809187,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609809187","product_id":100015201,"comment_content":"è¯·é—®statefulsetåœ¨æ»šåŠ¨éƒ¨ç½²çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯æŒ‰ç…§web-1,web-0è¿™æ ·åˆ é™¤ï¼Œç„¶åå†æŒ‰web-0,web-1è¿™æ ·åˆ›å»ºå—ï¼Ÿé‚£åœ¨éƒ¨ç½²çš„è¿‡ç¨‹ä¸­ä¼šä¸ä¼šå½±å“åˆ°ä¸šåŠ¡çš„å¯ç”¨æ€§ï¼Ÿ","like_count":0},{"had_liked":false,"id":268111,"user_name":"Cutler","can_delete":false,"product_type":"c1","uid":1228136,"ip_address":"","ucode":"2EDECFE039845B","user_header":"https://static001.geekbang.org/account/avatar/00/12/bd/68/3fd6428d.jpg","comment_is_top":false,"comment_ctime":1608076646,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608076646","product_id":100015201,"comment_content":"åŒºå—é“¾ä½œä¸ºå…¸å‹çš„æœ‰çŠ¶æ€åº”ç”¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®ä¸ä¸€æ ·ï¼ŒèŠ‚ç‚¹çš„å¯åŠ¨é¡ºåºä¹Ÿæœ‰è¦æ±‚ï¼Œå¦‚æœç”¨k8sæ¥éƒ¨ç½²æ˜¯å¦èƒ½æ»¡è¶³éœ€æ±‚ï¼Œä¸æ‰‹åŠ¨éƒ¨ç½²å¯¹æ¯”åˆæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½è§£ç­”ä¸€ä¸‹ï¼Œè°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":253406,"user_name":"Geek_fe4ca5","can_delete":false,"product_type":"c1","uid":2157510,"ip_address":"","ucode":"A4EA5E11904D9A","user_header":"","comment_is_top":false,"comment_ctime":1602729242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602729242","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæºç ä¸­ï¼Œåœ¨ç¼©å®¹æ—¶æœ‰è¿™æ ·ä¸€ä¸ªåˆ¤æ–­<br>if !isRunningAndReady(condemned[target]) &amp;&amp; monotonic &amp;&amp; condemned[target] != firstUnhealthyPod {<br>\t\t\tklog.V(4).Infof(<br>\t\t\t\t&quot;StatefulSet %s&#47;%s is waiting for Pod %s to be Running and Ready prior to scale down&quot;,<br>\t\t\t\tset.Namespace,<br>\t\t\t\tset.Name,<br>\t\t\t\tfirstUnhealthyPod.Name)<br>\t\t\treturn &amp;status, nil<br>\t\t}<br>if err := ssc.podControl.DeleteStatefulPod(set, condemned[target])<br><br>è¿™æ„æ€æ˜¯ï¼Œåªè¦å½“å‰ pod æ˜¯å¥åº·çš„ï¼Œå°±å¯ä»¥ç›´æ¥åˆ é™¤å—ï¼Ÿä¸éœ€è¦ç­‰å¾…ä¹‹å‰çš„æ‰€æœ‰ Pod éƒ½å˜ä¸º runningAndReady çŠ¶æ€ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":250307,"user_name":"Geek_8c2731","can_delete":false,"product_type":"c1","uid":1928194,"ip_address":"","ucode":"A87F938209D65A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkGGBK46EQpqE6zWCncMs14Jw95s191Y6pk3x3gQpNrvSc2YWoFEgUxmJWicibGp7XsFFKaZxuTSnA/132","comment_is_top":false,"comment_ctime":1601018700,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601018700","product_id":100015201,"comment_content":"If you don&#39;t see a command prompt, try pressing enter.<br>&#47; # nslookup web-0.nginx<br>Server:    10.96.0.10<br>Address 1: 10.96.0.10<br><br>nslookup: can&#39;t resolve &#39;web-0.nginx&#39;<br>æˆ‘å‡ºç°è¿™ä¸ªè¯¥æ€ä¹ˆè§£å†³äº†ï¼Œæ‰€ä»¥çš„æ–¹æ³•éƒ½å°è¯•äº†ï¼Œè¿˜æ˜¯ä¸è¡Œï¼Œé…ç½®ä»€ä¹ˆçš„éƒ½ä¸€æ‘¸ä¸€æ ·äº†æ”¹çš„","like_count":0},{"had_liked":false,"id":248791,"user_name":"M1racle","can_delete":false,"product_type":"c1","uid":1057144,"ip_address":"","ucode":"CFA981F34AFDA8","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/78/732a2e33.jpg","comment_is_top":false,"comment_ctime":1600311970,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600311970","product_id":100015201,"comment_content":"è¯·é—®ï¼Œåœ¨åˆ›å»º headless serviceçš„æ—¶å€™å·²ç»é€šè¿‡ matchlabels æŒ‡æ˜äº†è¦ç®¡ç†çš„ pod æ ‡ç­¾ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨åˆ›å»º deployment çš„æ—¶å€™è¿˜éœ€è¦æŒ‡æ˜ serviceName å‘¢ï¼Ÿæ˜¯åªæœ‰æŒ‡æ˜äº†è¿™ä¸ªæ‰æ˜¯ stateful set æ¨¡å¼ï¼Œæ‰èƒ½åœ¨åˆ›å»ºçš„æ—¶å€™ä¿æŒæœ‰åºä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":233628,"user_name":"YshShiHaoRen","can_delete":false,"product_type":"c1","uid":1267091,"ip_address":"","ucode":"CAD431D770CBB1","user_header":"https://static001.geekbang.org/account/avatar/00/13/55/93/b6968520.jpg","comment_is_top":false,"comment_ctime":1594370857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594370857","product_id":100015201,"comment_content":"æ’æŸ¥äº†è‡ªå·±æ­å»º nslookup æ— æ³•è®¿é—®ææƒ…å†µï¼š<br> kubectl log æŸ¥çœ‹ coredns pod çš„æ—¥å¿—ï¼Œå‘ç°æœ‰ panic<br>===<br>E0708 13:59:36.600498       1 runtime.go:78] Observed a panic: &quot;invalid memory address or nil pointer dereference&quot; (runtime error: invalid memory address or nil pointer dereference)<br>goroutine 47 [running]:<br>k8s.io&#47;apimachinery&#47;pkg&#47;util&#47;runtime.logPanic(0x19b3740, 0x2d784f0)<br>        &#47;tmp&#47;tmp.GOqnnMkoud&#47;g&#47;pkg&#47;mod&#47;k8s.io&#47;apimachinery@v0.17.2&#47;pkg&#47;util&#47;runtime&#47;runtime.go:74 +0xa3<br>k8s.io&#47;apimachinery&#47;pkg&#47;util&#47;runtime.HandleCrash(0x0, 0x0, 0x0)<br>        &#47;tmp&#47;tmp.GOqnnMkoud&#47;g&#47;pkg&#47;mod&#47;k8s.io&#47;apimachinery@v0.17.2&#47;pkg&#47;util&#47;runtime&#47;runtime.go:48 +0x82<br>panic(0x19b3740, 0x2d784f0)<br>        &#47;tmp&#47;tmp.GOqnnMkoud&#47;go&#47;src&#47;runtime&#47;panic.go:679 +0x1b2<br>github.com&#47;coredns&#47;coredns&#47;plugin&#47;kubernetes&#47;object.(*Endpoints).GetNamespace(0x0, 0x0, 0x7fbfefefc840)<br>====<br>é‡å¯äº† coredns çš„å®¹å™¨åï¼Œnslookup èƒ½å¤Ÿæ­£å¸¸è¿”å›äº†ã€‚","like_count":0},{"had_liked":false,"id":205622,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1586689359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586689359","product_id":100015201,"comment_content":"æ‰“å¡ã€‚æˆ‘ä»¬å¼€å‘webåº”ç”¨ç½‘ç»œæ‹“æ‰‘å¾ˆç®€å•ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸»ä»ã€‚","like_count":0},{"had_liked":false,"id":202862,"user_name":"å¼ ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1481715,"ip_address":"","ucode":"854C5A482B6E8F","user_header":"https://static001.geekbang.org/account/avatar/00/16/9b/f3/53706b7e.jpg","comment_is_top":false,"comment_ctime":1586077875,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586077875","product_id":100015201,"comment_content":"æœ‰ä¸ªç»†èŠ‚æ²¡çœ‹æ‡‚ï¼Œ<br>statefulseté‡Œé¢<br>ports: - containerPort: 80 name: webï¼Œè¿™é‡Œçš„nameæ˜¯ç«¯å£çš„åå­—ï¼Ÿ è¿™ä¸ª80ç«¯å£æ˜¯å¼€åœ¨podä¸Šçš„ï¼Ÿ <br><br>ä¸Šé¢å·²ç»æŒ‡å®šcontainer.name=nginxï¼Œä¸ºä»€ä¹ˆpodçš„åå­—æ˜¯web-0è€Œä¸æ˜¯nginx-0ï¼Ÿ<br><br>è¿˜æœ‰serviceé‡Œé¢å®šä¹‰çš„ ports:<br>  - port: 80<br>    name: web<br>è¿™é‡Œé¢çš„80æ˜¯serviceæä¾›æœåŠ¡çš„ç«¯å£ï¼Œå¯¹å—ï¼Ÿ name=webæ˜¯è¿™ä¸ªserviceçš„åå­—ï¼Ÿ <br>è¿™é‡Œé¢å®šä¹‰çš„selectoræ˜¯æ ‡è®°é€‰æ‹©äº†æ‰€æœ‰app=nginxçš„podä¼šè¢«å½’çº³åˆ°è¿™ä¸ªæœåŠ¡ä¸‹æ¥ç®¡ç†ï¼Œé‚£statfulseté‡Œé¢çš„selectorå®šä¹‰å’Œserviceä¸‹çš„selectorå®šä¹‰æ˜¯å¦æœ‰ä»€ä¹ˆå…³è”å…³ç³»ï¼Ÿ ","like_count":0,"discussions":[{"author":{"id":1610260,"avatar":"https://static001.geekbang.org/account/avatar/00/18/92/14/6ca50b3b.jpg","nickname":"å¤§Gæ¥äº†å‘¦","note":"","ucode":"97711D9CCA73B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305605,"discussion_content":"é¢—ç²’åº¦ä¸ç”¨é‚£ä¹ˆå°ï¼Œä»–æ˜¯é€šè¿‡statefulsetæ§åˆ¶çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600014950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189354,"user_name":"æ˜ŸæœŸå…«","can_delete":false,"product_type":"c1","uid":1185504,"ip_address":"","ucode":"34A37F73A48E7F","user_header":"https://static001.geekbang.org/account/avatar/00/12/16/e0/7abad3cc.jpg","comment_is_top":false,"comment_ctime":1584504523,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584504523","product_id":100015201,"comment_content":"headlessserviceçš„dnsè®°å½•æ˜¯åœ¨è®¿é—®äº†ä¸€ä¸ªpodçš„æ—¶å€™ï¼Œå§‹ç»ˆåªä¼šè®¿é—®åˆ°å›ºå®šçš„èŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·å°±ä¿è¯äº†èŠ‚ç‚¹çŠ¶æ€ä¸ä¸€æ ·ï¼Œè€Œè®¿é—®åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé€ æˆæ•°æ®ä¸ä¸€è‡´çš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":178606,"user_name":"å¤©å½±ä¹‹åˆƒ","can_delete":false,"product_type":"c1","uid":1042532,"ip_address":"","ucode":"DBC3B8DD48EDCF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/64/5c9eeb29.jpg","comment_is_top":false,"comment_ctime":1581758245,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581758245","product_id":100015201,"comment_content":"1ã€StatefulSetåˆ›å»ºä¹‹å‰ï¼Œæ— æ³•ä½¿ç”¨web-0.nginx.default.svc.cluster.localè§£æåŸŸå<br>2ã€StatefulSetåˆ›å»ºä¹‹åï¼Œå…¶å®æ˜¯ç”¨çš„æ˜¯&lt;statefulset-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.localè§£æçš„åŸŸåï¼Œå¦‚å°†StatefulSetä¸­çš„metadata\\ name: webæ”¹æˆmetadata\\ name: websï¼ŒåŸŸåå°±å˜æˆwebs-0.nginx.default.svc.cluster.localäº†<br>å› æ­¤æ­£æ–‡ä¸­çš„â€œ&lt;pod-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.localâ€æ˜¯ä¸æ˜¯æœ‰ç‚¹æ­§ä¹‰å•Šã€‚","like_count":0},{"had_liked":false,"id":155835,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1397271,"ip_address":"","ucode":"B62BEA525A64A1","user_header":"https://static001.geekbang.org/account/avatar/00/15/52/17/083d67fb.jpg","comment_is_top":false,"comment_ctime":1574764164,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574764164","product_id":100015201,"comment_content":"apiVersion: v1<br>kind: Service<br>app: nginx<br>...ï¼ˆçœç•¥ï¼‰<br>---<br>apiVersion: apps&#47;v1<br>kind: StatefulSet<br>serviceName: &quot;nginx&quot;<br>...ï¼ˆçœç•¥ï¼‰<br>æ‚¨å¥½ï¼Œè¯·é—®åƒè¿™ç§Yaml, å†…å®¹é‡Œæœ‰ä¸¤ä¸ªkind, å¦‚æœæˆ‘é€šè¿‡ rest apiï¼ˆæ¯”å¦‚ java clientï¼‰ è°ƒç”¨çš„è¯ï¼Œæ˜¯åªèƒ½è°ƒä¸¤æ¬¡å—ï¼Ÿ è¿˜æ˜¯æœ‰ä¸€æ¬¡è°ƒç”¨æ‰¹é‡å¤„ç†æ¥å£, å¦‚æœæˆ‘åˆ†ä¸¤æ¬¡è°ƒçš„è¯ï¼Œä¼šä¸ä¼šæœ‰é—®é¢˜å‘¢ã€‚ ","like_count":0},{"had_liked":false,"id":152617,"user_name":"å¤§é›„","can_delete":false,"product_type":"c1","uid":1676966,"ip_address":"","ucode":"5FCFDD3A940801","user_header":"https://static001.geekbang.org/account/avatar/00/19/96/a6/32a286e0.jpg","comment_is_top":false,"comment_ctime":1574051166,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1574051166","product_id":100015201,"comment_content":"[root@k8s-master ~]# kubectl get statefulset<br>NAME   READY   AGE<br>web    1&#47;1     16m<br>[root@k8s-master ~]# kubectl get svc<br>NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE<br>kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443&#47;TCP   3d21h<br>nginx        ClusterIP   None         &lt;none&gt;        80&#47;TCP    40m<br>[root@k8s-master ~]# kubectl get svc nginx<br>NAME    TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE<br>nginx   ClusterIP   None         &lt;none&gt;        80&#47;TCP    40m<br>[root@k8s-master ~]# kubectl get statefulset<br>NAME   READY   AGE<br>web    1&#47;1     16m<br>[root@k8s-master ~]# kubectl exec web-0 -- sh -c &#39;hostname&#39;<br>web-0<br>[root@k8s-master ~]#  kubectl run -i --tty --image busybox dns-test --restart=Never --rm &#47;bin&#47;sh<br>&#47; # nslookup web-0.nginx<br>Server:         10.96.0.10<br>Address:        10.96.0.10:53<br><br>** server can&#39;t find web-0.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-0.nginx: No answer<br><br><br>æ±‚é—®ï¼Œä¸Šé¢è¿™ä¸ªæŠ¥é”™æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"ä¸€ç§’","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352271,"discussion_content":"æŒ‡å®šbusyboxçš„ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614670437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148391,"user_name":"å‡¯æ–‡1985","can_delete":false,"product_type":"c1","uid":1036921,"ip_address":"","ucode":"9A42344649072B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d2/79/0a432fde.jpg","comment_is_top":false,"comment_ctime":1573001617,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1573001617","product_id":100015201,"comment_content":"å¯¹äºpodçš„templateåŸºæœ¬éƒ½æ˜¯ä¸€æ ·çš„ é‚£ä¹ˆk8såœ¨å¯åŠ¨podçš„æ—¶å€™åªæ˜¯æŒ‰ç…§äº†é¡ºåºå»å¯åŠ¨ä¸‰ä¸ªpod æ¯”å¦‚0ï¼Œ1ï¼Œ2 é‚£ä¹ˆæ˜¯æ€ä¹ˆå†³å®šå“ªä¸ªæ˜¯masterçš„å‘¢ è‡ªå·±ç¼–å†™è„šæœ¬æ¥åˆ¤æ–­å¦‚æœæ˜¯0ç¼–å·å°±æ˜¯masterå—","like_count":0},{"had_liked":false,"id":146148,"user_name":"sibyl","can_delete":false,"product_type":"c1","uid":1323652,"ip_address":"","ucode":"0D142011860D69","user_header":"","comment_is_top":false,"comment_ctime":1572440153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572440153","product_id":100015201,"comment_content":"headless serviceå°±åƒdnsä¸€æ ·,èƒ½é€šè¿‡å®ƒç¿»è¯‘å‡ºç›®æ ‡podçš„ipï¼ŒåŸŸåå°±æ˜¯pod name +service nameã€‚è€Œstatefulsetçš„pod nameçš„ç¼–å·æ˜¯ä¾æ¬¡çš„ï¼Œä¾‹å¦‚statefulsetName-0,statefulsetName-1ï¼Œè¿™å’Œdeploymentçš„éšæœºç¼–å·ä¸åŒï¼Œå› æ­¤ç›®æ ‡podåŸŸåå°±å¯è®¤ä¸ºæ˜¯å›ºå®šçš„äº†ï¼","like_count":0},{"had_liked":false,"id":139970,"user_name":"MarkFeng","can_delete":false,"product_type":"c1","uid":1220152,"ip_address":"","ucode":"82968C267E4D21","user_header":"https://static001.geekbang.org/account/avatar/00/12/9e/38/2dbe5f46.jpg","comment_is_top":false,"comment_ctime":1570777092,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570777092","product_id":100015201,"comment_content":"æ²¡æœ‰æŒ‰ç…§æ–‡ç« çš„ç¤ºä¾‹å»nslookupï¼Œåˆ›å»ºäº†ä¸€ä¸ª2 pod deploymentç±»å‹çš„wordpressï¼Œä¸€ä¸ªnormalç±»å‹çš„svcã€‚<br>å‘ç°deploymentçš„pod hostname ä¹Ÿæ˜¯pod nameï¼Œç„¶åï¼Œnslookup &lt;pod 2-name&gt;.&lt;normal svc-name&gt;ï¼Œä¹Ÿèƒ½å¤Ÿæ­£ç¡®è§£æå‡ºè¿™ä¸ªpod 2çš„ip<br>å¦‚æœè¿™ä¹ˆçœ‹ï¼Œåªè¦controllerèƒ½å¤Ÿä¿è¯pod nameä¸å˜ï¼Œnormal svcä¹Ÿèƒ½ä¿è¯ä½ é€šè¿‡&lt;pod-name&gt;.&lt;svc-name&gt;è§£æåˆ°pod ipï¼Œä¸ºä½•è¿˜è¦å¼ºè°ƒheadless svcå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":138342,"user_name":"å¼ è‹¥åˆ","can_delete":false,"product_type":"c1","uid":1575256,"ip_address":"","ucode":"143B6016CA06D5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epT7abaupjJFDn2WuwRNY2PzD5gNVpWaclZWNYclUKPm16uyKMrON8wQUicKU2evgpduEDf5CxoFyg/132","comment_is_top":false,"comment_ctime":1570173000,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1570173000","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘åªä¹°äº†ä¸€é—¨è¯¾ï¼Œä½†è¿™æ˜¯æˆ‘ä¹°çš„è´¨é‡ç¬¬ä¸‰é«˜çš„è¯¾ç¨‹ã€‚","like_count":0,"discussions":[{"author":{"id":1361556,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c6/94/48ca3281.jpg","nickname":"å¥”è·‘","note":"","ucode":"A64A0DCA50D9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":235353,"discussion_content":"æ±‚æ•™å¦å¤–ä¸¤é«˜è¯¾ç¨‹æ˜¯ä»€ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587037722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130946,"user_name":"myriad","can_delete":false,"product_type":"c1","uid":1137781,"ip_address":"","ucode":"9FBBCDE0E13B6B","user_header":"https://static001.geekbang.org/account/avatar/00/11/5c/75/e1ceedf2.jpg","comment_is_top":false,"comment_ctime":1567582051,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567582051","product_id":100015201,"comment_content":"ä½¿ç”¨æ–°ç‰ˆæœ¬k8s1.15 å®éªŒæ—¶ï¼Œå‘ç°æ‰§è¡Œ kubectl delete pod -l app=nginx åï¼Œé‡æ–°åˆ›å»ºçš„Podï¼ŒIPåœ°å€ä¹Ÿæ˜¯å›ºå®šçš„æ²¡å˜ï¼ˆçŒœæµ‹æ˜¯å½“IPåœ°å€æ²¡æœ‰è¢«å…¶ä»–podä½¿ç”¨æ—¶ï¼Œä¼šé‡æ–°è·å–deleteä¹‹å‰çš„IPåœ°å€ï¼‰ã€‚<br>","like_count":0},{"had_liked":false,"id":130638,"user_name":"ç«ç®­","can_delete":false,"product_type":"c1","uid":1202064,"ip_address":"","ucode":"ED7BA0479EAB16","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/90/7a8fbf69.jpg","comment_is_top":false,"comment_ctime":1567499357,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567499357","product_id":100015201,"comment_content":"nslookup web-0.nginx.default.svc.cluster.local,è¿™æ ·å¯ä»¥è§£æå¾—åˆ°","like_count":0},{"had_liked":false,"id":129620,"user_name":"tuyu","can_delete":false,"product_type":"c1","uid":1448863,"ip_address":"","ucode":"B235325B541408","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132","comment_is_top":false,"comment_ctime":1567174324,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567174324","product_id":100015201,"comment_content":"æˆ‘æ„Ÿè§‰è¿™ä¸ªbusyboxæ‹‰ä¸ä¸‹æ¥, å°±ç®—æ‰“tagä¹Ÿæ²¡æœ‰ç”¨","like_count":0},{"had_liked":false,"id":123559,"user_name":"sam700000","can_delete":false,"product_type":"c1","uid":1069133,"ip_address":"","ucode":"C2ABDDC56B2D50","user_header":"https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg","comment_is_top":false,"comment_ctime":1565701914,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1565701914","product_id":100015201,"comment_content":"æˆ‘è¿™è¾¹åœ¨nslookupçš„æ—¶å€™ä¹Ÿé‡åˆ°äº†å³ä½¿æ˜¯ä½¿ç”¨busybox:1.28.4é•œåƒä¹Ÿæ— æ³•è§£æçš„é—®é¢˜ï¼Œå¹¶ä¸”ä¹Ÿpingä¸åˆ°web-0.nginxæˆ–è€…web-0.nginx.default.svc.cluster.local çœ‹äº†ç•™æ„çš„bat2manå…„é‡å¯è§£å†³ï¼Œæˆ‘ä¼°è®¡æ˜¯æŸä¸ªé…ç½®éœ€è¦é‡å¯æ‰ç”Ÿæ•ˆï¼Œå› ä¸ºæˆ‘çš„å‡ ä¸ªèŠ‚ç‚¹åœ¨ç¬¬11èŠ‚éƒ¨ç½²k8sä¹‹åä¸€ç›´æ²¡æœ‰é‡å¯è¿‡ï¼Œæ‰€ä»¥å°±æƒ³é‡å¯æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿™æ—¶å€™æˆ‘æ‰æ„è¯†åˆ°æˆ‘ä¸çŸ¥é“å¦‚ä½•ç”¨åˆé€‚çš„æ–¹å¼é‡å¯k8sé›†ç¾¤â€¦ï¼Œä¸è¿‡ä¹Ÿæ²¡ç®¡è¿™ä¹ˆå¤šå°±ç›´æ¥init 6é‡å¯äº†ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œé‡å¯å®Œä¹‹åcpuçš„ä½¿ç”¨ç‡å¾ˆé«˜ï¼Œä¼°è®¡åº”ç”¨éƒ½åœ¨ä¸æ–­å¯»æ‰¾æœåŠ¡ï¼Œä¸»è¦æ˜¯apiserver etcdè¿™äº›æœåŠ¡ä¸çŸ¥é“æ˜¯ä¸æ˜¯é¡ºåºå¯åŠ¨çš„ï¼Œçœ‹åˆ°å¾ˆå¤šå¯¹è±¡çš„çŠ¶æ€éƒ½æ˜¯å¤±è´¥çš„å°±æŒ‰ç…§11èŠ‚é‡æ–°æŠŠpluginéƒ½åˆ æ‰ï¼ŒæŠŠæ— æ³•å¯åŠ¨çš„å®¹å™¨åˆ æ‰ï¼Œçœ‹åˆ°masterçš„åŸºç¡€æœåŠ¡æ­£å¸¸åï¼ŒæŠŠpluginé‡è£…äº†ï¼Œçœ‹åˆ°æœåŠ¡éƒ½æ­£å¸¸åï¼Œå†é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œnslookupå°±æ­£å¸¸äº†<br>ç”±äºå¯¹k8sçš„è®¤è¯†åªåˆ°18èŠ‚ï¼Œå…ˆä¸ç®¡äº†ï¼Œç»§ç»­å­¦ä¸‹å»å°±å¥½â€¦","like_count":0},{"had_liked":false,"id":117321,"user_name":"èƒ¡å®¶é¹","can_delete":false,"product_type":"c1","uid":1109940,"ip_address":"","ucode":"1636F84062948B","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/b4/61fb4dba.jpg","comment_is_top":false,"comment_ctime":1564023826,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1564023826","product_id":100015201,"comment_content":"è¿™ç§çŠ¶æ€ä¿å­˜ï¼Œåªæ˜¯é€šè¿‡DNSæ‰¾åˆ°æŒ‡å®šPodï¼Œè€Œä¸èƒ½ä¿ç•™æ—§Podé‡ŒåŸæœ‰çš„çŠ¶æ€ï¼Œæ»šåŠ¨å‡çº§ç­–ç•¥æ²¡å˜éƒ½æ˜¯ç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„Pod","like_count":0},{"had_liked":false,"id":115653,"user_name":"shawguo","can_delete":false,"product_type":"c1","uid":1124753,"ip_address":"","ucode":"67AEDBDAFE3F47","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/91/9813a63b.jpg","comment_is_top":false,"comment_ctime":1563683914,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563683914","product_id":100015201,"comment_content":"â€œä¸è¿‡ï¼Œç›¸ä¿¡ä½ ä¹Ÿå·²ç»æ³¨æ„åˆ°äº†ï¼Œå°½ç®¡ web-0.nginx è¿™æ¡è®°å½•æœ¬èº«ä¸ä¼šå˜ï¼Œä½†å®ƒè§£æåˆ°çš„ Pod çš„ IP åœ°å€ï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¯¹äºâ€œæœ‰çŠ¶æ€åº”ç”¨â€å®ä¾‹çš„è®¿é—®ï¼Œä½ å¿…é¡»ä½¿ç”¨ DNS è®°å½•æˆ–è€… hostname çš„æ–¹å¼ï¼Œè€Œç»ä¸åº”è¯¥ç›´æ¥è®¿é—®è¿™äº› Pod çš„ IP åœ°å€ã€‚â€<br>é—®é¢˜ï¼šå®¢æˆ·ç«¯DNSé€šå¸¸åˆ·æ–°é¢‘ç‡è¾ƒä½ï¼ŒStatefulSetåç«¯Pod IPå‘ç”Ÿå˜åŒ–åï¼Œä¼šä¸ä¼šå­˜åœ¨å®¢æˆ·ç«¯ä»ç„¶è®¿é—®åºŸå¼ƒPod IPçš„é—®é¢˜ï¼Ÿ Kubeé’ˆå¯¹è¿™ç§æƒ…å†µæœ‰ä»€ä¹ˆå»ºè®®è§£å†³æ–¹æ¡ˆå—","like_count":0},{"had_liked":false,"id":115650,"user_name":"shawguo","can_delete":false,"product_type":"c1","uid":1124753,"ip_address":"","ucode":"67AEDBDAFE3F47","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/91/9813a63b.jpg","comment_is_top":false,"comment_ctime":1563683677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563683677","product_id":100015201,"comment_content":"â€œä¸æ­¤åŒæ—¶ï¼Œé€šè¿‡ Headless Service çš„æ–¹å¼ï¼ŒStatefulSet ä¸ºæ¯ä¸ª Pod åˆ›å»ºäº†ä¸€ä¸ªå›ºå®šå¹¶ä¸”ç¨³å®šçš„ DNS è®°å½•ï¼Œæ¥ä½œä¸ºå®ƒçš„è®¿é—®å…¥å£ã€‚â€<br>é—®é¢˜ï¼šä½¿ç”¨DNSä½œä¸ºStatefulSetçš„ç¨³å®šå…¥å£ä½†æ˜¯Pod Ip","like_count":0},{"had_liked":false,"id":91816,"user_name":"HOMO-SUM","can_delete":false,"product_type":"c1","uid":1510465,"ip_address":"","ucode":"F942E464817A9C","user_header":"https://static001.geekbang.org/account/avatar/00/17/0c/41/34654d9f.jpg","comment_is_top":false,"comment_ctime":1557113734,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557113734","product_id":100015201,"comment_content":"æˆ‘æ€ä¹ˆè§£æä¸¤ä¸ªpodçš„ipæ˜¯ä¸€æ ·çš„ï¼Ÿ<br>```<br>If you don&#39;t see a command prompt, try pressing enter.<br>&#47; # nslookup web-0.nginx<br>Server:\t\t10.96.0.10<br>Address:\t10.96.0.10:53<br><br>** server can&#39;t find web-0.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-0.nginx: No answer<br><br>&#47; # nslookup web-1.nginx<br>Server:\t\t10.96.0.10<br>Address:\t10.96.0.10:53<br><br>** server can&#39;t find web-1.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-1.nginx: No answer<br><br>&#47; # nslookup web-0.nginx<br>Server:\t\t10.96.0.10<br>Address:\t10.96.0.10:53<br><br>** server can&#39;t find web-0.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-0.nginx: No answer<br><br>&#47; # nslookup web-1.nginx<br>Server:\t\t10.96.0.10<br>Address:\t10.96.0.10:53<br><br>** server can&#39;t find web-1.nginx: NXDOMAIN<br><br>*** Can&#39;t find web-1.nginx: No answer<br><br>&#47; # pod &quot;dns-test&quot; deleted<br>```","like_count":0,"discussions":[{"author":{"id":1146700,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7f/4c/57ecb2de.jpg","nickname":"atä¸‰æœˆ","note":"","ucode":"DD59AE4EBE8271","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1211,"discussion_content":"éœ€è¦åŠ ä¸Šnamespaceï¼Œ$ nslookup web-0.nginx.default.svc.cluster.local","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562403457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90125,"user_name":"cuikt","can_delete":false,"product_type":"c1","uid":1242702,"ip_address":"","ucode":"9A1DB426CEFEEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/4e/0066303c.jpg","comment_is_top":false,"comment_ctime":1556421139,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556421139","product_id":100015201,"comment_content":"CNI ä½¿ç”¨çš„æ˜¯calicoï¼ŒæŒ‰ç…§æœ¬æ–‡æ¡£éƒ¨ç½²nginx,é€šè¿‡busybox(ç”¨äº†æœ€æ–°ç‰ˆæœ¬ï¼Œ1.28ï¼Œ1.27éƒ½è¿™ä¸ªé—®é¢˜) éªŒè¯åŸŸåè§£æï¼Œnslookup web-0.nginx å§‹ç»ˆæ— æ³•è§£æã€‚é€šè¿‡tcpdump æŠ“å– busybox ç½‘ç»œåŒ…ï¼Œå‘ç°å…¶&#47;etc&#47;resolv.conf é…ç½®ä¸­options ndots:5 å¹¶æœªå¯ä½œç”¨ï¼Œç›´æ¥é€šè¿‡coredns åšäº†é€’å½’æŸ¥è¯¢ï¼ˆA? web-0.nginx.ï¼‰ã€‚éå¸¸é—æ†¾ä¸ºä»€ä¹ˆä¼šè¿™æ ·å­ï¼Œæ€€ç–‘ä¸å…¶å†…æ ¸ç½‘ç»œæ ˆæœ‰å…³ã€‚åé€šè¿‡tutum&#47;dnsutils é•œåƒéªŒè¯è§£ææ­£å¸¸ã€‚å›°æ‰°äº†ä¸¤å¤©ã€‚å¸Œæœ›å¯¹åäººæœ‰äº›å¸®åŠ©ã€‚","like_count":0},{"had_liked":false,"id":53646,"user_name":"xfan","can_delete":false,"product_type":"c1","uid":1315147,"ip_address":"","ucode":"48ED8D498D7F56","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","comment_is_top":false,"comment_ctime":1545704898,"is_pvip":false,"replies":[{"id":"19524","content":"å’‹å­¦å‡ºè¿™ä¹ˆä¸ªç»“è®ºæ¥â€¦â€¦å†åå¤ç ”ä¹ ä¸€ä¸‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1545751552,"ip_address":"","comment_id":53646,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545704898","product_id":100015201,"comment_content":"è¿™ä¸ªå¥½åƒå¾ˆéš¾ç”¨åœ¨çœŸå®åœºæ™¯ï¼Œæˆ‘æƒ³è®©podä»¥æŒ‡å®šçš„é¡ºåºå¯åŠ¨æ€ä¹ˆåŠï¼Œè¿™ä¸ªå¥½åƒä¹Ÿæ˜¯æ¯ä¸ªpodçš„çŠ¶æ€ç›¸åŒï¼Œåªæ˜¯åœ¨å¯åŠ¨åè¢«statefulsetè§„å®šçš„æ‹“æ‰‘ï¼Œç„¶åæŒ‰ç…§æ‹“æ‰‘æ¥è¿ä½œï¼Œå¾ˆè¿·æƒ‘","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434213,"discussion_content":"å’‹å­¦å‡ºè¿™ä¹ˆä¸ªç»“è®ºæ¥â€¦â€¦å†åå¤ç ”ä¹ ä¸€ä¸‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545751552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51091,"user_name":"å°è°¢åŒå­¦","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1545112978,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545112978","product_id":100015201,"comment_content":"è¯·é—®ä½œè€…ä¸ºä½•æˆ‘ç”¨kunectl runåˆ›å»ºçš„busybox é»˜è®¤nslookup æ˜¯53ç«¯å£è€Œè§£æä¸åˆ°serviceåŸŸåå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":49942,"user_name":"é¾šæ¾","can_delete":false,"product_type":"c1","uid":1024491,"ip_address":"","ucode":"1DDC6BEC5257DF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/eb/8bc935e2.jpg","comment_is_top":false,"comment_ctime":1544794277,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544794277","product_id":100015201,"comment_content":"è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œä¸ºä½•é€šè¿‡åºå·0ã€1å°±å›ºå®šæ‹“æ‰‘å…³ç³»ï¼Œæ˜¯å¦ä¸šåŠ¡é€»è¾‘å…³ç³»çš„å¦‚ä½•é€šè¿‡åºå·æ˜ å°„å…ˆåé¡ºåºçš„åŸåˆ™æš‚æ—¶æœªè¡¨ï¼Ÿ","like_count":0},{"had_liked":false,"id":46427,"user_name":"å°è°¢åŒå­¦","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1543923214,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543923214","product_id":100015201,"comment_content":"è¯·é—®å¯ä»¥ä»nodeè§£æheadless service ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":45808,"user_name":"johnson.skiii","can_delete":false,"product_type":"c1","uid":1316924,"ip_address":"","ucode":"F1B6E71B54046C","user_header":"https://static001.geekbang.org/account/avatar/00/14/18/3c/b5a00c1a.jpg","comment_is_top":false,"comment_ctime":1543798858,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1543798858","product_id":100015201,"comment_content":"è¿™ä¸ªå­—æ®µçš„ä½œç”¨ï¼Œå°±æ˜¯å‘Šè¯‰ StatefulSet æ§åˆ¶å™¨ï¼Œåœ¨æ‰§è¡Œæ§åˆ¶å¾ªç¯ï¼ˆControl Loopï¼‰çš„æ—¶å€™ï¼Œè¯·ä½¿ç”¨ Nginxè¿™ä¸ªheadless serviceä¿è¯PODçš„â€œå¯è§£æèº«ä»½â€<br><br>å¼ å¤§ï¼Œä¸Šé¢è¿™å¥è¯çš„æ„æ€æ˜¯ä¸æ˜¯è¯´ï¼Œåœ¨StatefulSetåœ¨è¿›è¡Œæ§åˆ¶å¾ªç¯çš„æ—¶å€™ï¼Œåˆ¤æ–­çš„ä¾æ®æ˜¯é€šè¿‡Nginxè¿™ä¸ªheadless serviceå»è®¿é—®â€œæ¯ä¸ªæŒ‰é¡ºåºå¯åŠ¨çš„PODâ€ï¼Œå¦‚æœèƒ½è®¿é—®è§£æï¼ˆâ€œå¯è§£æèº«ä»½â€ï¼‰åˆ™è¡¨ç¤ºæ§åˆ¶å¾ªç¯å™¨ä¸éœ€é‡‡å–æªæ–½ï¼›","like_count":0},{"had_liked":false,"id":43422,"user_name":"ç‰›é€¼ä½†","can_delete":false,"product_type":"c1","uid":1318525,"ip_address":"","ucode":"82408296E3F47E","user_header":"","comment_is_top":false,"comment_ctime":1543225141,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1543225141","product_id":100015201,"comment_content":"è€å¸ˆè¯·é—®ä¸‹ï¼ŒæŒ‰ç…§ä¾‹å­åˆ›å»ºstatefulsetä¹‹åï¼Œæ‰§è¡Œkubectl get rsï¼Œè¿”å›No resources foundã€‚ä½†æ˜¯ä¾‹å­ä¸­æ˜¯æœ‰replicas:2çš„ï¼Œ","like_count":0,"discussions":[{"author":{"id":1311254,"avatar":"https://static001.geekbang.org/account/avatar/00/14/02/16/6fe3fe44.jpg","nickname":"tangzc1","note":"","ucode":"78CB596D2F33DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4017,"discussion_content":"replicaSetå’Œreplicaæ˜¯ä¸¤å›äº‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565061055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41507,"user_name":"å°è°¢åŒå­¦","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1542795763,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542795763","product_id":100015201,"comment_content":"stateful set ç›´æ¥ç®¡ç†podè€Œæ²¡æœ‰rsçš„è¯ï¼Œé‚£ä¹ˆæ»šåŠ¨å‡çº§æˆ–è€…abæµ‹è¯•è¿™ç§å¦‚ä½•çµæ´»å®ç°ï¼Ÿ","like_count":0},{"had_liked":false,"id":40001,"user_name":"å‹¤åŠ³çš„å°èƒ–å­-libo","can_delete":false,"product_type":"c1","uid":1158344,"ip_address":"","ucode":"5BB20CD5A56568","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/c8/4b1c0d40.jpg","comment_is_top":false,"comment_ctime":1542434680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542434680","product_id":100015201,"comment_content":"ä¸€ä¸ªé—®é¢˜ï¼š<br>è¿™é‡Œé¢çš„kube-dnså°±æ˜¯ä¹‹å‰å®‰è£…çš„corednså—ï¼Ÿ<br>NAME                               READY   STATUS    RESTARTS   AGE   IP             NODE         NOMINATED NODE<br>coredns-576cbf47c7-9qcb8           1&#47;1     Running   0          28h   10.244.0.2     kubeadm1     &lt;none&gt;<br>coredns-576cbf47c7-cxfvf           1&#47;1     Running   0          28h   10.244.0.3     kubeadm1     &lt;none&gt;<br><br>ä¸€ä¸ªå»ºè®®ï¼šå¯ä»¥æŠŠæ–‡ç« é‡Œé¢çš„yamlæ–‡ä»¶å¼„æˆä»£ç æ¨¡å¼æ–¹ä¾¿å¤§å®¶ç›´æ¥å¤åˆ¶å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":37657,"user_name":"å®‹æ™“æ˜","can_delete":false,"product_type":"c1","uid":1146507,"ip_address":"","ucode":"DC866DCE2FBA9E","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/8b/3cc461b3.jpg","comment_is_top":false,"comment_ctime":1541667688,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541667688","product_id":100015201,"comment_content":"æ›´æ–°äº†é‚£ä¹ˆå¤šæœ‰ç‚¹è½åäº†å“ˆï¼Œè€å¸ˆï¼Œæˆ‘åœ¨åˆ é™¤podæ—¶å€™å‘ç°ä¸¤ä¸ªpodçš„çŠ¶æ€åŒæ—¶éƒ½æ˜¯Terminatingï¼Œå¹¶æ²¡æœ‰è€å¸ˆè¯´çš„å…ˆå¯åŠ¨ä¸¤ä¸ªæ­£å¸¸çš„podï¼Œå†åˆ é™¤åœæ­¢çš„podçš„æƒ…å†µï¼Œæ˜¯ä¸æ˜¯è·Ÿç½‘ç»œæ’ä»¶æœ‰å…³ï¼Ÿæˆ‘çš„ç”¨kube-router","like_count":0},{"had_liked":false,"id":35348,"user_name":"Caesar","can_delete":false,"product_type":"c1","uid":1253220,"ip_address":"","ucode":"0319C9E19387CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/64/54458855.jpg","comment_is_top":false,"comment_ctime":1540522523,"is_pvip":true,"replies":[{"id":"12619","content":"å› ä¸ºä½ çš„caseé‡Œå•ç‹¬åˆ é™¤podå¹¶ä¸ä¼šä½¿å…¶å®ƒpodå¤±è´¥å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540592728,"ip_address":"","comment_id":35348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1540522523","product_id":100015201,"comment_content":"ä¸ç®¡æ˜¯å•ç‹¬åˆ é™¤web-0ï¼Œè¿˜æ˜¯å•ç‹¬åˆ é™¤web-1.åœ¨æˆ‘çš„ç¯å¢ƒä¸Šéƒ½æ²¡æœ‰ä½“ç°ä¸»ä»è¿™ä¸€æ€æƒ³å•Šï¼Œåˆ é™¤web-0ï¼Œé‡å»ºçš„æ—¶å€™ä¹Ÿåªé‡å»ºäº†web-0ï¼Œè€Œä¸”podçš„restartå­—æ®µä¹Ÿæ˜¾ç¤ºä¸º0ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427519,"discussion_content":"å› ä¸ºä½ çš„caseé‡Œå•ç‹¬åˆ é™¤podå¹¶ä¸ä¼šä½¿å…¶å®ƒpodå¤±è´¥å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540592728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32723,"user_name":"Yiliu","can_delete":false,"product_type":"c1","uid":1068884,"ip_address":"","ucode":"2CF20B138244B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/54/552bde40.jpg","comment_is_top":false,"comment_ctime":1539679635,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539679635","product_id":100015201,"comment_content":"...<br>æŠ±æ­‰æ˜¯æˆ‘çš„é—®é¢˜.<br>æˆ‘ä»¥ä¸ºä¸Šé¢headlessçš„ymlæ˜¯ä¸ªå®ä¾‹.<br>åŸæ¥æ˜¯è¦æ‰§è¡Œçš„åˆ›å»ºserviceçš„yml.<br>ç°åœ¨å¯ä»¥äº†, å¤šè°¢è€å¸ˆ~","like_count":0},{"had_liked":false,"id":32722,"user_name":"Yiliu","can_delete":false,"product_type":"c1","uid":1068884,"ip_address":"","ucode":"2CF20B138244B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/54/552bde40.jpg","comment_is_top":false,"comment_ctime":1539679525,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539679525","product_id":100015201,"comment_content":"å¯ä»¥çœ‹åˆ°podæ˜¯ç”ŸæˆæˆåŠŸçš„, å¹¶ä¸”æ˜¯runningçŠ¶æ€.<br>ä½†æ˜¯service nginxçš„ç¡®æ˜¯è·å–ä¸åˆ°.<br>ä½†æ˜¯ymlæ–‡ä»¶é‡Œçš„ç¡®æœ‰serviceçš„å®šä¹‰<br>æˆ‘è¯•äº†ä¸‹å»æ‰åŒå¼•å·ç»“æœä¹Ÿä¸€æ ·, ä¹Ÿä¸æ˜¯å¼•å·çš„é—®é¢˜.<br><br>deleteåé‡æ–°å†applyè¿˜æ˜¯ä¸€æ ·çš„çŠ¶æ€.<br>ä¸Šä¸€ä¸ªç•™è¨€å†™é”™äº†, ç‰ˆæœ¬å·æ˜¯1.12.1.<br><br>è¯¾ç¨‹å¾ˆæ£’, è¾¹å¬å½•éŸ³è¾¹çœ‹æ–‡ç« æ•ˆç‡å¾ˆé«˜, èµ!","like_count":0},{"had_liked":false,"id":32714,"user_name":"Yiliu","can_delete":false,"product_type":"c1","uid":1068884,"ip_address":"","ucode":"2CF20B138244B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/54/552bde40.jpg","comment_is_top":false,"comment_ctime":1539676165,"is_pvip":false,"replies":[{"id":"11916","content":"ä½ ç¡®å®šcreateè¿‡è¿™ä¸ªserviceï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539677335,"ip_address":"","comment_id":32714,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539676165","product_id":100015201,"comment_content":"è¿è¡Œäº†ä¸Šé¢çš„ymlæ–‡ä»¶<br>å†# kubectl get service nginxçš„æ—¶å€™<br>æ‰¾ä¸åˆ°å¯¹åº”çš„service<br>Error from server (NotFound): services &quot;nginx&quot; not found<br><br>æ˜¯å¦æ˜¯æˆ‘ç¯å¢ƒçš„é—®é¢˜?<br>æˆ‘ç°åœ¨ç”¨çš„vmwareè·‘äº†ä¸ªcentos, ç”¨minikubeå®‰è£…çš„ç¯å¢ƒ.<br>kubernetesç‰ˆæœ¬æ˜¯12.1.1.","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426866,"discussion_content":"ä½ ç¡®å®šcreateè¿‡è¿™ä¸ªserviceï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539677335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30100,"user_name":"åŒ—å¡","can_delete":false,"product_type":"c1","uid":1218128,"ip_address":"","ucode":"2D947A61689FC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/50/bde525b1.jpg","comment_is_top":false,"comment_ctime":1538661995,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538661995","product_id":100015201,"comment_content":"æˆ‘çœ‹äº†ç½‘ä¸Šetcdé›†ç¾¤çš„yaml,ç¡®å®æ˜¯ç”¨è„šæœ¬ç›´æ¥å»é…ç½®podçš„dns nameçš„ã€‚","like_count":0},{"had_liked":false,"id":30046,"user_name":"Majorin_Che","can_delete":false,"product_type":"c1","uid":1131906,"ip_address":"","ucode":"22D3B0A20D4D1F","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/82/164b9073.jpg","comment_is_top":false,"comment_ctime":1538635370,"is_pvip":false,"replies":[{"id":"10833","content":"namespaceä¹Ÿä¸æ˜¯å½¢åŒè™šè®¾å•Š","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538659553,"ip_address":"","comment_id":30046,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538635370","product_id":100015201,"comment_content":"headlessæ ¹æ®labelé€‰æ‹©podï¼Œé‚£å¦‚æœå¦å¤–ä¸€ä¸ªnamespaceçš„æŸä¸ªpodæœ‰ç›¸åŒçš„labelï¼Œä¼šä¸ä¼šè¢«é€‰ä¸­","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425832,"discussion_content":"namespaceä¹Ÿä¸æ˜¯å½¢åŒè™šè®¾å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538659553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}