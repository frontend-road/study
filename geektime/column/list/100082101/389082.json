{"id":389082,"title":"04ï½œè·¨è¶Šç°å®çš„éšœç¢ï¼ˆä¸Šï¼‰ï¼šè¦æ€§èƒ½è¿˜æ˜¯è¦æ¨¡å‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ˜Šã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠé€šè¿‡å…³è”å¯¹è±¡ï¼ˆAssocation Objectï¼‰å»ºæ¨¡èšåˆï¼ˆAggregationï¼‰ã€‚</p><p>åœ¨å‰é¢ä¸‰èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸­çš„â€œä¸¤å…³è”ä¸€å¾ªç¯â€ï¼šæ¨¡å‹ä¸è½¯ä»¶å®ç°å…³è”ï¼›ç»Ÿä¸€è¯­è¨€ä¸æ¨¡å‹å…³è”ï¼›æç‚¼çŸ¥è¯†çš„å¾ªç¯ã€‚å…¶ä¸­ï¼Œç»Ÿä¸€è¯­è¨€ä¸æç‚¼çŸ¥è¯†çš„å¾ªç¯ä½œä¸ºä¸€ç§æ›´ä¸ºå¹³è¡¡çš„æƒè´£å…³ç³»ï¼Œä¿ƒè¿›äº†ä¸šåŠ¡æ–¹ä¸æŠ€æœ¯æ–¹æ›´å¥½çš„åä½œã€‚è€Œè¿™ä¸€åˆ‡åˆæ˜¯ä»¥æ¨¡å‹ä¸è½¯ä»¶å®ç°å…³è”ä¸ºåŸºç¡€ã€‚</p><p>ç„¶è€Œè½åœ°åˆ°å®è·µä¸­ï¼Œå…³è”æ¨¡å‹ä¸è½¯ä»¶å®ç°æ€»æœ‰ä¸€äº›è®©äººçº ç»“ä¸è‹¦æ¼çš„åœ°æ–¹ã€‚å¼•èµ·è¿™äº›è‹¦æ¼çš„ä¸»è¦åŸå› æ˜¯<strong>æ¶æ„é£æ ¼çš„å˜åŒ–</strong>ã€‚æˆ‘ä»¬å·²ç»ä»å•æœºæ—¶ä»£è¿‡æ¸¡åˆ°äº†å¤šå±‚å•ä½“æ¶æ„ï¼Œä»¥åŠäº‘åŸç”Ÿåˆ†å¸ƒå¼æ¶æ„ï¼Œä½†æˆ‘ä»¬æ‰€é‡‡ç”¨çš„å»ºæ¨¡æ€è·¯ä¸ç¼–ç¨‹é£æ ¼å¹¶æ²¡æœ‰å½»åº•è·Ÿä¸Šæ—¶ä»£çš„æ­¥ä¼ï¼Œè¿™ç§å·®å¼‚é€šå¸¸ä¼šä»¥<strong>æ€§èƒ½é—®é¢˜</strong>æˆ–æ˜¯<strong>ä»£ç åå‘³é“</strong>çš„å½¢å¼å‡ºç°ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦çœŸæ­£å‘æŒ¥å‡ºé¢†åŸŸé©±åŠ¨è®¾è®¡çš„ä½œç”¨ï¼Œå°±éœ€è¦<strong>åœ¨ä¸åŒæ¶æ„é£æ ¼ä¸‹ï¼Œæ‰¾åˆ°èƒ½å¤Ÿç»´æŒæ¨¡å‹ä¸è½¯ä»¶å®ç°ç»Ÿä¸€çš„åŠæ³•</strong>ã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸ªé¢†åŸŸå¸¸çœ‹å¸¸æ–°ï¼Œæ€»èƒ½äº§ç”Ÿæ–°å®è·µçš„åŸå› ã€‚</p><p>å› è€Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šç”¨ä¸‰èŠ‚è¯¾æ¥ä»‹ç»ä¸€ç»„å®ç°æ¨¡å¼ï¼Œå¸®åŠ©æˆ‘ä»¬åº”å¯¹ä»å•æœºæ¶æ„è¿‡æ¸¡åˆ°å¤šå±‚æ¶æ„ï¼Œä¿æŒæ¨¡å‹ä¸è½¯ä»¶å®ç°çš„å…³è”ã€‚è¿™äº›æ¨¡å¼ä¹Ÿæ˜¯æˆ‘ä»¬åé¢å­¦ä¹ åœ¨å¾®æœåŠ¡å’Œäº‘åŸç”Ÿæ—¶ä»£ï¼Œå®æ–½é¢†åŸŸé©±åŠ¨è®¾è®¡æ–¹æ³•çš„åŸºç¡€ã€‚</p><p>ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å…ˆä»å…³è”å¯¹è±¡è¿™ä¸€æ–¹æ³•å¼€å§‹è®²èµ·ã€‚å…³è”å¯¹è±¡æ˜¯ä¸€ä¸ªå¤è€çš„è®¾è®¡/åˆ†ææ¨¡å¼ï¼ŒMartin Fowleråœ¨<a href=\"https://book.douban.com/subject/4832380/\">ã€Šåˆ†ææ¨¡å¼ã€‹</a>ä¸­è®¨è®ºè¿‡å®ƒã€‚Peter Coadå°†å®ƒè§†ä¸ºä¸€ç§å¸¸è§çš„ä¸šåŠ¡æ„æˆæ¨¡å¼ï¼Œå¹¶åº”ç”¨åˆ°ä¸šåŠ¡åˆ†æä¸­ã€‚è€Œæˆ‘å¤§æ¦‚ä»2005å¹´å¼€å§‹ï¼Œä½¿ç”¨å®ƒå»ºæ¨¡é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸­çš„èšåˆä¸å…³è”å…³ç³»ï¼Œä»¥è§£å†³é¢†åŸŸæ¨¡å‹ï¼ˆDomain Modelï¼‰ä¸­å¯¹æŠ€æœ¯ç»„ä»¶çš„å°è£…é—®é¢˜ã€‚</p><!-- [[[read_end]]] --><p>ä¸è¿‡ï¼Œåœ¨è®²è§£åˆ°å…³è”å¯¹è±¡çš„å…·ä½“åšæ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸€ä¸‹<strong>é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸­çš„èšåˆå…³ç³»åœ¨å…·ä½“å®ç°ä¸­å­˜åœ¨å“ªäº›é—®é¢˜</strong>ã€‚äº†è§£äº†é—®é¢˜æ‰€åœ¨ï¼Œæˆ‘ä»¬æ‰èƒ½æ›´æœ‰é’ˆå¯¹æ€§åœ°å»å¯»æ‰¾è§£å†³åŠæ³•ã€‚</p><h2>æ— æ³•å°è£…çš„æ•°æ®åº“å¼€é”€</h2><p>åœ¨åº”ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡çš„æ—¶å€™ï¼Œèšåˆä¸èšåˆæ ¹ï¼ˆAggregation Rootï¼‰æ˜¯æ„æˆâ€œå¯Œå«çŸ¥è¯†çš„æ¨¡å‹ï¼ˆKnowledge Rich Modelï¼‰â€çš„å…³é”®ã€‚é€šè¿‡èšåˆå…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å°†<strong>è¢«èšåˆå¯¹è±¡çš„é›†åˆé€»è¾‘æ”¾ç½®äºèšåˆ/èšåˆæ ¹é‡Œï¼Œè€Œä¸æ˜¯æ•£è½åœ¨å¤–ï¼Œæˆ–æ˜¯æ”¾åœ¨å…¶ä»–æ— å…³çš„æœåŠ¡ä¸­</strong>ã€‚è¿™ä¹ˆåšå¯ä»¥ä½¿å¾—é€»è¾‘å¯Œé›†äºæ¨¡å‹ä¸­ï¼Œé¿å…â€œé€»è¾‘æ³„éœ²â€ã€‚</p><p>ä¸è¿‡è½åˆ°å…·ä½“å®ç°ä¸Šï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªæŒ‘æˆ˜ï¼Œå³ï¼š<strong>è¿™äº›è¢«èšåˆçš„å¯¹è±¡ï¼Œé€šå¸¸éƒ½æ˜¯è¢«æ•°æ®åº“æŒä¹…åŒ–</strong>ï¼ˆPersistentï¼‰<strong>çš„é›†åˆ</strong>ï¼ˆCollectionï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°æ®åº“ç³»ç»Ÿçš„å¼•å…¥ï¼Œç½‘ç»œI/Oä¸å…¶ä»–æ€§èƒ½å¼€é”€æ— æ³•è¢«æ¥å£æŠ½è±¡éš”ç¦»ã€‚è€Œå°†å…·ä½“æŠ€æœ¯å®ç°å¼•å…¥é¢†åŸŸæ¨¡å‹ï¼Œåˆ™æœ‰æ‚–é¢†åŸŸé©±åŠ¨è®¾è®¡çš„ç†å¿µã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å…·ä½“çš„ä¸Šä¸‹æ–‡ä¸­çœ‹ä¸€çœ‹å­˜åœ¨ä»€ä¹ˆé—®é¢˜ã€‚ç„¶åï¼Œå†çœ‹ä¸€ä¸‹è¿™ä¸ªé—®é¢˜åœ¨å»ºæ¨¡æ€è·¯ä¸Šäº§ç”Ÿçš„æ ¹æºï¼Œä»¥åŠè¦å¦‚ä½•ä¿®æ­£æˆ‘ä»¬çš„å»ºæ¨¡æ€è·¯ã€‚</p><h3>é›†åˆéå†ä¸N+1</h3><p>è®©æˆ‘ä»¬å†å›åˆ°åœ¨<a href=\"https://time.geekbang.org/column/article/387945\">ç¬¬äºŒè®²</a>é‡Œå±•ç¤ºçš„æå®¢æ—¶é—´ä¸“æ çš„ä¾‹å­ï¼š</p><pre><code>class User {\n\n\n   private List&lt;Subscription&gt; subscriptions;\n\n\n   // è·å–ç”¨æˆ·è®¢é˜…çš„æ‰€æœ‰ä¸“æ \n   public List&lt;Subscription&gt; getSubscriptions() {\n     ...\n   }\n   \n   // è®¡ç®—æ‰€è®¢é˜…çš„ä¸“æ çš„æ€»ä»·\n   public double getTotalSubscriptionFee() {\n     ...\n   }\n}\n\n\nclass UserRepository {\n  ...\n  public User findById(long id) {\n    ...\n  }\n</code></pre><p>æŒ‰ç…§é¢å‘å¯¹è±¡å’Œé¢†åŸŸé©±åŠ¨è®¾è®¡æå€¡çš„åšæ³•ï¼ŒUserä½œä¸ºèšåˆæ ¹ï¼Œéœ€è¦ç®¡æ§å…¶å¯¹åº”çš„Subscriptionã€‚ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•ä¸”å¸¸è§çš„éœ€æ±‚ï¼šåœ¨é¡µé¢ä¸Šï¼Œæ˜¾ç¤ºå¯¹ç”¨æˆ·å·²ç»è®¢é˜…è¿‡çš„ä¸“æ è¿›è¡Œåˆ†é¡µå¤„ç†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¤§æ¦‚ä¼šè¿™ä¹ˆå†™ï¼š</p><pre><code>user.getSubscriptions().subList(from, from + pageSize);\n</code></pre><p>å¯ä»¥å‘ç°ï¼Œåœ¨è¿™æ®µä»£ç é‡Œï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„Subscriptionéƒ½åœ¨å†…å­˜é‡Œï¼Œå› æ­¤æ‰€æœ‰çš„è®¡ç®—ä¸é€»è¾‘éƒ½å¯ä»¥åœ¨å†…å­˜ä¸­å®Œæˆäº†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨è¯»å–Userçš„æ—¶å€™ï¼Œå°†å®ƒå¯¹åº”çš„æ‰€æœ‰è®¢é˜…è¿‡çš„ä¸“æ ä¿¡æ¯éƒ½ä»æ•°æ®åº“è¯»å–åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚</p><p>å¦‚æœæ˜¯å°‘é‡è®¢é˜…çš„åœºæ™¯ï¼Œæ¯”å¦‚å‡ ä¸ªæˆ–è€…å‡ åä¸ªï¼Œé‚£è¿™æ®µä»£ç å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ä½†å¦‚æœæœ‰ä¸ªç‰¹åˆ«å¥½å­¦çš„äººï¼Œä¹°äº†å‡ ä¸‡ç”šè‡³å‡ ç™¾ä¸‡ä¸ªä¸“æ å‘¢ï¼ˆå…ˆå‡è®¾ä¸“æ æœ‰æ— é™ä¸ªï¼‰ï¼Ÿæ­¤æ—¶å°†æ‰€æœ‰è®¢é˜…è¿‡çš„ä¸“æ éƒ½è¯»å–åˆ°å†…å­˜é‡Œï¼Œè¿™å°±æ„å‘³ç€ä¼šæœ‰å·¨å¤§çš„ç½‘ç»œI/Oå¼€é”€å’Œå†…å­˜å ç”¨ã€‚</p><p>å½“ç„¶ï¼Œè¿™é‡Œä½ å¯èƒ½ä¼šè¯´ï¼ŒJPA/Hibernateç­‰ORMæä¾›äº†å»¶è¿ŸåŠ è½½å•Šã€‚æ˜¯çš„ï¼Œä½†è¿™åˆä¼šå¼•å…¥<strong>ç»å…¸çš„æ€§èƒ½ç“¶é¢ˆN + 1é—®é¢˜</strong>ã€‚å› ä¸ºéšç€å»¶è¿ŸåŠ è½½é›†åˆçš„éå†ï¼Œå…¶ä¸­çš„Subscriptionå¯¹è±¡ä¼šè¢«ä¾æ¬¡åŠ è½½ã€‚</p><p>å»¶è¿ŸåŠ è½½çš„å®ç°æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ul>\n<li>å…ˆæ‰§è¡Œä¸€æ¡æŸ¥è¯¢è·å–é›†åˆçš„æ¦‚å†µã€‚æ¯”å¦‚æ€»å…±æœ‰å¤šå°‘æ¡è®°å½•ä¹‹ç±»çš„ä¿¡æ¯ã€‚</li>\n<li>ç„¶åæ ¹æ®æ¦‚å†µä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ªé›†åˆå¯¹è±¡ã€‚è¿™æ—¶å€™é›†åˆå¯¹è±¡åŸºæœ¬ä¸Šæ˜¯ç©ºçš„ï¼Œä¸å ç”¨ä»€ä¹ˆå†…å­˜ç©ºé—´ã€‚</li>\n<li>éšåï¼Œå½“æˆ‘ä»¬éœ€è¦é›†åˆå†…çš„å…·ä½“ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒå†æ ¹æ®æˆ‘ä»¬éœ€è¦è®¿é—®çš„å¯¹è±¡ï¼ŒæŒ‰éœ€ä»æ•°æ®åº“ä¸­è¯»å–ã€‚</li>\n</ul><p>ç†è®ºä¸Šè®²ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…ä¸€æ¬¡æ€§è¯»å…¥å¤§é‡æ•°æ®å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œè€Œæå‡ºçš„è§£å†³åŠæ³•ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœéœ€è¦è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€»å…±å°±ä¼šæœ‰N+1æ¬¡æ•°æ®åº“è®¿é—®ï¼š1æ¬¡æ˜¯æŒ‡ç¬¬ä¸€æ¬¡è·å–æ¦‚å†µçš„è®¿é—®ï¼ŒNæ¬¡æŒ‡è€Œåé›†åˆä¸­Nä¸ªå¯¹è±¡æ¯ä¸ªä¸€æ¬¡ã€‚è€Œæ¯ä¸€æ¬¡åŠ è½½ï¼Œéƒ½ä¼´éšç€å¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œè‡ªç„¶å°±ä¼šå¸¦æ¥I/Oä¸æ•°æ®åº“çš„å¼€é”€ã€‚ç‰¹åˆ«æ˜¯é¢‘ç¹åœ°å¯¹æ•°æ®åº“è®¿é—®ï¼Œå¯èƒ½ä¼šé˜»å¡å…¶ä»–äººï¼Œä»è€Œé€ æˆæ€§èƒ½ç“¶é¢ˆã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å…¶å®æ²¡æœ‰ä»€ä¹ˆå¥½çš„é€‰æ‹©ï¼š<strong>è¦ä¹ˆæ˜¯ä¸€æ¬¡æ€§è¯»å…¥å…¨éƒ¨æ•°æ®ï¼Œé¿å…N + 1é—®é¢˜ï¼›è¦ä¹ˆæ˜¯å¼•å…¥N+1é—®é¢˜ï¼Œå˜æˆé’åˆ€å­å‰²è‚‰</strong>ã€‚</p><p>ä¸ºäº†é¿å…è¿™ä¸¤ç§æƒ…å†µï¼Œå¾ˆè‡ªç„¶åœ°ï¼Œä½ ä¼šæƒ³èµ·è¿™æ ·ä¸€ç§åšæ³•ï¼šé€šè¿‡æŸ¥è¯¢è¯­å¥ä¸€æ¬¡æ€§å®šä½æ‰€éœ€åˆ†é¡µï¼Œè¿™æ ·åªéœ€è¦ä¸€æ¬¡æŸ¥è¯¢å°±èƒ½è§£å†³é—®é¢˜ã€‚ä¸è¿‡è¿™ä¹ˆåšçš„å›°éš¾åœ¨äºï¼Œ<strong>åˆ†é¡µæŸ¥è¯¢çš„é€»è¾‘è¦æ”¾åœ¨å“ªä¸ªå¯¹è±¡ä¸Šï¼Œæ‰èƒ½ä¿æŒæ¨¡å‹ä¸è½¯ä»¶å®ç°çš„å…³è”</strong>ã€‚</p><p>ä¸€ç§åšæ³•æ˜¯<strong>ä¸ºè®¢é˜…</strong>ï¼ˆSubscriptionï¼‰<strong>æ„é€ ä¸€ä¸ªç‹¬ç«‹çš„Repositoryå¯¹è±¡</strong>ï¼Œå°†é€»è¾‘æ”¾åœ¨é‡Œé¢ï¼ˆä¹Ÿæ˜¯Springæ¨èçš„åšæ³•ï¼‰ï¼š</p><pre><code>interface SubscriptionRepository extends ... {\n  public Page&lt;Subscription&gt; findPaginated(int from, int size);\n}\n</code></pre><p>è¿™ç§åšæ³•çš„é—®é¢˜å°±æ˜¯ä¼šå¯¼è‡´<strong>é€»è¾‘æ³„éœ²</strong>ã€‚Subscriptionè¢«Userèšåˆï¼Œé‚£ä¹ˆUseræ‰€æ‹¥æœ‰çš„Subscriptionçš„é›†åˆé€»è¾‘åº”è¯¥è¢«å°è£…åœ¨Userä¸­ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯Useræ˜¯â€œé€»è¾‘ä¸°å¯Œçš„æ¨¡å‹â€ï¼Œå› ä¸º<strong>éèšåˆæ ¹æä¾›Repositoryæ˜¯ä¸€ç§åå‘³é“</strong>ã€‚</p><p>å¦‚æœèšåˆåˆ°Userä¸Šæ˜¯å¯è¡Œçš„å—ï¼Ÿå…¶å®ä¹Ÿä¸è¡Œã€‚å› ä¸ºè¿™ä¹ˆåšä¼šå°†æŠ€æœ¯å®ç°ç»†èŠ‚å¼•å…¥é¢†åŸŸé€»è¾‘ä¸­ï¼Œè€Œæ— æ³•ä¿æŒé¢†åŸŸé€»è¾‘çš„ç‹¬ç«‹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class User {\n    public List&lt;Subscription&gt; getSubscriptions() {\n      ....\n    }\n    \n    public List&lt;Subscription&gt; getSubscriptions(int from, int size) {\n       return db.executeQuery(....);\n    }\n }\n</code></pre><p>é€ æˆè¿™ç§ä¸¤éš¾å±€é¢çš„æ ¹æºåœ¨äºï¼Œ<strong>æˆ‘ä»¬å¸Œæœ›åœ¨æ¨¡å‹ä¸­ä½¿ç”¨é›†åˆæ¥å£ï¼Œå¹¶å€ŸåŠ©å®ƒå°è£…å…·ä½“æŠ€æœ¯å®ç°çš„ç»†èŠ‚</strong>ã€‚å› ä¸ºåœ¨æˆ‘ä»¬çš„æ¦‚å¿µä¸­ï¼Œ<strong>å†…å­˜ä¸­çš„é›†åˆä¸æ•°æ®åº“æ˜¯ç­‰ä»·çš„ï¼Œéƒ½å¯ä»¥é€šè¿‡é›†åˆæ¥å£å°è£…</strong>ã€‚ä½†å®é™…æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬æ— æ³•å¿½ç•¥æ•°æ®åº“å¸¦æ¥çš„é¢å¤–ä½œç”¨ä¸å¼€é”€ï¼Œå†…å­˜ä¸­çš„é›†åˆä¸æ•°æ®åº“å¹¶ä¸æ˜¯ç­‰ä»·çš„ï¼Œå°è£…å¤±è´¥ã€‚</p><p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬çš„æ¦‚å¿µä¸­ï¼Œæˆ‘ä»¬ä¼šè®¤ä¸ºå†…å­˜ä¸­çš„é›†åˆä¸æ•°æ®åº“æ˜¯ç­‰ä»·çš„ï¼Œæ˜¯å¯ä»¥é€šè¿‡é›†åˆæ¥å£å°è£…çš„å‘¢ï¼Ÿè¿™å°±è¦ä»é¢å‘å¯¹è±¡æŠ€æœ¯çš„å¼€ç«¯â€”â€”Smalltalkç³»ç»Ÿè¯´èµ·äº†ã€‚</p><h3>Smalltalkä¸­é›†åˆä¸æ•°æ®åº“æ˜¯ç­‰ä»·çš„</h3><p>é²œå°‘æœ‰äººäº†è§£çš„ä¸€ä¸ªäº‹å®æ˜¯ï¼Œ<strong>é›†åˆä¸æ•°æ®åº“çš„ç­‰ä»·ï¼Œåœ¨æ—©æœŸé¢å‘å¯¹è±¡ç³»ç»ŸSmalltalkä¸­æ˜¯ä¸€ä¸ªåŸºç¡€æ¦‚å¿µ</strong>ã€‚</p><p>è¿™å…¶å®ä¸éš¾ç†è§£ï¼Œå¦‚æœå¯¹è±¡ä¸­åŒ…å«çš„çŠ¶æ€å¯ä»¥æ˜ å°„ä¸ºæ•°æ®åº“è¡¨ä¸­çš„ä¸€åˆ—ï¼Œé‚£ä¹ˆä¸€ç»„å¯¹è±¡è‡ªç„¶å°±å¯ä»¥æ˜ å°„æˆä¸€å¼ è¡¨äº†ã€‚æœ‰äº†ä¸€å¼ è¡¨ï¼Œè‡ªç„¶ä¹Ÿå°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæœ€å°çš„æ•°æ®åº“äº†ã€‚</p><p>Smalltalkä½œä¸ºé¢å‘å¯¹è±¡ç³»ç»Ÿå†…ç½®çš„ä¸€å¥—<strong>é¢å‘å¯¹è±¡æ•°æ®åº“</strong>ï¼ˆObject Oriented Databaseï¼‰ã€‚äºæ˜¯åœ¨ä½¿ç”¨Smalltalkç³»ç»Ÿæ—¶ï¼Œé›†åˆä¸æ•°æ®åº“æ˜¯æ— å·®åˆ«çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå±•ç¤ºäº†Smalltalkç³»ç»Ÿçš„æ„æˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c3/3d/c3d0e09fd9faa5bdc4313032fe15423d.jpg?wh=7885x4244\" alt=\"\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒSmalltalkä¸­é™¤äº†è™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰ä¹‹å¤–ï¼Œè¿˜æœ‰è™šæ‹Ÿé•œåƒï¼ˆVirtual Imageï¼ŒVIï¼‰ã€‚<strong>è™šæ‹Ÿé•œåƒç›¸å½“äºè™šæ‹Ÿæœºå†…å­˜çš„æŒä¹…åŒ–ä¿å­˜</strong>ã€‚æ¯æ¬¡è™šæ‹Ÿæœºå¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½ä¼šæŠŠè™šæ‹Ÿé•œåƒä¸­çš„ä¿¡æ¯è¯»å…¥åˆ°å†…å­˜ä¸­ä»¥æ¢å¤çŠ¶æ€ï¼Œè€ŒJavaã€.NETè™šæ‹Ÿæœºå¹¶ä¸ä¼šä¿ç•™ä¹‹å‰å†…å­˜ä¸­çš„ä¿¡æ¯ã€‚</p><p>æ‰“ä¸ªæ¯”æ–¹ã€‚Smalltalkè™šæ‹Ÿæœºçš„å¯åŠ¨è¿‡ç¨‹ï¼Œç±»ä¼¼äºVMWareè™šæ‹Ÿæœºä¸Šçš„Pauseï¼Œå†…å­˜ä¸­çš„æ‰€æœ‰çŠ¶æ€éƒ½è¢«æŒä¹…åŒ–ä¿å­˜äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»§ç»­ä»ä¹‹å‰æš‚åœçš„åœ°æ–¹å¼€å§‹ã€‚è€Œå…¶ä»–è¯­è¨€çš„è™šæ‹Ÿæœºåˆ™æ˜¯å½»åº•åœ°é‡å¯ï¼ˆRestartï¼‰ï¼Œå¹¶ä¸ä¼šä¿ç•™ä¹‹å‰çš„ç»“æœã€‚</p><p>åœ¨Smalltalkçš„è™šæ‹Ÿé•œåƒä¸­ï¼Œå­˜å‚¨ç€æ‰€æœ‰çš„ä»£ç å’Œæ•°æ®ã€‚æˆ‘ä»¬ç§°å‘¼Smalltalkä¸ºä¸€ä¸ªé¢å‘å¯¹è±¡ç³»ç»Ÿï¼Œè€Œä¸ä»…ä»…æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ã€‚å› ä¸ºå®ƒæ—¢æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºçš„æ“ä½œç³»ç»Ÿï¼Œè¿˜æ˜¯ä¸€ä¸ªé¢å‘å¯¹è±¡æ•°æ®åº“ã€‚</p><p>é‚£ä¹ˆåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼ŒSmalltalkä¸­çš„é›†åˆï¼ˆæ— è®ºæ˜¯Arrayã€Listï¼Œè¿˜æ˜¯ä»€ä¹ˆï¼‰å°±ç­‰åŒäºä¸€ä¸ªæ•°æ®åº“ã€‚åªè¦è¿™ä¸ªé›†åˆè¢«åˆ›å»ºå‡ºæ¥ï¼Œé™¤éæ˜¾ç¤ºåŒ–åœ°é€šè¿‡åƒåœ¾å›æ”¶é”€æ¯ï¼Œå¦åˆ™å®ƒå°±ä¼šè¢«è™šæ‹Ÿé•œåƒæŒä¹…åŒ–ã€‚<strong>åƒåœ¾æ”¶é›†å’ŒæŒä¹…åŒ–ä¸€æ ·ï¼Œéƒ½å¯ä»¥è¢«çœ‹ä½œæ˜¯å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</strong>ï¼ˆObject Lifecycleï¼‰<strong>çš„ä¸€ä¸ªçŠ¶æ€</strong>ã€‚</p><p>å› æ­¤ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®å’Œéæ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œéƒ½å¯ä»¥é€šè¿‡Collectionè¡¨è¾¾ï¼Œæˆ‘ä»¬ä¸ç”¨å†å»åŒºåˆ†å®ƒã€‚è€Œåœ¨Smalltalkä¸­ï¼Œè¿™ç§ç­‰ä»·å…³ç³»æ·±åˆ»å½±å“äº†æˆ‘ä»¬çš„æ€è·¯å’Œå»ºæ¨¡ä¹ æƒ¯ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„é¢å‘å¯¹è±¡è¯­è¨€éƒ½ä»Smalltalkä¸­å€Ÿé‰´äº†å¤§é‡çš„æ¦‚å¿µã€‚è€Œæ—©æœŸçš„å»ºæ¨¡è€…ä¹Ÿå¤§éƒ½æ¥è‡ªSmalltalkç¤¾åŒºï¼Œæ¯”å¦‚Peter Coadã€Kent Beckã€Martin Fowlerç­‰ï¼ˆå½“ç„¶æˆ‘ä¹Ÿæ˜¯ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å­¦ä¹ å»ºæ¨¡æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ–å¤šæˆ–å°‘æœ‰ä¸€äº›æºè‡ªSmalltalkç¤¾åŒºçš„ä¹ æƒ¯ã€‚</p><p>ç„¶è€Œéšç€æ—¶ä»£çš„å‘å±•ï¼Œè¿™ç§ä¹ æƒ¯åœ¨å¤šå±‚æ¶æ„ï¼ˆMulit-tier Architectureï¼‰ä¸‹é‡åˆ°äº†æŒ‘æˆ˜ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹çœ‹å¤šå±‚æ¶æ„æ˜¯æ€ä¹ˆå½»åº•å‰²è£‚äº†é›†åˆä¸æ•°æ®åº“çš„ã€‚</p><h3>å¤šå±‚æ¶æ„å½»åº•å‰²è£‚äº†é›†åˆä¸æ•°æ®åº“</h3><p>Smalltalkåœ¨ä¸­å›½æœªæ›¾çœŸæ­£åœ°æµè¡Œè¿‡ï¼Œå¤§å¤šæ•°äººæ˜¯ä»C++ç”šè‡³æ˜¯Javaã€.NETå¼€å§‹æ¥è§¦é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ã€‚è€Œæ— è®ºæ˜¯C++ã€Javaï¼Œè¿˜æ˜¯åæ¥çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œå…¶å®éƒ½ä¸æ˜¯å®Œæ•´çš„é¢å‘å¯¹è±¡ç³»ç»Ÿã€‚</p><p>é›†åˆä½œä¸ºé¢å‘å¯¹è±¡ä¸­çš„é‡è¦æ¦‚å¿µï¼Œè¢«å¸çº³å…¥è¿™äº›è¯­è¨€åï¼Œå°±å»æ‰äº†ä¸æ•°æ®åº“çš„å¼ºå…³è”ï¼ˆæ¯•ç«Ÿè¿™äº›è¯­è¨€é»˜è®¤ä¸å¸¦æœ‰æ•°æ®åº“æ¨¡å—ï¼‰ã€‚å› æ­¤ï¼Œé›†åˆè™½ç„¶åœ¨æ¦‚å¿µä¸Šä»ç„¶ç­‰åŒäºæ•°æ®åº“ï¼Œä½†å¦‚æ­¤ç®€å•ç²—æš´çš„å»ºæ¨¡ï¼Œå°±ä¼šé‡åˆ°æˆ‘ä»¬å‰é¢æåˆ°çš„â€œæ˜¯å¦N+1â€çš„ä¸¤éš¾é€‰æ‹©ã€‚</p><p>é‚£ä¹ˆJavaã€.NETè¿™äº›è¯­è¨€ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿå®ƒä»¬ä¸ºä»€ä¹ˆä¸èƒ½åƒSmalltalkä¸€æ ·ï¼Œå†…æ¶µå®Œæ•´åœ°é¢å¯¹è±¡æ•°æ®åº“å‘¢ï¼Ÿè¿™å…¶å®æ˜¯æ¶æ„é£æ ¼æ¼”åŒ–çš„ç»“æœã€‚</p><p>æˆ‘ä»¬æ˜æ˜¾å¯ä»¥å‘ç°ï¼Œ<strong>Smalltalkæ˜¯å…¸å‹çš„å•æœºå•ä½“æ¶æ„</strong>ã€‚ä»æ“ä½œç³»ç»Ÿã€æ•°æ®åº“åˆ°åº”ç”¨ç¨‹åºï¼Œéƒ½åœ¨ä¸€ä¸ªè™šæ‹Ÿæœºä¸Šï¼Œå°±å¥½åƒæ˜¯ä¸€å°å°å‹æœºä¸€æ ·ã€‚è¿™æ ·çš„<strong>æ¶æ„ç»“æ„æ— æ³•æ°´å¹³æ‰©å±•</strong>ï¼ˆhorizontal scalingï¼‰<strong>ï¼Œåªèƒ½å‚ç›´æ‰©å±•</strong>ï¼ˆvertical scalingï¼‰ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦<strong>ä¸æ–­æé«˜å•ç‚¹çš„è®¡ç®—èƒ½åŠ›ï¼Œæ‰èƒ½æé«˜æ•´ä¸ªçš„å®¹é‡ä¸åå</strong>ã€‚è¿™å¹¶ä¸ç¬¦åˆæ¶æ„çš„æ•´ä½“å‘å±•è¶‹åŠ¿ã€‚</p><p>è¿›å…¥21ä¸–çºªåï¼Œéšç€å¯¹ç³»ç»Ÿå®¹é‡è¦æ±‚çš„å¢åŠ ï¼Œæ˜“äºæ°´å¹³æ‰©å±•çš„ä¸‰å±‚æ¶æ„é€æ¸æˆä¸ºè¡Œä¸šä¸»æµã€‚è€Œæ•°æ®åº“ä½œä¸ºä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ï¼Œåˆ™ä¸å†ä¸åº”ç”¨åˆä½“ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/11/2a/11142c4ab83c9ef344e7e811c274b02a.jpg?wh=8000x4500\" alt=\"\"></p><p>äºæ˜¯ï¼ŒSmalltalkçš„é¢å‘å¯¹è±¡ç³»ç»Ÿåœ¨è¿™ç§æ¶æ„ä¸‹åˆ†åˆ«å˜æˆäº†ï¼šåº”ç”¨ç¨‹åºä¸­é—´ä»¶ï¼ˆå¯¹åº”Smalltalkè™šæ‹Ÿæœºï¼‰å’Œæ•°æ®åº“ï¼ˆå¯¹åº”Smalltalkè™šæ‹Ÿé•œåƒçš„æŒä¹…åŒ–æ•°æ®éƒ¨åˆ†ï¼‰ã€‚</p><p>å¤šå±‚æ¶æ„å½»åº•å‰²è£‚äº†å¯¹è±¡é›†åˆä¸æ•°æ®åº“ï¼Œè¿™å¯¹æˆ‘ä»¬å®ç°é¢†åŸŸæ¨¡å‹å»ºæ¨¡æå‡ºäº†æŒ‘æˆ˜ï¼Œå¯¹Collectioné€»è¾‘çš„å»ºæ¨¡ä¹Ÿå°±éš¾ä»¥æ‘†è„±å…·ä½“å®ç°ç»†èŠ‚äº†ã€‚é‚£å°±æ˜¯æˆ‘ä»¬<strong>å¿…é¡»æ˜ç¡®å“ªäº›æ˜¯æŒä¹…åŒ–çš„æ•°æ®ï¼Œå¹¶å¯¹å®ƒçš„ä¸€äº›é€»è¾‘åŒºåˆ«å¯¹å¾…</strong>ã€‚è¿™å°±æ˜¯åŸå‘³é¢å‘å¯¹è±¡èŒƒå‹ï¼ˆVanilla Object Orientedï¼‰ï¼Œåœ¨æ¶æ„é£æ ¼æ¼”åŒ–è¿‡ç¨‹ä¸­é‡åˆ°çš„æŒ‘æˆ˜ã€‚</p><p>å‡ ä¹æ‰€æœ‰å®æ–½è¿‡DDDçš„äººï¼Œéƒ½åœ¨è¿™ä¸ªé—®é¢˜ä¸ŠæŒ£æ‰è¿‡ã€‚å¦‚æœå¯¹äºå¦‚æ­¤å¸¸è§ä¸”å¦‚æ­¤ç®€å•çš„åˆ†é¡µåŠŸèƒ½ï¼Œæˆ‘ä»¬éƒ½æ— æ³•å°†æ¨¡å‹ä¸è½¯ä»¶å®ç°å…³è”çš„è¯ã€‚é‚£ä¹ˆï¼Œé¢å¯¹æ›´å¤æ‚çš„é—®é¢˜æ—¶æˆ‘ä»¬è¦æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™æ˜¯å¤§å¤šæ•°æ€€æ£ç†æƒ³å‡†å¤‡å®æ–½DDDçš„äººï¼Œç¢°åˆ°çš„ç¬¬ä¸€ä¸ªé˜»ç¢ã€‚</p><p>å…³è”å¯¹è±¡å°±æ˜¯ä¸€ç§è§£å†³è¿™ä¸ªé—®é¢˜çš„è®¾è®¡æ¨¡å¼ã€‚</p><h2>å…³è”å¯¹è±¡</h2><p><strong>å…³è”å¯¹è±¡</strong>ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯<strong>å°†å¯¹è±¡é—´çš„å…³è”å…³ç³»ç›´æ¥å»ºæ¨¡å‡ºæ¥ï¼Œç„¶åå†é€šè¿‡æ¥å£ä¸æŠ½è±¡çš„éš”ç¦»ï¼ŒæŠŠå…·ä½“æŠ€æœ¯å®ç°ç»†èŠ‚å°è£…åˆ°æ¥å£çš„å®ç°ä¸­</strong>ã€‚è¿™æ ·æ—¢å¯ä»¥ä¿è¯æ¦‚å¿µä¸Šçš„ç»Ÿä¸€ï¼Œåˆèƒ½å¤Ÿé¿å…æŠ€æœ¯å®ç°ä¸Šçš„é™åˆ¶ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹æå®¢æ—¶é—´ä¸“æ çš„ä¾‹å­ï¼Œå¦‚æœä½¿ç”¨å…³è”å¯¹è±¡ï¼Œå¦‚ä½•å¸®æˆ‘ä»¬é¿å…N+1å’Œé€»è¾‘æ³„éœ²çš„é—®é¢˜ã€‚</p><h3>ä½¿ç”¨å…³è”å¯¹è±¡å®ç°èšåˆå…³ç³»</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰å…³è”å¯¹è±¡ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è¡¨è¾¾çš„æ˜¯Userä¸Subscriptioné—´çš„ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œé‚£ä¹ˆæœ€ç®€å•çš„å‘½åæ–¹æ³•æ˜¯å°†ä¸¤ä¸ªå¯¹è±¡åå­—ç»„åˆï¼Œä»è€Œå¾—åˆ°å…³è”å¯¹è±¡çš„åå­—UserSubscriptionsï¼š</p><pre><code>public interface UserSubscriptions extends Iterable&lt;Subscription&gt; {\n   List&lt;Subscription&gt; subList(int from, int to); //åˆ†é¡µ\n   double getTotalSubscriptionFee(); //è·å–æ€»å…±èŠ±è´¹\n   int count(); //è·å–æ€»è®¢é˜…æ•°\n   Iterable&lt;Subscription&gt; sort(...);\n   ....\n}\n</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬æœ€å¥½æ˜¯ä»ä¸šåŠ¡ä¸Šä¸‹æ–‡å‡ºå‘ï¼Œå¯»æ‰¾æ›´å…·æœ‰ä¸šåŠ¡å«ä¹‰çš„åå­—ï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯è¦å½¢æˆç»Ÿä¸€è¯­è¨€çš„ï¼Œæºè‡ªä¸šåŠ¡çš„åå­—æ€»æ˜¯æ›´å®¹æ˜“è¢«éæŠ€æœ¯è§’è‰²æ‰€ç†è§£ã€‚</p><p>æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬è¦è¡¨è¾¾çš„æ˜¯ç”¨æˆ·å·²ç»è®¢é˜…çš„ä¸“æ ï¼Œæˆ–è€…æ˜¯ç”¨æˆ·å·²ç»è´­ä¹°çš„ä¸“æ ï¼Œé‚£ä¹ˆPaidColumnï¼Œç”šè‡³MySubscriptionsï¼Œéƒ½ä¸é”™ï¼Œçœ‹å“ªä¸€ä¸ªæ›´å®¹æ˜“è¢«å›¢é˜Ÿæ¥å—äº†ã€‚æˆ‘è¿™é‡Œé€‰æ‹©MySubscriptionsï¼Œäºæ˜¯Userå¯¹è±¡å°±å˜æˆäº†è¿™æ ·ï¼š</p><pre><code>public interface MySubscriptions extends Iterable&lt;Subscription&gt; {\n...\n}\n\n\npublic class User {\n  private MySubscriptions mySubscriptions;\n  \n  public MySubscriptions getMySubscriptions() {\n     return mySubscriptions\n  }\n}\n</code></pre><p>é‚£ä¹ˆä¹‹å‰å¯¹äºåˆ†é¡µå’Œè®¡ç®—çš„è°ƒç”¨ä¹Ÿå°±ç›¸åº”åœ°å˜ä¸ºï¼š</p><pre><code>user.getMySubscriptions().subList(0, 10);\nuser.getMySubscriptions().getTotalSubscriptionFee();\n</code></pre><p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬æ²¡æœ‰é€»è¾‘æ³„éœ²ï¼ŒUseræ˜¯Subscriptionçš„èšåˆæ ¹ï¼Œé‚£ä¹ˆä¸ä¹‹ç›¸å…³çš„é€»è¾‘ä¹Ÿä»ç„¶è¢«å°è£…åœ¨Userçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå½“ç„¶æ˜¯è¿›ä¸€æ­¥è¢«å°è£…åœ¨å…³è”å¯¹è±¡ä¸­ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè§£å†³æŒä¹…åŒ–çš„é—®é¢˜å‘¢ï¼Ÿæ€ä¹ˆä»é¢†åŸŸå¯¹è±¡ä¸­ï¼Œç§»é™¤æ‰å¯¹æŠ€æœ¯å®ç°çš„ä¾èµ–å‘¢ï¼Ÿç§˜è¯€å°±åœ¨äº<strong>æ¥å£ä¸å®ç°åˆ†ç¦»</strong>ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>package model.impl.db;\n\n\npublic class MySubscriptionsDB implements MySubscriptions {\n  ...\n  private User user;\n\n\n  public List&lt;Subscription&gt; subList(int from, int to) {\n    return db.executeQuery(...);\n  }\n  ...\n</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä¸æ•°æ®åº“è®¿é—®ç›¸å…³çš„é€»è¾‘æ¯«ä¸é¿è®³åœ°å°è£…åˆ°MySubscriptionsDBä¸­ã€‚ä¸è¿‡ï¼Œä½œä¸ºé¢†åŸŸå¯¹è±¡çš„Userç±»ï¼Œå¹¶ä¸ä¼šçŸ¥é“å®ƒä½¿ç”¨äº†æ•°æ®åº“ï¼Œå› ä¸ºå®ƒä»…ä»…é€šè¿‡MySubscriptionsæ¥å£ï¼Œè®¿é—®å®ƒæ‰€éœ€è¦çš„åŠŸèƒ½ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„åˆ†åŒ…çš„ç­–ç•¥ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e8/04/e8c35b784e7ec2553df31d7c1c364004.jpg?wh=7164x3335\" alt=\"\"></p><p>ä»ä¸Šå›¾ä¸­åŒ…çš„æ¶æ„ä¸Šçœ‹ï¼Œæ¨¡å‹çš„åŒ…ä¸­æœ‰MySubscriptionsã€Userã€UserRepositoryã€‚ä¸æ•°æ®åº“ç›¸å…³çš„ä»£ç çš„åŒ…é‡Œæœ‰MySubscriptionsDBå’ŒUserRepositoryDBã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†æ ¸å¿ƒçš„é¢†åŸŸé€»è¾‘ä¸å®ç°ç»†èŠ‚åˆ†å¼€äº†ã€‚</p><p>å½“ç„¶æœ€åè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼š<strong>å¦‚ä½•å°†MySubscriptionsDBä¸Userç»“åˆåœ¨ä¸€èµ·</strong>ï¼Ÿæœ€ç›´æ¥çš„åšæ³•å°±æ˜¯è¿™æ ·ï¼š</p><pre><code>public UserRepositoryDB implements UserRepository {\n  ...\n  public User findBy(long id) {\n      User user = .....;\n      return setMySubscription(user);\n  }\n  \n  public List&lt;User&gt; findBy(....) {\n      List&lt;User&gt; user = .....;\n      return user.map(user -&gt; setMySubscription(user));\n  }\n  \n  private User setMySubscription(User user) {\n      user.setMySubscriptions(new MySubscriptionDB(db, user));\n      return user;      \n  }\n}\n</code></pre><p>å› ä¸ºUseræ˜¯èšåˆæ ¹ï¼Œä»æ•°æ®åº“ä¸­è¯»å–çš„Userå¯¹è±¡éƒ½éœ€è¦ä»UserRepositoryä¸­è·å–ã€‚é‚£ä¹ˆï¼Œåœ¨UserRepositoryçš„å…·ä½“å®ç°ä¸­ä¸ºUserå¯¹è±¡è®¾ç½®MySubscriptionå¯¹è±¡ï¼Œæ˜¯å†è‡ªç„¶ä¸è¿‡çš„é€‰æ‹©äº†ã€‚</p><p>å½“ç„¶æ›´ç®€æ´æ¼‚äº®çš„åšæ³•ï¼Œæ˜¯é€šè¿‡Java CDI APIæˆ–æ˜¯æ¡†æ¶æä¾›çš„ç”Ÿå‘½å‘¨æœŸå®è·µç›‘å¬å™¨ï¼Œæ¥å®Œæˆå…³è”å¯¹è±¡çš„è®¾ç½®ã€‚</p><h3>éš”ç¦»æŠ€æœ¯å®ç°ç»†èŠ‚ä¸é¢†åŸŸé€»è¾‘</h3><p>é€šè¿‡å¼•å…¥å…³è”å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°éš”ç¦»é¢†åŸŸé€»è¾‘ä¸æŠ€æœ¯å®ç°ç»†èŠ‚ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨æå®¢æ—¶é—´ä¸“æ çš„ä¾‹å­æ¥è§£é‡Šã€‚</p><p>å¦‚æœè¿™æ—¶å€™Subscriptionä¿¡æ¯å¹¶ä¸æ˜¯å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œæ˜¯é€šè¿‡RESTful APIä»å¦ä¸€ä¸ªç³»ç»Ÿä¸­è·å–çš„ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åªéœ€æä¾›å¦ä¸€ä¸ªMySubscriptionsçš„å®ç°å°±å¯ä»¥äº†ï¼š</p><pre><code>package model.impl.api;\n\n\npublic class MySubscriptionsAPI implements MySubscriptions {\n  ...\n  private User user;\n\n\n  public List&lt;Subscription&gt; subList(int from, int to) {\n    return client.findSubscriptions(....);\n  }\n  ...\n</code></pre><p>è¿™ç§æ”¹å˜å¹¶ä¸ä¼šä¼ é€’åˆ°é¢†åŸŸé€»è¾‘å±‚ï¼Œå¯¹äºåˆ†é¡µå’Œè®¡ç®—çš„è°ƒç”¨ä»ç„¶ä¸ºï¼š</p><pre><code>user.getMySubscriptions().subList(0, 10);\nuser.getMySubscriptions().getTotalSubscriptionFee();\n</code></pre><p>RESTful APIçš„æ€§èƒ½ç“¶é¢ˆå’Œéœ€è¦è°ƒæ•´çš„åœ°æ–¹ä¸æ•°æ®åº“ä¸åŒï¼Œè¿™ç§å˜åŒ–éƒ½è¢«å…³è”å¯¹è±¡çš„æ¥å£å°è£…éš”ç¦»äº†ã€‚</p><p>ä»é¢å‘å¯¹è±¡ç¼–ç¨‹çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£ä¸ºä»€ä¹ˆå…³è”å¯¹è±¡å¯ä»¥å¸¦æ¥å¦‚æ­¤å¤šçš„å¥½å¤„ã€‚åœ¨è¯¸å¤šé¢å‘å¯¹è±¡çš„æœ€ä½³å®è·µä¸­ï¼Œæœ‰ä¸€æ¡æ˜¯è¯´è¦å°½å¯èƒ½é¿å…ä½¿ç”¨åŸå§‹ç±»å‹ï¼ˆprimitive typeï¼‰ã€‚å› ä¸ºåŸå§‹ç±»å‹æ²¡æœ‰å¯¹æ¦‚å¿µè¿›è¡Œæå–ï¼Œä¹Ÿç¼ºä¹å°è£…ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½åœ°ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å»æ›¿æ¢å®ƒä»¬ã€‚</p><p>ä¸è¿‡å¦‚æœæˆ‘ä»¬æŠŠè¯­è¨€å†…æä¾›çš„é›†åˆç±»å‹ï¼ˆListç­‰ï¼‰ä¹Ÿå½“ä½œåŸå§‹ç±»å‹çš„è¯ï¼Œå…³è”å¯¹è±¡å°±æ˜¯å¯¹è¿™ä¸€æ¡å»ºè®®è‡ªç„¶çš„æ‰©å±•ï¼š<strong>ä½¿ç”¨è‡ªå®šä¹‰å…³è”å¯¹è±¡ï¼Œè€Œä¸æ˜¯é›†åˆç±»å‹æ¥è¡¨ç¤ºå¯¹è±¡é—´çš„å…³è”</strong>ã€‚</p><h3>é€šè¿‡é›†ä½“é€»è¾‘æ­ç¤ºæ„å›¾</h3><p>å…³è”å¯¹è±¡é™¤äº†å¯ä»¥å¸®åŠ©èšæ‹¢é€»è¾‘ã€éš”ç¦»å®ç°ç»†èŠ‚ä¹‹å¤–ï¼Œè¿˜èƒ½ä»æ¦‚å¿µä¸Šå¸®åŠ©æˆ‘ä»¬è·å¾—æ›´å¥½çš„é¢†åŸŸæ¨¡å‹ï¼Œå› ä¸ºå…³è”å¯¹è±¡æ˜¯å¯¹é›†ä½“é€»è¾‘çš„ç›´æ¥å»ºæ¨¡ã€‚</p><p>æ‰€è°“<strong>é›†ä½“é€»è¾‘ï¼Œæ˜¯æŒ‡ä¸ªä½“ä¸å…·å¤‡ï¼Œè€Œæˆä¸ºä¸€ä¸ªé›†ä½“ä¹‹åæ‰å…·å¤‡çš„èƒ½åŠ›ã€‚å“ªæ€•æ˜¯åŒä¸€ç¾¤ä¸ªä½“ï¼Œç»„æˆäº†ä¸åŒçš„é›†ä½“ï¼Œå°±ä¼šå…·æœ‰ä¸åŒçš„é€»è¾‘</strong>ã€‚</p><p>æˆ‘ä»¬ä»ç„¶å›åˆ°æå®¢æ—¶é—´ä¸“æ çš„ä¾‹å­ä¸Šï¼Œæ¥å¸®åŠ©ä½ ç†è§£ã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨çš„æ¨¡å‹æ˜¯è¿™æ ·çš„ï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/72/a2/7288282fa92473a66ef9d012d90b6aa2.jpg?wh=7000x2908\" alt=\"\"></p><pre><code>public class User {\n   private List&lt;Subscription&gt; subscriptions;\n   \n   ....\n}\n\n\npublic class Column {\n    private List&lt;Subscription&gt; subscriptions;\n    \n    ....\n}\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒUserä¸­çš„List<subscription>è¡¨ç¤ºç”¨æˆ·å·²è®¢é˜…çš„æ‰€æœ‰ä¸“æ ï¼Œè€ŒColumnä¸­çš„List<subscription>ï¼Œåˆ™è¡¨ç¤ºæ‰€æœ‰è®¢é˜…äº†ä¸“æ çš„ç”¨æˆ·ã€‚è™½ç„¶åŒä¸ºSubscriptionçš„é›†åˆï¼Œä½†æ˜¯å½“å®ƒä»¬ç»„æˆé›†ä½“æ—¶ï¼Œåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­åˆ™å…·æœ‰ä¸åŒçš„å«ä¹‰ã€‚</subscription></subscription></p><p>é‚£ä¹ˆå¦‚æœæ˜¾å¼åœ°è¡¨è¾¾ä¸ºå…³è”å¯¹è±¡ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ¾„æ¸…æˆ‘ä»¬çš„æ„å›¾ï¼Œå¾—åˆ°æ­ç¤ºæ„å›¾çš„æ¥å£ï¼ˆIntention Revealing Interfaceï¼‰ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class User {\n\n\n   public static interface MySubscriptions extends Iterable&lt;Subscription&gt; {\n   ...\n   }\n   \n   private MySubscriptions mySubscriptions;\n   \n   ...\n}\n\n\npublic class Column {\n\n\n    public static interface MyReaders extends Iterable&lt;Subscription&gt; {\n    ...\n    }\n    \n    private MyReaders myReadersï¼›\n\n\n    ..\n</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¼•å…¥å…³è”å¯¹è±¡ï¼Œå¯ä»¥å°†è¿™ä¸¤ä¸ªä¸åŒçš„é›†ä½“å˜æ›´ä¸ºUser.MySubscriptionså’ŒColumn.MyReadersï¼Œç„¶ååœ¨å„è‡ªçš„ä¸Šä¸‹æ–‡å»å®šä¹‰ä¸åŒçš„é›†ä½“é€»è¾‘ã€‚</p><p>æ¯”å¦‚æˆ‘è®¢é˜…çš„ä¸“æ å¯ä»¥è®¡ç®—æˆ‘ä¸€å…±ä»˜äº†å¤šå°‘é’±ï¼Œè€Œåœ¨æˆ‘çš„è¯»è€…ä¸­ï¼Œå¯ä»¥è®¡ç®—è®¢é˜…è€…å¯¹ä¸“æ çš„å¹³å‡æ‰“åˆ†æƒ…å†µï¼Œç¤ºæ„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public static interface MySubscriptions extends Iterable&lt;Subscription&gt; {\n  double getTotalFee();\n}\n\n\npublic static interface MyReaders extends Iterable&lt;Subscription&gt; {\n  double getAverageRating();\n}\n</code></pre><h2><strong>å°ç»“</strong></h2><p>æˆ‘ä»¬æ¥ç®€å•åœ°æ€»ç»“ä¸€ä¸‹ã€‚éšç€æ¶æ„é£æ ¼çš„æ¼”åŒ–ä¸æ”¹å˜ï¼Œé¢å‘å¯¹è±¡æŠ€æœ¯ä¸­çš„é›†åˆï¼Œä»ä¸æ•°æ®åº“å®Œå…¨ç­‰ä»·ï¼Œå˜æˆäº†ä¸æ•°æ®åº“å®Œå…¨å‰²è£‚çš„ä¸œè¥¿ã€‚</p><p>ç„¶è€Œåœ¨æ¦‚å¿µä¸Šï¼Œæˆ‘ä»¬ä»ç•™æœ‰<strong>é€šè¿‡é›†åˆå°è£…å†…å­˜ä¸­çš„å¯¹è±¡ä¸æ•°æ®åº“ä¸­çš„æ•°æ®</strong>çš„ä¹ æƒ¯ã€‚è¿™ä½¿å¾—æˆ‘ä»¬åœ¨ä½¿ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡çš„æ—¶å€™ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨èšåˆå…³ç³»çš„æ—¶å€™ï¼Œå˜å¾—å·¦å³ä¸ºéš¾ï¼š<strong>è¦ä¹ˆæ”¾å¼ƒæ€§èƒ½ï¼Œè·å¾—æ›´å¥½çš„æ¨¡å‹ï¼›è¦ä¹ˆæ³„éœ²é€»è¾‘ï¼Œä»¥å¾—åˆ°å¯æ¥å—çš„æ€§èƒ½</strong>ã€‚</p><p>ä½†æ˜¯å…³è”å¯¹è±¡ï¼Œåˆ™å¯ä»¥è®©æˆ‘ä»¬åœ¨æ›´åŠ æ˜ç¡®æ­ç¤ºæ„å›¾çš„åŒæ—¶ï¼Œå»è§£å†³æ€§èƒ½ä¸é€»è¾‘å°è£…çš„é—®é¢˜ã€‚æˆ‘ä¸ªäººä»å¾ˆæ—©å°±å¼€å§‹å°†å…³è”å¯¹è±¡ä½œä¸ºå®ç°èšåˆå…³ç³»çš„é»˜è®¤æ–¹æ³•äº†ï¼Œå®ƒä»æœªè®©æˆ‘å¤±æœ›ï¼ˆit never fails meï¼‰ã€‚æˆ‘å»ºè®®ä½ ä¹Ÿè¯•ä¸€è¯•ï¼Œè¿™æ ·æˆ‘å°±ä¸ç”¨ç»™ä½ è§£é‡Šä»€ä¹ˆå«æƒŠå–œäº†ã€‚</p><p>ç¼–è¾‘å°æç¤ºï¼šä¸ºäº†æ–¹ä¾¿è¯»è€…é—´çš„äº¤æµå­¦ä¹ ï¼Œæˆ‘ä»¬å»ºç«‹äº†å¾®ä¿¡è¯»è€…ç¾¤ã€‚æƒ³è¦åŠ å…¥çš„åŒå­¦ï¼Œæˆ³æ­¤åŠ å…¥<a href=\"https://jinshuju.net/f/wjtvTP\">â€œå¦‚ä½•è½åœ°ä¸šåŠ¡å»ºæ¨¡â€äº¤æµç¾¤</a>&gt;&gt;&gt;</p><h2>æ€è€ƒé¢˜</h2><p>å…³è”å¯¹è±¡å®é™…ä¸Šæ˜¯é€šè¿‡å°†éšå¼çš„æ¦‚å¿µæ˜¾å¼åŒ–å»ºæ¨¡æ¥è§£å†³é—®é¢˜çš„ï¼Œè¿™æ˜¯é¢å‘å¯¹è±¡æŠ€æœ¯è§£å†³é—®é¢˜çš„é€šåˆ™ï¼šæ°¸è¿œå¯ä»¥é€šè¿‡å¼•å…¥å¦ä¸€ä¸ªå¯¹è±¡è§£å†³é—®é¢˜ã€‚é‚£ä¹ˆåœ¨é¢†åŸŸæ¨¡å‹ä¸­è¿˜æœ‰å“ªäº›éšå¼æ¦‚å¿µå‘¢ï¼Ÿè¿™äº›æ¦‚å¿µä¼šç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/f8/cd/f8900fc84acabbc502b519bf358786cd.jpg?wh=1500x1798\" alt=\"\"></p><p>æ¬¢è¿æŠŠä½ çš„æ€è€ƒå’Œæƒ³æ³•åˆ†äº«åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šå’Œä½ äº¤æµã€‚åŒæ—¶å‘¢ï¼Œæˆ‘ä¹Ÿä¼šæŠŠå…¶ä¸­ä¸€äº›ä¸é”™çš„å›ç­”ç½®é¡¶ï¼Œä¾›å¤§å®¶å­¦ä¹ ã€‚</p>","comments":[{"had_liked":false,"id":300418,"user_name":"Geek_3531cc","can_delete":false,"product_type":"c1","uid":1549138,"ip_address":"","ucode":"E9FBABBB15CD95","user_header":"","comment_is_top":true,"comment_ctime":1625149367,"is_pvip":false,"replies":[{"id":"108878","content":"å¯ä»¥åœ¨å…³è”å¯¹è±¡ä¸Šç›´æ¥å¢åŠ æ–¹æ³•ï¼Œå…³è”å¯¹è±¡è¡¨ç¤ºèšåˆé€»è¾‘ã€‚çµæ´»å¾ˆå¤š","user_name":"ä½œè€…å›å¤","comment_id":300418,"uid":"2537798","ip_address":"","utype":1,"ctime":1625153248,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"9.2233720599548006e+18","product_id":100082101,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„å¥½æ–‡ç« ã€‚æˆ‘è¿™è¾¹æœ‰ä¸ªç–‘é—®ï¼Œä¸“æ èšåˆäº†å†…å®¹åŒç†ä¹Ÿå¯ä»¥ç”¨å…³è”å¯¹è±¡æ¨¡å¼ï¼Œé‚£å¦‚æœä½œè€…éœ€è¦å¯¹ä¸“æ é‡Œçš„å…¶ä¸­ä¸€ä¸ªå†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œéœ€è¦å…ˆè·å–ä¸“æ ç„¶åé€šè¿‡å…³è”å¯¹è±¡è·å–è¦ä¿®æ”¹çš„å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œå†å°†æ•´ä¸ªä¸“æ èšåˆè¿›è¡Œä¿å­˜ï¼Œè¿™æ ·æ˜¯å¦è¿˜æ˜¯æ²¡æœ‰ä¿éšœåˆ°æ€§èƒ½å‘¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522728,"discussion_content":"å¯ä»¥åœ¨å…³è”å¯¹è±¡ä¸Šç›´æ¥å¢åŠ æ–¹æ³•ï¼Œå…³è”å¯¹è±¡è¡¨ç¤ºèšåˆé€»è¾‘ã€‚çµæ´»å¾ˆå¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625153248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300604,"user_name":"é˜¿é¸¡","can_delete":false,"product_type":"c1","uid":1589246,"ip_address":"","ucode":"F181422D4EB444","user_header":"https://static001.geekbang.org/account/avatar/00/18/3f/fe/35d1afbd.jpg","comment_is_top":false,"comment_ctime":1625238304,"is_pvip":false,"replies":[{"id":"108913","content":"è¿™æ ·userå°±é€€åŒ–ä¸ºçº¯ç²¹çš„æ— é€»è¾‘æ•°æ®å¯¹è±¡äº†ï¼Œä¹Ÿå°±æ˜¯è´«è¡€å¯¹è±¡","user_name":"ä½œè€…å›å¤","comment_id":300604,"uid":"2537798","ip_address":"","utype":1,"ctime":1625269686,"user_name_real":"å¾å…«å‰"}],"discussion_count":6,"race_medal":0,"score":"57459813152","product_id":100082101,"comment_content":"æƒ³è¯·é—®ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨UserRepositoryä¸­æ·»åŠ å…³äºåˆ†é¡µçš„é€»è¾‘ï¼Ÿè™½ç„¶èƒ½æ„Ÿè§‰åˆ°ä¸å¤ªæ°å½“ï¼Œä½†æ˜¯å¥½åƒä¹Ÿæ²¡æš´éœ²é€»è¾‘ï¼Œå¹¶ä¸”userä¹Ÿæ²¡ä¾èµ–å…·ä½“dbå®ç°","like_count":14,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522776,"discussion_content":"è¿™æ ·userå°±é€€åŒ–ä¸ºçº¯ç²¹çš„æ— é€»è¾‘æ•°æ®å¯¹è±¡äº†ï¼Œä¹Ÿå°±æ˜¯è´«è¡€å¯¹è±¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625269686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206912,"avatar":"","nickname":"wwlleo","note":"","ucode":"5119810EA156F9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583040,"discussion_content":"æˆ‘è§‰å¾—æ”¾åœ¨UserRepositoryé‡Œä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯æœ¬è´¨æ ¸å¿ƒæ˜¯éœ€è¦è¿™ä¸ªgetMySubscriptions()æ¥æ˜¾å¼çš„è¯´æ˜ï¼Œè¿™é‡Œæ‹¿åˆ°çš„Listï¼Œæ˜¯ â€œæˆ‘çš„è®¢é˜…â€  ï¼Œè€Œä¸æ˜¯ ä¸€ä¸ª éšä¾¿çš„Listæ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659881984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2076069,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/ad/a5/4b7351b1.jpg","nickname":"Ken","note":"","ucode":"BA2193542A4705","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557291,"discussion_content":"å…«è‚¡æ–‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647756501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550159,"discussion_content":"åŒé—®ï¼Œä»€ä¹ˆ User å°±å˜æˆè´«è¡€å¯¹è±¡äº†ï¼Ÿæ˜¯å› ä¸ºåˆ†é¡µæ“ä½œåœ¨é›†åˆå¯¹è±¡ä¸Šé¢å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644398572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1029051,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b3/bb/abb7bfe3.jpg","nickname":"rusess","note":"","ucode":"C6F46B368F3392","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405027,"discussion_content":"ä¸ºä»€ä¹ˆè¿™æ · ï¼ŒUser å°±å˜æˆè´«è¡€å¯¹è±¡äº†ï¼Ÿ ä»–ä¸æ˜¯è¿˜æœ‰ getSubscriptions  è¿™ä¸ªæ–¹æ³•å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634482865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1158603,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ad/cb/3391d24c.jpg","nickname":"Halo","note":"","ucode":"12CFC7DFF250AF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1029051,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b3/bb/abb7bfe3.jpg","nickname":"rusess","note":"","ucode":"C6F46B368F3392","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570615,"discussion_content":"åªæœ‰getã€setæ–¹æ³•ä¸å°±æ˜¯è´«è¡€å¯¹è±¡å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651836624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":405027,"ip_address":""},"score":570615,"extra":""}]}]},{"had_liked":false,"id":300711,"user_name":"webmin","can_delete":false,"product_type":"c1","uid":1047014,"ip_address":"","ucode":"98B0CA882454E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg","comment_is_top":false,"comment_ctime":1625321083,"is_pvip":true,"replies":[{"id":"108941","content":"ä¹‹å‰åœ¨ç¾å›½çš„DDDå¤§ä¼šä¸Šå¾ˆå¤šå®è·µè€…ä¸¥è‚ƒåœ°è®¨è®ºè¦ä¸è¦æ”¾å¼ƒå…³ç³»å‹æ•°æ®åº“ã€‚","user_name":"ä½œè€…å›å¤","comment_id":300711,"uid":"2537798","ip_address":"","utype":1,"ctime":1625325637,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"44574994043","product_id":100082101,"comment_content":"ä»¥å‰åªæ˜¯è§‰å¾—è¯­è¨€ä¸­å¯¹è±¡ä¸å…³ç³»å‹æ•°æ®åº“ä¹‹é—´çš„è½¬æ¢éå¸¸ä¸è‡ªç„¶ï¼Œä»æœªé—®è¿‡ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·ï¼Œæ„Ÿè°¢è€å¸ˆä»Šå¤©å¸®æˆ‘ç†æ¸…è¿™å±‚å…³ç³»ï¼ŒåŸæ¥äºŒè€…åœ¨å•ä½“æ¶æ„æ—¶æœŸæ˜¯ç­‰ä»·ï¼Œæ˜¯å› ä¸ºåæ¥åˆ†å±‚ä»¥åæ‰è¢«å‰²è£‚äº†ï¼Œæ„Ÿè§‰ç°åœ¨çš„å¤šå±‚æ˜¯æŠŠä»¥å‰åœ¨è¯­è¨€å†…éƒ¨å®ç°çš„æœºåˆ¶ç»™æ”¾å¤§åŒ–äº†ï¼Œä¸”ä¸ºäº†é€šç”¨æ€§æŠŠCRUDç­‰ç»†èŠ‚æš´éœ²å‡ºæ¥äº†ï¼Œå¯¼è‡´ç¼–ç¨‹è¯­è¨€åœ¨ä½¿ç”¨æ—¶æ„Ÿè§‰ä¸é‚£ä¹ˆè‡ªç„¶å’Œä¸€ä½“åŒ–äº†ã€‚<br><br>é€šè¿‡å°†éšå¼çš„æ¦‚å¿µæ˜¾å¼åŒ–å»ºæ¨¡ï¼Œå°±æˆ‘è‡ªå·±çš„ç†è§£æ˜¯éœ€è¦æŠŠéšè—èƒŒåæƒ³è¡¨è¾¾çš„çœŸå®æ„é€”ç»™æ‰¾å‡ºæ¥ï¼Œæ¯”å¦‚ä»Šå¤©çš„ä¾‹å­å°±æ˜¯è¦æ“ä½œæ•°æ®ï¼Œæ“ä½œæ•°æ®å¯ä»¥æ˜¯æ“ä½œæ•°æ®åº“ä¹Ÿå¯ä»¥æ˜¯æ“ä½œNOSQLç­‰å…¶å®ƒå„ç§å®ç°æ–¹å¼ï¼Œç¬¬ä¸€ååº”æ˜¯æ“ä½œæ•°æ®åº“æ˜¯ä¸€ç§æƒ¯æ€§æ€ç»´ï¼Œå®ƒå¹¶ä¸æ˜¯çœŸæ­£æƒ³è¦åšçš„äº‹ã€‚","like_count":10,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522799,"discussion_content":"ä¹‹å‰åœ¨ç¾å›½çš„DDDå¤§ä¼šä¸Šå¾ˆå¤šå®è·µè€…ä¸¥è‚ƒåœ°è®¨è®ºè¦ä¸è¦æ”¾å¼ƒå…³ç³»å‹æ•°æ®åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625325637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300446,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1625158897,"is_pvip":false,"replies":[{"id":"108896","content":"pojoæ˜¯å¹»æƒ³ cqrsæ˜¯é‚ªæ•™","user_name":"ä½œè€…å›å¤","comment_id":300446,"uid":"2537798","ip_address":"","utype":1,"ctime":1625197206,"user_name_real":"å¾å…«å‰"}],"discussion_count":3,"race_medal":0,"score":"23099995377","product_id":100082101,"comment_content":"å…³äºå†…å®¹ï¼š<br>1.åŸºç¡€ç±»å‹åæ‰§ã€‚è¿™æ˜¯ä¸€ä¸ªåå‘³é“ï¼Œä½†ä»…åœ¨ä¸ªäººæˆ–è€…å°å›¢é˜Ÿçš„å°é¡¹ç›®ä¸­èƒ½çœ‹åˆ°å®ƒè¢«è®¤çœŸå¯¹å¾…ï¼ˆä¹Ÿåªæœ‰åˆ»æ„è®­ç»ƒï¼Œè·µè¡Œä»£ç å¥èº«æ“æ—¶èƒ½è¢«è®¤çœŸå¯¹å¾…ï¼‰ã€‚ä¸€æ—¦é¡¹ç›®å˜å¤§æ—¶é—´å˜é•¿äººæ•°å˜å¤šï¼Œä¸çŸ¥ä¸è§‰å°±è¢«æŠ›å¼ƒäº†ï¼ˆæ¯•ç«Ÿè¿™ä¹ˆå†™å¯¹äºä¸ç†è§£çš„äººæ¥è¯´çœŸçš„ä¼šè¢«éª‚æ­»ã€‚ä¸€æ®µä»£ç è¦æ±‚é˜…è¯»è€…æœ‰æ¯”è¾ƒé«˜çš„è®¤çŸ¥æ‰èƒ½æœ‰æ¯”è¾ƒå¥½çš„å¯è¯»æ€§ã€‚ä»¥æ•™è‚²é˜…è¯»è€…ä¸ºå‰é¢˜çš„åŒç†å¿ƒå†™å‡ºæ¥çš„ä»£ç è¿˜ç®—å¾—ä¸ŠåŒç†å¿ƒå—ï¼Ÿï¼‰ã€‚<br>2.CQRSã€‚å°±è¿™ä¸ªåˆ†é¡µåœºæ™¯ï¼Œæˆ‘å¤šåŠæ˜¯ä»¥å•ç‹¬çš„æŸ¥è¯¢æ¨¡å‹æ¥æ‰¿æ¥ã€‚åªæœ‰åœ¨å‘½ä»¤&#47;å†™æ“ä½œæ‰ä¼šæ„å»ºèšåˆæ¥å®ç°ã€‚è¿™ä¹ˆæƒ³æ¥ï¼Œä¼¼ä¹ç ´åäº†ä¸€ä¸ªèšåˆæ¨¡å‹åº”æœ‰çš„å®Œæ•´æ€§ã€‚åœé¡¿å‡ ç§’é’Ÿï¼Œè¿™é‡Œæˆ‘æœ¬è§‰å¾—åªæ˜¯éµå¾ªCQRSï¼Œä½†å®é™…ä¸Šåªæ˜¯å•çº¯ä¸å¸Œæœ›é¢†åŸŸèšåˆå®ä½“å…·å¤‡ä»»ä½•ioæ“ä½œã€‚ç¡®å®ï¼Œè¿™æ ·æ²¡æœ‰ä¾èµ–ä»»ä½•é™¤jdkç¨‹åºåº“ä¹‹å¤–çš„æŠ€æœ¯ä»£ç ï¼Œä½†æ˜¯pojoå¯¹è±¡çš„è¡Œä¸ºè¿è¡ŒæœŸå…·å¤‡dbæ“ä½œï¼Œè€Œè¿™è‡ªç„¶åˆä¼šç‰µæ‰¯åˆ°æ¡†æ¶ï¼Œé‚£ä¹ˆè¿™ä¸ªpojoå¯¹è±¡ä¾¿ä¸å†çº¯ç²¹ï¼Œåªèƒ½ç®—æ˜¯ä¼ªpojoã€‚æ¦‚å¿µçš„å’¬æ–‡åš¼å­—æ²¡æœ‰æ„ä¹‰ï¼Œä¸è¿‡ä¼ªpojoå¤šäº†ioæ“ä½œè¿™ä¸ªä¸å¯é å› ç´ ï¼Œæµ‹è¯•éªŒè¯è‡ªç„¶ä¹Ÿå¾—å¤šäº›æ“ä½œå’Œå¿ƒæ€ï¼Œè¿™æ˜¯å¥½æ˜¯åå‘¢ï¼Œä»é•¿æœŸçœ‹åˆå¦‚ä½•ï¼Ÿã€‚åˆç†äº†æ¨¡å‹çš„æ¦‚å¿µå´æé«˜äº†è¿­ä»£ç»´æŠ¤æ—¶çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜ã€‚æ¯•ç«Ÿæˆ‘ä»¬å­¦ä¹ æ¦‚å¿µï¼Œå¹¶éæƒ³æ§ç€å»åµæ¶ï¼Œè€Œæ˜¯æƒ³é€šè¿‡æ¦‚å¿µè§£å†³è‡ªå·±çš„å®é™…é—®é¢˜ã€‚<br><br>è¯¾åé¢˜ï¼š<br>1.éšå¼æ¦‚å¿µï¼šè§„åˆ™ï¼Œæµç¨‹ï¼Œå‚æ•°ï¼ˆä¸€ä¸ªå‡½æ•°å…¥å‚å¤ªå¤šæ—¶ï¼Œå¾€å¾€ä¼šå¼•èµ·æˆ‘ä»¬çš„å…³æ³¨å’Œæ€è€ƒï¼Œçœ‹çœ‹è¿™é‡Œæ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªéšå¼çš„æ¦‚å¿µèƒ½åŒ…å«è¿™äº›å‚æ•°ï¼‰<br>2.å‘ç°æœ‰æ»åæ€§ï¼ŒåŸºæœ¬åªæœ‰åœ¨è¿­ä»£ä¸­ï¼Œåå‘³é“ç§¯ç´¯åˆ°ä¸€å®šç¨‹åº¦ï¼Œå¼•å‘æ³¨æ„ï¼Œé‡æ–°å®šä¹‰å’Œå®¡è§†æ—¶æ‰èƒ½å‘ç°ã€‚ä½†æ›´å¤šçš„æ—¶å€™æ˜¯è¢«é—æ¼ã€‚ä¸è¿‡æ¼äº†æœ¬èº«æ„Ÿè§‰ä¹Ÿå¹¶éä¸åˆç†ï¼Œä¸è§å¾—å°±æ˜¯éº»çƒ¦ã€‚","like_count":4,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522735,"discussion_content":"pojoæ˜¯å¹»æƒ³ cqrsæ˜¯é‚ªæ•™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625197206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1204178,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5f/d2/a39e5cea.jpg","nickname":"ç‹©æœˆ","note":"","ucode":"472CCBFBE77785","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381711,"discussion_content":"é¢†åŸŸæ¨¡å‹æœªå¿…è¦æ˜¯pojoå§ï¼Œ å¿ƒæ™ºè´Ÿæ‹…æ˜¯æœ‰çš„ï¼Œ DDDæœ¬èº«å°±æœ‰å¿ƒæ™ºè´Ÿæ‹…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625192148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1251111,"avatar":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","nickname":"Jxin","note":"","ucode":"4C03928388C413","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1204178,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5f/d2/a39e5cea.jpg","nickname":"ç‹©æœˆ","note":"","ucode":"472CCBFBE77785","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381749,"discussion_content":"æœªå¿…ï¼ŒæŒºå¤šæ“ä½œä¼šå‡ºç°è€å¸ˆçš„è¿™ä¸ªé—®é¢˜ã€‚æ¯”å¦‚åŸå­æ“ä½œä¸å¯æ‹†ã€‚ ä½†pojoå°±åƒä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œè¿˜æ˜¯æƒ³å°½é‡ç»´æŒã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ—¦è¿åpojoå°±è¦æ…é‡ã€‚æœ‰äº›è´Ÿæ‹…æ˜¯çŸ¥è¯†å±‚é¢çš„ï¼Œæœ‰äº›ä¸æ˜¯ï¼Œæˆ‘æŒ‡çš„æ˜¯åè€…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625198776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":381711,"ip_address":""},"score":381749,"extra":""}]}]},{"had_liked":false,"id":300882,"user_name":"èµµæ™é¾™","can_delete":false,"product_type":"c1","uid":2673605,"ip_address":"","ucode":"F15730BCA97EE0","user_header":"https://static001.geekbang.org/account/avatar/00/28/cb/c5/c1d7ca5e.jpg","comment_is_top":false,"comment_ctime":1625415705,"is_pvip":false,"replies":[{"id":"108975","content":"ä½œä¸ºé€šç”¨æ–¹æ³•å»ºæ¨¡çš„æ˜¯é›†åˆé€»è¾‘ã€‚æœ‰æ•´æ•´äº”å¹´ æˆ‘ä»¬åœ¨å…¨çƒèŒƒå›´å†… çœ‹åˆ°ä½¿ç”¨cqrsçš„é¡¹ç›®å‡ ä¹éƒ½å¤±è´¥äº† ä»ç„¶å¾ˆå¤šäººå‰èµ´åç»§ ä¸æ˜¯é‚ªæ•™æ˜¯ä»€ä¹ˆ","user_name":"ä½œè€…å›å¤","comment_id":300882,"uid":"2537798","ip_address":"","utype":1,"ctime":1625418416,"user_name_real":"å¾å…«å‰"}],"discussion_count":4,"race_medal":0,"score":"18805284889","product_id":100082101,"comment_content":"å…³è”å¯¹è±¡æˆ‘æ›´å¤šçš„æ˜¯ç”¨æ¥è§£å†³ä¸šåŠ¡ä¸Šçš„å¤šå¯¹å¤šå…³ç³»ï¼Œè‡³äºåˆ†é¡µè¿™ä¸ªé€»è¾‘ï¼Œæˆ‘å€’æ˜¯ç›®å‰è¿˜æ²¡é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼Œä¸è¿‡çœ‹å®Œæœ‰ä¸€äº›ç–‘é—®ï¼šSubscriptionè™½ç„¶é€šè¿‡æ¥å£éš”ç¦»äº†æ•°æ®åº“æ“ä½œï¼Œä½†æ˜¯å¦‚æœSubscriptionæœ¬èº«æœ‰ä¸€äº›ä¸šåŠ¡é€»è¾‘å‘¢ï¼Ÿæ˜¯å¦å°±è€ƒè™‘æŠŠæ¥å£æ¢æˆæŠ½è±¡ç±»ï¼Œåœ¨æŠ½è±¡ç±»ä¸­å®ç°ä¸šåŠ¡ï¼Ÿ<br>å¦å¤–ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ç§æ–¹å¼åº”è¯¥åªåœ¨é‡åˆ°æ•°æ®åº“æ€§èƒ½é—®é¢˜çš„æ—¶å€™ä½¿ç”¨ï¼Œä¸åº”è¯¥ä½œä¸ºé€šç”¨æ–¹æ³•æ¥ä½¿ç”¨ã€‚æœ‰ä¸€äº›å½±å“é¢†åŸŸæ¨¡å‹åªå¯¹ä¸šåŠ¡æ¨¡å‹è¿›è¡Œå®ç°çš„å•ä¸€èŒè´£ã€‚<br><br>å¦å¦å¦å¦å¤–ï¼ŒCQRSé‚ªæ•™æ‚¨å¦‚ä½•è§£è¯»çš„ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522840,"discussion_content":"ä½œä¸ºé€šç”¨æ–¹æ³•å»ºæ¨¡çš„æ˜¯é›†åˆé€»è¾‘ã€‚æœ‰æ•´æ•´äº”å¹´ æˆ‘ä»¬åœ¨å…¨çƒèŒƒå›´å†… çœ‹åˆ°ä½¿ç”¨cqrsçš„é¡¹ç›®å‡ ä¹éƒ½å¤±è´¥äº† ä»ç„¶å¾ˆå¤šäººå‰èµ´åç»§ ä¸æ˜¯é‚ªæ•™æ˜¯ä»€ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625418416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":550162,"discussion_content":"è¿˜æ˜¯æ²¡æœ‰å¤ªæ˜ç™½ï¼Œä½¿ç”¨cqrsä¸ºä»€ä¹ˆä¼šå¯¼è‡´é¡¹ç›®å¤±è´¥å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644399312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":522840,"ip_address":""},"score":550162,"extra":""}]},{"author":{"id":2673605,"avatar":"https://static001.geekbang.org/account/avatar/00/28/cb/c5/c1d7ca5e.jpg","nickname":"èµµæ™é¾™","note":"","ucode":"F15730BCA97EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382149,"discussion_content":"å¥½çš„ï¼Œé‚£æˆ‘è®¤ä¸ºæˆ‘çš„ç†è§£åŸºæœ¬å’Œæ‚¨åœ¨åŒä¸€æ¡çº¿ä¸Šï¼Œé‚£ä¸ªæˆ‘è¯•å›¾ç”¨æŠ½è±¡ç±»è§£å†³çš„é—®é¢˜ï¼Œæ‚¨é‡åˆ°è¿‡å—ï¼Ÿæ‚¨æœ‰æ²¡æœ‰æ›´å¥½çš„æ€è·¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625451382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2673605,"avatar":"https://static001.geekbang.org/account/avatar/00/28/cb/c5/c1d7ca5e.jpg","nickname":"èµµæ™é¾™","note":"","ucode":"F15730BCA97EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382112,"discussion_content":"ä¸å¥½æ„æ€æ²¡æœ‰ä»”ç»†æ£€æŸ¥ï¼Œæœ€åä¸€å¥åº”è¯¥æ˜¯ï¼šæœ‰ä¸€äº›å½±å“é¢†åŸŸã€ç±»ã€‘åªå¯¹é¢†åŸŸæ¨¡å‹è¿›è¡Œå®ç°çš„å•ä¸€èŒè´£åŸåˆ™ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ªåŸåˆ™æ˜¯åœ¨æˆ‘è‡ªå·±åšæ¶æ„çš„æ—¶å€™ç»™è‡ªå·±å®šçš„ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625416482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300396,"user_name":"Oops!","can_delete":false,"product_type":"c1","uid":1479474,"ip_address":"","ucode":"E2678CC12121A7","user_header":"https://static001.geekbang.org/account/avatar/00/16/93/32/e11fcd33.jpg","comment_is_top":false,"comment_ctime":1625139017,"is_pvip":false,"replies":[{"id":"108877","content":"éœ€è¦æŒä¹…åŒ–æˆ–è€…æ¥ç€ä¸‰æ–¹ç³»ç»Ÿçš„èšåˆ","user_name":"ä½œè€…å›å¤","comment_id":300396,"uid":"2537798","ip_address":"","utype":1,"ctime":1625149513,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"18805008201","product_id":100082101,"comment_content":"é›†åˆæ˜¯é¢å‘å¯¹è±¡æ¨¡å‹ä¸­å¹¿æ³›å­˜åœ¨çš„æ¦‚å¿µ,å¦‚æœå…¨éƒ½ä½¿ç”¨å…³è”å¯¹è±¡è¿›è¡Œå»ºæ¨¡, æ˜¯å¦ä¼šå¯¼è‡´ç±»çˆ†ç‚¸å‘¢? æœ‰ä»€ä¹ˆå¯ä»¥éµå¾ªçš„è§„åˆ™æˆ–è€…æ–¹æ³•æ¥é‰´åˆ«å“ªäº›éšå¼çš„é›†åˆæ¦‚å¿µä½¿ç”¨å…³è”å¯¹è±¡è¿›è¡Œå»ºæ¨¡æ¯”è¾ƒå¥½, å“ªäº›åˆ™ä¸ç„¶å‘¢? æ˜¯ä¸æ˜¯å¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä»…ä»…æ˜¯ç®€å•çš„åŒ…å«å…³ç³», å¯ä»¥å…ˆç”¨ç³»ç»Ÿæä¾›çš„é›†åˆå®¹å™¨æ¥å»ºæ¨¡å®ç°, ç­‰åˆ°ä¸šåŠ¡å¤æ‚äº†, éœ€è¦å¯¹è¿™ä¸ªé›†åˆè¿›è¡Œé™¤äº†å¢åˆ æ”¹æŸ¥ä¹‹å¤–çš„æ“ä½œæ—¶, å†ä½¿ç”¨å…³è”å¯¹è±¡è¿›è¡Œå»ºæ¨¡?<br><br><br><br>","like_count":4,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522724,"discussion_content":"éœ€è¦æŒä¹…åŒ–æˆ–è€…æ¥ç€ä¸‰æ–¹ç³»ç»Ÿçš„èšåˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625149513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306644,"user_name":"å¼ æŒ¯å","can_delete":false,"product_type":"c1","uid":1201810,"ip_address":"","ucode":"292EFD886FC55A","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/92/5cea89e6.jpg","comment_is_top":false,"comment_ctime":1628654917,"is_pvip":true,"replies":[{"id":"111043","content":"æ²¡","user_name":"ä½œè€…å›å¤","comment_id":306644,"uid":"2537798","ip_address":"","utype":1,"ctime":1628655477,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"14513556805","product_id":100082101,"comment_content":"è€å¸ˆæœ‰æ²¡æœ‰å¥½çš„é¡¹ç›®å’Œä»£ç ï¼Œæ¨èä¸€ä¸‹ã€‚ç»“åˆç€ç ”ç©¶ä¸‹","like_count":3,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524854,"discussion_content":"æ²¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628655477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301034,"user_name":"tongzh","can_delete":false,"product_type":"c1","uid":1041904,"ip_address":"","ucode":"EEB48527EFCE3A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/f0/fad6bf9e.jpg","comment_is_top":false,"comment_ctime":1625490939,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14510392827","product_id":100082101,"comment_content":"å…³é”®å¯¹è±¡æ¨¡å¼ï¼Œä¸ä»…æˆåŠŸè§£è€¦äº†é¢†åŸŸæ¨¡å‹å’Œå…·ä½“å®ç°ï¼Œè¿˜æˆåŠŸæ„é€ å‡ºäº†å¯Œå«çŸ¥è¯†çš„æ¨¡å‹","like_count":3},{"had_liked":false,"id":302673,"user_name":"é©¬è‹¥é£","can_delete":false,"product_type":"c1","uid":1046394,"ip_address":"","ucode":"3D0327329A10AE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","comment_is_top":false,"comment_ctime":1626328991,"is_pvip":false,"replies":[{"id":"109538","content":"å“¥ åˆ«è¿™æ ·","user_name":"ä½œè€…å›å¤","comment_id":302673,"uid":"2537798","ip_address":"","utype":1,"ctime":1626335679,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"10216263583","product_id":100082101,"comment_content":"â€œé›†åˆä½œä¸ºé¢å‘å¯¹è±¡ä¸­çš„é‡è¦æ¦‚å¿µï¼Œè¢«å¸çº³å…¥è¿™äº›è¯­è¨€åï¼Œå°±å»æ‰äº†ä¸æ•°æ®åº“çš„å¼ºå…³è”â€â€”â€”ä»è¯­è¨€æ¼”è¿›å†å²å¾—å‡ºé—®é¢˜æœ¬æºï¼Œè†œæ‹œï¼","like_count":2,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523381,"discussion_content":"å“¥ åˆ«è¿™æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626335679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300532,"user_name":"å´é¹","can_delete":false,"product_type":"c1","uid":1002113,"ip_address":"","ucode":"EB7A78CD198E33","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/81/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1625208254,"is_pvip":false,"replies":[{"id":"108905","content":"æ»¡æ˜¯æƒŠå–œï¼Œå€¼å¾—æ‹¥æœ‰","user_name":"ç¼–è¾‘å›å¤","comment_id":300532,"uid":"2189689","ip_address":"","utype":2,"ctime":1625221721,"user_name_real":"æè¾°æ´‹"}],"discussion_count":1,"race_medal":0,"score":"10215142846","product_id":100082101,"comment_content":"çœ‹åˆ°ä½œè€…thoughtWorksèƒŒæ™¯æ¯«ä¸çŠ¹è±«å°±è®¢é˜…äº†ï¼Œçœ‹åˆ°è¿™é‡Œå°±æ„Ÿè§‰å€¼å›ç¥¨ä»·äº†","like_count":2,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"ğŸ‘","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522757,"discussion_content":"æ»¡æ˜¯æƒŠå–œï¼Œå€¼å¾—æ‹¥æœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625221721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339963,"user_name":"worry","can_delete":false,"product_type":"c1","uid":1047773,"ip_address":"","ucode":"AF2BDAF6F6370E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/dd/0e17bf09.jpg","comment_is_top":false,"comment_ctime":1648515045,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5943482341","product_id":100082101,"comment_content":"å¦‚æœè®¢é˜…çš„å†…å®¹è¾ƒå¤šï¼Œæ˜¯ä¸æ˜¯åº”è¯¥å»ºæ¨¡ä¸º2ä¸ªèšåˆæ ¹ï¼Œåœ¨å®ç°é¢†åŸŸé©±åŠ¨è®¾è®¡è¿™æœ¬ä¹¦é‡Œåº”è¯¥æ˜¯è¿™æ ·å»ºè®®çš„ã€‚è¿™äº›å¹´è¢«springæ¡†æ¶ç»‘æ¶çš„javaå¼€å‘äººå‘˜å¤§ä½“ä¸ä¼šè¿™æ ·å†™ï¼Œæ€è·¯è¢«é™åˆ¶äº†ã€‚æ€è·¯å¾ˆæ–°é¢–ğŸ‘ã€‚ä½†æ˜¯ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯ä¹Ÿå°±æ„å‘³ç€æŠŠæ•°æ®è®¿é—®å¯¹è±¡æ³¨å…¥åˆ°äº†modelï¼Ÿè™½è¯´è¿™é‡Œçš„MySubscriptionsæ²¡æœ‰åŠ Repositoryï¼Œå®é™…ä¸Šå°±æ˜¯ã€‚","like_count":1},{"had_liked":false,"id":335475,"user_name":"é“¶å¤ª","can_delete":false,"product_type":"c1","uid":1051765,"ip_address":"","ucode":"B505D15F7CB839","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/75/e7c6c403.jpg","comment_is_top":false,"comment_ctime":1645531492,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5940498788","product_id":100082101,"comment_content":"MySubscriptionsè¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œå¦‚æœå¢åŠ è®¢é˜…ï¼ŒæŒä¹…åŒ–åº”è¯¥æ˜¯repoæ¥åšï¼Œä½†æ˜¯subListçš„å®ç°åˆæ˜¯ç›´æ¥è¯»å–dbçš„ï¼Œé‚£æ€ä¹ˆç»´æŠ¤ä¸¤è€…ä¹‹é—´çš„ç»Ÿä¸€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2388512,"avatar":"https://static001.geekbang.org/account/avatar/00/24/72/20/733fdd94.jpg","nickname":"ç‹å¸…","note":"","ucode":"EE352769ABFAA4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569294,"discussion_content":"æˆ‘ç†è§£subListåªåšè¯»å–ä¸åšå¢å‡ï¼Œå¢åŠ çš„èŒè´£ä»»ç„¶ç”¨user","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1651396524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305675,"user_name":"OWL","can_delete":false,"product_type":"c1","uid":1637730,"ip_address":"","ucode":"BF0B231476464F","user_header":"https://static001.geekbang.org/account/avatar/00/18/fd/62/a9587f94.jpg","comment_is_top":false,"comment_ctime":1628094430,"is_pvip":true,"replies":[{"id":"110590","content":"å¯ä»¥","user_name":"ä½œè€…å›å¤","comment_id":305675,"uid":"2537798","ip_address":"","utype":1,"ctime":1628127394,"user_name_real":"å¾å…«å‰"}],"discussion_count":1,"race_medal":0,"score":"5923061726","product_id":100082101,"comment_content":"å…³è”å¯¹è±¡ç¡®å®æ˜¯ä¸€ç§å¾ˆå·§å¦™çš„æ–¹æ³•ã€‚ä½†æ˜¯ä¹Ÿæœ‰ç–‘æƒ‘ï¼Œæ¯”å¦‚UserRepoè·å–useråï¼Œä¿®æ”¹å…¶éƒ¨åˆ†subscriptionsï¼Œå®¹æ˜“äº§ç”Ÿä¿®æ”¹é€»è¾‘åUserRepo.set(user)ã€‚è€Œå…¶å®åº”è¯¥æ˜¯åœ¨Subscriptionså…³è”å¯¹è±¡ä¸Šæ“ä½œã€‚å…³è”å¯¹è±¡éšè—äº†Subscriptionèšåˆçš„Repoã€‚<br><br>è€ŒEricçš„DDDä¸­ï¼Œåˆ™æ˜¯å¤§èšåˆæ‹†åˆ†å‡ºå¤šä¸ªå°èšåˆï¼Œç„¶åé€šè¿‡å°èšåˆä¸­æŒæœ‰èšåˆæ ¹çš„Idç›¸äº’å…³è”ã€‚åŒæ—¶å°èšåˆè‡ªç„¶æœ‰è‡ªå·±çš„repoã€‚è€Œè¿™ç§æ‹†åˆ†ï¼Œæ¨¡å‹çš„å®Œæ•´æ€§å’Œç‹¬ç«‹æ€§ä¹Ÿå‡å¼±ï¼Œæ‰€ä»¥éœ€è¦ç»“åˆserviceæ¥å®Œæˆä¸šåŠ¡ã€‚<br><br>æ—¢ç„¶å¼•å…¥å…³è”å¯¹è±¡ï¼Œå®Œå…¨å»Repoå¦‚ä½•ï¼ŸUsersRepoç›´æ¥ç”¨Usersæ¥æ›¿ä»£ã€‚","like_count":1,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524476,"discussion_content":"å¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628127394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301562,"user_name":"å¤§ç¢—","can_delete":false,"product_type":"c1","uid":1027207,"ip_address":"","ucode":"F9CDC0C5BE48AC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/87/8ed5880a.jpg","comment_is_top":false,"comment_ctime":1625739061,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5920706357","product_id":100082101,"comment_content":"è¯·é—®ä¸‹è€å¸ˆï¼Œç”¨æˆ·æ–°è®¢é˜…ä¸€ä¸ªä¸“æ çš„å†™æ³•åº”è¯¥ä»€ä¹ˆæ ·å­çš„ï¼Ÿæ¯”å¦‚<br>UserApplicationç±»<br>public void subcribe(User user,Subcrtion subcrition){<br>\tuser.subcribe(subcrtion);<br>\tuserRepository.save(user);<br>}<br>Userç±»<br>public void subcribe(Subcribtion subcribition){<br>\tthis.mySubcrtions.add(subcribtion)<br>}<br>MySubcritionsç±»<br>public void add(Subcrtion subcribtion){<br>\tdb.insert();<br>\t&#47;&#47; or<br>\tmapper.insert();<br>}<br>","like_count":1,"discussions":[{"author":{"id":1057843,"avatar":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","nickname":"é˜¿ç”˜","note":"","ucode":"BC93175B70E05D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588146,"discussion_content":"æ—¢ç„¶ user.subscribeçš„æ—¶å€™å°±å·²ç»é€šè¿‡MySubscrition.insertåˆ°DBäº†ï¼ŒUserè¿˜éœ€è¦saveå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663575124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2388512,"avatar":"https://static001.geekbang.org/account/avatar/00/24/72/20/733fdd94.jpg","nickname":"ç‹å¸…","note":"","ucode":"EE352769ABFAA4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569991,"discussion_content":"è´´ä¸€æ®µstackoverflowä¸Šçš„ç¤ºä¾‹ï¼š\n\n//Domain level:\n\npublic interface IOrderItemList {\n\n   IEnumerable&lt;OrderItem&gt; GetItems();\n\n}\n\npublic class Order {\n\n    private IOrderItemList _orderItems;\n\n    public IEnumerable&lt;OrderItem&gt; OrderItems \n          { get { return _orderItems.GetItems() } };\n\n    public Order(IOrderItemList orderItems) \n    {\n        _orderItems = orderItems;\n    }\n}\n\npublic class OrderItemList : IOrderItemList\n{\n    private IList&lt;OrderItem&gt; _orderItems;\n\n    public IEnumerable&lt;OrderItem&gt; GetItems() {\n        return _orderItems; //or another logic\n    }\n\n    //other implementation details\n}\n\n//Data level\n\npublic class OrderItemListProxy : IOrderItemList\n{\n    //link to &#39;real&#39; object\n    private OrderItemList _orderItemList;\n\n    private int _orderId;\n    //alternatively:\n    //private OrderEntity _orderEntity;\n\n    //ORM context\n    private DbContext _context;\n\n    public OrderItemListProxy(int orderId, DbContext context)\n    {\n       _orderId = orderId;\n       _context = context;\n    }\n\n    public IEnumerable&lt;OrderItem&gt; GetItems() {\n        if (_orderItemList == null) \n        {\n            var orderItemEntities = DbContext.Orders\n              .Single(order =&gt; order.Id == _orderId).OrderItems;\n\n            var orderItems = orderItemEntites.Select(...);\n            //alternatively: use factory to create OrderItem from OrderItemEntity\n            _orderItemList = new OrderItemList(orderItems);\n        }\n        return _orderItemList.GetItems();\n    }\n\n}\n\npublic class OrderRepository\n{\n   //ORM context\n   private DbContext _context;\n\n    Order GetOrder(int id)\n    {\n        var orderEntity = _context.Single(order =&gt; order.Id == id);\n        var order = new Order(new OrderItemListProxy(id, _context))\n        //alternatively:\n        //var order = new Order(new OrderItemListProxy(orderEntity, _context))\n        ...\n        //init other fields\n        ...\n    }\n    //other methods\n    ...\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651632526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1045862,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f5/66/ff9fb166.jpg","nickname":"å§šç£Š","note":"","ucode":"94C1399716AAD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385282,"discussion_content":"æœ‰ç±»ä¼¼çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626964083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300514,"user_name":"å¤§æµ·æµ®è","can_delete":false,"product_type":"c1","uid":1067638,"ip_address":"","ucode":"7A3B9011C639ED","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/76/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1625202702,"is_pvip":false,"replies":[{"id":"108899","content":"æŒä¹…åŒ–useræ˜¯é€šè¿‡user repoè¿›è¡Œçš„ï¼Œuserä¸ä¼šè°ƒç”¨ä»»ä½•db å®ƒåªè°ƒç”¨æ¥å£ã€‚ä»å®é™…æ‰§è¡Œä¸Šçœ‹ userçš„ç¡®å¤¹æ‚dbè¡Œä¸ºï¼Œä½†æ˜¯ä»useræ¥çœ‹å¹¶æ²¡æœ‰ï¼Œdbè¡Œä¸ºè¢«å°è£…äº†<br>","user_name":"ä½œè€…å›å¤","comment_id":300514,"uid":"2537798","ip_address":"","utype":1,"ctime":1625207387,"user_name_real":"å¾å…«å‰"}],"discussion_count":4,"race_medal":0,"score":"5920169998","product_id":100082101,"comment_content":"æˆ‘ä»¬æœ€è¿‘åœ¨åšèšåˆè½åœ°çš„æ—¶å€™ç¡®å®é‡åˆ°äº†æ€§èƒ½é—®é¢˜ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜æƒ³è¯·æ•™ä¸€ä¸‹ï¼š<br>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä»¥user-subscriptionèšåˆä¸ºä¾‹ï¼Œä½¿ç”¨å…³è”å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨èšåˆçš„æŒä¹…åŒ–ä¸Šï¼Œæ˜¯ä¸æ˜¯å¾—åˆ†ä¸ºä¸¤æ­¥ï¼Ÿç¬¬ä¸€æ­¥æ˜¯å…ˆåœ¨userå®ä½“ä¸­ä½¿ç”¨å…³è”å¯¹è±¡æ¥å£å…ˆæŒä¹…åŒ–subscriptionçš„å®ä½“ï¼Œç¬¬äºŒæ­¥æ˜¯ç­‰æ•´ä¸ªèšåˆè®¡ç®—ç»“æŸåï¼Œå†æŒä¹…åŒ–èšåˆæ ¹ç”¨æˆ·ï¼Œè¿™æ ·ç®—æ˜¯çœŸæ­£çš„ä¸šåŠ¡å…³æ³¨ç‚¹ä¸æŠ€æœ¯å…³æ³¨ç‚¹åˆ†ç¦»å—ï¼Ÿæ¯•ç«Ÿä½ æ˜¯åœ¨userå®ä½“ä¸­æ˜¾ç¤ºåœ°è°ƒç”¨æ¥å£åšdbæ“ä½œã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œéšç€è¿­ä»£çš„è¿›è¡Œï¼Œå…³è”å¯¹è±¡æ¥å£çš„implç±»ä¸­dbæ“ä½œä¼šè¶Šæ¥è¶Šå¤šï¼Œä»è€Œå¯¼è‡´userè¡Œä¸ºä¸­å¤§é‡å¤¹æ‚ç€å’Œæ•°æ®åº“çš„äº¤äº’ï¼Œä¼šä¸ä¼šé€æ¸é€€åŒ–æˆé¢ç›¸è¿‡ç¨‹ç¼–ç¨‹ï¼Ÿ<br><br>è¯¾åé¢˜<br>åœ¨ä¸šåŠ¡ç³»ç»Ÿå®è·µä¸­ï¼Œä¸ªäººè®¤ä¸ºå…¶ä¸­ä¸€å¤§å¤æ‚åº¦æ¥æºäºè§„åˆ™æ ¡éªŒï¼Œå¾€å¾€ä¸€ä¸ªç”¨ä¾‹ä¸­ä¼´éšç€å¤§é‡çš„è§„åˆ™æ ¡éªŒï¼Œè¿™é‡Œé¢å¯èƒ½ä¼šæœ‰éšå¼æ¦‚å¿µï¼Œå¦‚æœä¸èƒ½å‡†ç¡®è¯†åˆ«ï¼Œå¹¶å°½æ—©å»ºæ¨¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä»£ç è‡ƒè‚¿ï¼Œæ¶æ„è…åŒ–","like_count":1,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522752,"discussion_content":"æŒä¹…åŒ–useræ˜¯é€šè¿‡user repoè¿›è¡Œçš„ï¼Œuserä¸ä¼šè°ƒç”¨ä»»ä½•db å®ƒåªè°ƒç”¨æ¥å£ã€‚ä»å®é™…æ‰§è¡Œä¸Šçœ‹ userçš„ç¡®å¤¹æ‚dbè¡Œä¸ºï¼Œä½†æ˜¯ä»useræ¥çœ‹å¹¶æ²¡æœ‰ï¼Œdbè¡Œä¸ºè¢«å°è£…äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625207387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1268264,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5a/28/732d3f2f.jpg","nickname":"GEEKBANG_6638780","note":"","ucode":"952194E56FD8C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382389,"discussion_content":"è§„åˆ™æ ¡éªŒçš„è¯ï¼Œå»ºè®®çœ‹ä¸‹å‘¨å¿—æ˜è€å¸ˆçš„æ¶æ„è¯¾ç¨‹ã€‚å…¶ä¸­æœ‰ä¸ªç« èŠ‚è¯¦ç»†æè¿°äº†å¦‚ä½•ä¼˜é›…çš„è®¾è®¡æ ¡éªŒã€‚å…¶å®å°±æ˜¯åœ¨å®ä½“å¯¹è±¡ä¸Šå¢åŠ Validæ³¨è§£ï¼ŒæŠŠéªŒè¯é€»è¾‘å†…èšåœ¨å®ä½“ä¸­ã€‚ åšåˆ°ä¸€å¤„éªŒè¯åˆ°å¤„é€šç”¨ã€‚ç¬¦åˆDDDçš„å……è¡€è¡Œä¸º","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1625554151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1101556,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ce/f4/5bfc786a.jpg","nickname":"Vilochen.","note":"","ucode":"19D9BF8534B480","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1268264,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5a/28/732d3f2f.jpg","nickname":"GEEKBANG_6638780","note":"","ucode":"952194E56FD8C8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396984,"discussion_content":"å¦‚æœä¸åŒä¸šåŠ¡å¯¹åŒä¸€å®ä½“æ ¡éªŒé€»è¾‘ä¸åŒè¯¥å¦‚ä½•å¤„ç†å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632535535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":382389,"ip_address":""},"score":396984,"extra":""}]},{"author":{"id":1181500,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/3c/ab8a4a6d.jpg","nickname":"awephy","note":"","ucode":"26B92D201881B7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388318,"discussion_content":"ä»–æŒ‡çš„æ›´å¤šæ˜¯ä¸šåŠ¡è§„åˆ™ï¼Œä¸æ˜¯å±æ€§å¿…è¦æ€§æ£€æŸ¥è§„åˆ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628693870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300356,"user_name":"ç‹©æœˆ","can_delete":false,"product_type":"c1","uid":1204178,"ip_address":"","ucode":"472CCBFBE77785","user_header":"https://static001.geekbang.org/account/avatar/00/12/5f/d2/a39e5cea.jpg","comment_is_top":false,"comment_ctime":1625126097,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5920093393","product_id":100082101,"comment_content":"è¿™ä¸ªæ¨¡å¼å¾ˆæ¥åœ°æ°”å•Šï¼æœŸå¾…æ›´å¤šå†…å®¹","like_count":1},{"had_liked":false,"id":358877,"user_name":"JianXu","can_delete":false,"product_type":"c1","uid":1033219,"ip_address":"ä¸Šæµ·","ucode":"2A61BDBB573BDC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","comment_is_top":false,"comment_ctime":1664959032,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664959032","product_id":100082101,"comment_content":"æœ¬è´¨ä¸Šå°±æ˜¯å¢åŠ ä¸€å±‚æŠ½è±¡ï¼Œæœ¬æ¥subscription çš„é€»è¾‘æ˜¯ç›´æ¥æ”¾åœ¨user çš„å®ç°ç±»é‡Œï¼Œç°åœ¨user åªæ¥è§¦ä»£è¡¨subscription çš„æ¥å£ï¼Œå…·ä½“çš„å®ç°ä»user ç±»æŒªåˆ°äº†subscription çš„å®ç°ç±»ï¼Œä¹Ÿå°±æ˜¯å…³è”å¯¹è±¡å®ç°ç±»ã€‚","like_count":0},{"had_liked":false,"id":358226,"user_name":"JianXu","can_delete":false,"product_type":"c1","uid":1033219,"ip_address":"ä¸Šæµ·","ucode":"2A61BDBB573BDC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","comment_is_top":false,"comment_ctime":1664089959,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664089959","product_id":100082101,"comment_content":"public class Column {<br>    private List&lt;Subscription&gt; subscriptions;<br>    <br>    ....<br>}<br><br>è€å¸ˆï¼Œæˆ‘æ²¡æœ‰æ˜ç™½ä¸ºä»€ä¹ˆcolumn æ˜¯ä»£è¡¨æ‰€æœ‰è®¢é˜…äº†ä¸“æ çš„ç”¨æˆ·ï¼ŒIterable&lt;Subscription&gt; ä»£è¡¨çš„æ˜¯è®¢é˜…çš„ä¸“æ å¯¹è±¡ï¼Œå¯¹å—ï¼Ÿæ€ä¹ˆä»subscriptions é‡Œåˆ°ç”¨æˆ·å‘¢ï¼Ÿæˆ‘ä»¬å¹¶æ²¡æœ‰ä»Subscription åˆ°ç”¨æˆ·çš„å…³è”å•Šã€‚","like_count":0},{"had_liked":false,"id":342624,"user_name":"chmod","can_delete":false,"product_type":"c1","uid":1121078,"ip_address":"","ucode":"F148C85A7C9FCC","user_header":"https://static001.geekbang.org/account/avatar/00/11/1b/36/0998732e.jpg","comment_is_top":false,"comment_ctime":1650368500,"is_pvip":true,"replies":[{"id":"125208","content":"smart uiä¸éœ€è¦domain model","user_name":"ä½œè€…å›å¤","comment_id":342624,"uid":"2537798","ip_address":"","utype":1,"ctime":1650440096,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1650368500","product_id":100082101,"comment_content":"è¿™ä¸ªçœŸçš„èƒ½è§£å†³æ€§èƒ½é—®é¢˜å—ï¼Ÿ<br>å†å¤æ‚ç‚¹çš„æƒ…å†µï¼Œæ¯”å¦‚hç±»åŒ…å«alist ã€blistã€clistã€‚è¿™äº›å…¨éƒ¨éƒ½è¦åœ¨ä¸€ä¸ªé¡µé¢ä¸Šæ˜¾ç¤ºã€‚ç”¨ä»“å‚¨+Daoå¯ä»¥ç”¨ä¸€æ¡sqlè§£å†³ã€‚ä½†æ˜¯åˆ†è§£æˆå…³è”å¯¹è±¡æ¨¡å¼çš„è¯ï¼Œéƒ½å¾—åˆ†å¼€æŸ¥ã€‚æ€§èƒ½è‚¯å®šæ›´åŠ å·®ï¼Œè¿™ç§æƒ…å†µæœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565320,"discussion_content":"smart uiä¸éœ€è¦domain model","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650440096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339994,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1648529436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648529436","product_id":100082101,"comment_content":"é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œéšè—å®ç°æ„Ÿè§‰å°±æ˜¯DDDäº†","like_count":0},{"had_liked":false,"id":338153,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1582420,"ip_address":"","ucode":"349FD35822DC8A","user_header":"https://static001.geekbang.org/account/avatar/00/18/25/54/ef2ca14f.jpg","comment_is_top":false,"comment_ctime":1647326229,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647326229","product_id":100082101,"comment_content":"è‡ªé—®è‡ªç­”: <br>å’Œç”¨æˆ·è®¢é˜…çš„åˆ†é¡µä¸ºä»€ä¹ˆä¸å°è£…åœ¨Subscriptionç±»ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«?<br>MySubscriptioné€»è¾‘æ›´åŠ ä¸°å¯Œ, å¯ä»¥è¡¨ç¤ºä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰çš„é‚£äº›è®¢é˜…çš„æ¨¡å‹.  å®ƒä¸æ˜¯ä¸€ä¸ªå•çº¯çš„æ•°æ®å¯¹è±¡, ä¸æ˜¯è´«è¡€æ¨¡å‹. ","like_count":0},{"had_liked":false,"id":334422,"user_name":"Pen","can_delete":false,"product_type":"c1","uid":1802395,"ip_address":"","ucode":"0A88CBF6BCAAD5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erKop8iby4yp4Yhian8RPoBicWXviaevTMNsPpXNj1ccdWB0BiaIeIOibiaI6sXBeMj8p3eEIyvM9huKRM1g/132","comment_is_top":false,"comment_ctime":1644928534,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644928534","product_id":100082101,"comment_content":"è€å¸ˆï¼ŒåŒé—®MySubscriptions åœ¨spring é¡¹ç›®ä¸­æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥@Autowired æ³¨å…¥user","like_count":0},{"had_liked":false,"id":322186,"user_name":"æ— äº‰å°±æ˜¯yk","can_delete":false,"product_type":"c1","uid":1019128,"ip_address":"","ucode":"8739E996ACD746","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/f8/d378c121.jpg","comment_is_top":false,"comment_ctime":1637226333,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1637226333","product_id":100082101,"comment_content":"UserRepositoryDB ä¸­æ¯æ¬¡æŸ¥è¯¢åˆ°çš„å¯¹è±¡éƒ½è¦setMySubscription è¿™ä¸ªéšæ€§å¼€é”€å’Œå›¢é˜Ÿè®¤çŸ¥æˆæœ¬ä¸å°ã€‚å¦å¤–å¦‚æœæ˜¯åœ¨çœŸå®çš„spring é¡¹ç›®ä¸­ï¼ŒmySubscriptions æ˜¯æ³¨å…¥åˆ°User ä¸­çš„å—ï¼Ÿè¿™æ ·çš„è¯æ„Ÿè§‰MySubscriptionsDB æŒæœ‰User å¯¹è±¡æœ‰ç‚¹å¥‡æ€ªã€‚","like_count":0,"discussions":[{"author":{"id":1189765,"avatar":"https://static001.geekbang.org/account/avatar/00/12/27/85/06fbdeac.jpg","nickname":"Vincent","note":"","ucode":"F0A32C9210FF42","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558832,"discussion_content":"ä¸€æ ·çš„é—®é¢˜ï¼Œspringçš„æ¡†æ¶æ€ä¹ˆç©ï¼Ÿmybatiséƒ½æ˜¯æ³¨å…¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648479322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321784,"user_name":"mars","can_delete":false,"product_type":"c1","uid":1407604,"ip_address":"","ucode":"1C57AEC0AC60D7","user_header":"https://static001.geekbang.org/account/avatar/00/15/7a/74/fcb8bc4c.jpg","comment_is_top":false,"comment_ctime":1637046369,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637046369","product_id":100082101,"comment_content":"è§£å†³æ–¹å¼æœ‰ç‚¹ç±»ä¼¼äºDCIæ¶æ„ä¸­çš„åœºæ™¯ï¼Œåœ¨ä»€ä¹ˆæ ·çš„åœºæ™¯ä¸­æ‰®æ¼”ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Œä»è€Œæœ‰ä»€ä¹ˆæ ·çš„è¡Œä¸ºã€‚åˆ†è€Œæ²»ä¹‹ï¼Œå‡å°‘ä¸Šå¸ç±»ï¼Œå¥½æ–‡ã€‚<br>ä¹‹å‰å¯èƒ½åªèƒ½åªé¢†åŸŸæœåŠ¡å®ç°çš„éƒ¨åˆ†é€»è¾‘å¯ä»¥èšåˆåˆ°æ¨¡å‹ä¸­ï¼Œèšåˆå…³ç³»æ›´å¼ºï¼ŒğŸ‘","like_count":0},{"had_liked":false,"id":321323,"user_name":".benxiaohai52","can_delete":false,"product_type":"c1","uid":1221835,"ip_address":"","ucode":"8F748310484724","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/cb/407d9a81.jpg","comment_is_top":false,"comment_ctime":1636792644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636792644","product_id":100082101,"comment_content":"èƒ½å¦ç»™å‡ºå®ç”¨çš„demoå…³è”å¯¹è±¡ç›¸å…³çš„ï¼Œè¿™å—ä¸€ç›´æ˜¯æˆ‘çš„ç–‘æƒ‘","like_count":0},{"had_liked":false,"id":315294,"user_name":"å…«æ­Œ","can_delete":false,"product_type":"c1","uid":1025218,"ip_address":"","ucode":"B54B99716358DE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/c2/e8ab13d7.jpg","comment_is_top":false,"comment_ctime":1633789387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633789387","product_id":100082101,"comment_content":"è®¡ç®—æœºçš„æ‰€æœ‰é—®é¢˜ï¼Œéƒ½å¯ä»¥é€šè¿‡å¤¹å¡ä¸€ä¸ªä¸­é—´å±‚æ¥è§£å†³ğŸ˜‚","like_count":0},{"had_liked":false,"id":311568,"user_name":"é»„å¤§ä»™","can_delete":false,"product_type":"c1","uid":1610676,"ip_address":"","ucode":"6C79E6991EC3B8","user_header":"https://static001.geekbang.org/account/avatar/00/18/93/b4/22f438d0.jpg","comment_is_top":false,"comment_ctime":1631298404,"is_pvip":true,"replies":[{"id":"112899","content":"è¿™å“ªé‡Œéšè—äº†ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1631326587,"ip_address":"","comment_id":311568,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1631298404","product_id":100082101,"comment_content":"åœ¨å»ºæ¨¡å®Œæ¯•åï¼Œå®ç°æ¨¡å‹çš„æ¥å£æ—¶ï¼Œæš—å«äº†å®ç°äººå‘˜å¿…é¡»çŸ¥é“çš„ä¸€ä¸ªé€»è¾‘ï¼šUserRepositoryDB å¿…é¡»åœ¨è·å– User æ—¶åœ¨ User å†…è®¾ç½®å¥½ MySubscriptionã€‚<br>è¿™ä¸ªéšè—çš„é€»è¾‘è¯¥å¦‚ä½•ä¼˜é›…åœ°ç”±å»ºæ¨¡äººå‘˜ä¼ æ‰¿åˆ°å®ç°äººå‘˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526662,"discussion_content":"è¿™å“ªé‡Œéšè—äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631326587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1127789,"avatar":"https://static001.geekbang.org/account/avatar/00/11/35/6d/836d7259.jpg","nickname":"å¸¸å","note":"","ucode":"C07D4A7C2895EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414532,"discussion_content":"æˆ‘ç†è§£è¿™ä½åŒå­¦çš„æ„æ€æ˜¯ï¼Œè¿™ä¸ªè®¾è®¡é—®é¢˜â€œå¦‚ä½•å°† MySubscriptionsDB ä¸ User ç»“åˆåœ¨ä¸€èµ·ï¼Ÿâ€çš„ç­”æ¡ˆï¼Œå¦‚ä½•èƒ½å¼ºåˆ¶ä¿è¯å®ç°äººå‘˜æ­£ç¡®å®ç°äº†ï¼Ÿåœ¨æ‚¨çš„ä¾‹å­ä¸­ç­”æ¡ˆæ˜¯å®ç°çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ²¡æœ‰ä½œä¸ºæ˜¾å¼çš„äº§å‡ºï¼Œä½œä¸ºæ¨¡å‹çš„ä¸€éƒ¨åˆ†ã€‚ä¸çŸ¥é“æ˜¯å¦ç†è§£æ­£ç¡®ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1636805699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1610676,"avatar":"https://static001.geekbang.org/account/avatar/00/18/93/b4/22f438d0.jpg","nickname":"é»„å¤§ä»™","note":"","ucode":"6C79E6991EC3B8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1127789,"avatar":"https://static001.geekbang.org/account/avatar/00/11/35/6d/836d7259.jpg","nickname":"å¸¸å","note":"","ucode":"C07D4A7C2895EC","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":540770,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640158969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":414532,"ip_address":""},"score":540770,"extra":""}]},{"author":{"id":1206912,"avatar":"","nickname":"wwlleo","note":"","ucode":"5119810EA156F9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583038,"discussion_content":"å•å…ƒæµ‹è¯•æˆ–è€…é›†æˆæµ‹è¯•ä¿è¯å•Šï¼Œä½ ä»UserRepositoryé‡Œé¢æ‹¿äº†ä¸€ä¸ªUserå‡ºæ¥ï¼Œç»“æœMySubscriptionsæ²¡æœ‰æ•°æ®ï¼Œæµ‹è¯•å°±é€šä¸è¿‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659881368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1057843,"avatar":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","nickname":"é˜¿ç”˜","note":"","ucode":"BC93175B70E05D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1206912,"avatar":"","nickname":"wwlleo","note":"","ucode":"5119810EA156F9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588148,"discussion_content":"æ‹¿Userçš„æ—¶å€™ä¸€å®šè¦è·å–â€œæˆ‘çš„è®¢é˜…â€å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663575290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":583038,"ip_address":"å¹¿ä¸œ"},"score":588148,"extra":""}]}]},{"had_liked":false,"id":311008,"user_name":"SochiLee","can_delete":false,"product_type":"c1","uid":1537865,"ip_address":"","ucode":"47596594EDF4D7","user_header":"https://static001.geekbang.org/account/avatar/00/17/77/49/445eea2d.jpg","comment_is_top":false,"comment_ctime":1631014779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631014779","product_id":100082101,"comment_content":"å¦‚æœè¦åˆ†é¡µæŸ¥userï¼Œåˆ™éœ€è¦æ„å»ºç”¨æˆ·çš„æ‹¥æœ‰æ–¹ï¼Œæ¯”å¦‚ç”¨æˆ·ç»„UserGroupï¼Œå†ä½¿ç”¨å…³ç³»å¯¹è±¡MyUsersè¿›è¡Œåˆ†é¡µæŸ¥ã€‚æˆ‘è¿™ä¹ˆç†è§£å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":309694,"user_name":"dbzh","can_delete":false,"product_type":"c1","uid":1005239,"ip_address":"","ucode":"047EE06E129E44","user_header":"","comment_is_top":false,"comment_ctime":1630306792,"is_pvip":true,"replies":[{"id":"112162","content":"è¶…çº²äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1630310219,"ip_address":"","comment_id":309694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630306792","product_id":100082101,"comment_content":"è€å¸ˆå¯å¦è®²è®²CQRSçš„é¡¹ç›®ä¸ºä»€ä¹ˆå‡ ä¹éƒ½å¤±è´¥äº†å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525971,"discussion_content":"è¶…çº²äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630310219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308378,"user_name":"feihui","can_delete":false,"product_type":"c1","uid":1007294,"ip_address":"","ucode":"13F1D4A82BC650","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/be/9ea55f46.jpg","comment_is_top":false,"comment_ctime":1629562430,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1629562430","product_id":100082101,"comment_content":"è§‰å¾—æœ¬è´¨è¿˜æ˜¯åœ¨äºçœ‹å¾…è§’åº¦ï¼Œåœ¨ subscription repository ä¸Šåšåˆ†é¡µæ˜¯é€»è¾‘æ³„éœ²ï¼ŒåŸå› åœ¨äºå•ä¸ª subscription ä¸å­˜åœ¨åˆ†é¡µã€æ€»æ•°ä¸€è¯´ã€‚å…¶å®æ„Ÿè§‰åœ¨ List çš„åŸºç¡€ä¸Šå®ç°åˆ†é¡µä¹Ÿå¯ä»¥çš„ï¼Œåæ­£ list ä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæœ¬èº«ä¹Ÿå°±å…·æœ‰è¡Œä¸ºã€‚å¯èƒ½æ²¡æœ‰ç»å†è¿‡è€å¸ˆé‚£ä¸ªå¹´ä»£ï¼ŒOOPä¸­å†…å­˜é›†åˆå’Œæ•°æ®åº“çš„å‰²è£‚æ²¡æœ‰å¤ªå¤šæ„Ÿè§¦ï¼Œæ„Ÿè§‰å¢åŠ ä¸ªä¸­é—´å±‚å°±åˆé“¾æ¥ä¸Šäº†ï¼ˆè¿™ä¸ä¹Ÿæ˜¯è§£å†³é—®é¢˜çš„ä¸‡é‡‘æ²¹ï¼‰","like_count":0,"discussions":[{"author":{"id":1029051,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b3/bb/abb7bfe3.jpg","nickname":"rusess","note":"","ucode":"C6F46B368F3392","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405052,"discussion_content":"æ¯”å¦‚C# çš„Endity Framework linq , IQueryable ä»£æ›¿ IList ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634484635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306770,"user_name":"awephy","can_delete":false,"product_type":"c1","uid":1181500,"ip_address":"","ucode":"26B92D201881B7","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/3c/ab8a4a6d.jpg","comment_is_top":false,"comment_ctime":1628694749,"is_pvip":true,"replies":[{"id":"111114","content":"ä¸æ˜¯å¤æ‚æŸ¥è¯¢ å°±æ˜¯ç®€å•æŸ¥è¯¢","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1628736950,"ip_address":"","comment_id":306770,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628694749","product_id":100082101,"comment_content":"ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œå‰ç«¯ç•Œé¢æ˜¾ç¤ºçš„å¤šæ ·åŒ–æ˜¯åˆ†é¡µéœ€æ±‚é©±åŠ¨çš„è¯±å› ï¼Œè€Œé¢†åŸŸå»ºæ¨¡å¾€å¾€ä¸ä¼šæŠŠå‰ç«¯çš„å˜åŒ–çº³å…¥è€ƒè™‘èŒƒå›´å†…ï¼Œæ‰€ä»¥åˆ†é¡µçš„éœ€æ±‚ï¼Œä½¿ç”¨æ•°æ®é©±åŠ¨ä¹Ÿæœªå°ä¸å¯ã€‚å€˜è‹¥è¿™ä¹ˆåšï¼Œç³»ç»Ÿå†…ä¼šåŒæ—¶å­˜åœ¨é¢†åŸŸé©±åŠ¨å’Œæ•°æ®é©±åŠ¨ä¸¤è€…è®¾è®¡ç†å¿µï¼Œå†™å…¥é“¾è·¯éµä»é¢†åŸŸé©±åŠ¨ï¼Œä¿è¯é¢†åŸŸçš„å®Œæ•´ï¼›å¤æ‚çš„æŸ¥è¯¢é“¾è·¯éµä»æ•°æ®é©±åŠ¨ï¼Œåº”å¯¹å‰ç«¯å±•ç¤ºçš„éœ€æ±‚ã€‚","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524910,"discussion_content":"ä¸æ˜¯å¤æ‚æŸ¥è¯¢ å°±æ˜¯ç®€å•æŸ¥è¯¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628736950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306669,"user_name":"å¼ æŒ¯å","can_delete":false,"product_type":"c1","uid":1201810,"ip_address":"","ucode":"292EFD886FC55A","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/92/5cea89e6.jpg","comment_is_top":false,"comment_ctime":1628664615,"is_pvip":true,"replies":[{"id":"111052","content":"è¿™åªæ˜¯æ³›å‹ç­¾åè€Œå·² è·Ÿè´«è¡€è¿˜æ˜¯å……è¡€æ— å…³","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1628671588,"ip_address":"","comment_id":306669,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1628664615","product_id":100082101,"comment_content":"æˆ‘çš„ä»“å‚¨æ˜¯æ³›å‹IOrderRepository&lt;T,String&gt;ï¼Œæˆ‘åœ¨åº”ç”¨æ—¶ä¸çŸ¥é“æ€ä¹ˆä¼ è¿™ä¸ªTã€‚å› ä¸ºæŒ‰ç…§ç†è§£å°±æ˜¯å®ä½“æ˜¯å……è¡€æ¨¡å‹ï¼Œå®ƒä½œä¸ºæ³›å‹æ˜¯å¦åˆé€‚ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524863,"discussion_content":"è¿™åªæ˜¯æ³›å‹ç­¾åè€Œå·² è·Ÿè´«è¡€è¿˜æ˜¯å……è¡€æ— å…³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628671588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1201810,"avatar":"https://static001.geekbang.org/account/avatar/00/12/56/92/5cea89e6.jpg","nickname":"å¼ æŒ¯å","note":"","ucode":"292EFD886FC55A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388298,"discussion_content":"æˆ‘æŠŠå®ä½“ä½œä¸ºæ³›å‹çš„ç±»å‹å¯ä»¥å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628686640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305574,"user_name":"å¼ é€ƒé€ƒ","can_delete":false,"product_type":"c1","uid":1435550,"ip_address":"","ucode":"DBF3A573CDF7DB","user_header":"https://static001.geekbang.org/account/avatar/00/15/e7/9e/5853da22.jpg","comment_is_top":false,"comment_ctime":1628054491,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1628054491","product_id":100082101,"comment_content":"å°†å…³è”å¯¹è±¡ä½œä¸ºå®ç°èšåˆå…³ç³»çš„é»˜è®¤æ–¹æ³•ã€‚å­¦åˆ°ä¸€æ‹›ï¼","like_count":0},{"had_liked":false,"id":304137,"user_name":"xxx","can_delete":false,"product_type":"c1","uid":1096652,"ip_address":"","ucode":"E79CEA70430449","user_header":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","comment_is_top":false,"comment_ctime":1627269642,"is_pvip":true,"replies":[{"id":"110067","content":"ç®€å•æƒ…å†µå…¶å®ä¹Ÿå¯¹åº”ä¸äº†æ•°æ®åº“","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1627299320,"ip_address":"","comment_id":304137,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627269642","product_id":100082101,"comment_content":"é—®é¢˜åŸå› ï¼šJavaé›†åˆæ˜¯ä¸€ç§éšå«çš„åŸå§‹ç±»å‹ã€‚åœ¨ç®€å•çš„æƒ…å†µä¸‹å®ƒå¯ä»¥è·Ÿæ•°æ®åº“çš„è¡¨ç›¸å¯¹åº”ï¼Œä½†å¤æ‚æƒ…å†µä¸‹ï¼Œæ²¡æ³•å®ç°å®ƒè·Ÿæ•°æ®åº“ä¹‹é—´çš„å¤æ‚è½¬æ¢ã€‚<br>è§£å†³æ–¹æ¡ˆï¼šä¸è¦ç”¨åŸå§‹é›†åˆï¼Œç”¨è‡ªå·±å°è£…çš„å¸¦æœ‰ä¸šåŠ¡é€»è¾‘çš„â€œé›†åˆâ€ã€‚<br>è±ç„¶å¼€æœ—ã€‚","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523946,"discussion_content":"ç®€å•æƒ…å†µå…¶å®ä¹Ÿå¯¹åº”ä¸äº†æ•°æ®åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627299320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303759,"user_name":"å§šç£Š","can_delete":false,"product_type":"c1","uid":1045862,"ip_address":"","ucode":"94C1399716AAD2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/66/ff9fb166.jpg","comment_is_top":false,"comment_ctime":1626964255,"is_pvip":false,"replies":[{"id":"109959","content":"æ¯”å¦‚æŒ‚ormæ¡†æ¶çš„äº‹ä»¶ å»åšæ³¨å…¥","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1627010359,"ip_address":"","comment_id":303759,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626964255","product_id":100082101,"comment_content":"æ›´ç®€æ´æ¼‚äº®çš„åšæ³•ï¼Œæ˜¯é€šè¿‡ Java CDI APIæˆ–æ˜¯æ¡†æ¶<br><br>è¿™ä¸ªèƒ½å†å…·ä½“è¯´ä¸€ä¸‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523813,"discussion_content":"æ¯”å¦‚æŒ‚ormæ¡†æ¶çš„äº‹ä»¶ å»åšæ³¨å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627010359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303659,"user_name":"è¼ªè¿´","can_delete":false,"product_type":"c1","uid":1010641,"ip_address":"","ucode":"7504F61285BE35","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/d1/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1626918900,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626918900","product_id":100082101,"comment_content":"ç”¨ç»„åˆï¼Œä¸ç”¨ç»§æ‰¿","like_count":0},{"had_liked":false,"id":303077,"user_name":"é‚“å¿—å›½","can_delete":false,"product_type":"c1","uid":1043844,"ip_address":"","ucode":"380AE67ED7B9D7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/84/0b8e2d25.jpg","comment_is_top":false,"comment_ctime":1626579737,"is_pvip":false,"replies":[{"id":"109669","content":"çœ‹åé¢","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1626588516,"ip_address":"","comment_id":303077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626579737","product_id":100082101,"comment_content":"è¿™ä¸ªuseråœ¨ä¸åŒçš„èšåˆæ ¹é‡Œæ˜¯ä¸æ˜¯ä¼šæœ‰å¤šä¸ªåŒåå¯¹è±¡ï¼Œç„¶åå®ç°ä¸ä¸€æ ·ï¼Ÿå¦åˆ™userè¦å¤„ç†çš„ä¸šåŠ¡ä¼šçˆ†ç‚¸","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523547,"discussion_content":"çœ‹åé¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626588516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301965,"user_name":"rusess","can_delete":false,"product_type":"c1","uid":1029051,"ip_address":"","ucode":"C6F46B368F3392","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b3/bb/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1626000119,"is_pvip":false,"replies":[{"id":"109318","content":"ä¸ä¼š my subscriptionçš„å®ç°é‡Œä¹Ÿæ˜¯ç”¨join","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1626135156,"ip_address":"","comment_id":301965,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1626000119","product_id":100082101,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„å¥½æ–‡ã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œ å¦‚æœæ˜¯è¦è·å–ç”¨æˆ·åˆ—è¡¨ï¼Œç„¶ååœ¨æ¯è¡Œç”¨æˆ·ä¿¡æ¯ä¸Šé¢åŒæ—¶æ˜¾ç¤ºä¸€ä¸ªä¸“æ åˆ—è¡¨ï¼Œé€šè¿‡MySubscriptionsçš„æ–¹å¼æŸ¥ä¸“æ  ï¼Œè¿™æ ·åˆä¼šå˜æˆ N + 1 æŸ¥ã€‚ å®é™…çš„DBå®ç° åº”è¯¥æ˜¯é€šè¿‡joinçš„æ–¹å¼ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼Œé‚£æˆ‘åœ¨æ¨¡å‹ä¸Šåº”è¯¥å¦‚ä½•å®šä¹‰æ–¹æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523138,"discussion_content":"ä¸ä¼š my subscriptionçš„å®ç°é‡Œä¹Ÿæ˜¯ç”¨join","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626135156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1057377,"avatar":"https://static001.geekbang.org/account/avatar/00/10/22/61/580bb3c3.jpg","nickname":"hk","note":"","ucode":"92996CA0BCDD66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":571836,"discussion_content":"å…«å‰è€å¸ˆä½ å¥½ï¼Œå‡å¦‚æ‹†åˆ†äº†ä¸¤ä¸ªç‹¬ç«‹çš„ç”¨æˆ·åº“å’Œä¸“æ åº“ï¼Œä¸èƒ½ç”¨joinæ“ä½œäº†,æœ‰å•¥å¥½çš„è§£å†³æ–¹æ¡ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652426584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":523138,"ip_address":""},"score":571836,"extra":""}]}]},{"had_liked":false,"id":300924,"user_name":"Reason","can_delete":false,"product_type":"c1","uid":1512618,"ip_address":"","ucode":"719EA4D5E5BC5A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epuvKVmiaiaYDRFVRX3rGwSS4T1jibEKibqZYQjxob03ibdmguKzRsftAssCTDVWrdXL7ojNagaIdjIvzA/132","comment_is_top":false,"comment_ctime":1625451115,"is_pvip":false,"replies":[{"id":"108995","content":"å…³è”å¯¹è±¡æ˜¯é¢†åŸŸæ¨¡å‹ä¸€éƒ¨åˆ† ä¸ºä»€ä¹ˆåœ¨é¢†åŸŸä¹‹å¤–ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1625457350,"ip_address":"","comment_id":300924,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1625451115","product_id":100082101,"comment_content":"getTotalSubscriptionFeeåº”è¯¥æ˜¯ä¸€ä¸ªé¢†åŸŸå†…çš„è®¡ç®—é€»è¾‘å§ï¼Ÿé€šè¿‡æ¥å£å®šä¹‰çš„è¯ï¼Œè®¡ç®—é€»è¾‘æ˜¯ä¸æ˜¯å°±æ³„éœ²åˆ°é¢†åŸŸä¹‹å¤–äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522852,"discussion_content":"å…³è”å¯¹è±¡æ˜¯é¢†åŸŸæ¨¡å‹ä¸€éƒ¨åˆ† ä¸ºä»€ä¹ˆåœ¨é¢†åŸŸä¹‹å¤–ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625457350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1537865,"avatar":"https://static001.geekbang.org/account/avatar/00/17/77/49/445eea2d.jpg","nickname":"SochiLee","note":"","ucode":"47596594EDF4D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394013,"discussion_content":"è¿™ä¸ªé—®é¢˜çš„æ„æ€åº”è¯¥æ˜¯â€œgetTotalSubscriptionFeeä¹Ÿæœ‰è®¡ç®—é€»è¾‘æ¯”å¦‚A+B+Cï¼Œä½¿ç”¨å…³è”å¯¹è±¡çš„è¯è¿™ä¸ªé€»è¾‘å°±ä¼šè¢«å†™é“MySubscriptionsDbä¸­ï¼Œæ‰€ä»¥é€»è¾‘æ³„æ¼å‡ºå»äº†â€œï¼Œæˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘æƒ‘ã€‚è€å¸ˆå›ç­”çš„å…³è”å¯¹è±¡æ˜¯é¢†åŸŸæ¨¡å‹ä¸­çš„ä¸€éƒ¨ä»½ï¼Œéš¾é“æŒ‡çš„æ˜¯MySubscriptionså’ŒMySubscriptionsDbéƒ½å±äºå…³è”å¯¹è±¡éƒ½å±äºæ¨¡å‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631689247,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300901,"user_name":"Geek_5cfbf30","can_delete":false,"product_type":"c1","uid":1549766,"ip_address":"","ucode":"8541352DD3E2E8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4iaw2G8Giao2mp7R09IrHQIGfL6VM13Zts7EEUsDxlIP1ABF3x3iaK6ibZ5aIF2QSUheiaNyUfZMl6iaMg/132","comment_is_top":false,"comment_ctime":1625448211,"is_pvip":false,"replies":[{"id":"108987","content":"æ˜¯ä¸æ˜¯å…³ç³»æ€§æ•°æ® å¹¶ä¸å½±å“åœ¨æ¦‚å¿µä¸Šæ˜¯ä¸æ˜¯èšåˆ èšåˆä¹Ÿä¸æ˜¯å…³ç³»å‹æ•°æ®åº“çš„æ¦‚å¿µ","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1625452172,"ip_address":"","comment_id":300901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625448211","product_id":100082101,"comment_content":"cqrs æ˜¯ä¸ºäº†é˜²æ­¢å¤æ‚çš„æŸ¥è¯¢å¢åŠ äº†é¢†åŸŸé€»è¾‘çš„å¤æ‚åº¦, æ¯•ç«Ÿè¯»çš„è¯·æ±‚é€»è¾‘ä¸ä¼šå¾ˆå¤æ‚, ä¼šéœ€è¦è·å–å¤šä¸ªèšåˆæ ¹æ‰èƒ½æ„é€ å‡ºå¯¹è±¡, ä¹Ÿæ˜¯é™ä½è½åœ°DDDçš„å¤æ‚åº¦, æ¯•ç«ŸæŸ¥è¯¢è¿˜æ˜¯å¯ä»¥æŒ‰ç…§ä»¥å‰ç›´æ¥å†™sqlçš„æ–¹å¼, è€Œä¸”å¯ä»¥ä¼˜åŒ–æ€§èƒ½, ä½†æ˜¯è¾¹ç•Œç¡®å®å®¹æ˜“æ‰©å¤§. æˆ‘ä»¬æ²¡æœ‰å†é‡æ–°å®šä¹‰ä¸€ä¸ªæ–°çš„è¯»æ¨¡å‹, å› ä¸ºç”¨äºæ‰¿è½½èšåˆçš„æ•°æ®æ¨¡å‹å·²ç»å¤Ÿç”¨äº†. <br>ä¹‹å‰ä¹Ÿæœ‰ç–‘æƒ‘ç¢°åˆ°èšåˆæœ‰ä¸€å¯¹å¤šæˆ–è€…å¤šå¯¹å¤šçš„æƒ…å†µå¦‚ä½•å¤„ç†, ä¹‹å‰æ˜¯é€šè¿‡æ‹†åˆ†æˆä¸¤ä¸ªèšåˆå¤„ç†çš„, ä½†æ‹†åˆ†ä¹‹åä»–ä»¬çš„å…³è”åˆå˜å¾—æ¯”è¾ƒå¼±. å…³è”å¯¹è±¡è¿™ä¸ªæ²¡æƒ³åˆ°, åç»­å¯ä»¥å¥½å¥½å®è·µä¸€ä¸‹.<br><br>æˆ‘æœ‰ä¸ªç–‘é—®, å¦‚æœç”¨éå…³ç³»å‹æ•°æ®åº“å¦‚ä½•å¤„ç†å¤æ‚çš„æŸ¥è¯¢, å› ä¸ºé€šè¿‡èšåˆå»å­˜ä¸ä¸€å®šèƒ½å¾ˆå¥½çš„æ»¡è¶³è¯»çš„éœ€æ±‚, è®¾è®¡èšåˆçš„æ—¶å€™ä¸ä¼šå»è€ƒè™‘è¯»çš„é—®é¢˜, ä½†è¡¨è®¾è®¡çš„æ—¶å€™ä¼šæœ‰äº›è€ƒè™‘. <br>è½åœ°DDDä¸€å¼€å§‹æœ€ä¸é€‚åº”å°±æ˜¯æ€§èƒ½é—®é¢˜, ä¾‹å¦‚èšåˆéœ€è¦æ•´ä¸ªä¿å­˜æ•´ä¸ªè¯»å–, ç›®å‰é¡¹ç›®æ•°æ®é‡ä¸å¤§, æ‰€ä»¥å¤§å®¶éƒ½è§‰å¾—é—®é¢˜ä¸å¤§, ä½†åé¢é‡å¤§äº†, å¹¶å‘é‡å¤§äº†, æœ‰äº›æ‹…å¿ƒä¼šå‡ºé—®é¢˜.","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522846,"discussion_content":"æ˜¯ä¸æ˜¯å…³ç³»æ€§æ•°æ® å¹¶ä¸å½±å“åœ¨æ¦‚å¿µä¸Šæ˜¯ä¸æ˜¯èšåˆ èšåˆä¹Ÿä¸æ˜¯å…³ç³»å‹æ•°æ®åº“çš„æ¦‚å¿µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625452172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300798,"user_name":"ç®­å’Œæ–¹ç³–","can_delete":false,"product_type":"c1","uid":1938767,"ip_address":"","ucode":"818AAAFC0FD681","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIibashTHtGDWH5L0NlbuOrA6ZuI4uc1HkMD0hbIt8iaoH8hFf3jpb8jjhsvrRLTIazZP3YoR5WpMpg/132","comment_is_top":false,"comment_ctime":1625391184,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625391184","product_id":100082101,"comment_content":"è¿™ä¸ªæ¨¡å¼ç¡®å®å¾ˆå·§å¦™ï¼Œç§°å¾—ä¸Šæ˜¯æƒŠå–œã€‚ç„¶è€Œå®ƒå´æ˜¯æƒ…ç†ä¹‹ä¸­ï¼Œåˆ©ç”¨é¢å‘å¯¹è±¡çš„æ¥å£æŠ½è±¡å®ç°ï¼Œå¦™ï¼","like_count":0},{"had_liked":false,"id":300722,"user_name":"å››ä»”","can_delete":false,"product_type":"c1","uid":1047789,"ip_address":"","ucode":"7EACD1EA498B47","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/ed/e066bbf2.jpg","comment_is_top":false,"comment_ctime":1625328030,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625328030","product_id":100082101,"comment_content":"è¶Šçœ‹è¶Šè§‰å¾—å€¼ï¼ï¼ï¼","like_count":0},{"had_liked":false,"id":300382,"user_name":"å¨","can_delete":false,"product_type":"c1","uid":1068542,"ip_address":"","ucode":"C921CDCB22B9A3","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg","comment_is_top":false,"comment_ctime":1625133138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625133138","product_id":100082101,"comment_content":"å¸Œæœ›è€å¸ˆåé¢èƒ½ä»‹ç»ä¸€äº›å¼‚æ­¥å›è°ƒæ€æ ·ç»“åˆåˆ°é¢†åŸŸå»ºæ¨¡é‡Œé¢å»","like_count":0},{"had_liked":false,"id":300355,"user_name":"ç‹©æœˆ","can_delete":false,"product_type":"c1","uid":1204178,"ip_address":"","ucode":"472CCBFBE77785","user_header":"https://static001.geekbang.org/account/avatar/00/12/5f/d2/a39e5cea.jpg","comment_is_top":false,"comment_ctime":1625126052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625126052","product_id":100082101,"comment_content":"æœ‰ç‚¹åƒæ§åˆ¶çš„æ›´ç²¾ç»†çš„ORM Lazyload?","like_count":0},{"had_liked":false,"id":300308,"user_name":"å¨","can_delete":false,"product_type":"c1","uid":1068542,"ip_address":"","ucode":"C921CDCB22B9A3","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/fe/882eaf0f.jpg","comment_is_top":false,"comment_ctime":1625104822,"is_pvip":false,"replies":[{"id":"108863","content":"ä¹Ÿå¯ä»¥è½¬æ¢ä¸ºæ•°æ®è§†è§’ ç„¶åé€šè¿‡å…³è”å¯¹è±¡å°è£…","user_name":"ä½œè€…å›å¤","user_name_real":"å¾å…«å‰","uid":"2537798","ctime":1625107896,"ip_address":"","comment_id":300308,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625104822","product_id":100082101,"comment_content":"è€å¸ˆï¼Œè¯·é—®å¦‚æœä¸æ˜¯è®¿é—®æ•°æ®åº“ï¼Œè€Œæ˜¯è¯´æŠ€æœ¯ä¸Šéœ€è¦è°ƒç”¨RPCï¼Œæˆ–è€…å»ç¼“å­˜ä¾‹å¦‚REDISå–æ•°æ®ï¼Œè¿™æ ·çš„é€»è¾‘è¦æ€æ ·å°è£…å‘¢","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522704,"discussion_content":"ä¹Ÿå¯ä»¥è½¬æ¢ä¸ºæ•°æ®è§†è§’ ç„¶åé€šè¿‡å…³è”å¯¹è±¡å°è£…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625107896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}