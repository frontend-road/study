{"id":420399,"title":"06 | Shuffleç®¡ç†ï¼šä¸ºä»€ä¹ˆShuffleæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>åœ¨ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬æ‹œè®¿äº†æ–¯å·´å…‹å›½é™…å»ºç­‘é›†å›¢æ€»å…¬å¸ï¼Œç»“è¯†äº†Sparkè°ƒåº¦ç³»ç»Ÿçš„ä¸‰å·¨å¤´ï¼šDAGSchedulerã€TaskSchedulerå’ŒSchedulerBackendã€‚ç›¸ä¿¡ä½ å·²ç»æ„Ÿå—åˆ°ï¼Œè°ƒåº¦ç³»ç»Ÿç»„ä»¶ä¼—å¤šä¸”è¿ä½œæµç¨‹ç²¾å¯†è€Œåˆå¤æ‚ã€‚</p><p>ä»»åŠ¡è°ƒåº¦çš„é¦–è¦ç¯èŠ‚ï¼Œæ˜¯DAGSchedulerä»¥Shuffleä¸ºè¾¹ç•Œï¼ŒæŠŠè®¡ç®—å›¾DAGåˆ‡å‰²ä¸ºå¤šä¸ªæ‰§è¡Œé˜¶æ®µStagesã€‚æ˜¾ç„¶ï¼Œ<strong>Shuffleæ˜¯è¿™ä¸ªç¯èŠ‚çš„å…³é”®</strong>ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ç¦è¦é—®ï¼šâ€œShuffleæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä»»åŠ¡æ‰§è¡Œéœ€è¦Shuffleæ“ä½œï¼ŸShuffleæ˜¯æ€æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼Ÿâ€</p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬è½¬è€Œå»â€œæ‹œè®¿â€æ–¯å·´å…‹å›½é™…å»ºç­‘é›†å›¢çš„åˆ†å…¬å¸ï¼Œç”¨â€œå·¥åœ°æ¬ç –çš„ä»»åŠ¡â€æ¥ç†è§£ShuffleåŠå…¶å·¥ä½œåŸç†ã€‚ç”±äºShuffleçš„è®¡ç®—å‡ ä¹éœ€è¦æ¶ˆè€—æ‰€æœ‰ç±»å‹çš„ç¡¬ä»¶èµ„æºï¼Œæ¯”å¦‚CPUã€å†…å­˜ã€ç£ç›˜ä¸ç½‘ç»œï¼Œåœ¨ç»å¤§å¤šæ•°çš„Sparkä½œä¸šä¸­ï¼ŒShuffleå¾€å¾€æ˜¯ä½œä¸šæ‰§è¡Œæ€§èƒ½çš„ç“¶é¢ˆï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è¦æŒæ¡Shuffleçš„å·¥ä½œåŸç†ï¼Œä»è€Œä¸ºShuffleç¯èŠ‚çš„ä¼˜åŒ–æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p><h2>ä»€ä¹ˆæ˜¯Shuffle</h2><p>æˆ‘ä»¬å…ˆä¸æ€¥ç€ç»™Shuffleä¸‹æ­£å¼çš„å®šä¹‰ï¼Œä¸ºäº†å¸®ä½ è¿…é€Ÿåœ°ç†è§£Shuffleçš„å«ä¹‰ï¼Œä»è€Œè¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆå»æ‹œè®¿æ–¯å·´å…‹é›†å›¢çš„åˆ†å…¬å¸ï¼Œå»çœ‹çœ‹â€œå·¥åœ°æ¬ç –â€æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚</p><!-- [[[read_end]]] --><p>æ–¯å·´å…‹é›†å›¢çš„å„å®¶åˆ†å…¬å¸åˆ†åˆ«é©»æ‰åœ¨ä¸åŒçš„å»ºç­‘å·¥åœ°ï¼Œæ¯å®¶åˆ†å…¬å¸çš„äººå‘˜é…ç½®å’ŒåŸºç¡€è®¾æ–½éƒ½å¤§åŒå°å¼‚ï¼šåœ¨äººå‘˜æ–¹é¢ï¼Œå„å®¶åˆ†å…¬å¸éƒ½æœ‰å»ºç­‘å·¥äººè‹¥å¹²ã€ä»¥åŠè´Ÿè´£ç®¡ç†è¿™äº›å·¥äººçš„å·¥å¤´ã€‚åœ¨åŸºç¡€è®¾æ–½æ–¹é¢ï¼Œæ¯å®¶åˆ†å…¬å¸éƒ½æœ‰ä¸´æ—¶æ­å»ºã€æ–¹ä¾¿å­˜å–å»ºæçš„ä¸´æ—¶ä»“åº“ï¼Œè¿™äº›ä»“åº“é…å¤‡å„å¼å„æ ·çš„å»ºç­‘åŸææ–™ï¼Œæ¯”å¦‚æ··å‡åœŸç –å¤´ã€æ™®é€šç –å¤´ã€è‰åªç –å¤´ç­‰ç­‰ã€‚</p><p>å’±ä»¬å‚è§‚ã€è€ƒå¯Ÿæ–¯å·´å…‹å»ºç­‘é›†å›¢çš„ç›®çš„ï¼Œæ¯•ç«Ÿè¿˜æ˜¯å­¦ä¹ Sparkï¼Œå› æ­¤æˆ‘ä»¬å¾—æŠŠåˆ†å…¬å¸çš„äººä¸ç‰©å’ŒSparkçš„ç›¸å…³æ¦‚å¿µå¯¹åº”ä¸Šï¼Œè¿™æ ·æ‰èƒ½æ–¹ä¾¿ä½ å¿«é€Ÿç†è§£Sparkçš„è¯¸å¤šç»„ä»¶ä¸æ ¸å¿ƒåŸç†ã€‚</p><p>åˆ†å…¬å¸çš„äººä¸ç‰©å’ŒSparkçš„ç›¸å…³æ¦‚å¿µæ˜¯è¿™æ ·å¯¹åº”çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/80/aab67642c34a4a959f4cde9dd750b280.jpg?wh=1920x919\" alt=\"å›¾ç‰‡\" title=\"é›†å›¢åˆ†å…¬å¸ä¸Sparkç›¸å…³æ¦‚å¿µå¯¹åº”å…³ç³»\"></p><p>åŸºäºå›¾ä¸­ä¸åŒæ¦‚å¿µçš„å¯¹åº”å…³ç³»ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹â€œå·¥åœ°æ¬ç –â€çš„ä»»åŠ¡ã€‚æ–¯å·´å…‹å»ºç­‘é›†å›¢çš„3å®¶åˆ†å…¬å¸ï¼Œåˆ†åˆ«æ¥åˆ°3ä¸ªä¸åŒçš„å»ºç­‘ä»»åŠ¡ã€‚ç¬¬ä¸€å®¶åˆ†å…¬å¸çš„å»ºç­‘é¡¹ç›®æ˜¯æ‘©å¤©å¤§å¦ï¼Œç¬¬äºŒå®¶åˆ†å…¬å¸è¢«è¦æ±‚åœ¨å·¥åœ°ä¸Šå»ºé€ ä¸€åº§â€œèŒå® ä¹å›­â€ï¼Œè€Œç¬¬ä¸‰å®¶åˆ†å…¬å¸æ”¶åˆ°çš„ä»»åŠ¡æ˜¯æ‰“é€ éœ²å¤©å…¬å›­ã€‚ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬æŠŠä¸‰å®¶åˆ†å…¬å¸åˆ†åˆ«ç§°ä½œåˆ†å…¬å¸1ã€åˆ†å…¬å¸2å’Œåˆ†å…¬å¸3ã€‚</p><p>æ˜¾ç„¶ï¼Œä¸åŒå»ºç­‘é¡¹ç›®å¯¹äºå»ºæçš„é€‰å‹è¦æ±‚æ˜¯æœ‰åŒºåˆ«çš„ï¼Œæ‘©å¤©å¤§å¦çš„å»ºé€ éœ€è¦åˆšæ€§å¼ºåº¦æ›´é«˜çš„æ··å‡åœŸç –å¤´ï¼ŒåŒç†ï¼Œéœ²å¤©å…¬å›­çš„å»ºè®¾éœ€è¦é€æ°´æ€§å¥½çš„è‰åªç –å¤´ï¼Œè€ŒèŒå® ä¹å›­ä½¿ç”¨æ™®é€šç –å¤´å³å¯ã€‚</p><p>å¯æ˜¯ï¼Œä¸åŒç±»å‹çš„ç –å¤´ï¼Œåˆ†åˆ«æ•£è½åœ¨3å®¶å…¬å¸çš„ä¸´æ—¶ä»“åº“ä¸­ã€‚ä¸ºäº†å®ç°èµ„æºçš„é«˜æ•ˆåˆ©ç”¨ï¼Œæ¯ä¸ªåˆ†å…¬å¸çš„æ–½å·¥å·¥äººä»¬ï¼Œéƒ½éœ€è¦ä»å¦å¤–ä¸¤å®¶æŠŠé¡¹ç›®ç‰¹éœ€çš„ç –å¤´æ¬è¿è¿‡æ¥ã€‚å¯¹äºè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬æŠŠå®ƒå«ä½œâ€œæ¬ç –ä»»åŠ¡â€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4d/80/4d93f366247018896373c1d846fb4780.jpg?wh=1920x1403\" alt=\"å›¾ç‰‡\" title=\"å·¥åœ°æ¬ç –çš„ä»»åŠ¡\"></p><p>æœ‰äº†â€œå·¥åœ°æ¬ç –â€çš„ç›´è§‚å¯¹æ¯”ï¼Œæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥ç›´æ¥ç»™Shuffleä¸‹ä¸€ä¸ªæ­£å¼çš„å®šä¹‰äº†ã€‚</p><p>Shuffleçš„æœ¬æ„æ˜¯æ‰‘å…‹çš„â€œæ´—ç‰Œâ€ï¼Œåœ¨åˆ†å¸ƒå¼è®¡ç®—åœºæ™¯ä¸­ï¼Œå®ƒè¢«å¼•ç”³ä¸º<strong>é›†ç¾¤èŒƒå›´å†…è·¨èŠ‚ç‚¹ã€è·¨è¿›ç¨‹çš„æ•°æ®åˆ†å‘</strong>ã€‚åœ¨å·¥åœ°æ¬ç –çš„ä»»åŠ¡ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æŠŠä¸åŒç±»å‹çš„ç –å¤´çœ‹ä½œæ˜¯åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œé‚£ä¹ˆä¸åŒç±»å‹çš„ç –å¤´åœ¨å„ä¸ªåˆ†å…¬å¸ä¹‹é—´æ¬è¿çš„è¿‡ç¨‹ï¼Œä¸åˆ†å¸ƒå¼è®¡ç®—ä¸­çš„Shuffleå¯ä»¥è¯´æ˜¯å¼‚æ›²åŒå·¥ã€‚</p><p>è¦å®Œæˆå·¥åœ°æ¬ç –çš„ä»»åŠ¡ï¼Œæ¯ä½å·¥äººéƒ½éœ€è¦é•¿é€”è·‹æ¶‰åˆ°å¦å¤–ä¸¤å®¶åˆ†å…¬å¸ï¼Œç„¶åä»äººå®¶çš„ä¸´æ—¶ä»“åº“æŠŠæ‰€éœ€çš„ç –å¤´æ¬è¿å›æ¥ã€‚åˆ†å…¬å¸ä¹‹é—´ç›¸éš”ç”šè¿œï¼Œä»…é å·¥äººä»¬ä¸€å—ç –ä¸€å—ç –åœ°æ¬è¿ï¼Œæ˜¾ç„¶ä¸ç°å®ã€‚å› æ­¤ï¼Œä¸ºäº†æå‡æ¬ç –æ•ˆç‡ï¼Œæ¯ä½å·¥äººè¿˜éœ€è¦å€ŸåŠ©è´§è¿å¡è½¦æ¥å¸®å¿™ã€‚ä¸éš¾å‘ç°ï¼Œå·¥åœ°æ¬ç –çš„ä»»åŠ¡éœ€è¦æ¶ˆè€—å¤§é‡çš„äººåŠ›ç‰©åŠ›ï¼Œå¯ä»¥è¯´æ˜¯åŠ³å¸ˆåŠ¨ä¼—ã€‚</p><p>Shuffleçš„è¿‡ç¨‹ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œåˆ†å¸ƒå¼æ•°æ®é›†åœ¨é›†ç¾¤å†…çš„åˆ†å‘ï¼Œä¼šå¼•å…¥å¤§é‡çš„<strong>ç£ç›˜I/O</strong>ä¸<strong>ç½‘ç»œI/O</strong>ã€‚åœ¨DAGçš„è®¡ç®—é“¾æ¡ä¸­ï¼ŒShuffleç¯èŠ‚çš„æ‰§è¡Œæ€§èƒ½æ˜¯æœ€å·®çš„ã€‚ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæ—¢ç„¶Shuffleçš„æ€§èƒ½è¿™ä¹ˆå·®ï¼Œä¸ºä»€ä¹ˆåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­éè¦å¼•å…¥Shuffleæ“ä½œå‘¢ï¼Ÿå…å»Shuffleç¯èŠ‚ä¸è¡Œå—ï¼Ÿâ€</p><p>å…¶å®ï¼Œè®¡ç®—è¿‡ç¨‹ä¹‹æ‰€ä»¥éœ€è¦Shuffleï¼Œå¾€å¾€æ˜¯ç”±è®¡ç®—é€»è¾‘ã€æˆ–è€…è¯´ä¸šåŠ¡é€»è¾‘å†³å®šçš„ã€‚</p><p>æ¯”å¦‚ï¼Œå¯¹äºæ¬ç –ä»»åŠ¡æ¥è¯´ï¼Œä¸åŒçš„å»ºç­‘é¡¹ç›®å°±æ˜¯éœ€è¦ä¸åŒçš„å»ºæï¼Œåªæœ‰è¿™æ ·æ‰èƒ½æ»¡è¶³ä¸åŒçš„æ–½å·¥è¦æ±‚ã€‚å†æ¯”å¦‚ï¼Œåœ¨Word Countçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„â€œä¸šåŠ¡é€»è¾‘â€æ˜¯å¯¹å•è¯åšç»Ÿè®¡è®¡æ•°ï¼Œé‚£ä¹ˆå¯¹å•è¯â€œSparkâ€æ¥è¯´ï¼Œåœ¨åšâ€œåŠ å’Œâ€ä¹‹å‰ï¼Œæˆ‘ä»¬å°±æ˜¯å¾—æŠŠåŸæœ¬åˆ†æ•£åœ¨ä¸åŒExecutorsä¸­çš„â€œSparkâ€ï¼Œæ‹‰å–åˆ°æŸä¸€ä¸ªExecutorï¼Œæ‰èƒ½å®Œæˆç»Ÿè®¡è®¡æ•°çš„æ“ä½œã€‚</p><p>ç»“åˆè¿‡å¾€çš„å·¥ä½œç»éªŒï¼Œæˆ‘ä»¬å‘ç°åœ¨ç»å¤§å¤šæ•°çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼ŒShuffleæ“ä½œéƒ½æ˜¯å¿…éœ€çš„ã€æ— æ³•é¿å…çš„ã€‚æ—¢ç„¶æˆ‘ä»¬èº²ä¸æ‰Shuffleï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·å»æ¢ç´¢ï¼Œçœ‹çœ‹Shuffleåˆ°åº•æ˜¯æ€æ ·çš„ä¸€ä¸ªè®¡ç®—è¿‡ç¨‹ã€‚</p><h2>Shuffleå·¥ä½œåŸç†</h2><p>ä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨Word Countçš„ä¾‹å­æ¥åšè¯´æ˜ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¼•å…¥Shuffleæ“ä½œçš„æ˜¯reduceByKeyç®—å­ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™è¡Œä»£ç ï¼ˆå®Œæ•´ä»£ç è¯·å›é¡¾<a href=\"https://time.geekbang.org/column/article/415209\">ç¬¬1è®²</a>ï¼‰ã€‚</p><pre><code class=\"language-scala\">// æŒ‰ç…§å•è¯åšåˆ†ç»„è®¡æ•°\nval wordCounts: RDD[(String, Int)] = kvRDD.reduceByKey((x, y) =&gt; x + y)&nbsp;\n</code></pre><p>æˆ‘ä»¬å…ˆæ¥ç›´è§‚åœ°å›é¡¾ä¸€ä¸‹è¿™ä¸€æ­¥çš„è®¡ç®—è¿‡ç¨‹ï¼Œç„¶åå†å»åˆ†æå…¶ä¸­æ¶‰åŠçš„Shuffleæ“ä½œï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/31/4d/3199582354a56f9e64bdf7b8a516b04d.jpg?wh=1920x1256\" alt=\"å›¾ç‰‡\" title=\"reduceByKeyè®¡ç®—è¿‡ç¨‹ç¤ºæ„å›¾\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä»¥Shuffleä¸ºè¾¹ç•Œï¼ŒreduceByKeyçš„è®¡ç®—è¢«åˆ‡å‰²ä¸ºä¸¤ä¸ªæ‰§è¡Œé˜¶æ®µã€‚çº¦å®šä¿—æˆåœ°ï¼Œæˆ‘ä»¬æŠŠShuffleä¹‹å‰çš„Stageå«ä½œ<strong>Mapé˜¶æ®µ</strong>ï¼Œè€ŒæŠŠShuffleä¹‹åçš„Stageç§°ä½œ<strong>Reduceé˜¶æ®µ</strong>ã€‚åœ¨<strong>Mapé˜¶æ®µ</strong>ï¼Œæ¯ä¸ªExecutorså…ˆæŠŠè‡ªå·±è´Ÿè´£çš„æ•°æ®åˆ†åŒºåšåˆæ­¥èšåˆï¼ˆåˆå«Mapç«¯èšåˆã€å±€éƒ¨èšåˆï¼‰ï¼›åœ¨<strong>Shuffleç¯èŠ‚</strong>ï¼Œä¸åŒçš„å•è¯è¢«åˆ†å‘åˆ°ä¸åŒèŠ‚ç‚¹çš„Executorsä¸­ï¼›æœ€åçš„<strong>Reduceé˜¶æ®µ</strong>ï¼ŒExecutorsä»¥å•è¯ä¸ºKeyåšç¬¬äºŒæ¬¡èšåˆï¼ˆåˆå«å…¨å±€èšåˆï¼‰ï¼Œä»è€Œå®Œæˆç»Ÿè®¡è®¡æ•°çš„ä»»åŠ¡ã€‚</p><p>ä¸éš¾å‘ç°ï¼ŒMapé˜¶æ®µä¸Reduceé˜¶æ®µçš„è®¡ç®—è¿‡ç¨‹ç›¸å¯¹æ¸…æ™°æ˜äº†ï¼ŒäºŒè€…éƒ½æ˜¯åˆ©ç”¨reduceè¿ç®—å®Œæˆå±€éƒ¨èšåˆä¸å…¨å±€èšåˆã€‚åœ¨reduceByKeyçš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼ŒShuffleæ‰æ˜¯å…³é”®ã€‚</p><p>ä»”ç»†è§‚å¯Ÿä¸Šå›¾ä½ å°±ä¼šå‘ç°ï¼Œä¸å…¶è¯´Shuffleæ˜¯è·¨èŠ‚ç‚¹ã€è·¨è¿›ç¨‹çš„æ•°æ®åˆ†å‘ï¼Œä¸å¦‚è¯´Shuffleæ˜¯Mapé˜¶æ®µä¸Reduceé˜¶æ®µä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸¤ä¸ªæ‰§è¡Œé˜¶æ®µä¹‹é—´ï¼Œæ˜¯å¦‚ä½•å®ç°æ•°æ®äº¤æ¢çš„å‘¢ï¼Ÿ</p><h3>Shuffleä¸­é—´æ–‡ä»¶</h3><p>å¦‚æœç”¨ä¸€å¥æ¥æ¦‚æ‹¬çš„è¯ï¼Œé‚£å°±æ˜¯ï¼Œ<strong>Mapé˜¶æ®µä¸Reduceé˜¶æ®µï¼Œé€šè¿‡ç”Ÿäº§ä¸æ¶ˆè´¹Shuffleä¸­é—´æ–‡ä»¶çš„æ–¹å¼ï¼Œæ¥å®Œæˆé›†ç¾¤èŒƒå›´å†…çš„æ•°æ®äº¤æ¢</strong>ã€‚æ¢å¥è¯è¯´ï¼ŒMapé˜¶æ®µç”Ÿäº§Shuffleä¸­é—´æ–‡ä»¶ï¼ŒReduceé˜¶æ®µæ¶ˆè´¹Shuffleä¸­é—´æ–‡ä»¶ï¼ŒäºŒè€…ä»¥ä¸­é—´æ–‡ä»¶ä¸ºåª’ä»‹ï¼Œå®Œæˆæ•°æ®äº¤æ¢ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ï¼Œä»€ä¹ˆæ˜¯<strong>Shuffleä¸­é—´æ–‡ä»¶</strong>ï¼Œå®ƒæ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œåˆæ˜¯å¦‚ä½•è¢«æ¶ˆè´¹çš„ï¼Ÿ</p><p>æˆ‘æŠŠå®ƒçš„äº§ç”Ÿå’Œæ¶ˆè´¹è¿‡ç¨‹æ€»ç»“åœ¨ä¸‹å›¾ä¸­äº†ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/95/80/95479766b8acebdedd5c8a0f8bda0680.jpg?wh=1920x862\" alt=\"å›¾ç‰‡\" title=\"Shuffleä¸­é—´æ–‡ä»¶ç¤ºæ„å›¾\"></p><p>åœ¨ä¸Šä¸€è®²ä»‹ç»è°ƒåº¦ç³»ç»Ÿçš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯´è¿‡DAGSchedulerä¼šä¸ºæ¯ä¸€ä¸ªStageåˆ›å»ºä»»åŠ¡é›†åˆTaskSetï¼Œè€Œæ¯ä¸€ä¸ªTaskSetéƒ½åŒ…å«å¤šä¸ªåˆ†å¸ƒå¼ä»»åŠ¡ï¼ˆTaskï¼‰ã€‚åœ¨Mapæ‰§è¡Œé˜¶æ®µï¼Œæ¯ä¸ªTaskï¼ˆä»¥ä¸‹ç®€ç§°Map Taskï¼‰éƒ½ä¼š<strong>ç”ŸæˆåŒ…å«dataæ–‡ä»¶ä¸indexæ–‡ä»¶çš„Shuffleä¸­é—´æ–‡ä»¶</strong>ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒShuffleæ–‡ä»¶çš„ç”Ÿæˆï¼Œ<strong>æ˜¯ä»¥Map Taskä¸ºç²’åº¦çš„</strong>ï¼ŒMapé˜¶æ®µæœ‰å¤šå°‘ä¸ªMap Taskï¼Œå°±ä¼šç”Ÿæˆå¤šå°‘ä»½Shuffleä¸­é—´æ–‡ä»¶ã€‚</p><p>å†è€…ï¼ŒShuffleä¸­é—´æ–‡ä»¶æ˜¯ç»Ÿç§°ã€æ³›æŒ‡ï¼Œå®ƒåŒ…å«ä¸¤ç±»å®ä½“æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯è®°å½•ï¼ˆKeyï¼ŒValueï¼‰é”®å€¼å¯¹çš„dataæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯è®°å½•é”®å€¼å¯¹æ‰€å±Reduce Taskçš„indexæ–‡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œindexæ–‡ä»¶æ ‡è®°äº†dataæ–‡ä»¶ä¸­çš„å“ªäº›è®°å½•ï¼Œåº”è¯¥ç”±ä¸‹æ¸¸Reduceé˜¶æ®µä¸­çš„å“ªäº›Taskï¼ˆç®€ç§°Reduce Taskï¼‰æ¶ˆè´¹ã€‚åœ¨ä¸Šå›¾ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ç¤ºæ„ï¼Œæˆ‘ä»¬æŠŠé¦–å­—æ¯æ˜¯Sã€iã€cçš„å•è¯åˆ†åˆ«äº¤ç»™ä¸‹æ¸¸çš„3ä¸ªReduce Taskå»æ¶ˆè´¹ï¼Œæ˜¾ç„¶ï¼Œè¿™é‡Œçš„æ•°æ®äº¤æ¢è§„åˆ™æ˜¯å•è¯é¦–å­—æ¯ã€‚</p><p>åœ¨Sparkä¸­ï¼ŒShuffleç¯èŠ‚å®é™…çš„æ•°æ®äº¤æ¢è§„åˆ™è¦æ¯”è¿™å¤æ‚å¾—å¤šã€‚<strong>æ•°æ®äº¤æ¢è§„åˆ™åˆå«åˆ†åŒºè§„åˆ™</strong>ï¼Œå› ä¸ºå®ƒå®šä¹‰äº†<strong>åˆ†å¸ƒå¼æ•°æ®é›†åœ¨Reduceé˜¶æ®µå¦‚ä½•åˆ’åˆ†æ•°æ®åˆ†åŒº</strong>ã€‚å‡è®¾Reduceé˜¶æ®µæœ‰Nä¸ªTaskï¼Œè¿™Nä¸ªTaskå¯¹åº”ç€Nä¸ªæ•°æ®åˆ†åŒºï¼Œé‚£ä¹ˆåœ¨Mapé˜¶æ®µï¼Œæ¯æ¡è®°å½•åº”è¯¥åˆ†å‘åˆ°å“ªä¸ªReduce Taskï¼Œæ˜¯ç”±ä¸‹é¢çš„å…¬å¼æ¥å†³å®šçš„ã€‚</p><pre><code class=\"language-plain\">P = Hash(Record Key) % N\n</code></pre><p>å¯¹äºä»»æ„ä¸€æ¡æ•°æ®è®°å½•ï¼ŒSparkå…ˆæŒ‰ç…§æ—¢å®šçš„å“ˆå¸Œç®—æ³•ï¼Œè®¡ç®—è®°å½•ä¸»é”®çš„å“ˆå¸Œå€¼ï¼Œç„¶åæŠŠå“ˆå¸Œå€¼å¯¹Nå–æ¨¡ï¼Œè®¡ç®—å¾—åˆ°çš„ç»“æœæ•°å­—ï¼Œå°±æ˜¯è¿™æ¡è®°å½•åœ¨Reduceé˜¶æ®µçš„æ•°æ®åˆ†åŒºç¼–å·Pã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ¡è®°å½•åœ¨Shuffleçš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥è¢«åˆ†å‘åˆ°Reduceé˜¶æ®µçš„På·åˆ†åŒºã€‚</p><p>ç†Ÿæ‚‰äº†åˆ†åŒºè§„åˆ™ä¸ä¸­é—´æ–‡ä»¶ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥è¯´ä¸€è¯´ä¸­é—´æ–‡ä»¶æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ã€‚</p><h3>Shuffle Write</h3><p>æˆ‘ä»¬åˆšåˆšè¯´è¿‡ï¼ŒShuffleä¸­é—´æ–‡ä»¶ï¼Œæ˜¯ä»¥Map Taskä¸ºç²’åº¦ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬ä¸å¦¨ä½¿ç”¨ä¸‹å›¾ä¸­çš„Map Taskä»¥åŠä¸ä¹‹å¯¹åº”çš„æ•°æ®åˆ†åŒºä¸ºä¾‹ï¼Œæ¥è®²è§£ä¸­é—´æ–‡ä»¶çš„ç”Ÿæˆè¿‡ç¨‹ã€‚æ•°æ®åˆ†åŒºçš„æ•°æ®å†…å®¹å¦‚å›¾ä¸­ç»¿è‰²æ–¹æ¡†æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/92/ab/92781f6ff67224812d7aee1b7d6a63ab.jpg?wh=1920x618\" alt=\"å›¾ç‰‡\" title=\"Shuffle Writeæ‰§è¡Œè¿‡ç¨‹\"></p><p>åœ¨ç”Ÿæˆä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼ŒSparkä¼šå€ŸåŠ©ä¸€ç§ç±»ä¼¼äºMapçš„æ•°æ®ç»“æ„ï¼Œæ¥è®¡ç®—ã€ç¼“å­˜å¹¶æ’åºæ•°æ®åˆ†åŒºä¸­çš„æ•°æ®è®°å½•ã€‚è¿™ç§Mapç»“æ„çš„Keyæ˜¯ï¼ˆReduce Task Partition IDï¼ŒRecord Keyï¼‰ï¼Œè€ŒValueæ˜¯åŸæ•°æ®è®°å½•ä¸­çš„æ•°æ®å€¼ï¼Œå¦‚å›¾ä¸­çš„â€œå†…å­˜æ•°æ®ç»“æ„â€æ‰€ç¤ºã€‚</p><p>å¯¹äºæ•°æ®åˆ†åŒºä¸­çš„æ•°æ®è®°å½•ï¼ŒSparkä¼šæ ¹æ®æˆ‘ä»¬å‰é¢æåˆ°çš„å…¬å¼1é€æ¡è®¡ç®—è®°å½•æ‰€å±çš„ç›®æ ‡åˆ†åŒºIDï¼Œç„¶åæŠŠä¸»é”®ï¼ˆReduce Task Partition IDï¼ŒRecord Keyï¼‰å’Œè®°å½•çš„æ•°æ®å€¼æ’å…¥åˆ°Mapæ•°æ®ç»“æ„ä¸­ã€‚å½“Mapç»“æ„è¢«çŒæ»¡ä¹‹åï¼ŒSparkæ ¹æ®ä¸»é”®å¯¹Mapä¸­çš„æ•°æ®è®°å½•åšæ’åºï¼Œç„¶åæŠŠæ‰€æœ‰å†…å®¹æº¢å‡ºåˆ°ç£ç›˜ä¸­çš„ä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚å›¾ä¸­çš„æ­¥éª¤1æ‰€ç¤ºã€‚</p><p>éšç€Mapç»“æ„è¢«æ¸…ç©ºï¼ŒSparkå¯ä»¥ç»§ç»­è¯»å–åˆ†åŒºå†…å®¹å¹¶ç»§ç»­å‘Mapç»“æ„ä¸­æ’å…¥æ•°æ®ï¼Œç›´åˆ°Mapç»“æ„å†æ¬¡è¢«çŒæ»¡è€Œå†æ¬¡æº¢å‡ºï¼Œå¦‚å›¾ä¸­çš„æ­¥éª¤2æ‰€ç¤ºã€‚å°±è¿™æ ·ï¼Œå¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°æ•°æ®åˆ†åŒºä¸­æ‰€æœ‰çš„æ•°æ®è®°å½•éƒ½è¢«å¤„ç†å®Œæ¯•ã€‚</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œç£ç›˜ä¸Šå­˜æœ‰è‹¥å¹²ä¸ªæº¢å‡ºçš„ä¸´æ—¶æ–‡ä»¶ï¼Œè€Œå†…å­˜çš„Mapç»“æ„ä¸­ç•™æœ‰éƒ¨åˆ†æ•°æ®ï¼ŒSparkä½¿ç”¨å½’å¹¶æ’åºç®—æ³•å¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’ŒMapç»“æ„å‰©ä½™æ•°æ®åšåˆå¹¶ï¼Œåˆ†åˆ«ç”Ÿæˆdataæ–‡ä»¶ã€å’Œä¸ä¹‹å¯¹åº”çš„indexæ–‡ä»¶ï¼Œå¦‚å›¾ä¸­æ­¥éª¤4æ‰€ç¤ºã€‚Shuffleé˜¶æ®µç”Ÿæˆä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œåˆå«Shuffle Writeã€‚</p><p>æ€»ç»“ä¸‹æ¥ï¼ŒShuffleä¸­é—´æ–‡ä»¶çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œåˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p>1.å¯¹äºæ•°æ®åˆ†åŒºä¸­çš„æ•°æ®è®°å½•ï¼Œé€ä¸€è®¡ç®—å…¶ç›®æ ‡åˆ†åŒºï¼Œç„¶åå¡«å……å†…å­˜æ•°æ®ç»“æ„ï¼›<br>\n2.å½“æ•°æ®ç»“æ„å¡«æ»¡åï¼Œå¦‚æœåˆ†åŒºä¸­è¿˜æœ‰æœªå¤„ç†çš„æ•°æ®è®°å½•ï¼Œå°±å¯¹ç»“æ„ä¸­çš„æ•°æ®è®°å½•æŒ‰ï¼ˆç›®æ ‡åˆ†åŒº IDï¼ŒKeyï¼‰æ’åºï¼Œå°†æ‰€æœ‰æ•°æ®æº¢å‡ºåˆ°ä¸´æ—¶æ–‡ä»¶ï¼ŒåŒæ—¶æ¸…ç©ºæ•°æ®ç»“æ„ï¼›<br>\n3.é‡å¤å‰ 2 ä¸ªæ­¥éª¤ï¼Œç›´åˆ°åˆ†åŒºä¸­æ‰€æœ‰çš„æ•°æ®è®°å½•éƒ½è¢«å¤„ç†ä¸ºæ­¢ï¼›<br>\n4.å¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜æ•°æ®ç»“æ„ä¸­å‰©ä½™çš„æ•°æ®è®°å½•åšå½’å¹¶æ’åºï¼Œç”Ÿæˆæ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰äº†Sparkåœ¨Mapé˜¶æ®µç”Ÿäº§Shuffleä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆï¼Œåœ¨Reduceé˜¶æ®µï¼Œä¸åŒçš„Tasksåˆæ˜¯å¦‚ä½•åŸºäºè¿™äº›ä¸­é—´æ–‡ä»¶ï¼Œæ¥å®šä½å±äºè‡ªå·±çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œä»è€Œå®Œæˆæ•°æ®æ‹‰å–å‘¢ï¼Ÿ</p><h3>Shuffle Read</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºæ¯ä¸€ä¸ªMap Taskç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ï¼Œå…¶ä¸­çš„ç›®æ ‡åˆ†åŒºæ•°é‡æ˜¯ç”±Reduceé˜¶æ®µçš„<strong>ä»»åŠ¡æ•°é‡</strong>ï¼ˆåˆå«<strong>å¹¶è¡Œåº¦</strong>ï¼‰å†³å®šçš„ã€‚åœ¨ä¸‹é¢çš„ç¤ºæ„å›¾ä¸­ï¼ŒReduceé˜¶æ®µçš„å¹¶è¡Œåº¦æ˜¯3ï¼Œå› æ­¤ï¼ŒMap Taskçš„ä¸­é—´æ–‡ä»¶ä¼šåŒ…å«3ä¸ªç›®æ ‡åˆ†åŒºçš„æ•°æ®ï¼Œè€Œ<strong>indexæ–‡ä»¶ï¼Œæ°æ°æ˜¯ç”¨æ¥æ ‡è®°ç›®æ ‡åˆ†åŒºæ‰€å±æ•°æ®è®°å½•çš„èµ·å§‹ç´¢å¼•ã€‚</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/22/d9/2283d917c3ab2262bbd91f35e0ce0dd9.jpg?wh=1920x828\" alt=\"å›¾ç‰‡\" title=\"Shuffleä¸­é—´æ–‡ä»¶ç¤ºæ„å›¾\"></p><p>å¯¹äºæ‰€æœ‰Map Taskç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ï¼ŒReduce Taskéœ€è¦é€šè¿‡ç½‘ç»œä»ä¸åŒèŠ‚ç‚¹çš„ç¡¬ç›˜ä¸­ä¸‹è½½å¹¶æ‹‰å–å±äºè‡ªå·±çš„æ•°æ®å†…å®¹ã€‚ä¸åŒçš„Reduce Taskæ­£æ˜¯æ ¹æ®indexæ–‡ä»¶ä¸­çš„èµ·å§‹ç´¢å¼•æ¥ç¡®å®šå“ªäº›æ•°æ®å†…å®¹æ˜¯â€œå±äºè‡ªå·±çš„â€ã€‚Reduceé˜¶æ®µä¸åŒäºReduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹ï¼Œå¾€å¾€ä¹Ÿè¢«å«åš<strong>Shuffle Read</strong>ã€‚</p><p>å¥½å•¦ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¾æ¬¡è§£ç­”äº†æœ¬è®²æœ€åˆæåˆ°çš„å‡ ä¸ªé—®é¢˜ï¼šâ€œä»€ä¹ˆæ˜¯Shuffleï¼Ÿä¸ºä»€ä¹ˆéœ€è¦Shuffleï¼Œä»¥åŠShuffleæ˜¯å¦‚ä½•å·¥ä½œçš„â€ã€‚Shuffleæ˜¯è¡”æ¥ä¸åŒæ‰§è¡Œé˜¶æ®µçš„å…³é”®ç¯èŠ‚ï¼ŒShuffleçš„æ‰§è¡Œæ€§èƒ½å¾€å¾€æ˜¯Sparkä½œä¸šç«¯åˆ°ç«¯æ‰§è¡Œæ•ˆç‡çš„å…³é”®ï¼Œå› æ­¤ï¼ŒæŒæ¡Shuffleï¼Œæ˜¯æˆ‘ä»¬å…¥é—¨Sparkçš„å¿…ç»ä¹‹è·¯ã€‚å¸Œæœ›ä»Šå¤©çš„è®²è§£ï¼Œèƒ½å¸®ä½ æ›´å¥½åœ°è®¤è¯†Shuffleã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åšä¸ªæ€»ç»“ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™Shuffleä¸‹äº†ä¸€ä¸ªæ˜ç¡®çš„å®šä¹‰ï¼Œåœ¨åˆ†å¸ƒå¼è®¡ç®—åœºæ™¯ä¸­ï¼Œ<strong>ShuffleæŒ‡çš„æ˜¯é›†ç¾¤èŒƒå›´å†…è·¨èŠ‚ç‚¹ã€è·¨è¿›ç¨‹çš„æ•°æ®åˆ†å‘</strong>ã€‚</p><p>æˆ‘ä»¬åœ¨æœ€å¼€å§‹æåˆ°ï¼ŒShuffleçš„è®¡ç®—ä¼šæ¶ˆè€—æ‰€æœ‰ç±»å‹çš„ç¡¬ä»¶èµ„æºã€‚å…·ä½“æ¥è¯´ï¼ŒShuffleä¸­çš„å“ˆå¸Œä¸æ’åºæ“ä½œä¼šå¤§é‡æ¶ˆè€—CPUï¼Œè€ŒShuffle Writeç”Ÿæˆä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œä¼šæ¶ˆè€—å®è´µçš„å†…å­˜èµ„æºä¸ç£ç›˜I/Oï¼Œæœ€åï¼ŒShuffle Readé˜¶æ®µçš„æ•°æ®æ‹‰å–ä¼šå¼•å…¥å¤§é‡çš„ç½‘ç»œI/Oã€‚ä¸éš¾å‘ç°ï¼Œ<strong>Shuffleæ˜¯èµ„æºå¯†é›†å‹è®¡ç®—</strong>ï¼Œå› æ­¤ç†è§£Shuffleå¯¹å¼€å‘è€…æ¥è¯´è‡³å…³é‡è¦ã€‚</p><p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬ä»‹ç»äº†Shuffleä¸­é—´æ–‡ä»¶ã€‚Shuffleä¸­é—´æ–‡ä»¶æ˜¯ç»Ÿç§°ï¼Œå®ƒåŒ…å«ä¸¤ç±»æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯è®°å½•ï¼ˆKeyï¼ŒValueï¼‰é”®å€¼å¯¹çš„dataæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯è®°å½•é”®å€¼å¯¹æ‰€å±Reduce Taskçš„indexæ–‡ä»¶ã€‚è®¡ç®—å›¾DAGä¸­çš„Mapé˜¶æ®µä¸Reduceé˜¶æ®µï¼Œæ­£æ˜¯é€šè¿‡ä¸­é—´æ–‡ä»¶æ¥å®Œæˆæ•°æ®çš„äº¤æ¢ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†è®²è§£äº†Shuffle Writeè¿‡ç¨‹ä¸­ç”Ÿæˆä¸­é—´æ–‡ä»¶çš„è¯¦ç»†è¿‡ç¨‹ï¼Œå½’çº³èµ·æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹åˆ†ä¸º4ä¸ªæ­¥éª¤ï¼š</p><p>1.å¯¹äºæ•°æ®åˆ†åŒºä¸­çš„æ•°æ®è®°å½•ï¼Œé€ä¸€è®¡ç®—å…¶ç›®æ ‡åˆ†åŒºï¼Œç„¶åå¡«å……å†…å­˜æ•°æ®ç»“æ„ï¼›<br>\n2.å½“æ•°æ®ç»“æ„å¡«æ»¡åï¼Œå¦‚æœåˆ†åŒºä¸­è¿˜æœ‰æœªå¤„ç†çš„æ•°æ®è®°å½•ï¼Œå°±å¯¹ç»“æ„ä¸­çš„æ•°æ®è®°å½•æŒ‰ï¼ˆç›®æ ‡åˆ†åŒº IDï¼ŒKeyï¼‰æ’åºï¼Œå°†æ‰€æœ‰æ•°æ®æº¢å‡ºåˆ°ä¸´æ—¶æ–‡ä»¶ï¼ŒåŒæ—¶æ¸…ç©ºæ•°æ®ç»“æ„ï¼›<br>\n3.é‡å¤å‰ 2 ä¸ªæ­¥éª¤ï¼Œç›´åˆ°åˆ†åŒºä¸­æ‰€æœ‰çš„æ•°æ®è®°å½•éƒ½è¢«å¤„ç†ä¸ºæ­¢ï¼›<br>\n4.å¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜æ•°æ®ç»“æ„ä¸­å‰©ä½™çš„æ•°æ®è®°å½•åšå½’å¹¶æ’åºï¼Œç”Ÿæˆæ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶ã€‚</p><p>æœ€åï¼Œåœ¨Reduceé˜¶æ®µï¼ŒReduce Taské€šè¿‡indexæ–‡ä»¶æ¥â€œå®šä½â€å±äºè‡ªå·±çš„æ•°æ®å†…å®¹ï¼Œå¹¶é€šè¿‡ç½‘ç»œä»ä¸åŒèŠ‚ç‚¹çš„dataæ–‡ä»¶ä¸­ä¸‹è½½å±äºè‡ªå·±çš„æ•°æ®è®°å½•ã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>è¿™ä¸€è®²å°±åˆ°è¿™é‡Œäº†ï¼Œæˆ‘åœ¨è¿™ç»™ä½ ç•™ä¸ªæ€è€ƒé¢˜ï¼š</p><p>åœ¨Shuffleçš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œä¸­é—´æ–‡ä»¶å­˜å‚¨åœ¨å‚æ•°spark.local.dirè®¾ç½®çš„æ–‡ä»¶ç›®å½•ä¸­ï¼Œè¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼æ˜¯/tmpï¼Œä½ è§‰å¾—è¿™ä¸ªå‚æ•°è¯¥å¦‚ä½•è®¾ç½®æ‰æ›´åˆç†å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œæˆ‘åœ¨è¯„è®ºåŒºç­‰ä½ ã€‚å¦‚æœè¿™ä¸€è®²å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä½ ä¹Ÿå¯ä»¥åˆ†äº«ç»™è‡ªå·±çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ã€‚</p>","comments":[{"had_liked":false,"id":313109,"user_name":"Geek_2dfa9a","can_delete":false,"product_type":"c1","uid":1435535,"ip_address":"","ucode":"B5FE7971F5E773","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","comment_is_top":true,"comment_ctime":1632281609,"is_pvip":false,"replies":[{"id":"113471","content":"å®Œç¾ï¼Œæ»¡åˆ†ğŸ’¯ï¼ç½®é¡¶ğŸ”<br><br>è€å¼ŸåŠŸåº•ååˆ†æ‰å®ï½ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632358182,"ip_address":"","comment_id":313109,"utype":1}],"discussion_count":7,"race_medal":0,"score":"9.2233721587460997e+18","product_id":100090001,"comment_content":"å®˜ç½‘é…ç½®æ–‡æ¡£ https:&#47;&#47;spark.apache.org&#47;docs&#47;3.1.2&#47;configuration.html<br>Directory to use for &quot;scratch&quot; space in Spark, including map output files and RDDs that get stored on disk. This should be on a fast, local disk in your system. It can also be a comma-separated list of multiple directories on different disks.<br>Note: This will be overridden by SPARK_LOCAL_DIRS (Standalone), MESOS_SANDBOX (Mesos) or LOCAL_DIRS (YARN) environment variables set by the cluster manager.<br>ä¸´æ—¶ç›®å½•ï¼Œç”¨æ¥å­˜map outputæ–‡ä»¶ï¼ˆshuffleäº§ç”Ÿï¼‰å’Œsave RDDåˆ°ç£ç›˜çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚åº”è¯¥é…ç½®æˆå¿«é€Ÿçš„æœ¬åœ°ç£ç›˜ã€‚æ”¯æŒâ€˜,â€™åˆ†éš”çš„å¤šä¸ªç›®å½•ã€‚<br>æ³¨æ„ï¼šè¿™ä¸ªé…ç½®ä¼šè¢«SPARK_LOCAL_DIRSï¼ˆStandaloneéƒ¨ç½²ï¼‰ï¼ŒMESOS_SANDBOXï¼ˆMesosï¼‰ï¼ŒLOCAL_DIRS (YARN)æ›¿æ¢ã€‚<br>æ—¢ç„¶shuffleä¼šå¸¦æ¥å¾ˆé«˜çš„å¼€é”€ï¼Œé™¤äº†ä¼˜åŒ–driverç¨‹åºä¹Ÿå¯ä»¥è€ƒè™‘ä¼˜åŒ–ç³»ç»Ÿé…ç½®ã€‚<br>é¦–å…ˆ&#47;tmpæ˜¯ä¼šè¢«ç³»ç»Ÿæ¸…ç†çš„ï¼ˆå–å†³äºä¸åŒlinuxåˆ†å‘ç‰ˆçš„æ¸…ç†ç­–ç•¥ï¼‰ï¼Œå¦‚æœä½œä¸šè¿è¡Œæ—¶&#47;tmpä¸­çš„æ–‡ä»¶è¢«æ¸…é™¤äº†ï¼Œé‚£å°±è¦é‡æ–°shuffleæˆ–<br>é‡æ–°ç¼“å­˜RDDï¼ˆè¿™å—æ²¡æœ‰ä»”ç»†ç ”ç©¶ï¼Œç®€å•çŒœæµ‹ä¸‹ç¼“å­˜å¤±æ•ˆç­–ç•¥æ˜¯é‡æ–°ç¼“å­˜ï¼‰ï¼Œå› æ­¤ï¼Œä¸é€‚åˆå°†é…ç½®spark.local.dirè®¾ç½®ä¸ºé»˜è®¤çš„&#47;tmp<br>å…¶æ¬¡ï¼Œéƒ¨ç½²æ–‡æ¡£æœ‰æè¯¥é…ç½®é¡¹æ”¯æŒå¤šä¸ªç›®å½•ï¼Œé‚£å¯ä»¥è€ƒè™‘é…ç½®å¤šå—ç¡¬ç›˜ï¼ˆæˆ–è€…SSDï¼‰ï¼Œå†æŠŠæŒ‚è½½ä¸åŒç¡¬ç›˜çš„ç›®å½•é…ç½®åˆ°spark.local.dirï¼Œ<br>è¿™æ ·å¯ä»¥æ˜¾è‘—æå‡shuffleå’ŒRDDç¼“å­˜çš„æ€§èƒ½ã€‚è¯·å¤§å®¶æŒ‡æ•™ã€‚","like_count":28,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527236,"discussion_content":"å®Œç¾ï¼Œæ»¡åˆ†ğŸ’¯ï¼ç½®é¡¶ğŸ”\n\nè€å¼ŸåŠŸåº•ååˆ†æ‰å®ï½ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632358182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395369,"discussion_content":"ç”¨é€—å·åˆ†å¼€å¯ä»¥å®ç°æŒ‚è½½åˆ°å¤šä¸ªç¡¬ç›˜çš„ç›®å½•ä¸‹ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯å°±å¯ä»¥é¿å…ç¡¬ç›˜æ•…éšœå’Œæé«˜shuffle writeçš„å¹¶è¡Œåº¦äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632294351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1435535,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","nickname":"Geek_2dfa9a","note":"","ucode":"B5FE7971F5E773","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":395438,"discussion_content":"\næˆ‘è§‰å¾—æ˜¯è¿™æ ·ï¼Œä¸»è¦ç›®æ ‡æ˜¯ä¸ºäº†æå‡shuffleçš„ioæ•ˆç‡ï¼Œå®¹é”™çš„è¯å¹¶ä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå› ä¸ºè¿™äº›ä¸´æ—¶æ–‡ä»¶åœ¨jobè¿è¡Œå®Œæˆåä¼šæ¸…ç†çš„ï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯jobçº§åˆ«çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632305832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":395369,"ip_address":""},"score":395438,"extra":""},{"author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1435535,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","nickname":"Geek_2dfa9a","note":"","ucode":"B5FE7971F5E773","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395643,"discussion_content":"å¯ä»¥æ·±å…¥è®¨è®ºä¸€ä¸‹ï¼Œå¦‚æœæŠŠshuffle writeæ•°æ®è½ç›˜æ“ä½œå’ŒKafkaæ•°æ®è½ç›˜æ“ä½œæ¨ªå‘å¯¹æ¯”ä¸€ä¸‹ï¼Œä¼šä¸ä¼šæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼ŒåŒæ ·æ˜¯æ•°æ®å…ˆå†™å…¥å†…å­˜ï¼Œç„¶åæ‰¹é‡è½ç›˜ï¼Œkafkaä¼šæä¾›offsetæ–‡ä»¶ï¼Œshuffleä¼šæä¾›indexæ–‡ä»¶ï¼Œå¦‚æœæŠŠshuffleæ›¿æ¢æˆkafkaæ˜¯ä»€ä¹ˆæ•ˆæœï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632321018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":395438,"ip_address":""},"score":395643,"extra":""},{"author":{"id":1435535,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epGTSTvn7r4ibk1PuaUrSvvLdviaLcne50jbvvfiaxKkM5SLibeP6jibA2bCCQBqETibvIvcsOhAZlwS8kQ/132","nickname":"Geek_2dfa9a","note":"","ucode":"B5FE7971F5E773","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1385403,"avatar":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","nickname":"GACÂ·DU","note":"","ucode":"7847FBE1C13740","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":395753,"discussion_content":"æ²¡é—®é¢˜ï¼Œæˆ‘æ‰¾ä¸ªæ—¶é—´ä»”ç»†çœ‹ä¸‹æºç å†å›å¤ä½ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632327001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":395643,"ip_address":""},"score":395753,"extra":""}]}]},{"had_liked":false,"id":313333,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1632380972,"is_pvip":true,"replies":[{"id":"113519","content":"å¥½é—®é¢˜ï½<br><br>ç¬¬ä¸€ä¸ªé—®é¢˜å®é™…ä¸Šï¼Œå°±æ˜¯æ•°æ®å€¾æ–œï¼Œdata skewï¼Œå€¾æ–œä¼šå¯¼è‡´ä½ è¯´çš„ï¼Œé—²çš„é—²æ­»ã€å¿™çš„å¿™æ­»ï¼Œå¿™çš„é‚£ä¸ªæ‹–ç´¯ä½œä¸šæ•´ä½“æ€§èƒ½ã€‚ä¸¤ç§æ€è·¯ï¼Œä¸€ä¸ªæ˜¯ç”¨spark3.0çš„AQEï¼Œjoinè‡ªåŠ¨å€¾æ–œå¤„ç†ã€‚å¦ä¸€ä¸ªæ˜¯æ‰‹å·¥åŠ ç›ã€‚è¿™ä¸¤ç§æ–¹æ³•ï¼Œå…¶å®åœ¨ã€Šæ€§èƒ½ç¯‡ã€‹éƒ½æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚ç¨åæˆ‘æŠŠé‚£è¾¹æ¯”è¾ƒæ ¸å¿ƒçš„è®²è§£ï¼Œç»™ä½ è´´è¿‡æ¥ã€‚è¿™ä¼šåœ¨åœ°é“ä¸Šï¼Œä¸å¥½æ“ä½œã€‚<br><br>ç¬¬äºŒä¸ªï¼Œå…¶å®æ˜¯ä¸¤ä¸ªå±‚é¢çš„äº‹æƒ…ã€‚ä¸€ä¸ªæ˜¯è°ƒåº¦ç³»ç»Ÿï¼Œè¯´çš„æ˜¯ä»£ç è°ƒåº¦ï¼Œè°ƒåº¦åˆ°æ•°æ®æ‰€åœ¨çš„åœ°æ–¹ã€‚è€Œshuffleå‘¢ï¼Œæ•°æ®ç§»åŠ¨æ˜¯åˆšéœ€ï¼Œæ˜¯è®¡ç®—é€»è¾‘éœ€è¦ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä»£ç åŠ¨ä¸åŠ¨ï¼Œæ•°æ®éƒ½è¦åŠ¨ã€‚è¿™ä¸ªå…¶å®å·²ç»è¶…å‡ºè°ƒåº¦ç³»ç»ŸèŒƒç•´ï¼Œçº¯ç²¹æ˜¯è®¡ç®—é€»è¾‘éœ€è¦ã€‚ä¸¤ä¸ªå±‚é¢çš„é—®é¢˜å“ˆï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632447114,"ip_address":"","comment_id":313333,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44582053932","product_id":100090001,"comment_content":"çœ‹åˆ°å“ˆå¸Œé‚£è¾¹æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é‡åˆ°ä¸å‡åŒ€çš„æ•°æ®ä¼šæ€ä¹ˆæ ·ï¼Ÿæ¯”å¦‚å¯¹è¿™ç¯‡è®ºæ–‡æ‰§è¡Œword countï¼šhttps:&#47;&#47;isotropic.org&#47;papers&#47;chicken.pdf<br><br>åŸæœ¬å¯èƒ½æŒ‡æœ›æ‰€æœ‰å·¥äººä¸€èµ·æ¬ç –ï¼Œç»“æœå‘ç°åªæœ‰ä¸€ä¸ªå·¥äººåœ¨æ¬ç –ï¼Ÿ<br><br>å¦å¤–å‰å‡ è®²è¯´è¿‡å¤§æ•°æ®çš„ç²¾é«“åœ¨äºæ•°æ®ä¸åŠ¨ä»£ç åŠ¨ï¼Œä½†è¿™è®²è¯´è¿˜æ˜¯æ— æ³•é¿å…shuffleæ¬è¿æ•°æ®ï¼Œè¿™ä¸ªè¦æ€ä¹ˆç†è§£ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527317,"discussion_content":"å¥½é—®é¢˜ï½\n\nç¬¬ä¸€ä¸ªé—®é¢˜å®é™…ä¸Šï¼Œå°±æ˜¯æ•°æ®å€¾æ–œï¼Œdata skewï¼Œå€¾æ–œä¼šå¯¼è‡´ä½ è¯´çš„ï¼Œé—²çš„é—²æ­»ã€å¿™çš„å¿™æ­»ï¼Œå¿™çš„é‚£ä¸ªæ‹–ç´¯ä½œä¸šæ•´ä½“æ€§èƒ½ã€‚ä¸¤ç§æ€è·¯ï¼Œä¸€ä¸ªæ˜¯ç”¨spark3.0çš„AQEï¼Œjoinè‡ªåŠ¨å€¾æ–œå¤„ç†ã€‚å¦ä¸€ä¸ªæ˜¯æ‰‹å·¥åŠ ç›ã€‚è¿™ä¸¤ç§æ–¹æ³•ï¼Œå…¶å®åœ¨ã€Šæ€§èƒ½ç¯‡ã€‹éƒ½æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚ç¨åæˆ‘æŠŠé‚£è¾¹æ¯”è¾ƒæ ¸å¿ƒçš„è®²è§£ï¼Œç»™ä½ è´´è¿‡æ¥ã€‚è¿™ä¼šåœ¨åœ°é“ä¸Šï¼Œä¸å¥½æ“ä½œã€‚\n\nç¬¬äºŒä¸ªï¼Œå…¶å®æ˜¯ä¸¤ä¸ªå±‚é¢çš„äº‹æƒ…ã€‚ä¸€ä¸ªæ˜¯è°ƒåº¦ç³»ç»Ÿï¼Œè¯´çš„æ˜¯ä»£ç è°ƒåº¦ï¼Œè°ƒåº¦åˆ°æ•°æ®æ‰€åœ¨çš„åœ°æ–¹ã€‚è€Œshuffleå‘¢ï¼Œæ•°æ®ç§»åŠ¨æ˜¯åˆšéœ€ï¼Œæ˜¯è®¡ç®—é€»è¾‘éœ€è¦ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä»£ç åŠ¨ä¸åŠ¨ï¼Œæ•°æ®éƒ½è¦åŠ¨ã€‚è¿™ä¸ªå…¶å®å·²ç»è¶…å‡ºè°ƒåº¦ç³»ç»ŸèŒƒç•´ï¼Œçº¯ç²¹æ˜¯è®¡ç®—é€»è¾‘éœ€è¦ã€‚ä¸¤ä¸ªå±‚é¢çš„é—®é¢˜å“ˆï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632447114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1722878,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/49/fe/48846a6d.jpg","nickname":"Ebdaoli","note":"","ucode":"E45C113C1AFD12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":579212,"discussion_content":"æˆ‘æƒ³è¯·é—®ä¸‹ï¼Œå…³äºç§»åŠ¨è®¡ç®—å’Œç§»åŠ¨æ•°æ®çš„é—®é¢˜ï¼Œæ•°æ®æœ¬åœ°åŒ–çš„ä¼˜å…ˆçº§æ˜¯æ¥æºäºæ•°æ®å­˜æ”¾çš„èŠ‚ç‚¹å’Œè®¡ç®—èŠ‚ç‚¹çš„ä¸€è‡´æ€§ï¼Œè€Œè®¡ç®—èŠ‚ç‚¹æœ‰é™çš„è®¡ç®—èµ„æºä¸èƒ½ä¿è¯å¿…ç„¶çš„æœ¬åœ°åŒ–ï¼Œé‚£ä¹ˆåœ¨å…¶ä»–èŠ‚ç‚¹å¯åŠ¨çš„è®¡ç®—ä»»åŠ¡å°±éœ€è¦ä»æ•°æ®å­˜æ”¾èŠ‚ç‚¹æ¥æ‹‰å–æ•°æ®ã€‚ä¸Šè¿°è¿™éƒ¨åˆ†çš„æ“ä½œæ˜¯å½±å“äº†è®¡ç®—æœ¬åœ°åŒ–å’Œè®¡ç®—éæœ¬åœ°åŒ–çš„æ—¶é—´å·®å¼‚ï¼Œé‚£ä¹ˆåœ¨æ•°æ®ç»è¿‡shuffleç®—å­ä¹‹åï¼Œreduceçš„æ‰§è¡ŒèŠ‚ç‚¹å¯¹shuffleæº¢å‡ºæ–‡ä»¶çš„æ‹‰å–è¿‡ç¨‹ï¼Œè¿™éƒ¨åˆ†åº”è¯¥æ˜¯æ‹‰å–æ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¿™éƒ¨åˆ†è¿‡ç¨‹æ˜¯å¦ä¼šæ¶‰åŠåˆ°è®¡ç®—æœ¬åœ°åŒ–ï¼Ÿæ¯”å¦‚æˆ‘åœ¨æœ¬åœ°å†™å‡ºmapç«¯æ–‡ä»¶ï¼Œåœ¨æœ¬åœ°ç»§ç»­æ‰§è¡Œreduceè¿‡ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657250360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":527317,"ip_address":""},"score":579212,"extra":""}]}]},{"had_liked":false,"id":315123,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1633694771,"is_pvip":false,"replies":[{"id":"114422","content":"å¥½é—®é¢˜~ æ˜¯çš„ï¼Œ å°±åƒä½ åˆ†æçš„é‚£æ ·ï¼Œå¦‚æœmap taskè®¡ç®—é˜¶æ®µï¼Œå‘ç°æ²¡æœ‰æŸäº›reduce taskçš„æ•°æ®ï¼Œé‚£ä¹ˆindexæ–‡ä»¶ä¸­çš„ç´¢å¼•ï¼Œå°±ä¼šä¸€ç›´é¡ºå»¶~ æ€è€ƒçš„å¾ˆæ·±å…¥ï¼ŒèµğŸ‘~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633965230,"ip_address":"","comment_id":315123,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23108531251","product_id":100090001,"comment_content":"è€å¸ˆæ‚¨åœ¨shuffle readéƒ¨åˆ†è¯´â€œä¸åŒçš„ Reduce Task æ­£æ˜¯æ ¹æ® index æ–‡ä»¶ä¸­çš„èµ·å§‹ç´¢å¼•æ¥ç¡®å®šå“ªäº›æ•°æ®å†…å®¹æ˜¯å±äºè‡ªå·±çš„â€ï¼Œè¿™ä¸€æ­¥å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿä»¥æ–‡ä¸­çš„indexæ–‡ä»¶ä¸¾ä¾‹ï¼Œæ–‡ä¸­çš„indexæ–‡ä»¶æ˜¯0,3,7ï¼Œé‚£ä¹ˆä¸åŒçš„reduce taskæ˜¯å„è‡ªæœ‰ä¸€ä¸ªç¼–å·ï¼Œç„¶åæŒ‰ç¼–å·å¤§å°é¡ºåºç¡®å®šè‡ªå·±åº”è¯¥æ‹‰å–å“ªä¸€éƒ¨åˆ†æ•°æ®å—ï¼Ÿæ¯”å¦‚ç¼–å·ä¸º0çš„reduce taskæ‹‰å–indexæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªç´¢å¼•åˆ°ç¬¬äºŒä¸ªç´¢å¼•ä¹‹é—´çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯indexä¸º0,1,2çš„æ•°æ®ï¼›ç¼–å·ä¸º1çš„reduce taskæ‹‰å–indexæ–‡ä»¶çš„ç¬¬äºŒä¸ªç´¢å¼•åˆ°ç¬¬ä¸‰ä¸ªç´¢å¼•ä¹‹é—´çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯indexä¸º3,4,5,6çš„æ•°æ®ï¼›ç¼–å·ä¸º2çš„reduce taskæ‹‰å–indexæ–‡ä»¶çš„ç¬¬ä¸‰ä¸ªç´¢å¼•åˆ°æœ€åçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯indexä¸º7,8,9çš„æ•°æ®ï¼Ÿè¿™æ ·çš„è¯å¦‚æœmap taskè®¡ç®—å‡ºæ¥æ²¡æœ‰æ•°æ®åº”è¯¥è¢«å‘åˆ°ç¬¬äºŒä¸ªreduce taské‚£indexæ–‡ä»¶æ˜¯0,3,3å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527874,"discussion_content":"å¥½é—®é¢˜~ æ˜¯çš„ï¼Œ å°±åƒä½ åˆ†æçš„é‚£æ ·ï¼Œå¦‚æœmap taskè®¡ç®—é˜¶æ®µï¼Œå‘ç°æ²¡æœ‰æŸäº›reduce taskçš„æ•°æ®ï¼Œé‚£ä¹ˆindexæ–‡ä»¶ä¸­çš„ç´¢å¼•ï¼Œå°±ä¼šä¸€ç›´é¡ºå»¶~ æ€è€ƒçš„å¾ˆæ·±å…¥ï¼ŒèµğŸ‘~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633965230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314262,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1632919717,"is_pvip":false,"replies":[{"id":"113942","content":"å¥½é—®é¢˜~<br><br>å…ˆè¯´ç¬¬ä¸€ä¸ªï¼Œè¿™ä¸ªå°±æ˜¯indexæ–‡ä»¶çš„ä½œç”¨ï¼Œå®ƒè®°å½•çš„å°±æ˜¯éš¶å±äºä¸åŒReduce taskçš„æ•°æ®ç´¢å¼•ï¼ŒReduce taskåŸºäºè¿™äº›ç´¢å¼•æ¥åˆ¤æ–­ï¼Œå“ªäº›æ•°æ®å±äºä»–ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒReduce task 3ï¼Œé‚£ä¹ˆdataæ–‡ä»¶ä¸­ï¼Œindexä»3åˆ°4ä¹‹é—´çš„æ•°æ®ï¼Œå°±æ˜¯å±äºè¿™ä¸ªReduce task 3çš„ã€‚<br><br>ç¬¬äºŒä¸ªï¼Œå¥½é—®é¢˜ã€‚è¿™ä¸ªå…¶å®æ˜¯â€œé™æ€æ€ç»´â€æƒ¹çš„ç¥¸ã€‚è¦çŸ¥é“ï¼Œä¸ç®¡æ˜¯Map taskï¼Œè¿˜æ˜¯Reduce taskï¼Œæ¶ˆè€—çš„è®¡ç®—èµ„æºï¼Œéƒ½æ˜¯åŒä¸€ä¸ªé›†ç¾¤ã€åŒæ ·èŠ‚ç‚¹ä¸ŠåŒæ ·çš„ä¸€æ‰¹Executorsã€‚<br><br>Reduce taskså¯¹äºMap tasksæ˜¯æœ‰ä¾èµ–çš„ï¼ŒåŒä¸€æ‰¹Executorsï¼Œæ‰§è¡Œå®ŒMap tasksä¹‹åï¼Œæ•°æ®è½ç›˜åˆ°äº†spark.local.diré…ç½®çš„ç›®å½•ã€‚æ¥ä¸‹æ¥ï¼Œè¿˜æ˜¯è¿™åŒä¸€æ‰¹Executorsï¼Œå¯åŠ¨Reduce tasksï¼Œè·¨ç½‘ç»œå»ä¸åŒèŠ‚ç‚¹ä¸Šæ‹‰å–å±äºè‡ªå·±çš„æ•°æ®ã€‚<br><br>å› æ­¤ï¼ŒExecutorsä¸€ç›´æ²¡é—²ç€ï¼Œä¸å­˜åœ¨èµ„æºæµªè´¹çš„é—®é¢˜ã€‚è¦åŠ¨æ€åœ°çœ‹å¾…Map &amp; Reduceè¿‡ç¨‹ï¼Œä»–ä»¬åœ¨æ—¶é—´çº¿ä¸Šï¼Œæ˜¯æœ‰å‰åå…³ç³»çš„ã€‚è€Œæ‰€æœ‰ä»»åŠ¡ï¼Œæ¶ˆè€—çš„éƒ½æ˜¯åŒä¸€æ‰¹ç¡¬ä»¶èµ„æº~<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633167934,"ip_address":"","comment_id":314262,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18812788901","product_id":100090001,"comment_content":"è€å¸ˆæ‚¨å¥½  æˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜æƒ³é—®ä¸‹ï¼š<br>1. å¯¹äºæ‰€æœ‰ Map Task ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ï¼ŒReduce Task éœ€è¦é€šè¿‡ç½‘ç»œä»ä¸åŒèŠ‚ç‚¹çš„ç¡¬ç›˜ä¸­ä¸‹è½½å¹¶æ‹‰å–å±äºè‡ªå·±çš„æ•°æ®å†…å®¹  é‚£ä¸åŒçš„reduce taskæ˜¯æ€ä¹ˆçŸ¥é“å“ªäº›å†…å®¹æ˜¯å±äºè‡ªå·±çš„å‘¢ï¼Ÿæ¯”å¦‚å¯¹äºæ–‡ä¸­çš„ä¾‹å­ï¼Œreduceé˜¶æ®µçš„3ä¸ªä»»åŠ¡æ€ä¹ˆçŸ¥é“è‡ªå·±åº”è¯¥æ‹‰å–ä¸­é—´æ–‡ä»¶çš„å“ªäº›è®°å½•ï¼Ÿ<br>2. å¯¹äºè¯„è®ºåŒºAIKçš„é—®é¢˜ï¼Œæ‚¨è¯´shuffleè¿‡ç¨‹ä¸æ˜¯æ•°æ®äº¤æ¢ï¼Œè€Œæ˜¯æ•°æ®æµè½¬ï¼Œé‚£æ„æ€æ˜¯åœ¨mapé˜¶æ®µ æ‰€æœ‰å°†è¦æ‰§è¡Œreduce taskçš„èŠ‚ç‚¹éƒ½æ˜¯ç©ºé—²çš„å—ï¼ˆç­‰å¾…map taskç”Ÿæˆshuffleä¸­é—´æ–‡ä»¶ï¼‰ï¼Ÿé‚£ä»–ä»¬æ˜¯ä¸æ˜¯åœ¨è¿™ä¸ªstageçš„æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ä¸­éƒ½æ˜¯ç©ºé—²çš„ï¼Ÿè¿™æ ·çš„è¯å²‚ä¸æ˜¯æ²¡æœ‰å‘æŒ¥å‡ºé›†ç¾¤çš„æœ€å¤§ç®—åŠ›ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400326,"discussion_content":"è°¢è°¢è€å¸ˆç¬¬äºŒé—®é¢˜æˆ‘æ‡‚äº†ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªè¿˜æ˜¯ä¸å¤ªæ˜ç™½ï¼Œå°±æ¯”å¦‚è¯´æ–‡ç« ä¸­çš„é‚£ä¸ªä¾‹å­ï¼Œindexæ–‡ä»¶æ˜¯0ï¼Œ3ï¼Œ7ï¼Œè¡¨ç¤ºä¸€ä¸ªreduce taskè¦æ‹¿indexä¸º0ã€1ã€2çš„æ•°æ®ï¼Œå¦ä¸€ä¸ªreduce taskè¦æ‹¿indexä¸º3ã€4ã€5ã€6çš„æ•°æ®ï¼Œå‰©ä¸‹é‚£ä¸ªreduce taskè¦æ‹¿indexä¸º7ã€8ã€9çš„æ•°æ®ï¼Œä½†æ˜¯reduce taskå¥½åƒæ²¡æœ‰æ ‡å·å•Šï¼Œä»–ä»¬æ€ä¹ˆçŸ¥é“å“ªäº›æ•°æ®æ˜¯å±äºè‡ªå·±çš„å‘¢","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1633234281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527623,"discussion_content":"å¥½é—®é¢˜~\n\nå…ˆè¯´ç¬¬ä¸€ä¸ªï¼Œè¿™ä¸ªå°±æ˜¯indexæ–‡ä»¶çš„ä½œç”¨ï¼Œå®ƒè®°å½•çš„å°±æ˜¯éš¶å±äºä¸åŒReduce taskçš„æ•°æ®ç´¢å¼•ï¼ŒReduce taskåŸºäºè¿™äº›ç´¢å¼•æ¥åˆ¤æ–­ï¼Œå“ªäº›æ•°æ®å±äºä»–ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒReduce task 3ï¼Œé‚£ä¹ˆdataæ–‡ä»¶ä¸­ï¼Œindexä»3åˆ°4ä¹‹é—´çš„æ•°æ®ï¼Œå°±æ˜¯å±äºè¿™ä¸ªReduce task 3çš„ã€‚\n\nç¬¬äºŒä¸ªï¼Œå¥½é—®é¢˜ã€‚è¿™ä¸ªå…¶å®æ˜¯â€œé™æ€æ€ç»´â€æƒ¹çš„ç¥¸ã€‚è¦çŸ¥é“ï¼Œä¸ç®¡æ˜¯Map taskï¼Œè¿˜æ˜¯Reduce taskï¼Œæ¶ˆè€—çš„è®¡ç®—èµ„æºï¼Œéƒ½æ˜¯åŒä¸€ä¸ªé›†ç¾¤ã€åŒæ ·èŠ‚ç‚¹ä¸ŠåŒæ ·çš„ä¸€æ‰¹Executorsã€‚\n\nReduce taskså¯¹äºMap tasksæ˜¯æœ‰ä¾èµ–çš„ï¼ŒåŒä¸€æ‰¹Executorsï¼Œæ‰§è¡Œå®ŒMap tasksä¹‹åï¼Œæ•°æ®è½ç›˜åˆ°äº†spark.local.diré…ç½®çš„ç›®å½•ã€‚æ¥ä¸‹æ¥ï¼Œè¿˜æ˜¯è¿™åŒä¸€æ‰¹Executorsï¼Œå¯åŠ¨Reduce tasksï¼Œè·¨ç½‘ç»œå»ä¸åŒèŠ‚ç‚¹ä¸Šæ‹‰å–å±äºè‡ªå·±çš„æ•°æ®ã€‚\n\nå› æ­¤ï¼ŒExecutorsä¸€ç›´æ²¡é—²ç€ï¼Œä¸å­˜åœ¨èµ„æºæµªè´¹çš„é—®é¢˜ã€‚è¦åŠ¨æ€åœ°çœ‹å¾…Map &amp;amp; Reduceè¿‡ç¨‹ï¼Œä»–ä»¬åœ¨æ—¶é—´çº¿ä¸Šï¼Œæ˜¯æœ‰å‰åå…³ç³»çš„ã€‚è€Œæ‰€æœ‰ä»»åŠ¡ï¼Œæ¶ˆè€—çš„éƒ½æ˜¯åŒä¸€æ‰¹ç¡¬ä»¶èµ„æº~\n\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1633167934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337251,"user_name":"é’Ÿå¼º","can_delete":false,"product_type":"c1","uid":2446756,"ip_address":"","ucode":"C4227385241E70","user_header":"https://static001.geekbang.org/account/avatar/00/25/55/a4/a06abd2d.jpg","comment_is_top":false,"comment_ctime":1646718740,"is_pvip":false,"replies":[{"id":"123312","content":"shuffleä¸executorsæ•°é‡æ— å…³å“ˆï¼Œå³ä¾¿æ˜¯ä¸€ä¸ªexecutorsï¼ŒåƒgroupByKeyã€joinã€reduceByKeyè¿™äº›æ“ä½œï¼Œç…§æ ·ä¼šå¼•å…¥shuffleï¼Œåªä¸è¿‡shuffleéƒ½åœ¨åŒä¸€ä¸ªexecutorså‘ç”Ÿï¼Œçœå»äº†ç½‘ç»œI&#47;Oçš„å¼€é”€ï¼Œä½†æ˜¯ç£ç›˜å¼€é”€è¿˜æ˜¯ä¼šæœ‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1646833878,"ip_address":"","comment_id":337251,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10236653332","product_id":100090001,"comment_content":"å¦‚æœé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªexecutor, ä½†æ˜¯executorä¸Šé¢æœ‰å¤šä¸ªmap task, è¿™æ ·çš„ç¯å¢ƒæ˜¯ä¸æ˜¯ä¸éœ€è¦shuffle?","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555284,"discussion_content":"shuffleä¸executorsæ•°é‡æ— å…³å“ˆï¼Œå³ä¾¿æ˜¯ä¸€ä¸ªexecutorsï¼ŒåƒgroupByKeyã€joinã€reduceByKeyè¿™äº›æ“ä½œï¼Œç…§æ ·ä¼šå¼•å…¥shuffleï¼Œåªä¸è¿‡shuffleéƒ½åœ¨åŒä¸€ä¸ªexecutorså‘ç”Ÿï¼Œçœå»äº†ç½‘ç»œI/Oçš„å¼€é”€ï¼Œä½†æ˜¯ç£ç›˜å¼€é”€è¿˜æ˜¯ä¼šæœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646833878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336984,"user_name":"Ebdaoli","can_delete":false,"product_type":"c1","uid":1722878,"ip_address":"","ucode":"E45C113C1AFD12","user_header":"https://static001.geekbang.org/account/avatar/00/1a/49/fe/48846a6d.jpg","comment_is_top":false,"comment_ctime":1646535243,"is_pvip":false,"replies":[{"id":"123311","content":"ä¸€ä¸ªä¸ªæ¥çœ‹å“ˆ<br>1ï¼‰Map taskï¼Œå…¶å¹¶è¡Œåº¦ç”±å…¶Stageä¸­çš„é¦–ä¸ªRDDå†³å®šï¼Œå¦‚æœMap taskæ˜¯è¯»å–HDFSï¼Œé‚£ä¹ˆå¹¶è¡Œåº¦å°±æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶blockæ•°é‡ï¼›<br>2ï¼‰æ˜¯çš„ï¼Œä¸­é—´æ–‡ä»¶çš„åˆå¹¶ï¼Œå¯ä»¥ç†è§£ä¸ºå½’å¹¶æ’åºï¼›å¦å¤–ï¼Œå¯¹äºJoinç­–ç•¥ï¼ŒSparké€šå¸¸é»˜è®¤é€‰å–SMJï¼Œå› æ­¤Sortæœ‰åˆ©äºåæœŸåšæ•°æ®å…³è”","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1646833789,"ip_address":"","comment_id":336984,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10236469835","product_id":100090001,"comment_content":"ç£Šå“¥ï¼Œå…³äº spark shuffle write é˜¶æ®µæœ‰ä¸ªé—®é¢˜ä¸å¤ªç†è§£ï¼Œâ‘ ï¼šMaptaskçš„ ä»»åŠ¡æ•°çš„å¹¶è¡Œåº¦ç”±ä»€ä¹ˆæ¥å†³å®šçš„ï¼Ÿæ ¹æ®æ–‡ä»¶å¤§å°æ¥åˆ‡åˆ†åˆ’åˆ†çš„å—ï¼Ÿ â‘¡ï¼šä¸ºä»€ä¹ˆæœ€ç»ˆæ•°æ®éœ€è¦è¿›è¡Œ sortï¼Ÿåˆå¹¶çš„æ–¹å¼é€‰æ‹©çš„æ˜¯ å½’å¹¶æ’åºï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555283,"discussion_content":"ä¸€ä¸ªä¸ªæ¥çœ‹å“ˆ\n1ï¼‰Map taskï¼Œå…¶å¹¶è¡Œåº¦ç”±å…¶Stageä¸­çš„é¦–ä¸ªRDDå†³å®šï¼Œå¦‚æœMap taskæ˜¯è¯»å–HDFSï¼Œé‚£ä¹ˆå¹¶è¡Œåº¦å°±æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶blockæ•°é‡ï¼›\n2ï¼‰æ˜¯çš„ï¼Œä¸­é—´æ–‡ä»¶çš„åˆå¹¶ï¼Œå¯ä»¥ç†è§£ä¸ºå½’å¹¶æ’åºï¼›å¦å¤–ï¼Œå¯¹äºJoinç­–ç•¥ï¼ŒSparké€šå¸¸é»˜è®¤é€‰å–SMJï¼Œå› æ­¤Sortæœ‰åˆ©äºåæœŸåšæ•°æ®å…³è”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646833789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324852,"user_name":"çŒ«å¤ªå¤ª","can_delete":false,"product_type":"c1","uid":1537617,"ip_address":"","ucode":"7A1D1CAA3AF260","user_header":"https://static001.geekbang.org/account/avatar/00/17/76/51/96291466.jpg","comment_is_top":false,"comment_ctime":1638688055,"is_pvip":false,"replies":[{"id":"118144","content":"è€å¼Ÿè¯´çš„æ˜¯å¯¹çš„~ Reduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯Shuffle Readã€‚<br><br>è¿™é‡Œçš„å†™æ³•æœ‰é—®é¢˜ï¼Œæˆ‘å›å¤´è®©ç¼–è¾‘å¸®å¿™æ”¹ä¸‹ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æœ€åçš„æ€»ç»“éƒ¨åˆ†ï¼Œæ”¹å¾—æ¯”è¾ƒä»“ä¿ƒï¼Œå‡ºtypoäº†ï¼Œæ„Ÿè°¢è€å¼Ÿæé†’~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1639060873,"ip_address":"","comment_id":324852,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10228622647","product_id":100090001,"comment_content":"æ‚¨å¥½ï¼Œè®²çš„å¾ˆæ¸…æ¥šï¼Œçœ‹å®Œéƒ½æœ‰ç‚¹æƒ³å»å»è‡ªå·±çœ‹æºç äº†ã€‚è¿™å¥æœ‰ç‚¹ä¸å¤ªç†è§£ï¼Œå¯ä»¥è§£é‡Šä¸€ä¸‹ä¹ˆï¼šâ€œReduce é˜¶æ®µä¸åŒäº Reduce Task æ‹‰å–æ•°æ®çš„è¿‡ç¨‹ï¼Œå¾€å¾€ä¹Ÿè¢«å«åš Shuffle Readã€‚â€ è¯·é—®shuffle readå±äºreduceé˜¶æ®µä¹ˆï¼Ÿreduce taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹ä¸åŒ…æ‹¬åœ¨reduceé˜¶æ®µä¹ˆï¼Ÿreduce taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹ä¸æ˜¯shuffle readä¹ˆï¼Ÿreduceé˜¶æ®µæœ‰ä»€ä¹ˆäº‹æƒ…å‘ç”Ÿå‘¢ï¼Ÿè°¢è°¢ï½","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537445,"discussion_content":"è€å¼Ÿè¯´çš„æ˜¯å¯¹çš„~ Reduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯Shuffle Readã€‚\n\nè¿™é‡Œçš„å†™æ³•æœ‰é—®é¢˜ï¼Œæˆ‘å›å¤´è®©ç¼–è¾‘å¸®å¿™æ”¹ä¸‹ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æœ€åçš„æ€»ç»“éƒ¨åˆ†ï¼Œæ”¹å¾—æ¯”è¾ƒä»“ä¿ƒï¼Œå‡ºtypoäº†ï¼Œæ„Ÿè°¢è€å¼Ÿæé†’~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639060873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313101,"user_name":"Neo-dqy","can_delete":false,"product_type":"c1","uid":1924786,"ip_address":"","ucode":"9BF300EB1DDD00","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5e/b2/aceb3e41.jpg","comment_is_top":false,"comment_ctime":1632280220,"is_pvip":false,"replies":[{"id":"113474","content":"å¥½é—®é¢˜ï½<br><br>1. è¿™é‡Œæ˜¯æŒ‰ç…§ï¼ˆç›®æ ‡åˆ†åŒºidï¼Œè¯é¢‘ï¼‰æ¥æ’åºçš„ã€‚ä¹Ÿå°±æ˜¯æŒ‰ç…§ä¸¤åˆ—æ’åºã€‚<br><br>2.ä¸‹ä¸€è®²å°±ä¼šæåˆ°ï¼ŒgroupByKeyã€reduceByKeyã€aggregateByKeyã€combineByKeyã€sortByKeyï¼Œéƒ½ä¼šå¼•å…¥Shuffleã€‚<br><br>3. å¯ä»¥å…³æ³¨åé¢è¦è®²çš„broadcast joinï½ ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632358917,"ip_address":"","comment_id":313101,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10222214812","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œå­¦å®Œè¿™èŠ‚è¯¾æˆ‘ä¸»è¦æœ‰ä¸‰ä¸ªé—®é¢˜ï¼š<br>1. Shuffle Write è¿‡ç¨‹ä¸­ï¼Œå¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜æ•°æ®ç»“æ„ä¸­å‰©ä½™çš„æ•°æ®è®°å½•åšå½’å¹¶æ’åºï¼Œè¿™é‡Œæ˜¯æŒ‰ç…§ç›®æ ‡åˆ†åŒºçš„IDè¿›è¡Œæ’åºï¼Œè¿˜æ˜¯æŒ‰ç…§valueï¼ˆè¯é¢‘ï¼‰è¿›è¡Œæ’åºçš„å•Šï¼Ÿ<br>2. é™¤äº†reduceç±»å‹çš„ç®—å­ä¼šè§¦å‘shuffleæ“ä½œï¼Œè¿˜æœ‰ä»€ä¹ˆåˆ«çš„ç®—å­èƒ½è§¦å‘å‘¢ï¼Ÿ<br>3. æ—¢ç„¶shuffleæ“ä½œæ˜¯ä¸å¯é¿å…çš„ï¼Œé‚£æˆ‘ä»¬åˆè¦æ€ä¹ˆä¼˜åŒ–è¿™ä¸ªæ“ä½œå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527230,"discussion_content":"å¥½é—®é¢˜ï½\n\n1. è¿™é‡Œæ˜¯æŒ‰ç…§ï¼ˆç›®æ ‡åˆ†åŒºidï¼Œè¯é¢‘ï¼‰æ¥æ’åºçš„ã€‚ä¹Ÿå°±æ˜¯æŒ‰ç…§ä¸¤åˆ—æ’åºã€‚\n\n2.ä¸‹ä¸€è®²å°±ä¼šæåˆ°ï¼ŒgroupByKeyã€reduceByKeyã€aggregateByKeyã€combineByKeyã€sortByKeyï¼Œéƒ½ä¼šå¼•å…¥Shuffleã€‚\n\n3. å¯ä»¥å…³æ³¨åé¢è¦è®²çš„broadcast joinï½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632358917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2108294,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2b/86/318e6ff3.jpg","nickname":"äº•å…ˆç”Ÿ","note":"","ucode":"87FD735FA7BFC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":397600,"discussion_content":"1. è¿™é‡Œæ˜¯æŒ‰ç…§ï¼ˆç›®æ ‡åˆ†åŒºidï¼Œè¯é¢‘ï¼‰æ¥æ’åºçš„ã€‚ä¹Ÿå°±æ˜¯æŒ‰ç…§ä¸¤åˆ—æ’åºã€‚\n=ã€‹æˆ‘æ€ä¹ˆç†è§£æ˜¯æŒ‰ç…§ï¼ˆç›®æ ‡åˆ†åŒºidï¼Œkeyï¼‰æ¥æ’åºçš„?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632650166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2108294,"avatar":"https://static001.geekbang.org/account/avatar/00/20/2b/86/318e6ff3.jpg","nickname":"äº•å…ˆç”Ÿ","note":"","ucode":"87FD735FA7BFC3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399148,"discussion_content":"å‰é¢æœ‰ä¸ªkväº¤æ¢ï¼Œäº¤æ¢ä¹‹åï¼Œè¯é¢‘å°±æ˜¯key","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632911412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":397600,"ip_address":""},"score":399148,"extra":""}]}]},{"had_liked":false,"id":344662,"user_name":"æ˜Ÿæ½¼","can_delete":false,"product_type":"c1","uid":1008546,"ip_address":"","ucode":"D7C30CD2BEC78D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/a2/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1651715506,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5946682802","product_id":100090001,"comment_content":"æ„Ÿè°¢è€å¸ˆçš„ç²¾å½©è®²è§£ï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™è€å¸ˆ^_^ã€‚<br>å¬äº†è€å¸ˆçš„è®²è§£ï¼Œæˆ‘å‘ç°Sparkä¹Ÿæ˜¯å°†Shuffleè¿‡ç¨‹çš„ä¸­é—´ç»“æœä¿å­˜åœ¨ç£ç›˜ï¼Œæ„Ÿè§‰è¿™ä¸ªæµç¨‹è·ŸMapReduceçš„Shuffleè¿‡ç¨‹å¾ˆç±»ä¼¼ã€‚<br>MapReduceæ€§èƒ½å·®çš„ä¸€ä¸ªåŸå› å°±æ˜¯Map Taskå°†ä¸­é—´ç»“æœæ•°æ®å†™åœ¨ç£ç›˜ï¼Œä¹‹å‰å¬è¯´Sparkæ€§èƒ½å¥½çš„åŸå› æ˜¯ç”±äºå†…å­˜è®¡ç®—ï¼Œå¯æ—¢ç„¶Sparkçš„shuffleè¿‡ç¨‹ä¹Ÿæ˜¯å°†ä¸­é—´ç»“æœå†™åˆ°ç£ç›˜ï¼Œé‚£ä¸ºä»€ä¹ˆsparkçš„æ€§èƒ½å°±ä¼šæ¯”MRé«˜å‡ºå¾ˆå¤šå‘¢ï¼Ÿè¯·è€å¸ˆæŒ‡æ•™ï¼Œæ„Ÿè°¢ã€‚","like_count":1,"discussions":[{"author":{"id":1526892,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4c/6c/11fb0f1d.jpg","nickname":"å¸ƒå…°ç‰¹","note":"","ucode":"EE3316C188EC3C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574144,"discussion_content":"sparkåœ¨ä¸­é—´ç»“æœæº¢å†™ç£ç›˜ä¹‹å‰ï¼Œä¼šå°½å¯é‡çš„åˆ©ç”¨å†…å­˜ï¼Œç›´åˆ°TaskManageræ²¡æœ‰å¯åˆ†é…çš„å†…å­˜ï¼Œæ‰ä¼šå°†ä¸­é—´ç»“æœæº¢å†™ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1653870745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332512,"user_name":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","can_delete":false,"product_type":"c1","uid":2861352,"ip_address":"","ucode":"0CCF598B029075","user_header":"","comment_is_top":false,"comment_ctime":1643284122,"is_pvip":false,"replies":[{"id":"121496","content":"ä¹‹å‰æœ‰hash shuffle managerå’ŒTungsten shuffle managerï¼Œä¸è¿‡ç°åœ¨éƒ½ç»Ÿä¸€åˆ°sort shuffle manageré‡Œé¢äº†ã€‚hashå¾ˆæ—©å°±deprecateæ‰äº†ï¼Œå¯¹äºæ–‡ä»¶çš„æ¶ˆè€—å¤ªå¤§äº†ï¼›Tungsten shuffle managerï¼ŒåŸºæœ¬è¿è¡Œæœºåˆ¶ä¸sort shuffle managerä¸€è‡´ï¼Œä¸»è¦æ˜¯åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå°½å¯èƒ½åœ°åˆ©ç”¨äº†Tungstençš„æ•°æ®ç»“æ„å’Œå†…å­˜å¯»å€æ–¹å¼ã€‚åœ¨è®¡ç®—æµç¨‹ä¸Šï¼ŒTungsten based shuffleå’Œsort based shuffleæ˜¯ä¸€æ ·çš„~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1643355605,"ip_address":"","comment_id":332512,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5938251418","product_id":100090001,"comment_content":"Shuffleç®—æ³•æ„Ÿè§‰éœ€è¦è¡¥ä¸€è¡¥ï¼Œçœ‹è¯„è®ºæœ‰hashå¾—ï¼Œè¿˜æœ‰sort-baseçš„ï¼Œè¿˜æœ‰å…¶ä»–çš„å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548748,"discussion_content":"ä¹‹å‰æœ‰hash shuffle managerå’ŒTungsten shuffle managerï¼Œä¸è¿‡ç°åœ¨éƒ½ç»Ÿä¸€åˆ°sort shuffle manageré‡Œé¢äº†ã€‚hashå¾ˆæ—©å°±deprecateæ‰äº†ï¼Œå¯¹äºæ–‡ä»¶çš„æ¶ˆè€—å¤ªå¤§äº†ï¼›Tungsten shuffle managerï¼ŒåŸºæœ¬è¿è¡Œæœºåˆ¶ä¸sort shuffle managerä¸€è‡´ï¼Œä¸»è¦æ˜¯åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå°½å¯èƒ½åœ°åˆ©ç”¨äº†Tungstençš„æ•°æ®ç»“æ„å’Œå†…å­˜å¯»å€æ–¹å¼ã€‚åœ¨è®¡ç®—æµç¨‹ä¸Šï¼ŒTungsten based shuffleå’Œsort based shuffleæ˜¯ä¸€æ ·çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643355605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330871,"user_name":"A","can_delete":false,"product_type":"c1","uid":2709345,"ip_address":"","ucode":"3A60C9F3985A38","user_header":"https://static001.geekbang.org/account/avatar/00/29/57/61/369a609c.jpg","comment_is_top":false,"comment_ctime":1642237618,"is_pvip":false,"replies":[{"id":"121199","content":"Quote<br>â€œè¿è¡Œstage0çš„executoräº§ç”Ÿçš„æ•°æ®ç§°ä½œå»ºæï¼Œç»“æŸådriverç»§ç»­æäº¤stage1ï¼Œè¿è¡Œstage1çš„executorå…¨é›†ç¾¤å¾—å»æ‹‰å»å„è‡ªæ‰€éœ€çš„å»ºæï¼Œå¯ä»¥è¿™æ ·ç†è§£å˜›è€å¸ˆï¼Ÿâ€<br>æ˜¯çš„ï¼Œç†è§£æ˜¯å¯¹çš„~ å®Œå…¨æ­£ç¡®<br><br>å¯¹äºæ¯ä¸ªmap taskæ¥è¯´ï¼Œdataã€indexéƒ½å­˜å‚¨åœ¨æœ¬æœºç£ç›˜ï¼Œå…·ä½“ç›®å½•ç”±spark.local.diré…ç½®é¡¹æ¥ç¡®å®šã€‚å“ªäº›æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨å“ªé‡Œï¼Œå°ºå¯¸å¤§å°ï¼Œè¿™äº›meta dataï¼Œéƒ½ä¼šç”±å­˜å‚¨ç³»ç»Ÿå½“ä¸­çš„BlockManageræ¥è®°å½•ï¼Œæ¯ä¸ªExecutorséƒ½æœ‰è‡ªå·±çš„BlockManagerã€‚å„ä¸ªExecutorsçš„BlockManagerä¼šå‘Driverçš„BlockManagerMasterå®šæœŸæ±‡æŠ¥è¿™äº›meta dataã€‚reduce taskåœ¨å°è¯•æ‹‰å–dataã€indexæ–‡ä»¶æ—¶ï¼Œéœ€è¦é€šè¿‡Executorsçš„BlockManagerå»æ‹¿åˆ°è¿™äº›å…ƒä¿¡æ¯ï¼Œç„¶åå®Œæˆæ•°æ®æ‹‰å–ã€‚å¦‚æœExecutorsçš„BlockManageræ²¡æœ‰è¿™äº›å…ƒä¿¡æ¯ï¼ŒBlockManagerå›å»æ‰¾Driverç«¯çš„BlockManagerMasterï¼Œä»è€Œæ‹¿åˆ°å…¨å±€å…ƒä¿¡æ¯~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1642778533,"ip_address":"","comment_id":330871,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5937204914","product_id":100090001,"comment_content":"å› rddå¾—ä¾èµ–å±æ€§shuffleåˆ’åˆ†äº†ä¸¤ä¸ªstage0å’Œ1<br>è¿è¡Œstage0çš„executoräº§ç”Ÿçš„æ•°æ®ç§°ä½œå»ºæï¼Œç»“æŸådriverç»§ç»­æäº¤stage1ï¼Œè¿è¡Œstage1çš„executorå…¨é›†ç¾¤å¾—å»æ‹‰å»å„è‡ªæ‰€éœ€çš„å»ºæï¼Œå¯ä»¥è¿™æ ·ç†è§£å˜›è€å¸ˆï¼Ÿ<br>é‚£stage0äº§ç”Ÿçš„ä¸´æ—¶dataã€indexæ˜¯è®°å½•åœ¨å“ªé‡Œï¼Ÿå¦‚ä½•è¿”å›ç»™driverçš„å‘¢ï¼Ÿä»¥åŠstage1æäº¤æ—¶æ˜¯å¦‚ä½•è·å–çš„å‘¢ï¼Ÿ<br>ç›®å‰æƒ³åˆ°çš„æ˜¯é‡æ–°å°è£…ä½†æ˜¯åˆè¯´ä¸è¿‡å»<br>è¿˜æœ›è€å¸ˆç»™æ¡è·¯ï¼Œè‡ªå·±å†å»ç ”ç©¶ä¸€ä¸‹ï¼<br>æ„Ÿè°¢è€å¸ˆï¼","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547640,"discussion_content":"Quote\nâ€œè¿è¡Œstage0çš„executoräº§ç”Ÿçš„æ•°æ®ç§°ä½œå»ºæï¼Œç»“æŸådriverç»§ç»­æäº¤stage1ï¼Œè¿è¡Œstage1çš„executorå…¨é›†ç¾¤å¾—å»æ‹‰å»å„è‡ªæ‰€éœ€çš„å»ºæï¼Œå¯ä»¥è¿™æ ·ç†è§£å˜›è€å¸ˆï¼Ÿâ€\næ˜¯çš„ï¼Œç†è§£æ˜¯å¯¹çš„~ å®Œå…¨æ­£ç¡®\n\nå¯¹äºæ¯ä¸ªmap taskæ¥è¯´ï¼Œdataã€indexéƒ½å­˜å‚¨åœ¨æœ¬æœºç£ç›˜ï¼Œå…·ä½“ç›®å½•ç”±spark.local.diré…ç½®é¡¹æ¥ç¡®å®šã€‚å“ªäº›æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨å“ªé‡Œï¼Œå°ºå¯¸å¤§å°ï¼Œè¿™äº›meta dataï¼Œéƒ½ä¼šç”±å­˜å‚¨ç³»ç»Ÿå½“ä¸­çš„BlockManageræ¥è®°å½•ï¼Œæ¯ä¸ªExecutorséƒ½æœ‰è‡ªå·±çš„BlockManagerã€‚å„ä¸ªExecutorsçš„BlockManagerä¼šå‘Driverçš„BlockManagerMasterå®šæœŸæ±‡æŠ¥è¿™äº›meta dataã€‚reduce taskåœ¨å°è¯•æ‹‰å–dataã€indexæ–‡ä»¶æ—¶ï¼Œéœ€è¦é€šè¿‡Executorsçš„BlockManagerå»æ‹¿åˆ°è¿™äº›å…ƒä¿¡æ¯ï¼Œç„¶åå®Œæˆæ•°æ®æ‹‰å–ã€‚å¦‚æœExecutorsçš„BlockManageræ²¡æœ‰è¿™äº›å…ƒä¿¡æ¯ï¼ŒBlockManagerå›å»æ‰¾Driverç«¯çš„BlockManagerMasterï¼Œä»è€Œæ‹¿åˆ°å…¨å±€å…ƒä¿¡æ¯~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642778534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2709345,"avatar":"https://static001.geekbang.org/account/avatar/00/29/57/61/369a609c.jpg","nickname":"A","note":"","ucode":"3A60C9F3985A38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":547642,"discussion_content":"è€å¸ˆï¼Œä¹Ÿå°±æ˜¯è¯´driverç«¯æŠŠrddå„ç§è½¬åŒ–æµç¨‹è½¬æ¢ä¸ºä»»åŠ¡åˆ†å‘ç»™executorä»¥åï¼Œexecutorå¼€å§‹æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™è¿˜æ˜¯æœ‰å¯èƒ½ä¼šå»ä¸»åŠ¨å‘driverç«¯ç´¢è¦è‡ªå·±æ‰€éœ€çš„æ•°æ®ï¼ˆexecutorçš„blockmanageræ²¡æœ‰çš„è¯ï¼‰\né‚£æˆ‘æ˜ç™½äº†è€å¸ˆï¼Œçœ‹æ¥æˆ‘é™·å…¥äº†æ€ç»´è¯¯åŒºï¼Œæ„Ÿè°¢è€å¸ˆçš„è§£ç­”ï¼Œæˆ‘å»æºç é‡Œæ‰¾æ‰¾è¿™äº›ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642778852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":547640,"ip_address":""},"score":547642,"extra":""}]}]},{"had_liked":false,"id":323786,"user_name":"å®æ•°","can_delete":false,"product_type":"c1","uid":2637725,"ip_address":"","ucode":"697BEAFCE929D2","user_header":"https://static001.geekbang.org/account/avatar/00/28/3f/9d/c59c12ad.jpg","comment_is_top":false,"comment_ctime":1638162863,"is_pvip":false,"replies":[{"id":"117606","content":"Hash-based shuffleå·²ç»deprecateäº†å“ˆï¼Œç°åœ¨é»˜è®¤çš„éƒ½æ˜¯Sort-based shuffleã€‚Shuffleçš„ç›®çš„ä¸æ˜¯æ’åºï¼Œå•çº¯çš„Shuffleï¼Œåšä¸åˆ°å…¨å±€æœ‰åºã€‚Sort-basedåªæ˜¯shuffleçš„ä¸€ç§å®ç°æ–¹å¼~<br><br>Sort-basedå®ç°æ–¹å¼è‡³å°‘æœ‰ä¸¤ä¸ªæ”¶ç›Šï¼š<br>1ï¼‰ä¸ºåç»­å¯èƒ½çš„Sort Merge Joinå¥ å®šåŸºç¡€<br>2ï¼‰ä¸ºåç»­å¯èƒ½çš„å…¨å±€æ’åºï¼Œå¥ å®šåŸºç¡€","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1638284833,"ip_address":"","comment_id":323786,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5933130159","product_id":100090001,"comment_content":"è¿™ä¸ªè®²çš„æ˜¯hashshuffleæ˜¯å—ï¼Œé‚£ä¹ˆç¬¬äºŒä»£çš„sortshuffleç›¸æ¯”è¾ƒå¦‚ä½•å‘¢ã€‚æ˜¯ä¸æ˜¯ä¸¤ä»£çš„shuffleéƒ½ä¸èƒ½ä¿è¯å…¨å±€æœ‰åºå•Š","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534844,"discussion_content":"Hash-based shuffleå·²ç»deprecateäº†å“ˆï¼Œç°åœ¨é»˜è®¤çš„éƒ½æ˜¯Sort-based shuffleã€‚Shuffleçš„ç›®çš„ä¸æ˜¯æ’åºï¼Œå•çº¯çš„Shuffleï¼Œåšä¸åˆ°å…¨å±€æœ‰åºã€‚Sort-basedåªæ˜¯shuffleçš„ä¸€ç§å®ç°æ–¹å¼~\n\nSort-basedå®ç°æ–¹å¼è‡³å°‘æœ‰ä¸¤ä¸ªæ”¶ç›Šï¼š\n1ï¼‰ä¸ºåç»­å¯èƒ½çš„Sort Merge Joinå¥ å®šåŸºç¡€\n2ï¼‰ä¸ºåç»­å¯èƒ½çš„å…¨å±€æ’åºï¼Œå¥ å®šåŸºç¡€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638284833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321018,"user_name":"å•Šç§‹ç§‹ç§‹ç§‹","can_delete":false,"product_type":"c1","uid":2479108,"ip_address":"","ucode":"695F4B9B4AFE8F","user_header":"https://static001.geekbang.org/account/avatar/00/25/d4/04/49dfb810.jpg","comment_is_top":false,"comment_ctime":1636621494,"is_pvip":false,"replies":[{"id":"116595","content":"è€å¼Ÿä¸å¦¨æ¢ç§æ€è·¯ã€æˆ–æ˜¯æ¢ä¸ªè§†è§’ï¼Œæ¥çœ‹å¾…Shuffleçš„è¿‡ç¨‹ã€‚Shuffleå­—é¢æ„æ€ï¼Œæ˜¯æ•°æ®åˆ†å‘ï¼Œä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œæ˜¯Mapé˜¶æ®µå’ŒReduceé˜¶æ®µçš„æ•°æ®äº¤æ¢ã€‚<br><br>æˆ‘ä»¬å…¶å®è¯´è¿‡ï¼Œä¸Šä¸€ä¸ªShuffleçš„Reduceé˜¶æ®µï¼Œå…¶å®æ˜¯ä¸‹ä¸€ä¸ªShuffleçš„Mapé˜¶æ®µã€‚Reduceé˜¶æ®µåœ¨Shuffleè¾¹ç•Œå»æ‹‰å–Mapé˜¶æ®µçš„è¾“å‡ºæ•°æ®ï¼Œæœ¬è´¨ä¸Šï¼Œå’Œæ•´ä¸ªSparkä½œä¸šä»æºå¤´è¯»å–æ•°æ®æºï¼Œå¹¶æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚<br><br>Sparkä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¯»æ•°æ®ï¼Œä¹Ÿä¼šæœ‰ç½‘ç»œå¼€é”€ï¼›è¿™ä¸ªå’ŒReduceé˜¶æ®µå»è¯»Mapé˜¶æ®µè¾“å‡ºçš„ä¸­é—´æ–‡ä»¶ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿‡ç¨‹ã€‚å› æ­¤ï¼Œä¸å…¶è¯´æ˜¯pullæ¨¡å¼ï¼Œå€’ä¸å¦‚è¯´å°±æ˜¯æ•°æ®æºçš„è·¨ç½‘ç»œè®¿é—®ï¼ˆè¯»å–ï¼‰è€Œå·²ã€‚<br><br>æ‰€ä»¥è¯´ï¼ŒShuffleçš„è¿‡ç¨‹ä¸­ï¼Œåªæœ‰æ‰€è°“çš„â€œPullâ€æ¨¡å¼ï¼ˆæ•°æ®çš„è·¨èŠ‚ç‚¹è®¿é—®ï¼‰ï¼Œæ²¡æœ‰å¸¸è§„æ„ä¹‰çš„Pushæ¨¡å¼ï¼Œå› ä¸ºPushæ¨¡å¼ä¸æˆç«‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1636645924,"ip_address":"","comment_id":321018,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5931588790","product_id":100090001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼è¯·é—®ä¸ºä»€ä¹ˆæ˜¯reducerä»mapperé‚£é‡Œæ‹‰å–æ•°æ®ï¼Œè€Œä¸æ˜¯mapperæŠŠæ•°æ®pushåˆ°reducerç«¯å‘¢ï¼Ÿæˆ‘è‡ªå·±çš„ç†è§£æ˜¯ï¼Œå¦‚æœæ˜¯mapper pushçš„è¯ï¼Œä¼ é€’æ•°æ®è¿™éƒ¨åˆ†å·¥ä½œä¸»è¦åœ¨mapperç«¯ï¼Œæ¯”å¦‚éœ€è¦å­˜å‚¨å„ä¸ªreducerçš„åœ°å€ï¼Œä¼šç»™mapperå¢åŠ workloadï¼Ÿä½†æ˜¯æ„Ÿè§‰ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ï¼Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆMR Sparkè¿™ç§åˆ†å¸ƒå¼è®¡ç®—æ¨¡å‹é‡Œéƒ½æ˜¯é‡‡ç”¨reducer pullï¼Œè¯·æŒ‡ç‚¹ä¸€ä¸‹ï¼è°¢è°¢ï¼ï¼","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530187,"discussion_content":"è€å¼Ÿä¸å¦¨æ¢ç§æ€è·¯ã€æˆ–æ˜¯æ¢ä¸ªè§†è§’ï¼Œæ¥çœ‹å¾…Shuffleçš„è¿‡ç¨‹ã€‚Shuffleå­—é¢æ„æ€ï¼Œæ˜¯æ•°æ®åˆ†å‘ï¼Œä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œæ˜¯Mapé˜¶æ®µå’ŒReduceé˜¶æ®µçš„æ•°æ®äº¤æ¢ã€‚\n\næˆ‘ä»¬å…¶å®è¯´è¿‡ï¼Œä¸Šä¸€ä¸ªShuffleçš„Reduceé˜¶æ®µï¼Œå…¶å®æ˜¯ä¸‹ä¸€ä¸ªShuffleçš„Mapé˜¶æ®µã€‚Reduceé˜¶æ®µåœ¨Shuffleè¾¹ç•Œå»æ‹‰å–Mapé˜¶æ®µçš„è¾“å‡ºæ•°æ®ï¼Œæœ¬è´¨ä¸Šï¼Œå’Œæ•´ä¸ªSparkä½œä¸šä»æºå¤´è¯»å–æ•°æ®æºï¼Œå¹¶æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚\n\nSparkä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¯»æ•°æ®ï¼Œä¹Ÿä¼šæœ‰ç½‘ç»œå¼€é”€ï¼›è¿™ä¸ªå’ŒReduceé˜¶æ®µå»è¯»Mapé˜¶æ®µè¾“å‡ºçš„ä¸­é—´æ–‡ä»¶ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿‡ç¨‹ã€‚å› æ­¤ï¼Œä¸å…¶è¯´æ˜¯pullæ¨¡å¼ï¼Œå€’ä¸å¦‚è¯´å°±æ˜¯æ•°æ®æºçš„è·¨ç½‘ç»œè®¿é—®ï¼ˆè¯»å–ï¼‰è€Œå·²ã€‚\n\næ‰€ä»¥è¯´ï¼ŒShuffleçš„è¿‡ç¨‹ä¸­ï¼Œåªæœ‰æ‰€è°“çš„â€œPullâ€æ¨¡å¼ï¼ˆæ•°æ®çš„è·¨èŠ‚ç‚¹è®¿é—®ï¼‰ï¼Œæ²¡æœ‰å¸¸è§„æ„ä¹‰çš„Pushæ¨¡å¼ï¼Œå› ä¸ºPushæ¨¡å¼ä¸æˆç«‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636645924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313124,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1632287672,"is_pvip":true,"replies":[{"id":"113473","content":"å¥½é—®é¢˜ï½<br><br>å…ˆè¯´ç¬¬äºŒä¸ªï¼Œä½ è¯´çš„å¯¹ï¼Œä½ çš„è¯´æ³•æ›´åŠ å‡†ç¡®ï¼Œç¡®å®ä¸æ˜¯äº¤æ¢ï¼Œè€Œæ˜¯ä¼ é€’&#47;æµè½¬ã€‚ä»ç”Ÿäº§æ¶ˆè´¹çš„è§’åº¦æ¥çœ‹ï¼Œmapé˜¶æ®µæ˜¯ç”Ÿäº§è€…ï¼Œreduceé˜¶æ®µæ˜¯æ¶ˆè´¹è€…ã€‚<br><br>å†è¯´ç¬¬ä¸€ä¸ªï¼Œå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å½“å‰ç´¢å¼•å’Œä¸‹ä¸€ä¸ªç´¢å¼•ä¹‹é—´çš„èŒƒå›´ã€‚reduce taskä»è‡ªå·±çš„èµ·å§‹ç´¢å¼•ï¼Œè¯»åˆ°ä¸‹ä¸€ä¸ªtaskçš„èµ·å§‹ç´¢å¼•ï¼Œå°±ç¡®å®šäº†è‡ªå·±çš„æ•°æ®èŒƒå›´ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632358487,"ip_address":"","comment_id":313124,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5927254968","product_id":100090001,"comment_content":"ä¸­é—´å­˜å‚¨æ–‡ä»¶ï¼Œæˆ‘ç†è§£å®ƒæ˜¯ä¸€ä¸ªä¸ç”¨æ°¸ä¹…å­˜å‚¨çš„ä¸´æ—¶æ–‡ä»¶ï¼Œç†è®ºä¸Šæ”¾åˆ°ä»»ä½•ä½ç½®éƒ½å¯ä»¥ã€‚ä½†æ˜¯å¦‚æœåœ¨ç”Ÿæˆæ–‡ä»¶è¿™ä¸ªä¸´ç•Œç‚¹Executorå®•æœºï¼Œå­˜æ”¾åœ¨&#47;tmpç›®å½•ä¸‹çš„æ–‡ä»¶å°±ä¼šä¸¢å¤±ï¼Œå¦‚æœå­˜æ”¾åœ¨æ­£å¸¸çš„ç›®å½•ä¸‹å°±ä¼šé¿å…è¿™ç§é—®é¢˜ã€‚è¿˜æœ‰shuffle writeå¦‚æœæ˜¯é¡ºåºå†™ï¼Œé€‰SSDæˆ–è€…HDDç¡¬ç›˜ä¹Ÿæ²¡ä»€ä¹ˆåŒºåˆ«ã€‚<br><br>æœ‰ä¸¤ä¸ªé—®é¢˜æƒ³è¯·æ•™è€å¸ˆ<br><br>ç¬¬ä¸€ï¼Œæ‚¨è¯´Reduce Task é€šè¿‡ index æ–‡ä»¶æ¥â€œå®šä½â€å±äºè‡ªå·±çš„æ•°æ®å†…å®¹å’Œindex æ–‡ä»¶ï¼Œæ˜¯ç”¨æ¥æ ‡è®°ç›®æ ‡åˆ†åŒºæ‰€å±æ•°æ®è®°å½•çš„èµ·å§‹ç´¢å¼•ã€‚é‚£ä¹ˆReduce Taskå¦‚ä½•çŸ¥é“ä»èµ·å§‹ç´¢å¼•è¯»å–å¤šå°‘ä¸ªæ•°æ®ä¸ºæ­¢ï¼Œæ˜¯Reduce Taskå†…éƒ¨è¿˜æœ‰ç®—æ³•å—ï¼Ÿ<br><br>ç¬¬äºŒï¼Œæ‚¨è¯´Map é˜¶æ®µä¸ Reduce é˜¶æ®µï¼Œé€šè¿‡ç”Ÿäº§ä¸æ¶ˆè´¹ Shuffle ä¸­é—´æ–‡ä»¶çš„æ–¹å¼ï¼Œæ¥å®Œæˆé›†ç¾¤èŒƒå›´å†…çš„æ•°æ®äº¤æ¢ï¼Œæˆ‘å¯¹æ­¤å¤„çš„äº¤æ¢ä¸æ˜¯å¾ˆç†è§£ï¼Œäº¤æ¢ä¸åº”è¯¥æ˜¯ç›¸äº’çš„å—ï¼Œæˆ‘ç†è§£çš„äº¤æ¢æ˜¯åŒæ–¹æ‹¿å‡ºè‡ªå·±çš„äº¤ç»™å¯¹æ–¹ï¼Œæ¯”å¦‚æˆ‘åœ¨ç¯®å­é‡Œæ”¾ä¸€ä¸ªè‹¹æœï¼Œæ‚¨åœ¨ç¯®å­é‡Œæ”¾ä¸€ä¸ªæ¢¨ï¼Œæˆ‘æ‹¿åˆ°äº†æ¢¨è€Œæ‚¨æ‹¿åˆ°äº†è‹¹æœã€‚ä½†æ˜¯Mapå’ŒReduceä¸¤è€…ä¹‹é—´Reduceæ›´åƒæ˜¯ç™½æ‹¿ã€‚è¿™é‡Œçš„æ•°æ®äº¤æ¢èƒ½ä¸èƒ½ç†è§£æˆæ•°æ®ä¼ é€’æˆ–è€…æ•°æ®æµè½¬ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527240,"discussion_content":"å¥½é—®é¢˜ï½\n\nå…ˆè¯´ç¬¬äºŒä¸ªï¼Œä½ è¯´çš„å¯¹ï¼Œä½ çš„è¯´æ³•æ›´åŠ å‡†ç¡®ï¼Œç¡®å®ä¸æ˜¯äº¤æ¢ï¼Œè€Œæ˜¯ä¼ é€’/æµè½¬ã€‚ä»ç”Ÿäº§æ¶ˆè´¹çš„è§’åº¦æ¥çœ‹ï¼Œmapé˜¶æ®µæ˜¯ç”Ÿäº§è€…ï¼Œreduceé˜¶æ®µæ˜¯æ¶ˆè´¹è€…ã€‚\n\nå†è¯´ç¬¬ä¸€ä¸ªï¼Œå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å½“å‰ç´¢å¼•å’Œä¸‹ä¸€ä¸ªç´¢å¼•ä¹‹é—´çš„èŒƒå›´ã€‚reduce taskä»è‡ªå·±çš„èµ·å§‹ç´¢å¼•ï¼Œè¯»åˆ°ä¸‹ä¸€ä¸ªtaskçš„èµ·å§‹ç´¢å¼•ï¼Œå°±ç¡®å®šäº†è‡ªå·±çš„æ•°æ®èŒƒå›´ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632358487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2861352,"avatar":"","nickname":"é˜¿ç‹¸å¼Ÿå¼Ÿçš„åŒ…å­åº—","note":"","ucode":"0CCF598B029075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548631,"discussion_content":"æ€è€ƒçš„å¾ˆæ·±å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643283770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360388,"user_name":"å°æ","can_delete":false,"product_type":"c1","uid":1903790,"ip_address":"å››å·","ucode":"30BD251EE1B1E2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/iaQgtbE98VGIVIyribdo6dgLOnaNoe7ZdUuPr60ibsduibscrzQCTzdW2AfL9nxwe8YlSK75gOnK3YbAJKTaFPxibdg/132","comment_is_top":false,"comment_ctime":1666532655,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1666532655","product_id":100090001,"comment_content":"è€å¸ˆï¼Œåœ¨ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œshuffle writeé˜¶æ®µæ˜¯æ€ä¹ˆçŸ¥é“shuffle readé˜¶æ®µçš„åˆ†åŒºæ•°çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":354161,"user_name":"å”æ–¹åˆš","can_delete":false,"product_type":"c1","uid":3046392,"ip_address":"å¹¿ä¸œ","ucode":"93DA58C3DCCF1B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ugib9sF9icd9dhibQoAA025hibbD5zgZTiaddLoeEH457hrkBBhtQK6qknTWt270rHCtBZqeqsbibtHghgjdkPx3DyIw/132","comment_is_top":false,"comment_ctime":1660135199,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660135199","product_id":100090001,"comment_content":"æ€ä¹ˆæ„Ÿè§‰å’Œhadoop mrçš„è¿‡ç¨‹ä¸€æ ·çš„","like_count":0},{"had_liked":false,"id":345864,"user_name":"Geek_b2839b","can_delete":false,"product_type":"c1","uid":2876299,"ip_address":"","ucode":"6D8ABA989AB724","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIw0Nnvrrt9fV1wHVfBlPzrZmxNCRTbWPfNEbCEMtuoj6gw0LlMbbS3gtRLgLMfCoAV3TXsk5giavw/132","comment_is_top":false,"comment_ctime":1652662561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652662561","product_id":100090001,"comment_content":"4. å¯¹æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜æ•°æ®ç»“æ„ä¸­å‰©ä½™çš„æ•°æ®è®°å½•åšå½’å¹¶æ’åºï¼Œç”Ÿæˆæ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶ã€‚<br>-----------------------<br>è€å¸ˆï¼Œå¦‚æœä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜æ•°æ®æ–‡ä»¶éå¸¸å¤§ï¼Œæ— æ³•å•èŠ‚ç‚¹åŠ è½½è¿›å…¥å†…å­˜é‡Œï¼Œé‚£æ€ä¹ˆå»å½’å¹¶æ’åºå‘¢","like_count":0},{"had_liked":false,"id":336641,"user_name":"Tianchen","can_delete":false,"product_type":"c1","uid":2880924,"ip_address":"","ucode":"44FDD3D5510149","user_header":"https://static001.geekbang.org/account/avatar/00/2b/f5/9c/4bdff9f2.jpg","comment_is_top":false,"comment_ctime":1646271606,"is_pvip":false,"replies":[{"id":"123248","content":"Partition ID~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1646725113,"ip_address":"","comment_id":336641,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646271606","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³é—®ä¸‹å…¬å¼1çš„å“ˆå¸Œå€¼Pï¼Œåœ¨åç»­æµç¨‹ä¸­æ˜¯å¯¹åº”çš„Map ç»“æ„ä¸­Reduce Task Partition IDï¼ˆP0,P1 ,P2ï¼‰è¿˜æ˜¯indexï¼ˆ0,3,7ï¼‰","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555035,"discussion_content":"Partition ID~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646725114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334597,"user_name":"å°è¥¿é—¨","can_delete":false,"product_type":"c1","uid":1366326,"ip_address":"","ucode":"96EB1026635BD5","user_header":"https://static001.geekbang.org/account/avatar/00/14/d9/36/05eda19f.jpg","comment_is_top":false,"comment_ctime":1645012634,"is_pvip":false,"replies":[{"id":"122823","content":"å¹¶ä¸æ˜¯å“ˆ~ è€å¼Ÿè¿˜æ˜¯éœ€è¦å†æ¶ˆåŒ–ä¸‹Shuffleçš„æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ï¼Œæ‰€æœ‰reduce taskéƒ½éœ€è¦å»æ‰€æœ‰æœºå™¨ä¸Šå»æ‹‰å–shuffleä¸­é—´æ–‡ä»¶ï¼Œè¿™ä¸ªä¸ç”±Driveræ¥å†³å®šï¼›å†è€…ï¼Œreduceé˜¶æ®µpartitioneræ˜¯ç¡®å®šçš„ï¼Œä¸å­˜åœ¨task&#47;partition IDä¸ä¸€è‡´çš„æƒ…å†µ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645889516,"ip_address":"","comment_id":334597,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645012634","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘çš„é—®é¢˜æ˜¯ï¼š<br>å¦‚æœè®¡ç®—è®°å½•æ‰€å±é‚£ä¸ªReduce Taskçš„ç®—æ³•æ˜¯ä¸€è‡´çš„è¯ï¼Œä¼šä¸ä¼šå‡ºç°æŸäº›exectorsä¸­åªæœ‰å•ä¸ª(k,v)ï¼Œä½†æ˜¯é€šè¿‡ç®—æ³•è®¡ç®—å‡ºæ¥çš„reduce task partition IDæ˜¯å¦å¤–ä¸€ä¸ªexecutorï¼Ÿè¿™æ ·å°±äº§ç”Ÿäº†ä¸å¿…è¦çš„ç½‘ç»œIOã€‚<br><br>æˆ‘ä¸ªäººçŒœæƒ³æ˜¯ï¼Œä¼šä¸ä¼šè®¡ç®—reduce task partition IDæ˜¯åœ¨å„map taskåšå®Œä¹‹åï¼Œé€šçŸ¥åˆ°driverï¼Œdirverè·å¾—äº†å…¨å±€ä¿¡æ¯åï¼Œå†é€šçŸ¥åˆ°reduce taskä¸ç”¨å»shuffle readåªæœ‰å•ä¸ª(k,v)çš„executorçš„shuffleä¸­é—´æ–‡ä»¶ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553462,"discussion_content":"å¹¶ä¸æ˜¯å“ˆ~ è€å¼Ÿè¿˜æ˜¯éœ€è¦å†æ¶ˆåŒ–ä¸‹Shuffleçš„æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ï¼Œæ‰€æœ‰reduce taskéƒ½éœ€è¦å»æ‰€æœ‰æœºå™¨ä¸Šå»æ‹‰å–shuffleä¸­é—´æ–‡ä»¶ï¼Œè¿™ä¸ªä¸ç”±Driveræ¥å†³å®šï¼›å†è€…ï¼Œreduceé˜¶æ®µpartitioneræ˜¯ç¡®å®šçš„ï¼Œä¸å­˜åœ¨task/partition IDä¸ä¸€è‡´çš„æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645889516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333376,"user_name":"è‰¾åˆ©ç‰¹-G","can_delete":false,"product_type":"c1","uid":1195204,"ip_address":"","ucode":"8C4DA0ABE77CDC","user_header":"https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg","comment_is_top":false,"comment_ctime":1644314370,"is_pvip":false,"replies":[{"id":"122396","content":"ç¬¬ä¸€æ®µé‡Œè¯´çš„&quot;N&quot;å’Œç¬¬äºŒæ®µé‡Œè¯´çš„ä»»åŠ¡å¹¶è¡Œåº¦ï¼Œç¡®å®æ˜¯åŒä¸€ä¸ªäº‹ç‰©ï¼Œä½†ä»–ä»¬ä¸æ˜¯Executorsçš„Coreæ•°ã€‚ç®€å•ç†è§£ï¼Œå¹¶è¡Œåº¦å°±æ˜¯æ•°æ®åˆ†ç‰‡çš„æ•°é‡ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªæ•°æ®é›†ï¼Œæ€»å…±1TBï¼Œå‡è®¾æ¯ä¸ªæ•°æ®åˆ†ç‰‡200MBï¼Œé‚£ä¹ˆæ€»å…±æœ‰1TB&#47;200GBè¿™ä¹ˆå¤šä¸ªæ•°æ®åˆ†ç‰‡ï¼Œè¿™ä¸ªæ•°å­—æ˜¾ç„¶å’ŒExecutorsçš„Coreæ²¡æœ‰å¯¹åº”å…³ç³»çš„~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645369620,"ip_address":"","comment_id":333376,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644314370","product_id":100090001,"comment_content":"&gt; å‡è®¾ Reduce é˜¶æ®µæœ‰ N ä¸ª Taskï¼Œè¿™ N ä¸ª Task å¯¹åº”ç€ N ä¸ªæ•°æ®åˆ†åŒºï¼Œé‚£ä¹ˆåœ¨ Map é˜¶æ®µï¼Œæ¯æ¡è®°å½•åº”è¯¥åˆ†å‘åˆ°å“ªä¸ª Reduce Taskï¼Œæ˜¯ç”±ä¸‹é¢çš„å…¬å¼æ¥å†³å®šçš„ã€‚<br>&gt; ...<br>&gt; é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºæ¯ä¸€ä¸ª Map Task ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶ï¼Œå…¶ä¸­çš„ç›®æ ‡åˆ†åŒºæ•°é‡æ˜¯ç”± Reduce é˜¶æ®µçš„ä»»åŠ¡æ•°é‡ï¼ˆåˆå«å¹¶è¡Œåº¦ï¼‰å†³å®šçš„ã€‚<br><br>æ‰€ä»¥æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆç†è§£: ç¬¬ä¸€æ®µé‡Œè¯´çš„&quot;N&quot;å’Œç¬¬äºŒæ®µé‡Œè¯´çš„ä»»åŠ¡å¹¶è¡Œåº¦æ˜¯åŒä¸€ä¸ªäº‹ç‰©ï¼Œä¹Ÿå°±æ˜¯Executorçš„coreæ•°ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552255,"discussion_content":"ç¬¬ä¸€æ®µé‡Œè¯´çš„&#34;N&#34;å’Œç¬¬äºŒæ®µé‡Œè¯´çš„ä»»åŠ¡å¹¶è¡Œåº¦ï¼Œç¡®å®æ˜¯åŒä¸€ä¸ªäº‹ç‰©ï¼Œä½†ä»–ä»¬ä¸æ˜¯Executorsçš„Coreæ•°ã€‚ç®€å•ç†è§£ï¼Œå¹¶è¡Œåº¦å°±æ˜¯æ•°æ®åˆ†ç‰‡çš„æ•°é‡ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªæ•°æ®é›†ï¼Œæ€»å…±1TBï¼Œå‡è®¾æ¯ä¸ªæ•°æ®åˆ†ç‰‡200MBï¼Œé‚£ä¹ˆæ€»å…±æœ‰1TB/200GBè¿™ä¹ˆå¤šä¸ªæ•°æ®åˆ†ç‰‡ï¼Œè¿™ä¸ªæ•°å­—æ˜¾ç„¶å’ŒExecutorsçš„Coreæ²¡æœ‰å¯¹åº”å…³ç³»çš„~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645369620,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322907,"user_name":"Geek_a3a122","can_delete":false,"product_type":"c1","uid":2850979,"ip_address":"","ucode":"E8447CC8267B1D","user_header":"","comment_is_top":false,"comment_ctime":1637654462,"is_pvip":false,"replies":[{"id":"117416","content":"è€å¼Ÿè¯´çš„æ˜¯å¯¹çš„~ Reduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯Shuffle Readã€‚<br><br>è¿™é‡Œçš„å†™æ³•æœ‰é—®é¢˜ï¼Œæˆ‘å›å¤´è®©ç¼–è¾‘å¸®å¿™æ”¹ä¸‹ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æœ€åçš„æ€»ç»“éƒ¨åˆ†ï¼Œæ”¹å¾—æ¯”è¾ƒä»“ä¿ƒï¼Œå‡ºtypoäº†ï¼Œæ„Ÿè°¢è€å¼Ÿæé†’~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1637987322,"ip_address":"","comment_id":322907,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1637654462","product_id":100090001,"comment_content":"`Reduce é˜¶æ®µä¸åŒäº Reduce Task æ‹‰å–æ•°æ®çš„è¿‡ç¨‹ï¼Œå¾€å¾€ä¹Ÿè¢«å«åš Shuffle Readã€‚`<br>è¿™å¥è¯æ²¡å¤ªç†è§£ï¼ŒReduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹ä¸å°±æ˜¯Shuffle Readå—ï¼Œä¸ºä»€ä¹ˆå«Reduceé˜¶æ®µä¸åŒäºReduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533829,"discussion_content":"è€å¼Ÿè¯´çš„æ˜¯å¯¹çš„~ Reduce Taskæ‹‰å–æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯Shuffle Readã€‚\n\nè¿™é‡Œçš„å†™æ³•æœ‰é—®é¢˜ï¼Œæˆ‘å›å¤´è®©ç¼–è¾‘å¸®å¿™æ”¹ä¸‹ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æœ€åçš„æ€»ç»“éƒ¨åˆ†ï¼Œæ”¹å¾—æ¯”è¾ƒä»“ä¿ƒï¼Œå‡ºtypoäº†ï¼Œæ„Ÿè°¢è€å¼Ÿæé†’~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637987322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1537617,"avatar":"https://static001.geekbang.org/account/avatar/00/17/76/51/96291466.jpg","nickname":"çŒ«å¤ªå¤ª","note":"","ucode":"7A1D1CAA3AF260","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536103,"discussion_content":"åŒé—®äº† å‘ç°è€å¸ˆåœ¨å‰é¢çš„è¯„è®ºå·²ç»è§£ç­”äº† è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638689642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321087,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1636673264,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636673264","product_id":100090001,"comment_content":"æˆ‘åœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œå®‰è£…äº†spark2.3.3 æ‰‹åŠ¨è®¾ç½®äº† SPARK_LOCAL_DIRS ç›®å½•ã€‚å› ä¸ºæˆ‘è¿è¡Œç¨‹åºæ—¶æ²¡æŒ‡å®šclusteræ¨¡å¼ï¼Œé»˜è®¤æ˜¯master local ï¼Œç¨‹åºä¼šæŠŠæ‰€æœ‰æ•°æ®ï¼ˆ1Tæ•°æ®ï¼‰æ‹‰åˆ°æäº¤ä»»åŠ¡çš„æœºå™¨ï¼ŒæŠŠtmpå†™çˆ†äº†ï¼Œç¨‹åºå°±æ­»äº†ã€‚æäº¤ä»»åŠ¡æ—¶æ˜¾ç¤ºæŒ‡å®šäº† client æˆ– clusteræ¨¡å¼å°±è§£å†³äº†è¿™ä¸ªå†™çˆ†æœ¬åœ°ç£ç›˜é—®é¢˜ï¼ˆæ•°æ®éƒ½æ˜¯å„å„datanodeä¸Šè¿è¡Œäº†ï¼‰ã€‚å¹³æ—¶ç¨‹åºå¦‚æœä¸æŠ¥æ²¡æœ‰ç¡¬ç›˜ç©ºé—´ï¼Œæˆ‘æ ¹æœ¬ä¸å…³æ³¨spark.local.dirå‚æ•°ã€‚","like_count":0},{"had_liked":false,"id":314566,"user_name":"LJK","can_delete":false,"product_type":"c1","uid":1199213,"ip_address":"","ucode":"12B2441099FF1D","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","comment_is_top":false,"comment_ctime":1633230363,"is_pvip":false,"replies":[{"id":"114051","content":"å…ˆè¯´coalesce(shuffle=false)ï¼Œè¿™ä¸ªæ²¡æœ‰ç½‘ç»œI&#47;Oçš„ï¼Œcoalesceåªæ˜¯åœ¨åŒä¸€ä¸ªExecutorå†…éƒ¨ï¼ˆåŒä¸€ä¸ªJVMè¿›ç¨‹ï¼‰å¯¹å¤šä¸ªåˆ†åŒºåšåˆå¹¶ï¼Œæ‰€ä»¥è‚¯å®šæ²¡æœ‰ç½‘ç»œI&#47;Oçš„~<br><br>å†è¯´cartesianï¼Œæ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ˜¯ä¸¤ä¸ªRDDä¹‹é—´çš„æ“ä½œï¼Œä¸¤ä¸ªRDDå…ƒç´ ä¹‹é—´ï¼Œéœ€è¦åšç¬›å¡å°”ç§¯ã€‚å…·ä½“çš„å®ç°ä¸Šï¼ŒSparkä¿æŒä¸€ä¸ªRDDâ€œå¾…åœ¨åŸåœ°ã€ä¿æŒä¸åŠ¨â€ï¼Œè€Œå»å…¨é‡å¹¿æ’­å¦ä¸€ä¸ªRDDï¼Œè¿™æ ·å³å¯è½»æ¾å®Œæˆä¸¤ä¸ªRDDçš„ç¬›å¡å°”ç§¯ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªæ“ä½œé‡Œï¼Œå‰ä¸€ä¸ªRDDæ²¡æœ‰ç½‘ç»œI&#47;Oï¼Œä½†æ˜¯åé¢ä¸€ä¸ªä¼šæœ‰~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633610804,"ip_address":"","comment_id":314566,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633230363","product_id":100090001,"comment_content":"è€å¸ˆçš„è¯¾çœŸçš„æ˜¯å¾ˆå¥½ï¼Œéå¸¸æ„Ÿè°¢ï¼å¯¹äºShuffleæœ‰ä¸ªç–‘é—®ï¼Œä¹‹å‰çœ‹åˆ°è¿‡å¯¹äºå‡ ç§ç‰¹æ®Šæƒ…å†µçª„ä¾èµ–çš„æ“ä½œï¼Œè­¬å¦‚coalesce(shuffle=false)å’Œcartesianï¼Œè™½ç„¶child rddä¾èµ–å¤šä¸ªparent rddï¼Œä½†æ˜¯æ˜¯ä¸ä¼šç”Ÿæˆæ–°çš„stageçš„ï¼Œä¸æ˜ç™½è¿™å‡ ä¸ªæ“ä½œä¼šä¸ä¼šäº§ç”Ÿç½‘ç»œIOã€‚æ¯•ç«Ÿå¦‚æœä¸‹ä¸€ä¸ªtaskéœ€è¦åˆå¹¶å¤šä¸ªåˆ†åŒºçš„è¯ï¼Œå¦‚æœè¿™äº›åˆ†åŒºä¸åœ¨åŒä¸€ç‰©ç†èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡Œåˆå¹¶å‘¢ï¼Ÿè¿˜æ˜¯è¯´ç”±äºæ‡’åŠ è½½å…¶å®æ˜¯ä¸è¿›è¡Œåˆå¹¶çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527721,"discussion_content":"å…ˆè¯´coalesce(shuffle=false)ï¼Œè¿™ä¸ªæ²¡æœ‰ç½‘ç»œI/Oçš„ï¼Œcoalesceåªæ˜¯åœ¨åŒä¸€ä¸ªExecutorå†…éƒ¨ï¼ˆåŒä¸€ä¸ªJVMè¿›ç¨‹ï¼‰å¯¹å¤šä¸ªåˆ†åŒºåšåˆå¹¶ï¼Œæ‰€ä»¥è‚¯å®šæ²¡æœ‰ç½‘ç»œI/Oçš„~\n\nå†è¯´cartesianï¼Œæ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ˜¯ä¸¤ä¸ªRDDä¹‹é—´çš„æ“ä½œï¼Œä¸¤ä¸ªRDDå…ƒç´ ä¹‹é—´ï¼Œéœ€è¦åšç¬›å¡å°”ç§¯ã€‚å…·ä½“çš„å®ç°ä¸Šï¼ŒSparkä¿æŒä¸€ä¸ªRDDâ€œå¾…åœ¨åŸåœ°ã€ä¿æŒä¸åŠ¨â€ï¼Œè€Œå»å…¨é‡å¹¿æ’­å¦ä¸€ä¸ªRDDï¼Œè¿™æ ·å³å¯è½»æ¾å®Œæˆä¸¤ä¸ªRDDçš„ç¬›å¡å°”ç§¯ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªæ“ä½œé‡Œï¼Œå‰ä¸€ä¸ªRDDæ²¡æœ‰ç½‘ç»œI/Oï¼Œä½†æ˜¯åé¢ä¸€ä¸ªä¼šæœ‰~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633610804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313966,"user_name":"é’±é¹ Allen","can_delete":false,"product_type":"c1","uid":2518863,"ip_address":"","ucode":"7E95E82C0717DA","user_header":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","comment_is_top":false,"comment_ctime":1632760493,"is_pvip":true,"replies":[{"id":"113780","content":"è¿™å¥ä¸å¯¹å“ˆï¼šâ€œtransformå’Œactionä¹‹é—´æœ‰shuffleâ€<br><br>ä¸¤è€…ä¹‹é—´ä¸€å®šä¸å­˜åœ¨shuffleï¼Œshuffleéƒ½æ˜¯transformationç®—å­å¼•å…¥çš„ã€‚å…·ä½“å“ªäº›ç®—å­ä¼šå¼•å…¥shuffleï¼Œå¯ä»¥ç­‰çœ‹å®Œç®—å­ï¼ˆä¸‰ï¼‰ä¹‹ååšä¸ªç®€å•æ±‡æ€»ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632878204,"ip_address":"","comment_id":313966,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1632760493","product_id":100090001,"comment_content":"tmpç¼“å­˜æ–‡ä»¶å¯ä»¥ä¸´æ—¶ç”Ÿæˆ<br>shuflleé˜¶æ®µï¼šæº¢å‡ºä¸´æ—¶æ–‡ä»¶å’Œåˆå¹¶mergeä¸­é—´æ–‡ä»¶<br>transformå’Œactionç®—å­ä¹‹é—´éœ€è¦shuffleï¼Œä¹‹å‰è‡ªå·±åªäº†è§£å®½çª„ä¾èµ–ï¼Œç°åœ¨å¯¹shuffleçš„è¿è¡Œæœºåˆ¶æ›´æ·±ä¸€éƒ¨äº†è§£ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527530,"discussion_content":"è¿™å¥ä¸å¯¹å“ˆï¼šâ€œtransformå’Œactionä¹‹é—´æœ‰shuffleâ€\n\nä¸¤è€…ä¹‹é—´ä¸€å®šä¸å­˜åœ¨shuffleï¼Œshuffleéƒ½æ˜¯transformationç®—å­å¼•å…¥çš„ã€‚å…·ä½“å“ªäº›ç®—å­ä¼šå¼•å…¥shuffleï¼Œå¯ä»¥ç­‰çœ‹å®Œç®—å­ï¼ˆä¸‰ï¼‰ä¹‹ååšä¸ªç®€å•æ±‡æ€»ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632878204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2518863,"avatar":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","nickname":"é’±é¹ Allen","note":"","ucode":"7E95E82C0717DA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398978,"discussion_content":"è°¢è°¢ç£Šå“¥çš„æŒ‡ç‚¹ï¼Œæ‹¿å¥½å°æ¿å‡³ï¼Œç ”è¯»ç®—å­ï¼ˆä¸‰ï¼‰~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632882557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313826,"user_name":"ç¥ç»è›™","can_delete":false,"product_type":"c1","uid":2223109,"ip_address":"","ucode":"09DC65B6E2EDD8","user_header":"https://static001.geekbang.org/account/avatar/00/21/ec/05/ce889d6c.jpg","comment_is_top":false,"comment_ctime":1632702262,"is_pvip":false,"replies":[{"id":"113766","content":"ä»¥å‰ï¼ˆè®¡ç®—æ¨¡å¼ã€æ•ˆç‡ä¸Šï¼‰åŒºåˆ«æ¯”è¾ƒå¤§ï¼Œç°åœ¨å…¶å®å·®åˆ«ä¸å¤§äº†ã€‚å½“ç„¶ï¼Œå®ç°ä¸Šè¿˜æ˜¯æœ‰äº›ç»†å¾®çš„å·®åˆ«ã€‚ä½ è¯´çš„å¯¹ï¼Œå°±ä¸€è½®mapreduceçš„è¯ï¼Œä¸¤è€…æ•ˆç‡ä¸Šå·®ä¸å¤šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1632831566,"ip_address":"","comment_id":313826,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1632702262","product_id":100090001,"comment_content":"å¤§ä½¬ï¼Œçœ‹å®Œè§‰å¾—sparkçš„shuffleè·Ÿmapreduceçš„shuffleåƒæ˜¯ä¸€æ ·çš„ï¼Œä¸¤è€…æœ‰åŒºåˆ«å—ï¼Ÿä¸¤è€…ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<br>å¦å¤–ï¼Œå¦‚æœä¸€ä¸ªMR jobåªæœ‰ä¸€ä¸ªé˜¶æ®µçš„mapå’Œreduceè€Œæ²¡æœ‰çº§è”ï¼Œå¤„ç†æ•ˆç‡åº”è¯¥å’Œsparkå·®ä¸å¤šå§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527484,"discussion_content":"ä»¥å‰ï¼ˆè®¡ç®—æ¨¡å¼ã€æ•ˆç‡ä¸Šï¼‰åŒºåˆ«æ¯”è¾ƒå¤§ï¼Œç°åœ¨å…¶å®å·®åˆ«ä¸å¤§äº†ã€‚å½“ç„¶ï¼Œå®ç°ä¸Šè¿˜æ˜¯æœ‰äº›ç»†å¾®çš„å·®åˆ«ã€‚ä½ è¯´çš„å¯¹ï¼Œå°±ä¸€è½®mapreduceçš„è¯ï¼Œä¸¤è€…æ•ˆç‡ä¸Šå·®ä¸å¤šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632831566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3046392,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/ugib9sF9icd9dhibQoAA025hibbD5zgZTiaddLoeEH457hrkBBhtQK6qknTWt270rHCtBZqeqsbibtHghgjdkPx3DyIw/132","nickname":"å”æ–¹åˆš","note":"","ucode":"93DA58C3DCCF1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585594,"discussion_content":"æ˜¯å•Šï¼Œæˆ‘ä¹ŸåŒæ„Ÿï¼Œéƒ½æ˜¯å…ˆå†…å­˜ï¼ˆç¯å½¢ç¼“å†²ï¼‰ï¼Œä¸å¤Ÿäº†å°±spillåˆ°ç£ç›˜ï¼Œæœ€åå†mergeï¼Œå¥½åƒæ²¡ä»€ä¹ˆåŒºåˆ«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661695122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}