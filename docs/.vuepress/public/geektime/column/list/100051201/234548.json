{"id":234548,"title":"06 | é”ï¼šå¦‚ä½•æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„é”ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™¶è¾‰ã€‚</p><p>ä¸Šä¸€è®²æˆ‘ä»¬è°ˆåˆ°äº†å®ç°é«˜å¹¶å‘çš„ä¸åŒæ–¹æ¡ˆï¼Œè¿™ä¸€è®²æˆ‘ä»¬æ¥è°ˆè°ˆå¦‚ä½•æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„é”ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤šçº¿ç¨‹ä¸‹ä¸ºäº†ç¡®ä¿æ•°æ®ä¸ä¼šå‡ºé”™ï¼Œå¿…é¡»åŠ é”åæ‰èƒ½è®¿é—®å…±äº«èµ„æºã€‚æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ˜¯äº’æ–¥é”ï¼Œç„¶è€Œï¼Œè¿˜æœ‰å¾ˆå¤šç§ä¸åŒçš„é”ï¼Œæ¯”å¦‚è‡ªæ—‹é”ã€è¯»å†™é”ç­‰ç­‰ï¼Œå®ƒä»¬åˆ†åˆ«é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚</p><p>æ¯”å¦‚é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œè¦æ±‚æ¯ä¸ªå‡½æ•°çš„æ‰§è¡Œæ—¶é—´å¿…é¡»éƒ½è¶³å¤Ÿå¾—çŸ­ï¼Œè¿™æ ·æ‰€æœ‰è¯·æ±‚æ‰èƒ½åŠæ—¶å¾—åˆ°å“åº”ï¼Œå¦‚æœä½ é€‰æ‹©äº†é”™è¯¯çš„é”ï¼Œæ•°ä¸‡è¯·æ±‚åŒæ—¶äº‰æŠ¢ä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å¤§é‡è¯·æ±‚é•¿æœŸå–ä¸åˆ°é”è€Œå¤„ç†è¶…æ—¶ï¼Œç³»ç»Ÿååé‡å§‹ç»ˆç»´æŒåœ¨å¾ˆä½çš„æ°´å¹³ï¼Œç”¨æˆ·ä½“éªŒéå¸¸å·®ï¼Œæœ€ç»ˆâ€œé«˜å¹¶å‘â€æˆäº†ä¸€å¥ç©ºè°ˆã€‚</p><p>æ€æ ·é€‰æ‹©æœ€åˆé€‚çš„é”å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¿…é¡»æ¸…æ¥šåŠ é”çš„æˆæœ¬ç©¶ç«Ÿæœ‰å¤šå¤§ï¼Œå…¶æ¬¡æˆ‘ä»¬è¦åˆ†æä¸šåŠ¡åœºæ™¯ä¸­è®¿é—®å…±äº«èµ„æºçš„æ–¹å¼ï¼Œæœ€ååˆ™è¦é¢„ä¼°å¹¶å‘è®¿é—®æ—¶å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬æ‰èƒ½é€‰å¯¹é”ï¼ŒåŒæ—¶å®ç°é«˜å¹¶å‘å’Œé«˜ååé‡è¿™ä¸¤ä¸ªç›®æ ‡ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±é’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œäº†è§£ä¸‹é”çš„é€‰æ‹©å’Œä½¿ç”¨ï¼Œä»è€Œå‡å°‘é”å¯¹é«˜å¹¶å‘æ€§èƒ½çš„å½±å“ã€‚</p><h2>äº’æ–¥é”ä¸è‡ªæ—‹é”ï¼šä¼‘çœ è¿˜æ˜¯â€œå¿™ç­‰å¾…â€ï¼Ÿ</h2><p>æˆ‘ä»¬å¸¸è§çš„å„ç§é”æ˜¯æœ‰å±‚çº§çš„ï¼Œæœ€åº•å±‚çš„ä¸¤ç§é”å°±æ˜¯äº’æ–¥é”å’Œè‡ªæ—‹é”ï¼Œå…¶ä»–é”éƒ½æ˜¯åŸºäºå®ƒä»¬å®ç°çš„ã€‚äº’æ–¥é”çš„åŠ é”æˆæœ¬æ›´é«˜ï¼Œä½†å®ƒåœ¨åŠ é”å¤±è´¥æ—¶ä¼šé‡Šæ”¾CPUç»™å…¶ä»–çº¿ç¨‹ï¼›è‡ªæ—‹é”åˆ™åˆšå¥½ç›¸åã€‚</p><!-- [[[read_end]]] --><p><strong>å½“ä½ æ— æ³•åˆ¤æ–­é”ä½çš„ä»£ç ä¼šæ‰§è¡Œå¤šä¹…æ—¶ï¼Œåº”è¯¥é¦–é€‰äº’æ–¥é”ï¼Œäº’æ–¥é”æ˜¯ä¸€ç§ç‹¬å é”ã€‚</strong>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå½“Açº¿ç¨‹å–åˆ°é”åï¼Œäº’æ–¥é”å°†è¢«Açº¿ç¨‹ç‹¬è‡ªå æœ‰ï¼Œå½“Aæ²¡æœ‰é‡Šæ”¾è¿™æŠŠé”æ—¶ï¼Œå…¶ä»–çº¿ç¨‹çš„å–é”ä»£ç éƒ½ä¼šè¢«é˜»å¡ã€‚</p><p>é˜»å¡æ˜¯æ€æ ·è¿›è¡Œçš„å‘¢ï¼Ÿ<strong>å¯¹äº99%çš„çº¿ç¨‹çº§äº’æ–¥é”è€Œè¨€ï¼Œé˜»å¡éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å®ç°çš„</strong>ï¼ˆæ¯”å¦‚Linuxä¸‹å®ƒé€šå¸¸ç”±å†…æ ¸æä¾›çš„ä¿¡å·é‡å®ç°ï¼‰ã€‚å½“è·å–é”å¤±è´¥æ—¶ï¼Œå†…æ ¸ä¼šå°†çº¿ç¨‹ç½®ä¸ºä¼‘çœ çŠ¶æ€ï¼Œç­‰åˆ°é”è¢«é‡Šæ”¾åï¼Œå†…æ ¸ä¼šåœ¨åˆé€‚çš„æ—¶æœºå”¤é†’çº¿ç¨‹ï¼Œè€Œè¿™ä¸ªçº¿ç¨‹æˆåŠŸæ‹¿åˆ°é”åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/74/8a/749fc674c55136bd455725b79c9e0c8a.jpg?wh=1198*1144\" alt=\"\"></p><p>äº’æ–¥é”é€šè¿‡å†…æ ¸å¸®å¿™åˆ‡æ¢çº¿ç¨‹ï¼Œç®€åŒ–äº†ä¸šåŠ¡ä»£ç ä½¿ç”¨é”çš„éš¾åº¦ã€‚</p><p>ä½†æ˜¯ï¼Œçº¿ç¨‹è·å–é”å¤±è´¥æ—¶ï¼Œå¢åŠ äº†ä¸¤æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬ï¼šä»è¿è¡Œä¸­åˆ‡æ¢ä¸ºä¼‘çœ ï¼Œä»¥åŠé”é‡Šæ”¾æ—¶ä»ä¼‘çœ çŠ¶æ€åˆ‡æ¢ä¸ºè¿è¡Œä¸­ã€‚ä¸Šä¸‹æ–‡åˆ‡æ¢è€—æ—¶åœ¨å‡ åçº³ç§’åˆ°å‡ å¾®ç§’ä¹‹é—´ï¼Œæˆ–è®¸è¿™æ®µæ—¶é—´æ¯”é”ä½çš„ä»£ç æ®µæ‰§è¡Œæ—¶é—´è¿˜é•¿ã€‚è€Œä¸”ï¼Œçº¿ç¨‹ä¸»åŠ¨è¿›å…¥ä¼‘çœ æ˜¯é«˜å¹¶å‘æœåŠ¡æ— æ³•å®¹å¿çš„è¡Œä¸ºï¼Œè¿™è®©å…¶ä»–å¼‚æ­¥è¯·æ±‚éƒ½æ— æ³•æ‰§è¡Œã€‚</p><p>å¦‚æœä½ èƒ½ç¡®å®šè¢«é”ä½çš„ä»£ç æ‰§è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œå°±åº”è¯¥ç”¨è‡ªæ—‹é”å–ä»£äº’æ–¥é”ã€‚</p><p>è‡ªæ—‹é”æ¯”äº’æ–¥é”å¿«å¾—å¤šï¼Œå› ä¸ºå®ƒé€šè¿‡CPUæä¾›çš„CASå‡½æ•°ï¼ˆå…¨ç§°Compare And Swapï¼‰ï¼Œåœ¨ç”¨æˆ·æ€ä»£ç ä¸­å®ŒæˆåŠ é”ä¸è§£é”æ“ä½œã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒåŠ é”æµç¨‹åŒ…æ‹¬2ä¸ªæ­¥éª¤ï¼šç¬¬1æ­¥æŸ¥çœ‹é”çš„çŠ¶æ€ï¼Œå¦‚æœé”æ˜¯ç©ºé—²çš„ï¼Œç¬¬2æ­¥å°†é”è®¾ç½®ä¸ºå½“å‰çº¿ç¨‹æŒæœ‰ã€‚</p><p>åœ¨æ²¡æœ‰CASæ“ä½œå‰ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œè¿™2ä¸ªæ­¥éª¤æ˜¯ä¼šå‡ºé”™çš„ã€‚æ¯”å¦‚çº¿ç¨‹Aæ‰§è¡Œç¬¬1æ­¥å‘ç°é”æ˜¯ç©ºé—²çš„ï¼Œä½†å®ƒåœ¨æ‰§è¡Œç¬¬2æ­¥å‰ï¼Œçº¿ç¨‹Bä¹Ÿæ‰§è¡Œäº†ç¬¬1æ­¥ï¼ŒBä¹Ÿå‘ç°é”æ˜¯ç©ºé—²çš„ï¼Œäºæ˜¯çº¿ç¨‹Aã€Bä¼šåŒæ—¶è®¤ä¸ºå®ƒä»¬è·å¾—äº†é”ã€‚</p><p>CASå‡½æ•°æŠŠè¿™2ä¸ªæ­¥éª¤åˆå¹¶ä¸ºä¸€æ¡ç¡¬ä»¶çº§æŒ‡ä»¤ã€‚è¿™æ ·ï¼Œç¬¬1æ­¥æ¯”è¾ƒé”çŠ¶æ€å’Œç¬¬2æ­¥é”å˜é‡èµ‹å€¼ï¼Œå°†å˜ä¸ºä¸å¯åˆ†å‰²çš„åŸå­æŒ‡ä»¤ã€‚äºæ˜¯ï¼Œè®¾é”ä¸ºå˜é‡lockï¼Œæ•´æ•°0è¡¨ç¤ºé”æ˜¯ç©ºé—²çŠ¶æ€ï¼Œæ•´æ•°pidè¡¨ç¤ºçº¿ç¨‹IDï¼Œé‚£ä¹ˆCAS(lock, 0, pid)å°±è¡¨ç¤ºè‡ªæ—‹é”çš„åŠ é”æ“ä½œï¼ŒCAS(lock, pid, 0)åˆ™è¡¨ç¤ºè§£é”æ“ä½œã€‚</p><p>å¤šçº¿ç¨‹ç«äº‰é”çš„æ—¶å€™ï¼ŒåŠ é”å¤±è´¥çš„çº¿ç¨‹ä¼šâ€œå¿™ç­‰å¾…â€ï¼Œç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚ä»€ä¹ˆå«â€œå¿™ç­‰å¾…â€å‘¢ï¼Ÿå®ƒå¹¶ä¸æ„å‘³ç€ä¸€ç›´æ‰§è¡ŒCASå‡½æ•°ï¼Œç”Ÿäº§çº§çš„è‡ªæ—‹é”åœ¨â€œå¿™ç­‰å¾…â€æ—¶ï¼Œä¼šä¸CPUç´§å¯†é…åˆ ï¼Œå®ƒé€šè¿‡CPUæä¾›çš„PAUSEæŒ‡ä»¤ï¼Œå‡å°‘å¾ªç¯ç­‰å¾…æ—¶çš„è€—ç”µé‡ï¼›å¯¹äºå•æ ¸CPUï¼Œå¿™ç­‰å¾…å¹¶æ²¡æœ‰æ„ä¹‰ï¼Œæ­¤æ—¶å®ƒä¼šä¸»åŠ¨æŠŠçº¿ç¨‹ä¼‘çœ ã€‚</p><p>å¦‚æœä½ å¯¹æ­¤æ„Ÿå…´è¶£ï¼Œå¯ä»¥é˜…è¯»ä¸‹é¢è¿™æ®µç”Ÿäº§çº§çš„è‡ªæ—‹é”ï¼Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆæ‰§è¡Œâ€œå¿™ç­‰å¾…â€çš„ï¼š</p><pre><code>while (true) {\n  //å› ä¸ºåˆ¤æ–­lockå˜é‡çš„å€¼æ¯”CASæ“ä½œæ›´å¿«ï¼Œæ‰€ä»¥å…ˆåˆ¤æ–­lockå†è°ƒç”¨CASæ•ˆç‡æ›´é«˜\n  if (lock == 0 &amp;&amp;  CAS(lock, 0, pid) == 1) return;\n  \n  if (CPU_count &gt; 1 ) { //å¦‚æœæ˜¯å¤šæ ¸CPUï¼Œâ€œå¿™ç­‰å¾…â€æ‰æœ‰æ„ä¹‰\n      for (n = 1; n &lt; 2048; n &lt;&lt;= 1) {//pauseçš„æ—¶é—´ï¼Œåº”å½“è¶Šæ¥è¶Šé•¿\n        for (i = 0; i &lt; n; i++) pause();//CPUä¸“ä¸ºè‡ªæ—‹é”è®¾è®¡äº†pauseæŒ‡ä»¤\n        if (lock == 0 &amp;&amp; CAS(lock, 0, pid)) return;//pauseåå†å°è¯•è·å–é”\n      }\n  }\n  sched_yield();//å•æ ¸CPUï¼Œæˆ–è€…é•¿æ—¶é—´ä¸èƒ½è·å–åˆ°é”ï¼Œåº”ä¸»åŠ¨ä¼‘çœ ï¼Œè®©å‡ºCPU\n}\n</code></pre><p>åœ¨ä½¿ç”¨å±‚é¢ä¸Šï¼Œè‡ªæ—‹é”ä¸äº’æ–¥é”å¾ˆç›¸ä¼¼ï¼Œå®ç°å±‚é¢ä¸Šå®ƒä»¬åˆå®Œå…¨ä¸åŒã€‚è‡ªæ—‹é”å¼€é”€å°‘ï¼Œåœ¨å¤šæ ¸ç³»ç»Ÿä¸‹ä¸€èˆ¬ä¸ä¼šä¸»åŠ¨äº§ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œå¾ˆé€‚åˆåœ¨ç”¨æˆ·æ€åˆ‡æ¢è¯·æ±‚çš„ç¼–ç¨‹æ–¹å¼ï¼Œæœ‰åŠ©äºé«˜å¹¶å‘æœåŠ¡å……åˆ†åˆ©ç”¨å¤šé¢—CPUã€‚ä½†å¦‚æœè¢«é”ä½çš„ä»£ç æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼ŒCPUèµ„æºå°†è¢«å…¶ä»–çº¿ç¨‹åœ¨â€œå¿™ç­‰å¾…â€ä¸­é•¿æ—¶é—´å ç”¨ã€‚</p><p>å½“å–ä¸åˆ°é”æ—¶ï¼Œäº’æ–¥é”ç”¨â€œçº¿ç¨‹åˆ‡æ¢â€æ¥é¢å¯¹ï¼Œè‡ªæ—‹é”åˆ™ç”¨â€œå¿™ç­‰å¾…â€æ¥é¢å¯¹ã€‚<strong>è¿™æ˜¯ä¸¤ç§æœ€åŸºæœ¬çš„å¤„ç†æ–¹å¼ï¼Œæ›´é«˜çº§åˆ«çš„é”éƒ½ä¼šé€‰æ‹©å…¶ä¸­ä¸€ç§æ¥å®ç°ï¼Œæ¯”å¦‚è¯»å†™é”å°±æ—¢å¯ä»¥åŸºäºäº’æ–¥é”å®ç°ï¼Œä¹Ÿå¯ä»¥åŸºäºè‡ªæ—‹é”å®ç°ã€‚</strong></p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹è¯»å†™é”èƒ½å¸¦æ¥æ€æ ·çš„æ€§èƒ½æå‡ã€‚</p><h2>å…è®¸å¹¶å‘æŒæœ‰çš„è¯»å†™é”</h2><p><strong>å¦‚æœä½ èƒ½å¤Ÿæ˜ç¡®åŒºåˆ†å‡ºè¯»å’Œå†™ä¸¤ç§åœºæ™¯ï¼Œå¯ä»¥é€‰æ‹©è¯»å†™é”ã€‚</strong></p><p>è¯»å†™é”ç”±è¯»é”å’Œå†™é”ä¸¤éƒ¨åˆ†æ„æˆï¼Œä»…è¯»å–å…±äº«èµ„æºçš„ä»£ç æ®µç”¨è¯»é”æ¥åŠ é”ï¼Œä¼šä¿®æ”¹èµ„æºçš„ä»£ç æ®µåˆ™ç”¨å†™é”æ¥åŠ é”ã€‚</p><p>è¯»å†™é”çš„ä¼˜åŠ¿åœ¨äºï¼Œå½“å†™é”æœªè¢«æŒæœ‰æ—¶ï¼Œå¤šä¸ªçº¿ç¨‹èƒ½å¤Ÿå¹¶å‘åœ°æŒæœ‰è¯»é”ï¼Œè¿™æé«˜äº†å…±äº«èµ„æºçš„ä½¿ç”¨ç‡ã€‚å¤šä¸ªè¯»é”è¢«åŒæ—¶æŒæœ‰æ—¶ï¼Œè¯»çº¿ç¨‹å¹¶ä¸ä¼šä¿®æ”¹å…±äº«èµ„æºï¼Œæ‰€ä»¥å®ƒä»¬çš„å¹¶å‘æ‰§è¡Œä¸ä¼šäº§ç”Ÿæ•°æ®é”™è¯¯ã€‚</p><p>è€Œä¸€æ—¦å†™é”è¢«æŒæœ‰åï¼Œä¸åªè¯»çº¿ç¨‹å¿…é¡»é˜»å¡åœ¨è·å–è¯»é”çš„ç¯èŠ‚ï¼Œå…¶ä»–è·å–å†™é”çš„å†™çº¿ç¨‹ä¹Ÿè¦è¢«é˜»å¡ã€‚å†™é”å°±åƒäº’æ–¥é”å’Œè‡ªæ—‹é”ä¸€æ ·ï¼Œæ˜¯ä¸€ç§ç‹¬å é”ï¼›è€Œè¯»é”å…è®¸å¹¶å‘æŒæœ‰ï¼Œåˆ™æ˜¯ä¸€ç§å…±äº«é”ã€‚</p><p><strong>å› æ­¤ï¼Œè¯»å†™é”çœŸæ­£å‘æŒ¥ä¼˜åŠ¿çš„åœºæ™¯ï¼Œå¿…ç„¶æ˜¯è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¦åˆ™è¯»é”å°†å¾ˆéš¾å¹¶å‘æŒæœ‰ã€‚</strong></p><p>å®é™…ä¸Šï¼Œè¯»å†™é”æ—¢å¯ä»¥å€¾å‘äºè¯»çº¿ç¨‹ï¼Œåˆå¯ä»¥å€¾å‘äºå†™çº¿ç¨‹ã€‚å‰è€…æˆ‘ä»¬ç§°ä¸ºè¯»ä¼˜å…ˆé”ï¼Œåè€…ç§°ä¸ºå†™ä¼˜å…ˆé”ã€‚</p><p>è¯»ä¼˜å…ˆé”æ›´å¼ºè°ƒæ•ˆç‡ï¼Œå®ƒæœŸå¾…é”èƒ½è¢«æ›´å¤šçš„çº¿ç¨‹æŒæœ‰ã€‚ç®€å•çœ‹ä¸‹å®ƒçš„å·¥ä½œç‰¹ç‚¹ï¼šå½“çº¿ç¨‹Aå…ˆæŒæœ‰è¯»é”åï¼Œå³ä½¿çº¿ç¨‹Båœ¨ç­‰å¾…å†™é”ï¼Œåç»­å‰æ¥è·å–è¯»é”çš„çº¿ç¨‹Cä»ç„¶å¯ä»¥ç«‹åˆ»åŠ é”æˆåŠŸï¼Œå› ä¸ºè¿™æ ·å°±æœ‰Aã€C è¿™2ä¸ªè¯»çº¿ç¨‹åœ¨å¹¶å‘æŒæœ‰é”ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹å†™ä¼˜å…ˆçš„è¯»å†™é”ã€‚åŒæ ·çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹Cè·å–è¯»é”ä¼šå¤±è´¥ï¼Œå®ƒå°†è¢«é˜»å¡åœ¨è·å–é”çš„ä»£ç ä¸­ï¼Œè¿™æ ·ï¼Œåªè¦çº¿ç¨‹Aé‡Šæ”¾è¯»é”åï¼Œçº¿ç¨‹Bé©¬ä¸Šå°±å¯ä»¥è·å–åˆ°å†™é”ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7b/c6/7b5f4e4bb3370b89b90c1bf83cb58fc6.jpg?wh=1202*1496\" alt=\"\"></p><p>è¯»ä¼˜å…ˆé”å¹¶å‘æ€§æ›´å¥½ï¼Œä½†é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ã€‚å¦‚æœè¯»çº¿ç¨‹æºæºä¸æ–­åœ°è·å–è¯»é”ï¼Œå†™çº¿ç¨‹å°†æ°¸è¿œè·å–ä¸åˆ°å†™é”ã€‚å†™ä¼˜å…ˆé”å¯ä»¥ä¿è¯å†™çº¿ç¨‹ä¸ä¼šé¥¿æ­»ï¼Œä½†å¦‚æœæ–°çš„å†™çº¿ç¨‹æºæºä¸æ–­åœ°åˆ°æ¥ï¼Œè¯»çº¿ç¨‹ä¹Ÿå¯èƒ½è¢«é¥¿æ­»ã€‚</p><p>é‚£ä¹ˆï¼Œèƒ½å¦å…¼é¡¾äºŒè€…ï¼Œé¿å…è¯»ã€å†™çº¿ç¨‹é¥¿æ­»å‘¢ï¼Ÿ</p><p><strong>ç”¨é˜Ÿåˆ—æŠŠè¯·æ±‚é”çš„çº¿ç¨‹æ’é˜Ÿï¼ŒæŒ‰ç…§å…ˆæ¥ååˆ°çš„é¡ºåºåŠ é”å³å¯ï¼Œå½“ç„¶è¯»çº¿ç¨‹ä»ç„¶å¯ä»¥å¹¶å‘ï¼Œåªä¸è¿‡ä¸èƒ½æ’é˜Ÿåˆ°å†™çº¿ç¨‹ä¹‹å‰ã€‚</strong>Javaä¸­çš„ReentrantReadWriteLockè¯»å†™é”ï¼Œå°±æ”¯æŒè¿™ç§æ’é˜Ÿçš„å…¬å¹³è¯»å†™é”ã€‚</p><p>å¦‚æœä¸å¸Œæœ›å–é”æ—¶çº¿ç¨‹ä¸»åŠ¨ä¼‘çœ ï¼Œè¿˜å¯ä»¥ç”¨è‡ªæ—‹é”å®ç°è¯»å†™é”ã€‚åˆ°åº•åº”è¯¥é€‰æ‹©â€œçº¿ç¨‹åˆ‡æ¢â€è¿˜æ˜¯â€œå¿™ç­‰å¾…â€æ–¹å¼å®ç°è¯»å†™é”å‘¢ï¼Ÿé™¤å»è¯»å†™åœºæ™¯å¤–ï¼Œè¿™ä¸é€‰æ‹©äº’æ–¥é”å’Œè‡ªæ—‹é”çš„æ–¹æ³•ç›¸åŒï¼Œå°±æ˜¯æ ¹æ®åŠ é”ä»£ç æ‰§è¡Œæ—¶é—´çš„é•¿çŸ­æ¥é€‰æ‹©ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p><h2>ä¹è§‚é”ï¼šä¸ä½¿ç”¨é”ä¹Ÿèƒ½åŒæ­¥</h2><p>äº‹å®ä¸Šï¼Œæ— è®ºäº’æ–¥é”ã€è‡ªæ—‹é”è¿˜æ˜¯è¯»å†™é”ï¼Œéƒ½å±äºæ‚²è§‚é”ã€‚</p><p>ä»€ä¹ˆå«æ‚²è§‚é”å‘¢ï¼Ÿå®ƒè®¤ä¸ºåŒæ—¶ä¿®æ”¹èµ„æºçš„æ¦‚ç‡å¾ˆé«˜ï¼Œå¾ˆå®¹æ˜“å‡ºç°å†²çªï¼Œæ‰€ä»¥è®¿é—®å…±äº«èµ„æºå‰ï¼Œå…ˆåŠ ä¸Šé”ï¼Œæ€»ä½“æ•ˆç‡ä¼šæ›´ä¼˜ã€‚ç„¶è€Œï¼Œå¦‚æœå¹¶å‘äº§ç”Ÿå†²çªçš„æ¦‚ç‡å¾ˆä½ï¼Œå°±ä¸å¿…ä½¿ç”¨æ‚²è§‚é”ï¼Œè€Œæ˜¯ä½¿ç”¨ä¹è§‚é”ã€‚</p><p>æ‰€è°“â€œä¹è§‚â€ï¼Œå°±æ˜¯å‡å®šå†²çªçš„æ¦‚ç‡å¾ˆä½ï¼Œæ‰€ä»¥å®ƒé‡‡ç”¨çš„â€œåŠ é”â€æ–¹å¼æ˜¯ï¼Œå…ˆä¿®æ”¹å®Œå…±äº«èµ„æºï¼Œå†éªŒè¯è¿™æ®µæ—¶é—´å†…æœ‰æ²¡æœ‰å‘ç”Ÿå†²çªã€‚å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹åœ¨ä¿®æ”¹èµ„æºï¼Œé‚£ä¹ˆæ“ä½œå®Œæˆã€‚å¦‚æœå‘ç°å…¶ä»–çº¿ç¨‹å·²ç»ä¿®æ”¹äº†è¿™ä¸ªèµ„æºï¼Œå°±æ”¾å¼ƒæœ¬æ¬¡æ“ä½œã€‚</p><p>è‡³äºæ”¾å¼ƒåå¦‚ä½•é‡è¯•ï¼Œåˆ™ä¸ä¸šåŠ¡åœºæ™¯ç›¸å…³ï¼Œè™½ç„¶é‡è¯•çš„æˆæœ¬å¾ˆé«˜ï¼Œä½†å‡ºç°å†²çªçš„æ¦‚ç‡è¶³å¤Ÿä½çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚å¯è§ï¼Œ<strong>ä¹è§‚é”å…¨ç¨‹å¹¶æ²¡æœ‰åŠ é”ï¼Œæ‰€ä»¥å®ƒä¹Ÿå«æ— é”ç¼–ç¨‹ã€‚</strong></p><p>æ— é”ç¼–ç¨‹ä¸­ï¼ŒéªŒè¯æ˜¯å¦å‘ç”Ÿäº†å†²çªæ˜¯å…³é”®ã€‚è¯¥æ€ä¹ˆéªŒè¯å‘¢ï¼Ÿè¿™ä¸å…·ä½“çš„åœºæ™¯æœ‰å…³ã€‚</p><p>æ¯”å¦‚è¯´åœ¨çº¿æ–‡æ¡£ã€‚Webä¸­çš„åœ¨çº¿æ–‡æ¡£æ˜¯æ€ä¹ˆå®ç°å¤šäººç¼–è¾‘çš„ï¼Ÿç”¨æˆ·Aå…ˆåœ¨æµè§ˆå™¨ä¸­ç¼–è¾‘æŸä¸ªæ–‡æ¡£ï¼Œä¹‹åç”¨æˆ·Bä¹Ÿæ‰“å¼€äº†ç›¸åŒçš„é¡µé¢å¼€å§‹ç¼–è¾‘ï¼Œå¯æ˜¯ï¼Œç”¨æˆ·Bæœ€å…ˆç¼–è¾‘å®Œæˆæäº¤ï¼Œè¿™ä¸€è¿‡ç¨‹ç”¨æˆ·Aå´ä¸çŸ¥é“ã€‚å½“Aæäº¤ä»–æ”¹å®Œçš„å†…å®¹æ—¶ï¼ŒAã€Bä¹‹é—´çš„å¹¶è¡Œä¿®æ”¹å¼•å‘äº†å†²çªã€‚</p><p>WebæœåŠ¡æ˜¯æ€ä¹ˆè§£å†³è¿™ç§å†²çªçš„å‘¢ï¼Ÿå®ƒå¹¶æ²¡æœ‰é™åˆ¶ç”¨æˆ·å…ˆæ‹¿åˆ°é”åæ‰èƒ½ç¼–è¾‘æ–‡æ¡£ï¼Œè¿™æ—¢å› ä¸ºå†²çªçš„æ¦‚ç‡éå¸¸ä½ï¼Œä¹Ÿå› ä¸ºåŠ è§£é”çš„ä»£ä»·å¾ˆé«˜ã€‚Webä¸­çš„æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼šè®©ç”¨æˆ·å…ˆæ”¹ç€ï¼Œä½†éœ€è¦æµè§ˆå™¨è®°å½•ä¸‹ä¿®æ”¹å‰çš„æ–‡æ¡£ç‰ˆæœ¬å·ï¼Œè¿™é€šè¿‡ä¸‹è½½æ–‡æ¡£æ—¶ï¼Œè¿”å›çš„HTTP ETagå¤´éƒ¨å®ç°ã€‚</p><p>å½“ç”¨æˆ·æäº¤ä¿®æ”¹æ—¶ï¼Œæµè§ˆå™¨åœ¨è¯·æ±‚ä¸­é€šè¿‡HTTP If-Matchå¤´éƒ¨æºå¸¦åŸç‰ˆæœ¬å·ï¼ŒæœåŠ¡å™¨å°†å®ƒä¸æ–‡æ¡£çš„å½“å‰ç‰ˆæœ¬å·æ¯”è¾ƒï¼Œä¸€è‡´åæ–°çš„ä¿®æ”¹æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦åˆ™æäº¤å¤±è´¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå¦‚æœä½ æƒ³äº†è§£è¿™ä¸€è¿‡ç¨‹çš„ç»†èŠ‚ï¼Œå¯ä»¥é˜…è¯» <a href=\"https://time.geekbang.org/course/detail/175-98914\">ã€ŠWebåè®®è¯¦è§£ä¸æŠ“åŒ…å®æˆ˜ã€‹ç¬¬28è¯¾</a>ï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/f0/1db3bb24d896fabeebf68359384214f0.jpg?wh=1578*1150\" alt=\"\"></p><p>ä¹è§‚é”é™¤äº†åº”ç”¨åœ¨Webåˆ†å¸ƒå¼åœºæ™¯ï¼Œåœ¨æ•°æ®åº“ç­‰å•æœºä¸Šä¹Ÿæœ‰å¹¿æ³›çš„åº”ç”¨ã€‚åªæ˜¯é¢å‘å¤šçº¿ç¨‹æ—¶ï¼Œæœ€åçš„éªŒè¯æ­¥éª¤æ˜¯é€šè¿‡CPUæä¾›çš„CASæ“ä½œå®Œæˆçš„ã€‚</p><p>ä¹è§‚é”è™½ç„¶å»é™¤äº†é”æ“ä½œï¼Œä½†æ˜¯ä¸€æ—¦å‘ç”Ÿå†²çªï¼Œé‡è¯•çš„æˆæœ¬éå¸¸é«˜ã€‚æ‰€ä»¥ï¼Œ<strong>åªæœ‰åœ¨å†²çªæ¦‚ç‡éå¸¸ä½ï¼Œä¸”åŠ é”æˆæœ¬è¾ƒé«˜æ—¶ï¼Œæ‰è€ƒè™‘ä½¿ç”¨ä¹è§‚é”ã€‚</strong></p><h2>å°ç»“</h2><p>è¿™ä¸€è®²æˆ‘ä»¬ä»‹ç»äº†é«˜å¹¶å‘ä¸‹åŒæ­¥èµ„æºæ—¶ï¼Œå¦‚ä½•æ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„é”ï¼Œæ¥ä¼˜åŒ–æœåŠ¡çš„æ€§èƒ½ã€‚</p><p>äº’æ–¥é”èƒ½å¤Ÿæ»¡è¶³å„ç±»åŠŸèƒ½æ€§è¦æ±‚ï¼Œç‰¹åˆ«æ˜¯è¢«é”ä½çš„ä»£ç æ‰§è¡Œæ—¶é—´ä¸å¯æ§æ—¶ï¼Œå®ƒé€šè¿‡å†…æ ¸æ‰§è¡Œçº¿ç¨‹åˆ‡æ¢åŠæ—¶é‡Šæ”¾äº†èµ„æºï¼Œä½†å®ƒçš„æ€§èƒ½æ¶ˆè€—æœ€å¤§ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåç¨‹çš„äº’æ–¥é”å®ç°åŸç†å®Œå…¨ä¸åŒï¼Œå®ƒå¹¶ä¸ä¸å†…æ ¸æ‰“äº¤é“ï¼Œè™½ç„¶ä¸èƒ½è·¨çº¿ç¨‹å·¥ä½œï¼Œä½†æ•ˆç‡å¾ˆé«˜ã€‚ï¼ˆå¦‚æœä½ å¸Œæœ›è¿›ä¸€æ­¥äº†è§£åç¨‹ï¼Œå¯ä»¥é˜…è¯»<a href=\"https://time.geekbang.org/column/article/233629\">[ç¬¬5è®²]</a>ã€‚ï¼‰</p><p>å¦‚æœèƒ½å¤Ÿç¡®å®šè¢«é”ä½çš„ä»£ç å–åˆ°é”åå¾ˆå¿«å°±èƒ½é‡Šæ”¾ï¼Œåº”è¯¥ä½¿ç”¨æ›´é«˜æ•ˆçš„è‡ªæ—‹é”ï¼Œå®ƒç‰¹åˆ«é€‚åˆåŸºäºå¼‚æ­¥ç¼–ç¨‹å®ç°çš„é«˜å¹¶å‘æœåŠ¡ã€‚</p><p>å¦‚æœèƒ½åŒºåˆ†å‡ºè¯»å†™æ“ä½œï¼Œè¯»å†™é”å°±æ˜¯ç¬¬ä¸€é€‰æ‹©ï¼Œå®ƒå…è®¸å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶æŒæœ‰è¯»é”ï¼Œæé«˜äº†å¹¶å‘æ€§ã€‚è¯»å†™é”æ˜¯æœ‰å€¾å‘æ€§çš„ï¼Œè¯»ä¼˜å…ˆé”å¾ˆé«˜æ•ˆï¼Œä½†å®¹æ˜“è®©å†™çº¿ç¨‹é¥¿æ­»ï¼Œè€Œå†™ä¼˜å…ˆé”ä¼šä¼˜å…ˆæœåŠ¡å†™çº¿ç¨‹ï¼Œä½†å¯¹è¯»çº¿ç¨‹äº²å’Œæ€§å·®ä¸€äº›ã€‚è¿˜æœ‰ä¸€ç§å…¬å¹³è¯»å†™é”ï¼Œå®ƒé€šè¿‡æŠŠç­‰å¾…é”çš„çº¿ç¨‹æ’é˜Ÿï¼Œä»¥ç•¥å¾®ç‰ºç‰²æ€§èƒ½çš„æ–¹å¼ï¼Œä¿è¯äº†æŸç§çº¿ç¨‹ä¸ä¼šé¥¿æ­»ï¼Œé€šç”¨æ€§æ›´ä½³ã€‚</p><p>å¦å¤–ï¼Œè¯»å†™é”æ—¢å¯ä»¥ä½¿ç”¨äº’æ–¥é”å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªæ—‹é”å®ç°ï¼Œæˆ‘ä»¬åº”æ ¹æ®åœºæ™¯æ¥é€‰æ‹©åˆé€‚çš„å®ç°ã€‚</p><p>å½“å¹¶å‘è®¿é—®å…±äº«èµ„æºï¼Œå†²çªæ¦‚ç‡éå¸¸ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ— é”ç¼–ç¨‹ã€‚å®ƒåœ¨Webå’Œæ•°æ®åº“ä¸­æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚ç„¶è€Œï¼Œä¸€æ—¦å†²çªæ¦‚ç‡ä¸Šå‡ï¼Œå°±ä¸é€‚åˆä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒè§£å†³å†²çªçš„é‡è¯•æˆæœ¬éå¸¸é«˜ã€‚</p><p>æ€»ä¹‹ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§é”ï¼Œé”èŒƒå›´å†…çš„ä»£ç éƒ½åº”å°½é‡çš„å°‘ï¼Œæ‰§è¡Œé€Ÿåº¦è¦å¿«ã€‚åœ¨æ­¤ä¹‹ä¸Šï¼Œé€‰æ‹©æ›´åˆé€‚çš„é”èƒ½å¤Ÿå¤§å¹…æå‡é«˜å¹¶å‘æœåŠ¡çš„æ€§èƒ½ï¼</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œç•™ç»™ä½ ä¸€é“æ€è€ƒé¢˜ï¼Œä¸Šä¸€è®²æˆ‘ä»¬æåˆ°åç¨‹ä¸­ä¹Ÿæœ‰å„ç§é”ï¼Œä½ è§‰å¾—åç¨‹ä¸­å¯ä»¥ç”¨è‡ªæ—‹é”æˆ–è€…äº’æ–¥é”å—ï¼Ÿå¦‚æœä¸å¯ä»¥ï¼Œé‚£åç¨‹ä¸­çš„é”æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘æ¢è®¨ã€‚</p><p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾å¯¹ä½ æœ‰ä¸€äº›å¯å‘ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"05 | åç¨‹ï¼šå¦‚ä½•å¿«é€Ÿåœ°å®ç°é«˜å¹¶å‘æœåŠ¡ï¼Ÿ","id":233629},"right":{"article_title":"07 | æ€§èƒ½å¥½ï¼Œæ•ˆç‡é«˜çš„ä¸€å¯¹å¤šé€šè®¯è¯¥å¦‚ä½•å®ç°ï¼Ÿ","id":235302}},"comments":[{"had_liked":false,"id":217636,"user_name":"ç‹è¶…","can_delete":false,"product_type":"c1","uid":1107559,"ip_address":"","ucode":"653A7A49A3090F","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/67/59e81206.jpg","comment_is_top":false,"comment_ctime":1589553379,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"229222820067","product_id":100051201,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸€ä¸ªå»ºè®®ï¼Œæ˜¯å¦å¯ä»¥åœ¨æ¯ä¸€è®²çš„ç¬¬ä¸€ä¸ªè¯„è®ºé‡Œè®²è§£ä¸€ä¸‹ä¸Šä¸€è®²çš„æ€è€ƒé—®é¢˜","like_count":54},{"had_liked":false,"id":216275,"user_name":"bookå°¾æ±","can_delete":false,"product_type":"c1","uid":1446375,"ip_address":"","ucode":"AE2B8DFC643ACC","user_header":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","comment_is_top":false,"comment_ctime":1589212897,"is_pvip":true,"replies":[{"id":"90960","content":"å®Œå…¨æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599811332,"ip_address":"","comment_id":216275,"utype":1}],"discussion_count":7,"race_medal":0,"score":"83193591521","product_id":100051201,"comment_content":"æ€»ç»“ä¸‹,æˆ‘çš„ç†è§£ ä¸å¯¹çš„æ¬¢è¿æŒ‡å‡º:<br>å››ç§IOæ¨¡å‹<br>åŒæ­¥é˜»å¡: è°ƒç”¨äº†é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨,å†…æ ¸ä¼šå°†çº¿ç¨‹ç½®äºä¼‘çœ çŠ¶æ€,å¹¶è¿›è¡Œè°ƒåº¦<br>åŒæ­¥éé˜»å¡: è°ƒç”¨äº†éé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨,ç³»ç»Ÿè°ƒç”¨ä¼šç«‹åˆ»è¿”å›ç»“æœ.é€šè¿‡é‡è¯•çš„æ–¹å¼æ¥ä¸æ–­è·å–ç»“æœ,ç›´åˆ°æ»¡è¶³æ¡ä»¶<br>å¼‚æ­¥é˜»å¡:  ä¼šé€šè¿‡æ³¨å†Œå›è°ƒå‡½æ•°æ¥å®ç°ç»“æœçš„é€šçŸ¥,æ³¨å†Œå®Œæˆçº¿ç¨‹ä¼šè¢«å†…æ ¸æŒ‚èµ·è¿›å…¥ä¼‘çœ çŠ¶æ€<br>å¼‚æ­¥éé˜»å¡: åŒä¸Š,ä½†æ³¨å†Œå®Œæˆåçº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œ.<br><br>åŒæ­¥: ç­‰å¾…ç»“æœçš„è¿”å›æ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ<br>å¼‚æ­¥:ä¸ä¸€ç›´ç­‰å¾…ç»“æœçš„è¿”å›,è€Œæ˜¯é€šè¿‡å‘IOè°ƒåº¦æ¡†æ¶æ³¨å†Œå›è°ƒå‡½æ•°çš„æ–¹å¼æ¥è¿›è¡Œé€šçŸ¥.é€šè¿‡æ¡†æ¶æ¥å®ç°<br>é˜»å¡: ä¸ä¼šç«‹åˆ»è¿”å›ç»“æœ,æ­¤æ—¶çº¿ç¨‹ä¼šè¢«å†…æ ¸æŒ‚èµ·,è®©å‡ºcpu<br>éé˜»å¡: ç«‹åˆ»è¿”å›ç»“æœ<br>å¼‚æ­¥éé˜»å¡æ”¾åœ¨ä¸€èµ·ç”¨æ‰èƒ½èµ·åˆ°å¹¶å‘çš„ä½œç”¨.<br>åŒæ­¥éé˜»å¡ä¹Ÿå¯ä»¥å®ç°å¹¶å‘.<br>åŒæ­¥ä¸å¼‚æ­¥æ˜¯é’ˆå¯¹ç¼–ç¨‹æ–¹å¼çš„<br>é˜»å¡ä¸éé˜»å¡çš„å› ä¸ºç³»ç»Ÿè°ƒç”¨çš„å®ç°æ–¹å¼å¯¼è‡´çš„<br><br>åç¨‹: å°†å¼‚æ­¥çš„æ³¨å†Œå›è°ƒå‡½æ•°ä»¥åŠéé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨æ¥å°è£…æˆä¸€ä¸ªé˜»å¡çš„åç¨‹,å³å°†ç­‰å¾…å›è°ƒæ—¶é€šè¿‡çº¿ç¨‹ä¸­çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¥å®ç°çº¿ç¨‹çš„æ— æ„ŸçŸ¥åˆ‡æ¢,æ„Ÿè§‰æœ‰ç‚¹ç±»ä¼¼äºå¼‚æ­¥é˜»å¡,ä½†é˜»å¡æ˜¯ç”¨æˆ·æ€çš„,ä¹Ÿå°±æ˜¯æ˜¯ç”±ç”¨æˆ·æ€æ¥è¿›è¡Œçº¿ç¨‹çš„è™šæ‹Ÿçš„ä¼‘çœ (é€šè¿‡çº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢)<br><br>é”<br>ä¸¤ç§åŸºæœ¬é”<br>è‡ªæ—‹é” : é€šè¿‡CASå‡½æ•°æ¥å®ç°,å°†è§‚å¯Ÿé”çš„çŠ¶æ€ä¸è·å–é”åˆå¹¶ä¸ºä¸€ä¸ªç¡¬ä»¶çº§çš„æŒ‡ä»¤,é€šè¿‡åœ¨ç”¨æˆ·æ€æ¥è§‚å¯Ÿé”çš„çŠ¶æ€,å¹¶è¿›è¡Œè·å–é”,æ¥é¿å…å› è·å–é”å¤±è´¥å¯¼è‡´çš„çº¿ç¨‹ä¼‘çœ .è·å–é”å¤±è´¥ä¼šå¿™ç­‰å¾…,å³è¿‡ä¸€æ®µæ—¶é—´åœ¨å»è·å–é”(é€šè¿‡å¾ªç¯å®ç°ç­‰å¾…æ—¶é—´),é€šè¿‡pauseæŒ‡ä»¤æ¥å‡å°‘å¾ªç¯ç­‰å¾…æ—¶çš„è€—ç”µé‡.<br><br>äº’æ–¥é”: ä¸€ç§ç‹¬å é”,è·å–å¤±è´¥çš„çº¿ç¨‹ä¼šè¢«å†…æ ¸ç½®ä¸ºä¼‘çœ çŠ¶æ€.<br><br>å…¶ä»–é”éƒ½æ˜¯é€šè¿‡è¿™ä¸¤ç§é”å®ç°çš„<br>è¯»å†™é”<br>è¯»ä¼˜å…ˆé”<br>å†™ä¼˜å…ˆé”<br><br>ä¹è§‚é”:ä¹è§‚é”å¹¶æ²¡æœ‰åŠ é”,è€Œæ˜¯é€šè¿‡æ‰§è¡Œå®Œæˆåçš„ç‰ˆæœ¬å·å¯¹æ¯”æ¥å®ç°","like_count":20,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494744,"discussion_content":"å®Œå…¨æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599811332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1271724,"avatar":"https://static001.geekbang.org/account/avatar/00/13/67/ac/af895343.jpg","nickname":"åˆ˜è€³æ€»","note":"","ucode":"6D157E6E960075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264461,"discussion_content":"åœ¨Pythoné‡Œçš„åç¨‹await db call è¿™ç§åº”è¯¥ç®—æ˜¯å¼‚æ­¥é˜»å¡å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589328737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1446375,"avatar":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","nickname":"bookå°¾æ±","note":"","ucode":"AE2B8DFC643ACC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1271724,"avatar":"https://static001.geekbang.org/account/avatar/00/13/67/ac/af895343.jpg","nickname":"åˆ˜è€³æ€»","note":"","ucode":"6D157E6E960075","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264757,"discussion_content":"æˆ‘è§‰å¾—æ˜¯å¼‚æ­¥éé˜»å¡ï¼Œåœ¨ç”¨æˆ·æ€å®Œæˆäº†ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589346477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":264461,"ip_address":""},"score":264757,"extra":""}]},{"author":{"id":1271724,"avatar":"https://static001.geekbang.org/account/avatar/00/13/67/ac/af895343.jpg","nickname":"åˆ˜è€³æ€»","note":"","ucode":"6D157E6E960075","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264460,"discussion_content":"éé˜»å¡: ç«‹åˆ»è¿”å›ç»“æœ\nè¿™ä¸ªéé˜»å¡æ€ä¹ˆç†è§£å‘¢ï¼Ÿè¿”å›çš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Ÿç”¨æˆ·çº¿ç¨‹ç»§ç»­å¹²åˆ«çš„ä¹‹åæ€ä¹ˆæ‹¿åˆ°ä¹‹å‰è°ƒç”¨çš„ç»“æœå‘¢ï¼Œé€šè¿‡ä¹‹å‰çš„å¼‚æ­¥å‡½æ•°å›è°ƒï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589328690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261959,"avatar":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","nickname":"Better me","note":"","ucode":"CADF08D357489A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264285,"discussion_content":"å¯¹éé˜»å¡ï¼šç«‹åˆ»è¿”å›ç»“æœæœ‰ç‚¹ç–‘é—®ï¼Œé‚£å¼‚æ­¥éé˜»å¡è¿˜éœ€è¦æ³¨å†Œå›è°ƒå‡½æ•°ç­‰å¾…é€šçŸ¥è¿”å›ç»“æœå—ï¼Ÿè¿™æ ·çœ‹æ³¨å†Œå›è°ƒå‡½æ•°æ˜¯ä¸æ˜¯æ˜¾å¾—å¾ˆå¤šä½™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589296889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1446375,"avatar":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","nickname":"bookå°¾æ±","note":"","ucode":"AE2B8DFC643ACC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1261959,"avatar":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","nickname":"Better me","note":"","ucode":"CADF08D357489A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":264402,"discussion_content":"é¢ï¼Œæˆ‘è¯´çš„éé˜»å¡ç«‹åˆ»è¿”å›ç»“æœæ˜¯æŒ‡è¿™æ¬¡ç³»ç»Ÿè°ƒç”¨çš„ç»“æœï¼Œæ­¤æ—¶ä¸ä¸€å®šæœ‰æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®å°±ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œéœ€è¦è°ƒç”¨è€…æ¥åšå‡ºåˆ¤æ–­æ˜¯å¦é‡è¯•ï¼Œå¼‚æ­¥éé˜»å¡æ˜¯æ³¨å†Œå®Œå›è°ƒå‡½æ•°åï¼Œç³»ç»Ÿè°ƒç”¨ç«‹åˆ»è¿”å›ç”¨æˆ·æ€å‡½æ•°ï¼Œæˆ‘æ˜¯è¿™æ ·ç†è§£çš„çº¿ç¨‹ä¹Ÿå°±æ˜¯ä¸€ä¸ªtaskstructç»“æ„é‡Œé¢æœ‰çº¿ç¨‹å¯¹åº”çš„çº¿ç¨‹æ ˆä»¥åŠå†…æ ¸æ ˆï¼Œçº¿ç¨‹è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå¦‚æœæ˜¯é˜»å¡çš„ioè°ƒç”¨é‚£ä¹ˆæ­¤æ—¶è¯¥çº¿ç¨‹ä¼šscheduleè¢«æŒ‚èµ·ï¼Œå°†CPUè®©ç»™å…¶ä»–ç¨‹åºç­‰åˆ°ioæ»¡è¶³æ—¶ä¼šå°†è¯¥çº¿ç¨‹æ ‡è®°ä¸ºrunningçŠ¶æ€æ”¾åˆ°è°ƒåº¦é˜Ÿåˆ—é‡Œï¼Œç­‰åˆ°è¯¥çº¿ç¨‹è·å¾—cpuæ—¶ä¼šä»å†…æ ¸æ€è¿”å›åˆ°ç”¨æˆ·æ€ï¼Œä»æŒ‚èµ·åˆ°å†æ¬¡è·å¾—cpuè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯è¢«é˜»å¡çš„ï¼Œç„¶åå¦‚æœæ˜¯éé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨é‚£ä¹ˆçº¿ç¨‹è¿›å…¥å†…æ ¸æ€çš„å‡½æ•°æ ˆç»è¿‡å±‚å±‚è°ƒç”¨æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªç»“æœï¼Œæ­¤æ—¶ç«‹åˆ»è¿”å›ç”¨æˆ·æ€çš„å‡½æ•°æ ˆï¼Œè¿™æ ·çº¿ç¨‹å°±ä¸ä¼šé˜»å¡äº†ï¼Œå¼‚æ­¥ioæˆ‘ä¹Ÿä¸å¤ªç†è§£è€å¸ˆå›¾ä¸­è¯´çš„é‚£ä¸ªå‘å¼‚æ­¥æ¡†æ¶æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œæˆ‘çš„ç†è§£æ˜¯çº¿ç¨‹è°ƒç”¨äº†å¼‚æ­¥æ¡†æ¶çš„å‡½æ•°ï¼Œç”±å¼‚æ­¥æ¡†æ¶å‘å†…æ ¸æ³¨å†Œå¤„ç†å‡½æ•°ï¼Œæ³¨å†Œä½¿ç”¨çš„æ˜¯éé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨è¿™æ ·å°±èƒ½ç«‹åˆ»è¿”å›ç»“æœï¼Œè€Œç³»ç»Ÿè°ƒç”¨è¿”å›åè¿›å…¥çš„æ˜¯å¼‚æ­¥æ¡†æ¶å‡½æ•°çš„å¤„ç†é€»è¾‘ï¼Œè¿™é‡Œé¢å¯èƒ½ä¼šåˆ‡æ¢åˆ°åˆ«çš„è¯·æ±‚çš„ä¸Šä¸‹æ–‡å»ï¼Œè¿™æ ·å°±å®Œæˆäº†ç”¨æˆ·æ€çš„å‡½æ•°åˆ‡æ¢ï¼Œå¦‚æœæ˜¯å¼‚æ­¥é˜»å¡çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªtaskstructå°±ä¼šè¢«scheduleï¼Œè®©å‡ºcpuï¼Œçº¿ç¨‹ä¼šè¢«ç½®ä¸ºsleepingçŠ¶æ€ï¼Œç­‰åˆ°ioæ»¡è¶³æ—¶ï¼Œå½“è¿™ä¸ªçº¿ç¨‹è·å¾—cpuæ—¶ä¼šä»ç³»ç»Ÿè°ƒç”¨è¿”å›åˆ°å¼‚æ­¥æ¡†æ¶çš„å‡½æ•°ï¼Œå°±è¿›å…¥äº†å¼‚æ­¥æ¡†æ¶å¤„ç†å‡½æ•°çš„é€»è¾‘äº†ï¼Œä½†å› ä¸ºç³»ç»Ÿè°ƒç”¨æ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥æ•´ä¸ªçº¿ç¨‹å‡½æ•°ä¼šè¢«é˜»å¡","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589305026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":264285,"ip_address":""},"score":264402,"extra":""},{"author":{"id":1446375,"avatar":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","nickname":"bookå°¾æ±","note":"","ucode":"AE2B8DFC643ACC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1261959,"avatar":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","nickname":"Better me","note":"","ucode":"CADF08D357489A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":264405,"discussion_content":"æ„Ÿè§‰ioæ»¡è¶³æ—¶é€šçŸ¥ä¹Ÿæ˜¯å¼‚æ­¥æ¡†æ¶ï¼Œå¼‚æ­¥æ¡†æ¶åœ¨æ¥å†³å®šä½•æ—¶è°ƒç”¨å¤„ç†å‡½æ•°ï¼Œä¸æ¸…æ¥šå¯ä»¥ç›´æ¥å‘å†…æ ¸æ³¨å†Œioå¤„ç†å‡½æ•°å—ï¼Œæœ‰çŸ¥é“çš„åŒå­¦è¯´ä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589306608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":264285,"ip_address":""},"score":264405,"extra":""}]}]},{"had_liked":false,"id":218305,"user_name":"åˆ†æ¸…äº‘æ·¡","can_delete":false,"product_type":"c1","uid":1269873,"ip_address":"","ucode":"7045AE6BF72D31","user_header":"https://static001.geekbang.org/account/avatar/00/13/60/71/895ee6cf.jpg","comment_is_top":false,"comment_ctime":1589774788,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"78899186116","product_id":100051201,"comment_content":"CPU æä¾›çš„ PAUSE æŒ‡ä»¤ï¼Œå‡å°‘å¾ªç¯ç­‰å¾…æ—¶çš„è€—ç”µé‡---- è¿™ä¸ªå‡å°‘è€—ç”µé‡åªæ˜¯ä¸€ä¸ªå°åŸå› ï¼Œæ›´ä¸»è¦çš„æ˜¯ä¸ºäº†é¿å… cache ping-pong. mysqlçš„innodbåœ¨æŠ¢é”å¤±è´¥åè¿˜å°† pause * innodb_spin_wait_delayï¼ˆä¹Ÿå°±æ˜¯pauseæ›´ä¹…ï¼‰ ï¼Œç„¶åå†å†æ¬¡æŠ¢é”ã€‚ ä¸åŒçš„cpuå‹å· pause çš„æŒ‡ä»¤å‘¨æœŸä¹Ÿä¸ä¸€æ ·ï¼Œè¿™æ ·æ¢äº†cpuçš„è¯ innodbçš„è¿™ç§è®¾è®¡é—®é¢˜å¾ˆå¤§ã€‚","like_count":19},{"had_liked":false,"id":216441,"user_name":"é‚£æ—¶åˆ»","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1589259558,"is_pvip":false,"replies":[{"id":"90965","content":"è°¢è°¢é‚£æ—¶åˆ»çš„åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599813233,"ip_address":"","comment_id":216441,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35948997926","product_id":100051201,"comment_content":"Goé‡Œçš„è‡ªæ—‹é”éœ€è¦è‡ªå·±å®ç°ï¼Œæ–¹ä¾¿åç¨‹è°ƒåº¦ã€‚åç¨‹ä½¿ç”¨è‡ªæ—‹é”çš„æ—¶å€™ï¼Œè¿™æ˜¯spinLock çš„Lockæ–¹æ³•<br><br>for !atomic.CompareAndSwapUint32(sl, 0, 1) {<br>    runtime.Gosched()<br>}<br><br>å…¶ä¸­runtime.Goschedï¼Œæ˜¯æŠŠé˜»å¡çš„åç¨‹è°ƒåº¦å‡ºå»ï¼Œè¿™æ ·è°ƒåº¦å™¨å¯ä»¥æ‰§è¡Œå…¶ä»–åç¨‹ã€‚","like_count":9,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494818,"discussion_content":"è°¢è°¢é‚£æ—¶åˆ»çš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599813233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356589,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLh73kPzAKhz7YxUribqF6QKFiahhVAbwpgVLSRicA68c6ZFA7vUBJY1ves3LVvibrypROyI7awv47eSA/132","nickname":"ZYecho","note":"","ucode":"9D156DD30C581E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269018,"discussion_content":"è¿™ä¹ˆå®ç°æ„Ÿè§‰å¾ˆå¥‡æ€ª ä½ å¯ä»¥çœ‹çœ‹å®˜æ–¹mutexçš„å®ç° ä»–ä¹Ÿæ˜¯å†…éƒ¨åŒ…å«è‡ªæ—‹é”çš„å®ç°ï¼Œä½†æ˜¯è¿™ä¸ªé”ç¡®å®æ˜¯å µå¡çš„ è€Œä¸æ˜¯åˆ‡æ¢èµ°çš„è®©å‡º æˆ‘è§‰å¾—è‡ªæ—‹é”çš„ä½¿ç”¨åœºæ™¯ä¸å°±æ˜¯ä¸´ç•ŒåŒºçŸ­ä¹ˆ è¯·é—®ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„å®ç°å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589857198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1593681,"avatar":"https://static001.geekbang.org/account/avatar/00/18/51/51/381876ab.jpg","nickname":"æ–‡åº·","note":"","ucode":"E1952B9DFB5DF4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1356589,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLh73kPzAKhz7YxUribqF6QKFiahhVAbwpgVLSRicA68c6ZFA7vUBJY1ves3LVvibrypROyI7awv47eSA/132","nickname":"ZYecho","note":"","ucode":"9D156DD30C581E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398795,"discussion_content":"ä¸´ç•ŒåŒºçŸ­çš„é€šè¿‡è‡ªæ—‹å¯ä»¥é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢å¸¦æ¥çš„æ¶ˆè€—ï¼Œå¦‚æœé•¿æ—¶é—´è‡ªæ—‹è·å–ä¸åˆ°é”ä¼šè¿›è¡Œä¼‘çœ çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632842354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":269018,"ip_address":""},"score":398795,"extra":""}]}]},{"had_liked":false,"id":216155,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1589197655,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"31653968727","product_id":100051201,"comment_content":"é¦–å…ˆè¦çŸ¥é“ï¼Œåç¨‹æ˜¯ç”¨æˆ·æ€è¿è¡Œçš„ï¼Œæ‰€ä»¥å‡å°‘å†…æ ¸åˆ‡æ¢ã€‚è€Œè‡ªæ—‹é”å’Œäº’æ–¥é”å…¶å®éƒ½æ˜¯æœ‰å†…æ ¸æ§åˆ¶çº¿ç¨‹çš„è®¿é—®ï¼Œæ‰€ä»¥åç¨‹è‚¯å®šä¸æ˜¯ä½¿ç”¨äº’æ–¥é”Mutexå’Œè‡ªæ—‹é”SpinLockå®ç°çš„ã€‚<br>æˆ‘æƒ³ï¼Œåç¨‹ä¹‹é—´çš„äº’ç›¸åä½œè‚¯å®šä¹Ÿæ˜¯æœ‰ä¸€ç§åå•†æœºåˆ¶ï¼Œä¹‹å‰åœ¨ä¸€ç¯‡åšå®¢çœ‹åˆ°å¥½åƒæ˜¯ä½¿ç”¨yieldå®ç°çš„ï¼Œä»è€Œå…±äº«CPUä½¿ç”¨æƒã€‚","like_count":7,"discussions":[{"author":{"id":1260026,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","nickname":"å®‰æ’","note":"","ucode":"F78CFA9624CAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263579,"discussion_content":"åç¨‹æ˜¯åä½œå¼çš„ï¼Œä¸ä¼šæŠ¢å ï¼Œåªä¼šä¸»åŠ¨è®©å‡ºï¼Œæ‰€ä»¥ä¸€èˆ¬åç¨‹éƒ½æ˜¯ç”¨åœ¨IOå¯†é›†å‹åœºæ™¯ï¼Œå‘èµ·IOæ“ä½œæ—¶ï¼Œå°±ä¼š&#34;é˜»å¡&#34;ï¼Œä¸»åŠ¨è®©å‡ºï¼Œæ‰€ä»¥åç¨‹åº“è¦æœ‰èƒ½æ‹¦æˆªè¿™äº›IOæ“ä½œapiçš„èƒ½åŠ›ï¼Œä¸èƒ½è®©æ“ä½œç³»ç»Ÿå»æ‹¦æˆªï¼Œå¦åˆ™æ•´ä¸ªçº¿ç¨‹å°±æŒ‚èµ·äº†ã€‚å…·ä½“å®ç°ç»†èŠ‚åº”è¯¥å¾ˆå¤šå‘ï¼Œæˆ‘ä¹Ÿæ²¡è¯»è¿‡å…·ä½“çš„åº“ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1589212206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362866,"discussion_content":"è‡ªç’‡é”ä¹Ÿæ˜¯å†…æ ¸æ§åˆ¶è®¿é—®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617065887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216348,"user_name":"myrfy","can_delete":false,"product_type":"c1","uid":1169401,"ip_address":"","ucode":"2814BAE5D70098","user_header":"","comment_is_top":false,"comment_ctime":1589245366,"is_pvip":false,"replies":[{"id":"90964","content":"ä½ å¥½myrfyï¼Œè°¢è°¢ä½ çš„æé†’ï¼Œè¿™é‡Œç¡®å®æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šã€‚åç¨‹ç”¨æˆ·æ€æ˜¯ä¸ä¼šç”¨åˆ°è‡ªæ—‹é”çš„ï¼Œåç¨‹æ¡†æ¶çš„é”å¸¸ç”¨CASå‡½æ•°å®ç°ï¼Œå½“æ—¶æƒ³è¡¨è¾¾æ˜¯è¿™ä¸ªæ„æ€ï¼Œè¿™é‡Œç¡®å®ä¼šè®©äººè¯¯è§£ï¼Œæˆ‘é©¬ä¸Šè”ç³»ç¼–è¾‘ä¿®æ”¹ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599812670,"ip_address":"","comment_id":216348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23064081846","product_id":100051201,"comment_content":"â€œè‡ªæ—‹é”å¼€é”€å°‘ï¼Œåœ¨å¤šæ ¸ç³»ç»Ÿä¸‹ä¸€èˆ¬ä¸ä¼šä¸»åŠ¨äº§ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œå¾ˆé€‚åˆå¼‚æ­¥ã€åç¨‹ç­‰åœ¨ç”¨æˆ·æ€åˆ‡æ¢è¯·æ±‚çš„ç¼–ç¨‹æ–¹å¼ï¼Œæœ‰åŠ©äºé«˜å¹¶å‘æœåŠ¡å……åˆ†åˆ©ç”¨å¤šé¢— CPUã€‚â€œ<br><br>è¿™æ®µæè¿°æ˜¯ä¸æ˜¯ä¸å¤ªå‡†ç¡®ï¼Ÿåç¨‹åœ¨ç”¨æˆ·æ€ç”±åç¨‹æ¡†æ¶è°ƒåº¦ï¼Œè‡ªæ—‹é”åªä¼šé˜»å¡å½“å‰åç¨‹ï¼Œå¯¼è‡´å…¶ä»–åç¨‹ä¸èƒ½è·å¾—æ‰§è¡Œæƒã€‚<br><br>åç¨‹æ¡†æ¶ä¸‹çš„sleepç­‰å‡½æ•°ï¼Œéƒ½æ˜¯æ¡†æ¶æä¾›çš„è€Œä¸æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œå…¶å·¥ä½œåŸç†æ˜¯å°†å½“å‰åç¨‹çš„å”¤é†’æ—¶é—´å‘ŠçŸ¥åç¨‹æ¡†æ¶è°ƒåº¦å™¨åä¸»åŠ¨è®©å‡ºå½“å‰åç¨‹ï¼Œè®©å…¶ä»–åç¨‹æœ‰æœºä¼šè¿è¡Œï¼Œå½“æ¯ä¸€ä¸ªåç¨‹å‘ç”Ÿä¸»åŠ¨åˆ‡æ¢æ—¶ï¼Œåç¨‹æ¡†æ¶ä¼šæ£€æµ‹æ˜¯å¦æœ‰ç­‰å¾…å”¤é†’çš„åç¨‹ï¼Œè‹¥æœ‰åˆ™ä¼šæŒ‰ç…§ä¸€å®šçš„ç­–ç•¥å”¤é†’ç¡çœ çš„åç¨‹ã€‚<br>","like_count":5,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494786,"discussion_content":"ä½ å¥½myrfyï¼Œè°¢è°¢ä½ çš„æé†’ï¼Œè¿™é‡Œç¡®å®æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šã€‚åç¨‹ç”¨æˆ·æ€æ˜¯ä¸ä¼šç”¨åˆ°è‡ªæ—‹é”çš„ï¼Œåç¨‹æ¡†æ¶çš„é”å¸¸ç”¨CASå‡½æ•°å®ç°ï¼Œå½“æ—¶æƒ³è¡¨è¾¾æ˜¯è¿™ä¸ªæ„æ€ï¼Œè¿™é‡Œç¡®å®ä¼šè®©äººè¯¯è§£ï¼Œæˆ‘é©¬ä¸Šè”ç³»ç¼–è¾‘ä¿®æ”¹ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599812670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239570,"user_name":"abc","can_delete":false,"product_type":"c1","uid":1669811,"ip_address":"","ucode":"F043D17A5586F1","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK7zFlGjbeoWQjkTkOic6vWu0dXCudEia7GbyTpLuKfTj3sqCib1tIAqqx526ZzzKniauVghHDZTpCZFQ/132","comment_is_top":false,"comment_ctime":1596590073,"is_pvip":false,"replies":[{"id":"88717","content":"æ·±åº¦ä¼˜åŒ–é€šå¸¸éƒ½ä¸ä¸šåŠ¡å¼ºç›¸å…³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“å¤šä¸ªçº¿ç¨‹æ˜¯åŸºäºèŒƒå›´ï¼ˆéäº‰æŠ¢ï¼‰æ¶ˆè´¹æ•°æ®æ—¶ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ï¼ˆæˆ–è€…å°±è®¾è®¡æˆè¿™æ ·ï¼‰æ¯ä¸ªçº¿ç¨‹åªå¤„ç†æ•°ç»„ä¸­çš„éƒ¨åˆ†æ•°æ®ï¼Œçº¿ç¨‹é—´äº’ç›¸ä¸é‡åˆï¼Œè¿™æ ·å°±æ— é¡»åŠ é”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1596843232,"ip_address":"","comment_id":239570,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18776459257","product_id":100051201,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼Œå°±æ˜¯å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡Œè¯»å†™ï¼Œé™¤äº†åŠ é”ä¹‹å¤–ï¼Œæ€ä¹ˆæ·±åº¦ä¼˜åŒ–å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503143,"discussion_content":"æ·±åº¦ä¼˜åŒ–é€šå¸¸éƒ½ä¸ä¸šåŠ¡å¼ºç›¸å…³ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“å¤šä¸ªçº¿ç¨‹æ˜¯åŸºäºèŒƒå›´ï¼ˆéäº‰æŠ¢ï¼‰æ¶ˆè´¹æ•°æ®æ—¶ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ï¼ˆæˆ–è€…å°±è®¾è®¡æˆè¿™æ ·ï¼‰æ¯ä¸ªçº¿ç¨‹åªå¤„ç†æ•°ç»„ä¸­çš„éƒ¨åˆ†æ•°æ®ï¼Œçº¿ç¨‹é—´äº’ç›¸ä¸é‡åˆï¼Œè¿™æ ·å°±æ— é¡»åŠ é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596843232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1669811,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK7zFlGjbeoWQjkTkOic6vWu0dXCudEia7GbyTpLuKfTj3sqCib1tIAqqx526ZzzKniauVghHDZTpCZFQ/132","nickname":"abc","note":"","ucode":"F043D17A5586F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297591,"discussion_content":"è°¢è°¢è€å¸ˆï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596979525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222065,"user_name":"fancion","can_delete":false,"product_type":"c1","uid":1121584,"ip_address":"","ucode":"9000895F6BE0E4","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/30/4a82c7af.jpg","comment_is_top":false,"comment_ctime":1590668307,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18770537491","product_id":100051201,"comment_content":"åç¨‹çš„å®ç°ä¸æ˜¯é”å§ã€‚æ˜¯æ¶ˆæ¯é©±åŠ¨æ’é˜Ÿå¤„ç†çš„å§ï¼ŒåŸºäºakkaæ€æƒ³","like_count":4},{"had_liked":false,"id":215978,"user_name":"å­™å¿—å¼º","can_delete":false,"product_type":"c1","uid":1325997,"ip_address":"","ucode":"9C070F1E4EC6FF","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/ad/31193b83.jpg","comment_is_top":false,"comment_ctime":1589162325,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"18769031509","product_id":100051201,"comment_content":"ä¸€ç›´ä»¥ä¸ºCASæ˜¯ä¹è§‚é”","like_count":4,"discussions":[{"author":{"id":1048433,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ff/71/c492b7fa.jpg","nickname":"æ¥","note":"","ucode":"2612C1D888ED03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293975,"discussion_content":"CASæ›´åƒæ˜¯ä¸€ç§æ€æƒ³ï¼Œä¸€ç§ç®—æ³•ï¼Œåœ¨æ›´æ–°çš„æ—¶å€™åªæœ‰æ¡ä»¶ä¸­çš„å€¼å’ŒåŸå€¼ç›¸ç­‰æ‰æ›´æ–°æˆåŠŸï¼Œå¦åˆ™æ›´æ–°ä¸æˆåŠŸã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595749902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215934,"user_name":"é™ˆæ”¿ç’‹","can_delete":false,"product_type":"c1","uid":1220034,"ip_address":"","ucode":"168857D7414E5C","user_header":"https://static001.geekbang.org/account/avatar/00/12/9d/c2/d35f89b0.jpg","comment_is_top":false,"comment_ctime":1589155676,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14474057564","product_id":100051201,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæ–‡ä¸­å¼€å¤´æåˆ°å¿…é¡»å¼„æ¸…åŠ é”æˆæœ¬ä»¥åŠé”å‘ç”Ÿæ¦‚ç‡ï¼Œæœ‰æ²¡æœ‰å¯ä»¥é‡åŒ–çš„æ–¹æ³•æˆ–è€…å·¥å…·å‘¢ï¼Ÿ","like_count":3},{"had_liked":false,"id":219067,"user_name":"Robust","can_delete":false,"product_type":"c1","uid":1113088,"ip_address":"","ucode":"79EA73E325945E","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/00/50b5cb51.jpg","comment_is_top":false,"comment_ctime":1589938989,"is_pvip":false,"replies":[{"id":"81096","content":"ç®—ï¼Œéœ€è¦äº‹å…ˆæ‹¿åˆ°é”æ‰èƒ½ä¿®æ”¹æ•°æ®çš„éƒ½ç®—","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1590059834,"ip_address":"","comment_id":219067,"utype":1}],"discussion_count":5,"race_medal":0,"score":"10179873581","product_id":100051201,"comment_content":"è‡ªæ—‹é”å±äºæ‚²è§‚é”å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495669,"discussion_content":"ç®—ï¼Œéœ€è¦äº‹å…ˆæ‹¿åˆ°é”æ‰èƒ½ä¿®æ”¹æ•°æ®çš„éƒ½ç®—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590059834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130666,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/aa/49bbb007.jpg","nickname":"Ğ½Ã¡Ğ¿ã®ã‚›","note":"","ucode":"834FA877EFBAF7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277651,"discussion_content":"é¢è¯•åˆšå¥½é—®åˆ°ä¹è§‚é”å’Œæ‚²è§‚é”ï¼ŒæŒ‰è€å¸ˆè¯´çš„äº’æ–¥é”å’Œè‡ªæ—‹é”éƒ½æ˜¯æ‚²è§‚é”ï¼Œé¢è¯•å®˜å¥½åƒä¸è®¤åŒã€‚ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591086560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068361,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","nickname":"æ˜ç¿¼","note":"","ucode":"E77F86BEB3D5C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344609,"discussion_content":"æˆ‘ä¸€ç›´è®¤ä¸ºè‡ªç’‡é”æ˜¯å±äºä¹è§‚é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611536459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461264,"avatar":"","nickname":"InfoQ_e8fa90f8b254","note":"","ucode":"048C487477F0AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293369,"discussion_content":"ä¸€å¼€å§‹å°±è®¤ä¸ºæ•°æ®ä¸å®‰å…¨ï¼Œè¦æ‹¿åˆ°é”æ‰èƒ½æ‰§è¡Œæ˜¯æ‚²è§‚é”ï¼Œè€Œå¼€å§‹è®¤ä¸ºæ•°æ®æ˜¯å®‰å…¨çš„ï¼Œå°è¯•æ‰§è¡Œå±äºä¹è§‚é”ï¼Œè¿™æ ·çœ‹ï¼Œè‡ªæ—‹å±äºä¹è§‚é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595512345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285826,"discussion_content":"åŸæ¥æ˜¯è¿™ä¹ˆå®šä¹‰æ‚²è§‚é”çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592963422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216016,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1589168292,"is_pvip":false,"replies":[{"id":"90971","content":"æ“ä½œå…±äº«èµ„æºçš„ä»£ç æ®µéƒ½è¦åŠ é”","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599814561,"ip_address":"","comment_id":216016,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10179102884","product_id":100051201,"comment_content":"åç¨‹æœ‰äº›æ“ä½œæ˜¯ä½¿ç”¨çº¿ç¨‹æ± æ¥å®ç°çš„ï¼Œéœ€è¦åŠ é”","like_count":2,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494638,"discussion_content":"æ“ä½œå…±äº«èµ„æºçš„ä»£ç æ®µéƒ½è¦åŠ é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599814561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218441,"user_name":"èŒƒé—²","can_delete":false,"product_type":"c1","uid":1073125,"ip_address":"","ucode":"F21FD7DF6BA53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg","comment_is_top":false,"comment_ctime":1589802359,"is_pvip":false,"replies":[{"id":"80913","content":"ä½ å¥½èŒƒé—²ï¼Œå¾ˆä¹…ä»¥å‰è¿½è¿‡åº†ä½™å¹´è¿™éƒ¨å°è¯´ï¼Œå¥½ç†Ÿçš„åå­—ã€‚<br>æ˜¯çš„ï¼Œç”¨æˆ·æ€åç¨‹éœ€è¦ç”¨æˆ·æ€çš„ä»£ç ï¼Œå°†é”é‡æ–°å®ç°ä¸€éï¼Œå…¶ä¸­å®ç°æ—¶ä¸èƒ½ç”¨åˆ°å†…æ ¸æä¾›çš„ç³»ç»Ÿè°ƒç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1589935566,"ip_address":"","comment_id":218441,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5884769655","product_id":100051201,"comment_content":"ç”¨æˆ·æ€çš„åç¨‹ä¸èƒ½ç”¨äº’æ–¥æˆ–è€…è‡ªæ—‹ï¼Œä¼šè¿›å…¥å†…æ ¸æ€ä¸å…¶è®¾è®¡åˆè¡·ç›¸æ‚–ã€‚Pythoné‡Œé¢ç”¨çš„yield","like_count":1,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495458,"discussion_content":"ä½ å¥½èŒƒé—²ï¼Œå¾ˆä¹…ä»¥å‰è¿½è¿‡åº†ä½™å¹´è¿™éƒ¨å°è¯´ï¼Œå¥½ç†Ÿçš„åå­—ã€‚\næ˜¯çš„ï¼Œç”¨æˆ·æ€åç¨‹éœ€è¦ç”¨æˆ·æ€çš„ä»£ç ï¼Œå°†é”é‡æ–°å®ç°ä¸€éï¼Œå…¶ä¸­å®ç°æ—¶ä¸èƒ½ç”¨åˆ°å†…æ ¸æä¾›çš„ç³»ç»Ÿè°ƒç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589935566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216706,"user_name":"è€Œç«‹æ–‹","can_delete":false,"product_type":"c1","uid":1087258,"ip_address":"","ucode":"5FED6E9E148195","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/1a/389eab84.jpg","comment_is_top":false,"comment_ctime":1589330788,"is_pvip":false,"replies":[{"id":"90927","content":"^_^","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1599786427,"ip_address":"","comment_id":216706,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5884298084","product_id":100051201,"comment_content":"çœ‹çš„å¾ˆå¸¦åŠ²ï¼Œå°±å¥½åƒåƒäº†ä¸ªç¾å¦™çš„è¥¿ç“œã€‚","like_count":1,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494920,"discussion_content":"^_^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599786427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341339,"user_name":"å‡Œäº‘","can_delete":false,"product_type":"c1","uid":2677952,"ip_address":"","ucode":"069BE53EBA8BF7","user_header":"https://static001.geekbang.org/account/avatar/00/28/dc/c0/64bc9673.jpg","comment_is_top":false,"comment_ctime":1649556980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649556980","product_id":100051201,"comment_content":"å½“å¹¶å‘è®¿é—®å…±äº«èµ„æºï¼Œå†²çªæ¦‚ç‡éå¸¸ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ— é”ç¼–ç¨‹ã€‚ä½†æ˜¯ç”Ÿäº§ä¸Šå¦‚ä½•è¯„ä¼°å†²çªæ¦‚ç‡ï¼Ÿæ˜¯æ ¹æ®å¹¶å‘é‡è¯„ä¼°ï¼Œè¿˜æ˜¯æ ¹æ®ä»€ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":340458,"user_name":"è‚¥low","can_delete":false,"product_type":"c1","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1648822099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648822099","product_id":100051201,"comment_content":"æˆ‘çŒœåç¨‹è‚¯å®šæ˜¯è¦ç”¨è‡ªæ—‹é”çš„ï¼Œå› ä¸ºç”¨äº’æ–¥é”ä¸å°±è¿èƒŒåç¨‹çš„åˆè¡·äº†å˜›","like_count":0},{"had_liked":false,"id":320953,"user_name":"ææ²›éœ–-ç¨‹åºçŒ¿","can_delete":false,"product_type":"c1","uid":1063957,"ip_address":"","ucode":"10CF0DBED2D220","user_header":"https://static001.geekbang.org/account/avatar/00/10/3c/15/71a2aca9.jpg","comment_is_top":false,"comment_ctime":1636596435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636596435","product_id":100051201,"comment_content":"é”çš„è¿›å…¥ä¸´ç•ŒåŒºè¦åŸå­ã€‚åœ¨ä¸´ç•ŒåŒºæ€ä¹ˆæ“ä½œå°±è‡ªç”±äº†ã€‚","like_count":0},{"had_liked":false,"id":286021,"user_name":"åŒ—æçš„å¤§ä¼é¹…","can_delete":false,"product_type":"c1","uid":1045577,"ip_address":"","ucode":"8935346D08E109","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f4/49/2add4f6b.jpg","comment_is_top":false,"comment_ctime":1617108833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617108833","product_id":100051201,"comment_content":"å…±äº«æ–‡æ¡£åŸæ¥å¦‚æ­¤","like_count":0},{"had_liked":false,"id":230993,"user_name":"æ¢ç´¢æ— æ­¢å¢ƒ","can_delete":false,"product_type":"c1","uid":1044178,"ip_address":"","ucode":"91D2A9907DFA79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/d2/7024431c.jpg","comment_is_top":false,"comment_ctime":1593561800,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593561800","product_id":100051201,"comment_content":"è‡ªæ—‹é”æ˜¯å› ä¸ºéœ€è¦æ‹¿åˆ°é”æ‰èƒ½å·¥ä½œï¼Œæ‰€ä»¥æ˜¯ä¸€ç§æ‚²è§‚é”ï¼Œä½†é‡Œé¢çš„CASæŒ‡ä»¤åº”è¯¥æ˜¯ä¸€ç§ä¹è§‚é”çš„å®ç°æ–¹å¼ï¼Œè¿™ä¹ˆç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿ","like_count":0},{"had_liked":false,"id":229142,"user_name":"æˆ˜æ–—æœºäºŒè™ğŸ¯","can_delete":false,"product_type":"c1","uid":1157201,"ip_address":"","ucode":"8AB69AD2D76784","user_header":"https://static001.geekbang.org/account/avatar/00/11/a8/51/46a788b1.jpg","comment_is_top":false,"comment_ctime":1592906311,"is_pvip":false,"replies":[{"id":"84588","content":"æ²¡é”™^_^","user_name":"ä½œè€…å›å¤","user_name_real":"é™¶è¾‰","uid":"1283912","ctime":1592956525,"ip_address":"","comment_id":229142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592906311","product_id":100051201,"comment_content":"å‘ç°è¿™æ®µè‡ªæ—‹é”ä»£ç ç”¨çš„nginxçš„å®ç°ğŸ˜","like_count":0,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499351,"discussion_content":"æ²¡é”™^_^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592956525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217075,"user_name":"å°ä¸€æ—¥ä¸€","can_delete":false,"product_type":"c1","uid":1301097,"ip_address":"","ucode":"0A506C2B918C14","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtVXiaJbfkpeXH4udkPUIlFte7z3HWMebdogk8jFpgFEkJ0ruGiawUMUcZj9RLpLkIWxV7QOzbHoSg/132","comment_is_top":false,"comment_ctime":1589417222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589417222","product_id":100051201,"comment_content":"å½“å¹¶å‘è®¿é—®å…±äº«èµ„æºï¼Œå†²çªæ¦‚ç‡éå¸¸ä½çš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©æ— é”ç¼–ç¨‹ã€‚<br><br>å¤šä½ç®—éå¸¸ä½ï¼Ÿèƒ½å¦ç»™å‡ºä¸ªç»éªŒå€¼ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":216682,"user_name":"åˆ˜è€³æ€»","can_delete":false,"product_type":"c1","uid":1271724,"ip_address":"","ucode":"6D157E6E960075","user_header":"https://static001.geekbang.org/account/avatar/00/13/67/ac/af895343.jpg","comment_is_top":false,"comment_ctime":1589328742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589328742","product_id":100051201,"comment_content":"åœ¨Pythoné‡Œçš„åç¨‹await db call è¿™ç§åº”è¯¥ç®—æ˜¯å¼‚æ­¥é˜»å¡å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":216648,"user_name":"é˜¿é¼","can_delete":false,"product_type":"c1","uid":1042634,"ip_address":"","ucode":"EE763513563F50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/ca/2a7cc193.jpg","comment_is_top":false,"comment_ctime":1589301086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589301086","product_id":100051201,"comment_content":"è¯·é—®è€å¸ˆ<br>1ï¼ŒWindowsä¸‹çš„ä¸´ç•ŒåŒºï¼Œå…ˆè‡ªæ—‹ï¼Œå†äº’æ–¥ï¼Œè¿™æ˜¯æœ€ä½³å®è·µå—ï¼Ÿ<br>2ï¼Œæ— é”é˜Ÿåˆ—ï¼Œè™½ç„¶é˜Ÿåˆ—æœ¬èº«ä½¿ç”¨casï¼Œä½†é˜Ÿåˆ—çš„å‹å…¥äº‹ä»¶æ˜¯ä¸æ˜¯è¿˜éœ€è¦æ¡ä»¶å˜é‡+é”ã€‚","like_count":0},{"had_liked":false,"id":216334,"user_name":"å°å–µå–µ","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1589244016,"is_pvip":false,"replies":[{"id":"90958","content":"ä¸»è¦æ˜¯ä¸ºäº†æå‡æ€§èƒ½ï¼Œå½“åœºæ™¯ä¸åŒæ—¶ï¼Œç‰¹åˆ«æ˜¯åŠ ã€è§£é”çš„æˆæœ¬ä¸åŒï¼Œé”è°ƒç”¨çš„é¢‘ç‡ä¸åŒæ—¶ï¼Œæ¢æŠŠåˆé€‚çš„é”å¯ä»¥æå‡å¾ˆå¤§æ€§èƒ½","user_name":"ä½œè€…å›å¤","comment_id":216334,"uid":"1283912","ip_address":"","utype":1,"ctime":1599811148,"user_name_real":"é™¶è¾‰"}],"discussion_count":1,"race_medal":0,"score":"1589244016","product_id":100051201,"comment_content":"è€å¸ˆï¼Œé”ä¸ºä»€ä¹ˆåˆ†ç±»é‚£ä¹ˆå¤šï¼Œæ˜¯ä»å“ªäº›ç»´åº¦æ¥åˆ†çš„ï¼Œæ¯”å¦‚ä»æ•°æ®åº“æ¥åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºæ‚²è§‚å’Œä¹è§‚é”ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™ä¹ˆåˆ†ç±»å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494780,"discussion_content":"ä¸»è¦æ˜¯ä¸ºäº†æå‡æ€§èƒ½ï¼Œå½“åœºæ™¯ä¸åŒæ—¶ï¼Œç‰¹åˆ«æ˜¯åŠ ã€è§£é”çš„æˆæœ¬ä¸åŒï¼Œé”è°ƒç”¨çš„é¢‘ç‡ä¸åŒæ—¶ï¼Œæ¢æŠŠåˆé€‚çš„é”å¯ä»¥æå‡å¾ˆå¤§æ€§èƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599811148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216278,"user_name":"bookå°¾æ±","can_delete":false,"product_type":"c1","uid":1446375,"ip_address":"","ucode":"AE2B8DFC643ACC","user_header":"https://static001.geekbang.org/account/avatar/00/16/11/e7/044a9a6c.jpg","comment_is_top":false,"comment_ctime":1589213540,"is_pvip":true,"replies":[{"id":"90957","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","comment_id":216278,"uid":"1283912","ip_address":"","utype":1,"ctime":1599811037,"user_name_real":"é™¶è¾‰"}],"discussion_count":1,"race_medal":0,"score":"1589213540","product_id":100051201,"comment_content":"è€å¸ˆæ–‡ä¸­æåˆ°è‡ªæ—‹é”é€šè¿‡åœ¨ç”¨æˆ·æ€æ¥å®ç°è§‚å¯Ÿé”åŠ é”è§£é”çš„æ“ä½œ,æ„Ÿè§‰åç¨‹ä¸­çš„é”å¯ä»¥é€šè¿‡CASå‡½æ•°æ¥å®ç°,å¦‚æœè·å–é”å¤±è´¥åˆ™è¿›è¡Œåç¨‹çš„åˆ‡æ¢.","like_count":0,"discussions":[{"author":{"id":1283912,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/48/550271b0.jpg","nickname":"é™¶è¾‰","note":"","ucode":"F81A9087435953","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494747,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599811037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215939,"user_name":"å®‰æ’","can_delete":false,"product_type":"c1","uid":1260026,"ip_address":"","ucode":"F78CFA9624CAEF","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg","comment_is_top":false,"comment_ctime":1589156355,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589156355","product_id":100051201,"comment_content":"åœ¨çº¿ç¨‹ç«äº‰ä¸æ¿€çƒˆçš„æƒ…å†µä¸‹ä¹è§‚é”casæ•ˆç‡æ‰ä¼šé«˜ï¼Œè€Œä¸”caså­˜åœ¨ABAé—®é¢˜ï¼Œä¸è¿‡ç±»ä¼¼æ–‡ä¸­çš„CAS(lock, 0, pid)å¦‚æœä¿è¯pidå”¯ä¸€ï¼Œåˆ™ä¸å­˜åœ¨ABAé—®é¢˜ã€‚<br>è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œè¿™é‡Œçš„pidä»£è¡¨çš„è¿™ä¸ªæ•°å¯ä»¥æ˜¯ä»»æ„å®½åº¦çš„å—ï¼Ÿæˆ‘çœ‹æœ‰çš„è§£å†³ABAé—®é¢˜çš„æ–¹æ¡ˆæ˜¯åŠ ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªå…·ä½“æ€ä¹ˆå®ç°å‘¢ï¼Ÿæœ‰æ²¡æœ‰demoå‚è€ƒï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1147453,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","nickname":"å¿†æ°´å¯’","note":"","ucode":"E3F86BD8AA8903","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263305,"discussion_content":"æ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªtidå€¼ï¼Œè¿™æ˜¯ä¸€ä¸ªuint32ç±»å‹çš„æ•°å­—ï¼Œåœ¨linuxä¸­ä½¿ç”¨pthread_self() è¿™æ ·çš„syscallè·å–åˆ°ç°åœºtidï¼Œè¿™ä¸ªtidå¯ä»¥ä¿è¯åœ¨è¿›ç¨‹å†…å”¯ä¸€çš„ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589197850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}