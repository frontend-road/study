{"id":546594,"title":"23ï½œè§†é¢‘ï¼šä¸­çº§ç¯‡å®æ“æ€»ç»“","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Chronoã€‚</p><p>åˆ°ä»Šå¤©æˆ‘ä»¬â€œä¸­çº§ç¯‡â€çš„å­¦ä¹ ä¹Ÿå‘Šä¸€æ®µè½äº†ï¼Œåœ¨è¿™æ®µæ—¶é—´é‡Œæˆ‘ä»¬ä½¿ç”¨kubeadmæ­å»ºäº†æ›´æ¥è¿‘ç”Ÿäº§ç¯å¢ƒçš„å¤šèŠ‚ç‚¹Kubernetesé›†ç¾¤ï¼Œç„¶åå­¦ä¹ äº†Deploymentã€DaemonSetã€Serviceã€Ingressè¿™4ä¸ªéå¸¸é‡è¦çš„APIå¯¹è±¡ã€‚</p><p>è¿™èŠ‚è¯¾ä½œä¸ºå¯¹â€œä¸­çº§ç¯‡â€çš„æ€»ç»“å’Œå›é¡¾ï¼Œä»ç„¶æ˜¯è§†é¢‘çš„å½¢å¼ï¼ŒæŠŠå‰é¢å‡ èŠ‚è¯¾é‡Œçš„ä¸€äº›æ“ä½œéƒ½å®é™…æ¼”ç¤ºå‡ºæ¥ï¼Œæ–¹ä¾¿ä½ å¯¹ç…§ç€æ“ä½œä¸Šä¸‹æ–‡æ¥å­¦ä¹ ã€‚</p><p>é¦–å…ˆæˆ‘ä¼šå¸¦ä½ çœ‹çœ‹kubeadmæ­å»ºé›†ç¾¤çš„å®Œæ•´è¿‡ç¨‹ï¼Œç„¶åç¼–å†™YAMLæ–‡ä»¶ï¼Œç¤ºèŒƒDeploymentã€DaemonSetã€Serviceã€Ingressç­‰å¯¹è±¡çš„å…·ä½“ç”¨æ³•ï¼Œæœ€åæ˜¯ä½¿ç”¨è¿™äº›å¯¹è±¡æ­å»ºWordPressç½‘ç«™ã€‚</p><p>è®©æˆ‘ä»¬å¼€å§‹è§†é¢‘è¯¾ç¨‹çš„å­¦ä¹ å§ã€‚</p><blockquote>\n<p>ä¸€ç‚¹è¯´æ˜ï¼šè§†é¢‘æ˜¯æˆ‘çš„æ“ä½œå®å½•ï¼Œæœ‰äº›åŒ…å®‰è£…æ¯”è¾ƒæ…¢ï¼Œå±å¹•ä¼šå‡ ç§’æ²¡æœ‰åŠ¨ä½œï¼Œåœ¨å‚è€ƒè§†é¢‘ä»¥åŠä½ è‡ªå·±æ“ä½œçš„æ—¶å€™å¯ä»¥è€å¿ƒä¸€äº›ã€‚</p>\n</blockquote><hr><h3>ä¸€. å®‰è£…kubeadm</h3><p><video poster=\"https://static001.geekbang.org/resource/image/c2/8e/c23970e32376837de1b072c4555cb08e.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5913313c-1825d5d7497-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/888a2275349f4051bf8cfb1138b3ab1f/7e9d11d81324427e96e54a6cce390a1b-90aa725fd1bd9ed09cac0e4931db8160-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>æˆ‘ä»¬å…ˆæ¥å®‰è£…MasterèŠ‚ç‚¹ï¼Œå½“ç„¶åœ¨è¿™ä¹‹å‰ä½ éœ€è¦ä¿è¯å·²ç»å®‰è£…å¥½äº†Dockerï¼ˆå®‰è£…å‚è€ƒ<a href=\"https://time.geekbang.org/column/article/528619\">ç¬¬1è®²</a>ï¼‰ã€‚</p><p>é¦–å…ˆå››æ­¥å‡†å¤‡å·¥ä½œï¼šæ”¹ä¸»æœºåã€æ”¹Dockeré…ç½®ã€æ”¹ç½‘ç»œè®¾ç½®ã€æ”¹äº¤æ¢åˆ†åŒºã€‚</p><p>ä¿®æ”¹ä¸»æœºåï¼ŒæŠŠå®ƒæ”¹æˆ <code>master</code>ï¼š</p><pre><code class=\"language-plain\">sudo vi /etc/hostname\n</code></pre><!-- [[[read_end]]] --><p>ä¿®æ”¹Dockerçš„é…ç½®æ–‡ä»¶ï¼ŒæŠŠcgroupçš„é©±åŠ¨ç¨‹åºæ”¹æˆ <code>systemd</code>ï¼Œç„¶åæ˜¯ä¿®æ”¹iptablesçš„é…ç½®ï¼Œå¯ç”¨ <code>br_netfilter</code> æ¨¡å—ï¼Œè¿˜æœ‰ä¿®æ”¹â€œ<strong>/etc/fstab</strong>â€ï¼Œå…³é—­Linuxçš„swapåˆ†åŒºã€‚</p><p>è¿™äº›æ“ä½œæ­¥éª¤éƒ½å·²ç»åˆ—åœ¨äº†<a href=\"https://time.geekbang.org/column/article/534762\">ç¬¬17è®²</a>é‡Œäº†ï¼Œå› ä¸ºä¸€ä¸ªä¸ªæ–‡ä»¶ä¿®æ”¹å¾ˆéº»çƒ¦ï¼Œæˆ‘å°±å†™äº†ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼ŒæŠŠè¿™äº›æ“ä½œéƒ½è‡ªåŠ¨åŒ–äº†ï¼Œå¤§æ¦‚çœ‹ä¸€ä¸‹ï¼š</p><pre><code class=\"language-plain\">vi prepare.sh\n</code></pre><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¿®æ”¹Dockeré…ç½®æ–‡ä»¶ç„¶åé‡å¯ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ä¿®æ”¹iptablesé…ç½®ï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯å…³é—­Linuxçš„swapåˆ†åŒºã€‚æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå®‰è£…çš„å‡†å¤‡å·¥ä½œå°±åšå¥½äº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä¸‹è½½kubeadmå¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒæ ·æˆ‘ä¹Ÿå†™æˆäº†ä¸€ä¸ªæ–¹ä¾¿çš„è„šæœ¬æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">vi admin.sh\n</code></pre><p>åŸºæœ¬æµç¨‹å’ŒKuberneteså®˜æ–¹æ–‡æ¡£æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ”¹æˆäº†å›½å†…çš„è½¯ä»¶æºã€‚</p><p><strong>æ³¨æ„åœ¨ä½¿ç”¨ <code>apt install</code> çš„æ—¶å€™ï¼Œåº”è¯¥æ˜ç¡®æŒ‡å®šè¦å®‰è£…çš„ç‰ˆæœ¬å·</strong>ï¼Œåƒè¿™é‡Œæˆ‘å°±ä½¿ç”¨çš„æ˜¯Kubernetes 1.23.3ï¼Œå¦‚æœä¸æŒ‡å®šå°±ä¼šä½¿ç”¨å½“å‰çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯1.24ã€‚</p><p>å®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬ç”¨ <code>kubeadm version</code>ã€<code>kubectl version</code> æ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼š</p><pre><code class=\"language-plain\">kubeadm version\nkubectl version --client\n</code></pre><p>å¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯å®‰è£…äº†æˆ‘ä»¬åˆšæ‰æŒ‡å®šçš„1.23.3ç‰ˆæœ¬ã€‚</p><hr><h3>äºŒ. å®‰è£…Kubernetes</h3><p><video poster=\"https://static001.geekbang.org/resource/image/b6/0f/b601796a8374ef1a4b9e131854c4110f.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/1446449d-1825d5d700f-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/62112ae580e240edaf43411e89ec3fd3/015e757de1aa448a95c77c3ded922688-caf54eed1efb8b46dc5dd22ea32a5acd-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>æœ‰äº†kubeadmï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ­£å¼å®‰è£…Kubernetesäº†ã€‚å®‰è£…æ—¶éœ€è¦ä»gcr.ioæ‹‰å–é•œåƒï¼Œæˆ‘è¿™é‡Œä»å›½å†…é•œåƒç½‘ç«™ä¸Šæå‰ä¸‹è½½å¥½äº†é•œåƒï¼Œç»™ä½ çœ‹ä¸€ä¸‹ï¼š</p><pre><code class=\"language-plain\">docker images\n</code></pre><p>è¿™äº›é•œåƒä¸­åŒ…æ‹¬Kubernetesçš„æ ¸å¿ƒç»„ä»¶ï¼Œæ¯”å¦‚etcdã€apiserverã€controller-managerã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥æ‰§è¡Œ <code>kubeadm init</code> åˆå§‹åŒ–MasterèŠ‚ç‚¹ï¼Œçœ‹ä¸€ä¸‹è„šæœ¬æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">vi master.sh\n</code></pre><p>åˆå§‹åŒ–çš„æ—¶å€™æˆ‘ä½¿ç”¨äº†å‚æ•° <code>pod-network-cidr</code> æŒ‡å®šPodçš„IPåœ°å€èŒƒå›´æ˜¯â€œ10.10.0.0/16â€ï¼Œç„¶åKubernetesç‰ˆæœ¬ä¹ŸæŒ‡å®šä½¿ç”¨1.23.3ã€‚</p><p>ä¸ºäº†è®©kubectlåœ¨å®‰è£…å®Œæˆåèƒ½æ­£å¸¸å·¥ä½œï¼Œè„šæœ¬é‡Œè¿˜ä¼šæŠŠKubernetesçš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°å½“å‰ç”¨æˆ·çš„ <code>.kube</code> ç›®å½•ä¸‹ã€‚</p><p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚</p><p>æ³¨æ„MasterèŠ‚ç‚¹åˆå§‹åŒ–å®Œæˆåï¼Œkubeadmä¼šç»™å‡ºä¸€äº›é‡è¦çš„æç¤ºä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯æ‹·è´é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæˆ‘ä»¬å·²ç»åœ¨è„šæœ¬é‡Œåšè¿‡äº†ï¼Œ<strong>å¦ä¸€ä¸ªæ˜¯WorkerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„ <code>kubeadm join</code> å‘½ä»¤ï¼Œä¸€å®šè¦ä¿å­˜å¥½ã€‚æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚k.txtï¼Œç„¶åæŠŠå®ƒå­˜ä¸‹æ¥ã€‚</strong></p><p>æˆ‘ä»¬å†ç”¨ <code>kubectl version</code>ã€<code>kubectl get node</code> æ¥æ£€æŸ¥Kubernetesçš„ç‰ˆæœ¬å’Œé›†ç¾¤çš„èŠ‚ç‚¹çŠ¶æ€äº†ï¼š</p><pre><code class=\"language-plain\">kubectl version\nkubectl get node\n</code></pre><p>MasterèŠ‚ç‚¹çš„çŠ¶æ€æ˜¯â€œNotReadyâ€ï¼Œæ¥ä¸‹æ¥è¿˜è¦å®‰è£…ç½‘ç»œæ’ä»¶Flannelã€‚</p><p>Flannelçš„å®‰è£…å¾ˆç®€å•ï¼Œè®°å¾—è¦ä¿®æ”¹å®ƒçš„YAMLæ–‡ä»¶ï¼Œâ€œ<strong>net-conf.json</strong>â€é‡Œçš„ç½‘ç»œèŒƒå›´å¿…é¡»å’Œ <code>kubeadm init</code> é‡Œçš„ä¸€æ ·ï¼š</p><pre><code class=\"language-plain\">vi flannel.yml\n</code></pre><p>ç°åœ¨æˆ‘ä»¬ç”¨ <code>kubectl apply</code> æ¥å®‰è£…Flannelç½‘ç»œï¼š</p><pre><code class=\"language-plain\">kubectl apply -f kube-flannel.yml\n</code></pre><p>ç¨ç­‰ä¸€å°ä¼šï¼Œæˆ‘ä»¬å†æ‰§è¡Œ <code>kubectl get node</code> æ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼š</p><pre><code class=\"language-plain\">kubectl get node\n</code></pre><p>å°±çœ‹åˆ°MasterèŠ‚ç‚¹çš„çŠ¶æ€æ˜¯â€œReadyâ€ï¼Œè¡¨æ˜èŠ‚ç‚¹ç½‘ç»œä¹Ÿå·¥ä½œæ­£å¸¸äº†ã€‚</p><hr><h3>ä¸‰. Kubernetesé›†ç¾¤éƒ¨ç½²</h3><p><video poster=\"https://static001.geekbang.org/resource/image/05/2c/0535b19a4bebfab55e2f7cb9654ab92c.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/19c4ff78-1825d5d6b2f-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/10836c6754bc42a19164ea2a9c9abc4a/71c83e906331403e9fb2b8d94ac658d3-a082fec1fac3b5d718d58dfc447d418f-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>WorkerèŠ‚ç‚¹çš„å®‰è£…æ­¥éª¤å’ŒMasterèŠ‚ç‚¹æ˜¯å·®ä¸å¤šçš„ï¼Œå…ˆæ˜¯æ”¹ä¸»æœºåï¼Œå†ç”¨prepare.shåšå‡†å¤‡å·¥ä½œï¼Œä¿®æ”¹Dockeré…ç½®æ–‡ä»¶ã€iptablesï¼Œå…³é—­Linuxçš„swapåˆ†åŒºï¼Œç„¶åä¸‹è½½kubeadmå¯æ‰§è¡Œæ–‡ä»¶å’ŒKubernetesé•œåƒã€‚</p><p>è¿™å‡ æ­¥å’ŒMasterèŠ‚ç‚¹å®Œå…¨ä¸€æ ·ï¼Œæˆ‘å°±ä¸å±•ç¤ºè„šæœ¬æ–‡ä»¶äº†ï¼Œç›´æ¥è¿è¡Œã€‚</p><p>æœ‰äº†kubeadmä¹‹åï¼Œå› ä¸ºè¿™ä¸ªæ˜¯WorkerèŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‰§è¡Œ <code>kubeadm init</code>ï¼Œ<strong>è€Œæ˜¯è¦æ‰§è¡Œ <code>kubeadm join</code>ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰å®‰è£…MasterèŠ‚ç‚¹æ—¶æ‹·è´çš„é‚£æ¡å‘½ä»¤</strong>ã€‚å®ƒä¼šè‡ªåŠ¨è¿æ¥MasterèŠ‚ç‚¹ï¼Œç„¶åæ‹‰å–é•œåƒï¼Œå®‰è£…ç½‘ç»œæ’ä»¶ï¼Œæœ€åæŠŠèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ã€‚</p><p>WorkerèŠ‚ç‚¹å®‰è£…å¥½ä¹‹åï¼Œè®©æˆ‘ä»¬åœ¨æ§åˆ¶å°æ£€æŸ¥èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œæ‰§è¡Œ <code>kubectl get node</code>ï¼Œä¼šçœ‹åˆ°ä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯â€œReadyâ€ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬ç”¨ <code>kubectl run</code>ï¼Œè¿è¡ŒNginxæ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><pre><code class=\"language-plain\">kubectl run ngx --image=nginx:alpine\nkubectl get pod -o wide\n</code></pre><p>ä¼šçœ‹åˆ°Podè¿è¡Œåœ¨WorkerèŠ‚ç‚¹ä¸Šï¼Œè¡¨æ˜æˆ‘ä»¬çš„Kuberneteså¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²æˆåŠŸã€‚</p><hr><h3>å››. Deploymentçš„ä½¿ç”¨</h3><p><video poster=\"https://static001.geekbang.org/resource/image/7e/ba/7e70b11f796d73c9fa7a771b1dc5dbba.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/21c0348a-1825d5d672e-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/48554e3614d7473391d8c01d3da5cf15/dedabf40aa2e4d92a594d873bbb77824-b6a35dc15dc421a48037a5609ead77b9-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹Deploymentçš„ç”¨æ³•ã€‚</p><p>é¦–å…ˆæ˜¯ <code>kubectl api-resources</code> æ¥æŸ¥çœ‹Deploymentçš„åŸºæœ¬ä¿¡æ¯ï¼š</p><pre><code class=\"language-plain\">kubectl api-resources | grep deploy\n</code></pre><p>å¯ä»¥çœ‹åˆ°Deploymentçš„ç®€ç§°æ˜¯â€œ<strong>deploy</strong>â€ï¼Œå®ƒçš„apiVersionæ˜¯â€œ<strong>apps/v1</strong>â€ï¼Œkindæ˜¯â€œ<strong>Deployment</strong>â€ã€‚</p><p>ç„¶åæˆ‘ä»¬æ‰§è¡Œ <code>kubectl create</code>ï¼Œè®©Kubernetesä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”ŸæˆDeploymentçš„æ ·æ¿æ–‡ä»¶ã€‚</p><p>å…ˆè¦å®šä¹‰ä¸€ä¸ªç¯å¢ƒå˜é‡out:</p><pre><code class=\"language-plain\">export out=\"--dry-run=client -o yaml\"\n</code></pre><p>ç„¶ååˆ›å»ºåå­—å«â€œngx-depâ€çš„å¯¹è±¡ï¼Œä½¿ç”¨çš„é•œåƒæ˜¯â€œnginx:alpineâ€ï¼š</p><pre><code class=\"language-plain\">kubectl create deploy ngx-dep --image=nginx:alpine $out\n</code></pre><p>æˆ‘ä»¬æŠŠè¿™ä¸ªæ ·æ¿å­˜å…¥ä¸€ä¸ªæ–‡ä»¶ngx.ymlï¼š</p><pre><code class=\"language-plain\">kubectl create deploy ngx-dep --image=nginx:alpine $out &gt; deploy.yml\n</code></pre><p>è¿™é‡Œå¯ä»¥åˆ é™¤ä¸€äº›ä¸éœ€è¦çš„å­—æ®µï¼Œè®©YAMLçœ‹èµ·æ¥æ›´å¹²å‡€ï¼Œç„¶åæŠŠreplicasæ”¹æˆ2ï¼Œæ„æ€æ˜¯å¯åŠ¨ä¸¤ä¸ªNginx Podã€‚</p><p>æŠŠDeploymentçš„YAMLå†™å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ <code>kubectl apply</code> æ¥åˆ›å»ºå¯¹è±¡äº†ï¼š</p><pre><code class=\"language-plain\">kubectl apply -f deploy.yml\n</code></pre><p>ç”¨ <code>kubectl get</code> å‘½ä»¤æŸ¥çœ‹Deploymentçš„çŠ¶æ€ï¼š</p><pre><code class=\"language-plain\">kubectl get deploy\nkubectl get pod\n</code></pre><p>æœ€åæ¥è¯•éªŒä¸€ä¸‹Deploymentçš„åº”ç”¨ä¼¸ç¼©åŠŸèƒ½ï¼Œä½¿ç”¨å‘½ä»¤ <code>kubectl scale</code>ï¼ŒæŠŠPodæ•°é‡æ”¹æˆ5ä¸ªï¼š</p><pre><code class=\"language-plain\">kubectl scale --replicas=5 deploy ngx-dep\n</code></pre><p>æˆ‘ä»¬å†ç”¨ <code>kubectl get</code> å‘½ä»¤æŸ¥çœ‹ï¼Œå°±ä¼šå‘ç°Podå·²ç»æˆåŠŸå˜æˆäº†5ä¸ªå‰¯æœ¬ï¼š</p><pre><code class=\"language-plain\">kubectl get pod \n</code></pre><p>æœ€ååˆ é™¤è¿™ä¸ªDeploymentï¼š</p><pre><code class=\"language-plain\">kubectl delete deploy ngx-dep\n</code></pre><hr><h3>äº”. DaemonSetçš„ä½¿ç”¨</h3><p><video poster=\"https://static001.geekbang.org/resource/image/43/c7/438c9ece84b0dc35eb30ccf2d8e636c7.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/5efc73b1-1825d5d63e6-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/780d3f92f0064b0dbbd094c914da0f0f/d421db37c12f458d9d007ffb528a7f98-d5d61677df96fc4e34de948be6b49c54-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>çœ‹å®ŒDeploymentï¼Œæˆ‘å†æ¥æ¼”ç¤ºDaemonSetã€‚</p><p>å› ä¸ºDaemonSetä¸èƒ½ä½¿ç”¨ <code>kubectl create</code> ç›´æ¥ç”Ÿæˆæ ·æ¿æ–‡ä»¶ï¼Œä½†å¤§ä½“ç»“æ„å’ŒDeploymentæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆç”Ÿæˆä¸€ä¸ªDeploymentï¼Œç„¶åå†ä¿®æ”¹å‡ ä¸ªå­—æ®µå°±è¡Œäº†ã€‚</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨äº†<strong>Linuxç³»ç»Ÿé‡Œå¸¸ç”¨çš„å°å·¥å…·sedï¼Œç›´æ¥æ›¿æ¢Deploymenté‡Œçš„åå­—</strong>ï¼Œå†åˆ é™¤replicaså­—æ®µï¼Œè¿™æ ·å°±è‡ªåŠ¨ç”Ÿæˆäº†DaemonSetçš„æ ·æ¿æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">kubectl create deploy redis-ds --image=redis:5-alpine $out \\\n&nbsp; | sed 's/Deployment/DaemonSet/g' - \\\n&nbsp; | sed -e '/replicas/d' -\n</code></pre><p>è¿™ä¸ªæ ·æ¿æ–‡ä»¶å› ä¸ºæ˜¯ä»Deploymentæ”¹æ¥çš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰tolerationså­—æ®µï¼Œä¸èƒ½åœ¨MasterèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œéœ€è¦æ‰‹å·¥æ·»åŠ ã€‚</p><p>ä¸‹é¢è¿™ä¸ªå°±æ˜¯å·²ç»æ”¹å¥½çš„å®Œæ•´çš„DaemonSet YAMLæè¿°æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">vi ds.yml\n</code></pre><p>æ³¨æ„çœ‹é‡Œé¢çš„tolerationså­—æ®µï¼Œå®ƒèƒ½å¤Ÿå®¹å¿èŠ‚ç‚¹çš„ <code>node-role.kubernetes.io/master:NoSchedule</code> è¿™ä¸ªæ±¡ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½å¤Ÿè¿è¡Œåœ¨MasterèŠ‚ç‚¹ä¸Šã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬éƒ¨ç½²è¿™ä¸ªåŠ ä¸Šäº†â€œå®¹å¿åº¦â€çš„DaemonSetï¼š</p><pre><code class=\"language-plain\">kubectl apply -f ds.yml\n</code></pre><p>å†ç”¨ <code>kubectl get</code> æŸ¥çœ‹å¯¹è±¡çš„çŠ¶æ€ï¼š</p><pre><code class=\"language-plain\">kubectl get ds\nkubectl get pod -o wide\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªRedis çš„DaemonSetå·²ç»è·‘åœ¨äº†Masterå’ŒWorkerèŠ‚ç‚¹ä¸Šã€‚</p><p>æœ€ååˆ é™¤è¿™ä¸ªDaemonSetï¼š</p><pre><code class=\"language-plain\">kubectl delete -f ds.yml\n</code></pre><hr><h3>å…­. Serviceçš„ä½¿ç”¨</h3><p><video poster=\"https://static001.geekbang.org/resource/image/84/0d/84ffb533fe65e9ceebc2dc5ebce32f0d.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/237ff5d9-1825d5ffbed-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/8ef77380c8ea42cc9ee9e0f4b4ecbe64/f69c526ea6074d0b9b486dfd7f6a4944-2becc28a8cff22f937fe7a7069997c1a-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹Kubernetesé‡Œçš„è´Ÿè½½å‡è¡¡å¯¹è±¡Serviceã€‚</p><p>å› ä¸ºServiceå¯¹è±¡æœåŠ¡äºPodã€Deploymentç­‰å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºå®ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªDeploymentï¼š</p><pre><code class=\"language-plain\">kubectl apply -f deploy.yml\n</code></pre><p>è¿™ä¸ªDeploymentç®¡ç†äº†ä¸¤ä¸ªNginx Podï¼š</p><pre><code class=\"language-plain\">kubectl get pod -o wide\n</code></pre><p>ç„¶åæˆ‘ä»¬æˆ‘ä»¬ä½¿ç”¨ <code>kubectl expose</code> åˆ›å»ºServiceæ ·æ¿æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">kubectl expose deploy ngx-dep --port=80 --target-port=80 $out\n</code></pre><p>ä¿®æ”¹ä¹‹åå°±æ˜¯svc.ymlï¼Œå†ç”¨ <code>kubectl apply</code> åˆ›å»ºServiceå¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl apply -f svc.yml\n</code></pre><p>ç”¨ <code>kubectl get svc</code> å¯ä»¥åˆ—å‡ºServiceå¯¹è±¡ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„è™šIPåœ°å€ï¼š</p><pre><code class=\"language-plain\">kubectl get svc\n</code></pre><p>æƒ³è¦çœ‹Serviceä»£ç†äº†å“ªäº›åç«¯çš„Podï¼Œè¦ç”¨ <code>kubectl describe</code> å‘½ä»¤ï¼š</p><pre><code class=\"language-plain\">kubectl describe svc ngx-svc\n</code></pre><p>ç”¨ <code>kubectl get pod</code> å¯ä»¥å¯¹æ¯”éªŒè¯Serviceæ˜¯å¦æ­£ç¡®ä»£ç†äº†Nginx Podï¼š</p><pre><code class=\"language-plain\">kubectl get pod -o wide\n</code></pre><p>ç°åœ¨è®©æˆ‘ä»¬ç”¨ <code>kubectl exec</code> è¿›å…¥Podï¼ŒéªŒè¯Serviceçš„åŸŸååŠŸèƒ½ï¼š</p><pre><code class=\"language-plain\">kubectl exec -it ngx-dep-6796688696-4h6lb -- sh\n</code></pre><p>ä½¿ç”¨curlï¼ŒåŠ ä¸ŠåŸŸåâ€œngx-svcâ€ï¼Œä¹Ÿå°±æ˜¯Serviceå¯¹è±¡çš„åå­—ï¼š</p><pre><code class=\"language-plain\">curl ngx-svc\n</code></pre><p>å¤šæ‰§è¡Œå‡ æ¬¡ï¼Œå°±ä¼šçœ‹åˆ°é€šè¿‡è¿™ä¸ªåŸŸåï¼ŒServiceå¯¹è±¡å®ç°äº†å¯¹åç«¯Podçš„è´Ÿè½½å‡è¡¡ï¼ŒæŠŠæµé‡åˆ†å‘åˆ°ä¸åŒçš„Podã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥å†å°è¯•Serviceçš„å…¶ä»–åŸŸåå½¢å¼ï¼Œæ¯”å¦‚åŠ ä¸Šåå­—ç©ºé—´ï¼š</p><pre><code class=\"language-plain\">curl ngx-svc.default\ncurl ngx-svc.default.svc.cluster.local\n</code></pre><p>æœ€åçœ‹ä¸€ä¸‹Serviceä½¿ç”¨NodePortæ–¹å¼å¯¹å¤–æš´éœ²æœåŠ¡çš„ç”¨æ³•ï¼Œçœ‹ä¸€ä¸‹Serviceå¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl get svc\n</code></pre><p>åœ¨PORTé‡Œæ˜¾ç¤ºå®ƒåˆ†é…äº†ä¸€ä¸ªéšæœºçš„ç«¯å£å·31980ï¼Œåªè¦è®¿é—®é›†ç¾¤é‡Œä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒåŠ ä¸Šè¿™ä¸ªç«¯å£å·ï¼Œå°±å¯ä»¥è®¿é—®åˆ°Serviceå¯¹è±¡å’Œå®ƒåé¢çš„Podã€‚</p><p>æˆ‘ä»¬æ¥è¯•éªŒä¸€ä¸‹ï¼Œæ³¨æ„210æ˜¯MasterèŠ‚ç‚¹ï¼Œ220æ˜¯WorkerèŠ‚ç‚¹ï¼š</p><pre><code class=\"language-plain\">curl 192.168.10.210:31980\ncurl 192.168.10.220:31980\n</code></pre><p>æœ€ååˆ é™¤Deploymentå’ŒServiceå¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl delete -f deploy.yml\nkubectl delete -f svc.yml\n</code></pre><hr><h3>ä¸ƒ. Ingressçš„ä½¿ç”¨</h3><p><video poster=\"https://static001.geekbang.org/resource/image/84/6f/84e0da1cb5e4d365f0f045065dyy4c6f.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/1919b638-1825d5ff69c-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/e92b427476ce4360b28031d5d608205c/5bf51bd74fd943ef87def749bd3705dd-d18b9673f697c42c27bb97202f057fef-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>å­¦ä¹ äº†Serviceä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ç®¡ç†é›†ç¾¤å…¥å£æµé‡çš„Ingresså¯¹è±¡ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨Nginxå…¬å¸å¼€å‘çš„Ingress Controllerï¼Œéœ€è¦æŒ‰ç…§å®ƒçš„æ–‡æ¡£ï¼Œåˆ›å»ºåå­—ç©ºé—´ã€RBACç­‰ç›¸å…³çš„èµ„æºï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨ä¸€ä¸ªç®€å•è„šæœ¬æ¥å®Œæˆï¼š</p><pre><code class=\"language-plain\">cat setup.sh\n./setup.sh\n</code></pre><p>ä½¿ç”¨å‘½ä»¤ <code>kubectl get ns</code> å¯ä»¥çœ‹åˆ°å·²ç»æœ‰äº†ä¸€ä¸ªæ–°çš„åå­—ç©ºé—´ <code>nginx-ingress</code>ã€‚</p><p>ä¸ºäº†æµ‹è¯•éªŒè¯Ingresså’ŒIngress controllerçš„ç”¨æ³•ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å…ˆåˆ›å»ºDeploymentå’ŒServiceå¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl apply -f deploy.yml\nkubectl apply -f svc.yml\n</code></pre><p>æ¥çœ‹ä¸€ä¸‹Ingressçš„å®šä¹‰ï¼š</p><pre><code class=\"language-plain\">vi ingress.yml\n</code></pre><p>è¿™ä¸ªYAMLé‡ŒåŒ…å«äº†ä¸¤ä¸ªAPIå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªæ˜¯Ingress Classï¼Œåå­—æ˜¯ngx-inkï¼Œæ³¨æ„åœ¨specé‡Œï¼Œcontrollerè¦æŒ‡å®šæˆNginx Ingress Controllerã€‚</p><p>ç¬¬äºŒä¸ªå¯¹è±¡å°±æ˜¯è·¯ç”±è§„åˆ™å¯¹è±¡Ingressäº†ï¼Œæˆ‘ä¸ºå®ƒæ·»åŠ äº†ä¸€ä¸ªæ³¨è§£nginx.org/lb-methodï¼ŒæŒ‡å®šä½¿ç”¨Round-Robinè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œç„¶åæ˜¯å…³é”®å­—æ®µingressClassNameï¼Œè¿™æ ·å°±å¯ä»¥æŠŠIngresså’ŒIngress Classè”ç³»èµ·æ¥ã€‚</p><p>åé¢çš„ruleså°±æ˜¯å…·ä½“çš„è·¯ç”±è§„åˆ™ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œè¦æŒ‡å®šhostã€pathï¼Œè¿˜æœ‰åç«¯è¦è½¬å‘çš„Serviceï¼Œ<strong>æœ€å¥½ç”¨kubectl createæ¥è‡ªåŠ¨ç”Ÿæˆï¼Œä¸ç„¶å¾ˆå®¹æ˜“å†™é”™</strong>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹Ingress Controllerçš„å®šä¹‰ï¼Œå®ƒåœ¨kic YAML é‡Œï¼š</p><pre><code class=\"language-plain\">vi kic.yml\n</code></pre><p>å®ƒå…¶å®æ˜¯ä»Nginxå®˜æ–¹çš„ç¤ºä¾‹æ–‡ä»¶ä¿®æ”¹è€Œæ¥çš„ï¼Œæ‰€ä»¥åªéœ€è¦å…³æ³¨å‡ ä¸ªåœ°æ–¹ã€‚</p><p>ç¬¬ä¸€ä¸ªæ˜¯é•œåƒï¼Œæˆ‘æ”¹æˆäº†æ›´ç²¾ç®€çš„Alpineç‰ˆæœ¬ï¼Œ<strong>ç¬¬äºŒä¸ªæ˜¯å¯åŠ¨å‚æ•°argsï¼Œä¸€å®šè¦åŠ ä¸Š-ingress-classï¼Œå…³è”ä¸Šåˆšæ‰çš„Ingress Classå¯¹è±¡</strong>ï¼Œå¦åˆ™Ingress Controllerå°±æ— æ³•æ‰¾åˆ°è·¯ç”±è§„åˆ™Ingressã€‚</p><p>å®ƒåé¢è¿˜æœ‰å‡ ä¸ªå‚æ•°ï¼Œæ¯”å¦‚-health-statusã€-ready-statusç­‰ç­‰ï¼Œä½ å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£äº†è§£å®ƒä»¬çš„ä½œç”¨ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°±åº”ç”¨è¿™ä¸¤ä¸ªYAML æ–‡ä»¶ï¼Œåˆ›å»ºIngresså¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl apply -f ingress.yml\nkubectl apply -f kic.yml\n</code></pre><p>ç”¨ <code>kubectl get</code> æ¥é€ä¸ªæŸ¥çœ‹è¿™äº›å¯¹è±¡çš„çŠ¶æ€ï¼š</p><pre><code class=\"language-plain\">kubectl get ingressclass\nkubectl get ing\nkubectl describe ing ngx-ing\n\nkubectl get deploy -n nginx-ingress\nkubectl get pod -n nginx-ingress\n</code></pre><p>ç¡®è®¤å®ƒä»¬éƒ½å·¥ä½œæ­£å¸¸ï¼Œæˆ‘ä»¬æ¥åšä¸ªæµ‹è¯•ï¼ŒæŠŠæœ¬åœ°çš„8080ç«¯å£æ˜ å°„åˆ°Ingress Controller Podçš„80ç«¯å£ï¼š</p><pre><code class=\"language-plain\">kubectl port-forward -n nginx-ingress ngx-kic-dep-8859b7b86-cplgp 8080:80 &amp;\n</code></pre><p>å› ä¸ºåœ¨Ingressé‡Œæˆ‘ä»¬è®¾å®šçš„è·¯ç”±è§„åˆ™æ˜¯ngx.teståŸŸåï¼Œæ‰€ä»¥è¦ç”¨curlçš„resolveå‚æ•°æ¥æŠŠå®ƒå¼ºåˆ¶è§£æåˆ°127.0.0.1ï¼š</p><pre><code class=\"language-plain\">curl --resolve ngx.test:8080:127.0.0.1 http://ngx.test:8080\n</code></pre><p>å¤šæ‰§è¡Œå‡ æ¬¡ï¼Œä½ å°±ä¼šå‘ç°Nginx Ingress Controlleré€šè¿‡åŸŸåè·¯ç”±è§„åˆ™ï¼ŒæŠŠè¯·æ±‚è½¬å‘åˆ°äº†ä¸åŒçš„åç«¯Podã€‚</p><p>æœ€åæˆ‘ä»¬åˆ é™¤åˆšæ‰åˆ›å»ºçš„è¿™äº›Deploymentã€Serviceã€Ingressç­‰å¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl delete -f deploy.yml\nkubectl delete -f svc.yml\nkubectl delete -f ingress.yml\nkubectl delete -f kic.yml\n</code></pre><hr><h3>å…«. æ­å»ºWordPressç½‘ç«™</h3><p><video poster=\"https://static001.geekbang.org/resource/image/cd/e6/cda7ayy29504f1f7a0ba268267d7dce6.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/18a7e618-1825d5ff1a1-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/f655345af3554ac0a5a5068d36a11b39/87dbfc04224b4219b2fa7648652c56bf-87bd0b26bcbe4d5dbe3a16fd1147fc6b-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><p>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯æ¥æ­å»ºWordPressç½‘ç«™ï¼Œå®é™…æ“ä½œDeploymentã€Serviceã€Ingressè¿™äº›å¯¹è±¡çš„ç”¨æ³•ã€‚</p><p>ç¬¬ä¸€æ­¥æ˜¯éƒ¨ç½²MariaDBï¼š</p><pre><code class=\"language-plain\">wp-maria.yml\n</code></pre><p>å®ƒçš„ConfigMapæ²¡æœ‰å˜åŒ–ï¼Œè¿˜æ˜¯â€œDATABASEâ€â€œUSERâ€â€œPASSWORDâ€é‚£å‡ ä¸ªç¯å¢ƒå˜é‡ã€‚ä¸‹é¢çš„éƒ¨ç½²æ–¹å¼æ”¹æˆäº†Deploymentï¼Œç®€å•èµ·è§åªä½¿ç”¨ä¸€ä¸ªå®ä¾‹ã€‚ä¹‹ååˆä¸ºå®ƒå®šä¹‰äº†ä¸€ä¸ªServiceå¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŸŸåè€Œä¸æ˜¯IPåœ°å€æ¥è®¿é—®æ•°æ®åº“ã€‚</p><p>ç¬¬äºŒæ­¥æ˜¯éƒ¨ç½²WordPressåº”ç”¨ï¼š</p><pre><code class=\"language-plain\">vi wp-dep.yml\n</code></pre><p><strong>æ³¨æ„åœ¨ConfigMapé‡Œæˆ‘ä»¬ä¸å†ä½¿ç”¨å›ºå®šIPåœ°å€äº†ï¼Œè€Œæ˜¯æ”¹ç”¨äº†Serviceæä¾›çš„åŸŸåmaria-svcã€‚</strong>ç„¶ååœ¨Deploymenté‡Œï¼ŒæŠŠWordPresså®ä¾‹è®¾ç½®ä¸º2ï¼Œå¢åŠ äº†å†—ä½™åº¦ï¼Œæé«˜äº†å¯ç”¨æ€§ã€‚ä¹‹åæˆ‘ä»¬è¿˜æ˜¯ä¸ºå®ƒå®šä¹‰äº†Serviceå¯¹è±¡ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºNodePortæ¨¡å¼ï¼ŒæŒ‡å®šä½¿ç”¨ç«¯å£30088ã€‚</p><p>ç¬¬ä¸‰æ­¥æ˜¯éƒ¨ç½²Ingressï¼š</p><pre><code class=\"language-plain\">vi wp-ing.yml\n</code></pre><p>Ingressçš„å®šä¹‰å’Œä¹‹å‰å·®ä¸å¤šï¼Œä½†Ingress Classçš„åå­—æ”¹æˆäº†wp-inkï¼ŒIngressè·¯ç”±çš„hostæ”¹æˆäº†wp.testã€‚</p><p>Ingress Controllerçš„å˜åŒ–ä¹Ÿä¸å¤§ï¼š</p><pre><code class=\"language-plain\">vi wp-kic.yml\n</code></pre><p><strong>å…³é”®è¿˜æ˜¯argsé‡Œçš„å‚æ•°-ingress-classï¼Œå¿…é¡»å’ŒIngress ClassåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯wp-ink</strong>ã€‚è¿˜æœ‰å°±æ˜¯å­—æ®µhostNetwork: trueï¼Œè®©Podç›´æ¥ä½¿ç”¨èŠ‚ç‚¹çš„ç½‘ç»œ</p><p>çœ‹å®Œäº†è¿™äº›YAML ï¼Œè®©æˆ‘ä»¬ç”¨kubectl applyæ¥åˆ›å»ºå¯¹è±¡ï¼š</p><pre><code class=\"language-plain\">kubectl apply&nbsp;-f wp-maria.yml\nkubectl apply&nbsp;-f wp-dep.yml\nkubectl apply&nbsp;-f wp-ing.yml\nkubectl apply&nbsp;-f wp-kic.yml\n</code></pre><p>åˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å†ç”¨kubectl getçœ‹ä¸€ä¸‹å¯¹è±¡çš„çŠ¶æ€ï¼š</p><pre><code class=\"language-plain\">kubectl get deploy\nkubectl get svc\nkubectl get pod -n nginx-ingress\n</code></pre><p>ç°åœ¨è®©æˆ‘ä»¬æ¥åˆ°é›†ç¾¤ä¹‹å¤–ï¼Œå‡è®¾ä½ å·²ç»ä¿®æ”¹äº†æœ¬åœ°çš„hostsåŸŸåè§£ææ–‡ä»¶ï¼ŒæŠŠåŸŸåwp.testè§£æåˆ°Kubernetesçš„èŠ‚ç‚¹ï¼Œé‚£å°±å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨é‡Œè¾“å…¥<a href=\"http://wp.test\">http://wp.test</a>æ¥è®¿é—®Nginx Ingress Controllerï¼Œå†è®¿é—®WordPressç½‘ç«™äº†ã€‚</p><h2>è¯¾åä½œä¸š</h2><p>å¦‚æœä½ åœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°å›°éš¾ï¼Œæ¬¢è¿åœ¨ç•™è¨€åŒºç•™è¨€ï¼Œè®°å¾—æŠŠä½ çš„é—®é¢˜æè¿°æ¸…æ¥šï¼Œè¿™æ ·æˆ‘å’Œå…¶ä»–åŒå­¦ä¹Ÿèƒ½æ›´å¥½åœ°å°±é—®é¢˜è¯¦ç»†è®¨è®ºã€‚</p><p>å¸Œæœ›ä½ åœ¨è¿™æ®µæ—¶é—´çš„å­¦ä¹ è¿‡ç¨‹ä¸­æœ‰æ‰€æ”¶è·ï¼Œä¸‹èŠ‚è¯¾å°±æ˜¯æœ€åçš„é«˜çº§ç¯‡äº†ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ã€‚</p>","comments":[{"had_liked":false,"id":354525,"user_name":"YueShi","can_delete":false,"product_type":"c1","uid":1625530,"ip_address":"åŒ—äº¬","ucode":"8F7AFAE4641A7D","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg","comment_is_top":false,"comment_ctime":1660486453,"is_pvip":true,"replies":[{"id":128951,"content":"very nice!","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660529183,"ip_address":"åŒ—äº¬","comment_id":354525,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1ã€æ¨èä¹‹å‰çš„è¯¾ç¨‹å…¨éƒ½è‡ªå·±å®Œæˆä¸€éï¼Œç„¶ååœ¨çœ‹è¿™ä¸ªå®æˆ˜è§†é¢‘ï¼Œå°±æœ‰ç‚¹æŸ¥æ¼è¡¥ç¼ºçš„å‘³é“äº†ï¼Œçœ‹çš„å¾ˆè½»æ¾\n2ã€å…³äºæ¥¼ä¸ŠåŒå­¦â€œæŒ‰é“ç†åº”è¯¥æ˜¯è¿›å…¥Serviceâ€çš„å›°æƒ‘ï¼Œæœ‰æ„Ÿï¼ŒK8Sçš„åŸºæœ¬æ€æƒ³å°±æ˜¯ç»„åˆå’Œé€‚é…å™¨æ¨¡å¼ï¼Œåœ¨k8sé‡Œæ„Ÿè§‰ä¸‡ç‰©çš†å¯ç»„åˆï¼Œå¦‚æœä¸èƒ½æ»¡è¶³ï¼ŒåŸºäºç°æœ‰çš„apiåœ¨é€‚é…å‡ºä¸€ä¸ªapiå‡ºæ¥ï¼Œç»„åˆå’Œé€‚é…åœ¨k8sé‡Œæ˜¯äº’é€†çš„\n3ã€åŒå¿—ä»¬ç»§ç»­å­¦å‘€ï¼Œåœ¨åšæŒå­¦ä¸€èŠ‚ï¼Œå°±ç”©æ‰äº†å¾ˆå¤šäººï¼ŒåŠ æ²¹ğŸ’ªğŸ’ªğŸ’ªğŸ’ª","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583958,"discussion_content":"very nice!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660529183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359054,"user_name":"å°æ±Ÿçˆ±å­¦æœ¯","can_delete":false,"product_type":"c1","uid":2628601,"ip_address":"åŒ—äº¬","ucode":"554F40C6627AF4","user_header":"https://static001.geekbang.org/account/avatar/00/28/1b/f9/018197f1.jpg","comment_is_top":false,"comment_ctime":1665208418,"is_pvip":false,"replies":[{"id":130595,"content":"æ˜¯çš„ï¼Œå¦‚æœä¸å†™å…·ä½“çš„åå­—ç©ºé—´ï¼Œé»˜è®¤å°±æ˜¯defaultã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1665270020,"ip_address":"åŒ—äº¬","comment_id":359054,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"è€å¸ˆé—®ä¸ªé—®é¢˜å‘€\n\nkubectl get deploy\nkubectl get svc\nkubectl get pod -n nginx-ingress\n\nä»è¿™é‡Œå¯ä»¥çœ‹å‡ºåº”ç”¨çš„deployä»¥åŠsvcæ˜¯åœ¨defaultå‘½åç©ºé—´ä¸‹çš„ï¼Œingressæ˜¯åœ¨è‡ªå·±çš„nginx-ingresså‘½åç©ºé—´ä¸‹ï¼Œä»–ä»¬åœ¨k8sä¸­ä¸å±äºä¸€ä¸ªå‘½åç©ºé—´ã€‚ä½†æ˜¯åœ¨ingress ruleçš„é…ç½®é‡Œï¼Œå…³äºbackendçš„é…ç½®ç›´æ¥ç”¨çš„serviceçš„åå­—ï¼Œæ˜¯å› ä¸ºå¦‚æœè¿™é‡Œä¸æä¾›å…·ä½“çš„å‘½åç©ºé—´çš„åå­—ï¼Œä»–ä¼šè‡ªåŠ¨è®¤ä¸ºæ˜¯defaultå—ã€‚è°¢è°¢ã€‚","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589703,"discussion_content":"æ˜¯çš„ï¼Œå¦‚æœä¸å†™å…·ä½“çš„åå­—ç©ºé—´ï¼Œé»˜è®¤å°±æ˜¯defaultã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665270020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354679,"user_name":"èŠ±èŠ±å¤§è„¸çŒ«","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"åŒ—äº¬","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1660662484,"is_pvip":true,"replies":[{"id":129040,"content":"é¦–å…ˆä¿è¯kubeadmçš„ç‰ˆæœ¬æ­£ç¡®ï¼Œç„¶åè®°å¾—tokenä¹Ÿè¦æ­£ç¡®ï¼Œå¥½åƒtokenæ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œè¿‡æœŸäº†å°±è¦é‡æ–°ç”Ÿæˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660704233,"ip_address":"åŒ—äº¬","comment_id":354679,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"é‡åˆ°ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œåœ¨nodeèŠ‚ç‚¹æ‰§è¡Œkubeadm joinçš„æ—¶å€™ï¼Œéƒ½ä¼šå¡æ­»ï¼Œç„¶åé€šè¿‡--v=5ï¼Œå‘ç°è¿æ¥masterä¸€ç›´æ‹’ç»ï¼šI0816 23:05:48.343080    5359 token.go:217] [discovery] Failed to request cluster-info, will try again: Get &quot;https:&#47;&#47;10.0.3.15:6443&#47;api&#47;v1&#47;namespaces&#47;kube-public&#47;configmaps&#47;cluster-info?timeout=10s&quot;: dial tcp 10.0.3.15:6443: connect: connection refusedï¼Œçœ‹è§£å†³æ–¹æ¡ˆæœ‰è¯´åœ¨kubeadm initçš„æ—¶å€™éœ€è¦æŒ‡å®šï¼ˆ108æ˜¯æˆ‘nodeèŠ‚ç‚¹çš„è™šæ‹ŸæœºIPï¼‰--apiserver-cert-extra-sans 192.168.56.108 --apiserver-advertise-address 192.168.56.108 \\ï¼Œå‡Œä¹±äº†","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584244,"discussion_content":"é¦–å…ˆä¿è¯kubeadmçš„ç‰ˆæœ¬æ­£ç¡®ï¼Œç„¶åè®°å¾—tokenä¹Ÿè¦æ­£ç¡®ï¼Œå¥½åƒtokenæ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œè¿‡æœŸäº†å°±è¦é‡æ–°ç”Ÿæˆã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1660704234,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"èŠ±èŠ±å¤§è„¸çŒ«","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584297,"discussion_content":"éœ€è¦æŒ‡å®š--apiserver-advertise-addressï¼Œå¹¶ä¸”å› ä¸ºæ˜¯ä¸¤ä¸ªç½‘å¡ï¼ŒæŒ‡å®šé”™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660725809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378641,"user_name":"ç‰™å°æœ¨","can_delete":false,"product_type":"c1","uid":1172050,"ip_address":"åŒ—äº¬","ucode":"E5C12D37A62949","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/52/56dbb738.jpg","comment_is_top":false,"comment_ctime":1690520226,"is_pvip":false,"replies":[{"id":137967,"content":"great","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1690545445,"ip_address":"ä¸Šæµ·","comment_id":378641,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"å¦‚æœå¿˜äº†äº†masterçš„join ä¿¡æ¯ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥æ‰§è¡Œ \nkubeadm token create --print-join-command\nå¦‚æœæ²¡æœ‰ä¿¡æ¯ï¼Œæˆ–è€…è¿‡æœŸäº†ï¼Œå¯ä»¥æ‰§è¡Œ\nkubeadm token create","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624422,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690545445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354336,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1660289415,"is_pvip":false,"replies":[{"id":128890,"content":"\n1.åº”è¯¥æ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œç°åœ¨ä¹Ÿè®¸å˜äº†ï¼Ÿä¸ç¡®å®šã€‚\n\n2.å¦‚æœéƒ½æ˜¯ç”¨YAML éƒ¨ç½²çš„ï¼Œå¯ä»¥ç”¨â€œdelete -f . â€æ¥åˆ é™¤æ‰€æœ‰å¯¹è±¡ã€‚\n\n3.å› ä¸ºåŸŸåã€IPåœ°å€éƒ½æ˜¯åœ¨Kubernetesé‡Œçš„ï¼Œå¤–ç•Œè®¿é—®ä¸äº†ï¼Œè¿›podå°±å¯ä»¥äº†ã€‚Serviceæ˜¯ä¸ªè™šåœ°å€ï¼Œæ— æ³•è¿›å…¥ï¼Œåªæœ‰podæ˜¯å®ä½“ã€‚\n\n4.ä¸å¿…è¦ï¼ŒServiceå’ŒDeploymentæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œæˆ‘æ˜¯ä¸ºäº†çœäº‹è¿ç»­åˆ é™¤ã€‚\n\n5.å½“ç„¶å¯ä»¥ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ‰¾åˆ°ç›¸åº”çš„podã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660307265,"ip_address":"åŒ—äº¬","comment_id":354336,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š\nQ1ï¼šâ€œkubeadm joinâ€å‘½ä»¤é‡Œçš„tokençš„æ—¶æ•ˆæ€§æ²¡æœ‰èµ·ä½œç”¨ã€‚\nè®²kubeadmçš„æ—¶å€™ï¼Œæåˆ°ï¼šâ€œkubeadm joinâ€å‘½ä»¤é‡Œçš„tokenæœ‰æ—¶æ•ˆæ€§ï¼Œé»˜è®¤æ˜¯24å°æ—¶ã€‚\nä½†æ˜¯ï¼Œæˆ‘çš„é›†ç¾¤ç¯å¢ƒåˆ›å»ºæˆåŠŸåï¼Œmasterè™šæ‹Ÿæœºå¯åŠ¨åk8sè‡ªåŠ¨è¿è¡Œï¼Œworkerè™šæ‹Ÿæœºå¯åŠ¨åè‡ªåŠ¨\nè¿æ¥åˆ°masterï¼Œä¸€ä¸ªå¤šæ˜ŸæœŸäº†è¿˜æ˜¯è¿™æ ·ï¼Œå¥½åƒtokenæ°¸è¿œä¸ä¼šè¿‡æœŸï¼Œä¸ºä»€ä¹ˆï¼Ÿ\n\nQ2ï¼šæ˜¯å¦éœ€è¦æ¸…ç†ç¯å¢ƒï¼Œæœ‰ä¸€é”®æ¸…é™¤çš„å‘½ä»¤å—ï¼Ÿ\nè€å¸ˆçš„è§†é¢‘ï¼Œæ¯ä¸€ä¸ªè§†é¢‘çš„ç¯å¢ƒéƒ½æ˜¯å¹²å‡€çš„ï¼Œå’Œå…¶ä»–è§†é¢‘æ— å…³ã€‚\nè€Œæˆ‘çš„æ“ä½œä¸æ˜¯è¿™æ ·ã€‚æˆ‘çš„æ“ä½œæ˜¯ï¼šæ¯ä¸€è®²éƒ½åœ¨åŒä¸€ä¸ªé›†ç¾¤ç¯å¢ƒä¸­æ“ä½œï¼Œæ“ä½œä¹‹å‰ä¹Ÿæ²¡æœ‰æ¸…ç†\nä»¥å‰çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä»¥å‰åˆ›å»ºçš„PODã€deployç­‰éƒ½å­˜åœ¨ã€‚è¿™ç§æ“ä½œæ–¹æ³•ä¸å¥½å§ï¼Œåº”è¯¥æ¸…ç†å§ã€‚\n\nå¦‚æœéœ€è¦æ¸…ç†ï¼Œæœ‰ä¸€é”®æ¸…é™¤çš„å‘½ä»¤å—ï¼Ÿè¿˜æ˜¯éœ€è¦é€ä¸ªåˆ é™¤ï¼Ÿæ¯”å¦‚é€ä¸ªæŸ¥çœ‹cmã€dsã€PODç­‰ã€‚\n\nQ3ï¼šServiceä»£ç†PODåï¼Œç”¨execè¿›å…¥PODï¼Œå†ç”¨curlè®¿é—®ã€‚\nè¯·é—®ï¼šä¸ºä»€ä¹ˆæ˜¯è¿›å…¥PODï¼ŒServiceä»£ç†PODï¼ŒæŒ‰é“ç†åº”è¯¥æ˜¯è¿›å…¥Serviceå‘€ã€‚\n\nQ4ï¼šåˆ é™¤serviceçš„æ—¶å€™ï¼Œä¹Ÿå¿…é¡»åˆ é™¤deployå—ï¼Ÿ\nè§†é¢‘ä¸­çš„åˆ é™¤æ–¹æ³•æ˜¯ï¼š kubectl delete -f deploy.yml -f svc.ymlï¼Œ\næœ‰ä¸¤ä¸ªå­é—®é¢˜ï¼š\nç¬¬ä¸€ï¼Œè¿™é‡Œçš„deploy.ymlåº”è¯¥æ˜¯å¯¹åº”svc.ymlå§ï¼Œå°±æ˜¯è¯´svc.ymlåˆ›å»ºçš„serviceï¼Œ\nä»£ç†çš„PODæ˜¯ç”±deploy.ymlåˆ›å»ºå‡ºæ¥çš„ï¼Œå¯¹å§ã€‚\n\nå¦å¤–ï¼Œå¯ä»¥åªåˆ é™¤serviceè€Œä¸åˆ é™¤serviceä»£ç†çš„PODå—ï¼Ÿ\n\nQ5ï¼šä¸¤ç§åˆ é™¤æ–¹æ³•éƒ½å¯ä»¥å—ï¼Ÿ\nç¬¬ä¸€ç§ï¼škubectl delete delploy xxx\nç¬¬äºŒç§ï¼škubctl delete -f deploy.yml\nç¬¬ä¸€ç§æ–¹æ³•ä¸­çš„xxxæ˜¯ç¬¬äºŒç§æ–¹æ³•ä¸­çš„ deploy.ymlåˆ›å»ºå‡ºæ¥çš„ã€‚\nè¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥å—ï¼Ÿ è€Œä¸”ï¼Œå¥½åƒæ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰è¿™ä¸¤ç§åˆ é™¤æ–¹æ³•ã€‚","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583716,"discussion_content":"\n1.åº”è¯¥æ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œç°åœ¨ä¹Ÿè®¸å˜äº†ï¼Ÿä¸ç¡®å®šã€‚\n\n2.å¦‚æœéƒ½æ˜¯ç”¨YAML éƒ¨ç½²çš„ï¼Œå¯ä»¥ç”¨â€œdelete -f . â€æ¥åˆ é™¤æ‰€æœ‰å¯¹è±¡ã€‚\n\n3.å› ä¸ºåŸŸåã€IPåœ°å€éƒ½æ˜¯åœ¨Kubernetesé‡Œçš„ï¼Œå¤–ç•Œè®¿é—®ä¸äº†ï¼Œè¿›podå°±å¯ä»¥äº†ã€‚Serviceæ˜¯ä¸ªè™šåœ°å€ï¼Œæ— æ³•è¿›å…¥ï¼Œåªæœ‰podæ˜¯å®ä½“ã€‚\n\n4.ä¸å¿…è¦ï¼ŒServiceå’ŒDeploymentæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œæˆ‘æ˜¯ä¸ºäº†çœäº‹è¿ç»­åˆ é™¤ã€‚\n\n5.å½“ç„¶å¯ä»¥ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ‰¾åˆ°ç›¸åº”çš„podã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660307265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3035820,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ7m6GFcPvzOTmujmQseWOC73X2xk7YxdeIWheDamTcL4KCzPUKEr1byaQn839EY6pODjfvBIDibNw/132","nickname":"Geek_a9c252","note":"","ucode":"FFF233BA45812F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586598,"discussion_content":"æœ‰æ—¶æ•ˆæ€§çš„ï¼Œä½†æ˜¯workerç¬¬ä¸€æ¬¡ç»‘å®šmasteråå’Œtokençš„æ—¶æ•ˆæ€§å°±æ²¡æœ‰å…³ç³»ï¼Œä½†æ˜¯å¦‚æœä½ åç»­è¿‡äº†24héœ€è¦ç»‘å®šå…¶ä»–workeræ˜¯éœ€è¦å†åˆ›å»ºçš„ã€‚kubeadm token listå¯ä»¥æŸ¥çœ‹ttlï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºä¸è¿‡æœŸçš„token","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1662368187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376911,"user_name":"Greenery","can_delete":false,"product_type":"c1","uid":3566765,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"16111129C9EBA2","user_header":"https://static001.geekbang.org/account/avatar/00/36/6c/ad/0a694b50.jpg","comment_is_top":false,"comment_ctime":1687699243,"is_pvip":false,"replies":[{"id":137387,"content":"ç»™Ingress controlleræš´éœ²å¯¹å¤–çš„æœåŠ¡ç«¯å£ï¼Œ404æ˜¯ä¸æ˜¯Ingressæ²¡æœ‰é…ç½®å¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1687746332,"ip_address":"ä¸Šæµ·","comment_id":376911,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"è€å¸ˆï¼Œè¿™ä¸ªwp-kicä¸­çš„serviceæ˜¯ä»€ä¹ˆä½œç”¨çš„ï¼Ÿæˆ‘è®¿é—®30080ç«¯å£æ˜¾ç¤ºnginx404...","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621884,"discussion_content":"ç»™Ingress controlleræš´éœ²å¯¹å¤–çš„æœåŠ¡ç«¯å£ï¼Œ404æ˜¯ä¸æ˜¯Ingressæ²¡æœ‰é…ç½®å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687746332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372237,"user_name":"åƒé¸¡åƒé¸¡","can_delete":false,"product_type":"c1","uid":1199348,"ip_address":"åŒ—äº¬","ucode":"7C54E2C1A3E8B2","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/f4/8eda0b19.jpg","comment_is_top":false,"comment_ctime":1680865412,"is_pvip":false,"replies":[{"id":135855,"content":"yes","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1680952148,"ip_address":"åŒ—äº¬","comment_id":372237,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"å¦‚æœIngress Controllerçš„serviceæ¢æˆäº‘å‚å•†slb&#47;albï¼Œé‚£ä¹ˆå…¥å£æœåŠ¡å‘ç°èƒ½çš„é‡ä»»å°±åœ¨è´Ÿè½½å‡è¡¡äº†","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612812,"discussion_content":"yes","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680952148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366378,"user_name":"å†œæ°‘å›­ä¸","can_delete":false,"product_type":"c1","uid":1155913,"ip_address":"å†…è’™å¤","ucode":"6A91EBBC9DCE6C","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/49/4a488f4c.jpg","comment_is_top":false,"comment_ctime":1673662438,"is_pvip":false,"replies":[{"id":133502,"content":"è¿™ä¸ªå¥½åƒæ˜¯WordPressç¨‹åºè·³è½¬çš„åŸå› ï¼Œä¸äº†è§£å®ƒçš„ç”¨æ³•ï¼Œæ‰€ä»¥ä¸çŸ¥é“æ”¹æ€ä¹ˆè§£å†³ã€‚\n\nå¥½åœ¨ä¸å½±å“æˆ‘ä»¬å­¦ä¹ Kubernetesï¼Œåªè¦WordPressè·‘èµ·æ¥ï¼Œå°±è¯æ˜Kuberneteséƒ¨ç½²æˆåŠŸï¼Œå‰©ä¸‹æ˜¯åº”ç”¨å±‚é¢çš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1673685084,"ip_address":"åŒ—äº¬","comment_id":366378,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"å…«. æ­å»º WordPress ç½‘ç«™ \nè®¿é—®http:&#47;&#47;wp.test&#47;è¿›å…¥å®‰è£…é¡µé¢ï¼Œä½†æ˜¯ä¹‹åç™»å½•æµè§ˆå™¨æ˜¾ç¤ºè·³è½¬åˆ°ä»¥ä¸‹è¿æ¥æ—¶ï¼š\nhttp:&#47;&#47;wp.test&#47;wp-login.php?redirect_to=http%3A%2F%2Fwp.test%2Fwp-admin%2F&amp;reauth=1\næ²¡æœ‰ç™»å½•ï¼Œè¿˜æ˜¯åœåœ¨ç™»å½•ç•Œé¢ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½è¾“å¯¹äº†ã€‚\nè¯·æ•™è¿™æ˜¯ä¸Šé¢é—®é¢˜ï¼Ÿ\nè¿˜æœ‰å°±æ˜¯å®¿ä¸»æœºçš„hostså°†wp.hostä¸å…¶ä¸­1ä¸ªèŠ‚ç‚¹ç»‘å®šï¼Œè¿˜æ˜¯ä»»æ„1ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ï¼Œå®éªŒå‘ç°å¥½åƒåªèƒ½ç»‘å®šå…¶ä¸­1ä¸ªèŠ‚ç‚¹ã€‚","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599666,"discussion_content":"è¿™ä¸ªå¥½åƒæ˜¯WordPressç¨‹åºè·³è½¬çš„åŸå› ï¼Œä¸äº†è§£å®ƒçš„ç”¨æ³•ï¼Œæ‰€ä»¥ä¸çŸ¥é“æ”¹æ€ä¹ˆè§£å†³ã€‚\n\nå¥½åœ¨ä¸å½±å“æˆ‘ä»¬å­¦ä¹ Kubernetesï¼Œåªè¦WordPressè·‘èµ·æ¥ï¼Œå°±è¯æ˜Kuberneteséƒ¨ç½²æˆåŠŸï¼Œå‰©ä¸‹æ˜¯åº”ç”¨å±‚é¢çš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673685084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2116337,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4a/f1/b2f4de35.jpg","nickname":"windhalk","note":"","ucode":"55A54A100F1C2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650570,"discussion_content":"2024å¹´æ¥å›å¤ï¼Œæˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ã€‚æ„Ÿè§‰æ˜¯sessionçš„é—®é¢˜ï¼Œæˆ‘åœ¨adminé¡µé¢ç‚¹å‡»æ¢é¡µé¢ä¹Ÿä¼šç»™æˆ‘è·³åˆ°ç™»å½•é¡µé¢ã€‚ç„¶åæˆ‘æŠŠwordpress deploymentçš„replicaæ•°æ”¹æˆ1ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ã€‚\nçŒœæµ‹wordpressé»˜è®¤æ˜¯æŠŠsessionå­˜åœ¨æœ¬åœ°ï¼Œåˆ°åº•æ˜¯å­˜æ²¡å­˜db, å°±åªæœ‰å»çœ‹maria-dbé‡Œçš„è¡¨äº†ã€‚å½“svcåšload balancingçš„æ—¶å€™å»åˆ°å¦ä¸€ä¸ªpodï¼Œå› ä¸ºå¦ä¸€ä¸ªpodæœ¬åœ°æ²¡æœ‰è¿™ä¸ªsessionï¼Œå°±ä¼šè·³è½¬ç™»å½•ç•Œé¢ã€‚\nç»“è®ºå°±æ˜¯è¿™ä¸ªåªé…äº†æ•°æ®åº“çš„wordpresså¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„stateless application. è¿˜éœ€è¦é…ä¸€ä¸ªsessionçš„è®¾ç½®å“ˆï¼Œè¦æŠŠsessionå­˜åˆ°dbé‡Œï¼Œå½“ç„¶è¿™ä¸ªsessionåªæœ‰åœ¨admin é¡µé¢æ‰ä¼šç”¨åˆ°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725268964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363753,"user_name":"æ— ä¸º","can_delete":false,"product_type":"c1","uid":1252164,"ip_address":"åŒ—äº¬","ucode":"81D7AF5E1FDD30","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/44/82acaafc.jpg","comment_is_top":false,"comment_ctime":1670125042,"is_pvip":false,"replies":[{"id":132185,"content":"æ„Ÿè§‰é—®é¢˜æ²¡æœ‰å¤ªè¯´æ¸…æ¥šï¼Œæ²¡èƒ½ç†è§£ï¼Œsorryã€‚\n\nkubeadmå®‰è£…æ˜¯å¿…é¡»è¦æ‹‰å–é•œåƒçš„ï¼Œå¦‚æœèƒ½ç›´æ¥è®¿é—®gcr.ioï¼Œå°±å¯ä»¥ä¸ç”¨è„šæœ¬ï¼Œç›´æ¥kubeadmè‡ªå·±å°±èƒ½æ‹‰å–é•œåƒå®‰è£…äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1670132522,"ip_address":"åŒ—äº¬","comment_id":363753,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"è€å¸ˆæ‚¨å¥½, æ‚¨çš„è¯¾ç¨‹éå¸¸çš„æ˜“å­¦.\næˆ‘æœ‰ä¸€ä¸ªé—®é¢˜, æˆ‘æœ¬åœ°çš„ kubeadm å¹¶æ²¡æœ‰ä½¿ç”¨docker images çš„é•œåƒ, æ˜¯æˆ‘æ¼äº†ä»€ä¹ˆæ­¥éª¤å—?","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595478,"discussion_content":"æ„Ÿè§‰é—®é¢˜æ²¡æœ‰å¤ªè¯´æ¸…æ¥šï¼Œæ²¡èƒ½ç†è§£ï¼Œsorryã€‚\n\nkubeadmå®‰è£…æ˜¯å¿…é¡»è¦æ‹‰å–é•œåƒçš„ï¼Œå¦‚æœèƒ½ç›´æ¥è®¿é—®gcr.ioï¼Œå°±å¯ä»¥ä¸ç”¨è„šæœ¬ï¼Œç›´æ¥kubeadmè‡ªå·±å°±èƒ½æ‹‰å–é•œåƒå®‰è£…äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670132523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066409,"avatar":"https://static001.geekbang.org/account/avatar/00/10/45/a9/3d48d6a2.jpg","nickname":"Lorry","note":"","ucode":"BD4754D0F1D786","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600686,"discussion_content":"æˆ‘è§‰å¾—ä½ æ˜¯ä¸æ˜¯æœºå™¨çœ‹é”™äº†ï¼Œåœ¨masterèŠ‚ç‚¹ä¸Šé¢çœ‹çœ‹docker images","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1674727290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359118,"user_name":"MonsterCale","can_delete":false,"product_type":"c1","uid":1018253,"ip_address":"åŒ—äº¬","ucode":"4B3C32DDDFEA37","user_header":"","comment_is_top":false,"comment_ctime":1665278464,"is_pvip":false,"replies":[{"id":130644,"content":"è¿™ä¸ªä¸åº”è¯¥å•Šï¼ŒæŠŠworkeråˆ é™¤é‡è£…è¯•è¯•å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1665356063,"ip_address":"åŒ—äº¬","comment_id":359118,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"workerèŠ‚ç‚¹kubeadm joinä¹‹åï¼ŒworkerèŠ‚ç‚¹ä¸Škubectl get nodesèƒ½çœ‹åˆ°masterã€workerèŠ‚ç‚¹éƒ½Readyäº†ï¼ŒmasterèŠ‚ç‚¹kubectl get nodesåªèƒ½çœ‹åˆ°masterèŠ‚ç‚¹çœ‹ä¸åˆ°workerèŠ‚ç‚¹ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆ","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589839,"discussion_content":"è¿™ä¸ªä¸åº”è¯¥å•Šï¼ŒæŠŠworkeråˆ é™¤é‡è£…è¯•è¯•å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665356063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356321,"user_name":"å¤§å¸ˆå…„","can_delete":false,"product_type":"c1","uid":1727181,"ip_address":"åŒ—äº¬","ucode":"8678D4E4DE426E","user_header":"https://static001.geekbang.org/account/avatar/00/1a/5a/cd/8710ed11.jpg","comment_is_top":false,"comment_ctime":1662133839,"is_pvip":false,"replies":[{"id":129694,"content":"åº”è¯¥æ˜¯WordPressæ²¡èƒ½å¤Ÿæ­£ç¡®è¿æ¥MariaDBï¼Œè¦çœ‹MariaDB ServiceåŸŸåï¼Œåœ¨WordPressé‡Œæ­£ç¡®é…ç½®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":1181974,"ctime":1662170154,"ip_address":"åŒ—äº¬","comment_id":356321,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"å¯¹æ¯”äº†ç›¸å…³gitä¸Šçš„æ–‡ä»¶ï¼Œé‡æ–°å¼„äº†ä¸€æ¬¡ï¼Œè®¿é—® wp.test  è¿”å›é”™è¯¯ä¿¡æ¯:\nError establishing a database connectionï¼Œæ˜¯å¦è¿˜éœ€è¦å…¶ä»–å†…å®¹è°ƒæ•´ï¼Œç›®å‰æ˜¯ç”¨äº†gitä¸Šçš„yamlï¼Œè·Ÿç€è§†é¢‘éƒ¨ç½²äº†ä¸€é","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586375,"discussion_content":"åº”è¯¥æ˜¯WordPressæ²¡èƒ½å¤Ÿæ­£ç¡®è¿æ¥MariaDBï¼Œè¦çœ‹MariaDB ServiceåŸŸåï¼Œåœ¨WordPressé‡Œæ­£ç¡®é…ç½®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662170154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1318240,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqa6ymmzSV4oTwgiaCKr7hUFAZno7lge7jJuJ1DIVNreg9tupO32cNZA9v76d5QPa58fOqxdXPn1Dg/132","nickname":"zf","note":"","ucode":"5DEB7CDD3D5A5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588323,"discussion_content":"çœ‹çœ‹podä¸­DNSæ˜¯å¦æ­£å¸¸è§£æã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663665411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354715,"user_name":"é¾™ä¹‹å¤§è€…","can_delete":false,"product_type":"c1","uid":1057665,"ip_address":"åŒ—äº¬","ucode":"1BB8B26EEDFE34","user_header":"https://static001.geekbang.org/account/avatar/00/10/23/81/3865297c.jpg","comment_is_top":false,"comment_ctime":1660707840,"is_pvip":false,"replies":[{"id":129064,"content":"åº”è¯¥æ˜¯workerèŠ‚ç‚¹ä¸Šæ²¡æœ‰æ‹·è´kubectlçš„configæ–‡ä»¶å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660777220,"ip_address":"åŒ—äº¬","comment_id":354715,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"workèŠ‚ç‚¹ä¸Šé¢ï¼Œjoinåˆ°é›†ç¾¤æˆåŠŸåï¼Œè¿è¡Œkubectl get nodesï¼ŒæŠ¥é”™å¦‚ä¸‹\nUnable to connect to the server: dial tcp 192.168.49.2:8443: connect: no route to host\n\nmasterèŠ‚ç‚¹ä¸Šé¢kubectl get nodesï¼Œå¯ä»¥çœ‹åˆ°masterå’Œworkerï¼ŒworkçŠ¶æ€not ready","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584338,"discussion_content":"åº”è¯¥æ˜¯workerèŠ‚ç‚¹ä¸Šæ²¡æœ‰æ‹·è´kubectlçš„configæ–‡ä»¶å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660777220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1318240,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqa6ymmzSV4oTwgiaCKr7hUFAZno7lge7jJuJ1DIVNreg9tupO32cNZA9v76d5QPa58fOqxdXPn1Dg/132","nickname":"zf","note":"","ucode":"5DEB7CDD3D5A5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588324,"discussion_content":"iptableså¯èƒ½è®¾ç½®æœ‰é”™è¯¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663665455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354626,"user_name":"BROOKS","can_delete":false,"product_type":"c1","uid":1219678,"ip_address":"åŒ—äº¬","ucode":"3CFC431DDABA3B","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/5e/80bbb02c.jpg","comment_is_top":false,"comment_ctime":1660625735,"is_pvip":false,"replies":[{"id":128994,"content":"æŸ¥ä¸€ä¸‹zshçš„å¸®åŠ©å§ï¼Œå¯èƒ½å˜é‡çš„ç”¨æ³•å’Œbash ä¸ä¸€æ ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660635288,"ip_address":"åŒ—äº¬","comment_id":354626,"utype":1}],"discussion_count":5,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"æœ‰ç”¨ oh my zsh çš„å—ï¼Œåœ¨ ~&#47;.zshrc ä¸­å®šä¹‰äº† export out=&quot;--dry-run=client -o yaml&quot;ï¼Œä½¿ç”¨å‘½ä»¤å¯¼å‡ºæ¨¡æ¿æ—¶ä¼šæç¤ºï¼š\nerror: Invalid dry-run value (client -o yaml). Must be &quot;none&quot;, &quot;server&quot;, or &quot;client&quot;.","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584124,"discussion_content":"æŸ¥ä¸€ä¸‹zshçš„å¸®åŠ©å§ï¼Œå¯èƒ½å˜é‡çš„ç”¨æ³•å’Œbash ä¸ä¸€æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660635288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447525,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eour3eIJEicAGibD1FTwKPibhxuKAzWaOshzpqGic5licrpw8ZxO0DIPbJxE5wsydHYxvren2Mnh7R18CQ/132","nickname":"äºŒåä¸€ç¬”ç”»","note":"","ucode":"32434652089812","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617496,"discussion_content":"æ‰§è¡Œï¼šsetopt SH_WORD_SPLITã€‚åº”è¯¥èƒ½è§£å†³ä½ çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683617052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2858725,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/9e/e5/9e732ec1.jpg","nickname":"æ³½","note":"","ucode":"44A1D076F59D60","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595543,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°è¿‡ ä¸€å¤©å¥½ç”¨ä¸€å¤©ä¸å¥½ç”¨ä¸çŸ¥é“ä¸ºå•¥ å¯èƒ½æ˜¯é‡å¯è¿‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670209207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é»‘é¾™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"å¥•","note":"","ucode":"73CEA468CE70C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584748,"discussion_content":"æœ‰è§£å†³å—ï¼Ÿ æˆ‘çš„ä¹Ÿæ˜¯è¿™æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661079436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584290,"discussion_content":"æˆ‘ä¹Ÿç”¨ zshï¼Œæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘è¿˜åŠ äº†å¥½å‡ æ¡ \n# kube\nexport out=&#34;--dry-run=client -o yaml&#34;\nexport kns=&#34;-n kube-system&#34;\nexport nns=&#34;-n nginx-ingress&#34;\nalias k=kubectl\n# kube end","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660723929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354450,"user_name":"å¢¨é¾™","can_delete":false,"product_type":"c1","uid":1309681,"ip_address":"åŒ—äº¬","ucode":"8C63C5D18E0877","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKvNozkiaiao1IyuCzEIMPiaNicB1hgEcad3X4DS6IAq5lnOiagf2690Q7Q1RmyBN89gNqYHeHHtY2RcqQ/132","comment_is_top":false,"comment_ctime":1660401998,"is_pvip":false,"replies":[{"id":128935,"content":"å¯èƒ½æ˜¯ç¬¬äºŒä¸ªpodè°ƒåº¦åˆ°äº†å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ­£åœ¨æ‹‰å–é•œåƒã€‚ä¹‹åå› ä¸ºèŠ‚ç‚¹ä¸Šéƒ½æœ‰é•œåƒï¼Œæ‰€ä»¥å®¹å™¨çš„å¯åŠ¨å°±å¾ˆå¿«äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660518969,"ip_address":"åŒ—äº¬","comment_id":354450,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"è¯·é—®è€å¸ˆï¼Œä¸ºä»€ä¹ˆreplicas=2çš„deploymentåˆ›å»ºç¬¬äºŒä¸ªpodçš„æ—¶å€™é‚£ä¹ˆæ…¢ï¼Œä½†æ˜¯scaleåˆ°replicas=5æ“ä½œæ—¶podå‡ ä¹ç§’æ‰©å®¹åˆ°äº†5ä¸ªï¼Ÿè°¢è°¢","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583933,"discussion_content":"å¯èƒ½æ˜¯ç¬¬äºŒä¸ªpodè°ƒåº¦åˆ°äº†å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ­£åœ¨æ‹‰å–é•œåƒã€‚ä¹‹åå› ä¸ºèŠ‚ç‚¹ä¸Šéƒ½æœ‰é•œåƒï¼Œæ‰€ä»¥å®¹å™¨çš„å¯åŠ¨å°±å¾ˆå¿«äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1660518969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390962,"user_name":"é»˜é»˜ä¸”å¬é£","can_delete":false,"product_type":"c1","uid":2539346,"ip_address":"åŒ—äº¬","ucode":"105E5FD2429AE3","user_header":"https://static001.geekbang.org/account/avatar/00/26/bf/52/59304c42.jpg","comment_is_top":false,"comment_ctime":1716887045,"is_pvip":false,"replies":[{"id":142183,"content":"great","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1716953658,"ip_address":"ä¸Šæµ·","comment_id":390962,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"è‡ªå·±ç”¨k3sçæäº†ä¸€å¹´å¤šï¼Œå›æ¥å†çœ‹è€å¸ˆè¿™ç¯‡æ–‡ç« æœ‰ç§èŒ…å¡é¡¿å¼€çš„èµ¶è„š","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645883,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716953658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389112,"user_name":"Geek_07ead6","can_delete":false,"product_type":"c1","uid":1714992,"ip_address":"å¹¿ä¸œ","ucode":"424137ADA9AA23","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoREZlw6JWh1OXYvcKhOToBPCSqVr33Vhc0gmW9jNT3JHtW7NtaiaiaNJicjjxyVia7Oec3Qq1bzLGreQ/132","comment_is_top":false,"comment_ctime":1711607444,"is_pvip":false,"replies":[{"id":141597,"content":"è¿™ä¸¤ä¸ªä¸å†²çªï¼ŒhostNetworkè·³è¿‡äº†Kubernetesè‡ªå·±çš„serviceæœºåˆ¶ï¼Œæ•ˆç‡æ›´é«˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1711940317,"ip_address":"ä¸Šæµ·","comment_id":389112,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"â€œåœ¨ä¹‹å‰è®²åŸºæœ¬æ¶æ„çš„æ—¶å€™æˆ‘è¯´è¿‡äº†ï¼Œè¿™ä¸ª Ingress Controller ä¸ä½¿ç”¨ Serviceï¼Œè€Œæ˜¯ç»™å®ƒçš„ Pod åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šå­—æ®µ hostNetworkï¼Œè®© Pod èƒ½å¤Ÿä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œï¼Œç›¸å½“äºå¦ä¸€ç§å½¢å¼çš„ NodePortâ€\n\nè€å¸ˆï¼Œè¿™é‡Œçœ‹æœ€åIngress controllerè¿˜æ˜¯ä½¿ç”¨serviceçš„NodePortå½¢å¼æš´éœ²çš„è®¿é—®æ–¹å¼ï¼Œæ²¡çœ‹å‡ºæ¥hostNetworkèµ·åˆ°çš„ä½œç”¨å‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640850,"discussion_content":"è¿™ä¸¤ä¸ªä¸å†²çªï¼ŒhostNetworkè·³è¿‡äº†Kubernetesè‡ªå·±çš„serviceæœºåˆ¶ï¼Œæ•ˆç‡æ›´é«˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711940317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385987,"user_name":"åˆ˜ä¼Ÿ","can_delete":false,"product_type":"c1","uid":2994939,"ip_address":"æ–°åŠ å¡","ucode":"80189491D94C81","user_header":"https://static001.geekbang.org/account/avatar/00/2d/b2/fb/ed919876.jpg","comment_is_top":false,"comment_ctime":1703776526,"is_pvip":false,"replies":[{"id":140667,"content":"è¿™ä¸¤ä¸ªPodåº”è¯¥éƒ½æ˜¯ä¸€ä¸ªç½‘æ®µï¼Œéƒ½æ˜¯10.x.x.xï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åé¢çš„è®²SNIçš„é‚£èŠ‚è¯¾ï¼Œé‡è£…Flannelè¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1703816548,"ip_address":"ä¸Šæµ·","comment_id":385987,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"åœ¨ä½¿ç”¨äº†æœ¬æ–‡çš„é…ç½®åï¼Œæˆ‘å‘ç°æˆ‘çš„æœºå™¨ä¸Šï¼Œ master å’Œ worker çš„ pod å¹¶ä¸èƒ½ç›¸äº’ping é€šã€‚ \nmaster çš„ pod çš„ç½‘æ®µæ˜¯ 10.0.0.x, è€Œ worker ä¸Šé¢çš„æ˜¯ 10.0.1.x  \nmaster ä¸Šé¢ç›´æ¥ ping worker ä¸Šçš„ pod ä¸èƒ½æˆåŠŸã€‚ å°±ç®—è¿›å…¥åˆ°äº† pod é‡Œé¢ï¼Œ ä¹Ÿä¸èƒ½ç›¸äº’ping é€šã€‚ \n\nåŒæ—¶ï¼Œ svc çš„è¯ä¹Ÿä¸€æ ·ï¼Œè™½ç„¶ kubectl describe svc xxx èƒ½å¤Ÿçœ‹å¾—å‡ºæ¥ svc ä»£ç†äº†master &#47; worker çš„ä¸åŒçš„ pod. ä½†æ˜¯ curl  çš„æ—¶å€™ï¼Œ ä¼šå‘ç°æœ‰ä¸€äº›ä¸èƒ½æˆåŠŸï¼Œ åº”è¯¥ä¹Ÿæ˜¯å’Œ ä¸Šè¿° pod ä¸èƒ½ç›¸äº’ping é€šæœ‰å…³ç³»ï¼Œ \n\nè¯·é—®è¿™ä¸ªæ€ä¹ˆè§£å†³?\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":634690,"discussion_content":"è¿™ä¸¤ä¸ªPodåº”è¯¥éƒ½æ˜¯ä¸€ä¸ªç½‘æ®µï¼Œéƒ½æ˜¯10.x.x.xï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åé¢çš„è®²SNIçš„é‚£èŠ‚è¯¾ï¼Œé‡è£…Flannelè¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1703816548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354590,"user_name":"èŠ±èŠ±å¤§è„¸çŒ«","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"åŒ—äº¬","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1660572270,"is_pvip":true,"replies":[{"id":128964,"content":"è¯•ç€é‡å¯ä¸€ä¸‹ä¸»æœºè¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660614050,"ip_address":"åŒ—äº¬","comment_id":354590,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"æœ‰ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼šsudo vi &#47;etc&#47;hostnameå·²ç»è¦æ±‚æ”¹æˆmasteräº†ï¼Œå¹¶ä¸”å‘½ä»¤è¡Œhostnameæ˜¾å¼çš„ä¹Ÿæ˜¯masterï¼Œä½†æ˜¯é€šè¿‡kubectl get node è·å–åˆ°çš„nameè¿˜æ˜¯ä¿®æ”¹ä¹‹å‰çš„åç§°ï¼ï¼","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584068,"discussion_content":"è¯•ç€é‡å¯ä¸€ä¸‹ä¸»æœºè¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660614051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"èŠ±èŠ±å¤§è„¸çŒ«","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584323,"discussion_content":"å¯ä»¥äº† æ„Ÿè°¢å„ä½ï¼ï¼ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660747069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584299,"discussion_content":"å¯ä»¥è¯•è¯• kubectl edit no &lt;nodeå&gt;ä¿®æ”¹ ã€‚å¯èƒ½ä¹Ÿè¦æ›´æ–° /etc/hosts ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660726740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354346,"user_name":"æˆ’è´ªå—”ç—´","can_delete":false,"product_type":"c1","uid":3017168,"ip_address":"åŒ—äº¬","ucode":"D53EA3525DBD71","user_header":"https://static001.geekbang.org/account/avatar/00/2e/09/d0/8609bddc.jpg","comment_is_top":false,"comment_ctime":1660293501,"is_pvip":false,"replies":[{"id":128887,"content":"éƒ½åœ¨GitHubä¸Šï¼Œçœ‹è¯¾å‰å‡†å¤‡é‚£ä¸€èŠ‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1181974,"ctime":1660306912,"ip_address":"åŒ—äº¬","comment_id":354346,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"è€å¸ˆè¿™è¾¹æœ‰æ²¡æœ‰æ¼”ç¤ºçš„ymlæ–‡ä»¶åœ°å€ï¼Œæƒ³è·Ÿç€æ“ç»ƒä¸€ç•ªï¼ŒğŸ«£","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"ç½—å‰‘é”‹","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583713,"discussion_content":"éƒ½åœ¨GitHubä¸Šï¼Œçœ‹è¯¾å‰å‡†å¤‡é‚£ä¸€èŠ‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660306912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}