{"id":40008,"title":"12 | 牛刀小试：我的第一个容器化应用","content":"<p>你好，我是张磊。今天我和你分享的主题是：牛刀小试之我的第一个容器化应用。</p><p>在上一篇文章《从0到1：搭建一个完整的Kubernetes集群》中，我和你一起部署了一套完整的Kubernetes集群。这个集群虽然离生产环境的要求还有一定差距（比如，没有一键高可用部署），但也可以当作是一个准生产级别的Kubernetes集群了。</p><p>而在这篇文章中，我们就来扮演一个应用开发者的角色，使用这个Kubernetes集群发布第一个容器化应用。</p><p>在开始实践之前，我先给你讲解一下Kubernetes里面与开发者关系最密切的几个概念。</p><p>作为一个应用开发者，你首先要做的，是制作容器的镜像。这一部分内容，我已经在容器基础部分<a href=\"https://time.geekbang.org/column/article/17921\">《白话容器基础（三）：深入理解容器镜像》</a>重点讲解过了。</p><p>而有了容器镜像之后，你需要按照Kubernetes项目的规范和要求，将你的镜像组织为它能够“认识”的方式，然后提交上去。</p><p>那么，<span class=\"orange\">什么才是Kubernetes项目能“认识”的方式呢？</span></p><p>这就是使用Kubernetes的必备技能：编写配置文件。</p><blockquote>\n<p>备注：这些配置文件可以是YAML或者JSON格式的。为方便阅读与理解，在后面的讲解中，我会统一使用YAML文件来指代它们。</p>\n</blockquote><!-- [[[read_end]]] --><p>Kubernetes跟Docker等很多项目最大的不同，就在于它不推荐你使用命令行的方式直接运行容器（虽然Kubernetes项目也支持这种方式，比如：kubectl run），而是希望你用YAML文件的方式，即：把容器的定义、参数、配置，统统记录在一个YAML文件中，然后用这样一句指令把它运行起来：</p><pre><code>$ kubectl create -f 我的配置文件\n</code></pre><p>这么做最直接的好处是，你会有一个文件能记录下Kubernetes到底“run”了什么。比如下面这个例子：</p><pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n</code></pre><p>像这样的一个YAML文件，对应到Kubernetes中，就是一个API Object（API对象）。当你为这个对象的各个字段填好值并提交给Kubernetes之后，Kubernetes就会负责创建出这些对象所定义的容器或者其他类型的API资源。</p><p>可以看到，这个YAML文件中的Kind字段，指定了这个API对象的类型（Type），是一个Deployment。</p><p>所谓Deployment，是一个定义多副本应用（即多个副本Pod）的对象，我在前面的文章中（也是第9篇文章《从容器到容器云：谈谈Kubernetes的本质》）曾经简单提到过它的用法。此外，Deployment还负责在Pod定义发生变化时，对每个副本进行滚动更新（Rolling Update）。</p><p>在上面这个YAML文件中，我给它定义的Pod副本个数(spec.replicas)是：2。</p><p>而这些Pod具体的又长什么样子呢？</p><p>为此，我定义了一个Pod模版（spec.template），这个模版描述了我想要创建的Pod的细节。在上面的例子里，这个Pod里只有一个容器，这个容器的镜像（spec.containers.image）是nginx:1.7.9，这个容器监听端口（containerPort）是80。</p><p>关于Pod的设计和用法我已经在第9篇文章<a href=\"https://time.geekbang.org/column/article/23132\">《从容器到容器云：谈谈Kubernetes的本质》</a>中简单的介绍过。而在这里，你需要记住这样一句话：</p><blockquote>\n<p>Pod就是Kubernetes世界里的“应用”；而一个应用，可以由多个容器组成。</p>\n</blockquote><p>需要注意的是，像这样使用一种API对象（Deployment）管理另一种API对象（Pod）的方法，在Kubernetes中，叫作“控制器”模式（controller pattern）。在我们的例子中，Deployment扮演的正是Pod的控制器的角色。关于Pod和控制器模式的更多细节，我会在后续编排部分做进一步讲解。</p><p>你可能还注意到，这样的每一个API对象都有一个叫作Metadata的字段，这个字段就是API对象的“标识”，即元数据，它也是我们从Kubernetes里找到这个对象的主要依据。这其中最主要使用到的字段是Labels。</p><p>顾名思义，Labels就是一组key-value格式的标签。而像Deployment这样的控制器对象，就可以通过这个Labels字段从Kubernetes中过滤出它所关心的被控制对象。</p><p>比如，在上面这个YAML文件中，Deployment会把所有正在运行的、携带“app: nginx”标签的Pod识别为被管理的对象，并确保这些Pod的总数严格等于两个。</p><p>而这个过滤规则的定义，是在Deployment的“spec.selector.matchLabels”字段。我们一般称之为：Label Selector。</p><p>另外，在Metadata中，还有一个与Labels格式、层级完全相同的字段叫Annotations，它专门用来携带key-value格式的内部信息。所谓内部信息，指的是对这些信息感兴趣的，是Kubernetes组件本身，而不是用户。所以大多数Annotations，都是在Kubernetes运行过程中，被自动加在这个API对象上。</p><p>一个Kubernetes的API对象的定义，大多可以分为Metadata和Spec两个部分。前者存放的是这个对象的元数据，对所有API对象来说，这一部分的字段和格式基本上是一样的；而后者存放的，则是属于这个对象独有的定义，用来描述它所要表达的功能。</p><p><span class=\"orange\">在了解了上述Kubernetes配置文件的基本知识之后，我们现在就可以把这个YAML文件“运行”起来。</span>正如前所述，你可以使用kubectl create指令完成这个操作：</p><pre><code>$ kubectl create -f nginx-deployment.yaml\n</code></pre><p>然后，通过kubectl get命令检查这个YAML运行起来的状态是不是与我们预期的一致：</p><pre><code>$ kubectl get pods -l app=nginx\nNAME                                READY     STATUS    RESTARTS   AGE\nnginx-deployment-67594d6bf6-9gdvr   1/1       Running   0          10m\nnginx-deployment-67594d6bf6-v6j7w   1/1       Running   0          10m\n</code></pre><p>kubectl get指令的作用，就是从Kubernetes里面获取（GET）指定的API对象。可以看到，在这里我还加上了一个-l参数，即获取所有匹配app: nginx标签的Pod。需要注意的是，<strong>在命令行中，所有key-value格式的参数，都使用“=”而非“:”表示。</strong></p><p>从这条指令返回的结果中，我们可以看到现在有两个Pod处于Running状态，也就意味着我们这个Deployment所管理的Pod都处于预期的状态。</p><p>此外， 你还可以使用kubectl describe命令，查看一个API对象的细节，比如：</p><pre><code>$ kubectl describe pod nginx-deployment-67594d6bf6-9gdvr\nName:               nginx-deployment-67594d6bf6-9gdvr\nNamespace:          default\nPriority:           0\nPriorityClassName:  &lt;none&gt;\nNode:               node-1/10.168.0.3\nStart Time:         Thu, 16 Aug 2018 08:48:42 +0000\nLabels:             app=nginx\n                    pod-template-hash=2315082692\nAnnotations:        &lt;none&gt;\nStatus:             Running\nIP:                 10.32.0.23\nControlled By:      ReplicaSet/nginx-deployment-67594d6bf6\n...\nEvents:\n\n  Type     Reason                  Age                From               Message\n\n  ----     ------                  ----               ----               -------\n  \n  Normal   Scheduled               1m                 default-scheduler  Successfully assigned default/nginx-deployment-67594d6bf6-9gdvr to node-1\n  Normal   Pulling                 25s                kubelet, node-1    pulling image &quot;nginx:1.7.9&quot;\n  Normal   Pulled                  17s                kubelet, node-1    Successfully pulled image &quot;nginx:1.7.9&quot;\n  Normal   Created                 17s                kubelet, node-1    Created container\n  Normal   Started                 17s                kubelet, node-1    Started container\n</code></pre><p>在kubectl describe命令返回的结果中，你可以清楚地看到这个Pod的详细信息，比如它的IP地址等等。其中，有一个部分值得你特别关注，它就是<strong>Events（事件）。</strong></p><p>在Kubernetes执行的过程中，对API对象的所有重要操作，都会被记录在这个对象的Events里，并且显示在kubectl describe指令返回的结果中。</p><p>比如，对于这个Pod，我们可以看到它被创建之后，被调度器调度（Successfully assigned）到了node-1，拉取了指定的镜像（pulling image），然后启动了Pod里定义的容器（Started container）。</p><p>所以，这个部分正是我们将来进行Debug的重要依据。<strong>如果有异常发生，你一定要第一时间查看这些Events</strong>，往往可以看到非常详细的错误信息。</p><p><span class=\"orange\">接下来，如果我们要对这个Nginx服务进行升级，把它的镜像版本从1.7.9升级为1.8，要怎么做呢？</span></p><p>很简单，我们只要修改这个YAML文件即可。</p><pre><code>...    \n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.8 #这里被从1.7.9修改为1.8\n        ports:\n      - containerPort: 80\n</code></pre><p>可是，这个修改目前只发生在本地，如何让这个更新在Kubernetes里也生效呢？</p><p>我们可以使用kubectl replace指令来完成这个更新：</p><pre><code> $ kubectl replace -f nginx-deployment.yaml\n</code></pre><p>不过，在本专栏里，我推荐你使用kubectl apply命令，来统一进行Kubernetes对象的创建和更新操作，具体做法如下所示：</p><pre><code>$ kubectl apply -f nginx-deployment.yaml\n\n# 修改nginx-deployment.yaml的内容\n\n$ kubectl apply -f nginx-deployment.yaml\n</code></pre><p>这样的操作方法，是Kubernetes“声明式API”所推荐的使用方法。也就是说，作为用户，你不必关心当前的操作是创建，还是更新，你执行的命令始终是kubectl apply，而Kubernetes则会根据YAML文件的内容变化，自动进行具体的处理。</p><p>而这个流程的好处是，它有助于帮助开发和运维人员，围绕着可以版本化管理的YAML文件，而不是“行踪不定”的命令行进行协作，从而大大降低开发人员和运维人员之间的沟通成本。</p><p>举个例子，一位开发人员开发好一个应用，制作好了容器镜像。那么他就可以在应用的发布目录里附带上一个Deployment的YAML文件。</p><p>而运维人员，拿到这个应用的发布目录后，就可以直接用这个YAML文件执行kubectl apply操作把它运行起来。</p><p>这时候，如果开发人员修改了应用，生成了新的发布内容，那么这个YAML文件，也就需要被修改，并且成为这次变更的一部分。</p><p>而接下来，运维人员可以使用git diff命令查看到这个YAML文件本身的变化，然后继续用kubectl apply命令更新这个应用。</p><p>所以说，如果通过容器镜像，我们能够保证应用本身在开发与部署环境里的一致性的话，那么现在，Kubernetes项目通过这些YAML文件，就保证了应用的“部署参数”在开发与部署环境中的一致性。</p><p><strong>而当应用本身发生变化时，开发人员和运维人员可以依靠容器镜像来进行同步；当应用部署参数发生变化时，这些YAML文件就是他们相互沟通和信任的媒介。</strong></p><p>以上，就是Kubernetes发布应用的最基本操作了。</p><p>接下来，我们再在这个Deployment中尝试声明一个Volume。</p><p>在Kubernetes中，Volume是属于Pod对象的一部分。所以，我们就需要修改这个YAML文件里的template.spec字段，如下所示：</p><pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.8\n        ports:\n        - containerPort: 80\n        volumeMounts:\n        - mountPath: &quot;/usr/share/nginx/html&quot;\n          name: nginx-vol\n      volumes:\n      - name: nginx-vol\n        emptyDir: {}\n</code></pre><p>可以看到，我们在Deployment的Pod模板部分添加了一个volumes字段，定义了这个Pod声明的所有Volume。它的名字叫作nginx-vol，类型是emptyDir。</p><p>那什么是emptyDir类型呢？</p><p>它其实就等同于我们之前讲过的Docker的隐式Volume参数，即：不显式声明宿主机目录的Volume。所以，Kubernetes也会在宿主机上创建一个临时目录，这个目录将来就会被绑定挂载到容器所声明的Volume目录上。</p><blockquote>\n<p>备注：不难看到，Kubernetes的emptyDir类型，只是把Kubernetes创建的临时目录作为Volume的宿主机目录，交给了Docker。这么做的原因，是Kubernetes不想依赖Docker自己创建的那个_data目录。</p>\n</blockquote><p>而Pod中的容器，使用的是volumeMounts字段来声明自己要挂载哪个Volume，并通过mountPath字段来定义容器内的Volume目录，比如：/usr/share/nginx/html。</p><p>当然，Kubernetes也提供了显式的Volume定义，它叫作hostPath。比如下面的这个YAML文件：</p><pre><code> ...   \n    volumes:\n      - name: nginx-vol\n        hostPath: \n          path:  &quot; /var/data&quot;\n</code></pre><p>这样，容器Volume挂载的宿主机目录，就变成了/var/data。</p><p>在上述修改完成后，我们还是使用kubectl apply指令，更新这个Deployment:</p><pre><code>$ kubectl apply -f nginx-deployment.yaml\n</code></pre><p>接下来，你可以通过kubectl get指令，查看两个Pod被逐一更新的过程：</p><pre><code>$ kubectl get pods\nNAME                                READY     STATUS              RESTARTS   AGE\nnginx-deployment-5c678cfb6d-v5dlh   0/1       ContainerCreating   0          4s\nnginx-deployment-67594d6bf6-9gdvr   1/1       Running             0          10m\nnginx-deployment-67594d6bf6-v6j7w   1/1       Running             0          10m\n$ kubectl get pods\nNAME                                READY     STATUS    RESTARTS   AGE\nnginx-deployment-5c678cfb6d-lg9lw   1/1       Running   0          8s\nnginx-deployment-5c678cfb6d-v5dlh   1/1       Running   0          19s\n</code></pre><p>从返回结果中，我们可以看到，新旧两个Pod，被交替创建、删除，最后剩下的就是新版本的Pod。这个滚动更新的过程，我也会在后续进行详细的讲解。</p><p>然后，你可以使用kubectl describe查看一下最新的Pod，就会发现Volume的信息已经出现在了Container描述部分：</p><pre><code>...\nContainers:\n  nginx:\n    Container ID:   docker://07b4f89248791c2aa47787e3da3cc94b48576cd173018356a6ec8db2b6041343\n    Image:          nginx:1.8\n    ...\n    Environment:    &lt;none&gt;\n    Mounts:\n      /usr/share/nginx/html from nginx-vol (rw)\n...\nVolumes:\n  nginx-vol:\n    Type:    EmptyDir (a temporary directory that shares a pod's lifetime)\n</code></pre><blockquote>\n<p>备注：作为一个完整的容器化平台项目，Kubernetes为我们提供的Volume类型远远不止这些，在容器存储章节里，我将会为你详细介绍这部分内容。</p>\n</blockquote><p>最后，你还可以使用kubectl exec指令，进入到这个Pod当中（即容器的Namespace中）查看这个Volume目录：</p><pre><code>$ kubectl exec -it nginx-deployment-5c678cfb6d-lg9lw -- /bin/bash\n# ls /usr/share/nginx/html\n</code></pre><p>此外，你想要从Kubernetes集群中删除这个Nginx Deployment的话，直接执行：</p><pre><code>$ kubectl delete -f nginx-deployment.yaml\n</code></pre><p>就可以了。</p><h2>总结</h2><p>在今天的分享中，我通过一个小案例，和你近距离体验了Kubernetes的使用方法。</p><p>可以看到，Kubernetes推荐的使用方式，是用一个YAML文件来描述你所要部署的API对象。然后，统一使用kubectl apply命令完成对这个对象的创建和更新操作。</p><p>而Kubernetes里“最小”的API对象是Pod。Pod可以等价为一个应用，所以，Pod可以由多个紧密协作的容器组成。</p><p>在Kubernetes中，我们经常会看到它通过一种API对象来管理另一种API对象，比如Deployment和Pod之间的关系；而由于Pod是“最小”的对象，所以它往往都是被其他对象控制的。这种组合方式，正是Kubernetes进行容器编排的重要模式。</p><p>而像这样的Kubernetes API对象，往往由Metadata和Spec两部分组成，其中Metadata里的Labels字段是Kubernetes过滤对象的主要手段。</p><p>在这些字段里面，容器想要使用的数据卷，也就是Volume，正是Pod的Spec字段的一部分。而Pod里的每个容器，则需要显式的声明自己要挂载哪个Volume。</p><p>上面这些基于YAML文件的容器管理方式，跟Docker、Mesos的使用习惯都是不一样的，而从docker run这样的命令行操作，向kubectl apply YAML文件这样的声明式API的转变，是每一个容器技术学习者，必须要跨过的第一道门槛。</p><p>所以，如果你想要快速熟悉Kubernetes，请按照下面的流程进行练习：</p><ul>\n<li>首先，在本地通过Docker测试代码，制作镜像；</li>\n<li>然后，选择合适的Kubernetes API对象，编写对应YAML文件（比如，Pod，Deployment）；</li>\n<li>最后，在Kubernetes上部署这个YAML文件。</li>\n</ul><p>更重要的是，在部署到Kubernetes之后，接下来的所有操作，要么通过kubectl来执行，要么通过修改YAML文件来实现，<strong>就尽量不要再碰Docker的命令行了</strong>。</p><h2>思考题</h2><p>在实际使用Kubernetes的过程中，相比于编写一个单独的Pod的YAML文件，我一定会推荐你使用一个replicas=1的Deployment。请问，这两者有什么区别呢？</p><p>感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p>","neighbors":{"left":{"article_title":"11 | 从0到1：搭建一个完整的Kubernetes集群","id":39724},"right":{"article_title":"13 | 为什么我们需要Pod？","id":40092}},"comments":[{"had_liked":false,"id":25533,"user_name":"gogo","can_delete":false,"product_type":"c1","uid":1003104,"ip_address":"","ucode":"E8F0F3B000020A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/60/0d5aa340.jpg","comment_is_top":false,"comment_ctime":1537356652,"is_pvip":false,"replies":[{"id":"9277","content":"对的","user_name":"作者回复","comment_id":25533,"uid":"1218095","ip_address":"","utype":1,"ctime":1537363534,"user_name_real":"Geek_6ef93d"}],"discussion_count":7,"race_medal":0,"score":"1015149638508","product_id":100015201,"comment_content":"推荐使用replica=1而不使用单独pod的主要原因是pod所在的节点出故障的时候 pod可以调度到健康的节点上，单独的pod只能在节点健康的情况下由kubelet保证pod的健康状况吧","like_count":237,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424336,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537363534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2589474,"avatar":"https://static001.geekbang.org/account/avatar/00/27/83/22/a44b65f5.jpg","nickname":"JamonJou","note":"","ucode":"C77E647E2FA7A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542154,"discussion_content":"一个master，3个node，部署2个副本的nginx后，关掉有nginx的一个node，发现不能调度到新的node上，node的状态也是notready，关掉的nginx的log也显示Warning，就是没有调度。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640673111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380991,"discussion_content":"absolute right","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624857330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2175116,"avatar":"https://static001.geekbang.org/account/avatar/00/21/30/8c/6c86eaac.jpg","nickname":"LiWZ","note":"","ucode":"18406E7E3BA475","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387706,"discussion_content":"absolutely","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1628356556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":380991,"ip_address":""},"score":387706,"extra":""}]},{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"鹤无双","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352293,"discussion_content":"其实可以写一个污点或者 nodeName 字段绑定你的 pod 固定到想要固定的 NODE 上，replica=1 只能说也不能绑定，然后数据的话做一个持久化的 pv 和 pvc 声明即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614675632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2394694,"avatar":"https://static001.geekbang.org/account/avatar/00/24/8a/46/a75684ea.jpg","nickname":"弗拉基米尔·伊里奇·乌里扬诺夫","note":"","ucode":"9C6725A91BC06C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349480,"discussion_content":"应该也是为什么推荐使用 deployment 来管理 pod 的原因吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613228953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1763046,"avatar":"","nickname":"与君共勉","note":"","ucode":"1FB5EBFCF510A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339737,"discussion_content":"一直在找这个答案，终于找到了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609766013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53836,"user_name":"D","can_delete":false,"product_type":"c1","uid":1210514,"ip_address":"","ucode":"CCB5CADA48A734","user_header":"https://static001.geekbang.org/account/avatar/00/12/78/92/ae2c1b12.jpg","comment_is_top":false,"comment_ctime":1545738984,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"276423645928","product_id":100015201,"comment_content":"这里关于describe有一点要注意，就是如果namespace不是default的话，就需要加上-n younamespace才能看到相应的内容","like_count":65},{"had_liked":false,"id":29198,"user_name":"Jeff.W","can_delete":false,"product_type":"c1","uid":1140420,"ip_address":"","ucode":"2043F83FB7B39C","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/c4/038f9325.jpg","comment_is_top":false,"comment_ctime":1538285102,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"190516846126","product_id":100015201,"comment_content":"replicas=1代表是始终有1个实例可用，而单独的pod就真的是单独的pod了～","like_count":45},{"had_liked":false,"id":25574,"user_name":"shao","can_delete":false,"product_type":"c1","uid":1225710,"ip_address":"","ucode":"3C6998ED8F6F3C","user_header":"https://static001.geekbang.org/account/avatar/00/12/b3/ee/ab2226c0.jpg","comment_is_top":false,"comment_ctime":1537367164,"is_pvip":false,"replies":[{"id":"9332","content":"已修正","user_name":"作者回复","comment_id":25574,"uid":"1218095","ip_address":"","utype":1,"ctime":1537408887,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"113206516860","product_id":100015201,"comment_content":"下面的写法有问题<br>hostPath: &#47;var&#47;data<br>建议改成：<br>volumes:<br>        - name: nginx-vol<br>          hostPath:<br>            path: &quot;&#47;home&#47;vagrant&#47;mykube&#47;firstapp&#47;html&quot;<br><br>","like_count":27,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424348,"discussion_content":"已修正","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537408887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25403,"user_name":"千寻","can_delete":false,"product_type":"c1","uid":1058635,"ip_address":"","ucode":"44A559E38819C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/4b/170654bb.jpg","comment_is_top":false,"comment_ctime":1537323620,"is_pvip":false,"replies":[{"id":"9221","content":"临时写文件，又不想提交到镜像里。另外，volume并不跟pod同生命周期，不会删的这么快。","user_name":"作者回复","comment_id":25403,"uid":"1218095","ip_address":"","utype":1,"ctime":1537326706,"user_name_real":"Geek_6ef93d"}],"discussion_count":5,"race_medal":0,"score":"104616538724","product_id":100015201,"comment_content":"emptyDir创建一个临时目录，pod删除之后临时目录也会被删除。在平时的使用下，有哪些场景会用到这种类型volume呢？","like_count":24,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424290,"discussion_content":"临时写文件，又不想提交到镜像里。另外，volume并不跟pod同生命周期，不会删的这么快。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537326706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259323,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","nickname":"陈斯佳","note":"","ucode":"C236F874FC767A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399844,"discussion_content":"在同一个pod里有多个containers，且这些container之间需要交换数据的时间，就会用到这个场景了","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1633080641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374593,"discussion_content":"emptyDir和pod是同生命周期的","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1621258825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140876,"avatar":"https://static001.geekbang.org/account/avatar/00/11/68/8c/b1f277a5.jpg","nickname":"闪闪电电","note":"","ucode":"FA5520FA98F739","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549830,"discussion_content":"Volumes:\n  nginx-vol:\n    Type:       EmptyDir (a temporary directory that shares a pod&#39;s lifetime)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644248617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2189618,"avatar":"","nickname":"咕噜咕噜地","note":"","ucode":"1503E8A088EBDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373429,"discussion_content":"emptydir的生命周期和使用它的pod的生命周期不一样么？那么emptydir是什么情况下会被完全删除啊？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620725542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25643,"user_name":"巩夫建","can_delete":false,"product_type":"c1","uid":1222958,"ip_address":"","ucode":"6B06A4399D2338","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/2e/01b2839e.jpg","comment_is_top":false,"comment_ctime":1537404734,"is_pvip":false,"replies":[{"id":"9327","content":"可以使用placeholder，或者yaml模板jinja","user_name":"作者回复","comment_id":25643,"uid":"1218095","ip_address":"","utype":1,"ctime":1537408703,"user_name_real":"Geek_6ef93d"}],"discussion_count":5,"race_medal":0,"score":"83141783358","product_id":100015201,"comment_content":"yaml文件中如何使用变量，不是环境变量env那种，而是我在yaml定义一个版本号的变量，当版本发生变更，我只需要修改版本号变量，或者外部传参就行了。不希望频繁修改yaml文件。","like_count":20,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424372,"discussion_content":"可以使用placeholder，或者yaml模板jinja","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537408703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2598745,"avatar":"","nickname":"Geek_15f028","note":"","ucode":"5DD5FEF3B55F16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544789,"discussion_content":"helm 是时候登场了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641715257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348028,"discussion_content":"ansible的逻辑～目前还有点不明了，继续学习看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612407147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2398871,"avatar":"https://static001.geekbang.org/account/avatar/00/24/9a/97/c44ef3a1.jpg","nickname":"shui","note":"","ucode":"791786FBC1C592","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338901,"discussion_content":"helm？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609414702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121111,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1b/57/150c9b10.jpg","nickname":"柏元刚","note":"","ucode":"A88968932063CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":176159,"discussion_content":"遇到同事了😄😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582027289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25514,"user_name":"fiisio","can_delete":false,"product_type":"c1","uid":1148088,"ip_address":"","ucode":"87CB8F5EAA033B","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/b8/0b73ecdc.jpg","comment_is_top":false,"comment_ctime":1537350238,"is_pvip":false,"replies":[{"id":"9281","content":"2k节点一般得用saltstack等专业武器了，毕竟管2k个机器已经可以排除大部分工具了……","user_name":"作者回复","comment_id":25514,"uid":"1218095","ip_address":"","utype":1,"ctime":1537363677,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"74551794270","product_id":100015201,"comment_content":"想问下大规模集群使用怎样的部署方式比较好，主要考虑到后期的运维，更新？例如2000节点以上。","like_count":17,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424330,"discussion_content":"2k节点一般得用saltstack等专业武器了，毕竟管2k个机器已经可以排除大部分工具了……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537363677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26647,"user_name":"北卡","can_delete":false,"product_type":"c1","uid":1218128,"ip_address":"","ucode":"2D947A61689FC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/50/bde525b1.jpg","comment_is_top":false,"comment_ctime":1537711995,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"65962221435","product_id":100015201,"comment_content":"Deployment管理replicaSet，replicaSet管理pod，使pod始终保持期望状态。<br>使用deployment的方式，方便后面有扩容，更新，回滚等需求。也可以在pod down掉时自动重启。","like_count":15},{"had_liked":false,"id":25406,"user_name":"wilder","can_delete":false,"product_type":"c1","uid":1007682,"ip_address":"","ucode":"C176379126D007","user_header":"https://static001.geekbang.org/account/avatar/00/0f/60/42/8a79c613.jpg","comment_is_top":false,"comment_ctime":1537323719,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57371898567","product_id":100015201,"comment_content":"赞一个，已经跟了好多期了，讲得形象生动又不失深度。","like_count":13},{"had_liked":false,"id":31333,"user_name":"西堤小筑","can_delete":false,"product_type":"c1","uid":1043593,"ip_address":"","ucode":"3B041520D47205","user_header":"","comment_is_top":false,"comment_ctime":1539152790,"is_pvip":false,"replies":[{"id":"11297","content":"一样的啊，写private registry不就可以了。密码可以用Secret保存。","user_name":"作者回复","comment_id":31333,"uid":"1218095","ip_address":"","utype":1,"ctime":1539187977,"user_name_real":"Geek_6ef93d"}],"discussion_count":3,"race_medal":0,"score":"53078760342","product_id":100015201,"comment_content":"老师您好，咨询一个问题：<br>对于一些需要科学上网才能pull下来的docker image，通常是使用docker hub上的私人image pull到本地再改tag来完成。但k8s上用yaml写的image地址，运行的时候就直接从网上pull了，什么写法可以做到使用本地image，不让k8s从网上pull呢？","like_count":12,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426298,"discussion_content":"一样的啊，写private registry不就可以了。密码可以用Secret保存。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539187977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2091644,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/ea/7c/9417dbbc.jpg","nickname":"提百万的超神梦","note":"","ucode":"53932395568AC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310524,"discussion_content":"提问者的问题可能是因为imagePullPolicy 这个参数配置的问题， 配置为IfNotPresent 就不会每次都再次pull 而是使用本地image","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1601890645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1147711,"avatar":"https://static001.geekbang.org/account/avatar/00/11/83/3f/bc2ea80d.jpg","nickname":"陌.寒哲","note":"","ucode":"B7079FF211D712","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":56984,"discussion_content":"私人镜像仓库可以按老师说的加个secret。但如果你就是确实希望用本地的而不要pull，可以指定imagePullPolicy的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574556748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25685,"user_name":"落叶","can_delete":false,"product_type":"c1","uid":1051640,"ip_address":"","ucode":"7A620000287B34","user_header":"https://static001.geekbang.org/account/avatar/00/10/0b/f8/25709af3.jpg","comment_is_top":false,"comment_ctime":1537409802,"is_pvip":false,"replies":[{"id":"9348","content":"你都说了是长链接了……","user_name":"作者回复","comment_id":25685,"uid":"1218095","ip_address":"","utype":1,"ctime":1537419889,"user_name_real":"Geek_6ef93d"}],"discussion_count":5,"race_medal":0,"score":"48782050058","product_id":100015201,"comment_content":"请问，业务为了负载，起相同两个pod，属于同一个service里面，这个有负载功能会把请求负载到两个pod上面吗？我测试对于长链接，只有一个pod在接受请求，另一个什么都没有","like_count":12,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424390,"discussion_content":"你都说了是长链接了……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537419889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1655775,"avatar":"","nickname":"BIZ_UI_4","note":"","ucode":"EBA9DAB645837C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331483,"discussion_content":"k8s service 之间的负载均衡工作在L4, 无法应对长连接的负载.  你可以在 client 实现负载. 或者引入Istio.","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1606882281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"晞月520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283024,"discussion_content":"长连接还负载个锤子啊","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1592145547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1158626,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ad/e2/8c500306.jpg","nickname":"木一乎","note":"","ucode":"6DED11E64D4C21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215544,"discussion_content":"老铁，我笑了","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1585353337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1047778,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/7P4wtgRQt1l0YQlVOtiaUKey2AFZqQCAcABzdCNTP0JR027tkhVkRYgj1iaYF8OlqsE8j6A6icsAvYHIAX8E31WNg/132","nickname":"killer","note":"","ucode":"E275AD8C4523FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":143556,"discussion_content":"长连接不会负载的，和其中一个服务器连接上了，没法再和其它服务连接....","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579514301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242726,"user_name":"liam","can_delete":false,"product_type":"c1","uid":1930487,"ip_address":"","ucode":"81C4A20429F7DF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/lwN7wy2iaibicicBicoN7eRsRtGA75dOYjuWtdqbOSUo65SHR2XHqJb01wgtnDdkBQA3cpibnCb1fibOJD2QwvRs4EU2w/132","comment_is_top":false,"comment_ctime":1597824895,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40252530559","product_id":100015201,"comment_content":"Deployment 具有更新 扩展 和 健康检查策略。replica=1保证了无论如何都至少有一个可用的pod.<br>单独创建一个Pod 如果出了故障出了自身的healthcheck 失败会重启的策略外。并不能保证一定会有一个可用的pod","like_count":8},{"had_liked":false,"id":26389,"user_name":"送普选","can_delete":false,"product_type":"c1","uid":1220775,"ip_address":"","ucode":"AB2C98BB9C3A5D","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/a7/db7a7c50.jpg","comment_is_top":false,"comment_ctime":1537585383,"is_pvip":false,"replies":[{"id":"9592","content":"sed替换，或者用yaml模板jinjia","user_name":"作者回复","comment_id":26389,"uid":"1218095","ip_address":"","utype":1,"ctime":1537604425,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"40192291047","product_id":100015201,"comment_content":"先给这专栏赞一个！如何在yml中的镜像版本号使用变量，这样开发修改后修改了代码递增了镜像版本，在yml中自动使用，不用修改yml文件？谢谢","like_count":9,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424615,"discussion_content":"sed替换，或者用yaml模板jinjia","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537604425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95571,"user_name":"hjt353","can_delete":false,"product_type":"c1","uid":1264966,"ip_address":"","ucode":"A187CC4C8793C8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IWOnxcOM4TPExuPS4gTJ9pofaIuSRBR6jes9WSB4V2FJIwJf4qFLt7c48mKMsb6JCdZuPFIcnTle9FpyPuxuzw/132","comment_is_top":false,"comment_ctime":1558084977,"is_pvip":false,"replies":[{"id":"36299","content":"看kubernetes api文档","user_name":"作者回复","comment_id":95571,"uid":"1218095","ip_address":"","utype":1,"ctime":1559619220,"user_name_real":"Geek_6ef93d"}],"discussion_count":3,"race_medal":0,"score":"35917823345","product_id":100015201,"comment_content":"kubernetes 有很多资源对象：包括 configmap Deployment Namespace 等资源，我在编写这些资源 yaml 文件时，比如：deployment.yaml 文件，怎么查阅 deployment 资源包括哪些属性（比如：apivseresion kind spec等），这些属性又包含哪些配置信息（比如：.spec.replicas 配置）","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450520,"discussion_content":"看kubernetes api文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559619220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1665945,"avatar":"https://static001.geekbang.org/account/avatar/00/19/6b/99/fbd95198.jpg","nickname":"Amy","note":"","ucode":"57FCCBA2C34B67","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":102225,"discussion_content":"kubectl explain deployment","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1577331694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1557532,"avatar":"https://static001.geekbang.org/account/avatar/00/17/c4/1c/1b37a1f1.jpg","nickname":"石颉","note":"","ucode":"19132CA1A1DA69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1665945,"avatar":"https://static001.geekbang.org/account/avatar/00/19/6b/99/fbd95198.jpg","nickname":"Amy","note":"","ucode":"57FCCBA2C34B67","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346266,"discussion_content":"补充: 对于explain中有object对象可以用kubectl explain pod.metadata 看到详细参数以及解释","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611897186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":102225,"ip_address":""},"score":346266,"extra":""}]}]},{"had_liked":false,"id":25304,"user_name":"hhh","can_delete":false,"product_type":"c1","uid":1219115,"ip_address":"","ucode":"31080B114A0A77","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/2b/a873a1cf.jpg","comment_is_top":false,"comment_ctime":1537307548,"is_pvip":false,"replies":[{"id":"9194","content":"正是下一篇的内容","user_name":"作者回复","comment_id":25304,"uid":"1218095","ip_address":"","utype":1,"ctime":1537315981,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"27307111324","product_id":100015201,"comment_content":"从best practice的角度，一个pod是推荐运行一个容器还是多个容器？","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424248,"discussion_content":"正是下一篇的内容","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537315981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244687,"user_name":"Vita","can_delete":false,"product_type":"c1","uid":1372593,"ip_address":"","ucode":"15269DB6D00392","user_header":"https://static001.geekbang.org/account/avatar/00/14/f1/b1/16642bef.jpg","comment_is_top":false,"comment_ctime":1598618183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23073454663","product_id":100015201,"comment_content":"已经在看第二遍，深入理解","like_count":5},{"had_liked":false,"id":76840,"user_name":"发挥哥","can_delete":false,"product_type":"c1","uid":1134660,"ip_address":"","ucode":"02C7865FAAB698","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/44/977a522f.jpg","comment_is_top":false,"comment_ctime":1552724956,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23027561436","product_id":100015201,"comment_content":"如果镜像仓库里的镜像更新了，镜像拉取策略是always，deployment文件没有变化，kubectl apply命令会更新应用吗？","like_count":5,"discussions":[{"author":{"id":1615156,"avatar":"https://static001.geekbang.org/account/avatar/00/18/a5/34/6e3e962f.jpg","nickname":"yayiyaya","note":"","ucode":"38532C740FA186","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319087,"discussion_content":"不会，是根据deployment的文件内容与status状态进行判断的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603940225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1333523,"avatar":"https://static001.geekbang.org/account/avatar/00/14/59/13/ff6f3ed5.jpg","nickname":"王章涛","note":"","ucode":"6EC55EC116A58D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304448,"discussion_content":"我测试的是不会，他是根据deployw文件判断的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599573206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25664,"user_name":"@Yang","can_delete":false,"product_type":"c1","uid":1045906,"ip_address":"","ucode":"11C99A4AE76C62","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/92/28669fbc.jpg","comment_is_top":false,"comment_ctime":1537406085,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23012242565","product_id":100015201,"comment_content":"deployment的方式能控制pod，比如扩容缩容，升级回滚，节点间调度，等等～<br>pod是节点上孤立的，不组织状态。没有上面doploynent的特性吧。<br><br>不对之处，请指正～","like_count":5},{"had_liked":false,"id":28299,"user_name":"V V","can_delete":false,"product_type":"c1","uid":1220390,"ip_address":"","ucode":"9494330A6AA770","user_header":"https://static001.geekbang.org/account/avatar/00/12/9f/26/89eda2c8.jpg","comment_is_top":false,"comment_ctime":1538046739,"is_pvip":false,"replies":[{"id":"10182","content":"你确定关的是原来pod在run的那个机器么","user_name":"作者回复","comment_id":28299,"uid":"1218095","ip_address":"","utype":1,"ctime":1538052346,"user_name_real":"Geek_6ef93d"}],"discussion_count":3,"race_medal":0,"score":"18717915923","product_id":100015201,"comment_content":"您好，老师。您评论中说deployment的好处是宕机的时候，会重新pod会在另外的node上重启。可是，我关机了其中一个node之后，pod并没有重启。我是通过命令 kubectl get pods -o wide来查看的。STATUS显示还是running。","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425220,"discussion_content":"你确定关的是原来pod在run的那个机器么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538052346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2589474,"avatar":"https://static001.geekbang.org/account/avatar/00/27/83/22/a44b65f5.jpg","nickname":"JamonJou","note":"","ucode":"C77E647E2FA7A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542186,"discussion_content":"有这个问题，后来等了很久，还是重建了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640677016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1401211,"avatar":"https://static001.geekbang.org/account/avatar/00/15/61/7b/8f589923.jpg","nickname":"凌晨一点半","note":"","ucode":"E6743DCC893454","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":39131,"discussion_content":"我也有这个情况，关了一个node，但是显示两个node上的pod都是running","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571895038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25450,"user_name":"风轨","can_delete":false,"product_type":"c1","uid":1185844,"ip_address":"","ucode":"7B8A5233B61EB0","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/34/c082419c.jpg","comment_is_top":false,"comment_ctime":1537332497,"is_pvip":false,"replies":[{"id":"9236","content":"对，比如宕机的时候","user_name":"作者回复","comment_id":25450,"uid":"1218095","ip_address":"","utype":1,"ctime":1537334458,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"18717201681","product_id":100015201,"comment_content":"deployment有监控功能，pod挂了可以重启，还可以方便升降级，现在一个pod未来可以是多个。","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424312,"discussion_content":"对，比如宕机的时候","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537334458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25343,"user_name":"extraterrestrial！！","can_delete":false,"product_type":"c1","uid":1017987,"ip_address":"","ucode":"74AE07CA68F6B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/GDYkD2X7pXSKUSaUFC8u3TBPaakaibnOBV2NYDc2TNfb8Su9icFMwSod6iaQX5iaGU2gT6xkPuhXeWvY8KaVEZAYzg/132","comment_is_top":false,"comment_ctime":1537317423,"is_pvip":true,"replies":[{"id":"9224","content":"这种简单组合优势不大，编排真正的意义，本专栏马上会讲到","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537326848,"ip_address":"","comment_id":25343,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717186607","product_id":100015201,"comment_content":"用replica=1的deployment, 不用pod是因为deployment带监控的功能，挂了可以重新调度吧。<br>另外，刚开始看你的docker书，里面讲了一个web+redis+haproxy的应用部署，这种东西在k8s上要怎么部署比较好(或者有什么特别的优势)。现在接触的都是单个image应用部署k8s，感觉体现不出编排的概念😂","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424264,"discussion_content":"这种简单组合优势不大，编排真正的意义，本专栏马上会讲到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537326848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37548,"user_name":"Ryan","can_delete":false,"product_type":"c1","uid":1109242,"ip_address":"","ucode":"B1CD767C0315B9","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/fa/a3e5f703.jpg","comment_is_top":false,"comment_ctime":1541639154,"is_pvip":false,"replies":[{"id":"13577","content":"这就是有状态应用啊。看statefulset 部分。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1541719409,"ip_address":"","comment_id":37548,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14426541042","product_id":100015201,"comment_content":"你好，pod视为一个应用，假设pod跑的一个分布式数据库之类的应用，如果worker因为某些原因需要缩减，k8s有没有什么机制保证缩减的机器上的数据和内存信息同步到其他的work上？还是需要应用本身来做这个事情？谢谢🙏","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428395,"discussion_content":"这就是有状态应用啊。看statefulset 部分。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541719409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35226,"user_name":"草莓&#47;mg","can_delete":false,"product_type":"c1","uid":1001572,"ip_address":"","ucode":"EB173DC8D3E0C0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/64/e0b94df2.jpg","comment_is_top":false,"comment_ctime":1540468032,"is_pvip":false,"replies":[{"id":"12566","content":"我所有的版本都装过。安装这不会有问题啊。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540481112,"ip_address":"","comment_id":35226,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14425369920","product_id":100015201,"comment_content":"张老师，安装kubectl kubelet kubeadm都有问题呀，你安装的版本是怎么样的？难受啊","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427483,"discussion_content":"我所有的版本都装过。安装这不会有问题啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540481112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29222,"user_name":"honnkyou","can_delete":false,"product_type":"c1","uid":1026608,"ip_address":"","ucode":"FD5EC4120EE803","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/30/acc91f01.jpg","comment_is_top":false,"comment_ctime":1538292232,"is_pvip":false,"replies":[{"id":"10543","content":"volume已经准备好了，具体挂不挂载进容器取决于container volumeMounts字段怎么写的","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538356604,"ip_address":"","comment_id":29222,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14423194120","product_id":100015201,"comment_content":"replica为多个时volume是每个container都挂载吗？","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425521,"discussion_content":"volume已经准备好了，具体挂不挂载进容器取决于container volumeMounts字段怎么写的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538356604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27683,"user_name":"刘家兴","can_delete":false,"product_type":"c1","uid":1064035,"ip_address":"","ucode":"453EB6F23A527D","user_header":"https://static001.geekbang.org/account/avatar/00/10/3c/63/95fadffe.jpg","comment_is_top":false,"comment_ctime":1537929085,"is_pvip":false,"replies":[{"id":"9979","content":"docker push, kubernetes会pull下来","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537937898,"ip_address":"","comment_id":27683,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14422830973","product_id":100015201,"comment_content":"老师，我看完这个还是没看懂，我自己制作的容器镜像是如何与 k8s 关联上的呢？","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425002,"discussion_content":"docker push, kubernetes会pull下来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537937898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25930,"user_name":"rnn","can_delete":false,"product_type":"c1","uid":1169811,"ip_address":"","ucode":"9DC14B9DCF477D","user_header":"https://static001.geekbang.org/account/avatar/00/11/d9/93/43c876e8.jpg","comment_is_top":false,"comment_ctime":1537484164,"is_pvip":false,"replies":[{"id":"9434","content":"当然，这是最基本的能力啊……","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537494037,"ip_address":"","comment_id":25930,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14422386052","product_id":100015201,"comment_content":"如果yaml文件中有的配置被删掉了， kubectl     apply 可以更新被删掉的配置吗？","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424460,"discussion_content":"当然，这是最基本的能力啊……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537494037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25392,"user_name":"小小笑儿","can_delete":false,"product_type":"c1","uid":1040354,"ip_address":"","ucode":"CA63CC50DC2091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/e2/823a04b4.jpg","comment_is_top":false,"comment_ctime":1537322658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14422224546","product_id":100015201,"comment_content":"用Deployment可以确保Pod的数量是确定的。在k8s中一般不直接使用Pod，都是挂在某种Controller下。","like_count":3},{"had_liked":false,"id":242538,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1597753935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10187688527","product_id":100015201,"comment_content":"推荐使用声明式的yaml方式运行容器，而不是命令行。<br><br>Kuberentes对象核心有两块：Metadata、Spec<br><br>Deployment -&gt; ReplicaSet -&gt; Pod -&gt; container <br><br><br>","like_count":3},{"had_liked":false,"id":241582,"user_name":"Geek_e0ee48","can_delete":false,"product_type":"c1","uid":1904256,"ip_address":"","ucode":"11D10A0F5892AB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIgDicRj9LAvWSejVc6v34R6dR1yRHzqBgEpABeRwDvNcpoFW6zmiavwV5cP1fCKJiaQPiafP9E7Puqnw/132","comment_is_top":false,"comment_ctime":1597364677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10187299269","product_id":100015201,"comment_content":"写的非常好的一个专栏，看了以后收获颇丰。用简单的几句话，描绘k8s的很多内部实现，浅显易懂，没有什么废话。非常值得推荐。感谢作者。","like_count":2},{"had_liked":false,"id":226583,"user_name":"晞月520","can_delete":false,"product_type":"c1","uid":1845394,"ip_address":"","ucode":"4F05E02A5C1608","user_header":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","comment_is_top":false,"comment_ctime":1592145411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10182080003","product_id":100015201,"comment_content":"生产环境中都没有用编写 pod yaml 文件的  都是用 deployment  daemset  这些pod 控制器来的","like_count":2},{"had_liked":false,"id":210320,"user_name":"Cybertrunk","can_delete":false,"product_type":"c1","uid":1011174,"ip_address":"","ucode":"D557A710E1835F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6d/e6/57bfae83.jpg","comment_is_top":false,"comment_ctime":1587719900,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10177654492","product_id":100015201,"comment_content":"我去，巨陡，很多东西搞不懂，只有硬啃了。先迈过去，回头再看。","like_count":2},{"had_liked":false,"id":188768,"user_name":"giantbroom","can_delete":false,"product_type":"c1","uid":1059516,"ip_address":"","ucode":"7258784193C302","user_header":"","comment_is_top":false,"comment_ctime":1584413706,"is_pvip":true,"replies":[{"id":"72826","content":"如果pod id 丢失了，就拿不到，但events和log还在，通过外部手段可以拿到","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1584422503,"ip_address":"","comment_id":188768,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10174348298","product_id":100015201,"comment_content":"请教一个问题，如果Pod由于bug，被重建了，还能通过event或者log查找具体原因吗？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487514,"discussion_content":"如果pod id 丢失了，就拿不到，但events和log还在，通过外部手段可以拿到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584422503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155566,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1574699800,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"10164634392","product_id":100015201,"comment_content":"能弱弱的问一句，这篇专栏里的kubectl命令是执行在master 节点还是node节点上？","like_count":2,"discussions":[{"author":{"id":2589474,"avatar":"https://static001.geekbang.org/account/avatar/00/27/83/22/a44b65f5.jpg","nickname":"JamonJou","note":"","ucode":"C77E647E2FA7A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542189,"discussion_content":"在node上配置kubeconfig和有kubectl命令就可以了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640677640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083504,"avatar":"https://static001.geekbang.org/account/avatar/00/10/88/70/32534e2d.jpg","nickname":"David Mo","note":"","ucode":"66C30A3CD7EDA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":231435,"discussion_content":"准确说是这个命令是和API Server沟通的，kubectl有apiserver地址就行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586796698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1256033,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2a/61/88e97b67.jpg","nickname":"阿丑","note":"","ucode":"9A214DDC2CE9CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":62486,"discussion_content":"master...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574847119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1099375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","nickname":"xiong","note":"","ucode":"C1BFD9EF96372F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1256033,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2a/61/88e97b67.jpg","nickname":"阿丑","note":"","ucode":"9A214DDC2CE9CB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":64224,"discussion_content":"node节点不能执行吗。我看我现在公司的在node节点执行也是可以的。只是我在自己的node上执行就报connection refused","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574942681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":62486,"ip_address":""},"score":64224,"extra":""},{"author":{"id":1064561,"avatar":"https://static001.geekbang.org/account/avatar/00/10/3e/71/f4467169.jpg","nickname":"小二科","note":"","ucode":"985CA20B7AF7C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1099375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","nickname":"xiong","note":"","ucode":"C1BFD9EF96372F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":109411,"discussion_content":"去node节点执行，那还要集群干啥来。。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577692145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":64224,"ip_address":""},"score":109411,"extra":""},{"author":{"id":1022886,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/a6/1f485c48.jpg","nickname":"高远","note":"","ucode":"BC84D5A3EA37A6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1099375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","nickname":"xiong","note":"","ucode":"C1BFD9EF96372F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":313307,"discussion_content":"可以的，但是地址啊密码啊证书啊都得先配上。我实验出最简单的方法（也是最不安全的），在master上用kubectl config view --raw输出配置，把这个配置存到node上的一个文件中（假设kube-config.yaml），然后你在node上就可以用kubectl了，只要带上--kubeconfig=kube-config.yaml就行。比如 kubectl get pods -A --kubeconfig=kube-config.yaml","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1603028762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":64224,"ip_address":""},"score":313307,"extra":""}]}]},{"had_liked":false,"id":40293,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1087978,"ip_address":"","ucode":"CE4942FD556842","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/ea/0d7b8cdc.jpg","comment_is_top":false,"comment_ctime":1542589905,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"10132524497","product_id":100015201,"comment_content":"用Helm来部署，是否更利于CI&#47;CD的集成？","like_count":2,"discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348039,"discussion_content":"当然了，更符合gitops的理念","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612409895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25434,"user_name":"silverhawk","can_delete":false,"product_type":"c1","uid":1018649,"ip_address":"","ucode":"BFBC8AF32868DA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8b/19/a15d060d.jpg","comment_is_top":false,"comment_ctime":1537327056,"is_pvip":false,"replies":[{"id":"9240","content":"线程池怎么能是内核态的呢？但你这个线程池用到的内核资源比如进程表，缓存等，是被共享的。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537334577,"ip_address":"","comment_id":25434,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10127261648","product_id":100015201,"comment_content":"不同的container 共享kernel，那么在不同container里面开的比如线程池，还有connection pool也是同一个VM上所有container共享吗？","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424305,"discussion_content":"线程池怎么能是内核态的呢？但你这个线程池用到的内核资源比如进程表，缓存等，是被共享的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537334577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287272,"user_name":"毕殿卿","can_delete":false,"product_type":"c1","uid":1370170,"ip_address":"","ucode":"C556AE72FF44F0","user_header":"https://static001.geekbang.org/account/avatar/00/14/e8/3a/252741d6.jpg","comment_is_top":false,"comment_ctime":1617865181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5912832477","product_id":100015201,"comment_content":"当我执行kubectl apply -f &lt;一个Url形式的yaml&gt;  请问kubectl会把这个yaml文件下载到哪个路径下  我找不到了😂","like_count":0},{"had_liked":false,"id":275115,"user_name":"陈斯佳","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1611311958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5906279254","product_id":100015201,"comment_content":"kubectl run 现在也默认生成的是一个deployment, 而不是只是pod了","like_count":1},{"had_liked":false,"id":184426,"user_name":"Deephug","can_delete":false,"product_type":"c1","uid":1705587,"ip_address":"","ucode":"E32B54889F7E87","user_header":"https://static001.geekbang.org/account/avatar/00/1a/06/73/c9c6fb6a.jpg","comment_is_top":false,"comment_ctime":1583312953,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5878280249","product_id":100015201,"comment_content":"这hostpath和宿主机目录怎么不能映射文件","like_count":1},{"had_liked":false,"id":182578,"user_name":"阳光梦","can_delete":false,"product_type":"c1","uid":1283965,"ip_address":"","ucode":"55BDA128D39931","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/TTPicMEZ5s1zKiaKYecIljicRV9dibITPM0958W3VuNHXlTQic2Dj6XYGibF7dqrG3JWr0LMx7hY9zXGzuvTDNGw8KAA/132","comment_is_top":false,"comment_ctime":1582811498,"is_pvip":false,"replies":[{"id":"72845","content":"现在大部分服务都可以上k8s ，能容器化就行","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1584423622,"ip_address":"","comment_id":182578,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5877778794","product_id":100015201,"comment_content":"您好！请教个基础的问题。<br>1，什么类型的服务适合k8s上部署，麻烦举例说明。<br>2，我想使用一台设备部署类似master，node1，node2等，完事使用ingress代理。硬件上直接安装个centos系统，完事系统上直接部署master，node1，node2等？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485376,"discussion_content":"现在大部分服务都可以上k8s ，能容器化就行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584423622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102964,"user_name":"lidashuang","can_delete":false,"product_type":"c1","uid":1104850,"ip_address":"","ucode":"560ABE8032760E","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg","comment_is_top":false,"comment_ctime":1560337923,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5855305219","product_id":100015201,"comment_content":"kubectl create -f nginx-deployment.yaml<br>error: SchemaError(io.k8s.api.core.v1.ConfigMapEnvSource): invalid object doesn&#39;t have additional properties <br><br>这个有人遇到过吗?<br><br>kubectl version<br><br>Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;10&quot;, GitVersion:&quot;v1.10.7&quot;, GitCommit:&quot;0c38c362511b20a098d7cd855f1314dad92c2780&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2018-08-20T10:09:03Z&quot;, GoVersion:&quot;go1.9.3&quot;, Compiler:&quot;gc&quot;, Platform:&quot;darwin&#47;amd64&quot;}<br>Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;14&quot;, GitVersion:&quot;v1.14.3&quot;, GitCommit:&quot;5e53fd6bc17c0dec8434817e69b04a25d8ae0ff0&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-06-06T01:36:19Z&quot;, GoVersion:&quot;go1.12.5&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}","like_count":1,"discussions":[{"author":{"id":1099897,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c8/79/8c688b78.jpg","nickname":"Jvns","note":"","ucode":"037FFB7A321736","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553242,"discussion_content":"应该是 nginx-deployment.yaml 的问题，建议把 nginx-deployment.yaml 贴出来","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1645780703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95567,"user_name":"hjt353","can_delete":false,"product_type":"c1","uid":1264966,"ip_address":"","ucode":"A187CC4C8793C8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IWOnxcOM4TPExuPS4gTJ9pofaIuSRBR6jes9WSB4V2FJIwJf4qFLt7c48mKMsb6JCdZuPFIcnTle9FpyPuxuzw/132","comment_is_top":false,"comment_ctime":1558084366,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5853051662","product_id":100015201,"comment_content":"kubernetes资源对象很多，如果我要编写一个deployment 我怎么查 deployment资源包括哪些属性：比如apiversion 等","like_count":1,"discussions":[{"author":{"id":1576531,"avatar":"https://static001.geekbang.org/account/avatar/00/18/0e/53/47dbf543.jpg","nickname":"南风","note":"","ucode":"BE1CD4CDFE6297","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293051,"discussion_content":"kubectl explain来查看所使用的各种资源对象的所对应属性","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595423335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94137,"user_name":"清夜","can_delete":false,"product_type":"c1","uid":1518044,"ip_address":"","ucode":"AF65253B4AE3BA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLJTCUiaAqQTZbAibe1y8K9gzxc1bRqd64ic1TBYic693c8kpf6l4d2JVUjpUzv4vvKIYTrKsrLuIDejw/132","comment_is_top":false,"comment_ctime":1557729563,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5852696859","product_id":100015201,"comment_content":"请问张老师，显式声明volume后，例如<br>        volumeMounts:<br>        - mountPath: &quot;&#47;usr&#47;share&#47;nginx&#47;html&quot;<br>          name: nginx-vol<br>      volumes:<br>      - name: nginx-vol<br>        hostPath:<br>          path: &#47;var&#47;data<br>我的理解是&#47;usr&#47;share&#47;nginx&#47;html&#47;将宿主机的&#47;var&#47;data目录做为挂载目录，但我在&#47;var&#47;data下新增的文件无法在容器的对应目录中看到，反之亦然，请问是什么原因。<br>另外如果是隐式的声明，通过describe查看到的内容是：Type:    EmptyDir (a temporary directory that shares a pod&#39;s lifetime)，如果得知在宿主机上的临时目录的具体位置。<br>谢谢！","like_count":1,"discussions":[{"author":{"id":1315961,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoX5UwDDk3YOVJnibFb8kHJh34fTqp6Ru0l7nNssQQrpZIUS33Zro70Fwg98HWNFJgUWX3rTFTOJAg/132","nickname":"Quintin","note":"","ucode":"5CE8C31831BB18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580,"discussion_content":"要去这个pod所在的主机找这个目录","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1561715849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592298,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/ea/a9e7bc50.jpg","nickname":"℡人见人爱浩然君゜","note":"","ucode":"D042A622533C72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563074,"discussion_content":"可以先使用describe查看下pod所在的物理机，然后在物理机下查看/var/data","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649936325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47489,"user_name":"周萝卜","can_delete":false,"product_type":"c1","uid":1315039,"ip_address":"","ucode":"056A4426D14A45","user_header":"https://static001.geekbang.org/account/avatar/00/14/10/df/e4511752.jpg","comment_is_top":false,"comment_ctime":1544147433,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5839114729","product_id":100015201,"comment_content":"老师问一下，deployment和node的关系是啥","like_count":1},{"had_liked":false,"id":33217,"user_name":"tianming","can_delete":false,"product_type":"c1","uid":1009932,"ip_address":"","ucode":"0BAB735AC9017A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/69/0c/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1539760365,"is_pvip":false,"replies":[{"id":"12033","content":"镜像的问题","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539783650,"ip_address":"","comment_id":33217,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834727661","product_id":100015201,"comment_content":"我从k8s进入容器以后，很多命令比如ps之类的没法用，这个是k8s本身做的隔离，还是我docker image需要引入这些命令？","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426949,"discussion_content":"镜像的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539783650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32233,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1223046,"ip_address":"","ucode":"61CFE863E8E6D1","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/86/8211935c.jpg","comment_is_top":false,"comment_ctime":1539491919,"is_pvip":false,"replies":[{"id":"11710","content":"你的kubelet监听的肯定不是那个ip。如果有多个网卡可以在kubelet启动参数里指定一下。","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539501000,"ip_address":"","comment_id":32233,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834459215","product_id":100015201,"comment_content":"老师，执行这个命令的时候报错了，请问是什么原因？我看对应的node监听的10250端口是IPv6的···<br>[root@node1 k8s]# kubectl exec nginx-deployment-5c678cfb6d-pdnrh date<br>Error from server: error dialing backend: dial tcp 192.168.0.115:10250: connect: no route to host<br>","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426692,"discussion_content":"你的kubelet监听的肯定不是那个ip。如果有多个网卡可以在kubelet启动参数里指定一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539501000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30481,"user_name":"xjjksj","can_delete":false,"product_type":"c1","uid":1029446,"ip_address":"","ucode":"2322DB549D387F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/46/fb410a77.jpg","comment_is_top":false,"comment_ctime":1538883476,"is_pvip":false,"replies":[{"id":"11023","content":"那个错说的是kubelet访问不到docker","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538953688,"ip_address":"","comment_id":30481,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833850772","product_id":100015201,"comment_content":"Hi，我用vagrant起的三台ubuntu虚拟机，一台master。因为vagrant默认第一张网卡eth0（10.0.2.15）是NAT类型，所以每台node都添加了host-only的网卡。三台机器间也可以互相访问第二张网卡给分配的IP。<br><br>kubeadm建立完cluster后，master上所有kube-system的pods都running，get nodes也都是ready。<br><br>然而在deploy nginx时，一直显示ContainerCreating，到worker node上看kubelet日志，好多 rpc error: code = DeadlineExceeded desc = context deadline exceeded。它们来自remote_runtime.go的RunPodSandbox，kuberuntime_sandbox.go的CreatePodSandbox，pod_workers.go的Error syncing pod。<br><br><br>get svc的ip是10.96.0.1<br>get pods —all-namespaces -o wide里大部分pod的ip都是10.0.2.15，只有coredns是10.32.0网段。<br><br>搜了一大圈都没啥结果，真心求解。谢谢！","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426020,"discussion_content":"那个错说的是kubelet访问不到docker","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538953688,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25642,"user_name":"巩夫建","can_delete":false,"product_type":"c1","uid":1222958,"ip_address":"","ucode":"6B06A4399D2338","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/2e/01b2839e.jpg","comment_is_top":false,"comment_ctime":1537404733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5832372029","product_id":100015201,"comment_content":"yaml文件中如何使用变量，不是环境变量env那种，而是我在yaml定义一个版本号的变量，当版本发生变更，我只需要修改版本号变量，或者外部传参就行了。不希望频繁修改yaml文件。","like_count":1},{"had_liked":false,"id":25485,"user_name":"大师兄","can_delete":false,"product_type":"c1","uid":1171665,"ip_address":"","ucode":"0B3EE7000B1650","user_header":"https://static001.geekbang.org/account/avatar/00/11/e0/d1/32516a0a.jpg","comment_is_top":false,"comment_ctime":1537342692,"is_pvip":false,"replies":[{"id":"9279","content":"目前只关注kubernetes 本身","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537363591,"ip_address":"","comment_id":25485,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832309988","product_id":100015201,"comment_content":"helm会不会讲","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424322,"discussion_content":"目前只关注kubernetes 本身","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537363591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25348,"user_name":"suke","can_delete":false,"product_type":"c1","uid":1007753,"ip_address":"","ucode":"C0287C31A4F45B","user_header":"","comment_is_top":false,"comment_ctime":1537317888,"is_pvip":false,"replies":[{"id":"9222","content":"一样的","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537326730,"ip_address":"","comment_id":25348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5832285184","product_id":100015201,"comment_content":"老师您配置文件里spec.template.metadata.labels和您讲的标签有什么不同","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424266,"discussion_content":"一样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537326730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25336,"user_name":"风行传说","can_delete":false,"product_type":"c1","uid":1228222,"ip_address":"","ucode":"3CFD8AB4975764","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTILhHQ6S5c2QEGNoiaL5LicibKah5wOZIh8iaWloM5XfDeW4aJwLicWlqceUVFEBicMzpqyFWDFEmVeibhFg/132","comment_is_top":false,"comment_ctime":1537316570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5832283866","product_id":100015201,"comment_content":"一个pod中同时运行多个容器，比如多个nginx，同一时间也只能有一个容器起作用，与其如此，可以使用控制器deployment 通过replicas控制pod 的数量，每个pod 运行一个容器，pod 出问题被删除后还可以通过控制器自动创建","like_count":1},{"had_liked":false,"id":25332,"user_name":"龙坤","can_delete":false,"product_type":"c1","uid":1233455,"ip_address":"","ucode":"D1724E68D6304D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/2f/04882ff8.jpg","comment_is_top":false,"comment_ctime":1537316260,"is_pvip":false,"replies":[{"id":"9226","content":"这正是后面声明式API要重点介绍的内容","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537326929,"ip_address":"","comment_id":25332,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5832283556","product_id":100015201,"comment_content":"非常感谢老师的讲解。我有点疑惑，就是用习惯了compose或者compose stack的编写模式，现在有点难理解k8s基于api对象编写的yaml编排文件模式。望老师，讲讲怎么过渡到k8s这种编写模式下，而且k8s这种基于api对象编写模式的优缺点是什么，到目前，暂时感觉不出这种基于api对象编写yaml配置的高超表现在哪里。","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424258,"discussion_content":"这正是后面声明式API要重点介绍的内容","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537326929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25309,"user_name":"假装乐","can_delete":false,"product_type":"c1","uid":1093437,"ip_address":"","ucode":"97A7D0A6D93865","user_header":"https://static001.geekbang.org/account/avatar/00/10/af/3d/28b61e6b.jpg","comment_is_top":false,"comment_ctime":1537312736,"is_pvip":false,"replies":[{"id":"9193","content":"exit","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1537315970,"ip_address":"","comment_id":25309,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5832280032","product_id":100015201,"comment_content":"-it &#47;bin&#47;bash用完，怎么退出呢","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424251,"discussion_content":"exit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537315970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348035,"discussion_content":"ctrl键+ a+d","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612409712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351017,"user_name":"looper","can_delete":false,"product_type":"c1","uid":1238396,"ip_address":"","ucode":"DA4BCE83836C04","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/7c/2a5a418b.jpg","comment_is_top":false,"comment_ctime":1657456358,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657456358","product_id":100015201,"comment_content":"Deployment 可以保证集群中一直会有一个副本，但是 pod 无法保证","like_count":0},{"had_liked":false,"id":342814,"user_name":"Nio","can_delete":false,"product_type":"c1","uid":1529642,"ip_address":"","ucode":"A1B8D3C01FB937","user_header":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","comment_is_top":false,"comment_ctime":1650470959,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1650470959","product_id":100015201,"comment_content":"大致知道使用流程了 期待后续","like_count":0},{"had_liked":false,"id":342551,"user_name":"金角大王","can_delete":false,"product_type":"c1","uid":1238799,"ip_address":"","ucode":"2396FE4BD422AD","user_header":"https://static001.geekbang.org/account/avatar/00/12/e7/0f/edaf000d.jpg","comment_is_top":false,"comment_ctime":1650337705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650337705","product_id":100015201,"comment_content":"渐入佳境,好文要顶. 只看不练等于没看.","like_count":0},{"had_liked":false,"id":304828,"user_name":"vivi","can_delete":false,"product_type":"c1","uid":1316902,"ip_address":"","ucode":"17A9A72EC95315","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oNyD409Hg3iaSaMpF3ibn35FstWN3AHnQaJf7LaIqkrsvHZcd8lYbOicDiaU1NcicoERz5kC3YKM4iaYsXpHBYEVW6yw/132","comment_is_top":false,"comment_ctime":1627632975,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627632975","product_id":100015201,"comment_content":"不错，跟着学习，一天搭建好了一个集群","like_count":0},{"had_liked":false,"id":297094,"user_name":"Geek_351610","can_delete":false,"product_type":"c1","uid":2649317,"ip_address":"","ucode":"1BAED4FF140D5E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIFXwj594JUkxAPhFVWib08YsP7lr02e5Sz4KBTTAE9QuKlv9dQhdjsqNnWHK6UVJu4ibgKia9nVKOgg/132","comment_is_top":false,"comment_ctime":1623307645,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1623307645","product_id":100015201,"comment_content":"你好，“Pod 中的容器，使用的是 volumeMounts 字段来声明自己要挂载哪个 Volume，并通过 mountPath 字段来定义容器内的 Volume 目录，比如：&#47;usr&#47;share&#47;nginx&#47;html“<br>“容器 Volume 挂载的宿主机目录，就变成了 &#47;var&#47;data”<br>请问上面这两句所说的&#47;usr&#47;share&#47;nginx&#47;html和&#47;var&#47;data指的是容器内的目录吗","like_count":0,"discussions":[{"author":{"id":2779970,"avatar":"","nickname":"Geek_xiong","note":"","ucode":"1A92DD9B35AC4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399077,"discussion_content":"容器 Volume 将/usr/share/nginx/html 目录挂载到宿主机目录的 /var/data","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632903526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099897,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c8/79/8c688b78.jpg","nickname":"Jvns","note":"","ucode":"037FFB7A321736","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553241,"discussion_content":"spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts: # 定义容器内的 Volume 目录\n        - mountPath: &#34;/usr/share/nginx/html&#34;\n          name: nginx-vol \n      volumes: # 定义这个 Pod 声明的所有 Volume\n      - name: nginx-vol\n        # volume 类型是 emptyDir\n        emptyDir: {}\n如果是 emptyDir 就将宿主机的临时目录挂载到容器中 mountPath 写的那个目录","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645780582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287719,"user_name":"🐻","can_delete":false,"product_type":"c1","uid":1043072,"ip_address":"","ucode":"534EDAD496A0E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ea/80/8759e4c1.jpg","comment_is_top":false,"comment_ctime":1618122588,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618122588","product_id":100015201,"comment_content":"deployment 负责管理和升级 pod<br><br>1. 可以调度 pod 到其他节点上<br>2. 如果 pod 有修改，通过修改 deployment 的 template 定义，可以实现不停机地升级 pod","like_count":0},{"had_liked":false,"id":250005,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1600881087,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600881087","product_id":100015201,"comment_content":"阿里云镜像里没有nginx1.7.9，只有官方的版本，详见列表<br>https:&#47;&#47;github.com&#47;docker-library&#47;official-images&#47;pulls?q=label%3Alibrary%2Fnginx<br>更换版本号后可以顺利从阿里云镜像下载","like_count":0},{"had_liked":false,"id":245958,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1599120947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599120947","product_id":100015201,"comment_content":"是否是单独书写一个Pod的yaml,会导致在Pod出现问题的时候,没法自动的进行恢复工作,而使用一个Deployment去管理这个Pod,可以在Pod出现问题的时候,方便去自动恢复","like_count":0},{"had_liked":false,"id":245126,"user_name":"jackchow","can_delete":false,"product_type":"c1","uid":1650788,"ip_address":"","ucode":"050F3FDFE8F808","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/MM1qhGvrmQibogoib9nlFCSD6eQOOK5tNO9fwGjZ8Edrgb9VfuTV7hYJmUw0Hl9UT8B5WrYAFicnLpI2GUADuyzbg/132","comment_is_top":false,"comment_ctime":1598841239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598841239","product_id":100015201,"comment_content":"张老师您好，你在总结里最后提到“更重要的是，在部署到 Kubernetes 之后，接下来的所有操作，要么通过 kubectl 来执行，要么通过修改 YAML 文件来实现，就尽量不要再碰 Docker 的命令行了”，我想请问一下，在用docker制作完镜像，然后用kubernetes部署之后，还会有那些场景会用到Docker的命令行？","like_count":0},{"had_liked":false,"id":237885,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1595995411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595995411","product_id":100015201,"comment_content":"再也不用担心记不住命令了","like_count":0},{"had_liked":false,"id":232238,"user_name":"小强","can_delete":false,"product_type":"c1","uid":1149004,"ip_address":"","ucode":"CC3D3A9E5D9A42","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/4c/2c3d2c7d.jpg","comment_is_top":false,"comment_ctime":1593933274,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1593933274","product_id":100015201,"comment_content":"老师，我在用minikube的时候<br>$ kubectl create -f nginx-deployment.yaml<br>报错Faild to download Openapi the server could not find requested resource <br>不知道是什么情况","like_count":0,"discussions":[{"author":{"id":1782781,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/33/fd/1169c0f8.jpg","nickname":"Jack","note":"","ucode":"33C2A27D2F4284","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295662,"discussion_content":"describe看一下pod的events，是不是yaml写的有问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596277975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1149004,"avatar":"https://static001.geekbang.org/account/avatar/00/11/88/4c/2c3d2c7d.jpg","nickname":"小强","note":"","ucode":"CC3D3A9E5D9A42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288934,"discussion_content":"就连删除也做不到。报同样的错误","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593935699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231152,"user_name":"孙文东","can_delete":false,"product_type":"c1","uid":1166392,"ip_address":"","ucode":"FA61D70F827F36","user_header":"https://static001.geekbang.org/account/avatar/00/11/cc/38/d746f29b.jpg","comment_is_top":false,"comment_ctime":1593594173,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1593594173","product_id":100015201,"comment_content":"请问kubectl get pods，status为completed，ready 0&#47;1是代表什么状态呢","like_count":0,"discussions":[{"author":{"id":1782781,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/33/fd/1169c0f8.jpg","nickname":"Jack","note":"","ucode":"33C2A27D2F4284","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295661,"discussion_content":"没有起成功啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596277923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224976,"user_name":"张小涛","can_delete":false,"product_type":"c1","uid":1201990,"ip_address":"","ucode":"E3928ABB3651DA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM5yh6HOV99DKdtf0ibPSLjgBfm567wKSaBQj9mLzoy88Hmkx1GDT8LKyyyM8hzt5Wbf0KxKe6X49PA/132","comment_is_top":false,"comment_ctime":1591608636,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591608636","product_id":100015201,"comment_content":"arning: kubectl apply should be used on resource created by either kubectl create --save-config or kubectl apply<br><br>这个是什么原因呢 ？","like_count":0},{"had_liked":false,"id":224396,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1591365992,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591365992","product_id":100015201,"comment_content":"又撸一遍本章知识点比以前清楚很多。","like_count":0},{"had_liked":false,"id":213314,"user_name":"rainbow702","can_delete":false,"product_type":"c1","uid":1002406,"ip_address":"","ucode":"C71239EE8B2A30","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4b/a6/747a07d2.jpg","comment_is_top":false,"comment_ctime":1588383877,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1588383877","product_id":100015201,"comment_content":"下面这个没看明白，可以解释一下吗？<br><br>&gt;&gt;  这样，容器 Volume 挂载的宿主机目录，就变成了 &#47;var&#47;data。","like_count":0,"discussions":[{"author":{"id":2779970,"avatar":"","nickname":"Geek_xiong","note":"","ucode":"1A92DD9B35AC4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399079,"discussion_content":"容器 Volume 将/usr/share/nginx/html 目录挂载到宿主机目录的 /var/data","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632903628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203196,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1586154296,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586154296","product_id":100015201,"comment_content":"volume这块看了几遍还是不太懂","like_count":0},{"had_liked":false,"id":200873,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":1118697,"ip_address":"","ucode":"D24A03CD491F23","user_header":"https://static001.geekbang.org/account/avatar/00/11/11/e9/acd1654c.jpg","comment_is_top":false,"comment_ctime":1585665159,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585665159","product_id":100015201,"comment_content":"nginx这个例子很官方，如果有go或者Java项目应用kubernetes就好了","like_count":0,"discussions":[{"author":{"id":1118697,"avatar":"https://static001.geekbang.org/account/avatar/00/11/11/e9/acd1654c.jpg","nickname":"Sean","note":"","ucode":"D24A03CD491F23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":218551,"discussion_content":"应该说要先生成docker容器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585665316,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199635,"user_name":"余向华","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1585492942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585492942","product_id":100015201,"comment_content":"值得多读几遍","like_count":0},{"had_liked":false,"id":188998,"user_name":"xiaoyao","can_delete":false,"product_type":"c1","uid":1166008,"ip_address":"","ucode":"8623B9E45FC90D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/b8/bcfb6e4a.jpg","comment_is_top":false,"comment_ctime":1584443611,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584443611","product_id":100015201,"comment_content":"replicas=1 的 Deployment，有问题可以重新调度","like_count":0},{"had_liked":false,"id":155260,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1397271,"ip_address":"","ucode":"B62BEA525A64A1","user_header":"https://static001.geekbang.org/account/avatar/00/15/52/17/083d67fb.jpg","comment_is_top":false,"comment_ctime":1574672183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574672183","product_id":100015201,"comment_content":"您好，我利用 java client 调用API执行 Yaml 文件， 但是Yaml 里有多个 Kind（比如有 deployment, 有pvc， 有service）, 请问有没有执行着一组操作的的API，如果没有，我分别调用三个接口，依次调用，这样会不会有问题？  ","like_count":0},{"had_liked":false,"id":153491,"user_name":"ykk","can_delete":false,"product_type":"c1","uid":1741665,"ip_address":"","ucode":"287CE54C85C196","user_header":"https://static001.geekbang.org/account/avatar/00/1a/93/61/d5c0585c.jpg","comment_is_top":false,"comment_ctime":1574245770,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1574245770","product_id":100015201,"comment_content":"我想问一下编写yaml配置文件有啥好的工具。","like_count":0,"discussions":[{"author":{"id":1313840,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0c/30/bb4bfe9d.jpg","nickname":"lyonger","note":"","ucode":"E89A75DADEA2A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344281,"discussion_content":"vscode就行，里面也有一些高亮的插件，而且方便json与yaml之间互相转换，我用起来还是挺舒服的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611386985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139255,"user_name":"大雄","can_delete":false,"product_type":"c1","uid":1676966,"ip_address":"","ucode":"5FCFDD3A940801","user_header":"https://static001.geekbang.org/account/avatar/00/19/96/a6/32a286e0.jpg","comment_is_top":false,"comment_ctime":1570593270,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570593270","product_id":100015201,"comment_content":"老师您好，create pod的yaml文件是在master创建？当时创建了events里面显示拉取镜像失败。","like_count":0},{"had_liked":false,"id":127045,"user_name":"火箭","can_delete":false,"product_type":"c1","uid":1202064,"ip_address":"","ucode":"ED7BA0479EAB16","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/90/7a8fbf69.jpg","comment_is_top":false,"comment_ctime":1566543493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566543493","product_id":100015201,"comment_content":"因为使用deployment模式部署的pod异常之后，会由k8s重新调度到健康的节点中运行；而单独部署一个pod的话，故障之后就不能实现自动调度了","like_count":0},{"had_liked":false,"id":122518,"user_name":"鹅鹅鹅","can_delete":false,"product_type":"c1","uid":1487050,"ip_address":"","ucode":"2820B6C86C0423","user_header":"https://static001.geekbang.org/account/avatar/00/16/b0/ca/599d3907.jpg","comment_is_top":false,"comment_ctime":1565413718,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565413718","product_id":100015201,"comment_content":"老师您好，我想请教一个问题，为什么我发布的pod会访问不了外网呢？但是进到k8s的apiserver,是可以ping通外网的，进入自己的pod就ping不通了","like_count":0},{"had_liked":false,"id":102725,"user_name":"james","can_delete":false,"product_type":"c1","uid":1049208,"ip_address":"","ucode":"5701899403917C","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/78/23c56bce.jpg","comment_is_top":false,"comment_ctime":1560300121,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560300121","product_id":100015201,"comment_content":"yaml几个部分都有lable 他们的区别是啥呢","like_count":0},{"had_liked":false,"id":95565,"user_name":"hjt353","can_delete":false,"product_type":"c1","uid":1264966,"ip_address":"","ucode":"A187CC4C8793C8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IWOnxcOM4TPExuPS4gTJ9pofaIuSRBR6jes9WSB4V2FJIwJf4qFLt7c48mKMsb6JCdZuPFIcnTle9FpyPuxuzw/132","comment_is_top":false,"comment_ctime":1558083628,"is_pvip":false,"replies":[{"id":"36301","content":"kubernetes 的api文档","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1559619306,"ip_address":"","comment_id":95565,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558083628","product_id":100015201,"comment_content":"老师，在编写deployment文件的时候，有没有接口文档可以查阅的呢，或者能用什么命令查看","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450518,"discussion_content":"kubernetes 的api文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559619306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82721,"user_name":"little boy***dino","can_delete":false,"product_type":"c1","uid":1197559,"ip_address":"","ucode":"D61AB1695C946B","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/f7/fd368603.jpg","comment_is_top":false,"comment_ctime":1554285305,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1554285305","product_id":100015201,"comment_content":"老师，你好，下我创建了一个应用<br>创建成功后，但查看pod状态是ContainerCreating，通过查看pod描述<br>Name:               nginx-deployment-549986c59d-jvbsf<br>Namespace:          default<br>Priority:           0<br>PriorityClassName:  &lt;none&gt;<br>Node:               k8s-node-1&#47;172.27.154.137<br>Start Time:         Wed, 03 Apr 2019 17:44:08 +0800<br>Labels:             app=web_server<br>                    pod-template-hash=549986c59d<br>Annotations:        &lt;none&gt;<br>Status:             Pending<br>IP:<br>Controlled By:      ReplicaSet&#47;nginx-deployment-549986c59d<br>Containers:<br>  nginx:<br>    Container ID:<br>    Image:          nginx:1.15.7<br>    Image ID:<br>    Port:           8080&#47;TCP<br>    Host Port:      0&#47;TCP<br>    State:          Waiting<br>      Reason:       ContainerCreating<br>    Ready:          False<br>    Restart Count:  0<br>    Environment:    &lt;none&gt;<br>    Mounts:<br>      &#47;var&#47;run&#47;secrets&#47;kubernetes.io&#47;serviceaccount from default-token-6gwxk (ro)<br>Conditions:<br>  Type              Status<br>  Initialized       True<br>  Ready             False<br>  ContainersReady   False<br>  PodScheduled      True<br>Volumes:<br>  default-token-6gwxk:<br>    Type:        Secret (a volume populated by a Secret)<br>    SecretName:  default-token-6gwxk<br>    Optional:    false<br>QoS Class:       BestEffort<br>Node-Selectors:  &lt;none&gt;<br>Tolerations:     node.kubernetes.io&#47;not-ready:NoExecute for 300s<br>                 node.kubernetes.io&#47;unreachable:NoExecute for 300s<br>Events:<br>  Type     Reason                  Age        From                 Message<br>  ----     ------                  ----       ----                 -------<br>  Normal   Scheduled               4m5s       default-scheduler    Successfully assigned default&#47;nginx-deployment-549986c59d-jvbsf to k8s-node-1<br>  Warning  FailedCreatePodSandBox  &lt;invalid&gt;  kubelet, k8s-node-1  Failed create pod sandbox: rpc error: code = DeadlineExceeded desc = context deadline exceeded<br>  Normal   SandboxChanged          &lt;invalid&gt;  kubelet, k8s-node-1  Pod sandbox changed, it will be killed and re-created.<br>，请问老师，这是什么原因导致的，谢谢老师","like_count":0,"discussions":[{"author":{"id":1592298,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/ea/a9e7bc50.jpg","nickname":"℡人见人爱浩然君゜","note":"","ucode":"D042A622533C72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563400,"discussion_content":"先看下 k8s-node-1 这台机器状态是否ready，并且docker 进程是启动的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649989148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81497,"user_name":"疯子","can_delete":false,"product_type":"c1","uid":1270816,"ip_address":"","ucode":"C343AA393C8788","user_header":"https://static001.geekbang.org/account/avatar/00/13/64/20/30c1d87f.jpg","comment_is_top":false,"comment_ctime":1553927063,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553927063","product_id":100015201,"comment_content":"应该不会的吧","like_count":0},{"had_liked":false,"id":67959,"user_name":"浮世华","can_delete":false,"product_type":"c1","uid":1051603,"ip_address":"","ucode":"3A869399C8C4DF","user_header":"https://static001.geekbang.org/account/avatar/00/10/0b/d3/6ff677e3.jpg","comment_is_top":false,"comment_ctime":1550368685,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550368685","product_id":100015201,"comment_content":"如果两个deployment的label一样，两个deployment会冲突么？如果不会，内部是怎么处理的？如果会，有办法阻止创建课程产生冲突的部署么？","like_count":0},{"had_liked":false,"id":50830,"user_name":"旺旺","can_delete":false,"product_type":"c1","uid":1159196,"ip_address":"","ucode":"FE2CF90F446BFB","user_header":"https://static001.geekbang.org/account/avatar/00/11/b0/1c/2e30eeb8.jpg","comment_is_top":false,"comment_ctime":1545051819,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545051819","product_id":100015201,"comment_content":"$ kubectl describe pod nginx-deployment-67594d6bf6-9gdvr<br>。。。。。。<br>  Normal   Scheduled               1m                 default-scheduler  Successfully assigned default&#47;nginx-deployment-67594d6bf6-9gdvr to node-1<br>  Normal   Pulling                 25s                kubelet, node-1    pulling image &quot;nginx:1.7.9&quot;<br>  Normal   Pulled                  17s                kubelet, node-1    Successfully pulled image &quot;nginx:1.7.9&quot;<br>  Normal   Created                 17s                kubelet, node-1    Created container<br>  Normal   Started                 17s                kubelet, node-1    Started container<br>为什么，现有pulled，然后又有pulling呢？不是应该先pulling，然后才是pulled（拉取结束吗？）","like_count":0,"discussions":[{"author":{"id":1315961,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoX5UwDDk3YOVJnibFb8kHJh34fTqp6Ru0l7nNssQQrpZIUS33Zro70Fwg98HWNFJgUWX3rTFTOJAg/132","nickname":"Quintin","note":"","ucode":"5CE8C31831BB18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582,"discussion_content":"你是倒着看的吗?","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1561715989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50783,"user_name":"王涛","can_delete":false,"product_type":"c1","uid":1315326,"ip_address":"","ucode":"6241F08634D342","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/fe/de00d8d8.jpg","comment_is_top":false,"comment_ctime":1545044712,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545044712","product_id":100015201,"comment_content":"D12打卡，目前正准备过渡到k8s上，收货很大","like_count":0},{"had_liked":false,"id":40838,"user_name":"东来东往","can_delete":false,"product_type":"c1","uid":1308716,"ip_address":"","ucode":"B354EA3456C6FC","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/2c/9e509636.jpg","comment_is_top":false,"comment_ctime":1542681013,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542681013","product_id":100015201,"comment_content":"查看pod的event，第二条event是  MountVolume.SetUp succeeded for volume &quot;default-token-8fslr&quot;，为什么要 MountVolume，麻烦老师解释下。<br>Events:<br>  Type    Reason                 Age   From               Message<br>  ----    ------                 ----  ----               -------<br>  Normal  Scheduled              2m    default-scheduler  Successfully assigned nginx-deployment-75675f5897-rnpgj to node05<br>  Normal  SuccessfulMountVolume  2m    kubelet, node05    MountVolume.SetUp succeeded for volume &quot;default-token-8fslr&quot;<br>  Normal  Pulling                2m    kubelet, node05    pulling image &quot;nginx:1.7.9&quot;<br>  Normal  Pulled                 1m    kubelet, node05    Successfully pulled image &quot;nginx:1.7.9&quot;<br>  Normal  Created                1m    kubelet, node05    Created container<br>  Normal  Started                1m    kubelet, node05    Started container<br>","like_count":0},{"had_liked":false,"id":37212,"user_name":"虎虎","can_delete":false,"product_type":"c1","uid":1276773,"ip_address":"","ucode":"386D97CE540E6D","user_header":"","comment_is_top":false,"comment_ctime":1541488005,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541488005","product_id":100015201,"comment_content":"老师，装rook ceph碰到问题如下，请帮忙看下，centos7的，<br>[root@k8smaster ~]# kubectl get pods -n rook-ceph-system<br>NAME                                  READY     STATUS    RESTARTS   AGE<br>rook-ceph-agent-4gtqx                 1&#47;1       Running   0          6m<br>rook-ceph-agent-xr4np                 1&#47;1       Running   0          6m<br>rook-ceph-operator-5bfbf654db-dnkfg   1&#47;1       Running   0          6m<br>rook-discover-47gzd                   1&#47;1       Running   0          6m<br>rook-discover-m6rtf                   1&#47;1       Running   0          6m<br>[root@k8smaster ~]# kubectl get pods -n rook-ceph<br>NAME                               READY     STATUS                  RESTARTS   AGE<br>rook-ceph-mon-a-6dd6d44d-bghmp     0&#47;1       Init:Error              6          6m<br>rook-ceph-mon-d-678b69ff46-t78km   0&#47;1       Init:ImagePullBackOff   0          4m<br>rook-ceph-mon-f-544cff5964-pxxnv   1&#47;1       Running                 0          2m","like_count":0},{"had_liked":false,"id":37174,"user_name":"虎虎","can_delete":false,"product_type":"c1","uid":1276773,"ip_address":"","ucode":"386D97CE540E6D","user_header":"","comment_is_top":false,"comment_ctime":1541474264,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541474264","product_id":100015201,"comment_content":"centos7 安装rook-ceph 后出现如下问题，能否帮忙分析下？kubectl describe pod 命令也看不到event。<br>[root@k8smaster ~]# kubectl get pods -n rook-ceph-system<br>NAME                                  READY     STATUS             RESTARTS   AGE<br>rook-ceph-operator-5bfbf654db-t6rrt   0&#47;1       CrashLoopBackOff   7          18m<br>[root@k8smaster ~]# kubectl get pods -n rook-ceph<br>No resources found.<br>[root@k8smaster ~]# ","like_count":0},{"had_liked":false,"id":36943,"user_name":"Terry Hu","can_delete":false,"product_type":"c1","uid":1219820,"ip_address":"","ucode":"9487EEECC051B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/ec/5da5c049.jpg","comment_is_top":false,"comment_ctime":1541399919,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1541399919","product_id":100015201,"comment_content":"问个问题，我之前在第一次创建nginx-deployment时候使用的是create，然后我更新yaml文件后，使用apply试图更新，报了一个warning <br>root@kube-master:~# kubectl apply -f nginx-deployment.yaml<br>Warning: kubectl apply should be used on resource created by either kubectl create --save-config or kubectl apply<br>deployment.apps&#47;nginx-deployment configured<br>但是也成功了，describe 的时候看到1.8版本了，请问这样做有什么影响吗？","like_count":0,"discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348037,"discussion_content":"应该没啥影响，我也是一样的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612409861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36205,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1540976605,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540976605","product_id":100015201,"comment_content":"老师，我的k8s版本是1.12，内核版本是4.19.  在二进制部署kube-proxy的时候，报错Failed to load kernel module nf_conntrack_ipv4 with modprobe。You can ignore this message when kube-proxy is running inside container without mounting &#47;lib&#47;modules  <br>server.go:360] host must be a URL or a host:port pair: &quot;https:&#47;&#47;&#47;10.7.3.220:6443&quot;<br>服务启动不了。<br>请教，这个是什么问题呢？<br>","like_count":0},{"had_liked":false,"id":36202,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1540975729,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540975729","product_id":100015201,"comment_content":"老师，我现在集群遇到一个问题，删除我创建的一个namespace，一直是处于terminding的状态。已经尝试了 delete  --force --grace-period=0这种方式，也去查看了etcd的数据，但是对应的key看不到，不能直接删除，还尝试了重启整个集群。  还有什么方法可以尝试解决呢？<br><br>","like_count":0},{"had_liked":false,"id":29090,"user_name":"Eric","can_delete":false,"product_type":"c1","uid":1001947,"ip_address":"","ucode":"1813E7F86A17E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/db/1d669080.jpg","comment_is_top":false,"comment_ctime":1538266848,"is_pvip":true,"replies":[{"id":"10485","content":"可以考虑极客商场","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538278061,"ip_address":"","comment_id":29090,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538266848","product_id":100015201,"comment_content":"这门课讲得太好了，老师会考虑出本书吗？","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425489,"discussion_content":"可以考虑极客商场","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538278061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25579,"user_name":"Tank","can_delete":false,"product_type":"c1","uid":1007106,"ip_address":"","ucode":"652A770CD3908B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/02/b50560ac.jpg","comment_is_top":false,"comment_ctime":1537367852,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537367852","product_id":100015201,"comment_content":"应该是便于伸缩","like_count":0},{"had_liked":false,"id":25322,"user_name":"天下","can_delete":false,"product_type":"c1","uid":1139564,"ip_address":"","ucode":"B7A23205108AFF","user_header":"","comment_is_top":false,"comment_ctime":1537314972,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537314972","product_id":100015201,"comment_content":"方便以后定义多副本和滚动更新","like_count":0},{"had_liked":false,"id":25319,"user_name":"Tigerfive","can_delete":false,"product_type":"c1","uid":1221781,"ip_address":"","ucode":"D29522D4EFABEF","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/95/474d5eaf.jpg","comment_is_top":false,"comment_ctime":1537314799,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537314799","product_id":100015201,"comment_content":"使用一个 replicas=1 的 Deployment，这样便于以后的扩容与修改，减少不必要的操作。","like_count":0},{"had_liked":false,"id":25317,"user_name":"Tigerfive","can_delete":false,"product_type":"c1","uid":1221781,"ip_address":"","ucode":"D29522D4EFABEF","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/95/474d5eaf.jpg","comment_is_top":false,"comment_ctime":1537314680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537314680","product_id":100015201,"comment_content":"使用一个 replicas=1 的 Deployment，这样更便于以后的扩容和修改配置，加快更新节奏，减少不必要的操作步骤。","like_count":0}]}