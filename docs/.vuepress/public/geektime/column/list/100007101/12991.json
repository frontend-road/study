{"id":12991,"title":"第37讲 | 知识串讲：用双十一的故事串起碎片的网络协议（上）","content":"<p>基本的网络知识我们都讲完了，还记得最初举的那个“双十一”下单的例子吗？这一节开始，我们详细地讲解这个过程，用这个过程串起我们讲过的网络协议。</p>\n<p>我把这个过程分为十个阶段，从云平台中搭建一个电商开始，到BGP路由广播，再到DNS域名解析，从客户看商品图片，到最终下单的整个过程，每一步我都会详细讲解。这节我们先来看前三个阶段。</p>\n<h2>1.部署一个高可用高并发的电商平台</h2>\n<p>首先，咱们<strong>要有个电商平台</strong>。假设我们已经有了一个特别大的电商平台，这个平台应该部署在哪里呢？假设我们用公有云，一般公有云会有多个位置，比如在华东、华北、华南都有。毕竟咱们的电商是要服务全国的，当然到处都要部署了。我们把主站点放在华东。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/ed/20/eddde5929de2a72b197321e5ad87e120.jpg?wh=1659*1170\" alt=\"\" /></p>\n<p>为了每个点都能“雨露均沾”，也为了高可用性，往往需要有多个机房，形成多个可用区（Available Zone）。由于咱们的应用是分布在两个可用区的，所以假如任何一个可用区挂了，都不会受影响。</p>\n<p>我们来回想<a href=\"https://time.geekbang.org/column/article/10098\">数据中心</a>那一节，每个可用区里有一片一片的机柜，每个机柜上有一排一排的服务器，每个机柜都有一个接入交换机，有一个汇聚交换机将多个机柜连在一起。</p>\n<p>这些服务器里面部署的都是计算节点，每台上面都有Open  vSwitch创建的虚拟交换机，将来在这台机器上创建的虚拟机，都会连到Open  vSwitch上。</p><!-- [[[read_end]]] -->\n<p><img src=\"https://static001.geekbang.org/resource/image/d6/a7/d66c01c39e911e784525a118c37b50a7.jpg?wh=1323*998\" alt=\"\" /></p>\n<p>接下来，你<strong>在云计算的界面上创建一个VPC</strong>（Virtual Private Cloud，虚拟私有网络），指定一个IP段，这样以后你部署的所有应用都会在这个虚拟网络里，使用你分配的这个IP段。为了不同的VPC相互隔离，每个VPC都会被分配一个VXLAN的ID。尽管不同用户的虚拟机有可能在同一个物理机上，但是不同的VPC二层压根儿是不通的。</p>\n<p>由于有两个可用区，在这个VPC里面，要为每一个可用区分配一个Subnet，也就是在大的网段里分配两个小的网段。当两个可用区里面网段不同的时候，就可以配置路由策略，访问另外一个可用区，走某一条路由了。</p>\n<p>接下来，应该<strong>创建数据库持久化层</strong>。大部分云平台都会提供PaaS服务，也就是说，不需要你自己搭建数据库，而是采用直接提供数据库的服务，并且单机房的主备切换都是默认做好的，数据库也是部署在虚拟机里面的，只不过从界面上，你看不到数据库所在的虚拟机而已。</p>\n<p>云平台会给每个Subnet的数据库实例分配一个域名。创建数据库实例的时候，需要你指定可用区和Subnet，这样创建出来的数据库实例可以通过这个Subnet的私网IP进行访问。</p>\n<p>为了分库分表实现高并发的读写，在创建的多个数据库实例之上，会<strong>创建一个分布式数据库的实例</strong>，也需要指定可用区和Subnet，还会为分布式数据库分配一个私网IP和域名。</p>\n<p>对于数据库这种高可用性比较高的，需要进行跨机房高可用，因而两个可用区都要部署一套，但是只有一个是主，另外一个是备，云平台往往会提供数据库同步工具，将应用写入主的数据同步给备数据库集群。</p>\n<p>接下来是<strong>创建缓存集</strong>群。云平台也会提供PaaS服务，也需要每个可用区和Subnet创建一套，缓存的数据在内存中，由于读写性能要求高，一般不要求跨可用区读写。</p>\n<p>再往上层就是<strong>部署咱们自己写的程序</strong>了。基础服务层、组合服务层、Controller层，以及Nginx层、API网关等等，这些都是部署在虚拟机里面的。它们之间通过RPC相互调用，需要到注册中心进行注册。</p>\n<p>它们之间的网络通信是虚拟机和虚拟机之间的。如果是同一台物理机，则那台物理机上的OVS就能转发过去；如果是不同的物理机，这台物理机的OVS和另一台物理机的OVS中间有一个VXLAN的隧道，将请求转发过去。</p>\n<p>再往外就是<strong>负载均衡</strong>了，负载均衡也是云平台提供的PaaS服务，也是属于某个VPC的，部署在虚拟机里面的，但是负载均衡有个外网的IP，这个外网的IP地址就是在网关节点的外网网口上的。在网关节点上，会有NAT规则，将外网IP地址转换为VPC里面的私网IP地址，通过这些私网IP地址访问到虚拟机上的负载均衡节点，然后通过负载均衡节点转发到API网关的节点。</p>\n<p>网关节点的外网网口是带公网IP地址的，里面有一个虚拟网关转发模块，还会有一个OVS，将私网IP地址放到VXLAN隧道里面，转发到虚拟机上，从而实现外网和虚拟机网络之间的互通。</p>\n<p>不同的可用区之间，通过核心交换机连在一起，核心交换机之外是边界路由器。</p>\n<p>在华北、华东、华南同样也部署了一整套，每个地区都创建了VPC，这就需要有一种机制将VPC连接到一起。云平台一般会提供硬件的VPC互连的方式，当然也可以使用软件互连的方式，也就是使用VPN网关，通过IPsec VPN将不同地区的不同VPC通过VPN连接起来。</p>\n<p>对于不同地区和不同运营商的用户，我们希望他能够就近访问到网站，而且当一个点出了故障之后，我们希望能够在不同的地区之间切换，这就需要有智能DNS，这个也是云平台提供的。</p>\n<p>对于一些静态资源，可以保持在对象存储里面，通过CDN下发到边缘节点，这样客户端就能尽快加载出来。</p>\n<h2>2.大声告诉全世界，可以到我这里买东西</h2>\n<p>当电商应用搭建完毕之后，接下来需要将如何访问到这个电商网站广播给全网。</p>\n<p>刚才那张图画的是一个可用区的情况，对于多个可用区的情况，我们可以隐去计算节点的情况，将外网访问区域放大。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/e1/24/e132bc3ba500b1197139f30c02e20124.jpg?wh=990*1205\" alt=\"\" /></p>\n<p>外网IP是放在虚拟网关的外网网口上的，这个IP如何让全世界知道呢？当然是通过BGP路由协议了。</p>\n<p>每个可用区都有自己的汇聚交换机，如果机器数目比较多，可以直接用核心交换机，每个Region也有自己的核心交换区域。</p>\n<p>在核心交换外面是安全设备，然后就是边界路由器。边界路由器会和多个运营商连接，从而每个运营商都能够访问到这个网站。边界路由器可以通过BGP协议，将自己数据中心里面的外网IP向外广播，也就是告诉全世界，如果要访问这些外网IP，都来我这里。</p>\n<p>每个运营商也有很多的路由器、很多的点，于是就可以将如何到达这些IP地址的路由信息，广播到全国乃至全世界。</p>\n<h2>3.打开手机来上网，域名解析得地址</h2>\n<p>这个时候，不但你的这个网站的IP地址全世界都知道了，你打的广告可能大家也都看到了，于是有客户下载App来买东西了。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/85/fc/85c125c225faba29c0f374e18ea8c6fc.jpg?wh=1455*719\" alt=\"\" /></p>\n<p>客户的手机开机以后，在附近寻找基站eNodeB，发送请求，申请上网。基站将请求发给MME，MME对手机进行认证和鉴权，还会请求HSS看有没有钱，看看是在哪里上网。</p>\n<p>当MME通过了手机的认证之后，开始建立隧道，建设的数据通路分两段路，其实是两个隧道。一段是从eNodeB到SGW，第二段是从SGW到PGW，在PGW之外，就是互联网。</p>\n<p>PGW会为手机分配一个IP地址，手机上网都是带着这个IP地址的。</p>\n<p>当在手机上面打开一个App的时候，首先要做的事情就是解析这个网站的域名。</p>\n<p>在手机运营商所在的互联网区域里，有一个本地的DNS，手机会向这个DNS请求解析DNS。当这个DNS本地有缓存，则直接返回；如果没有缓存，本地DNS才需要递归地从根DNS服务器，查到.com的顶级域名服务器，最终查到权威DNS服务器。</p>\n<p>如果你使用云平台的时候，配置了智能DNS和全局负载均衡，在权威DNS服务中，一般是通过配置CNAME的方式，我们可以起一个别名，例如  <a href=\"http://vip.yourcomany.com\">vip.yourcomany.com</a>  ，然后告诉本地DNS服务器，让它请求GSLB解析这个域名，GSLB就可以在解析这个域名的过程中，通过自己的策略实现负载均衡。</p>\n<p>GSLB通过查看请求它的本地DNS服务器所在的运营商和地址，就知道用户所在的运营商和地址，然后将距离用户位置比较近的Region里面，三个负载均衡SLB的公网IP地址，返回给本地DNS服务器。本地DNS解析器将结果缓存后，返回给客户端。</p>\n<p>对于手机App来说，可以绕过刚才的传统DNS解析机制，直接只要HTTPDNS服务，通过直接调用HTTPDNS服务器，得到这三个SLB的公网IP地址。</p>\n<p>看，经过了如此复杂的过程，咱们的万里长征还没迈出第一步，刚刚得到IP地址，包还没发呢？话说手机App拿到了公网IP地址，接下来应该做什么呢？</p>\n<p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>\n<p></p>\n","comments":[{"had_liked":false,"id":19598,"user_name":"固态U盘","can_delete":false,"product_type":"c1","uid":1043446,"ip_address":"","ucode":"9C473DA25CB4C1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/eb/f6/ec7971f4.jpg","comment_is_top":false,"comment_ctime":1533900503,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"121792984791","product_id":100007101,"comment_content":"意犹未尽！老师再开个其他专栏吧。","like_count":29},{"had_liked":false,"id":19664,"user_name":"zcpromising","can_delete":false,"product_type":"c1","uid":1131966,"ip_address":"","ucode":"4F29D98A436D09","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/be/494010aa.jpg","comment_is_top":false,"comment_ctime":1533951254,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"96023231766","product_id":100007101,"comment_content":"讲的太精彩了，老师还能不能来个kubernetes相关的专栏","like_count":23},{"had_liked":false,"id":21266,"user_name":"trllllllll","can_delete":false,"product_type":"c1","uid":1134649,"ip_address":"","ucode":"976B8BBA802A6D","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/39/14adb0f0.jpg","comment_is_top":false,"comment_ctime":1534987772,"is_pvip":false,"replies":[{"id":"7485","content":"谢谢","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1534990568,"ip_address":"","comment_id":21266,"utype":1}],"discussion_count":1,"race_medal":0,"score":"87434333692","product_id":100007101,"comment_content":"极客时间学过的5个专栏里最好的一个了，赞","like_count":21,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422610,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534990568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19478,"user_name":"程启","can_delete":false,"product_type":"c1","uid":1019204,"ip_address":"","ucode":"02CDE64EDF9A3C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/44/f3d0017c.jpg","comment_is_top":false,"comment_ctime":1533861192,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35893599560","product_id":100007101,"comment_content":"请教，全球或者国内加海外双十一，调度和数据库层会否有大的变动。<br><br>这个系列这么快结束了，真是依依不舍。再开个续集吧 😃","like_count":9},{"had_liked":false,"id":132767,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1568215790,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23043052270","product_id":100007101,"comment_content":"老师，看不懂有网络的书推荐么?","like_count":5},{"had_liked":false,"id":128787,"user_name":"stark","can_delete":false,"product_type":"c1","uid":1143399,"ip_address":"","ucode":"ADC5C2AE5B97C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/67/aa52812a.jpg","comment_is_top":false,"comment_ctime":1566963049,"is_pvip":false,"replies":[{"id":"48758","content":"赞，能感到有趣，就太棒了","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567494486,"ip_address":"","comment_id":128787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23041799529","product_id":100007101,"comment_content":"看了第二遍了，看的终于有点懂了些，而且觉得网络协议还挺有趣","like_count":6,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465104,"discussion_content":"赞，能感到有趣，就太棒了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567494486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79978,"user_name":"大坏狐狸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1553586917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18733456101","product_id":100007101,"comment_content":"撑到现在 给自己鼓鼓掌","like_count":5},{"had_liked":false,"id":228364,"user_name":"Geek_wadehao","can_delete":false,"product_type":"c1","uid":1918225,"ip_address":"","ucode":"F46FFAFC4933D6","user_header":"https://static001.geekbang.org/account/avatar/00/1d/45/11/51aaa953.jpg","comment_is_top":false,"comment_ctime":1592648902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10182583494","product_id":100007101,"comment_content":"棒。打通了云计算、移动通信、计算机网络等多门科目。","like_count":3},{"had_liked":false,"id":51044,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1545105256,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10135039848","product_id":100007101,"comment_content":"精彩","like_count":3},{"had_liked":false,"id":22329,"user_name":"西斯","can_delete":false,"product_type":"c1","uid":1053797,"ip_address":"","ucode":"A00C3C2D4709C4","user_header":"https://static001.geekbang.org/account/avatar/00/10/14/65/c602a30d.jpg","comment_is_top":false,"comment_ctime":1535606846,"is_pvip":false,"replies":[{"id":"8019","content":"可以全量，就是比较贵，买个存储设备都是有同步机制的，距离近，带宽能保证，就实时同步，不能保证就异步同步。","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1535625638,"ip_address":"","comment_id":22329,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10125541438","product_id":100007101,"comment_content":"请教个问题 不同机房里的数据库存储的是自己机房的数据 还是包括其他所有机房的数据 如果是全量 跨机房间的数据同步是怎么做的?","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423072,"discussion_content":"可以全量，就是比较贵，买个存储设备都是有同步机制的，距离近，带宽能保证，就实时同步，不能保证就异步同步。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535625638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131957,"user_name":"程序员大天地","can_delete":false,"product_type":"c1","uid":1249001,"ip_address":"","ucode":"7A21F15FEE2D5B","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/e9/98b6ea61.jpg","comment_is_top":false,"comment_ctime":1567992269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5862959565","product_id":100007101,"comment_content":"厉害厉害，精彩！","like_count":1},{"had_liked":false,"id":41997,"user_name":"Enterprize","can_delete":false,"product_type":"c1","uid":1215130,"ip_address":"","ucode":"3C120E9023B6C5","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/9a/7270d764.jpg","comment_is_top":false,"comment_ctime":1542889118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837856414","product_id":100007101,"comment_content":"云中网络看的我像在云里，终于到能看懂的东西了","like_count":1},{"had_liked":false,"id":39960,"user_name":"叶","can_delete":false,"product_type":"c1","uid":1166158,"ip_address":"","ucode":"E0416DD7D62B8E","user_header":"https://static001.geekbang.org/account/avatar/00/11/cb/4e/3e337008.jpg","comment_is_top":false,"comment_ctime":1542421621,"is_pvip":false,"replies":[{"id":"14362","content":"有啊，再往后看","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1542439212,"ip_address":"","comment_id":39960,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5837388917","product_id":100007101,"comment_content":"老师，我买你前面的课了，那个趣谈协议，我买了，没看到你总结的协议图，不过你讲的生动易懂","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429310,"discussion_content":"有啊，再往后看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542439212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1768374,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fb/b6/728e2d02.jpg","nickname":"偶来人间，风度翩翩","note":"","ucode":"DDABD0E3EB7104","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312866,"discussion_content":"请问你找到 总结的协议图 了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602838819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1333380,"avatar":"https://static001.geekbang.org/account/avatar/00/14/58/84/fd5031e5.jpg","nickname":"别忘微笑","note":"","ucode":"855266F40976E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1768374,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fb/b6/728e2d02.jpg","nickname":"偶来人间，风度翩翩","note":"","ucode":"DDABD0E3EB7104","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":373377,"discussion_content":"图在哪，同问，老哥找到了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620710248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":312866,"ip_address":""},"score":373377,"extra":""}]}]},{"had_liked":false,"id":26573,"user_name":"凌天","can_delete":false,"product_type":"c1","uid":1109551,"ip_address":"","ucode":"761344882F4432","user_header":"https://static001.geekbang.org/account/avatar/00/10/ee/2f/aecf69a5.jpg","comment_is_top":false,"comment_ctime":1537677833,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5832645129","product_id":100007101,"comment_content":"老师太博学了","like_count":2},{"had_liked":false,"id":19792,"user_name":"hhq","can_delete":false,"product_type":"c1","uid":1136388,"ip_address":"","ucode":"40978A70CBA309","user_header":"https://static001.geekbang.org/account/avatar/00/11/57/04/07eb8cbb.jpg","comment_is_top":false,"comment_ctime":1534074519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5829041815","product_id":100007101,"comment_content":"把vxlan，vpn和bgp的使用场景都串联起来了，期待下一期的串讲","like_count":1},{"had_liked":false,"id":19493,"user_name":"horsechestnut","can_delete":false,"product_type":"c1","uid":1177115,"ip_address":"","ucode":"6B34233FC08059","user_header":"","comment_is_top":false,"comment_ctime":1533862671,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5828829967","product_id":100007101,"comment_content":"这一章开始看不懂了~不过还没工作，等工作了应该在实践中可以得出真知","like_count":1},{"had_liked":false,"id":315959,"user_name":"Join","can_delete":false,"product_type":"c1","uid":1014873,"ip_address":"","ucode":"20F51EFFD8FEDE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/59/dc9bbb21.jpg","comment_is_top":false,"comment_ctime":1634087746,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634087746","product_id":100007101,"comment_content":"谢谢刘老师，这个专栏真的太值了，不光教网络，还有公有云的应用部署结构（特别是这节，太通透了），连最近很火的Envoy和Istio都带了点，格局打开","like_count":0},{"had_liked":false,"id":292753,"user_name":"W҈T҈H҈","can_delete":false,"product_type":"c1","uid":1919027,"ip_address":"","ucode":"93AA6E442B5A47","user_header":"https://static001.geekbang.org/account/avatar/00/1d/48/33/4663928e.jpg","comment_is_top":false,"comment_ctime":1620962513,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620962513","product_id":100007101,"comment_content":"不错，知识都串起来了，很爽！","like_count":0},{"had_liked":false,"id":280520,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1614240373,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614240373","product_id":100007101,"comment_content":"只是串讲非常清晰，多亏更完了才看的，不然跟追剧一样想看想得心痒","like_count":0},{"had_liked":false,"id":264850,"user_name":"Direction","can_delete":false,"product_type":"c1","uid":1731977,"ip_address":"","ucode":"298D5109EA28EE","user_header":"https://static001.geekbang.org/account/avatar/00/1a/6d/89/14031273.jpg","comment_is_top":false,"comment_ctime":1606690420,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606690420","product_id":100007101,"comment_content":"我们目前得架构就是这样的，所以理解起来还挺好。用的阿里云华北2，多个高可用区，用vpc打通多个高可用区。","like_count":0},{"had_liked":false,"id":260687,"user_name":"Yolo七夜","can_delete":false,"product_type":"c1","uid":1040071,"ip_address":"","ucode":"7CB74C0A1DF785","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/c7/26485903.jpg","comment_is_top":false,"comment_ctime":1605083493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605083493","product_id":100007101,"comment_content":"今天刚好双十一，哈哈哈","like_count":0},{"had_liked":false,"id":195842,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1585218978,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585218978","product_id":100007101,"comment_content":"从搭建电商平台，到对外提供服务，最后用户来申请服务。这样一个流程，一步一步地还原生活中具体的场景，知识点很多，也很有趣。","like_count":0},{"had_liked":false,"id":192931,"user_name":"Geek_David","can_delete":false,"product_type":"c1","uid":1897719,"ip_address":"","ucode":"9B9F30BB2F2C68","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f4/f7/871ff71d.jpg","comment_is_top":false,"comment_ctime":1584878974,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584878974","product_id":100007101,"comment_content":"棒","like_count":0},{"had_liked":false,"id":155160,"user_name":"cyz","can_delete":false,"product_type":"c1","uid":1498145,"ip_address":"","ucode":"233B1FC28A45F1","user_header":"https://static001.geekbang.org/account/avatar/00/16/dc/21/34c72e67.jpg","comment_is_top":false,"comment_ctime":1574653586,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1574653586","product_id":100007101,"comment_content":"很过瘾啊","like_count":0},{"had_liked":false,"id":125398,"user_name":"小毅(Eric)","can_delete":false,"product_type":"c1","uid":1081516,"ip_address":"","ucode":"CBFF9C432E6C69","user_header":"https://static001.geekbang.org/account/avatar/00/10/80/ac/37afe559.jpg","comment_is_top":false,"comment_ctime":1566179204,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566179204","product_id":100007101,"comment_content":"老师真的很厉害,这一看就是有相当的经验才能写的出来的","like_count":0},{"had_liked":false,"id":93959,"user_name":"谢晋","can_delete":false,"product_type":"c1","uid":1074435,"ip_address":"","ucode":"BFD296917C4888","user_header":"https://static001.geekbang.org/account/avatar/00/10/65/03/973b24ec.jpg","comment_is_top":false,"comment_ctime":1557676165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557676165","product_id":100007101,"comment_content":"喜欢老师文章的通俗、易懂、有趣，表达非常有激情","like_count":0},{"had_liked":false,"id":60587,"user_name":"周平","can_delete":false,"product_type":"c1","uid":1047936,"ip_address":"","ucode":"CA1869B139A4F6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fd/80/52763d62.jpg","comment_is_top":false,"comment_ctime":1547516381,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547516381","product_id":100007101,"comment_content":"信息量巨大，老师赞","like_count":0},{"had_liked":false,"id":20266,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1534341684,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1534341684","product_id":100007101,"comment_content":"老师太赞了 学学学100遍","like_count":0},{"had_liked":false,"id":19522,"user_name":"空档滑行","can_delete":false,"product_type":"c1","uid":1091611,"ip_address":"","ucode":"06A6A7F503FAA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg","comment_is_top":false,"comment_ctime":1533866346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533866346","product_id":100007101,"comment_content":"有个问题请请教下，我是可以每个虚拟机都绑定一个外网ip的。但是图上一个物理机只分配了一个，如果要多个是怎么实现的","like_count":0},{"had_liked":false,"id":19518,"user_name":"空档滑行","can_delete":false,"product_type":"c1","uid":1091611,"ip_address":"","ucode":"06A6A7F503FAA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg","comment_is_top":false,"comment_ctime":1533866046,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533866046","product_id":100007101,"comment_content":"拿到公网ip后，应该要建立连接了吧。走TCP协议发SYNC","like_count":0},{"had_liked":false,"id":19512,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1533864868,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533864868","product_id":100007101,"comment_content":"补充些内容，应该是继续通过 enodeb 接入网络，然后向 CDN 获取静态内容，浏览到动态部分时，向负载均衡发起请求。","like_count":0},{"had_liked":false,"id":19509,"user_name":"赤脚小子","can_delete":false,"product_type":"c1","uid":1069213,"ip_address":"","ucode":"9F55F0E707F9A7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIvMlvSXsYgJibIyDO78gPacZR1qukEOJrpfHAJmyGVtWPO3XMqVA9dImHhGJm2icp6lDuBw1GrNDbA/132","comment_is_top":false,"comment_ctime":1533864326,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533864326","product_id":100007101,"comment_content":"有ip了要建立连接了，http协议，tcp协议udp协议，长连接，短连接。","like_count":0},{"had_liked":false,"id":19491,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1533862489,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533862489","product_id":100007101,"comment_content":"App 应该是先发http 请求进行登陆和身份验证吧，如果是匿名的话，就直接可以请求首页浏览商品了。","like_count":0}]}