{"id":298205,"title":"28 | Pikaï¼šå¦‚ä½•åŸºäºSSDå®ç°å¤§å®¹é‡Redisï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è’‹å¾·é’§ã€‚</p><p>æˆ‘ä»¬åœ¨åº”ç”¨Redisæ—¶ï¼Œéšç€ä¸šåŠ¡æ•°æ®çš„å¢åŠ ï¼ˆæ¯”å¦‚è¯´ç”µå•†ä¸šåŠ¡ä¸­ï¼Œéšç€ç”¨æˆ·è§„æ¨¡å’Œå•†å“æ•°é‡çš„å¢åŠ ï¼‰ï¼Œå°±éœ€è¦Redisèƒ½ä¿å­˜æ›´å¤šçš„æ•°æ®ã€‚ä½ å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨Redisåˆ‡ç‰‡é›†ç¾¤ï¼ŒæŠŠæ•°æ®åˆ†æ•£ä¿å­˜åˆ°å¤šä¸ªå®ä¾‹ä¸Šã€‚ä½†æ˜¯è¿™æ ·åšçš„è¯ï¼Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè¦ä¿å­˜çš„æ•°æ®æ€»é‡å¾ˆå¤§ï¼Œä½†æ˜¯æ¯ä¸ªå®ä¾‹ä¿å­˜çš„æ•°æ®é‡è¾ƒå°çš„è¯ï¼Œå°±ä¼šå¯¼è‡´é›†ç¾¤çš„å®ä¾‹è§„æ¨¡å¢åŠ ï¼Œè¿™ä¼šè®©é›†ç¾¤çš„è¿ç»´ç®¡ç†å˜å¾—å¤æ‚ï¼Œå¢åŠ å¼€é”€ã€‚</p><p>ä½ å¯èƒ½åˆä¼šè¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ Rediså•å®ä¾‹çš„å†…å­˜å®¹é‡ï¼Œå½¢æˆå¤§å†…å­˜å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹å¯ä»¥ä¿å­˜æ›´å¤šçš„æ•°æ®ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåœ¨ä¿å­˜ç›¸åŒçš„æ•°æ®æ€»é‡æ—¶ï¼Œæ‰€éœ€è¦çš„å¤§å†…å­˜å®ä¾‹çš„ä¸ªæ•°å°±ä¼šå‡å°‘ï¼Œå°±å¯ä»¥èŠ‚çœå¼€é”€ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä½†è¿™ä¹Ÿå¹¶ä¸æ˜¯å®Œç¾çš„æ–¹æ¡ˆï¼šåŸºäºå¤§å†…å­˜çš„å¤§å®¹é‡å®ä¾‹åœ¨å®ä¾‹æ¢å¤ã€ä¸»ä»åŒæ­¥è¿‡ç¨‹ä¸­ä¼šå¼•èµ·ä¸€ç³»åˆ—æ½œåœ¨é—®é¢˜ï¼Œä¾‹å¦‚æ¢å¤æ—¶é—´å¢é•¿ã€ä¸»ä»åˆ‡æ¢å¼€é”€å¤§ã€ç¼“å†²åŒºæ˜“æº¢å‡ºã€‚</p><p>é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘æ¨èä½ ä½¿ç”¨å›ºæ€ç¡¬ç›˜ï¼ˆSolid State Driveï¼ŒSSDï¼‰ã€‚å®ƒçš„æˆæœ¬å¾ˆä½ï¼ˆæ¯GBçš„æˆæœ¬çº¦æ˜¯å†…å­˜çš„ååˆ†ä¹‹ä¸€ï¼‰ï¼Œè€Œä¸”å®¹é‡å¤§ï¼Œè¯»å†™é€Ÿåº¦å¿«ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºSSDæ¥å®ç°å¤§å®¹é‡çš„Rediså®ä¾‹ã€‚360å…¬å¸DBAå’ŒåŸºç¡€æ¶æ„ç»„è”åˆå¼€å‘çš„Pika<a href=\"https://github.com/Qihoo360/pika\">é”®å€¼æ•°æ®åº“</a>ï¼Œæ­£å¥½å®ç°äº†è¿™ä¸€éœ€æ±‚ã€‚</p><p>Pikaåœ¨åˆšå¼€å§‹è®¾è®¡çš„æ—¶å€™ï¼Œå°±æœ‰ä¸¤ä¸ªç›®æ ‡ï¼šä¸€æ˜¯ï¼Œå•å®ä¾‹å¯ä»¥ä¿å­˜å¤§å®¹é‡æ•°æ®ï¼ŒåŒæ—¶é¿å…äº†å®ä¾‹æ¢å¤å’Œä¸»ä»åŒæ­¥æ—¶çš„æ½œåœ¨é—®é¢˜ï¼›äºŒæ˜¯ï¼Œå’ŒRedisæ•°æ®ç±»å‹ä¿æŒå…¼å®¹ï¼Œå¯ä»¥æ”¯æŒä½¿ç”¨Redisçš„åº”ç”¨å¹³æ»‘åœ°è¿ç§»åˆ°Pikaä¸Šã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ ä¸€ç›´åœ¨ä½¿ç”¨Redisï¼Œå¹¶ä¸”æƒ³ä½¿ç”¨SSDæ¥æ‰©å±•å•å®ä¾‹å®¹é‡ï¼ŒPikaå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><!-- [[[read_end]]] --><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘å°±å’Œä½ èŠèŠPikaã€‚åœ¨ä»‹ç»Pikaå‰ï¼Œæˆ‘å…ˆç»™ä½ å…·ä½“è§£é‡Šä¸‹åŸºäºå¤§å†…å­˜å®ç°å¤§å®¹é‡Rediså®ä¾‹çš„æ½œåœ¨é—®é¢˜ã€‚åªæœ‰çŸ¥é“äº†è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ‰èƒ½é€‰æ‹©æ›´åˆé€‚çš„æ–¹æ¡ˆã€‚å¦å¤–å‘¢ï¼Œæˆ‘è¿˜ä¼šå¸¦ä½ ä¸€æ­¥æ­¥åˆ†æä¸‹Pikaæ˜¯å¦‚ä½•å®ç°åˆšåˆšæˆ‘ä»¬æ‰€è¯´çš„ä¸¤ä¸ªè®¾è®¡ç›®æ ‡ï¼Œè§£å†³è¿™äº›é—®é¢˜çš„ã€‚</p><h2>å¤§å†…å­˜Rediså®ä¾‹çš„æ½œåœ¨é—®é¢˜</h2><p>Redisä½¿ç”¨å†…å­˜ä¿å­˜æ•°æ®ï¼Œå†…å­˜å®¹é‡å¢åŠ åï¼Œå°±ä¼šå¸¦æ¥ä¸¤æ–¹é¢çš„æ½œåœ¨é—®é¢˜ï¼Œåˆ†åˆ«æ˜¯ï¼Œå†…å­˜å¿«ç…§RDBç”Ÿæˆå’Œæ¢å¤æ•ˆç‡ä½ï¼Œä»¥åŠä¸»ä»èŠ‚ç‚¹å…¨é‡åŒæ­¥æ—¶é•¿å¢åŠ ã€ç¼“å†²åŒºæ˜“æº¢å‡ºã€‚æˆ‘æ¥ä¸€ä¸€è§£é‡Šä¸‹ï¼Œ</p><p>æˆ‘ä»¬å…ˆçœ‹å†…å­˜å¿«ç…§RDBå—åˆ°çš„å½±å“ã€‚å†…å­˜å¤§å°å’Œå†…å­˜å¿«ç…§RDBçš„å…³ç³»æ˜¯éå¸¸ç›´æ¥çš„ï¼šå®ä¾‹å†…å­˜å®¹é‡å¤§ï¼ŒRDBæ–‡ä»¶ä¹Ÿä¼šç›¸åº”å¢å¤§ï¼Œé‚£ä¹ˆï¼ŒRDBæ–‡ä»¶ç”Ÿæˆæ—¶çš„forkæ—¶é•¿å°±ä¼šå¢åŠ ï¼Œè¿™å°±ä¼šå¯¼è‡´Rediså®ä¾‹é˜»å¡ã€‚è€Œä¸”ï¼ŒRDBæ–‡ä»¶å¢å¤§åï¼Œä½¿ç”¨RDBè¿›è¡Œæ¢å¤çš„æ—¶é•¿ä¹Ÿä¼šå¢åŠ ï¼Œä¼šå¯¼è‡´Redisè¾ƒé•¿æ—¶é—´æ— æ³•å¯¹å¤–æä¾›æœåŠ¡ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹ä¸‹ä¸»ä»åŒæ­¥å—åˆ°çš„å½±å“ï¼Œ</p><p>ä¸»ä»èŠ‚ç‚¹é—´çš„åŒæ­¥çš„ç¬¬ä¸€æ­¥å°±æ˜¯è¦åšå…¨é‡åŒæ­¥ã€‚å…¨é‡åŒæ­¥æ˜¯ä¸»èŠ‚ç‚¹ç”ŸæˆRDBæ–‡ä»¶ï¼Œå¹¶ä¼ ç»™ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹å†è¿›è¡ŒåŠ è½½ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœRDBæ–‡ä»¶å¾ˆå¤§ï¼Œè‚¯å®šä¼šå¯¼è‡´å…¨é‡åŒæ­¥çš„æ—¶é•¿å¢åŠ ï¼Œæ•ˆç‡ä¸é«˜ï¼Œè€Œä¸”è¿˜å¯èƒ½ä¼šå¯¼è‡´å¤åˆ¶ç¼“å†²åŒºæº¢å‡ºã€‚ä¸€æ—¦ç¼“å†²åŒºæº¢å‡ºäº†ï¼Œä¸»ä»èŠ‚ç‚¹é—´å°±ä¼šåˆå¼€å§‹å…¨é‡åŒæ­¥ï¼Œå½±å“ä¸šåŠ¡åº”ç”¨çš„æ­£å¸¸ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬å¢åŠ å¤åˆ¶ç¼“å†²åŒºçš„å®¹é‡ï¼Œè¿™åˆä¼šæ¶ˆè€—å®è´µçš„å†…å­˜èµ„æºã€‚</p><p>æ­¤å¤–ï¼Œå¦‚æœä¸»åº“å‘ç”Ÿäº†æ•…éšœï¼Œè¿›è¡Œä¸»ä»åˆ‡æ¢åï¼Œå…¶ä»–ä»åº“éƒ½éœ€è¦å’Œæ–°ä¸»åº“è¿›è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥ã€‚å¦‚æœRDBæ–‡ä»¶å¾ˆå¤§ï¼Œä¹Ÿä¼šå¯¼è‡´ä¸»ä»åˆ‡æ¢çš„è¿‡ç¨‹è€—æ—¶å¢åŠ ï¼ŒåŒæ ·ä¼šå½±å“ä¸šåŠ¡çš„å¯ç”¨æ€§ã€‚</p><p>é‚£ä¹ˆï¼ŒPikaæ˜¯å¦‚ä½•è§£å†³è¿™ä¸¤æ–¹é¢çš„é—®é¢˜å‘¢ï¼Ÿè¿™å°±è¦æåˆ°Pikaä¸­çš„å…³é”®æ¨¡å—RocksDBã€binlogæœºåˆ¶å’ŒNemoäº†ï¼Œè¿™äº›æ¨¡å—éƒ½æ˜¯Pikaæ¶æ„ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å…ˆçœ‹ä¸‹Pikaçš„æ•´ä½“æ¶æ„ã€‚</p><h2>Pikaçš„æ•´ä½“æ¶æ„</h2><p>Pikaé”®å€¼æ•°æ®åº“çš„æ•´ä½“æ¶æ„ä¸­åŒ…æ‹¬äº†äº”éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ç½‘ç»œæ¡†æ¶ã€Pikaçº¿ç¨‹æ¨¡å—ã€Nemoå­˜å‚¨æ¨¡å—ã€RocksDBå’Œbinlogæœºåˆ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a1/e7/a1421b8dbca6bb1ee9b6c1be7a929ae7.jpg?wh=1486*1469\" alt=\"\"></p><p>è¿™äº”ä¸ªéƒ¨åˆ†åˆ†åˆ«å®ç°äº†ä¸åŒçš„åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä¸€ä¸ªä¸ªæ¥ä»‹ç»ä¸‹ã€‚</p><p>é¦–å…ˆï¼Œç½‘ç»œæ¡†æ¶ä¸»è¦è´Ÿè´£åº•å±‚ç½‘ç»œè¯·æ±‚çš„æ¥æ”¶å’Œå‘é€ã€‚Pikaçš„ç½‘ç»œæ¡†æ¶æ˜¯å¯¹æ“ä½œç³»ç»Ÿåº•å±‚çš„ç½‘ç»œå‡½æ•°è¿›è¡Œäº†å°è£…ã€‚Pikaåœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ç½‘ç»œæ¡†æ¶å°è£…å¥½çš„å‡½æ•°ã€‚</p><p>å…¶æ¬¡ï¼ŒPikaçº¿ç¨‹æ¨¡å—é‡‡ç”¨äº†å¤šçº¿ç¨‹æ¨¡å‹æ¥å…·ä½“å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒåŒ…æ‹¬ä¸€ä¸ªè¯·æ±‚åˆ†å‘çº¿ç¨‹ï¼ˆDispatchThreadï¼‰ã€ä¸€ç»„å·¥ä½œçº¿ç¨‹ï¼ˆWorkerThreadï¼‰ä»¥åŠä¸€ä¸ªçº¿ç¨‹æ± ï¼ˆThreadPoolï¼‰ã€‚</p><p>è¯·æ±‚åˆ†å‘çº¿ç¨‹ä¸“é—¨ç›‘å¬ç½‘ç»œç«¯å£ï¼Œä¸€æ—¦æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚åï¼Œå°±å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œå¹¶æŠŠè¿æ¥äº¤ç”±å·¥ä½œçº¿ç¨‹å¤„ç†ã€‚å·¥ä½œçº¿ç¨‹è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ä¸Šå‘é€çš„å…·ä½“å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æŠŠå‘½ä»¤è¯·æ±‚å°è£…æˆTaskï¼Œå†äº¤ç»™çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œç”±è¿™äº›çº¿ç¨‹è¿›è¡Œå®é™…çš„æ•°æ®å­˜å–å¤„ç†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/46/06/4627f13848167cdaa3b30370d9b80a06.jpg?wh=3000*1676\" alt=\"\"></p><p>åœ¨å®é™…åº”ç”¨Pikaçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ å·¥ä½œçº¿ç¨‹æ•°å’Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ï¼Œæ¥æå‡Pikaçš„è¯·æ±‚å¤„ç†ååç‡ï¼Œè¿›è€Œæ»¡è¶³ä¸šåŠ¡å±‚å¯¹æ•°æ®å¤„ç†æ€§èƒ½çš„éœ€æ±‚ã€‚</p><p>Nemoæ¨¡å—å¾ˆå®¹æ˜“ç†è§£ï¼Œå®ƒå®ç°äº†Pikaå’ŒRedisçš„æ•°æ®ç±»å‹å…¼å®¹ã€‚è¿™æ ·ä¸€æ¥ï¼Œå½“æˆ‘ä»¬æŠŠRedisæœåŠ¡è¿ç§»åˆ°Pikaæ—¶ï¼Œä¸ç”¨ä¿®æ”¹ä¸šåŠ¡åº”ç”¨ä¸­æ“ä½œRedisçš„ä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥ç»§ç»­åº”ç”¨è¿ç»´Redisçš„ç»éªŒï¼Œè¿™ä½¿å¾—Pikaçš„å­¦ä¹ æˆæœ¬å°±è¾ƒä½ã€‚Nemoæ¨¡å—å¯¹æ•°æ®ç±»å‹çš„å…·ä½“è½¬æ¢æœºåˆ¶æ˜¯æˆ‘ä»¬è¦é‡ç‚¹å…³å¿ƒçš„ï¼Œä¸‹é¢æˆ‘ä¼šå…·ä½“ä»‹ç»ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹RocksDBæä¾›çš„åŸºäºSSDä¿å­˜æ•°æ®çš„åŠŸèƒ½ã€‚å®ƒä½¿å¾—Pikaå¯ä»¥ä¸ç”¨å¤§å®¹é‡çš„å†…å­˜ï¼Œå°±èƒ½ä¿å­˜æ›´å¤šæ•°æ®ï¼Œè¿˜é¿å…äº†ä½¿ç”¨å†…å­˜å¿«ç…§ã€‚è€Œä¸”ï¼ŒPikaä½¿ç”¨binlogæœºåˆ¶è®°å½•å†™å‘½ä»¤ï¼Œç”¨äºä¸»ä»èŠ‚ç‚¹çš„å‘½ä»¤åŒæ­¥ï¼Œé¿å…äº†åˆšåˆšæ‰€è¯´çš„å¤§å†…å­˜å®ä¾‹åœ¨ä¸»ä»åŒæ­¥è¿‡ç¨‹ä¸­çš„æ½œåœ¨é—®é¢˜ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å…·ä½“äº†è§£ä¸‹ï¼ŒPikaæ˜¯å¦‚ä½•ä½¿ç”¨RocksDBå’Œbinlogæœºåˆ¶çš„ã€‚</p><h2>Pikaå¦‚ä½•åŸºäºSSDä¿å­˜æ›´å¤šæ•°æ®ï¼Ÿ</h2><p>ä¸ºäº†æŠŠæ•°æ®ä¿å­˜åˆ°SSDï¼ŒPikaä½¿ç”¨äº†ä¸šç•Œå¹¿æ³›åº”ç”¨çš„æŒä¹…åŒ–é”®å€¼æ•°æ®åº“<a href=\"https://rocksdb.org/\">RocksDB</a>ã€‚RocksDBæœ¬èº«çš„å®ç°æœºåˆ¶è¾ƒä¸ºå¤æ‚ï¼Œä½ ä¸éœ€è¦å…¨éƒ¨å¼„æ˜ç™½ï¼Œä½ åªè¦è®°ä½RocksDBçš„åŸºæœ¬æ•°æ®è¯»å†™æœºåˆ¶ï¼Œå¯¹äºå­¦ä¹ äº†è§£Pikaæ¥è¯´ï¼Œå°±å·²ç»è¶³å¤Ÿäº†ã€‚ä¸‹é¢æˆ‘æ¥è§£é‡Šä¸‹è¿™ä¸ªåŸºæœ¬è¯»å†™æœºåˆ¶ã€‚</p><p>ä¸‹é¢æˆ‘ç»“åˆä¸€å¼ å›¾ç‰‡ï¼Œæ¥ç»™ä½ å…·ä½“ä»‹ç»ä¸‹RocksDBå†™å…¥æ•°æ®çš„åŸºæœ¬æµç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/95/1d/95d97d3cf0f1555b65b47fb256b7b81d.jpg?wh=3000*2139\" alt=\"\"></p><p>å½“Pikaéœ€è¦ä¿å­˜æ•°æ®æ—¶ï¼ŒRocksDBä¼šä½¿ç”¨ä¸¤å°å—å†…å­˜ç©ºé—´ï¼ˆMemtable1å’ŒMemtable2ï¼‰æ¥äº¤æ›¿ç¼“å­˜å†™å…¥çš„æ•°æ®ã€‚Memtableçš„å¤§å°å¯ä»¥è®¾ç½®ï¼Œä¸€ä¸ªMemtableçš„å¤§å°ä¸€èˆ¬ä¸ºå‡ MBæˆ–å‡ åMBã€‚å½“æœ‰æ•°æ®è¦å†™å…¥RocksDBæ—¶ï¼ŒRocksDBä¼šå…ˆæŠŠæ•°æ®å†™å…¥åˆ°Memtable1ã€‚ç­‰åˆ°Memtable1å†™æ»¡åï¼ŒRocksDBå†æŠŠæ•°æ®ä»¥æ–‡ä»¶çš„å½¢å¼ï¼Œå¿«é€Ÿå†™å…¥åº•å±‚çš„SSDã€‚åŒæ—¶ï¼ŒRocksDBä¼šä½¿ç”¨Memtable2æ¥ä»£æ›¿Memtable1ï¼Œç¼“å­˜æ–°å†™å…¥çš„æ•°æ®ã€‚ç­‰åˆ°Memtable1çš„æ•°æ®éƒ½å†™å…¥SSDäº†ï¼ŒRocksDBä¼šåœ¨Memtable2å†™æ»¡åï¼Œå†ç”¨Memtable1ç¼“å­˜æ–°å†™å…¥çš„æ•°æ®ã€‚</p><p>è¿™ä¹ˆä¸€åˆ†æä½ å°±çŸ¥é“äº†ï¼ŒRocksDBä¼šå…ˆç”¨Memtableç¼“å­˜æ•°æ®ï¼Œå†å°†æ•°æ®å¿«é€Ÿå†™å…¥SSDï¼Œå³ä½¿æ•°æ®é‡å†å¤§ï¼Œæ‰€æœ‰æ•°æ®ä¹Ÿéƒ½èƒ½ä¿å­˜åˆ°SSDä¸­ã€‚è€Œä¸”ï¼ŒMemtableæœ¬èº«å®¹é‡ä¸å¤§ï¼Œå³ä½¿RocksDBä½¿ç”¨äº†ä¸¤ä¸ªMemtableï¼Œä¹Ÿä¸ä¼šå ç”¨è¿‡å¤šçš„å†…å­˜ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒPikaåœ¨ä¿å­˜å¤§å®¹é‡æ•°æ®æ—¶ï¼Œä¹Ÿä¸ç”¨å æ®å¤ªå¤§çš„å†…å­˜ç©ºé—´äº†ã€‚</p><p>å½“Pikaéœ€è¦è¯»å–æ•°æ®çš„æ—¶å€™ï¼ŒRocksDBä¼šå…ˆåœ¨Memtableä¸­æŸ¥è¯¢æ˜¯å¦æœ‰è¦è¯»å–çš„æ•°æ®ã€‚è¿™æ˜¯å› ä¸ºï¼Œæœ€æ–°çš„æ•°æ®éƒ½æ˜¯å…ˆå†™å…¥åˆ°Memtableä¸­çš„ã€‚å¦‚æœMemtableä¸­æ²¡æœ‰è¦è¯»å–çš„æ•°æ®ï¼ŒRocksDBä¼šå†æŸ¥è¯¢ä¿å­˜åœ¨SSDä¸Šçš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/3b/aa70655efbb767af499a83bd6521ee3b.jpg?wh=2479*971\" alt=\"\"></p><p>åˆ°è¿™é‡Œï¼Œä½ å°±äº†è§£äº†ï¼Œå½“ä½¿ç”¨äº†RocksDBä¿å­˜æ•°æ®åï¼ŒPikaå°±å¯ä»¥æŠŠå¤§é‡æ•°æ®ä¿å­˜åˆ°å¤§å®¹é‡çš„SSDä¸Šäº†ï¼Œå®ç°äº†å¤§å®¹é‡å®ä¾‹ã€‚ä¸è¿‡ï¼Œæˆ‘åˆšæ‰å‘ä½ ä»‹ç»è¿‡ï¼Œå½“ä½¿ç”¨å¤§å†…å­˜å®ä¾‹ä¿å­˜å¤§é‡æ•°æ®æ—¶ï¼ŒRedisä¼šé¢ä¸´RDBç”Ÿæˆå’Œæ¢å¤çš„æ•ˆç‡é—®é¢˜ï¼Œä»¥åŠä¸»ä»åŒæ­¥æ—¶çš„æ•ˆç‡å’Œç¼“å†²åŒºæº¢å‡ºé—®é¢˜ã€‚é‚£ä¹ˆï¼Œå½“Pikaä¿å­˜å¤§é‡æ•°æ®æ—¶ï¼Œè¿˜ä¼šé¢ä¸´ç›¸åŒçš„é—®é¢˜å—ï¼Ÿ</p><p>å…¶å®ä¸ä¼šäº†ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>ä¸€æ–¹é¢ï¼ŒPikaåŸºäºRocksDBä¿å­˜äº†æ•°æ®æ–‡ä»¶ï¼Œç›´æ¥è¯»å–æ•°æ®æ–‡ä»¶å°±èƒ½æ¢å¤ï¼Œä¸éœ€è¦å†é€šè¿‡å†…å­˜å¿«ç…§è¿›è¡Œæ¢å¤äº†ã€‚è€Œä¸”ï¼ŒPikaä»åº“åœ¨è¿›è¡Œå…¨é‡åŒæ­¥æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»ä¸»åº“æ‹·è´æ•°æ®æ–‡ä»¶ï¼Œä¸éœ€è¦ä½¿ç”¨å†…å­˜å¿«ç…§ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒPikaå°±é¿å…äº†å¤§å†…å­˜å¿«ç…§ç”Ÿæˆæ•ˆç‡ä½çš„é—®é¢˜ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼ŒPikaä½¿ç”¨äº†binlogæœºåˆ¶å®ç°å¢é‡å‘½ä»¤åŒæ­¥ï¼Œæ—¢èŠ‚çœäº†å†…å­˜ï¼Œè¿˜é¿å…äº†ç¼“å†²åŒºæº¢å‡ºçš„é—®é¢˜ã€‚binlogæ˜¯ä¿å­˜åœ¨SSDä¸Šçš„æ–‡ä»¶ï¼ŒPikaæ¥æ”¶åˆ°å†™å‘½ä»¤åï¼Œåœ¨æŠŠæ•°æ®å†™å…¥Memtableæ—¶ï¼Œä¹Ÿä¼šæŠŠå‘½ä»¤æ“ä½œå†™åˆ°binlogæ–‡ä»¶ä¸­ã€‚å’ŒRedisç±»ä¼¼ï¼Œå½“å…¨é‡åŒæ­¥ç»“æŸåï¼Œä»åº“ä¼šä»binlogä¸­æŠŠå°šæœªåŒæ­¥çš„å‘½ä»¤è¯»å–è¿‡æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å’Œä¸»åº“çš„æ•°æ®ä¿æŒä¸€è‡´ã€‚å½“è¿›è¡Œå¢é‡åŒæ­¥æ—¶ï¼Œä»åº“ä¹Ÿæ˜¯æŠŠè‡ªå·±å·²ç»å¤åˆ¶çš„åç§»é‡å‘ç»™ä¸»åº“ï¼Œä¸»åº“æŠŠå°šæœªåŒæ­¥çš„å‘½ä»¤å‘ç»™ä»åº“ï¼Œæ¥ä¿æŒä¸»ä»åº“çš„æ•°æ®ä¸€è‡´ã€‚</p><p>ä¸è¿‡ï¼Œå’ŒRedisä½¿ç”¨ç¼“å†²åŒºç›¸æ¯”ï¼Œä½¿ç”¨binlogå¥½å¤„æ˜¯éå¸¸æ˜æ˜¾çš„ï¼šbinlogæ˜¯ä¿å­˜åœ¨SSDä¸Šçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸åƒç¼“å†²åŒºï¼Œä¼šå—åˆ°å†…å­˜å®¹é‡çš„è¾ƒå¤šé™åˆ¶ã€‚è€Œä¸”ï¼Œå½“binlogæ–‡ä»¶å¢å¤§åï¼Œè¿˜å¯ä»¥é€šè¿‡è½®æ›¿æ“ä½œï¼Œç”Ÿæˆæ–°çš„binlogæ–‡ä»¶ï¼Œå†æŠŠæ—§çš„binlogæ–‡ä»¶ç‹¬ç«‹ä¿å­˜ã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿Pikaå®ä¾‹ä¿å­˜äº†å¤§é‡çš„æ•°æ®ï¼Œåœ¨åŒæ­¥è¿‡ç¨‹ä¸­ä¹Ÿä¸ä¼šå‡ºç°ç¼“å†²åŒºæº¢å‡ºçš„é—®é¢˜äº†ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆç®€å•å°ç»“ä¸‹ã€‚Pikaä½¿ç”¨RocksDBæŠŠå¤§é‡æ•°æ®ä¿å­˜åˆ°äº†SSDï¼ŒåŒæ—¶é¿å…äº†å†…å­˜å¿«ç…§çš„ç”Ÿæˆå’Œæ¢å¤é—®é¢˜ã€‚è€Œä¸”ï¼ŒPikaä½¿ç”¨binlogæœºåˆ¶è¿›è¡Œä¸»ä»åŒæ­¥ï¼Œé¿å…å¤§å†…å­˜æ—¶çš„å½±å“ï¼ŒPikaçš„ç¬¬ä¸€ä¸ªè®¾è®¡ç›®æ ‡å°±å®ç°äº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹Pikaæ˜¯å¦‚ä½•å®ç°ç¬¬äºŒä¸ªè®¾è®¡ç›®æ ‡çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•å’ŒRediså…¼å®¹ã€‚æ¯•ç«Ÿï¼Œå¦‚æœä¸å…¼å®¹çš„è¯ï¼ŒåŸæ¥ä½¿ç”¨Redisçš„ä¸šåŠ¡å°±æ— æ³•å¹³æ»‘è¿ç§»åˆ°Pikaä¸Šä½¿ç”¨äº†ï¼Œä¹Ÿå°±æ²¡åŠæ³•åˆ©ç”¨Pikaä¿å­˜å¤§å®¹é‡æ•°æ®çš„ä¼˜åŠ¿äº†ã€‚</p><h2>Pikaå¦‚ä½•å®ç°Redisæ•°æ®ç±»å‹å…¼å®¹ï¼Ÿ</h2><p>Pikaçš„åº•å±‚å­˜å‚¨ä½¿ç”¨äº†RocksDBæ¥ä¿å­˜æ•°æ®ï¼Œä½†æ˜¯ï¼ŒRocksDBåªæä¾›äº†å•å€¼çš„é”®å€¼å¯¹ç±»å‹ï¼ŒRocksDBé”®å€¼å¯¹ä¸­çš„å€¼å°±æ˜¯å•ä¸ªå€¼ï¼Œè€ŒRedisé”®å€¼å¯¹ä¸­çš„å€¼è¿˜å¯ä»¥æ˜¯é›†åˆç±»å‹ã€‚</p><p>å¯¹äºRedisçš„Stringç±»å‹æ¥è¯´ï¼Œå®ƒæœ¬èº«å°±æ˜¯å•å€¼çš„é”®å€¼å¯¹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨RocksDBä¿å­˜å°±è¡Œã€‚ä½†æ˜¯ï¼Œå¯¹äºé›†åˆç±»å‹æ¥è¯´ï¼Œæˆ‘ä»¬å°±æ— æ³•ç›´æ¥æŠŠé›†åˆä¿å­˜ä¸ºå•å€¼çš„é”®å€¼å¯¹ï¼Œè€Œæ˜¯éœ€è¦è¿›è¡Œè½¬æ¢æ“ä½œã€‚</p><p>ä¸ºäº†ä¿æŒå’ŒRedisçš„å…¼å®¹æ€§ï¼ŒPikaçš„Nemoæ¨¡å—å°±è´Ÿè´£æŠŠRedisçš„é›†åˆç±»å‹è½¬æ¢æˆå•å€¼çš„é”®å€¼å¯¹ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠRedisçš„é›†åˆç±»å‹åˆ†æˆä¸¤ç±»ï¼š</p><ul>\n<li>ä¸€ç±»æ˜¯Listå’ŒSetç±»å‹ï¼Œå®ƒä»¬çš„é›†åˆä¸­ä¹Ÿåªæœ‰å•å€¼ï¼›</li>\n<li>å¦ä¸€ç±»æ˜¯Hashå’ŒSorted Setç±»å‹ï¼Œå®ƒä»¬çš„é›†åˆä¸­çš„å…ƒç´ æ˜¯æˆå¯¹çš„ï¼Œå…¶ä¸­ï¼ŒHashé›†åˆå…ƒç´ æ˜¯field-valueç±»å‹ï¼Œè€ŒSorted Seté›†åˆå…ƒç´ æ˜¯member-scoreç±»å‹ã€‚</li>\n</ul><p>Nemoæ¨¡å—é€šè¿‡è½¬æ¢æ“ä½œï¼ŒæŠŠè¿™4ç§é›†åˆç±»å‹çš„å…ƒç´ è¡¨ç¤ºä¸ºå•å€¼çš„é”®å€¼å¯¹ã€‚å…·ä½“æ€ä¹ˆè½¬æ¢å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥åˆ†åˆ«çœ‹ä¸‹æ¯ç§ç±»å‹çš„è½¬æ¢ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹Listç±»å‹ã€‚åœ¨Pikaä¸­ï¼ŒListé›†åˆçš„keyè¢«åµŒå…¥åˆ°äº†å•å€¼é”®å€¼å¯¹çš„é”®å½“ä¸­ï¼Œç”¨keyå­—æ®µè¡¨ç¤ºï¼›è€ŒListé›†åˆçš„å…ƒç´ å€¼ï¼Œåˆ™è¢«åµŒå…¥åˆ°å•å€¼é”®å€¼å¯¹çš„å€¼å½“ä¸­ï¼Œç”¨valueå­—æ®µè¡¨ç¤ºã€‚å› ä¸ºListé›†åˆä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥ï¼ŒNemoæ¨¡å—è¿˜åœ¨å•å€¼é”®å€¼å¯¹çš„keyåé¢å¢åŠ äº†sequenceå­—æ®µï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ åœ¨Listä¸­çš„é¡ºåºï¼ŒåŒæ—¶ï¼Œè¿˜åœ¨valueçš„å‰é¢å¢åŠ äº†previous sequenceå’Œnext sequenceè¿™ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ å’Œåä¸€ä¸ªå…ƒç´ ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨å•å€¼é”®å€¼å¯¹çš„keyå‰é¢ï¼ŒNemoæ¨¡å—è¿˜å¢åŠ äº†ä¸€ä¸ªå€¼â€œlâ€ï¼Œè¡¨ç¤ºå½“å‰æ•°æ®æ˜¯Listç±»å‹ï¼Œä»¥åŠå¢åŠ äº†ä¸€ä¸ª1å­—èŠ‚çš„sizeå­—æ®µï¼Œè¡¨ç¤ºListé›†åˆkeyçš„å¤§å°ã€‚åœ¨å•å€¼é”®å€¼å¯¹çš„valueåé¢ï¼ŒNemoæ¨¡å—è¿˜å¢åŠ äº†versionå’Œttlå­—æ®µï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰æ•°æ®çš„ç‰ˆæœ¬å·å’Œå‰©ä½™å­˜æ´»æ—¶é—´ï¼ˆç”¨æ¥æ”¯æŒè¿‡æœŸkeyåŠŸèƒ½ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/06/05/066465f1a28b6f14a42c1fc3a3f73105.jpg?wh=3000*1056\" alt=\"\"></p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹Seté›†åˆã€‚</p><p>Seté›†åˆçš„keyå’Œå…ƒç´ memberå€¼ï¼Œéƒ½è¢«åµŒå…¥åˆ°äº†Pikaå•å€¼é”®å€¼å¯¹çš„é”®å½“ä¸­ï¼Œåˆ†åˆ«ç”¨keyå’Œmemberå­—æ®µè¡¨ç¤ºã€‚åŒæ—¶ï¼Œå’ŒListé›†åˆç±»ä¼¼ï¼Œå•å€¼é”®å€¼å¯¹çš„keyå‰é¢æœ‰å€¼â€œsâ€ï¼Œç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯Setç±»å‹ï¼ŒåŒæ—¶è¿˜æœ‰sizeå­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºkeyçš„å¤§å°ã€‚Pikaå•å€¼é”®å€¼å¯¹çš„å€¼åªä¿å­˜äº†æ•°æ®çš„ç‰ˆæœ¬ä¿¡æ¯å’Œå‰©ä½™å­˜æ´»æ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/aa/71/aa20c1456526dbf3f7d30f9d865f0f71.jpg?wh=2318*936\" alt=\"\"></p><p>å¯¹äºHashç±»å‹æ¥è¯´ï¼ŒHashé›†åˆçš„keyè¢«åµŒå…¥åˆ°å•å€¼é”®å€¼å¯¹çš„é”®å½“ä¸­ï¼Œç”¨keyå­—æ®µè¡¨ç¤ºï¼Œè€ŒHashé›†åˆå…ƒç´ çš„fieldä¹Ÿè¢«åµŒå…¥åˆ°å•å€¼é”®å€¼å¯¹çš„é”®å½“ä¸­ï¼Œç´§æ¥ç€keyå­—æ®µï¼Œç”¨fieldå­—æ®µè¡¨ç¤ºã€‚Hashé›†åˆå…ƒç´ çš„valueåˆ™æ˜¯åµŒå…¥åˆ°å•å€¼é”®å€¼å¯¹çš„å€¼å½“ä¸­ï¼Œå¹¶ä¸”ä¹Ÿå¸¦æœ‰ç‰ˆæœ¬ä¿¡æ¯å’Œå‰©ä½™å­˜æ´»æ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/63/b9/6378f7045393ae342632189a4ab601b9.jpg?wh=2813*851\" alt=\"\"></p><p>æœ€åï¼Œå¯¹äºSorted Setç±»å‹æ¥è¯´ï¼Œè¯¥ç±»å‹æ˜¯éœ€è¦èƒ½å¤ŸæŒ‰ç…§é›†åˆå…ƒç´ çš„scoreå€¼æ’åºçš„ï¼Œè€ŒRocksDBåªæ”¯æŒæŒ‰ç…§å•å€¼é”®å€¼å¯¹çš„é”®æ¥æ’åºã€‚æ‰€ä»¥ï¼ŒNemoæ¨¡å—åœ¨è½¬æ¢æ•°æ®æ—¶ï¼Œå°±æŠŠSorted Seté›†åˆkeyã€å…ƒç´ çš„scoreå’Œmemberå€¼éƒ½åµŒå…¥åˆ°äº†å•å€¼é”®å€¼å¯¹çš„é”®å½“ä¸­ï¼Œæ­¤æ—¶ï¼Œå•å€¼é”®å€¼å¯¹ä¸­çš„å€¼åªä¿å­˜äº†æ•°æ®çš„ç‰ˆæœ¬ä¿¡æ¯å’Œå‰©ä½™å­˜æ´»æ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a0/a8/a0bc4d00a5d95e7fd2699945ff7a56a8.jpg?wh=3000*940\" alt=\"\"></p><p>é‡‡ç”¨äº†ä¸Šé¢çš„è½¬æ¢æ–¹å¼ä¹‹åï¼ŒPikaä¸ä»…èƒ½å…¼å®¹æ”¯æŒRedisçš„æ•°æ®ç±»å‹ï¼Œè€Œä¸”è¿˜ä¿ç•™äº†è¿™äº›æ•°æ®ç±»å‹çš„ç‰¹å¾ï¼Œä¾‹å¦‚Listçš„å…ƒç´ ä¿åºã€Sorted Setçš„å…ƒç´ æŒ‰scoreæ’åºã€‚äº†è§£äº†Pikaçš„è½¬æ¢æœºåˆ¶åï¼Œä½ å°±ä¼šæ˜ç™½ï¼Œå¦‚æœä½ æœ‰ä¸šåŠ¡åº”ç”¨è®¡åˆ’ä»ä½¿ç”¨Redisåˆ‡æ¢åˆ°ä½¿ç”¨Pikaï¼Œå°±ä¸ç”¨æ‹…å¿ƒé¢ä¸´å› ä¸ºæ“ä½œæ¥å£ä¸å…¼å®¹è€Œè¦ä¿®æ”¹ä¸šåŠ¡åº”ç”¨çš„é—®é¢˜äº†ã€‚</p><p>ç»è¿‡åˆšåˆšçš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒPikaèƒ½å¤ŸåŸºäºSSDä¿å­˜å¤§å®¹é‡æ•°æ®ï¼Œè€Œä¸”å’ŒRediså…¼å®¹ï¼Œè¿™æ˜¯å®ƒçš„ä¸¤ä¸ªä¼˜åŠ¿ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œè·ŸRedisç›¸æ¯”ï¼ŒPikaçš„å…¶ä»–ä¼˜åŠ¿ï¼Œä»¥åŠæ½œåœ¨çš„ä¸è¶³ã€‚å½“åœ¨å®é™…åº”ç”¨Pikaæ—¶ï¼ŒPikaçš„ä¸è¶³ä¹‹å¤„æ˜¯ä½ éœ€è¦ç‰¹åˆ«æ³¨æ„çš„åœ°æ–¹ï¼Œè¿™äº›å¯èƒ½éƒ½éœ€è¦ä½ è¿›è¡Œç³»ç»Ÿé…ç½®æˆ–å‚æ•°ä¸Šçš„è°ƒä¼˜ã€‚</p><h2>Pikaçš„å…¶ä»–ä¼˜åŠ¿ä¸ä¸è¶³</h2><p>è·ŸRedisç›¸æ¯”ï¼ŒPikaæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯ä½¿ç”¨äº†SSDæ¥ä¿å­˜æ•°æ®ï¼Œè¿™ä¸ªç‰¹ç‚¹èƒ½å¸¦æ¥çš„æœ€ç›´æ¥å¥½å¤„å°±æ˜¯ï¼ŒPikaå•å®ä¾‹èƒ½ä¿å­˜æ›´å¤šçš„æ•°æ®äº†ï¼Œå®ç°äº†å®ä¾‹æ•°æ®æ‰©å®¹ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒPikaä½¿ç”¨SSDæ¥ä¿å­˜æ•°æ®ï¼Œè¿˜æœ‰é¢å¤–çš„ä¸¤ä¸ªä¼˜åŠ¿ã€‚</p><p>é¦–å…ˆï¼Œ<strong>å®ä¾‹é‡å¯å¿«</strong>ã€‚Pikaçš„æ•°æ®åœ¨å†™å…¥æ•°æ®åº“æ—¶ï¼Œæ˜¯ä¼šä¿å­˜åˆ°SSDä¸Šçš„ã€‚å½“Pikaå®ä¾‹é‡å¯æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»SSDä¸Šçš„æ•°æ®æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œä¸éœ€è¦åƒRedisä¸€æ ·ï¼Œä»RDBæ–‡ä»¶å…¨éƒ¨é‡æ–°åŠ è½½æ•°æ®æˆ–æ˜¯ä»AOFæ–‡ä»¶ä¸­å…¨éƒ¨å›æ”¾æ“ä½œï¼Œè¿™æå¤§åœ°æé«˜äº†Pikaå®ä¾‹çš„é‡å¯é€Ÿåº¦ï¼Œå¯ä»¥å¿«é€Ÿå¤„ç†ä¸šåŠ¡åº”ç”¨è¯·æ±‚ã€‚</p><p>å¦å¤–ï¼Œä¸»ä»åº“é‡æ–°æ‰§è¡Œå…¨é‡åŒæ­¥çš„é£é™©ä½ã€‚Pikaé€šè¿‡binlogæœºåˆ¶å®ç°å†™å‘½ä»¤çš„å¢é‡åŒæ­¥ï¼Œä¸å†å—å†…å­˜ç¼“å†²åŒºå¤§å°çš„é™åˆ¶ï¼Œæ‰€ä»¥ï¼Œå³ä½¿åœ¨æ•°æ®é‡å¾ˆå¤§å¯¼è‡´ä¸»ä»åº“åŒæ­¥è€—æ—¶å¾ˆé•¿çš„æƒ…å†µä¸‹ï¼ŒPikaä¹Ÿä¸ç”¨æ‹…å¿ƒç¼“å†²åŒºæº¢å‡ºè€Œè§¦å‘çš„ä¸»ä»åº“é‡æ–°å…¨é‡åŒæ­¥ã€‚</p><p>ä½†æ˜¯ï¼Œå°±åƒæˆ‘åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­å’Œä½ è¯´çš„ï¼Œâ€œç¡¬å¸éƒ½æ˜¯æœ‰æ­£åä¸¤é¢çš„â€ï¼ŒPikaä¹Ÿæœ‰è‡ªèº«çš„ä¸€äº›ä¸è¶³ã€‚</p><p>è™½ç„¶å®ƒä¿æŒäº†Redisæ“ä½œæ¥å£ï¼Œä¹Ÿèƒ½å®ç°æ•°æ®åº“æ‰©å®¹ï¼Œä½†æ˜¯ï¼Œå½“æŠŠæ•°æ®ä¿å­˜åˆ°SSDä¸Šåï¼Œä¼šé™ä½æ•°æ®çš„è®¿é—®æ€§èƒ½ã€‚è¿™æ˜¯å› ä¸ºï¼Œæ•°æ®æ“ä½œæ¯•ç«Ÿä¸èƒ½åœ¨å†…å­˜ä¸­ç›´æ¥æ‰§è¡Œäº†ï¼Œè€Œæ˜¯è¦åœ¨åº•å±‚çš„SSDä¸­è¿›è¡Œå­˜å–ï¼Œè¿™è‚¯å®šä¼šå½±å“ï¼ŒPikaçš„æ€§èƒ½ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠbinlogæœºåˆ¶è®°å½•çš„å†™å‘½ä»¤åŒæ­¥åˆ°SSDä¸Šï¼Œè¿™ä¼šé™ä½Pikaçš„å†™æ€§èƒ½ã€‚</p><p>ä¸è¿‡ï¼ŒPikaçš„å¤šçº¿ç¨‹æ¨¡å‹ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡Œæ•°æ®è¯»å†™ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†ä»SSDå­˜å–æ•°æ®é€ æˆçš„æ€§èƒ½æŸå¤±ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é«˜é…çš„SSDæ¥æå‡è®¿é—®æ€§èƒ½ï¼Œè¿›è€Œå‡å°‘è¯»å†™SSDå¯¹Pikaæ€§èƒ½çš„å½±å“ã€‚</p><p>ä¸ºäº†å¸®åŠ©ä½ æ›´ç›´è§‚åœ°äº†è§£Pikaçš„æ€§èƒ½æƒ…å†µï¼Œæˆ‘å†ç»™ä½ æä¾›ä¸€å¼ è¡¨ï¼Œè¿™æ˜¯Pika<a href=\"https://github.com/Qihoo360/pika/wiki/3.2.x-Performance\">å®˜ç½‘</a>ä¸Šæä¾›çš„æµ‹è¯•æ•°æ®ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/c5/6fed4a269a79325efd6fa4fb17fc44c5.jpg?wh=1456*716\" alt=\"\"></p><p>è¿™äº›æ•°æ®æ˜¯åœ¨Pika 3.2ç‰ˆæœ¬ä¸­ï¼ŒStringå’ŒHashç±»å‹åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹çš„åŸºæœ¬æ“ä½œæ€§èƒ½ç»“æœã€‚ä»è¡¨ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸å†™binlogæ—¶ï¼ŒPikaçš„SET/GETã€HSET/HGETçš„æ€§èƒ½éƒ½èƒ½è¾¾åˆ°200K OPSä»¥ä¸Šï¼Œè€Œä¸€æ—¦å¢åŠ äº†å†™binlogæ“ä½œï¼ŒSETå’ŒHSETæ“ä½œæ€§èƒ½å¤§çº¦ä¸‹é™äº†41%ï¼Œåªæœ‰çº¦120K OPSã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨Pikaæ—¶ï¼Œéœ€è¦åœ¨å•å®ä¾‹æ‰©å®¹çš„å¿…è¦æ€§å’Œå¯èƒ½çš„æ€§èƒ½æŸå¤±é—´åšä¸ªæƒè¡¡ã€‚å¦‚æœä¿å­˜å¤§å®¹é‡æ•°æ®æ˜¯æˆ‘ä»¬çš„é¦–è¦éœ€æ±‚ï¼Œé‚£ä¹ˆï¼ŒPikaæ˜¯ä¸€ä¸ªä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†åŸºäºSSDç»™Rediså•å®ä¾‹è¿›è¡Œæ‰©å®¹çš„æŠ€æœ¯æ–¹æ¡ˆPikaã€‚è·ŸRedisç›¸æ¯”ï¼ŒPikaçš„å¥½å¤„éå¸¸æ˜æ˜¾ï¼šæ—¢æ”¯æŒRedisæ“ä½œæ¥å£ï¼Œåˆèƒ½æ”¯æŒä¿å­˜å¤§å®¹é‡çš„æ•°æ®ã€‚å¦‚æœä½ åŸæ¥å°±åœ¨åº”ç”¨Redisï¼Œç°åœ¨æƒ³è¿›è¡Œæ‰©å®¹ï¼Œé‚£ä¹ˆï¼ŒPikaæ— ç–‘æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œæ— è®ºæ˜¯ä»£ç è¿ç§»è¿˜æ˜¯è¿ç»´ç®¡ç†ï¼ŒPikaåŸºæœ¬ä¸éœ€è¦é¢å¤–çš„å·¥ä½œé‡ã€‚</p><p>ä¸è¿‡ï¼ŒPikaæ¯•ç«Ÿæ˜¯æŠŠæ•°æ®ä¿å­˜åˆ°äº†SSDä¸Šï¼Œæ•°æ®è®¿é—®è¦è¯»å†™SSDï¼Œæ‰€ä»¥ï¼Œè¯»å†™æ€§èƒ½è¦å¼±äºRedisã€‚é’ˆå¯¹è¿™ä¸€ç‚¹ï¼Œæˆ‘ç»™ä½ æä¾›ä¸¤ä¸ªé™ä½è¯»å†™SSDå¯¹Pikaçš„æ€§èƒ½å½±å“çš„å°å»ºè®®ï¼š</p><ol>\n<li>åˆ©ç”¨Pikaçš„å¤šçº¿ç¨‹æ¨¡å‹ï¼Œå¢åŠ çº¿ç¨‹æ•°é‡ï¼Œæå‡Pikaçš„å¹¶å‘è¯·æ±‚å¤„ç†èƒ½åŠ›ï¼›</li>\n<li>ä¸ºPikaé…ç½®é«˜é…çš„SSDï¼Œæå‡SSDè‡ªèº«çš„è®¿é—®æ€§èƒ½ã€‚</li>\n</ol><p>æœ€åï¼Œæˆ‘æƒ³å†ç»™ä½ ä¸€ä¸ªå°æç¤ºã€‚Pikaæœ¬èº«æä¾›äº†å¾ˆå¤šå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠRedisæ•°æ®è¿ç§»åˆ°Pikaï¼Œæˆ–è€…æ˜¯æŠŠRedisè¯·æ±‚è½¬å‘ç»™Pikaã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨aof_to_pikaå‘½ä»¤ï¼Œå¹¶ä¸”æŒ‡å®šRedisçš„AOFæ–‡ä»¶ä»¥åŠPikaçš„è¿æ¥ä¿¡æ¯ï¼Œå°±å¯ä»¥æŠŠRedisæ•°æ®è¿ç§»åˆ°Pikaä¸­äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>aof_to_pika -i [Redis AOFæ–‡ä»¶] -h [Pika IP] -p [Pika port] -a [è®¤è¯ä¿¡æ¯]\n</code></pre><p>å…³äºè¿™äº›å·¥å…·çš„ä¿¡æ¯ï¼Œä½ éƒ½å¯ä»¥ç›´æ¥åœ¨Pikaçš„<a href=\"https://github.com/Qihoo360/pika/wiki\">GitHub</a>ä¸Šæ‰¾åˆ°ã€‚è€Œä¸”ï¼ŒPikaæœ¬èº«ä¹Ÿè¿˜åœ¨è¿­ä»£å¼€å‘ä¸­ï¼Œæˆ‘ä¹Ÿå»ºè®®ä½ å¤šå»çœ‹çœ‹GitHubï¼Œè¿›ä¸€æ­¥åœ°äº†è§£å®ƒã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥è·å¾—Pikaçš„æœ€æ–°è¿›å±•ï¼Œä¹Ÿèƒ½æ›´å¥½åœ°æŠŠå®ƒåº”ç”¨åˆ°ä½ çš„ä¸šåŠ¡å®è·µä¸­ã€‚</p><h2>æ¯è¯¾ä¸€é—®</h2><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ç»™ä½ æä¸ªå°é—®é¢˜ã€‚è¿™èŠ‚è¯¾ï¼Œæˆ‘å‘ä½ ä»‹ç»çš„æ˜¯ä½¿ç”¨SSDä½œä¸ºå†…å­˜å®¹é‡çš„æ‰©å±•ï¼Œå¢åŠ Rediså®ä¾‹çš„æ•°æ®ä¿å­˜é‡ï¼Œæˆ‘æƒ³è¯·ä½ æ¥èŠä¸€èŠï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœºæ¢°ç¡¬ç›˜æ¥ä½œä¸ºå®ä¾‹å®¹é‡æ‰©å±•å—ï¼Œæœ‰ä»€ä¹ˆå¥½å¤„æˆ–ä¸è¶³å—ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå†™ä¸‹ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸€èµ·äº¤æµè®¨è®ºã€‚å¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","comments":[{"had_liked":false,"id":254924,"user_name":"Kaito","can_delete":false,"product_type":"c1","uid":1020042,"ip_address":"","ucode":"79775FA35A95F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","comment_is_top":false,"comment_ctime":1603215633,"is_pvip":true,"discussion_count":6,"race_medal":0,"score":"431099945233","product_id":100056701,"comment_content":"æ˜¯å¦å¯ä»¥ä½¿ç”¨æœºæ¢°ç¡¬ç›˜ä½œä¸ºRedisçš„å†…å­˜å®¹é‡çš„æ‰©å±•ï¼Ÿ<br><br>æˆ‘è§‰å¾—ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æœºæ¢°ç¡¬ç›˜ç›¸è¾ƒäºå›ºæ€ç¡¬ç›˜çš„ä¼˜ç‚¹æ˜¯ï¼Œæˆæœ¬æ›´ä½ã€å®¹é‡æ›´å¤§ã€å¯¿å‘½æ›´é•¿ã€‚<br><br>1ã€æˆæœ¬ï¼šæœºæ¢°ç¡¬ç›˜æ˜¯ç”µç£å­˜å‚¨ï¼Œå›ºæ€ç¡¬ç›˜æ˜¯åŠå¯¼ä½“ç”µå®¹é¢—ç²’ç»„æˆï¼Œç›¸åŒå®¹é‡ä¸‹æœºæ¢°ç¡¬ç›˜æˆæœ¬æ˜¯å›ºæ€ç¡¬ç›˜çš„1&#47;3ã€‚<br>2ã€å®¹é‡ï¼šç›¸åŒæˆæœ¬ä¸‹ï¼Œæœºæ¢°ç¡¬ç›˜å¯ä½¿ç”¨çš„å®¹é‡æ›´å¤§ã€‚<br>3ã€å¯¿å‘½ï¼šå›ºæ€ç¡¬ç›˜çš„ç”µå®¹é¢—ç²’æ“¦å†™æ¬¡æ•°æœ‰é™ï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°åä¼šä¸å¯ç”¨ã€‚ç›¸åŒopsæƒ…å†µä¸‹ï¼Œæœºæ¢°ç¡¬ç›˜çš„å¯¿å‘½è¦æ¯”å›ºæ€ç¡¬ç›˜çš„å¯¿å‘½æ›´é•¿ã€‚<br><br>ä½†æœºæ¢°ç¡¬ç›˜ç›¸è¾ƒäºå›ºæ€ç¡¬ç›˜çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯é€Ÿåº¦æ…¢ã€‚<br><br>æœºæ¢°ç¡¬ç›˜åœ¨è¯»å†™æ•°æ®æ—¶ï¼Œéœ€è¦é€šè¿‡è½¬åŠ¨ç£ç›˜å’Œç£å¤´ç­‰æœºæ¢°æ–¹å¼å®Œæˆï¼Œè€Œå›ºæ€ç¡¬ç›˜æ˜¯ç›´æ¥é€šè¿‡ç”µä¿¡å·ä¿å­˜å’Œæ§åˆ¶æ•°æ®çš„è¯»å†™ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚<br><br>å¦‚æœå¯¹äºè®¿é—®å»¶è¿Ÿè¦æ±‚ä¸é«˜ï¼Œå¯¹å®¹é‡å’Œæˆæœ¬æ¯”è¾ƒå…³æ³¨çš„åœºæ™¯ï¼Œå¯ä»¥æŠŠPikaéƒ¨ç½²åœ¨æœºæ¢°ç¡¬ç›˜ä¸Šä½¿ç”¨ã€‚<br><br>å¦å¤–ï¼Œå…³äºPikaçš„ä½¿ç”¨åœºæ™¯ï¼Œå®ƒå¹¶ä¸èƒ½ä»£æ›¿Redisï¼Œè€Œæ˜¯ä½œä¸ºRedisçš„è¡¥å……ï¼Œåœ¨éœ€è¦å¤§å®¹é‡å­˜å‚¨ï¼ˆ50Gæ•°æ®é‡ä»¥ä¸Šï¼‰ã€è®¿é—®å»¶è¿Ÿè¦æ±‚ä¸è‹›åˆ»çš„ä¸šåŠ¡åœºæ™¯ä¸‹ä½¿ç”¨ã€‚åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæœ€å¥½æ˜¯æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æƒ…å†µï¼Œå…ˆåšå¥½è°ƒç ”å’Œæ€§èƒ½æµ‹è¯•ï¼Œè¯„ä¼°åå†³å®šæ˜¯å¦ä½¿ç”¨ã€‚","like_count":101,"discussions":[{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337868,"discussion_content":"æ¯•ç«Ÿå¦å¤–ä¸€ä¸ªå†…å­˜æ•°æ®åº“memcacheä¹Ÿæ˜¯å¤šçº¿ç¨‹çš„ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ€§èƒ½ä¾æ—§ä¸å¦‚redisã€‚æœ€å¤§çš„é—®é¢˜å°±æ˜¯å¤šçº¿ç¨‹æ“ä½œä¸‹å¯¹æ¯ä¸ªkeyåŠ äº† é”ï¼Œæ— è®ºè½»é‡ï¼Œåœ¨æé«˜å¹¶å‘ä¸‹ï¼Œéƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¯¹é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œé”ä¼šæå¤§çš„é™ä½æ€§èƒ½ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1609113959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378290,"discussion_content":"å¯ä»¥ä½œä¸ºä¸€ç§é€‰é¡¹ ä½†ä¸æ˜¯é¦–é€‰ã€‚å› ä¸ºredisæ˜¾ç„¶æ˜¯å¯¹qpsæœ‰è¦æ±‚çš„ å¦‚æœå †åˆ°æœºæ¢°ç¡¬ç›˜ é‚£å’Œå¼€å¯swapå°±æ²¡æœ‰æœ¬è´¨åŒºåˆ«","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1623152009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1296635,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/fb/1e282c37.jpg","nickname":"Jungggle","note":"","ucode":"CEF098BDED51BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575583,"discussion_content":"åˆå›å»äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1654938111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2001423,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/8a/0f/f075fb01.jpg","nickname":"æ¨å‰‘é”‹","note":"","ucode":"128808BB976ADD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352534,"discussion_content":"æœºæ¢°çš„å¯»é“æ—¶é—´å¤ªåè¡€äº†ï¼Œè€Œä¸”ç°åœ¨å¤§å®¹é‡ssdä¹Ÿä¸€ç›´åœ¨é™ä»·ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614765003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337866,"discussion_content":"1ï¼‰ã€æœºæ¢°ç¡¬ç›˜è¦å°½é‡è½¬æ¢ä¸º é¡ºæ¬¡è¯»å†™è¿™æ ·æ€§èƒ½ä¼šæ¯”çº¯éšæœºè¯»å†™å¿«å¾ˆå¤šã€‚\n2ï¼‰ã€ä½†æ˜¯æ€§èƒ½ä¾æ—§ä¸å¦‚ssdã€‚è¦è€ƒè™‘æˆæœ¬å¯¿å‘½ç­‰å› ç´ å‡è¡¡\n3ï¼‰ã€æˆ‘è®¤ä¸ºpikaçš„å¤šçº¿ç¨‹æ¨¡å¼ï¼Œæ ¸å¿ƒå¦‚ä½•è§£å†³å¤šçº¿ç¨‹æ¨¡å¼ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œè¿™ç‚¹åŒºåˆ«äºredisåç»­çš„å¤šçº¿ç¨‹ï¼Œè¯»å†™æ“ä½œä¾æ—§æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609113566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2934665,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","nickname":"æå®¢é…±é…±","note":"","ucode":"18CDC1DB754D58","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567211,"discussion_content":"è¯¾ä»£è¡¨è¦ä¸ä¹Ÿå‡ºä¸ªä¸“æ ï¼Œç»™å¤§å®¶åˆ†äº«åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650858286,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256640,"user_name":"Roy Liang","can_delete":false,"product_type":"c1","uid":1098898,"ip_address":"","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1603694682,"is_pvip":false,"replies":[{"id":"98029","content":"è¿™ä¸ªæ–¹æ¡ˆæ˜¯å¯è¡Œçš„ï¼Œç›¸å½“äºå†·çƒ­åˆ†å±‚å­˜å‚¨äº†ï¼Œè€Œä¸”Pikaå’ŒRedisçš„æ•°æ®æ¨¡å‹å…¼å®¹ï¼Œæ‰€ä»¥æ•°æ®è¿ç§»èµ·æ¥ä¼šæ¯”è¾ƒæ–¹ä¾¿ç›´æ¥ã€‚<br><br>æˆ‘æƒ³åˆ°çš„å…³é”®æŠ€æœ¯é—®é¢˜ï¼š1. æ•°æ®å†·çƒ­çš„åŒºåˆ†æ–¹æ³•ï¼Œè¿™æœ‰ç‚¹ç±»ä¼¼äºç¼“å­˜ç®—æ³•ï¼ŒæŠŠç»å¸¸è®¿é—®çš„æ•°æ®è¦èƒ½å¤Ÿç­›é€‰å‡ºæ¥ï¼›2. æ•°æ®çš„è¿ç§»å¼€é”€ï¼Œæ•°æ®è¿ç§»æ—¶éœ€è¦é¿å…å¯¹Rediså‰ç«¯è¯»å†™è¯·æ±‚çš„é˜»å¡ï¼Œå¼€å‘è¿™ä¸ªç³»ç»Ÿæ—¶å¯èƒ½è¦è€ƒè™‘ä½¿ç”¨é¢å¤–çº¿ç¨‹æ¥è¿ç§»Redisæ•°æ®ï¼›3. æ•°æ®è¿ç§»æ—¶æ•°æ®è¯»å†™æ­£ç¡®æ€§çš„ä¿è¯ï¼Œä¾‹å¦‚æ•°æ®æ­£åœ¨è¿ç§»ï¼Œæ˜¯å¦è¿˜èƒ½æ­£å¸¸è¯»å†™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1609085749,"ip_address":"","comment_id":256640,"utype":1}],"discussion_count":3,"race_medal":0,"score":"113272844378","product_id":100056701,"comment_content":"SSDä½¿ç”¨å¯¿å‘½å’Œæ“¦å†™æ¬¡æ•°ç›¸å…³ï¼Œæˆ‘ä»¬æœ‰çš„ä¸šåŠ¡æ•°æ®é‡å’Œè®¿é—®é‡ç‰¹åˆ«å¤§ï¼Œä½¿ç”¨SSDä¸€å¹´å°±å¾—æ¢äº†ï¼Œè¿™æ ·å®é™…æˆæœ¬é™ä¸ä¸‹æ¥ã€‚æ‰€ä»¥ï¼Œè¯·é—®æœ‰æ²¡æœ‰å¯èƒ½å¼€å‘ä¸€å¥—æ··åˆå­˜å‚¨ç³»ç»Ÿï¼Œçƒ­æ•°æ®å­˜å‚¨è€Œä¸æ˜¯ç¼“å­˜åœ¨Redisï¼Œå†·æ•°æ®å­˜å‚¨åœ¨Pikaï¼ŒRedisä¸­çš„çƒ­æ•°æ®æ·˜æ±°æ—¶ï¼Œè‡ªåŠ¨å†™å…¥Pikaï¼ŒPikaçš„å†·æ•°æ®åŠ è½½æ—¶ï¼Œè‡ªåŠ¨å†™å…¥Redisï¼Œè¿™æ ·ä¸šåŠ¡ä»£ç å‡ ä¹å°±ä¸ç”¨åšæ•°æ®ä¸€è‡´æ€§ç»´æŠ¤ç›¸å…³çš„å†…å®¹ã€‚ä¸çŸ¥é“è¿™ä¸ªç³»ç»Ÿæ˜¯å¦å­˜åœ¨å¯è¡Œæ€§ï¼Ÿå…¶ä¸­çš„æŠ€æœ¯é£é™©å¯èƒ½åœ¨å“ªé‡Œï¼Ÿ","like_count":26,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508071,"discussion_content":"è¿™ä¸ªæ–¹æ¡ˆæ˜¯å¯è¡Œçš„ï¼Œç›¸å½“äºå†·çƒ­åˆ†å±‚å­˜å‚¨äº†ï¼Œè€Œä¸”Pikaå’ŒRedisçš„æ•°æ®æ¨¡å‹å…¼å®¹ï¼Œæ‰€ä»¥æ•°æ®è¿ç§»èµ·æ¥ä¼šæ¯”è¾ƒæ–¹ä¾¿ç›´æ¥ã€‚\n\næˆ‘æƒ³åˆ°çš„å…³é”®æŠ€æœ¯é—®é¢˜ï¼š1. æ•°æ®å†·çƒ­çš„åŒºåˆ†æ–¹æ³•ï¼Œè¿™æœ‰ç‚¹ç±»ä¼¼äºç¼“å­˜ç®—æ³•ï¼ŒæŠŠç»å¸¸è®¿é—®çš„æ•°æ®è¦èƒ½å¤Ÿç­›é€‰å‡ºæ¥ï¼›2. æ•°æ®çš„è¿ç§»å¼€é”€ï¼Œæ•°æ®è¿ç§»æ—¶éœ€è¦é¿å…å¯¹Rediså‰ç«¯è¯»å†™è¯·æ±‚çš„é˜»å¡ï¼Œå¼€å‘è¿™ä¸ªç³»ç»Ÿæ—¶å¯èƒ½è¦è€ƒè™‘ä½¿ç”¨é¢å¤–çº¿ç¨‹æ¥è¿ç§»Redisæ•°æ®ï¼›3. æ•°æ®è¿ç§»æ—¶æ•°æ®è¯»å†™æ­£ç¡®æ€§çš„ä¿è¯ï¼Œä¾‹å¦‚æ•°æ®æ­£åœ¨è¿ç§»ï¼Œæ˜¯å¦è¿˜èƒ½æ­£å¸¸è¯»å†™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609085749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1609530,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/l4nngwyggBGqeMXC0micwO8bM1hSttgQXa1Y5frJSqWa8NibDhia5icwPcHM5wOpV3hfsf0UicDY0ypFqnQ3iarG0T1w/132","nickname":"Trident","note":"","ucode":"53E6788CF33398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375256,"discussion_content":"æœ‰ç‚¹ç±»ä¼¼esçš„å†·çƒ­åˆ†åŒºå­˜å‚¨ï¼Œä½†æ˜¯å†·çƒ­æ•°æ®ä¸å¤ªå¥½åŒºåˆ†ï¼Œæ¶‰åŠåˆ°æ•°æ®è¿ç§»ä¹Ÿæ˜¯ä¸€ä»¶éº»çƒ¦äº‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621556109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1474954,"avatar":"https://static001.geekbang.org/account/avatar/00/16/81/8a/15a96a64.jpg","nickname":"Gatsby","note":"","ucode":"5DBFDA12556BDB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349342,"discussion_content":"å¾®åšçš„RedRocksæ˜¯åšåˆ°äº†çš„å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613111737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279338,"user_name":"neohope","can_delete":false,"product_type":"c1","uid":1043475,"ip_address":"","ucode":"C0268F6E7E2B6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg","comment_is_top":false,"comment_ctime":1613724715,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"70333201451","product_id":100056701,"comment_content":"ç”¨æœºæ¢°ç¡¬ç›˜é˜µåˆ—æ¥åšç¼“å­˜ï¼Œå…¶å®æ²¡æœ‰å¿…è¦ï¼Œé€Ÿåº¦å¤ªæ…¢äº†ï¼š<br>1ã€ç”¨redisæ¥åšç¼“å­˜ï¼Œå°±æ˜¯å› ä¸ºmysqlæ…¢ï¼Œæ‰€ä»¥åŠ äº†ä¸€å±‚<br>2ã€redisæ¯”mysqlå¿«çš„æœ€æ ¹æœ¬åŸå› ï¼Œä¸æ˜¯redisæŠ€æœ¯å¼ºæ‚ï¼Œè€Œæ˜¯å†…å­˜æ¯”ç£ç›˜å¿«<br>3ã€mysqlæœ¬èº«å°±æ˜¯æŠŠçƒ­æ•°æ®æ”¾åˆ°å†…å­˜é‡Œï¼Œå†·æ•°æ®å­˜åˆ°ç£ç›˜é˜µåˆ—ä¸Šï¼Œå¹¶ä¸”åšäº†å¾ˆå¤šæ•°æ®æŸ¥æ‰¾çš„ä¼˜åŒ–<br>4ã€pikaåˆ©ç”¨çš„æ˜¯SSDæ¯”ç£ç›˜å¿«ï¼Œæ¯”å†…å­˜ä¾¿å®œï¼Œæ‰æ‰¾åˆ°äº†è‡ªå·±çš„ç”Ÿå­˜ç©ºé—´ï¼Œå…¶æ ¹æœ¬åŸå› ä¹Ÿä¸æ˜¯RocksDBæŠ€æœ¯å…ˆè¿›ï¼›<br>5ã€Pikaçš„ç”¨ç£ç›˜åšç¼“å­˜ï¼Œä»ç£ç›˜ä¸ŠæŸ¥æ‰¾è®°å½•ï¼Œæ¯”mysqlä¹Ÿå¿«ä¸äº†å¤ªå¤šï¼Œè§£å†³ä¸äº†ä»€ä¹ˆé—®é¢˜ï¼Œè€Œä¸”è¿˜å¼•å…¥äº†æ–°çš„æ•…éšœç‚¹ï¼Œæ²¡æœ‰å¤ªå¤šä»·å€¼<br>","like_count":17,"discussions":[{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577974,"discussion_content":"ä½ è¯´çš„è¿™äº›æ ¹æœ¬åŸå› å¤§å­¦ç”Ÿéƒ½çŸ¥é“, å…³é”®æ˜¯å¦‚ä½•åˆ©ç”¨è¿™äº›ç‰¹æ€§æ¥è®¾è®¡ç¨‹åº, åšå–èˆ, å–é•¿è¡¥çŸ­, å‘æŒ¥å‡ºæœ€å¤§çš„ä¼˜åŠ¿, æœ€ç»ˆèƒ½è¢«éƒ¨åˆ†ç”šè‡³å°‘æ•°ä¸šåŠ¡æ‰€é’ç.  è€Œä¸æ˜¯ä½ åœ¨è¿™ä¸€å¥&#34;æ ¹æœ¬åŸå› &#34;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1656438045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261662,"user_name":"å­”ç¥¥é‘«","can_delete":false,"product_type":"c1","uid":1089732,"ip_address":"","ucode":"121EC48A798034","user_header":"https://static001.geekbang.org/account/avatar/00/10/a0/c4/4ab49f4e.jpg","comment_is_top":false,"comment_ctime":1605485966,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"35965224334","product_id":100056701,"comment_content":"æœ‰ä¸ªåœ°æ–¹æ²¡ææ˜ç™½ï¼Œè¯»ssdä¸Šçš„æ•°æ®æ–‡ä»¶ï¼Œå’Œredisè¯»rdbæ–‡ä»¶ç›¸æ¯”ï¼Œä¸¤è€…éƒ½æ˜¯æ–‡ä»¶ï¼Œä¸ºä»€ä¹ˆä¼šæ¯”rediså¿«å‘¢","like_count":8,"discussions":[{"author":{"id":1801058,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/7b/62/ec94cee4.jpg","nickname":"å½­æ–‡è¾¾","note":"","ucode":"8DCC27EC5AF263","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395884,"discussion_content":"redisæ˜¯æŠŠrdbå…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œéœ€è¦æ•°æ®åœ¨å†…å­˜æ‰èƒ½æä¾›è¯·æ±‚ï¼Œpikaæ˜¯éœ€è¦ç”¨åˆ°æ•°æ®çš„æ—¶å€™æ‰ä¼šéƒ¨åˆ†åŠ è½½åˆ°å†…å­˜ï¼Œæ¢å¤å°±ç›´æ¥æŠŠæ–‡ä»¶æ¢å¤å°±å¥½äº†ï¼Œå°±æ¯”å¦‚æ–‡ä»¶ç§»åŠ¨åˆ°å›æ”¶ç«™ï¼Œåªéœ€è¦æ¢å¤åˆ°åŸæ¥çš„åœ°æ–¹å°±å¥½ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1632360639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1013669,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/77/a5/c5ae871d.jpg","nickname":"zenk","note":"","ucode":"B235D5EBCF49BC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331093,"discussion_content":"rdbéƒ½è¦è¯»åˆ°å†…å­˜ï¼Œpikaä¸ä¼šå…¨è¯»ï¼ˆç»†èŠ‚ä¸çŸ¥é“ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606786232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1495305,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d1/09/4727cc96.jpg","nickname":"å¾å¿—ä¼Ÿ","note":"","ucode":"CEFE85BADBDEDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1013669,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/77/a5/c5ae871d.jpg","nickname":"zenk","note":"","ucode":"B235D5EBCF49BC","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":335340,"discussion_content":"åœ¨rediså¯åŠ¨çš„æ—¶å€™éœ€è¦æŠŠrdbä¸­æ•°æ®è¯»åˆ°å†…å­˜ç„¶åredisæ‰èƒ½æä¾›æœåŠ¡ï¼Œpikaæ˜¯ä¸éœ€è¦æŠŠæ•°æ®è¯»å–åˆ°å†…å­˜å°±å¯ä»¥æä¾›æœåŠ¡çš„ï¼Œå®ƒçš„æŸ¥è¯¢ä¸»è¦æ˜¯åŸºäºç£ç›˜çš„","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1608170414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":331093,"ip_address":""},"score":335340,"extra":""},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1495305,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d1/09/4727cc96.jpg","nickname":"å¾å¿—ä¼Ÿ","note":"","ucode":"CEFE85BADBDEDB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337869,"discussion_content":"æ¢å¤å¿«ï¼Œä½†æ˜¯æ€§èƒ½ä¾æ—§æ˜¯å¼±ä¸€äº›ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609114024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335340,"ip_address":""},"score":337869,"extra":""}]}]},{"had_liked":false,"id":255271,"user_name":"Geek_9a0c9f","can_delete":false,"product_type":"c1","uid":2159835,"ip_address":"","ucode":"2A6078F740881F","user_header":"","comment_is_top":false,"comment_ctime":1603292447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27373096223","product_id":100056701,"comment_content":"pikaä»æ€§èƒ½ä¸Šæ¯”å½“ç„¶ä¸ç„¶redis,ä½†æ˜¯å®ƒä½ è¡¥äº†rediså‡ ä¸ªä¸è¶³ï¼Œé‚£ä¹ˆpikaåœ¨çœŸæ˜¯é¡¹ç›®ä¸­éƒ½åº”ç”¨åœ¨ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿï¼Œä¸ssdçš„mysqlæ¯”ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Ÿé™¤äº†o(1)çš„æ“ä½œã€‚","like_count":6},{"had_liked":false,"id":260808,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1605111086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23079947566","product_id":100056701,"comment_content":"æœºæ¢°ç¡¬ç›˜å’Œ SSD åœ¨æ€§èƒ½ä¸Šæœ€å¤§çš„åŒºåˆ«æ˜¯å› ä¸ºæœºæ¢°ç¡¬ç›˜çš„éšæœºè®¿é—®æ¶‰åŠåˆ°æœºå™¨è‡‚çš„ç§»åŠ¨å’Œå¯»å€ï¼Œæ‰€ä»¥éå¸¸æ…¢ã€‚ä½†æˆ‘åœ¨äº†è§£ Pika å¯¹æ–‡ä»¶çš„ä½¿ç”¨ä¸Šï¼Œå…¶å®æœ‰è€ƒè™‘è¿‡è¿™æ–¹é¢çš„é—®é¢˜ï¼Œé€šè¿‡ Aã€Bä¸¤å—å†…å­˜äº¤æ¢ä½¿ç”¨ï¼Œä»¥ä¸€å—å†…å­˜ä¸ºå•ä½è¿›è¡Œç£ç›˜å†™ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ã€‚æˆ‘è®¤ä¸ºæœºæ¢°ç¡¬ç›˜çš„å†™æ€§èƒ½å¹¶ä¸ä¸€å®šæ¯” SSD å·®å¾ˆå¤šã€‚<br><br>åœ¨è¯»æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå‡å¦‚æ²¡æœ‰çƒ­ç‚¹æ•°æ®ï¼Œå’Œå­˜åœ¨å¤§é‡çš„éšæœºè¯»ï¼Œåˆ™æœºæ¢°ç¡¬ç›˜çš„è¯»æ€§èƒ½ä¼šæ˜¾å¾—å¾ˆå·®ï¼Œåä¹‹ï¼Œç”±äºæœ‰ä¸€å¤§å—çš„å†…å­˜åšç¼“å†²ï¼Œè¯»æ€§èƒ½æˆ–è®¸å¹¶ä¸ä¼šå¤ªå·®ï¼Œè¿™å–å†³äºä¸šåŠ¡åœºæ™¯ã€‚<br><br>å‰©ä½™æœºæ¢°ç¡¬ç›˜çš„æŸäº›ä¼˜åŠ¿è¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾ï¼ŒKaito ç­é•¿çš„ç•™è¨€å·²ç»éå¸¸æ˜ç™½ï¼Œé¡¾ä¸å¤è¿°ã€‚","like_count":5},{"had_liked":false,"id":256230,"user_name":"æ¨é€¸æ—","can_delete":false,"product_type":"c1","uid":1167233,"ip_address":"","ucode":"4BF3CF3E2F1AC7","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","comment_is_top":false,"comment_ctime":1603558221,"is_pvip":false,"replies":[{"id":"93362","content":"ECCå†…å­˜æ˜¯éœ€è¦çš„ï¼ŒRedisæ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœå†…å­˜å‡ºé”™ï¼Œä¼šæœ‰å½±å“çš„ã€‚<br><br>å…³äºMemtableçš„é—®é¢˜æ˜¯ä¸ªå¥½é—®é¢˜ã€‚åœ¨ä½ è¯´çš„æƒ…å†µä¸‹ï¼ŒMemtable1è¿˜åœ¨å†™SSDï¼ŒMemtable2å·²ç»æ»¡äº†ï¼Œæ­¤æ—¶ç›¸å½“äºæœ‰ä¸¤ä¸ªMemtableè¦åˆ·ç›˜ï¼ŒRocksDBä¼šå¯¹å‰ç«¯çš„å†™è¿›è¡Œé™é€Ÿã€‚<br><br>RocksDBä¸­æœ‰ä¸ªé…ç½®é¡¹æ˜¯max_write_buffer_numberï¼Œå¦‚æœéœ€è¦å¾€ç›˜ä¸Šåˆ·çš„memtableå¤§äºè¿™ä¸ªé…ç½®é¡¹ï¼Œå°±ä¼šè¿›è¡Œå†™é™é€Ÿäº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1603642033,"ip_address":"","comment_id":256230,"utype":1}],"discussion_count":3,"race_medal":0,"score":"23078394701","product_id":100056701,"comment_content":"Redis æœåŠ¡å™¨æœ‰æ²¡æœ‰å¿…è¦ä¸Š ECC å†…å­˜ï¼Ÿ<br>è¿˜æœ‰å¦‚æœé‚£ä¸ª  Memtable æœ‰æ²¡æœ‰æç«¯æƒ…å†µï¼ŒMemtable1 è¿˜åœ¨å†™å…¥ SSDï¼ŒMemtable2 å·²ç»æ»¡äº†ï¼Œè¿™æ€ä¹ˆåŠï¼Ÿè™½ç„¶å†™å…¥ SSD å¾ˆå¿«ï¼Œæˆ‘æ˜¯è¯´å¦‚æœã€‚<br><br>binlog æœºåˆ¶åœ¨ MySQL é‚£å·²ç»ç©çƒ‚äº†ã€‚ã€‚ã€‚","like_count":5,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507974,"discussion_content":"ECCå†…å­˜æ˜¯éœ€è¦çš„ï¼ŒRedisæ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœå†…å­˜å‡ºé”™ï¼Œä¼šæœ‰å½±å“çš„ã€‚\n\nå…³äºMemtableçš„é—®é¢˜æ˜¯ä¸ªå¥½é—®é¢˜ã€‚åœ¨ä½ è¯´çš„æƒ…å†µä¸‹ï¼ŒMemtable1è¿˜åœ¨å†™SSDï¼ŒMemtable2å·²ç»æ»¡äº†ï¼Œæ­¤æ—¶ç›¸å½“äºæœ‰ä¸¤ä¸ªMemtableè¦åˆ·ç›˜ï¼ŒRocksDBä¼šå¯¹å‰ç«¯çš„å†™è¿›è¡Œé™é€Ÿã€‚\n\nRocksDBä¸­æœ‰ä¸ªé…ç½®é¡¹æ˜¯max_write_buffer_numberï¼Œå¦‚æœéœ€è¦å¾€ç›˜ä¸Šåˆ·çš„memtableå¤§äºè¿™ä¸ªé…ç½®é¡¹ï¼Œå°±ä¼šè¿›è¡Œå†™é™é€Ÿäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603642033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2720837,"avatar":"","nickname":"Geek_8835a7","note":"","ucode":"60C5CA747D0040","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":543805,"discussion_content":"é‚£ä¼šä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641304933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":507974,"ip_address":""},"score":543805,"extra":""}]},{"author":{"id":1167233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","nickname":"æ¨é€¸æ—","note":"","ucode":"4BF3CF3E2F1AC7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318129,"discussion_content":"äº†è§£äº†ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603642692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305072,"user_name":"Q, Q","can_delete":false,"product_type":"c1","uid":2360742,"ip_address":"","ucode":"8B0F8F3C866F33","user_header":"https://static001.geekbang.org/account/avatar/00/24/05/a6/098dfae1.jpg","comment_is_top":false,"comment_ctime":1627804233,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"18807673417","product_id":100056701,"comment_content":"pikaå®é™…æ˜¯ä½¿ç”¨ssdæé«˜æ€§èƒ½ï¼Œé‚£è¿˜ä¸å¦‚æŠŠrediså±‚å»æ‰ï¼Œmysqlç›´æ¥ä¸Šssdå²‚ä¸æ˜¯æ›´åŠ æ–¹ä¾¿ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1642586,"avatar":"https://static001.geekbang.org/account/avatar/00/19/10/5a/3411221e.jpg","nickname":"Heidi","note":"","ucode":"2751FD284068AA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579178,"discussion_content":"å­˜å‚¨å±‚çš„æ•°æ®ç»“æ„ä¸ä¸€æ ·ï¼Œb+æ ‘å’Œlsm-treeè§£å†³çš„é—®é¢˜ä¸åŒã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657239507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1449940,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1f/d4/87759d78.jpg","nickname":"ææ¡¶ç”·å­©","note":"","ucode":"3F21C8BCFE2C8E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572904,"discussion_content":"pikaè¿˜æ˜¯æœ‰memtableåœ¨å†…å­˜å…ˆæŸ¥æ•°æ®çš„ï¼Œæ•°æ®æ²¡æœ‰æ‰è½åˆ°ssdä¸ŠæŸ¥è¯¢ã€‚åœ¨å†…å­˜æŸ¥æ‰¾æ•°æ®å§‹ç»ˆæ¯”åœ¨æ•°æ®åº“æŸ¥è¯¢è¦å¿«ã€‚ç›´æ¥ç”¨mysqlé‚£éƒ½å»æ‰äº†å†…å­˜è¿™ä¸€å±‚ã€‚(å·®ä¸å¤šè¦ä¸€å¹´è¿‡å»äº†ï¼Œç•™å¾…åé¢çš„ä¼™ä¼´çœ‹)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653037052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1879290,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ac/fa/a32099e7.jpg","nickname":"Curiosity","note":"","ucode":"A6732CAE6CBE8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1449940,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1f/d4/87759d78.jpg","nickname":"ææ¡¶ç”·å­©","note":"","ucode":"3F21C8BCFE2C8E","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":574928,"discussion_content":"mysqlçš„çƒ­æ•°æ®åœ¨buffer_pollé‡Œé¢ï¼Œä¹Ÿç›¸å½“äºåœ¨å†…å­˜ä¸­å‘€ï¼Œæ˜¯æ•°æ®ç»“æ„ä¸Šçš„åŒºåˆ«ä¹ˆ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1654444369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":572904,"ip_address":""},"score":574928,"extra":""}]}]},{"had_liked":false,"id":265357,"user_name":"éº¦å‘†å°çŸ³å¤´","can_delete":false,"product_type":"c1","uid":1229254,"ip_address":"","ucode":"1F21C9FBE2057C","user_header":"https://static001.geekbang.org/account/avatar/00/12/c1/c6/1456274a.jpg","comment_is_top":false,"comment_ctime":1606877280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18786746464","product_id":100056701,"comment_content":"pika çš„å­˜å‚¨æœºåˆ¶ï¼Œé›†åˆç±»å‹çš„æ€§èƒ½ä¼šä½å¾ˆå¤šå•Šï¼Œhash å’Œè·³è¡¨çš„ç‰¹æ€§éƒ½æ²¡äº†å§","like_count":4},{"had_liked":false,"id":255111,"user_name":"æ¸¸å¼‹äº‘ç«¯","can_delete":false,"product_type":"c1","uid":1208637,"ip_address":"","ucode":"A960E8F5AA25B9","user_header":"https://static001.geekbang.org/account/avatar/00/12/71/3d/da8dc880.jpg","comment_is_top":false,"comment_ctime":1603267821,"is_pvip":false,"replies":[{"id":"98027","content":"åˆ†çº§å­˜å‚¨æ—¶ï¼Œæ•°æ®çš„å†·çƒ­åº¦è¯†åˆ«æ˜¯ä¸€ä¸ªä¸»è¦è¦è€ƒè™‘çš„é—®é¢˜ã€‚é€šå¸¸å¯ä»¥ç”¨ç¼“å­˜ç®—æ³•ç­–ç•¥æ¥ç­›é€‰å†·çƒ­æ•°æ®ï¼Œç›®å‰ä¹Ÿæœ‰äº›å°è¯•æ˜¯ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•æ¥é¢„æµ‹æ•°æ®å†·çƒ­åº¦ï¼Œè¿›è€Œå†æ”¾åˆ°ä¸åŒçš„ä»‹è´¨ä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1609084360,"ip_address":"","comment_id":255111,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14488169709","product_id":100056701,"comment_content":"å¯ä»¥è€ƒè™‘å†…å­˜ã€SSDã€HDDåšåˆ†çº§å­˜å‚¨ï¼Œå½“å‰è¿™å¯¹ç³»ç»Ÿè¦æ±‚å°±æ›´é«˜äº†ï¼Œéœ€è¦è¯†åˆ«æ•°æ®çš„å†·æ¸©çƒ­ï¼Œå†åšä¸åŒä»‹è´¨é—´çš„åŠ¨æ€è¿ç§»ï¼Œç”šè‡³å¯ä»¥åšä¸€äº›è®¿é—®é¢„æµ‹æ¥åšé¢„åŠ è½½å’Œè°ƒçº§ã€‚","like_count":3,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507609,"discussion_content":"åˆ†çº§å­˜å‚¨æ—¶ï¼Œæ•°æ®çš„å†·çƒ­åº¦è¯†åˆ«æ˜¯ä¸€ä¸ªä¸»è¦è¦è€ƒè™‘çš„é—®é¢˜ã€‚é€šå¸¸å¯ä»¥ç”¨ç¼“å­˜ç®—æ³•ç­–ç•¥æ¥ç­›é€‰å†·çƒ­æ•°æ®ï¼Œç›®å‰ä¹Ÿæœ‰äº›å°è¯•æ˜¯ç”¨æœºå™¨å­¦ä¹ çš„æ–¹æ³•æ¥é¢„æµ‹æ•°æ®å†·çƒ­åº¦ï¼Œè¿›è€Œå†æ”¾åˆ°ä¸åŒçš„ä»‹è´¨ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609084360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277129,"user_name":"Trä¸¶Zoey","can_delete":false,"product_type":"c1","uid":1684297,"ip_address":"","ucode":"34A30F97E5A9DF","user_header":"https://static001.geekbang.org/account/avatar/00/19/b3/49/79024ed2.jpg","comment_is_top":false,"comment_ctime":1612270653,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10202205245","product_id":100056701,"comment_content":"æœ‰æ²¡æœ‰äººç”¨ssdbçš„å•Šï¼ŸğŸ˜‚<br>è€å¤§è®©æˆ‘ä»¬ç”¨è¿™ä¸ªä»£æ›¿redisï¼Œè¯´æ²¡é—®é¢˜ï¼Œç»“æœç”¨ä¸‹æ¥å‘çœŸçš„å¤šã€‚ã€‚ã€‚","like_count":2,"discussions":[{"author":{"id":1108924,"avatar":"https://static001.geekbang.org/account/avatar/00/10/eb/bc/6ccac4bb.jpg","nickname":"æ­¦æ–‡æ–‡æ­¦","note":"","ucode":"5288366646A15B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534207,"discussion_content":"æ–¹ä¾¿çš„è¯å¯ä»¥åŠ å¾®ä¿¡ç»†èŠ: 490977449","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638121109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1108924,"avatar":"https://static001.geekbang.org/account/avatar/00/10/eb/bc/6ccac4bb.jpg","nickname":"æ­¦æ–‡æ–‡æ­¦","note":"","ucode":"5288366646A15B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534206,"discussion_content":"å…„å¼Ÿï¼Œæˆ‘ä»¬5å¹´å‰ç”¨è¿‡ssdbï¼Œä¸çŸ¥é“ç°åœ¨æ€ä¹ˆæ ·äº†ï¼Œä½ éƒ½è¸©è¿‡å“ªäº›å‘å‘€ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638121083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273037,"user_name":"ğŸ’¢ æ˜Ÿæ˜ŸğŸ’¢","can_delete":false,"product_type":"c1","uid":1254392,"ip_address":"","ucode":"A402B765222C35","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/f8/24fcccea.jpg","comment_is_top":false,"comment_ctime":1610418456,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5905385752","product_id":100056701,"comment_content":"Pika çš„å¤šçº¿ç¨‹æ¨¡å‹ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡Œæ•°æ®è¯»å†™ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†ä» SSD å­˜å–æ•°æ®é€ æˆçš„æ€§èƒ½æŸå¤±ï¼Œå¤šçº¿ç¨‹è¯»å†™ï¼Œä¼šæ¶‰åŠåˆ°æ•°æ®ç«äº‰å§ï¼Œpikaè¿™ä¸€å—æ˜¯å¦æœ‰ä¼˜é›…çš„å¤„ç†å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1449940,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1f/d4/87759d78.jpg","nickname":"ææ¡¶ç”·å­©","note":"","ucode":"3F21C8BCFE2C8E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572906,"discussion_content":"æ—¢ç„¶ç”¨åˆ°é‚£ï¼Œé‚£è‚¯å®šæ˜¯å†…éƒ¨æœ‰å¤„ç†äº†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653037207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354000,"user_name":"Jackson","can_delete":false,"product_type":"c1","uid":2739544,"ip_address":"å¹¿ä¸œ","ucode":"0012FFEA2B4620","user_header":"https://static001.geekbang.org/account/avatar/00/29/cd/58/06a8ce36.jpg","comment_is_top":false,"comment_ctime":1660006463,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660006463","product_id":100056701,"comment_content":"è¿™é‡Œå¦‚æœç”¨æŒä¹…åŒ–å†…å­˜çš„è¯è¯»å†™æ€§èƒ½å¦‚ä½•ï¼Ÿredis6.0åœ¨å¤šçº¿ç¨‹å’Œè¿™ä¸ªä¼˜åŠ£æ˜¯å•¥","like_count":0},{"had_liked":false,"id":347973,"user_name":"jie","can_delete":false,"product_type":"c1","uid":1621432,"ip_address":"","ucode":"E93A1818AB2459","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WxLKJlXCibwqO92vB8XTicLQiahrhuUEqP7yT9dearZxLzbia7oMdsLmon5J4LJyTfIWchHY3bKfibm1lS1aZarZs4Q/132","comment_is_top":false,"comment_ctime":1654618266,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1654618266","product_id":100056701,"comment_content":"mysqlä¸Šssd æ¯”rocksdb ä¸Š ssd æ”¶ç›Šæ›´å¤§å§ æ¯•ç«Ÿä¸€ä¸ªéšæœºå†™,ä¸€ä¸ªé¡ºåºå†™.","like_count":0},{"had_liked":false,"id":341953,"user_name":"é˜¿æ˜•","can_delete":false,"product_type":"c1","uid":1012906,"ip_address":"","ucode":"F3AD093B68E074","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/aa/178a6797.jpg","comment_is_top":false,"comment_ctime":1649928888,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649928888","product_id":100056701,"comment_content":"å¥½å¤„ï¼šä¾¿å®œï¼Œæˆæœ¬ä½ï¼›ä¸è¶³ï¼šé€Ÿåº¦æ…¢ï¼›","like_count":0},{"had_liked":false,"id":310905,"user_name":"é±¼","can_delete":false,"product_type":"c1","uid":1487584,"ip_address":"","ucode":"89EC9CE3AD0281","user_header":"https://static001.geekbang.org/account/avatar/00/16/b2/e0/d856f5a4.jpg","comment_is_top":false,"comment_ctime":1630978406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630978406","product_id":100056701,"comment_content":"ç”±äºæ˜¯æ–‡ä»¶è¿ç»­è¯»å†™ï¼ŒPikaæœ€å¤§çš„é—®é¢˜å¹¶ä¸æ˜¯æ•°æ®å†™å…¥çš„æ—¶å€™å§ã€‚è€Œæ˜¯è¯»å–keyçš„æ—¶å€™è¦å»RocketsDBçš„SSTableé‡Œé¢æŒ¨ä¸ªè¯»æ–‡ä»¶ã€‚æ–‡ç« æ²¡æœ‰æåŠã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå†™å…¥çš„æ€§èƒ½é™ä½å’Œè¯»å–çš„æ€§èƒ½é™ä½æ¯”è¾ƒä¸å€¼ä¸€æå•Šã€‚","like_count":0},{"had_liked":false,"id":284599,"user_name":"é»„æ³“å“²","can_delete":false,"product_type":"c1","uid":1821881,"ip_address":"","ucode":"369C8D48B5A52F","user_header":"https://static001.geekbang.org/account/avatar/00/1b/cc/b9/98070739.jpg","comment_is_top":false,"comment_ctime":1616382355,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616382355","product_id":100056701,"comment_content":"è¿™è®©æˆ‘æƒ³èµ·æ¥å‰å‡ å¹´çš„æ··åˆç¡¬ç›˜ï¼Œæœºæ¢°+NAND","like_count":0},{"had_liked":false,"id":284076,"user_name":"Geek_5b378d","can_delete":false,"product_type":"c1","uid":2290540,"ip_address":"","ucode":"E663DEAE6A89EC","user_header":"","comment_is_top":false,"comment_ctime":1616057736,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1616057736","product_id":100056701,"comment_content":"æœ‰ä¸€ç‚¹ä¸ç†è§£:RDB æ–‡ä»¶ç”Ÿæˆæ—¶çš„ fork æ—¶é•¿å°±ä¼šå¢åŠ <br>ä¸æ˜¯ç”¨å¦å¤–ä¸€ä¸ªè¿›ç¨‹å»ç”Ÿæˆ RDB æ–‡ä»¶å˜›,å’‹ä¼šé˜»å¡ redis å®ä¾‹å‘¢","like_count":0,"discussions":[{"author":{"id":1641326,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDdmHm6txEVtEXEDibSdIsRLEpghOoMt2kfZHetY9QLWHygicKCfhVoYiaylAZJoXbcCMBhXqMF4icgw/132","nickname":"æ´—æ´—ç¡å§","note":"","ucode":"DE7F8B4CA512F6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386606,"discussion_content":"å‰é¢çš„ç« èŠ‚ï¼ŒKaitoæœ‰è¯´è¿‡è¿™ä¸ªï¼Œforkçš„ç¬é—´è¦æ‹·è´ä¸»çº¿ç¨‹ä¸­è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜çš„æ˜ å°„è¡¨ã€‚Rediså ç”¨å†…å­˜è¶Šå¤šï¼Œæ˜ å°„è¡¨è¶Šå¤§ï¼Œé˜»å¡æ—¶é—´è¶Šé•¿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627666550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250828,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/0c/53f2792c.jpg","nickname":"Cheney","note":"","ucode":"6ED4F3FDBA6D54","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367226,"discussion_content":"forkè¿›ç¨‹çš„ç¬é—´,èŠ‚ç‚¹æ˜¯ä¸èƒ½æä¾›æœåŠ¡çš„(é˜»å¡)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618300345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1449940,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1f/d4/87759d78.jpg","nickname":"ææ¡¶ç”·å­©","note":"","ucode":"3F21C8BCFE2C8E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572905,"discussion_content":"å¹¶ä¸”fork()ä¼šæ£€æµ‹ä¹‹å‰çš„forkè¿›ç¨‹æ˜¯å¦å®Œæˆï¼Œå¦‚æœä¹‹å‰çš„è¿˜æ²¡æœ‰å®Œæˆçš„è¯ï¼Œé‚£ä¹ˆå½“å‰è¿™ä¸ªå°±ä¼šä¸€ç›´é˜»å¡ä¸»çº¿ç¨‹ï¼Œç­‰å¾…fork","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653037158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279454,"user_name":"æ²ˆå¯…","can_delete":false,"product_type":"c1","uid":1321582,"ip_address":"","ucode":"03ACA766AC6FD5","user_header":"https://static001.geekbang.org/account/avatar/00/14/2a/6e/fb980b6b.jpg","comment_is_top":false,"comment_ctime":1613790512,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613790512","product_id":100056701,"comment_content":"redisæ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œpikaå†…éƒ¨ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œè¿˜èƒ½ä¿è¯åŸå­æ€§å—ï¼Ÿ ","like_count":0},{"had_liked":false,"id":278672,"user_name":"silentyears","can_delete":false,"product_type":"c1","uid":1061748,"ip_address":"","ucode":"6E137BFEB874CA","user_header":"https://static001.geekbang.org/account/avatar/00/10/33/74/d9d143fa.jpg","comment_is_top":false,"comment_ctime":1613188789,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1613188789","product_id":100056701,"comment_content":"è€å¸ˆï¼Œpikaè¿™æ ·å­˜å‚¨é›†åˆç±»å‹çš„æ–¹å¼ä¸å¤ªæ˜ç™½ï¼Œæ‹¿Hashæ¥è¯´ï¼Œfieldå­˜å‚¨åœ¨é”®ä¸­ï¼Œvalueå­˜å‚¨åœ¨å€¼ä¸­ï¼Œæ€ä¹ˆå¿«é€Ÿå®šä½å‘¢ï¼Ÿéš¾é“æ˜¯hashåè®¡ç®—å‡ºæ¥ä½ç½®mï¼Œåœ¨é”®ä¸­â€œæ•°ç»„â€ä½ç½®mä¸Šæ‰¾fieldï¼ŒåŒæ ·åœ¨å€¼ä¸­â€œæ•°ç»„â€ä½ç½®mä¸Šæ‰¾valueï¼Ÿ","like_count":0},{"had_liked":false,"id":276631,"user_name":"é‡‘é¾Ÿ","can_delete":false,"product_type":"c1","uid":1228500,"ip_address":"","ucode":"1C7D35C8AE8D9D","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/d4/ff1c1319.jpg","comment_is_top":false,"comment_ctime":1612058544,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612058544","product_id":100056701,"comment_content":"åˆšæ‰è¯´é”™äº†ï¼Œå¯ä»¥ç”¨mongodb","like_count":0},{"had_liked":false,"id":265635,"user_name":"èŒƒé—²","can_delete":false,"product_type":"c1","uid":1073125,"ip_address":"","ucode":"F21FD7DF6BA53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg","comment_is_top":false,"comment_ctime":1606966134,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606966134","product_id":100056701,"comment_content":"Pikaå°±æ˜¯æ”¯æŒå¤šç§æ•°æ®ç»“æ„çš„åˆ†å¸ƒå¼kvã€‚<br>æ•°æ®è®¿é—®çš„æ€§èƒ½ä¸€å®šä¼šä¸‹é™:<br>memtableæœ‰å¤§å°é™åˆ¶ï¼Œå¦‚æœä¸åœ¨è¿™é‡Œä¸€å®šæ˜¯ä»ç£ç›˜è¯»ï¼Œä¸€å®šæ¯”ä»å†…å­˜è¯»æ…¢ã€‚","like_count":0},{"had_liked":false,"id":261201,"user_name":"Mr.èœœ","can_delete":false,"product_type":"c1","uid":1035257,"ip_address":"","ucode":"C911B81198B3F5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/f9/75d08ccf.jpg","comment_is_top":false,"comment_ctime":1605238778,"is_pvip":false,"replies":[{"id":"97935","content":"å¦‚æœç”¨æœºæ¢°ç¡¬ç›˜ï¼Œè€ƒè™‘åˆ°æœºæ¢°ç¡¬ç›˜çš„æ¯«ç§’çº§åˆ«å»¶è¿Ÿï¼Œæ•°æ®è®¿é—®é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ï¼Œä¼šæ‹–æ…¢å‰ç«¯åº”ç”¨çš„å“åº”ã€‚ä¸€èˆ¬è¿˜æ˜¯å»ºè®®ç”¨SSDæ›´å¥½äº›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1608998903,"ip_address":"","comment_id":261201,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1605238778","product_id":100056701,"comment_content":"åªè¦èƒ½åŒºåˆ†å‡ºå†·çƒ­æ•°æ®ï¼Œå¯ç”¨æœºæ¢°ç¡¬ç›˜ä½œä¸ºä¸€éƒ¨åˆ†å­˜å‚¨ä»‹è´¨ä¹Ÿæ˜¯ä¸€ä¸ªå¯å–çš„æ–¹æ¡ˆã€‚","like_count":0,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509414,"discussion_content":"å¦‚æœç”¨æœºæ¢°ç¡¬ç›˜ï¼Œè€ƒè™‘åˆ°æœºæ¢°ç¡¬ç›˜çš„æ¯«ç§’çº§åˆ«å»¶è¿Ÿï¼Œæ•°æ®è®¿é—®é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ï¼Œä¼šæ‹–æ…¢å‰ç«¯åº”ç”¨çš„å“åº”ã€‚ä¸€èˆ¬è¿˜æ˜¯å»ºè®®ç”¨SSDæ›´å¥½äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608998903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257787,"user_name":"dfuru","can_delete":false,"product_type":"c1","uid":2110772,"ip_address":"","ucode":"0222FADA093D95","user_header":"","comment_is_top":false,"comment_ctime":1604130744,"is_pvip":false,"replies":[{"id":"98036","content":"æœºæ¢°ç¡¬ç›˜ä½œä¸ºå®¹é‡æ‰©å±•æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æœºæ¢°ç¡¬ç›˜çš„æ€§èƒ½æ…¢ï¼Œä¼šæ˜¯æ½œåœ¨é—®é¢˜ã€‚å¦å¤–ï¼Œç°åœ¨SSDçš„å®¹é‡ä¹Ÿå¯ä»¥åšåˆ°å¾ˆå¤§ï¼Œå½“ç„¶å®¹é‡çš„æ€§ä»·æ¯”è¿˜æ˜¯æ¯”ä¸ä¸Šæœºæ¢°ç¡¬ç›˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è’‹å¾·é’§","uid":"1609687","ctime":1609111761,"ip_address":"","comment_id":257787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1604130744","product_id":100056701,"comment_content":"ä½¿ç”¨æœºæ¢°ç¡¬ç›˜ä½œä¸ºå®ä¾‹å®¹é‡æ‰©å±•ï¼š<br>1. åœ¨pikaçš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œå½“å†™æ»¡ä¸€ä¸ªmemtableæ—¶ï¼Œåˆ‡æ¢memtable,å°†å†™æ»¡çš„memtableä¸­çš„æ•°æ®å·²æ–‡ä»¶çš„å½¢å¼æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸Šã€‚<br>   ç¡¬ç›˜å…·ä½“æ˜¯SSDã€æœºæ¢°ç¡¬ç›˜è¿˜æ˜¯NVMEï¼Œéƒ½å¯ä»¥ã€‚<br>2. ä½¿ç”¨æœºæ¢°ç¡¬ç›˜ï¼Œå®¹é‡æ›´å¤§ï¼Œä»·æ ¼æ›´ä¾¿å®œï¼Œè¯»å†™æ€§èƒ½æ›´ä½ã€‚å¤§é‡æ•°æ®è®¿é—®æœºæ¢°ç›˜æ—¶ï¼Œç£ç›˜IOæ˜¯ä¸»è¦ç“¶é¢ˆã€‚","like_count":0,"discussions":[{"author":{"id":1609687,"avatar":"https://static001.geekbang.org/account/avatar/00/18/8f/d7/fb60129d.jpg","nickname":"è’‹å¾·é’§","note":"","ucode":"833985C2C37C0A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508449,"discussion_content":"æœºæ¢°ç¡¬ç›˜ä½œä¸ºå®¹é‡æ‰©å±•æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æœºæ¢°ç¡¬ç›˜çš„æ€§èƒ½æ…¢ï¼Œä¼šæ˜¯æ½œåœ¨é—®é¢˜ã€‚å¦å¤–ï¼Œç°åœ¨SSDçš„å®¹é‡ä¹Ÿå¯ä»¥åšåˆ°å¾ˆå¤§ï¼Œå½“ç„¶å®¹é‡çš„æ€§ä»·æ¯”è¿˜æ˜¯æ¯”ä¸ä¸Šæœºæ¢°ç¡¬ç›˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609111761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256402,"user_name":"Bug? Feature!","can_delete":false,"product_type":"c1","uid":1164531,"ip_address":"","ucode":"F8FA8A0094FBA0","user_header":"https://static001.geekbang.org/account/avatar/00/11/c4/f3/92f654f1.jpg","comment_is_top":false,"comment_ctime":1603617645,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603617645","product_id":100056701,"comment_content":"å¦‚æœé’±å¤šï¼Œä¼˜å…ˆé€‰æ‹©SSDï¼Œå“ˆå“ˆ","like_count":0},{"had_liked":false,"id":255948,"user_name":"å¥½è¿æ¥","can_delete":false,"product_type":"c1","uid":1113937,"ip_address":"","ucode":"F469ED6CEFEF30","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/51/9d5cfadd.jpg","comment_is_top":false,"comment_ctime":1603464740,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1603464740","product_id":100056701,"comment_content":"å¦‚æœèƒ½å¤Ÿè¯†åˆ«é«˜é¢‘çƒ­æ•°æ®å’Œä½é¢‘å†·æ•°æ®ï¼Œå¯¹äºä½é¢‘å†·æ•°æ®æ”¾åœ¨æœºæ¢°ç¡¬ç›˜å­˜å‚¨éƒ½æ˜¯å¯ä»¥çš„","like_count":0},{"had_liked":false,"id":255548,"user_name":"å¤§é¥¶Raysir","can_delete":false,"product_type":"c1","uid":1589208,"ip_address":"","ucode":"0AFA191420A30D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTITcwicqBDYzXtLibUtian172tPs7rJpqG1Vab4oGjnguA9ziaYjDCILSGaS6qRiakvRdUEhdmSG0BGPKw/132","comment_is_top":false,"comment_ctime":1603370822,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603370822","product_id":100056701,"comment_content":"ä½¿ç”¨æœºæ¢°ç¡¬ç›˜æœ€å¤§çš„å¥½å¤„å°±æ˜¯æˆæœ¬æ›´ä½ã€å­˜å‚¨å®¹é‡æ›´å¤§ï¼Œç¼ºç‚¹å°±æ˜¯è®¿é—®ææ…¢ï¼Œé€‚åˆå¯¹è®¿é—®é€Ÿåº¦è¦æ±‚å¾ˆä¸æ•æ„Ÿçš„åœºæ™¯","like_count":0},{"had_liked":false,"id":255067,"user_name":"Lemon","can_delete":false,"product_type":"c1","uid":2136414,"ip_address":"","ucode":"E52BB361B69825","user_header":"https://static001.geekbang.org/account/avatar/00/20/99/5e/33481a74.jpg","comment_is_top":false,"comment_ctime":1603262143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603262143","product_id":100056701,"comment_content":"åŒå®¹é‡ä¸‹ï¼Œæœºæ¢°ç¡¬ç›˜å¯¹æ¯”å›ºæ€ç¡¬ç›˜<br>ä¼˜ç‚¹ï¼š<br>1ã€ä»·æ ¼ä¾¿å®œ<br>2ã€ä½¿ç”¨å¯¿å‘½é•¿<br>ç¼ºç‚¹ï¼š<br>é€Ÿåº¦æ…¢ï¼Œä½¿ç”¨ç¼“å­˜ï¼ˆredis ï¼‰æ˜¯ä¸ºäº†åŠ é€Ÿæ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼Œæœ¬èº«pikaæ•°æ®æ“ä½œä¸åœ¨å†…å­˜ä¸­ç›´æ¥æ‰§è¡Œï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–å­˜å‚¨ä»‹è´¨ã€‚ä½¿ç”¨æœºæ¢°ç¡¬ç›˜æ€•æ˜¯ä¼šä½¿ç”¨æˆ·ä½“éªŒæ‰“éª¨æŠ˜â€¦â€¦","like_count":0},{"had_liked":false,"id":254976,"user_name":"yeek","can_delete":false,"product_type":"c1","uid":1020629,"ip_address":"","ucode":"A1C71023113CB9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/d5/699384a0.jpg","comment_is_top":false,"comment_ctime":1603243798,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603243798","product_id":100056701,"comment_content":"æ„Ÿè§‰pikaåœ¨ç»™redisä¸è¶³çš„åœ°æ–¹æä¾›äº†è¡¥å……ï¼š<br><br>æ¯”å¦‚ä½¿ç”¨binlogæœºåˆ¶è¿›è¡Œå¢é‡åŒæ­¥ï¼Œé¿å…å†…å­˜ä¸­è¿›è¡ŒrdbåŒæ­¥ï¼Œç›´æ¥å…ˆä½¿ç”¨ç£ç›˜çš„rdbæ¢å¤ï¼Œå†ä½¿ç”¨binlogå¢é‡ï¼Œå†ä½¿ç”¨å†…å­˜å¢é‡ç¼“å†²åŒºè¿½ä¸Šæœ€åçš„ä¸€ç‚¹ï¼Œæœ€ç»ˆå®æ—¶åŒæ­¥","like_count":0}]}