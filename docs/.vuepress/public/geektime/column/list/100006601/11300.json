{"id":11300,"title":"36 | 微服务架构最佳实践 - 基础设施篇","content":"<p>每项微服务基础设施都是一个平台、一个系统、一个解决方案，如果要自己实现，其过程和做业务系统类似，都需要经过需求分析、架构设计、开发、测试、部署上线等步骤，专栏里我来简单介绍一下每个基础设施的主要作用，更多详细设计你可以参考Spring Cloud的相关资料（<a href=\"https://projects.spring.io/spring-cloud/\">https://projects.spring.io/spring-cloud/</a>）。</p><p>下面进入今天的内容，<span class=\"orange\">微服务架构最佳实践的基础设施篇</span>。</p><h2>自动化测试</h2><p>微服务将原本大一统的系统拆分为多个独立运行的“微”服务，微服务之间的接口数量大大增加，并且微服务提倡快速交付，版本周期短，版本更新频繁。如果每次更新都靠人工回归整个系统，则工作量大，效率低下，达不到“快速交付”的目的，因此必须通过自动化测试系统来完成绝大部分测试回归的工作。</p><p>自动化测试涵盖的范围包括代码级的单元测试、单个系统级的集成测试、系统间的接口测试，理想情况是每类测试都自动化。如果因为团队规模和人力的原因无法全面覆盖，至少要做到接口测试自动化。</p><h2>自动化部署</h2><p>相比大一统的系统，微服务需要部署的节点增加了几倍甚至十几倍，微服务部署的频率也会大幅提升（例如，我们的业务系统70%的工作日都有部署操作），综合计算下来，微服务部署的次数是大一统系统部署次数的几十倍。这么大量的部署操作，如果继续采用人工手工处理，需要投入大量的人力，且容易出错，因此需要自动化部署的系统来完成部署操作。</p><!-- [[[read_end]]] --><p>自动化部署系统包括版本管理、资源管理（例如，机器管理、虚拟机管理）、部署操作、回退操作等功能。</p><h2>配置中心</h2><p>微服务的节点数量非常多，通过人工登录每台机器手工修改，效率低，容易出错。特别是在部署或者排障时，需要快速增删改查配置，人工操作的方式显然是不行的。除此以外，有的运行期配置需要动态修改并且所有节点即时生效，人工操作是无法做到的。综合上面的分析，微服务需要一个统一的配置中心来管理所有微服务节点的配置。</p><p>配置中心包括配置版本管理（例如，同样的微服务，有10个节点是给移动用户服务的，有20个节点给联通用户服务的，配置项都一样，配置值不一样）、增删改查配置、节点管理、配置同步、配置推送等功能。</p><h2>接口框架</h2><p>微服务提倡轻量级的通信方式，一般采用HTTP/REST或者RPC方式统一接口协议。但在实践过程中，光统一接口协议还不够，还需要统一接口传递的数据格式。例如，我们需要指定接口协议为HTTP/REST，但这还不够，还需要指定HTTP/REST的数据格式采用JSON，并且JSON的数据都遵循如下规范。</p><p><img src=\"https://static001.geekbang.org/resource/image/fb/41/fbcbe9d491b47aac3ecd26aab8c13141.png?wh=768*398\" alt=\"\"></p><p>如果我们只是简单指定了HTTP/REST协议，而不指定JSON和JSON的数据规范，那么就会出现这样混乱的情况：有的微服务采用XML，有的采用JSON，有的采用键值对；即使同样都是JSON，JSON数据格式也不一样。这样每个微服务都要适配几套甚至几十套接口协议，相当于把曾经由ESB做的事情转交给微服务自己做了，这样做的效率显然是无法接受的，因此需要统一接口框架。</p><p>接口框架不是一个可运行的系统，一般以库或者包的形式提供给所有微服务调用。例如，针对上面的JSON样例，可以由某个基础技术团队提供多种不同语言的解析包（Java包、Python包、C库等）。</p><h2>API网关</h2><p>系统拆分为微服务后，内部的微服务之间是互联互通的，相互之间的访问都是点对点的。如果外部系统想调用系统的某个功能，也采取点对点的方式，则外部系统会非常“头大”。因为在外部系统看来，它不需要也没办法理解这么多微服务的职责分工和边界，它只会关注它需要的能力，而不会关注这个能力应该由哪个微服务提供。</p><p>除此以外，外部系统访问系统还涉及安全和权限相关的限制，如果外部系统直接访问某个微服务，则意味着每个微服务都要自己实现安全和权限的功能，这样做不但工作量大，而且都是重复工作。</p><p>综合上面的分析，微服务需要一个统一的API网关，负责外部系统的访问操作。</p><p>API网关是外部系统访问的接口，所有的外部系统接⼊系统都需要通过API网关，主要包括接入鉴权（是否允许接入）、权限控制（可以访问哪些功能）、传输加密、请求路由、流量控制等功能。</p><h2>服务发现</h2><p>微服务种类和数量很多，如果这些信息全部通过手工配置的方式写入各个微服务节点，首先配置工作量很大，配置文件可能要配几百上千行，几十个节点加起来后配置项就是几万几十万行了，人工维护这么大数量的配置项是一项灾难；其次是微服务节点经常变化，可能是由于扩容导致节点增加，也可能是故障处理时隔离掉一部分节点，还可能是采用灰度升级，先将一部分节点升级到新版本，然后让新老版本同时运行。不管哪种情况，我们都希望节点的变化能够及时同步到所有其他依赖的微服务。如果采用手工配置，是不可能做到实时更改生效的。因此，需要一套服务发现的系统来支撑微服务的自动注册和发现。</p><p>服务发现主要有两种实现方式：自理式和代理式。</p><p>1.自理式</p><p>自理式结构如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/40/d7/40yydb21d7b844c52786e930442fe0d7.jpg?wh=4208*3013\" alt=\"\"></p><p>自理式结构就是指每个微服务自己完成服务发现。例如，图中SERVICE INSTANCE A访问SERVICE REGISTRY获取服务注册信息，然后直接访问SERVICE INSTANCE B。</p><p>自理式服务发现实现比较简单，因为这部分的功能一般通过统一的程序库或者程序包提供给各个微服务调用，而不会每个微服务都自己来重复实现一遍；并且由于每个微服务都承担了服务发现的功能，访问压力分散到了各个微服务节点，性能和可用性上不存在明显的压力和风险。</p><p>2.代理式</p><p>代理式结构如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/70/0e/7052142ae1d13d4a98293f3b58fa2e0e.jpg?wh=4424*2964\" alt=\"\"></p><p>代理式结构就是指微服务之间有一个负载均衡系统（图中的LOAD BALANCER节点），由负载均衡系统来完成微服务之间的服务发现。</p><p>代理式的方式看起来更加清晰，微服务本身的实现也简单了很多，但实际上这个方案风险较大。第一个风险是可用性风险，一旦LOAD BALANCER系统故障，就会影响所有微服务之间的调用；第二个风险是性能风险，所有的微服务之间的调用流量都要经过LOAD BALANCER系统，性能压力会随着微服务数量和流量增加而不断增加，最后成为性能瓶颈。因此LOAD BALANCER系统需要设计成集群的模式，但LOAD BALANCER集群的实现本身又增加了复杂性。</p><p>不管是自理式还是代理式，服务发现的核心功能就是服务注册表，注册表记录了所有的服务节点的配置和状态，每个微服务启动后都需要将自己的信息注册到服务注册表，然后由微服务或者LOAD BALANCER系统到服务注册表查询可用服务。</p><h2>服务路由</h2><p>有了服务发现后，微服务之间能够方便地获取相关配置信息，但具体进行某次调用请求时，我们还需要从所有符合条件的可用微服务节点中挑选出一个具体的节点发起请求，这就是服务路由需要完成的功能。</p><p>服务路由和服务发现紧密相关，服务路由一般不会设计成一个独立运行的系统，通常情况下是和服务发现放在一起实现的。对于自理式服务发现，服务路由是微服务内部实现的；对于代理式服务发现，服务路由是由LOAD BALANCER系统实现的。无论放在哪里实现，服务路由核心的功能就是路由算法。常见的路由算法有：随机路由、轮询路由、最小压力路由、最小连接数路由等。</p><h2>服务容错</h2><p>系统拆分为微服务后，单个微服务故障的概率变小，故障影响范围也减少，但是微服务的节点数量大大增加。从整体上来看，系统中某个微服务出故障的概率会大大增加。<a href=\"http://time.geekbang.org/column/article/10944\">专栏第34期</a>我在分析微服务陷阱时提到微服务具有故障扩散的特点，如果不及时处理故障，故障扩散开来就会导致看起来系统中很多服务节点都故障了，因此需要微服务能够自动应对这种出错场景，及时进行处理。否则，如果节点一故障就需要人工处理，投入人力大，处理速度慢；而一旦处理速度慢，则故障就很快扩散，所以我们需要服务容错的能力。</p><p>常见的服务容错包括请求重试、流控和服务隔离。通常情况下，服务容错会集成在服务发现和服务路由系统中。</p><h2>服务监控</h2><p>系统拆分为微服务后，节点数量大大增加，导致需要监控的机器、网络、进程、接口调用数等监控对象的数量大大增加；同时，一旦发生故障，我们需要快速根据各类信息来定位故障。这两个目标如果靠人力去完成是不现实的。举个简单例子：我们收到用户投诉说业务有问题，如果此时采取人工的方式去搜集、分析信息，可能把几十个节点的日志打开一遍就需要十几分钟了，因此需要服务监控系统来完成微服务节点的监控。</p><p>服务监控的主要作用有：</p><ul>\n<li>\n<p>实时搜集信息并进行分析，避免故障后再来分析，减少了处理时间。</p>\n</li>\n<li>\n<p>服务监控可以在实时分析的基础上进行预警，在问题萌芽的阶段发觉并预警，降低了问题影响的范围和时间。</p>\n</li>\n</ul><p>通常情况下，服务监控需要搜集并分析大量的数据，因此建议做成独立的系统，而不要集成到服务发现、API网关等系统中。</p><h2>服务跟踪</h2><p>服务监控可以做到微服务节点级的监控和信息收集，但如果我们需要跟踪某一个请求在微服务中的完整路径，服务监控是难以实现的。因为如果每个服务的完整请求链信息都实时发送给服务监控系统，数据量会大到无法处理。</p><p>服务监控和服务跟踪的区别可以简单概括为宏观和微观的区别。例如，A服务通过HTTP协议请求B服务10次，B通过HTTP返回JSON对象，服务监控会记录请求次数、响应时间平均值、响应时间最高值、错误码分布这些信息；而服务跟踪会记录其中某次请求的发起时间、响应时间、响应错误码、请求参数、返回的JSON对象等信息。</p><p>目前无论是分布式跟踪还是微服务的服务跟踪，绝大部分请求跟踪的实现技术都基于Google的Dapper论文《Dapper, a Large-Scale Distributed Systems Tracing Infrastructure》。</p><h2>服务安全</h2><p>系统拆分为微服务后，数据分散在各个微服务节点上。从系统连接的角度来说，任意微服务都可以访问所有其他微服务节点；但从业务的角度来说，部分敏感数据或者操作，只能部分微服务可以访问，而不是所有的微服务都可以访问，因此需要设计服务安全机制来保证业务和数据的安全性。</p><p>服务安全主要分为三部分：接入安全、数据安全、传输安全。通常情况下，服务安全可以集成到配置中心系统中进行实现，即配置中心配置微服务的接入安全策略和数据安全策略，微服务节点从配置中心获取这些配置信息，然后在处理具体的微服务调用请求时根据安全策略进行处理。由于这些策略是通用的，一般会把策略封装成通用的库提供给各个微服务调用。基本架构如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/06/08/066a03e185136b8ce9259a329240d608.jpg?wh=3254*1945\" alt=\"\"></p><h2>小结</h2><p>今天我为你讲了微服务架构相关的基础设施的概要介绍和关键设计点，希望对你有所帮助。</p><p>这就是今天的全部内容，这一期的思考题很特别，给你一个由10位Java高级软件工程师组成的开发团队，采用自研的方式，完成所有的微服务基础设施开发，你预测需要多长时间？理由是什么呢？</p><p>欢迎你把答案写到留言区，和我一起讨论。相信经过深度思考的回答，也会让你对知识的理解更加深刻。（编辑乱入：精彩的留言有机会获得丰厚福利哦！）</p>","neighbors":{"left":{"article_title":"35 | 微服务架构最佳实践 - 方法篇","id":11207},"right":{"article_title":"37 | 微内核架构详解","id":11610}},"comments":[{"had_liked":false,"id":25193,"user_name":"孙振超","can_delete":false,"product_type":"c1","uid":1101755,"ip_address":"","ucode":"0F9EABC6125350","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg","comment_is_top":false,"comment_ctime":1537264915,"is_pvip":false,"replies":[{"id":9254,"content":"你是第一个认真分析且抓住重点的同学👍👍","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1537341947,"ip_address":"","comment_id":25193,"utype":1}],"discussion_count":10,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"文章中一共列了11个部分，但只有10个人，很明显是不可能是同时开工的，即使能够同时开工也是需要经过几轮迭代才能达到一个比较完善的状态。\n\n依据简单原则和演化原则以及“三个火枪手”的人员分配原则，首先可以做API 网关、配置中心、服务发现、服务路由这4部分，经过一个月的开发+半个月的联调的先让基础框架搭建起来，业务能够运行起来。\n业务上线后，为了保证用户体验和问题跟踪，在保留一两个留守同学的情况下，开始服务容错、服务监控、服务跟踪这几部分的开发，因为这个阶段中可能还要回头修改已完成的部分让这几个部分配合的更好，联调的工作量也多了不少，这个过程大概要2.5月。\n而后随着业务逐渐增多，流量逐渐增加，为避免被黑产“薅羊毛”需要把服务安全部分给完成，同时为了快速响应新的业务需要把接口框架给完成，但此时有些同学会被已完成部分的日常维护、修bug等，这些初步需要两个月时间。\n在这里都完成后，可以开始自动化测试、自动化部署这部分，也按照两个月的时间，这样一轮下来总体需要8个月时间。\n\n经过第一轮后微服务的基础实施是有了，但要真正的运作起来还需要经过几轮的迭代才可以，但此时面对老系统的维护新系统的开发整体的进度会变慢不少，这样一个合格的比较完善的微服务基础设施差不多要两年时间了。","like_count":241},{"had_liked":false,"id":16528,"user_name":"Coder4","can_delete":false,"product_type":"c1","uid":1048453,"ip_address":"","ucode":"71DAC6B3D112DB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcvQzf86HsxOkPcRpibBdCxDW0IK9wel9TmkEhicHPUHPRhzKna8wecDcJcVbNHNSrUMt4GHLxY3iaA/132","comment_is_top":false,"comment_ctime":1532006625,"is_pvip":false,"replies":[{"id":5766,"content":"你这个太牛了，惊为天人啊😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068467,"ip_address":"","comment_id":16528,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"看怎么定义自研了，今年花了1个月，每天半小时代码。半开源，半代码，已经实现了 服务发现，追踪，自动部署，以及后端服务数据库，消息队列，缓存，内存数据库的对接，\n真正熟悉了，花不了太多时间，另外得合理利用轮子。","like_count":62,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424218,"discussion_content":"你是第一个认真分析且抓住重点的同学👍👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537341947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2593173,"avatar":"","nickname":"Geek_c338d5","note":"","ucode":"4D1C27DB8C5CD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370650,"discussion_content":"这样是不行的，各个方面不是分先后，是一套方案，做项目实际开发前这些都要搞明白是怎么搭配运行的，要不然你在上容错时，之前开发的服务都得返回来做支持，开发监控，再来一次修改支持，哪个不合适，全都要调整，团队会有多崩溃？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619493472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019739,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8f/5b/2f16ca95.jpg","nickname":"WuKongCoder","note":"","ucode":"69C990105DEF47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":80700,"discussion_content":"分析的挺有思路的，赞一个","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576167382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1100655,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/6f/c78ef1cf.jpg","nickname":"王二北","note":"","ucode":"D9090E28B3E1F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574419,"discussion_content":"确实分析的很好，给了一个比较清晰思路方向。 服务分配（按三个火枪手原则，一个服务）、先做重点、然后再完善其他服务。具体时间我一时无法估计，但是相关的服务开发先后顺序根据以往的经验，我感觉接口框架、服务发现、服务路由应该是在第一期完成的，要让服务调用先跑起来，接着随着业务服务的增多，相关的自动化部署、配置中心、服务容错要完善起来，然后服务监控、服务跟踪、自动化测试、API网关、服务安全可以根据需要继续完善。一个原则，先能跑起来，然后保证跑的稳当，跑的轻松。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654052402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009644,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erms9qcIFYZ4npgLYPu1QgxQyaXcj64ZBicNVeBRWcYUpCZ9p0BGsrEcX8heibMLCV4Gde4P9pf7PjA/132","nickname":"yanger2004","note":"","ucode":"0A2CD03EF31052","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548229,"discussion_content":"自动化测试部署是不是要优先于安全呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643093345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109389,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ed/8d/377c106a.jpg","nickname":"KW💤","note":"","ucode":"290DD7016F4EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405270,"discussion_content":"两年时间是太长了。不过这一切都没什么具体信息，10个人的开发人力的质素如何，如果是水平比较好的，上面写的每个阶段真不需要那么多时间。编码其实难度不大，主要还是前期设计，但各种平台对微服务的讨论已经十分成熟了，前期设计也不需要自己想太多。另外接口框架以及自动部署是应该提前的，这个是影响到后续开发测试的时间成本的。还有其实架构接口设计的比较好，大部分都是可以并行开发的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634545117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738000,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/9lXZIKuz8crcXuXh8iaMicbQ9zDneNMKXa79S3FfLjfhRp3yT2TI2kCDBicK5Th6SwsWTCdOx2vYYnPLXFmS5EH9Q/132","nickname":"我要学习","note":"","ucode":"0DB701B8D3B990","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381903,"discussion_content":"很明显，兄弟只会纸上谈兵，没做过实际项目。如果需要2年多的时间基本你们项目早就凉了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625283353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095857,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","nickname":"梦倚栏杆","note":"","ucode":"BDEB97F2822445","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367634,"discussion_content":"确实牛逼，针对一个大纲性的问题，能够有理有据的分析，了不起","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618410761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922378,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","nickname":"ACK","note":"","ucode":"C5D09B18DEF151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360131,"discussion_content":"赞一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616376912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350627,"discussion_content":"2.5个月是如何估算的? ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613958781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16685,"user_name":"无痕","can_delete":false,"product_type":"c1","uid":1014760,"ip_address":"","ucode":"DD838980834858","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/e8/9402d347.jpg","comment_is_top":false,"comment_ctime":1532096191,"is_pvip":false,"replies":[{"id":5820,"content":"不符合网关的定位，因为有的业务要鉴权有的不要，放在网关就相当于网关要和业务耦合了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532174409,"ip_address":"","comment_id":16685,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"老师，很多人把oauth2的鉴权放到了网关，这个你怎么看","like_count":21,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420832,"discussion_content":"你这个太牛了，惊为天人啊😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19774,"user_name":"程启","can_delete":false,"product_type":"c1","uid":1019204,"ip_address":"","ucode":"02CDE64EDF9A3C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/44/f3d0017c.jpg","comment_is_top":false,"comment_ctime":1534059495,"is_pvip":false,"replies":[{"id":6916,"content":"我没有service mesh具体实践经验，主要信息来源于网上资料，意见供参考。\n\n1. Istio刚发布1.0版本，spring cloud成熟很多\n2. service mesh中文为服务网格，很形象，说明了更加适合非常多的服务节点，简单来说，如果你只有一两个服务没必要用微服务架构，你只有几十个微服务节点可能也不需要service mesh\n3. service mesh对程序无侵入，这点非常好，但随着spring cloud之类的方案成熟，侵入问题其实不是主要问题\n\n因此，我认为大部分中小公司目前不需要service mesh，能把微服务做好已经很不错了。\n","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1534126887,"ip_address":"","comment_id":19774,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"华仔老师，\n\n之前看您留言提到过service mesh不成熟，中小公司不建议使用。请问看起来最近gcp云平台，主推的k8s加上Istio&#47;envoy实现服务治理，您认为未来方向如何，这个是试用中小型团队的方案吗？感谢解答！","like_count":18,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420900,"discussion_content":"不符合网关的定位，因为有的业务要鉴权有的不要，放在网关就相当于网关要和业务耦合了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532174409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413689,"discussion_content":"同求这个问题，我们目前是放到服务网关中。我们网关分服务网关和api网关，服务网关走认证、鉴权、路由等功能，api网关算是服务网关的裁剪版，只有路由功能。不知各位大佬有新的玩法不","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636544669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046584,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/38/8af56e18.jpg","nickname":"知识没学到","note":"","ucode":"5D819DFFC7AB08","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363970,"discussion_content":"不放在网关，放在业务系统，那么不又冗余了？ 大佬指教； 个人拙见应该作为网关的可配置项","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617336296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1048261,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg","nickname":"正是那朵玫瑰","note":"","ucode":"73D630B654573F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1046584,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/38/8af56e18.jpg","nickname":"知识没学到","note":"","ucode":"5D819DFFC7AB08","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381730,"discussion_content":"是的，我这么觉得，目前也是这样做的，不过配置多了，也有点麻烦，不过除了放在网关，想不出放哪里好？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625195028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363970,"ip_address":"","group_id":0},"score":381730,"extra":""}]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350629,"discussion_content":"做一个配置项不就可以了？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613959029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":17418,"user_name":"成功","can_delete":false,"product_type":"c1","uid":1112099,"ip_address":"","ucode":"954B90AC92E8C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/23/165d2f0e.jpg","comment_is_top":false,"comment_ctime":1532646281,"is_pvip":false,"replies":[{"id":6155,"content":"太乐观，30天就算用spring全家桶，都不可能上线的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532918364,"ip_address":"","comment_id":17418,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"30天左右","like_count":13,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421146,"discussion_content":"太乐观，30天就算用spring全家桶，都不可能上线的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532918364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2550743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","nickname":"ifelse","note":"","ucode":"D0565908C99695","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558117,"discussion_content":"是啊，30天开发出一个不能用的东西差不多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648097946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218162,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/72/a517bf25.jpg","nickname":"方舟勇士","note":"","ucode":"53D3D844B08B92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366071,"discussion_content":"30天能深入理解Spring Cloud全家桶源代码就不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617953724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58268,"user_name":"每天学英语的小沈","can_delete":false,"product_type":"c1","uid":1024179,"ip_address":"","ucode":"C58FA38D8272FA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/b3/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547024029,"is_pvip":false,"replies":[{"id":21467,"content":"都是实战经验总结","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1547429854,"ip_address":"","comment_id":58268,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"微服务这两章讲的非常好，解决了长久以来的困惑","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435980,"discussion_content":"都是实战经验总结","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547429854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102460,"user_name":"水云波","can_delete":false,"product_type":"c1","uid":1463531,"ip_address":"","ucode":"AB1DF268B02901","user_header":"https://static001.geekbang.org/account/avatar/00/16/54/eb/1b981a56.jpg","comment_is_top":false,"comment_ctime":1560224867,"is_pvip":false,"replies":[{"id":37204,"content":"oauth2是第三方授权，API网关是二方授权，二方是公司内不同业务部门的请求方和调用方，第三方授权是外部系统，内部系统，用户这三方","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1560324287,"ip_address":"","comment_id":102460,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"老师，你说API网关的主要包括接入鉴权、权限控制，然后在留言中又说不应该把oauth2的鉴权放到网关。我觉得前后矛盾了，是我对鉴权和权限控制哪里理解的还不到位吗？","like_count":5,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435980,"discussion_content":"都是实战经验总结","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547429854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168914,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1578215659,"is_pvip":false,"replies":[{"id":65488,"content":"内部网络需要与外部隔离，因此内部反而一般黑白名单用的少，因为机器会经常变，黑白名单管理比较麻烦；通常是给每个服务分配服务名称+服务访问密码之类的做法","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1578218795,"ip_address":"","comment_id":168914,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"华哥，你好！请问：服务间的安全策略通过配置中心下发给各节点，一般采用那些安全策略？我了解到的有黑白名单（根据服务名、IP），这个方案比较容易伪造（服务名和IP），还有其它策略吗？","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480372,"discussion_content":"内部网络需要与外部隔离，因此内部反而一般黑白名单用的少，因为机器会经常变，黑白名单管理比较麻烦；通常是给每个服务分配服务名称+服务访问密码之类的做法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578218795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16492,"user_name":"空档滑行","can_delete":false,"product_type":"c1","uid":1091611,"ip_address":"","ucode":"06A6A7F503FAA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg","comment_is_top":false,"comment_ctime":1531983580,"is_pvip":false,"replies":[{"id":5946,"content":"半年只能出最简单的版本，不完善","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425389,"ip_address":"","comment_id":16492,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"工作量需要看这一套框架要应对的服务规模和流量。以100个微服务，接口平均qps100以下做了简单测算，不考虑同城和异地多活，达到基本可用的话\n配置中心，包括配置项管理和推送，和微服务一起打包的客户端\n接口框架，使用http和Json的话，只需要一种语言的解析包\nApi网关，后端服务对接和接入层实现\n服务发现，使用自理式，注册中心服务端加客户端，加注册中心高可用\n服务路由，相对简单\n服务容错，包括熔断和流控等\n服务监控，包括采集和分析\n跟踪，各端trace注入，数据上传，数据查询和计算\n安全，权限控制，配置支持\n按10个高级开发，3人一组的话，大概半年左右","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480372,"discussion_content":"内部网络需要与外部隔离，因此内部反而一般黑白名单用的少，因为机器会经常变，黑白名单管理比较麻烦；通常是给每个服务分配服务名称+服务访问密码之类的做法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578218795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56484,"user_name":"依乐祝","can_delete":false,"product_type":"c1","uid":1320243,"ip_address":"","ucode":"0FAE2C7FE1ECDB","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/33/290fcb42.jpg","comment_is_top":false,"comment_ctime":1546476755,"is_pvip":false,"replies":[{"id":20392,"content":"这样是可以的，网关鉴权仅限于和用户相关的登录态，登录环境等，业务权限还是要业务做","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1546491072,"ip_address":"","comment_id":56484,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"看了这么久第一次留言，老师你好，刚看你说网关层不建议做鉴权！但是如果这样的话，那内部微服务之间如何进行通信呢？我的理解是网关做与url有关的权限处理！而具体的业务服务里面做与数据相关的权限鉴别！这样职业分开！然后内部进行通信的话就可以采用rpc进行高效的交互，而且都是可信的！不知道我的理解是否有误，还请老师指正下哈","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420820,"discussion_content":"半年只能出最简单的版本，不完善","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25193,"user_name":"孙振超","can_delete":false,"product_type":"c1","uid":1101755,"ip_address":"","ucode":"0F9EABC6125350","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg","comment_is_top":false,"comment_ctime":1537264915,"is_pvip":false,"replies":[{"id":9254,"content":"你是第一个认真分析且抓住重点的同学👍👍","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1537341947,"ip_address":"","comment_id":25193,"utype":1}],"discussion_count":10,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"文章中一共列了11个部分，但只有10个人，很明显是不可能是同时开工的，即使能够同时开工也是需要经过几轮迭代才能达到一个比较完善的状态。\n\n依据简单原则和演化原则以及“三个火枪手”的人员分配原则，首先可以做API 网关、配置中心、服务发现、服务路由这4部分，经过一个月的开发+半个月的联调的先让基础框架搭建起来，业务能够运行起来。\n业务上线后，为了保证用户体验和问题跟踪，在保留一两个留守同学的情况下，开始服务容错、服务监控、服务跟踪这几部分的开发，因为这个阶段中可能还要回头修改已完成的部分让这几个部分配合的更好，联调的工作量也多了不少，这个过程大概要2.5月。\n而后随着业务逐渐增多，流量逐渐增加，为避免被黑产“薅羊毛”需要把服务安全部分给完成，同时为了快速响应新的业务需要把接口框架给完成，但此时有些同学会被已完成部分的日常维护、修bug等，这些初步需要两个月时间。\n在这里都完成后，可以开始自动化测试、自动化部署这部分，也按照两个月的时间，这样一轮下来总体需要8个月时间。\n\n经过第一轮后微服务的基础实施是有了，但要真正的运作起来还需要经过几轮的迭代才可以，但此时面对老系统的维护新系统的开发整体的进度会变慢不少，这样一个合格的比较完善的微服务基础设施差不多要两年时间了。","like_count":241,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424218,"discussion_content":"你是第一个认真分析且抓住重点的同学👍👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537341947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2593173,"avatar":"","nickname":"Geek_c338d5","note":"","ucode":"4D1C27DB8C5CD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370650,"discussion_content":"这样是不行的，各个方面不是分先后，是一套方案，做项目实际开发前这些都要搞明白是怎么搭配运行的，要不然你在上容错时，之前开发的服务都得返回来做支持，开发监控，再来一次修改支持，哪个不合适，全都要调整，团队会有多崩溃？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619493472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019739,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8f/5b/2f16ca95.jpg","nickname":"WuKongCoder","note":"","ucode":"69C990105DEF47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":80700,"discussion_content":"分析的挺有思路的，赞一个","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576167382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1100655,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/6f/c78ef1cf.jpg","nickname":"王二北","note":"","ucode":"D9090E28B3E1F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574419,"discussion_content":"确实分析的很好，给了一个比较清晰思路方向。 服务分配（按三个火枪手原则，一个服务）、先做重点、然后再完善其他服务。具体时间我一时无法估计，但是相关的服务开发先后顺序根据以往的经验，我感觉接口框架、服务发现、服务路由应该是在第一期完成的，要让服务调用先跑起来，接着随着业务服务的增多，相关的自动化部署、配置中心、服务容错要完善起来，然后服务监控、服务跟踪、自动化测试、API网关、服务安全可以根据需要继续完善。一个原则，先能跑起来，然后保证跑的稳当，跑的轻松。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654052402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1009644,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erms9qcIFYZ4npgLYPu1QgxQyaXcj64ZBicNVeBRWcYUpCZ9p0BGsrEcX8heibMLCV4Gde4P9pf7PjA/132","nickname":"yanger2004","note":"","ucode":"0A2CD03EF31052","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548229,"discussion_content":"自动化测试部署是不是要优先于安全呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643093345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109389,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ed/8d/377c106a.jpg","nickname":"KW💤","note":"","ucode":"290DD7016F4EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405270,"discussion_content":"两年时间是太长了。不过这一切都没什么具体信息，10个人的开发人力的质素如何，如果是水平比较好的，上面写的每个阶段真不需要那么多时间。编码其实难度不大，主要还是前期设计，但各种平台对微服务的讨论已经十分成熟了，前期设计也不需要自己想太多。另外接口框架以及自动部署是应该提前的，这个是影响到后续开发测试的时间成本的。还有其实架构接口设计的比较好，大部分都是可以并行开发的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634545117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738000,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/9lXZIKuz8crcXuXh8iaMicbQ9zDneNMKXa79S3FfLjfhRp3yT2TI2kCDBicK5Th6SwsWTCdOx2vYYnPLXFmS5EH9Q/132","nickname":"我要学习","note":"","ucode":"0DB701B8D3B990","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381903,"discussion_content":"很明显，兄弟只会纸上谈兵，没做过实际项目。如果需要2年多的时间基本你们项目早就凉了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625283353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095857,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","nickname":"梦倚栏杆","note":"","ucode":"BDEB97F2822445","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367634,"discussion_content":"确实牛逼，针对一个大纲性的问题，能够有理有据的分析，了不起","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618410761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922378,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","nickname":"ACK","note":"","ucode":"C5D09B18DEF151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360131,"discussion_content":"赞一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616376912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350627,"discussion_content":"2.5个月是如何估算的? ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613958781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16528,"user_name":"Coder4","can_delete":false,"product_type":"c1","uid":1048453,"ip_address":"","ucode":"71DAC6B3D112DB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcvQzf86HsxOkPcRpibBdCxDW0IK9wel9TmkEhicHPUHPRhzKna8wecDcJcVbNHNSrUMt4GHLxY3iaA/132","comment_is_top":false,"comment_ctime":1532006625,"is_pvip":false,"replies":[{"id":5766,"content":"你这个太牛了，惊为天人啊😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068467,"ip_address":"","comment_id":16528,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"看怎么定义自研了，今年花了1个月，每天半小时代码。半开源，半代码，已经实现了 服务发现，追踪，自动部署，以及后端服务数据库，消息队列，缓存，内存数据库的对接，\n真正熟悉了，花不了太多时间，另外得合理利用轮子。","like_count":62,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420832,"discussion_content":"你这个太牛了，惊为天人啊😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16685,"user_name":"无痕","can_delete":false,"product_type":"c1","uid":1014760,"ip_address":"","ucode":"DD838980834858","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/e8/9402d347.jpg","comment_is_top":false,"comment_ctime":1532096191,"is_pvip":false,"replies":[{"id":5820,"content":"不符合网关的定位，因为有的业务要鉴权有的不要，放在网关就相当于网关要和业务耦合了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532174409,"ip_address":"","comment_id":16685,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"老师，很多人把oauth2的鉴权放到了网关，这个你怎么看","like_count":21,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420900,"discussion_content":"不符合网关的定位，因为有的业务要鉴权有的不要，放在网关就相当于网关要和业务耦合了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532174409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413689,"discussion_content":"同求这个问题，我们目前是放到服务网关中。我们网关分服务网关和api网关，服务网关走认证、鉴权、路由等功能，api网关算是服务网关的裁剪版，只有路由功能。不知各位大佬有新的玩法不","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636544669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046584,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/38/8af56e18.jpg","nickname":"知识没学到","note":"","ucode":"5D819DFFC7AB08","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363970,"discussion_content":"不放在网关，放在业务系统，那么不又冗余了？ 大佬指教； 个人拙见应该作为网关的可配置项","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617336296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1048261,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg","nickname":"正是那朵玫瑰","note":"","ucode":"73D630B654573F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1046584,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/38/8af56e18.jpg","nickname":"知识没学到","note":"","ucode":"5D819DFFC7AB08","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381730,"discussion_content":"是的，我这么觉得，目前也是这样做的，不过配置多了，也有点麻烦，不过除了放在网关，想不出放哪里好？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625195028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363970,"ip_address":"","group_id":0},"score":381730,"extra":""}]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350629,"discussion_content":"做一个配置项不就可以了？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613959029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19774,"user_name":"程启","can_delete":false,"product_type":"c1","uid":1019204,"ip_address":"","ucode":"02CDE64EDF9A3C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/44/f3d0017c.jpg","comment_is_top":false,"comment_ctime":1534059495,"is_pvip":false,"replies":[{"id":6916,"content":"我没有service mesh具体实践经验，主要信息来源于网上资料，意见供参考。\n\n1. Istio刚发布1.0版本，spring cloud成熟很多\n2. service mesh中文为服务网格，很形象，说明了更加适合非常多的服务节点，简单来说，如果你只有一两个服务没必要用微服务架构，你只有几十个微服务节点可能也不需要service mesh\n3. service mesh对程序无侵入，这点非常好，但随着spring cloud之类的方案成熟，侵入问题其实不是主要问题\n\n因此，我认为大部分中小公司目前不需要service mesh，能把微服务做好已经很不错了。\n","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1534126887,"ip_address":"","comment_id":19774,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"华仔老师，\n\n之前看您留言提到过service mesh不成熟，中小公司不建议使用。请问看起来最近gcp云平台，主推的k8s加上Istio&#47;envoy实现服务治理，您认为未来方向如何，这个是试用中小型团队的方案吗？感谢解答！","like_count":18,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421979,"discussion_content":"我没有service mesh具体实践经验，主要信息来源于网上资料，意见供参考。\n\n1. Istio刚发布1.0版本，spring cloud成熟很多\n2. service mesh中文为服务网格，很形象，说明了更加适合非常多的服务节点，简单来说，如果你只有一两个服务没必要用微服务架构，你只有几十个微服务节点可能也不需要service mesh\n3. service mesh对程序无侵入，这点非常好，但随着spring cloud之类的方案成熟，侵入问题其实不是主要问题\n\n因此，我认为大部分中小公司目前不需要service mesh，能把微服务做好已经很不错了。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534126887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":17418,"user_name":"成功","can_delete":false,"product_type":"c1","uid":1112099,"ip_address":"","ucode":"954B90AC92E8C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/23/165d2f0e.jpg","comment_is_top":false,"comment_ctime":1532646281,"is_pvip":false,"replies":[{"id":6155,"content":"太乐观，30天就算用spring全家桶，都不可能上线的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532918364,"ip_address":"","comment_id":17418,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"30天左右","like_count":13,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421979,"discussion_content":"我没有service mesh具体实践经验，主要信息来源于网上资料，意见供参考。\n\n1. Istio刚发布1.0版本，spring cloud成熟很多\n2. service mesh中文为服务网格，很形象，说明了更加适合非常多的服务节点，简单来说，如果你只有一两个服务没必要用微服务架构，你只有几十个微服务节点可能也不需要service mesh\n3. service mesh对程序无侵入，这点非常好，但随着spring cloud之类的方案成熟，侵入问题其实不是主要问题\n\n因此，我认为大部分中小公司目前不需要service mesh，能把微服务做好已经很不错了。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534126887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58268,"user_name":"每天学英语的小沈","can_delete":false,"product_type":"c1","uid":1024179,"ip_address":"","ucode":"C58FA38D8272FA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/b3/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1547024029,"is_pvip":false,"replies":[{"id":21467,"content":"都是实战经验总结","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1547429854,"ip_address":"","comment_id":58268,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"微服务这两章讲的非常好，解决了长久以来的困惑","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421146,"discussion_content":"太乐观，30天就算用spring全家桶，都不可能上线的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532918364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2550743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","nickname":"ifelse","note":"","ucode":"D0565908C99695","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558117,"discussion_content":"是啊，30天开发出一个不能用的东西差不多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648097946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218162,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/72/a517bf25.jpg","nickname":"方舟勇士","note":"","ucode":"53D3D844B08B92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366071,"discussion_content":"30天能深入理解Spring Cloud全家桶源代码就不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617953724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102460,"user_name":"水云波","can_delete":false,"product_type":"c1","uid":1463531,"ip_address":"","ucode":"AB1DF268B02901","user_header":"https://static001.geekbang.org/account/avatar/00/16/54/eb/1b981a56.jpg","comment_is_top":false,"comment_ctime":1560224867,"is_pvip":false,"replies":[{"id":37204,"content":"oauth2是第三方授权，API网关是二方授权，二方是公司内不同业务部门的请求方和调用方，第三方授权是外部系统，内部系统，用户这三方","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1560324287,"ip_address":"","comment_id":102460,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"老师，你说API网关的主要包括接入鉴权、权限控制，然后在留言中又说不应该把oauth2的鉴权放到网关。我觉得前后矛盾了，是我对鉴权和权限控制哪里理解的还不到位吗？","like_count":5,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453435,"discussion_content":"oauth2是第三方授权，API网关是二方授权，二方是公司内不同业务部门的请求方和调用方，第三方授权是外部系统，内部系统，用户这三方","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560324287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1498274,"avatar":"https://static001.geekbang.org/account/avatar/00/16/dc/a2/74119fb0.jpg","nickname":"马马","note":"","ucode":"4ED39D89D4031F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620897,"discussion_content":"6","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686650932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168914,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1578215659,"is_pvip":false,"replies":[{"id":65488,"content":"内部网络需要与外部隔离，因此内部反而一般黑白名单用的少，因为机器会经常变，黑白名单管理比较麻烦；通常是给每个服务分配服务名称+服务访问密码之类的做法","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1578218795,"ip_address":"","comment_id":168914,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"华哥，你好！请问：服务间的安全策略通过配置中心下发给各节点，一般采用那些安全策略？我了解到的有黑白名单（根据服务名、IP），这个方案比较容易伪造（服务名和IP），还有其它策略吗？","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453435,"discussion_content":"oauth2是第三方授权，API网关是二方授权，二方是公司内不同业务部门的请求方和调用方，第三方授权是外部系统，内部系统，用户这三方","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560324287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1498274,"avatar":"https://static001.geekbang.org/account/avatar/00/16/dc/a2/74119fb0.jpg","nickname":"马马","note":"","ucode":"4ED39D89D4031F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620897,"discussion_content":"6","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686650932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16492,"user_name":"空档滑行","can_delete":false,"product_type":"c1","uid":1091611,"ip_address":"","ucode":"06A6A7F503FAA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg","comment_is_top":false,"comment_ctime":1531983580,"is_pvip":false,"replies":[{"id":5946,"content":"半年只能出最简单的版本，不完善","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425389,"ip_address":"","comment_id":16492,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"工作量需要看这一套框架要应对的服务规模和流量。以100个微服务，接口平均qps100以下做了简单测算，不考虑同城和异地多活，达到基本可用的话\n配置中心，包括配置项管理和推送，和微服务一起打包的客户端\n接口框架，使用http和Json的话，只需要一种语言的解析包\nApi网关，后端服务对接和接入层实现\n服务发现，使用自理式，注册中心服务端加客户端，加注册中心高可用\n服务路由，相对简单\n服务容错，包括熔断和流控等\n服务监控，包括采集和分析\n跟踪，各端trace注入，数据上传，数据查询和计算\n安全，权限控制，配置支持\n按10个高级开发，3人一组的话，大概半年左右","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420820,"discussion_content":"半年只能出最简单的版本，不完善","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56484,"user_name":"依乐祝","can_delete":false,"product_type":"c1","uid":1320243,"ip_address":"","ucode":"0FAE2C7FE1ECDB","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/33/290fcb42.jpg","comment_is_top":false,"comment_ctime":1546476755,"is_pvip":false,"replies":[{"id":20392,"content":"这样是可以的，网关鉴权仅限于和用户相关的登录态，登录环境等，业务权限还是要业务做","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1546491072,"ip_address":"","comment_id":56484,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"看了这么久第一次留言，老师你好，刚看你说网关层不建议做鉴权！但是如果这样的话，那内部微服务之间如何进行通信呢？我的理解是网关做与url有关的权限处理！而具体的业务服务里面做与数据相关的权限鉴别！这样职业分开！然后内部进行通信的话就可以采用rpc进行高效的交互，而且都是可信的！不知道我的理解是否有误，还请老师指正下哈","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435064,"discussion_content":"这样是可以的，网关鉴权仅限于和用户相关的登录态，登录环境等，业务权限还是要业务做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546491072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35817,"user_name":"AmosWooo","can_delete":false,"product_type":"c1","uid":1191605,"ip_address":"","ucode":"481780ABC37013","user_header":"https://static001.geekbang.org/account/avatar/00/12/2e/b5/5f1c7ae1.jpg","comment_is_top":false,"comment_ctime":1540814427,"is_pvip":false,"replies":[{"id":12754,"content":"网关是针对外部系统的认证授权，内部系统如果要做权限控制，一般放在配置中心做，因为独立做内部的认证系统代价比较高","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1540820971,"ip_address":"","comment_id":35817,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"李老师，请教个问题: API网关提供认证授权功能，那请求穿透API网关这一层之后，后续的业务流程依然会涉及在多个子服务之间交互，此时如何授权呢?难道需要反向去API网关查询吗? 谢谢回答","like_count":3},{"had_liked":false,"id":16461,"user_name":"Kyle","can_delete":false,"product_type":"c1","uid":1106079,"ip_address":"","ucode":"44198A0BEC5FB2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/9f/9259a6b9.jpg","comment_is_top":false,"comment_ctime":1531965145,"is_pvip":false,"replies":[{"id":5948,"content":"一年可以，半载不行😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425491,"ip_address":"","comment_id":16461,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"Dubbo弄了这么久，配套的基础设施都还没有。高级的水平也有高有低。总觉得怎么也要个一年半载吧。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427674,"discussion_content":"网关是针对外部系统的认证授权，内部系统如果要做权限控制，一般放在配置中心做，因为独立做内部的认证系统代价比较高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540820971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320912,"user_name":"雪碧心拔凉","can_delete":false,"product_type":"c1","uid":1161522,"ip_address":"","ucode":"D13EEBAA0F443B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","comment_is_top":false,"comment_ctime":1636554824,"is_pvip":false,"replies":[{"id":116455,"content":"服务安全策略本身是没有通用的做法，不同业务和不同公司要求不同，技术上目前用的比较多的是Spring Security，可以基于Spring Security来做二次定制开发","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1636606313,"ip_address":"","comment_id":320912,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"服务安全的实现能详细讲讲吗  或者哪里有文档参考","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420805,"discussion_content":"一年可以，半载不行😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306736,"user_name":"大叶枫","can_delete":false,"product_type":"c1","uid":1153702,"ip_address":"","ucode":"224AC5533889AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/a6/3bddb98c.jpg","comment_is_top":false,"comment_ctime":1628686093,"is_pvip":false,"replies":[{"id":111110,"content":"节奏和步骤没问题，投入的人有点乐观，这类基础设施做到稳定的话，细节很多。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1628729823,"ip_address":"","comment_id":306736,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"API网关：外部系统访问接口和协议、包含接入鉴权、权限控制、传输加密、请求路由、路由控制。\n配置中心：包含配置版本管理、增删改查配置、节点管理、配置同步、配置推送。\n服务发现：自动化注册和发现服务，提升节点自动化运维能力。\n服务路由：一般集成到服务发现里实现路由算法，常见的有随机路由、轮训路由、最小压力路由、最小连接数路由。\n服务容错：包括请求重试、流控和服务隔离，一般服务容错会集成到服务发现和服务路由系统中。\n服务监控：宏观实时采集信息并分析，故障预警能力，一般作为独立系统建设。\n服务跟踪：微观实时采集记录服务调用的链路信息，记录完整的服务链路路径，后置定位使用。\n服务安全：分接入、数据、传输三个部分，一般集成到配置中心实现安全策略。\n自动化测试：代码级单元测试、单系统级集成测试、系统间的接口测试等自动化测试。\n自动化部署：包含微服务版本管理、资源管理（机器、虚拟机）、部署操作、回退操作等功能\n\n故建设优先级，先做业务运行的基础建设、后做业务运行的体验建设、再做业务可持续维护的建设分三个阶段。\n业务运行的基础建设（2个月）：完成配置中心、服务发现和路由建设，投入兵力6个人，相互主备，剩余四个人做API网关在细分投入。\n业务运行的体验建设（4个月）：服务容错（2人）、监控（2人）、跟踪（2人）、安全（1人），除了监控外，其他三者集成到已建设的服务发现（1人）。维护老系统（1~2人）\n业务可持续维护建设（6个月）：自动化测试、自动化部署。以DevOps相关的配套工具围绕测试和部署体系建设。已建设的8块内容投入4个人做维护运转，增量业务支持投入2人。剩余4人做自动化测试和部署。\n\n大概我会这么安排。。\n\n","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530162,"discussion_content":"服务安全策略本身是没有通用的做法，不同业务和不同公司要求不同，技术上目前用的比较多的是Spring Security，可以基于Spring Security来做二次定制开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636606313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235559,"user_name":"Han","can_delete":false,"product_type":"c1","uid":1122349,"ip_address":"","ucode":"280808D4F641AA","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/2d/dfa5bec8.jpg","comment_is_top":false,"comment_ctime":1595085492,"is_pvip":false,"replies":[{"id":87414,"content":"大公司都是自己做😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1595474976,"ip_address":"","comment_id":235559,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"您说的自研微服务基础设施，该不会是自己从零开始造全部轮子吧？ 不太符合现实，也没几家公司会这样操作吧？ 有这么多现成的微服务框架工具，大多数人都是直接拿来用。🌝","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524894,"discussion_content":"节奏和步骤没问题，投入的人有点乐观，这类基础设施做到稳定的话，细节很多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628729823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16523,"user_name":"mayer","can_delete":false,"product_type":"c1","uid":1110077,"ip_address":"","ucode":"241E09471760A4","user_header":"","comment_is_top":false,"comment_ctime":1532005355,"is_pvip":false,"replies":[{"id":5945,"content":"太乐观了😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425360,"ip_address":"","comment_id":16523,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"这10个人分别有相关经验的话，不考虑复杂的业务逻辑实现调试，整个框架搭起来可应用，应该在3个月左右可以完成，条件是高级工程师真的高级，哈哈😄","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501766,"discussion_content":"大公司都是自己做😂","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595474976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413695,"discussion_content":"也不都是直接用，每个组件都是需要改善的，毕竟开源产品到了一个新的公司不一定能适应。我们是用的开源的组件基本上每个组件都有包装过，包括spring框架","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636545246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348999,"user_name":"| ~浑蛋~","can_delete":false,"product_type":"c1","uid":3024820,"ip_address":"","ucode":"B6904B44DFA805","user_header":"https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg","comment_is_top":false,"comment_ctime":1655632719,"is_pvip":false,"replies":[{"id":127177,"content":"那你们团队的实力应该很厉害，2年能把这一堆东西搞稳定不容易 ：）","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1655951569,"ip_address":"","comment_id":348999,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"我所在的小组就是做这些基础设施，主力是三个高级工程师加上我这个菜鸟，已经做了两年，API网关，服务发现，配置中心，接口框架基本稳定了，现在集中精力在服务监控和链路追踪这一块。自动化部署是专门负责devops的小组做。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420829,"discussion_content":"太乐观了😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309288,"user_name":"只因","can_delete":false,"product_type":"c1","uid":2095026,"ip_address":"","ucode":"79DB151C0BFC63","user_header":"https://static001.geekbang.org/account/avatar/00/1f/f7/b2/b9d2d7d8.jpg","comment_is_top":false,"comment_ctime":1630032018,"is_pvip":false,"replies":[{"id":112058,"content":"专栏成文是2018年，那个时候service mesh刚出来","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1630126080,"ip_address":"","comment_id":309288,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"服务发现还有这种ServiceMesh","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577153,"discussion_content":"那你们团队的实力应该很厉害，2年能把这一堆东西搞稳定不容易 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655951569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263423,"user_name":"艺超(鲁鸣)","can_delete":false,"product_type":"c1","uid":1029436,"ip_address":"","ucode":"7F749FA543E0F1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","comment_is_top":false,"comment_ctime":1606130662,"is_pvip":false,"replies":[{"id":95619,"content":"网关上用插件比较好，例如Nginx的Lua脚本，或者加个Node.js专门做聚合接口，然后提供给网关","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606182509,"ip_address":"","comment_id":263423,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"一直有一个疑问，就是对于web页面的某个功能，可能同时需要几个微服务一起完成，为了避免网络传输，会合为一个接口；目前看有两个方案，1：由其中一个微服务统一完成，然后注册到网关给web使用；2：由网关负责完成，也就是类似BFF这种吧，老师有什么好的建议吗？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510185,"discussion_content":"网关上用插件比较好，例如Nginx的Lua脚本，或者加个Node.js专门做聚合接口，然后提供给网关","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606182509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187894,"user_name":"草上飞蝶号🙈","can_delete":false,"product_type":"c1","uid":1604231,"ip_address":"","ucode":"DF06A06BE61317","user_header":"https://static001.geekbang.org/account/avatar/00/18/7a/87/668a4f38.jpg","comment_is_top":false,"comment_ctime":1584268807,"is_pvip":false,"replies":[{"id":72852,"content":"这个投入还是很大的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1584424973,"ip_address":"","comment_id":187894,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"我们将原有系统从传统架构调整为为服务，基本按照spring boot全家桶来搞，拆分成了接近20个微服务，做的过程中微服务尤其表的划分以及互相之间调用，十分头疼。涉及代码100万。整个开发加测试耗时10个月，人员100人左右。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510185,"discussion_content":"网关上用插件比较好，例如Nginx的Lua脚本，或者加个Node.js专门做聚合接口，然后提供给网关","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606182509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35817,"user_name":"AmosWooo","can_delete":false,"product_type":"c1","uid":1191605,"ip_address":"","ucode":"481780ABC37013","user_header":"https://static001.geekbang.org/account/avatar/00/12/2e/b5/5f1c7ae1.jpg","comment_is_top":false,"comment_ctime":1540814427,"is_pvip":false,"replies":[{"id":12754,"content":"网关是针对外部系统的认证授权，内部系统如果要做权限控制，一般放在配置中心做，因为独立做内部的认证系统代价比较高","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1540820971,"ip_address":"","comment_id":35817,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"李老师，请教个问题: API网关提供认证授权功能，那请求穿透API网关这一层之后，后续的业务流程依然会涉及在多个子服务之间交互，此时如何授权呢?难道需要反向去API网关查询吗? 谢谢回答","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427674,"discussion_content":"网关是针对外部系统的认证授权，内部系统如果要做权限控制，一般放在配置中心做，因为独立做内部的认证系统代价比较高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540820971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16461,"user_name":"Kyle","can_delete":false,"product_type":"c1","uid":1106079,"ip_address":"","ucode":"44198A0BEC5FB2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/9f/9259a6b9.jpg","comment_is_top":false,"comment_ctime":1531965145,"is_pvip":false,"replies":[{"id":5948,"content":"一年可以，半载不行😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425491,"ip_address":"","comment_id":16461,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"Dubbo弄了这么久，配套的基础设施都还没有。高级的水平也有高有低。总觉得怎么也要个一年半载吧。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420805,"discussion_content":"一年可以，半载不行😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320912,"user_name":"雪碧心拔凉","can_delete":false,"product_type":"c1","uid":1161522,"ip_address":"","ucode":"D13EEBAA0F443B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","comment_is_top":false,"comment_ctime":1636554824,"is_pvip":false,"replies":[{"id":116455,"content":"服务安全策略本身是没有通用的做法，不同业务和不同公司要求不同，技术上目前用的比较多的是Spring Security，可以基于Spring Security来做二次定制开发","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1636606313,"ip_address":"","comment_id":320912,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"服务安全的实现能详细讲讲吗  或者哪里有文档参考","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530162,"discussion_content":"服务安全策略本身是没有通用的做法，不同业务和不同公司要求不同，技术上目前用的比较多的是Spring Security，可以基于Spring Security来做二次定制开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636606313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306736,"user_name":"大叶枫","can_delete":false,"product_type":"c1","uid":1153702,"ip_address":"","ucode":"224AC5533889AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/a6/3bddb98c.jpg","comment_is_top":false,"comment_ctime":1628686093,"is_pvip":false,"replies":[{"id":111110,"content":"节奏和步骤没问题，投入的人有点乐观，这类基础设施做到稳定的话，细节很多。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1628729823,"ip_address":"","comment_id":306736,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"API网关：外部系统访问接口和协议、包含接入鉴权、权限控制、传输加密、请求路由、路由控制。\n配置中心：包含配置版本管理、增删改查配置、节点管理、配置同步、配置推送。\n服务发现：自动化注册和发现服务，提升节点自动化运维能力。\n服务路由：一般集成到服务发现里实现路由算法，常见的有随机路由、轮训路由、最小压力路由、最小连接数路由。\n服务容错：包括请求重试、流控和服务隔离，一般服务容错会集成到服务发现和服务路由系统中。\n服务监控：宏观实时采集信息并分析，故障预警能力，一般作为独立系统建设。\n服务跟踪：微观实时采集记录服务调用的链路信息，记录完整的服务链路路径，后置定位使用。\n服务安全：分接入、数据、传输三个部分，一般集成到配置中心实现安全策略。\n自动化测试：代码级单元测试、单系统级集成测试、系统间的接口测试等自动化测试。\n自动化部署：包含微服务版本管理、资源管理（机器、虚拟机）、部署操作、回退操作等功能\n\n故建设优先级，先做业务运行的基础建设、后做业务运行的体验建设、再做业务可持续维护的建设分三个阶段。\n业务运行的基础建设（2个月）：完成配置中心、服务发现和路由建设，投入兵力6个人，相互主备，剩余四个人做API网关在细分投入。\n业务运行的体验建设（4个月）：服务容错（2人）、监控（2人）、跟踪（2人）、安全（1人），除了监控外，其他三者集成到已建设的服务发现（1人）。维护老系统（1~2人）\n业务可持续维护建设（6个月）：自动化测试、自动化部署。以DevOps相关的配套工具围绕测试和部署体系建设。已建设的8块内容投入4个人做维护运转，增量业务支持投入2人。剩余4人做自动化测试和部署。\n\n大概我会这么安排。。\n\n","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524894,"discussion_content":"节奏和步骤没问题，投入的人有点乐观，这类基础设施做到稳定的话，细节很多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628729823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235559,"user_name":"Han","can_delete":false,"product_type":"c1","uid":1122349,"ip_address":"","ucode":"280808D4F641AA","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/2d/dfa5bec8.jpg","comment_is_top":false,"comment_ctime":1595085492,"is_pvip":false,"replies":[{"id":87414,"content":"大公司都是自己做😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1595474976,"ip_address":"","comment_id":235559,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"您说的自研微服务基础设施，该不会是自己从零开始造全部轮子吧？ 不太符合现实，也没几家公司会这样操作吧？ 有这么多现成的微服务框架工具，大多数人都是直接拿来用。🌝","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501766,"discussion_content":"大公司都是自己做😂","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595474976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413695,"discussion_content":"也不都是直接用，每个组件都是需要改善的，毕竟开源产品到了一个新的公司不一定能适应。我们是用的开源的组件基本上每个组件都有包装过，包括spring框架","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636545246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16523,"user_name":"mayer","can_delete":false,"product_type":"c1","uid":1110077,"ip_address":"","ucode":"241E09471760A4","user_header":"","comment_is_top":false,"comment_ctime":1532005355,"is_pvip":false,"replies":[{"id":5945,"content":"太乐观了😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425360,"ip_address":"","comment_id":16523,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"这10个人分别有相关经验的话，不考虑复杂的业务逻辑实现调试，整个框架搭起来可应用，应该在3个月左右可以完成，条件是高级工程师真的高级，哈哈😄","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420829,"discussion_content":"太乐观了😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348999,"user_name":"| ~浑蛋~","can_delete":false,"product_type":"c1","uid":3024820,"ip_address":"","ucode":"B6904B44DFA805","user_header":"https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg","comment_is_top":false,"comment_ctime":1655632719,"is_pvip":false,"replies":[{"id":127177,"content":"那你们团队的实力应该很厉害，2年能把这一堆东西搞稳定不容易 ：）","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1655951569,"ip_address":"","comment_id":348999,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"我所在的小组就是做这些基础设施，主力是三个高级工程师加上我这个菜鸟，已经做了两年，API网关，服务发现，配置中心，接口框架基本稳定了，现在集中精力在服务监控和链路追踪这一块。自动化部署是专门负责devops的小组做。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577153,"discussion_content":"那你们团队的实力应该很厉害，2年能把这一堆东西搞稳定不容易 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655951569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309288,"user_name":"只因","can_delete":false,"product_type":"c1","uid":2095026,"ip_address":"","ucode":"79DB151C0BFC63","user_header":"https://static001.geekbang.org/account/avatar/00/1f/f7/b2/b9d2d7d8.jpg","comment_is_top":false,"comment_ctime":1630032018,"is_pvip":false,"replies":[{"id":112058,"content":"专栏成文是2018年，那个时候service mesh刚出来","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1630126080,"ip_address":"","comment_id":309288,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"服务发现还有这种ServiceMesh","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525812,"discussion_content":"专栏成文是2018年，那个时候service mesh刚出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630126080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263423,"user_name":"艺超(鲁鸣)","can_delete":false,"product_type":"c1","uid":1029436,"ip_address":"","ucode":"7F749FA543E0F1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","comment_is_top":false,"comment_ctime":1606130662,"is_pvip":false,"replies":[{"id":95619,"content":"网关上用插件比较好，例如Nginx的Lua脚本，或者加个Node.js专门做聚合接口，然后提供给网关","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606182509,"ip_address":"","comment_id":263423,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"一直有一个疑问，就是对于web页面的某个功能，可能同时需要几个微服务一起完成，为了避免网络传输，会合为一个接口；目前看有两个方案，1：由其中一个微服务统一完成，然后注册到网关给web使用；2：由网关负责完成，也就是类似BFF这种吧，老师有什么好的建议吗？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525812,"discussion_content":"专栏成文是2018年，那个时候service mesh刚出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630126080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187894,"user_name":"草上飞蝶号🙈","can_delete":false,"product_type":"c1","uid":1604231,"ip_address":"","ucode":"DF06A06BE61317","user_header":"https://static001.geekbang.org/account/avatar/00/18/7a/87/668a4f38.jpg","comment_is_top":false,"comment_ctime":1584268807,"is_pvip":false,"replies":[{"id":72852,"content":"这个投入还是很大的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1584424973,"ip_address":"","comment_id":187894,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"我们将原有系统从传统架构调整为为服务，基本按照spring boot全家桶来搞，拆分成了接近20个微服务，做的过程中微服务尤其表的划分以及互相之间调用，十分头疼。涉及代码100万。整个开发加测试耗时10个月，人员100人左右。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487284,"discussion_content":"这个投入还是很大的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584424973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186954,"user_name":"谭方敏","can_delete":false,"product_type":"c1","uid":1710960,"ip_address":"","ucode":"728DC7ECB7C902","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/70/547042ee.jpg","comment_is_top":false,"comment_ctime":1583978806,"is_pvip":false,"replies":[{"id":72857,"content":"差不多，半年落地，半年稳定","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1584425390,"ip_address":"","comment_id":186954,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"自动化测试（代码级单元测试，单个系统级系统测试，接口间接口测试）\n自动化部署（版本管理，资源管理（机器管理，虚拟机管理），部署操作，回退操作）\n配置中心（配置版本管理，节点管理，配置同步，配置推送，增删查改操作）\n服务监控(宏观，考察请求次数，响应平均时间，响应最高值，减少故障处理时间，针对故障提前预警)\n服务跟踪（微观，某次请求的发起请求记录，响应时间，响应错误码，请求参数等）\n服务安全（接入安全，数据安全，传输安全）\n接口框架（对外用http&#47;json方式，对内用rpc方式）\napi网关（唯一提供外部访问的，接入鉴权（是否接入），权限控制（是否能访问），流量控制，请求路由，传输加密）\n服务发现（自主式（每个微服务之间自己完成服务发现），代理式（每个微服务之间借助负载均衡系统完成服务发现））\n服务路由（随机，轮询，最小压力，最小连接）\n服务容错（请求重试，流式和服务隔离）\n\n根据简单和演化原则，自研项目可以从最简单的开始，比如从服务发现，服务路由，服务容错，以及接口框架和api网关出发，等迭代完毕后再跟进自动化测试，自动化部署，配置中心，服务监控，服务跟踪，服务安全，按照逐步迭代，不断演化的思路。至于预测时间，真不好预测，之前做一个基于旧业务的新框架翻新，前前后后花了半年多才出雏形，后面再花半年才稳定下来。还不包括踩坑什么的。","like_count":1},{"had_liked":false,"id":100074,"user_name":"郑佳宁","can_delete":false,"product_type":"c1","uid":1389623,"ip_address":"","ucode":"D4221F5BF8EBD0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqsFicCU21tKou4mFvfy5fOn9sfNYHNDfna8eozeVOLGs58gcAu8v2IIVFRsM6R8DIuWSVAjzubh8A/132","comment_is_top":false,"comment_ctime":1559437804,"is_pvip":false,"replies":[{"id":36282,"content":"小厂用spring全家桶，大厂为了可控和按需定制，一般会自己做","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1559617045,"ip_address":"","comment_id":100074,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"基础设施为啥要自研呢？有没有现成的成熟框架？如果有，不知道后面作者会不会有对比分析？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486936,"discussion_content":"差不多，半年落地，半年稳定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584425390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1293551,"avatar":"https://static001.geekbang.org/account/avatar/00/13/bc/ef/98550b85.jpg","nickname":"云彩＆草原","note":"","ucode":"6AEA686202F1CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558415,"discussion_content":"m","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648291327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21600,"user_name":"文竹","can_delete":false,"product_type":"c1","uid":1103167,"ip_address":"","ucode":"74413B1975976B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/3f/80bf4841.jpg","comment_is_top":false,"comment_ctime":1535187268,"is_pvip":false,"replies":[{"id":7700,"content":"你还是太乐观了😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1535276452,"ip_address":"","comment_id":21600,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"自动化测试：主要支持接口测试，可以使用robot framework，无需额外人天。\n\n自动化部署：使用开源jenkins进行构建，无需人天。\n\n配置中心：需要支持的功能有服务节点管理，节点配置管理，配置版本管理，配置变更通知。\n实现这些功能估计需要30人天。\n\n接口框架：采用HTTP Rest Json形式，需要指定规范的json格式，目前Json解析能很好地支持于各语言，所以无需提供客户端库。由于主要工作在于规范化，估计需7人天。\n\nAPI网关：可以使用开源的API网关，比如Kong。Kong也支持插件化扩展功能。这里估计需7人天。\n\n服务发现、路由、容错：要实现这三个功能，还要实现服务注册中心。估计60人天。\n\n服务监控：收集信息并分析，由于数据量比较多，估计需要30人天。\n\n服务跟踪：是服务监控的升级版，特点也是数据量大，估计需要30人天。\n\n服务安全：这里需要做一个通用的认证授权方案。估计需要30人天。\n\n综合以上，似乎一个人半年左右就能完成初版。10个人同时进行的话，估计一个月左右。总觉得估计的时间比较紧，如果根据更细腻度的功能划分的话，可能在2个月左右。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422759,"discussion_content":"你还是太乐观了😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535276452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16689,"user_name":"小喵喵","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1532097429,"is_pvip":false,"replies":[{"id":5819,"content":"可以自己搭建，优点是灵活，有问题处理起来快，缺点就是投入大，也可以spring全家桶，优缺点基本倒过来","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532174345,"ip_address":"","comment_id":16689,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"微服务的基础设施需要程序猿写代码来实现吗？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420901,"discussion_content":"可以自己搭建，优点是灵活，有问题处理起来快，缺点就是投入大，也可以spring全家桶，优缺点基本倒过来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532174345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16466,"user_name":"凡凡","can_delete":false,"product_type":"c1","uid":1056142,"ip_address":"","ucode":"134C1E1E6B22BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/8e/0a546871.jpg","comment_is_top":false,"comment_ctime":1531965974,"is_pvip":false,"replies":[{"id":5947,"content":"这类微服务做出基本功能9个月可以，做完善需要耗时更长","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425469,"ip_address":"","comment_id":16466,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"按照以往了解的基础架构部的开发速度来看，而且文中涉及的基础设施都有开源实现可以借鉴，一个基础设施从调研（开源系统代码review），到设计，再到开发，再到小流量接入，全公司推广，一个基础设施3个人大概5到6个月时间，如果去掉小流量和推广阶段，估计也需要3到4个月。\n\n文中说到的前10个微服务，按照单个3*3人月算下来的话，理想情况下，需要9个月。\n\n当然，这里没有考虑严格的测试和压力测试，否则每个系统，需要增加至少一个人月的周期。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420807,"discussion_content":"这类微服务做出基本功能9个月可以，做完善需要耗时更长","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379441,"user_name":"鲁米","can_delete":false,"product_type":"c1","uid":1574008,"ip_address":"北京","ucode":"F8F23431723F25","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/78/37b46ba6.jpg","comment_is_top":false,"comment_ctime":1691979755,"is_pvip":false,"replies":[{"id":138240,"content":"不会一年只做一个项目的，会分成多个时间点和里程碑\n","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1692014469,"ip_address":"广东","comment_id":379441,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"我看到同学的留言中对工期评估，我有一个疑问 一年的时间开发，项目立项都那么轻松么？没有对比就没有伤害啊。如果领导既要基础设施建设，又要不能影响当前业务开发的情况下。是不是就果断放弃投入了。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625648,"discussion_content":"不会一年只做一个项目的，会分成多个时间点和里程碑\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692014469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370583,"user_name":"拿笔小星","can_delete":false,"product_type":"c1","uid":1193755,"ip_address":"上海","ucode":"D3D8F6A959710D","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/1b/82310e20.jpg","comment_is_top":false,"comment_ctime":1678980428,"is_pvip":false,"replies":[{"id":135234,"content":"这个模式现在不多见了，总体用的不算多，不过以后切换到k8s这一套就方便 ：）","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1679047228,"ip_address":"广东","comment_id":370583,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"我们的服务发现就是代理式，服务直接通过SLB请求转发。SLB从服务发现那获取服务的IP列表","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609597,"discussion_content":"这个模式现在不多见了，总体用的不算多，不过以后切换到k8s这一套就方便 ：）","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679047229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320892,"user_name":"雪碧心拔凉","can_delete":false,"product_type":"c1","uid":1161522,"ip_address":"","ucode":"D13EEBAA0F443B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","comment_is_top":false,"comment_ctime":1636545039,"is_pvip":false,"replies":[{"id":116454,"content":"没必要分两类网关，增加了复杂度，不要认证其实算认证的一个特殊情况而已","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1636606245,"ip_address":"","comment_id":320892,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"对于网关是否包含鉴权功能，我们也遇到类似的问题，我们目前是将认证鉴权放到服务网关中(其实是由服务网关去调用认证和鉴权服务）。\n另外我们网关分服务网关和api网关，服务网关包含认证、鉴权、路由等功能，api网关算是服务网关的裁剪版，只有路由功能，但是将网关分类了总觉得怪怪的。不知老师有没有更好的看法，请指正","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609597,"discussion_content":"这个模式现在不多见了，总体用的不算多，不过以后切换到k8s这一套就方便 ：）","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679047229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307154,"user_name":"刘二","can_delete":false,"product_type":"c1","uid":1129297,"ip_address":"","ucode":"9703AA0EBCFF58","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJNeCwealtX0j5libPP67McmBGsHEKlNYPedF7tom3MIGF2ib6rPliaqR5QYS7WaTiaJdPhZjfQ4ZNdRA/132","comment_is_top":false,"comment_ctime":1628912285,"is_pvip":false,"replies":[{"id":111255,"content":"服务容错不属于运维，属于你上面的“功能篇”","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1628991423,"ip_address":"","comment_id":307154,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"总结下基础设施：\n# 功能篇\n* 服务发现、路由\n* API网关\n* 配置中心\n* 安全管控\n\n# 运维篇\n* 服务监控\n* 服务跟踪\n* 服务容错（流控、熔断等）\n* 自动化测试、部署","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525061,"discussion_content":"服务容错不属于运维，属于你上面的“功能篇”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628991423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288333,"user_name":"梦倚栏杆","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1618411066,"is_pvip":false,"replies":[{"id":104716,"content":"总的服务数量很多","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1618536459,"ip_address":"","comment_id":288333,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"老师这里提的服务数量多，是指的单个服务实例多吧，不是技术部整体服务个数多吧","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518593,"discussion_content":"总的服务数量很多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618536459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186954,"user_name":"谭方敏","can_delete":false,"product_type":"c1","uid":1710960,"ip_address":"","ucode":"728DC7ECB7C902","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/70/547042ee.jpg","comment_is_top":false,"comment_ctime":1583978806,"is_pvip":false,"replies":[{"id":72857,"content":"差不多，半年落地，半年稳定","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1584425390,"ip_address":"","comment_id":186954,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"自动化测试（代码级单元测试，单个系统级系统测试，接口间接口测试）\n自动化部署（版本管理，资源管理（机器管理，虚拟机管理），部署操作，回退操作）\n配置中心（配置版本管理，节点管理，配置同步，配置推送，增删查改操作）\n服务监控(宏观，考察请求次数，响应平均时间，响应最高值，减少故障处理时间，针对故障提前预警)\n服务跟踪（微观，某次请求的发起请求记录，响应时间，响应错误码，请求参数等）\n服务安全（接入安全，数据安全，传输安全）\n接口框架（对外用http&#47;json方式，对内用rpc方式）\napi网关（唯一提供外部访问的，接入鉴权（是否接入），权限控制（是否能访问），流量控制，请求路由，传输加密）\n服务发现（自主式（每个微服务之间自己完成服务发现），代理式（每个微服务之间借助负载均衡系统完成服务发现））\n服务路由（随机，轮询，最小压力，最小连接）\n服务容错（请求重试，流式和服务隔离）\n\n根据简单和演化原则，自研项目可以从最简单的开始，比如从服务发现，服务路由，服务容错，以及接口框架和api网关出发，等迭代完毕后再跟进自动化测试，自动化部署，配置中心，服务监控，服务跟踪，服务安全，按照逐步迭代，不断演化的思路。至于预测时间，真不好预测，之前做一个基于旧业务的新框架翻新，前前后后花了半年多才出雏形，后面再花半年才稳定下来。还不包括踩坑什么的。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486936,"discussion_content":"差不多，半年落地，半年稳定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584425390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1293551,"avatar":"https://static001.geekbang.org/account/avatar/00/13/bc/ef/98550b85.jpg","nickname":"云彩＆草原","note":"","ucode":"6AEA686202F1CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558415,"discussion_content":"m","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648291327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100074,"user_name":"郑佳宁","can_delete":false,"product_type":"c1","uid":1389623,"ip_address":"","ucode":"D4221F5BF8EBD0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqsFicCU21tKou4mFvfy5fOn9sfNYHNDfna8eozeVOLGs58gcAu8v2IIVFRsM6R8DIuWSVAjzubh8A/132","comment_is_top":false,"comment_ctime":1559437804,"is_pvip":false,"replies":[{"id":36282,"content":"小厂用spring全家桶，大厂为了可控和按需定制，一般会自己做","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1559617045,"ip_address":"","comment_id":100074,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"基础设施为啥要自研呢？有没有现成的成熟框架？如果有，不知道后面作者会不会有对比分析？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452400,"discussion_content":"小厂用spring全家桶，大厂为了可控和按需定制，一般会自己做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559617045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21600,"user_name":"文竹","can_delete":false,"product_type":"c1","uid":1103167,"ip_address":"","ucode":"74413B1975976B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/3f/80bf4841.jpg","comment_is_top":false,"comment_ctime":1535187268,"is_pvip":false,"replies":[{"id":7700,"content":"你还是太乐观了😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1535276452,"ip_address":"","comment_id":21600,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"自动化测试：主要支持接口测试，可以使用robot framework，无需额外人天。\n\n自动化部署：使用开源jenkins进行构建，无需人天。\n\n配置中心：需要支持的功能有服务节点管理，节点配置管理，配置版本管理，配置变更通知。\n实现这些功能估计需要30人天。\n\n接口框架：采用HTTP Rest Json形式，需要指定规范的json格式，目前Json解析能很好地支持于各语言，所以无需提供客户端库。由于主要工作在于规范化，估计需7人天。\n\nAPI网关：可以使用开源的API网关，比如Kong。Kong也支持插件化扩展功能。这里估计需7人天。\n\n服务发现、路由、容错：要实现这三个功能，还要实现服务注册中心。估计60人天。\n\n服务监控：收集信息并分析，由于数据量比较多，估计需要30人天。\n\n服务跟踪：是服务监控的升级版，特点也是数据量大，估计需要30人天。\n\n服务安全：这里需要做一个通用的认证授权方案。估计需要30人天。\n\n综合以上，似乎一个人半年左右就能完成初版。10个人同时进行的话，估计一个月左右。总觉得估计的时间比较紧，如果根据更细腻度的功能划分的话，可能在2个月左右。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452400,"discussion_content":"小厂用spring全家桶，大厂为了可控和按需定制，一般会自己做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559617045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16689,"user_name":"小喵喵","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1532097429,"is_pvip":false,"replies":[{"id":5819,"content":"可以自己搭建，优点是灵活，有问题处理起来快，缺点就是投入大，也可以spring全家桶，优缺点基本倒过来","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532174345,"ip_address":"","comment_id":16689,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"微服务的基础设施需要程序猿写代码来实现吗？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422759,"discussion_content":"你还是太乐观了😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535276452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16466,"user_name":"凡凡","can_delete":false,"product_type":"c1","uid":1056142,"ip_address":"","ucode":"134C1E1E6B22BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/8e/0a546871.jpg","comment_is_top":false,"comment_ctime":1531965974,"is_pvip":false,"replies":[{"id":5947,"content":"这类微服务做出基本功能9个月可以，做完善需要耗时更长","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425469,"ip_address":"","comment_id":16466,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"按照以往了解的基础架构部的开发速度来看，而且文中涉及的基础设施都有开源实现可以借鉴，一个基础设施从调研（开源系统代码review），到设计，再到开发，再到小流量接入，全公司推广，一个基础设施3个人大概5到6个月时间，如果去掉小流量和推广阶段，估计也需要3到4个月。\n\n文中说到的前10个微服务，按照单个3*3人月算下来的话，理想情况下，需要9个月。\n\n当然，这里没有考虑严格的测试和压力测试，否则每个系统，需要增加至少一个人月的周期。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420901,"discussion_content":"可以自己搭建，优点是灵活，有问题处理起来快，缺点就是投入大，也可以spring全家桶，优缺点基本倒过来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532174345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379441,"user_name":"鲁米","can_delete":false,"product_type":"c1","uid":1574008,"ip_address":"北京","ucode":"F8F23431723F25","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/78/37b46ba6.jpg","comment_is_top":false,"comment_ctime":1691979755,"is_pvip":false,"replies":[{"id":138240,"content":"不会一年只做一个项目的，会分成多个时间点和里程碑\n","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1692014469,"ip_address":"广东","comment_id":379441,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"我看到同学的留言中对工期评估，我有一个疑问 一年的时间开发，项目立项都那么轻松么？没有对比就没有伤害啊。如果领导既要基础设施建设，又要不能影响当前业务开发的情况下。是不是就果断放弃投入了。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420807,"discussion_content":"这类微服务做出基本功能9个月可以，做完善需要耗时更长","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370583,"user_name":"拿笔小星","can_delete":false,"product_type":"c1","uid":1193755,"ip_address":"上海","ucode":"D3D8F6A959710D","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/1b/82310e20.jpg","comment_is_top":false,"comment_ctime":1678980428,"is_pvip":false,"replies":[{"id":135234,"content":"这个模式现在不多见了，总体用的不算多，不过以后切换到k8s这一套就方便 ：）","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1679047228,"ip_address":"广东","comment_id":370583,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"我们的服务发现就是代理式，服务直接通过SLB请求转发。SLB从服务发现那获取服务的IP列表","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625648,"discussion_content":"不会一年只做一个项目的，会分成多个时间点和里程碑\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692014469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320892,"user_name":"雪碧心拔凉","can_delete":false,"product_type":"c1","uid":1161522,"ip_address":"","ucode":"D13EEBAA0F443B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","comment_is_top":false,"comment_ctime":1636545039,"is_pvip":false,"replies":[{"id":116454,"content":"没必要分两类网关，增加了复杂度，不要认证其实算认证的一个特殊情况而已","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1636606245,"ip_address":"","comment_id":320892,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"对于网关是否包含鉴权功能，我们也遇到类似的问题，我们目前是将认证鉴权放到服务网关中(其实是由服务网关去调用认证和鉴权服务）。\n另外我们网关分服务网关和api网关，服务网关包含认证、鉴权、路由等功能，api网关算是服务网关的裁剪版，只有路由功能，但是将网关分类了总觉得怪怪的。不知老师有没有更好的看法，请指正","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530156,"discussion_content":"没必要分两类网关，增加了复杂度，不要认证其实算认证的一个特殊情况而已","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636606245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413917,"discussion_content":"是这样的，我们有两个这样的场景。第一个：接口会被浏览器(用户）调用，需要认证鉴权；第二个：还有也会被其他业务系统调用，但不需要认证和鉴权，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636608916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307154,"user_name":"刘二","can_delete":false,"product_type":"c1","uid":1129297,"ip_address":"","ucode":"9703AA0EBCFF58","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJNeCwealtX0j5libPP67McmBGsHEKlNYPedF7tom3MIGF2ib6rPliaqR5QYS7WaTiaJdPhZjfQ4ZNdRA/132","comment_is_top":false,"comment_ctime":1628912285,"is_pvip":false,"replies":[{"id":111255,"content":"服务容错不属于运维，属于你上面的“功能篇”","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1628991423,"ip_address":"","comment_id":307154,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"总结下基础设施：\n# 功能篇\n* 服务发现、路由\n* API网关\n* 配置中心\n* 安全管控\n\n# 运维篇\n* 服务监控\n* 服务跟踪\n* 服务容错（流控、熔断等）\n* 自动化测试、部署","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530156,"discussion_content":"没必要分两类网关，增加了复杂度，不要认证其实算认证的一个特殊情况而已","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636606245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161522,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/32/84346d4a.jpg","nickname":"雪碧心拔凉","note":"","ucode":"D13EEBAA0F443B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413917,"discussion_content":"是这样的，我们有两个这样的场景。第一个：接口会被浏览器(用户）调用，需要认证鉴权；第二个：还有也会被其他业务系统调用，但不需要认证和鉴权，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636608916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288333,"user_name":"梦倚栏杆","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1618411066,"is_pvip":false,"replies":[{"id":104716,"content":"总的服务数量很多","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1618536459,"ip_address":"","comment_id":288333,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"老师这里提的服务数量多，是指的单个服务实例多吧，不是技术部整体服务个数多吧","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525061,"discussion_content":"服务容错不属于运维，属于你上面的“功能篇”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628991423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287155,"user_name":"smile7up","can_delete":false,"product_type":"c1","uid":1193743,"ip_address":"","ucode":"C0EEB0A78EE48E","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/0f/ea69cc8e.jpg","comment_is_top":false,"comment_ctime":1617798055,"is_pvip":false,"replies":[{"id":104279,"content":"是的，看文中的截图案例，这是json样例，你也可以用grpc，然后制定一定的数据格式规范","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1617841331,"ip_address":"","comment_id":287155,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"不太明白，这个接口框架是什么意思，是指比如使用java，提供一个大家统一用的依赖包吗，类似于如果使用JSON返回，则返回code，msg，data这种的吗？\n谢谢老师，看了您的课程，受益匪浅","like_count":0},{"had_liked":false,"id":276432,"user_name":"shihpeng","can_delete":false,"product_type":"c1","uid":1440698,"ip_address":"","ucode":"F7685343B88D29","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/ba/68bb346c.jpg","comment_is_top":false,"comment_ctime":1611920691,"is_pvip":false,"replies":[{"id":100382,"content":"这几个我也没有深入的研究，你可以自己研究一下，探索的过程就是学习的过程，我直接告诉你一个答案对你来说收获不大。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1612055790,"ip_address":"","comment_id":276432,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"想请问下老师&quot;自理式&quot;和&quot;代理式&quot;的服务发现典型开源项目有哪些呢？例如k8s、consul、eureka分别属于哪些类型呢？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518207,"discussion_content":"是的，看文中的截图案例，这是json样例，你也可以用grpc，然后制定一定的数据格式规范","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617841331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266355,"user_name":"Geek_9b9530","can_delete":false,"product_type":"c1","uid":2146381,"ip_address":"","ucode":"23498B3944F97C","user_header":"","comment_is_top":false,"comment_ctime":1607310842,"is_pvip":false,"replies":[{"id":96752,"content":"差不多，4个月搞定一个能用的系统","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1607345534,"ip_address":"","comment_id":266355,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"每个功能三个月，额外1.5个月Buffer， 按功能数计算就行了。   既然全部都是高级工程师，理论上三个月开发出来的内容是可用的。1.5个月的集成测试和BUG修复，应该没有问题。  ","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514700,"discussion_content":"这几个我也没有深入的研究，你可以自己研究一下，探索的过程就是学习的过程，我直接告诉你一个答案对你来说收获不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612055790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262865,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1605862978,"is_pvip":false,"replies":[{"id":95464,"content":"一旦拥有，别无所求","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606010912,"ip_address":"","comment_id":262865,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"Spring Cloud全家桶","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511228,"discussion_content":"差不多，4个月搞定一个能用的系统","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607345534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255592,"user_name":"flyCoder","can_delete":false,"product_type":"c1","uid":1074897,"ip_address":"","ucode":"82FB7B60775978","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","comment_is_top":false,"comment_ctime":1603377062,"is_pvip":false,"replies":[{"id":93162,"content":"你的估算太乐观了������","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1603422163,"ip_address":"","comment_id":255592,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"如果按照“三个火枪手”的原则分配，我认为可以三人一组，同步进行，服务注册与发现，网关，链路跟踪可以作为第一版上线的基础服务，预计两个月上线，稳定以后接入，可以先分3个人介入2个月左右的业务功能开发上线，3个人研发自动化部署，配置中心，服务监控部分，另外三个人配合期间的迭代发布，预留3个月测试迭代，预计7个月可以有一个完整的1.0微服务系统，剩下五个月左右可以根据业务走向和进度情况调整和分配，一年可以建成一个自动化的系统。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507765,"discussion_content":"你的估算太乐观了������","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603422163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252627,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1602408923,"is_pvip":true,"replies":[{"id":92533,"content":"基本正确，但是在大厂如果能自己做，晋升会比较容易","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1602672111,"ip_address":"","comment_id":252627,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"其实在微服务的 11 个基础设施里面，我觉得自动化测试和自动化部署反而是比较基础的，并且需要开发人员能够适应并且投入。不知道国内有多少团队能够做到单元测试，或者是自动化测试；自动化部署因为有 Jenkins，可能会好一点。\n\n如果按照上一章节的优先级顺序，应该从服务发现、服务路由和服务容错起步，然后再做接口框架和 API 网关；最后是服务监控、服务跟踪和服务安全。\n\n10 位 Java 高手，自研微服务基础设施，如果采用 3 个人一组的方式，3 个月（9 人月）完成一项基础设施，那么大概 1 年左右应该有小成。假设 Java 高手的月薪在 50K 左右，那么 1 年的人力成本不少于 600 万。为什么要自研呢？很多基础设施已经是现成的轮子了。\n\n同样 10 位高手，采用开源软件，选型、搭建全套的微服务基础设施，可能 2 个月应该就可以跑的很流畅了吧。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510007,"discussion_content":"一旦拥有，别无所求","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606010912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244291,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598451999,"is_pvip":true,"replies":[{"id":90064,"content":"服务网格是指service mesh？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598685894,"ip_address":"","comment_id":244291,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"自理和代理说的棒，我就喜欢k8s的dns方式，不喜欢vip方式。服务网格目前性能太差。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507765,"discussion_content":"你的估算太乐观了������","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603422163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174044,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1579921953,"is_pvip":false,"replies":[{"id":69949,"content":"主要是这个","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1582192400,"ip_address":"","comment_id":174044,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"老师，请问一下json数据格式规范，主要是约定公共字段名吗？还有其它要定义的内容吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506819,"discussion_content":"基本正确，但是在大厂如果能自己做，晋升会比较容易","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602672111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174043,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1579921769,"is_pvip":false,"replies":[{"id":69950,"content":"网关可以做鉴权，也可以不做，由应用自己来做，不要重复做两次","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1582192452,"ip_address":"","comment_id":174043,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"老师，你好。请教一个问题，微服务本身要实现请求鉴权，这个功能和网关相同，如果一个外部请求通过网关访问，它将要进行两次验证，有点重复呀，是这样吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504543,"discussion_content":"服务网格是指service mesh？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598685894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168905,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1578213780,"is_pvip":false,"replies":[{"id":65489,"content":"json里面的字段不一样","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1578218818,"ip_address":"","comment_id":168905,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"华哥，你在文章中提到的“即使同样都是 JSON，JSON 数据格式也不一样。”想请教 json数据格式规范具体指什么？此规范要约定那些内容？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482279,"discussion_content":"网关可以做鉴权，也可以不做，由应用自己来做，不要重复做两次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582192452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287155,"user_name":"smile7up","can_delete":false,"product_type":"c1","uid":1193743,"ip_address":"","ucode":"C0EEB0A78EE48E","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/0f/ea69cc8e.jpg","comment_is_top":false,"comment_ctime":1617798055,"is_pvip":false,"replies":[{"id":104279,"content":"是的，看文中的截图案例，这是json样例，你也可以用grpc，然后制定一定的数据格式规范","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1617841331,"ip_address":"","comment_id":287155,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"不太明白，这个接口框架是什么意思，是指比如使用java，提供一个大家统一用的依赖包吗，类似于如果使用JSON返回，则返回code，msg，data这种的吗？\n谢谢老师，看了您的课程，受益匪浅","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518207,"discussion_content":"是的，看文中的截图案例，这是json样例，你也可以用grpc，然后制定一定的数据格式规范","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617841331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276432,"user_name":"shihpeng","can_delete":false,"product_type":"c1","uid":1440698,"ip_address":"","ucode":"F7685343B88D29","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/ba/68bb346c.jpg","comment_is_top":false,"comment_ctime":1611920691,"is_pvip":false,"replies":[{"id":100382,"content":"这几个我也没有深入的研究，你可以自己研究一下，探索的过程就是学习的过程，我直接告诉你一个答案对你来说收获不大。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1612055790,"ip_address":"","comment_id":276432,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"想请问下老师&quot;自理式&quot;和&quot;代理式&quot;的服务发现典型开源项目有哪些呢？例如k8s、consul、eureka分别属于哪些类型呢？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514700,"discussion_content":"这几个我也没有深入的研究，你可以自己研究一下，探索的过程就是学习的过程，我直接告诉你一个答案对你来说收获不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612055790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266355,"user_name":"Geek_9b9530","can_delete":false,"product_type":"c1","uid":2146381,"ip_address":"","ucode":"23498B3944F97C","user_header":"","comment_is_top":false,"comment_ctime":1607310842,"is_pvip":false,"replies":[{"id":96752,"content":"差不多，4个月搞定一个能用的系统","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1607345534,"ip_address":"","comment_id":266355,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"每个功能三个月，额外1.5个月Buffer， 按功能数计算就行了。   既然全部都是高级工程师，理论上三个月开发出来的内容是可用的。1.5个月的集成测试和BUG修复，应该没有问题。  ","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511228,"discussion_content":"差不多，4个月搞定一个能用的系统","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607345534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262865,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1605862978,"is_pvip":false,"replies":[{"id":95464,"content":"一旦拥有，别无所求","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606010912,"ip_address":"","comment_id":262865,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"Spring Cloud全家桶","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510007,"discussion_content":"一旦拥有，别无所求","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606010912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255592,"user_name":"flyCoder","can_delete":false,"product_type":"c1","uid":1074897,"ip_address":"","ucode":"82FB7B60775978","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","comment_is_top":false,"comment_ctime":1603377062,"is_pvip":false,"replies":[{"id":93162,"content":"你的估算太乐观了������","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1603422163,"ip_address":"","comment_id":255592,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"如果按照“三个火枪手”的原则分配，我认为可以三人一组，同步进行，服务注册与发现，网关，链路跟踪可以作为第一版上线的基础服务，预计两个月上线，稳定以后接入，可以先分3个人介入2个月左右的业务功能开发上线，3个人研发自动化部署，配置中心，服务监控部分，另外三个人配合期间的迭代发布，预留3个月测试迭代，预计7个月可以有一个完整的1.0微服务系统，剩下五个月左右可以根据业务走向和进度情况调整和分配，一年可以建成一个自动化的系统。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506819,"discussion_content":"基本正确，但是在大厂如果能自己做，晋升会比较容易","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602672111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252627,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1602408923,"is_pvip":true,"replies":[{"id":92533,"content":"基本正确，但是在大厂如果能自己做，晋升会比较容易","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1602672111,"ip_address":"","comment_id":252627,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"其实在微服务的 11 个基础设施里面，我觉得自动化测试和自动化部署反而是比较基础的，并且需要开发人员能够适应并且投入。不知道国内有多少团队能够做到单元测试，或者是自动化测试；自动化部署因为有 Jenkins，可能会好一点。\n\n如果按照上一章节的优先级顺序，应该从服务发现、服务路由和服务容错起步，然后再做接口框架和 API 网关；最后是服务监控、服务跟踪和服务安全。\n\n10 位 Java 高手，自研微服务基础设施，如果采用 3 个人一组的方式，3 个月（9 人月）完成一项基础设施，那么大概 1 年左右应该有小成。假设 Java 高手的月薪在 50K 左右，那么 1 年的人力成本不少于 600 万。为什么要自研呢？很多基础设施已经是现成的轮子了。\n\n同样 10 位高手，采用开源软件，选型、搭建全套的微服务基础设施，可能 2 个月应该就可以跑的很流畅了吧。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504543,"discussion_content":"服务网格是指service mesh？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598685894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244291,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598451999,"is_pvip":true,"replies":[{"id":90064,"content":"服务网格是指service mesh？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598685894,"ip_address":"","comment_id":244291,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"自理和代理说的棒，我就喜欢k8s的dns方式，不喜欢vip方式。服务网格目前性能太差。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482280,"discussion_content":"主要是这个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582192400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174044,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1579921953,"is_pvip":false,"replies":[{"id":69949,"content":"主要是这个","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1582192400,"ip_address":"","comment_id":174044,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"老师，请问一下json数据格式规范，主要是约定公共字段名吗？还有其它要定义的内容吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482280,"discussion_content":"主要是这个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582192400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174043,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1579921769,"is_pvip":false,"replies":[{"id":69950,"content":"网关可以做鉴权，也可以不做，由应用自己来做，不要重复做两次","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1582192452,"ip_address":"","comment_id":174043,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"老师，你好。请教一个问题，微服务本身要实现请求鉴权，这个功能和网关相同，如果一个外部请求通过网关访问，它将要进行两次验证，有点重复呀，是这样吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482279,"discussion_content":"网关可以做鉴权，也可以不做，由应用自己来做，不要重复做两次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582192452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168905,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1578213780,"is_pvip":false,"replies":[{"id":65489,"content":"json里面的字段不一样","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1578218818,"ip_address":"","comment_id":168905,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"华哥，你在文章中提到的“即使同样都是 JSON，JSON 数据格式也不一样。”想请教 json数据格式规范具体指什么？此规范要约定那些内容？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480366,"discussion_content":"json里面的字段不一样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578218818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1477120,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","nickname":"Geek_steven_wang","note":"","ucode":"8CC8F4C9726191","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":119559,"discussion_content":"是要约定一些公共字段名及值的处理吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578233273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159295,"user_name":"古月三石","can_delete":false,"product_type":"c1","uid":1503260,"ip_address":"","ucode":"D03D7484B0A3F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/f0/1c/53f18c18.jpg","comment_is_top":false,"comment_ctime":1575596233,"is_pvip":false,"replies":[{"id":63222,"content":"这个你可以上网先查查，问个这么泛的问题，我也不太可能回复里面讲清楚呢。。。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1577328468,"ip_address":"","comment_id":159295,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师你好，kubernetes中也有服务发现的功能，和Springcloud的服务发现两者如何选择？请指教","like_count":0},{"had_liked":false,"id":137419,"user_name":"Sam.张朝","can_delete":false,"product_type":"c1","uid":1132448,"ip_address":"","ucode":"FB20554D94B250","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/a0/f12115b7.jpg","comment_is_top":false,"comment_ctime":1569736879,"is_pvip":true,"replies":[{"id":52920,"content":"8个月还算厉害的了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1569828431,"ip_address":"","comment_id":137419,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"按照第一个人的回答，10个高级工程师，要8个月时间。\n如果没有经验，没有高级，感觉基本就没戏了。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469080,"discussion_content":"8个月还算厉害的了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569828431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99637,"user_name":"zcode","can_delete":false,"product_type":"c1","uid":1073912,"ip_address":"","ucode":"9511AEABC4DF06","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/f8/99accf69.jpg","comment_is_top":false,"comment_ctime":1559271800,"is_pvip":false,"replies":[{"id":36284,"content":"都封装在SDK里面","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1559617179,"ip_address":"","comment_id":99637,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"关于绕过网关进行接口调用的问题，如果通过SDK的方式提供给业务方使用，那是不是业务方也需要登录鉴权了，和网关功能重复了呢","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452199,"discussion_content":"都封装在SDK里面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559617179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72114,"user_name":"aduan","can_delete":false,"product_type":"c1","uid":1104033,"ip_address":"","ucode":"DA54005B9849C5","user_header":"https://static001.geekbang.org/account/avatar/00/10/d8/a1/cd868183.jpg","comment_is_top":false,"comment_ctime":1551522426,"is_pvip":false,"replies":[{"id":27912,"content":"封装SDK给业务用","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1552624744,"ip_address":"","comment_id":72114,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"用了网关后，如何避免服务调用不会绕过网关直接调用接口？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441466,"discussion_content":"封装SDK给业务用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552624744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35820,"user_name":"AmosWooo","can_delete":false,"product_type":"c1","uid":1191605,"ip_address":"","ucode":"481780ABC37013","user_header":"https://static001.geekbang.org/account/avatar/00/12/2e/b5/5f1c7ae1.jpg","comment_is_top":false,"comment_ctime":1540814774,"is_pvip":false,"replies":[{"id":12755,"content":"可以这样做，网关依赖安全服务","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1540821205,"ip_address":"","comment_id":35820,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"接上一问题，微服务提倡无状态，那就必须有一个认证授权服务存在，我的理解是在APIGateway下层，存在一个同级服务来提供验证授权，或者说结合API网关提供全面安全机制，这样既可以在APIGateway层过滤部分非法请求，又在下层提供更细粒度安全控制，整体来说压到服务节点的流量被有效降低了，不知道这样子理解正确否","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427675,"discussion_content":"可以这样做，网关依赖安全服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540821205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21182,"user_name":"无界","can_delete":false,"product_type":"c1","uid":1099095,"ip_address":"","ucode":"3F6429D7BBF1E4","user_header":"https://static001.geekbang.org/account/avatar/00/10/c5/57/fcbd04a0.jpg","comment_is_top":false,"comment_ctime":1534954611,"is_pvip":false,"replies":[{"id":7527,"content":"试试spring 全家桶，zabbix","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1535007223,"ip_address":"","comment_id":21182,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师你好，能否推荐基础设施涉及到的工具，例如监控工具，日志工具，和问题追踪工具等","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422566,"discussion_content":"试试spring 全家桶，zabbix","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535007223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19406,"user_name":"arno","can_delete":false,"product_type":"c1","uid":1150523,"ip_address":"","ucode":"AAEA743EF92BA3","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/3b/aa4e236a.jpg","comment_is_top":false,"comment_ctime":1533813981,"is_pvip":false,"replies":[{"id":6757,"content":"可以的，基于k8s搭建自动化部署平台","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533885036,"ip_address":"","comment_id":19406,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"是不是也可以考虑一下k8s部署","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421827,"discussion_content":"可以的，基于k8s搭建自动化部署平台","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533885036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19330,"user_name":"风之射手座","can_delete":false,"product_type":"c1","uid":1128993,"ip_address":"","ucode":"41701B012716AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/3a/21/caa40d0f.jpg","comment_is_top":false,"comment_ctime":1533776007,"is_pvip":false,"replies":[{"id":6681,"content":"是的，和网关类似","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533779467,"ip_address":"","comment_id":19330,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"代理式服务发现，代理还负责转发请求消息响应消息对吗","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421787,"discussion_content":"是的，和网关类似","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533779467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":18826,"user_name":"沫沫（美丽人生）","can_delete":false,"product_type":"c1","uid":1051023,"ip_address":"","ucode":"FC73BF0D79E3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/8f/ad6039b6.jpg","comment_is_top":false,"comment_ctime":1533573449,"is_pvip":false,"replies":[{"id":6638,"content":"已经有类似专栏","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533697322,"ip_address":"","comment_id":18826,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师可以结合spring cloud的微服务实践吗?","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421658,"discussion_content":"已经有类似专栏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533697322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16856,"user_name":"稻草","can_delete":false,"product_type":"c1","uid":1105348,"ip_address":"","ucode":"83441881B7F75F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLiaURkQOrwf1tjLEoUNmQ8Hia9rYPWuXib9cbz09qcD8hqfZeJCBickvveEt7QFnTn5obLoXgOzz9F9w/132","comment_is_top":false,"comment_ctime":1532257084,"is_pvip":false,"replies":[{"id":5942,"content":"网关的功能只是esb中的其中一个职责","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425243,"ip_address":"","comment_id":16856,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"请问李老师微服务架构中的网关和soa架构中的esb有什么区别？难道网关不会成为整体架构中的性能瓶颈吗？希望解答，谢谢","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420949,"discussion_content":"网关的功能只是esb中的其中一个职责","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159295,"user_name":"古月三石","can_delete":false,"product_type":"c1","uid":1503260,"ip_address":"","ucode":"D03D7484B0A3F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/f0/1c/53f18c18.jpg","comment_is_top":false,"comment_ctime":1575596233,"is_pvip":false,"replies":[{"id":63222,"content":"这个你可以上网先查查，问个这么泛的问题，我也不太可能回复里面讲清楚呢。。。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1577328468,"ip_address":"","comment_id":159295,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师你好，kubernetes中也有服务发现的功能，和Springcloud的服务发现两者如何选择？请指教","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477002,"discussion_content":"这个你可以上网先查查，问个这么泛的问题，我也不太可能回复里面讲清楚呢。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577328468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137419,"user_name":"Sam.张朝","can_delete":false,"product_type":"c1","uid":1132448,"ip_address":"","ucode":"FB20554D94B250","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/a0/f12115b7.jpg","comment_is_top":false,"comment_ctime":1569736879,"is_pvip":true,"replies":[{"id":52920,"content":"8个月还算厉害的了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1569828431,"ip_address":"","comment_id":137419,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"按照第一个人的回答，10个高级工程师，要8个月时间。\n如果没有经验，没有高级，感觉基本就没戏了。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477002,"discussion_content":"这个你可以上网先查查，问个这么泛的问题，我也不太可能回复里面讲清楚呢。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577328468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99637,"user_name":"zcode","can_delete":false,"product_type":"c1","uid":1073912,"ip_address":"","ucode":"9511AEABC4DF06","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/f8/99accf69.jpg","comment_is_top":false,"comment_ctime":1559271800,"is_pvip":false,"replies":[{"id":36284,"content":"都封装在SDK里面","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1559617179,"ip_address":"","comment_id":99637,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"关于绕过网关进行接口调用的问题，如果通过SDK的方式提供给业务方使用，那是不是业务方也需要登录鉴权了，和网关功能重复了呢","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469080,"discussion_content":"8个月还算厉害的了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569828431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72114,"user_name":"aduan","can_delete":false,"product_type":"c1","uid":1104033,"ip_address":"","ucode":"DA54005B9849C5","user_header":"https://static001.geekbang.org/account/avatar/00/10/d8/a1/cd868183.jpg","comment_is_top":false,"comment_ctime":1551522426,"is_pvip":false,"replies":[{"id":27912,"content":"封装SDK给业务用","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1552624744,"ip_address":"","comment_id":72114,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"用了网关后，如何避免服务调用不会绕过网关直接调用接口？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452199,"discussion_content":"都封装在SDK里面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559617179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35820,"user_name":"AmosWooo","can_delete":false,"product_type":"c1","uid":1191605,"ip_address":"","ucode":"481780ABC37013","user_header":"https://static001.geekbang.org/account/avatar/00/12/2e/b5/5f1c7ae1.jpg","comment_is_top":false,"comment_ctime":1540814774,"is_pvip":false,"replies":[{"id":12755,"content":"可以这样做，网关依赖安全服务","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1540821205,"ip_address":"","comment_id":35820,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"接上一问题，微服务提倡无状态，那就必须有一个认证授权服务存在，我的理解是在APIGateway下层，存在一个同级服务来提供验证授权，或者说结合API网关提供全面安全机制，这样既可以在APIGateway层过滤部分非法请求，又在下层提供更细粒度安全控制，整体来说压到服务节点的流量被有效降低了，不知道这样子理解正确否","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441466,"discussion_content":"封装SDK给业务用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552624744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21182,"user_name":"无界","can_delete":false,"product_type":"c1","uid":1099095,"ip_address":"","ucode":"3F6429D7BBF1E4","user_header":"https://static001.geekbang.org/account/avatar/00/10/c5/57/fcbd04a0.jpg","comment_is_top":false,"comment_ctime":1534954611,"is_pvip":false,"replies":[{"id":7527,"content":"试试spring 全家桶，zabbix","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1535007223,"ip_address":"","comment_id":21182,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师你好，能否推荐基础设施涉及到的工具，例如监控工具，日志工具，和问题追踪工具等","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427675,"discussion_content":"可以这样做，网关依赖安全服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540821205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19406,"user_name":"arno","can_delete":false,"product_type":"c1","uid":1150523,"ip_address":"","ucode":"AAEA743EF92BA3","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/3b/aa4e236a.jpg","comment_is_top":false,"comment_ctime":1533813981,"is_pvip":false,"replies":[{"id":6757,"content":"可以的，基于k8s搭建自动化部署平台","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533885036,"ip_address":"","comment_id":19406,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"是不是也可以考虑一下k8s部署","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422566,"discussion_content":"试试spring 全家桶，zabbix","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535007223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":19330,"user_name":"风之射手座","can_delete":false,"product_type":"c1","uid":1128993,"ip_address":"","ucode":"41701B012716AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/3a/21/caa40d0f.jpg","comment_is_top":false,"comment_ctime":1533776007,"is_pvip":false,"replies":[{"id":6681,"content":"是的，和网关类似","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533779467,"ip_address":"","comment_id":19330,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"代理式服务发现，代理还负责转发请求消息响应消息对吗","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421827,"discussion_content":"可以的，基于k8s搭建自动化部署平台","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533885036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":18826,"user_name":"沫沫（美丽人生）","can_delete":false,"product_type":"c1","uid":1051023,"ip_address":"","ucode":"FC73BF0D79E3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/8f/ad6039b6.jpg","comment_is_top":false,"comment_ctime":1533573449,"is_pvip":false,"replies":[{"id":6638,"content":"已经有类似专栏","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1533697322,"ip_address":"","comment_id":18826,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师可以结合spring cloud的微服务实践吗?","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421787,"discussion_content":"是的，和网关类似","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533779467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16856,"user_name":"稻草","can_delete":false,"product_type":"c1","uid":1105348,"ip_address":"","ucode":"83441881B7F75F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLiaURkQOrwf1tjLEoUNmQ8Hia9rYPWuXib9cbz09qcD8hqfZeJCBickvveEt7QFnTn5obLoXgOzz9F9w/132","comment_is_top":false,"comment_ctime":1532257084,"is_pvip":false,"replies":[{"id":5942,"content":"网关的功能只是esb中的其中一个职责","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425243,"ip_address":"","comment_id":16856,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"请问李老师微服务架构中的网关和soa架构中的esb有什么区别？难道网关不会成为整体架构中的性能瓶颈吗？希望解答，谢谢","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421658,"discussion_content":"已经有类似专栏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1533697322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16679,"user_name":"小鱼儿","can_delete":false,"product_type":"c1","uid":1053492,"ip_address":"","ucode":"989EC453936B91","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/34/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1532094264,"is_pvip":false,"replies":[{"id":5822,"content":"抱歉，对.net不熟悉😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532175074,"ip_address":"","comment_id":16679,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师，.net有没有规则引擎项目推荐","like_count":0},{"had_liked":false,"id":16598,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1532048763,"is_pvip":false,"replies":[{"id":5762,"content":"注册都是要自己注册的，但是服务发现和路由处理不一样，一个是服务自己完成发现和路由，一个是代理去完成发现和路由","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068147,"ip_address":"","comment_id":16598,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师关于服务发现主要有两种实现方式：自理式和代理式，我没有听明白。我理解两种方式的服务注册都是一样的，都是需要服务实例自己去注册，对比两种服务发现方式代理方式的负载均衡通过图示感觉多过了一道。没有任何意义。不知道负载均衡的意义何在？谢谢。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420898,"discussion_content":"抱歉，对.net不熟悉😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532175074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16497,"user_name":"kaola","can_delete":false,"product_type":"c1","uid":1136365,"ip_address":"","ucode":"208D28CC2C08E6","user_header":"","comment_is_top":false,"comment_ctime":1531985506,"is_pvip":false,"replies":[{"id":5768,"content":"网关不要有业务逻辑，因此你说的调度模块不适合放到网关，应该放到a服务去调用b服务。\n至于流程设计，a服务可以采用规则引擎，或者有一个独立的服务c基于规则引擎配置业务逻辑，然后根据逻辑调用a或者b服务","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068725,"ip_address":"","comment_id":16497,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师，我想问下是不是有服务统一调度的模块，比如一个基本的银行转账业务，我们把该业务的调度流程参数化到表中，比如第一步要调用存款服务的转账功能，第二步调用会计服务的流水登记功能，假设调度表中对于活期转账已经配置了两个步骤，那调度模块就根据配置依次顺序调用微服务a存款服务和b会计服务，那调度模块是放在api网关做总体调度还是让微服务a自发去调用微服务b吗？哪种合理？还是说调度参数化这种设计不好?在服务a中写死调用服务b?","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420863,"discussion_content":"注册都是要自己注册的，但是服务发现和路由处理不一样，一个是服务自己完成发现和路由，一个是代理去完成发现和路由","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16453,"user_name":"阿飞","can_delete":false,"product_type":"c1","uid":1086104,"ip_address":"","ucode":"5D31D03003988C","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/98/064ce708.jpg","comment_is_top":false,"comment_ctime":1531964156,"is_pvip":false,"replies":[{"id":5949,"content":"太乐观了，用开源方案都没那么快😊","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425518,"ip_address":"","comment_id":16453,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"按照三个火枪手原则和按业务拆分，先把服务拆分三个小组，3个人：自动化测试、自动化部署 、配置中心   \n3个人:接口框架、API网关 \n4个人:服务发现、服务路由、服务容错、服务监控、服务跟踪、服务安全\n按照以上划分差不多个月完成基础架构开发","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420822,"discussion_content":"网关不要有业务逻辑，因此你说的调度模块不适合放到网关，应该放到a服务去调用b服务。\n至于流程设计，a服务可以采用规则引擎，或者有一个独立的服务c基于规则引擎配置业务逻辑，然后根据逻辑调用a或者b服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16421,"user_name":"顾慎为","can_delete":false,"product_type":"c1","uid":1118826,"ip_address":"","ucode":"E58CCF424A7B79","user_header":"https://static001.geekbang.org/account/avatar/00/11/12/6a/25a97cce.jpg","comment_is_top":false,"comment_ctime":1531956271,"is_pvip":false,"replies":[{"id":5701,"content":"服务安全就包括鉴权，接入安全就是鉴权","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1531965814,"ip_address":"","comment_id":16421,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"我想问一下，微服务内部不需要做鉴权吗？如果被入侵了咋办？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420801,"discussion_content":"太乐观了，用开源方案都没那么快😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16428,"user_name":"kyll","can_delete":false,"product_type":"c1","uid":1103329,"ip_address":"","ucode":"2425DCF5753786","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/e1/a05a9e22.jpg","comment_is_top":false,"comment_ctime":1531958844,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"按照我们公司的情况来说，1.5个人，spring全家桶，花费6个月，才让系统上线。\n要是完全自研，10个高程在，也信心不大。","like_count":9},{"had_liked":false,"id":44721,"user_name":"易燃易爆炸","can_delete":false,"product_type":"c1","uid":1115949,"ip_address":"","ucode":"081F5310EB6D61","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/2d/0ac560a6.jpg","comment_is_top":false,"comment_ctime":1543481868,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"自己写的话肯定坑太多，也没有经过太多实践上的检验。感觉真正稳定下来需要躺过很多坑才行，当然成长也是成倍的，最终苦了公司，系统天天挂。","like_count":8},{"had_liked":false,"id":85016,"user_name":"吴小智","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1554956925,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师讲到很好，不过由于自己还是在校生，没经历过，只能得到感性的认识，谢谢老师","like_count":2},{"had_liked":false,"id":288839,"user_name":"prader26","can_delete":false,"product_type":"c1","uid":1433707,"ip_address":"","ucode":"5EFFFC374ADECE","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/6b/f61d7466.jpg","comment_is_top":false,"comment_ctime":1618725432,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"微服务的基础设施：\n1 自动化测试\n2 自动化部署\n3 配置中心\n4 接口框架\n5 API 网关\n6 服务发现\n7 服务路由\n8 服务容错\n9 服务监控\n10 服务跟踪\n11 服务安全","like_count":0},{"had_liked":false,"id":130358,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1567432890,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"看完后估不出具体工时，因为具体多复杂不太清楚，而且自顶倒下的工时估算方式是不准确的。如果可能我会把活先分出去，然后让他们给个排期，再看看具体情况给出一个总工期。\n不过，这个东西不好做到是真的，否则大家都自研了，目前应该只有某些大厂才有人力、财力、物力来弄。十个人左右估计需要一年多的时间，如果比较完善的弄出来估计需要三年左右，需要经历大促或者其他流量高峰的考验。还有不断的完善功能，提高效率，提升用户体验。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420791,"discussion_content":"服务安全就包括鉴权，接入安全就是鉴权","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531965814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16679,"user_name":"小鱼儿","can_delete":false,"product_type":"c1","uid":1053492,"ip_address":"","ucode":"989EC453936B91","user_header":"https://static001.geekbang.org/account/avatar/00/10/13/34/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1532094264,"is_pvip":false,"replies":[{"id":5822,"content":"抱歉，对.net不熟悉😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532175074,"ip_address":"","comment_id":16679,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师，.net有没有规则引擎项目推荐","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420898,"discussion_content":"抱歉，对.net不熟悉😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532175074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16598,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1532048763,"is_pvip":false,"replies":[{"id":5762,"content":"注册都是要自己注册的，但是服务发现和路由处理不一样，一个是服务自己完成发现和路由，一个是代理去完成发现和路由","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068147,"ip_address":"","comment_id":16598,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师关于服务发现主要有两种实现方式：自理式和代理式，我没有听明白。我理解两种方式的服务注册都是一样的，都是需要服务实例自己去注册，对比两种服务发现方式代理方式的负载均衡通过图示感觉多过了一道。没有任何意义。不知道负载均衡的意义何在？谢谢。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420863,"discussion_content":"注册都是要自己注册的，但是服务发现和路由处理不一样，一个是服务自己完成发现和路由，一个是代理去完成发现和路由","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16497,"user_name":"kaola","can_delete":false,"product_type":"c1","uid":1136365,"ip_address":"","ucode":"208D28CC2C08E6","user_header":"","comment_is_top":false,"comment_ctime":1531985506,"is_pvip":false,"replies":[{"id":5768,"content":"网关不要有业务逻辑，因此你说的调度模块不适合放到网关，应该放到a服务去调用b服务。\n至于流程设计，a服务可以采用规则引擎，或者有一个独立的服务c基于规则引擎配置业务逻辑，然后根据逻辑调用a或者b服务","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532068725,"ip_address":"","comment_id":16497,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师，我想问下是不是有服务统一调度的模块，比如一个基本的银行转账业务，我们把该业务的调度流程参数化到表中，比如第一步要调用存款服务的转账功能，第二步调用会计服务的流水登记功能，假设调度表中对于活期转账已经配置了两个步骤，那调度模块就根据配置依次顺序调用微服务a存款服务和b会计服务，那调度模块是放在api网关做总体调度还是让微服务a自发去调用微服务b吗？哪种合理？还是说调度参数化这种设计不好?在服务a中写死调用服务b?","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420822,"discussion_content":"网关不要有业务逻辑，因此你说的调度模块不适合放到网关，应该放到a服务去调用b服务。\n至于流程设计，a服务可以采用规则引擎，或者有一个独立的服务c基于规则引擎配置业务逻辑，然后根据逻辑调用a或者b服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532068725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16453,"user_name":"阿飞","can_delete":false,"product_type":"c1","uid":1086104,"ip_address":"","ucode":"5D31D03003988C","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/98/064ce708.jpg","comment_is_top":false,"comment_ctime":1531964156,"is_pvip":false,"replies":[{"id":5949,"content":"太乐观了，用开源方案都没那么快😊","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1532425518,"ip_address":"","comment_id":16453,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"按照三个火枪手原则和按业务拆分，先把服务拆分三个小组，3个人：自动化测试、自动化部署 、配置中心   \n3个人:接口框架、API网关 \n4个人:服务发现、服务路由、服务容错、服务监控、服务跟踪、服务安全\n按照以上划分差不多个月完成基础架构开发","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420801,"discussion_content":"太乐观了，用开源方案都没那么快😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532425518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16421,"user_name":"顾慎为","can_delete":false,"product_type":"c1","uid":1118826,"ip_address":"","ucode":"E58CCF424A7B79","user_header":"https://static001.geekbang.org/account/avatar/00/11/12/6a/25a97cce.jpg","comment_is_top":false,"comment_ctime":1531956271,"is_pvip":false,"replies":[{"id":5701,"content":"服务安全就包括鉴权，接入安全就是鉴权","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1531965814,"ip_address":"","comment_id":16421,"utype":1}],"discussion_count":1,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"我想问一下，微服务内部不需要做鉴权吗？如果被入侵了咋办？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420791,"discussion_content":"服务安全就包括鉴权，接入安全就是鉴权","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531965814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16428,"user_name":"kyll","can_delete":false,"product_type":"c1","uid":1103329,"ip_address":"","ucode":"2425DCF5753786","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/e1/a05a9e22.jpg","comment_is_top":false,"comment_ctime":1531958844,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"按照我们公司的情况来说，1.5个人，spring全家桶，花费6个月，才让系统上线。\n要是完全自研，10个高程在，也信心不大。","like_count":9},{"had_liked":false,"id":44721,"user_name":"易燃易爆炸","can_delete":false,"product_type":"c1","uid":1115949,"ip_address":"","ucode":"081F5310EB6D61","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/2d/0ac560a6.jpg","comment_is_top":false,"comment_ctime":1543481868,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"自己写的话肯定坑太多，也没有经过太多实践上的检验。感觉真正稳定下来需要躺过很多坑才行，当然成长也是成倍的，最终苦了公司，系统天天挂。","like_count":8},{"had_liked":false,"id":85016,"user_name":"吴小智","can_delete":false,"product_type":"c1","uid":1310798,"ip_address":"","ucode":"C7C9F58B5C9F7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/4e/be2b206b.jpg","comment_is_top":false,"comment_ctime":1554956925,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"老师讲到很好，不过由于自己还是在校生，没经历过，只能得到感性的认识，谢谢老师","like_count":2},{"had_liked":false,"id":288839,"user_name":"prader26","can_delete":false,"product_type":"c1","uid":1433707,"ip_address":"","ucode":"5EFFFC374ADECE","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/6b/f61d7466.jpg","comment_is_top":false,"comment_ctime":1618725432,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"微服务的基础设施：\n1 自动化测试\n2 自动化部署\n3 配置中心\n4 接口框架\n5 API 网关\n6 服务发现\n7 服务路由\n8 服务容错\n9 服务监控\n10 服务跟踪\n11 服务安全","like_count":0},{"had_liked":false,"id":130358,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1567432890,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"看完后估不出具体工时，因为具体多复杂不太清楚，而且自顶倒下的工时估算方式是不准确的。如果可能我会把活先分出去，然后让他们给个排期，再看看具体情况给出一个总工期。\n不过，这个东西不好做到是真的，否则大家都自研了，目前应该只有某些大厂才有人力、财力、物力来弄。十个人左右估计需要一年多的时间，如果比较完善的弄出来估计需要三年左右，需要经历大促或者其他流量高峰的考验。还有不断的完善功能，提高效率，提升用户体验。","like_count":0},{"had_liked":false,"id":49306,"user_name":"乘风","can_delete":false,"product_type":"c1","uid":1115724,"ip_address":"","ucode":"0420C5535DACB7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwSoTjHPX5tm4whBSfoZLX6toZxrZGUaLABQywKNf4MDc9toK3QSV7Z99ATcGicFCysoleQ5ISzmw/132","comment_is_top":false,"comment_ctime":1544663543,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"        上面一共提到11个功能，每个功能按照业务职责去分可以分成11个服务，但按照三个火枪手原则来拆分服务大概是4个服务，拆分如下：\n按照业务拆分：分为三类：\n    1.构建微服务的的内部依赖：接口框架、服务路由、服务容错、服务安全\n    2.构建微服务的外部依赖：配置中心、api网关、服务发现、\n    2.服务可持续集成、监控相关，与服务间无强关联的：自动化测试、自动化部署、服务监控、服务追踪。\n\n    按照服务性能+可靠性拆分为两类，性能要求低，对内部应用提供服务：配置中心、服务发现， 性能要求高，对外部请求提供服务，保证性能要求高的处理速率和高可用：api网关，如果网关宕机则整个系统无法对外提供服务。\n    最后拆分为4个服务：\n        A：接口框架、服务路由、服务容错、服务安全\n        B：配置中心、服务发现、\n        C：api网关\n        D： 自动化测试、自动化部署、服务监控、服务追踪\n    预测时间无法预测，","like_count":0},{"had_liked":false,"id":37947,"user_name":"😂😂😂","can_delete":false,"product_type":"c1","uid":1102119,"ip_address":"","ucode":"25C8AB9315FE4B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/27/e364df55.jpg","comment_is_top":false,"comment_ctime":1541821369,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"我司就在往Spring cloud迁移，期间还要开发新需求，目前6个后台，都不是高程，领导让年底之前完成，以后会不会累成狗。","like_count":0},{"had_liked":false,"id":16425,"user_name":"星火燎原","can_delete":false,"product_type":"c1","uid":1101373,"ip_address":"","ucode":"15AD8E3006E107","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/3d/385b8263.jpg","comment_is_top":false,"comment_ctime":1531958671,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"估计得一年ᵋ😤ᵌ","like_count":0},{"had_liked":false,"id":49306,"user_name":"乘风","can_delete":false,"product_type":"c1","uid":1115724,"ip_address":"","ucode":"0420C5535DACB7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwSoTjHPX5tm4whBSfoZLX6toZxrZGUaLABQywKNf4MDc9toK3QSV7Z99ATcGicFCysoleQ5ISzmw/132","comment_is_top":false,"comment_ctime":1544663543,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"        上面一共提到11个功能，每个功能按照业务职责去分可以分成11个服务，但按照三个火枪手原则来拆分服务大概是4个服务，拆分如下：\n按照业务拆分：分为三类：\n    1.构建微服务的的内部依赖：接口框架、服务路由、服务容错、服务安全\n    2.构建微服务的外部依赖：配置中心、api网关、服务发现、\n    2.服务可持续集成、监控相关，与服务间无强关联的：自动化测试、自动化部署、服务监控、服务追踪。\n\n    按照服务性能+可靠性拆分为两类，性能要求低，对内部应用提供服务：配置中心、服务发现， 性能要求高，对外部请求提供服务，保证性能要求高的处理速率和高可用：api网关，如果网关宕机则整个系统无法对外提供服务。\n    最后拆分为4个服务：\n        A：接口框架、服务路由、服务容错、服务安全\n        B：配置中心、服务发现、\n        C：api网关\n        D： 自动化测试、自动化部署、服务监控、服务追踪\n    预测时间无法预测，","like_count":0},{"had_liked":false,"id":37947,"user_name":"😂😂😂","can_delete":false,"product_type":"c1","uid":1102119,"ip_address":"","ucode":"25C8AB9315FE4B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/27/e364df55.jpg","comment_is_top":false,"comment_ctime":1541821369,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"我司就在往Spring cloud迁移，期间还要开发新需求，目前6个后台，都不是高程，领导让年底之前完成，以后会不会累成狗。","like_count":0},{"had_liked":false,"id":16425,"user_name":"星火燎原","can_delete":false,"product_type":"c1","uid":1101373,"ip_address":"","ucode":"15AD8E3006E107","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/3d/385b8263.jpg","comment_is_top":false,"comment_ctime":1531958671,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"估计得一年ᵋ😤ᵌ","like_count":0}]}