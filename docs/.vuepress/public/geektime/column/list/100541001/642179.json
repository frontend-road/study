{"id":642179,"title":"02｜无需任何机器学习，如何利用大语言模型做情感分析？","content":"<p>你好，我是徐文浩。</p><p>上一讲我们看到了，大型语言模型的接口其实非常简单。像OpenAI就只提供了Complete和Embedding两个接口，其中，Complete可以让模型根据你的输入进行自动续写，Embedding可以将你输入的文本转化成向量。</p><p>不过到这里，你的疑问可能就来了。不是说现在的大语言模型很厉害吗？传统的自然语言处理问题都可以通过大模型解决。可是用这么简单的两个API，能够完成原来需要通过各种NLP技术解决的问题吗？比如情感分析、文本分类、文章聚类、摘要撰写、搜索，这一系列问题怎么通过这两个接口解决呢？</p><p>别急，在接下来的几讲里，我会告诉你，怎么利用大语言模型提供的这两个简单的API来解决传统的自然语言处理问题。这一讲我们就先从一个最常见的自然语言处理问题——“情感分析”开始，来看看我们怎么把大语言模型用起来。</p><h2>传统的二分类方法：朴素贝叶斯与逻辑回归</h2><p>“情感分析”问题，是指我们根据一段文字，去判断它的态度是正面的还是负面的。在传统的互联网产品里，经常会被用来分析用户对产品、服务的评价。比如大众点评里面，你对餐馆的评论，在京东买个东西，你对商品的评论，都会被平台拿去分析，给商家或者餐馆的评分做参考。也有些品牌，会专门抓取社交网络里用户对自己产品的评价，来进行情感分析，判断消费者对自己的产品评价是正面还是负面的，并且会根据这些评价来改进自己的产品。</p><!-- [[[read_end]]] --><p>对于“情感分析”类型的问题，传统的解决方案就是<strong>把它当成是一个分类问题</strong>，也就是先拿一部分评论数据，人工标注一下这些评论是正面还是负面的。如果有个用户说“这家餐馆真好吃”，那么就标注成“正面情感”。如果有个用户说“这个手机质量不好”，那么就把对应的评论标注成负面的。</p><p>我们把标注好的数据，喂给一个机器学习模型，训练出一组参数。然后把剩下的没有人工标注过的数据也拿给训练好的模型计算一下。模型就会给你一个分数或者概率，告诉你这一段评论的感情是正面的，还是负面的。</p><p>可以用来做情感分析的模型有很多，这些算法背后都是基于某一个数学模型。比如，很多教科书里，就会教你用<strong>朴素贝叶斯算法</strong>来进行垃圾邮件分类。朴素贝叶斯的模型，就是简单地统计每个单词和好评差评之间的条件概率。一般来说，如果一个词语在差评里出现的概率比好评里高得多，那这个词语所在的评论，就更有可能是一个差评。</p><p>$$      P(c|x)=\\frac{P(x|c)P©}{P(x)}$$</p><p>$$P(c|X) \\propto P(x_{1}|c)\\times P(x_{2}|c)\\times ···\\times P(x_{n}|c)\\times P©$$</p><p>假设我们有一个训练集包含4封邮件，其中2封是垃圾邮件，2封是非垃圾邮件。训练集里的邮件包含这些单词。</p><p><img src=\"https://static001.geekbang.org/resource/image/d0/c5/d0d33ccd0c43603bb127fcb868b79ec5.png?wh=2123x840\" alt=\"图片\"></p><p>然后来了一封新邮件，里面的单词是：buy、money、sell。</p><p>通过这些单词出现的概率，我们很容易就可以预先算出这封邮件是垃圾邮件还是普通邮件。</p><ul>\n<li>$P(buy|垃圾) = 2 \\div 2 = 1$</li>\n<li>$P(money|垃圾) = 2 \\div 2 = 1$</li>\n<li>$P(sell|垃圾) = 1 \\div 2 = 0.5$</li>\n<li>$P(buy|普通) = 0 \\div 2 =0$</li>\n<li>$P(money|普通) = 0 \\div 2 =0$</li>\n<li>$P(sell|普通) = 1 div 2 =0.5$</li>\n</ul><p>然后我们把这封邮件里所有词语的条件概率用全概率公式乘起来，就得到了这封邮件是垃圾邮件还有普通邮件的概率。</p><p>$$P(垃圾|X) \\propto P(buy|垃圾) \\times P(money|垃圾) \\times P(sell|垃圾) \\times P(垃圾) = 1 \\times 1 \\times 0.5  \\times 0.5 = 0.25$$</p><p>$$P(普通|X) \\propto P(buy|普通) \\times P(money|普通) \\times P(sell|普通) \\times P(普通) =  0 \\times 0 \\times 0.5 \\times 0.5 = 0$$</p><p>在这里，我们发现 $P(垃圾|X) &gt; P(普通|X)$，而且 $P(普通|X)$ 其实等于0。那如果用朴素贝叶斯算法，我们就会认为这封邮件100%是垃圾邮件。如果你觉得自己数学不太好，这个例子没有看明白也没有关系，因为我们接下来的AI应用开发都不需要预先掌握这些数学知识，所以不要有心理负担。</p><p>类似的，像逻辑回归、随机森林等机器学习算法都可以拿来做分类。你在网上，特别是 Kaggle 这个机器学习比赛的网站里，可以搜索到很多其他人使用这些传统方法来设计情感分析的解决方案。这些方案都以Jupyter Notebook的形式出现，我在这里放个<a href=\"https://www.kaggle.com/code/ankumagawa/sentimental-analysis-using-naive-bayes-classifier\">链接</a>，你有兴趣的话也可以去研究一下。</p><h2>传统方法的挑战：特征工程与模型调参</h2><p>但这些传统的机器学习算法，想要取得好的效果，还是颇有门槛的。除了要知道有哪些算法可以用，还有两方面的工作非常依赖经验。</p><h3>特征工程</h3><p>第一个是特征工程。对于很多自然语言问题，如果我们只是拿一段话里面是否出现了特定的词语来计算概率，不一定是最合适的。比如“这家餐馆太糟糕了，一点都不好吃”和 “这家餐馆太好吃了，一点都不糟糕”这样两句话，从意思上是完全相反的。但是里面出现的词语其实是相同的。在传统的自然语言处理中，我们会通过一些特征工程的方法来解决这个问题。</p><p>比如，我们不只是采用单个词语出现的概率，还增加前后两个或者三个相连词语的组合，也就是通过所谓的2-Gram（Bigram双字节词组）和3-Gram（Trigram三字节词组）也来计算概率。在上面这个例子里，第一句差评，就会有“太”和“糟糕”组合在一起的“太糟糕”，以及“不”和“好吃”组合在一起的“不好吃”。而后面一句里就有“太好吃”和“不糟糕”两个组合。有了这样的2-Gram的组合，我们判断用户好评差评的判断能力就比光用单个词语是否出现要好多了。</p><p>这样的特征工程的方式有很多，比如<strong>去除停用词</strong>，也就是“的地得”这样的词语，<strong>去掉过于低频的词语</strong>，比如一些偶尔出现的专有名词。或者对于有些词语特征采用 <strong>TF-IDF</strong>（词频-逆文档频率）这样的统计特征，还有在英语里面对不同时态的单词统一换成现在时。</p><p>不同的特征工程方式，在不同的问题上效果不一样，比如我们做情感分析，可能就需要保留标点符号，因为像“！”这样的符号往往蕴含着强烈的情感特征。但是，这些种种细微的技巧，让我们在想要解决一个简单的情感分析问题时，也需要撰写大量文本处理的代码，还要了解针对当前特定场景的技巧，这非常依赖工程师的经验。</p><h3>机器学习相关经验</h3><p>第二个就是你需要有相对丰富的机器学习经验。除了通过特征工程设计更多的特征之外，我们还需要了解很多机器学习领域里常用的知识和技巧。比如，我们需要将数据集切分成训练（Training）、验证（Validation）、测试（Test）三组数据，然后通过AUC或者混淆矩阵（Confusion Matrix）来衡量效果。如果数据量不够多，为了训练效果的稳定性，可能需要采用 K-Fold 的方式来进行训练。</p><p>如果你没有接触过机器学习，看到这里，可能已经看懵了。没关系，上面的大部分知识你未来可能都不需要了解了，因为我们有了大语言模型，可以通过它提供的Completion和Embedding这两个API，用不到10行代码就能完成情感分析，并且能获得非常好的效果。</p><h2>大语言模型：20行代码的情感分析解决方案</h2><p>通过大语言模型来进行情感分析，最简单的方式就是利用它提供的Embedding这个API。这个API可以把任何你指定的一段文本，变成一个大语言模型下的向量，也就是用一组固定长度的参数来代表任何一段文本。</p><p>我们需要提前计算“好评”和“差评”这两个字的Embedding。而对于任何一段文本评论，我们也都可以通过API拿到它的Embedding。那么，我们把这段文本的Embedding和“好评”以及“差评”通过余弦距离（Cosine Similarity）计算出它的相似度。然后我们拿这个Embedding和“好评”之间的相似度，去减去和“差评”之间的相似度，就会得到一个分数。如果这个分数大于0，那么说明我们的评论和“好评”的距离更近，我们就可以判断它为好评。如果这个分数小于0，那么就是离差评更近，我们就可以判断它为差评。</p><p>下面我们就用这个方法分析一下两条在京东上购买了iPhone用户的评论。</p><p><img src=\"https://static001.geekbang.org/resource/image/ff/7d/ff7a7da002113b2fd345dc598e1aeb7d.png?wh=1920x642\" alt=\"图片\"></p><p>这个使用大模型的方法一共不到40行代码，我们看看它能否帮助我们快速对这两条评论进行情感分析。</p><pre><code class=\"language-python\">from openai import OpenAI\nimport numpy as np\nimport os\n\nclient = OpenAI(api_key=os.environ['OPENAI_API_KEY'])\n\nEMBEDDING_MODEL = \"text-embedding-ada-002\"\n\ndef get_embedding(text, model=EMBEDDING_MODEL):\n   text = text.replace(\"\\n\", \" \")\n   return client.embeddings.create(input = [text], model=model).data[0].embedding\n\ndef cosine_similarity(vector_a, vector_b):\n  dot_product = np.dot(vector_a, vector_b)\n  norm_a = np.linalg.norm(vector_a)\n  norm_b = np.linalg.norm(vector_b)\n  epsilon = 1e-10\n  cosine_similarity = dot_product / (norm_a * norm_b + epsilon)\n  return cosine_similarity\n\npositive_review = get_embedding(\"好评\")\nnegative_review = get_embedding(\"差评\")\n\npositive_example = get_embedding(\"买的银色版真的很好看，一天就到了，晚上就开始拿起来完系统很丝滑流畅，做工扎实，手感细腻，很精致哦苹果一如既往的好品质\")\nnegative_example = get_embedding(\"随意降价，不予价保，服务态度差\")\n\ndef get_score(sample_embedding):\n  return cosine_similarity(sample_embedding, positive_review) - cosine_similarity(sample_embedding, negative_review)\n\npositive_score = get_score(positive_example)\nnegative_score = get_score(negative_example)\n\nprint(\"好评例子的评分 : %f\" % (positive_score))\nprint(\"差评例子的评分 : %f\" % (negative_score))\n\n</code></pre><p>输出结果：</p><pre><code class=\"language-python\">好评例子的评分 : 0.070963\n差评例子的评分 : -0.081472\n</code></pre><p>正如我们所料，京东上的好评通过Embedding相似度计算得到的分数是大于0的，京东上面的差评，这个分数是小于0的。</p><p>这样的方法，是不是特别简单？我们再拿刚才的例子试一下，看看这个方法是不是对所有词语都管用，只是出现的位置不同但含义截然相反的评论，能得到什么样的结果。</p><pre><code class=\"language-python\">good_restraurant = get_embedding(\"这家餐馆太好吃了，一点都不糟糕\")\nbad_restraurant = get_embedding(\"这家餐馆太糟糕了，一点都不好吃\")\n\ngood_score = get_score(good_restraurant)\nbad_score = get_score(bad_restraurant)\nprint(\"好评餐馆的评分 : %f\" % (good_score))\nprint(\"差评餐馆的评分 : %f\" % (bad_score))\n</code></pre><p>输出结果：</p><pre><code class=\"language-python\">好评餐馆的评分 : 0.062719\n差评餐馆的评分 : -0.074591\n</code></pre><p>可以看到，虽然两句话分别是“太好吃”“不糟糕”和“太糟糕”“不好吃”，其实词语都一样，但是大语言模型一样能够帮助我们判断出来他们的含义是不同的，一个更接近好评，一个更接近差评。</p><h2>更大的数据集上的真实案例</h2><p>在这里，我们只举了几个例子，看起来效果还不错。这会不会只是我们运气好呢？我们再来拿一个真实的数据集验证一下，利用这种方法进行情感分析的准确率能够到多少。</p><p>下面这段代码，是来自OpenAI Cookbook里面的一个例子。它是用同样的方法，来判断亚马逊提供的用户对一些食物的评价，这个评价数据里面，不只有用户给出的评论内容，还有用户给这些食物打了几颗星。这些几颗星的信息，正好可以拿来验证我们这个方法有多准。对于用户打出1～2星的，我们认为是差评，对于4～5星的，我们认为是好评。</p><p>我们可以通过Pandas，将这个CSV数据读取到内存里面。为了避免重新调用OpenAI的API浪费钱，这个数据集里，已经将获取到的Embedding信息保存下来了，不需要再重新计算。</p><pre><code class=\"language-python\">import pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\ndatafile_path = \"data/fine_food_reviews_with_embeddings_1k.csv\"\n\ndf = pd.read_csv(datafile_path)\ndf[\"embedding\"] = df.embedding.apply(eval).apply(np.array)\n\n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[\"sentiment\"] = df.Score.replace({1: \"negative\", 2: \"negative\", 4: \"positive\", 5: \"positive\"})\n</code></pre><p>每一条评论都用我们上面的方法，和一个预先设定好的好评和差评的文本去做对比，然后看它离哪个近一些。这里的好评和差评，我们写得稍微长了一点，分别是 “An Amazon review with a negative sentiment.” 和 “An Amazon review with a positive sentiment.”。</p><p>在计算完结果之后，我们利用Scikit-learn这个机器学习的库，将我们的预测值和实际用户打出的星数做个对比，然后输出对比结果。需要的代码，也就不到20行。</p><pre><code class=\"language-python\">from sklearn.metrics import PrecisionRecallDisplay\n\ndef evaluate_embeddings_approach(\n    labels = ['negative', 'positive'], \n    model = EMBEDDING_MODEL,\n):\n    label_embeddings = [get_embedding(label, engine=model) for label in labels]\n\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\n    probas = df[\"embedding\"].apply(lambda x: label_score(x, label_embeddings))\n    preds = probas.apply(lambda x: 'positive' if x&gt;0 else 'negative')\n\n    report = classification_report(df.sentiment, preds)\n    print(report)\n\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label='positive')\n    _ = display.ax_.set_title(\"2-class Precision-Recall curve\")\n\nevaluate_embeddings_approach(labels=['An Amazon review with a negative sentiment.', 'An Amazon review with a positive sentiment.'])\n</code></pre><p>输出结果：</p><pre><code class=\"language-python\">              precision    recall  f1-score   support\n    negative       0.98      0.73      0.84       136\n    positive       0.96      1.00      0.98       789\n    accuracy                           0.96       925\n   macro avg       0.97      0.86      0.91       925\nweighted avg       0.96      0.96      0.96       925\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/0f/3b/0ffa4e45899cd50bc5ac7e5ea0f89c3b.png?wh=392x278\" alt=\"图片\"></p><p>在结果里面可以看到，我们这个简单方法判定的好评差评的精度，也就是 precision 在 negative 和 positive里，分别是0.98和0.96，也就是在95%以上。</p><p>而召回率，也就是图里的 recall，在差评里稍微欠缺一点，只有73%，这说明还是有不少差评被误判为了好评。不过在好评里，召回率则是100%，也就是100%的好评都被模型找到了。这样综合考虑下来的整体准确率，高达96%。而要达到这么好的效果，我们不需要进行任何机器学习训练，只需要几行代码调用一下大模型的接口，计算一下几个向量的相似度就好了。</p><h2>小结</h2><p>这一讲，我们利用不同文本在大语言模型里Embedding之间的距离，来进行情感分析。这种使用大语言模型的技巧，一般被称做零样本分类（Zero-Shot Classification）。</p><p>所谓零样本分类，也就是我们不需要任何新的样本来训练机器学习的模型，就能进行分类。我们认为，之前经过预训练的大语言模型里面，已经蕴含了情感分析的知识。我们只需要简单利用大语言模型里面知道的“好评”和“差评”的概念信息，就能判断出它从未见过的评论到底是好评还是差评。</p><p>这个方法，在一些经典的数据集上，轻易就达到了95%以上的准确度。同时，也让一些原本需要机器学习研发经验才能完成的任务变得更加容易，从而大大降低了门槛。</p><p>如果你所在的公司今天想要做一个文本分类的应用，通过OpenAI的API用几分钟时间就能得到想要的结果。</p><h2>课后练习</h2><p>利用大模型来解决问题，不是一个理论问题，而是一个实战问题。请你尝试将这个方法运用在别的数据集上，看看是否也会有很好的效果？比如，你可以试着用Kaggle提供的亚马逊耳机类商品的评论数据，看看结果是怎样的？这个数据集比较大，你可以挑几条数据试一下。因为OpenIA会对你的调用限速，免费的Token数量也比较有限。对于限速情况下的大批量数据的处理，我们会在第04讲讲解。</p><p>数据集链接：<a href=\"https://www.kaggle.com/datasets/shitalkat/amazonearphonesreviews\">https://www.kaggle.com/datasets/shitalkat/amazonearphonesreviews</a></p><p>欢迎你把你的结果分享到评论区，也欢迎你把这节课分享给感兴趣的朋友，我们下节课再见！</p>","neighbors":{"left":{"article_title":"01｜重新出发，让我们学会和AI说话","id":641742},"right":{"article_title":"03｜巧用提示语，说说话就能做个聊天机器人","id":642197}},"comments":[{"had_liked":false,"id":372748,"user_name":"Dev.lu","can_delete":false,"product_type":"c1","uid":1266108,"ip_address":"新加坡","ucode":"A1F727C92A1E5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/51/bc/c7514a30.jpg","comment_is_top":false,"comment_ctime":1681548260,"is_pvip":false,"replies":[{"id":136092,"content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1681613291,"ip_address":"上海","comment_id":372748,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"conda install -c conda-forge matplotlib\nconda install -c conda-forge plotly   \nconda install -c anaconda scikit-learn\n跑情感分析的部分，可能需要额外安装这些包","like_count":21,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613933,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681613291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1108464,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e9/f0/b9796dee.jpg","nickname":"Leo","note":"","ucode":"1B4777E8A895DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620134,"discussion_content":"运行的时候报错了，给出来真棒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685854468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖北","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1085399,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8f/d7/f790d3f5.jpg","nickname":"Geek_cf1681","note":"","ucode":"B30AE4E23BE88C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617680,"discussion_content":"同发现，更新到教程里最好了。教程不错。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683773589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371019,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"浙江","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1679462943,"is_pvip":false,"replies":[{"id":135381,"content":"它是根据海量的预训练数据在高维空间里给他们两个找了个位置，我们只是我们拿到的评论离哪个位置近。\n\n大模型的语义理解能力，就没法用一两句话说清了。如果真的想要知道，还是要深入理解深度学习，可以去看看李沐老师的论文解读系列。https:&#47;&#47;www.bilibili.com&#47;video&#47;BV1AF411b7xQ&#47;","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679543446,"ip_address":"美国","comment_id":371019,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"大模型是怎么知道好评和差评是代表什么意思的呢","like_count":21,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610391,"discussion_content":"它是根据海量的预训练数据在高维空间里给他们两个找了个位置，我们只是我们拿到的评论离哪个位置近。\n\n大模型的语义理解能力，就没法用一两句话说清了。如果真的想要知道，还是要深入理解深度学习，可以去看看李沐老师的论文解读系列。https://www.bilibili.com/video/BV1AF411b7xQ/","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1679543446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"美国","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2399111,"avatar":"https://static001.geekbang.org/account/avatar/00/24/9b/87/35639b9a.jpg","nickname":"北极有雪","note":"","ucode":"E9BFB1B20390D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626842,"discussion_content":"我的理解:需要人工给数据集，人工会把好帅，帅，真的帅标注为褒义词，把好丑，丑，真的丑标注为贬义词，形成海量的集，然后大模型生成对应的词的一个值（形成集合），用户输的词去匹配集合，并返回","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693442816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2526351,"avatar":"https://static001.geekbang.org/account/avatar/00/26/8c/8f/bdf9df82.jpg","nickname":"天行","note":"","ucode":"628E7BCE3D6D7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625900,"discussion_content":"就当这是魔法，念对咒语就能生效就行了，不用知道为什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692318289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452167,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","nickname":"Geek_93970d","note":"","ucode":"52AC308BEC7737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617526,"discussion_content":"哟西","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683631185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374034,"user_name":"Geek_035566","can_delete":false,"product_type":"c1","uid":2047648,"ip_address":"广东","ucode":"2BE5D4551F46AF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLLqPl9wGGaKWD8sXcB6oicibvUzBZ3zaPyicTVwZQnUQEYyhaGTf4YmVIWMX0oEcfKibZ0JlZsMZYvjw/132","comment_is_top":false,"comment_ctime":1683523721,"is_pvip":false,"replies":[{"id":136831,"content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684741891,"ip_address":"上海","comment_id":374034,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"知乎上张俊林对GPT对NLP的影响做了很好解读，我这个小白听了也能有很深的理解。\n\n他把NLP解决的问题分为中间任务和最终任务，先阐述中间任务其实是人类没有找到更好办法处理自然语言时想出来的辅助工具，GPT的出现一瞬间让这些脚手架都没了用处。\n\n再进一步，他又把最终任务分为自然语言理解和自然语言生成任务，进一步分析GPT对这两类任务的影响。\n\n很简洁优美的讲清楚了GPT对NLP的冲击，知乎地址我放下面，感兴趣的可以自己看。\nhttps:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;597586623","like_count":19,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618998,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2011138,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b0/02/98f8b0ee.jpg","nickname":"方华Elton","note":"","ucode":"180D03AADB5D2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618583,"discussion_content":"感谢分享，确实中间任务在GPT出来之后，完全被替代了，最终任务的能力对应着openai提供的接口compeletion(自然语言生成)和embedding（自然语言理解）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684342123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"辽宁","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372188,"user_name":"jo","can_delete":false,"product_type":"c1","uid":1622897,"ip_address":"上海","ucode":"A9D507236F8CBC","user_header":"https://static001.geekbang.org/account/avatar/00/18/c3/71/e7990e80.jpg","comment_is_top":false,"comment_ctime":1680832300,"is_pvip":false,"replies":[{"id":135898,"content":"不理解什么是向量的余弦距离，可以问问ChatGPT：\n\n什么是向量的余弦距离？\n\n向量的余弦距离是用于度量两个向量之间的相似性的一种方法。它衡量的是两个向量之间的夹角的余弦值。\n\n具体来说，假设有两个n维向量a和b，其余弦距离为cos(θ)，其中θ是a和b之间的夹角，计算公式如下：\n\ncos(θ) = (a·b) &#47; (||a|| ||b||)\n\n其中，a·b表示向量a和向量b的点积，||a||和||b||分别表示向量a和向量b的范数。\n\n余弦距离的取值范围在[-1, 1]之间，当两个向量之间的夹角越小时，余弦距离越接近1，表示两个向量越相似；当两个向量之间的夹角越大时，余弦距离越接近-1，表示两个向量越不相似。当夹角为90度时，余弦距离为0，表示两个向量完全不相关。\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680974980,"ip_address":"日本","comment_id":372188,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"“我们把这段文本的 Embedding 和“好评”以及“差评”通过余弦距离（Cosine Similarity）计算出它的相似度”，不太懂","like_count":15,"discussions":[{"author":{"id":1547207,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9b/c7/0f3b699f.jpg","nickname":"朋克是夏天的冰镇雪碧","note":"","ucode":"C035E91B744331","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614335,"discussion_content":"画个图比较好理解，不过极客时间评论没法带图，我在老师课程的 github 仓库提了个 issue，这是链接 https://github.com/xuwenhao/geektime-ai-course/issues/3","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1681745366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612894,"discussion_content":"不理解什么是向量的余弦距离，可以问问ChatGPT：\n\n什么是向量的余弦距离？\n\n向量的余弦距离是用于度量两个向量之间的相似性的一种方法。它衡量的是两个向量之间的夹角的余弦值。\n\n具体来说，假设有两个n维向量a和b，其余弦距离为cos(θ)，其中θ是a和b之间的夹角，计算公式如下：\n\ncos(θ) = (a·b) / (||a|| ||b||)\n\n其中，a·b表示向量a和向量b的点积，||a||和||b||分别表示向量a和向量b的范数。\n\n余弦距离的取值范围在[-1, 1]之间，当两个向量之间的夹角越小时，余弦距离越接近1，表示两个向量越相似；当两个向量之间的夹角越大时，余弦距离越接近-1，表示两个向量越不相似。当夹角为90度时，余弦距离为0，表示两个向量完全不相关。\n\n","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1680974980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"日本","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371011,"user_name":"Roy Liang","can_delete":false,"product_type":"c1","uid":1098898,"ip_address":"浙江","ucode":"1DF5FC831A35DA","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/92/338b5609.jpg","comment_is_top":false,"comment_ctime":1679459815,"is_pvip":false,"replies":[{"id":135358,"content":"这个是API限速导致的，我们在第4讲里会讲解应该怎么处理。\n这个思考题看来是我考虑不周了，我建议拿个100条试一下吧，全量数据可以看完第四讲之后再来，而且需要注意Token费用问题。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540184,"ip_address":"上海","comment_id":371011,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"课后作业，全部数据集是不是太多，出不了结果，前33条记录没问题，我是不是该给OpenAI充值？\n\n              precision    recall  f1-score   support\n\n    negative       0.81      0.93      0.87        14\n    positive       0.92      0.79      0.85        14\n\n    accuracy                           0.86        28\n   macro avg       0.86      0.86      0.86        28\nweighted avg       0.86      0.86      0.86        28\n\n代码\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report,PrecisionRecallDisplay\nfrom openai.embeddings_utils import cosine_similarity, get_embedding\n\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n\n#datafile_path = &quot;data&#47;AllProductReviews.csv&quot;\ndatafile_path = &quot;data&#47;test.csv&quot;\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x: get_embedding(x, engine=EMBEDDING_MODEL))\n\n# convert 5-star rating to binary sentiment\ndf = df[df.ReviewStar != 3]\ndf[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n\ndef evaluate_embeddings_approach(\n    labels = [&#39;negative&#39;, &#39;positive&#39;],\n    model = EMBEDDING_MODEL,\n):\n    label_embeddings = [get_embedding(label, engine=model) for label in labels]\n\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)\n\n    report = classification_report(df.sentiment, preds)\n    print(report)\n\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n\nevaluate_embeddings_approach()","like_count":8,"discussions":[{"author":{"id":2859906,"avatar":"","nickname":"Geek_654366","note":"","ucode":"96A16DD36154BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616115,"discussion_content":"建议徐老师可以加一些代码注释，让我们这些不懂代码的小白可以理解这些内容","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1682591758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610356,"discussion_content":"这个是API限速导致的，我们在第4讲里会讲解应该怎么处理。\n这个思考题看来是我考虑不周了，我建议拿个100条试一下吧，全量数据可以看完第四讲之后再来，而且需要注意Token费用问题。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679540184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2859906,"avatar":"","nickname":"Geek_654366","note":"","ucode":"96A16DD36154BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616114,"discussion_content":"df = pd.read_csv(datafile_path,nrows=100,encoding=&#39;ANSI&#39;)，加上了这个限制，\n              precision    recall  f1-score   support\n\n    negative       0.93      0.74      0.82        38\n    positive        0.83       0.96       0.89        50\n\n    accuracy                                 0.86         88\n   macro avg        0.88      0.85      0.86        88\nweighted avg       0.87      0.86      0.86        88","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682591660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796939,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/6b/4b/4a622bdf.jpg","nickname":"四月.  🕊","note":"","ucode":"C8B8C3605AB67A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611484,"discussion_content":"df[&#34;embedding&#34;]=df.ReviewBody.apply(lambda x: get_embedding(x, engine=EMBEDDING_MODEL)) 这句代码很及时～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680104555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"日本","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371046,"user_name":"陈敏俊","can_delete":false,"product_type":"c1","uid":3572272,"ip_address":"上海","ucode":"4FBB6A20288FE2","user_header":"https://static001.geekbang.org/account/avatar/00/36/82/30/d48e8135.jpg","comment_is_top":false,"comment_ctime":1679478937,"is_pvip":false,"replies":[{"id":135362,"content":"这不是预先训练好的标签。而是模型根据文本，计算出来的向量，我们只是利用了向量的相似度而已。\n\n你可以用任意的单词，或者句子来做这样的功能，比如 beautiful 和 ugly，polite 和 rude 都可以试一试","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540496,"ip_address":"上海","comment_id":371046,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"文本向量positive和negative标签是openai训练标注好的，那还有其他什么标签吗？只有这两种吗？","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610363,"discussion_content":"这不是预先训练好的标签。而是模型根据文本，计算出来的向量，我们只是利用了向量的相似度而已。\n\n你可以用任意的单词，或者句子来做这样的功能，比如 beautiful 和 ugly，polite 和 rude 都可以试一试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679540496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2911084,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/6b/6c/3e80afaf.jpg","nickname":"HappyHasson","note":"","ucode":"B84CC43E349CFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":618476,"discussion_content":"老师，这个原理是什么？为什么OpenAPI可以接受任意的输入，然后输出正确的模型数据？它是怎么计算出来的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684282425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610363,"ip_address":"广东","group_id":0},"score":618476,"extra":""}]},{"author":{"id":1452167,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","nickname":"Geek_93970d","note":"","ucode":"52AC308BEC7737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617543,"discussion_content":"将单词生成 embedding 向量的算法原理是啥？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683638433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370978,"user_name":"xbc","can_delete":false,"product_type":"c1","uid":2187437,"ip_address":"海南","ucode":"03F1FD7B8CA32F","user_header":"https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg","comment_is_top":false,"comment_ctime":1679417484,"is_pvip":false,"replies":[{"id":135385,"content":"专栏的第二部分，实战应用部分里，会大量涵盖这部分内容。\n也会通过一些开源模型来降低使用的成本。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679543908,"ip_address":"美国","comment_id":370978,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"后续是否会讲讲如何使用openai api实现chatpdf这样的功能。以及使用公开的弱一些的模型，来尽量实现chatpdf的功能。","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610396,"discussion_content":"专栏的第二部分，实战应用部分里，会大量涵盖这部分内容。\n也会通过一些开源模型来降低使用的成本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679543908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"美国","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1583806,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2a/be/17c0f8ca.jpg","nickname":"Dan","note":"","ucode":"1BECA80FA3E670","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610479,"discussion_content":"chatpdf只要把文章分段总结 再把总结的内容分段总结 不就出来了 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679574837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2187437,"avatar":"https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg","nickname":"xbc","note":"","ucode":"03F1FD7B8CA32F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1583806,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2a/be/17c0f8ca.jpg","nickname":"Dan","note":"","ucode":"1BECA80FA3E670","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610688,"discussion_content":"应该是匹配问题和小段落的embedding近似度，再做个合适prompt把相关的资料都给 chatgpt 。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679681217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610479,"ip_address":"海南","group_id":0},"score":610688,"extra":""}]}]},{"had_liked":false,"id":373899,"user_name":"Geek_b7449f","can_delete":false,"product_type":"c1","uid":2957535,"ip_address":"美国","ucode":"07E7023A3ECD5A","user_header":"https://static001.geekbang.org/account/avatar/00/2d/20/df/55bacf31.jpg","comment_is_top":false,"comment_ctime":1683305263,"is_pvip":false,"replies":[{"id":136871,"content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684753144,"ip_address":"上海","comment_id":373899,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"import pandas as pd \nimport numpy as np \n\nfrom sklearn.metrics import classification_report , PrecisionRecallDisplay\nfrom openai.embeddings_utils import cosine_similarity , get_embedding\n\n# 选择用于情感分析的模型\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n# 设置数据集文件路径\ndatafile_path = &quot;data&#47;AllProductReviews.csv&quot;\n# 读取 csv 文件 只取前60行\ndf = pd.read_csv(datafile_path,nrows=60)\n# 新增一列 embedding 用于表示获取每行的ReviewBody向量值\ndf[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x:get_embedding(x,engine=EMBEDDING_MODEL))\n\n# 除去星级为3的评论来进行划分好评还是差评两个标签\ndf = df[df.ReviewStar != 3]\ndf[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n# 函数 evaluate_embeddings_approach 默认会有两个参数 label 和 model 都有对应的默认值\ndef evaluate_embeddings_approach(\n    labels = [&#39;negative&#39;, &#39;positive&#39;],\n    model = EMBEDDING_MODEL,\n):\n    # 计算每个 label 的向量值\n    label_embeddings = [get_embedding(label, engine=model) for label in labels]\n    # 辅助函数 用于计算好评和review_embedding与差评和review_embedding向量余弦值差值\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n    # 这里更新下 embedding 列 更新成对应的 分数\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    # 预测值\n    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)\n    # 生成一个分类报告\n    report = classification_report(df.sentiment, preds)\n    print(report)\n    # 这个就是绘制二分类的准确率-召回率曲线\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n# 无参数默认值调用函数\nevaluate_embeddings_approach()","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619060,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684753145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373843,"user_name":"漫游者","can_delete":false,"product_type":"c1","uid":2161554,"ip_address":"北京","ucode":"23DD0146F43C7D","user_header":"https://static001.geekbang.org/account/avatar/00/20/fb/92/0537ea08.jpg","comment_is_top":false,"comment_ctime":1683257054,"is_pvip":false,"replies":[{"id":136866,"content":"不能简单根据内容排在前面后面来判定。\n\n这样的例子本身的确人来判断也很难明确定义算好还算坏，从分数来看也比另外两个更接近0.","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684752991,"ip_address":"上海","comment_id":373843,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"negative_example = get_embedding(&quot;随意降价，不予价保，服务态度差&quot;)\n差评例子的评分 : -0.081472\nnegative_example = get_embedding(&quot;随意降价，不予价保，服务态度差，但是后续换了个客服，服务态度好多了&quot;)\n差评例子的评分 : -0.048267\nnegative_example = get_embedding(&quot;随意降价，不予价保，服务态度差，但是后续换了个客服，服务态度好多了。经过沟通解决了所有问题，好评！&quot;)\n差评例子的评分 : -0.009858\n\n通过例子看到，第三句话很明显我已经是好评了，但是模型还是给了差评的结论。是不是排在前面的句子权重更大啊？","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619052,"discussion_content":"不能简单根据内容排在前面后面来判定。\n\n这样的例子本身的确人来判断也很难明确定义算好还算坏，从分数来看也比另外两个更接近0.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684752991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371955,"user_name":"钱雨","can_delete":false,"product_type":"c1","uid":3580940,"ip_address":"河北","ucode":"E9BFF20CA8FE6E","user_header":"https://static001.geekbang.org/account/avatar/00/36/a4/0c/796de5b6.jpg","comment_is_top":false,"comment_ctime":1680542333,"is_pvip":false,"replies":[{"id":135741,"content":"python的环境的确是个问题，我看一下是否晚点能搞个Docker的Image来解决问题","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680585891,"ip_address":"上海","comment_id":371955,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"经历了无数次下面的失败，不停重新安装pillow和matplotlib之后，终于成功了。\n解决方案是狠心把miniconda、python全卸载，重新安装。\n注意install openai以后，默认的pillow版本是9.4，太高了，把pillow卸载，安装8.4。\n这么操作以后，新的问题是openai又没了，就把openai重新装回来。\n很开心的是，pillow居然还是8.4.结果正常了。\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\PIL\\Image.py:103\n     94 MAX_IMAGE_PIXELS = int(1024 * 1024 * 1024 &#47;&#47; 4 &#47;&#47; 3)\n     97 try:\n     98     # If the _imaging C module is not present, Pillow will not load.\n     99     # Note that other modules should not refer to _imaging directly;\n    100     # import Image and use the Image.core variable instead.\n    101     # Also note that Image.core is not a publicly documented interface,\n    102     # and should be considered private and subject to change.\n--&gt; 103     from . import _imaging as core\n    105     if __version__ != getattr(core, &quot;PILLOW_VERSION&quot;, None):\n    106         msg = (\n    107             &quot;The _imaging extension was built for another version of Pillow or PIL:\\n&quot;\n    108             f&quot;Core version: {getattr(core, &#39;PILLOW_VERSION&#39;, None)}\\n&quot;\n    109             f&quot;Pillow version: {__version__}&quot;\n    110         )\n\nImportError: DLL load failed while importing _imaging: The specified module could not be found.","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612247,"discussion_content":"python的环境的确是个问题，我看一下是否晚点能搞个Docker的Image来解决问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680585891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3585208,"avatar":"https://static001.geekbang.org/account/avatar/00/36/b4/b8/791d0f5e.jpg","nickname":"开心","note":"","ucode":"FA430422C96C18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616465,"discussion_content":"你太秀了，我试了一会试不下去了，来找答案来了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682847800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371824,"user_name":"渣渣辉","can_delete":false,"product_type":"c1","uid":1911235,"ip_address":"日本","ucode":"730838D9161579","user_header":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1680398326,"is_pvip":false,"replies":[{"id":135715,"content":"有两个原因\n1. chatgpt的模型在实时更新，我选用的一般都不是快照的模型，而是模型最新版本。\n2. 本身 GPT 输出结果是概率采样，有一定的随机性。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680581506,"ip_address":"上海","comment_id":371824,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"为什么同样是用chatgpt的出来的结果跟老师的事例稍有不同，是因为chatgpt这个模型是在实时更新的吗","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612214,"discussion_content":"有两个原因\n1. chatgpt的模型在实时更新，我选用的一般都不是快照的模型，而是模型最新版本。\n2. 本身 GPT 输出结果是概率采样，有一定的随机性。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680581506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371026,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"广东","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1679470439,"is_pvip":true,"replies":[{"id":135360,"content":"Chat Complete是针对对话微调过的模型。我自己的体验是很多时候给它明确的指令，它也会有点话唠，废话有点多。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540335,"ip_address":"上海","comment_id":371026,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"老师, text complete 和 chat complete 接口有什么区别啊, 我看能力没看出大的差别","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610360,"discussion_content":"Chat Complete是针对对话微调过的模型。我自己的体验是很多时候给它明确的指令，它也会有点话唠，废话有点多。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1679540335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1066752,"avatar":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","nickname":"piboye","note":"","ucode":"7CFD8712857A85","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":610405,"discussion_content":"谢谢老师指点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679548401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610360,"ip_address":"广东","group_id":0},"score":610405,"extra":""}]},{"author":{"id":1742144,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJPXN6tO1ka2YhSEnzFLocuXCY9ibrTP8yczqymEGXKwJsDE276MaVBXHSibYiaOl8Z6XOoRTpAbyUnA/132","nickname":"Geek_97af74","note":"","ucode":"73D8823A964877","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615829,"discussion_content":"chat 废话那是相当多。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682441175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370987,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"山西","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1679435155,"is_pvip":false,"replies":[{"id":135364,"content":"Q1: 是的，一个交互式可以看到输出结果，图片等各种功能的开发环境\nQ2: 可以直接使用在线的Colab，就不需要自己搭建了，可以看一下第一讲。搭建的复杂程度每个人感觉不一样。\nQ3：并不是所有的问题都适合用OpenAI的API来完成。我们需要考虑成本，OpenAI的Embedding接口很便宜，但是Completion接口就会贵一些（即使是gpt-3.5-turbo），也要考虑效果，有标注数据的情况下，利用标注会比只用大模型效果更好\nQ4：制作PPT，我们可以期待一下微软最新的发布会里介绍的 Office Copilot，你只要给它合适的资料，可以自动生成PPT。你可以试一下 beta.tome.app 是一个创业工作做的通过AI创建PPT的产品。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540936,"ip_address":"上海","comment_id":370987,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"请教老师几个问题：\nQ1：01课中的Jupyter Labs 开发环境是python的开发环境吗？（对python不了解，0基础，小白）\nQ2：01课中的Jupyter Labs 开发环境搭建，复杂吗？如果复杂的话，能否麻烦老师写一个手册一类的文档？最好详细一点。（一直觉得搭环境很麻烦；尤其对不熟悉的python，容易出错，容易有挫折感。）。 环境搭不好，后面的例子无法实践。\nQ3：Cookbook例子，为什么用Scikit估计结果，应该都用openai来完成啊。例子中用Scikit，那相当于“openai + Scikit”结合来判断出最后的星标了，openai这么强大，还需要用Scikit吗？\nQ4：chatGPT搜索或生成ppt的能力如何？\n比如我要做一个软件的产品介绍性质的ppt，用来给客户介绍该软件。以matlab为例，我托国外同事这样搜“matlab 产品介绍 ppt”，并没有搜到合适的ppt，后来只好在百度上搜索了。请问，是我们的使用方法不对？还是说chatGPT没有这方面的能力？","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610366,"discussion_content":"Q1: 是的，一个交互式可以看到输出结果，图片等各种功能的开发环境\nQ2: 可以直接使用在线的Colab，就不需要自己搭建了，可以看一下第一讲。搭建的复杂程度每个人感觉不一样。\nQ3：并不是所有的问题都适合用OpenAI的API来完成。我们需要考虑成本，OpenAI的Embedding接口很便宜，但是Completion接口就会贵一些（即使是gpt-3.5-turbo），也要考虑效果，有标注数据的情况下，利用标注会比只用大模型效果更好\nQ4：制作PPT，我们可以期待一下微软最新的发布会里介绍的 Office Copilot，你只要给它合适的资料，可以自动生成PPT。你可以试一下 beta.tome.app 是一个创业工作做的通过AI创建PPT的产品。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679540937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105780,"avatar":"https://static001.geekbang.org/account/avatar/00/10/df/74/134f3a7a.jpg","nickname":"memora","note":"","ucode":"8BCF66C2C8D607","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610228,"discussion_content":"Q1和Q2可以使用搜索引擎搜一下相关的内容；Q3使用Scikit是为了检验大模型的生成效果；Q4可以让chatgpt生成介绍的文字并提供参考(ppt)链接，然后手动合并成PPT, 微软新推的Copilot有直接生成PPT的能力, 基于大模型做的但还未对大众开放","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1679468180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374163,"user_name":"Geek_a54b66","can_delete":false,"product_type":"c1","uid":3619778,"ip_address":"美国","ucode":"C8790CDBBA6CFE","user_header":"","comment_is_top":false,"comment_ctime":1683648039,"is_pvip":false,"replies":[{"id":136836,"content":"耳机评价是作业\n\n食物评价的数据，可以参看notebook所在代码库的README\nhttps:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course\n\n链接: https:&#47;&#47;pan.baidu.com&#47;s&#47;1Cl0eFNLOkQqquf9ls0trEw 提取码: jvr4","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684746542,"ip_address":"上海","comment_id":374163,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"没有提供 亚马逊食物评价的连接罢，最后面提供的是 耳机的评价","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619010,"discussion_content":"耳机评价是作业\n\n食物评价的数据，可以参看notebook所在代码库的README\nhttps://github.com/xuwenhao/geektime-ai-course\n\n链接: https://pan.baidu.com/s/1Cl0eFNLOkQqquf9ls0trEw 提取码: jvr4","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684746542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373131,"user_name":"Enzo","can_delete":false,"product_type":"c1","uid":3579054,"ip_address":"美国","ucode":"15F820957F4FF5","user_header":"https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg","comment_is_top":false,"comment_ctime":1682070908,"is_pvip":false,"replies":[{"id":136488,"content":"raw地址里，界面右上角里有地方可以点击下载","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683086974,"ip_address":"上海","comment_id":373131,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"不知道怎么下载数据集，在github上点下载后却返回的是浏览器里一个raw地址，好奇怪","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616724,"discussion_content":"raw地址里，界面右上角里有地方可以点击下载","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683086974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1742144,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJPXN6tO1ka2YhSEnzFLocuXCY9ibrTP8yczqymEGXKwJsDE276MaVBXHSibYiaOl8Z6XOoRTpAbyUnA/132","nickname":"Geek_97af74","note":"","ucode":"73D8823A964877","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615831,"discussion_content":"raw网址下右键另存为即可下载。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682441834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373036,"user_name":"ShawnWu","can_delete":false,"product_type":"c1","uid":1253140,"ip_address":"北京","ucode":"A3E8397FDD20D6","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/14/57cb7926.jpg","comment_is_top":false,"comment_ctime":1681956651,"is_pvip":true,"replies":[{"id":136501,"content":"放到 data 目录里之后，通过 &quot;.&#47;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot; 应该能够读到呀\n\n或者你用绝对路径\n&quot;&#47;content&#47;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot; 试试看？","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683088413,"ip_address":"上海","comment_id":373036,"utype":1}],"discussion_count":4,"race_medal":1,"score":3,"product_id":100541001,"comment_content":"这个文件：fine_food_reviews_with_embeddings_1k.csv\n我上传到colab云盘的同级目录下，修改path路径也读取不到，单独建了一个data目录放进去也读不到。","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616738,"discussion_content":"放到 data 目录里之后，通过 &#34;./data/fine_food_reviews_with_embeddings_1k.csv&#34; 应该能够读到呀\n\n或者你用绝对路径\n&#34;/content/data/fine_food_reviews_with_embeddings_1k.csv&#34; 试试看？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683088413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543018,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqw0R25Bt0iahFhEHfnxmzr9iaZf0eLsDQtFUJzgGkYwHTqicU9TydMngrJ4yL7D50awD2VibHBAdqplQ/132","nickname":"Geek_18dfaf","note":"","ucode":"CFC27E78220E2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646578,"discussion_content":"你这文件哪里下载到的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718244388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615954,"discussion_content":"# 用下面的方法检查当前的位置\nimport os\ncwd = os.getcwd()  # Get the current working directory (cwd)\nprint(cwd)\n\n输出的结果\n/content\n\n如果将文件放在这个目录下，就是\nfile = &#34;/content/fine_food_reviews_with_embeddings_1k.csv&#34;\n试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682514465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"瑞士","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3579054,"avatar":"https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg","nickname":"Enzo","note":"","ucode":"15F820957F4FF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615236,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682129864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373034,"user_name":"ShawnWu","can_delete":false,"product_type":"c1","uid":1253140,"ip_address":"北京","ucode":"A3E8397FDD20D6","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/14/57cb7926.jpg","comment_is_top":false,"comment_ctime":1681955763,"is_pvip":true,"replies":[{"id":136502,"content":"在colab的默认路径下创建一个 data 目录把文件上传\n然后通过 &quot;.&#47;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot; 读取","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683088464,"ip_address":"上海","comment_id":373034,"utype":1}],"discussion_count":3,"race_medal":1,"score":3,"product_id":100541001,"comment_content":"我用的是在线的colab跑的这一课示例代码，最后那个亚马逊的示例跑不通，不明白那个csv应该放到在线colab的什么位置上才能读到，datafile_path这个应该在colab上如何处理：\ndatafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\ndf = pd.read_csv(datafile_path)","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616739,"discussion_content":"在colab的默认路径下创建一个 data 目录把文件上传\n然后通过 &#34;./data/fine_food_reviews_with_embeddings_1k.csv&#34; 读取","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683088464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1143029,"avatar":"https://static001.geekbang.org/account/avatar/00/11/70/f5/afdf4a68.jpg","nickname":"东临沧海","note":"","ucode":"300AA289093E06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615145,"discussion_content":"from google.colab import drive\ndrive.mount(&#39;/content/gdrive&#39;)\n执行上面代码mount Google drive\n然后在代码中引用：\ndatafile_path=&#34;/content/gdrive/My Drive/Colab Notebooks/fine_food_reviews_with_embeddings_1k.csv&#34;\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1682064986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452167,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","nickname":"Geek_93970d","note":"","ucode":"52AC308BEC7737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617549,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683642778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372854,"user_name":"RecordLiu","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"福建","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/cd8fea9f.jpg","comment_is_top":false,"comment_ctime":1681725716,"is_pvip":false,"replies":[{"id":136256,"content":"合规就好了，OpenAI协议写明了不会使用API提交的数据用于模型训练。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1681794265,"ip_address":"上海","comment_id":372854,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"这个调openapi提供的api进行训练数据，应该要考虑数据安全问题吧?比如用公司真实的业务数据进行训练，可能会发生数据泄露问题","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614458,"discussion_content":"合规就好了，OpenAI协议写明了不会使用API提交的数据用于模型训练。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681794265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371764,"user_name":"Geek_9c83fd","can_delete":false,"product_type":"c1","uid":3577055,"ip_address":"中国香港","ucode":"1D494AEC593D8A","user_header":"","comment_is_top":false,"comment_ctime":1680290095,"is_pvip":false,"replies":[{"id":135717,"content":"的确没有用到，那个是在最下面批量处理数据的时候用到的。\ntext-similarity-davinci-001 模型更大，维度更高，效果更好（12288维）\n\ntext-embedding-ada-002 成本比较低，在整体的数据集上运行，效果已经足够了。\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680581614,"ip_address":"上海","comment_id":371764,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"```\n\nimport openai\nimport os\nfrom openai.embeddings_utils import cosine_similarity, get_embedding\n\n# 获取访问open ai的密钥\nopenai.api_key = os.getenv(&quot;OPENAI_API_KEY&quot;)\n# 选择使用最小的ada模型\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n\n# 获取&quot;好评&quot;和&quot;差评&quot;的\npositive_review = get_embedding(&quot;好评&quot;)\nnegative_review = get_embedding(&quot;差评&quot;)\n\npositive_example = get_embedding(&quot;买的银色版真的很好看，一天就到了，晚上就开始拿起来完系统很丝滑流畅，做工扎实，手感细腻，很精致哦苹果一如既往的好品质&quot;)\nnegative_example = get_embedding(&quot;降价厉害，保价不合理，不推荐&quot;)\n\ndef get_score(sample_embedding):\n  return cosine_similarity(sample_embedding, positive_review) - cosine_similarity(sample_embedding, negative_review)\n\npositive_score = get_score(positive_example)\nnegative_score = get_score(negative_example)\n\nprint(&quot;好评例子的评分 : %f&quot; % (positive_score))\nprint(&quot;差评例子的评分 : %f&quot; % (negative_score))\n```\n该段代码中，并没有用到 `text-embedding-ada-002`,我看了库，用的是`text-similarity-davinci-001`,而且我发现我如果用`text-embedding-ada-002`,那么评分都大于1，这是为何？","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612216,"discussion_content":"的确没有用到，那个是在最下面批量处理数据的时候用到的。\ntext-similarity-davinci-001 模型更大，维度更高，效果更好（12288维）\n\ntext-embedding-ada-002 成本比较低，在整体的数据集上运行，效果已经足够了。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680581614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371054,"user_name":"Oli张帆","can_delete":false,"product_type":"c1","uid":1338098,"ip_address":"北京","ucode":"6E60A370C3C14A","user_header":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","comment_is_top":false,"comment_ctime":1679489121,"is_pvip":false,"replies":[{"id":135355,"content":"是的，gpt-3.5-turbo会低很多。不过在一些问题的效果上，其实不如原始的 code-davinci-002 或者 text-davinci-003。\n专栏的第二部分主要就是讲如何搭建自有的知识库的方法。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679539975,"ip_address":"上海","comment_id":371054,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"请教老师，似乎chat completion的成本要低很多，后面会讲到如何利用OpenAI的接口来搭建能使用自有知识库的方法吗？","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610351,"discussion_content":"是的，gpt-3.5-turbo会低很多。不过在一些问题的效果上，其实不如原始的 code-davinci-002 或者 text-davinci-003。\n专栏的第二部分主要就是讲如何搭建自有的知识库的方法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679539975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1338098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","nickname":"Oli张帆","note":"","ucode":"6E60A370C3C14A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":610359,"discussion_content":"感谢🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679540295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610351,"ip_address":"新加坡","group_id":0},"score":610359,"extra":""}]}]},{"had_liked":false,"id":371006,"user_name":"码乐主义","can_delete":false,"product_type":"c1","uid":1016695,"ip_address":"上海","ucode":"91EC070FD04A22","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/77/e51624a1.jpg","comment_is_top":false,"comment_ctime":1679457109,"is_pvip":false,"replies":[{"id":135363,"content":"如果只是光光看Embedding的话，其实有很多开源模型可以选择。\n在第4讲，第12讲，我们都会来尝试一些开源模型。\n\n你可以试试看 flan-t5 这个开源模型来做embedding，其实效果还是不错的。\n只是复杂一点的推理，和文本生成，开源的模型和OpenAI的差距还是很大。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540633,"ip_address":"上海","comment_id":371006,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"之前担心embedding是否中文支持的不好。看起来支持的还可以，回答了我的一个疑问。不知道embedding工具国内是否有类似的？我目前没走到。腾讯好像做过，但是现在没有开放。","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610365,"discussion_content":"如果只是光光看Embedding的话，其实有很多开源模型可以选择。\n在第4讲，第12讲，我们都会来尝试一些开源模型。\n\n你可以试试看 flan-t5 这个开源模型来做embedding，其实效果还是不错的。\n只是复杂一点的推理，和文本生成，开源的模型和OpenAI的差距还是很大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679540634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370993,"user_name":"Viktor","can_delete":false,"product_type":"c1","uid":1520703,"ip_address":"四川","ucode":"DCAFD1DD5C6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/3f/4b6cd370.jpg","comment_is_top":false,"comment_ctime":1679448049,"is_pvip":false,"replies":[{"id":135373,"content":"我们就是拿了Amazon的Food review的一千条数据呀，原始数据在 https:&#47;&#47;www.kaggle.com&#47;snap&#47;amazon-fine-food-reviews 可以找到\n\n对应的一千条数据，可以在 https:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course&#47;tree&#47;main&#47;data，你可以下载下来直接看。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679542591,"ip_address":"美国","comment_id":370993,"utype":1}],"discussion_count":5,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"老师，请问一下“更大的数据集上的真实案例”这个案例的数据集在哪里？读文章不知道数据集长什么样子，看代码有点没有理解到。","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610382,"discussion_content":"我们就是拿了Amazon的Food review的一千条数据呀，原始数据在 https://www.kaggle.com/snap/amazon-fine-food-reviews 可以找到\n\n对应的一千条数据，可以在 https://github.com/xuwenhao/geektime-ai-course/tree/main/data，你可以下载下来直接看。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1679542591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"美国","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1302179,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/a3/6bcf1273.jpg","nickname":"睡前不玩手机","note":"","ucode":"0118550455F214","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610235,"discussion_content":"在这下载 CSV:\nhttps://github.com/openai/openai-cookbook/blob/main/examples/data/fine_food_reviews_with_embeddings_1k.csv","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679472713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2356397,"avatar":"https://static001.geekbang.org/account/avatar/00/23/f4/ad/612e926c.jpg","nickname":"Pink泡芙_xue","note":"","ucode":"F34576FA0CC0CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1302179,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/a3/6bcf1273.jpg","nickname":"睡前不玩手机","note":"","ucode":"0118550455F214","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613481,"discussion_content":"是点download吗，我点完是出来了一网页的原数据，怎么下载数据到csv啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681351474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610235,"ip_address":"北京","group_id":0},"score":613481,"extra":""}]},{"author":{"id":1133945,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/79/803537db.jpg","nickname":"慢动作","note":"","ucode":"62C944F4A4D8AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610229,"discussion_content":"https://github.com/openai/openai-cookbook","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679470116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452167,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","nickname":"Geek_93970d","note":"","ucode":"52AC308BEC7737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617551,"discussion_content":"开源的库里，比如 pyToch 里，embedding 是存到哪的啊？想知道长啥样？这些数据和库放到一起会不会非常大，不方便下载之类的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683643215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374905,"user_name":"Geek_378f83","can_delete":false,"product_type":"c1","uid":3196784,"ip_address":"美国","ucode":"AD2B400EED436A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/z3nIITkhzRj9WApibhic524lQSJmqUCerpuqpntEe06LE3lRGKr6rGwPpPJtZ5Xj0NBPyvTatKtIk0hfyAnl9Hsg/132","comment_is_top":false,"comment_ctime":1684635699,"is_pvip":false,"replies":[{"id":136790,"content":"看一下对应的csv文件里有没有 embedding 这个属性？\n\ndf[&quot;embedding&quot;] = df[&quot;embedding&quot;].apply(eval).apply(np.array) 试试？\n\n看起来是pandas版本的差异","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684720602,"ip_address":"新加坡","comment_id":374905,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"colab上执行报错，又遇到的吗？怎么解决的？\n\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n&lt;ipython-input-33-6c8271aa31f7&gt; in &lt;cell line: 10&gt;()\n      8 \n      9 df = pd.read_csv(datafile_path)\n---&gt; 10 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n     11 \n     12 # convert 5-star rating to binary sentiment\n\n&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;pandas&#47;core&#47;generic.py in __getattr__(self, name)\n   5900         ):\n   5901             return self[name]\n-&gt; 5902         return object.__getattribute__(self, name)\n   5903 \n   5904     def __setattr__(self, name: str, value) -&gt; None:\n\nAttributeError: &#39;DataFrame&#39; object has no attribute &#39;embedding&#39;","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618922,"discussion_content":"看一下对应的csv文件里有没有 embedding 这个属性？\n\ndf[&#34;embedding&#34;] = df[&#34;embedding&#34;].apply(eval).apply(np.array) 试试？\n\n看起来是pandas版本的差异","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684720603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"新加坡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374904,"user_name":"Geek_378f83","can_delete":false,"product_type":"c1","uid":3196784,"ip_address":"美国","ucode":"AD2B400EED436A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/z3nIITkhzRj9WApibhic524lQSJmqUCerpuqpntEe06LE3lRGKr6rGwPpPJtZ5Xj0NBPyvTatKtIk0hfyAnl9Hsg/132","comment_is_top":false,"comment_ctime":1684635600,"is_pvip":false,"replies":[{"id":136789,"content":"看一下对应的csv文件里有没有 embedding 这个属性？\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684720545,"ip_address":"新加坡","comment_id":374904,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"df = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n&lt;ipython-input-33-6c8271aa31f7&gt; in &lt;cell line: 10&gt;()\n      8 \n      9 df = pd.read_csv(datafile_path)\n---&gt; 10 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n     11 \n     12 # convert 5-star rating to binary sentiment\n\n&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;pandas&#47;core&#47;generic.py in __getattr__(self, name)\n   5900         ):\n   5901             return self[name]\n-&gt; 5902         return object.__getattribute__(self, name)\n   5903 \n   5904     def __setattr__(self, name: str, value) -&gt; None:\n\nAttributeError: &#39;DataFrame&#39; object has no attribute &#39;embedding&#39;","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618921,"discussion_content":"看一下对应的csv文件里有没有 embedding 这个属性？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684720545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"新加坡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374657,"user_name":"庚小庚","can_delete":false,"product_type":"c1","uid":2058308,"ip_address":"浙江","ucode":"DE88271BA527DD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/68/44/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1684287616,"is_pvip":false,"replies":[{"id":136796,"content":"确认 openai.api_key = &quot;这里填你的Key&quot; 然后运行执行一下也不行么？\n看看是否是没有执行，或者哪里运行了别的覆盖了设置。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1684722959,"ip_address":"新加坡","comment_id":374657,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":" No API key provided. You can set your API key in code using &#39;openai.api_key = &lt;API-KEY&gt;&#39;, or you can set the environment variable OPENAI_API_KEY=&lt;API-KEY&gt;). If your API key is stored in a file, you can point the openai module at it with &#39;openai.api_key_path = &lt;PATH&gt;&#39;. You can generate API keys in the OpenAI web interface. See https:&#47;&#47;platform.openai.com&#47;account&#47;api-keys for details\n\n生成了新的密钥，放进去，还是报这个错","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618932,"discussion_content":"确认 openai.api_key = &#34;这里填你的Key&#34; 然后运行执行一下也不行么？\n看看是否是没有执行，或者哪里运行了别的覆盖了设置。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684722959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"新加坡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373691,"user_name":"stg609","can_delete":false,"product_type":"c1","uid":1073025,"ip_address":"浙江","ucode":"FB70A75A891BB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg","comment_is_top":false,"comment_ctime":1683018078,"is_pvip":false,"replies":[{"id":136445,"content":"不是，因为整个向量空间并不是按照好评和差评来平分的。好评和差评也只是整个向量空间中的两个点。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683082515,"ip_address":"上海","comment_id":373691,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"如果不是好评，就是差评的前提成立的话，那么是否只需要计算与 “好评” 这个向量的相似度就好了？如果大于 0 就认为是好评，反之则是差评。","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616667,"discussion_content":"不是，因为整个向量空间并不是按照好评和差评来平分的。好评和差评也只是整个向量空间中的两个点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683082515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373157,"user_name":"喻顺武 旅梦开发团","can_delete":false,"product_type":"c1","uid":1080635,"ip_address":"江西","ucode":"9E401F0D96930C","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/3b/b7f9281e.jpg","comment_is_top":false,"comment_ctime":1682153623,"is_pvip":false,"replies":[{"id":136508,"content":"pip install matplotlib","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683091386,"ip_address":"上海","comment_id":373157,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"ModuleNotFoundError: No module named &#39;matplotlib&#39;   怎么搞","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616748,"discussion_content":"pip install matplotlib","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683091386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373144,"user_name":"Enzo","can_delete":false,"product_type":"c1","uid":3579054,"ip_address":"北京","ucode":"15F820957F4FF5","user_header":"https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg","comment_is_top":false,"comment_ctime":1682132118,"is_pvip":false,"replies":[{"id":136490,"content":"不应该是 read_excel 而是应该 read_csv 啊，你的文件名看起来是 csv 格式的文件啊","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683087038,"ip_address":"上海","comment_id":373144,"utype":1}],"discussion_count":3,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"一直报错，无奈了：import pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\ndatafile_path = &quot;&#47;content&#47;reviews_30.csv&quot;\n\ndf = pd.read_excel(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n\n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})ValueError                                Traceback (most recent call last)\n&lt;ipython-input-4-46968d0107d4&gt; in &lt;cell line: 8&gt;()\n      6 datafile_path = &quot;&#47;content&#47;reviews_30.csv&quot;\n      7 \n----&gt; 8 df = pd.read_excel(datafile_path)\n      9 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n     10 \n\n3 frames\n&#47;usr&#47;local&#47;lib&#47;python3.9&#47;dist-packages&#47;pandas&#47;io&#47;excel&#47;_base.py in __init__(self, path_or_buffer, engine, storage_options)\n   1654                 )\n   1655                 if ext is None:\n-&gt; 1656                     raise ValueError(\n   1657                         &quot;Excel file format cannot be determined, you must specify &quot;\n   1658                         &quot;an engine manually.&quot;\n\nValueError: Excel file format cannot be determined, you must specify an engine manually.","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616726,"discussion_content":"不应该是 read_excel 而是应该 read_csv 啊，你的文件名看起来是 csv 格式的文件啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683087039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452167,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","nickname":"Geek_93970d","note":"","ucode":"52AC308BEC7737","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617548,"discussion_content":"mac 上按照老师的方法搭环境没出过错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683642734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615949,"discussion_content":"试试将\ndf = pd.read_excel(datafile_path)\n换成\ndf = pd.read_csv(datafile_path)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682513241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"瑞士","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373032,"user_name":"多多","can_delete":false,"product_type":"c1","uid":1255931,"ip_address":"浙江","ucode":"F0FC2F1DF1FC3E","user_header":"https://static001.geekbang.org/account/avatar/00/13/29/fb/7d9d37ae.jpg","comment_is_top":false,"comment_ctime":1681954244,"is_pvip":false,"replies":[{"id":136517,"content":"抱歉，没有看懂你的问题是啥。这一讲和 “杭州在哪里？” 这个问题有什么关系么？","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683091913,"ip_address":"上海","comment_id":373032,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"杭州在哪里？这个问题的回答，是怎么个运行过程，老师方便解释下不？","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616758,"discussion_content":"抱歉，没有看懂你的问题是啥。这一讲和 “杭州在哪里？” 这个问题有什么关系么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683091913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373015,"user_name":"Pochacco","can_delete":false,"product_type":"c1","uid":1601423,"ip_address":"广东","ucode":"DAD18D7C42C263","user_header":"https://static001.geekbang.org/account/avatar/00/18/6f/8f/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1681918089,"is_pvip":false,"replies":[{"id":136500,"content":"https:&#47;&#47;github.com&#47;openai&#47;openai-cookbook&#47;blob&#47;main&#47;examples&#47;Classification_using_embeddings.ipynb\n\n以及\n\nhttps:&#47;&#47;github.com&#47;openai&#47;openai-cookbook&#47;blob&#47;main&#47;examples&#47;Zero-shot_classification_with_embeddings.ipynb","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683088353,"ip_address":"上海","comment_id":373015,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"来自 OpenAI Cookbook 里面的一个例子。它是用同样的方法，来判断亚马逊提供的用户对一些食物的评价 -- 这里的代码是不是不完全啊？ 我在OpenAI Cookbook找不到这个例子，是否可以把OpenAI Cookbook这个例子的链接发给我，谢谢！","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616737,"discussion_content":"https://github.com/openai/openai-cookbook/blob/main/examples/Classification_using_embeddings.ipynb\n\n以及\n\nhttps://github.com/openai/openai-cookbook/blob/main/examples/Zero-shot_classification_with_embeddings.ipynb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683088353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372968,"user_name":"超超超超人","can_delete":false,"product_type":"c1","uid":1166883,"ip_address":"上海","ucode":"7696CACF0DF35F","user_header":"","comment_is_top":false,"comment_ctime":1681877490,"is_pvip":false,"replies":[{"id":136522,"content":"准确描述应该是 贝叶斯公式\n我坏习惯都用 全概率公式 描述 条件概率公式 + 贝叶斯公式 + 全概率公式","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1683093868,"ip_address":"上海","comment_id":372968,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"全概率公式不应该是加法么，为什么文中的计算是乘法，可以解释下吗","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616763,"discussion_content":"准确描述应该是 贝叶斯公式\n我坏习惯都用 全概率公式 描述 条件概率公式 + 贝叶斯公式 + 全概率公式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683093868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372800,"user_name":"Z12","can_delete":false,"product_type":"c1","uid":1118159,"ip_address":"广东","ucode":"59F5E62F67FFDC","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/cf/bfa0dc80.jpg","comment_is_top":false,"comment_ctime":1681638144,"is_pvip":false,"replies":[{"id":136253,"content":"你需要把本地文件上传上去，或者Mount一个Google Drive上去","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1681794102,"ip_address":"上海","comment_id":372800,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"徐老师，我想问一个问题，你在上面的代码中datafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;，引用这个数据文件，我现在使用的是colab的线上环境，在这个线上环境中，我怎么能够让colab使用到这个本地的数据文件呢? ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614455,"discussion_content":"你需要把本地文件上传上去，或者Mount一个Google Drive上去","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681794102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372743,"user_name":"任飞","can_delete":false,"product_type":"c1","uid":1890638,"ip_address":"陕西","ucode":"719063D3A8F25B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoHXbWPZuBKJHnXNJafz3BGrLRBQI8hSDnkXnFUhYKmn8QaJS6xdjRR5WCicyQHEfprbydpV4jIBVg/132","comment_is_top":false,"comment_ctime":1681540100,"is_pvip":false,"replies":[{"id":136126,"content":"python3.9 也是能跑openai的，所以问题不是这个，你需要看一下更具体的错误信息是什么，你这里贴的信息感觉不全啊。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1681615957,"ip_address":"上海","comment_id":372743,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"from openai.embeddings_utils import cosine_similarity, get_embedding\n这个代码报错：Please note and check the following:\n\n  * The Python version is: Python3.9 from &quot;C:\\Users\\YMB\\anaconda3\\python.exe&quot;\n  * The NumPy version is: &quot;1.20.3&quot;\n\n而我们装的环境是py310,这个怎么解决","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613978,"discussion_content":"python3.9 也是能跑openai的，所以问题不是这个，你需要看一下更具体的错误信息是什么，你这里贴的信息感觉不全啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681615957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372701,"user_name":"Qingshuo","can_delete":false,"product_type":"c1","uid":1200365,"ip_address":"新加坡","ucode":"683C1C2F15E4EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/50/ed/f3867992.jpg","comment_is_top":false,"comment_ctime":1681451256,"is_pvip":false,"replies":[{"id":136103,"content":"后面几讲里会有基于embedding再使用一个线性的机器学习算法的示例，效果会比这个更好一些。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1681613918,"ip_address":"上海","comment_id":372701,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"请问老师，对于文章中的例子，如果想继续优化recall和precision，该怎么优化呢？我能想到的方法只能尝试不同的label string了，先寻找bad case，然后把bad case里的情感倾向性的词加到label string里。除了这样还有什么更好的方法吗？","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613945,"discussion_content":"后面几讲里会有基于embedding再使用一个线性的机器学习算法的示例，效果会比这个更好一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681613919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372243,"user_name":"ㄟ忘川.","can_delete":false,"product_type":"c1","uid":1450394,"ip_address":"浙江","ucode":"16A7EB297D70A6","user_header":"https://static001.geekbang.org/account/avatar/00/16/21/9a/58f6aa3b.jpg","comment_is_top":false,"comment_ctime":1680874347,"is_pvip":false,"replies":[{"id":135897,"content":"这样做当然也可以呀，可以继续往后看，这是后面的一道练习题。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680974914,"ip_address":"日本","comment_id":372243,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"请问为什么不直接询问模型这句评论是好评还是差评呀？而是将评论embedding后和“好评、差评”计算余弦距离呢。","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612893,"discussion_content":"这样做当然也可以呀，可以继续往后看，这是后面的一道练习题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680974914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"日本","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371766,"user_name":"金","can_delete":false,"product_type":"c1","uid":1559128,"ip_address":"新加坡","ucode":"48D0B5CB8E5F9E","user_header":"https://static001.geekbang.org/account/avatar/00/17/ca/58/6fe1854c.jpg","comment_is_top":false,"comment_ctime":1680306682,"is_pvip":false,"replies":[{"id":135718,"content":"https:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course&#47;tree&#47;main&#47;data","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680581634,"ip_address":"上海","comment_id":371766,"utype":1}],"discussion_count":3,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"fine_food_reviews_with_embeddings_1k.csv在哪下载？","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612217,"discussion_content":"https://github.com/xuwenhao/geektime-ai-course/tree/main/data","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680581634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1559128,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ca/58/6fe1854c.jpg","nickname":"金","note":"","ucode":"48D0B5CB8E5F9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611896,"discussion_content":"我在这个课程的github上找到了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680404594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1911235,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","nickname":"渣渣辉","note":"","ucode":"730838D9161579","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611887,"discussion_content":"文章的最下方有下载链接，或者直接搜索数据集名字","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680400114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"日本","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371728,"user_name":"yanyu-xin","can_delete":false,"product_type":"c1","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1680235231,"is_pvip":false,"replies":[{"id":135737,"content":"可以完整运行的代码，可以去 https:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course\n\n我应该在导读里面也放了链接了。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680583393,"ip_address":"上海","comment_id":371728,"utype":1}],"discussion_count":3,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"运行成功。运行方法如下：\n一、在from语句后，增加一行：\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n二、将fine_food_reviews_with_embeddings_1k.csv 的数据删除部分，只留下100个数据量\n三、先运行一次01课的程序，调入openai\n四、运行本课程序","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612237,"discussion_content":"可以完整运行的代码，可以去 https://github.com/xuwenhao/geektime-ai-course\n\n我应该在导读里面也放了链接了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680583394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3579054,"avatar":"https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg","nickname":"Enzo","note":"","ucode":"15F820957F4FF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615238,"discussion_content":"求问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682130071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3579054,"avatar":"https://static001.geekbang.org/account/avatar/00/36/9c/ae/40e5b76d.jpg","nickname":"Enzo","note":"","ucode":"15F820957F4FF5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615237,"discussion_content":"数据集应该上传到哪里，路径是什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682130067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371634,"user_name":"yanyu-xin","can_delete":false,"product_type":"c1","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1680138866,"is_pvip":false,"replies":[{"id":135762,"content":"往上看，应该是你前面的代码没有执行，你在这段代码之前加上\n\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680587160,"ip_address":"上海","comment_id":371634,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"出现这个错误，如何处理：\n\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In[6], line 5\n      1 from sklearn.metrics import PrecisionRecallDisplay\n      3 def evaluate_embeddings_approach(\n      4     labels = [&#39;negative&#39;, &#39;positive&#39;], \n----&gt; 5     model = EMBEDDING_MODEL,\n      6 ):\n      7     label_embeddings = [get_embedding(label, engine=model) for label in labels]\n      9     def label_score(review_embedding, label_embeddings):\n\nNameError: name &#39;EMBEDDING_MODEL&#39; is not defined","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612268,"discussion_content":"往上看，应该是你前面的代码没有执行，你在这段代码之前加上\n\nEMBEDDING_MODEL = &#34;text-embedding-ada-002&#34;\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680587160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144765,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/bd/e7ff842c.jpg","nickname":"赤色闪电","note":"","ucode":"B5FAA29E62132C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611748,"discussion_content":"这个错误产生的原因是 `EMBEDDING_MODEL` 没有被定义。需要在代码之前将 `EMBEDDING_MODEL`定义，从而可以被 `evaluate_embeddings_approach`函数调用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680276367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371578,"user_name":"Colin🔥🌲","can_delete":false,"product_type":"c1","uid":3579146,"ip_address":"中国香港","ucode":"5DC517BE0B547D","user_header":"https://static001.geekbang.org/account/avatar/00/36/9d/0a/943961fb.jpg","comment_is_top":false,"comment_ctime":1680076932,"is_pvip":false,"replies":[{"id":135763,"content":"去 https:&#47;&#47;github.com&#47;xuwenhao&#47;geektime-ai-course\n\n下载 data&#47;fine_food_reviews_with_embeddings_1k.csv 放到正确的路径下","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680587200,"ip_address":"上海","comment_id":371578,"utype":1}],"discussion_count":9,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"在colab运行\n\n\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\ndatafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\n\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n\n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n\nFileNotFoundError: [Errno 2] No such file or directory: &#39;data&#47;fine_food_reviews_with_embeddings_1k.csv&#39;","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612269,"discussion_content":"去 https://github.com/xuwenhao/geektime-ai-course\n\n下载 data/fine_food_reviews_with_embeddings_1k.csv 放到正确的路径下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680587200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":3,"child_discussions":[{"author":{"id":2356397,"avatar":"https://static001.geekbang.org/account/avatar/00/23/f4/ad/612e926c.jpg","nickname":"Pink泡芙_xue","note":"","ucode":"F34576FA0CC0CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613482,"discussion_content":"老师，用Colab环境的话，这个路径有要求吗，还是和读取os的路径一样就可以啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681351595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":612269,"ip_address":"北京","group_id":0},"score":613482,"extra":""},{"author":{"id":2356397,"avatar":"https://static001.geekbang.org/account/avatar/00/23/f4/ad/612e926c.jpg","nickname":"Pink泡芙_xue","note":"","ucode":"F34576FA0CC0CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613639,"discussion_content":"我放到了桌面，路径也改到了桌面，还是说找不到呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681437735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":612269,"ip_address":"北京","group_id":0},"score":613639,"extra":""},{"author":{"id":1253140,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1f/14/57cb7926.jpg","nickname":"ShawnWu","note":"","ucode":"A3E8397FDD20D6","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":2356397,"avatar":"https://static001.geekbang.org/account/avatar/00/23/f4/ad/612e926c.jpg","nickname":"Pink泡芙_xue","note":"","ucode":"F34576FA0CC0CE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614889,"discussion_content":"你解决了吗，我上传到colab同级目录下，修改path也读取不到，单独建了一个data目录放进去也读不到。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681956598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613482,"ip_address":"北京","group_id":0},"score":614889,"extra":""}]},{"author":{"id":2447160,"avatar":"https://static001.geekbang.org/account/avatar/00/25/57/38/db157edd.jpg","nickname":"王小玥","note":"","ucode":"9EC241B125175D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614898,"discussion_content":"刚接触colab，还没研究文件path怎么读，给一个简单粗暴的方法：\n不用下载csv文件，直接在code里改datafile_path\n\ndatafile_path = &#34;https://raw.githubusercontent.com/xuwenhao/geektime-ai-course/main/data/fine_food_reviews_with_embeddings_1k.csv&#34;","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1681960175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2238528,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","nickname":"小理想。","note":"","ucode":"EDC35A907570DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2447160,"avatar":"https://static001.geekbang.org/account/avatar/00/25/57/38/db157edd.jpg","nickname":"王小玥","note":"","ucode":"9EC241B125175D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622097,"discussion_content":"哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687920741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":614898,"ip_address":"北京","group_id":0},"score":622097,"extra":""},{"author":{"id":2238528,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","nickname":"小理想。","note":"","ucode":"EDC35A907570DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2447160,"avatar":"https://static001.geekbang.org/account/avatar/00/25/57/38/db157edd.jpg","nickname":"王小玥","note":"","ucode":"9EC241B125175D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622098,"discussion_content":"也可以自己本地启动个nginx进行代理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687920769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":614898,"ip_address":"北京","group_id":0},"score":622098,"extra":""}]},{"author":{"id":1144765,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/bd/e7ff842c.jpg","nickname":"赤色闪电","note":"","ucode":"B5FAA29E62132C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611756,"discussion_content":"这个错误提示显示找不到文件 &#34;data/fine_food_reviews_with_embeddings_1k.csv&#34;。可能是这个文件在Colab环境中不存在，或者路径错误。csv文件的下载地址应该是在这里：https://github.com/openai/openai-cookbook/blob/main/examples/data/fine_food_reviews_with_embeddings_1k.csv","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680277348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3014658,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ6a62xdMTZ3jibIoWGRj3trQIB3LAXNA6CNHRWszMdJpkGfXdANm7TLD4d8StZRw90OQ43sIEMx1A/132","nickname":"Rocky_zd","note":"","ucode":"2C0629236B1884","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611743,"discussion_content":"我也遇到这个问题，不知道这个csv文件里的距离内容是什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680274064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371564,"user_name":"游来游去的W","can_delete":false,"product_type":"c1","uid":1471174,"ip_address":"北京","ucode":"E3BDDE22F091FE","user_header":"https://static001.geekbang.org/account/avatar/00/16/72/c6/c010006d.jpg","comment_is_top":false,"comment_ctime":1680070567,"is_pvip":false,"replies":[{"id":135725,"content":"pip install scikit-learn\n或者\nconda install -c conda-forge scikit-learn\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680582131,"ip_address":"上海","comment_id":371564,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100541001,"comment_content":"下面的问题如何解决，始终找不到合适的安装包\nModuleNotFoundError                       Traceback (most recent call last)\nCell In[10], line 2\n      1 import openai\n----&gt; 2 from openai.embeddings_utils import cosine_similarity, get_embedding\n      4 # 获取访问open ai的密钥\n      5 openai.api_key = &#39;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&#39;\n\nFile &#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.11&#47;lib&#47;python3.11&#47;site-packages&#47;openai&#47;embeddings_utils.py:7\n      5 import plotly.express as px\n      6 from scipy import spatial\n----&gt; 7 from sklearn.decomposition import PCA\n      8 from sklearn.manifold import TSNE\n      9 from sklearn.metrics import average_precision_score, precision_recall_curve\n\nModuleNotFoundError: No module named &#39;sklearn&#39;","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612224,"discussion_content":"pip install scikit-learn\n或者\nconda install -c conda-forge scikit-learn\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680582131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3579410,"avatar":"https://static001.geekbang.org/account/avatar/00/36/9e/12/969cce3b.jpg","nickname":"没事溜达","note":"","ucode":"367F2C51B40EF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611430,"discussion_content":"pip install scikit-learn","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680085013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"中国香港","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371522,"user_name":"Toni","can_delete":false,"product_type":"c1","uid":3206957,"ip_address":"瑞士","ucode":"E6B2FACCC1E000","user_header":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","comment_is_top":false,"comment_ctime":1680011629,"is_pvip":false,"replies":[{"id":135747,"content":"👍","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680586154,"ip_address":"上海","comment_id":371522,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"File ~\\miniconda3\\envs\\py310\\lib\\site-packages\\PIL\\Image.py:103\n     94 MAX_IMAGE_PIXELS = int(1024 * 1024 * 1024 &#47;&#47; 4 &#47;&#47; 3)\n     97 try:\n     98     # If the _imaging C module is not present, Pillow will not load.\n     99     # Note that other modules should not refer to _imaging directly;\n    100     # import Image and use the Image.core variable instead.\n    101     # Also note that Image.core is not a publicly documented interface,\n    102     # and should be considered private and subject to change.\n--&gt; 103     from . import _imaging as core\n    105     if __version__ != getattr(core, &quot;PILLOW_VERSION&quot;, None):\n    106         msg = (\n    107             &quot;The _imaging extension was built for another version of Pillow or PIL:\\n&quot;\n    108             f&quot;Core version: {getattr(core, &#39;PILLOW_VERSION&#39;, None)}\\n&quot;\n    109             f&quot;Pillow version: {__version__}&quot;\n    110         )\n\nImportError: DLL load failed while importing _imaging: The specified module could not be found.\n\n解决方案: 先卸载PILLOW，再重装\n参考讨论: https:&#47;&#47;github.com&#47;amueller&#47;word_cloud&#47;issues&#47;225","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612253,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680586154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371521,"user_name":"Toni","can_delete":false,"product_type":"c1","uid":3206957,"ip_address":"瑞士","ucode":"E6B2FACCC1E000","user_header":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","comment_is_top":false,"comment_ctime":1680011589,"is_pvip":false,"replies":[{"id":135764,"content":"重新安装一下 Pillow的库试试\n\n遇到问题可以尝试把报错扔到 ChatGPT 里面试试","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680587245,"ip_address":"上海","comment_id":371521,"utype":1}],"discussion_count":3,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"在运行下段代码时报错\nfrom openai.embeddings_utils import cosine_similarity, get_embedding\n\nImportError                               Traceback (most recent call last)\nCell In[2], line 1\n----&gt; 1 from openai.embeddings_utils import cosine_similarity, get_embedding\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\openai\\embeddings_utils.py:4\n      1 import textwrap as tr\n      2 from typing import List, Optional\n----&gt; 4 import matplotlib.pyplot as plt\n      5 import plotly.express as px\n      6 from scipy import spatial\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\matplotlib\\__init__.py:131\n    127 from packaging.version import parse as parse_version\n    129 # cbook must import matplotlib only within function\n    130 # definitions, so it is safe to import from it here.\n--&gt; 131 from . import _api, _version, cbook, _docstring, rcsetup\n    132 from matplotlib.cbook import sanitize_sequence\n    133 from matplotlib._api import MatplotlibDeprecationWarning\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\matplotlib\\rcsetup.py:27\n     25 from matplotlib import _api, cbook\n     26 from matplotlib.cbook import ls_mapper\n---&gt; 27 from matplotlib.colors import Colormap, is_color_like\n     28 from matplotlib._fontconfig_pattern import parse_fontconfig_pattern\n     29 from matplotlib._enums import JoinStyle, CapStyle\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\matplotlib\\colors.py:51\n     49 from numbers import Number\n     50 import re\n---&gt; 51 from PIL import Image\n     52 from PIL.PngImagePlugin import PngInfo\n     54 import matplotlib as mpl\n","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612270,"discussion_content":"重新安装一下 Pillow的库试试\n\n遇到问题可以尝试把报错扔到 ChatGPT 里面试试","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680587245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144765,"avatar":"https://static001.geekbang.org/account/avatar/00/11/77/bd/e7ff842c.jpg","nickname":"赤色闪电","note":"","ucode":"B5FAA29E62132C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611757,"discussion_content":"pip install  openai matplotlib pillow","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680277925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611967,"discussion_content":"@赤色闪电: 是的，需要重新装 pillow","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680442513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"瑞士","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371479,"user_name":"莹","can_delete":false,"product_type":"c1","uid":1020356,"ip_address":"美国","ucode":"395C6C4191B091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","comment_is_top":false,"comment_ctime":1679981862,"is_pvip":false,"replies":[{"id":135779,"content":"每次问答还是要调用API的。Embedding只是提前把数据处理成向量存起来，就是对应的内容下次查找的时候不用再调用OpenAI的API了。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1680588969,"ip_address":"上海","comment_id":371479,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"请问老师，将数据集embed到内存就不需要重复调用API了吗？如果需要多次使用数据集中的不同数据，比如Open AI的Q&amp;A那个示例，应该每次还需要调用API吧。我是看到ChatPDF这种能够将数据上传并且在线问答的app想到这个问题的","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612290,"discussion_content":"每次问答还是要调用API的。Embedding只是提前把数据处理成向量存起来，就是对应的内容下次查找的时候不用再调用OpenAI的API了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680588969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371348,"user_name":"刘蕾","can_delete":false,"product_type":"c1","uid":1899996,"ip_address":"斯洛伐克","ucode":"984D2C7E286DA1","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fd/dc/8c394a51.jpg","comment_is_top":false,"comment_ctime":1679825100,"is_pvip":false,"replies":[{"id":135536,"content":"今天上线的第5讲里，有对应这个指标表格的讲解","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679969373,"ip_address":"上海","comment_id":371348,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"最后的评测效果的部分没看懂，老师会不会讲precision, recall, f1score?","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611159,"discussion_content":"今天上线的第5讲里，有对应这个指标表格的讲解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679969373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371148,"user_name":"Viktor","can_delete":false,"product_type":"c1","uid":1520703,"ip_address":"四川","ucode":"DCAFD1DD5C6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/3f/4b6cd370.jpg","comment_is_top":false,"comment_ctime":1679579856,"is_pvip":false,"replies":[{"id":135554,"content":"你可以拿自己的数据集试一下呀，情感分析总体还是一个相对简单的问题","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679971051,"ip_address":"上海","comment_id":371148,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"老师，通过这种方式做的情感分析，在一些特定的领域效果是不是还能有这么好？比如：婚恋，政府舆情","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611185,"discussion_content":"你可以拿自己的数据集试一下呀，情感分析总体还是一个相对简单的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679971051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371125,"user_name":"不如不见","can_delete":false,"product_type":"c1","uid":1084890,"ip_address":"福建","ucode":"D8A04B288D7B46","user_header":"https://static001.geekbang.org/account/avatar/00/10/8d/da/b6e05e3c.jpg","comment_is_top":false,"comment_ctime":1679561286,"is_pvip":false,"replies":[{"id":135547,"content":"可以试一下先用Colab的环境，或者WSL的环境。\n\n我问了一下GPT-4，它是这样回答的：\n\n这个错误信息是因为在尝试导入Python的PIL（Pillow）库时，DLL加载失败。这可能是因为某些依赖文件缺失或损坏。要解决这个问题，请尝试以下步骤：\n\n首先，确保已经安装了最新版本的Pillow库。你可以使用以下命令更新Pillow库：\ncss\nCopy code\npip install --upgrade pillow\n如果问题依然存在，尝试卸载Pillow库，然后重新安装：\nCopy code\npip uninstall pillow\npip install pillow\n确保你的Python环境和Pillow库是相同架构的（例如，64位Python需要64位Pillow库）。如果你的Python是64位的，请确保你已安装64位的Pillow库。\n\n安装Visual C++ Redistributable。有些情况下，缺少Visual C++运行库可能导致这个问题。你可以从微软官方网站下载并安装适用于你的系统版本的Visual C++ Redistributable。\n\n如果问题仍未解决，检查系统环境变量","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679970605,"ip_address":"上海","comment_id":371125,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"报了这个错\nImportError: DLL load failed while importing _imaging: 找不到指定的模块。\n","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611178,"discussion_content":"可以试一下先用Colab的环境，或者WSL的环境。\n\n我问了一下GPT-4，它是这样回答的：\n\n这个错误信息是因为在尝试导入Python的PIL（Pillow）库时，DLL加载失败。这可能是因为某些依赖文件缺失或损坏。要解决这个问题，请尝试以下步骤：\n\n首先，确保已经安装了最新版本的Pillow库。你可以使用以下命令更新Pillow库：\ncss\nCopy code\npip install --upgrade pillow\n如果问题依然存在，尝试卸载Pillow库，然后重新安装：\nCopy code\npip uninstall pillow\npip install pillow\n确保你的Python环境和Pillow库是相同架构的（例如，64位Python需要64位Pillow库）。如果你的Python是64位的，请确保你已安装64位的Pillow库。\n\n安装Visual C++ Redistributable。有些情况下，缺少Visual C++运行库可能导致这个问题。你可以从微软官方网站下载并安装适用于你的系统版本的Visual C++ Redistributable。\n\n如果问题仍未解决，检查系统环境变量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679970605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371104,"user_name":"知行合一","can_delete":false,"product_type":"c1","uid":1521486,"ip_address":"北京","ucode":"2B8E634FC4CFB7","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/4e/5c3153b2.jpg","comment_is_top":false,"comment_ctime":1679549266,"is_pvip":false,"replies":[{"id":135540,"content":"没有理解你的问题，GPT系列模型现在有“幻觉”类型，容易瞎编的问题\n但是这个和其他用户无关啊","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679969723,"ip_address":"上海","comment_id":371104,"utype":1}],"discussion_count":2,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"用openai的接口做智能问答，会出现用户恶意改答案从而误导其他用户的情况吗？","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611165,"discussion_content":"没有理解你的问题，GPT系列模型现在有“幻觉”类型，容易瞎编的问题\n但是这个和其他用户无关啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679969724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2927617,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/wFFLMkicZicdsG0H4oETYokjdZvg9kzhbU31KGRDBNDc1cDZPa8tnOz0D9TNAibia4wLkLObnAGhvhksKsRibZnSKXA/132","nickname":"有原","note":"","ucode":"BA2B4911E66EDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610958,"discussion_content":"不会，因为答案是模型给的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679883654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371035,"user_name":"大寒","can_delete":false,"product_type":"c1","uid":3016994,"ip_address":"北京","ucode":"183B6448272B86","user_header":"https://static001.geekbang.org/account/avatar/00/2e/09/22/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1679474372,"is_pvip":false,"replies":[{"id":135361,"content":"我搜了一下，看看是不是你本地通过 pip 和 conda 都安装了一个matplotlib\nhttps:&#47;&#47;github.com&#47;pykeen&#47;pykeen&#47;issues&#47;505\n\n尝试重新安装一下matplotlib的包试试。","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679540425,"ip_address":"上海","comment_id":371035,"utype":1}],"discussion_count":2,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"import openai\nfrom openai.embeddings_utilsimport cosine_similarity, get_embedding\n这里我会报这个错误：\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\openai\\embeddings_utils.py:4\n      1 import textwrap as tr\n      2 from typing import List, Optional\n----&gt; 4 import matplotlib.pyplot as plt\n      5 import plotly.express as px\n      6 from scipy import spatial\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\matplotlib\\__init__.py:823\n    816     return config\n    819 # When constructing the global instances, we need to perform certain updates\n    820 # by explicitly calling the superclass (dict.update, dict.items) to avoid\n    821 # triggering resolution of _auto_backend_sentinel.\n    822 rcParamsDefault = _rc_params_in_file(\n--&gt; 823     cbook._get_data_path(&quot;matplotlibrc&quot;),\n    824     # Strip leading comment.\n    825     transform=lambda line: line[1:] if line.startswith(&quot;#&quot;) else line,\n    826     fail_on_error=True)\n    827 dict.update(rcParamsDefault, rcsetup._hardcoded_defaults)\n    828 rcParams = RcParams()  # The global instance.\n\nFile ~\\miniconda3\\envs\\py310\\lib\\site-packages\\matplotlib\\cbook\\__init__.py:534, in _get_data_path(*args)\n    528 def _get_data_path(*args):\n    529     &quot;&quot;&quot;\n    530     Return the `pathlib.Path` to a resource file provided by Matplotlib.\n    531 \n    532     ``*args`` specify a path relative to the base data path.\n    533     &quot;&quot;&quot;\n--&gt; 534     return Path(matplotlib.get_data_path(), *args)\n\nAttributeError: module &#39;matplotlib&#39; has no attribute &#39;get_data_path&#39;。有人遇到这个问题吗？需要改源码吗？","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610362,"discussion_content":"我搜了一下，看看是不是你本地通过 pip 和 conda 都安装了一个matplotlib\nhttps://github.com/pykeen/pykeen/issues/505\n\n尝试重新安装一下matplotlib的包试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679540425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3016994,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/09/22/791d0f5e.jpg","nickname":"大寒","note":"","ucode":"183B6448272B86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610557,"discussion_content":"老师，我试了下，windows conda安的环境出的问题，pycharm就通过了，很怪。我再尝试下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679622161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371009,"user_name":"Daniel","can_delete":false,"product_type":"c1","uid":2046024,"ip_address":"北京","ucode":"8AF73DE4F435B6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/38/48/557629d9.jpg","comment_is_top":false,"comment_ctime":1679458967,"is_pvip":false,"replies":[{"id":135354,"content":"你可以让ChatGPT为你输出画图工具的代码，比如你可以用这样一段提示语试一下\n\nCould you write some PlantUML code to draw a simple UML?\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1053568,"ctime":1679537520,"ip_address":"上海","comment_id":371009,"utype":1}],"discussion_count":3,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"老师，请问有ChatGPT作图的工具吗，画论文中的那种图，类似结构图&#47;流程图&#47;模型图等","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610346,"discussion_content":"你可以让ChatGPT为你输出画图工具的代码，比如你可以用这样一段提示语试一下\n\nCould you write some PlantUML code to draw a simple UML?\n\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679537520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":2046024,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/38/48/557629d9.jpg","nickname":"Daniel","note":"","ucode":"8AF73DE4F435B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"徐文浩","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":610378,"discussion_content":"这么说还是用英文描述好一点吗🤔","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679542243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610346,"ip_address":"北京","group_id":0},"score":610378,"extra":""},{"author":{"id":1911235,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","nickname":"渣渣辉","note":"","ucode":"730838D9161579","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2046024,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/38/48/557629d9.jpg","nickname":"Daniel","note":"","ucode":"8AF73DE4F435B6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611890,"discussion_content":"同问，不过毕竟是国外的东西，肯定在语言方面有偏向","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680400317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":610378,"ip_address":"日本","group_id":0},"score":611890,"extra":""}]}]},{"had_liked":false,"id":372197,"user_name":"Mr.x","can_delete":false,"product_type":"c1","uid":1130726,"ip_address":"北京","ucode":"FDA144380DB9AE","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/e6/2cd0f52b.jpg","comment_is_top":false,"comment_ctime":1680837590,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100541001,"comment_content":"\n代码片段解释有ChatGPT标注\n第二段代码：\n\nfrom sklearn.metrics import PrecisionRecallDisplay\n\n# 定义函数，用于评估使用嵌入向量的情感分析模型\ndef evaluate_embeddings_approach(\n    labels = [&#39;negative&#39;, &#39;positive&#39;], # 正负面情感标签列表，默认为[&#39;negative&#39;, &#39;positive&#39;]\n    model = EMBEDDING_MODEL, # 指定嵌入模型的变量，默认为EMBEDDING_MODEL\n):\n    # 使用get_embedding函数获取每个情感标签的嵌入向量，并存储在label_embeddings列表中\n    label_embeddings = [get_embedding(label, engine=model) for label in labels]\n\n    # 定义函数，用于计算评价的情感得分\n    def label_score(review_embedding, label_embeddings):\n        # 计算评价嵌入向量与正面情感标签嵌入向量之间的余弦相似度，减去评价嵌入向量与负面情感标签嵌入向量之间的余弦相似度\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\n    # 使用apply函数和lambda表达式计算每个评价的情感得分\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    # 将情感得分应用于阈值，以确定每个评价的情感标签\n    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)\n\n    # 使用classification_report函数生成分类报告，并将其存储在变量report中\n    report = classification_report(df.sentiment, preds)\n    print(report)\n\n    # 使用PrecisionRecallDisplay函数生成精确率-召回率曲线，并在图表上设置标题\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n\n# 调用函数，评估数据集的情感分析模型，并生成分类报告和精确率-召回率曲线的图表\nevaluate_embeddings_approach(labels=[&#39;An Amazon review with a negative sentiment.&#39;, &#39;An Amazon review with a positive sentiment.&#39;])\n\n","like_count":25},{"had_liked":false,"id":371809,"user_name":"渣渣辉","can_delete":false,"product_type":"c1","uid":1911235,"ip_address":"日本","ucode":"730838D9161579","user_header":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1680354252,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"之前浅学过深度学习技术，老师在这一章里把我一年学过的技术都给讲了还多讲了一些我不懂的技术！这就是大佬啊。","like_count":14},{"had_liked":false,"id":372196,"user_name":"Mr.x","can_delete":false,"product_type":"c1","uid":1130726,"ip_address":"北京","ucode":"FDA144380DB9AE","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/e6/2cd0f52b.jpg","comment_is_top":false,"comment_ctime":1680837580,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"代码片段解释有ChatGPT标注\n代码片段一：\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\n# 设置数据集文件路径\ndatafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\n\n# 使用pandas的read_csv函数读取csv文件，并将其存储在名为df的数据框中\ndf = pd.read_csv(datafile_path)\n\n# 使用apply函数和lambda表达式，将embedding列中的每个字符串转换为Python对象，并将其转换为NumPy数组\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n\n# 将评分为3的评价从数据框中删除\ndf = df[df.Score != 3]\n\n# 将评分为1、2的评价标记为negative，将评分为4、5的评价标记为positive，生成一个新的sentiment列\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n","like_count":9},{"had_liked":false,"id":370981,"user_name":"Bing","can_delete":false,"product_type":"c1","uid":1029063,"ip_address":"加拿大","ucode":"9AE29B1199CE2F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b3/c7/b1ada8a3.jpg","comment_is_top":false,"comment_ctime":1679420741,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"受教了，谢谢！","like_count":4},{"had_liked":false,"id":373551,"user_name":"陈鹏","can_delete":false,"product_type":"c1","uid":1574748,"ip_address":"立陶宛","ucode":"777F23D9178A6A","user_header":"https://static001.geekbang.org/account/avatar/00/18/07/5c/2b75c836.jpg","comment_is_top":false,"comment_ctime":1682650611,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"用了亚马逊耳机数据集，取前30条数据，结果如下，如果用excel打开csv文件，好像会导致报UnicodeDecodeError 错误\n              precision    recall  f1-score   support\n\n    negative       1.00      0.67      0.80         3\n    positive       0.80      1.00      0.89         4\n\n    accuracy                           0.86         7\n   macro avg       0.90      0.83      0.84         7\nweighted avg       0.89      0.86      0.85         7","like_count":2,"discussions":[{"author":{"id":1033956,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","nickname":"爬行的蜗牛","note":"","ucode":"6623B62DE63CE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621033,"discussion_content":"是你的文件就是 excel，就需要 read_excel() 来打开哈， 可以用 pandas:  pd.read_excel()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686753954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393806,"user_name":"Mamba","can_delete":false,"product_type":"c1","uid":1475049,"ip_address":"湖北","ucode":"8B3EC90736B8EB","user_header":"https://static001.geekbang.org/account/avatar/00/16/81/e9/d131dd81.jpg","comment_is_top":false,"comment_ctime":1724940615,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"# 获取文件内容\ninput_datapath = &quot;data&#47;product_reviews_120.csv&quot;\ndf = pd.read_csv(input_datapath)\ndf[:5]\n# 调用 OpenAI Embedding API\ndef embedding_text(text, model=&quot;text-embedding-3-small&quot;):\n    text = text.replace(&quot;\\n&quot;, &quot; &quot;)\n    res = client.embeddings.create(input=text, model=model)\n    return res.data[0].embedding\n\ndf[&quot;embedding&quot;] = df.Text.apply(embedding_text)\noutput_datapath = &quot;data&#47;product_reviews_with_embeddings_120.csv&quot;\n\n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n\nevaluate_embeddings_approach(labels=[&#39;A review with a negative sentiment.&#39;, &#39;A review with a positive sentiment.&#39;])\n\n             precision    recall  f1-score   support\n\n    negative       0.81      0.98      0.89        44\n    positive       0.98      0.83      0.90        60\n\n    accuracy                           0.89       104\n   macro avg       0.90      0.91      0.89       104\nweighted avg       0.91      0.89      0.89       104\n\n取了前120条评论，整体准确率接近90%，大模型的能力确实非常令人惊讶啊\n","like_count":1},{"had_liked":false,"id":375949,"user_name":"昵称C","can_delete":false,"product_type":"c1","uid":1234963,"ip_address":"北京","ucode":"1BB2D537942DC2","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/13/082013bc.jpg","comment_is_top":false,"comment_ctime":1686145695,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"fine_food_reviews_with_embeddings_1k.csv 这个文件哪里下载的？\n","like_count":1},{"had_liked":false,"id":371231,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"浙江","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1679657629,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"看到这节课，我才知道老师为什么不使用 Playground 了，API 能做更多事情","like_count":1},{"had_liked":false,"id":395662,"user_name":"鹿茸h","can_delete":false,"product_type":"c1","uid":3254156,"ip_address":"北京","ucode":"EF491114941549","user_header":"https://static001.geekbang.org/account/avatar/00/31/a7/8c/844fb438.jpg","comment_is_top":false,"comment_ctime":1731596848,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"2024-11-14 成功运行\nimport os\nimport pandas as pd\nimport numpy as np\nfrom sklearn.metrics import classification_report, PrecisionRecallDisplay\nfrom scipy.spatial import distance\nimport openai\nopenai.api_key = os.environ[&#39;OPENAI_API_KEY&#39;]\nopenai.base_url = os.environ[&#39;OPENAI_BASE_URL&#39;]\nEMBEDDING_MODEL = &quot;text-embedding-3-small&quot;\ndatafile_path = &quot;data&#47;AllProductReviews.csv&quot;\ndf = pd.read_csv(datafile_path, nrows=60)\nclient = openai.OpenAI(api_key=openai.api_key, base_url=openai.base_url)\ndef embedding_text(text, model=EMBEDDING_MODEL):\n    text = text.replace(&quot;\\n&quot;, &quot; &quot;)\n    res = client.embeddings.create(input=text, model=model)\n    return res.data[0].embedding\ndf[&quot;embedding&quot;] = df[&quot;ReviewBody&quot;].apply(embedding_text)\ndf = df[df[&quot;ReviewStar&quot;] != 3]\ndf[&quot;sentiment&quot;] = df[&quot;ReviewStar&quot;].replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\ndef cosine_similarity(vec1, vec2):\n    return 1 - distance.cosine(vec1, vec2)\ndef evaluate_embeddings_approach(labels=[&#39;negative&#39;, &#39;positive&#39;]):\n    label_embeddings = [embedding_text(label) for label in labels]\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    preds = probas.apply(lambda x: &#39;positive&#39; if x &gt; 0 else &#39;negative&#39;)\n    report = classification_report(df[&quot;sentiment&quot;], preds)\n    print(report)\n    display = PrecisionRecallDisplay.from_predictions(df[&quot;sentiment&quot;], probas, pos_label=&#39;positive&#39;)\n    display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\nevaluate_embeddings_approach()","like_count":0},{"had_liked":false,"id":393756,"user_name":"Johar","can_delete":false,"product_type":"c1","uid":1101969,"ip_address":"重庆","ucode":"834136A6F64CDC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/91/89123507.jpg","comment_is_top":false,"comment_ctime":1724805589,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"评价是正向还是负向的示例中，各使用一个示例评价作为正向或负向的基准，这个基准的选择是否影响最终的判断？若影响，这个基准怎么选取？","like_count":0},{"had_liked":false,"id":391383,"user_name":"Geek_18dfaf","can_delete":false,"product_type":"c1","uid":1543018,"ip_address":"浙江","ucode":"CFC27E78220E2D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqw0R25Bt0iahFhEHfnxmzr9iaZf0eLsDQtFUJzgGkYwHTqicU9TydMngrJ4yL7D50awD2VibHBAdqplQ/132","comment_is_top":false,"comment_ctime":1718164433,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100541001,"comment_content":"data&#47;fine_food_reviews_with_embeddings_1k.csv   老师，可以把这个给放出来吗","like_count":0},{"had_liked":false,"id":391090,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1717305568,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":2,"score":8,"product_id":100541001,"comment_content":"第2讲打卡~","like_count":0},{"had_liked":false,"id":390612,"user_name":"Geek_5b53d8","can_delete":false,"product_type":"c1","uid":3833002,"ip_address":"英国","ucode":"71267F03CAE998","user_header":"","comment_is_top":false,"comment_ctime":1715769587,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"课后练习运行下面代码返回报错，各位老师给看看什么原因，卡这了\n\n报错：\nModuleNotFoundError                       Traceback (most recent call last)\nCell In[44], line 5\n      2 import numpy as np\n      4 from sklearn.metrics import classification_report,PrecisionRecallDisplay\n----&gt; 5 from openai.embeddings_utils import cosine_similarity, get_embedding\n      7 EMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n      9 #datafile_path = &quot;data&#47;AllProductReviews.csv&quot;\n\nModuleNotFoundError: No module named &#39;openai.embeddings_utils&#39;\n\n\n代码：\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report,PrecisionRecallDisplay\nfrom openai.embeddings_utils import cosine_similarity, get_embedding\n\nEMBEDDING_MODEL = &quot;text-embedding-ada-002&quot;\n\n#datafile_path = &quot;data&#47;AllProductReviews.csv&quot;\ndatafile_path = &quot;data&#47;AllProductReviews.csv&quot;\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x: get_embedding(x, engine=EMBEDDING_MODEL))\n\n# convert 5-star rating to binary sentiment\ndf = df[df.ReviewStar != 3]\ndf[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n\ndef evaluate_embeddings_approach(\n    labels = [&#39;negative&#39;, &#39;positive&#39;],\n    model = EMBEDDING_MODEL,\n):\n    label_embeddings = [get_embedding(label, engine=model) for label in labels]\n\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)\n\n    report = classification_report(df.sentiment, preds)\n    print(report)\n\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n\nevaluate_embeddings_approach()","like_count":0},{"had_liked":false,"id":388994,"user_name":"Geek_140d9f","can_delete":false,"product_type":"c1","uid":3834009,"ip_address":"美国","ucode":"358F4918023E9F","user_header":"","comment_is_top":false,"comment_ctime":1711350491,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"老师 我在这节中做OpenAI Cookbook的例子的时候出现错误，我不知道要如何修改了\nNameError                                 Traceback (most recent call last)\nCell In[4], line 21\n     18     display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n     19     _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n---&gt; 21 evaluate_embeddings_approach(labels=[&#39;An Amazon review with a negative sentiment.&#39;, &#39;An Amazon review with a positive sentiment.&#39;])\n\nCell In[4], line 7, in evaluate_embeddings_approach(labels, model)\n      3 def evaluate_embeddings_approach(\n      4     labels = [&#39;negative&#39;, &#39;positive&#39;], \n      5     model = EMBEDDING_MODEL,\n      6 ):\n----&gt; 7     label_embeddings = [get_embedding(label, engine=model) for label in labels]\n      9     def label_score(review_embedding, label_embeddings):\n     10         return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\nCell In[4], line 7, in &lt;listcomp&gt;(.0)\n      3 def evaluate_embeddings_approach(\n      4     labels = [&#39;negative&#39;, &#39;positive&#39;], \n      5     model = EMBEDDING_MODEL,\n      6 ):\n----&gt; 7     label_embeddings = [get_embedding(label, engine=model) for label in labels]\n      9     def label_score(review_embedding, label_embeddings):\n     10         return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\nNameError: name &#39;get_embedding&#39; is not defined","like_count":0},{"had_liked":false,"id":388854,"user_name":"新星","can_delete":false,"product_type":"c1","uid":3814977,"ip_address":"北京","ucode":"01B470B7092E91","user_header":"https://static001.geekbang.org/account/avatar/00/3a/36/41/8906e1a6.jpg","comment_is_top":false,"comment_ctime":1711008177,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"csv文件中，每条记录除了后面的嵌入向量外还有一个第二行，是什么意思呀","like_count":0},{"had_liked":false,"id":388510,"user_name":"茂松","can_delete":false,"product_type":"c1","uid":1052375,"ip_address":"广东","ucode":"458A6FBC49C48E","user_header":"https://static001.geekbang.org/account/avatar/00/10/0e/d7/7d7579c1.jpg","comment_is_top":false,"comment_ctime":1710315043,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"永远烧脑的贝叶斯 : )","like_count":0},{"had_liked":false,"id":388023,"user_name":"我母鸡啊！","can_delete":false,"product_type":"c1","uid":1633705,"ip_address":"浙江","ucode":"7BFB14BC99E978","user_header":"https://static001.geekbang.org/account/avatar/00/18/ed/a9/662318ab.jpg","comment_is_top":false,"comment_ctime":1709177624,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"from openai import OpenAI\nimport pandas as pd\nimport numpy as np\nfrom sklearn.metrics import PrecisionRecallDisplay\nfrom sklearn.metrics import classification_report\n\nclient = OpenAI()\n\nEMBEDDING_MODEL = &quot;text-embedding-3-small&quot;\n\ndatafile_path = &quot;data&#47;AllProductReviews.csv&quot;\ndf = pd.read_csv(datafile_path,nrows=60)\ndf[&quot;embedding&quot;] = df.ReviewBody.apply(lambda x: get_embedding(x, model=EMBEDDING_MODEL))\n\n# convert 5-star rating to binary sentiment\ndf = df[df.ReviewStar != 3]\ndf[&quot;sentiment&quot;] = df.ReviewStar.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})\n\ndef get_embedding(text, model=&quot;text-embedding-3-small&quot;):\n   text = text.replace(&quot;\\n&quot;, &quot; &quot;)\n   return client.embeddings.create(input = [text], model=model).data[0].embedding\n\ndef cosine_similarity(vector_a, vector_b): \n    dot_product = np.dot(vector_a, vector_b) \n    norm_a = np.linalg.norm(vector_a) \n    norm_b = np.linalg.norm(vector_b) \n    epsilon = 1e-10\n    cosine_similarity = dot_product &#47; (norm_a * norm_b + epsilon) \n    return cosine_similarity\n    \ndef evaluate_embeddings_approach(\n    labels = [&#39;negative&#39;, &#39;positive&#39;], \n    model = EMBEDDING_MODEL,\n):\n    label_embeddings = [get_embedding(label, model=model) for label in labels]\n\n    def label_score(review_embedding, label_embeddings):\n        return cosine_similarity(review_embedding, label_embeddings[1]) - cosine_similarity(review_embedding, label_embeddings[0])\n\n    probas = df[&quot;embedding&quot;].apply(lambda x: label_score(x, label_embeddings))\n    preds = probas.apply(lambda x: &#39;positive&#39; if x&gt;0 else &#39;negative&#39;)\n\n    report = classification_report(df.sentiment, preds)\n    print(report)\n\n    display = PrecisionRecallDisplay.from_predictions(df.sentiment, probas, pos_label=&#39;positive&#39;)\n    _ = display.ax_.set_title(&quot;2-class Precision-Recall curve&quot;)\n\nevaluate_embeddings_approach(labels=[&#39;An Amazon review with a negative sentiment.&#39;, &#39;An Amazon review with a positive sentiment.&#39;])","like_count":0},{"had_liked":false,"id":387914,"user_name":"Owen","can_delete":false,"product_type":"c1","uid":2403622,"ip_address":"广东","ucode":"FDE0D574B8ED5A","user_header":"https://static001.geekbang.org/account/avatar/00/24/ad/26/767527f6.jpg","comment_is_top":false,"comment_ctime":1708929488,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"大家好 我是广州大学2012级电子商务冯达成 学完本课后觉得获益匪浅！","like_count":0},{"had_liked":false,"id":387876,"user_name":"HXL","can_delete":false,"product_type":"c1","uid":2631455,"ip_address":"北京","ucode":"97298EEC95BFCA","user_header":"https://static001.geekbang.org/account/avatar/00/28/27/1f/42059b0f.jpg","comment_is_top":false,"comment_ctime":1708756445,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"总结：\n1. 简单介绍了下 embeding接口的使用\n2. 介绍了使用 zero-shot 实现情感分析的方法","like_count":0},{"had_liked":false,"id":387866,"user_name":"tuxknight","can_delete":false,"product_type":"c1","uid":1000882,"ip_address":"上海","ucode":"B78FE23CB2641B","user_header":"","comment_is_top":false,"comment_ctime":1708746542,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"好评差评是生成了两个标准向量，然后计算评论离标准向量的距离。那如果标准向量有多个的情况下，该如何计算余弦距离？\n比如用 Embedding 做面试候选人的简历进行筛选的场景，为已经通过筛选的每个简历计算向量，然后再计算候选人和这些简历的余玄距离，然后再对最终的结果取平均值。这样感觉是比较粗暴的办法。有其他更好的办法吗？","like_count":0},{"had_liked":false,"id":387829,"user_name":"Jahng","can_delete":false,"product_type":"c1","uid":1325514,"ip_address":"广东","ucode":"5D5789EAAC4739","user_header":"https://static001.geekbang.org/account/avatar/00/14/39/ca/4a07bfd8.jpg","comment_is_top":false,"comment_ctime":1708664080,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100541001,"comment_content":"能把计算余弦距离的事情也交给chatgpt 做吗，直接让他告诉我们是好评还是差评","like_count":0},{"had_liked":false,"id":387816,"user_name":"大魔王汪汪","can_delete":false,"product_type":"c1","uid":1010680,"ip_address":"北京","ucode":"4B205CB52FC95F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/f8/b4da7936.jpg","comment_is_top":false,"comment_ctime":1708618854,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"“差评被误判为了好评”，这种问题在企业工程中可以做哪些事情，解决呢？","like_count":0},{"had_liked":false,"id":387809,"user_name":"小强","can_delete":false,"product_type":"c1","uid":1155961,"ip_address":"浙江","ucode":"AFA06753068BD7","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/79/ef7e9920.jpg","comment_is_top":false,"comment_ctime":1708606104,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"你好，要是没有ChatGPT账号，是不是就没法跑代码了","like_count":0},{"had_liked":false,"id":380823,"user_name":"小白","can_delete":false,"product_type":"c1","uid":2144734,"ip_address":"江苏","ucode":"3D174A747CB4BC","user_header":"https://static001.geekbang.org/account/avatar/00/20/b9/de/d1bc0a08.jpg","comment_is_top":false,"comment_ctime":1694239505,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"我可能太小白了，我没明白这段代码的用意，老师你是输入了一段语言描述让api生成了一段代码，然后代码可以很好的得出我们想要的结果吗？你的例子好像对于非专业人士还是比较难懂怎么搞定这个情感分析。或者是说对于一个产品经理的我，没办法理解前后输入输出，和还是没法办理解怎么用。","like_count":0},{"had_liked":false,"id":380514,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"北京","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1693745458,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"前不久刚好有一个分析语句情感的工作，因为条件和技术的限制，采用了最简单原始的关键词分析法。\n\n关于好评差评的例子，有一个地方不是很明白\n\npositive_review = get_embedding(&quot;好评&quot;)\n\n如何通过 get_embedding(“好评”) 就得到了positive_review ？只是从 “好评” 二字而来么？\n\n我试着把“好评”和“差评”二字换成“好、坏”，“表扬，批评”，甚至是“good, bad”，“positive, negative”，都基本上可以得到类似的结果，但是区分度似乎是不如“好评、差评”组合\n\n在课后的小结部分提到，“经过预训练的大语言模型里面，已经蕴含了情感分析的知识”\n\n参考 @Roy Liang 的留言，做了一下课后作业，但是我也只能做 100 条数据的，如果 3000 条的话会出现 RateLimitError。\n\n数据上略有差异，体验一下就好","like_count":0},{"had_liked":false,"id":380499,"user_name":"Aron.王安英","can_delete":false,"product_type":"c1","uid":1367788,"ip_address":"北京","ucode":"E0B42516CEC512","user_header":"https://static001.geekbang.org/account/avatar/00/14/de/ec/12293699.jpg","comment_is_top":false,"comment_ctime":1693725288,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"我不理解的地方是，单独使用&quot;好评&quot;的余弦相似度或&quot;差评&quot;的余弦相似度是否就可以判断是&quot;好评&quot;或&quot;差评&quot;，为什么要用“好评”的相似度去减去和“差评”之间的相似度","like_count":0},{"had_liked":false,"id":378998,"user_name":"狂奔的蜗牛","can_delete":false,"product_type":"c1","uid":1448704,"ip_address":"美国","ucode":"F575D8BB177C29","user_header":"https://static001.geekbang.org/account/avatar/00/16/1b/00/cacb24f5.jpg","comment_is_top":false,"comment_ctime":1691119096,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"是否能给data&#47;fine_food_reviews_with_embeddings_1k.csv这个文件，向运行一下本课程第二段代码找找感觉。","like_count":0},{"had_liked":false,"id":378863,"user_name":"狂奔的蜗牛","can_delete":false,"product_type":"c1","uid":1448704,"ip_address":"北京","ucode":"F575D8BB177C29","user_header":"https://static001.geekbang.org/account/avatar/00/16/1b/00/cacb24f5.jpg","comment_is_top":false,"comment_ctime":1690897003,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"请问一下老师“好评”和“差评”的 Embedding如何计算获得？","like_count":0},{"had_liked":false,"id":378437,"user_name":"AI悦创","can_delete":false,"product_type":"c1","uid":1525309,"ip_address":"福建","ucode":"D1007711CB0A79","user_header":"https://static001.geekbang.org/account/avatar/00/17/46/3d/55653953.jpg","comment_is_top":false,"comment_ctime":1690255354,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"P(垃圾∣X)∝P(buy∣垃圾)×P(money∣垃圾)×P(sell∣垃圾)×P(垃圾)=1×1×0.5×0.5=0.25P(普通∣X)∝P(buy∣普通)×P(money∣普通)×P(sell∣普通)×P(普通)=0×0×0.5×0.5=0\n这部分能不能讲解一下？不太理解","like_count":0,"discussions":[{"author":{"id":1796336,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/68/f0/7ccf8fde.jpg","nickname":"探花","note":"","ucode":"3992C7371915E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624497,"discussion_content":"【[5分钟学算法] #02 朴素贝叶斯 写作业还得看小明】 https://www.bilibili.com/video/BV1eT411V7jM/?share_source=copy_web&amp;vd_source=a39309e8af1ec3f9c139e5bfceddec58","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690611350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378367,"user_name":"nikey","can_delete":false,"product_type":"c1","uid":1711042,"ip_address":"上海","ucode":"4E0E375B474C65","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/c2/5a8fdbf2.jpg","comment_is_top":false,"comment_ctime":1690158546,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"小白问题想请教下，我这边是在人力资源行业，需要针对简历自动打标签也可以通过大模型实现吗？","like_count":0},{"had_liked":false,"id":376323,"user_name":"Geek_fe0336","can_delete":false,"product_type":"c1","uid":1422144,"ip_address":"日本","ucode":"09D070BD4EFB57","user_header":"https://static001.geekbang.org/account/avatar/00/15/b3/40/54894c8f.jpg","comment_is_top":false,"comment_ctime":1686704291,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":9,"product_id":100541001,"comment_content":"为什么我把文中代码copy到jupyter运行后得到的分值都是负数呢？","like_count":0},{"had_liked":false,"id":376189,"user_name":"Penguin Shi","can_delete":false,"product_type":"c1","uid":3646806,"ip_address":"广东","ucode":"477A24D7ECE09A","user_header":"https://static001.geekbang.org/account/avatar/00/37/a5/56/b3cf71a9.jpg","comment_is_top":false,"comment_ctime":1686478661,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"&quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;这个文件怎么获得？","like_count":0},{"had_liked":false,"id":376158,"user_name":"爬行的蜗牛","can_delete":false,"product_type":"c1","uid":1033956,"ip_address":"四川","ucode":"6623B62DE63CE9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QD6bf8hkS5dHrabdW7M7Oo9An1Oo3QSxqoySJMDh7GTraxFRX77VZ2HZ13x3R4EVYddIGXicRRDAc7V9z5cLDlA/132","comment_is_top":false,"comment_ctime":1686404126,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"把老师的代码稍微改了下，由于 2000字符，更改的部分：\ndef get_score(sample_embedding):\n    # 将样本的嵌入式向量与 &quot;好评&quot; 的嵌入式向量计算余弦相似度\n    similarity_to_positive = cosine_similarity(sample_embedding, positive_review)\n    print(&quot;similarity_to_positive 的数值&quot;,similarity_to_positive)\n    # 将样本的嵌入式向量与 &quot;差评&quot; 的嵌入式向量计算余弦相似度\n    similarity_to_negative = cosine_similarity(sample_embedding, negative_review)\n    print(&quot;similarity_to_negative 的数值&quot;,similarity_to_negative)\n    # 返回 &quot;好评&quot; 与样本的余弦相似度减去 &quot;差评&quot; 与样本的余弦相似度\n    return similarity_to_positive - similarity_to_negative\n\n# 计算正面评价和负面评价的分数\npositive_score = get_score(positive_example)\nnegative_score = get_score(negative_example)\n\n# 打印结果\nprint(&quot;好评例子的评分: %f&quot; % positive_score)\nprint(&quot;差评例子的评分: %f&quot; % negative_score)\n\n\nsimilarity_to_positive 的数值 0.6200280967994568\nsimilarity_to_negative 的数值 0.5490649555294066\nsimilarity_to_positive 的数值 0.6768967631202036\nsimilarity_to_negative 的数值 0.7497917687444026\n好评例子的评分: 0.070963\n差评例子的评分: -0.072895\n\nsimilarity_to_positive - similarity_to_negative 如果一个文本与 &quot;好评&quot; 的嵌入式向量的余弦相似度高于\n与 &quot;差评&quot; 的嵌入式向量的余弦相似度，那么它更可能是一个正面评价；反之，如果一个文本与 &quot;好评&quot; 的嵌入式向量的余弦相似度低于与 &quot;差评&quot; 的嵌入式向量的余弦。","like_count":0},{"had_liked":false,"id":376001,"user_name":"Geek_60fb43","can_delete":false,"product_type":"c1","uid":2759724,"ip_address":"美国","ucode":"AB64E518365563","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJR9BnoUwDvLCTRtCqCiaq1Cca3nQmf6doM0RyytrEJTXckNWroeomswMgR8Lx5Y7WHfIQBVjibIbLg/132","comment_is_top":false,"comment_ctime":1686213432,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"我为什么一直显示找不到文件，权限和路径都看了没问题。。。","like_count":0,"discussions":[{"author":{"id":1130729,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/e9/29dfa621.jpg","nickname":"小灰","note":"","ucode":"1AB4E3AEDEE7FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622420,"discussion_content":"[文件下载地址](https://github.com/openai/openai-cookbook/blob/main/examples/data/fine_food_reviews_with_embeddings_1k.csv)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688266202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375540,"user_name":"Geek_fdab00","can_delete":false,"product_type":"c1","uid":3599686,"ip_address":"天津","ucode":"1F399A60E00158","user_header":"","comment_is_top":false,"comment_ctime":1685606536,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"import pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\ndatafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\n\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n\n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})            这段代码找不到数据文件 “fine_food_reviews_with_emddings_1k.csv”","like_count":0,"discussions":[{"author":{"id":1130729,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/e9/29dfa621.jpg","nickname":"小灰","note":"","ucode":"1AB4E3AEDEE7FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622421,"discussion_content":"[文件下载地址](https://github.com/openai/openai-cookbook/blob/main/examples/data/fine_food_reviews_with_embeddings_1k.csv)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688266226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375538,"user_name":"Geek_fdab00","can_delete":false,"product_type":"c1","uid":3599686,"ip_address":"天津","ucode":"1F399A60E00158","user_header":"","comment_is_top":false,"comment_ctime":1685606387,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"import pandas as pd\nimport numpy as np\n\nfrom sklearn.metrics import classification_report\n\ndatafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\n\ndf = pd.read_csv(datafile_path)\ndf[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n  \n# convert 5-star rating to binary sentiment\ndf = df[df.Score != 3]\ndf[&quot;sentiment&quot;] = df.Score.replace({1: &quot;negative&quot;, 2: &quot;negative&quot;, 4: &quot;positive&quot;, 5: &quot;positive&quot;})","like_count":0},{"had_liked":false,"id":375537,"user_name":"Geek_fdab00","can_delete":false,"product_type":"c1","uid":3599686,"ip_address":"天津","ucode":"1F399A60E00158","user_header":"","comment_is_top":false,"comment_ctime":1685606030,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"FileNotFoundError                         Traceback (most recent call last)\n&lt;ipython-input-19-abb072f7d536&gt; in &lt;cell line: 8&gt;()\n      6 datafile_path = &quot;data&#47;fine_food_reviews_with_embeddings_1k.csv&quot;\n      7 \n----&gt; 8 df = pd.read_csv(datafile_path)\n      9 df[&quot;embedding&quot;] = df.embedding.apply(eval).apply(np.array)\n     10 \n\n6 frames\n&#47;usr&#47;local&#47;lib&#47;python3.10&#47;dist-packages&#47;pandas&#47;io&#47;common.py in get_handle(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\n    854         if ioargs.encoding and &quot;b&quot; not in ioargs.mode:\n    855             # Encoding\n--&gt; 856             handle = open(\n    857                 handle,\n    858                 ioargs.mode, 老师报了错误，麻烦指导一下，哪里错了，需要修改一下","like_count":0,"discussions":[{"author":{"id":1130729,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/e9/29dfa621.jpg","nickname":"小灰","note":"","ucode":"1AB4E3AEDEE7FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622422,"discussion_content":"[文件下载地址](https://github.com/openai/openai-cookbook/blob/main/examples/data/fine_food_reviews_with_embeddings_1k.csv)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688266237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375486,"user_name":"猫头鹰爱拿铁","can_delete":false,"product_type":"c1","uid":1105958,"ip_address":"中国香港","ucode":"24266B58968428","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/26/4942a09e.jpg","comment_is_top":false,"comment_ctime":1685529501,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"问一个小白的问题，我没有用过python，在跑第二段代码的时候出现了NameError: name &#39;EMBEDDING_MODEL&#39; is not defined，这个问题我应该如何解决？是需要在替换一个模型吗？","like_count":0},{"had_liked":false,"id":375139,"user_name":"firefox","can_delete":false,"product_type":"c1","uid":3631175,"ip_address":"北京","ucode":"5818A9BDEA2950","user_header":"https://static001.geekbang.org/account/avatar/00/37/68/47/7a239689.jpg","comment_is_top":false,"comment_ctime":1684977345,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"对py 不是很熟悉。能帮忙看看为什么提示 not found 。matplotlib 已经安装了\n\n---------------------------------------------------------------------------\nModuleNotFoundError                       Traceback (most recent call last)\nCell In[1], line 3\n      1 import openai\n      2 import os\n----&gt; 3 from openai.embeddings_utils import cosine_similarity, get_embedding\n      5 # 获取访问open ai的密钥\n      6 openai.api_key = os.getenv(&quot;OPENAI_API_KEY&quot;)\n\nFile ~&#47;opt&#47;miniconda3&#47;envs&#47;py310&#47;lib&#47;python3.10&#47;site-packages&#47;openai&#47;embeddings_utils.py:4\n      1 import textwrap as tr\n      2 from typing import List, Optional\n----&gt; 4 import matplotlib.pyplot as plt\n      5 import numpy as np\n      6 import pandas as pd\n\nModuleNotFoundError: No module named &#39;matplotlib&#39;","like_count":0},{"had_liked":false,"id":375048,"user_name":"菜头","can_delete":false,"product_type":"c1","uid":1456964,"ip_address":"上海","ucode":"C5E95519F9EA21","user_header":"https://static001.geekbang.org/account/avatar/00/16/3b/44/dd534c9b.jpg","comment_is_top":false,"comment_ctime":1684837098,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"老师你好，在 mac 下 vscode 中 debug source.py 的时候，`2-class Precision-Recall curve`\n这个曲线图并没有展示出来，而是一闪而退。\n（我没有 Scikit-learn 等库的知识基础，小白一个）","like_count":0},{"had_liked":false,"id":371140,"user_name":"知行合一","can_delete":false,"product_type":"c1","uid":1521486,"ip_address":"北京","ucode":"2B8E634FC4CFB7","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/4e/5c3153b2.jpg","comment_is_top":false,"comment_ctime":1679571456,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":10,"product_id":100541001,"comment_content":"主编能多放几讲吗？","like_count":0},{"had_liked":false,"id":371135,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"中国香港","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1679566600,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100541001,"comment_content":"及时雨。 一边自己摸索一边看课程。目前还比较基础，不知道要过度多久，希望更新加急。","like_count":0},{"had_liked":false,"id":371077,"user_name":"fireshort","can_delete":false,"product_type":"c1","uid":1008312,"ip_address":"广东","ucode":"10550CA9C6C730","user_header":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","comment_is_top":false,"comment_ctime":1679533572,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100541001,"comment_content":"更新有点慢，希望能快一点。","like_count":0},{"had_liked":false,"id":371058,"user_name":"沧海一心","can_delete":false,"product_type":"c1","uid":1283999,"ip_address":"浙江","ucode":"D455E46FE7D6E0","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/9f/cc0d515f.jpg","comment_is_top":false,"comment_ctime":1679492710,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100541001,"comment_content":"快点更新啊，老师","like_count":0},{"had_liked":false,"id":371038,"user_name":"Geek_ccdd68","can_delete":false,"product_type":"c1","uid":3572092,"ip_address":"北京","ucode":"3F8EB93697A8B9","user_header":"","comment_is_top":false,"comment_ctime":1679476310,"is_pvip":false,"replies":null,"discussion_count":3,"race_medal":0,"score":11,"product_id":100541001,"comment_content":"这一讲的东西跟aigc没有任何关联，属于基础入门项目了，价值不大","like_count":0,"discussions":[{"author":{"id":1045888,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f5/80/baddf03b.jpg","nickname":"zhihai.tu","note":"","ucode":"61371EA3EF6988","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610767,"discussion_content":"每个人的基础不一样，请照顾下其他同学。老师讲得很好，价值很大。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1679745335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1911235,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","nickname":"渣渣辉","note":"","ucode":"730838D9161579","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611889,"discussion_content":"aigc是啥。你想说的是不是AGI。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680400250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"日本","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2011138,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b0/02/98f8b0ee.jpg","nickname":"方华Elton","note":"","ucode":"180D03AADB5D2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611587,"discussion_content":"膜拜大佬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680180449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"辽宁","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371004,"user_name":"😁韩少帅😄","can_delete":false,"product_type":"c1","uid":1275844,"ip_address":"浙江","ucode":"92D76DA3B57E24","user_header":"https://static001.geekbang.org/account/avatar/00/13/77/c4/6c3bbe8a.jpg","comment_is_top":false,"comment_ctime":1679455782,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":11,"product_id":100541001,"comment_content":"总共 27 讲，每周3 讲，9 周讲完，总共要两个月才能结束吗？","like_count":0}]}