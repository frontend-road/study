{"id":6936,"title":"04 | OAuth2 的正式定义","content":"无","comments":[{"had_liked":false,"id":7915,"user_name":"DK","can_delete":false,"product_type":"c3","uid":1086081,"ip_address":"","ucode":"86A5726FEC7FCC","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/81/ca6142a6.jpg","comment_is_top":false,"comment_ctime":1525780437,"is_pvip":false,"replies":[{"id":2762,"content":"不是，资源服务器会对token进行权限校验（也可在微服务网关上集中做），简单讲，资源服务器可以按需增加细粒度权限控制～这个token对应的用户是什么角色，有什么权限，能做什么操作，资源服务器有更多决策权，而且不同资源服务器可有不用策略。当然token是有被盗用风险，有一些安全措施防止被盗，发现被盗可以吊销，另外可根据场景缩短token有效期。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1526654059,"ip_address":"","comment_id":7915,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"如果拿到token之后，岂不是对于任何服务的访问就没有限制了，利用该token攻击别人的数据怎么处理呢","like_count":20,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":417517,"discussion_content":"不是，资源服务器会对token进行权限校验（也可在微服务网关上集中做），简单讲，资源服务器可以按需增加细粒度权限控制～这个token对应的用户是什么角色，有什么权限，能做什么操作，资源服务器有更多决策权，而且不同资源服务器可有不用策略。当然token是有被盗用风险，有一些安全措施防止被盗，发现被盗可以吊销，另外可根据场景缩短token有效期。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1526654059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":7862,"user_name":"我是Helen💋","can_delete":false,"product_type":"c3","uid":1094625,"ip_address":"","ucode":"0E384A8727F653","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/e1/538c5963.jpg","comment_is_top":false,"comment_ctime":1525750597,"is_pvip":false,"replies":[{"id":2755,"content":"谢谢支持🌹","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1526653037,"ip_address":"","comment_id":7862,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"欲罢不能，高手就是能把复杂的问题用最通俗的表达展现出来。视频课程中我觉得最好的，没有之一。波波老师已成我的偶像啦。","like_count":16,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":417500,"discussion_content":"谢谢支持🌹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1526653037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15202,"user_name":"立地成佛","can_delete":false,"product_type":"c3","uid":1172516,"ip_address":"","ucode":"0D0D9B245752C3","user_header":"https://static001.geekbang.org/account/avatar/00/11/e4/24/9f38e28d.jpg","comment_is_top":false,"comment_ctime":1530999056,"is_pvip":false,"replies":[{"id":5395,"content":"恩，你看得很细，这个严格不能算按某个维度分的类型，是常见token称谓的解释，谢谢反馈🌹","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1531405133,"ip_address":"","comment_id":15202,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"token分类这页有问题吧，分类维度都各不相同，怎么就分了五类？","like_count":8,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420283,"discussion_content":"恩，你看得很细，这个严格不能算按某个维度分的类型，是常见token称谓的解释，谢谢反馈🌹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531405133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":8332,"user_name":"加勒比海贼王","can_delete":false,"product_type":"c3","uid":1003465,"ip_address":"","ucode":"D922A1A5B3B04B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSyGkBwG4wwX0icYz21Y4dLibuDscJEWAOwlicgJP0lafViaf0kFyGricwJEaZ9icbIo8Q3CziaYsKmqFFA/132","comment_is_top":false,"comment_ctime":1526095633,"is_pvip":false,"replies":[{"id":2757,"content":"Bearer Token是Access Token的一种格式，这种格式一般是随机字符串无特殊意义，也就是不能从Bearer Token的字面推断出这个Token是谁颁发给谁的，像现钞一样谁拿到了都可以去消费使用；还有一种叫Proof of Possession(PoP) Token，这种Token里头包含所有者信息，可以校验拥有者，别人不能随便用。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1526653206,"ip_address":"","comment_id":8332,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"Access Token和 Bearer Token有什么区别呢？","like_count":5,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":417675,"discussion_content":"Bearer Token是Access Token的一种格式，这种格式一般是随机字符串无特殊意义，也就是不能从Bearer Token的字面推断出这个Token是谁颁发给谁的，像现钞一样谁拿到了都可以去消费使用；还有一种叫Proof of Possession(PoP) Token，这种Token里头包含所有者信息，可以校验拥有者，别人不能随便用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1526653206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161487,"user_name":"码农Kevin亮","can_delete":false,"product_type":"c3","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1576216662,"is_pvip":false,"replies":[{"id":61651,"content":"这个问题很容易混淆，oauth2的是一种代理授权协议，它只是定义令牌颁发的几种流程，具体你是怎么认证的，它其实没有定义，当然授权之前一般都有认证过程，只是它的规范没有定义。\n\n参考rfc 6749的3.1节（最后一句是重点）：\nhttps:&#47;&#47;tools.ietf.org&#47;html&#47;rfc6749#section-3.1\n\nThe authorization endpoint is used to interact with the resource owner and obtain an authorization grant. The authorization server MUST first verify the identity of the resource owner. The way in which the authorization server authenticates the resource owner (e.g., username and password login, session cookies) is beyond the scope of this specification.\n\n进一步可以参考stackoverflow上的说明，解释很清楚：\nhttps:&#47;&#47;stackoverflow.com&#47;questions&#47;33702826&#47;oauth-authorization-vs-authentication\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1576407717,"ip_address":"","comment_id":161487,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师一直强调OAuth是授权协议不是认证协议。究竟如何理解授权与认证两个概念呢？","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477735,"discussion_content":"这个问题很容易混淆，oauth2的是一种代理授权协议，它只是定义令牌颁发的几种流程，具体你是怎么认证的，它其实没有定义，当然授权之前一般都有认证过程，只是它的规范没有定义。\n\n参考rfc 6749的3.1节（最后一句是重点）：\nhttps://tools.ietf.org/html/rfc6749#section-3.1\n\nThe authorization endpoint is used to interact with the resource owner and obtain an authorization grant. The authorization server MUST first verify the identity of the resource owner. The way in which the authorization server authenticates the resource owner (e.g., username and password login, session cookies) is beyond the scope of this specification.\n\n进一步可以参考stackoverflow上的说明，解释很清楚：\nhttps://stackoverflow.com/questions/33702826/oauth-authorization-vs-authentication\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576407717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":27878,"user_name":"在路上","can_delete":false,"product_type":"c3","uid":1216042,"ip_address":"","ucode":"170DA8D9E88726","user_header":"https://static001.geekbang.org/account/avatar/00/12/8e/2a/22423d8b.jpg","comment_is_top":false,"comment_ctime":1537960304,"is_pvip":false,"replies":[{"id":10673,"content":"资源服务器可以去授权服务器校验(透明令牌bearer token场景)，也可以网关集中校验，也可自校验（自包含令牌jwt token场景）。授权服务器和资源服务器上的校验功能（如filter）一般由一个团队（比如框架）集中开发维护，资源服务器本身一般由各业务团队独立开发。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1538480430,"ip_address":"","comment_id":27878,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"第三方应用携带token到资源服务器访问资源，资源服务器怎么知道这个token是否合法，需要到授权服务器请求验证吗？资源服务器和授权服务器一般属于一方开发的吗？","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425067,"discussion_content":"资源服务器可以去授权服务器校验(透明令牌bearer token场景)，也可以网关集中校验，也可自校验（自包含令牌jwt token场景）。授权服务器和资源服务器上的校验功能（如filter）一般由一个团队（比如框架）集中开发维护，资源服务器本身一般由各业务团队独立开发。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538480430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181009,"user_name":"stg609","can_delete":false,"product_type":"c3","uid":1073025,"ip_address":"","ucode":"FB70A75A891BB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg","comment_is_top":false,"comment_ctime":1582459049,"is_pvip":false,"replies":[{"id":70405,"content":"OAuth2只是一个授权协议，它没有规范认证部分，通过OAuth2获取的令牌是bearer token，只表示获得授权可以访问资源，但是这个token是透明的，不带用户身份相关信息。OIDC是OAuth2的扩展，支持认证部分。id token表示资源所有者已经经过认证，id token是自包含的自校验的，它里头有claims，可以包含用户身份identity相关信息。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1582636166,"ip_address":"","comment_id":181009,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师能说一下 OIDC (open id connect) 相比于 OAuth2 多出来的 Id token 的作用及好处吗？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484887,"discussion_content":"OAuth2只是一个授权协议，它没有规范认证部分，通过OAuth2获取的令牌是bearer token，只表示获得授权可以访问资源，但是这个token是透明的，不带用户身份相关信息。OIDC是OAuth2的扩展，支持认证部分。id token表示资源所有者已经经过认证，id token是自包含的自校验的，它里头有claims，可以包含用户身份identity相关信息。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582636166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218889,"user_name":"李小隆_","can_delete":false,"product_type":"c3","uid":1136827,"ip_address":"","ucode":"1A3FCE92CCBC80","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/bb/c78c6482.jpg","comment_is_top":false,"comment_ctime":1589893634,"is_pvip":false,"replies":[{"id":81345,"content":"具体要看应用场景和微信的开发者文档，可以参考\nhttps:&#47;&#47;open.weixin.qq.com&#47;\n的资源中心，我简单看了一下，网站应用，还有移动应用的微信登陆功能等，都是直接支持oauth2的。其它应用场景，可能采用的是oauth2的一种变体，或者微信定制的认证授权协议。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1590243745,"ip_address":"","comment_id":218889,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师你好，我想问下微信jssdk里面，通过微信公众号appId去调用wx.config的过程，是不是也是一个oauth2的过程呢？如果不是，那微信授权的过程是使用了什么技术在里面呢？学生对此比较困惑，希望得到老师的解惑或者指引方向。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495614,"discussion_content":"具体要看应用场景和微信的开发者文档，可以参考\nhttps://open.weixin.qq.com/\n的资源中心，我简单看了一下，网站应用，还有移动应用的微信登陆功能等，都是直接支持oauth2的。其它应用场景，可能采用的是oauth2的一种变体，或者微信定制的认证授权协议。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590243745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218888,"user_name":"李小隆_","can_delete":false,"product_type":"c3","uid":1136827,"ip_address":"","ucode":"1A3FCE92CCBC80","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/bb/c78c6482.jpg","comment_is_top":false,"comment_ctime":1589893523,"is_pvip":false,"replies":[{"id":81346,"content":"这个从配置看，不是oauth2协议，而是微信定制的一种安全认证协议。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1590243822,"ip_address":"","comment_id":218888,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师你好，我想问下微信JSSDK里面调用的通过wx.config({\n    debug: true, &#47;&#47; 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\n    appId: &#39;&#39;, &#47;&#47; 必填，公众号的唯一标识\n    timestamp: , &#47;&#47; 必填，生成签名的时间戳\n    nonceStr: &#39;&#39;, &#47;&#47; 必填，生成签名的随机串\n    signature: &#39;&#39;,&#47;&#47; 必填，签名，见附录1\n    jsApiList: [] &#47;&#47; 必填，需要使用的JS接口列表，所有JS接口列表见附录2\n});","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495613,"discussion_content":"这个从配置看，不是oauth2协议，而是微信定制的一种安全认证协议。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590243822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215625,"user_name":"小卓","can_delete":false,"product_type":"c3","uid":1175112,"ip_address":"","ucode":"97DBF7EC64EF54","user_header":"https://static001.geekbang.org/account/avatar/00/11/ee/48/817eddc7.jpg","comment_is_top":false,"comment_ctime":1589035146,"is_pvip":false,"replies":[{"id":79980,"content":"对，oauth2主要是一个授权协议，它没有规范认证部分。一般oauth2服务器实现可以把认证和授权都集成在一起。\n例如可以参考fusionauth这个免费(但不开源)产品，它主要是一个身份(identity server)服务，同时集成了oauth。https:&#47;&#47;fusionauth.io&#47;","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1589204539,"ip_address":"","comment_id":215625,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"如果采用oauth2.0 那么国内好像是直接把认证服务也做到这个服务里面了？其实这个协议好像只规定了授权，没有认证那部分","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494500,"discussion_content":"对，oauth2主要是一个授权协议，它没有规范认证部分。一般oauth2服务器实现可以把认证和授权都集成在一起。\n例如可以参考fusionauth这个免费(但不开源)产品，它主要是一个身份(identity server)服务，同时集成了oauth。https://fusionauth.io/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589204539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197237,"user_name":"InfoQ_e077cb303519","can_delete":false,"product_type":"c3","uid":1390669,"ip_address":"","ucode":"2CCA309DB2EF46","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAK6F4BFT5ewhJEeZrjmRx5HxP8tvnNpJcpLlotHiadp0s6aL3d7LfMHEuQP6tibu80wUy8micVu4oQ/132","comment_is_top":false,"comment_ctime":1585364583,"is_pvip":false,"replies":[{"id":75140,"content":"一般可以认为认证就是用户登录认证","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585658166,"ip_address":"","comment_id":197237,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"认证是用户登录认证吗","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489479,"discussion_content":"一般可以认为认证就是用户登录认证","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585658166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191833,"user_name":"余松","can_delete":false,"product_type":"c3","uid":1487584,"ip_address":"","ucode":"89EC9CE3AD0281","user_header":"https://static001.geekbang.org/account/avatar/00/16/b2/e0/d856f5a4.jpg","comment_is_top":false,"comment_ctime":1584799290,"is_pvip":false,"replies":[{"id":74007,"content":"谢谢反馈，后续改进！","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1585052761,"ip_address":"","comment_id":191833,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"介绍访问令牌、刷新令牌、授权码、Bearer Token、PoP Token那一部分有点照本宣科了。咋一看PPT觉得他们是并列的5种类型，但是听讲解又不是，明显他们只有演进关系的，后面的Token解决前面的不能解决的问题。对于授权码的介绍又是在念概念。至少这一页PPT有点太随性了，虽然用了一个炫酷的图但是本质上还是罗列，甚至不如我们在平时部门内分享用心。\n感觉像一个知识点笔记，而不是像不知道的人讲解。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488267,"discussion_content":"谢谢反馈，后续改进！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585052761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117933,"user_name":"许凯","can_delete":false,"product_type":"c3","uid":1604645,"ip_address":"","ucode":"4F11AD41CB0244","user_header":"https://static001.geekbang.org/account/avatar/00/18/7c/25/70134099.jpg","comment_is_top":false,"comment_ctime":1564195442,"is_pvip":false,"replies":[{"id":43223,"content":"细粒度权限控制一般都是需要定制的，在微服务场景下，常见做法使用jwt令牌，里头可个包含用户角色和组等信息，这样可以在网关层做初步的权限控制，后台服务层还可以根据用户角色&#47;组等信息做进一步权限控制。后面我会开发一个案例项目，展示如何实现细粒度的微服务权限控制，请关注github.com&#47;spring2go上面的项目。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1564224148,"ip_address":"","comment_id":117933,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"想请问老师，有对资源进行细粒度的权限控制方案吗？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460188,"discussion_content":"细粒度权限控制一般都是需要定制的，在微服务场景下，常见做法使用jwt令牌，里头可个包含用户角色和组等信息，这样可以在网关层做初步的权限控制，后台服务层还可以根据用户角色/组等信息做进一步权限控制。后面我会开发一个案例项目，展示如何实现细粒度的微服务权限控制，请关注github.com/spring2go上面的项目。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564224148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1604645,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7c/25/70134099.jpg","nickname":"许凯","note":"","ucode":"4F11AD41CB0244","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3160,"discussion_content":"感谢，真棒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564234349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68263,"user_name":"张永峰","can_delete":false,"product_type":"c3","uid":1106891,"ip_address":"","ucode":"209823D8151A3D","user_header":"https://static001.geekbang.org/account/avatar/00/10/e3/cb/d13986f7.jpg","comment_is_top":false,"comment_ctime":1550471624,"is_pvip":false,"replies":[{"id":24397,"content":"严格按OAuth2协议规范讲是授权服务器，但是实际不需要太纠结，因为一般授权服务器也支持用户认证。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1550576932,"ip_address":"","comment_id":68263,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"（5）Authorization server：认证服务器，即服务提供商专门用来处理认证的服务器。\n\nyuanyifeng的blog里面的认证服务器，应该是授权服务器才更准确吧，严谨来讲的话，认证和授权（Authentication &amp; Authorization）是不同的概念。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439596,"discussion_content":"严格按OAuth2协议规范讲是授权服务器，但是实际不需要太纠结，因为一般授权服务器也支持用户认证。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550576932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63912,"user_name":"Geek_zbvt62","can_delete":false,"product_type":"c3","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg","comment_is_top":false,"comment_ctime":1548591257,"is_pvip":false,"replies":[{"id":22671,"content":"OAuth2主要的模式有四种，其中一种是机器直接参与(没有人参与的)，称为客户端模式(Client Credentials Grant) ，你讲的应该属于这种。课程后面有讲解，也可以进一步参考RFC6749，或者阮一峰的文章《理解OAuth2》http:&#47;&#47;www.ruanyifeng.com&#47;blog&#47;2014&#47;05&#47;oauth_2_0.html","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1548682771,"ip_address":"","comment_id":63912,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"老师，现在讲微服务的地方一定一提到oauth2，我实在弄不懂这俩之间到底算不算有必然的联系？\n比如我们的系统实践的微服务，有多个种类的“客户端角色”（有的是硬件设备），其中一部分并没有“用户”这一概念，也就不存在oauth2中那种典型的三角关系。\n就比如专门提供给硬件设备的服务，通过某些认证功能，服务端也发放了令牌（access token)给硬件设备，之后硬件设备可以持有这些令牌去和服务端其他api交互（上传数据，获取信息）。\n此种情况种种，有的存在refresh token，有的仅有access token。\n这算不算是oauth2呢？\n","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437760,"discussion_content":"OAuth2主要的模式有四种，其中一种是机器直接参与(没有人参与的)，称为客户端模式(Client Credentials Grant) ，你讲的应该属于这种。课程后面有讲解，也可以进一步参考RFC6749，或者阮一峰的文章《理解OAuth2》http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548682771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":184691,"discussion_content":"怎么哪都有你啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582558838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1046714,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg","nickname":"Geek_zbvt62","note":"","ucode":"81EA27ADD9EC1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":184906,"discussion_content":"我浪啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582587997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":184691,"ip_address":"","group_id":0},"score":184906,"extra":""}]}]},{"had_liked":false,"id":45707,"user_name":"你在门外笑","can_delete":false,"product_type":"c3","uid":1221199,"ip_address":"","ucode":"E14C41E8385D5D","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/4f/2fac8c70.jpg","comment_is_top":false,"comment_ctime":1543755939,"is_pvip":false,"replies":[{"id":16455,"content":"oauth2安全敏感场景下要求使用https","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1543839998,"ip_address":"","comment_id":45707,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"oauth2 应该可以使用https吧?","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431167,"discussion_content":"oauth2安全敏感场景下要求使用https","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543839998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24383,"user_name":"蜗牛","can_delete":false,"product_type":"c3","uid":1181680,"ip_address":"","ucode":"2D7A02C250042F","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/f0/6a678259.jpg","comment_is_top":false,"comment_ctime":1536940526,"is_pvip":false,"replies":[{"id":9644,"content":"授权服务器主要管授权，它一般集成有用户登录认证（user identity）模块，用户登录同意授权第三方应用可以访问自己在资源服务器上的资源。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1537681019,"ip_address":"","comment_id":24383,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"验证通过后进行授权，并将授权信息写入token里面。授权服务器只是授权，不进行验证，是这样吗？老师！我是小白，多多包涵","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423963,"discussion_content":"授权服务器主要管授权，它一般集成有用户登录认证（user identity）模块，用户登录同意授权第三方应用可以访问自己在资源服务器上的资源。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537681019,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218746,"user_name":"Lin.","can_delete":false,"product_type":"c3","uid":1308976,"ip_address":"","ucode":"8A792F33EFA304","user_header":"https://static001.geekbang.org/account/avatar/00/13/f9/30/1719a79f.jpg","comment_is_top":false,"comment_ctime":1589864453,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"oauth的本质在于如何获取tocken,如何使用tocken","like_count":0},{"had_liked":false,"id":202263,"user_name":"Siping","can_delete":false,"product_type":"c3","uid":1487971,"ip_address":"","ucode":"48E685333C663D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/63/21902253.jpg","comment_is_top":false,"comment_ctime":1585947595,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"讲得很细","like_count":0},{"had_liked":false,"id":188368,"user_name":"程序员二师兄","can_delete":false,"product_type":"c3","uid":1205697,"ip_address":"","ucode":"C9E3B5B3358BDF","user_header":"https://static001.geekbang.org/account/avatar/00/12/65/c1/afcd981b.jpg","comment_is_top":false,"comment_ctime":1584345338,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100007001,"comment_content":"更安全，客户端不接触用户密码；资源服务器和授权服务器解耦；集中式授权简化客户端","like_count":0}]}