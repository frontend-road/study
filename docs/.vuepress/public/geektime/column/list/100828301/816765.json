{"id":816765,"title":"04ï½œLLaMA 3çš„æ€è€ƒä¹‹é“ï¼šæ€ç»´é“¾çš„æºæµä¸åº”ç”¨","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Tylerã€‚</p><p>åœ¨ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•å°†å¤§æ¨¡å‹ä»ä¼ ç»Ÿçš„â€œå¯¹è¯æ¡†â€åº”ç”¨åœºæ™¯ä¸­è§£æ”¾å‡ºæ¥ï¼Œé€šè¿‡æŒ‡ä»¤å’Œå·¥å…·çš„ä½¿ç”¨ï¼Œæ‰©å±•å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œå³ä¾¿å¦‚æ­¤ï¼Œå¤§æ¨¡å‹åœ¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ï¼Œä»ç„¶ä¼šå‡ºç°åŠ›ä¸ä»å¿ƒçš„æƒ…å†µã€‚é¢å¯¹é•¿ç¯‡å¤æ‚çš„ä»»åŠ¡æè¿°ï¼Œæ¨¡å‹å¾€å¾€ä¼šæŠ“ä¸ä½é‡ç‚¹ï¼Œç”šè‡³å¯èƒ½äº§ç”Ÿä¸€äº›å¥‡æ€ªçš„é”™è¯¯ï¼Œè¿™åœ¨å®é™…åº”ç”¨ä¸­æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•è®©å¤§æ¨¡å‹åœ¨å¤„ç†å¤æ‚é—®é¢˜æ—¶æ›´åŠ å¾—å¿ƒåº”æ‰‹ï¼Ÿç ”ç©¶äººå‘˜é€šè¿‡ä¸æ–­çš„æ¢ç´¢ï¼Œæå‡ºäº†ä¸€ç§åä¸º<strong>æ€ç»´é“¾</strong>ï¼ˆChain of Thought, CoTï¼‰çš„æŠ€æœ¯ã€‚å®ƒä¸ä»…èƒ½å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£å¤æ‚é—®é¢˜ï¼Œè¿˜èƒ½é€æ­¥æ¨ç†å‡ºå‡†ç¡®çš„ç­”æ¡ˆã€‚ä»Šå¤©æˆ‘å°†å¸¦ä½ æ·±å…¥æ¢è®¨æ€ç»´é“¾çš„æ¦‚å¿µã€åº”ç”¨åœºæ™¯ã€æŠ€æœ¯å®ç°åŠå…¶åœ¨æœªæ¥æ™ºèƒ½ä½“åº”ç”¨ä¸­çš„æ½œåŠ›ã€‚</p><h2>ä»€ä¹ˆæ˜¯æ€ç»´é“¾ï¼Ÿ</h2><p>æ€ç»´é“¾ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¼•å¯¼æ¨¡å‹è¿›è¡Œé€æ­¥æ¨ç†çš„é“¾æ¡ã€‚é€šè¿‡åˆ†æ­¥éª¤æ€è€ƒï¼Œæ¨¡å‹èƒ½å¤Ÿåœ¨å¤æ‚çš„ä»»åŠ¡ä¸­é€æ¸æ¥è¿‘æ­£ç¡®ç­”æ¡ˆï¼Œé¿å…å› ç›´æ¥è·³åˆ°ç»“è®ºè€Œäº§ç”Ÿçš„é”™è¯¯ã€‚è¿™ç§æ–¹æ³•æœ€åˆæ˜¯ç”±ä¸€å¥ç®€å•çš„æç¤ºè¯­â€œLetâ€™s think step by stepâ€è¡ç”Ÿå‡ºæ¥çš„ã€‚è¿™å¥æç¤ºè¯­å‘Šè¯‰æ¨¡å‹ï¼šâ€œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œåˆ«æ€¥ã€‚â€è¿™å¥è¯å¯ä»¥æ˜¾è‘—æé«˜æ¨¡å‹åœ¨å¤„ç†å¤æ‚é—®é¢˜æ—¶çš„å‡†ç¡®æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/14/52/14955c841ace33370ebfa0bc9241eb52.png?wh=940x473\" alt=\"å›¾ç‰‡\" title=\"å›¾ç‰‡æ¥æºäº https://arxiv.org/abs/2201.11903\"></p><p>åœ¨æ¢è®¨æ€ç»´é“¾çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ€è€ƒä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼šæ‰€æœ‰çš„æ€ç»´é“¾æ˜¯å¦éƒ½æ˜¯é“¾ï¼Ÿå®é™…ä¸Šï¼Œæ€ç»´é“¾çš„çµæ´»æ€§å’Œå¤æ‚æ€§è¿œä¸æ­¢äºæ­¤ã€‚å°½ç®¡â€œé“¾â€æš—ç¤ºäº†ä¸€ä¸ªçº¿æ€§ç»“æ„ï¼Œä½†å®é™…ä¸Šï¼Œæ€ç»´é“¾å¯ä»¥è¡¨ç°ä¸ºæ›´åŠ å¤æ‚çš„å¤šæ­¥éª¤æ¨ç†è·¯å¾„ã€‚è¿™äº›è·¯å¾„æœ‰æ—¶å¯èƒ½æ˜¯æ ‘çŠ¶ç»“æ„ï¼Œæœ‰æ—¶åˆ™å¯èƒ½éœ€è¦åœ¨å¤šä¸ªå¹³è¡Œçš„æ¨ç†åˆ†æ”¯ä¸­è¿›è¡Œé€‰æ‹©å’Œç»„åˆã€‚å› æ­¤ï¼Œæ€ç»´é“¾çš„è®¾è®¡å¹¶éæ€»æ˜¯çº¿æ€§çš„ï¼Œè€Œæ˜¯æ ¹æ®å…·ä½“ä»»åŠ¡çš„å¤æ‚æ€§å’Œéœ€æ±‚è¿›è¡Œçµæ´»è°ƒæ•´ã€‚</p><!-- [[[read_end]]] --><p>æ€ç»´é“¾çš„æ ¸å¿ƒåœ¨äºé€æ­¥å¼•å¯¼æ¨¡å‹è¿›è¡Œæ¨ç†ï¼Œè€Œä¸æ˜¯è®©å®ƒä¸€æ¬¡æ€§å¾—å‡ºç»“è®ºã€‚é€šè¿‡è¿™ä¸€ç­–ç•¥ï¼Œæ¨¡å‹åœ¨æ¯ä¸ªæ¨ç†æ­¥éª¤ä¸­éƒ½éœ€è¦è®¤çœŸæ€è€ƒï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½æ˜¯é€»è¾‘ä¸¥è°¨ä¸”æ­£ç¡®çš„ã€‚è¿™ç§æ–¹æ³•ä¸ä»…å¯ä»¥å‡å°‘é”™è¯¯ï¼Œè¿˜èƒ½å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£é—®é¢˜çš„æ•´ä½“æ¡†æ¶ã€‚</p><p>ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£æ€ç»´é“¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ã€‚å‡è®¾æˆ‘ä»¬è®©æ¨¡å‹è§£å†³ä¸€ä¸ªæ•°å­¦é—®é¢˜ï¼Œç›´æ¥é—®å®ƒâ€œ5 + 3 + 7ç­‰äºå¤šå°‘ï¼Ÿâ€æ¨¡å‹é€šå¸¸å¯ä»¥ç›´æ¥ç»™å‡ºæ­£ç¡®ç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œå¦‚æœé—®é¢˜æ›´å¤æ‚ï¼Œæ¯”å¦‚æ¶‰åŠå¤šä¸ªæ­¥éª¤çš„æ¨ç†ï¼Œæ¨¡å‹å¯èƒ½ä¼šå‡ºé”™ã€‚è¿™æ—¶ï¼Œå¦‚æœæˆ‘ä»¬åœ¨é—®é¢˜å‰åŠ ä¸Šâ€œLetâ€™s think step by stepâ€ï¼Œæ¨¡å‹å°±ä¼šé€æ­¥è¿›è¡Œè§£é¢˜ï¼Œå¹¶æœ€ç»ˆå¾—å‡ºæ­£ç¡®ç­”æ¡ˆã€‚</p><h3>æ•°å­¦é—®é¢˜ä¸­çš„æ€ç»´é“¾</h3><pre><code class=\"language-python\">import ollama\n\ndef cot(problem):\n&nbsp; &nbsp; # æç¤ºæ¨¡å‹é€æ­¥æ€è€ƒ\n&nbsp; &nbsp; prompt = f\"{problem} Let's think step by step.\"\n&nbsp; &nbsp; response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'role': 'user',\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'content': prompt,\n&nbsp; &nbsp; &nbsp; &nbsp; },\n&nbsp; &nbsp; ])\n&nbsp; &nbsp; return response['content']\n\ndef solve_math_problem():\n&nbsp; &nbsp; problem = \"What is 5 + 3 + 7?\"\n&nbsp; &nbsp; result = cot(problem)\n&nbsp; &nbsp; return result\n\nresult = solve_math_problem()\nprint(result)\n</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¨¡å‹é€šè¿‡é€æ­¥è®¡ç®—ï¼Œæœ€ç»ˆå¾—å‡ºäº†æ­£ç¡®çš„ç­”æ¡ˆã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…èƒ½å¤Ÿè®©æ¨¡å‹æ›´å¥½åœ°ç†è§£é—®é¢˜ï¼Œè¿˜èƒ½é¿å…å› ä¸ºç›´æ¥æ¨ç†å¯¼è‡´çš„é”™è¯¯ã€‚</p><h3>é€»è¾‘æ¨ç†ä¸ä»»åŠ¡è§„åˆ’ä¸­çš„åº”ç”¨</h3><p>æ€ç»´é“¾ä¸ä»…é€‚ç”¨äºæ•°å­¦é—®é¢˜ï¼Œè¿˜å¯ä»¥å¹¿æ³›åº”ç”¨äºé€»è¾‘æ¨ç†ã€å¤æ‚é—®ç­”ã€ä»»åŠ¡è§„åˆ’ç­‰åœºæ™¯ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨ä»»åŠ¡è§„åˆ’ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å¯¼æ¨¡å‹é€æ­¥æ‹†è§£ä»»åŠ¡ï¼Œå¹¶æŒ‰ç…§é€»è¾‘é¡ºåºå®Œæˆæ¯ä¸€æ­¥ï¼Œä»è€Œä¿è¯ä»»åŠ¡çš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ec/e4/ec02d4e08157ddfb07aa9142a49516e4.png?wh=1575x885\" alt=\"å›¾ç‰‡\" title=\"Introducing OpenAI o1-preview\"></p><p>æ¯”å¦‚æˆ‘ä»¬çœ‹åˆ°çš„ GPT-4o1 ä¸­å¼ºå¤§çš„æ¨ç†èƒ½åŠ›ï¼Œå°±æ˜¯æ¥è‡ªäºæ€ç»´é“¾çš„èµ‹èƒ½ã€‚å®ƒç”šè‡³å·²ç»èƒ½åœ¨ä¿¡æ¯å­¦ç«èµ›ä¸­è¶…è¿‡äººç±»çš„è¡¨ç°ã€‚</p><h3>å¤æ‚æ€ç»´é“¾çš„å®é™…åº”ç”¨</h3><p>éšç€ç ”ç©¶çš„æ·±å…¥ï¼Œæ€ç»´é“¾æŠ€æœ¯å·²ç»ä»æœ€åˆçš„æç¤ºè¯­å·¥ç¨‹ï¼Œé€æ¸å‘å±•æˆäº†ä¸€ç§å¹¿æ³›çš„å¤šæ­¥éª¤æ¨ç†æ–¹æ³•ã€‚åœ¨æ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œæ€ç»´é“¾ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæç¤ºè¯­ï¼Œè€Œæ˜¯ä¸€ç§å¤šæ­¥éª¤æ¨ç†çš„å…¨æ–°æ–¹æ³•è®ºã€‚ä¾‹å¦‚ï¼Œåœ¨è·¨ä¼šè¯çš„å¤šæ­¥éª¤æ¨ç†ä¸­ï¼Œæ¨¡å‹éœ€è¦åœ¨å¤šä¸ªå¯¹è¯ä¸­é€æ­¥ç§¯ç´¯ä¿¡æ¯ï¼Œå¹¶åœ¨æœ€ç»ˆçš„ä¼šè¯ä¸­å¾—å‡ºç»¼åˆæ€§çš„ç»“è®ºã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå…¶ä¸­è®¾è®¡äº†ä¸€ç³»åˆ—ç²¾å·§çš„é—®é¢˜ï¼Œå¼•å¯¼æ¨¡å‹é€æ­¥æ¨ç†å¹¶æ•´åˆä¿¡æ¯ï¼š</p><pre><code class=\"language-python\">import ollama\n\ndef cross_session_reasoning(session_data):\n&nbsp; &nbsp; accumulated_info = \"\"\n&nbsp; &nbsp; for session in session_data:\n&nbsp; &nbsp; &nbsp; &nbsp; prompt = f\"Based on our previous discussions: {accumulated_info} {session['question']}\"\n&nbsp; &nbsp; &nbsp; &nbsp; response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; &nbsp; &nbsp; ])\n&nbsp; &nbsp; &nbsp; &nbsp; accumulated_info += response['content'] + \" \"\n\n&nbsp; &nbsp; final_prompt = f\"Now, let's summarize the conclusion based on all the steps we've discussed: {accumulated_info.strip()}\"\n&nbsp; &nbsp; final_response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': final_prompt},\n&nbsp; &nbsp; ])\n&nbsp; &nbsp; return final_response['content']\n\nsession_data = [\n&nbsp; &nbsp; {\"question\": \"What foundational concepts should we consider when addressing problem X?\"},\n&nbsp; &nbsp; {\"question\": \"Based on those concepts, what is the initial action we should take to approach problem X?\"},\n&nbsp; &nbsp; {\"question\": \"What factors should we evaluate after the initial action to determine its effectiveness?\"},\n&nbsp; &nbsp; {\"question\": \"Considering the evaluation results, what would be the next logical step?\"},\n&nbsp; &nbsp; {\"question\": \"What potential challenges might arise from this next step, and how can we mitigate them?\"},\n&nbsp; &nbsp; {\"question\": \"Finally, how can we integrate all these steps to formulate a comprehensive solution to problem X?\"}\n]\n\nresult = cross_session_reasoning(session_data)\nprint(result)\n</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¨¡å‹åœ¨å¤šä¸ªä¼šè¯ä¸­é€æ­¥ç§¯ç´¯ä¿¡æ¯ï¼Œæœ€ç»ˆå¾—å‡ºä¸€ä¸ªå…¨é¢çš„ç»“è®ºã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿç¡®ä¿å¤æ‚ä»»åŠ¡å¤„ç†çš„è¿è´¯æ€§å’Œå‡†ç¡®æ€§ã€‚</p><h2>çµæ´»æ€§ä¸å®‰å…¨æ€§çš„å¹³è¡¡</h2><p>åœ¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ï¼Œå¦‚ä½•å¹³è¡¡æ¨¡å‹çš„çµæ´»æ€§ä¸æ¨ç†è¿‡ç¨‹çš„å®‰å…¨æ€§ï¼Œæ˜¯ä¸€ä¸ªä¸å¯å¿½è§†çš„é‡è¦é—®é¢˜ã€‚éšç€ä»»åŠ¡æè¿°çš„å¤æ‚åŒ–ï¼Œå¦‚æœæ²¡æœ‰åˆé€‚çš„æ¨ç†ç­–ç•¥ï¼Œæ¨¡å‹å¯èƒ½ä¼šå¿½ç•¥é‡è¦ä¿¡æ¯ï¼Œå¯¼è‡´å‡ºç°å¹»è§‰ï¼Œæœ€ç»ˆå½±å“ä»»åŠ¡çš„å¤„ç†è´¨é‡ã€‚</p><h3>å•ä¸€èŒè´£åŸåˆ™ï¼šåˆ†è§£ä»»åŠ¡ï¼Œç¡®ä¿å¯æ§æ€§</h3><p>ä¸ºäº†åº”å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†â€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œè¿™ä¸€åŸåˆ™è¦æ±‚å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªç‹¬ç«‹çš„æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤åªè´Ÿè´£è§£å†³ç‰¹å®šçš„å­é—®é¢˜ã€‚é€šè¿‡æ˜ç¡®æ¯ä¸ªæ­¥éª¤çš„èŒè´£ï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨ï¼Œå‡å°‘é”™è¯¯çš„å‘ç”Ÿï¼Œå¹¶æé«˜æ•´ä½“ä»»åŠ¡çš„å¤„ç†è´¨é‡ã€‚</p><pre><code class=\"language-python\">import ollama\n\ndef decompose_task(task_description):\n&nbsp; &nbsp; # å‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªé€»è¾‘æ¥åˆ†è§£ä»»åŠ¡\n&nbsp; &nbsp; return [\n&nbsp; &nbsp; &nbsp; &nbsp; {\"role\": \"analyst\", \"description\": \"analyze the data\"},\n&nbsp; &nbsp; &nbsp; &nbsp; {\"role\": \"developer\", \"description\": \"write the code\"},\n&nbsp; &nbsp; &nbsp; &nbsp; # æ·»åŠ æ›´å¤šæ­¥éª¤...\n&nbsp; &nbsp; ]\n\ndef combine_results(results):\n&nbsp; &nbsp; # å‡è®¾è¿™é‡Œæœ‰é€»è¾‘æ¥ç»„åˆç»“æœ\n&nbsp; &nbsp; return \" \".join(results)\n\ndef task_decomposition(task_description):\n&nbsp; &nbsp; steps = decompose_task(task_description)\n&nbsp; &nbsp; results = []\n&nbsp; &nbsp; for step in steps:\n&nbsp; &nbsp; &nbsp; &nbsp; # æ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ˜ç¡®çš„èŒè´£å’Œçº¦æŸ\n&nbsp; &nbsp; &nbsp; &nbsp; prompt = f\"As a {step['role']}, let's solve the specific part: {step['description']}\"\n&nbsp; &nbsp; &nbsp; &nbsp; response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; &nbsp; &nbsp; ])\n&nbsp; &nbsp; &nbsp; &nbsp; results.append(response['content'])\n\n&nbsp; &nbsp; # ç»¼åˆæ‰€æœ‰æ­¥éª¤çš„ç»“æœï¼Œå¾—å‡ºæœ€ç»ˆç»“è®º\n&nbsp; &nbsp; final_result = combine_results(results)\n&nbsp; &nbsp; return final_result\n\ntask_description = \"Complex task involving multiple roles and responsibilities.\"\nresult = task_decomposition(task_description)\nprint(result)\n</code></pre><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä¸åŒçš„è§’è‰²è®¾å®šå¸®åŠ©æ¨¡å‹ä¸“æ³¨äºç‰¹å®šä»»åŠ¡ï¼Œä»è€Œæé«˜ä»»åŠ¡å¤„ç†çš„è´¨é‡å’Œå®‰å…¨æ€§ã€‚</p><h3>å®‰å…¨ç­–ç•¥ï¼šå¼•å…¥æ£€æŸ¥æœºåˆ¶</h3><p>ä¸ºäº†è¿›ä¸€æ­¥ç¡®ä¿ä»»åŠ¡å¤„ç†çš„å®‰å…¨æ€§ï¼Œæˆ‘ä»¬è¿˜å¼•å…¥äº†<strong>æ£€æŸ¥æœºåˆ¶</strong>ã€‚é€šè¿‡åœ¨æ¯ä¸€ä¸ªæ¨ç†æ­¥éª¤åæ·»åŠ æ£€æŸ¥æœºåˆ¶ï¼Œå¯ä»¥éªŒè¯æ¨¡å‹çš„è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚è¿™ä¸ä»…èƒ½å¤ŸåŠæ—¶å‘ç°å¹¶çº æ­£é”™è¯¯ï¼Œè¿˜èƒ½æé«˜æ¨¡å‹çš„æ•´ä½“æ¨ç†è´¨é‡ã€‚</p><pre><code class=\"language-python\">import ollama\n\ndef decompose_task(task_description):\n&nbsp; &nbsp; \"\"\"å°†ä»»åŠ¡æè¿°åˆ†è§£ä¸ºå¯æ“ä½œçš„æ­¥éª¤\"\"\"\n&nbsp; &nbsp; prompt = f\"è¯·å°†ä»¥ä¸‹ä»»åŠ¡åˆ†è§£ä¸ºå…·ä½“çš„å¯æ“ä½œæ­¥éª¤ï¼Œå¹¶ä»¥ç¼–å·çš„å½¢å¼åˆ—å‡ºæ¯ä¸ªæ­¥éª¤ï¼š{task_description}\"\n&nbsp; &nbsp; response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; ])\n&nbsp; &nbsp; steps = response['content'].strip().split('\\n') if response['content'] else []\n&nbsp; &nbsp; return steps\n\ndef check_result(response):\n&nbsp; &nbsp; \"\"\"éªŒè¯æ¨¡å‹è¾“å‡ºçš„åˆç†æ€§\"\"\"\n&nbsp; &nbsp; prompt = f\"ä»¥ä¸‹å“åº”æ˜¯å¦å­˜åœ¨å®‰å…¨éšæ‚£ï¼Ÿ{response} è¯·å›ç­”â€œæ˜¯â€æˆ–â€œå¦â€ã€‚\"\n&nbsp; &nbsp; validation_response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; ])\n&nbsp; &nbsp; return \"æ˜¯\" in validation_response['content']\n\ndef combine_results(results):\n&nbsp; &nbsp; \"\"\"ç»¼åˆæ‰€æœ‰æœ‰æ•ˆç»“æœ\"\"\"\n&nbsp; &nbsp; if not results:\n&nbsp; &nbsp; &nbsp; &nbsp; return \"æ²¡æœ‰æœ‰æ•ˆç»“æœå¯ä¾›æ€»ç»“ã€‚\"\n&nbsp; &nbsp; prompt = \"è¯·æ€»ç»“ä»¥ä¸‹ç»“æœï¼Œå¹¶ä»¥æ®µè½å½¢å¼å‘ˆç°ï¼š\" + \"; \".join(results)&nbsp; # ä½¿ç”¨åˆ†å·åˆ†éš”\n&nbsp; &nbsp; summary_response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; ])\n&nbsp; &nbsp; return summary_response['content']\n\ndef handle_error(step, response):\n&nbsp; &nbsp; \"\"\"å¤„ç†é”™è¯¯æƒ…å†µ\"\"\"\n&nbsp; &nbsp; print(f\"å¤„ç†æ­¥éª¤æ—¶å‡ºé”™ï¼š{step}ã€‚å“åº”ï¼š{response}\")&nbsp; # å¯ä»¥å¢åŠ æ›´è¯¦ç»†çš„é”™è¯¯å¤„ç†\n\ndef reasoning_with_checkpoints(task_description):\n&nbsp; &nbsp; \"\"\"å¤šæ­¥éª¤æ¨ç†ä¸­çš„æ£€æŸ¥æœºåˆ¶\"\"\"\n&nbsp; &nbsp; steps = decompose_task(task_description)&nbsp; # å°†ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤\n&nbsp; &nbsp; results = []\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; for step in steps:\n&nbsp; &nbsp; &nbsp; &nbsp; prompt = f\"è®©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼š{step.strip()} è¯·ä»¥æ¸…æ™°çš„æ­¥éª¤å½¢å¼å›ç­”ã€‚\"\n&nbsp; &nbsp; &nbsp; &nbsp; response = ollama.chat(model='llama3', messages=[\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {'role': 'user', 'content': prompt},\n&nbsp; &nbsp; &nbsp; &nbsp; ])['content']&nbsp; # ç”Ÿæˆæ¨¡å‹å“åº”\n\n&nbsp; &nbsp; &nbsp; &nbsp; # æ£€æŸ¥è¾“å‡ºæœ‰æ•ˆæ€§\n&nbsp; &nbsp; &nbsp; &nbsp; if check_result(response):\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; results.append(response)\n&nbsp; &nbsp; &nbsp; &nbsp; else:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; handle_error(step, response)&nbsp; # å¤„ç†é”™è¯¯æƒ…å†µ\n\n&nbsp; &nbsp; return combine_results(results)&nbsp; # è¿”å›ç»¼åˆç»“æœ\n\ntask_description = \"\"\"\næŠŠå¤§è±¡æ”¾å…¥å†°ç®±\n\"\"\"\nresult = reasoning_with_checkpoints(task_description)\nprint(result)\n</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ£€æŸ¥æœºåˆ¶ç¡®ä¿æ¯ä¸ªæ¨ç†æ­¥éª¤éƒ½ç¬¦åˆé¢„æœŸï¼Œä»è€Œæé«˜æ•´ä½“ä»»åŠ¡çš„å®‰å…¨æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e8/55/e84e2ea7c021bcc69c8d043c45fcff55.png?wh=1887x1060\" alt=\"å›¾ç‰‡\"></p><p>è¿›ä¸€æ­¥æ¥è¯´ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºçš„ä¸€è‡´æ€§æ£€æµ‹ç®—æ³•æ˜¯ä¸€ç§æ›´ä¸ºé«˜çº§çš„æ£€æµ‹æ–¹æ³•ã€‚å®ƒé€šè¿‡æ•´åˆå¤šæ¡æ¨ç†é“¾çš„è¿”å›ç»“æœï¼Œç»¼åˆè¯„ä¼°åé€‰å‡ºæœ€ä¼˜ç­–ç•¥ï¼Œä»è€Œæé«˜æ£€æµ‹çš„å‡†ç¡®æ€§å’Œå¯é æ€§ã€‚</p><h2>ä¸ºä»€ä¹ˆLLaMAæ¨¡å‹é€‚åˆåšæ€ç»´é“¾ï¼Ÿ</h2><p>LLaMAæ¨¡å‹åœ¨æ€ç»´é“¾æ¨ç†ä¸­çš„å‡ºè‰²è¡¨ç°ï¼Œä¸»è¦å¾—ç›Šäºå…¶åœ¨æŒ‡ä»¤å¾®è°ƒå’Œæ¨¡å‹æ¶Œç°èƒ½åŠ›æ–¹é¢çš„ä¼˜åŒ–ã€‚</p><p>æŒ‡ä»¤å¾®è°ƒçš„ä¼˜åŠ¿ï¼šLLaMA 3æ¨¡å‹é€šè¿‡å¤§é‡çš„æŒ‡ä»¤å¾®è°ƒæ•°æ®è¿›è¡Œäº†è®­ç»ƒã€‚è¿™äº›æ•°æ®ä¸ä»…åŒ…å«ä¼ ç»Ÿçš„é—®ç­”å’Œå¯¹è¯ä»»åŠ¡ï¼Œè¿˜åŒ…æ‹¬å¤æ‚æ¨ç†ä»»åŠ¡ã€‚åœ¨è¿™äº›ä»»åŠ¡ä¸­ï¼Œæ¨¡å‹ä¸ä»…è¦ç»™å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œè¿˜éœ€è¦è§£é‡Šæ¯ä¸€ä¸ªæ¨ç†æ­¥éª¤ã€‚è¿™ç§è®­ç»ƒæ–¹å¼è®©LLaMA 3åœ¨å¤„ç†å¤šæ­¥æ¨ç†ä»»åŠ¡æ—¶è¡¨ç°å¾—å°¤ä¸ºå‡ºè‰²ã€‚</p><p>æ¨¡å‹çš„æ¶Œç°èƒ½åŠ›ï¼šæ¶Œç°èƒ½åŠ›æ˜¯æŒ‡éšç€æ¨¡å‹è§„æ¨¡å’Œæ•°æ®é‡çš„å¢åŠ ï¼Œæ¨¡å‹è‡ªå‘äº§ç”Ÿçš„ä¸€äº›æ–°èƒ½åŠ›ã€‚è¿™äº›èƒ½åŠ›å¹¶æ²¡æœ‰è¢«æ˜ç¡®ç¼–ç æˆ–è®¾è®¡å‡ºæ¥ï¼Œè€Œæ˜¯åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªç„¶æ¶Œç°çš„ã€‚å¯¹äºæ€ç»´é“¾æ¥è¯´ï¼ŒLLaMA 3èƒ½å¤Ÿè‡ªå‘åœ°è¿›è¡Œæ›´å¤æ‚çš„é€»è¾‘æ¨ç†å’Œä»»åŠ¡è§„åˆ’ï¼Œç”šè‡³åœ¨æ²¡æœ‰æ˜ç¡®æç¤ºçš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å±•ç°å‡ºè‰¯å¥½çš„æ¨ç†èƒ½åŠ›ã€‚</p><p>ä»£ç æ•°æ®çš„è´¡çŒ®ï¼šLLaMA 3åœ¨è®­ç»ƒæ•°æ®ä¸­åŒ…å«äº†å¤§é‡çš„ä»£ç æ•°æ®ã€‚è¿™ä½¿å¾—æ¨¡å‹åœ¨æ¨ç†å’Œè§„åˆ’ä»»åŠ¡ä¸­å…·æœ‰æ›´å¼ºçš„ç»“æ„åŒ–æ€ç»´èƒ½åŠ›ã€‚ä»£ç æ•°æ®çš„é€»è¾‘æ€§å’Œä¸¥æ ¼çš„è¯­æ³•è§„åˆ™ï¼Œè®©æ¨¡å‹åœ¨æ¨ç†æ—¶èƒ½å¤Ÿæ›´å¥½åœ°éµå¾ªé€»è¾‘æ­¥éª¤ï¼Œé¿å…æ— åºæ¨ç†ã€‚</p><h2>å°ç»“</h2><p>åœ¨ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†æ™ºèƒ½ä½“å·¥å…·ä½¿ç”¨çš„æœ¬è´¨ï¼Œå³æŒ‡ä»¤è·Ÿéšèƒ½åŠ›ã€‚æœ¬èŠ‚è¯¾çš„é‡ç‚¹åˆ™æ˜¯æ·±å…¥è®¨è®ºæ™ºèƒ½ä½“çš„â€œæ€è€ƒâ€èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯è·¨ä¼šè¯çš„å¤šæ­¥æ¨ç†ã€‚é€šè¿‡å¯¹æ€ç»´é“¾çš„æ·±å…¥æ¢è®¨ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼Œè¿™é¡¹æŠ€æœ¯ä¸ä»…æå‡äº†æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œè¿˜å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£å’Œå¤„ç†å¤æ‚ä»»åŠ¡ã€‚</p><p>åœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬æ¢³ç†äº†ä»æ€ç»´é“¾åˆ°å¤šæ­¥æ¨ç†ï¼Œå†åˆ°è·¨ä¼šè¯æ¨ç†åŠæ™ºèƒ½ä½“å‘å±•çš„æŠ€æœ¯è„‰ç»œï¼Œè¿™æ˜¯ä¸“æ å¯¹æ™ºèƒ½ä½“æŠ€æœ¯â€œç¥›é­…â€çš„ç¬¬äºŒæ­¥ã€‚æˆ‘ä»¬é€šè¿‡é€æ­¥å‰–æï¼Œæ˜ç¡®äº†å®ç°æ™ºèƒ½ä½“é«˜æ•ˆã€å‡†ç¡®ä»»åŠ¡æ‰§è¡Œçš„å…³é”®â€”â€”è·¨ä¼šè¯çš„å¤šæ­¥æ¨ç†èƒ½åŠ›ã€‚</p><p>æœªæ¥ï¼Œéšç€æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ï¼Œæ€ç»´é“¾å°†æˆä¸ºæ™ºèƒ½ä½“ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œä¸ºè§£å†³æ›´å¤æ‚çš„ä»»åŠ¡æä¾›å¼ºæœ‰åŠ›çš„æ”¯æŒã€‚è¿™èŠ‚è¯¾çš„å†…å®¹ä¹Ÿå°†æˆä¸ºæ™ºèƒ½ä½“çŠ¶æ€æœºè®¾è®¡çš„é‡è¦å‰åºçŸ¥è¯†ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘å°†è¯¦ç»†è®²è§£æ€ç»´é“¾åœ¨æ™ºèƒ½ä½“æ¶æ„è®¾è®¡ä¸­çš„å®é™…åº”ç”¨ï¼Œå¸¦ä½ äº†è§£å¦‚ä½•å°†è¿™é¡¹æŠ€æœ¯é›†æˆåˆ°æ™ºèƒ½ä½“ä¸­ï¼Œä»è€Œå¢å¼ºå…¶é€»è¾‘æ¨ç†èƒ½åŠ›ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>GPT-4o1 çš„èƒ½åŠ›å’Œæ€ç»´é“¾ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿæ¬¢è¿ä½ æŠŠæ€è€ƒåçš„ç»“æœåˆ†äº«åˆ°ç•™è¨€åŒºï¼Œå’Œæˆ‘ä¸€èµ·è®¨è®ºï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿ä½ åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"03ï½œLLaMA 3çš„åº”ç”¨æ¢ç´¢ï¼šæŒ‡ä»¤è·Ÿéšçš„æœ€ä½³å®è·µ","id":816759},"right":{"article_title":"05ï½œLLaMA 3å¦‚ä½•é€šè¿‡æç¤ºè¯è·å¾—ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›ï¼Ÿ","id":818359}},"comments":[{"had_liked":false,"id":395935,"user_name":"å°è™å­ğŸ¯","can_delete":false,"product_type":"c1","uid":2843479,"ip_address":"åŒ—äº¬","ucode":"4C9530B3FB407B","user_header":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","comment_is_top":true,"comment_ctime":1732500636,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100828301,"comment_content":"è¯¾ç¨‹ä»£ç åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;tylerelyt&#47;LLaMa-in-Action","like_count":0},{"had_liked":false,"id":395177,"user_name":"å…µæˆˆ","can_delete":false,"product_type":"c1","uid":1017595,"ip_address":"åŒ—äº¬","ucode":"0F1723EBCE1BC0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/86/fb/4add1a52.jpg","comment_is_top":false,"comment_ctime":1729664537,"is_pvip":false,"replies":[{"id":143536,"content":"ä½ å¥½ï¼Œå…µæˆˆï¼ä»£ç å·² mergeï¼Œæ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼ä¹Ÿæ¬¢è¿æ›´å¤šåŒå­¦å…±å»º GitHub repo åœ¨ç»ƒä¹ ä¸­å­¦ä¹ ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1002568,"ctime":1730470034,"ip_address":"åŒ—äº¬","comment_id":395177,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100828301,"comment_content":"Tylerè€å¸ˆï¼Œå­¦å®Œäº†æ‚¨ã€ŠLLaMA 3 å‰æ²¿æ¨¡å‹å®æˆ˜è¯¾ã€‹çš„ç¬¬4è¯¾ï¼Œå¹¶è·‘é€šäº†å…¶ä¸­çš„ç›¸å…³æ¡ˆä¾‹ä»£ç ã€‚\n\nä½†æˆ‘çœ‹å½“å‰å·¥ç¨‹ä¸­è¿˜ä¸€ç›´æ²¡æœ‰ç¬¬4è¯¾çš„å·¥ç¨‹ä»£ç ï¼Œäºæ˜¯æˆ‘æäº¤PRï¼šhttps:&#47;&#47;github.com&#47;tylerelyt&#47;llama&#47;pull&#47;2\n\næ‚¨çœ‹çœ‹æ˜¯å¦éœ€è¦ï¼Œå¯ä»¥Mergeè¿›æ¥ï¼Œæˆ–è€…ç›´æ¥ä¸Šä¼ æ‚¨é‚£è¾¹çš„å·¥ç¨‹ä»£ç ï¼š\n\nå¯¹åº”è¯¾ç¨‹ä»£ç ï¼Œæœ‰äº›åœ°æ–¹ç¨ä½œä¿®æ”¹ï¼Œä½¿å¾—èƒ½è¿è¡ŒæˆåŠŸæˆ–è€…æ›´é¡ºç•…ï¼š\n\n# 1ã€ä¿®æ”¹æ‰€æœ‰exampleä¸­ response çš„è·å–æ–¹å¼\nresponse[&#39;content&#39;] -&gt; response[&#39;message&#39;][&#39;content&#39;]\n\n# 2ã€example4 ä¸­æ·»åŠ stepåˆ¤æ–­ï¼Œå‡å°‘å¾ªç¯æ¬¡æ•°\nif step == &#39;&#39;:\n    continue","like_count":3,"discussions":[{"author":{"id":1002568,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4c/48/99de2a2b.jpg","nickname":"Tyler","note":"","ucode":"A657DD2FBAF31D","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653245,"discussion_content":"ä½ å¥½ï¼Œå…µæˆˆï¼ä»£ç å·² mergeï¼Œæ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼ä¹Ÿæ¬¢è¿æ›´å¤šåŒå­¦å…±å»º GitHub repo åœ¨ç»ƒä¹ ä¸­å­¦ä¹ ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1730470034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}