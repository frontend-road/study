{"id":73151,"title":"12 | 套路篇：CPU 性能优化的几个思路","content":"<p>你好，我是倪朋飞。</p><p>上一节我们一起回顾了常见的 CPU 性能指标，梳理了核心的 CPU 性能观测工具，最后还总结了快速分析 CPU 性能问题的思路。虽然 CPU 的性能指标很多，相应的性能分析工具也很多，但理解了各种指标的含义后，你就会发现它们其实都有一定的关联。</p><p>顺着这些关系往下理解，你就会发现，掌握这些常用的瓶颈分析套路，其实并不难。</p><p>在找到 CPU 的性能瓶颈后，下一步要做的就是优化了，也就是找出充分利用CPU的方法，以便完成更多的工作。</p><p>今天，我就来说说，优化 CPU 性能问题的思路和注意事项。</p><h2>性能优化方法论</h2><p>在我们历经千辛万苦，通过各种性能分析方法，终于找到引发性能问题的瓶颈后，是不是立刻就要开始优化了呢？别急，动手之前，你可以先看看下面这三个问题。</p><ul>\n<li>\n<p>首先，既然要做性能优化，那要怎么判断它是不是有效呢？特别是优化后，到底能提升多少性能呢？</p>\n</li>\n<li>\n<p>第二，性能问题通常不是独立的，如果有多个性能问题同时发生，你应该先优化哪一个呢？</p>\n</li>\n<li>\n<p>第三，提升性能的方法并不是唯一的，当有多种方法可以选择时，你会选用哪一种呢？是不是总选那个最大程度提升性能的方法就行了呢？</p>\n</li>\n</ul><p>如果你可以轻松回答这三个问题，那么二话不说就可以开始优化。</p><p>比如，在前面的不可中断进程案例中，通过性能分析，我们发现是因为一个进程的<strong>直接 I/O</strong>  ，导致了 iowait 高达 90%。那是不是用“<strong>直接 I/O 换成缓存 I/O</strong>”的方法，就可以立即优化了呢？</p><!-- [[[read_end]]] --><p>按照上面讲的，你可以先自己思考下那三点。如果不能确定，我们一起来看看。</p><ul>\n<li>\n<p>第一个问题，直接 I/O 换成缓存 I/O，可以把 iowait 从 90% 降到接近 0，性能提升很明显。</p>\n</li>\n<li>\n<p>第二个问题，我们没有发现其他性能问题，直接 I/O 是唯一的性能瓶颈，所以不用挑选优化对象。</p>\n</li>\n<li>\n<p>第三个问题，缓存 I/O 是我们目前用到的最简单的优化方法，而且这样优化并不会影响应用的功能。</p>\n</li>\n</ul><p>好的，这三个问题很容易就能回答，所以立即优化没有任何问题。</p><p>但是，很多现实情况，并不像我举的例子那么简单。性能评估可能有多重指标，性能问题可能会多个同时发生，而且，优化某一个指标的性能，可能又导致其他指标性能的下降。</p><p>那么，面对这种复杂的情况，我们该怎么办呢？</p><p>接下来，我们就来深入分析这三个问题。</p><h3>怎么评估性能优化的效果？</h3><p>首先，来看第一个问题，怎么评估性能优化的效果。</p><p>我们解决性能问题的目的，自然是想得到一个性能提升的效果。为了评估这个效果，我们需要对系统的性能指标进行量化，并且要分别测试出优化前、后的性能指标，用前后指标的变化来对比呈现效果。我把这个方法叫做性能评估“三步走”。</p><ol>\n<li>\n<p>确定性能的量化指标。</p>\n</li>\n<li>\n<p>测试优化前的性能指标。</p>\n</li>\n<li>\n<p>测试优化后的性能指标。</p>\n</li>\n</ol><p>先看第一步，性能的量化指标有很多，比如 CPU 使用率、应用程序的吞吐量、客户端请求的延迟等，都可以评估性能。那我们应该选择什么指标来评估呢？</p><p>我的建议是<strong>不要局限在单一维度的指标上</strong>，你至少要从应用程序和系统资源这两个维度，分别选择不同的指标。比如，以 Web 应用为例：</p><ul>\n<li>\n<p>应用程序的维度，我们可以用<strong>吞吐量和请求延迟</strong>来评估应用程序的性能。</p>\n</li>\n<li>\n<p>系统资源的维度，我们可以用 <strong>CPU 使用率</strong>来评估系统的 CPU 使用情况。</p>\n</li>\n</ul><p>之所以从这两个不同维度选择指标，主要是因为应用程序和系统资源这两者间相辅相成的关系。</p><ul>\n<li>\n<p>好的应用程序是性能优化的最终目的和结果，系统优化总是为应用程序服务的。所以，必须要使用应用程序的指标，来评估性能优化的整体效果。</p>\n</li>\n<li>\n<p>系统资源的使用情况是影响应用程序性能的根源。所以，需要用系统资源的指标，来观察和分析瓶颈的来源。</p>\n</li>\n</ul><p>至于接下来的两个步骤，主要是为了对比优化前后的性能，更直观地呈现效果。如果你的第一步，是从两个不同维度选择了多个指标，那么在性能测试时，你就需要获得这些指标的具体数值。</p><p>还是以刚刚的 Web 应用为例，对应上面提到的几个指标，我们可以选择 ab 等工具，测试 Web 应用的并发请求数和响应延迟。而测试的同时，还可以用 vmstat、pidstat 等性能工具，观察系统和进程的 CPU 使用率。这样，我们就同时获得了应用程序和系统资源这两个维度的指标数值。</p><p>不过，在进行性能测试时，有两个特别重要的地方你需要注意下。</p><p>第一，要避免性能测试工具干扰应用程序的性能。通常，对 Web 应用来说，性能测试工具跟目标应用程序要在不同的机器上运行。</p><p>比如，在之前的 Nginx 案例中，我每次都会强调要用两台虚拟机，其中一台运行 Nginx 服务，而另一台运行模拟客户端的工具，就是为了避免这个影响。</p><p>第二，避免外部环境的变化影响性能指标的评估。这要求优化前、后的应用程序，都运行在相同配置的机器上，并且它们的外部依赖也要完全一致。</p><p>比如还是拿 Nginx 来说，就可以运行在同一台机器上，并用相同参数的客户端工具来进行性能测试。</p><h3>多个性能问题同时存在，要怎么选择？</h3><p>再来看第二个问题，开篇词里我们就说过，系统性能总是牵一发而动全身，所以性能问题通常也不是独立存在的。那当多个性能问题同时发生的时候，应该先去优化哪一个呢？</p><p>在性能测试的领域，流传很广的一个说法是“二八原则”，也就是说 80% 的问题都是由 20% 的代码导致的。只要找出这 20% 的位置，你就可以优化 80% 的性能。所以，我想表达的是，<strong>并不是所有的性能问题都值得优化</strong>。</p><p>我的建议是，动手优化之前先动脑，先把所有这些性能问题给分析一遍，找出最重要的、可以最大程度提升性能的问题，从它开始优化。这样的好处是，不仅性能提升的收益最大，而且很可能其他问题都不用优化，就已经满足了性能要求。</p><p>那关键就在于，怎么判断出哪个性能问题最重要。这其实还是我们性能分析要解决的核心问题，只不过这里要分析的对象，从原来的一个问题，变成了多个问题，思路其实还是一样的。</p><p>所以，你依然可以用我前面讲过的方法挨个分析，分别找出它们的瓶颈。分析完所有问题后，再按照因果等关系，排除掉有因果关联的性能问题。最后，再对剩下的性能问题进行优化。</p><p>如果剩下的问题还是好几个，你就得分别进行性能测试了。比较不同的优化效果后，选择能明显提升性能的那个问题进行修复。这个过程通常会花费较多的时间，这里，我推荐两个可以简化这个过程的方法。</p><p>第一，如果发现是系统资源达到了瓶颈，比如 CPU 使用率达到了 100%，那么首先优化的一定是系统资源使用问题。完成系统资源瓶颈的优化后，我们才要考虑其他问题。</p><p>第二，针对不同类型的指标，首先去优化那些由瓶颈导致的，性能指标变化幅度最大的问题。比如产生瓶颈后，用户 CPU 使用率升高了 10%，而系统 CPU 使用率却升高了 50%，这个时候就应该首先优化系统 CPU 的使用。</p><h3>有多种优化方法时，要如何选择?</h3><p>接着来看第三个问题，当多种方法都可用时，应该选择哪一种呢？是不是最大提升性能的方法，一定最好呢？</p><p>一般情况下，我们当然想选能最大提升性能的方法，这其实也是性能优化的目标。</p><p>但要注意，现实情况要考虑的因素却没那么简单。最直观来说，<strong>性能优化并非没有成本</strong>。性能优化通常会带来复杂度的提升，降低程序的可维护性，还可能在优化一个指标时，引发其他指标的异常。也就是说，很可能你优化了一个指标，另一个指标的性能却变差了。</p><p>一个很典型的例子是我将在网络部分讲到的 DPDK（Data Plane Development Kit）。DPDK 是一种优化网络处理速度的方法，它通过绕开内核网络协议栈的方法，提升网络的处理能力。</p><p>不过它有一个很典型的要求，就是要独占一个 CPU 以及一定数量的内存大页，并且总是以 100% 的 CPU 使用率运行。所以，如果你的 CPU 核数很少，就有点得不偿失了。</p><p>所以，在考虑选哪个性能优化方法时，你要综合多方面的因素。切记，不要想着“一步登天”，试图一次性解决所有问题；也不要只会“拿来主义”，把其他应用的优化方法原封不动拿来用，却不经过任何思考和分析。</p><h2>CPU 优化</h2><p>清楚了性能优化最基本的三个问题后，我们接下来从应用程序和系统的角度，分别来看看如何才能降低 CPU 使用率，提高 CPU 的并行处理能力。</p><h3>应用程序优化</h3><p>首先，从应用程序的角度来说，降低 CPU 使用率的最好方法当然是，排除所有不必要的工作，只保留最核心的逻辑。比如减少循环的层次、减少递归、减少动态内存分配等等。</p><p>除此之外，应用程序的性能优化也包括很多种方法，我在这里列出了最常见的几种，你可以记下来。</p><ul>\n<li>\n<p><strong>编译器优化</strong>：很多编译器都会提供优化选项，适当开启它们，在编译阶段你就可以获得编译器的帮助，来提升性能。比如， gcc 就提供了优化选项 -O2，开启后会自动对应用程序的代码进行优化。</p>\n</li>\n<li>\n<p><strong>算法优化</strong>：使用复杂度更低的算法，可以显著加快处理速度。比如，在数据比较大的情况下，可以用 O(nlogn) 的排序算法（如快排、归并排序等），代替 O(n^2) 的排序算法（如冒泡、插入排序等）。</p>\n</li>\n<li>\n<p><strong>异步处理</strong>：使用异步处理，可以避免程序因为等待某个资源而一直阻塞，从而提升程序的并发处理能力。比如，把轮询替换为事件通知，就可以避免轮询耗费 CPU 的问题。</p>\n</li>\n<li>\n<p><strong>多线程代替多进程</strong>：前面讲过，相对于进程的上下文切换，线程的上下文切换并不切换进程地址空间，因此可以降低上下文切换的成本。</p>\n</li>\n<li>\n<p><strong>善用缓存</strong>：经常访问的数据或者计算过程中的步骤，可以放到内存中缓存起来，这样在下次用时就能直接从内存中获取，加快程序的处理速度。</p>\n</li>\n</ul><h3>系统优化</h3><p>从系统的角度来说，优化 CPU 的运行，一方面要充分利用 CPU 缓存的本地性，加速缓存访问；另一方面，就是要控制进程的 CPU 使用情况，减少进程间的相互影响。</p><p>具体来说，系统层面的 CPU 优化方法也有不少，这里我同样列举了最常见的一些方法，方便你记忆和使用。</p><ul>\n<li>\n<p><strong>CPU 绑定</strong>：把进程绑定到一个或者多个 CPU 上，可以提高 CPU 缓存的命中率，减少跨 CPU 调度带来的上下文切换问题。</p>\n</li>\n<li>\n<p><strong>CPU 独占</strong>：跟 CPU 绑定类似，进一步将 CPU 分组，并通过 CPU 亲和性机制为其分配进程。这样，这些 CPU 就由指定的进程独占，换句话说，不允许其他进程再来使用这些CPU。</p>\n</li>\n<li>\n<p><strong>优先级调整</strong>：使用 nice 调整进程的优先级，正值调低优先级，负值调高优先级。优先级的数值含义前面我们提到过，忘了的话及时复习一下。在这里，适当降低非核心应用的优先级，增高核心应用的优先级，可以确保核心应用得到优先处理。</p>\n</li>\n<li>\n<p><strong>为进程设置资源限制</strong>：使用 Linux cgroups  来设置进程的 CPU 使用上限，可以防止由于某个应用自身的问题，而耗尽系统资源。</p>\n</li>\n<li>\n<p><strong>NUMA（Non-Uniform Memory Access）优化</strong>：支持 NUMA 的处理器会被划分为多个 node，每个 node 都有自己的本地内存空间。NUMA 优化，其实就是让 CPU 尽可能只访问本地内存。</p>\n</li>\n<li>\n<p><strong>中断负载均衡</strong>：无论是软中断还是硬中断，它们的中断处理程序都可能会耗费大量的CPU。开启 irqbalance 服务或者配置 smp_affinity，就可以把中断处理过程自动负载均衡到多个 CPU 上。</p>\n</li>\n</ul><h2>千万避免过早优化</h2><p>掌握上面这些优化方法后，我估计，很多人即使没发现性能瓶颈，也会忍不住把各种各样的优化方法带到实际的开发中。</p><p>不过，我想你一定听说过高德纳的这句名言， “过早优化是万恶之源”，我也非常赞同这一点，过早优化不可取。</p><p>因为，一方面，优化会带来复杂性的提升，降低可维护性；另一方面，需求不是一成不变的。针对当前情况进行的优化，很可能并不适应快速变化的新需求。这样，在新需求出现时，这些复杂的优化，反而可能阻碍新功能的开发。</p><p>所以，性能优化最好是逐步完善，动态进行，不追求一步到位，而要首先保证能满足当前的性能要求。当发现性能不满足要求或者出现性能瓶颈时，再根据性能评估的结果，选择最重要的性能问题进行优化。</p><h2>总结</h2><p>今天，我带你梳理了常见的 CPU 性能优化思路和优化方法。发现性能问题后，不要急于动手优化，而要先找出最重要的、可以获得最大性能提升的问题，然后再从应用程序和系统两个方面入手优化。</p><p>这样不仅可以获得最大的性能提升，而且很可能不需要优化其他问题，就已经满足了性能要求。</p><p>但是记住，一定要忍住“把 CPU 性能优化到极致”的冲动，因为 CPU 并不是唯一的性能因素。在后续的文章中，我还会介绍更多的性能问题，比如内存、网络、I/O 甚至是架构设计的问题。</p><p>如果不做全方位的分析和测试，只是单纯地把某个指标提升到极致，并不一定能带来整体的收益。</p><h2>思考</h2><p>由于篇幅的限制，我在这里只列举了几个最常见的 CPU 性能优化方法。除了这些，还有很多其他应用程序，或者系统资源角度的性能优化方法。我想请你一起来聊聊，你还知道哪些其他优化方法呢？</p><p>欢迎在留言区跟我讨论，也欢迎你把这篇文章分享给你的同事、朋友。我们一起在实战中演练，在交流中进步。</p><p></p>","comments":[{"had_liked":false,"id":50498,"user_name":"每天晒白牙","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1545001915,"is_pvip":false,"replies":[{"id":"18499","content":"👍","user_name":"作者回复","comment_id":50498,"uid":"1001282","ip_address":"","utype":1,"ctime":1545145537,"user_name_real":"倪朋飞"}],"discussion_count":3,"race_medal":1,"score":"177638661051","product_id":100020901,"comment_content":"【D12打卡】<br>CPU性能优化思路<br>方法论<br>1.性能优化的效果判断<br>三步走理论<br>(1)确定性能的量化指标－一般从应用程序纬度和系统资源纬度分析<br>(2)测试优化前的性能指标<br>(3)测试性能优化后的性能指标<br>2.当性能问题有多个时，优先级问题<br>先优化最重要的且最大程度提升性能的问题开始优化<br>3.优化方法有多个时，该如何选<br>综合多方面因素<br>CPU优化<br>应用程序优化:排除不必要工作，只留核心逻辑<br>1.减少循环次数  减少递归  减少动态没错分配<br>2.编译器优化<br>3.算法优化<br>4.异步处理<br>5.多线程代替多进程<br>6.缓存<br>系统优化:利用CPU缓存本地性，加速缓存访问;控制进程的cpu使用情况，减少程序的处理速度<br>1.CPU绑定<br>2.CPU独占<br>3.优先级调整<br>4.为进程设置资源限制<br>5.NUMA优化<br>6.中断负载均衡<br>很重要的一点:切记过早优化<br><br>","like_count":42,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433001,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1275659,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoTtHIemT3d7oOuDoU5dOGQeUzxTvcLPeD2qPS48ib5hlKq3ne650o5GVc2N5ia5uo4WOEnzmcNAZGQ/132","nickname":"刘青松","note":"","ucode":"65759A01ECD48C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370689,"discussion_content":"请问说的怎么多到底是怎么优化呢，光是概念，这根本无从下手","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619510132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1916685,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg","nickname":"怀揣梦想的学渣","note":"","ucode":"2349B9F4F6FDE3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211550,"discussion_content":"切忌过早优化，感谢分享笔记","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584864315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50478,"user_name":"十三","can_delete":false,"product_type":"c1","uid":1196791,"ip_address":"","ucode":"D3EFE8729DDE8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/42/f7/9dce9a7b.jpg","comment_is_top":false,"comment_ctime":1544977631,"is_pvip":false,"replies":[{"id":"18504","content":"😊","user_name":"作者回复","comment_id":50478,"uid":"1001282","ip_address":"","utype":1,"ctime":1545146052,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"70264454367","product_id":100020901,"comment_content":"又一篇精华满满的惊喜！<br>看到有人说，这些东西应该自己总结。是的，没错，很赞同。我也把用到的所有工具、指标、思路总结了一遍，但是看到老师给出了更全面系统的总结，仍然很受用。因为老师能从原理、关联多个角度给出更全面的知识网，也会指出一些易错的地方，是我们通学一遍、自己总结一遍以后的升华。起码，有些地方，因为原理知道的不多，我想错了或者漏了，看到这篇后，豁然开朗<br>老师给总结了，不等于你就会了，该学还得学，该记还得记，就像是满满的金子堆你面前，要不要弯腰去捡😊","like_count":16,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432992,"discussion_content":"😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545146052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50723,"user_name":"我来也","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1545035098,"is_pvip":false,"replies":[{"id":"18479","content":"总结的真棒，也谢谢分享你的经历","user_name":"作者回复","comment_id":50723,"uid":"1001282","ip_address":"","utype":1,"ctime":1545144887,"user_name_real":"倪朋飞"}],"discussion_count":4,"race_medal":0,"score":"44494708058","product_id":100020901,"comment_content":"[D12打卡]<br>这些常见的性能优化方法,之前都了解的不全面,待其他大神给我们开开眼界.<br>我以前优化大多都是感性的,就是凭感觉或经验,并没有些实际的指标来观测.<br>一方面自己只是做开发,管好自己的程序即可,其他方便(比如系统环境)可能是有心无力.<br>-------------------------<br>&quot;过早优化是万恶之源&quot;<br>我也是很赞同的,用户没几个,花那么多精力做过度优化没必要,还不如拿那些时间来学学专栏.等真的有一定规模和趋势了,再用&quot;二八原则&quot;有针对性的优化.<br>我个人一般在写代码时,会在可以进一步优化的地方加个注释,暂时先在够用的情况下,怎么简单怎么来,后期如果有必要了,再来找这些注释,看什么地方值得优化.<br>-------------------------<br>应用程序优化方面,可以谈谈我的经历:<br>编译器优化: 刚参加工作时,培训期间练习一些算法,会对比每个人程序的性能. 我当时还是用的VC6.0++. 而有的同学用dev-c++编译器, 结果成绩经常被吊打. 即使是同一份源码,编译出来的程序也是有很大的差距.<br>算法优化: 正在学算法专栏. 也是要根据实际情况来优化, 利用二八原则,有针对性的优化,不要什么都优化,一天才执行一次的程序, 耗时1s 和0.001s的差距并不大. 虽然数字上相差了很多倍.<br>异步优化: 比如lua的协程,epoll代替原来的select和poll.<br>多线程代替多进程: 线程的切换理论上是比进程切换的成本低. 但有时候考虑到扩展性,还会从单进程改为多进程模型.<br>善用缓存:也可利用二八原则, 看值不值得. 是用空间换时间,还是时间换空间.<br>------------------<br>做优化,真的是要见机行事,像老师说的,[不要只会“拿来主义”]","like_count":10,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433074,"discussion_content":"总结的真棒，也谢谢分享你的经历","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545144887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1142316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","nickname":"注意力$","note":"","ucode":"7FB3399A1EAB72","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":279451,"discussion_content":"您好，多线程代替多进程 您这里的扩展性是指什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591347321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"我来也","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1142316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","nickname":"注意力$","note":"","ucode":"7FB3399A1EAB72","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":279498,"discussion_content":"“多线程代替多进程: 线程的切换理论上是比进程切换的成本低. 但有时候考虑到扩展性,还会从单进程改为多进程模型.”\n\n如果单进程是一个大单体应用。\n那么，换成多进程模型后，其中的某些功能进程就可以方便的横向扩展。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591357162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":279451,"ip_address":""},"score":279498,"extra":""},{"author":{"id":1142316,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/2c/e2f3cfc0.jpg","nickname":"注意力$","note":"","ucode":"7FB3399A1EAB72","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"我来也","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280627,"discussion_content":"谢谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591579988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":279498,"ip_address":""},"score":280627,"extra":""}]}]},{"had_liked":false,"id":60788,"user_name":"南宫轩诺","can_delete":false,"product_type":"c1","uid":1364939,"ip_address":"","ucode":"4A62D2895DA857","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJVwuRvAuze6NsLGr4qwVa7IJcib3YdQVqlicuEicP8FmGR2qo8Wia1BXtnnbVeDxH41EkLmOmNiac5nQQ/132","comment_is_top":false,"comment_ctime":1547552107,"is_pvip":false,"replies":[{"id":"22310","content":"I&#47;O 模块有讲解的","user_name":"作者回复","comment_id":60788,"uid":"1001282","ip_address":"","utype":1,"ctime":1548249206,"user_name_real":"倪朋飞"}],"discussion_count":2,"race_medal":0,"score":"18727421291","product_id":100020901,"comment_content":"倪老师，请教您一个问题：最近在开发服务端，遇到一个问题,客户端开启单线程批量向不断服务端导入数据（服务端是多线程接收），并且存在加锁、日志异步打印和耗时统计操作，在这种情况下，客户端导入数据比较慢，服务端的cpu利用率只能维持在50%~60%左右，通过iostat和pidstat工具观测系统io和进程上下文切换等指标也没发现导致该现象的原因。<br>       如果关闭日志打印和耗时统计操作，cpu利用率会得到很大的提升，接近100%，客户端数据导入速度得到很大提升。因此我判断是日志打印和统计导致cpu利用率过低。针对这种情况，从哪些指标上能辅助发现是日志打印和耗时操作导致cpu不能高效利用呢？期待您的答疑，谢谢！","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436620,"discussion_content":"I/O 模块有讲解的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548249206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2055993,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5f/39/8d2c61d3.jpg","nickname":"Kiddy","note":"","ucode":"D07AAEE69BE504","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290039,"discussion_content":"写日志是io密集型操作，此时瓶颈在磁盘io上，导致cpu得不到充分利用。\n\n可以考虑把日志模块抽离到单独线程","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594307944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51311,"user_name":"xcz","can_delete":false,"product_type":"c1","uid":1231795,"ip_address":"","ucode":"D5AAEBA9856B8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/b3/4325ffc4.jpg","comment_is_top":false,"comment_ctime":1545151863,"is_pvip":false,"replies":[{"id":"18644","content":"谢谢","user_name":"作者回复","comment_id":51311,"uid":"1001282","ip_address":"","utype":1,"ctime":1545195673,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"18725021047","product_id":100020901,"comment_content":"买了几个课程里觉得最好的一门课，有条理，干货满满！","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433402,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545195673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51286,"user_name":"某、人","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":false,"comment_ctime":1545146827,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14430048715","product_id":100020901,"comment_content":"老师，numa应该是有利也有弊吧，特别是针对数据库来说。那么应该怎么分析是否开启numa呢？","like_count":3,"discussions":[{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591743,"discussion_content":"数据库要关闭numa的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666789971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1013424,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/b0/14fec62f.jpg","nickname":"不了峰","note":"","ucode":"E23B96D6A3D4EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549895,"discussion_content":"相应数据库的安装文档会有说。象oracle 就明确关闭 numa .","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644288685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231083,"user_name":"生活不如诗","can_delete":false,"product_type":"c1","uid":1139515,"ip_address":"","ucode":"FD48EABEEC52B7","user_header":"https://static001.geekbang.org/account/avatar/00/11/63/3b/c5cd68ab.jpg","comment_is_top":false,"comment_ctime":1593577951,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10183512543","product_id":100020901,"comment_content":"一、性能优化前需要考虑的问题：<br>1.判断性能优化是否有效，优化后提升效果；<br>\t1.确定性能的量化指标；<br>\t2.测试优化前的性能指标；<br>\t3.测试优化后的性能指标；<br>\t注意：<br>\t\t1.性能指标需要考虑应用程序维度（吞吐量，并发等）和系统维度（cpu使用率等）；<br>\t\t2.性能测试的时候压测工具避免和程序在同一服务器；多次性能测试的参数必须一致；<br>2.如果多个性能问题，先优化哪一个；<br>\t1.从能最大程度提升性能的问题开始优化；<br>\t2.如果是系统资源瓶颈，那么优先优化系统资源瓶颈；<br>\t3.针对不同指标，首先优化瓶颈导致的问题，性能指标变化幅度最大的问题；<br>3.多种优化方法，应该选择哪一个；<br>\t1.应用程序优化方法：<br>\t\t1.编译器优化；<br>\t\t2.算法优化；<br>\t\t3.异步处理；<br>\t\t4.多线程代替多进程；<br>\t\t5.善用缓存；<br>\t2.系统优化：<br>\t\t1.cpu绑定；<br>\t\t2.cpu独占；<br>\t\t3.调整进程优先级；<br>\t\t4.为进程设置资源限制；<br>\t\t5.NUMA优化；<br>\t\t6.中断负载均衡；<br>\t注意：<br>\t\t1.千万避免过早优化，因为第一，优化会带来系统复杂度，降低可维护性；第二，性能优化不是一成不变的，需要根据实际情况优化；<br>\t\t2.性能优化是有成本的；","like_count":2},{"had_liked":false,"id":107794,"user_name":"小宇子2B","can_delete":false,"product_type":"c1","uid":1254615,"ip_address":"","ucode":"E360188C65EAEA","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/d7/146f484b.jpg","comment_is_top":false,"comment_ctime":1561610621,"is_pvip":false,"replies":[{"id":"39657","content":"查看的时候有没有可能忽略了多线程的问题？","user_name":"作者回复","comment_id":107794,"uid":"1001282","ip_address":"","utype":1,"ctime":1562060706,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"10151545213","product_id":100020901,"comment_content":"老师好，近期遇到一个问题，6核机器，负载在20-100之间徘徊，查看了cpu使用率、io、上下文切换都是很正常，业务是java的一个应用主要是接收监控agent上报的数据的，业务不受影响，其他一切正常，还有什么可能会导致负载高吗？","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455676,"discussion_content":"查看的时候有没有可能忽略了多线程的问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562060706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63528,"user_name":"Maxwell","can_delete":false,"product_type":"c1","uid":1086275,"ip_address":"","ucode":"720A00AD472616","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg","comment_is_top":false,"comment_ctime":1548393047,"is_pvip":false,"replies":[{"id":"22587","content":"自然是越低越好，这样可以运行更多的应用。不过这其实没有统一标准，比如有些应用就需要总是 CPU 100%，而更多的应用则不是。","user_name":"作者回复","comment_id":63528,"uid":"1001282","ip_address":"","utype":1,"ctime":1548576854,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"10138327639","product_id":100020901,"comment_content":"请问CPU优化，cpu使用率和队列长度多少比较合适呢？","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437620,"discussion_content":"自然是越低越好，这样可以运行更多的应用。不过这其实没有统一标准，比如有些应用就需要总是 CPU 100%，而更多的应用则不是。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54678,"user_name":"walt","can_delete":false,"product_type":"c1","uid":1039816,"ip_address":"","ucode":"F0AEA21D02B7E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dd/c8/3f100905.jpg","comment_is_top":false,"comment_ctime":1545931621,"is_pvip":false,"replies":[{"id":"19943","content":"繁忙呀，这时候系统就需要不停在调度进程，也会有大量的上下文切换","user_name":"作者回复","comment_id":54678,"uid":"1001282","ip_address":"","utype":1,"ctime":1546005383,"user_name_real":"倪朋飞"}],"discussion_count":2,"race_medal":0,"score":"10135866213","product_id":100020901,"comment_content":"倪老师好，4核8G Centos7,cpu load 超过15，单核任务数接近4了，但是 cpu idle还有20～30%，这个情况下如何评价CPU资源呢？","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434534,"discussion_content":"繁忙呀，这时候系统就需要不停在调度进程，也会有大量的上下文切换","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546005383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1918112,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/44/a0/16d0d300.jpg","nickname":"ZHANGPING","note":"","ucode":"7108812981C996","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554728,"discussion_content":"也有可能是频繁的访问磁盘，进程给block了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646571633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51729,"user_name":"Im Robin","can_delete":false,"product_type":"c1","uid":1183477,"ip_address":"","ucode":"924B7DC8CD38EF","user_header":"https://static001.geekbang.org/account/avatar/00/12/0e/f5/c4a26e84.jpg","comment_is_top":false,"comment_ctime":1545229780,"is_pvip":false,"replies":[{"id":"18898","content":"试试irqbalance或者配置 smp_affinity ","user_name":"作者回复","comment_id":51729,"uid":"1001282","ip_address":"","utype":1,"ctime":1545313635,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"10135164372","product_id":100020901,"comment_content":"打开，谢谢老师干货满满的教学<br>--------------------------------------------------------------<br>这里有一个问题， 我们线上的nginx两个实例之间QPS差2倍，nginx前面是四层SLB，两者唯一的区别就是centos6.5跟centos7.3，QPS高的机器load也高，推论就是centos6.5的那台压力上不去，在&#47;proc&#47;interrupts看到centos6.5的只有cpu0在处理虚拟网卡中断，而另一台四个cpu都在工作，不知道是不是这里的原因，看到这篇里老师有提到中断负载均衡，在想跟这里有没有关系，想向老师请教下","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433601,"discussion_content":"试试irqbalance或者配置 smp_affinity ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545313635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195886,"user_name":"斑马Z","can_delete":false,"product_type":"c1","uid":1500262,"ip_address":"","ucode":"ABB55B4652452F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK0K9AM6xxDzVV6pF66jyus5NuuxZzT9icad8AQDMKibwUOy3UnoZIZdyKIKd9sA06rgFnIWwiakSeOQ/132","comment_is_top":false,"comment_ctime":1585221455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880188751","product_id":100020901,"comment_content":"我恨不得整篇文章都复制粘贴下来。","like_count":1},{"had_liked":false,"id":193538,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1584924760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5879892056","product_id":100020901,"comment_content":"CPU调度策略可以是优化的方法之一吗？还是说不建议调整策略？","like_count":1},{"had_liked":false,"id":50798,"user_name":"J","can_delete":false,"product_type":"c1","uid":1204008,"ip_address":"","ucode":"7F1BD7F66F4700","user_header":"https://static001.geekbang.org/account/avatar/00/12/5f/28/17ed19bc.jpg","comment_is_top":false,"comment_ctime":1545048122,"is_pvip":false,"replies":[{"id":"18475","content":"没有涉及这一块。碰到了什么问题可以分享下？","user_name":"作者回复","comment_id":50798,"uid":"1001282","ip_address":"","utype":1,"ctime":1545144455,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"5840015418","product_id":100020901,"comment_content":"有没有可能讲一讲cpufreq  Intel的E系列CPU影响很大啊 升级内核之后 谢谢","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433110,"discussion_content":"没有涉及这一块。碰到了什么问题可以分享下？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545144455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353478,"user_name":"Geek_f93234","can_delete":false,"product_type":"c1","uid":1769504,"ip_address":"北京","ucode":"1E5DC903A5429E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGXndj5N66z9BL1ic9GibZzWWgoVeWaWTL2XUnCYic7iba2kAEvN9WfjmlXELD5lqt8IJ1P023N5ZWicg/132","comment_is_top":false,"comment_ctime":1659492900,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1659492900","product_id":100020901,"comment_content":"day12","like_count":0},{"had_liked":false,"id":338881,"user_name":"Sudouble","can_delete":false,"product_type":"c1","uid":1365574,"ip_address":"","ucode":"B369B09DAF8D20","user_header":"https://static001.geekbang.org/account/avatar/00/14/d6/46/5eb5261b.jpg","comment_is_top":false,"comment_ctime":1647770961,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647770961","product_id":100020901,"comment_content":"优化是一种技术上的trade off。在算法时间复杂度一定的情况下，需要对资源的使用进行取舍。","like_count":1},{"had_liked":false,"id":311502,"user_name":"doos","can_delete":false,"product_type":"c1","uid":1069269,"ip_address":"","ucode":"7C9AF67F90E65C","user_header":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","comment_is_top":false,"comment_ctime":1631259160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631259160","product_id":100020901,"comment_content":"老师，看完你的课程，我目前可以定位到这个cpu因为啥飙高，但是不懂java程序所以无法优化，有啥解决办法吗？","like_count":0},{"had_liked":false,"id":290343,"user_name":"刘青松","can_delete":false,"product_type":"c1","uid":1275659,"ip_address":"","ucode":"65759A01ECD48C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoTtHIemT3d7oOuDoU5dOGQeUzxTvcLPeD2qPS48ib5hlKq3ne650o5GVc2N5ia5uo4WOEnzmcNAZGQ/132","comment_is_top":false,"comment_ctime":1619510081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619510081","product_id":100020901,"comment_content":"您好，可以以运维工程师的角度讲解Linux的CPU优化吗，您的这篇文章提到的都是开发代码中的优化，没表达出实质您在生产环境中对操作系统的优化","like_count":0},{"had_liked":false,"id":287916,"user_name":"清水","can_delete":false,"product_type":"c1","uid":2559543,"ip_address":"","ucode":"D25F83AA62FD70","user_header":"","comment_is_top":false,"comment_ctime":1618215141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618215141","product_id":100020901,"comment_content":"我们现在pks集群部署，一个节点上有多个应用，top命令在容器里面，上方还是整个主机的总负载，怎么看当前应用分配了的cpu和内存情况？","like_count":0},{"had_liked":false,"id":284702,"user_name":"babala","can_delete":false,"product_type":"c1","uid":1856958,"ip_address":"","ucode":"F0F06865D328A6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/55/be/23b0fa67.jpg","comment_is_top":false,"comment_ctime":1616421065,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616421065","product_id":100020901,"comment_content":"我使用tpcc测试mariadb  网络中断反而队列二最好，只让两个cpu处理。但是还是没达到目标值怎么办？虚拟机的数据库性能","like_count":0},{"had_liked":false,"id":254903,"user_name":"一粒","can_delete":false,"product_type":"c1","uid":1582813,"ip_address":"","ucode":"FB5F583CC6AE3C","user_header":"https://static001.geekbang.org/account/avatar/00/18/26/dd/d58156b1.jpg","comment_is_top":false,"comment_ctime":1603209359,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1603209359","product_id":100020901,"comment_content":"深有体会，不纠结于某个代码块，先优化性能影响最大的地方，这样效果也更明显","like_count":0},{"had_liked":false,"id":219771,"user_name":"普罗米修斯","can_delete":false,"product_type":"c1","uid":1394030,"ip_address":"","ucode":"DDA7DE4DE371FC","user_header":"https://static001.geekbang.org/account/avatar/00/15/45/6e/11cf22de.jpg","comment_is_top":false,"comment_ctime":1590076375,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590076375","product_id":100020901,"comment_content":"从未见过如此深刻，分析透彻的好文，太棒了","like_count":0},{"had_liked":false,"id":218163,"user_name":"Yong","can_delete":false,"product_type":"c1","uid":1912653,"ip_address":"","ucode":"0ADA75C5C68619","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3OaibxsOia5ZET1iaBsPwDM6NS43lAUTdItqkwZ66fGaaXtjOQYL73IsvY0foscUZlkaZSQPPQNexA/132","comment_is_top":false,"comment_ctime":1589726236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589726236","product_id":100020901,"comment_content":"打卡:<br>1.过早优化是万恶之源<br>2.一定要忍住“把 CPU 性能优化到极致”的冲动","like_count":0},{"had_liked":false,"id":202243,"user_name":"南山","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1585931436,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585931436","product_id":100020901,"comment_content":"最贴近开发的重调用！","like_count":0},{"had_liked":false,"id":192623,"user_name":"怀揣梦想的学渣","can_delete":false,"product_type":"c1","uid":1916685,"ip_address":"","ucode":"2349B9F4F6FDE3","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg","comment_is_top":false,"comment_ctime":1584864486,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1584864486","product_id":100020901,"comment_content":"文中提到，“第二，针对不同类型的指标，首先去优化那些由瓶颈导致的，性能指标变化幅度最大的问题。比如产生瓶颈后，用户 CPU 使用率升高了 10%，而系统 CPU 使用率却升高了 50%，这个时候就应该首先优化系统 CPU 的使用”。所以说，谁的占用率提高的多，优先优化谁，这样理解正确吗","like_count":0},{"had_liked":false,"id":185460,"user_name":"宋胖胖","can_delete":false,"product_type":"c1","uid":1857496,"ip_address":"","ucode":"AA828F49CCEABA","user_header":"https://static001.geekbang.org/account/avatar/00/1c/57/d8/e9c8b923.jpg","comment_is_top":false,"comment_ctime":1583587087,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583587087","product_id":100020901,"comment_content":"看到这么高手讨论......默默打个卡","like_count":0},{"had_liked":false,"id":173326,"user_name":"刘友淙","can_delete":false,"product_type":"c1","uid":1620058,"ip_address":"","ucode":"97F3A69A308313","user_header":"","comment_is_top":false,"comment_ctime":1579505168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579505168","product_id":100020901,"comment_content":"D8 打卡","like_count":0},{"had_liked":false,"id":173073,"user_name":"笑","can_delete":false,"product_type":"c1","uid":1741098,"ip_address":"","ucode":"689A435818403A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/91/2a/c0fb21fa.jpg","comment_is_top":false,"comment_ctime":1579420466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579420466","product_id":100020901,"comment_content":"打卡，Day 11，性能优化要逐步完善，动态进行，过早优化是万恶之源。","like_count":0},{"had_liked":false,"id":165994,"user_name":"xdargs","can_delete":false,"product_type":"c1","uid":1063740,"ip_address":"","ucode":"EB8326D3A72DE5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoH9Mlw0kLK0p39vhQpdvkbQP5TX96DB9HMJ1POaTVDpMZg4rjlO3WCAqiaWWMc77ffS3vTo8qWdXA/132","comment_is_top":false,"comment_ctime":1577359597,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1577359597","product_id":100020901,"comment_content":"从好东西堆里先捡一两样：gcc编译器优化；利用CPU绑定、独占 减少上下文切换","like_count":0},{"had_liked":false,"id":163076,"user_name":"吴小喵","can_delete":false,"product_type":"c1","uid":1392780,"ip_address":"","ucode":"A8CB5407A89593","user_header":"https://static001.geekbang.org/account/avatar/00/15/40/8c/bc76ecd3.jpg","comment_is_top":false,"comment_ctime":1576653114,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576653114","product_id":100020901,"comment_content":"打卡吧","like_count":0},{"had_liked":false,"id":160043,"user_name":"xuelangos","can_delete":false,"product_type":"c1","uid":1284091,"ip_address":"","ucode":"E05A015BF8957A","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/fb/2737a4e4.jpg","comment_is_top":false,"comment_ctime":1575860095,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575860095","product_id":100020901,"comment_content":"99太便宜了","like_count":0},{"had_liked":false,"id":132776,"user_name":"Tao","can_delete":false,"product_type":"c1","uid":1466809,"ip_address":"","ucode":"75FBDF49C601F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/61/b9/dbf629c0.jpg","comment_is_top":false,"comment_ctime":1568217659,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568217659","product_id":100020901,"comment_content":"老师爱死你了😍😍","like_count":0},{"had_liked":false,"id":132519,"user_name":"苦行僧","can_delete":false,"product_type":"c1","uid":1055334,"ip_address":"","ucode":"726024A9A9CF44","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","comment_is_top":false,"comment_ctime":1568160814,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1568160814","product_id":100020901,"comment_content":"总是cpu100会不会对机器有影响 有这样的应用吗？","like_count":0,"discussions":[{"author":{"id":1318941,"avatar":"https://static001.geekbang.org/account/avatar/00/14/20/1d/0c1a184c.jpg","nickname":"罗辑思维","note":"","ucode":"D257A06EDE928E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308764,"discussion_content":"1、有。比如跟监控网络工具。\n\n2、不会影响机器，当然前提是机器上有多颗CPU。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601079260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105383,"user_name":"阿丽","can_delete":false,"product_type":"c1","uid":1170970,"ip_address":"","ucode":"C01D32E7165302","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJFlHhylrbLANtehiaX50wgVa2Z1ibQAdLpgyW4gCpEyOKEI9bPNZZBiabrP2oCleZWc2KKyKADz8tg/132","comment_is_top":false,"comment_ctime":1560991440,"is_pvip":false,"replies":[{"id":"38370","content":"有没有监控系统？如果有监控的话，从监控的历史数据配合日志或许可以发现线索","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1561215352,"ip_address":"","comment_id":105383,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560991440","product_id":100020901,"comment_content":"老师，昨天的性能问题，今天还可以分析出来吗？用什么工具？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454656,"discussion_content":"有没有监控系统？如果有监控的话，从监控的历史数据配合日志或许可以发现线索","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561215352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88079,"user_name":"火狼王","can_delete":false,"product_type":"c1","uid":1152184,"ip_address":"","ucode":"76919311EA41A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/94/b8/09d86400.jpg","comment_is_top":false,"comment_ctime":1555840411,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555840411","product_id":100020901,"comment_content":"dx","like_count":0},{"had_liked":false,"id":74095,"user_name":"maoxiajun","can_delete":false,"product_type":"c1","uid":1198843,"ip_address":"","ucode":"CB4926BC81B3B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/4a/fb/70f14340.jpg","comment_is_top":false,"comment_ctime":1552102981,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552102981","product_id":100020901,"comment_content":"lesson12打卡，看到现在，每篇都是干货","like_count":0},{"had_liked":false,"id":71230,"user_name":"JuCY","can_delete":false,"product_type":"c1","uid":1038800,"ip_address":"","ucode":"43689B65128039","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/d0/baffc852.jpg","comment_is_top":false,"comment_ctime":1551293053,"is_pvip":true,"replies":[{"id":"25719","content":"不是所有的I&#47;O等待都算在iowait里：一旦有了使用CPU的进程，iowait就会降下来，user sys这些升高","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1551399997,"ip_address":"","comment_id":71230,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551293053","product_id":100020901,"comment_content":"谢谢，不好意思再追问几句。<br>负载高CPU使用率低【也就是%idle高】，老师的结论是IO高，但我下面这么分析不知道对不对？<br>负载高CPU使用率低，说明CPU空闲的时候，等待队列里都是D状态进程，但是根据%iowait的定义和D状态的定义，CPU空闲时有D进程在等待的这段时间，应该算在iowait里，而不算在idle里，所以应该是%iowait高，%idle低才是啊，怎么会是%idle高呢？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441058,"discussion_content":"不是所有的I/O等待都算在iowait里：一旦有了使用CPU的进程，iowait就会降下来，user sys这些升高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551399997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70244,"user_name":"JuCY","can_delete":false,"product_type":"c1","uid":1038800,"ip_address":"","ucode":"43689B65128039","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/d0/baffc852.jpg","comment_is_top":false,"comment_ctime":1551058349,"is_pvip":true,"replies":[{"id":"25350","content":"I&#47;O密集型的应用","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1551194788,"ip_address":"","comment_id":70244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551058349","product_id":100020901,"comment_content":"请教一下倪老师，有一种比较常见的情况是负载很高，但CPU使用率很低，可能是什么原因呢？怎么模拟这种现象？这个问题想了很久一直得不到答案","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440513,"discussion_content":"I/O密集型的应用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551194788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70242,"user_name":"JuCY","can_delete":false,"product_type":"c1","uid":1038800,"ip_address":"","ucode":"43689B65128039","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/d0/baffc852.jpg","comment_is_top":false,"comment_ctime":1551058095,"is_pvip":true,"replies":[{"id":"25351","content":"负载高不代表CPU使用率高，还有可能是I&#47;O高","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1551194814,"ip_address":"","comment_id":70242,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551058095","product_id":100020901,"comment_content":"针对上面一个学员的问题，为什么负载高但是还有空闲CPU就判断是进程切换呢？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440511,"discussion_content":"负载高不代表CPU使用率高，还有可能是I/O高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551194814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63235,"user_name":"BR","can_delete":false,"product_type":"c1","uid":1031037,"ip_address":"","ucode":"2CF588390A5D34","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/7d/1f4b4697.jpg","comment_is_top":false,"comment_ctime":1548304819,"is_pvip":false,"replies":[{"id":"22582","content":"五分钟课是什么😓","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1548576397,"ip_address":"","comment_id":63235,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548304819","product_id":100020901,"comment_content":"听了这几期，估计倪兄也是五分钟课的粉丝～","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437511,"discussion_content":"五分钟课是什么😓","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63069,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":1248304,"ip_address":"","ucode":"56F10976A79D20","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/30/a2e7728a.jpg","comment_is_top":false,"comment_ctime":1548243330,"is_pvip":false,"replies":[{"id":"22349","content":"嗯嗯","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1548252902,"ip_address":"","comment_id":63069,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548243330","product_id":100020901,"comment_content":"文章干货满满，如果当前cpu有DMA控制器，通过DMA进行数据搬移，也能很好的提高系统性能","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437456,"discussion_content":"嗯嗯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61562,"user_name":"closer","can_delete":false,"product_type":"c1","uid":1368990,"ip_address":"","ucode":"69F38480DF8491","user_header":"https://static001.geekbang.org/account/avatar/00/14/e3/9e/b26da70d.jpg","comment_is_top":false,"comment_ctime":1547723865,"is_pvip":false,"replies":[{"id":"22328","content":"CPU使用率的问题有好几个案例了，可以先照着试试","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1548251086,"ip_address":"","comment_id":61562,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547723865","product_id":100020901,"comment_content":"redis每次都把cpu打到100%。已经检查过netstat 和数据库只有6个连接，怎么排错","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436912,"discussion_content":"CPU使用率的问题有好几个案例了，可以先照着试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548251086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58947,"user_name":"二三子也","can_delete":false,"product_type":"c1","uid":1245787,"ip_address":"","ucode":"69C7D86583277D","user_header":"https://static001.geekbang.org/account/avatar/00/13/02/5b/ce326cfc.jpg","comment_is_top":false,"comment_ctime":1547258360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547258360","product_id":100020901,"comment_content":"Flag<br>2019&#47;01&#47;12","like_count":0},{"had_liked":false,"id":58445,"user_name":"Maxwell","can_delete":false,"product_type":"c1","uid":1086275,"ip_address":"","ucode":"720A00AD472616","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg","comment_is_top":false,"comment_ctime":1547084375,"is_pvip":false,"replies":[{"id":"21149","content":"要结合实际业务来确定优化目标","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547124152,"ip_address":"","comment_id":58445,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547084375","product_id":100020901,"comment_content":"CPU利用率多少算是比较合适的呢，CPU优化需要优化到多少比较合适？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436066,"discussion_content":"要结合实际业务来确定优化目标","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547124152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58248,"user_name":"shibo","can_delete":false,"product_type":"c1","uid":1363215,"ip_address":"","ucode":"003A5780BB0AFE","user_header":"","comment_is_top":false,"comment_ctime":1547018508,"is_pvip":true,"replies":[{"id":"20982","content":"现在也不晚😊","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547026714,"ip_address":"","comment_id":58248,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547018508","product_id":100020901,"comment_content":"之前做过服务器上的数据库性能优化，也是运用了这些套路，要是早点这篇文章，就能少走点弯路","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435971,"discussion_content":"现在也不晚😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547026714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57509,"user_name":"f","can_delete":false,"product_type":"c1","uid":1027733,"ip_address":"","ucode":"8849D39F700E4B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/95/d1b13c9e.jpg","comment_is_top":false,"comment_ctime":1546825025,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546825025","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":56956,"user_name":"颇忒妥","can_delete":false,"product_type":"c1","uid":1026448,"ip_address":"","ucode":"AA86AD1049BC2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a9/90/0c5ed3d9.jpg","comment_is_top":false,"comment_ctime":1546586567,"is_pvip":false,"replies":[{"id":"21317","content":"目的是找根本而不是只看结果，比如软中断CPU使用率升高后要从网络方面来排查，而不是只盯着软中断的CPU使用率","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547259329,"ip_address":"","comment_id":56956,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546586567","product_id":100020901,"comment_content":"“分析完所有问题后，再按照因果等关系，排除掉有因果关联的性能问题。最后，再对剩下的性能问题进行优化。”<br>这句话不是太理解，为何要排除掉有因果关联的性能问题？<br>","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435329,"discussion_content":"目的是找根本而不是只看结果，比如软中断CPU使用率升高后要从网络方面来排查，而不是只盯着软中断的CPU使用率","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547259329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54525,"user_name":"如果","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1545890721,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545890721","product_id":100020901,"comment_content":"DAY12，打卡","like_count":0},{"had_liked":false,"id":53617,"user_name":"大飞","can_delete":false,"product_type":"c1","uid":1320080,"ip_address":"","ucode":"2D98888FC63CA9","user_header":"","comment_is_top":false,"comment_ctime":1545701293,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545701293","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":52501,"user_name":"唯美","can_delete":false,"product_type":"c1","uid":1263430,"ip_address":"","ucode":"9186A5B99DFBCA","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/46/61f16147.jpg","comment_is_top":false,"comment_ctime":1545398109,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545398109","product_id":100020901,"comment_content":"打卡D12","like_count":0},{"had_liked":false,"id":51760,"user_name":"风飘，吾独思","can_delete":false,"product_type":"c1","uid":1131032,"ip_address":"","ucode":"4DF0E7DC22EE53","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/18/edc1b373.jpg","comment_is_top":false,"comment_ctime":1545232661,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545232661","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":51043,"user_name":"怀特","can_delete":false,"product_type":"c1","uid":1072331,"ip_address":"","ucode":"3DACB205798ED3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5c/cb/3ebdcc49.jpg","comment_is_top":false,"comment_ctime":1545105241,"is_pvip":true,"replies":[{"id":"18461","content":"以后就会了😊","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545142738,"ip_address":"","comment_id":51043,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545105241","product_id":100020901,"comment_content":"不知道咋回事，每次都是mysql的cpu占满，注意是mysql，不是mysqld。当时没有看老师的专栏，酥手无策，业务也着急，所以后来重装了系统好了。<br>如果当时看过了老师的专栏，就可以立刻分析分析了，是一个很好的实际操练提高自己的机会，可惜了。","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433247,"discussion_content":"以后就会了😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545142738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50987,"user_name":"陈启永","can_delete":false,"product_type":"c1","uid":1086149,"ip_address":"","ucode":"ABD02B8C634F2F","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/c5/a2946220.jpg","comment_is_top":false,"comment_ctime":1545096379,"is_pvip":false,"replies":[{"id":"18465","content":"涉及的东西比较多，以后会推荐一些书籍和资料","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545143651,"ip_address":"","comment_id":50987,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545096379","product_id":100020901,"comment_content":"倪老师您好，你讲的知识很有条理，跟着您的思路来走是能够很好的理解的。自己在工作用也会尝试使用这里学到的知识来解决实际问题，感觉不会有以前那样碰到问题没头绪的尴尬处境了。<br>但是使用起来还没那么顺手，有可能是接触不够多的原因，但我觉得更多的原因是对知识的理解不够深入导致的。<br>所以在这里想请教下您，有哪些书籍可以帮助我们更加深入地系统的理解您讲的知识呢？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433218,"discussion_content":"涉及的东西比较多，以后会推荐一些书籍和资料","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545143651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50780,"user_name":"善良的男人","can_delete":false,"product_type":"c1","uid":1315544,"ip_address":"","ucode":"ED27030DE75059","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/d8/12879eb7.jpg","comment_is_top":false,"comment_ctime":1545044285,"is_pvip":false,"replies":[{"id":"18477","content":"有可能共享，也有可能swap。别急，接下来就到内存模块了","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545144649,"ip_address":"","comment_id":50780,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545044285","product_id":100020901,"comment_content":"top  中的  %mem   总和  超过 百分之百  不是很明白   还有就是  res  时所占用的物理内存   可是 想加之后也远超 与 实际内存  其中有 共享内存的占用吗 ？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433098,"discussion_content":"有可能共享，也有可能swap。别急，接下来就到内存模块了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545144649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50733,"user_name":"walker","can_delete":false,"product_type":"c1","uid":1324219,"ip_address":"","ucode":"FA5B2400A53730","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/bb/0b971fca.jpg","comment_is_top":false,"comment_ctime":1545036470,"is_pvip":false,"replies":[{"id":"18478","content":"还要看是什么资源的吞吐量，比如网络的、请求的、还是I&#47;O的，这些都有不同的工具","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545144843,"ip_address":"","comment_id":50733,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545036470","product_id":100020901,"comment_content":"吞吐量一般怎么计算呢，有没有什么好的工具专门计算吞吐量的","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433076,"discussion_content":"还要看是什么资源的吞吐量，比如网络的、请求的、还是I/O的，这些都有不同的工具","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545144843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50660,"user_name":"Geek_101627","can_delete":false,"product_type":"c1","uid":1070389,"ip_address":"","ucode":"F246019019F1CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/55/35/09e7dfde.jpg","comment_is_top":false,"comment_ctime":1545025994,"is_pvip":false,"replies":[{"id":"18484","content":"👍","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145053,"ip_address":"","comment_id":50660,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545025994","product_id":100020901,"comment_content":"打卡","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433055,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50644,"user_name":"划时代","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1545022216,"is_pvip":false,"replies":[{"id":"18481","content":"是的，分析的时候用，压测也要用","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145002,"ip_address":"","comment_id":50644,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545022216","product_id":100020901,"comment_content":"很多性能指标也是在做性能压力测试时使用的","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433051,"discussion_content":"是的，分析的时候用，压测也要用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50643,"user_name":"allan","can_delete":false,"product_type":"c1","uid":1142819,"ip_address":"","ucode":"CA0BE868AA9FF5","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/23/972dcd30.jpg","comment_is_top":false,"comment_ctime":1545022014,"is_pvip":false,"replies":[{"id":"18482","content":"😊","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145010,"ip_address":"","comment_id":50643,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545022014","product_id":100020901,"comment_content":"干货很多~","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433050,"discussion_content":"😊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50580,"user_name":"walker","can_delete":false,"product_type":"c1","uid":1324219,"ip_address":"","ucode":"FA5B2400A53730","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/bb/0b971fca.jpg","comment_is_top":false,"comment_ctime":1545012011,"is_pvip":false,"replies":[{"id":"18489","content":"先做性能测试，确定优化目标吧。漫无目的的调优不一定能带来收益","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145479,"ip_address":"","comment_id":50580,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545012011","product_id":100020901,"comment_content":"想做一个全面的性能调优测试，不知道需要从哪些点入手，然后需要注意哪些问题？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433027,"discussion_content":"先做性能测试，确定优化目标吧。漫无目的的调优不一定能带来收益","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50574,"user_name":"王涛","can_delete":false,"product_type":"c1","uid":1315326,"ip_address":"","ucode":"6241F08634D342","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/fe/de00d8d8.jpg","comment_is_top":false,"comment_ctime":1545011038,"is_pvip":false,"replies":[{"id":"18490","content":"👍","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145486,"ip_address":"","comment_id":50574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545011038","product_id":100020901,"comment_content":"D12打卡。系统性优化是个大项目，要好好研究研究","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433024,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50520,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1545006342,"is_pvip":false,"replies":[{"id":"18498","content":"👍","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145528,"ip_address":"","comment_id":50520,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545006342","product_id":100020901,"comment_content":"打卡，day13<br>cpu优化套路：<br>      程序级别：编译器优化，算法优化，异步处理，多进程转多线程，善用缓存<br>      系统级别：cpu绑定(优化上下文切换)，cpu独占（亲和性），nice值调整(得到更多的时钟周期)，cgroups设置资源限定，irqbalance负载中断，numa让cpu缓存命中率提升","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433008,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50497,"user_name":"solar","can_delete":false,"product_type":"c1","uid":1316091,"ip_address":"","ucode":"D5BE087E264401","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/dwehJHP4ycAfDb9MoudXb4QSt7YgmISqwwsa928XZ6aTWqwWh0kx0iatjocSibLa7iajXmbGlJ5svegY3P6LfKJ0w/132","comment_is_top":false,"comment_ctime":1545000491,"is_pvip":true,"replies":[{"id":"18500","content":"👍","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145542,"ip_address":"","comment_id":50497,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545000491","product_id":100020901,"comment_content":"打卡，打卡","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433000,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50491,"user_name":"湖湘志","can_delete":false,"product_type":"c1","uid":1285578,"ip_address":"","ucode":"C8B069B3AD4FEA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJR5Kj0Xm6LykFHLaWqHjQiaroVxgdoGI7uHEGz2D3PfibWNkBYP23QLzFmcuicgKLbqUch0ZJ2ZNOA/132","comment_is_top":false,"comment_ctime":1544985513,"is_pvip":false,"replies":[{"id":"18501","content":"+1👍","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1545145556,"ip_address":"","comment_id":50491,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544985513","product_id":100020901,"comment_content":"D12","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432997,"discussion_content":"+1👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545145556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}