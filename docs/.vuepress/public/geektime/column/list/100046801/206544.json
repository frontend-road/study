{"id":206544,"title":"04 | äº‹åŠ¡ï¼šè´¦æˆ·ä½™é¢æ€»æ˜¯å¯¹ä¸ä¸Šè´¦ï¼Œæ€ä¹ˆåŠï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æç¥ã€‚ä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ç”µå•†çš„è´¦æˆ·ç³»ç»Ÿã€‚</p><p>è´¦æˆ·ç³»ç»Ÿè´Ÿè´£è®°å½•å’Œç®¡ç†ç”¨æˆ·è´¦æˆ·çš„ä½™é¢ï¼Œè¿™ä¸ªä½™é¢å°±æ˜¯æ¯ä¸ªç”¨æˆ·ä¸´æ—¶å­˜åœ¨ç”µå•†çš„é’±ï¼Œæ¥æºå¯èƒ½æ˜¯ç”¨æˆ·å……å€¼æˆ–è€…é€€è´§é€€æ¬¾ç­‰å¤šç§é€”å¾„ã€‚</p><p>è´¦æˆ·ç³»ç»Ÿçš„ç”¨é€”ä¹Ÿéå¸¸å¹¿æ³›ï¼Œä¸ä»…ä»…æ˜¯ç”µå•†ï¼Œå„ç§äº’è”ç½‘å†…å®¹æä¾›å•†ã€ç½‘ç»œæ¸¸æˆæœåŠ¡å•†ï¼Œç”µä¿¡è¿è¥å•†ç­‰ç­‰ï¼Œéƒ½éœ€è¦è´¦æˆ·ç³»ç»Ÿæ¥ç®¡ç†ç”¨æˆ·è´¦æˆ·çš„ä½™é¢ï¼Œæˆ–è€…æ˜¯è™šæ‹Ÿè´§å¸ã€‚åŒ…æ‹¬é“¶è¡Œçš„æ ¸å¿ƒç³»ç»Ÿï¼Œä¹ŸåŒæ ·åŒ…å«ä¸€ä¸ªè´¦æˆ·ç³»ç»Ÿã€‚</p><p>ä»ä¸šåŠ¡éœ€æ±‚è§’åº¦æ¥åˆ†æï¼Œä¸€ä¸ªæœ€å°åŒ–çš„è´¦æˆ·ç³»ç»Ÿï¼Œå®ƒçš„æ•°æ®æ¨¡å‹å¯ä»¥ç”¨ä¸‹é¢è¿™å¼ è¡¨æ¥è¡¨ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e4/fb/e435af4227850bc7f01b00f4959c10fb.jpg?wh=3479*1380\" alt=\"\"></p><p>è¿™ä¸ªè¡¨åŒ…æ‹¬ç”¨æˆ·IDã€è´¦æˆ·ä½™é¢å’Œæ›´æ–°æ—¶é—´ä¸‰ä¸ªå­—æ®µã€‚æ¯æ¬¡äº¤æ˜“çš„æ—¶å€™ï¼Œæ ¹æ®ç”¨æˆ·IDå»æ›´æ–°è¿™ä¸ªè´¦æˆ·çš„ä½™é¢å°±å¯ä»¥äº†ã€‚</p><h2>ä¸ºä»€ä¹ˆæ€»æ˜¯å¯¹ä¸ä¸Šè´¦ï¼Ÿ</h2><p>æ¯ä¸ªè´¦æˆ·ç³»ç»Ÿéƒ½ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œè‡³å°‘è¦å’Œè´¢åŠ¡ã€è®¢å•ã€äº¤æ˜“è¿™äº›ç³»ç»Ÿæœ‰ç€å¯†åˆ‡çš„å…³è”ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè´¦æˆ·ç³»ç»Ÿå†…çš„æ•°æ®åº”è¯¥æ˜¯è‡ªæ´½çš„ã€‚æ‰€æœ‰ç”¨æˆ·çš„è´¦æˆ·ä½™é¢åŠ èµ·æ¥ï¼Œåº”è¯¥ç­‰äºè¿™ä¸ªç”µå•†å…¬å¸åœ¨é“¶è¡Œä¸“ç”¨è´¦æˆ·çš„æ€»ä½™é¢ã€‚è´¦æˆ·ç³»ç»Ÿçš„æ•°æ®ä¹Ÿåº”è¯¥å’Œå…¶ä»–ç³»ç»Ÿçš„æ•°æ®èƒ½å¯¹çš„ä¸Šã€‚æ¯”å¦‚è¯´ï¼Œæ¯ä¸ªç”¨æˆ·çš„ä½™é¢åº”è¯¥èƒ½å’Œäº¤æ˜“ç³»ç»Ÿä¸­å……å€¼è®°å½•ï¼Œä»¥åŠè®¢å•ç³»ç»Ÿä¸­çš„è®¢å•å¯¹çš„ä¸Šã€‚</p><p>ä¸è¿‡ï¼Œç”±äºä¸šåŠ¡å’Œç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œç°å®æƒ…å†µå´æ˜¯ï¼Œå¾ˆå°‘æœ‰è´¦æˆ·ç³»ç»Ÿèƒ½å¤Ÿåšåˆ°ä¸€ç‚¹ä¸å·®çš„å¯¹ä¸Šæ¯ä¸€ç¬”è´¦ã€‚æ‰€ä»¥ï¼Œç¨å¾®å¤§å‹ä¸€ç‚¹å„¿çš„ç³»ç»Ÿï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªä¸“é—¨çš„å¯¹è´¦ç³»ç»Ÿï¼Œæ¥æ ¸å¯¹ã€çŸ«æ­£è´¦æˆ·ç³»ç»Ÿå’Œå…¶ä»–ç³»ç»Ÿä¹‹é—´çš„æ•°æ®å·®å¼‚ã€‚</p><!-- [[[read_end]]] --><p>å¯¹ä¸ä¸Šè´¦çš„åŸå› éå¸¸å¤šï¼Œæ¯”å¦‚ä¸šåŠ¡å˜åŒ–ã€äººä¸ºä¿®æ”¹äº†æ•°æ®ã€ç³»ç»Ÿä¹‹é—´æ•°æ®äº¤æ¢å¤±è´¥ç­‰ç­‰ã€‚é‚£ä½œä¸ºç³»ç»Ÿçš„è®¾è®¡è€…ï¼Œæˆ‘ä»¬åªå…³æ³¨â€œå¦‚ä½•é¿å…ç”±äºæŠ€æœ¯åŸå› å¯¼è‡´çš„å¯¹ä¸ä¸Šè´¦â€å°±å¯ä»¥äº†ï¼Œæœ‰å“ªäº›æ˜¯å› ä¸ºæŠ€æœ¯åŸå› å¯¼è‡´çš„å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼šç½‘ç»œè¯·æ±‚é”™è¯¯ï¼ŒæœåŠ¡å™¨å®•æœºã€ç³»ç»ŸBugç­‰ã€‚</p><p>â€œå¯¹ä¸ä¸Šè´¦â€æ˜¯é€šä¿—çš„è¯´æ³•ï¼Œå®ƒçš„æœ¬è´¨é—®é¢˜æ˜¯ï¼Œ<strong>å†—ä½™æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜</strong>ã€‚</p><p>è¿™é‡Œé¢çš„å†—ä½™æ•°æ®å¹¶ä¸æ˜¯å¤šä½™æˆ–è€…é‡å¤çš„æ•°æ®ï¼Œè€Œæ˜¯å¤šä»½å«æœ‰ç›¸åŒä¿¡æ¯çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡ç”¨æˆ·çš„æ¯ä¸€ç¬”å……å€¼äº¤æ˜“æ•°æ®ã€æ¶ˆè´¹çš„è®¢å•æ•°æ®ï¼Œæ¥è®¡ç®—å‡ºè¿™ä¸ªç”¨æˆ·å½“å‰çš„è´¦æˆ·ä½™é¢æ˜¯å¤šå°‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè´¦æˆ·ä½™é¢æ•°æ®å’Œè¿™äº›è´¦æˆ·ç›¸å…³çš„äº¤æ˜“è®°å½•ï¼Œéƒ½å«æœ‰â€œè´¦æˆ·ä½™é¢â€è¿™ä¸ªä¿¡æ¯ï¼Œé‚£å®ƒä»¬ä¹‹é—´å°±äº’ä¸ºå†—ä½™æ•°æ®ã€‚</p><p>åœ¨è®¾è®¡ç³»ç»Ÿçš„å­˜å‚¨æ—¶ï¼ŒåŸåˆ™ä¸Šä¸åº”è¯¥å­˜å‚¨å†—ä½™æ•°æ®ï¼Œä¸€æ˜¯æµªè´¹å­˜å‚¨ç©ºé—´ï¼ŒäºŒæ˜¯è®©è¿™äº›å†—ä½™æ•°æ®ä¿æŒä¸€è‡´æ˜¯ä¸€ä»¶éå¸¸éº»çƒ¦çš„äº‹å„¿ã€‚ä½†æœ‰äº›åœºæ™¯ä¸‹å­˜å‚¨å†—ä½™æ•°æ®æ˜¯å¿…è¦çš„ï¼Œæ¯”å¦‚ç”¨æˆ·è´¦æˆ·çš„ä½™é¢è¿™ä¸ªæ•°æ®ã€‚</p><p>è¿™ä¸ªæ•°æ®åœ¨äº¤æ˜“è¿‡ç¨‹ä¸­ä¼šè¢«éå¸¸é¢‘ç¹åœ°ç”¨åˆ°ï¼Œæ€»ä¸èƒ½æ¯æ¬¡äº¤æ˜“ä¹‹å‰ï¼Œå…ˆé€šè¿‡æ‰€æœ‰å†å²äº¤æ˜“è®°å½•è®¡ç®—ä¸€ä¸‹å½“å‰è´¦æˆ·çš„ä½™é¢ï¼Œè¿™æ ·åšé€Ÿåº¦å¤ªæ…¢äº†ï¼Œæ€§èƒ½æ»¡è¶³ä¸äº†äº¤æ˜“çš„éœ€æ±‚ã€‚æ‰€ä»¥è´¦æˆ·ç³»ç»Ÿä¿å­˜äº†æ¯ä¸ªç”¨æˆ·çš„è´¦æˆ·ä½™é¢ï¼Œè¿™å®é™…ä¸Šæ˜¯ä¸€ç§ç”¨<strong>å­˜å‚¨ç©ºé—´æ¢è®¡ç®—æ—¶é—´</strong>çš„è®¾è®¡ã€‚</p><p>å¦‚æœè¯´åªæ˜¯æ»¡è¶³åŠŸèƒ½éœ€æ±‚ï¼Œè´¦æˆ·ç³»ç»Ÿåªè®°å½•ä½™é¢ï¼Œæ¯æ¬¡äº¤æ˜“çš„æ—¶å€™æ›´æ–°è´¦æˆ·ä½™é¢å°±å¤Ÿäº†ã€‚ä½†æ˜¯è¿™æ ·åšæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè´¦æˆ·ä½™é¢è¢«ç¯¡æ”¹ï¼Œæ˜¯æ²¡æœ‰åŠæ³•è¿½æŸ¥çš„ï¼Œæ‰€ä»¥åœ¨è®°å½•ä½™é¢çš„åŒæ—¶ï¼Œè¿˜éœ€è¦è®°å½•æ¯ä¸€ç¬”äº¤æ˜“è®°å½•ï¼Œä¹Ÿå°±æ˜¯è´¦æˆ·çš„æµæ°´ã€‚æµæ°´çš„æ•°æ®æ¨¡å‹è‡³å°‘éœ€è¦åŒ…å«ï¼šæµæ°´IDã€äº¤æ˜“é‡‘é¢ã€äº¤æ˜“æ—¶é—´æˆ³ä»¥åŠäº¤æ˜“åŒæ–¹çš„ç³»ç»Ÿã€è´¦æˆ·ã€äº¤æ˜“å•å·ç­‰ä¿¡æ¯ã€‚</p><p>è™½ç„¶è¯´ï¼Œæµæ°´å’Œä½™é¢ä¹Ÿæ˜¯äº’ä¸ºå†—ä½™æ•°æ®ï¼Œä½†æ˜¯è®°å½•æµæ°´ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ä¿®æ­£ç”±äºç³»ç»ŸBugæˆ–è€…äººä¸ºç¯¡æ”¹å¯¼è‡´çš„è´¦æˆ·ä½™é¢é”™è¯¯çš„é—®é¢˜ï¼Œä¹Ÿä¾¿äºè´¦æˆ·ç³»ç»Ÿä¸å…¶ä»–å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œå¯¹è´¦ï¼Œæ‰€ä»¥è´¦æˆ·ç³»ç»Ÿè®°å½•æµæ°´æ˜¯éå¸¸å¿…è¦çš„ã€‚</p><p>åœ¨è®¾è®¡è´¦æˆ·æµæ°´æ—¶ï¼Œæœ‰å‡ ä¸ªé‡è¦çš„åŸåˆ™å¿…é¡»éµå®ˆï¼Œæœ€å¥½æ˜¯ç”¨æŠ€æœ¯æ‰‹æ®µåŠ ä»¥é™åˆ¶ã€‚</p><ol>\n<li>æµæ°´è®°å½•åªèƒ½æ–°å¢ï¼Œä¸€æ—¦è®°å½•æˆåŠŸä¸å…è®¸ä¿®æ”¹å’Œåˆ é™¤ã€‚å³ä½¿æ˜¯ç”±äºæ­£å½“åŸå› éœ€è¦å–æ¶ˆä¸€ç¬”å·²ç»å®Œæˆçš„äº¤æ˜“ï¼Œä¹Ÿä¸åº”è¯¥å»åˆ é™¤äº¤æ˜“æµæ°´ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å†è®°å½•ä¸€ç¬”â€œå–æ¶ˆäº¤æ˜“â€çš„æµæ°´ã€‚</li>\n<li>æµæ°´å·å¿…é¡»æ˜¯é€’å¢çš„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æµæ°´å·æ¥ç¡®å®šäº¤æ˜“çš„å…ˆåé¡ºåºã€‚</li>\n</ol><p>åœ¨å¯¹è´¦çš„æ—¶å€™ï¼Œä¸€æ—¦å‡ºç°äº†æµæ°´å’Œä½™é¢ä¸ä¸€è‡´ï¼Œå¹¶ä¸”æ— æ³•é€šè¿‡ä¸šåŠ¡æ‰‹æ®µæ¥ç¡®å®šåˆ°åº•æ˜¯å“ªå„¿è®°é”™äº†çš„æƒ…å†µï¼Œä¸€èˆ¬çš„å¤„ç†åŸåˆ™æ˜¯ä»¥äº¤æ˜“æµæ°´ä¸ºå‡†æ¥ä¿®æ­£ä½™é¢æ•°æ®ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åç»­çš„äº¤æ˜“èƒ½â€œå¯¹ä¸Šè´¦â€ã€‚</p><p>é‚£ä»æŠ€æœ¯ä¸Šï¼Œå¦‚ä½•ä¿è¯è´¦æˆ·ç³»ç»Ÿä¸­æµæ°´å’Œä½™é¢æ•°æ®ä¸€è‡´å‘¢ï¼Ÿ</p><h2>ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡æ¥ä¿è¯æ•°æ®ä¸€è‡´æ€§</h2><p>åœ¨è®¾è®¡å¯¹å¤–æä¾›çš„æœåŠ¡æ¥å£æ—¶ï¼Œä¸èƒ½æä¾›å•ç‹¬æ›´æ–°ä½™é¢æˆ–è€…æµæ°´çš„åŠŸèƒ½ï¼Œåªæä¾›äº¤æ˜“åŠŸèƒ½ã€‚æˆ‘ä»¬éœ€è¦åœ¨å®ç°äº¤æ˜“åŠŸèƒ½çš„æ—¶å€™ï¼ŒåŒæ—¶è®°å½•æµæ°´å¹¶ä¿®æ”¹ä½™é¢ï¼Œå¹¶ä¸”è¦å°½å¯èƒ½ä¿è¯ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œè®°å½•æµæ°´å’Œä¿®æ”¹ä½™é¢è¿™ä¸¤ä¸ªæ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚ä¸èƒ½æœ‰ä»»ä½•ä¸€ç¬”äº¤æ˜“å‡ºç°ï¼Œè®°å½•äº†æµæ°´ä½†ä½™é¢æ²¡æ›´æ–°ï¼Œæˆ–è€…æ›´æ–°äº†ä½™é¢ä½†æ˜¯æ²¡è®°å½•æµæ°´ã€‚</p><p>è¿™ä¸ªäº‹å„¿è¯´èµ·æ¥æŒºç®€å•ï¼Œä½†å®é™…ä¸Šæ˜¯éå¸¸éš¾å®ç°çš„ã€‚æ¯•ç«Ÿåº”ç”¨ç¨‹åºåªèƒ½å…ˆåæ¥æ‰§è¡Œä¸¤ä¸ªæ“ä½œï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‘ç”Ÿç½‘ç»œé”™è¯¯ã€ç³»ç»Ÿå®•æœºç­‰å„ç§å¼‚å¸¸çš„æƒ…å†µï¼Œæ‰€ä»¥å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå¾ˆéš¾ä¿è¯è¿™ä¸¤ä¸ªæ“ä½œéƒ½æˆåŠŸæˆ–è€…éƒ½å¤±è´¥ã€‚</p><p>æ•°æ®åº“æä¾›äº†äº‹åŠ¡æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®é™…ä¸Šäº‹åŠ¡è¿™ä¸ªç‰¹æ€§æœ€åˆå°±æ˜¯è¢«è®¾è®¡ç”¨æ¥è§£å†³äº¤æ˜“é—®é¢˜çš„ï¼Œåœ¨è‹±æ–‡ä¸­ï¼Œäº‹åŠ¡å’Œäº¤æ˜“å°±æ˜¯åŒä¸€ä¸ªå•è¯ï¼šTransactionã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¦‚ä½•æ¥ä½¿ç”¨MySQLçš„äº‹åŠ¡ï¼Œå®ç°ä¸€ç¬”äº¤æ˜“ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨äº‹åŠ¡ä¸­æ‰§è¡Œä¸€ä¸ªå……å€¼100å…ƒçš„äº¤æ˜“ï¼Œå…ˆè®°å½•ä¸€æ¡äº¤æ˜“æµæ°´ï¼Œæµæ°´å·æ˜¯888ï¼Œç„¶åæŠŠè´¦æˆ·ä½™é¢ä»100å…ƒæ›´æ–°åˆ°200å…ƒã€‚å¯¹åº”çš„SQLæ˜¯è¿™æ ·çš„ï¼š</p><pre><code>mysql&gt; begin;  -- å¼€å§‹äº‹åŠ¡\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; insert into account_log ...;  -- å†™å…¥äº¤æ˜“æµæ°´\nQuery OK, 1 rows affected (0.01 sec)\n\nmysql&gt; update account_balance ...;  -- æ›´æ–°è´¦æˆ·ä½™é¢\nQuery OK, 1 rows affected (0.00 sec)\n\nmysql&gt; commit; # æäº¤äº‹åŠ¡\nQuery OK, 0 rows affected (0.01 sec)\n</code></pre><p>ä½¿ç”¨äº‹åŠ¡çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨ä¹‹å‰æ‰§è¡Œ<code>begin</code>ï¼Œæ ‡è®°å¼€å§‹ä¸€ä¸ªäº‹åŠ¡ï¼Œç„¶åæ­£å¸¸æ‰§è¡Œå¤šæ¡SQLè¯­å¥ï¼Œåœ¨äº‹åŠ¡é‡Œé¢çš„ä¸ä»…å¯ä»¥æ‰§è¡Œæ›´æ–°æ•°æ®çš„SQLï¼ŒæŸ¥è¯¢è¯­å¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæœ€åæ‰§è¡Œ<code>commit</code>ï¼Œæäº¤äº‹åŠ¡å°±å¯ä»¥äº†ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œäº‹åŠ¡å¯ä»¥ç»™æˆ‘ä»¬æä¾›ä»€ä¹ˆæ ·çš„ä¿è¯ï¼Ÿ</p><p>é¦–å…ˆï¼Œå®ƒå¯ä»¥ä¿è¯ï¼Œè®°å½•æµæ°´å’Œæ›´æ–°ä½™é¢è¿™ä¸¤ä¸ªæ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œå³ä½¿æ˜¯åœ¨æ•°æ®åº“å®•æœºã€åº”ç”¨ç¨‹åºé€€å‡ºç­‰ç­‰è¿™äº›å¼‚å¸¸æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šå‡ºç°ï¼Œåªæ›´æ–°äº†ä¸€ä¸ªè¡¨è€Œå¦ä¸€ä¸ªè¡¨æ²¡æ›´æ–°çš„æƒ…å†µã€‚è¿™æ˜¯äº‹åŠ¡çš„<strong>åŸå­æ€§ï¼ˆAtomicï¼‰</strong>ã€‚</p><p>äº‹åŠ¡è¿˜å¯ä»¥ä¿è¯ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼ˆ888æµæ°´ä¸å­˜åœ¨ï¼Œä½™é¢æ˜¯100å…ƒï¼‰è½¬æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼ˆ888æµæ°´å­˜åœ¨ï¼Œä½™é¢æ˜¯200å…ƒï¼‰ã€‚å¯¹äºå…¶ä»–äº‹åŠ¡æ¥è¯´ï¼Œä¸å­˜åœ¨ä»»ä½•ä¸­é—´çŠ¶æ€ï¼ˆ888æµæ°´å­˜åœ¨ï¼Œä½†ä½™é¢æ˜¯100å…ƒï¼‰ã€‚</p><p>å…¶ä»–äº‹åŠ¡ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªæ—¶åˆ»ï¼Œå¦‚æœå®ƒè¯»åˆ°çš„æµæ°´ä¸­æ²¡æœ‰888è¿™æ¡æµæ°´è®°å½•ï¼Œå®ƒè¯»å‡ºæ¥çš„ä½™é¢ä¸€å®šæ˜¯100å…ƒï¼Œè¿™æ˜¯äº¤æ˜“å‰çš„çŠ¶æ€ã€‚å¦‚æœå®ƒèƒ½è¯»åˆ°888è¿™æ¡æµæ°´è®°å½•ï¼Œå®ƒè¯»å‡ºæ¥çš„ä½™é¢ä¸€å®šæ˜¯200å…ƒï¼Œè¿™æ˜¯äº¤æ˜“ä¹‹åçš„çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡ä¿è¯æˆ‘ä»¬è¯»åˆ°çš„æ•°æ®ï¼ˆäº¤æ˜“å’Œæµæ°´ï¼‰æ€»æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯äº‹åŠ¡çš„<strong>ä¸€è‡´æ€§(Consistency)</strong>ã€‚</p><p>å®é™…ä¸Šï¼Œè¿™ä¸ªäº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹æ— è®ºå¤šå¿«ï¼Œå®ƒéƒ½æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œé‚£ä¿®æ”¹æµæ°´è¡¨å’Œä½™é¢è¡¨å¯¹åº”çš„æ•°æ®ï¼Œä¹Ÿä¼šæœ‰å…ˆåã€‚é‚£ä¸€å®šå­˜åœ¨ä¸€ä¸ªæ—¶åˆ»ï¼Œæµæ°´æ›´æ–°äº†ï¼Œä½†æ˜¯ä½™é¢è¿˜æ²¡æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªäº‹åŠ¡çš„ä¸­é—´çŠ¶æ€æ˜¯äº‹å®å­˜åœ¨çš„ã€‚</p><p>æ•°æ®åº“ä¸ºäº†å®ç°ä¸€è‡´æ€§ï¼Œå¿…é¡»ä¿è¯æ¯ä¸ªäº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸­é—´çŠ¶æ€å¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚æ¯”å¦‚è¯´æˆ‘ä»¬åœ¨äº‹åŠ¡Aä¸­ï¼Œå†™å…¥äº†888è¿™æ¡æµæ°´ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æäº¤äº‹åŠ¡ï¼Œé‚£åœ¨å…¶ä»–äº‹åŠ¡ä¸­ï¼Œéƒ½ä¸åº”è¯¥è¯»åˆ°888è¿™æ¡æµæ°´è®°å½•ã€‚è¿™æ˜¯äº‹åŠ¡çš„<strong>éš”ç¦»æ€§(Isolation)</strong>ã€‚</p><p>æœ€åï¼Œåªè¦äº‹åŠ¡æäº¤æˆåŠŸï¼Œæ•°æ®ä¸€å®šä¼šè¢«æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­ï¼Œåç»­å³ä½¿å‘ç”Ÿæ•°æ®åº“å®•æœºï¼Œä¹Ÿä¸ä¼šæ”¹å˜äº‹åŠ¡çš„ç»“æœã€‚è¿™æ˜¯äº‹åŠ¡çš„<strong>æŒä¹…æ€§(Durability)</strong>ã€‚</p><p>ä½ ä¼šå‘ç°ï¼Œæˆ‘ä¸Šé¢è®²çš„å°±æ˜¯äº‹åŠ¡çš„<strong>ACID</strong>å››ä¸ªåŸºæœ¬ç‰¹æ€§ã€‚ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™å››ä¸ªç‰¹æ€§ä¹‹é—´æ˜¯ç´§å¯†å…³è”åœ¨ä¸€èµ·çš„ï¼Œä¸ç”¨å»çº ç»“æ¯ä¸€ä¸ªç‰¹æ€§çš„ä¸¥æ ¼å®šä¹‰ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£äº‹åŠ¡çš„è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç³»ç»Ÿåœ¨ä½¿ç”¨äº‹åŠ¡çš„æ—¶å€™ï¼Œå„ç§æƒ…å†µä¸‹ï¼Œäº‹åŠ¡å¯¹ä½ çš„æ•°æ®ä¼šäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œè¿™æ˜¯ä½¿ç”¨äº‹åŠ¡çš„å…³é”®ã€‚</p><h2>ç†è§£äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</h2><p>æœ‰äº†æ•°æ®åº“çš„äº‹åŠ¡æœºåˆ¶ï¼Œåªè¦ç¡®ä¿æ¯ä¸€ç¬”äº¤æ˜“éƒ½åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œæˆ‘ä»¬çš„è´¦æˆ·ç³»ç»Ÿå°±å¾ˆå®¹æ˜“ä¿è¯æµæ°´å’Œä½™é¢æ•°æ®çš„ä¸€è‡´æ€§ã€‚ä½†æ˜¯ï¼ŒACIDæ˜¯ä¸€ä¸ªéå¸¸ä¸¥æ ¼çš„å®šä¹‰ï¼Œæˆ–è€…è¯´æ˜¯ç†æƒ³çš„æƒ…å†µã€‚å¦‚æœè¦å®Œå…¨æ»¡è¶³ACIDï¼Œä¸€ä¸ªæ•°æ®åº“çš„æ‰€æœ‰äº‹åŠ¡å’ŒSQLéƒ½åªèƒ½ä¸²è¡Œæ‰§è¡Œï¼Œè¿™ä¸ªæ€§èƒ½è‚¯å®šæ˜¯ä¸èƒ½æ»¡è¶³ä¸€èˆ¬ç³»ç»Ÿçš„è¦æ±‚çš„ã€‚</p><p>å¯¹è´¦æˆ·ç³»ç»Ÿå’Œå…¶ä»–å¤§å¤šæ•°äº¤æ˜“ç³»ç»Ÿæ¥è¯´ï¼Œäº‹åŠ¡çš„åŸå­æ€§å’ŒæŒä¹…æ€§æ˜¯å¿…é¡»è¦ä¿è¯çš„ï¼Œå¦åˆ™å°±å¤±å»äº†ä½¿ç”¨äº‹åŠ¡çš„æ„ä¹‰ï¼Œè€Œä¸€è‡´æ€§å’Œéš”ç¦»æ€§å…¶å®å¯ä»¥åšé€‚å½“ç‰ºç‰²ï¼Œæ¥æ¢å–æ€§èƒ½ã€‚æ‰€ä»¥ï¼ŒMySQLæä¾›äº†å››ç§éš”ç¦»çº§åˆ«ï¼Œå…·ä½“æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¡¨ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/3e/3c37eff420c7a9e41e6121ff491c8c3e.jpg?wh=4266*2329\" alt=\"\"></p><p>å‡ ä¹æ‰€æœ‰è®²MySQLçš„äº‹åŠ¡éš”ç¦»çº§åˆ«çš„æ–‡ç« é‡Œé¢ï¼Œéƒ½æœ‰è¿™ä¸ªè¡¨ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½å…ä¿—ï¼Œå› ä¸ºè¿™ä¸ªè¡¨å¤ªç»å…¸äº†ã€‚å¾ˆå¤šåŒå­¦çœ‹è¿™ä¸ªè¡¨çš„æ—¶å€™ï¼Œé¢å¯¹è¿™ä¹ˆå¤šæ¦‚å¿µéƒ½æœ‰ç‚¹å„¿æ™•ï¼Œç¡®å®ä¸å¤ªå¥½ç†è§£ã€‚æˆ‘æ¥è·Ÿä½ è¯´ä¸€ä¸‹æ€ä¹ˆæ¥æŠŠè¿™å››ç§éš”ç¦»çº§åˆ«ææ¸…æ¥šï¼Œé‡ç‚¹åœ¨å“ªé‡Œã€‚</p><p>è¿™ä¸ªè¡¨é‡Œé¢è‡ªä¸Šåˆ°ä¸‹ï¼Œä¸€å…±æœ‰å››ç§éš”ç¦»çº§åˆ«ï¼šRUã€RCã€RRå’ŒSERIALIZABLEï¼Œè¿™å››ç§çº§åˆ«çš„éš”ç¦»æ€§è¶Šæ¥è¶Šä¸¥æ ¼ï¼Œæ€§èƒ½ä¹Ÿè¶Šæ¥è¶Šå·®ï¼Œåœ¨MySQLä¸­é»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯RRï¼Œå¯é‡å¤è¯»ã€‚</p><p>å…ˆè¯´ä¸¤ç§ä¸å¸¸ç”¨çš„ï¼Œç¬¬ä¸€ç§RUçº§åˆ«ï¼Œå®é™…ä¸Šå°±æ˜¯å®Œå…¨ä¸éš”ç¦»ã€‚æ¯ä¸ªè¿›è¡Œä¸­äº‹åŠ¡çš„ä¸­é—´çŠ¶æ€ï¼Œå¯¹å…¶ä»–äº‹åŠ¡éƒ½æ˜¯å¯è§çš„ï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå‡ºç°â€œè„è¯»â€ã€‚æˆ‘ä»¬ä¸Šä¸€ä¸ªå°èŠ‚å……å€¼çš„ä¾‹å­ä¸­ï¼Œè¯»åˆ°äº†888è¿™æ¡æµæ°´ï¼Œä½†ä½™é¢è¿˜æ˜¯è½¬è´¦ä¹‹å‰çš„100å…ƒï¼Œè¿™ç§æƒ…å†µå°±æ˜¯è„è¯»ã€‚è¿™ç§çº§åˆ«è™½ç„¶æ€§èƒ½å¥½ï¼Œä½†æ˜¯å­˜åœ¨è„è¯»çš„å¯èƒ½ï¼Œå¯¹åº”ç”¨ç¨‹åºæ¥è¯´æ¯”è¾ƒéš¾å¤„ç†ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ç”¨ã€‚</p><p>ç¬¬å››ç§â€œåºåˆ—åŒ–â€çº§åˆ«ï¼Œå…·å¤‡å®Œç¾çš„â€œéš”ç¦»æ€§â€å’Œâ€œä¸€è‡´æ€§â€ï¼Œæ€§èƒ½æœ€å·®ï¼Œä¹Ÿå¾ˆå°‘ä¼šç”¨åˆ°ã€‚</p><p>å¸¸ç”¨çš„éš”ç¦»çº§åˆ«å…¶å®å°±æ˜¯RCå’ŒRRä¸¤ç§ï¼Œå…¶ä¸­MySQLé»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯RRã€‚è¿™ä¸¤ç§éš”ç¦»çº§åˆ«éƒ½å¯ä»¥é¿å…è„è¯»ï¼Œèƒ½å¤Ÿä¿è¯åœ¨å…¶ä»–äº‹åŠ¡ä¸­æ˜¯ä¸ä¼šè¯»åˆ°æœªæäº¤äº‹åŠ¡çš„æ•°æ®ï¼Œæˆ–è€…é€šä¿—åœ°è¯´ï¼Œ<strong>åªè¦ä½ çš„äº‹åŠ¡æ²¡æœ‰æäº¤ï¼Œé‚£è¿™ä¸ªäº‹åŠ¡å¯¹æ•°æ®åšå‡ºçš„æ›´æ–°ï¼Œå¯¹å…¶ä»–ä¼šè¯æ˜¯ä¸å¯è§çš„ï¼Œå®ƒä»¬è¯»åˆ°çš„è¿˜æ˜¯ä½ è¿™ä¸ªäº‹åŠ¡æ›´æ–°ä¹‹å‰çš„æ•°æ®</strong>ã€‚</p><p>RCå’ŒRRå”¯ä¸€çš„åŒºåˆ«åœ¨äºâ€œæ˜¯å¦å¯é‡å¤è¯»â€ï¼Œè¿™ä¸ªæ¦‚å¿µä¹Ÿæœ‰ç‚¹å„¿ç»•å£ï¼Œä½†å…¶å®ä¹Ÿå¾ˆç®€å•ã€‚</p><p><strong>åœ¨ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå®ƒèƒ½ä¸èƒ½è¯»åˆ°å…¶ä»–å·²æäº¤äº‹åŠ¡å¯¹æ•°æ®çš„æ›´æ–°ï¼Œå¦‚æœèƒ½è¯»åˆ°æ•°æ®å˜åŒ–ï¼Œå°±æ˜¯â€œä¸å¯é‡å¤è¯»â€ï¼Œå¦åˆ™å°±æ˜¯â€œå¯é‡å¤è¯»â€</strong>ã€‚</p><p>æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æŠŠäº‹åŠ¡çš„éš”ç¦»çº§åˆ«è®¾ä¸ºRCã€‚ä¼šè¯Aå¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œè¯»åˆ°IDä¸º0çš„è´¦æˆ·ï¼Œå½“å‰è´¦æˆ·ä½™é¢æ˜¯100å…ƒã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ A\nmysql&gt; -- ç¡®è®¤å½“å‰è®¾ç½®çš„éš”ç¦»çº§åˆ«æ˜¯RC\nmysql&gt; SELECT @@global.transaction_isolation, @@transaction_isolation;\n+--------------------------------+-------------------------+\n| @@global.transaction_isolation | @@transaction_isolation |\n+--------------------------------+-------------------------+\n| READ-COMMITTED                 | READ-COMMITTED          |\n+--------------------------------+-------------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; begin;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; select log_id, amount, timestamp  from account_log  order by log_id;\n+--------+--------+---------------------+\n| log_id | amount | timestamp           |\n+--------+--------+---------------------+\n|      3 |    100 | 2020-02-07 09:40:37 |\n+--------+--------+---------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; select * from account_balance;  -- è´¦æˆ·ä½™é¢æ˜¯100å…ƒï¼›\n+---------+---------+---------------------+--------+\n| user_id | balance | timestamp           | log_id |\n+---------+---------+---------------------+--------+\n|       0 |     100 | 2020-02-07 09:47:39 |      3 |\n+---------+---------+---------------------+--------+\n1 row in set (0.00 sec)\n</code></pre><p>è¿™æ—¶å€™å¦å¤–ä¸€ä¸ªä¼šè¯Bï¼Œå¯¹è¿™ä¸ªè´¦æˆ·å®Œæˆäº†ä¸€ç¬”è½¬è´¦äº¤æ˜“ï¼Œå¹¶ä¸”æäº¤äº†äº‹åŠ¡ã€‚æŠŠè´¦æˆ·ä½™é¢æ›´æ–°æˆäº†200å…ƒã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ B\nmysql&gt; begin;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; select log_id, amount, timestamp  from account_log  order by log_id;\n+--------+--------+---------------------+\n| log_id | amount | timestamp           |\n+--------+--------+---------------------+\n|      3 |    100 | 2020-02-07 09:40:37 |\n+--------+--------+---------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; -- å†™å…¥æµæ°´\nmysql&gt; insert into account_log values (NULL, 100, NOW(), 1, 1001, NULL, 0, NULL, 0, 0);\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; -- æ›´æ–°ä½™é¢\nmysql&gt; update account_balance\n    -&gt; set balance = balance + 100, log_id = LAST_INSERT_ID(), timestamp = NOW()\n    -&gt; where user_id = 0 and log_id = 3;\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\nmysql&gt; -- å½“å‰è´¦æˆ·æœ‰2æ¡æµæ°´è®°å½•\nmysql&gt; select log_id, amount, timestamp  from account_log  order by log_id;\n+--------+--------+---------------------+\n| log_id | amount | timestamp           |\n+--------+--------+---------------------+\n|      3 |    100 | 2020-02-07 09:40:37 |\n|      4 |    100 | 2020-02-07 10:06:15 |\n+--------+--------+---------------------+\n2 rows in set (0.00 sec)\n\nmysql&gt; -- å½“å‰è´¦æˆ·ä½™é¢æ˜¯200å…ƒï¼›\nmysql&gt; select * from account_balance;\n+---------+---------+---------------------+--------+\n| user_id | balance | timestamp           | log_id |\n+---------+---------+---------------------+--------+\n|       0 |     200 | 2020-02-07 10:06:16 |      4 |\n+---------+---------+---------------------+--------+\n1 row in set (0.00 sec)\nmysql&gt; commit;\nQuery OK, 0 rows affected (0.00 sec)\n\n</code></pre><p>æ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™ä¼šè¯Aä¹‹å‰å¼€å¯çš„äº‹åŠ¡æ˜¯ä¸€ç›´æœªå…³é—­çš„ã€‚æˆ‘ä»¬å†æ¥ä¼šè¯Aä¸­çœ‹ä¸€ä¸‹è´¦æˆ·çš„ä½™é¢ï¼Œä½ è§‰å¾—åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®é™…çš„ç»“æœã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ A\nmysql&gt; -- å½“å‰è´¦æˆ·æœ‰2æ¡æµæ°´è®°å½•\nmysql&gt; select log_id, amount, timestamp  from account_log  order by log_id;\n+--------+--------+---------------------+\n| log_id | amount | timestamp           |\n+--------+--------+---------------------+\n|      3 |    100 | 2020-02-07 09:40:37 |\n|      4 |    100 | 2020-02-07 10:06:15 |\n+--------+--------+---------------------+\n2 rows in set (0.00 sec)\n\nmysql&gt; -- å½“å‰è´¦æˆ·ä½™é¢æ˜¯200å…ƒï¼›\nmysql&gt; select * from account_balance;\n+---------+---------+---------------------+--------+\n| user_id | balance | timestamp           | log_id |\n+---------+---------+---------------------+--------+\n|       0 |     200 | 2020-02-07 10:06:16 |      4 |\n+---------+---------+---------------------+--------+\n1 row in set (0.00 sec)\nmysql&gt; commit;\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æŠŠéš”ç¦»çº§åˆ«è®¾ç½®ä¸ºRCæ—¶ï¼Œä¼šè¯Aç¬¬äºŒæ¬¡è¯»åˆ°çš„è´¦æˆ·ä½™é¢æ˜¯200å…ƒï¼Œä¹Ÿå°±æ˜¯ä¼šè¯Bæ›´æ–°åçš„æ•°æ®ã€‚å¯¹äºä¼šè¯Aæ¥è¯´ï¼Œ<strong>åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…ä¸¤æ¬¡è¯»å–åŒä¸€æ¡æ•°æ®ï¼Œè¯»åˆ°çš„ç»“æœå¯èƒ½ä¼šä¸ä¸€æ ·ï¼Œè¿™å°±æ˜¯â€œä¸å¯é‡å¤è¯»â€</strong>ã€‚</p><p>å¦‚æœæŠŠéš”ç¦»çº§åˆ«è®¾ç½®ä¸ºRRï¼Œä¼šè¯Aç¬¬äºŒæ¬¡è¯»åˆ°çš„è´¦æˆ·ä½™é¢ä»ç„¶æ˜¯100å…ƒï¼Œäº¤æ˜“æµæ°´ä¹Ÿåªæœ‰ä¸€æ¡è®°å½•ã€‚<strong>åœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡è¿›è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹äºåŒä¸€æ¡æ•°æ®ï¼Œæ¯æ¬¡è¯»åˆ°çš„ç»“æœæ€»æ˜¯ç›¸åŒçš„ï¼Œæ— è®ºå…¶ä»–ä¼šè¯æ˜¯å¦å·²ç»æ›´æ–°äº†è¿™æ¡æ•°æ®</strong>ï¼Œ<strong>è¿™å°±æ˜¯â€œå¯é‡å¤è¯»â€ã€‚</strong></p><p>ç†è§£äº†RCå’ŒRRè¿™ä¸¤ç§éš”ç¦»çº§åˆ«çš„åŒºåˆ«ï¼Œå°±è¶³å¤Ÿåº”å¯¹ç»å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯äº†ã€‚</p><p>æœ€åï¼Œæˆ‘æ¥ç®€å•è¯´ä¸€ä¸‹â€œå¹»è¯»â€ã€‚åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œå¾ˆå°‘èƒ½é‡åˆ°å¹»è¯»ï¼Œå³ä½¿é‡åˆ°ï¼Œä¹ŸåŸºæœ¬ä¸ä¼šå½±å“åˆ°æ•°æ®å‡†ç¡®æ€§ï¼Œæ‰€ä»¥ä½ ç®€å•äº†è§£ä¸€ä¸‹å³å¯ã€‚åœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œæˆ‘ä»¬å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¹‹åç›´åˆ°è¿™ä¸ªäº‹åŠ¡ç»“æŸï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡å†…å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®çš„æ›´æ–°æ˜¯ä¸å¯è§çš„ï¼Œè¿™ä¸ªæˆ‘ä»¬åˆšåˆšè®²è¿‡ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬åœ¨ä¼šè¯Aä¸­å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå‡†å¤‡æ’å…¥ä¸€æ¡IDä¸º1000çš„æµæ°´è®°å½•ã€‚æŸ¥è¯¢ä¸€ä¸‹å½“å‰æµæ°´ï¼Œä¸å­˜åœ¨IDä¸º1000çš„è®°å½•ï¼Œå¯ä»¥å®‰å…¨åœ°æ’å…¥æ•°æ®ã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ A\nmysql&gt; select log_id from account_log where log_id = 1000;\nEmpty set (0.00 sec)\n</code></pre><p>è¿™æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªä¼šè¯æŠ¢å…ˆæ’å…¥äº†è¿™æ¡IDä¸º1000çš„æµæ°´è®°å½•ã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ B\nmysql&gt; begin;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; insert into account_log values\n    -&gt; (1000, 100, NOW(), 1, 1001, NULL, 0, NULL, 0, 0);\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; commit;\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre><p>ç„¶åä¼šè¯Aå†æ‰§è¡Œç›¸åŒçš„æ’å…¥è¯­å¥æ—¶ï¼Œå°±ä¼šæŠ¥ä¸»é”®å†²çªé”™è¯¯ï¼Œä½†æ˜¯ç”±äºäº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œå®ƒæ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œå´æŸ¥ä¸åˆ°è¿™æ¡IDä¸º1000çš„æµæ°´ï¼Œå°±åƒå‡ºç°äº†â€œå¹»è§‰â€ä¸€æ ·ï¼Œè¿™å°±æ˜¯å¹»è¯»ã€‚</p><pre><code>mysql&gt; -- ä¼šè¯ A\nmysql&gt; insert into account_log values\n    -&gt; (1000, 100, NOW(), 1, 1001, NULL, 0, NULL, 0, 0);\nERROR 1062 (23000): Duplicate entry '1000' for key 'account_log.PRIMARY'\nmysql&gt; select log_id from account_log where log_id = 1000;\nEmpty set (0.00 sec)\n</code></pre><p>ç†è§£äº†è¿™å‡ ç§éš”ç¦»çº§åˆ«ï¼Œæœ€åæˆ‘ä»¬ç»™å‡ºä¸€ç§å…¼é¡¾å¹¶å‘ã€æ€§èƒ½å’Œæ•°æ®ä¸€è‡´æ€§çš„äº¤æ˜“å®ç°ã€‚è¿™ä¸ªå®ç°åœ¨éš”ç¦»çº§åˆ«ä¸ºRCå’ŒRRæ—¶ï¼Œéƒ½æ˜¯å®‰å…¨çš„ã€‚</p><ol>\n<li>æˆ‘ä»¬ç»™è´¦æˆ·ä½™é¢è¡¨å¢åŠ ä¸€ä¸ªlog_idå±æ€§ï¼Œè®°å½•æœ€åä¸€ç¬”äº¤æ˜“çš„æµæ°´å·ã€‚</li>\n<li>é¦–å…ˆå¼€å¯äº‹åŠ¡ï¼ŒæŸ¥è¯¢å¹¶è®°å½•å½“å‰è´¦æˆ·çš„ä½™é¢å’Œæœ€åä¸€ç¬”äº¤æ˜“çš„æµæ°´å·ã€‚</li>\n<li>ç„¶åå†™å…¥æµæ°´è®°å½•ã€‚</li>\n<li>å†æ›´æ–°è´¦æˆ·ä½™é¢ï¼Œéœ€è¦åœ¨æ›´æ–°è¯­å¥çš„WHEREæ¡ä»¶ä¸­é™å®šï¼Œåªæœ‰æµæ°´å·ç­‰äºä¹‹å‰æŸ¥è¯¢å‡ºçš„æµæ°´å·æ—¶æ‰æ›´æ–°ã€‚</li>\n<li>ç„¶åæ£€æŸ¥æ›´æ–°ä½™é¢çš„è¿”å›å€¼ï¼Œå¦‚æœæ›´æ–°æˆåŠŸå°±æäº¤äº‹åŠ¡ï¼Œå¦åˆ™å›æ»šäº‹åŠ¡ã€‚</li>\n</ol><p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ›´æ–°è´¦æˆ·ä½™é¢åï¼Œä¸èƒ½åªæ£€æŸ¥æ›´æ–°è¯­å¥æ˜¯ä¸æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œè¿˜éœ€è¦æ£€æŸ¥è¿”å›å€¼ä¸­å˜æ›´çš„è¡Œæ•°æ˜¯ä¸æ˜¯ç­‰äº1ã€‚å› ä¸ºå³ä½¿æµæ°´å·ä¸ç›¸ç­‰ï¼Œä½™é¢æ²¡æœ‰æ›´æ–°ï¼Œè¿™æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œç»“æœä»ç„¶æ˜¯æˆåŠŸçš„ï¼Œåªæ˜¯æ›´æ–°äº†0æ¡è®°å½•ã€‚</p><p>ä¸‹é¢æ˜¯æ•´ä¸ªäº¤æ˜“çš„SQLï¼Œä¾›ä½ å‚è€ƒï¼š</p><pre><code>mysql&gt; begin;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt;  -- æŸ¥è¯¢å½“å‰è´¦æˆ·çš„ä½™é¢å’Œæœ€åä¸€ç¬”äº¤æ˜“çš„æµæ°´å·ã€‚\nmysql&gt; select balance, log_id from account_balance where user_id = 0;\n+---------+--------+\n| balance | log_id |\n+---------+--------+\n|     100 |      3 |\n+---------+--------+\n1 row in set (0.00 sec)\n\nmysql&gt;  -- æ’å…¥æµæ°´è®°å½•ã€‚\nmysql&gt; insert into account_log values\n    -&gt; (NULL, 100, NOW(), 1, 1001, NULL, 0, NULL, 0, 0);\nQuery OK, 1 row affected (0.01 sec)\n\nmysql&gt;  -- æ›´æ–°ä½™é¢ï¼Œæ³¨æ„whereæ¡ä»¶ä¸­ï¼Œé™å®šäº†åªæœ‰æµæ°´å·ç­‰äºä¹‹å‰æŸ¥è¯¢å‡ºçš„æµæ°´å·3æ—¶æ‰æ›´æ–°ã€‚\nmysql&gt; update account_balance\n    -&gt; set balance = balance + 100, log_id = LAST_INSERT_ID(), timestamp = NOW()\n    -&gt; where user_id = 0 and log_id = 3;\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\nmysql&gt;  -- è¿™é‡Œéœ€è¦æ£€æŸ¥æ›´æ–°ç»“æœï¼Œåªæœ‰æ›´æ–°ä½™é¢æˆåŠŸï¼ˆChanged: 1ï¼‰æ‰æäº¤äº‹åŠ¡ï¼Œå¦åˆ™å›æ»šäº‹åŠ¡ã€‚\nmysql&gt; commit;\nQuery OK, 0 rows affected (0.01 sec)\n</code></pre><p>æœ€åï¼Œæˆ‘ç»™å‡ºæµæ°´å’Œä½™é¢ä¸¤ä¸ªè¡¨çš„DDLï¼Œä½ è‡ªå·±æ‰§è¡Œä¾‹å­çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ã€‚</p><pre><code>CREATE TABLE `account_log` (\n  `log_id` int NOT NULL AUTO_INCREMENT COMMENT 'æµæ°´å·',\n  `amount` int NOT NULL COMMENT 'äº¤æ˜“é‡‘é¢',\n  `timestamp` datetime NOT NULL COMMENT 'æ—¶é—´æˆ³',\n  `from_system` int NOT NULL COMMENT 'è½¬å‡ºç³»ç»Ÿç¼–ç ',\n  `from_system_transaction_number` int DEFAULT NULL COMMENT 'è½¬å‡ºç³»ç»Ÿçš„äº¤æ˜“å·',\n  `from_account` int DEFAULT NULL COMMENT 'è½¬å‡ºè´¦æˆ·',\n  `to_system` int NOT NULL COMMENT 'è½¬å…¥ç³»ç»Ÿç¼–ç ',\n  `to_system_transaction_number` int DEFAULT NULL COMMENT 'è½¬å…¥ç³»ç»Ÿçš„äº¤æ˜“å·',\n  `to_account` int DEFAULT NULL COMMENT 'è½¬å…¥è´¦æˆ·',\n  `transaction_type` int NOT NULL COMMENT 'äº¤æ˜“ç±»å‹ç¼–ç ',\n  PRIMARY KEY (`log_id`)\n);\n\n\nCREATE TABLE `account_balance` (\n  `user_id` int NOT NULL COMMENT 'ç”¨æˆ·ID',\n  `balance` int NOT NULL COMMENT 'ä½™é¢',\n  `timestamp` datetime NOT NULL COMMENT 'æ—¶é—´æˆ³',\n  `log_id` int NOT NULL COMMENT 'æœ€åä¸€ç¬”äº¤æ˜“çš„æµæ°´å·',\n  PRIMARY KEY (`user_id`)\n);\n</code></pre><h2>å°ç»“</h2><p>è´¦æˆ·ç³»ç»Ÿç”¨äºè®°å½•æ¯ä¸ªç”¨æˆ·çš„ä½™é¢ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å¯è¿½æº¯æ€§ï¼Œè¿˜éœ€è¦è®°å½•è´¦æˆ·æµæ°´ã€‚æµæ°´è®°å½•åªèƒ½æ–°å¢ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å…è®¸ä¿®æ”¹å’Œåˆ é™¤ï¼Œæ¯æ¬¡äº¤æ˜“çš„æ—¶å€™éœ€è¦æŠŠæµæ°´å’Œä½™é¢æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ä¸€èµ·æ›´æ–°ã€‚</p><p>äº‹åŠ¡å…·å¤‡åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§å››ç§åŸºæœ¬ç‰¹æ€§ï¼Œä¹Ÿå°±æ˜¯ACIDï¼Œå®ƒå¯ä»¥ä¿è¯åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œçš„æ•°æ®æ›´æ–°ï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚å¹¶ä¸”åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸­é—´çŠ¶æ€çš„æ•°æ®å¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</p><p>ACIDæ˜¯ä¸€ç§ç†æƒ³æƒ…å†µï¼Œç‰¹åˆ«æ˜¯è¦å®Œç¾åœ°å®ç°CIï¼Œä¼šå¯¼è‡´æ•°æ®åº“æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼Œæ‰€ä»¥MySQLæä¾›çš„å››ç§å¯é€‰çš„éš”ç¦»çº§åˆ«ï¼Œç‰ºç‰²ä¸€å®šçš„éš”ç¦»æ€§å’Œä¸€è‡´æ€§ï¼Œç”¨äºæ¢å–é«˜æ€§èƒ½ã€‚è¿™å››ç§éš”ç¦»çº§åˆ«ä¸­ï¼Œåªæœ‰RCå’ŒRRè¿™ä¸¤ç§éš”ç¦»çº§åˆ«æ˜¯å¸¸ç”¨çš„ï¼Œå®ƒä»¬çš„å”¯ä¸€åŒºåˆ«æ˜¯åœ¨è¿›è¡Œçš„äº‹åŠ¡ä¸­ï¼Œå…¶ä»–äº‹åŠ¡å¯¹æ•°æ®çš„æ›´æ–°æ˜¯å¦å¯è§ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯¾åå¸Œæœ›ä½ èƒ½åŠ¨æ‰‹æ‰§è¡Œä¸€ä¸‹æˆ‘ä»¬ä»Šå¤©è¿™èŠ‚è¯¾ä¸­ç»™å‡ºçš„ä¾‹å­ï¼Œçœ‹ä¸€ä¸‹å¤šä¸ªäº‹åŠ¡å¹¶å‘æ›´æ–°åŒä¸€ä¸ªè´¦æˆ·æ—¶ï¼ŒRCå’ŒRRä¸¤ç§ä¸åŒçš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¡Œä¸ºä¸Šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘è®¨è®ºï¼Œå¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"03 | å¤æ‚è€Œåˆé‡è¦çš„è´­ç‰©è½¦ç³»ç»Ÿï¼Œåº”è¯¥å¦‚ä½•è®¾è®¡ï¼Ÿ","id":206061},"right":{"article_title":"05 | åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä¿è¯å¤šä¸ªç³»ç»Ÿé—´çš„æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Ÿ","id":207508}},"comments":[{"had_liked":false,"id":184636,"user_name":"æç¥","can_delete":false,"product_type":"c1","uid":1501046,"ip_address":"","ucode":"B19E91EE248591","user_header":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","comment_is_top":true,"comment_ctime":1583375713,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"9.2233723347908997e+18","product_id":100046801,"comment_content":"hiï¼Œæˆ‘æ˜¯æç¥ã€‚<br><br>æˆ‘ä»¬è¿˜æ˜¯å›é¡¾ä¸€ä¸‹ä¸ŠèŠ‚è¯¾ç•™çš„æ€è€ƒé¢˜ï¼Œæ˜¯è¿™æ ·çš„ã€‚<br><br>æ—¢ç„¶ç”¨æˆ·çš„è´­ç‰©è½¦æ•°æ®å­˜æ”¾åœ¨MySQLæˆ–è€…æ˜¯Redisä¸­å„æœ‰ä¼˜åŠ£åŠ¿ã€‚é‚£èƒ½ä¸èƒ½æŠŠè´­ç‰©è½¦æ•°æ®å­˜åœ¨MySQLä¸­ï¼Œå¹¶ä¸”ç”¨Redisæ¥åšç¼“å­˜å‘¢ï¼Ÿè¿™æ ·ä¸å°±å¯ä»¥å…¼é¡¾ä¸¤è€…çš„ä¼˜åŠ¿äº†ä¹ˆï¼Ÿè¿™æ ·åšæ˜¯ä¸æ˜¯å¯è¡Œï¼Ÿå¦‚æœå¯è¡Œï¼Œå¦‚ä½•æ¥ä¿è¯Redisä¸­çš„æ•°æ®å’ŒMySQLä¸­çš„æ•°æ®æ˜¯ä¸€æ ·çš„å‘¢ï¼Ÿ<br><br>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘è¿™æ ·çœ‹ã€‚<br><br>ç”¨Redisç»™è´­ç‰©è½¦åº“åšç¼“å­˜ï¼ŒæŠ€æœ¯ä¸Šè‚¯å®šæ˜¯å¯è¡Œçš„ã€‚ä½†æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦æ€è€ƒä¸€ä¸‹ã€‚<br><br>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå€¼ä¸å€¼å¾—è¿™æ ·åšï¼Ÿå› ä¸ºæ¯ä¸ªäººçš„è´­ç‰©è½¦éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™ä¸ªç¼“å­˜å®ƒçš„è¯»å†™æ¯”å·®è·ä¸ä¼šå¾ˆå¤§ï¼Œç¼“å­˜çš„å‘½ä¸­ç‡ä¸ä¼šå¤ªé«˜ï¼Œç¼“å­˜çš„æ”¶ç›Šæœ‰é™ï¼Œä¸ºäº†ç»´æŠ¤ç¼“å­˜ï¼Œè¿˜è¦å¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è¦è‡ªè¡Œæƒè¡¡ä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯å€¼å¾—çš„é—®é¢˜ã€‚æˆ‘çš„è§‚ç‚¹æ˜¯ï¼Œé™¤äº†è¶…å¤§è§„æ¨¡çš„ç³»ç»Ÿä»¥å¤–ï¼Œæ²¡æœ‰å¿…è¦è®¾ç½®è¿™ä¸ªç¼“å­˜ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éè¦åšè¿™æ ·ä¸€ä¸ªç¼“å­˜ï¼Œç”¨ä»€ä¹ˆç¼“å­˜æ›´æ–°ç­–ç•¥æ›´å¥½å‘¢ï¼Ÿè¿™é‡Œæˆ‘å…ˆå–ä¸ªå…³å­ï¼Œåœ¨ã€Š11 | MySQLå¦‚ä½•åº”å¯¹é«˜å¹¶å‘ï¼ˆä¸€ï¼‰ï¼šä½¿ç”¨ç¼“å­˜ä¿æŠ¤MySQLã€‹è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šä¸“é—¨è®²åˆ°å‡ ç§å¸¸ç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œä½ å¯ä»¥å­¦å®Œè¿™èŠ‚è¯¾ä¹‹åï¼Œå†å›è¿‡å¤´æ¥æƒ³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚","like_count":68,"discussions":[{"author":{"id":3206657,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ee/01/2ecf51b0.jpg","nickname":"Catcher","note":"","ucode":"5BEFBEE3D367A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591216,"discussion_content":"åœ¨è´­ç‰©è½¦ä¿¡æ¯æ›´æ–°æ—¶ï¼Œæ›´æ–°ç¼“å­˜ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666404190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1500391,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e4/e7/31944ee7.jpg","nickname":"åƒå†›ä¸‡é©¬ä¸‡é©¬@","note":"","ucode":"0BDAD22123435A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556053,"discussion_content":"ç«Ÿç„¶å–å…³å­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647181282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184578,"user_name":"è§‚å¼ˆé“äºº","can_delete":false,"product_type":"c1","uid":1016905,"ip_address":"","ucode":"F3BB619A33C605","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/49/47d48fd0.jpg","comment_is_top":false,"comment_ctime":1583363758,"is_pvip":false,"discussion_count":13,"race_medal":0,"score":"242101532334","product_id":100046801,"comment_content":"è¿™ç¯‡è®²äº‹åŠ¡çš„æ–‡ç« ï¼Œæ˜¯é‡åˆ°çš„è®²çš„æœ€æ¸…æ¥šæ˜ç™½ã€æ°åˆ°å¥½å¤„çš„ä¸€ç¯‡ï¼Œæ²¡æœ‰æçœ‹ä¼¼æ›´æœ¬è´¨ã€æ›´å”¬äººçš„å„ç§é”ï¼Œæ¯”å¦‚é—´éš™é”ç­‰ï¼Œå¯ä»¥è¯´å¤§éƒ¨äººä¹Ÿéƒ½ä¸èƒ½æ¸…æ¥šç†è§£å„ç§é”ï¼Œå¯¹äºéä¸“èŒdbaç†è§£æ­¤ç¯‡çš„çŸ¥è¯†æŠ€å·§è¶³å¤Ÿäº†ã€‚","like_count":57,"discussions":[{"author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410265,"discussion_content":"å…¶å®å¥½å¥½å­¦ä¹ mysql35è®²å°±ä¸ä¼šè§‰å¾—å„ç§é”æ˜¯ä¸ªå”¬äººçš„ä¸œè¥¿äº†ğŸ˜„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1635646801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1500391,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e4/e7/31944ee7.jpg","nickname":"åƒå†›ä¸‡é©¬ä¸‡é©¬@","note":"","ucode":"0BDAD22123435A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556055,"discussion_content":"åŒæ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647181365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":410265,"ip_address":""},"score":556055,"extra":""}]},{"author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"æµå¹´","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323168,"discussion_content":"ä¸å¯é‡å¤è¯»é’ˆå¯¹çš„æ˜¯å•æ¡è®°å½•çš„æ›´æ–°ï¼Œå¹»è¯»æ˜¯é’ˆå¯¹çš„æ˜¯æ–°æ’å…¥çš„è®°å½•ï¼Œå¹»è¯»çš„è§£å†³ä¸æ­¢é—´éš™é”ï¼Œè¿˜æœ‰ä¸´å»ºé”next-key-lockï¼Œå®ƒå…¼å®¹äº†record lock å’Œgap lockä¿è¯åœ¨å¹¶å‘äº‹åŠ¡æ—¶é”ä½ç´¢å¼•è®°å½•çš„é—´éš™","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604891815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323264,"avatar":"https://static001.geekbang.org/account/avatar/00/14/31/00/b5fd38df.jpg","nickname":"Ling","note":"","ucode":"F16F675C1D1EA9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376234,"discussion_content":"åŒæ„Ÿï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622031342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022127,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/98/af/3945cea4.jpg","nickname":"ä¸€å‰‘","note":"","ucode":"93ADD5B5215D4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199065,"discussion_content":"ç¡®å®ï¼Œè¿™æ˜¯æˆ‘è§è¿‡çš„è®²çš„æœ€å®¹æ˜“æ‡‚ï¼Œæœ€å®ç”¨çš„äº‹åŠ¡ä»‹ç»æ–‡ç« ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583552405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1835642,"avatar":"","nickname":"å¶å­","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1022127,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/98/af/3945cea4.jpg","nickname":"ä¸€å‰‘","note":"","ucode":"93ADD5B5215D4C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222648,"discussion_content":"åªèƒ½è¯´ä½ ä»¬çš„æ¶‰çŒçš„ä¸œè¥¿å¤ªå°‘äº†","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1586165915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":199065,"ip_address":""},"score":222648,"extra":""},{"author":{"id":1500391,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e4/e7/31944ee7.jpg","nickname":"åƒå†›ä¸‡é©¬ä¸‡é©¬@","note":"","ucode":"0BDAD22123435A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1835642,"avatar":"","nickname":"å¶å­","note":"","ucode":"41131155D75B09","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556054,"discussion_content":"åŒæ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647181352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222648,"ip_address":""},"score":556054,"extra":""}]},{"author":{"id":1114684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/02/3c/c9c1ca76.jpg","nickname":"é›ªæµ·è§…éšé¦™","note":"","ucode":"07685DE073FBB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":207608,"discussion_content":"æ˜¯çš„å‘¢ï¼æœ‰ç§é†é†çŒé¡¶çš„æ„Ÿè§‰ï¼Œè®©æˆ‘é‡æ–°è®¤è¯†äº†äº‹ç‰©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584505529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1114684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/02/3c/c9c1ca76.jpg","nickname":"é›ªæµ·è§…éšé¦™","note":"","ucode":"07685DE073FBB9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213915,"discussion_content":"æ„Ÿè§‰æŠŠå¹»è¯»å’Œä¸å¯é‡å¤è¯»æ•´æ˜ç™½äº†","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1585134667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":207608,"ip_address":""},"score":213915,"extra":""},{"author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/3feccf32.jpg","nickname":"Berton.Yip.","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1114684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/02/3c/c9c1ca76.jpg","nickname":"é›ªæµ·è§…éšé¦™","note":"","ucode":"07685DE073FBB9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252269,"discussion_content":"äº‹åŠ¡éš”ç¦»çº§åˆ«, è¦å’Œé”ä¸€èµ·åˆ†æ, å»ºè®®æ·±å…¥, å¦åˆ™, åªçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶å–”.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588146542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":207608,"ip_address":""},"score":252269,"extra":""},{"author":{"id":1729060,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/62/24/07e2507c.jpg","nickname":"æ‰˜å°¼æ–¯å¨ç‰¹","note":"","ucode":"98A1035527292E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/3feccf32.jpg","nickname":"Berton.Yip.","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285788,"discussion_content":"ç¡®å®, è¿˜æ˜¯æƒ³çŸ¥é“æ›´è¿›ä¸€æ­¥, æ€ä¹ˆç”¨é”å®ç°çš„.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592947573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":252269,"ip_address":""},"score":285788,"extra":""}]},{"author":{"id":1190150,"avatar":"https://static001.geekbang.org/account/avatar/00/12/29/06/0b327738.jpg","nickname":"Gankki","note":"","ucode":"399C6F74286590","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199074,"discussion_content":"åŒæ„Ÿï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583553090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053934,"avatar":"https://static001.geekbang.org/account/avatar/00/10/14/ee/d72a8222.jpg","nickname":"æ”»åŸæ‹”å¯¨","note":"","ucode":"CBC37183DAB6B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197304,"discussion_content":"åŒæ„Ÿï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583416845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184593,"user_name":"æ…Œå¼ è€Œé»‘ç³–","can_delete":false,"product_type":"c1","uid":1638878,"ip_address":"","ucode":"B4416885A301C8","user_header":"https://static001.geekbang.org/account/avatar/00/19/01/de/bf524817.jpg","comment_is_top":false,"comment_ctime":1583368324,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"91777681540","product_id":100046801,"comment_content":"å…¶ä¸­åœ¨æ›´æ–°è´¦æˆ·ä½™é¢æ—¶çš„where log_id=3è¿™éƒ¨åˆ†æ„Ÿè§‰å’Œä¹è§‚é”ä¸­çš„versionèµ·åˆ°çš„ä½œç”¨å¾ˆåƒ","like_count":22,"discussions":[{"author":{"id":1813364,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/ab/74/286d74c0.jpg","nickname":"MT006","note":"","ucode":"83C7D7EEBD32C1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554358,"discussion_content":"log idä»€ä¹ˆæ—¶å€™æ›´æ–°å‘¢ï¼Œè¿™ä¸ªæ›´æ–°åœ¨å¹¶å‘çš„æ—¶å€™æ€ä¹ˆä¿è¯å†™å…¥çš„é¡ºåºå’Œåé¢çš„äº‹åŠ¡æ‰§è¡Œé¡ºåºæ˜¯ä¸€è‡´çš„å‘¢ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646359360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213917,"discussion_content":"å—¯å—¯ï¼Œä¹è§‚é”çš„æ€æƒ³å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585134744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186556,"user_name":"Zend","can_delete":false,"product_type":"c1","uid":1053921,"ip_address":"","ucode":"80EBB0B6772E27","user_header":"https://static001.geekbang.org/account/avatar/00/10/14/e1/ee5705a2.jpg","comment_is_top":false,"comment_ctime":1583879858,"is_pvip":false,"replies":[{"id":"72045","content":"æ‰€ä»¥æˆ‘ä»¬è¦åŠ ä¸Šä½™é¢æµæ°´çš„IDæ¥æ§åˆ¶å¹¶å‘æ›´æ–°ï¼Œè¿™æ ·æ— è®ºæ˜¯rcè¿˜æ˜¯rréƒ½æ˜¯å®‰å…¨çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1583901510,"ip_address":"","comment_id":186556,"utype":1}],"discussion_count":8,"race_medal":0,"score":"78893291186","product_id":100046801,"comment_content":"è€å¸ˆï¼Œé’ˆå¯¹ä½™é¢æ›´æ–°è¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å°±åº”è¯¥ç”¨RCéš”ç¦»çº§åˆ«ï¼Œå› ä¸ºRRéš”ç¦»çº§åˆ«ä¼šä¸ä¼šå­˜åœ¨ä½™é¢å·²ç»è¢«åˆ«çš„äº‹åŠ¡æ›´æ–°äº†ï¼Œè€Œå½“å‰äº‹åŠ¡è¿˜æ˜¯ç”¨æ—§æ•°æ®ã€‚","like_count":19,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486801,"discussion_content":"æ‰€ä»¥æˆ‘ä»¬è¦åŠ ä¸Šä½™é¢æµæ°´çš„IDæ¥æ§åˆ¶å¹¶å‘æ›´æ–°ï¼Œè¿™æ ·æ— è®ºæ˜¯rcè¿˜æ˜¯rréƒ½æ˜¯å®‰å…¨çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583901510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"æµå¹´","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323202,"discussion_content":"RRéš”ç¦»çº§åˆ«ä¸‹ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜çš„ï¼Œä¼šåŠ è¡Œé”çš„ï¼Œåˆ«çš„äº‹åŠ¡æ›´æ–°ä¸äº†çš„","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1604896106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":2032840,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/04/c8/3c7af100.jpg","nickname":"Javatar","note":"","ucode":"E216645CDF632C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"æµå¹´","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329705,"discussion_content":"rrçº§åˆ«ä¸‹ï¼Œå¦‚æœå¦ä¸€ä¸ªäº‹åŠ¡ï¼Œäº‹å…ˆæ›´æ–°äº†è´¦æˆ·ä½™é¢å¹¶ä¸”æ²¡æäº¤ï¼Œé‚£ä¹ˆæœ¬äº‹åŠ¡ä¼šè¢«é˜»å¡å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606448272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":323202,"ip_address":""},"score":329705,"extra":""},{"author":{"id":1101226,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cd/aa/33d48789.jpg","nickname":"å«æ±Ÿ","note":"","ucode":"DE2F7A6916F1A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2032840,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/04/c8/3c7af100.jpg","nickname":"Javatar","note":"","ucode":"E216645CDF632C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335386,"discussion_content":"æ˜¯çš„ï¼Œä»»ä½•çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦æ·»åŠ é”ï¼Œåªæœ‰åœ¨äº‹åŠ¡ç»“æŸä¹‹åæ‰ä¼šé‡Šæ”¾ï¼Œæ‰€ä»¥æœ¬äº‹åŠ¡ä¼šåœ¨è·å–é”çš„æ—¶å€™é˜»å¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608179328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":329705,"ip_address":""},"score":335386,"extra":""},{"author":{"id":1716827,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/32/5b/d0c7e813.jpg","nickname":"luo","note":"","ucode":"1A1DA8EB916ECF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"æµå¹´","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536893,"discussion_content":"èµåŒï¼Œä¸€ç›´æƒ³çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå´ä¸€ç›´æ²¡è®²åˆ°è¿™ä¸€ç‚¹ä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638889062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":323202,"ip_address":""},"score":536893,"extra":""}]},{"author":{"id":3206657,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ee/01/2ecf51b0.jpg","nickname":"Catcher","note":"","ucode":"5BEFBEE3D367A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591218,"discussion_content":"RRéš”ç¦»çº§åˆ«ï¼Œä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ›´æ–°åŒä¸€æ¡è®°å½•ï¼Œä¼šä¸ä¼šå‡ºç°ABAé—®é¢˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666404845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2350043,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/sFkJYPdIIjHfxgCxAh1D4Pyk1jAueicu7egY1PUvR8egs12gAXxmO51YT6Bk7NianYRyMRPTpd3kKWXvZ8TEkRyw/132","nickname":"Geek_7794e2","note":"","ucode":"2F749554FEA20D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578473,"discussion_content":"é‚£è¿™ä¸ªæ–¹æ¡ˆå°±æ˜¯ç”¨rr å–ä»£ rc","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656810210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224326,"user_name":"æ™ºè¶…","can_delete":false,"product_type":"c1","uid":1109769,"ip_address":"","ucode":"1C28A46FDD7FA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/09/209cb7ff.jpg","comment_is_top":false,"comment_ctime":1591345621,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44541018581","product_id":100046801,"comment_content":"è¿™ç¯‡æ–‡ç« çœ‹äº†å‡ éï¼Œå¼€å§‹è§‰å¾—è®²æ¸…æ¥šäº†ï¼Œåé¢åˆæ„Ÿè§‰ç¼ºå°‘äº›ä»€ä¹ˆã€‚å¦‚æœå•çº¯æ˜¯è¯´äº‹åŠ¡ï¼Œé‚£æ–‡ç« è¿˜å¯ä»¥ã€‚<br>ä½†æ˜¯å®é™…æƒ…å†µï¼Œéœ€è¦è€ƒè™‘çš„ä¸æ­¢è¿™äº›ï¼Œæ¯”å¦‚è½¬è´¦çš„é—®é¢˜ï¼Œéœ€è¦è€ƒè™‘å¹‚ç­‰ã€æ­»é”ç­‰ã€‚","like_count":11},{"had_liked":false,"id":187385,"user_name":"E","can_delete":false,"product_type":"c1","uid":1193143,"ip_address":"","ucode":"B1B0759EDA4AF9","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/b7/60281658.jpg","comment_is_top":false,"comment_ctime":1584097119,"is_pvip":false,"replies":[{"id":"72774","content":"è¿™ä¸ªæ˜¯å’ŒSessionç»‘å®šçš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1584408979,"ip_address":"","comment_id":187385,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35943835487","product_id":100046801,"comment_content":"LAST_INSERT_ID() è¿™ä¸ªå¯ä»¥ä¿è¯æ˜¯äº‹åŠ¡é‡Œæœ€åæ’å…¥çš„é‚£ä¸ªidå— ä¼šé‡åˆ°æ˜¯å…¶ä»–äº‹åŠ¡äº§ç”Ÿçš„idå—","like_count":9,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487092,"discussion_content":"è¿™ä¸ªæ˜¯å’ŒSessionç»‘å®šçš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584408979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213923,"discussion_content":"è¿™æ˜¯ä¸ªmysqlå‡½æ•°å—ï¼Ÿè¿˜çœŸæ²¡æ³¨æ„è¿‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585135107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039069,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/da/dd/1e5e7b0c.jpg","nickname":"image","note":"","ucode":"A45BFF284F8933","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213381,"discussion_content":"æ•°æ®é‡å¤§æ—¶ä¸€èˆ¬è¦åˆ†åº“ã€åˆ†è¡¨å§ï¼Œä½¿ç”¨è‡ªå¢åœºæ™¯å¤šå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585065952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216143,"user_name":"ä¹–ï¼Œæ‘¸æ‘¸å¤´","can_delete":false,"product_type":"c1","uid":1611745,"ip_address":"","ucode":"BD92741A11D3CD","user_header":"https://static001.geekbang.org/account/avatar/00/18/97/e1/0f4d90ff.jpg","comment_is_top":false,"comment_ctime":1589196016,"is_pvip":true,"replies":[{"id":"80336","content":"æˆ‘ä»¬ä¸€ç›´è¯´ï¼Œè¦åˆ†æå…·ä½“çš„åœºæ™¯ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œè¦å…ˆæœ‰åœºæ™¯ï¼Œæ‰è°ˆå¾—ä¸Šé€‰æ‹©ã€‚<br><br>å¦‚æœæœ‰ä¸€ç§æ–¹æ³•æˆ–æŠ€æœ¯åœ¨å„ç§åœºæ™¯ä¸‹éƒ½ä¼˜äºå¦å¤–ä¸€ç§ï¼Œå¦å¤–ä¸€ç§æ—©å°±è¢«æ·˜æ±°äº†ï¼Œä¸ä¼šå‡ºç°åœ¨å¤§å®¶çš„è§†é‡ä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589462507,"ip_address":"","comment_id":216143,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31653967088","product_id":100046801,"comment_content":"è¿™é‡Œ ä½¿ç”¨ version å’Œ select for update éƒ½èƒ½è§£å†³é—®é¢˜ï¼Œè¯·é—® æsir å®é™…åœºåˆç§å“ªä¸€ç§æ›´åˆé€‚","like_count":8,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494686,"discussion_content":"æˆ‘ä»¬ä¸€ç›´è¯´ï¼Œè¦åˆ†æå…·ä½“çš„åœºæ™¯ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œè¦å…ˆæœ‰åœºæ™¯ï¼Œæ‰è°ˆå¾—ä¸Šé€‰æ‹©ã€‚\n\nå¦‚æœæœ‰ä¸€ç§æ–¹æ³•æˆ–æŠ€æœ¯åœ¨å„ç§åœºæ™¯ä¸‹éƒ½ä¼˜äºå¦å¤–ä¸€ç§ï¼Œå¦å¤–ä¸€ç§æ—©å°±è¢«æ·˜æ±°äº†ï¼Œä¸ä¼šå‡ºç°åœ¨å¤§å®¶çš„è§†é‡ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589462507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185109,"user_name":"å…¨éº¦å°é¢åŒ…","can_delete":false,"product_type":"c1","uid":1086413,"ip_address":"","ucode":"823C65BF366097","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/cd/dbafc7d1.jpg","comment_is_top":false,"comment_ctime":1583484772,"is_pvip":false,"replies":[{"id":"71653","content":"JPAæ˜¯å¯ä»¥è¿”å›æ›´æ–°è¡Œæ•°çš„ï¼Œä½ è®©æ¥å£æ›´æ–°æ–¹æ³•çš„å®šä¹‰çš„è¿”å›å€¼æ˜¯intç±»å‹ï¼Œè¿”å›çš„æ•°å€¼å°±æ˜¯æ›´æ–°è¡Œæ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1583636872,"ip_address":"","comment_id":185109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31648255844","product_id":100046801,"comment_content":"æˆ‘æ˜¯javaå¼€å‘è€…ï¼ŒåƒJPAæ¡†æ¶æ˜¯ä¸æä¾›æ›´æ–°çš„å½±å“è¡Œæ•°çš„ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486256,"discussion_content":"JPAæ˜¯å¯ä»¥è¿”å›æ›´æ–°è¡Œæ•°çš„ï¼Œä½ è®©æ¥å£æ›´æ–°æ–¹æ³•çš„å®šä¹‰çš„è¿”å›å€¼æ˜¯intç±»å‹ï¼Œè¿”å›çš„æ•°å€¼å°±æ˜¯æ›´æ–°è¡Œæ•°ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583636872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184863,"user_name":"å…¬å·-æŠ€æœ¯å¤œæœªçœ ","can_delete":false,"product_type":"c1","uid":1013683,"ip_address":"","ucode":"83825B57CBD952","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","comment_is_top":false,"comment_ctime":1583420654,"is_pvip":true,"discussion_count":4,"race_medal":0,"score":"31648191726","product_id":100046801,"comment_content":"è€å¸ˆçš„æ–‡ç« æ˜¯é‡‡ç”¨äº†ä¹è§‚é”ï¼›åœ¨é‡‡ç”¨ä¹è§‚é”é™¤äº†è¦é¿å…å‡ºç°ABAé—®é¢˜å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„å¯èƒ½ä¼šå‡ºç°å¤±è´¥çš„åœºæ™¯ã€‚æ­¤æ—¶ï¼Œä¸€èˆ¬å¯ä»¥é‡‡ç”¨é‡è¯•çš„ç­–ç•¥ï¼›å¦‚æœå¹¶å‘ä¸æ˜¯å¾ˆé«˜ï¼Œå¯ä»¥åœ¨é‡è¯•å¤šæ¬¡ä¸è¡Œçš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘é™çº§ä¸ºæ‚²è§‚é”ç­–ç•¥ã€‚","like_count":7,"discussions":[{"author":{"id":1036906,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d2/6a/a9039139.jpg","nickname":"ITå°åƒ§","note":"","ucode":"4DC9B291AAD748","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":315531,"discussion_content":"æµæ°´å·ä¸ä¼šç”Ÿæˆä¹‹å‰çš„ï¼Œä¸å­˜åœ¨ABAé—®é¢˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603286424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738493,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Qn1PDx7xA7jKFZr4vHibmsvoZ7bwUCzHTg3uywiaESCgFTTMibPpKdZOfrqTXtdQXxUJqFqmLAj5NoIFMJpYibbcOQ/132","nickname":"happy learn","note":"","ucode":"BCE08C8E64A23E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":243758,"discussion_content":"æ˜¯ç”¨select for updateé”ä½å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587559351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213925,"discussion_content":"æ€ä¹ˆé‡è¯•å’Œé™çº§å•Šï¼ŒæŒ‡å¯¼ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585135140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2296382,"avatar":"https://static001.geekbang.org/account/avatar/00/23/0a/3e/5b1b1b75.jpg","nickname":"æµå¹´","note":"","ucode":"8B579C6E466CB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323203,"discussion_content":"æœ€ç®€å•çš„ï¼Œcatchå¼‚å¸¸ç„¶åé‡è¯•ï¼Œé‡æ–°å‘èµ·è°ƒç”¨","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604896216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":213925,"ip_address":""},"score":323203,"extra":""}]}]},{"had_liked":false,"id":228785,"user_name":"æ²§æµªä¹‹æ°´","can_delete":false,"product_type":"c1","uid":1126491,"ip_address":"","ucode":"3819CB439BFB4C","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/5b/ed3b2211.jpg","comment_is_top":false,"comment_ctime":1592809152,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18772678336","product_id":100046801,"comment_content":"æˆ‘çš„ç†è§£æ˜¯ï¼Œå¦‚æœåªæ˜¯ç®€å•çš„æŠŠä¸¤ä¸ªåŠ¨ä½œæ”¾å…¥ä¸€ä¸ªäº‹åŠ¡ï¼Œå½“å¹¶å‘è¾ƒå¤§æ—¶ï¼Œæœ‰é”ç­‰å¾…çš„é—®é¢˜ï¼Œåªè¦å‘ç”Ÿäº†é”ç­‰å¾…ï¼Œå°±ä¼šå¼•å‘æ­»é”æ£€æµ‹ï¼Œè¿™ä¸ªæ˜¯å¾ˆè€—è´¹æ€§èƒ½çš„ã€‚æ‰€ä»¥è€å¸ˆç»™å‡ºçš„å®ç°æ–¹æ¡ˆï¼Œèƒ½æœ‰æ•ˆé¿å…é”ç­‰å¾…çš„é—®é¢˜ï¼ˆå› ä¸ºwhereåŠ äº†æ¡ä»¶ï¼‰å¦‚æœæ›´æ–°æˆåŠŸï¼Œå°±æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ›´æ–°ä¸æˆåŠŸï¼Œå›æ»šäº‹åŠ¡ã€‚è¿™æ ·å¯ä»¥æœ€å¤§é™åº¦çš„æé«˜å¹¶å‘çš„æ•ˆç‡ã€‚å› ä¸ºåªè¦æœ‰ä¸€ä¸ªäº‹åŠ¡æˆåŠŸæäº¤äº†ï¼Œå…¶ä»–ç­‰å¾…çš„äº‹åŠ¡å°±è‡ªåŠ¨å›æ»šäº†ã€‚è€Œä¸ä¼šä¸€ç›´ç­‰ç€é”ã€‚<br>ä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹ä¸å¯¹ @æsir","like_count":5,"discussions":[{"author":{"id":1443544,"avatar":"https://static001.geekbang.org/account/avatar/00/16/06/d8/30e8b7e6.jpg","nickname":"Laplace","note":"","ucode":"38EEC400DE94FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567331,"discussion_content":"å›æ»šå²‚ä¸æ˜¯æŠŠè¿™æ¬¡æ“ä½œä¸¢æ‰ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650891054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189505,"user_name":"å°è¢","can_delete":false,"product_type":"c1","uid":1811495,"ip_address":"","ucode":"3F5D8721F577D9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","comment_is_top":false,"comment_ctime":1584523240,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"18764392424","product_id":100046801,"comment_content":"å¦‚æœç”¨æˆ·é‡æš´æ¶¨åï¼Œæµæ°´æ—¥å¿—dbå’Œè´¦æˆ·dbåˆ†å¼€ï¼Œå°±ä¸èƒ½ç”¨è¿™ä¸ªæ–¹æ³•äº†ã€‚ã€‚ã€‚","like_count":4,"discussions":[{"author":{"id":1019302,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/a6/22c37c91.jpg","nickname":"æ¥Š_å®µå¤œ","note":"","ucode":"7BA0CADC5F23BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411836,"discussion_content":"åˆ†å¼€ä¹Ÿä¸æ˜¯è¿™ä¹ˆåˆ†å¼€, åšæ°´å¹³åˆ†åº“åˆ†è¡¨å°±å¯ä»¥; æ²¡æœ‰æŠŠæµæ°´å’Œè´¦æˆ·åˆ†å¼€çš„é“ç†, è¿™ä¸æ˜¯ç»™è‡ªå·±æ‰¾èŒ¬å—","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1636015391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1210215,"avatar":"https://static001.geekbang.org/account/avatar/00/12/77/67/180486e3.jpg","nickname":"du tiezheng","note":"","ucode":"33D44752D306F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":561644,"discussion_content":"æµæ°´æ—¥å¿—æš´æ¶¨åï¼Œé™¤äº†åˆ†åº“åˆ†è¡¨ï¼Œè¿˜å¯ä»¥åšå†·çƒ­åˆ†ç¦»ï¼ŒæŠŠè·ç¦»ç°åœ¨è¶…è¿‡ä¸‰ä¸ªæœˆçš„æµæ°´ï¼Œè½¬ç§»åˆ°nosqlï¼Œæœ€æ–°çš„æµæ°´è¿˜æ˜¯è·Ÿä½™é¢æ”¾åœ¨ä¸€èµ·ï¼Œèµ°å•æœºäº‹åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649689078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365869,"discussion_content":"é‚£å¾—ä¸Šåˆ†å¸ƒå¼é”æˆ–è€…åˆ†å¸ƒå¼äº‹åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617893804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1126757,"avatar":"https://static001.geekbang.org/account/avatar/00/11/31/65/c96a7078.jpg","nickname":"123456789åç™¾åƒä¸‡","note":"","ucode":"9F4789B553F1A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273154,"discussion_content":"å¼‚æ­¥æ¶ˆæ¯æœºåˆ¶ï¼Œç”¨æ¶ˆæ¯ä¸­é—´ä»¶â€œè‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡â€ç‰¹æ€§ä¿æŒæœ€ç»ˆä¸€è‡´æ€§ã€‚æŠŠå’Œäº¤æ˜“ä¸»é“¾è·¯æ— å…³çš„æµæ°´éš”ç¦»å¼€æ¥ï¼Œä¼¼ä¹æ˜¯æ›´å¥½çš„é€‰æ‹©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590416468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251990,"discussion_content":"åˆ†å¼€äº†ï¼Œæ²¡åŠæ³•ä½¿ç”¨æœ¬åœ°äº‹åŠ¡äº†ï¼Œå¾—ä¸Šåˆ†å¸ƒå¼äº‹åŠ¡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588132273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189231,"user_name":"Aliliin","can_delete":false,"product_type":"c1","uid":1025239,"ip_address":"","ucode":"61F9A09BB6650F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/d7/5d2bfaa7.jpg","comment_is_top":false,"comment_ctime":1584491494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18764360678","product_id":100046801,"comment_content":"å¥½å–œæ¬¢è¿™é—¨å®è·µè¯¾ã€‚","like_count":4},{"had_liked":false,"id":186943,"user_name":"è¯¯","can_delete":false,"product_type":"c1","uid":1141203,"ip_address":"","ucode":"EDDEBA6F92B32C","user_header":"https://static001.geekbang.org/account/avatar/00/11/69/d3/d9a858cb.jpg","comment_is_top":false,"comment_ctime":1583977468,"is_pvip":false,"replies":[{"id":"72245","content":"è¯·ç»§ç»­å­¦ä¹ ä¸‹ä¸€èŠ‚è¯¾ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1584064219,"ip_address":"","comment_id":186943,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18763846652","product_id":100046801,"comment_content":"è¦æ˜¯æ›´æ–°ä½™é¢(å‡è®¾mysql)ã€è®°å½•æµæ°´(å‡è®¾mongo)ä¸æ˜¯åŒä¸€ä¸ªå­˜å‚¨è®¾å¤‡ï¼Œå¦‚ä½•ä½¿ç”¨äº‹åŠ¡ä¿è¯åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486930,"discussion_content":"è¯·ç»§ç»­å­¦ä¹ ä¸‹ä¸€èŠ‚è¯¾ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584064219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":227443,"user_name":"Geek_fa5d8b","can_delete":false,"product_type":"c1","uid":1737347,"ip_address":"","ucode":"4C976932383EDB","user_header":"https://static001.geekbang.org/account/avatar/00/1a/82/83/d3926a61.jpg","comment_is_top":false,"comment_ctime":1592380615,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14477282503","product_id":100046801,"comment_content":"READ COMMITTED â€”â€” æ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ªReadView<br><br>REPEATABLE READ â€”â€” åœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ªReadView","like_count":3,"discussions":[{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531418,"discussion_content":"è¿™é‡Œè¦åŠ ä¸€æ¡ åªè¯»äº‹åŠ¡ä¸ä¼šç”Ÿæˆäº‹åŠ¡id","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637307582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202732,"user_name":"é”","can_delete":false,"product_type":"c1","uid":1110915,"ip_address":"","ucode":"A245BA96C9471F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/83/e2612d81.jpg","comment_is_top":false,"comment_ctime":1586059279,"is_pvip":false,"replies":[{"id":"76059","content":"åœ¨çº¿äº¤æ˜“ç³»ç»Ÿä¸­ï¼Œç”¨äº‹åŠ¡è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜è¿˜æ˜¯ä¸»æµçš„æ–¹æ³•ã€‚å¤§å‚ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1586223567,"ip_address":"","comment_id":202732,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14470961167","product_id":100046801,"comment_content":"æƒ³çŸ¥é“å¤§å‚è¿˜ç”¨äº‹åŠ¡å—ï¼Œæˆ–è€…åƒé“¶è¡Œè½¬è´¦ï¼Œä¼šç”¨äº‹åŠ¡å—ï¼Ÿåˆ†å¸ƒå¼å¾®æœåŠ¡ä¸é€‚åˆäº‹åŠ¡å§ï¼Œæ˜¯å¦åšè¡¥å¿æœºåˆ¶å°±å¥½å‘¢ï¼Œæ¯”å¦‚æä¸ªå®šæ—¶ä»»åŠ¡å®šæ—¶checkå†ä¿®å¤æ•°æ®","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490667,"discussion_content":"åœ¨çº¿äº¤æ˜“ç³»ç»Ÿä¸­ï¼Œç”¨äº‹åŠ¡è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜è¿˜æ˜¯ä¸»æµçš„æ–¹æ³•ã€‚å¤§å‚ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586223567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189790,"user_name":"Wisee","can_delete":false,"product_type":"c1","uid":1117035,"ip_address":"","ucode":"EADD95F86DC2AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/0b/6b/bfa6f7f9.jpg","comment_is_top":false,"comment_ctime":1584550833,"is_pvip":false,"replies":[{"id":"73114","content":"æ˜¯çš„ï¼Œåé¢æˆ‘ä»¬ä¹Ÿä¼šè®²åˆ°åˆ†åº“åˆ†è¡¨","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1584592593,"ip_address":"","comment_id":189790,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14469452721","product_id":100046801,"comment_content":"è¿™ç§é€‚åˆå•åº“çš„æ“ä½œï¼Œå¦‚æœæ˜¯ä¸šåŠ¡é‡å¤§äº†ï¼Œåˆ†åº“åˆ†è¡¨äº†ï¼Œå°±ä¸èƒ½è¿™ä¹ˆåšäº†å§","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487794,"discussion_content":"æ˜¯çš„ï¼Œåé¢æˆ‘ä»¬ä¹Ÿä¼šè®²åˆ°åˆ†åº“åˆ†è¡¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584592593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186922,"user_name":"ç™½ä¸åƒ","can_delete":false,"product_type":"c1","uid":1033578,"ip_address":"","ucode":"F019914D8819C2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/6a/7f858f1f.jpg","comment_is_top":false,"comment_ctime":1583973694,"is_pvip":true,"replies":[{"id":"72248","content":"ä¼šçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1584064289,"ip_address":"","comment_id":186922,"utype":1}],"discussion_count":2,"race_medal":1,"score":"14468875582","product_id":100046801,"comment_content":"æˆ‘æœ‰ä¸ªç–‘é—®ï¼Œå¯¹äºmysql innodbæ¥è¯´ï¼Œä¸€ä¸ªäº‹ç‰©ï¼ˆçº¿ç¨‹ï¼‰æ“ä½œæ•°æ®çš„æ—¶å€™ä¸æ˜¯ä¼šç›´æ¥é”è¡Œä¹ˆï¼Œå¦ä¸€ä¸ªäº‹ç‰©ï¼ˆçº¿ç¨‹ï¼‰ä¸æ˜¯ä¼šå¤„äºé˜»å¡ç­‰å¾…ä¸­ä¹ˆï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486920,"discussion_content":"ä¼šçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584064289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1126491,"avatar":"https://static001.geekbang.org/account/avatar/00/11/30/5b/ed3b2211.jpg","nickname":"æ²§æµªä¹‹æ°´","note":"","ucode":"3819CB439BFB4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285330,"discussion_content":"æ‰€ä»¥è€å¸ˆè¯´è¿‡ï¼Œä»–ç»™çš„æ–¹æ¡ˆèƒ½æ”¯æŒé«˜å¹¶å‘ï¼Œå¹¶æ²¡æœ‰è¯´ä¸ç”¨è¿™ä¸ªæ–¹æ¡ˆå°±ä¸è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592808622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185912,"user_name":"sundy","can_delete":false,"product_type":"c1","uid":1724856,"ip_address":"","ucode":"581D4B976524B6","user_header":"https://static001.geekbang.org/account/avatar/00/1a/51/b8/f76b15a1.jpg","comment_is_top":false,"comment_ctime":1583724222,"is_pvip":false,"discussion_count":11,"race_medal":0,"score":"14468626110","product_id":100046801,"comment_content":"æè€å¸ˆï¼Œæœ‰ä¸€ç‚¹ä¸å¤ªæ˜ç™½ï¼Œmysqlé»˜è®¤çº§åˆ«æ˜¯rrï¼Œå¦‚æ‚¨ä¸Šé¢çš„ä¾‹å­ï¼Œä½†æ˜¯rræ˜¯æ›´æ–°è¯»çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨æ‰§è¡Œæ›´æ–°è¯­å¥æ—¶è¯»åˆ°çš„æ˜¯200ï¼Œæœ€ç»ˆçš„æ•°æ®ä¸ä¼šå‡ºé”™ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦æ‚¨æä¾›çš„ç­–ç•¥å‘¢ï¼Ÿä½ è¯´çš„è®°å½•æµæ°´å·çš„ç­–ç•¥è§£å†³çš„æ˜¯å…·ä½“ä»€ä¹ˆé—®é¢˜è¯·é—®ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1209170,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/52/a5a0c0c6.jpg","nickname":"animabear","note":"","ucode":"60E27F9F57DD06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":220633,"discussion_content":"æˆ‘ä¹Ÿæœ‰ç–‘é—®ï¼Œæ— è®ºæ˜¯ rr è¿˜æ˜¯ rcï¼Œåœ¨ update set a = a + 1 æ˜¯ï¼Œéƒ½æ˜¯å½“å‰è¯»ï¼Œä¼šè¯»åˆ°æœ€æ–°ç‰ˆæœ¬çš„æ•°æ®åšæ›´æ–°ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1585909604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1692942,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d5/0e/dae566c7.jpg","nickname":"JOHN","note":"","ucode":"6936DE275AA543","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1209170,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/52/a5a0c0c6.jpg","nickname":"animabear","note":"","ucode":"60E27F9F57DD06","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":239724,"discussion_content":"æˆ‘ä¹Ÿè®¤åŒä½ çš„çœ‹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587307013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":220633,"ip_address":""},"score":239724,"extra":""}]},{"author":{"id":1053921,"avatar":"https://static001.geekbang.org/account/avatar/00/10/14/e1/ee5705a2.jpg","nickname":"Zend","note":"","ucode":"80EBB0B6772E27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202139,"discussion_content":"å…¶å®ä¹Ÿå¯ä»¥æ ¹æ®å½“å‰äº‹åŠ¡å†…æŸ¥è¯¢åˆ°çš„ä½™é¢åšåˆ¤æ–­æ¡ä»¶ï¼Œæ˜¯å—ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583879965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053921,"avatar":"https://static001.geekbang.org/account/avatar/00/10/14/e1/ee5705a2.jpg","nickname":"Zend","note":"","ucode":"80EBB0B6772E27","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204686,"discussion_content":"ä½™é¢ä¼šæœ‰abaçš„é—®é¢˜ ä¸€èˆ¬ç‰ˆæœ¬å·æˆ–è€…æµæ°´å·éƒ½ä¸ä¼šé‡å¤","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1584199594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":202139,"ip_address":""},"score":204686,"extra":""},{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213922,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585134978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":204686,"ip_address":""},"score":213922,"extra":""},{"author":{"id":1905946,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/15/1a/fce31315.jpg","nickname":"Joy Rick","note":"","ucode":"EA42BD15FAF9BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221764,"discussion_content":"åˆæ˜¯ç‰ˆæœ¬å·æ§åˆ¶ ABA é—®é¢˜çš„æ€è·¯ï¼Œå“ˆå“ˆï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586057867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":204686,"ip_address":""},"score":221764,"extra":""}]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365916,"discussion_content":"æˆ‘æƒ³é€šäº†\nåŠ ä¸Šä½™é¢æµæ°´çš„IDï¼Œä¿è¯æœ‰ä¸€ä¸ªæ›´æ–°ä¼šå¤±è´¥ï¼Œåœ¨äº‹åŠ¡ä¸­åŠ ä¸Šä½™é¢éè´Ÿçš„é€»è¾‘åˆ¤æ–­ï¼Œé¿å…è´¦æˆ·ä½™é¢æ‰£ä¸ºè´Ÿæ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617899666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323161,"avatar":"","nickname":"æ³¢æ³¢","note":"","ucode":"4D16ED4CF21CF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":313886,"discussion_content":"æµ‹è¯•äº†ä¸‹ï¼Œupdate æ˜¯æ›´æ–°è¯»çš„ï¼Œä¸çŸ¥é“è€å¸ˆè¿™ä¹ˆè®¾è®¡çš„åŸå› ï¼Œæœ‰ç‚¹è¿·æƒ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603102271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1834181,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/fc/c5/ff8b770e.jpg","nickname":"BugBean","note":"","ucode":"B51232281AD9BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297288,"discussion_content":"è€å¸ˆä¹Ÿä¼šæœ‰ç¿»è½¦çš„æ—¶å€™,ç‹¬ç«‹æ€è€ƒ,èµä¸€ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596857752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337892,"user_name":"å†°åŸçš„è‹è“æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1862936,"ip_address":"","ucode":"84120EC31A63AF","user_header":"https://static001.geekbang.org/account/avatar/00/1c/6d/18/e05f72ee.jpg","comment_is_top":false,"comment_ctime":1647138940,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10237073532","product_id":100046801,"comment_content":"è¿™ä¹ˆå¤šå¹´äº†ï¼Œæˆ‘ç»ˆäºææ˜ç™½RRå’ŒRCäº†å‘œå‘œå‘œï¼","like_count":3},{"had_liked":false,"id":189123,"user_name":"æ´»åˆ°å¤©å¹´","can_delete":false,"product_type":"c1","uid":1116236,"ip_address":"","ucode":"03178BA96BE04E","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/4c/e5db89c6.jpg","comment_is_top":false,"comment_ctime":1584457793,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10174392385","product_id":100046801,"comment_content":"æ„Ÿè°¢è€å¸ˆï¼Œå­¦äº†ä¹‹åæ„Ÿè§‰å¯¹äº‹åŠ¡çš„ç†è§£ï¼Œå¯¹è´¦æˆ·è¡¨å’Œæµæ°´è¡¨çš„è®¾è®¡ï¼Œä»¥åŠæ¶‰åŠæœåŠ¡æ¥å£ æœ‰äº†æ›´æ¸…æ™°çš„è®¤è¯†ã€‚","like_count":3},{"had_liked":false,"id":184616,"user_name":"suke","can_delete":false,"product_type":"c1","uid":1007753,"ip_address":"","ucode":"C0287C31A4F45B","user_header":"","comment_is_top":false,"comment_ctime":1583371792,"is_pvip":false,"replies":[{"id":"71646","content":"ä¸€èˆ¬äº¤æ˜“ç±»ç³»ç»Ÿå¦‚æœå‡ºç°å¤±è´¥ï¼Œå»ºè®®çš„åšæ³•æ˜¯å›æ»šå¹¶è¿”å›å¤±è´¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1583635818,"ip_address":"","comment_id":184616,"utype":1}],"discussion_count":5,"race_medal":0,"score":"10173306384","product_id":100046801,"comment_content":"è€å¸ˆï¼Œé‚£æ›´æ–°å¤±è´¥çš„æƒ…å†µä¸€èˆ¬ç”µå•†ç³»ç»Ÿè¯¥å¦‚ä½•å¤„ç†ï¼Ÿæ˜¯è¦ç»§ç»­å°è¯•ï¼Ÿè¿˜æ˜¯ç›´æ¥è¿”å›å¤±è´¥","like_count":2,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486068,"discussion_content":"ä¸€èˆ¬äº¤æ˜“ç±»ç³»ç»Ÿå¦‚æœå‡ºç°å¤±è´¥ï¼Œå»ºè®®çš„åšæ³•æ˜¯å›æ»šå¹¶è¿”å›å¤±è´¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583635818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1097943,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJB6qS9nxicvToSX4fTrDNv7OVBtsrfr6VwLjPLcwZS8ibicczM15qVx473KgrYQg0TIFeibXD0RgK6WQ/132","nickname":"ä¼ å¿—","note":"","ucode":"2B0F67BCFCB3D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196883,"discussion_content":"å¯ä»¥ç”¨CASæ–¹æ¡ˆï¼Œæ›´æ–°å‡ æ¬¡ï¼Œå¦‚æœè¿˜ä¸æˆåŠŸè®°å½•é”™è¯¯æ—¥å¿—æŠ¥è­¦äººå·¥å¤„ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583381575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043480,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","nickname":"è‚¥low","note":"","ucode":"A158AFAAB8C742","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196804,"discussion_content":"æˆ‘ä¹Ÿæƒ³é—®è¿™ä¸ªé—®é¢˜ ä½†æ˜¯è¿™ç§é’ˆå¯¹æ¯ä¸ªç”¨æˆ·çš„ä½™é¢çš„æ›´æ–°å¹¶å‘åº”è¯¥ä¸æ˜¯å¾ˆé«˜å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583374178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043480,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","nickname":"è‚¥low","note":"","ucode":"A158AFAAB8C742","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213936,"discussion_content":"è´¦å·è¢«ç›—ï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶æ¶ˆè´¹ï¼Œå¯èƒ½æ€§ä¸é«˜å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585135727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":196804,"ip_address":""},"score":213936,"extra":""},{"author":{"id":1503064,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ef/58/d05ec302.jpg","nickname":"Frode","note":"","ucode":"B7B8DBF9980EA1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1043480,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","nickname":"è‚¥low","note":"","ucode":"A158AFAAB8C742","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392905,"discussion_content":"å¦‚æœæ˜¯å¾ˆå¤šäººæŠ¢ç”µå½±é™¢é—¨ç¥¨å‘¢ï¼ŒæŠ¢æ¼”å”±ä¼šé—¨ç¥¨å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631175037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":196804,"ip_address":""},"score":392905,"extra":""}]}]},{"had_liked":false,"id":184588,"user_name":"Cranliu","can_delete":false,"product_type":"c1","uid":1304302,"ip_address":"","ucode":"DC2DE84B142FDA","user_header":"https://static001.geekbang.org/account/avatar/00/13/e6/ee/e3c4c9b3.jpg","comment_is_top":false,"comment_ctime":1583367689,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"10173302281","product_id":100046801,"comment_content":"RRçº§åˆ«ä¸‹åŠ çš„æ˜¯next-keyé”ï¼Œå¯ä»¥è§£å†³å¹»è¯»çš„å§ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001390,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/ae/0a5f7a56.jpg","nickname":"æ­¤æ–¹å½¼æ–¹Francis","note":"","ucode":"73E6C93CF1FE39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197055,"discussion_content":"RR ä¹Ÿæ˜¯å¯ä»¥é¿å…å¹»è¯»çš„ï¼šé€šè¿‡å¯¹ select æ“ä½œæ‰‹åŠ¨åŠ  è¡ŒXé”ï¼ˆSELECT ... FOR UPDATE è¿™ä¹Ÿæ­£æ˜¯ SERIALIZABLE éš”ç¦»çº§åˆ«ä¸‹ä¼šéšå¼ä¸ºä½ åšçš„äº‹æƒ…ï¼‰ï¼ŒåŒæ—¶è¿˜éœ€è¦çŸ¥é“ï¼Œå³ä¾¿å½“å‰è®°å½•ä¸å­˜åœ¨ï¼Œæ¯”å¦‚ id = 1 æ˜¯ä¸å­˜åœ¨çš„ï¼Œå½“å‰äº‹åŠ¡ä¹Ÿä¼šè·å¾—ä¸€æŠŠè®°å½•é”ï¼ˆå› ä¸ºInnoDBçš„è¡Œé”é”å®šçš„æ˜¯ç´¢å¼•ï¼Œæ•…è®°å½•å®ä½“å­˜åœ¨ä¸å¦æ²¡å…³ç³»ï¼Œå­˜åœ¨å°±åŠ  è¡ŒXé”ï¼Œä¸å­˜åœ¨å°±åŠ  next-key locké—´éš™Xé”ï¼‰ï¼Œå…¶ä»–äº‹åŠ¡åˆ™æ— æ³•æ’å…¥æ­¤ç´¢å¼•çš„è®°å½•ï¼Œæ•…æœç»äº†å¹»è¯»ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1583401621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039069,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/da/dd/1e5e7b0c.jpg","nickname":"image","note":"","ucode":"A45BFF284F8933","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213390,"discussion_content":"Innodb çš„ RR éš”ç¦»ç•Œåˆ«å¯¹èŒƒå›´ä¼šåŠ ä¸Š GAPï¼Œç†è®ºä¸Šä¸ä¼šå­˜åœ¨å¹»è¯»ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585066562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111842,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/22/53802377.jpg","nickname":"hinswho.","note":"","ucode":"D72FA8F7BE1B36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380096,"discussion_content":"innodbå¼•æ“RRåšäº†é—´éš™é”æ¥é¿å…ï¼Œä½†ä¼ ç»Ÿçš„RRæ˜¯æœ‰å¹»è¯»çš„å¯èƒ½çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624339035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1361746,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","nickname":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","note":"","ucode":"5F97037585F857","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":248633,"discussion_content":"MYSQL 5.7.24 è¿™ä¸ªç‰ˆæœ¬çš„PR æ˜¯å¯ä»¥é¿å…å¹»è¯»çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587882849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016905,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/49/47d48fd0.jpg","nickname":"è§‚å¼ˆé“äºº","note":"","ucode":"F3BB619A33C605","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197436,"discussion_content":"è¿™ä¸ªé—®é¢˜å¸Œæœ›è€å¸ˆç»Ÿä¸€è§£é‡Šä¸‹ï¼Œä¸ºä»€ä¹ˆrrçº§åˆ«å¯ä»¥é˜²æ­¢å¹»å½±è¯»ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583420150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1506609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/q2HwchogzNiavKhIB4GfAxH6B88NhSoC7B7keVEUqiaP6JPokDUNJLYehocOyqYqrhA3iaxywyRXLYkYJjDUQESZw/132","nickname":"æ®‹å¤©å™¬é­‚","note":"","ucode":"A2AD8303A4518D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196845,"discussion_content":"æˆ‘è®°å¾—ä¹Ÿæ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583377578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213058,"user_name":"ğŸ˜š 46","can_delete":false,"product_type":"c1","uid":1433535,"ip_address":"","ucode":"EED0EBBBF80A43","user_header":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","comment_is_top":false,"comment_ctime":1588292323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5883259619","product_id":100046801,"comment_content":"account_balanceè¡¨æ˜¯ä¸æ˜¯éœ€è¦ç»™log_idæ·»åŠ ç´¢å¼•ï¼Œé¿å…å¹¶å‘updateæ—¶é”è¡¨å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":196051,"user_name":"ç¾ç¾","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1585232554,"is_pvip":false,"replies":[{"id":"74407","content":"ä½ å¯ä»¥è¯•ä¸€ä¸‹ã€‚<br><br>å®é™…ä¸Šæ˜¯ä¸è¡Œçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1585272390,"ip_address":"","comment_id":196051,"utype":1}],"discussion_count":4,"race_medal":0,"score":"5880199850","product_id":100046801,"comment_content":"å¦‚æœéš”ç¦»çº§åˆ«æ˜¯RRé‚£log_idä½œä¸ºæ›´æ–°æ¡ä»¶çš„é€»è¾‘å°±å¯ä»¥å»äº†å§ï¼Ÿ@ç¥å“¥","like_count":1,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489217,"discussion_content":"ä½ å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n\nå®é™…ä¸Šæ˜¯ä¸è¡Œçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585272390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"åŠ±ç ”å†°","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":228037,"discussion_content":"æ˜¯è¦åŠ ä¸Šçš„ï¼Œæ„Ÿè§‰è·ŸVersionæ˜¯åŒä¸€ä¸ªé“ç†; åœ¨Mysqlé‡Œä¸ç®¡æ˜¯ä»€ä¹ˆéš”ç¦»çº§åˆ«æ›´æ–°çš„æ—¶å€™éƒ½æ˜¯ä½¿ç”¨çš„â€å½“å‰è¯»â€åšçš„æ›´æ–°ï¼Œæ‰€ä»¥åœ¨è¯´Mysqlä¸­æ›´æ–°æ˜¯åŸå­æ€§çš„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586522999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2388888,"avatar":"https://static001.geekbang.org/account/avatar/00/24/73/98/ec4d22af.jpg","nickname":"é˜¿K","note":"","ucode":"C9E1B6D50135D3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1106394,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","nickname":"åŠ±ç ”å†°","note":"","ucode":"FCBC8266018FA0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583003,"discussion_content":"å¯ä»¥å»æ‰ï¼Œæ›´æ–°çš„æ—¶å€™ä¹Ÿæ˜¯å½“å‰è¯»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659872046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":228037,"ip_address":"åŒ—äº¬"},"score":583003,"extra":""}]},{"author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410272,"discussion_content":"æ›´æ–°æ—¶è¦æƒ³å»æ‰logIDçš„è¯ï¼Œå°±å¿…é¡»æŠŠæŸ¥è¯¢è´¦æˆ·çš„sqlè¯­å¥æ”¹æˆ select ... for updateï¼Œè¿™æ ·ç»™å¯¹åº”è®°å½•åŠ ä¸Šäº†è¡Œé”å°±ä¸æ€•è¢«å…¶ä»–äº‹åŠ¡æ›´æ–°äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635647783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185226,"user_name":"Spring coming","can_delete":false,"product_type":"c1","uid":1116196,"ip_address":"","ucode":"9E01F2D987D08B","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/24/1d3bafaf.jpg","comment_is_top":false,"comment_ctime":1583538654,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5878505950","product_id":100046801,"comment_content":"è¯·æ•™è€å¸ˆé—®é¢˜<br>1.  è¿™é‡Œçš„è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»ä¸­çš„&quot;è¯»&quot;æŒ‡çš„æ˜¯selectæŒ‡ä»¤å—<br><br>2. å¯¹äºaccount_logè¡¨ä¸­çš„from_accoutå’Œto_accoutå€¼æ˜¯å‡ºè‡ªaccountå¯¹å—ï¼Œæ¯”å¦‚ç”¨æˆ·ç»‘å®šäº†ä¸€å¼ é“¶è¡Œå¡å’Œä¸€ä¸ªå¾®ä¿¡æ”¯ä»˜ï¼Œå†åŠ ä¸Šç”¨æˆ·è‡ªå·±çš„ä½™é¢è´¦å·ï¼Œé‚£accountè¡¨å°±è¦ç»™è¿™ä¸ªç”¨æˆ·åˆ›å»ºä¸‰ä¸ªè´¦å·ï¼Œåœ¨å……å€¼çš„æ—¶å€™æŠŠé“¶è¡Œæˆ–è€…å¾®ä¿¡å¯¹åº”çš„account Idå†™å…¥åˆ°from_account,ç”¨æˆ·çš„ä½™é¢è´¦å·idå†™å…¥to_accountï¼Œæˆ‘ç†è§£çš„å¯¹å—<br><br>3. å¦‚æœç”¨RCéš”ç¦»çº§åˆ«è®²è§£å¹»è¯»çš„è¯å°±èƒ½åœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡çš„ç¬¬äºŒæ¬¡æŸ¥è¯¢ä¸­æŸ¥åˆ°å·²ç»æäº¤çš„1000è¿™æ¡æ•°æ®ï¼ŒRC RRéƒ½ä¸èƒ½é¿å…å¹»è¯»çš„æƒ…å†µä¸‹ï¼Œç»“æœä¸ä¸€è‡´ï¼Œæ„Ÿè§‰æ¡ˆä¾‹ä¸æ˜¯å¾ˆå‡†ç¡® <br><br>4. äº‹åŠ¡ä¸­å¦‚ä½•é€šè¿‡é”æœºåˆ¶æ¥æ§åˆ¶éš”ç¦»çº§åˆ«ï¼Œä»¥åŠå„ç§æ­»é”çš„æƒ…å†µè€å¸ˆä¼šåœ¨ä»¥åçš„è¯¾ç¨‹ä¸­è®²è§£å—<br>","like_count":1},{"had_liked":false,"id":184785,"user_name":"çº¦ä¹¦äºš","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","comment_is_top":false,"comment_ctime":1583402725,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"5878370021","product_id":100046801,"comment_content":"å¹»è¯»çš„å®šä¹‰ä¸€ç›´ä¸å¤ªæ˜ç¡®ï¼Œæœ‰äº‰è®ºï¼Œä¸åŒå®šä¹‰å¯¹äºMySQLåˆ°åº•RRè§£å†³æ²¡è§£å†³å¹»è¯»ï¼Œç»“è®ºä¹Ÿä¸åŒã€‚<br>æˆ‘æ›´å€¾å‘æƒå¨çš„å®šä¹‰ï¼Œå¼•è‡ª&lt;&lt;A Critique of ANSI SQL Isolation Levels&gt;&gt;:<br>P3 (Phantom): Transaction T1 reads a set of data items satisfying some &lt;search condition&gt;. Transaction T2 then creates data items that satisfy T1â€™s &lt;search condition&gt; and commits. If T1 then repeats its read with the same &lt;search condition&gt;, it gets a set of data items different from the first read.<br>è¿™ä¸æœ¬è¯¾ç»™çš„å®šä¹‰ä¸åŒã€‚<br><br>å½“ç„¶ä¸å½±å“æœ¬è¯¾çš„æ ¸å¿ƒå†…å®¹ï¼Œå¤§å®¶ä¹Ÿæ²¡å¿…è¦é’»ç‰›è§’å°–","like_count":2,"discussions":[{"author":{"id":1003233,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4e/e1/436a7576.jpg","nickname":"çš®çš®å®","note":"","ucode":"18EFAA3BFCDC26","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331683,"discussion_content":"å˜¿å˜¿ï¼Œåˆè§é¢äº†~~  è¡¥ä¸€è®°mysql å®˜ç½‘çš„å®šä¹‰ï¼š The so-called phantom problem occurs within a transaction when the same query produces different sets of rows at different times. For example, if a SELECT is executed twice, but returns a row the second time that was not returned the first time, the row is a â€œphantomâ€ row.  ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606932294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1046714,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","nickname":"çº¦ä¹¦äºš","note":"","ucode":"81EA27ADD9EC1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1003233,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4e/e1/436a7576.jpg","nickname":"çš®çš®å®","note":"","ucode":"18EFAA3BFCDC26","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331782,"discussion_content":"å®å¤§ä¹Ÿæ˜¯ç¥å‡ºé¬¼æ²¡å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606976546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":331683,"ip_address":""},"score":331782,"extra":""}]},{"author":{"id":1520538,"avatar":"https://static001.geekbang.org/account/avatar/00/17/33/9a/f295dea5.jpg","nickname":"ææ­£g","note":"","ucode":"A7BEA03BB6537A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579792,"discussion_content":"ç‘•ä¸æ©ç‘œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657694454,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410274,"discussion_content":"å¹»è¯»ç‰¹æŒ‡è¯»åˆ°äº†æ–°æ’å…¥çš„æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635647890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339623,"user_name":"Geek_35b029","can_delete":false,"product_type":"c1","uid":2898194,"ip_address":"","ucode":"731E04AC894197","user_header":"","comment_is_top":false,"comment_ctime":1648256357,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1648256357","product_id":100046801,"comment_content":"æƒ³é—®ä¸‹â€œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ›´æ–°è´¦æˆ·ä½™é¢åï¼Œä¸èƒ½åªæ£€æŸ¥æ›´æ–°è¯­å¥æ˜¯ä¸æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œè¿˜éœ€è¦æ£€æŸ¥è¿”å›å€¼ä¸­å˜æ›´çš„è¡Œæ•°æ˜¯ä¸æ˜¯ç­‰äº 1ã€‚å› ä¸ºå³ä½¿æµæ°´å·ä¸ç›¸ç­‰ï¼Œä½™é¢æ²¡æœ‰æ›´æ–°ï¼Œè¿™æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œç»“æœä»ç„¶æ˜¯æˆåŠŸçš„ï¼Œåªæ˜¯æ›´æ–°äº† 0 æ¡è®°å½•ã€‚â€ å¯ä»¥ä¸¾ä¸ªä¾‹å­å˜›ï¼Ÿä¸æ˜¯ç‰¹åˆ«æ‡‚","like_count":0},{"had_liked":false,"id":336766,"user_name":"MT006","can_delete":false,"product_type":"c1","uid":1813364,"ip_address":"","ucode":"83C7D7EEBD32C1","user_header":"https://static001.geekbang.org/account/avatar/00/1b/ab/74/286d74c0.jpg","comment_is_top":false,"comment_ctime":1646359244,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1646359244","product_id":100046801,"comment_content":"æˆ‘ä»¬ç»™è´¦æˆ·ä½™é¢è¡¨å¢åŠ ä¸€ä¸ª log_id å±æ€§ï¼Œè®°å½•æœ€åä¸€ç¬”äº¤æ˜“çš„æµæ°´å·ã€‚<br>è¯·é—®ï¼Œè¿™é‡Œçš„æµæ°´å·æ˜¯ä»€ä¹ˆæ—¶é—´ç‚¹è®°å½•è¿›æ¥çš„ï¼Ÿ<br>è®°å½•æµæ°´å·çš„æ“ä½œä¸éœ€è¦åœ¨äº‹åŠ¡é‡Œå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":327285,"user_name":"zcc","can_delete":false,"product_type":"c1","uid":1046664,"ip_address":"","ucode":"58FB42400517A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","comment_is_top":false,"comment_ctime":1640049127,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640049127","product_id":100046801,"comment_content":"æµæ°´åªèƒ½æ–°å¢ï¼Œé‚£ç›¸å½“äºæµæ°´è®°å½•æ˜¯æ— çŠ¶æ€äº†ã€‚è¯·é—®ä¸‹è´¦æˆ·æ³¨é”€æ“ä½œï¼Œæ­¤æ—¶åº”è¯¥ç”Ÿæˆä»€ä¹ˆæ ·çš„æµæ°´ï¼Ÿæ³¨é”€è´¦æˆ·åï¼Œä¹‹å‰çš„å†å²æµæ°´ä¸åº”è¯¥çœ‹åˆ°äº†ï¼Œè¦ç‰©ç†åˆ é™¤è¿˜æ˜¯é€»è¾‘åˆ é™¤ï¼Ÿè´¦æˆ·è®°å½•ä¹Ÿç‰©ç†åˆ é™¤å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":323022,"user_name":"æ»©æ¶‚æ›³å°¾","can_delete":false,"product_type":"c1","uid":1187478,"ip_address":"","ucode":"40F650F2A419D4","user_header":"https://static001.geekbang.org/account/avatar/00/12/1e/96/c735ad6b.jpg","comment_is_top":false,"comment_ctime":1637712121,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637712121","product_id":100046801,"comment_content":"çœ‹ä¸Šå»åŸå­æ€§å’Œä¸€è‡´æ€§æ˜¯åŒä¸€ä»¶äº‹æƒ…ï¼Ÿ","like_count":0},{"had_liked":false,"id":319683,"user_name":"è‘£ä¿Šä¿Š","can_delete":false,"product_type":"c1","uid":1297887,"ip_address":"","ucode":"732300A779660B","user_header":"https://static001.geekbang.org/account/avatar/00/13/cd/df/c520d418.jpg","comment_is_top":false,"comment_ctime":1635908257,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635908257","product_id":100046801,"comment_content":"å®é™…ç”Ÿäº§ç¯å¢ƒä¸­è´¦æˆ·ç³»ç»Ÿè¿˜è¦å’Œä¸‹å•æ‰£åº“å­˜ç­‰åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":312256,"user_name":"Geek_471297","can_delete":false,"product_type":"c1","uid":2765715,"ip_address":"","ucode":"498ADB4810F1EA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJmzuVdR1RbM4LsaPC2POwz3LIbPiapiaaRngsgdV9Z68kG3HicXka9mGjE2hgr4gliay1fut1IyJqDgA/132","comment_is_top":false,"comment_ctime":1631706816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631706816","product_id":100046801,"comment_content":"è¿™ä¹ˆåšé‡åˆ°å¹¶å‘ï¼Œä¼°è®¡å¯¹ä¸ä¸Šè´¦å§ï¼Œä¸æ˜¯åº”è¯¥ç”¨ä¹è§‚é”ï¼Œæ‚²è§‚é”æˆ–è€…åˆ†å¸ƒå¼é”é”ä½è´¦æˆ·å˜å—","like_count":0},{"had_liked":false,"id":304366,"user_name":"æ—é“­é“­","can_delete":false,"product_type":"c1","uid":1068499,"ip_address":"","ucode":"AB392BEE7CD6A0","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/d3/67bdcca9.jpg","comment_is_top":false,"comment_ctime":1627373497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627373497","product_id":100046801,"comment_content":"æ¸©æ•…è€ŒçŸ¥æ–°","like_count":0},{"had_liked":false,"id":297477,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1623571554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623571554","product_id":100046801,"comment_content":"RCéš”ç¦»çº§åˆ«ï¼Œè¯»å·²æäº¤çš„æ•°æ®ï¼Œæ¯å½“æ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œäº‹ç‰©æäº¤åï¼Œæ•°æ®çš„å˜åŒ–ç«‹å³å°±èƒ½è¢«æ„ŸçŸ¥ï¼Œåœ¨è¡Œä¸ºä¸Šï¼Œèƒ½å®æ—¶è·å–æœ€æ–°çš„æ•°æ®ï¼›RRéš”ç¦»çº§åˆ«ï¼Œå¯é‡å¤è¯»ï¼Œåœ¨äº‹ç‰©å¤„ç†è¿‡ç¨‹ä¸­ï¼Œè¯»åˆ°çš„æ•°æ®éƒ½æ˜¯å’Œäº‹ç‰©å¼€å§‹æ—¶ä¿æŒä¸€è‡´ï¼Œå³ä½¿å½“æ•°æ®å·²ç»è¢«å…¶ä»–äº‹ç‰©æ”¹å˜åï¼Œä¹Ÿä¸èƒ½ç«‹å³æ„ŸçŸ¥ï¼Œå› æ­¤ï¼Œåœ¨è¡Œä¸ºä¸Šï¼Œå¯¹æ•°æ®å˜åŒ–çš„æ„ŸçŸ¥èƒ½åŠ›æ¯”è¾ƒæ»åã€‚","like_count":0},{"had_liked":false,"id":287358,"user_name":"å¤œè¾‰","can_delete":false,"product_type":"c1","uid":1886331,"ip_address":"","ucode":"9421385F51FF9E","user_header":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","comment_is_top":false,"comment_ctime":1617899710,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617899710","product_id":100046801,"comment_content":"åŠ ä¸Šä½™é¢æµæ°´çš„IDï¼Œä¿è¯æœ‰ä¸€ä¸ªæ›´æ–°ä¼šå¤±è´¥ï¼Œåœ¨äº‹åŠ¡ä¸­åŠ ä¸Šä½™é¢éè´Ÿçš„é€»è¾‘åˆ¤æ–­ï¼Œé¿å…è´¦æˆ·ä½™é¢æ‰£ä¸ºè´Ÿæ•°","like_count":0},{"had_liked":false,"id":286397,"user_name":"å‡¯æ–‡å°çŒª","can_delete":false,"product_type":"c1","uid":1980201,"ip_address":"","ucode":"36D8AD0229547F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","comment_is_top":false,"comment_ctime":1617279989,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617279989","product_id":100046801,"comment_content":"æˆ‘ä»¬çº¿ä¸Šæ˜¯åšåˆ†å¸ƒå¼äº‹åŠ¡çš„ èµ„äº§ä¸æµæ°´æ˜¯åˆ†å¼€å­˜æ”¾ å› ä¸ºæµæ°´è¡¨å®åœ¨æ˜¯å¤ªå¤§äº† æ²¡æ³•åšæœ¬åœ°äº‹åŠ¡ã€‚å…·ä½“å°±æ˜¯update account<br>set balance = balance - @delta<br>where uid = @uid<br>and balance &gt;= @delta<br>é€šè¿‡uidçš„è¡Œé”æ¥å®ç° æµæ°´è¡¨å†ç”¨æ¶ˆè´¹è€…æ…¢æ…¢insertè¿›å»","like_count":0},{"had_liked":false,"id":255771,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1603425276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603425276","product_id":100046801,"comment_content":"RRçº§åˆ«è¿™ä¸ªå¹»è¯»ç°è±¡æ˜¯ä¸æ˜¯å°±æ˜¯ä¸å¯é‡å¤è¯»ç±»ï¼ŸRCçº§åˆ«ä¸‹é¢æ€ä¹ˆæ ·èƒ½å¤Ÿé‡ç°å¹»è¯»å‹’ï¼Ÿ","like_count":0},{"had_liked":false,"id":252203,"user_name":"éš°æœ‰è·","can_delete":false,"product_type":"c1","uid":1357944,"ip_address":"","ucode":"2BE9A32AB28963","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/78/2828195b.jpg","comment_is_top":false,"comment_ctime":1602177084,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602177084","product_id":100046801,"comment_content":"è€å¸ˆï¼Œå¦‚æœä½™é¢è¡¨ä¸åŠ log_idï¼ŒRRéš”ç¦»çº§åˆ«ä¸‹ï¼Œå¦‚æœäº‹åŠ¡Aåœ¨å¯¹æ—§æ•°æ®æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®è¡¨ä¸­çš„æ•°æ®ä¼šè¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹å—ï¼Ÿæ•°æ®åº“æ˜¯ä¸æ˜¯åº”è¯¥æœ‰ä»€ä¹ˆæœºåˆ¶å¯ä»¥é¿å…å¤šä¸ªäº‹åŠ¡å…±åŒä¿®æ”¹åŒä¸€æ¡æ•°æ®å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":231450,"user_name":"æ–œæ é’å¹´","can_delete":false,"product_type":"c1","uid":1177739,"ip_address":"","ucode":"D7AF02B8588549","user_header":"https://static001.geekbang.org/account/avatar/00/11/f8/8b/74d2ab6b.jpg","comment_is_top":false,"comment_ctime":1593679108,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1593679108","product_id":100046801,"comment_content":"RRçº§åˆ«å¦‚ä½•å‡ºç°å¹»è¯»ï¼Œèƒ½å¦ä¸¾ä¸ªä¾‹å­ï¼ŒRRçº§åˆ«æ˜¯æŒ‡å¯é‡å¤è¯»ï¼Œè¯»å–çš„æ•°æ®åœ¨äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸä¸‹ éƒ½æ˜¯ä¸€æ ·çš„ã€‚è¿™æ ·å¯ä»¥å—ï¼Ÿäº‹åŠ¡A begin update account_balance set balance = balance + 100;","like_count":0,"discussions":[{"author":{"id":2174684,"avatar":"https://static001.geekbang.org/account/avatar/00/21/2e/dc/5b4b1de0.jpg","nickname":"ç‹ä¿Šæ°","note":"","ucode":"C27EC943D8786F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305023,"discussion_content":"ç½‘ç»œæ³¢åŠ¨çš„æ—¶å€™ï¼Œä¼šä¸ä¼šå¤šè°ƒä¸¤æ¬¡sql","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599743392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":227330,"user_name":"MClink","can_delete":false,"product_type":"c1","uid":1435733,"ip_address":"","ucode":"F479190923355C","user_header":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","comment_is_top":false,"comment_ctime":1592358843,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1592358843","product_id":100046801,"comment_content":"mysql ä¸ºå•¥é»˜è®¤ç”¨å¯é‡å¤è¯»ä½œä¸ºé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œç½‘ä¸ŠæŸ¥åˆ°æ˜¯è¯´å› ä¸ºä¸»ä»å¤åˆ¶ä¸­ï¼Œbinglog æ ¼å¼å¦‚æœæ˜¯ STATEMENT ï¼Œä¼šå‡ºç°ä¸»ä»ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå› ä¸ºæ­¤æ ¼å¼ä¸‹åœ¨masterä¸Šæ‰§è¡Œçš„é¡ºåºä¸ºå…ˆåˆ åæ’ï¼è€Œæ­¤æ—¶binlogä¸ºSTATEMENTæ ¼å¼ï¼Œå®ƒè®°å½•çš„é¡ºåºä¸ºå…ˆæ’ååˆ ï¼ä»(slave)åŒæ­¥çš„æ˜¯binglogï¼Œå› æ­¤ä»æœºæ‰§è¡Œçš„é¡ºåºå’Œä¸»æœºä¸ä¸€è‡´ï¼Œé™¤äº†è¿™ä¸ªè¿˜æœ‰å…¶ä»–çš„åŸå› å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":226854,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1592217416,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592217416","product_id":100046801,"comment_content":"RCï¼šè¯»å·²æäº¤ï¼Œåœ¨äº‹ç‰©å†…ï¼Œæ¯æ¡sqlã€‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œæ‰€ä»¥ï¼Œåœ¨è¯»çš„æ—¶å€™ï¼Œå¦‚æœåˆ«çš„äº‹ç‰©æœ‰æäº¤ï¼Œå®ƒåˆ›å»ºçš„è§†å›¾æ˜¯å¯ä»¥æ‹¿åˆ°å…¶å®ƒäº‹ç‰©å·²æäº¤çš„æ•°æ®çš„ï¼›<br>RRï¼šåœ¨äº‹ç‰©ä¸€å¼€å§‹ï¼Œåªåˆ›å»ºä¸€ä¸ªä¸€è‡´æ€§è§†å›¾ï¼Œåœ¨äº‹ç‰©æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéƒ½æ˜¯ä»¥è¿™ä¸ªè§†å›¾ä¸ºå‡†ï¼ŒåŒä¸€è¡Œè®°å½•ï¼Œè¢«å¤šä¸ªäº‹ç‰©æ“ä½œï¼Œä¼šæœ‰å¤šä¸ªæ•°æ®ç‰ˆæœ¬ï¼ŒMysqlä¼šè®°å½•å›æ»šæ—¥å¿—ï¼Œä»¥åŠåœ¨è¡Œé”çš„é…åˆä¸‹ï¼Œèƒ½ä¿è¯äº‹ç‰©å°±ç®—å›æ»šï¼Œä¹Ÿä¸å—å…¶ä»–äº‹ç‰©å½±å“ï¼Œå¦‚æœåˆ«çš„äº‹ç‰©æ›´æ–°äº†è®°å½•ï¼Œå½“å‰äº‹ç‰©è¯»åˆ°çš„è¿˜æ˜¯è‡ªå·±çš„æ•°æ®ç‰ˆæœ¬ã€‚","like_count":0},{"had_liked":false,"id":226237,"user_name":"zz","can_delete":false,"product_type":"c1","uid":1293835,"ip_address":"","ucode":"EFE0C8D60D0CAC","user_header":"https://static001.geekbang.org/account/avatar/00/13/be/0b/0a381067.jpg","comment_is_top":false,"comment_ctime":1592012810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592012810","product_id":100046801,"comment_content":"æˆ‘é‡åˆ°å¤§å¤šæ•°å¸å¯¹ä¸ä¸Šçš„æƒ…å†µåŸºæœ¬éƒ½æ˜¯è´¢åŠ¡ç®¡ç†æ··ä¹±å¯¼è‡´çš„ï¼Œè´¢åŠ¡åŠŸèƒ½ç»å¸¸å˜åŠ¨ï¼Œè®°è´¦è½¬è‡ªåŠ¨åŒ–ï¼Œéƒ½æ˜¯è´¦ç›®æ··ä¹±çš„åŸå› ã€‚","like_count":0},{"had_liked":false,"id":221343,"user_name":"æçª","can_delete":false,"product_type":"c1","uid":1694456,"ip_address":"","ucode":"66A02520B3F2AC","user_header":"https://static001.geekbang.org/account/avatar/00/19/da/f8/8ebac3d8.jpg","comment_is_top":false,"comment_ctime":1590478581,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590478581","product_id":100046801,"comment_content":"åŠ log_idè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿåœ¨æ›´æ–°ä½™é¢è¿™ä¸ªåœºæ™¯ä¸‹æ˜¯å¦æœ‰å¿…è¦","like_count":0},{"had_liked":false,"id":220207,"user_name":"æœ¨æœ¨å¤•","can_delete":false,"product_type":"c1","uid":1526471,"ip_address":"","ucode":"EA5D709D0DE50E","user_header":"https://static001.geekbang.org/account/avatar/00/17/4a/c7/0cff4a59.jpg","comment_is_top":false,"comment_ctime":1590203837,"is_pvip":false,"replies":[{"id":"81463","content":"å¦‚æœä½ ç”¨ä»£ç å»æ‰§è¡Œinsertè¯­å¥ï¼Œå¤§å¤šæ•°ORMæ¡†æ¶åœ¨è¿”å›å€¼ä¸­ï¼Œå°±åŒ…å«åˆšåˆšæ’å…¥æ•°æ®çš„ä¸»é”®å€¼ï¼Œä¸éœ€è¦å†æ‰§è¡ŒLAST_INSERT_ID()è·å–äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1590368884,"ip_address":"","comment_id":220207,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590203837","product_id":100046801,"comment_content":"è€å¸ˆï¼Œ LAST_INSERT_ID() è¿™ä¸ªSQLå‡½æ•°ï¼Œå¦‚æœåœ¨ä¸šåŠ¡ä»£ç ä¸­æ‰§è¡Œçš„é¡ºåºæ˜¯accountLogMapper.insert()    æ¥ç€æ‰§è¡ŒXXXMapper.insert() æœ€åæ‰æ˜¯accountBalanceMapper.update()  -&gt; update account_balance set balance = balance + 100, log_id = LAST_INSERT_ID(), timestamp = NOW() where user_id = 0 and log_id = 3;  LAST_INSERT_ID()ä¼šè‡ªåŠ¨è¯†åˆ«accountLogMapper.insert()çš„LAST_INSERT_IDçš„å—ï¼Ÿè¿˜æ˜¯è¯´æ‹¿åˆ°accountLogMapper.insert()è¿”å›çš„LAST_INSERT_ID å†ä¼ å…¥accountBalanceMapper.update(LAST_INSERT_ID)å»æ›´æ–°ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496084,"discussion_content":"å¦‚æœä½ ç”¨ä»£ç å»æ‰§è¡Œinsertè¯­å¥ï¼Œå¤§å¤šæ•°ORMæ¡†æ¶åœ¨è¿”å›å€¼ä¸­ï¼Œå°±åŒ…å«åˆšåˆšæ’å…¥æ•°æ®çš„ä¸»é”®å€¼ï¼Œä¸éœ€è¦å†æ‰§è¡ŒLAST_INSERT_ID()è·å–äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590368884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217193,"user_name":"å¤§å¤´çˆ¸çˆ¸","can_delete":false,"product_type":"c1","uid":1276613,"ip_address":"","ucode":"131E25DB04D222","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/gmP4Yh00MZPwNvr4UQdLeXaX3TVyZEEp195S3vD3Sfl1xz5jBr1474Mt6w5OPr0KsrnQObfLRy5PkKNFjSBiasA/132","comment_is_top":false,"comment_ctime":1589437107,"is_pvip":false,"replies":[{"id":"80329","content":"æˆ‘ä»¬ä¸ºäº†è®²æ¸…æ¥šæŠ€æœ¯ï¼Œä¼šå°½é‡æŠŠæ— å…³çš„ä¸œè¥¿å‰¥ç¦»å¹²å‡€ï¼Œæ‰€ä»¥æ˜¯æ‰‹å†™çš„SQLã€‚å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªé€»è¾‘åº”è¯¥åœ¨ä¸šåŠ¡ä»£ç ä¸­å®ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589461638,"ip_address":"","comment_id":217193,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589437107","product_id":100046801,"comment_content":"è¯·é—®ï¼Œé‚£ä¸ªæ•´ä¸ªäº¤æ˜“çš„ SQLé‡Œé¢ï¼Œ<br>æˆ‘ä»¬è¦å…ˆæŸ¥åˆ°log_id = 3; ç„¶åset balancesé‡Œé¢è®¾å®šwhere log_id=3ï¼Œ<br>æ€ä¹ˆæ‰èƒ½æŠŠå®ƒææˆé€šç”¨çš„å‘¢ï¼Ÿæ¯•ç«Ÿæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨æŸ¥å¾ˆéº»çƒ¦ï¼Œè¦æ˜¯ä¸‹æ¬¡log_id=5, SQLè¯­å¥åˆè¦é‡æ”¹ã€‚","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495071,"discussion_content":"æˆ‘ä»¬ä¸ºäº†è®²æ¸…æ¥šæŠ€æœ¯ï¼Œä¼šå°½é‡æŠŠæ— å…³çš„ä¸œè¥¿å‰¥ç¦»å¹²å‡€ï¼Œæ‰€ä»¥æ˜¯æ‰‹å†™çš„SQLã€‚å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªé€»è¾‘åº”è¯¥åœ¨ä¸šåŠ¡ä»£ç ä¸­å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589461638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210640,"user_name":"é¹å°è”¡","can_delete":false,"product_type":"c1","uid":1302573,"ip_address":"","ucode":"EA0EBE6817261D","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/2d/1332fad1.jpg","comment_is_top":false,"comment_ctime":1587801216,"is_pvip":false,"replies":[{"id":"78782","content":"è¿™ä¸ªæµæ°´å·æ˜¯è‡ªå¢IDï¼Œæ‰€ä»¥Insertçš„æ—¶å€™ä¸éœ€è¦æŒ‡å®šã€‚LAST_INSERT_ID()å¯ä»¥è·å¾—ä¸Šæ¬¡insertçš„è‡ªå¢IDï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•æ˜¯ç»‘å®šä¼šè¯çš„ï¼Œæ‰€ä»¥ï¼Œå³ä½¿ä½ ä¸Šæ¬¡æ’å…¥æ•°æ®ä¹‹åï¼Œæœ‰å…¶ä»–çš„ä¼šè¯æ’å…¥äº†æ–°æ•°æ®ï¼ŒLAST_INSERT_ID()è¿”å›çš„ä»ç„¶æ˜¯ä½ è¿™ä¸ªä¼šè¯ä¸Šæ¬¡æ’å…¥è®°å½•çš„ID","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1588048660,"ip_address":"","comment_id":210640,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587801216","product_id":100046801,"comment_content":"æsirï¼Œä¸Šé¢çš„ä¾‹å­è¯´åœ¨å…ˆè´¦æˆ·è¡¨æ’å…¥æœ€åä¸€ç¬”æ›´æ–°çš„æµæ°´å·ï¼Œä½†æ˜¯åœ¨æ’å…¥æµæ°´è¡¨çš„æ—¶å€™å´æ²¡æœ‰insertæµæ°´å·ï¼Œè¿™ä¸¤ä¸ªæµæ°´å·ä¸ä¼šä¸ä¸€æ ·å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493072,"discussion_content":"è¿™ä¸ªæµæ°´å·æ˜¯è‡ªå¢IDï¼Œæ‰€ä»¥Insertçš„æ—¶å€™ä¸éœ€è¦æŒ‡å®šã€‚LAST_INSERT_ID()å¯ä»¥è·å¾—ä¸Šæ¬¡insertçš„è‡ªå¢IDï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•æ˜¯ç»‘å®šä¼šè¯çš„ï¼Œæ‰€ä»¥ï¼Œå³ä½¿ä½ ä¸Šæ¬¡æ’å…¥æ•°æ®ä¹‹åï¼Œæœ‰å…¶ä»–çš„ä¼šè¯æ’å…¥äº†æ–°æ•°æ®ï¼ŒLAST_INSERT_ID()è¿”å›çš„ä»ç„¶æ˜¯ä½ è¿™ä¸ªä¼šè¯ä¸Šæ¬¡æ’å…¥è®°å½•çš„ID","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588048660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208359,"user_name":"æ¥¼ä¸‹å°é»‘å“¥","can_delete":false,"product_type":"c1","uid":1014680,"ip_address":"","ucode":"453B099B0EE52E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/98/8f1aecf4.jpg","comment_is_top":false,"comment_ctime":1587344910,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587344910","product_id":100046801,"comment_content":"åŒä¸€ä¸ªäº‹åŠ¡çš„è¯ï¼Œçƒ­ç‚¹è´¦æˆ·é—®é¢˜å°±ä¸å¥½è§£å†³ï¼Œè¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œå¯¹äºçƒ­ç‚¹è´¦æˆ·é—®é¢˜è§£å†³æ–¹æ¡ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":204668,"user_name":"Yezhiwei","can_delete":false,"product_type":"c1","uid":1005157,"ip_address":"","ucode":"31E8E33688CBEC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","comment_is_top":false,"comment_ctime":1586439913,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586439913","product_id":100046801,"comment_content":"è€å¸ˆï¼Œè¯·é—®è´¦æˆ·ç³»ç»Ÿçš„è¡¨è®¾è®¡ä¼šç”¨åˆ°è´¢åŠ¡ä¸Šçš„å¤å¼è®°è´¦å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":192540,"user_name":"åŠ æ²¹å§å¨åŸºåŸº","can_delete":false,"product_type":"c1","uid":1815912,"ip_address":"","ucode":"86CB4B78F3859D","user_header":"","comment_is_top":false,"comment_ctime":1584858890,"is_pvip":false,"replies":[{"id":"73872","content":"ç¡®å®æ˜¯è¿™æ ·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1585013805,"ip_address":"","comment_id":192540,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1584858890","product_id":100046801,"comment_content":"è€å¸ˆï¼Œæ‚¨æ–‡ä¸­æåˆ°çš„ä½™é¢å±äºæ•°æ®å†—ä½™ä½†æ˜¯æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œè¿™å°±æ˜¯åèŒƒå¼è®¾è®¡å§","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488417,"discussion_content":"ç¡®å®æ˜¯è¿™æ ·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585013805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191491,"user_name":"james","can_delete":false,"product_type":"c1","uid":1049208,"ip_address":"","ucode":"5701899403917C","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/78/23c56bce.jpg","comment_is_top":false,"comment_ctime":1584777563,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584777563","product_id":100046801,"comment_content":"è¿™ä¸ªåŸºäºä¹è§‚é”çš„æ›´æ–°ä½™é¢å¹¶ä¸å’‹é€šç”¨ï¼Œæœ€é€šç”¨çš„è¿˜æ˜¯åˆ†å¸ƒå¼é”ï¼Œç¼ºç‚¹æœ‰æ—¥å¿—è¡¨ä¸æ˜¯æ•°æ®åº“è¡¨æˆ–è€…ä¸åœ¨ä¸€ä¸ªæ•°æ®åº“æ²¡æ³•ç”¨äº‹åŠ¡ï¼Œè¿˜æœ‰ç”¨æˆ·ä½™é¢è®°å½•å¦‚æœåœ¨è¡¨é‡Œé¢æ²¡æœ‰è¿˜å¾—è€ƒè™‘åŠ é”æ’å…¥çš„é—®é¢˜","like_count":0},{"had_liked":false,"id":188229,"user_name":"é£ç¿”","can_delete":false,"product_type":"c1","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1584329185,"is_pvip":true,"replies":[{"id":"72789","content":"ä½ å¯ä»¥è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹ç»“æœåˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1584410710,"ip_address":"","comment_id":188229,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1584329185","product_id":100046801,"comment_content":"sql&gt; update account_balance -&gt; set balance = balance + 100, log_id = LAST_INSERT_ID(), timestamp = NOW() -&gt; where user_id = 0 and log_id = 3;Query OK, 1 row affected (0.00 sec)Rows matched: 1 Changed: 1 Warnings: 0 <br>è€å¸ˆåœ¨RR å¯é‡å¤è¯»çš„çŠ¶å†µä¸‹ï¼Œ å¦‚æœä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†æµæ°´å·ä»3åˆ°log_id=4ï¼Œå¹¶ä¸”æäº¤ï¼Œ ä½†æ˜¯å¦ä¸€ä¸ªäº‹åŠ¡åº”ä¸ºæ˜¯å¯é‡å¤è¯»ï¼Œä»–è¯»åˆ°çš„æµæ°´å·ä¸€ç›´æ˜¯3å‘€ï¼Œ è¿™æ ·LAST_INSERT_ID() ä»–çš„å€¼ä¸ä¹Ÿæ˜¯3 å˜›ï¼Œ è¿™æ ·å¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿä¼šæ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯ç»“æœå°±æ˜¯ä¸å¯¹çš„äº†å‘€","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487358,"discussion_content":"ä½ å¯ä»¥è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹ç»“æœåˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584410710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1230031,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c4/cf/6e1205cc.jpg","nickname":"é©¬æ™¨é˜³","note":"","ucode":"344ACC3BF7F14A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":220177,"discussion_content":"æ›´æ–°è¯»å§ï¼Œæ’ä¸è¿›å»çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585839483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1036370,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d0/52/014accaf.jpg","nickname":"åˆ’è¿‡å¤©ç©ºé˜¿å¿ ","note":"","ucode":"9D9BEE73031E40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213929,"discussion_content":"æœ‰ä¸€ä¸ªä¼šæ’å…¥å¤±è´¥å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585135360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1306032,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","nickname":"æ¡‚åŸè€æ‰˜å°¼","note":"","ucode":"139E4B8EE88B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213382,"discussion_content":"ä¼šæ‰§è¡ŒæˆåŠŸï¼Œä½†update 0è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585065997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185241,"user_name":"GeekAmI","can_delete":false,"product_type":"c1","uid":1005030,"ip_address":"","ucode":"232C0B6DFB9F56","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/e6/87197b10.jpg","comment_is_top":false,"comment_ctime":1583544938,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583544938","product_id":100046801,"comment_content":"è¯·é—®è€å¸ˆï¼ŒæŸ¥ä½™é¢ä¸æ’å…¥äº¤æ˜“è®°å½•ã€æ›´æ–°ä½™é¢ï¼Œä¸éœ€è¦æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œå§ï¼Œå¯ä»¥é™ä½äº‹åŠ¡çš„ç²’åº¦ã€‚","like_count":0,"discussions":[{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252120,"discussion_content":"ä¸æ”¾åœ¨ä¸€èµ·æ€ä¹ˆä¿è¯ä¸€è‡´æ€§ğŸ¤£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588142566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185172,"user_name":"ğŸ³å¤§æµ·å…¨æ˜¯æ°´","can_delete":false,"product_type":"c1","uid":1295883,"ip_address":"","ucode":"8FB523F8D54D8B","user_header":"https://static001.geekbang.org/account/avatar/00/13/c6/0b/eb3589f1.jpg","comment_is_top":false,"comment_ctime":1583504197,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583504197","product_id":100046801,"comment_content":"æ›´æ–°è¯­å¥ä¸­ä½¿ç”¨last_insert_id()æ˜¯å¦æ˜¯æœ€å¥½çš„å®è·µå‘¢ï¼Ÿå¦‚æœä¸Šä¸€æ¡è¯­å¥insert into account_log values -&gt; (NULL, 100, NOW(), 1, 1001, NULL, 0, NULL, 0, 0);è¿™é‡Œæ’å…¥äº†å¤šæ¡è¯­å¥ï¼Œlast_insert_idåªè¿”å›äº†ç¬¬ä¸€æ¡ä¿®æ”¹è¿‡åçš„idå€¼ï¼Œè€Œä¸”è¿™2æ¡è¯­å¥ä¸­ä¸èƒ½å†æœ‰insertå…¶ä»–è¡¨çš„è¯­å¥äº†ã€‚æˆ‘çš„æ„æ€æ˜¯è¿™é‡Œçš„ä»£ç å°±ä¸å®¹æ˜“ç»´æŠ¤äº†ï¼Œæœ‰æ²¡æœ‰å…¶ä»–æ›´å¥½çš„æ–¹æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252127,"discussion_content":"ä½¿ç”¨GUID","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588142784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184898,"user_name":"o9","can_delete":false,"product_type":"c1","uid":1101332,"ip_address":"","ucode":"E373E82A39BBFE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/14/b488f241.jpg","comment_is_top":false,"comment_ctime":1583427472,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583427472","product_id":100046801,"comment_content":"æ·±å…¥æµ…å‡ºï¼<br><br>å¯¹äº RC éš”ç¦»çº§åˆ«è€Œè¨€ï¼Œå¹¶å‘é«˜çš„æƒ…å†µä¸‹ä¼šå‡ºç°ï¼Œç”±äºæ›´æ–°ä½™é¢æ—¶æœ‰ where log_id = æ›´æ–°ä¹‹å‰æŸ¥è¯¢çš„log_id æ‰€ä»¥æ›´æ–°æ¡æ•°ä¸º 0 ï¼Œå›æ»šï¼Œå……å€¼å¤±è´¥ï¼Œä¸å½±å“æ•°æ®çš„ä¸€è‡´æ€§ã€‚<br><br>å¯¹äº RR éš”ç¦»çº§åˆ«è€Œè¨€ï¼Œç”±äºæ˜¯å¯é‡å¤è¯»çš„ï¼Œæ‰€ä»¥ æ›´æ–°ä½™é¢çš„ sql å¯ä»¥æ‰§è¡ŒæˆåŠŸã€‚","like_count":0},{"had_liked":false,"id":184830,"user_name":"é™ˆé–","can_delete":false,"product_type":"c1","uid":1147418,"ip_address":"","ucode":"8C9596A54DB5C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/1a/64ec25ff.jpg","comment_is_top":false,"comment_ctime":1583415065,"is_pvip":false,"replies":[{"id":"71649","content":"åœ¨äº‹åŠ¡å†…åŠ ä¸Šä½™é¢æ£€æŸ¥çš„é€»è¾‘å°±å¯ä»¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1583636203,"ip_address":"","comment_id":184830,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1583415065","product_id":100046801,"comment_content":"å‡å¦‚ä¸¤ä¸ªäº‹åŠ¡ä¸€èµ·æ‰§è¡Œï¼ŒæŠŠä½™é¢æ‰£æˆè´Ÿæ•°äº†ï¼Œè€Œä¸¤ä¸ªäº‹åŠ¡éƒ½æ‰§è¡Œäº†ï¼Œè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486138,"discussion_content":"åœ¨äº‹åŠ¡å†…åŠ ä¸Šä½™é¢æ£€æŸ¥çš„é€»è¾‘å°±å¯ä»¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583636203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1147418,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/1a/64ec25ff.jpg","nickname":"é™ˆé–","note":"","ucode":"8C9596A54DB5C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257419,"discussion_content":"è¿™ä¸ªåº”è¯¥è¿˜è¦çœ‹éš”ç¦»çº§åˆ«ï¼Œæœ‰è¡Œé”ä¸ä»£è¡¨å¦ä¸€ä¸ªä¼šå¤±è´¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588568819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252100,"discussion_content":"è¿™é‡Œåº”è¯¥ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µå§ï¼Ÿä¸¤ä¸ªäº‹åŠ¡åº”è¯¥æ˜¯æœ‰å…ˆåå…³ç³»çš„ï¼Œupdateæœ‰è¡Œé”ï¼Œåé¢é‚£ä¸ªäº‹åŠ¡åœ¨updateä½™é¢æ—¶ï¼Œlog_idåº”è¯¥æ˜¯å·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œå› æ­¤åé¢çš„äº‹åŠ¡åœ¨updateä½™é¢æ—¶ï¼Œåº”è¯¥ä¼šæ›´æ–°å¤±è´¥å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588141683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1147418,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/1a/64ec25ff.jpg","nickname":"é™ˆé–","note":"","ucode":"8C9596A54DB5C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":252980,"discussion_content":"ä¸¤ä¸ªäº‹ç‰©åˆ†åˆ«åœ¨ä¸åŒçº¿ç¨‹ï¼Œæ˜¯å¯ä»¥åŒæ—¶æ‰§è¡Œçš„å“¦ï¼Œä½ å¯ä»¥è¯•è¯•åˆ†åˆ«åœ¨ä¸¤ä¸ªç»ˆç«¯è¿æ¥ä¸Šå»ï¼Œåˆ†åˆ«ä¸€è¡Œä¸€è¡Œçš„æ‰§è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588208559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":252100,"ip_address":""},"score":252980,"extra":""},{"author":{"id":1433535,"avatar":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","nickname":"ğŸ˜š 46","note":"","ucode":"EED0EBBBF80A43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1147418,"avatar":"https://static001.geekbang.org/account/avatar/00/11/82/1a/64ec25ff.jpg","nickname":"é™ˆé–","note":"","ucode":"8C9596A54DB5C8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":254188,"discussion_content":"ä¸¤ä¸ªäº‹åŠ¡å¹¶å‘æ›´æ–°ä¸€æ¡è®°å½•æ˜¯æœ‰é”çš„ã€‚åé¢æ‰§è¡Œçš„äº‹åŠ¡çš„updateæ“ä½œçš„æ›´æ–°è¡Œæ•°æ˜¯0ï¼Œå› ä¸ºlog_idå·²ç»å˜åŒ–äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588299564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":252980,"ip_address":""},"score":254188,"extra":""}]}]},{"had_liked":false,"id":184717,"user_name":"å¤§ç§¦çš‡æœ","can_delete":false,"product_type":"c1","uid":1301113,"ip_address":"","ucode":"0F72D0D2FAEAF2","user_header":"https://static001.geekbang.org/account/avatar/00/13/da/79/9b093890.jpg","comment_is_top":false,"comment_ctime":1583390734,"is_pvip":false,"replies":[{"id":"71648","content":"æˆ‘ä¹Ÿæ²¡æœ‰ä¸“é—¨å¯¹æ¯”æµ‹è¯•è¿‡äºŒè€…çš„æ€§èƒ½å·®è·ï¼Œç»éªŒä¸Šçœ‹ï¼Œä¹Ÿæ˜¯å’Œä½ æµ‹è¯•ç»“æœå·®ä¸å¤šï¼ŒäºŒè€…æ€§èƒ½å·®è·åº”è¯¥ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1583636072,"ip_address":"","comment_id":184717,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1583390734","product_id":100046801,"comment_content":"æSirï¼Œèƒ½å¦å¤§æ¦‚æä¸€ä¸‹RCå’ŒRRåœ¨ä¸€èˆ¬æƒ…å†µä¸‹åœ¨å¤šå°‘æ•°æ®é‡çº§åˆ«ï¼Œæ€§èƒ½å·®è·èƒ½æœ‰å¤šå°‘ï¼Ÿä½œä¸ºå°ç™½æ¥è¯´ï¼Œè‡ªå·±åšè¿™ç§æµ‹è¯•è²Œä¼¼å—åˆ°å…¶å®ƒå¤–ç•Œå› ç´ å½±å“è¾ƒå¤§ï¼Œå®é™…æµ‹è¯•å‡ºæ¥å¥½åƒæ„Ÿè§‰ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚å› ä¸ºæ‚¨å¯èƒ½æ¯”è¾ƒæœ‰ç»éªŒæˆ–è€…ç»å†è¿‡ï¼Œæ‰€ä»¥æƒ³è¯·æ•™ä¸‹æ‚¨èƒ½å¦å¤§æ¦‚è¯´è¯´ï¼Ÿæ„Ÿè°¢ï¼","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486107,"discussion_content":"æˆ‘ä¹Ÿæ²¡æœ‰ä¸“é—¨å¯¹æ¯”æµ‹è¯•è¿‡äºŒè€…çš„æ€§èƒ½å·®è·ï¼Œç»éªŒä¸Šçœ‹ï¼Œä¹Ÿæ˜¯å’Œä½ æµ‹è¯•ç»“æœå·®ä¸å¤šï¼ŒäºŒè€…æ€§èƒ½å·®è·åº”è¯¥ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583636072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184627,"user_name":"è‚¥low","can_delete":false,"product_type":"c1","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1583374036,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583374036","product_id":100046801,"comment_content":"é¦–å…ˆèµä¸€ä¸‹æ’ç‰ˆ é—®é¢˜éš¾é“æ˜¯æƒ³é—®MVCCä¹ˆ ä¸¤ç§çº§åˆ«ç”Ÿæˆå¿«ç…§æ—¶æœºä¸åŒï¼Ÿ","like_count":0},{"had_liked":false,"id":184608,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1583370541,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583370541","product_id":100046801,"comment_content":"åˆå·©å›ºäº†ä¸€éäº‹åŠ¡çš„é—®é¢˜ï¼Œä¸è¿‡è¿™å—ç¡®å®å®¹æ˜“è’™ï¼Œå°¤å…¶æ˜¯é¢è¯•ä¸­ï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±ä¸‹å»æ¢³ç†æ•´ç†ä¸€ä¸‹ï¼ŒåŠ æ·±å°è±¡","like_count":0},{"had_liked":false,"id":184598,"user_name":"ä½•å¦¨","can_delete":false,"product_type":"c1","uid":1385377,"ip_address":"","ucode":"EC3983BFF7992A","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg","comment_is_top":false,"comment_ctime":1583369496,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583369496","product_id":100046801,"comment_content":"æˆ‘åœ¨è€ƒè™‘çš„æ˜¯ï¼Œæ›´æ–°è´¦æˆ·ä½™é¢çš„æ—¶å€™æ˜¯ä¸æ˜¯åº”è¯¥åŒæ—¶æ›´æ–°ä¸€ä¸‹æœ€åä¸€ç¬”äº¤æ˜“æµæ°´çš„idå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":184596,"user_name":"zcc","can_delete":false,"product_type":"c1","uid":1046664,"ip_address":"","ucode":"58FB42400517A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","comment_is_top":false,"comment_ctime":1583368727,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1583368727","product_id":100046801,"comment_content":"è€å¸ˆï¼ŒDDLè¯­å¥ï¼Œä¸ºä»€ä¹ˆæ’å…¥æµæ°´è¡¨æ—¶ï¼Œä¸è®°å½•è´¦æˆ·ä½™é¢è¡¨çš„ä¸»é”®å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196807,"discussion_content":"è¿™ä¸ªåœ°æ–¹çš„è®¾è®¡æ˜¯ï¼Œè§†è½¬å…¥è¿˜æ˜¯è½¬å‡ºï¼Œto_account å’Œ from_accoutè®°å½•ä½™é¢è¡¨çš„ä¸»é”®ã€‚ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583374383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1046664,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/88/96b870fd.jpg","nickname":"zcc","note":"","ucode":"58FB42400517A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":197102,"discussion_content":"å¥½çš„ï¼Œè°¢è°¢ï¼å–œæ¬¢å¬æ‚¨çš„ä¸“æ ï¼Œè®²æ•…äº‹ä¸€æ ·ç”ŸåŠ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583406872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":196807,"ip_address":""},"score":197102,"extra":""},{"author":{"id":1013683,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","nickname":"å…¬å·-æŠ€æœ¯å¤œæœªçœ ","note":"","ucode":"83825B57CBD952","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":197477,"discussion_content":"æè€å¸ˆçš„å†…å®¹å¾ˆæ¥åœ°æ°”äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583420774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":196807,"ip_address":""},"score":197477,"extra":""}]}]}]}