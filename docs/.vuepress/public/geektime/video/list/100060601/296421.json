{"id":296421,"title":"15 | 语法面面观：智能指针（一）","content":"<p><strong>课件及Demo下载链接</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-Rust\">https://gitee.com/geektime-geekbang/geektime-Rust</a></p>","comments":[{"had_liked":false,"id":295157,"user_name":"刘文同","can_delete":false,"product_type":"c3","uid":1170860,"ip_address":"","ucode":"12F8F3C3FA195D","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/ac/cfcf3259.jpg","comment_is_top":false,"comment_ctime":1622275863,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100060601,"comment_content":"基本的值语义定义在 std 中，而 Deref 也定义在 std 中，所以根据孤儿原则， 我们是没办法给 u32, [u32; 3] 这种类型实现 Deref 的。\n会报错：\nerror[E0117]: only traits defined in the current crate can be implemented for arbitrary types\n impl doesn&#39;t use only types from inside the current crate","like_count":2},{"had_liked":false,"id":254065,"user_name":"神 一生有你","can_delete":false,"product_type":"c3","uid":1047574,"ip_address":"","ucode":"423AD11359E265","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/16/0a3f1c15.jpg","comment_is_top":false,"comment_ctime":1603034359,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100060601,"comment_content":"我记得Box内部应该是编译器特殊处理了，&amp;**self就和&amp;*self.0效果是一样的，&amp;**self,*self解引用box,再*就是box包裹的T(这应该是编译器特殊处理的)，然后再&amp;就是包裹的引用","like_count":1,"discussions":[{"author":{"id":1111835,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/1b/db7a0edc.jpg","nickname":"Marvichov","note":"","ucode":"7482099415C41C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373121,"discussion_content":"Box<T> doesn&#39;t call Deref (https://github.com/rust-lang/rfcs/issues/1850#issuecomment-271768749)\n\n> This is because Box<T> is special. *b on a box does not call Deref::deref (else these impls would be recursing infinitely, **self is **(&amp;Box<T>), which is *Box<T>). It instead does an operation defined in the compiler. You want Deref to be implemented so that folks can still use box with T: Deref.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620622577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385833,"user_name":"杨学者","can_delete":false,"product_type":"c3","uid":3230767,"ip_address":"上海","ucode":"A8B3EF621D387D","user_header":"https://static001.geekbang.org/account/avatar/00/31/4c/2f/af2c8d1b.jpg","comment_is_top":false,"comment_ctime":1703484690,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100060601,"comment_content":"来点实战！！","like_count":0},{"had_liked":false,"id":254061,"user_name":"神 一生有你","can_delete":false,"product_type":"c3","uid":1047574,"ip_address":"","ucode":"423AD11359E265","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/16/0a3f1c15.jpg","comment_is_top":false,"comment_ctime":1603033960,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100060601,"comment_content":"let c=Box::from(5);\n*c  &#47;&#47; 等价于 *(c.deref())\n\n问下，Box::new和from包裹一个变量，new是在堆上分配，但from好像不是？","like_count":0,"discussions":[{"author":{"id":1359831,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/d7/6bb1ee25.jpg","nickname":"刘福洋","note":"","ucode":"9C4A1E19404B38","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319846,"discussion_content":"from 貌似也是在堆上分配, https://doc.rust-lang.org/src/alloc/boxed.rs.html#788-803","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604139662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}