{"id":128758,"title":"38丨如何在Excel中使用SQL语言？","content":"<p>在进阶篇中，我们对设计范式、索引、页结构、事务以及查询优化器的原理进行了学习，了解这些可以让我们更好地使用SQL来操作RDBMS。实际上SQL的影响力远不止于此，在数据的世界里，SQL更像是一门通用的语言，虽然每种工具都会有一些自己的“方言”，但是掌握SQL可以让我们接触其它以数据为核心的工具时，更加游刃有余。</p><p>比如Excel。</p><p>你一定使用过Excel，事实上，Excel的某些部分同样支持我们使用SQL语言，那么具体该如何操作呢？</p><p>今天的课程主要包括以下几方面的内容：</p><ol>\n<li>如何在Excel中获取外部数据源？</li>\n<li>数据透视表和数据透视图是Excel的两个重要功能，如何通过SQL查询在Excel中完成数据透视表和透视图？</li>\n<li>如何让Excel与MySQL进行数据交互？</li>\n</ol><h2>如何在Excel中获取外部数据源？</h2><p>使用SQL查询数据，首先需要数据源。如果我们用Excel来呈现这些数据的话，就需要先从外部导入数据源。这里介绍两种直接导入的方式：</p><ol>\n<li>通过OLE DB接口获取外部数据源；</li>\n<li>通过Microsoft Query导入外部数据源。</li>\n</ol><p>下面我们通过导入数据源heros.xlsx体验一下这两种方式，你可以从<a href=\"https://github.com/cystanford/SQL-Excel\">这里</a>下载数据源。</p><h3>通过OLE DB接口获取外部数据源</h3><!-- [[[read_end]]] --><p>OLE的英文是Object Link and Embedding，中文意思是对象连接与嵌入，它是一种面向对象的技术。DB代表的就是数据库。OLE DB的作用就是通向不同的数据源的程序接口，方便获取外部数据，这里不仅包括ODBC，也包括其他非SQL数据类型的通路，你可以把OLE DB的作用理解成通过统一的接口来访问不同的数据源。</p><p>如果你想要在Excel中通过OLE DB接口导入数据，需要执行下面的步骤：</p><p>第一步，选择指定的文件。方法是通过“数据” → “现有连接”按钮选择连接。这里选择“浏览更多”，然后选择指定的xls文件。</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/81/b53c4acda1cf19a1943cf0123f5a2481.png?wh=865*867\" alt=\"\"><br>\n第二步，选择指定的表格，勾选数据首行包含列标题，目的是将第一行的列名也加载进来。</p><p><img src=\"https://static001.geekbang.org/resource/image/85/f9/8594b603410c1b7872de9d7ef38e7df9.png?wh=848*418\" alt=\"\"><br>\n第三步，通过“属性” → “定义”中的命令文本来使用SQL查询，选择我们想要的数据，也可以将整张表直接导入到指定的位置。</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/f2/1df9b6d9ab9d4a854ab532f1f98ed1f2.png?wh=721*820\" alt=\"\"><br>\n如果我们显示方式为“表”，导入全部的数据到指定的$A$1（代表A1单元格），那么在Excel中就可以导入整个数据表，如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/ab/baeb41a95f49eb1fb76d6afe48122aab.png?wh=1730*601?wh=1730*601\" alt=\"\"></p><h3>通过Microsoft Query获取外部数据源</h3><p>第二种方式是利用Microsoft Query功能导入外部数据源，具体步骤如下：</p><p>第一步，选择指定的文件。方法是通过“数据” → “获取外部数据”按钮选择数据库，这里我选择了“Excel Files”，然后选择我们想要导入的xls文件。</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/84/c7cb9168c77b11c0d7f90a86316c3b84.png?wh=1093*567\" alt=\"\"><br>\n第二步。选择可用的表和列，在左侧面板中勾选我们想要导入的数据表及相应的列，点击 （&gt;） 按钮导入到右侧的面板中，然后点击下一步。</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/40/1ca1f6f8d11e2f0c70c0b81ff8647440.png?wh=1128*648\" alt=\"\"><br>\n最后我们可以选择“将数据返回Microsoft Excel”还是“在Microsoft Query中查看数据或编辑查询”。这里我们选择第一个选项。</p><p><img src=\"https://static001.geekbang.org/resource/image/75/46/753b382fa6246c4dd1d7634d703dc646.png?wh=1116*640\" alt=\"\"><br>\n当我们选择“将数据返回到Microsoft Excel”后，接下来的操作和使用OLE DB接口方式导入数据一样，可以对显示方式以及属性进行调整：</p><p><img src=\"https://static001.geekbang.org/resource/image/24/65/24c70f964bb4dbdaf388af45bc57d865.png?wh=831*1000\" alt=\"\"><br>\n这里，我们同样选择显示方式为“表”，导入全部的数据到指定的$A$1(代表A1单元格），同样会看到如下的结果：</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/ab/baeb41a95f49eb1fb76d6afe48122aab.png?wh=1730*601?wh=1730*601\" alt=\"\"></p><h2>使用数据透视表和数据透视图做分析</h2><p>通过上面的操作你也能看出来，从外部导入数据并不难，关键在于通过SQL控制想要的结果集，这里我们需要使用到Excel的数据透视表以及数据透视图的功能。</p><p>我简单介绍下数据透视表和数据透视图：</p><p>数据透视表可以快速汇总大量数据，帮助我们统计和分析数据，比如求和，计数，查看数据中的对比情况和趋势等。数据透视图则可以对数据透视表中的汇总数据进行可视化，方便我们直观地查看数据的对比与趋势等。</p><p>假设我想对主要角色（role_main）的英雄数据进行统计，分析他们平均的最大生命值（hp_max），平均的最大法力值(mp_max)，平均的最大攻击值(attack_max)，那么对应的SQL查询为：</p><pre><code>SELECT role_main, avg(hp_max) AS `平均最大生命`, avg(mp_max) AS `平均最大法力`, avg(attack_max) AS `平均最大攻击力`, count(*) AS num FROM heros GROUP BY role_main\n</code></pre><h3>使用SQL+数据透视表</h3><p>现在我们使用SQL查询，通过OLE DB的方式来完成数据透视表。我们在第三步的时候选择“属性”，并且在命令文本中输入相应的SQL语句，注意这里的数据表是[heros$]，对应的命令文本为：</p><pre><code>SELECT role_main, avg(hp_max) AS `平均最大生命`, avg(mp_max) AS `平均最大法力`, avg(attack_max) AS `平均最大攻击力`, count(*) AS num FROM [heros$] GROUP BY role_main\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/5f/0d/5ff31b9bc54a6d0c02e23775273ada0d.png?wh=842*1161\" alt=\"\"><br>\n然后我们在右侧面板中选择“数据透视表字段”，以便对数据透视表中的字段进行管理，比如我们勾选num，role_main，平均最大生命，平均最大法力，平均最大攻击力。</p><p><img src=\"https://static001.geekbang.org/resource/image/cf/9d/cf3e3da9ddedb2d886806ac4b490059d.png?wh=592*479\" alt=\"\"><br>\n最后会在Excel中呈现如下的数据透视表：</p><p><img src=\"https://static001.geekbang.org/resource/image/c4/08/c41bd917642147b103ec3524d7a9f408.png?wh=1729*350\" alt=\"\"><br>\n操作视频如下：</p><p><video poster=\"https://media001.geekbang.org/b29dda8f93f5475fa36cee2908a48e89/snapshots/d41bc8d4cddf43b1aad2baa48293dcc7-00002.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/fe4a99b62946f2c31c2095c167b26f9c/4a4da64f-16d00e8d8a6-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\"https://media001.geekbang.org/b29dda8f93f5475fa36cee2908a48e89/06365f50429e4e849bea2767ce97fbf9-28c4680fd9b67ce1559bbe18701345b0-sd.m3u8\" type=\"application/x-mpegURL\"><source src=\"https://media001.geekbang.org/b29dda8f93f5475fa36cee2908a48e89/06365f50429e4e849bea2767ce97fbf9-7300b80dc359dc62ac7bd12b7c613c4b-hd.m3u8\" type=\"application/x-mpegURL\"></video></p><h3>使用SQL+数据透视图</h3><p>数据透视图可以呈现可视化的形式，方便我们直观地了解数据的特征。这里我们使用SQL查询，通过Microsoft Query的方式来完成数据透视图。我们在第三步的时候选择在Microsoft Query中查看数据或编辑查询，来看下Microsoft Query的界面：</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/20/c7d10db98c4e2226b663bbb7baefba20.png?wh=1729*1106\" alt=\"\"><br>\n然后我们点击“SQL”按钮，可以对SQL语句进行编辑，筛选我们想要的结果集，可以得到：</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/7d/2b9b5f3495013b62b7ba6e3186cf257d.png?wh=1730*850\" alt=\"\"><br>\n然后选择“将数据返回Microsoft Excel”，在返回时选择“数据透视图”，然后在右侧选择数据透视图的字段，就可以得到下面这张图：</p><p><img src=\"https://static001.geekbang.org/resource/image/46/02/46829993666745ecc578b22ffcde4802.png?wh=1045*630\" alt=\"\"><br>\n你可以看到使用起来还是很方便。</p><p>具体操作视频如下：</p><p><video poster=\"https://media001.geekbang.org/7a5908e0dc954d1db27a4ce93d27009a/snapshots/d7e7ce04bdd640f193763b0a40edaf4a-00005.jpg\" preload=\"none\" controls=\"\"><source src=\"https://media001.geekbang.org/customerTrans/7e27d07d27d407ebcc195a0e78395f55/1c3c617e-17a0d7a8402-0000-0000-01d-dbacd.mp4\" type=\"video/mp4\"><source src=\" https://media001.geekbang.org/5c2a0c334cfe4ccaa00a30fe9ff727fe/1b384861673042a1afd7f3255195801d-86271c24b80a51491faf2fa806a91d82-sd.m3u8\" type=\"application/x-mpegURL\"></video></p><h2>让Excel与MySQL进行数据交互</h2><p>刚才我们讲解的是如何从Excel中导入外部的xls文件数据，并在Excel实现数据透视表和数据透视图的呈现。实际上，Excel也可以与MySQL进行数据交互，这里我们需要使用到MySQL for Excel插件：</p><p>下载mysql-for-excel并安装，地址：<a href=\"https://dev.mysql.com/downloads/windows/excel/\">https://dev.mysql.com/downloads/windows/excel/</a></p><p>下载mysql-connector-odbc并安装，地址：<a href=\"https://dev.mysql.com/downloads/connector/odbc/\">https://dev.mysql.com/downloads/connector/odbc/</a></p><p>这次我们的任务是给数据表增加一个last_name字段，并且使用Excel的自动填充功能来填充好英雄的姓氏。</p><p>第一步，连接MySQL。打开一个新的Excel文件的时候，会在“数据”面板中看到MySQL for Excel的插件，点击后可以打开MySQL的连接界面，如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/ec/3c/ec96481d8517bc7b08728630d3b1aa3c.png?wh=1092*631\" alt=\"\"><br>\n第二步，导入heros数据表。输入密码后，我们在右侧选择想要的数据表heros，然后选择Import MySQL Data导入数据表的导入，结果如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/33/15/333b8dc9913bcdf19d74e685f6751015.png?wh=1587*555\" alt=\"\"><br>\n第三步，创建last_name字段，使用Excel的自动填充功能来进行姓氏的填写（Excel自带的“自动填充”可以帮我们智能填充一些数据），完成之后如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/80/b7/801e1ec489d650a7df244b3737346cb7.png?wh=1729*639\" alt=\"\"><br>\n第四步，将修改好的Excel表导入到MySQL中，创建一个新表heros_xls。选中整个数据表（包括数据行及列名），然后在右侧选择“Export Excel Data to New Table”。这时在MySQL中你就能看到相应的数据表heros_xls了，我们在MySQL中使用SQL进行查询：</p><pre><code>mysql &gt; SELECT * FROM heros_xls\n</code></pre><p>运行结果（69条记录）：</p><p><img src=\"https://static001.geekbang.org/resource/image/86/56/868182e27c6a4a80db0f0f7decbc7956.png?wh=1201*352\" alt=\"\"><br>\n需要说明的是，有时候自动填充功能并不完全准确，我们还需要对某些数据行的last_name进行修改，比如“夏侯惇”的姓氏应该改成“夏侯”，“百里守约”改成“百里”等。</p><h2>总结</h2><p>我们今天讲解了如何在Excel中使用SQL进行查询，在这个过程中你应该对”SQL定义了查询的标准“更有体会。SQL使得各种工具可以遵守SQL语言的标准（当然也有各自的方言）。</p><p>如果你已经是个SQL高手，你会发现原来SQL和Excel还可以如此“亲密”。Excel作为使用人数非常多的办公软件，提供了SQL查询会让我们操作起来非常方便。如果你还没有使用过Excel的这些功能，那么就赶快来用一下吧。</p><p><img src=\"\" alt=\"\"></p><p>SQL作为一门结构化查询语言，具有很好的通用性，你还在其他工具中使用过SQL语言吗？如果有的话可以分享一下你的体会。</p><p>最后留一道动手题吧。你可以创建一个新的xls文件，导入heros.xlsx数据表，用数据透视图的方式对英雄主要定位为刺客、法师、射手的英雄数值进行可视化，数据查询方式请使用SQL查询，统计的英雄数值为平均生命成长hp_growth，平均法力成长mp_growth，平均攻击力成长attack_growth。</p><p>欢迎你在评论区写下你的体会与思考，也欢迎把这篇文章分享给你的朋友或者同事，一起来交流。</p>","neighbors":{"left":{"article_title":"37丨SQL注入：你的SQL是如何被注入的？","id":137050},"right":{"article_title":"39丨WebSQL：如何在H5中存储一个本地数据库？","id":129827}},"comments":[{"had_liked":false,"id":129777,"user_name":"莫弹弹","can_delete":false,"product_type":"c1","uid":1239978,"ip_address":"","ucode":"60A25C709A665F","user_header":"https://static001.geekbang.org/account/avatar/00/12/eb/aa/db213a66.jpg","comment_is_top":false,"comment_ctime":1567246908,"is_pvip":false,"replies":[{"id":"53406","content":"感谢分享","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1570434212,"ip_address":"","comment_id":129777,"utype":1}],"discussion_count":2,"race_medal":0,"score":"57401821756","product_id":100029501,"comment_content":"老师我发现安装 mysql-for-excel-1.3.8.msi 时会报错<br>The Microsoft Visual Studio Tools for Office Runtime must be nstalled prior to running this istlation.<br>找了一下微软的说明<br>ttps:&#47;&#47;docs.microsoft.com&#47;en-us&#47;visualstudio&#47;vsto&#47;how-to-install-the-visual-studio-tools-for-office-runtime-redistributable?view=vs-2019<br>需要下载 Visual Studio 2010 Tools for Office Runtime 才能运行<br>下载链接在这里<br>https:&#47;&#47;www.microsoft.com&#47;zh-CN&#47;download&#47;confirmation.aspx?id=56961","like_count":14,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465643,"discussion_content":"感谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570434212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1394726,"avatar":"https://static001.geekbang.org/account/avatar/00/15/48/26/93fd21d5.jpg","nickname":"书痕","note":"","ucode":"8367371EF89D61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45853,"discussion_content":"非常感谢，正打算去找呢，发现有提供好的，哈哈","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573091143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131284,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1567691890,"is_pvip":false,"replies":[{"id":"62789","content":"take it easy","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577092635,"ip_address":"","comment_id":131284,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35927430258","product_id":100029501,"comment_content":"Mac 用户说我太难了😭","like_count":8,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466371,"discussion_content":"take it easy","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577092635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1915698,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/3b/32/3d0cc333.jpg","nickname":"北野豪横","note":"","ucode":"275229F4B048D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290791,"discussion_content":"我真的太难了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594606395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129676,"user_name":"莫弹弹","can_delete":false,"product_type":"c1","uid":1239978,"ip_address":"","ucode":"60A25C709A665F","user_header":"https://static001.geekbang.org/account/avatar/00/12/eb/aa/db213a66.jpg","comment_is_top":false,"comment_ctime":1567215721,"is_pvip":false,"replies":[{"id":"50441","content":"是的，非常简单方便","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1568006116,"ip_address":"","comment_id":129676,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31631986793","product_id":100029501,"comment_content":"这个功能也是比较好的报表工具了，产品经理经常让我提取一些数据出来，例如指定时间段的数据，指定用户的业务记录数量，如果有Excel插件和MySQL配合的话，可以实现我从MySQL导出Excel报表的功能，非常方便","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465596,"discussion_content":"是的，非常简单方便","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568006116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131311,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1567699635,"is_pvip":false,"replies":[{"id":"50437","content":"有些类似，提供了图形化界面","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1568005466,"ip_address":"","comment_id":131311,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23042536115","product_id":100029501,"comment_content":"这个功能犹如AWT","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466383,"discussion_content":"有些类似，提供了图形化界面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568005466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129519,"user_name":"Geek_aab935","can_delete":false,"product_type":"c1","uid":1581959,"ip_address":"","ucode":"E3E6FFDD814716","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/D4KnXmgkeITtk6ibZvIKDML36SeicWTnWbqRlKHx32rhicIIsYR8Qru1QDWH4E0SeV8p8xjxayJRCyQzNnlibSWiaGQ/132","comment_is_top":false,"comment_ctime":1567147376,"is_pvip":false,"replies":[{"id":"62737","content":"创建好table之后，可以写个存储过程，插入数据，都插入好之后 再commit","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1577087676,"ip_address":"","comment_id":129519,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14452049264","product_id":100029501,"comment_content":"老师好，请教一个问题，我要建一张80万条的数据表，数据来自3张表的汇总，我用create table 表名 as 方式建表太慢，有什么好的方式快速建表？","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465518,"discussion_content":"创建好table之后，可以写个存储过程，插入数据，都插入好之后 再commit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577087676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129480,"user_name":"许童童","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1567136144,"is_pvip":false,"replies":[{"id":"50442","content":"是的 简单实用","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1568006150,"ip_address":"","comment_id":129480,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14452038032","product_id":100029501,"comment_content":"日常编程的话确实用不到，不过工作中，如果想临时生成一下可视化的图表，用这种方式那确实是很方便的，感谢老师分享。","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465496,"discussion_content":"是的 简单实用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568006150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129864,"user_name":"往事随风，顺其自然","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1567307429,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10157242021","product_id":100029501,"comment_content":"为什么我在用Microsoft query导入表中数据报错，数据源中没有包含可见的表格，这个怎么解决？","like_count":2,"discussions":[{"author":{"id":1578457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/mVtGLzdgB7pKFgaQdYUoAaNDic1xCqLqATcuVYPGCBuCy4tTwEBhicaZ70tvSbMaGAEEia7cJwcjfmdfTffFlAsSw/132","nickname":"Andywu","note":"","ucode":"29D95287086BA1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7326,"discussion_content":"【解决方法】出现“数据源中没有包含可见的表格”这个提示后按确定，然后点选项，勾选“系统表”后就可以了。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1567493414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1580662,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1e/76/7ccbbe83.jpg","nickname":"算盘Man","note":"","ucode":"F26211FEEC18B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1578457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/mVtGLzdgB7pKFgaQdYUoAaNDic1xCqLqATcuVYPGCBuCy4tTwEBhicaZ70tvSbMaGAEEia7cJwcjfmdfTffFlAsSw/132","nickname":"Andywu","note":"","ucode":"29D95287086BA1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24643,"discussion_content":"谢谢，成功了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570208507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":7326,"ip_address":""},"score":24643,"extra":""}]}]},{"had_liked":false,"id":129423,"user_name":"jonnypppp","can_delete":false,"product_type":"c1","uid":1217842,"ip_address":"","ucode":"C5914232420950","user_header":"https://static001.geekbang.org/account/avatar/00/12/95/32/8c6dc643.jpg","comment_is_top":false,"comment_ctime":1567128018,"is_pvip":false,"replies":[{"id":"50443","content":"谢谢","user_name":"作者回复","user_name_real":"cy","uid":"1306094","ctime":1568006168,"ip_address":"","comment_id":129423,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10157062610","product_id":100029501,"comment_content":"平时基本不用，不过涨知识了","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465460,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568006168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195325,"user_name":"博弈","can_delete":false,"product_type":"c1","uid":1433344,"ip_address":"","ucode":"B1A69837E41972","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/EcYNib1bnDf5dz6JcrE8AoyZYMdqic2VNmbBtCcVZTO9EoDZZxqlQDEqQKo6klCCmklOtN9m0dTd2AOXqSneJYLw/132","comment_is_top":false,"comment_ctime":1585180193,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880147489","product_id":100029501,"comment_content":"这个功能比较好，可以直接使用Excel操作SQL","like_count":2},{"had_liked":false,"id":178784,"user_name":"😳","can_delete":false,"product_type":"c1","uid":1452857,"ip_address":"","ucode":"9AFB87EF308539","user_header":"https://static001.geekbang.org/account/avatar/00/16/2b/39/19041d78.jpg","comment_is_top":false,"comment_ctime":1581823366,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5876790662","product_id":100029501,"comment_content":"日常工作没使用过，不过现在知道还能这样玩了","like_count":2},{"had_liked":false,"id":309120,"user_name":"宇","can_delete":false,"product_type":"c1","uid":1522345,"ip_address":"","ucode":"FA825866C46C0C","user_header":"https://static001.geekbang.org/account/avatar/00/17/3a/a9/9cba7c32.jpg","comment_is_top":false,"comment_ctime":1629949176,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629949176","product_id":100029501,"comment_content":"使用 Excel 的自动填充功能来进行姓氏的填写，是具体怎么做的","like_count":0}]}