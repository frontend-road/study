{"id":94974,"title":"13 | å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼šSparkå¤§å¦çš„åœ°åŸºï¼ˆä¸Šï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä»Šå¤©æˆ‘è¦ä¸ä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯â€œå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†â€ã€‚</p><p>ä¸Šä¸€è®²ä¸­æåˆ°ï¼ŒSparkæœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡æ˜¯å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆResilient Distributed Dataset, ä¸‹æ–‡ç”¨RDDä»£æŒ‡ï¼‰ã€‚</p><p>SparkåŸºäºRDDå®šä¹‰äº†å¾ˆå¤šæ•°æ®æ“ä½œï¼Œä»è€Œä½¿å¾—æ•°æ®å¤„ç†çš„ä»£ç ååˆ†ç®€æ´ã€é«˜æ•ˆã€‚æ‰€ä»¥ï¼Œè¦æƒ³æ·±å…¥å­¦ä¹ Sparkï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆç†è§£RDDçš„è®¾è®¡æ€æƒ³å’Œç‰¹æ€§ã€‚</p><h2>ä¸ºä»€ä¹ˆéœ€è¦æ–°çš„æ•°æ®æŠ½è±¡æ¨¡å‹ï¼Ÿ</h2><p>ä¼ ç»Ÿçš„MapReduceæ¡†æ¶ä¹‹æ‰€ä»¥è¿è¡Œé€Ÿåº¦ç¼“æ…¢ï¼Œå¾ˆé‡è¦çš„åŸå› å°±æ˜¯æœ‰å‘æ— ç¯å›¾çš„ä¸­é—´è®¡ç®—ç»“æœéœ€è¦å†™å…¥ç¡¬ç›˜è¿™æ ·çš„ç¨³å®šå­˜å‚¨ä»‹è´¨ä¸­æ¥é˜²æ­¢è¿è¡Œç»“æœä¸¢å¤±ã€‚</p><p>è€Œæ¯æ¬¡è°ƒç”¨ä¸­é—´è®¡ç®—ç»“æœéƒ½éœ€è¦è¦è¿›è¡Œä¸€æ¬¡ç¡¬ç›˜çš„è¯»å–ï¼Œåå¤å¯¹ç¡¬ç›˜è¿›è¡Œè¯»å†™æ“ä½œä»¥åŠæ½œåœ¨çš„æ•°æ®å¤åˆ¶å’Œåºåˆ—åŒ–æ“ä½œå¤§å¤§æé«˜äº†è®¡ç®—çš„å»¶è¿Ÿã€‚</p><p>å› æ­¤ï¼Œå¾ˆå¤šç ”ç©¶äººå‘˜è¯•å›¾æå‡ºä¸€ä¸ªæ–°çš„åˆ†å¸ƒå¼å­˜å‚¨æ–¹æ¡ˆï¼Œä¸ä»…ä¿æŒä¹‹å‰ç³»ç»Ÿçš„ç¨³å®šæ€§ã€é”™è¯¯æ¢å¤å’Œå¯æ‰©å±•æ€§ï¼Œè¿˜è¦å°½å¯èƒ½åœ°å‡å°‘ç¡¬ç›˜I/Oæ“ä½œã€‚</p><p>ä¸€ä¸ªå¯è¡Œçš„è®¾æƒ³å°±æ˜¯åœ¨åˆ†å¸ƒå¼å†…å­˜ä¸­ï¼Œå­˜å‚¨ä¸­é—´è®¡ç®—çš„ç»“æœï¼Œå› ä¸ºå¯¹å†…å­˜çš„è¯»å†™æ“ä½œé€Ÿåº¦è¿œå¿«äºç¡¬ç›˜ã€‚è€ŒRDDå°±æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼å†…å­˜çš„æ•°æ®æŠ½è±¡ï¼Œå®ƒä¸ä»…æ”¯æŒåŸºäºå·¥ä½œé›†çš„åº”ç”¨ï¼ŒåŒæ—¶å…·æœ‰æ•°æ®æµæ¨¡å‹çš„ç‰¹ç‚¹ã€‚</p><h2>RDDçš„å®šä¹‰</h2><p>å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†æ˜¯è‹±æ–‡ç›´è¯‘çš„åå­—ï¼Œä¹ä¸€çœ‹è¿™ä¸ªåå­—ç›¸ä¿¡ä½ ä¼šä¸çŸ¥æ‰€äº‘ã€‚å¦‚æœä½ å»Googleæˆ–è€…ç™¾åº¦æœç´¢å®ƒçš„å®šä¹‰ï¼Œä½ ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><!-- [[[read_end]]] --><p><strong>RDDè¡¨ç¤ºå·²è¢«åˆ†åŒºã€ä¸å¯å˜çš„ï¼Œå¹¶èƒ½å¤Ÿè¢«å¹¶è¡Œæ“ä½œçš„æ•°æ®é›†åˆã€‚</strong></p><p>è¿™ä¸ªå®šä¹‰å¾ˆä¸ç›´è§‚ï¼Œæˆ‘è®¤è¯†çš„å¾ˆå¤šSparkåˆå­¦è€…åœ¨æŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™åè¿˜æ˜¯å¯¹RDDä¸€å¤´é›¾æ°´ï¼Œå¾ˆéš¾ç†è§£è¿™ä¸ªæŠ½è±¡çš„æ¦‚å¿µã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥å¯¹è¿™ä¸ªæ™¦æ¶©çš„æ¦‚å¿µæŠ½ä¸å‰¥èŒ§ï¼Œè§å…¶çœŸä¹‰ã€‚</p><p>åœ¨ä¸Šè¿°å®šä¹‰ä»¥åŠRDDçš„ä¸­æ–‡è¯‘åä¸­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼ŒRDDæœ‰ä»¥ä¸‹åŸºæœ¬ç‰¹æ€§ï¼šåˆ†åŒºã€ä¸å¯å˜å’Œå¹¶è¡Œæ“ä½œã€‚æ¥ä¸‹æ¥è®©æˆ‘åˆ†åˆ«è®²è§£è¿™äº›ç‰¹ç‚¹ã€‚</p><h3>åˆ†åŒº</h3><p>é¡¾åæ€ä¹‰ï¼Œåˆ†åŒºä»£è¡¨åŒä¸€ä¸ªRDDåŒ…å«çš„æ•°æ®è¢«å­˜å‚¨åœ¨ç³»ç»Ÿçš„ä¸åŒèŠ‚ç‚¹ä¸­ï¼Œè¿™ä¹Ÿæ˜¯å®ƒå¯ä»¥è¢«å¹¶è¡Œå¤„ç†çš„å‰æã€‚</p><p>é€»è¾‘ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºRDDæ˜¯ä¸€ä¸ªå¤§çš„æ•°ç»„ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ã€‚</p><p>åœ¨ç‰©ç†å­˜å‚¨ä¸­ï¼Œæ¯ä¸ªåˆ†åŒºæŒ‡å‘ä¸€ä¸ªå­˜æ”¾åœ¨å†…å­˜æˆ–è€…ç¡¬ç›˜ä¸­çš„æ•°æ®å—ï¼ˆBlockï¼‰ï¼Œè€Œè¿™äº›æ•°æ®å—æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒä»¬å¯ä»¥è¢«å­˜æ”¾åœ¨ç³»ç»Ÿä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚</p><p>æ‰€ä»¥ï¼ŒRDDåªæ˜¯æŠ½è±¡æ„ä¹‰çš„æ•°æ®é›†åˆï¼Œåˆ†åŒºå†…éƒ¨å¹¶ä¸ä¼šå­˜å‚¨å…·ä½“çš„æ•°æ®ã€‚ä¸‹å›¾å¾ˆå¥½åœ°å±•ç¤ºäº†RDDçš„åˆ†åŒºé€»è¾‘ç»“æ„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2f/9e/2f9ec57cdedf65be382a8ec09826029e.jpg\" alt=\"\"></p><p>RDDä¸­çš„æ¯ä¸ªåˆ†åŒºå­˜æœ‰å®ƒåœ¨è¯¥RDDä¸­çš„indexã€‚é€šè¿‡RDDçš„IDå’Œåˆ†åŒºçš„indexå¯ä»¥å”¯ä¸€ç¡®å®šå¯¹åº”æ•°æ®å—çš„ç¼–å·ï¼Œä»è€Œé€šè¿‡åº•å±‚å­˜å‚¨å±‚çš„æ¥å£ä¸­æå–åˆ°æ•°æ®è¿›è¡Œå¤„ç†ã€‚</p><p>åœ¨é›†ç¾¤ä¸­ï¼Œå„ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®å—ä¼šå°½å¯èƒ½åœ°å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œåªæœ‰å½“å†…å­˜æ²¡æœ‰ç©ºé—´æ—¶æ‰ä¼šå­˜å…¥ç¡¬ç›˜ã€‚è¿™æ ·å¯ä»¥æœ€å¤§åŒ–åœ°å‡å°‘ç¡¬ç›˜è¯»å†™çš„å¼€é”€ã€‚</p><p>è™½ç„¶ RDD å†…éƒ¨å­˜å‚¨çš„æ•°æ®æ˜¯åªè¯»çš„ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å»ä¿®æ”¹ï¼ˆä¾‹å¦‚é€šè¿‡ repartition è½¬æ¢æ“ä½œï¼‰å¹¶è¡Œè®¡ç®—å•å…ƒçš„åˆ’åˆ†ç»“æ„ï¼Œä¹Ÿå°±æ˜¯åˆ†åŒºçš„æ•°é‡ã€‚</p><h3>ä¸å¯å˜æ€§</h3><p>ä¸å¯å˜æ€§ä»£è¡¨æ¯ä¸€ä¸ªRDDéƒ½æ˜¯åªè¯»çš„ï¼Œå®ƒæ‰€åŒ…å«çš„åˆ†åŒºä¿¡æ¯ä¸å¯ä»¥è¢«æ”¹å˜ã€‚æ—¢ç„¶å·²æœ‰çš„RDDä¸å¯ä»¥è¢«æ”¹å˜ï¼Œæˆ‘ä»¬åªå¯ä»¥å¯¹ç°æœ‰çš„RDDè¿›è¡Œ<strong>è½¬æ¢</strong>ï¼ˆTransformationï¼‰æ“ä½œï¼Œå¾—åˆ°æ–°çš„RDDä½œä¸ºä¸­é—´è®¡ç®—çš„ç»“æœã€‚ä»æŸç§ç¨‹åº¦ä¸Šè®²ï¼ŒRDDä¸å‡½æ•°å¼ç¼–ç¨‹çš„Collectionå¾ˆç›¸ä¼¼ã€‚</p><pre><code>lines = sc.textFile(&quot;data.txt&quot;)\nlineLengths = lines.map(lambda s: len(s))\ntotalLength = lineLengths.reduce(lambda a, b: a + b)\n</code></pre><p>åœ¨ä¸Šè¿°çš„ç®€å•ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å…¥æ–‡æœ¬æ–‡ä»¶data.txtï¼Œåˆ›å»ºäº†ç¬¬ä¸€ä¸ªRDD linesï¼Œå®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€è¡Œæ–‡æœ¬ã€‚ç„¶åè°ƒç”¨mapå‡½æ•°å»æ˜ å°„äº§ç”Ÿç¬¬äºŒä¸ªRDD lineLengthsï¼Œæ¯ä¸ªå…ƒç´ ä»£è¡¨æ¯ä¸€è¡Œç®€å•æ–‡æœ¬çš„å­—æ•°ã€‚æœ€åè°ƒç”¨reduceå‡½æ•°å»å¾—åˆ°ç¬¬ä¸‰ä¸ªRDD totalLengthï¼Œå®ƒåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œä»£è¡¨æ•´ä¸ªæ–‡æœ¬çš„æ€»å­—æ•°ã€‚</p><p>é‚£ä¹ˆè¿™æ ·ä¼šå¸¦æ¥ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œå¯¹äºä»£è¡¨ä¸­é—´ç»“æœçš„RDDï¼Œæˆ‘ä»¬éœ€è¦è®°å½•å®ƒæ˜¯é€šè¿‡å“ªä¸ªRDDè¿›è¡Œå“ªäº›è½¬æ¢æ“ä½œå¾—æ¥ï¼Œå³<strong>ä¾èµ–å…³ç³»</strong>ï¼Œè€Œä¸ç”¨ç«‹åˆ»å»å…·ä½“å­˜å‚¨è®¡ç®—å‡ºçš„æ•°æ®æœ¬èº«ã€‚</p><p>è¿™æ ·åšæœ‰åŠ©äºæå‡Sparkçš„è®¡ç®—æ•ˆç‡ï¼Œå¹¶ä¸”ä½¿é”™è¯¯æ¢å¤æ›´åŠ å®¹æ˜“ã€‚</p><p>è¯•æƒ³ï¼Œåœ¨ä¸€ä¸ªæœ‰Næ­¥çš„è®¡ç®—æ¨¡å‹ä¸­ï¼Œå¦‚æœè®°è½½ç¬¬Næ­¥è¾“å‡ºRDDçš„èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œæ•°æ®ä¸¢å¤±ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç¬¬N-1æ­¥çš„RDDå‡ºå‘ï¼Œå†æ¬¡è®¡ç®—ï¼Œè€Œæ— éœ€é‡å¤æ•´ä¸ªNæ­¥è®¡ç®—è¿‡ç¨‹ã€‚è¿™æ ·çš„å®¹é”™ç‰¹æ€§ä¹Ÿæ˜¯RDDä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªâ€œå¼¹æ€§â€çš„æ•°æ®é›†çš„åŸå› ä¹‹ä¸€ã€‚åè¾¹æˆ‘ä»¬ä¼šæåˆ°RDDå¦‚ä½•å­˜å‚¨è¿™æ ·çš„ä¾èµ–å…³ç³»ã€‚</p><h3>å¹¶è¡Œæ“ä½œ</h3><p>ç”±äºå•ä¸ªRDDçš„åˆ†åŒºç‰¹æ€§ï¼Œä½¿å¾—å®ƒå¤©ç„¶æ”¯æŒå¹¶è¡Œæ“ä½œï¼Œå³ä¸åŒèŠ‚ç‚¹ä¸Šçš„æ•°æ®å¯ä»¥è¢«åˆ†åˆ«å¤„ç†ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªæ–°çš„RDDã€‚</p><h2>RDDçš„ç»“æ„</h2><p>é€šè¿‡ä¸Šè¿°è®²è§£ï¼Œæˆ‘ä»¬äº†è§£äº†RDDçš„åŸºæœ¬ç‰¹æ€§â€”â€”åˆ†åŒºã€ä¸å¯å˜å’Œå¹¶è¡Œè®¡ç®—ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬è¿˜æåˆ°æ¯ä¸€ä¸ªRDDé‡Œéƒ½ä¼šåŒ…æ‹¬åˆ†åŒºä¿¡æ¯ã€æ‰€ä¾èµ–çš„çˆ¶RDDä»¥åŠé€šè¿‡æ€æ ·çš„è½¬æ¢æ“ä½œæ‰èƒ½ç”±çˆ¶RDDå¾—æ¥ç­‰ä¿¡æ¯ã€‚</p><p>å®é™…ä¸ŠRDDçš„ç»“æ„è¿œæ¯”ä½ æƒ³è±¡çš„è¦å¤æ‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªRDDçš„ç®€æ˜“ç»“æ„ç¤ºæ„å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/1c/8cae25f4d16a34be77fd3e84133d6a1c.png\" alt=\"\"></p><p>SparkContextæ˜¯æ‰€æœ‰SparkåŠŸèƒ½çš„å…¥å£ï¼Œå®ƒä»£è¡¨äº†ä¸SparkèŠ‚ç‚¹çš„è¿æ¥ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºRDDå¯¹è±¡ä»¥åŠåœ¨èŠ‚ç‚¹ä¸­çš„å¹¿æ’­å˜é‡ç­‰ã€‚ä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªSparkContextã€‚SparkConfåˆ™æ˜¯ä¸€äº›å‚æ•°é…ç½®ä¿¡æ¯ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»é˜…è¯»å®˜æ–¹çš„æŠ€æœ¯æ–‡æ¡£ï¼Œä¸€äº›ç›¸å¯¹ä¸é‡è¦çš„æ¦‚å¿µæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p><p>Partitionså‰æ–‡ä¸­æˆ‘å·²ç»æåˆ°è¿‡ï¼Œå®ƒä»£è¡¨RDDä¸­æ•°æ®çš„é€»è¾‘ç»“æ„ï¼Œæ¯ä¸ªPartitionä¼šæ˜ å°„åˆ°æŸä¸ªèŠ‚ç‚¹å†…å­˜æˆ–ç¡¬ç›˜çš„ä¸€ä¸ªæ•°æ®å—ã€‚</p><p>Partitionerå†³å®šäº†RDDçš„åˆ†åŒºæ–¹å¼ï¼Œç›®å‰æœ‰ä¸¤ç§ä¸»æµçš„åˆ†åŒºæ–¹å¼ï¼šHash partitionerå’ŒRange partitionerã€‚Hashï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¯¹æ•°æ®çš„Keyè¿›è¡Œæ•£åˆ—åˆ†åŒºï¼ŒRangeåˆ™æ˜¯æŒ‰ç…§Keyçš„æ’åºè¿›è¡Œå‡åŒ€åˆ†åŒºã€‚æ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„Partitionerã€‚</p><h3>ä¾èµ–å…³ç³»</h3><p>Dependenciesæ˜¯RDDä¸­æœ€é‡è¦çš„ç»„ä»¶ä¹‹ä¸€ã€‚å¦‚å‰æ–‡æ‰€è¯´ï¼ŒSparkä¸éœ€è¦å°†æ¯ä¸ªä¸­é—´è®¡ç®—ç»“æœè¿›è¡Œæ•°æ®å¤åˆ¶ä»¥é˜²æ•°æ®ä¸¢å¤±ï¼Œå› ä¸ºæ¯ä¸€æ­¥äº§ç”Ÿçš„RDDé‡Œéƒ½ä¼šå­˜å‚¨å®ƒçš„ä¾èµ–å…³ç³»ï¼Œå³å®ƒæ˜¯é€šè¿‡å“ªä¸ªRDDç»è¿‡å“ªä¸ªè½¬æ¢æ“ä½œå¾—åˆ°çš„ã€‚</p><p>ç»†å¿ƒçš„è¯»è€…ä¼šé—®è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œçˆ¶RDDçš„åˆ†åŒºå’Œå­RDDçš„åˆ†åŒºä¹‹é—´æ˜¯å¦æ˜¯ä¸€å¯¹ä¸€çš„å¯¹åº”å…³ç³»å‘¢ï¼ŸSparkæ”¯æŒä¸¤ç§ä¾èµ–å…³ç³»ï¼šçª„ä¾èµ–ï¼ˆNarrow Dependencyï¼‰å’Œå®½ä¾èµ–ï¼ˆWide Dependencyï¼‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5e/e1/5eed459f5f1960e2526484dc014ed5e1.jpg\" alt=\"\"></p><p>çª„ä¾èµ–å°±æ˜¯çˆ¶RDDçš„åˆ†åŒºå¯ä»¥ä¸€ä¸€å¯¹åº”åˆ°å­RDDçš„åˆ†åŒºï¼Œå®½ä¾èµ–å°±æ˜¯çˆ¶RDDçš„æ¯ä¸ªåˆ†åŒºå¯ä»¥è¢«å¤šä¸ªå­RDDçš„åˆ†åŒºä½¿ç”¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/98/f9/989682681b344d31c61b02368ca227f9.jpg\" alt=\"\"></p><p>æ˜¾ç„¶ï¼Œçª„ä¾èµ–å…è®¸å­RDDçš„æ¯ä¸ªåˆ†åŒºå¯ä»¥è¢«å¹¶è¡Œå¤„ç†äº§ç”Ÿï¼Œè€Œå®½ä¾èµ–åˆ™å¿…é¡»ç­‰çˆ¶RDDçš„æ‰€æœ‰åˆ†åŒºéƒ½è¢«è®¡ç®—å¥½ä¹‹åæ‰èƒ½å¼€å§‹å¤„ç†ã€‚</p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸€äº›è½¬æ¢æ“ä½œå¦‚mapã€filterä¼šäº§ç”Ÿçª„ä¾èµ–å…³ç³»ï¼Œè€ŒJoinã€groupByåˆ™ä¼šç”Ÿæˆå®½ä¾èµ–å…³ç³»ã€‚</p><p>è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºmapæ˜¯å°†åˆ†åŒºé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ é€šè¿‡è®¡ç®—è½¬åŒ–ä¸ºå¦ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªåˆ†åŒºé‡Œçš„æ•°æ®ä¸ä¼šè·‘åˆ°ä¸¤ä¸ªä¸åŒçš„åˆ†åŒºã€‚è€ŒgroupByåˆ™è¦å°†æ‹¥æœ‰æ‰€æœ‰åˆ†åŒºé‡Œæœ‰ç›¸åŒKeyçš„å…ƒç´ æ”¾åˆ°åŒä¸€ä¸ªç›®æ ‡åˆ†åŒºï¼Œè€Œæ¯ä¸€ä¸ªçˆ¶åˆ†åŒºéƒ½å¯èƒ½åŒ…å«å„ç§Keyçš„å…ƒç´ ï¼Œæ‰€ä»¥å®ƒå¯èƒ½è¢«ä»»æ„ä¸€ä¸ªå­åˆ†åŒºæ‰€ä¾èµ–ã€‚</p><p>Sparkä¹‹æ‰€ä»¥è¦åŒºåˆ†å®½ä¾èµ–å’Œçª„ä¾èµ–æ˜¯å‡ºäºä»¥ä¸‹ä¸¤ç‚¹è€ƒè™‘ï¼š</p><ul>\n<li>\n<p>çª„ä¾èµ–å¯ä»¥æ”¯æŒåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šé“¾å¼æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œä¾‹å¦‚åœ¨æ‰§è¡Œäº† map åï¼Œç´§æ¥ç€æ‰§è¡Œ filterã€‚ç›¸åï¼Œå®½ä¾èµ–éœ€è¦æ‰€æœ‰çš„çˆ¶åˆ†åŒºéƒ½æ˜¯å¯ç”¨çš„ï¼Œå¯èƒ½è¿˜éœ€è¦è°ƒç”¨ç±»ä¼¼ MapReduce ä¹‹ç±»çš„æ“ä½œè¿›è¡Œè·¨èŠ‚ç‚¹ä¼ é€’ã€‚</p>\n</li>\n<li>\n<p>ä»å¤±è´¥æ¢å¤çš„è§’åº¦è€ƒè™‘ï¼Œçª„ä¾èµ–çš„å¤±è´¥æ¢å¤æ›´æœ‰æ•ˆï¼Œå› ä¸ºå®ƒåªéœ€è¦é‡æ–°è®¡ç®—ä¸¢å¤±çš„çˆ¶åˆ†åŒºå³å¯ï¼Œè€Œå®½ä¾èµ–ç‰µæ¶‰åˆ° RDD å„çº§çš„å¤šä¸ªçˆ¶åˆ†åŒºã€‚</p>\n</li>\n</ul><h2>å°ç»“</h2><p>å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ä½œä¸ºSparkçš„åŸºæœ¬æ•°æ®æŠ½è±¡ï¼Œç›¸è¾ƒäºHadoop/MapReduceçš„æ•°æ®æ¨¡å‹è€Œè¨€ï¼Œå„æ–¹é¢éƒ½æœ‰å¾ˆå¤§çš„æå‡ã€‚</p><p>é¦–å…ˆï¼Œå®ƒçš„æ•°æ®å¯ä»¥å°½å¯èƒ½åœ°å­˜åœ¨å†…å­˜ä¸­ï¼Œä»è€Œå¤§å¤§æé«˜çš„æ•°æ®å¤„ç†çš„æ•ˆç‡ï¼›å…¶æ¬¡å®ƒæ˜¯åˆ†åŒºå­˜å‚¨ï¼Œæ‰€ä»¥å¤©ç„¶æ”¯æŒå¹¶è¡Œå¤„ç†ï¼›è€Œä¸”å®ƒè¿˜å­˜å‚¨äº†æ¯ä¸€æ­¥éª¤è®¡ç®—ç»“æœä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»è€Œå¤§å¤§æå‡äº†æ•°æ®å®¹é”™æ€§å’Œé”™è¯¯æ¢å¤çš„æ­£ç¡®ç‡ï¼Œä½¿Sparkæ›´åŠ å¯é ã€‚</p><p>ä¸‹ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šç»§ç»­æ·±å…¥ç ”ç©¶RDDçš„å®¹é”™æœºåˆ¶ã€ä»»åŠ¡æ‰§è¡Œæœºåˆ¶ï¼Œä»¥åŠSparkå®šä¹‰åœ¨RDDä¸Šçš„å„ç§è½¬æ¢ä¸åŠ¨ä½œæ“ä½œã€‚</p><h2>æ€è€ƒé¢˜</h2><p>çª„ä¾èµ–æ˜¯æŒ‡çˆ¶RDDçš„æ¯ä¸€ä¸ªåˆ†åŒºéƒ½å¯ä»¥å”¯ä¸€å¯¹åº”å­RDDä¸­çš„åˆ†åŒºï¼Œé‚£ä¹ˆæ˜¯å¦æ„å‘³ç€å­RDDä¸­çš„ä¸€ä¸ªåˆ†åŒºåªå¯ä»¥å¯¹åº”çˆ¶RDDä¸­çš„ä¸€ä¸ªåˆ†åŒºå‘¢ï¼Ÿå¦‚æœå­RDDçš„ä¸€ä¸ªåˆ†åŒºéœ€è¦ç”±çˆ¶RDDä¸­è‹¥å¹²ä¸ªåˆ†åŒºè®¡ç®—å¾—æ¥ï¼Œæ˜¯å¦è¿˜ç®—çª„ä¾èµ–ï¼Ÿ</p><p>æœ€åï¼Œæ¬¢è¿ä½ æŠŠå¯¹å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†çš„ç–‘é—®å†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":94692,"user_name":"Milittle","can_delete":false,"product_type":"c1","uid":1045455,"ip_address":"","ucode":"80E566639A8ABB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/cf/851dab01.jpg","comment_is_top":false,"comment_ctime":1557882622,"is_pvip":true,"replies":[{"id":"48548","content":"ä½ è¯´çš„å¾ˆå‡†ç¡®ï¼ç‚¹èµ","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567394211,"ip_address":"","comment_id":94692,"utype":1}],"discussion_count":6,"race_medal":0,"score":"276435789566","product_id":100025301,"comment_content":"å¯¹äºæ€è€ƒé¢˜ï¼šéœ€è¦é‡ç‚¹ç†è§£åŸæ–‡ä¸­è¿™å¥è¯ï¼š<br>çª„ä¾èµ–å°±æ˜¯çˆ¶ RDD çš„åˆ†åŒºå¯ä»¥ä¸€ä¸€å¯¹åº”åˆ°å­ RDD çš„åˆ†åŒºï¼Œå®½ä¾èµ–å°±æ˜¯çˆ¶ RDD çš„æ¯ä¸ªåˆ†åŒºå¯ä»¥è¢«å¤šä¸ªå­ RDD çš„åˆ†åŒºä½¿ç”¨ã€‚<br>è¿™å¥è¯è¯´æ˜äº†ï¼Œçª„ä¾èµ–çš„çˆ¶RDDå¿…é¡»æœ‰ä¸€ä¸ªå¯¹åº”çš„å­RDDï¼Œä¹Ÿå°±æ˜¯è¯´çˆ¶RDDçš„ä¸€ä¸ªåˆ†åŒºåªèƒ½è¢«å­RDDä¸€ä¸ªåˆ†åŒºä½¿ç”¨ï¼Œä½†æ˜¯åè¿‡æ¥å­RDDçš„ä¸€ä¸ªåˆ†åŒºå¯ä»¥ä½¿ç”¨çˆ¶RDDçš„å¤šä¸ªåˆ†åŒºã€‚é‚£å°±å›å¤ä»Šå¤©çš„æ€è€ƒé¢˜ï¼Œç¬¬ä¸€ä¸ªç–‘é—®çª„ä¾èµ–å­RDDçš„åˆ†åŒºä¸ä¸€å®šåªå¯¹åº”çˆ¶RDDçš„ä¸€ä¸ªåˆ†åŒºï¼Œåªè¦æ»¡è¶³è¢«å­RDDåˆ†åŒºåˆ©ç”¨çš„çˆ¶RDDåˆ†åŒºä¸è¢«å­RDDçš„å…¶ä»–åˆ†åŒºåˆ©ç”¨å°±ç®—çª„ä¾èµ–ã€‚ç¬¬äºŒä¸ªç–‘é—®å…¶å®ä¸Šé¢å·²ç»åšäº†å›ç­”ï¼Œåªæœ‰å½“å­RDDåˆ†åŒºä¾èµ–çš„çˆ¶RDDåˆ†åŒºä¸è¢«å…¶ä»–å­RDDåˆ†åŒºä¾èµ–ï¼Œè¿™æ ·çš„è®¡ç®—å°±æ˜¯çª„ä¾èµ–ï¼Œå¦åˆ™æ˜¯å®½ä¾èµ–ã€‚<br>æœ€åï¼Œæ€»ç»“ä»¥ä¸‹ï¼Œå°±æ˜¯åªæœ‰çˆ¶RDDçš„åˆ†åŒºè¢«å¤šä¸ªå­RDDçš„åˆ†åŒºåˆ©ç”¨çš„æ—¶å€™æ‰æ˜¯å®½ä¾èµ–ï¼Œå…¶ä»–çš„æƒ…å†µå°±æ˜¯çª„ä¾èµ–ã€‚å¦‚æœæœ‰å“ªé‡Œç†è§£ä¸å¯¹çš„åœ°æ–¹ï¼Œè¯·è€å¸ˆæŒ‡æ­£ï¼Œè°¢è°¢~","like_count":65,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450173,"discussion_content":"ä½ è¯´çš„å¾ˆå‡†ç¡®ï¼ç‚¹èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567394211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1581245,"avatar":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","nickname":"èµ°åˆ€å£ ğŸ’°","note":"","ucode":"C7E2B812A4A02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362193,"discussion_content":"ä¸å¯¹ã€‚ä¸èƒ½ä»åˆ†åŒºå‡ å¯¹å‡ æ¥åŒºåˆ†å®½çª„ã€‚å®½çª„ä¾èµ–æœ¬è´¨è¿˜æ˜¯èƒ½å¦ä»¥pipelineçš„æ–¹å¼æ‰§è¡Œï¼Œè€Œä¸æ˜¯å‡ å¯¹å‡ ã€‚æ¯”å¦‚cartsianç®—å­ï¼Œå®ƒçˆ¶rddä¸€ä¸ªåˆ†åŒºè¢«å­rddå¤šä¸ªåˆ†åŒºä½¿ç”¨ï¼Œå¯å®ƒæ˜¯çª„ä¾èµ–ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616884627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10937,"discussion_content":"è¯¾ä»£è¡¨è¯·åã€‚æ‰€è°“çš„å®½çª„å…¶å®æ˜¯é’ˆå¯¹çˆ¶RDDè®²çš„ï¼Œåªè¦çˆ¶RDDçš„åˆ†åŒºä¸è¢«å¤šä¸ªå­RDDä½¿ç”¨ï¼Œé‚£å°±æ˜¯çª„ä¾èµ–ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568341092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1710643,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/vwv0qiaibQzcTP6yIDJXOJLdh64CnBSaOceFFuWArVHQcwicIsebwYbKJ69OSJrxeXJyawtNIINcjo3V3hgg5BW1A/132","nickname":"MuBo","note":"","ucode":"46402B9B7D7B1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325590,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—è¿™ä¸ªå®½ä¾èµ–çš„å®šä¹‰æ˜¯ç›¸å¯¹äºçˆ¶RDDæ¥è¯´çš„ï¼Œè€Œä¸”å¾ˆæœ‰å¯èƒ½æ˜¯çˆ¶å­RDDçš„ä¸Šä¸‹æ¸¸åˆ†åŒºåº”è¯¥åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¦åˆ™è¿™ä¸ªçª„ä¾èµ–çš„ç‰¹æ€§æ²¡æœ‰ä»·å€¼ã€‚ä¸ªäººæ„Ÿè§‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1605358576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":10937,"ip_address":""},"score":325590,"extra":""},{"author":{"id":1581245,"avatar":"https://static001.geekbang.org/account/avatar/00/18/20/bd/5656b5d7.jpg","nickname":"èµ°åˆ€å£ ğŸ’°","note":"","ucode":"C7E2B812A4A02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1710643,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/vwv0qiaibQzcTP6yIDJXOJLdh64CnBSaOceFFuWArVHQcwicIsebwYbKJ69OSJrxeXJyawtNIINcjo3V3hgg5BW1A/132","nickname":"MuBo","note":"","ucode":"46402B9B7D7B1E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362194,"discussion_content":"é”™ï¼Œå¾ˆæ˜¯å¦ç»è¿‡ç½‘ç»œä¼ è¾“æ— å…³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616884681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":325590,"ip_address":""},"score":362194,"extra":""}]},{"author":{"id":2446192,"avatar":"https://static001.geekbang.org/account/avatar/00/25/53/70/f140cfb2.jpg","nickname":"æé£","note":"","ucode":"9A475482295B81","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366552,"discussion_content":"æˆ‘ä¹Ÿè§‰å¾—ä¸å¯¹ï¼Œå¦‚æœä¸€ä¸ªå­rddçš„åˆ†åŒºä¾èµ–å¤šä¸ªçˆ¶rddçš„åˆ†åŒºä¹Ÿç®—çª„ä¾èµ–ï¼Œé‚£å²‚ä¸æ˜¯è¦ç­‰åˆ°çˆ¶rddçš„æ‰€æœ‰åˆ†åŒºéƒ½å®Œæˆæ‰èƒ½å¹¶è¡Œï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618112161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117584,"user_name":"windcaller","can_delete":false,"product_type":"c1","uid":1514157,"ip_address":"","ucode":"1CA3E849805770","user_header":"https://static001.geekbang.org/account/avatar/00/17/1a/ad/faf1bf19.jpg","comment_is_top":false,"comment_ctime":1564099590,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"130413118470","product_id":100025301,"comment_content":"çª„ï¼šä¸€å­å¤šçˆ¶ï¼Œä¸€å­ä¸€çˆ¶<br>å®½ï¼šä¸€çˆ¶å¤šå­","like_count":31,"discussions":[{"author":{"id":1519344,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/f0/0bbb0df5.jpg","nickname":"ä¹å¤©","note":"","ucode":"1DC138F7BD536E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381343,"discussion_content":"ä¸€å­å¤šçˆ¶çš„çª„ä¾èµ–åœºæ™¯ï¼Œå­RDDåŒæ ·è¦ç­‰çˆ¶RDDéƒ½æ‰§è¡Œå®Œæ‰å¯ä»¥æ‰§è¡Œï¼Œå¯¹å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625018706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1519344,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/f0/0bbb0df5.jpg","nickname":"ä¹å¤©","note":"","ucode":"1DC138F7BD536E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382683,"discussion_content":"è¿™è‚¯å®šå§ï¼Œä¸€å­ä¸€çˆ¶ä¹Ÿè¦ç­‰ä¸€çˆ¶æ‰§è¡Œå®Œæˆå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625670822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":381343,"ip_address":""},"score":382683,"extra":""}]}]},{"had_liked":false,"id":95282,"user_name":"è¿½æ¢¦","can_delete":false,"product_type":"c1","uid":1183831,"ip_address":"","ucode":"54C6E76E8FE033","user_header":"https://static001.geekbang.org/account/avatar/00/12/10/57/1adfd4f7.jpg","comment_is_top":false,"comment_ctime":1558006939,"is_pvip":false,"replies":[{"id":"48547","content":"ä¸å¯¹ï¼ŒSparkçš„ä¸­é—´è®¡ç®—ç»“æœå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šæŒä¹…åŒ–åˆ°ç¡¬ç›˜ï¼Œéƒ½ä¼šå­˜åœ¨å†…å­˜é‡Œä»¥æ–¹ä¾¿ä¸‹ä¸€æ¬¡è°ƒç”¨ï¼Œè¿™ä¹Ÿæ˜¯å®ƒè¿è¡Œé€Ÿåº¦æ¯”MapReduceå¿«çš„ä¸»è¦åŸå› ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567393780,"ip_address":"","comment_id":95282,"utype":1}],"discussion_count":4,"race_medal":0,"score":"14442908827","product_id":100025301,"comment_content":"è€å¸ˆï¼Œä¸‹é¢è¿™å¥è¯å¯¹å—ï¼Ÿ<br>ä¸€ä¸ªstageçš„æ‰€æœ‰taskéƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¼šåœ¨å„ä¸ªèŠ‚ç‚¹æœ¬åœ°çš„ç£ç›˜æ–‡ä»¶ä¸­å†™å…¥è®¡ç®—ä¸­é—´ç»“æœï¼Œç„¶åDriverå°±ä¼šè°ƒåº¦è¿è¡Œä¸‹ä¸€ä¸ªstageã€‚ä¸‹ä¸€ä¸ªstageçš„taskçš„è¾“å…¥æ•°æ®å°±æ˜¯ä¸Šä¸€ä¸ªstageè¾“å‡ºçš„ä¸­é—´ç»“æœã€‚<br><br>è¯´æ˜ï¼šsparkçš„ä¸­é—´è®¡ç®—ç»“æœä¼šç›´æ¥è½åˆ°ç£ç›˜ä¸Šçš„ï¼Ÿï¼Ÿï¼Ÿ<br>","like_count":4,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450401,"discussion_content":"ä¸å¯¹ï¼ŒSparkçš„ä¸­é—´è®¡ç®—ç»“æœå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡å®šæŒä¹…åŒ–åˆ°ç¡¬ç›˜ï¼Œéƒ½ä¼šå­˜åœ¨å†…å­˜é‡Œä»¥æ–¹ä¾¿ä¸‹ä¸€æ¬¡è°ƒç”¨ï¼Œè¿™ä¹Ÿæ˜¯å®ƒè¿è¡Œé€Ÿåº¦æ¯”MapReduceå¿«çš„ä¸»è¦åŸå› ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567393780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382685,"discussion_content":"stageæ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625671067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202120,"discussion_content":"shuffleç›´æ¥RPCä¼ ç»™ä¸‹é¢ä¸€ä¸ªstageçš„executorå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583863838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1475774,"avatar":"https://static001.geekbang.org/account/avatar/00/16/84/be/1531bcb5.jpg","nickname":"yang","note":"","ucode":"301717D20ABCE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8693,"discussion_content":"ä¸­é—´åˆ’åˆ†stageä¸æ˜¯shuffleä¹ˆï¼Ÿshuffleè¿˜ä¸è½ç›˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568036779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94942,"user_name":"ä¸€","can_delete":false,"product_type":"c1","uid":1220750,"ip_address":"","ucode":"28E0605EA1AE88","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/8e/6e4c7509.jpg","comment_is_top":false,"comment_ctime":1557927246,"is_pvip":false,"replies":[{"id":"34662","content":"ä½ å¥½ï¼Œåœ¨ç¬¬21è®²æˆ‘ä¼šå¸¦å¤§å®¶æ¯”è¾ƒSparkå’ŒFlinkã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1558546575,"ip_address":"","comment_id":94942,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14442829134","product_id":100025301,"comment_content":"è€å¸ˆå¥½ï¼èƒ½ä¸èƒ½è¯·è€å¸ˆè®²è®²Sparkå’ŒFlinkçš„å¯¹æ¯”å‘¢ï¼Ÿè¿™äºŒè€…è°åœ¨æœºå™¨å­¦ä¹ ä¹ƒè‡³æ·±åº¦å­¦ä¹ ä¸­æ›´æœ‰ä¼˜åŠ¿å‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450267,"discussion_content":"ä½ å¥½ï¼Œåœ¨ç¬¬21è®²æˆ‘ä¼šå¸¦å¤§å®¶æ¯”è¾ƒSparkå’ŒFlinkã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558546575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95150,"user_name":"åŸæ¸¸é›ªäºº","can_delete":false,"product_type":"c1","uid":1063805,"ip_address":"","ucode":"C432C9577B420C","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/7d/6376926b.jpg","comment_is_top":false,"comment_ctime":1557974998,"is_pvip":false,"replies":[{"id":"48505","content":"ä¸ä¿å­˜è®¡ç®—ç»“æœæŒ‡çš„æ˜¯ä¸å†™å…¥ç¡¬ç›˜ã€‚åƒMapReduceä¸­æ¯ä¸€æ­¥ä¸­é—´è®¡ç®—ç»“æœéƒ½è¦å†™å…¥HDFSã€‚æ–°çš„RDDæ˜¯ä¸Šä¸€æ­¥RDDè®¡ç®—çš„ç»“æœï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç«‹åˆ»è¿›è¡Œè®¡ç®—ï¼Œçœ‹è¿‡ä¸‹ä¸€è®²å°±æ˜ç™½äº†ï¼Œåªæœ‰ç¢°åˆ°actionæ“ä½œæ‰ä¼šå¼€å§‹æ‰§è¡Œï¼Œè€Œä¸”å¦‚æœæ²¡æœ‰è¿›è¡Œç‰¹åˆ«çš„ç¼“å­˜æˆ–è€…æŒä¹…åŒ–æ“ä½œï¼Œç»“æœåªåœ¨å†…å­˜ä¸­ï¼Œæ²¡æœ‰è¢«å†™å…¥ç¡¬ç›˜ï¼Œæ‰€ä»¥è¯´ä¸ä¿å­˜ç»“æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567385382,"ip_address":"","comment_id":95150,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10147909590","product_id":100025301,"comment_content":"æ–°çš„RDDä¸å°±æ˜¯ä¸Šä¸€æ­¥çš„RDDè®¡ç®—å‡ºçš„ç»“æœä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¯´æ˜¯ä¸ä¿å­˜è®¡ç®—ç»“æœï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450347,"discussion_content":"ä¸ä¿å­˜è®¡ç®—ç»“æœæŒ‡çš„æ˜¯ä¸å†™å…¥ç¡¬ç›˜ã€‚åƒMapReduceä¸­æ¯ä¸€æ­¥ä¸­é—´è®¡ç®—ç»“æœéƒ½è¦å†™å…¥HDFSã€‚æ–°çš„RDDæ˜¯ä¸Šä¸€æ­¥RDDè®¡ç®—çš„ç»“æœï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç«‹åˆ»è¿›è¡Œè®¡ç®—ï¼Œçœ‹è¿‡ä¸‹ä¸€è®²å°±æ˜ç™½äº†ï¼Œåªæœ‰ç¢°åˆ°actionæ“ä½œæ‰ä¼šå¼€å§‹æ‰§è¡Œï¼Œè€Œä¸”å¦‚æœæ²¡æœ‰è¿›è¡Œç‰¹åˆ«çš„ç¼“å­˜æˆ–è€…æŒä¹…åŒ–æ“ä½œï¼Œç»“æœåªåœ¨å†…å­˜ä¸­ï¼Œæ²¡æœ‰è¢«å†™å…¥ç¡¬ç›˜ï¼Œæ‰€ä»¥è¯´ä¸ä¿å­˜ç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567385382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2583,"discussion_content":"è¿™å°±æ˜¯ RDD çš„ç‰¹ç‚¹ï¼Œæƒ°æ€§è®¡ç®—ï¼Œè¿™æ ·ä¸€ä¸ªæ˜¯å¿«ï¼Œå› ä¸ºè®¡ç®—éå¸¸è€—æ—¶é—´ï¼Œä½†æˆ‘ä»¬è¦çš„æœ€ç»ˆç»“æœè€Œä¸æ˜¯ä¸­é—´ç»“æœï¼Œå¦å¤–ï¼Œæˆ‘ä»¬åœ¨æœ€åä¸€æ­¥è®¡ç®—ï¼Œå¯ä»¥æ€»è§ˆæ‰€æœ‰çš„ç¯èŠ‚ï¼Œå¯èƒ½å¯ä»¥é€šè¿‡åˆå¹¶ã€çœç•¥éƒ¨åˆ†ç¯èŠ‚ï¼Œæ›´å¥½çš„ä¼˜åŒ–ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1563777898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382686,"discussion_content":"å°±å¿«åœ¨ä¸ç”¨å­˜å‚¨å—ï¼Œé‚£ä¸ºä»€ä¹ˆMapReduceéè¦å­˜å‚¨å‘¢ï¼Œæ„Ÿè§‰ä¸ä¸å­˜å‚¨æ˜¯ä¸ªå¾ˆç®€å•çš„æƒ³æ³•ï¼Œä¸ºä»€ä¹ˆMapReduceåšä¸‹ä¸æ˜¯å¾ˆå®¹æ˜“ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625671190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2583,"ip_address":""},"score":382686,"extra":""}]}]},{"had_liked":false,"id":94761,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1557890174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147824766","product_id":100025301,"comment_content":"æ–‡ä¸­æåˆ°ä¾èµ–å…³ç³»çš„åŒºåˆ†è€ƒè™‘åŸºäºä¸¤ç‚¹ï¼š<br>1ã€æ€§èƒ½è€ƒè™‘ï¼Œçª„ä¾èµ–å¯ä»¥ä½¿å¾—æ¯ä¸ªæ•°æ®èŠ‚ç‚¹å¹¶è¡Œè®¡ç®—ç»“æœï¼Œä¹Ÿå¯ä»¥æ”¯æŒé“¾å¼è®¡ç®—ï¼›å®½ä¾èµ–éœ€è¦çˆ¶åˆ†åŒºçš„ä¸­æ¯ä¸ªåˆ†åŒºä¸­çš„æ•°æ®èŠ‚ç‚¹è®¡ç®—ï¼Œåªèƒ½ä¸²è¡Œè®¡ç®—ã€‚<br>2ã€æ•…éšœæ¢å¤è€ƒè™‘ï¼Œçª„ä¾èµ–å¯ä»¥æ›´å¿«ã€æ›´å‡†çš„æ¢å¤æ•°æ®ï¼Œå®½ä¾èµ–åˆ™ç›¸å¯¹è¾ƒæ…¢ã€‚<br>é‚£ä¹ˆåŸºäºä»¥ä¸Šè€ƒè™‘ï¼Œçˆ¶rddä¸å­rddæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œåˆ™åˆ’åˆ†åˆ°å®½ä¾èµ–ï¼›ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šæˆ–å¤šå¯¹ä¸€çš„å…³ç³»éƒ½å¯ä»¥åˆ’åˆ†åˆ°çª„ä¾èµ–ã€‚<br><br>åˆ†åŒºæ–¹å¼ï¼šhashåˆ†åŒºã€rangåˆ†åŒºï¼Œä»¥åŠè‡ªå®šä¹‰åˆ†åŒº<br>ç–‘é—®ï¼šå› ä¸ºåˆ†åŒºæŒ‡å‘æŸä¸ªèŠ‚ç‚¹ä¸­çš„æ•°æ®å—ï¼Œé‚£ä¹ˆåˆ†åŒºçš„keyæ˜¯åˆ†åŒºåœ¨RDDä¸­çš„indexè¿˜æ˜¯å…¶å¼•ç”¨çš„æ•°æ®å—ä¸­çš„æŸä¸ªæ•°æ®å­—æ®µï¼Ÿæˆ‘è®¤ä¸ºæ˜¯åè€…ã€‚<br>å¦å¤–ï¼Œhashåˆ†åŒºå’Œrangåˆ†åŒºçš„åº”ç”¨åœºæ™¯åˆ†åˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br><br>RDDå…·æœ‰ä¸å¯å˜æ€§ï¼Œåªèƒ½é€šè¿‡è½¬æ¢æ¥åˆ›å»ºæ–°çš„RDDï¼Œä½†æ˜¯ä¸ä»£è¡¨RDDä¸­åˆ†åŒºæŒ‡å‘çš„èŠ‚ç‚¹æ•°æ®å—ä¹Ÿä¸å¯å˜ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®å—ä¸å¯å˜æ€§å‘¢ï¼Ÿæˆ‘è®¤ä¸ºå¯èƒ½æ˜¯ä½¿ç”¨CopyOnWriteæŠ€æœ¯å®ç°çš„ã€‚<br><br>Sparkä¼˜äºMapReduceçš„åœ°æ–¹ä¹‹ä¸€åœ¨äºï¼šMapReduceçš„ä¸­é—´è®¡ç®—ç»“æœå®æ—¶è½ç›˜ï¼Œè€ŒSparkä½¿ç”¨å­˜å‚¨ä¾èµ–å…³ç³»å’Œå»¶è¿Ÿå­˜å‚¨ä¸­é—´æ•°æ®æ¥æé«˜æ€§èƒ½ã€‚","like_count":2},{"had_liked":false,"id":96327,"user_name":"æ¸¡ç ","can_delete":false,"product_type":"c1","uid":1348536,"ip_address":"","ucode":"8FD8B863D1DA0C","user_header":"https://static001.geekbang.org/account/avatar/00/14/93/b8/6510592e.jpg","comment_is_top":false,"comment_ctime":1558399665,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5853366961","product_id":100025301,"comment_content":"æ€è€ƒé¢˜ï¼š<br>å¦‚æœå­RDDä¾èµ–å¤šä¸ªçˆ¶RDDçš„å¤šä¸ªå®Œæ•´åˆ†åŒºï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨çˆ¶RDDä¸€ä¸ªåˆ†åŒºæ•°æ®åˆ†åˆ°å­RDDå¤šä¸ªåˆ†åŒºçš„æƒ…å†µï¼Œé‚£å°±æ˜¯çª„ä¾èµ–ã€‚å› ä¸ºæ­¤æ—¶çˆ¶RDDä¸éœ€è¦å¯¹keyé‡æ–°åšåˆ†åŒºè®¡ç®—ï¼Œå­RDDä¹Ÿä¸éœ€è¦ç­‰çˆ¶RDDæ‰€æœ‰åˆ†åŒºè®¡ç®—å®Œæ¯•ã€‚","like_count":1,"discussions":[{"author":{"id":1825218,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKmNnjcib8AGd2MiagY9ek2oQysqSpvOcaQ30TReSozVibjWQydxx1FIGXDwyyP98pkbyAaI3GVctuJw/132","nickname":"ä¸ç™½","note":"","ucode":"8B0D683F60A405","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305678,"discussion_content":"&#34;ä¸éœ€è¦å¯¹keyé‡æ–°åšåˆ†åŒºè®¡ç®—&#34;æ˜¯æ€ä¹ˆç†è§£çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600053723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95092,"user_name":"Little Spirits","can_delete":false,"product_type":"c1","uid":1180772,"ip_address":"","ucode":"61EBC16F4FB47D","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/64/b53c0cc2.jpg","comment_is_top":false,"comment_ctime":1557967733,"is_pvip":true,"replies":[{"id":"48550","content":"å»ºè®®çœ‹ä¸€ä¸‹é«˜èµçš„å›ç­”ï¼Œé‚£ä½åŒå­¦çš„ç†è§£è¦æ›´åŠ å…¨é¢","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567394485,"ip_address":"","comment_id":95092,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5852935029","product_id":100025301,"comment_content":"å¤šä¸ªçˆ¶åˆ†åŒºåˆ°ä¸€ä¸ªå­åˆ†åŒºï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªçˆ¶åˆ†åŒºè€Œè¨€éƒ½æ˜¯pipelineçš„æ‰€ä»¥æ˜¯çª„ä¾èµ–ï¼Œè€Œä¸€ä¸ªçˆ¶åˆ†åŒºåˆ°å¤šä¸ªå­åˆ†åŒºå¯¹çˆ¶åˆ†åŒºè€Œè¨€ä¸æ˜¯pipelineçš„æ‰€ä»¥æ˜¯å®½ä¾èµ–","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450328,"discussion_content":"å»ºè®®çœ‹ä¸€ä¸‹é«˜èµçš„å›ç­”ï¼Œé‚£ä½åŒå­¦çš„ç†è§£è¦æ›´åŠ å…¨é¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567394485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94943,"user_name":"miwucc","can_delete":false,"product_type":"c1","uid":1326429,"ip_address":"","ucode":"7935BD907119AE","user_header":"https://static001.geekbang.org/account/avatar/00/14/3d/5d/ac666969.jpg","comment_is_top":false,"comment_ctime":1557927265,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5852894561","product_id":100025301,"comment_content":"å­rddä¾èµ–å¤šä¸ªçˆ¶rddæ¥äº§å‡ºç»“æœã€‚æ˜æ˜¾æ˜¯å®½ä¾èµ–ã€‚å› ä¸ºéœ€è¦ç­‰å¾…å¤šä¸ªçˆ¶rddç»“æœå®Œæ¯•æ‰èƒ½å¼€å§‹è®¡ç®—ã€‚å®½ä¾èµ–è¿˜æ˜¯çª„ä¾èµ–å…³é”®çœ‹æ˜¯å¦è¦ç­‰å¾…æ›´å¤šçˆ¶rddå‡†å¤‡å®Œæ¯•ã€‚","like_count":1,"discussions":[{"author":{"id":1583886,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2b/0e/af0d53af.jpg","nickname":"bigeast","note":"","ucode":"39976738E85062","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197767,"discussion_content":"å¥½åƒä¸å¯¹å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583428167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94715,"user_name":"é‚±ä»è´¤â€»klion26","can_delete":false,"product_type":"c1","uid":1027239,"ip_address":"","ucode":"36DF21F2B9E94C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a7/4d41966a.jpg","comment_is_top":false,"comment_ctime":1557884523,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852851819","product_id":100025301,"comment_content":"æ€è€ƒé¢˜ä¸­çª„ä¾èµ–åº”è¯¥æ˜¯ä¸å…³å¿ƒä¸€ä¸ªå­ rdd çš„ partition å¯¹åº”å¤šå°‘ä¸ª çˆ¶rdd çš„ partitionï¼Œåªè¦partitionå¯ä»¥ç‹¬ç«‹è®¡ç®—å°±è¡Œï¼Œæ¯”å¦‚ map æ“ä½œï¼Œå­ rdd åªæœ‰ 3 ä¸ª partitionï¼Œçˆ¶ rdd æœ‰6 ä¸ª partitionï¼Œé‚£ä¹ˆçˆ¶ rdd è‚¯å®šæœ‰ä¸¤ä¸ª partition çš„æ•°æ®ä¼šè½åˆ°å­ rdd çš„ä¸€ä¸ª partition ä¸­ï¼Œä½†æ˜¯è½åˆ°å­ rdd åŒä¸€ä¸ª partition çš„ä¸¤ä¸ª partition ä¸éœ€è¦ç­‰å¾…å°±å¯ä»¥è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤æ˜¯çª„ä¾èµ–","like_count":1},{"had_liked":false,"id":94660,"user_name":"CoderLean","can_delete":false,"product_type":"c1","uid":1518409,"ip_address":"","ucode":"DC9E25428EDB3F","user_header":"https://static001.geekbang.org/account/avatar/00/17/2b/49/e94b2a35.jpg","comment_is_top":false,"comment_ctime":1557880049,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852847345","product_id":100025301,"comment_content":"ç®—å•Šï¼Œçˆ¶å­rddå¯ä»¥é€šè¿‡å‡½æ•°è¿›è¡Œè½¬æ¢ï¼Œå¯¹äºè½¬æ¢å› å­æ˜¯åŸºæœ¬ä¸å˜çš„ï¼Œé‚£ä¹Ÿåº”è¯¥æ”¯æŒé€†è½¬æ¢ã€‚ï¼Œè€Œä¸€ä¸ªå­rddæ˜¯æ— æ³•æ¨å¯¼å‡ºçˆ¶rddçš„ï¼Œå› ä¸ºçˆ¶rddçš„æ•°æ®æ˜¯ç”±å‡½æ•°è½¬æ¢åæ‹†åˆ†ç»™å¤šä¸ªå­rddçš„ã€‚å¦å¤–ï¼Œä¹‹å‰æ²¡å­¦è¿‡sparkï¼Œå¯¹äºflinkå†…éƒ¨ç®—å­ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæ·±å…¥çš„ç†è®ºï¼Œå­¦å®Œè¿™ä¸ªåè¦å¯ä»¥å›å»çœ‹çœ‹flinkçš„ç®—å­æ˜¯æ€ä¹ˆå®ç°çš„","like_count":2},{"had_liked":false,"id":94641,"user_name":"Rainbow","can_delete":false,"product_type":"c1","uid":1259525,"ip_address":"","ucode":"248A7E2C05E4DE","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/05/67aae6c8.jpg","comment_is_top":false,"comment_ctime":1557877962,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852845258","product_id":100025301,"comment_content":"uionä¹Ÿæ˜¯çª„ä¾èµ–","like_count":1},{"had_liked":false,"id":94625,"user_name":"æ¶µ","can_delete":false,"product_type":"c1","uid":1502742,"ip_address":"","ucode":"BB8575DB13F1E0","user_header":"https://static001.geekbang.org/account/avatar/00/16/ee/16/742956ac.jpg","comment_is_top":false,"comment_ctime":1557868340,"is_pvip":false,"replies":[{"id":"48549","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567394320,"ip_address":"","comment_id":94625,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5852835636","product_id":100025301,"comment_content":"æˆ‘æƒ³è¿˜å¯ä»¥ç®—åšæ˜¯çª„ä¾èµ–ï¼Œå› ä¸ºå­RDDåˆ†åŒºæ‰€ä¾èµ–çš„å¯¹ä¸ªçˆ¶RDDåˆ†åŒºæ˜¯äº’æ–¥çš„ï¼Œæ‰€ä»¥æ¯ä¸ªå­RDDåˆ†åŒºæ‰€ä¾èµ–çš„å¤šä¸ªçˆ¶RDDåˆ†åŒºå¯ä»¥è¢«çœ‹åšä¸€ç»„åˆ†åŒºã€‚çˆ¶RDDçš„ç»„åˆ†åŒºä¸å­åˆ†åŒºæ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œæ»¡è¶³çª„ä¾èµ–å¯ä»¥å¹¶è¡Œè®¡ç®—ï¼Œè€Œæ— éœ€æ‰€ä»¥çˆ¶åˆ†åŒºéƒ½è®¡ç®—å®Œæ¯•æ‰å¯ä»¥å¼€å§‹è®¡ç®—çš„ç‰¹æ€§ã€‚","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450145,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567394320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382691,"discussion_content":"å®½çš„ä¹Ÿå¯ä»¥å¹¶è¡Œå§ï¼Œå“ªé‡Œéœ€è¦ç­‰å¾…çˆ¶åˆ†åŒºè®¡ç®—å®Œæ¯•ï¼Ÿçˆ¶åˆ†åŒºè®¡ç®—æŒ‡çš„æ˜¯ä»€ä¹ˆè®¡ç®—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625673158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287698,"user_name":"æé£","can_delete":false,"product_type":"c1","uid":2446192,"ip_address":"","ucode":"9A475482295B81","user_header":"https://static001.geekbang.org/account/avatar/00/25/53/70/f140cfb2.jpg","comment_is_top":false,"comment_ctime":1618112239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618112239","product_id":100025301,"comment_content":"æœ€é«˜èµçš„ç†è§£ä¸å¯¹å§ï¼","like_count":0},{"had_liked":false,"id":251842,"user_name":"Geek_04168","can_delete":false,"product_type":"c1","uid":2112008,"ip_address":"","ucode":"F125ADD877952E","user_header":"","comment_is_top":false,"comment_ctime":1601904271,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601904271","product_id":100025301,"comment_content":"ä¸€å­å¤šçˆ¶å±äºçª„ä¾èµ–ï¼Œä½†æˆ‘ç†è§£è¿™ç§æƒ…å†µä¸‹ï¼Œå¤šä¸ªçˆ¶ä¾èµ–åˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œæ˜¯ä¸æ”¯æŒæ–‡ä¸­â€œçª„ä¾èµ–å¯ä»¥æ”¯æŒåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šé“¾å¼æ‰§è¡Œå¤šæ¡å‘½ä»¤â€","like_count":0},{"had_liked":false,"id":247819,"user_name":"èŒ‚æ¨","can_delete":false,"product_type":"c1","uid":1181344,"ip_address":"","ucode":"8D8259E905DCA3","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/a0/3da0e315.jpg","comment_is_top":false,"comment_ctime":1599876670,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599876670","product_id":100025301,"comment_content":"è®²çš„çœŸæ˜¯æ¸…æ¥šå•Šã€‚<br>RDDæ˜¯æŠ½è±¡çš„æ•°æ®ç»“æ„ï¼Œä¿å­˜åœ¨å†…å­˜å½“ä¸­ï¼Œä½†æ˜¯è¦è®°ä½è¿™ä¸ªå†…å­˜å¯ä¸æ˜¯è¿ç»­çš„ï¼Œè€Œæ˜¯åˆ†å¸ƒå¼çš„ã€‚<br>è¿™å°±å¼•å‡ºäº†åˆ†åŒºçš„æ¦‚å¿µã€‚å®ƒæ˜¯éšè—åœ¨RDDä¸‹é¢çš„çœŸæ­£çš„å­˜å‚¨ç©ºé—´ã€‚","like_count":0},{"had_liked":false,"id":226655,"user_name":"bwv825","can_delete":false,"product_type":"c1","uid":1508445,"ip_address":"","ucode":"23447AD4E864E0","user_header":"https://static001.geekbang.org/account/avatar/00/17/04/5d/259d1768.jpg","comment_is_top":false,"comment_ctime":1592180330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592180330","product_id":100025301,"comment_content":"â€œè€Œå®½ä¾èµ–åˆ™å¿…é¡»ç­‰çˆ¶ RDD çš„æ‰€æœ‰åˆ†åŒºéƒ½è¢«è®¡ç®—å¥½ä¹‹åæ‰èƒ½å¼€å§‹å¤„ç†â€ã€‚æ­¤å¤„åº”ä¸ºâ€œå­ RDD çš„æ‰€æœ‰åˆ†åŒºâ€å§ã€‚å®½ä¾èµ–è¡¨ç¤ºä¸€ä¸ªçˆ¶åˆ†åŒºå¯ä»¥è¢«å¤šä¸ªå­åˆ†åŒºä½¿ç”¨ï¼Œä½†ä¸ä»£è¡¨å­åˆ†åŒºæœ‰å¤šä¸ªçˆ¶åˆ†åŒºã€‚","like_count":0},{"had_liked":false,"id":215391,"user_name":"åŒ—å†¥æœ‰é±¼","can_delete":false,"product_type":"c1","uid":1592243,"ip_address":"","ucode":"1690734A1061F4","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/b3/51bb33f2.jpg","comment_is_top":false,"comment_ctime":1588986112,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588986112","product_id":100025301,"comment_content":"åªè¦çˆ¶RDDçš„åˆ†åŒºæ•°æ®èƒ½å®Œæ•´çš„äº¤ç»™å­RDDå°±ç®—çª„ä¾èµ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­RDDå¯ä»¥ä¾èµ–å¤šä¸ªçˆ¶RDDã€‚å®½çª„ä¾èµ–æ˜¯åˆ’åˆ†stageçš„ä¾æ®ï¼Œåœ¨åŒä¸€ä¸ªstageä¸­ï¼Œè®¡ç®—é€»è¾‘æ˜¯å¯ä»¥åˆå¹¶çš„(å¦‚mapï¼Œfilter)ï¼Œè€Œä¸ç”¨æ¯æ¬¡è®¡ç®—é€»è¾‘éƒ½ç”Ÿæˆæ•°æ®ï¼Œå†éå†æ•°æ®ã€‚è€Œä¸åŒçš„stageé—´éœ€è¦shuffleï¼Œshuffleä¼šç”Ÿæˆä¸­é—´æ•°æ®ï¼Œä¸‹ä¸€ä¸ªstageéœ€è¦ç­‰å¾…ä¸Šä¸€ä¸ªstageæ‰§è¡Œå®Œå†æ‰§è¡Œï¼Œé€»è¾‘ä¹Ÿå°±ä¸èƒ½å’Œä¸Šä¸€ä¸ªstageè¿›è¡Œåˆå¹¶äº†ã€‚åŒæ—¶sparkè¦ä¿è¯ä»»åŠ¡å¤±è´¥ï¼Œèƒ½æ›´å¥½æ›´å¿«çš„é‡ç®—ï¼Œéœ€è¦æŠŠä¾èµ–çš„çˆ¶partitionä¿ç•™èµ·æ¥ï¼Œä»¥åŠshuffleåçš„ç»“æœæ•°æ®ä¿ç•™èµ·æ¥â€¦ ç†è§£ä¸å¯¹çš„åœ°æ–¹ï¼Œè¯·è€å¸ˆæŒ‡æ­£:)","like_count":0},{"had_liked":false,"id":195567,"user_name":"Eden2020","can_delete":false,"product_type":"c1","uid":1899158,"ip_address":"","ucode":"0DEE62F2335237","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fa/96/4a7b7505.jpg","comment_is_top":false,"comment_ctime":1585197897,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585197897","product_id":100025301,"comment_content":"ä¸»è¦åŒºåˆ†ä¸€ä¸ªè®¡ç®—æ˜¯å¦è¦ç­‰å¾…ä¾èµ–è®¡ç®—å®Œæˆäº†ï¼Œæœ‰å°±æ˜¯å®½ä¾èµ–ï¼Œæ²¡æœ‰å°±æ˜¯çª„ä¾èµ–ï¼Œé’ˆå¯¹å®é™…çš„è®¡ç®—éœ€æ±‚æ˜¯å¾ˆå®¹æ˜“åŒºåˆ†çš„","like_count":0},{"had_liked":false,"id":183851,"user_name":"åˆ˜æ¶¦æ£®","can_delete":false,"product_type":"c1","uid":1236556,"ip_address":"","ucode":"84101C670A6747","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/4c/a51ece16.jpg","comment_is_top":false,"comment_ctime":1583145563,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583145563","product_id":100025301,"comment_content":"sparké›†ç¾¤è¯»ä¸äº†æ–‡ä»¶ï¼Œsparkæœ¬åœ°è¯»å–å¾—åˆ°ï¼Œæ€ä¹ˆåŠï¼Ÿ","like_count":0},{"had_liked":false,"id":138262,"user_name":"Goku","can_delete":false,"product_type":"c1","uid":1031868,"ip_address":"","ucode":"8008F3BB10E609","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/bc/62d402da.jpg","comment_is_top":false,"comment_ctime":1570124482,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1570124482","product_id":100025301,"comment_content":"RDDçš„æ¯ä¸ªpartitionæœ‰æ²¡æœ‰replicationï¼Ÿä¸‡ä¸€nodeæŒ‚äº†æ€ä¹ˆåŠï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1031868,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/be/bc/62d402da.jpg","nickname":"Goku","note":"","ucode":"8008F3BB10E609","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":26449,"discussion_content":"è‡ªå·±å›ç­”ä¸€ä¸‹ï¼ŒæŒ‰ç…§ç›®å‰çš„ç†è§£åº”è¯¥æ˜¯æ²¡æœ‰replicationï¼Œå¤±è´¥äº†é‡æ–°è®¡ç®—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570602765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131980,"user_name":"kissrain","can_delete":false,"product_type":"c1","uid":1120583,"ip_address":"","ucode":"2177C53E3B2DCC","user_header":"https://static001.geekbang.org/account/avatar/00/11/19/47/b27f1314.jpg","comment_is_top":false,"comment_ctime":1567998463,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1567998463","product_id":100025301,"comment_content":"ä¹‹å‰æŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™éƒ½æ²¡æœ‰ä¸€ä¸ªå¯¹RDDå®Œæ•´è§£é‡Šæˆ–è€…è¯´çš„å¾ˆæ¨¡ç³Šã€‚è€å¸ˆçš„è¿™ç¯‡æ–‡ç« çœŸæ˜¯ä¸€é’ˆè§è¡€ï¼Œè¶Šæ˜¯å‰å®³çš„äººè¶Šæ˜¯èƒ½æŠŠåŸç†è¯´çš„è¶Šé€šä¿—æ˜“æ‡‚ã€‚","like_count":1,"discussions":[{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382701,"discussion_content":"è¿™äº›ä¸œè¥¿åªæœ‰æºç å’Œå®˜æ–¹æ–‡æ¡£è¯´çš„æ¸…æ¥šï¼Œå¤ªå†·é—¨äº†ï¼Œå°±å¥½æ¯”æ³¢éŸ³é£æœºçš„åŸç†æ˜¯ä»€ä¹ˆï¼Œä¼°è®¡ç½‘ä¸Šçš„èµ„æ–™å…¨æ²¡ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625673501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114890,"user_name":"hel","can_delete":false,"product_type":"c1","uid":1359507,"ip_address":"","ucode":"E9F93F32BCD7D7","user_header":"https://static001.geekbang.org/account/avatar/00/14/be/93/247fb2c8.jpg","comment_is_top":false,"comment_ctime":1563424410,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563424410","product_id":100025301,"comment_content":"æ–°RDDçš„åˆ†åŒºæ•°å¯ä»¥ä¸å’Œçˆ¶RDDçš„åˆ†åŒºæ•°æƒ³ç­‰å—","like_count":0,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2582,"discussion_content":"å¯ä»¥å•Šï¼Œunion ä¼šå˜å¤šï¼Œjoin æœ‰æ—¶ä¼šå˜å°‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563777738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107875,"user_name":"å¿ƒçµæ•æ‰‹","can_delete":false,"product_type":"c1","uid":1232527,"ip_address":"","ucode":"6D0BC463A000C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/8f/6daf02db.jpg","comment_is_top":false,"comment_ctime":1561627168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561627168","product_id":100025301,"comment_content":"è€å¸ˆé—®ä¸‹ï¼Œ<br>lines = sc.textFile(&quot;data.txt&quot;)<br>lineLengths = lines.map(lambda s: len(s))<br>totalLength = lineLengths.reduce(lambda a, b: a + b)<br>è¿™ä¸ªä»£ç ç›´æ¥åœ¨sparkä¸Šè¿è¡Œï¼ŒæŠ¥é”™&lt;console&gt;:1: error: &#39;)&#39; expected but &#39;(&#39; found.<br>val lineLengths = lines.map(lambda s: len(s))<br>","like_count":0},{"had_liked":false,"id":104197,"user_name":"dancer","can_delete":false,"product_type":"c1","uid":1019036,"ip_address":"","ucode":"B8D5641A3AC490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/9c/d48473ab.jpg","comment_is_top":false,"comment_ctime":1560679861,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1560679861","product_id":100025301,"comment_content":"è¿™é‡Œæœ‰ä¸ªç–‘æƒ‘å¸Œæœ›è€å¸ˆè§£ç­”ã€‚sparkæ¯ä¸€ä¸ªå­rddçš„éƒ½ä¼šè®°å½•ä»–å’Œçˆ¶rddåˆ†åŒºçš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥ä¸éœ€è¦æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚é‚£ä¹ˆæˆ‘ç†è§£æ‰€æœ‰è¿™å¿…é¡»ä¾èµ–äºçˆ¶rddä¹Ÿè¦ä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­æ‰å¯ä»¥ã€‚å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œæ˜¯ä¸æ˜¯sparkéœ€è¦ä¿å­˜æ‰€æœ‰æ­¥éª¤äº§ç”Ÿçš„rddåœ¨å†…å­˜ä¸­ã€‚ å¦å¤–å¦‚æœæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœæœºå™¨æ•…éšœï¼Œè¯¥æ€æ ·æ¢å¤æ•°æ®å‘¢ï¼Ÿæ„Ÿè°¢è€å¸ˆç”¨æ¥ç­”ç–‘çš„å®è´µæ—¶é—´ã€‚","like_count":0,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2586,"discussion_content":"æˆ‘è§‰å¾—è¿™å¥è¯å¼ºè°ƒçš„æ˜¯æƒ°æ€§è®¡ç®—çš„ç‰¹ç‚¹ï¼Œä¸­é—´å­ rdd åªä¿å­˜è®¡ç®—å…³ç³»ï¼ˆå¦‚ä½•ä»çˆ¶ rdd å¾—å‡ºï¼‰ï¼Œè€Œä¸æ˜¯å®é™…ç»“æœã€‚å…¨éƒ¨åœ¨å†…å­˜è¿™ä¸ªä¸ç»å¯¹ï¼Œæ¯”å¦‚è¿™ä¸ªæ•°æ®é›†æ¯”æœºå™¨å†…å­˜è¿˜å¤§ï¼Œæ˜¾ç„¶æ˜¯æ”¾ä¸ä¸‹çš„ï¼Œspark åº”è¯¥æ˜¯ä¸­é—´è®¡ç®—è¿‡ç¨‹ä¸­å°½é‡ä¼˜å…ˆä½¿ç”¨å†…å­˜ï¼Œå¹¶ä¸”ä¸€å®šæœ‰ç¡¬ç›˜çš„å…¨é‡å¿«ç…§å¤‡ä»½ï¼Œè¿™å—åº”è¯¥æ˜¯ spark å¤„ç†äº†è¿™äº›å­˜å‚¨ç»†èŠ‚ï¼Œæ²¡çœ‹è¿‡å…·ä½“æºç ï¼Œæˆ‘çŒœæ˜¯è¿™æ ·ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563778382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382705,"discussion_content":"ä¸‡ä¸€å†…å­˜åäº†å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625674208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2586,"ip_address":""},"score":382705,"extra":""}]}]},{"had_liked":false,"id":99267,"user_name":"Geek_f406a1","can_delete":false,"product_type":"c1","uid":1453834,"ip_address":"","ucode":"62A15101047054","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/4lUeUo6LHfsHLYfKaMQXQiaZVyEsqY1nfXU6dP0wN1KCch7LDIZTCO4rJ5mq1SdqY9FibCGMsjFdknULmEQ4Octg/132","comment_is_top":false,"comment_ctime":1559183768,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559183768","product_id":100025301,"comment_content":"çª„ä¾èµ–å¹¶ä¸æ˜¯å®Œå…¨çš„çˆ¶å­RDDä¸€ä¸€å¯¹åº”ï¼Œå­RDDå¯ä»¥å¯¹åº”å¤šä¸ªçˆ¶RDDï¼Œçˆ¶RDDåªèƒ½å¯¹åº”ä¸€ä¸ªRDDï¼Ÿæ˜¯å¦å¯ä»¥è¿™æ ·ç†è§£","like_count":0,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2584,"discussion_content":"æ˜¯çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563778050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96259,"user_name":"lwenbin","can_delete":false,"product_type":"c1","uid":1202109,"ip_address":"","ucode":"05C4CC6BE0B56C","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/bd/acf40fa0.jpg","comment_is_top":false,"comment_ctime":1558366979,"is_pvip":false,"replies":[{"id":"48552","content":"è¯´çš„å¯¹ã€‚æŸ¥é˜…paperæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ æ–¹æ³•ï¼Œç»™ä½ ç‚¹èµã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567394910,"ip_address":"","comment_id":96259,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558366979","product_id":100025301,"comment_content":"æ€è€ƒé¢˜ç­”æ¡ˆåº”è¯¥ç®—narrow partition. <br>çœ‹äº†spark rddè®ºæ–‡ï¼Œå¯¹è€å¸ˆè¯´çš„è¿™äº›æ¦‚å¿µæœ‰äº†æ–°çš„è®¤è¯†ã€‚<br>narrow partitionå¯¹åº”çš„è½¬æ¢ä¾‹å¦‚ï¼šmap, filter, joinï¼ˆå­åˆ†åŒºjoin keyéƒ½åœ¨ä¸€ä¸ªåˆ†åŒºï¼‰, union. å…¶ä¸­joinå’Œunionå°±å¯¹åº”äº†è€å¸ˆè¯´çš„å­åˆ†åŒºæ¥è‡ªäºå¤šä¸ªçˆ¶åˆ†åŒºã€‚<br>åŒºåˆ«åœ¨äºwide partitionæœ‰shuffleè¿‡ç¨‹ï¼Œå­˜åœ¨å¯¹äºåŒä¸€ä¸ªçˆ¶åˆ†åŒºä¸­ä¸¤ä¸ªrecord, ç»è¿‡è½¬æ¢æ“ä½œåä¼šå¯¹åº”åˆ°ä¸¤ä¸ªä¸åŒçš„å­åˆ†åŒºï¼Œæ‰€ä»¥è¿™äº›æ“ä½œä¾‹å¦‚ï¼šgroupByKey, é€šå¸¸çš„joinã€‚","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450798,"discussion_content":"è¯´çš„å¯¹ã€‚æŸ¥é˜…paperæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹ æ–¹æ³•ï¼Œç»™ä½ ç‚¹èµã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567394910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95572,"user_name":"ä¸€","can_delete":false,"product_type":"c1","uid":1220750,"ip_address":"","ucode":"28E0605EA1AE88","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/8e/6e4c7509.jpg","comment_is_top":false,"comment_ctime":1558084988,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558084988","product_id":100025301,"comment_content":"â€œåœ¨ç‰©ç†å­˜å‚¨ä¸­ï¼Œæ¯ä¸ªåˆ†åŒºæŒ‡å‘ä¸€ä¸ªå­˜æ”¾åœ¨å†…å­˜æˆ–è€…ç¡¬ç›˜ä¸­çš„æ•°æ®å—â€ï¼Œè€å¸ˆï¼Œè¿™ä¸€å¥ä¸å¤ªç†è§£ï¼Œæ¯ä¸ªåˆ†åŒºæŒ‡å‘æ•°æ®å—ï¼Œå¯æ˜¯å‰æ–‡è¯´åˆ°åˆ†åŒºåœ¨é€»è¾‘ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£æ•°ç»„æ€ä¹ˆèƒ½æŒ‡å‘æ•°æ®å—å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":95262,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1558000616,"is_pvip":false,"replies":[{"id":"48543","content":"HDFSæˆ‘è®¤ä¸ºå¹¶æ²¡æœ‰è¿‡æ—¶ï¼Œç°åœ¨å¤§éƒ¨åˆ†åˆ†å¸ƒå¼è®¡ç®—å¼•æ“è¿˜æ˜¯ä¸HDFSå­˜å‚¨çš„æ•°æ®è¿›è¡Œäº¤äº’ã€‚åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿæœ‰å¾ˆå¤šæ¯”å¦‚Amazonçš„Dynamo DBï¼ŒFacebookæ›¾ç»ç”¨çš„HBaseç­‰ç­‰ã€‚å¼€æºçš„è¯æˆ‘æ²¡æœ‰ç”¨è¿‡å¾ˆå¤šï¼Œcephå¬è¯´è¿˜ä¸é”™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567393223,"ip_address":"","comment_id":95262,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558000616","product_id":100025301,"comment_content":"è€å¸ˆï¼Œhadoopè®¡ç®—æ¡†æ¶Map&#47;Reduce è¿‡æ—¶äº†ï¼Œé‚£å¦ä¸€ä¸ªå­˜å‚¨æ¡†æ¶HDFSï¼Œä¹Ÿè¿‡æ—¶äº†å—ï¼Ÿ<br>ç°åœ¨æˆ‘çœ‹å¾ˆå¤šäº‘æä¾›å•†éƒ½æ˜¯å¯¹è±¡å­˜å‚¨å®ç°æµ·é‡éœ€æ±‚ï¼Œ<br>ç°åœ¨å¼€æºçš„åˆ†å¸ƒå¼å­˜å‚¨ï¼Œèƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ï¼Œç”¨ä»€ä¹ˆäº†,ceph?","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450390,"discussion_content":"HDFSæˆ‘è®¤ä¸ºå¹¶æ²¡æœ‰è¿‡æ—¶ï¼Œç°åœ¨å¤§éƒ¨åˆ†åˆ†å¸ƒå¼è®¡ç®—å¼•æ“è¿˜æ˜¯ä¸HDFSå­˜å‚¨çš„æ•°æ®è¿›è¡Œäº¤äº’ã€‚åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿæœ‰å¾ˆå¤šæ¯”å¦‚Amazonçš„Dynamo DBï¼ŒFacebookæ›¾ç»ç”¨çš„HBaseç­‰ç­‰ã€‚å¼€æºçš„è¯æˆ‘æ²¡æœ‰ç”¨è¿‡å¾ˆå¤šï¼Œcephå¬è¯´è¿˜ä¸é”™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567393223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94984,"user_name":"ä¸€ä¿®ğŸ’¤","can_delete":false,"product_type":"c1","uid":1014211,"ip_address":"","ucode":"CE3CB2E9A67DB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/c3/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1557933604,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557933604","product_id":100025301,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼Œç°åœ¨æœ‰ä¸ªinferenceä»»åŠ¡ä½¿ç”¨hadoop streamingï¼Œ1000ä¸ªmapperå¹¶è¡Œæ‰§è¡Œï¼Œæ²¡æœ‰reducerï¼Œéœ€è¦ä¸ºæ¯ä¸ªmapperè½½å…¥æ¨¡å‹ è¯å…¸ç­‰æ–‡ä»¶ï¼Œå¦‚æœæ”¹ç”¨sparkï¼Œèƒ½å¦å®ç°å¤šä¸ªRDDè¯»å–åŒä¸€å—å†…å­˜çš„æ¨¡å‹å’Œè¯å…¸ï¼Œè¾¾åˆ°èŠ‚çœå†…å­˜çš„æ•ˆæœï¼Ÿ è¿˜æœ›è€å¸ˆç­”å¤","like_count":0},{"had_liked":false,"id":94912,"user_name":"linuxfans","can_delete":false,"product_type":"c1","uid":1193815,"ip_address":"","ucode":"0C0BEE82F8A409","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/57/750c641d.jpg","comment_is_top":false,"comment_ctime":1557921230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557921230","product_id":100025301,"comment_content":"è¿™ä¸ªæ²¡æœ‰ç–‘é—®å§ï¼Ÿæ—¢ç„¶çˆ¶å­åˆ†åŒºæ˜¯ä¸€ä¸€å¯¹åº”ï¼Œå½“ç„¶ä¸å­˜åœ¨è¿™ç§æƒ…å†µäº†ã€‚å¦‚æœæ˜¯ä¸€å­å¯¹çˆ¶çš„æƒ…å†µï¼Œå°±å˜æˆå­åˆ†åŒºè¦ç­‰å¾…æ‰€ä»¥çˆ¶åˆ†åŒºçš„ç»“æœï¼Œå¹¶è¡Œçš„æ•ˆç‡é™ä½ã€‚","like_count":0},{"had_liked":false,"id":94792,"user_name":"è’™å¼€å¼º","can_delete":false,"product_type":"c1","uid":1317706,"ip_address":"","ucode":"61B3183781B9F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/4a/f9df2d06.jpg","comment_is_top":false,"comment_ctime":1557898592,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557898592","product_id":100025301,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œå­¦ä¹ äº†ä½ è¿™èŠ‚è®²çš„RDD,æˆ‘æœ‰ä¸ªé—®é¢˜å’¨è¯¢ä½ ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘è¦åˆ¤æ–­è¿™RDDæ˜¯å¦æœ‰æ•°æ®ï¼Œåœ¨ç”Ÿäº§ä¸­é‚£ç§æ–¹å¼æ˜¯æœ€ä¼˜çš„å‘¢ã€‚","like_count":0,"discussions":[{"author":{"id":1140311,"avatar":"https://static001.geekbang.org/account/avatar/00/11/66/57/e3bd54bd.jpg","nickname":"ç¬ƒè¡Œä¹‹","note":"","ucode":"F76B5C6D17765E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507,"discussion_content":"rdd.isempty","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561625983,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94668,"user_name":"æœ¨å«å…­","can_delete":false,"product_type":"c1","uid":1199495,"ip_address":"","ucode":"D113DF578C5BF5","user_header":"https://static001.geekbang.org/account/avatar/00/12/4d/87/57236a2d.jpg","comment_is_top":false,"comment_ctime":1557880766,"is_pvip":true,"replies":[{"id":"48551","content":"æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567394530,"ip_address":"","comment_id":94668,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557880766","product_id":100025301,"comment_content":"1.çª„ä¾èµ–æ˜¯æŒ‡çˆ¶ RDD çš„æ¯ä¸€ä¸ªåˆ†åŒºéƒ½å¯ä»¥å”¯ä¸€å¯¹åº”å­ RDD ä¸­çš„åˆ†åŒºï¼Œé‚£ä¹ˆæ˜¯å¦æ„å‘³ç€å­ RDD ä¸­çš„ä¸€ä¸ªåˆ†åŒºåªå¯ä»¥å¯¹åº”çˆ¶ RDD ä¸­çš„ä¸€ä¸ªåˆ†åŒºå‘¢ï¼Ÿ<br><br>ä¸æ˜¯çš„ï¼Œæ¯”å¦‚coalesceè¿™ç§åˆå¹¶åˆ†åŒºçš„æ“ä½œä¸­ï¼Œå­rddéœ€è¦ä¾èµ–çˆ¶rddçš„è‹¥å¹²ä¸ªåˆ†åŒºï¼Œä½†å®ƒä¸éœ€è¦å…¨éƒ¨çš„åˆ†åŒºï¼Œæ˜¯çª„ä¾èµ–<br><br>2.å¦‚æœå­ RDD çš„ä¸€ä¸ªåˆ†åŒºéœ€è¦ç”±çˆ¶ RDD ä¸­è‹¥å¹²ä¸ªåˆ†åŒºè®¡ç®—å¾—æ¥ï¼Œæ˜¯å¦è¿˜ç®—çª„ä¾èµ–ï¼Ÿ<br><br>ç®—ã€‚åªè¦çºªå½•å±‚çº§æ²¡å‘ç”Ÿé‡æ–°åˆ†åŒºï¼Œå…¨å±€æ··æ´—ï¼Œåº”è¯¥éƒ½å±äºçª„ä¾èµ–å§","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450164,"discussion_content":"æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567394530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94655,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1557879462,"is_pvip":false,"replies":[{"id":"48542","content":"å°±æ˜¯è¯´ï¼Œåˆ†åŒºæœ¬èº«ä¸ä¼šå­˜å‚¨æ•°æ®ï¼Œå®ƒåªæ˜¯æœ‰ä¸€ä¸ªæŒ‡å‘çœŸæ­£å­˜å‚¨æ•°æ®ä½ç½®çš„referenceã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567392855,"ip_address":"","comment_id":94655,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557879462","product_id":100025301,"comment_content":"rddçš„åˆ†åŒºä¸ä¿å­˜æ•°æ®ä»€ä¹ˆæ„æ€ï¼Ÿè€å¸ˆå¯ä»¥å¯¹rddç»“æ„å†æ·±å…¥è®²è§£ä¸ï¼Ÿæˆ‘è®¤ä¸ºå­rddåœ¨çª„ä¾èµ–ä¸­ä¸ä¼šå¯¹åº”å¤šä¸ªçˆ¶rddï¼Œæ‰ä¿éšœå•å‘ä¼ é€’","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450156,"discussion_content":"å°±æ˜¯è¯´ï¼Œåˆ†åŒºæœ¬èº«ä¸ä¼šå­˜å‚¨æ•°æ®ï¼Œå®ƒåªæ˜¯æœ‰ä¸€ä¸ªæŒ‡å‘çœŸæ­£å­˜å‚¨æ•°æ®ä½ç½®çš„referenceã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567392855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]}]}