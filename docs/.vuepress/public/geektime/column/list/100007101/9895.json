{"id":9895,"title":"第18讲 | DNS协议：网络世界的地址簿","content":"<p>前面我们讲了平时常见的看新闻、支付、直播、下载等场景，现在网站的数目非常多，常用的网站就有二三十个，如果全部用IP地址进行访问，恐怕很难记住。于是，就需要一个地址簿，根据名称，就可以查看具体的地址。</p><p>例如，我要去西湖边的“外婆家”，这就是名称，然后通过地址簿，查看到底是哪条路多少号。</p><h2>DNS服务器</h2><p>在网络世界，也是这样的。你肯定记得住网站的名称，但是很难记住网站的IP地址，因而也需要一个地址簿，就是<strong>DNS服务器</strong>。</p><p>由此可见，DNS在日常生活中多么重要。每个人上网，都需要访问它，但是同时，这对它来讲也是非常大的挑战。一旦它出了故障，整个互联网都将瘫痪。另外，上网的人分布在全世界各地，如果大家都去同一个地方访问某一台服务器，时延将会非常大。因而，<strong>DNS服务器，一定要设置成高可用、高并发和分布式的</strong>。</p><p>于是，就有了这样<strong>树状的层次结构</strong>。</p><p><img src=\"https://static001.geekbang.org/resource/image/89/4d/890ff98fde625c6a60fb71yy22d8184d.jpg?wh=1512*984\" alt=\"\">-   根DNS服务器 ：返回顶级域DNS服务器的IP地址</p><ul>\n<li>\n<p>顶级域DNS服务器：返回权威DNS服务器的IP地址</p>\n</li>\n<li>\n<p>权威DNS服务器 ：返回相应主机的IP地址</p>\n</li>\n</ul><h2>DNS解析流程</h2><p>为了提高DNS的解析性能，很多网络都会就近部署DNS缓存服务器。于是，就有了以下的DNS解析流程。</p><ol>\n<li>\n<p>电脑客户端会发出一个DNS请求，问www.163.com的IP是啥啊，并发给本地域名服务器 (本地DNS)。那本地域名服务器 (本地DNS) 是什么呢？如果是通过DHCP配置，本地DNS由你的网络服务商（ISP），如电信、移动等自动分配，它通常就在你网络服务商的某个机房。</p>\n</li>\n<li>\n<p>本地DNS收到来自客户端的请求。你可以想象这台服务器上缓存了一张域名与之对应IP地址的大表格。如果能找到 www.163.com，它就直接返回IP地址。如果没有，本地DNS会去问它的根域名服务器：“老大，能告诉我www.163.com的IP地址吗？”根域名服务器是最高层次的，全球共有13套。它不直接用于域名解析，但能指明一条道路。</p>\n</li>\n<li>\n<p>根DNS收到来自本地DNS的请求，发现后缀是 .com，说：“哦，www.163.com啊，这个域名是由.com区域管理，我给你它的顶级域名服务器的地址，你去问问它吧。”</p>\n</li>\n<li>\n<p>本地DNS转向问顶级域名服务器：“老二，你能告诉我www.163.com的IP地址吗？”顶级域名服务器就是大名鼎鼎的比如 .com、.net、 .org这些一级域名，它负责管理二级域名，比如 163.com，所以它能提供一条更清晰的方向。</p>\n</li>\n<li>\n<p>顶级域名服务器说：“我给你负责 www.163.com 区域的权威DNS服务器的地址，你去问它应该能问到。”</p>\n</li>\n<li>\n<p>本地DNS转向问权威DNS服务器：“您好，www.163.com 对应的IP是啥呀？”163.com的权威DNS服务器，它是域名解析结果的原出处。为啥叫权威呢？就是我的域名我做主。</p>\n</li>\n<li>\n<p>权威DNS服务器查询后将对应的IP地址X.X.X.X告诉本地DNS。</p>\n</li>\n<li>\n<p>本地DNS再将IP地址返回客户端，客户端和目标建立连接。</p>\n</li>\n</ol><!-- [[[read_end]]] --><p>至此，我们完成了DNS的解析过程。现在总结一下，整个过程我画成了一个图。</p><p><img src=\"https://static001.geekbang.org/resource/image/71/e8/718e3a1a1a7927302b6a0f836409e8e8.jpg?wh=1456*1212\" alt=\"\"></p><h2>负载均衡</h2><p>站在客户端角度，这是一次<strong>DNS递归查询过程。<strong>因为本地DNS全权为它效劳，它只要坐等结果即可。在这个过程中，DNS除了可以通过名称映射为IP地址，它还可以做另外一件事，就是</strong>负载均衡</strong>。</p><p>还是以访问“外婆家”为例，还是我们开头的“外婆家”，但是，它可能有很多地址，因为它在杭州可以有很多家。所以，如果一个人想去吃“外婆家”，他可以就近找一家店，而不用大家都去同一家，这就是负载均衡。</p><p>DNS首先可以做<strong>内部负载均衡</strong>。</p><p>例如，一个应用要访问数据库，在这个应用里面应该配置这个数据库的IP地址，还是应该配置这个数据库的域名呢？显然应该配置域名，因为一旦这个数据库，因为某种原因，换到了另外一台机器上，而如果有多个应用都配置了这台数据库的话，一换IP地址，就需要将这些应用全部修改一遍。但是如果配置了域名，则只要在DNS服务器里，将域名映射为新的IP地址，这个工作就完成了，大大简化了运维。</p><p>在这个基础上，我们可以再进一步。例如，某个应用要访问另外一个应用，如果配置另外一个应用的IP地址，那么这个访问就是一对一的。但是当被访问的应用撑不住的时候，我们其实可以部署多个。但是，访问它的应用，如何在多个之间进行负载均衡？只要配置成为域名就可以了。在域名解析的时候，我们只要配置策略，这次返回第一个IP，下次返回第二个IP，就可以实现负载均衡了。</p><p>另外一个更加重要的是，DNS还可以做<strong>全局负载均衡</strong>。</p><p>为了保证我们的应用高可用，往往会部署在多个机房，每个地方都会有自己的IP地址。当用户访问某个域名的时候，这个IP地址可以轮询访问多个数据中心。如果一个数据中心因为某种原因挂了，只要在DNS服务器里面，将这个数据中心对应的IP地址删除，就可以实现一定的高可用。</p><p>另外，我们肯定希望北京的用户访问北京的数据中心，上海的用户访问上海的数据中心，这样，客户体验就会非常好，访问速度就会超快。这就是全局负载均衡的概念。</p><h2>示例：DNS访问数据中心中对象存储上的静态资源</h2><p>我们通过DNS访问数据中心中对象存储上的静态资源为例，看一看整个过程。</p><p>假设全国有多个数据中心，托管在多个运营商，每个数据中心三个可用区（Available Zone）。对象存储通过跨可用区部署，实现高可用性。在每个数据中心中，都至少部署两个内部负载均衡器，内部负载均衡器后面对接多个对象存储的前置服务器（Proxy-server）。</p><p><img src=\"https://static001.geekbang.org/resource/image/0b/b6/0b241afef775a1c942c5728364b302b6.jpg?wh=2200*2262\" alt=\"\"></p><ol>\n<li>\n<p>当一个客户端要访问object.yourcompany.com的时候，需要将域名转换为IP地址进行访问，所以它要请求本地DNS解析器。</p>\n</li>\n<li>\n<p>本地DNS解析器先查看看本地的缓存是否有这个记录。如果有则直接使用，因为上面的过程太复杂了，如果每次都要递归解析，就太麻烦了。</p>\n</li>\n<li>\n<p>如果本地无缓存，则需要请求本地的DNS服务器。</p>\n</li>\n<li>\n<p>本地的DNS服务器一般部署在你的数据中心或者你所在的运营商的网络中，本地DNS服务器也需要看本地是否有缓存，如果有则返回，因为它也不想把上面的递归过程再走一遍。</p>\n</li>\n<li>\n<p>至 7. 如果本地没有，本地DNS才需要递归地从根DNS服务器，查到.com的顶级域名服务器，最终查到 yourcompany.com 的权威DNS服务器，给本地DNS服务器，权威DNS服务器按说会返回真实要访问的IP地址。</p>\n</li>\n</ol><p>对于不需要做全局负载均衡的简单应用来讲，yourcompany.com的权威DNS服务器可以直接将 object.yourcompany.com这个域名解析为一个或者多个IP地址，然后客户端可以通过多个IP地址，进行简单的轮询，实现简单的负载均衡。</p><p>但是对于复杂的应用，尤其是跨地域跨运营商的大型应用，则需要更加复杂的全局负载均衡机制，因而需要专门的设备或者服务器来做这件事情，这就是<strong>全局负载均衡器</strong>（<strong>GSLB</strong>，<strong>Global Server Load Balance</strong>）。</p><p>在yourcompany.com的DNS服务器中，一般是通过配置CNAME的方式，给 object.yourcompany.com起一个别名，例如 object.vip.yourcomany.com，然后告诉本地DNS服务器，让它请求GSLB解析这个域名，GSLB就可以在解析这个域名的过程中，通过自己的策略实现负载均衡。</p><p>图中画了两层的GSLB，是因为分运营商和地域。我们希望不同运营商的客户，可以访问相同运营商机房中的资源，这样不跨运营商访问，有利于提高吞吐量，减少时延。</p><ol>\n<li>\n<p>第一层GSLB，通过查看请求它的本地DNS服务器所在的运营商，就知道用户所在的运营商。假设是移动，通过CNAME的方式，通过另一个别名 object.yd.yourcompany.com，告诉本地DNS服务器去请求第二层的GSLB。</p>\n</li>\n<li>\n<p>第二层GSLB，通过查看请求它的本地DNS服务器所在的地址，就知道用户所在的地理位置，然后将距离用户位置比较近的Region里面，六个<strong>内部负载均衡</strong>（<strong>SLB</strong>，S<strong>erver Load Balancer</strong>）的地址，返回给本地DNS服务器。</p>\n</li>\n<li>\n<p>本地DNS服务器将结果返回给本地DNS解析器。</p>\n</li>\n<li>\n<p>本地DNS解析器将结果缓存后，返回给客户端。</p>\n</li>\n<li>\n<p>客户端开始访问属于相同运营商的距离较近的Region 1中的对象存储，当然客户端得到了六个IP地址，它可以通过负载均衡的方式，随机或者轮询选择一个可用区进行访问。对象存储一般会有三个备份，从而可以实现对存储读写的负载均衡。</p>\n</li>\n</ol><h2>小结</h2><p>好了，这节内容就到这里了，我们来总结一下：</p><ul>\n<li>\n<p>DNS是网络世界的地址簿，可以通过域名查地址，因为域名服务器是按照树状结构组织的，因而域名查找是使用递归的方法，并通过缓存的方式增强性能；</p>\n</li>\n<li>\n<p>在域名和IP的映射过程中，给了应用基于域名做负载均衡的机会，可以是简单的负载均衡，也可以根据地址和运营商做全局的负载均衡。</p>\n</li>\n</ul><p>最后，给你留两个思考题：</p><ol>\n<li>\n<p>全局负载均衡为什么要分地址和运营商呢？</p>\n</li>\n<li>\n<p>全局负载均衡使用过程中，常常遇到失灵的情况，你知道具体有哪些情况吗？对应应该怎么来解决呢？</p>\n</li>\n</ol><p>我们的专栏更新过半了，不知你掌握得如何？每节课后我留的思考题，你都有没有认真思考，并在留言区写下答案呢？我会从<strong>已发布的文章中选出一批认真留言的同学</strong>，赠送**<span class=\"orange\">学习奖励礼券</span><strong>和我整理的</strong><span class=\"orange\">独家网络协议知识图谱</span>**。</p><p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>","comments":[{"had_liked":false,"id":13889,"user_name":"iiwoai","can_delete":false,"product_type":"c1","uid":1159368,"ip_address":"","ucode":"ADAE57FD62A15B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b0/c8/342a063f.jpg","comment_is_top":false,"comment_ctime":1530060271,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1307200118255","product_id":100007101,"comment_content":"图谱应该都给赠送才对啊","like_count":305,"discussions":[{"author":{"id":2045997,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/38/2d/f3c6493e.jpg","nickname":"罗樱罂","note":"","ucode":"9072E79E625ED1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298609,"discussion_content":"希望看到这里的同学可以去发现，加课2有图谱。","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1597342825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1717549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/35/2d/a2bde67e.jpg","nickname":"SapereAude","note":"","ucode":"C5D61C535B7B10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":61169,"discussion_content":"https://zhidao.baidu.com/question/2143847352867217668.html","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1574774776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2043995,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/30/5b/82e3952c.jpg","nickname":"Wongkakui","note":"","ucode":"0E6AEC23757A4E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1717549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/35/2d/a2bde67e.jpg","nickname":"SapereAude","note":"","ucode":"C5D61C535B7B10","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287922,"discussion_content":"没有啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593589764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":61169,"ip_address":""},"score":287922,"extra":""}]}]},{"had_liked":false,"id":13875,"user_name":"^_^","can_delete":false,"product_type":"c1","uid":1122575,"ip_address":"","ucode":"30E994A1627EB1","user_header":"https://static001.geekbang.org/account/avatar/00/11/21/0f/b61dc67e.jpg","comment_is_top":false,"comment_ctime":1530055920,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"538400967920","product_id":100007101,"comment_content":"老师，独家网络协议知识图谱，这么好的东西，应该阳光普照，哈哈","like_count":125,"discussions":[{"author":{"id":1364537,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ5ud2qLuP9jh9j090GmzGoGKKOLcibqch8jFZ2gKO5APCm6jXzbqvN7TUQ5eMG6TUE5jcibMyHYgzw/132","nickname":"ceg","note":"","ucode":"A3882A7D2410F5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":123645,"discussion_content":"有电子版吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578406568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20674,"user_name":"公告-SRE运维实践","can_delete":false,"product_type":"c1","uid":1010344,"ip_address":"","ucode":"86F4E48AE1D9D8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6a/a8/ee414a25.jpg","comment_is_top":false,"comment_ctime":1534659081,"is_pvip":false,"replies":[{"id":"7269","content":"对的","user_name":"作者回复","comment_id":20674,"uid":"1001590","ip_address":"","utype":1,"ctime":1534730379,"user_name_real":"刘超@网易云"}],"discussion_count":6,"race_medal":0,"score":"392376683017","product_id":100007101,"comment_content":"分地址和运营商主要是为了返回最优的ip，也就是离用户最近的ip，提高用户访问的速度，分运营商也是返回最快的一条路径。gslb失灵一般是因为一个ns请求gslb的时候，看不到用户真实的ip，从而不一定是最优的，而且这个返回的结果可能给一个用户或者一万个用户，可以通过流量监测来缓解。","like_count":92,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422359,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534730379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1241121,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f0/21/7168f973.jpg","nickname":"JStFs","note":"","ucode":"636E85653555DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6602,"discussion_content":"gslb一旦返回本地dns一组ip，就缓存了，那么谁来访问都会给缓存，所以一定不是所有人都最优，是这个意思吗，如果是的话，那我终于理解了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566989339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2849942,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/7c/96/d430fa56.jpg","nickname":"amber","note":"","ucode":"AA171E49C0DF2A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1241121,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f0/21/7168f973.jpg","nickname":"JStFs","note":"","ucode":"636E85653555DD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539956,"discussion_content":"应该是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639899315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6602,"ip_address":""},"score":539956,"extra":""}]},{"author":{"id":1263294,"avatar":"https://static001.geekbang.org/account/avatar/00/13/46/be/d3040f9e.jpg","nickname":"小广","note":"","ucode":"9738E8DCEF9E3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3643,"discussion_content":"我想请教下，为啥不能在第一层gslb上把运营商和地域判断一起做，直接返回真实的ip呢，这样就少了和第二层gslb的交互了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564655710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1241121,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f0/21/7168f973.jpg","nickname":"JStFs","note":"","ucode":"636E85653555DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1263294,"avatar":"https://static001.geekbang.org/account/avatar/00/13/46/be/d3040f9e.jpg","nickname":"小广","note":"","ucode":"9738E8DCEF9E3C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6601,"discussion_content":"老师应该是举了包括所有情况下的例子，当然第一个gslb也可能就匹配上了运营商和地域了，那就直接处理","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566989227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3643,"ip_address":""},"score":6601,"extra":""}]},{"author":{"id":1173894,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e9/86/d34800a4.jpg","nickname":"heyman","note":"","ucode":"92EF9EF1B1B1B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580713,"discussion_content":"NS是什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658332743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13909,"user_name":"coldfire","can_delete":false,"product_type":"c1","uid":1135610,"ip_address":"","ucode":"52210E5F2104AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/fa/6fb4e123.jpg","comment_is_top":false,"comment_ctime":1530062328,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"173328754168","product_id":100007101,"comment_content":"从真名到别名怎么完成均衡负载，感觉没讲清楚，对于小白来说这就是一笔带过留了个影响","like_count":40,"discussions":[{"author":{"id":1593810,"avatar":"https://static001.geekbang.org/account/avatar/00/18/51/d2/dddffa12.jpg","nickname":"胸怀宇宙瓜皮李","note":"","ucode":"469FC3B32B279D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1915,"discussion_content":"看了会资料，这里为什么会是使用全局解释器来完成域名解析：应该是在权威域名解析器中，指定了NS记录， 该记录就是全局负载均衡器的ip地址，这里的意思就是将域名解析任务委托给了全局负载均衡器，由该服务器经过处理，给出最优ip\n","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1563092393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"尔冬橙","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3229,"discussion_content":"什么是NS？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564323152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2842957,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/61/4d/aed824bb.jpg","nickname":"凌","note":"","ucode":"D9C57C4FFD4EFB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"尔冬橙","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532747,"discussion_content":"他说的是 NS记录 ，是是域名服务器的记录","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637676929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3229,"ip_address":""},"score":532747,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":91404,"user_name":"Garwen","can_delete":false,"product_type":"c1","uid":1045062,"ip_address":"","ucode":"C76346E1734AB8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/46/09c457eb.jpg","comment_is_top":false,"comment_ctime":1557026743,"is_pvip":false,"replies":[{"id":"49483","content":"一方面，dns要求有缓存。另一方面，根服务器没有12306业务逻辑这么复杂，什么各种高铁段的计算啊，而且涉及事务，两个人不能同一个位置，涉及支付。根服务器基本只需要维护下一级别的就可以了，而下一个级别的相对稳定，而且都是静态的。所以支撑过双十一我们就知道，凡是静态的，我有一万种方式可以搞定，就怕落数据库","user_name":"作者回复","comment_id":91404,"uid":"1001590","ip_address":"","utype":1,"ctime":1567675067,"user_name_real":"刘超@网易云"}],"discussion_count":3,"race_medal":0,"score":"134701012919","product_id":100007101,"comment_content":"刘超老师，根域名服务器的访问不还是无法逃离高并发访问的场景吗，虽说本地的DNS已经可以解决80%请求的地址解析，但还是会有极其庞大数量的访问需要去找根域名服务器的吧，这里的根域名服务器的高并发场景不比12306小吧，是如何解决的呢？","like_count":32,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448909,"discussion_content":"一方面，dns要求有缓存。另一方面，根服务器没有12306业务逻辑这么复杂，什么各种高铁段的计算啊，而且涉及事务，两个人不能同一个位置，涉及支付。根服务器基本只需要维护下一级别的就可以了，而下一个级别的相对稳定，而且都是静态的。所以支撑过双十一我们就知道，凡是静态的，我有一万种方式可以搞定，就怕落数据库","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1567675067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267235,"discussion_content":"这个问题我也想问，原来静态数据这么厉害","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589618839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1045062,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f2/46/09c457eb.jpg","nickname":"Garwen","note":"","ucode":"C76346E1734AB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7787,"discussion_content":"谢谢老师，学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567675151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13925,"user_name":"知识改变命运","can_delete":false,"product_type":"c1","uid":1137158,"ip_address":"","ucode":"664229F4ADC42C","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/06/ca4cd46e.jpg","comment_is_top":false,"comment_ctime":1530066153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"91724379369","product_id":100007101,"comment_content":"感谢刘老师的讲解！这几次课的理解程度好多了！话说不是不愿意回答思考题，而是小白无力回答~最后，同求知识图谱~多谢多谢","like_count":21},{"had_liked":false,"id":13905,"user_name":"upstream","can_delete":false,"product_type":"c1","uid":1000385,"ip_address":"","ucode":"2B106D3D4D9F85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/c1/576c01a1.jpg","comment_is_top":false,"comment_ctime":1530062103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61659604247","product_id":100007101,"comment_content":"问题1，分成两级还是在于国内网络跨运营商访问慢<br>问题2，如果用户是上海电信，用户本地dns不是用的电信dns服务器，负载均衡调度会不准确。针对app的可以httpdns<br>针对网站的除非能支持edns协议才比较好。<br>另外当用户使用阿里云这类anycast 地址时，不清楚gslb调度策略如何的","like_count":14},{"had_liked":false,"id":13877,"user_name":"upstream","can_delete":false,"product_type":"c1","uid":1000385,"ip_address":"","ucode":"2B106D3D4D9F85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/c1/576c01a1.jpg","comment_is_top":false,"comment_ctime":1530057701,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"61659599845","product_id":100007101,"comment_content":"虽然有了域名，但对于大多数人而言，能记住的就那么一两个网站地址。于是，打开baidu.com 搜索想要打开的网站，也就不奇怪了。打开baidu.com 搜索谷歌，再去访问Google 也就成为很多人的默认行为。说白了，也还是记不住域名。<br>Baidu.com 搜索qq邮箱的大有人在","like_count":14,"discussions":[{"author":{"id":1019311,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/s6f4qmyv7roBPnOic3bNZL8Y828aqcVAyYOBVxiaUCBibMDRp4ulNOfmyxicsOoqcGMOSwjibhpibjg6EONkNWKhXZ4Q/132","nickname":"Linking","note":"","ucode":"6E6189980D8C71","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574433,"discussion_content":"这样做特别别扭，浪费了不少时间和流量、资源","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654063231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1901927,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/05/67/40a86245.jpg","nickname":"AA.召唤之心","note":"","ucode":"6447369C35FD68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360818,"discussion_content":"IP可能会变，域名可以保证不变。所以域名好记只是一个特性，不是全部特性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616545264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1510621,"avatar":"https://static001.geekbang.org/account/avatar/00/17/0c/dd/1b12d77d.jpg","nickname":"Dragon Frog","note":"","ucode":"6B4A2ECFA818E2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":242,"discussion_content":"然而在搜索栏里输入qq邮箱就会跳出qq邮箱的网址= =只要曾经访问过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561354146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44376,"user_name":"jim","can_delete":false,"product_type":"c1","uid":1206113,"ip_address":"","ucode":"BC5856B8FAD9E7","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/61/ea54229a.jpg","comment_is_top":false,"comment_ctime":1543416431,"is_pvip":false,"replies":[{"id":"16020","content":"是的","user_name":"作者回复","comment_id":44376,"uid":"1001590","ip_address":"","utype":1,"ctime":1543542155,"user_name_real":"刘超@网易云"}],"discussion_count":3,"race_medal":0,"score":"57377991279","product_id":100007101,"comment_content":"浏览器，路由器也有缓存吧？","like_count":13,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430745,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543542155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1178426,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fb/3a/3dc7c61c.jpg","nickname":"꧁༺༻꧂","note":"","ucode":"8BFD5C1F6ED235","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":590699,"discussion_content":"路由器不缓存dns解析记录吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666015821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":430745,"ip_address":"四川"},"score":590699,"extra":""}]},{"author":{"id":1478011,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8d/7b/a09a9cb3.jpg","nickname":"h","note":"","ucode":"26D8D71529D553","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221753,"discussion_content":"比如一个网站被ddos了 那他的高防策略会不断切换IP 那么路由器缓存。可能会频繁失效了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586056296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115482,"user_name":"alexgzh","can_delete":false,"product_type":"c1","uid":1476632,"ip_address":"","ucode":"EE3228511C8B9B","user_header":"https://static001.geekbang.org/account/avatar/00/16/88/18/a88cdaf5.jpg","comment_is_top":false,"comment_ctime":1563600640,"is_pvip":false,"replies":[{"id":"46560","content":"对的，负载均衡","user_name":"作者回复","comment_id":115482,"uid":"1001590","ip_address":"","utype":1,"ctime":1566357693,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"48808240896","product_id":100007101,"comment_content":"以前只知道DNS是方便記憶。今天學到了DNS其實是解耦應用和被訪問應用的IP地址，還有局部負載均衡和全局負載均衡的功能, 學到了！！","like_count":11,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459126,"discussion_content":"对的，负载均衡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566357693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87574,"user_name":"古夜","can_delete":false,"product_type":"c1","uid":1341612,"ip_address":"","ucode":"0A82D3CFCEDF07","user_header":"https://static001.geekbang.org/account/avatar/00/14/78/ac/e5e6e7f3.jpg","comment_is_top":false,"comment_ctime":1555636867,"is_pvip":false,"replies":[{"id":"49601","content":"对的","user_name":"作者回复","comment_id":87574,"uid":"1001590","ip_address":"","utype":1,"ctime":1567691267,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"48800277123","product_id":100007101,"comment_content":"这一课看懂了，还联想到了ping百度域名有时候返回ip不一样的问题，感谢","like_count":11,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447513,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567691267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":23990,"user_name":"杨春鹏","can_delete":false,"product_type":"c1","uid":1172056,"ip_address":"","ucode":"518F38232F97B5","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/58/8c8897c8.jpg","comment_is_top":false,"comment_ctime":1536742185,"is_pvip":false,"replies":[{"id":"8781","content":"host","user_name":"作者回复","comment_id":23990,"uid":"1001590","ip_address":"","utype":1,"ctime":1536760133,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"35896480553","product_id":100007101,"comment_content":"当访问网站的时候，是先去访问host文件还是，本地DNS缓存？","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423801,"discussion_content":"host","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536760133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113595,"user_name":"胸怀宇宙瓜皮李","can_delete":false,"product_type":"c1","uid":1593810,"ip_address":"","ucode":"469FC3B32B279D","user_header":"https://static001.geekbang.org/account/avatar/00/18/51/d2/dddffa12.jpg","comment_is_top":false,"comment_ctime":1563090836,"is_pvip":false,"replies":[{"id":"46628","content":"不是所有的人都要两层","user_name":"作者回复","comment_id":113595,"uid":"1001590","ip_address":"","utype":1,"ctime":1566369059,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"27332894612","product_id":100007101,"comment_content":"确实不是很理解为什么需要两次的全局负载均衡？为什么不在第一次的负载均衡中，直接获取DNS服务器所在地址和DNS服务提供商？","like_count":7,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458297,"discussion_content":"不是所有的人都要两层","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566369059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15913,"user_name":"一粟","can_delete":false,"product_type":"c1","uid":1058773,"ip_address":"","ucode":"2EE966F3C36B5F","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/d5/0fd21753.jpg","comment_is_top":false,"comment_ctime":1531643198,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27301446974","product_id":100007101,"comment_content":"要解析本地DNS缓存，需要启动DNS Sclient服务，此服务不开启hosts配置会失效。","like_count":6,"discussions":[{"author":{"id":1295596,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIBJYQ73yYqmiaU7Zg0BHPh9gpSglI79Dzcbob7I2tZOhTjbTTCw13KzVusYhLbKkukV9Ru5UfJMxQ/132","nickname":"Geek_2d276a","note":"","ucode":"866B39EBE71356","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387175,"discussion_content":"这里的hosts和本地dns缓存是一回事吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628038562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104558,"user_name":"极客时间","can_delete":false,"product_type":"c1","uid":1015564,"ip_address":"","ucode":"AF7565BB5EF164","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/0c/392ce255.jpg","comment_is_top":false,"comment_ctime":1560776847,"is_pvip":false,"replies":[{"id":"49024","content":"返回给他就可以了。","user_name":"作者回复","comment_id":104558,"uid":"1001590","ip_address":"","utype":1,"ctime":1567580388,"user_name_real":"刘超@网易云"}],"discussion_count":7,"race_medal":0,"score":"23035613327","product_id":100007101,"comment_content":"引用原文中的话：<br>“在 yourcompany.com 的 DNS 服务器中，一般是通过配置 CNAME 的方式，给<br>object.yourcompany.com 起一个别名，例如 object.vip.yourcomany.com，然后告诉本地 DNS<br>服务器，让它请求 GSLB 解析这个域名，GSLB 就可以在解析这个域名的过程中，通过自己的策略实<br>现负载均衡”<br>这里有一句没明白，告诉本地服务器，让object.vip.yourcomany.com域名去GSLB解析，这个应该如何告诉呢","like_count":5,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454324,"discussion_content":"返回给他就可以了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567580388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1090348,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a3/2c/6e3fdfa7.jpg","nickname":"Jimmy","note":"","ucode":"92B4D621811175","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365037,"discussion_content":"通过返回GSLB的NS记录告知local DNS。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1617691247,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018918,"avatar":"","nickname":"大宁","note":"","ucode":"F87C2C1F3C6D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587668,"discussion_content":"我的理解：\n通过在权威DNS服务器提前配置的ns记录，ns记录会将“object.vip.yourcomany.com”域名的解析工作交付到GLSB（ip地址）来完成智能解析~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663213111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267242,"discussion_content":"极客时间有了意识？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589619169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1848364,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/34/2c/cd158db1.jpg","nickname":"小刘","note":"","ucode":"F50BCF1E9D285A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":246718,"discussion_content":"为啥你名字能叫极客时间","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587773024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1151854,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/THkFNC52F0kYs2XI1fwxOvCck0Pibwnia4z6fzCPMRg2qYQLlt57qW4caJZ6uj9lWROc7t1OHFmIdKmiaEIP2GXpg/132","nickname":"isaac","note":"","ucode":"62ACA5B9A44D1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":165317,"discussion_content":"同样是这个疑问，dns服务器的访问是通过域名还是ip地址呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581263324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1593810,"avatar":"https://static001.geekbang.org/account/avatar/00/18/51/d2/dddffa12.jpg","nickname":"胸怀宇宙瓜皮李","note":"","ucode":"469FC3B32B279D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1909,"discussion_content":"返回GSLB的ip地址？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563089844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13876,"user_name":"LongXiaJun","can_delete":false,"product_type":"c1","uid":1154688,"ip_address":"","ucode":"B5246BF0DAF4F7","user_header":"https://static001.geekbang.org/account/avatar/00/11/9e/80/b87f8b49.jpg","comment_is_top":false,"comment_ctime":1530056878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23004893358","product_id":100007101,"comment_content":"😃😃😃现在一周三天都在期待专栏更新~","like_count":5},{"had_liked":false,"id":96848,"user_name":"起风了001","can_delete":false,"product_type":"c1","uid":1529929,"ip_address":"","ucode":"8DCDBA40B8CC9F","user_header":"","comment_is_top":false,"comment_ctime":1558520353,"is_pvip":false,"replies":[{"id":"49270","content":"通过添加NS也是可以的","user_name":"作者回复","comment_id":96848,"uid":"1001590","ip_address":"","utype":1,"ctime":1567609122,"user_name_real":"刘超@网易云"}],"discussion_count":2,"race_medal":0,"score":"18738389537","product_id":100007101,"comment_content":"好像设置GSLB是通过添加NS记录实现的, 不是CNAME呀.","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451033,"discussion_content":"通过添加NS也是可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567609122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1295596,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIBJYQ73yYqmiaU7Zg0BHPh9gpSglI79Dzcbob7I2tZOhTjbTTCw13KzVusYhLbKkukV9Ru5UfJMxQ/132","nickname":"Geek_2d276a","note":"","ucode":"866B39EBE71356","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387177,"discussion_content":"递归查询域名是，根服务器返回的报文是ns记录还是cname记录呀？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628038741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33649,"user_name":"曾经瘦过","can_delete":false,"product_type":"c1","uid":1240106,"ip_address":"","ucode":"57C32575A1C1FD","user_header":"https://static001.geekbang.org/account/avatar/00/12/ec/2a/b11d5ad8.jpg","comment_is_top":false,"comment_ctime":1539844221,"is_pvip":false,"replies":[{"id":"12135","content":"图谱最后一篇里面有啊","user_name":"作者回复","comment_id":33649,"uid":"1001590","ip_address":"","utype":1,"ctime":1539919589,"user_name_real":"刘超@网易云"}],"discussion_count":3,"race_medal":0,"score":"18719713405","product_id":100007101,"comment_content":"报名太晚了 不知道是否还可以获得独家网络知识图谱和学习奖励券","like_count":4,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427022,"discussion_content":"图谱最后一篇里面有啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539919589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1364537,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ5ud2qLuP9jh9j090GmzGoGKKOLcibqch8jFZ2gKO5APCm6jXzbqvN7TUQ5eMG6TUE5jcibMyHYgzw/132","nickname":"ceg","note":"","ucode":"A3882A7D2410F5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":123650,"discussion_content":"在哪有图谱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578406640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1019568,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","nickname":"CcczzZ","note":"","ucode":"5F46DA5053D2BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1364537,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ5ud2qLuP9jh9j090GmzGoGKKOLcibqch8jFZ2gKO5APCm6jXzbqvN7TUQ5eMG6TUE5jcibMyHYgzw/132","nickname":"ceg","note":"","ucode":"A3882A7D2410F5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287355,"discussion_content":"加餐文章有","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593423100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":123650,"ip_address":""},"score":287355,"extra":""}]}]},{"had_liked":false,"id":306007,"user_name":"C++大雄","can_delete":false,"product_type":"c1","uid":2618734,"ip_address":"","ucode":"04473EB297C093","user_header":"https://static001.geekbang.org/account/avatar/00/27/f5/6e/55ec1ed1.jpg","comment_is_top":false,"comment_ctime":1628298099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14513199987","product_id":100007101,"comment_content":"文中有一处不严谨，DNS分为迭代查询和递归查询，图三中5-9的查询应该是迭代，3是递归","like_count":3},{"had_liked":false,"id":204908,"user_name":"雷刚","can_delete":false,"product_type":"c1","uid":1655725,"ip_address":"","ucode":"115FE2BE1AAB61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","comment_is_top":false,"comment_ctime":1586489469,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14471391357","product_id":100007101,"comment_content":"ISO 七层协议中每一层都有自己的寻址方式：应用层用过域名（主机名）寻址，网络层通过 IP 寻址，链路层通过MAC 寻址。这样每一层都是独立的，但不同层之间交流时就需要进行地址转换：<br>1. DNS 协议：将域名转换为 IP 地址。<br>2. ARP 协议：将 IP 转换为 MAC 地址。","like_count":3},{"had_liked":false,"id":128500,"user_name":"刘培培","can_delete":false,"product_type":"c1","uid":1000018,"ip_address":"","ucode":"77D1914E50E7E5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/52/19553613.jpg","comment_is_top":false,"comment_ctime":1566890260,"is_pvip":false,"replies":[{"id":"48762","content":"赞","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567494601,"ip_address":"","comment_id":128500,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14451792148","product_id":100007101,"comment_content":"1. 不同地区和运营商之间延迟不同，所以优先选择同运营商、同地区服务<br><br>2. GLSB 挂掉了，客户端地址、运营商变更了，缓存未及时更新。","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464974,"discussion_content":"赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567494601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69818,"user_name":"caohuan","can_delete":false,"product_type":"c1","uid":1256428,"ip_address":"","ucode":"4B092E33F3DF1E","user_header":"https://static001.geekbang.org/account/avatar/00/13/2b/ec/af6d0b10.jpg","comment_is_top":false,"comment_ctime":1550852663,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14435754551","product_id":100007101,"comment_content":"本篇所得：1.DNS区域名称系统 也为域名系统，它为网络世界的地址薄，可以通过域名查地址，因为域名服务是按树状结构组织，域名查询是使用递归方法查询，缓存可以增强反应速度，提供性能 ;2.域名通过DNS查询IP，DNS给予应用基于域名做负载均衡，可以是简单的负载均衡也可以是基于地址和运营商做全局负载均衡。<br><br>回答老师的问题1.全局负载均衡 分地址，为返回数据提供最快的速度，分运营商 这有跨网络，寻找路线 不是最短或者最优的，所以 就近 在同一个运营商 较快。2.全局负载均衡 失灵，DNS没有及时更新，所以域名与IP对应不上，得不到反馈，不能正常访问，有不对之处 请指正。","like_count":3},{"had_liked":false,"id":15309,"user_name":"selboo","can_delete":false,"product_type":"c1","uid":1017006,"ip_address":"","ucode":"E4E46C085BD17F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/ae/2b8192e8.jpg","comment_is_top":false,"comment_ctime":1531101084,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14416002972","product_id":100007101,"comment_content":"在递归的时候。返回的授权ns如果链接不上。dns服务器怎么处理的？<br>比如dns服务器收到 www.163.com 解析请求 递归返回ns记录为 ns1.163.com 和ns2.163.com 但此时 ns1.163.com 网络不通。 此时dns服务器是一直等待？还是重试几次返回失败？还是其他？","like_count":3},{"had_liked":false,"id":35282,"user_name":"Geek_zz","can_delete":false,"product_type":"c1","uid":1130682,"ip_address":"","ucode":"A3AC7C2991B50D","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/ba/2c8af305.jpg","comment_is_top":false,"comment_ctime":1540509572,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10130444164","product_id":100007101,"comment_content":"dns 解析过程7步骤里有个错字，是权威，而不是权限","like_count":2},{"had_liked":false,"id":27576,"user_name":"何磊","can_delete":false,"product_type":"c1","uid":1047604,"ip_address":"","ucode":"78934C3ED4A342","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/34/c733b116.jpg","comment_is_top":false,"comment_ctime":1537922135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10127856727","product_id":100007101,"comment_content":"我对dns解析后，把所有IP都返回给客户端，由客户端负责轮训达到负载均衡表示不解。这里不应该是dns服务器返回一个随机IP，然后客户端直接访问即可吗？","like_count":2},{"had_liked":false,"id":13917,"user_name":"灰灰","can_delete":false,"product_type":"c1","uid":1122397,"ip_address":"","ucode":"907A2FD339E158","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/5d/69170b96.jpg","comment_is_top":false,"comment_ctime":1530064077,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10119998669","product_id":100007101,"comment_content":"写得太好了，刘超老师，你还有其他技术专栏吗？或者有其他推荐的技术专栏吗？","like_count":2},{"had_liked":false,"id":157975,"user_name":"饭粒","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1575291985,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5870259281","product_id":100007101,"comment_content":"今天刚看到的。<br>在过去 30 年里，美国利用先发优势，在根服务器治理体系中占据主导地位。在 IPv4（互联网协议第四版）体系内，全球被限制为总共 13 台根服务器，唯一主根部署在美国，其余 12 台辅根服务器有 9 台在美国，2 台在欧洲，1 台在日本——我们都是互联网的客人。","like_count":1},{"had_liked":false,"id":122851,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1565544457,"is_pvip":false,"replies":[{"id":"46317","content":"仅仅顶级的放不下，压力也太大","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566288042,"ip_address":"","comment_id":122851,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5860511753","product_id":100007101,"comment_content":"为什么本地dns不直接访问顶级dns","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462430,"discussion_content":"仅仅顶级的放不下，压力也太大","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566288042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113587,"avatar":"https://static001.geekbang.org/account/avatar/00/10/fd/f3/77223a8c.jpg","nickname":"清新灬小柠檬","note":"","ucode":"F3004F2F385096","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5045,"discussion_content":"效率问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565914838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121640,"user_name":"亮哥","can_delete":false,"product_type":"c1","uid":1037907,"ip_address":"","ucode":"336074EB84B7D2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d6/53/f5b4d2f0.jpg","comment_is_top":false,"comment_ctime":1565173041,"is_pvip":false,"replies":[{"id":"46344","content":"对的，就是云解析里面的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1566296490,"ip_address":"","comment_id":121640,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5860140337","product_id":100007101,"comment_content":"“在 yourcompany.com 的 DNS 服务器中，一般是通过配置 CNAME 的方式，给 object.yourcompany.com 起一个别”    请问一下老师这里说的DNS服务器是指域名解析里的配置吗？像阿里云买的域名里的：云解析DNS&#47;域名解析&#47;解析设置，记录类型选择CNAME，记录值是：object.vip.yourcomany.com，另外这个域名是第一层 GSLB的域名吗？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461889,"discussion_content":"对的，就是云解析里面的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566296490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018918,"avatar":"","nickname":"大宁","note":"","ucode":"F87C2C1F3C6D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587670,"discussion_content":"“另外这个域名是第一层 GSLB的域名吗？”\n\n我的理解：这个域名不是GLSB的域名，这个CNAME域名应该是解析成为CDN众多服务器地址的，还应该有一条ns记录将此CNAME域名指向给GLSB进行智能解析的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663213689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94211,"user_name":"dayspring","can_delete":false,"product_type":"c1","uid":1181357,"ip_address":"","ucode":"FAD33FF71D6BAF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wYPdGBibR1FJWWMzFzYBy4tNTd22rMgtlYTgR7wuicFLQjiaozuRWM2VSMFxPYjVdkLJLGvMav2icH3icgz07hmDsDw/132","comment_is_top":false,"comment_ctime":1557745891,"is_pvip":false,"replies":[{"id":"49370","content":"就像我们本地配置dns一样的。有负载均衡的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567651549,"ip_address":"","comment_id":94211,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5852713187","product_id":100007101,"comment_content":"老师，有一个问题请教一下本地dns，是怎么知道本地dns server的ip地址的？同理本地dns server是怎么知道根dns server的ip地址的？他们之间的访问有负载均衡吗？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449957,"discussion_content":"就像我们本地配置dns一样的。有负载均衡的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567651549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1593810,"avatar":"https://static001.geekbang.org/account/avatar/00/18/51/d2/dddffa12.jpg","nickname":"胸怀宇宙瓜皮李","note":"","ucode":"469FC3B32B279D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1910,"discussion_content":"1本地的通过DHCP协议获取 2不同的操作系统中的配置文件中内置记录了根服务器的ip地址，","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563089961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92734,"user_name":"ieo","can_delete":false,"product_type":"c1","uid":1138664,"ip_address":"","ucode":"FF313BE156E701","user_header":"https://static001.geekbang.org/account/avatar/00/11/5f/e8/94365887.jpg","comment_is_top":false,"comment_ctime":1557318115,"is_pvip":false,"replies":[{"id":"49421","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567660900,"ip_address":"","comment_id":92734,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5852285411","product_id":100007101,"comment_content":"刘老师，dns服务器请求权威dns后，怎么请求到全局负载均衡服务器的，这块没怎么看懂，是权威dns告诉本地dns的难道是全局负载均衡的ip吗？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449366,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567660900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79423,"user_name":"风中拾遗","can_delete":false,"product_type":"c1","uid":1122111,"ip_address":"","ucode":"C51CBB6454EDC3","user_header":"https://static001.geekbang.org/account/avatar/00/11/1f/3f/c9f7e73c.jpg","comment_is_top":false,"comment_ctime":1553481283,"is_pvip":false,"replies":[{"id":"50224","content":"是的，所以有ipv6呀","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567827216,"ip_address":"","comment_id":79423,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848448579","product_id":100007101,"comment_content":"老师，这个域名绑定的ip应该是公网的ip吧？不然会发生冲突，但如果是公网的ip，那个数就那么多，总有一天会不够用的。","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444496,"discussion_content":"是的，所以有ipv6呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61543,"user_name":"pana@","can_delete":false,"product_type":"c1","uid":1037236,"ip_address":"","ucode":"5447C925F22484","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d3/b4/bb883fc8.jpg","comment_is_top":false,"comment_ctime":1547719250,"is_pvip":false,"replies":[{"id":"25794","content":"通过别名到glsb，是可以解析域名的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551423344,"ip_address":"","comment_id":61543,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5842686546","product_id":100007101,"comment_content":"本地DNS服务器在请求object.vip.yourcompany.com这个域名时，是不是也要走一遍dns解析流程才能到gslb?gslb还能解析域名？应该只能根据域名通过某些策略返回IP吧?","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436907,"discussion_content":"通过别名到glsb，是可以解析域名的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551423344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43329,"user_name":"Marnie","can_delete":false,"product_type":"c1","uid":1001912,"ip_address":"","ucode":"ECF9B22574F868","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/b8/fb19aa6a.jpg","comment_is_top":false,"comment_ctime":1543215435,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5838182731","product_id":100007101,"comment_content":"DNS域名和IP是一对多的关系，一个域名，查找到多个IP地址，根据一定策略选择不同IP，从而实现负载均衡。高可用也与多IP有关，当一个IP有问题时，将其从DNS地址簿移除，本机可以访问其他IP.","like_count":1,"discussions":[{"author":{"id":1055092,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjUDIRQ0gRiciax3Wo78c5rVjuWDiaw4ibcCiby8xiaMXJh5ibjU5242vfCGOK4ehibe1IKyxex2A4IX4XSA/132","nickname":"追风者","note":"","ucode":"879BC372A6B605","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5993,"discussion_content":"多对多的关系","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566570079,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14777,"user_name":"wlh2119","can_delete":false,"product_type":"c1","uid":1042649,"ip_address":"","ucode":"BBB50A3BBEC730","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/d9/76efdd8d.jpg","comment_is_top":false,"comment_ctime":1530663040,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825630336","product_id":100007101,"comment_content":"刘老师的每一篇文章都认真的学习了，对上层HTTP到底层协议都有了更深的理解与认识，建立一个粗略而完整的协议框架。还要继续深入学习。谢谢。","like_count":1},{"had_liked":false,"id":14509,"user_name":"tony","can_delete":false,"product_type":"c1","uid":1120227,"ip_address":"","ucode":"470867EE3A87EF","user_header":"https://static001.geekbang.org/account/avatar/00/11/17/e3/37a68985.jpg","comment_is_top":false,"comment_ctime":1530499046,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825466342","product_id":100007101,"comment_content":"本地dns解析器是在客户端本机上面吗？","like_count":1},{"had_liked":false,"id":14418,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1530416400,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825383696","product_id":100007101,"comment_content":"全局负载均衡使用过程中，常常遇到失灵的情况，你知道具体有哪些情况吗？对应应该怎么来解决呢？<br>全局负载均衡失灵的时间，可以分情况来应对，<br>1，全局负载均衡器因为流量过大，而导致的失灵，<br>此情况，是因为流量已经超过了当前机器的极限所导致的，针对此只能通过扩容来解决。<br>2，全局负载均衡器因为机器故障了，导致的失灵。<br>此情况的发生，说明机器存在负载均衡器有单点问题，须通过增加备机，或者更为可靠的集群来解决。<br>3，全局负载均衡器因为网络故障，导致的失灵。<br>此情况，案例莫过于支付宝的光纤被挖掘机挖断，此问题可通过接入更多的线路来解决，<br><br><br>我能想到的只有这些，还请超哥来指证，谢谢","like_count":1},{"had_liked":false,"id":13919,"user_name":"羽毛","can_delete":false,"product_type":"c1","uid":1130940,"ip_address":"","ucode":"A99474C0E7D4AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/bc/13de31c5.jpg","comment_is_top":false,"comment_ctime":1530064465,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5825031761","product_id":100007101,"comment_content":"“我们希望不同运营商的客户，可以访问相同运营商机房中的资源”为什么不同运营商访问相同的运营商机房中的资源","like_count":1,"discussions":[{"author":{"id":1113587,"avatar":"https://static001.geekbang.org/account/avatar/00/10/fd/f3/77223a8c.jpg","nickname":"清新灬小柠檬","note":"","ucode":"F3004F2F385096","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5044,"discussion_content":"不同的运营商资源，也都是服务器提供服务。跟同一个服务器通讯，效率高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565914819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13914,"user_name":"Jobs","can_delete":false,"product_type":"c1","uid":1014824,"ip_address":"","ucode":"7745742129EDFC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/28/cb6d8768.jpg","comment_is_top":false,"comment_ctime":1530063428,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825030724","product_id":100007101,"comment_content":"1.防止单个地区或运营商的流量过爆而挂了。<br>2.服务器故障，网络故障如中间路由器故障，SLB设备故障，断电故障等。Solution:返回多重A记录？","like_count":1},{"had_liked":false,"id":354936,"user_name":"UDP少年","can_delete":false,"product_type":"c1","uid":2750281,"ip_address":"北京","ucode":"FBE89E9B818930","user_header":"https://static001.geekbang.org/account/avatar/00/29/f7/49/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1660895104,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660895104","product_id":100007101,"comment_content":"知识有限，回答不出精彩的内容，但学习的心态还是积极向上的，希望老师能给大家都分享下知识图谱","like_count":0},{"had_liked":false,"id":353790,"user_name":"王瑞强","can_delete":false,"product_type":"c1","uid":1829090,"ip_address":"北京","ucode":"DEE4EB5E23433F","user_header":"https://static001.geekbang.org/account/avatar/00/1b/e8/e2/2bcaef68.jpg","comment_is_top":false,"comment_ctime":1659781945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659781945","product_id":100007101,"comment_content":"rpc服务就近访问也是这个原理么","like_count":0},{"had_liked":false,"id":347518,"user_name":"浪客剑心","can_delete":false,"product_type":"c1","uid":2600745,"ip_address":"","ucode":"EDF7C17C8E316B","user_header":"https://static001.geekbang.org/account/avatar/00/27/af/29/3c27174a.jpg","comment_is_top":false,"comment_ctime":1654104848,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654104848","product_id":100007101,"comment_content":"请教，本地DNS解析器和本地DNS服务器的区别是什么？本地DNS解析器的“位置”是在本地主机上吗？","like_count":0},{"had_liked":false,"id":339888,"user_name":"Geek_ea3932","can_delete":false,"product_type":"c1","uid":1441416,"ip_address":"","ucode":"8012BDEF379ADB","user_header":"https://static001.geekbang.org/account/avatar/00/15/fe/88/9ad320e3.jpg","comment_is_top":false,"comment_ctime":1648452116,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1648452116","product_id":100007101,"comment_content":"关于根 DNS服务器，是不是每个国家自己都维护一个的呢？","like_count":0},{"had_liked":false,"id":336105,"user_name":"janey","can_delete":false,"product_type":"c1","uid":1227067,"ip_address":"","ucode":"0BD4BDB4EB2E94","user_header":"https://static001.geekbang.org/account/avatar/00/12/b9/3b/7224f3b8.jpg","comment_is_top":false,"comment_ctime":1645931165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645931165","product_id":100007101,"comment_content":"刘老师，通过这一课对dns的理解加深了负载均衡的部分。但是有个问题不太理解：<br>示例：DNS 访问数据中心中对象存储上的静态资源<br>这里看到有2个“本地DNS服务器”，理解的比较模糊，模糊的点如下：<br>1.这2个“本地DNS服务器”是一种类主从的关系还是地位等同的2个服务器？客户端在访问的时候按什么机制访问这2台服务器？是一定要在2台都查找过而不会只查一台，查询确认没有了才做后面的5，6，...这些步骤吗？<br>2.这2台“本地DNS服务器”是部署在哪里的呢？客户端的内网？客户端同主机还是啥？<br>可能在使用中没遇到过这样的场景，比较迷糊<br>希望能得到解答，感谢~","like_count":0},{"had_liked":false,"id":333071,"user_name":"张涛","can_delete":false,"product_type":"c1","uid":1015126,"ip_address":"","ucode":"D48C8C613F9C2F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/56/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1644045929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644045929","product_id":100007101,"comment_content":"有两个小细节不太准确，1. “每个数据中心三个可用区”这里，明白老师的意思，但说法不准确，可用区往上一层是Region而非数据中心；2.对象存储本身就是Region级别的概念，不需要再跨可用区部署了","like_count":0},{"had_liked":false,"id":319118,"user_name":"多选参数","can_delete":false,"product_type":"c1","uid":1248326,"ip_address":"","ucode":"B2294D80AB075F","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/46/dfe32cf4.jpg","comment_is_top":false,"comment_ctime":1635593855,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635593855","product_id":100007101,"comment_content":"引用原文“在 yourcompany.com 的 DNS 服务器中，一般是通过配置 CNAME 的方式，给 object.yourcompany.com 起一个别名，例如 object.vip.yourcomany.com，然后告诉本地 DNS 服务器，让它请求 GSLB 解析这个域名，GSLB 就可以在解析这个域名的过程中，通过自己的策略实现负载均衡。”<br>那么这里“让它请求 GSLB 解析这个域名”中的这个域名到底是 object.vip.yourcomany.com 这个域名还是，yourcomany.com 这个域名。","like_count":0},{"had_liked":false,"id":319117,"user_name":"多选参数","can_delete":false,"product_type":"c1","uid":1248326,"ip_address":"","ucode":"B2294D80AB075F","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/46/dfe32cf4.jpg","comment_is_top":false,"comment_ctime":1635593796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635593796","product_id":100007101,"comment_content":"引用原文“在 yourcompany.com 的 DNS 服务器中，一般是通过配置 CNAME 的方式，给 object.yourcompany.com 起一个别名，例如 object.vip.yourcomany.com，然后告诉本地 DNS 服务器，让它请求 GSLB 解析这个域名，GSLB 就可以在解析这个域名的过程中，通过自己的策略实现负载均衡。”","like_count":0},{"had_liked":false,"id":317756,"user_name":"蝴蝶","can_delete":false,"product_type":"c1","uid":1193167,"ip_address":"","ucode":"8019924D99182F","user_header":"https://static001.geekbang.org/account/avatar/00/12/34/cf/0a316b48.jpg","comment_is_top":false,"comment_ctime":1634946118,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1634946118","product_id":100007101,"comment_content":"地址相近但是运营商可能不同＞所以需要两层负载均衡","like_count":0},{"had_liked":false,"id":313082,"user_name":"iamjohnnyzhuang","can_delete":false,"product_type":"c1","uid":1015327,"ip_address":"","ucode":"E694C1828907F6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/1f/b1d458a9.jpg","comment_is_top":false,"comment_ctime":1632272969,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632272969","product_id":100007101,"comment_content":"1、全局负载均衡为什么要分地址和运营商呢？<br>给出链路最优的边缘节点。最典型的应用就是在 cdn 场景上， 比如我们在上海和新疆同时获取一个静态图片。 服务器可能只部署在上海，如果没走全局负载均衡都来我们这请求的话，新疆的由于地域问题（运营商可能也不一样）效果会很差。 然后我们会考虑接入 cdn 厂商， 在我们的权威服务器这里 cname 到 cdn 厂商给我们的域名， cdn 厂商做全局负载均衡，按照调度算法（通常就是 运营商+空间距离）匹配最优节点。<br><br><br>2、全局负载均衡使用过程中，常常遇到失灵的情况，你知道具体有哪些情况吗？对应应该怎么来解决呢？<br><br>这也算传统 cdn 的硬伤了， 因为这一切都依赖于本地 dns。 如果用户自己配置了 dns 地址，并且配置的 dns 服务器，区域、运营商都不一致，那么全局负载均衡则无法给出最优的调度。 有一种解决就是使用 httpdns","like_count":0},{"had_liked":false,"id":294410,"user_name":"程惠玲","can_delete":false,"product_type":"c1","uid":1085203,"ip_address":"","ucode":"EFBA7BA26408F0","user_header":"https://static001.geekbang.org/account/avatar/00/10/8f/13/50454a94.jpg","comment_is_top":false,"comment_ctime":1621931990,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621931990","product_id":100007101,"comment_content":"基于别名记录的负载均衡方，一个域名指向多个其他域名，CNAME肯定去全局负载均衡器获取吗，负载均衡策略在哪配置呢？","like_count":0},{"had_liked":false,"id":291596,"user_name":"℡ __ 柚稚","can_delete":false,"product_type":"c1","uid":1740282,"ip_address":"","ucode":"07A8CBFC563C5E","user_header":"https://static001.geekbang.org/account/avatar/00/1a/8d/fa/93e48f3b.jpg","comment_is_top":false,"comment_ctime":1620377863,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620377863","product_id":100007101,"comment_content":"dns本地都有缓存，那如果域名映射ip变化啦，怎么解决缓存一致性","like_count":0},{"had_liked":false,"id":267549,"user_name":"程序员班吉","can_delete":false,"product_type":"c1","uid":1478098,"ip_address":"","ucode":"BD48CF7649609A","user_header":"https://static001.geekbang.org/account/avatar/00/16/8d/d2/8a6be8d8.jpg","comment_is_top":false,"comment_ctime":1607825236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607825236","product_id":100007101,"comment_content":"第一个问题，假设不分地址和运营商的话，那么很有肯能北京的用户访问到了上海的IP，联通的用户被当做移动的用户，这样会导致用户访问了离自己比较远的资源。分地址和运营商的好处是，可以让用户访问到最近的资源，有更好的用户体验。<br>第二个问题，负载均衡失灵可能是是因为用户在上海访问了一个网页，然后立马飞到北京，此时如果用户再去访问之前的网站有可能使用的还是在上海访问时的dns本地缓存。","like_count":0},{"had_liked":false,"id":262897,"user_name":"依法治国","can_delete":false,"product_type":"c1","uid":1246948,"ip_address":"","ucode":"5D51FEB038FD27","user_header":"https://static001.geekbang.org/account/avatar/00/13/06/e4/9375269a.jpg","comment_is_top":false,"comment_ctime":1605873339,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605873339","product_id":100007101,"comment_content":"我觉得GSLB最大的一个问题是:原本的目的是实现数据中心的容灾切换，但是DNS默认有缓存机制，所以一个数据中心的某个AZ挂了，用户还是会根据缓存去访问一个挂掉的服务","like_count":0},{"had_liked":false,"id":257458,"user_name":"赵小通","can_delete":false,"product_type":"c1","uid":1047266,"ip_address":"","ucode":"C19D395C2E8BA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/e2/178bc954.jpg","comment_is_top":false,"comment_ctime":1603978267,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603978267","product_id":100007101,"comment_content":"老师本地DNS服务器是指运营商的吗？","like_count":0},{"had_liked":false,"id":257021,"user_name":"learner","can_delete":false,"product_type":"c1","uid":1877585,"ip_address":"","ucode":"CB1791E5161780","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/C1YjuX47p9whXQVvR7n39xQ0UHYaj1hx6QAd703ulKhuoJhg4ZHLU2qkcQdBPxNjtlztrKQYWibywV8pibmoVpag/132","comment_is_top":false,"comment_ctime":1603813542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603813542","product_id":100007101,"comment_content":"感觉举的DNS可以做内部负载均衡和全局负载均衡没有什么区别啊，都是轮询策略，都是部署多个，有什么区别吗？","like_count":0},{"had_liked":false,"id":251325,"user_name":"我相信指数爆炸","can_delete":false,"product_type":"c1","uid":2110864,"ip_address":"","ucode":"9EE4FBB92A82D3","user_header":"https://static001.geekbang.org/account/avatar/00/20/35/90/fdb1421e.jpg","comment_is_top":false,"comment_ctime":1601465425,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601465425","product_id":100007101,"comment_content":"需要补充 httpDNS","like_count":0},{"had_liked":false,"id":241548,"user_name":"罗樱罂","can_delete":false,"product_type":"c1","uid":2045997,"ip_address":"","ucode":"9072E79E625ED1","user_header":"https://static001.geekbang.org/account/avatar/00/1f/38/2d/f3c6493e.jpg","comment_is_top":false,"comment_ctime":1597332231,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597332231","product_id":100007101,"comment_content":"谢谢刘老师的课程。我想提一个小小的建议（这个应该是私信吧？）要是可以每个专有名词都标注英文名字就更好了。比如根dns（root dns）， 顶级dns （top level dns TLD）之类的。谢谢老师，老师辛苦了！","like_count":0},{"had_liked":false,"id":224885,"user_name":"徐海浪","can_delete":false,"product_type":"c1","uid":1078528,"ip_address":"","ucode":"21801C420D0610","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/00/618b20da.jpg","comment_is_top":false,"comment_ctime":1591583177,"is_pvip":false,"replies":[{"id":"83019","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591754395,"ip_address":"","comment_id":224885,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1591583177","product_id":100007101,"comment_content":"1 首先是就近访问，其次是避免跨运营商。<br>2 DNS解析有时效问题。","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497644,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591754395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224193,"user_name":"夕林语","can_delete":false,"product_type":"c1","uid":1264180,"ip_address":"","ucode":"B57681D0C73E1B","user_header":"https://static001.geekbang.org/account/avatar/00/13/4a/34/1faac99b.jpg","comment_is_top":false,"comment_ctime":1591316478,"is_pvip":false,"replies":[{"id":"83024","content":"是的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591754643,"ip_address":"","comment_id":224193,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1591316478","product_id":100007101,"comment_content":"思考题：<br>1.分地址和运营商是为了让用户有更快的访问速度和更好的体验<br>2.浏览器的缓存或者本地dns的缓存","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497395,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591754643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223780,"user_name":"shaukin","can_delete":false,"product_type":"c1","uid":1031685,"ip_address":"","ucode":"320D6BAF2406D7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/05/55b72986.jpg","comment_is_top":false,"comment_ctime":1591178773,"is_pvip":false,"replies":[{"id":"83028","content":"返回ip地址是常规场景，还可以转到glsb","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1591755085,"ip_address":"","comment_id":223780,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591178773","product_id":100007101,"comment_content":"从权威域名服务器返回给本地DNS服务器不是返回IP地址了吗，那怎么还要去返回GLSB实现负载均衡呢","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497237,"discussion_content":"返回ip地址是常规场景，还可以转到glsb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591755085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218399,"user_name":"儘管如此世界依然美麗","can_delete":false,"product_type":"c1","uid":1638731,"ip_address":"","ucode":"B831CF4CF2561A","user_header":"https://static001.geekbang.org/account/avatar/00/19/01/4b/a276c1d0.jpg","comment_is_top":false,"comment_ctime":1589796703,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589796703","product_id":100007101,"comment_content":"问题一：分运营商可以让相同运营商的用户访问的相同运营商机房中所对应的资源，减少时延<br>分地址可以让用户就近访问资源，同样也可以减少时延","like_count":0},{"had_liked":false,"id":214801,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1588821909,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588821909","product_id":100007101,"comment_content":"1.必然是分层的概念,首先利用不同的运营商进行了筛选和优化,然后利用地区,进行了最后的优化,提高到了不能再提高的部分<br>2.像是之前说的NAT网关,会在传递的时候进行变化,这就导致了可能在最后到达了GSLB的时候,运营商解析错误了","like_count":0},{"had_liked":false,"id":204052,"user_name":"柳十三","can_delete":false,"product_type":"c1","uid":1385852,"ip_address":"","ucode":"FE50C9778914C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tKvmZ3Vs4t6RZ3X7cAliaW47Zatxhn1aV5PcCYT9NZ9k9WWqRrEBGHicGtRWvsG6yQqHnaWw6cGNSbicNLjZebcHA/132","comment_is_top":false,"comment_ctime":1586325708,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586325708","product_id":100007101,"comment_content":"全局负载均衡分地址可能是就近原则，最近访问最快；分运营商可能是每个运营商速度不一样<br>全局负载均衡失灵猜测可能解析完换ip,解决思路冲原来ip跳转过去","like_count":0},{"had_liked":false,"id":193713,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1584952560,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584952560","product_id":100007101,"comment_content":"在平常的生活中上网，差不多都是属于域名去访问一些网站来获取所需的资源。而DNS就是互联网世界的地址簿，大大提升了大家上网的体验和便捷度，同时考虑到高可用和低延时等问题，DNS通过递归查询和缓存来提升查询的速度，另外也通过内部负载均衡和全局负载均衡来达到一样的目的。","like_count":0},{"had_liked":false,"id":190948,"user_name":"25ma","can_delete":false,"product_type":"c1","uid":1303713,"ip_address":"","ucode":"AB5435B9DB52C9","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/a1/178387da.jpg","comment_is_top":false,"comment_ctime":1584712419,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584712419","product_id":100007101,"comment_content":"老师，这个dns访问根服务器的时候是如何进行连接的，采用的协议是什么？","like_count":0},{"had_liked":false,"id":176120,"user_name":"倡印","can_delete":false,"product_type":"c1","uid":1455958,"ip_address":"","ucode":"4F53AA5D017D89","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/56/11068390.jpg","comment_is_top":false,"comment_ctime":1580962287,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580962287","product_id":100007101,"comment_content":"如果本地dns没有地址，就要访问根dns感觉好麻烦","like_count":0},{"had_liked":false,"id":148374,"user_name":"妥协","can_delete":false,"product_type":"c1","uid":1249656,"ip_address":"","ucode":"7201DFE9C12669","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/78/4f0cd172.jpg","comment_is_top":false,"comment_ctime":1572999945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572999945","product_id":100007101,"comment_content":"在域名解析的时候，我们只要配置策略，这次返回第一个 IP，下次返回第二个 IP，就可以实现负载均衡了。<br>如上所述，客户端第一次请求到IP后，会缓存本地，不会再第二次请求了。这个负载均衡策略是指不同客户端访问，返回不同的地址吗？<br>有讲到dns返回一个域名的多个地址，一个客户端自己轮训多个地址。<br>这两种方案都可以吗？","like_count":0},{"had_liked":false,"id":127153,"user_name":"追风者","can_delete":false,"product_type":"c1","uid":1055092,"ip_address":"","ucode":"879BC372A6B605","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIjUDIRQ0gRiciax3Wo78c5rVjuWDiaw4ibcCiby8xiaMXJh5ibjU5242vfCGOK4ehibe1IKyxex2A4IX4XSA/132","comment_is_top":false,"comment_ctime":1566570017,"is_pvip":false,"replies":[{"id":"48781","content":"com-&gt;xyz-&gt;abc-&gt;www","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567495972,"ip_address":"","comment_id":127153,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566570017","product_id":100007101,"comment_content":"当一个权限域名服务器还不能直接给出最后的查询结果时，就会告诉发出查询的DNS客户，下一步应当找哪一个权限域名服务器。<br>老师，应该如何理解这句话？一次DNS解析中，本地服务器会向权限域名服务器发送多次请求？我在书上看到说查询www.abc.xyz.com本地DNS会发送4次查询请求。困扰已久！","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464344,"discussion_content":"com-&amp;gt;xyz-&amp;gt;abc-&amp;gt;www","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567495972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111222,"user_name":"Ronnie","can_delete":false,"product_type":"c1","uid":1266726,"ip_address":"","ucode":"DD24A2981E59F2","user_header":"https://static001.geekbang.org/account/avatar/00/13/54/26/d3997877.jpg","comment_is_top":false,"comment_ctime":1562513846,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1562513846","product_id":100007101,"comment_content":"如果GSLB 是基于DNS protocol的话，那么它基于CNAME 配置的话，我感觉有点不对，是不是应该基于NS记录来配置的。<br><br>CNAME实现的GSLB 是现在很多cloud provider 提供的基于4&#47;7层协议的。","like_count":0,"discussions":[{"author":{"id":1018918,"avatar":"","nickname":"大宁","note":"","ucode":"F87C2C1F3C6D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587671,"discussion_content":"我也觉得需要配置ns记录","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663214208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104817,"user_name":"咸鱼与果汁","can_delete":false,"product_type":"c1","uid":1283861,"ip_address":"","ucode":"F79383599ACB02","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRyUPicEMqGsbsMicHPuvwM8nibfgK8Yt0AibAGUmnic7rLF4zUZ4dBj4ialYz54fOD6sURKwuJIWBNjhg/132","comment_is_top":false,"comment_ctime":1560847063,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560847063","product_id":100007101,"comment_content":"请问DNS域名IP印象变更，对应dns服务器是如何做数据同步的？","like_count":0},{"had_liked":false,"id":104100,"user_name":"Geek_04e22a","can_delete":false,"product_type":"c1","uid":1184505,"ip_address":"","ucode":"B64FF12EA28BA6","user_header":"https://static001.geekbang.org/account/avatar/00/12/12/f9/7e6e3ac6.jpg","comment_is_top":false,"comment_ctime":1560651870,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560651870","product_id":100007101,"comment_content":"DNS解析流程：本地缓存—本地DNS服务器—根服务器","like_count":0},{"had_liked":false,"id":102760,"user_name":"天王","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1560302451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560302451","product_id":100007101,"comment_content":"1 DNS协议，相当于地址簿，将域名转换成ip的协议，2 DNS服务器包括DNS缓存服务器和DNS服务器，DNS服务器包括根DNS服务器，顶级域名服务器，权威DNS服务器，树状结构 3 客户端请求的过程 客户端请求域名，3.1 访问www.163.com首先去DNS缓存服务器找，如果有，一般在网络服务商的某个机房，返回ip地址，没有继续往后找 3.2 去根域名服务器找，返回顶级域名的ip .com的ip，3.3 去顶级域名服务器找，返回权威域名服务器的ip 3.4 权威域名服务器返回www.163.com 的ip 4 DNS做负载均衡 给客户端都是域名，如果加减服务器，修改域名和ip的映射关系，客户端地址不需要修改，负载均衡能分流，轮询机制，将不同的请求依次轮询转发到不同的ip上。这是内部负载均衡。全局负载均衡，多个数据中心，一个数据中心挂了，剔除掉，另外各个地区访问各地的数据中心，提高访问速度。5 全局负载均衡器 GSLB全称 全局负载均衡器，一个数据中心可以设置多个可用区，可用区后面可以设置2个内部负载均衡器，后面接存储对象的前置服务器，GSLB一般是通过在权威DNS服务器配置一个别名，该别名去向GSLB请求，实现负载均衡，GSLB分2层，运营商和地域，不跨运营商访问可以提高吞吐量，减小时延 ，客户端请求的流程5.1 第一层CGLB通过请求查看本地dns服务器所在的运营商，确定运营商， 通过cname找到别名，去找第2层的GSLB 5.2第二层的CGLB通过请求的本地DNS服务器找到用户的地理位置，找到距离用户比较近的数据中心，数据中心内部通过内部的负载均衡器，返回内部的多个负责均衡器的地址<br>5.3 本地DSN服务器拿到地址之后，返回到本地DNS解析器，本地DNS解析器缓存之后，返回给客户端 5.4 客户端拿到6个ip之后，随机或者轮询进行访问 。","like_count":0},{"had_liked":false,"id":101141,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1559726169,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559726169","product_id":100007101,"comment_content":"缓存DNS缓存-&gt;根DNS服务器--&gt;顶级域DNS服务器（.com&#47;.cn.net 等）--&gt;权威DNS服务器","like_count":0},{"had_liked":false,"id":87702,"user_name":"陈耀","can_delete":false,"product_type":"c1","uid":1352301,"ip_address":"","ucode":"5F179E4E0C5B78","user_header":"","comment_is_top":false,"comment_ctime":1555664787,"is_pvip":false,"replies":[{"id":"49591","content":"你说的对，但是和我说的一样呀","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567690671,"ip_address":"","comment_id":87702,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555664787","product_id":100007101,"comment_content":"关于客户端的dns的查询有部分是错误的，浏览器到本地dns（甚至运营商dns）使用的是递归查询，而向根域服务器、顶级域服务器、权威域服务器 使用的是迭代查询。","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447569,"discussion_content":"你说的对，但是和我说的一样呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567690671,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82765,"user_name":"且听疯吟","can_delete":false,"product_type":"c1","uid":1159459,"ip_address":"","ucode":"B010B16E5465F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/b1/23/5df1f341.jpg","comment_is_top":false,"comment_ctime":1554302276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554302276","product_id":100007101,"comment_content":"2.全局负载策略失败的原因：<br>1.负载均衡策略失效，比如某个时间段或者某个地区发生了DNS网络攻击直接会导致负载均衡策略失效。<br>2.区域的问题会造成实际的负载均衡出现问题，举个例子，比如淘宝双11活动，不发达城市的区域实际上访问量较小，服务器基本上轻松无压力，但是发达地区由于人员访问连接过大，但是负载均衡仍然是优先指定本地的服务器，这时会造成发达地区的服务器负载压力非常大，但是人员稀少的区域服务器时间上还有非常大的服务空间。实际的负载均衡策略这时应该需要按需进行调整。","like_count":0},{"had_liked":false,"id":82762,"user_name":"且听疯吟","can_delete":false,"product_type":"c1","uid":1159459,"ip_address":"","ucode":"B010B16E5465F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/b1/23/5df1f341.jpg","comment_is_top":false,"comment_ctime":1554301649,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554301649","product_id":100007101,"comment_content":"1、实际使用过程中不同的运营商的连接速度 与 带宽的问题需要考虑负载均衡。比如实际使用过程中运营商A 租用了100M的带宽，运营商B租用了200M的带宽，运营商C租用了300M的带宽，这时的负载均衡按照1:2:3的比例来均衡，再次考虑到不同运营商之间出入口速率的问题，比如客户端要访问的地址经过查看和比对发现该地址的服务器属于运营商A的，则这时需要尽量将该报文送往运营商A的出口，防止跨运营商访问。","like_count":0},{"had_liked":false,"id":75600,"user_name":"Zoe","can_delete":false,"product_type":"c1","uid":1158609,"ip_address":"","ucode":"4B309FAD20EEAC","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/d1/62376eff.jpg","comment_is_top":false,"comment_ctime":1552439120,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552439120","product_id":100007101,"comment_content":"老师，如果遇到dns网络劫持了怎么解决。","like_count":0},{"had_liked":false,"id":71794,"user_name":"X","can_delete":false,"product_type":"c1","uid":1102065,"ip_address":"","ucode":"B5CA13435613D8","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/f1/432e0476.jpg","comment_is_top":false,"comment_ctime":1551434017,"is_pvip":false,"replies":[{"id":"50284","content":"是不是还配置了别的dns server，那个先超时了。","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567839297,"ip_address":"","comment_id":71794,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1551434017","product_id":100007101,"comment_content":"xxxx could not be resolved (110: Operation timed out)<br>我在一个项目中要使用http协议去请求其他N个域名，每次请求都会有DNS解析这一步。刚开始时，DNS解析正常，没有超时，但是过一会，DNS解析超时越来越多。单独拿出服务中解析超时的域名，使用linux命令dig，全部正常，ping，也全部正常。我的nginx.conf配置中，resolver_timeout 60s（默认30s）,resolver 8.8.8.8。请问是哪里的问题？我需要怎么去排查？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441334,"discussion_content":"是不是还配置了别的dns server，那个先超时了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567839297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102065,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d0/f1/432e0476.jpg","nickname":"X","note":"","ucode":"B5CA13435613D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12379,"discussion_content":"谢谢您，应该是域名解析服务器的限制，我使用了本地dns缓存dnsmasq之后就好使了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568525934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71234,"user_name":"挖下水道的","can_delete":false,"product_type":"c1","uid":1219177,"ip_address":"","ucode":"D3744B7ED1D891","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/69/d86bafe1.jpg","comment_is_top":false,"comment_ctime":1551302698,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1551302698","product_id":100007101,"comment_content":"DNS污染的问题应该讲一讲","like_count":0,"discussions":[{"author":{"id":2976412,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/6a/9c/de8f9280.jpg","nickname":"刚毅坚卓","note":"","ucode":"6D16E587400F6F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571470,"discussion_content":"这可不能说","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652236504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014146,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/79/82/c3cccc38.jpg","nickname":"IT生涯路漫漫","note":"","ucode":"4954D1CBEB4E44","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325211,"discussion_content":"讲了的话老师就要被请去喝茶了🐶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605252740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70008,"user_name":"何用","can_delete":false,"product_type":"c1","uid":1377393,"ip_address":"","ucode":"B0C6E8176AE6FD","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/71/0b949a4c.jpg","comment_is_top":false,"comment_ctime":1550934286,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550934286","product_id":100007101,"comment_content":"为何根域名服务器只有13套？","like_count":0},{"had_liked":false,"id":68713,"user_name":"哈哈","can_delete":false,"product_type":"c1","uid":1142044,"ip_address":"","ucode":"F4673CC2238BAE","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/1c/10d5c280.jpg","comment_is_top":false,"comment_ctime":1550584207,"is_pvip":false,"replies":[{"id":"50302","content":"不是，只有权威之下才是gslb。","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567840438,"ip_address":"","comment_id":68713,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550584207","product_id":100007101,"comment_content":"有个问题想问下，如果权威域名服务器没有分多个运营商的话，从权威域名服务器dns解析到gslb过程的不是会很慢么？ 还是说从根开始每个都是gslb这种模式，或者还是权威域名服务器都部署在主干网所以很快","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439810,"discussion_content":"不是，只有权威之下才是gslb。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567840438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65826,"user_name":"菜菜","can_delete":false,"product_type":"c1","uid":1243536,"ip_address":"","ucode":"888AC33663B774","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/90/f90903e5.jpg","comment_is_top":false,"comment_ctime":1549689171,"is_pvip":false,"replies":[{"id":"25965","content":"如果要做负载均衡，就需要六个tcp","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551438761,"ip_address":"","comment_id":65826,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1549689171","product_id":100007101,"comment_content":"老师，通过负载均衡，客户端拿到假如说6和ip，通过轮询的话，如果是tcp连接的话，每次都要新建一个tcp连接吗？这样会不会又增加负担……","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438603,"discussion_content":"如果要做负载均衡，就需要六个tcp","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551438761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1655725,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","nickname":"雷刚","note":"","ucode":"115FE2BE1AAB61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227383,"discussion_content":"负载均衡算法除了轮询、随机，还有一致性哈希就是为了解决这个问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586487180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64721,"user_name":"&#47;  _在路上。","can_delete":false,"product_type":"c1","uid":1315654,"ip_address":"","ucode":"C619DB0351C3BA","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/46/f678d54f.jpg","comment_is_top":false,"comment_ctime":1548890737,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548890737","product_id":100007101,"comment_content":"老师能不能讲一下子域未授权的问题，例如在政府网中总部和省级的关系，省级二级域上配了一个独有的子域转发，按理在省内请求该子域应由省级域直接相应请求，但是为何响应会返回为空，此场景的dns请求过程是怎样的？","like_count":0},{"had_liked":false,"id":53631,"user_name":"不纯有机物","can_delete":false,"product_type":"c1","uid":1135358,"ip_address":"","ucode":"430C0C2873B591","user_header":"https://static001.geekbang.org/account/avatar/00/11/52/fe/df362d52.jpg","comment_is_top":false,"comment_ctime":1545702735,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545702735","product_id":100007101,"comment_content":"老师您好，我在网上搜索的结果是dns解析顺序先是本地dns缓存&gt;hosts文件&gt;dns服务器，但是我看您在评论里说的是hosts文件在本地dns缓存之前","like_count":0},{"had_liked":false,"id":53556,"user_name":"空知","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1545671666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545671666","product_id":100007101,"comment_content":"打卡,滴滴,看一半了！","like_count":0},{"had_liked":false,"id":52240,"user_name":"yifan.L","can_delete":false,"product_type":"c1","uid":1345730,"ip_address":"","ucode":"4915E8B3BD4C42","user_header":"https://static001.geekbang.org/account/avatar/00/14/88/c2/c8159ba7.jpg","comment_is_top":false,"comment_ctime":1545353897,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545353897","product_id":100007101,"comment_content":"老师，最近在接触负载均衡，能否分享一些关于负载均衡的知识点。","like_count":0},{"had_liked":false,"id":49879,"user_name":"狗蛋儿","can_delete":false,"product_type":"c1","uid":1072546,"ip_address":"","ucode":"22005A177034C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/5d/a2/c6fb8fb8.jpg","comment_is_top":false,"comment_ctime":1544783987,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544783987","product_id":100007101,"comment_content":"您好 两层GLSB的例子中 第四步“本地 DNS 解析器将结果缓存后，返回给客户端。” 本地DNS解析器会把6个IP都返回给客户端？还有下次访问同样域名时候，假设客户端缓存失败，本地DNS解析器缓存，也是返回6个IP吗？","like_count":0},{"had_liked":false,"id":44063,"user_name":"MJ","can_delete":false,"product_type":"c1","uid":1237145,"ip_address":"","ucode":"FCEC0C21444D2A","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/99/5d603697.jpg","comment_is_top":false,"comment_ctime":1543367003,"is_pvip":false,"replies":[{"id":"15731","content":"在dns服务器上可以配置别名","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1543372582,"ip_address":"","comment_id":44063,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543367003","product_id":100007101,"comment_content":"本地DNS服务器访问GLSB的时候，如何做到把原域名改为别名来访问呢？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430618,"discussion_content":"在dns服务器上可以配置别名","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543372582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41816,"user_name":"西部世界","can_delete":false,"product_type":"c1","uid":1142397,"ip_address":"","ucode":"2EA57A75273EBD","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/7d/370b0d4c.jpg","comment_is_top":false,"comment_ctime":1542854628,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542854628","product_id":100007101,"comment_content":"分运营商是因为，跨运营商访问速度相当慢，分地区当然是选择就近机房下的运营商响应更快。","like_count":0},{"had_liked":false,"id":37044,"user_name":"扬～","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1541431136,"is_pvip":false,"replies":[{"id":"13285","content":"可以透明，比如客户端是一个普通应用，也可以在客户端做，例如对象存储的sdk，需要做一些自己的决策","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1541470831,"ip_address":"","comment_id":37044,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541431136","product_id":100007101,"comment_content":"疑问，为什么要把6个proxy的IP都发给客户端呢?这样不会侵入代码吗，这不应该是服务端的责任吗，不需要对客户端透明吗?","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428138,"discussion_content":"可以透明，比如客户端是一个普通应用，也可以在客户端做，例如对象存储的sdk，需要做一些自己的决策","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541470831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35321,"user_name":"茫农","can_delete":false,"product_type":"c1","uid":1206365,"ip_address":"","ucode":"71F7143644C9CB","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/5d/1ccee378.jpg","comment_is_top":false,"comment_ctime":1540517004,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540517004","product_id":100007101,"comment_content":"感觉域名和ip有点像ip和mac，","like_count":0},{"had_liked":false,"id":34931,"user_name":"lewis","can_delete":false,"product_type":"c1","uid":1228695,"ip_address":"","ucode":"79CFB9D89310A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/bf/97/14626661.jpg","comment_is_top":false,"comment_ctime":1540359469,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540359469","product_id":100007101,"comment_content":"分运营商，不同的运营商切换需要的链路更长。假设用户在移动，切换到联通的过程:首先数据包到达移动的服务器节点，再由移动节点转发到联通节点？这个理解对吗？","like_count":0},{"had_liked":false,"id":33836,"user_name":"Tom","can_delete":false,"product_type":"c1","uid":1109832,"ip_address":"","ucode":"00EEDE4CB11776","user_header":"","comment_is_top":false,"comment_ctime":1539909013,"is_pvip":false,"replies":[{"id":"12134","content":"不是本地局域网","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1539919550,"ip_address":"","comment_id":33836,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539909013","product_id":100007101,"comment_content":"本地DNS不是本地局域网的吧？本机io配置中的DNS就是本地局域网吧？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427062,"discussion_content":"不是本地局域网","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539919550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32050,"user_name":"搬铁少年ai","can_delete":false,"product_type":"c1","uid":1031045,"ip_address":"","ucode":"01D4A830A088D7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/85/191eea69.jpg","comment_is_top":false,"comment_ctime":1539395788,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539395788","product_id":100007101,"comment_content":"一般来讲，公司内部组网的客户端并不会配置dns服务器的地址，因为网络变化可能导致ip地址的变动，即使有dhcp分配dns服务器地址。取而代之的是，在中间设备，比如接入路由器，防火墙等设备上配置dns代理，而客户端的dns server地址指向dns代理的地址，由dns代理负责转发dns请求报文到服务器，同时，dns代理可以在本地维护缓存表，提高查询效率，减少发到服务器的查询报文，降低服务器压力。另外，还可以在网络设备上配置dns欺骗，用于用户认证的重定向等","like_count":0},{"had_liked":false,"id":26508,"user_name":"逍遥夏末","can_delete":false,"product_type":"c1","uid":1239455,"ip_address":"","ucode":"C256EE7C9284C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJJdibLfaPjOqvgdRSn11JhwdqaI2KiaUdkeA9cwQ5btpnFX00V0rpFXlksKfBtaArprs7DN2ybFug/132","comment_is_top":false,"comment_ctime":1537626305,"is_pvip":false,"replies":[{"id":"9823","content":"使用别名","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1537863770,"ip_address":"","comment_id":26508,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1537626305","product_id":100007101,"comment_content":"刘老师，dns服务器是由运营商维护吗，也就是服务器所有者维护，GSLB是由我们需要访问的网址服务器维护吗，比如访问163.com，是不是网易给运营商一个规则，说来访问我的服务器都给我指定到我的GSLB服务器上来，我自己做全局负载均衡，我来返回用户最优访问的ip。请刘老师指正。","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424653,"discussion_content":"使用别名","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537863770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26450,"user_name":"江龍","can_delete":false,"product_type":"c1","uid":1070762,"ip_address":"","ucode":"925C7BDFAD8DA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/aa/6c60f057.jpg","comment_is_top":false,"comment_ctime":1537606473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537606473","product_id":100007101,"comment_content":"负载均衡方式有好多种，可以专门写一个专题文章，比如nginx单向代理，dns方式，在数据链路层做，在ip层做都可以","like_count":0},{"had_liked":false,"id":23989,"user_name":"杨春鹏","can_delete":false,"product_type":"c1","uid":1172056,"ip_address":"","ucode":"518F38232F97B5","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/58/8c8897c8.jpg","comment_is_top":false,"comment_ctime":1536742184,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536742184","product_id":100007101,"comment_content":"当访问网站的时候，是先去访问host文件还是，本地DNS缓存？","like_count":0},{"had_liked":false,"id":22172,"user_name":"Windshell","can_delete":false,"product_type":"c1","uid":1202986,"ip_address":"","ucode":"8F0F5BE418C8D8","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/2a/a6628985.jpg","comment_is_top":false,"comment_ctime":1535525218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535525218","product_id":100007101,"comment_content":"刘老师能不能再仔细讲下DNS类型，例如A，CNAME等","like_count":0},{"had_liked":false,"id":21417,"user_name":"黄加菜","can_delete":false,"product_type":"c1","uid":1005203,"ip_address":"","ucode":"66D44AA0A12C27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/93/fb3a6e19.jpg","comment_is_top":false,"comment_ctime":1535074825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535074825","product_id":100007101,"comment_content":"理解的还不够透彻，还需多看几遍。","like_count":0},{"had_liked":false,"id":19574,"user_name":"凯子哥","can_delete":false,"product_type":"c1","uid":1130501,"ip_address":"","ucode":"D01F0BD04A0F42","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/05/749bafae.jpg","comment_is_top":false,"comment_ctime":1533886484,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533886484","product_id":100007101,"comment_content":"讲的挺好，思路清晰","like_count":0},{"had_liked":false,"id":19148,"user_name":"芋头","can_delete":false,"product_type":"c1","uid":1070287,"ip_address":"","ucode":"390438CFF71F0A","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/cf/fddcf843.jpg","comment_is_top":false,"comment_ctime":1533691054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533691054","product_id":100007101,"comment_content":"老师，有一个问题不明白，IP是缓存在DNS上的，那域名对应的IP改变了，岂不是访问不到了？","like_count":0},{"had_liked":false,"id":19007,"user_name":"飞","can_delete":false,"product_type":"c1","uid":1143190,"ip_address":"","ucode":"CCFBF48965B415","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/96/66ad1cd2.jpg","comment_is_top":false,"comment_ctime":1533640443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533640443","product_id":100007101,"comment_content":"本地配置一个假的，难怪也解析呢，原来先从自己本地缓存开始解析","like_count":0},{"had_liked":false,"id":17234,"user_name":"Jaime","can_delete":false,"product_type":"c1","uid":1078333,"ip_address":"","ucode":"904192CC4E916F","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/3d/54bbc1df.jpg","comment_is_top":false,"comment_ctime":1532515677,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1532515677","product_id":100007101,"comment_content":"问题一，分区域，分运营商是因为要有更好的用户体验，减少响应时间和增加吞吐量。<br>问题二，对全局负载均衡还不是很理解，等理解了在回来回答","like_count":0},{"had_liked":false,"id":16863,"user_name":"snowqiang","can_delete":false,"product_type":"c1","uid":1177180,"ip_address":"","ucode":"FBF2D3C1886FF4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IM2JvRB8ibNWib6gc3Wr2QPPX1DxwVerxbvdJHRQ1a4n3WQfoQdfqjda9ib8ylbWP4IX63thsj0ApxLcePGHeiaEIw/132","comment_is_top":false,"comment_ctime":1532263242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532263242","product_id":100007101,"comment_content":"服务端的IP更换了，或者部署新机器了应该会有影响","like_count":0},{"had_liked":false,"id":15786,"user_name":"破晓","can_delete":false,"product_type":"c1","uid":1153316,"ip_address":"","ucode":"13C33DE0CFD43B","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/24/e1cb609e.jpg","comment_is_top":false,"comment_ctime":1531489165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531489165","product_id":100007101,"comment_content":"问题1，跨网络运营商访问慢。<br>问题2，网络运营商有自己的dns缓存服务器，导致全局失效。","like_count":0},{"had_liked":false,"id":15660,"user_name":"coderliang","can_delete":false,"product_type":"c1","uid":1003016,"ip_address":"","ucode":"0C3EC272B9E40E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/08/d497c158.jpg","comment_is_top":false,"comment_ctime":1531362495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531362495","product_id":100007101,"comment_content":"请教一个问题，个人网站，大陆和国外如何做全局负载均衡。国外有一台服务器，国内有一台服务器。能不能给指一个方案，或者方向？感谢！","like_count":0},{"had_liked":false,"id":15182,"user_name":"米兰的小铁匠","can_delete":false,"product_type":"c1","uid":1024303,"ip_address":"","ucode":"5CCE3C8AE4FDC2","user_header":"","comment_is_top":false,"comment_ctime":1530962501,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530962501","product_id":100007101,"comment_content":"负载均衡分地区好理解，就近访问，速度肯定快；<br>分运营商可能是兼容性问题，以及不同运营商在不同地区的带宽，资源不一样","like_count":0},{"had_liked":false,"id":14661,"user_name":"zcpromising","can_delete":false,"product_type":"c1","uid":1131966,"ip_address":"","ucode":"4F29D98A436D09","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/be/494010aa.jpg","comment_is_top":false,"comment_ctime":1530587006,"is_pvip":false,"replies":[{"id":"4914","content":"讲了呀","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1530610169,"ip_address":"","comment_id":14661,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1530587006","product_id":100007101,"comment_content":"老师，dns解析为啥没讲迭代解析呢","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420080,"discussion_content":"讲了呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530610169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14528,"user_name":"Cloud","can_delete":false,"product_type":"c1","uid":1147061,"ip_address":"","ucode":"86B1C459EC9F82","user_header":"https://static001.geekbang.org/account/avatar/00/11/80/b5/f59d92f1.jpg","comment_is_top":false,"comment_ctime":1530512915,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530512915","product_id":100007101,"comment_content":"运营商之间切换，会有网络抖动<br>机器故障，网络故障，负载过高","like_count":0},{"had_liked":false,"id":14501,"user_name":"tony","can_delete":false,"product_type":"c1","uid":1120227,"ip_address":"","ucode":"470867EE3A87EF","user_header":"https://static001.geekbang.org/account/avatar/00/11/17/e3/37a68985.jpg","comment_is_top":false,"comment_ctime":1530497151,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530497151","product_id":100007101,"comment_content":"请问本地解析器是在本机，还是在运营商服务器↑？谢谢","like_count":0},{"had_liked":false,"id":14456,"user_name":"孙悟空","can_delete":false,"product_type":"c1","uid":1055660,"ip_address":"","ucode":"28356CBC83C464","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/ac/41ec8c80.jpg","comment_is_top":false,"comment_ctime":1530452110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530452110","product_id":100007101,"comment_content":"1. 为了低时延以及减少跨运营商的带宽和费用<br>2.后端ip变化，后端故障","like_count":0},{"had_liked":false,"id":14431,"user_name":"泊浮目","can_delete":false,"product_type":"c1","uid":1067981,"ip_address":"","ucode":"182A7CC2F6BDAB","user_header":"https://static001.geekbang.org/account/avatar/00/10/4b/cd/185e5378.jpg","comment_is_top":false,"comment_ctime":1530429442,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530429442","product_id":100007101,"comment_content":"问题1我想是因为不同的运营商通信成本会上去吧，就像不同的地区一样，要多走几次路由。<br><br>问题2暂时能想到的问题是因为流量过大导致机器宕机，解决方案是加机器做高可用集群或者使用限流算法。","like_count":0},{"had_liked":false,"id":14417,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1530416383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530416383","product_id":100007101,"comment_content":"全局负载均衡使用过程中，常常遇到失灵的情况，你知道具体有哪些情况吗？对应应该怎么来解决呢？<br>全局负载均衡失灵的时间，可以分情况来应对，<br>1，全局负载均衡器因为流量过大，而导致的失灵，<br>此情况，是因为流量已经超过了当前机器的极限所导致的，针对此只能通过扩容来解决。<br>2，全局负载均衡器因为机器故障了，导致的失灵。<br>此情况的发生，说明机器存在负载均衡器有单点问题，须通过增加备机，或者更为可靠的集群来解决。<br>3，全局负载均衡器因为网络故障，导致的失灵。<br>此情况，案例莫过于支付宝的光纤被挖掘机挖断，此问题可通过接入更多的线路来解决，<br><br><br>我能想到的只有这些，还请超哥来指证，谢谢","like_count":0},{"had_liked":false,"id":14416,"user_name":"wykkx","can_delete":false,"product_type":"c1","uid":1122358,"ip_address":"","ucode":"ABCDF49E7A95C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/20/36/b3e2f1d5.jpg","comment_is_top":false,"comment_ctime":1530416310,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530416310","product_id":100007101,"comment_content":"第一问题是为了让用户就近访问和使用和自己运营商一样的线路访问，提升用户体验。<br>第二个问题，有几个可能原因一是dns没有配置健康检查机制，后端服务ip已经挂了或者更换了。二是受到了类似ddos攻击，超过了dns服务的解析能力。<br>对于第一类问题，需要增加dns健康检查。对于第二类需要增加dns的安全模块。<br>求老师的知识图谱，多谢！","like_count":0},{"had_liked":false,"id":14389,"user_name":"徐良红","can_delete":false,"product_type":"c1","uid":1131408,"ip_address":"","ucode":"830C7007B104BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/43/90/167a13fa.jpg","comment_is_top":false,"comment_ctime":1530362582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530362582","product_id":100007101,"comment_content":"第二种情况是不是用户设置了通用dns例如谷歌的，这样就无从判断是哪个运营商来的，失灵了","like_count":0},{"had_liked":false,"id":14388,"user_name":"徐良红","can_delete":false,"product_type":"c1","uid":1131408,"ip_address":"","ucode":"830C7007B104BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/43/90/167a13fa.jpg","comment_is_top":false,"comment_ctime":1530361581,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530361581","product_id":100007101,"comment_content":"问题1的原因主要是运营商之间互联互通不畅","like_count":0},{"had_liked":false,"id":14197,"user_name":"张洪阆","can_delete":false,"product_type":"c1","uid":1001954,"ip_address":"","ucode":"CFF7035D0DF059","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/e2/1fad12eb.jpg","comment_is_top":false,"comment_ctime":1530232546,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530232546","product_id":100007101,"comment_content":"1.按地址和运营商划分考虑的是距离和带宽<br>2.不清楚","like_count":0},{"had_liked":false,"id":14159,"user_name":"feifei","can_delete":false,"product_type":"c1","uid":1105431,"ip_address":"","ucode":"B1F8AE3AD82C51","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/17/75e2b624.jpg","comment_is_top":false,"comment_ctime":1530197862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530197862","product_id":100007101,"comment_content":"全局负载均衡为什么要分地址和运营商呢？ <br>全局负载均衡GSLB，实现在广域网(包括互联网)上不同地域的服务器间的流量调配，保证使用最佳的服务器服务离自己最近的客户，从而确保访问质量。<br>分地址，我觉得是为了保证高可用，防止单点故障。<br>分运营商，这个我觉得可能就是中国特色了，用一句最调侃的话，世界上最远的距离，莫过于你的电信，我在联通。<br><br><br>全局负载均衡使用过程中，常常遇到失灵的情况，你知道具体有哪些情况吗？对应应该怎么来解决呢？<br>全局负载均衡失灵的时间，可以分情况来应对，<br>1，全局负载均衡器因为流量过大，而导致的失灵，<br>此情况，是因为流量已经超过了当前机器的极限所导致的，针对此只能通过扩容来解决。<br>2，全局负载均衡器因为机器故障了，导致的失灵。<br>此情况的发生，说明机器存在负载均衡器有单点问题，须通过增加备机，或者更为可靠的集群来解决。<br>3，全局负载均衡器因为网络故障，导致的失灵。<br>此情况，案例莫过于支付宝的光纤被挖掘机挖断，此问题可通过接入更多的线路来解决，<br><br><br>我能想到的只有这些，还请超哥来指证，谢谢","like_count":0},{"had_liked":false,"id":14145,"user_name":"凡凡","can_delete":false,"product_type":"c1","uid":1056142,"ip_address":"","ucode":"134C1E1E6B22BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/8e/0a546871.jpg","comment_is_top":false,"comment_ctime":1530194298,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530194298","product_id":100007101,"comment_content":"1.分地址和运营商都是为了就近服务，较少中间网络延时和不确定，不稳定性，提升访问性能。2.失灵情况猜测是不是由于ip到区域的映射不是总那么准确，或者说精度太低，一般只能定位到省级？","like_count":0},{"had_liked":false,"id":14134,"user_name":"方圆佰李","can_delete":false,"product_type":"c1","uid":1053200,"ip_address":"","ucode":"6A0599C953F564","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIWSTcia43udFKpGW0YT4zDJpO7LqkCicmTIgiaFcfszibGDkjfSSwqQ7pIMQl1Mhxc8PsdLS1UrnsrRA/132","comment_is_top":false,"comment_ctime":1530190062,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530190062","product_id":100007101,"comment_content":"一个网站下的每个页面都有地址，这些地址都有对应IP吗？","like_count":0},{"had_liked":false,"id":14103,"user_name":"李梦游","can_delete":false,"product_type":"c1","uid":1140409,"ip_address":"","ucode":"38C9F2C6F604A8","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/b9/673f42c0.jpg","comment_is_top":false,"comment_ctime":1530175008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530175008","product_id":100007101,"comment_content":"负载均衡失灵的问题可能是IP地址失效或更换之类的吧","like_count":0},{"had_liked":false,"id":14024,"user_name":"唐唐","can_delete":false,"product_type":"c1","uid":1029186,"ip_address":"","ucode":"52876E04BB3A9F","user_header":"","comment_is_top":false,"comment_ctime":1530146325,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530146325","product_id":100007101,"comment_content":"刘老师，文中的本地DNS的缓存，是指用户所在的网络服务器地址上的host文件吧，用户自己的host配置了某些域名，ip对应关系的话，会直接用吗？","like_count":0},{"had_liked":false,"id":14012,"user_name":"赵艳飞","can_delete":false,"product_type":"c1","uid":1138252,"ip_address":"","ucode":"4F0911C8F91135","user_header":"https://static001.geekbang.org/account/avatar/00/11/5e/4c/f87a9b60.jpg","comment_is_top":false,"comment_ctime":1530143176,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530143176","product_id":100007101,"comment_content":"小白一枚，只能听懂面上的东西～希望可以多学点东西","like_count":0},{"had_liked":false,"id":14009,"user_name":"刘宝明","can_delete":false,"product_type":"c1","uid":1137942,"ip_address":"","ucode":"7065F40ED07463","user_header":"https://static001.geekbang.org/account/avatar/00/11/5d/16/9a57266b.jpg","comment_is_top":false,"comment_ctime":1530115674,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530115674","product_id":100007101,"comment_content":"老师，讲一下公司内网的请求数据包是怎么发到公网的，响应数据包又是怎么返回到局域网的","like_count":0},{"had_liked":false,"id":14002,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1530112684,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530112684","product_id":100007101,"comment_content":"1.跨运营商访问慢","like_count":0},{"had_liked":false,"id":13918,"user_name":"进化论","can_delete":false,"product_type":"c1","uid":1124107,"ip_address":"","ucode":"2865A23392B9F9","user_header":"https://static001.geekbang.org/account/avatar/00/11/27/0b/12dee5ed.jpg","comment_is_top":false,"comment_ctime":1530064318,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530064318","product_id":100007101,"comment_content":"分运营商，是不是解决跨运营商访问慢的问题啊！<br><br>第二个是因为有缓存？","like_count":0},{"had_liked":false,"id":13913,"user_name":"浪子恒心","can_delete":false,"product_type":"c1","uid":1008441,"ip_address":"","ucode":"2A5DCD25895E8F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/39/486faadf.jpg","comment_is_top":false,"comment_ctime":1530063395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530063395","product_id":100007101,"comment_content":"还是没太想明白为什么分了两层全局负载，一层负载不能全解决吗？全局负载一般在用户配置了公共DNS服务时会失效吧，通过HTTPDNS能解决，但移动端需要配合做改造，难度比较大。","like_count":0},{"had_liked":false,"id":13912,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1530062759,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530062759","product_id":100007101,"comment_content":"超哥，目前我国DNS SEC可以使用了吗？最早听说我们运营商不支持。","like_count":0},{"had_liked":false,"id":13911,"user_name":"LEON","can_delete":false,"product_type":"c1","uid":1109922,"ip_address":"","ucode":"58F7AF5302FCAD","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/a2/6ea5bb9e.jpg","comment_is_top":false,"comment_ctime":1530062646,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530062646","product_id":100007101,"comment_content":"超哥，请教个问题，GSLB在判断站点故障后切换A记录到可用站点(GSLB上的A记录配置的TTL30秒)。但是部分用户并没有切换成功，是因为GSLB提供的A记录的TTL让部分运营商的local dns 改成了12个小时，导致用户本地TTL缓存长，必须清缓存换local dns。用户端的local dns配置不可控制。这种情况下除了不使用HTTP DNS改造外，有什么更好的办法？如果使用EDNS不知道目前支持情况怎么样？谢谢","like_count":0},{"had_liked":false,"id":13908,"user_name":"龚极客","can_delete":false,"product_type":"c1","uid":1060645,"ip_address":"","ucode":"11AADCCD31D53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/25/d2162fce.jpg","comment_is_top":false,"comment_ctime":1530062247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530062247","product_id":100007101,"comment_content":"问题1，因为机房的网络对应的运营商速度不同<br>问题2，如果某一个节点不可达，需要弹性伸缩，数据中心master 和slave的延迟也是个问题。","like_count":0},{"had_liked":false,"id":13906,"user_name":"叮当","can_delete":false,"product_type":"c1","uid":1116146,"ip_address":"","ucode":"E9F92E686264E1","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/f2/156a220f.jpg","comment_is_top":false,"comment_ctime":1530062165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530062165","product_id":100007101,"comment_content":"同求知识图谱阳光普照","like_count":0},{"had_liked":false,"id":13902,"user_name":"free","can_delete":false,"product_type":"c1","uid":1063817,"ip_address":"","ucode":"65F3F0ADD38D19","user_header":"","comment_is_top":false,"comment_ctime":1530061932,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530061932","product_id":100007101,"comment_content":"1 跨运营商慢的问题<br>2 gslb自身的高可用","like_count":0},{"had_liked":false,"id":13895,"user_name":"问题究竟系边度","can_delete":false,"product_type":"c1","uid":1095284,"ip_address":"","ucode":"CA4F2C9A84F867","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/74/c63449b1.jpg","comment_is_top":false,"comment_ctime":1530060964,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530060964","product_id":100007101,"comment_content":"分地址和运营商应该是使用适用的网络提高访问效率。<br>这种分配方式只是直接就近分配。并没有根据对应链路质量进行监测和调整。<br>是否应该部署两个gslb预防单点故障和网络攻击？","like_count":0},{"had_liked":false,"id":13890,"user_name":"Kail","can_delete":false,"product_type":"c1","uid":1042137,"ip_address":"","ucode":"B308EED959D345","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e6/d9/4cc39ed1.jpg","comment_is_top":false,"comment_ctime":1530060473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530060473","product_id":100007101,"comment_content":"1.CDN?<br>2.DNS 劫持？HTTPDNS","like_count":0},{"had_liked":false,"id":13879,"user_name":"一箭中的","can_delete":false,"product_type":"c1","uid":1025729,"ip_address":"","ucode":"9D18662C5CCF7A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a6/c1/d4e6147e.jpg","comment_is_top":false,"comment_ctime":1530059048,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530059048","product_id":100007101,"comment_content":"思考题2:当域名对应的ip地址更换了，那么dns缓存内容就失效了，此时会导致无法访问到该网址。所以dns缓存都会超时时间，超时后缓存就会失效。","like_count":0},{"had_liked":false,"id":13878,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1053390,"ip_address":"","ucode":"ABB3F1A63E102A","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/ce/a8c8b5e8.jpg","comment_is_top":false,"comment_ctime":1530058190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530058190","product_id":100007101,"comment_content":"每篇都能学到新知识。谢超哥。","like_count":0}]}