{"id":12052,"title":"29 | 协程的语法糖","content":"<h1>源代码及 PDF 课件地址：</h1><p><strong><a href=\"https://gitee.com/geektime-geekbang/KotlinPrimer\">https://gitee.com/geektime-geekbang/KotlinPrimer</a></strong></p>","comments":[{"had_liked":false,"id":99731,"user_name":"川殇","can_delete":false,"product_type":"c3","uid":1545514,"ip_address":"","ucode":"7C5AC48C5095DC","user_header":"","comment_is_top":false,"comment_ctime":1559287298,"is_pvip":false,"replies":[{"id":42502,"content":"是的，视频录制是在一年多以前做的，那时候还没有协程正式版，没办法，不能更新","user_name":"作者回复","user_name_real":"kymjs张涛","uid":1009146,"ctime":1563807301,"ip_address":"","comment_id":99731,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100009801,"comment_content":"现在协程版本都1.2.1了，有些调用都变化了","like_count":2,"discussions":[{"author":{"id":1009146,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/fa/2b4d2f26.jpg","nickname":"kymjs张涛","note":"","ucode":"EFE7AF4C0D4FE8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452242,"discussion_content":"是的，视频录制是在一年多以前做的，那时候还没有协程正式版，没办法，不能更新","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563807301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105539,"user_name":"Nate Robinson","can_delete":false,"product_type":"c3","uid":1174645,"ip_address":"","ucode":"EBFFF22FCEEDFD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ec/75/848604bb.jpg","comment_is_top":false,"comment_ctime":1561024828,"is_pvip":false,"replies":[{"id":58063,"content":"👍🏻","user_name":"作者回复","user_name_real":"kymjs张涛","uid":1009146,"ctime":1573636966,"ip_address":"","comment_id":105539,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100009801,"comment_content":"How to migrate Kotlin from 1.2 to Kotlin 1.3.0 then using async, launch...\n\nhttps:&#47;&#47;stackoverflow.com&#47;questions&#47;53125385&#47;how-to-migrate-kotlin-from-1-2-to-kotlin-1-3-0-then-using-async-ui-and-bg-in-a\n\n这个link里面有介绍","like_count":0,"discussions":[{"author":{"id":1009146,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/fa/2b4d2f26.jpg","nickname":"kymjs张涛","note":"","ucode":"EFE7AF4C0D4FE8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454719,"discussion_content":"👍🏻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573636966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68939,"user_name":"书生依旧","can_delete":false,"product_type":"c3","uid":1069827,"ip_address":"","ucode":"4B2181160AD303","user_header":"https://static001.geekbang.org/account/avatar/00/10/53/03/24a892b7.jpg","comment_is_top":false,"comment_ctime":1550630750,"is_pvip":false,"replies":[{"id":42509,"content":"await的调用必须在suspend代码块内","user_name":"作者回复","user_name_real":"kymjs张涛","uid":1009146,"ctime":1563807675,"ip_address":"","comment_id":68939,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100009801,"comment_content":"await 是会阻塞当前线程，这样写虽然网络请求是异步的，但是 await 必须要等到网络返回数据才会往下执行，还是会阻塞 UI 吧？","like_count":0,"discussions":[{"author":{"id":1009146,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/fa/2b4d2f26.jpg","nickname":"kymjs张涛","note":"","ucode":"EFE7AF4C0D4FE8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439879,"discussion_content":"await的调用必须在suspend代码块内","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563807675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21470,"user_name":"tiny","can_delete":false,"product_type":"c3","uid":1185477,"ip_address":"","ucode":"1E78BE01A1D507","user_header":"https://static001.geekbang.org/account/avatar/00/12/16/c5/883ed7f0.jpg","comment_is_top":false,"comment_ctime":1535102913,"is_pvip":false,"replies":[{"id":7754,"content":"可以run一下本视频中的示例代码，对照看看是不是配置或者gradle的问题","user_name":"作者回复","user_name_real":"kymjs张涛","uid":1009146,"ctime":1535331385,"ip_address":"","comment_id":21470,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100009801,"comment_content":"依赖了协程的Android库以后，会报错，然后我从协程的github上找了demo，发现问题跟我的一样，怎么解？\n\n依赖:\nimplementation &quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:0.25.0&quot;\n\nclasspath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.2.61&quot;\n\n报错:\nAndroid部分: \n1、Program type already present: kotlinx.coroutines.experimental.internal.LockFreeMPMCQueue\nMessage{kind=ERROR, text=Program type already present: kotlinx.coroutines.experimental.internal.LockFreeMPMCQueue, sources=[Unknown source file], tool name=Optional.of(D8)}\n\n2、Program type already present: kotlinx.coroutines.experimental.sync.MutexImpl$lockSuspend$$inlined$suspendAtomicCancellableCoroutine$lambda$1\nMessage{kind=ERROR, text=Program type already present: kotlinx.coroutines.experimental.sync.MutexImpl$lockSuspend$$inlined$suspendAtomicCancellableCoroutine$lambda$1, sources=[Unknown source file], tool name=Optional.of(D8)}\n\nJava部分: \n1、com.android.builder.dexing.DexArchiveBuilderException: Failed to process &#47;Users&#47;xxx&#47;KotlinCoroutineDemo&#47;app&#47;build&#47;intermediates&#47;transforms&#47;desugar&#47;debug&#47;16.jar\n\n2、com.android.builder.dexing.DexArchiveBuilderException: Error while dexing.\n\n3、com.android.tools.r8.CompilationFailedException: Compilation failed to complete\n\n4、com.android.tools.r8.utils.AbortException","like_count":0,"discussions":[{"author":{"id":1009146,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/fa/2b4d2f26.jpg","nickname":"kymjs张涛","note":"","ucode":"EFE7AF4C0D4FE8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422692,"discussion_content":"可以run一下本视频中的示例代码，对照看看是不是配置或者gradle的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535331385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49826,"user_name":"nbnnsr","can_delete":false,"product_type":"c3","uid":1173616,"ip_address":"","ucode":"27EA76E346C308","user_header":"https://static001.geekbang.org/account/avatar/00/11/e8/70/612f3078.jpg","comment_is_top":false,"comment_ctime":1544776040,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100009801,"comment_content":"implementation &#39;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.0.1&#39;\nfun displayDashboard(mTextView: TextView) = runBlocking {\n    launch {\n        mTextView.text =  withContext(Dispatchers.Default) {\n            okHttpClient.newCall(request).execute().body()?.string()\n        }\n    }\n}","like_count":0}]}