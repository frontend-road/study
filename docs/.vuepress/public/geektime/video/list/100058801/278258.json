{"id":278258,"title":"07 | Flink集群运行模式","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-Flink\">https://gitee.com/geektime-geekbang/geektime-Flink</a></p>","comments":[{"had_liked":false,"id":246421,"user_name":"Geek_qsftko","can_delete":false,"product_type":"c3","uid":1526892,"ip_address":"","ucode":"EE3316C188EC3C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKerOHGs8VAMWj0ysxZpTPcARHEITiaH8YDJR7aoDNYhRpbLsZ0pJdJXIfzvR7u06iaKPBUoWfic5Zww/132","comment_is_top":false,"comment_ctime":1599318427,"is_pvip":false,"replies":[{"id":90643,"content":"主要还是看资源隔离，生产环境任务如果要求比较高，建议使用 Per-Job Mode，资源隔离相对充分，如果是普通的流式任务，则建议Session Mode会更好点。\n离线任务的话则建议Per-Job Mode，实时任务相对比较稳定根据资源隔离要求具体视情况选择即可。","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1599455160,"ip_address":"","comment_id":246421,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，在生产环境的话建议使用Session Mode 还是 Per-Job Mode啊？  那么如果从离线任务和实时7*24小时任务的角度来讲，应该使用哪种运行模式啊？","like_count":6,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505137,"discussion_content":"主要还是看资源隔离，生产环境任务如果要求比较高，建议使用 Per-Job Mode，资源隔离相对充分，如果是普通的流式任务，则建议Session Mode会更好点。\n离线任务的话则建议Per-Job Mode，实时任务相对比较稳定根据资源隔离要求具体视情况选择即可。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599455160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247838,"user_name":"🎼 张ͮ子ͮ谋ͮ","can_delete":false,"product_type":"c3","uid":2166314,"ip_address":"","ucode":"EB308D06D8CE77","user_header":"https://static001.geekbang.org/account/avatar/00/21/0e/2a/9f2d2d54.jpg","comment_is_top":false,"comment_ctime":1599883516,"is_pvip":false,"replies":[{"id":91405,"content":"可以这么理解，但是前提是每次需要上传Jar包，然后才能提交，上传Jar的过程实际就是Client做的事情，可以降低负载","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1600481684,"ip_address":"","comment_id":247838,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"通过Flink UI 直接提交Jar，应该是在JobManger的机器上执行吧，这样也能降低客服端负载吧？","like_count":2,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505509,"discussion_content":"可以这么理解，但是前提是每次需要上传Jar包，然后才能提交，上传Jar的过程实际就是Client做的事情，可以降低负载","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600481684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248275,"user_name":"西南偏北","can_delete":false,"product_type":"c3","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1600087584,"is_pvip":false,"replies":[{"id":91401,"content":"对的 可以这么理解，就是Driver在哪里的问题","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1600481495,"ip_address":"","comment_id":248275,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"Application Mode的这种方式感觉和Spark on YARN cluster模式的原理差不多","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505602,"discussion_content":"对的 可以这么理解，就是Driver在哪里的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600481495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247897,"user_name":"kaka.","can_delete":false,"product_type":"c3","uid":1612710,"ip_address":"","ucode":"419FC740511440","user_header":"https://static001.geekbang.org/account/avatar/00/18/9b/a6/e283d463.jpg","comment_is_top":false,"comment_ctime":1599905665,"is_pvip":false,"replies":[{"id":91404,"content":"关于资源配置，我们在后面章节有专门讲解的，可以关注下后面的章节，资源可以动态增加","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1600481610,"ip_address":"","comment_id":247897,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，如果是普通的流式任务，为了节省资源选择Session Mode，资源配置和slot数量怎么去配置呢，可以动态增加集群资源吗","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505522,"discussion_content":"关于资源配置，我们在后面章节有专门讲解的，可以关注下后面的章节，资源可以动态增加","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600481610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247406,"user_name":"free zyq","can_delete":false,"product_type":"c3","uid":1141823,"ip_address":"","ucode":"F1414E56313CEB","user_header":"https://static001.geekbang.org/account/avatar/00/11/6c/3f/718038ac.jpg","comment_is_top":false,"comment_ctime":1599702645,"is_pvip":false,"replies":[{"id":91409,"content":"对的 ","user_name":"作者回复","user_name_real":"张利兵","uid":1119779,"ctime":1600481884,"ip_address":"","comment_id":247406,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"上一节介绍了一些关键的组件：jm，tm，client，jg，job\n这一节开篇提到的application，runtime，cluster分别对应的什么？\n\n我理解是：\napplication=包含一个main方法的job？\nruntime =tm+jm+client\ncluster = jm+很多tm？\n\n\n\n","like_count":0,"discussions":[{"author":{"id":1119779,"avatar":"https://static001.geekbang.org/account/avatar/00/11/16/23/99c7ede5.jpg","nickname":"张利兵","note":"","ucode":"DBAE17970AB143","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505390,"discussion_content":"对的 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600481884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117548,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0d/6c/cb52f6f7.jpg","nickname":"桂林","note":"","ucode":"95906EF7338C48","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365617,"discussion_content":"一个application对应一个jobmanager，一个application是可以有多个job的吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617851966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345951,"user_name":"小七","can_delete":false,"product_type":"c3","uid":1639255,"ip_address":"","ucode":"9FB9788026BF06","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfenHHNSUm2u7r0m7b4MIvzhwHzg3ICxmGGAG6Th3jnm7xhkj20xu1lkCUUeSmy8gRw3UgqicAzJA/132","comment_is_top":false,"comment_ctime":1652711421,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"老师，不同的job，是根据什么规则划分为同一个 “Application“ 的？","like_count":0},{"had_liked":false,"id":331171,"user_name":"orangelin","can_delete":false,"product_type":"c3","uid":2010843,"ip_address":"","ucode":"730CC9997C16F2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/cojb2AA3eM620kb7hj7YoG8k56TKsdCmVletmYKYwibickH5Ced8UyxicpY9icZEM2ZTcqyUaEk2PRmH1FVLtGTggw/132","comment_is_top":false,"comment_ctime":1642472554,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"图里提交多job只画了一个jobmanager ，但是一个application又只对应一个jobmanager，这里是怎么理解的？","like_count":0,"discussions":[{"author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"福","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550250,"discussion_content":"我理解的是，一个application有多个job,然后 application-mode 下，1个application 有1个jm，多个tm,所以图中看着是1个jm里面有多个job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644458818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315353,"user_name":"Geek_58a455","can_delete":false,"product_type":"c3","uid":1519269,"ip_address":"","ucode":"C20E856D38D338","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2qHhibwFEiaNWNjCqTpe8kCHqWian0rBdkulmkvVXpkr4CSOpuibVHNVozHUERAmvMDMticfycjzgwYDv6Gfav1dZ3A/132","comment_is_top":false,"comment_ctime":1633854188,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"Application mode是每一个Applicaiton会生成一个jm和对应的tm吗？","like_count":0},{"had_liked":false,"id":310099,"user_name":"hadoop_admin","can_delete":false,"product_type":"c3","uid":1300466,"ip_address":"","ucode":"7EAFA775505C7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJGMphabeneYXs9otkAtr67RvxJClDa7jPe7w8yExg4YaS2FGJruDKMj5yN1E90o6MFibnicH8gM0ibg/132","comment_is_top":false,"comment_ctime":1630484517,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"大佬，咨询下 现在flink 部署支持ipv6么，在jira上看到https:&#47;&#47;issues.apache.org&#47;jira&#47;browse&#47;FLINK-9824和\nhttps:&#47;&#47;issues.apache.org&#47;jira&#47;browse&#47;FLINK-23206，是不是还不支持？社区有计划支持么？","like_count":0},{"had_liked":false,"id":286027,"user_name":"相遇太早～","can_delete":false,"product_type":"c3","uid":1609771,"ip_address":"","ucode":"81C2C8DDC8D8EC","user_header":"https://static001.geekbang.org/account/avatar/00/18/90/2b/564f9143.jpg","comment_is_top":false,"comment_ctime":1617112225,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100058801,"comment_content":"一个main方法对应一个job，一个application包含多个job是指有多个类，每个类一个main方法入口吗？","like_count":0},{"had_liked":false,"id":267379,"user_name":"Phantom01","can_delete":false,"product_type":"c3","uid":1140424,"ip_address":"","ucode":"9FA50D3B0A06DB","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/c8/f598a816.jpg","comment_is_top":false,"comment_ctime":1607699709,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100058801,"comment_content":"application 模式的 kubernetes 部署，猜想应该可以以挂载点的模式把外部的 jar 给挂进去。每次都 build 一个新镜像成本有点高。","like_count":0}]}