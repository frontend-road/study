{"id":644795,"title":"09ï½œè¯­ä¹‰æ£€ç´¢ï¼Œåˆ©ç”¨Embeddingä¼˜åŒ–ä½ çš„æœç´¢åŠŸèƒ½","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚</p><p>åœ¨è¿‡å»çš„8è®²é‡Œé¢ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹Embeddingå’ŒCompletionæ¥å£éå¸¸ç†Ÿæ‚‰äº†ã€‚Embeddingå‘é‡é€‚åˆä½œä¸ºä¸€ä¸ªä¸­é—´ç»“æœï¼Œç”¨äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ åœºæ™¯ï¼Œæ¯”å¦‚åˆ†ç±»ã€èšç±»ã€‚è€ŒCompletionæ¥å£ï¼Œä¸€æ–¹é¢å¯ä»¥ç›´æ¥æ‹¿æ¥ä½œä¸ºä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œå¦ä¸€æ–¹é¢ï¼Œä½ åªè¦å–„ç”¨æç¤ºè¯ï¼Œå°±èƒ½å®Œæˆåˆç†çš„æ–‡æ¡ˆæ’°å†™ã€æ–‡æœ¬æ‘˜è¦ã€æœºå™¨ç¿»è¯‘ç­‰ä¸€ç³»åˆ—çš„å·¥ä½œã€‚</p><p>ä¸è¿‡ï¼Œå¾ˆå¤šåŒå­¦å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¸ªå’Œæˆ‘çš„æ—¥å¸¸å·¥ä½œåˆæ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚çš„ç¡®ï¼Œæ—¥å¸¸æˆ‘ä»¬çš„éœ€æ±‚é‡Œé¢ï¼Œæœ€å¸¸ä½¿ç”¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æŠ€æœ¯çš„ï¼Œæ˜¯æœç´¢ã€å¹¿å‘Šã€æ¨èè¿™æ ·çš„ä¸šåŠ¡ã€‚é‚£ä¹ˆï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œæ€ä¹ˆåˆ©ç”¨OpenAIæä¾›çš„æ¥å£æ¥ä¸ºè¿™äº›éœ€æ±‚æä¾›äº›å¸®åŠ©ã€‚</p><h2>è®©AIç”Ÿæˆå®éªŒæ•°æ®</h2><p>åœ¨å®é™…æ¼”ç¤ºä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å¯ä»¥æ‹¿æ¥å®éªŒçš„æ•°æ®ã€‚ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨ç½‘ä¸Šæ‰¾ä¸€äº›æ•°æ®é›†ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ä¸€äº›æœºå™¨å­¦ä¹ è½¯ä»¶åŒ…é‡Œé¢è‡ªå¸¦çš„æ•°æ®é›†ã€‚ä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ—¶å€™æˆ‘ä»¬éƒ½èƒ½å¾ˆå¿«æ‰¾åˆ°åˆé€‚çš„æ•°æ®é›†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨AIï¼Œæˆ‘ä»¬ç›´æ¥è®©AIå¸®æˆ‘ä»¬ç”Ÿæˆä¸€äº›æ•°æ®ä¸å°±å¥½äº†å—ï¼Ÿ</p><pre><code class=\"language-python\">import openai, os\n\nopenai.api_key = os.environ.get(\"OPENAI_API_KEY\")\nCOMPLETION_MODEL = \"text-davinci-003\"\n\ndef generate_data_by_prompt(prompt):\n    response = openai.Completion.create(\n        engine=COMPLETION_MODEL,\n        prompt=prompt,\n        temperature=0.5,\n        max_tokens=2048,\n        top_p=1,\n    )\n    return response.choices[0].text\n\nprompt = \"\"\"è¯·ä½ ç”Ÿæˆ50æ¡æ·˜å®ç½‘é‡Œçš„å•†å“çš„æ ‡é¢˜ï¼Œæ¯æ¡åœ¨30ä¸ªå­—å·¦å³ï¼Œå“ç±»æ˜¯3Cæ•°ç äº§å“ï¼Œæ ‡é¢˜é‡Œå¾€å¾€ä¹Ÿä¼šæœ‰ä¸€äº›ä¿ƒé”€ç±»çš„ä¿¡æ¯ï¼Œæ¯è¡Œä¸€æ¡ã€‚\"\"\"\ndata = generate_data_by_prompt(prompt)\n</code></pre><!-- [[[read_end]]] --><p>ä¸ºäº†è®©æ•°æ®å’ŒçœŸå®æƒ…å†µæ›´åŠ æ¥è¿‘ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å¥½å¥½è®¾è®¡ä¸€ä¸‹æˆ‘ä»¬çš„æç¤ºè¯­ã€‚æ¯”å¦‚ï¼Œæˆ‘è¿™é‡Œå°±æŒ‡æ˜äº†æ˜¯æ·˜å®çš„å•†å“ï¼Œå“ç±»æ˜¯3Cï¼Œå¹¶ä¸”æ ‡é¢˜é‡Œè¦åŒ…å«ä¸€äº›ä¿ƒé”€ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬æŠŠæ‹¿åˆ°çš„è¿”å›ç»“æœï¼ŒæŒ‰è¡Œåˆ†å‰²ï¼ŒåŠ è½½åˆ°ä¸€ä¸ªDataFrameé‡Œé¢ï¼Œçœ‹çœ‹ç»“æœä¼šæ˜¯æ€ä¹ˆæ ·çš„ã€‚</p><pre><code class=\"language-python\">import pandas as pd\n\nproduct_names = data.strip().split('\\n')\ndf = pd.DataFrame({'product_name': product_names})\ndf.head()\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">    product_name\n0\t1. ã€é™æ—¶ç‰¹æƒ ã€‘Apple/è‹¹æœ iPhone 11 Pro Max æ‰‹æœº\n1\t2. ã€è¶…å€¼æŠ˜æ‰£ã€‘Huawei/åä¸º P30 Pro æ™ºèƒ½æ‰‹æœº\n2\t3. ã€çƒ­é”€çˆ†æ¬¾ã€‘OPPO Reno 10X Zoom å…¨ç½‘é€šæ‰‹æœº\n3\t4. ã€é™é‡ç‰¹ä»·ã€‘Xiaomi/å°ç±³ 9 Pro 5G æ‰‹æœº\n4\t5. ã€é™æ—¶ä¿ƒé”€ã€‘Apple/è‹¹æœ iPad Pro 11å¯¸ å¹³æ¿\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒAIä¸ºæˆ‘ä»¬ç”Ÿæˆäº†50æ¡å•†å“ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéƒ½å¸¦ä¸Šäº†ä¸€äº›ä¿ƒé”€ç›¸å…³çš„æ ‡ç­¾ã€‚ä¸è¿‡ï¼Œåœ¨è¿”å›çš„ç»“æœé‡Œé¢ï¼Œæ¯ä¸€è¡Œéƒ½å¸¦ä¸Šäº†ä¸€ä¸ªæ ‡å·ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç®€å•å¤„ç†ä¸€ä¸‹ï¼Œå»æ‰è¿™ä¸ªæ ‡å·æ‹¿åˆ°ä¸€äº›å¹²å‡€çš„æ•°æ®ã€‚</p><pre><code class=\"language-python\">df.product_name = df.product_name.apply(lambda x: x.split('.')[1].strip())\ndf.head()\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">     product_name\n0\tã€é™æ—¶ç‰¹æƒ ã€‘Apple/è‹¹æœ iPhone 11 Pro Max æ‰‹æœº\n1\tã€è¶…å€¼æŠ˜æ‰£ã€‘Huawei/åä¸º P30 Pro æ™ºèƒ½æ‰‹æœº\n2\tã€çƒ­é”€çˆ†æ¬¾ã€‘OPPO Reno 10X Zoom å…¨ç½‘é€šæ‰‹æœº\n3\tã€é™é‡ç‰¹ä»·ã€‘Xiaomi/å°ç±³ 9 Pro 5G æ‰‹æœº\n4\tã€é™æ—¶ä¿ƒé”€ã€‘Apple/è‹¹æœ iPad Pro 11å¯¸ å¹³æ¿\n</code></pre><p>æˆ‘ä»¬å¯ä»¥å¦‚æ³•ç‚®åˆ¶ï¼Œå†ç”Ÿæˆä¸€äº›å¥³è£…çš„å•†å“åç§°ï¼Œè¦†ç›–ä¸åŒçš„å“ç±»ï¼Œè¿™æ ·åé¢æˆ‘ä»¬æ¼”ç¤ºæœç´¢æ•ˆæœçš„æ—¶å€™å°±ä¼šæ–¹ä¾¿ä¸€ç‚¹ã€‚</p><pre><code class=\"language-python\">clothes_prompt = \"\"\"è¯·ä½ ç”Ÿæˆ50æ¡æ·˜å®ç½‘é‡Œçš„å•†å“çš„æ ‡é¢˜ï¼Œæ¯æ¡åœ¨30ä¸ªå­—å·¦å³ï¼Œå“ç±»æ˜¯å¥³æ€§çš„æœé¥°ç®±åŒ…ç­‰ç­‰ï¼Œæ ‡é¢˜é‡Œå¾€å¾€ä¹Ÿä¼šæœ‰ä¸€äº›ä¿ƒé”€ç±»çš„ä¿¡æ¯ï¼Œæ¯è¡Œä¸€æ¡ã€‚\"\"\"\nclothes_data = generate_data_by_prompt(clothes_prompt)\nclothes_product_names = clothes_data.strip().split('\\n')\nclothes_df = pd.DataFrame({'product_name': clothes_product_names})\nclothes_df.product_name = clothes_df.product_name.apply(lambda x: x.split('.')[1].strip())\nclothes_df.head()\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">    product_name\n0\tã€æ–°æ¬¾ã€‘æ—¶å°šç™¾æ­ç¾Šç»’æ¯›è¡£ï¼Œæš–æ´‹æ´‹æ¸©æš–ä½ çš„å†¬å¤©\n1\tã€çƒ­å–ã€‘å¤å¤æ°”è´¨ç¿»é¢†æ¯›è¡£ï¼Œç©¿å‡ºæ—¶å°šæ„Ÿ\n2\tã€ç‰¹ä»·ã€‘è½»è–„ç™¾æ­æ£‰è¡£ï¼Œèˆ’é€‚æ¸©æš–ï¼Œå†¬å­£å¿…å¤‡\n3\tã€é™æ—¶ã€‘ç»å…¸ç™¾æ­ç‰›ä»”å¤–å¥—ï¼Œè½»æ¾æ­é…ï¼Œæ—¶å°šèŒƒ\n4\tã€å…¨æ–°ã€‘ç®€çº¦å¤§æ°”ç¾Šç»’è¿è¡£è£™ï¼Œæ¸©æŸ”ä¼˜é›…\n</code></pre><p>ç„¶åæˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªDataFrameæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥ç”¨äºåšæœç´¢å®éªŒçš„æ•°æ®ã€‚</p><pre><code class=\"language-python\">df = pd.concat([df, clothes_df], axis=0)\ndf = df.reset_index(drop=True)\ndisplay(df)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">\tproduct_name\n0\tã€æ–°æ¬¾ã€‘Apple/è‹¹æœ iPhone 11 Pro Max æ™ºèƒ½æ‰‹æœº\n1\tã€ç‰¹æƒ ã€‘åä¸ºP30 Pro 8GB+256GB å…¨ç½‘é€šç‰ˆ\n2\tã€é™é‡ã€‘OnePlus 7T Pro 8GB+256GB å…¨ç½‘é€š\n3\tã€æ–°å“ã€‘å°ç±³CC9 Pro 8GB+256GB å…¨ç½‘é€šç‰ˆ\n4\tã€çƒ­é”€ã€‘ä¸‰æ˜ŸGalaxy Note10+ 8GB+256GB å…¨ç½‘é€š\n...\t...\n92\tã€ä¼˜æƒ ã€‘æ°”è´¨å°æ¸…æ–°æ‹¼æ¥ç™¾æ­åŒè‚©æ–œæŒåŒ…\n93\tã€çƒ­å–ã€‘æ´»åŠ›è‰²å½©ç²¾è‡´å°å·§ç™¾æ­å¥³å£«å•è‚©æ–œæŒåŒ…\n94\tã€ç‰¹ä»·ã€‘ç®€çº¦å¯çˆ±åŸå®¿é£æ—¶å°šåŒè‚©æ–œæŒåŒ…\n95\tã€æŠ˜æ‰£ã€‘æ½®æµå°æ¸…æ–°æ‹¼æ¥ç™¾æ­å¥³å£«å•è‚©æ–œæŒåŒ…\n96\tã€ç‰¹æƒ ã€‘ç™¾æ­æ½®æµæ´»åŠ›è‰²å½©æ‹¼è‰²åŒè‚©æ–œæŒ\n</code></pre><p>ä¸è¿‡å¦‚æœä½ å¤šè¯•å‡ æ¬¡ï¼Œä½ ä¼šå‘ç°AIæœ‰æ—¶å€™è¿”å›çš„æ¡æ•°æ²¡æœ‰50æ¡ï¼Œä¸è¿‡æ²¡æœ‰å…³ç³»ï¼Œè¿™ä¸ªåŸºæœ¬ä¸å½±å“æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ•°æ®æºã€‚ä½ å®Œå…¨å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ï¼Œè·å¾—è¶³å¤Ÿä½ éœ€è¦çš„æ•°æ®ã€‚</p><h2>é€šè¿‡Embeddingè¿›è¡Œè¯­ä¹‰æœç´¢</h2><p>é‚£å¯¹äºæœç´¢é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨GPTæ¨¡å‹å¹²äº›ä»€ä¹ˆå‘¢ï¼Ÿåƒç™¾åº¦ã€é˜¿é‡Œè¿™æ ·çš„å·¨å¤´å…¬å¸è‡ªç„¶æœ‰å¾ˆå¤šå†…éƒ¨å¤æ‚çš„ç­–ç•¥å’Œæ¨¡å‹ï¼Œä½†æ˜¯å¯¹äºå¤§éƒ¨åˆ†ä¸­å°å…¬å¸ï¼Œç‰¹åˆ«æ˜¯åˆšå¼€å§‹æä¾›æœç´¢åŠŸèƒ½çš„æ—¶å€™ï¼Œå¾€å¾€æ˜¯ä½¿ç”¨Elasticsearchè¿™ä¸ªå¼€æºé¡¹ç›®ã€‚è€ŒElasticsearchèƒŒåçš„æœç´¢åŸç†ï¼Œåˆ™æ˜¯å…ˆåˆ†è¯ï¼Œç„¶åå†ä½¿ç”¨å€’æ’ç´¢å¼•ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠä¸Šé¢çš„â€œæ°”è´¨å°æ¸…æ–°æ‹¼æ¥ç™¾æ­åŒè‚©æ–œæŒåŒ…â€è¿™æ ·çš„å•†å“åç§°ï¼Œæ‹†åˆ†æˆâ€œæ°”è´¨â€â€œå°æ¸…æ–°â€â€œæ‹¼æ¥â€â€œç™¾æ­â€â€œåŒè‚©â€â€œæ–œæŒåŒ…â€ã€‚æ¯ä¸ªæ ‡é¢˜éƒ½æ˜¯è¿™æ ·åˆ‡åˆ†ã€‚ç„¶åï¼Œå»ºç«‹ä¸€ä¸ªç´¢å¼•ï¼Œæ¯”å¦‚â€œæ°”è´¨â€è¿™ä¸ªè¯ï¼Œå‡ºç°è¿‡çš„æ ‡é¢˜çš„ç¼–å·ï¼Œéƒ½æŒ‰ç¼–å·é¡ºåºè·Ÿåœ¨æ°”è´¨åé¢ã€‚å…¶ä»–çš„è¯ä¹Ÿç±»ä¼¼ã€‚</p><p>ç„¶åï¼Œå½“ç”¨æˆ·æœç´¢çš„æ—¶å€™ï¼Œæ¯”å¦‚ç”¨æˆ·æœç´¢â€œæ°”è´¨èƒŒåŒ…â€ï¼Œä¹Ÿä¼šæ‹†åˆ†æˆâ€œæ°”è´¨â€å’Œâ€œèƒŒåŒ…â€ä¸¤ä¸ªè¯ã€‚ç„¶åå°±æ ¹æ®è¿™ä¸¤ä¸ªè¯ï¼Œæ‰¾åˆ°åŒ…å«è¿™äº›è¯çš„æ ‡é¢˜ï¼Œæ ¹æ®å‡ºç°çš„è¯çš„æ•°é‡ã€æƒé‡ç­‰ç­‰æ‰¾å‡ºä¸€äº›å•†å“ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªç­–ç•¥æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯å¦‚æœæˆ‘ä»¬æœ‰åŒä¹‰è¯ï¼Œé‚£ä¹ˆè¿™ä¹ˆç®€å•åœ°å»æœç´¢æ˜¯æœä¸åˆ°çš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¦‚æœæœâ€œè‡ªç„¶æ·¡é›…èƒŒåŒ…â€ï¼Œè™½ç„¶è¯­ä¹‰ä¸Šå¾ˆæ¥è¿‘ï¼Œä½†æ˜¯å› ä¸ºâ€œè‡ªç„¶â€â€œæ·¡é›…â€â€œèƒŒåŒ…â€è¿™ä¸‰ä¸ªè¯åœ¨è¿™ä¸ªå•†å“æ ‡é¢˜é‡Œéƒ½æ²¡æœ‰å‡ºç°ï¼Œæ‰€ä»¥å°±æ²¡æœ‰åŠæ³•åŒ¹é…ä¸Šäº†ã€‚ä¸ºäº†æå‡æœç´¢æ•ˆæœï¼Œä½ å°±å¾—åšæ›´å¤šçš„å·¥ç¨‹ç ”å‘å·¥ä½œï¼Œæ¯”å¦‚æ‰¾ä¸€ä¸ªåŒä¹‰è¯è¡¨ï¼ŒæŠŠæ ‡é¢˜é‡Œå‡ºç°çš„åŒä¹‰è¯ä¹Ÿç®—ä¸Šç­‰ç­‰ã€‚</p><p>ä¸è¿‡ï¼Œæœ‰äº†OpenAIçš„Embeddingæ¥å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¸€æ®µæ–‡æœ¬çš„è¯­ä¹‰è¡¨ç¤ºæˆä¸€æ®µå‘é‡ã€‚è€Œå‘é‡ä¹‹é—´æ˜¯å¯ä»¥è®¡ç®—è·ç¦»çš„ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨ä¹‹å‰çš„æƒ…æ„Ÿåˆ†æçš„é›¶æ ·æœ¬åˆ†ç±»é‡Œå°±æ¼”ç¤ºè¿‡äº†ã€‚é‚£å¦‚æœæˆ‘ä»¬æŠŠç”¨æˆ·çš„æœç´¢ï¼Œä¹Ÿé€šè¿‡Embeddingæ¥å£å˜æˆå‘é‡ã€‚ç„¶åæŠŠå®ƒå’Œæ‰€æœ‰çš„å•†å“çš„æ ‡é¢˜è®¡ç®—ä¸€ä¸‹ä½™å¼¦è·ç¦»ï¼Œæ‰¾å‡ºç¦»æˆ‘ä»¬æœç´¢è¯æœ€è¿‘çš„å‡ ä¸ªå‘é‡ã€‚é‚£æœ€è¿‘çš„å‡ ä¸ªå‘é‡ï¼Œå…¶å®å°±æ˜¯è¯­ä¹‰å’Œè¿™ä¸ªå•†å“ç›¸ä¼¼çš„ï¼Œè€Œå¹¶ä¸ä¸€å®šéœ€è¦ç›¸åŒçš„å…³é”®è¯ã€‚</p><p>é‚£æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬ä¸å¦¨ç”¨ä»£ç æ¥è¯•ä¸€è¯•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æŠŠéšæœºç”Ÿæˆå‡ºæ¥çš„æ‰€æœ‰å•†å“æ ‡é¢˜ï¼Œéƒ½è®¡ç®—å‡ºæ¥å®ƒä»¬çš„Embeddingï¼Œç„¶åå­˜ä¸‹æ¥ã€‚è¿™é‡Œçš„ä»£ç ï¼ŒåŸºæœ¬å’Œä¹‹å‰é€šè¿‡Embeddingè¿›è¡Œåˆ†ç±»å’Œèšç±»ä¸€è‡´ï¼Œå°±ä¸å†è¯¦ç»†è®²è§£äº†ã€‚æˆ‘ä»¬è¿˜æ˜¯åˆ©ç”¨backoffå’Œbatchå¤„ç†ï¼Œè®©ä»£ç èƒ½å¤Ÿå®¹é”™ï¼Œå¹¶ä¸”å¿«é€Ÿå¤„ç†å®Œè¿™äº›å•†å“æ ‡é¢˜ã€‚</p><pre><code class=\"language-python\">from openai.embeddings_utils import get_embeddings\nimport openai, os, backoff\n\nopenai.api_key = os.environ.get(\"OPENAI_API_KEY\")\nembedding_model = \"text-embedding-ada-002\"\n\nbatch_size = 100\n\n@backoff.on_exception(backoff.expo, openai.error.RateLimitError)\ndef get_embeddings_with_backoff(prompts, engine):\n    embeddings = []\n    for i in range(0, len(prompts), batch_size):\n        batch = prompts[i:i+batch_size]\n        embeddings += get_embeddings(list_of_text=batch, engine=engine)\n    return embeddings\n\nprompts = df.product_name.tolist()\nprompt_batches = [prompts[i:i+batch_size] for i in range(0, len(prompts), batch_size)]\n\nembeddings = []\nfor batch in prompt_batches:\n    batch_embeddings = get_embeddings_with_backoff(prompts=batch, engine=embedding_model)\n    embeddings += batch_embeddings\n\ndf[\"embedding\"] = embeddings\ndf.to_parquet(\"data/taobao_product_title.parquet\", index=False)\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªsearch_productçš„æœç´¢å‡½æ•°ï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ªdfä»£è¡¨ç”¨äºæœç´¢çš„æ•°æ®æºï¼Œä¸€ä¸ªqueryä»£è¡¨ç”¨äºæœç´¢çš„æœç´¢è¯ï¼Œç„¶åä¸€ä¸ªnä»£è¡¨æœç´¢è¿”å›å¤šå°‘æ¡è®°å½•ã€‚è€Œè¿™ä¸ªå‡½æ•°å°±å¹²äº†è¿™æ ·ä¸‰ä»¶äº‹æƒ…ã€‚</p><ol>\n<li>è°ƒç”¨OpenAIçš„APIå°†æœç´¢è¯ä¹Ÿè½¬æ¢æˆEmbeddingã€‚</li>\n<li>å°†è¿™ä¸ªEmbeddingå’ŒDataFrameé‡Œçš„æ¯ä¸€ä¸ªEmbeddingéƒ½è®¡ç®—ä¸€ä¸‹ä½™å¼¦è·ç¦»ã€‚</li>\n<li>æ ¹æ®ä½™å¼¦ç›¸ä¼¼åº¦å»æ’åºï¼Œè¿”å›è·ç¦»æœ€è¿‘çš„nä¸ªæ ‡é¢˜ã€‚</li>\n</ol><pre><code class=\"language-python\">from openai.embeddings_utils import get_embedding, cosine_similarity\n\n# search through the reviews for a specific product\ndef search_product(df, query, n=3, pprint=True):\n    product_embedding = get_embedding(\n        query,\n        engine=embedding_model\n    )\n    df[\"similarity\"] = df.embedding.apply(lambda x: cosine_similarity(x, product_embedding))\n\n    results = (\n        df.sort_values(\"similarity\", ascending=False)\n        .head(n)\n        .product_name\n    )\n    if pprint:\n        for r in results:\n            print(r)\n    return results\n\nresults = search_product(df, \"è‡ªç„¶æ·¡é›…èƒŒåŒ…\", n=3)\n</code></pre><p>æˆ‘ä»¬å°±æ‹¿åˆšæ‰ä¸¾çš„é‚£ä¸ªä¾‹å­ï¼Œä½¿ç”¨â€œè‡ªç„¶æ·¡é›…èƒŒåŒ…â€ä½œä¸ºæœç´¢è¯ï¼Œè°ƒç”¨è¿™ä¸ªsearch_productå‡½æ•°ï¼Œç„¶åæ‹¿å‰3ä¸ªè¿”å›ç»“æœã€‚å¯ä»¥çœ‹åˆ°ï¼Œå°½ç®¡åœ¨å…³é”®è¯ä¸Šå®Œå…¨ä¸åŒï¼Œä½†æ˜¯è¿”å›çš„ç»“æœé‡Œï¼Œçš„ç¡®åŒ…å«äº†â€œå°æ¸…æ–°ç™¾æ­æ‹¼è‰²å¥³å£«å•è‚©æ–œæŒåŒ…â€è¿™ä¸ªå•†å“ã€‚</p><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">ã€æ–°å“ã€‘æ½®æµç®€çº¦å¯çˆ±æ—¶å°šåŒè‚©æ–œæŒåŒ…\nã€ä¼˜æƒ ã€‘ç²¾è‡´å°å·§å¯çˆ±åŒè‚©æ–œæŒåŒ…\nã€æ–°å“ã€‘å°æ¸…æ–°ç™¾æ­æ‹¼è‰²å¥³å£«å•è‚©æ–œæŒåŒ…\n</code></pre><p>æ³¨æ„ï¼Œå› ä¸ºæˆ‘ä»¬çš„å•†å“æ ‡é¢˜éƒ½æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä½ å¾—åˆ°çš„æ•°æ®é›†å’Œæœç´¢ç»“æœå¯èƒ½éƒ½å’Œæˆ‘ä¸ä¸€æ ·ï¼Œä½ æ ¹æ®å®é™…æƒ…å†µæµ‹è¯•ä½ æƒ³è¦çš„æœç´¢è¯å³å¯ã€‚</p><h2>åˆ©ç”¨Embeddingä¿¡æ¯è¿›è¡Œå•†å“æ¨èçš„å†·å¯åŠ¨</h2><p>Embeddingçš„å‘é‡è·ç¦»ï¼Œä¸ä»…å¯ä»¥ç”¨äºæœç´¢ï¼Œä¹Ÿå¯ä»¥ç”¨äº<strong>å•†å“æ¨èé‡Œçš„å†·å¯åŠ¨</strong>ã€‚ä¸»æµçš„æ¨èç®—æ³•ï¼Œä¸»è¦æ˜¯ä¾æ‰˜äºç”¨æˆ·â€œçœ‹äº†åˆçœ‹â€è¿™æ ·çš„è¡Œä¸ºä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯å¦‚æœæœ‰å¾ˆå¤šç”¨æˆ·çœ‹äº†OPPOçš„æ‰‹æœºï¼Œåˆå»çœ‹äº†vivoçš„æ‰‹æœºï¼Œé‚£ä¹ˆåœ¨ç”¨æˆ·çœ‹OPPOæ‰‹æœºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ä»–æ¨èvivoæ‰‹æœºã€‚ä½†æ˜¯ï¼Œå¾€å¾€ä¸€ä¸ªæ–°çš„å•†å“ï¼Œæˆ–è€…æ–°çš„å¹³å°ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šç›¸å…³çš„è¡Œä¸ºæ•°æ®ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æ ¹æ®å•†å“åç§°åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼åº¦ï¼Œæ¥è¿›è¡Œå•†å“æ¨èã€‚</p><p>æˆ‘ä»¬è¿™é‡Œçš„ä»£ç å®ç°å’Œä¸Šé¢çš„æœç´¢ä¾‹å­åŸºæœ¬ä¸€è‡´ï¼Œå”¯ä¸€çš„å·®åˆ«å°±æ˜¯å•†å“åç§°çš„Embeddingæ˜¯æ ¹æ®è¾“å…¥çš„å•†å“åç§°ï¼Œä»DataFrameé‡Œæ‰¾åˆ°çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡è°ƒç”¨OpenAIçš„Embedding APIè·å–ã€‚å› ä¸ºè¿™ä¸ªEmbeddingæˆ‘ä»¬ä¹‹å‰å·²ç»è®¡ç®—è¿‡ä¸€éäº†ï¼Œæ²¡æœ‰å¿…è¦æµªè´¹æˆæœ¬å†è¯·æ±‚ä¸€æ¬¡ã€‚</p><pre><code class=\"language-python\">def recommend_product(df, product_name, n=3, pprint=True):\n    product_embedding = df[df['product_name'] == product_name].iloc[0].embedding\n    df[\"similarity\"] = df.embedding.apply(lambda x: cosine_similarity(x, product_embedding))\n\n    results = (\n        df.sort_values(\"similarity\", ascending=False)\n        .head(n)\n        .product_name\n    )\n    if pprint:\n        for r in results:\n            print(r)\n    return results\n\nresults = recommend_product(df, \"ã€é™é‡ã€‘OnePlus 7T Pro 8GB+256GB å…¨ç½‘é€š\", n=3)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">ã€é™é‡ã€‘OnePlus 7T Pro 8GB+256GB å…¨ç½‘é€š\nã€æ–°å“ã€‘OnePlus 7T Pro 8GB+256GB å…¨ç½‘é€š\nã€é™é‡ã€‘è£è€€V30 Pro 8GB+256GB å…¨ç½‘é€šç‰ˆ\n</code></pre><h2>é€šè¿‡FAISSåŠ é€Ÿæœç´¢è¿‡ç¨‹</h2><p>ä¸è¿‡ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç é‡Œé¢ï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ã€‚é‚£å°±æ˜¯æ¯æ¬¡æˆ‘ä»¬è¿›è¡Œæœç´¢æˆ–è€…æ¨èçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½è¦æŠŠè¾“å…¥çš„Embeddingå’Œæˆ‘ä»¬è¦æ£€ç´¢çš„æ•°æ®çš„æ‰€æœ‰Embeddingéƒ½è®¡ç®—ä¸€æ¬¡ä½™å¼¦ç›¸ä¼¼åº¦ã€‚ä¾‹å­é‡Œï¼Œæˆ‘ä»¬æ£€ç´¢çš„æ•°æ®åªæœ‰100æ¡ï¼Œä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œå³ä½¿ä¸æ˜¯ç™¾åº¦ã€è°·æ­Œé‚£æ ·çš„æœç´¢å¼•æ“ï¼Œæœç´¢å¯¹åº”çš„å†…å®¹æ¡æ•°åœ¨å‡ ç™¾ä¸‡ä¸Šåƒä¸‡çš„æƒ…å†µä¹Ÿä¸åœ¨å°‘æ•°ã€‚å¦‚æœæ¯æ¬¡æœç´¢éƒ½è¦è®¡ç®—å‡ ç™¾ä¸‡æ¬¡ä½™å¼¦è·ç¦»ï¼Œé‚£é€Ÿåº¦è‚¯å®šæ…¢å¾—ä¸è¡Œã€‚</p><p>è¿™ä¸ªé—®é¢˜ä¹Ÿæœ‰è§£å†³åŠæ³•ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€äº›å‘é‡æ•°æ®åº“ï¼Œæˆ–è€…èƒ½å¤Ÿå¿«é€Ÿæœç´¢ç›¸ä¼¼æ€§çš„è½¯ä»¶åŒ…å°±å¥½äº†ã€‚æ¯”å¦‚ï¼Œæˆ‘æ¯”è¾ƒæ¨èä½ ä½¿ç”¨Facebookå¼€æºçš„Faissè¿™ä¸ªPythonåŒ…ï¼Œå®ƒçš„å…¨ç§°å°±æ˜¯Facebook AI Similarity Searchï¼Œä¹Ÿå°±æ˜¯å¿«é€Ÿè¿›è¡Œé«˜ç»´å‘é‡çš„ç›¸ä¼¼æ€§æœç´¢ã€‚</p><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç æ”¹å†™ä¸€ä¸‹ï¼Œå…ˆæŠŠDataFrameé‡Œé¢è®¡ç®—å¥½çš„Embeddingå‘é‡éƒ½åŠ è½½åˆ°Faissçš„ç´¢å¼•é‡Œï¼Œç„¶åè®©Faisså¸®æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°æœ€ç›¸ä¼¼çš„å‘é‡ï¼Œæ¥çœ‹çœ‹æ•ˆæœæ€ä¹ˆæ ·ã€‚</p><p>å½“ç„¶ï¼ŒæŒ‰ç…§æƒ¯ä¾‹æˆ‘ä»¬è¿˜æ˜¯éœ€è¦å…ˆå®‰è£…Faissè¿™ä¸ªPythonåº“ã€‚</p><pre><code class=\"language-python\">conda install -c conda-forge faiss\n</code></pre><p>æŠŠç´¢å¼•åŠ è½½åˆ°Faissé‡Œé¢éå¸¸å®¹æ˜“ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠæ•´ä¸ªçš„Embeddingå˜æˆä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œæ•´ä¸ªåŠ è½½åˆ°Faissé‡Œé¢å°±å¥½äº†ã€‚åœ¨åŠ è½½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦å®šä¹‰å¥½Faissç´¢å¼•çš„ç»´åº¦æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬Embeddingå‘é‡çš„ç»´åº¦æ•°ã€‚</p><pre><code class=\"language-python\">import faiss\nimport numpy as np\n\ndef load_embeddings_to_faiss(df):\n    embeddings = np.array(df['embedding'].tolist()).astype('float32')\n    index = faiss.IndexFlatL2(embeddings.shape[1])\n    index.add(embeddings)\n    return index\n\nindex = load_embeddings_to_faiss(df)\n</code></pre><p>è€Œæœç´¢Faissä¹Ÿéå¸¸å®¹æ˜“ï¼Œæˆ‘ä»¬æŠŠæŸ¥è¯¢å˜æˆEmbeddingï¼Œç„¶åå†æŠŠEmbeddingè½¬æ¢æˆä¸€ä¸ªnumpyçš„arrayå‘é‡ï¼Œç„¶åç›´æ¥å¯¹åˆšæ‰ç”Ÿæˆçš„ç´¢å¼• index è°ƒç”¨ search æ–¹æ³•ï¼Œå¹¶ä¸”æŒ‡å®šè¿”å›çš„ç»“æœæ•°é‡å°±å¯ä»¥äº†ã€‚</p><p>è¿”å›æ‹¿åˆ°çš„ï¼Œåªæœ‰ç´¢å¼•çš„indexï¼Œä¹Ÿå°±æ˜¯åŠ è½½åœ¨Faissé‡Œé¢çš„ç¬¬å‡ ä¸ªç´¢å¼•ã€‚æˆ‘ä»¬è¿˜æ˜¯è¦æ ¹æ®è¿™ä¸ªï¼Œåœ¨DataFrameé‡Œé¢ï¼ŒåæŸ¥åˆ°å¯¹åº”çš„æ˜¯DataFrameé‡Œé¢çš„ç¬¬å‡ è¡Œï¼Œä»¥åŠè¿™ä¸€è¡Œå•†å“çš„æ ‡é¢˜æ˜¯ä»€ä¹ˆï¼Œå°±èƒ½è·å¾—æœç´¢çš„ç»“æœã€‚</p><pre><code class=\"language-python\">def search_index(index, df, query, k=5):\n    query_vector = np.array(get_embedding(query, engine=embedding_model)).reshape(1, -1).astype('float32')\n    distances, indexes = index.search(query_vector, k)\n\n    results = []\n    for i in range(len(indexes)):\n        product_names = df.iloc[indexes[i]]['product_name'].values.tolist()\n        results.append((distances[i], product_names))    \n    return results\n\nproducts = search_index(index, df, \"è‡ªç„¶æ·¡é›…èƒŒåŒ…\", k=3)\n\nfor distances, product_names in products:\n    for i in range(len(distances)):\n        print(product_names[i], distances[i])\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">ã€æ–°å“ã€‘æ½®æµç®€çº¦å¯çˆ±æ—¶å°šåŒè‚©æ–œæŒåŒ… 0.22473168\nã€ä¼˜æƒ ã€‘ç²¾è‡´å°å·§å¯çˆ±åŒè‚©æ–œæŒåŒ… 0.22881898\nã€æ–°å“ã€‘å°æ¸…æ–°ç™¾æ­æ‹¼è‰²å¥³å£«å•è‚©æ–œæŒåŒ… 0.22901852\n</code></pre><p>æˆ‘ä»¬åŒæ ·ç”¨â€œè‡ªç„¶æ·¡é›…èƒŒåŒ…â€è¿™ä¸ªæœç´¢è¯ï¼Œå¯ä»¥çœ‹åˆ°æœç´¢ç»“æœå’Œä¹‹å‰æˆ‘ä»¬è‡ªå·±è®¡ç®—ä½™å¼¦è·ç¦»æ’åºçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p><p>Faissçš„åŸç†ï¼Œæ˜¯é€šè¿‡ANNè¿™æ ·çš„è¿‘ä¼¼æœ€è¿‘é‚»çš„ç®—æ³•ï¼Œå¿«é€Ÿå®ç°ç›¸ä¼¼æ€§çš„æœç´¢ã€‚å¦‚æœä½ æƒ³è¿›ä¸€æ­¥äº†è§£Faissçš„åŸç†ï¼Œä½ ä¹Ÿå¯ä»¥å»é—®é—®ChatGPTã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/y2/bac528488936d4d2b5d6e22d983d6yy2.png?wh=688x652\" alt=\"å›¾ç‰‡\"></p><p>Faissè¿™ä¸ªåº“èƒ½å¤ŸåŠ è½½çš„æ•°æ®é‡ï¼Œå—é™äºæˆ‘ä»¬çš„å†…å­˜å¤§å°ã€‚å¦‚æœä½ çš„æ•°æ®é‡è¿›ä¸€æ­¥å¢é•¿ï¼Œå°±éœ€è¦é€‰ç”¨ä¸€äº›å‘é‡æ•°æ®åº“æ¥è¿›è¡Œæœç´¢ã€‚æ¯”å¦‚OpenAIå°±æ¨èäº† <a href=\"https://www.pinecone.io/\">Pinecone</a> å’Œ <a href=\"https://weaviate.io/\">Weaviate</a>ï¼Œå‘¨å›´ä¹Ÿæœ‰ä¸å°‘å›¢é˜Ÿä½¿ç”¨çš„æ˜¯ <a href=\"https://milvus.io/\">Milvus</a> è¿™ä¸ªå›½äººå¼€æºçš„äº§å“ã€‚</p><p>å½“ç„¶ï¼Œæ— è®ºæ˜¯æœç´¢è¿˜æ˜¯æ¨èï¼Œä½¿ç”¨Embeddingçš„ç›¸ä¼¼åº¦éƒ½åªæ˜¯ä¸€ç§å¿«é€Ÿå¯åŠ¨çš„æ–¹å¼ã€‚éœ€è¦çœŸæ­£åšåˆ°æ›´å¥½çš„æ•ˆæœï¼Œä¸€å®šä¹Ÿéœ€è¦æŠ•å…¥æ›´å¤æ‚çš„ç­–ç•¥ã€‚æ¯”å¦‚æ ¹æ®ç”¨æˆ·è¡Œä¸ºçš„åé¦ˆï¼Œæ›´å¥½åœ°æ’åºæœç´¢å’Œæ¨èç»“æœã€‚ä½†æ˜¯ï¼Œå¯¹äºæä¾›ä¸€ä¸ªç®€å•çš„æœç´¢æˆ–è€…æ¨èåŠŸèƒ½æ¥è¯´ï¼Œé€šè¿‡æ–‡æœ¬çš„Embeddingçš„ç›¸ä¼¼åº¦ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¿«é€Ÿå¯åŠ¨çš„æ–¹å¼ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œç›¸ä¿¡ç»è¿‡è¿™ä¸€è®²ï¼Œä½ å·²ç»æœ‰äº†å¿«é€Ÿä¼˜åŒ–ä½ ä»¬ç°æœ‰ä¸šåŠ¡é‡Œçš„æ¨èå’Œæœç´¢åŠŸèƒ½çš„æ€è·¯äº†ã€‚è¿™ä¸€è®²é‡Œï¼Œæˆ‘ä¸»è¦æƒ³æ•™ä¼šä½ ä¸‰ä»¶äº‹æƒ…ã€‚</p><p>ç¬¬ä¸€ï¼Œæ˜¯åœ¨æ²¡æœ‰åˆé€‚çš„æµ‹è¯•æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è®©AIç»™æˆ‘ä»¬ç”Ÿæˆä¸€äº›æ•°æ®ã€‚æ—¢èŠ‚çº¦äº†åœ¨ç½‘ä¸Šæ‰¾æ•°æ®çš„æ—¶é—´ï¼Œä¹Ÿèƒ½æ ¹æ®è‡ªå·±çš„è¦æ±‚ç”Ÿæˆç‰¹å®šç‰¹å¾çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¦æ±‚åœ¨å•†å“æ ‡é¢˜é‡Œé¢æœ‰äº›ä¿ƒé”€ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>ç¬¬äºŒï¼Œæ˜¯å¦‚ä½•åˆ©ç”¨Embeddingä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ä½œä¸ºè¯­ä¹‰ä¸Šçš„ç›¸ä¼¼åº¦ï¼Œä¼˜åŒ–æœç´¢ã€‚é€šè¿‡Embeddingçš„ç›¸ä¼¼åº¦ï¼Œæˆ‘ä»¬ä¸è¦æ±‚æœç´¢è¯å’ŒæŸ¥è¯¢çš„å†…å®¹ä¹‹é—´æœ‰å®Œå…¨ç›¸åŒçš„å…³é”®å­—ï¼Œè€Œåªè¦å®ƒä»¬çš„è¯­ä¹‰ä¿¡æ¯æ¥è¿‘å°±å¥½äº†ã€‚</p><p>ç¬¬ä¸‰ï¼Œæ˜¯å¦‚ä½•é€šè¿‡Faissè¿™æ ·çš„Pythonåº“ï¼Œæˆ–è€…å…¶ä»–çš„å‘é‡æ•°æ®åº“æ¥å¿«é€Ÿè¿›è¡Œå‘é‡ä¹‹é—´çš„æ£€ç´¢ã€‚è€Œä¸æ˜¯å¿…é¡»æ¯ä¸€æ¬¡æœç´¢éƒ½å’Œæ•´ä¸ªæ•°æ®åº“è®¡ç®—ä¸€éä½™å¼¦ç›¸ä¼¼åº¦ã€‚</p><p>é€šè¿‡å¯¹äºæˆ‘ä»¬è‡ªå·±çš„æ•°æ®è®¡ç®—Embeddingï¼Œç„¶åç´¢å¼•èµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤–éƒ¨çš„çŸ¥è¯†å’Œä¿¡æ¯å¼•å…¥åˆ°ä½¿ç”¨GPTæ¨¡å‹çš„åº”ç”¨é‡Œæ¥ã€‚åé¢ï¼Œæˆ‘ä»¬è¿˜ä¼šè¿›ä¸€æ­¥å­¦ä¹ å¦‚ä½•åˆ©ç”¨è¿™äº›å¤–éƒ¨çŸ¥è¯†ï¼Œå¼€å‘æ›´åŠ å¤æ‚çš„AIåº”ç”¨ã€‚</p><h2>è¯¾åç»ƒä¹ </h2><p>æœç´¢é‡Œé¢ç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼ŒåŒæ ·çš„å…³é”®è¯æœ‰æ­§ä¹‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœç´¢â€œå°ç±³æ‰‹æœºâ€ï¼Œè¿”å›ç»“æœé‡Œä¹Ÿè®¸åº”è¯¥æœ‰â€œè£è€€V30 Proâ€ï¼Œä½†æ˜¯ä¸åº”è¯¥è¿”å›â€œé»‘é¾™æ±Ÿä¼˜è´¨å°ç±³â€ã€‚ä½ å¯ä»¥è¯•ä¸€è¯•ç”¨Embeddingè¿›è¡Œè¯­ä¹‰æœç´¢ï¼Œçœ‹çœ‹è¿˜ä¼šä¸ä¼šé‡ä¸Šè¿™æ ·çš„é—®é¢˜ï¼Ÿ</p><p>æœŸå¾…èƒ½åœ¨è¯„è®ºåŒºçœ‹åˆ°ä½ çš„åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²å†è§ã€‚</p>","neighbors":{"left":{"article_title":"å¯¼è¯»ï½œä»ä»Šå¤©å¼€å§‹ï¼Œè®©AIæˆä¸ºä½ çš„è´´èº«åŠ©ç†","id":641726},"right":{"article_title":"10ï½œAIè¿æ¥å¤–éƒ¨èµ„æ–™åº“ï¼Œè®©Llama Indexå¸¦ä½ é˜…è¯»ä¸€æœ¬ä¹¦","id":645305}},"comments":[{"had_liked":false,"id":372466,"user_name":"å»‰çƒ¨","can_delete":false,"product_type":"c1","uid":1675946,"ip_address":"ä¸Šæµ·","ucode":"8081DA9EF0FBAE","user_header":"https://static001.geekbang.org/account/avatar/00/19/92/aa/360eefd3.jpg","comment_is_top":false,"comment_ctime":1681181901,"is_pvip":false,"replies":[{"id":135969,"content":"æˆ‘ä»¬ä¹‹å‰ç”¨è¿‡å¼€æºçš„t5-baseï¼Œembeddingä¹Ÿè¿˜ä¸é”™\nä½ å¯ä»¥é€‰æ‹© flan-t5 ç³»åˆ—ï¼Œæˆ–è€…åé¢ä»‹ç»å¼€æºå¹³æ›¿çš„ sentence_transformers\nåªæ˜¯embeddingçš„è¯ï¼Œå¯ä»¥é€‰çš„è¿˜æ˜¯ä¸å°‘çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681263046,"ip_address":"ä¸Šæµ·","comment_id":372466,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œè¯·é—®æ˜¯å¦æœ‰å¼€æºçš„embeddingç»„ä»¶ï¼Œèƒ½å¤Ÿè¾¾åˆ°æˆ–æ¥è¿‘openai embeddingèƒ½åŠ›çš„ï¼Ÿèƒ½å¤Ÿç”¨äºä¸­æ–‡é—®ç­”æœç´¢","like_count":14,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613310,"discussion_content":"æˆ‘ä»¬ä¹‹å‰ç”¨è¿‡å¼€æºçš„t5-baseï¼Œembeddingä¹Ÿè¿˜ä¸é”™\nä½ å¯ä»¥é€‰æ‹© flan-t5 ç³»åˆ—ï¼Œæˆ–è€…åé¢ä»‹ç»å¼€æºå¹³æ›¿çš„ sentence_transformers\nåªæ˜¯embeddingçš„è¯ï¼Œå¯ä»¥é€‰çš„è¿˜æ˜¯ä¸å°‘çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681263047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371930,"user_name":"é‡‘î„","can_delete":false,"product_type":"c1","uid":1559128,"ip_address":"å¹¿ä¸œ","ucode":"48D0B5CB8E5F9E","user_header":"https://static001.geekbang.org/account/avatar/00/17/ca/58/6fe1854c.jpg","comment_is_top":false,"comment_ctime":1680527017,"is_pvip":false,"replies":[{"id":135742,"content":"ä¸»è¦æ˜¯å¦‚ä½•è¿ç”¨ç°åœ¨çš„AIå·¥å…·åšåº”ç”¨å¼€å‘ã€‚è‡ªç„¶è¯­è¨€æ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ ¸å¿ƒä¹Ÿä¸æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†çŸ¥è¯†ï¼Œè€Œæ˜¯æ€ä¹ˆåˆ©ç”¨å¥½å¤§è¯­è¨€æ¨¡å‹ç›´æ¥å¼€å‘åº”ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680585944,"ip_address":"ä¸Šæµ·","comment_id":371930,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¿™é—¨è¯¾ç¨‹ä¸»è¦è®²nlpå—ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612248,"discussion_content":"ä¸»è¦æ˜¯å¦‚ä½•è¿ç”¨ç°åœ¨çš„AIå·¥å…·åšåº”ç”¨å¼€å‘ã€‚è‡ªç„¶è¯­è¨€æ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ ¸å¿ƒä¹Ÿä¸æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†çŸ¥è¯†ï¼Œè€Œæ˜¯æ€ä¹ˆåˆ©ç”¨å¥½å¤§è¯­è¨€æ¨¡å‹ç›´æ¥å¼€å‘åº”ç”¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680585944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373982,"user_name":"é»„æ™ºè£","can_delete":false,"product_type":"c1","uid":1027823,"ip_address":"ç¦å»º","ucode":"3C84C8654CCB11","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/ef/cbb8d881.jpg","comment_is_top":false,"comment_ctime":1683441985,"is_pvip":false,"replies":[{"id":136848,"content":"faisså…¶å®è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œç™¾ä¸‡é‡çº§çš„faiss similarityé€šè¿‡CPUè®¡ç®—ä¹Ÿåªéœ€è¦10msä»¥å†…","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684748911,"ip_address":"ä¸Šæµ·","comment_id":373982,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¿™ä¸ªæŒºæœ‰æ„æ€çš„ã€‚ä¸è¿‡è¿™ç§æ€§èƒ½åº”è¯¥ä¼šé™ä½å¾ˆå¤šï¼Œå°±ç®—æœ‰è¿™ç§é€šè¿‡faissè®¡ç®—ã€‚åŸæ¥é€šè¿‡å€’æ’ç´¢å¼•ï¼Œç”¨å¾ˆä½çš„èµ„æºå°±å¯ä»¥å®ç°ï¼Œç”¨è¿™faiss æ•°æ®é‡ä¸€å¤§ï¼Œä¼°è®¡éƒ½è¦ç”¨æ˜¾å¡æ‰å¯ä»¥ï¼Œé‡å¤§å¯¹æ˜¾å­˜è¦æ±‚ä¹Ÿå¾ˆé«˜","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619027,"discussion_content":"faisså…¶å®è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œç™¾ä¸‡é‡çº§çš„faiss similarityé€šè¿‡CPUè®¡ç®—ä¹Ÿåªéœ€è¦10msä»¥å†…","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1684748911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372094,"user_name":"eagle","can_delete":false,"product_type":"c1","uid":1129632,"ip_address":"æ±Ÿè‹","ucode":"D7601A2AFC1D17","user_header":"https://static001.geekbang.org/account/avatar/00/11/3c/a0/8b9d5aca.jpg","comment_is_top":false,"comment_ctime":1680707461,"is_pvip":false,"replies":[{"id":135881,"content":"ç±»ä¼¼ text-ada-embedding ä¹‹ç±»çš„å°æ¨¡å‹ä¸ä¼šæ”¹å˜\nå‡çº§å¾€å¾€æ˜¯æä¾›ä¸€ä¸ªæ–°æ¨¡å‹\n\nç‰¹å®šæ¨¡å‹ä¹Ÿæœ‰å¸¦æ—¥æœŸçš„å¿«ç…§ç‰ˆæœ¬ï¼Œé€‰å–é‚£äº›å¿«ç…§ç‰ˆæœ¬å°±å¥½äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680973977,"ip_address":"æ—¥æœ¬","comment_id":372094,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¿‡å‡ å¤©openAIçš„æ¨¡å‹ç‰ˆæœ¬å‡çº§äº†ï¼Œè¿™äº›ä¿å­˜çš„embeddingä¼šå¤±æ•ˆå—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612877,"discussion_content":"ç±»ä¼¼ text-ada-embedding ä¹‹ç±»çš„å°æ¨¡å‹ä¸ä¼šæ”¹å˜\nå‡çº§å¾€å¾€æ˜¯æä¾›ä¸€ä¸ªæ–°æ¨¡å‹\n\nç‰¹å®šæ¨¡å‹ä¹Ÿæœ‰å¸¦æ—¥æœŸçš„å¿«ç…§ç‰ˆæœ¬ï¼Œé€‰å–é‚£äº›å¿«ç…§ç‰ˆæœ¬å°±å¥½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680973977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372551,"user_name":"Yezhiwei","can_delete":false,"product_type":"c1","uid":1005157,"ip_address":"åŒ—äº¬","ucode":"31E8E33688CBEC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","comment_is_top":false,"comment_ctime":1681275485,"is_pvip":false,"replies":[{"id":135979,"content":"å¯ä»¥ï¼Œä½†æ˜¯æˆ‘ä¼šå»ºè®®åè¿‡æ¥æ“ä½œã€‚æŠŠæ•°æ®åº“çš„è¡¨ä¿¡æ¯å’Œéœ€æ±‚æä¾›ç»™å¤§è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè®©å¤§è¯­è¨€æ¨¡å‹è‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢çš„SQLï¼Œä¹Ÿè®¸æ•ˆæœæ›´å¥½ä¸€äº›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681287102,"ip_address":"ä¸Šæµ·","comment_id":372551,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¯·é—®è€å¸ˆå¯ä»¥æŠŠå…³ç³»å‹æ•°æ®åº“çš„ç»“æ„åŒ–æ•°æ®embedding åˆ°å‘é‡æ•°æ®åº“å—ï¼Ÿæ¯”å¦‚è´¢åŠ¡æŠ¥è¡¨çš„æ•°æ®ï¼Œç„¶åé€šè¿‡è‡ªç„¶è¯­è¨€çš„æ–¹å¼æŸ¥è¯¢æ•°æ®ï¼Œè°¢è°¢","like_count":3,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613359,"discussion_content":"å¯ä»¥ï¼Œä½†æ˜¯æˆ‘ä¼šå»ºè®®åè¿‡æ¥æ“ä½œã€‚æŠŠæ•°æ®åº“çš„è¡¨ä¿¡æ¯å’Œéœ€æ±‚æä¾›ç»™å¤§è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè®©å¤§è¯­è¨€æ¨¡å‹è‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢çš„SQLï¼Œä¹Ÿè®¸æ•ˆæœæ›´å¥½ä¸€äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681287102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1005157,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","nickname":"Yezhiwei","note":"","ucode":"31E8E33688CBEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613389,"discussion_content":"ç¡®å®è¿™ä¹ˆåšäº†ï¼Œç”¨ ChatGPT ç”Ÿæˆ SQLï¼Œä¹Ÿçœ‹åˆ°äº†åˆ«äººçš„å¼€æºé¡¹ç›®ï¼Œä¸ªäººè§‰å¾—æ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼Œç›®å‰çš„æ–¹æ³•æ˜¯ä¼˜åŒ–å„ç§æƒ…å†µçš„æé—®æ¨¡æ¿ï¼Œè¿™æ ·çš„é—®é¢˜å°±æ˜¯ä¸æ–­çš„å¢åŠ æ¨¡æ¿ï¼Œä¹Ÿä¸èƒ½ä¿è¯å„ç§æƒ…å†µéƒ½èƒ½è¦†ç›–åˆ°","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1681298533,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613359,"ip_address":"åŒ—äº¬","group_id":0},"score":613389,"extra":""},{"author":{"id":1180256,"avatar":"https://static001.geekbang.org/account/avatar/00/12/02/60/8b9572ac.jpg","nickname":"å°é£","note":"","ucode":"A5D04FF18880C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":648084,"discussion_content":"è€å¸ˆï¼Œç°åœ¨text2sqlæ¨¡å‹æœ‰å•¥å¥½çš„æ¨èå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721043964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613359,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":648084,"extra":""}]}]},{"had_liked":false,"id":373225,"user_name":"Jelly","can_delete":false,"product_type":"c1","uid":2861619,"ip_address":"å¹¿ä¸œ","ucode":"877CC61AF0A7F3","user_header":"https://static001.geekbang.org/account/avatar/00/2b/aa/33/5e063968.jpg","comment_is_top":false,"comment_ctime":1682260366,"is_pvip":false,"replies":[{"id":136511,"content":"æœ‰å‡ ç§åšæ³•\n1. ä¸åªæ˜¯ç”¨embeddingæ¥åšæ–‡æœ¬å¬å›ï¼Œllamaè¿˜æä¾›äº†æ›´å¤šçš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æ·±å…¥çœ‹ä¸€éæ–‡æ¡£ï¼Œè¯•ä¸€ä¸‹å…¶ä»–çš„indices\n2. å¯¹äºæ–‡æœ¬ï¼Œé€šè¿‡ self-askï¼Œå…ˆè®©OpenAIç”Ÿæˆå¾ˆå¤šé’ˆå¯¹å†…å®¹çš„é—®é¢˜ã€‚ç„¶åå’Œé—®é¢˜åšåŒ¹é…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1683091598,"ip_address":"ä¸Šæµ·","comment_id":373225,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"å½“ä½¿ç”¨Llama Indexå¯¼å…¥ä¸€ç¯‡äº§å“ä»‹ç»çš„æ—¶å€™ï¼Œé—®ï¼šæœ¬äº§å“çš„ç‰¹å¾æ˜¯ä»€ä¹ˆï¼Œå‘é‡åŒ¹é…ä¸å‡†ç¡®ã€‚ä½¿ç”¨XXXçš„ç‰¹å¾å°±æ²¡é—®é¢˜ã€‚å½“å¯¼å…¥å¹´æŠ¥çš„æ—¶å€™é—®ï¼š2022å¹´è¥æ”¶æ˜¯å¤šå°‘ï¼Ÿå‘é‡åŒ¹é…ä¹Ÿä¸å‡†ç¡®ï¼Œç›´æ¥é—®ï¼šè¥æ”¶æ˜¯å¤šå°‘å°±å¯ä»¥ã€‚è¯·é—®æ€ä¹ˆè®©ç”¨æˆ·é—®çš„é—®é¢˜æ›´æ™ºèƒ½ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":616752,"discussion_content":"æœ‰å‡ ç§åšæ³•\n1. ä¸åªæ˜¯ç”¨embeddingæ¥åšæ–‡æœ¬å¬å›ï¼Œllamaè¿˜æä¾›äº†æ›´å¤šçš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥æ·±å…¥çœ‹ä¸€éæ–‡æ¡£ï¼Œè¯•ä¸€ä¸‹å…¶ä»–çš„indices\n2. å¯¹äºæ–‡æœ¬ï¼Œé€šè¿‡ self-askï¼Œå…ˆè®©OpenAIç”Ÿæˆå¾ˆå¤šé’ˆå¯¹å†…å®¹çš„é—®é¢˜ã€‚ç„¶åå’Œé—®é¢˜åšåŒ¹é…ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1683091598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374265,"user_name":"Joe Black","can_delete":false,"product_type":"c1","uid":1052528,"ip_address":"åŒ—äº¬","ucode":"21FE222A286445","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/70/cdef7a3d.jpg","comment_is_top":false,"comment_ctime":1683797272,"is_pvip":false,"replies":[{"id":136852,"content":"embeddingå°±æ˜¯åŸºç¡€æ¨¡å‹å•Šï¼Œåªæ˜¯ä¸æ˜¯æ‹¿æ¥ç”Ÿæˆæ–‡æœ¬ï¼Œåªæ˜¯ç”¨äº†æœ€åä¸€å±‚Transformeré‡Œçš„è¾“å‡ºå‘é‡ã€‚\n\næ‰€ä»¥çš„ç¡®æ˜¯è¶Šå¤§çš„æ¨¡å‹ï¼ŒembeddingæŒ‰é“ç†åº”è¯¥è¶Šå¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684749353,"ip_address":"ä¸Šæµ·","comment_id":374265,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"embeddingçš„å®ç°æ˜¯å¦ä¹Ÿéœ€è¦åŸºç¡€æ¨¡å‹çš„çŸ¥è¯†æ²‰æ·€å‘¢ï¼Ÿæ¯”å¦‚æ–‡å­—ä¸Šè™½ç„¶ä¸ç›¸åŒï¼Œä½†æ˜¯å«ä¹‰ç›¸è¿‘çš„å¥å­ç”Ÿæˆçš„å‘é‡æ˜¯ç›¸ä¼¼çš„ï¼Œè¿™ä¸ªæ˜¯ä¾é æ¨¡å‹ä¹‹å‰å­¦ä¹ çš„çŸ¥è¯†æ˜¯å—ï¼Ÿé‚£è¿™æ ·è‡ªç„¶å°±æ˜¯è¶Šå¤§çš„æ¨¡å‹embeddingçš„æ•ˆæœè¶Šå¥½ï¼Ÿå¯ä»¥è¿™æ ·ç†è§£å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619032,"discussion_content":"embeddingå°±æ˜¯åŸºç¡€æ¨¡å‹å•Šï¼Œåªæ˜¯ä¸æ˜¯æ‹¿æ¥ç”Ÿæˆæ–‡æœ¬ï¼Œåªæ˜¯ç”¨äº†æœ€åä¸€å±‚Transformeré‡Œçš„è¾“å‡ºå‘é‡ã€‚\n\næ‰€ä»¥çš„ç¡®æ˜¯è¶Šå¤§çš„æ¨¡å‹ï¼ŒembeddingæŒ‰é“ç†åº”è¯¥è¶Šå¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684749353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372460,"user_name":"æ¸”æ¨µè€•è¯»","can_delete":false,"product_type":"c1","uid":1042735,"ip_address":"åŒ—äº¬","ucode":"2C4E141C59381F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e9/2f/c5e5b809.jpg","comment_is_top":false,"comment_ctime":1681177069,"is_pvip":false,"replies":[{"id":135968,"content":"pip install faiss-cpu æˆ–è€… pip install faiss-gpu","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681262945,"ip_address":"ä¸Šæµ·","comment_id":372460,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¯·é—®æœ‰é‡åˆ°å®‰è£…faissæ—¶æç¤ºï¼šPackagesNotFoundErrorçš„æ²¡ï¼Ÿæ”¹ä¸ºpip install faiss æŠ¥é”™ï¼š\nERROR: Could not find a version that satisfies the requirement faiss (from versions: none)\nERROR: No matching distribution found for faiss","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613309,"discussion_content":"pip install faiss-cpu æˆ–è€… pip install faiss-gpu","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681262945,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2238528,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","nickname":"å°ç†æƒ³ã€‚","note":"","ucode":"EDC35A907570DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624392,"discussion_content":"æˆ‘ç”¨pip install faiss-gpuå¥½ä½¿äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690531497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372028,"user_name":"xbc","can_delete":false,"product_type":"c1","uid":2187437,"ip_address":"æµ·å—","ucode":"03F1FD7B8CA32F","user_header":"https://static001.geekbang.org/account/avatar/00/21/60/ad/03351e6e.jpg","comment_is_top":false,"comment_ctime":1680606426,"is_pvip":false,"replies":[{"id":135887,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680974348,"ip_address":"æ—¥æœ¬","comment_id":372028,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"cosine_similarity ä¹Ÿå¯ä»¥ä¼ å…¥å¤šä¸ªembeddings. \n\nscores = cosine_similarity(list[list[float]], list[float])\nindices = np.argsort(scores)[::-1]","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612883,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680974348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ—¥æœ¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371883,"user_name":"Oliå¼ å¸†","can_delete":false,"product_type":"c1","uid":1338098,"ip_address":"åŒ—äº¬","ucode":"6E60A370C3C14A","user_header":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","comment_is_top":false,"comment_ctime":1680486837,"is_pvip":false,"replies":[{"id":135711,"content":"è¿™ä¸ªåŠæ³•å½“ç„¶ä¸æ˜¯ä¸å¯ä»¥ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆè¦é™åˆ¶è‡ªå·±ç”¨é‚£ä¹ˆå°çš„å†…å­˜å‘¢ï¼Ÿæ¯•ç«Ÿç°åœ¨æœåŠ¡å™¨çš„æˆæœ¬å¹¶ä¸é«˜å•Šã€‚\n\nä¸ç”¨faissï¼Œç›´æ¥æä¸ªäº‘æ‰˜ç®¡çš„å‘é‡æ•°æ®åº“å¥½äº†ï¼Ÿå¤§éƒ¨åˆ†éƒ½æœ‰å…è´¹æ¡£ä½éƒ½æ¯”ä½ è‡ªå·±çš„100æ¡èµ„æºè¦å¤šå•Šï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680581212,"ip_address":"ä¸Šæµ·","comment_id":371883,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€ƒè™‘åˆ°æˆ‘çš„æœåŠ¡å™¨ç¡¬ä»¶èµ„æºæœ‰é™ï¼ˆ300MBçš„è½¯é™åˆ¶ï¼Œ500MBçš„ç¡¬é™åˆ¶ï¼Œç°åœ¨å·²ç»å åˆ°äº†450MBï¼‰ï¼Œè€Œä¸”æˆ‘å·²ç»åœ¨è¿›è¡Œå…¶ä»–ä»»åŠ¡æ—¶ä½¿ç”¨äº†å¾ˆå¤šèµ„æºï¼Œå½“æˆ‘åœ¨OpenAIä¹‹ä¸Šæ„å»ºAIæœºå™¨äººæ—¶ï¼Œæˆ‘è€ƒè™‘ä½¿ç”¨è¿™ä¸ªç­–ç•¥ã€‚è¯·è€å¸ˆçœ‹çœ‹æ˜¯å¦èƒ½è¡Œå¾—é€šã€‚\n\næ¯å½“ç”¨æˆ·å‘é€è¯·æ±‚æ—¶ï¼Œæˆ‘é¦–å…ˆæ£€æµ‹ä»–çš„æ„å›¾ã€‚æˆ‘å¯ä»¥ä½¿ç”¨å°çš„embeddingsæ¥å¸®åŠ©æ„å›¾æ£€æµ‹ã€‚ç”šè‡³å¯ä»¥æœ‰å…¶ä»–æ–¹å¼ï¼Œå¦‚ç¼“å­˜å’Œé¢„å…ˆä¸€äº›æ„å›¾è®©ç”¨æˆ·æ¥ç‚¹å‡»ï¼Œæ¥åŠ é€Ÿæ„å›¾æ£€æµ‹ã€‚\n\nåœ¨æˆ‘æ£€æµ‹åˆ°ç”¨æˆ·æ„å›¾åï¼Œæˆ‘å¯ä»¥è°ƒç”¨ä¸åŒçš„embeddingsåº“ã€‚ä¾‹å¦‚ï¼Œæˆ‘çš„å®¢æœembeddingsåº“å°†ä»…æœ‰50ä¸ªé¡¹ç›®ï¼Œè¿™å¯¹äºä½™å¼¦ç›¸ä¼¼æ€§æ¥è¯´éå¸¸å¿«é€Ÿå’Œé«˜æ•ˆã€‚æˆ‘è¿˜å¯ä»¥å°†æ–°é—»embeddingsåº“é™åˆ¶ä¸ºæœ€æ–°çš„100ç¯‡æ–‡ç« ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è½»æ¾åœ°é€šè¿‡ä½™å¼¦ç›¸ä¼¼æ€§å¤„ç†ã€‚\n\nå°½ç®¡è¿™ç§æ–¹æ³•å¯èƒ½ä¸åƒæœç´¢å•ä¸ªå¤§å‹åµŒå…¥æ•°æ®åº“é‚£æ ·å‡†ç¡®ï¼Œä½†å¦‚æœæˆ‘ä¸ºç”¨æˆ·æä¾›è¶³å¤Ÿçš„æŒ‡å¯¼ï¼Œæ‚¨è®¤ä¸ºå®ƒèƒ½äº§ç”Ÿè¶³å¤Ÿå¥½çš„ç”¨æˆ·ä½“éªŒå—ï¼Ÿä¾‹å¦‚ï¼Œåœ¨æˆ‘çš„ç•Œé¢ä¸­ï¼Œæˆ‘å¯ä»¥å‘ç”¨æˆ·æ˜¾ç¤ºä»–ä»¬å½“å‰æ­£åœ¨è®¨è®ºâ€œæœ€æ–°çš„AIå‘å±•â€æˆ–â€œå®¢æˆ·æœåŠ¡â€ã€‚ç„¶åï¼Œä¹Ÿå¯ä»¥å…è®¸ç”¨æˆ·å¿«é€Ÿåœ°æ”¹å˜å½“å‰çš„è¯é¢˜ã€‚\n\nè¯·è€å¸ˆçœ‹çœ‹ï¼Œè¿™ä¸ªåŠæ³•èƒ½ä¸èƒ½è·‘é€šã€‚è¿˜æ²¡æœ‰ä»€ä¹ˆæˆ‘æ²¡æœ‰æƒ³åˆ°çš„åœ°æ–¹ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612210,"discussion_content":"è¿™ä¸ªåŠæ³•å½“ç„¶ä¸æ˜¯ä¸å¯ä»¥ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆè¦é™åˆ¶è‡ªå·±ç”¨é‚£ä¹ˆå°çš„å†…å­˜å‘¢ï¼Ÿæ¯•ç«Ÿç°åœ¨æœåŠ¡å™¨çš„æˆæœ¬å¹¶ä¸é«˜å•Šã€‚\n\nä¸ç”¨faissï¼Œç›´æ¥æä¸ªäº‘æ‰˜ç®¡çš„å‘é‡æ•°æ®åº“å¥½äº†ï¼Ÿå¤§éƒ¨åˆ†éƒ½æœ‰å…è´¹æ¡£ä½éƒ½æ¯”ä½ è‡ªå·±çš„100æ¡èµ„æºè¦å¤šå•Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680581212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","nickname":"Oliå¼ å¸†","note":"","ucode":"6E60A370C3C14A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612358,"discussion_content":"æ‰¾åˆ°äº†å…³äºConePineçš„ä¿¡æ¯ï¼Œè¿™é‡Œä¹Ÿæœ‰å¦‚ä½•ä¸OpenAIæ•´åˆçš„æ–¹å¼ï¼šhttps://docs.pinecone.io/docs/openai","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1680617767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","nickname":"Oliå¼ å¸†","note":"","ucode":"6E60A370C3C14A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612353,"discussion_content":"æ„Ÿè°¢è€å¸ˆçš„æŒ‡å¯¼ï¼Œæˆ‘å»ç ”ç©¶ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680615141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373829,"user_name":"Devon","can_delete":false,"product_type":"c1","uid":1069991,"ip_address":"ä¸Šæµ·","ucode":"45442792ABEC73","user_header":"https://static001.geekbang.org/account/avatar/00/10/53/a7/83bf4578.jpg","comment_is_top":false,"comment_ctime":1683213999,"is_pvip":false,"replies":[{"id":136825,"content":"æˆ‘è§‰å¾—è¿™ä¸ªæ²¡æœ‰å¿…è¦ç”¨Embeddingå§ï¼Œå› ä¸ºå…¬å¸åç§°é‡Œé¢çš„â€œè¯­ä¹‰â€ä¿¡æ¯å¾ˆå°‘ï¼Œæ¨¡ç³Šæœç´¢æ›´å¤šæ˜¯åŸºäºå­—æˆ–è€…éŸ³çš„\n\næŒ‰ç…§å•ä¸ªå­—ï¼Œæˆ–è€…æ‹¼éŸ³ï¼Œåšä¸ªTrie Treeå¯èƒ½æ›´åˆé€‚ï¼Ÿæˆ–è€…ç®—ä¸€ä¸‹æŒ‰ç…§å­—æˆ–è€…å­—çš„æ‹¼éŸ³çš„å­—ç¬¦ç¼–è¾‘è·ç¦»æ¥åšæœç´¢æ’åºå°±å¥½äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741660,"ip_address":"ä¸Šæµ·","comment_id":373829,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œå¯¹äºå‡ åä¸‡ä¸ªç²¾å‡†çš„ä¸­æ–‡å…¬å¸åç§°æˆ–è€…å•ä½åœ°å€è¿›è¡Œå‘é‡åŒ–ä¹‹åï¼Œé¢„å­˜è¿›DataFrameä½œä¸ºä¹‹åçš„æœç´¢æºï¼Œä½¿ç”¨æ—¶æ ¹æ®è¾ƒä¸ºâ€œè„â€çš„å…¬å¸åç§°æˆ–è€…å•ä½åœ°å€è¿›è¡ŒåŒ¹é…ï¼Œåœ¨è¿™æ ·çš„æ“ä½œä¸­å¯¹äºä¸­æ–‡å…¬å¸åç§°æˆ–è€…å•ä½åœ°å€çš„å‘é‡åŒ–é¢„å¤„ç†ï¼Œæœ‰ä»€ä¹ˆæ¨èçš„æ–¹å¼æˆ–è€…æ¨¡å‹å—ï¼Ÿç”¨OpenAI embeddingçš„è¯ï¼Œè´¹ç”¨å’Œæ—¶é—´ä¼šä¸ä¼šä¸å¤ªç»æµï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618992,"discussion_content":"æˆ‘è§‰å¾—è¿™ä¸ªæ²¡æœ‰å¿…è¦ç”¨Embeddingå§ï¼Œå› ä¸ºå…¬å¸åç§°é‡Œé¢çš„â€œè¯­ä¹‰â€ä¿¡æ¯å¾ˆå°‘ï¼Œæ¨¡ç³Šæœç´¢æ›´å¤šæ˜¯åŸºäºå­—æˆ–è€…éŸ³çš„\n\næŒ‰ç…§å•ä¸ªå­—ï¼Œæˆ–è€…æ‹¼éŸ³ï¼Œåšä¸ªTrie Treeå¯èƒ½æ›´åˆé€‚ï¼Ÿæˆ–è€…ç®—ä¸€ä¸‹æŒ‰ç…§å­—æˆ–è€…å­—çš„æ‹¼éŸ³çš„å­—ç¬¦ç¼–è¾‘è·ç¦»æ¥åšæœç´¢æ’åºå°±å¥½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372345,"user_name":"ä¸€å¶","can_delete":false,"product_type":"c1","uid":3577168,"ip_address":"ç¦å»º","ucode":"21E5455D0814E5","user_header":"https://static001.geekbang.org/account/avatar/00/36/95/50/01199ae9.jpg","comment_is_top":false,"comment_ctime":1681011160,"is_pvip":false,"replies":[{"id":135940,"content":"å¤šä¹…ä¸€ä¸ªä¾‹å­æ˜¯æ¨èå·²ç»ç®—è¿‡embeddingçš„å•†å“ï¼Œæ‰€ä»£ç æ˜¯å…ˆæ ¹æ®å•†å“çš„indexåœ¨faissé‡Œæ‰¾åˆ°å®ƒçš„å‘é‡å‘€\n\nè¿™ä¸ªå‘é‡æ˜¯å‰é¢è°ƒç”¨OpenAIå·²ç»è®¡ç®—è¿‡äº†çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681129512,"ip_address":"ç¾å›½","comment_id":372345,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆ åœ¨æœ€åä¸€ä¸ªä¾‹å­ä¸­\n\ndef search_index(index, df, query, k=5):\n\nè¿™é‡Œé¢çš„ query ä¸ç”¨å…ˆè¿›è¡Œå‘é‡åŒ–å—? é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¸æ˜¯è¦è°ƒç”¨åˆ°Openai?\n","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613110,"discussion_content":"å¤šä¹…ä¸€ä¸ªä¾‹å­æ˜¯æ¨èå·²ç»ç®—è¿‡embeddingçš„å•†å“ï¼Œæ‰€ä»£ç æ˜¯å…ˆæ ¹æ®å•†å“çš„indexåœ¨faissé‡Œæ‰¾åˆ°å®ƒçš„å‘é‡å‘€\n\nè¿™ä¸ªå‘é‡æ˜¯å‰é¢è°ƒç”¨OpenAIå·²ç»è®¡ç®—è¿‡äº†çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681129512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1222233,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a6/59/1689ea0c.jpg","nickname":"é‡‘hb.Ryan å†·ç©ºæ°£é§•åˆ°","note":"","ucode":"CAD363576696E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618799,"discussion_content":"Search index é‡Œ*é¢è°ƒç”¨äº†embeddingå“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684565099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372344,"user_name":"ä¸€å¶","can_delete":false,"product_type":"c1","uid":3577168,"ip_address":"ç¦å»º","ucode":"21E5455D0814E5","user_header":"https://static001.geekbang.org/account/avatar/00/36/95/50/01199ae9.jpg","comment_is_top":false,"comment_ctime":1681010515,"is_pvip":false,"replies":[{"id":135938,"content":"ç”¨faissæˆ–è€…ä¸Šmilvusæˆ‘è¯•è¿‡ç™¾ä¸‡çº§å•†å“æ¯«æ— å‹åŠ›","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1681129230,"ip_address":"ç¾å›½","comment_id":372344,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆ,è¿™æ ·çš„æœç´¢æ•ˆæœçš„æ•ˆç‡å¦‚ä½•? å¦‚æœæˆ‘æ˜¯ä¸€ä¸ªè¯æœ¯ç±»æœç´¢çš„,1ä¸‡å¤šä¸ªæ ‡é¢˜ç›´æ¥ç”¨å†…å®¹æ¥è¿›è¡Œæœç´¢çš„è¯å¯ä»¥?","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613107,"discussion_content":"ç”¨faissæˆ–è€…ä¸Šmilvusæˆ‘è¯•è¿‡ç™¾ä¸‡çº§å•†å“æ¯«æ— å‹åŠ›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681129230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":3577168,"avatar":"https://static001.geekbang.org/account/avatar/00/36/95/50/01199ae9.jpg","nickname":"ä¸€å¶","note":"","ucode":"21E5455D0814E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613451,"discussion_content":"è€å¸ˆï¼Œfaisså¦‚æœç™¾ä¸‡çº§ï¼Œå†…å­˜å ç”¨å¤šå°‘ï¼Œæˆ‘åœ¨æƒ³ç®€å•çš„å°±ç›´æ¥ç”¨faiss","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681314869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613107,"ip_address":"ç¦å»º","group_id":0},"score":613451,"extra":""},{"author":{"id":1009518,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/6e/f5ee46e8.jpg","nickname":"æµ·æ»¨","note":"","ucode":"F1B94D2DB944DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3577168,"avatar":"https://static001.geekbang.org/account/avatar/00/36/95/50/01199ae9.jpg","nickname":"ä¸€å¶","note":"","ucode":"21E5455D0814E5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":614044,"discussion_content":"å¯ä»¥ç®€å•è®¡ç®—ä¸‹ï¼Œç‰¹å¾å‘é‡é‡Œä¸€ä¸ªæ•°å­— float ç±»å‹å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œå¦‚æœç‰¹å¾å‘é‡æ˜¯ 1024 ç»´åº¦çš„ï¼Œé‚£ä¹ˆä¸€æ¡ç‰¹å¾å‘é‡ä¼šå ç”¨ 4KB å­˜å‚¨ã€‚ä¸€ç™¾ä¸‡æ•°æ®çš„è¯ï¼Œå·®ä¸å¤šå°±æ˜¯ 4GB çš„å†…å­˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681645701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613451,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":614044,"extra":""}]}]},{"had_liked":false,"id":372238,"user_name":"å¹¼å„¿ç¼–ç¨‹æ•™å­¦","can_delete":false,"product_type":"c1","uid":1237199,"ip_address":"æµ™æ±Ÿ","ucode":"F13F3150E6CAE9","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/cf/43f201f2.jpg","comment_is_top":false,"comment_ctime":1680866587,"is_pvip":false,"replies":[{"id":135861,"content":"ä¸ä¼šï¼Œè¿™ä¸ªå°±æ˜¯åœ¨ä½ æœ¬æœºä¸Šè®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç›¸ä¼¼åº¦è€Œå·²","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1680972406,"ip_address":"ä¸­å›½é¦™æ¸¯","comment_id":372238,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è¯·æ•™è€å¸ˆï¼Œ get_embeddingå‡½æ•°ä¼šè¯·æ±‚openaiã€‚é‚£ä¹ˆcosine_similarityå‡½æ•°æ˜¯å¦ä¼šè¯·æ±‚openaiæ¥å£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612856,"discussion_content":"ä¸ä¼šï¼Œè¿™ä¸ªå°±æ˜¯åœ¨ä½ æœ¬æœºä¸Šè®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç›¸ä¼¼åº¦è€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680972406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2031550,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/ff/be/a8750de7.jpg","nickname":"ç”°ä¼šå†›","note":"","ucode":"7AE52133B18C0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615134,"discussion_content":"è¿™ä¸ªèƒ½åšåˆ°è¯­ä¹‰åˆ†æå—ï¼Œè¿˜æ˜¯ç”Ÿç¡¬çš„åŒ¹é…ç›¸ä¼¼åº¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682062384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372911,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"æµ™æ±Ÿ","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1681793057,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"åŸæ¥å•†å“æœç´¢ã€æ¨èç³»ç»Ÿéƒ½å·²ç»ä½¿ç”¨ä¸Šäº† AIï¼Œç¡®å®å¼ºå¤§","like_count":1},{"had_liked":false,"id":394406,"user_name":"Geek_78a551","can_delete":false,"product_type":"c1","uid":3784461,"ip_address":"åŒ—äº¬","ucode":"CCADD2F766E193","user_header":"","comment_is_top":false,"comment_ctime":1726722053,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"taobao_product_title.parquet ä½ æŠŠæ‰€æœ‰ç›¸å…³ä¸­é—´æ–‡ä»¶æ”¾ä¸€ä¸ªä»£ç åº“é‡Œåˆ†äº«å§","like_count":0},{"had_liked":false,"id":388292,"user_name":"Jahng","can_delete":false,"product_type":"c1","uid":1325514,"ip_address":"å¹¿ä¸œ","ucode":"5D5789EAAC4739","user_header":"https://static001.geekbang.org/account/avatar/00/14/39/ca/4a07bfd8.jpg","comment_is_top":false,"comment_ctime":1709809023,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"å¾ˆå¥½å¥‡æˆ‘ä»¬æç¤ºè¯­è¦æ·˜å®æ•°æ®ï¼Œgptæ˜¯æ€ä¹ˆæ‹¿åˆ°è¿™ä¸ªæ•°æ®çš„ï¼Œæ˜¯å› ä¸ºè®­ç»ƒé›†é‡Œé¢æœ‰æ•°æ®ï¼Œè¿˜æ˜¯è”ç½‘æ‹¿çš„å®æ—¶æ•°æ®ï¼Ÿä¸ç®¡æ˜¯å“ªç§ï¼Œæˆ‘åé¢éƒ½æœ‰éå¸¸å¤šçš„ç–‘é—®ğŸ¤”ï¸","like_count":0},{"had_liked":false,"id":380784,"user_name":"Geek_f0daf6","can_delete":false,"product_type":"c1","uid":3172264,"ip_address":"å¹¿ä¸œ","ucode":"A8363E253E1C60","user_header":"","comment_is_top":false,"comment_ctime":1694150668,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"å¯ä»¥ç”¨ç¾Šé©¼2å¤§æ¨¡å‹å—","like_count":0},{"had_liked":false,"id":378619,"user_name":"å°ç†æƒ³ã€‚","can_delete":false,"product_type":"c1","uid":2238528,"ip_address":"åŒ—äº¬","ucode":"EDC35A907570DB","user_header":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","comment_is_top":false,"comment_ctime":1690510477,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"taobao_product_title.parquet  è€å¸ˆè¿™ä¸ªæ–‡ä»¶å¯å¦å‘ä¸‹å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":378446,"user_name":"æ²¡è§’èœ—ç‰›","can_delete":false,"product_type":"c1","uid":1275377,"ip_address":"åŒ—äº¬","ucode":"3AF5466D0D3E08","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/9wNL7qwjpZ1NQ6VIVNsZDyJrtkhUW5e7rpqMgR1qTsouamibLZC1oOv445jVUg1BOIJib4cHiaPGKBwrskyXn8xWw/132","comment_is_top":false,"comment_ctime":1690269648,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³é—®å‡ ä¸ªé—®é¢˜ï¼š\n1ï¼š æ–‡æœ¬çš„Embeddingè·Ÿç®—æ³•æœ‰å…³ç³»ï¼Œè·Ÿå…·ä½“æŸä¸ªå¤§æ¨¡å‹æ²¡æœ‰å…³ç³»å§ï¼Ÿå¦‚æœæœ‰å…³ç³»ï¼Œæ˜¯ä»€ä¹ˆå…³ç³»\n2ï¼š å¦‚æœé—®é¢˜ä¸€è·Ÿå¤§æ¨¡å‹æ²¡å…³ç³»ï¼Œé‚£æˆ‘ä»¬åªè¦çŸ¥é“Embeddingç®—æ³•å°±å¯ä»¥å¤„ç†æ‰€æœ‰åˆ†æœ¬åˆ†ç±»ç›¸å…³çš„å·¥ä½œï¼Œéƒ½ä¸éœ€è¦å¤§æ¨¡å‹äº†\n3ï¼š å¦‚æœEmbeddingè·Ÿå¤§æ¨¡å‹æ²¡å…³ç³»ï¼Œä¸ºå•¥ä¸åŒçš„å¤§æ¨¡å‹å¤„ç†æ–‡æœ¬åˆ†ç±»çš„æ•ˆæœå·®è·å¾ˆå¤§ï¼Ÿ\n\nåˆ©ç”¨ Embedding ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ä½œä¸ºè¯­ä¹‰ä¸Šçš„ç›¸ä¼¼åº¦ï¼Œä¼˜åŒ–æœç´¢ã€‚é€šè¿‡ Embedding çš„ç›¸ä¼¼åº¦ï¼Œæˆ‘ä»¬ä¸è¦æ±‚æœç´¢è¯å’ŒæŸ¥è¯¢çš„å†…å®¹ä¹‹é—´æœ‰å®Œå…¨ç›¸åŒçš„å…³é”®å­—ï¼Œè€Œåªè¦å®ƒä»¬çš„è¯­ä¹‰ä¿¡æ¯æ¥è¿‘å°±å¥½","like_count":0,"discussions":[{"author":{"id":3682659,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Wiba6ReQVp446vhcibQYiah5tdWPiaYAwsr6dty9ZTcZS1yXW1x9OQqPpkQbz2qyWMLPIl1T89rep1tXXEC9TefdKCjt51Crvrh2KmSO5cbeZFk/132","nickname":"Geek_e3264b","note":"","ucode":"D6388103876BD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624693,"discussion_content":"è·ŸæŸä¸ªå¤§æ¨¡å‹å½“ç„¶æœ‰å…³ç³»ï¼Œç®€å•æ¥çœ‹ï¼š\nEmbeddingå°±æ˜¯æ–‡æœ¬åœ¨æ¨¡å‹ç©ºé—´ä¸­çš„ä½ç½®è¡¨ç¤º\nä¸åŒçš„æ¨¡å‹æ„é€ è¿™ä¸ªç©ºé—´çš„æ–¹å¼éƒ½ä¸æ˜¯ä¸€æ ·\nè¶Šå¤§çš„æ¨¡å‹æ„å»ºç©ºé—´è¶Šå¤§ï¼Œè¶Šæœ‰å¯èƒ½ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªæ–‡æœ¬çš„ä½ç½®\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1690858063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377140,"user_name":"çŒ¿é¸½å›","can_delete":false,"product_type":"c1","uid":1991951,"ip_address":"ç¦å»º","ucode":"8562D8C5AD3D1E","user_header":"https://static001.geekbang.org/account/avatar/00/1e/65/0f/7b9f27f2.jpg","comment_is_top":false,"comment_ctime":1687965914,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·é—®ä¸‹ï¼Œæ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œä¸ºä»€ä¹ˆç”¨å‘é‡æ•°æ®åº“è€Œä¸æ˜¯faissï¼Œåƒmilvusä¸ä¹Ÿæ˜¯in-memoryè®¡ç®—ï¼Ÿè€Œä¸”ä¸ºä»€ä¹ˆmilvuså¯¹searchè¿”å›çš„topké™åˆ¶åœ¨äº†16348ï¼Ÿfaisså¥½åƒæ²¡çœ‹åˆ°æœ‰è¿™ç§é™åˆ¶","like_count":0,"discussions":[{"author":{"id":3682659,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Wiba6ReQVp446vhcibQYiah5tdWPiaYAwsr6dty9ZTcZS1yXW1x9OQqPpkQbz2qyWMLPIl1T89rep1tXXEC9TefdKCjt51Crvrh2KmSO5cbeZFk/132","nickname":"Geek_e3264b","note":"","ucode":"D6388103876BD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624694,"discussion_content":"milvuså¹¶ä¸æ˜¯çº¯ç²¹çš„in-memoryè®¡ç®—ï¼Œåœ¨å¤„ç†å‘é‡æ•°æ®æ—¶ä¸ä»…ä¾èµ–äºå†…å­˜ï¼Œè¿˜ä¼šä½¿ç”¨ç£ç›˜å­˜å‚¨æ¥æ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨å’ŒæŸ¥è¯¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690858404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376599,"user_name":"é£ç¿”","can_delete":false,"product_type":"c1","uid":1068571,"ip_address":"ç¾å›½","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1687062986,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"è€å¸ˆæˆ‘ä»¬æƒ³ç”¨è§†é¢‘çš„å­—å¹•åšæ£€ç´¢ ç”¨ä»€ä¹ˆæŠ€æœ¯æ¯”è¾ƒå¥½å‘€","like_count":0,"discussions":[{"author":{"id":3682659,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Wiba6ReQVp446vhcibQYiah5tdWPiaYAwsr6dty9ZTcZS1yXW1x9OQqPpkQbz2qyWMLPIl1T89rep1tXXEC9TefdKCjt51Crvrh2KmSO5cbeZFk/132","nickname":"Geek_e3264b","note":"","ucode":"D6388103876BD8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624695,"discussion_content":"ç”¨text-embedding-ada-002å°±å¥½ï¼Œå½“ç„¶çœŸå®æƒ…å†µçœŸå®è€ƒè™‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690858468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376214,"user_name":"å¯»è·¯äºº","can_delete":false,"product_type":"c1","uid":1195917,"ip_address":"æ±Ÿè‹","ucode":"1711F740D4D60A","user_header":"https://static001.geekbang.org/account/avatar/00/12/3f/8d/a89be8f9.jpg","comment_is_top":false,"comment_ctime":1686551554,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"æŠ¥é”™å¦‚ä¸‹ï¼šTraceback (most recent call last):\n  File &quot;C:&#47;Users&#47;liuzq&#47;Desktop&#47;Source&#47;others&#47;pythonProject&#47;lzq&#47;aigc&#47;opt_search.py&quot;, line 82, in &lt;module&gt;\n    results = search_product(df, &quot;è‡ªç„¶æ·¡é›…èƒŒåŒ…&quot;, n=3)\n  File &quot;C:&#47;Users&#47;liuzq&#47;Desktop&#47;Source&#47;others&#47;pythonProject&#47;lzq&#47;aigc&#47;opt_search.py&quot;, line 69, in search_product\n    df123[&quot;similarity&quot;] = df123.embedding.apply(lambda x: cosine_similarity(x, product_embedding))\n  File &quot;E:\\Anaconda3\\lib\\site-packages\\pandas\\core\\series.py&quot;, line 4630, in apply\n    return SeriesApply(self, func, convert_dtype, args, kwargs).apply()\n  File &quot;E:\\Anaconda3\\lib\\site-packages\\pandas\\core\\apply.py&quot;, line 1025, in apply\n    return self.apply_standard()\n  File &quot;E:\\Anaconda3\\lib\\site-packages\\pandas\\core\\apply.py&quot;, line 1076, in apply_standard\n    mapped = lib.map_infer(\n  File &quot;pandas\\_libs\\lib.pyx&quot;, line 2834, in pandas._libs.lib.map_infer\n  File &quot;C:&#47;Users&#47;liuzq&#47;Desktop&#47;Source&#47;others&#47;pythonProject&#47;lzq&#47;aigc&#47;opt_search.py&quot;, line 69, in &lt;lambda&gt;\n    df123[&quot;similarity&quot;] = df123.embedding.apply(lambda x: cosine_similarity(x, product_embedding))\n  File &quot;E:\\Anaconda3\\lib\\site-packages\\openai\\embeddings_utils.py&quot;, line 66, in cosine_similarity\n    return np.dot(a, b) &#47; (np.linalg.norm(a) * np.linalg.norm(b))\n  File &quot;&lt;__array_function__ internals&gt;&quot;, line 180, in dot\nValueError: shapes (1536,) and (6,1536) not aligned: 1536 (dim 0) != 6 (dim 0)","like_count":0,"discussions":[{"author":{"id":1637136,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fb/10/b4cb2883.jpg","nickname":"è¢ä½œè¾‰","note":"","ucode":"E758D30832F471","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621641,"discussion_content":"æˆ‘è¿è¡Œæ²¡æœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687406804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ¹–åŒ—","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376038,"user_name":"æ¢¦å…¸","can_delete":false,"product_type":"c1","uid":1203920,"ip_address":"ç¾å›½","ucode":"0A6F91068A13E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/d0/e676ac19.jpg","comment_is_top":false,"comment_ctime":1686227090,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"åŸºäºAGIçš„å‘é‡å®ç°è¯­ä¹‰æœç´¢ï¼ŒçœŸçš„éœ‡æ’¼åˆ°æˆ‘äº†ã€‚èƒ½å¦ä»‹ç»ä¸€äº›è¿™æ–¹é¢çš„è®ºæ–‡ï¼Ÿ","like_count":0},{"had_liked":false,"id":375289,"user_name":"stg609","can_delete":false,"product_type":"c1","uid":1073025,"ip_address":"æµ™æ±Ÿ","ucode":"FB70A75A891BB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg","comment_is_top":false,"comment_ctime":1685254135,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸‹ï¼Œåˆ©ç”¨ Embedding è¿›è¡Œè¯­ä¹‰æœç´¢æ˜¯ä¸æ˜¯ä»…é™äºä¸Šä¸‹æ–‡ä¸æé—®çš„å…³é”®å­—å­˜åœ¨ç›¸å…³æ€§ï¼Œæ¯”å¦‚æ–‡ä¸­çš„ä¾‹å­ã€‚å¦‚æœé—®é¢˜æ˜¯ä¸€ä¸ªéœ€è¦è¿›è¡Œèšåˆè®¡ç®—ä¹‹ç±»çš„é—®é¢˜ï¼Œæ¯”å¦‚æé—®ï¼š&quot;ä¸€å…±æœ‰å¤šå°‘ä¸ªæ°”è´¨èƒŒåŒ…?&quot;ã€‚è¿™ç§é—®é¢˜è¿˜èƒ½åˆ©ç”¨å‘é‡ç›¸ä¼¼æ€§æ¥ç»™å‡ºç­”æ¡ˆå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":375242,"user_name":"å†œæ°‘å›­ä¸","can_delete":false,"product_type":"c1","uid":1155913,"ip_address":"å†…è’™å¤","ucode":"6A91EBBC9DCE6C","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/49/4a488f4c.jpg","comment_is_top":false,"comment_ctime":1685105647,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"è¿è¡Œ## é€šè¿‡Embeddingè¿›è¡Œè¯­ä¹‰æœç´¢ä»£ç å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š\nInvalidRequestError: Too many inputs. The max number of inputs is 1.  We hope to increase the number of inputs per request soon. Please contact us through an Azure support request at: https:&#47;&#47;go.microsoft.com&#47;fwlink&#47;?linkid=2213926 for further questions\n\n------\nç”¨çš„æ˜¯azure openapiï¼Œè¯·é—®å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0},{"had_liked":false,"id":375241,"user_name":"å†œæ°‘å›­ä¸","can_delete":false,"product_type":"c1","uid":1155913,"ip_address":"ç«‹é™¶å®›","ucode":"6A91EBBC9DCE6C","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/49/4a488f4c.jpg","comment_is_top":false,"comment_ctime":1685105622,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"è¿è¡Œ## é€šè¿‡Embeddingè¿›è¡Œè¯­ä¹‰æœç´¢ä»£ç å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š\nInvalidRequestError: Too many inputs. The max number of inputs is 1.  We hope to increase the number of inputs per request soon. Please contact us through an Azure support request at: https:&#47;&#47;go.microsoft.com&#47;fwlink&#47;?linkid=2213926 for further questions\n\n------\nç”¨çš„æ˜¯azure openapiï¼Œè¯·é—®å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0},{"had_liked":false,"id":373332,"user_name":"Allan","can_delete":false,"product_type":"c1","uid":1310388,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"8DA4DBECC2C45C","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/b4/295338e7.jpg","comment_is_top":false,"comment_ctime":1682402881,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100541001,"comment_content":"æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”","like_count":0},{"had_liked":false,"id":372037,"user_name":"Ethan New","can_delete":false,"product_type":"c1","uid":2063962,"ip_address":"æµ™æ±Ÿ","ucode":"9CA2EF39E58030","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7e/5a/da39f489.jpg","comment_is_top":false,"comment_ctime":1680620819,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":4,"score":4,"product_id":100541001,"comment_content":"æ‰“å¡å­¦ä¹ ","like_count":0}]}