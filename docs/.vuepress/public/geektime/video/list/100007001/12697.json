{"id":12697,"title":"74 |【实验】CAT 本地部署","content":"无","comments":[{"had_liked":false,"id":63333,"user_name":"一毛","can_delete":false,"product_type":"c3","uid":1318626,"ip_address":"","ucode":"9FC52F6F22B332","user_header":"https://static001.geekbang.org/account/avatar/00/14/1e/e2/ec3fffab.jpg","comment_is_top":false,"comment_ctime":1548325467,"is_pvip":false,"replies":[{"id":22557,"content":"你好，我刚才本地构建了一把cat是ok的，client-codegen.xml那个文件我看了也在对应目录中，我看你上面的目录有一个空格，可能有问题，建议你把cat放在没有空格的目录中，再尝试构建一把。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1548508272,"ip_address":"","comment_id":63333,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师，执行mvn的时候，报这个错，应该怎么解决呢？Failed to execute goal org.unidal.maven.plugins:codegen-maven-plugin:2.5.8:dal-model (generate data model) on project cat-client: Code generating failed. java.io.FileNotFoundException: &#47;Users&#47;ice&#47;Develop&#47;java&#47;services%20160&#47;cat&#47;cat-client&#47;src&#47;main&#47;resources&#47;META-INF&#47;dal&#47;model&#47;client-codegen.xml (No such file or directory) -&gt; [Help 1]","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437554,"discussion_content":"你好，我刚才本地构建了一把cat是ok的，client-codegen.xml那个文件我看了也在对应目录中，我看你上面的目录有一个空格，可能有问题，建议你把cat放在没有空格的目录中，再尝试构建一把。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548508272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":160129,"user_name":"。。。","can_delete":false,"product_type":"c3","uid":1213172,"ip_address":"","ucode":"1F763D616E7798","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/f4/a25d4f3e.jpg","comment_is_top":false,"comment_ctime":1575876495,"is_pvip":false,"replies":[{"id":61115,"content":"你好，课程是在2018年上半年发布的，当时CAT还在2.0版本，可以看这里：\nhttps:&#47;&#47;github.com&#47;dianping&#47;cat&#47;tree&#47;v2.0.0\n这个script下面有相关xml。\n\n现在CAT已经更新到3.0，作者把代码做了调整，script已经没有相关xml，新版部署的话可以安照它的服务器部署文档：https:&#47;&#47;github.com&#47;dianping&#47;cat&#47;wiki&#47;readme_server\n","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1575891326,"ip_address":"","comment_id":160129,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"script下面就没有那几个xml","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477266,"discussion_content":"你好，课程是在2018年上半年发布的，当时CAT还在2.0版本，可以看这里：\nhttps://github.com/dianping/cat/tree/v2.0.0\n这个script下面有相关xml。\n\n现在CAT已经更新到3.0，作者把代码做了调整，script已经没有相关xml，新版部署的话可以安照它的服务器部署文档：https://github.com/dianping/cat/wiki/readme_server\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575891326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254392,"avatar":"https://static001.geekbang.org/account/avatar/00/13/23/f8/24fcccea.jpg","nickname":"💢 星星💢","note":"","ucode":"A402B765222C35","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":80452,"discussion_content":"问一下你用3.0启动成功了没？我咋用3.0也起不来呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576162330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127247,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1566619429,"is_pvip":false,"replies":[{"id":47221,"content":"CAT要一次部署成功有一定难度，你这个错误我还是第一次见到，具体可以加我微信(bulldog2015)进一步交流，加微信请说明是来自极客时间的客户。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1566745384,"ip_address":"","comment_id":127247,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"在CAT运行盘建data\\appdatas\\cat目录，将{CAT_SRC}&#47;script&#47;下列配置文件：\nCAT客户端配置文件client.xml\nCAT服务器数据源配置文件datasources.xml\nCAT服务器配置文件server.xml\n\n老师 啥叫cat的运行盘？\n&#47;Users&#47;xx&#47;Desktop&#47;apache-tomcat-9.0.21-src&#47;webapps&#47;cat.war\n我把car.war 放在这里了\n\n应该把 data\\appdatas\\cat 放在哪里呀\n\n[08-24 00:03:12.846] [ERROR] [DefaultModuleContext] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\n[08-24 00:03:13.072] [ERROR] [DefaultClientConfigManager] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\n[08-24 00:03:13.079] [ERROR] [DefaultClientConfigManager] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\n[08-24 00:03:13.083] [ERROR] [DefaultClientConfigManager] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\n[08-24 00:03:13.013] [WARN] [cat] CAT client was disabled due to no CAT servers configured!\n[08-24 00:03:13.110] [ERROR] [DefaultClientConfigManager] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\n[08-24 00:03:13.147] [ERROR] [DefaultTransportManager] java.io.FileNotFoundException: &#47;data&#47;applogs&#47;cat&#47;cat_20190824.log (No such file or directory)\njava.io.IOException: No such file or directory","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464395,"discussion_content":"CAT要一次部署成功有一定难度，你这个错误我还是第一次见到，具体可以加我微信(bulldog2015)进一步交流，加微信请说明是来自极客时间的客户。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566745384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104986,"user_name":"hwg","can_delete":false,"product_type":"c3","uid":1448952,"ip_address":"","ucode":"67CCC9785E53A9","user_header":"","comment_is_top":false,"comment_ctime":1560903153,"is_pvip":false,"replies":[{"id":38108,"content":"第9模块综合案例，第9节CAT调用链监控集成，有一个CAT3.0集成实验。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1560950042,"ip_address":"","comment_id":104986,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师 cat3.0安装在第几模块的第几节","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454517,"discussion_content":"第9模块综合案例，第9节CAT调用链监控集成，有一个CAT3.0集成实验。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560950042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96246,"user_name":"liugddx","can_delete":false,"product_type":"c3","uid":1016163,"ip_address":"","ucode":"FDB66E03A74422","user_header":"https://static001.geekbang.org/account/avatar/00/0f/81/63/2ceecb43.jpg","comment_is_top":false,"comment_ctime":1558363305,"is_pvip":false,"replies":[{"id":35173,"content":"你好，一般来讲是CAT服务没有正常启动，如果服务器启动有问题，建议则可以通过查看日志解决：\n{CAT_HOME_DISK}:\\data\\applogs\\cat下面的CAT服务器日志\n{TOMCAT_HOME}\\logs下面的tomcat日志\n一般这些日志里头有错误或者警告提示信息，然后根据这些提示进行排查。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1558960598,"ip_address":"","comment_id":96246,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"我的dashboard提示cat服务异常，三台都异常，可能原因是什么呢？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450790,"discussion_content":"你好，一般来讲是CAT服务没有正常启动，如果服务器启动有问题，建议则可以通过查看日志解决：\n{CAT_HOME_DISK}:\\data\\applogs\\cat下面的CAT服务器日志\n{TOMCAT_HOME}\\logs下面的tomcat日志\n一般这些日志里头有错误或者警告提示信息，然后根据这些提示进行排查。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558960598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51523,"user_name":"王盛武","can_delete":false,"product_type":"c3","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1545193530,"is_pvip":false,"replies":[{"id":18691,"content":"CAT自己上报trace属于内置的系统自检功能，很重要，不建议关闭该功能。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1545222361,"ip_address":"","comment_id":51523,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师，请问如何屏蔽cat控制台页面自己上报的trace？是不是删除cat.war所在机器的client.xml？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433496,"discussion_content":"CAT自己上报trace属于内置的系统自检功能，很重要，不建议关闭该功能。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545222361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51516,"user_name":"王盛武","can_delete":false,"product_type":"c3","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1545192752,"is_pvip":false,"replies":[{"id":18692,"content":"local-mode是本地开发模式，在生产环境下设置为false，默认为false。alert-machine如为true，则设置该CAT服务实例启用告警机功能，能够对CAT指标设置告警，CAT集群时只需一台服务机开启此功能。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1545222981,"ip_address":"","comment_id":51516,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"波波老师，听力这节，也看了英文说明，不明白server.xml的local mode和alere machine的真正作用","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433492,"discussion_content":"local-mode是本地开发模式，在生产环境下设置为false，默认为false。alert-machine如为true，则设置该CAT服务实例启用告警机功能，能够对CAT指标设置告警，CAT集群时只需一台服务机开启此功能。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545222981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42249,"user_name":"leongod🐾","can_delete":false,"product_type":"c3","uid":1300099,"ip_address":"","ucode":"3C2FC993650DC2","user_header":"https://static001.geekbang.org/account/avatar/00/13/d6/83/9015fda2.jpg","comment_is_top":false,"comment_ctime":1542935649,"is_pvip":false,"replies":[{"id":15258,"content":"3.0也可直接用，参考官方文档，变化并不大，最后一个模块我也会演示3.0安装。2.0构建不成功，应该是CAT专有maven仓库依赖DNS改了，最新的是cat.meitun.com&#47;nexus，你也可自己修改下pom文件再构建。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1542984529,"ip_address":"","comment_id":42249,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"老师，github上cat的是3.0版本，可以build成功。但是您的项目是基于2.0做的很多依赖都下载不了。我也尝试checkout到2.0版本，在mvn clean package -DskipTests阶段就报错，因为它依赖的库都已经不存在了。请问老师有什么办法继续课程实验吗？","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430024,"discussion_content":"3.0也可直接用，参考官方文档，变化并不大，最后一个模块我也会演示3.0安装。2.0构建不成功，应该是CAT专有maven仓库依赖DNS改了，最新的是cat.meitun.com/nexus，你也可自己修改下pom文件再构建。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542984529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35599,"user_name":"C","can_delete":false,"product_type":"c3","uid":1189931,"ip_address":"","ucode":"F9AB4C68E16C50","user_header":"https://static001.geekbang.org/account/avatar/00/12/28/2b/9ebc3256.jpg","comment_is_top":false,"comment_ctime":1540699474,"is_pvip":false,"replies":[{"id":12746,"content":"我刚在本地拉下最新代码，然后构建了一把，是ok的。CAT的pom里头只有配maven中央仓库和作者自建的unidal仓库，你的出错信息里头有aliyun仓库，我估计你配了全局maven仓库，建议去掉再试下。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1540818017,"ip_address":"","comment_id":35599,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"我在运行mvn clean install -DskipTests 的时候报一个这样的错，请问这是为什么呢？ Execution generate data model of goal org.unidal.maven.plugins:codegen-maven-plugin:2.5.8:dal-model failed: Plugin org.unidal.maven.plugins:codegen-maven-plugin:2.5.8 or one of its dependencies could not be resolved: Failure to find org.codehaus.plexus:plexus-container-default:jar:3.1.0 in http:&#47;&#47;maven.aliyun.com&#47;nexus&#47;content&#47;groups&#47;public was cached in the local repository, resolution will not be reattempted until the update interval of nexus-aliyun has elapsed or updates are forced 而且这个jar包也没有3.1.0版本的。。。麻烦作者尽快个决绝方案，拜托了","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427592,"discussion_content":"我刚在本地拉下最新代码，然后构建了一把，是ok的。CAT的pom里头只有配maven中央仓库和作者自建的unidal仓库，你的出错信息里头有aliyun仓库，我估计你配了全局maven仓库，建议去掉再试下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540818017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390904,"discussion_content":"aliyun 仓库的包不全，参考 cat 服务端部署文档，添加如下的仓库\n<repository>\n     <id>unidal.releases</id>\n     <url>http://unidal.org/nexus/content/repositories/releases/</url>\n  </repository>\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630133628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103105,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d5/01/befc9f3e.jpg","nickname":"春哥","note":"","ucode":"C20FED6AE27B76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":212377,"discussion_content":"在最外层的pom.xml中，配置了id 为  unidal.releases 的仓库地址。把这个仓库地址加入到setting文件的镜像中（类似阿里云镜像一样配置）。再编译，应该能解决。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584965697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83027,"user_name":"Kyle Liu","can_delete":false,"product_type":"c3","uid":1109324,"ip_address":"","ucode":"21EBDE63DE30A0","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/4c/4f645bda.jpg","comment_is_top":false,"comment_ctime":1554376638,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"友情提示，cat3.0打包最好执行mvn install 就行了","like_count":0}]}