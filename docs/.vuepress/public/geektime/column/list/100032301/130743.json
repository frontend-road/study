{"id":130743,"title":"18 | å¦‚ä½•ç”¨ç¡¬ä»¶åŒæ­¥åŸè¯­ï¼ˆCASï¼‰æ›¿ä»£é”ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æç¥ã€‚ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨é”æ¥ä¿æŠ¤å…±äº«èµ„æºï¼Œä½ ä¹Ÿäº†è§£åˆ°ï¼Œä½¿ç”¨é”æ˜¯æœ‰ä¸€å®šæ€§èƒ½æŸå¤±çš„ï¼Œå¹¶ä¸”ï¼Œå¦‚æœå‘ç”Ÿäº†è¿‡å¤šçš„é”ç­‰å¾…ï¼Œå°†ä¼šéå¸¸å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p><p>åœ¨ä¸€äº›ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¡¬ä»¶åŒæ­¥åŸè¯­æ¥æ›¿ä»£é”ï¼Œå¯ä»¥ä¿è¯å’Œé”ä¸€æ ·çš„æ•°æ®å®‰å…¨æ€§ï¼ŒåŒæ—¶å…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p><p>åœ¨ä»Šå¹´çš„NSDIï¼ˆNSDIæ˜¯USENIXç»„ç»‡å¼€åŠçš„å…³äºç½‘ç»œç³»ç»Ÿè®¾è®¡çš„è‘—åå­¦æœ¯ä¼šè®®ï¼‰ä¸Šï¼Œä¼¯å…‹åˆ©å¤§å­¦å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ã€Š<a href=\"http://www.usenix.org/conference/nsdi19/presentation/khandelwal\">Confluo: Distributed Monitoring and Diagnosis Stack for High-speed Networks</a>ã€‹ï¼Œè¿™ä¸ªè®ºæ–‡ä¸­æåˆ°çš„Confluoï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼äºæ¶ˆæ¯é˜Ÿåˆ—çš„æµæ•°æ®å­˜å‚¨ï¼Œå®ƒçš„ååé‡å·ç§°æ˜¯Kafkaçš„4ï½10å€ã€‚å¯¹äºè¿™ä¸ªå®éªŒç»“è®ºæˆ‘ä¸ªäººä¸æ˜¯å¾ˆè®¤åŒï¼Œå› ä¸ºå®ƒè®¾è®¡çš„å®éªŒæ¡ä»¶å¯¹Kafkaæ¥è¯´ä¸å¤ªå…¬å¹³ã€‚ä½†ä¸å¯å¦è®¤çš„æ˜¯ï¼ŒConfluoå®ƒçš„è¿™ä¸ªè®¾è®¡æ€è·¯æ˜¯ä¸€ä¸ªåˆ›æ–°ï¼Œå¹¶ä¸”å®é™…ä¸Šå®ƒçš„æ€§èƒ½ä¹Ÿéå¸¸å¥½ã€‚</p><p>Confluoæ˜¯å¦‚ä½•åšåˆ°è¿™ä¹ˆé«˜çš„ååé‡çš„å‘¢ï¼Ÿè¿™é‡Œé¢éå¸¸é‡è¦çš„ä¸€ä¸ªåˆ›æ–°çš„è®¾è®¡å°±æ˜¯ï¼Œå®ƒä½¿ç”¨ç¡¬ä»¶åŒæ­¥åŸè¯­æ¥ä»£æ›¿é”ï¼Œåœ¨ä¸€ä¸ªæ—¥å¿—ä¸Šï¼ˆä½ å¯ä»¥ç†è§£ä¸ºæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªé˜Ÿåˆ—æˆ–è€…åˆ†åŒºï¼‰ï¼Œä¿è¯ä¸¥æ ¼é¡ºåºçš„å‰æä¸‹ï¼Œå®ç°äº†å¤šçº¿ç¨‹å¹¶å‘å†™å…¥ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸€ä¸‹ï¼Œå¦‚ä½•ç”¨ç¡¬ä»¶åŒæ­¥åŸè¯­ï¼ˆCASï¼‰æ›¿ä»£é”ï¼Ÿ</p><!-- [[[read_end]]] --><h2>ä»€ä¹ˆæ˜¯ç¡¬ä»¶åŒæ­¥åŸè¯­ï¼Ÿ</h2><p>ä¸ºä»€ä¹ˆç¡¬ä»¶åŒæ­¥åŸè¯­å¯ä»¥æ›¿ä»£é”å‘¢ï¼Ÿè¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œä½ è¦é¦–å…ˆçŸ¥é“ç¡¬ä»¶åŒæ­¥åŸè¯­æ˜¯ä»€ä¹ˆã€‚</p><p>ç¡¬ä»¶åŒæ­¥åŸè¯­ï¼ˆAtomic Hardware Primitivesï¼‰æ˜¯ç”±è®¡ç®—æœºç¡¬ä»¶æä¾›çš„ä¸€ç»„åŸå­æ“ä½œï¼Œæˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„åŸè¯­ä¸»è¦æ˜¯CASå’ŒFAAè¿™ä¸¤ç§ã€‚</p><p>CASï¼ˆCompare and Swapï¼‰ï¼Œå®ƒçš„å­—é¢æ„æ€æ˜¯ï¼šå…ˆæ¯”è¾ƒï¼Œå†äº¤æ¢ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹CASå®ç°çš„ä¼ªä»£ç ï¼š</p><pre><code>&lt;&lt; atomic &gt;&gt;\nfunction cas(p : pointer to int, old : int, new : int) returns bool {\n    if *p â‰  old {\n        return false\n    }\n    *p â† new\n    return true\n}\n</code></pre><p>å®ƒçš„è¾“å…¥å‚æ•°ä¸€å…±æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul>\n<li>p: è¦ä¿®æ”¹çš„å˜é‡çš„æŒ‡é’ˆã€‚</li>\n<li>old: æ—§å€¼ã€‚</li>\n<li>new: æ–°å€¼ã€‚</li>\n</ul><p>è¿”å›çš„æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæ ‡è¯†æ˜¯å¦èµ‹å€¼æˆåŠŸã€‚</p><p>é€šè¿‡è¿™ä¸ªä¼ªä»£ç ï¼Œä½ å°±å¯ä»¥çœ‹å‡ºCASåŸè¯­çš„é€»è¾‘ï¼Œéå¸¸ç®€å•ï¼Œå°±æ˜¯å…ˆæ¯”è¾ƒä¸€ä¸‹å˜é‡på½“å‰çš„å€¼æ˜¯ä¸æ˜¯ç­‰äºoldï¼Œå¦‚æœç­‰äºï¼Œé‚£å°±æŠŠå˜é‡pèµ‹å€¼ä¸ºnewï¼Œå¹¶è¿”å›trueï¼Œå¦åˆ™å°±ä¸æ”¹å˜å˜é‡pï¼Œå¹¶è¿”å›falseã€‚</p><p>è¿™æ˜¯CASè¿™ä¸ªåŸè¯­çš„è¯­ä¹‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹FAAåŸè¯­ï¼ˆFetch and Addï¼‰ï¼š</p><pre><code>&lt;&lt; atomic &gt;&gt;\nfunction faa(p : pointer to int, inc : int) returns int {\n    int value &lt;- *location\n    *p &lt;- value + inc\n    return value\n}\n</code></pre><p>FAAåŸè¯­çš„è¯­ä¹‰æ˜¯ï¼Œå…ˆè·å–å˜é‡på½“å‰çš„å€¼valueï¼Œç„¶åç»™å˜é‡på¢åŠ incï¼Œæœ€åè¿”å›å˜é‡pä¹‹å‰çš„å€¼valueã€‚</p><p>è®²åˆ°è¿™å„¿ä¼°è®¡ä½ ä¼šé—®ï¼Œè¿™ä¸¤ä¸ªåŸè¯­åˆ°åº•æœ‰ä»€ä¹ˆç‰¹æ®Šçš„å‘¢ï¼Ÿ</p><p>ä¸Šé¢çš„è¿™ä¸¤æ®µä¼ªä»£ç ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ç¼–ç¨‹è¯­è¨€æ¥å®ç°ï¼Œè‚¯å®šæ˜¯æ— æ³•ä¿è¯åŸå­æ€§çš„ã€‚è€ŒåŸè¯­çš„ç‰¹æ®Šä¹‹å¤„å°±æ˜¯ï¼Œå®ƒä»¬éƒ½æ˜¯ç”±è®¡ç®—æœºç¡¬ä»¶ï¼Œå…·ä½“è¯´å°±æ˜¯CPUæä¾›çš„å®ç°ï¼Œå¯ä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<strong>åŸå­æ“ä½œå…·æœ‰ä¸å¯åˆ†å‰²æ€§ï¼Œä¹Ÿå°±ä¸å­˜åœ¨å¹¶å‘çš„é—®é¢˜</strong>ã€‚æ‰€ä»¥åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒåŸè¯­å¯ä»¥ç”¨æ¥æ›¿ä»£é”ï¼Œå®ç°ä¸€äº›å³å®‰å…¨åˆé«˜æ•ˆçš„å¹¶å‘æ“ä½œã€‚</p><p>CASå’ŒFAAåœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°ï¼Œå¯ä»¥æ¥ç›´æ¥ä½¿ç”¨ï¼Œæ— è®ºä½ æ˜¯ä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä»¬åº•å±‚çš„å®ç°æ˜¯ä¸€æ ·çš„ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œè¿˜æ˜¯æ‹¿æˆ‘ä»¬ç†Ÿæ‚‰çš„è´¦æˆ·æœåŠ¡æ¥ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨CASåŸè¯­æ¥æ›¿ä»£é”ï¼Œå®ç°åŒæ ·çš„å®‰å…¨æ€§ã€‚</p><h2>CASç‰ˆæœ¬çš„è´¦æˆ·æœåŠ¡</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå…±äº«å˜é‡balanceï¼Œå®ƒä¿å­˜çš„æ˜¯å½“å‰è´¦æˆ·ä½™é¢ï¼Œç„¶åæˆ‘ä»¬æ¨¡æ‹Ÿå¤šä¸ªçº¿ç¨‹å¹¶å‘è½¬è´¦çš„æƒ…å†µï¼Œçœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨CASåŸè¯­æ¥ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</p><p>è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨Goè¯­è¨€æ¥å®ç°è¿™ä¸ªè½¬è´¦æœåŠ¡ã€‚å…ˆçœ‹ä¸€ä¸‹ä½¿ç”¨é”å®ç°çš„ç‰ˆæœ¬ï¼š</p><pre><code>package main\n\nimport (\n\t&quot;fmt&quot;\n\t&quot;sync&quot;\n)\n\nfunc main() {\n\t// è´¦æˆ·åˆå§‹å€¼ä¸º0å…ƒ\n\tvar balance int32\n\tbalance = int32(0)\n\tdone := make(chan bool)\n\t// æ‰§è¡Œ10000æ¬¡è½¬è´¦ï¼Œæ¯æ¬¡è½¬å…¥1å…ƒ\n\tcount := 10000\n\n\tvar lock sync.Mutex\n\n\tfor i := 0; i &lt; count; i++ {\n\t\t// è¿™é‡Œæ¨¡æ‹Ÿå¼‚æ­¥å¹¶å‘è½¬è´¦\n\t\tgo transfer(&amp;balance, 1, done, &amp;lock)\n\t}\n\t// ç­‰å¾…æ‰€æœ‰è½¬è´¦éƒ½å®Œæˆ\n\tfor i := 0; i &lt; count; i++ {\n\t\t&lt;-done\n\t}\n\t// æ‰“å°è´¦æˆ·ä½™é¢\n\tfmt.Printf(&quot;balance = %d \\n&quot;, balance)\n}\n// è½¬è´¦æœåŠ¡\nfunc transfer(balance *int32, amount int, done chan bool, lock *sync.Mutex) {\n\tlock.Lock()\n\t*balance = *balance + int32(amount)\n\tlock.Unlock()\n\tdone &lt;- true\n}\n</code></pre><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®©è´¦æˆ·çš„åˆå§‹å€¼ä¸º0ï¼Œç„¶åå¯åŠ¨å¤šä¸ªåç¨‹æ¥å¹¶å‘æ‰§è¡Œ10000æ¬¡è½¬è´¦ï¼Œæ¯æ¬¡å¾€è´¦æˆ·ä¸­è½¬å…¥1å…ƒï¼Œå…¨éƒ¨è½¬è´¦æ‰§è¡Œå®Œæˆåï¼Œè´¦æˆ·ä¸­çš„ä½™é¢åº”è¯¥æ­£å¥½æ˜¯10000å…ƒã€‚</p><p>å¦‚æœä½ æ²¡æ¥è§¦è¿‡Goè¯­è¨€ï¼Œä¸äº†è§£åç¨‹ä¹Ÿæ²¡å…³ç³»ï¼Œä½ å¯ä»¥ç®€å•åœ°æŠŠå®ƒç†è§£ä¸ºè¿›ç¨‹æˆ–è€…çº¿ç¨‹éƒ½å¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯å¸Œæœ›èƒ½å¼‚æ­¥å¹¶å‘æ‰§è¡Œè½¬è´¦ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè¿™å‡ ç§â€œç¨‹â€ä»–ä»¬ä¹‹é—´ç»†å¾®çš„å·®åˆ«ã€‚</p><p>è¿™ä¸ªä½¿ç”¨é”çš„ç‰ˆæœ¬ï¼Œåå¤å¤šæ¬¡æ‰§è¡Œï¼Œæ¯æ¬¡balanceçš„ç»“æœéƒ½æ­£å¥½æ˜¯10000ï¼Œé‚£è¿™æ®µä»£ç çš„å®‰å…¨æ€§æ˜¯æ²¡é—®é¢˜çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œä½¿ç”¨CASåŸè¯­çš„ç‰ˆæœ¬ã€‚</p><pre><code>func transferCas(balance *int32, amount int, done chan bool) {\n\tfor {\n\t\told := atomic.LoadInt32(balance)\n\t\tnew := old + int32(amount)\n\t\tif atomic.CompareAndSwapInt32(balance, old, new) {\n\t\t\tbreak\n\t\t}\n\t}\n\tdone &lt;- true\n}\n</code></pre><p>è¿™ä¸ªCASç‰ˆæœ¬çš„è½¬è´¦æœåŠ¡å’Œä¸Šé¢ä½¿ç”¨é”çš„ç‰ˆæœ¬ï¼Œç¨‹åºçš„æ€»ä½“ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œä¸»è¦çš„åŒºåˆ«å°±åœ¨äºï¼Œâ€œå¼‚æ­¥ç»™è´¦æˆ·ä½™é¢+1â€è¿™ä¸€å°å—å„¿ä»£ç çš„å®ç°ã€‚</p><p>é‚£åœ¨ä½¿ç”¨é”çš„ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦å…ˆè·å–é”ï¼Œç„¶åå˜æ›´è´¦æˆ·çš„å€¼ï¼Œæœ€åé‡Šæ”¾é”ï¼Œå®Œæˆä¸€æ¬¡è½¬è´¦ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ä½¿ç”¨CASåŸè¯­çš„å®ç°ï¼š</p><p>é¦–å…ˆï¼Œå®ƒç”¨foræ¥åšäº†ä¸€ä¸ªæ²¡æœ‰é€€å‡ºæ¡ä»¶çš„å¾ªç¯ã€‚åœ¨è¿™ä¸ªå¾ªç¯çš„å†…éƒ¨ï¼Œåå¤åœ°è°ƒç”¨CASåŸè¯­ï¼Œæ¥å°è¯•ç»™è´¦æˆ·çš„ä½™é¢+1ã€‚å…ˆå–å¾—è´¦æˆ·å½“å‰çš„ä½™é¢ï¼Œæš‚æ—¶å­˜æ”¾åœ¨å˜é‡oldä¸­ï¼Œå†è®¡ç®—è½¬è´¦ä¹‹åçš„ä½™é¢ï¼Œä¿å­˜åœ¨å˜é‡newä¸­ï¼Œç„¶åè°ƒç”¨CASåŸè¯­æ¥å°è¯•ç»™å˜é‡balanceèµ‹å€¼ã€‚æˆ‘ä»¬åˆšåˆšè®²è¿‡ï¼ŒCASåŸè¯­å®ƒçš„èµ‹å€¼æ“ä½œæ˜¯æœ‰å‰ç½®æ¡ä»¶çš„ï¼Œåªæœ‰å˜é‡balanceçš„å€¼ç­‰äºoldæ—¶ï¼Œæ‰ä¼šå°†balanceèµ‹å€¼ä¸ºnewã€‚</p><p>æˆ‘ä»¬åœ¨forå¾ªç¯ä¸­æ‰§è¡Œäº†3æ¡è¯­å¥ï¼Œåœ¨å¹¶å‘çš„ç¯å¢ƒä¸­æ‰§è¡Œï¼Œè¿™é‡Œé¢ä¼šæœ‰ä¸¤ç§å¯èƒ½æƒ…å†µï¼š</p><p>ä¸€ç§æƒ…å†µæ˜¯ï¼Œæ‰§è¡Œåˆ°ç¬¬3æ¡CASåŸè¯­æ—¶ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹åŒæ—¶æ”¹å˜äº†è´¦æˆ·ä½™é¢ï¼Œé‚£æˆ‘ä»¬æ˜¯å¯ä»¥å®‰å…¨å˜æ›´è´¦æˆ·ä½™é¢çš„ï¼Œè¿™ä¸ªæ—¶å€™æ‰§è¡ŒCASçš„è¿”å›å€¼ä¸€å®šæ˜¯trueï¼Œè½¬è´¦æˆåŠŸï¼Œå°±å¯ä»¥é€€å‡ºå¾ªç¯äº†ã€‚å¹¶ä¸”ï¼ŒCASè¿™ä¸€æ¡è¯­å¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œèµ‹å€¼çš„å®‰å…¨æ€§æ˜¯å¯ä»¥ä¿è¯çš„ã€‚</p><p>å¦å¤–ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæœ‰å…¶ä»–çº¿ç¨‹æ”¹å˜äº†è´¦æˆ·ä½™é¢ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ— æ³•ä¿è¯æ•°æ®å®‰å…¨çš„ï¼Œä¸èƒ½å†è¿›è¡Œèµ‹å€¼ã€‚æ‰§è¡ŒCASåŸè¯­æ—¶ï¼Œç”±äºæ— æ³•é€šè¿‡æ¯”è¾ƒçš„æ­¥éª¤ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œèµ‹å€¼æ“ä½œã€‚æœ¬æ¬¡å°è¯•è½¬è´¦å¤±è´¥ï¼Œå½“å‰çº¿ç¨‹å¹¶æ²¡æœ‰å¯¹è´¦æˆ·ä½™é¢åšä»»ä½•å˜æ›´ã€‚ç”±äºè¿”å›å€¼ä¸ºfalseï¼Œä¸ä¼šé€€å‡ºå¾ªç¯ï¼Œæ‰€ä»¥ä¼šç»§ç»­é‡è¯•ï¼Œç›´åˆ°è½¬è´¦æˆåŠŸé€€å‡ºå¾ªç¯ã€‚</p><p>è¿™æ ·ï¼Œæ¯ä¸€æ¬¡è½¬è´¦æ“ä½œï¼Œéƒ½å¯ä»¥é€šè¿‡è‹¥å¹²æ¬¡é‡è¯•ï¼Œåœ¨ä¿è¯å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œå®Œæˆå¹¶å‘è½¬è´¦æ“ä½œã€‚</p><p>å…¶å®ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­ï¼Œè¿˜æœ‰æ›´ç®€å•ã€æ€§èƒ½æ›´å¥½çš„æ–¹å¼ï¼šé‚£å°±æ˜¯ï¼Œç›´æ¥ä½¿ç”¨FAAåŸè¯­ã€‚</p><pre><code>func transferFaa(balance *int32, amount int, done chan bool) {\n\tatomic.AddInt32(balance, int32(amount))\n\tdone &lt;- true\n}\n</code></pre><p>FAAåŸè¯­å®ƒçš„æ“ä½œæ˜¯ï¼Œè·å–å˜é‡å½“å‰çš„å€¼ï¼Œç„¶åæŠŠå®ƒåšä¸€ä¸ªåŠ æ³•ï¼Œå¹¶ä¸”ä¿è¯è¿™ä¸ªæ“ä½œçš„åŸå­æ€§ï¼Œä¸€è¡Œä»£ç å°±å¯ä»¥æå®šäº†ã€‚çœ‹åˆ°è¿™å„¿ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼Œé‚£CASåŸè¯­è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œè‚¯å®šæ˜¯ä½¿ç”¨FAAåŸè¯­æ›´åˆé€‚ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„ï¼Œä½¿ç”¨CASåŸè¯­çš„æ–¹æ³•ï¼Œå®ƒçš„é€‚ç”¨èŒƒå›´æ›´åŠ å¹¿æ³›ä¸€äº›ã€‚ç±»ä¼¼äºè¿™æ ·çš„é€»è¾‘ï¼šå…ˆè¯»å–æ•°æ®ï¼Œåšè®¡ç®—ï¼Œç„¶åæ›´æ–°æ•°æ®ï¼Œæ— è®ºè¿™ä¸ªè®¡ç®—æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨CASåŸè¯­æ¥ä¿æŠ¤æ•°æ®å®‰å…¨ï¼Œä½†æ˜¯FAAåŸè¯­ï¼Œè¿™ä¸ªè®¡ç®—çš„é€»è¾‘åªèƒ½å±€é™äºç®€å•çš„åŠ å‡æ³•ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸Šé¢è®²çš„è¿™ç§ä½¿ç”¨CASåŸè¯­çš„æ–¹æ³•å¹¶ä¸æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p><p>å¦å¤–ï¼Œä½ éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œè¿™ç§ä½¿ç”¨CASåŸè¯­åå¤é‡è¯•èµ‹å€¼çš„æ–¹æ³•ï¼Œå®ƒæ˜¯æ¯”è¾ƒè€—è´¹CPUèµ„æºçš„ï¼Œå› ä¸ºåœ¨forå¾ªç¯ä¸­ï¼Œå¦‚æœèµ‹å€¼ä¸æˆåŠŸï¼Œæ˜¯ä¼šç«‹å³è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯æ²¡æœ‰ç­‰å¾…çš„ã€‚å¦‚æœçº¿ç¨‹ä¹‹é—´çš„ç¢°æ’éå¸¸é¢‘ç¹ï¼Œç»å¸¸æ€§çš„åå¤é‡è¯•ï¼Œè¿™ä¸ªé‡è¯•çš„çº¿ç¨‹ä¼šå ç”¨å¤§é‡çš„CPUæ—¶é—´ï¼Œéšä¹‹ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å°±ä¼šä¸‹é™ã€‚</p><p>ç¼“è§£è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨Yield()ï¼Œ å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒYield()è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼ŒYield()çš„ä½œç”¨æ˜¯ï¼Œå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œè®©å‡ºå½“å‰çº¿ç¨‹å ç”¨çš„CPUç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ã€‚æ¯æ¬¡å¾ªç¯ç»“æŸå‰è°ƒç”¨ä¸€ä¸‹Yield()æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘CPUçš„ä½¿ç”¨ç‡ï¼Œç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨æ¯æ¬¡å¾ªç¯ç»“æŸä¹‹åï¼ŒSleep()ä¸€å°æ®µæ—¶é—´ï¼Œä½†æ˜¯è¿™æ ·åšçš„ä»£ä»·æ˜¯ï¼Œæ€§èƒ½ä¼šä¸¥é‡ä¸‹é™ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ç§æ–¹æ³•å®ƒåªé€‚åˆäºçº¿ç¨‹ä¹‹é—´ç¢°æ’ä¸å¤ªé¢‘ç¹ï¼Œä¹Ÿå°±æ˜¯è¯´ç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ‰§è¡ŒCASåŸè¯­ä¸éœ€è¦é‡è¯•è¿™æ ·çš„åœºæ™¯ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†CASå’ŒFAAè¿™ä¸¤ä¸ªåŸè¯­ã€‚è¿™äº›åŸè¯­ï¼Œæ˜¯ç”±CPUæä¾›çš„åŸå­æ“ä½œï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼Œå•ç‹¬ä½¿ç”¨è¿™äº›åŸè¯­ä¸ç”¨æ‹…å¿ƒæ•°æ®å®‰å…¨é—®é¢˜ã€‚åœ¨ç‰¹å®šçš„åœºæ™¯ä¸­ï¼ŒCASåŸè¯­å¯ä»¥æ›¿ä»£é”ï¼Œåœ¨ä¿è¯å®‰å…¨æ€§çš„åŒæ—¶ï¼Œæä¾›æ¯”é”æ›´å¥½çš„æ€§èƒ½ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨è½¬è´¦æœåŠ¡è¿™ä¸ªä¾‹å­ï¼Œåˆ†åˆ«æ¼”ç¤ºäº†CASå’ŒFAAè¿™ä¸¤ä¸ªåŸè¯­æ˜¯å¦‚ä½•æ›¿ä»£é”æ¥ä½¿ç”¨çš„ã€‚å¯¹äºç±»ä¼¼ï¼šâ€œå…ˆè¯»å–æ•°æ®ï¼Œåšè®¡ç®—ï¼Œç„¶åå†æ›´æ–°æ•°æ®â€è¿™æ ·çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨CASåŸè¯­+åå¤é‡è¯•çš„æ–¹å¼æ¥ä¿è¯æ•°æ®å®‰å…¨ï¼Œå‰ææ˜¯ï¼Œçº¿ç¨‹ä¹‹é—´çš„ç¢°æ’ä¸èƒ½å¤ªé¢‘ç¹ï¼Œå¦åˆ™å¤ªå¤šé‡è¯•ä¼šæ¶ˆè€—å¤§é‡çš„CPUèµ„æºï¼Œåè€Œå¾—ä¸å¿å¤±ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¿™èŠ‚è¯¾çš„è¯¾åä½œä¸šï¼Œä¾ç„¶éœ€è¦ä½ å»åŠ¨æ‰‹æ¥å†™ä»£ç ã€‚ä½ éœ€è¦æŠŠæˆ‘ä»¬è¿™èŠ‚è¯¾ä¸­çš„è®²åˆ°çš„è´¦æˆ·æœåŠ¡è¿™ä¸ªä¾‹å­ï¼Œç”¨ä½ ç†Ÿæ‚‰çš„è¯­è¨€ï¼Œç”¨é”ã€CASå’ŒFAAè¿™ä¸‰ç§æ–¹æ³•ï¼Œéƒ½å®Œæ•´åœ°å®ç°ä¸€éã€‚æ¯ç§å®ç°æ–¹æ³•éƒ½è¦æ±‚æ˜¯å®Œæ•´çš„ï¼Œå¯ä»¥æ‰§è¡Œçš„ç¨‹åºã€‚</p><p>å› ä¸ºï¼Œå¯¹äºå¹¶å‘å’Œæ•°æ®å®‰å…¨è¿™å—å„¿ï¼Œä½ ä¸ä»…è¦æ˜ç™½åŸç†ï¼Œç†Ÿæ‚‰ç›¸å…³çš„APIï¼Œä¼šæ­£ç¡®åœ°ä½¿ç”¨ï¼Œæ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨è¿™éƒ¨åˆ†å†™å‡ºçš„Bugï¼Œéƒ½æ¯”è¾ƒè¯¡å¼‚ï¼Œä¸å¥½é‡ç°ï¼Œè€Œä¸”å¾ˆéš¾è°ƒè¯•ã€‚ä½ ä¼šå‘ç°ï¼Œä½ çš„æ•°æ®ä¸€ä¼šå„¿æ˜¯å¯¹çš„ï¼Œä¸€ä¼šå„¿åˆé”™äº†ã€‚æˆ–è€…åœ¨ä½ å¼€å‘çš„ç”µè„‘ä¸Šéƒ½æ­£ç¡®ï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šåˆé”™äº†ç­‰ç­‰ã€‚æ‰€ä»¥ï¼Œç†Ÿç»ƒæŒæ¡ï¼Œä¸€æ¬¡æ€§å†™å‡ºæ­£ç¡®çš„ä»£ç ï¼Œè¿™æ ·ä¼šå¸®ä½ çœå‡ºå¾ˆå¤šæ‰¾Bugçš„æ—¶é—´ã€‚</p><p>éªŒè¯ä½œä¸šæ˜¯å¦æ­£ç¡®çš„æ–¹æ³•æ˜¯ï¼Œä½ åå¤å¤šæ¬¡æ‰§è¡Œä½ çš„ç¨‹åºï¼Œåº”è¯¥æ¯æ¬¡æ‰“å°çš„ç»“æœéƒ½æ˜¯ï¼š</p><pre><code>balance = 10000\n</code></pre><p>æ¬¢è¿ä½ æŠŠä»£ç ä¸Šä¼ åˆ°GitHubä¸Šï¼Œç„¶ååœ¨è¯„è®ºåŒºç»™å‡ºè®¿é—®é“¾æ¥ã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ä¸æˆ‘äº¤æµã€‚</p><p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ä¸€äº›å¯å‘ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"17 | å¦‚ä½•æ­£ç¡®ä½¿ç”¨é”ä¿æŠ¤å…±äº«æ•°æ®ï¼Œåè°ƒå¼‚æ­¥çº¿ç¨‹ï¼Ÿ","id":129333},"right":{"article_title":"19 | æ•°æ®å‹ç¼©ï¼šæ—¶é—´æ¢ç©ºé—´çš„æ¸¸æˆ","id":131826}},"comments":[{"had_liked":false,"id":130581,"user_name":"ponymm","can_delete":false,"product_type":"c1","uid":1087867,"ip_address":"","ucode":"E247AAA72AAAE2","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/7b/0a056674.jpg","comment_is_top":false,"comment_ctime":1567488009,"is_pvip":false,"replies":[{"id":48875,"content":"æ„Ÿè°¢ä½ æŒ‡å‡ºé”™è¯¯ï¼Œæˆ‘å·²ç»è”ç³»ç¼–è¾‘åœ¨æ–‡ç¨¿ä¸­æ”¹æ­£äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567503685,"ip_address":"","comment_id":130581,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°ï¼Œå¯ä»¥æ¥ç›´æ¥ä½¿ç”¨ï¼Œæ— è®ºä½ æ˜¯ä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒåº•å±‚ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸€æ ·çš„ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚â€ æè€å¸ˆè¿™å¥è¯æœ‰ç‚¹å°é—®é¢˜ï¼šcar,faaå¹¶ä¸æ˜¯é€šè¿‡ç³»ç»Ÿè°ƒç”¨å®ç°çš„ï¼Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ä¸å°ï¼Œcasæœ¬æ¥å°±æ˜¯ä¸ºäº†æå‡æ€§èƒ½ï¼Œä¸ä¼šèµ°ç³»ç»Ÿè°ƒç”¨ã€‚äº‹å®ä¸Šæ˜¯åœ¨ç”¨æˆ·æ€ç›´æ¥ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤å°±å¯ä»¥å®ç°","like_count":52},{"had_liked":false,"id":130635,"user_name":"å¾®å¾®ä¸€ç¬‘","can_delete":false,"product_type":"c1","uid":1250327,"ip_address":"","ucode":"CFA7ABE81D0B99","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/17/8763dced.jpg","comment_is_top":false,"comment_ctime":1567498618,"is_pvip":false,"replies":[{"id":48981,"content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564780,"ip_address":"","comment_id":130635,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"è€å¸ˆå¥½ï¼Œå®ç°äº†ä¸‹CAS,ä»£ç è¿æ¥ï¼šhttps:&#47;&#47;github.com&#47;shenyachen&#47;JKSJ&#47;blob&#47;master&#47;study&#47;src&#47;main&#47;java&#47;com&#47;jksj&#47;study&#47;casAndFaa&#47;CASThread.javaã€‚\nå¯¹äºFAAï¼Œé€šè¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œjdk1.8åœ¨è°ƒç”¨sun.misc.Unsafe#getAndAddIntæ–¹æ³•æ—¶ï¼Œä¼šæ ¹æ®ç³»ç»Ÿåº•å±‚æ˜¯å¦æ”¯æŒFAAï¼Œæ¥å†³å®šæ˜¯ä½¿ç”¨FAAè¿˜æ˜¯CASã€‚","like_count":31,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466015,"discussion_content":"æ„Ÿè°¢ä½ æŒ‡å‡ºé”™è¯¯ï¼Œæˆ‘å·²ç»è”ç³»ç¼–è¾‘åœ¨æ–‡ç¨¿ä¸­æ”¹æ­£äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567503685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2558430,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjbYMNwhsazNatHcxQ7L9MXTq2zurFrnZHWZxsWY55czDxSerHAeibrvwZB7t6CqoDfjMM2nWDHmg/132","nickname":"Geek_73fe59","note":"","ucode":"123D06150ADBFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373088,"discussion_content":"éƒ½2021å¹´äº†ï¼Œæ–‡ç« æ€ä¹ˆè¿˜æ²¡æ”¹","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1620611129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130659,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1567503230,"is_pvip":false,"replies":[{"id":48909,"content":"å¯ä»¥è¯•è¯•è¿™ä¸ªï¼šhttps:&#47;&#47;developer.mozilla.org&#47;en-US&#47;docs&#47;Web&#47;JavaScript&#47;Reference&#47;Global_Objects&#47;Atomics","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567514493,"ip_address":"","comment_id":130659,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"NodeJSä¸­ï¼Œæ²¡æœ‰å‘ç°æœ‰å…³æ“ä½œCpUåŸè¯­CASæˆ–è€…FAAçš„å®ç°çš„","like_count":10,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466043,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/abb7bfe3.jpg","nickname":"Geek_ejy2ar","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227739,"discussion_content":"åˆ†äº«ï¼šhttps://github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586514893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/abb7bfe3.jpg","nickname":"Geek_ejy2ar","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227737,"discussion_content":"corePoolSizeä¸åº”è®¾å€¼ä¸º10000ï¼Œ è‹¥æ˜¯4æ ¸çš„CPUï¼Œ è®¾ç½®æˆ2*core + 1ï¼ˆä¹Ÿæœ‰è¯´æ³•æ˜¯+ï¼‰  ä¼¼ä¹æ˜¯æœ€å¥½çš„ã€‚ä½ å¯ä»¥è¯•è¯•ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586514877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130717,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1567517503,"is_pvip":false,"replies":[{"id":49321,"content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567648118,"ip_address":"","comment_id":130717,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"MutxLockï¼šhttps:&#47;&#47;github.com&#47;xqq1994&#47;algorithm&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;test&#47;concurrency&#47;MutxLock.java\nCASã€FFA:\nhttps:&#47;&#47;github.com&#47;xqq1994&#47;algorithm&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;test&#47;concurrency&#47;CAS.java\nå®Œæˆäº†è€å¸ˆçš„ä½œä¸šï¼Œå¥½é«˜å…´","like_count":6,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466052,"discussion_content":"å¯ä»¥è¯•è¯•è¿™ä¸ªï¼šhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Atomics","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567514493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1081922,"avatar":"https://static001.geekbang.org/account/avatar/00/10/82/42/8b04d489.jpg","nickname":"åˆ˜ä¸¹","note":"","ucode":"66594D1C957E15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7784,"discussion_content":"nodeæ˜¯å•çº¿ç¨‹çš„ï¼Œæ²¡æœ‰é”","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567673166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130417,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1567459435,"is_pvip":false,"replies":[{"id":48745,"content":"åœ¨javaä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹java.util.concurrent.atomic.AtomicLong#getAndAdd","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567493324,"ip_address":"","comment_id":130417,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Javaé‡Œè¾¹æœ‰æ”¯æŒFAAè¿™ç§CPUæŒ‡ä»¤çš„å®ç°å—ï¼Ÿä»¥å‰æ²¡å¬è¯´","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465945,"discussion_content":"åœ¨javaä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹java.util.concurrent.atomic.AtomicLong#getAndAdd","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567493324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207622,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6d/46/e16291f8.jpg","nickname":"ä¸å°æ˜","note":"","ucode":"CC23857B8D75D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":256322,"discussion_content":"ä½†æ˜¯javaä¸­åº•å±‚è¿˜æ˜¯é€šè¿‡casæ¥å®ç°çš„ï¼Œå¹¶æ²¡æœ‰faaã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588471049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004092,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","nickname":"å¼ ä¸‰","note":"","ucode":"1155528FAE1546","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7328,"discussion_content":"åŸæ¥è¿™ä¸ªæ–¹æ³•å°±æ˜¯FAAæŒ‡ä»¤å•Šï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567493971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130663,"user_name":"æ˜æ—¥","can_delete":false,"product_type":"c1","uid":1003917,"ip_address":"","ucode":"348899EC65AE8D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/51/8d/09f28606.jpg","comment_is_top":false,"comment_ctime":1567503617,"is_pvip":false,"replies":[{"id":48982,"content":"transfer2è¦æ”¾åœ¨å¾ªç¯ä¸­ï¼Œå¦åˆ™æœ‰å¯èƒ½è½¬è´¦å¤±è´¥ã€‚\nå¦å¤–ï¼Œtransfer1ä¸­ï¼Œè™½ç„¶ä¸€ä¸ªç®€å•çš„åŠ æ³•ä¸ä¼šå¼•èµ·ä»»ä½•å¼‚å¸¸ï¼Œä½†æ€»æ˜¯æŠŠunlockæ”¾åˆ°finnallyä¸­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567565043,"ip_address":"","comment_id":130663,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Javaå®ç°: https:&#47;&#47;gist.github.com&#47;imgaoxin&#47;a2b09715af99b993e30b44963cebc530","like_count":2,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466055,"discussion_content":"transfer2è¦æ”¾åœ¨å¾ªç¯ä¸­ï¼Œå¦åˆ™æœ‰å¯èƒ½è½¬è´¦å¤±è´¥ã€‚\nå¦å¤–ï¼Œtransfer1ä¸­ï¼Œè™½ç„¶ä¸€ä¸ªç®€å•çš„åŠ æ³•ä¸ä¼šå¼•èµ·ä»»ä½•å¼‚å¸¸ï¼Œä½†æ€»æ˜¯æŠŠunlockæ”¾åˆ°finnallyä¸­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567565043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152988,"user_name":"Sicily9","can_delete":false,"product_type":"c1","uid":1224939,"ip_address":"","ucode":"ECFD642F164EE6","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","comment_is_top":false,"comment_ctime":1574134078,"is_pvip":false,"replies":[{"id":58846,"content":"ä¸ä¼šçš„ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1574208916,"ip_address":"","comment_id":152988,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"æœ‰ä¸€ä¸ªå°ç–‘é—®ï¼Œå…³äºåŸå­æ€§çš„è¯ï¼Œæœ‰ä¸€ä¸ªæç«¯æƒ…å†µï¼Œå¤šæ ¸å¹¶è¡Œæƒ…å†µä¸‹ ä¸¤ä¸ªçº¿ç¨‹ åŒæ—¶åœ¨æ‰§è¡Œä¸€ä¸ªcasåŸè¯­ ä¼šæœ‰å®‰å…¨é—®é¢˜å—","like_count":1,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475012,"discussion_content":"ä¸ä¼šçš„ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574208916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1224939,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","nickname":"Sicily9","note":"","ucode":"ECFD642F164EE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":53709,"discussion_content":"è¿™ä¸ªæ˜¯cpu å±‚é¢çš„é”æœºåˆ¶å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574210987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1130590,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","nickname":"Ryoma","note":"","ucode":"7F692369239692","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1224939,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","nickname":"Sicily9","note":"","ucode":"ECFD642F164EE6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204525,"discussion_content":"å‡†å¤‡æ¥è¯´è¿™ä¸æ˜¯é”ï¼ŒCPU ä¼šå°†è¿™ä¸¤ä¸ªå‘½ä»¤å½“åšä¸€ä¸ªåŸå­ä¸€æ¬¡æ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶å®ƒä»»åŠ¡ä¸­æ–­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584187409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":53709,"ip_address":"","group_id":0},"score":204525,"extra":""}]}]},{"had_liked":false,"id":228967,"user_name":"è¡¹æ˜¯ä¸€æ”¯æ­Œ","can_delete":false,"product_type":"c1","uid":1456239,"ip_address":"","ucode":"9FC36529C9FD2E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/iaZdMmzM0Vfass2ukHOqGgSBbtJMwb4NxDvLdN3R67iczzPVdtF0F0WS0abvls3edQpOVxaUJBmlr2YxHzUpveIQ/132","comment_is_top":false,"comment_ctime":1592872547,"is_pvip":false,"replies":[{"id":84526,"content":"æ˜¯çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼äº‹åŠ¡å¦‚æ­¤ä¹‹éš¾çš„åŸå› ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1592916765,"ip_address":"","comment_id":228967,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"CAS FAAæ˜¯ä¸æ˜¯åªèƒ½ç”¨äºå•æœºæƒ…å†µä¸‹çš„èµ„æºæ§åˆ¶è®¿é—®å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499279,"discussion_content":"æ˜¯çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼äº‹åŠ¡å¦‚æ­¤ä¹‹éš¾çš„åŸå› ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592916765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139168,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1570579764,"is_pvip":false,"replies":[{"id":53642,"content":"CPythonï¼ˆå°±æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„Pythonï¼‰ä¸­ç¡®å®æ²¡æœ‰æä¾›åŸå­æ“ä½œã€‚å¯ä»¥çœ‹ä¸€ä¸‹pypyï¼šhttps:&#47;&#47;pypy.org&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1570583263,"ip_address":"","comment_id":139168,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Pythonæ²¡æ‰¾åˆ°CASå’ŒFAAçš„å®ç°","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499279,"discussion_content":"æ˜¯çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼äº‹åŠ¡å¦‚æ­¤ä¹‹éš¾çš„åŸå› ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592916765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131047,"user_name":"é’èˆŸ","can_delete":false,"product_type":"c1","uid":1192732,"ip_address":"","ucode":"2651482AC0DEC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/33/1c/59a4e803.jpg","comment_is_top":false,"comment_ctime":1567608080,"is_pvip":false,"replies":[{"id":49332,"content":"javaé‡Œé¢æœ‰AtomicIntegerç­‰ç­‰å°è£…å¥½çš„ç±»ï¼ŒåŒ…å«äº†CASå’ŒFAAç­‰åŸå­æ“ä½œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567649063,"ip_address":"","comment_id":131047,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"https:&#47;&#47;github.com&#47;qingzhou413&#47;geektime-mq.git\nåšäº†1000ä¸‡æ¬¡åŠ æ³•ï¼Œ\nLock: 380ms\nCAS: 200ms\nFAA: 280ms","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469825,"discussion_content":"CPythonï¼ˆå°±æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„Pythonï¼‰ä¸­ç¡®å®æ²¡æœ‰æä¾›åŸå­æ“ä½œã€‚å¯ä»¥çœ‹ä¸€ä¸‹pypyï¼šhttps://pypy.org/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570583263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130581,"user_name":"ponymm","can_delete":false,"product_type":"c1","uid":1087867,"ip_address":"","ucode":"E247AAA72AAAE2","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/7b/0a056674.jpg","comment_is_top":false,"comment_ctime":1567488009,"is_pvip":false,"replies":[{"id":48875,"content":"æ„Ÿè°¢ä½ æŒ‡å‡ºé”™è¯¯ï¼Œæˆ‘å·²ç»è”ç³»ç¼–è¾‘åœ¨æ–‡ç¨¿ä¸­æ”¹æ­£äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567503685,"ip_address":"","comment_id":130581,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°ï¼Œå¯ä»¥æ¥ç›´æ¥ä½¿ç”¨ï¼Œæ— è®ºä½ æ˜¯ä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒåº•å±‚ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸€æ ·çš„ï¼Œæ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚â€ æè€å¸ˆè¿™å¥è¯æœ‰ç‚¹å°é—®é¢˜ï¼šcar,faaå¹¶ä¸æ˜¯é€šè¿‡ç³»ç»Ÿè°ƒç”¨å®ç°çš„ï¼Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ä¸å°ï¼Œcasæœ¬æ¥å°±æ˜¯ä¸ºäº†æå‡æ€§èƒ½ï¼Œä¸ä¼šèµ°ç³»ç»Ÿè°ƒç”¨ã€‚äº‹å®ä¸Šæ˜¯åœ¨ç”¨æˆ·æ€ç›´æ¥ä½¿ç”¨æ±‡ç¼–æŒ‡ä»¤å°±å¯ä»¥å®ç°","like_count":52,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466015,"discussion_content":"æ„Ÿè°¢ä½ æŒ‡å‡ºé”™è¯¯ï¼Œæˆ‘å·²ç»è”ç³»ç¼–è¾‘åœ¨æ–‡ç¨¿ä¸­æ”¹æ­£äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567503685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2558430,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJjbYMNwhsazNatHcxQ7L9MXTq2zurFrnZHWZxsWY55czDxSerHAeibrvwZB7t6CqoDfjMM2nWDHmg/132","nickname":"Geek_73fe59","note":"","ucode":"123D06150ADBFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373088,"discussion_content":"éƒ½2021å¹´äº†ï¼Œæ–‡ç« æ€ä¹ˆè¿˜æ²¡æ”¹","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1620611129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130635,"user_name":"å¾®å¾®ä¸€ç¬‘","can_delete":false,"product_type":"c1","uid":1250327,"ip_address":"","ucode":"CFA7ABE81D0B99","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/17/8763dced.jpg","comment_is_top":false,"comment_ctime":1567498618,"is_pvip":false,"replies":[{"id":48981,"content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564780,"ip_address":"","comment_id":130635,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"è€å¸ˆå¥½ï¼Œå®ç°äº†ä¸‹CAS,ä»£ç è¿æ¥ï¼šhttps:&#47;&#47;github.com&#47;shenyachen&#47;JKSJ&#47;blob&#47;master&#47;study&#47;src&#47;main&#47;java&#47;com&#47;jksj&#47;study&#47;casAndFaa&#47;CASThread.javaã€‚\nå¯¹äºFAAï¼Œé€šè¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œjdk1.8åœ¨è°ƒç”¨sun.misc.Unsafe#getAndAddIntæ–¹æ³•æ—¶ï¼Œä¼šæ ¹æ®ç³»ç»Ÿåº•å±‚æ˜¯å¦æ”¯æŒFAAï¼Œæ¥å†³å®šæ˜¯ä½¿ç”¨FAAè¿˜æ˜¯CASã€‚","like_count":31,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466043,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/abb7bfe3.jpg","nickname":"Geek_ejy2ar","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227739,"discussion_content":"åˆ†äº«ï¼šhttps://github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586514893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1116106,"avatar":"https://static001.geekbang.org/account/avatar/00/11/07/ca/abb7bfe3.jpg","nickname":"Geek_ejy2ar","note":"","ucode":"DB6C45FD67CDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227737,"discussion_content":"corePoolSizeä¸åº”è®¾å€¼ä¸º10000ï¼Œ è‹¥æ˜¯4æ ¸çš„CPUï¼Œ è®¾ç½®æˆ2*core + 1ï¼ˆä¹Ÿæœ‰è¯´æ³•æ˜¯+ï¼‰  ä¼¼ä¹æ˜¯æœ€å¥½çš„ã€‚ä½ å¯ä»¥è¯•è¯•ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586514877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130659,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1567503230,"is_pvip":false,"replies":[{"id":48909,"content":"å¯ä»¥è¯•è¯•è¿™ä¸ªï¼šhttps:&#47;&#47;developer.mozilla.org&#47;en-US&#47;docs&#47;Web&#47;JavaScript&#47;Reference&#47;Global_Objects&#47;Atomics","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567514493,"ip_address":"","comment_id":130659,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"NodeJSä¸­ï¼Œæ²¡æœ‰å‘ç°æœ‰å…³æ“ä½œCpUåŸè¯­CASæˆ–è€…FAAçš„å®ç°çš„","like_count":10,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466052,"discussion_content":"å¯ä»¥è¯•è¯•è¿™ä¸ªï¼šhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Atomics","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567514493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1081922,"avatar":"https://static001.geekbang.org/account/avatar/00/10/82/42/8b04d489.jpg","nickname":"åˆ˜ä¸¹","note":"","ucode":"66594D1C957E15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7784,"discussion_content":"nodeæ˜¯å•çº¿ç¨‹çš„ï¼Œæ²¡æœ‰é”","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567673166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130717,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1567517503,"is_pvip":false,"replies":[{"id":49321,"content":"ğŸ‘ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567648118,"ip_address":"","comment_id":130717,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"MutxLockï¼šhttps:&#47;&#47;github.com&#47;xqq1994&#47;algorithm&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;test&#47;concurrency&#47;MutxLock.java\nCASã€FFA:\nhttps:&#47;&#47;github.com&#47;xqq1994&#47;algorithm&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;com&#47;test&#47;concurrency&#47;CAS.java\nå®Œæˆäº†è€å¸ˆçš„ä½œä¸šï¼Œå¥½é«˜å…´","like_count":6,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466085,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567648118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130417,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1567459435,"is_pvip":false,"replies":[{"id":48745,"content":"åœ¨javaä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹java.util.concurrent.atomic.AtomicLong#getAndAdd","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567493324,"ip_address":"","comment_id":130417,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Javaé‡Œè¾¹æœ‰æ”¯æŒFAAè¿™ç§CPUæŒ‡ä»¤çš„å®ç°å—ï¼Ÿä»¥å‰æ²¡å¬è¯´","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466085,"discussion_content":"ğŸ‘ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567648118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130663,"user_name":"æ˜æ—¥","can_delete":false,"product_type":"c1","uid":1003917,"ip_address":"","ucode":"348899EC65AE8D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/51/8d/09f28606.jpg","comment_is_top":false,"comment_ctime":1567503617,"is_pvip":false,"replies":[{"id":48982,"content":"transfer2è¦æ”¾åœ¨å¾ªç¯ä¸­ï¼Œå¦åˆ™æœ‰å¯èƒ½è½¬è´¦å¤±è´¥ã€‚\nå¦å¤–ï¼Œtransfer1ä¸­ï¼Œè™½ç„¶ä¸€ä¸ªç®€å•çš„åŠ æ³•ä¸ä¼šå¼•èµ·ä»»ä½•å¼‚å¸¸ï¼Œä½†æ€»æ˜¯æŠŠunlockæ”¾åˆ°finnallyä¸­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567565043,"ip_address":"","comment_id":130663,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Javaå®ç°: https:&#47;&#47;gist.github.com&#47;imgaoxin&#47;a2b09715af99b993e30b44963cebc530","like_count":2,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465945,"discussion_content":"åœ¨javaä¸­ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹java.util.concurrent.atomic.AtomicLong#getAndAdd","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567493324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207622,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6d/46/e16291f8.jpg","nickname":"ä¸å°æ˜","note":"","ucode":"CC23857B8D75D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":256322,"discussion_content":"ä½†æ˜¯javaä¸­åº•å±‚è¿˜æ˜¯é€šè¿‡casæ¥å®ç°çš„ï¼Œå¹¶æ²¡æœ‰faaã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588471049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004092,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","nickname":"å¼ ä¸‰","note":"","ucode":"1155528FAE1546","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7328,"discussion_content":"åŸæ¥è¿™ä¸ªæ–¹æ³•å°±æ˜¯FAAæŒ‡ä»¤å•Šï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567493971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152988,"user_name":"Sicily9","can_delete":false,"product_type":"c1","uid":1224939,"ip_address":"","ucode":"ECFD642F164EE6","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","comment_is_top":false,"comment_ctime":1574134078,"is_pvip":false,"replies":[{"id":58846,"content":"ä¸ä¼šçš„ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1574208916,"ip_address":"","comment_id":152988,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"æœ‰ä¸€ä¸ªå°ç–‘é—®ï¼Œå…³äºåŸå­æ€§çš„è¯ï¼Œæœ‰ä¸€ä¸ªæç«¯æƒ…å†µï¼Œå¤šæ ¸å¹¶è¡Œæƒ…å†µä¸‹ ä¸¤ä¸ªçº¿ç¨‹ åŒæ—¶åœ¨æ‰§è¡Œä¸€ä¸ªcasåŸè¯­ ä¼šæœ‰å®‰å…¨é—®é¢˜å—","like_count":1,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466055,"discussion_content":"transfer2è¦æ”¾åœ¨å¾ªç¯ä¸­ï¼Œå¦åˆ™æœ‰å¯èƒ½è½¬è´¦å¤±è´¥ã€‚\nå¦å¤–ï¼Œtransfer1ä¸­ï¼Œè™½ç„¶ä¸€ä¸ªç®€å•çš„åŠ æ³•ä¸ä¼šå¼•èµ·ä»»ä½•å¼‚å¸¸ï¼Œä½†æ€»æ˜¯æŠŠunlockæ”¾åˆ°finnallyä¸­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567565043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228967,"user_name":"è¡¹æ˜¯ä¸€æ”¯æ­Œ","can_delete":false,"product_type":"c1","uid":1456239,"ip_address":"","ucode":"9FC36529C9FD2E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/iaZdMmzM0Vfass2ukHOqGgSBbtJMwb4NxDvLdN3R67iczzPVdtF0F0WS0abvls3edQpOVxaUJBmlr2YxHzUpveIQ/132","comment_is_top":false,"comment_ctime":1592872547,"is_pvip":false,"replies":[{"id":84526,"content":"æ˜¯çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼äº‹åŠ¡å¦‚æ­¤ä¹‹éš¾çš„åŸå› ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1592916765,"ip_address":"","comment_id":228967,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"CAS FAAæ˜¯ä¸æ˜¯åªèƒ½ç”¨äºå•æœºæƒ…å†µä¸‹çš„èµ„æºæ§åˆ¶è®¿é—®å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475012,"discussion_content":"ä¸ä¼šçš„ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574208916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1224939,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","nickname":"Sicily9","note":"","ucode":"ECFD642F164EE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":53709,"discussion_content":"è¿™ä¸ªæ˜¯cpu å±‚é¢çš„é”æœºåˆ¶å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574210987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1130590,"avatar":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","nickname":"Ryoma","note":"","ucode":"7F692369239692","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1224939,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b0/eb/43be030a.jpg","nickname":"Sicily9","note":"","ucode":"ECFD642F164EE6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204525,"discussion_content":"å‡†å¤‡æ¥è¯´è¿™ä¸æ˜¯é”ï¼ŒCPU ä¼šå°†è¿™ä¸¤ä¸ªå‘½ä»¤å½“åšä¸€ä¸ªåŸå­ä¸€æ¬¡æ‰§è¡Œï¼Œä¸ä¼šè¢«å…¶å®ƒä»»åŠ¡ä¸­æ–­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584187409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":53709,"ip_address":"","group_id":0},"score":204525,"extra":""}]}]},{"had_liked":false,"id":139168,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1570579764,"is_pvip":false,"replies":[{"id":53642,"content":"CPythonï¼ˆå°±æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„Pythonï¼‰ä¸­ç¡®å®æ²¡æœ‰æä¾›åŸå­æ“ä½œã€‚å¯ä»¥çœ‹ä¸€ä¸‹pypyï¼šhttps:&#47;&#47;pypy.org&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1570583263,"ip_address":"","comment_id":139168,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"Pythonæ²¡æ‰¾åˆ°CASå’ŒFAAçš„å®ç°","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469825,"discussion_content":"CPythonï¼ˆå°±æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„Pythonï¼‰ä¸­ç¡®å®æ²¡æœ‰æä¾›åŸå­æ“ä½œã€‚å¯ä»¥çœ‹ä¸€ä¸‹pypyï¼šhttps://pypy.org/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570583263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131047,"user_name":"é’èˆŸ","can_delete":false,"product_type":"c1","uid":1192732,"ip_address":"","ucode":"2651482AC0DEC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/33/1c/59a4e803.jpg","comment_is_top":false,"comment_ctime":1567608080,"is_pvip":false,"replies":[{"id":49332,"content":"javaé‡Œé¢æœ‰AtomicIntegerç­‰ç­‰å°è£…å¥½çš„ç±»ï¼ŒåŒ…å«äº†CASå’ŒFAAç­‰åŸå­æ“ä½œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567649063,"ip_address":"","comment_id":131047,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100032301,"comment_content":"https:&#47;&#47;github.com&#47;qingzhou413&#47;geektime-mq.git\nåšäº†1000ä¸‡æ¬¡åŠ æ³•ï¼Œ\nLock: 380ms\nCAS: 200ms\nFAA: 280ms","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466264,"discussion_content":"javaé‡Œé¢æœ‰AtomicIntegerç­‰ç­‰å°è£…å¥½çš„ç±»ï¼ŒåŒ…å«äº†CASå’ŒFAAç­‰åŸå­æ“ä½œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567649063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1192732,"avatar":"https://static001.geekbang.org/account/avatar/00/12/33/1c/59a4e803.jpg","nickname":"é’èˆŸ","note":"","ucode":"2651482AC0DEC6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7720,"discussion_content":"å—¯å—¯ï¼Œæˆ‘å®ç°ä¹‹åä¹Ÿçœ‹äº†AtomicIntegerçš„æºç ï¼ŒéªŒè¯ä¸‹è‡ªå·±çš„æ€è·¯æ˜¯ä¸æ˜¯æ­£ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567651207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130714,"user_name":"æ½˜æ”¿å®‡","can_delete":false,"product_type":"c1","uid":1254758,"ip_address":"","ucode":"9A6658EE862D95","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/66/4835d92e.jpg","comment_is_top":false,"comment_ctime":1567516357,"is_pvip":false,"replies":[{"id":48979,"content":"å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼šhttps:&#47;&#47;blog.golang.org&#47;pipelines","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564571,"ip_address":"","comment_id":130714,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"goçš„è¯­æ³•å¤ªå¥‡ç‰¹äº†ï¼Œä»£ç ä¸­çš„doneä½œç”¨æ˜¯ä»€ä¹ˆå•Š","like_count":0},{"had_liked":false,"id":130607,"user_name":"åˆ˜å¤©é¹","can_delete":false,"product_type":"c1","uid":1632015,"ip_address":"","ucode":"FB146250578911","user_header":"https://static001.geekbang.org/account/avatar/00/18/e7/0f/fa840c1b.jpg","comment_is_top":false,"comment_ctime":1567493617,"is_pvip":false,"replies":[{"id":48908,"content":"å…¶å®å¾ˆå¤šå®ç°æ–¹æ³•å’ŒæŠ€å·§éƒ½æ˜¯ç›¸é€šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567514161,"ip_address":"","comment_id":130607,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"å¯¹äº â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°â€\næˆ‘æƒ³èµ·ä¹‹å‰åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†å¹¶å‘çš„ä¿®æ”¹ç”¨æˆ·æ•°æ®(Money)ï¼Œå½“æ—¶çš„åšæ³•æ˜¯\nå…ˆSelectå‡ºç”¨æˆ·çš„Money\nå†å¯¹Moneyåšæ“ä½œ\næœ€ååœ¨Updateçš„æ—¶å€™å¤šé™„åŠ ä¸€ä¸ªæ¡ä»¶ï¼ˆMoney=OldMoneyï¼‰","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466084,"discussion_content":"å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼šhttps://blog.golang.org/pipelines","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555424,"discussion_content":"Go Concurrency Patterns: Pipelines and cancellation\nGoå¹¶å‘æ¨¡å¼ï¼šç®¡é“å’Œå–æ¶ˆ\nhttps://go.dev/blog/pipelines","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646898677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130605,"user_name":"åˆ˜å¤©é¹","can_delete":false,"product_type":"c1","uid":1632015,"ip_address":"","ucode":"FB146250578911","user_header":"https://static001.geekbang.org/account/avatar/00/18/e7/0f/fa840c1b.jpg","comment_is_top":false,"comment_ctime":1567493365,"is_pvip":false,"replies":[{"id":48980,"content":"å°±æ˜¯ç¡®ä¿è¿™ä¸ªèµ‹å€¼ä¹Ÿæ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564769,"ip_address":"","comment_id":130605,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"https:&#47;&#47;gist.github.com&#47;liutianpeng&#47;6f72bca647be41705d68736a79246c2f\nç”¨Golangå®ç°çš„ç‰ˆæœ¬,å…¶å®è€å¸ˆéƒ½å·²ç»å®ç°äº†ï¼ŒTestå’ŒBenchmarkéƒ½åšäº†ï¼Œæœç„¶æ“ä½œæ—¶é—´ FAA &lt; CAS &lt; Mutex\n\nå¦å¤–è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ atomic.LoadXXX è¿™ç»„å‡½æ•°æ˜¯ä»€ä¹ˆä½œç”¨ï¼ˆæˆ–è€…è¯´ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜çš„?ï¼‰\n","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466029,"discussion_content":"å…¶å®å¾ˆå¤šå®ç°æ–¹æ³•å’ŒæŠ€å·§éƒ½æ˜¯ç›¸é€šçš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567514161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2041790,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","nickname":"tongZi","note":"","ucode":"8BBAE4FA37FF79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294746,"discussion_content":"ä½ å¥½ï¼Œè¯·æ•™ä¸‹ï¼Œå¦‚æœæ˜¯2æ ¸æˆ–è€…4æ ¸cpuï¼›æ˜¯å¦ä¼šæœ‰è¿™ç§æç«¯æƒ…å†µï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å»æ›´æ–°æ•°æ®åº“moneyå­—æ®µï¼Œæ˜¯å¦ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595987725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1006789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg","nickname":"æ¢ä¸­å","note":"","ucode":"52FE40242CBAD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7336,"discussion_content":"å°±æ˜¯ä¹è§‚é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567497424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130675,"user_name":"å§œæˆˆ","can_delete":false,"product_type":"c1","uid":1058972,"ip_address":"","ucode":"45C4BE93C8E4CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/28/9c/73e76b19.jpg","comment_is_top":false,"comment_ctime":1567506762,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"JAVAä¸­çš„FAAå’ŒCAS: FAAå°±æ˜¯ç”¨CASå®ç°çš„ã€‚\n\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n        int var5;\n        do {\n            var5 = this.getIntVolatile(var1, var2);\n        } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n        return var5;\n    }","like_count":13},{"had_liked":false,"id":139668,"user_name":"è¾¾æ–‡è¥¿","can_delete":false,"product_type":"c1","uid":1398824,"ip_address":"","ucode":"01C1063F23D634","user_header":"https://static001.geekbang.org/account/avatar/00/15/58/28/c86340ca.jpg","comment_is_top":false,"comment_ctime":1570701621,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"caséœ€è¦æ³¨æ„ aba é—®é¢˜å§","like_count":11,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466027,"discussion_content":"å°±æ˜¯ç¡®ä¿è¿™ä¸ªèµ‹å€¼ä¹Ÿæ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282736,"user_name":"Geek_a5453a","can_delete":false,"product_type":"c1","uid":2462393,"ip_address":"","ucode":"993DF63E38059D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/BKusySicUz9ppf2aZCxe5jMMX2aI8o6kHRRQibFosGEZf7zNFue9OcTsmuicOHOBicZ404Z522AgrTlJa3gSW9AL8w/132","comment_is_top":false,"comment_ctime":1615383027,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"æ²¡æ‡‚ä¸ºä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—çš„è¯¾ä¸€åŠéƒ½æ˜¯åœ¨ä»‹ç»å…¶ä»–ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œæ˜¯æˆ‘å¯¹é«˜æ‰‹è¿™ä¸ªè¯æœ‰è¯¯è§£å—","like_count":6,"discussions":[{"author":{"id":1597566,"avatar":"","nickname":"Geek_yoriba","note":"","ucode":"9754362861F2B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407233,"discussion_content":"è‡ªå·±å†™casçš„éœ€è¦æ³¨æ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634952825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144629,"user_name":"Switch","can_delete":false,"product_type":"c1","uid":1049360,"ip_address":"","ucode":"D8A7F7F6A0BEA9","user_header":"https://static001.geekbang.org/account/avatar/00/10/03/10/26f9f762.jpg","comment_is_top":false,"comment_ctime":1571985406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"javaå®ç°ï¼Œ é”ã€Unsafeç±»ã€AtomicIntegerç±»\n\nhttps:&#47;&#47;github.com&#47;Switch-vov&#47;mq-learing&#47;tree&#47;master&#47;src&#47;main&#47;java&#47;com&#47;switchvov&#47;transfer","like_count":3},{"had_liked":false,"id":130418,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1567460044,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"å¤ä¹ äº†ä¸€ä¸‹Javaä¸­çš„åŸå­ç±»ï¼Œå¯¹åº”åˆ°goé‡Œè¾¹çš„CASå®ç°ä¸­çš„forå¾ªç¯æ˜¯è‡ªæ—‹ï¼Œè¿˜æœ‰å°±æ˜¯è¦æ³¨æ„ABAé—®é¢˜å§ã€‚","like_count":3},{"had_liked":false,"id":281431,"user_name":"haijian.yang","can_delete":false,"product_type":"c1","uid":1162081,"ip_address":"","ucode":"E3D13ABA2CA347","user_header":"https://static001.geekbang.org/account/avatar/00/11/bb/61/2c2f5024.jpg","comment_is_top":false,"comment_ctime":1614748764,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"æ˜¯ä¸æ˜¯åº”è¯¥è¯´ä¸€ä¸‹è¿™éƒ¨åˆ†åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„åº”ç”¨ï¼Ÿ","like_count":2},{"had_liked":false,"id":270932,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1609321735,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":" ç”¨JAVAå®éªŒäº†ä¸‹ï¼Œçœ‹èµ·æ¥åœ¨ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼ŒCASå’ŒLockçš„è€—æ—¶æ˜¯å·®ä¸å¤šçš„ï¼Œæƒ³é—®ä¸‹è€å¸ˆè¿™ç§æƒ…å†µä¸‹æ€ä¹ˆé€‰æ‹©ç”¨Lockè¿˜CASå‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":130714,"user_name":"æ½˜æ”¿å®‡","can_delete":false,"product_type":"c1","uid":1254758,"ip_address":"","ucode":"9A6658EE862D95","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/66/4835d92e.jpg","comment_is_top":false,"comment_ctime":1567516357,"is_pvip":false,"replies":[{"id":48979,"content":"å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼šhttps:&#47;&#47;blog.golang.org&#47;pipelines","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564571,"ip_address":"","comment_id":130714,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"goçš„è¯­æ³•å¤ªå¥‡ç‰¹äº†ï¼Œä»£ç ä¸­çš„doneä½œç”¨æ˜¯ä»€ä¹ˆå•Š","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466084,"discussion_content":"å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼šhttps://blog.golang.org/pipelines","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555424,"discussion_content":"Go Concurrency Patterns: Pipelines and cancellation\nGoå¹¶å‘æ¨¡å¼ï¼šç®¡é“å’Œå–æ¶ˆ\nhttps://go.dev/blog/pipelines","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646898677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130607,"user_name":"åˆ˜å¤©é¹","can_delete":false,"product_type":"c1","uid":1632015,"ip_address":"","ucode":"FB146250578911","user_header":"https://static001.geekbang.org/account/avatar/00/18/e7/0f/fa840c1b.jpg","comment_is_top":false,"comment_ctime":1567493617,"is_pvip":false,"replies":[{"id":48908,"content":"å…¶å®å¾ˆå¤šå®ç°æ–¹æ³•å’ŒæŠ€å·§éƒ½æ˜¯ç›¸é€šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567514161,"ip_address":"","comment_id":130607,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"å¯¹äº â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°â€\næˆ‘æƒ³èµ·ä¹‹å‰åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†å¹¶å‘çš„ä¿®æ”¹ç”¨æˆ·æ•°æ®(Money)ï¼Œå½“æ—¶çš„åšæ³•æ˜¯\nå…ˆSelectå‡ºç”¨æˆ·çš„Money\nå†å¯¹Moneyåšæ“ä½œ\næœ€ååœ¨Updateçš„æ—¶å€™å¤šé™„åŠ ä¸€ä¸ªæ¡ä»¶ï¼ˆMoney=OldMoneyï¼‰","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466029,"discussion_content":"å…¶å®å¾ˆå¤šå®ç°æ–¹æ³•å’ŒæŠ€å·§éƒ½æ˜¯ç›¸é€šçš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567514161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2041790,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","nickname":"tongZi","note":"","ucode":"8BBAE4FA37FF79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294746,"discussion_content":"ä½ å¥½ï¼Œè¯·æ•™ä¸‹ï¼Œå¦‚æœæ˜¯2æ ¸æˆ–è€…4æ ¸cpuï¼›æ˜¯å¦ä¼šæœ‰è¿™ç§æç«¯æƒ…å†µï¼Œä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å»æ›´æ–°æ•°æ®åº“moneyå­—æ®µï¼Œæ˜¯å¦ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595987725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1006789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg","nickname":"æ¢ä¸­å","note":"","ucode":"52FE40242CBAD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7336,"discussion_content":"å°±æ˜¯ä¹è§‚é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567497424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130605,"user_name":"åˆ˜å¤©é¹","can_delete":false,"product_type":"c1","uid":1632015,"ip_address":"","ucode":"FB146250578911","user_header":"https://static001.geekbang.org/account/avatar/00/18/e7/0f/fa840c1b.jpg","comment_is_top":false,"comment_ctime":1567493365,"is_pvip":false,"replies":[{"id":48980,"content":"å°±æ˜¯ç¡®ä¿è¿™ä¸ªèµ‹å€¼ä¹Ÿæ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":1501046,"ctime":1567564769,"ip_address":"","comment_id":130605,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"https:&#47;&#47;gist.github.com&#47;liutianpeng&#47;6f72bca647be41705d68736a79246c2f\nç”¨Golangå®ç°çš„ç‰ˆæœ¬,å…¶å®è€å¸ˆéƒ½å·²ç»å®ç°äº†ï¼ŒTestå’ŒBenchmarkéƒ½åšäº†ï¼Œæœç„¶æ“ä½œæ—¶é—´ FAA &lt; CAS &lt; Mutex\n\nå¦å¤–è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ atomic.LoadXXX è¿™ç»„å‡½æ•°æ˜¯ä»€ä¹ˆä½œç”¨ï¼ˆæˆ–è€…è¯´ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜çš„?ï¼‰\n","like_count":0,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466027,"discussion_content":"å°±æ˜¯ç¡®ä¿è¿™ä¸ªèµ‹å€¼ä¹Ÿæ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567564769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130675,"user_name":"å§œæˆˆ","can_delete":false,"product_type":"c1","uid":1058972,"ip_address":"","ucode":"45C4BE93C8E4CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/28/9c/73e76b19.jpg","comment_is_top":false,"comment_ctime":1567506762,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"JAVAä¸­çš„FAAå’ŒCAS: FAAå°±æ˜¯ç”¨CASå®ç°çš„ã€‚\n\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n        int var5;\n        do {\n            var5 = this.getIntVolatile(var1, var2);\n        } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n        return var5;\n    }","like_count":13},{"had_liked":false,"id":139668,"user_name":"è¾¾æ–‡è¥¿","can_delete":false,"product_type":"c1","uid":1398824,"ip_address":"","ucode":"01C1063F23D634","user_header":"https://static001.geekbang.org/account/avatar/00/15/58/28/c86340ca.jpg","comment_is_top":false,"comment_ctime":1570701621,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"caséœ€è¦æ³¨æ„ aba é—®é¢˜å§","like_count":11,"discussions":[{"author":{"id":1597566,"avatar":"","nickname":"Geek_yoriba","note":"","ucode":"9754362861F2B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407233,"discussion_content":"è‡ªå·±å†™casçš„éœ€è¦æ³¨æ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634952825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282736,"user_name":"Geek_a5453a","can_delete":false,"product_type":"c1","uid":2462393,"ip_address":"","ucode":"993DF63E38059D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/BKusySicUz9ppf2aZCxe5jMMX2aI8o6kHRRQibFosGEZf7zNFue9OcTsmuicOHOBicZ404Z522AgrTlJa3gSW9AL8w/132","comment_is_top":false,"comment_ctime":1615383027,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"æ²¡æ‡‚ä¸ºä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—çš„è¯¾ä¸€åŠéƒ½æ˜¯åœ¨ä»‹ç»å…¶ä»–ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œæ˜¯æˆ‘å¯¹é«˜æ‰‹è¿™ä¸ªè¯æœ‰è¯¯è§£å—","like_count":6,"discussions":[{"author":{"id":1590610,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/B9vSOjMc2a86kYA8R5yDkVdFiaj2JeBZ1PuI9oUKhbnvuZwuibdUam6FTcGzDaiaFdk2GWJveUGhfCVpv4KaOdicoQ/132","nickname":"å¸æ±Ÿ","note":"","ucode":"93CBA4E4D05DA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379237,"discussion_content":"å¦‚æœä»…ä»…æ˜¯ä¼šç”¨çš„è¯ï¼Œå‰é¢å‡ èŠ‚è¯¾å°±å¤Ÿç”¨äº†ã€‚ä½œè€…åº”è¯¥æ˜¯æƒ³æŠŠå’±åŸ¹å…»çš„èƒ½è‡ªå·±å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæœ€æ¬¡ä¹Ÿæ˜¯çŸ¥é“ç»†èŠ‚ï¼Œç”¨èµ·æ¥å¤§èƒ†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1623765403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144629,"user_name":"Switch","can_delete":false,"product_type":"c1","uid":1049360,"ip_address":"","ucode":"D8A7F7F6A0BEA9","user_header":"https://static001.geekbang.org/account/avatar/00/10/03/10/26f9f762.jpg","comment_is_top":false,"comment_ctime":1571985406,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"javaå®ç°ï¼Œ é”ã€Unsafeç±»ã€AtomicIntegerç±»\n\nhttps:&#47;&#47;github.com&#47;Switch-vov&#47;mq-learing&#47;tree&#47;master&#47;src&#47;main&#47;java&#47;com&#47;switchvov&#47;transfer","like_count":3},{"had_liked":false,"id":130418,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1567460044,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"å¤ä¹ äº†ä¸€ä¸‹Javaä¸­çš„åŸå­ç±»ï¼Œå¯¹åº”åˆ°goé‡Œè¾¹çš„CASå®ç°ä¸­çš„forå¾ªç¯æ˜¯è‡ªæ—‹ï¼Œè¿˜æœ‰å°±æ˜¯è¦æ³¨æ„ABAé—®é¢˜å§ã€‚","like_count":3},{"had_liked":false,"id":281431,"user_name":"haijian.yang","can_delete":false,"product_type":"c1","uid":1162081,"ip_address":"","ucode":"E3D13ABA2CA347","user_header":"https://static001.geekbang.org/account/avatar/00/11/bb/61/2c2f5024.jpg","comment_is_top":false,"comment_ctime":1614748764,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":"æ˜¯ä¸æ˜¯åº”è¯¥è¯´ä¸€ä¸‹è¿™éƒ¨åˆ†åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„åº”ç”¨ï¼Ÿ","like_count":2},{"had_liked":false,"id":270932,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1609321735,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100032301,"comment_content":" ç”¨JAVAå®éªŒäº†ä¸‹ï¼Œçœ‹èµ·æ¥åœ¨ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼ŒCASå’ŒLockçš„è€—æ—¶æ˜¯å·®ä¸å¤šçš„ï¼Œæƒ³é—®ä¸‹è€å¸ˆè¿™ç§æƒ…å†µä¸‹æ€ä¹ˆé€‰æ‹©ç”¨Lockè¿˜CASå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1590610,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/B9vSOjMc2a86kYA8R5yDkVdFiaj2JeBZ1PuI9oUKhbnvuZwuibdUam6FTcGzDaiaFdk2GWJveUGhfCVpv4KaOdicoQ/132","nickname":"å¸æ±Ÿ","note":"","ucode":"93CBA4E4D05DA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379237,"discussion_content":"å¦‚æœä»…ä»…æ˜¯ä¼šç”¨çš„è¯ï¼Œå‰é¢å‡ èŠ‚è¯¾å°±å¤Ÿç”¨äº†ã€‚ä½œè€…åº”è¯¥æ˜¯æƒ³æŠŠå’±åŸ¹å…»çš„èƒ½è‡ªå·±å®ç°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæœ€æ¬¡ä¹Ÿæ˜¯çŸ¥é“ç»†èŠ‚ï¼Œç”¨èµ·æ¥å¤§èƒ†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1623765403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135575,"user_name":"é¡¶æ–°","can_delete":false,"product_type":"c1","uid":1036566,"ip_address":"","ucode":"241D3CCCAE536B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d1/16/6347bbc0.jpg","comment_is_top":false,"comment_ctime":1569218253,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":".net å®ç°ä»£ç ï¼š\nlock å®ç°ï¼š\nstatic void transfer(object amount)\n        {\n            lock (obj)\n            {\n                balance = balance + Convert.ToInt32(amount);\n            }            \n        }\ncas å®ç°ï¼š\nstatic void transfer_cas(object amount)\n        {\n            int initialValue, computedValue;\n            do\n            {\n                initialValue = balance;                \n                computedValue = initialValue + Convert.ToInt32(amount);                \n            } while (initialValue != Interlocked.CompareExchange(\n                ref balance, computedValue, initialValue));\n        }\n\nfaa å®ç°ï¼š\nstatic void transfer_faa(object amount){\n            Interlocked.Add(ref balance,Convert.ToInt32(amount));\n        }\n","like_count":2},{"had_liked":false,"id":130639,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1567499441,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"   æ‰“å¡ï¼šè€å¸ˆä¸€æ­¥æ­¥å‰¥ç¦»ä¸€å±‚å±‚æ‹¨å¼€å®è´¨-åˆæ¶¨çŸ¥è¯†äº†ï¼ŒæœŸå¾…è€å¸ˆçš„ä¸‹èŠ‚è¯¾ã€‚","like_count":2},{"had_liked":false,"id":333493,"user_name":"å¯¥è‹¥æ™¨æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1447739,"ip_address":"","ucode":"2E87E43687DE72","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eou1BMETumU21ZI4yiaLenOMSibzkAgkw944npIpsJRicmdicxlVQcgibyoQ00rdGk9Htp1j0dM5CP2Fibw/132","comment_is_top":false,"comment_ctime":1644385374,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"yieldé‚£æ®µæœ‰é—®é¢˜ï¼Œä½¿ç”¨yieldä¼šè®©å‡ºcpuï¼Œå¯¼è‡´ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œäº§ç”Ÿç³»ç»Ÿå¼€é”€ï¼Œè¿™æ ·è¿˜ä¸å¦‚ç”¨é”å‘¢ã€‚ã€‚ã€‚è¿èƒŒäº†ä½¿ç”¨CASçš„åˆè¡·","like_count":1},{"had_liked":false,"id":311973,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1631582105,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"è¿™ä¸ªFAAçš„åŸè¯­ä¸ºä»€ä¹ˆæ˜¯å…ˆè·å–ä¹‹å‰çš„å€¼xï¼Œç„¶ååšè®¡ç®—x+aï¼Œæœ€åè¿”å›x?","like_count":1},{"had_liked":false,"id":288211,"user_name":"LQS  KF","can_delete":false,"product_type":"c1","uid":1364737,"ip_address":"","ucode":"3C0A07A8220094","user_header":"https://static001.geekbang.org/account/avatar/00/14/d3/01/716d45b6.jpg","comment_is_top":false,"comment_ctime":1618365941,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"è½¬è´¦æœåŠ¡æ¶‰åŠä¸¤ä¸ªè´¦æˆ·çš„åŸå­æ€§æ“ä½œï¼Œæ„Ÿè§‰è¿˜æ˜¯ç”¨é”æ¯”è¾ƒå¥½ï¼Œæ–‡ç« ä¸­åªæ“ä½œäº†æ¥å—è½¬è´¦çš„å•è´¦å·åŸå­æ“ä½œï¼Œä¸ªäººè§‰å¾—ä¸å¦¥ã€‚","like_count":1},{"had_liked":false,"id":389872,"user_name":"TheOne","can_delete":false,"product_type":"c1","uid":1582134,"ip_address":"åŒ—äº¬","ucode":"2A359780156A8B","user_header":"https://static001.geekbang.org/account/avatar/00/18/24/36/0829cbdc.jpg","comment_is_top":false,"comment_ctime":1713748970,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"casæ„Ÿè§‰å¾ˆåƒä¹è§‚é”ï¼Ÿ","like_count":0},{"had_liked":false,"id":376656,"user_name":"å¤§å¤´","can_delete":false,"product_type":"c1","uid":1315367,"ip_address":"åŒ—äº¬","ucode":"C1FB2C8A0FB0C0","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/27/32746bbf.jpg","comment_is_top":false,"comment_ctime":1687170917,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"@Getter\npublic class CasTest {\n\n    private int balance = 0;\n\n    static ExecutorService executorService = new ThreadPoolExecutor(\n            4,\n            4,\n            0,\n            TimeUnit.MINUTES,\n            new LinkedBlockingQueue&lt;&gt;(2000));\n\n\n    public static void main(String[] args) throws Exception {\n        Unsafe unsafe = getUnsafe();\n\n        Field cntField = CasTest.class.getDeclaredField(&quot;balance&quot;);\n\n        final int threadSize = 1000;\n        CasTest example = new CasTest();\n        final CountDownLatch countDownLatch = new CountDownLatch(threadSize);\n\n        for (int i = 0; i &lt; threadSize; i++) {\n            executorService.execute(() -&gt; {\n                unsafe.getAndAddInt(example, unsafe.objectFieldOffset(cntField), 1);\n                countDownLatch.countDown();\n            });\n        }\n        countDownLatch.await();\n        executorService.shutdown();\n        System.out.println(example.getBalance());\n    }\n\n    private static Unsafe getUnsafe() throws NoSuchFieldException, IllegalAccessException {\n        Class klass = Unsafe.class;\n        Field field = klass.getDeclaredField(&quot;theUnsafe&quot;);\n        field.setAccessible(true);\n        Unsafe unsafe = (Unsafe) field.get(null);\n        return unsafe;\n    }\n\n\n}","like_count":0},{"had_liked":false,"id":364729,"user_name":"Jussi Lee","can_delete":false,"product_type":"c1","uid":1211190,"ip_address":"å¹¿ä¸œ","ucode":"F2F5948CCD52A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/36/fd46331c.jpg","comment_is_top":false,"comment_ctime":1671420368,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"Java å¯ä»¥ç”¨completedFuture å®ç°æ¯”è¾ƒæ–¹ä¾¿ä¸€äº›","like_count":0},{"had_liked":false,"id":296417,"user_name":"ç¦»å¢ƒâ€","can_delete":false,"product_type":"c1","uid":1895314,"ip_address":"","ucode":"7186EF2BEF8956","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/STqKg1kLgvRuduQfo0R2E2osYBian7XrQAjSWmOwL9nyZVhq7vyLPnlGcgvguFV4aV7ToWLFiauEMKy96KWHKBVg/132","comment_is_top":false,"comment_ctime":1622966748,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘çš„å®éªŒç»“æœï¼ŒåŠ é”æ–¹å¼æ¯”caså¿«è®¸å¤š","like_count":0},{"had_liked":false,"id":278313,"user_name":"ç¿¡ç¿ è™","can_delete":false,"product_type":"c1","uid":1448015,"ip_address":"","ucode":"2572E93C4C57A5","user_header":"https://static001.geekbang.org/account/avatar/00/16/18/4f/9e4d5591.jpg","comment_is_top":false,"comment_ctime":1612868482,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"æˆ‘åœ¨è€å¸ˆæˆ‘åœ¨è€å¸ˆç»™çš„ GOLANG CAS ç¤ºä¾‹çš„åŸºç¡€ä¸Šæ‰©å±•äº† demoï¼Œå¢åŠ äº†æ–‡ä»¶è¿½åŠ å†™çš„å‡½æ•°ã€‚ç›®å‰ gorouting 2 ä¸‡æ¬¡ï¼Œæ—¥å¿—è®°å½•åˆ°æœ‰ CAS å¤±è´¥çš„æƒ…å†µï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰ï¼Œæœ€åå†™å…¥åˆ°æ–‡ä»¶çš„å†…å®¹éƒ½æ˜¯æ­£ç¡®çš„ã€‚æˆ‘æƒ³é—®é—®ï¼Œè€å¸ˆç»™çš„è¿™ä¸ª GOLANG CAS ç¤ºä¾‹ï¼Œå¥½åƒä¸å­˜åœ¨ ABA é—®é¢˜ï¼Œå¯¹å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2851542,"avatar":"","nickname":"æˆ‘è¦å†™ä»£ç ï¼","note":"","ucode":"0859B8BFA7834A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565927,"discussion_content":"æˆ‘ä¹Ÿæƒ³é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650555972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135575,"user_name":"é¡¶æ–°","can_delete":false,"product_type":"c1","uid":1036566,"ip_address":"","ucode":"241D3CCCAE536B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d1/16/6347bbc0.jpg","comment_is_top":false,"comment_ctime":1569218253,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":".net å®ç°ä»£ç ï¼š\nlock å®ç°ï¼š\nstatic void transfer(object amount)\n        {\n            lock (obj)\n            {\n                balance = balance + Convert.ToInt32(amount);\n            }            \n        }\ncas å®ç°ï¼š\nstatic void transfer_cas(object amount)\n        {\n            int initialValue, computedValue;\n            do\n            {\n                initialValue = balance;                \n                computedValue = initialValue + Convert.ToInt32(amount);                \n            } while (initialValue != Interlocked.CompareExchange(\n                ref balance, computedValue, initialValue));\n        }\n\nfaa å®ç°ï¼š\nstatic void transfer_faa(object amount){\n            Interlocked.Add(ref balance,Convert.ToInt32(amount));\n        }\n","like_count":2},{"had_liked":false,"id":130639,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1567499441,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"   æ‰“å¡ï¼šè€å¸ˆä¸€æ­¥æ­¥å‰¥ç¦»ä¸€å±‚å±‚æ‹¨å¼€å®è´¨-åˆæ¶¨çŸ¥è¯†äº†ï¼ŒæœŸå¾…è€å¸ˆçš„ä¸‹èŠ‚è¯¾ã€‚","like_count":2},{"had_liked":false,"id":333493,"user_name":"å¯¥è‹¥æ™¨æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1447739,"ip_address":"","ucode":"2E87E43687DE72","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eou1BMETumU21ZI4yiaLenOMSibzkAgkw944npIpsJRicmdicxlVQcgibyoQ00rdGk9Htp1j0dM5CP2Fibw/132","comment_is_top":false,"comment_ctime":1644385374,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"yieldé‚£æ®µæœ‰é—®é¢˜ï¼Œä½¿ç”¨yieldä¼šè®©å‡ºcpuï¼Œå¯¼è‡´ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Œäº§ç”Ÿç³»ç»Ÿå¼€é”€ï¼Œè¿™æ ·è¿˜ä¸å¦‚ç”¨é”å‘¢ã€‚ã€‚ã€‚è¿èƒŒäº†ä½¿ç”¨CASçš„åˆè¡·","like_count":1},{"had_liked":false,"id":311973,"user_name":"Eleven","can_delete":false,"product_type":"c1","uid":1168452,"ip_address":"","ucode":"FB4A0C8CA732BE","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg","comment_is_top":false,"comment_ctime":1631582105,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"è¿™ä¸ªFAAçš„åŸè¯­ä¸ºä»€ä¹ˆæ˜¯å…ˆè·å–ä¹‹å‰çš„å€¼xï¼Œç„¶ååšè®¡ç®—x+aï¼Œæœ€åè¿”å›x?","like_count":1,"discussions":[{"author":{"id":2851542,"avatar":"","nickname":"æˆ‘è¦å†™ä»£ç ï¼","note":"","ucode":"0859B8BFA7834A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565927,"discussion_content":"æˆ‘ä¹Ÿæƒ³é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650555972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288211,"user_name":"LQS  KF","can_delete":false,"product_type":"c1","uid":1364737,"ip_address":"","ucode":"3C0A07A8220094","user_header":"https://static001.geekbang.org/account/avatar/00/14/d3/01/716d45b6.jpg","comment_is_top":false,"comment_ctime":1618365941,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"è½¬è´¦æœåŠ¡æ¶‰åŠä¸¤ä¸ªè´¦æˆ·çš„åŸå­æ€§æ“ä½œï¼Œæ„Ÿè§‰è¿˜æ˜¯ç”¨é”æ¯”è¾ƒå¥½ï¼Œæ–‡ç« ä¸­åªæ“ä½œäº†æ¥å—è½¬è´¦çš„å•è´¦å·åŸå­æ“ä½œï¼Œä¸ªäººè§‰å¾—ä¸å¦¥ã€‚","like_count":1},{"had_liked":false,"id":389872,"user_name":"TheOne","can_delete":false,"product_type":"c1","uid":1582134,"ip_address":"åŒ—äº¬","ucode":"2A359780156A8B","user_header":"https://static001.geekbang.org/account/avatar/00/18/24/36/0829cbdc.jpg","comment_is_top":false,"comment_ctime":1713748970,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"casæ„Ÿè§‰å¾ˆåƒä¹è§‚é”ï¼Ÿ","like_count":0},{"had_liked":false,"id":376656,"user_name":"å¤§å¤´","can_delete":false,"product_type":"c1","uid":1315367,"ip_address":"åŒ—äº¬","ucode":"C1FB2C8A0FB0C0","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/27/32746bbf.jpg","comment_is_top":false,"comment_ctime":1687170917,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"@Getter\npublic class CasTest {\n\n    private int balance = 0;\n\n    static ExecutorService executorService = new ThreadPoolExecutor(\n            4,\n            4,\n            0,\n            TimeUnit.MINUTES,\n            new LinkedBlockingQueue&lt;&gt;(2000));\n\n\n    public static void main(String[] args) throws Exception {\n        Unsafe unsafe = getUnsafe();\n\n        Field cntField = CasTest.class.getDeclaredField(&quot;balance&quot;);\n\n        final int threadSize = 1000;\n        CasTest example = new CasTest();\n        final CountDownLatch countDownLatch = new CountDownLatch(threadSize);\n\n        for (int i = 0; i &lt; threadSize; i++) {\n            executorService.execute(() -&gt; {\n                unsafe.getAndAddInt(example, unsafe.objectFieldOffset(cntField), 1);\n                countDownLatch.countDown();\n            });\n        }\n        countDownLatch.await();\n        executorService.shutdown();\n        System.out.println(example.getBalance());\n    }\n\n    private static Unsafe getUnsafe() throws NoSuchFieldException, IllegalAccessException {\n        Class klass = Unsafe.class;\n        Field field = klass.getDeclaredField(&quot;theUnsafe&quot;);\n        field.setAccessible(true);\n        Unsafe unsafe = (Unsafe) field.get(null);\n        return unsafe;\n    }\n\n\n}","like_count":0},{"had_liked":false,"id":364729,"user_name":"Jussi Lee","can_delete":false,"product_type":"c1","uid":1211190,"ip_address":"å¹¿ä¸œ","ucode":"F2F5948CCD52A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/36/fd46331c.jpg","comment_is_top":false,"comment_ctime":1671420368,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"Java å¯ä»¥ç”¨completedFuture å®ç°æ¯”è¾ƒæ–¹ä¾¿ä¸€äº›","like_count":0},{"had_liked":false,"id":296417,"user_name":"ç¦»å¢ƒâ€","can_delete":false,"product_type":"c1","uid":1895314,"ip_address":"","ucode":"7186EF2BEF8956","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/STqKg1kLgvRuduQfo0R2E2osYBian7XrQAjSWmOwL9nyZVhq7vyLPnlGcgvguFV4aV7ToWLFiauEMKy96KWHKBVg/132","comment_is_top":false,"comment_ctime":1622966748,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘çš„å®éªŒç»“æœï¼ŒåŠ é”æ–¹å¼æ¯”caså¿«è®¸å¤š","like_count":0},{"had_liked":false,"id":278313,"user_name":"ç¿¡ç¿ è™","can_delete":false,"product_type":"c1","uid":1448015,"ip_address":"","ucode":"2572E93C4C57A5","user_header":"https://static001.geekbang.org/account/avatar/00/16/18/4f/9e4d5591.jpg","comment_is_top":false,"comment_ctime":1612868482,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100032301,"comment_content":"æˆ‘åœ¨è€å¸ˆæˆ‘åœ¨è€å¸ˆç»™çš„ GOLANG CAS ç¤ºä¾‹çš„åŸºç¡€ä¸Šæ‰©å±•äº† demoï¼Œå¢åŠ äº†æ–‡ä»¶è¿½åŠ å†™çš„å‡½æ•°ã€‚ç›®å‰ gorouting 2 ä¸‡æ¬¡ï¼Œæ—¥å¿—è®°å½•åˆ°æœ‰ CAS å¤±è´¥çš„æƒ…å†µï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰ï¼Œæœ€åå†™å…¥åˆ°æ–‡ä»¶çš„å†…å®¹éƒ½æ˜¯æ­£ç¡®çš„ã€‚æˆ‘æƒ³é—®é—®ï¼Œè€å¸ˆç»™çš„è¿™ä¸ª GOLANG CAS ç¤ºä¾‹ï¼Œå¥½åƒä¸å­˜åœ¨ ABA é—®é¢˜ï¼Œå¯¹å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":277909,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1612666802,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"https:&#47;&#47;github.com&#47;HeavenXin&#47;geektime_message_queue&#47;tree&#47;master&#47;src18","like_count":0},{"had_liked":false,"id":237907,"user_name":"tongZi","can_delete":false,"product_type":"c1","uid":2041790,"ip_address":"","ucode":"8BBAE4FA37FF79","user_header":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","comment_is_top":false,"comment_ctime":1596002595,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"â€œå¦‚æœçº¿ç¨‹ä¹‹é—´çš„ç¢°æ’éå¸¸é¢‘ç¹ï¼Œç»å¸¸æ€§çš„åå¤é‡è¯•ï¼Œè¿™ä¸ªé‡è¯•çš„çº¿ç¨‹ä¼šå ç”¨å¤§é‡çš„ CPU æ—¶é—´ï¼Œéšä¹‹ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å°±ä¼šä¸‹é™ã€‚â€\nè€å¸ˆä½ å¥½ï¼Œè¯·é—®è¿™ä¸ªé‡è¯•çš„çº¿ç¨‹ä¸ºä»€ä¹ˆä¼šå ç”¨â€œå¤§é‡â€çš„cpuæ—¶é—´ï¼Ÿï¼Ÿ\nä¼šæ¯”å…¶å®ƒæ­£å¸¸è¯·æ±‚çš„çº¿ç¨‹ï¼Œå ç”¨æ—¶é—´æ›´å¤šå—ï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":237860,"user_name":"tongZi","can_delete":false,"product_type":"c1","uid":2041790,"ip_address":"","ucode":"8BBAE4FA37FF79","user_header":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","comment_is_top":false,"comment_ctime":1595987893,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"==å¯¹äº â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°â€\næˆ‘æƒ³èµ·ä¹‹å‰åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†å¹¶å‘çš„ä¿®æ”¹ç”¨æˆ·æ•°æ®(Money)ï¼Œå½“æ—¶çš„åšæ³•æ˜¯\nå…ˆSelectå‡ºç”¨æˆ·çš„Money\nå†å¯¹Moneyåšæ“ä½œ\næœ€ååœ¨Updateçš„æ—¶å€™å¤šé™„åŠ ä¸€ä¸ªæ¡ä»¶ï¼ˆMoney=OldMoneyï¼‰==\nè€å¸ˆæ‚¨å¥½ï¼Œè¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœcpuå¤šæ ¸å¹¶è¡Œï¼Œå‡å¦‚æç«¯æƒ…å†µï¼Œå¤šçº¿ç¨‹åŒæ—¶å»æ›´æ–°moneyå­—æ®µï¼Œæ˜¯å¦ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":233837,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1594468775,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"public class CASTest implements Runnable{\n    private AtomicInteger account;\n    private CountDownLatch latch;\n\n    public CASTest(CountDownLatch latch, AtomicInteger account){\n        this.account = account;\n        this.latch = latch;\n    }\n\n    @Override\n    public void run() {\n        while (!account.compareAndSet(account.get(), account.get() + 1)){}\n        latch.countDown();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        StopWatch stopWatch = new StopWatch();\n        stopWatch.start();\n        int THREAD_NUM = 10000;\n        int cpuCore = Runtime.getRuntime().availableProcessors();\n        AtomicInteger account = new AtomicInteger(0);\n        CountDownLatch latch = new CountDownLatch(THREAD_NUM);\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(cpuCore + 1, THREAD_NUM, 0,\n                TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(65536));\n        for(int i = 0;i &lt; THREAD_NUM;++i) {\n            executor.execute(new CASTest(latch, account));\n        }\n        latch.await();\n        System.out.println(account.get());\n        System.out.println(stopWatch.getTime());\n        executor.shutdown();\n    }\n}","like_count":0},{"had_liked":false,"id":230379,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1593357460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæƒ³è¯·æ•™ä¸‹å¦‚ä½•æ£€æµ‹çº¿ç¨‹ç¢°æ’æ˜¯å¦é¢‘ç¹å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":213544,"user_name":"ä¸å°æ˜","can_delete":false,"product_type":"c1","uid":1207622,"ip_address":"","ucode":"CC23857B8D75D5","user_header":"https://static001.geekbang.org/account/avatar/00/12/6d/46/e16291f8.jpg","comment_is_top":false,"comment_ctime":1588471180,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"ç¿»çœ‹äº†ä¸€ä¸‹javaä¸­çš„unsafeç±»ï¼Œè™½ç„¶æä¾›äº†faaçš„æ–¹æ³•ï¼Œä½†æ˜¯å®ç°è¿˜æ˜¯é€šè¿‡casï¼Œä¸ºä»€ä¹ˆjavaæ²¡æœ‰ç›´æ¥æä¾›faaå‘¢","like_count":0},{"had_liked":false,"id":190200,"user_name":"åŠªåŠ›å‘¼å¸","can_delete":false,"product_type":"c1","uid":1718303,"ip_address":"","ucode":"52941DD7A01BBA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKDfO7wKibzpw4YsoqLRCHUKxX4rYRUh7m7RCdOwzWVaN9QLlhcU5ho3w2Qcpib1O69YPj65ib07xQBQ/132","comment_is_top":false,"comment_ctime":1584613339,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"public class Cas {\n    private static AtomicInteger balance = new AtomicInteger(0);\n\n    private static CountDownLatch countDownLatch = new CountDownLatch(10000);\n\n    private static void transforFaa() {\n        balance.addAndGet(1);\n        countDownLatch.countDown();\n    }\n\n    private static void transforCas() {\n        int oldVal = balance.get();\n        int newVal = oldVal + 1;\n        balance.compareAndSet(oldVal, newVal);\n        countDownLatch.countDown();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        for (int j = 0; j &lt; 10000; j++) {\n            CompletableFuture.runAsync(() -&gt; Cas.transforCas());\n        }\n        countDownLatch.await();\n        System.out.println(balance.get());\n    }\n}","like_count":0},{"had_liked":false,"id":181877,"user_name":"é»‘å±±è€å¦–","can_delete":false,"product_type":"c1","uid":1115958,"ip_address":"","ucode":"A1659F99C5BE1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/36/d677e741.jpg","comment_is_top":false,"comment_ctime":1582652923,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"æ¸…æ™°","like_count":0},{"had_liked":false,"id":145917,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":1595382,"ip_address":"","ucode":"A77322C4E07B2D","user_header":"https://static001.geekbang.org/account/avatar/00/18/57/f6/2c7ac1ad.jpg","comment_is_top":false,"comment_ctime":1572402160,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"äº¤ä½œä¸šï¼šhttps:&#47;&#47;github.com&#47;PeterLu798&#47;MQ&#47;tree&#47;master&#47;src&#47;com&#47;lbj&#47;mq&#47;lock\nLockBalance.javaä½¿ç”¨Javaç‹¬å é”å®ç°ï¼Œå¹³å‡è€—æ—¶ 300æ¯«ç§’å·¦å³\nCASBalance.javaä½¿ç”¨AtomicIntegerå®ç°ï¼Œå¹³å‡è€—æ—¶250æ¯«ç§’å·¦å³","like_count":0},{"had_liked":false,"id":135997,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569322827,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"ä¹‹å‰åªçŸ¥CASï¼Œè¿˜æœ‰FAAï¼Œæƒ³å¿…åº”è¯¥æœ‰ä¸€å¨ç±»ä¼¼çš„åŸè¯­ã€‚æ‰“å¡ï¼Œæ„Ÿè°¢ï¼Œåˆå¢é•¿äº†ä¸€ç‚¹è§è¯†ã€‚","like_count":0,"discussions":[{"author":{"id":2861929,"avatar":"http://thirdwx.qlogo.cn/mmopen/2kpMNDYsSfCibibkl1x62jWodYGcwS2OZJhBW347gy4VsA1U8bUyBNxGx9XxMeWuAW98SpHYiaI470H1xziarib8YvYSB0ZnngbCW/132","nickname":"ğŸ·æ¨ç£Šç£Š","note":"","ucode":"858C3FBFF7F023","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612311,"discussion_content":"åªä¼šç¢°æ’ï¼Œä½†æ˜¯å®‰å…¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680597459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277909,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1612666802,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"https:&#47;&#47;github.com&#47;HeavenXin&#47;geektime_message_queue&#47;tree&#47;master&#47;src18","like_count":0},{"had_liked":false,"id":237907,"user_name":"tongZi","can_delete":false,"product_type":"c1","uid":2041790,"ip_address":"","ucode":"8BBAE4FA37FF79","user_header":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","comment_is_top":false,"comment_ctime":1596002595,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"â€œå¦‚æœçº¿ç¨‹ä¹‹é—´çš„ç¢°æ’éå¸¸é¢‘ç¹ï¼Œç»å¸¸æ€§çš„åå¤é‡è¯•ï¼Œè¿™ä¸ªé‡è¯•çš„çº¿ç¨‹ä¼šå ç”¨å¤§é‡çš„ CPU æ—¶é—´ï¼Œéšä¹‹ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å°±ä¼šä¸‹é™ã€‚â€\nè€å¸ˆä½ å¥½ï¼Œè¯·é—®è¿™ä¸ªé‡è¯•çš„çº¿ç¨‹ä¸ºä»€ä¹ˆä¼šå ç”¨â€œå¤§é‡â€çš„cpuæ—¶é—´ï¼Ÿï¼Ÿ\nä¼šæ¯”å…¶å®ƒæ­£å¸¸è¯·æ±‚çš„çº¿ç¨‹ï¼Œå ç”¨æ—¶é—´æ›´å¤šå—ï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":237860,"user_name":"tongZi","can_delete":false,"product_type":"c1","uid":2041790,"ip_address":"","ucode":"8BBAE4FA37FF79","user_header":"https://static001.geekbang.org/account/avatar/00/1f/27/be/b666abb4.jpg","comment_is_top":false,"comment_ctime":1595987893,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"==å¯¹äº â€œCAS å’Œ FAA åœ¨å„ç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°â€\næˆ‘æƒ³èµ·ä¹‹å‰åœ¨æ“ä½œæ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†å¹¶å‘çš„ä¿®æ”¹ç”¨æˆ·æ•°æ®(Money)ï¼Œå½“æ—¶çš„åšæ³•æ˜¯\nå…ˆSelectå‡ºç”¨æˆ·çš„Money\nå†å¯¹Moneyåšæ“ä½œ\næœ€ååœ¨Updateçš„æ—¶å€™å¤šé™„åŠ ä¸€ä¸ªæ¡ä»¶ï¼ˆMoney=OldMoneyï¼‰==\nè€å¸ˆæ‚¨å¥½ï¼Œè¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœcpuå¤šæ ¸å¹¶è¡Œï¼Œå‡å¦‚æç«¯æƒ…å†µï¼Œå¤šçº¿ç¨‹åŒæ—¶å»æ›´æ–°moneyå­—æ®µï¼Œæ˜¯å¦ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2861929,"avatar":"http://thirdwx.qlogo.cn/mmopen/2kpMNDYsSfCibibkl1x62jWodYGcwS2OZJhBW347gy4VsA1U8bUyBNxGx9XxMeWuAW98SpHYiaI470H1xziarib8YvYSB0ZnngbCW/132","nickname":"ğŸ·æ¨ç£Šç£Š","note":"","ucode":"858C3FBFF7F023","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612311,"discussion_content":"åªä¼šç¢°æ’ï¼Œä½†æ˜¯å®‰å…¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680597459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233837,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1594468775,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"public class CASTest implements Runnable{\n    private AtomicInteger account;\n    private CountDownLatch latch;\n\n    public CASTest(CountDownLatch latch, AtomicInteger account){\n        this.account = account;\n        this.latch = latch;\n    }\n\n    @Override\n    public void run() {\n        while (!account.compareAndSet(account.get(), account.get() + 1)){}\n        latch.countDown();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        StopWatch stopWatch = new StopWatch();\n        stopWatch.start();\n        int THREAD_NUM = 10000;\n        int cpuCore = Runtime.getRuntime().availableProcessors();\n        AtomicInteger account = new AtomicInteger(0);\n        CountDownLatch latch = new CountDownLatch(THREAD_NUM);\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(cpuCore + 1, THREAD_NUM, 0,\n                TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(65536));\n        for(int i = 0;i &lt; THREAD_NUM;++i) {\n            executor.execute(new CASTest(latch, account));\n        }\n        latch.await();\n        System.out.println(account.get());\n        System.out.println(stopWatch.getTime());\n        executor.shutdown();\n    }\n}","like_count":0},{"had_liked":false,"id":230379,"user_name":"Khirye","can_delete":false,"product_type":"c1","uid":1080985,"ip_address":"","ucode":"6C54C126FA54B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/99/c4302030.jpg","comment_is_top":false,"comment_ctime":1593357460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæƒ³è¯·æ•™ä¸‹å¦‚ä½•æ£€æµ‹çº¿ç¨‹ç¢°æ’æ˜¯å¦é¢‘ç¹å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":213544,"user_name":"ä¸å°æ˜","can_delete":false,"product_type":"c1","uid":1207622,"ip_address":"","ucode":"CC23857B8D75D5","user_header":"https://static001.geekbang.org/account/avatar/00/12/6d/46/e16291f8.jpg","comment_is_top":false,"comment_ctime":1588471180,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"ç¿»çœ‹äº†ä¸€ä¸‹javaä¸­çš„unsafeç±»ï¼Œè™½ç„¶æä¾›äº†faaçš„æ–¹æ³•ï¼Œä½†æ˜¯å®ç°è¿˜æ˜¯é€šè¿‡casï¼Œä¸ºä»€ä¹ˆjavaæ²¡æœ‰ç›´æ¥æä¾›faaå‘¢","like_count":0},{"had_liked":false,"id":190200,"user_name":"åŠªåŠ›å‘¼å¸","can_delete":false,"product_type":"c1","uid":1718303,"ip_address":"","ucode":"52941DD7A01BBA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKDfO7wKibzpw4YsoqLRCHUKxX4rYRUh7m7RCdOwzWVaN9QLlhcU5ho3w2Qcpib1O69YPj65ib07xQBQ/132","comment_is_top":false,"comment_ctime":1584613339,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"public class Cas {\n    private static AtomicInteger balance = new AtomicInteger(0);\n\n    private static CountDownLatch countDownLatch = new CountDownLatch(10000);\n\n    private static void transforFaa() {\n        balance.addAndGet(1);\n        countDownLatch.countDown();\n    }\n\n    private static void transforCas() {\n        int oldVal = balance.get();\n        int newVal = oldVal + 1;\n        balance.compareAndSet(oldVal, newVal);\n        countDownLatch.countDown();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        for (int j = 0; j &lt; 10000; j++) {\n            CompletableFuture.runAsync(() -&gt; Cas.transforCas());\n        }\n        countDownLatch.await();\n        System.out.println(balance.get());\n    }\n}","like_count":0},{"had_liked":false,"id":181877,"user_name":"é»‘å±±è€å¦–","can_delete":false,"product_type":"c1","uid":1115958,"ip_address":"","ucode":"A1659F99C5BE1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/36/d677e741.jpg","comment_is_top":false,"comment_ctime":1582652923,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"æ¸…æ™°","like_count":0},{"had_liked":false,"id":145917,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":1595382,"ip_address":"","ucode":"A77322C4E07B2D","user_header":"https://static001.geekbang.org/account/avatar/00/18/57/f6/2c7ac1ad.jpg","comment_is_top":false,"comment_ctime":1572402160,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"äº¤ä½œä¸šï¼šhttps:&#47;&#47;github.com&#47;PeterLu798&#47;MQ&#47;tree&#47;master&#47;src&#47;com&#47;lbj&#47;mq&#47;lock\nLockBalance.javaä½¿ç”¨Javaç‹¬å é”å®ç°ï¼Œå¹³å‡è€—æ—¶ 300æ¯«ç§’å·¦å³\nCASBalance.javaä½¿ç”¨AtomicIntegerå®ç°ï¼Œå¹³å‡è€—æ—¶250æ¯«ç§’å·¦å³","like_count":0},{"had_liked":false,"id":135997,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569322827,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100032301,"comment_content":"ä¹‹å‰åªçŸ¥CASï¼Œè¿˜æœ‰FAAï¼Œæƒ³å¿…åº”è¯¥æœ‰ä¸€å¨ç±»ä¼¼çš„åŸè¯­ã€‚æ‰“å¡ï¼Œæ„Ÿè°¢ï¼Œåˆå¢é•¿äº†ä¸€ç‚¹è§è¯†ã€‚","like_count":0},{"had_liked":false,"id":132124,"user_name":"æ¢¦å…¸","can_delete":false,"product_type":"c1","uid":1203920,"ip_address":"","ucode":"0A6F91068A13E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/d0/e676ac19.jpg","comment_is_top":false,"comment_ctime":1568026866,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"ä»£ç å·¥ç¨‹\nhttps:&#47;&#47;github.com&#47;dlutsniper&#47;wy-ja-lock&#47;tree&#47;master&#47;src&#47;main&#47;java&#47;wy&#47;ja&#47;lock&#47;demo\nè¯•éªŒè€—æ—¶çš„ç¯èŠ‚ï¼Œæ·±åˆ»ä½“ä¼šJITçš„å¼ºå¤§ï¼Œæ‰§è¡Œæ¬¡æ•°è¶Šå¤šï¼Œè€—æ—¶å‡å€¼è¶Šä½\nJITå—ï¼Ÿæ‰§è¡Œè¶Šå¤šé€Ÿåº¦è¶Šå¿«ï¼Ÿ\nå…³é—­JIT -Xint &#47; -Djava.compiler=NONE\nAccountDemoSynchronized 100æ¬¡å…³é—­å‰å\n  å¼€å¯ 16.66ms 13.77ms 11.26ms\n  å…³é—­ 93.14ms 102.12ms 81.13ms\nAccountDemoCas 100æ¬¡å…³é—­å‰å\n  å¼€å¯ 12.74ms 10.5ms 12.42ms\n  å…³é—­ 82.48ms 74.7ms 77.09ms","like_count":0},{"had_liked":false,"id":130896,"user_name":"MaLu","can_delete":false,"product_type":"c1","uid":1083559,"ip_address":"","ucode":"A5E900B6B94FB9","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/a7/fb383ef7.jpg","comment_is_top":false,"comment_ctime":1567567263,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"ç”¨æˆ·ç¡¬ä»¶åŒæ­¥åŸè¯­æ¥ä»£æ›¿é”çš„æ•ˆæœï¼Œç¡®å®æ˜¯ä¸€ä¸ªå¥½æ€è·¯","like_count":0},{"had_liked":false,"id":130750,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1567524502,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"è€å¸ˆè®²å¾—å¾ˆå¥½ï¼Œå¯¹äºæˆ‘è¿™ç§åŸºç¡€è–„å¼±çš„ï¼Œé•¿è§è¯†äº†ï¼Œæ„Ÿè°¢è€å¸ˆã€‚","like_count":0},{"had_liked":false,"id":130700,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1567513440,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"æœ€è¿‘å‡ºå·®éƒ½è½ä¸‹äº†å¥½äº›ï¼Œæ‰¾ä¸ªç©ºé—²æ—¶é—´æŠŠè¿™äº›å®ç°ä¸‹","like_count":0},{"had_liked":false,"id":130465,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1567470686,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"yialdæ„Ÿè§‰è¿˜æ˜¯ä¸æ˜¯ç­‰ä¸€å®šå‘¨æœŸä½¿ç”¨æ˜¯ä¸æ˜¯æ›´å¥½ï¼Œå¦‚æœç³»ç»Ÿçº¿ç¨‹å¤šï¼Œçº¿ç¨‹çš„é¢‘ç¹åˆ‡æ¢å¸¦æ¥çš„å¼€é”€ä¹Ÿä¸å°ï¼Œgoçš„åç¨‹ä¼šå¥½äº›","like_count":0},{"had_liked":false,"id":130453,"user_name":"ç™½å°ç™½","can_delete":false,"product_type":"c1","uid":1400416,"ip_address":"","ucode":"143F1C8294818A","user_header":"https://static001.geekbang.org/account/avatar/00/15/5e/60/1c13626b.jpg","comment_is_top":false,"comment_ctime":1567469360,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"æ‰“å¡æ‰“å¡ï¼æ™šä¸Šå›å®¶åšä½œä¸šï¼","like_count":0},{"had_liked":false,"id":130399,"user_name":"æ¸”æ‘è“","can_delete":false,"product_type":"c1","uid":1307497,"ip_address":"","ucode":"A29875CE15FDA3","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg","comment_is_top":false,"comment_ctime":1567441224,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"çœ‹å®Œï¼Œå…ˆæŠ¢ä¸ªæ²™å‘ï¼Œæ™šç‚¹ä¸Šé“¾æ¥ã€‚","like_count":0},{"had_liked":false,"id":132124,"user_name":"æ¢¦å…¸","can_delete":false,"product_type":"c1","uid":1203920,"ip_address":"","ucode":"0A6F91068A13E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/d0/e676ac19.jpg","comment_is_top":false,"comment_ctime":1568026866,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"ä»£ç å·¥ç¨‹\nhttps:&#47;&#47;github.com&#47;dlutsniper&#47;wy-ja-lock&#47;tree&#47;master&#47;src&#47;main&#47;java&#47;wy&#47;ja&#47;lock&#47;demo\nè¯•éªŒè€—æ—¶çš„ç¯èŠ‚ï¼Œæ·±åˆ»ä½“ä¼šJITçš„å¼ºå¤§ï¼Œæ‰§è¡Œæ¬¡æ•°è¶Šå¤šï¼Œè€—æ—¶å‡å€¼è¶Šä½\nJITå—ï¼Ÿæ‰§è¡Œè¶Šå¤šé€Ÿåº¦è¶Šå¿«ï¼Ÿ\nå…³é—­JIT -Xint &#47; -Djava.compiler=NONE\nAccountDemoSynchronized 100æ¬¡å…³é—­å‰å\n  å¼€å¯ 16.66ms 13.77ms 11.26ms\n  å…³é—­ 93.14ms 102.12ms 81.13ms\nAccountDemoCas 100æ¬¡å…³é—­å‰å\n  å¼€å¯ 12.74ms 10.5ms 12.42ms\n  å…³é—­ 82.48ms 74.7ms 77.09ms","like_count":0},{"had_liked":false,"id":130896,"user_name":"MaLu","can_delete":false,"product_type":"c1","uid":1083559,"ip_address":"","ucode":"A5E900B6B94FB9","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/a7/fb383ef7.jpg","comment_is_top":false,"comment_ctime":1567567263,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"ç”¨æˆ·ç¡¬ä»¶åŒæ­¥åŸè¯­æ¥ä»£æ›¿é”çš„æ•ˆæœï¼Œç¡®å®æ˜¯ä¸€ä¸ªå¥½æ€è·¯","like_count":0},{"had_liked":false,"id":130750,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1567524502,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"è€å¸ˆè®²å¾—å¾ˆå¥½ï¼Œå¯¹äºæˆ‘è¿™ç§åŸºç¡€è–„å¼±çš„ï¼Œé•¿è§è¯†äº†ï¼Œæ„Ÿè°¢è€å¸ˆã€‚","like_count":0},{"had_liked":false,"id":130700,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1567513440,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"æœ€è¿‘å‡ºå·®éƒ½è½ä¸‹äº†å¥½äº›ï¼Œæ‰¾ä¸ªç©ºé—²æ—¶é—´æŠŠè¿™äº›å®ç°ä¸‹","like_count":0},{"had_liked":false,"id":130465,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1567470686,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"yialdæ„Ÿè§‰è¿˜æ˜¯ä¸æ˜¯ç­‰ä¸€å®šå‘¨æœŸä½¿ç”¨æ˜¯ä¸æ˜¯æ›´å¥½ï¼Œå¦‚æœç³»ç»Ÿçº¿ç¨‹å¤šï¼Œçº¿ç¨‹çš„é¢‘ç¹åˆ‡æ¢å¸¦æ¥çš„å¼€é”€ä¹Ÿä¸å°ï¼Œgoçš„åç¨‹ä¼šå¥½äº›","like_count":0},{"had_liked":false,"id":130453,"user_name":"ç™½å°ç™½","can_delete":false,"product_type":"c1","uid":1400416,"ip_address":"","ucode":"143F1C8294818A","user_header":"https://static001.geekbang.org/account/avatar/00/15/5e/60/1c13626b.jpg","comment_is_top":false,"comment_ctime":1567469360,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"æ‰“å¡æ‰“å¡ï¼æ™šä¸Šå›å®¶åšä½œä¸šï¼","like_count":0},{"had_liked":false,"id":130399,"user_name":"æ¸”æ‘è“","can_delete":false,"product_type":"c1","uid":1307497,"ip_address":"","ucode":"A29875CE15FDA3","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg","comment_is_top":false,"comment_ctime":1567441224,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":6,"product_id":100032301,"comment_content":"çœ‹å®Œï¼Œå…ˆæŠ¢ä¸ªæ²™å‘ï¼Œæ™šç‚¹ä¸Šé“¾æ¥ã€‚","like_count":0}]}