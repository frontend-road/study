{"id":75973,"title":"20 | 案例篇：为什么系统的Swap变高了？（下）","content":"<p>你好，我是倪朋飞。</p><p>上一节我们详细学习了 Linux 内存回收，特别是 Swap 的原理，先简单回顾一下。</p><p>在内存资源紧张时，Linux通过直接内存回收和定期扫描的方式，来释放文件页和匿名页，以便把内存分配给更需要的进程使用。</p><ul>\n<li>\n<p>文件页的回收比较容易理解，直接清空缓存，或者把脏数据写回磁盘后，再释放缓存就可以了。</p>\n</li>\n<li>\n<p>而对不常访问的匿名页，则需要通过Swap换出到磁盘中，这样在下次访问的时候，再次从磁盘换入到内存中就可以了。</p>\n</li>\n</ul><p>开启 Swap 后，你可以设置 /proc/sys/vm/min_free_kbytes ，来调整系统定期回收内存的阈值，也可以设置 /proc/sys/vm/swappiness ，来调整文件页和匿名页的回收倾向。</p><p>那么，当 Swap 使用升高时，要如何定位和分析呢？下面，我们就来看一个磁盘I/O的案例，实战分析和演练。</p><h2>案例</h2><p>下面案例基于 Ubuntu 18.04，同样适用于其他的 Linux 系统。</p><ul>\n<li>\n<p>机器配置：2 CPU，8GB 内存</p>\n</li>\n<li>\n<p>你需要预先安装 sysstat 等工具，如 apt install sysstat</p>\n</li>\n</ul><p>首先，我们打开两个终端，分别 SSH 登录到两台机器上，并安装上面提到的这些工具。</p><p>同以前的案例一样，接下来的所有命令都默认以 root 用户运行，如果你是用普通用户身份登陆系统，请运行 sudo su root 命令切换到 root 用户。</p><!-- [[[read_end]]] --><p>如果安装过程中有什么问题，同样鼓励你先自己搜索解决，解决不了的，可以在留言区向我提问。</p><p>然后，在终端中运行free命令，查看Swap的使用情况。比如，在我的机器中，输出如下：</p><pre><code>$ free\n             total        used        free      shared  buff/cache   available\nMem:        8169348      331668     6715972         696     1121708     7522896\nSwap:             0           0           0\n</code></pre><p>从这个free输出你可以看到，Swap的大小是0，这说明我的机器没有配置Swap。</p><p>为了继续Swap的案例， 就需要先配置、开启Swap。如果你的环境中已经开启了Swap，那你可以略过下面的开启步骤，继续往后走。</p><p>要开启Swap，我们首先要清楚，Linux本身支持两种类型的Swap，即Swap分区和Swap文件。以Swap文件为例，在第一个终端中运行下面的命令开启Swap，我这里配置Swap文件的大小为8GB：</p><pre><code># 创建Swap文件\n$ fallocate -l 8G /mnt/swapfile\n# 修改权限只有根用户可以访问\n$ chmod 600 /mnt/swapfile\n# 配置Swap文件\n$ mkswap /mnt/swapfile\n# 开启Swap\n$ swapon /mnt/swapfile\n</code></pre><p>然后，再执行free命令，确认Swap配置成功：</p><pre><code>$ free\n             total        used        free      shared  buff/cache   available\nMem:        8169348      331668     6715972         696     1121708     7522896\nSwap:       8388604           0     8388604\n</code></pre><p>现在，free  输出中，Swap 空间以及剩余空间都从 0 变成了8GB，说明Swap已经<strong>正常开启</strong>。</p><p>接下来，我们在第一个终端中，运行下面的 dd 命令，模拟大文件的读取：</p><pre><code># 写入空设备，实际上只有磁盘的读请求\n$ dd if=/dev/sda1 of=/dev/null bs=1G count=2048\n</code></pre><p>接着，在第二个终端中运行 sar 命令，查看内存各个指标的变化情况。你可以多观察一会儿，查看这些指标的变化情况。</p><pre><code># 间隔1秒输出一组数据\n# -r表示显示内存使用情况，-S表示显示Swap使用情况\n$ sar -r -S 1\n04:39:56    kbmemfree   kbavail kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty\n04:39:57      6249676   6839824   1919632     23.50    740512     67316   1691736     10.22    815156    841868         4\n\n04:39:56    kbswpfree kbswpused  %swpused  kbswpcad   %swpcad\n04:39:57      8388604         0      0.00         0      0.00\n\n04:39:57    kbmemfree   kbavail kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty\n04:39:58      6184472   6807064   1984836     24.30    772768     67380   1691736     10.22    847932    874224        20\n\n04:39:57    kbswpfree kbswpused  %swpused  kbswpcad   %swpcad\n04:39:58      8388604         0      0.00         0      0.00\n\n…\n\n\n04:44:06    kbmemfree   kbavail kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty\n04:44:07       152780   6525716   8016528     98.13   6530440     51316   1691736     10.22    867124   6869332         0\n\n04:44:06    kbswpfree kbswpused  %swpused  kbswpcad   %swpcad\n04:44:07      8384508      4096      0.05        52      1.27\n</code></pre><p>我们可以看到，sar的输出结果是两个表格，第一个表格表示内存的使用情况，第二个表格表示Swap的使用情况。其中，各个指标名称前面的kb前缀，表示这些指标的单位是KB。</p><p>去掉前缀后，你会发现，大部分指标我们都已经见过了，剩下的几个新出现的指标，我来简单介绍一下。</p><ul>\n<li>\n<p>kbcommit，表示当前系统负载需要的内存。它实际上是为了保证系统内存不溢出，对需要内存的估计值。%commit，就是这个值相对总内存的百分比。</p>\n</li>\n<li>\n<p>kbactive，表示活跃内存，也就是最近使用过的内存，一般不会被系统回收。</p>\n</li>\n<li>\n<p>kbinact，表示非活跃内存，也就是不常访问的内存，有可能会被系统回收。</p>\n</li>\n</ul><p>清楚了界面指标的含义后，我们再结合具体数值，来分析相关的现象。你可以清楚地看到，总的内存使用率（%memused）在不断增长，从开始的23%一直长到了 98%，并且主要内存都被缓冲区（kbbuffers）占用。具体来说：</p><ul>\n<li>\n<p>刚开始，剩余内存（kbmemfree）不断减少，而缓冲区（kbbuffers）则不断增大，由此可知，剩余内存不断分配给了缓冲区。</p>\n</li>\n<li>\n<p>一段时间后，剩余内存已经很小，而缓冲区占用了大部分内存。这时候，Swap的使用开始逐渐增大，缓冲区和剩余内存则只在小范围内波动。</p>\n</li>\n</ul><p>你可能困惑了，为什么缓冲区在不停增大？这又是哪些进程导致的呢？</p><p>显然，我们还得看看进程缓存的情况。在前面缓存的案例中我们学过， cachetop 正好能满足这一点。那我们就来 cachetop 一下。</p><p>在第二个终端中，按下Ctrl+C停止sar命令，然后运行下面的cachetop命令，观察缓存的使用情况：</p><pre><code>$ cachetop 5\n12:28:28 Buffers MB: 6349 / Cached MB: 87 / Sort: HITS / Order: ascending\nPID      UID      CMD              HITS     MISSES   DIRTIES  READ_HIT%  WRITE_HIT%\n   18280 root     python                 22        0        0     100.0%       0.0%\n   18279 root     dd                  41088    41022        0      50.0%      50.0%\n</code></pre><p>通过cachetop的输出，我们看到，dd进程的读写请求只有50%的命中率，并且未命中的缓存页数（MISSES）为41022（单位是页）。这说明，正是案例开始时运行的dd，导致了缓冲区使用升高。</p><p>你可能接着会问，为什么Swap也跟着升高了呢？直观来说，缓冲区占了系统绝大部分内存，还属于可回收内存，内存不够用时，不应该先回收缓冲区吗？</p><p>这种情况，我们还得进一步通过 /proc/zoneinfo  ，观察剩余内存、内存阈值以及匿名页和文件页的活跃情况。</p><p>你可以在第二个终端中，按下Ctrl+C，停止cachetop命令。然后运行下面的命令，观察 /proc/zoneinfo 中这几个指标的变化情况：</p><pre><code># -d 表示高亮变化的字段\n# -A 表示仅显示Normal行以及之后的15行输出\n$ watch -d grep -A 15 'Normal' /proc/zoneinfo\nNode 0, zone   Normal\n  pages free     21328\n        min      14896\n        low      18620\n        high     22344\n        spanned  1835008\n        present  1835008\n        managed  1796710\n        protection: (0, 0, 0, 0, 0)\n      nr_free_pages 21328\n      nr_zone_inactive_anon 79776\n      nr_zone_active_anon 206854\n      nr_zone_inactive_file 918561\n      nr_zone_active_file 496695\n      nr_zone_unevictable 2251\n      nr_zone_write_pending 0\n</code></pre><p>你可以发现，剩余内存（pages_free）在一个小范围内不停地波动。当它小于页低阈值（pages_low) 时，又会突然增大到一个大于页高阈值（pages_high）的值。</p><p>再结合刚刚用 sar 看到的剩余内存和缓冲区的变化情况，我们可以推导出，剩余内存和缓冲区的波动变化，正是由于内存回收和缓存再次分配的循环往复。</p><ul>\n<li>\n<p>当剩余内存小于页低阈值时，系统会回收一些缓存和匿名内存，使剩余内存增大。其中，缓存的回收导致sar中的缓冲区减小，而匿名内存的回收导致了Swap的使用增大。</p>\n</li>\n<li>\n<p>紧接着，由于dd还在继续，剩余内存又会重新分配给缓存，导致剩余内存减少，缓冲区增大。</p>\n</li>\n</ul><p>其实还有一个有趣的现象，如果多次运行dd和sar，你可能会发现，在多次的循环重复中，有时候是Swap用得比较多，有时候Swap很少，反而缓冲区的波动更大。</p><p>换句话说，系统回收内存时，有时候会回收更多的文件页，有时候又回收了更多的匿名页。</p><p>显然，系统回收不同类型内存的倾向，似乎不那么明显。你应该想到了上节课提到的swappiness，正是调整不同类型内存回收的配置选项。</p><p>还是在第二个终端中，按下Ctrl+C停止watch命令，然后运行下面的命令，查看swappiness的配置：</p><pre><code>$ cat /proc/sys/vm/swappiness\n60\n</code></pre><p>swappiness显示的是默认值60，这是一个相对中和的配置，所以系统会根据实际运行情况，选择合适的回收类型，比如回收不活跃的匿名页，或者不活跃的文件页。</p><p>到这里，我们已经找出了Swap发生的根源。另一个问题就是，刚才的Swap到底影响了哪些应用程序呢？换句话说，Swap换出的是哪些进程的内存？</p><p>这里我还是推荐 proc文件系统，用来查看进程Swap换出的虚拟内存大小，它保存在 /proc/pid/status中的VmSwap中（推荐你执行man proc来查询其他字段的含义）。</p><p>在第二个终端中运行下面的命令，就可以查看使用Swap最多的进程。注意for、awk、sort都是最常用的Linux命令，如果你还不熟悉，可以用man来查询它们的手册，或上网搜索教程来学习。</p><pre><code># 按VmSwap使用量对进程排序，输出进程名称、进程ID以及SWAP用量\n$ for file in /proc/*/status ; do awk '/VmSwap|Name|^Pid/{printf $2 &quot; &quot; $3}END{ print &quot;&quot;}' $file; done | sort -k 3 -n -r | head\ndockerd 2226 10728 kB\ndocker-containe 2251 8516 kB\nsnapd 936 4020 kB\nnetworkd-dispat 911 836 kB\npolkitd 1004 44 kB\n</code></pre><p>从这里你可以看到，使用Swap比较多的是dockerd 和 docker-containe 进程，所以，当dockerd再次访问这些换出到磁盘的内存时，也会比较慢。</p><p>这也说明了一点，虽然缓存属于可回收内存，但在类似大文件拷贝这类场景下，系统还是会用Swap机制来回收匿名内存，而不仅仅是回收占用绝大部分内存的文件页。</p><p>最后，如果你在一开始配置了 Swap，不要忘记在案例结束后关闭。你可以运行下面的命令，关闭Swap：</p><pre><code>$ swapoff -a\n</code></pre><p>实际上，关闭Swap后再重新打开，也是一种常用的Swap空间清理方法，比如：</p><pre><code>$ swapoff -a &amp;&amp; swapon -a \n</code></pre><h2>小结</h2><p>在内存资源紧张时，Linux 会通过 Swap ，把不常访问的匿名页换出到磁盘中，下次访问的时候再从磁盘换入到内存中来。你可以设置/proc/sys/vm/min_free_kbytes，来调整系统定期回收内存的阈值；也可以设置/proc/sys/vm/swappiness，来调整文件页和匿名页的回收倾向。</p><p>当Swap变高时，你可以用 sar、/proc/zoneinfo、/proc/pid/status等方法，查看系统和进程的内存使用情况，进而找出Swap升高的根源和受影响的进程。</p><p>反过来说，通常，降低Swap的使用，可以提高系统的整体性能。要怎么做呢？这里，我也总结了几种常见的降低方法。</p><ul>\n<li>\n<p>禁止Swap，现在服务器的内存足够大，所以除非有必要，禁用Swap就可以了。随着云计算的普及，大部分云平台中的虚拟机都默认禁止Swap。</p>\n</li>\n<li>\n<p>如果实在需要用到Swap，可以尝试降低swappiness的值，减少内存回收时Swap的使用倾向。</p>\n</li>\n<li>\n<p>响应延迟敏感的应用，如果它们可能在开启Swap的服务器中运行，你还可以用库函数 mlock() 或者 mlockall()锁定内存，阻止它们的内存换出。</p>\n</li>\n</ul><h2>思考</h2><p>最后，给你留一个思考题。</p><p>今天的案例中，swappiness使用的是默认配置的60。如果把它配置成0的话，还会发生Swap吗？这又是为什么呢？</p><p>希望你可以实际操作一下，重点观察sar的输出，并结合今天的内容来记录、总结。</p><p>欢迎留言和我讨论，也欢迎把这篇文章分享给你的同事、朋友。我们一起在实战中演练，在交流中进步。</p><p></p>","neighbors":{"left":{"article_title":"19 | 案例篇：为什么系统的Swap变高了（上）","id":75797},"right":{"article_title":"21 | 套路篇：如何“快准狠”找到系统内存的问题？","id":76460}},"comments":[{"had_liked":false,"id":57026,"user_name":"Free_fish","can_delete":false,"product_type":"c1","uid":1133405,"ip_address":"","ucode":"4B096A4EEDB294","user_header":"https://static001.geekbang.org/account/avatar/00/11/4b/5d/48205f1d.jpg","comment_is_top":false,"comment_ctime":1546604991,"is_pvip":false,"replies":[{"id":"20575","content":"👍 谢谢分享","user_name":"作者回复","comment_id":57026,"uid":"1001282","ip_address":"","utype":1,"ctime":1546612414,"user_name_real":"倪朋飞"}],"discussion_count":6,"race_medal":0,"score":"362323857855","product_id":100020901,"comment_content":"用smem --sort swap命令可以直接将进程按照swap使用量排序显示","like_count":84,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435369,"discussion_content":"👍 谢谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546612414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1327184,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/OoQFTY8EKl6QTiaqhMJ4RAW7JhabGcYJMDqdrNYVibQIvicXBPVyGzNtjrmx0hF5LJTpoFEWNBkCncgqdRCPnLhibw/132","nickname":"rock","note":"","ucode":"02D7A46F4C486F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587539,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663136097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖北"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2066801,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/W0VEO7Hxzd61mia6Ls2EpBmaZ0l9q7SFUAErbu4XKIjWLmlALr4ybpicDoI8SoXY8XJNKmk04Ep1ibTCuFvfCF8GQ/132","nickname":"Chen","note":"","ucode":"5D0F3DF807706E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331235,"discussion_content":"是需要了另外安装的命令吗，which smem找不到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606813797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1170843,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dd/9b/0bc44a78.jpg","nickname":"yyl","note":"","ucode":"1741DACDFCA9AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293765,"discussion_content":"command not found","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595661620,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1009527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","nickname":"剑衣清风","note":"","ucode":"470CD81F6612F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1170843,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dd/9b/0bc44a78.jpg","nickname":"yyl","note":"","ucode":"1741DACDFCA9AF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341445,"discussion_content":"yum -y install smem","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1610422160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293765,"ip_address":""},"score":341445,"extra":""}]},{"author":{"id":1093541,"avatar":"https://static001.geekbang.org/account/avatar/00/10/af/a5/afa1d7d7.jpg","nickname":"hasWhere","note":"","ucode":"2C2B2988107489","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":123080,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578390088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56741,"user_name":"Geek_2b6807","can_delete":false,"product_type":"c1","uid":1240168,"ip_address":"","ucode":"4C1D0B7F283554","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ert8UYzoypaI9wMPZQV2ibThQ2zKsoge5R25qxHP10eia5pMYOV1mq6G9bft5LoygnyR6bn8RERwQDg/132","comment_is_top":false,"comment_ctime":1546532873,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"160460322825","product_id":100020901,"comment_content":"希望老师在用工具的时候能够使用对内核版本要求不高的，毕竟生产环境用较新内核的还是比较少","like_count":37,"discussions":[{"author":{"id":2067934,"avatar":"","nickname":"dqznn88","note":"","ucode":"08E1EE384858F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297451,"discussion_content":"ebpf是内核版本高才有的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596941789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56926,"user_name":"Scott","can_delete":false,"product_type":"c1","uid":1014800,"ip_address":"","ucode":"7E57FDCB5E5D49","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/10/165cb374.jpg","comment_is_top":false,"comment_ctime":1546580925,"is_pvip":false,"replies":[{"id":"21316","content":"👍 是的","user_name":"作者回复","comment_id":56926,"uid":"1001282","ip_address":"","utype":1,"ctime":1547259195,"user_name_real":"倪朋飞"}],"discussion_count":4,"race_medal":0,"score":"117510697917","product_id":100020901,"comment_content":"答案不是上一讲有提到吗，就算设置为0，如果空闲内存+文件页 &lt; page_low，还是会发生swap，这个值是设置swap的积极程度，就算最不积极，被逼无奈还是得swap的。","like_count":27,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435315,"discussion_content":"👍 是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547259195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1231289,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM56TmIEXDkHOfMNr7cAlCyGSQHiab7frfp59ibfuIibyPcpG1vugMLjNDeosfewg3sUkIfE0mzicqGgtw/132","nickname":"北极熊","note":"","ucode":"80B9CB59E151CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":580270,"discussion_content":"如果swap文件根本就没有配置呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658051736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":435315,"ip_address":""},"score":580270,"extra":""}]},{"author":{"id":2118161,"avatar":"https://static001.geekbang.org/account/avatar/00/20/52/11/af170b65.jpg","nickname":"骑驴找你","note":"","ucode":"FB9E7511C00BEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305259,"discussion_content":"不是page_low, 而是page_high: A value of 0 instructs the kernel not to\ninitiate swap until the amount of free and file-backed pages is less\nthan the high water mark in a zone.","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599832692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2066801,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/W0VEO7Hxzd61mia6Ls2EpBmaZ0l9q7SFUAErbu4XKIjWLmlALr4ybpicDoI8SoXY8XJNKmk04Ep1ibTCuFvfCF8GQ/132","nickname":"Chen","note":"","ucode":"5D0F3DF807706E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2118161,"avatar":"https://static001.geekbang.org/account/avatar/00/20/52/11/af170b65.jpg","nickname":"骑驴找你","note":"","ucode":"FB9E7511C00BEA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331236,"discussion_content":"swappiness 的范围是 0-100，不过要注意，这并不是内存的百分比，而是调整 Swap 积极程度的权重，即使你把它设置成 0，当剩余内存 + 文件页小于页高阈值时，还是会发生 Swap","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606814391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":305259,"ip_address":""},"score":331236,"extra":""}]}]},{"had_liked":false,"id":56765,"user_name":"尘封","can_delete":false,"product_type":"c1","uid":1247006,"ip_address":"","ucode":"CEE0C006387A03","user_header":"https://static001.geekbang.org/account/avatar/00/13/07/1e/bdbe93f4.jpg","comment_is_top":false,"comment_ctime":1546559724,"is_pvip":false,"replies":[{"id":"21159","content":"有的，使用了swap说明内存可能有压力了，这么强制换入有可能导致内存问题","user_name":"作者回复","comment_id":56765,"uid":"1001282","ip_address":"","utype":1,"ctime":1547125133,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"70266036460","product_id":100020901,"comment_content":"$ swapoff -a &amp;&amp; swapon -a，线上使用这个命令释放swap有什么风险吗？","like_count":16,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435220,"discussion_content":"有的，使用了swap说明内存可能有压力了，这么强制换入有可能导致内存问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1547125133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124465,"user_name":"Geek_b04b12","can_delete":false,"product_type":"c1","uid":1112139,"ip_address":"","ucode":"F8705A21FCDF09","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/4b/5ae62b10.jpg","comment_is_top":false,"comment_ctime":1565889831,"is_pvip":false,"replies":[{"id":"45967","content":"谢谢分享👍","user_name":"作者回复","comment_id":124465,"uid":"1001282","ip_address":"","utype":1,"ctime":1566132958,"user_name_real":"倪朋飞"}],"discussion_count":2,"race_medal":0,"score":"35925628199","product_id":100020901,"comment_content":"对于sar以及其他的linux命令,如果出现列对的不整齐的时候,可以适当的参考文档,增加格式化输出,例如:sar的格式化输出:sudo sar -h --human  -r -S 1 5<br>free 可以添加 -h :free -h <br>更容易让人理解","like_count":8,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463191,"discussion_content":"谢谢分享👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566132958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2328318,"avatar":"https://static001.geekbang.org/account/avatar/00/23/86/fe/0fb57311.jpg","nickname":"游离的鱼","note":"","ucode":"292D852B51C7D7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340306,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609950101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58327,"user_name":"仲鬼","can_delete":false,"product_type":"c1","uid":1314692,"ip_address":"","ucode":"DB1CD7052D5BA6","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/84/d8e63885.jpg","comment_is_top":false,"comment_ctime":1547037908,"is_pvip":false,"replies":[{"id":"21154","content":"kbcommit就是进程申请的内存之和，kbmemused还包括了buffer和cache","user_name":"作者回复","comment_id":58327,"uid":"1001282","ip_address":"","utype":1,"ctime":1547124894,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"23021874388","product_id":100020901,"comment_content":"老师好，我研究man sar后还是没理解kbcommit，这个估计值具体指什么呢？<br>就算单纯以不导致OOM的最小内存理解，为什么会小于kbmemused（已用物理内存）呢？我认为应该是kbcommit &gt;= kbmemused。","like_count":5,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436012,"discussion_content":"kbcommit就是进程申请的内存之和，kbmemused还包括了buffer和cache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547124894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56989,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1546594454,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18726463638","product_id":100020901,"comment_content":"swappiness 使用的是默认配置的 60。如果把它配置为0 还会使用 swap 吗？ <br>会使用的 ，为0 是最大限度不用，不是一定不用。","like_count":4},{"had_liked":false,"id":240746,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1597051751,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14481953639","product_id":100020901,"comment_content":"总结：<br>- 查看使用swap最多的进程<br>for file in &#47;proc&#47;*&#47;status ; do awk &#39;&#47;VmSwap|Name|^Pid&#47;{printf $2 &quot; &quot; $3}END{ print &quot;&quot;}&#39; $file; done | sort -k 3 -n -r | head<br><br>- 关闭swap:<br>swapoff -a<br><br>- 关闭swap再重新打开<br>swapoff -a &amp;&amp; swapon -a<br><br>-命令可以直接将进程按照swap使用量排序显示<br>smem --sort swap","like_count":3},{"had_liked":false,"id":56742,"user_name":"流转千回","can_delete":false,"product_type":"c1","uid":1219002,"ip_address":"","ucode":"30E4BEB47581AA","user_header":"https://static001.geekbang.org/account/avatar/00/12/99/ba/f8db012f.jpg","comment_is_top":false,"comment_ctime":1546533380,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14431435268","product_id":100020901,"comment_content":"打卡，老师这么晚还在更新专栏，致敬！","like_count":3},{"had_liked":false,"id":132788,"user_name":"风清扬","can_delete":false,"product_type":"c1","uid":1047043,"ip_address":"","ucode":"651F1390B64953","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/03/619e3e48.jpg","comment_is_top":false,"comment_ctime":1568219465,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10158154057","product_id":100020901,"comment_content":"为何我试用watch -d  grep -A 15 &#39;Normal&#39; &#47;proc&#47;zoneinfo之后输出全是0呀???","like_count":2},{"had_liked":false,"id":355229,"user_name":"凌空飞起的剪刀腿","can_delete":false,"product_type":"c1","uid":1243680,"ip_address":"北京","ucode":"16FBBF4A3B54C6","user_header":"https://static001.geekbang.org/account/avatar/00/12/fa/20/0f06b080.jpg","comment_is_top":false,"comment_ctime":1661214825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5956182121","product_id":100020901,"comment_content":"老师您好！在内存资源紧张时，Linux 通过直接内存回收和定期扫描的方式，来释放文件页和匿名页，以便把内存分配给更需要的进程使用。<br>这个定期扫描的周期是多少？","like_count":1},{"had_liked":false,"id":133645,"user_name":"Ethan","can_delete":false,"product_type":"c1","uid":1246017,"ip_address":"","ucode":"6856180D7B2525","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/41/ba59e1ee.jpg","comment_is_top":false,"comment_ctime":1568627461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5863594757","product_id":100020901,"comment_content":"遇到类似的情况.<br>虚拟机,CentOS 7.4,4G内存,1G SWAP大小,swappiness设置为60,执行dd,swap没有什么变化.","like_count":1},{"had_liked":false,"id":64845,"user_name":"如果","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1548923330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5843890626","product_id":100020901,"comment_content":"DAY20，打卡","like_count":1},{"had_liked":false,"id":56807,"user_name":"Days","can_delete":false,"product_type":"c1","uid":1317834,"ip_address":"","ucode":"4DDB1CD8F493E1","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/ca/9afb89a2.jpg","comment_is_top":false,"comment_ctime":1546563081,"is_pvip":false,"replies":[{"id":"21160","content":"是的","user_name":"作者回复","comment_id":56807,"uid":"1001282","ip_address":"","utype":1,"ctime":1547125147,"user_name_real":"倪朋飞"}],"discussion_count":1,"race_medal":0,"score":"5841530377","product_id":100020901,"comment_content":"老师，请问如果关闭swap分区，swapping配置是不是无效的？","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435245,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547125147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56801,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1546562862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841530158","product_id":100020901,"comment_content":"打卡day21<br>按我的理解，swapness只是几率，并不意味着一定，所以还是会发生匿名页交换，只是几率小点","like_count":1},{"had_liked":false,"id":359056,"user_name":"斌子","can_delete":false,"product_type":"c1","uid":1305393,"ip_address":"北京","ucode":"602804C685CFAE","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/31/2768a6a1.jpg","comment_is_top":false,"comment_ctime":1665210233,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665210233","product_id":100020901,"comment_content":"做试验的时候为什么我的kbbuffers并没有增长太大，反而是kbcommit增长很快<br>02:21:44 PM  kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty<br>02:21:45 PM  361.6M    131.2M      3.3G     55.7%    818.2M    952.4M      0.0k<br>","like_count":0},{"had_liked":false,"id":321006,"user_name":"Jason Wong","can_delete":false,"product_type":"c1","uid":2790451,"ip_address":"","ucode":"0DA0D724B8F8D6","user_header":"https://static001.geekbang.org/account/avatar/00/2a/94/33/4becb05a.jpg","comment_is_top":false,"comment_ctime":1636617178,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636617178","product_id":100020901,"comment_content":"开启 Swap 后，你可以设置 &#47;proc&#47;sys&#47;vm&#47;min_free_kbytes ，来调整系统定期回收内存的阈值，也可以设置 &#47;proc&#47;sys&#47;vm&#47;swappiness ，来调整文件页和匿名页的回收倾向。<br>----这2项设置只是让内存回收到swap，这样swap不是会一直变大？由谁来回收swap呢？","like_count":0},{"had_liked":false,"id":295879,"user_name":"Lam","can_delete":false,"product_type":"c1","uid":2597783,"ip_address":"","ucode":"6BDC4B9055BDE9","user_header":"https://static001.geekbang.org/account/avatar/00/27/a3/97/139eb54c.jpg","comment_is_top":false,"comment_ctime":1622627761,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622627761","product_id":100020901,"comment_content":"$ free -m<br>             total       used       free     shared    buffers     cached<br>Mem:         31708      31465        242      14189        178      29689<br>-&#47;+ buffers&#47;cache:       1597      30110<br>Swap:        15919        624      15295<br><br>---<br>请问为什么Oracle数据库服务器上内存总是被耗尽呢，且使用了少量swap，cache占大头，是Oracle为了提高读写性能而大量使用cache吗？","like_count":0},{"had_liked":false,"id":267660,"user_name":"谢哈哈","can_delete":false,"product_type":"c1","uid":2326880,"ip_address":"","ucode":"5AADE70B5AFE27","user_header":"https://static001.geekbang.org/account/avatar/00/23/81/60/71ed6ac7.jpg","comment_is_top":false,"comment_ctime":1607863806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607863806","product_id":100020901,"comment_content":"肯定会继续使用swap，swappiness只是换出anno memory与page memory的倾向，为0时，在低于high memory的水位时就开始换出page memory到swap","like_count":0},{"had_liked":false,"id":245431,"user_name":"豆豆","can_delete":false,"product_type":"c1","uid":1745589,"ip_address":"","ucode":"249C55D3481682","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a2/b5/c68d9439.jpg","comment_is_top":false,"comment_ctime":1598943089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598943089","product_id":100020901,"comment_content":"smem 在centos  8  上面没法在使用了","like_count":0},{"had_liked":false,"id":245426,"user_name":"此号用来看新闻","can_delete":false,"product_type":"c1","uid":2152758,"ip_address":"","ucode":"D74C189B6922C0","user_header":"","comment_is_top":false,"comment_ctime":1598942288,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598942288","product_id":100020901,"comment_content":"我这边是始终没有发生很大的swap，zoneinfo值 是这样的Node 0, zone   Normal<br>  pages free     120401<br>        min\t 4067<br>        low\t 5083<br>        high     6100<br>        scanned  0<br>        spanned  262144<br>        present  262144<br>        managed  241060<br>这是什么原因呢？","like_count":0},{"had_liked":false,"id":244644,"user_name":"czkk","can_delete":false,"product_type":"c1","uid":1516278,"ip_address":"","ucode":"56EE189CD243C7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/5TeftklBIoiaslVT9uNqz1aiasOamDZOlawaaicfEibRloiamLVQpg7o3EmlxY0ALAJwA0SUkRYp0PO3mExibokmpgEQ/132","comment_is_top":false,"comment_ctime":1598602824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598602824","product_id":100020901,"comment_content":"请问下老师，我的dd命令执行很快就结束了，调整dd命令的参数也依旧很快，导致我sar命令看swap一直是0，请问怎么解决？","like_count":0},{"had_liked":false,"id":241359,"user_name":"Hulw","can_delete":false,"product_type":"c1","uid":2079396,"ip_address":"","ucode":"F58E46802DE4D4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/ba/a4/2db8b806.jpg","comment_is_top":false,"comment_ctime":1597278605,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597278605","product_id":100020901,"comment_content":"老师好，请问在实际使用环境中出现commit百分比到达2000，这种情况是什么原因引起的？","like_count":0},{"had_liked":false,"id":224412,"user_name":"jorin@zou","can_delete":false,"product_type":"c1","uid":1564869,"ip_address":"","ucode":"A8CEF7CCF33570","user_header":"https://static001.geekbang.org/account/avatar/00/17/e0/c5/c324a7de.jpg","comment_is_top":false,"comment_ctime":1591372075,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591372075","product_id":100020901,"comment_content":"为什么匿名内存的回收导致 Swap 的使用增大?","like_count":0,"discussions":[{"author":{"id":1850207,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/3b/5f/79587afa.jpg","nickname":"何家欢","note":"","ucode":"D7F597847278EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327721,"discussion_content":"因为匿名内存还有用所以不是真的回收，只是塞到swap区中了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605926411,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219316,"user_name":"Yong","can_delete":false,"product_type":"c1","uid":1912653,"ip_address":"","ucode":"0ADA75C5C68619","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3OaibxsOia5ZET1iaBsPwDM6NS43lAUTdItqkwZ66fGaaXtjOQYL73IsvY0foscUZlkaZSQPPQNexA/132","comment_is_top":false,"comment_ctime":1589988043,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589988043","product_id":100020901,"comment_content":"打卡，新get到命令fallocate","like_count":0},{"had_liked":false,"id":193866,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1584975274,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584975274","product_id":100020901,"comment_content":"经测试还是会发生swap","like_count":0},{"had_liked":false,"id":189409,"user_name":"刘友淙","can_delete":false,"product_type":"c1","uid":1620058,"ip_address":"","ucode":"97F3A69A308313","user_header":"","comment_is_top":false,"comment_ctime":1584513029,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584513029","product_id":100020901,"comment_content":"D9 打卡","like_count":0},{"had_liked":false,"id":148469,"user_name":"耿长学","can_delete":false,"product_type":"c1","uid":1309948,"ip_address":"","ucode":"C7A262812854D4","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/fc/1e235814.jpg","comment_is_top":false,"comment_ctime":1573012681,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573012681","product_id":100020901,"comment_content":"老师，最近遇到生产生一个问题，有点疑惑，从内存篇中了解到，内存回收有两种方式：1）kswapd进程通过&#47;proc&#47;sys&#47;vm&#47;min_free_kbytes中定义的值；2）通过内存回收脏页，判断是&#47;proc&#47;zoneinfo文件中定义的值。现在发现一个现象，剩余内存都大于两个文件中的pages_high，但是swap突然增大，这个是为什么呢？我的swappiness值是1，这种情况下内存回收是通过什么机制判断的呢？一直想不通","like_count":0},{"had_liked":false,"id":134067,"user_name":"scorpiozj","can_delete":false,"product_type":"c1","uid":1031677,"ip_address":"","ucode":"C66EA76809F9BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/fd/3f5d5db5.jpg","comment_is_top":false,"comment_ctime":1568731591,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568731591","product_id":100020901,"comment_content":"fallocate失败的可以看： http:&#47;&#47;t.cn&#47;AiEBH7PC<br><br>swapiness设置为0，理论上还是会发生；实际测试时 swap没有发生，也有可能是条件未触发导致。","like_count":0},{"had_liked":false,"id":131113,"user_name":"美美","can_delete":false,"product_type":"c1","uid":1148422,"ip_address":"","ucode":"44CC95C45AF345","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/06/72b01bb7.jpg","comment_is_top":false,"comment_ctime":1567645602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567645602","product_id":100020901,"comment_content":"Jvm设置和物理内存一样大小，为啥swap使用比较多？","like_count":0},{"had_liked":false,"id":99361,"user_name":"幸运的人","can_delete":false,"product_type":"c1","uid":1490198,"ip_address":"","ucode":"F0FF3C3112A7A8","user_header":"https://static001.geekbang.org/account/avatar/00/16/bd/16/c940b1a3.jpg","comment_is_top":false,"comment_ctime":1559199572,"is_pvip":true,"replies":[{"id":"35812","content":"嗯，云环境一般都是关闭swap，避免恍如换出带来的性能问题","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1559280142,"ip_address":"","comment_id":99361,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559199572","product_id":100020901,"comment_content":"老师，问一个问题<br>现在的公有云主机或者是私有云的虚拟机，swap默认是0，这种情况下是否还会出现swap in和swap out呢？我在留言中也看到其他同学问过相似的问题，但没有看到答案，请帮忙解释一下？谢谢。<br>","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452076,"discussion_content":"嗯，云环境一般都是关闭swap，避免恍如换出带来的性能问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559280142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73283,"user_name":"Adam","can_delete":false,"product_type":"c1","uid":1305633,"ip_address":"","ucode":"338BA720880E4F","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg","comment_is_top":false,"comment_ctime":1551850937,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551850937","product_id":100020901,"comment_content":"ES 可以通过设置锁定内存。","like_count":0},{"had_liked":false,"id":60644,"user_name":"zshanjun","can_delete":false,"product_type":"c1","uid":1182120,"ip_address":"","ucode":"0C99216D6FBDB8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oCx7GX9P4w5cml1cpbFD1x21Biad3MLCTOhTPJvicRW3xp9C8xTgdiaOSdpFyvibKSfcD1LL4miaT7VtqqKms6rgujg/132","comment_is_top":false,"comment_ctime":1547522394,"is_pvip":true,"replies":[{"id":"22305","content":"仔细看看，1048576 bytes (1.0 MB, 1.0 MiB) copied","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1548249001,"ip_address":"","comment_id":60644,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1547522394","product_id":100020901,"comment_content":"大文件读取瞬间完成，没有观察到内存的变化：<br>root@linux-1:~&#47;go&#47;bin# dd if=&#47;dev&#47;sda1 of=&#47;dev&#47;null bs=16G count=2048<br>0+1 records in<br>0+1 records out<br>1048576 bytes (1.0 MB, 1.0 MiB) copied, 0.00693471 s, 151 MB&#47;s","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436568,"discussion_content":"仔细看看，1048576 bytes (1.0 MB, 1.0 MiB) copied","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548249001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356083,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg","nickname":"黄展志","note":"","ucode":"EBA342CD89072D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46017,"discussion_content":"我是0.5秒完成\n[root@app180-110 ~]# dd if=/dev/sda1 of=/dev/null bs=1G count=2048\n1+0 records in\n1+0 records out\n1073741824 bytes (1.1 GB) copied, 0.547584 s, 2.0 GB/s","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573111272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58513,"user_name":"berryfl","can_delete":false,"product_type":"c1","uid":1014479,"ip_address":"","ucode":"E9896F6EBC9A72","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLz5feictl6uxOFeth2zrO7LPOZKk0mvzIBYD9ic5EyGB39dicBbkYsIYoqqBsibJFo0fDicxN0CUt2dAQ/132","comment_is_top":false,"comment_ctime":1547098344,"is_pvip":false,"replies":[{"id":"21148","content":"嗯，是的","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547124122,"ip_address":"","comment_id":58513,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547098344","product_id":100020901,"comment_content":"&#47;proc&#47;*&#47;status会匹配到self之类的特殊目录，把匹配的部分写复杂点可以限制到仅数字，例如+([0-9])","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436102,"discussion_content":"嗯，是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547124122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57634,"user_name":"白华","can_delete":false,"product_type":"c1","uid":1315666,"ip_address":"","ucode":"FC9BACFCA6E8C1","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/52/db1b01fc.jpg","comment_is_top":false,"comment_ctime":1546855243,"is_pvip":false,"replies":[{"id":"21002","content":"swap开了吗？swapiness配置的什么","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547029255,"ip_address":"","comment_id":57634,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1546855243","product_id":100020901,"comment_content":"我写的dd参数就是大文件系统的数据，一共就20g存储的虚拟机，传的是&#47;dev&#47;root文件系统 有10g 需要写好久，实验现象和您描述的差不多，但是swap就是没变化","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435674,"discussion_content":"swap开了吗？swapiness配置的什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547029255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/03/41/ba59e1ee.jpg","nickname":"Ethan","note":"","ucode":"6856180D7B2525","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12999,"discussion_content":"遇到类似的情况.\n虚拟机,CentOS 7.4,4G内存,1G SWAP大小,swappiness设置为60,执行dd,swap没有什么变化.\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568627381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57487,"user_name":"nemo","can_delete":false,"product_type":"c1","uid":1148570,"ip_address":"","ucode":"5E6926A3404A6F","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/9a/4231fb93.jpg","comment_is_top":false,"comment_ctime":1546821908,"is_pvip":false,"replies":[{"id":"20767","content":"用系统默认值就可以，除非发现问题才建议调整","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1546854251,"ip_address":"","comment_id":57487,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546821908","product_id":100020901,"comment_content":"请问min_free_kbytes一般设置多少？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435601,"discussion_content":"用系统默认值就可以，除非发现问题才建议调整","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546854251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57471,"user_name":"nemo","can_delete":false,"product_type":"c1","uid":1148570,"ip_address":"","ucode":"5E6926A3404A6F","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/9a/4231fb93.jpg","comment_is_top":false,"comment_ctime":1546819811,"is_pvip":false,"replies":[{"id":"20768","content":"系统默认值就可以","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1546854263,"ip_address":"","comment_id":57471,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546819811","product_id":100020901,"comment_content":"请教下min_free_kbytes一般设置多少？","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435592,"discussion_content":"系统默认值就可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546854263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57406,"user_name":"dexter","can_delete":false,"product_type":"c1","uid":1315252,"ip_address":"","ucode":"DD51207438FBD6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEL5xnfuicbtRz4F87AAjZX6oCEjMtYiaIu4iaQichQmy0vEBA6Sumic1RDvUCeuBEqj6iatnt2kENbKYmuw/132","comment_is_top":false,"comment_ctime":1546782620,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546782620","product_id":100020901,"comment_content":"当前全部进程VmSwap的使用量的总和是不是就是free里面swap中的used的使用量？","like_count":0},{"had_liked":false,"id":57367,"user_name":"腾达","can_delete":false,"product_type":"c1","uid":1079876,"ip_address":"","ucode":"72F9CFBA44FDEE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9hlAIKQ1sGDu16oWLOHyCSicr18XibygQSMLMjuDvKk73deDlH9aMphFsj41WYJh121aniaqBLiaMNg/132","comment_is_top":false,"comment_ctime":1546766214,"is_pvip":false,"replies":[{"id":"20770","content":"试试调整 dd 参数，可能是你的内存大得多，可以多读一些数据","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1546854608,"ip_address":"","comment_id":57367,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546766214","product_id":100020901,"comment_content":"第一次启动虚拟机按照步骤操作，swpused发现高起来好多，后来几次不知道为什么swpused高不起来了，始终维持2%上下。第一次和后面几次的差异就是第一次运行后，去安装了smem，然后重启了机器几次，系统的默认参数都没改过","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435548,"discussion_content":"试试调整 dd 参数，可能是你的内存大得多，可以多读一些数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546854608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57334,"user_name":"白华","can_delete":false,"product_type":"c1","uid":1315666,"ip_address":"","ucode":"FC9BACFCA6E8C1","user_header":"https://static001.geekbang.org/account/avatar/00/14/13/52/db1b01fc.jpg","comment_is_top":false,"comment_ctime":1546754331,"is_pvip":false,"replies":[{"id":"20773","content":"详细的现象是什么？试试调大dd的参数读更多的数据？","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1546854778,"ip_address":"","comment_id":57334,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546754331","product_id":100020901,"comment_content":"在centos系统操作还是会有区别，我的swap分的2G，但是一点都没有用到，kbswpfree总是不变，即使memused达到了98%以上，就看到了kbswpfree的波动。","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435527,"discussion_content":"详细的现象是什么？试试调大dd的参数读更多的数据？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546854778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57283,"user_name":"风飘，吾独思","can_delete":false,"product_type":"c1","uid":1131032,"ip_address":"","ucode":"4DF0E7DC22EE53","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/18/edc1b373.jpg","comment_is_top":false,"comment_ctime":1546707235,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546707235","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":57232,"user_name":"往事随风，顺其自然","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1546693499,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546693499","product_id":100020901,"comment_content":"现在变化不大，按照比例操作","like_count":0},{"had_liked":false,"id":57230,"user_name":"往事随风，顺其自然","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1546692192,"is_pvip":false,"replies":[{"id":"22287","content":"应该是sar版本问题，升级到新版试试","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1548246459,"ip_address":"","comment_id":57230,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546692192","product_id":100020901,"comment_content":"centos 没有kbactive 和kbinact 活跃内部的和非活跃内存的情况","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435472,"discussion_content":"应该是sar版本问题，升级到新版试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548246459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57076,"user_name":"Geek_37593b","can_delete":false,"product_type":"c1","uid":1333821,"ip_address":"","ucode":"9C0CD7C30CA62C","user_header":"https://static001.geekbang.org/account/avatar/00/14/5a/3d/1a1754f2.jpg","comment_is_top":false,"comment_ctime":1546615009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546615009","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":56916,"user_name":"我来也","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1546579134,"is_pvip":false,"replies":[{"id":"21315","content":"👍 ","user_name":"作者回复","user_name_real":"倪朋飞","uid":"1001282","ctime":1547259177,"ip_address":"","comment_id":56916,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546579134","product_id":100020901,"comment_content":"[D20打卡]<br>好像 swappiness 配置为0也会发生swap.<br>这篇文章中有具体的分析: http:&#47;&#47;www.yunweipai.com&#47;archives&#47;12863.html<br>```<br>如果是全局页回收，并且当前空闲内存和所有file based链表page数目的加和都小于系统的high watermark，则必须进行匿名页回收，则必然会发生swap,可以看到这里swappiness的值如何设置是完全无关的，这也解释了为什么其为0，系统也会进行swap的原因<br>```<br>由于暂时用不上swap,所以这期就没实际操作. 还有好多专栏要学习.🙈","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"倪朋飞","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435311,"discussion_content":"👍 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547259177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56855,"user_name":"划时代","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1546569089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546569089","product_id":100020901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":56746,"user_name":"湖湘志","can_delete":false,"product_type":"c1","uid":1285578,"ip_address":"","ucode":"C8B069B3AD4FEA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erJR5Kj0Xm6LykFHLaWqHjQiaroVxgdoGI7uHEGz2D3PfibWNkBYP23QLzFmcuicgKLbqUch0ZJ2ZNOA/132","comment_is_top":false,"comment_ctime":1546534273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546534273","product_id":100020901,"comment_content":"D20","like_count":0}]}