{"id":722702,"title":"08ï½œOption<T>ä¸Result<T, E>ã€è¿­ä»£å™¨","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeï¼Œä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ¥é‡ç‚¹å­¦ä¹ åœ¨Rustä¸­é«˜é¢‘ä½¿ç”¨çš„ <code>Option&lt;T&gt;</code>ã€<code>Result&lt;T, E&gt;</code>ã€è¿­ä»£å™¨ï¼Œé€šè¿‡å­¦ä¹ è¿™äº›å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å¤¯å®é›†åˆä¸­æ‰€æœ‰æƒç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚</p><p><code>Option&lt;T&gt;</code> å’Œ <code>Result&lt;T, E&gt;</code> å¹¶ä¸æ˜¯Rustçš„ç‹¬åˆ›è®¾è®¡ï¼Œåœ¨Rustä¹‹å‰ï¼ŒOCamlã€Haskellã€Scalaç­‰å·²ç»ä½¿ç”¨å®ƒä»¬å¾ˆä¹…äº†ã€‚æ–°å…´çš„ä¸€æ‰¹è¯­è¨€Kotlinã€Swift ç­‰ä¹Ÿå’ŒRustä¸€æ ·å¼•å…¥äº†è¿™ä¸¤ç§ç±»å‹ã€‚è€ŒC++17ä¹‹åä¹Ÿå¼•å…¥äº†å®ƒä»¬ã€‚</p><p>è¿™å…¶å®èƒ½è¯´æ˜ä½¿ç”¨ <code>Option&lt;T&gt;</code> å’Œ <code>Result&lt;T, E&gt;</code> é€æ¸æˆäº†ç¼–ç¨‹è¯­è¨€åœˆå­çš„ä¸€ç§æ–°å…±è¯†ã€‚è€Œè¿­ä»£å™¨å·²ç»æ˜¯ç›®å‰å‡ ä¹æ‰€æœ‰ä¸»æµè¯­è¨€çš„æ ‡é…äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ¥çœ‹çœ‹Rustä¸­çš„è¿­ä»£å™¨æœ‰ä»€ä¹ˆç‹¬åˆ°çš„åœ°æ–¹ã€‚</p><p>å¦‚æœä½ ä¹ æƒ¯äº†å‘½ä»¤å¼ç¼–ç¨‹æˆ–OOPç¼–ç¨‹ï¼Œé‚£ä¹ˆè¿™èŠ‚è¯¾æˆ‘ä»¬æåˆ°å„ç§æ“ä½œå¯¹ä½ æ¥è¯´å¯èƒ½æœ‰ç‚¹é™Œç”Ÿï¼Œä¸è¿‡ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œè¿™èŠ‚è¯¾æˆ‘è®¾è®¡äº†å¤§é‡ç¤ºä¾‹ï¼Œä½ å¯ä»¥é€šè¿‡ç†Ÿæ‚‰è¿™äº›ç¤ºä¾‹ä»£ç ï¼ŒæŒæ¡Rustä¸­åœ°é“çš„ç¼–ç¨‹é£æ ¼ã€‚</p><h2><code>Option&lt;T&gt;</code> ä¸ <code>Result&lt;T, E&gt;</code></h2><p><code>Option&lt;T&gt;</code> ä¸ <code>Result&lt;T, E&gt;</code> åœ¨Rustä»£ç ä¸­éšå¤„å¯è§ï¼Œä½†æ˜¯æˆ‘ä»¬åˆ°ç°åœ¨æ‰å¼€å§‹æ­£å¼ä»‹ç»ï¼Œå°±æ˜¯å› ä¸ºå®ƒä»¬å®é™…æ˜¯å¸¦ç±»å‹å‚æ•°çš„æšä¸¾ç±»å‹ã€‚</p><h3><code>Option&lt;T&gt;</code> çš„å®šä¹‰</h3><pre><code class=\"language-plain\">pub enum Option&lt;T&gt; {\n    None,\n    Some(T),\n}\n</code></pre><!-- [[[read_end]]] --><p><code>Option&lt;T&gt;</code> å®šä¹‰ä¸ºåŒ…å«ä¸¤ä¸ªå˜ä½“çš„æšä¸¾ã€‚ä¸€ä¸ªæ˜¯ä¸å¸¦è´Ÿè½½çš„Noneï¼Œå¦ä¸€ä¸ªæ˜¯å¸¦ä¸€ä¸ªç±»å‹å‚æ•°ä½œä¸ºå…¶è´Ÿè½½çš„Someã€‚<code>Option&lt;T&gt;</code> çš„å®ä¾‹åœ¨Someå’ŒNoneä¸­å–å€¼ï¼Œ è¡¨ç¤ºè¿™ä¸ªå®ä¾‹æœ‰å–ç©ºå€¼çš„å¯èƒ½ã€‚</p><p>ä½ å¯ä»¥æŠŠ <code>Option&lt;T&gt;</code> ç†è§£ä¸ºæŠŠç©ºå€¼å•ç‹¬æå‡ºæ¥äº†ä¸€ä¸ªç»´åº¦ã€‚åœ¨æ²¡æœ‰ <code>Option&lt;T&gt;</code> çš„è¯­è¨€ä¸­ï¼Œç©ºå€¼æ˜¯åˆ†æ•£åœ¨å…¶ä»–ç±»å‹ä¸­çš„ã€‚æ¯”å¦‚ç©ºå­—ç¬¦ä¸²ã€ç©ºæ•°ç»„ã€æ•°å­—0ã€NULLæŒ‡é’ˆç­‰ã€‚å¹¶ä¸”æœ‰çš„è¯­è¨€è¿˜æŠŠç©ºå€¼åŒºåˆ†ä¸ºç©ºå€¼å’Œæœªå®šä¹‰çš„å€¼ï¼Œå¦‚ nilã€undefinedç­‰ã€‚</p><p>Ruståšäº†ä¸¤ä»¶äº‹æƒ…æ¥è§£å†³è¿™ä¸ªæ··ä¹±çš„åœºé¢ã€‚ç¬¬ä¸€ï¼ŒRustä¸­æ‰€æœ‰çš„å˜é‡å®šä¹‰åä½¿ç”¨å‰éƒ½å¿…é¡»åˆå§‹åŒ–ï¼Œæ‰€ä»¥ä¸å­˜åœ¨æœªå®šä¹‰å€¼è¿™ä¸ªæƒ…å†µã€‚ç¬¬äºŒï¼ŒRustæŠŠç©ºå€¼å•ç‹¬æå‡ºæ¥ç»Ÿä¸€å®šä¹‰æˆ <code>Option&lt;T&gt;::None</code>ï¼Œå¹¶åœ¨æ ‡å‡†åº“å±‚é¢ä¸Šå°±åšå¥½äº†è§„èŒƒï¼Œä¸Šå±‚çš„åº”ç”¨åœ¨è®¾è®¡æ—¶ä¹Ÿåº”è¯¥éµå¾ªè¿™ä¸ªè§„èŒƒã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">let s = String::from(\"\");\nlet a: Option&lt;String&gt; = Some(s);\n</code></pre><p>å˜é‡aæ˜¯æºå¸¦ç©ºå­—ç¬¦ä¸²çš„ <code>Option&lt;String&gt;</code> ç±»å‹ã€‚è¿™é‡Œï¼Œç©ºå­—ç¬¦ä¸²\"\"çš„â€œç©ºâ€ä¸Noneæ‰€è¡¨ç¤ºçš„â€œæ— â€è¡¨è¾¾äº†ä¸åŒçš„æ„ä¹‰ã€‚</p><p>å¦‚æœæ—©ç‚¹å‘æ˜Optionï¼ŒTony Hoareå°±ä¸ä¼šè‡ªè´£äº†ã€‚Tony Hoareåœ¨<a href=\"https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/\">ä¸€æ¬¡åˆ†äº«</a>ä¸­è¯´ï¼Œä»–åœ¨1965å¹´å‘æ˜çš„ç©ºå¼•ç”¨ï¼ˆNull referencesï¼‰æ˜¯ä¸€ä¸ªâ€œåäº¿ç¾å…ƒâ€çš„é”™è¯¯ã€‚</p><p>ä»–æ˜¯è¿™æ ·è¯´çš„ï¼šæˆ‘æŠŠå®ƒå«åšæˆ‘çš„åäº¿ç¾å…ƒé”™è¯¯ã€‚é‚£ä¸ªæ—¶å€™ï¼Œæˆ‘æ­£åœ¨ä¸ºä¸€ä¸ªé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„å¼•ç”¨è®¾è®¡ç¬¬ä¸€ä¸ªå…¨é¢çš„ç±»å‹ç³»ç»Ÿã€‚æˆ‘çš„ç›®æ ‡æ˜¯è®©ç¼–è¯‘å™¨è‡ªåŠ¨æ–½åŠ æ£€æŸ¥ï¼Œæ¥ç¡®ä¿å¯¹å¼•ç”¨çš„æ‰€æœ‰ä½¿ç”¨éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚ä½†æ˜¯æˆ‘å½“æ—¶æ— æ³•æŠµæŠ—ç©ºå¼•ç”¨çš„è¯±æƒ‘ï¼Œå°±æ˜¯å› ä¸ºå®ƒéå¸¸å®¹æ˜“å®ç°ã€‚è¿™å¯¼è‡´äº†éš¾ä»¥è®¡æ•°çš„é”™è¯¯ã€æ¼æ´å’Œç³»ç»Ÿå´©æºƒï¼Œåœ¨åç»­40å¹´é‡Œè¿™å¯èƒ½å·²ç»å¯¼è‡´äº†åäº¿ç¾å…ƒçš„ç—›è‹¦å’Œç ´åã€‚</p><p>Rusté€šè¿‡æ‰€æœ‰æƒå¹¶å€Ÿç”¨æ£€æŸ¥å™¨ã€<code>Option&lt;T&gt;</code>ã€<code>Result&lt;T, E&gt;</code> ç­‰ä¸€æ•´å¥—æœºåˆ¶å…¨é¢è§£å†³äº†Hoareæƒ³è§£å†³çš„é—®é¢˜ã€‚</p><h3><code>Result&lt;T, E&gt;</code> çš„å®šä¹‰</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">pub enum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre><p><code>Result&lt;T, E&gt;</code> è¢«å®šä¹‰ä¸ºåŒ…å«ä¸¤ä¸ªå˜ä½“çš„æšä¸¾ã€‚è¿™ä¸¤ä¸ªå˜ä½“å„è‡ªå¸¦ä¸€ä¸ªç±»å‹å‚æ•°ä½œä¸ºå…¶è´Ÿè½½ã€‚<code>Ok(T)</code> ç”¨æ¥è¡¨ç¤ºç»“æœæ­£ç¡®ï¼Œ<code>Err(E)</code> ç”¨æ¥è¡¨ç¤ºç»“æœæœ‰é”™è¯¯ã€‚</p><p>å¯¹æ¯”å…¶ä»–è¯­è¨€å‡½æ•°é”™è¯¯è¿”å›çš„çº¦å®šï¼ŒCã€CPPã€Javaè¯­è¨€é‡Œæœ‰æ—¶ç”¨è¿”å›0æ¥è¡¨ç¤ºå‡½æ•°æ‰§è¡Œæ­£ç¡®ï¼Œæœ‰æ—¶åˆä¸æ˜¯è¿™æ ·ï¼Œä½ éœ€è¦æ ¹æ®ä»£ç æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ¥åˆ¤æ–­è¿”å›ä»€ä¹ˆå€¼ä»£è¡¨æ­£ç¡®ï¼Œè¿”å›ä»€ä¹ˆå€¼ä»£è¡¨é”™è¯¯ã€‚</p><p>è€ŒGoè¯­è¨€å¼ºåˆ¶å¯¹å‡½æ•°è¿”å›å€¼åšå‡ºäº†çº¦å®šã€‚</p><pre><code class=\"language-plain\">ret, err := function()\nif err != nil {\n</code></pre><p>çº¦å®šè¦æ±‚å‡½æ•°è¿”å›ä¸¤ä¸ªå€¼ï¼Œæ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œ<code>ret</code> å­˜æ”¾è¿”å›å€¼ï¼Œ<code>err</code> ä¸º <code>nil</code>ã€‚å¦‚æœå‡½æ•°è¦è¿”å›é”™è¯¯å€¼ï¼Œé‚£ä¹ˆä¼šç»™ <code>err</code> å˜é‡å¡«å……å…·ä½“çš„å†…å®¹ï¼Œäºæ˜¯å°±å‡ºç°äº†ç»å…¸çš„æ»¡å± <code>if err ï¼= nil</code> ä»£ç ï¼Œæˆäº†Goè¯­è¨€åœˆçš„ä¸€ä¸ªæ¢—ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒGoè¯­è¨€å·²ç»æœç€æŠŠé”™è¯¯ä¿¡æ¯å’Œæ­£å¸¸è¿”å›å€¼ç±»å‹å‰¥ç¦»å¼€æ¥çš„æ–¹å‘èµ°å‡ºäº†ä¸€æ­¥ã€‚</p><p>è€ŒRustæ²¡æœ‰åƒGoé‚£æ ·è®¾è®¡ï¼Œä¸€æ˜¯å› ä¸ºRustä¸å­˜åœ¨å•ç‹¬çš„ <code>nil</code> è¿™ç§ç©ºå€¼ï¼ŒäºŒæ˜¯Rustç›´æ¥ç”¨å¸¦ç±»å‹å‚æ•°çš„æšä¸¾å°±å¯ä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚</p><p>ä¸€ä¸ªæšä¸¾å®ä¾‹åœ¨ä¸€ä¸ªæ—¶åˆ»åªèƒ½æ˜¯é‚£ä¸ªæšä¸¾ç±»å‹çš„æŸä¸€ä¸ªå˜ä½“ã€‚æ‰€ä»¥ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼Œä¸è®ºå®ƒæ˜¯æ­£ç¡®çš„æƒ…å†µè¿˜æ˜¯é”™è¯¯çš„æƒ…å†µï¼Œéƒ½èƒ½ç”¨ <code>Result&lt;T, E&gt;</code> ç±»å‹ç»Ÿä¸€è¡¨è¾¾ï¼Œè¿™æ ·ä¼šæ˜¾å¾—æ›´ç´§å‡‘ã€‚åŒæ—¶è¿˜å› ä¸º <code>Result&lt;T, E&gt;</code> æ˜¯ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒä¹‹ä¸Šæ·»åŠ å¾ˆå¤šæ“ä½œï¼Œç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚ä¸‹é¢æˆ‘ç”¨ä¾‹å­æ¥ç»™ä½ è®²è§£ã€‚</p><pre><code class=\"language-plain\">let r: Result&lt;String, String&gt; = function();\n</code></pre><p>è¿™ä¸ªä¾‹å­è¡¨ç¤ºå°†å‡½æ•°è¿”å›å€¼èµ‹ç»™å˜é‡rï¼Œè¿”å›ç±»å‹æ˜¯ <code>Result&lt;String, String&gt;</code>ã€‚åœ¨æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œè¿”å›å†…å®¹ä¸ºStringç±»å‹ï¼›é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè¢«è¿”å›çš„é”™è¯¯ç±»å‹ä¹Ÿæ˜¯Stringã€‚ä½ æ˜¯ä¸æ˜¯åœ¨æƒ³ï¼šä¸¤ç§å¯ä»¥ä¸€æ ·ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œè¿™ä¸¤ä¸ªç±»å‹å‚æ•°å¯ä»¥è¢«ä»»æ„ç±»å‹ä»£å…¥ã€‚</p><p><code>Result&lt;T, E&gt;</code> è¢«ç”¨æ¥æ”¯æ’‘Rustçš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ‰€ä»¥éå¸¸é‡è¦ã€‚æˆ‘ä»¬ä¼šåœ¨ç¬¬18è®²è¯¦ç»†è®²è¿°åŸºäº <code>Result&lt;T, E&gt;</code> çš„é”™è¯¯å¤„ç†ã€‚</p><h3>è§£åŒ…</h3><p>ç°åœ¨æˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ <code>Option&lt;u32&gt;::Some(10)</code> å’Œ <code>10u32</code> æ˜æ˜¾å·²ç»ä¸æ˜¯åŒä¸€ç§ç±»å‹äº†ã€‚æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„å€¼è¢«â€œåŒ…è£¹â€åœ¨äº†å¦å¤–ä¸€ç§ç±»å‹é‡Œé¢ã€‚è¿™ç§â€œåŒ…è£¹â€æ˜¯é€šè¿‡æšä¸¾å˜ä½“æ¥å®ç°çš„ã€‚é‚£æˆ‘ä»¬æƒ³è·å–è¢«åŒ…åœ¨é‡Œé¢çš„å€¼åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>å…¶å®æœ‰å¾ˆå¤šåŠæ³•ï¼Œæˆ‘ä»¬å…ˆè®²ä¸€ç±»è§£åŒ…æ“ä½œã€‚è¿™é‡Œæˆ‘åˆ—å‡ºäº†ä¸‰ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ <code>expect()</code>ã€<code>unwrap()</code>ã€<code>unwrap_or()</code>ã€‚æˆ‘ç»™å‡ºäº†å®ƒä»¬è§£åŒ…çš„å…·ä½“æ“ä½œå’Œç¤ºä¾‹ä»£ç ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2c/4e/2c6688bff17d22b516a83e8063fb094e.jpg?wh=1920x439\" alt=\"å›¾ç‰‡\"></p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">// Option\nlet x = Some(\"value\");\nassert_eq!(x.expect(\"fruits are healthy\"), \"value\");\n// Result\nlet path = std::env::var(\"IMPORTANT_PATH\")\n    .expect(\"env variable `IMPORTANT_PATH` should be set by `wrapper_script.sh`\");\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/95/ed/959455893ca1ae8c43ffyye251c015ed.jpg?wh=1920x413\" alt=\"å›¾ç‰‡\"></p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">// Option\nlet x = Some(\"air\");\nassert_eq!(x.unwrap(), \"air\");\n// Result\nlet x: Result&lt;u32, &amp;str&gt; = Ok(2);\nassert_eq!(x.unwrap(), 2);\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/ca/e5/ca69bfe4787585c0e16529c5ddd8b5e5.jpg?wh=1920x485\" alt=\"å›¾ç‰‡\"></p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">// Option\nassert_eq!(Some(\"car\").unwrap_or(\"bike\"), \"car\");\nassert_eq!(None.unwrap_or(\"bike\"), \"bike\");\n\n// Result\nlet default = 2;\nlet x: Result&lt;u32, &amp;str&gt; = Ok(9);\nassert_eq!(x.unwrap_or(default), 9);\n\nlet x: Result&lt;u32, &amp;str&gt; = Err(\"error\");\nassert_eq!(x.unwrap_or(default), default);\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/71/08/7170a2fcaec48fd123158f99e88ce708.jpg?wh=1920x415\" alt=\"å›¾ç‰‡\"></p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">// Option\nlet x: Option&lt;u32&gt; = None;\nlet y: Option&lt;u32&gt; = Some(12);\n\nassert_eq!(x.unwrap_or_default(), 0);\nassert_eq!(y.unwrap_or_default(), 12);\n\n// Result\nlet good_year_from_input = \"1909\";\nlet bad_year_from_input = \"190blarg\";\nlet good_year = good_year_from_input.parse().unwrap_or_default();\nlet bad_year = bad_year_from_input.parse().unwrap_or_default();\n\nassert_eq!(1909, good_year);\nassert_eq!(0, bad_year);\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè§£åŒ…æ“ä½œæŒºè´¹åŠ²çš„ã€‚å¦‚æœæˆ‘ä»¬æ€»æ˜¯å…ˆç”¨ <code>Option&lt;T&gt;</code> æˆ– <code>Result&lt;T, E&gt;</code> æŠŠå€¼åŒ…è£¹èµ·æ¥ï¼Œç”¨çš„æ—¶å€™å†æ‰‹åŠ¨è§£åŒ…ï¼Œé‚£å…¶å®è¯´æ˜æ²¡æœ‰çœŸæ­£æŠ“ä½åˆ° <code>Option&lt;T&gt;</code> å’Œ <code>Result&lt;T, E&gt;</code> çš„è®¾è®¡è¦ä¹‰ã€‚åœ¨Rustä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸éœ€è¦è§£åŒ…ä¹Ÿèƒ½æ“ä½œé‡Œé¢çš„å€¼ï¼Œè¿™æ ·å°±ä¸ç”¨åšçœ‹èµ·æ¥å¤šæ­¤ä¸€ä¸¾çš„è§£åŒ…æ“ä½œäº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åœ¨ä¸è§£åŒ…çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€æ ·åšã€‚</p><h3>ä¸è§£åŒ…çš„æƒ…å†µä¸‹å¦‚ä½•æ“ä½œï¼Ÿ</h3><p>ä¸è§£åŒ…çš„æƒ…å†µä¸‹å¦‚æœæƒ³è¦è·å–è¢«åŒ…åœ¨é‡Œé¢çš„å€¼å°±éœ€è¦ç”¨åˆ° <code>Option&lt;T&gt;</code> å’Œ<code>Result&lt;T, E&gt;</code> é‡Œçš„ä¸€äº›å¸¸ç”¨æ–¹æ³•ã€‚</p><p><code>Option&lt;T&gt;</code> ä¸Šçš„å¸¸ç”¨æ–¹æ³•å’Œç¤ºä¾‹ï¼š</p><ul>\n<li>map()ï¼šåœ¨ Option æ˜¯ Some çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ map ä¸­æä¾›çš„å‡½æ•°æˆ–é—­åŒ…æŠŠ Option é‡Œçš„ç±»å‹è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ã€‚åœ¨ Option æ˜¯ None çš„æƒ…å†µä¸‹ï¼Œä¿æŒ None ä¸å˜ã€‚map() ä¼šæ¶ˆè€—åŸç±»å‹ï¼Œä¹Ÿå°±æ˜¯è·å–æ‰€æœ‰æƒã€‚</li>\n</ul><pre><code class=\"language-plain\">let maybe_some_string = Some(String::from(\"Hello, World!\"));\nlet maybe_some_len = maybe_some_string.map(|s| s.len());\nassert_eq!(maybe_some_len, Some(13));\n&nbsp;\nlet x: Option&lt;&amp;str&gt; = None;\nassert_eq!(x.map(|s| s.len()), None);\n</code></pre><ul>\n<li>cloned()ï¼šé€šè¿‡å…‹éš† Option é‡Œé¢çš„å†…å®¹ï¼ŒæŠŠ <code>Option&lt;&amp;T&gt;</code> è½¬æ¢æˆ <code>Option&lt;T&gt;</code>ã€‚</li>\n</ul><pre><code class=\"language-plain\">let x = 12;\nlet opt_x = Some(&amp;x);\nassert_eq!(opt_x, Some(&amp;12));\nlet cloned = opt_x.cloned();\nassert_eq!(cloned, Some(12));\n</code></pre><ul>\n<li>is_some()ï¼šå¦‚æœ Option æ˜¯ Some å€¼ï¼Œè¿”å› trueã€‚</li>\n</ul><pre><code class=\"language-plain\">let x: Option&lt;u32&gt; = Some(2);\nassert_eq!(x.is_some(), true);\n&nbsp;\nlet x: Option&lt;u32&gt; = None;\nassert_eq!(x.is_some(), false);\n</code></pre><ul>\n<li>is_none()ï¼šå¦‚æœ Option æ˜¯ None å€¼ï¼Œè¿”å› trueã€‚</li>\n</ul><pre><code class=\"language-plain\">let x: Option&lt;u32&gt; = Some(2);\nassert_eq!(x.is_none(), false);\n&nbsp;\nlet x: Option&lt;u32&gt; = None;\nassert_eq!(x.is_none(), true);\n</code></pre><ul>\n<li>as_ref()ï¼šæŠŠ <code>Option&lt;T&gt;</code> æˆ– <code>&amp;Option&lt;T&gt;</code> è½¬æ¢æˆ <code>Option&lt;&amp;T&gt;</code>ã€‚åˆ›å»ºä¸€ä¸ªæ–° Optionï¼Œé‡Œé¢çš„ç±»å‹æ˜¯åŸæ¥ç±»å‹çš„å¼•ç”¨ï¼Œå°±æ˜¯ä» <code>Option&lt;T&gt;</code> åˆ° <code>Option&lt;&amp;T&gt;</code>ã€‚åŸæ¥é‚£ä¸ª <code>Option&lt;T&gt;</code> å®ä¾‹ä¿æŒä¸å˜ã€‚</li>\n</ul><pre><code class=\"language-plain\">let text: Option&lt;String&gt; = Some(\"Hello, world!\".to_string());\nlet text_length: Option&lt;usize&gt; = text.as_ref().map(|s| s.len());\nprintln!(\"still can print text: {text:?}\");\n</code></pre><ul>\n<li>as_mut()ï¼šæŠŠ <code>Option&lt;T&gt;</code> æˆ– <code>&amp;mut Option&lt;T&gt;</code> è½¬æ¢æˆ <code>Option&lt;&amp;mut T&gt;</code>ã€‚</li>\n</ul><pre><code class=\"language-plain\">let mut x = Some(2);\nmatch x.as_mut() {\nSome(v) =&gt; *v = 42,\nNone =&gt; {},\n}\nassert_eq!(x, Some(42));\n</code></pre><ul>\n<li>take()ï¼šæŠŠ Option çš„å€¼æ‹¿å‡ºå»ï¼Œåœ¨åŸåœ°ç•™ä¸‹ä¸€ä¸ª None å€¼ã€‚è¿™ä¸ªéå¸¸æœ‰ç”¨ã€‚ç›¸å½“äºæŠŠå€¼æ‹¿å‡ºæ¥ç”¨ï¼Œä½†æ˜¯å´æ²¡æœ‰æ¶ˆè§£åŸæ¥é‚£ä¸ª Optionã€‚</li>\n</ul><pre><code class=\"language-plain\">let mut x = Some(2);\nlet y = x.take();\nassert_eq!(x, None);\nassert_eq!(y, Some(2));\n&nbsp;\nlet mut x: Option&lt;u32&gt; = None;\nlet y = x.take();\nassert_eq!(x, None);\nassert_eq!(y, None);\n</code></pre><ul>\n<li>replace()ï¼šåœ¨åŸåœ°æ›¿æ¢æ–°å€¼ï¼ŒåŒæ—¶æŠŠåŸæ¥é‚£ä¸ªå€¼æŠ›å‡ºæ¥ã€‚</li>\n</ul><pre><code class=\"language-plain\">let mut x = Some(2);\nlet old = x.replace(5);\nassert_eq!(x, Some(5));\nassert_eq!(old, Some(2));\n&nbsp;\nlet mut x = None;\nlet old = x.replace(3);\nassert_eq!(x, Some(3));\nassert_eq!(old, None);\n</code></pre><ul>\n<li>and_then()ï¼šå¦‚æœ Option æ˜¯ Noneï¼Œè¿”å› Noneï¼›å¦‚æœ Option æ˜¯ Someï¼Œå°±æŠŠå‚æ•°é‡Œé¢æä¾›çš„å‡½æ•°æˆ–é—­åŒ…åº”ç”¨åˆ°è¢«åŒ…è£¹çš„å†…å®¹ä¸Šï¼Œå¹¶è¿”å›è¿ç®—åçš„ç»“æœã€‚</li>\n</ul><pre><code class=\"language-plain\">fn sq_then_to_string(x: u32) -&gt; Option&lt;String&gt; {\nx.checked_mul(x).map(|sq| sq.to_string())\n}\n&nbsp;\nassert_eq!(Some(2).and_then(sq_then_to_string), Some(4.to_string()));\nassert_eq!(Some(1_000_000).and_then(sq_then_to_string), None); // overflowed!\nassert_eq!(None.and_then(sq_then_to_string), None);\n</code></pre><p>æˆ‘ä»¬å†çœ‹ <code>Result&lt;T, E&gt;</code> ä¸Šçš„å¸¸ç”¨æ–¹æ³•å’Œç¤ºä¾‹ã€‚</p><ul>\n<li>map()ï¼šå½“ Result æ˜¯ Ok çš„æ—¶å€™ï¼ŒæŠŠ Ok é‡Œçš„ç±»å‹é€šè¿‡å‚æ•°é‡Œæä¾›çš„å‡½æ•°è¿ç®—å¹¶ä¸”å¯ä»¥è½¬æ¢æˆå¦å¤–ä¸€ç§ç±»å‹ã€‚å½“ Result æ˜¯ Err çš„æ—¶å€™ï¼ŒåŸæ ·è¿”å› Err å’Œå®ƒæºå¸¦çš„å†…å®¹ã€‚</li>\n</ul><pre><code class=\"language-plain\">let line = \"1\\n2\\n3\\n4\\n\";\n&nbsp;\nfor num in line.lines() {\nmatch num.parse::&lt;i32&gt;().map(|i| i * 2) {\nOk(n) =&gt; println!(\"{n}\"),\nErr(..) =&gt; {}\n}\n}\n</code></pre><ul>\n<li>is_ok()ï¼šå¦‚æœ Result æ˜¯ Okï¼Œè¿”å› trueã€‚</li>\n</ul><pre><code class=\"language-plain\">let x: Result&lt;i32, &amp;str&gt; = Ok(-3);\nassert_eq!(x.is_ok(), true);\n&nbsp;\nlet x: Result&lt;i32, &amp;str&gt; = Err(\"Some error message\");\nassert_eq!(x.is_ok(), false);\n</code></pre><ul>\n<li>is_err()ï¼šå¦‚æœ Result æ˜¯ Errï¼Œè¿”å› trueã€‚</li>\n</ul><pre><code class=\"language-plain\">let x: Result&lt;i32, &amp;str&gt; = Ok(-3);\nassert_eq!(x.is_err(), false);\n&nbsp;\nlet x: Result&lt;i32, &amp;str&gt; = Err(\"Some error message\");\nassert_eq!(x.is_err(), true);\n</code></pre><ul>\n<li>as_ref()ï¼šåˆ›å»ºä¸€ä¸ªæ–° Resultï¼Œé‡Œé¢çš„ä¸¤ç§ç±»å‹åˆ†åˆ«æ˜¯åŸæ¥ä¸¤ç§ç±»å‹çš„å¼•ç”¨ï¼Œå°±æ˜¯ä» <code>Result&lt;T, E&gt;</code> åˆ° <code>Result&lt;&amp;T, &amp;E&gt;</code>ã€‚åŸæ¥é‚£ä¸ª <code>Result&lt;T, E&gt;</code> å®ä¾‹ä¿æŒä¸å˜ã€‚</li>\n</ul><pre><code class=\"language-plain\">let x: Result&lt;u32, &amp;str&gt; = Ok(2);\nassert_eq!(x.as_ref(), Ok(&amp;2));\n&nbsp;\nlet x: Result&lt;u32, &amp;str&gt; = Err(\"Error\");\nassert_eq!(x.as_ref(), Err(&amp;\"Error\"));\n</code></pre><ul>\n<li>as_mut()ï¼šåˆ›å»ºä¸€ä¸ªæ–° Resultï¼Œé‡Œé¢çš„ä¸¤ç§ç±»å‹åˆ†åˆ«æ˜¯åŸæ¥ä¸¤ç§ç±»å‹çš„å¯å˜å¼•ç”¨ï¼Œå°±æ˜¯ä» <code>Result&lt;T, E&gt;</code> åˆ° <code>Result&lt;&amp;mut T, &amp;mut E&gt;</code>ã€‚åŸæ¥é‚£ä¸ª <code>Result&lt;T, E&gt;</code> å®ä¾‹ä¿æŒä¸å˜ã€‚</li>\n</ul><pre><code class=\"language-plain\">fn mutate(r: &amp;mut Result&lt;i32, i32&gt;) {\nmatch r.as_mut() {\nOk(v) =&gt; *v = 42,\nErr(e) =&gt; *e = 0,\n}\n}\nlet mut x: Result&lt;i32, i32&gt; = Ok(2);\nmutate(&amp;mut x);\nassert_eq!(x.unwrap(), 42);\nlet mut x: Result&lt;i32, i32&gt; = Err(13);\nmutate(&amp;mut x);\nassert_eq!(x.unwrap_err(), 0);\n</code></pre><ul>\n<li>and_then()ï¼šå½“ Result æ˜¯ Ok æ—¶ï¼ŒæŠŠè¿™ä¸ªæ–¹æ³•æä¾›çš„å‡½æ•°æˆ–é—­åŒ…åº”ç”¨åˆ° Ok æºå¸¦çš„å†…å®¹ä¸Šé¢ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ Resultã€‚å½“ Result æ˜¯ Err çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•ç›´æ¥ä¼ é€’è¿”å›è¿™ä¸ª Err å’Œå®ƒçš„è´Ÿè½½ã€‚è¿™ä¸ªæ–¹æ³•å¸¸å¸¸ç”¨äºä¸€è·¯é“¾å¼æ“ä½œï¼Œå‰ææ˜¯è¿‡ç¨‹é‡Œçš„æ¯ä¸€æ­¥éƒ½éœ€è¦è¿”å› Resultã€‚</li>\n</ul><pre><code class=\"language-plain\">fn sq_then_to_string(x: u32) -&gt; Result&lt;String, &amp;'static str&gt; {\nx.checked_mul(x).map(|sq| sq.to_string()).ok_or(\"overflowed\")\n}\n&nbsp;\nassert_eq!(Ok(2).and_then(sq_then_to_string), Ok(4.to_string()));\nassert_eq!(Ok(1_000_000).and_then(sq_then_to_string), Err(\"overflowed\"));\nassert_eq!(Err(\"not a number\").and_then(sq_then_to_string), Err(\"not a number\"));\n</code></pre><ul>\n<li>map_err()ï¼šå½“ Result æ˜¯ Ok æ—¶ï¼Œä¼ é€’åŸæ ·è¿”å›ã€‚å½“ Result æ˜¯ Erræ—¶ï¼Œå¯¹ Err æºå¸¦çš„å†…å®¹ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æä¾›çš„å‡½æ•°æˆ–é—­åŒ…è¿›è¡Œè¿ç®—åŠç±»å‹è½¬æ¢ã€‚è¿™ä¸ªæ–¹æ³•å¸¸å¸¸ç”¨äºè½¬æ¢ Result çš„ Err çš„è´Ÿè½½çš„ç±»å‹ï¼Œåœ¨é”™è¯¯å¤„ç†æµç¨‹ä¸­å¤§é‡ä½¿ç”¨ã€‚</li>\n</ul><pre><code class=\"language-plain\">fn stringify(x: u32) -&gt; String { format!(\"error code: {x}\") }\nlet x: Result&lt;u32, u32&gt; = Ok(2);\nassert_eq!(x.map_err(stringify), Ok(2));\nlet x: Result&lt;u32, u32&gt; = Err(13);\nassert_eq!(x.map_err(stringify), Err(\"error code: 13\".to_string()));\n</code></pre><h3><code>Option&lt;T&gt;</code> ä¸ <code>Result&lt;T, E&gt;</code> çš„ç›¸äº’è½¬æ¢</h3><p><code>Option&lt;T&gt;</code> ä¸ <code>Result&lt;T, E&gt;</code> ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ã€‚è½¬æ¢çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œ<code>Result&lt;T, E&gt;</code> æ¯” <code>Option&lt;T&gt;</code> å¤šä¸€ä¸ªç±»å‹å‚æ•°ï¼Œæ‰€ä»¥å®ƒå¸¦çš„ä¿¡æ¯æ¯” <code>Option&lt;T&gt;</code> å¤šä¸€ä»½ï¼Œå› æ­¤æ ¸å¿ƒè¦ç‚¹å°±æ˜¯<strong>è¦æ³¨æ„ä¿¡æ¯çš„æ·»åŠ ä¸æŠ›å¼ƒ</strong>ã€‚</p><h4><code>ä»Option&lt;T&gt;</code> åˆ° <code>Result&lt;T, E&gt;ï¼šok_or()</code></h4><p><code>Option&lt;T&gt;</code> å®ä¾‹å¦‚æœæ˜¯ <code>Some</code>ï¼Œç›´æ¥æŠŠå†…å®¹é‡æ–°åŒ…åœ¨ <code>Result&lt;T, E&gt;::Ok()</code> é‡Œã€‚å¦‚æœæ˜¯ <code>None</code>ï¼Œä½¿ç”¨ <code>ok_or()</code> é‡Œæä¾›çš„å‚æ•°ä½œä¸º <code>Err</code> çš„å†…å®¹ã€‚</p><pre><code class=\"language-plain\">let x = Some(\"foo\");\nassert_eq!(x.ok_or(0), Ok(\"foo\"));\n\nlet x: Option&lt;&amp;str&gt; = None;\nassert_eq!(x.ok_or(0), Err(0));\n</code></pre><h4>ä» <code>Result&lt;T, E&gt;</code> åˆ° <code>Option&lt;T&gt;ï¼šok()</code></h4><p>å¦‚æœ <code>Result&lt;T, E&gt;</code> æ˜¯ <code>Ok</code>ï¼Œå°±æŠŠå†…å®¹é‡æ–°åŒ…åœ¨ <code>Some</code> é‡Œã€‚å¦‚æœ <code>Result&lt;T, E&gt;</code> æ˜¯ <code>Err</code>ï¼Œå°±ç›´æ¥æ¢æˆ <code>None</code>ï¼Œä¸¢å¼ƒ <code>Err</code> é‡Œçš„å†…å®¹ï¼ŒåŒæ—¶åŸ <code>Result&lt;T, E&gt;</code> å®ä¾‹è¢«æ¶ˆè´¹ã€‚</p><pre><code class=\"language-plain\">let x: Result&lt;u32, &amp;str&gt; = Ok(2);\nassert_eq!(x.ok(), Some(2));\n\nlet x: Result&lt;u32, &amp;str&gt; = Err(\"Nothing here\");\nassert_eq!(x.ok(), None);\n</code></pre><h4>ä» <code>Result&lt;T, E&gt;</code> åˆ° <code>Option&lt;T&gt;ï¼šerr()</code></h4><p>å¦‚æœ <code>Result&lt;T, E&gt;</code> æ˜¯ <code>Ok</code>ï¼Œç›´æ¥æ¢æˆ <code>None</code>ï¼Œä¸¢å¼ƒ <code>Ok</code> é‡Œçš„å†…å®¹ã€‚å¦‚æœ <code>Result&lt;T, E&gt;</code> æ˜¯ <code>Err</code>ï¼ŒæŠŠå†…å®¹é‡æ–°åŒ…åœ¨ <code>Some</code> é‡Œï¼ŒåŒæ—¶åŸ <code>Result&lt;T, E&gt;</code> å®ä¾‹è¢«æ¶ˆè´¹ã€‚</p><pre><code class=\"language-plain\">let x: Result&lt;u32, &amp;str&gt; = Ok(2);\nassert_eq!(x.err(), None);\n\nlet x: Result&lt;u32, &amp;str&gt; = Err(\"Nothing here\");\nassert_eq!(x.err(), Some(\"Nothing here\"));\n</code></pre><p>ä¸‹é¢æˆ‘ä»¬è®²è®²è¿­ä»£å™¨ã€‚</p><h2>è¿­ä»£å™¨</h2><p>è¿­ä»£å™¨å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å¯¹ä¸€ä¸ªé›†åˆç±»å‹è¿›è¡Œéå†ã€‚æ¯”å¦‚å¯¹ <code>Vec&lt;T&gt;</code>ã€å¯¹ <code>HashMap&lt;K, V&gt;</code> ç­‰è¿›è¡Œéå†ã€‚ä½¿ç”¨è¿­ä»£å™¨æœ‰ä¸€äº›å¥½å¤„ï¼Œæ¯”å¦‚ï¼š</p><ol>\n<li>æŒ‰éœ€ä½¿ç”¨ï¼Œä¸éœ€è¦æŠŠç›®æ ‡é›†åˆä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œä½¿ç”¨ä¸€ç‚¹åŠ è½½ä¸€ç‚¹ã€‚</li>\n<li>æƒ°æ€§è®¡ç®—ï¼Œå¯ä»¥ç”¨æ¥è¡¨è¾¾æ— é™åŒºé—´ï¼Œæ¯”å¦‚ç¬¬ä¸€è®²æˆ‘ä»¬è¯´çš„rangeï¼Œå¯ä»¥è¡¨è¾¾1åˆ°æ— é™è¿™ä¸ªé›†åˆï¼Œè¿™ç§åœ¨å…¶ä»–æœ‰äº›è¯­è¨€ä¸­å¾ˆéš¾è¡¨è¾¾ã€‚</li>\n<li>å¯ä»¥å®‰å…¨åœ°è®¿é—®è¾¹ç•Œï¼Œä¸éœ€è¦ä½¿ç”¨æœ‰è®¿é—®é£é™©çš„ä¸‹æ ‡æ“ä½œç¬¦ã€‚</li>\n</ol><h3><code>next()</code> æ–¹æ³•</h3><p>è¿­ä»£å™¨ä¸Šæœ‰ä¸€ä¸ªæ ‡å‡†æ–¹æ³•ï¼Œå«ä½œ <code>next()</code>ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å› <code>Option&lt;Item&gt;</code>ï¼Œå…¶ä¸­ Item å°±æ˜¯ç»„æˆè¿­ä»£å™¨çš„å…ƒç´ ã€‚è¿™ä¸ªæ–¹æ³•çš„å­—é¢æ„æ€å°±æ˜¯<strong>è¿­ä»£å‡ºä¸‹ä¸€ä¸ªå…ƒç´ </strong>ã€‚å¦‚æœè¿™ä¸ªé›†åˆè¢«è¿­ä»£å®Œæˆäº†ï¼Œé‚£ä¹ˆæœ€åä¸€æ¬¡æ‰§è¡Œä¼šè¿”å› <code>None</code>ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œåœ¨è¿­ä»£å™¨ä¸Šè°ƒç”¨ <code>.next()</code> è¿”å› <code>u32</code> æ•°å­—ã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let a: Vec&lt;u32&gt; = vec![1, 2, 3, 4, 5];\n&nbsp; &nbsp; let mut an_iter = a.into_iter();    // å°†Vec&lt;u32&gt;è½¬æ¢ä¸ºè¿­ä»£å™¨\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; while let Some(i) = an_iter.next() {  // è°ƒç”¨ .next() æ–¹æ³•\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"{i}\");\n&nbsp; &nbsp; }\n}\n// è¾“å‡º\n1\n2\n3\n4\n5\n</code></pre><p>å®é™…ä¸Šï¼ŒRustä¸­ä¸æ­¢ <code>into_iter()</code> è¿™ä¸€ç§å°†é›†åˆè½¬æ¢æˆè¿­ä»£å™¨çš„æ–¹æ³•ã€‚</p><h3><code>iter()</code>ã€<code>iter_mut()</code>ã€<code>into_iter()</code>ä¸ä¸‰ç§è¿­ä»£å™¨</h3><p>Rustä¸­çš„è¿­ä»£å™¨æ ¹æ®æ‰€æœ‰æƒä¸‰æ€å¯ä»¥åˆ†æˆä¸‰ç§ã€‚</p><ol>\n<li>è·å–é›†åˆå…ƒç´ ä¸å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨ï¼Œå¯¹åº”æ–¹æ³•ä¸º <code>iter()</code>ã€‚</li>\n<li>è·å–é›†åˆå…ƒç´ å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨ï¼Œå¯¹åº”æ–¹æ³•ä¸º <code>iter_mut()</code>ã€‚</li>\n<li>è·å–é›†åˆå…ƒç´ æ‰€æœ‰æƒçš„è¿­ä»£å™¨ï¼Œå¯¹åº”æ–¹æ³•ä¸º <code>into_iter()</code>ã€‚</li>\n</ol><p>åœ¨Rustæ ‡å‡†åº“çº¦å®šä¸­ï¼Œå¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªç±»å‹ä¸Šå®ç°äº† <code>iter()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›è·å–é›†åˆå…ƒç´ ä¸å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨ï¼›å¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªç±»å‹ä¸Šå®ç°äº† <code>iter_mut()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›è·å–é›†åˆå…ƒç´ å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨ï¼›å¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªç±»å‹ä¸Šå®ç°äº† <code>into_iter()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›è·å–é›†åˆå…ƒç´ æ‰€æœ‰æƒçš„è¿­ä»£å™¨ã€‚è°ƒç”¨äº†è¿™ä¸ªè¿­ä»£å™¨åï¼Œè¿­ä»£å™¨çš„æ‰§è¡Œä¼šæ¶ˆè€—æ‰åŸé›†åˆã€‚</p><p>æˆ‘ä»¬æ¥çœ‹è¿™ä¸‰ç§ä¸åŒçš„è¿­ä»£å™¨çš„ä¸€ä¸ªå¯¹æ¯”ã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let mut a = [1, 2, 3];    // ä¸€ä¸ªæ•´æ•°æ•°ç»„\n\n&nbsp; &nbsp; let mut an_iter = a.iter();  // è½¬æ¢æˆç¬¬ä¸€ç§è¿­ä»£å™¨\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(&amp;1), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;2), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;3), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n\n&nbsp; &nbsp; let mut an_iter = a.iter_mut();  // è½¬æ¢æˆç¬¬äºŒç§è¿­ä»£å™¨\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut 1), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut 2), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut 3), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n\n&nbsp; &nbsp; let mut an_iter = a.into_iter();  // è½¬æ¢æˆç¬¬ä¸‰ç§è¿­ä»£å™¨ï¼Œå¹¶æ¶ˆè€—æ‰a\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(1), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(2), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(3), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n\n    println!(\"{:?}\", a);\n}\n</code></pre><p>ä½ è¿˜å¯ä»¥ä¸å­—ç¬¦ä¸²æ•°ç»„è¿›è¡Œå¯¹æ¯”åŠ æ·±ç†è§£ã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let mut a = [\"1\".to_string(), \"2\".to_string(), \"3\".to_string()];\n&nbsp; &nbsp; let mut an_iter = a.iter();\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(&amp;\"1\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;\"2\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;\"3\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n\n&nbsp; &nbsp; let mut an_iter = a.iter_mut();\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut \"1\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut \"2\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(&amp;mut \"3\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n\n&nbsp; &nbsp; let mut an_iter = a.into_iter();\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; assert_eq!(Some(\"1\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(\"2\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(Some(\"3\".to_string()), an_iter.next());\n&nbsp; &nbsp; assert_eq!(None, an_iter.next());\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; println!(\"{:?}\", a);    // è¯·ä½ è¯•è¯•è¿™ä¸€è¡Œæœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ\n}\n</code></pre><p>å¯¹äºæ•´æ•°æ•°ç»„ <code>[1,2,3]</code> è€Œè¨€ï¼Œè°ƒç”¨ <code>into_iter()</code> å®é™…ä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªæ•°ç»„ï¼Œå†å°†å¤åˆ¶åçš„æ•°ç»„è½¬æ¢æˆè¿­ä»£å™¨ï¼Œå¹¶æ¶ˆè€—æ‰è¿™ä¸ªå¤åˆ¶åçš„æ•°ç»„ï¼Œå› æ­¤æœ€åçš„æ‰“å°è¯­å¥èƒ½æŠŠåŸæ¥é‚£ä¸ªaæ‰“å°å‡ºæ¥ã€‚å¯¹äºå­—ç¬¦ä¸²æ•°ç»„ <code>[\"1\".to_string(), \"2\".to_string(), \"3\".to_string()]</code> è€Œè¨€ï¼Œè°ƒç”¨ <code>into_iter()</code> ä¼šç›´æ¥æ¶ˆè€—æ‰è¿™ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå› æ­¤æœ€åçš„æ‰“å°è¯­å¥ä¸èƒ½æŠŠåŸæ¥é‚£ä¸ªaæ‰“å°å‡ºæ¥ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªå·®å¼‚å‘¢ï¼Ÿä½ å¯ä»¥ä»æˆ‘ä»¬<a href=\"https://time.geekbang.org/column/article/718916\">ç¬¬ 2 è®²</a>æ‰€æœ‰æƒç›¸å…³çŸ¥è¯†ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚</p><h3>for è¯­å¥çš„çœŸé¢ç›®</h3><p>æœ‰äº†è¿­ä»£å™¨çš„èƒŒæ™¯çŸ¥è¯†åï¼Œæˆ‘ä»¬ç»ˆäºè¦è§£å¼€Rustè¯­è¨€é‡Œé¢forè¯­å¥çš„çœŸé¢ç›®äº†ã€‚forè¯­å¥æ˜¯ä¸€ç§è¯­æ³•ç³–ã€‚è¯­å¥ <code>for item in c {}</code> ä¼šå±•å¼€æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code class=\"language-plain\">let mut tmp_iter = c.into_iter();\nwhile let Some(item) = tmp_iter.next() {}\n</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œforè¯­å¥é»˜è®¤ä½¿ç”¨è·å–å…ƒç´ æ‰€æœ‰æƒçš„è¿­ä»£å™¨æ¨¡å¼ï¼Œè‡ªåŠ¨è°ƒç”¨äº† <code>into_iter()</code> æ–¹æ³•ã€‚å› æ­¤ï¼Œforè¯­å¥ä¼šæ¶ˆè€—é›†åˆ cã€‚åŒæ—¶ä¹Ÿè¯´æ˜ï¼Œè¦å°†ä¸€ä¸ªç±»å‹æ”¾åœ¨forè¯­å¥é‡Œè¿›è¡Œè¿­ä»£ï¼Œéœ€è¦è¿™ä¸ªç±»å‹å®ç°äº†è¿­ä»£å™¨ <code>into_iter()</code> æ–¹æ³•ã€‚</p><p>æ ‡å‡†åº“ä¸­å¸¸è§çš„ Rangeã€Vecã€HashMapã€BtreeMapç­‰éƒ½å®ç°äº† <code>into_iter()</code> æ–¹æ³•ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥æ”¾åœ¨forè¯­å¥é‡Œè¿›è¡Œè¿­ä»£ã€‚</p><p>forè¯­å¥ä½œä¸ºä¸€ç§åŸºç¡€è¯­æ³•ï¼Œå®ƒä¼šæ¶ˆè€—æ‰åŸé›†åˆã€‚æœ‰æ—¶å€™å¸Œæœ›ä¸è·å–åŸé›†åˆå…ƒç´ æ‰€æœ‰æƒï¼Œæ¯”å¦‚åªæ˜¯æ‰“å°ä¸€ä¸‹ï¼Œè¿™æ—¶åªéœ€è¦è·å–é›†åˆå…ƒç´ çš„å¼•ç”¨ ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>Rustä¸­ä¹Ÿè€ƒè™‘åˆ°äº†è¿™ç§éœ€æ±‚ï¼Œæä¾›äº†é…å¥—çš„è¾…åŠ©è¯­æ³•ã€‚</p><ul>\n<li>ç”¨ <code>for  in &amp;c {}</code> è·å–å…ƒç´ çš„ä¸å¯å˜å¼•ç”¨ï¼Œç›¸å½“äºè°ƒç”¨ <code>c.iter()</code>ã€‚</li>\n<li>ç”¨ <code>for  in &amp;mut c {}</code> è·å–å…ƒç´ çš„å¯å˜å¼•ç”¨ï¼Œç›¸å½“äºè°ƒç”¨ <code>c.iter_mut()</code>ã€‚</li>\n</ul><p>ç”¨è¿™ä¸¤ç§å½¢å¼å°±ä¸ä¼šæ¶ˆè€—åŸé›†åˆæ‰€æœ‰æƒã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let mut a = [\"1\".to_string(), \"2\".to_string(), \"3\".to_string()];\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; for item in &amp;a {  \n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"{}\", item);\n&nbsp; &nbsp; }\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; for item in &amp;mut a {\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"{}\", item);\n&nbsp; &nbsp; }\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; for item in a {    // è¯·æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸€å¥æ”¾åœ¨åé¢\n&nbsp; &nbsp; &nbsp; &nbsp; println!(\"{}\", item);\n&nbsp; &nbsp; }\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; // println!(\"{:?}\", a);  // ä½ å¯ä»¥è¯•è¯•æŠŠè¿™ä¸€å¥æ‰“å¼€\n}\n// è¾“å‡º\n1\n2\n3\n1\n2\n3\n1\n2\n3\n</code></pre><p>å› ä¸º <code>into_iter()</code> ä¼šæ¶ˆè€—é›†åˆæ‰€æœ‰æƒï¼Œå› æ­¤åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨æœ€åå»å±•ç¤ºã€‚</p><h3>è·å–é›†åˆç±»å‹ä¸­å…ƒç´ çš„æ‰€æœ‰æƒ</h3><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³è¦è·å–Vecé‡Œçš„ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦ä¸‹æ ‡æ“ä½œå°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-plain\">fn main() {\n    let s1 = String::from(\"aaa\");\n    let s2 = String::from(\"bbb\");\n    let s3 = String::from(\"ccc\");\n    let s4 = String::from(\"ddd\");\n    \n    let v = vec![s1, s2, s3, s4];\n    let a = v[0];    // è¿™é‡Œï¼Œæˆ‘ä»¬æƒ³è®¿é—® s1 çš„å†…å®¹\n}\n</code></pre><p>è¿™æ®µä»£ç ç¨€æ¾å¹³å¸¸ï¼Œåœ¨Rustä¸­å´æ²¡åŠæ³•ç¼–è¯‘é€šè¿‡ã€‚</p><pre><code>error[E0507]: cannot move out of index of `Vec&lt;String&gt;`\n  --&gt; src/main.rs:11:13\n   |\n11 |     let a = v[0];  \n   |             ^^^^ move occurs because value has type `String`, which does not implement the `Copy` trait\n   |\nhelp: consider borrowing here\n   |\n11 |     let a = &amp;v[0]; \n   |             +\n</code></pre><p>æç¤ºä¸èƒ½ä» <code>Vec&lt;String&gt;</code> ä¸­ç”¨ä¸‹æ ‡æ“ä½œç¬¦ç§»å‡ºå…ƒç´ ã€‚æˆ‘ä»¬æ”¹ä¸€ä¸‹ä»£ç ã€‚</p><pre><code>fn main() {\n    let s1 = String::from(&quot;aaa&quot;);\n    let s2 = String::from(&quot;bbb&quot;);\n    let s3 = String::from(&quot;ccc&quot;);\n    let s4 = String::from(&quot;ddd&quot;);\n    \n    let v = vec![s1, s2, s3, s4];\n    let a = &amp;v[0];  // æ˜ç¡®aåªè·å¾—vä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨\n}\n</code></pre><p>æ˜ç¡®aåªè·å¾—vä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¿™ä¸‹å¯ä»¥ç¼–è¯‘é€šè¿‡äº†ã€‚è¿™é‡Œï¼Œä½ å¯ä»¥é¡ºä¾¿æ€è€ƒä¸€ä¸‹ï¼Œå¯¹äº <code>Vec&lt;u32&gt;</code> è¿™ç§ç±»å‹çš„åŠ¨æ€æ•°ç»„ï¼Œlet a = v[0]; è¿™ç§ä»£ç å¯ä»¥ç¼–è¯‘é€šè¿‡å—ï¼Ÿä½ å¯ä»¥ç«‹å³åŠ¨æ‰‹æµ‹è¯•ä¸€ä¸‹ã€‚</p><p>åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œä½ å¯èƒ½ä¸ºäº†ä»é›†åˆä¸­è·å¾— s1 çš„æ‰€æœ‰æƒï¼Œè€Œä¸å¾—ä¸ä½¿ç”¨ <code>let a = v[0].clone()</code>ã€‚è€Œæ ¹æ®æˆ‘ä»¬è¿™èŠ‚è¯¾è®²çš„è¿­ä»£å™¨çŸ¥è¯†ï¼Œä½¿ç”¨ <code>into_iter()</code> å°±å¯ä»¥æ‹¿åˆ°å¹¶æ“ä½œä¸Šè¿°åŠ¨æ€æ•°ç»„vä¸­å…ƒç´ çš„æ‰€æœ‰æƒã€‚</p><pre><code class=\"language-plain\">fn main() {\n    let s1 = String::from(\"aaa\");\n    let s2 = String::from(\"bbb\");\n    let s3 = String::from(\"ccc\");\n    let s4 = String::from(\"ddd\");\n    \n    let v = vec![s1, s2, s3, s4];\n    for s in v {      // è¿™é‡Œï¼Œsæ‹¿åˆ°äº†é›†åˆå…ƒç´ çš„æ‰€æœ‰æƒ\n        println!(\"{}\", s);\n    }\n}\n</code></pre><p>è¿™ä¹Ÿä½“ç°äº†Rustå¯¹æƒé™æœ‰ç›¸å½“ç»†è‡´çš„ç®¡ç†ã€‚å¯¹äºä¸‹æ ‡ç´¢å¼•è¿™ç§ä¸å®‰å…¨çš„æ“ä½œï¼Œç¦æ­¢è·å¾—é›†åˆå…ƒç´ æ‰€æœ‰æƒï¼›å¯¹äºè¿­ä»£å™¨è¿™ç§å®‰å…¨çš„æ“ä½œï¼Œå…è®¸å®ƒè·å¾—é›†åˆå…ƒç´ æ‰€æœ‰æƒã€‚</p><h2>å°ç»“</h2><p>æˆ‘ä»¬è¿™èŠ‚è¯¾è¯¦ç»†æ¢è®¨äº†Rustä¸­çš„ <code>Option&lt;T&gt;</code> å’Œ <code>Result&lt;T, E&gt;</code> çš„å®šä¹‰åŠå¸¸è§æ“ä½œã€‚å­¦ä¹ äº†å¦‚ä½•ä»¥è§£åŒ…å’Œä¸è§£åŒ…æ–¹å¼ä½¿ç”¨å®ƒä»¬ã€‚å†…å®¹æ¯”è¾ƒç»†ï¼Œé£æ ¼å¯èƒ½ä¹Ÿæ˜¯ä½ ä¸å¤ªç†Ÿæ‚‰çš„ã€‚ä¸è¿‡ç°åœ¨ä½ åªéœ€è¦å…ˆäº†è§£è¿™ç§ä»£ç é£æ ¼ï¼Œä»¥åçš„é¡¹ç›®å®è·µä¸­å†æ…¢æ…¢æŒæ¡å®ƒä»¬ã€‚</p><p>æˆ‘ä»¬è¿˜ä»‹ç»äº†è¿­ä»£å™¨çš„æ¦‚å¿µã€‚è¿­ä»£å™¨çš„ <code>next()</code> æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª <code>Option&lt;Item&gt;</code> ç±»å‹ã€‚åœ¨æ‰€æœ‰æƒä¸‰æ€ç†è®ºçš„æŒ‡å¯¼ä¸‹Rustä¸­çš„è¿­ä»£å™¨ä¹Ÿåˆ’åˆ†æˆäº†ä¸‰ç§ï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹æ³•è·å–åˆ°é›†åˆå…ƒç´ çš„ä¸å¯å˜å¼•ç”¨ã€å¯å˜å¼•ç”¨å’Œæ‰€æœ‰æƒï¼Œè¿™æ˜¯Rustå’Œå…¶ä»–è¯­è¨€çš„è¿­ä»£å™¨å¾ˆä¸ä¸€æ ·çš„åœ°æ–¹ã€‚æ¯ç§è¿­ä»£å™¨éƒ½æœ‰å„è‡ªé€‚ç”¨çš„åœºæ™¯ï¼Œæ­£ç¡®ä½¿ç”¨è¿­ä»£å™¨èƒ½æé«˜ä»£ç çš„å¯é æ€§å’Œå¯é˜…è¯»æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/32/d300204ce7c0e9a948b486d617e7fa32.jpg?wh=1646x1233\" alt=\"\"></p><p>å­¦ä¹ å®Œè¿™èŠ‚è¯¾çš„å†…å®¹ä¹‹åï¼Œä½ åº”è¯¥èƒ½æ›´æ·±åˆ»åœ°æ„Ÿå—åˆ°æ‰€æœ‰æƒæ¦‚å¿µåœ¨Rustè¯­è¨€ä¸­çš„æ”¯é…åœ°ä½ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä½ å¯ä»¥ç”¨åŒæ ·çš„æ€è·¯å»ç ”ç©¶ä¸€ä¸‹ï¼Œçœ‹çœ‹å¦‚ä½•æ‹¿åˆ° HashMap ä¸­å€¼çš„æ‰€æœ‰æƒã€‚</p><p><a href=\"https://doc.rust-lang.org/std/collections/struct.HashMap.html\">https://doc.rust-lang.org/std/collections/struct.HashMap.html</a></p><p>æ¬¢è¿ä½ æŠŠä½ çš„æˆæœå±•ç¤ºåœ¨è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹ï¼Œé‚€ä»–ä¸€èµ·å­¦ä¹ ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":383539,"user_name":"å¤©é«˜åœ°è¿¥","can_delete":false,"product_type":"c1","uid":2673491,"ip_address":"ä¸Šæµ·","ucode":"1C5C53C9BA97A7","user_header":"https://static001.geekbang.org/account/avatar/00/28/cb/53/74a6cd05.jpg","comment_is_top":false,"comment_ctime":1699242166,"is_pvip":false,"replies":[{"id":139741,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699256789,"ip_address":"é‡åº†","comment_id":383539,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"Vec&lt;String&gt; []ç´¢å¼•ä¸èƒ½moveçš„åŸå› æ€è€ƒï¼š\nVecå®ç°äº†Index traitçš„indexæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¼•ç”¨ã€‚ç„¶åä½¿ç”¨ï¼»ï¼½è¯­æ³•ç³–çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è§£å¼•ç”¨ï¼švï¼»0ï¼½å˜æˆ*v.index(&amp;0)ã€‚å…¶å®é”™è¯¯çš„æœ¬è´¨æ˜¯borrowed valueä¸èƒ½move outã€‚","like_count":17,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631024,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699256789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383958,"user_name":"Ransang","can_delete":false,"product_type":"c1","uid":1133041,"ip_address":"ä¸Šæµ·","ucode":"DB67566A627DF2","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","comment_is_top":false,"comment_ctime":1700019401,"is_pvip":false,"replies":[{"id":140102,"content":"å¯¹ï¼Œä½ å‘ç°äº†ä¸€ä¸ªæƒŠäººçš„äº‹å®ï¼Œæœ‰ç”¨çš„çŸ¥è¯†åˆå¢åŠ äº†ï¼\nä½ ä¼šå‘ç°ï¼Œæ‰€æœ‰çš„ iter() å’Œ iter_mut() éƒ½æ˜¯å®ç°åœ¨ types ä¸Šçš„ï¼Œå®ƒä»¬çš„è¾“å‡ºç»“æœå°±æ˜¯å°† type å˜æˆå¦ä¸€ä¸ªtype_iï¼Œè¿™ä¸ªtype_i å®ç°äº† Iterator traitã€‚è€Œå¯¹æ‰€æœ‰å®ç°äº† Iterator trait çš„ï¼Œåˆè‡ªåŠ¨ä¸ºå…¶å®ç°äº† IntoIterator traitï¼Œinto_iter() æ­£æ˜¯è¿™ä¸ªtraitä¸­çš„æ–¹æ³•ã€‚ç¬¬09è®²ä¼šè®²åˆ°è¿™æ–¹é¢çš„é¢„å¤‡çŸ¥è¯†ã€‚\nè¿™ç§åˆ†ç¦»å®ç°æ˜¯Rustçš„å…¸å‹ç‰¹è‰²ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç±»å‹éƒ½éœ€è¦å®ç°è¿™3ç§è¿­ä»£å™¨çš„ï¼Œè¿™æ ·è®¾è®¡å¯å¸¦æ¥æœ€å¤§ç¨‹åº¦çš„çµæ´»æ€§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1700191900,"ip_address":"é‡åº†","comment_id":383958,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"HashMapå®ç°äº†into_iter()ï¼Œå› æ­¤å¯ä»¥ç”¨forè¯­å¥è·å–å…¶æ‰€æœ‰æƒï¼Œå¦å¤–æˆ‘åœ¨è€å¸ˆå‘çš„hashmapçš„æ–‡æ¡£ä¸­å‘ç°HashMapçš„iter()å’Œiter_mut()æ˜¯åˆ†ç±»åœ¨Implementationsä¸­ï¼Œè€Œinto_iter()æ˜¯åœ¨Trait Implementationsä¸­ï¼Œè¯·é—®è¿™é‡Œé¢æœ‰ä»€ä¹ˆç‰¹æ®Šä¹‹å¤„å—","like_count":6,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631948,"discussion_content":"å¯¹ï¼Œä½ å‘ç°äº†ä¸€ä¸ªæƒŠäººçš„äº‹å®ï¼Œæœ‰ç”¨çš„çŸ¥è¯†åˆå¢åŠ äº†ï¼\nä½ ä¼šå‘ç°ï¼Œæ‰€æœ‰çš„ iter() å’Œ iter_mut() éƒ½æ˜¯å®ç°åœ¨ types ä¸Šçš„ï¼Œå®ƒä»¬çš„è¾“å‡ºç»“æœå°±æ˜¯å°† type å˜æˆå¦ä¸€ä¸ªtype_iï¼Œè¿™ä¸ªtype_i å®ç°äº† Iterator traitã€‚è€Œå¯¹æ‰€æœ‰å®ç°äº† Iterator trait çš„ï¼Œåˆè‡ªåŠ¨ä¸ºå…¶å®ç°äº† IntoIterator traitï¼Œinto_iter() æ­£æ˜¯è¿™ä¸ªtraitä¸­çš„æ–¹æ³•ã€‚ç¬¬09è®²ä¼šè®²åˆ°è¿™æ–¹é¢çš„é¢„å¤‡çŸ¥è¯†ã€‚\nè¿™ç§åˆ†ç¦»å®ç°æ˜¯Rustçš„å…¸å‹ç‰¹è‰²ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç±»å‹éƒ½éœ€è¦å®ç°è¿™3ç§è¿­ä»£å™¨çš„ï¼Œè¿™æ ·è®¾è®¡å¯å¸¦æ¥æœ€å¤§ç¨‹åº¦çš„çµæ´»æ€§ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1700191900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385310,"user_name":"å°å¯çˆ±(`ã¸Â´*)ãƒ","can_delete":false,"product_type":"c1","uid":1016404,"ip_address":"å››å·","ucode":"E75189846F6616","user_header":"https://static001.geekbang.org/account/avatar/00/0f/82/54/b9cd3674.jpg","comment_is_top":false,"comment_ctime":1702428815,"is_pvip":false,"replies":[{"id":140430,"content":"è°¢è°¢","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702436108,"ip_address":"é‡åº†","comment_id":385310,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆè®²çš„å¾ˆå¥½ï¼Œå¤šäº†è§£ruståº•å±‚è§„åˆ™ï¼Œæ‰èƒ½å†™å‡ºæ›´å¥½çš„ä»£ç ã€‚","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633652,"discussion_content":"è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702436108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383736,"user_name":"é¸ æ‘©æ™º","can_delete":false,"product_type":"c1","uid":1106201,"ip_address":"æ±Ÿè‹","ucode":"853E584FC4CD64","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/19/c756aaed.jpg","comment_is_top":false,"comment_ctime":1699529489,"is_pvip":true,"replies":[{"id":139955,"content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699591185,"ip_address":"é‡åº†","comment_id":383736,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"    let arr = vec![1,3,3,4];\n    let a = arr[0];\n    println!(&quot;{}&quot;, a);\n    println!(&quot;{:?}&quot;, arr);\nå¯¹äºVec&lt;u32&gt;æ˜¯å¯ä»¥ç”¨v[0]çš„ï¼Œå› ä¸ºu32æ˜¯å¯ä»¥Copyçš„","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631476,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699591185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383628,"user_name":"Marco","can_delete":false,"product_type":"c1","uid":1012627,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"502149B57700FE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/73/93/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1699368030,"is_pvip":false,"replies":[{"id":139814,"content":"å¯ä»¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699412171,"ip_address":"é‡åº†","comment_id":383628,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è€å¸ˆä½ å¥½ã€‚\n&quot;next() æ–¹æ³•&quot;è¿™ä¸€èŠ‚çš„ä¾‹å­ä¹Ÿå¯ä»¥æ”¹ä¸ºå¦‚ä¸‹ç»“æ„å§\n    loop {\n        match an_iter.next() {\n            Some(i) =&gt; println!(&quot;{i}&quot;),\n            None =&gt; break,\n        }\n    }","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631226,"discussion_content":"å¯ä»¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699412172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383551,"user_name":"PEtFiSh","can_delete":false,"product_type":"c1","uid":1765926,"ip_address":"ä¸Šæµ·","ucode":"C4922398A92E05","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLO6XvxfFPMGcVSSX8uIZY2yib29qlyat178pU4QM3gIic5GXZ8PC0tzRiazP3FiajXbTj19SE4ZhV0gQ/132","comment_is_top":false,"comment_ctime":1699260131,"is_pvip":false,"replies":[{"id":139819,"content":"ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699412229,"ip_address":"é‡åº†","comment_id":383551,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"for (k, v) in myhash { &#47;&#47;`myhash` moved due to this implicit call to `.into_iter()`\n    &#47;&#47; todo:\n    &#47;&#47; è¿™é‡Œä¼šè·å¾—vçš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”æ¶ˆè€—æ‰myhash\n}\n\nprintln!(&quot;{:?}&quot;, myhash); &#47;&#47;value borrowed here after move","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631231,"discussion_content":"ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699412229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383541,"user_name":"-","can_delete":false,"product_type":"c1","uid":1546505,"ip_address":"åŒ—äº¬","ucode":"7B34258D346793","user_header":"https://static001.geekbang.org/account/avatar/00/17/99/09/29c46a7b.jpg","comment_is_top":false,"comment_ctime":1699243329,"is_pvip":false,"replies":[{"id":139742,"content":"let a: Vec&lt;u32&gt; = vec![1, 2, 3, 4, 5];","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699256801,"ip_address":"é‡åº†","comment_id":383541,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":" å®šä¹‰äº†ç±»å‹ä»¥åï¼Œlet a: Vec&lt;u32&gt; = [1, 2, 3, 4, 5];è¯­æ³•é”™è¯¯\nä¿®æ”¹ä¸ºlet a= [1, 2, 3, 4, 5];","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631025,"discussion_content":"let a: Vec&lt;u32&gt; = vec![1, 2, 3, 4, 5];","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699256801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389129,"user_name":"Calvin","can_delete":false,"product_type":"c1","uid":1603004,"ip_address":"å¹¿ä¸œ","ucode":"0EEF5B207623B5","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","comment_is_top":false,"comment_ctime":1711633261,"is_pvip":false,"replies":[{"id":141741,"content":"ä½ æŒ‡çš„è¿™ä¸ªå—ï¼Ÿ\nlet line = &quot;1\\n2\\n3\\n4\\n&quot;;\n \nfor num in line.lines() {\nmatch num.parse::&lt;i32&gt;().map(|i| i * 2) {\nOk(n) =&gt; println!(&quot;{n}&quot;),\nErr(..) =&gt; {}\n}\n}\næ’ç‰ˆæœ‰ç‚¹é—®é¢˜ã€‚è¿™ä¸ªErråˆ†æ”¯æ˜¯ parse() æ–¹æ³•æœ‰å¯èƒ½å‡ºé”™ï¼Œè¿”å›ä¸€ä¸ªErrï¼Œåœ¨mapæ—¶ï¼Œç›´æ¥é€ä¼ è¿™ä¸ªErrï¼Œç„¶åå°±åˆ°matché‚£é‡Œäº†ã€‚\n\n_ æ˜¯å ä½ç¬¦ï¼Œæ˜¯å¯ä»¥çš„ã€‚.. ç»å¸¸ç”¨äºæ¯”å¦‚ (x, ..) è¿™ç§ï¼Œå…³æ³¨æŸä¸ªæˆ–å‰é¢æŸå‡ ä¸ªå…ƒç´ ï¼Œè€Œå¿½ç•¥åé¢çš„ã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1713028092,"ip_address":"åŠ æ‹¿å¤§","comment_id":389129,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è¯·æ•™ä¸‹è€å¸ˆï¼Œæ–‡ç« ä¸­â€œä¸è§£åŒ…çš„æƒ…å†µä¸‹å¦‚ä½•æ“ä½œï¼Ÿâ€å°èŠ‚éƒ¨åˆ†è¯´åˆ° Result&lt;T, E&gt; çš„å¸¸ç”¨æ–¹æ³• map() æ—¶ï¼Œé‡Œé¢ç¤ºä¾‹ä»£ç çš„æ¨¡å¼åŒ¹é…çš„ Err(..) åˆ†æ”¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘è¯•äº† Err(_) ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œé€šè¿‡çš„ï¼Œ_ å¿½ç•¥å…ƒç»„æšä¸¾å˜ä½“ Err çš„è´Ÿè½½ï¼Œï¼ˆå’Œ .. ç›¸æ¯”ï¼‰å®ƒä»¬ä¸¤ä¸ªæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåˆ†åˆ«ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å“ªä¸ªå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641822,"discussion_content":"ä½ æŒ‡çš„è¿™ä¸ªå—ï¼Ÿ\nlet line = &#34;1\\n2\\n3\\n4\\n&#34;;\n \nfor num in line.lines() {\nmatch num.parse::&lt;i32&gt;().map(|i| i * 2) {\nOk(n) =&gt; println!(&#34;{n}&#34;),\nErr(..) =&gt; {}\n}\n}\næ’ç‰ˆæœ‰ç‚¹é—®é¢˜ã€‚è¿™ä¸ªErråˆ†æ”¯æ˜¯ parse() æ–¹æ³•æœ‰å¯èƒ½å‡ºé”™ï¼Œè¿”å›ä¸€ä¸ªErrï¼Œåœ¨mapæ—¶ï¼Œç›´æ¥é€ä¼ è¿™ä¸ªErrï¼Œç„¶åå°±åˆ°matché‚£é‡Œäº†ã€‚\n\n_ æ˜¯å ä½ç¬¦ï¼Œæ˜¯å¯ä»¥çš„ã€‚.. ç»å¸¸ç”¨äºæ¯”å¦‚ (x, ..) è¿™ç§ï¼Œå…³æ³¨æŸä¸ªæˆ–å‰é¢æŸå‡ ä¸ªå…ƒç´ ï¼Œè€Œå¿½ç•¥åé¢çš„ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1713028092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŠ æ‹¿å¤§","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386998,"user_name":"wcf","can_delete":false,"product_type":"c1","uid":1829111,"ip_address":"åŒ—äº¬","ucode":"6E3B0A47B963E7","user_header":"https://static001.geekbang.org/account/avatar/00/1b/e8/f7/1b45fa46.jpg","comment_is_top":false,"comment_ctime":1706110001,"is_pvip":false,"replies":[{"id":141266,"content":"ä½ è¿è¡Œä¸€ä¸‹å°±çŸ¥é“æ€ä¹ˆå›äº‹äº†ã€‚ç®€å•çš„è¯´æ˜¯ï¼Œu32ä¸Stringåœ¨å†èµ‹å€¼æ—¶çš„è¡Œä¸ºä¸åŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1708823513,"ip_address":"åŠ æ‹¿å¤§","comment_id":386998,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªå·®å¼‚å‘¢ï¼Ÿä½ å¯ä»¥ä»æˆ‘ä»¬ç¬¬ 2 è®²æ‰€æœ‰æƒç›¸å…³çŸ¥è¯†ä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚\n============\næ²¡çœ‹å‡ºæ¥ä¸ºä»€ä¹ˆ?","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637691,"discussion_content":"ä½ è¿è¡Œä¸€ä¸‹å°±çŸ¥é“æ€ä¹ˆå›äº‹äº†ã€‚ç®€å•çš„è¯´æ˜¯ï¼Œu32ä¸Stringåœ¨å†èµ‹å€¼æ—¶çš„è¡Œä¸ºä¸åŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1708823513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŠ æ‹¿å¤§","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808028,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/96/9c/952d95e7.jpg","nickname":"Jack.ğŸ’¤","note":"","ucode":"E2C2E082D7F269","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647368,"discussion_content":"```which does not implement the `Copy` trait``` è¿™å¥è¯æ˜¯é‡ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719931771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395993,"user_name":"å½“åˆè«ç›¸è¯†","can_delete":false,"product_type":"c1","uid":2768765,"ip_address":"åŒ—äº¬","ucode":"313917BB360D48","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3f/7d/f624fa69.jpg","comment_is_top":false,"comment_ctime":1732622125,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"C++ ç°åœ¨æœ‰Optionï¼Œä½†æ˜¯æ²¡æœ‰Resultï¼Œå¯ä»¥å¦‚ä½•è®¾è®¡è‡ªè¡Œè®¾è®¡ä¸€ä¸ªResultå‘¢","like_count":0},{"had_liked":false,"id":395122,"user_name":"è½æ˜Ÿé‡","can_delete":false,"product_type":"c1","uid":2667148,"ip_address":"åŒ—äº¬","ucode":"EDFD05088A2026","user_header":"https://static001.geekbang.org/account/avatar/00/28/b2/8c/77d4d9bf.jpg","comment_is_top":false,"comment_ctime":1729499876,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"ä¸Šé¢å¯¹Goè¯­è¨€è¿”å›å€¼çš„è¯´æ³•æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼ŒGoè¯­è¨€ä¸é™åˆ¶è¿”å›å€¼çš„æ•°é‡ä¸ç±»å‹ï¼Œæœ€åä¸€ä¸ªè¿”å›çš„ err åªæ˜¯ä¸€ç§ç¼–ç ä¹ æƒ¯ï¼Œä¸€èˆ¬ç”¨äºè¿”å›å®ç°äº† Error æ¥å£çš„å®ä¾‹ï¼Œäº¦å³åªè¦å®ç°äº† error.Error() æ–¹æ³•çš„å®ä¾‹è¿”å›éƒ½çš†å¯ã€‚å¦‚æœç”¨æˆ·ä¸ºäº†ç®€ä¾¿èµ·è§ï¼Œåœ¨æœ€åè¿”å›stringç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œåˆ™è¿”å›çš„ err å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚","like_count":0},{"had_liked":false,"id":393280,"user_name":"Geek_93cb91","can_delete":false,"product_type":"c1","uid":3944492,"ip_address":"ä¸Šæµ·","ucode":"C2A77CCBA6E193","user_header":"","comment_is_top":false,"comment_ctime":1723361787,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"ä¹°è¿‡å¥½å‡ æœ¬ä¹¦äº†&#xff0c;åå¤å…¥é—¨å†å…¥é—¨&#xff0c;æ„Ÿè§‰å”è€å¸ˆçš„å†…å®¹æ¯”ä¹¦å…¨é¢å¤šäº†&#xff0c;å†å…¥é—¨ä¸€é&#xff0c;æœ€åä¸€é&#xff01;","like_count":0},{"had_liked":false,"id":390705,"user_name":"wbytts","can_delete":false,"product_type":"c1","uid":1233036,"ip_address":"æ±Ÿè‹","ucode":"0341E00F80FFF5","user_header":"https://static001.geekbang.org/account/avatar/00/12/d0/8c/71ed37f8.jpg","comment_is_top":false,"comment_ctime":1716056028,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"unwrap_or_default çš„é…å›¾ï¼ŒResulté‚£ä¸€åˆ—å†™é”™æ–‡å­—äº†","like_count":0},{"had_liked":false,"id":390618,"user_name":"Massdama","can_delete":false,"product_type":"c1","uid":3887120,"ip_address":"ç¾å›½","ucode":"A04628AADD4E8E","user_header":"https://static001.geekbang.org/account/avatar/00/3b/50/10/c57c7389.jpg","comment_is_top":false,"comment_ctime":1715779134,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"æŒæœ‰ä½¿ç”¨æƒçš„æ•°æ®éœ€è¦æ‰€æœ‰æ—¶è¦è€ƒè™‘å€Ÿ ä¹Ÿå°±æ˜¯å¼•ç”¨","like_count":0},{"had_liked":false,"id":390137,"user_name":"ç‹¬é’“å¯’æ±Ÿ","can_delete":false,"product_type":"c1","uid":1203049,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"2C81906FD88C8C","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/69/7ace1ddb.jpg","comment_is_top":false,"comment_ctime":1714450168,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"ç¬¬ä¸‰æ¬¡åˆ·åŸºç¡€ç¯‡ï¼Œä¹‹å‰ä¸çŸ¥é“Some(T)æ˜¯ä»€ä¹ˆï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸çŸ¥é“Someæ˜¯ä»€ä¹ˆç±»å‹ï¼Œå› ä¸ºæšä¸¾å†…å¯ä»¥åŒ…å«å¤šç§ç±»å‹ï¼Œé‚£ä¹ˆSomeæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿçœ‹å¾—å¥½æ‡µï¼Œå¿ƒé‡Œæ…Œå¾—ä¸€æ‰¹ã€‚è¿™æ¬¡æœç´¢äº†ä¸€ä¸‹ï¼Œå¤§å¤šåªæ˜¯è¯´Someæ˜¯Optionç±»å‹ï¼Œåªçœ‹åˆ°Rust By Exampleé‡Œè¯´äº†ä¸€å¥Some(value)æ˜¯å…ƒç»„ç»“æ„ä½“ï¼Œå™¢ï¼Œ ç»ˆäºæ²¡é‚£ä¹ˆæ‡µäº†","like_count":0},{"had_liked":false,"id":389670,"user_name":"ç‹¬é’“å¯’æ±Ÿ","can_delete":false,"product_type":"c1","uid":1203049,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"2C81906FD88C8C","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/69/7ace1ddb.jpg","comment_is_top":false,"comment_ctime":1713236177,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"å¯ä»¥å…·ä½“å±•å¼€è§£é‡Šä¸€ä¸‹â€œlet maybe_some_len = maybe_some_string.map(|s| s.len());â€ é‡Œé¢çš„ â€œmap(|s| s.len())â€ å—ï¼ŸçŒœ|s|æ˜¯é—­åŒ…ï¼Œsæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ self ï¼ŸçŒœs.len()æ˜¯è·å–é•¿åº¦ï¼Œ ä½†|s| s.len() åˆèµ·æ¥å†™å°±çœ‹æ‡µäº†ã€‚","like_count":0,"discussions":[{"author":{"id":1203049,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5b/69/7ace1ddb.jpg","nickname":"ç‹¬é’“å¯’æ±Ÿ","note":"","ucode":"2C81906FD88C8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":642124,"discussion_content":"å†æŸ¥äº†ä¸€ä¸‹ï¼ŒåŸæ¥|s| s.len() åˆèµ·æ¥æ‰æ˜¯é—­åŒ…ï¼Œä¸äº†è§£ï¼Œéœ€è¦è¡¥å……çš„çŸ¥è¯†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1713331425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸­å›½é¦™æ¸¯","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385392,"user_name":"superggn","can_delete":false,"product_type":"c1","uid":3623568,"ip_address":"åŒ—äº¬","ucode":"831CCD98B393FE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/7Q403U68Oy4lXG5sFBPVKLrfwaRzBqpBZibpEBXcPf9UOO3qrnh7RELoByTLzBZLkN9Nukfsj7DibynbZjKAKgag/132","comment_is_top":false,"comment_ctime":1702552060,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100626901,"comment_content":"æ€è€ƒé¢˜ï¼š ç”¨ entry\nuse std::collections::hash_map::Entry;\nmatch some_hashmap.entry(key) {\n    Entry::Occupied(value) =&gt; ...\n    Entry::Vacant(vacant entry) =&gt; ...\n}\n\nå…·ä½“ç±»å‹åº”è¯¥æœ‰ç‚¹å¯¹ä¸ä¸Šï¼Œ å›å¤´çœ‹çœ‹æ–‡æ¡£çš„","like_count":0}]}