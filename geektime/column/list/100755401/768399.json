{"id":768399,"title":"20ï½œä½¿ç”¨ LLM æŒ‰ç…§æµ‹è¯•ç­–ç•¥ç”Ÿæˆä»£ç ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ˜Šï¼Œä»Šå¤©æˆ‘ä»¬æ¥ç»§ç»­å­¦ä¹ AIæ—¶ä»£çš„è½¯ä»¶å·¥ç¨‹ã€‚</p><p>ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬è®²è§£äº†å¦‚ä½•åˆ©ç”¨æ¶æ„åˆ’åˆ†åŠŸèƒ½ä¸Šä¸‹æ–‡ï¼Œä»¥åŠå¦‚ä½•ä¸ºä¸åŒçš„æ¶æ„ç»„ä»¶ï¼Œé€‰æ‹©æ°å½“çš„æµ‹è¯•æ›¿èº«æŠ€æœ¯ï¼ˆTest Doubleï¼‰ï¼Œä»è€Œæ„é€ æ°å½“çš„æµ‹è¯•ç­–ç•¥ã€‚</p><p>é‚£ä¹ˆæ„å»ºäº†æµ‹è¯•ç­–ç•¥ä¹‹åï¼Œå¯¹äºæˆ‘ä»¬ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLarge Language Modelï¼‰ç”Ÿæˆä»£ç æœ‰ä»€ä¹ˆå¸®åŠ©å‘¢ï¼Ÿé‚£ä¹ˆä»Šå¤©å°±è®©æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ã€‚</p><h2>æŒ‰ç…§æµ‹è¯•ç­–ç•¥æ„é€ æç¤ºè¯æ¨¡æ¿</h2><p>æˆ‘ä»¬ä»ç„¶ä½¿ç”¨ä¸ŠèŠ‚è¯¾çš„ä¾‹å­ï¼Œåœ¨ä¸ŠèŠ‚è¯¾çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬æœ€åå¾—åˆ°çš„æµ‹è¯•ç­–ç•¥æ˜¯è¿™æ ·çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/bc/9a/bca7e85d866338a5bea5f974b3b1129a.jpg?wh=1920x1054\" alt=\"\"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†æ¶æ„ä¸­çš„ä¸‰ç§ä¸åŒçš„ç»„ä»¶åˆ†åˆ«è¿›è¡Œæµ‹è¯•ï¼Œå…¶ä¸­Persistentå±‚ä¸­çš„ç»„ä»¶ï¼Œä½¿ç”¨å‡å¯¹è±¡ï¼ˆFakeï¼Œå†…å­˜æ•°æ®åº“ï¼‰ä½œä¸ºæµ‹è¯•æ›¿èº«ã€‚è€ŒHTTP interfaceå’ŒApplication Logicå±‚åˆ™é€šè¿‡å­˜æ ¹ï¼ˆStubï¼‰ä½œä¸ºæµ‹è¯•æ›¿èº«ã€‚æœ€åï¼Œå†é€šè¿‡åŠŸèƒ½æµ‹è¯•ï¼Œå¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡ŒéªŒè¯ã€‚</p><p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬æŒ‰ç…§æµ‹è¯•ç­–ç•¥ï¼Œé’ˆå¯¹ä¸åŒçš„ç»„ä»¶æ„é€ æç¤ºè¯æ¨¡æ¿ï¼ˆPrompting templateï¼‰ã€‚æˆ‘ä»¬å…ˆä»Persistentå±‚å¼€å§‹ï¼š</p><blockquote>\n<p>æ¶æ„æè¿°<br>\n=======<br>\nå½“å‰ç³»ç»ŸæŠ€æœ¯æ ˆä¸ºSpring Bootï¼ŒJerseyå’ŒMyBatisã€‚<br>\n&nbsp;<br>\nå½“å‰ç³»ç»Ÿé‡‡ç”¨å…¸å‹çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œåˆ†å¸ƒä¸º:<br>\n- HTTP interfaceå±‚ï¼Œè´Ÿè´£æä¾›RESTful APIï¼Œå‘½åè§„åˆ™ä¸ºXXXAPIï¼Œæ¯”å¦‚OrdersAPIï¼›<br>\nâ€“ Application Logicå±‚ï¼Œè´Ÿè´£æä¾›æ ¸å¿ƒé€»è¾‘ï¼Œå‘½åè§„åˆ™ä¸ºXXXServiceï¼Œæ¯”å¦‚OrderServiceï¼›<br>\nâ€“ Persistentå±‚ï¼Œè´Ÿè´£ä¸æŒä¹…åŒ–æ•°æ®äº¤äº’ï¼Œå‘½åè§„åˆ™ä¸ºXXXDAOï¼Œæ¯”å¦‚OrderDAOï¼›<br>\nâ€“ DAOé€šè¿‡MyBatisçš„Mapperå®ç°<br>\nâ€“ åœ¨å¯¹DAOè¿›è¡Œæµ‹è¯•æ—¶ï¼Œä½¿ç”¨H2æ•°æ®åº“ä½œä¸ºfake implementationï¼Œä¹Ÿå°±æ˜¯åœ¨æµ‹è¯•ä¸­ï¼Œåˆå§‹åŒ–H2æ•°æ®åº“ï¼Œç„¶åä¿è¯åº”ç”¨ç¨‹åºé“¾æ¥åˆ°è¿™ä¸ªæ•°æ®åº“ï¼Œå¹¶åœ¨æµ‹è¯•ç»“æŸåé”€æ¯è¿™ä¸ªæ•°æ®åº“ã€‚<br>\n&nbsp;<br>\nåŠŸèƒ½éœ€æ±‚<br>\n=======<br>\n{functionalities}<br>\n&nbsp;<br>\nä»»åŠ¡<br>\n====<br>\nä¸Šé¢åŠŸèƒ½éœ€æ±‚æè¿°çš„åœºæ™¯ï¼Œåœ¨Persistentå±‚ä¸­éœ€è¦å“ªäº›ç»„ä»¶ï¼ˆç›®æ ‡ç»„ä»¶ï¼‰ï¼›<br>\nåˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°ç›®æ ‡ç»„ä»¶çš„åŠŸèƒ½ï¼ˆç›®æ ‡åŠŸèƒ½ï¼‰ï¼›<br>\nåˆ—å‡ºç›®æ ‡åŠŸèƒ½éœ€è¦æµ‹è¯•çš„åœºæ™¯ã€‚æè¿°åœºæ™¯ï¼Œå¹¶ç»™å‡ºç›¸å…³çš„æµ‹è¯•æ•°æ®ã€‚</p>\n</blockquote><!-- [[[read_end]]] --><p>æ³¨æ„åœ¨è¿™ä¸ªæç¤ºè¯æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥è¦æ±‚LLMå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä»£ç ï¼Œè¿˜æ˜¯ä¸ä¹‹å‰ä¸€æ ·ï¼Œå…ˆè®©LLMç»™å‡ºåœºæ™¯å’Œæµ‹è¯•æ•°æ®ã€‚ChatGPTçš„ç­”æ¡ˆå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/26/c5/26ca0258d837ab21e0e1d93687dffac5.jpg?wh=1558x1507\" alt=\"\"><br>\nåœ¨è¿™ä¸ªæç¤ºè¯æ¨¡æ¿ä¸­ï¼Œä½¿ç”¨äº†å¦ä¸€ä¸ªæˆ‘å‘æ˜çš„å°æŠ€å·§ï¼Œå«<strong>ä»£è¯æ¶ˆé™¤ï¼Œ</strong>å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸­å»é™¤éšå«çš„æ­§ä¹‰ã€‚é€šè¿‡ç›®æ ‡ç»„ä»¶å’Œç›®æ ‡åŠŸèƒ½çš„æ˜ç¡®æŒ‡ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿LLMåœ¨åç»­äº¤äº’ä¸­ä¿æŒä¸Šä¸‹æ–‡è¿è´¯ã€‚</p><p>éšåï¼Œæˆ‘ä»¬å°±å¯ä»¥è¦æ±‚LLMå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆæµ‹è¯•ä»£ç ï¼š</p><blockquote>\n<p>è¯·æŒ‰ç…§æŒ‡å®šæŠ€æœ¯æ ˆï¼Œä¸ºç›®æ ‡åŠŸèƒ½åœºæ™¯æä¾›æµ‹è¯•ä»£ç </p>\n</blockquote><p>LLMç»™å‡ºçš„ç»“æœæ˜¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/ed/c13f524d4a4a579e0a84431b5e28f1ed.jpg?wh=1900x343\" alt=\"\"></p><pre><code class=\"language-plain\">import static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assertions.assertTrue;\nimport java.sql.Connection;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport java.util.List;\nimport javax.sql.DataSource;\nimport org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.mybatis.spring.boot.test.autoconfigure.MybatisTest;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.TestPropertySource;\n\n\n\n@SpringBootTest\n@MybatisTest\n@TestPropertySource(locations = \"classpath:application-test.properties\") // ä½¿ç”¨æµ‹è¯•é…ç½®æ–‡ä»¶\npublic class ProductDAOTest {\n\n  @Autowired\n  private DataSource dataSource;\n  \n  @Autowired\n  private ProductDAO productDAO;\n  private Connection connection;\n  \n  @BeforeEach\n  public void setUp() throws SQLException {\n    // è·å–H2æ•°æ®åº“è¿æ¥\n    connection = dataSource.getConnection();\n    // åˆ›å»ºæµ‹è¯•è¡¨\n    try (Statement statement = connection.createStatement()) {\n      statement.executeUpdate(\"CREATE TABLE Product (product_id INT PRIMARY KEY, name VARCHAR(255), description VARCHAR(255), price DECIMAL(10,2))\");\n      // æ’å…¥æµ‹è¯•æ•°æ®\n      statement.executeUpdate(\"INSERT INTO Product (product_id, name, description, price) VALUES (1, 'Product 1', 'Description of Product 1', 19.99)\");\n      statement.executeUpdate(\"INSERT INTO Product (product_id, name, description, price) VALUES (2, 'Product 2', 'Description of Product 2', 29.99)\");\n      statement.executeUpdate(\"INSERT INTO Product (product_id, name, description, price) VALUES (3, 'Product 3', 'Description of Product 3', 39.99)\");\n    }\n  }\n  \n  @Test\n  public void testGetAllProducts() {\n    // è°ƒç”¨è¢«æµ‹è¯•çš„æ–¹æ³•\n    List&lt;Product&gt; products = productDAO.getAllProducts();\n    // éªŒè¯ç»“æœ\n    assertEquals(3, products.size());\n    assertTrue(products.stream().anyMatch(p -&gt; p.getProductId() == 1 &amp;&amp; p.getName().equals(\"Product 1\")));\n    assertTrue(products.stream().anyMatch(p -&gt; p.getProductId() == 2 &amp;&amp; p.getName().equals(\"Product 2\")));\n    assertTrue(products.stream().anyMatch(p -&gt; p.getProductId() == 3 &amp;&amp; p.getName().equals(\"Product 3\")));\n  }\n  \n  @AfterEach\n  public void tearDown() throws SQLException {\n    // åˆ é™¤æµ‹è¯•è¡¨å¹¶å…³é—­è¿æ¥\n    try (Statement statement = connection.createStatement()) {\n      statement.executeUpdate(\"DROP TABLE IF EXISTS Product\");\n    }\n    if (connection != null) {\n      connection.close();\n    }\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/5e/10/5eda253f8d2e914134c76d90214d7410.jpg?wh=1568x899\" alt=\"\"></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥è¦æ±‚LLMç»™å‡ºapplication-test.propertiesçš„å…·ä½“é…ç½®ï¼Œä¹Ÿå¯ä»¥è®©LLMå¸®åŠ©æˆ‘ä»¬è¡¥å…¨ä¸€äº›å…¶ä»–çš„ç»†èŠ‚ã€‚ç°åœ¨ä¹Ÿå¯ä»¥ç›´æ¥è®©LLMå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä»£ç ã€‚</p><blockquote>\n<p>è¯·ç»™å‡ºProductDAOçš„å®ç°</p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/1c/e4/1c281a71613deaa13b460fd08de346e4.jpg?wh=1920x1977\" alt=\"\"></p><p>å¯¹äºç°åœ¨è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¿™ä¸ªä»£ç ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥è¡¥å……æç¤ºè¯æ¨¡æ¿ä¸­å…³äºHTTP Interfaceéƒ¨åˆ†çš„æ¶æ„æè¿°ï¼Œå¹¶æ›´æ”¹ä»»åŠ¡æè¿°ï¼š</p><blockquote>\n<p>æ¶æ„æè¿°<br>\n=======<br>\nå½“å‰ç³»ç»ŸæŠ€æœ¯æ ˆä¸ºSpring Bootï¼ŒJerseyå’ŒMyBatisã€‚<br>\n&nbsp;<br>\nå½“å‰ç³»ç»Ÿé‡‡ç”¨å…¸å‹çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œåˆ†å¸ƒä¸º:<br>\n- HTTP interfaceå±‚ï¼Œè´Ÿè´£æä¾›RESTful APIï¼Œå‘½åè§„åˆ™ä¸ºXXXAPIï¼Œæ¯”å¦‚OrdersAPIï¼›<br>\n- APIé€šè¿‡JAX-RSçš„Resourceå®ç°<br>\n- åœ¨å¯¹APIè¿›è¡Œæµ‹è¯•æ—¶ï¼Œé¦–å…ˆè¦stubæ‰Application Logicå±‚ä¸­çš„Servicesï¼Œç„¶åå†ä½¿ç”¨JerseyTestå¯¹APIè¿›è¡Œæµ‹è¯•<br>\n&nbsp;<br>\n-  Application Logicå±‚ï¼Œè´Ÿè´£æä¾›æ ¸å¿ƒé€»è¾‘ï¼Œå‘½åè§„åˆ™ä¸ºXXXServiceï¼Œæ¯”å¦‚OrderServiceï¼›<br>\n- Persistentå±‚ï¼Œè´Ÿè´£ä¸æŒä¹…åŒ–æ•°æ®äº¤äº’ï¼Œå‘½åè§„åˆ™ä¸ºXXXDAOï¼Œæ¯”å¦‚OrderDAOï¼›<br>\n-  DAOé€šè¿‡MyBatisçš„Mapperå®ç°<br>\n- åœ¨å¯¹DAOè¿›è¡Œæµ‹è¯•æ—¶ï¼Œä½¿ç”¨H2æ•°æ®åº“ä½œä¸ºfake implementationï¼Œä¹Ÿå°±æ˜¯åœ¨æµ‹è¯•ä¸­ï¼Œåˆå§‹åŒ–H2æ•°æ®åº“ï¼Œç„¶åä¿è¯åº”ç”¨ç¨‹åºé“¾æ¥åˆ°è¿™ä¸ªæ•°æ®åº“ï¼Œå¹¶åœ¨æµ‹è¯•ç»“æŸåé”€æ¯è¿™ä¸ªæ•°æ®åº“ã€‚<br>\n&nbsp;<br>\nåŠŸèƒ½éœ€æ±‚<br>\n=======<br>\n{functionalities}<br>\n&nbsp;<br>\nä»»åŠ¡<br>\n====<br>\nä¸Šé¢åŠŸèƒ½éœ€æ±‚æè¿°çš„åœºæ™¯ï¼Œåœ¨HTTP Interfaceå±‚ä¸­éœ€è¦å“ªäº›ç»„ä»¶ï¼ˆç›®æ ‡ç»„ä»¶ï¼‰ï¼›<br>\nåˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°ç›®æ ‡ç»„ä»¶çš„åŠŸèƒ½ï¼ˆç›®æ ‡åŠŸèƒ½ï¼‰ï¼›<br>\nåˆ—å‡ºç›®æ ‡åŠŸèƒ½éœ€è¦æµ‹è¯•çš„åœºæ™¯ã€‚æè¿°åœºæ™¯ï¼Œå¹¶ç»™å‡ºç›¸å…³çš„æµ‹è¯•æ•°æ®ã€‚</p>\n</blockquote><p>ChatGPTçš„ç­”æ¡ˆå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/32/1a4b9yydeda811ebb5a2067504ccbb32.jpg?wh=2040x3230\" alt=\"\"></p><blockquote>\n<p>è¯·æŒ‰ç…§æŒ‡å®šæŠ€æœ¯æ ˆï¼Œä¸ºç›®æ ‡åŠŸèƒ½åœºæ™¯æä¾›æµ‹è¯•ä»£ç </p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/14/96/14307a022d4497709246bca613aba596.jpg?wh=2020x340\" alt=\"\"></p><pre><code class=\"language-plain\">import static org.junit.Assert.assertEquals;\nimport static org.junit.Assert.assertNotNull;\nimport java.util.List;\nimport javax.ws.rs.client.Entity;\nimport javax.ws.rs.client.Invocation;\nimport javax.ws.rs.core.Application;\nimport javax.ws.rs.core.GenericType;\nimport javax.ws.rs.core.Response;\nimport org.glassfish.jersey.server.ResourceConfig;\nimport org.glassfish.jersey.test.JerseyTest;\nimport org.junit.Test;\n\npublic class OrdersAPITest extends JerseyTest {\n\n  @Override\n  protected Application configure() {\n    return new ResourceConfig(OrdersAPI.class);\n  }\n  \n  @Test\n  public void testGetAllProducts() {\n    // å‘é€GETè¯·æ±‚åˆ°/productsç«¯ç‚¹\n    Response response = target(\"/products\").request().get();\n    // ç¡®ä¿å“åº”çŠ¶æ€ç ä¸º200\n    assertEquals(Response.Status.OK.getStatusCode(), response.getStatus());\n    // ä»å“åº”ä¸­è·å–äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;Product&gt; productList = response.readEntity(new GenericType&lt;List&lt;Product&gt;&gt;() {});\n    // ç¡®ä¿äº§å“ç›®å½•åˆ—è¡¨ä¸ä¸ºç©º\n    assertNotNull(productList);\n    // æ£€æŸ¥ç¬¬ä¸€ä¸ªäº§å“çš„ä¿¡æ¯\n    Product firstProduct = productList.get(0);\n    assertEquals(1, firstProduct.getId());\n    assertEquals(\"Product 1\", firstProduct.getName());\n    assertEquals(\"Description of Product 1\", firstProduct.getDescription());\n    assertEquals(10.99, firstProduct.getPrice(), 0.001);\n    // å¯ä»¥ç»§ç»­æ£€æŸ¥å…¶ä»–äº§å“ä¿¡æ¯...\n  }\n}\n\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/96/89/96ecae0a2c69cff4a7b32df225eae389.jpg?wh=1531x854\" alt=\"\"></p><p>è¿˜å‰©ä¸‹ä¸€ä¸ªApplication Logicå±‚ï¼Œåšæ³•å¤§åŒå°å¼‚ï¼Œæˆ‘ç»™ä½ ç•™ä½œè¯¾åä½œä¸šè‡ªè¡Œç»ƒä¹ ã€‚</p><h2>ä½¿ç”¨LLMæ„é€ åŠŸèƒ½æµ‹è¯•</h2><p>æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„æµ‹è¯•ç­–ç•¥ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨LLMå®Œæˆäº†ä¸‰ä¸ªQ1è±¡é™çš„æµ‹è¯•ã€‚åœ¨æµ‹è¯•ç­–ç•¥ä¸­ï¼Œé™¤å»Q1è±¡é™ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰Q2è±¡é™çš„åŠŸèƒ½æµ‹è¯•ã€‚ç°åœ¨æ¥æ„é€ æç¤ºè¯æ¨¡æ¿ï¼Œå®Œæˆè¿™ä¸ªQ2çš„æµ‹è¯•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†æµ‹è¯•çš„å¯é‡å¤æ€§ï¼Œæˆ‘ä»¬ä¼šåœ¨åŠŸèƒ½æµ‹è¯•ä¸­ï¼Œå®Œæˆæµ‹è¯•æ•°æ®çš„çŒå…¥ã€‚</p><p>é¦–å…ˆç»™å‡ºä»»åŠ¡æè¿°ï¼š</p><blockquote>\n<p>æ¶æ„æè¿°<br>\n=======<br>\nå½“å‰ç³»ç»Ÿé‡‡ç”¨å…¸å‹çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œåˆ†å¸ƒä¸º:<br>\nHTTP interfaceå±‚ï¼Œè´Ÿè´£æä¾›RESTful APIï¼Œå‘½åè§„åˆ™ä¸ºXXXAPIï¼Œæ¯”å¦‚OrdersAPIï¼›<br>\nApplication Logicå±‚ï¼Œè´Ÿè´£æä¾›æ ¸å¿ƒé€»è¾‘ï¼Œå‘½åè§„åˆ™ä¸ºXXXServiceï¼Œæ¯”å¦‚OrderServiceï¼›<br>\nPersistentå±‚ï¼Œè´Ÿè´£ä¸æŒä¹…åŒ–æ•°æ®äº¤äº’ï¼Œå‘½åè§„åˆ™ä¸ºXXXDAOï¼Œæ¯”å¦‚OrderDAOï¼›<br>\n&nbsp;<br>\nå½“å‰ç³»ç»ŸæŠ€æœ¯æ ˆä¸ºSpring Bootã€Jerseryå’ŒMyBatis<br>\n&nbsp;<br>\nå½“ä¸ºå½“å‰ç³»ç»Ÿç”ŸæˆåŠŸèƒ½æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨Http Clienté€šè¿‡è®¿é—®APIå®ŒæˆçœŸæ­£çš„æµ‹è¯•ã€‚ä½†æ˜¯ä¸ºäº†ä¿è¯æµ‹è¯•çš„å¯é‡å¤æ€§ï¼Œæˆ‘ä»¬åœ¨setupæµ‹è¯•çš„æ—¶å€™ï¼Œé“¾æ¥æ•°æ®åº“ï¼Œå®Œæˆæµ‹è¯•æ•°æ®çš„å‡†å¤‡ã€‚æµ‹è¯•æ—¶ï¼Œä½¿ç”¨MySQLæ•°æ®åº“ã€‚<br>\n&nbsp;<br>\nåŠŸèƒ½éœ€æ±‚<br>\n=======<br>\nç›®å‰ä¸ºä¸€ä¸ªç”µå­å•†åŠ¡ç³»ç»Ÿã€‚éœ€è¦åˆ—å‡ºæ‰€æœ‰äº§å“çš„ç›®å½•<br>\n&nbsp;<br>\nä»»åŠ¡<br>\n====<br>\nä¸Šé¢åŠŸèƒ½éœ€æ±‚æè¿°çš„åœºæ™¯ï¼Œéœ€è¦ç”¨åˆ°å“ªäº›APIï¼ˆç›®æ ‡APIï¼‰ï¼›<br>\nåˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°ç›®æ ‡APIçš„åŠŸèƒ½ï¼ˆç›®æ ‡åŠŸèƒ½ï¼‰ï¼›<br>\nåˆ—å‡ºç›®æ ‡åŠŸèƒ½éœ€è¦æµ‹è¯•çš„åœºæ™¯ã€‚æè¿°åœºæ™¯ï¼Œå¹¶ç»™å‡ºç›¸å…³çš„æµ‹è¯•æ•°æ®ã€‚</p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/81/96/81c5834f92yy5f86c1dfda4b31108a96.jpg?wh=2020x4841\" alt=\"\"></p><p>æ¥ç€è¦æ±‚GPTæä¾›æµ‹è¯•ï¼Œè¿”å›ç»“æœå¦‚ä¸‹ã€‚</p><blockquote>\n<p>è¯·ä¸ºç›®æ ‡åŠŸèƒ½æµ‹è¯•åœºæ™¯æä¾›æµ‹è¯•</p>\n</blockquote><p><img src=\"https://static001.geekbang.org/resource/image/f4/7a/f4987c62ef310af18e4cb6e724e5b77a.jpg?wh=2020x1645\" alt=\"\"></p><pre><code class=\"language-plain\">import org.junit.jupiter.api.AfterEach;\nimport org.junit.jupiter.api.BeforeEach;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.boot.web.server.LocalServerPort;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.client.RestTemplate;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport static org.junit.jupiter.api.Assertions.assertEquals;\n\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\npublic class ProductAPITest {\n  @LocalServerPort\n  private int port;\n  \n  @Autowired\n  private RestTemplate restTemplate;\n  \n  private Connection connection;\n\n  @BeforeEach\n  public void setUp() throws SQLException {\n    // è¿æ¥æµ‹è¯•ç”¨MySQLæ•°æ®åº“ï¼Œå‡†å¤‡æµ‹è¯•æ•°æ®\n    connection = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/test_db\", \"username\", \"password\");\n    Statement statement = connection.createStatement();\n    statement.executeUpdate(\"INSERT INTO products (product_id, product_name, category) VALUES (1, 'Laptop', 'Electronics')\");\n    statement.executeUpdate(\"INSERT INTO products (product_id, product_name, category) VALUES (2, 'Smartphone', 'Electronics')\");\n    statement.executeUpdate(\"INSERT INTO products (product_id, product_name, category) VALUES (3, 'Bookshelf', 'Furniture')\");\n    statement.executeUpdate(\"INSERT INTO products (product_id, product_name, category) VALUES (4, 'Office Chair', 'Furniture')\");\n    statement.executeUpdate(\"INSERT INTO products (product_id, product_name, category) VALUES (5, 'T-shirt', 'Clothing')\");\n  }\n  \n  @AfterEach\n  public void tearDown() throws SQLException {\n    // æ¸…é™¤æµ‹è¯•æ•°æ®åº“ä¸­çš„æ•°æ®\n    Statement statement = connection.createStatement();\n    statement.executeUpdate(\"DELETE FROM products\");\n    connection.close();\n  }\n  \n  @Test\n  public void testListAllProducts() {\n    // å‘é€GETè¯·æ±‚åˆ°APIç«¯ç‚¹\n    ResponseEntity&lt;String&gt; responseEntity = restTemplate.getForEntity(\"http://localhost:\" + port + \"/products\", String.class);\n    // éªŒè¯å“åº”çŠ¶æ€ç ä¸º200\n    assertEquals(HttpStatus.OK, responseEntity.getStatusCode());\n    // éªŒè¯å“åº”å†…å®¹æ˜¯å¦ç¬¦åˆé¢„æœŸ\n    String expectedResponseBody = \"[{\\\"productId\\\":1,\\\"productName\\\":\\\"Laptop\\\",\\\"category\\\":\\\"Electronics\\\"},\" +\n        \"{\\\"productId\\\":2,\\\"productName\\\":\\\"Smartphone\\\",\\\"category\\\":\\\"Electronics\\\"},\" +\n        \"{\\\"productId\\\":3,\\\"productName\\\":\\\"Bookshelf\\\",\\\"category\\\":\\\"Furniture\\\"},\" +\n        \"{\\\"productId\\\":4,\\\"productName\\\":\\\"Office Chair\\\",\\\"category\\\":\\\"Furniture\\\"},\" +\n        \"{\\\"productId\\\":5,\\\"productName\\\":\\\"T-shirt\\\",\\\"category\\\":\\\"Clothing\\\"}]\";\n    assertEquals(expectedResponseBody, responseEntity.getBody());\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/fa/d0/fae21bd4393191ea5e3b8bbfebbe8ed0.jpg?wh=2020x616\" alt=\"\"></p><h2>å°ç»“</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æŒ‰ç…§æµ‹è¯•ç­–ç•¥çš„æŒ‡å¯¼ï¼Œéµå¾ªå‰é¢è®²è¿‡çš„æµ‹è¯•é©±åŠ¨å¼€å‘çš„èŠ‚å¥ï¼Œå®Œæˆäº†ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ã€‚é‚£ä¹ˆè¿™ä¹ˆåšæœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿæœ€æ˜¾è€Œæ˜“è§çš„ç”¨å¤„æ˜¯ï¼Œ<strong>é’ˆå¯¹å­˜é‡ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç”±æµ‹è¯•ç­–ç•¥åˆ‡å…¥ï¼Œè®©LLMç”Ÿæˆç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„ä»£ç </strong>ã€‚</p><p>æ‰€è°“å­˜é‡ç³»ç»Ÿï¼Œå°±æ˜¯æŒ‡ä¸æ˜¯å…¨éƒ¨ç”±LLM/AIä¸»å¯¼ç”Ÿæˆçš„ä»£ç åº“ã€‚åœ¨è¿™æ ·çš„ä»£ç åº“ä¸­ï¼Œç»„ç»‡ç»“æ„å·²ç»å­˜åœ¨ï¼ŒLLMç”Ÿæˆçš„ä»£ç éœ€è¦ç¬¦åˆæ—¢å®šçš„ç»“æ„ï¼Œæ‰èƒ½è¢«å¼•å…¥ä»£ç åº“ä¸­ã€‚</p><p>é‚£ä¹ˆé€šè¿‡è¿™èŠ‚è¯¾æˆ‘ä»¬æ‰€ä»‹ç»çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»ä½•ä»£ç åº“ä¸­ï¼Œéšæ—¶å¼•å…¥LLMçš„è¾…åŠ©äº†ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯·å®ŒæˆApplication Layerçš„æ¶æ„è¯´æ˜ï¼Œå¹¶ä½¿ç”¨LLMå®Œæˆä»£ç ç”Ÿæˆã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æƒ³æ³•ï¼Œæˆ‘ä¼šè®©ç¼–è¾‘ç½®é¡¶ä¸€äº›ä¼˜è´¨å›ç­”ä¾›å¤§å®¶å­¦ä¹ è®¨è®ºã€‚</p>","comments":[{"had_liked":false,"id":389900,"user_name":"èŒƒé£æ‰¬","can_delete":false,"product_type":"c1","uid":2721761,"ip_address":"å¹¿ä¸œ","ucode":"A665DF46833A81","user_header":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","comment_is_top":false,"comment_ctime":1713836449,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"åŒå­¦é—®ï¼šè‡ªå·±è®¾è®¡Q1çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæœ‰å…¸å‹ç”¨æ³•ã€è¾¹ç•Œå€¼ã€å¯¹è±¡çŠ¶æ€ã€è€—æ—¶æ€§èƒ½ã€å¹¶å‘æƒ…å†µã€è¯¯ç”¨æƒ…å†µã€åå¤è°ƒç”¨ç­‰æ–¹é¢çš„è€ƒè™‘ï¼Œè¿™äº›åœ¨ç›®å‰çš„ç¤ºä¾‹é‡Œæ²¡ä½“ç°ï¼Œæ˜¯å¦æœ‰å¿…è¦è€ƒè™‘ï¼Œåœ¨å“ªä¸ªæ­¥éª¤åšåˆé€‚ï¼Ÿ\n\n===\næˆ‘ç†è§£ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®æ˜¯ï¼ŒHow many tests should you write? \nè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚\n\næˆ‘ä¹‹å‰æœ‰ä¸ª Kent Beck çš„ã€ŠTDD by exampleã€‹çš„è¯»ä¹¦ç¬”è®°ï¼Œå¯ä»¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼š\n\nHow many tests should you write? \n\nFor simple problem of triangle, Kent wrote six tests, Bob Binder wrote 65.\n\nThink about MTBF, if you want the MTBF to be 10 years, you should write more tests.\n\nï¼ˆä¸‹é¢æ˜¯åŸæ–‡äº†ï¼‰\nTDDâ€™s view of testing is pragmatic. In TDD, the tests are a means to have great conï¬dence. If our knowledge of the implementation gives us conï¬dence even without a test, then we will not write that test. Black box testing demonstrates adifferent value system. Itâ€™s an appropriate attitude to take in some circumstances, but that is different from TDD.\n\n\næ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šâ€œçœ‹æƒ…å†µâ€ã€‚æµ‹ä¸ä¸æµ‹ï¼Œé»‘ç›’ç™½ç›’ï¼Œè¦†ç›–èŒƒå›´ï¼Œéƒ½çœ‹æƒ…å†µã€‚\næ€ä¹ˆçœ‹æƒ…å†µï¼Ÿ\nå¦‚æœå¾ˆæœ‰ confidenceï¼Œé‚£å°±ä¸æµ‹äº†ã€‚å¦‚æœæœ‰ fearï¼Œé‚£å¯ä»¥æµ‹æµ‹ï¼Œå°±åƒ Kent Beck è¯´çš„ï¼šâ€œWrite tests until fear is transformed into boredom.â€ è¿™é‡Œ boredom ä¹Ÿå¯ä»¥ç†è§£æˆ Confidence","like_count":2},{"had_liked":false,"id":389895,"user_name":"æœ¯å­ç±³å¾·","can_delete":false,"product_type":"c1","uid":1898023,"ip_address":"æµ™æ±Ÿ","ucode":"382EA7E2AF0B56","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg","comment_is_top":false,"comment_ctime":1713824536,"is_pvip":true,"replies":null,"discussion_count":2,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"ğŸ¤”â˜•ï¸ğŸ¤”â˜•ï¸ğŸ¤”\nã€Rã€‘Prompt4Q1ï¼š\næ¶æ„æè¿°ï¼šæŠ€æœ¯æ ˆã€æ¶æ„é£æ ¼ã€è§„åˆ™å’Œç¤ºä¾‹ï¼›\nåŠŸèƒ½éœ€æ±‚ï¼š$FuncListsï¼›\nä»»åŠ¡-Step1ï¼šæè¿°ç›®æ ‡ç»„ä»¶ã€ç›®æ ‡åŠŸèƒ½ã€æµ‹è¯•åœºæ™¯æè¿°ã€æµ‹è¯•æ•°æ®å‡†å¤‡ï¼›\nä»»åŠ¡-Step2ï¼šæ ¹æ®æŒ‡å®šæŠ€æœ¯æ ˆï¼Œä¸ºç›®æ ‡åœºæ™¯æä¾›æµ‹è¯•ä»£ç ï¼›\nã€Qã€‘æœ€ç»ˆçš„Clearæ˜¯ä»»åŠ¡-Step2ï¼Œè¿™ä¸ªæ­¥éª¤é‡Œï¼Œæ‰§è¡Œæ¸…æ™°æ˜ç¡®çš„ä»»åŠ¡æ­¥éª¤å³å¯ï¼Œè¿™ä¹‹å‰çš„ä»»åŠ¡-Step1æ˜¯Complicatedï¼Œè¿™ä¸ªæ­¥éª¤é‡Œï¼Œè¦æ ¹æ®æ¶æ„æè¿°å’ŒåŠŸèƒ½éœ€æ±‚ï¼Œåˆ†æåšå‡ºé€‰æ‹©ï¼Œå¹¶ç”Ÿæˆä¸‹ä¸€æ­¥çš„æ¸…æ™°ä»»åŠ¡åˆ—è¡¨ï¼Œå¦‚æ­¤ç†è§£åˆç†å—ï¼Ÿ\nã€Qã€‘è‡ªå·±è®¾è®¡Q1çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæœ‰å…¸å‹ç”¨æ³•ã€è¾¹ç•Œå€¼ã€å¯¹è±¡çŠ¶æ€ã€è€—æ—¶æ€§èƒ½ã€å¹¶å‘æƒ…å†µã€è¯¯ç”¨æƒ…å†µã€åå¤è°ƒç”¨ç­‰æ–¹é¢çš„è€ƒè™‘ï¼Œè¿™äº›åœ¨ç›®å‰çš„ç¤ºä¾‹é‡Œæ²¡ä½“ç°ï¼Œæ˜¯å¦æœ‰å¿…è¦è€ƒè™‘ï¼Œåœ¨å“ªä¸ªæ­¥éª¤åšåˆé€‚ï¼Ÿ\nâ€” by æœ¯å­ç±³å¾·@2024å¹´4æœˆ22æ—¥","like_count":0,"discussions":[{"author":{"id":2721761,"avatar":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","nickname":"èŒƒé£æ‰¬","note":"","ucode":"A665DF46833A81","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":642830,"discussion_content":"æˆ‘ç†è§£ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®æ˜¯ï¼ŒHow many tests should you write? \n\næˆ‘ä¹‹å‰æœ‰ä¸ª Kent Beck çš„ã€ŠTDD by exampleã€‹çš„è¯»ä¹¦ç¬”è®°ï¼Œå¯ä»¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼š\n\nHow many tests should you write? \n\nFor simple problem of triangle, Kent wrote six tests, Bob Binder wrote 65.\n\nThink about MTBF, if you want the MTBF to be 10 years, you should write more tests.\n\nï¼ˆä¸‹é¢æ˜¯åŸæ–‡äº†ï¼‰\nTDDâ€™s view of testing is pragmatic. In TDD, the tests are a means to have great conï¬dence. If our knowledge of the implementation gives us conï¬dence even without a test, then we will not write that test. Black box testing demonstrates adifferent value system. Itâ€™s an appropriate attitude to take in some circumstances, but that is different from TDD.\n\n\næ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šâ€œçœ‹æƒ…å†µâ€ã€‚æµ‹ä¸ä¸æµ‹ï¼Œé»‘ç›’ç™½ç›’ï¼Œè¦†ç›–èŒƒå›´ï¼Œéƒ½çœ‹æƒ…å†µã€‚\næ€ä¹ˆçœ‹æƒ…å†µï¼Ÿ\nå¦‚æœå¾ˆæœ‰ confidenceï¼Œé‚£å°±ä¸æµ‹äº†ã€‚å¦‚æœæœ‰ fearï¼Œé‚£å¯ä»¥æµ‹æµ‹ï¼Œå°±åƒ Kent Beck è¯´çš„ï¼šâ€œWrite tests until fear is transformed into boredom.â€ è¿™é‡Œ boredom ä¹Ÿå¯ä»¥ç†è§£æˆ Confidence","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1713837175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2721761,"avatar":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","nickname":"èŒƒé£æ‰¬","note":"","ucode":"A665DF46833A81","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":642831,"discussion_content":"å¥½é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1713837611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389889,"user_name":"èŒƒé£æ‰¬","can_delete":false,"product_type":"c1","uid":2721761,"ip_address":"å¹¿ä¸œ","ucode":"A665DF46833A81","user_header":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","comment_is_top":false,"comment_ctime":1713798460,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"ä»£è¯æ¶ˆé™¤çœŸæ˜¯å¦™ï¼Œ\n\n1ã€æ„Ÿè§‰æ¶æ„å¯ä»¥é€šè¿‡ mermaid class diagram åŠ ä¸Š åŠç»“æ„åŒ–è‡ªç„¶è¯­è¨€ æ¥è¡¨è¾¾å§ï¼Œè¿™æ ·æ›´å‡ç‚¼ä¸€ç‚¹ï¼Ÿ\n\n2ã€åŠŸèƒ½éœ€æ±‚ä¹Ÿå¯ä»¥ç”¨éªŒæ”¶æµ‹è¯•æˆ–è€…ç”¨æˆ·æ•…äº‹è¡¨è¾¾","like_count":0}]}