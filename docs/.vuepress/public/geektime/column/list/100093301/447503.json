{"id":447503,"title":"18 | å›¾åƒåˆ†ç±»ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•æ„å»ºä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹?","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚æ¬¢è¿æ¥åˆ°ç¬¬18èŠ‚è¯¾çš„å­¦ä¹ ã€‚</p><p>æˆ‘ç›¸ä¿¡ç»è¿‡ä¸ŠèŠ‚è¯¾çš„å­¦ä¹ ï¼Œä½ å·²ç»äº†è§£äº†å›¾åƒåˆ†ç±»çš„åŸç†ï¼Œè¿˜åˆæ­¥è®¤è¯†äº†ä¸€äº›ç»å…¸çš„å·ç§¯ç¥ç»ç½‘ç»œã€‚</p><p>æ­£æ‰€è°“â€œçº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œâ€ï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬æŠŠä¸ŠèŠ‚è¯¾çš„ç†è®ºçŸ¥è¯†åº”ç”¨èµ·æ¥ï¼Œä¸€èµ·ä»æ•°æ®çš„å‡†å¤‡ã€æ¨¡å‹è®­ç»ƒä»¥åŠæ¨¡å‹è¯„ä¼°ï¼Œä»å¤´è‡³å°¾ä¸€èµ·æ¥å®Œæˆä¸€ä¸ªå®Œæ•´çš„å›¾åƒåˆ†ç±»é¡¹ç›®å®è·µã€‚</p><p>è¯¾ç¨‹ä»£ç ä½ å¯ä»¥ä»<a href=\"https://github.com/syuu1987/geekTime-image-classification\">è¿™é‡Œ</a>ä¸‹è½½ã€‚</p><h2>é—®é¢˜å›é¡¾</h2><p>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹é—®é¢˜èƒŒæ™¯ï¼Œæˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œåœ¨ä¼—å¤šå›¾ç‰‡ä¸­è‡ªåŠ¨è¯†åˆ«å‡ºæå®¢æ—¶é—´Logoçš„å›¾ç‰‡ã€‚æƒ³è¦å®ç°è‡ªåŠ¨è¯†åˆ«ï¼Œé¦–å…ˆéœ€è¦åˆ†ææ•°æ®é›†é‡Œçš„å›¾ç‰‡æ˜¯å•¥æ ·å­çš„ã€‚</p><p>é‚£æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ åŒ…å«æå®¢æ—¶é—´Logoçš„å›¾ç‰‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/2c/1d221d4d170c54625dc8d124bcc6df2c.jpeg?wh=1242x2209\" alt=\"å›¾ç‰‡\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼ŒLogoå æ•´å¼ å›¾ç‰‡çš„æ¯”ä¾‹è¿˜æ˜¯æ¯”è¾ƒå°çš„ï¼Œæ‰€ä»¥è¯´ï¼Œå¦‚æœè¿™ä¸ªé¡¹ç›®æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œç›®æ ‡æ£€æµ‹å…¶å®æ›´åŠ åˆé€‚ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—®é¢˜ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œä¿®æ”¹æˆè‡ªåŠ¨è¯†åˆ«æå®¢æ—¶é—´å®£ä¼ æµ·æŠ¥ï¼Œè¿™å…¶å®å°±å¾ˆé€‚åˆå›¾åƒåˆ†ç±»ä»»åŠ¡äº†ã€‚</p><h2>æ•°æ®å‡†å¤‡</h2><p>ç›¸æ¯”ç›®æ ‡æ£€æµ‹ä¸å›¾åƒåˆ†å‰²æ¥è¯´ï¼Œå›¾åƒåˆ†ç±»çš„æ•°æ®å‡†å¤‡è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚åœ¨å›¾åƒåˆ†ç±»ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ¯ä¸ªç±»åˆ«çš„å›¾ç‰‡æ”¾åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹é‡Œå°±è¡Œäº†ã€‚</p><p>ä¸‹å›¾æ˜¯æˆ‘çš„å›¾ç‰‡ç»„ç»‡æ–¹å¼ï¼Œæ–‡ä»¶å¤¹å°±æ˜¯å›¾ç‰‡æ‰€å±çš„ç±»åˆ«ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/cf/8e/cf664db8d071979583a7cec69a45168e.png?wh=922x334\" alt=\"å›¾ç‰‡\"></p><p>logoæ–‡ä»¶å¤¹ä¸­å­˜æ”¾çš„æ˜¯10å¼ æå®¢æ—¶é—´æµ·æŠ¥çš„å›¾ç‰‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/46/27/460af80104ec4550ff1b745a1f9f6627.png?wh=1516x704\" alt=\"å›¾ç‰‡\"></p><p>è€Œothersä¸­ï¼Œç†è®ºä¸Šåº”è¯¥æ˜¯å„ç§å…¶å®ƒç±»å‹çš„å›¾ç‰‡ï¼Œä½†è¿™é‡Œä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­å­˜æ”¾çš„éƒ½æ˜¯å°çŒ«çš„å›¾ç‰‡ã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/e6/b0/e6275aac026ce5d626c1e6ebb1fde9b0.png?wh=1494x480\" alt=\"å›¾ç‰‡\"></p><h2>æ¨¡å‹è®­ç»ƒ</h2><p>å¥½å•¦ï¼Œæ•°æ®å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬ç°åœ¨è¿›å…¥æ¨¡å‹è®­ç»ƒé˜¶æ®µã€‚</p><p>ä»Šå¤©æˆ‘æƒ³å‘ä½ ä»‹ç»ä¸€ä¸ªåœ¨æœ€è¿‘2å¹´éå¸¸å—æ¬¢è¿çš„ä¸€ä¸ªç½‘ç»œâ€”â€”EfficientNetã€‚å®ƒä¸ºæˆ‘ä»¬æä¾›äº†B0ï½B7ï¼Œä¸€å…±8ä¸ªä¸åŒç‰ˆæœ¬çš„æ¨¡å‹ï¼Œè¿™8ä¸ªç‰ˆæœ¬æœ‰ç€ä¸åŒçš„å‚æ•°é‡ï¼Œåœ¨åŒç­‰å‚æ•°é‡çš„æ¨¡å‹ä¸­ï¼Œå®ƒçš„ç²¾åº¦éƒ½æ˜¯é¦–å±ˆä¸€æŒ‡çš„ã€‚å› æ­¤ï¼Œè¿™8ä¸ªç‰ˆæœ¬çš„æ¨¡å‹å¯ä»¥è§£å†³ä½ çš„å¤§å¤šæ•°é—®é¢˜ã€‚</p><h3>EfficientNet</h3><p>æˆ‘å…ˆç»™ä½ è§£è¯»ä¸€ä¸‹<a href=\"https://arxiv.org/pdf/1905.11946.pdf\">EfficientNet</a>çš„è¿™ç¯‡è®ºæ–‡ï¼Œè¿™é‡Œæˆ‘ç€é‡åˆ†äº«è®ºæ–‡çš„æ ¸å¿ƒæ€è·¯è¿˜æœ‰æˆ‘çš„ç†è§£ï¼Œå­¦æœ‰ä½™åŠ›çš„åŒå­¦å¯ä»¥åœ¨è¯¾åè‡ªè¡Œé˜…è¯»åŸæ–‡ã€‚</p><p>EfficientNetä¸€å…±æœ‰B0åˆ°B7ï¼Œ8ä¸ªæ¨¡å‹ï¼Œå‚æ•°é‡ç”±å°‘åˆ°å¤šï¼Œç²¾åº¦ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼Œå…·ä½“ä½ å¯ä»¥çœ‹çœ‹åé¢çš„è¯„ä»·æŒ‡æ ‡ã€‚</p><p>åœ¨ä¹‹å‰çš„é‚£äº›ç½‘ç»œï¼Œè¦ä¹ˆä»ç½‘ç»œçš„æ·±åº¦å‡ºå‘ï¼Œè¦ä¹ˆä»ç½‘ç»œçš„å®½åº¦å‡ºå‘æ¥ä¼˜åŒ–ç½‘ç»œçš„æ€§èƒ½ï¼Œä½†ä»æ¥æ²¡æœ‰äººå°†è¿™äº›æ–¹å‘ç»“åˆåœ¨ä¸€èµ·è€ƒè™‘ã€‚<strong>è€ŒEfficientNetå°±åšäº†è¿™æ ·çš„å°è¯•ï¼Œå®ƒæ¢ç´¢äº†ç½‘ç»œæ·±åº¦ã€ç½‘ç»œå®½åº¦ã€å›¾åƒåˆ†è¾¨ç‡ä¹‹é—´çš„æœ€ä¼˜ç»„åˆ</strong>ã€‚</p><p>EfficientNetåˆ©ç”¨ä¸€ç§å¤åˆçš„ç¼©æ”¾æ‰‹æ®µï¼Œå¯¹ç½‘ç»œçš„æ·±åº¦depthã€å®½åº¦widthå’Œåˆ†è¾¨ç‡resolutionåŒæ—¶è¿›è¡Œç¼©æ”¾ï¼ˆæŒ‰ç…§ä¸€å®šçš„ç¼©æ”¾è§„å¾‹ï¼‰ï¼Œæ¥è¾¾åˆ°ç²¾åº¦å’Œè¿ç®—å¤æ‚åº¦FLOPSçš„æƒè¡¡ã€‚</p><p>ä½†å³ä½¿åªæ¢ç´¢è¿™ä¸‰ä¸ªç»´åº¦ï¼Œæœç´¢ç©ºé—´ä»ç„¶å¾ˆå¤§ï¼Œæ‰€ä»¥ä½œè€…è§„å®šåªåœ¨B0ï¼ˆä½œè€…æå‡ºçš„EfficientNetçš„ä¸€ä¸ªBaselineï¼‰ä¸Šè¿›è¡Œæ”¾å¤§ã€‚</p><p>é¦–å…ˆï¼Œä½œè€…æ¯”è¾ƒäº†å•ç‹¬æ”¾å¤§è¿™ä¸‰ä¸ªç»´åº¦ä¸­çš„ä»»æ„ä¸€ä¸ªç»´åº¦æ•ˆæœå¦‚ä½•ã€‚å¾—å‡ºç»“è®ºæ˜¯æ”¾å¤§ç½‘ç»œæ·±åº¦æˆ–ç½‘ç»œå®½åº¦æˆ–å›¾åƒåˆ†è¾¨ç‡ï¼Œå‡å¯æå‡æ¨¡å‹ç²¾åº¦ï¼Œä½†æ˜¯è¶Šæ”¾å¤§ï¼Œç²¾åº¦å¢åŠ è¶Šç¼“æ…¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7f/64/7ff4750599323623bb148ed8b2222b64.png?wh=1920x591\" alt=\"å›¾ç‰‡\"></p><p>ç„¶åï¼Œä½œè€…åšäº†ç¬¬äºŒä¸ªå®éªŒï¼Œå°è¯•åœ¨ä¸åŒçš„rï¼ˆåˆ†è¾¨ç‡ï¼‰ï¼Œdï¼ˆæ·±åº¦ï¼‰ç»„åˆä¸‹å˜åŠ¨wï¼ˆå®½åº¦ï¼‰ï¼Œå¾—åˆ°ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/de/46/dec67f3868ddcc44e503yy13a09c1e46.png?wh=1734x1310\" alt=\"å›¾ç‰‡\"></p><p>ç»“è®ºæ˜¯ï¼Œå¾—åˆ°æ›´é«˜çš„ç²¾åº¦ä»¥åŠæ•ˆç‡çš„å…³é”®æ˜¯å¹³è¡¡ç½‘ç»œå®½åº¦ï¼Œç½‘ç»œæ·±åº¦ï¼Œå›¾åƒåˆ†è¾¨ç‡ä¸‰ä¸ªç»´åº¦çš„ç¼©æ”¾å€ç‡(d, r, w)ã€‚</p><p>å› æ­¤ï¼Œä½œè€…æå‡ºäº†æ··åˆç»´åº¦æ”¾å¤§æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨ä¸€ä¸ª$\\phi$ï¼ˆæ··åˆç¨€ç–ï¼‰æ¥å†³å®šä¸‰ä¸ªç»´åº¦çš„æ”¾å¤§å€ç‡ã€‚</p><p>æ·±åº¦depthï¼š$d = \\alpha ^{\\phi}$</p><p>å®½åº¦widthï¼š$w = \\beta ^{\\phi}$</p><p>åˆ†è¾¨ç‡resolution: $r = \\gamma ^{\\phi}$</p><p>$$s.t. \\space \\alpha\\cdot\\beta^2\\cdot\\gamma^2 \\approx2 \\space \\space \\alpha \\geq1,\\beta \\geq1,\\gamma \\geq1$$</p><p>ç¬¬ä¸€æ­¥ï¼Œå›ºå®š$\\phi$ä¸º1ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—é‡ä¸º2å€ï¼Œä½¿ç”¨ç½‘æ ¼æœç´¢ï¼Œå¾—åˆ°äº†æœ€ä½³çš„ç»„åˆï¼Œä¹Ÿå°±æ˜¯$\\alpha=1.2, \\beta = 1.1, \\gamma = 1.15$ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œå›ºå®š$\\alpha=1.2, \\beta = 1.1, \\gamma = 1.15$ï¼Œä½¿ç”¨ä¸åŒçš„æ··åˆç¨€ç–$\\phi$ï¼Œå¾—åˆ°äº†B1~B7ã€‚</p><p>æ•´ä½“è¯„ä¼°æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/14/037cd03be0995f97caa71ba079078814.png?wh=1682x1324\" alt=\"å›¾ç‰‡\"></p><p>ä»è¯„ä¼°ç»“æœä¸Šå¯ä»¥çœ‹åˆ°ï¼ŒEfficientNetçš„å„ä¸ªç‰ˆæœ¬å‡è¶…è¿‡äº†ä¹‹å‰çš„ä¸€äº›ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œã€‚</p><p>EfficientNet v2ä¹Ÿå·²ç»è¢«æå‡ºæ¥äº†ï¼Œæœ‰æ—¶é—´çš„è¯ä½ å¯ä»¥è‡ªå·±å»çœ‹çœ‹ã€‚</p><p>æˆ‘ä»¬ä¸å¦¨å€ŸåŠ©ä¸€ä¸‹EfficientNetçš„<a href=\"https://github.com/lukemelas/EfficientNet-PyTorch\">GitHub</a>ï¼Œå®ƒé‡Œé¢æœ‰è®­ç»ƒImageNetçš„demo(demo/imagenet/main.py)ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹å®ƒçš„æ ¸å¿ƒä»£ç ï¼Œç„¶åç²¾ç®€ä¸€ä¸‹ä»£ç ï¼ŒæŠŠå®ƒè¿è¡Œèµ·æ¥(Torchvisionä¹Ÿæä¾›äº†EfficientNetçš„æ¨¡å‹ï¼Œè¯¾åä½ ä¹Ÿå¯ä»¥è‡ªå·±è¯•ä¸€è¯•)ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹ï¼Œä¹‹å‰è¯´çš„æœºå™¨å­¦ä¹ 3ä»¶å¥—ï¼š</p><p>1.æ•°æ®å¤„ç†<br>\n2.æ¨¡å‹è®­ç»ƒï¼ˆæ„å»ºæ¨¡å‹ã€æŸå¤±å‡½æ•°ä¸ä¼˜åŒ–æ–¹æ³•ï¼‰<br>\n3.æ¨¡å‹è¯„ä¼°</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æŒ¨ä¸ªçœ‹çœ‹è¿™äº›æ­¥éª¤ã€‚ä½ éœ€è¦å…ˆæŠŠ<a href=\"https://github.com/lukemelas/EfficientNet-PyTorch\">https://github.com/lukemelas/EfficientNet-PyTorch</a>ç»™å…‹éš†ä¸‹æ¥ï¼Œæˆ‘ä»¬åªä½¿ç”¨efficientnet_pytorchä¸­çš„å†…å®¹ï¼Œå®ƒåŒ…å«ç€æ¨¡å‹çš„ç½‘ç»œç»“æ„ã€‚</p><p>ä¹‹åæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªå«åšgeektimeçš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç„¶åæŠŠefficientnet_pytorchæ”¾è¿›å»ã€‚</p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠç¨‹åºéœ€è¦çš„å‚æ•°ç»™ä½ åˆ—ä¸€ä¸‹ï¼Œåœ¨ä¸‹é¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨è¿™äº›å‚æ•°äº†ã€‚å½“ä½ åœ¨å®ç°ä»Šå¤©ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦å°†è¿™äº›å‚æ•°è¡¥å……åˆ°ä»£ç ä¸­ï¼ˆå¯ä»¥ä½¿ç”¨argparsemæ¨¡å—ï¼‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/df/7a/df24d6aa865b645f1d2aa50716e7d17a.jpg?wh=1739x1027\" alt=\"å›¾ç‰‡\"></p><p>å¥½ï¼Œä¸‹é¢è®©æˆ‘ä»¬æ­£å¼å¼€å§‹åŠ¨æ‰‹ã€‚</p><h3>åŠ è½½æ•°æ®</h3><p>é¦–å…ˆæ˜¯æ•°æ®åŠ è½½çš„ç¯èŠ‚ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªdataset.pyæ–‡ä»¶ï¼Œç”¨æ¥å­˜å‚¨ä¸æ•°æ®æœ‰å…³çš„å†…å®¹ã€‚dataset.pyå¦‚ä¸‹ï¼ˆæˆ‘çœç•¥äº†æ¨¡å—çš„å¼•å…¥ï¼‰ã€‚</p><pre><code class=\"language-python\">\n# ä½œè€…ç»™å‡ºçš„æ ‡å‡†åŒ–æ–¹æ³•\ndef _norm_advprop(img):\n&nbsp; &nbsp; return img * 2.0 - 1.0\n\ndef build_transform(dest_image_size):\n&nbsp; &nbsp; normalize = transforms.Lambda(_norm_advprop)\n\n&nbsp; &nbsp; if not isinstance(dest_image_size, tuple):\n&nbsp; &nbsp; &nbsp; &nbsp; dest_image_size = (dest_image_size, dest_image_size)\n&nbsp; &nbsp; else:\n&nbsp; &nbsp; &nbsp; &nbsp; dest_image_size = dest_image_size\n\n&nbsp; &nbsp; transform = transforms.Compose([\n&nbsp; &nbsp; &nbsp; &nbsp; transforms.RandomResizedCrop(dest_image_size),\n&nbsp; &nbsp; &nbsp; &nbsp; transforms.RandomHorizontalFlip(),\n&nbsp; &nbsp; &nbsp; &nbsp; transforms.ToTensor(),\n&nbsp; &nbsp; &nbsp; &nbsp; normalize\n&nbsp; &nbsp; ])\n\n&nbsp; &nbsp; return transform\n\ndef build_data_set(dest_image_size, data):\n&nbsp; &nbsp; transform = build_transform(dest_image_size)&nbsp;\n&nbsp; &nbsp; dataset=datasets.ImageFolder(data, transform=transform, target_transform=None)&nbsp;\n\n&nbsp; &nbsp; return dataset\n\n</code></pre><p>è¿™éƒ¨åˆ†ä»£ç å®Œæˆçš„å·¥ä½œæ˜¯ï¼Œé€šè¿‡build_data_setæ„å»ºæ•°æ®é›†ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†torchvision.datasets.ImageFolderæ¥åˆ›å»ºDatasetã€‚ImageFolderèƒ½å°†æŒ‰æ–‡ä»¶å¤¹å½¢å¼çš„ç»„ç»‡æ•°æ®ç”Ÿæˆåˆ°ä¸€ä¸ªDatasetã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä¼ å…¥çš„è®­ç»ƒé›†è·¯å¾„ä¸ºâ€™./data/trainâ€™ï¼Œä½ å¯ä»¥çœ‹çœ‹å¼€ç¯‡çš„æˆªå›¾ã€‚</p><p>ImageFolderä¼šè‡ªåŠ¨çš„å°†åŒä¸€æ–‡ä»¶å¤¹å†…çš„æ•°æ®æ‰“ä¸Šä¸€ä¸ªæ ‡ç­¾ï¼Œä¹Ÿå°±æ˜¯è¯´logoæ–‡ä»¶å¤¹çš„æ•°æ®ï¼ŒImageFolderä¼šè®¤ä¸ºæ˜¯æ¥è‡ªåŒä¸€ç±»åˆ«ï¼Œothersæ–‡ä»¶å¤¹çš„æ•°æ®ï¼ŒImageFolderä¼šè®¤ä¸ºæ˜¯æ¥è‡ªå¦å¤–ä¸€ä¸ªç±»åˆ«ã€‚</p><p>æˆ‘ä»¬è¿™ä¸ªç²¾ç®€ç‰ˆåªæ„å»ºäº†è®­ç»ƒé›†çš„Datasetï¼Œå½“ä½ çœ‹Efficientå®˜æ–¹ä»£ç çš„æ—¶å€™ï¼Œåœ¨éªŒè¯é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦ç•™æ„ä¸€ä¸‹éªŒè¯é›†çš„<a href=\"https://github.com/lukemelas/EfficientNet-PyTorch/blob/master/examples/imagenet/main.py#L240-L245\">transforms</a>ã€‚</p><p>æˆ‘è®¤ä¸ºï¼Œè¿™é‡Œè¿™ä¹ˆåšæ˜¯æœ‰ç‚¹é—®é¢˜çš„ï¼ŒåŸå› æ˜¯Resizeä¸­sizeå‚æ•°å¦‚æœæ˜¯ä¸ªtupleç±»å‹ï¼Œåˆ™ç›´æ¥æŒ‰ç…§sizeçš„å°ºå¯¸è¿›è¡Œresizeã€‚å¦‚æœæ˜¯ä¸€ä¸ªintçš„æ—¶å€™ï¼Œå¦‚æœå›¾ç‰‡çš„heightå¤§äºwidthï¼Œåˆ™æŒ‰ç…§(size * height/width, size)è¿›è¡Œresizeã€‚</p><p>åœ¨ä½œè€…çš„åŸå§‹ç¨‹åºä¸­ï¼Œimag_sizeæ˜¯ä¸ªintï¼Œè€Œä¸æ˜¯tupleã€‚æ‰€ä»¥æŒ‰ç…§è¿™ç§å…ˆresizeå†cropçš„æ–¹å¼å¤„ç†ä¸€ä¸‹ï¼Œå¯¹é•¿å®½æ¯”æ¯”è¾ƒå¤§çš„å›¾ç‰‡æ¥è¯´ï¼Œæ•ˆæœä¸æ˜¯å¾ˆå¥½ã€‚</p><p>è®©æˆ‘ä»¬å®é™…éªŒè¯ä¸€ä¸‹è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘å°†å¼€ç¯‡çš„ä¾‹å­ï¼ˆä¹Ÿå°±æ˜¯é‚£å¼ æµ·æŠ¥å›¾ï¼‰çš„image_sizeè®¾å®šä¸º224åï¼Œç”¨ä¸Šè¿°çš„æ–¹å¼è¿›è¡Œå¤„ç†åï¼Œè·å¾—ä¸‹å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a9/e2/a93417ee476234249d0e69fb5c5f04e2.jpg?wh=224x224\" alt=\"å›¾ç‰‡\"></p><p>ä½ çœ‹ï¼Œæ˜¯ä¸æ˜¯ç¼ºå°‘äº†å¾ˆå¤šä¿¡æ¯ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œå¦‚æœåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ä½¿ç”¨ä½œè€…çš„ç¨‹åºï¼Œå°±éœ€è¦åšä¸€ä¸‹ä¿®æ”¹ã€‚æŠŠè¿™é‡Œçš„ä»£ç é€»è¾‘ä¿®æ”¹ä¸ºå¦‚æœimage_sizeä¸æ˜¯tupleï¼Œå…ˆå°†image_sizeè½¬æ¢ä¸ºtupleï¼Œå¹¶ä¸”ä¹Ÿä¸éœ€è¦cropäº†ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-python\">if not isinstance(image_size, tuple):\n&nbsp; &nbsp; image_size = (image_size, image_size)\nelse:\n&nbsp; &nbsp; image_size = image_size\n\ntransform = transforms.Compose([\n&nbsp; &nbsp; transforms.Resize(image_size, interpolation=Image.BICUBIC),\n&nbsp; &nbsp; transforms.ToTensor(),\n&nbsp; &nbsp; normalize,\n])\n</code></pre><p>è®­ç»ƒçš„ä¸»ç¨‹åºæˆ‘ä»¬å®šä¹‰åœ¨main.pyä¸­ï¼Œåœ¨main.pyä¸­çš„main()ä¸­ï¼Œè¿›è¡Œæ•°æ®çš„åŠ è½½ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡forå¾ªç¯ä¸€ä¸ªä¸€ä¸ªEpochçš„è°ƒç”¨trainæ–¹æ³•è¿›è¡Œè®­ç»ƒå°±å¯ä»¥äº†ã€‚</p><pre><code class=\"language-python\"># çœç•¥äº†ä¸€äº›æ¨¡å—çš„å¼•å…¥\nfrom efficientnet import EfficientNet\nfrom dataset import build_data_set\n\ndef main():\n    # part1: æ¨¡å‹åŠ è½½ (ç¨åè¡¥å……)\n    # part2: æŸå¤±å‡½æ•°ã€ä¼˜åŒ–æ–¹æ³•(ç¨åè¡¥å……)&nbsp; &nbsp; \n    train_dataset = build_data_set(args.image_size, args.train_data)\n\n&nbsp; &nbsp; train_loader = torch.utils.data.DataLoader(\n&nbsp; &nbsp; &nbsp; &nbsp; train_dataset,&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; batch_size=args.batch_size,\n&nbsp; &nbsp; &nbsp; &nbsp; shuffle=True,\n&nbsp; &nbsp; &nbsp; &nbsp; num_workers=args.workers,\n&nbsp; &nbsp; &nbsp; &nbsp; )\n\n&nbsp; &nbsp; for epoch in range(args.epochs):\n&nbsp; &nbsp; &nbsp; &nbsp; # è°ƒç”¨trainå‡½æ•°è¿›è¡Œè®­ç»ƒï¼Œç¨åè¡¥å……\n&nbsp; &nbsp; &nbsp; &nbsp; train(train_loader, model, criterion, optimizer, epoch, args)\n        # æ¨¡å‹ä¿å­˜&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; if epoch % args.save_interval == 0:\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if not os.path.exists(args.checkpoint_dir):\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.mkdir(args.checkpoint_dir)\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; torch.save(model.state_dict(), os.path.join(args.checkpoint_dir,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'checkpoint.pth.tar.epoch_%s' % epoch))\n</code></pre><h3>åˆ›å»ºæ¨¡å‹</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åˆ›å»ºæ¨¡å‹ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä½œè€…ç»™å‡ºçš„Efficientæ¨¡å‹ã€‚åœ¨ä¸Šé¢ä»£ç æ³¨é‡Šä¸­çš„part1éƒ¨åˆ†ï¼Œç”¨ä¸‹è¿°ä»£ç å³å¯åŠ è½½EfficientNetæ¨¡å‹ã€‚</p><pre><code class=\"language-python\">&nbsp; &nbsp; args.classes_num = 2\n    if args.pretrained:\n&nbsp; &nbsp; &nbsp; &nbsp; model = EfficientNet.from_pretrained(args.arch, num_classes=args.classes_num,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; advprop=args.advprop)\n&nbsp; &nbsp; &nbsp; &nbsp; print(\"=&gt; using pre-trained model '{}'\".format(args.arch))\n&nbsp; &nbsp; else:\n&nbsp; &nbsp; &nbsp; &nbsp; print(\"=&gt; creating model '{}'\".format(args.arch))\n&nbsp; &nbsp; &nbsp; &nbsp; model = EfficientNet.from_name(args.arch, override_params={'num_classes': args.classes_num})\n    # æœ‰GPUçš„è¯ï¼ŒåŠ ä¸Šcuda()\n    #mode.cuda()\n</code></pre><p>è¿™æ®µä»£ç æ˜¯è¯´ï¼Œå¦‚æœpretrained modelå‚æ•°ä¸ºTrueï¼Œåˆ™è‡ªåŠ¨ä¸‹è½½å¹¶åŠ è½½pretrained modelåè¿›è¡Œè®­ç»ƒï¼Œå¦åˆ™æ˜¯ä½¿ç”¨éšæœºæ•°åˆå§‹åŒ–ç½‘ç»œã€‚<br>\nfrom_pretrainedä¸from_nameä¸­ï¼Œéƒ½éœ€è¦ä¿®æ”¹ä¸€ä¸‹num_classesï¼Œå°†EfficientNetçš„å…¨è¿æ¥å±‚ä¿®æ”¹æˆ‘ä»¬é¡¹ç›®å¯¹åº”çš„ç±»åˆ«æ•°ï¼Œè¿™é‡Œçš„args.classes_numä¸º2ï¼ˆlogoç±»ä¸othersç±»ï¼‰ã€‚</p><h4>æ¨¡å‹å¾®è°ƒ</h4><p>æ¨¡å‹å¾®è°ƒåœ¨<a href=\"https://time.geekbang.org/column/article/431420\">ç¬¬8èŠ‚è¯¾</a>å’Œ<a href=\"https://time.geekbang.org/column/article/442442\">ç¬¬14èŠ‚è¯¾</a>æ—¶è¯´è¿‡ï¼Œè¿™ä¸ªæ¦‚å¿µæ¯”è¾ƒé‡è¦ï¼Œæˆ‘ä»¬ä¸€èµ·å†å¤ä¹ ä¸€ä¸‹ã€‚</p><p>Pretrained modelä¸€èˆ¬æ˜¯åœ¨ImageNetï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯COCOæˆ–VOCï¼Œéƒ½æ˜¯å…¬å¼€æ•°æ®é›†ï¼‰ä¸Šè®­ç»ƒè¿‡çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå®ƒåœ¨ImageNetä¸Šè®­ç»ƒå¥½çš„æ¨¡å‹å‚æ•°ç›´æ¥æ‹¿è¿‡æ¥ï¼Œåœ¨å…¶åŸºç¡€ä¸Šè®­ç»ƒæˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹ï¼Œè¿™å°±æ˜¯æ¨¡å‹å¾®è°ƒã€‚</p><p>æ‰€ä»¥è¯´ï¼Œ<strong>å¦‚æœæœ‰Pretrained modelï¼Œæˆ‘ä»¬ä¸€å®šä¼šä½¿ç”¨Pretrained modelè¿›è¡Œè®­ç»ƒï¼Œæ”¶æ•›é€Ÿåº¦ä¼šå¿«</strong>ã€‚</p><p>ä½¿ç”¨Pretrained modelçš„æ—¶å€™è¦æ³¨æ„ä¸€ç‚¹ï¼Œåœ¨ImageNetä¸Šè®­ç»ƒåçš„å…¨è¿æ¥å±‚ä¸€å…±æœ‰1000ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥ä½¿ç”¨Pretrained modelçš„æ—¶å€™åªä½¿ç”¨å…¨è¿æ¥å±‚ä»¥å¤–çš„å‚æ•°ã€‚</p><p>åœ¨ä¸Šè¿°ä»£ç çš„EfficientNet.from_pretrainedä¸­ï¼Œä¼š<s>é€š</s>è°ƒç”¨load_pretrained_weightså‡½æ•°ï¼Œè°ƒç”¨ä¹‹å‰num_classeså·²ç»è¢«ä¿®æ”¹ä¸º2ï¼ˆlogoä¸othersï¼‰ï¼Œæ‰€ä»¥è¯´ä¼ å…¥load_pretrained_weightsçš„load_fcå‚æ•°ä¸ºFalseï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šåŠ è½½å…¨è¿æ¥å±‚çš„å‚æ•°ã€‚load_pretrained_weightsçš„è°ƒç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-python\">load_pretrained_weights(model, model_name, load_fc=(num_classes == 1000), advprop=advprop)\n</code></pre><p>load_pretrained_weightså‡½æ•°ä¸­åŒ…å«ä¸‹é¢è¿™æ®µä»£ç ï¼Œå°±åƒåˆšæ‰æ‰€è¯´ï¼Œå¦‚æœä¸åŠ è½½å…¨è¿æ¥å±‚ï¼Œåˆ™åˆ é™¤_fcçš„weightä¸biasï¼š</p><pre><code class=\"language-python\">if load_fc:\n    ret = model.load_state_dict(state_dict, strict=False)\n    assert not ret.missing_keys, 'Missing keys when loading pretrained weights: {}'.format(ret.missing_keys)\nelse:\n&nbsp; &nbsp; state_dict.pop('_fc.weight')\n&nbsp; &nbsp; state_dict.pop('_fc.bias')\n&nbsp; &nbsp; ret = model.load_state_dict(state_dict, strict=False)\n</code></pre><h3>è®¾å®šæŸå¤±å‡½æ•°ä¸ä¼˜åŒ–æ–¹æ³•</h3><p>æœ€åè¦åšçš„å°±æ˜¯è®¾å®šæŸå¤±å‡½æ•°ä¸ä¼˜åŒ–æ–¹æ³•äº†ï¼Œæˆ‘ä»¬å°†ä¸‹é¢çš„ä»£ç è¡¥å……åˆ°part2éƒ¨åˆ†ï¼š</p><pre><code class=\"language-python\">criterion = nn.CrossEntropyLoss() # æœ‰GPUçš„è¯åŠ ä¸Š.cuda()\n\noptimizer = torch.optim.SGD(model.parameters(), args.lr,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; momentum=args.momentum,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; weight_decay=args.weight_decay)\n</code></pre><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œæˆè®­ç»ƒçš„æ‰€æœ‰å‡†å¤‡äº†ï¼Œåªè¦å†è¡¥å……å¥½trainå‡½æ•°å°±å¯ä»¥äº†ï¼Œä»£ç å¦‚ä¸‹ã€‚ä¸‹é¢çš„ä»£ç çš„åŸç†æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/438639\">ç¬¬13èŠ‚è¯¾</a>ä¸­å·²ç»è®²è¿‡äº†ï¼Œè®°ä¸æ¸…çš„å¯ä»¥å»å›é¡¾ä¸€ä¸‹ã€‚</p><pre><code class=\"language-python\">def train(train_loader, model, criterion, optimizer, epoch, args):\n&nbsp; &nbsp; # switch to train mode\n&nbsp; &nbsp; model.train()\n\n&nbsp; &nbsp; for i, (images, target) in enumerate(train_loader):\n&nbsp; &nbsp; &nbsp; &nbsp; # compute output\n&nbsp; &nbsp; &nbsp; &nbsp; output = model(images)\n&nbsp; &nbsp; &nbsp; &nbsp; loss = criterion(output, target)\n&nbsp; &nbsp; &nbsp; &nbsp; print('Epoch ', epoch, loss)\n\n&nbsp; &nbsp; &nbsp; &nbsp; # compute gradient and do SGD step\n&nbsp; &nbsp; &nbsp; &nbsp; optimizer.zero_grad()\n&nbsp; &nbsp; &nbsp; &nbsp; loss.backward()\n&nbsp; &nbsp; &nbsp; &nbsp; optimizer.step()\n</code></pre><p>ä¸è¿‡åœ¨æˆ‘çš„ç¨‹åºé‡Œï¼Œä¿å­˜äº†è‹¥å¹²ä¸ªEpochçš„æ¨¡å‹ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿè¿™å°±è¦è¯´åˆ°æ¨¡å‹çš„è¯„ä¼°ç¯èŠ‚ã€‚</p><h2>æ¨¡å‹è¯„ä¼°</h2><p>å¯¹äºåˆ†ç±»æ¨¡å‹çš„è¯„ä¼°æ¥è¯´ï¼Œæœ‰å¾ˆå¤šè¯„ä»·æŒ‡æ ‡ï¼Œä¾‹å¦‚å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1-Scoreç­‰ã€‚å…¶ä¸­ï¼Œ<strong>æˆ‘è®¤ä¸ºæœ€ç›´è§‚ã€æœ€æœ‰è¯´æœåŠ›çš„å°±æ˜¯ç²¾ç¡®ç‡ä¸å¬å›ç‡</strong>ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­è§‚å¯Ÿçš„ä¸»è¦æ˜¯æŒ‡æ ‡ã€‚ä¸‹é¢æˆ‘ä»¬ä¾æ¬¡æ¥çœ‹çœ‹ã€‚</p><h3>æ··æ·†çŸ©é˜µ</h3><p>åœ¨è®²è§£ç²¾ç¡®ç‡ä¸å¬å›ç‡ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹æ··æ·†çŸ©é˜µè¿™ä¸ªæ¦‚å¿µã€‚å…¶å®ç²¾ç¡®ç‡ä¸å¬å›ç‡å°±æ˜¯é€šè¿‡å®ƒè®¡ç®—å‡ºæ¥çš„ã€‚ä¸‹è¡¨å°±æ˜¯ä¸€ä¸ªæ··æ·†çŸ©é˜µï¼Œæ­£ä¾‹å°±æ˜¯logoç±»ï¼Œè´Ÿä¾‹å°±æ˜¯othersç±»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/57/8b/5756d1fe45493d69ayy534da3d20088b.jpg?wh=1920x847\" alt=\"å›¾ç‰‡\"></p><p>æ ¹æ®é¢„æµ‹ç»“æœå’ŒçœŸå®ç±»åˆ«çš„ç»„åˆï¼Œä¸€å…±æœ‰å››ç§æƒ…å†µï¼š</p><p>1.TPæ˜¯è¯´çœŸå®ç±»åˆ«ä¸ºLogoï¼Œæ¨¡å‹ä¹Ÿé¢„æµ‹ä¸ºLogoï¼›<br>\n2.FPæ˜¯è¯´çœŸå®ç±»åˆ«ä¸ºOthersï¼Œä½†æ¨¡å‹é¢„æµ‹ä¸ºLogoï¼›<br>\n3.FNæ˜¯è¯´çœŸå®ç±»åˆ«ä¸ºLogoï¼Œä½†æ¨¡å‹é¢„æµ‹ä¸ºOthersï¼›<br>\n4.TNæ˜¯è¯´çœŸå®ç±»åˆ«ä¸ºOthersï¼Œæ¨¡å‹ä¹Ÿé¢„æµ‹ä¸ºOthersï¼›</p><p>ç²¾ç¡®ç‡çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š</p><p>$$precision = \\frac{TP}{ (TP + FP)}$$</p><p>å¬å›ç‡çš„è®¡ç®—æ–¹å¼ä¸ºï¼š</p><p>$$recall = \\frac{TP}{(TP + FN)}$$</p><p>ç²¾ç¡®ç‡ä¸å¬å›ç‡åˆ†åˆ«è¡¡é‡äº†æ¨¡å‹çš„ä¸åŒè¡¨ç°ï¼Œç²¾ç¡®ç‡è¯´çš„æ˜¯ï¼Œå¦‚æœæ¨¡å‹è®¤ä¸ºä¸€å¼ å›¾ç‰‡æ˜¯Logoç±»ï¼Œé‚£æœ‰å¤šå¤§æ¦‚ç‡æ˜¯Logoç±»ã€‚è€Œå¬å›ç‡è¡¡é‡çš„æ˜¯ï¼Œåœ¨æ•´ä¸ªéªŒè¯é›†ä¸­ï¼Œæ¨¡å‹èƒ½æ‰¾åˆ°å¤šå°‘Logoå›¾ç‰‡ã€‚</p><p>é‚£é—®é¢˜æ¥äº†ï¼Œæ€æ ·æ ¹æ®è¿™ä¸¤ä¸ªæŒ‡æ ‡æ¥é€‰æ‹©æ¨¡å‹å‘¢ï¼Ÿä¸šåŠ¡éœ€æ±‚ä¸åŒï¼Œæˆ‘ä»¬ä¾§é‡çš„æŒ‡æ ‡å°±ä¸ä¸€æ ·ã€‚</p><p>æ¯”å¦‚åœ¨æˆ‘ä»¬çš„è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå¦‚æœè€æ¿å…è®¸ä¸€éƒ¨åˆ†Logoå›¾ç‰‡æ²¡æœ‰è¢«è¯†åˆ«ï¼Œä½†æ˜¯æ¨¡å‹å¿…é¡»éå¸¸å‡†ï¼Œæ¨¡å‹è¯´ä¸€å¼ å›¾ç‰‡æ˜¯Logoç±»ï¼Œé‚£å›¾ç‰‡çœŸå®ç±»åˆ«å°±æœ‰éå¸¸å¤§çš„æ¦‚ç‡æ˜¯Logoç±»å›¾ç‰‡ï¼Œé‚£åº”è¯¥ä¾§é‡çš„å°±æ˜¯ç²¾ç¡®ç‡ï¼›å¦‚æœè€æ¿å¸Œæœ›æŠŠçº¿ä¸ŠLogoç±»å°½å¯èƒ½åœ°è¯†åˆ«å‡ºæ¥ï¼Œå…è®¸ä¸€éƒ¨åˆ†å›¾ç‰‡è¢«è¯¯è¯†åˆ«ï¼Œé‚£åº”è¯¥ä¾§é‡çš„å°±æ˜¯å¬å›ç‡ã€‚</p><p>åœ¨è®¡ç®—ç²¾ç¡®ç‡ä¸å¬å›ç‡çš„æ—¶å€™ï¼Œç»™ä½ åˆ†äº«ä¸€ä¸‹æˆ‘çš„ç»éªŒã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä¹ æƒ¯æŠŠæ¨¡å‹å¯¹æ¯å¼ å›¾ç‰‡çš„é¢„æµ‹ç»“æœä¿å­˜åˆ°ä¸€ä¸ªtxtä¸­ï¼Œè¿™æ ·å¯ä»¥æ¯”è¾ƒç›´è§‚åœ°ç­›é€‰ä¸€äº›æ¨¡å‹çš„badcaseï¼Œå¹¶ä¸”éªŒè¯é›†å¦‚æœéå¸¸å¤§ï¼Œåˆéœ€è¦è°ƒæ•´çš„æ—¶å€™ï¼Œç›´æ¥æ›´æ”¹txtå°±å¯ä»¥äº†ï¼Œä¸éœ€è¦å†æ¬¡è®©æ¨¡å‹é¢„æµ‹æ•´ä¸ªéªŒè¯é›†ã€‚</p><p>ä¸‹é¢æ˜¯txtæ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œåˆ†åˆ«è®°å½•äº†logoç±»çš„æ¦‚ç‡ã€othersç±»çš„æ¦‚ç‡ã€çœŸå®ç±»åˆ«æ˜¯å¦ä¸ºlogoã€çœŸå®ç±»åˆ«æ˜¯å¦ä¸ºothersã€é¢„æµ‹ç±»åˆ«æ˜¯å¦ä¸ºlogoã€é¢„æµ‹ç±»åˆ«æ˜¯å¦ä¸ºohtersã€å›¾ç‰‡åã€‚</p><p>14.jpegæ˜¯å¼€ç¯‡ä¾‹å­çš„é‚£å¼ å›¾ç‰‡ï¼Œæ¨¡å‹è®¤ä¸ºå®ƒæ˜¯Logoçš„æ¦‚ç‡æ˜¯0.58476ï¼Œothersç±»çš„æ¦‚ç‡æ˜¯0.41524ã€‚</p><pre><code class=\"language-python\">...\n0.64460 0.35540 1 0 1 0 ./data/val/logo/13.jpeg\n0.58476 0.41524 1 0 1 0 ./data/val/logo/14.jpeg\n...\n</code></pre><p>ä¸‹å›¾æ˜¯æˆ‘è®­ç»ƒäº†10ä¸ªEpochçš„B0æ¨¡å‹ï¼Œåœ¨éªŒè¯é›†(è¿™é‡Œæˆ‘ç”¨è®­ç»ƒé›†å……å½“äº†ä¸€ä¸‹éªŒè¯é›†)ä¸Šçš„è¯„ä»·æ•ˆæœã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/95/00/95a4b9f3e9eddb32b3bc30e85dfa2500.png?wh=966x730\" alt=\"å›¾ç‰‡\"></p><p>é€šè¿‡æ··æ·†çŸ©é˜µå¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªéªŒè¯é›†ä¸€å…±æœ‰8+0å¼ å›¾ç‰‡è¢«é¢„æµ‹ä¸ºlogoç±»ï¼Œæ‰€ä»¥logoç±»çš„ç²¾ç¡®ç‡ä¸º8 / (8 + 0 ) = 1ï¼›logoç±»ä¸€å…±æœ‰8+2å¼ å›¾ç‰‡ï¼Œæœ‰ä¸¤å¼ é¢„æµ‹é”™äº†ï¼Œæ‰€ä»¥å¬å›ç‡ä¸º8 / (8 +2) = 0.8ã€‚</p><p>othersç±»åˆ«çš„è®¡ç®—ç±»ä¼¼ï¼Œä½ å¯ä»¥è‡ªå·±ç®—ç®—çœ‹ã€‚</p><h2>å°ç»“</h2><p>æ­å–œä½ ï¼Œå®Œæˆäº†ä»Šå¤©çš„å­¦ä¹ ä»»åŠ¡ã€‚ä»Šå¤©æˆ‘ä»¬ä¸€èµ·å®Œæˆäº†ä¸€ä¸ªå›¾åƒåˆ†ç±»é¡¹ç›®çš„å®è·µã€‚è™½ç„¶é¡¹ç›®è§„æ¨¡è¾ƒå°ï¼Œä½†æ˜¯åœ¨çœŸå®é¡¹ç›®ä¸­çš„æ¯ä¸€ä¸ªç¯èŠ‚éƒ½åŒ…å«åœ¨å†…äº†ï¼Œå¯ä»¥è¯´æ˜¯éº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ¯ä¸ªç¯èŠ‚ä¸Šçš„å…³é”®è¦ç‚¹å’Œå®æ“ç»éªŒã€‚</p><p><strong>æ•°æ®å‡†å¤‡å…¶å®æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œæ•°æ®çš„è´¨é‡ç›´æ¥å†³å®šäº†æ¨¡å‹å¥½å</strong>ã€‚æ‰€ä»¥ï¼Œåœ¨å¼€å§‹è®­ç»ƒä¹‹å‰ä½ åº”è¯¥å¯¹ä½ çš„æ•°æ®é›†æœ‰åè¶³çš„äº†è§£æ‰å¯ä»¥ã€‚ä¾‹å¦‚ï¼ŒéªŒè¯é›†è¿˜æ˜¯å¦å¯ä»¥åæ˜ å‡ºè®­ç»ƒé›†ã€æ•°æ®ä¸­æœ‰æ²¡æœ‰è„æ•°æ®ã€æ•°æ®åˆ†å¸ƒæœ‰æ²¡æœ‰åç­‰ç­‰ã€‚</p><p>å®Œæˆæ•°æ®å‡†å¤‡ä¹‹åå°±åˆ°äº†æ¨¡å‹è®­ç»ƒï¼Œå›¾åƒåˆ†ç±»ä»»åŠ¡å…¶å®åŸºæœ¬ä¸Šéƒ½æ˜¯é‡‡ç”¨ä¸»æµçš„å·ç§¯ç¥ç»ç½‘ç»œäº†ï¼Œå¾ˆå°‘å¯¹æ¨¡å‹ç»“æ„åšä¸€äº›æ›´æ”¹ã€‚</p><p>æœ€åçš„æ¨¡å‹è¯„ä¼°ç¯èŠ‚è¦ä¾§é‡ä¸šåŠ¡åœºæ™¯ï¼Œçœ‹ä¸šåŠ¡ä¸Šéœ€è¦é«˜ç²¾ç¡®è¿˜æ˜¯é«˜å¬å›ï¼Œç„¶åå†å¯¹ä½ çš„æ¨¡å‹åšè°ƒæ•´ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è€æ¿å¸Œæœ›ä½ çš„æ¨¡å‹èƒ½å°½å¯èƒ½çš„æŠŠçº¿ä¸Šæ‰€æœ‰æå®¢æ—¶é—´çš„æµ·æŠ¥éƒ½æ‰¾åˆ°ï¼Œå…è®¸ä¸€äº›è¯¯å¬å›ã€‚è®­ç»ƒæ¨¡å‹çš„æ—¶å€™ä½ åº”è¯¥ä¾§é‡ç²¾ç¡®ç‡è¿˜æ˜¯å¬å›ç‡ï¼Ÿ</p><p>æ¨èä½ åŠ¨æ‰‹å®ç°ä¸€ä¸‹ä»Šå¤©çš„Demoï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šçš„åŒäº‹ã€æœ‹å‹ï¼Œè·Ÿä»–ä¸€èµ·å­¦ä¹ è¿›æ­¥ã€‚</p>","comments":[{"had_liked":false,"id":323128,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1637737823,"is_pvip":false,"replies":[{"id":"117279","content":"ğŸ‘ğŸ»ğŸ‘ğŸ»^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637801350,"ip_address":"","comment_id":323128,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10227672415","product_id":100093301,"comment_content":"æ€è€ƒé¢˜ï¼š<br>å¬å›ç‡è¡¡é‡çš„æ˜¯ï¼Œåœ¨æ•´ä¸ªéªŒè¯é›†ä¸­ï¼Œæ¨¡å‹èƒ½æ‰¾åˆ°å¤šå°‘ Logo å›¾ç‰‡ã€‚å› æ­¤åœ¨å°½å¯èƒ½çš„æŠŠçº¿ä¸Šæ‰€æœ‰æå®¢æ—¶é—´çš„æµ·æŠ¥éƒ½æ‰¾åˆ°ï¼Œå…è®¸ä¸€äº›è¯¯å¬å›çš„æƒ…å†µä¸‹ï¼Œè®­ç»ƒçš„çš„æ¨¡å‹åº”è¯¥æ›´ä¾§é‡å¬å›ç‡ã€‚","like_count":2,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533125,"discussion_content":"ğŸ‘ğŸ»ğŸ‘ğŸ»^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637801350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338012,"user_name":"Geek_be7ab2","can_delete":false,"product_type":"c1","uid":2938365,"ip_address":"","ucode":"9E57D5541B7F11","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8MTplMt8gSz0ZoazK9R24DdTaBZN2CNibWSNyFLF0CAgOJRvXgHOeoXgFyzhdQXgwHC3XJgY25RT3ONQY2ty80A/132","comment_is_top":false,"comment_ctime":1647234844,"is_pvip":false,"replies":[{"id":"123637","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>å› ä¸ºæˆ‘ç»™å‡ºçš„predictåªèƒ½å¯¹ä¸€å¼ å›¾ç‰‡é¢„æµ‹å•Šã€‚<br>https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification&#47;blob&#47;main&#47;predict.py#L19<br>æƒ³é¢„æµ‹å¤šå¼ å›¾ç‰‡çš„è¯ï¼Œå¯ä»¥è‡ªå·±æ‰‹åŠ¨æ”¹ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1647398646,"ip_address":"","comment_id":338012,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5942202140","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘é€šè¿‡nohup python train.py &gt; myout.log 2&gt;&amp;1 &amp; æ–¹å¼è¿è¡Œtrain.pyæ–‡ä»¶æ²¡æœ‰ä»ä½•é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨predict.pyæ—¶å‘ç°åªèƒ½å¯¹ä¸€å¼ å›¾ç‰‡è¿›è¡Œé¢„æµ‹ã€‚ä»£ç å¦‚ä¸‹ï¼š<br>python predict.py --path .&#47;data&#47;val&#47;logo&#47;14.jpeg<br>è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556481,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\nå› ä¸ºæˆ‘ç»™å‡ºçš„predictåªèƒ½å¯¹ä¸€å¼ å›¾ç‰‡é¢„æµ‹å•Šã€‚\nhttps://github.com/syuu1987/geekTime-image-classification/blob/main/predict.py#L19\næƒ³é¢„æµ‹å¤šå¼ å›¾ç‰‡çš„è¯ï¼Œå¯ä»¥è‡ªå·±æ‰‹åŠ¨æ”¹ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647398646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323173,"user_name":"narsilçš„æ¢¦","can_delete":false,"product_type":"c1","uid":1185187,"ip_address":"","ucode":"67110C673BD951","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/a3/e67d6039.jpg","comment_is_top":false,"comment_ctime":1637748567,"is_pvip":false,"replies":[{"id":"117280","content":"ä½ å¥½ï¼Œnarsilçš„æ¢¦ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>forwardæ¥å—çš„ä¹Ÿæ˜¯ä¸€ä¸ªbatchçš„æ•°æ®ã€‚<br>forwardçš„è¾“å…¥å³ä¸ºç½‘ç»œçš„è¾“å…¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªshapeä¸ºï¼ˆbatch_size, é€šé“æ•°ï¼Œé«˜ï¼Œå®½ï¼‰çš„tensorã€‚<br>outputçš„è¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªbatch_sizeçš„è¾“å‡ºï¼Œè€Œä¸æ˜¯å¹³å‡å€¼ã€‚<br>å½“é¢„æµ‹ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œè¾“å…¥åº”è¯¥ä¸º(1, é€šé“æ•°ï¼Œé«˜ï¼Œå®½)çš„tensorã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637801637,"ip_address":"","comment_id":323173,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5932715863","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·é—®ä¸‹é¢è¿™æ®µä»£ç é‡Œä¸ºä»€ä¹ˆè°ƒç”¨ model çš„æ—¶å€™ä¸€æ¬¡ä¼ å…¥äº†ä¸€ä¸ª batch çš„å›¾ç‰‡æ•°é‡è€Œä¸æ˜¯ä¸€å¼ ä¸€å¼ ä¼ å…¥å¹¶è®¡ç®— outputï¼Ÿå¦‚æœä¸€æ¬¡ä¼ å…¥å¤šå¼ å›¾ç‰‡è¾“å…¥ï¼Œæ˜¯ä¸æ˜¯è¾“å‡ºçš„ output æ˜¯å¹³å‡å€¼ï¼Ÿä½†æˆ‘çœ‹ EfficientNet çš„ forward å‡½æ•°ç¡®å®ä¸€æ¬¡åªæ¥å—ä¸€å¼ å›¾ç‰‡è¾“å…¥<br><br>    for i, (images, target) in enumerate(train_loader):<br>        # compute output<br>        output = model(images)<br>        loss = criterion(output, target)<br>        print(&#39;Epoch &#39;, epoch, loss)","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533127,"discussion_content":"ä½ å¥½ï¼Œnarsilçš„æ¢¦ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\nforwardæ¥å—çš„ä¹Ÿæ˜¯ä¸€ä¸ªbatchçš„æ•°æ®ã€‚\nforwardçš„è¾“å…¥å³ä¸ºç½‘ç»œçš„è¾“å…¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªshapeä¸ºï¼ˆbatch_size, é€šé“æ•°ï¼Œé«˜ï¼Œå®½ï¼‰çš„tensorã€‚\noutputçš„è¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªbatch_sizeçš„è¾“å‡ºï¼Œè€Œä¸æ˜¯å¹³å‡å€¼ã€‚\nå½“é¢„æµ‹ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œè¾“å…¥åº”è¯¥ä¸º(1, é€šé“æ•°ï¼Œé«˜ï¼Œå®½)çš„tensorã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637801637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1185187,"avatar":"https://static001.geekbang.org/account/avatar/00/12/15/a3/e67d6039.jpg","nickname":"narsilçš„æ¢¦","note":"","ucode":"67110C673BD951","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":533183,"discussion_content":"æ„Ÿè°¢è€å¸ˆå›å¤ï¼Œä¸è¿‡è¿˜æœ‰ä¸€äº›ä¸æ˜ç™½çš„ã€‚output æ˜¯ä¸€ä¸ª batch çš„ï¼Œé‚£ä¹ˆè®¡ç®—å‡ºæ¥ loss ä¹Ÿæ˜¯ä¸€ä¸ª batchï¼ŸæŠŠä¸€ä¸ª batch çš„ loss åå‘ä¼ æ’­ç„¶åç”¨ sgd ä¼˜åŒ–å™¨ä¼˜åŒ–ï¼Œé‚£ä¹ˆè¿™é‡Œçš„ sgd å¦‚ä½•ä½“ç°å‡ºæ¥æ˜¯éšæœºå–ä¸€ä¸ªæ ·æœ¬å°±æ›´æ–°ä¸€æ¬¡ç½‘ç»œå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637808906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":533127,"ip_address":""},"score":533183,"extra":"{\"user_type\":1}"},{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1185187,"avatar":"https://static001.geekbang.org/account/avatar/00/12/15/a3/e67d6039.jpg","nickname":"narsilçš„æ¢¦","note":"","ucode":"67110C673BD951","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536638,"discussion_content":"outputæ˜¯ä¸€ä¸ªbatchçš„ã€‚lossä¹Ÿæ˜¯ä¸€ä¸ªbatchçš„ï¼Œä½†æ˜¯lossçš„è¾“å‡ºæ˜¯å°†è¿™ä¸ªbatchçš„æŸå¤±å–å‡å€¼ã€‚CrossEntropyLossä¸­reductionå‚æ•°çš„é»˜è®¤å€¼æ˜¯Meanï¼Œå°±æ˜¯å¯¹ä¸€ä¸ªbatchä¸­çš„losså–å‡å€¼å†è¾“å‡ºã€‚\nhttps://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html\nå’±ä»¬çš„ç¨‹åºæ˜¯å–ä¸€ä¸ªbatchçš„æ•°æ®æ›´æ–°ä¸€æ¬¡ç½‘ç»œçš„å‚æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638840405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":533183,"ip_address":""},"score":536638,"extra":""}]}]},{"had_liked":false,"id":322741,"user_name":"zhaobk","can_delete":false,"product_type":"c1","uid":1291596,"ip_address":"","ucode":"30BEE12D2CF020","user_header":"https://static001.geekbang.org/account/avatar/00/13/b5/4c/6b9528f8.jpg","comment_is_top":false,"comment_ctime":1637572171,"is_pvip":false,"replies":[{"id":"117182","content":"ä½ å¥½ï¼Œzhaobkï¼Œè°¢è°¢ç•™è¨€ã€‚ä½ è¯´çš„éªŒè¯æ˜¯æŒ‡å¦‚ä½•è¯„ä¼°å—ï¼Ÿ<br>è¯„ä¼°çš„è¯å¯ä»¥æŒ‰ç…§æ–‡ç¨¿ä¸­çš„ç²¾ç¡®ä¸å¬å›å¯¹æ¯ä¸ªæ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚<br> ä»£ç çš„è¯ï¼Œsklearnä¸­æä¾›äº†æ··æ·†çŸ©é˜µã€ç²¾ç¡®å’Œå¬å›çš„æ–¹æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637576289,"ip_address":"","comment_id":322741,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5932539467","product_id":100093301,"comment_content":"è€å¸ˆå¥½ã€‚å¯ä»¥è¯´è¯´ç»ƒå®Œä»¥åï¼Œè¦è¿™ä¹ˆè¿›è¡ŒéªŒè¯å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532322,"discussion_content":"ä½ å¥½ï¼Œzhaobkï¼Œè°¢è°¢ç•™è¨€ã€‚ä½ è¯´çš„éªŒè¯æ˜¯æŒ‡å¦‚ä½•è¯„ä¼°å—ï¼Ÿ\nè¯„ä¼°çš„è¯å¯ä»¥æŒ‰ç…§æ–‡ç¨¿ä¸­çš„ç²¾ç¡®ä¸å¬å›å¯¹æ¯ä¸ªæ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚\n ä»£ç çš„è¯ï¼Œsklearnä¸­æä¾›äº†æ··æ·†çŸ©é˜µã€ç²¾ç¡®å’Œå¬å›çš„æ–¹æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637576289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359613,"user_name":"Amaplan","can_delete":false,"product_type":"c1","uid":2765794,"ip_address":"ä¸Šæµ·","ucode":"FF7AD4404EC462","user_header":"","comment_is_top":false,"comment_ctime":1665678447,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665678447","product_id":100093301,"comment_content":"ä½œè€…ä½ å¥½ä½¿ç”¨ä½ gitä¸Šçš„ä»£ç å‡ºç°ä¸€ä¸‹é—®é¢˜:<br>TypeError                                 Traceback (most recent call last)<br>Cell In [2], line 72<br>     70 parser.add_argument(&#39;--advprop&#39;, default=False, help=&#39;advprop&#39;)<br>     71 args, unknown = parser.parse_known_args()<br>---&gt; 72 main(args)<br>...<br>TypeError: object of type &#39;NoneType&#39; has no len()","like_count":0},{"had_liked":false,"id":359606,"user_name":"Amaplan","can_delete":false,"product_type":"c1","uid":2765794,"ip_address":"ä¸Šæµ·","ucode":"FF7AD4404EC462","user_header":"","comment_is_top":false,"comment_ctime":1665673733,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665673733","product_id":100093301,"comment_content":"è¿è¡Œmain()å‡½æ•°åæŠ¥é”™:AttributeError: &#39;Namespace&#39; object has no attribute &#39;advprop&#39;<br>è¯·é—®è¿™ä¸ªadvpropæ˜¯å“ªé‡Œæ¥çš„<br>","like_count":0},{"had_liked":false,"id":358760,"user_name":"Zeurd","can_delete":false,"product_type":"c1","uid":2919792,"ip_address":"åŒ—äº¬","ucode":"7CE1E0F76C3313","user_header":"https://static001.geekbang.org/account/avatar/00/2c/8d/70/b0047299.jpg","comment_is_top":false,"comment_ctime":1664704353,"is_pvip":true,"replies":[{"id":"130555","content":"ä½ å¥½ï¼Œ<br>&gt;&gt;â€AttributeError: &#39;NoneType&#39; object has no attribute &#39;read&#39;â€œ<br>è¿™ä¸ªé—®é¢˜ä¸€èˆ¬éƒ½æ˜¯è·¯å¾„çš„é—®é¢˜ï¼Œæ•°æ®æ²¡æœ‰æ­£ç¡®è¯»å–åˆ°ã€‚<br>&gt;&gt;è¿˜æœ‰å°±æ˜¯æˆ‘åœ¨å°è¯•åˆ«çš„æ•°æ®é›†çš„æ—¶å€™ï¼Œé‚£æ˜¯ä¸ª4åˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘å¯¹æ ‡ç­¾tosenorä¹‹åï¼Œæ ‡ç­¾sizeä¸ºå•¥æ˜¯[1,1]å•Š<br>ç±»åˆ«æ˜¯1ï¼Œ2ï¼Œ3ï¼Œ4è¿™æ ·çš„å§ã€‚one-hotä¹‹åä¼šå˜æˆ4ç»´","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1665190426,"ip_address":"åŒ—äº¬","comment_id":358760,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1664704353","product_id":100093301,"comment_content":"è€å¸ˆæƒ³é—®ä¸€ä¸‹ï¼Œè¿è¡Œçš„è¯ä¼šæŠ¥AttributeError: &#39;NoneType&#39; object has no attribute &#39;read&#39;çš„é”™ï¼Œæ˜¯å› ä¸ºpredictæ–‡ä»¶é‡Œtestè·¯å¾„çš„é—®é¢˜ä¹ˆï¼Ÿ<br>è¿˜æœ‰å°±æ˜¯æˆ‘åœ¨å°è¯•åˆ«çš„æ•°æ®é›†çš„æ—¶å€™ï¼Œé‚£æ˜¯ä¸ª4åˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘å¯¹æ ‡ç­¾tosenorä¹‹åï¼Œæ ‡ç­¾sizeä¸ºå•¥æ˜¯[1,1]å•Šï¼Œ4ä¸ªæ–‡ä»¶å¤¹4ç§æ ‡ç­¾ä¸åº”è¯¥æ˜¯[1,4]ä¹ˆï¼Œä½†æ˜¯è¿™æ ·æ¨¡å‹çš„linerå±‚æˆ‘çš„classåªèƒ½è®¾1ï¼Œæ€ä¹ˆé¢„æµ‹éƒ½æ˜¯100%æ­£ç¡®ç‡ï¼Œæˆ‘çŸ¥é“åº”è¯¥æ˜¯4çš„ï¼Œä½†ä¸çŸ¥é“æ ‡ç­¾é‚£ä¸ªtarget_transformåº”è¯¥æ€ä¹ˆæ”¹","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589601,"discussion_content":"ä½ å¥½ï¼Œ\n&gt;&gt;â€AttributeError: &#39;NoneType&#39; object has no attribute &#39;read&#39;â€œ\nè¿™ä¸ªé—®é¢˜ä¸€èˆ¬éƒ½æ˜¯è·¯å¾„çš„é—®é¢˜ï¼Œæ•°æ®æ²¡æœ‰æ­£ç¡®è¯»å–åˆ°ã€‚\n&gt;&gt;è¿˜æœ‰å°±æ˜¯æˆ‘åœ¨å°è¯•åˆ«çš„æ•°æ®é›†çš„æ—¶å€™ï¼Œé‚£æ˜¯ä¸ª4åˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘å¯¹æ ‡ç­¾tosenorä¹‹åï¼Œæ ‡ç­¾sizeä¸ºå•¥æ˜¯[1,1]å•Š\nç±»åˆ«æ˜¯1ï¼Œ2ï¼Œ3ï¼Œ4è¿™æ ·çš„å§ã€‚one-hotä¹‹åä¼šå˜æˆ4ç»´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665190426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357109,"user_name":"gavin","can_delete":false,"product_type":"c1","uid":1099142,"ip_address":"åŒ—äº¬","ucode":"3D99ADC89699FE","user_header":"https://static001.geekbang.org/account/avatar/00/10/c5/86/1134c2f1.jpg","comment_is_top":false,"comment_ctime":1662966704,"is_pvip":false,"replies":[{"id":"129994","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>1. å±äºPythonè¯­æ³•çš„é—®é¢˜ã€‚_norm_advprop æ˜¯ä¸ªå‡½æ•° https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification&#47;blob&#47;main&#47;dataset.py#L6<br>2. https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification&#47;blob&#47;main&#47;train.py#L16ä¸https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification&#47;blob&#47;main&#47;predict.py#L18<br>æ˜¯é…åˆä½¿ç”¨çš„ã€‚<br>ä½†æ˜¯model.train(mode=True)é»˜è®¤æ˜¯Trueï¼Œä¸€èˆ¬æ¥è¯´ä¸å†™ä¹Ÿå¯ä»¥ã€‚<br>å®ƒçš„ä½œç”¨æ˜¯ä¼šå¯åŠ¨æ¨¡å‹ä¸­çš„BNå±‚ä¸dropoutå±‚ã€‚<br>è€Œmodel.evalï¼ˆï¼‰åˆ™æ˜¯å…³é—­BNä¸dropoutï¼Œè¿›è¡Œé¢„æµ‹ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1663055842,"ip_address":"åŒ—äº¬","comment_id":357109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662966704","product_id":100093301,"comment_content":"ä¸¤ä¸ªé—®é¢˜æ²¡å¼„æ˜ç™½:<br>1.transforms.Lambda(_norm_advprop)ä¸­ä¸ç”¨ä¼ imgå‚æ•°è¿›å»çš„å—ï¼Ÿ å‡½æ•°å®šä¹‰æ—¶ä¸æ˜¯æœ‰ä¸ªimgå‚æ•°å—<br>2.train.pyä¸­ï¼Œmodel.train()æ˜¯ä»€ä¹ˆç”¨?å¦‚æœæ˜¯æ¨¡å‹å†…éƒ¨å°±å®šä¹‰äº†è®­ç»ƒï¼Œåé¢é‚£æ®µè®­ç»ƒè¿˜æœ‰ä»€ä¹ˆç”¨","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587438,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\n1. å±äºPythonè¯­æ³•çš„é—®é¢˜ã€‚_norm_advprop æ˜¯ä¸ªå‡½æ•° https://github.com/syuu1987/geekTime-image-classification/blob/main/dataset.py#L6\n2. https://github.com/syuu1987/geekTime-image-classification/blob/main/train.py#L16ä¸https://github.com/syuu1987/geekTime-image-classification/blob/main/predict.py#L18\næ˜¯é…åˆä½¿ç”¨çš„ã€‚\nä½†æ˜¯model.train(mode=True)é»˜è®¤æ˜¯Trueï¼Œä¸€èˆ¬æ¥è¯´ä¸å†™ä¹Ÿå¯ä»¥ã€‚\nå®ƒçš„ä½œç”¨æ˜¯ä¼šå¯åŠ¨æ¨¡å‹ä¸­çš„BNå±‚ä¸dropoutå±‚ã€‚\nè€Œmodel.evalï¼ˆï¼‰åˆ™æ˜¯å…³é—­BNä¸dropoutï¼Œè¿›è¡Œé¢„æµ‹ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663055842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355002,"user_name":"èµµå¯æ˜","can_delete":false,"product_type":"c1","uid":3012204,"ip_address":"åŒ—äº¬","ucode":"96AFD073DCF129","user_header":"","comment_is_top":false,"comment_ctime":1660965412,"is_pvip":false,"replies":[{"id":"129294","content":"æŠ±æ­‰ï¼Œå›å¤è¿Ÿäº†ã€‚<br>æ„Ÿè§‰æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä½ çœ‹çœ‹ä½ çš„pytorchç‰ˆæœ¬è·Ÿè¯¾ç¨‹çš„ä¸€ä¸ä¸€æ ·ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1661320678,"ip_address":"åŒ—äº¬","comment_id":355002,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660965412","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œå¦‚ä¸‹ä»£ç æ‰§è¡Œåï¼š<br>  model = EfficientNet.from_name(&#39;efficientnet-b0&#39;)<br>    num_ftrs = model._fc.in_features<br>    model._fc = nn.Linear(num_ftrs, 2)<br>    model.load_state_dict(torch.load(&#39;.&#47;data&#47;checkpoint&#47;checkpoint.pth.tar.epoch_9&#39;))<br>ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼š<br>lib\\site-packages\\torch\\nn\\modules\\module.py&quot;, line 1379, in load_state_dict<br>    state_dict = state_dict.copy()<br>AttributeError: &#39;_IncompatibleKeys&#39; object has no attribute &#39;copy&#39;<br>æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585072,"discussion_content":"æŠ±æ­‰ï¼Œå›å¤è¿Ÿäº†ã€‚\næ„Ÿè§‰æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä½ çœ‹çœ‹ä½ çš„pytorchç‰ˆæœ¬è·Ÿè¯¾ç¨‹çš„ä¸€ä¸ä¸€æ ·ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661320679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354934,"user_name":"wongxinjie","can_delete":false,"product_type":"c1","uid":1128363,"ip_address":"å¹¿ä¸œ","ucode":"021104851E91C4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep0PCjmt5dXpgGt4yDWm6FiaffwQkxgD6sSXVricmvN4pg7ZdOLlAoFAHKTSvG3E8G3YI0RV4ar27cQ/132","comment_is_top":false,"comment_ctime":1660894115,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660894115","product_id":100093301,"comment_content":"è€å¸ˆçš„é¡¹ç›®è¦æ˜¯èƒ½æŠŠä½ ç”¨çš„ä¾èµ–å¯¼åˆ° requirements.txt å°±æ›´å¥½äº†","like_count":0},{"had_liked":false,"id":354069,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"å¹¿ä¸œ","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1660056327,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660056327","product_id":100093301,"comment_content":"è¿˜æ²¡åƒé€ï¼Œæ˜å¤©å†æ¥ï¼Œå·²ç»starã€‚ è°¢è°¢æ–¹è€å¸ˆ<br>git clone git@github.com:syuu1987&#47;geekTime-image-classification.git<br><br>python train.py<br>python predict.py --path .&#47;data&#47;val&#47;logo&#47;14.jpeg<br>prediction: tensor([[ 0.4379, -0.2296]], grad_fn=&lt;AddmmBackward0&gt;)","like_count":0},{"had_liked":false,"id":354068,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"åŒ—äº¬","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1660056105,"is_pvip":true,"replies":[{"id":"129290","content":"æŠ±æ­‰ï¼Œå›å¤è¿Ÿäº†ã€‚<br>è¿™ä¸ªä¼¼ä¹æ˜¯æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1661319548,"ip_address":"åŒ—äº¬","comment_id":354068,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660056105","product_id":100093301,"comment_content":"æ–¹è€å¸ˆï¼Œè¯·æ•™ python train.pyèƒ½æˆåŠŸï¼Œpredict å¤±è´¥ , æœ€ålogå¦‚ä¸‹ï¼š<br>Epoch  9 tensor(0.3476, grad_fn=&lt;NllLossBackward0&gt;)<br>torch.Size([9, 3, 224, 224])<br>Epoch  9 tensor(0.3354, grad_fn=&lt;NllLossBackward0&gt;)<br><br>python predict.py<br>Traceback (most recent call last):<br>  File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.10&#47;lib&#47;python3.10&#47;site-packages&#47;PIL&#47;Image.py&quot;, line 3072, in open<br>    fp.seek(0)<br>AttributeError: &#39;NoneType&#39; object has no attribute &#39;seek&#39;<br><br>During handling of the above exception, another exception occurred:<br><br>Traceback (most recent call last):<br>  File &quot;&#47;Users&#47;zgpeace&#47;Workspace&#47;AI&#47;geekTime-image-classification&#47;predict.py&quot;, line 19, in &lt;module&gt;<br>    image = Image.open(args.path)<br>  File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.10&#47;lib&#47;python3.10&#47;site-packages&#47;PIL&#47;Image.py&quot;, line 3074, in open<br>    fp = io.BytesIO(fp.read())<br>AttributeError: &#39;NoneType&#39; object has no attribute &#39;read&#39;","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585067,"discussion_content":"æŠ±æ­‰ï¼Œå›å¤è¿Ÿäº†ã€‚\nè¿™ä¸ªä¼¼ä¹æ˜¯æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661319549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354063,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"å¹¿ä¸œ","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1660053333,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660053333","product_id":100093301,"comment_content":"æ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼Œäº¦ç§°æ¯ç§’å³°å€¼é€Ÿåº¦ï¼Œï¼ˆè‹±è¯­ï¼šFloating-point operations per secondï¼›ç¼©å†™ï¼šFLOPSï¼‰ï¼Œå³æ¯ç§’æ‰€æ‰§è¡Œçš„æµ®ç‚¹è¿ç®—æ¬¡æ•°ã€‚æµ®ç‚¹ï¼ˆfloating-pointï¼‰æŒ‡çš„æ˜¯å¸¦æœ‰å°æ•°çš„æ•°å€¼ï¼Œæµ®ç‚¹è¿ç®—å³æ˜¯å°æ•°çš„å››åˆ™è¿ç®—ï¼Œå¸¸ç”¨æ¥æµ‹é‡ç”µè„‘è¿ç®—é€Ÿåº¦æˆ–è¢«ç”¨æ¥ä¼°ç®—ç”µè„‘æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨åˆ°å¤§é‡æµ®ç‚¹è¿ç®—çš„ç§‘å­¦è®¡ç®—é¢†åŸŸä¸­ã€‚å› ä¸ºFLOPSåç¼€çš„é‚£ä¸ªSä»£è¡¨ç§’ï¼Œè€Œä¸æ˜¯å¤æ•°ï¼Œæ‰€ä»¥ä¸èƒ½å¤Ÿçœç•¥ã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæµ‹ç®—FLOPSæ¯”æµ‹ç®—æ¯ç§’æŒ‡ä»¤æ•°ï¼ˆIPSï¼‰è¦å‡†ç¡®ã€‚<br><br>æµ®ç‚¹è¿ç®—å®é™…ä¸ŠåŒ…æ‹¬äº†æ‰€æœ‰æ¶‰åŠæµ®ç‚¹æ•°çš„è¿ç®—ï¼Œåœ¨æŸç±»åº”ç”¨è½¯ä»¶ä¸­å¸¸å¸¸å‡ºç°ï¼Œæ¯”è¾ƒæ•´æ•°è¿ç®—æ›´ç”¨æ—¶é—´ã€‚ç°ä»Šå¤§éƒ¨åˆ†çš„å¤„ç†å™¨ä¸­éƒ½æœ‰æµ®ç‚¹è¿ç®—å™¨ã€‚å› æ­¤æ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°æ‰€é‡æµ‹çš„å®é™…ä¸Šå°±æ˜¯æµ®ç‚¹è¿ç®—å™¨çš„æ‰§è¡Œé€Ÿåº¦ã€‚å¸¸ç”¨æ¥æµ‹é‡æ¯ç§’æµ®ç‚¹è¿ç®—æ¬¡æ•°çš„åŸºå‡†ç¨‹åºï¼ˆbenchmarkï¼‰ä¹‹ä¸€ï¼Œæ˜¯Linpackã€‚","like_count":0},{"had_liked":false,"id":354022,"user_name":"Geek_827444","can_delete":false,"product_type":"c1","uid":3091330,"ip_address":"åŒ—äº¬","ucode":"B205EFB4F6DC01","user_header":"","comment_is_top":false,"comment_ctime":1660025380,"is_pvip":false,"replies":[{"id":"128776","content":"ä½ å¥½ï¼ŒåŒå­¦ã€‚<br>è¿™æ˜¯pythonçš„å†…å®¹ã€‚ä½ å¯ä»¥æŸ¥ä¸€ä¸‹argparseæ¨¡å—çš„ä½¿ç”¨ã€‚<br>éœ€è¦pip installä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1660026980,"ip_address":"åŒ—äº¬","comment_id":354022,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1660025380","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸‹args.xxxxè¿™ä¸ªåˆ°åº•è¯¥æ€ä¹ˆç”¨é‚£ï¼Ÿä¹‹å‰çœ‹äº†æ‚¨å’Œå¦å¤–ä¸€ä½åŒå­¦å‘çš„è¯´è°ƒç”¨argpasemæ¨¡å—ï¼Œå¯æ˜¯æˆ‘çœ‹æˆ‘çš„pycharmé‡Œæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å•Šï¼Œè¿™åˆæ˜¯æ€ä¹ˆå›äº‹é‚£ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583310,"discussion_content":"ä½ å¥½ï¼ŒåŒå­¦ã€‚\nè¿™æ˜¯pythonçš„å†…å®¹ã€‚ä½ å¯ä»¥æŸ¥ä¸€ä¸‹argparseæ¨¡å—çš„ä½¿ç”¨ã€‚\néœ€è¦pip installä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660026980,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353726,"user_name":"è¨€ä¸ç”±è¡·","can_delete":false,"product_type":"c1","uid":3075767,"ip_address":"åŒ—äº¬","ucode":"7154B6233C2B4C","user_header":"https://static001.geekbang.org/account/avatar/00/2e/ee/b7/eb7854f8.jpg","comment_is_top":false,"comment_ctime":1659698942,"is_pvip":false,"replies":[{"id":"128746","content":"ä½ å¥½ï¼Œå…·ä½“æ˜¯å“ªé‡ŒæŠ¥é”™å‘¢ï¼Ÿ<br>logoé‡Œä¸€å…±å°±9å¼ å›¾ç‰‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1660005534,"ip_address":"åŒ—äº¬","comment_id":353726,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659698942","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘è¿è¡Œpredictæ–‡ä»¶ä¹‹åï¼Œä¼šä¸€ç›´å‡ºç°AttributeError: &#39;NoneType&#39; object has no attribute &#39;read&#39;çš„é”™è¯¯ï¼Œè€Œä¸”trainæ–‡ä»¶æœ€å¤šåªèƒ½ä¸‹è½½å‡º9ä¸ªæ–‡ä»¶<br>","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583260,"discussion_content":"ä½ å¥½ï¼Œå…·ä½“æ˜¯å“ªé‡ŒæŠ¥é”™å‘¢ï¼Ÿ\nlogoé‡Œä¸€å…±å°±9å¼ å›¾ç‰‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660005534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346694,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1653362984,"is_pvip":false,"replies":[{"id":"126469","content":"ä½¿ç”¨prettytable ^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1653456604,"ip_address":"","comment_id":346694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1653362984","product_id":100093301,"comment_content":"è¿™ä¸ªæ··æ·†çŸ©é˜µæ²¡å¼„å‡ºæ¥","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573473,"discussion_content":"ä½¿ç”¨prettytable ^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653456605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346677,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1653356694,"is_pvip":false,"replies":[{"id":"126470","content":"ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ» ^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1653456692,"ip_address":"","comment_id":346677,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1653356694","product_id":100093301,"comment_content":"å¬å›ç‡","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573474,"discussion_content":"ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ» ^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653456692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346030,"user_name":"æ©™ç´«è‹±","can_delete":false,"product_type":"c1","uid":2978511,"ip_address":"","ucode":"E1CB7DDD0461C9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/AhaSicobIfA85ZUYjOZ26AYHr4jejU9y6KwwXnytqWKMehiaWDOo6q6ejyuIs5UGpBial8zj9tTQWcrzDJjHvGTWg/132","comment_is_top":false,"comment_ctime":1652778282,"is_pvip":false,"replies":[{"id":"126278","content":"æ­£å¸¸ï¼ŒåŠ ä¸Šsigmoidæˆ–è€…softmaxå°±ä¼šè½¬æ¢ä¸ºæ¦‚ç‡å½¢å¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652862880,"ip_address":"","comment_id":346030,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1652778282","product_id":100093301,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œè¯·é—®é¢„æµ‹çš„ç»“æœä¸­æœ‰è´Ÿæ•°ï¼Œè¿™æ­£å¸¸å—<br>prediction: tensor([[ 0.3588, -0.4015]], grad_fn=&lt;AddmmBackward0&gt;)","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572578,"discussion_content":"æ­£å¸¸ï¼ŒåŠ ä¸Šsigmoidæˆ–è€…softmaxå°±ä¼šè½¬æ¢ä¸ºæ¦‚ç‡å½¢å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652862881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1212044,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7e/8c/f029535a.jpg","nickname":"hallo128","note":"","ucode":"3921D6E11CFCB1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582685,"discussion_content":"åœ¨predict.pyæœ€åå†åŠ ä¸Šä»¥ä¸‹ä»£ç å³å¯è¾“å‡ºæ¦‚ç‡:\n# æ¦‚ç‡è½¬æ¢\nprob = torch.softmax(pred, dim=1)\nprint(&#34;prediction prop:&#34;, prob)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659596853,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"äº‘å—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346023,"user_name":"zhangting","can_delete":false,"product_type":"c1","uid":2950861,"ip_address":"","ucode":"565BB6CEE694E0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLDm5eHbw1fuicJiaXercgBI48O0Idt2mHUElmZyBM4o119NkndU1SNpsv8rZzKFibj8z1FibFAdNEO3zw/132","comment_is_top":false,"comment_ctime":1652773898,"is_pvip":false,"replies":[{"id":"126277","content":"ä½ å¥½ï¼Œå› ä¸ºæ²¡æœ‰åŠ sigmoidæˆ–è€…softmaxã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652862861,"ip_address":"","comment_id":346023,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652773898","product_id":100093301,"comment_content":"è€å¸ˆï¼Œé—®ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆé¢„æµ‹ç»“æœæ‰“å‡ºæ¥ä¼šæ˜¯è´Ÿçš„ï¼Ÿ<br>prediction: tensor([[-0.3866,  0.3760]])<br>","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572577,"discussion_content":"ä½ å¥½ï¼Œå› ä¸ºæ²¡æœ‰åŠ sigmoidæˆ–è€…softmaxã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652862861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345202,"user_name":"..................","can_delete":false,"product_type":"c1","uid":2980638,"ip_address":"","ucode":"3203CA634FC3A7","user_header":"https://static001.geekbang.org/account/avatar/00/2d/7b/1e/8bb7c7fe.jpg","comment_is_top":false,"comment_ctime":1652104506,"is_pvip":false,"replies":[{"id":"126005","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>æœ‰æ—¶é—´ï¼Œæœ‰èƒ½åŠ›å¯ä»¥å°è¯•å¤ç°å‡ ä¸ªã€‚<br>å¦å¤–å¤ç°åœ¨ImageNetä¸Šçš„CNNçš„è¯ï¼Œéœ€è¦ä»0å¼€å§‹åœ¨ImageNetä¸Šè®­ç»ƒã€‚<br>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç›¸åº”çš„ç¡¬ä»¶è®¾å¤‡(GPU)ã€‚<br>å¤ç°çš„ç›®çš„æ˜¯åŠ æ·±ç†è§£ï¼Œå¦‚æœè§‰å¾—ç†è§£çš„ä¸é”™çš„è¯ï¼Œä¸å¤ç°ä¹Ÿæ˜¯okçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652163157,"ip_address":"","comment_id":345202,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1652104506","product_id":100093301,"comment_content":"è€å¸ˆï¼Œæˆ‘çœ‹åˆ°è¿™ä¸ªç« èŠ‚ä¸­æ˜¯ç›´æ¥ç”¨çš„ç°æœ‰çš„æ¨¡å‹ï¼Œå…¶å®æˆ‘ä¸€ç›´æœ‰ä¸€ä¸ªç–‘é—®ï¼Œæˆ‘ä¸€ç›´æœ‰æƒ³ç€å¤ç°æ¨¡å‹ï¼Œæ‹¿CNNæ¥è¯´å§ï¼Œcnnçš„æ¨¡å‹æœ‰è¿™ä¹ˆå¤šï¼Œæ¯ä¸ªæ¨¡å‹éƒ½æœ‰å¿…è¦å¤ç°ä¸€éå—ï¼Œæˆ‘æœ‰ç‚¹ä¸çŸ¥é“æ€ä¹ˆå­¦ä¹ è¿™äº›ç»å…¸æ¨¡å‹ï¼Œæ±‚è§£ç­”ã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571266,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\næœ‰æ—¶é—´ï¼Œæœ‰èƒ½åŠ›å¯ä»¥å°è¯•å¤ç°å‡ ä¸ªã€‚\nå¦å¤–å¤ç°åœ¨ImageNetä¸Šçš„CNNçš„è¯ï¼Œéœ€è¦ä»0å¼€å§‹åœ¨ImageNetä¸Šè®­ç»ƒã€‚\nä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç›¸åº”çš„ç¡¬ä»¶è®¾å¤‡(GPU)ã€‚\nå¤ç°çš„ç›®çš„æ˜¯åŠ æ·±ç†è§£ï¼Œå¦‚æœè§‰å¾—ç†è§£çš„ä¸é”™çš„è¯ï¼Œä¸å¤ç°ä¹Ÿæ˜¯okçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652163157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2980638,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/7b/1e/8bb7c7fe.jpg","nickname":"..................","note":"","ucode":"3203CA634FC3A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":571292,"discussion_content":"æ˜ç™½äº†ï¼Œæˆ‘ä¼šæœ‰å–èˆçš„å¤ç°çš„ï¼Œæ„Ÿè°¢è€å¸ˆçš„å›ç­”ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652170092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":571266,"ip_address":""},"score":571292,"extra":""}]}]},{"had_liked":false,"id":344956,"user_name":"é˜¿ç™½","can_delete":false,"product_type":"c1","uid":2673506,"ip_address":"","ucode":"880EA22777100E","user_header":"https://static001.geekbang.org/account/avatar/00/28/cb/62/dc590615.jpg","comment_is_top":false,"comment_ctime":1651895691,"is_pvip":false,"replies":[{"id":"126083","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>å°±æ˜¯ä½œè€…ç»™å‡ºçš„ä¸€ç§æ•°æ®é¢„å¤„ç†æ–¹å¼ã€‚<br>EfficientNetçš„ä½œè€…æ˜¯å¯¹å›¾åƒåšäº†è¿™æ ·çš„å¤„ç†ä¹‹åå†è®­ç»ƒçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652250122,"ip_address":"","comment_id":344956,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651895691","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæ•°æ®åŠ è½½ç¯èŠ‚ä¸­ï¼š<br># ä½œè€…ç»™å‡ºçš„æ ‡å‡†åŒ–æ–¹æ³•<br>def _norm_advprop(img):<br>    return img * 2.0 - 1.0<br><br>è¿™æ®µæ˜¯ä»€ä¹ˆæ„æ€å•Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571511,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\nå°±æ˜¯ä½œè€…ç»™å‡ºçš„ä¸€ç§æ•°æ®é¢„å¤„ç†æ–¹å¼ã€‚\nEfficientNetçš„ä½œè€…æ˜¯å¯¹å›¾åƒåšäº†è¿™æ ·çš„å¤„ç†ä¹‹åå†è®­ç»ƒçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652250122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344944,"user_name":"InfoQ_b30d6bb7f3d4","can_delete":false,"product_type":"c1","uid":1362181,"ip_address":"","ucode":"0FE17DE5D0E4E4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/sNb8G3xGoibbo6dUcngBYsG2DZmLjd2jlmAGUkaNLb3ImCyZh5035aXaibnJdMIHeEtSuLFTcKraAZibhGpoIMo1w/132","comment_is_top":false,"comment_ctime":1651889794,"is_pvip":true,"replies":[{"id":"126112","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚ä¸å¥½æ„æ€å›å¤çš„æ™šäº†ã€‚<br>ä½ æ˜¯è¯´ä¸â€œ14.jpeg æ˜¯å¼€ç¯‡ä¾‹å­çš„é‚£å¼ å›¾ç‰‡ï¼Œæ¨¡å‹è®¤ä¸ºå®ƒæ˜¯ Logo çš„æ¦‚ç‡æ˜¯ 0.58476ï¼Œothers ç±»çš„æ¦‚ç‡æ˜¯ 0.41524ã€‚â€è¿™æ®µè¯çš„é¢„æµ‹ç»“æœä¸ä¸€è‡´å—ï¼Ÿ<br>å¯èƒ½æœ‰å¾ˆå¤šåŸå› äº†ï¼Œè¾“å…¥çš„æ•°æ®æ˜¯å¦ä¸€è‡´ï¼Ÿæ¨¡å‹æ˜¯å¦ä¸€è‡´ï¼Ÿæ•°æ®çš„é¢„å¤„ç†æ˜¯å¦ä¸€è‡´è¿™æ ·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652409769,"ip_address":"","comment_id":344944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651889794","product_id":100093301,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘é¢„æµ‹ä»¥åçš„<br>prediction: tensor([[ 0.4958, -0.2352]], grad_fn=&lt;AddmmBackward0&gt;)","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571785,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚ä¸å¥½æ„æ€å›å¤çš„æ™šäº†ã€‚\nä½ æ˜¯è¯´ä¸â€œ14.jpeg æ˜¯å¼€ç¯‡ä¾‹å­çš„é‚£å¼ å›¾ç‰‡ï¼Œæ¨¡å‹è®¤ä¸ºå®ƒæ˜¯ Logo çš„æ¦‚ç‡æ˜¯ 0.58476ï¼Œothers ç±»çš„æ¦‚ç‡æ˜¯ 0.41524ã€‚â€è¿™æ®µè¯çš„é¢„æµ‹ç»“æœä¸ä¸€è‡´å—ï¼Ÿ\nå¯èƒ½æœ‰å¾ˆå¤šåŸå› äº†ï¼Œè¾“å…¥çš„æ•°æ®æ˜¯å¦ä¸€è‡´ï¼Ÿæ¨¡å‹æ˜¯å¦ä¸€è‡´ï¼Ÿæ•°æ®çš„é¢„å¤„ç†æ˜¯å¦ä¸€è‡´è¿™æ ·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652409769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344041,"user_name":"åšæŒ","can_delete":false,"product_type":"c1","uid":1509619,"ip_address":"","ucode":"7385D8E981CC95","user_header":"http://thirdwx.qlogo.cn/mmopen/uqaRIfRCAhJ6t1z92XYEzadRGelHJUZ5mXrausmIK72hVYYYFeQaOWmhmWt3e5863fOavRcibM5mREpObRUT0gH94QcnWoaYq/132","comment_is_top":false,"comment_ctime":1651205799,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1651205799","product_id":100093301,"comment_content":"è€å¸ˆï¼Œèƒ½ä¸èƒ½ä»‹ç»ä¸‹å¯¹æŠ—è®­ç»ƒçš„çŸ¥è¯†ã€‚advpropçœ‹äº†å¥½ä¼šæ‰çŸ¥é“æ˜¯å¯¹æŠ—è®­ç»ƒç›¸å…³çŸ¥è¯†","like_count":0,"discussions":[{"author":{"id":1509619,"avatar":"http://thirdwx.qlogo.cn/mmopen/uqaRIfRCAhJ6t1z92XYEzadRGelHJUZ5mXrausmIK72hVYYYFeQaOWmhmWt3e5863fOavRcibM5mREpObRUT0gH94QcnWoaYq/132","nickname":"åšæŒ","note":"","ucode":"7385D8E981CC95","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568735,"discussion_content":"# switch to train mode    \nmodel.train()\nè¿˜æœ‰è¯·é—®è€å¸ˆï¼Œè¿™å¥è¯è¿™é‡Œæ˜¯ä»€ä¹ˆç”¨é€”ï¼Œè·Ÿè¸ªä»£ç ä¹Ÿæœªè·Ÿè¸ªåˆ°æ˜¯è°ƒç”¨å“ªé‡Œçš„ä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651215202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343505,"user_name":"Zeurd","can_delete":false,"product_type":"c1","uid":2919792,"ip_address":"","ucode":"7CE1E0F76C3313","user_header":"https://static001.geekbang.org/account/avatar/00/2c/8d/70/b0047299.jpg","comment_is_top":false,"comment_ctime":1650881302,"is_pvip":true,"replies":[{"id":"125407","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>from_pretrainedåœ¨è¿™é‡Œhttps:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification&#47;blob&#47;main&#47;efficientnet&#47;model.py#L349<br>ä¼šæ ¹æ®å‚æ•°è‡ªåŠ¨ä¸‹è½½pretrainedæ¨¡å‹ã€‚<br><br>predict.pyæ˜¯ç”¨æ¥é¢„æµ‹çš„ã€‚<br><br>&gt;&gt;trainå’Œpredictæœ‰ä¸¤ä¸ª__nameçš„è°ƒç”¨ï¼Œè¿™ä¸ªæ˜¯ä¸ªåºŸçš„æ–‡ä»¶ä¹ˆï¼Ÿ<br>æ²¡å¤ªçœ‹æ‡‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1650940218,"ip_address":"","comment_id":343505,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650881302","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æƒ³è¯·é—®ä¸‹ï¼Œè¿™ä¸ªfrom_pretrainedå‡½æ•°æ˜¯efficientnetç½‘ç»œè‡ªå¸¦çš„å˜›ï¼Œè¿™ä¸ªç½‘ç»œä¹Ÿæ˜¯ç”¨ä¹‹å‰çš„models.efficientnet_b0(pretrained=True)ä¸‹è½½çš„ä¹ˆ?<br>ä»¥åŠï¼Œæ–‡ä»¶å¤¹ä¸­çš„predict.pyæ˜¯åšä»€ä¹ˆçš„ï¼Ÿtrainå’Œpredictæœ‰ä¸¤ä¸ª__nameçš„è°ƒç”¨ï¼Œè¿™ä¸ªæ˜¯ä¸ªåºŸçš„æ–‡ä»¶ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567628,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\nfrom_pretrainedåœ¨è¿™é‡Œhttps://github.com/syuu1987/geekTime-image-classification/blob/main/efficientnet/model.py#L349\nä¼šæ ¹æ®å‚æ•°è‡ªåŠ¨ä¸‹è½½pretrainedæ¨¡å‹ã€‚\n\npredict.pyæ˜¯ç”¨æ¥é¢„æµ‹çš„ã€‚\n\n&gt;&gt;trainå’Œpredictæœ‰ä¸¤ä¸ª__nameçš„è°ƒç”¨ï¼Œè¿™ä¸ªæ˜¯ä¸ªåºŸçš„æ–‡ä»¶ä¹ˆï¼Ÿ\nSorry. æ²¡å¤ªæ˜ç™½,å…·ä½“æŒ‡å“ªé‡Œ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650961881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335439,"user_name":"çˆ±ç å£«_ç§ƒå¤´å…”å­","can_delete":false,"product_type":"c1","uid":2823228,"ip_address":"","ucode":"D5AAC4E91D5A90","user_header":"https://static001.geekbang.org/account/avatar/00/2b/14/3c/e2ccea45.jpg","comment_is_top":false,"comment_ctime":1645519189,"is_pvip":false,"replies":[{"id":"122889","content":"helloï¼Œä½ è¿™ä¸ªæ˜¯ä¸‹è½½pretrainæ¨¡å‹æ—¶æŠ¥çš„é”™è¯¯å§ã€‚è¿™åº”è¯¥æ˜¯ä½ ç½‘ç»œçš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1646036843,"ip_address":"","comment_id":335439,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645519189","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œ æŒ‰ç…§readmeé‡Œé¢çš„è¿è¡Œæ–¹æ³•æŠ¥è¯·æ±‚é”™è¯¯.....<br> http.client.RemoteDisconnected: Remote end closed connection without response<br>","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553706,"discussion_content":"helloï¼Œä½ è¿™ä¸ªæ˜¯ä¸‹è½½pretrainæ¨¡å‹æ—¶æŠ¥çš„é”™è¯¯å§ã€‚è¿™åº”è¯¥æ˜¯ä½ ç½‘ç»œçš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646036843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327855,"user_name":"dndidoflbup","can_delete":false,"product_type":"c1","uid":1201908,"ip_address":"","ucode":"69B726F947065F","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/f4/6c57f148.jpg","comment_is_top":false,"comment_ctime":1640329331,"is_pvip":false,"replies":[{"id":"119378","content":"è¿™ä¸ªæ–‡ä»¶ä¾›å‚è€ƒï¼Œç›´æ¥ python train.pyå°±å¯ä»¥è¿è¡Œã€‚<br><br>https:&#47;&#47;github.com&#47;syuu1987&#47;geekTime-image-classification","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"1501385","ctime":1640336353,"ip_address":"","comment_id":327855,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1640329331","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œå›¾ç‰‡åœ¨å“ªå‘¢","like_count":0,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541345,"discussion_content":"è¿™ä¸ªæ–‡ä»¶ä¾›å‚è€ƒï¼Œç›´æ¥ python train.pyå°±å¯ä»¥è¿è¡Œã€‚\n\nhttps://github.com/syuu1987/geekTime-image-classification","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640336353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325747,"user_name":"Jasonå¼ ","can_delete":false,"product_type":"c1","uid":2806125,"ip_address":"","ucode":"FB9257940D7CCF","user_header":"https://static001.geekbang.org/account/avatar/00/2a/d1/6d/4a0eafc4.jpg","comment_is_top":false,"comment_ctime":1639115694,"is_pvip":false,"replies":[{"id":"118266","content":"hiï¼Œä½ å¥½ï¼ŒJasonã€‚æ„Ÿè°¢ç•™è¨€ã€‚<br>çœ‹èµ·æ¥æ˜¯æœ‰æ•°æ®åœ¨cpuä¸Šã€‚<br>å…·ä½“æ˜¯å“ªé‡ŒæŠ¥çš„é”™è¯¯å‘¢ï¼Ÿ<br>æ¨¡å‹ã€æŸå¤±ã€æ¨¡å‹è¾“å…¥çš„æ•°æ®ï¼ˆåŸå§‹å›¾ç‰‡ä¸çœŸå®å€¼ï¼‰éƒ½è¦åœ¨gpuä¸Šï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹çœ‹çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639358585,"ip_address":"","comment_id":325747,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639115694","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘èƒ½æˆåŠŸä½¿ç”¨GPUåŠ é€Ÿï¼Œåœ¨æ–‡ç¨¿ä¸­éœ€è¦åŠ cuda() çš„åœ°æ–¹éƒ½åŠ å…¥äº†.cuda()ä½†æ˜¯æŠ¥å‡ºäº†ä»¥ä¸‹é”™è¯¯ï¼šExpected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!ï¼Œæˆ‘æ˜¯å•æœºå•å¡ï¼Œæ•°æ®é›†é‡‡ç”¨çš„æ˜¯æˆ‘è‡ªå·±çš„åŒ»å­¦æ•°æ®é›†ï¼Œä½†æ˜¯å¥½åƒå‡ºäº†ä¸€äº›é—®é¢˜ã€‚è¿˜æœ›è€å¸ˆèµæ•™","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538165,"discussion_content":"hiï¼Œä½ å¥½ï¼ŒJasonã€‚æ„Ÿè°¢ç•™è¨€ã€‚\nçœ‹èµ·æ¥æ˜¯æœ‰æ•°æ®åœ¨cpuä¸Šã€‚\nå…·ä½“æ˜¯å“ªé‡ŒæŠ¥çš„é”™è¯¯å‘¢ï¼Ÿ\næ¨¡å‹ã€æŸå¤±ã€æ¨¡å‹è¾“å…¥çš„æ•°æ®ï¼ˆåŸå§‹å›¾ç‰‡ä¸çœŸå®å€¼ï¼‰éƒ½è¦åœ¨gpuä¸Šï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹çœ‹çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639358585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325635,"user_name":"clee","can_delete":false,"product_type":"c1","uid":1467446,"ip_address":"","ucode":"122875102B23A8","user_header":"","comment_is_top":false,"comment_ctime":1639054354,"is_pvip":false,"replies":[{"id":"118151","content":"ä½ å¥½ï¼Œæ”¶åˆ°ï¼Œæˆ‘çœ‹çœ‹ç„¶åç»™ä½ ç•™è¨€å“ˆã€‚<br>æœ‰å¾®ä¿¡ç¾¤ï¼Œæˆ‘è®©ç¼–è¾‘åŠ ä½ ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639102025,"ip_address":"","comment_id":325635,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1639054354","product_id":100093301,"comment_content":"ä½ å¥½è€å¸ˆï¼Œç»è¿‡ä¸€äº›æµ‹è¯•ï¼Œè¿˜æ˜¯æ— æ³•æ­£å¸¸é¢„æµ‹åˆ†ç±»ï¼Œæ²¡æœ‰æ‰¾åˆ°åŸå› ï¼Œæ–¹ä¾¿å¸®å¿™çœ‹ä¸‹ä»£ç å—ï¼Œä»£ç å·²è´´åˆ°colabä¸Šï¼šhttps:&#47;&#47;colab.research.google.com&#47;drive&#47;1IIw0BLlQb5lDXK7IMPx_KTzGaYQktiwV?usp=sharing#scrollTo=OJc9wArhKsnR<br>å·²ç»å°è¯•è¿‡çš„æ–¹æ³•ï¼š<br>1ã€è°ƒæ•´å­¦ä¹ ç‡0.01, 0.001<br>2ã€è°ƒæ•´epochï¼Œ10, 20, 50ï¼ˆlossä»0.662-&gt;0.0013ï¼‰<br>3ã€è°ƒæ•´è®­ç»ƒæ•°æ®é›†ï¼Œlogoæ•°æ®é›†æ²¡æœ‰æ‚¨çš„ä¸°å¯Œï¼Œä½†æ˜¯ä¹Ÿéƒ½æœ‰Logoï¼Œotheræ•°æ®é›†å°è¯•äº†åªæœ‰çŒ«å’ŒåŒ…å«å…¶ä»–åŠ¨ç‰©ä¸¤ç§æƒ…å†µï¼Œå¦‚æœOtherè®­ç»ƒé›†åªåŒ…å«çŒ«çš„è¯ï¼Œæ¨¡å‹è®­ç»ƒåï¼Œé¢„æµ‹éƒ½ä¸ºOtherï¼Œå¦åˆ™å…¶ä»–éƒ½é¢„æµ‹ä¸ºäº†Logo<br>å¦å¤–ï¼Œæœ‰å¾®ä¿¡ç¾¤å¯ä»¥è®¨è®ºå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537553,"discussion_content":"ä½ å¥½ï¼Œæ”¶åˆ°ï¼Œæˆ‘çœ‹çœ‹ç„¶åç»™ä½ ç•™è¨€å“ˆã€‚\næœ‰å¾®ä¿¡ç¾¤ï¼Œæˆ‘è®©ç¼–è¾‘åŠ ä½ ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639102025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537568,"discussion_content":"æˆ‘ç”¨ä½ çš„ä»£ç ï¼Œåœ¨æˆ‘çš„æ•°æ®ä¸Šè®­ç»ƒäº†ä¸€æ¬¡ã€‚ç»“æœæ²¡æœ‰é—®é¢˜ã€‚æˆ‘çš„å‚æ•°è®¾ç½®æ˜¯è¿™æ ·çš„ã€‚\nparser = argparse.ArgumentParser(description=u&#34;[+]----------------- å›¾åƒåˆ†ç±»Sample -----------------[+]&#34;)\n parser.add_argument(&#39;--train-data&#39;, default=&#39;./data/train&#39;, dest=&#39;train_data&#39;, help=&#39;location of train data&#39;)\n parser.add_argument(&#39;--image-size&#39;, default=224, dest=&#39;image_size&#39;, type=int, help=&#39;size of input image&#39;)\n parser.add_argument(&#39;--batch-size&#39;, default=10, dest=&#39;batch_size&#39;, type=int, help=&#39;batch size&#39;)\n parser.add_argument(&#39;--workers&#39;, default=4, dest=&#39;num_workers&#39;, type=int, help=&#39;worders number of Dataloader&#39;)\n parser.add_argument(&#39;--epochs&#39;, default=10, type=int, help=&#39;epochs&#39;)\n parser.add_argument(&#39;--lr&#39;,  default=0.001,type=float, help=&#39;learning rate&#39;)\n parser.add_argument(&#39;--checkpoint-dir&#39;, default=&#39;./ckpts/&#39;, dest=&#39;checkpoint_dir&#39;, help=&#39;location of checkpoint&#39;)\n parser.add_argument(&#39;--save-interval&#39;, default=1, dest=&#39;save_interval&#39;, type=int, help=&#39;save interval&#39;)\n parser.add_argument(&#39;--momentum&#39;, default=0.9, type=float, help=&#39;momentum&#39;)\n parser.add_argument(&#39;--weight-decay&#39;, default=1e-4, type=float, dest=&#39;weight_decay&#39;, help=&#39;weight decay&#39;)\n parser.add_argument(&#39;--arch&#39;, default=&#39;efficientnet-b0&#39;, help=&#39;arch type of EfficientNet&#39;)\n\næˆ‘æ¨æµ‹å¯èƒ½æ˜¯æ•°æ®çš„é—®é¢˜ã€‚\nä½ å¯ä»¥å…ˆåœ¨è®­ç»ƒé›†ä¸Šè¯„ä¼°ä¸€ä¸‹ï¼Œçœ‹çœ‹æ¨¡å‹ æœ‰æ²¡æœ‰å­¦åˆ°ã€‚\nè¿›å…¥å¾®ä¿¡ç¾¤ä¹‹åï¼Œä¹Ÿå¯ä»¥è‰¾ç‰¹æˆ‘ä¸€ä¸‹ï¼Œæˆ‘æŠŠæˆ‘çš„æ•°æ®å‘ç»™ä½ ï¼Œä½ å†è¯•è¯•ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639105893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538162,"discussion_content":"hiï¼Œä¸å¥½æ„æ€ã€‚\nä¹‹å‰å°±ç”¨ä½ çš„è®­ç»ƒä»£ç æµ‹è¯•äº†ä¸€ä¸‹ã€‚\nä»Šå¤©æƒ³åˆ°å¯èƒ½æ˜¯é¢„æµ‹ä»£ç æœ‰é—®é¢˜ã€‚\nä½ çš„é¢„æµ‹ä»£ç ä¸­æ²¡æœ‰åŠ model.eval(ï¼‰ï¼ŒåŠ ä¸Šè¿™å¥å°±å°±ä¸ä¼šæœ‰é—®é¢˜äº†ã€‚\nmodel.evalçš„ä½œç”¨åœ¨ç¬¬14èŠ‚è¯¾ä¸­è®²è¿‡ã€‚\n\nif __name__ == &#39;__main__&#39;:\n    parser = argparse.ArgumentParser()\n    parser.add_argument(&#39;--path&#39;, dest=&#39;path&#39;)\n    args = parser.parse_args()\n    model = EfficientNet.from_name(&#39;efficientnet-b0&#39;)\n    num_ftrs = model._fc.in_features\n    model._fc = nn.Linear(num_ftrs, 2)\n    model.load_state_dict(torch.load(&#39;./ckpts/checkpoint.pth.tar.epoch_9&#39;))\n    model.eval()\n    image = Image.open(args.path)\n    image = image.convert(&#39;RGB&#39;)\n    transform = build_transform(224)\n    input_tensor = transform(image).unsqueeze(0)\n    pred = model(input_tensor)\n    # pred = model(input_tensor).argmax()\n    print(&#34;prediction:&#34;, pred)\n\nå¾®ä¿¡æˆ‘å†è®©ä»–ä»¬åŠ ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639358304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325500,"user_name":"é©¬å…‹å›¾å¸ƒ","can_delete":false,"product_type":"c1","uid":1019274,"ip_address":"","ucode":"9E3879D6A55244","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/8a/ec29ca4a.jpg","comment_is_top":false,"comment_ctime":1639007828,"is_pvip":false,"replies":[{"id":"118098","content":"helloï¼Œæˆ‘ç”¨çš„PrettyTableã€‚<br>Pythoné‡Œä¸“é—¨å¼„è¡¨æ ¼çš„ã€‚^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639015614,"ip_address":"","comment_id":325500,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639007828","product_id":100093301,"comment_content":"è€å¸ˆçš„è¯„ä»·æ•ˆæœé‚£å¼ å›¾å¥½æ£’ï¼Œæ˜¯æœ‰ä»€ä¹ˆå‡½æ•°å¯ä»¥ç›´æ¥ç”Ÿæˆè¿™æ ·çš„æ‰“å°ç»“æœå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537260,"discussion_content":"helloï¼Œæˆ‘ç”¨çš„PrettyTableã€‚\nPythoné‡Œä¸“é—¨å¼„è¡¨æ ¼çš„ã€‚^^","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639015614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1019274,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/8a/ec29ca4a.jpg","nickname":"é©¬å…‹å›¾å¸ƒ","note":"","ucode":"9E3879D6A55244","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":537336,"discussion_content":"å¥½å˜ï¼Œè¿™å°±å»å­¦ï¼ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639035795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":537260,"ip_address":""},"score":537336,"extra":""}]}]},{"had_liked":false,"id":325165,"user_name":"å¾æ´²æ›´","can_delete":false,"product_type":"c1","uid":1314643,"ip_address":"","ucode":"F8A323CB732D05","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/53/92a50f01.jpg","comment_is_top":false,"comment_ctime":1638847001,"is_pvip":true,"replies":[{"id":"118004","content":"helloï¼Œåº”è¯¥ä¸è¡Œã€‚<br>å·ç§¯å­¦ä¹ ä¸åˆ°è¿™ä¹ˆç»†å¾®çš„ç‰¹å¾ã€‚èƒ½ä¸èƒ½å­µåŒ–å‡ºå°é¸¡ï¼Œä»å¤–è¡¨ä¸Šçœ‹é¸¡è›‹åº”è¯¥éƒ½æ˜¯ä¸€æ ·çš„å§ã€‚<br>ä¸è¿‡æ€è·¯æ˜¯å¯¹çš„ï¼Œå¦‚æœèƒ½ä¸èƒ½å­µåŒ–å°é¸¡çš„é¸¡è›‹æœ‰äº›ä»€ä¹ˆç‹¬ç‰¹çš„ç‰¹å¾çš„è¯ï¼Œæ˜¯å¯ä»¥åšåˆ°çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1638856622,"ip_address":"","comment_id":325165,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638847001","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå‡è®¾å­˜åœ¨ä¸€ä¸ªåœºæ™¯ï¼Œå°±æ˜¯æ‰‹é‡Œæœ‰ä¸€æ‰¹é¸¡è›‹ï¼Œä¸“ä¸šäººå£«èƒ½é€šè¿‡è‚‰çœ¼è§‚å¯Ÿé¸¡è›‹çš„å½¢æ€ï¼ˆç›¸å½“äºçœ‹ç…§ç‰‡ï¼‰æ¥æ¨æµ‹å‡ºé¸¡è›‹èƒ½ä¸èƒ½å­µåŒ–å‡ºå°é¸¡ï¼Œå¹¶ä¸”æœ‰å¾ˆé«˜çš„çš„å‡†ç¡®ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¦å¯¹ è¿™äº›é¸¡è›‹åˆ†åˆ«æ‹ç…§ï¼Œæ ¹æ®å®é™…çš„å­µåŒ–æƒ…å†µæ¥æ‰“æ ‡ç­¾ï¼Œæœ€åé€šè¿‡å·ç§¯ç½‘ç»œè¿›è¡Œåˆ†ç±»å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536725,"discussion_content":"helloï¼Œåº”è¯¥ä¸è¡Œã€‚\nå·ç§¯å­¦ä¹ ä¸åˆ°è¿™ä¹ˆç»†å¾®çš„ç‰¹å¾ã€‚èƒ½ä¸èƒ½å­µåŒ–å‡ºå°é¸¡ï¼Œä»å¤–è¡¨ä¸Šçœ‹é¸¡è›‹åº”è¯¥éƒ½æ˜¯ä¸€æ ·çš„å§ã€‚\nä¸è¿‡æ€è·¯æ˜¯å¯¹çš„ï¼Œå¦‚æœèƒ½ä¸èƒ½å­µåŒ–å°é¸¡çš„é¸¡è›‹æœ‰äº›ä»€ä¹ˆç‹¬ç‰¹çš„ç‰¹å¾çš„è¯ï¼Œæ˜¯å¯ä»¥åšåˆ°çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638856622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1314643,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/53/92a50f01.jpg","nickname":"å¾æ´²æ›´","note":"","ucode":"F8A323CB732D05","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536881,"discussion_content":"è°¢è°¢æ–¹è¿œè€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638887201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":536725,"ip_address":""},"score":536881,"extra":""}]}]},{"had_liked":false,"id":324916,"user_name":"Geek_a95f0e","can_delete":false,"product_type":"c1","uid":2824511,"ip_address":"","ucode":"C0B7418FD1D2B5","user_header":"","comment_is_top":false,"comment_ctime":1638715486,"is_pvip":false,"replies":[{"id":"117894","content":"hiï¼Œä½ å¥½ã€‚args.xxxæ˜¯ç¨‹åºéœ€è¦çš„å‚æ•°ï¼Œæ˜¯æ–‡ç« é‡Œé‚£ä¸ªè¡¨æ ¼ã€‚<br>å¯ä»¥åœ¨æ–‡ç« ä¸­æ‰¾è¿™æ®µè¯ã€‚<br>------<br>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠç¨‹åºéœ€è¦çš„å‚æ•°ç»™ä½ åˆ—ä¸€ä¸‹ï¼Œåœ¨ä¸‹é¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨è¿™äº›å‚æ•°äº†ã€‚å½“ä½ åœ¨å®ç°ä»Šå¤©ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦å°†è¿™äº›å‚æ•°è¡¥å……åˆ°ä»£ç ä¸­ï¼ˆå¯ä»¥ä½¿ç”¨ argparsem æ¨¡å—ï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1638769034,"ip_address":"","comment_id":324916,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1638715486","product_id":100093301,"comment_content":" æ–¹è€å¸ˆï¼Œè¯·é—®main()å‡½æ•°é‡Œçš„å„ç§args.xxxæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ èƒ½çŒœåˆ°æ˜¯ç±»ä¼¼å­—å…¸çš„ä¸œè¥¿ï¼Œä½†æ˜¯åœ¨å“ªé‡Œè¾“å…¥å‘¢ï¼Ÿ è¿™æ¬¡è¯¾ç¨‹çš„ä»£ç åœ¨jupyterä¸ŠæŠ¥é”™&#39;NameError: name &#39;args&#39; is not defined&#39;","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536362,"discussion_content":"hiï¼Œä½ å¥½ã€‚args.xxxæ˜¯ç¨‹åºéœ€è¦çš„å‚æ•°ï¼Œæ˜¯æ–‡ç« é‡Œé‚£ä¸ªè¡¨æ ¼ã€‚\nå¯ä»¥åœ¨æ–‡ç« ä¸­æ‰¾è¿™æ®µè¯ã€‚\n------\nåœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠç¨‹åºéœ€è¦çš„å‚æ•°ç»™ä½ åˆ—ä¸€ä¸‹ï¼Œåœ¨ä¸‹é¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨è¿™äº›å‚æ•°äº†ã€‚å½“ä½ åœ¨å®ç°ä»Šå¤©ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦å°†è¿™äº›å‚æ•°è¡¥å……åˆ°ä»£ç ä¸­ï¼ˆå¯ä»¥ä½¿ç”¨ argparsem æ¨¡å—ï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638769034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":2824511,"avatar":"","nickname":"Geek_a95f0e","note":"","ucode":"C0B7418FD1D2B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536380,"discussion_content":"å¥½çš„ï¼Œæ˜ç™½äº†ï¼Œè°¢è°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638774343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":536362,"ip_address":""},"score":536380,"extra":""},{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":2824511,"avatar":"","nickname":"Geek_a95f0e","note":"","ucode":"C0B7418FD1D2B5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536513,"discussion_content":"è§£å†³å°±å¥½ï¼Œç»§ç»­åŠ æ²¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638800621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":536380,"ip_address":""},"score":536513,"extra":""}]}]},{"had_liked":false,"id":323842,"user_name":"clee","can_delete":false,"product_type":"c1","uid":1467446,"ip_address":"","ucode":"122875102B23A8","user_header":"","comment_is_top":false,"comment_ctime":1638178677,"is_pvip":false,"replies":[{"id":"117539","content":"ä½ å¥½ï¼Œä»£ç çœ‹èµ·æ¥æ²¡æœ‰é—®é¢˜ã€‚å¯ä»¥çœ‹çœ‹æ•°æ®åˆ†å¸ƒæ˜¯å¦å¹³è¡¡ä¹ˆã€è®­ç»ƒæ—¶æ˜¯å¦ä½¿ç”¨pretrain modeläº†ä»¥åŠæ¨¡å‹æ˜¯å¦æ”¶æ•›äº†ã€‚<br><br>Tensorboardä¸­çš„lossä½ æ˜¯è¯´æ˜¯ä¸€æ¡ç›´çº¿å—ï¼Ÿç›´çº¿çš„æ•°å€¼ç­‰äºæœ€åä¸€ä¸ªepochçš„lossï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1638235116,"ip_address":"","comment_id":323842,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638178677","product_id":100093301,"comment_content":"ä½ å¥½ï¼Œè®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œä»ç»“æœæ¥çœ‹ï¼Œå¥½åƒéƒ½æ˜¯éƒ½è¢«åˆ†ç±»ä¸ºäº†Logoï¼Œå¯èƒ½å“ªå„¿å‡ºç°äº†é—®é¢˜å‘¢ï¼Ÿä»¥ä¸‹æ˜¯æµ‹è¯•ä»£ç ï¼Œå¦å¤–æœ‰ä¸ªé—®é¢˜æ˜¯ä»tensorboardè¿›è¡ŒLossæ•°æ®åˆ†æå‘ç°ï¼Œåªå±•ç¤ºæœ€åä¸€ä¸ªepochçš„Lossç‚¹ï¼Ÿ<br>    model = EfficientNet.from_name(&#39;efficientnet-b0&#39;)<br>    num_ftrs = model._fc.in_features<br>    model._fc = nn.Linear(num_ftrs, 2)<br>    model.load_state_dict(torch.load(&#39;.&#47;checkpoints&#47;checkpoint.pth.tar.epoch_19&#39;))<br>    image = Image.open(&#39;.&#47;data&#47;train&#47;logo&#47;09.jpg&#39;)<br>    transform = build_transform(224)<br>    input_tensor = transform(image).unsqueeze(0)<br>    pred = model(input_tensor)<br>    print(&quot;prediction:&quot;, pred)","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534574,"discussion_content":"ä½ å¥½ï¼Œä»£ç çœ‹èµ·æ¥æ²¡æœ‰é—®é¢˜ã€‚å¯ä»¥çœ‹çœ‹æ•°æ®åˆ†å¸ƒæ˜¯å¦å¹³è¡¡ä¹ˆã€è®­ç»ƒæ—¶æ˜¯å¦ä½¿ç”¨pretrain modeläº†ä»¥åŠæ¨¡å‹æ˜¯å¦æ”¶æ•›äº†ã€‚\n\nTensorboardä¸­çš„lossä½ æ˜¯è¯´æ˜¯ä¸€æ¡ç›´çº¿å—ï¼Ÿç›´çº¿çš„æ•°å€¼ç­‰äºæœ€åä¸€ä¸ªepochçš„lossï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638235116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322990,"user_name":"Geek_8cfc4c","can_delete":false,"product_type":"c1","uid":2156103,"ip_address":"","ucode":"83EF0B576530E2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7uYZvwhrLHsJICstGXaOvUNZnyq0aO7gF0OLicMyZAZFnRiaDyvM1lGxnEDP2VUMV3m6UjiazMmSNGQ/132","comment_is_top":false,"comment_ctime":1637680034,"is_pvip":false,"replies":[{"id":"117268","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€å’Œè®¤å¯ã€‚<br>model = EfficientNet.from_name(ï¼‰ä¹‹åéœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¨è¿æ¥å±‚çš„ç¥ç»å…ƒçš„æ•°ç›®ã€‚<br>å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è¯•è¯•ã€‚<br>ï¼ˆåº”è¯¥æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¯ä»¥è¿›å¾®ä¿¡ç¾¤ï¼ŒæŠŠä½ çš„ä»£ç å‘ç»™æˆ‘çœ‹çœ‹ï¼Œæˆ–è€…æ–°å¼€ä¸€ä¸ªç•™è¨€è®©æˆ‘å†çœ‹çœ‹æç¤ºä»€ä¹ˆä¿¡æ¯ã€‚^^ï¼‰<br><br>from efficientnet import EfficientNet<br>model = EfficientNet.from_name(&#39;efficientnet-b0&#39;)<br>num_ftrs = model._fc.in_features<br>model._fc = nn.Linear(num_ftrs, args.classes_num)<br><br>model.load_state_dict(torch.load(&#39;checkpoints&amp;#47;checkpoint.pth.tar.epoch_19&#39;)) <br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637733210,"ip_address":"","comment_id":322990,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637680034","product_id":100093301,"comment_content":"æ‚¨å¥½ï¼š<br><br>è®­ç»ƒå®Œæˆåï¼Œæˆ‘å°è¯•åŠ è½½checkpointé‡Œé¢æ¨¡å‹è¿›è¡Œæ¨æ–­ï¼Œä»£ç å¦‚ä¸‹<br>```<br>from efficientnet import EfficientNet<br>model = EfficientNet.from_name(&#39;efficientnet-b0&#39;)<br>model.load_state_dict(torch.load(&#39;checkpoints&#47;checkpoint.pth.tar.epoch_19&#39;))<br>```<br><br>ä½†æ˜¯å¾—åˆ°äº†å¦‚ä¸‹é”™è¯¯:<br>```<br>RuntimeError: Error(s) in loading state_dict for EfficientNet:<br>\tsize mismatch for _fc.weight: copying a param with shape torch.Size([2, 1280]) from checkpoint, the shape in current model is torch.Size([1000, 1280]).<br>\tsize mismatch for _fc.bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([1000]).<br>```<br><br>åœ¨æŸ¥çœ‹äº†ç½‘ç»œç»“æ„åï¼Œè®¡åˆ’ä¿®æ”¹weightå’Œbiasï¼Œä½†æ˜¯è¿™ä¹ˆæä¹Ÿä¸å¯¹â€¦â€¦<br>```model._fc.weight = torch.tensor(np.zeros((2,1280)))```<br><br>è¿˜æœ›èµæ•™<br>æ„Ÿè°¢æ‚¨ç²¾å½©çš„æ•™ç¨‹","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532919,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€å’Œè®¤å¯ã€‚\nmodel = EfficientNet.from_name(ï¼‰ä¹‹åéœ€è¦ä¿®æ”¹ä¸€ä¸‹å…¨è¿æ¥å±‚çš„ç¥ç»å…ƒçš„æ•°ç›®ã€‚\nå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è¯•è¯•ã€‚\nï¼ˆåº”è¯¥æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¯ä»¥è¿›å¾®ä¿¡ç¾¤ï¼ŒæŠŠä½ çš„ä»£ç å‘ç»™æˆ‘çœ‹çœ‹ï¼Œæˆ–è€…æ–°å¼€ä¸€ä¸ªç•™è¨€è®©æˆ‘å†çœ‹çœ‹æç¤ºä»€ä¹ˆä¿¡æ¯ã€‚^^ï¼‰\n\nfrom efficientnet import EfficientNet\nmodel = EfficientNet.from_name(&#39;efficientnet-b0&#39;)\nnum_ftrs = model._fc.in_features\nmodel._fc = nn.Linear(num_ftrs, args.classes_num)\n\nmodel.load_state_dict(torch.load(&#39;checkpoints&amp;#47;checkpoint.pth.tar.epoch_19&#39;)) \n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637733210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322880,"user_name":"ç‹ç","can_delete":false,"product_type":"c1","uid":2822974,"ip_address":"","ucode":"5074BA9DD3DE88","user_header":"https://static001.geekbang.org/account/avatar/00/2b/13/3e/d028cddd.jpg","comment_is_top":false,"comment_ctime":1637641896,"is_pvip":false,"replies":[{"id":"117235","content":"ğŸ‘ğŸ‘^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637669327,"ip_address":"","comment_id":322880,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637641896","product_id":100093301,"comment_content":"æ¨¡å‹èƒ½å°½å¯èƒ½çš„æŠŠçº¿ä¸Šæ‰€æœ‰æå®¢æ—¶é—´çš„æµ·æŠ¥éƒ½æ‰¾åˆ°ï¼Œåˆ™åº”è¯¥ä¾§é‡å¬å›ç‡ï¼Œå¬å›ç‡è¶Šé«˜è¶Šå¥½ã€‚","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532699,"discussion_content":"ğŸ‘ğŸ‘^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637669327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322725,"user_name":"Geek_a26208","can_delete":false,"product_type":"c1","uid":2813268,"ip_address":"","ucode":"19B96AC127BF8B","user_header":"","comment_is_top":false,"comment_ctime":1637567806,"is_pvip":false,"replies":[{"id":"117183","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚çœ‹èµ·æ¥ä¼¼ä¹æ—¥å¿—æ‰“å°æœ‰ç‚¹é—®é¢˜ã€‚ä¸€ä¸ªepochæ‰“å°äº†å¤šæ¬¡ã€‚<br>å¦‚æœæ²¡è§£å†³çš„è¯ï¼Œéœ€è¦æä¾›å†è¯¦ç»†ä¸€ç‚¹çš„ä¿¡æ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1637576412,"ip_address":"","comment_id":322725,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1637567806","product_id":100093301,"comment_content":"Epoch  18 tensor(0.5764, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  18 tensor(0.8147, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  19 tensor(0.3332, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  19 tensor(0.1257, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  19 tensor(0.2692, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  19 tensor(0.2975, grad_fn=&lt;NllLossBackward&gt;)<br>Epoch  19 tensor(0.1212, grad_fn=&lt;NllLossBackward&gt;)<br><br>è¿™ç»“æœæ˜¯ä»€ä¹ˆæƒ…å†µã€ã€ã€","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532323,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚çœ‹èµ·æ¥ä¼¼ä¹æ—¥å¿—æ‰“å°æœ‰ç‚¹é—®é¢˜ã€‚ä¸€ä¸ªepochæ‰“å°äº†å¤šæ¬¡ã€‚\nå¦‚æœæ²¡è§£å†³çš„è¯ï¼Œéœ€è¦æä¾›å†è¯¦ç»†ä¸€ç‚¹çš„ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637576412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2823414,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM5RJskfTOqjCBNJ7dH0Th9L4yPsC8bXSpEpnJTtIfIMx0ia6icOt6UluD0rxBh2vF4xibQKfxRGfr9EA/132","nickname":"Geek_8a391d","note":"","ucode":"7A56B872B72D9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537607,"discussion_content":"ä¸Šé¢è¡¨æ ¼ä¸­çš„å‚æ•°æ˜¯ç”¨-è¿æ¥çš„ï¼Œä»£ç é‡Œæ·»åŠ å‚æ•°æ—¶è¦æ”¹æˆä¸‹åˆ’çº¿_","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639117305,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2220867,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e3/43/c37cccbe.jpg","nickname":"ç”°ä¸¹ä¸¹","note":"","ucode":"50E2D6811C8651","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534456,"discussion_content":"ç²¾ç¡®ç‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638194653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}