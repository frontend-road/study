{"id":258101,"title":"08 | å¦‚ä½•åˆ©ç”¨ä¸‰è§’å‰–åˆ†å’Œå‘é‡æ“ä½œæè¿°å¹¶å¤„ç†å¤šè¾¹å½¢ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚</p><p>åœ¨å›¾å½¢ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬æœ€ç»ˆçœ‹åˆ°çš„ä¸°å¯Œå¤šå½©çš„å›¾åƒï¼Œéƒ½æ˜¯ç”±å¤šè¾¹å½¢æ„æˆçš„ã€‚æ¢å¥è¯è¯´ï¼Œä¸è®ºæ˜¯2Då›¾å½¢è¿˜æ˜¯3Då›¾å½¢ï¼Œç»è¿‡æŠ•å½±å˜æ¢åï¼Œåœ¨å±å¹•ä¸Šè¾“å‡ºçš„éƒ½æ˜¯å¤šè¾¹å½¢ã€‚å› æ­¤ï¼Œç†è§£å¤šè¾¹å½¢çš„åŸºæœ¬æ€§è´¨ï¼Œäº†è§£ç”¨æ•°å­¦è¯­è¨€æè¿°å¹¶ä¸”å¤„ç†å¤šè¾¹å½¢çš„æ–¹æ³•ï¼Œæ˜¯æˆ‘ä»¬åœ¨å¯è§†åŒ–ä¸­å¿…é¡»è¦æŒæ¡çš„å†…å®¹ã€‚</p><p>é‚£ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥è¯´è¯´ï¼Œä¸åŒçš„å›¾å½¢ç³»ç»Ÿæ˜¯å¦‚ä½•ç”¨æ•°å­¦è¯­è¨€æè¿°å¹¶å¤„ç†å¤šè¾¹å½¢ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è¯´è¯´å›¾å½¢å­¦ä¸­çš„å¤šè¾¹å½¢æ˜¯ä»€ä¹ˆã€‚</p><h2>å›¾å½¢å­¦ä¸­çš„å¤šè¾¹å½¢æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å¤šè¾¹å½¢å¯ä»¥å®šä¹‰ä¸ºç”±ä¸‰æ¡æˆ–ä¸‰æ¡ä»¥ä¸Šçš„çº¿æ®µé¦–å°¾è¿æ¥æ„æˆçš„å¹³é¢å›¾å½¢ï¼Œå…¶ä¸­ï¼Œæ¯æ¡çº¿æ®µçš„ç«¯ç‚¹å°±æ˜¯å¤šè¾¹å½¢çš„é¡¶ç‚¹ï¼Œçº¿æ®µå°±æ˜¯å¤šè¾¹å½¢çš„è¾¹ã€‚</p><p>å¤šè¾¹å½¢åˆå¯ä»¥åˆ†ä¸º<strong>ç®€å•å¤šè¾¹å½¢</strong>å’Œ<strong>å¤æ‚å¤šè¾¹å½¢</strong>ã€‚æˆ‘ä»¬è¯¥æ€ä¹ˆåŒºåˆ†å®ƒä»¬å‘¢ï¼Ÿå¦‚æœä¸€ä¸ªå¤šè¾¹å½¢çš„æ¯æ¡è¾¹é™¤äº†ç›¸é‚»çš„è¾¹ä»¥å¤–ï¼Œä¸å’Œå…¶ä»–è¾¹ç›¸äº¤ï¼Œé‚£å®ƒå°±æ˜¯ç®€å•å¤šè¾¹å½¢ï¼Œå¦åˆ™å°±æ˜¯å¤æ‚å¤šè¾¹å½¢ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨ç»˜å›¾æ—¶ï¼Œè¦å°½é‡æ„å»ºç®€å•å¤šè¾¹å½¢ï¼Œå› ä¸ºç®€å•å¤šè¾¹å½¢çš„å›¾å½¢æ€§è´¨æ¯”è¾ƒç®€å•ï¼Œç»˜åˆ¶èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>è€Œç®€å•å¤šè¾¹å½¢åˆåˆ†ä¸ºå‡¸å¤šè¾¹å½¢å’Œå‡¹å¤šè¾¹å½¢ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯çœ‹ç®€å•å¤šè¾¹å½¢çš„å†…è§’æ¥åŒºåˆ†çš„ã€‚å¦‚æœä¸€ä¸ªå¤šè¾¹å½¢ä¸­çš„æ¯ä¸ªå†…è§’éƒ½ä¸è¶…è¿‡180Â°ï¼Œé‚£å®ƒå°±æ˜¯å‡¸å¤šè¾¹å½¢ï¼Œå¦åˆ™å°±æ˜¯å‡¹å¤šè¾¹å½¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/74/4a/74c812ef3a15f5f20d7a5bbaff30794a.jpg?wh=859*334\" alt=\"\"></p><p>åœ¨å›¾å½¢ç³»ç»Ÿä¸­ç»˜åˆ¶å¤šè¾¹å½¢çš„æ—¶å€™ï¼Œæœ€å¸¸ç”¨çš„åŠŸèƒ½æ˜¯å¡«å……å¤šè¾¹å½¢ï¼Œä¹Ÿå°±æ˜¯ç”¨ä¸€ç§é¢œè‰²å°†å¤šè¾¹å½¢çš„å†…éƒ¨å¡«æ»¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨å¯è§†åŒ–ä¸­ç”¨æˆ·ç»å¸¸è¦ç”¨é¼ æ ‡ä¸å¤šè¾¹å½¢è¿›è¡Œäº¤äº’ï¼Œè¿™å°±è¦æ¶‰åŠå¤šè¾¹å½¢çš„è¾¹ç•Œåˆ¤å®šã€‚æ‰€ä»¥ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥é‡ç‚¹è®¨è®º<strong>å¤šè¾¹å½¢çš„å¡«å……å’Œè¾¹ç•Œåˆ¤å®š</strong>ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹å¤šè¾¹å½¢çš„å¡«å……ã€‚</p><!-- [[[read_end]]] --><h2>ä¸åŒçš„å›¾å½¢ç³»ç»Ÿå¦‚ä½•å¡«å……å¤šè¾¹å½¢ï¼Ÿ</h2><p>ä¸åŒçš„å›¾å½¢ç³»ç»Ÿä¼šç”¨ä¸åŒçš„æ–¹æ³•æ¥å¡«å……å¤šè¾¹å½¢ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨SVGå’ŒCanvas2Dä¸­ï¼Œå°±éƒ½å†…ç½®äº†å¡«å……å¤šè¾¹å½¢çš„APIã€‚åœ¨SVGä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™å…ƒç´ è®¾ç½®fillå±æ€§æ¥å¡«å……ï¼Œé‚£åœ¨Canvas2Dä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»˜å›¾æŒ‡ä»¤ç»“æŸæ—¶è°ƒç”¨fill()æ–¹æ³•è¿›è¡Œå¡«å……ã€‚è€Œåœ¨WebGLä¸­ï¼Œæˆ‘ä»¬æ˜¯ç”¨ä¸‰è§’å½¢å›¾å…ƒæ¥å¿«é€Ÿå¡«å……çš„ã€‚ç”±äºSVGå’ŒCanvas2Dä¸­çš„å¡«å……æ–¹æ³•ç±»ä¼¼ï¼Œå› æ­¤ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ä¸»è¦è¯´è¯´Canvas2Då’ŒWebGLæ˜¯æ€ä¹ˆå¡«å……å¤šè¾¹å½¢çš„ã€‚</p><h3>1. Canvas2Då¦‚ä½•å¡«å……å¤šè¾¹å½¢ï¼Ÿ</h3><p>æˆ‘ä»¬å…ˆæ¥è¯´è¯´Canvas2Då¡«å……å¤šè¾¹å½¢çš„å…·ä½“æ–¹æ³•ï¼Œå¯ä»¥æ€»ç»“ä¸ºäº”æ­¥ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œæ„å»ºå¤šè¾¹å½¢çš„é¡¶ç‚¹ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ„é€ 5ä¸ªé¡¶ç‚¹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const points = [new Vector2D(0, 100)];\nfor(let i = 1; i &lt;= 4; i++) {\n  const p = points[0].copy().rotate(i * Math.PI * 0.4);\n  points.push(p);\n}\n</code></pre><p>ç¬¬äºŒæ­¥ï¼Œç»˜åˆ¶å¤šè¾¹å½¢ã€‚æˆ‘ä»¬è¦ç”¨è¿™5ä¸ªé¡¶ç‚¹åˆ†åˆ«ç»˜åˆ¶æ­£äº”è¾¹å½¢å’Œæ­£äº”è§’æ˜Ÿã€‚æ˜¾ç„¶å‰è€…æ˜¯ç®€å•å¤šè¾¹å½¢ï¼Œåè€…æ˜¯å¤æ‚å¤šè¾¹å½¢ã€‚é‚£åœ¨Canvasä¸­ï¼Œåªéœ€å°†é¡¶ç‚¹æ„é€ å‡ºæ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡APIç»˜åˆ¶å‡ºå¤šè¾¹å½¢äº†ã€‚å…·ä½“ç»˜åˆ¶ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const polygon = [\n  ...points,\n];\n\n// ç»˜åˆ¶æ­£äº”è¾¹å½¢\nctx.save();\nctx.translate(-128, 0);\ndraw(ctx, polygon);\nctx.restore();\n\nconst stars = [\n  points[0],\n  points[2],\n  points[4],\n  points[1],\n  points[3],\n];\n\n// ç»˜åˆ¶æ­£äº”è§’æ˜Ÿ\nctx.save();\nctx.translate(128, 0);\ndraw(ctx, stars);\nctx.restore();\n</code></pre><p>å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬ç”¨è®¡ç®—å‡ºçš„5ä¸ªé¡¶ç‚¹åˆ›å»ºpolygonæ•°ç»„å’Œstarsæ•°ç»„ã€‚å…¶ä¸­ï¼Œpolygonæ•°ç»„æ˜¯æ­£äº”è¾¹å½¢çš„é¡¶ç‚¹æ•°ç»„ã€‚starsæ•°ç»„æ˜¯æˆ‘ä»¬æŠŠæ­£äº”è¾¹å½¢çš„é¡¶ç‚¹é¡ºåºäº¤æ¢ä¹‹åï¼Œæ„æˆçš„äº”è§’æ˜Ÿçš„é¡¶ç‚¹æ•°ç»„ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬å°†è¿™äº›ç‚¹ä¼ ç»™drawå‡½æ•°ï¼Œåœ¨drawå‡½æ•°ä¸­å®Œæˆå…·ä½“çš„ç»˜åˆ¶ã€‚åœ¨drawå‡½æ•°ä¸­ç»˜åˆ¶è¿‡ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯è°ƒç”¨context.fillæ¥å®Œæˆå¡«å……çš„ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘è¦è¡¥å……ä¸€ç‚¹ï¼Œä¸ç®¡æ˜¯ç®€å•å¤šè¾¹å½¢è¿˜æ˜¯å¤æ‚å¤šè¾¹å½¢ï¼ŒCanvas2Dçš„filléƒ½èƒ½æ­£å¸¸å¡«å……ã€‚å¹¶ä¸”ï¼ŒCanvas2Dçš„fillè¿˜æ”¯æŒä¸¤ç§å¡«å……è§„åˆ™ã€‚å…¶ä¸­ï¼Œé»˜è®¤çš„è§„åˆ™æ˜¯â€œnonzeroâ€ï¼Œä¹Ÿå°±æ˜¯è¯´ ä¸ç®¡æœ‰æ²¡æœ‰ç›¸äº¤çš„è¾¹ï¼Œåªè¦æ˜¯ç”±è¾¹å›´èµ·æ¥çš„åŒºåŸŸéƒ½ä¸€å¾‹å¡«å……ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯ç”¨â€œnonzeroâ€è§„åˆ™æ¥å¡«å……çš„ã€‚</p><pre><code>function draw(context, points, {\n  fillStyle = 'black',\n  close = false,\n  rule = 'nonzero',\n} = {}) {\n  context.beginPath();\n  context.moveTo(...points[0]);\n  for(let i = 1; i &lt; points.length; i++) {\n    context.lineTo(...points[i]);\n  }\n  if(close) context.closePath();\n  context.fillStyle = fillStyle;\n  context.fill(rule);\n}\n</code></pre><p>æˆ‘ä»¬æœ€ç»ˆç»˜åˆ¶å‡ºçš„æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/37/96/371e3b8d3f484b13aa13f6e8ce60ec96.jpeg?wh=1920*1080\" alt=\"\" title=\"ç®€å•å¤šè¾¹å½¢aå’Œb\"></p><p>é™¤äº†â€œnonzeroâ€ï¼Œè¿˜æœ‰ä¸€ç§è§„åˆ™å«åšâ€œevenoddâ€ï¼Œå®ƒæ˜¯æ ¹æ®é‡å åŒºåŸŸæ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°æ¥åˆ¤æ–­æ˜¯å¦å¡«å……çš„ã€‚é‚£å½“æˆ‘ä»¬å¢åŠ äº†drawæ–¹æ³•çš„å‚æ•°ï¼Œå°†äº”è§’æ˜Ÿçš„å¡«å……è§„åˆ™æ”¹æˆâ€œevenoddâ€ä¹‹åï¼Œç®€å•å¤šè¾¹å½¢æ²¡æœ‰å˜åŒ–ï¼Œè€Œå¤æ‚å¤šè¾¹å½¢ç”±äºç»˜åˆ¶åŒºåŸŸå­˜åœ¨é‡å ï¼Œå°±å‡ºå¯¼è‡´å›¾å½¢ä¸­å¿ƒæœ‰äº†ç©ºæ´çš„ç‰¹æ®Šæ•ˆæœã€‚</p><pre><code>draw(ctx, stars, {rule: 'evenodd'});\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/81/44/81e56244233ebec7e0cc50a661d2cf44.jpeg?wh=1920*1080\" alt=\"\" title=\"ä½¿ç”¨evenoddä¹‹åå¾—åˆ°çš„å¡«å……å›¾å½¢aå’Œb\"></p><p>æ€»ä¹‹ï¼ŒCanvas2Dçš„filléå¸¸å®ç”¨ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¡«å……å¤šè¾¹å½¢å†…éƒ¨çš„åŒºåŸŸï¼Œå¹¶ä¸”å¯¹äºä»»ä½•å¤šè¾¹å½¢éƒ½èƒ½åˆ¤å®šå’Œå¡«å……ï¼Œä½ å¯ä»¥è‡ªå·±å»å°è¯•ä¸€ä¸‹ã€‚</p><h3>2. WebGLå¦‚ä½•å¡«å……å¤šè¾¹å½¢ï¼Ÿ</h3><p>åœ¨WebGLä¸­ï¼Œè™½ç„¶æ²¡æœ‰æä¾›è‡ªåŠ¨å¡«å……å¤šè¾¹å½¢çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ä¸‰è§’å½¢è¿™ç§åŸºæœ¬å›¾å…ƒæ¥å¿«é€Ÿåœ°å¡«å……å¤šè¾¹å½¢ã€‚å› æ­¤ï¼Œåœ¨WebGLä¸­å¡«å……å¤šè¾¹å½¢çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å°†å¤šè¾¹å½¢åˆ†å‰²æˆå¤šä¸ªä¸‰è§’å½¢ã€‚</p><p>è¿™ç§å°†å¤šè¾¹å½¢åˆ†å‰²æˆè‹¥å¹²ä¸ªä¸‰è§’å½¢çš„æ“ä½œï¼Œåœ¨å›¾å½¢å­¦ä¸­å«åš<strong>ä¸‰è§’å‰–åˆ†</strong>ï¼ˆTriangulationï¼‰ã€‚</p><p><a href=\"http://wikipedia.org\"><img src=\"https://static001.geekbang.org/resource/image/61/dd/619872b8789bfaeb5fc2c1f0381d52dd.jpeg?wh=1920*1080\" alt=\"\" title=\"åŒä¸€ä¸ªå¤šè¾¹å½¢çš„ä¸¤ç§ä¸‰è§’å‰–åˆ†æ–¹æ³•\"></a></p><p>ä¸‰è§’å‰–åˆ†æ˜¯å›¾å½¢å­¦å’Œä»£æ•°æ‹“æ‰‘å­¦ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„åŸºæœ¬æ“ä½œï¼Œä¹Ÿæœ‰å¾ˆå¤šä¸åŒçš„å®ç°ç®—æ³•ã€‚å¯¹ç®€å•å¤šè¾¹å½¢å°¤å…¶æ˜¯å‡¸å¤šè¾¹å½¢çš„ä¸‰è§’å‰–åˆ†æ¯”è¾ƒç®€å•ï¼Œè€Œå¤æ‚å¤šè¾¹å½¢ç”±äºæœ‰è¾¹çš„ç›¸äº¤å’Œé¢ç§¯é‡å åŒºåŸŸï¼Œæ‰€ä»¥ç›¸å¯¹å›°éš¾è®¸å¤šã€‚</p><p>é‚£å› ä¸ºè¿™äº›ç®—æ³•è®²è§£èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œè¿˜ä¼šæ¶‰åŠå¾ˆå¤šå›¾å½¢å­¦çš„åº•å±‚æ•°å­¦çŸ¥è¯†ï¼Œä½ å¯èƒ½å¾ˆéš¾ç†è§£ï¼Œæ‰€ä»¥æˆ‘å°±ä¸è¯¦ç»†è¯´ä¸‰è§’å‰–åˆ†çš„å…·ä½“ç®—æ³•äº†ã€‚å¦‚æœä½ æœ‰å…´è¶£å­¦ä¹ ï¼Œå¯ä»¥è‡ªå·±èŠ±ä¸€ç‚¹æ—¶é—´å»çœ‹ä¸€äº›<a href=\"http://www.ae.metu.edu.tr/tuncer/ae546/prj/delaunay/\">å‚è€ƒèµ„æ–™</a>ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬å°±ç›´æ¥åˆ©ç”¨GitHubä¸Šçš„ä¸€äº›æˆç†Ÿçš„åº“ï¼ˆå¸¸ç”¨çš„å¦‚<a href=\"https://github.com/mapbox/earcut\">Earcut</a>ã€<a href=\"https://github.com/memononen/tess2.js\">Tess2.js</a>ä»¥åŠ<a href=\"https://github.com/mikolalysenko/cdt2d\">cdt2d</a>ï¼‰ï¼Œæ¥å¯¹å¤šè¾¹å½¢è¿›è¡Œä¸‰è§’å‰–åˆ†å°±å¯ä»¥äº†ã€‚å…·ä½“æ€ä¹ˆåšå‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä»¥æœ€ç®€å•çš„Earcutåº“ä¸ºä¾‹ï¼Œæ¥è¯´ä¸€è¯´WebGLå¡«å……å¤šè¾¹å½¢çš„è¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/28/9c/28716416aa8c00743843ae208089c99c.jpeg?wh=1920*1080\" alt=\"\" title=\"ç®€å•å¤šè¾¹å½¢c\"></p><p>å‡è®¾ï¼Œæˆ‘ä»¬è¦å¡«å……ä¸€ä¸ªå¦‚ä¸Šå›¾æ‰€ç¤ºçš„ä¸è§„åˆ™å¤šè¾¹å½¢ï¼Œå®ƒçš„é¡¶ç‚¹æ•°æ®å¦‚ä¸‹ï¼š</p><pre><code>const vertices = [\n  [-0.7, 0.5],\n  [-0.4, 0.3],\n  [-0.25, 0.71],\n  [-0.1, 0.56],\n  [-0.1, 0.13],\n  [0.4, 0.21],\n  [0, -0.6],\n  [-0.3, -0.3],\n  [-0.6, -0.3],\n  [-0.45, 0.0],\n];\n</code></pre><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å¯¹å®ƒè¿›è¡Œä¸‰è§’å‰–åˆ†ã€‚ä½¿ç”¨Earcutåº“çš„æ“ä½œå¾ˆç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨å®ƒçš„APIå°±å¯ä»¥å®Œæˆå¯¹å¤šè¾¹å½¢çš„ä¸‰è§’å‰–åˆ†ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>import {earcut} from '../common/lib/earcut.js';\n\nconst points = vertices.flat();\nconst triangles = earcut(points);\n</code></pre><p>å› ä¸ºEarcutåº“åªæ¥å—æ‰å¹³åŒ–çš„å®šç‚¹æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç”¨äº†æ•°ç»„çš„flatæ–¹æ³•å°†é¡¶ç‚¹æ‰å¹³åŒ–ï¼Œç„¶åå°†å®ƒä¼ ç»™Earcutè¿›è¡Œä¸‰è§’å‰–åˆ†ã€‚è¿™æ ·è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„çš„å€¼æ˜¯é¡¶ç‚¹æ•°æ®çš„indexï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre><code> [1, 0, 9, 9, 8, 7, 7, 6, 5, 4, 3, 2, 2, 1, 9, 9, 7, 5, 4, 2, 9, 9, 5, 4]\n</code></pre><p>è¿™é‡Œçš„å€¼ï¼Œæ¯”å¦‚1è¡¨ç¤ºverticesä¸­ä¸‹æ ‡ä¸º1çš„é¡¶ç‚¹ï¼Œå³ç‚¹(-0.4, 0.3)ï¼Œæ¯ä¸‰ä¸ªå€¼å¯ä»¥æ„æˆä¸€ä¸ªä¸‰è§’å½¢ï¼Œæ‰€ä»¥1ã€0ã€9è¡¨ç¤ºç”±(-0.4, 0.3)ã€(-0.7, 0.5)å’Œ(-0.45, 0.0) æ„æˆçš„ä¸‰è§’å½¢ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å°†é¡¶ç‚¹å’Œindexä¸‹æ ‡æ•°æ®éƒ½è¾“å…¥åˆ°ç¼“å†²åŒºï¼Œé€šè¿‡gl.drawElementsæ–¹æ³•å°±å¯ä»¥æŠŠå›¾å½¢æ˜¾ç¤ºå‡ºæ¥ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const position = new Float32Array(points);\nconst cells = new Uint16Array(triangles);\n\n\nconst pointBuffer = gl.createBuffer();\ngl.bindBuffer(gl.ARRAY_BUFFER, pointBuffer);\ngl.bufferData(gl.ARRAY_BUFFER, position, gl.STATIC_DRAW);\n\n\nconst vPosition = gl.getAttribLocation(program, 'position');\ngl.vertexAttribPointer(vPosition, 2, gl.FLOAT, false, 0, 0);\ngl.enableVertexAttribArray(vPosition);\n\n\nconst cellsBuffer = gl.createBuffer();\ngl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cellsBuffer);\ngl.bufferData(gl.ELEMENT_ARRAY_BUFFER, cells, gl.STATIC_DRAW);\n\n\ngl.clear(gl.COLOR_BUFFER_BIT);\ngl.drawElements(gl.TRIANGLES, cells.length, gl.UNSIGNED_SHORT, 0);\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/61/26/614e29911f76757a56159ca2d080a526.jpeg?wh=1920*1080\" alt=\"\"></p><p>ä½ ä¼šå‘ç°ï¼Œé€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæ•´ä¸ªå¤šè¾¹å½¢éƒ½è¢«WebGLæ¸²æŸ“å¹¶å¡«å……ä¸ºäº†çº¢è‰²ã€‚è¿™ä¹ˆä¸€çœ‹ï¼Œå¥½åƒä¸‰è§’å‰–åˆ†å¹¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚ä½†å®é™…ä¸Šï¼ŒWebGLæ˜¯å¯¹è¿™ä¸ªå¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†åçš„æ¯ä¸ªä¸‰è§’å½¢åˆ†åˆ«è¿›è¡Œå¡«å……çš„ã€‚ä¸ºäº†è®©ä½ çœ‹å¾—æ›´æ¸…æ¥šï¼Œæˆ‘ä»¬ç”¨æè¾¹ä»£æ›¿å¡«å……ï¼Œå…·ä½“æ“ä½œå°±æ˜¯ï¼Œä¿®æ”¹ä¸€ä¸‹gl.drawElementsçš„æ¸²æŸ“æ¨¡å¼ï¼Œå°†gl.TRIANGLESæ”¹æˆgl.LINE_STRIPã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¸…æ™°åœ°çœ‹å‡ºï¼Œç»è¿‡Earcutå¤„ç†çš„è¿™ä¸ªå¤šè¾¹å½¢è¢«åˆ†å‰²æˆäº†8ä¸ªä¸‰è§’å½¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/54/72/549f33d96886fa2bf04f92d30f9ea972.jpeg?wh=1920*1080\" alt=\"\"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±è®²å®Œäº†2Då›¾å½¢çš„ä¸‰è§’å‰–åˆ†ã€‚é‚£é’ˆå¯¹3Dæ¨¡å‹ï¼ŒWebGLåœ¨ç»˜åˆ¶çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨ä¸‰è§’å‰–åˆ†ï¼Œè€Œ3Dçš„ä¸‰è§’å‰–åˆ†åˆè¢«ç§°ä¸º<strong>ç½‘æ ¼åŒ–</strong>ï¼ˆMeshingï¼‰ã€‚</p><p>ä¸è¿‡ï¼Œå› ä¸º3Dæ¨¡å‹æ¯”2Dæ¨¡å‹æ›´åŠ å¤æ‚ï¼Œé¡¶ç‚¹çš„æ•°é‡æ›´å¤šï¼Œæ‰€ä»¥é’ˆå¯¹å¤æ‚çš„3Dæ¨¡å‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸åœ¨è¿è¡Œçš„æ—¶å€™è¿›è¡Œä¸‰è§’å‰–åˆ†ï¼Œè€Œæ˜¯é€šè¿‡è®¾è®¡å·¥å…·æŠŠå›¾å½¢çš„ä¸‰è§’å‰–åˆ†ç»“æœç›´æ¥å¯¼å‡ºè¿›è¡Œä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨3Dæ¸²æŸ“çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„æ¨¡å‹æ•°æ®éƒ½æ˜¯å·²ç»ç»è¿‡ä¸‰è§’å‰–åˆ†ä»¥åçš„é¡¶ç‚¹æ•°æ®ã€‚</p><p>é‚£å¦‚æœå¿…é¡»è¦åœ¨å¯è§†åŒ–é¡¹ç›®ä¸­å®æ—¶åˆ›å»ºä¸€äº›å‡ ä½•ä½“çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘ä»¬ä¼šåœ¨è§†è§‰ç¯‡è¯¦ç»†æ¥è®²ï¼Œä¸è¿‡åœ¨é‚£ä¹‹å‰å‘¢ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å…ˆæƒ³æƒ³ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œæ— è®ºæ˜¯ç»˜åˆ¶2Dè¿˜æ˜¯3Då›¾å½¢ï¼ŒWebGLéƒ½éœ€è¦å…ˆæŠŠå®ƒä»¬è¿›è¡Œä¸‰è§’å‰–åˆ†ï¼Œç„¶åæ‰èƒ½ç»˜åˆ¶ã€‚å› æ­¤ï¼Œä¸‰è§’å‰–åˆ†æ˜¯WebGLç»˜å›¾çš„åŸºç¡€ã€‚</p><h2>å¦‚ä½•åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨ï¼Ÿ</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´è¯´å¤šè¾¹å½¢çš„äº¤äº’ã€‚è¿™ä¸ªä¾‹å­è¦å®ç°çš„æ•ˆæœå…¶å®å°±æ˜¯ï¼Œå½“ç”¨æˆ·çš„é¼ æ ‡ç§»åŠ¨åˆ°æŸä¸€ä¸ªå›¾å½¢ä¸Šæ—¶ï¼Œæˆ‘ä»¬è¦è®©è¿™ä¸ªå›¾å½¢å˜è‰²ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼šåˆ¤å®šé¼ æ ‡æ‰€åœ¨ä½ç½®æ˜¯å¦åœ¨å¤šè¾¹å½¢çš„å†…éƒ¨ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸åŒçš„å›¾å½¢ç³»ç»Ÿéƒ½æ˜¯å¦‚ä½•åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨çš„å‘¢ï¼Ÿ</p><p>åœ¨SVGè¿™æ ·çš„å›¾å½¢ç³»ç»Ÿé‡Œï¼Œç”±äºå¤šè¾¹å½¢æœ¬èº«å°±æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥é€šè¿‡DOM APIå°±å¯ä»¥åˆ¤å®šé¼ æ ‡æ˜¯å¦åœ¨è¯¥å…ƒç´ ä¸Šã€‚è€Œå¯¹äºCanvas2Dï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡DOM APIåˆ¤å®šï¼Œè€Œæ˜¯è¦é€šè¿‡Canvas2Dæä¾›çš„isPointInPathæ–¹æ³•æ¥åˆ¤å®šã€‚æ‰€ä»¥ä¸‹é¢ï¼Œæˆ‘ä»¬å°±ä»¥å¤šè¾¹å½¢cä¸ºä¾‹ï¼Œæ¥è¯¦ç»†è¯´è¯´è¿™ä¸ªè¿‡ç¨‹ã€‚</p><h3>1.  Canvas2Då¦‚ä½•åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨ï¼Ÿ</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ”¹ç”¨Canvas2Dæ¥ç»˜åˆ¶å¹¶å¡«å……è¿™ä¸ªå¤šè¾¹å½¢ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨canvasä¸Šæ·»åŠ mousemoveäº‹ä»¶ï¼Œåœ¨äº‹ä»¶ä¸­è®¡ç®—é¼ æ ‡ç›¸å¯¹äºcanvasçš„ä½ç½®ï¼Œå†å°†è¿™ä¸ªä½ç½®ä¼ ç»™isPointInPathæ–¹æ³•ï¼ŒisPointInPathæ–¹æ³•å°±ä¼šè‡ªåŠ¨åˆ¤æ–­è¿™ä¸ªä½ç½®æ˜¯å¦ä½äºå›¾å½¢å†…éƒ¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const {left, top} = canvas.getBoundingClientRect();\n\ncanvas.addEventListener('mousemove', (evt) =&gt; {\n  const {x, y} = evt;\n  // åæ ‡è½¬æ¢\n  const offsetX = x - left;\n  const offsetY = y - top;\n\n  ctx.clearRect(-256, -256, 512, 512);\n\n  if(ctx.isPointInPath(offsetX, offsetY)) {\n    draw(ctx, poitions, 'transparent', 'green');\n  } else {\n    draw(ctx, poitions, 'transparent', 'red');\n  }\n});\n</code></pre><p>æœ€åï¼Œä¸Šé¢ä»£ç è¿è¡Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/97/4f370d3187e964efc733294a3ed2de97.gif?wh=632*421\" alt=\"\"></p><p>è¿™ä¸ªè¿è¡Œç»“æœæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†isPointInPathè¿™ä¸ªæ–¹æ³•å®é™…ä¸Šå¹¶ä¸å¥½ç”¨ã€‚å› ä¸ºisPointInPathæ–¹æ³•åªèƒ½å¯¹å½“å‰ç»˜åˆ¶çš„å›¾å½¢ç”Ÿæ•ˆã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ã€‚</p><p>å‡è®¾ï¼Œæˆ‘ä»¬è¦åœ¨Canvasä¸­ç»˜åˆ¶å¤šè¾¹å½¢cå’Œå°ä¸‰è§’å½¢ã€‚é‚£æˆ‘ä»¬å…ˆç»˜åˆ¶å¤šè¾¹å½¢cï¼Œå†ç»˜åˆ¶å°ä¸‰è§’å½¢ã€‚ç»˜åˆ¶ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>draw(ctx, poitions, 'transparent', 'red');\ndraw(ctx, [[100, 100], [100, 200], [150, 200]], 'transparent', 'blue');\n\nconst {left, top} = canvas.getBoundingClientRect();\n\ncanvas.addEventListener('mousemove', (evt) =&gt; {\n  const {x, y} = evt;\n  // åæ ‡è½¬æ¢\n  const offsetX = x - left;\n  const offsetY = y - top;\n  \n  ctx.clearRect(-256, -256, 512, 512);\n  \n  // åˆ¤æ–­ offsetXã€offsetY çš„åæ ‡æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…éƒ¨\n  if(ctx.isPointInPath(offsetX, offsetY)) {\n    draw(ctx, poitions, 'transparent', 'green');\n    draw(ctx, [[100, 100], [100, 200], [150, 200]], 'transparent', 'orange');\n  } else {\n    draw(ctx, poitions, 'transparent', 'red');\n    draw(ctx, [[100, 100], [100, 200], [150, 200]], 'transparent', 'blue');\n  }\n});\n</code></pre><p>è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜é€šè¿‡isPointInPathæ–¹æ³•åˆ¤æ–­ç‚¹çš„ä½ç½®ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/5e/3e/5e566597db9519bcb0fdc09ce6390e3e.gif?wh=637*422\" alt=\"\"></p><p>ä½ ä¼šçœ‹åˆ°ï¼Œå½“æˆ‘ä»¬å°†é¼ æ ‡ç§»åŠ¨åˆ°ä¸­é—´å¤§å›¾æ—¶ï¼Œå®ƒçš„é¢œè‰²å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåªæœ‰ç§»åŠ¨åˆ°å³ä¸Šè§’çš„å°ä¸‰è§’å½¢æ—¶ï¼Œè¿™ä¸¤ä¸ªå›¾å½¢æ‰ä¼šåŒæ—¶å˜è‰²ã€‚è¿™å°±æ˜¯å› ä¸ºï¼ŒisPointInPathä»…èƒ½åˆ¤æ–­é¼ æ ‡æ˜¯å¦åœ¨æœ€åä¸€æ¬¡ç»˜åˆ¶çš„å°ä¸‰è§’å½¢å†…ï¼Œæ‰€ä»¥å¤§å¤šè¾¹å½¢å°±æ²¡æœ‰è¢«è¯†åˆ«å‡ºæ¥ã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ï¼Œæˆ‘ä»¬è‡ªå·±å®ç°ä¸€ä¸ªisPointInPathæ–¹æ³•ã€‚ç„¶ååœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ªCanvaså¯¹è±¡ï¼Œå¹¶ä¸”å†ç»˜åˆ¶ä¸€éå¤šè¾¹å½¢cå’Œå°ä¸‰è§’å½¢ã€‚è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒï¼Œå…¶å®å°±æ˜¯åœ¨ç»˜åˆ¶çš„è¿‡ç¨‹ä¸­è·å–æ¯ä¸ªå›¾å½¢çš„isPointInPathç»“æœã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>function isPointInPath(ctx, x, y) {\n  // æˆ‘ä»¬æ ¹æ®ctxé‡æ–°cloneä¸€ä¸ªæ–°çš„canvaså¯¹è±¡å‡ºæ¥\n  const cloned = ctx.canvas.cloneNode().getContext('2d');\n  cloned.translate(0.5 * width, 0.5 * height);\n  cloned.scale(1, -1);\n  let ret = false;\n  // ç»˜åˆ¶å¤šè¾¹å½¢cï¼Œç„¶ååˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å›¾å½¢å†…éƒ¨\n  draw(cloned, poitions, 'transparent', 'red');\n  ret |= cloned.isPointInPath(x, y);\n  if(!ret) {\n    // å¦‚æœä¸åœ¨ï¼Œåœ¨ç»˜åˆ¶å°ä¸‰è§’å½¢ï¼Œç„¶ååˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å›¾å½¢å†…éƒ¨\n    draw(cloned, [[100, 100], [100, 200], [150, 200]], 'transparent', 'blue');\n    ret |= cloned.isPointInPath(x, y);\n  }\n  return ret;\n}\n</code></pre><p>ä½†æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸é€šç”¨ã€‚å› ä¸ºä¸€æ—¦æˆ‘ä»¬ä¿®æ”¹äº†ç»˜å›¾è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å¢åŠ æˆ–è€…å‡å°‘äº†ç»˜åˆ¶çš„å›¾å½¢ï¼ŒisPointInPathæ–¹æ³•ä¹Ÿè¦è·Ÿç€æ”¹å˜ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰åŠæ³•è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚å°†æ¯ä¸€ä¸ªå‡ ä½•å›¾å½¢çš„ç»˜åˆ¶å°è£…èµ·æ¥ï¼Œé’ˆå¯¹æ¯ä¸ªå›¾å½¢æä¾›å•ç‹¬çš„isPointInPathåˆ¤æ–­ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿå¾ˆéº»çƒ¦ï¼Œè€Œä¸”æœ‰å¾ˆå¤šæ— è°“çš„Canvasç»˜å›¾æ“ä½œï¼Œæ€§èƒ½ä¼šå¾ˆå·®ã€‚</p><h3>2. å®ç°é€šç”¨çš„isPointInPathæ–¹æ³•</h3><p>é‚£ä¸€ä¸ªæ›´å¥½çš„åŠæ³•æ˜¯ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨Canvasçš„isPointInPathæ–¹æ³•ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç‚¹ä¸å‡ ä½•å›¾å½¢çš„æ•°å­¦å…³ç³»æ¥åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å›¾å½¢å†…ã€‚ä½†æ˜¯ï¼Œç›´æ¥åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯ä¸æ˜¯åœ¨ä¸€ä¸ªå‡ ä½•å›¾å½¢å†…è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå› ä¸ºè¿™ä¸ªå‡ ä½•å›¾å½¢å¯èƒ½æ˜¯ç®€å•å¤šè¾¹å½¢ï¼Œä¹Ÿå¯èƒ½æ˜¯å¤æ‚å¤šè¾¹å½¢ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠè§†çº¿æ”¾åœ¨æœ€ç®€å•çš„å¤šè¾¹å½¢ï¼Œä¹Ÿå°±æ˜¯ä¸‰è§’å½¢ä¸Šã€‚å› ä¸ºå¯¹äºä¸‰è§’å½¢æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹æ³•å¯ä»¥åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å…¶ä¸­ã€‚</p><p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯ï¼Œå·²çŸ¥ä¸€ä¸ªä¸‰è§’å½¢çš„ä¸‰æ¡è¾¹åˆ†åˆ«æ˜¯å‘é‡aã€bã€cï¼Œå¹³é¢ä¸Šä¸€ç‚¹uè¿æ¥ä¸‰è§’å½¢ä¸‰ä¸ªé¡¶ç‚¹çš„å‘é‡åˆ†åˆ«ä¸ºu<sub>1</sub>ã€u<sub>2</sub>ã€u<sub>3</sub>ï¼Œé‚£ä¹ˆuç‚¹åœ¨ä¸‰è§’å½¢å†…éƒ¨çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼šu<sub>1</sub> X aã€u<sub>2</sub> X bã€u<sub>3</sub> X c çš„ç¬¦å·ç›¸åŒã€‚</p><p>ä½ ä¹Ÿå¯ä»¥çœ‹æˆ‘ä¸‹é¢ç»™å‡ºçš„ç¤ºæ„å›¾ï¼Œå½“ç‚¹uåœ¨ä¸‰è§’å½¢aã€bã€cå†…æ—¶ï¼Œå› ä¸ºu<sub>1</sub>åˆ°aã€u<sub>2</sub>åˆ°bã€u<sub>3</sub>åˆ°cçš„å°è§’æ—‹è½¬æ–¹å‘æ˜¯ç›¸åŒçš„ï¼ˆè¿™é‡Œéƒ½ä¸ºé¡ºæ—¶é’ˆï¼‰ï¼Œæ‰€ä»¥u<sub>1</sub> X aã€u<sub>2</sub> X bã€u<sub>3</sub> X cè¦ä¹ˆåŒæ­£ï¼Œè¦ä¹ˆåŒè´Ÿã€‚å½“ç‚¹våœ¨ä¸‰è§’å½¢å¤–æ—¶ï¼Œv<sub>1</sub>åˆ°aæ–¹å‘æ˜¯é¡ºæ—¶é’ˆï¼Œv<sub>2</sub>åˆ°bæ–¹å‘æ˜¯é€†æ—¶é’ˆï¼Œv<sub>3</sub>åˆ°cæ–¹å‘åˆæ˜¯é¡ºæ—¶é’ˆï¼Œæ‰€ä»¥å®ƒä»¬å‰ä¹˜çš„ç»“æœç¬¦å·å¹¶ä¸ç›¸åŒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/34/c3/3402b08454dbc39f9543cb4c597419c3.jpg?wh=1920*1080\" alt=\"\"></p><p>æ ¹æ®è¿™ä¸ªåŸç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„åˆ¤å®šå‡½æ•°äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>function inTriangle(p1, p2, p3, point) {\n  const a = p2.copy().sub(p1);\n  const b = p3.copy().sub(p2);\n  const c = p1.copy().sub(p3);\n\n  const u1 = point.copy().sub(p1);\n  const u2 = point.copy().sub(p2);\n  const u3 = point.copy().sub(p3);\n\n  const s1 = Math.sign(a.cross(u1));\n  const s2 = Math.sign(b.cross(u2));\n  const s3 = Math.sign(c.cross(u3));\n\n  return s1 === s2 &amp;&amp; s2 === s3;\n}\n</code></pre><p>ä½ ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿè¿˜æ²¡æœ‰ã€‚ä¸Šé¢çš„ä»£ç è¿˜æœ‰ä¸ªBugï¼Œå®ƒè™½ç„¶å¯ä»¥åˆ¤å®šç‚¹åœ¨ä¸‰è§’å½¢å†…éƒ¨ï¼Œä½†å´ä¸èƒ½åˆ¤å®šç‚¹æ°å¥½åœ¨ä¸‰è§’å½¢æŸæ¡è¾¹ä¸Šçš„æƒ…å†µã€‚è¿™åˆè¯¥å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ</p><p>åœ¨å­¦ä¹ äº†å‘é‡ä¹˜æ³•ä¹‹åï¼Œæˆ‘ä»¬çŸ¥é“ã€‚å¦‚æœä¸€ä¸ªç‚¹uåœ¨ä¸‰è§’å½¢çš„ä¸€æ¡è¾¹aä¸Šï¼Œé‚£å°±ä¼šéœ€è¦æ»¡è¶³ä»¥ä¸‹2ä¸ªæ¡ä»¶ï¼š</p><ol>\n<li>a.cross(u1) === 0</li>\n<li>0 &lt;= a.dot(u1) / a.length ** 2 &lt;= 1</li>\n</ol><p>ç¬¬ä¸€ä¸ªæ¡ä»¶å¾ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘å°±ä¸ç»†è¯´äº†ï¼Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹ç¬¬äºŒä¸ªæ¡ä»¶ã€‚ä¸‹é¢ï¼Œæˆ‘å°±åˆ†åˆ«è®¨è®ºä¸€ä¸‹ç‚¹uå’Œaåœ¨ä¸€æ¡ç›´çº¿ä¸Šå’Œä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Šè¿™ä¸¤ç§æƒ…å†µã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/8e/ca37834a201b3d704fe40ef3955b608e.jpg?wh=1920*1080\" alt=\"\" title=\"å·¦å›¾æ˜¯ç‚¹uå’Œaä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼Œå³å›¾æ˜¯ç‚¹uå’Œaåœ¨ä¸€æ¡ç›´çº¿ä¸Š\n\"></p><p>å½“å‘é‡u<sub>1</sub>ä¸aä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Šæ—¶ï¼Œu<sub>1</sub>ä¸açš„å‰ä¹˜ç»“æœä¸ä¸º0ï¼Œè€Œu<sub>1</sub>ä¸açš„ç‚¹ä¹˜çš„å€¼é™¤ä»¥açš„é•¿åº¦ï¼Œç›¸å½“äºu<sub>1</sub>åœ¨aä¸Šçš„æŠ•å½±ã€‚</p><p>å½“å‘é‡u<sub>1</sub>ä¸aåœ¨ä¸€æ¡ç›´çº¿ä¸Šæ—¶ï¼Œu<sub>1</sub>ä¸açš„å‰ä¹˜ç»“æœä¸º0ï¼Œu<sub>1</sub>ä¸açš„ç‚¹ä¹˜ç»“æœé™¤ä»¥açš„é•¿åº¦çš„å¹³æ–¹ï¼Œæ­£å¥½æ˜¯u<sub>1</sub>ä¸açš„æ¯”å€¼ã€‚</p><p>u<sub>1</sub>ä¸açš„æ¯”å€¼ä¹Ÿæœ‰ä¸‰ç§æƒ…å†µï¼šå½“u<sub>1</sub>åœ¨aä¸Šæ—¶ï¼Œu<sub>1</sub>å’Œaæ¯”å€¼æ˜¯ä»‹äº0åˆ°1ä¹‹é—´çš„ï¼›å½“u<sub>1</sub>åœ¨açš„å·¦è¾¹æ—¶ï¼Œè¿™ä¸ªæ¯”å€¼æ˜¯å°äº0çš„ï¼›å½“u1åœ¨açš„å³è¾¹æ—¶ï¼Œè¿™ä¸ªæ¯”å€¼æ˜¯å¤§äº1çš„ã€‚</p><p>å› æ­¤ï¼Œåªæœ‰å½“u1å’Œaçš„æ¯”å€¼åœ¨0åˆ°1ä¹‹é—´æ—¶ï¼Œæ‰èƒ½è¯´æ˜ç‚¹åœ¨ä¸‰è§’å½¢çš„è¾¹ä¸Šã€‚</p><p>å¥½äº†ï¼Œé‚£æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å¾—åˆ°çš„ç»“æœä¿®æ”¹ä¸€ä¸‹ä»£ç ã€‚æˆ‘ä»¬æœ€ç»ˆçš„åˆ¤æ–­é€»è¾‘å¦‚ä¸‹ï¼š</p><pre><code>function inTriangle(p1, p2, p3, point) {\n  const a = p2.copy().sub(p1);\n  const b = p3.copy().sub(p2);\n  const c = p1.copy().sub(p3);\n\n  const u1 = point.copy().sub(p1);\n  const u2 = point.copy().sub(p2);\n  const u3 = point.copy().sub(p3);\n\n  const s1 = Math.sign(a.cross(u1));\n  let p = a.dot(u1) / a.length ** 2;\n  if(s1 === 0 &amp;&amp; p &gt;= 0 &amp;&amp; p &lt;= 1) return true;\n\n  const s2 = Math.sign(b.cross(u2));\n  p = b.dot(u2) / b.length ** 2;\n  if(s2 === 0 &amp;&amp; p &gt;= 0 &amp;&amp; p &lt;= 1) return true;\n\n  const s3 = Math.sign(c.cross(u3));\n  p = c.dot(u3) / c.length ** 2;\n  if(s3 === 0 &amp;&amp; p &gt;= 0 &amp;&amp; p &lt;= 1) return true;\n\n  return s1 === s2 &amp;&amp; s2 === s3;\n}\n</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±åˆ¤æ–­äº†ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨æŸä¸ªä¸‰è§’å½¢å†…éƒ¨ã€‚é‚£å¦‚æœè¦åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä»»æ„å¤šè¾¹å½¢çš„å†…éƒ¨ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åˆ¤æ–­ä¹‹å‰å°†å®ƒè¿›è¡Œä¸‰è§’å‰–åˆ†å°±å¯ä»¥äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>function isPointInPath({vertices, cells}, point) {\n  let ret = false;\n  for(let i = 0; i &lt; cells.length; i += 3) {\n    const p1 = new Vector2D(...vertices[cells[i]]);\n    const p2 = new Vector2D(...vertices[cells[i + 1]]);\n    const p3 = new Vector2D(...vertices[cells[i + 2]]);\n    if(inTriangle(p1, p2, p3, point)) {\n      ret = true;\n      break;\n    }\n  }\n  return ret;\n}\n</code></pre><h2>è¦ç‚¹æ€»ç»“</h2><p>æœ¬èŠ‚è¯¾ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨ä¸‰è§’å‰–åˆ†æ¥å¡«å……å¤šè¾¹å½¢ä»¥åŠåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…éƒ¨ã€‚</p><p>ä¸åŒçš„å›¾å½¢ç³»ç»Ÿæœ‰ç€ä¸åŒçš„å¤„ç†æ–¹æ³•ï¼ŒCanvas2Dçš„å¤„ç†å¾ˆç®€å•ï¼Œå®ƒå¯ä»¥ä½¿ç”¨åŸç”Ÿçš„fillæ¥å¡«å……ä»»æ„å¤šè¾¹å½¢ï¼Œä½¿ç”¨isPointInPathæ¥åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…éƒ¨ã€‚ä½†æ˜¯ï¼Œä¸‰è§’å‰–åˆ†æ˜¯æ›´åŠ é€šç”¨çš„æ–¹å¼ï¼ŒWebGLå°±æ˜¯ä½¿ç”¨ä¸‰è§’å‰–åˆ†æ¥å¤„ç†å¤šè¾¹å½¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç‰¢è®°å®ƒçš„æ“ä½œã€‚</p><p>é¦–å…ˆï¼Œåœ¨ä½¿ç”¨ä¸‰è§’å‰–åˆ†å¡«å……å¤šè¾¹å½¢æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€äº›æˆç†Ÿåº“çš„APIå°±å¯ä»¥å®Œæˆï¼Œè¿™å¹¶ä¸éš¾ã€‚è€Œå½“æˆ‘ä»¬è¦å®ç°å›¾å½¢å’Œç”¨æˆ·çš„äº¤äº’æ—¶ï¼Œä¹Ÿå°±æ˜¯è¦åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…éƒ¨æ—¶ï¼Œä¹Ÿéœ€è¦å…ˆå¯¹å¤šè¾¹å½¢è¿›è¡Œä¸‰è§’å‰–åˆ†ï¼Œç„¶ååˆ¤æ–­è¯¥ç‚¹æ˜¯å¦åœ¨å…¶ä¸­ä¸€ä¸ªä¸‰è§’å½¢å†…éƒ¨ã€‚</p><h2>å°è¯•ç‰›åˆ€</h2><ol>\n<li>\n<p>åœ¨è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Earcutå¯¹å¤šè¾¹å½¢è¿›è¡Œä¸‰è§’å‰–åˆ†ã€‚ä½†æ˜¯tess2.jsæ˜¯ä¸€ä¸ªæ¯”Earcutæ›´å¼ºå¤§çš„ä¸‰è§’å‰–åˆ†åº“ï¼Œä½¿ç”¨tess2.jså¯ä»¥åƒåŸç”Ÿçš„Canvas2Dçš„fillæ–¹æ³•é‚£æ ·ï¼Œå®ç°evenoddçš„å¡«å……è§„åˆ™ã€‚ä½ èƒ½è¯•ç€æŠŠä»£ç ä¸­çš„earcutæ¢æˆtess2.jsï¼Œä»è€Œå®ç°evenoddå¡«å……è§„åˆ™å—ï¼ŸåŠ¨æ‰‹ä¹‹å‰ï¼Œä½ å¯ä»¥å…ˆå»è¯»ä¸€ä¸‹tess2.jsçš„é¡¹ç›®æ–‡æ¡£ã€‚</p>\n</li>\n<li>\n<p>ä»Šå¤©æˆ‘ä»¬ç”¨ä¸‰è§’å‰–åˆ†å®ç°äº†ä¸è§„åˆ™å¤šè¾¹å½¢ã€‚é‚£ä½ èƒ½è¯•ç€åˆ©ç”¨ä¸‰è§’å‰–åˆ†çš„åŸç†ï¼Œé€šè¿‡WebGLç”»å‡ºæ¤­åœ†å›¾æ¡ˆã€è±å½¢çš„æ˜Ÿæ˜Ÿå›¾æ¡ˆï¼ˆâœ¦ï¼‰ï¼Œä»¥åŠæ­£äº”è§’æ˜Ÿå—ï¼Ÿ</p>\n</li>\n</ol><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œåˆ†äº«ä½ çš„ç­”æ¡ˆå’Œæ€è€ƒï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p><hr><h2><span class=\"reference\">æºç </span></h2><p><span class=\"reference\"><a href=\"https://github.com/akira-cn/graphics/tree/master/triangluations\">ä½¿ç”¨ä¸‰è§’å‰–åˆ†å¡«å……å¤šè¾¹å½¢ã€åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨çš„å®Œæ•´ä»£ç </a></span></p><h2><span class=\"reference\">æ¨èé˜…è¯»</span></h2><p><span class=\"reference\"> <a href=\"https://github.com/memononen/tess2.js\">tess2.jså®˜æ–¹æ–‡æ¡£</a></span></p>","comments":[{"had_liked":false,"id":233250,"user_name":"gltjk","can_delete":false,"product_type":"c1","uid":1341515,"ip_address":"","ucode":"A2ACFE7D8A32C5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ7hqBj1WIXVJgRwxVEg7fREAwI04BKRM8ibzVA8DIOaLSLqIrjw8UYr9GDUFFZW7mhBLC4hSp5r9g/132","comment_is_top":false,"comment_ctime":1594270987,"is_pvip":false,"replies":[{"id":"86302","content":"èµğŸ‘èƒ½åŠ¨æ‰‹è‡ªå·±åšéå¸¸æ£’ï¼Œå¤šå®è·µå¯ä»¥å¿«é€Ÿå­¦ä¹ æˆé•¿ã€‚webglä¸Šæ‰‹ä¸å¤ªå®¹æ˜“ï¼Œä¸è¿‡æŒæ¡äº†å­¦ä¹ è¯€çªï¼Œæ‰“å¥½åŸºç¡€ï¼Œåé¢å°±è¶Šæ¥è¶Šå®¹æ˜“äº†ï¼Œè€Œä¸”ä¼šè§‰å¾—è¶Šæ¥è¶Šæœ‰è¶£","user_name":"ä½œè€…å›å¤","comment_id":233250,"uid":"1159792","ip_address":"","utype":1,"ctime":1594452984,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"40248976651","product_id":100053801,"comment_content":"åœ¨ä¹‹å‰ä»£ç çš„åŸºç¡€ä¸Šå°è£…äº† Canvas ç±»å’Œè‡ªå·±çš„ Vector2D ç±»ï¼ŒåŒæ—¶å¢åŠ ç®€å•çš„ WebGL ç±»ï¼ˆå…¶ä¸­å°è£…äº†ç”¨ Tesser2 ä¸‰è§’å‰–åˆ†å®ç°çš„ç”»å¤šè¾¹å½¢æ–¹æ³•ï¼‰ï¼Œç„¶åè¯•äº†è¯•å°è¯•ç‰›åˆ€é‡Œè¦æ±‚çš„æ¤­åœ†ã€æ­£äº”è§’æ˜Ÿå’Œè±å½¢æ˜Ÿæ˜Ÿã€‚å› ä¸ºæ–‡ä»¶æ¯”è¾ƒå¤šï¼Œä¸ç”¨ Codepen äº†ï¼Œæ”¹ç”¨ Github æ”¾ä»£ç ã€‚<br>ä¹‹åæœ‰æ—¶é—´å†æŠŠåˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨åšå‡ºæ¥ï¼ŒåŒæ—¶æŠŠä¹‹å‰ Codepen çš„ä¾‹å­è¿ç§»è¿‡æ¥ã€‚<br>è¯è¯´æ„Ÿè§‰ WebGL å¥½æ·±å¥¥å•Šï¼Œå¯èƒ½æˆ‘è¿é—¨éƒ½æ²¡ç®—å…¥å§â€¦â€¦<br><br>åœ¨çº¿é¢„è§ˆï¼šhttps:&#47;&#47;g.gltjk.com&#47;learn-visualization&#47;canvas-webgl-polygon&#47;<br><br>ä»£ç ä»“åº“ï¼šhttps:&#47;&#47;github.com&#47;gltjk&#47;learn-visualization","like_count":9,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500959,"discussion_content":"èµğŸ‘èƒ½åŠ¨æ‰‹è‡ªå·±åšéå¸¸æ£’ï¼Œå¤šå®è·µå¯ä»¥å¿«é€Ÿå­¦ä¹ æˆé•¿ã€‚webglä¸Šæ‰‹ä¸å¤ªå®¹æ˜“ï¼Œä¸è¿‡æŒæ¡äº†å­¦ä¹ è¯€çªï¼Œæ‰“å¥½åŸºç¡€ï¼Œåé¢å°±è¶Šæ¥è¶Šå®¹æ˜“äº†ï¼Œè€Œä¸”ä¼šè§‰å¾—è¶Šæ¥è¶Šæœ‰è¶£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594452984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1384326,"avatar":"https://static001.geekbang.org/account/avatar/00/15/1f/86/3a7eeac4.jpg","nickname":"leslee","note":"","ucode":"DB1CBF9F8D16BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326507,"discussion_content":"è€é“ï¼Œç‚¹åˆ°ç›´çº¿çš„è·ç¦»å“ªé‡Œï¼ŒPNä¸‹é¢çš„N è¿™ä¸ªå‘é‡æœ‰ç©ºå¯ä»¥åŠ ç‚¹æ³¨é‡Šä¹ˆã€‚æ„Ÿè°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605609526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234414,"user_name":"PresbyterğŸ±","can_delete":false,"product_type":"c1","uid":1244819,"ip_address":"","ucode":"E52F076FE898DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/fe/93/31869247.jpg","comment_is_top":false,"comment_ctime":1594687965,"is_pvip":false,"replies":[{"id":"86496","content":"åœ¨ç¬¬9è®²çš„æœ€åæˆ‘æ”¾äº†ä¸€å¼ å›¾ï¼Œåˆ—å‡ºäº†æ‰€æœ‰çš„çŸ¥è¯†ç‚¹ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":234414,"uid":"1159792","ip_address":"","utype":1,"ctime":1594690181,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"14479589853","product_id":100053801,"comment_content":"è€å¸ˆï¼Œæ²¡è„¸çš„é—®ä¸€å¥ã€‚è‡ªå·±å·²ç»è¦ç–¯äº†ï¼Œå¾ˆå¤šæ•°å­¦æ¦‚å¿µå·²ç»ä¸æ˜ç™½äº†ã€‚ç°åœ¨åœ¨æ¶è¡¥çº¿æ€§ä»£æ•°ï¼Œç„¶ååœ¨å›æ¥çœ‹æ–‡ç« ã€‚è€å¸ˆèƒ½éº»çƒ¦ä¸€ä¸‹ï¼Œç»™å‡ºå’±ä»¬è¿™ä¸ªè¯¾ç¨‹æ‰€éœ€è¦çš„æ•°å­¦çŸ¥è¯†å˜›ï¼Ÿæˆ‘å¥½ä¸€æ¬¡æ€§éƒ½çœ‹äº†ï¼Œç„¶åä¸€ç‚¹ä¸€ç‚¹çš„åœ¨é‡æ–°è¯»å’±ä»¬æ–‡ç« ã€‚éº»çƒ¦è€å¸ˆäº†ã€‚","like_count":3,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501381,"discussion_content":"åœ¨ç¬¬9è®²çš„æœ€åæˆ‘æ”¾äº†ä¸€å¼ å›¾ï¼Œåˆ—å‡ºäº†æ‰€æœ‰çš„çŸ¥è¯†ç‚¹ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594690181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236906,"user_name":"å­™å","can_delete":false,"product_type":"c1","uid":2045306,"ip_address":"","ucode":"E3A0FE38CFA4C8","user_header":"https://static001.geekbang.org/account/avatar/00/1f/35/7a/c0498c0b.jpg","comment_is_top":false,"comment_ctime":1595580826,"is_pvip":false,"replies":[{"id":"87568","content":"å› ä¸ºLINE_STRIPæ˜¯ç»˜åˆ¶è¿ç»­çº¿æ®µï¼Œæ‰€ä»¥æœ€ç»ˆæ¯ä¸ªç‚¹åªç»è¿‡ä¸€æ¬¡ï¼Œå°±ä¼šå‡ºç°å››è¾¹å½¢ã€‚ä¸è¿‡è¿™é‡Œåªæ˜¯å¤§æ¦‚åœ°æ˜¾ç¤ºå‡ºä¸‰è§’å½¢å½¢çŠ¶ï¼Œæ‰€ä»¥æ²¡å…³ç³»ã€‚å¦‚æœè¦ä¸¥æ ¼æ˜¾ç¤ºå‡ºå„ä¸ªä¸‰è§’å½¢ï¼Œéœ€è¦æ”¹ä¸€ä¸‹æ•°æ®ï¼ŒæŠŠæ¯ä¸ªé¡¶ç‚¹å’Œå®ƒçš„ä¸‰è§’å½¢çš„å…¶ä»–é¡¶ç‚¹å¯¹åº”çš„è¾¹æ•°æ®é‡æ–°å­˜ä¸€ä¸‹ç„¶åç”¨LINESç»˜åˆ¶","user_name":"ä½œè€…å›å¤","comment_id":236906,"uid":"1159792","ip_address":"","utype":1,"ctime":1595643217,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"10185515418","product_id":100053801,"comment_content":"æœˆå½±å¤§ä½¬<br>WebGL fill çš„ä¾‹å­ä¸­<br>ä¿®æ”¹ä¸€ä¸‹ gl.drawElements çš„æ¸²æŸ“æ¨¡å¼ï¼Œå°† gl.TRIANGLES æ”¹æˆ gl.LINE_STRIPã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¸…æ™°åœ°çœ‹å‡ºï¼Œç»è¿‡ Earcut å¤„ç†çš„è¿™ä¸ªå¤šè¾¹å½¢è¢«åˆ†å‰²æˆäº† 8 ä¸ªä¸‰è§’å½¢ã€‚<br>ä½†ä¾‹å­å±•ç¤ºçš„ç»“æœä¸­åªæœ‰6ä¸ªä¸‰è§’å½¢å’Œä¸€ä¸ªå››è¾¹å½¢ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502249,"discussion_content":"å› ä¸ºLINE_STRIPæ˜¯ç»˜åˆ¶è¿ç»­çº¿æ®µï¼Œæ‰€ä»¥æœ€ç»ˆæ¯ä¸ªç‚¹åªç»è¿‡ä¸€æ¬¡ï¼Œå°±ä¼šå‡ºç°å››è¾¹å½¢ã€‚ä¸è¿‡è¿™é‡Œåªæ˜¯å¤§æ¦‚åœ°æ˜¾ç¤ºå‡ºä¸‰è§’å½¢å½¢çŠ¶ï¼Œæ‰€ä»¥æ²¡å…³ç³»ã€‚å¦‚æœè¦ä¸¥æ ¼æ˜¾ç¤ºå‡ºå„ä¸ªä¸‰è§’å½¢ï¼Œéœ€è¦æ”¹ä¸€ä¸‹æ•°æ®ï¼ŒæŠŠæ¯ä¸ªé¡¶ç‚¹å’Œå®ƒçš„ä¸‰è§’å½¢çš„å…¶ä»–é¡¶ç‚¹å¯¹åº”çš„è¾¹æ•°æ®é‡æ–°å­˜ä¸€ä¸‹ç„¶åç”¨LINESç»˜åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595643217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312790,"user_name":"è‚å£«ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1102126,"ip_address":"","ucode":"C1624B259BB34E","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/2e/ad6315ab.jpg","comment_is_top":false,"comment_ctime":1632021551,"is_pvip":true,"replies":[{"id":"114128","content":"æ˜¯çš„ï¼Œå¯ä»¥ä¼˜åŒ–","user_name":"ä½œè€…å›å¤","comment_id":312790,"uid":"1159792","ip_address":"","utype":1,"ctime":1633750003,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"5926988847","product_id":100053801,"comment_content":"å…·ä½“å®ç°çš„ç®—æ³•è¿˜éœ€è¦å…ˆåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å¤–æ¥æ¡†çŸ©å½¢å†…ï¼Œå¯ä»¥åŠ é€Ÿ","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527113,"discussion_content":"æ˜¯çš„ï¼Œå¯ä»¥ä¼˜åŒ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633750003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253926,"user_name":"Geek_b52974","can_delete":false,"product_type":"c1","uid":1298252,"ip_address":"","ucode":"59884399646620","user_header":"","comment_is_top":false,"comment_ctime":1602948908,"is_pvip":true,"replies":[{"id":"93051","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","comment_id":253926,"uid":"1159792","ip_address":"","utype":1,"ctime":1603354242,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"5897916204","product_id":100053801,"comment_content":"ç®€å•æ ¹æ®è€å¸ˆç»™çš„å»¶ä¼¸è¿ç»“è§£é‡Šä¸€ä¸‹ä¸‰è§’å‰–åˆ†<br>1.  ä»»ç›¸é‚»çš„ä¸¤ä¸ªä¸‰è§’å½¢ä¸€å®šæ˜¯ç»„æˆä¸€ä¸ªå››è¾¹å½¢ï¼Œä¸ä¼šæ˜¯äº”è¾¹å½¢ï¼Œå…­è¾¹å½¢<br>2. ä»»ä¸€ä¸‰è§’å½¢çš„å¤–åŒ…åœ†ä¸å¯åŒ…å«å…¶ä»–ä¸‰è§’å½¢çš„é¡¶ç‚¹<br>3. è·Ÿ Voronoi diagram æ˜¯ä¸€ä½“ä¸¤é¢çš„æ¦‚å¿µï¼Œä¸‰è§’å‰–åˆ†ä¸­çš„ä¸‰è§’å½¢çš„è¾¹çš„ä¸­å‚çº¿ç›¸è¿ä¼šæˆä¸º Voronoi diagram ä¸­çš„æ¯ä¸ªå¤šè¾¹å‹ï¼Œä¸‰è§’å‰–åˆ†ä¸­çš„é¡¶ç‚¹ç§°ä¸º Voronoi generators ","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507222,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603354242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2064214,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7f/56/1ab5931f.jpg","nickname":"Herve","note":"","ucode":"25941E69C75D16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351048,"discussion_content":"ä¸ä¸€å®šæ˜¯å››è¾¹å½¢ï¼Œåé¢ä¸¤æ¡æ²¡çœ‹æ‡‚å•¥æ„æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614135395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252569,"user_name":"å˜»å˜»","can_delete":false,"product_type":"c1","uid":1373304,"ip_address":"","ucode":"BE59D46445F568","user_header":"https://static001.geekbang.org/account/avatar/00/14/f4/78/9953da19.jpg","comment_is_top":false,"comment_ctime":1602385984,"is_pvip":false,"replies":[{"id":"92601","content":"å…·ä½“å®ç°æ–¹å¼è¦ç ”ç©¶æµè§ˆå™¨åº•å±‚å®ç°çš„æºç ã€‚æˆ‘è§‰å¾—åº”è¯¥æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":252569,"uid":"1159792","ip_address":"","utype":1,"ctime":1602815384,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"5897353280","product_id":100053801,"comment_content":"è¯è¯´æµè§ˆå™¨çš„apiåˆ¤æ–­æ˜¯å¦åœ¨è·¯å¾„å†…åº”è¯¥ä¹Ÿæ˜¯ç”¨çš„æ•°å­¦æ–¹æ³•å§(ï½€ï½¥Ï‰ï½¥Â´)ã‚","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506807,"discussion_content":"å…·ä½“å®ç°æ–¹å¼è¦ç ”ç©¶æµè§ˆå™¨åº•å±‚å®ç°çš„æºç ã€‚æˆ‘è§‰å¾—åº”è¯¥æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602815384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347775,"user_name":"Geek_1c5d1b","can_delete":false,"product_type":"c1","uid":2262803,"ip_address":"","ucode":"F96C738FEB50A9","user_header":"","comment_is_top":false,"comment_ctime":1654417636,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654417636","product_id":100053801,"comment_content":"åˆ¤æ–­æ˜¯å¦åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼Œè¡Œåˆ—å¼ == 0 ä¸” å‘é‡ç‚¹ä¹˜ä¸aå‘é‡é•¿åº¦çš„å¹³æ–¹ æ¯”å€¼åœ¨0åˆ°1ä¹‹é—´ å³å¯","like_count":0},{"had_liked":false,"id":336155,"user_name":"é«˜å°”å¤«","can_delete":false,"product_type":"c1","uid":1137463,"ip_address":"","ucode":"FEE20AD4A57365","user_header":"https://static001.geekbang.org/account/avatar/00/11/5b/37/8cf84372.jpg","comment_is_top":false,"comment_ctime":1645958798,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645958798","product_id":100053801,"comment_content":"gl.drawElements æ˜¯ä½¿ç”¨ç´¢å¼•æ¥æ¸²æŸ“ï¼Œå‰é¢04è®²çš„gl.drawArraysæ˜¯ç›´æ¥è¯»å–æ•°ç»„æ¥æ¸²æŸ“ï¼ŒæŠ±æ­‰å­¦çš„å¤ªæ…¢äº†ã€‚","like_count":0},{"had_liked":false,"id":329636,"user_name":"Geek_9a30ab","can_delete":false,"product_type":"c1","uid":2068385,"ip_address":"","ucode":"4019658B9BA93F","user_header":"https://static001.geekbang.org/account/avatar/00/1f/8f/a1/5482b927.jpg","comment_is_top":false,"comment_ctime":1641453878,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1641453878","product_id":100053801,"comment_content":" const poitions = vertices.map(([x, y]) =&gt; [x * 256, y * 256]);<br>è€å¸ˆï¼Œæˆ‘çœ‹ä½ app2d.js è¿™é‡Œè¦ä¹˜ä»¥256ï¼Œè¯·é—®256æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„å‘¢ï¼Ÿ<br>","like_count":1,"discussions":[{"author":{"id":1994991,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/70/ef/3717a2c6.jpg","nickname":"Tommy","note":"","ucode":"336E7703EAD0A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566159,"discussion_content":"ç”»å¸ƒå®½é«˜çš„ä¸€åŠå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650615959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329635,"user_name":"Geek_9a30ab","can_delete":false,"product_type":"c1","uid":2068385,"ip_address":"","ucode":"4019658B9BA93F","user_header":"https://static001.geekbang.org/account/avatar/00/1f/8f/a1/5482b927.jpg","comment_is_top":false,"comment_ctime":1641453767,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641453767","product_id":100053801,"comment_content":" const poitions = vertices.map(([x, y]) =&gt; [x * 256, y * 256]);","like_count":0},{"had_liked":false,"id":303729,"user_name":"ç‹é’°","can_delete":false,"product_type":"c1","uid":2618921,"ip_address":"","ucode":"F4A97F1E0EBB13","user_header":"","comment_is_top":false,"comment_ctime":1626946683,"is_pvip":false,"replies":[{"id":"114133","content":"ä¸å¯ä»¥çš„ï¼Œé™¤éaå’Œu1çš„é•¿åº¦ç›¸åŒ","user_name":"ä½œè€…å›å¤","comment_id":303729,"uid":"1159792","ip_address":"","utype":1,"ctime":1633750512,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"1626946683","product_id":100053801,"comment_content":"è€å¸ˆï¼Œåˆ¤æ–­ u1 æ˜¯å¦åœ¨ a ä¸Šï¼Œæ˜¯å¦å¯ä»¥ç”¨ |a - u1| &gt; 0 åˆ¤æ–­ï¼Œå¤§äº 0 æ—¶ï¼Œu1 ä¸åœ¨ a ä¸Šï¼Œç­‰äº 0 æ—¶åœ¨ a ä¸Šã€‚","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523796,"discussion_content":"ä¸å¯ä»¥çš„ï¼Œé™¤éaå’Œu1çš„é•¿åº¦ç›¸åŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633750512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300961,"user_name":"è°­é¹","can_delete":false,"product_type":"c1","uid":1142009,"ip_address":"","ucode":"4A8120C4AA6F2F","user_header":"https://static001.geekbang.org/account/avatar/00/11/6c/f9/af80b4da.jpg","comment_is_top":false,"comment_ctime":1625468287,"is_pvip":false,"replies":[{"id":"114139","content":"å› ä¸ºqhresåŸŸåæœ‰é—®é¢˜ï¼Œæ¢æˆqhres2å°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","comment_id":300961,"uid":"1159792","ip_address":"","utype":1,"ctime":1633750818,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"1625468287","product_id":100053801,"comment_content":"githubä¸Šçš„ä»£ç  æ€ä¹ˆæ‰“å¼€éƒ½æ˜¯å¤§ç™½å±","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522863,"discussion_content":"å› ä¸ºqhresåŸŸåæœ‰é—®é¢˜ï¼Œæ¢æˆqhres2å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633750818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296843,"user_name":"å°å›¢","can_delete":false,"product_type":"c1","uid":2028952,"ip_address":"","ucode":"B81FD9742B1F22","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f5/98/c490d236.jpg","comment_is_top":false,"comment_ctime":1623199724,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623199724","product_id":100053801,"comment_content":"const offsetX = 2 * (x - left) &#47; canvas.width - 1.0;<br>const offsetY = 1.0 - 2 * (y - top) &#47; canvas.height;<br>ä¸ç†è§£è¿™æ®µä»£ç æ˜¯å¦‚ä½•å¾—åˆ°çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":290206,"user_name":"Geek_jiang_gdufs","can_delete":false,"product_type":"c1","uid":1907075,"ip_address":"","ucode":"4DF0082F284C64","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3raFU5AA5eEtZSRTiacg0eceh05FFAwSSDwLy48A5TvPVzp3p1oaRnibjP5kIucLHeRb8ocSCcQq3vpe9Ahq0zJw/132","comment_is_top":false,"comment_ctime":1619429667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619429667","product_id":100053801,"comment_content":"æ³¨: è‹¥æ˜¯å­˜åœ¨å˜æ¢åæ ‡è½´çš„æ–¹æ³•, å¦‚ context.translate(), context.scale(), åˆ™éœ€è¦è°ƒæ•´ç›¸åº”çš„åˆ¤æ–­ç‚¹","like_count":0},{"had_liked":false,"id":279251,"user_name":"æˆ‘ç³»å°è‰¾","can_delete":false,"product_type":"c1","uid":1356099,"ip_address":"","ucode":"274272105939D4","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/43/5eebf2cd.jpg","comment_is_top":false,"comment_ctime":1613695926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613695926","product_id":100053801,"comment_content":"çœ‹åˆ°Vector2Dä¸­å‰ç§¯çš„å®ç°ä¸€å¼€å§‹æ²¡æ˜ç™½ï¼Œä¸€ç›´åœ¨æƒ³ç€å‰ç§¯çš„å‡ ä½•æ„ä¹‰æ˜¯å¯¹åº”çš„å››è¾¹å½¢é¢ç§¯ï¼Œå¯¹ç…§ç€å®ç°ä¸­æ˜¯x1*y2-x2*y1å®Œå…¨æ²¡ç†è§£æ€ä¹ˆæ˜¯è¿™æ ·è®¡ç®—çš„ï¼Œåé¢å›é¡¾å‰é¢è¯¾ç¨‹ä¸­çš„å‰ä¹˜å…¬å¼é¡¿æ—¶äº†ç„¶ï¼ŒaXb=[y1*z2 - y2*z1, -(x1*z2 - x2*z1, x1*y2 - x2*y1)]ï¼Œå¹³é¢ä¸Šz1,z2éƒ½ä¸º0 ï¼Œä»£å…¥ä¸Šé¢aXb = [0, 0, x1*y2 - x2*y1]ï¼Œæ‰€ä»¥aä¸bçš„å‰ç§¯å°±æ˜¯ x1*y2 - x2*y1ã€‚æœç„¶æ¢ä¸ªè§’åº¦ç†è§£å°±ç®€å•äº†ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":238758,"user_name":"kylin","can_delete":false,"product_type":"c1","uid":1351248,"ip_address":"","ucode":"3588B62A4F9534","user_header":"https://static001.geekbang.org/account/avatar/00/14/9e/50/21e0beca.jpg","comment_is_top":false,"comment_ctime":1596285184,"is_pvip":true,"replies":[{"id":"88830","content":"æœ‰çš„ï¼Œå‘é‡abcå°±æ˜¯ç‚¹på’ŒABCè¿æ¥çš„çº¿æ®µè¡¨ç¤ºå‘é‡","user_name":"ä½œè€…å›å¤","comment_id":238758,"uid":"1159792","ip_address":"","utype":1,"ctime":1597022641,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"1596285184","product_id":100053801,"comment_content":"æœˆå½±è€å¸ˆï¼Œæ‚¨å¥½ï¼Œè¯·é—®ä¸‰è§’å½¢å‘é‡a b cä¸‰ä¸ªç‚¹A B Cæœ‰æ²¡æœ‰å¯¹åº”å…³ç³»ï¼Œè€Œä¸”a b c çš„æ–¹å‘åœ¨å›¾ä¸Šä¹Ÿæ²¡æœ‰ï¼Œçœ‹ä¸æ˜ç™½æ‚¨è¯´çš„å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç‚¹åœ¨ä¸‰è§’å½¢å†…","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502846,"discussion_content":"æœ‰çš„ï¼Œå‘é‡abcå°±æ˜¯ç‚¹på’ŒABCè¿æ¥çš„çº¿æ®µè¡¨ç¤ºå‘é‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597022641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1169110,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d6/d6/c757b62c.jpg","nickname":"ç™½å¤œ","note":"","ucode":"72FAE44C19F592","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297773,"discussion_content":"å‘é‡a,b,cå…¶å®åº”è¯¥æ˜¯æ²¿ä¸€ä¸ªæ–¹å‘ï¼ˆé¡ºæ—¶é’ˆæˆ–è€…é€†æ—¶é’ˆï¼‰ï¼Œä¾æ¬¡å¯¹è¾¹è¿›è¡Œæ ‡è®°çš„ï¼Œæ¯”å¦‚ABï¼ŒBCï¼ŒCAï¼›è€Œuæ˜¯è¡¨ç¤ºä»pæŒ‡å‘é¡¶ç‚¹çš„å‘é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597053169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237404,"user_name":"Mingzhang","can_delete":false,"product_type":"c1","uid":1332515,"ip_address":"","ucode":"072E18F1458634","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqNxFYmldFiaT0180Po2TEbPuB3l0uZIqKb9sPWO97XicgDlaSIbkggq9yXv1vd1l7DXR4BjuqN76w/132","comment_is_top":false,"comment_ctime":1595820659,"is_pvip":false,"replies":[{"id":"87809","content":"å—¯ï¼Œç®—atanå¾ˆæ¶ˆè€—æ€§èƒ½","user_name":"ä½œè€…å›å¤","comment_id":237404,"uid":"1159792","ip_address":"","utype":1,"ctime":1595929215,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"1595820659","product_id":100053801,"comment_content":"å…³äºåˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ï¼ˆåŒ…æ‹¬è¾¹ä¸Šï¼‰æˆ‘æ›¾ç»ç”¨ä»£æ•°æ–¹æ³•åšè¿‡ï¼šå¯¹æ¯ä¸€æ¡è¾¹è€Œè¨€å…¶å¯¹åº”çš„é¡¶ç‚¹å¿…ç„¶ä¸è¦åˆ¤å®šçš„ç‚¹åœ¨åŒä¸€ä¾§ï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¸‰ç»„æµ‹è¯•ã€‚åˆ¤å®šå‡½æ•°å¦‚ä¸‹ï¼š<br>&#47;**<br> * Determine whether p3 and p4 are on the same side of the segment of p1-p2<br> * @param p1<br> * @param p2<br> * @param p3<br> * @param p4<br> * returns -1 (not on the same side) | 0 (at least one is on the segment) | 1 (on the same side)<br> *&#47;<br>function onSameSide(p1=[0,0], p2=[0,0], p3=[0,0], p4=[0,0]) {<br>  let angle0 = Math.atan2(p2[1] - p1[1], p2[0] - p1[0]);<br>  let angle1 = Math.atan2(p3[1] - p1[1], p3[0] - p1[0]);<br>  let angle2 = Math.atan2(p4[1] - p1[1], p4[0] - p1[0]);<br>  let product = (angle1 - angle0) * (angle2 - angle0);<br>  if (product === 0) {<br>    return 0;<br>  }<br>  return product &gt; 0 ? 1 : -1;<br>}<br>","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502406,"discussion_content":"å—¯ï¼Œç®—atanå¾ˆæ¶ˆè€—æ€§èƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595929215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1332515,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLqNxFYmldFiaT0180Po2TEbPuB3l0uZIqKb9sPWO97XicgDlaSIbkggq9yXv1vd1l7DXR4BjuqN76w/132","nickname":"Mingzhang","note":"","ucode":"072E18F1458634","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294416,"discussion_content":"ä¸Šé¢çš„å‡½æ•°æœ‰ bugï¼Œæ›´æ–°åå¦‚ä¸‹ï¼š\n\n/**\n * Determine whether p3 and p4 are on the same side of the segment of p1-p2\n * @param p1\n * @param p2\n * @param p3\n * @param p4\n * returns -1 (not on the same side) | 0 (at least one is on the segment) | 1 (on the same side)\n */\nfunction onSameSide(p1=[0,0], p2=[0,0], p3=[0,0], p4=[0,0]) {\n  if (p1[0] === p2[0]) {\n    let m = p3[0] - p1[0];\n    let n = p4[0] - p1[0];\n    if (m * n === 0) {\n      return 0;\n    }\n    return m * n > 0 ? 1: -1;\n  }\n  let k = (p2[1] - p1[1]) / (p2[0] - p1[0]);\n  let b0 = p2[1] - k * p2[0];\n  let b1 = p3[1] - k * p3[0];\n  let b2 = p4[1] - k * p4[0];\n  let p = b1 - b0;\n  let q = b2 - b0;\n  if (p * q === 0) {\n    return 0;\n  } else {\n    return p * q > 0 ? 1 : -1;\n  }\n}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595870560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}