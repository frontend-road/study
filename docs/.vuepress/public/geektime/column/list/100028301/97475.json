{"id":97475,"title":"02 | 如何写出你的“hello world”？","content":"<p>你好，我是温铭。今天起，就要开始我们的正式学习之旅。</p><p>每当我们开始学习一个新的开发语言或者平台，都会从最简单的<code>hello world</code>开始，OpenResty 也不例外。让我们先跳过安装的步骤，直接看下，最简单的 OpenResty 程序是怎么编写和运行的：</p><pre><code>$ resty -e &quot;ngx.say('hello world')&quot;\nhello world\n</code></pre><p>这应该是你见过的最简单的那种 hello world 代码写法，和 Python 类似：</p><pre><code>$ python -c 'print(&quot;hello world&quot;)'\nhello world\n</code></pre><p>这背后其实是 OpenResty 哲学的一种体现，代码要足够简洁，也好让你打消“从入门到放弃“的念头。我们今天的内容，就专门围绕着这行代码来展开聊一聊。</p><p>上一节我们讲过，OpenResty 是基于 NGINX 的。那你现在是不是有一个疑问：为什么这里看不到 NGINX 的影子？别着急，我们加一行代码，看看 <code>resty</code>背后真正运行的是什么：</p><pre><code>resty -e &quot;ngx.say('hello world'); ngx.sleep(10)&quot; &amp;\n</code></pre><p>我们加了一行 sleep 休眠的代码，让 resty 运行的程序打印出字符串后，并不退出。这样，我们就有机会一探究竟：</p><pre><code>$ ps -ef | grep nginx\n501 25468 25462   0  7:24下午 ttys000    0:00.01 /usr/local/Cellar/openresty/''1.13.6.2/nginx/sbin/nginx -p /tmp/resty_AfNwigQVOB/ -c conf/nginx.conf\n</code></pre><p>终于看了熟悉的 NGINX 进程。看来，<code>resty</code> 本质上是启动了一个 NGINX 服务，那么<code>resty</code> 又是一个什么程序呢？我先卖个关子，咱后面再讲。</p><p>你的机器上可能还没有安装 OpenResty，所以，接下来，我们先回到开头跳过的安装步骤，把 OpenResty 安装完成后再继续。</p><!-- [[[read_end]]] --><h2>OpenResty 的安装</h2><p>和其他的开源软件一样，OpenResty 的安装有多种方法，比如使用操作系统的包管理器、源码编译或者 docker 镜像。我推荐你优先使用 yum、apt-get、brew 这类包管理系统，来安装 OpenResty。这里我们使用 Mac 系统来做示例：</p><pre><code>brew tap openresty/brew\nbrew install openresty\n</code></pre><p>使用其他操作系统也是类似的，先要在包管理器中添加 OpenResty 的仓库地址，然后用包管理工具来安装。具体步骤，你可以参考<a href=\"https://openresty.org/en/linux-packages.html\">官方文档</a>。</p><p>不过，这看似简单的安装背后，其实有两个问题：</p><ul>\n<li>\n<p>为什么我不推荐使用源码来安装呢？</p>\n</li>\n<li>\n<p>为什么不能直接从操作系统的官方仓库安装，而是需要先设置另外一个仓库地址？</p>\n</li>\n</ul><p>对于这两个问题，你不妨先自己想一想。</p><p>这里我想补充一句。在这门课程里面，我会在表象背后提出很多的“为什么”，希望你可以一边学新东西一边思考，结果是否正确并不重要。独立思考在技术领域也是稀缺的，由于每个人技术领域和深度的不同，在任何课程中老师都会不可避免地带有个人观点以及知识的错漏。只有在学习过程中多问几个为什么，融会贯通，才能逐渐形成自己的技术体系。</p><p>很多工程师都有源码的情节，多年前的我也是一样。在使用一个开源项目的时候，我总是希望能够自己手工从源码开始 configure 和 make，并修改一些编译参数，感觉这样做才能最适合这台机器的环境，才能把性能发挥到极致。</p><p>但现实并非如此，每次源码编译，我都会遇到各种诡异的环境问题，磕磕绊绊才能安装好。现在我想明白了，我们的最初目的其实是用开源项目来解决业务需求，不应该浪费时间和环境鏖战，更何况包管理器和容器技术，正是为了帮我们解决这些问题。</p><p>言归正传，给你说说我的看法。使用 OpenResty 源码安装，不仅仅步骤繁琐，需要自行解决 PCRE、OpenSSL 等外部依赖，而且还需要手工对 OpenSSL 打上对应版本的补丁。不然就会在处理 SSL session 时，带来功能上的缺失，比如像<code>ngx.sleep</code>这类会导致 yield 的 Lua API 就没法使用。这部分内容如果你还想深入了解，可以参考[<a href=\"https://github.com/openresty/lua-nginx-module#ssl_session_fetch_by_lua_block\">官方文档</a>]来获取更详细的信息。</p><p>从 OpenResty 自己维护的 OpenSSL [<a href=\"https://github.com/openresty/openresty-packaging/blob/master/rpm/SPECS/openresty-openssl.spec\">打包脚本</a>]中，就可以看到这些补丁。而在 OpenResty 升级 OpenSSL 版本时，都需要重新生成对应的补丁，并进行完整的回归测试。</p><pre><code>Source0: https://www.openssl.org/source/openssl-%{version}.tar.gz\n\nPatch0: https://raw.githubusercontent.com/openresty/openresty/master/patches/openssl-1.1.0d-sess_set_get_cb_yield.patch\nPatch1: https://raw.githubusercontent.com/openresty/openresty/master/patches/openssl-1.1.0j-parallel_build_fix.patch\n</code></pre><p>同时，我们可以看下 OpenResty 在 CentOS 中的<a href=\"https://github.com/openresty/openresty-packaging/blob/master/rpm/SPECS/openresty.spec\">[打包脚本]</a>，看看是否还有其他隐藏的点：</p><pre><code>BuildRequires: perl-File-Temp\nBuildRequires: gcc, make, perl, systemtap-sdt-devel\nBuildRequires: openresty-zlib-devel &gt;= 1.2.11-3\nBuildRequires: openresty-openssl-devel &gt;= 1.1.0h-1\nBuildRequires: openresty-pcre-devel &gt;= 8.42-1\nRequires: openresty-zlib &gt;= 1.2.11-3\nRequires: openresty-openssl &gt;= 1.1.0h-1\nRequires: openresty-pcre &gt;= 8.42-1\n</code></pre><p>从这里可以看出，OpenResty 不仅维护了自己的 OpenSSL 版本，还维护了自己的 zlib 和 PCRE 版本。不过后面两个只是调整了编译参数，并没有维护自己的补丁。</p><p>所以，综合这些因素，我不推荐你自行源码编译 OpenResty，除非你已经很清楚这些细节。</p><p>为什么不推荐源码安装，你现在应该已经很清楚了。其实我们在回答第一个问题时，也顺带回答了第二个问题：为什么不能直接从操作系统的官方仓库安装，而是需要先设置另外一个仓库地址？</p><p>这是因为，官方仓库不愿意接受第三方维护的 OpenSSL、PCRE 和 zlib 包，这会导致其他使用者的困惑，不知道选用哪一个合适。另一方面，OpenResty 又需要指定版本的 OpenSSL、PCRE 库才能正常运行，而系统默认自带的版本都比较旧。</p><h2>OpenResty CLI</h2><p>安装完 OpenResty 后，默认就已经把 OpenResty 的 CLI：<code>resty</code> 安装好了。<code>resty</code>是个 1000 多行的 Perl 脚本，之前我们提到过，OpenResty 的周边工具都是 Perl 编写的，这个是由 OpenResty 作者的技术偏好决定的。</p><pre><code>$ which resty\n/usr/local/bin/resty\n$ head -n 1 /usr/local/bin/resty\n #!/usr/bin/env perl\n</code></pre><p><code>resty</code> 的功能很强大，想了解完整的列表，你可以查看<code>resty -h</code>或者[<a href=\"https://github.com/openresty/resty-cli\">官方文档</a>]。下面，我挑两个有意思的功能介绍一下。</p><pre><code>$ resty --shdict='dogs 1m' -e 'local dict = ngx.shared.dogs\n                               dict:set(&quot;Tom&quot;, 56)\n                               print(dict:get(&quot;Tom&quot;))'\n56\n\n</code></pre><p>先来看第一个例子。这个示例结合了 NGINX 配置和 Lua 代码，一起完成了一个共享内存字典的设置和查询。<code>dogs 1m</code> 是 NGINX 的一段配置，声明了一个共享内存空间，名字是 dogs，大小是 1m；在 Lua 代码中用字典的方式使用共享内存。另外还有<code>--http-include</code> 和 <code>--main-include</code>来设置 NGINX 配置文件。所以，上面的例子也可以写为：</p><pre><code>resty --http-conf 'lua_shared_dict dogs 1m;' -e 'local dict = ngx.shared.dogs\n                               dict:set(&quot;Tom&quot;, 56)\n                               print(dict:get(&quot;Tom&quot;))'\n</code></pre><p>OpenResty 世界中常用的调试工具，比如<code>gdb</code>、<code>valgrind</code>、<code>sysetmtap</code>和<code>Mozilla rr</code> ，也可以和 <code>resty</code> 一起配合使用，方便你平时的开发和测试。它们分别对应着 <code>resty</code> 不同的指令，内部的实现其实很简单，就是多套了一层命令行调用。我们以 valgrind 为例：</p><pre><code>$ resty --valgrind  -e &quot;ngx.say('hello world'); &quot;\nERROR: failed to run command &quot;valgrind /usr/local/Cellar/openresty/1.13.6.2/nginx/sbin/nginx -p /tmp/resty_hTFRsFBhVl/ -c conf/nginx.conf&quot;: No such file or directory\n</code></pre><p>在后面调试、测试和性能分析的章节，会涉及到这些工具的使用。它们不仅适用于 OpenResty 世界，也是服务端的通用工具，让我们循序渐进地来学习吧。</p><h2>更正式的 hello world</h2><p>最开始我们使用<code>resty</code>写的第一个 OpenResty 程序，没有 master 进程，也不会监听端口。下面，让我们写一个更正式的 hello world。</p><p>写出这样的 OpenResty 程序并不简单，你至少需要三步才能完成：</p><ul>\n<li>\n<p>创建工作目录；</p>\n</li>\n<li>\n<p>修改 NGINX 的配置文件，把 Lua 代码嵌入其中；</p>\n</li>\n<li>\n<p>启动 OpenResty 服务。</p>\n</li>\n</ul><p>我们先来创建工作目录。</p><pre><code>mkdir geektime\ncd geektime\nmkdir logs/ conf/\n</code></pre><p>下面是一个最简化的 <code>nginx.conf</code>，在根目录下新增 OpenResty 的<code>content_by_lua</code>指令，里面嵌入了<code>ngx.say</code>的代码：</p><pre><code>events {\n    worker_connections 1024;\n}\n\nhttp {\n    server {\n        listen 8080;\n        location / {\n            content_by_lua '\n                ngx.say(&quot;hello, world&quot;)\n            ';\n        }\n    }\n}\n</code></pre><p>请先确认下，是否已经把<code>openresty</code>加入到<code>PATH</code>环境中；然后，启动 OpenResty 服务就可以了：</p><pre><code>openresty -p `pwd` -c conf/nginx.conf\n</code></pre><p>没有报错的话，OpenResty 的服务就已经成功启动了。你可以打开浏览器，或者使用 curl 命令，来查看结果的返回：</p><pre><code>$ curl -i 127.0.0.1:8080\nHTTP/1.1 200 OK\nServer: openresty/1.13.6.2\nContent-Type: text/plain\nTransfer-Encoding: chunked\nConnection: keep-alive\n\nhello, world\n</code></pre><p>到这里，恭喜你，一个真正的 OpenResty 程序就完成了。</p><h2>总结</h2><p>让我们回顾下今天讲的内容。我们通过一行简单的 <code>hello, world</code> 代码，延展到OpenResty 的安装和 CLI，并在最后启动了 OpenResty 进程，运行了一个真正的后端程序。</p><p>其中， <code>resty</code> 是我们后面会频繁使用到的命令行工具，课程中的演示代码都是用它来运行的，而不是启动后台的 OpenResty 服务。</p><p>更为重要的是，OpenResty 的背后隐藏了非常多的文化和技术细节，它就像漂浮在海面上的一座冰山。我希望能够通过这门课程，给你展示更全面、更立体的 OpenResty，而不仅仅是它对外暴露出来的 API。</p><h2>思考</h2><p>最后，我给你留一个作业题。我们现在的做法，是把 Lua 代码写在 NGINX 配置文件中。不过，如果代码越来越多，那代码的可读性和可维护性就无法保证了。</p><p>你有什么方法来解决这个问题吗？欢迎留言和我分享，也欢迎你把这篇文章转发给你的同事、朋友。</p><p></p>","neighbors":{"left":{"article_title":"01 | 初探OpenResty的三大特性","id":97459},"right":{"article_title":"03 | 揪出隐藏在背后的那些子项目","id":98416}},"comments":[{"had_liked":false,"id":98714,"user_name":"Geek_144c1d","can_delete":false,"product_type":"c1","uid":1545626,"ip_address":"","ucode":"BE1C8A61CC8690","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLlSQgQxSw8wyo76EFlZ9f2NK3jWDsFicNTSbmRSfoYckiaia7bLay4dTFVHI9rKKqjfBgXd0sfKzgicg/132","comment_is_top":false,"comment_ctime":1559068170,"is_pvip":true,"replies":[{"id":"35356","content":"👍","user_name":"作者回复","comment_id":98714,"uid":"1017955","ip_address":"","utype":1,"ctime":1559097967,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"121818152458","product_id":100028301,"comment_content":"先将代码打包成`.lua` 文件<br>使用配置文件指令 `content_by_lua_file` 引用<br>类库代码 如果有 reqiure 的需求<br>可利用 `lua_package_path` 和 `lua_package_cpath` 设定类库加载目录","like_count":29,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451804,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559097967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98770,"user_name":"cylim","can_delete":false,"product_type":"c1","uid":1005082,"ip_address":"","ucode":"941310C208BDC1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/1a/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1559092777,"is_pvip":false,"replies":[{"id":"35358","content":"欢迎补充：）","user_name":"作者回复","comment_id":98770,"uid":"1017955","ip_address":"","utype":1,"ctime":1559098061,"user_name_real":"温铭@OpenResty"}],"discussion_count":2,"race_medal":0,"score":"74573536809","product_id":100028301,"comment_content":"既然是基础课，应该提醒我们关闭server。<br>openresty -s quit -p `pwd` -c conf&#47;nginx.conf<br><br><br>把lua代码写在其他文件上，然后带入nginx.conf使用。","like_count":18,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451830,"discussion_content":"欢迎补充：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559098061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031868,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/be/bc/62d402da.jpg","nickname":"Goku","note":"","ucode":"8008F3BB10E609","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573312,"discussion_content":"openresty没有了但是nginx还在跑？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653336706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105969,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1561117088,"is_pvip":false,"replies":[{"id":"38895","content":"👍","user_name":"作者回复","comment_id":105969,"uid":"1017955","ip_address":"","utype":1,"ctime":1561550095,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"53100724640","product_id":100028301,"comment_content":"编译安装PART1:<br>老师说的对，对于大多数项目来说都没有必要自己折腾编译安装，费时费力。不过有时候自己动手编译安装也是必须的，因为根据具体项目的需要，比如CDN项目，官方的默认编译选项就缺少一些必要的模块，比如ngx_cache_purge模块，如果需要对ipv6做支持，还需要nginx的--with-ipv6编译选项，等等。下面是我根据官方打包文件总结的centos平台下编译安装最新版本的openresty具体流程。centos6下完美运行，7也应该不是问题。给各位小伙伴在需要的时候参考，少走弯路，节省宝贵时间。<br># 安装 pcre<br>wget ftp:&#47;&#47;ftp.csx.cam.ac.uk&#47;pub&#47;software&#47;programming&#47;pcre&#47;pcre-8.42.tar.bz2    <br>tar xjf pcre-8.42.tar.bz2 <br>cd pcre-8.42<br> .&#47;configure --prefix=&#47;usr&#47;local&#47;openresty&#47;pcre \\<br> --disable-cpp --enable-jit \\<br> --enable-utf --enable-unicode-properties<br>make -j24 V=1 &gt; &#47;dev&#47;stderr<br>make install<br><br>rm -rf &#47;usr&#47;local&#47;openresty&#47;pcre&#47;bin<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;pcre&#47;share<br>rm -f  &#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib&#47;*.la<br>rm -f  &#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib&#47;*pcrecpp*<br>rm -f  &#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib&#47;*pcreposix*<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib&#47;pkgconfig<br><br># 安装zlib<br>cd &#47;usr&#47;local&#47;src<br>wget http:&#47;&#47;www.zlib.net&#47;zlib-1.2.11.tar.xz<br>tar xf zlib-1.2.11.tar.xz <br>cd zlib-1.2.11<br> .&#47;configure --prefix=&#47;usr&#47;local&#47;openresty&#47;zlib<br>make -j24 \\<br>CFLAGS=&#39;-O3 -D_LARGEFILE64_SOURCE=1 -DHAVE_HIDDEN -g&#39; \\<br>SFLAGS=&#39;-O3 -fPIC -D_LARGEFILE64_SOURCE=1 -DHAVE_HIDDEN -g&#39; &gt; &#47;dev&#47;stderr <br>make install<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;zlib&#47;share&#47;<br>rm -f &#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib&#47;*.la<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib&#47;pkgconfig&#47;<br><br># 安装openssl<br>cd &#47;usr&#47;local&#47;src<br>wget https:&#47;&#47;www.openssl.org&#47;source&#47;openssl-1.1.0j.tar.gz<br>wget https:&#47;&#47;raw.githubusercontent.com&#47;openresty&#47;openresty&#47;master&#47;patches&#47;openssl-1.1.0d-sess_set_get_cb_yield.patch --no-check-certificate<br>wget https:&#47;&#47;raw.githubusercontent.com&#47;openresty&#47;openresty&#47;master&#47;patches&#47;openssl-1.1.0j-parallel_build_fix.patch --no-check-certificate<br>tar zxf openssl-1.1.0j.tar.gz <br>cd openssl-1.1.0j<br>继续见PART2","like_count":13,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454894,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561550095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105971,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1561117233,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23035953713","product_id":100028301,"comment_content":"编译安装PART3:<br># 最后开始编译安装openresty<br>cd &#47;usr&#47;local&#47;src<br>wget https:&#47;&#47;openresty.org&#47;download&#47;openresty-1.15.8.1.tar.gz # 如果下载出现ssl报错，yum update wget，再下载<br>tar zxf openresty-1.15.8.1.tar.gz<br>cd openresty-1.15.8.1<br>.&#47;configure \\<br>    --prefix=&#47;usr&#47;local&#47;openresty \\<br>    --with-cc-opt=&quot;-DNGX_LUA_ABORT_AT_PANIC \\<br>                -I&#47;usrl&#47;local&#47;openresty&#47;zlib&#47;include \\<br>                -I&#47;usr&#47;local&#47;openresty&#47;pcre&#47;include \\<br>                -I&#47;usr&#47;local&#47;openresty&#47;openssl&#47;include&quot; \\<br>    --with-ld-opt=&quot;-L&#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib \\<br>                -L&#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib \\<br>                -L&#47;usr&#47;local&#47;openresty&#47;openssl&#47;lib \\<br>                -Wl,-rpath,&#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib:&#47;usr&#47;local&#47;openresty&#47;pcre&#47;lib:&#47;usr&#47;local&#47;openresty&#47;openssl&#47;lib&quot; \\<br>    --with-pcre-jit \\<br>    --without-http_rds_json_module \\<br>    --without-http_rds_csv_module \\<br>    --without-lua_rds_parser \\<br>    --with-stream \\<br>    --with-stream_ssl_module \\<br>    --with-stream_ssl_preread_module \\<br>    --with-http_v2_module \\<br>    --without-mail_pop3_module \\<br>    --without-mail_imap_module \\<br>    --without-mail_smtp_module \\<br>    --with-http_stub_status_module \\<br>    --with-http_realip_module \\<br>    --with-http_addition_module \\<br>    --with-http_auth_request_module \\<br>    --with-http_secure_link_module \\<br>    --with-http_random_index_module \\<br>    --with-http_gzip_static_module \\<br>    --with-http_sub_module \\<br>    --with-http_dav_module \\<br>    --with-http_flv_module \\<br>    --with-http_mp4_module \\<br>    --with-http_gunzip_module \\<br>    --with-threads \\<br>    --with-luajit-xcflags=&#39;-DLUAJIT_NUMMODE=2 -DLUAJIT_ENABLE_LUA52COMPAT&#39; \\<br>    -j24<br>make -j24<br>make install<br><br>rm -rf &#47;usr&#47;local&#47;openresty&#47;luajit&#47;share&#47;man<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;luajit&#47;lib&#47;libluajit-5.1.a<br><br>[END]","like_count":5,"discussions":[{"author":{"id":1611025,"avatar":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","nickname":"沈康","note":"","ucode":"02AFA50738AB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308904,"discussion_content":"小白想请教个问题，我现在不清楚，.configure如果不加这些配置，默认参数是什么？\n我理解，\n--with的opention的是默认不配置的\n--without 的opention默认是配置的\n是这意思吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601117581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1213010,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/52/aa4e9349.jpg","nickname":"大德","note":"","ucode":"58D6B49F81ED45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1611025,"avatar":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","nickname":"沈康","note":"","ucode":"02AFA50738AB8E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327417,"discussion_content":"你可以 在后面加 -h 看看出现的参数","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605834223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":308904,"ip_address":""},"score":327417,"extra":""}]}]},{"had_liked":false,"id":105970,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1561117186,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23035953666","product_id":100028301,"comment_content":"编译安装PART2:<br>patch -p1 &lt; ..&#47;openssl-1.1.0d-sess_set_get_cb_yield.patch <br>patch -p1 &lt; ..&#47;openssl-1.1.0j-parallel_build_fix.patch <br>.&#47;config \\<br>    no-threads shared zlib -g \\<br>    enable-ssl3 enable-ssl3-method \\<br>    --prefix=&#47;usr&#47;local&#47;openresty&#47;openssl \\<br>    --libdir=lib \\<br>    -I%&#47;usr&#47;local&#47;openresty&#47;zlib&#47;include \\<br>    -L%&#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib \\<br>    -Wl,-rpath,&#47;usr&#47;local&#47;openresty&#47;zlib&#47;lib:&#47;usr&#47;local&#47;openresty&#47;openssl&#47;lib<br>make -j24<br>make install_sw<br><br>rm -f &#47;usr&#47;local&#47;openresty&#47;openssl&#47;bin&#47;c_rehash<br>rm -rf &#47;usr&#47;local&#47;openresty&#47;openssl&#47;lib&#47;pkgconfig<br><br>继续见PART3","like_count":5,"discussions":[{"author":{"id":1611025,"avatar":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","nickname":"沈康","note":"","ucode":"02AFA50738AB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308932,"discussion_content":"问一下，一般安装完成后\nrm -f /usr/local/openresty/openssl/bin/c_rehash\n删除的操作是什么意思，为什么要删除呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601125959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99450,"user_name":"aaron","can_delete":false,"product_type":"c1","uid":1544943,"ip_address":"","ucode":"48420629B0F9E9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLCuE3s45as7KQgkia9un9Jm3xllqd1tUV0ugKg6Iial7Es6prgHJMpibjfcwdrJApXbhR1SOaibZu09w/132","comment_is_top":false,"comment_ctime":1559217331,"is_pvip":false,"replies":[{"id":"35803","content":"centos 下需要单独安装：sudo yum install openresty-resty","user_name":"作者回复","comment_id":99450,"uid":"1017955","ip_address":"","utype":1,"ctime":1559271427,"user_name_real":"温铭@OpenResty"}],"discussion_count":4,"race_medal":0,"score":"23034053811","product_id":100028301,"comment_content":"我使用yum安装了openresty之后并没有resty工具，我也没发现-p &#39;pwd&#39;的意义何在，-c nginx.conf也启动不起来，最后我是用openresty -c &#47;opt&#47;geektime&#47;conf&#47;nginx.conf启动的。。。","like_count":5,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452114,"discussion_content":"centos 下需要单独安装：sudo yum install openresty-resty","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559271427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1160593,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b5/91/8750709f.jpg","nickname":"Y%...............Y%","note":"","ucode":"94089F09378F07","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":177216,"discussion_content":"按照作者的sudo yum install openresty-resty 还是不行 centos7","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582086120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135190,"avatar":"https://static001.geekbang.org/account/avatar/00/11/52/56/5abb4d94.jpg","nickname":"不知道该叫什么","note":"","ucode":"C0F72F6FF56DA1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41062,"discussion_content":"抱歉，我还是没理解，这个为啥要这样，或者，为啥能这样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572339621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1219195,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132","nickname":"psoracle","note":"","ucode":"26F9B166508BBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":906,"discussion_content":"-p <prefix_path> 指定的是nginx的prefix路径，在配置中使用相对路径时一般是以这个为前缀的，如&#34;acess_log logs/access.log&#34;中日志全路径为<prefix>/logs/access.log。个人理解。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562146113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175942,"user_name":"MOIC💅","can_delete":false,"product_type":"c1","uid":1821592,"ip_address":"","ucode":"B307B4C7984F35","user_header":"https://static001.geekbang.org/account/avatar/00/1b/cb/98/be4b2e33.jpg","comment_is_top":false,"comment_ctime":1580889710,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14465791598","product_id":100028301,"comment_content":"openresty -p `pwd` -c .&#47;conf&#47;nginx.conf 启动<br>openresty -p `pwd` -c .&#47;conf&#47;nginx.conf -s stop 停止<br>lsof -i:端口号    查看服务状态","like_count":4,"discussions":[{"author":{"id":1670763,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","nickname":"FIRE","note":"","ucode":"85861D990FB3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551919,"discussion_content":"我也不明白 -p `pwd` 有何意义","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645173418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98927,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1559116653,"is_pvip":false,"replies":[{"id":"35653","content":"嗯，可以用 content_by_lua_block","user_name":"作者回复","comment_id":98927,"uid":"1017955","ip_address":"","utype":1,"ctime":1559193101,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"14444018541","product_id":100028301,"comment_content":"content_by_lua指令看起来非常怪！没有用{}","like_count":3,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451898,"discussion_content":"嗯，可以用 content_by_lua_block","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104010,"user_name":"逗鹅冤","can_delete":false,"product_type":"c1","uid":1101077,"ip_address":"","ucode":"DAC59893C4DB6C","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/15/e589a84f.jpg","comment_is_top":false,"comment_ctime":1560589085,"is_pvip":false,"replies":[{"id":"37669","content":"luajit 的可执行文件并没有被拷贝到&#47;usr&#47;local&#47;bin目录下，所有找不到。这个是为了避免了已经安装的 luajit 冲突，毕竟 OpenResty 自带的 LuaJIT 是自己维护的版本","user_name":"作者回复","comment_id":104010,"uid":"1017955","ip_address":"","utype":1,"ctime":1560667792,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10150523677","product_id":100028301,"comment_content":"老师好，有个问题请教一下<br>openresty -v<br>nginx version: openresty&#47;1.15.8.1<br>which openresty<br>&#47;usr&#47;local&#47;bin&#47;openresty<br>which resty<br>&#47;usr&#47;local&#47;bin&#47;resty<br>这些都没问题<br>which luajit<br>luajit not found<br>luajit为什么没有呢","like_count":2,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454088,"discussion_content":"luajit 的可执行文件并没有被拷贝到/usr/local/bin目录下，所有找不到。这个是为了避免了已经安装的 luajit 冲突，毕竟 OpenResty 自带的 LuaJIT 是自己维护的版本","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560667792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100816,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1559645462,"is_pvip":true,"replies":[{"id":"36552","content":"我用的是 vs code，用的是 lua 和 luacheck 两个插件","user_name":"作者回复","comment_id":100816,"uid":"1017955","ip_address":"","utype":1,"ctime":1559805358,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149580054","product_id":100028301,"comment_content":"温铭老师，你好，有读者问vscode有没有openresty扩展，你说你用的lua扩展，这个是什么意思呢？还有老师你用的是什么IDE呀？","like_count":2,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452688,"discussion_content":"我用的是 vs code，用的是 lua 和 luacheck 两个插件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559805358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100792,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1559640264,"is_pvip":true,"replies":[{"id":"36594","content":"openresty 维护的 openssl&#47;pcre&#47;zlib 都会安装在 &#47;usr&#47;local&#47;openresty&#47; 目录下，并不会冲突。","user_name":"作者回复","comment_id":100792,"uid":"1017955","ip_address":"","utype":1,"ctime":1559863576,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149574856","product_id":100028301,"comment_content":"温铭老师好，假设操作系统中已经安装openssl&#47;pcre&#47;zlib，使用openresty的仓库地址，然后使用包管理器安装openresty，这个时候操作系统里有几个openssl&#47;pcre&#47;zlib呢？只有一个的话，是不是openresy维护的openssl&#47;pcre&#47;zlib?如果是的话，升级或者说安装操作系统中的更新版本的openssl（不是升级openresy维护的openssl）,能否升级成功呢？如果升级成功，openresty执行的时候是否会出错呢？","like_count":2,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452681,"discussion_content":"openresty 维护的 openssl/pcre/zlib 都会安装在 /usr/local/openresty/ 目录下，并不会冲突。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559863576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99111,"user_name":"moshufenmo","can_delete":false,"product_type":"c1","uid":1291505,"ip_address":"","ucode":"75A9E237825AF6","user_header":"https://static001.geekbang.org/account/avatar/00/13/b4/f1/61cd0653.jpg","comment_is_top":false,"comment_ctime":1559143778,"is_pvip":false,"replies":[{"id":"35655","content":"没有什么特别好用的，我用的是微软的 vscode","user_name":"作者回复","comment_id":99111,"uid":"1017955","ip_address":"","utype":1,"ctime":1559193165,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149078370","product_id":100028301,"comment_content":"请问老师，开发openresty使用什么IDE? 一直在用sublime，但是lua文件一多，相互间引用关系就很难查看","like_count":2,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451974,"discussion_content":"没有什么特别好用的，我用的是微软的 vscode","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98758,"user_name":"天天向上","can_delete":false,"product_type":"c1","uid":1031113,"ip_address":"","ucode":"5948D359734193","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/c9/37924ad4.jpg","comment_is_top":false,"comment_ctime":1559091017,"is_pvip":false,"replies":[{"id":"35359","content":"brew 安装也需要先指定 OpenResty 的仓库地址，具体请查看openresty.org 的文档","user_name":"作者回复","comment_id":98758,"uid":"1017955","ip_address":"","utype":1,"ctime":1559098102,"user_name_real":"温铭@OpenResty"}],"discussion_count":1,"race_medal":0,"score":"10149025609","product_id":100028301,"comment_content":"mac brew安装貌似很费劲 网上很多方法都报错","like_count":2,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451825,"discussion_content":"brew 安装也需要先指定 OpenResty 的仓库地址，具体请查看openresty.org 的文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559098102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250552,"user_name":"沈康","can_delete":false,"product_type":"c1","uid":1611025,"ip_address":"","ucode":"02AFA50738AB8E","user_header":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","comment_is_top":false,"comment_ctime":1601129462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5896096758","product_id":100028301,"comment_content":"因为项目在内部，无法连接互联网<br>只能使用源码安装完成，我的经验是：<br>在官网下载源码：http:&#47;&#47;openresty.org&#47;cn&#47; <br>在github对应版本（history中匹配）的打包文件中查找相关库依赖版本，补丁集，而且打包文件里面，安装完成后删除安装路径都有，稍微改成自己的就可以了：https:&#47;&#47;github.com&#47;openresty&#47;openresty-packaging&#47;tree&#47;master&#47;rpm&#47;SPECS<br><br>","like_count":1},{"had_liked":false,"id":170702,"user_name":"Run","can_delete":false,"product_type":"c1","uid":1371941,"ip_address":"","ucode":"6738D2F36ACFF6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLMDBq7lqg9ZasC4f21R0axKJRVCBImPKlQF8yOicLLXIsNgsZxsVyN1mbvFOL6eVPluTNgJofwZeA/132","comment_is_top":false,"comment_ctime":1578668981,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5873636277","product_id":100028301,"comment_content":"最近要为公司的Kong开发插件,需要动态创建更新几千条service,router,customer,还特么是并发场景,Kong本身没有批量创建的API,只能手动撸插件加队列了","like_count":1},{"had_liked":false,"id":328730,"user_name":"Paradise","can_delete":false,"product_type":"c1","uid":1618275,"ip_address":"","ucode":"9CA103A82F5F38","user_header":"https://static001.geekbang.org/account/avatar/00/18/b1/63/68239c70.jpg","comment_is_top":false,"comment_ctime":1640854182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640854182","product_id":100028301,"comment_content":"我觉得至少要整一个文件来搞吧，通过文件来加载","like_count":0},{"had_liked":false,"id":324034,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":2858431,"ip_address":"","ucode":"24D1E66E284411","user_header":"","comment_is_top":false,"comment_ctime":1638265524,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638265524","product_id":100028301,"comment_content":"我尝试用了下--gdb，看来想调试，不编译源码还是不行的","like_count":0},{"had_liked":false,"id":324016,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":2858431,"ip_address":"","ucode":"24D1E66E284411","user_header":"","comment_is_top":false,"comment_ctime":1638260016,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638260016","product_id":100028301,"comment_content":"看了第一页就买了课，只因为文笔，一看就知道是我想要的，文笔简洁明了，准确周全。思路清晰，一看就是有条理的技术天才。<br>技术之佳作，文笔之生动。","like_count":0},{"had_liked":false,"id":316901,"user_name":"柯察金","can_delete":false,"product_type":"c1","uid":1115149,"ip_address":"","ucode":"F722BF8FCD2C47","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","comment_is_top":false,"comment_ctime":1634607468,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634607468","product_id":100028301,"comment_content":"我发现用 –p 指定 prefix 之后，nginx conf 里面的 include 指令路径就有问题，运行的时候会把 prefix 与 include 指定的路径直接拼接起来。比如 prefix 是 &#47;abc，而 include 指定的是 ~&#47;xyz，结果它直接给我拼接起来，变成了 &#47;abc&#47;~&#47;xyz，然后就 file not found 了。。。","like_count":0},{"had_liked":false,"id":291899,"user_name":"1978","can_delete":false,"product_type":"c1","uid":1463853,"ip_address":"","ucode":"73BCC4BC36D67A","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/2d/b685567c.jpg","comment_is_top":false,"comment_ctime":1620577542,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1620577542","product_id":100028301,"comment_content":"不知道有没有跟我一样，文章最后的 nginx -p `pwd` -c con&#47;nginx.conf 中的pwd不是password，是当前的目录。可以通过nginx -h 查看 -p命令是什么意思。<br>同时，关于PATH的设置，我的是Mac环境，使用brew安装的openresty，<br>安装路径应该是在:&#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.19.3.1_1<br>原生nginx配置文件地址为:&#47;usr&#47;local&#47;etc&#47;openresty<br>应该在文件.bash_profile中去设置PATH，<br>如果不设置PATH，也可以使用&#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.19.3.1_1&#47;nginx -p `pwd` -c conf&#47;nginx.conf","like_count":0,"discussions":[{"author":{"id":2877221,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/e7/25/f88357fa.jpg","nickname":"CheverJohn","note":"","ucode":"9B6D41FB0CFE96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545045,"discussion_content":"额，其实pwd命令不就是当前目录嘛，写者的本意是这样的呢，话说老师其实还是没有太注重新手哈。比如就抓住这位小兄弟不知道pwd嘿嘿嘿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641813685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1115149,"avatar":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","nickname":"柯察金","note":"","ucode":"F722BF8FCD2C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405602,"discussion_content":"我发现用 –p 指定 prefix 之后，nginx conf 里面的 include 指令路径就有问题，运行的时候会把 prefix 与 include 指定的路径直接拼接起来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634607002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250545,"user_name":"沈康","can_delete":false,"product_type":"c1","uid":1611025,"ip_address":"","ucode":"02AFA50738AB8E","user_header":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","comment_is_top":false,"comment_ctime":1601125889,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601125889","product_id":100028301,"comment_content":"%install<br>make install DESTDIR=%{buildroot}<br>rm -rf %{buildroot}&#47;%{pcre_prefix}&#47;bin、<br><br>我没有理解，这个安装pcre后，在删除安装pcre的目录的意思，哪位大牛帮忙介绍一下？","like_count":0},{"had_liked":false,"id":233995,"user_name":"Geek_89bbab","can_delete":false,"product_type":"c1","uid":1156607,"ip_address":"","ucode":"B3110D5B3C9500","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/ff/6201122c.jpg","comment_is_top":false,"comment_ctime":1594547019,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594547019","product_id":100028301,"comment_content":"如果通过包管理器安装的openresty缺少一些自己需要的模块，是不是还需要自己添加自己想要的模块，重新编译。有没有更好的方法？","like_count":0},{"had_liked":false,"id":205208,"user_name":"Jim","can_delete":false,"product_type":"c1","uid":1002685,"ip_address":"","ucode":"2D413E4451060C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/bd/9e568308.jpg","comment_is_top":false,"comment_ctime":1586571199,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1586571199","product_id":100028301,"comment_content":"windows环境下，是用openresty压缩包的nginx.exe程序来启动的：nginx.exe -p {your_path} -c conf\\nginx.conf，在它的readme.txt文件可以看到说明","like_count":1},{"had_liked":false,"id":182291,"user_name":"郭永健","can_delete":false,"product_type":"c1","uid":1238317,"ip_address":"","ucode":"DFAE84EDDDBD52","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/2d/457a41e5.jpg","comment_is_top":false,"comment_ctime":1582764423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582764423","product_id":100028301,"comment_content":"openresty可以像php一样开发业务层代码么，并发量单机一般可以多少","like_count":0},{"had_liked":false,"id":178867,"user_name":"一支箭💯¹⁰²⁴","can_delete":false,"product_type":"c1","uid":1367693,"ip_address":"","ucode":"01BE25F9007FBB","user_header":"https://static001.geekbang.org/account/avatar/00/14/de/8d/4c10ba83.jpg","comment_is_top":false,"comment_ctime":1581842504,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1581842504","product_id":100028301,"comment_content":"mac 安装报错<br>curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused<br>Error: An exception occurred within a child process:<br>  DownloadError: Failed to download resource &quot;openresty-openssl--patch&quot;<br>Download failed: https:&#47;&#47;raw.githubusercontent.com&#47;openresty&#47;openresty&#47;master&#47;patches&#47;openssl-1.1.0d-sess_set_get_cb_yield.patch<br><br>是什么原因？","like_count":0,"discussions":[{"author":{"id":1829867,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Ewb31JsMN7J18ZoZMR2DBE4Llu9iattszIKdNUQXvQpsz5yoX9gFc1SMfcw0o8l4bLnk6ibicg2HZUSUib4c8AgOAg/132","nickname":"闫甲鹏","note":"","ucode":"0247853F5F451B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286093,"discussion_content":"修改本地hosts试下\n199.232.28.133 raw.githubusercontent.com","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593052875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218353,"avatar":"https://static001.geekbang.org/account/avatar/00/12/97/31/76485177.jpg","nickname":"贺钧威","note":"","ucode":"3E1FC908C28E29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":181519,"discussion_content":"你用梯子之后再试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582374134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143745,"user_name":"devin","can_delete":false,"product_type":"c1","uid":1016052,"ip_address":"","ucode":"C9682026B6B1FA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/f4/d340dc44.jpg","comment_is_top":false,"comment_ctime":1571787954,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1571787954","product_id":100028301,"comment_content":"老师，mac最新系统 10.15 无法安装 openresty , https:&#47;&#47;github.com&#47;openresty&#47;homebrew-brew&#47;issues&#47;10","like_count":0,"discussions":[{"author":{"id":1002095,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","nickname":"xzy","note":"","ucode":"1A44368083A19E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":53768,"discussion_content":"试试这个命令brew install openresty/brew/openresty。\n如果还是安装失败，运行 brew edit openresty/brew/openresty ，在with-luajit-xcflags这行，添加上“\\ -fno-stack-check”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574214538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139741,"user_name":"阿柒","can_delete":false,"product_type":"c1","uid":1255157,"ip_address":"","ucode":"29FAEEB007D9C4","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLbPelttpoZVoPUZ6ZBmwfYKUeicBTcP7mGJo1jicEAEQBgIlY6y9oWwhVUayAZukYkatyNxLrbpia9g/132","comment_is_top":false,"comment_ctime":1570714754,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570714754","product_id":100028301,"comment_content":"老师那个ngx这个全局变量是谁提供的，怎么来的啊？<br>","like_count":0},{"had_liked":false,"id":138381,"user_name":"刀斧手何在","can_delete":false,"product_type":"c1","uid":1202572,"ip_address":"","ucode":"B99D7ECC3EE954","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/8c/ba81a832.jpg","comment_is_top":false,"comment_ctime":1570187890,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570187890","product_id":100028301,"comment_content":"老师，我也是用的mac vscode 装了luacheck。然后lua脚本里写ngx.say的时候，底下命令行窗口就会报一句：accessing undefined variable `ngx` luacheck[1,1]  。当然实际上 能运行，但是就是一直报这句，看着有点强迫症受不了。搜了好久也没找到解决方案，不知道老师用vscode的时候 会不会报这个，是如何解决的？","like_count":0},{"had_liked":false,"id":116120,"user_name":"连边","can_delete":false,"product_type":"c1","uid":1391748,"ip_address":"","ucode":"54B5DA38449728","user_header":"https://static001.geekbang.org/account/avatar/00/15/3c/84/608f679b.jpg","comment_is_top":false,"comment_ctime":1563790612,"is_pvip":false,"replies":[{"id":"42828","content":"👍 总结之后的才是自己的知识","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1563973449,"ip_address":"","comment_id":116120,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563790612","product_id":100028301,"comment_content":"最近工作也用到这个工具了。特地买了教程来学习，谢谢老师。这个是我的学习笔记，会一步一步的跟着老师脚步做好笔记。https:&#47;&#47;www.iffor.cn&#47;tech&#47;openresty-install.html","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459393,"discussion_content":"👍 总结之后的才是自己的知识","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563973449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111695,"user_name":"在下不恭","can_delete":false,"product_type":"c1","uid":1313669,"ip_address":"","ucode":"A1302944520634","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELmGezvzoWHJU0NNC684yZp3HP3oJAYCD2P3a9EYMaCGyOZOHafiaT4icUtMczec2dRLDjt1jyOJT5w/132","comment_is_top":false,"comment_ctime":1562585991,"is_pvip":false,"replies":[{"id":"40859","content":"你那边是什么操作系统？使用什么方式安装的呢？如果使用 rpm 安装的话，是会有的，可以从这里看到：https:&#47;&#47;github.com&#47;openresty&#47;openresty-packaging&#47;blob&#47;master&#47;rpm&#47;SPECS&#47;openresty.spec#L233","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1562723425,"ip_address":"","comment_id":111695,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562585991","product_id":100028301,"comment_content":"老师您好，安装完openresty以后，执行which resty 提示: no resty in (&#47;usr&#47;local&#47;msp&#47;runtime&#47;jre-8u131-linux-x64&#47;bin:&#47;usr&#47;local&#47;msp&#47;runtime&#47;jre-8u131-linux-x64&#47;jre&#47;bin:&#47;usr&#47;local&#47;sbin:&#47;usr&#47;local&#47;bin:&#47;usr&#47;sbin:&#47;usr&#47;bin:&#47;root&#47;bin)","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457417,"discussion_content":"你那边是什么操作系统？使用什么方式安装的呢？如果使用 rpm 安装的话，是会有的，可以从这里看到：https://github.com/openresty/openresty-packaging/blob/master/rpm/SPECS/openresty.spec#L233","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562723425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109756,"user_name":"Leon📷","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1562108600,"is_pvip":false,"replies":[{"id":"40895","content":"1.15.8 里面是依赖 openssl 1.1 的，所以尽量用 rpm 之类方式来处理","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1562736753,"ip_address":"","comment_id":109756,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562108600","product_id":100028301,"comment_content":"已经解决了，新版的openresty的nginx依赖ssl1.1,所以启动不起来，我看了access log 然后编译了ssl1.1的动态库放在lib64下就好了，这个其他同学也可以参考下","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456554,"discussion_content":"1.15.8 里面是依赖 openssl 1.1 的，所以尽量用 rpm 之类方式来处理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562736753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109162,"user_name":"Leon📷","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1561973340,"is_pvip":false,"replies":[{"id":"39730","content":"你的 OpenResty 是什么版本的呢？","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1562084946,"ip_address":"","comment_id":109162,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561973340","product_id":100028301,"comment_content":" resty --shdict=&#39;dogs 1m&#39; -e &#39;local dict = ngx.shared.dogs<br>&gt;                                dict:set(&quot;Tom&quot;, 56)<br>&gt;                                print(dict:get(&quot;Tom&quot;))&#39;<br>nginx: [emerg] unknown directive &quot;lua_socket_log_errors&quot; in &#47;tmp&#47;resty_oFWCJrrqwD&#47;conf&#47;nginx.conf:47 老师我一只报这个错误","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456277,"discussion_content":"你的 OpenResty 是什么版本的呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562084946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107858,"user_name":"yswang","can_delete":false,"product_type":"c1","uid":1023688,"ip_address":"","ucode":"B9CB98838B215C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","comment_is_top":false,"comment_ctime":1561624367,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561624367","product_id":100028301,"comment_content":"在我的Mac下按照文中安装步骤：<br>brew tap openresty&#47;brew<br>brew install openresty<br><br>还是安装失败，报 OpenSSL 找不到，但是在 &#47;usr&#47;local&#47;Celler&#47;openresty-openssl&#47;1.1.0j 已经安装了啊：<br>checking for PCRE library ... found<br>checking for PCRE JIT support ... found<br>checking for OpenSSL library ... not found<br>checking for OpenSSL library in &#47;usr&#47;local&#47; ... not found<br>checking for OpenSSL library in &#47;usr&#47;pkg&#47; ... not found<br>checking for OpenSSL library in &#47;opt&#47;local&#47; ... not found<br><br>这是什么原因啊？","like_count":0},{"had_liked":false,"id":107447,"user_name":"yswang","can_delete":false,"product_type":"c1","uid":1023688,"ip_address":"","ucode":"B9CB98838B215C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","comment_is_top":false,"comment_ctime":1561537806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561537806","product_id":100028301,"comment_content":"我在我的Mac上使用  brew install openresty 安装报错：Error: Xcode alone is not sufficient on Mojave. 操作系统是 Mojava 10.14.4, XCode 也是最新的 10.2.1 。","like_count":0},{"had_liked":false,"id":105444,"user_name":"小飞哥 ‍超級會員","can_delete":false,"product_type":"c1","uid":1110049,"ip_address":"","ucode":"417F9563B3005B","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/21/104b9565.jpg","comment_is_top":false,"comment_ctime":1561001512,"is_pvip":false,"replies":[{"id":"38898","content":"因为 OpenResty 并没有实现这样的 CLI，这个还是很有必要的，对于运维和管理的便利性来说。","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1561550529,"ip_address":"","comment_id":105444,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561001512","product_id":100028301,"comment_content":"温老师， 问个基础问题<br>为什么 启动命令是 openresty -p `pwd` -c conf&#47;nginx.conf <br>  重启是 openresty -p `pwd` -c conf&#47;nginx.conf -s reload<br>为什么不像其它工具一样 是使用 start  stop restart 命令&#47;？？","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454687,"discussion_content":"因为 OpenResty 并没有实现这样的 CLI，这个还是很有必要的，对于运维和管理的便利性来说。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561550529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104854,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1560856564,"is_pvip":true,"replies":[{"id":"37938","content":"https:&#47;&#47;openresty.org&#47;package&#47;centos&#47;6Server&#47;x86_64&#47; 这里有最近的三个版本可以下载。更早的版本估计要自己源码编译了。<br>或者你可以修改https:&#47;&#47;github.com&#47;openresty&#47;openresty-packaging&#47;tree&#47;master&#47;rpm&#47;SPECS中的版本号，自己搭建一个 rpm 的打包环境，当然这种方案有点儿折腾。","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1560860212,"ip_address":"","comment_id":104854,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560856564","product_id":100028301,"comment_content":"温铭老师，你好~发现通过yum安装openresty安装的是当前的最新版本，如果我想安装最新版本前面的版本可以通过什么方法呢？比如说CentOS版本下安装openresty，看了下这个网页下https:&#47;&#47;openresty.org&#47;package&#47;centos&#47;并没有看到最新版本之前版本的包。","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454453,"discussion_content":"https://openresty.org/package/centos/6Server/x86_64/ 这里有最近的三个版本可以下载。更早的版本估计要自己源码编译了。\n或者你可以修改https://github.com/openresty/openresty-packaging/tree/master/rpm/SPECS中的版本号，自己搭建一个 rpm 的打包环境，当然这种方案有点儿折腾。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560860212,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101432,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1559807378,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559807378","product_id":100028301,"comment_content":"lua_code_cache off;设置了这个发现还是得reload才能生效，不知何故！","like_count":0,"discussions":[{"author":{"id":1325126,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/dglMUGgevn9w5w3AGtTDibGhqGjf7G3GHwlOGXQl25xD7g2EsEktgxh2v4dgriaI2yLG2j45IhZCbhVg1eDrugOQ/132","nickname":"1024","note":"","ucode":"9DFAF1F44D469F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":75765,"discussion_content":"lua_code_cache off;如果是init_worker_by_lua_file下的代码，这种情况也是常驻内存的，修改代码，也需要reload才能生效","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575776718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100830,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1559648802,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559648802","product_id":100028301,"comment_content":"温铭老师，这刚刚开始，已经觉得收益良多，值回票价了，哈哈","like_count":0},{"had_liked":false,"id":100794,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1559640754,"is_pvip":true,"replies":[{"id":"36593","content":"是终端用户。比如你在 CentOS 上 yum search openssl, 如果出了 openssl 官方的版本之外，还有 openresty-openssl，那么用户可能不知道如何选择。","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559863465,"ip_address":"","comment_id":100794,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559640754","product_id":100028301,"comment_content":"文中有这样一段话：“官方仓库不愿意接受第三方维护的 OpenSSL、PCRE 和zlib 包，这会导致其他使用者的困惑，不知道选用哪一个合适。”这里不愿意接受是说安装openresty的时候，使用的就不是openresy维护的openssl&#47;pcre&#47;zlib，如果版本符合要求的话，使得openresty使用的是官方仓库里的openssl&#47;pcre&#47;zlib（且某些函数使用有限制），版本不符合要求的话会直接安装失败？<br>“导致其他使用者的困惑”这里的使用者指谁呢？","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452682,"discussion_content":"是终端用户。比如你在 CentOS 上 yum search openssl, 如果出了 openssl 官方的版本之外，还有 openresty-openssl，那么用户可能不知道如何选择。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559863465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100460,"user_name":"binginx","can_delete":false,"product_type":"c1","uid":1003614,"ip_address":"","ucode":"36EB267FFA7949","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/5e/7556634b.jpg","comment_is_top":false,"comment_ctime":1559558943,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559558943","product_id":100028301,"comment_content":"使用brew安装openresty报如下错误：<br>checking for PCRE library ... found<br>checking for PCRE JIT support ... found<br>checking for OpenSSL library ... not found<br>checking for OpenSSL library in &#47;usr&#47;local&#47; ... not found<br>checking for OpenSSL library in &#47;usr&#47;pkg&#47; ... not found<br>checking for OpenSSL library in &#47;opt&#47;local&#47; ... not found<br><br>brew安装命令<br>brew tap openresty&#47;brew<br>brew install openresty<br><br>openresty-openssl与openssl都已使用brew安装","like_count":0,"discussions":[{"author":{"id":1023688,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9e/c8/d261f700.jpg","nickname":"yswang","note":"","ucode":"B9CB98838B215C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456,"discussion_content":"我也遇到了这个问题，在我的 mac 上安装文中的brew安装方法，无用，还是包 OpenSSL 找不到。 你解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561600338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99931,"user_name":"咖啡猫","can_delete":false,"product_type":"c1","uid":1085089,"ip_address":"","ucode":"64F4CB55DD11B5","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/a1/c05ab3b3.jpg","comment_is_top":false,"comment_ctime":1559360414,"is_pvip":false,"replies":[{"id":"36161","content":"content_by_lua是用来处理内容的，proxy_pass也是。所以这两个不能同时在一个 location 中使用，这个在 content_by_lua 的文档中有说明。<br>set_by_lua 中现在不能使用 cosocket，但可以用 ngx.timer 的方式绕过。","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559554070,"ip_address":"","comment_id":99931,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559360414","product_id":100028301,"comment_content":"温铭老师，你好，有一个问题需要请教下，有一个功能需要实现，就是动态实现proxy_pass的功能，请求不同的url访问，获取path的第一个路径，我们定义为不同的*-api，然后redis查询出对应的proxy-pass的地址，尝试过rewrite_by_lua，但是会把post请求改写为GET，set_by_lua阶段不能链接redis，只能使用content_by_lua，这个阶段，处理内容，传值upstream的值，然后proxy_pass $upstream，这样的设想能成立吗？","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452331,"discussion_content":"content_by_lua是用来处理内容的，proxy_pass也是。所以这两个不能同时在一个 location 中使用，这个在 content_by_lua 的文档中有说明。\nset_by_lua 中现在不能使用 cosocket，但可以用 ngx.timer 的方式绕过。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559554070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99900,"user_name":"乔克","can_delete":false,"product_type":"c1","uid":1315273,"ip_address":"","ucode":"28A797A4235B78","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/c9/c3eae895.jpg","comment_is_top":false,"comment_ctime":1559355716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559355716","product_id":100028301,"comment_content":"思考题，就是把配置文件单独存放在一个文件，主配置导入就好，很多软件，语言都这么干的。","like_count":0},{"had_liked":false,"id":99525,"user_name":"王斌","can_delete":false,"product_type":"c1","uid":1160774,"ip_address":"","ucode":"B08B97FFC0362D","user_header":"https://static001.geekbang.org/account/avatar/00/11/b6/46/b17cbaff.jpg","comment_is_top":false,"comment_ctime":1559235742,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559235742","product_id":100028301,"comment_content":"茅塞顿开！","like_count":1},{"had_liked":false,"id":99461,"user_name":"mrmsl","can_delete":false,"product_type":"c1","uid":1113160,"ip_address":"","ucode":"38BBF13C98985C","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/48/b5a57b72.jpg","comment_is_top":false,"comment_ctime":1559221657,"is_pvip":true,"replies":[{"id":"36661","content":"多谢补充，docker 的安装一直没有在官网的文档中出现，这也与技术偏好有关。","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559957978,"ip_address":"","comment_id":99461,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559221657","product_id":100028301,"comment_content":"安装的话，没有提到docker","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452119,"discussion_content":"多谢补充，docker 的安装一直没有在官网的文档中出现，这也与技术偏好有关。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559957978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99444,"user_name":"aaron","can_delete":false,"product_type":"c1","uid":1544943,"ip_address":"","ucode":"48420629B0F9E9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLCuE3s45as7KQgkia9un9Jm3xllqd1tUV0ugKg6Iial7Es6prgHJMpibjfcwdrJApXbhR1SOaibZu09w/132","comment_is_top":false,"comment_ctime":1559216040,"is_pvip":false,"replies":[{"id":"35798","content":"后面会讲到代码热加载：）","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559270830,"ip_address":"","comment_id":99444,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559216040","product_id":100028301,"comment_content":"我试了一下，使用content_by_lua_file调用了hello.lua，更改lua文件的内容还是需要reload才会生效啊？之前你说的车不停就换了发动机，我还以为是改完脚本不用reload直接生效呢","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452111,"discussion_content":"后面会讲到代码热加载：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559270830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99392,"user_name":"Netfeel","can_delete":false,"product_type":"c1","uid":1545509,"ip_address":"","ucode":"E92F9ED37849A0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/cnNBSrNVDiagXWXkdWPnRxFh4D8oIbgnbiaA8WhIMkfI2vmemzTX3001YibnaPXHMRmCP5S6cGA7oHHLPHRBricr8g/132","comment_is_top":false,"comment_ctime":1559205322,"is_pvip":false,"replies":[{"id":"35800","content":"并没有...我用的是 lua 的扩展","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559271059,"ip_address":"","comment_id":99392,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559205322","product_id":100028301,"comment_content":"vscode 有没有好用的openresty 扩展？共享一下","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452091,"discussion_content":"并没有...我用的是 lua 的扩展","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559271059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99207,"user_name":"1900","can_delete":false,"product_type":"c1","uid":1215154,"ip_address":"","ucode":"AD49B624009032","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/b2/2d578012.jpg","comment_is_top":false,"comment_ctime":1559177968,"is_pvip":false,"replies":[{"id":"35660","content":"再用到特定接口和场景的时候才会有问题","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559193521,"ip_address":"","comment_id":99207,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559177968","product_id":100028301,"comment_content":"我以前都是自己指定官方openssl编译的，用起来好像没什么毛病啊，参数如下：<br><br>--with-openssl=..&#47;openssl-1.1.0j \\<br>--with-zlib=..&#47;zlib-1.2.11 \\<br>--with-pcre=..&#47;pcre-8.43 \\","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452020,"discussion_content":"再用到特定接口和场景的时候才会有问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99202,"user_name":"言十年","can_delete":false,"product_type":"c1","uid":1110039,"ip_address":"","ucode":"67B8B49C3A3B17","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/17/796a3d20.jpg","comment_is_top":false,"comment_ctime":1559177588,"is_pvip":true,"replies":[{"id":"35659","content":"brew 其实就是在你本地编译安装的，和 rpm 不同。总结的不错：）","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559193331,"ip_address":"","comment_id":99202,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559177588","product_id":100028301,"comment_content":"嗯，编译安装也方便。嘿嘿。我有的是brew安装的有的是编译安装的。<br><br>做过的一个功能总结了一个blog<br><br>https:&#47;&#47;www.jianshu.com&#47;p&#47;03a45077f658","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452017,"discussion_content":"brew 其实就是在你本地编译安装的，和 rpm 不同。总结的不错：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99180,"user_name":"Panda","can_delete":false,"product_type":"c1","uid":1095740,"ip_address":"","ucode":"911A200C7B18BE","user_header":"https://static001.geekbang.org/account/avatar/00/10/b8/3c/1a294619.jpg","comment_is_top":false,"comment_ctime":1559175221,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559175221","product_id":100028301,"comment_content":"温铭老师你好  想请教一下 大型的Openresty中 Lua 代码怎么组织 怎么做工程化  目录划分 模块拆分  编码规范 等","like_count":0},{"had_liked":false,"id":99178,"user_name":"Panda","can_delete":false,"product_type":"c1","uid":1095740,"ip_address":"","ucode":"911A200C7B18BE","user_header":"https://static001.geekbang.org/account/avatar/00/10/b8/3c/1a294619.jpg","comment_is_top":false,"comment_ctime":1559175158,"is_pvip":false,"replies":[{"id":"35657","content":"没错","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559193206,"ip_address":"","comment_id":99178,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559175158","product_id":100028301,"comment_content":"Lua 代码可以单独抽出一个目录  然后用指令指定 lua 代码路径即可 ","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452005,"discussion_content":"没错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99146,"user_name":"tux","can_delete":false,"product_type":"c1","uid":1477811,"ip_address":"","ucode":"BB7202009FC885","user_header":"https://static001.geekbang.org/account/avatar/00/16/8c/b3/a74a7125.jpg","comment_is_top":false,"comment_ctime":1559170357,"is_pvip":false,"replies":[{"id":"35658","content":"不用","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559193265,"ip_address":"","comment_id":99146,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559170357","product_id":100028301,"comment_content":"使用yum安装，是否需要 yum update 呢？(版本CentOS7.3)","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451990,"discussion_content":"不用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99077,"user_name":"Roger","can_delete":false,"product_type":"c1","uid":1350628,"ip_address":"","ucode":"A1EA3FAFA2AFAA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoZU29OgA5ssuB7jicNXGlo2FHkibs0VZJoZ2fOgYjCoiaibz7qaic6JA0NWgOniaDqRkExA7Wt9pmd1SKw/132","comment_is_top":false,"comment_ctime":1559139643,"is_pvip":false,"replies":[{"id":"35799","content":"Valgrind 在 mac 下并不稳定 :(<br>建议在 centos 下试试","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559271031,"ip_address":"","comment_id":99077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559139643","product_id":100028301,"comment_content":"这个报错是怎么造成的？<br><br>RogerKdeMacBook-Air:~ roger$ uname -a<br>Darwin RogerKdeMacBook-Air.local 17.7.0 Darwin Kernel Version 17.7.0: Wed Apr 24 21:17:24 PDT 2019; root:xnu-4570.71.45~1&#47;RELEASE_X86_64 x86_64<br><br>RogerKdeMacBook-Air:~ roger$ valgrind --version<br>valgrind-3.14.0<br><br>RogerKdeMacBook-Air:~ roger$ resty --valgrind  -e &quot;ngx.say(&#39;hello world&#39;); &quot;<br>bad executable (__PAGEZERO is not 4 GB)<br>valgrind: &#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.15.8.1&#47;nginx&#47;sbin&#47;nginx: cannot execute binary file<br><br>RogerKdeMacBook-Air:~ roger$ ls -l &#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.15.8.1&#47;nginx&#47;sbin&#47;nginx<br>-rwxr-xr-x  1 roger  admin  1707408  5 29 21:29 &#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.15.8.1&#47;nginx&#47;sbin&#47;nginx","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451964,"discussion_content":"Valgrind 在 mac 下并不稳定 :(\n建议在 centos 下试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559271031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99015,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1559130764,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559130764","product_id":100028301,"comment_content":"老师请问一下, 我是在docker的linux容器中启动的openresty, 启动openresty服务没有报错, 但是执行curl时候报错curl: (7) Failed connect to 127.0.0.1:8080; Connection refused, 想问下这是什么原因?","like_count":0},{"had_liked":false,"id":99001,"user_name":"baiyutang","can_delete":false,"product_type":"c1","uid":1032236,"ip_address":"","ucode":"FD2436978BB447","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c0/2c/87cc08ce.jpg","comment_is_top":false,"comment_ctime":1559128466,"is_pvip":false,"replies":[{"id":"35654","content":"可以的，分开目录就行","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559193140,"ip_address":"","comment_id":99001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559128466","product_id":100028301,"comment_content":"Ubuntu系统，可以用apt安装openresty和原本的nginx服务共存么？","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451929,"discussion_content":"可以的，分开目录就行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559193140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98903,"user_name":"旺旺","can_delete":false,"product_type":"c1","uid":1159196,"ip_address":"","ucode":"FE2CF90F446BFB","user_header":"https://static001.geekbang.org/account/avatar/00/11/b0/1c/2e30eeb8.jpg","comment_is_top":false,"comment_ctime":1559114793,"is_pvip":false,"replies":[{"id":"35804","content":"是的","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559271693,"ip_address":"","comment_id":98903,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559114793","product_id":100028301,"comment_content":"ERROR: failed to run command &quot;valgrind &#47;usr&#47;local&#47;Cellar&#47;openresty&#47;1.15.8.1&#47;nginx&#47;sbin&#47;nginx -p &#47;tmp&#47;resty_NSgqLVYOMJ&#47; -c conf&#47;nginx.conf&quot;: No such file or directory<br>这个报错是因为valgrind没有安装吗？需要安装才行的吧","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451885,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559271693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98734,"user_name":"六维","can_delete":false,"product_type":"c1","uid":1022887,"ip_address":"","ucode":"EB1C15AC06A8DF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/a7/440aff07.jpg","comment_is_top":false,"comment_ctime":1559088324,"is_pvip":false,"replies":[{"id":"35363","content":"没错，是这个思路","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559098162,"ip_address":"","comment_id":98734,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559088324","product_id":100028301,"comment_content":"想到的是包含和引入（引用）","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451814,"discussion_content":"没错，是这个思路","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559098162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98733,"user_name":"Mac Kwan","can_delete":false,"product_type":"c1","uid":1001958,"ip_address":"","ucode":"FC80EBC9CD37A8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/e6/4f00fe55.jpg","comment_is_top":false,"comment_ctime":1559088200,"is_pvip":false,"replies":[{"id":"35357","content":"嗯，OpenResty 有类似的框架，比如Vanilla和Lapis","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559098041,"ip_address":"","comment_id":98733,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559088200","product_id":100028301,"comment_content":"接触NGINX或OpenResty不深，不知道对不对。假如参考别的语言的mvc框架，那应该是把相关的lua代码写成多个controller控制器，然后加上路由配置管理lua代码去分块管理日渐增长的代码逻辑","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451813,"discussion_content":"嗯，OpenResty 有类似的框架，比如Vanilla和Lapis","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559098041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98705,"user_name":"沈奇才","can_delete":false,"product_type":"c1","uid":1307003,"ip_address":"","ucode":"4AC2F41F7E6374","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/7b/0f9d7a2f.jpg","comment_is_top":false,"comment_ctime":1559060944,"is_pvip":false,"replies":[{"id":"35364","content":"没错，是这个思路","user_name":"作者回复","user_name_real":"温铭@OpenResty","uid":"1017955","ctime":1559098167,"ip_address":"","comment_id":98705,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559060944","product_id":100028301,"comment_content":"通过include方式引入lua代码，和那个c的include差不多撒。。","like_count":0,"discussions":[{"author":{"id":1017955,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/63/88cf886d.jpg","nickname":"温铭@APISIX","note":"","ucode":"343567571DA16A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451799,"discussion_content":"没错，是这个思路","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559098167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}