{"id":105614,"title":"18 | 四通八达：HTTP的重定向和跳转","content":"<p>在专栏<a href=\"https://time.geekbang.org/column/article/97837\">第1讲</a>时我曾经说过，为了实现在互联网上构建超链接文档系统的设想，蒂姆·伯纳斯-李发明了万维网，使用HTTP协议传输“超文本”，让全世界的人都能够自由地共享信息。</p><p>“超文本”里含有“超链接”，可以从一个“超文本”跳跃到另一个“超文本”，对线性结构的传统文档是一个根本性的变革。</p><p>能够使用“超链接”在网络上任意地跳转也是万维网的一个关键特性。它把分散在世界各地的文档连接在一起，形成了复杂的网状结构，用户可以在查看时随意点击链接、转换页面。再加上浏览器又提供了“前进”“后退”“书签”等辅助功能，让用户在文档间跳转时更加方便，有了更多的主动性和交互性。</p><p>那么，点击页面“链接”时的跳转是怎样的呢？具体一点，比如在Nginx的主页上点了一下“download”链接，会发生什么呢？</p><p>结合之前的课程，稍微思考一下你就能得到答案：浏览器首先要解析链接文字里的URI。</p><pre><code>http://nginx.org/en/download.html\n</code></pre><p>再用这个URI发起一个新的HTTP请求，获取响应报文后就会切换显示内容，渲染出新URI指向的页面。</p><p>这样的跳转动作是由浏览器的使用者主动发起的，可以称为“<strong>主动跳转</strong>”，但还有一类跳转是由服务器来发起的，浏览器使用者无法控制，相对地就可以称为“<strong>被动跳转</strong>”，这在HTTP协议里有个专门的名词，叫做“<strong>重定向</strong>”（Redirection）。</p><!-- [[[read_end]]] --><h2>重定向的过程</h2><p>其实之前我们就已经见过重定向了，在<a href=\"https://time.geekbang.org/column/article/102483\">第12讲</a>里3××状态码时就说过，301是“永久重定向”，302是“临时重定向”，浏览器收到这两个状态码就会跳转到新的URI。</p><p>那么，它们是怎么做到的呢？难道仅仅用这两个代码就能够实现跳转页面吗？</p><p>先在实验环境里看一下重定向的过程吧，用Chrome访问URI “/18-1”，它会使用302立即跳转到“/index.html”。</p><p><img src=\"https://static001.geekbang.org/resource/image/ad/2d/ad5eb7546ee7ef62a9987120934b592d.png?wh=2100*652\" alt=\"\"></p><p>从这个实验可以看到，这一次“重定向”实际上发送了两次HTTP请求，第一个请求返回了302，然后第二个请求就被重定向到了“/index.html”。但如果不用开发者工具的话，你是完全看不到这个跳转过程的，也就是说，重定向是“用户无感知”的。</p><p>我们再来看看第一个请求返回的响应报文：</p><p><img src=\"https://static001.geekbang.org/resource/image/a4/ac/a4276db758bf90f63fd5a5c2357af4ac.png?wh=1900*739\" alt=\"\"></p><p>这里出现了一个新的头字段“Location: /index.html”，它就是301/302重定向跳转的秘密所在。</p><p>“<strong>Location</strong>”字段属于响应字段，必须出现在响应报文里。但只有配合301/302状态码才有意义，它<strong>标记了服务器要求重定向的URI</strong>，这里就是要求浏览器跳转到“index.html”。</p><p>浏览器收到301/302报文，会检查响应头里有没有“Location”。如果有，就从字段值里提取出URI，发出新的HTTP请求，相当于自动替我们点击了这个链接。</p><p>在“Location”里的URI既可以使用绝对URI，也可以使用相对URI。所谓“绝对URI”，就是完整形式的URI，包括scheme、host:port、path等。所谓“相对URI”，就是省略了scheme和host:port，只有path和query部分，是不完整的，但可以从请求上下文里计算得到。</p><p>例如，刚才的实验例子里的“Location: /index.html”用的就是相对URI。它没有说明访问URI的协议和主机，但因为是由“<a href=\"http://www.chrono.com/18-1\">http://www.chrono.com/18-1</a>”重定向返回的响应报文，所以浏览器就可以拼出完整的URI：</p><pre><code>http://www.chrono.com/index.html\n</code></pre><p>实验环境的URI“/18-1”还支持使用query参数“dst=xxx”，指明重定向的URI，你可以用这种形式再多试几次重定向，看看浏览器是如何工作的。</p><pre><code>http://www.chrono.com/18-1?dst=/15-1?name=a.json\nhttp://www.chrono.com/18-1?dst=/17-1\n</code></pre><p>注意，在重定向时如果只是在站内跳转，你可以放心地使用相对URI。但如果要跳转到站外，就必须用绝对URI。</p><p>例如，如果想跳转到Nginx官网，就必须在“nginx.org”前把“http://”都写出来，否则浏览器会按照相对URI去理解，得到的就会是一个不存在的URI“<a href=\"http://www.chrono.com/nginx.org%E2%80%9D\">http://www.chrono.com/nginx.org”</a></p><pre><code>http://www.chrono.com/18-1?dst=nginx.org           #错误\nhttp://www.chrono.com/18-1?dst=http://nginx.org    #正确\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/00/aa/006059602ee75b176a80429f49ffc9aa.png?wh=1900*826\" alt=\"\"></p><p>那么，如果301/302跳转时没有Location字段会怎么样呢？</p><p>这个你也可以自己试一下，使用第12讲里的URI“/12-1”，查询参数用“code=302”：</p><pre><code>http://www.chrono.com/12-1?code=302\n</code></pre><h2>重定向状态码</h2><p>刚才我把重定向的过程基本讲完了，现在来说一下重定向用到的状态码。</p><p>最常见的重定向状态码就是301和302，另外还有几个不太常见的，例如303、307、308等。它们最终的效果都差不多，让浏览器跳转到新的URI，但语义上有一些细微的差别，使用的时候要特别注意。</p><p><strong>301</strong>俗称“永久重定向”（Moved Permanently），意思是原URI已经“永久”性地不存在了，今后的所有请求都必须改用新的URI。</p><p>浏览器看到301，就知道原来的URI“过时”了，就会做适当的优化。比如历史记录、更新书签，下次可能就会直接用新的URI访问，省去了再次跳转的成本。搜索引擎的爬虫看到301，也会更新索引库，不再使用老的URI。</p><p><strong>302</strong>俗称“临时重定向”（“Moved Temporarily”），意思是原URI处于“临时维护”状态，新的URI是起“顶包”作用的“临时工”。</p><p>浏览器或者爬虫看到302，会认为原来的URI仍然有效，但暂时不可用，所以只会执行简单的跳转页面，不记录新的URI，也不会有其他的多余动作，下次访问还是用原URI。</p><p>301/302是最常用的重定向状态码，在3××里剩下的几个还有：</p><ul>\n<li>303 See Other：类似302，但要求重定向后的请求改为GET方法，访问一个结果页面，避免POST/PUT重复操作；</li>\n<li>307 Temporary Redirect：类似302，但重定向后请求里的方法和实体不允许变动，含义比302更明确；</li>\n<li>308 Permanent Redirect：类似307，不允许重定向后的请求变动，但它是301“永久重定向”的含义。</li>\n</ul><p>不过这三个状态码的接受程度较低，有的浏览器和服务器可能不支持，开发时应当慎重，测试确认浏览器的实际效果后才能使用。</p><h2>重定向的应用场景</h2><p>理解了重定向的工作原理和状态码的含义，我们就可以<strong>在服务器端拥有主动权</strong>，控制浏览器的行为，不过要怎么利用重定向才好呢？</p><p>使用重定向跳转，核心是要理解“<strong>重定向</strong>”和“<strong>永久/临时</strong>”这两个关键词。</p><p>先来看什么时候需要重定向。</p><p>一个最常见的原因就是“<strong>资源不可用</strong>”，需要用另一个新的URI来代替。</p><p>至于不可用的原因那就很多了。例如域名变更、服务器变更、网站改版、系统维护，这些都会导致原URI指向的资源无法访问，为了避免出现404，就需要用重定向跳转到新的URI，继续为网民提供服务。</p><p>另一个原因就是“<strong>避免重复</strong>”，让多个网址都跳转到一个URI，增加访问入口的同时还不会增加额外的工作量。</p><p>例如，有的网站都会申请多个名称类似的域名，然后把它们再重定向到主站上。比如，你可以访问一下“qq.com”“github.com ”“bing.com”（记得事先清理缓存），看看它是如何重定向的。</p><p>决定要实行重定向后接下来要考虑的就是“永久”和“临时”的问题了，也就是选择301还是302。</p><p>301的含义是“<strong>永久</strong>”的。</p><p>如果域名、服务器、网站架构发生了大幅度的改变，比如启用了新域名、服务器切换到了新机房、网站目录层次重构，这些都算是“永久性”的改变。原来的URI已经不能用了，必须用301“永久重定向”，通知浏览器和搜索引擎更新到新地址，这也是搜索引擎优化（SEO）要考虑的因素之一。</p><p>302的含义是“<strong>临时</strong>”的。</p><p>原来的URI在将来的某个时间点还会恢复正常，常见的应用场景就是系统维护，把网站重定向到一个通知页面，告诉用户过一会儿再来访问。另一种用法就是“服务降级”，比如在双十一促销的时候，把订单查询、领积分等不重要的功能入口暂时关闭，保证核心服务能够正常运行。</p><h2>重定向的相关问题</h2><p>重定向的用途很多，掌握了重定向，就能够在架设网站时获得更多的灵活性，不过在使用时还需要注意两个问题。</p><p>第一个问题是“<strong>性能损耗</strong>”。很明显，重定向的机制决定了一个跳转会有两次请求-应答，比正常的访问多了一次。</p><p>虽然301/302报文很小，但大量的跳转对服务器的影响也是不可忽视的。站内重定向还好说，可以长连接复用，站外重定向就要开两个连接，如果网络连接质量差，那成本可就高多了，会严重影响用户的体验。</p><p>所以重定向应当适度使用，决不能滥用。</p><p>第二个问题是“<strong>循环跳转</strong>”。如果重定向的策略设置欠考虑，可能会出现“A=&gt;B=&gt;C=&gt;A”的无限循环，不停地在这个链路里转圈圈，后果可想而知。</p><p>所以HTTP协议特别规定，浏览器必须具有检测“循环跳转”的能力，在发现这种情况时应当停止发送请求并给出错误提示。</p><p>实验环境的URI“/18-2”就模拟了这样的一个“循环跳转”，它跳转到“/18-1”，并用参数“dst=/18-2”再跳回自己，实现了两个URI的无限循环。</p><p>使用Chrome访问这个地址，会得到“该网页无法正常运作”的结果：</p><p><img src=\"https://static001.geekbang.org/resource/image/4b/2f/4b91aeea08d90f173c62493934e5f52f.png?wh=1700*973\" alt=\"\"></p><h2>小结</h2><p>今天我们学习了HTTP里的重定向和跳转，简单小结一下这次的内容：</p><ol>\n<li><span class=\"orange\">重定向是服务器发起的跳转，要求客户端改用新的URI重新发送请求，通常会自动进行，用户是无感知的；</span></li>\n<li><span class=\"orange\">301/302是最常用的重定向状态码，分别是“永久重定向”和“临时重定向”；</span></li>\n<li><span class=\"orange\">响应头字段Location指示了要跳转的URI，可以用绝对或相对的形式；</span></li>\n<li><span class=\"orange\">重定向可以把一个URI指向另一个URI，也可以把多个URI指向同一个URI，用途很多；</span></li>\n<li><span class=\"orange\">使用重定向时需要当心性能损耗，还要避免出现循环跳转。</span></li>\n</ol><h2>课下作业</h2><ol>\n<li>301和302非常相似，试着结合第12讲，用自己的理解再描述一下两者的异同点。</li>\n<li>你能结合自己的实际情况，再列出几个应当使用重定向的场景吗？</li>\n</ol><p>欢迎你把自己的学习体会写在留言区，与我和其他同学一起讨论。如果你觉得有所收获，也欢迎把文章分享给你的朋友。</p><p><img src=\"https://static001.geekbang.org/resource/image/9b/05/9b873d25e33f86bb2818fc8b50fbff05.png?wh=1769*3215\" alt=\"unpreview\"></p><p></p>","comments":[{"had_liked":false,"id":199031,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1585476806,"is_pvip":false,"replies":[{"id":"74801","content":"1.内部重定向对于用户来说成本低，因为只在网站服务器内部跳转，所谓的router。<br><br>2.对，这是最常见的应用场景之一。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585530969,"ip_address":"","comment_id":199031,"utype":1}],"discussion_count":6,"race_medal":0,"score":"177679135942","product_id":100029001,"comment_content":"之前面试官好像比较喜欢问外部重定向和内部重定向的区别？<br>外部重定向，服务器会把重定向的地址给浏览器，然后浏览器再次的发起请求，地址栏的地址变化了。<br>内部重定向，服务器会直接把重定向的资源返给浏览器，不需要再次在浏览器发起请求，地址栏的地址不变。<br>重定向我的经验，主要用在未登录或者权限不足的场景，跳转到对应的登录或提升页面之中。<br>当然，通用的SSO也是这样做的。","like_count":41,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489781,"discussion_content":"1.内部重定向对于用户来说成本低，因为只在网站服务器内部跳转，所谓的router。\n\n2.对，这是最常见的应用场景之一。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585530969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349163,"discussion_content":"无论内部，还是外部重定向地址栏都变，具体可以观察jd.com的重定向。\n区别仅在于重定向发起的主体。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1612943117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1172072,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e2/68/e649ee8c.jpg","nickname":"程序员小张","note":"","ucode":"F508460C0FC95A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581994,"discussion_content":"第一点说错了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659105210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1216377,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8f/79/766c3f20.jpg","nickname":"LH","note":"","ucode":"9ADE270D1E66B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360850,"discussion_content":"第一说得不对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616548959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1763395,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/e8/43/f9c0faed.jpg","nickname":"小童","note":"","ucode":"300444B520E79D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352619,"discussion_content":"问下你说的通用sso是指什么？因为我没听过sso","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614781108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1576416,"avatar":"https://static001.geekbang.org/account/avatar/00/18/0d/e0/69f8ca51.jpg","nickname":"许祺😶","note":"","ucode":"59FE21392BC7AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1763395,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/e8/43/f9c0faed.jpg","nickname":"小童","note":"","ucode":"300444B520E79D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536994,"discussion_content":"单点登录","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638930223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":352619,"ip_address":""},"score":536994,"extra":""}]}]},{"had_liked":false,"id":196542,"user_name":"Geek_5b0e47","can_delete":false,"product_type":"c1","uid":1822723,"ip_address":"","ucode":"3D6F1426B0593D","user_header":"","comment_is_top":false,"comment_ctime":1585292296,"is_pvip":false,"replies":[{"id":"74437","content":"great。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585295192,"ip_address":"","comment_id":196542,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57419867144","product_id":100029001,"comment_content":"笔记：<br>主动跳转：跳转动作是由浏览器的使用者主动发起的;<br>被动跳转：跳转动作是由服务器发起的，浏览器使用者无法控制。<br><br>1、重定向状态码<br><br>301：俗称“永久重定向”，原URI已经“永久”性地不存在了，今后的所有请求都必须改用新的URI.<br>302: 俗称“临时重定向”，原URI处于“临时维护”状态，新的URI是起“顶包”作用的临时工。<br>303 See Other: 类似302，但要求重定向后的请求改为GET方法，访问一个结果页面，避免POST&#47;PUT重复操作；<br>307 Temporary Redirect: 类似302，但重定向后请求里的方法和实体不允许变动，含义比302更明确；<br>308 Permanent Redirect: 类似307，不允许重定向后的请求变动，但它是301“永久重定向”的含义<br><br>2、重定向的应用场景<br>一个最常见的原因就是“资源不可用”，需要用另一个新的URI来代替。<br>不可用的原因：如域名变更、服务器变更、网站改版、系统维护。<br>另一个原因就是“避免重复”，让多个网址都跳转到一个URI，增加访问入口的同时还不会增加额外的工作量。如：有的网站会申请多个名称类似的域名，然后把它们重定向到主站上。<br><br>3、重定向的相关问题<br>第一个问题是“性能损耗”。重定向的机制决定了一个跳转会有两次请求-应答，比正常的访问多了一次。<br>第二个问题是“循环跳转”。如果重定向的策略设置欠考虑，可能会出现“A=&gt;B=&gt;C=&gt;A”的无限循环。","like_count":14,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489325,"discussion_content":"great。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585295192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125402,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1566179702,"is_pvip":false,"replies":[{"id":"46165","content":"对于单次请求来说是没什么差别的，但浏览器会对301做优化，后续的请求就不会再有跳转动作，所以会快一些。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566260209,"ip_address":"","comment_id":125402,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44515852662","product_id":100029001,"comment_content":"老师，使用301会比302有较大的性能提升么","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463562,"discussion_content":"对于单次请求来说是没什么差别的，但浏览器会对301做优化，后续的请求就不会再有跳转动作，所以会快一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566260209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":158171,"user_name":"夏目","can_delete":false,"product_type":"c1","uid":1212750,"ip_address":"","ucode":"67C075A01CF4D2","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/4e/d71092f4.jpg","comment_is_top":false,"comment_ctime":1575341780,"is_pvip":false,"replies":[{"id":"60605","content":"说的很好。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1575354838,"ip_address":"","comment_id":158171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40230047444","product_id":100029001,"comment_content":"1、301用于废弃原地址跳转新地址，302用于暂时无法访问原地址跳转新地址，两者都需要浏览器重新发起一次请求<br>2、最开始接触重定向的时候就是用于未登录跳转登录页了","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476651,"discussion_content":"说的很好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575354838,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114828,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1563413098,"is_pvip":true,"replies":[{"id":"41933","content":"没有要求，当然可以跳转到https。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563421696,"ip_address":"","comment_id":114828,"utype":1}],"discussion_count":2,"race_medal":1,"score":"40218118762","product_id":100029001,"comment_content":"老师，这个301，302, 303重定向要求前后协议一致吗？http不能调转https?","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458832,"discussion_content":"没有要求，当然可以跳转到https。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563421696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1132569,"avatar":"https://static001.geekbang.org/account/avatar/00/11/48/19/14dd81d9.jpg","nickname":"铲铲队","note":"","ucode":"D16372C34B7AE3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552211,"discussion_content":"这样不会跨域吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645348393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228842,"user_name":"snake","can_delete":false,"product_type":"c1","uid":1217535,"ip_address":"","ucode":"A74B3D02B017FB","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/ff/87d8de89.jpg","comment_is_top":false,"comment_ctime":1592821889,"is_pvip":false,"replies":[{"id":"84410","content":"是这样的：首先与本站是一个连接，然后到外站，就必须再开一个连接，这样就是两个连接了，两次tcp握手，对于客户端成本就很高了，当然服务器是无所谓的。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592873665,"ip_address":"","comment_id":228842,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27362625665","product_id":100029001,"comment_content":"站外重定向就要开两个连接，如果网络连接质量差，那成本可就高多了，会严重影响用户的体验。<br>------------》<br>老师这个我不理解，站外重定向，比如重定向到其他网站，那客户端的连接跟自己的服务端应该就没有什么关系了吧？为什么还有两个连接呢？不是客户端应该跟其他网站的服务器连接吗？","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499211,"discussion_content":"是这样的：首先与本站是一个连接，然后到外站，就必须再开一个连接，这样就是两个连接了，两次tcp握手，对于客户端成本就很高了，当然服务器是无所谓的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592873665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111367,"user_name":"毛毛","can_delete":false,"product_type":"c1","uid":1249698,"ip_address":"","ucode":"AD520D0011227D","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/a2/33be69a6.jpg","comment_is_top":false,"comment_ctime":1562548391,"is_pvip":false,"replies":[{"id":"40607","content":"你说的“转发”指什么？是代理吗？如果是的话很快就会讲到。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562571860,"ip_address":"","comment_id":111367,"utype":1}],"discussion_count":4,"race_medal":0,"score":"27332352167","product_id":100029001,"comment_content":"重定向和转发的区别和用途，以后章节会讲吗？","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457321,"discussion_content":"你说的“转发”指什么？是代理吗？如果是的话很快就会讲到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562571860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1348052,"avatar":"https://static001.geekbang.org/account/avatar/00/14/91/d4/3785c799.jpg","nickname":"乐毅","note":"","ucode":"6361ADC9B0E8D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":54751,"discussion_content":"转发是服务器内部重定向","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1574312656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122992,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/b0/5d96b50e.jpg","nickname":"oo0oo","note":"","ucode":"A4DB2025E8051C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3591,"discussion_content":"活捉小灰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564623005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1003005,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","nickname":"许童童","note":"","ucode":"4B799C0C6BC678","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1313,"discussion_content":"活捉小灰一只，今天请假了吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1562557791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249158,"user_name":"lll","can_delete":false,"product_type":"c1","uid":2157054,"ip_address":"","ucode":"8EEA3BDF9E8ECF","user_header":"https://static001.geekbang.org/account/avatar/00/20/e9/fe/bc38c919.jpg","comment_is_top":false,"comment_ctime":1600483148,"is_pvip":false,"replies":[{"id":"91423","content":"比如说Google就注册了很多的域名，比如goo.gl、g.cn等等，但都指向的是同一个服务，这样对于用户来说就很方便，随便记一个就能访问。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1600501339,"ip_address":"","comment_id":249158,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18780352332","product_id":100029001,"comment_content":"“另一个原因就是“避免重复”，让多个网址都跳转到一个 URI，增加访问入口的同时还不会增加额外的工作量。”这句话怎么理解呢？","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505852,"discussion_content":"比如说Google就注册了很多的域名，比如goo.gl、g.cn等等，但都指向的是同一个服务，这样对于用户来说就很方便，随便记一个就能访问。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600501339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099379,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","nickname":"疯琴","note":"","ucode":"82ACAA4A27753D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383720,"discussion_content":"请问老师，这种多个域名解析到同一个后端服务器还算是跳转或者重定向么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626223609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":247153,"user_name":" 尿布","can_delete":false,"product_type":"c1","uid":1476323,"ip_address":"","ucode":"D1C8BDA7540962","user_header":"https://static001.geekbang.org/account/avatar/00/16/86/e3/a31f6869.jpg","comment_is_top":false,"comment_ctime":1599619356,"is_pvip":false,"replies":[{"id":"90766","content":"把重要的信息当做笔记保存起来，这个习惯很好。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1599629859,"ip_address":"","comment_id":247153,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18779488540","product_id":100029001,"comment_content":"重定向报文里还可以用Refresh字段，实现延时重定向，例如”Refresh: 5; url=xxx“告诉浏览器5秒钟后再跳转<br><br>与跳转有关的还有一个”Referer“和”Refereer-Policy“（注意前者是个拼写错误，但已经”将错就错“），表示浏览器跳转的来源（即引用地址），可用于统计分析和防盗链","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505328,"discussion_content":"把重要的信息当做笔记保存起来，这个习惯很好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599629859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226494,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1592121917,"is_pvip":true,"replies":[{"id":"83418","content":"说的挺好。<br><br>内部重定向是服务器内部处理流程的跳转，不会发给客户端让客户端去跳转。<br><br>Nginx同时支持外部和内部重定向，写法是不同的，区别就在于客户端是否有感知。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592144350,"ip_address":"","comment_id":226494,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18771991101","product_id":100029001,"comment_content":"1.好比去寄快递，我去到常去的寄送点，发现寄送店有一块告示栏，被告知当前地点近期处于维修状态，需要前往另一个临时寄送点办理（302状态码），临时地址即为location字段值。或者被告知当前寄送店已永久搬迁至新地址（301状态码），临时地址为location字段值。两者都表示当前访问地址已失效，区别在于一个为临时的，短期的，另一个为永久性的。<br>2.比如商城类的页面，需要浏览个人中心或者订单列表等页面时需要进行登录态校验，如果没有登录或者登录态失效了，需要重定向到登录页。某个页面进行了重构，且url发生了变化，由于老url遍布站点的很多页面，不好直接修改跳转url，此时将老url重定向到新url是比较合适的。<br>有个疑问请教一下老师：<br>内部重定向和外部重定向一般在使用场合上有什么区别？<br>查了一下 资料说内部重定向不会造成浏览器地址栏url的变化，实际对客户端是无感知的，只是代理转发到另一个url。个人感觉又不太对，因为资料上又说nginx的重定向是属于内部，但是实际客户端url确实变了，比较矛盾","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498263,"discussion_content":"说的挺好。\n\n内部重定向是服务器内部处理流程的跳转，不会发给客户端让客户端去跳转。\n\nNginx同时支持外部和内部重定向，写法是不同的，区别就在于客户端是否有感知。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592144350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279597,"user_name":"天方夜","can_delete":false,"product_type":"c1","uid":1034749,"ip_address":"","ucode":"5D17D55B0CE10C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c9/fd/5ac43929.jpg","comment_is_top":false,"comment_ctime":1613838780,"is_pvip":false,"replies":[{"id":"101608","content":"ajax属于前端技术了，我了解的不多，欢迎同学补充交流。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1613961484,"ip_address":"","comment_id":279597,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14498740668","product_id":100029001,"comment_content":"有同学提到 ajax 中的重定向，这是个有点复杂的问题。简单说，xhr 方式，存在 Location 的情况下只能看到重定向后的最终结果；fetch 方式，可以看到 Location，而且对于重定向有不同的处理模式，可以设置。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515791,"discussion_content":"ajax属于前端技术了，我了解的不多，欢迎同学补充交流。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613961484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279591,"user_name":"天方夜","can_delete":false,"product_type":"c1","uid":1034749,"ip_address":"","ucode":"5D17D55B0CE10C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c9/fd/5ac43929.jpg","comment_is_top":false,"comment_ctime":1613835313,"is_pvip":false,"replies":[{"id":"101604","content":"我觉得正文里的可以参考，就是看这个跳转是否是“临时”的，如果是永久条件就用301，而跟长短域名、http到https没有特别的关系。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1613961402,"ip_address":"","comment_id":279591,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14498737201","product_id":100029001,"comment_content":"从短域名跳长域名（z.cn - www.amazon.cn），从 http 跳 https，分别应当用哪种重定向，有没有最佳实践呢？","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515786,"discussion_content":"我觉得正文里的可以参考，就是看这个跳转是否是“临时”的，如果是永久条件就用301，而跟长短域名、http到https没有特别的关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613961402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125637,"user_name":"Geek_steven_wang","can_delete":false,"product_type":"c1","uid":1477120,"ip_address":"","ucode":"8CC8F4C9726191","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8mFt5wSkia31qc8paRg2uPSB6AuEBDricrSxvFBuTpP3NnnflekpJ7wqvN0nRrJyu7zVbzd7Lwjxw/132","comment_is_top":false,"comment_ctime":1566219020,"is_pvip":false,"replies":[{"id":"46193","content":"是的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566262121,"ip_address":"","comment_id":125637,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14451120908","product_id":100029001,"comment_content":"Sso就会用重定向引导用户登录。<br>但如果location中没有地址，那浏览器也不知跳转到那，会出错。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463638,"discussion_content":"是的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566262121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342145,"discussion_content":"试了一下http://www.chrono.com/12-1?code=302\n回应报文没有Location字段，也不会报错。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610596938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116957,"user_name":"信信","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1563946502,"is_pvip":false,"replies":[{"id":"42765","content":"建议打开开发者工具，看看uri是如何处理的。<br><br>比如http:&#47;&#47;www.chrono.com&#47;18-1?dst=&#47;15-1?name=a.json，应该是跳转到15-1。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563948312,"ip_address":"","comment_id":116957,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10153881094","product_id":100029001,"comment_content":"文中提到的所有链接都返回200，和访问http:&#47;&#47;www.chrono.com&#47;一个效果。。。。。。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459751,"discussion_content":"建议打开开发者工具，看看uri是如何处理的。\n\n比如http://www.chrono.com/18-1?dst=/15-1?name=a.json，应该是跳转到15-1。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563948312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3014444,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM74658w9PQeTM4TcM14BzfpJnVLrsciaS26ibRwRbCE09ydI6UlZhFrJh7iaVLp2xxhBppVDKLyRRg9Q/132","nickname":"Geek_21a73c","note":"","ucode":"104A4AD89DA6BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574972,"discussion_content":"Request URL: http://www.chrono.com/18-1?dst=/15-1?name=a.json\nRequest Method: GET\nStatus Code: 200 OK\nReferrer Policy: strict-origin-when-cross-origin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654504330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112103,"user_name":"响雨","can_delete":false,"product_type":"c1","uid":1581705,"ip_address":"","ucode":"C5FB3A3BC68F92","user_header":"https://static001.geekbang.org/account/avatar/00/18/22/89/73397ccb.jpg","comment_is_top":false,"comment_ctime":1562669583,"is_pvip":false,"replies":[{"id":"40763","content":"不错。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562677237,"ip_address":"","comment_id":112103,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10152604175","product_id":100029001,"comment_content":"我这边要做一个web升级，在升级过程中要展示升级进度，就打算301重定向到另一个服务来展示升级的进度","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457577,"discussion_content":"不错。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562677237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1198808,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4a/d8/21cf3642.jpg","nickname":"nil","note":"","ucode":"52E48324112210","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3252,"discussion_content":"升级是临时的，不应该是302吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564356219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1257043,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2e/53/bf62683f.jpg","nickname":"狼的诱惑","note":"","ucode":"AE89DFC5963C42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1198808,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4a/d8/21cf3642.jpg","nickname":"nil","note":"","ucode":"52E48324112210","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4648,"discussion_content":"我觉得也是啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565618488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3252,"ip_address":""},"score":4648,"extra":""}]}]},{"had_liked":false,"id":111360,"user_name":"TerryGoForIt","can_delete":false,"product_type":"c1","uid":1020644,"ip_address":"","ucode":"701B0E72F15AB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/e4/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1562548036,"is_pvip":false,"replies":[{"id":"40608","content":"对，但多了一次请求的成本，比较重。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562571879,"ip_address":"","comment_id":111360,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10152482628","product_id":100029001,"comment_content":"重定向可以应用于实现负载均衡。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457316,"discussion_content":"对，但多了一次请求的成本，比较重。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562571879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111343,"user_name":"饭饭","can_delete":false,"product_type":"c1","uid":1211118,"ip_address":"","ucode":"C29DDDB4A038EC","user_header":"https://static001.geekbang.org/account/avatar/00/12/7a/ee/257a22fb.jpg","comment_is_top":false,"comment_ctime":1562546672,"is_pvip":false,"replies":[{"id":"40609","content":"302不改变原uri，所以每次都会找原uri，成本较高，应当尽量少用。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562571932,"ip_address":"","comment_id":111343,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10152481264","product_id":100029001,"comment_content":"老师您好，<br>重定向，我一般使用在移动PC互切的情况下会使用，因为使用到了域名会不一样。还有一种情况会在判断浏览器的时候会使用到重定向，比如IE。。。<br><br>但是有一个问题，302是临时重定向，想问一下浏览器在每次访问的时候，都会直接访问原先URI吗？还是会有什么过期时间呢？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457312,"discussion_content":"302不改变原uri，所以每次都会找原uri，成本较高，应当尽量少用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562571932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288668,"user_name":"coral","can_delete":false,"product_type":"c1","uid":2538153,"ip_address":"","ucode":"C3ACEE05D00C02","user_header":"https://static001.geekbang.org/account/avatar/00/26/ba/a9/7432b796.jpg","comment_is_top":false,"comment_ctime":1618591814,"is_pvip":false,"replies":[{"id":"104864","content":"现在的网站都有这么一个趋势，用简短的域名，不用写出签名的“www”，但真正的域名还是有“www”的，所以就要用一个跳转。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1618787033,"ip_address":"","comment_id":288668,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5913559110","product_id":100029001,"comment_content":"一个问题：<br>打开qq.com的时候，浏览器进行了两次跳转：<br>http:&#47;&#47;qq.com =&gt; https:&#47;&#47;qq.com =&gt;https:&#47;&#47;www.qq.com <br>访问google.ca的时候也有类似的现象<br>http:&#47;&#47;google.ca&#47; =&gt; http:&#47;&#47;www.google.ca&#47; =&gt; https:&#47;&#47;www.google.ca&#47;?gws_rd=ssl<br><br>为什么要设计中间的那一层呢？从第一步直接redirect到最后一个url不行吗？<br><br>作业<br>1. 301 和 302 非常相似，试着结合第 12 讲，用自己的理解再描述一下两者的异同点。<br>同：两者都会让访问者知道，当前url不可用，并且会在location字段里回复你要去的的url。<br>异：<br>301: “永久重定向”（Moved Permanently），表示原来的页面永久不可用，所有优化的程序都可以更新了，如浏览器可以更新bookmark，爬虫更新搜索库。<br>302: “临时重定向”（“Moved Temporarily”），要访问的页面临时不可用了，优化程序不需更新，临时跳转一下即可。<br><br>2. 你能结合自己的实际情况，再列出几个应当使用重定向的场景吗？<br>需要更换域名&#47;页面url的时候，可以给旧的url设置一个重定向，导到新的url去，这样曾经bookmark旧url的用户也可以访问到新的内容而不会看到报错页面。<br>还有把http页面重定向到https、把不带www的页面重定向到www.开头的页面也是很常见的操作。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518703,"discussion_content":"现在的网站都有这么一个趋势，用简短的域名，不用写出签名的“www”，但真正的域名还是有“www”的，所以就要用一个跳转。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618787033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173515,"user_name":"keep it simple","can_delete":false,"product_type":"c1","uid":1574739,"ip_address":"","ucode":"72B8DC00247C9E","user_header":"https://static001.geekbang.org/account/avatar/00/18/07/53/05aa9573.jpg","comment_is_top":false,"comment_ctime":1579587149,"is_pvip":false,"replies":[{"id":"67273","content":"<br>1.这个没有错，书签是一个正确的地址，只是bing.com给了你一个301跳转，是否更新书签是浏览器的问题，这已经不是http协议的问题了，可以更新也可以不更新。<br><br>2.303可以用来防止客户端重复post，比如post一次，后续再多次post都转向一个固定的等待响应页面。<br><br>3.302、307这些都是对客户端的“指示”，表示服务器希望客户端接下来要怎么做最合适，决定权还是在客户端。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579595255,"ip_address":"","comment_id":173515,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5874554445","product_id":100029001,"comment_content":"老师你好，提交几个问题：<br>1.在自己的测试中，保存了一个https:&#47;&#47;bing.com的书签，访问后得到301，location为cn.bing.com，但书签中的地址并没有改变，还是https:&#47;&#47;bing.com。是否意味着我使用的浏览器没有遵循301的规范？<br>2.关于303的使用场景是什么？如果原请求方式就是POST，用于上传一组数据，然后服务器返回303，浏览器端只能用GET，那需要上传的数据就无法被上传了吧？<br>3.关于307的描述，言外之意是302可以改变请求里的方法和实体，但服务端只返回location的情况下，浏览器也不会改变请求方法和实体吧？<br>","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482093,"discussion_content":"\n1.这个没有错，书签是一个正确的地址，只是bing.com给了你一个301跳转，是否更新书签是浏览器的问题，这已经不是http协议的问题了，可以更新也可以不更新。\n\n2.303可以用来防止客户端重复post，比如post一次，后续再多次post都转向一个固定的等待响应页面。\n\n3.302、307这些都是对客户端的“指示”，表示服务器希望客户端接下来要怎么做最合适，决定权还是在客户端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579595255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123166,"user_name":"狼的诱惑","can_delete":false,"product_type":"c1","uid":1257043,"ip_address":"","ucode":"AE89DFC5963C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/2e/53/bf62683f.jpg","comment_is_top":false,"comment_ctime":1565619120,"is_pvip":false,"replies":[{"id":"45271","content":"<br>1.浏览器为了方便用户访问网页，肯定是要自动跳转到新的uri的。如果你用Python等语言自己实现客户端，那就可以自己定义处理策略了。<br><br>2.实验环境的lua源码都很简单，只有最小的服务器逻辑，如果能参照着看是最好的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565658419,"ip_address":"","comment_id":123166,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860586416","product_id":100029001,"comment_content":"老师好，又来请教问题了<br>1.状态码301，302是有些客户端遵循http规范默认支持吗？比如浏览器，是不是浏览器解析了返回状态码，解析到301或302然后解析出地响应头&#47;15-1地址然后又发起了一次http请求？能举例那些客户端不支持重定向吗？<br>2.我觉得看文章的同时，我们是不是结合着老师提供的实验源码，来了解整个来龙去脉，这样会更容易理解？虽然老师用的lua，但还是可以勉强看懂的","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462564,"discussion_content":"\n1.浏览器为了方便用户访问网页，肯定是要自动跳转到新的uri的。如果你用Python等语言自己实现客户端，那就可以自己定义处理策略了。\n\n2.实验环境的lua源码都很简单，只有最小的服务器逻辑，如果能参照着看是最好的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565658419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114895,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1563426531,"is_pvip":true,"replies":[{"id":"41946","content":"一直做后端，对前端的技术不是太了解，很抱歉无法回答你的问题。<br><br>重定向本质上是服务器向客户端发出的一个指示，如何做取决于客户端。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563431262,"ip_address":"","comment_id":114895,"utype":1}],"discussion_count":3,"race_medal":1,"score":"5858393827","product_id":100029001,"comment_content":"对于ajax请求，网上好多资料说不能处理重定向的请求比如321,302,303等，不能进行跳转，这个是为什么呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458871,"discussion_content":"一直做后端，对前端的技术不是太了解，很抱歉无法回答你的问题。\n\n重定向本质上是服务器向客户端发出的一个指示，如何做取决于客户端。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563431262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","nickname":"彧豪","note":"","ucode":"8979F477E0BC5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2480,"discussion_content":"ajax可以捕获服务端返回的状态码，以及响应头信息，你可以根据捕获到的状态码以及响应头信息做相应的处理，另外30x这个为何要用ajax来处理呢？如果是接口调整，你直接代码里面修改为新的接口，然后部署不就好了吗？一般30x都是在浏览器地址栏中输入url访问的时候做嘛，浏览器会自动处理啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563701461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1247522,"avatar":"https://static001.geekbang.org/account/avatar/00/13/09/22/22c0c4fa.jpg","nickname":"benying","note":"","ucode":"DEBAB485F381CC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":118015,"discussion_content":"昨晚遇到这么个问题，302前需要在request header里删掉 X-Requested-With才行，不然无法成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578146950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111432,"user_name":"业余草","can_delete":false,"product_type":"c1","uid":1126538,"ip_address":"","ucode":"99BDC1E629049D","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg","comment_is_top":false,"comment_ctime":1562556812,"is_pvip":false,"replies":[{"id":"40606","content":"学习态度端正，值得表扬。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562571789,"ip_address":"","comment_id":111432,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5857524108","product_id":100029001,"comment_content":"每周1、3、5等着老师更新！","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457354,"discussion_content":"学习态度端正，值得表扬。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562571789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353380,"user_name":"Geek_da4d45","can_delete":false,"product_type":"c1","uid":2889984,"ip_address":"北京","ucode":"B6094DE0FBCD5D","user_header":"","comment_is_top":false,"comment_ctime":1659409257,"is_pvip":false,"replies":[{"id":"128480","content":"抱歉，时间比较久了，具体来源记不清了，应该是在rfc上吧。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1659425889,"ip_address":"北京","comment_id":353380,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659409257","product_id":100029001,"comment_content":"罗老师，您好！<br>我对于 307 的描述比较感兴趣：<br>`307 Temporary Redirect：类似 302，但重定向后请求里的方法和实体不允许变动，含义比 302 更明确；`<br>但是我查阅了 [rfc](https:&#47;&#47;datatracker.ietf.org&#47;doc&#47;html&#47;rfc7231#section-6.4.7) 文档，文档中只说了适用于 POST 请求，没有对其他方法有描述，我想进一步了解一下您说的这个知识是从哪里获取到的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582411,"discussion_content":"抱歉，时间比较久了，具体来源记不清了，应该是在rfc上吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659425889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348736,"user_name":"LIKE","can_delete":false,"product_type":"c1","uid":1254252,"ip_address":"","ucode":"9DAB7F9051648A","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/6c/82ba5e1f.jpg","comment_is_top":false,"comment_ctime":1655359770,"is_pvip":false,"replies":[{"id":"127036","content":"这个完全在于服务器的处理逻辑，用不好不是协议的问题，而是使用者的问题。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1655711561,"ip_address":"","comment_id":348736,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1655359770","product_id":100029001,"comment_content":"301 和 302 实际应该中好像没有怎么区分，公司域名升级从http到https，访问http还是返回了302 . ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576629,"discussion_content":"这个完全在于服务器的处理逻辑，用不好不是协议的问题，而是使用者的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655711561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317717,"user_name":"功夫熊猫","can_delete":false,"product_type":"c1","uid":2732243,"ip_address":"","ucode":"D124F4FA4E816F","user_header":"https://static001.geekbang.org/account/avatar/00/29/b0/d3/200e82ff.jpg","comment_is_top":false,"comment_ctime":1634901795,"is_pvip":true,"replies":[{"id":"115165","content":"前端技术不是很了解，抱歉了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1634960495,"ip_address":"","comment_id":317717,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634901795","product_id":100029001,"comment_content":"vue-router里所谓的跳转也算跳转，它们跟所谓的服务器跳转有什么区别","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528942,"discussion_content":"前端技术不是很了解，抱歉了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634960495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306084,"user_name":"Noir","can_delete":false,"product_type":"c1","uid":1186981,"ip_address":"","ucode":"985D4C4A5E1E85","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/a5/226ce8a7.jpg","comment_is_top":false,"comment_ctime":1628335754,"is_pvip":false,"replies":[{"id":"110796","content":"对，这是一个很常见的用法。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1628423114,"ip_address":"","comment_id":306084,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628335754","product_id":100029001,"comment_content":"使用重定向的场景：<br>用电脑访问知乎主页（www.zhihu.com），会用 302 强制转跳到登录页","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524618,"discussion_content":"对，这是一个很常见的用法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628423114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303880,"user_name":"Geek_d1b4e1","can_delete":false,"product_type":"c1","uid":1515679,"ip_address":"","ucode":"349C689216672D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ZRuGPK9Rmo5icH649EpibcT5XL5zm15H62A0MWsuC3yNWNcke6j5gxF4Q5b6J7GQbOiczMAovceoQObttyP8HEfzQ/132","comment_is_top":false,"comment_ctime":1627043081,"is_pvip":true,"replies":[{"id":"110009","content":"看是否需要客户端（也就是浏览器）参与，如果是服务器内部业务逻辑跳转，就是内部重定向，如果是要浏览器访问非本服务器，那就会是外部重定向了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1627108470,"ip_address":"","comment_id":303880,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627043081","product_id":100029001,"comment_content":"老师，什么场景下适合内部重定向？什么场景下适合外部重定向？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523859,"discussion_content":"看是否需要客户端（也就是浏览器）参与，如果是服务器内部业务逻辑跳转，就是内部重定向，如果是要浏览器访问非本服务器，那就会是外部重定向了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627108470,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303358,"user_name":"Geek_630146","can_delete":false,"product_type":"c1","uid":2277584,"ip_address":"","ucode":"F97C6DBBC77895","user_header":"","comment_is_top":false,"comment_ctime":1626749937,"is_pvip":false,"replies":[{"id":"109810","content":"这个就不属于http协议的问题了，是应用系统如何去使用这些字段再处理的问题，http只能做到数据传输，之后怎么解释它管不到。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1626758850,"ip_address":"","comment_id":303358,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626749937","product_id":100029001,"comment_content":"重定向出现跨域怎么解决？<br>用户访问A系统，A系统去请求后端接口的过程中被网关转发到登录页面(登录页完全属于另外一个系统)，此时出现跨域问题；网关及另外的系统没有权限去做任何更改，能操作的只有A系统及后端。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523646,"discussion_content":"这个就不属于http协议的问题了，是应用系统如何去使用这些字段再处理的问题，http只能做到数据传输，之后怎么解释它管不到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626758850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298704,"user_name":"Miroticwillbeforever","can_delete":false,"product_type":"c1","uid":2488913,"ip_address":"","ucode":"1DDD8AECD93EA8","user_header":"https://static001.geekbang.org/account/avatar/00/25/fa/51/5da91010.jpg","comment_is_top":false,"comment_ctime":1624269768,"is_pvip":false,"replies":[{"id":"108369","content":"应该可以吧，Firefox对http协议的支持也是很好的，我之前也用Firefox做过测试，不过主要是以Chrome为主。<br><br>建议先用Chrome看看，与Firefox的表现做个对比。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1624323441,"ip_address":"","comment_id":298704,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624269768","product_id":100029001,"comment_content":"老师用 firefox访问这些资源都不行的吗，好多实验结果没法验证。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522215,"discussion_content":"应该可以吧，Firefox对http协议的支持也是很好的，我之前也用Firefox做过测试，不过主要是以Chrome为主。\n\n建议先用Chrome看看，与Firefox的表现做个对比。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624323441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297450,"user_name":"Alan He","can_delete":false,"product_type":"c1","uid":2033513,"ip_address":"","ucode":"A0780F4619D388","user_header":"https://static001.geekbang.org/account/avatar/00/1f/07/69/43cf2251.jpg","comment_is_top":false,"comment_ctime":1623558444,"is_pvip":false,"replies":[{"id":"108025","content":"这已经成了互联网历史上的一个典故了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1623635974,"ip_address":"","comment_id":297450,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623558444","product_id":100029001,"comment_content":"referer 这个拼写错误问题之前没注意，谢谢文章提醒。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521827,"discussion_content":"这已经成了互联网历史上的一个典故了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623635974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290506,"user_name":"huanshui@smile","can_delete":false,"product_type":"c1","uid":2141878,"ip_address":"","ucode":"0A334A3E20CA46","user_header":"https://static001.geekbang.org/account/avatar/00/20/ae/b6/fc1c61f8.jpg","comment_is_top":false,"comment_ctime":1619593974,"is_pvip":false,"replies":[{"id":"105280","content":"这个内部和外部是相对于web服务器而言的，不算是一个特别标准或者严谨的说法。<br><br>如果重定向是在服务器内部的uri之间跳转，实际上就是处理函数调用，所以没有什么成本。<br><br>如果重定向是向外发给了浏览器，然后浏览器再重定向到一个新的url，那么这个的成本就很高了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1619599653,"ip_address":"","comment_id":290506,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619593974","product_id":100029001,"comment_content":"对于外部重定向和内部重定向的定义还是不太理解，定义的标准是否是看有没有重新发起http请求？如果network中又重新发起了一次新的请求就称之为外部重定向，反之就是内部重定向？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519220,"discussion_content":"这个内部和外部是相对于web服务器而言的，不算是一个特别标准或者严谨的说法。\n\n如果重定向是在服务器内部的uri之间跳转，实际上就是处理函数调用，所以没有什么成本。\n\n如果重定向是向外发给了浏览器，然后浏览器再重定向到一个新的url，那么这个的成本就很高了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619599653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286076,"user_name":"LIKE","can_delete":false,"product_type":"c1","uid":1254252,"ip_address":"","ucode":"9DAB7F9051648A","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/6c/82ba5e1f.jpg","comment_is_top":false,"comment_ctime":1617151026,"is_pvip":false,"replies":[{"id":"103860","content":"可以参考第29讲，加上hsts，要求浏览器总使用https。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617154539,"ip_address":"","comment_id":286076,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617151026","product_id":100029001,"comment_content":"老师好，最近系统注册页升级由v 2升级到 v 3，访问原v 2地址会重定向到v 3，location用的是绝对路径，测试环境跳转正常，但线上环境经过重定向跳转后协议会从HTTPS 变为 HTTP。老师有碰过到类似问题吗？可能的原因是什么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517864,"discussion_content":"可以参考第29讲，加上hsts，要求浏览器总使用https。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617154539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283094,"user_name":"刘杰","can_delete":false,"product_type":"c1","uid":2460800,"ip_address":"","ucode":"5B3A55700D6063","user_header":"https://static001.geekbang.org/account/avatar/00/25/8c/80/7310baac.jpg","comment_is_top":false,"comment_ctime":1615544656,"is_pvip":false,"replies":[{"id":"102715","content":"great","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615554460,"ip_address":"","comment_id":283094,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615544656","product_id":100029001,"comment_content":"1、301是永久重定向，使用场景是服务器变更、域名变更时；302是临时重定向，可用在网站临时维护时。301和302都是浏览器进行的重定向，重定向的路径是从location字段里面取的，该字段既可以用相对URI也可以用绝对URI，如果是相同域名内跳转，则可以用相对URI，否则必须使用绝对URI。<br>2、输入错误的网址，但是域名输入正确了，可以在nginx中配置重定向到404页面；功能正在开发，但是入口已经开放了，可以将其重定向到“功能开发中”页面去","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516932,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615554460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281541,"user_name":"小童","can_delete":false,"product_type":"c1","uid":1763395,"ip_address":"","ucode":"300444B520E79D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e8/43/f9c0faed.jpg","comment_is_top":false,"comment_ctime":1614780601,"is_pvip":false,"replies":[{"id":"102217","content":"继续努力。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1614818425,"ip_address":"","comment_id":281541,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614780601","product_id":100029001,"comment_content":"涨知识了。以前都没听过","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516435,"discussion_content":"继续努力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614818425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264583,"user_name":"Geek_rdd","can_delete":false,"product_type":"c1","uid":1903361,"ip_address":"","ucode":"9BACC4E6963353","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0b/01/33605fc7.jpg","comment_is_top":false,"comment_ctime":1606532412,"is_pvip":false,"replies":[{"id":"95913","content":"303的含义很明确，但因为http协议很灵活，所以在实践中也不一定就完全遵守这些规定，实用第一。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1606553505,"ip_address":"","comment_id":264583,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1606532412","product_id":100029001,"comment_content":" 我们生产中没遇到过303的场景；相反，为了避免nginx会将302的请求的 POST&#47;PUT改为 GET 方法，我们会使用307，貌似百度也是这么做的。所以比较好奇303有哪些场景会用到……","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510611,"discussion_content":"303的含义很明确，但因为http协议很灵活，所以在实践中也不一定就完全遵守这些规定，实用第一。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606553505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234135,"user_name":"某知名患者","can_delete":false,"product_type":"c1","uid":1852186,"ip_address":"","ucode":"E87EF5059DAB0F","user_header":"https://static001.geekbang.org/account/avatar/00/1c/43/1a/53bd8833.jpg","comment_is_top":false,"comment_ctime":1594602974,"is_pvip":true,"replies":[{"id":"86394","content":"先修改hosts，然后清除一下浏览器的cache，不然会找到外面的网站，而不是本地的实验环境。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1594608092,"ip_address":"","comment_id":234135,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1594602974","product_id":100029001,"comment_content":"chrome浏览器输入http:&#47;&#47;www.chrono.com&#47;18-1会跳转到https:&#47;&#47;park.zunmi.cn&#47;?acct=660&amp;site=chrono.com&amp;t=1594602890000&amp;s=f232a9dbfab5e8191fd8b33d7cf50659&amp;fs=0&amp;channel=480306 ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501294,"discussion_content":"先修改hosts，然后清除一下浏览器的cache，不然会找到外面的网站，而不是本地的实验环境。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594608092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2549897,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/GeJFj6vZ5V5Piatibibiajiaxn9tf1beWHSrIPZzyn5t3Czm1lPUYWNkFIoh4Ol8gK07zH0k6LY94hcgZ2wosUGOKsg/132","nickname":"一亩三分地","note":"","ucode":"B0522ABBFFE2FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583492,"discussion_content":"8 成是没修改 hosts","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660142721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226378,"user_name":"潇潇雨歇","can_delete":false,"product_type":"c1","uid":1251429,"ip_address":"","ucode":"4BD52BF0F0A084","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","comment_is_top":false,"comment_ctime":1592056376,"is_pvip":false,"replies":[{"id":"83393","content":"这些天都很积极学习啊。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1592113007,"ip_address":"","comment_id":226378,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1592056376","product_id":100029001,"comment_content":"1、301是永久重定向，说明URI永久改变了，之前的URI不能访问了，需要访问新的URI。302则是暂时性重定向，之前的URI之后还是可以访问的，只是暂时有什么问题或者情况，比如暂停服务，网站升级等。<br>2、未登录重定向到登录页，网站升级维护，网站网址更换等","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498220,"discussion_content":"这些天都很积极学习啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592113007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1251429,"avatar":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","nickname":"潇潇雨歇","note":"","ucode":"4BD52BF0F0A084","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282895,"discussion_content":"哈哈，这几天都在看这个，对http比较入迷","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592113043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221775,"user_name":"rongyefeng","can_delete":false,"product_type":"c1","uid":1959482,"ip_address":"","ucode":"9A15D947E9D645","user_header":"https://static001.geekbang.org/account/avatar/00/1d/e6/3a/382cf024.jpg","comment_is_top":false,"comment_ctime":1590589816,"is_pvip":false,"replies":[{"id":"81775","content":"这个参数code=xxx只是为了方便测试的，服务器上的lua脚本把这个参数转换成http状态码返回。<br><br>你可以把它理解成函数的输入参数，并不是所有的重定向跳转都要有这个东西。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1590617540,"ip_address":"","comment_id":221775,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590589816","product_id":100029001,"comment_content":"请问老师，这里URI的query参数code=302应该怎么理解？<br>http:&#47;&#47;www.chrono.com&#47;12-1?code=302","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496565,"discussion_content":"这个参数code=xxx只是为了方便测试的，服务器上的lua脚本把这个参数转换成http状态码返回。\n\n你可以把它理解成函数的输入参数，并不是所有的重定向跳转都要有这个东西。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590617540,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221463,"user_name":"老鼠阿尔吉侬","can_delete":false,"product_type":"c1","uid":2005550,"ip_address":"","ucode":"D3AAD6BF36E433","user_header":"https://static001.geekbang.org/account/avatar/00/1e/9a/2e/410554b7.jpg","comment_is_top":false,"comment_ctime":1590503285,"is_pvip":false,"replies":[{"id":"81693","content":"可以试着用wireshark抓包看看，另外现实网络比较复杂，信息太多容易迷失，先在实验环境里把http搞清楚比较好。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1590540865,"ip_address":"","comment_id":221463,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590503285","product_id":100029001,"comment_content":"老师你好，我试着用netcat连了一下几个大网站，都是200，终于我发现www.runoob.com用了重定向，但是按它的location再Get一次，仍然提示302。于是我用浏览器跑了一下，发现根本没有302。。。希望老师指点迷津！","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496460,"discussion_content":"可以试着用wireshark抓包看看，另外现实网络比较复杂，信息太多容易迷失，先在实验环境里把http搞清楚比较好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590540865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219678,"user_name":"我母鸡啊！","can_delete":false,"product_type":"c1","uid":1633705,"ip_address":"","ucode":"7BFB14BC99E978","user_header":"https://static001.geekbang.org/account/avatar/00/18/ed/a9/662318ab.jpg","comment_is_top":false,"comment_ctime":1590062941,"is_pvip":false,"replies":[{"id":"81157","content":"nice。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1590108638,"ip_address":"","comment_id":219678,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590062941","product_id":100029001,"comment_content":"1.都是发送一个请求去做重定向。一个是永久一个是临时<br>2.重定向很多场景：未登录进入登陆页面，报错页面跳转","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495900,"discussion_content":"nice。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590108638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218826,"user_name":"😳","can_delete":false,"product_type":"c1","uid":1452857,"ip_address":"","ucode":"9AFB87EF308539","user_header":"https://static001.geekbang.org/account/avatar/00/16/2b/39/19041d78.jpg","comment_is_top":false,"comment_ctime":1589881092,"is_pvip":false,"replies":[{"id":"80927","content":"nice。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589936964,"ip_address":"","comment_id":218826,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589881092","product_id":100029001,"comment_content":"1:301是原地址已经不可以用了，需要换新地址，302是地址暂时不可以用。<br>2:一般在用户没登陆访问页面的时候，会进行重定向，还有在用户没权限操作某些功能时，重定向页面提示用户。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495588,"discussion_content":"nice。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589936964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":216320,"user_name":"Jinlee","can_delete":false,"product_type":"c1","uid":1644723,"ip_address":"","ucode":"8EDA9B0C5184EA","user_header":"https://static001.geekbang.org/account/avatar/00/19/18/b3/848ffa10.jpg","comment_is_top":false,"comment_ctime":1589242430,"is_pvip":false,"replies":[{"id":"80053","content":"<br>1.301的比喻基本正确，302的应该是让朋友去民宿找才对。<br><br>2.这个重定向其实跟网络安全无关，只是单纯的跳转，而是否安全是由浏览器来判断的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589246381,"ip_address":"","comment_id":216320,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1589242430","product_id":100029001,"comment_content":"1） 301就是“朋友我搬家了，你要是来探望我的话得走一条新的路线了”；302就是“朋友我出去旅游了，你要是来探望我的话下个月再来吧”<br>2）生活中遇到的一个重定向是访问到不信任或者不安全的网站，浏览器会给出相应的提示并在几秒后跳转到新的网站，这个算是重定向在网络安全方面的一个应用吗？<br>纯属小白理解😊","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494773,"discussion_content":"\n1.301的比喻基本正确，302的应该是让朋友去民宿找才对。\n\n2.这个重定向其实跟网络安全无关，只是单纯的跳转，而是否安全是由浏览器来判断的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589246381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1644723,"avatar":"https://static001.geekbang.org/account/avatar/00/19/18/b3/848ffa10.jpg","nickname":"Jinlee","note":"","ucode":"8EDA9B0C5184EA","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274255,"discussion_content":"好的，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590559095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215929,"user_name":"BoyiKia","can_delete":false,"product_type":"c1","uid":1983680,"ip_address":"","ucode":"D37541B4451D6B","user_header":"https://static001.geekbang.org/account/avatar/00/1e/44/c0/cd2cd082.jpg","comment_is_top":false,"comment_ctime":1589153895,"is_pvip":false,"replies":[{"id":"79891","content":"实验环境的dst参数只是为了实验方便，并不是说任何重定向都要有dst这个东西。<br><br>重定向其实是由服务器来决定的，只要有location，就可以跳转，与客户端是没有关系的。<br><br>测试url给你造成了点误解，还请见谅。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589159037,"ip_address":"","comment_id":215929,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589153895","product_id":100029001,"comment_content":"老师请问一下，重定向 location  是 根据请求的  dst决定的?还是服务器端写死的?还是有优先级，如果请求有dst,先用dst的，没有的话，用服务器写死的。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494615,"discussion_content":"实验环境的dst参数只是为了实验方便，并不是说任何重定向都要有dst这个东西。\n\n重定向其实是由服务器来决定的，只要有location，就可以跳转，与客户端是没有关系的。\n\n测试url给你造成了点误解，还请见谅。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589159037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215682,"user_name":"six-or-not","can_delete":false,"product_type":"c1","uid":1895650,"ip_address":"","ucode":"5798BC82E01EB8","user_header":"https://static001.geekbang.org/account/avatar/00/1c/ec/e2/ed59b025.jpg","comment_is_top":false,"comment_ctime":1589077460,"is_pvip":false,"replies":[{"id":"79824","content":"是不是重定向用的有问题呢？既然都永久重定向了，怎么还要改回来。<br><br>取消重定向也很简单，就是不返回301、302，而是给出正常的html，这样就是原本的网站了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589091299,"ip_address":"","comment_id":215682,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1589077460","product_id":100029001,"comment_content":"老师，如果使用301永久重定向之后，想一段时间之后取消这个重定向，恢复到原来的url，应该怎么做？是重新再301一次到之前的url么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494526,"discussion_content":"是不是重定向用的有问题呢？既然都永久重定向了，怎么还要改回来。\n\n取消重定向也很简单，就是不返回301、302，而是给出正常的html，这样就是原本的网站了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589091299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263033,"discussion_content":"这种情况我建议用302，临时跳转，301永久跳转可能浏览器就总访问b了。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589165021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1895650,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/ec/e2/ed59b025.jpg","nickname":"six-or-not","note":"","ucode":"5798BC82E01EB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262479,"discussion_content":"老师，永久重定向之后，浏览器不是会有存储么？举例就是：原本的url是a，然后返回301之后，重定向到b，那么下次访问a这个地址的时候，浏览器就直接去访问b了，是这样么？如果是这样，那么怎么让浏览器下次访问a的时候，继续访问a这个地址？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589104431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173198,"user_name":"Daiver","can_delete":false,"product_type":"c1","uid":1466447,"ip_address":"","ucode":"9B1A03AFBC79BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/60/4f/db0e62b3.jpg","comment_is_top":false,"comment_ctime":1579455633,"is_pvip":false,"replies":[{"id":"67162","content":"是single sign on吗。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579482964,"ip_address":"","comment_id":173198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579455633","product_id":100029001,"comment_content":"Sso就用到了重定向","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481999,"discussion_content":"是single sign on吗。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579482964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":168953,"user_name":"Wr","can_delete":false,"product_type":"c1","uid":1713790,"ip_address":"","ucode":"738B316AA2AD66","user_header":"https://static001.geekbang.org/account/avatar/00/1a/26/7e/823c083e.jpg","comment_is_top":false,"comment_ctime":1578224575,"is_pvip":false,"replies":[{"id":"65549","content":"<br>1.正确。<br><br>2.不太对。路由、防火墙是信息过滤设备，是数据的中转站，只负责转发数据。而301&#47;302的重定向跳转是发生在客户端的，由服务器通知客户端跳转到新的uri。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1578272661,"ip_address":"","comment_id":168953,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578224575","product_id":100029001,"comment_content":"1. 301是永久性的，302是暂时性的<br>2. 比如一些专网环境，当外部访问时，过路由、防火墙等后都需要重定向跳转到真正需要访问的服务吧","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480385,"discussion_content":"\n1.正确。\n\n2.不太对。路由、防火墙是信息过滤设备，是数据的中转站，只负责转发数据。而301/302的重定向跳转是发生在客户端的，由服务器通知客户端跳转到新的uri。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578272661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144681,"user_name":"Geek_Rafe","can_delete":false,"product_type":"c1","uid":1694552,"ip_address":"","ucode":"DF77C1786D7C49","user_header":"","comment_is_top":false,"comment_ctime":1571995830,"is_pvip":false,"replies":[{"id":"55950","content":"301&#47;302的跳转有很多也是在本站内跳转，也就是站内重定向。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1572224647,"ip_address":"","comment_id":144681,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1571995830","product_id":100029001,"comment_content":"&quot;虽然 301&#47;302 报文很小，但大量的跳转对服务器的影响也是不可忽视的&quot;，302的话不是客户端去重新开了一个链接链接到站外吗，对于服务器来讲，链接并没有增加，应该没有什么影响吧？还请老师解惑","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472068,"discussion_content":"301/302的跳转有很多也是在本站内跳转，也就是站内重定向。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572224647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1694552,"avatar":"","nickname":"Geek_Rafe","note":"","ucode":"DF77C1786D7C49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41976,"discussion_content":"奥，这么说就明了了😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572564271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124822,"user_name":"黄斌","can_delete":false,"product_type":"c1","uid":1154629,"ip_address":"","ucode":"08061DEF3AC1FC","user_header":"https://static001.geekbang.org/account/avatar/00/11/9e/45/6d3229a0.jpg","comment_is_top":false,"comment_ctime":1566002765,"is_pvip":false,"replies":[{"id":"46539","content":"我对php不熟，查了一下，header函数只是发送http响应头，如果用状态码301、302，那就是重定向跳转。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566355818,"ip_address":"","comment_id":124822,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1566002765","product_id":100029001,"comment_content":"老师，在php里用header函数跳转算重定向么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463334,"discussion_content":"我对php不熟，查了一下，header函数只是发送http响应头，如果用状态码301、302，那就是重定向跳转。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566355818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435733,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","nickname":"MClink","note":"","ucode":"F479190923355C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229314,"discussion_content":"header 函数是 php 操作header头的函数，你加什么都可以，如果加的是重定向 Location 那就是告诉浏览器要重定向","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586619379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115701,"user_name":"彧豪","can_delete":false,"product_type":"c1","uid":1161233,"ip_address":"","ucode":"8979F477E0BC5B","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","comment_is_top":false,"comment_ctime":1563701316,"is_pvip":false,"replies":[{"id":"42321","content":"这个时候是否用302更好一些？","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563757180,"ip_address":"","comment_id":115701,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563701316","product_id":100029001,"comment_content":"重定向的使用场景，比如之前服务端接口修正，然后app同学那边没法一下发包，但是又需要调整请求的接口，此时就让运维同学配了一个301","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459239,"discussion_content":"这个时候是否用302更好一些？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563757180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/11/26838646.jpg","nickname":"彧豪","note":"","ucode":"8979F477E0BC5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2522,"discussion_content":"具体是301还是302我忘了，只知道最后是弄了一个重定向，我的理解是原来的接口不再使用，下一个迭代就会将其换成新的，所以301更合适吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563759404,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113922,"user_name":"亚洲舞王.尼古拉斯赵四","can_delete":false,"product_type":"c1","uid":1443078,"ip_address":"","ucode":"7159F5D7232696","user_header":"https://static001.geekbang.org/account/avatar/00/16/05/06/f5979d65.jpg","comment_is_top":false,"comment_ctime":1563186124,"is_pvip":false,"replies":[{"id":"41598","content":"可以看一下浏览器里的地址栏，是否前后不一样，如果不同那就是重定向跳转。<br><br>具体是301还是302只能用开发者工具看，跳转多了一次请求响应，增加了客户端的延迟，对于服务器倒是没什么影响。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563239539,"ip_address":"","comment_id":113922,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563186124","product_id":100029001,"comment_content":"老师，现在h5很流行，我在手机浏览器上输入了一个网站的pc端url，他会给我转到h5的页面（如：m.xxx.com）,这个也是重定向的应用吗？如果是，这是302吗？如果每次都这样岂不是会消耗大量资源？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458437,"discussion_content":"可以看一下浏览器里的地址栏，是否前后不一样，如果不同那就是重定向跳转。\n\n具体是301还是302只能用开发者工具看，跳转多了一次请求响应，增加了客户端的延迟，对于服务器倒是没什么影响。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563239539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023016,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9c/28/87421d8f.jpg","nickname":"Happy-Coming","note":"","ucode":"4F7EA88432EDCD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93179,"discussion_content":"四哥也来学技术了！唱二人转的来抢饭碗了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576912239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112321,"user_name":"修行修心","can_delete":false,"product_type":"c1","uid":1500690,"ip_address":"","ucode":"E6EA9B6ED5925F","user_header":"https://static001.geekbang.org/account/avatar/00/16/e6/12/81eb91c0.jpg","comment_is_top":false,"comment_ctime":1562720302,"is_pvip":false,"replies":[{"id":"40886","content":"这两个状态码都是用来通知浏览器uri情况的，告知uri表示的资源的状态。<br><br>你理解的基本正确。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562732732,"ip_address":"","comment_id":112321,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562720302","product_id":100029001,"comment_content":"老师，我理解这两个都是修改服务端返回的状态来实现重定向，只不过是代表的方式不同，另外临时重定向将来还需要修改服务端变回原方式，而永久重定向基本可以不再改动，是这个意思吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457674,"discussion_content":"这两个状态码都是用来通知浏览器uri情况的，告知uri表示的资源的状态。\n\n你理解的基本正确。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562732732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112249,"user_name":"レイン小雨","can_delete":false,"product_type":"c1","uid":1219933,"ip_address":"","ucode":"45BED977EFE852","user_header":"https://static001.geekbang.org/account/avatar/00/12/9d/5d/3fdead91.jpg","comment_is_top":false,"comment_ctime":1562690588,"is_pvip":false,"replies":[{"id":"40819","content":"thanks。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562715553,"ip_address":"","comment_id":112249,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562690588","product_id":100029001,"comment_content":"优秀","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457639,"discussion_content":"thanks。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562715553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111985,"user_name":"明月","can_delete":false,"product_type":"c1","uid":1476588,"ip_address":"","ucode":"D3C649B954A519","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJayib1ZcRfOaoLsdsWZokiaO5tLAdC4uNAicQJRIVXrz9fIchib7QwXibnRrsJaoh5TUlia7faUf36g8Bw/132","comment_is_top":false,"comment_ctime":1562647990,"is_pvip":false,"replies":[{"id":"40768","content":"你说的“站外重定向”是指什么？如果是301&#47;302那就是服务器指示浏览器做的自动跳转。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562677584,"ip_address":"","comment_id":111985,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562647990","product_id":100029001,"comment_content":"站外重定向的网站请求也是服务器代替浏览器做的吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457531,"discussion_content":"你说的“站外重定向”是指什么？如果是301/302那就是服务器指示浏览器做的自动跳转。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562677584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111707,"user_name":"mark","can_delete":false,"product_type":"c1","uid":1566124,"ip_address":"","ucode":"59EE6EED0F06DD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e5/ac/6c87d5ee.jpg","comment_is_top":false,"comment_ctime":1562587505,"is_pvip":false,"replies":[{"id":"40767","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562677487,"ip_address":"","comment_id":111707,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562587505","product_id":100029001,"comment_content":"相同点都会完成重定向，不同点一个是临时重定向，一个是永久重定向，之前在单点登录项目中会大量用到重定向，还有一些ssm框架下的项目也会大量用到重定向。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457421,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562677487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111683,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1562582765,"is_pvip":false,"replies":[{"id":"40770","content":"重定向的含义就是把请求转到另外一个请求，这里的两个请求就是两个连接。<br><br>第一次的请求没有完成目的，第二个请求才是真正的目的地。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562677718,"ip_address":"","comment_id":111683,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562582765","product_id":100029001,"comment_content":"请问老师站外重定向为什么需要开两个连接， 比如重定向到htts:&#47;&#47;www.baidu.com, 不是浏览器与baidu建立一个连接就可以吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457415,"discussion_content":"重定向的含义就是把请求转到另外一个请求，这里的两个请求就是两个连接。\n\n第一次的请求没有完成目的，第二个请求才是真正的目的地。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562677718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111458,"user_name":"Yangjing","can_delete":false,"product_type":"c1","uid":1018061,"ip_address":"","ucode":"D88DFD4958D07C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/cd/2c3808ce.jpg","comment_is_top":false,"comment_ctime":1562561318,"is_pvip":true,"replies":[{"id":"40610","content":"我又确认了一下，是可以的，看看是否输入了正确的uri，18-1后面有dst参数。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562572095,"ip_address":"","comment_id":111458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562561318","product_id":100029001,"comment_content":"http:&#47;&#47;www.chrono.com&#47;18-1 例子 好像用不了了，返回的头信息中没看见文章中所说的内容","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457364,"discussion_content":"我又确认了一下，是可以的，看看是否输入了正确的uri，18-1后面有dst参数。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562572095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}