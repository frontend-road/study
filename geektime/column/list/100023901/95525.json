{"id":95525,"title":"34 | Worker Threadæ¨¡å¼ï¼šå¦‚ä½•é¿å…é‡å¤åˆ›å»ºçº¿ç¨‹ï¼Ÿ","content":"<p>åœ¨<a href=\"https://time.geekbang.org/column/article/95098\">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ç§æœ€ç®€å•çš„åˆ†å·¥æ¨¡å¼â€”â€”Thread-Per-Messageæ¨¡å¼ï¼Œå¯¹åº”åˆ°ç°å®ä¸–ç•Œï¼Œå…¶å®å°±æ˜¯å§”æ‰˜ä»£åŠã€‚è¿™ç§åˆ†å·¥æ¨¡å¼å¦‚æœç”¨Java Threadå®ç°ï¼Œé¢‘ç¹åœ°åˆ›å»ºã€é”€æ¯çº¿ç¨‹éå¸¸å½±å“æ€§èƒ½ï¼ŒåŒæ—¶æ— é™åˆ¶åœ°åˆ›å»ºçº¿ç¨‹è¿˜å¯èƒ½å¯¼è‡´OOMï¼Œæ‰€ä»¥åœ¨Javaé¢†åŸŸä½¿ç”¨åœºæ™¯å°±å—é™äº†ã€‚</p><p>è¦æƒ³æœ‰æ•ˆé¿å…çº¿ç¨‹çš„é¢‘ç¹åˆ›å»ºã€é”€æ¯ä»¥åŠOOMé—®é¢˜ï¼Œå°±ä¸å¾—ä¸æä»Šå¤©æˆ‘ä»¬è¦ç»†èŠçš„ï¼Œä¹Ÿæ˜¯Javaé¢†åŸŸä½¿ç”¨æœ€å¤šçš„Worker Threadæ¨¡å¼ã€‚</p><h2>Worker Threadæ¨¡å¼åŠå…¶å®ç°</h2><p>Worker Threadæ¨¡å¼å¯ä»¥ç±»æ¯”ç°å®ä¸–ç•Œé‡Œè½¦é—´çš„å·¥ä½œæ¨¡å¼ï¼šè½¦é—´é‡Œçš„å·¥äººï¼Œæœ‰æ´»å„¿äº†ï¼Œå¤§å®¶ä¸€èµ·å¹²ï¼Œæ²¡æ´»å„¿äº†å°±èŠèŠå¤©ç­‰ç€ã€‚ä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„ç¤ºæ„å›¾æ¥ç†è§£ï¼ŒWorker Threadæ¨¡å¼ä¸­<strong>Worker Threadå¯¹åº”åˆ°ç°å®ä¸–ç•Œé‡Œï¼Œå…¶å®æŒ‡çš„å°±æ˜¯è½¦é—´é‡Œçš„å·¥äºº</strong>ã€‚ä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè½¦é—´é‡Œçš„å·¥äººæ•°é‡å¾€å¾€æ˜¯ç¡®å®šçš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9d/c3/9d0082376427a97644ad7219af6922c3.png?wh=1142*511\" alt=\"\"></p><center><span class=\"reference\">è½¦é—´å·¥ä½œç¤ºæ„å›¾</span></center><p>é‚£åœ¨ç¼–ç¨‹é¢†åŸŸè¯¥å¦‚ä½•æ¨¡æ‹Ÿè½¦é—´çš„è¿™ç§å·¥ä½œæ¨¡å¼å‘¢ï¼Ÿæˆ–è€…è¯´å¦‚ä½•å»å®ç°Worker Threadæ¨¡å¼å‘¢ï¼Ÿé€šè¿‡ä¸Šé¢çš„å›¾ï¼Œä½ å¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°ç”¨é˜»å¡é˜Ÿåˆ—åšä»»åŠ¡æ± ï¼Œç„¶ååˆ›å»ºå›ºå®šæ•°é‡çš„çº¿ç¨‹æ¶ˆè´¹é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚å…¶å®ä½ ä»”ç»†æƒ³ä¼šå‘ç°ï¼Œè¿™ä¸ªæ–¹æ¡ˆå°±æ˜¯Javaè¯­è¨€æä¾›çš„çº¿ç¨‹æ± ã€‚</p><!-- [[[read_end]]] --><p>çº¿ç¨‹æ± æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä¾‹å¦‚èƒ½å¤Ÿé¿å…é‡å¤åˆ›å»ºã€é”€æ¯çº¿ç¨‹ï¼ŒåŒæ—¶èƒ½å¤Ÿé™åˆ¶åˆ›å»ºçº¿ç¨‹çš„ä¸Šé™ç­‰ç­‰ã€‚å­¦ä¹ å®Œä¸Šä¸€ç¯‡æ–‡ç« åä½ å·²ç»çŸ¥é“ï¼Œç”¨Javaçš„Threadå®ç°Thread-Per-Messageæ¨¡å¼éš¾ä»¥åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼ŒåŸå› å°±åœ¨äºé¢‘ç¹åˆ›å»ºã€é”€æ¯Javaçº¿ç¨‹çš„æˆæœ¬æœ‰ç‚¹é«˜ï¼Œè€Œä¸”æ— é™åˆ¶åœ°åˆ›å»ºçº¿ç¨‹è¿˜å¯èƒ½å¯¼è‡´åº”ç”¨OOMã€‚çº¿ç¨‹æ± ï¼Œåˆ™æ°å¥½èƒ½è§£å†³è¿™äº›é—®é¢˜ã€‚</p><p>é‚£æˆ‘ä»¬è¿˜æ˜¯ä»¥echoç¨‹åºä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•ç”¨çº¿ç¨‹æ± æ¥å®ç°ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ˜¯ç”¨çº¿ç¨‹æ± å®ç°çš„echoæœåŠ¡ç«¯ï¼Œç›¸æ¯”äºThread-Per-Messageæ¨¡å¼çš„å®ç°ï¼Œæ”¹åŠ¨éå¸¸å°‘ï¼Œä»…ä»…æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæœ€å¤šçº¿ç¨‹æ•°ä¸º500çš„çº¿ç¨‹æ± esï¼Œç„¶åé€šè¿‡es.execute()æ–¹æ³•å°†è¯·æ±‚å¤„ç†çš„ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± å¤„ç†ã€‚</p><pre><code>ExecutorService es = Executors\n  .newFixedThreadPool(500);\nfinal ServerSocketChannel ssc = \n  ServerSocketChannel.open().bind(\n    new InetSocketAddress(8080));\n//å¤„ç†è¯·æ±‚    \ntry {\n  while (true) {\n    // æ¥æ”¶è¯·æ±‚\n    SocketChannel sc = ssc.accept();\n    // å°†è¯·æ±‚å¤„ç†ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± \n    es.execute(()-&gt;{\n      try {\n        // è¯»Socket\n        ByteBuffer rb = ByteBuffer\n          .allocateDirect(1024);\n        sc.read(rb);\n        //æ¨¡æ‹Ÿå¤„ç†è¯·æ±‚\n        Thread.sleep(2000);\n        // å†™Socket\n        ByteBuffer wb = \n          (ByteBuffer)rb.flip();\n        sc.write(wb);\n        // å…³é—­Socket\n        sc.close();\n      }catch(Exception e){\n        throw new UncheckedIOException(e);\n      }\n    });\n  }\n} finally {\n  ssc.close();\n  es.shutdown();\n}   \n</code></pre><h2>æ­£ç¡®åœ°åˆ›å»ºçº¿ç¨‹æ± </h2><p>Javaçš„çº¿ç¨‹æ± æ—¢èƒ½å¤Ÿé¿å…æ— é™åˆ¶åœ°<strong>åˆ›å»ºçº¿ç¨‹</strong>å¯¼è‡´OOMï¼Œä¹Ÿèƒ½é¿å…æ— é™åˆ¶åœ°<strong>æ¥æ”¶ä»»åŠ¡</strong>å¯¼è‡´OOMã€‚åªä¸è¿‡åè€…ç»å¸¸å®¹æ˜“è¢«æˆ‘ä»¬å¿½ç•¥ï¼Œä¾‹å¦‚åœ¨ä¸Šé¢çš„å®ç°ä¸­ï¼Œå°±è¢«æˆ‘ä»¬å¿½ç•¥äº†ã€‚æ‰€ä»¥å¼ºçƒˆå»ºè®®ä½ <strong>ç”¨åˆ›å»ºæœ‰ç•Œçš„é˜Ÿåˆ—æ¥æ¥æ”¶ä»»åŠ¡</strong>ã€‚</p><p>å½“è¯·æ±‚é‡å¤§äºæœ‰ç•Œé˜Ÿåˆ—çš„å®¹é‡æ—¶ï¼Œå°±éœ€è¦åˆç†åœ°æ‹’ç»è¯·æ±‚ã€‚å¦‚ä½•åˆç†åœ°æ‹’ç»å‘¢ï¼Ÿè¿™éœ€è¦ä½ ç»“åˆå…·ä½“çš„ä¸šåŠ¡åœºæ™¯æ¥åˆ¶å®šï¼Œå³ä¾¿çº¿ç¨‹æ± é»˜è®¤çš„æ‹’ç»ç­–ç•¥èƒ½å¤Ÿæ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä¹ŸåŒæ ·å»ºè®®ä½ <strong>åœ¨åˆ›å»ºçº¿ç¨‹æ± æ—¶ï¼Œæ¸…æ™°åœ°æŒ‡æ˜æ‹’ç»ç­–ç•¥</strong>ã€‚</p><p>åŒæ—¶ï¼Œä¸ºäº†ä¾¿äºè°ƒè¯•å’Œè¯Šæ–­é—®é¢˜ï¼Œæˆ‘ä¹Ÿå¼ºçƒˆå»ºè®®ä½ <strong>åœ¨å®é™…å·¥ä½œä¸­ç»™çº¿ç¨‹èµ‹äºˆä¸€ä¸ªä¸šåŠ¡ç›¸å…³çš„åå­—</strong>ã€‚</p><p>ç»¼åˆä»¥ä¸Šè¿™ä¸‰ç‚¹å»ºè®®ï¼Œechoç¨‹åºä¸­åˆ›å»ºçº¿ç¨‹å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ã€‚</p><pre><code>ExecutorService es = new ThreadPoolExecutor(\n  50, 500,\n  60L, TimeUnit.SECONDS,\n  //æ³¨æ„è¦åˆ›å»ºæœ‰ç•Œé˜Ÿåˆ—\n  new LinkedBlockingQueue&lt;Runnable&gt;(2000),\n  //å»ºè®®æ ¹æ®ä¸šåŠ¡éœ€æ±‚å®ç°ThreadFactory\n  r-&gt;{\n    return new Thread(r, &quot;echo-&quot;+ r.hashCode());\n  },\n  //å»ºè®®æ ¹æ®ä¸šåŠ¡éœ€æ±‚å®ç°RejectedExecutionHandler\n  new ThreadPoolExecutor.CallerRunsPolicy());\n</code></pre><h2>é¿å…çº¿ç¨‹æ­»é”</h2><p>ä½¿ç”¨çº¿ç¨‹æ± è¿‡ç¨‹ä¸­ï¼Œè¿˜è¦æ³¨æ„ä¸€ç§<strong>çº¿ç¨‹æ­»é”</strong>çš„åœºæ™¯ã€‚å¦‚æœæäº¤åˆ°ç›¸åŒçº¿ç¨‹æ± çš„ä»»åŠ¡ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¼è‡´çº¿ç¨‹æ­»é”ã€‚å®é™…å·¥ä½œä¸­ï¼Œæˆ‘å°±äº²å†è¿‡è¿™ç§çº¿ç¨‹æ­»é”çš„åœºæ™¯ã€‚å…·ä½“ç°è±¡æ˜¯<strong>åº”ç”¨æ¯è¿è¡Œä¸€æ®µæ—¶é—´å¶å°”å°±ä¼šå¤„äºæ— å“åº”çš„çŠ¶æ€ï¼Œç›‘æ§æ•°æ®çœ‹ä¸Šå»ä¸€åˆ‡éƒ½æ­£å¸¸ï¼Œä½†æ˜¯å®é™…ä¸Šå·²ç»ä¸èƒ½æ­£å¸¸å·¥ä½œäº†</strong>ã€‚</p><p>è¿™ä¸ªå‡ºé—®é¢˜çš„åº”ç”¨ï¼Œç›¸å…³çš„é€»è¾‘ç²¾ç®€ä¹‹åï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥åº”ç”¨å°†ä¸€ä¸ªå¤§å‹çš„è®¡ç®—ä»»åŠ¡åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µçš„ä»»åŠ¡ä¼šç­‰å¾…ç¬¬äºŒé˜¶æ®µçš„å­ä»»åŠ¡å®Œæˆã€‚åœ¨è¿™ä¸ªåº”ç”¨é‡Œï¼Œæ¯ä¸€ä¸ªé˜¶æ®µéƒ½ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œè€Œä¸”ä¸¤ä¸ªé˜¶æ®µä½¿ç”¨çš„è¿˜æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ± ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f8/b8/f807b0935133b315870d2d7db5477db8.png?wh=1142*496\" alt=\"\"></p><center><span class=\"reference\">åº”ç”¨ä¸šåŠ¡é€»è¾‘ç¤ºæ„å›¾</span></center><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ¥æ¨¡æ‹Ÿè¯¥åº”ç”¨ï¼Œå¦‚æœä½ æ‰§è¡Œä¸‹é¢çš„è¿™æ®µä»£ç ï¼Œä¼šå‘ç°å®ƒæ°¸è¿œæ‰§è¡Œä¸åˆ°æœ€åä¸€è¡Œã€‚æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰ä»»ä½•å¼‚å¸¸ï¼Œä½†æ˜¯åº”ç”¨å·²ç»åœæ­¢å“åº”äº†ã€‚</p><pre><code>//L1ã€L2é˜¶æ®µå…±ç”¨çš„çº¿ç¨‹æ± \nExecutorService es = Executors.\n  newFixedThreadPool(2);\n//L1é˜¶æ®µçš„é—­é”    \nCountDownLatch l1=new CountDownLatch(2);\nfor (int i=0; i&lt;2; i++){\n  System.out.println(&quot;L1&quot;);\n  //æ‰§è¡ŒL1é˜¶æ®µä»»åŠ¡\n  es.execute(()-&gt;{\n    //L2é˜¶æ®µçš„é—­é” \n    CountDownLatch l2=new CountDownLatch(2);\n    //æ‰§è¡ŒL2é˜¶æ®µå­ä»»åŠ¡\n    for (int j=0; j&lt;2; j++){\n      es.execute(()-&gt;{\n        System.out.println(&quot;L2&quot;);\n        l2.countDown();\n      });\n    }\n    //ç­‰å¾…L2é˜¶æ®µä»»åŠ¡æ‰§è¡Œå®Œ\n    l2.await();\n    l1.countDown();\n  });\n}\n//ç­‰ç€L1é˜¶æ®µä»»åŠ¡æ‰§è¡Œå®Œ\nl1.await();\nSystem.out.println(&quot;end&quot;);\n</code></pre><p>å½“åº”ç”¨å‡ºç°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œé¦–é€‰çš„è¯Šæ–­æ–¹æ³•æ˜¯æŸ¥çœ‹çº¿ç¨‹æ ˆã€‚ä¸‹å›¾æ˜¯ä¸Šé¢ç¤ºä¾‹ä»£ç åœæ­¢å“åº”åçš„çº¿ç¨‹æ ˆï¼Œä½ ä¼šå‘ç°çº¿ç¨‹æ± ä¸­çš„ä¸¤ä¸ªçº¿ç¨‹å…¨éƒ¨éƒ½é˜»å¡åœ¨ <code>l2.await();</code> è¿™è¡Œä»£ç ä¸Šäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹æ± é‡Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…L2é˜¶æ®µçš„ä»»åŠ¡æ‰§è¡Œå®Œï¼Œé‚£L2é˜¶æ®µçš„å­ä»»åŠ¡ä»€ä¹ˆæ—¶å€™èƒ½å¤Ÿæ‰§è¡Œå®Œå‘¢ï¼Ÿæ°¸è¿œéƒ½æ²¡é‚£ä¸€å¤©äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹éƒ½é˜»å¡äº†ï¼Œæ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹æ‰§è¡ŒL2é˜¶æ®µçš„ä»»åŠ¡äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/43/83/43c663eedd5b0b75b6c3022e26eb1583.png?wh=792*612\" alt=\"\"></p><p>åŸå› æ‰¾åˆ°äº†ï¼Œé‚£å¦‚ä½•è§£å†³å°±ç®€å•äº†ï¼Œæœ€ç®€å•ç²—æš´çš„åŠæ³•å°±æ˜¯å°†çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°è°ƒå¤§ï¼Œå¦‚æœèƒ½å¤Ÿç¡®å®šä»»åŠ¡çš„æ•°é‡ä¸æ˜¯éå¸¸å¤šçš„è¯ï¼Œè¿™ä¸ªåŠæ³•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œå¦åˆ™è¿™ä¸ªåŠæ³•å°±è¡Œä¸é€šäº†ã€‚å…¶å®<strong>è¿™ç§é—®é¢˜é€šç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸ºä¸åŒçš„ä»»åŠ¡åˆ›å»ºä¸åŒçš„çº¿ç¨‹æ± </strong>ã€‚å¯¹äºä¸Šé¢çš„è¿™ä¸ªåº”ç”¨ï¼ŒL1é˜¶æ®µçš„ä»»åŠ¡å’ŒL2é˜¶æ®µçš„ä»»åŠ¡å¦‚æœå„è‡ªéƒ½æœ‰è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œå°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜äº†ã€‚</p><p>æœ€åå†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼š<strong>æäº¤åˆ°ç›¸åŒçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡ä¸€å®šæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¦åˆ™å°±ä¸€å®šè¦æ…é‡</strong>ã€‚</p><h2>æ€»ç»“</h2><p>æˆ‘ä»¬æ›¾ç»è¯´è¿‡ï¼Œè§£å†³å¹¶å‘ç¼–ç¨‹é‡Œçš„åˆ†å·¥é—®é¢˜ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯å’Œç°å®ä¸–ç•Œåšå¯¹æ¯”ã€‚å¯¹æ¯”ç°å®ä¸–ç•Œæ„å»ºç¼–ç¨‹é¢†åŸŸçš„æ¨¡å‹ï¼Œèƒ½å¤Ÿè®©æ¨¡å‹æ›´å®¹æ˜“ç†è§£ã€‚ä¸Šä¸€ç¯‡æˆ‘ä»¬ä»‹ç»çš„Thread-Per-Messageæ¨¡å¼ï¼Œç±»ä¼¼äºç°å®ä¸–ç•Œé‡Œçš„å§”æ‰˜ä»–äººåŠç†ï¼Œè€Œä»Šå¤©ä»‹ç»çš„Worker Threadæ¨¡å¼åˆ™ç±»ä¼¼äºè½¦é—´é‡Œå·¥äººçš„å·¥ä½œæ¨¡å¼ã€‚å¦‚æœä½ åœ¨è®¾è®¡é˜¶æ®µï¼Œå‘ç°å¯¹ä¸šåŠ¡æ¨¡å‹å»ºæ¨¡ä¹‹åï¼Œæ¨¡å‹éå¸¸ç±»ä¼¼äºè½¦é—´çš„å·¥ä½œæ¨¡å¼ï¼Œé‚£åŸºæœ¬ä¸Šå°±èƒ½ç¡®å®šå¯ä»¥åœ¨å®ç°é˜¶æ®µé‡‡ç”¨Worker Threadæ¨¡å¼æ¥å®ç°ã€‚</p><p>Worker Threadæ¨¡å¼å’ŒThread-Per-Messageæ¨¡å¼çš„åŒºåˆ«æœ‰å“ªäº›å‘¢ï¼Ÿä»ç°å®ä¸–ç•Œçš„è§’åº¦çœ‹ï¼Œä½ å§”æ‰˜ä»£åŠäººåšäº‹ï¼Œå¾€å¾€æ˜¯å’Œä»£åŠäººç›´æ¥æ²Ÿé€šçš„ï¼›å¯¹åº”åˆ°ç¼–ç¨‹é¢†åŸŸï¼Œå…¶å®ç°ä¹Ÿæ˜¯ä¸»çº¿ç¨‹ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ªå­çº¿ç¨‹ï¼Œä¸»å­çº¿ç¨‹ä¹‹é—´æ˜¯å¯ä»¥ç›´æ¥é€šä¿¡çš„ã€‚è€Œè½¦é—´å·¥äººçš„å·¥ä½œæ–¹å¼åˆ™æ˜¯å®Œå…¨å›´ç»•ä»»åŠ¡å±•å¼€çš„ï¼Œä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡è¢«å“ªä¸ªå·¥äººæ‰§è¡Œï¼Œé¢„å…ˆæ˜¯æ— æ³•çŸ¥é“çš„ï¼›å¯¹åº”åˆ°ç¼–ç¨‹é¢†åŸŸï¼Œåˆ™æ˜¯ä¸»çº¿ç¨‹æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± ï¼Œä½†ä¸»çº¿ç¨‹å¹¶ä¸å…³å¿ƒä»»åŠ¡è¢«å“ªä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</p><p>Worker Threadæ¨¡å¼èƒ½é¿å…çº¿ç¨‹é¢‘ç¹åˆ›å»ºã€é”€æ¯çš„é—®é¢˜ï¼Œè€Œä¸”èƒ½å¤Ÿé™åˆ¶çº¿ç¨‹çš„æœ€å¤§æ•°é‡ã€‚Javaè¯­è¨€é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨çº¿ç¨‹æ± æ¥å®ç°Worker Threadæ¨¡å¼ï¼Œçº¿ç¨‹æ± æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€å’Œä¼˜ç§€çš„å·¥å…·ç±»ï¼Œç”šè‡³æœ‰äº›å¤§å‚çš„ç¼–ç è§„èŒƒéƒ½ä¸å…è®¸ç”¨new Thread()æ¥åˆ›å»ºçº¿ç¨‹çš„ï¼Œå¿…é¡»ä½¿ç”¨çº¿ç¨‹æ± ã€‚</p><p>ä¸è¿‡ä½¿ç”¨çº¿ç¨‹æ± è¿˜æ˜¯éœ€è¦æ ¼å¤–è°¨æ…çš„ï¼Œé™¤äº†ä»Šå¤©é‡ç‚¹è®²åˆ°çš„å¦‚ä½•æ­£ç¡®åˆ›å»ºçº¿ç¨‹æ± ã€å¦‚ä½•é¿å…çº¿ç¨‹æ­»é”é—®é¢˜ï¼Œè¿˜éœ€è¦æ³¨æ„å‰é¢æˆ‘ä»¬æ›¾ç»æåˆ°çš„ThreadLocalå†…å­˜æ³„éœ²é—®é¢˜ã€‚åŒæ—¶å¯¹äºæäº¤åˆ°çº¿ç¨‹æ± çš„ä»»åŠ¡ï¼Œè¿˜è¦åšå¥½å¼‚å¸¸å¤„ç†ï¼Œé¿å…å¼‚å¸¸çš„ä»»åŠ¡ä»çœ¼å‰æºœèµ°ï¼Œä»ä¸šåŠ¡çš„è§’åº¦çœ‹ï¼Œæœ‰æ—¶æ²¡æœ‰å‘ç°å¼‚å¸¸çš„ä»»åŠ¡åæœå¾€å¾€éƒ½å¾ˆä¸¥é‡ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>å°ç°åŒå­¦å†™äº†å¦‚ä¸‹çš„ä»£ç ï¼Œæœ¬ä¹‰æ˜¯å¼‚æ­¥åœ°æ‰“å°å­—ç¬¦ä¸²â€œQQâ€ï¼Œè¯·é—®ä»–çš„å®ç°æ˜¯å¦æœ‰é—®é¢˜å‘¢ï¼Ÿ</p><pre><code>ExecutorService pool = Executors\n  .newSingleThreadExecutor();\npool.submit(() -&gt; {\n  try {\n    String qq=pool.submit(()-&gt;&quot;QQ&quot;).get();\n    System.out.println(qq);\n  } catch (Exception e) {\n  }\n});\n</code></pre><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":95004,"user_name":"vector","can_delete":false,"product_type":"c1","uid":1107266,"ip_address":"","ucode":"F42E76E8966BBE","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/42/fbe890c0.jpg","comment_is_top":false,"comment_ctime":1557936808,"is_pvip":false,"replies":[{"id":"34033","content":"æ¯”å–»å¾ˆå½¢è±¡ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558004985,"ip_address":"","comment_id":95004,"utype":1}],"discussion_count":1,"race_medal":0,"score":"409579829928","product_id":100023901,"comment_content":"å·¥å‚é‡Œåªæœ‰ä¸€ä¸ªå·¥äººï¼Œä»–çš„å·¥ä½œå°±æ˜¯åŒæ­¥çš„ç­‰å¾…å·¥å‚é‡Œå…¶ä»–äººç»™ä»–æä¾›ä¸œè¥¿ï¼Œç„¶è€Œå¹¶æ²¡æœ‰å…¶ä»–äººï¼Œä»–å°†ç­‰åˆ°å¤©è’åœ°è€ï¼Œæµ·æ¯çŸ³çƒ‚~","like_count":95,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450295,"discussion_content":"æ¯”å–»å¾ˆå½¢è±¡ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558004985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97210,"user_name":"æ›¾è½¼éºŸ","can_delete":false,"product_type":"c1","uid":1451391,"ip_address":"","ucode":"D418371AC11270","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/7f/473d5a77.jpg","comment_is_top":false,"comment_ctime":1558611583,"is_pvip":false,"replies":[{"id":"34743","content":"ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558615958,"ip_address":"","comment_id":97210,"utype":1}],"discussion_count":2,"race_medal":0,"score":"272141551231","product_id":100023901,"comment_content":"EagerThreadPool è€å¸ˆè¿™ä¸ªçº¿ç¨‹æ± å¯ä»¥é¿å…æ­»é”çš„æƒ…å†µï¼Œæ­»é”çš„æ—¶å€™ä¼šè‡ªåŠ¨æ’‘å¤§","like_count":63,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451179,"discussion_content":"ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558615958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1101760,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cf/c0/8e4c1135.jpg","nickname":"ddup","note":"","ucode":"D8EC573DA46A10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584856,"discussion_content":"ä¸å¯¹å§ EagerThreadPool æ˜¯è€ƒè™‘ä¼˜å…ˆåˆ›å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œè¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°å†æŠŠä»»åŠ¡æ”¾è¿›é˜Ÿåˆ—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661161754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97939,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1558846933,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"96048127445","product_id":100023901,"comment_content":"newSingleThreadExecutorçº¿ç¨‹æ± åªæœ‰å•ä¸ªçº¿ç¨‹ï¼Œå…ˆå°†å¤–éƒ¨çº¿ç¨‹æäº¤ç»™çº¿ç¨‹æ± ï¼Œå¤–éƒ¨çº¿ç¨‹ç­‰å¾…å†…éƒ¨çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œä½†ç”±äºçº¿ç¨‹æ± åªæœ‰å•çº¿ç¨‹ï¼Œå¯¼è‡´å†…éƒ¨çº¿ç¨‹ä¸€ç›´æ²¡æœ‰æ‰§è¡Œçš„æœºä¼šï¼Œç›¸å½“äºå†…éƒ¨çº¿ç¨‹éœ€è¦çº¿ç¨‹æ± çš„èµ„æºï¼Œå¤–éƒ¨çº¿ç¨‹éœ€è¦å†…éƒ¨çº¿ç¨‹çš„ç»“æœï¼Œå¯¼è‡´æ­»é”ã€‚","like_count":22,"discussions":[{"author":{"id":2139604,"avatar":"","nickname":"æˆç”µå¸…æ‰","note":"","ucode":"DDE757138F41D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363001,"discussion_content":"æ­»é”é¦–å…ˆå¾—æœ‰é”å§ï¼Œè¿™é‡Œè¿é”éƒ½æ²¡æœ‰ï¼Œæ€ä¹ˆèƒ½å«æ­»é”å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617089984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2139604,"avatar":"","nickname":"æˆç”µå¸…æ‰","note":"","ucode":"DDE757138F41D2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370967,"discussion_content":"å‰å‡ ç« æ­»é”çš„å®šä¹‰ï¼šä¸€ç»„äº’ç›¸ç«äº‰èµ„æºçš„çº¿ç¨‹å› äº’ç›¸ç­‰å¾…ï¼Œå¯¼è‡´â€œæ°¸ä¹…â€é˜»å¡çš„ç°è±¡","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619598315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363001,"ip_address":""},"score":370967,"extra":""}]}]},{"had_liked":false,"id":95679,"user_name":"zero","can_delete":false,"product_type":"c1","uid":1299615,"ip_address":"","ucode":"528DD5C8399AEC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlwpFM3tkeG15YqyJTYWkfqkdmro9POq6SicYm57TaEFDOUZCXjoe0Z0Iz6UibGQqic3icJRsHdFzibtw/132","comment_is_top":false,"comment_ctime":1558141099,"is_pvip":true,"replies":[{"id":"34255","content":"ä¸æ˜¯é€’å½’ï¼Œä½†ä¼šæ­»é”","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558168430,"ip_address":"","comment_id":95679,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61687683243","product_id":100023901,"comment_content":"æ„Ÿè§‰è¿™ç¨‹åºä¼šè°ƒç”¨æ ˆå†…å­˜æº¢å‡ºï¼Œè¿™æ®µä»£ç ç›¸å½“äºæ— é™çš„é€’å½’è°ƒç”¨å•Šã€‚ä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹ï¼Œè¯·è€å¸ˆæŒ‡ç‚¹ã€‚","like_count":14,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450557,"discussion_content":"ä¸æ˜¯é€’å½’ï¼Œä½†ä¼šæ­»é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558168430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95566,"user_name":"æœ¨åˆ»","can_delete":false,"product_type":"c1","uid":1157430,"ip_address":"","ucode":"0A3226FEE3983B","user_header":"https://static001.geekbang.org/account/avatar/00/11/a9/36/972f7abf.jpg","comment_is_top":false,"comment_ctime":1558084294,"is_pvip":false,"replies":[{"id":"34257","content":"å¥½ç´¯ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558169014,"ip_address":"","comment_id":95566,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40212789958","product_id":100023901,"comment_content":"å¸Œæœ›è€å¸ˆèƒ½å¼€ä¸€æ ä¸“é—¨è®²ä¸€è®²Linuxä¸‹å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹ç¨‹åºæ€§èƒ½çš„æ’æŸ¥å’Œè°ƒä¼˜ã€‚è°¢è°¢è€å¸ˆ","like_count":9,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450519,"discussion_content":"å¥½ç´¯ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558169014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338627,"user_name":"Geek_42f729","can_delete":false,"product_type":"c1","uid":1600341,"ip_address":"","ucode":"76CFFF9DEDDF96","user_header":"https://static001.geekbang.org/account/avatar/00/18/6b/55/2b0f219b.jpg","comment_is_top":false,"comment_ctime":1647607295,"is_pvip":false,"replies":[{"id":"123920","content":"åˆ†æå¾ˆåˆ°ä½","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1647911967,"ip_address":"","comment_id":338627,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27417411071","product_id":100023901,"comment_content":"çœ‹äº†ä¸€éè¯„è®ºï¼Œæœ‰ä¸€éƒ¨åˆ†åŒå­¦å›ç­”äº†è¯¾åæ€è€ƒçš„ç»“è®ºï¼Œä½†æ˜¯æ²¡æœ‰æè¿°äº§ç”Ÿè¯¥ç»“è®ºçš„åŸå› ï¼Œæˆ‘æ¥æè¿°ä¸€ä¸‹å§ï¼Œæœ‰ä¸å¯¹çš„åœ°æ–¹è¿˜è¯·è€å¸ˆã€åŒå­¦ä»¬æŒ‡å‡ºï¼›<br><br>ç»“è®ºæ˜¯ï¼šå°ç°å†™çš„ä»£ç ä¼šè¢«ä¸€ç›´é˜»å¡ï¼›<br><br>åŸå› æ˜¯ï¼š<br><br>1. é€šè¿‡Executors.newSingleThreadExecutor()åˆ›å»ºçš„çº¿ç¨‹æ± é»˜è®¤æ˜¯1ä¸ªæ ¸å¿ƒçº¿ç¨‹ + æ— ç•Œå·¥ä½œé˜Ÿåˆ—ï¼›<br><br>2. ç¬¬ä¸€æ¬¡submitæ—¶ï¼Œä¼šæŠŠæ± ä¸­å”¯ä¸€çš„ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ç»™å ç”¨ï¼›<br><br>3. ç¬¬äºŒæ¬¡submitæ—¶ï¼Œç”±äºæ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œå¹¶ä¸”å·¥ä½œé˜Ÿåˆ—ä¹Ÿæ²¡æ»¡ï¼Œæ‰€ä»¥çº¿ç¨‹æ± ä¼šæŠŠæäº¤çš„ä»»åŠ¡æ·»åŠ åˆ°å·¥ä½œé˜Ÿåˆ—ï¼Œç„¶åç­‰å¾…ç©ºé—²çº¿ç¨‹æ¥æ‰§è¡Œè¯¥ä»»åŠ¡ï¼›<br><br>4. åœ¨ç¬¬äºŒæ¬¡submitæ—¶ä½¿ç”¨äº†.get()æ–¹æ³•ï¼Œè¿™é‡Œä¼šä¸€ç›´ç­‰åˆ°çº¿ç¨‹è¿”å›æ‰§è¡Œç»“æœï¼›<br><br>5. ç”±äºä¸¤æ¬¡submitæ˜¯åµŒå¥—æ‰§è¡Œçš„ï¼Œå¹¶ä¸”æ­¤æ—¶çº¿ç¨‹æ± ä¸­ä¹Ÿæ²¡æœ‰ç©ºé—²çº¿ç¨‹ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡submitçš„ä»»åŠ¡æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼Œ.get()æ–¹æ³•ä¼šå°±è¢«æ°¸è¿œé˜»å¡ï¼Œä»è€Œå¯¼è‡´ç¬¬ä¸€æ¬¡submitçš„çº¿ç¨‹ä¹Ÿè¢«æ°¸è¿œé˜»å¡ã€‚","like_count":7,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557627,"discussion_content":"åˆ†æå¾ˆåˆ°ä½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647911967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95490,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1558063526,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27327867302","product_id":100023901,"comment_content":"åŸå§‹çš„workerThreadæ¨¡å¼åŒ…å«ä¸‰ç§è§’è‰²ï¼šå·¥äººã€ä¼ é€å¸¦ã€äº§å“ï¼Œ<br>ä¼ é€å¸¦ä¸­ç»´æŠ¤ä¸€ä¸ªproductionsQueueä»¥åŠæœ€å¤§çš„äº§å“æ•°é‡ï¼ˆä¸ºäº†é˜²æ­¢äº§å“æ— é™ç§¯å‹ï¼‰,<br>åœ¨ä¼ é€å¸¦åˆå§‹åŒ–æ—¶ï¼Œåˆ›å»ºäº†è‹¥å¹²ä¸ªworkerï¼ˆçº¿ç¨‹ï¼‰ï¼Œworkerä¸æ–­ä»ä¼ é€å¸¦å–äº§å“è¿›è¡ŒåŠ å·¥ï¼Œ<br>å½“ä¼ é€å¸¦ä¸­æ— äº§å“æ—¶ï¼Œworkerçº¿ç¨‹è¢«æŒ‚èµ·ç­‰å¾…å”¤é†’ï¼Œå½“æœ‰æ–°çš„äº§å“åŠ å…¥åˆ°ä¼ é€å¸¦ä¸­æ—¶ï¼ŒæŒ‚èµ·çš„workerä¼šè¢«å”¤é†’ï¼Œå–äº§å“åŠ å·¥ã€‚<br>å½“ä¸Šæ¸¸çº¿ç¨‹Threadå¾€ä¼ é€å¸¦ä¸­åŠ å…¥äº§å“æ—¶ï¼Œå¦‚æœproductionsQueueåˆ°è¾¾æœ€å¤§äº§å“æ•°é‡æ—¶ï¼ŒThreadä¼šè¢«æŒ‚èµ·ã€‚<br>å½“æœ‰workerçº¿ç¨‹å–å‡ºäº§å“åï¼Œä¼šå”¤é†’é˜»å¡çš„çº¿ç¨‹Thread(å½“ç„¶è¿™é‡Œä¹Ÿæœ‰å¯èƒ½å”¤é†’worker)<br>çº¿ç¨‹æ± åªæ˜¯workerThreadçš„ä¸€ç§å®ç°ï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¸­åˆ›å»ºçš„Threadå°±æ˜¯å·¥äººï¼Œçº¿ç¨‹æ± æœ¬èº«å°±æ˜¯ä¼ é€å¸¦ï¼Œäº§å“å°±æ˜¯æäº¤åˆ°çº¿ç¨‹æ± ä¸­çš„Runnableï¼Œ<br>è€Œåœ¨çº¿ç¨‹æ± ä¸­çš„é˜»å¡é˜Ÿåˆ—å°±ç›¸å½“äºproductionsQueueï¼Œè¯·é—®è€å¸ˆï¼Œæˆ‘è¿™æ ·ç†è§£æ˜¯å¦æ­£ç¡®ï¼Ÿ<br><br> ","like_count":6,"discussions":[{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370968,"discussion_content":"å·¥äººæ˜¯çº¿ç¨‹æ± é‡çš„çº¿ç¨‹ã€ä¼ é€å¸¦æ˜¯ä»»åŠ¡é˜Ÿåˆ—ã€äº§å“æ˜¯ä»»åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619598532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95304,"user_name":"ack","can_delete":false,"product_type":"c1","uid":1440912,"ip_address":"","ucode":"69CA1233EEA8E2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/90/c9df0459.jpg","comment_is_top":false,"comment_ctime":1558014165,"is_pvip":false,"replies":[{"id":"34152","content":"æˆ‘è§‰å¾—æ˜¯æ­»é”ï¼Œæ´»é”æœ‰é‡Šæ”¾å†è·å–çš„è¿‡ç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558091520,"ip_address":"","comment_id":95304,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27327817941","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œçº¿ç¨‹æ­»é”é‚£ä¸ªä»£ç ï¼Œæ˜¯æ´»é”å—ï¼Œæ€è€ƒé¢˜æˆ‘ä¹Ÿè®¤ä¸ºæ˜¯æ´»é”","like_count":6,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450408,"discussion_content":"æˆ‘è§‰å¾—æ˜¯æ­»é”ï¼Œæ´»é”æœ‰é‡Šæ”¾å†è·å–çš„è¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558091520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148840,"user_name":"Mr_æ¨","can_delete":false,"product_type":"c1","uid":1008065,"ip_address":"","ucode":"AD31C2320DF6A2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/c1/9ad88d67.jpg","comment_is_top":false,"comment_ctime":1573093773,"is_pvip":false,"replies":[{"id":"57430","content":"æ— è§£ï¼Œå¿…é¡»æ§åˆ¶çº¿ç¨‹æ•°é‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1573216494,"ip_address":"","comment_id":148840,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10163028365","product_id":100023901,"comment_content":"è€å¸ˆè¯·æ•™ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸åŒä¸šåŠ¡ç”¨ä¸åŒçº¿ç¨‹æ± ï¼Œä¿è¯ä¸äº†çº¿ç¨‹æ•°é‡ï¼Œä¼šå¸¦æ¥å¹¶å‘çº¿ç¨‹è¿‡å¤§ï¼Œå¦‚ä½•æ§åˆ¶é¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„é—®é¢˜","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473632,"discussion_content":"æ— è§£ï¼Œå¿…é¡»æ§åˆ¶çº¿ç¨‹æ•°é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573216494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301299,"user_name":"ç‹æˆî”“","can_delete":false,"product_type":"c1","uid":1441460,"ip_address":"","ucode":"29765BBCD3B8B2","user_header":"https://static001.geekbang.org/account/avatar/00/15/fe/b4/6902ac00.jpg","comment_is_top":false,"comment_ctime":1625624569,"is_pvip":false,"replies":[{"id":"112071","content":"è®¾ç½®è¶…æ—¶ç»å¯¹æ˜¯æœ€ä½³å®è·µï¼Œå¦åˆ™å¿…ç„¶å‡ºäº‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1630132298,"ip_address":"","comment_id":301299,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5920591865","product_id":100023901,"comment_content":"æœ€è¿‘å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªå…³äºçº¿ç¨‹æ± çš„é—®é¢˜ï¼Œè«åå…¶å¦™çš„çº¿ç¨‹å°±ä¸åœ¨æ‰§è¡Œ<br>é—®é¢˜çš„åŸå› æ˜¯<br>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šå»è¯·æ±‚ä¸€æ¬¡httpï¼Œä½†æ˜¯æ—¶é—´é•¿äº†ä¼šå‡ºç°é˜»å¡ç°è±¡ï¼ˆhttpå·¥å…·ç±»å†™çš„æœ‰ç‚¹é—®é¢˜ï¼‰<br>æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼Œé™¤äº†ä¼˜åŒ–å·¥å…·ç±»ï¼Œè¿˜ç»™æ¯ä¸€ä¸ªçº¿ç¨‹è®¾ç½®äº†è¶…æ—¶æ—¶é—´","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522962,"discussion_content":"è®¾ç½®è¶…æ—¶ç»å¯¹æ˜¯æœ€ä½³å®è·µï¼Œå¦åˆ™å¿…ç„¶å‡ºäº‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630132298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284597,"user_name":"å¼ ç”³å‚²","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1616380356,"is_pvip":true,"replies":[{"id":"103329","content":"ä¸€èˆ¬äººè§£å†³é—®é¢˜éƒ½æ˜¯ä»¥ç°å®ä¸–ç•Œæ¨¡å‹ä¸ºä¸»çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1616499544,"ip_address":"","comment_id":284597,"utype":1}],"discussion_count":1,"race_medal":2,"score":"5911347652","product_id":100023901,"comment_content":"è¶Šæ¥è¶Šå‘ç°ï¼Œè½¯ä»¶é¢†åŸŸä¸­çš„å¾ˆå¤šé—®é¢˜ï¼Œéƒ½å¯ä»¥å‘ç°å®ä¸–ç•Œå¯»æ±‚ç­”æ¡ˆã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517401,"discussion_content":"ä¸€èˆ¬äººè§£å†³é—®é¢˜éƒ½æ˜¯ä»¥ç°å®ä¸–ç•Œæ¨¡å‹ä¸ºä¸»çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616499544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159469,"user_name":"å¤§å¤§å¤§ç†Šmyeh","can_delete":false,"product_type":"c1","uid":1139413,"ip_address":"","ucode":"4832C2E7CEB151","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/d5/1f5c5ab6.jpg","comment_is_top":false,"comment_ctime":1575631043,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5870598339","product_id":100023901,"comment_content":"é¦–å…ˆå®ƒæ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œç¬¬ä¸€æ¬¡submitçš„ä»»åŠ¡æ˜¯è·å–â€œç»™poolçº¿ç¨‹æ± è®¾ç½®çš„ç¬¬äºŒä¸ªsubmitä»»åŠ¡çš„è¿”å›å€¼â€ï¼Œç„¶åè¾“å‡ºã€‚ç„¶è€Œå› ä¸ºæ˜¯å•çº¿ç¨‹æ± ï¼Œæ°¸è¿œä¹Ÿç­‰ä¸åˆ°ç¬¬äºŒä¸ªçº¿ç¨‹ä»»åŠ¡è¿”å›QQã€‚ç¬¬ä¸€ä¸ªçº¿ç¨‹ä»»åŠ¡ä¾èµ–äºç¬¬äºŒä¸ªä»»åŠ¡ï¼Œå¯¼è‡´æ­»é”ã€‚å‘¼åº”æœ¬ç« ä¸»é¢˜ï¼šçº¿ç¨‹æ± åˆ†å·¥ã€‚","like_count":1},{"had_liked":false,"id":95685,"user_name":"æ‰¬ï½","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1558143030,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853110326","product_id":100023901,"comment_content":"å¯ä»¥å‡ºä¸ªçº¿ç¨‹æ± å¼‚å¸¸å¤„ç†çš„æ–¹æ¡ˆå—","like_count":1},{"had_liked":false,"id":95335,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1558021126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852988422","product_id":100023901,"comment_content":"æœ‰é—®é¢˜ï¼Œsinglepoolä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œfuture.getæ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹ï¼Œå¯¼è‡´æ‰“å°qqçš„çº¿ç¨‹æ²¡æœ‰æœºä¼šæ‰§è¡Œï¼Œä¼šæ ¹æ®ä¸¢å¼ƒç­–ç•¥è¿›è¡Œä¸åŒçš„æ“ä½œã€‚","like_count":1},{"had_liked":false,"id":95155,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1557975482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852942778","product_id":100023901,"comment_content":"çº¿ç¨‹æ± é‡Œé¢çš„æœ€å¤§çº¿ç¨‹æ•°åªæœ‰ä¸€ä¸ªï¼Œæ— æ³•åšåˆ°å¼‚æ­¥","like_count":1},{"had_liked":false,"id":350374,"user_name":"ç å°å‘†","can_delete":false,"product_type":"c1","uid":2055809,"ip_address":"","ucode":"44532D6ABF9340","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","comment_is_top":false,"comment_ctime":1656857314,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656857314","product_id":100023901,"comment_content":"è¿™æ®µä»£ç ,æ„Ÿè§‰æ˜¯å¯¹åº”äº†ä¹¦ä¸­çš„ : å¦‚æœæäº¤åˆ°ç›¸åŒçº¿ç¨‹æ± çš„ä»»åŠ¡ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯æœ‰ä¾èµ–å…³ç³»çš„ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¼è‡´çº¿ç¨‹æ­»é” è¿™ä¸€æ®µè¯.","like_count":0},{"had_liked":false,"id":289128,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1618884019,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618884019","product_id":100023901,"comment_content":"è¿™è·Ÿä¸Šé¢è®²çš„æ­»é”ä¾‹å­ä¸€æ ·å‘€","like_count":0},{"had_liked":false,"id":284255,"user_name":"ä¿ºèƒ½å­¦ä¸ªå•¥","can_delete":false,"product_type":"c1","uid":1026742,"ip_address":"","ucode":"30740C5B58774C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/b6/46a5bbf3.jpg","comment_is_top":false,"comment_ctime":1616142184,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616142184","product_id":100023901,"comment_content":"å•çº¿ç¨‹æ± æäº¤ä»»åŠ¡é‡Œé¢ä¾ç„¶æäº¤ä»»åŠ¡ï¼Œè¿™ä¼šå¯¼è‡´é‡Œé¢çš„ä»»åŠ¡ä¼šæ”¾è¿›é˜»å¡é˜Ÿåˆ—ï¼Œè€Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šå¯¼è‡´æ— æ³•è¿”å›ç»“æœï¼Œå¤–é¢çš„ä¹Ÿä¼šé˜»å¡ï¼Œé‡Œé¢çš„ä¹Ÿä¼šé˜»å¡ï¼Œå°±å¡åœ¨é‚£é‡Œã€‚ã€‚","like_count":0},{"had_liked":false,"id":275932,"user_name":"å–ƒå¯»","can_delete":false,"product_type":"c1","uid":1565085,"ip_address":"","ucode":"E31B3660726671","user_header":"https://static001.geekbang.org/account/avatar/00/17/e1/9d/3ec0adec.jpg","comment_is_top":false,"comment_ctime":1611719591,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1611719591","product_id":100023901,"comment_content":"è¿™é‡Œä¼šæ­»é”ï¼ŒåŸå› æ˜¯submitæ–¹æ³•æ˜¯éœ€è¦ç­‰å¾…è¿”å›å€¼çš„ï¼Œè€Œè¿™é‡Œæ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥é‡Œé¢çš„submitæ²¡æœ‰å¯ä»¥æ‰§è¡Œçš„çº¿ç¨‹ï¼Œå¯¼è‡´ä¸€ç›´ç­‰å¾…","like_count":0},{"had_liked":false,"id":268911,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1608431140,"is_pvip":false,"replies":[{"id":"97553","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1608465100,"ip_address":"","comment_id":268911,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1608431140","product_id":100023901,"comment_content":"æœ¬ç¯‡å°±æ˜¯ä¸€ä¸ªä¸»é¢˜ï¼Œjavaåˆ›å»ºçº¿ç¨‹æ± ï¼Œå¹¶ç‰¹åˆ«æ³¨æ„<br>1ã€ç”Ÿäº§ä¸­æ‹’ç»ä½¿ç”¨Executorsæä¾›çš„åˆå§‹åŒ–çº¿ç¨‹æ± çš„æ–¹æ³•ï¼ˆå› ä¸ºä½¿ç”¨æ— è§£é˜Ÿåˆ—ï¼‰<br>2ã€ç”Ÿäº§ç¯å¢ƒåº”æ ¹æ®ä¸šåŠ¡è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512077,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608465100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336058,"discussion_content":"è€å¸ˆï¼Œæœ€è¿‘çš„ç•™è¨€å¥½å‡ ä¸ªéƒ½æ˜¯ä¹±ç ï¼Ÿåªæœ‰æˆ‘çœ‹åˆ°ä¹±ç å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608465165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239926,"user_name":"Arthur","can_delete":false,"product_type":"c1","uid":1222441,"ip_address":"","ucode":"FF96EEDEBF7E3C","user_header":"https://static001.geekbang.org/account/avatar/00/12/a7/29/977c3280.jpg","comment_is_top":false,"comment_ctime":1596695369,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596695369","product_id":100023901,"comment_content":"Executors .newSingleThreadExecutor() åˆ›å»ºçš„çº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨å®ç°ä¸Šåªæœ‰ä¸€ä¸ªçº¿ç¨‹å¤„ç†ï¼Œè·Ÿå¼‚æ­¥çš„æ¦‚å¿µæœ‰å·®åˆ«ï¼Œæ›´ææ€–æ˜¯åœ¨çº¿ç¨‹æ± é‡Œæœ‰é‡å¤ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡ï¼Œä»»åŠ¡ä¹‹é—´å‡ºç°ä¾èµ–ï¼Œè¿™æ ·ä»»åŠ¡æ°¸è¿œä¸ä¼šæ‰“å°äº†ã€‚","like_count":0},{"had_liked":false,"id":234659,"user_name":"FH","can_delete":false,"product_type":"c1","uid":1179224,"ip_address":"","ucode":"E47F6765CF1EEE","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/58/2cddaca4.jpg","comment_is_top":false,"comment_ctime":1594743387,"is_pvip":false,"replies":[{"id":"87044","content":"ä¸åˆç†ï¼Œ ç¤ºä¾‹ä»£ç åªæ˜¯ä»£ç å‰æ®µï¼Œè¯´æ˜ç”¨æ³•è€Œå·²ã€‚å†™å®Œæ•´çš„ç±»ï¼Œæœ‰å¾ˆå¤šç¼©è¿›ï¼Œä»£ç å¾ˆéš¾åœ¨æ‰‹æœºä¸Šå¾ˆæ’ç‰ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1595161015,"ip_address":"","comment_id":234659,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594743387","product_id":100023901,"comment_content":"è€å¸ˆæœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸€ä¸‹ï¼Œçº¿ç¨‹æ± ä¸åº”è¯¥æ˜¯é¡¹ç›®å¯åŠ¨æ—¶åŠ è½½æˆ–è€…æ‡’åŠ è½½æ¨¡å¼å—ï¼Œä½†æ˜¯çœ‹ç¤ºä¾‹ä»£ç éƒ½æ˜¯è°ƒç”¨ä¸šåŠ¡ä»£ç æ—¶æ‰å»åˆ›å»ºExecutorServiceï¼Œè¿™æ ·åˆç†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501451,"discussion_content":"ä¸åˆç†ï¼Œ ç¤ºä¾‹ä»£ç åªæ˜¯ä»£ç å‰æ®µï¼Œè¯´æ˜ç”¨æ³•è€Œå·²ã€‚å†™å®Œæ•´çš„ç±»ï¼Œæœ‰å¾ˆå¤šç¼©è¿›ï¼Œä»£ç å¾ˆéš¾åœ¨æ‰‹æœºä¸Šå¾ˆæ’ç‰ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595161015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212007,"user_name":"è§å—å±±","can_delete":false,"product_type":"c1","uid":1118111,"ip_address":"","ucode":"6A8BB82B7573CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/9f/f4b06bd5.jpg","comment_is_top":false,"comment_ctime":1588045497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588045497","product_id":100023901,"comment_content":"å•çº¿ç¨‹æ± çº¿ç¨‹æ± ç›´æ¥é˜»å¡åœ¨getå¤„ï¼Œè€Œå†ç­‰å¾…çš„ä»»åŠ¡æ°¸è¿œåœ¨é˜»å¡é˜Ÿåˆ—ä¸­æ”¾ç€ã€‚ä¸€ä¸ªç­‰ç»“æœï¼Œä¸€ä¸ªç­‰çº¿ç¨‹ã€‚å‡‰å‡‰ï½","like_count":0},{"had_liked":false,"id":207463,"user_name":"å¬é›¨","can_delete":false,"product_type":"c1","uid":1254493,"ip_address":"","ucode":"252754F9FCFF0C","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","comment_is_top":false,"comment_ctime":1587089397,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587089397","product_id":100023901,"comment_content":"è€å¸ˆï¼Œjavaçš„ThreadPoolExecutoré‡Œä¸ºä»€ä¹ˆæŠŠrunStateå’ŒWorkerCountä¸¤ä¸ªå­—æ®µåŒ…è£…åˆ°ctlä¸€ä¸ªå˜é‡é‡Œï¼Œåˆ†å¼€ä¸¤ä¸ªå®ƒä¸é¦™å—ï¼Œè¿˜çœå¾—æ¯æ¬¡ä½è¿ç®—æ‰èƒ½è·å–åˆ°å…·ä½“çš„runStateå’ŒWorkerCountäº†","like_count":0},{"had_liked":false,"id":195759,"user_name":"Mr.wang","can_delete":false,"product_type":"c1","uid":1224805,"ip_address":"","ucode":"86F341A5316BBC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/65/90387745.jpg","comment_is_top":false,"comment_ctime":1585215018,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1585215018","product_id":100023901,"comment_content":"åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çº¿ç¨‹æ± ï¼Œå†è¿è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œä¸»ä»»åŠ¡å…ˆè·å–çº¿ç¨‹ï¼Œè¿›å…¥åˆ°ä»»åŠ¡é‡Œé¢åï¼Œä¹Ÿä½¿ç”¨çº¿ç¨‹ä¸­çš„çº¿ç¨‹ï¼Œä½†è¿™é‡Œæ˜¯å•çº¿ç¨‹çº¿ç¨‹æ± ï¼Œå­ä»»åŠ¡è·å–ä¸åˆ°çº¿ç¨‹ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åŠ å¤§çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ã€‚","like_count":0},{"had_liked":false,"id":182013,"user_name":"ç”µå…‰ç«çŸ³","can_delete":false,"product_type":"c1","uid":1013160,"ip_address":"","ucode":"3AD33BB4AA940F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/a8/dfe4cade.jpg","comment_is_top":false,"comment_ctime":1582692190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582692190","product_id":100023901,"comment_content":"æœ‰ä¸ªé—®é¢˜æ˜¯å…³äºforkjoinpoolçš„æ­»é”é—®é¢˜ï¼Œå‡è®¾æˆ‘ç°åœ¨åˆ›å»ºäº†4ä¸ªçº¿ç¨‹çš„forkjoinpoolï¼Œå½“æˆ‘åšä»»åŠ¡æ‹†åˆ†çš„ï¼Œå¯èƒ½éœ€è¦æ‹†åˆ†8æ¬¡ï¼Œæˆ‘ç†è§£Aæ‹†æˆ2ä¸ªå­ä»»åŠ¡çš„æ—¶å€™ï¼ŒAä¹Ÿæ˜¯ä¸€ç›´åœ¨ç­‰å¾…çš„ï¼Œé‚£è¿™æ ·ä¼šä¸ä¼šé€ æˆæ²¡æœ‰çº¿ç¨‹å¯ç”¨è€Œå½¢æˆæ­»é”ï¼Ÿè¿˜æ˜¯è¯´forkjoinpool æœ‰å¾ˆå¥½çš„æœºåˆ¶ï¼ŒAçº¿ç¨‹ç­‰å¾…çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠçº¿ç¨‹ç©ºå‡ºæ¥è¿›è¡Œè°ƒåº¦ï¼Ÿè°¢è°¢äº†ï¼","like_count":0},{"had_liked":false,"id":137739,"user_name":"Sharry","can_delete":false,"product_type":"c1","uid":1239293,"ip_address":"","ucode":"045DDB864659F6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/fd/035f4c94.jpg","comment_is_top":false,"comment_ctime":1569833944,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569833944","product_id":100023901,"comment_content":"è¿™ä¸ª WorkerThread ä»»åŠ¡åˆ†é…æ¨¡å¼ä¸ç”Ÿäº§è€…æ¶ˆè´¹è€…å¾ˆåƒå•Š<br>","like_count":0},{"had_liked":false,"id":137737,"user_name":"Sharry","can_delete":false,"product_type":"c1","uid":1239293,"ip_address":"","ucode":"045DDB864659F6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/fd/035f4c94.jpg","comment_is_top":false,"comment_ctime":1569833753,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569833753","product_id":100023901,"comment_content":"åªæœ‰ä¸€ä¸ªçº¿ç¨‹, ä¼šé˜»å¡åœ¨ get æ–¹æ³•ä¸Š, ç›´åˆ°æ°¸ä¹…","like_count":0},{"had_liked":false,"id":137418,"user_name":"DFighting","can_delete":false,"product_type":"c1","uid":1233193,"ip_address":"","ucode":"F3BA2426FF8582","user_header":"https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg","comment_is_top":false,"comment_ctime":1569736620,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1569736620","product_id":100023901,"comment_content":"æ‰§è¡Œä»£ç åæŸ¥çœ‹çº¿ç¨‹æ ˆä¼šå‘ç°pool-1-thread-1ä¸€ç›´å¤„äºwaitingçŠ¶æ€ï¼Œå› ä¸ºå¤–å±‚çš„pool.submitç­‰å¾…å†…å±‚pool.submitï¼Œå†…å±‚åˆåœ¨ç­‰å¾…å¤–å±‚submitçš„é‡Šæ”¾ï¼Œç®€ç›´æ˜¯ç›¸äº’ä¼¤å®³åˆ°åœ°è€å¤©è’å•Šã€‚è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š<br>1ã€æœ€ç®€å•å°±æ˜¯æŠŠçº¿ç¨‹ä¸ªæ•°ä»1ä¸ªæ”¹åˆ°2ä¸ªï¼Œç„¶åä»£ç è¿è¡Œå°±ä¼šæˆåŠŸæ‰“å°å‡ºæ¥QQ<br>2ã€çœŸæ­£è¦è§£å†³çš„è¿˜æ˜¯éœ€è¦é’ˆå¯¹æœ‰ä¾èµ–å…³ç³»çš„ä»£ç åˆ†é…ä¸åŒçš„çº¿ç¨‹æ± ï¼Œåªæœ‰çœŸæ­£æ— å…³çš„é€»è¾‘æ‰èƒ½å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ã€‚<br>ç¬¬ä¸€æ¬¡å‘ç°åŸæ¥çº¿ç¨‹æ± ä¹‹ä¸­è¿˜æœ‰deadlockçš„é—®é¢˜å­˜åœ¨ï¼Œå…¶å®è¯´ç™½äº†ï¼Œçº¿ç¨‹æ± åªæ˜¯è§£å†³äº†é¢‘ç¹çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯çš„ä»£ä»·é—®é¢˜ï¼Œå…³äºå¹¶å‘æ‰€å¸¦æ¥çš„çš„é—®é¢˜ï¼Œå®ƒæ˜¯ä¸€ç‚¹åŠ›éƒ½æ²¡å‡ºçš„ï¼Œç”šè‡³æŸäº›æ—¶å€™è¿˜å¸¦æ¥äº†ä¸€äº›é—®é¢˜(æ¯”å¦‚threadlocal)ã€‚","like_count":0},{"had_liked":false,"id":96618,"user_name":"å¥½ç‰™","can_delete":false,"product_type":"c1","uid":1117320,"ip_address":"","ucode":"F36A824C1AB19A","user_header":"","comment_is_top":false,"comment_ctime":1558480464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558480464","product_id":100023901,"comment_content":"å¤–éƒ¨çº¿ç¨‹ä¼šç”±äºå†…éƒ¨çº¿ç¨‹submit.getè€Œé˜»å¡ï¼Œå æœ‰singleçº¿ç¨‹æ± çš„å”¯ä¸€workerèµ„æºï¼Œä»è€Œå¯¼è‡´å†…éƒ¨çº¿ç¨‹æ°¸è¿œæ— æ³•æ‰§è¡Œï¼Œå½¢æˆæ´»é”ã€‚è§£æ³•å¯ä»¥æ‹†åˆ†ä¸ºä¸¤ä¸ªçº¿ç¨‹æ± ã€‚","like_count":0},{"had_liked":false,"id":95284,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1558007235,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1558007235","product_id":100023901,"comment_content":"çº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œçš„æ—¶å€™ä¸èƒ½æœ‰å†å¤šçš„çº¿ç¨‹å»å¤„ç†æäº¤çš„ä»»åŠ¡ã€‚","like_count":0},{"had_liked":false,"id":95113,"user_name":"å‘¨æ²»æ…§","can_delete":false,"product_type":"c1","uid":1335293,"ip_address":"","ucode":"7D56C4E66BEE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","comment_is_top":false,"comment_ctime":1557969892,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557969892","product_id":100023901,"comment_content":"ä¸¤ä¸ªçº¿ç¨‹å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå½“çº¿ç¨‹æ± ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯æ‹¿é‚£ä¸åˆ°çº¿ç¨‹çš„","like_count":0},{"had_liked":false,"id":95108,"user_name":"å­™å¿—å¼º","can_delete":false,"product_type":"c1","uid":1325997,"ip_address":"","ucode":"9C070F1E4EC6FF","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/ad/31193b83.jpg","comment_is_top":false,"comment_ctime":1557969550,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1557969550","product_id":100023901,"comment_content":"æ­»é”","like_count":0},{"had_liked":false,"id":95075,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1557966244,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557966244","product_id":100023901,"comment_content":"è·Ÿä»Šå¤©çš„ä¾‹å­å¥½åƒã€‚ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå´æäº¤2ä¸ªä»»åŠ¡ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦å¤–ä¸€ä¸ªçº¿ç¨‹","like_count":0},{"had_liked":false,"id":95074,"user_name":"æ™ºè¶…","can_delete":false,"product_type":"c1","uid":1109769,"ip_address":"","ucode":"1C28A46FDD7FA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/09/209cb7ff.jpg","comment_is_top":false,"comment_ctime":1557966244,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557966244","product_id":100023901,"comment_content":"çº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹å°±æ‚²å‰§äº†","like_count":0},{"had_liked":false,"id":95060,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1557965323,"is_pvip":false,"replies":[{"id":"34153","content":"æœ€å¤šçš„æƒ…å†µæ˜¯é‡å¯çš„æ—¶å€™","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558091625,"ip_address":"","comment_id":95060,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557965323","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼Œæƒ³é—®ä¸‹çº¿ç¨‹æ± è¯¥ä»€ä¹ˆæ—¶å€™é”€æ¯?","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450315,"discussion_content":"æœ€å¤šçš„æƒ…å†µæ˜¯é‡å¯çš„æ—¶å€™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558091625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95055,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1557964700,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557964700","product_id":100023901,"comment_content":"Aä»»åŠ¡ç­‰å¾…Bä»»åŠ¡è¿”å›QQå­—ç¬¦ä¸²ï¼Œä½†æ˜¯çº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ŒBä»»åŠ¡æ²¡æœ‰å¤šä½™çš„çº¿ç¨‹æ‰§è¡Œï¼Œå¯¼è‡´çº¿ç¨‹æ± ç˜«ç—ª","like_count":0},{"had_liked":false,"id":95012,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1557938313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557938313","product_id":100023901,"comment_content":"ä¸ºä»€ä¹ˆæ€è€ƒæä¼šæœ‰ä¸¤æ¬¡submitæ–¹æ³•ï¼ŒçŒœè¿™é‡Œåº”è¯¥å°±æ˜¯é—®é¢˜äº†ã€‚æ‰“å¡ï¼","like_count":0}]}