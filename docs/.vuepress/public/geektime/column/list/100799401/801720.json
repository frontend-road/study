{"id":801720,"title":"01ï½œå¿«é€Ÿä¸Šæ‰‹æ•°æ®åº“å®‰è£…éƒ¨ç½²","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿Šè¾¾ã€‚ä»Šå¤©æˆ‘ä»¬å¼€å§‹MySQLè¿ç»´è¯¾ç¨‹çš„ç¬¬ä¸€è®²ï¼Œå¿«é€Ÿä¸Šæ‰‹æ•°æ®åº“å®‰è£…éƒ¨ç½²ã€‚</p><p>ä½ å¯èƒ½ä¼šæœ‰ä¸€äº›ç–‘é—®ï¼Œç°åœ¨äº‘æ•°æ®åº“å‘å±•å¾—è¿™ä¹ˆå¥½ï¼Œåªéœ€è¦åœ¨äº‘å¹³å°ä¸‹å•ï¼Œå°±èƒ½è‡ªåŠ¨è·å–ä¸€ä¸ªå®‰è£…é…ç½®å¥½çš„æ•°æ®åº“ã€‚å°±ç®—ä¸ç”¨äº‘æ•°æ®åº“ï¼Œä¼ä¸šå†…éƒ¨å¤šåŠä¹Ÿä¼šæœ‰ä¸€äº›è¿ç»´ç®¡ç†å¹³å°ï¼Œå¯ä»¥æŒ‰éœ€åˆ›å»ºæ•°æ®åº“ç¯å¢ƒã€‚ä¸ºä»€ä¹ˆè¿˜è¦å­¦æ•°æ®åº“å®‰è£…è¿™ä¹ˆåŸºç¡€çš„çŸ¥è¯†ï¼Ÿ</p><p>å¯¹è¿™ä¸ªé—®é¢˜æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼šé¦–å…ˆï¼Œå®‰è£…æ•°æ®åº“æ˜¯äº†è§£ä¸€ä¸ªæ•°æ®åº“çš„ç¬¬ä¸€æ­¥ã€‚é€šè¿‡å®‰è£…éƒ¨ç½²ï¼Œä½ å¯ä»¥äº†è§£æ•°æ®åº“çš„æ ¸å¿ƒç»„ä»¶ï¼Œæ•°æ®åº“ç”±å“ªäº›æ–‡ä»¶ç»„æˆï¼ŒæœåŠ¡æ˜¯æ€ä¹ˆå¯åŠ¨å’Œåœæ­¢çš„ã€‚</p><p>å…¶æ¬¡ï¼Œè¦æ·±å…¥æŒæ¡ä¸€é—¨æ•°æ®åº“æŠ€æœ¯ï¼Œç¦»ä¸å¼€å¤§é‡çš„å®è·µæ“ä½œã€‚ä½ åœ¨æ–‡æ¡£æˆ–ä¹¦ç±ä¸Šçœ‹åˆ°çš„çŸ¥è¯†ï¼Œéœ€è¦åœ¨çœŸå®çš„æ•°æ®åº“ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•éªŒè¯ï¼Œè¿™ä¸ä»…èƒ½éªŒè¯ä½ çœ‹åˆ°çš„å†…å®¹æ˜¯å¦æ­£ç¡®ï¼Œä¹Ÿèƒ½åŠ æ·±ä½ å¯¹ç›¸å…³çŸ¥è¯†çš„ç†è§£ã€‚æ‰€ä»¥ä½ éœ€è¦ä»é›¶å¼€å§‹æ­å»ºæ•°æ®åº“ã€åˆ›å»ºç”¨æˆ·ã€é…ç½®æ•°æ®åº“ã€æ­å»ºæ•°æ®åº“é«˜å¯ç”¨ç¯å¢ƒï¼Œæµ‹è¯•å’ŒéªŒè¯æ•°æ®åº“çš„å„ç§åŠŸèƒ½ã€‚</p><p>æœ€åï¼Œè™½ç„¶äº‘æ•°æ®åº“å·²ç»å°†å¤§é‡æ•°æ®åº“è¿ç»´ç®¡ç†çš„åŠ¨ä½œè‡ªåŠ¨åŒ–äº†ï¼Œä½†æ˜¯èƒŒåè¿˜æ˜¯éœ€è¦æœ‰äººå»è®¾è®¡å’Œè¿ç»´äº‘å¹³å°æœ¬èº«ï¼Œè€Œä½ å°†æ¥å¯èƒ½å°±æ˜¯äº‘æ•°æ®åº“èƒŒåçš„é‚£ä¸ªäººã€‚è€Œä¸”ï¼Œåœ¨å·¥ä½œä¸­ï¼Œä½ å¯èƒ½éœ€è¦è§£å†³ä¸åŒç¯å¢ƒä¸‹çš„å„ç§åƒå¥‡ç™¾æ€ªçš„æ•°æ®åº“é—®é¢˜ã€‚ç³»ç»Ÿåœ°æŒæ¡æ•°æ®åº“ä»å®‰è£…éƒ¨ç½²åˆ°è¿ç»´ç®¡ç†æ•´ä¸ªç¯èŠ‚ï¼Œèƒ½å¸®ä½ æ›´å¥½åœ°åº”å¯¹å„ç§ç¯å¢ƒä¸‹çš„å¤æ‚é—®é¢˜ã€‚</p><!-- [[[read_end]]] --><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«æ¥å­¦ä¹ äºŒè¿›åˆ¶å®‰è£…ã€RPMåŒ…å®‰è£…å’Œæºç ç¼–è¯‘å®‰è£…è¿™å‡ ç§å®‰è£…æ–¹å¼ã€‚æˆ‘ä»¬ä½¿ç”¨CentOS 7.9æ“ä½œç³»ç»Ÿæ¥è¿è¡ŒMySQLã€‚è¯·è®°ä½ï¼Œ<strong>æˆ‘ä»¬çš„ç›®æ ‡å¹¶ä¸ä»…ä»…æ˜¯å®‰è£…MySQLï¼Œè€Œæ˜¯é€šè¿‡å®‰è£…éƒ¨ç½²æ¥æ·±å…¥ç†è§£MySQLçš„è¿è¡Œæ–¹å¼</strong>ã€‚</p><h2>äºŒè¿›åˆ¶å®‰è£…</h2><p>ä½¿ç”¨äºŒè¿›åˆ¶åŒ…å®‰è£…MySQLæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§æ–¹å¼ï¼Œä¸»è¦åˆ†ä¸ºå…­ä¸ªæ­¥éª¤ã€‚</p><ol>\n<li>è·å–äºŒè¿›åˆ¶å®‰è£…åŒ…ã€‚</li>\n<li>åˆ›å»ºè¿è¡ŒMySQLçš„ç”¨æˆ·ã€‚</li>\n<li>è§„åˆ’æ•°æ®ç›®å½•ï¼Œå‡†å¤‡my.cnfå‚æ•°æ–‡ä»¶ã€‚</li>\n<li>åˆå§‹åŒ–æ•°æ®åº“ã€‚</li>\n<li>å¯åŠ¨æ•°æ®åº“æœåŠ¡ã€‚</li>\n<li>è®¾ç½®æ•°æ®åº“åˆå§‹å¯†ç ã€‚</li>\n</ol><h3>ç¬¬ä¸€æ­¥ï¼šè·å–äºŒè¿›åˆ¶å®‰è£…åŒ…</h3><p>å…ˆåˆ°MySQLå®˜ç½‘ä¸‹è½½äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œé€‰æ‹©8.0 GAæœ€æ–°ç‰ˆæœ¬ï¼Œå½“å‰8.0æœ€æ–°GAç‰ˆæœ¬æ˜¯8.0.39ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/78/33/78dd677eeff113b92831bf570ff5cb33.png?wh=1920x1186\" alt=\"å›¾ç‰‡\"></p><p><span class=\"reference\">æ³¨ï¼šMySQLä¸€èˆ¬3ä¸ªæœˆå·¦å³å‡ºä¸€ä¸ªæ–°çš„å°ç‰ˆæœ¬ï¼Œä½ çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œå¯èƒ½åˆå‡ºäº†æ–°çš„ç‰ˆæœ¬ï¼Œä½†åŸºæœ¬ä¸Šä¸å½±å“æ–‡ç« åé¢çš„è®¨è®ºã€‚</span></p><p>ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€‰æ‹©â€œLinux - Genericâ€ï¼Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬è¦æ ¹æ®ç³»ç»Ÿçš„glibcç‰ˆæœ¬æ¥é€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›æ–¹æ³•æ¥ç¡®å®šglibcçš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚é€šè¿‡lddå‘½ä»¤ã€‚</p><pre><code class=\"language-go\"># ldd --version\nldd (GNU libc) 2.17\n</code></pre><p>å¯ä»¥å…ˆç”¨æµè§ˆå™¨ä¸‹è½½å®‰è£…åŒ…ï¼Œå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨wgetã€curlç­‰å·¥å…·ä¸‹è½½ã€‚</p><pre><code class=\"language-go\">wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.39-linux-glibc2.17-x86_64.tar.xz\n</code></pre><p>å®‰è£…åŒ…ä¸‹è½½å®Œæˆåä½¿ç”¨md5sumå·¥å…·æ£€æŸ¥æ–‡ä»¶æ ¡éªŒç æ˜¯å¦å’Œå®˜ç½‘ä¸Šæä¾›çš„ä¸€è‡´ã€‚</p><pre><code class=\"language-go\"># md5sum  mysql-8.0.39-linux-glibc2.17-x86_64.tar.xz\n1c092c3814b10bfa0794077867f9f4ad  mysql-8.0.39-linux-glibc2.17-x86_64.tar.xz\n</code></pre><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œè§£å‹äºŒè¿›åˆ¶åŒ…ï¼Œå°†è§£å‹åçš„æ–‡ä»¶å¤¹æ”¾åˆ°ä¸€ä¸ªå®‰è£…ç›®å½•ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å®‰è£…åŒ…æ”¾åˆ°/optç›®å½•ä¸‹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ã€‚</p><pre><code class=\"language-go\"># tar xvf mysql-8.0.39-linux-glibc2.17-x86_64.tar.xz\n# mv mysql-8.0.39-linux-glibc2.17-x86_64 /opt\n# ln -s /opt/mysql-8.0.39-linux-glibc2.17-x86_64 /opt/mysql80\n</code></pre><p>åˆ°è¿™é‡Œï¼ŒMySQLè½¯ä»¶å…¶å®å°±å·²ç»å®‰è£…å¥½äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹MySQLå®‰è£…ç›®å½•ä¸‹éƒ½æœ‰å“ªäº›æ–‡ä»¶ã€‚</p><p>binç›®å½•ä¸‹åŒ…å«MySQLçš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œä»¥åŠä¸€äº›å‘½ä»¤è¡Œå·¥å…·ã€‚libç›®å½•ä¸­æœ‰MySQLå®¢æˆ·ç«¯åº“ï¼Œä½¿ç”¨C APIè®¿é—®MySQLæ•°æ®åº“æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¿™é‡Œé¢çš„åº“æ–‡ä»¶ã€‚libç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªpluginç›®å½•ï¼Œå­˜æ”¾ç€MySQLçš„å„ç±»æ’ä»¶ï¼ŒåŒ…æ‹¬æˆ‘ä»¬åœ¨åç»­è¯¾ç¨‹ä¸­ä¼šä»‹ç»çš„CLONEæ’ä»¶ã€åŠåŒæ­¥æ’ä»¶ã€ç»„å¤åˆ¶ï¼ˆMGRï¼‰æ’ä»¶ã€‚includeç›®å½•ä¸‹æ˜¯C APIçš„å¤´æ–‡ä»¶ï¼Œç¼–è¯‘è®¿é—®MySQLçš„Cä»£ç æ—¶ä¼šç”¨åˆ°è¿™äº›æ–‡ä»¶ã€‚shareç›®å½•ä¸‹æœ‰ä¸€äº›è¿è¡ŒMySQLéœ€è¦ç”¨åˆ°çš„æ–‡ä»¶ï¼Œå¦‚ä¸åŒè¯­è¨€çš„é”™è¯¯æ—¥å¿—ä¿¡æ¯æ–‡ä»¶ã€å­—ç¬¦é›†çš„å®šä¹‰æ–‡ä»¶ã€‚</p><p>ä¸‹é¢è¡¨æ ¼å¯¹å…¶ä¸­ä¸€äº›é‡è¦æ–‡ä»¶åšäº†ç®€å•ä»‹ç»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fd/bc/fdd87958275e4e125e45eae6ed94a5bc.jpg?wh=1920x980\" alt=\"å›¾ç‰‡\"></p><h3>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºè¿è¡ŒMySQLçš„ç”¨æˆ·</h3><p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç”¨æˆ·æ¥è¿è¡ŒMySQLã€‚</p><pre><code class=\"language-go\">groupadd mysql \nuseradd mysql -g mysql \n</code></pre><h3>ç¬¬ä¸‰æ­¥ï¼šè§„åˆ’æ•°æ®ç›®å½•ï¼Œå‡†å¤‡my.cnfå‚æ•°æ–‡ä»¶</h3><p>æˆ‘ä»¬éœ€è¦è§„åˆ’ä¸€ä¸ªæ•°æ®ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾MySQLçš„æ•°æ®æ–‡ä»¶ï¼Œä»¥åŠå„ç±»æ—¥å¿—æ–‡ä»¶ã€‚å¦‚æœä½ éƒ¨ç½²çš„MySQLå°†ç”¨äºç”Ÿäº§ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä½ ä½¿ç”¨æ»¡è¶³ä¸€å®šæ€§èƒ½è¦æ±‚çš„ç£ç›˜è®¾å¤‡ï¼Œå¦‚SSDï¼Œä»¥ä¿éšœæ€§èƒ½ã€‚</p><p>è¿™é‡Œæä¾›ä¸€ç§æˆ‘å¹³æ—¶ä½¿ç”¨çš„ç›®å½•è§„åˆ’æ–¹å¼ã€‚</p><pre><code class=\"language-go\">mkdir -p /data/mysql3306/{data,log,binlog,relaylog,run,tmp}\n</code></pre><pre><code class=\"language-plain\"># tree -d -L 2 /data\n/data\n|-- mysql3306\n|   |-- binlog\n|   |-- data\n|   |-- log\n|   |-- relaylog\n|   |-- run\n|   `-- tmp\n|-- mysql3307\n|   |-- binlog\n|   |-- data\n|   |-- log\n|   |-- relaylog\n|   |-- run\n|   `-- tmp\n</code></pre><p>å…¶ä¸­dataæ˜¯æŒ‚è½½ç‚¹ï¼ŒæŠŠæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°/dataã€‚æ¯ä¸ªå®ä¾‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œéƒ½æ”¾åœ¨åŒä¸€ä¸ªé¡¶å±‚ç›®å½•ä¸­ï¼Œä»¥ <code>mysql{$PORT}</code> çš„æ–¹å¼å‘½åã€‚dataç›®å½•ç”¨æ¥å­˜æ”¾æ•°æ®åº“çš„æ•°æ®æ–‡ä»¶ã€‚binlogå’Œrelaylogç›®å½•åˆ†åˆ«ç”¨æ¥å­˜æ”¾binlogå’Œrelaylogã€‚logç›®å½•å­˜æ”¾æ—¥å¿—æ–‡ä»¶ï¼ŒåŒ…æ‹¬é”™è¯¯æ—¥å¿—ã€æ…¢SQLæ—¥å¿—ã€‚runç›®å½•å­˜æ”¾pidæ–‡ä»¶å’Œsockæ–‡ä»¶ã€‚tmpç›®å½•ç”¨æ¥å­˜æ”¾MySQLè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šäº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶my.cnfå­˜æ”¾åˆ°å®ä¾‹çš„é¡¶å±‚ç›®å½•ä¸­ã€‚</p><p>åœ¨è¿™ä¸ªç›®å½•è§„åˆ’ä¸‹ï¼Œä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">## /data/mysql3306/my.cnf\n[mysql]\nsocket=/data/mysql3306/run/mysql.sock\n\n\n[mysqld]\nport=3306\nmysqlx_port=33060\n\nbasedir=/opt/mysql80\nlc_messages_dir=/opt/mysql80/share\n\ndatadir=/data/mysql3306/data\ntmpdir=/data/mysql3306/tmp\nlog-error=/data/mysql3306/log/alert.log\nslow_query_log_file=/data/mysql3306/log/slow.log\ngeneral_log_file=/data/mysql3306/log/general.log\nsocket=/data/mysql3306/run/mysql.sock\n\n\ninnodb_data_file_path=ibdata1:128M:autoextend\ninnodb_buffer_pool_size=2G\n</code></pre><h3>ç¬¬å››æ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“</h3><p>ä½¿ç”¨mysqldåˆå§‹åŒ–æ•°æ®åº“ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯defaults-fileï¼ŒæŒ‡å‘ä¸Šä¸€æ­¥å‡†å¤‡å¥½çš„my.cnfé…ç½®æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯initializeï¼ŒæŒ‡ç¤ºmysqldè¿›è¡Œåˆå§‹åŒ–æ“ä½œã€‚</p><pre><code class=\"language-plain\"># /opt/mysql80/bin/mysqld --defaults-file=/data/mysql3306/my.cnf --initialize\n</code></pre><p>åˆå§‹åŒ–å¯èƒ½éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œå®Œæˆåä¼šåœ¨æ•°æ®ç›®å½•ï¼ˆdatadirï¼‰ä¸‹ç”Ÿæˆé»˜è®¤æ•°æ®åº“å’Œç›¸å…³çš„ç³»ç»Ÿè¡¨ã€‚</p><pre><code class=\"language-plain\"># tree -L 1 -u -h -F /data/mysql3306/data\n/data/mysql3306/data\n|-- [root     576K]  #ib_16384_0.dblwr\n|-- [root     8.6M]  #ib_16384_1.dblwr\n|-- [root     4.0K]  #innodb_redo/\n|-- [root     4.0K]  #innodb_temp/\n|-- [root       56]  auto.cnf\n|-- [root     1.7K]  ca-key.pem\n|-- [root     1.1K]  ca.pem\n|-- [root     1.1K]  client-cert.pem\n|-- [root     1.7K]  client-key.pem\n|-- [root     5.8K]  ib_buffer_pool\n|-- [root     128M]  ibdata1\n|-- [root     4.0K]  mysql/\n|-- [root      25M]  mysql.ibd\n|-- [root     4.0K]  performance_schema/\n|-- [root     1.7K]  private_key.pem\n|-- [root      452]  public_key.pem\n|-- [root     1.1K]  server-cert.pem\n|-- [root     1.7K]  server-key.pem\n|-- [root     4.0K]  sys/\n|-- [root      16M]  undo_001\n`-- [root      16M]  undo_002\n</code></pre><p>å¦‚æœåˆå§‹åŒ–æ²¡æœ‰æˆåŠŸï¼Œéœ€è¦åˆ°é”™è¯¯æ—¥å¿—ä¸­æŸ¥çœ‹ç›¸å…³çš„æŠ¥é”™ä¿¡æ¯ï¼Œè¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚é”™è¯¯æ—¥å¿—çš„è·¯å¾„ç”±é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°log-erroræŒ‡å®šã€‚åˆå§‹åŒ–æˆåŠŸåï¼Œå¯ä»¥çœ‹åˆ°é”™è¯¯æ—¥å¿—çš„æœ€åä¸€è¡Œè¾“å‡ºçš„mysql rootè´¦å·çš„ä¸´æ—¶å¯†ç ï¼Œæˆ‘ä»¬è¦ç”¨è¿™ä¸ªå¯†ç æ¥ç™»å½•æ•°æ®åº“ã€‚</p><pre><code class=\"language-plain\"># tail -10 /data/mysql3306/log/alert.log\n2024-06-24T01:56:48.849579Z 0 [System] [MY-013169] [Server] /opt/mysql80/bin/mysqld (mysqld 8.0.39) initializing of server in progress as process 5352\n2024-06-24T01:56:48.863677Z 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started.\n2024-06-24T01:57:30.863543Z 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended.\n2024-06-24T01:57:55.476711Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: YB%OojGi85?L\n</code></pre><p>æ•°æ®åº“åˆå§‹åŒ–å®Œæˆåï¼Œå°±å¯ä»¥å¯åŠ¨äº†ï¼Œä¸è¿‡åœ¨å¯åŠ¨å‰ï¼Œè¿˜éœ€è¦åšä¸€ä»¶äº‹æƒ…ã€‚å¦‚æœåˆå§‹åŒ–æ•°æ®åº“æ—¶ä½¿ç”¨äº†Linuxçš„rootè´¦å·ï¼Œè¿˜éœ€è¦æŠŠmysqlç›®å½•ä¸‹çš„æ–‡ä»¶ownerä¿®æ”¹æˆmysqlã€‚</p><pre><code class=\"language-plain\">chown -R mysql:mysql /data/mysql3306/\n</code></pre><h3>ç¬¬äº”æ­¥ï¼šå¯åŠ¨æ•°æ®åº“æœåŠ¡</h3><p>æˆ‘ä»¬æœ‰å‡ ç§ä¸åŒçš„æ–¹å¼æ¥å¯åŠ¨MySQLæœåŠ¡ï¼Œä¸‹é¢çš„ä¾‹å­ä½¿ç”¨mysqld_safeè„šæœ¬æ¥å¯åŠ¨MySQLï¼Œä½¿ç”¨defaults-fileæŒ‡å®šå‚æ•°æ–‡ä»¶çš„è·¯å¾„ã€‚</p><pre><code class=\"language-plain\"># /opt/mysql80/bin/mysqld_safe --defaults-file=/data/mysql3306/my.cnf &amp;\n[1] 5569\n\n# mysqld_safe Logging to '/data/mysql3306/log/alert.log'.\nmysqld_safe Starting mysqld daemon with databases from /data/mysql3306/data\n</code></pre><p>å¦‚æœå¯åŠ¨å¤±è´¥ï¼Œéœ€è¦åˆ°é”™è¯¯æ—¥å¿—ä¸­æŸ¥çœ‹å…·ä½“çš„æŠ¥é”™ä¿¡æ¯ã€‚æ¯”è¾ƒå¸¸è§çš„é—®é¢˜æœ‰ç«¯å£å·²ç»è¢«å ç”¨äº†ï¼Œæˆ–è€…å‚æ•°æ–‡ä»¶ä¸­å‚æ•°åå†™é”™äº†ã€‚</p><pre><code class=\"language-plain\"># tail -10 /data/mysql3306/log/alert.log\n\n2024-06-24T02:17:43.215483Z 0 [ERROR] [MY-010262] [Server] Can't start server: Bind on TCP/IP port: Address already in use\n2024-06-24T02:17:43.215527Z 0 [ERROR] [MY-010257] [Server] Do you already have another mysqld server running on port: 3306 ?\n2024-06-24T02:17:43.215560Z 0 [ERROR] [MY-010119] [Server] Aborting\n2024-06-24T02:17:45.035093Z 0 [System] [MY-010910] [Server] /opt/mysql80/bin/mysqld: Shutdown complete (mysqld 8.0.39)  MySQL Community Server - GPL.\n</code></pre><p>MySQLæœåŠ¡å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥åœ¨é”™è¯¯æ—¥å¿—ä¸­çœ‹åˆ°â€œready for connectionsâ€çš„æ—¥å¿—ä¿¡æ¯ã€‚</p><pre><code class=\"language-plain\">[Server] /opt/mysql80/bin/mysqld: ready for connections. Version: '8.0.39'  socket: '/data/mysql3306/run/mysql.sock'  port: 3306  MySQL Community Server - GPL.\n</code></pre><h3>ç¬¬å…­æ­¥ï¼šè®¾ç½®æ•°æ®åº“åˆå§‹å¯†ç </h3><p>MySQLåœ¨æ•°æ®åº“åˆå§‹åŒ–æ—¶è®¾ç½®äº†ä¸€ä¸ªä¸´æ—¶å¯†ç ï¼Œå¯ä»¥åœ¨é”™è¯¯æ—¥å¿—ä¸­æ‰¾åˆ°ã€‚</p><pre><code class=\"language-plain\"># grep password /data/mysql3306/log/alert.log\n2024-06-24T01:57:55.476711Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: YB%OojGi85?L\n</code></pre><p>ä½¿ç”¨ä¸´æ—¶å¯†ç ç™»å½•æ•°æ®åº“åï¼Œæ‰§è¡ŒSQLä¼šæç¤ºè¦å…ˆä¿®æ”¹å¯†ç ã€‚</p><pre><code class=\"language-plain\"># mysql -uroot -h127.0.0.1 -p'YB%OojGi85?L'\n\nmysql&gt; select now();\nERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.\n</code></pre><p>ä½¿ç”¨alter userå‘½ä»¤ä¿®æ”¹mysql rootè´¦å·çš„å¯†ç åï¼Œå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨æ•°æ®åº“äº†ã€‚</p><pre><code class=\"language-plain\">mysql&gt; alter user 'root'@'localhost' identified by 'Abcd1234';\nQuery OK, 0 rows affected (1.45 sec)\n\nmysql&gt; select now();\n+---------------------+\n| now()               |\n+---------------------+\n| 2024-06-24 11:09:23 |\n+---------------------+\n1 row in set (0.00 sec)\n</code></pre><p>è¿™å°±æ˜¯ä½¿ç”¨äºŒè¿›åˆ¶æ–¹å¼å®‰è£…MySQLçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°è¿‡ç¨‹å¹¶ä¸å¤æ‚ã€‚ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…çš„ä¸»è¦ä¼˜ç‚¹å°±æ˜¯ä½ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°éƒ¨ç½²å¤šå®ä¾‹ï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨è¿è¡Œå¤šä¸ªç‰ˆæœ¬çš„MySQLï¼Œå¯ä»¥æ–¹ä¾¿åœ°è§„åˆ’ç£ç›˜è·¯å¾„ã€‚</p><h2>RPMå®‰è£…</h2><p>ä½¿ç”¨Linuxçš„åŒ…ç®¡ç†å™¨å®‰è£…MySQLä¹Ÿæ˜¯ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥CentOS 7.9ä¸ºä¾‹æ¥ç®€å•è¯´æ˜å®‰è£…è¿‡ç¨‹ã€‚</p><h3>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½RPMåŒ…</h3><p>é€‰æ‹©8.0å½“å‰çš„æœ€æ–°ç‰ˆæœ¬ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†CentOS 7.9ï¼Œæ“ä½œç³»ç»Ÿé€‰æ‹©â€œRed Hat Eenterrise Linux / Oracle Linuxâ€ï¼Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬é€‰æ‹©â€œRed Hat Enterprise Linux 7 / Oracle Linux 7ï¼ˆx86ï¼Œ64-bitï¼‰â€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f6/05/f698109b6126d98d4eyy45bc9f430005.png?wh=1786x1480\" alt=\"å›¾ç‰‡\"></p><p>ä¸‹è½½mysql-8.0.39-1.el7.x86_64.rpm-bundle.tarï¼Œé‡Œé¢åŒ…å«äº†å®‰è£…MySQLéœ€è¦çš„æ‰€æœ‰rpmåŒ…ã€‚</p><pre><code class=\"language-plain\">wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.39-1.el7.x86_64.rpm-bundle.tar\n</code></pre><p>ä¸‹è½½å®ŒæˆåéªŒè¯md5ï¼Œå¹¶è§£å‹ã€‚</p><pre><code class=\"language-plain\"># md5sum mysql-8.0.39-1.el7.x86_64.rpm-bundle.tar\n1f59378ee4a9b40791672eed61366f52  mysql-8.0.39-1.el7.x86_64.rpm-bundle.tar\n\n# tar xf mysql-8.0.39-1.el7.x86_64.rpm-bundle.tar\n</code></pre><h3>ç¬¬äºŒæ­¥ï¼šå¤„ç†æœ‰å†²çªçš„åŒ…</h3><p>å¦‚æœæœåŠ¡å™¨ä¸Šå·²ç»å®‰è£…äº†å…¶ä»–ç‰ˆæœ¬çš„MySQLæˆ–MariaDBçš„RPMåŒ…ï¼Œå°±æœ‰å¯èƒ½ä¼šå’Œå¾…å®‰è£…çš„RPMåŒ…å‘ç”Ÿå†²çªï¼Œéœ€è¦å…ˆæŠŠè¿™äº›RPMåŒ…å¸è½½æ‰ã€‚æ³¨æ„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒå¸è½½å·²ç»å®‰è£…çš„åŒ…å¯èƒ½ä¼šå¼•èµ·é—®é¢˜ï¼Œéœ€è¦åœ¨æœåŠ¡å™¨ä¸Šçº¿å‰å°±å¤„ç†å¥½è¿™äº›é—®é¢˜ã€‚</p><pre><code class=\"language-plain\"># rpm -qa | egrep -i 'mysql|mariadb'\nmariadb-libs-5.5.68-1.el7.x86_64\n\n# yum remove mariadb-libs\nResolving Dependencies\n......\n\nRemoved:\n  mariadb-libs.x86_64 1:5.5.68-1.el7\n\nDependency Removed:\n  postfix.x86_64 2:2.10.1-9.el7\n</code></pre><h3>ç¬¬ä¸‰æ­¥ï¼šå®‰è£…RPMåŒ…</h3><p>ä½¿ç”¨RPMå‘½ä»¤å®‰è£…RPMåŒ…ï¼ŒæŠŠserverã€clientä»¥åŠä¾èµ–çš„libåŒ…éƒ½å®‰è£…ä¸Šã€‚</p><pre><code class=\"language-plain\"># rpm -ivh mysql-community-libs-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-client-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-libs-compat-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-client-plugins-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-server-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-common-8.0.39-1.el7.x86_64.rpm \\\n  mysql-community-icu-data-files-8.0.39-1.el7.x86_64.rpm   \n\nwarning: mysql-community-libs-8.0.39-1.el7.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID a8d3785c: NOKEY\n  Preparing...                          ################################# [100%]\nUpdating / installing...\n   1:mysql-community-common-8.0.39-1.e################################# [ 14%]\n   2:mysql-community-client-plugins-8.################################# [ 29%]\n   3:mysql-community-libs-8.0.39-1.el7################################# [ 43%]\n   4:mysql-community-client-8.0.39-1.e################################# [ 57%]\n   5:mysql-community-icu-data-files-8.################################# [ 71%]\n   6:mysql-community-server-8.0.39-1.e################################# [ 86%]\n   7:mysql-community-libs-compat-8.0.3################################# [100%]\n</code></pre><h3>ç¬¬å››æ­¥ï¼šå¯åŠ¨MySQLæœåŠ¡</h3><p>RPMåŒ…å®‰è£…æˆåŠŸåï¼Œå°±å¯ä»¥ä½¿ç”¨serviceå‘½ä»¤å¯åŠ¨MySQLæœåŠ¡äº†ã€‚</p><pre><code class=\"language-plain\"># service mysqld start\nRedirecting to /bin/systemctl start mysqld.service\n</code></pre><p>ä½¿ç”¨RPMå®‰è£…çš„MySQLï¼Œé»˜è®¤çš„é”™è¯¯æ—¥å¿—æ–‡ä»¶è·¯å¾„ä¸º/var/log/mysqld.logã€‚å¦‚æœæ— æ³•æ­£å¸¸å¯åŠ¨MySQLæœåŠ¡ï¼Œå¯ä»¥åˆ°é”™è¯¯æ—¥å¿—ä¸­æŸ¥çœ‹ç›¸å…³æŠ¥é”™ä¿¡æ¯ã€‚</p><pre><code class=\"language-plain\"># tail -100 /var/log/mysqld.log\n......\n2024-06-24T04:34:12.995336Z 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: '8.0.39'  socket: '/var/lib/mysql/mysql.sock'  port: 3306  MySQL Community Server - GPL.\n2024-06-24T04:34:12.995347Z 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: '::' port: 33060, socket: /var/run/mysqld/mysqlx.sock\n</code></pre><h3>ç¬¬äº”æ­¥ï¼šä¿®æ”¹æ•°æ®åº“é»˜è®¤å¯†ç </h3><p>å’ŒäºŒè¿›åˆ¶å®‰è£…ä¸€æ ·ï¼Œä½¿ç”¨RPMå®‰è£…çš„MySQLï¼Œç¬¬ä¸€æ¬¡è®¿é—®æ—¶ï¼Œä¹Ÿéœ€è¦å…ˆä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤å¯†ç ã€‚å…ˆä»é”™è¯¯æ—¥å¿—ä¸­æ‰¾åˆ°ä¸´æ—¶å¯†ç ã€‚</p><pre><code class=\"language-plain\"># grep password /var/log/mysqld.log\n2024-06-24T03:56:57.469312Z 6 [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: ,6R&amp;fqlf/5TS\n</code></pre><p>å†ä½¿ç”¨ä¸´æ—¶å¯†ç ç™»å½•æ•°æ®åº“ï¼Œæ‰§è¡Œalter userå‘½ä»¤ä¿®æ”¹å¯†ç ã€‚å¯†ç ä¿®æ”¹åï¼Œæ•°æ®åº“å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚</p><pre><code class=\"language-plain\"># mysql -uroot -h 127.0.0.1 -p',6R&amp;fqlf/5TS'\n\nmysql&gt; select 1;\nERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.\n\nmysql&gt; alter user 'root'@'localhost' identified by 'Abcd1234';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n\nmysql&gt; alter user 'root'@'localhost' identified by 'ComplexPassword2024$';\nQuery OK, 0 rows affected (0.45 sec)\n\nmysql&gt; select 1;\n+---+\n| 1 |\n+---+\n| 1 |\n+---+\n1 row in set (0.00 sec)\n</code></pre><p>æ³¨æ„ï¼Œä½¿ç”¨RPMåŒ…å®‰è£…çš„MySQLï¼Œå¢åŠ äº†æ•°æ®åº“è´¦å·å¯†ç å¼ºåº¦çš„éªŒè¯ã€‚</p><h3>äºŒè¿›åˆ¶å®‰è£…å’ŒRPMå®‰è£…çš„åŒºåˆ«</h3><p>æˆ‘ä»¬æ¥å¯¹æ¯”ä¸‹äºŒè¿›åˆ¶å®‰è£…å’ŒRPMåŒ…å®‰è£…è¿™ä¸¤ç§å®‰è£…æ–¹å¼çš„ä¸»è¦åŒºåˆ«ã€‚</p><p>ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšæ›´å¤šçš„å‡†å¤‡å·¥ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºMySQLæ“ä½œç³»ç»Ÿè´¦å·ã€åˆ›å»ºæ•°æ®åº“ç›¸å…³ç›®å½•ã€å‡†å¤‡å‚æ•°æ–‡ä»¶ã€‚è€Œä½¿ç”¨RPMåŒ…å®‰è£…æ—¶ï¼Œè‡ªåŠ¨åŒ…å«äº†è¿™äº›åˆå§‹åŒ–åŠ¨ä½œã€‚</p><p>ä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºåˆå§‹åŒ–æ•°æ®åº“ã€‚è€Œä½¿ç”¨RPMå®‰è£…çš„MySQLï¼ŒæŠŠåˆå§‹åŒ–æ•°æ®åº“çš„æ“ä½œæ”¾åˆ°äº†serviceçš„å¯åŠ¨è„šæœ¬ä¸­ã€‚</p><pre><code class=\"language-plain\"># more /usr/lib/systemd/system/mysqld.service\n\n[Service]\nUser=mysql\nGroup=mysql\n......\n# Needed to create system tables\nExecStartPre=/usr/bin/mysqld_pre_systemd\n\n# Start main service\nExecStart=/usr/sbin/mysqld $MYSQLD_OPTS\n</code></pre><p>æ‰§è¡Œservice start mysqlå‘½ä»¤å¯åŠ¨MySQLæœåŠ¡æ—¶ï¼Œè„šæœ¬mysqld_pre_systemdä¼šæ£€æŸ¥æ•°æ®ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ•°æ®ç›®å½•è¿˜æ²¡æœ‰åˆ›å»ºï¼Œå°±ä¼šåˆ›å»ºç›®å½•ï¼Œå¹¶æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–ã€‚å¹¶ä¸”mysqld_pre_systemdåœ¨åˆå§‹åŒ–æ•°æ®åº“æ—¶ï¼Œè¿˜æ‰§è¡Œäº†ä¸‹é¢è¿™ä¸ªSQLï¼Œå¯ç”¨äº†å¯†ç éªŒè¯ç»„ä»¶ã€‚</p><pre><code class=\"language-plain\">INSERT INTO mysql.component (component_id, component_group_id, component_urn) VALUES (1, 1, 'file://component_validate_password');\n</code></pre><p>å¯ç”¨å¯†ç éªŒè¯ç»„ä»¶åï¼Œåœ¨MySQLä¸­åˆ›å»ºè´¦å·æˆ–ä¿®æ”¹è´¦å·å¯†ç æ—¶ï¼Œéœ€è¦ä½¿ç”¨æœ‰ä¸€å®šå¤æ‚åº¦çš„å¯†ç ã€‚</p><p>äºŒè¿›åˆ¶å®‰è£…æ—¶ï¼ŒMySQLç¨‹åºå®‰è£…åœ¨ä¸€ä¸ªç»Ÿä¸€çš„ç›®å½•ä¸­ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„/opt/mysql80ã€‚è€Œä½¿ç”¨RPMå®‰è£…æ—¶ï¼Œå°†MySQLç¨‹åºå®‰è£…åœ¨ä¸åŒçš„è·¯å¾„ä¸‹ã€‚mysqldå®‰è£…åœ¨/usr/sbinè·¯å¾„ä¸‹ï¼Œå…¶å®ƒç¨‹åºå®‰è£…åœ¨/usr/binè·¯å¾„ä¸‹ï¼Œåº“æ–‡ä»¶å®‰è£…åœ¨/usr/lib64/mysqlä¸‹ï¼Œå­—ç¬¦é›†ç­‰ç›¸å…³æ”¯æŒæ–‡ä»¶æ”¾åœ¨/usr/share/mysql-8.0è·¯å¾„ä¸‹ã€‚</p><p>äºŒè¿›åˆ¶å®‰è£…æ—¶ï¼Œæˆ‘ä»¬æŠŠå‚æ•°æ–‡ä»¶ã€æ•°æ®ç›®å½•å’Œå…¶ä»–è¿è¡ŒMySQLçš„æ–‡ä»¶éƒ½æ”¾åˆ°äº† /data/mysql{$PORT} è·¯å¾„ä¸‹ï¼Œè€ŒRPMå®‰è£…æ—¶ï¼Œmy.cnfé»˜è®¤æ”¾åˆ°/etcï¼Œæ•°æ®ç›®å½•æ”¾åˆ°/var/lib/mysqlï¼Œé”™è¯¯æ—¥å¿—ä½¿ç”¨äº†/var/log/mysqld.logã€‚</p><p>å¦‚æœä½ æœ‰å•æœºå¤šå®ä¾‹ï¼Œæˆ–è€…åœ¨å•å°æœåŠ¡å™¨ä¸Šè¿è¡Œå¤šä¸ªMySQLç‰ˆæœ¬çš„éœ€æ±‚ï¼Œä½¿ç”¨äºŒè¿›åˆ¶å®‰è£…æ›´æ–¹ä¾¿ã€‚</p><h2>æºç ç¼–è¯‘å®‰è£…</h2><p>é€šå¸¸æˆ‘ä»¬ä¼šé€‰æ‹©ä½¿ç”¨å®˜æ–¹æä¾›çš„äºŒè¿›åˆ¶ç‰ˆæœ¬æ¥éƒ¨ç½²MySQLï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šé‡‡ç”¨æºç ç¼–è¯‘çš„æ–¹å¼ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€äº›ä¿¡åˆ›ç¯å¢ƒä¸‹ï¼Œå®˜æ–¹å¯èƒ½æ²¡æœ‰æä¾›ç›®æ ‡ç³»ç»Ÿçš„äºŒè¿›åˆ¶å®‰è£…åŒ…ã€‚æˆ–è€…æˆ‘ä»¬éœ€è¦å®‰è£…ä¸€äº›éæ ‡å‡†ç‰ˆæœ¬çš„MySQLï¼Œå¯èƒ½éœ€è¦å®‰è£…ä¸€äº›ç¤¾åŒºçš„patchã€bugfixã€æ‰©å±•æ’ä»¶ã€‚æˆ–è€…æƒ³ä½¿ç”¨å…¶ä»–ç¼–è¯‘å™¨æˆ–ç¼–è¯‘é€‰é¡¹æ¥ç¼–è¯‘MySQLï¼Œæ¯”å¦‚ä½¿ç”¨Intelçš„Cç¼–è¯‘å™¨ã€‚æˆ–è€…å‡ºäºå­¦ä¹ çš„ç›®çš„ç¼–è¯‘Debugç‰ˆæœ¬çš„MySQLï¼Œç”¨æ¥è°ƒè¯•ä¸€äº›åŠŸèƒ½ã€‚</p><h3>ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡buildç¯å¢ƒ</h3><p>ç¼–è¯‘MySQLæœ¬èº«ä¸å¤æ‚ï¼Œä¸è¿‡éœ€è¦å…ˆå‡†å¤‡å¥½ä¸€ä¸ªç¼–è¯‘ç¯å¢ƒã€‚ç¼–è¯‘MySQL 8.0éœ€è¦ä»¥ä¸‹å‡ ä¸ªåŸºæœ¬å·¥å…·ã€‚</p><ul>\n<li>cmake3</li>\n<li>binutils</li>\n<li>gcc 7.1ä»¥ä¸Šç‰ˆæœ¬</li>\n<li>openssl</li>\n<li>ncurse</li>\n</ul><p>CentOS 7.9é»˜è®¤çš„GCCç‰ˆæœ¬å¤ªè€äº†ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„GCCã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„Linuxå‘è¡Œç‰ˆæœ¬ã€‚</p><p>å®‰è£…cmake3ã€‚</p><pre><code class=\"language-plain\">yum install cmake3\n</code></pre><p>å®‰è£…GCCã€‚</p><pre><code class=\"language-plain\">yum install centos-release-scl\nyum install devtoolset-11-gcc devtoolset-11-gcc-c++ devtoolset-11-binutils\n</code></pre><p>å®‰è£…å…¶å®ƒä¾èµ–åº“ã€‚</p><pre><code class=\"language-plain\">yum install -y ncurses-devel openssl openssl-devel\n</code></pre><h3>ç¬¬äºŒæ­¥ï¼šä¸‹è½½æºç </h3><p>åœ¨MySQLçš„ä¸‹è½½é¡µé¢ï¼Œæ“ä½œç³»ç»Ÿé€‰æ‹©â€œSource Codeâ€ï¼Œæ“ä½œç³»ç»Ÿç‰ˆæœ¬é€‰æ‹©â€œAll operating Systems (Generic) (Architecture Independent)â€ã€‚é€‰æ‹©å¸¦C++ booståº“çš„æºç åŒ…ï¼Œç¼–è¯‘MySQLæ—¶éœ€è¦è¿™äº›ä»£ç ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/88/7d/88d5c13af7614a0ec164b77a1bf7c87d.png?wh=1752x1006\" alt=\"å›¾ç‰‡\"></p><p>æºç ä¸‹è½½åï¼Œå…ˆéªŒè¯ä¸€ä¸‹æ–‡ä»¶æ ¡éªŒç ï¼Œç¡®è®¤æ²¡é—®é¢˜åå†è§£å‹æ–‡ä»¶ã€‚</p><pre><code class=\"language-plain\"># wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-boost-8.0.39.tar.gz\n\n# md5sum mysql-boost-8.0.39.tar.gz\n07ee1d23908fc4ad7fc6a5cb8f2c99de  mysql-boost-8.0.39.tar.gz\n\n# tar zxf mysql-boost-8.0.39.tar.gz\n\n# tree -d -L 1 mysql-8.0.39\nmysql-8.0.39\n|-- archive_output_directory\n|-- bin -&gt; ./runtime_output_directory\n|-- boost\n|-- client\n|-- cmake\n|-- CMakeFiles\n|-- components\n|-- Docs\n......\n</code></pre><h3>ç¬¬ä¸‰æ­¥ï¼šæ„å»ºMySQLäºŒè¿›åˆ¶</h3><p>è¿›å…¥æºç ç›®å½•ï¼Œè¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºä½¿ç”¨cmake3æ¥æ„å»ºä¸€ä¸ªDebugç‰ˆæœ¬çš„MySQLã€‚å¦‚æœæ‰§è¡ŒcmakeæŠ¥é”™ï¼Œéœ€è¦æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¹¶åšç›¸åº”çš„å¤„ç†ã€‚</p><pre><code class=\"language-plain\"># cd mysql-8.0.39\n# cmake3  -DWITH_DEBUG=ON \\\n    -DWITH_BOOST=boost/boost_1_77_0 \\\n    -DCMAKE_INSTALL_PREFIX=/usr/local/mysql8.0\n</code></pre><p>æ„å»ºMySQLæœ‰å¾ˆå¤šé€‰é¡¹ï¼Œè¿™é‡Œæˆ‘ä»‹ç»å…¶ä¸­æœ€åŸºç¡€çš„å‡ ä¸ªé€‰é¡¹ï¼Œå®Œæ•´çš„é€‰é¡¹ä½ å¯ä»¥åˆ°<a href=\"https://dev.mysql.com/doc/refman/8.0/en/source-configuration-options.html\">å®˜æ–¹æ–‡æ¡£</a>ä¸­æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a9/7e/a9abf3b4ffba0d1ebd1e6a54ccdbf07e.jpg?wh=1920x787\" alt=\"å›¾ç‰‡\"></p><p>cmakeæˆåŠŸåï¼Œä½¿ç”¨makeå‘½ä»¤æ„å»ºMySQLï¼Œä½¿ç”¨å‚æ•° -j æŒ‡å®šç¼–è¯‘çš„å¹¶å‘æ•°ï¼Œå¯ä»¥æ ¹æ®æœºå™¨çš„é…ç½®é€‰æ‹©åˆé€‚çš„å¹¶å‘æ•°ï¼Œä»¥åŠ å¿«æ„å»ºçš„é€Ÿåº¦ã€‚</p><pre><code class=\"language-plain\">make -j 4\n</code></pre><h3>ç¬¬å››æ­¥ï¼šå®‰è£…äºŒè¿›åˆ¶</h3><p>æ„å»ºæˆåŠŸåï¼Œä½¿ç”¨make installå‘½ä»¤å°†MySQLå®‰è£…åˆ°CMAKE_INSTALL_PREFIXæŒ‡å®šçš„è·¯å¾„ä¸‹ã€‚</p><pre><code class=\"language-plain\">make install\n</code></pre><p>æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒMySQLå®‰è£…åˆ°äº†/usr/local/mysql8.0ä¸‹ã€‚</p><pre><code class=\"language-plain\"># tree -L 1 /usr/local/mysql8.0/\n/usr/local/mysql8.0/\nâ”œâ”€â”€ bin\nâ”œâ”€â”€ docs\nâ”œâ”€â”€ include\nâ”œâ”€â”€ lib\nâ”œâ”€â”€ LICENSE\nâ”œâ”€â”€ mysql-test\nâ”œâ”€â”€ README\nâ””â”€â”€ share\n</code></pre><p>æˆ‘ä»¬æ„å»ºå‡ºæ¥çš„mysqldå ç”¨çš„ç©ºé—´æ¯”è¾ƒå¤§ï¼Œå¦‚æœè¦ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨stripå‘½ä»¤å¯¹å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œè£å‰ªï¼Œå»æ‰äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ä¸€äº›ç¬¦å·å’Œè°ƒè¯•ä¿¡æ¯ã€‚</p><pre><code class=\"language-plain\"># ls -lSh bin\ntotal 1.2G\n-rwxr-xr-x 1 root root 707M Jun 24 18:26 mysqld\n-rwxr-xr-x 1 root root  39M Jun 24 17:47 mysqlxtest\n-rwxr-xr-x 1 root root  22M Jun 24 17:39 mysqlpump\n-rwxr-xr-x 1 root root  21M Jun 24 17:39 mysqlbinlog\n......\n\n### ä½¿ç”¨stripå‡å°‘æ–‡ä»¶å¤§å°\n# strip mysqld\n\n# ls -lSh\ntotal 565M\n-rwxr-xr-x 1 root root 128M Jun 25 10:32 mysqld\n-rwxr-xr-x 1 root root  39M Jun 24 17:47 mysqlxtest\n-rwxr-xr-x 1 root root  22M Jun 24 17:39 mysqlpump\n-rwxr-xr-x 1 root root  21M Jun 24 17:39 mysqlbinlog\n</code></pre><p>äºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…å®Œæˆåï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤å’Œâ€œäºŒè¿›åˆ¶å®‰è£…â€ä¸­çš„æ­¥éª¤æ²¡æœ‰åŒºåˆ«ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†ã€‚</p><h2>æ€»ç»“æ—¶åˆ»</h2><p>è¿™ä¸€è®²æˆ‘ä»¬å­¦ä¹ äº†åœ¨Linuxæ“ä½œç³»ç»Ÿä¸‹å®‰è£…MySQLçš„å‡ ç§æ–¹æ³•ã€‚å¦‚æœä½ éœ€è¦å®‰è£…éƒ¨ç½²å¤§é‡MySQLæœåŠ¡å™¨ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¨èä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼å®‰è£…ã€‚ä½ éœ€è¦åˆ¶å®šä¸€ä¸ªæ ‡å‡†è§„èŒƒï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶å®‰è£…è·¯å¾„ã€æ•°æ®æ–‡ä»¶å­˜æ”¾è·¯å¾„ã€æœåŠ¡å™¨å’Œæ•°æ®åº“çš„æ ‡å‡†å‚æ•°é…ç½®ç­‰ï¼Œå¹¶ä¸”æŒ‰è¿™ä¸ªæ ‡å‡†æ¥éƒ¨ç½²æ‰€æœ‰çš„MySQLç¯å¢ƒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/59/35/5942c16529e4c2c80ef31b2207bcd035.jpg?wh=1432x1470\" alt=\"å›¾ç‰‡\"></p><h2>æ€è€ƒé¢˜</h2><p>æ—©æœŸçš„ç‰ˆæœ¬ä¸­ï¼Œç™»å½•æœåŠ¡å™¨æœ¬åœ°çš„MySQLé»˜è®¤ä¸éœ€è¦å¯†ç ã€‚è¿™å­˜åœ¨ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œå› ä¸ºä½ åªè¦èƒ½ç™»å½•åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼Œå°±èƒ½è®¿é—®è¿™å°æœåŠ¡å™¨ä¸Šçš„MySQLæ•°æ®åº“ã€‚ä»5.7ç‰ˆæœ¬å¼€å§‹ï¼Œç»™æ•°æ®åº“çš„rootè´¦å·è®¾ç½®äº†é»˜è®¤å¯†ç ï¼Œé¦–æ¬¡ç™»å½•æ—¶éœ€è¦å…ˆä¿®æ”¹å¯†ç ã€‚åœ¨éƒ¨ç½²ä¸€å¥—MySQLæ•°æ®åº“ç¯å¢ƒæ—¶ï¼Œå°æ˜æŒ‰è§„èŒƒä¿®æ”¹äº†æ•°æ®åº“rootè´¦å·çš„å¯†ç ï¼Œä½†æ˜¯å½“æ—¶å¿˜äº†å°†rootå¯†ç è®°å½•ä¸‹æ¥ï¼Œå› æ­¤å°æ˜å‘ä½ å¯»æ±‚å¸®åŠ©ã€‚ä½ æœ‰åŠæ³•å¸®å°æ˜è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠä½ çš„ç­”æ¡ˆåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œå¦‚æœä½ è§‰å¾—è¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿ä½ åˆ†äº«ç»™å…¶ä»–æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":393522,"user_name":"é£’é£’ç§‹é£","can_delete":false,"product_type":"c1","uid":1073802,"ip_address":"æ±Ÿè‹","ucode":"4D19EF5D0F578D","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/8a/e1008aa0.jpg","comment_is_top":false,"comment_ctime":1724120128,"is_pvip":false,"replies":[{"id":142906,"content":"éå¸¸å¥½ï¼Œè¿™å°±æ˜¯mysqlå¿˜è®°rootå¯†ç åï¼Œæ•™ç§‘ä¹¦çº§çš„è§£å†³æ–¹æ³•ã€‚\n\nskip-networkingè¿™ä¸ªé€‰é¡¹ä¹Ÿå¾ˆé‡è¦ï¼Œ5.7æˆ–æ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ skip-networkingï¼Œä»»ä½•åœ°æ–¹éƒ½èƒ½ç™»é™†æ•°æ®åº“ï¼Œæ‰§è¡Œä»»ä½•æ“ä½œã€‚\n\nä¸è¿‡æ ¹æ®æˆ‘çš„æµ‹è¯•ï¼Œ8.0åœ¨å®‰å…¨æ€§æ–¹é¢åšäº†å¢å¼ºï¼Œå³ä½¿ä¸åŠ skip-networkingï¼Œä¹Ÿåªèƒ½é€šè¿‡sockæ–‡ä»¶è®¿é—®æ•°æ®åº“ã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724207481,"ip_address":"æµ™æ±Ÿ","comment_id":393522,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"ä¿®æ”¹rootè´¦å·å¯†ç ï¼š\nâ€¢ å…³é—­MySQLè¿›ç¨‹\nâ€¢ æ·»åŠ --skip-grant-tableså‚æ•°ï¼Œé‡å¯è¿›ç¨‹\n```bash\nbin&#47;mysqld_safe --defaults-file=my.cnf --skip-grant-tables --skip-networking &amp;\n```\nâ€¢ flush privilegesè§¦å‘åŠ è½½æƒé™è¡¨\nâ€¢ alter userä¿®æ”¹rootç”¨æˆ·å¯†ç \n```sql\nflush privileges;\nalter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;password&#39;;\n```","like_count":7,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649972,"discussion_content":"éå¸¸å¥½ï¼Œè¿™å°±æ˜¯mysqlå¿˜è®°rootå¯†ç åï¼Œæ•™ç§‘ä¹¦çº§çš„è§£å†³æ–¹æ³•ã€‚\n\nskip-networkingè¿™ä¸ªé€‰é¡¹ä¹Ÿå¾ˆé‡è¦ï¼Œ5.7æˆ–æ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ skip-networkingï¼Œä»»ä½•åœ°æ–¹éƒ½èƒ½ç™»é™†æ•°æ®åº“ï¼Œæ‰§è¡Œä»»ä½•æ“ä½œã€‚\n\nä¸è¿‡æ ¹æ®æˆ‘çš„æµ‹è¯•ï¼Œ8.0åœ¨å®‰å…¨æ€§æ–¹é¢åšäº†å¢å¼ºï¼Œå³ä½¿ä¸åŠ skip-networkingï¼Œä¹Ÿåªèƒ½é€šè¿‡sockæ–‡ä»¶è®¿é—®æ•°æ®åº“ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724207481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393960,"user_name":"ç¬™ é¸¢","can_delete":false,"product_type":"c1","uid":3951358,"ip_address":"ä¸Šæµ·","ucode":"477AF524212C6D","user_header":"https://static001.geekbang.org/account/avatar/00/3c/4a/fe/7b6bd101.jpg","comment_is_top":false,"comment_ctime":1725436750,"is_pvip":false,"replies":[{"id":143039,"content":"mysqld_safeå…¶å®æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯ç”¨æ¥å¯åŠ¨mysqldè¿›ç¨‹ã€‚mysqldè¿›ç¨‹æ‰æ˜¯çœŸæ­£çš„æ•°æ®åº“è¿›ç¨‹ã€‚\n\nmysqldè¿›ç¨‹crashæ—¶ï¼Œmysqld_safeè„šæœ¬ä¼šå°è¯•æ‹‰èµ·mysqldè¿›ç¨‹ã€‚\n\nä½†æ˜¯æ­£å¸¸å…³é—­mysqldï¼Œæ­£å¸¸kill mysqldè¿›ç¨‹æ—¶ï¼Œmysqld_safeè„šæœ¬å¹¶ä¸ä¼šæ‹‰èµ·mysqldï¼Œè€Œæ˜¯ä¼šé€€å‡ºã€‚ä½ å¯ä»¥æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725612789,"ip_address":"æµ™æ±Ÿ","comment_id":393960,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"äºŒè¿›åˆ¶å®‰è£…çš„mysqlï¼Œå…¶ä¸­mysqldå…ˆæ‰§è¡Œï¼Œmysql_safeæ˜¯åæ‰§è¡Œï¼Œä½†æ˜¯ps -ef æŸ¥çœ‹è¿›ç¨‹æ˜¯mysql_safeæ˜¯mysqldçš„çˆ¶è¿›ç¨‹,é‚£mysql_safeæ˜¯ä¼šç®¡ç†mysqldçš„è¿›ç¨‹ï¼ˆé‡æ–°æ‹‰ä¸€æ¬¡mysqldè¿›ç¨‹å—ï¼Ÿï¼‰ï¼Œmysql_safeå®˜ç½‘è¯´å‘ç”Ÿé”™è¯¯æ—¶é‡å¯æœåŠ¡å™¨ï¼Œé‚£å°±æ˜¯kill mysqldè¿›ç¨‹ï¼Œmysql_safeä¼šå®šæ—¶æ£€æµ‹ï¼Œç„¶åå‘ç°è¿›ç¨‹ä¸å­˜åœ¨é‡æ–°æ‹‰èµ·mysqldè¿›ç¨‹ï¼Ÿï¼Ÿ","like_count":1,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650784,"discussion_content":"mysqld_safeå…¶å®æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œä¸»è¦ä½œç”¨å°±æ˜¯ç”¨æ¥å¯åŠ¨mysqldè¿›ç¨‹ã€‚mysqldè¿›ç¨‹æ‰æ˜¯çœŸæ­£çš„æ•°æ®åº“è¿›ç¨‹ã€‚\n\nmysqldè¿›ç¨‹crashæ—¶ï¼Œmysqld_safeè„šæœ¬ä¼šå°è¯•æ‹‰èµ·mysqldè¿›ç¨‹ã€‚\n\nä½†æ˜¯æ­£å¸¸å…³é—­mysqldï¼Œæ­£å¸¸kill mysqldè¿›ç¨‹æ—¶ï¼Œmysqld_safeè„šæœ¬å¹¶ä¸ä¼šæ‹‰èµ·mysqldï¼Œè€Œæ˜¯ä¼šé€€å‡ºã€‚ä½ å¯ä»¥æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725612789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393889,"user_name":"vivitele","can_delete":false,"product_type":"c1","uid":2812108,"ip_address":"ç½—é©¬å°¼äºš","ucode":"325FD6305E0A18","user_header":"","comment_is_top":false,"comment_ctime":1725263681,"is_pvip":false,"replies":[{"id":143017,"content":"OSçš„å‚æ•°è®¾ç½®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¯é¢˜ã€‚ç®€å•æ¥è¯´ï¼Œæœ‰å‡ ç‚¹ï¼š\n1ã€é€‰æ‹©æ–°ä¸€ç‚¹çš„å†…æ ¸ç‰ˆæœ¬ã€‚æ–°çš„ç‰ˆæœ¬ç†è®ºä¸Šä¼šæœ‰æ›´å¥½çš„é»˜è®¤è®¾ç½®ï¼Œæ›´é€‚åˆæ–°çš„ç¡¬ä»¶æ¶æ„ã€‚\n2ã€å†…æ ¸å‚æ•°æ–¹é¢ï¼Œä¸€èˆ¬è¦æ³¨æ„ç½‘ç»œåè®®æ ˆã€VMç³»ç»Ÿã€æ–‡ä»¶ç³»ç»Ÿã€IOç³»ç»Ÿç­‰å‡ ä¸ªæ¨¡å—çš„å‚æ•°ã€‚\nä¸‹é¢è¿™äº›å‚æ•°åªæ˜¯ä¸€ä¸ªå¤§è‡´çš„å»ºè®®ã€‚éœ€è¦ç†è§£è¿™äº›å‚æ•°çš„ä½œç”¨ï¼Œå¹¶æ ¹æ®æƒ…å†µæ¥è°ƒæ•´ã€‚\n\nvm.min_free_kbytes   ç‰©ç†å†…å­˜çš„5%\nvm.swappiness          0\nnet.core.rmem_default 256K\nnet.core.rmem_max     4M\nnet.core.wmem_default  256K\nnet.core.wmem_max      4M\nnet.ipv4.tcp_rmem = 4k(min)  256K(default)  4M(max)\nnet.ipv4.tcp_wmem = 4k(min) 256K(default)  4M(max)\nnet.ipv4.tcp_tw_reuse        0\nnet.ipv4.tcp_tw_recycle(å¦‚æœ‰) 0\nfs.aio-max-nr  100ä¸‡\nfs.file-max    100ä¸‡\n\n3ã€æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨å¾—æ¯”è¾ƒå¤šçš„æ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬ext4, xfsã€‚\n     mountå‚æ•°å¯ä»¥è€ƒè™‘è®¾ç½® noatime,nodiratime,no-barriar\n4ã€IOè°ƒåº¦å™¨ï¼Œä¸€èˆ¬å»ºè®®è®¾ç½®ä¸ºdeadlineï¼ŒSSDä¹Ÿå¯ä»¥è€ƒè™‘ç”¨noop\n5ã€èµ„æºé™åˆ¶ï¼Œ\nmax open files 100ä¸‡\nmax user processes ä¸é™åˆ¶","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725330562,"ip_address":"æµ™æ±Ÿ","comment_id":393889,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è€å¸ˆï¼ŒOSçš„ä¸€äº›é…ç½®ä¼šå½±å“åˆ° MySQL çš„æ€§èƒ½å’Œç¨³å®šæ€§ï¼Œä½†å®˜æ–¹æ–‡æ¡£ä¸Šå¥½åƒæ²¡æœ‰å…³äºè¿™æ–¹é¢çš„è¯¦ç»†è¯´æ˜ã€‚å…³äºOSçš„è®¾ç½®ï¼Œè€å¸ˆæœ‰ä»€ä¹ˆå»ºè®®å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650605,"discussion_content":"OSçš„å‚æ•°è®¾ç½®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„è¯é¢˜ã€‚ç®€å•æ¥è¯´ï¼Œæœ‰å‡ ç‚¹ï¼š\n1ã€é€‰æ‹©æ–°ä¸€ç‚¹çš„å†…æ ¸ç‰ˆæœ¬ã€‚æ–°çš„ç‰ˆæœ¬ç†è®ºä¸Šä¼šæœ‰æ›´å¥½çš„é»˜è®¤è®¾ç½®ï¼Œæ›´é€‚åˆæ–°çš„ç¡¬ä»¶æ¶æ„ã€‚\n2ã€å†…æ ¸å‚æ•°æ–¹é¢ï¼Œä¸€èˆ¬è¦æ³¨æ„ç½‘ç»œåè®®æ ˆã€VMç³»ç»Ÿã€æ–‡ä»¶ç³»ç»Ÿã€IOç³»ç»Ÿç­‰å‡ ä¸ªæ¨¡å—çš„å‚æ•°ã€‚\nä¸‹é¢è¿™äº›å‚æ•°åªæ˜¯ä¸€ä¸ªå¤§è‡´çš„å»ºè®®ã€‚éœ€è¦ç†è§£è¿™äº›å‚æ•°çš„ä½œç”¨ï¼Œå¹¶æ ¹æ®æƒ…å†µæ¥è°ƒæ•´ã€‚\n\nvm.min_free_kbytes   ç‰©ç†å†…å­˜çš„5%\nvm.swappiness          0\nnet.core.rmem_default 256K\nnet.core.rmem_max     4M\nnet.core.wmem_default  256K\nnet.core.wmem_max      4M\nnet.ipv4.tcp_rmem = 4k(min)  256K(default)  4M(max)\nnet.ipv4.tcp_wmem = 4k(min) 256K(default)  4M(max)\nnet.ipv4.tcp_tw_reuse        0\nnet.ipv4.tcp_tw_recycle(å¦‚æœ‰) 0\nfs.aio-max-nr  100ä¸‡\nfs.file-max    100ä¸‡\n\n3ã€æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨å¾—æ¯”è¾ƒå¤šçš„æ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬ext4, xfsã€‚\n     mountå‚æ•°å¯ä»¥è€ƒè™‘è®¾ç½® noatime,nodiratime,no-barriar\n4ã€IOè°ƒåº¦å™¨ï¼Œä¸€èˆ¬å»ºè®®è®¾ç½®ä¸ºdeadlineï¼ŒSSDä¹Ÿå¯ä»¥è€ƒè™‘ç”¨noop\n5ã€èµ„æºé™åˆ¶ï¼Œ\nmax open files 100ä¸‡\nmax user processes ä¸é™åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725330562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393527,"user_name":"bery","can_delete":false,"product_type":"c1","uid":1052200,"ip_address":"å†…è’™å¤","ucode":"39790C3827DA53","user_header":"https://static001.geekbang.org/account/avatar/00/10/0e/28/6f54cc13.jpg","comment_is_top":false,"comment_ctime":1724126651,"is_pvip":false,"replies":[{"id":142897,"content":"è¿™ä¸ªé—®é¢˜æå¾—éå¸¸å¥½ã€‚CentOS 7 EOLåï¼Œæ“ä½œç³»ç»Ÿåº”è¯¥é€‰æ‹©ä»€ä¹ˆæ ·çš„å‘è¡Œç‰ˆæœ¬ï¼Œç¡®å®æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ã€‚\næˆ‘è¿™é‡Œä¸»è¦æ˜¯é€‰äº†ä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒï¼Œå°±è¿™èŠ‚è¯¾é‡Œçš„æ“ä½œå†…å®¹è€Œè¨€ï¼Œä¸åŒçš„å‘è¡Œç‰ˆæœ¬å½±å“ä¸æ˜¯å¤ªå¤§ã€‚ï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724146436,"ip_address":"æµ™æ±Ÿ","comment_id":393527,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æ“ä½œç³»ç»Ÿæ˜¯ä¸æœ‰ç‚¹æ—§äº†ï¼Œcentos 7å·²ç»åˆ°äº†EOL","like_count":1,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649922,"discussion_content":"è¿™ä¸ªé—®é¢˜æå¾—éå¸¸å¥½ã€‚CentOS 7 EOLåï¼Œæ“ä½œç³»ç»Ÿåº”è¯¥é€‰æ‹©ä»€ä¹ˆæ ·çš„å‘è¡Œç‰ˆæœ¬ï¼Œç¡®å®æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ã€‚\næˆ‘è¿™é‡Œä¸»è¦æ˜¯é€‰äº†ä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒï¼Œå°±è¿™èŠ‚è¯¾é‡Œçš„æ“ä½œå†…å®¹è€Œè¨€ï¼Œä¸åŒçš„å‘è¡Œç‰ˆæœ¬å½±å“ä¸æ˜¯å¤ªå¤§ã€‚ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724146436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395053,"user_name":"éª‘ç€ğŸš€çœ‹é“¶æ²³","can_delete":false,"product_type":"c1","uid":1074734,"ip_address":"æ—¥æœ¬","ucode":"8706A99A89F0CE","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/2e/527b73c9.jpg","comment_is_top":false,"comment_ctime":1729178600,"is_pvip":false,"replies":[{"id":143450,"content":"è¿™ä¸ªé—®é¢˜æ˜¯æ€ä¹ˆåœ¨å®¹å™¨ç¯å¢ƒä¸‹å®‰è£…MySQLå—ï¼Ÿ\n\nå¦‚æœç›´æ¥åœ¨dockerä¸­å®‰è£…ï¼Œé¦–å…ˆè¦æœ‰ä¸€ä¸ªMySQLçš„é•œåƒï¼Œä½ å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„é•œåƒï¼Œä¹Ÿå¯ä»¥å‚è€ƒå®˜æ–¹çš„docker fileï¼Œè‡ªå·±åšä¸€ä¸ªé•œåƒã€‚\n\nå¦‚æœè¦åœ¨K8Sä¸­è¿è¡ŒMySQLï¼Œè€Œä¸”è¦æ”¯æŒé«˜å¯ç”¨ã€å¤‡ä»½æ¢å¤ï¼Œä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨Operatorï¼Œä½ å¯ä»¥å‚è€ƒä¸‹Percona Operator for MySQLã€‚\n\nå›½å†…æœ‰å‡ å®¶å…¬å¸è¿˜åšäº†åŸºäºK8Sçš„æ•°æ®åº“äº‘å¹³å°ï¼Œå½“ç„¶è¿™äº›æ˜¯å•†ä¸šåŒ–çš„äº§å“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1729216964,"ip_address":"æµ™æ±Ÿ","comment_id":395053,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è€å¸ˆæ€ä¹ˆçœ‹åœ¨å®¹å™¨ç¯å¢ƒä¸‹å®‰è£… MySQL å‘¢","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":652590,"discussion_content":"è¿™ä¸ªé—®é¢˜æ˜¯æ€ä¹ˆåœ¨å®¹å™¨ç¯å¢ƒä¸‹å®‰è£…MySQLå—ï¼Ÿ\n\nå¦‚æœç›´æ¥åœ¨dockerä¸­å®‰è£…ï¼Œé¦–å…ˆè¦æœ‰ä¸€ä¸ªMySQLçš„é•œåƒï¼Œä½ å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„é•œåƒï¼Œä¹Ÿå¯ä»¥å‚è€ƒå®˜æ–¹çš„docker fileï¼Œè‡ªå·±åšä¸€ä¸ªé•œåƒã€‚\n\nå¦‚æœè¦åœ¨K8Sä¸­è¿è¡ŒMySQLï¼Œè€Œä¸”è¦æ”¯æŒé«˜å¯ç”¨ã€å¤‡ä»½æ¢å¤ï¼Œä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨Operatorï¼Œä½ å¯ä»¥å‚è€ƒä¸‹Percona Operator for MySQLã€‚\n\nå›½å†…æœ‰å‡ å®¶å…¬å¸è¿˜åšäº†åŸºäºK8Sçš„æ•°æ®åº“äº‘å¹³å°ï¼Œå½“ç„¶è¿™äº›æ˜¯å•†ä¸šåŒ–çš„äº§å“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1729216964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394624,"user_name":"å—æ–¹","can_delete":false,"product_type":"c1","uid":3967358,"ip_address":"æµ™æ±Ÿ","ucode":"28B340A0DCFAF5","user_header":"https://static001.geekbang.org/account/avatar/00/3c/89/7e/c3e7eb9d.jpg","comment_is_top":false,"comment_ctime":1727342089,"is_pvip":false,"replies":[{"id":143255,"content":"è¿™å¯èƒ½æ˜¯mysqlå®¢æˆ·ç«¯çš„ç‰ˆæœ¬å¤ªä½ï¼Œæ˜¯ä¸æ˜¯ç³»ç»Ÿä¸­è¿˜å®‰è£…äº†å…¶ä»–ç‰ˆæœ¬çš„mysqlï¼Ÿ\n\nå¯ä»¥é€šè¿‡which mysqlçœ‹ä¸€ä¸‹äºŒè¿›åˆ¶çš„è·¯å¾„ï¼Œæˆ–ä½¿ç”¨mysql --versionçœ‹ä¸€ä¸‹ç‰ˆæœ¬ã€‚\n\næˆ–è€…æŒ‡å®šmysqlçš„è·¯å¾„ï¼Œæ¯”å¦‚ï¼š\n&#47;opt&#47;mysql8.0&#47;bin&#47;mysql -uroot -h127.0.0.1 -p.....","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1727421568,"ip_address":"æµ™æ±Ÿ","comment_id":394624,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æˆ‘åœ¨å‘Šè­¦æ—¥å¿—é‡Œè·å–å¯†ç åï¼Œç¬¬ä¸€æ¬¡ç™»å½•ï¼Œé‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š\n[root@obocp log]# mysql -uroot -h127.0.0.1 -p&#39;Aqj3iE&gt;Rvdk3&#39;\nERROR 2059 (HY000): Authentication plugin &#39;caching_sha2_password&#39; cannot be loaded: &#47;usr&#47;lib64&#47;mysql&#47;plugin&#47;caching_sha2_password.so: cannot open shared object file: No such file or directory","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651780,"discussion_content":"è¿™å¯èƒ½æ˜¯mysqlå®¢æˆ·ç«¯çš„ç‰ˆæœ¬å¤ªä½ï¼Œæ˜¯ä¸æ˜¯ç³»ç»Ÿä¸­è¿˜å®‰è£…äº†å…¶ä»–ç‰ˆæœ¬çš„mysqlï¼Ÿ\n\nå¯ä»¥é€šè¿‡which mysqlçœ‹ä¸€ä¸‹äºŒè¿›åˆ¶çš„è·¯å¾„ï¼Œæˆ–ä½¿ç”¨mysql --versionçœ‹ä¸€ä¸‹ç‰ˆæœ¬ã€‚\n\næˆ–è€…æŒ‡å®šmysqlçš„è·¯å¾„ï¼Œæ¯”å¦‚ï¼š\n/opt/mysql8.0/bin/mysql -uroot -h127.0.0.1 -p.....","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1727421568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394046,"user_name":"æ— é™å¯èƒ½","can_delete":false,"product_type":"c1","uid":1007654,"ip_address":"åŒ—äº¬","ucode":"D3CE995904BF58","user_header":"https://static001.geekbang.org/account/avatar/00/0f/60/26/35ef9bef.jpg","comment_is_top":false,"comment_ctime":1725618430,"is_pvip":false,"replies":[{"id":143076,"content":"MySQL 8.0å¼€å§‹ï¼Œå®˜æ–¹ä¹Ÿæä¾›äº†Macä¸‹çš„å®‰è£…åŒ…ï¼Œdmgå’ŒäºŒè¿›åˆ¶åŒ…éƒ½å¯ä»¥ç”¨ã€‚\nä½¿ç”¨dockerå®‰è£…MySQLä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\nä¸€èˆ¬æ›´å»ºè®®ä½¿ç”¨Linuxæ“ä½œç³»ç»Ÿæ¥è¿è¡ŒMySQLï¼Œç”Ÿäº§ç¯å¢ƒä¸‹ç”¨Linuxçš„æ›´å¤šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725947346,"ip_address":"æµ™æ±Ÿ","comment_id":394046,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è¯·æ•™ä¸€ä¸‹ï¼Œå¯¹ç¯å¢ƒçš„è¦æ±‚ï¼Œç”¨Macç”µè„‘æ€ä¹ˆå®‰è£…ï¼Œç”¨Dockerå®‰è£…MySQLå¯ä»¥ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650958,"discussion_content":"MySQL 8.0å¼€å§‹ï¼Œå®˜æ–¹ä¹Ÿæä¾›äº†Macä¸‹çš„å®‰è£…åŒ…ï¼Œdmgå’ŒäºŒè¿›åˆ¶åŒ…éƒ½å¯ä»¥ç”¨ã€‚\nä½¿ç”¨dockerå®‰è£…MySQLä¹Ÿæ˜¯å¯ä»¥çš„ã€‚\nä¸€èˆ¬æ›´å»ºè®®ä½¿ç”¨Linuxæ“ä½œç³»ç»Ÿæ¥è¿è¡ŒMySQLï¼Œç”Ÿäº§ç¯å¢ƒä¸‹ç”¨Linuxçš„æ›´å¤šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725947347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393834,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1725011439,"is_pvip":false,"replies":[{"id":142998,"content":"é™¤äº†ä½¿ç”¨mysqladmin shutdownï¼Œå¦‚æœä½ ç™»é™†äº†MySQLï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤shutdownã€‚\n\nå¦‚æœä½¿ç”¨systemdæ¥ç®¡ç†mysqlæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨service æˆ– systemctlæ¥æ­£å¸¸å…³é—­mysqlï¼Œå¦‚systemctl stop mysqldã€‚\n\nè¿˜å¯ä»¥ä½¿ç”¨killå‘½ä»¤æ¥å…³é—­mysqlï¼Œæ³¨æ„æ˜¯kill, ä¸æ˜¯kill -9ã€‚\nä½ å¯ä»¥è§‚å¯Ÿä¸‹é”™è¯¯æ—¥å¿—ä¸­æ˜¯ä¸æ˜¯æœ‰ç±»ä¼¼çš„è¾“å‡ºï¼š [Server] Received SHUTDOWN from user &lt;via user signal&gt;. Shutting down mysqld (Version: 8.0.35).","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725073078,"ip_address":"æµ™æ±Ÿ","comment_id":393834,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æˆ‘çœ‹ https:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;8.4&#47;en&#47;programs-server.html é‡Œé¢æè¿°ï¼ŒæœåŠ¡å™¨çš„å¯åŠ¨æ–¹å¼æœ‰ mysqld,mysqld_safe,mysql.server,mysqld_multiã€‚\n\né™¤äº† mysqladmin shutdown å‘½ä»¤ä¹‹å¤–ï¼Œè¿˜æœ‰å“ªäº›æ–¹å¼å¯ä»¥æ­£å¸¸å…³é—­ mysql å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650474,"discussion_content":"é™¤äº†ä½¿ç”¨mysqladmin shutdownï¼Œå¦‚æœä½ ç™»é™†äº†MySQLï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤shutdownã€‚\n\nå¦‚æœä½¿ç”¨systemdæ¥ç®¡ç†mysqlæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨service æˆ– systemctlæ¥æ­£å¸¸å…³é—­mysqlï¼Œå¦‚systemctl stop mysqldã€‚\n\nè¿˜å¯ä»¥ä½¿ç”¨killå‘½ä»¤æ¥å…³é—­mysqlï¼Œæ³¨æ„æ˜¯kill, ä¸æ˜¯kill -9ã€‚\nä½ å¯ä»¥è§‚å¯Ÿä¸‹é”™è¯¯æ—¥å¿—ä¸­æ˜¯ä¸æ˜¯æœ‰ç±»ä¼¼çš„è¾“å‡ºï¼š [Server] Received SHUTDOWN from user &lt;via user signal&gt;. Shutting down mysqld (Version: 8.0.35).","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725073078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1369621,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e6/15/473b61e9.jpg","nickname":"SÃ¸ren Aabye Kierkegaard","note":"","ucode":"34163C06D539BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":652958,"discussion_content":"mysqld_multi stop  æˆ– mysqld_multi stop {name} åœ¨å•æœºå¤šå®ä¾‹ä¸‹ä¹Ÿå¯ä»¥æ­£å¸¸å…³é—­mysql","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1729933893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393797,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1724914415,"is_pvip":false,"replies":[{"id":142985,"content":"å®¢æˆ·ç«¯ä½¿ç”¨äº†é»˜è®¤çš„sockæ–‡ä»¶&#47;tmp&#47;mysql.sockæ¥è¿æ•°æ®åº“ï¼Œä½†å®é™…ä¸Šsockæ–‡ä»¶ä¸åœ¨&#47;tmpç›®å½•ä¸‹ã€‚\n\nè¯•ä¸€ä¸‹è¿™ä¹ˆè¿ï¼š\nmysql -u root -h 127.0.0.1 -p\n\næˆ–è€…è¿™ä¹ˆè¿ï¼š\nmysql -u root -S &#47;data&#47;var&#47;mysql&#47;mysql3306&#47;run&#47;mysql.sock -p","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724925902,"ip_address":"æµ™æ±Ÿ","comment_id":393797,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æˆ‘æœ‰ä¸ªç–‘é—®ï¼Œæˆ‘æ˜¯ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼å®‰è£…mysqlï¼ŒæŒ‰ç…§è€å¸ˆçš„æ­¥éª¤å®‰è£…çš„ï¼Œlog-error æ—¥å¿—ä¸­çš„è¾“å‡º:\n2024-08-29T06:35:22.874674Z 0 [System] [MY-010931] [Server] &#47;data&#47;opt&#47;mysql&#47;mysql84&#47;bin&#47;mysqld: ready for connections. Version: &#39;8.4.0&#39;  socket: &#39;&#47;data&#47;var&#47;mysql&#47;mysql3306&#47;run&#47;mysql.sock&#39;  port: 3306  MySQL Community Server - GPL.\n\næˆ‘ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤å¯ä»¥æ­£ç¡®è¿›å…¥å®¢æˆ·ç«¯:\n&#47;data&#47;opt&#47;mysql&#47;mysql84&#47;bin&#47;mysql -u root -h 127.0.0.1 -p&#39;Abcd1234&#39;\n\n\n\nä½†æ˜¯æˆ‘ç”¨ä¸‹é¢çš„å‘½ä»¤å°±ä¼šå‡ºç°é”™è¯¯:\n\nmysqluser@ubuntu000:~$ &#47;data&#47;opt&#47;mysql&#47;mysql84&#47;bin&#47;mysql -u root -h localhost -p&#39;Abcd1234&#39;\nmysql: [Warning] Using a password on the command line interface can be insecure.\nERROR 2002 (HY000): Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (2)\n\nmysqluser@ubuntu000:~$ &#47;data&#47;opt&#47;mysql&#47;mysql84&#47;bin&#47;mysql -u root -h localhost\nERROR 2002 (HY000): Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (2)\n\nè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650411,"discussion_content":"å®¢æˆ·ç«¯ä½¿ç”¨äº†é»˜è®¤çš„sockæ–‡ä»¶/tmp/mysql.sockæ¥è¿æ•°æ®åº“ï¼Œä½†å®é™…ä¸Šsockæ–‡ä»¶ä¸åœ¨/tmpç›®å½•ä¸‹ã€‚\n\nè¯•ä¸€ä¸‹è¿™ä¹ˆè¿ï¼š\nmysql -u root -h 127.0.0.1 -p\n\næˆ–è€…è¿™ä¹ˆè¿ï¼š\nmysql -u root -S /data/var/mysql/mysql3306/run/mysql.sock -p","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724925902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117793,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","nickname":"dream","note":"","ucode":"65B33D32FA8BE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650423,"discussion_content":"è¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724949061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393786,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1724899798,"is_pvip":false,"replies":[{"id":142983,"content":"æˆ‘ä¸‹è½½äº†ä¸€ä¸ª8.4çš„ä»£ç ï¼Œboostçš„ä»£ç å·²ç»åŒ…å«åœ¨é‡Œé¢äº†ï¼Œè·¯å¾„æ˜¯extra&#47;boostã€‚\n\n# ls extra&#47;boost&#47;\nboost_1_84_0\n\næŒ‰å®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼ŒMySQL 8.3å¼€å§‹ï¼Œå°±æŠŠboostä»£ç ä¸€èµ·æ‰“åŒ…åˆ°MySQLçš„æºç ä¸­äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724911068,"ip_address":"æµ™æ±Ÿ","comment_id":393786,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"æºç ä¸‹è½½çš„æ—¶å€™ï¼Œ8.4.0 ä»¥åçš„ç‰ˆæœ¬ï¼Œå°±æ²¡æœ‰ boost é€‰é¡¹äº†ï¼Œè¿™ä¸ªæ˜¯ mysql åšäº†ä»€ä¹ˆè°ƒæ•´å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650399,"discussion_content":"æˆ‘ä¸‹è½½äº†ä¸€ä¸ª8.4çš„ä»£ç ï¼Œboostçš„ä»£ç å·²ç»åŒ…å«åœ¨é‡Œé¢äº†ï¼Œè·¯å¾„æ˜¯extra/boostã€‚\n\n# ls extra/boost/\nboost_1_84_0\n\næŒ‰å®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼ŒMySQL 8.3å¼€å§‹ï¼Œå°±æŠŠboostä»£ç ä¸€èµ·æ‰“åŒ…åˆ°MySQLçš„æºç ä¸­äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724911068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393772,"user_name":"dream","can_delete":false,"product_type":"c1","uid":1117793,"ip_address":"é‡åº†","ucode":"65B33D32FA8BE9","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg","comment_is_top":false,"comment_ctime":1724831282,"is_pvip":false,"replies":[{"id":142976,"content":"æ²¡æœ‰å½±å“çš„ã€‚å°±æ˜¯rpmå®‰è£…é‚£ä¸€éƒ¨åˆ†ï¼Œè¦æ›¿æ¢æˆdebåŒ…ï¼Œç”¨dpkgå®‰è£…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724842514,"ip_address":"æµ™æ±Ÿ","comment_id":393772,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100799401,"comment_content":"æˆ‘æ˜¯ ubuntu ç³»ç»Ÿï¼Œå¯¹åç»­ç¤ºä¾‹æœ‰å½±å“å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650356,"discussion_content":"æ²¡æœ‰å½±å“çš„ã€‚å°±æ˜¯rpmå®‰è£…é‚£ä¸€éƒ¨åˆ†ï¼Œè¦æ›¿æ¢æˆdebåŒ…ï¼Œç”¨dpkgå®‰è£…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724842514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393679,"user_name":"æ©™æ±","can_delete":false,"product_type":"c1","uid":1332257,"ip_address":"åŒ—äº¬","ucode":"EC3FF10D708C9D","user_header":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","comment_is_top":false,"comment_ctime":1724559252,"is_pvip":false,"replies":[{"id":142962,"content":"å¯èƒ½æ˜¯ä¸€æ—¶å¤§æ„äº†å§ğŸ˜‚ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724724757,"ip_address":"æµ™æ±Ÿ","comment_id":393679,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100799401,"comment_content":"å°æ˜è¿™ä¸ªç¬¨è›‹ï¼Œä¸ºä»€ä¹ˆä¸è®°å¯†ç ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650286,"discussion_content":"å¯èƒ½æ˜¯ä¸€æ—¶å¤§æ„äº†å§ğŸ˜‚ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724724757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393634,"user_name":"Neo","can_delete":false,"product_type":"c1","uid":3952603,"ip_address":"æµ™æ±Ÿ","ucode":"D9228ED78E37E1","user_header":"https://static001.geekbang.org/account/avatar/00/3c/4f/db/ec7f62bc.jpg","comment_is_top":false,"comment_ctime":1724402786,"is_pvip":false,"replies":[{"id":142945,"content":"å¦‚æœ mysqlçš„glibcç‰ˆæœ¬æ¯”æ“ä½œç³»ç»Ÿçš„é«˜ï¼Œå¯èƒ½ä¼šè¿è¡Œä¸èµ·æ¥ï¼ŒæŠ¥â€œversion GLIBC_xxx not foundâ€è¿™æ ·çš„é”™è¯¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724546101,"ip_address":"æµ™æ±Ÿ","comment_id":393634,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100799401,"comment_content":"ä½¿ç”¨äºŒè¿›åˆ¶æ–¹å¼è¿›è¡Œå®‰è£…ï¼Œå®‰è£…çš„ç‰ˆæœ¬ä¸ç³»ç»Ÿçš„ glibc ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œä¼šæœ‰ä»€ä¹ˆå½±å“å—ï¼Ÿä¹‹å‰éƒ¨ç½²å®‰è£…5.7çš„ç‰ˆæœ¬ï¼Œè‡ªå·±å¥½åƒä»æœªå…³æ³¨è¿‡è¿™ä¸€å—å„¿","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650197,"discussion_content":"å¦‚æœ mysqlçš„glibcç‰ˆæœ¬æ¯”æ“ä½œç³»ç»Ÿçš„é«˜ï¼Œå¯èƒ½ä¼šè¿è¡Œä¸èµ·æ¥ï¼ŒæŠ¥â€œversion GLIBC_xxx not foundâ€è¿™æ ·çš„é”™è¯¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724546101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393528,"user_name":"binzhang","can_delete":false,"product_type":"c1","uid":1647189,"ip_address":"ç¾å›½","ucode":"F2670F2EA24FAD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM59PTNiaDASVicbVaeWBU1WKmOgyHcqVtl85nDwAqDicib1EUKE2RRoU0x0vZctZO4kbPDUTTke8qKfAw/132","comment_is_top":false,"comment_ctime":1724130501,"is_pvip":false,"replies":[{"id":142898,"content":"The Boost C++ libraries are required to build MySQL. MySQL compilation requires a particular Boost version. \n\næŒ‰æˆ‘çš„ç†è§£ï¼Œç¼–è¯‘MySQL 8æ˜¯ä¸€å®šè¦ç”¨booståº“çš„ï¼Œè€Œä¸”å¯¹ç‰ˆæœ¬ä¹Ÿæœ‰è¦æ±‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724147213,"ip_address":"æµ™æ±Ÿ","comment_id":393528,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100799401,"comment_content":"what&#39;s difference if mysql binary don&#39;t compile with boost library? ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649923,"discussion_content":"The Boost C++ libraries are required to build MySQL. MySQL compilation requires a particular Boost version. \n\næŒ‰æˆ‘çš„ç†è§£ï¼Œç¼–è¯‘MySQL 8æ˜¯ä¸€å®šè¦ç”¨booståº“çš„ï¼Œè€Œä¸”å¯¹ç‰ˆæœ¬ä¹Ÿæœ‰è¦æ±‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724147213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393514,"user_name":"èŠ¬è¾¾","can_delete":false,"product_type":"c1","uid":1275588,"ip_address":"å¹¿ä¸œ","ucode":"C5BE52E5717475","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/c4/a377fbdd.jpg","comment_is_top":false,"comment_ctime":1724079287,"is_pvip":false,"replies":[{"id":142896,"content":"ä¸»è¦æ˜¯æ–‡ç¨¿é‡Œçš„ä¾‹å­ä¸­ï¼Œæˆ‘åŠ ä¸Šäº†Debugé€‰é¡¹ WITH_DEBUG=ONã€‚Releaseç‰ˆæœ¬çš„äºŒè¿›åˆ¶è¦å°å¾ˆå¤šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724124155,"ip_address":"æµ™æ±Ÿ","comment_id":393514,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100799401,"comment_content":"strip mysqldè£å‰ªåä½“ç§¯è¿˜æ˜¯å¾ˆå¤§ï¼Œæ¯”å®˜æ–¹ç¼–è¯‘çš„è¦å¤§ã€‚è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› ï¼Œæ˜¯è€å¸ˆçš„ç¯å¢ƒåŒºåˆ«è¿˜æ˜¯åˆ«çš„åŸå› ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649901,"discussion_content":"ä¸»è¦æ˜¯æ–‡ç¨¿é‡Œçš„ä¾‹å­ä¸­ï¼Œæˆ‘åŠ ä¸Šäº†Debugé€‰é¡¹ WITH_DEBUG=ONã€‚Releaseç‰ˆæœ¬çš„äºŒè¿›åˆ¶è¦å°å¾ˆå¤šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724124155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"ç¾å¦™çš„ä»£ç ","note":"","ucode":"9DADD72C193296","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649888,"discussion_content":"å¯èƒ½ä¸ç¼–è¯‘å™¨æœ‰å…³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724116270,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}