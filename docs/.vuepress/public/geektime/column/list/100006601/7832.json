{"id":7832,"title":"12 | 架构设计流程：评估和选择备选方案","content":"<p>上一期我讲了设计备选方案，在完成备选方案设计后，如何挑选出最终的方案也是一个很大的挑战，主要原因有：</p>\n<ul>\n<li>\n<p>每个方案都是可行的，如果方案不可行就根本不应该作为备选方案。</p>\n</li>\n<li>\n<p>没有哪个方案是完美的。例如，A方案有性能的缺点，B方案有成本的缺点，C方案有新技术不成熟的风险。</p>\n</li>\n<li>\n<p>评价标准主观性比较强，比如设计师说A方案比B方案复杂，但另外一个设计师可能会认为差不多，因为比较难将“复杂”一词进行量化。因此，方案评审的时候我们经常会遇到几个设计师针对某个方案或者某个技术点争论得面红耳赤。</p>\n</li>\n</ul>\n<p>正因为选择备选方案存在这些困难，所以实践中很多设计师或者架构师就采取了下面几种指导思想：</p>\n<ul>\n<li>最简派</li>\n</ul>\n<p>设计师挑选一个看起来最简单的方案。例如，我们要做全文搜索功能，方案1基于MySQL，方案2基于Elasticsearch。MySQL的查询功能比较简单，而Elasticsearch的倒排索引设计要复杂得多，写入数据到Elasticsearch，要设计Elasticsearch的索引，要设计Elasticsearch的分布式……全套下来复杂度很高，所以干脆就挑选MySQL来做吧。</p>\n<ul>\n<li>最牛派</li>\n</ul>\n<p>最牛派的做法和最简派正好相反，设计师会倾向于挑选技术上看起来最牛的方案。例如，性能最高的、可用性最好的、功能最强大的，或者淘宝用的、微信开源的、Google出品的等。</p>\n<p>我们以缓存方案中的Memcache和Redis为例，假如我们要挑选一个搭配MySQL使用的缓存，Memcache是纯内存缓存，支持基于一致性hash的集群；而Redis同时支持持久化、支持数据字典、支持主备、支持集群，看起来比Memcache好很多啊，所以就选Redis好了。</p>\n<ul>\n<li>最熟派</li>\n</ul>\n<p>设计师基于自己的过往经验，挑选自己最熟悉的方案。我以编程语言为例，假如设计师曾经是一个C++经验丰富的开发人员，现在要设计一个运维管理系统，由于对Python或者Ruby on Rails不熟悉，因此继续选择C++来做运维管理系统。</p>\n<ul>\n<li>领导派</li>\n</ul>\n<p>领导派就更加聪明了，列出备选方案，设计师自己拿捏不定，然后就让领导来定夺，反正最后方案选的对那是领导厉害，方案选的不对怎么办？那也是领导“背锅”。</p>\n<p>其实这些不同的做法本身并不存在绝对的正确或者绝对的错误，关键是不同的场景应该采取不同的方式。也就是说，有时候我们要挑选最简单的方案，有时候要挑选最优秀的方案，有时候要挑选最熟悉的方案，甚至有时候真的要领导拍板。因此关键问题是：这里的“有时候”到底应该怎么判断？今天我就来讲讲<span class=\"orange\">架构设计流程的第3步：评估和选择备选方案。</span></p>\n<!-- [[[read_end]]] -->\n<h2>架构设计第3步：评估和选择备选方案</h2>\n<p>前面提到了那么多指导思想，真正应该选择哪种方法来评估和选择备选方案呢？我的答案就是“<strong>360度环评</strong>”！具体的操作方式为：<strong>列出我们需要关注的质量属性点，然后分别从这些质量属性的维度去评估每个方案，再综合挑选适合当时情况的最优方案</strong>。</p>\n<p>常见的方案质量属性点有：性能、可用性、硬件成本、项目投入、复杂度、安全性、可扩展性等。在评估这些质量属性时，需要遵循架构设计原则1“合适原则”和原则2“简单原则”，避免贪大求全，基本上某个质量属性能够满足一定时期内业务发展就可以了。</p>\n<p>假如我们做一个购物网站，现在的TPS是1000，如果我们预期1年内能够发展到TPS 2000（业务一年翻倍已经是很好的情况了），在评估方案的性能时，只要能超过2000的都是合适的方案，而不是说淘宝的网站TPS是每秒10万，我们的购物网站就要按照淘宝的标准也实现TPS 10万。</p>\n<p>有的设计师会有这样的担心：如果我们运气真的很好，业务直接一年翻了10倍，TPS从1000上升到10000，那岂不是按照TPS 2000做的方案不合适了，又要重新做方案？</p>\n<p>这种情况确实有可能存在，但概率很小，如果每次做方案都考虑这种小概率事件，我们的方案会出现过度设计，导致投入浪费。考虑这个问题的时候，需要遵循架构设计原则3“演化原则”，避免过度设计、一步到位的想法。按照原则3的思想，即使真的出现这种情况，那就算是重新做方案，代价也是可以接受的，因为业务如此迅猛发展，钱和人都不是问题。例如，淘宝和微信的发展历程中，有过多次这样大规模重构系统的经历。</p>\n<p>通常情况下，如果某个质量属性评估和业务发展有关系（例如，性能、硬件成本等），需要评估未来业务发展的规模时，一种简单的方式是将当前的业务规模乘以2 ~4即可，如果现在的基数较低，可以乘以4；如果现在基数较高，可以乘以2。例如，现在的TPS是1000，则按照TPS 4000来设计方案；如果现在TPS是10000，则按照TPS 20000来设计方案。</p>\n<p>当然，最理想的情况是设计一个方案，能够简单地扩容就能够跟上业务的发展。例如，我们设计一个方案，TPS 2000的时候只要2台机器，TPS 20000的时候只需要简单地将机器扩展到20台即可。但现实往往没那么理想，因为量变会引起质变，具体哪些地方质变，是很难提前很长时间能预判到的。举一个最简单的例子：一个开发团队5个人开发了一套系统，能够从TPS 2000平滑扩容到TPS 20000，但是当业务规模真的达到TPS 20000的时候，团队规模已经扩大到了20个人，此时系统发生了两个质变：</p>\n<ul>\n<li>\n<p>首先是团队规模扩大，20个人的团队在同一个系统上开发，开发效率变将很低，系统迭代速度很慢，经常出现某个功能开发完了要等另外的功能开发完成才能一起测试上线，此时如果要解决问题，就需要将系统拆分为更多子系统。</p>\n</li>\n<li>\n<p>其次是原来单机房的集群设计不满足业务需求了，需要升级为异地多活的架构。</p>\n</li>\n</ul>\n<p>如果团队一开始就预测到这两个问题，系统架构提前就拆分为多个子系统并且支持异地多活呢？这种“事后诸葛亮”也是不行的，因为最开始的时候团队只有5个人，5个人在有限的时间内要完成后来20个人才能完成的高性能、异地多活、可扩展的架构，项目时间会遥遥无期，业务很难等待那么长的时间。</p>\n<p>完成方案的360度环评后，我们可以基于评估结果整理出360度环评表，一目了然地看到各个方案的优劣点。但是360度环评表也只能帮助我们分析各个备选方案，还是没有告诉我们具体选哪个方案，原因就在于没有哪个方案是完美的，极少出现某个方案在所有对比维度上都是最优的。例如：引入开源方案工作量小，但是可运维性和可扩展性差；自研工作量大，但是可运维和可维护性好；使用C语言开发性能高，但是目前团队C语言技术积累少；使用Java技术积累多，但是性能没有C语言开发高，成本会高一些……诸如此类。</p>\n<p>面临这种选择上的困难，有几种看似正确但实际错误的做法。</p>\n<ul>\n<li>数量对比法：简单地看哪个方案的优点多就选哪个。例如，总共5个质量属性的对比，其中A方案占优的有3个，B方案占优的有2个，所以就挑选A方案。</li>\n</ul>\n<p>这种方案主要的问题在于把所有质量属性的重要性等同，而没有考虑质量属性的优先级。例如，对于BAT这类公司来说，方案的成本都不是问题，可用性和可扩展性比成本要更重要得多；但对于创业公司来说，成本可能就会变得很重要。</p>\n<p>其次，有时候会出现两个方案的优点数量是一样的情况。例如，我们对比6个质量属性，很可能出现两个方案各有3个优点，这种情况下也没法选；如果为了数量上的不对称，强行再增加一个质量属性进行对比，这个最后增加的不重要的属性反而成了影响方案选择的关键因素，这又犯了没有区分质量属性的优先级的问题。</p>\n<ul>\n<li>加权法：每个质量属性给一个权重。例如，性能的权重高中低分别得10分、5分、3分，成本权重高中低分别是5分、3分、1分，然后将每个方案的权重得分加起来，最后看哪个方案的权重得分最高就选哪个。</li>\n</ul>\n<p>这种方案主要的问题是无法客观地给出每个质量属性的权重得分。例如，性能权重得分为何是10分、5分、3分，而不是5分、3分、1分，或者是100分、80分、60分？这个分数是很难确定的，没有明确的标准，甚至会出现为了选某个方案，设计师故意将某些权重分值调高而降低另外一些权重分值，最后方案的选择就变成了一个数字游戏了。</p>\n<p>正确的做法是<strong>按优先级选择</strong>，即架构师综合当前的业务发展情况、团队人员规模和技能、业务发展预测等因素，将质量属性按照优先级排序，首先挑选满足第一优先级的，如果方案都满足，那就再看第二优先级……以此类推。那会不会出现两个或者多个方案，每个质量属性的优缺点都一样的情况呢？理论上是可能的，但实际上是不可能的。前面我提到，在做备选方案设计时，不同的备选方案之间的差异要比较明显，差异明显的备选方案不可能所有的优缺点都是一样的。</p>\n<h2>评估和选择备选方案实战</h2>\n<p>再回到我们设计的场景“前浪微博”。针对上期提出的3个备选方案，架构师组织了备选方案评审会议，参加的人有研发、测试、运维、还有几个核心业务的主管。</p>\n<p>1.备选方案1：采用开源Kafka方案</p>\n<ul>\n<li>\n<p>业务主管倾向于采用Kafka方案，因为Kafka已经比较成熟，各个业务团队或多或少都了解过Kafka。</p>\n</li>\n<li>\n<p>中间件团队部分研发人员也支持使用Kafka，因为使用Kafka能节省大量的开发投入；但部分人员认为Kafka可能并不适合我们的业务场景，因为Kafka的设计目的是为了支撑大容量的日志消息传输，而我们的消息队列是为了业务数据的可靠传输。</p>\n</li>\n<li>\n<p>运维代表提出了强烈的反对意见：首先，Kafka是Scala语言编写的，运维团队没有维护Scala语言开发的系统的经验，出问题后很难快速处理；其次，目前运维团队已经有一套成熟的运维体系，包括部署、监控、应急等，使用Kafka无法融入这套体系，需要单独投入运维人力。</p>\n</li>\n<li>\n<p>测试代表也倾向于引入Kafka，因为Kafka比较成熟，无须太多测试投入。</p>\n</li>\n</ul>\n<p>2.备选方案2：集群 + MySQL存储</p>\n<ul>\n<li>\n<p>中间件团队的研发人员认为这个方案比较简单，但部分研发人员对于这个方案的性能持怀疑态度，毕竟使用MySQL来存储消息数据，性能肯定不如使用文件系统；并且有的研发人员担心做这样的方案是否会影响中间件团队的技术声誉，毕竟用MySQL来做消息队列，看起来比较“土”、比较另类。</p>\n</li>\n<li>\n<p>运维代表赞同这个方案，因为这个方案可以融入到现有的运维体系中，而且使用MySQL存储数据，可靠性有保证，运维团队也有丰富的MySQL运维经验；但运维团队认为这个方案的成本比较高，一个数据分组就需要4台机器（2台服务器 + 2台数据库）。</p>\n</li>\n<li>\n<p>测试代表认为这个方案测试人力投入较大，包括功能测试、性能测试、可靠性测试等都需要大量地投入人力。</p>\n</li>\n<li>\n<p>业务主管对这个方案既不肯定也不否定，因为反正都不是业务团队来投入人力来开发，系统维护也是中间件团队负责，对业务团队来说，只要保证消息队列系统稳定和可靠即可。</p>\n</li>\n</ul>\n<p>3.备选方案3：集群 + 自研存储系统</p>\n<ul>\n<li>\n<p>中间件团队部分研发人员认为这是一个很好的方案，既能够展现中间件团队的技术实力，性能上相比MySQL也要高；但另外的研发人员认为这个方案复杂度太高，按照目前的团队人力和技术实力，要做到稳定可靠的存储系统，需要耗时较长的迭代，这个过程中消息队列系统可能因为存储出现严重问题，例如文件损坏导致丢失大量数据。</p>\n</li>\n<li>\n<p>运维代表不太赞成这个方案，因为运维之前遇到过几次类似的存储系统故障导致数据丢失的问题，损失惨重。例如，MongoDB丢数据、Tokyo Tyrant丢数据无法恢复等。运维团队并不相信目前的中间件团队的技术实力足以支撑自己研发一个存储系统（这让中间件团队的人员感觉有点不爽）。</p>\n</li>\n<li>\n<p>测试代表赞同运维代表的意见，并且自研存储系统的测试难度也很高，投入也很大。</p>\n</li>\n<li>\n<p>业务主管对自研存储系统也持保留意见，因为从历史经验来看，新系统上线肯定有bug，而存储系统出bug是最严重的，一旦出bug导致大量消息丢失，对系统的影响会严重。</p>\n</li>\n</ul>\n<p>针对3个备选方案的讨论初步完成后，架构师列出了3个方案的360度环评表：</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/7d/8c/7de80a7501627b02ba0288f8f725a68c.jpg?wh=3804*2505\" alt=\"\" /></p>\n<p>列出这个表格后，无法一眼看出具体哪个方案更合适，于是大家都把目光投向架构师，决策的压力现在集中在架构师身上了。</p>\n<p>架构师经过思考后，给出了最终选择备选方案2，原因有：</p>\n<ul>\n<li>\n<p>排除备选方案1的主要原因是可运维性，因为再成熟的系统，上线后都可能出问题，如果出问题无法快速解决，则无法满足业务的需求；并且Kafka的主要设计目标是高性能日志传输，而我们的消息队列设计的主要目标是业务消息的可靠传输。</p>\n</li>\n<li>\n<p>排除备选方案3的主要原因是复杂度，目前团队技术实力和人员规模（总共6人，还有其他中间件系统需要开发和维护）无法支撑自研存储系统（参考架构设计原则2：简单原则）。</p>\n</li>\n<li>\n<p>备选方案2的优点就是复杂度不高，也可以很好地融入现有运维体系，可靠性也有保障。</p>\n</li>\n</ul>\n<p>针对备选方案2的缺点，架构师解释是：</p>\n<ul>\n<li>\n<p>备选方案2的第一个缺点是性能，业务目前需要的性能并不是非常高，方案2能够满足，即使后面性能需求增加，方案2的数据分组方案也能够平行扩展进行支撑（参考架构设计原则3：演化原则）。</p>\n</li>\n<li>\n<p>备选方案2的第二个缺点是成本，一个分组就需要4台机器，支撑目前的业务需求可能需要12台服务器，但实际上备机（包括服务器和数据库）主要用作备份，可以和其他系统并行部署在同一台机器上。</p>\n</li>\n<li>\n<p>备选方案2的第三个缺点是技术上看起来并不很优越，但我们的设计目的不是为了证明自己（参考架构设计原则1：合适原则），而是更快更好地满足业务需求。</p>\n</li>\n</ul>\n<p>最后，大家针对一些细节再次讨论后，确定了选择备选方案2。</p>\n<p>通过“前浪微博”这个案例我们可以看出，备选方案的选择和很多因素相关，并不单单考虑性能高低、技术是否优越这些纯技术因素。业务的需求特点、运维团队的经验、已有的技术体系、团队人员的技术水平都会影响备选方案的选择。因此，同样是上述3个备选方案，有的团队会选择引入Kafka（例如，很多创业公司的初创团队，人手不够，需要快速上线支撑业务），有的会选择自研存储系统（例如，阿里开发了RocketMQ，人多力量大，业务复杂是主要原因）。</p>\n<h2>小结</h2>\n<p>今天我为你讲了架构设计流程的第三个步骤：评估和选择备选方案，并且基于模拟的“前浪微博”消息队列系统，给出了具体的评估和选择示例，希望对你有所帮助。</p>\n<p>这就是今天的全部内容，留一道思考题给你吧，RocketMQ和Kafka有什么区别，阿里为何选择了自己开发RocketMQ？</p>\n<p>欢迎你把答案写到留言区，和我一起讨论。相信经过深度思考的回答，也会让你对知识的理解更加深刻。（编辑乱入：精彩的留言有机会获得丰厚福利哦！）</p>\n","neighbors":{"left":{"article_title":"11 | 架构设计流程：设计备选方案","id":7800},"right":{"article_title":"13 | 架构设计流程：详细方案设计","id":7885}},"comments":[{"had_liked":false,"id":9841,"user_name":"王旭东","can_delete":false,"product_type":"c1","uid":1108106,"ip_address":"","ucode":"61950FD5D5BFF9","user_header":"https://static001.geekbang.org/account/avatar/00/10/e8/8a/e3032578.jpg","comment_is_top":false,"comment_ctime":1527123696,"is_pvip":false,"replies":[{"id":3072,"content":"赞，整理的很详细","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169420,"ip_address":"","comment_id":9841,"utype":1}],"discussion_count":9,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"Kafka没用过，但是上网看了相关对比，认为阿里选择自己开发RocketMQ更多是业务的驱动，当业务更多的需要以下功能的支持时，kafka不能满足或者ActiveMQ等其他消息中间件不能满足，所以选择自己开发（RocketMQ设计的真的很牛）\n1、数据可靠性\n\tkafka使用异步刷盘方式，异步Replication\n\tRocketMQ支持异步刷盘，同步刷盘，同步Replication，异步Replication\n2、严格的消息顺序\n    Kafka支持消息顺序，但是一台Broker宕机后，就会产生消息乱序\n    RocketMQ支持严格的消息顺序，在顺序消息场景下，一台Broker宕机后，发送消息会失败，但是不会乱序\n3、消费失败重试机制\n    Kafka消费失败不支持重试\n    RocketMQ消费失败支持定时重试，每次重试间隔时间顺延\n4、定时消息\n\tKafka不支持定时消息\n\tRocketMQ支持定时消息\n5、分布式事务消息\n\tKafka不支持分布式事务消息\n\t阿里云ONS支持分布式定时消息，未来开源版本的RocketMQ也有计划支持分布式事务消息\n6、消息查询机制\n\tKafka不支持消息查询\n\tRocketMQ支持根据Message Id查询消息，也支持根据消息内容查询消息（发送消息时指定一个Message Key，任意字符串，例如指定为订单Id）\n7、消息回溯\n\tKafka理论上可以按照Offset来回溯消息\n\tRocketMQ支持按照时间来回溯消息，精度毫秒，例如从一天之前的某时某分某秒开始重新消费消息\n………","like_count":329},{"had_liked":false,"id":9833,"user_name":"公号-技术夜未眠","can_delete":false,"product_type":"c1","uid":1013683,"ip_address":"","ucode":"83825B57CBD952","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","comment_is_top":false,"comment_ctime":1527122571,"is_pvip":true,"replies":[{"id":3078,"content":"财大气粗能力又强业务还复杂，所以就自己开发了😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169867,"ip_address":"","comment_id":9833,"utype":1}],"discussion_count":4,"race_medal":1,"score":2,"product_id":100006601,"comment_content":"心得: 架构设计流程-评估和选择备选方案\n\n1 评估和选择备选方案的方法\n按优先级选择，即架构师综合当前的业务发展情况、团队人员规模和技能、业务发展预测等因素，将质量属性按照优先级排序，首先挑选满足第一优先级的，如果方案都满足，那就再看第二优先级……以此类推。\n\n2 RocketMQ 和 Kafka 有什么区别？\n\n（1） 适用场景\nKafka适合日志处理；RocketMQ适合业务处理。\n\n（2） 性能\nKafka单机写入TPS号称在百万条&#47;秒；RocketMQ大约在10万条&#47;秒。Kafka单机性能更高。\n\n（3） 可靠性\nRocketMQ支持异步&#47;同步刷盘;异步&#47;同步Replication；Kafka使用异步刷盘方式，异步Replication。RocketMQ所支持的同步方式提升了数据的可靠性。\n\n（4） 实时性\n均支持pull长轮询，RocketMQ消息实时性更好\n\n（5） 支持的队列数\nKafka单机超过64个队列&#47;分区，消息发送性能降低严重；RocketMQ单机支持最高5万个队列，性能稳定（这也是适合业务处理的原因之一）\n\n3 为什么阿里会自研RocketMQ？\n\n（1） Kafka的业务应用场景主要定位于日志传输；对于复杂业务支持不够\n（2） 阿里很多业务场景对数据可靠性、数据实时性、消息队列的个数等方面的要求很高\n（3）当业务成长到一定规模，采用开源方案的技术成本会变高（开源方案无法满足业务的需要；旧版本、自开发代码与新版本的兼容等）\n（4） 阿里在团队、成本、资源投入等方面约束性条件几乎没有","like_count":137,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418222,"discussion_content":"赞，整理的很详细","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117434,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/fa/5d8d246d.jpg","nickname":"rm -rf","note":"","ucode":"F58CD88B8CF698","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3355,"discussion_content":"你说的Kafka是老黄历了，列出的很多都是低版本的问题\n","likes_number":20,"is_delete":false,"is_hidden":false,"ctime":1564415999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2004683,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/96/cb/8ce4a3cd.jpg","nickname":"Cloud.","note":"","ucode":"FF61D18EA17E67","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289225,"discussion_content":"还有个问题，也是阿里在对rocketmq在对比kafka时最大的优势，就是topic数量很多的时候，kafka性能会急剧下降，这是因为kafka里topic多个分区，每个分区都是一个独立的文件，topic增多后会由于打开文件io过多，性能下降，rocketmq在这方面做了优化，日志都存在同一个文件，topic下的每个queue只是单独存储了索引，索引文件是很小的，读取数据时增加了页缓存，也提升查询性能。这种优化可以让rocketmq在topic增多时性能下降很小。","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1594031489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560127,"discussion_content":"大家注意时间，上面的评论已经2018年，距离现在已经近4年，所以，使用时，还是要查询确认最新版本的特性。\n同时也告诉我们，在做软件/服务对比时，应该加上具体版本～","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1649209599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325994,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/aa/e8dfcd7e.jpg","nickname":"AAA_叶子","note":"","ucode":"1E93617D308EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378470,"discussion_content":"kafka可以开启支持事物配置。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623238321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1661155,"avatar":"https://static001.geekbang.org/account/avatar/00/19/58/e3/ac92fcfa.jpg","nickname":"染月","note":"","ucode":"FB5708415B4A9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345543,"discussion_content":"rocketmq 4.3.0版本起已支持分布式事务","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611738507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1442605,"avatar":"https://static001.geekbang.org/account/avatar/00/16/03/2d/404627dc.jpg","nickname":"Anryg Zhun","note":"","ucode":"76DF8560BA9D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289284,"discussion_content":"新版本Kafka也可以根据时间来回溯消息的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594046466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332954,"discussion_content":"RocketMQ这么多优势","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607401517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332952,"discussion_content":"那为啥感觉公司用的Kafka还是比较多？？是我的错觉？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607401461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10211,"user_name":"东","can_delete":false,"product_type":"c1","uid":1043947,"ip_address":"","ucode":"0FF5018422CEA9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/eb/88cac7a5.jpg","comment_is_top":false,"comment_ctime":1527351735,"is_pvip":false,"replies":[{"id":3187,"content":"你这个案例经典，备选方案都涵盖了，设计原则也涵盖了😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527396453,"ip_address":"","comment_id":10211,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"案例很典型，所在项目，先选了3，1.0上线后效果不错，后期业务扩展，投入跟不上，3的缺点不断暴露，到后来大家就在吐槽为啥要造轮子。开始否决3，重构, 选择了1，运维话语权弱，被忽略了。至于为啥不选2，就是面子上过不去，拿不出手。项目不光是为了业务，也为了架构师，领导的面子，被拿来和公司内其他项目做横向比较时，比较好吹。至于运维的哥们，也乐意学些新东西，提升自我价值。所以，选择1大家都开心，除了项目的投入变大","like_count":85,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418219,"discussion_content":"财大气粗能力又强业务还复杂，所以就自己开发了😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/98/62abf2f0.jpg","nickname":"jackey","note":"","ucode":"FECEFE1EA3D1AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581059,"discussion_content":"有人，有钱，又想要最适合自己的那就定制吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658476764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1214303,"avatar":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","nickname":"Kepler","note":"","ucode":"0C9CA3DB8B3CF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531385,"discussion_content":"采用开源的，当开源特性不能满足业务需要发版本迭代时，时间成本太高了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637300854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305504,"discussion_content":"Kafka单机单磁盘分区数只要不要超过 1000~2000 就行, 性能不会降低太多, 一般公司肯定够用了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599969360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9849,"user_name":"Regular","can_delete":false,"product_type":"c1","uid":1025998,"ip_address":"","ucode":"80B3EA083534CA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a7/ce/7ee0d672.jpg","comment_is_top":false,"comment_ctime":1527124608,"is_pvip":false,"replies":[{"id":3070,"content":"赞同","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169337,"ip_address":"","comment_id":9849,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"kafka针对海量数据，但是对数据的正确度要求不是十分严格。\n而阿里巴巴中用于交易相关的事情较多，对数据的正确性要求极高，Kafka不合适，然后就自研了RocketMQ。","like_count":62,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418393,"discussion_content":"你这个案例经典，备选方案都涵盖了，设计原则也涵盖了😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527396453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1395162,"avatar":"https://static001.geekbang.org/account/avatar/00/15/49/da/8b4e1408.jpg","nickname":"Ted","note":"","ucode":"89A8202074C0B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388226,"discussion_content":"太真实了：运维话语权弱，被忽略了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628661988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447496,"avatar":"https://static001.geekbang.org/account/avatar/00/16/16/48/01567df1.jpg","nickname":"郑泽洲","note":"","ucode":"EA1B540A040875","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558174,"discussion_content":"其实把方案1中的Kafka换成RocketMQ（java写的），估计最后讨论下来就用方案1了。方案1最主要的反对方就是运维，搞定运维，“学些新东西，提升自我价值；而且是java，符合公司技术栈；有插件可以整合到公司监控体系”等等。中间件团队才6个人，还有其他系统要维护，不知后续有多大投入能持续演进好这个自研系统？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1648117432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022487,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9a/17/45d50064.jpg","nickname":"初见","note":"","ucode":"808185EBE38A6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539476,"discussion_content":"我就直接选择1，没啥好比较的，你说1投入大吗？在切合你的业务场景下，是3个中投入最小的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639726718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922378,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","nickname":"ACK","note":"","ucode":"C5D09B18DEF151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350113,"discussion_content":"很有意思","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1613713811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10182,"user_name":"alexgreenbar","can_delete":false,"product_type":"c1","uid":1003655,"ip_address":"","ucode":"87ED7233E2767C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/87/dde718fa.jpg","comment_is_top":false,"comment_ctime":1527327456,"is_pvip":false,"replies":[{"id":3163,"content":"这个模拟的场景可能是2013年😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527374408,"ip_address":"","comment_id":10182,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"我觉得应该选取kafka方案，运维以scala为理由觉得运维复杂站不住脚，实际上在Kafka运维时很少需要了解Scala，而且目前基于Kafka的开发也基本上使用Java API。另外认为kafka是用于日志传输，所以不适合系统的业务事件是个更大的误区，Kafka本身在最早实现时的确是为了传输日志，但后来经过多年发展，其适用范围早不限于日志，并且很多采取Kafka的公司并非用它来处理日志，kafka背后的Confluence公司提供了很多基于kafka来简化系统实现的例子，值得架构师参考。","like_count":47,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418377,"discussion_content":"这个模拟的场景可能是2013年😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527374408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1033219,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","nickname":"JianXu","note":"","ucode":"2A61BDBB573BDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":544337,"discussion_content":"我会请运维团队break down 来解释为什么现有系统监控运维Kafka 这么难？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641474585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":418377,"ip_address":"","group_id":0},"score":544337,"extra":""}]},{"author":{"id":1768852,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fd/94/8704d2b0.jpg","nickname":"spoofer","note":"","ucode":"6723F64ACC3F27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":86969,"discussion_content":"非常赞同，但是选哪个消息队列中间件，可以拿出来做一下对比","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576634786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13506,"user_name":"陈奇","can_delete":false,"product_type":"c1","uid":1102507,"ip_address":"","ucode":"E4866AFD9D53B1","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/ab/55015ae6.jpg","comment_is_top":false,"comment_ctime":1529710851,"is_pvip":false,"replies":[{"id":4541,"content":"人少或者没有统一的运维体系，kafka是最稳妥的选择","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529726255,"ip_address":"","comment_id":13506,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"1、就备选方案选择来说，方案2确实可行，但就我们使用Kafka经验来讲，Kafka确实很成熟，运维成本较低。架构师在选择方案时，需要对方案中涉及到的工具烂熟于心。\n2、关于RocketMQ和Kafka区别，有些回答罗列了很多功能的差异，个人觉得无太大意义。大家都在发展，功能的差异会很快抹平的。我想说点区别是，1、架构上RocketMQ不依赖zk，而Kafka重度依赖zk；2、RocketMQ没有完全开源的，有一些功能需要自己重写；而Kafka应用广泛，社区支持力度大，这样对运维压力和成本会小很多。","like_count":22,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419669,"discussion_content":"人少或者没有统一的运维体系，kafka是最稳妥的选择","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529726255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9938,"user_name":"bluefantasy","can_delete":false,"product_type":"c1","uid":1101382,"ip_address":"","ucode":"2F24E373FDDE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/46/67c145ee.jpg","comment_is_top":false,"comment_ctime":1527171060,"is_pvip":false,"replies":[{"id":3120,"content":"没有用过呢，按道理是可以保证的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217385,"ip_address":"","comment_id":9938,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"几乎所有的人都说kafka是异步刷盘会导致消息可靠性出问题。但是我想说kafka如果配置了每写一条消息就强制刷盘，再加上配置kafka集群中所有副本全部同步之后再返回写入成功。在这种配置下消息的可靠性是可以保障的。  只不过是这种配置下性能低而已。  请问华仔，这种配置下kafka是可以保证消息的可靠性的对吧？","like_count":15,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418265,"discussion_content":"没有用过呢，按道理是可以保证的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305502,"discussion_content":"分布式环境下, 可靠性由副本机制保证, 单机环境下可靠性由刷盘保证;","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599968573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1047311,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fb/0f/2bb7e1e8.jpg","nickname":"长芽的土豆子","note":"","ucode":"92E2C6158BD5B7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309861,"discussion_content":"除非同步调用，要不无法保证。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601468649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296193,"discussion_content":"完全可以保证，但是高并发下，写入性能不行。单机多个队列写，导致磁盘竞争。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596467038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305500,"discussion_content":"高并发 , 单机单磁盘1000个分区以下, 一般不会有性能问题, 说写入性能不行对kafka 来说是个侮辱","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599968477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":296193,"ip_address":"","group_id":0},"score":305500,"extra":""},{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379506,"discussion_content":"你说的这个问题用mysql方案也存在","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623932439,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":296193,"ip_address":"","group_id":0},"score":379506,"extra":""}]}]},{"had_liked":false,"id":12775,"user_name":"zhouwm","can_delete":false,"product_type":"c1","uid":1100250,"ip_address":"","ucode":"874843F43B0EA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/da/22328e47.jpg","comment_is_top":false,"comment_ctime":1529026784,"is_pvip":false,"replies":[{"id":4242,"content":"是的，kafka目前是最成熟的，久经考验","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529046363,"ip_address":"","comment_id":12775,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"kafka同步刷盘同步复制早支持了，同步复制不会有乱序。kafka很稳定的，几个产品都用过，简单场景没啥问题。rocketmq开源版本貌似master挂掉后slave无法自动切换为master，可读不可写！阿里中间件博客有时候有点...","like_count":12,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419404,"discussion_content":"是的，kafka目前是最成熟的，久经考验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529046363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033096,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c3/88/d16816a8.jpg","nickname":"如来神掌","note":"","ucode":"45E20FF935BD2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302946,"discussion_content":"可以多master多slave","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599095604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9825,"user_name":"narry","can_delete":false,"product_type":"c1","uid":1033576,"ip_address":"","ucode":"B8010C1DE39D08","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/68/7afb7304.jpg","comment_is_top":false,"comment_ctime":1527120677,"is_pvip":false,"replies":[{"id":3074,"content":"运维是架构设计的重要考虑因素","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169570,"ip_address":"","comment_id":9825,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"这个应该有多个原因吧，个人感觉有下面几条，1）业务特性需要，最初kafka不支持事务性消息，而rocketmq支持，2）rocketmq支持broker端的消息过滤 3）淘宝的java能力比scala强很多 ，为了运维稳定，就学习了kafka的优点，进行了重写 ，毕竟运维才是软件的核心生命周期","like_count":11,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418216,"discussion_content":"运维是架构设计的重要考虑因素","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12139,"user_name":"孙振超","can_delete":false,"product_type":"c1","uid":1101755,"ip_address":"","ucode":"0F9EABC6125350","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg","comment_is_top":false,"comment_ctime":1528615724,"is_pvip":false,"replies":[{"id":3987,"content":"有一定道理，有钱真不是决定做主要原因，没钱没人才是决定不做的主要原因😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528624199,"ip_address":"","comment_id":12139,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"方案2是整体最优解，各个利益方都收益。代码上线只是开始，后续漫长的使用优化维护需要很大的精力。\n对于rocketmq和kafka，不少留言提到是因为阿里有钱，这还真不是。阿里有钱，怎么没有自己搞spring、ibatis、java、linux呢？归根还在于简单和适合原则，kafka和阿里需要的高可用、高稳定、消息不可丢失、可蓄洪、可重放等场景不匹配，同时开发新的成本又在可接受范围之内才自己开发的。\n如果google的大数据三套件，是在没有已有方案的情况下去自己实现的。","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419135,"discussion_content":"有一定道理，有钱真不是决定做主要原因，没钱没人才是决定不做的主要原因😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528624199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109389,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ed/8d/377c106a.jpg","nickname":"KW💤","note":"","ucode":"290DD7016F4EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403942,"discussion_content":"巧了，类似spring、ibatis、java、linux的替代方案、或者自定义扩展阿里都有搞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634195044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9841,"user_name":"王旭东","can_delete":false,"product_type":"c1","uid":1108106,"ip_address":"","ucode":"61950FD5D5BFF9","user_header":"https://static001.geekbang.org/account/avatar/00/10/e8/8a/e3032578.jpg","comment_is_top":false,"comment_ctime":1527123696,"is_pvip":false,"replies":[{"id":3072,"content":"赞，整理的很详细","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169420,"ip_address":"","comment_id":9841,"utype":1}],"discussion_count":9,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"Kafka没用过，但是上网看了相关对比，认为阿里选择自己开发RocketMQ更多是业务的驱动，当业务更多的需要以下功能的支持时，kafka不能满足或者ActiveMQ等其他消息中间件不能满足，所以选择自己开发（RocketMQ设计的真的很牛）\n1、数据可靠性\n\tkafka使用异步刷盘方式，异步Replication\n\tRocketMQ支持异步刷盘，同步刷盘，同步Replication，异步Replication\n2、严格的消息顺序\n    Kafka支持消息顺序，但是一台Broker宕机后，就会产生消息乱序\n    RocketMQ支持严格的消息顺序，在顺序消息场景下，一台Broker宕机后，发送消息会失败，但是不会乱序\n3、消费失败重试机制\n    Kafka消费失败不支持重试\n    RocketMQ消费失败支持定时重试，每次重试间隔时间顺延\n4、定时消息\n\tKafka不支持定时消息\n\tRocketMQ支持定时消息\n5、分布式事务消息\n\tKafka不支持分布式事务消息\n\t阿里云ONS支持分布式定时消息，未来开源版本的RocketMQ也有计划支持分布式事务消息\n6、消息查询机制\n\tKafka不支持消息查询\n\tRocketMQ支持根据Message Id查询消息，也支持根据消息内容查询消息（发送消息时指定一个Message Key，任意字符串，例如指定为订单Id）\n7、消息回溯\n\tKafka理论上可以按照Offset来回溯消息\n\tRocketMQ支持按照时间来回溯消息，精度毫秒，例如从一天之前的某时某分某秒开始重新消费消息\n………","like_count":329,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418222,"discussion_content":"赞，整理的很详细","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117434,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/fa/5d8d246d.jpg","nickname":"rm -rf","note":"","ucode":"F58CD88B8CF698","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3355,"discussion_content":"你说的Kafka是老黄历了，列出的很多都是低版本的问题\n","likes_number":20,"is_delete":false,"is_hidden":false,"ctime":1564415999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2004683,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/96/cb/8ce4a3cd.jpg","nickname":"Cloud.","note":"","ucode":"FF61D18EA17E67","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289225,"discussion_content":"还有个问题，也是阿里在对rocketmq在对比kafka时最大的优势，就是topic数量很多的时候，kafka性能会急剧下降，这是因为kafka里topic多个分区，每个分区都是一个独立的文件，topic增多后会由于打开文件io过多，性能下降，rocketmq在这方面做了优化，日志都存在同一个文件，topic下的每个queue只是单独存储了索引，索引文件是很小的，读取数据时增加了页缓存，也提升查询性能。这种优化可以让rocketmq在topic增多时性能下降很小。","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1594031489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560127,"discussion_content":"大家注意时间，上面的评论已经2018年，距离现在已经近4年，所以，使用时，还是要查询确认最新版本的特性。\n同时也告诉我们，在做软件/服务对比时，应该加上具体版本～","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1649209599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325994,"avatar":"https://static001.geekbang.org/account/avatar/00/14/3b/aa/e8dfcd7e.jpg","nickname":"AAA_叶子","note":"","ucode":"1E93617D308EE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378470,"discussion_content":"kafka可以开启支持事物配置。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623238321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1661155,"avatar":"https://static001.geekbang.org/account/avatar/00/19/58/e3/ac92fcfa.jpg","nickname":"染月","note":"","ucode":"FB5708415B4A9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345543,"discussion_content":"rocketmq 4.3.0版本起已支持分布式事务","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611738507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1442605,"avatar":"https://static001.geekbang.org/account/avatar/00/16/03/2d/404627dc.jpg","nickname":"Anryg Zhun","note":"","ucode":"76DF8560BA9D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289284,"discussion_content":"新版本Kafka也可以根据时间来回溯消息的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594046466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332954,"discussion_content":"RocketMQ这么多优势","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607401517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332952,"discussion_content":"那为啥感觉公司用的Kafka还是比较多？？是我的错觉？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607401461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9833,"user_name":"公号-技术夜未眠","can_delete":false,"product_type":"c1","uid":1013683,"ip_address":"","ucode":"83825B57CBD952","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","comment_is_top":false,"comment_ctime":1527122571,"is_pvip":true,"replies":[{"id":3078,"content":"财大气粗能力又强业务还复杂，所以就自己开发了😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169867,"ip_address":"","comment_id":9833,"utype":1}],"discussion_count":4,"race_medal":1,"score":2,"product_id":100006601,"comment_content":"心得: 架构设计流程-评估和选择备选方案\n\n1 评估和选择备选方案的方法\n按优先级选择，即架构师综合当前的业务发展情况、团队人员规模和技能、业务发展预测等因素，将质量属性按照优先级排序，首先挑选满足第一优先级的，如果方案都满足，那就再看第二优先级……以此类推。\n\n2 RocketMQ 和 Kafka 有什么区别？\n\n（1） 适用场景\nKafka适合日志处理；RocketMQ适合业务处理。\n\n（2） 性能\nKafka单机写入TPS号称在百万条&#47;秒；RocketMQ大约在10万条&#47;秒。Kafka单机性能更高。\n\n（3） 可靠性\nRocketMQ支持异步&#47;同步刷盘;异步&#47;同步Replication；Kafka使用异步刷盘方式，异步Replication。RocketMQ所支持的同步方式提升了数据的可靠性。\n\n（4） 实时性\n均支持pull长轮询，RocketMQ消息实时性更好\n\n（5） 支持的队列数\nKafka单机超过64个队列&#47;分区，消息发送性能降低严重；RocketMQ单机支持最高5万个队列，性能稳定（这也是适合业务处理的原因之一）\n\n3 为什么阿里会自研RocketMQ？\n\n（1） Kafka的业务应用场景主要定位于日志传输；对于复杂业务支持不够\n（2） 阿里很多业务场景对数据可靠性、数据实时性、消息队列的个数等方面的要求很高\n（3）当业务成长到一定规模，采用开源方案的技术成本会变高（开源方案无法满足业务的需要；旧版本、自开发代码与新版本的兼容等）\n（4） 阿里在团队、成本、资源投入等方面约束性条件几乎没有","like_count":137,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418219,"discussion_content":"财大气粗能力又强业务还复杂，所以就自己开发了😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133976,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4d/98/62abf2f0.jpg","nickname":"jackey","note":"","ucode":"FECEFE1EA3D1AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581059,"discussion_content":"有人，有钱，又想要最适合自己的那就定制吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658476764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1214303,"avatar":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","nickname":"Kepler","note":"","ucode":"0C9CA3DB8B3CF0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531385,"discussion_content":"采用开源的，当开源特性不能满足业务需要发版本迭代时，时间成本太高了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637300854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305504,"discussion_content":"Kafka单机单磁盘分区数只要不要超过 1000~2000 就行, 性能不会降低太多, 一般公司肯定够用了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599969360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10211,"user_name":"东","can_delete":false,"product_type":"c1","uid":1043947,"ip_address":"","ucode":"0FF5018422CEA9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/eb/88cac7a5.jpg","comment_is_top":false,"comment_ctime":1527351735,"is_pvip":false,"replies":[{"id":3187,"content":"你这个案例经典，备选方案都涵盖了，设计原则也涵盖了😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527396453,"ip_address":"","comment_id":10211,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"案例很典型，所在项目，先选了3，1.0上线后效果不错，后期业务扩展，投入跟不上，3的缺点不断暴露，到后来大家就在吐槽为啥要造轮子。开始否决3，重构, 选择了1，运维话语权弱，被忽略了。至于为啥不选2，就是面子上过不去，拿不出手。项目不光是为了业务，也为了架构师，领导的面子，被拿来和公司内其他项目做横向比较时，比较好吹。至于运维的哥们，也乐意学些新东西，提升自我价值。所以，选择1大家都开心，除了项目的投入变大","like_count":85,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418393,"discussion_content":"你这个案例经典，备选方案都涵盖了，设计原则也涵盖了😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527396453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1395162,"avatar":"https://static001.geekbang.org/account/avatar/00/15/49/da/8b4e1408.jpg","nickname":"Ted","note":"","ucode":"89A8202074C0B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388226,"discussion_content":"太真实了：运维话语权弱，被忽略了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628661988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447496,"avatar":"https://static001.geekbang.org/account/avatar/00/16/16/48/01567df1.jpg","nickname":"郑泽洲","note":"","ucode":"EA1B540A040875","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558174,"discussion_content":"其实把方案1中的Kafka换成RocketMQ（java写的），估计最后讨论下来就用方案1了。方案1最主要的反对方就是运维，搞定运维，“学些新东西，提升自我价值；而且是java，符合公司技术栈；有插件可以整合到公司监控体系”等等。中间件团队才6个人，还有其他系统要维护，不知后续有多大投入能持续演进好这个自研系统？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1648117432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022487,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9a/17/45d50064.jpg","nickname":"初见","note":"","ucode":"808185EBE38A6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539476,"discussion_content":"我就直接选择1，没啥好比较的，你说1投入大吗？在切合你的业务场景下，是3个中投入最小的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639726718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922378,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/55/4a/8a841200.jpg","nickname":"ACK","note":"","ucode":"C5D09B18DEF151","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350113,"discussion_content":"很有意思","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1613713811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9849,"user_name":"Regular","can_delete":false,"product_type":"c1","uid":1025998,"ip_address":"","ucode":"80B3EA083534CA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a7/ce/7ee0d672.jpg","comment_is_top":false,"comment_ctime":1527124608,"is_pvip":false,"replies":[{"id":3070,"content":"赞同","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169337,"ip_address":"","comment_id":9849,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"kafka针对海量数据，但是对数据的正确度要求不是十分严格。\n而阿里巴巴中用于交易相关的事情较多，对数据的正确性要求极高，Kafka不合适，然后就自研了RocketMQ。","like_count":62,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418226,"discussion_content":"赞同","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10182,"user_name":"alexgreenbar","can_delete":false,"product_type":"c1","uid":1003655,"ip_address":"","ucode":"87ED7233E2767C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/50/87/dde718fa.jpg","comment_is_top":false,"comment_ctime":1527327456,"is_pvip":false,"replies":[{"id":3163,"content":"这个模拟的场景可能是2013年😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527374408,"ip_address":"","comment_id":10182,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"我觉得应该选取kafka方案，运维以scala为理由觉得运维复杂站不住脚，实际上在Kafka运维时很少需要了解Scala，而且目前基于Kafka的开发也基本上使用Java API。另外认为kafka是用于日志传输，所以不适合系统的业务事件是个更大的误区，Kafka本身在最早实现时的确是为了传输日志，但后来经过多年发展，其适用范围早不限于日志，并且很多采取Kafka的公司并非用它来处理日志，kafka背后的Confluence公司提供了很多基于kafka来简化系统实现的例子，值得架构师参考。","like_count":47,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418226,"discussion_content":"赞同","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13506,"user_name":"陈奇","can_delete":false,"product_type":"c1","uid":1102507,"ip_address":"","ucode":"E4866AFD9D53B1","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/ab/55015ae6.jpg","comment_is_top":false,"comment_ctime":1529710851,"is_pvip":false,"replies":[{"id":4541,"content":"人少或者没有统一的运维体系，kafka是最稳妥的选择","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529726255,"ip_address":"","comment_id":13506,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"1、就备选方案选择来说，方案2确实可行，但就我们使用Kafka经验来讲，Kafka确实很成熟，运维成本较低。架构师在选择方案时，需要对方案中涉及到的工具烂熟于心。\n2、关于RocketMQ和Kafka区别，有些回答罗列了很多功能的差异，个人觉得无太大意义。大家都在发展，功能的差异会很快抹平的。我想说点区别是，1、架构上RocketMQ不依赖zk，而Kafka重度依赖zk；2、RocketMQ没有完全开源的，有一些功能需要自己重写；而Kafka应用广泛，社区支持力度大，这样对运维压力和成本会小很多。","like_count":22,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418377,"discussion_content":"这个模拟的场景可能是2013年😃😃","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527374408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1033219,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/03/f753fda7.jpg","nickname":"JianXu","note":"","ucode":"2A61BDBB573BDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":544337,"discussion_content":"我会请运维团队break down 来解释为什么现有系统监控运维Kafka 这么难？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641474585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":418377,"ip_address":"","group_id":0},"score":544337,"extra":""}]},{"author":{"id":1768852,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fd/94/8704d2b0.jpg","nickname":"spoofer","note":"","ucode":"6723F64ACC3F27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":86969,"discussion_content":"非常赞同，但是选哪个消息队列中间件，可以拿出来做一下对比","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576634786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9938,"user_name":"bluefantasy","can_delete":false,"product_type":"c1","uid":1101382,"ip_address":"","ucode":"2F24E373FDDE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/46/67c145ee.jpg","comment_is_top":false,"comment_ctime":1527171060,"is_pvip":false,"replies":[{"id":3120,"content":"没有用过呢，按道理是可以保证的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217385,"ip_address":"","comment_id":9938,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"几乎所有的人都说kafka是异步刷盘会导致消息可靠性出问题。但是我想说kafka如果配置了每写一条消息就强制刷盘，再加上配置kafka集群中所有副本全部同步之后再返回写入成功。在这种配置下消息的可靠性是可以保障的。  只不过是这种配置下性能低而已。  请问华仔，这种配置下kafka是可以保证消息的可靠性的对吧？","like_count":15,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419669,"discussion_content":"人少或者没有统一的运维体系，kafka是最稳妥的选择","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529726255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12775,"user_name":"zhouwm","can_delete":false,"product_type":"c1","uid":1100250,"ip_address":"","ucode":"874843F43B0EA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/da/22328e47.jpg","comment_is_top":false,"comment_ctime":1529026784,"is_pvip":false,"replies":[{"id":4242,"content":"是的，kafka目前是最成熟的，久经考验","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529046363,"ip_address":"","comment_id":12775,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"kafka同步刷盘同步复制早支持了，同步复制不会有乱序。kafka很稳定的，几个产品都用过，简单场景没啥问题。rocketmq开源版本貌似master挂掉后slave无法自动切换为master，可读不可写！阿里中间件博客有时候有点...","like_count":12,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418265,"discussion_content":"没有用过呢，按道理是可以保证的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305502,"discussion_content":"分布式环境下, 可靠性由副本机制保证, 单机环境下可靠性由刷盘保证;","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599968573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1047311,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fb/0f/2bb7e1e8.jpg","nickname":"长芽的土豆子","note":"","ucode":"92E2C6158BD5B7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309861,"discussion_content":"除非同步调用，要不无法保证。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601468649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296193,"discussion_content":"完全可以保证，但是高并发下，写入性能不行。单机多个队列写，导致磁盘竞争。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596467038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1182802,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","nickname":"长脖子树","note":"","ucode":"D9090EF67EEB1B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305500,"discussion_content":"高并发 , 单机单磁盘1000个分区以下, 一般不会有性能问题, 说写入性能不行对kafka 来说是个侮辱","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599968477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":296193,"ip_address":"","group_id":0},"score":305500,"extra":""},{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1138792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/68/540a9004.jpg","nickname":"戒修","note":"","ucode":"EAECD493E06B66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379506,"discussion_content":"你说的这个问题用mysql方案也存在","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623932439,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":296193,"ip_address":"","group_id":0},"score":379506,"extra":""}]}]},{"had_liked":false,"id":9825,"user_name":"narry","can_delete":false,"product_type":"c1","uid":1033576,"ip_address":"","ucode":"B8010C1DE39D08","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/68/7afb7304.jpg","comment_is_top":false,"comment_ctime":1527120677,"is_pvip":false,"replies":[{"id":3074,"content":"运维是架构设计的重要考虑因素","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169570,"ip_address":"","comment_id":9825,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"这个应该有多个原因吧，个人感觉有下面几条，1）业务特性需要，最初kafka不支持事务性消息，而rocketmq支持，2）rocketmq支持broker端的消息过滤 3）淘宝的java能力比scala强很多 ，为了运维稳定，就学习了kafka的优点，进行了重写 ，毕竟运维才是软件的核心生命周期","like_count":11,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419404,"discussion_content":"是的，kafka目前是最成熟的，久经考验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529046363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033096,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c3/88/d16816a8.jpg","nickname":"如来神掌","note":"","ucode":"45E20FF935BD2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302946,"discussion_content":"可以多master多slave","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599095604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12139,"user_name":"孙振超","can_delete":false,"product_type":"c1","uid":1101755,"ip_address":"","ucode":"0F9EABC6125350","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg","comment_is_top":false,"comment_ctime":1528615724,"is_pvip":false,"replies":[{"id":3987,"content":"有一定道理，有钱真不是决定做主要原因，没钱没人才是决定不做的主要原因😃😃","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528624199,"ip_address":"","comment_id":12139,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100006601,"comment_content":"方案2是整体最优解，各个利益方都收益。代码上线只是开始，后续漫长的使用优化维护需要很大的精力。\n对于rocketmq和kafka，不少留言提到是因为阿里有钱，这还真不是。阿里有钱，怎么没有自己搞spring、ibatis、java、linux呢？归根还在于简单和适合原则，kafka和阿里需要的高可用、高稳定、消息不可丢失、可蓄洪、可重放等场景不匹配，同时开发新的成本又在可接受范围之内才自己开发的。\n如果google的大数据三套件，是在没有已有方案的情况下去自己实现的。","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418216,"discussion_content":"运维是架构设计的重要考虑因素","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10714,"user_name":"鹅米豆发","can_delete":false,"product_type":"c1","uid":1017687,"ip_address":"","ucode":"98E8D911EE32DE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/57/645159ee.jpg","comment_is_top":false,"comment_ctime":1527665863,"is_pvip":false,"replies":[{"id":3410,"content":"你说的这种方式也可以，围绕kafka做二次开发","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527674809,"ip_address":"","comment_id":10714,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"个人浅见。\n       从四个方面考虑，第一非功能性诉求（性能，可靠性，容错性，一致性等），第二研发成本（设计复杂性，实现复杂性，前期人力投入，后期人力投入，短期重构风险，工期要求），第三运维成本（运营工具是否完善，纳入现有运维体系的难度等），第四软硬件成本。\n       例子中，工期相对紧迫，研发团队是中间件，我会倾向于首选Kafka，短期先满足需求，然后解决问题。跟方案3相比，Kafka在研发成本、软硬件成本、可靠性、性能等方面优势巨大。跟方案2相比，Kafka是开源的，也有各种跨语言的API，据此建立运维系统、纳入现有运维体系的难度，比自建消息中间件的研发成本低得多。","like_count":9},{"had_liked":false,"id":9869,"user_name":"Geek_zbvt62","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg","comment_is_top":false,"comment_ctime":1527133839,"is_pvip":false,"replies":[{"id":3069,"content":"1. 很多监控和语言的机制相关，例如java要监控垃圾回收的情况，c++就没有这个事情。\n2. qps上万并不高，尤其对集群来说。\n3. 你可以细化，但方案2是可行的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169320,"ip_address":"","comment_id":9869,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"\n\n\n怎么感觉最牛派应该选择Memcache?...\n这两周在做api gateway的调查研究，打算替换掉现在用的网关。因为事关重大，所以就用了360度的方法。很累很费脑子，像个重型武器，轻易不用。\n有个疑问：文中提到运维团队说自己没有Scala语言运维的经验。中间件的运维需要深入到语言层面嘛？都是JVM不就行嘛？是因为不了解要监控哪些指标嘛？\n表示对选择方案2表示不能理解。架构师解释，方案2缺点是性能，但目前业务性能要求不是非常高。可qps上万了还不算高么？\n我觉得方案2还有好多缺点没讨论出来了\n","like_count":8,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418234,"discussion_content":"1. 很多监控和语言的机制相关，例如java要监控垃圾回收的情况，c++就没有这个事情。\n2. qps上万并不高，尤其对集群来说。\n3. 你可以细化，但方案2是可行的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167174,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1577707675,"is_pvip":false,"replies":[{"id":65132,"content":"理解到位👍","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1577944962,"ip_address":"","comment_id":167174,"utype":1}],"discussion_count":1,"race_medal":1,"score":3,"product_id":100006601,"comment_content":"看完这篇文章，有两个地方感觉讲的好：\n1. 360度环评，具体的操作方式为：列出我们需要关注的质量属性点，然后分别从这些质量属性的维度去评估每个方案，再综合挑选适合当时情况的最优方案。\n\n这里的质量属性点，主要是非功能相关的，它和我们之前识别出来的系统复杂度是一脉相承的，我们在识别复杂度的时候，也是列出了所有的可能复杂度，然后再根据系统的需求对其逐一分析。这里可以直接使用已经识别出来的复杂度做架构方案的测评。\n\n2. 哪些人需要参加测评\n我之前的一个狭隘的理解是架构评审只需要引入老板、架构师和开发团队就可以了，忽略了测试和运维。做测评需要引入整个团队，大家站在不同的立场充分发表看法，对于设计一个成熟的架构非常重要！","like_count":6,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479769,"discussion_content":"理解到位👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577944962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20662,"user_name":"文竹","can_delete":false,"product_type":"c1","uid":1103167,"ip_address":"","ucode":"74413B1975976B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/3f/80bf4841.jpg","comment_is_top":false,"comment_ctime":1534650185,"is_pvip":false,"replies":[{"id":7288,"content":"学以致用，知行合一","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1534738544,"ip_address":"","comment_id":20662,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"360度环评方法很棒，一个前提是寻找质量属性，架构师需要提前与相关人员（系统涉及到的所有人员）进行会议沟通，确定出质量属性。找出质量属性本身也具有挑战性。\n\n\nKafka在大数据领域用得比较多，对更新支持不是很好。RabbitMQ更适合面向业务的产品。具体使用哪个，根据场景结合360度环评可得出。","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422354,"discussion_content":"学以致用，知行合一","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534738544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10455,"user_name":"成功","can_delete":false,"product_type":"c1","uid":1112099,"ip_address":"","ucode":"954B90AC92E8C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/23/165d2f0e.jpg","comment_is_top":false,"comment_ctime":1527555725,"is_pvip":false,"replies":[{"id":3324,"content":"太简单了，这样不利于做架构设计，而且kafka也不是快餐，是Linkedin大规模用的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527565908,"ip_address":"","comment_id":10455,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"KafKa是快餐，简单，方便，但对人体健康不可靠，Rocketmq是买原料自己下厨","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418484,"discussion_content":"太简单了，这样不利于做架构设计，而且kafka也不是快餐，是Linkedin大规模用的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527565908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9855,"user_name":"周文童","can_delete":false,"product_type":"c1","uid":1005411,"ip_address":"","ucode":"0C65A0A67229FA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/63/be6db73e.jpg","comment_is_top":false,"comment_ctime":1527125844,"is_pvip":false,"replies":[{"id":3125,"content":"消息队列大家都懂，但是方案又好多，造轮子的也不少，所以挑选了这个例子","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217685,"ip_address":"","comment_id":9855,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"前浪微博这个选型案例太典型了","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418229,"discussion_content":"消息队列大家都懂，但是方案又好多，造轮子的也不少，所以挑选了这个例子","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263422,"user_name":"Geek_9b9530","can_delete":false,"product_type":"c1","uid":2146381,"ip_address":"","ucode":"23498B3944F97C","user_header":"","comment_is_top":false,"comment_ctime":1606130328,"is_pvip":false,"replies":[{"id":95620,"content":"说得好，原文中的取舍只是符合原文背景的那个团队，如果你们团队的运维愿意学，愿意承担风险，用开源的也可以，这就是架构设计原则第一条合适原则的具体体现","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606182615,"ip_address":"","comment_id":263422,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"为什么研发团队可以学习，而运维团队就不能学习了呢？是运维团队的工资低吗？  不用Kafka的话，是否能选择RabbitMQ, ActiveMQ， RocketMQ等，自研的话，成本和时间也是问题。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510184,"discussion_content":"说得好，原文中的取舍只是符合原文背景的那个团队，如果你们团队的运维愿意学，愿意承担风险，用开源的也可以，这就是架构设计原则第一条合适原则的具体体现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606182615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244052,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367563,"is_pvip":true,"replies":[{"id":90070,"content":"只能说你们的团队适合用rabbitmq，回忆一下架构设计三原则","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598686554,"ip_address":"","comment_id":244052,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"那还不如我们的rabbitmq，直接有管理界面😹","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504461,"discussion_content":"只能说你们的团队适合用rabbitmq，回忆一下架构设计三原则","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598686554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26852,"user_name":"奋斗心","can_delete":false,"product_type":"c1","uid":1247286,"ip_address":"","ucode":"06A195AB0B6570","user_header":"https://static001.geekbang.org/account/avatar/00/13/08/36/98be3d69.jpg","comment_is_top":false,"comment_ctime":1537763067,"is_pvip":false,"replies":[{"id":10019,"content":"RocketMQ可以理解为是Java版的kafka，两者比较类似😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1537951370,"ip_address":"","comment_id":26852,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"感觉方案一换成rocketmq，方案要比方案2好很多。省时、省力、省钱，扩展性也很好","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424740,"discussion_content":"RocketMQ可以理解为是Java版的kafka，两者比较类似😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537951370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9937,"user_name":"Kyle","can_delete":false,"product_type":"c1","uid":1106079,"ip_address":"","ucode":"44198A0BEC5FB2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/9f/9259a6b9.jpg","comment_is_top":false,"comment_ctime":1527170984,"is_pvip":false,"replies":[{"id":3121,"content":"应用场景不同，采取的策略不同，有读者说kafka也可以配置同步刷盘，你可以研究一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217443,"ip_address":"","comment_id":9937,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"有一点我不明白：RocketMQ和Kafka究竟是什么方面上的设计不同，或者说是什么方向上的实现不同，造成了RocketMQ能更好地保证数据准确性，而Kafka能实现高吞吐量。希望各位大佬指明一点方向。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418264,"discussion_content":"应用场景不同，采取的策略不同，有读者说kafka也可以配置同步刷盘，你可以研究一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10714,"user_name":"鹅米豆发","can_delete":false,"product_type":"c1","uid":1017687,"ip_address":"","ucode":"98E8D911EE32DE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/57/645159ee.jpg","comment_is_top":false,"comment_ctime":1527665863,"is_pvip":false,"replies":[{"id":3410,"content":"你说的这种方式也可以，围绕kafka做二次开发","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527674809,"ip_address":"","comment_id":10714,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"个人浅见。\n       从四个方面考虑，第一非功能性诉求（性能，可靠性，容错性，一致性等），第二研发成本（设计复杂性，实现复杂性，前期人力投入，后期人力投入，短期重构风险，工期要求），第三运维成本（运营工具是否完善，纳入现有运维体系的难度等），第四软硬件成本。\n       例子中，工期相对紧迫，研发团队是中间件，我会倾向于首选Kafka，短期先满足需求，然后解决问题。跟方案3相比，Kafka在研发成本、软硬件成本、可靠性、性能等方面优势巨大。跟方案2相比，Kafka是开源的，也有各种跨语言的API，据此建立运维系统、纳入现有运维体系的难度，比自建消息中间件的研发成本低得多。","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418576,"discussion_content":"你说的这种方式也可以，围绕kafka做二次开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527674809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1670763,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","nickname":"FIRE","note":"","ucode":"85861D990FB3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546041,"discussion_content":"赞同","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642135610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9869,"user_name":"Geek_zbvt62","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg","comment_is_top":false,"comment_ctime":1527133839,"is_pvip":false,"replies":[{"id":3069,"content":"1. 很多监控和语言的机制相关，例如java要监控垃圾回收的情况，c++就没有这个事情。\n2. qps上万并不高，尤其对集群来说。\n3. 你可以细化，但方案2是可行的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527169320,"ip_address":"","comment_id":9869,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"\n\n\n怎么感觉最牛派应该选择Memcache?...\n这两周在做api gateway的调查研究，打算替换掉现在用的网关。因为事关重大，所以就用了360度的方法。很累很费脑子，像个重型武器，轻易不用。\n有个疑问：文中提到运维团队说自己没有Scala语言运维的经验。中间件的运维需要深入到语言层面嘛？都是JVM不就行嘛？是因为不了解要监控哪些指标嘛？\n表示对选择方案2表示不能理解。架构师解释，方案2缺点是性能，但目前业务性能要求不是非常高。可qps上万了还不算高么？\n我觉得方案2还有好多缺点没讨论出来了\n","like_count":8,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418576,"discussion_content":"你说的这种方式也可以，围绕kafka做二次开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527674809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1670763,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","nickname":"FIRE","note":"","ucode":"85861D990FB3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546041,"discussion_content":"赞同","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642135610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167174,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1577707675,"is_pvip":false,"replies":[{"id":65132,"content":"理解到位👍","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1577944962,"ip_address":"","comment_id":167174,"utype":1}],"discussion_count":1,"race_medal":1,"score":3,"product_id":100006601,"comment_content":"看完这篇文章，有两个地方感觉讲的好：\n1. 360度环评，具体的操作方式为：列出我们需要关注的质量属性点，然后分别从这些质量属性的维度去评估每个方案，再综合挑选适合当时情况的最优方案。\n\n这里的质量属性点，主要是非功能相关的，它和我们之前识别出来的系统复杂度是一脉相承的，我们在识别复杂度的时候，也是列出了所有的可能复杂度，然后再根据系统的需求对其逐一分析。这里可以直接使用已经识别出来的复杂度做架构方案的测评。\n\n2. 哪些人需要参加测评\n我之前的一个狭隘的理解是架构评审只需要引入老板、架构师和开发团队就可以了，忽略了测试和运维。做测评需要引入整个团队，大家站在不同的立场充分发表看法，对于设计一个成熟的架构非常重要！","like_count":6,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418234,"discussion_content":"1. 很多监控和语言的机制相关，例如java要监控垃圾回收的情况，c++就没有这个事情。\n2. qps上万并不高，尤其对集群来说。\n3. 你可以细化，但方案2是可行的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527169320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20662,"user_name":"文竹","can_delete":false,"product_type":"c1","uid":1103167,"ip_address":"","ucode":"74413B1975976B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/3f/80bf4841.jpg","comment_is_top":false,"comment_ctime":1534650185,"is_pvip":false,"replies":[{"id":7288,"content":"学以致用，知行合一","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1534738544,"ip_address":"","comment_id":20662,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"360度环评方法很棒，一个前提是寻找质量属性，架构师需要提前与相关人员（系统涉及到的所有人员）进行会议沟通，确定出质量属性。找出质量属性本身也具有挑战性。\n\n\nKafka在大数据领域用得比较多，对更新支持不是很好。RabbitMQ更适合面向业务的产品。具体使用哪个，根据场景结合360度环评可得出。","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479769,"discussion_content":"理解到位👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577944962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10455,"user_name":"成功","can_delete":false,"product_type":"c1","uid":1112099,"ip_address":"","ucode":"954B90AC92E8C3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/23/165d2f0e.jpg","comment_is_top":false,"comment_ctime":1527555725,"is_pvip":false,"replies":[{"id":3324,"content":"太简单了，这样不利于做架构设计，而且kafka也不是快餐，是Linkedin大规模用的","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527565908,"ip_address":"","comment_id":10455,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"KafKa是快餐，简单，方便，但对人体健康不可靠，Rocketmq是买原料自己下厨","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422354,"discussion_content":"学以致用，知行合一","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534738544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9855,"user_name":"周文童","can_delete":false,"product_type":"c1","uid":1005411,"ip_address":"","ucode":"0C65A0A67229FA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/63/be6db73e.jpg","comment_is_top":false,"comment_ctime":1527125844,"is_pvip":false,"replies":[{"id":3125,"content":"消息队列大家都懂，但是方案又好多，造轮子的也不少，所以挑选了这个例子","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217685,"ip_address":"","comment_id":9855,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"前浪微博这个选型案例太典型了","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418484,"discussion_content":"太简单了，这样不利于做架构设计，而且kafka也不是快餐，是Linkedin大规模用的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527565908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263422,"user_name":"Geek_9b9530","can_delete":false,"product_type":"c1","uid":2146381,"ip_address":"","ucode":"23498B3944F97C","user_header":"","comment_is_top":false,"comment_ctime":1606130328,"is_pvip":false,"replies":[{"id":95620,"content":"说得好，原文中的取舍只是符合原文背景的那个团队，如果你们团队的运维愿意学，愿意承担风险，用开源的也可以，这就是架构设计原则第一条合适原则的具体体现","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1606182615,"ip_address":"","comment_id":263422,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"为什么研发团队可以学习，而运维团队就不能学习了呢？是运维团队的工资低吗？  不用Kafka的话，是否能选择RabbitMQ, ActiveMQ， RocketMQ等，自研的话，成本和时间也是问题。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418229,"discussion_content":"消息队列大家都懂，但是方案又好多，造轮子的也不少，所以挑选了这个例子","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244052,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367563,"is_pvip":true,"replies":[{"id":90070,"content":"只能说你们的团队适合用rabbitmq，回忆一下架构设计三原则","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598686554,"ip_address":"","comment_id":244052,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"那还不如我们的rabbitmq，直接有管理界面😹","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510184,"discussion_content":"说得好，原文中的取舍只是符合原文背景的那个团队，如果你们团队的运维愿意学，愿意承担风险，用开源的也可以，这就是架构设计原则第一条合适原则的具体体现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606182615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":26852,"user_name":"奋斗心","can_delete":false,"product_type":"c1","uid":1247286,"ip_address":"","ucode":"06A195AB0B6570","user_header":"https://static001.geekbang.org/account/avatar/00/13/08/36/98be3d69.jpg","comment_is_top":false,"comment_ctime":1537763067,"is_pvip":false,"replies":[{"id":10019,"content":"RocketMQ可以理解为是Java版的kafka，两者比较类似😄","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1537951370,"ip_address":"","comment_id":26852,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"感觉方案一换成rocketmq，方案要比方案2好很多。省时、省力、省钱，扩展性也很好","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504461,"discussion_content":"只能说你们的团队适合用rabbitmq，回忆一下架构设计三原则","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598686554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":9937,"user_name":"Kyle","can_delete":false,"product_type":"c1","uid":1106079,"ip_address":"","ucode":"44198A0BEC5FB2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/9f/9259a6b9.jpg","comment_is_top":false,"comment_ctime":1527170984,"is_pvip":false,"replies":[{"id":3121,"content":"应用场景不同，采取的策略不同，有读者说kafka也可以配置同步刷盘，你可以研究一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217443,"ip_address":"","comment_id":9937,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100006601,"comment_content":"有一点我不明白：RocketMQ和Kafka究竟是什么方面上的设计不同，或者说是什么方向上的实现不同，造成了RocketMQ能更好地保证数据准确性，而Kafka能实现高吞吐量。希望各位大佬指明一点方向。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424740,"discussion_content":"RocketMQ可以理解为是Java版的kafka，两者比较类似😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537951370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271756,"user_name":"shihpeng","can_delete":false,"product_type":"c1","uid":1440698,"ip_address":"","ucode":"F7685343B88D29","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/ba/68bb346c.jpg","comment_is_top":false,"comment_ctime":1609781508,"is_pvip":false,"replies":[{"id":98583,"content":"需要与时俱进","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1609837663,"ip_address":"","comment_id":271756,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"现在是2021年了，Kafka中所皆知的已经用Java重写了一遍，文中方案1运维团队的反对意见以及结论是否该进行调整了？","like_count":2},{"had_liked":false,"id":226899,"user_name":"nero","can_delete":false,"product_type":"c1","uid":1078793,"ip_address":"","ucode":"038100ACA14B29","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/09/cf7513c8.jpg","comment_is_top":false,"comment_ctime":1592225558,"is_pvip":false,"replies":[{"id":83679,"content":"技术人员要破除对代码的迷信，代码不是一切","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1592302922,"ip_address":"","comment_id":226899,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"发现的比较晚了，自己之前也学了很多，看了很多课程。相比于老师这套课程来讲。虽然我才看到第12篇，但是我明白这其中的差异！那就是:&quot;之前大部分的问题，甚至问不出来的问题。这里都有很字面话的理解！&quot;。虽然没有代码。但是，比代码要明白的多！","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498405,"discussion_content":"技术人员要破除对代码的迷信，代码不是一切","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592302922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219730,"user_name":"CL","can_delete":false,"product_type":"c1","uid":1703267,"ip_address":"","ucode":"7792DF096B9474","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1wZ0Hian78KbhhojtyJwqmlc3jCG5p0cGjl25dhY2ymD3K2ibwASLicb9vBYFwuG5icNTjRq73D7NHg/132","comment_is_top":false,"comment_ctime":1590071429,"is_pvip":false,"replies":[{"id":81808,"content":"谢谢你的评价，加油👍✊","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1590640627,"ip_address":"","comment_id":219730,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"讲得太好了，而且你的这个优先级原则是普适的，不仅适合架构选择，也适合各种解决方案和商务决策。文中的例子太好了，非常生动。读后收获巨大，非常感谢作者的付出","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495925,"discussion_content":"谢谢你的评价，加油👍✊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590640627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30774,"user_name":"铁眉","can_delete":false,"product_type":"c1","uid":1055724,"ip_address":"","ucode":"D5AFFB5018345C","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/ec/96009e51.jpg","comment_is_top":false,"comment_ctime":1538994998,"is_pvip":false,"replies":[{"id":11222,"content":"开源是最适合你们的方案，另外一个就是买云计算","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1539132709,"ip_address":"","comment_id":30774,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"小公司第一优先级的是速度，后端开发才两枚，项目几个一起并行，请问除了来源的方案还能选啥","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426091,"discussion_content":"开源是最适合你们的方案，另外一个就是买云计算","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539132709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12774,"user_name":"zhouwm","can_delete":false,"product_type":"c1","uid":1100250,"ip_address":"","ucode":"874843F43B0EA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/da/22328e47.jpg","comment_is_top":false,"comment_ctime":1529026783,"is_pvip":false,"replies":[{"id":4259,"content":"kafka确实最稳定成熟，久经考验","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529058892,"ip_address":"","comment_id":12774,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"kafka同步刷盘同步复制早支持了，同步复制不会有乱序。kafka很稳定的，几个产品都用过，简单场景没啥问题。rocketmq开源版本貌似master挂掉后slave无法自动切换为master，可读不可写！阿里中间件博客有时候有点...","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419403,"discussion_content":"kafka确实最稳定成熟，久经考验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529058892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11925,"user_name":"SHLOMA","can_delete":false,"product_type":"c1","uid":1066000,"ip_address":"","ucode":"50C0FF9C3E0FFD","user_header":"https://static001.geekbang.org/account/avatar/00/10/44/10/7bfc89a8.jpg","comment_is_top":false,"comment_ctime":1528438166,"is_pvip":false,"replies":[{"id":3910,"content":"前后端分离指业务系统，中间件和基础系统不会用前后端分离","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528448753,"ip_address":"","comment_id":11925,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"李老师您好，请教一个问题，像这种大型高性能，高可用的系统是不是都是采用前后端分离模式开发的，不然像单体应用，一个war包部署在哪个节点呢","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419048,"discussion_content":"前后端分离指业务系统，中间件和基础系统不会用前后端分离","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528448753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11066,"user_name":"allwmh","can_delete":false,"product_type":"c1","uid":1031572,"ip_address":"","ucode":"8B596EEFE9083A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/94/d4499319.jpg","comment_is_top":false,"comment_ctime":1527817188,"is_pvip":false,"replies":[{"id":3480,"content":"运维成本是持续的，开发成本是短期的，而且中间件团队肯定愿意开发系统呀😂😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527818490,"ip_address":"","comment_id":11066,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"方案二 还是要投入精力开发一个消息队列，这个开发成本跟方案一的运维成本比较的话，不见得哪个更好。","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418700,"discussion_content":"运维成本是持续的，开发成本是短期的，而且中间件团队肯定愿意开发系统呀😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527818490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379359,"user_name":"鲁米","can_delete":false,"product_type":"c1","uid":1574008,"ip_address":"北京","ucode":"F8F23431723F25","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/78/37b46ba6.jpg","comment_is_top":false,"comment_ctime":1691809164,"is_pvip":false,"replies":[{"id":138221,"content":"找个稍微正规的环境有利于自己成长","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1691889211,"ip_address":"广东","comment_id":379359,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"大多时候都是研发或领导拍脑袋决定的，这样精心的评审需要依赖完善的制度。在一个办公室政治活跃的团队中还有拼“人品”。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625557,"discussion_content":"找个稍微正规的环境有利于自己成长","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691889211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311998,"user_name":"jian","can_delete":false,"product_type":"c1","uid":1185102,"ip_address":"","ucode":"21CDBBB8000F0C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/4e/4636a81d.jpg","comment_is_top":false,"comment_ctime":1631587508,"is_pvip":false,"replies":[{"id":113085,"content":"MySQL是关系数据库，为了保证ACID的约束，做了很多工作，例如锁、日志、B+树存储、事务等，而消息队列实际上不需要这些特性，只是一个读写消息操作，像kafka就是自己写磁盘文件，设计有利于消息读写的文件格式，性能肯定比MySQL要高不少。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1631624969,"ip_address":"","comment_id":311998,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"“中间件团队的研发人员认为这个方案比较简单，但部分研发人员对于这个方案的性能持怀疑态度，毕竟使用 MySQL 来存储消息数据，性能肯定不如使用文件系统；”，请问老师，为什么说MySQL 来存储消息数据，性能肯定不如使用文件系统？ ","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625557,"discussion_content":"找个稍微正规的环境有利于自己成长","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691889211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246925,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1599532515,"is_pvip":true,"replies":[{"id":91165,"content":"系统切换的成本太大了，尤其是中间件","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1599983483,"ip_address":"","comment_id":246925,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"看了那个 360 度环评表之后，专栏中的架构师选择了方案 2 MySQL 存储，可是我还是觉的方案 1  的 Kafka 更为合适。\n\n排除 Kafka 的原因有两条，一个是团队没有 Scala 背景的运维，一个是 Kafka 针对高性能日志传输，而不是业务消息的高可靠。\n\n我觉得运维 Kafka 未必需要对 Scala 有特别深入的理解，总不至于一上来就改源码。另外，Kafka 是成熟方案，所以可以找到的运维资源也比较多，包括文档和人才。\n\n对于高性能和高可靠，我其实是比较怀疑在 MySQL 基础上开发的消息队列的可靠性，MySQL 没问题，但是……\n\n那么更好的办法是不是可以考虑先用 Kafka 上线业务，然后同时开发 MySQL 集群方案？\n\n看了一下留言里面提到的 Kafka 和 RocketMQ 的区别，感觉 RocketMQ 是不是更合适后浪微博？\n\n财大气粗能力强，再加上还有业务和流量，这样的公司真是无人可挡。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526825,"discussion_content":"MySQL是关系数据库，为了保证ACID的约束，做了很多工作，例如锁、日志、B+树存储、事务等，而消息队列实际上不需要这些特性，只是一个读写消息操作，像kafka就是自己写磁盘文件，设计有利于消息读写的文件格式，性能肯定比MySQL要高不少。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631624969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271756,"user_name":"shihpeng","can_delete":false,"product_type":"c1","uid":1440698,"ip_address":"","ucode":"F7685343B88D29","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/ba/68bb346c.jpg","comment_is_top":false,"comment_ctime":1609781508,"is_pvip":false,"replies":[{"id":98583,"content":"需要与时俱进","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1609837663,"ip_address":"","comment_id":271756,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"现在是2021年了，Kafka中所皆知的已经用Java重写了一遍，文中方案1运维团队的反对意见以及结论是否该进行调整了？","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513035,"discussion_content":"需要与时俱进","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609837663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226899,"user_name":"nero","can_delete":false,"product_type":"c1","uid":1078793,"ip_address":"","ucode":"038100ACA14B29","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/09/cf7513c8.jpg","comment_is_top":false,"comment_ctime":1592225558,"is_pvip":false,"replies":[{"id":83679,"content":"技术人员要破除对代码的迷信，代码不是一切","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1592302922,"ip_address":"","comment_id":226899,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"发现的比较晚了，自己之前也学了很多，看了很多课程。相比于老师这套课程来讲。虽然我才看到第12篇，但是我明白这其中的差异！那就是:&quot;之前大部分的问题，甚至问不出来的问题。这里都有很字面话的理解！&quot;。虽然没有代码。但是，比代码要明白的多！","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513035,"discussion_content":"需要与时俱进","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609837663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219730,"user_name":"CL","can_delete":false,"product_type":"c1","uid":1703267,"ip_address":"","ucode":"7792DF096B9474","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1wZ0Hian78KbhhojtyJwqmlc3jCG5p0cGjl25dhY2ymD3K2ibwASLicb9vBYFwuG5icNTjRq73D7NHg/132","comment_is_top":false,"comment_ctime":1590071429,"is_pvip":false,"replies":[{"id":81808,"content":"谢谢你的评价，加油👍✊","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1590640627,"ip_address":"","comment_id":219730,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"讲得太好了，而且你的这个优先级原则是普适的，不仅适合架构选择，也适合各种解决方案和商务决策。文中的例子太好了，非常生动。读后收获巨大，非常感谢作者的付出","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498405,"discussion_content":"技术人员要破除对代码的迷信，代码不是一切","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592302922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30774,"user_name":"铁眉","can_delete":false,"product_type":"c1","uid":1055724,"ip_address":"","ucode":"D5AFFB5018345C","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/ec/96009e51.jpg","comment_is_top":false,"comment_ctime":1538994998,"is_pvip":false,"replies":[{"id":11222,"content":"开源是最适合你们的方案，另外一个就是买云计算","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1539132709,"ip_address":"","comment_id":30774,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"小公司第一优先级的是速度，后端开发才两枚，项目几个一起并行，请问除了来源的方案还能选啥","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495925,"discussion_content":"谢谢你的评价，加油👍✊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590640627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12774,"user_name":"zhouwm","can_delete":false,"product_type":"c1","uid":1100250,"ip_address":"","ucode":"874843F43B0EA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/da/22328e47.jpg","comment_is_top":false,"comment_ctime":1529026783,"is_pvip":false,"replies":[{"id":4259,"content":"kafka确实最稳定成熟，久经考验","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529058892,"ip_address":"","comment_id":12774,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"kafka同步刷盘同步复制早支持了，同步复制不会有乱序。kafka很稳定的，几个产品都用过，简单场景没啥问题。rocketmq开源版本貌似master挂掉后slave无法自动切换为master，可读不可写！阿里中间件博客有时候有点...","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426091,"discussion_content":"开源是最适合你们的方案，另外一个就是买云计算","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539132709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11925,"user_name":"SHLOMA","can_delete":false,"product_type":"c1","uid":1066000,"ip_address":"","ucode":"50C0FF9C3E0FFD","user_header":"https://static001.geekbang.org/account/avatar/00/10/44/10/7bfc89a8.jpg","comment_is_top":false,"comment_ctime":1528438166,"is_pvip":false,"replies":[{"id":3910,"content":"前后端分离指业务系统，中间件和基础系统不会用前后端分离","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528448753,"ip_address":"","comment_id":11925,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"李老师您好，请教一个问题，像这种大型高性能，高可用的系统是不是都是采用前后端分离模式开发的，不然像单体应用，一个war包部署在哪个节点呢","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419403,"discussion_content":"kafka确实最稳定成熟，久经考验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529058892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11066,"user_name":"allwmh","can_delete":false,"product_type":"c1","uid":1031572,"ip_address":"","ucode":"8B596EEFE9083A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/94/d4499319.jpg","comment_is_top":false,"comment_ctime":1527817188,"is_pvip":false,"replies":[{"id":3480,"content":"运维成本是持续的，开发成本是短期的，而且中间件团队肯定愿意开发系统呀😂😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527818490,"ip_address":"","comment_id":11066,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"方案二 还是要投入精力开发一个消息队列，这个开发成本跟方案一的运维成本比较的话，不见得哪个更好。","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419048,"discussion_content":"前后端分离指业务系统，中间件和基础系统不会用前后端分离","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528448753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379359,"user_name":"鲁米","can_delete":false,"product_type":"c1","uid":1574008,"ip_address":"北京","ucode":"F8F23431723F25","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/78/37b46ba6.jpg","comment_is_top":false,"comment_ctime":1691809164,"is_pvip":false,"replies":[{"id":138221,"content":"找个稍微正规的环境有利于自己成长","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1691889211,"ip_address":"广东","comment_id":379359,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"大多时候都是研发或领导拍脑袋决定的，这样精心的评审需要依赖完善的制度。在一个办公室政治活跃的团队中还有拼“人品”。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418700,"discussion_content":"运维成本是持续的，开发成本是短期的，而且中间件团队肯定愿意开发系统呀😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527818490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311998,"user_name":"jian","can_delete":false,"product_type":"c1","uid":1185102,"ip_address":"","ucode":"21CDBBB8000F0C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/4e/4636a81d.jpg","comment_is_top":false,"comment_ctime":1631587508,"is_pvip":false,"replies":[{"id":113085,"content":"MySQL是关系数据库，为了保证ACID的约束，做了很多工作，例如锁、日志、B+树存储、事务等，而消息队列实际上不需要这些特性，只是一个读写消息操作，像kafka就是自己写磁盘文件，设计有利于消息读写的文件格式，性能肯定比MySQL要高不少。","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1631624969,"ip_address":"","comment_id":311998,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"“中间件团队的研发人员认为这个方案比较简单，但部分研发人员对于这个方案的性能持怀疑态度，毕竟使用 MySQL 来存储消息数据，性能肯定不如使用文件系统；”，请问老师，为什么说MySQL 来存储消息数据，性能肯定不如使用文件系统？ ","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526825,"discussion_content":"MySQL是关系数据库，为了保证ACID的约束，做了很多工作，例如锁、日志、B+树存储、事务等，而消息队列实际上不需要这些特性，只是一个读写消息操作，像kafka就是自己写磁盘文件，设计有利于消息读写的文件格式，性能肯定比MySQL要高不少。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631624969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246925,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1599532515,"is_pvip":true,"replies":[{"id":91165,"content":"系统切换的成本太大了，尤其是中间件","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1599983483,"ip_address":"","comment_id":246925,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100006601,"comment_content":"看了那个 360 度环评表之后，专栏中的架构师选择了方案 2 MySQL 存储，可是我还是觉的方案 1  的 Kafka 更为合适。\n\n排除 Kafka 的原因有两条，一个是团队没有 Scala 背景的运维，一个是 Kafka 针对高性能日志传输，而不是业务消息的高可靠。\n\n我觉得运维 Kafka 未必需要对 Scala 有特别深入的理解，总不至于一上来就改源码。另外，Kafka 是成熟方案，所以可以找到的运维资源也比较多，包括文档和人才。\n\n对于高性能和高可靠，我其实是比较怀疑在 MySQL 基础上开发的消息队列的可靠性，MySQL 没问题，但是……\n\n那么更好的办法是不是可以考虑先用 Kafka 上线业务，然后同时开发 MySQL 集群方案？\n\n看了一下留言里面提到的 Kafka 和 RocketMQ 的区别，感觉 RocketMQ 是不是更合适后浪微博？\n\n财大气粗能力强，再加上还有业务和流量，这样的公司真是无人可挡。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505261,"discussion_content":"系统切换的成本太大了，尤其是中间件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599983483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245646,"user_name":"开心水牛","can_delete":false,"product_type":"c1","uid":1142095,"ip_address":"","ucode":"34084C883A1625","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/4f/e3158018.jpg","comment_is_top":false,"comment_ctime":1599015779,"is_pvip":false,"replies":[{"id":90647,"content":"其实都是面向Kpi选型������������������","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1599459706,"ip_address":"","comment_id":245646,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"从公司规模角度来看，三种选型也对应了三种体量的公司。初创公司，需求是快速迭代和上线，选kafka；一般体量的公司有完整的运维测试体系，但自研方面有欠缺，选MySQL；对于大厂来说，自研方面没问题，KPI也好看O(∩_∩)O","like_count":1},{"had_liked":false,"id":244053,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367898,"is_pvip":true,"replies":[{"id":90069,"content":"开发连线上环境的访问权限都没有呀������为了这个改整个运维体系代价太大了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598686517,"ip_address":"","comment_id":244053,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"这里有个痛点，运维和开发和使用的人不同团队。\n一个这么简单的消息队列竟然还要中间件团队，运维只熟悉mysql，那开发没底气说自己运维吗，这么低的量级，搞个基本操作页面就ok了，监控有promethus啊。kafka不合适还有rabbitmq啊，提供了管理界面。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504940,"discussion_content":"其实都是面向Kpi选型������������������","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599459706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13011,"user_name":"阳光","can_delete":false,"product_type":"c1","uid":1151183,"ip_address":"","ucode":"2AE92E2AD77E6F","user_header":"","comment_is_top":false,"comment_ctime":1529293468,"is_pvip":false,"replies":[{"id":4344,"content":"性能测试","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529376816,"ip_address":"","comment_id":13011,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"TPS、QPS如何测量？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504462,"discussion_content":"开发连线上环境的访问权限都没有呀������为了这个改整个运维体系代价太大了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598686517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11300,"user_name":"DREAM-奔跑","can_delete":false,"product_type":"c1","uid":1009654,"ip_address":"","ucode":"D9A6554FA5E4A0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f6/b970413d.jpg","comment_is_top":false,"comment_ctime":1528037082,"is_pvip":false,"replies":[{"id":3618,"content":"有钱可以任性😂😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528081253,"ip_address":"","comment_id":11300,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"主要还是阿里的业务特点所决定，阿里对数据的可靠性要求高、阿里业务复杂度高，同时阿里人多、钱多、技术牛逼人多。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419500,"discussion_content":"性能测试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529376816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11080,"user_name":"arebya","can_delete":false,"product_type":"c1","uid":1142802,"ip_address":"","ucode":"074ECE8D6C1874","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/12/aa74da82.jpg","comment_is_top":false,"comment_ctime":1527824447,"is_pvip":false,"replies":[{"id":3522,"content":"你再回过头看看架构设计三原则，然后结合这个案例体会一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527838083,"ip_address":"","comment_id":11080,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"方案二直接用MySQL，感觉会存在以下问题:1.读写性能问题，不方便优化2.存储问题，是否需要分库分表，是否需要多主从，数据同步问题解决3.扩展性，需要提前期定义好数据库表字段之类，如业务扩展涉及到在线schema变更，不太方便。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418784,"discussion_content":"有钱可以任性😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528081253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10007,"user_name":"Up","can_delete":false,"product_type":"c1","uid":1032969,"ip_address":"","ucode":"3AACE765021AB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c3/09/ee1b7ac0.jpg","comment_is_top":false,"comment_ctime":1527216736,"is_pvip":false,"replies":[{"id":3115,"content":"“合适原则”的鲜明体现😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217192,"ip_address":"","comment_id":10007,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"首先分析下阿里对消息中间件的需求：\n1.消息的可靠性，也就是消息不丢失、不重发\n2.面向业务的消息，涉及到消费顺序问题\n3.在上面2点的基础上，保证高性能\n基于以上分析，再看kafka，kafka主要优势是高性能，在高可靠性和业务消息上并不能满足阿里的需求，所以阿里选择了自己开发。kafka更适用于日志的场景；业务场景RocketMQ支持消息路由，保证单个订单业务消息顺序，设计时以高可靠性为主，在这个基础上再去提高性能。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418708,"discussion_content":"你再回过头看看架构设计三原则，然后结合这个案例体会一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527838083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395599,"user_name":"凡尘","can_delete":false,"product_type":"c1","uid":1605845,"ip_address":"上海","ucode":"6364497BC6C200","user_header":"https://static001.geekbang.org/account/avatar/00/18/80/d5/43e4bef0.jpg","comment_is_top":false,"comment_ctime":1731375203,"is_pvip":false,"replies":[{"id":143810,"content":"正解","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1733216985,"ip_address":"广东","comment_id":395599,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"第一步认识复杂度  就是理清需求，确认好问题\n第二步设计备选方案  就是给出几个预执行的解决方法\n第三步评估选择备选方案  就是综合评估下用那种解决方法去解决问题需求","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418305,"discussion_content":"“合适原则”的鲜明体现😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354389,"user_name":"joyafa","can_delete":false,"product_type":"c1","uid":1035371,"ip_address":"广东","ucode":"A2EB0E433B1919","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/6b/7f66d425.jpg","comment_is_top":false,"comment_ctime":1660351989,"is_pvip":false,"replies":[{"id":129488,"content":"这个我也不是很清楚具体指什么","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1661763375,"ip_address":"广东","comment_id":354389,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"评论中有说到Kafka运维很难？有人能详细说下嘛？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":654658,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1733216985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338154,"user_name":"白色熊猫","can_delete":false,"product_type":"c1","uid":1177721,"ip_address":"","ucode":"59755C1A0FDAB6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL83VWyA7gIO5vf583THNlK2JjDZAQniaOGWotaajTZyw2jAic8SxF8j495Xj1DGV3x0Xv2iaOQrYibPw/132","comment_is_top":false,"comment_ctime":1647326275,"is_pvip":false,"replies":[{"id":123686,"content":"学会举一反三，只有一个研发团队那就让负责不同职责的人员来一起评估","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1647476773,"ip_address":"","comment_id":338154,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"咋又这么多的团队.如果只有一个研发团队的时候咋办...","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585684,"discussion_content":"这个我也不是很清楚具体指什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661763376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335360,"user_name":"新启程","can_delete":false,"product_type":"c1","uid":1070840,"ip_address":"","ucode":"920469DFF0366C","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/f8/5cc87778.jpg","comment_is_top":false,"comment_ctime":1645487123,"is_pvip":false,"replies":[{"id":122739,"content":"正解","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1645754934,"ip_address":"","comment_id":335360,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"学习心得:\n评估方案时不能要做出360环评表来辅助决策，常见的质量指标有 性能，可用性，硬件成本，项目投入，维护成本，复杂性，安全性，可扩展性等多个方面进行评估，根据现有团队和业务情况按优先级选择，最终还是要满足 简单原则 和 合适原则。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556690,"discussion_content":"学会举一反三，只有一个研发团队那就让负责不同职责的人员来一起评估","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647476773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245646,"user_name":"开心水牛","can_delete":false,"product_type":"c1","uid":1142095,"ip_address":"","ucode":"34084C883A1625","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/4f/e3158018.jpg","comment_is_top":false,"comment_ctime":1599015779,"is_pvip":false,"replies":[{"id":90647,"content":"其实都是面向Kpi选型������������������","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1599459706,"ip_address":"","comment_id":245646,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"从公司规模角度来看，三种选型也对应了三种体量的公司。初创公司，需求是快速迭代和上线，选kafka；一般体量的公司有完整的运维测试体系，但自研方面有欠缺，选MySQL；对于大厂来说，自研方面没问题，KPI也好看O(∩_∩)O","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504940,"discussion_content":"其实都是面向Kpi选型������������������","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599459706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244053,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367898,"is_pvip":true,"replies":[{"id":90069,"content":"开发连线上环境的访问权限都没有呀������为了这个改整个运维体系代价太大了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1598686517,"ip_address":"","comment_id":244053,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"这里有个痛点，运维和开发和使用的人不同团队。\n一个这么简单的消息队列竟然还要中间件团队，运维只熟悉mysql，那开发没底气说自己运维吗，这么低的量级，搞个基本操作页面就ok了，监控有promethus啊。kafka不合适还有rabbitmq啊，提供了管理界面。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504462,"discussion_content":"开发连线上环境的访问权限都没有呀������为了这个改整个运维体系代价太大了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598686517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13011,"user_name":"阳光","can_delete":false,"product_type":"c1","uid":1151183,"ip_address":"","ucode":"2AE92E2AD77E6F","user_header":"","comment_is_top":false,"comment_ctime":1529293468,"is_pvip":false,"replies":[{"id":4344,"content":"性能测试","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1529376816,"ip_address":"","comment_id":13011,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"TPS、QPS如何测量？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419500,"discussion_content":"性能测试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529376816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11300,"user_name":"DREAM-奔跑","can_delete":false,"product_type":"c1","uid":1009654,"ip_address":"","ucode":"D9A6554FA5E4A0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f6/b970413d.jpg","comment_is_top":false,"comment_ctime":1528037082,"is_pvip":false,"replies":[{"id":3618,"content":"有钱可以任性😂😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1528081253,"ip_address":"","comment_id":11300,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"主要还是阿里的业务特点所决定，阿里对数据的可靠性要求高、阿里业务复杂度高，同时阿里人多、钱多、技术牛逼人多。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418784,"discussion_content":"有钱可以任性😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528081253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":11080,"user_name":"arebya","can_delete":false,"product_type":"c1","uid":1142802,"ip_address":"","ucode":"074ECE8D6C1874","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/12/aa74da82.jpg","comment_is_top":false,"comment_ctime":1527824447,"is_pvip":false,"replies":[{"id":3522,"content":"你再回过头看看架构设计三原则，然后结合这个案例体会一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527838083,"ip_address":"","comment_id":11080,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"方案二直接用MySQL，感觉会存在以下问题:1.读写性能问题，不方便优化2.存储问题，是否需要分库分表，是否需要多主从，数据同步问题解决3.扩展性，需要提前期定义好数据库表字段之类，如业务扩展涉及到在线schema变更，不太方便。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418708,"discussion_content":"你再回过头看看架构设计三原则，然后结合这个案例体会一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527838083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10007,"user_name":"Up","can_delete":false,"product_type":"c1","uid":1032969,"ip_address":"","ucode":"3AACE765021AB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c3/09/ee1b7ac0.jpg","comment_is_top":false,"comment_ctime":1527216736,"is_pvip":false,"replies":[{"id":3115,"content":"“合适原则”的鲜明体现😂","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1527217192,"ip_address":"","comment_id":10007,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"首先分析下阿里对消息中间件的需求：\n1.消息的可靠性，也就是消息不丢失、不重发\n2.面向业务的消息，涉及到消费顺序问题\n3.在上面2点的基础上，保证高性能\n基于以上分析，再看kafka，kafka主要优势是高性能，在高可靠性和业务消息上并不能满足阿里的需求，所以阿里选择了自己开发。kafka更适用于日志的场景；业务场景RocketMQ支持消息路由，保证单个订单业务消息顺序，设计时以高可靠性为主，在这个基础上再去提高性能。","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":418305,"discussion_content":"“合适原则”的鲜明体现😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1527217192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395599,"user_name":"凡尘","can_delete":false,"product_type":"c1","uid":1605845,"ip_address":"上海","ucode":"6364497BC6C200","user_header":"https://static001.geekbang.org/account/avatar/00/18/80/d5/43e4bef0.jpg","comment_is_top":false,"comment_ctime":1731375203,"is_pvip":false,"replies":[{"id":143810,"content":"正解","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1733216985,"ip_address":"广东","comment_id":395599,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"第一步认识复杂度  就是理清需求，确认好问题\n第二步设计备选方案  就是给出几个预执行的解决方法\n第三步评估选择备选方案  就是综合评估下用那种解决方法去解决问题需求","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":654658,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1733216985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354389,"user_name":"joyafa","can_delete":false,"product_type":"c1","uid":1035371,"ip_address":"广东","ucode":"A2EB0E433B1919","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/6b/7f66d425.jpg","comment_is_top":false,"comment_ctime":1660351989,"is_pvip":false,"replies":[{"id":129488,"content":"这个我也不是很清楚具体指什么","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1661763375,"ip_address":"广东","comment_id":354389,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"评论中有说到Kafka运维很难？有人能详细说下嘛？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585684,"discussion_content":"这个我也不是很清楚具体指什么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661763376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338154,"user_name":"白色熊猫","can_delete":false,"product_type":"c1","uid":1177721,"ip_address":"","ucode":"59755C1A0FDAB6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL83VWyA7gIO5vf583THNlK2JjDZAQniaOGWotaajTZyw2jAic8SxF8j495Xj1DGV3x0Xv2iaOQrYibPw/132","comment_is_top":false,"comment_ctime":1647326275,"is_pvip":false,"replies":[{"id":123686,"content":"学会举一反三，只有一个研发团队那就让负责不同职责的人员来一起评估","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1647476773,"ip_address":"","comment_id":338154,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"咋又这么多的团队.如果只有一个研发团队的时候咋办...","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556690,"discussion_content":"学会举一反三，只有一个研发团队那就让负责不同职责的人员来一起评估","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647476773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335360,"user_name":"新启程","can_delete":false,"product_type":"c1","uid":1070840,"ip_address":"","ucode":"920469DFF0366C","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/f8/5cc87778.jpg","comment_is_top":false,"comment_ctime":1645487123,"is_pvip":false,"replies":[{"id":122739,"content":"正解","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1645754934,"ip_address":"","comment_id":335360,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100006601,"comment_content":"学习心得:\n评估方案时不能要做出360环评表来辅助决策，常见的质量指标有 性能，可用性，硬件成本，项目投入，维护成本，复杂性，安全性，可扩展性等多个方面进行评估，根据现有团队和业务情况按优先级选择，最终还是要满足 简单原则 和 合适原则。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553157,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645754934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333749,"user_name":"pengfei","can_delete":false,"product_type":"c1","uid":1601894,"ip_address":"","ucode":"AE40728A6C5FBF","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZEzDAYAeurDQ1gKOZWh0HmMIEsqIuQXOHzVIKicPbsK5uC8cYLibLKaQfPXUSI5cpqNhiah69TSFLg/132","comment_is_top":false,"comment_ctime":1644496766,"is_pvip":false,"replies":[{"id":121926,"content":"你说的就是典型的过度设计，演化原则不是指考虑所有的变化，而是优先满足当前的需求，后面等大的变化真的发生的时候通过演进来应对。\n\n事实上你说的这个变化，UC后来技术体系全部切换阿里，就不单是消息队列变化了，所有基础设施都变了，业务模块不可能无感，所以你所说的抽象和封装意义不大。","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1644543411,"ip_address":"","comment_id":333749,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"系统演化原则不得不考虑，如后续要升级改造消息队列系统，而你的消息又被若干个业务方订阅消费，要升级得所有模块一块干，模块多了就很难了。所以这个方案里，得考虑生产、消费api的抽象化，实现变更消息队列的具体实现时，业务模块无感且平滑过渡。","like_count":0},{"had_liked":false,"id":311537,"user_name":"青年祭司","can_delete":false,"product_type":"c1","uid":1259156,"ip_address":"","ucode":"C88EDAE3FF09AE","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/94/0b969588.jpg","comment_is_top":false,"comment_ctime":1631273109,"is_pvip":false,"replies":[{"id":112898,"content":"自己去找资料对比一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1631325759,"ip_address":"","comment_id":311537,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师，rabbitmq和这两个有什么区别","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550428,"discussion_content":"你说的就是典型的过度设计，演化原则不是指考虑所有的变化，而是优先满足当前的需求，后面等大的变化真的发生的时候通过演进来应对。\n\n事实上你说的这个变化，UC后来技术体系全部切换阿里，就不单是消息队列变化了，所有基础设施都变了，业务模块不可能无感，所以你所说的抽象和封装意义不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644543412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283500,"user_name":"菠萝吹雪—Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1615800314,"is_pvip":false,"replies":[{"id":102857,"content":"架构的知识密度确实很大，我最近写PPT的时候才突然意识到，以前我都觉得架构设计很简单，哈哈","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1615814728,"ip_address":"","comment_id":283500,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"马上老师的业务架构训练营要开课了，提前预习预习，自己知识太欠缺了","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526652,"discussion_content":"自己去找资料对比一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631325759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281992,"user_name":"文俊杰","can_delete":false,"product_type":"c1","uid":1015983,"ip_address":"","ucode":"8045C05DC73442","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/af/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1615004649,"is_pvip":false,"replies":[{"id":102419,"content":"哪里说了kafka不是高可用 ？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1615079823,"ip_address":"","comment_id":281992,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"不是说kafka不也是高可用么？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517055,"discussion_content":"架构的知识密度确实很大，我最近写PPT的时候才突然意识到，以前我都觉得架构设计很简单，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615814728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280709,"user_name":"leesper","can_delete":false,"product_type":"c1","uid":1351104,"ip_address":"","ucode":"CC76320571BECA","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg","comment_is_top":false,"comment_ctime":1614324234,"is_pvip":false,"replies":[{"id":101914,"content":"文中不是给了一个么？你觉得还不够的话，可以自己补充","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1614350911,"ip_address":"","comment_id":280709,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"华哥，能给一个完整的360度环评表吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516576,"discussion_content":"哪里说了kafka不是高可用 ？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615079823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251414,"user_name":"Xiao","can_delete":false,"product_type":"c1","uid":1179212,"ip_address":"","ucode":"71FFCCEEDE09E1","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/4c/46eb517a.jpg","comment_is_top":false,"comment_ctime":1601538079,"is_pvip":false,"replies":[{"id":92109,"content":"参考架构设计原则第一条合适原则","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1602083274,"ip_address":"","comment_id":251414,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"之前在MT的时候，boss说过：什么是好的架构？就是团队成员80%的成员都能很好的维护扩展，就是好的架构。随着工作时间的推移，越来越理解这句话的含义。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516189,"discussion_content":"文中不是给了一个么？你觉得还不够的话，可以自己补充","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614350911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191136,"user_name":"阿恒","can_delete":false,"product_type":"c1","uid":1100238,"ip_address":"","ucode":"59434AB37236E5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/ce/cc85c6c3.jpg","comment_is_top":false,"comment_ctime":1584748306,"is_pvip":false,"replies":[{"id":74890,"content":"加油","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1585540632,"ip_address":"","comment_id":191136,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"之前买的，一直进行学习。现在学起来刚觉很受用","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506484,"discussion_content":"参考架构设计原则第一条合适原则","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602083274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71274,"user_name":"展飞","can_delete":false,"product_type":"c1","uid":1265637,"ip_address":"","ucode":"8799F60131C291","user_header":"https://static001.geekbang.org/account/avatar/00/13/4f/e5/381ca282.jpg","comment_is_top":false,"comment_ctime":1551315269,"is_pvip":false,"replies":[{"id":27902,"content":"说说你认为的重点是什么？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1552624566,"ip_address":"","comment_id":71274,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"感觉排除方案1的理由时，有些敷衍了事，说不到重点上去。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488118,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585540632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52655,"user_name":"Tracy","can_delete":false,"product_type":"c1","uid":1017722,"ip_address":"","ucode":"51F2824393A92A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/7a/700e1846.jpg","comment_is_top":false,"comment_ctime":1545467792,"is_pvip":false,"replies":[{"id":19166,"content":"你可以尝试细化，这个只是案例","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1545480377,"ip_address":"","comment_id":52655,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"缺少功能维度的考虑","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441084,"discussion_content":"说说你认为的重点是什么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552624566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14334,"user_name":"Chang","can_delete":false,"product_type":"c1","uid":1125147,"ip_address":"","ucode":"CE2050F1BE00DB","user_header":"https://static001.geekbang.org/account/avatar/00/11/2b/1b/e88e33ba.jpg","comment_is_top":false,"comment_ctime":1530316420,"is_pvip":false,"replies":[{"id":4885,"content":"上网一搜就看到了，开源了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1530519914,"ip_address":"","comment_id":14334,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"弱弱问一句，RoctetMQ开源吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433940,"discussion_content":"你可以尝试细化，这个只是案例","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545480377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333749,"user_name":"pengfei","can_delete":false,"product_type":"c1","uid":1601894,"ip_address":"","ucode":"AE40728A6C5FBF","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZEzDAYAeurDQ1gKOZWh0HmMIEsqIuQXOHzVIKicPbsK5uC8cYLibLKaQfPXUSI5cpqNhiah69TSFLg/132","comment_is_top":false,"comment_ctime":1644496766,"is_pvip":false,"replies":[{"id":121926,"content":"你说的就是典型的过度设计，演化原则不是指考虑所有的变化，而是优先满足当前的需求，后面等大的变化真的发生的时候通过演进来应对。\n\n事实上你说的这个变化，UC后来技术体系全部切换阿里，就不单是消息队列变化了，所有基础设施都变了，业务模块不可能无感，所以你所说的抽象和封装意义不大。","user_name":"作者回复","user_name_real":"编辑","uid":1098920,"ctime":1644543411,"ip_address":"","comment_id":333749,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"系统演化原则不得不考虑，如后续要升级改造消息队列系统，而你的消息又被若干个业务方订阅消费，要升级得所有模块一块干，模块多了就很难了。所以这个方案里，得考虑生产、消费api的抽象化，实现变更消息队列的具体实现时，业务模块无感且平滑过渡。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550428,"discussion_content":"你说的就是典型的过度设计，演化原则不是指考虑所有的变化，而是优先满足当前的需求，后面等大的变化真的发生的时候通过演进来应对。\n\n事实上你说的这个变化，UC后来技术体系全部切换阿里，就不单是消息队列变化了，所有基础设施都变了，业务模块不可能无感，所以你所说的抽象和封装意义不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644543412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311537,"user_name":"青年祭司","can_delete":false,"product_type":"c1","uid":1259156,"ip_address":"","ucode":"C88EDAE3FF09AE","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/94/0b969588.jpg","comment_is_top":false,"comment_ctime":1631273109,"is_pvip":false,"replies":[{"id":112898,"content":"自己去找资料对比一下","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1631325759,"ip_address":"","comment_id":311537,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"老师，rabbitmq和这两个有什么区别","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526652,"discussion_content":"自己去找资料对比一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631325759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283500,"user_name":"菠萝吹雪—Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1615800314,"is_pvip":false,"replies":[{"id":102857,"content":"架构的知识密度确实很大，我最近写PPT的时候才突然意识到，以前我都觉得架构设计很简单，哈哈","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1615814728,"ip_address":"","comment_id":283500,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"马上老师的业务架构训练营要开课了，提前预习预习，自己知识太欠缺了","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517055,"discussion_content":"架构的知识密度确实很大，我最近写PPT的时候才突然意识到，以前我都觉得架构设计很简单，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615814728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281992,"user_name":"文俊杰","can_delete":false,"product_type":"c1","uid":1015983,"ip_address":"","ucode":"8045C05DC73442","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/af/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1615004649,"is_pvip":false,"replies":[{"id":102419,"content":"哪里说了kafka不是高可用 ？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1615079823,"ip_address":"","comment_id":281992,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"不是说kafka不也是高可用么？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516576,"discussion_content":"哪里说了kafka不是高可用 ？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615079823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280709,"user_name":"leesper","can_delete":false,"product_type":"c1","uid":1351104,"ip_address":"","ucode":"CC76320571BECA","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg","comment_is_top":false,"comment_ctime":1614324234,"is_pvip":false,"replies":[{"id":101914,"content":"文中不是给了一个么？你觉得还不够的话，可以自己补充","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1614350911,"ip_address":"","comment_id":280709,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"华哥，能给一个完整的360度环评表吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516189,"discussion_content":"文中不是给了一个么？你觉得还不够的话，可以自己补充","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614350911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251414,"user_name":"Xiao","can_delete":false,"product_type":"c1","uid":1179212,"ip_address":"","ucode":"71FFCCEEDE09E1","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/4c/46eb517a.jpg","comment_is_top":false,"comment_ctime":1601538079,"is_pvip":false,"replies":[{"id":92109,"content":"参考架构设计原则第一条合适原则","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1602083274,"ip_address":"","comment_id":251414,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"之前在MT的时候，boss说过：什么是好的架构？就是团队成员80%的成员都能很好的维护扩展，就是好的架构。随着工作时间的推移，越来越理解这句话的含义。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506484,"discussion_content":"参考架构设计原则第一条合适原则","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602083274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191136,"user_name":"阿恒","can_delete":false,"product_type":"c1","uid":1100238,"ip_address":"","ucode":"59434AB37236E5","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/ce/cc85c6c3.jpg","comment_is_top":false,"comment_ctime":1584748306,"is_pvip":false,"replies":[{"id":74890,"content":"加油","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1585540632,"ip_address":"","comment_id":191136,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"之前买的，一直进行学习。现在学起来刚觉很受用","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488118,"discussion_content":"加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585540632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71274,"user_name":"展飞","can_delete":false,"product_type":"c1","uid":1265637,"ip_address":"","ucode":"8799F60131C291","user_header":"https://static001.geekbang.org/account/avatar/00/13/4f/e5/381ca282.jpg","comment_is_top":false,"comment_ctime":1551315269,"is_pvip":false,"replies":[{"id":27902,"content":"说说你认为的重点是什么？","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1552624566,"ip_address":"","comment_id":71274,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"感觉排除方案1的理由时，有些敷衍了事，说不到重点上去。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441084,"discussion_content":"说说你认为的重点是什么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552624566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52655,"user_name":"Tracy","can_delete":false,"product_type":"c1","uid":1017722,"ip_address":"","ucode":"51F2824393A92A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/7a/700e1846.jpg","comment_is_top":false,"comment_ctime":1545467792,"is_pvip":false,"replies":[{"id":19166,"content":"你可以尝试细化，这个只是案例","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1545480377,"ip_address":"","comment_id":52655,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"缺少功能维度的考虑","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433940,"discussion_content":"你可以尝试细化，这个只是案例","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545480377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":14334,"user_name":"Chang","can_delete":false,"product_type":"c1","uid":1125147,"ip_address":"","ucode":"CE2050F1BE00DB","user_header":"https://static001.geekbang.org/account/avatar/00/11/2b/1b/e88e33ba.jpg","comment_is_top":false,"comment_ctime":1530316420,"is_pvip":false,"replies":[{"id":4885,"content":"上网一搜就看到了，开源了","user_name":"作者回复","user_name_real":"华仔","uid":1098920,"ctime":1530519914,"ip_address":"","comment_id":14334,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100006601,"comment_content":"弱弱问一句，RoctetMQ开源吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419969,"discussion_content":"上网一搜就看到了，开源了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530519914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":10245,"user_name":"森林","can_delete":false,"product_type":"c1","uid":1071920,"ip_address":"","ucode":"53BD05633B77B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/30/9dcf35ff.jpg","comment_is_top":false,"comment_ctime":1527410640,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka早已不是只能存日志异步刷盘的kafka","like_count":4},{"had_liked":false,"id":9950,"user_name":"悬叶","can_delete":false,"product_type":"c1","uid":1097937,"ip_address":"","ucode":"3147D8D0F47F7A","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/d1/21b6e0e8.jpg","comment_is_top":false,"comment_ctime":1527176450,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka和rocketmq团队在设计各自中间件时的出发点就不同，kafka要解决的是海量消息传递问题，主要场景是日志，rocketmq要解决的是业务问题，如通过消息机制，分解事务，在业务系统间消息传递，如此在保证最终结果前提下显著提高整体并发。同步刷盘不限容量严格时间顺序等特点是很力的说明。","like_count":3},{"had_liked":false,"id":9854,"user_name":"星火燎原","can_delete":false,"product_type":"c1","uid":1101373,"ip_address":"","ucode":"15AD8E3006E107","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/3d/385b8263.jpg","comment_is_top":false,"comment_ctime":1527125756,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"有个问题 卡夫卡我觉得也可以属于可靠性消息队列才对","like_count":3},{"had_liked":false,"id":127718,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1566784164,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"课前思考及问题\n1：评估和选择备选方案？\n哈哈，这节有趣啦！选择备选方案的前提，必须先给出若干种备选方案。这一步我觉得还是挺难的，解决同一个问题，要给出几种方案，给出的时候也许这种方案有什么特点就是已经心知肚明的，没有完美的存在有些资源的协调估计就不是架构师能自己拍板的啦！\n2：评估备选方案？\n我认为，屁股决定脑袋，用架构的屁股决定的话，架构设计三原则，也可用作架构评估三原则。\n\n客户思考及问题\n1：读完第一感受是，学完华仔的这个专栏也不可能马上成为架构师，甚至过上几年概率也不大。因为架构师的核心工作在于判断、权衡、取舍，没有足够的经验积累和业务、技术的沉淀，是很难说出一个技术或方案的优劣的，而且说出还不止一个，是对比的说，这个知识的深度和广度都非一朝一夕的事。当然，梦想还是要有的，毕竟她总归能实现。\n\n2：kafka和rocketMQ这两个都没用过，不过倒是学习过一下下，我们也是自研的，有专门的技术团队也来开发和维护，业务开发只管用就行，如果有新的需求提出来他们负责，评估是否支持。\nkafka和rocketMQ有什么区别，百度一下就清楚了。为什么阿里要自研？即使不了解这两个东西，估计也是能推测出来的。\n2-1：最重要的是有些特性kafka提供不了\n2-2：长期来考虑，更可控运维研发使用方便，易演化\n2-3：技术OK，技术不行想自研，也不行呀\n2-4：不差钱，人力、物力都不构成约束条件\n2-5：公司特别是上峰认识到技术的重要性，肯花人力、物力、财力，去支持自研","like_count":2},{"had_liked":false,"id":10557,"user_name":"高峰","can_delete":false,"product_type":"c1","uid":1104803,"ip_address":"","ucode":"BA43686A623783","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/a3/9dafa4a3.jpg","comment_is_top":false,"comment_ctime":1527595397,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"RocketMQ能保证消息不丢失，这是业务系统做重要的，所以我也选RocketMQ的双主来做业务系统的消息队列","like_count":2},{"had_liked":false,"id":10064,"user_name":"Bob","can_delete":false,"product_type":"c1","uid":1007005,"ip_address":"","ucode":"1A67FF9DC1FE1B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/9d/4ee1faf4.jpg","comment_is_top":false,"comment_ctime":1527252432,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"如果对QPS要求不高，又要求消息可靠传输，市面上没有成熟的消息队列解决方案吗，如基于JMS标准的某个实现？","like_count":2},{"had_liked":false,"id":247725,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1599807877,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"Kafka适合日志处理；RocketMQ适合业务处理。打卡","like_count":1},{"had_liked":false,"id":42069,"user_name":"黄隆","can_delete":false,"product_type":"c1","uid":1095130,"ip_address":"","ucode":"3674CDC7663042","user_header":"https://static001.geekbang.org/account/avatar/00/10/b5/da/016731f1.jpg","comment_is_top":false,"comment_ctime":1542901960,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"rocketmq，支持事务消息，支持可靠存储，支持push和pull。能满足阿里的庞大需求","like_count":1},{"had_liked":false,"id":9931,"user_name":"Mike Wang","can_delete":false,"product_type":"c1","uid":1111341,"ip_address":"","ucode":"4A7268451FFEB6","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/2d/8a0bd9f1.jpg","comment_is_top":false,"comment_ctime":1527169090,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka项目初期不稳定，应用场景不满足业务需求；Kafka未来走向不可控；借鉴并重新实现rocketmq在阿里的业务规模是划算的，毕竟Kafka的诞生也是如此。","like_count":1},{"had_liked":false,"id":249635,"user_name":"Lee","can_delete":false,"product_type":"c1","uid":1085120,"ip_address":"","ucode":"158E29C62897CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/c0/7e70b689.jpg","comment_is_top":false,"comment_ctime":1600736786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"高可靠性和高性能两极化是相抵触的，很多情况是取得一个好的平衡，x86架构及冯诺依曼架构决定很多基础中间件、平台工具都有其产生的历史背景，开始要解决的核心问题侧重点不同","like_count":0},{"had_liked":false,"id":10245,"user_name":"森林","can_delete":false,"product_type":"c1","uid":1071920,"ip_address":"","ucode":"53BD05633B77B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/30/9dcf35ff.jpg","comment_is_top":false,"comment_ctime":1527410640,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka早已不是只能存日志异步刷盘的kafka","like_count":4},{"had_liked":false,"id":9950,"user_name":"悬叶","can_delete":false,"product_type":"c1","uid":1097937,"ip_address":"","ucode":"3147D8D0F47F7A","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/d1/21b6e0e8.jpg","comment_is_top":false,"comment_ctime":1527176450,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka和rocketmq团队在设计各自中间件时的出发点就不同，kafka要解决的是海量消息传递问题，主要场景是日志，rocketmq要解决的是业务问题，如通过消息机制，分解事务，在业务系统间消息传递，如此在保证最终结果前提下显著提高整体并发。同步刷盘不限容量严格时间顺序等特点是很力的说明。","like_count":3},{"had_liked":false,"id":9854,"user_name":"星火燎原","can_delete":false,"product_type":"c1","uid":1101373,"ip_address":"","ucode":"15AD8E3006E107","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/3d/385b8263.jpg","comment_is_top":false,"comment_ctime":1527125756,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"有个问题 卡夫卡我觉得也可以属于可靠性消息队列才对","like_count":3},{"had_liked":false,"id":127718,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1566784164,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"课前思考及问题\n1：评估和选择备选方案？\n哈哈，这节有趣啦！选择备选方案的前提，必须先给出若干种备选方案。这一步我觉得还是挺难的，解决同一个问题，要给出几种方案，给出的时候也许这种方案有什么特点就是已经心知肚明的，没有完美的存在有些资源的协调估计就不是架构师能自己拍板的啦！\n2：评估备选方案？\n我认为，屁股决定脑袋，用架构的屁股决定的话，架构设计三原则，也可用作架构评估三原则。\n\n客户思考及问题\n1：读完第一感受是，学完华仔的这个专栏也不可能马上成为架构师，甚至过上几年概率也不大。因为架构师的核心工作在于判断、权衡、取舍，没有足够的经验积累和业务、技术的沉淀，是很难说出一个技术或方案的优劣的，而且说出还不止一个，是对比的说，这个知识的深度和广度都非一朝一夕的事。当然，梦想还是要有的，毕竟她总归能实现。\n\n2：kafka和rocketMQ这两个都没用过，不过倒是学习过一下下，我们也是自研的，有专门的技术团队也来开发和维护，业务开发只管用就行，如果有新的需求提出来他们负责，评估是否支持。\nkafka和rocketMQ有什么区别，百度一下就清楚了。为什么阿里要自研？即使不了解这两个东西，估计也是能推测出来的。\n2-1：最重要的是有些特性kafka提供不了\n2-2：长期来考虑，更可控运维研发使用方便，易演化\n2-3：技术OK，技术不行想自研，也不行呀\n2-4：不差钱，人力、物力都不构成约束条件\n2-5：公司特别是上峰认识到技术的重要性，肯花人力、物力、财力，去支持自研","like_count":2},{"had_liked":false,"id":10557,"user_name":"高峰","can_delete":false,"product_type":"c1","uid":1104803,"ip_address":"","ucode":"BA43686A623783","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/a3/9dafa4a3.jpg","comment_is_top":false,"comment_ctime":1527595397,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"RocketMQ能保证消息不丢失，这是业务系统做重要的，所以我也选RocketMQ的双主来做业务系统的消息队列","like_count":2},{"had_liked":false,"id":10064,"user_name":"Bob","can_delete":false,"product_type":"c1","uid":1007005,"ip_address":"","ucode":"1A67FF9DC1FE1B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/9d/4ee1faf4.jpg","comment_is_top":false,"comment_ctime":1527252432,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"如果对QPS要求不高，又要求消息可靠传输，市面上没有成熟的消息队列解决方案吗，如基于JMS标准的某个实现？","like_count":2},{"had_liked":false,"id":247725,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1599807877,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"Kafka适合日志处理；RocketMQ适合业务处理。打卡","like_count":1},{"had_liked":false,"id":42069,"user_name":"黄隆","can_delete":false,"product_type":"c1","uid":1095130,"ip_address":"","ucode":"3674CDC7663042","user_header":"https://static001.geekbang.org/account/avatar/00/10/b5/da/016731f1.jpg","comment_is_top":false,"comment_ctime":1542901960,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"rocketmq，支持事务消息，支持可靠存储，支持push和pull。能满足阿里的庞大需求","like_count":1},{"had_liked":false,"id":9931,"user_name":"Mike Wang","can_delete":false,"product_type":"c1","uid":1111341,"ip_address":"","ucode":"4A7268451FFEB6","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/2d/8a0bd9f1.jpg","comment_is_top":false,"comment_ctime":1527169090,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"kafka项目初期不稳定，应用场景不满足业务需求；Kafka未来走向不可控；借鉴并重新实现rocketmq在阿里的业务规模是划算的，毕竟Kafka的诞生也是如此。","like_count":1},{"had_liked":false,"id":249635,"user_name":"Lee","can_delete":false,"product_type":"c1","uid":1085120,"ip_address":"","ucode":"158E29C62897CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/c0/7e70b689.jpg","comment_is_top":false,"comment_ctime":1600736786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":7,"product_id":100006601,"comment_content":"高可靠性和高性能两极化是相抵触的，很多情况是取得一个好的平衡，x86架构及冯诺依曼架构决定很多基础中间件、平台工具都有其产生的历史背景，开始要解决的核心问题侧重点不同","like_count":0},{"had_liked":false,"id":244055,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598368223,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"rabbitmq可靠性完爆kafka和rockmq，性能就是差点。这个案例主要还是运维怕kpi不达标","like_count":0},{"had_liked":false,"id":244051,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367493,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"现在都是云时代，直接阿里云用😹","like_count":0},{"had_liked":false,"id":202358,"user_name":"阿杜","can_delete":false,"product_type":"c1","uid":1066705,"ip_address":"","ucode":"349D3572F5ABE7","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/d1/a1ddf49f.jpg","comment_is_top":false,"comment_ctime":1585974817,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"这个业务性的mq使用rocketmq问题就基本都解决了","like_count":0},{"had_liked":false,"id":183079,"user_name":"谭方敏","can_delete":false,"product_type":"c1","uid":1710960,"ip_address":"","ucode":"728DC7ECB7C902","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/70/547042ee.jpg","comment_is_top":false,"comment_ctime":1582949114,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"从传统意义上来讲，kafka在追求高性能的同时牺牲了可靠性，主要场景用于日志收集和处理kafka+efk算是不错的日志分析方案。\n而rocketmq则是以可靠性为带来牺牲了性能，主要场景用于业务。\n在选择的时候，需要结合公司业务来看待。\n另外也要考虑公司实际能力和规划，如果公司实力强，并且所用中间件跟业务强相关，以及增加定制化，那么就会进行二次开发。\n阿里或许就是这样选择rocketmq吧","like_count":0},{"had_liked":false,"id":152757,"user_name":"fomy","can_delete":false,"product_type":"c1","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1574076018,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"归根结底还是结合具体业务，以及要解决的痛点，还有成本来考虑。","like_count":0},{"had_liked":false,"id":24021,"user_name":"往后余生","can_delete":false,"product_type":"c1","uid":1196829,"ip_address":"","ucode":"61923D3AE1DC07","user_header":"https://static001.geekbang.org/account/avatar/00/12/43/1d/e810a298.jpg","comment_is_top":false,"comment_ctime":1536757851,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"这才是一个架构师该有的样子哈","like_count":0},{"had_liked":false,"id":23893,"user_name":"阿巍-豆夫","can_delete":false,"product_type":"c1","uid":1005123,"ip_address":"","ucode":"732188848B0A85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/43/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1536714887,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"基于开发成本，还是基于性能，我的方案是先用最低的开发成本可以适当放弃性能，以备后患，如果后期时间可控，改造之前的方案，增加开发成本，提高性能","like_count":0},{"had_liked":false,"id":244055,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598368223,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"rabbitmq可靠性完爆kafka和rockmq，性能就是差点。这个案例主要还是运维怕kpi不达标","like_count":0},{"had_liked":false,"id":244051,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598367493,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"现在都是云时代，直接阿里云用😹","like_count":0},{"had_liked":false,"id":202358,"user_name":"阿杜","can_delete":false,"product_type":"c1","uid":1066705,"ip_address":"","ucode":"349D3572F5ABE7","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/d1/a1ddf49f.jpg","comment_is_top":false,"comment_ctime":1585974817,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"这个业务性的mq使用rocketmq问题就基本都解决了","like_count":0},{"had_liked":false,"id":183079,"user_name":"谭方敏","can_delete":false,"product_type":"c1","uid":1710960,"ip_address":"","ucode":"728DC7ECB7C902","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/70/547042ee.jpg","comment_is_top":false,"comment_ctime":1582949114,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"从传统意义上来讲，kafka在追求高性能的同时牺牲了可靠性，主要场景用于日志收集和处理kafka+efk算是不错的日志分析方案。\n而rocketmq则是以可靠性为带来牺牲了性能，主要场景用于业务。\n在选择的时候，需要结合公司业务来看待。\n另外也要考虑公司实际能力和规划，如果公司实力强，并且所用中间件跟业务强相关，以及增加定制化，那么就会进行二次开发。\n阿里或许就是这样选择rocketmq吧","like_count":0},{"had_liked":false,"id":152757,"user_name":"fomy","can_delete":false,"product_type":"c1","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1574076018,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"归根结底还是结合具体业务，以及要解决的痛点，还有成本来考虑。","like_count":0},{"had_liked":false,"id":24021,"user_name":"往后余生","can_delete":false,"product_type":"c1","uid":1196829,"ip_address":"","ucode":"61923D3AE1DC07","user_header":"https://static001.geekbang.org/account/avatar/00/12/43/1d/e810a298.jpg","comment_is_top":false,"comment_ctime":1536757851,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"这才是一个架构师该有的样子哈","like_count":0},{"had_liked":false,"id":23893,"user_name":"阿巍-豆夫","can_delete":false,"product_type":"c1","uid":1005123,"ip_address":"","ucode":"732188848B0A85","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/43/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1536714887,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":8,"product_id":100006601,"comment_content":"基于开发成本，还是基于性能，我的方案是先用最低的开发成本可以适当放弃性能，以备后患，如果后期时间可控，改造之前的方案，增加开发成本，提高性能","like_count":0}]}