{"id":86237,"title":"41ä¸¨æ•°æ®æŒ–æ˜å®æˆ˜ï¼ˆ3ï¼‰ï¼šå¦‚ä½•å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹ï¼Ÿ","content":"<p>ä»Šå¤©æˆ‘å¸¦ä½ ç”¨æ•°æ®æŒ–æ˜å¯¹æ¯”ç‰¹å¸çš„èµ°åŠ¿è¿›è¡Œé¢„æµ‹å’Œåˆ†æã€‚</p><p>æˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†æ•°æ®æŒ–æ˜ç®—æ³•ä¸­çš„åˆ†ç±»ã€èšç±»ã€å›å½’å’Œå…³è”åˆ†æç®—æ³•ï¼Œé‚£ä¹ˆå¯¹äºæ¯”ç‰¹å¸èµ°åŠ¿çš„é¢„æµ‹ï¼Œé‡‡ç”¨å“ªç§æ–¹æ³•æ¯”è¾ƒå¥½å‘¢ï¼Ÿ</p><p>å¯èƒ½æœ‰äº›äººä¼šè®¤ä¸ºé‡‡ç”¨å›å½’åˆ†æä¼šå¥½ä¸€äº›ï¼Œå› ä¸ºé¢„æµ‹çš„ç»“æœæ˜¯è¿ç»­çš„æ•°å€¼ç±»å‹ã€‚å®é™…ä¸Šï¼Œæ•°æ®æŒ–æ˜ç®—æ³•è¿˜æœ‰ä¸€ç§å«æ—¶é—´åºåˆ—åˆ†æçš„ç®—æ³•ï¼Œæ—¶é—´åºåˆ—åˆ†ææ¨¡å‹å»ºç«‹äº†è§‚å¯Ÿç»“æœä¸æ—¶é—´å˜åŒ–çš„å…³ç³»ï¼Œèƒ½å¸®æˆ‘ä»¬é¢„æµ‹æœªæ¥ä¸€æ®µæ—¶é—´å†…çš„ç»“æœå˜åŒ–æƒ…å†µã€‚</p><p>é‚£ä¹ˆæ—¶é—´åºåˆ—åˆ†æå’Œå›å½’åˆ†ææœ‰å“ªäº›åŒºåˆ«å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œåœ¨é€‰æ‹©æ¨¡å‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šç»“æœä¸å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å›å½’åˆ†æè®­ç»ƒå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡yä¸è‡ªå˜é‡xï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰çš„ç›¸å…³æ€§ï¼Œç„¶åé€šè¿‡æ–°çš„è‡ªå˜é‡xæ¥é¢„æµ‹ç›®æ ‡å˜é‡yã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå¾—åˆ°çš„æ˜¯ç›®æ ‡å˜é‡yä¸æ—¶é—´çš„ç›¸å…³æ€§ã€‚</p><p>å¦å¤–ï¼Œå›å½’åˆ†ææ“…é•¿çš„æ˜¯å¤šå˜é‡ä¸ç›®æ ‡ç»“æœä¹‹é—´çš„åˆ†æï¼Œå³ä¾¿æ˜¯å•ä¸€å˜é‡ï¼Œä¹Ÿå¾€å¾€ä¸æ—¶é—´æ— å…³ã€‚è€Œæ—¶é—´åºåˆ—åˆ†æå»ºç«‹åœ¨æ—¶é—´å˜åŒ–çš„åŸºç¡€ä¸Šï¼Œå®ƒä¼šåˆ†æç›®æ ‡å˜é‡çš„è¶‹åŠ¿ã€å‘¨æœŸã€æ—¶æœŸå’Œä¸ç¨³å®šå› ç´ ç­‰ã€‚è¿™äº›è¶‹åŠ¿å’Œå‘¨æœŸéƒ½æ˜¯åœ¨æ—¶é—´ç»´åº¦çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¦è§‚å¯Ÿçš„é‡è¦ç‰¹å¾ã€‚</p><p>é‚£ä¹ˆé’ˆå¯¹ä»Šå¤©è¦è¿›è¡Œçš„é¢„æµ‹æ¯”ç‰¹å¸èµ°åŠ¿çš„é¡¹ç›®ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æŒæ¡å“ªäº›ç›®æ ‡å‘¢ï¼Ÿ</p><ol>\n<li>\n<p>äº†è§£æ—¶é—´åºåˆ—é¢„æµ‹çš„æ¦‚å¿µï¼Œä»¥åŠå¸¸ç”¨çš„æ¨¡å‹ç®—æ³•ï¼ŒåŒ…æ‹¬ARã€MAã€ARMAã€ARIMAæ¨¡å‹ç­‰ï¼›</p>\n</li>\n<li>\n<p>æŒæ¡å¹¶ä½¿ç”¨ARMAæ¨¡å‹å·¥å…·ï¼Œå¯¹ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œå»ºæ¨¡å’Œé¢„æµ‹ï¼›</p>\n</li>\n<li>\n<p>å¯¹æ¯”ç‰¹å¸çš„å†å²æ•°æ®è¿›è¡Œæ—¶é—´åºåˆ—å»ºæ¨¡ï¼Œå¹¶é¢„æµ‹æœªæ¥6ä¸ªæœˆçš„èµ°åŠ¿ã€‚</p>\n</li>\n</ol><!-- [[[read_end]]] --><h2>æ—¶é—´åºåˆ—é¢„æµ‹</h2><p>å…³äºæ—¶é—´åºåˆ—ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºæŒ‰ç…§æ—¶é—´é¡ºåºç»„æˆçš„æ•°å­—åºåˆ—ã€‚å®é™…ä¸Šåœ¨ä¸­å›½å¤ä»£çš„å†œä¸šç¤¾ä¼šä¸­ï¼Œäººä»¬å°±å°†ä¸€å¹´ä¸­ä¸åŒæ—¶é—´èŠ‚ç‚¹å’Œå¤©æ°”çš„è§„å¾‹æ€»ç»“äº†ä¸‹æ¥ï¼Œå½¢æˆäº†äºŒåå››èŠ‚æ°”ï¼Œä¹Ÿå°±æ˜¯ä»æ—¶é—´åºåˆ—ä¸­è§‚å¯Ÿå¤©æ°”å’Œå¤ªé˜³çš„è§„å¾‹ï¼ˆåªæ˜¯å½“æ—¶æ²¡æœ‰æ—¶é—´åºåˆ—æ¨¡å‹å’Œç›¸åº”å·¥å…·ï¼‰ï¼Œä»è€Œä½¿å¾—å†œä¸šå¾—åˆ°è¿…é€Ÿå‘å±•ã€‚åœ¨ç°ä»£ç¤¾ä¼šï¼Œæ—¶é—´åºåˆ—åœ¨é‡‘èã€ç»æµã€å•†ä¸šé¢†åŸŸæ‹¥æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚</p><p>åœ¨æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ä¸­ï¼Œæœ‰ä¸€äº›ç»å…¸çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬ARã€MAã€ARMAã€ARIMAã€‚æˆ‘æ¥ç»™ä½ ç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p><p>ARçš„è‹±æ–‡å…¨ç§°å«åšAuto Regressiveï¼Œä¸­æ–‡å«è‡ªå›å½’æ¨¡å‹ã€‚è¿™ä¸ªç®—æ³•çš„æ€æƒ³æ¯”è¾ƒç®€å•ï¼Œå®ƒè®¤ä¸ºè¿‡å»è‹¥å¹²æ—¶åˆ»çš„ç‚¹é€šè¿‡çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°å°±å¯ä»¥é¢„æµ‹æœªæ¥æŸä¸ªæ—¶åˆ»çš„ç‚¹ã€‚</p><p>åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ç¯å¢ƒä¸­å°±å­˜åœ¨ç™½å™ªå£°ï¼Œåœ¨æ•°æ®æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªæœŸæœ›ä¸º0ï¼Œæ–¹å·®ä¸ºå¸¸æ•°çš„çº¯éšæœºè¿‡ç¨‹ã€‚ARæ¨¡å‹è¿˜å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºARï¼ˆpï¼‰æ¨¡å‹ï¼Œä¹Ÿå«ä½œpé˜¶è‡ªå›å½’æ¨¡å‹ã€‚å®ƒæŒ‡çš„æ˜¯é€šè¿‡è¿™ä¸ªæ—¶åˆ»ç‚¹çš„å‰pä¸ªç‚¹ï¼Œé€šè¿‡çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°æ¥é¢„æµ‹å½“å‰æ—¶åˆ»ç‚¹çš„å€¼ã€‚</p><p>MAçš„è‹±æ–‡å…¨ç§°å«åš Moving Averageï¼Œä¸­æ–‡å«åšæ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚å®ƒä¸ARæ¨¡å‹å¤§åŒå°å¼‚ï¼ŒARæ¨¡å‹æ˜¯å†å²æ—¶åºå€¼çš„çº¿æ€§ç»„åˆï¼ŒMAæ˜¯é€šè¿‡å†å²ç™½å™ªå£°è¿›è¡Œçº¿æ€§ç»„åˆæ¥å½±å“å½“å‰æ—¶åˆ»ç‚¹ã€‚ARæ¨¡å‹ä¸­çš„å†å²ç™½å™ªå£°æ˜¯é€šè¿‡å½±å“å†å²æ—¶åºå€¼ï¼Œä»è€Œé—´æ¥å½±å“åˆ°å½“å‰æ—¶åˆ»ç‚¹çš„é¢„æµ‹å€¼ã€‚åŒæ ·MAæ¨¡å‹ä¹Ÿå­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºMA(q)æ¨¡å‹ï¼Œä¹Ÿå«ä½œqé˜¶ç§»åŠ¨å¹³å‡æ¨¡å‹ã€‚æˆ‘ä»¬èƒ½çœ‹åˆ°ARå’ŒMAæ¨¡å‹éƒ½å­˜åœ¨é˜¶æ•°ï¼Œåœ¨ARæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ç”¨pè¡¨ç¤ºï¼Œåœ¨MAæ¨¡å‹ä¸­æˆ‘ä»¬ç”¨qè¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹å¤§åŒå°å¼‚ï¼Œä¸ARæ¨¡å‹ä¸åŒçš„æ˜¯MAæ¨¡å‹æ˜¯å†å²ç™½å™ªå£°çš„çº¿æ€§ç»„åˆã€‚</p><p>ARMAçš„è‹±æ–‡å…¨ç§°æ˜¯Auto Regressive Moving Averageï¼Œä¸­æ–‡å«åšè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ARæ¨¡å‹å’ŒMAæ¨¡å‹çš„æ··åˆã€‚ç›¸æ¯”ARæ¨¡å‹å’ŒMAæ¨¡å‹ï¼Œå®ƒæœ‰æ›´å‡†ç¡®çš„ä¼°è®¡ã€‚åŒæ ·ARMAæ¨¡å‹å­˜åœ¨på’Œqä¸¤ä¸ªé˜¶æ•°ï¼Œç§°ä¸ºARMA(p,q)æ¨¡å‹ã€‚</p><p>ARIMAçš„è‹±æ–‡å…¨ç§°æ˜¯Auto Regressive Integrated Moving Averageæ¨¡å‹ï¼Œä¸­æ–‡å«å·®åˆ†è‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå«æ±‚åˆè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚ç›¸æ¯”äºARMAï¼ŒARIMAå¤šäº†ä¸€ä¸ªå·®åˆ†çš„è¿‡ç¨‹ï¼Œä½œç”¨æ˜¯å¯¹ä¸å¹³ç¨³æ•°æ®è¿›è¡Œå·®åˆ†å¹³ç¨³ï¼Œåœ¨å·®åˆ†å¹³ç¨³åå†è¿›è¡Œå»ºæ¨¡ã€‚ARIMAçš„åŸç†å’ŒARMAæ¨¡å‹ä¸€æ ·ã€‚ç›¸æ¯”äºARMA(p,q)çš„ä¸¤ä¸ªé˜¶æ•°ï¼ŒARIMAæ˜¯ä¸€ä¸ªä¸‰å…ƒç»„çš„é˜¶æ•°(p,d,q)ï¼Œç§°ä¸ºARIMA(p,d,q)æ¨¡å‹ã€‚å…¶ä¸­dæ˜¯å·®åˆ†é˜¶æ•°ã€‚</p><h2>ARMAæ¨¡å‹å·¥å…·</h2><p>ä¸Šé¢ä»‹ç»çš„ARï¼ŒMAï¼ŒARMAï¼ŒARIMAå››ç§æ¨¡å‹ï¼Œä½ åªéœ€è¦äº†è§£åŸºç¡€æ¦‚å¿µå³å¯ï¼Œä¸­é—´æ¶‰åŠåˆ°çš„ä¸€äº›æ•°å­¦å…¬å¼è¿™é‡Œä¸è¿›è¡Œå±•å¼€ã€‚</p><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ›´å¤šçš„æ˜¯ä½¿ç”¨å·¥å…·ï¼Œæˆ‘åœ¨è¿™é‡Œä¸»è¦è®²è§£ä¸‹å¦‚ä½•ä½¿ç”¨ARMAæ¨¡å‹å·¥å…·ã€‚</p><p>åœ¨ä½¿ç”¨ARMAå·¥å…·å‰ï¼Œä½ éœ€è¦å…ˆå¼•ç”¨ç›¸å…³å·¥å…·åŒ…ï¼š</p><pre><code>from statsmodels.tsa.arima_model import ARMA\n</code></pre><p>ç„¶åé€šè¿‡ARMA(endog,order,exog=None)åˆ›å»ºARMAç±»ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä¸»è¦çš„å‚æ•°ç®€å•è¯´æ˜ä¸‹ï¼š</p><p>endogï¼šè‹±æ–‡æ˜¯endogenous variableï¼Œä»£è¡¨å†…ç”Ÿå˜é‡ï¼Œåˆå«éæ”¿ç­–æ€§å˜é‡ï¼Œå®ƒæ˜¯ç”±æ¨¡å‹å†³å®šçš„ï¼Œä¸è¢«æ”¿ç­–å·¦å³ï¼Œå¯ä»¥è¯´æ˜¯æˆ‘ä»¬æƒ³è¦åˆ†æçš„å˜é‡ï¼Œæˆ–è€…è¯´æ˜¯æˆ‘ä»¬è¿™æ¬¡é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„å˜é‡ã€‚</p><p>orderï¼šä»£è¡¨æ˜¯på’Œqçš„å€¼ï¼Œä¹Ÿå°±æ˜¯ARMAä¸­çš„é˜¶æ•°ã€‚</p><p>exogï¼šè‹±æ–‡æ˜¯exogenous variablesï¼Œä»£è¡¨å¤–ç”Ÿå˜é‡ã€‚å¤–ç”Ÿå˜é‡å’Œå†…ç”Ÿå˜é‡ä¸€æ ·æ˜¯ç»æµæ¨¡å‹ä¸­çš„ä¸¤ä¸ªé‡è¦å˜é‡ã€‚ç›¸å¯¹äºå†…ç”Ÿå˜é‡è€Œè¨€ï¼Œå¤–ç”Ÿå˜é‡åˆç§°ä½œä¸ºæ”¿ç­–æ€§å˜é‡ï¼Œåœ¨ç»æµæœºåˆ¶å†…å—å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œä¸æ˜¯æˆ‘ä»¬æ¨¡å‹è¦ç ”ç©¶çš„å˜é‡ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ›å»ºARMA(7,0)æ¨¡å‹ï¼Œå¯ä»¥å†™æˆï¼šARMA(data,(7,0))ï¼Œå…¶ä¸­dataæ˜¯æˆ‘ä»¬æƒ³è¦è§‚å¯Ÿçš„å˜é‡ï¼Œ(7,0)ä»£è¡¨(p,q)çš„é˜¶æ•°ã€‚</p><p>åˆ›å»ºå¥½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡fitå‡½æ•°è¿›è¡Œæ‹Ÿåˆï¼Œé€šè¿‡predict(start, end)å‡½æ•°è¿›è¡Œé¢„æµ‹ï¼Œå…¶ä¸­startä¸ºé¢„æµ‹çš„èµ·å§‹æ—¶é—´ï¼Œendä¸ºé¢„æµ‹çš„ç»ˆæ­¢æ—¶é—´ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ARMAæ¨¡å‹å¯¹ä¸€ç»„æ—¶é—´åºåˆ—åšå»ºæ¨¡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code># coding:utf-8\n# ç”¨ARMAè¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nfrom statsmodels.tsa.arima_model import ARMA\nfrom statsmodels.graphics.api import qqplot\n# åˆ›å»ºæ•°æ®\ndata = [5922, 5308, 5546, 5975, 2704, 1767, 4111, 5542, 4726, 5866, 6183, 3199, 1471, 1325, 6618, 6644, 5337, 7064, 2912, 1456, 4705, 4579, 4990, 4331, 4481, 1813, 1258, 4383, 5451, 5169, 5362, 6259, 3743, 2268, 5397, 5821, 6115, 6631, 6474, 4134, 2728, 5753, 7130, 7860, 6991, 7499, 5301, 2808, 6755, 6658, 7644, 6472, 8680, 6366, 5252, 8223, 8181, 10548, 11823, 14640, 9873, 6613, 14415, 13204, 14982, 9690, 10693, 8276, 4519, 7865, 8137, 10022, 7646, 8749, 5246, 4736, 9705, 7501, 9587, 10078, 9732, 6986, 4385, 8451, 9815, 10894, 10287, 9666, 6072, 5418]\ndata=pd.Series(data)\ndata_index = sm.tsa.datetools.dates_from_range('1901','1990')\n# ç»˜åˆ¶æ•°æ®å›¾\ndata.index = pd.Index(data_index)\ndata.plot(figsize=(12,8))\nplt.show()\n# åˆ›å»ºARMAæ¨¡å‹# åˆ›å»ºARMAæ¨¡å‹\narma = ARMA(data,(7,0)).fit()\nprint('AIC: %0.4lf' %arma.aic)\n# æ¨¡å‹é¢„æµ‹\npredict_y = arma.predict('1990', '2000')\n# é¢„æµ‹ç»“æœç»˜åˆ¶\nfig, ax = plt.subplots(figsize=(12, 8))\nax = data.loc['1901':].plot(ax=ax)\npredict_y.plot(ax=ax)\nplt.show()\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>AIC: 1619.6323\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/71/6a/71c5fe77926ba65e4b4aca48c337c66a.png?wh=1726*1153\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/08/fc/082ff6d7e85e176b8fd5c38f528314fc.png?wh=1727*1131\" alt=\"\"><br>\næˆ‘åˆ›å»ºäº†1901å¹´-1990å¹´ä¹‹é—´çš„æ—¶é—´åºåˆ—æ•°æ®dataï¼Œç„¶ååˆ›å»ºARMA(7,0)æ¨¡å‹ï¼Œå¹¶ä¼ å…¥æ—¶é—´åºåˆ—æ•°æ®dataï¼Œä½¿ç”¨fitå‡½æ•°æ‹Ÿåˆï¼Œç„¶åå¯¹1990å¹´-2000å¹´ä¹‹é—´çš„æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œæœ€åç»˜åˆ¶é¢„æµ‹ç»“æœã€‚</p><p>ä½ èƒ½çœ‹åˆ°ARMAå·¥å…·çš„ä½¿ç”¨è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œåªæ˜¯æˆ‘ä»¬éœ€è¦på’Œqçš„å–å€¼ã€‚å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™på’ŒqæŒ‡å®šä¸€ä¸ªèŒƒå›´ï¼Œè®©ARMAéƒ½è¿è¡Œä¸€ä¸‹ï¼Œç„¶åé€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ã€‚</p><p>ä½ å¯èƒ½ä¼šé—®ï¼Œæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªæ¨¡å‹æ˜¯å¦é€‚åˆï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦å¼•å…¥AICå‡†åˆ™ï¼Œä¹Ÿå«ä½œèµ¤æ± æ¶ˆæ¯å‡†åˆ™ï¼Œå®ƒæ˜¯è¡¡é‡ç»Ÿè®¡æ¨¡å‹æ‹Ÿåˆå¥½åçš„ä¸€ä¸ªæ ‡å‡†ï¼Œæ•°å€¼è¶Šå°ä»£è¡¨æ¨¡å‹æ‹Ÿåˆå¾—è¶Šå¥½ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ èƒ½çœ‹åˆ°ARMA(7,0)è¿™ä¸ªæ¨¡å‹æ‹Ÿåˆå‡ºæ¥çš„AICæ˜¯1619.6323ï¼ˆå¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜ï¼‰ã€‚</p><h2>å¯¹æ¯”ç‰¹å¸èµ°åŠ¿è¿›è¡Œé¢„æµ‹</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“æ¯”ç‰¹å¸çš„èµ°åŠ¿é™¤äº†å’Œå†å²æ•°æ®ä»¥å¤–ï¼Œè¿˜å’Œå¾ˆå¤šå¤–ç•Œå› ç´ ç›¸å…³ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å…³æ³¨åº¦ï¼Œå„å›½çš„æ”¿ç­–ï¼Œå¸åœˆä¹‹é—´æ˜¯å¦æ‰“æ¶ç­‰ç­‰ã€‚å½“ç„¶è¿™äº›å¤–ç•Œçš„å› ç´ ä¸æ˜¯æˆ‘ä»¬è¿™èŠ‚è¯¾éœ€è¦è€ƒè™‘çš„å¯¹è±¡ã€‚</p><p>å‡è®¾æˆ‘ä»¬åªè€ƒè™‘æ¯”ç‰¹å¸ä»¥å¾€çš„å†å²æ•°æ®ï¼Œç”¨ARMAè¿™ä¸ªæ—¶é—´åºåˆ—æ¨¡å‹é¢„æµ‹æ¯”ç‰¹å¸çš„èµ°åŠ¿ã€‚</p><p>æ¯”ç‰¹å¸å†å²æ•°æ®ï¼ˆä»2012-01-01åˆ°2018-10-31ï¼‰å¯ä»¥ä»GitHubä¸Šä¸‹è½½ï¼š<a href=\"https://github.com/cystanford/bitcoin\">https://github.com/cystanford/bitcoin</a>ã€‚</p><p>ä½ èƒ½çœ‹åˆ°æ•°æ®ä¸€å…±åŒ…æ‹¬äº†8ä¸ªå­—æ®µï¼Œä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/36/b0db4047723ec5e649240e2a87196a36.png?wh=468*288\" alt=\"\"><br>\næˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„é€ ARMAæ—¶é—´åºåˆ—æ¨¡å‹ï¼Œé¢„æµ‹æ¯”ç‰¹å¸ï¼ˆå¹³å‡ï¼‰ä»·æ ¼èµ°åŠ¿ã€‚på’Œqå‚æ•°å…·ä½“é€‰æ‹©å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œç„¶åé€‰æ‹©AICæœ€ä½çš„ARMAæ¨¡å‹ã€‚</p><p>æˆ‘ä»¬æ¢³ç†ä¸‹æ•´ä¸ªé¡¹ç›®çš„æµç¨‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/95/1e/95f8294c1f4805b86f9947178499181e.jpg?wh=2358*1091\" alt=\"\"><br>\né¦–å…ˆæˆ‘ä»¬éœ€è¦åŠ è½½æ•°æ®ã€‚</p><p>åœ¨å‡†å¤‡é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¢ç´¢æ•°æ®ï¼Œé‡‡ç”¨æ•°æ®å¯è§†åŒ–æ–¹å¼æŸ¥çœ‹æ¯”ç‰¹å¸çš„å†å²èµ°åŠ¿ã€‚æŒ‰ç…§ä¸åŒçš„æ—¶é—´å°ºåº¦ï¼ˆå¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´ï¼‰å¯ä»¥å°†æ•°æ®å‹ç¼©ï¼Œå¾—åˆ°ä¸åŒå°ºåº¦çš„æ•°æ®ï¼Œç„¶ååšå¯è§†åŒ–å‘ˆç°ã€‚è¿™4ä¸ªæ—¶é—´å°ºåº¦ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©æœˆä½œä¸ºé¢„æµ‹æ¨¡å‹çš„æ—¶é—´å°ºåº¦ï¼Œç›¸åº”çš„ï¼Œæˆ‘ä»¬é€‰æ‹©Weighted_Priceè¿™ä¸ªå­—æ®µçš„æ•°å€¼ä½œä¸ºè§‚å¯Ÿç»“æœï¼Œåœ¨åŸå§‹æ•°æ®ä¸­ï¼ŒWeighted_Priceå¯¹åº”çš„æ˜¯æ¯”ç‰¹å¸æ¯å¤©çš„å¹³å‡ä»·æ ¼ï¼Œå½“æˆ‘ä»¬ä»¥â€œæœˆâ€ä¸ºå•ä½è¿›è¡Œå‹ç¼©çš„æ—¶å€™ï¼Œå¯¹åº”çš„Weighted_Priceå¾—åˆ°çš„å°±æ˜¯å½“æœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼ã€‚å‹ç¼©ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>df_month = df.resample('M').mean()\n</code></pre><p>æœ€ååœ¨é¢„æµ‹é˜¶æ®µåˆ›å»ºARMAæ—¶é—´åºåˆ—æ¨¡å‹ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“på’Œqå–ä»€ä¹ˆå€¼æ—¶ï¼Œæ¨¡å‹æœ€ä¼˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»™å®ƒä»¬è®¾ç½®ä¸€ä¸ªåŒºé—´èŒƒå›´ï¼Œæ¯”å¦‚éƒ½æ˜¯range(0,3)ï¼Œç„¶åè®¡ç®—ä¸åŒæ¨¡å‹çš„AICæ•°å€¼ï¼Œé€‰æ‹©æœ€å°çš„AICæ•°å€¼å¯¹åº”çš„é‚£ä¸ªARMAæ¨¡å‹ã€‚æœ€åç”¨è¿™ä¸ªæœ€ä¼˜çš„ARMAæ¨¡å‹é¢„æµ‹æœªæ¥8ä¸ªæœˆçš„æ¯”ç‰¹å¸å¹³å‡ä»·æ ¼èµ°åŠ¿ï¼Œå¹¶å°†ç»“æœåšå¯è§†åŒ–å‘ˆç°ã€‚</p><p>åŸºäºè¿™ä¸ªæµç¨‹ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code># -*- coding: utf-8 -*-\n# æ¯”ç‰¹å¸èµ°åŠ¿é¢„æµ‹ï¼Œä½¿ç”¨æ—¶é—´åºåˆ—ARMA\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom statsmodels.tsa.arima_model import ARMA\nimport warnings\nfrom itertools import product\nfrom datetime import datetime\nwarnings.filterwarnings('ignore')\n# æ•°æ®åŠ è½½\ndf = pd.read_csv('./bitcoin_2012-01-01_to_2018-10-31.csv')\n# å°†æ—¶é—´ä½œä¸ºdfçš„ç´¢å¼•\ndf.Timestamp = pd.to_datetime(df.Timestamp)\ndf.index = df.Timestamp\n# æ•°æ®æ¢ç´¢\nprint(df.head())\n# æŒ‰ç…§æœˆï¼Œå­£åº¦ï¼Œå¹´æ¥ç»Ÿè®¡\ndf_month = df.resample('M').mean()\ndf_Q = df.resample('Q-DEC').mean()\ndf_year = df.resample('A-DEC').mean()\n# æŒ‰ç…§å¤©ï¼Œæœˆï¼Œå­£åº¦ï¼Œå¹´æ¥æ˜¾ç¤ºæ¯”ç‰¹å¸çš„èµ°åŠ¿\nfig = plt.figure(figsize=[15, 7])\nplt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾\nplt.suptitle('æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰', fontsize=20)\nplt.subplot(221)\nplt.plot(df.Weighted_Price, '-', label='æŒ‰å¤©')\nplt.legend()\nplt.subplot(222)\nplt.plot(df_month.Weighted_Price, '-', label='æŒ‰æœˆ')\nplt.legend()\nplt.subplot(223)\nplt.plot(df_Q.Weighted_Price, '-', label='æŒ‰å­£åº¦')\nplt.legend()\nplt.subplot(224)\nplt.plot(df_year.Weighted_Price, '-', label='æŒ‰å¹´')\nplt.legend()\nplt.show()\n# è®¾ç½®å‚æ•°èŒƒå›´\nps = range(0, 3)\nqs = range(0, 3)\nparameters = product(ps, qs)\nparameters_list = list(parameters)\n# å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œå³best_aicæœ€å°\nresults = []\nbest_aic = float(&quot;inf&quot;) # æ­£æ— ç©·\nfor param in parameters_list:\n    try:\n        model = ARMA(df_month.Weighted_Price,order=(param[0], param[1])).fit()\n    except ValueError:\n        print('å‚æ•°é”™è¯¯:', param)\n        continue\n    aic = model.aic\n    if aic &lt; best_aic:\n        best_model = model\n        best_aic = aic\n        best_param = param\n    results.append([param, model.aic])\n# è¾“å‡ºæœ€ä¼˜æ¨¡å‹\nresult_table = pd.DataFrame(results)\nresult_table.columns = ['parameters', 'aic']\nprint('æœ€ä¼˜æ¨¡å‹: ', best_model.summary())\n# æ¯”ç‰¹å¸é¢„æµ‹\ndf_month2 = df_month[['Weighted_Price']]\ndate_list = [datetime(2018, 11, 30), datetime(2018, 12, 31), datetime(2019, 1, 31), datetime(2019, 2, 28), datetime(2019, 3, 31), \n             datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30)]\nfuture = pd.DataFrame(index=date_list, columns= df_month.columns)\ndf_month2 = pd.concat([df_month2, future])\ndf_month2['forecast'] = best_model.predict(start=0, end=91)\n# æ¯”ç‰¹å¸é¢„æµ‹ç»“æœæ˜¾ç¤º\nplt.figure(figsize=(20,7))\ndf_month2.Weighted_Price.plot(label='å®é™…é‡‘é¢')\ndf_month2.forecast.plot(color='r', ls='--', label='é¢„æµ‹é‡‘é¢')\nplt.legend()\nplt.title('æ¯”ç‰¹å¸é‡‘é¢ï¼ˆæœˆï¼‰')\nplt.xlabel('æ—¶é—´')\nplt.ylabel('ç¾é‡‘')\nplt.show()\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>           Timestamp       ...        Weighted_Price\nTimestamp                   ...                      \n2011-12-31 2011-12-31       ...              4.471603\n2012-01-01 2012-01-01       ...              4.806667\n2012-01-02 2012-01-02       ...              5.000000\n2012-01-03 2012-01-03       ...              5.252500\n2012-01-04 2012-01-04       ...              5.208159\n\n[5 rows x 8 columns]\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/a9/2e/a91da037291f81fb6c90dc12223e9b2e.png?wh=1726*896\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/f6/98/f6a288ca19200918dfe219d2be47af98.png?wh=1729*932\" alt=\"\"></p><p><img src=\"https://static001.geekbang.org/resource/image/a6/f9/a6648f60cf39dcba9fe81069da214cf9.png?wh=1729*661\" alt=\"\"><br>\næˆ‘ä»¬é€šè¿‡productå‡½æ•°åˆ›å»ºäº†(p,q)åœ¨range(0,3)èŒƒå›´å†…çš„æ‰€æœ‰å¯èƒ½ç»„åˆï¼Œå¹¶å¯¹æ¯ä¸ªARMA(p,q)æ¨¡å‹è¿›è¡Œäº†AICæ•°å€¼è®¡ç®—ï¼Œä¿å­˜äº†AICæ•°å€¼æœ€å°çš„æ¨¡å‹å‚æ•°ã€‚ç„¶åç”¨è¿™ä¸ªæ¨¡å‹å¯¹æ¯”ç‰¹å¸çš„æœªæ¥8ä¸ªæœˆè¿›è¡Œäº†é¢„æµ‹ã€‚</p><p>ä»ç»“æœä¸­ä½ èƒ½çœ‹åˆ°ï¼Œåœ¨2018å¹´10æœˆä¹‹å8ä¸ªæœˆçš„æ—¶é—´é‡Œï¼Œæ¯”ç‰¹å¸ä¼šè§¦åº•åˆ°4000ç¾é‡‘å·¦å³ï¼Œå®é™…ä¸Šæ¯”ç‰¹å¸åœ¨è¿™ä¸ªé˜¶æ®µç¡®å®é™ä½åˆ°äº†4000å…ƒç¾é‡‘ç”šè‡³æ›´ä½ã€‚åœ¨æ—¶é—´å°ºåº¦çš„é€‰æ‹©ä¸Šï¼Œæˆ‘ä»¬é€‰æ‹©äº†æœˆï¼Œè¿™æ ·å°±å¯¹æ•°æ®è¿›è¡Œäº†é™ç»´ï¼Œä¹ŸèŠ‚çº¦äº†ARMAçš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚ä½ èƒ½çœ‹åˆ°æ¯”ç‰¹å¸é‡‘é¢ï¼ˆç¾é‡‘ï¼‰è¿™å¼ å›¾ä¸­ï¼ŒæŒ‰æœˆåˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å’ŒæŒ‰å¤©åˆ’åˆ†çš„æ¯”ç‰¹å¸èµ°åŠ¿å·®åˆ«ä¸å¤§ï¼Œåœ¨å‡å°‘äº†å±€éƒ¨çš„æ³¢åŠ¨çš„åŒæ—¶ä¹Ÿèƒ½ä½“ç°å‡ºæ¯”ç‰¹å¸çš„è¶‹åŠ¿ï¼Œè¿™æ ·å°±èŠ‚çº¦äº†ARMAçš„æ¨¡å‹è®­ç»ƒæ—¶é—´ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ç»™ä½ è®²äº†ä¸€ä¸ªæ¯”ç‰¹å¸è¶‹åŠ¿é¢„æµ‹çš„å®æˆ˜é¡¹ç›®ã€‚é€šè¿‡è¿™ä¸ªé¡¹ç›®ä½ åº”è¯¥èƒ½ä½“ä¼šåˆ°ï¼Œå½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œé¢„æµ‹çš„æ—¶å€™ï¼Œå¦‚æœè€ƒè™‘çš„æ˜¯å¤šä¸ªå˜é‡å’Œç»“æœä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥é‡‡ç”¨å›å½’åˆ†æï¼Œå¦‚æœè€ƒè™‘å•ä¸ªæ—¶é—´ç»´åº¦ä¸ç»“æœçš„å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†æã€‚</p><p>æ ¹æ®æ¯”ç‰¹å¸çš„å†å²æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ARMAæ¨¡å‹å¯¹æ¯”ç‰¹å¸æœªæ¥8ä¸ªæœˆçš„èµ°åŠ¿è¿›è¡Œäº†é¢„æµ‹ï¼Œå¹¶å¯¹ç»“æœè¿›è¡Œäº†å¯è§†åŒ–æ˜¾ç¤ºã€‚ä½ èƒ½çœ‹åˆ°ARMAå·¥å…·è¿˜æ˜¯å¾ˆå¥½ç”¨çš„ï¼Œè™½ç„¶æ¯”ç‰¹å¸çš„èµ°åŠ¿å—å¾ˆå¤šå¤–åœ¨å› ç´ å½±å“ï¼Œæ¯”å¦‚æ”¿ç­–ç¯å¢ƒã€‚ä¸è¿‡å½“æˆ‘ä»¬æŒæ¡äº†è¿™äº›å†å²æ•°æ®ï¼Œä¹Ÿä¸å¦¨ç”¨æ—¶é—´åºåˆ—æ¨¡å‹æ¥åˆ†æé¢„æµ‹ä¸€ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/24/94/24f8ee2f600a2451eecd58a98f7db894.png?wh=1726*846\" alt=\"\"><br>\næœ€åä¾ç„¶æ˜¯æ€è€ƒé¢˜ç¯èŠ‚ï¼Œä»Šå¤©æˆ‘ä»¬è®²äº†ARã€MAã€ARMAå’ŒARIMAï¼Œä½ èƒ½ç®€å•è¯´è¯´å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹ˆï¼Ÿ</p><p>å¦å¤–æˆ‘åœ¨<a href=\"https://github.com/cystanford/bitcoin\">GitHub</a>ä¸­ä¸Šä¼ äº†æ²ªå¸‚æŒ‡æ•°çš„å†å²æ•°æ®ï¼ˆå¯¹åº”çš„shanghai_1990-12-19_to_2019-2-28.csvï¼‰ï¼Œè¯·ä½ ç¼–å†™ä»£ç ä½¿ç”¨ARMAæ¨¡å‹å¯¹æ²ªå¸‚æŒ‡æ•°æœªæ¥10ä¸ªæœˆï¼ˆæˆªæ­¢åˆ°2019å¹´12æœˆ31æ—¥ï¼‰çš„å˜åŒ–è¿›è¡Œé¢„æµ‹ï¼ˆå°†æ•°æ®è½¬åŒ–ä¸ºæŒ‰æœˆç»Ÿè®¡å³å¯ï¼‰ã€‚</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºä¸æˆ‘åˆ†äº«ä½ çš„ç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ã€‚</p>","neighbors":{"left":{"article_title":"40ä¸¨æ•°æ®æŒ–æ˜å®æˆ˜ï¼ˆ2ï¼‰ï¼šä¿¡ç”¨å¡è¯ˆéª—åˆ†æ","id":85987},"right":{"article_title":"42ä¸¨å½“æˆ‘ä»¬è°ˆæ·±åº¦å­¦ä¹ çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½åœ¨è°ˆä»€ä¹ˆï¼Ÿ","id":86582}},"comments":[{"had_liked":false,"id":87968,"user_name":"é’Ÿæœ—ğŸ¾","can_delete":false,"product_type":"c1","uid":1486985,"ip_address":"","ucode":"21754885DD2045","user_header":"https://static001.geekbang.org/account/avatar/00/16/b0/89/2c3d5d7a.jpg","comment_is_top":false,"comment_ctime":1555769857,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"83160148481","product_id":100021701,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå•ä½æ ¹æ£€éªŒå’Œç™½å™ªå£°æ£€éªŒï¼Œè¿™æ ·ä¼šä¸ä¼šç²—æš´äº†ç‚¹å°¼","like_count":19,"discussions":[{"author":{"id":1486681,"avatar":"https://static001.geekbang.org/account/avatar/00/16/af/59/84aedd2f.jpg","nickname":"å°ç‹®å­(*Â¯ï¸¶Â¯*)","note":"","ucode":"EF8095CCD06D15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164958,"discussion_content":"æˆ‘è§‰å¾—æ˜¯é”™çš„ï¼Œé¢„æµ‹æ•°æ®å·®ä¸å¤šåº”è¯¥æ˜¯è’™å¯¹äº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1581242866,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77128,"user_name":"Geek_2a6093","can_delete":false,"product_type":"c1","uid":1395560,"ip_address":"","ucode":"9C216A0B09A7AF","user_header":"https://static001.geekbang.org/account/avatar/00/15/4b/68/a6198a59.jpg","comment_is_top":false,"comment_ctime":1552844301,"is_pvip":false,"replies":[{"id":"64411","content":"LSTMä¹Ÿæ˜¯ä¸é”™çš„æ–¹å¼ï¼Œä¸è¿‡LSTMå°±åƒæ˜¯ç‚¼é‡‘æœ¯ï¼Œéœ€è¦çš„è®¡ç®—é‡ï¼ˆæ—¶é—´ï¼‰æœ‰äº›å¤§äº†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618491,"ip_address":"","comment_id":77128,"utype":1}],"discussion_count":1,"race_medal":0,"score":"65977353741","product_id":100021701,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½è®²ä¸€ä¸‹LSTM<br>","like_count":15,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443591,"discussion_content":"LSTMä¹Ÿæ˜¯ä¸é”™çš„æ–¹å¼ï¼Œä¸è¿‡LSTMå°±åƒæ˜¯ç‚¼é‡‘æœ¯ï¼Œéœ€è¦çš„è®¡ç®—é‡ï¼ˆæ—¶é—´ï¼‰æœ‰äº›å¤§äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77241,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552895151,"is_pvip":false,"replies":[{"id":"64404","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618416,"ip_address":"","comment_id":77241,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31617666223","product_id":100021701,"comment_content":"è¿è¡Œæ²ªå¸‚æŒ‡æ•°æ•°æ®ç»“æœä¸ºï¼š<br>å‚æ•°é”™è¯¯: (0, 2)<br>æœ€ä¼˜æ¨¡å‹: ARMA Model Results  <br>é¢„æµ‹æ•°æ®ï¼š<br>2019-03-31\t\t2841.753594<br>2019-04-30\t\t2862.532373<br>2019-05-31\t\t2816.252354<br>2019-06-30\t\t2801.829572<br>2019-07-31\t\t2773.588278<br>2019-08-31\t\t2752.587602<br>2019-09-30\t\t2729.086661<br>2019-10-31\t\t2707.560415<br>2019-11-30\t\t2685.923215<br>2019-12-31\t\t2665.117874<br>-----------<br>df_month2[&#39;forecast&#39;]=best_model.predict(start=0,end=348)ç†è§£<br>start=0è¡¨ç¤ºä»ç¬¬0è¯¾æ•°æ®å¼€å§‹è®¡ç®—<br>end=348æ˜¯æŒ‡éœ€è¦è®¡ç®—348ä¸ªæ•°æ®ï¼Œå³ä»1990-12-19åˆ°2019-12-31ä¸€å…±æœ‰348ä¸ªæœˆï¼Œæ‰€ä»¥æœ‰348ä¸ªæ•°æ®","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443652,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2668134,"avatar":"https://static001.geekbang.org/account/avatar/00/28/b6/66/5d2be1ee.jpg","nickname":"ä¸œæ—­","note":"","ucode":"FD3EA3265FD9C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":535627,"discussion_content":"è€å¸ˆï¼Œè¿™ä¸ªæ²ªå¸‚æŒ‡æ•°å†å²æ•°æ®æ˜¯åœ¨å“ªé‡Œï¼Œæ€ä¹ˆè·å¾—çš„ï¼Œç›¼å¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638499611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":443652,"ip_address":""},"score":535627,"extra":""}]},{"author":{"id":2002493,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erQclmTZFrRVhxGicibVxJ6a14jQyEoUU0Jf6LT20kqG6kgaETM1fWKuxFonmNOZCO5qYHF3MJQHsMw/132","nickname":"Geek_22a0c1","note":"","ucode":"1192708F1043BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298779,"discussion_content":"è¿™ä¸ªé¢„æµ‹æœ‰é—®é¢˜å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597397516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77237,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552894470,"is_pvip":false,"replies":[{"id":"64405","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618424,"ip_address":"","comment_id":77237,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31617665542","product_id":100021701,"comment_content":"# -*- coding:utf-8 -*-<br># ç¼–ç ä½¿ç”¨ ARMA æ¨¡å‹å¯¹æ²ªå¸‚æŒ‡æ•°æœªæ¥ 10 ä¸ªæœˆï¼ˆæˆªæ­¢åˆ° 2019 å¹´ 12 æœˆ 31 æ—¥ï¼‰çš„å˜åŒ–è¿›è¡Œé¢„æµ‹<br>import numpy as np<br>import pandas as pd<br>import matplotlib.pyplot as plt<br>from statsmodels.tsa.arima_model import ARMA<br>import warnings<br>from itertools import product<br>from datetime import datetime<br>warnings.filterwarnings(&#39;ignore&#39;)<br><br># æ•°æ®åŠ è½½<br>df=pd.read_csv(&#39;.&#47;bitcoin-master&#47;shanghai_1990-12-19_to_2019-2-28.csv&#39;)<br># å°†æ—¶é—´ä½œä¸º df çš„ç´¢å¼•<br>df.Timestamp=pd.to_datetime(df.Timestamp)<br>df.index=df.Timestamp<br><br># æ•°æ®æ¢ç´¢<br>print(df.head())<br><br># æŒ‰ç…§æœˆæ¥ç»Ÿè®¡<br>df_month=df.resample(&#39;M&#39;).mean()<br><br># æŒ‰ç…§æœˆæ¥æ˜¾ç¤ºæ²ªå¸‚æŒ‡æ•°çš„èµ°åŠ¿<br>fig=plt.figure(figsize=[15,7])<br>plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;]<br>plt.suptitle(&#39;æ²ªå¸‚æŒ‡æ•°&#39;,fontsize=20)<br><br>plt.plot(df_month.Price,&#39;-&#39;,label=&#39;æŒ‰æœˆ&#39;)<br>plt.legend()<br>plt.show()<br><br># è®¾ç½®å‚æ•°èŒƒå›´<br>ps=range(0,3)<br>qs=range(0,3)<br>parameters=product(ps,qs)<br>parameters_list=list(parameters)<br><br># å¯»æ‰¾æœ€ä¼˜ ARMA æ¨¡å‹å‚æ•°ï¼Œå³ best_aic æœ€å°<br>results=[]<br>best_aic=float(&#39;inf&#39;)# æ­£æ— ç©·<br>for param in parameters_list:<br>    try:<br>        model=ARMA(df_month.Price,order=(param[0],param[1])).fit()<br>    except ValueError:<br>        print(&#39;å‚æ•°é”™è¯¯:&#39;,param)<br>        continue<br>    aic=model.aic<br>    if aic&lt;best_aic:<br>        best_model=model<br>        best_aic=aic<br>        best_param=param<br>    results.append([param,model.aic])<br># è¾“å‡ºæœ€ä¼˜æ¨¡å‹<br>result_table=pd.DataFrame(results)<br>result_table.columns=[&#39;parameters&#39;,&#39;aic&#39;]<br>print(&#39;æœ€ä¼˜æ¨¡å‹:&#39;,best_model.summary())<br><br># æ²ªå¸‚æŒ‡æ•°é¢„æµ‹<br>df_month2=df_month[[&#39;Price&#39;]]<br>date_list= [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30), datetime(2019, 7, 31),<br>             datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31),datetime(2019, 11, 30),datetime(2019, 12, 31)]<br>future=pd.DataFrame(index=date_list,columns=df_month.columns)<br>df_month2=pd.concat([df_month2,future])<br>df_month2[&#39;forecast&#39;]=best_model.predict(start=0,end=348)<br># æ²ªå¸‚æŒ‡æ•°é¢„æµ‹ç»“æœæ˜¾ç¤º<br>plt.figure(figsize=(20,7))<br>df_month2.Price.plot(label=&#39;å®é™…æŒ‡æ•°&#39;)<br>df_month2.forecast.plot(color=&#39;r&#39;,ls=&#39;--&#39;,label=&#39;é¢„æµ‹æŒ‡æ•°&#39;)<br>plt.legend()<br>plt.title(&#39;æ²ªå¸‚æŒ‡æ•°ï¼ˆæœˆï¼‰&#39;)<br>plt.xlabel(&#39;æ—¶é—´&#39;)<br>plt.ylabel(&#39;æŒ‡æ•°&#39;)<br>plt.show()","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443649,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2913751,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/75/d7/8b325587.jpg","nickname":"é±¼å°å–µ","note":"","ucode":"8395F79A74B2CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551698,"discussion_content":"æˆ‘åšäº†ä¸ªå’Œä½ å·®ä¸å¤šçš„è‚¡ä»·é¢„æµ‹ï¼Œä½†futureçš„å€¼æ˜¯ç©ºçš„ï¼Œè¿˜æœ›å¯è¿›ä¸€æ­¥æŒ‡ç‚¹ä¸€ç•ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645086099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82040,"user_name":"å¼ ä¸½æ–Œ","can_delete":false,"product_type":"c1","uid":1009318,"ip_address":"","ucode":"424253F2716313","user_header":"https://static001.geekbang.org/account/avatar/00/0f/66/a6/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1554108398,"is_pvip":false,"replies":[{"id":"64325","content":"å¯¹ å¾ˆå¤šå› ç´ ","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577616906,"ip_address":"","comment_id":82040,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27323912174","product_id":100021701,"comment_content":"è¿™æ˜¯åˆšå¥½æ’å¯¹äº†å§ï¼Œæ¯”ç‰¹å¸ã€è‚¡å¸‚ä»€ä¹ˆçš„é¢„æµ‹å—å„ç§å› ç´ å½±å“å¤ªå¤§äº†ã€‚æ›´å¤šæ˜¯è€ƒè™‘åŠ¨æ€å› ç´ ","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445439,"discussion_content":"å¯¹ å¾ˆå¤šå› ç´ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577616906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77184,"user_name":"è·³è·³","can_delete":false,"product_type":"c1","uid":1172803,"ip_address":"","ucode":"80B697B89E1A0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/43/7bc7cfe3.jpg","comment_is_top":false,"comment_ctime":1552878472,"is_pvip":false,"replies":[{"id":"64410","content":"å¾ˆå¥½çš„æ€»ç»“ï¼ŒåŒæ—¶èµä¸‹å®Œæˆä½œä¸šçš„åŒå­¦","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618464,"ip_address":"","comment_id":77184,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23027714952","product_id":100021701,"comment_content":"ä¸€ã€ARã€MAã€ARMAã€ARIMAçš„åŒºåˆ«<br>ARçš„æ ¸å¿ƒæ€æƒ³æ˜¯è¿‡å»è‹¥å¹²ç‚¹çš„çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°é¢„æµ‹æœªæ¥æ—¶åˆ»ç‚¹çš„å€¼ã€‚<br>MAçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å†å²ç™½å™ªå£°çº¿æ€§ç»„åˆæ¥å½±å“å½“å‰çš„æ—¶åˆ»ç‚¹ã€‚<br>ARMAï¼šç»“åˆARã€MAçš„æ€æƒ³ï¼Œç»¼åˆè€ƒè™‘å†å²ç™½å™ªå£°å’Œå½“å‰ç™½å™ªå£°ï¼Œé¢„æµ‹æœªæ¥æ—¶åˆ»ç‚¹ã€‚<br>ARIMAï¼šè¾ƒARMAå¤šäº†å·®åˆ†è¿‡ç¨‹ï¼Œå¯¹ä¸å¹³è¡¡æ•°æ®è¿›è¡Œäº†å·®åˆ†å¹³ç¨³ã€‚<br>äºŒã€æ²ªå¸‚æŒ‡æ•°é¢„æµ‹ç»“æœå¦‚ä¸‹ï¼š<br>å‚æ•°é”™è¯¯: (0, 2)<br>æœ€ä¼˜æ¨¡å‹:                                ARMA Model Results                              <br>==============================================================================<br>Dep. Variable:                  Price   No. Observations:                  339<br>Model:                     ARMA(2, 2)   Log Likelihood               -2208.110<br>Method:                       css-mle   S.D. of innovations            162.159<br>Date:                Mon, 18 Mar 2019   AIC                           4428.219<br>Time:                        10:59:23   BIC                           4451.175<br>Sample:                    12-31-1990   HQIC                          4437.367<br>                         - 02-28-2019                                         <br>","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443624,"discussion_content":"å¾ˆå¥½çš„æ€»ç»“ï¼ŒåŒæ—¶èµä¸‹å®Œæˆä½œä¸šçš„åŒå­¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1614927,"avatar":"https://static001.geekbang.org/account/avatar/00/18/a4/4f/00b2cf4b.jpg","nickname":"äº‘ç„•7777","note":"","ucode":"34299A86A2F5CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396990,"discussion_content":"ä¸ºä»€ä¹ˆä¼šæœ‰å‚æ•°é”™è¯¯ï¼ˆ0,2ï¼‰å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632537546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136723,"user_name":"éª‘è¡Œçš„æŒæŸœJ","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1569498103,"is_pvip":false,"replies":[{"id":"62717","content":"Good Jobï¼Œä½¿ç”¨å·®åˆ†ä¹‹åï¼Œå†è¿›è¡Œçš„ARMAæ¨¡å‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577086525,"ip_address":"","comment_id":136723,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14454399991","product_id":100021701,"comment_content":"æˆ‘ç”¨ARIMAæ¨¡å‹å¯¹è€å¸ˆä¸€å¼€å§‹çš„é‚£ç»„æ—¶é—´åºåˆ—è¿›è¡Œäº†åˆ†æé¢„æµ‹ï¼Œå› ä¸ºå­—æ•°é™åˆ¶ï¼šçœç•¥ä¸€å¼€å§‹çš„æ•°æ®åŠ è½½å’Œæœ€åçš„é¢„æµ‹æ­¥éª¤ï¼Œä½†æ˜¯åŠ å…¥å¯¹å·®åˆ†æ¬¡æ•°dçš„æŸ¥æ‰¾ã€æ‰¾ARIMAæ¨¡å‹çš„pã€qå€¼å’Œæ¨¡å‹æ£€éªŒä¸‰ä¸ªæ­¥éª¤ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨ï¼Œè°¢è°¢<br># -*- coding: utf-8 -*-<br># ç”¨ ARIMA è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹<br>import numpy as np<br>from statsmodels.graphics.tsaplots import acf,pacf,plot_acf,plot_pacf<br>#2.ä¸‹é¢æˆ‘ä»¬å…ˆå¯¹éå¹³ç¨³æ—¶é—´åºåˆ—è¿›è¡Œæ—¶é—´åºåˆ—çš„å·®åˆ†ï¼Œæ‰¾å‡ºé€‚åˆçš„å·®åˆ†æ¬¡æ•°<br>#fig = plt.figure(figsize=(12, 8))<br>#ax1 = fig.add_subplot(111)<br>#diff1 = data.diff(1)<br>#diff1.plot(ax=ax1)<br>#è¿™é‡Œæ˜¯åšäº†1é˜¶å·®åˆ†ï¼Œå¯ä»¥çœ‹å‡ºæ—¶é—´åºåˆ—çš„å‡å€¼å’Œæ–¹å·®åŸºæœ¬å¹³ç¨³ï¼Œ<br>#è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€é˜¶å·®åˆ†çš„æ—¶é—´åºåˆ—ï¼ŒæŠŠä¸Šé¢ä»£ç æ³¨é‡Šæ‰<br>#3.æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ‰¾åˆ°ARIMAæ¨¡å‹ä¸­åˆé€‚çš„på’Œqå€¼ï¼š<br>data = data.diff(1)<br>data.dropna(inplace=True)<br>#ç¬¬ä¸€æ­¥ï¼šå…ˆæ£€æŸ¥å¹³ç¨³åºåˆ—çš„è‡ªç›¸å…³å›¾å’Œåè‡ªç›¸å…³å›¾<br>fig = plt.figure(figsize=(12, 8))<br>ax1 = fig.add_subplot(211)<br>fig = sm.graphics.tsa.plot_acf(data,lags=40,ax=ax1)<br>#lags è¡¨ç¤ºæ»åçš„é˜¶æ•°ï¼Œä¸‹é¢åˆ†åˆ«å¾—åˆ°acf å›¾å’Œpacf å›¾<br>ax2 = fig.add_subplot(212)<br>fig = sm.graphics.tsa.plot_pacf(data, lags=40,ax=ax2)<br>#ç”±ä¸‹å›¾æˆ‘ä»¬å¯ä»¥åˆ†åˆ«ç”¨ARMA(0,1)æ¨¡å‹ã€ARMA(7,0)æ¨¡å‹ã€ARMA(7,1)æ¨¡å‹ç­‰æ¥æ‹Ÿåˆæ‰¾å‡ºæœ€ä½³æ¨¡å‹ï¼š<br>#ç¬¬ä¸‰æ­¥:æ‰¾å‡ºæœ€ä½³æ¨¡å‹ARMA<br>arma_mod1 = sm.tsa.ARMA(data,(7,0)).fit()<br>print(arma_mod1.aic, arma_mod1.bic, arma_mod1.hqic)<br>arma_mod2 = sm.tsa.ARMA(data,(0,1)).fit()<br>print(arma_mod2.aic, arma_mod2.bic, arma_mod2.hqic)<br>arma_mod3 = sm.tsa.ARMA(data,(7,1)).fit()<br>print(arma_mod3.aic, arma_mod3.bic, arma_mod3.hqic)<br>arma_mod4 = sm.tsa.ARMA(data,(8,0)).fit()<br>print(arma_mod4.aic, arma_mod4.bic, arma_mod4.hqic)<br>#ç”±ä¸Šé¢å¯ä»¥çœ‹å‡ºARMA(7,0)æ¨¡å‹æœ€ä½³<br>#ç¬¬å››æ­¥ï¼šè¿›è¡Œæ¨¡å‹æ£€éªŒï¼Œé¦–å…ˆå¯¹ARMA(7,0)æ¨¡å‹æ‰€äº§ç”Ÿçš„æ®‹å·®åšè‡ªç›¸å…³å›¾<br>resid = arma_mod1.resid<br>#ä¸€å®šè¦åŠ ä¸Šè¿™ä¸ªå˜é‡èµ‹å€¼è¯­å¥ï¼Œä¸ç„¶ä¼šæŠ¥é”™resid is not defined <br>fig = plt.figure(figsize=(12, 8))<br>ax1 = fig.add_subplot(211)<br>fig = sm.graphics.tsa.plot_acf(resid.values.squeeze(),lags=40,ax=ax1)<br>ax2 = fig.add_subplot(212)<br>fig = sm.graphics.tsa.plot_pacf(resid, lags=40,ax=ax2)<br>#æ¥ç€åšå¾·å®¾-æ²ƒæ£®ï¼ˆD-Wï¼‰æ£€éªŒ<br>print(sm.stats.durbin_watson(arma_mod1.resid.values))<br>#å¾—å‡ºæ¥ç»“æœæ˜¯ä¸å­˜åœ¨è‡ªç›¸å…³æ€§çš„<br>#å†è§‚å¯Ÿæ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ,è¿™é‡Œç”¨qqå›¾<br>fig = plt.figure(figsize=(12,8))<br>ax = fig.add_subplot(111)<br>fig = qqplot(resid, line=&#39;q&#39;,ax=ax, fit=True)<br>#æœ€åç”¨Ljung-Boxæ£€éªŒ:æ£€éªŒçš„ç»“æœå°±æ˜¯çœ‹æœ€åä¸€åˆ—å‰åäºŒè¡Œçš„æ£€éªŒæ¦‚ç‡ï¼ˆä¸€èˆ¬è§‚å¯Ÿæ»å1~12é˜¶ï¼‰<br>r,q,p = sm.tsa.acf(resid.values.squeeze(),qstat=True)<br>data1 = np.c_[range(1,41), r[1:], q, p]<br>table= pd.DataFrame(data1, columns=[ &#39;lag&#39;,&#39;AC&#39;,&#39;Q&#39;,&#39;Prob(&gt;Q)&#39;])<br>print(table.set_index(&#39;lag&#39;))<br>","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468774,"discussion_content":"Good Jobï¼Œä½¿ç”¨å·®åˆ†ä¹‹åï¼Œå†è¿›è¡Œçš„ARMAæ¨¡å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577086525,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1372987,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","nickname":"èƒ–é™¶","note":"","ucode":"EE32D91A3BC0F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37497,"discussion_content":"å¯ä»¥ç»™ä¸€ä¸‹å®Œæ•´ä»£ç å—è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571623938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"éª‘è¡Œçš„æŒæŸœJ","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1372987,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f3/3b/15ffb7c3.jpg","nickname":"èƒ–é™¶","note":"","ucode":"EE32D91A3BC0F3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":38820,"discussion_content":"https://blog.csdn.net/weixin_41013322/article/details/102710236 å†™åœ¨æˆ‘åšå®¢é‡Œäº† ä½ å»çœ‹çœ‹å§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571838093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":37497,"ip_address":""},"score":38820,"extra":""}]}]},{"had_liked":false,"id":77416,"user_name":"å ‚å‰è¯ƒå¾·","can_delete":false,"product_type":"c1","uid":1357227,"ip_address":"","ucode":"6A6D3D4866729B","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/ab/30e1531e.jpg","comment_is_top":false,"comment_ctime":1552921042,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14437822930","product_id":100021701,"comment_content":"1. parameters = product(ps, qs) <br>parametersä¸ºå¯è¿­ä»£å¯¹è±¡, ç›´æ¥ä½¿ç”¨<br>for param in parameters:  <br>ä¸ç”¨å†è½¬ä¸ºåˆ—è¡¨å§?<br><br>2. å›ç­”ä¸€ä¸‹ @Grandia_Z <br>æ—¶é—´åºåˆ—æ“ä½œ<br>date_list = pd.date_range(&#39;2019-03-31&#39;, &#39;2019-12-31&#39;, periods=None, freq=&#39;D&#39;)<br>å¸Œæœ›ä½ èƒ½çœ‹åˆ°","like_count":3},{"had_liked":false,"id":134440,"user_name":"å","can_delete":false,"product_type":"c1","uid":1589855,"ip_address":"","ucode":"4748BE1FD3CA3E","user_header":"https://static001.geekbang.org/account/avatar/00/18/42/5f/349b57f2.jpg","comment_is_top":false,"comment_ctime":1568831347,"is_pvip":false,"replies":[{"id":"63496","content":"å¯ä»¥ä½¿ç”¨ARIMAæ¨¡å‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577514631,"ip_address":"","comment_id":134440,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10158765939","product_id":100021701,"comment_content":"æˆ‘è§‰å¾—ç¡®å®æœ‰äº›é—®é¢˜ï¼Œåœ¨æ˜¯åŒarmaæ¨¡å‹ä¹‹å‰æ²¡æœ‰å¯¹æ•°æ®å¹³ç¨³æ€§æ£€éªŒï¼Œæ¯•ç«Ÿæ¨¡å‹æ˜¯åŸºäºå¹³ç¨³æ€§çš„ã€‚","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467749,"discussion_content":"å¯ä»¥ä½¿ç”¨ARIMAæ¨¡å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577514631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89570,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1556208860,"is_pvip":false,"replies":[{"id":"64221","content":"1ï¼‰å½©ç¥¨è¿™ç§ç”¨ä»€ä¹ˆæ²¡æœ‰ç”¨ï¼Œå› ä¸ºæ˜¯å®Œå…¨éšæœºæ€§ï¼Œæ‰¾ä¸åˆ°è§„å¾‹çš„ï¼Œæˆ–è€…ç”¨è§„å¾‹è§£å†³ä¸äº†é—®é¢˜<br>2ï¼‰ARMA å¯ä»¥èµ‹å€¼ä¸ªèŒƒå›´ï¼Œè®©å®ƒåœ¨èŒƒå›´å†…è‡ªå·±æ¥å¯»æ‰¾é€‚åˆçš„å‚æ•°ï¼Œä¸€èˆ¬è¶…å‚æ•°ä¼˜åŒ–éƒ½æ˜¯è¿™æ ·æ“ä½œ<br>åŠ æ²¹æ»¢","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577614631,"ip_address":"","comment_id":89570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10146143452","product_id":100021701,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆï¼Œï¼ˆ1ï¼‰å¯¹äºç±»ä¼¼äºå½©ç¥¨è¿™ç§ç±»å‹çš„æ•°æ®è¯¥ç”¨ä»€ä¹ˆç®—æ³•åˆ†æï¼Ÿï¼ˆ2ï¼‰å¯¹äºARMAçš„æœ€ä¼˜åªèƒ½äººä¸ºèµ‹å€¼ï¼Œå¾ªç¯æ£€æµ‹æœ€å¤§å€¼å—ï¼Ÿè‹¥æ•°æ®å¤šçš„æƒ…å†µæ€ä¹ˆåŠï¼Ÿ ","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448178,"discussion_content":"1ï¼‰å½©ç¥¨è¿™ç§ç”¨ä»€ä¹ˆæ²¡æœ‰ç”¨ï¼Œå› ä¸ºæ˜¯å®Œå…¨éšæœºæ€§ï¼Œæ‰¾ä¸åˆ°è§„å¾‹çš„ï¼Œæˆ–è€…ç”¨è§„å¾‹è§£å†³ä¸äº†é—®é¢˜\n2ï¼‰ARMA å¯ä»¥èµ‹å€¼ä¸ªèŒƒå›´ï¼Œè®©å®ƒåœ¨èŒƒå›´å†…è‡ªå·±æ¥å¯»æ‰¾é€‚åˆçš„å‚æ•°ï¼Œä¸€èˆ¬è¶…å‚æ•°ä¼˜åŒ–éƒ½æ˜¯è¿™æ ·æ“ä½œ\nåŠ æ²¹æ»¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77227,"user_name":"ç‹å½¬æˆ","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1552892640,"is_pvip":false,"replies":[{"id":"64406","content":"å¾ˆå¥½çš„æ€»ç»“ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618430,"ip_address":"","comment_id":77227,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10142827232","product_id":100021701,"comment_content":"ARã€MAã€ARMAå’ŒARIMAæ¨¡å‹åŒºåˆ«<br><br>1ã€AR ï¼ˆAuto Regressiveï¼‰ï¼Œä¸­æ–‡å«è‡ªå›å½’æ¨¡å‹ï¼Œå®ƒè®¤ä¸ºè¿‡å»è‹¥å¹²æ—¶åˆ»çš„ç‚¹é€šè¿‡çº¿æ€§ç»„åˆï¼Œå†åŠ ä¸Šç™½å™ªå£°å°±å¯ä»¥é¢„æµ‹æœªæ¥æŸä¸ªæ—¶åˆ»çš„ç‚¹ã€‚AR æ¨¡å‹è¿˜å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARï¼ˆpï¼‰æ¨¡å‹ï¼Œä¹Ÿå«ä½œ p é˜¶è‡ªå›å½’æ¨¡å‹ã€‚å®ƒæŒ‡çš„æ˜¯é€šè¿‡è¿™ä¸ªæ—¶åˆ»ç‚¹çš„å‰ p ä¸ªç‚¹ï¼Œé€šè¿‡çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°æ¥é¢„æµ‹å½“å‰æ—¶åˆ»ç‚¹çš„å€¼ã€‚<br><br>2ã€MA ï¼ˆ Moving Averageï¼‰ï¼Œä¸­æ–‡å«åšæ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚MA æ¨¡å‹å­˜åœ¨ä¸€ä¸ªé˜¶æ•°ï¼Œç§°ä¸º MA(q) æ¨¡å‹ï¼Œä¹Ÿå«ä½œ q é˜¶ç§»åŠ¨å¹³å‡æ¨¡å‹ã€‚MA æ¨¡å‹æ˜¯é€šè¿‡å°†ä¸€æ®µæ—¶é—´åºåˆ—ä¸­ç™½å™ªå£°åºåˆ—è¿›è¡ŒåŠ æƒå’Œã€‚<br><br>3ã€ARMA ï¼ˆ Auto Regressive Moving Averageï¼‰ï¼Œä¸­æ–‡å«åšè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œ ARMA æ¨¡å‹å­˜åœ¨ p å’Œ q ä¸¤ä¸ªé˜¶æ•°ï¼Œç§°ä¸º ARMA(p,q) æ¨¡å‹ã€‚<br><br>4ã€ARIMAï¼ˆ Auto Regressive Integrated Moving Average ï¼‰ï¼Œä¸­æ–‡å«å·®åˆ†è‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ï¼Œä¹Ÿå«æ±‚åˆè‡ªå›å½’æ»‘åŠ¨å¹³å‡æ¨¡å‹ã€‚ç›¸æ¯”äº ARMAï¼ŒARIMA å¤šäº†ä¸€ä¸ªå·®åˆ†çš„è¿‡ç¨‹ï¼Œä½œç”¨æ˜¯å¯¹ä¸å¹³ç¨³æ•°æ®è¿›è¡Œå·®åˆ†å¹³ç¨³ï¼Œåœ¨å·®åˆ†å¹³ç¨³åå†è¿›è¡Œå»ºæ¨¡ã€‚ARIMA æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„çš„é˜¶æ•° (p,d,q)ï¼Œç§°ä¸º ARIMA(p,d,q) æ¨¡å‹ã€‚å…¶ä¸­ d æ˜¯å·®åˆ†é˜¶æ•°ã€‚","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443645,"discussion_content":"å¾ˆå¥½çš„æ€»ç»“ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261994,"user_name":"åšç§¯è–„å‘","can_delete":false,"product_type":"c1","uid":1206674,"ip_address":"","ucode":"8640C07176C249","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/92/69c2c135.jpg","comment_is_top":false,"comment_ctime":1605601887,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5900569183","product_id":100021701,"comment_content":"1.AR,MA,ARMA,ARIMAçš„åŒºåˆ«<br>       1.1ARæ¨¡å‹ Auto Regressive  è‡ªå›å½’æ¨¡å‹ è¿‡å»ä¸€æ®µæ—¶é—´çš„ç‚¹çº¿æ€§ç»„åˆå†åŠ ä¸Šç™½å™ªå£°é¢„æµ‹æœªæ¥æŸæ—¶åˆ»çš„ç‚¹  AR(p)<br>       1.2.MA æ¨¡å‹ Moving Average ç§»åŠ¨å¹³å‡æ¨¡å‹ å†å²ç™½å™ªå£°çš„çº¿æ€§ç»„åˆå½±å“å½“å‰æ—¶åˆ»çš„ç‚¹  MA(q)<br>        1.3.ARMA æ¨¡å‹ Auto Regressive Moving Average è‡ªå›å½’å¹³å‡æ»‘åŠ¨æ¨¡å‹  ARæ¨¡å‹å’ŒMAæ¨¡å‹çš„æ··åˆ  ARMA(p,q)<br>         1.4.ARIMA æ¨¡å‹  Auto Regressive Integrated Moving Average å·®åˆ†è‡ªå›å½’å¹³å‡æ»‘åŠ¨æ¨¡å‹ ARIMA(p,d,q)   è¦æ±‚æ•°æ®æ˜¯å¹³ç¨³çš„<br><br>         é¢„æµ‹æŒ‡æ ‡AIC   AIC è¶Šå°è¶Šå¥½<br>2.ä»€ä¹ˆæ—¶å€™ä½¿ç”¨çº¿æ€§å›å½’ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†æ<br>          å¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œé¢„æµ‹æ—¶ï¼Œå¦‚æœè€ƒè™‘çš„æ˜¯å•ä¸ªæ—¶é—´ç»´åº¦ä¸ç»“æœçš„å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†æ<br>         å¦‚æœè€ƒè™‘çš„æ˜¯å¤šä¸ªå˜é‡ä¸ç»“æœä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥é‡‡ç”¨å›å½’åˆ†æ<br>3.ä¸Šè¯æŒ‡æ•°é¢„æµ‹<br>   ä»£ç ï¼šgit@github.com:houjibofa2050&#47;sequentially.git<br>   <br>","like_count":1},{"had_liked":false,"id":210072,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1587661326,"is_pvip":false,"replies":[{"id":"103974","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617289830,"ip_address":"","comment_id":210072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5882628622","product_id":100021701,"comment_content":"äº¤ä½œä¸šï¼šå¿«å­¦å®Œç¬¬ä¸€éäº†ï¼Œå¥¥åˆ©ç»™å¹²äº†ã€‚<br>https:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;41-%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E5%AE%9E%E6%88%98%EF%BC%883%EF%BC%89%EF%BC%9A%E5%A6%82%E4%BD%95%E5%AF%B9%E6%AF%94%E7%89%B9%E5%B8%81%E8%B5%B0%E5%8A%BF%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B%EF%BC%9F","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492934,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617289830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176989,"user_name":"å°ç‹®å­(*Â¯ï¸¶Â¯*)","can_delete":false,"product_type":"c1","uid":1486681,"ip_address":"","ucode":"EF8095CCD06D15","user_header":"https://static001.geekbang.org/account/avatar/00/16/af/59/84aedd2f.jpg","comment_is_top":false,"comment_ctime":1581242822,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5876210118","product_id":100021701,"comment_content":"ä¸åšå¹³ç¨³æ€§æ£€æµ‹å°±èƒ½ç›´æ¥ç”¨ARMAæ¨¡å‹ï¼Ÿ<br>","like_count":1,"discussions":[{"author":{"id":1349706,"avatar":"https://static001.geekbang.org/account/avatar/00/14/98/4a/c39fc848.jpg","nickname":"evan","note":"","ucode":"6D8AA919F40DEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290478,"discussion_content":"è¿™å“¥ä»¬è¯¯äººå­å¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594483719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157848,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1575269540,"is_pvip":false,"replies":[{"id":"62630","content":"RonnyzåŒå­¦æ•´ç†çš„ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577078781,"ip_address":"","comment_id":157848,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5870236836","product_id":100021701,"comment_content":"AR <br>éšæœºå˜é‡çš„å–å€¼æ˜¯å‰pæœŸçš„å¤šå…ƒçº¿æ€§å›å½’ï¼Œè®¤ä¸ºä¸»è¦å—è¿‡å»pæœŸçš„åºåˆ—å€¼å½±å“ã€‚è¯¯å·®é¡¹æ˜¯å½“å‰çš„éšæœºå¹²æ‰°ï¼Œä¸ºé›¶å‡å€¼ç™½å™ªå£°åºåˆ—<br>MA<br>åœ¨tæ—¶åˆ»çš„éšæœºå˜é‡çš„å–å€¼æ˜¯å‰qæœŸçš„éšæœºæ‰°åŠ¨çš„å¤šå…ƒçº¿æ€§å‡½æ•°ã€‚è¯¯å·®é¡¹æ˜¯å½“æœŸçš„éšæœºå¹²æ‰°,ä¸ºé›¶å‡å€¼ç™½å™ªå£°åºåˆ—ï¼Œæ˜¯åºåˆ—çš„å‡å€¼ã€‚è®¤ä¸ºä¸»è¦å—è¿‡å»qæœŸçš„è¯¯å·®é¡¹å½±å“ã€‚<br>ARMA<br>éšæœºå˜é‡çš„å–å€¼ä¸ä»…ä¸ä»¥å‰pæœŸçš„åºåˆ—å€¼æœ‰å…³è¿˜ä¸å‰qæœŸçš„éšæœºæ‰°åŠ¨æœ‰å…³ã€‚<br>ARIMA<br>å°†ARMAå’Œå·®åˆ†æ³•ç»“åˆï¼Œå¾—åˆ°ARIMA(p,d,q)ï¼Œå…¶ä¸­dæ˜¯éœ€è¦å¯¹æ•°æ®è¿›è¡Œå·®åˆ†çš„é˜¶æ•°ã€‚<br><br><br>#è®¾ç½®å‚æ•°è°ƒæ•´èŒƒå›´<br>p_scope=range(0,3)<br>q_scope=range(0,3)<br>æœ€ä¼˜æ¨¡å‹ï¼š<br>Model: \tARMA(2, 2)<br>AIC \t4428.219","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476551,"discussion_content":"RonnyzåŒå­¦æ•´ç†çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577078781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79448,"user_name":"TKbook","can_delete":false,"product_type":"c1","uid":1073829,"ip_address":"","ucode":"F6E0E99CC79059","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/a5/43aa0c27.jpg","comment_is_top":false,"comment_ctime":1553484987,"is_pvip":false,"replies":[{"id":"64361","content":"Godo Jobï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577617763,"ip_address":"","comment_id":79448,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5848452283","product_id":100021701,"comment_content":"import numpy as np<br>import pandas as pd<br>import matplotlib.pyplot as plt<br>from statsmodels.tsa.arima_model import ARMA<br>import warnings<br>from itertools import product<br>from datetime import datetime<br>warnings.filterwarnings(&#39;ignore&#39;)<br>df = pd.read_csv(&#39;shanghai_1990-12-19_to_2019-2-28.csv&#39;)<br>df.index = pd.to_datetime(df.Timestamp)<br>df_month = df.resample(&#39;M&#39;).mean()<br># è®¾ç½®å‚æ•°èŒƒå›´<br>ps = range(0, 3)<br>qs = range(0, 3)<br>parameters = product(ps, qs)<br>parameters_list = list(parameters)<br># å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œå³best_aicæœ€å°<br>results = []<br>best_aic = float(&#39;inf&#39;) # æ­£æ— ç©·<br>for param in parameters_list:<br>    try:<br>        model = ARMA(df_month.Price, order=(param[0], param[1])).fit()<br>    except ValueError:<br>        print(&#39;å‚æ•°é”™è¯¯ï¼š&#39;, param)<br>        continue<br>    aic = model.aic<br>    if aic &lt; best_aic:<br>        best_model = model<br>        best_aic = aic<br>        best_param = param<br>    results.append([param, model.aic])<br># è¾“å‡ºæœ€ä¼˜æ¨¡å‹<br>result_table = pd.DataFrame(results)<br>result_table.columns = [&#39;parameters&#39;, &#39;aic&#39;]<br>print(&#39;æœ€ä¼˜æ¨¡å‹ï¼š&#39;, best_model.summary())<br># è‚¡å¸‚é¢„æµ‹<br>date_list = [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30),<br>             datetime(2019, 7, 31), datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31),<br>             datetime(2019, 11, 30), datetime(2019, 12, 31)]<br>future = pd.DataFrame(index=date_list, columns=df_month.columns)<br>df_month = pd.concat([df_month, future])<br>df_month[&#39;forecast&#39;] = best_model.predict(start=0, end=348)<br># é¢„æµ‹ç»“æœæ˜¾ç¤º<br>plt.figure(figsize=(20, 7))<br>df_month.Price.plot(label=&#39;å®é™…æŒ‡æ•°&#39;)<br>df_month.forecast.plot(color=&#39;r&#39;, ls=&#39;--&#39;, label=&#39;é¢„æµ‹æŒ‡æ•°&#39;)<br>plt.legend()<br>plt.title(&#39;é‡‘é¢ï¼ˆæœˆï¼‰&#39;)<br>plt.xlabel(&#39;TIME&#39;)<br>plt.ylabel(&#39;RMB&#39;)<br>plt.show()","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444502,"discussion_content":"Godo Jobï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329351,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1641297750,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641297750","product_id":100021701,"comment_content":"TSLMä¹Ÿæ˜¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":324820,"user_name":"æ¬ å„¿ç™»","can_delete":false,"product_type":"c1","uid":2816350,"ip_address":"","ucode":"3AEECE8B93BC70","user_header":"https://static001.geekbang.org/account/avatar/00/2a/f9/5e/947d77f6.jpg","comment_is_top":false,"comment_ctime":1638666218,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1638666218","product_id":100021701,"comment_content":"è¯·é—®æ—¶é—´åºåˆ—å¿…é¡»æ˜¯è¿ç»­ä¸æ–­çš„ä¹ˆï¼Œæ¯”å¦‚æŒ‰å‘¨ç»Ÿè®¡å°±å¿…é¡»æ¯å‘¨éƒ½æœ‰æ•°æ®ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1922303,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/54/ff/666c479d.jpg","nickname":"dage","note":"","ucode":"AA7C658301D918","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578202,"discussion_content":"äº²æµ‹ï¼Œå‘ç°æ˜¯è¿™æ ·ï¼Œæ—¶é—´ä¸è¿ç»­æ¨¡å‹æœ‰å¯èƒ½é¢„æµ‹å¤±è´¥ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå†å²14å‘¨çš„æ•°æ®é¢„æµ‹æœªæ¥14å‘¨çš„æ•°æ®ï¼Œå†å²14å‘¨é‡Œï¼Œå¦‚æœæŸä¸€å‘¨ä¸­æ–­äº†ï¼Œé‚£æ¨¡å‹ä¼šé¢„æµ‹å¤±è´¥ï¼Œå¦‚æœæ˜¯æœ‰è§„å¾‹çš„ä¸­æ–­ï¼Œæ¯”å¦‚æ¯ä¸¤å‘¨ä¸­æ–­ä¸€æ¬¡ï¼Œé‚£æ¨¡å‹é¢„æµ‹å‡ºæ¥çš„ç»“æœä¹Ÿæ˜¯ä¿æŒè¿™æ ·çš„è§„å¾‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656577194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316754,"user_name":"ä¸œæ—­","can_delete":false,"product_type":"c1","uid":2668134,"ip_address":"","ucode":"FD3EA3265FD9C0","user_header":"https://static001.geekbang.org/account/avatar/00/28/b6/66/5d2be1ee.jpg","comment_is_top":false,"comment_ctime":1634541345,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1634541345","product_id":100021701,"comment_content":"ä¸çŸ¥é“è¿˜æœ‰äººçœ‹è¿™ä¸ªè¯¾ç¨‹ä¸ï¼Œæˆ‘çš„é¢„æµ‹éƒ½æ˜¯å¹³çš„ï¼Œæ²¡æœ‰ä¸€ç‚¹å¯å‚è€ƒè¶‹åŠ¿ï¼Œæˆ‘ç”¨çš„python3.9ï¼ŒARMAå·²ç»åœç”¨äº†ï¼Œæ‰€æœ‰æˆ‘æ¨¡ä»¿ç€ç”¨äº†statsmodels.tsa.arima.model.ARIMAï¼Œä¸çŸ¥é“é—®é¢˜å‡ºåœ¨äº†å“ªé‡Œ","like_count":0,"discussions":[{"author":{"id":2913751,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/75/d7/8b325587.jpg","nickname":"é±¼å°å–µ","note":"","ucode":"8395F79A74B2CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553520,"discussion_content":"æˆ‘å‡ºç°äº†ä¸ä½ ç›¸åŒçš„é—®é¢˜ï¼Œå…ˆå¼€å§‹æ˜¯æ— æ•°æ®ï¼Œåæ¥æˆ‘åœ¨DataFrame()ä¸­ä¼ å…¥äº†æ•°æ®ï¼Œä¼°è®¡æ˜¯æ•°æ®ä¼ å…¥ä¸åŒæ‰€å¯¼è‡´çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645947909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267579,"user_name":"éåŒå‡¡æƒ³","can_delete":false,"product_type":"c1","uid":1934969,"ip_address":"","ucode":"713FD449A49D5A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/86/79/066a062a.jpg","comment_is_top":false,"comment_ctime":1607833621,"is_pvip":false,"replies":[{"id":"100889","content":"ç»§ç»­åšæŒ~","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1612706435,"ip_address":"","comment_id":267579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1607833621","product_id":100021701,"comment_content":"### best param (4,3)<br><br>import pandas as pd<br>from datetime import datetime<br>from statsmodels.tsa.arima_model import ARMA<br>import warnings<br>import matplotlib.pyplot as  plt<br>from itertools import product<br><br>warnings.filterwarnings(&#39;ignore&#39;)<br>data = pd.read_csv(&#39;~&#47;Documents&#47;bitcoin&#47;shanghai_1990-12-19_to_2019-2-28.csv&#39;)<br>print(data.head())<br>print(data.info())<br><br>data[&#39;Timestamp&#39;] = pd.to_datetime(data[&#39;Timestamp&#39;])<br>data.index = data[&#39;Timestamp&#39;]<br>print(data.head())<br>data_m = data.resample(&#39;M&#39;).mean()<br><br>q_range = range(0, 5)<br>p_range = range(0, 5)<br>params = product(q_range, p_range)<br>param_list = list(params)<br># print(param_list)<br>results = []<br>best_aic = float(&#39;inf&#39;)<br><br>for param in param_list:<br>    try:<br>        model = ARMA(data_m[&#39;Price&#39;], order=(param[0], param[1])).fit()<br>    except ValueError:<br>        print(&quot;å‚æ•°é”™è¯¯&quot;, param)<br>        continue<br>    aic = model.aic<br>    if aic &lt; best_aic:<br>        best_model = model<br>        best_aic = aic<br>        best_param = param<br>    results.append([param, model.aic])<br><br>result_table = pd.DataFrame(results)<br>result_table.columns = [&#39;parameters&#39;, &#39;aic&#39;]<br><br>print(&quot;best model:&quot;, best_model.summary())<br>print(&quot;best param:&quot;, best_param)<br>data_month2 = data_m[[&#39;Price&#39;]]<br>date_list = [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30),<br>             datetime(2019, 7, 31),<br>             datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31), datetime(2019, 11, 30),<br>             datetime(2019, 12, 31)]<br>future = pd.DataFrame(index=date_list, columns=data_m.columns)<br>data_month2 = pd.concat([data_month2, future])<br>data_month2[&#39;forecast&#39;] = best_model.predict(start=0, end=384)<br>#start=0è¡¨ç¤ºä»ç¬¬0ä¸ªæ•°æ®å¼€å§‹è®¡ç®—<br>#end=348æ˜¯æŒ‡éœ€è¦è®¡ç®—348ä¸ªæ•°æ®ï¼Œå³ä»1990-12-19åˆ°2019-12-31ä¸€å…±æœ‰348ä¸ªæœˆï¼Œæ‰€ä»¥æœ‰348ä¸ªæ•°æ®<br>print(data_month2.head())<br>plt.figure(figsize=(20, 7))<br>plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;SimHei&#39;]<br>data_month2[&#39;Price&#39;].plot(label=&#39;å®é™…æŒ‡æ•°&#39;)<br>data_month2[&#39;forecast&#39;].plot(label=&#39;é¢„æµ‹æŒ‡æ•°&#39;, ls=&#39;--&#39;, color=&#39;r&#39;)<br>plt.legend()<br>plt.title(&#39;æ²ªå¸‚æŒ‡æ•°ï¼ˆæœˆï¼‰&#39;)<br>plt.xlabel(&#39;æ—¶é—´&#39;)<br>plt.ylabel(&#39;æŒ‡æ•°&#39;)<br>plt.show()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511683,"discussion_content":"ç»§ç»­åšæŒ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612706435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235371,"user_name":"å¤§æ‡’è™«","can_delete":false,"product_type":"c1","uid":1440873,"ip_address":"","ucode":"51014C4A7074DA","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/69/02953435.jpg","comment_is_top":false,"comment_ctime":1594985611,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594985611","product_id":100021701,"comment_content":"è€å¸ˆï¼Œæˆ‘ç”¨armaæ¨¡å‹å»é¢„æµ‹cpuç›‘æ§æ•°æ®çš„æ—¶å€™ï¼Œå‘ç°è®­ç»ƒæ•°æ®æ‹Ÿåˆçš„å¾ˆå¥½ï¼Œä½†æ˜¯é¢„æµ‹çš„æ—¶å€™ï¼Œè¶‹åŠ¿å´æ˜¯ç›¸åçš„ï¼Œè¯·é—®ä¸‹è¿™ä¸ªé—®é¢˜ä¸€èˆ¬è¦æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":230848,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1593509912,"is_pvip":false,"replies":[{"id":"103708","content":"å‡ºç°è´Ÿå€¼è¯´æ˜æ‹Ÿåˆçš„å¤ªå¥½äº†ï¼Œæœ‰äº›æ˜æ˜¾çš„è¿‡åº¦æ‹Ÿåˆï¼Œè¿™åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­æ˜¯ä¸€ç§å¹¶ä¸å¥½çš„æƒ…å†µï¼Œåº”è€ƒè™‘æ•°æ®ä¸­å­˜åœ¨æ›´æ·±å±‚æ¬¡çš„å…³ç³»ï¼Œé‡æ–°è®¾å®šæ¨¡å‹å½¢å¼ï¼Œå¦åˆ™æ¨¡å‹ç¼ºå°‘æ³›åŒ–èƒ½åŠ›","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1617034459,"ip_address":"","comment_id":230848,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593509912","product_id":100021701,"comment_content":"è¯·é—®è€å¸ˆï¼Œæˆ‘ç”¨æ‚¨çš„æ–¹æ³•å¯»æ‰¾æœ€ä¼˜æ¨¡å‹æ—¶ï¼Œæœ€åå¾—åˆ°çš„æ¨¡å‹AICæ˜¯å°äº0çš„ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæ˜¯ä¸æ˜¯å› ä¸ºæˆ‘çš„æ•°æ®åºåˆ—å€¼éƒ½æ˜¯å°äº1çš„åŸå› ï¼Ÿæœ€ç»ˆçš„è¾“å‡ºç»“æœæ˜¯è¿™æ ·çš„ï¼š<br>æœ€ä¼˜æ¨¡å‹:                                ARMA Model Results                              <br>==============================================================================<br>Dep. Variable:                   é£é™©ç³»æ•°   No. Observations:                  216<br>Model:                     ARMA(1, 1)   Log Likelihood                 364.911<br>Method:                       css-mle   S.D. of innovations              0.044<br>Date:                Tue, 30 Jun 2020   AIC                           -721.823<br>Time:                        17:37:35   BIC                           -708.322<br>Sample:                             0   HQIC                          -716.368<br>                                                                              <br>==============================================================================<br>                 coef    std err          z      P&gt;|z|      [0.025      0.975]<br>------------------------------------------------------------------------------<br>const          0.4613      0.072      6.415      0.000       0.320       0.602<br>ar.L1.é£é™©ç³»æ•°     0.9773      0.023     42.940      0.000       0.933       1.022<br>ma.L1.é£é™©ç³»æ•°    -0.4586      0.070     -6.583      0.000      -0.595      -0.322<br>                                    Roots                                    <br>=============================================================================<br>                  Real          Imaginary           Modulus         Frequency<br>-----------------------------------------------------------------------------<br>AR.1            1.0232           +0.0000j            1.0232            0.0000<br>MA.1            2.1805           +0.0000j            2.1805            0.0000<br>-----------------------------------------------------------------------------","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500056,"discussion_content":"å‡ºç°è´Ÿå€¼è¯´æ˜æ‹Ÿåˆçš„å¤ªå¥½äº†ï¼Œæœ‰äº›æ˜æ˜¾çš„è¿‡åº¦æ‹Ÿåˆï¼Œè¿™åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­æ˜¯ä¸€ç§å¹¶ä¸å¥½çš„æƒ…å†µï¼Œåº”è€ƒè™‘æ•°æ®ä¸­å­˜åœ¨æ›´æ·±å±‚æ¬¡çš„å…³ç³»ï¼Œé‡æ–°è®¾å®šæ¨¡å‹å½¢å¼ï¼Œå¦åˆ™æ¨¡å‹ç¼ºå°‘æ³›åŒ–èƒ½åŠ›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617034459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198708,"user_name":"å¼ è´º","can_delete":false,"product_type":"c1","uid":1283181,"ip_address":"","ucode":"0254E40FB3EB5F","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/6d/5cd6e8c7.jpg","comment_is_top":false,"comment_ctime":1585464956,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585464956","product_id":100021701,"comment_content":"å’Œè®¡é‡ç»æµå­¦çš„å†…å®¹æ¯”è¾ƒæ¥è¿‘","like_count":0},{"had_liked":false,"id":180829,"user_name":"è‹¹æœ","can_delete":false,"product_type":"c1","uid":1761988,"ip_address":"","ucode":"5D0FA9D8560FD8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e2/c4/25acaa38.jpg","comment_is_top":false,"comment_ctime":1582423837,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582423837","product_id":100021701,"comment_content":"é¢„æµ‹10ä¸ªæœˆçš„æŒ‡æ•°ç»“æœ<br>2019-02-28    2512.315225<br>2019-03-31    2841.790501<br>2019-04-30    2862.619053<br>2019-05-31    2816.393758<br>2019-06-30    2802.021098<br>2019-07-31    2773.830565<br>2019-08-31    2752.878544<br>2019-09-30    2729.425626<br>2019-10-31    2707.946051<br>2019-11-30    2686.354577<br>2019-12-31            Na<br>åˆ†æå¯¹æ¯”äº†ä¸‹å…¶ä»–åŒå­¦çš„ç»“æœï¼Œæ•´æ•°ä½åŸºæœ¬ç›¸åŒï¼Œå°æ•°ä½å°±ä¸ç„¶ã€‚æ¯æ¬¡è¿è¡Œçš„ç»“æœæœ‰äº›å·®åˆ«ã€‚ä¸è¿‡ä¹Ÿè¾¾åˆ°äº†ç›®çš„","like_count":0},{"had_liked":false,"id":89723,"user_name":"æ»¢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1556250003,"is_pvip":false,"replies":[{"id":"64218","content":"Good Job","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577614452,"ip_address":"","comment_id":89723,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556250003","product_id":100021701,"comment_content":"Aè‚¡é¢„æµ‹ï¼Œè¯­è¨€Python3.6 ï¼Œæœ€ä½³æ¨¡å‹ARMA(5, 4)ï¼Œè®¾ç½®çš„èŒƒå›´ç¨å¤§ï¼Œå¾—åˆ°çš„ç»“æœè¿˜è›®æ¥è¿‘ï¼Œå¯ä»¥è®¾ç½®çš„å†å¤§ä¸€äº›ï¼Œä¸è¿‡æ•°æ®ä¼˜ç‚¹å¤šè·‘èµ·æ¥æ—¶é—´è¾ƒé•¿ã€‚<br>#æ•°æ®åŠ è½½<br>path = &#39;&#47;Users&#47;apple&#47;Desktop&#47;GitHubProject&#47;Read mark&#47;æ•°æ®åˆ†æ&#47;geekTime&#47;data&#47;&#39;<br>df = pd.read_csv(path + &#39;shanghai_1990-12-19_to_2019-2-28.csv&#39;)<br>#å°†æ—¶é—´ä½œä¸ºdfçš„ç´¢å¼•<br>df.Timestamp = pd.to_datetime(df.Timestamp)<br>df.index = df.Timestamp<br>#æ•°æ®æ¢ç´¢<br>print(df.head())<br>df_month = df.resample(&#39;M&#39;).mean()<br>print(df_month.head())<br><br>#æŒ‰ç…§å¤©ã€æœˆã€å­£åº¦ã€å¹´æ˜¾ç¤ºAè‚¡èµ°åŠ¿<br>fig = plt.figure(figsize=[15,7])<br>plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;]<br>plt.suptitle(&#39;Aè‚¡æŒ‡æ•°&#39;,fontsize = 18.0)<br>plt.plot(df_month.Price, &#39;-&#39;, label =&#39;æŒ‰æœˆ&#39;)<br>plt.legend()<br>plt.show()<br><br>#è®¾ç½®å‚æ•°èŒƒå›´<br>ps = range(0,7)<br>qs = range(0,7)<br>parameters = product(ps,qs)<br>parameters_list = list(parameters)<br>#å¯»æ‰¾æœ€ä¼˜ARMAæ¨¡å‹å‚æ•°ï¼Œaicæœ€å°<br>results = []<br>best_aic = float(&quot;inf&quot;)<br>for param in parameters_list:<br>    try:<br>        model = ARMA(df_month.Price,order=(param[0],param[1])).fit()<br>    except ValueError:<br>        print(&#39;å‚æ•°é”™è¯¯:&#39;,param)<br>        continue<br>    aic = model.aic<br>    if aic &lt; best_aic:<br>        best_model = model<br>        best_aic=aic<br>        best_param = param<br>    results.append([param,model.aic])<br><br>#è¾“å‡ºæœ€ä¼˜æ¨¡å‹<br>result_table = pd.DataFrame(results)<br>result_table.columns = [&#39;parameters&#39;,&#39;aic&#39;]<br>print(&#39;æœ€ä½³æ¨¡å‹:&#39;,best_model.summary())<br>#Aè‚¡é¢„æµ‹<br>df_month_value = df_month[[&#39;Price&#39;]]<br>date_list = [datetime(2019,3,31),datetime(2019,4,30),datetime(2019,5,31),<br>             datetime(2019,6,30),datetime(2019,7,31),datetime(2019,8,31),<br>             datetime(2019,9,30),datetime(2019,10,31),datetime(2019,11,30),<br>             datetime(2019,12,31)]<br>future = pd.DataFrame(index=date_list,columns=df_month.columns)<br>df_month_value = pd.concat([df_month_value,future])<br>df_month_value[&#39;forecast&#39;]=best_model.predict(start=0, end=348)<br>#Aè‚¡é¢„æµ‹ç»“æœå±•ç¤º<br>plt.figure(figsize=(20,7))<br>df_month_value.Price.plot(label=&#39;å®é™…é‡‘é¢&#39;)<br>df_month_value.forecast.plot(color=&#39;r&#39;, ls=&#39;--&#39;, label=&#39;é¢„æµ‹é‡‘é¢&#39;)<br>plt.legend()<br>plt.title(&#39;Aè‚¡é‡‘é¢ï¼ˆæœˆï¼‰&#39;)<br>plt.xlabel(&#39;æ—¶é—´&#39;)<br>plt.ylabel(&#39;æŒ‡æ•°&#39;)<br>plt.show()","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448235,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80089,"user_name":"Geek_dancer","can_delete":false,"product_type":"c1","uid":1440561,"ip_address":"","ucode":"F66D454E58E35E","user_header":"https://static001.geekbang.org/account/avatar/00/15/fb/31/f0a884a3.jpg","comment_is_top":false,"comment_ctime":1553603832,"is_pvip":false,"replies":[{"id":"64353","content":"å¯¹ ä½ å¯ä»¥å…ˆçœ‹ä¸‹æ˜¯å¦æ˜¯å¹³ç¨³åºåˆ—ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå°±éœ€è¦å…ˆåšå·®åˆ†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ARIMA","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577617472,"ip_address":"","comment_id":80089,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553603832","product_id":100021701,"comment_content":"è€å¸ˆï¼ŒARMAæ˜¯å®Œå…¨æ ¹æ®è¿‡å»æ—¶åºä¸­çš„æ•°æ®èµ°åŠ¿è§„å¾‹æ¥è¿›è¡Œé¢„æµ‹çš„å—ï¼Ÿä½†æ˜¯å¤§éƒ¨åˆ†é¢„æµ‹è¿˜æ˜¯ä¼šå—å…¶ä»–ç‰¹å¾å±æ€§çš„å½±å“ï¼Œä»è€Œå½±å“å…¶èµ°åŠ¿è¿˜æœ‰æ³¢åŠ¨ã€‚æˆ‘ç”¨ARMAåšäº†ç”µåŠ›ç³»ç»Ÿçš„è´Ÿè·é¢„æµ‹ï¼Œå¯¹æ¯”äº†ä¹‹å‰ç”¨SVMåšçš„é¢„æµ‹ï¼Œæ„Ÿè§‰ARMAçš„é¢„æµ‹æµ‹ç²¾åº¦ç›¸å½“ä½ï¼Œé¢„æµ‹æ›²çº¿åŸºæœ¬å°±æ˜¯ä¸€ä¸ªä¸€æ¬¡çº¿æ€§æ›²çº¿ï¼Œæœ‰ä¸€ä¸ªå¤§æ¦‚çš„è¶‹åŠ¿ï¼Œè´Ÿè·çš„å‘¨æœŸæ³¢åŠ¨æ€§å®Œå…¨æ²¡æœ‰ä½“ç°ã€‚è¯·é—®è¿™æ˜¯ARMAçš„å±€é™æ€§å†³å®šçš„ï¼Œè¿˜æ˜¯æˆ‘æ²¡æœ‰è®­ç»ƒå¥½å•Šã€‚","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444746,"discussion_content":"å¯¹ ä½ å¯ä»¥å…ˆçœ‹ä¸‹æ˜¯å¦æ˜¯å¹³ç¨³åºåˆ—ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå°±éœ€è¦å…ˆåšå·®åˆ†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ARIMA","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78556,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1553174846,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553174846","product_id":100021701,"comment_content":"æœ€ä¼˜æ¨¡å‹ï¼ŒARMA(2, 2)","like_count":0},{"had_liked":false,"id":78459,"user_name":"szm","can_delete":false,"product_type":"c1","uid":1352697,"ip_address":"","ucode":"53E753D3D04431","user_header":"https://static001.geekbang.org/account/avatar/00/14/a3/f9/9180d6d1.jpg","comment_is_top":false,"comment_ctime":1553153673,"is_pvip":false,"replies":[{"id":"64388","content":"GridSearchCV ç”¨äºsklearnåº“ä¸­çš„æ¨¡å‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618196,"ip_address":"","comment_id":78459,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553153673","product_id":100021701,"comment_content":"æˆ‘çœ‹è€å¸ˆåœ¨æŒ‘é€‰æœ€æœ‰å‚æ•°æ—¶ç”¨çš„æ˜¯è½®è¯¢åŠæ³•ï¼Œ39ç« ä¿¡ç”¨å¡è¿çº¦ç‡åˆ†æä¸­è®²çš„GridSearchå¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨å—ï¼Ÿè¿˜æ˜¯GridSearchåªèƒ½ç”¨äºsklearnåº“ä¸­çš„åˆ†ç±»ç®—æ³•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444101,"discussion_content":"GridSearchCV ç”¨äºsklearnåº“ä¸­çš„æ¨¡å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77858,"user_name":"ç™½å¤œ","can_delete":false,"product_type":"c1","uid":1354449,"ip_address":"","ucode":"7AABFA7C04EA34","user_header":"https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg","comment_is_top":false,"comment_ctime":1553008171,"is_pvip":false,"replies":[{"id":"64396","content":"æœ‰æ¶¨æœ‰è·Œ æ­¤æ—¶æ­¤åˆ»æ˜¯2019å¹´12æœˆ29æ—¥ï¼Œå½“å‰æ²ªå¸‚æŒ‡æ•°ä¸º3005.04ç‚¹ï¼Œä½ è¯´å‡†ä¸å‡†","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618321,"ip_address":"","comment_id":77858,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553008171","product_id":100021701,"comment_content":"2019-03-31    2808.787904<br>2019-04-30    2881.416121<br>2019-05-31    2875.788248<br>2019-06-30    2885.653128<br>2019-07-31    2959.346386<br>2019-08-31    3003.165403<br>2019-09-30    2991.057003<br>2019-10-31    2995.312025<br>2019-11-30    3016.652431<br>2019-12-31    2997.065752<br>è¿™æ˜¯çœ‹æ¶¨å•Š","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443876,"discussion_content":"æœ‰æ¶¨æœ‰è·Œ æ­¤æ—¶æ­¤åˆ»æ˜¯2019å¹´12æœˆ29æ—¥ï¼Œå½“å‰æ²ªå¸‚æŒ‡æ•°ä¸º3005.04ç‚¹ï¼Œä½ è¯´å‡†ä¸å‡†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77352,"user_name":"Grandia_Z","can_delete":false,"product_type":"c1","uid":1354034,"ip_address":"","ucode":"4928A7ABA7C24C","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/32/eb71b457.jpg","comment_is_top":false,"comment_ctime":1552910841,"is_pvip":false,"replies":[{"id":"64403","content":"ä½ å¯ä»¥å†™ä¸ªç¨‹åºæ¥ä½œä¸ºdata_listçš„è¾“å…¥","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577618407,"ip_address":"","comment_id":77352,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1552910841","product_id":100021701,"comment_content":"æé—®:å¯¹æœªæ¥åä¸ªæœˆçš„å˜åŒ–è¿›è¡Œç»Ÿè®¡,å¦‚æœæŒ‰æ—¥ç»Ÿè®¡çš„è¯:<br>date_list= [datetime(2019, 3, 31), datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30), datetime(2019, 7, 31),<br>             datetime(2019, 8, 31), datetime(2019, 9, 30), datetime(2019, 10, 31),datetime(2019, 11, 30),datetime(2019, 12, 31)]<br>ä¸Šé¢è¿™æ®µæ€ä¹ˆå†™èƒ½åŒ…å«ä»(2019.3.1-2019.12.31)çš„æ•°æ®å‘¢,ä¸ä¼šæŠŠæ¯ä¸€å¤©éƒ½å†™è¿›å»å§","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443694,"discussion_content":"ä½ å¯ä»¥å†™ä¸ªç¨‹åºæ¥ä½œä¸ºdata_listçš„è¾“å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577618407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1209322,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/ea/9c9acc43.jpg","nickname":"Jackom","note":"","ucode":"166111CDB92469","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216282,"discussion_content":"date_range_ = pd.date_range(start=&#39;2019-03-01&#39;, end=&#39;2019-12-31&#39;, freq=&#39;M&#39;)\ndate_list_ = date_range_.to_list() #æˆ–è€… date_range_.to_series()\nfuture_date = pd.DataFrame(index=date_list_, columns= df_month.columns)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585411695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}