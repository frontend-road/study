{"id":97231,"title":"38 | æ¡ˆä¾‹åˆ†æï¼ˆä¸€ï¼‰ï¼šé«˜æ€§èƒ½é™æµå™¨Guava RateLimiter","content":"<p>ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä»¬å°±è¿›å…¥æ¡ˆä¾‹åˆ†ææ¨¡å—äº†ã€‚ è¿™ä¸ªæ¨¡å—æˆ‘ä»¬å°†åˆ†æå››ä¸ªç»å…¸çš„å¼€æºæ¡†æ¶ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•å¤„ç†å¹¶å‘é—®é¢˜çš„ï¼Œé€šè¿‡è¿™å››ä¸ªæ¡ˆä¾‹çš„å­¦ä¹ ï¼Œç›¸ä¿¡ä½ ä¼šå¯¹å¦‚ä½•è§£å†³å¹¶å‘é—®é¢˜æœ‰ä¸ªæ›´æ·±å…¥çš„è®¤è¯†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹<strong>Guava RateLimiteræ˜¯å¦‚ä½•è§£å†³é«˜å¹¶å‘åœºæ™¯ä¸‹çš„é™æµé—®é¢˜çš„</strong>ã€‚Guavaæ˜¯Googleå¼€æºçš„Javaç±»åº“ï¼Œæä¾›äº†ä¸€ä¸ªå·¥å…·ç±»RateLimiterã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹RateLimiterçš„ä½¿ç”¨ï¼Œè®©ä½ å¯¹é™æµæœ‰ä¸ªæ„Ÿå®˜çš„å°è±¡ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå®ƒæ¯ç§’åªèƒ½å¤„ç†ä¸¤ä¸ªä»»åŠ¡ï¼Œå¦‚æœæäº¤çš„ä»»åŠ¡è¿‡å¿«ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿä¸ç¨³å®šï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°é™æµã€‚</p><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæµé€Ÿä¸º2ä¸ªè¯·æ±‚/ç§’çš„é™æµå™¨ï¼Œè¿™é‡Œçš„æµé€Ÿè¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿç›´è§‚åœ°çœ‹ï¼Œ2ä¸ªè¯·æ±‚/ç§’æŒ‡çš„æ˜¯æ¯ç§’æœ€å¤šå…è®¸2ä¸ªè¯·æ±‚é€šè¿‡é™æµå™¨ï¼Œå…¶å®åœ¨Guavaä¸­ï¼Œæµé€Ÿè¿˜æœ‰æ›´æ·±ä¸€å±‚çš„æ„æ€ï¼šæ˜¯ä¸€ç§åŒ€é€Ÿçš„æ¦‚å¿µï¼Œ2ä¸ªè¯·æ±‚/ç§’ç­‰ä»·äº1ä¸ªè¯·æ±‚/500æ¯«ç§’ã€‚</p><p>åœ¨å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ä¹‹å‰ï¼Œè°ƒç”¨ <code>acquire()</code> æ–¹æ³•å°±èƒ½èµ·åˆ°é™æµçš„ä½œç”¨ã€‚é€šè¿‡ç¤ºä¾‹ä»£ç çš„æ‰§è¡Œç»“æœï¼Œä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± çš„æ—¶é—´é—´éš”åŸºæœ¬ä¸Šç¨³å®šåœ¨500æ¯«ç§’ã€‚</p><pre><code>//é™æµå™¨æµé€Ÿï¼š2ä¸ªè¯·æ±‚/ç§’\nRateLimiter limiter = \n  RateLimiter.create(2.0);\n//æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± \nExecutorService es = Executors\n  .newFixedThreadPool(1);\n//è®°å½•ä¸Šä¸€æ¬¡æ‰§è¡Œæ—¶é—´\nprev = System.nanoTime();\n//æµ‹è¯•æ‰§è¡Œ20æ¬¡\nfor (int i=0; i&lt;20; i++){\n  //é™æµå™¨é™æµ\n  limiter.acquire();\n  //æäº¤ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œ\n  es.execute(()-&gt;{\n    long cur=System.nanoTime();\n    //æ‰“å°æ—¶é—´é—´éš”ï¼šæ¯«ç§’\n    System.out.println(\n      (cur-prev)/1000_000);\n    prev = cur;\n  });\n}\n\nè¾“å‡ºç»“æœï¼š\n...\n500\n499\n499\n500\n499\n</code></pre><h2>ç»å…¸é™æµç®—æ³•ï¼šä»¤ç‰Œæ¡¶ç®—æ³•</h2><p>Guavaçš„é™æµå™¨ä½¿ç”¨ä¸Šè¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œé‚£å®ƒæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼ŸGuavaé‡‡ç”¨çš„æ˜¯<strong>ä»¤ç‰Œæ¡¶ç®—æ³•</strong>ï¼Œå…¶<strong>æ ¸å¿ƒæ˜¯è¦æƒ³é€šè¿‡é™æµå™¨ï¼Œå¿…é¡»æ‹¿åˆ°ä»¤ç‰Œ</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿé™åˆ¶å‘æ”¾ä»¤ç‰Œçš„é€Ÿç‡ï¼Œé‚£ä¹ˆå°±èƒ½æ§åˆ¶æµé€Ÿäº†ã€‚ä»¤ç‰Œæ¡¶ç®—æ³•çš„è¯¦ç»†æè¿°å¦‚ä¸‹ï¼š</p><!-- [[[read_end]]] --><ol>\n<li>ä»¤ç‰Œä»¥å›ºå®šçš„é€Ÿç‡æ·»åŠ åˆ°ä»¤ç‰Œæ¡¶ä¸­ï¼Œå‡è®¾é™æµçš„é€Ÿç‡æ˜¯ r/ç§’ï¼Œåˆ™ä»¤ç‰Œæ¯ 1/r ç§’ä¼šæ·»åŠ ä¸€ä¸ªï¼›</li>\n<li>å‡è®¾ä»¤ç‰Œæ¡¶çš„å®¹é‡æ˜¯ b ï¼Œå¦‚æœä»¤ç‰Œæ¡¶å·²æ»¡ï¼Œåˆ™æ–°çš„ä»¤ç‰Œä¼šè¢«ä¸¢å¼ƒï¼›</li>\n<li>è¯·æ±‚èƒ½å¤Ÿé€šè¿‡é™æµå™¨çš„å‰ææ˜¯ä»¤ç‰Œæ¡¶ä¸­æœ‰ä»¤ç‰Œã€‚</li>\n</ol><p>è¿™ä¸ªç®—æ³•ä¸­ï¼Œé™æµçš„é€Ÿç‡ r è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œä½†ä»¤ç‰Œæ¡¶çš„å®¹é‡ b è¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿb å…¶å®æ˜¯burstçš„ç®€å†™ï¼Œæ„ä¹‰æ˜¯<strong>é™æµå™¨å…è®¸çš„æœ€å¤§çªå‘æµé‡</strong>ã€‚æ¯”å¦‚b=10ï¼Œè€Œä¸”ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œå·²æ»¡ï¼Œæ­¤æ—¶é™æµå™¨å…è®¸10ä¸ªè¯·æ±‚åŒæ—¶é€šè¿‡é™æµå™¨ï¼Œå½“ç„¶åªæ˜¯çªå‘æµé‡è€Œå·²ï¼Œè¿™10ä¸ªè¯·æ±‚ä¼šå¸¦èµ°10ä¸ªä»¤ç‰Œï¼Œæ‰€ä»¥åç»­çš„æµé‡åªèƒ½æŒ‰ç…§é€Ÿç‡ r é€šè¿‡é™æµå™¨ã€‚</p><p>ä»¤ç‰Œæ¡¶è¿™ä¸ªç®—æ³•ï¼Œå¦‚ä½•ç”¨Javaå®ç°å‘¢ï¼Ÿå¾ˆå¯èƒ½ä½ çš„ç›´è§‰ä¼šå‘Šè¯‰ä½ ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼šä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹å®šæ—¶å‘é˜»å¡é˜Ÿåˆ—ä¸­æ·»åŠ ä»¤ç‰Œï¼Œè€Œè¯•å›¾é€šè¿‡é™æµå™¨çš„çº¿ç¨‹åˆ™ä½œä¸ºæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œåªæœ‰ä»é˜»å¡é˜Ÿåˆ—ä¸­è·å–åˆ°ä»¤ç‰Œï¼Œæ‰å…è®¸é€šè¿‡é™æµå™¨ã€‚</p><p>è¿™ä¸ªç®—æ³•çœ‹ä¸Šå»éå¸¸å®Œç¾ï¼Œè€Œä¸”å®ç°èµ·æ¥éå¸¸ç®€å•ï¼Œå¦‚æœå¹¶å‘é‡ä¸å¤§ï¼Œè¿™ä¸ªå®ç°å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚å¯å®é™…æƒ…å†µå´æ˜¯ä½¿ç”¨é™æµçš„åœºæ™¯å¤§éƒ¨åˆ†éƒ½æ˜¯é«˜å¹¶å‘åœºæ™¯ï¼Œè€Œä¸”ç³»ç»Ÿå‹åŠ›å·²ç»ä¸´è¿‘æé™äº†ï¼Œæ­¤æ—¶è¿™ä¸ªå®ç°å°±æœ‰é—®é¢˜äº†ã€‚é—®é¢˜å°±å‡ºåœ¨å®šæ—¶å™¨ä¸Šï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå½“ç³»ç»Ÿå‹åŠ›å·²ç»ä¸´è¿‘æé™çš„æ—¶å€™ï¼Œå®šæ—¶å™¨çš„ç²¾åº¦è¯¯å·®ä¼šéå¸¸å¤§ï¼ŒåŒæ—¶å®šæ—¶å™¨æœ¬èº«ä¼šåˆ›å»ºè°ƒåº¦çº¿ç¨‹ï¼Œä¹Ÿä¼šå¯¹ç³»ç»Ÿçš„æ€§èƒ½äº§ç”Ÿå½±å“ã€‚</p><p>é‚£è¿˜æœ‰ä»€ä¹ˆå¥½çš„å®ç°æ–¹å¼å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼ŒGuavaçš„å®ç°å°±æ²¡æœ‰ä½¿ç”¨å®šæ—¶å™¨ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><h2>Guavaå¦‚ä½•å®ç°ä»¤ç‰Œæ¡¶ç®—æ³•</h2><p>Guavaå®ç°ä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œç”¨äº†ä¸€ä¸ªå¾ˆç®€å•çš„åŠæ³•ï¼Œå…¶å…³é”®æ˜¯<strong>è®°å½•å¹¶åŠ¨æ€è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œå‘æ”¾çš„æ—¶é—´</strong>ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥ä¸€ä¸ªæœ€ç®€å•çš„åœºæ™¯æ¥ä»‹ç»è¯¥ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ã€‚å‡è®¾ä»¤ç‰Œæ¡¶çš„å®¹é‡ä¸º b=1ï¼Œé™æµé€Ÿç‡ r = 1ä¸ªè¯·æ±‚/ç§’ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœå½“å‰ä»¤ç‰Œæ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œï¼Œä¸‹ä¸€ä¸ªä»¤ç‰Œçš„å‘æ”¾æ—¶é—´æ˜¯åœ¨ç¬¬3ç§’ï¼Œè€Œåœ¨ç¬¬2ç§’çš„æ—¶å€™æœ‰ä¸€ä¸ªçº¿ç¨‹T1è¯·æ±‚ä»¤ç‰Œï¼Œæ­¤æ—¶è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/39/ce/391179821a55fc798c9c17a6991c1dce.png?wh=1142*478\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T1è¯·æ±‚ä»¤ç‰Œç¤ºæ„å›¾</span></center><p>å¯¹äºè¿™ä¸ªè¯·æ±‚ä»¤ç‰Œçš„çº¿ç¨‹è€Œè¨€ï¼Œå¾ˆæ˜¾ç„¶éœ€è¦ç­‰å¾…1ç§’ï¼Œå› ä¸º1ç§’ä»¥åï¼ˆç¬¬3ç§’ï¼‰å®ƒå°±èƒ½æ‹¿åˆ°ä»¤ç‰Œäº†ã€‚æ­¤æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾çš„æ—¶é—´ä¹Ÿè¦å¢åŠ 1ç§’ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºç¬¬3ç§’å‘æ”¾çš„ä»¤ç‰Œå·²ç»è¢«çº¿ç¨‹T1é¢„å äº†ã€‚å¤„ç†ä¹‹åå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1a/87/1a4069c830e18de087ba7f490aa78087.png?wh=1142*284\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T1è¯·æ±‚ç»“æŸç¤ºæ„å›¾</span></center><p>å‡è®¾T1åœ¨é¢„å äº†ç¬¬3ç§’çš„ä»¤ç‰Œä¹‹åï¼Œé©¬ä¸Šåˆæœ‰ä¸€ä¸ªçº¿ç¨‹T2è¯·æ±‚ä»¤ç‰Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2c/2e/2cf695d0888a93e1e2d020d9514f5a2e.png?wh=1142*367\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T2è¯·æ±‚ä»¤ç‰Œç¤ºæ„å›¾</span></center><p>å¾ˆæ˜¾ç„¶ï¼Œç”±äºä¸‹ä¸€ä¸ªä»¤ç‰Œäº§ç”Ÿçš„æ—¶é—´æ˜¯ç¬¬4ç§’ï¼Œæ‰€ä»¥çº¿ç¨‹T2è¦ç­‰å¾…ä¸¤ç§’çš„æ—¶é—´ï¼Œæ‰èƒ½è·å–åˆ°ä»¤ç‰Œï¼ŒåŒæ—¶ç”±äºT2é¢„å äº†ç¬¬4ç§’çš„ä»¤ç‰Œï¼Œæ‰€ä»¥ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´è¿˜è¦å¢åŠ 1ç§’ï¼Œå®Œå…¨å¤„ç†ä¹‹åï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/68/f7/68c09a96049aacda7936c52b801c22f7.png?wh=1142*377\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T2è¯·æ±‚ç»“æŸç¤ºæ„å›¾</span></center><p>ä¸Šé¢çº¿ç¨‹T1ã€T2éƒ½æ˜¯åœ¨<strong>ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å‰</strong>è¯·æ±‚ä»¤ç‰Œï¼Œå¦‚æœçº¿ç¨‹åœ¨<strong>ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å</strong>è¯·æ±‚ä»¤ç‰Œä¼šå¦‚ä½•å‘¢ï¼Ÿå‡è®¾åœ¨çº¿ç¨‹T1è¯·æ±‚ä»¤ç‰Œä¹‹åçš„5ç§’ï¼Œä¹Ÿå°±æ˜¯ç¬¬7ç§’ï¼Œçº¿ç¨‹T3è¯·æ±‚ä»¤ç‰Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e3/5c/e3125d72eb3d84eabf6de6ab987e695c.png?wh=1142*342\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T3è¯·æ±‚ä»¤ç‰Œç¤ºæ„å›¾</span></center><p>ç”±äºåœ¨ç¬¬5ç§’å·²ç»äº§ç”Ÿäº†ä¸€ä¸ªä»¤ç‰Œï¼Œæ‰€ä»¥æ­¤æ—¶çº¿ç¨‹T3å¯ä»¥ç›´æ¥æ‹¿åˆ°ä»¤ç‰Œï¼Œè€Œæ— éœ€ç­‰å¾…ã€‚åœ¨ç¬¬7ç§’ï¼Œå®é™…ä¸Šé™æµå™¨èƒ½å¤Ÿäº§ç”Ÿ3ä¸ªä»¤ç‰Œï¼Œç¬¬5ã€6ã€7ç§’å„äº§ç”Ÿä¸€ä¸ªä»¤ç‰Œã€‚ç”±äºæˆ‘ä»¬å‡è®¾ä»¤ç‰Œæ¡¶çš„å®¹é‡æ˜¯1ï¼Œæ‰€ä»¥ç¬¬6ã€7ç§’äº§ç”Ÿçš„ä»¤ç‰Œå°±ä¸¢å¼ƒäº†ï¼Œå…¶å®ç­‰ä»·åœ°ä½ ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¿ç•™çš„ç¬¬7ç§’çš„ä»¤ç‰Œï¼Œä¸¢å¼ƒçš„ç¬¬5ã€6ç§’çš„ä»¤ç‰Œï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬7ç§’çš„ä»¤ç‰Œè¢«çº¿ç¨‹T3å æœ‰äº†ï¼Œäºæ˜¯ä¸‹ä¸€ä»¤ç‰Œçš„çš„äº§ç”Ÿæ—¶é—´åº”è¯¥æ˜¯ç¬¬8ç§’ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/fc/baf159d05b2abf650839e29a2399a4fc.png?wh=1142*344\" alt=\"\"></p><center><span class=\"reference\">çº¿ç¨‹T3è¯·æ±‚ç»“æŸç¤ºæ„å›¾</span></center><p>é€šè¿‡ä¸Šé¢ç®€è¦åœ°åˆ†æï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬<strong>åªéœ€è¦è®°å½•ä¸€ä¸ªä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿçš„æ—¶é—´ï¼Œå¹¶åŠ¨æ€æ›´æ–°å®ƒï¼Œå°±èƒ½å¤Ÿè½»æ¾å®Œæˆé™æµåŠŸèƒ½</strong>ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„è¿™ä¸ªç®—æ³•ä»£ç åŒ–ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œä¾ç„¶å‡è®¾ä»¤ç‰Œæ¡¶çš„å®¹é‡æ˜¯1ã€‚å…³é”®æ˜¯<strong>reserve()æ–¹æ³•</strong>ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šä¸ºè¯·æ±‚ä»¤ç‰Œçš„çº¿ç¨‹é¢„åˆ†é…ä»¤ç‰Œï¼ŒåŒæ—¶è¿”å›è¯¥çº¿ç¨‹èƒ½å¤Ÿè·å–ä»¤ç‰Œçš„æ—¶é—´ã€‚å…¶å®ç°é€»è¾‘å°±æ˜¯ä¸Šé¢æåˆ°çš„ï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚ä»¤ç‰Œçš„æ—¶é—´åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹åï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹ç«‹åˆ»å°±èƒ½å¤Ÿè·å–ä»¤ç‰Œï¼›åä¹‹ï¼Œå¦‚æœè¯·æ±‚æ—¶é—´åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å‰ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹æ˜¯åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿçš„æ—¶é—´è·å–ä»¤ç‰Œã€‚ç”±äºæ­¤æ—¶ä¸‹ä¸€ä»¤ç‰Œå·²ç»è¢«è¯¥çº¿ç¨‹é¢„å ï¼Œæ‰€ä»¥ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿçš„æ—¶é—´éœ€è¦åŠ ä¸Š1ç§’ã€‚</p><pre><code>class SimpleLimiter {\n  //ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´\n  long next = System.nanoTime();\n  //å‘æ”¾ä»¤ç‰Œé—´éš”ï¼šçº³ç§’\n  long interval = 1000_000_000;\n  //é¢„å ä»¤ç‰Œï¼Œè¿”å›èƒ½å¤Ÿè·å–ä»¤ç‰Œçš„æ—¶é—´\n  synchronized long reserve(long now){\n    //è¯·æ±‚æ—¶é—´åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å\n    //é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´\n    if (now &gt; next){\n      //å°†ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´é‡ç½®ä¸ºå½“å‰æ—¶é—´\n      next = now;\n    }\n    //èƒ½å¤Ÿè·å–ä»¤ç‰Œçš„æ—¶é—´\n    long at=next;\n    //è®¾ç½®ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´\n    next += interval;\n    //è¿”å›çº¿ç¨‹éœ€è¦ç­‰å¾…çš„æ—¶é—´\n    return Math.max(at, 0L);\n  }\n  //ç”³è¯·ä»¤ç‰Œ\n  void acquire() {\n    //ç”³è¯·ä»¤ç‰Œæ—¶çš„æ—¶é—´\n    long now = System.nanoTime();\n    //é¢„å ä»¤ç‰Œ\n    long at=reserve(now);\n    long waitTime=max(at-now, 0);\n    //æŒ‰ç…§æ¡ä»¶ç­‰å¾…\n    if(waitTime &gt; 0) {\n      try {\n        TimeUnit.NANOSECONDS\n          .sleep(waitTime);\n      }catch(InterruptedException e){\n        e.printStackTrace();\n      }\n    }\n  }\n}\n</code></pre><p>å¦‚æœä»¤ç‰Œæ¡¶çš„å®¹é‡å¤§äº1ï¼Œåˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼ŸæŒ‰ç…§ä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œä»¤ç‰Œè¦é¦–å…ˆä»ä»¤ç‰Œæ¡¶ä¸­å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‰éœ€è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„æ•°é‡ï¼Œå½“æœ‰çº¿ç¨‹è¯·æ±‚ä»¤ç‰Œæ—¶ï¼Œå…ˆä»ä»¤ç‰Œæ¡¶ä¸­å‡ºã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ª<strong>resync()æ–¹æ³•</strong>ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå¦‚æœçº¿ç¨‹è¯·æ±‚ä»¤ç‰Œçš„æ—¶é—´åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹åï¼Œä¼šé‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œæ•°ï¼Œ<strong>æ–°äº§ç”Ÿçš„ä»¤ç‰Œçš„è®¡ç®—å…¬å¼æ˜¯ï¼š(now-next)/interval</strong>ï¼Œä½ å¯å¯¹ç…§ä¸Šé¢çš„ç¤ºæ„å›¾æ¥ç†è§£ã€‚reserve()æ–¹æ³•ä¸­ï¼Œåˆ™å¢åŠ äº†å…ˆä»ä»¤ç‰Œæ¡¶ä¸­å‡ºä»¤ç‰Œçš„é€»è¾‘ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä»¤ç‰Œæ˜¯ä»ä»¤ç‰Œæ¡¶ä¸­å‡ºçš„ï¼Œé‚£ä¹ˆnextå°±æ— éœ€å¢åŠ ä¸€ä¸ª interval äº†ã€‚</p><pre><code>class SimpleLimiter {\n  //å½“å‰ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œæ•°é‡\n  long storedPermits = 0;\n  //ä»¤ç‰Œæ¡¶çš„å®¹é‡\n  long maxPermits = 3;\n  //ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´\n  long next = System.nanoTime();\n  //å‘æ”¾ä»¤ç‰Œé—´éš”ï¼šçº³ç§’\n  long interval = 1000_000_000;\n  \n  //è¯·æ±‚æ—¶é—´åœ¨ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å,åˆ™\n  // 1.é‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œæ•°\n  // 2.å°†ä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾æ—¶é—´é‡ç½®ä¸ºå½“å‰æ—¶é—´\n  void resync(long now) {\n    if (now &gt; next) {\n      //æ–°äº§ç”Ÿçš„ä»¤ç‰Œæ•°\n      long newPermits=(now-next)/interval;\n      //æ–°ä»¤ç‰Œå¢åŠ åˆ°ä»¤ç‰Œæ¡¶\n      storedPermits=min(maxPermits, \n        storedPermits + newPermits);\n      //å°†ä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾æ—¶é—´é‡ç½®ä¸ºå½“å‰æ—¶é—´\n      next = now;\n    }\n  }\n  //é¢„å ä»¤ç‰Œï¼Œè¿”å›èƒ½å¤Ÿè·å–ä»¤ç‰Œçš„æ—¶é—´\n  synchronized long reserve(long now){\n    resync(now);\n    //èƒ½å¤Ÿè·å–ä»¤ç‰Œçš„æ—¶é—´\n    long at = next;\n    //ä»¤ç‰Œæ¡¶ä¸­èƒ½æä¾›çš„ä»¤ç‰Œ\n    long fb=min(1, storedPermits);\n    //ä»¤ç‰Œå‡€éœ€æ±‚ï¼šé¦–å…ˆå‡æ‰ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ\n    long nr = 1 - fb;\n    //é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´\n    next = next + nr*interval;\n    //é‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ\n    this.storedPermits -= fb;\n    return at;\n  }\n  //ç”³è¯·ä»¤ç‰Œ\n  void acquire() {\n    //ç”³è¯·ä»¤ç‰Œæ—¶çš„æ—¶é—´\n    long now = System.nanoTime();\n    //é¢„å ä»¤ç‰Œ\n    long at=reserve(now);\n    long waitTime=max(at-now, 0);\n    //æŒ‰ç…§æ¡ä»¶ç­‰å¾…\n    if(waitTime &gt; 0) {\n      try {\n        TimeUnit.NANOSECONDS\n          .sleep(waitTime);\n      }catch(InterruptedException e){\n        e.printStackTrace();\n      }\n    }\n  }\n}\n</code></pre><h2>æ€»ç»“</h2><p>ç»å…¸çš„é™æµç®—æ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯<strong>ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰</strong>ï¼Œå¦ä¸€ä¸ªæ˜¯<strong>æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰</strong>ã€‚ä»¤ç‰Œæ¡¶ç®—æ³•æ˜¯å®šæ—¶å‘ä»¤ç‰Œæ¡¶å‘é€ä»¤ç‰Œï¼Œè¯·æ±‚èƒ½å¤Ÿä»ä»¤ç‰Œæ¡¶ä¸­æ‹¿åˆ°ä»¤ç‰Œï¼Œç„¶åæ‰èƒ½é€šè¿‡é™æµå™¨ï¼›è€Œæ¼æ¡¶ç®—æ³•é‡Œï¼Œè¯·æ±‚å°±åƒæ°´ä¸€æ ·æ³¨å…¥æ¼æ¡¶ï¼Œæ¼æ¡¶ä¼šæŒ‰ç…§ä¸€å®šçš„é€Ÿç‡è‡ªåŠ¨å°†æ°´æ¼æ‰ï¼Œåªæœ‰æ¼æ¡¶é‡Œè¿˜èƒ½æ³¨å…¥æ°´çš„æ—¶å€™ï¼Œè¯·æ±‚æ‰èƒ½é€šè¿‡é™æµå™¨ã€‚ä»¤ç‰Œæ¡¶ç®—æ³•å’Œæ¼æ¡¶ç®—æ³•å¾ˆåƒä¸€ä¸ªç¡¬å¸çš„æ­£åé¢ï¼Œæ‰€ä»¥ä½ å¯ä»¥å‚è€ƒä»¤ç‰Œæ¡¶ç®—æ³•çš„å®ç°æ¥å®ç°æ¼æ¡¶ç®—æ³•ã€‚</p><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†Guavaæ˜¯å¦‚ä½•å®ç°ä»¤ç‰Œæ¡¶ç®—æ³•çš„ï¼Œæˆ‘ä»¬çš„ç¤ºä¾‹ä»£ç æ˜¯å¯¹Guava RateLimiterçš„ç®€åŒ–ï¼ŒGuava RateLimiteræ‰©å±•äº†æ ‡å‡†çš„ä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œæ¯”å¦‚è¿˜èƒ½æ”¯æŒé¢„çƒ­åŠŸèƒ½ã€‚å¯¹äºæŒ‰éœ€åŠ è½½çš„ç¼“å­˜æ¥è¯´ï¼Œé¢„çƒ­åç¼“å­˜èƒ½æ”¯æŒ5ä¸‡TPSçš„å¹¶å‘ï¼Œä½†æ˜¯åœ¨é¢„çƒ­å‰5ä¸‡TPSçš„å¹¶å‘ç›´æ¥å°±æŠŠç¼“å­˜å‡»å®äº†ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦ç»™è¯¥ç¼“å­˜é™æµï¼Œé™æµå™¨ä¹Ÿéœ€è¦æ”¯æŒé¢„çƒ­åŠŸèƒ½ï¼Œåœ¨åˆå§‹é˜¶æ®µï¼Œé™åˆ¶çš„æµé€Ÿ r å¾ˆå°ï¼Œä½†æ˜¯åŠ¨æ€å¢é•¿çš„ã€‚é¢„çƒ­åŠŸèƒ½çš„å®ç°éå¸¸å¤æ‚ï¼ŒGuavaæ„å»ºäº†ä¸€ä¸ªç§¯åˆ†å‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥ç»§ç»­æ·±å…¥ç ”ç©¶ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":122087,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1565281945,"is_pvip":false,"replies":[{"id":"44970","content":"ğŸ‘æ¡ç†æ¸…æ™°","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1565429276,"ip_address":"","comment_id":122087,"utype":1}],"discussion_count":6,"race_medal":0,"score":"254968352409","product_id":100023901,"comment_content":"reï¼šä¸ºä»€ä¹ˆä»¤ç‰Œæ˜¯ä»ä»¤ç‰Œæ¡¶ä¸­å‡ºçš„ï¼Œé‚£ä¹ˆ next å°±æ— éœ€å¢åŠ ä¸€ä¸ª intervalï¼Ÿ<br><br>next å˜é‡çš„æ„æ€æ˜¯ä¸‹ä¸€ä¸ªä»¤ç‰Œçš„ç”Ÿæˆæ—¶é—´ï¼Œå¯ä»¥ç†è§£ä¸ºå½“å‰çº¿ç¨‹è¯·æ±‚çš„ä»¤ç‰Œçš„ç”Ÿæˆæ—¶åˆ»ï¼Œå¦‚ç¬¬ä¸€å¼ å›¾æ‰€ç¤ºï¼šçº¿ç¨‹ T1 çš„ä»¤ç‰Œçš„ç”Ÿæˆæ—¶åˆ»æ˜¯ç¬¬ä¸‰ç§’ã€‚<br><br>çº¿ç¨‹ T è¯·æ±‚æ—¶ï¼Œå­˜åœ¨ä¸‰ç§åœºæ™¯ï¼š<br>1. æ¡¶é‡Œæœ‰å‰©ä½™ä»¤ç‰Œã€‚<br>2. åˆšåˆ›å»ºä»¤ç‰Œï¼Œçº¿ç¨‹åŒæ—¶è¯·æ±‚ã€‚<br>3. æ¡¶é‡Œæ— å‰©ä½™ä»¤ç‰Œã€‚<br><br>åœºæ™¯ 2 å¯ä»¥æƒ³è±¡æˆçº¿ç¨‹è¯·æ±‚çš„åŒæ—¶ä»¤ç‰Œåˆšå¥½ç”Ÿæˆï¼Œæ²¡æ¥å¾—åŠæ”¾å…¥æ¡¶å†…å°±è¢«çº¿ç¨‹ T æ‹¿èµ°äº†ã€‚å› æ­¤å°†åœºæ™¯ 2 å’Œåœºæ™¯ 3 åˆå¹¶æˆä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯æ¡¶é‡Œæ²¡ä»¤ç‰Œã€‚å³çº¿ç¨‹è¯·æ±‚æ—¶ï¼Œæ¡¶é‡Œå¯åˆ†ä¸ºæœ‰ä»¤ç‰Œå’Œæ²¡ä»¤ç‰Œã€‚<br><br>â€œæ¡¶é‡Œæ²¡ä»¤ç‰Œâ€ï¼Œçº¿ç¨‹ T éœ€è¦ç­‰å¾…ï¼›éœ€è¦ç­‰å¾…åˆ™æ„å‘³ç€ now(çº¿ç¨‹ T è¯·æ±‚æ—¶åˆ») å°äºç­‰äº next(çº¿ç¨‹ T æ‰€éœ€çš„ä»¤ç‰Œçš„ç”Ÿæˆæ—¶åˆ»)ã€‚è¿™é‡Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹çº¿ç¨‹ T åœ¨è‹¦è‹¦ç­‰å¾…ä»¤ç‰Œç”Ÿæˆçš„åœºæ™¯ï¼Œåªè¦çº¿ç¨‹ T ç­‰å¾…é‚£ä¹ˆä¹…ä¹‹åï¼Œå°±ä¼šè¢«æ”¾è¡Œã€‚æ”¾è¡Œè¿™ä¸€åˆ»ä»¤ç‰ŒåŒæ—¶ç”Ÿæˆï¼Œç«‹é©¬è¢«çº¿ç¨‹æ‹¿èµ°ï¼Œä»¤ç‰Œæ²¡æ”¾å…¥æ¡¶é‡Œã€‚å¯¹åº”åˆ°ä»£ç å°±æ˜¯ resync æ–¹æ³•æ²¡æœ‰è¿›å…¥ if è¯­å¥å†…ã€‚<br><br>â€œæ¡¶é‡Œæœ‰ä»¤ç‰Œâ€ï¼Œçº¿ç¨‹ T ä¸éœ€è¦ç­‰å¾…ã€‚è¯´æ˜çº¿ç¨‹ T å¯¹åº”çš„ä»¤ç‰Œå·²ç»æ—©æ—©ç”Ÿæˆï¼Œå·²åœ¨æ¡¶å†…ã€‚ä»£ç å°±æ˜¯ï¼šnow &gt; nextï¼ˆè¯·æ±‚æ—¶åˆ»å¤§äºå¯¹åº”ä»¤ç‰Œçš„ç”Ÿæˆæ—¶åˆ»ï¼‰ã€‚å› æ­¤åœ¨åˆ†é…ä»¤ç‰Œç»™çº¿ç¨‹ä¹‹å‰ï¼Œéœ€è¦è®¡ç®—çº¿ç¨‹ T è¿Ÿåˆ°äº†å¤šä¹…ï¼Œè¿Ÿåˆ°çš„è¿™æ®µæ—¶é—´ï¼Œæœ‰å¤šå°‘ä¸ªä»¤ç‰Œç”ŸæˆÂ¹ï¼›ç„¶åæ”¾å…¥æ¡¶å†…ï¼Œæ»¡äº†åˆ™ä¸¢å¼ƒÂ²ï¼›æœªæ¥çš„çº¿ç¨‹çš„ä»¤ç‰Œåœ¨è¿™ä¸ªæ—¶åˆ»å·²ç»ç”Ÿæˆæ”¾å…¥æ¡¶å†…Â³ï¼ˆå³ resync æ–¹æ³•çš„é€»è¾‘ï¼‰ã€‚çº¿ç¨‹æ— éœ€ç­‰å¾…ï¼Œæ‰€ä»¥ä¸éœ€è¦å¢åŠ ä¸€ä¸ª interval äº†ã€‚<br><br>è§’æ ‡åˆ†åˆ«å¯¹åº” resync æ–¹æ³•å†…çš„ä»£ç ï¼š<br>Â¹: long newPermits=(now-next)&#47;interval;<br>Â²: storedPermits=min(maxPermits, <br>        storedPermits + newPermits);<br>Â³: next = now;","like_count":60,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462091,"discussion_content":"ğŸ‘æ¡ç†æ¸…æ™°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565429276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"è¥¿é—¨å¹ç‰›","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287247,"discussion_content":"ä¸ºä»€ä¹ˆä»¤ç‰Œæ˜¯ä»ä»¤ç‰Œæ¡¶ä¸­å‡ºçš„ï¼Œé‚£ä¹ˆ next å°±æ— éœ€å¢åŠ ä¸€ä¸ª intervalï¼Ÿ\nnext éœ€ä¸éœ€è¦å¢åŠ ä¸€ä¸ª intervalã€‚å’Œå½“å‰ä»¤ç‰Œæ¡¶çš„æ•°é‡æœ‰å…³ï¼›æ³¨æ„ä¸‹é¢ä¿©ç§æƒ…å†µï¼š\n1.å½“è¯·æ±‚çš„çº¿ç¨‹è¯·æ±‚åˆ°è¾¾åï¼Œä»¤ç‰Œæ¡¶æ²¡æœ‰å¯ç”¨çš„ä»¤ç‰Œï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹è¯·æ±‚çš„æ—¶åˆ»åœ¨æœ€åä¸€ä¸ªä»¤ç‰Œç”Ÿäº§çš„æ—¶é—´ä¹‹åã€‚è¿™ç§æƒ…å†µå› ä¸ºä»¤ç‰Œéƒ½æ˜¯å½“å‰æ—¶åˆ»ä¹‹å‰çš„ï¼Œéƒ½è¿‡æœŸäº†ï¼Œæ‰€ä»¥éœ€è¦ç­‰å¾…å…ˆåˆ›å»ºä»¤ç‰Œã€‚åˆ›å»ºä»¤ç‰Œå’Œæ¡¶çš„æœ€å¤§ä»¤ç‰Œæ•°æœ‰å…³ï¼Œè¿™é‡Œè¦æ¸…æ¥šä¸€ç‚¹ï¼Œæ¡¶ä¸­çš„ä»¤ç‰Œæ•°ï¼Œæ˜¯ä»å½“å‰æ—¶åˆ»å¾€åç®—ï¼Œæœ€å¤§èƒ½æå‰é¢„è®¡ç®—æ”¾å…¥å‡ ä¸ªï¼Œå½“å‰æ—¶åˆ»ä¹‹å‰çš„ä»¤ç‰Œï¼Œéƒ½ç®—è¿‡æœŸçš„ï¼Œæ—¶é—´éƒ½è¿‡äº†ï¼Œæ˜¯æ— ç”¨çš„ä»¤ç‰Œï¼Œå› ä¸ºï¼Œçº¿ç¨‹çº¿ç¨‹æ˜¯åœ¨å½“å‰æ—¶åˆ»å‘èµ·çš„ã€‚\n2. å¦‚æœå½“å‰çº¿ç¨‹è¯·æ±‚çš„æ—¶å€™åœ¨ä¸‹ä¸€ä¸ªä»¤ç‰Œnextæ—¶é—´ä¹‹å‰ï¼Œä¸ºä»€ä¹ˆçº¿ç¨‹åˆšåˆ°ï¼Œæ€ä¹ˆä¼šæœ‰åç»­çš„ä»¤ç‰Œå‘¢ï¼Œå› ä¸ºè¿™ç§æƒ…å†µï¼Œå°±æ˜¯ä¸Šé¢åˆ†æçš„ï¼Œä¼šé¢„å…ˆè®¡ç®—åç»­çš„ä»¤ç‰Œï¼Œè¿™å°±æ˜¯æ¡¶çš„ä»¤ç‰Œå®¹é‡çš„é—®é¢˜ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæœ‰é¢„å…ˆè®¡ç®—å¥½çš„ä»¤ç‰Œï¼Œæ— éœ€ç­‰å¾…æ–°å»ºä»¤ç‰Œçš„è¿‡ç¨‹ï¼Œç›´æ¥æ‹¿æ¥ç”¨å°±å¯ï¼Œæ‰€ä»¥ä¸æ¶‰åŠé‡æ–°è®¡ç®—ä»¤ç‰Œçš„è¿‡ç¨‹ã€‚ä¹Ÿå°±æ˜¯ä¸ä¼šé€šè¿‡resync(now)æ–¹æ³•é‡æ–°è®¡ç®—ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œç”±äºæ¡¶ä¸­æœ‰ä»¤ç‰Œï¼Œè¿™ä¸ªæœ‰ä»¤ç‰Œæ˜¯æŒ‡ä»¤ç‰Œä¼šåœ¨å½“å‰çº¿ç¨‹åˆ°è¾¾æ—¶åˆ»ä¹‹åé™†ç»­ç”Ÿäº§å‡ºæ¥ã€‚è€Œä¸”ä¸æ­¢ä¸€ä¸ªã€‚\nå¯¹åº”è€å¸ˆçš„åŸæ–‡ï¼šä»¤ç‰Œä»ä»¤ç‰Œæ¡¶ä¸­å‡ºçš„ï¼Œé‚£ä¹ˆ next å°±æ— éœ€å¢åŠ  intervalï¼Œæ„æ€å°±æ˜¯ä»¤ç‰Œæå‰æ ¹æ®æ¡¶çš„å®¹é‡è®¡ç®—å¥½äº†ï¼Œåç»­ä¼šè‡ªåŠ¨ç”Ÿäº§å‡ºæ¥ã€‚çº¿ç¨‹åˆ°æ¥çš„æ—¶åˆ»ï¼Œå› ä¸ºåç»­çš„ä»¤ç‰Œå·²ç»è¢«é¢„å…ˆè®¡ç®—è®¾ç½®å¥½çš„ã€‚åªæ˜¯ç­‰å¾…å®ƒçš„åˆ°æ¥ã€‚ç­‰æ¥äº†ã€‚é‚£ä¹ˆç›´æ¥æ‹¿æ¥ï¼Œç›¸å½“äºä»æ¡¶ä¸­ç›´æ¥æ‹¿æ¥ç”¨(æ¡¶ä¸­çš„å®¹é‡å°±ä»£è¡¨é¢„å…ˆè®¡ç®—å¥½è¦åˆ°æ¥çš„ä»¤ç‰Œä¸ªæ•°)ã€‚è¿™ä¸ªçš„å‰ä½“æ¡ä»¶æ˜¯å½“å‰çº¿ç¨‹çš„è¯·æ±‚æ—¶åˆ»ï¼Œåœ¨nextä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢åˆ†æçš„ç¬¬äºŒç‚¹åŸå› ï¼Œçº¿ç¨‹åªéœ€è¦ç­‰å¸¦åç»­æ—¶åˆ»æœ€è¿‘ç”Ÿäº§å‡ºæ¥çš„ä»¤ç‰Œç›´æ¥ç”¨å°±è¡Œï¼Œæ— éœ€å¢åŠ intervalã€‚æ­¤æ—¶çš„nextå°±æ˜¯ä¸‹ä¸€ä¸ªå¯ç”¨çš„ä»¤ç‰Œç”Ÿäº§çš„æ—¶é—´ã€‚\nè€Œå¦‚æœï¼Œçº¿ç¨‹è¿‡æ¥çš„æ—¶å€™ï¼Œæ¡¶ä¸­æ²¡æœ‰é¢„å…ˆè®¡ç®—çš„ä»¤ç‰Œå¯ç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢åˆ†æçš„ç¬¬ä¸€ç‚¹çš„åŸå› ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦é‡æ–°è®¡ç®—åç»­ç”Ÿäº§å‡ ä¸ªä»¤ç‰Œï¼Œè¿™ä¸ªè®¡ç®—ä¾èµ–æ¡¶çš„ä»¤ç‰Œå®¹é‡ã€‚è®¡ç®—å¥½ä¹‹åï¼Œå½“å‰çº¿ç¨‹ä¼šå–è®¡ç®—å¥½çš„ä»¤ç‰Œä¸­çš„æœ€å…ˆç”Ÿäº§å‡ºæ¥çš„æ‹¿æ¥ç”¨ï¼Œä¹Ÿå°±æ˜¯è·ç¦»è¯·æ±‚çº¿ç¨‹ä¹‹åæœ€è¿‘çš„æ—¶åˆ»ç”Ÿäº§å‡ºæ¥çš„ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œå› ä¸ºåœ¨è®¡ç®—ä¹‹å‰ï¼Œnextæ˜¯å½“å‰çº¿ç¨‹åˆ°è¾¾æ—¶åˆ»ä¹‹å‰çš„é‚£æ®µæ—¶é—´ä¸­æœ€åä¸€ä¸ªç”Ÿäº§ä»¤ç‰Œçš„æ—¶é—´ï¼Œè¿™ä¸ªä»¤ç‰Œè¿‡æœŸä¸å¯ç”¨ï¼Œç»è¿‡è®¡ç®—åï¼Œä¹Ÿå°±æ˜¯æ–°å»ºä»¤ç‰Œåï¼Œè¯·æ±‚çº¿ç¨‹è¦ç­‰å¾…æ–°å»ºç¬¬ä¸€ä¸ªä»¤ç‰Œçš„æ—¶åˆ»åˆ°äº†ä¹‹åï¼Œåœ¨æ‹¿æ¥ä½¿ç”¨ã€‚è€Œè¿™ä¸ªæ–°å»ºä»¤ç‰Œçš„ç”Ÿäº§çš„æ—¶é—´ï¼Œæ˜¯ä¹‹å‰çš„nextå¢åŠ ä¸€ä¸ª intervalä¹‹åçš„æ—¶é—´ã€‚è¿™ç§æƒ…å†µç›¸å½“äºï¼Œä¸æ˜¯ä»æ¡¶ä¸­ç›´æ¥å–çš„ï¼Œå› ä¸ºæ¡¶ä¸­æ²¡æœ‰ï¼Œéœ€æ–°å»ºä¸€ä¸ªï¼Œæ‹¿ä¸€ä¸ªï¼Œæ‰€ä»¥éœ€è¦å¢åŠ intervalï¼›è€Œä¸Šé¢çš„æƒ…å†µï¼Œæ˜¯æ¡¶ä¸­å°±æœ‰ä»¤ç‰Œï¼Œæ— éœ€æ–°å»ºï¼Œä¸éœ€è¦å¢åŠ intervalï¼›\nè¿™é‡Œæ³¨æ„ï¼Œæ¡¶çš„å®¹é‡ï¼Œä¸€å®šä¸è¦ç†è§£é”™è¯¯ï¼Œè¿™ä¸ªå®¹é‡æ˜¯ä¸ªåŠ¨æ€çš„è¿‡ç¨‹ï¼Œå¯ç†è§£ä¸ºé¢„å…ˆè®¡ç®—å‡ ä¸ªä»¤ç‰Œåˆ°æ¥çš„æ—¶åˆ»ï¼Œè¿™æ ·æ ¹æ®å®¹é‡ä¸€æ¬¡æ€§è®¡ç®—ä¹‹åçš„å‡ ä¸ªä»¤ç‰Œå¤šæ¥çš„æ—¶åˆ»ï¼Œå¯ä»¥é¿å…ä»¥åæ¯æ¬¡éƒ½è®¡ç®—ï¼›\nçº¿ç¨‹æ¥äº†ä¹‹åï¼Œä¸ä¹‹æ¯”è¾ƒçš„ä»¤ç‰Œæ˜¯å³å°†ç”Ÿäº§å‡ºæ¥çš„ä»¤ç‰Œçš„æ—¶åˆ»ã€‚\nè¦ç»†å“åˆ™ä¼šä¸ªä»¤ç‰Œçš„åŠ¨æ€è®¡ç®—è¿‡ç¨‹ï¼Œå’Œæ¡¶çš„å®¹é‡ã€‚å¾ˆå®¹æ˜“äº§ç”Ÿè¯¯è§£ã€‚\næ‰€ä»¥ã€‚ä»¤ç‰Œæ¡¶ç®—æ³•çš„æ ¸å¿ƒæ˜¯è®°å½•ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿçš„æ—¶é—´ï¼Œå¹¶åŠ¨æ€æ›´æ–°å®ƒï¼Œè¿™ä¸ªä¸‹ä¸€ä¸ªä»¤ç‰Œçš„ç”Ÿäº§æ—¶é—´æ˜¯è¿™ä¸ªæ¡¶å®¹é‡ä¸­çš„è·ç¦»å½“å‰è¯·æ±‚çº¿ç¨‹æœ€è¿‘æ—¶åˆ»çš„ä»¤ç‰Œç”Ÿäº§æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´å¯èƒ½åœ¨è¯·æ±‚çº¿ç¨‹åˆ°è¾¾ä¹‹å‰ï¼Œä¹Ÿå¯èƒ½åœ¨ä¹‹åï¼›\nåœ¨è¯·æ±‚çº¿ç¨‹ä¹‹å‰ï¼Œé‚£å°±éœ€è¦æ–°å»ºä»¤ç‰Œï¼Œå¹¶åŠ¨æ€çš„æ›´æ–°nextï¼Œä¹Ÿå°±æ˜¯nextè¦å¢åŠ ä¸€ä¸ªintervalã€‚\nåœ¨è¯·æ±‚çº¿ç¨‹ä¹‹åï¼Œè¯´æ˜æ¡¶ä¸­æœ‰ä»¤ç‰Œã€‚å¹¶ä¸”è¿™ä¸‹ä¸€ä¸ªä»¤ç‰Œçš„ç”Ÿäº§æ—¶é—´åœ¨è¿™ä¸ªè¯·æ±‚çº¿ç¨‹ä¹‹åï¼Œæ— éœ€å¢åŠ intervalã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593406697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1897671,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/f4/c7/037235c9.jpg","nickname":"kimoti","note":"","ucode":"0A78077408C2B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":275327,"discussion_content":"é«˜äºº","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590683284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1006297,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5a/d9/e74791a9.jpg","nickname":"é›ªå±±é£ç‹","note":"","ucode":"EA965A6D287C32","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211218,"discussion_content":"æ€»ç»“çš„çœŸå¥½ï¼Œçœ‹å®Œè¿™ä¸ªï¼Œæœ¬ç¯‡æ–‡ç« ç†è§£æ›´æ·±åˆ»äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584808726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10567,"discussion_content":"å­¦ä¹ äº†ï¼Œæ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568296194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1024294,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","nickname":"null","note":"","ucode":"F9039EFED6B55D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10617,"discussion_content":"å®¢æ°”è€é“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568298380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":10567,"ip_address":""},"score":10617,"extra":""}]}]},{"had_liked":false,"id":104874,"user_name":"èŠ±å„¿å°‘å¹´","can_delete":false,"product_type":"c1","uid":1318540,"ip_address":"","ucode":"CFE4F64243673B","user_header":"https://static001.geekbang.org/account/avatar/00/14/1e/8c/450fe5cb.jpg","comment_is_top":false,"comment_ctime":1560861381,"is_pvip":false,"replies":[{"id":"38251","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1561076605,"ip_address":"","comment_id":104874,"utype":1}],"discussion_count":7,"race_medal":0,"score":"91755174597","product_id":100023901,"comment_content":"å¾ˆç²¾é«“çš„å°±æ˜¯reserveæ–¹æ³•ï¼Œæˆ‘æ¥è¯•ç€ç¨å¾®è§£é‡Šä¸€ä¸‹<br>é¦–å…ˆè‚¯å®šæ˜¯è®¡ç®—ä»¤ç‰Œæ¡¶é‡Œé¢çš„ä»¤ç‰Œæ•°é‡<br>ç„¶åå–ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œæ•°é‡storedPermits ä¸å½“å‰çš„éœ€è¦çš„ä»¤ç‰Œæ•°é‡ 1 åšæ¯”è¾ƒï¼Œå¤§äºç­‰äº 1ï¼Œè¯´æ˜ä»¤ç‰Œæ¡¶è‡³å°‘æœ‰ä¸€ä¸ªä»¤ç‰Œï¼Œæ­¤æ—¶ä¸‹ä¸€ä»¤ç‰Œçš„è·å–æ˜¯ä¸éœ€è¦ç­‰å¾…çš„ï¼Œè¡¨ç°ä¸º next ä¸éœ€è¦å˜åŒ–ï¼›è€Œå½“ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œæ²¡æœ‰äº†å³storedPermitsç­‰äº 0 æ—¶ï¼Œnext å°±ä¼šå˜åŒ–ä¸ºä¸‹ä¸€ä¸ªä»¤ç‰Œçš„è·å–æ—¶é—´ï¼Œæ³¨æ„ nr çš„å€¼å˜åŒ–","like_count":21,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454465,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561076605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372806,"discussion_content":"æœ‰ä¸ªç–‘é—®ï¼Œå‡å¦‚ storedPermits=3ï¼Œnow<nextçš„æƒ…å†µä¸‹reserveåº”è¯¥è¿”å›nowï¼Œå› ä¸ºstoredPermitså¤Ÿï¼Œä½†æ˜¯ä»£ç è¿”å›çš„æ˜¯nextï¼Œå¯¼è‡´è¿˜è¦ç­‰å¾…next-nowçš„æ—¶é—´ï¼Œæ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620467824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1542037,"avatar":"https://static001.geekbang.org/account/avatar/00/17/87/95/cba0a896.jpg","nickname":"å¢","note":"","ucode":"B6A9F41AEE348C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405743,"discussion_content":"æˆ‘ä¹Ÿè®¤ä¸ºä¸åº”è¯¥è¿”å›next","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634634679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":372806,"ip_address":""},"score":405743,"extra":""}]},{"author":{"id":1603420,"avatar":"https://static001.geekbang.org/account/avatar/00/18/77/5c/5d6fb47b.jpg","nickname":"å°å¼ºï¼ˆjackyï¼‰","note":"","ucode":"C6C26A2FE0F767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312316,"discussion_content":"maxPermits/nextçš„å˜é‡çº¿ç¨‹ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œè¿™ä¸æ˜¯æ•°æ®ç«äº‰å—ï¼Ÿä¸ºå•¥è¿™é‡Œæ²¡æœ‰åŠ å¯¹åº”çš„é”ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602661088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053955,"avatar":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","nickname":"è€ƒä¼‘","note":"","ucode":"968DFC00D6D0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45888,"discussion_content":"åä¸€ç§æƒ…å†µï¼Œä»¤ç‰Œæ¡¶ä¸­ç­‰äº0ï¼Œnextä¼šå˜ä¸ºä¸‹ä¸€ä¸ªä»¤ç‰Œçš„æ—¶é—´ï¼Œé‚£ä¸æ˜¯æ¯æ¬¡è¯·æ±‚ä»¤ç‰Œéƒ½ä¼šè‡ªåŠ¨å°†nextçš„å€¼æ·»åŠ ä¸€ä¸ªé—´éš”æ—¶é—´äº†å—ï¼Œåœ¨è€å¸ˆä»£ç ä¸­æ˜¯ä¸æ˜¯åº”è¯¥åœ¨æ·»åŠ é—´éš”æ—¶é—´åï¼Œå°†storePermitså€¼ä¹Ÿè¦æ·»åŠ ä¸€ä¸ªæ¯ç§’é™æµæ•°çš„å¤§å°å€¼ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573094594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1318540,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/8c/450fe5cb.jpg","nickname":"èŠ±å„¿å°‘å¹´","note":"","ucode":"CFE4F64243673B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1053955,"avatar":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","nickname":"è€ƒä¼‘","note":"","ucode":"968DFC00D6D0CF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45956,"discussion_content":"è®²é“ç†å°±æ˜¯è¿™æ ·å­ï¼Œå‡è®¾ï¼Œ3ç§’ä¸€ä¸ªä»¤ç‰Œï¼Œt1è·å–æ—¶æ²¡æœ‰ä»¤ç‰Œï¼Œéœ€è¦ç­‰3ç§’ï¼Œt2æ¥è·å–æ—¶ï¼Œå°±æ˜¯3+3ï¼Œ6ç§’ï¼Œè¿™ä¸ªæ²¡æ¯›ç—…å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573103298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":45888,"ip_address":""},"score":45956,"extra":""}]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10564,"discussion_content":"å­¦ä¹ äº†ï¼Œæ„Ÿè°¢æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568296070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":161319,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1576192120,"is_pvip":false,"replies":[{"id":"61499","content":"é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒCPUå¿™ç¢Œï¼Œå¤§æ¦‚ç‡ä¼šå‡ºç°å°±ç»ªçš„çº¿ç¨‹è¢«ç§¯å‹ï¼Œå¯¹äºå®šæ—¶æ”¾ä»¤ç‰Œçš„çº¿ç¨‹ï¼Œå…¶å®šæ—¶å™¨ä¼šè¢«å¤§æ¦‚ç‡çš„å»¶è¿Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1576200386,"ip_address":"","comment_id":161319,"utype":1}],"discussion_count":4,"race_medal":0,"score":"78885603448","product_id":100023901,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼šé«˜å¹¶å‘æƒ…å†µä¸‹å•ç‹¬ä¸€ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—æ”¾ä»¤ç‰Œï¼Œæ€§èƒ½ä¸Šæ‰›ä¸ä½ï¼Œé‚£ä¹ˆè·å–ä»¤ç‰Œæ—¶æ¯æ¬¡åŠ é”å»è®¡ç®—æ€§èƒ½å°±å¯ä»¥æŠ—çš„ä¸»ï¼Ÿæ˜¯æ ¹æ®ä»€ä¹ˆä¾æ®æ¥åˆ¤æ–­æ€§èƒ½çš„å‘¢ï¼Ÿ","like_count":18,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477689,"discussion_content":"é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒCPUå¿™ç¢Œï¼Œå¤§æ¦‚ç‡ä¼šå‡ºç°å°±ç»ªçš„çº¿ç¨‹è¢«ç§¯å‹ï¼Œå¯¹äºå®šæ—¶æ”¾ä»¤ç‰Œçš„çº¿ç¨‹ï¼Œå…¶å®šæ—¶å™¨ä¼šè¢«å¤§æ¦‚ç‡çš„å»¶è¿Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1576200386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301599,"discussion_content":"markä¸‹ï¼Œæ—¶é—´è®¡ç®—ä¸ä¼šæœ‰é—®é¢˜ï¼Œå®šæ—¶å™¨ä¼šå‡†æ—¶å¼€å¯æŠ¢å cpuï¼ŒæŠ¢ä¸åˆ°å¤§æ¦‚ç‡ä¼šå»¶æ—¶","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1598585013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1107484,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/1c/9d3744ee.jpg","nickname":"å°æè®²æºç ","note":"","ucode":"2573037D7C82C8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548276,"discussion_content":"è¿™é‡Œæ‰€è°“çš„å»¶è¿Ÿï¼Œå°±æ˜¯å› ä¸ºcpuçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¯¼è‡´ç”Ÿæˆä»¤ç‰Œçš„çº¿ç¨‹ä¸ä¼šä¸€ç›´å ç”¨cpuï¼Œè€Œå¯¼è‡´çš„å»¶è¿Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643108920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018071,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/d7/07f8bc6c.jpg","nickname":"sljoai","note":"","ucode":"FF88C4BA265DE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394497,"discussion_content":"è¿™é‡Œçš„å»¶è¿Ÿæ˜¯æŒ‡å»¶è¿Ÿè·å–å˜›ï¼Ÿè¿˜æ˜¯ä¸å¤ªç†è§£å»¶è¿Ÿçš„æ„ä¹‰ï¼Œæ˜¯ç›¸å¯¹å“ªç§åœºæ™¯æ¥è¯´çš„å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631925488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98053,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1558884423,"is_pvip":true,"replies":[{"id":"35083","content":"é™æµå™¨ä¸éœ€è¦é‡Šæ”¾æ“ä½œï¼Œä¿¡å·é‡æ²¡åŠæ³•æ§åˆ¶å¸¦æ—¶é—´èŒƒå›´çš„é™æµï¼Œåªèƒ½ç”¨äºéå¸¸ç®€å•çš„åœºæ™¯","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558918055,"ip_address":"","comment_id":98053,"utype":1}],"discussion_count":2,"race_medal":0,"score":"74573328455","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œé™æµå™¨å’Œä¿¡å·é‡ä¸ºä»€ä¹ˆæ„Ÿè§‰ä¸€æ ·çš„ï¼Œé‚£ä¸ºä»€ä¹ˆ2ä¸ªè¿˜éƒ½å­˜åœ¨ï¼Ÿæ˜¯å› ä¸ºä¸šåŠ¡åœºæ™¯ä¸åŒå—ï¼Ÿè¯·è€å¸ˆè§£æƒ‘ä¸‹","like_count":17,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451537,"discussion_content":"é™æµå™¨ä¸éœ€è¦é‡Šæ”¾æ“ä½œï¼Œä¿¡å·é‡æ²¡åŠæ³•æ§åˆ¶å¸¦æ—¶é—´èŒƒå›´çš„é™æµï¼Œåªèƒ½ç”¨äºéå¸¸ç®€å•çš„åœºæ™¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558918055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10574,"discussion_content":"é™æµå™¨ä¸éœ€è¦é‡Šæ”¾æ“ä½œï¼Œä¿¡å·é‡æ²¡åŠæ³•æ§åˆ¶å¸¦æ—¶é—´èŒƒå›´çš„é™æµï¼Œåªèƒ½ç”¨äºéå¸¸ç®€å•çš„åœºæ™¯ã€‚æ„Ÿè°¢è€å¸ˆå›ç­”ï¼Œå­¦ä¹ å•¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568296410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97941,"user_name":"zsh0103","can_delete":false,"product_type":"c1","uid":1326016,"ip_address":"","ucode":"3992AB4BD1A18A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epLhKkTgowm9PqUwP9k90DecpOU7HQ0IRuAp515kIonbfyqYm6ME7s2bmaPX0sSA14micZ2DAfLLibw/132","comment_is_top":false,"comment_ctime":1558847064,"is_pvip":false,"replies":[{"id":"35090","content":"æŒ‰ç…§ä»¤ç‰Œæ¡¶ç®—æ³•æ˜¯è¿™æ ·çš„ï¼Œæ‰€ä»¥bä¸èƒ½æå¾—å¤ªå¤§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558919261,"ip_address":"","comment_id":97941,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35918585432","product_id":100023901,"comment_content":"è€å¸ˆå¥½ï¼Œé—®ä¸ªé—®é¢˜ã€‚æ–‡ä¸­ä»£ç b=3ï¼Œr=1&#47;sæ—¶ï¼Œå¦‚æœåœ¨nextä¹‹ååŒæ—¶æ¥äº†3ä¸ªè¯·æ±‚ï¼Œåº”è¯¥æ—¶éƒ½å¯ä»¥è·å¾—ä»¤ç‰Œçš„å¯¹å§ã€‚å°±æ˜¯è¯´è¿™3ä¸ªè¯·æ±‚éƒ½å¯ä»¥æ‰§è¡Œã€‚é‚£å²‚ä¸æ˜¯è¿èƒŒäº†r=1&#47;sçš„é™åˆ¶å—ã€‚<br>","like_count":8,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451482,"discussion_content":"æŒ‰ç…§ä»¤ç‰Œæ¡¶ç®—æ³•æ˜¯è¿™æ ·çš„ï¼Œæ‰€ä»¥bä¸èƒ½æå¾—å¤ªå¤§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558919261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100868,"user_name":"the geek","can_delete":false,"product_type":"c1","uid":1506723,"ip_address":"","ucode":"71DECBC814A539","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLz3icr3mGs5ib8FbSPQZ2ic3ib90mHkd1btQrmGacZjJxfYXrerIdaTxglKyCicFzLcEAb6deC2cWjE5Q/132","comment_is_top":false,"comment_ctime":1559658296,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"23034494776","product_id":100023901,"comment_content":"è€å¸ˆï¼Œå½“b&gt;1æ—¶çš„reserveæ–¹æ³•å†™çš„æœ‰é—®é¢˜å§ï¼Œlong at = next;ä¸åº”è¯¥æ˜¯ç¬¬ä¸€è¡Œï¼Œè€Œåº”è¯¥åœ¨&#47;&#47; é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´<br>    next = next + nr*interval;<br>è¿™è¡Œä»£ç ä¹‹åå§","like_count":5,"discussions":[{"author":{"id":1331828,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IZKGetBZDuMEa2VwwtesTELvLORIyV749ItgfAqNPv30n4zEv71wuGNr1aNVIVltG0icvH53DHDuqPuzNpiauWAg/132","nickname":"Geek_bb89c3","note":"","ucode":"0F97B5B0F2DDD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":186737,"discussion_content":"å¯¹çš„ã€‚å¦‚æœåœ¨ä¸€å¼€å§‹è¿”å›çš„è¯ï¼Œæ¯æ¬¡è¿”å›çš„æ—¶é—´éƒ½æ˜¯now,è¿™æ ·å¦‚æœæ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œä¹Ÿèƒ½å¤Ÿç«‹åˆ»è·å–åˆ°ä¸´ç‰Œè€Œä¸ç”¨ç­‰å¾…ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582710880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1448453,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1a/05/a0bebe6a.jpg","nickname":"forever","note":"","ucode":"F556A51B160C70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1331828,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IZKGetBZDuMEa2VwwtesTELvLORIyV749ItgfAqNPv30n4zEv71wuGNr1aNVIVltG0icvH53DHDuqPuzNpiauWAg/132","nickname":"Geek_bb89c3","note":"","ucode":"0F97B5B0F2DDD6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222619,"discussion_content":"è€å¸ˆçš„ä»£ç æ²¡é—®é¢˜ï¼Œå¦‚æœå½“å‰è¯·æ±‚æ—¶é—´nowåœ¨nextæ—¶é—´å‰ï¼Œå°±åœ¨nextè¿™é‡Œè·å¾—ä»¤ç‰Œã€‚å¦‚æœæŒ‰ç…§ä½ çš„é€»è¾‘ï¼Œé‡æ–°è®¡ç®—ä¸‹ä¸€æ¬¡ä»¤ç‰Œäº§ç”Ÿæ—¶é—´next=next+nr*interval,æŠŠè¿™ä¸ªå½“ä½œè·å¾—ä»¤ç‰Œæ—¶é—´ï¼Œé‚£ä¹ˆä¼šå¤šç­‰å¾…ä¸€ä¸ªinterval","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586163643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":186737,"ip_address":""},"score":222619,"extra":""},{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1448453,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1a/05/a0bebe6a.jpg","nickname":"forever","note":"","ucode":"F556A51B160C70","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372808,"discussion_content":"å‡å¦‚ storedPermits=3ï¼Œnow<nextçš„æƒ…å†µä¸‹reserveåº”è¯¥è¿”å›nowï¼Œå› ä¸ºstoredPermitså¤Ÿï¼Œä½†æ˜¯ä»£ç è¿”å›çš„æ˜¯nextï¼Œnowåœ¨nextå‰é¢å°±ä¸€å®šæ²¡ä»¤ç‰Œå—ï¼Œä¸ä¸€å®šå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620468159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222619,"ip_address":""},"score":372808,"extra":""},{"author":{"id":2871387,"avatar":"","nickname":"å ‡ä¸šå…ˆé”‹","note":"","ucode":"AA19D387C955D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":565406,"discussion_content":"ä»¤ç‰Œæ•°å……è¶³æ—¶ï¼šnext+=nr*intervalæ‰§è¡Œånextä¸å˜ã€‚å› ä¸ºnowä¸ºæ—¶é—´ï¼Œæ‰€ä»¥resync()çš„å‚æ•°nowéé€’å‡ï¼Œå› æ­¤åœ¨resync()ä¹ƒè‡³å…¶ä»–æ–¹æ³•ä¸­nowéƒ½å§‹ç»ˆå¤§äºæˆ–ç­‰äºnextï¼Œæ‰€ä»¥åœ¨ä»¤ç‰Œæ•°å……è¶³çš„å‰æä¸‹ä¸å¯èƒ½å‡ºç°nowåœ¨nextçš„å‰é¢è¿™ç§æƒ…å†µã€‚\nä»¤ç‰Œæ•°ä¸å……è¶³æ—¶ï¼šnext+=nr*intervalæ‰§è¡Œånextæ”¹å˜ã€‚æ­¤æ—¶å› ä¸ºä»¤ç‰Œæ•°ä¸è¶³ï¼Œä¸”nowåˆ°nextä¹‹é—´ç”Ÿæˆçš„æ‰€æœ‰ä»¤ç‰Œå·²ç»è¢«å…¶ä»–çº¿ç¨‹é¢„çº¦ï¼Œæ‰€ä»¥å³ä½¿nowåœ¨nextå‰é¢ï¼Œä¹Ÿæ— æ³•é€šè¿‡é™æµå™¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650460817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":372808,"ip_address":""},"score":565406,"extra":""}]},{"author":{"id":1043293,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/5d/2467ad6c.jpg","nickname":"æœ¨å¿ƒ","note":"","ucode":"538A3B9B214BF7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51798,"discussion_content":"æ˜¯çš„ï¼Œä¸ç„¶ä¼šè¶…ä¸€ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573952949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100725,"user_name":"è¾£æ¤’","can_delete":false,"product_type":"c1","uid":1330376,"ip_address":"","ucode":"85C62DE976C6A5","user_header":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","comment_is_top":false,"comment_ctime":1559627681,"is_pvip":false,"discussion_count":10,"race_medal":0,"score":"23034464161","product_id":100023901,"comment_content":"&#47;&#47; ä»¤ç‰Œå‡€éœ€æ±‚ï¼šé¦–å…ˆå‡æ‰ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ<br>    \t\tlong nr = 1 - fb;<br>    \t\t&#47;&#47; é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´<br>    \t\tnext = next + nr*interval;<br>    \t\t&#47;&#47; é‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ<br>    \t\tthis.storedPermits -= fb;<br><br>è€å¸ˆè¿™å„¿æ²¡æœ‰çœ‹æ‡‚ï¼Œèƒ½ä¸èƒ½è§£é‡Šä¸€ä¸‹ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1610208,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEiaibtVdbp1ibiboW174W4kHXLatN5E22s5cialsdc7xPTf4ZC03icFGVlfAV3MmicPt4ybkg/132","nickname":"lis","note":"","ucode":"B7FBED7F2555DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572254,"discussion_content":"å½“æ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œï¼Œå³fb=0æ—¶ï¼Œnext = next + intervalï¼Œè®¡ç®—ä¸‹ä¸€ä¸ªä»¤ç‰Œç”Ÿæˆæ—¶é—´ï¼›å½“æ¡¶ä¸­æœ‰ä»¤ç‰Œï¼Œå³fb=1ï¼Œnext = nextï¼›ç¬¦åˆé¢„æœŸé€»è¾‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652679048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1570088,"avatar":"https://static001.geekbang.org/account/avatar/00/17/f5/28/898a6947.jpg","nickname":"deepz","note":"","ucode":"4BD23A44CDB384","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7007,"discussion_content":"å¾ˆçœ¼ç†Ÿçš„è€å“¥ å‰æ¥æ‰“å¡ï½ğŸ˜ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567251629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1330376,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","nickname":"è¾£æ¤’","note":"","ucode":"85C62DE976C6A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1570088,"avatar":"https://static001.geekbang.org/account/avatar/00/17/f5/28/898a6947.jpg","nickname":"deepz","note":"","ucode":"4BD23A44CDB384","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":7016,"discussion_content":"ä½ åœ¨å“ªä¸ªæŠ€æœ¯ç¾¤ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567265565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":7007,"ip_address":""},"score":7016,"extra":""},{"author":{"id":1570088,"avatar":"https://static001.geekbang.org/account/avatar/00/17/f5/28/898a6947.jpg","nickname":"deepz","note":"","ucode":"4BD23A44CDB384","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1330376,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","nickname":"è¾£æ¤’","note":"","ucode":"85C62DE976C6A5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7096,"discussion_content":"å“ˆå“ˆï¼Œè€å“¥ä½ è¿˜ç»å¸¸å›ç­”æˆ‘é—®é¢˜å‘¢ï¼ŒSpringæŠ€æœ¯äº¤æµç¾¤ğŸ¤ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567383774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":7016,"ip_address":""},"score":7096,"extra":""}]},{"author":{"id":1254493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","nickname":"å¬é›¨","note":"","ucode":"252754F9FCFF0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5850,"discussion_content":"è€å“¥ï¼Œæˆ‘å¥½åƒåœ¨ç¾¤é‡Œè§è¿‡ä½ å‘€ï¼Œspringé‚£ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566485413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1330376,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","nickname":"è¾£æ¤’","note":"","ucode":"85C62DE976C6A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1254493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","nickname":"å¬é›¨","note":"","ucode":"252754F9FCFF0C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6101,"discussion_content":"æˆ‘ä¸€èˆ¬åœ¨springæŠ€æœ¯äº¤æµç¾¤é‡Œï¼Œä½ ä¹Ÿæ˜¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566689613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5850,"ip_address":""},"score":6101,"extra":""},{"author":{"id":1254493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","nickname":"å¬é›¨","note":"","ucode":"252754F9FCFF0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1330376,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","nickname":"è¾£æ¤’","note":"","ucode":"85C62DE976C6A5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6154,"discussion_content":"æ˜¯çš„ï¼Œä¸è¿‡æˆ‘æ˜¯æ½œæ°´å…šğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566728812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6101,"ip_address":""},"score":6154,"extra":""}]},{"author":{"id":1105828,"avatar":"https://static001.geekbang.org/account/avatar/00/10/df/a4/c28050e2.jpg","nickname":"ä»€ä¹ˆ","note":"","ucode":"BAFAF0BAABA57F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2694,"discussion_content":"æ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œæ—¶ï¼Œéœ€è¦æ›´æ–°ä¸‹ä¸€æ¬¡ä»¤ç‰Œçš„äº§ç”Ÿæ—¶é—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563866409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1330376,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/c8/bed1e08a.jpg","nickname":"è¾£æ¤’","note":"","ucode":"85C62DE976C6A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1105828,"avatar":"https://static001.geekbang.org/account/avatar/00/10/df/a4/c28050e2.jpg","nickname":"ä»€ä¹ˆ","note":"","ucode":"BAFAF0BAABA57F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7018,"discussion_content":"ä¸»è¦æ˜¯æ²¡çœ‹æ‡‚ä¸Šé¢ä¸ºä»€ä¹ˆ1-fbï¼Œå¤šçœ‹ä¸¤æ¬¡æ†§äº†ï¼Œä»£ç æœ‰ç‚¹æŠ€å·§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567265639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2694,"ip_address":""},"score":7018,"extra":""}]},{"author":{"id":1107117,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e4/ad/c2e3e2fe.jpg","nickname":"wen","note":"","ucode":"D8EDA076086F0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":890,"discussion_content":"æˆ‘ä¹Ÿæœ‰ç‚¹ç–‘é—®~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562139315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99451,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1559217360,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23034053840","product_id":100023901,"comment_content":"long interval = 1000_000_000;<br>è¿™æ˜¯ä»€ä¹ˆå†™æ³•","like_count":5,"discussions":[{"author":{"id":1024294,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","nickname":"null","note":"","ucode":"F9039EFED6B55D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4284,"discussion_content":"java 7 çš„æ–°ç‰¹æ€§ï¼Œåœ¨æ•°å€¼ä¸­åŠ å…¥ä¸‹åˆ’çº¿ï¼Œè®©æ•°å€¼å¯¹äººæ¥è¯´æ›´å®¹æ˜“è¯»ã€‚","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1565274455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2463155,"avatar":"https://static001.geekbang.org/account/avatar/00/25/95/b3/2e8f6717.jpg","nickname":"å¤œæ˜Ÿ","note":"","ucode":"29CC5992E3587A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379320,"discussion_content":"æ›´å…·ä½“çš„ä½¿ç”¨åŠé¿å‘å¯å‚è€ƒï¼š\nhttps://blog.csdn.net/cunchi4221/article/details/107476992","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623828297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209415,"user_name":"ä¾§è€³å€¾å¬","can_delete":false,"product_type":"c1","uid":1512642,"ip_address":"","ucode":"5BF2A2440B54F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","comment_is_top":false,"comment_ctime":1587547198,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"18767416382","product_id":100023901,"comment_content":"æ—¶é—´é‚£ä¸ªå…¶å®å°±æ˜¯å½“å‰è¯·æ±‚æ—¶é—´è¶…è¿‡ä¸Šæ¬¡ä»¤ç‰Œçš„å–å¾—æ—¶é—´ï¼Œæˆ‘å°±å‘ä»¤ç‰Œï¼Œä»¤ç‰Œæ»¡äº†å°±ä¸å‘åªå–ï¼Œæœ‰ç©ºé—´äº†ç»§ç»­å‘ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€ç§’ä¸€ä¸ªï¼Œé€šè¿‡æ—¶é—´å·®ç®—å‡ºï¼Œæ¥ä¸€ä¸ªè¯·æ±‚å°±ç®—ä¸€æ¬¡æ—¶é—´ï¼Œæ²¡å¿…è¦é€šè¿‡å®šæ—¶å™¨å»å®ç°","like_count":4},{"had_liked":false,"id":127777,"user_name":"åˆ˜é¸¿åš","can_delete":false,"product_type":"c1","uid":1222028,"ip_address":"","ucode":"A403F06AF1BAB2","user_header":"https://static001.geekbang.org/account/avatar/00/12/a5/8c/97b2f2ba.jpg","comment_is_top":false,"comment_ctime":1566791461,"is_pvip":false,"replies":[{"id":"47361","content":"ç¤ºä¾‹ä»£ç åªæ˜¯ä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œå®é™…åº”ç”¨è¿˜æ˜¯è¦å‚è€ƒguavaçš„å®ç°","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1566794265,"ip_address":"","comment_id":127777,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18746660645","product_id":100023901,"comment_content":"newPermits, storePermits, fb, nr éƒ½åº”è¯¥æ˜¯double, è€Œä¸æ˜¯long. ","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464652,"discussion_content":"ç¤ºä¾‹ä»£ç åªæ˜¯ä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œå®é™…åº”ç”¨è¿˜æ˜¯è¦å‚è€ƒguavaçš„å®ç°","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566794265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070165,"avatar":"https://static001.geekbang.org/account/avatar/00/10/54/55/f686c2ed.jpg","nickname":"å¤§è±¡ä½©å¥‡","note":"","ucode":"EAFB4FA3B9CFEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":13503,"discussion_content":"æ„Ÿè§‰æµ…æ˜¾æ˜“æ‡‚æ‰æ›´åº”è¯¥ç”¨doubleï¼Œç”¨longçš„è¯ï¼Œå–æ•´æ“ä½œä¼šæµªè´¹æ‰éæ•´ä»¤ç‰Œ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1568681280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97986,"user_name":"çˆ±åƒå›é”…è‚‰çš„ç˜¦å­","can_delete":false,"product_type":"c1","uid":1233867,"ip_address":"","ucode":"24DBDDC62B2276","user_header":"https://static001.geekbang.org/account/avatar/00/12/d3/cb/f8157ad8.jpg","comment_is_top":false,"comment_ctime":1558860742,"is_pvip":false,"replies":[{"id":"35086","content":"èƒ½æŠŠä¸ºä»€ä¹ˆç”¨çš„æ˜¯é‚£ä¸ªç§¯åˆ†å‡½æ•°ï¼Œè€Œä¸æ˜¯ç”¨å…¶ä»–ç§¯åˆ†å‡½æ•°è®²æ¸…æ¥šçš„ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒå¥½çš„ã€‚æœ€å¥½æ˜¯çœ‹guavaçš„ä»£ç æ³¨è§†ï¼Œå†™çš„éå¸¸è¯¦ç»†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558918823,"ip_address":"","comment_id":97986,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18738729926","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰æ²¡ä»€ä¹ˆèµ„æ–™æ¨èå…³äºguavaé¢„çƒ­åŠŸèƒ½å‘¢ï¼Ÿä¸»è¦ç½‘ä¸Šèµ„æ–™å¤ªç¹æ‚ï¼Œä¸çŸ¥é“è¦å¦‚ä½•ç”„åˆ«å“ªäº›æ˜¯æ¯”è¾ƒç»å…¸çš„","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451502,"discussion_content":"èƒ½æŠŠä¸ºä»€ä¹ˆç”¨çš„æ˜¯é‚£ä¸ªç§¯åˆ†å‡½æ•°ï¼Œè€Œä¸æ˜¯ç”¨å…¶ä»–ç§¯åˆ†å‡½æ•°è®²æ¸…æ¥šçš„ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒå¥½çš„ã€‚æœ€å¥½æ˜¯çœ‹guavaçš„ä»£ç æ³¨è§†ï¼Œå†™çš„éå¸¸è¯¦ç»†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558918823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97656,"user_name":"é«˜æº","can_delete":false,"product_type":"c1","uid":1048887,"ip_address":"","ucode":"751B41FD38EF7D","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/37/12e4c9c9.jpg","comment_is_top":false,"comment_ctime":1558744292,"is_pvip":false,"replies":[{"id":"34943","content":"æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªäº’è”ç½‘ä¼ä¸šï¼Œæœ‰äº›é—®é¢˜åªæœ‰åœ¨å¾ˆé«˜çš„å¹¶å‘å‹åŠ›ä¸‹æ‰ä¼šçˆ†å‘ã€‚ä¸è¿‡æŠ€æœ¯æ²¡æœ‰äº’è”ç½‘ä¹‹åˆ†ï¼Œåªè¦åŸºç¡€ç‰¢ï¼Œæˆé•¿ä¼šå¾ˆå¿«ã€‚å¤šçœ‹åŸºç¡€æ€§çš„ä¸œè¥¿ï¼Œä¸€å®šå¸¦ç€é—®é¢˜å»çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558786803,"ip_address":"","comment_id":97656,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18738613476","product_id":100023901,"comment_content":"è¿˜æœ‰å°±æ˜¯è€å¸ˆæˆ‘é—®ä¸€ä¸‹å› ä¸ºæˆ‘ä¸æ˜¯åœ¨äº’è”ç½‘å…¬å¸å·¥ä½œæ¥è§¦é«˜å¹¶å‘åœºæ™¯å°‘ï¼Œæˆ‘åˆå–œæ¬¢å­¦ä¹ ç ”ç©¶æé«˜è‡ªå·±ï¼Œæ˜¯ä¸æ˜¯å¾—å¤šçœ‹å¤šç»ƒï¼Œå®æˆ˜","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451364,"discussion_content":"æœ€å¥½è¿˜æ˜¯æ‰¾ä¸ªäº’è”ç½‘ä¼ä¸šï¼Œæœ‰äº›é—®é¢˜åªæœ‰åœ¨å¾ˆé«˜çš„å¹¶å‘å‹åŠ›ä¸‹æ‰ä¼šçˆ†å‘ã€‚ä¸è¿‡æŠ€æœ¯æ²¡æœ‰äº’è”ç½‘ä¹‹åˆ†ï¼Œåªè¦åŸºç¡€ç‰¢ï¼Œæˆé•¿ä¼šå¾ˆå¿«ã€‚å¤šçœ‹åŸºç¡€æ€§çš„ä¸œè¥¿ï¼Œä¸€å®šå¸¦ç€é—®é¢˜å»çœ‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558786803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253244,"user_name":"å°å¼ºï¼ˆjackyï¼‰","can_delete":false,"product_type":"c1","uid":1603420,"ip_address":"","ucode":"C6C26A2FE0F767","user_header":"https://static001.geekbang.org/account/avatar/00/18/77/5c/5d6fb47b.jpg","comment_is_top":false,"comment_ctime":1602661496,"is_pvip":false,"replies":[{"id":"92536","content":"ä¸»è¦æ˜¯é€šè¿‡synchronizedå…³é”®å­—æçš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1602681863,"ip_address":"","comment_id":253244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14487563384","product_id":100023901,"comment_content":"è€å¸ˆè¯·æ•™ä¸ªé—®é¢˜ï¼ŒmaxPermits&#47;next çš„å˜é‡åœ¨ç¨‹åºé‡Œé¢ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œè¿™ä¸æ˜¯æ•°æ®ç«äº‰å—ï¼Ÿä¸ºå•¥è¿™é‡Œæ²¡æœ‰åŠ å¯¹åº”çš„é”ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507018,"discussion_content":"ä¸»è¦æ˜¯é€šè¿‡synchronizedå…³é”®å­—æçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602681863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97843,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1558792846,"is_pvip":false,"replies":[{"id":"35087","content":"ä½•å¿…éš¾ä¸ºè‡ªå·±å‘¢ï¼Œä¸è®²äº†ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558918884,"ip_address":"","comment_id":97843,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14443694734","product_id":100023901,"comment_content":"å¾ˆç²¾å½©ï¼è€å¸ˆåº”è¯¥å»è®²æ•°æ®ç»“æ„ä¸ç®—æ³•:)","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451448,"discussion_content":"ä½•å¿…éš¾ä¸ºè‡ªå·±å‘¢ï¼Œä¸è®²äº†ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558918884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1232334,"avatar":"","nickname":"13761642169","note":"","ucode":"68137695FC2120","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48731,"discussion_content":"è€å¸ˆæœ‰ä»€ä¹ˆå…¬ä¼—å· æˆ–è€…åšå®¢ä¹‹ç±»çš„å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573522006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309734,"user_name":"å°ä¹™å“¥","can_delete":false,"product_type":"c1","uid":1063308,"ip_address":"","ucode":"C77E79BEA0C325","user_header":"https://static001.geekbang.org/account/avatar/00/10/39/8c/089525aa.jpg","comment_is_top":false,"comment_ctime":1630315665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10220250257","product_id":100023901,"comment_content":"http:&#47;&#47;ifeve.com&#47;guava-ratelimiter&#47;<br>RateLimiterçš„æ–‡æ¡£ç¿»è¯‘ï¼Œmarkä¸€ä¸‹","like_count":2},{"had_liked":false,"id":168946,"user_name":"Happy","can_delete":false,"product_type":"c1","uid":1281479,"ip_address":"","ucode":"A19C5ECF0AE5FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/8d/c7/d66952bc.jpg","comment_is_top":false,"comment_ctime":1578222721,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10168157313","product_id":100023901,"comment_content":"è€å¸ˆï¼Œç»è¿‡å•å…ƒæµ‹è¯•åï¼Œä¸ªäººæ„Ÿè§‰ resync æ–¹æ³•æœ‰bugã€‚resync çš„åŠŸèƒ½ä»…ä»…æ˜¯å°†æ—¶é—´è½¬æ¢ä¸ºä»¤ç‰Œçš„æ“ä½œï¼Œå¹¶æ›´æ–°ä¸‹ä¸€æ¬¡äº§ç”Ÿä»¤ç‰Œçš„æ—¶é—´ã€‚ä¸æ¶ˆè€—ä»¤ç‰Œã€‚<br>resync æ–¹æ³•ä¸­ &#47;&#47;æ–°äº§ç”Ÿçš„ä»¤ç‰Œæ•°<br>long newPermits = (now - next) &#47; interval; è¿™ä¸€æ­¥ä¸­ï¼Œå‡å¦‚ now - next ä¸º 1.9 ç§’ï¼Œinterval ä¸º1ç§’ï¼Œé‚£ä¹ˆé™¤æ³•åï¼Œä¼šå°† 0.9 ç§’ä¸¢å¼ƒï¼Œé•¿æœŸè¿™ç§æ“ä½œï¼Œä¼šå¯¼è‡´é”™è¯¯è¶Šæ¥è¶Šå¤šã€‚æˆ‘è¿™è¾¹åšäº†ä¸€ä¸ªè¡¥å¿æ“ä½œï¼š<br>long diff = (now - next) % interval;<br> &#47;&#47; å°†ä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾æ—¶é—´é‡ç½®ä¸ºå½“å‰æ—¶é—´<br>next = now - diff;<br><br>å•å…ƒæµ‹è¯•åœ¨ https:&#47;&#47;github.com&#47;1996fanrui&#47;fanrui-learning&#47;blob&#47;755cb85bfc84981ba3a0309cc4fee91035e7ee25&#47;module-juc&#47;src&#47;test&#47;java&#47;com&#47;dream&#47;juc&#47;ratelimiter&#47;RateLimiterTest.java<br><br>è™½ç„¶è¯¾ç¨‹æ—©å°±ç»“æŸäº†ï¼Œä½†è¿˜æ˜¯éå¸¸æœŸå¾…è€å¸ˆçš„åé¦ˆã€‚","like_count":2,"discussions":[{"author":{"id":1281479,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8d/c7/d66952bc.jpg","nickname":"Happy","note":"","ucode":"A19C5ECF0AE5FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":119317,"discussion_content":"ä¹‹å‰æ²¡çœ‹å®Œæ‰€æœ‰è¯„è®ºï¼Œå…¶ä»–è¯„è®ºé‡Œè¯´çš„æ¢æˆdoubleç±»å‹ä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ğŸ˜‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1578226441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102461,"user_name":"speedy9","can_delete":false,"product_type":"c1","uid":1196256,"ip_address":"","ucode":"558A338D54626E","user_header":"https://static001.geekbang.org/account/avatar/00/12/40/e0/2f1816a8.jpg","comment_is_top":false,"comment_ctime":1560225160,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10150159752","product_id":100023901,"comment_content":"è€å¸ˆï¼Œå‰ä¸€ä¸ªæ¡¶å¤§å°ä¸º1çš„ä»£ç æ˜¯ä¸æ˜¯å†™é”™äº†ï¼Œ&#47;&#47; è¿”å›çº¿ç¨‹éœ€è¦ç­‰å¾…çš„æ—¶é—´ åº”è¯¥æ˜¯return Math.max(at-now,0)å§<br>","like_count":2,"discussions":[{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":169642,"discussion_content":"è¿”å›çš„ä¸æ˜¯çº¿ç¨‹éœ€è¦ç­‰å¾…çš„æ—¶é—´,è¿”å›çš„æ˜¯å½“å‰çº¿ç¨‹ä»€ä¹ˆæ—¶å€™èƒ½è·å–åˆ°ä»¤ç‰Œçš„æ—¶é—´;è‡ªå·±æ‹¿åˆ°æ—¶é—´åè·Ÿnowæ¯”è¾ƒ at-nowæ‰æ˜¯æœ€åç­‰å¾…æ—¶é—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581638637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1204628,"avatar":"https://static001.geekbang.org/account/avatar/00/12/61/94/713b38ef.jpg","nickname":"å°å’Œå°šç¬¨å—åŒ—","note":"","ucode":"17C9BBB6DD25D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8813,"discussion_content":"å¾€åçœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568073456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97700,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1558750977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10148685569","product_id":100023901,"comment_content":"æ¡¶å®¹é‡ä¸º1çš„æ—¶å€™ï¼Œæˆ‘èƒ½ç†è§£ã€‚ä½†æ˜¯æ¡¶å®¹é‡ä¸ºå¤šä¸ªçš„æ—¶å€™ï¼Œå°±ä¸ç†è§£äº†ï¼Œæ¯”å¦‚<br>&#47;&#47; æ–°äº§ç”Ÿçš„ä»¤ç‰Œæ•°<br>      long newPermits=(now-next)&#47;interval;<br>è¿™å¥ï¼Œä¸åº”è¯¥1ç§’ç”Ÿæˆæ¡¶çš„æ€»å®¹é‡å—ï¼Ÿå‡è®¾nowä¸º2ï¼Œnextä¸º1ã€‚intervalä¹Ÿä¸º1ã€‚é‚£ä¹ˆä¸€ä¸ªå‘¨æœŸä¹Ÿå°±äº§ç”Ÿä¸€ä¸ªä»¤ç‰Œå•Šï¼Ÿ","like_count":2},{"had_liked":false,"id":97669,"user_name":"é‡è§é˜³å…‰","can_delete":false,"product_type":"c1","uid":1203576,"ip_address":"","ucode":"378E5D37B3CD0E","user_header":"https://static001.geekbang.org/account/avatar/00/12/5d/78/f011d586.jpg","comment_is_top":false,"comment_ctime":1558746012,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10148680604","product_id":100023901,"comment_content":"RateLimiterè¿™ä¸ªé™æµå™¨å’ŒjucåŒ…çš„ä¿¡å·é‡æœ‰å•¥åŒºåˆ«ï¼Ÿ","like_count":2},{"had_liked":false,"id":302685,"user_name":"SnowsonZ","can_delete":false,"product_type":"c1","uid":1446972,"ip_address":"","ucode":"5AF76D55CCDC8F","user_header":"https://static001.geekbang.org/account/avatar/00/16/14/3c/d6be29f3.jpg","comment_is_top":false,"comment_ctime":1626332547,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5921299843","product_id":100023901,"comment_content":"â€é—®é¢˜å°±å‡ºåœ¨å®šæ—¶å™¨ä¸Šï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå½“ç³»ç»Ÿå‹åŠ›å·²ç»ä¸´è¿‘æé™çš„æ—¶å€™ï¼Œå®šæ—¶å™¨çš„ç²¾åº¦è¯¯å·®ä¼šéå¸¸å¤§ï¼ŒåŒæ—¶å®šæ—¶å™¨æœ¬èº«ä¼šåˆ›å»ºè°ƒåº¦çº¿ç¨‹ï¼Œä¹Ÿä¼šå¯¹ç³»ç»Ÿçš„æ€§èƒ½äº§ç”Ÿå½±å“â€œ<br><br>ç”Ÿäº§è€…æ¶ˆè´¹è€…å’Œå®šæ—¶å™¨çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":1},{"had_liked":false,"id":302147,"user_name":"williamcai","can_delete":false,"product_type":"c1","uid":1158294,"ip_address":"","ucode":"B158F52C2D39BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/96/46b13896.jpg","comment_is_top":false,"comment_ctime":1626098143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5921065439","product_id":100023901,"comment_content":"ä¸é”™<br>","like_count":1},{"had_liked":false,"id":291761,"user_name":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","can_delete":false,"product_type":"c1","uid":1554995,"ip_address":"","ucode":"F0B0887B1979D2","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","comment_is_top":false,"comment_ctime":1620467809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5915435105","product_id":100023901,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼Œå‡å¦‚ storedPermits=3ï¼Œnow&lt;nextçš„æƒ…å†µä¸‹reserveåº”è¯¥è¿”å›nowï¼Œå› ä¸ºstoredPermitså¤Ÿï¼Œä½†æ˜¯ä»£ç è¿”å›çš„æ˜¯nextï¼Œå¯¼è‡´è¿˜è¦ç­‰å¾…next-nowçš„æ—¶é—´ï¼Œæ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":260638,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1605076074,"is_pvip":false,"replies":[{"id":"94674","content":"æˆ‘åœ¨æˆ‘åœ¨ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1605094275,"ip_address":"","comment_id":260638,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5900043370","product_id":100023901,"comment_content":"ä¸çŸ¥é“è¯¾ç¨‹ç»“æŸåï¼Œè€å¸ˆè¿˜ä¼šå‡ºæ¥ç­”ç–‘ä¸ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509253,"discussion_content":"æˆ‘åœ¨æˆ‘åœ¨ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605094275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133460,"user_name":"ä¸€ä¸ªæ…¢æ…¢çˆ¬è¡Œçš„æ™®é€šäºº","can_delete":false,"product_type":"c1","uid":1193589,"ip_address":"","ucode":"D38C25E119BCD7","user_header":"https://static001.geekbang.org/account/avatar/00/12/36/75/e346e04e.jpg","comment_is_top":false,"comment_ctime":1568584887,"is_pvip":false,"replies":[{"id":"51314","content":"ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œæ¶æ„æ”»å‡»å¯¼è‡´æ­£å¸¸çš„è¯·æ±‚è¢«æ‹’ç»ã€‚ä¸€èˆ¬æ¥è®²ç³»ç»Ÿåˆ°è¾¾æé™åä¼šå‡ºå„ç§æ„æ–™ä¹‹å¤–çš„é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568634985,"ip_address":"","comment_id":133460,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5863552183","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘åˆšåˆšåº”è¯¥æ˜¯æƒ³é”™äº†ï¼Œçº¿ç¨‹æ± ä»»åŠ¡æäº¤é¢‘ç¹æ˜¯ä¸æ˜¯å¯¼è‡´çº¿ç¨‹æ± å­˜å‚¨ä»»åŠ¡é˜Ÿåˆ—ä¸æ–­æ‰©å¤§ï¼Œä»è€Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸ç¨³å®šï¼Œä½†æ˜¯è¿™æ–¹é¢çº¿ç¨‹æ± ä¹Ÿå¯ä»¥ç”¨æœ‰ç•Œé˜Ÿåˆ—æ¥æ§åˆ¶ï¼Œæ‰€ä»¥ä¸å¤ªæ¸…æ¥šæ˜¯ä»€ä¹ˆèƒ½å¤Ÿå¯¼è‡´ç³»ç»Ÿä¸ç¨³å®š","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467395,"discussion_content":"ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œæ¶æ„æ”»å‡»å¯¼è‡´æ­£å¸¸çš„è¯·æ±‚è¢«æ‹’ç»ã€‚ä¸€èˆ¬æ¥è®²ç³»ç»Ÿåˆ°è¾¾æé™åä¼šå‡ºå„ç§æ„æ–™ä¹‹å¤–çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568634985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124576,"user_name":"éŸ©å¤§","can_delete":false,"product_type":"c1","uid":1198440,"ip_address":"","ucode":"998B64DD552C8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/49/68/a05fb728.jpg","comment_is_top":false,"comment_ctime":1565923019,"is_pvip":false,"replies":[{"id":"52712","content":"ä¼šï¼Œé™æµä¸»è¦æ˜¯ä¿æŠ¤åç«¯ä¸æ­»ï¼Œæ…¢æ€»æ¯”æ­»äº†å¥½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1569668388,"ip_address":"","comment_id":124576,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860890315","product_id":100023901,"comment_content":"guavaçš„ratelimitå¥½åƒæ˜¯é˜»å¡çš„ï¼Œè€Œä¸æ˜¯æŠ›å¼ƒè¯·æ±‚ï¼Œè¿™æ ·ä¼šä¸ä¼šå¯¼è‡´ç”¨æˆ·å“åº”æ—¶é—´è¿‡é•¿çš„é—®é¢˜ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463232,"discussion_content":"ä¼šï¼Œé™æµä¸»è¦æ˜¯ä¿æŠ¤åç«¯ä¸æ­»ï¼Œæ…¢æ€»æ¯”æ­»äº†å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569668388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348802,"user_name":"åˆ˜é¢œ","can_delete":false,"product_type":"c1","uid":1971360,"ip_address":"","ucode":"FD3B9C7338B74C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/14/a0/4c315270.jpg","comment_is_top":false,"comment_ctime":1655424623,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655424623","product_id":100023901,"comment_content":"æ„Ÿè§‰é‚£ä¸ªnræ˜¯ç¥ä¹‹ä¸€æ‰‹","like_count":0},{"had_liked":false,"id":313783,"user_name":"ä¸€ä¸€","can_delete":false,"product_type":"c1","uid":1930889,"ip_address":"","ucode":"F96CA1E8F5806A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/76/89/3b15e9e6.jpg","comment_is_top":false,"comment_ctime":1632664189,"is_pvip":false,"replies":[{"id":"113648","content":"å³ä¾¿æ˜¯å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¹Ÿä¸ä¸€å®šé©¬ä¸Šæœ‰æœºä¼šè¢«è°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œï¼Œçº¿ç¨‹å¤šï¼Œè®¡ç®—å¯†é›†å‹ï¼Œè¢«è°ƒåº¦æ‰§è¡Œçš„å»¶è¿Ÿè¶Šå¤§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1632745173,"ip_address":"","comment_id":313783,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632664189","product_id":100023901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹å®šæ—¶å™¨ä¸çº¿ç¨‹ç¡çœ çš„å·®è·æ˜¯æ€æ ·çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527469,"discussion_content":"å³ä¾¿æ˜¯å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¹Ÿä¸ä¸€å®šé©¬ä¸Šæœ‰æœºä¼šè¢«è°ƒåº¦åˆ°cpuä¸Šæ‰§è¡Œï¼Œçº¿ç¨‹å¤šï¼Œè®¡ç®—å¯†é›†å‹ï¼Œè¢«è°ƒåº¦æ‰§è¡Œçš„å»¶è¿Ÿè¶Šå¤§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632745173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286732,"user_name":"Geek_ac4080","can_delete":false,"product_type":"c1","uid":1526428,"ip_address":"","ucode":"E2C480962E6CEB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epMicvN0PDCMibmBvwAyoScCjjgfLBWaQwGic9ialXObicxKib9X0T0gx02gL4jqvibEr1FRzMaiaicN8cgEBg/132","comment_is_top":false,"comment_ctime":1617532336,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617532336","product_id":100023901,"comment_content":"&#47;&#47;ä»¤ç‰Œæ¡¶ä¸­èƒ½æä¾›çš„ä»¤ç‰Œ    <br>long fb=min(1, storedPermits);    <br>&#47;&#47;ä»¤ç‰Œå‡€éœ€æ±‚ï¼šé¦–å…ˆå‡æ‰ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ    <br>long nr = 1 - fb;    <br>&#47;&#47;é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´    <br>next = next + nr*interval;    <br>&#47;&#47;é‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ    <br>this.storedPermits -= fb;<br>è€å¸ˆï¼Œè¿™é‡Œå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œå¦‚æœstoredPermits=1ï¼Œè¿™é‡Œå¹¶ä¸ä¼šæ›´æ–°nextï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚è¿›æ¥æ—¶çš„æ—¶é—´æ˜¯è‚¯å®šå¤§äºnextçš„ï¼Œä¸ä¼šè¿›å…¥ç­‰å¾…","like_count":0},{"had_liked":false,"id":272362,"user_name":"LQS  KF","can_delete":false,"product_type":"c1","uid":1364737,"ip_address":"","ucode":"3C0A07A8220094","user_header":"https://static001.geekbang.org/account/avatar/00/14/d3/01/716d45b6.jpg","comment_is_top":false,"comment_ctime":1610069378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610069378","product_id":100023901,"comment_content":"æˆ‘æŸ¥çœ‹RateLimiteræºç çš„æ—¶å€™ï¼Œå‘ç°æˆ‘ä»¬RateLimiter#reserveAndGetWaitLength()æ–¹æ³•æ˜¯åŠ äº†äº’æ–¥é”çš„ï¼Œè¿™æ ·resync()çš„æ—¶å€™æ˜¯ä¸€å®šä¼šæ¯”å½“å‰çš„ &#39;ä¸‹ä¸€æ¬¡ä»¤ç‰Œè·å–æ—¶é—´(RateLimiter#nextFreeTicketMicros)å¤§çš„ &#39; ã€‚æ‰€ä»¥åªä¼šèµ°è€å¸ˆå›¾ä¾‹ä¸Š now &gt; nextçš„æµç¨‹æ˜¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":270606,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1609169360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609169360","product_id":100023901,"comment_content":"æœ¬åœ°å®ç°äº†SimpleRateLimiterçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆæ¡¶çš„æ•°é‡ä¸º1çš„ï¼‰ã€‚ç¬¬äºŒä¸ªæƒ³å®ç°æ—¶ï¼Œæ€æƒ³å·²ç»é£˜èµ·æ¥äº†ã€‚ä¼‘æ¯ä¸‹ï¼Œä¸‹å›å†æ¥","like_count":0},{"had_liked":false,"id":230471,"user_name":"è¥¿é—¨å¹ç‰›","can_delete":false,"product_type":"c1","uid":1508990,"ip_address":"","ucode":"E5D3624DDE1E83","user_header":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","comment_is_top":false,"comment_ctime":1593396260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593396260","product_id":100023901,"comment_content":"reserveï¼ˆï¼‰æ–¹æ³•è¿”å›ç»“æœï¼Œreturn Math.max(at, 0L);ã€‚è¿™å¥çš„æ³¨é‡Šä¸å¤ªå‡†ç¡®ï¼Œåº”è¯¥è¿”å›è·å–ä»¤ç‰Œçš„æ—¶é—´ï¼Œreserveï¼ˆï¼‰æ–¹æ³•çš„æ³¨é‡Šæ˜¯æ­£ç¡®çš„ï¼Œåªæ˜¯è¿”å›è¯­å¥è¿™ä¸ªæ³¨é‡Šï¼Œå®¹æ˜“è®©äººè¯¯è§£ã€‚å…¶å®è¿”å›èƒ½è·å–ä»¤ç‰Œçš„æ—¶é—´ï¼Œå°±ä¿©ç§ï¼Œä¸€æ˜¯è¯·æ±‚æ—¶é—´åœ¨ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹åï¼Œé‚£æ— éœ€ç­‰å¾…ï¼Œè¿”å›è¯·æ±‚æ—¶é—´ï¼Œå¦‚æœè¯·æ±‚æ—¶é—´åœ¨ä»¤ç‰Œäº§ç”Ÿæ—¶é—´ä¹‹å‰ï¼Œè¿”å›ä»¤ç‰Œçš„äº§ç”Ÿæ—¶é—´ã€‚è¿™æ ·çš„è¯ï¼Œæ ¹æ®reserveï¼ˆï¼‰æ–¹æ³•è¿”å›çš„èƒ½è·å–ä»¤ç‰Œçš„æ—¶é—´å’Œå½“å‰è¯·æ±‚çº¿ç¨‹çš„æ—¶é—´ï¼Œæ±‚ä¸ªå·®å€¼ï¼Œå°±æ˜¯çº¿ç¨‹éœ€è¦ç­‰å¾…çš„æ—¶é—´ã€‚å¦‚æœæ˜¯åœ¨ä»¤ç‰Œäº§ç”Ÿä¹‹åï¼Œè¯·æ±‚çº¿ç¨‹ï¼Œé‚£è¿™ä¸ªå·®å€¼å°±æ˜¯0ï¼Œæ— é¡»ç­‰å¾…ï¼Œå¦‚æœè¿™ä¸ªå·®å€¼å¤§äº0ï¼Œæ˜¯è¯·æ±‚çº¿ç¨‹åœ¨å‘ç”Ÿä»¤ç‰Œä¹‹å‰ï¼Œå¿…ç„¶è¦ç­‰å¾…ä»¤ç‰Œå‘ç”Ÿæ‰èƒ½æ‰§è¡Œ","like_count":0},{"had_liked":false,"id":224879,"user_name":"Just","can_delete":false,"product_type":"c1","uid":2022626,"ip_address":"","ucode":"35FA6917DE1D04","user_header":"https://static001.geekbang.org/account/avatar/00/1e/dc/e2/a3abd320.jpg","comment_is_top":false,"comment_ctime":1591582343,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591582343","product_id":100023901,"comment_content":"  çœ‹äº†å¥½å‡ éï¼›<br>   1ï¼‰ if (now &gt; next) {      &#47;&#47;æ–°äº§ç”Ÿçš„ä»¤ç‰Œæ•°      long newPermits=(now-next)&#47;interval;      &#47;&#47;æ–°ä»¤ç‰Œå¢åŠ åˆ°ä»¤ç‰Œæ¡¶      storedPermits=min(maxPermits,         storedPermits + newPermits);      &#47;&#47;å°†ä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾æ—¶é—´é‡ç½®ä¸ºå½“å‰æ—¶é—´      next = now;    }  è¿™ä¸ªæˆ‘æ›´æ„¿æ„ç†è§£æˆé‡æ–°è®¡ç®—è¿™æ®µæ—¶é—´å†…æ¡¶ä¸­å¯ç”¨ä»¤ç‰Œçš„æ•°é‡<br>2ï¼‰ {  long at = next;    &#47;&#47;ä»¤ç‰Œæ¡¶ä¸­èƒ½æä¾›çš„ä»¤ç‰Œ    long fb=min(1, storedPermits);    &#47;&#47;ä»¤ç‰Œå‡€éœ€æ±‚ï¼šé¦–å…ˆå‡æ‰ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ    long nr = 1 - fb;    &#47;&#47;é‡æ–°è®¡ç®—ä¸‹ä¸€ä»¤ç‰Œäº§ç”Ÿæ—¶é—´    next = next + nr*interval;    &#47;&#47;é‡æ–°è®¡ç®—ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œ    this.storedPermits -= fb;    return at;}è¿™æ®µä»£ç æ˜¯ä¸ç®¡nowæ˜¯å¦å¤§äºnextï¼Œéƒ½ä¼šæ‰§è¡Œçš„ï¼ŒåŒæ—¶æ¯æ¬¡æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœåŒæ—¶æ²¡æœ‰çš„è¯ï¼Œéƒ½ä¼šé‡æ–°ç”Ÿæˆnextæ—¶é—´ï¼Œ","like_count":0},{"had_liked":false,"id":222120,"user_name":"kimoti","can_delete":false,"product_type":"c1","uid":1897671,"ip_address":"","ucode":"0A78077408C2B1","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f4/c7/037235c9.jpg","comment_is_top":false,"comment_ctime":1590680167,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590680167","product_id":100023901,"comment_content":"æ¼æ¡¶ç®—æ³•æ¯”è¾ƒå¥½ç†è§£ï¼Œè¯·æ±‚å¥½æ¯”æ˜¯æ°´å¾€ä¸€ä¸ªæ¼æ–—é‡Œæ³¨æ°´ï¼Œæ¼æ–—è¿™ä¸ªå·¥å…·å¤©ç„¶å°±å®ç°äº†é™æµã€‚å› ä¸ºæ¼æ–—ä¸‹å¼€å£å¾ˆå°ï¼Œæ‰€ä»¥æ°´åªèƒ½æ…¢æ…¢å¾€ä¸‹æ¼ã€‚å¦‚æœå€’æ°´çš„é€Ÿåº¦å¤ªå¿«é‚£ä¹ˆæ¼æ–—å°±æ¥ä¸åŠæ¼ï¼Œæ¼æ–—é‡Œçš„æ°´ä¼šæº¢å‡ºæ¥ã€‚","like_count":0},{"had_liked":false,"id":210307,"user_name":"ç™½","can_delete":false,"product_type":"c1","uid":1086829,"ip_address":"","ucode":"B7790059DD43B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/95/6d/bc01fdf7.jpg","comment_is_top":false,"comment_ctime":1587717890,"is_pvip":false,"replies":[{"id":"78691","content":"1ç§’10ä¸ªï¼Œç­‰ä»·äº100æ¯«ç§’1ä¸ª","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1588032548,"ip_address":"","comment_id":210307,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587717890","product_id":100023901,"comment_content":"ä»¤ç‰Œæ¡¶çš„å¹³æ»‘ç‰¹æ€§è¿™é‡Œæ€ä¹ˆä½“ç°å‘¢ï¼Ÿ<br>æ¯”å¦‚1ç§’é’Ÿ10ä¸ªä»¤ç‰Œè¿™ä¸ªç®—æ³•é‡Œä¼šåœ¨ç¬¬ä¸€æ¯«ç§’è€—å°½ï¼Œè€Œä¸æ˜¯å¹³æ»‘çš„åˆ†æ•£åœ¨1ç§’é‡Œå§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492999,"discussion_content":"1ç§’10ä¸ªï¼Œç­‰ä»·äº100æ¯«ç§’1ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588032548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199830,"user_name":"ğŸ˜œå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1069001,"ip_address":"","ucode":"1FF58FB3A91135","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/c9/88837387.jpg","comment_is_top":false,"comment_ctime":1585496661,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1585496661","product_id":100023901,"comment_content":"åŸºäºæ»‘åŠ¨çª—å£é™æµ","like_count":0,"discussions":[{"author":{"id":1448453,"avatar":"https://static001.geekbang.org/account/avatar/00/16/1a/05/a0bebe6a.jpg","nickname":"forever","note":"","ucode":"F556A51B160C70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222622,"discussion_content":"ä¸€èµ·å­¦å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586163977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183621,"user_name":"æ—…é€”","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1583078796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583078796","product_id":100023901,"comment_content":"è€å¸ˆ æœ‰ç‚¹é—®é¢˜ éº»çƒ¦æ‚¨è§£ç­”ä¸‹<br>å°±æ˜¯  ä»¤ç‰Œå‡è®¾æ¯ç§’ä¸€ä¸ª,é‚£ä¹ˆç¬¬ä¸€ä¸ªæ˜¯ç¬¬1s,ç¬¬äºŒä¸ªæ˜¯ç¬¬2sï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç¬¬3sã€‚ã€‚<br>å‡å¦‚ç¬¬1.2sä¸€ä¸ªçº¿ç¨‹è·å–äº† ,è¿™æ—¶å€™ç¬¬1.4såˆæ¥ä¸ªçº¿ç¨‹è·å–,1.4sçš„çº¿ç¨‹åº”è¯¥æ˜¯ç¬¬2sæ‹¿åˆ°ï¼Œä½†æ˜¯æŒ‰æ‚¨ä»£ç ä¸­çš„å®ç°åº”è¯¥æ˜¯2.4sæ‹¿åˆ°ç¬¬äºŒä¸ªä»¤ç‰Œ,æ˜¯è¿™æ ·å—?","like_count":0},{"had_liked":false,"id":170212,"user_name":"å–ç«æŸ´çš„æ‰˜å„¿ç´¢","can_delete":false,"product_type":"c1","uid":1451295,"ip_address":"","ucode":"A9C7412E75DA82","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/1f/8e304ec0.jpg","comment_is_top":false,"comment_ctime":1578550780,"is_pvip":false,"replies":[{"id":"66614","content":"PPTğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1579014036,"ip_address":"","comment_id":170212,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578550780","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¯·é—®æ‚¨ç”¨çš„æ˜¯ä»€ä¹ˆç”»å›¾å·¥å…·ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480882,"discussion_content":"PPTğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579014036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148838,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1573093575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573093575","product_id":100023901,"comment_content":"ä»¤ç‰Œæ¡¶åŸç†ï¼š<br>      ä»ä»¤ç‰Œæ¡¶ä¸­è·å–ä»¤ç‰Œï¼Œå¦‚æœä»¤ç‰Œæ•°é‡å¤§äº1ï¼Œåˆ™ç›´æ¥è·å–ï¼Œå¦‚æœä»¤ç‰Œæ¡¶ä¸­å·²ç»æ²¡æœ‰ä»¤ç‰Œï¼Œåˆ™ç­‰å¾…æ—¶é—´åŠ ä¸€ä¸ªé—´éš”æ—¶é—´ï¼ŒåŒæ—¶ä»¤ç‰Œæ¡¶ä¸­æ–°å¢ä¸€æ‰¹ä»¤ç‰Œï¼ˆæ•°é‡ä¸ºæ¯ç§’é™æµæ•°ï¼‰ã€‚<br>ä»¤ç‰Œæ¡¶å®ç°ï¼š<br>      é€šè¿‡acquireè·å–ä»¤ç‰Œæ—¶ï¼Œå°†å½“å‰æ—¶é—´ä¼ é€’åˆ°æ–¹æ³•ä¸­ï¼Œè¿”å›ä¸€ä¸ªè·å–ä»¤ç‰Œæ—¶é—´ï¼Œå¦‚æœæ—¶é—´ä¸å½“å‰æ—¶é—´ç›¸åŒï¼Œè¯´æ˜ä»¤ç‰Œæ—¶ä»ä»¤ç‰Œæ¡¶ä¸­ç›´æ¥è·å–çš„ï¼Œå¦‚æœè¿”å›ä¸€ä¸ªå¤§äºå½“å‰æ—¶é—´çš„å€¼ï¼Œåˆ™ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆè¿”å›å€¼-å½“å‰æ—¶é—´ï¼‰ã€‚<br>       åœ¨è·å–ä»¤ç‰Œæ—¶é—´æ—¶ï¼Œå…·ä½“å®ç°ä»£ç å¾ˆä¼˜ç§€ï¼Œå…ˆèµä¸€ä¸ªï¼å¦‚æœå½“å‰æ—¶é—´å¤§äºä¸Šæ¬¡ä»¤ç‰Œæ—¶é—´ï¼Œåˆ™å°†ä¸Šæ¬¡ä»¤ç‰Œæ—¶é—´è®¾ç½®ä¸ºå½“å‰æ—¶é—´ï¼ŒåŒæ—¶ä»¤ç‰Œæ¡¶ä¸­æ ¹æ®é™æµç‡æ·»åŠ ä¸€æ‰¹ä»¤ç‰Œï¼Œè¦ä¿è¯ä»¤ç‰Œæ€»æ•°ä¸å¤§äºæœ€å¤§å€¼ã€‚ç„¶åå†ä»ä»¤ç‰Œæ¡¶ä¸­å–ä¸€ä¸ªä»¤ç‰Œè¿”å›ã€‚","like_count":0},{"had_liked":false,"id":142227,"user_name":"æ–‘æ–‘é©³é©³","can_delete":false,"product_type":"c1","uid":1122057,"ip_address":"","ucode":"ADFC607C549620","user_header":"https://static001.geekbang.org/account/avatar/00/11/1f/09/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1571314923,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571314923","product_id":100023901,"comment_content":"å®¹é‡ä¸º1çš„ synchronized long reserve(long now) è¿™ä¸ªæ–¹æ³•ä¸­çš„ Math.maxï¼ˆatï¼Œ0ï¼‰æ²¡æœ‰æ„ä¹‰ï¼Œatä¸€ç›´å¤§äº0","like_count":0},{"had_liked":false,"id":134286,"user_name":"é™æµ·","can_delete":false,"product_type":"c1","uid":1342563,"ip_address":"","ucode":"28A5E81CDC5C04","user_header":"https://static001.geekbang.org/account/avatar/00/14/7c/63/115a4b23.jpg","comment_is_top":false,"comment_ctime":1568794230,"is_pvip":false,"replies":[{"id":"51657","content":"æ²¡è¿™ä¹ˆåšè¿‡ï¼Œåº”è¯¥æ˜¯åšä¸äº†çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1568896704,"ip_address":"","comment_id":134286,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1568794230","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸‹æ¥æ”¶rocketmqæ¶ˆæ¯ï¼Œèƒ½å¦é‡‡ç”¨é™æµå™¨Guava RateLimiterè¿›è¡Œé™æµ? è¦æ€ä¹ˆåš?","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467691,"discussion_content":"æ²¡è¿™ä¹ˆåšè¿‡ï¼Œåº”è¯¥æ˜¯åšä¸äº†çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568896704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1566569,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e7/69/0c426b52.jpg","nickname":"åˆ˜æ˜“å®","note":"","ucode":"EE337683D08B9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":97757,"discussion_content":"ä»¥å‰å®ç°è¿‡æ¥å—kafkaæ¶ˆæ¯ï¼Œç”¨RateLimiterè¿›è¡Œé™æµï¼Œæ˜¯å¯ä»¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577114880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1342563,"avatar":"https://static001.geekbang.org/account/avatar/00/14/7c/63/115a4b23.jpg","nickname":"é™æµ·","note":"","ucode":"28A5E81CDC5C04","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1566569,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e7/69/0c426b52.jpg","nickname":"åˆ˜æ˜“å®","note":"","ucode":"EE337683D08B9A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":201565,"discussion_content":"æœ‹å‹ï¼Œä»£ç èƒ½è´´å‡ºæ¥çœ‹ä¸‹å˜›ï¼Ÿï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583808984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":97757,"ip_address":""},"score":201565,"extra":""}]}]},{"had_liked":false,"id":116916,"user_name":"shniu","can_delete":false,"product_type":"c1","uid":1019555,"ip_address":"","ucode":"E64CD8BED96D8D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/a3/d7e5fe8a.jpg","comment_is_top":false,"comment_ctime":1563938166,"is_pvip":false,"replies":[{"id":"42786","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1563960483,"ip_address":"","comment_id":116916,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563938166","product_id":100023901,"comment_content":"é™æµå™¨è€å¸ˆè®²çš„æµ…æ˜¾æ˜“æ‡‚ï¼Œå‘ç°æœ‰äº›åŒå­¦æœ‰äº›ç–‘é—®ï¼Œè¯•ç€è§£ç­”ä¸€ä¸‹ã€‚<br><br>1. æ˜¯å¦ä¼šæœ‰å¹¶å‘é—®é¢˜ï¼Ÿ<br>å¹¶å‘é—®é¢˜åº”è¯¥æ˜¯ä¸å­˜åœ¨çš„ï¼Œé™æµå™¨çš„ç«äº‰èµ„æºæ˜¯ä»¤ç‰Œï¼ˆpermitï¼‰ï¼Œå®ç°ä¸­ä»¤ç‰Œæ˜¯åŠ¨æ€è®¡ç®—å‡ºæ¥çš„ï¼Œå¢åŠ äº†å¹¶å‘è®¿é—®æ§åˆ¶ï¼Œsynchronized reverse()ï¼Œè¿™é‡Œçš„åŒæ­¥ä»…ä»…æ˜¯åŠ åœ¨äº†é¢„å ä»¤ç‰Œä¸Šï¼Œéå¸¸å¥½çš„è®¾è®¡<br>2. maxPermits å¤§äº1çš„ä»£ç æ²¡çœ‹æ‡‚ï¼Ÿ<br>åˆ†äº†ä¸¤ç§æƒ…å†µï¼Œä¸‹ä¸€ä¸ªä»¤ç‰Œäº§ç”Ÿæ—¶é—´è½åäºå½“å‰æ—¶é—´æ—¶ï¼Œéœ€è¦é‡ç½®ä¸‹ä¸€æ¬¡ä»¤ç‰Œäº§ç”Ÿæ—¶é—´å’Œè®¡ç®—ä»¤ç‰Œæ¡¶ä¸­å¯ç”¨çš„ä»¤ç‰Œï¼›ç„¶åï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½æŒ‰ç…§ç›¸åŒçš„ä»¤ç‰Œè·å–ç®—æ³•ï¼Œä»£ç ä¸­åœ¨è®¡ç®—èƒ½è·å¾—ä»¤ç‰Œçš„æ—¶é—´æ—¶ï¼Œåˆåˆ†äº†ä¸¤ç§æƒ…å†µï¼Œä»¤ç‰Œæ¡¶ä¸­æœ‰ä»¤ç‰Œå’Œæ²¡æœ‰ä»¤ç‰Œï¼Œæ²¡æœ‰ä»¤ç‰Œçš„æ—¶å€™éœ€è¦è®¡ç®—ä¸‹ä¸€æ¬¡äº§ç”Ÿä»¤ç‰Œçš„æ—¶é—´ï¼Œæœ‰ä»¤ç‰Œçš„æ—¶å€™éœ€è¦å‡å»ä»¤ç‰Œæ¡¶ä¸­çš„ä»¤ç‰Œï¼Œè¿™å°±æ˜¯é‚£å‡ è¡Œæ¯”è¾ƒæ™¦æ¶©ä¸€äº›ä»£ç è¦åšçš„äº‹æƒ…<br><br>è‡ªå·±çš„æµ…æ˜¾ç†è§£","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459730,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563960483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116257,"user_name":"é“","can_delete":false,"product_type":"c1","uid":1324160,"ip_address":"","ucode":"851A0AD751D317","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/80/30e9ae41.jpg","comment_is_top":false,"comment_ctime":1563808441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563808441","product_id":100023901,"comment_content":"ä»¤ç‰Œæ¡¶å®¹é‡ä¸ºä¸€è®²çš„å¾ˆæ¸…æ¥šï¼Œï¼Œå®¹é‡å¤§äºä¸€è®²çš„å¤ªæ¨¡ç³Šã€‚è®²æˆä»€ä¹ˆä¸œè¥¿ï¼Œä¸éœ€è¦è™šæ— ç¼¥ç¼ˆï¼Œæœ€å¥½è„šè¸å®åœ°ï¼Œæ¥åœ°æ°”","like_count":0},{"had_liked":false,"id":112155,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1562675881,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562675881","product_id":100023901,"comment_content":"å¥½å‰å®³å•Š ç§¯åˆ†å‡½æ•°éƒ½ç”¨ä¸Šäº†","like_count":0},{"had_liked":false,"id":109396,"user_name":"å†°æ¿€å‡Œçš„çœ¼æ³ª","can_delete":false,"product_type":"c1","uid":1087945,"ip_address":"","ucode":"5DCB974667E93A","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/c9/a7c77746.jpg","comment_is_top":false,"comment_ctime":1562029749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562029749","product_id":100023901,"comment_content":"é¢„æœŸæ—¶é—´-å½“å‰æ—¶é—´=ç­‰å¾…æ—¶é—´","like_count":0},{"had_liked":false,"id":100996,"user_name":"åŠ æ²¹é¸­","can_delete":false,"product_type":"c1","uid":1396988,"ip_address":"","ucode":"2735762668FD26","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/fc/0a31343c.jpg","comment_is_top":false,"comment_ctime":1559699138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559699138","product_id":100023901,"comment_content":"è¿™èŠ‚æ˜¯æˆ‘è§‰å¾—å¯¹æˆ‘è€Œè¨€ï¼Œæœ€æœ‰ç”¨çš„ä¸€èŠ‚","like_count":0},{"had_liked":false,"id":99482,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1559226725,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559226725","product_id":100023901,"comment_content":"public static RateLimiter create(double permitsPerSecond) {...}  åˆ›å»ºæ—¶å€™å¹¶æ²¡æœ‰ burstå‚æ•°å•Šã€‚è¯·é—®åœ¨å“ªç±»é‡Œè®¾ç½®çš„","like_count":0},{"had_liked":false,"id":99454,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1559219426,"is_pvip":false,"replies":[{"id":"35736","content":"burstå‚æ•°æ§åˆ¶","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559226540,"ip_address":"","comment_id":99454,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559219426","product_id":100023901,"comment_content":"guava ratelimiter å®¹é‡ä¸Šé™åœ¨å“ªä¸ªå‚æ•°ä¸­ä½“ç°æˆ–è€…åœ¨å“ªè®¾ç½®è¿™ä¸ªã€‚æ¯”å¦‚æˆ‘ä»¬è®¾ç½®çš„æµé€Ÿæ˜¯ 2&#47;s,å½“100sä¹‹å†…éƒ½æ²¡æœ‰è¯·æ±‚åˆ°æ¥ï¼Œæ˜¯ä¸æ˜¯ä¼šå¾€ä»¤ç‰Œæ¡¶ä¸­æŒç»­æ”¾å…¥200ä¸ªä»¤ç‰Œï¼Œ è€Œè¿™è¿™æ—¶å€™çªç„¶æ¥äº†ä¸€æ³¢300ä¸ªå¹¶å‘è¯·æ±‚ï¼Œæ˜¯ä¸æ˜¯200ä¸ªè¯·æ±‚å¯ä»¥è¢«è°ƒç”¨ï¼Œå‰©ä¸‹100ä¸ªè¯·æ±‚è¢«é˜»å¡æ…¢æ…¢é‡Šæ”¾ã€‚æ˜¯è¿™æ ·çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452116,"discussion_content":"burstå‚æ•°æ§åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559226540,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99445,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1559216076,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559216076","product_id":100023901,"comment_content":"å®¹é‡ä¸Šé™bæ€ä¹ˆè®¾ç½®","like_count":0},{"had_liked":false,"id":98923,"user_name":"andy","can_delete":false,"product_type":"c1","uid":1063321,"ip_address":"","ucode":"F03BE5E20B471C","user_header":"https://static001.geekbang.org/account/avatar/00/10/39/99/42929758.jpg","comment_is_top":false,"comment_ctime":1559116426,"is_pvip":false,"replies":[{"id":"35579","content":"å¤šçº¿ç¨‹æ²¡é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559139018,"ip_address":"","comment_id":98923,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559116426","product_id":100023901,"comment_content":"æˆ‘æœ‰ä¸ªç–‘é—®ï¼Œè¿™ä¸ªä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œå¤šçº¿ç¨‹å½“ä¸­ä¸ä¼šæœ‰é—®é¢˜ä¹ˆï¼Ÿè¿˜æ˜¯æˆ‘è®¤ä¸ºçš„ä½¿ç”¨åœºæ™¯ä¸å¯¹ï¼Œæœ‰ç‚¹è’™","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451896,"discussion_content":"å¤šçº¿ç¨‹æ²¡é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559139018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98454,"user_name":"æ›¾è½¼éºŸ","can_delete":false,"product_type":"c1","uid":1451391,"ip_address":"","ucode":"D418371AC11270","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/7f/473d5a77.jpg","comment_is_top":false,"comment_ctime":1559005908,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559005908","product_id":100023901,"comment_content":"å…¶æ¬¡æ˜¯ä¿¡å·é‡å…¶å®ä¹Ÿæœ‰é™æµçš„æ–¹å¼ï¼Œæ¯”å¦‚redissoné‡Œé¢æä¾›çš„è¶…æ—¶ä¿¡å·é‡ï¼Œæ—¢æœ‰ä¿¡å·é‡çš„åŠŸèƒ½ä¹Ÿæœ‰é™æµå™¨çš„åŠŸèƒ½","like_count":0},{"had_liked":false,"id":98452,"user_name":"æ›¾è½¼éºŸ","can_delete":false,"product_type":"c1","uid":1451391,"ip_address":"","ucode":"D418371AC11270","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/7f/473d5a77.jpg","comment_is_top":false,"comment_ctime":1559005834,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559005834","product_id":100023901,"comment_content":"è€å¸ˆæˆ‘æ˜¯è¿™æ ·ç†è§£çš„ï¼Œä»å®‰å…¨è§’åº¦æ¥è¯´ï¼Œä¿¡å·é‡æ˜¯è¦ä¼˜äºé™æµå™¨çš„ï¼Œæ¯”å¦‚å‰é¢çš„è¯·æ±‚è¿˜æ²¡å¤„ç†å®Œï¼Œä¿¡å·é‡ä¸å…è®¸æ–°çš„è¯·æ±‚è¿›æ¥ï¼Œè€Œé™æµå™¨å…è®¸","like_count":0},{"had_liked":false,"id":98425,"user_name":"Sunqc","can_delete":false,"product_type":"c1","uid":1473717,"ip_address":"","ucode":"2C54659635403F","user_header":"https://static001.geekbang.org/account/avatar/00/16/7c/b5/4a7a2bd4.jpg","comment_is_top":false,"comment_ctime":1559003694,"is_pvip":false,"replies":[{"id":"36138","content":"å°å¿ƒæš´éœ²æ™ºå•†ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559542125,"ip_address":"","comment_id":98425,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559003694","product_id":100023901,"comment_content":"çš®ä¸€ä¸‹ï¼Œè€ç‹ï¼Œè¿™ä¸€èŠ‚æŒºæ·±å¥¥çš„ï¼Œå“ˆå“ˆå“ˆ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451681,"discussion_content":"å°å¿ƒæš´éœ²æ™ºå•†ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559542125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97827,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1558788060,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558788060","product_id":100023901,"comment_content":"è¯»äº†å‡ éæ‰åŸºæœ¬å¼„æ‡‚ï¼Œæœ‰ç‚¹æ·±åº¦äº†å“ˆ","like_count":0},{"had_liked":false,"id":97793,"user_name":"æ¾èŠ±çš®è›‹me","can_delete":false,"product_type":"c1","uid":1000054,"ip_address":"","ucode":"B0846CEEF6B0D1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/76/256bbd43.jpg","comment_is_top":false,"comment_ctime":1558775526,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558775526","product_id":100023901,"comment_content":"åˆ†å¸ƒå¼ä¸‹æ•´ä½“æŒ‰æœåŠ¡é™æµå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":97760,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1558767537,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558767537","product_id":100023901,"comment_content":"æ‰“å¡ï¼ä»¤ç‰Œæ¡¶å®¹é‡å¤§äº1çš„éƒ¨åˆ†æ²¡çœ‹æ‡‚ã€‚","like_count":0},{"had_liked":false,"id":97668,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1558745915,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558745915","product_id":100023901,"comment_content":"å¯¹äºè¿™ä¸ªè¯·æ±‚ä»¤ç‰Œçš„çº¿ç¨‹è€Œè¨€ï¼Œå¾ˆæ˜¾ç„¶éœ€è¦ç­‰å¾… 1 ç§’ï¼Œå› ä¸º 1 ç§’ä»¥åï¼ˆç¬¬ 3 ç§’ï¼‰å®ƒå°±èƒ½æ‹¿åˆ°ä»¤ç‰Œäº†ã€‚æ­¤æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾çš„æ—¶é—´ä¹Ÿè¦å¢åŠ  1 ç§’ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºç¬¬ 3 ç§’å‘æ”¾çš„ä»¤ç‰Œå·²ç»è¢«çº¿ç¨‹ T1 é¢„å äº†ã€‚å¤„ç†ä¹‹åå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><br>â€œä¸‹ä¸€ä¸ªä»¤ç‰Œå‘æ”¾çš„æ—¶é—´ä¹Ÿè¦å¢åŠ  1 ç§’â€è¿™å¥è¯æ²¡æ‡‚ï¼Œä¸‹ä¸€ä¸ªä»¤ç‰Œæ˜¯æŒ‡å¯ä»¥ä¸‹ä¸€æ¬¡è¯·æ±‚å¯ä»¥æ‹¿åˆ°çš„æœ‰æ•ˆä»¤ç‰Œå—ï¼›æˆ‘çš„ç†è§£æ˜¯æ¯ç§’éƒ½äº§ç”Ÿä»¤ç‰Œï¼Œç¬¬ 3 ç§’çš„å·²ç»è¢«ä¸Šä¸€ä¸ªè¯·æ±‚å ç”¨äº†ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªè¯·æ±‚å¾—ç­‰åˆ°ç¬¬ 4 ç§’äº§ç”Ÿæœ‰æ•ˆçš„ä»¤ç‰Œæ‰å¯ä»¥ï¼Œè€Œä¸æ˜¯ç¬¬ 4 ç§’ä¸äº§ç”Ÿä»¤ç‰Œï¼›è¿™æ ·ç†è§£å¯¹å—ï¼Œè°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":97657,"user_name":"ææœªæ¥","can_delete":false,"product_type":"c1","uid":1034079,"ip_address":"","ucode":"4A339B35E3B419","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c7/5f/2028aae5.jpg","comment_is_top":false,"comment_ctime":1558744469,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558744469","product_id":100023901,"comment_content":"å½“æˆ‘çœ‹åˆ°ç§¯åˆ†å‡½æ•°æ—¶ï¼Œæ„Ÿè§‰æ•°å­¦ä¹Ÿè¦å¥½å¥½å­¦ä¹ äº†ğŸ˜‚","like_count":0},{"had_liked":false,"id":97653,"user_name":"é«˜æº","can_delete":false,"product_type":"c1","uid":1048887,"ip_address":"","ucode":"751B41FD38EF7D","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/37/12e4c9c9.jpg","comment_is_top":false,"comment_ctime":1558743591,"is_pvip":false,"replies":[{"id":"35089","content":"è¦æ‰¾åˆ°ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œnettyå¹¶ä¸èƒ½è®©å“åº”æ—¶é—´è¶…çŸ­ï¼Œåªèƒ½æé«˜ååé‡ï¼Œå¦‚æœå¹¶å‘é‡ä¸å¤§ï¼Œbioåè€Œæ›´å¿«","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558919135,"ip_address":"","comment_id":97653,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1558743591","product_id":100023901,"comment_content":"è€å¸ˆæƒ³è¯·æ•™ä¸ªå®é™…é—®é¢˜ï¼Œå‡è®¾å•æœºåšæœåŠ¡å™¨ç«¯winå’Œä¸‹é¢Linuxåº”ç”¨ç¨‹åºå®æ—¶socketé€šä¿¡ï¼Œæ¯ä¸ªæ¶ˆæ¯äº¤äº’æ—¶é—´å¤§æ¦‚10æ¯«ç§’ï¼Œæˆ‘ç°åœ¨æƒ³æé€Ÿï¼Œæƒ³æŠŠäº¤äº’æ—¶é—´å˜æˆ0.1æ¯«ç§’ï¼Œæœ‰å•¥æ–¹æ³•è§£å†³æ­¤é—®é¢˜ï¼ŒæœåŠ¡å™¨ç«¯æ‰¿è½½ä¸šåŠ¡å¤„ç†é€»è¾‘å’Œæ•°æ®åº“è¯»å†™æ“ä½œï¼Œè°¢è°¢ï¼Œæˆ‘ç°åœ¨ä¸æ¸…æ¥šè¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³ï¼Œæˆ‘æƒ³æ³•æ˜¯æ›´æ¢ç½‘ç»œæ¡†æ¶ï¼Œä¾‹å¦‚æ¢æˆnettyæ¡†æ¶","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451362,"discussion_content":"è¦æ‰¾åˆ°ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œnettyå¹¶ä¸èƒ½è®©å“åº”æ—¶é—´è¶…çŸ­ï¼Œåªèƒ½æé«˜ååé‡ï¼Œå¦‚æœå¹¶å‘é‡ä¸å¤§ï¼Œbioåè€Œæ›´å¿«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558919135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1232334,"avatar":"","nickname":"13761642169","note":"","ucode":"68137695FC2120","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48732,"discussion_content":"è€å¸ˆæœ‰ä»€ä¹ˆå…¬ä¼—å·æˆ–è€…åšå®¢ä¹‹ç±»çš„å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573522024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}