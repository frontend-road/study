{"id":94156,"title":"性能：前端的性能到底对业务数据有多大的影响？","content":"<p>你好，我是winter。</p><p>从今天开始，我们就从前端知识学习的部分，过渡到了实践部分。这节课我来谈谈性能。</p><p>性能是个特别有意思的话题，在我之前的工作中，从入门的初级工程师到高级别的技术专家，大家都很喜欢谈性能，我以前参与晋升评审，每年总能听到很多关于性能的晋升述职。</p><p>那么，今天我就来谈谈我眼中的性能。</p><h2>性能总论</h2><blockquote>\n<p>while循环快还是for循环快？</p>\n</blockquote><blockquote>\n<p>|0 是不是比 Math.floor 性能好？</p>\n</blockquote><p>网上随处可以见到一类对性能的讨论。一些新人也非常热衷此类讨论。但是实际上，它们除了让你写代码的时候纠结之外，毫无意义。</p><p>为什么这样讲呢？我想讲一个小故事。</p><p>从前有个工程师，特别注重代码细节，有一天他发现系统中的一段代码写的性能很差，因此，他用汇编重写了整段代码，执行效率足足提升了三倍。但是最后，大家发现，用户反馈性能丝毫没有提高，因为他优化的那个进程名字叫“System Idle”。</p><p>所以你看，性能优化不能只着眼于局部的代码。这里，我要提出一个我的观点：<strong>一切没有profiling的性能都是耍流氓</strong>。凡是真正有价值的性能优化，必定是从端到端的业务场景建立体系来考虑的。</p><p>在我的认识中，性能体系的建立可以分成以下几部分：</p><ul>\n<li>现状评估和建立指标；</li>\n<li>技术方案；</li>\n<li>执行；</li>\n<li>结果评估和监控。</li>\n</ul><!-- [[[read_end]]] --><p>下面，我就来为你一一讲解。</p><h2>现状评估和建立指标</h2><p>要想做好性能优化，正确地评估现状和建立指标是最关键的一步，它又往往是会被轻视的一步。</p><p>作为一个工程师，指标又要考虑两个因素。一方面，对用户来说，什么样的性能指标能更好地评估它的体验？另一方面，对公司来说，什么样的指标会影响业务价值呢？</p><p>在我公布答案之前，我希望你能思考一下，你所负责的业务，是否有前端性能指标？它是否能够满足我上面提到的两个要求？</p><p>在我之前的工作中，整个用了长达一年的时间来探索，才找到了合适的指标，并且回答好了两个问题。</p><p>性能问题可以分成很多方面，最重要的几个点是：</p><ul>\n<li>页面加载性能；</li>\n<li>动画与操作性能；</li>\n<li>内存、电量消耗。</li>\n</ul><p><strong>注意，这里我们仅仅是对“性能”两个字的分析和解读，在对大量的用户数据分析后，我们发现，其实这三部分中，“页面加载性能”跟用户的流失率有非常强的关联性，而用户流失率，正是公司业务非常看重的指标。</strong></p><p>因此，在开始阶段，我们决定把性能优化的重点放在页面加载性能上。</p><p>那么，用什么指标来衡量页面加载性能呢？最容易想到的方案是“用户平均加载时间”，事实上，我们在相当长的一段时间，也都是在使用用户平均加载时间作为性能指标。</p><p>但是，很快我们发现，这个指标有严重的问题：</p><ul>\n<li>当加载时间低于一定数字，用户体感差别不大了，我们经过一定的研究，认为这个数字大约是1秒；</li>\n<li>少数超长时间加载的用户（如2G），会极大影响整个指标，即指标不能反映大多数用户的体验。</li>\n</ul><p>于是，基于以上分析，我们设计了一个新的指标——秒开率，即一秒之内打开的用户占用户总量的百分比。这个指标后来逐渐推广到整个公司，甚至影响到了一些业内的其它企业，现在，谈秒开率已经是个非常自然的事情了，但是当初的设计确实走了不少弯路。</p><h2>技术方案</h2><p>有了指标，我们就有了优化的目标，接下来，就到了技术出场的环节了。</p><p>我们这里还是以加载过程为例，来讲解一下。</p><p>首先我们要简单分析一下，从输入URL后按下回车，到底发生了什么。</p><p>我们在浏览器的原理课程中，已经讲解了浏览器大致的工作过程，但是，我们必须理解几件事：</p><ul>\n<li>从域名到IP地址，需要用DNS协议查询；</li>\n<li>HTTP协议是用TCP传输的，所以会有TCP建立连接过程；</li>\n<li>如果使用HTTPS，还有有HTTPS交换证书；</li>\n<li>每个网页还有图片等请求。</li>\n</ul><p>从这个分析和实际试验的结果看，网页的加载时间，不但跟体积有关系，还跟请求数有很大关系，因此，我们最终设计的技术方案大约可以这样划分：</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/f2/6b5051c452af8c3db5fbb8ba6b9e34f2.jpg?wh=1043*566\" alt=\"\"></p><p>这里仅仅列出了性能优化的一部分技术方案，是我认为比较重要的部分，可以看到，这里涉及的并不仅仅是前端技术，有服务端、客户端、设计师团队，所以要想做好性能优化，绝对不能把自己限制在局部的视角，必须是整个业务一起考虑，才能有良好的收效。</p><h2>执行</h2><p>技术方案设计好了，它是不会自己变成线上页面的，所以，有了技术方案，我们只完成了一半的工作，接下来我们还需要一个执行过程。</p><p>执行也不简单，如果说方案主要靠技术，那么执行就是靠工程实施了。</p><p>根据公司的实际情况，工程实施可能有不同的程度，我把工程水平从低到高分成三个阶段：</p><ul>\n<li>纯管理；</li>\n<li>制度化；</li>\n<li>自动化。</li>\n</ul><p>纯行政管理，是由经理用纯粹的管理手段来执行方案，比如说，作为前端团队的Leader，我可以组织会议，要求整个团队使用我们前面谈的技术方案。</p><p>但是纯行政管理有一些问题，一方面，需要的行政资源不一定有，比如我没法强制让后端团队配合我，另一方面，纯粹的管理方式，团队本身的体验并不好，也不利于团队成长，最重要的是，纯粹管理方式容易造成执行不到位。这样的执行方式多数出现在非技术岗位。</p><p>制度化执行方式是用规则代替人的命令，指定责任人，通过培训、checklist、定期review等具体措施来保证实施。制度化执行可以极大地减轻管理工作量，一般现代互联网公司都会采用类似的方式。但是制度化执行方式还有很大成分是依靠人的主动性的，对程序员来说，还有更好的方式：自动化。</p><p>自动化的方式是在一些重要的操作路径上设置规则，针对我们的性能优化，有两个点适合做这件事：一个是把开发好的页面发布上线，另一个是开发好的页面URL投放到首页等处的链接。</p><p>在我之前的工作中，我们跟测试团队配合，开发了一套页面性能打分系统，它会自动扫面页面上的可优化点，并且跟发布平台和投放平台合作，把它加入日常机制中。现在多数公司都会采用制度化和自动化结合的执行方案。</p><h2>结果评估和监控</h2><p>执行完了之后，<strong>就要向老板汇报争取升职加薪了</strong>，还要有一定的结果总结，才是一个完整的工程实施，而且，凡是工程实施，肯定要有一定长效机制，不能优化完了退化，这些都要求有线上监控机制。</p><p>要想做线上监控，分两个部分：</p><ul>\n<li>数据采集；</li>\n<li>数据展现。</li>\n</ul><p>数据采集部分，同样需要发布平台或者开发工具来配合，对性能数据来说，Performance API非常好用，它是浏览器记录的性能数据，一般来说，我们用统一的代码把它上传到服务器端就够用了。</p><p>数据的展现部分就比较自由了，可以用不同的数据可视化方案来展现性能数据，没有一定之规。一般的数据监控平台，会提供报警机制，对性能来说，报警需求不是特别强烈，但是也可以设置一些条件，针对秒开率特别低的网页报警。</p><p>有了监控，再配合一定制度，就可以保障整个团队产出的性能了，要注意，性能不是一个静态的事情，指标需要不断优化，技术方案还需要不断随着技术发展迭代，制度、自动化工具也需要不断改进，最终的监控平台产品也不能不做新需求，所以性能应该成为一个团队的日常工作的一部分，持续进行。</p><h2>总结</h2><p>今天我们学习了前端团队工程实施中的性能体系，首先我们介绍了总体思想：性能应该是基于业务和实际用户体验需求的一种工程实施，不是纯粹的技术游戏。</p><p>接下来我们分成四个步骤介绍了性能工程体系，首先介绍了现状评估和建立指标，建立指标应当从业务的角度考虑，接下来讲了技术方案设计，技术方案应当从整体角度，基于Profiling的结果分析来设计。</p><p>之后我们讲了实施，我们讲了工程实施的三个层次：纯管理、制度化、工程化，最后，我们讲了结果评估和线上监控，线上监控需要从数据采集和数据展现两个部分分别实现。</p><p>最后，留一个小问题，请你为自己的团队和业务设计一下性能的整体方案，欢迎来留言分享。</p><p></p>","neighbors":{"left":{"article_title":"浏览器API（小实验）：动手整理全部API","id":90998},"right":{"article_title":"工具链：什么样的工具链才能提升团队效率？","id":94644}},"comments":[{"had_liked":false,"id":95922,"user_name":"让时间说真话","can_delete":false,"product_type":"c1","uid":1387656,"ip_address":"","ucode":"5C86450864189F","user_header":"https://static001.geekbang.org/account/avatar/00/15/2c/88/2a7fe1a9.jpg","comment_is_top":false,"comment_ctime":1558257419,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"83162636043","product_id":100023201,"comment_content":"Winter老师，关于线上监控的数据采集和数据显示您有好的插件或者方案推荐？","like_count":20,"discussions":[{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386983,"discussion_content":"new relic 也可以试试，有免费版","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627918379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2145313,"avatar":"","nickname":"Steve","note":"","ucode":"C921D4E486ACF5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340378,"discussion_content":"推荐DataDog","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609990315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93417,"user_name":"rh","can_delete":false,"product_type":"c1","uid":1389015,"ip_address":"","ucode":"A815A0F9DA22CD","user_header":"https://static001.geekbang.org/account/avatar/00/15/31/d7/22066e9e.jpg","comment_is_top":false,"comment_ctime":1557467173,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48802107429","product_id":100023201,"comment_content":"winter老师好，看了这篇文章，受益良多。我对文中提到的 “页面性能打分系统“ 非常的感兴趣，非常想进一步了解它是怎么设计的，以及针对页面性能的诸多问题点又是如何逐个解决的？<br><br>","like_count":12},{"had_liked":false,"id":92900,"user_name":"程序员二师兄","can_delete":false,"product_type":"c1","uid":1205697,"ip_address":"","ucode":"C9E3B5B3358BDF","user_header":"https://static001.geekbang.org/account/avatar/00/12/65/c1/afcd981b.jpg","comment_is_top":false,"comment_ctime":1557363156,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"40212068820","product_id":100023201,"comment_content":"这篇文章不错，之前自己也是特别想给项目做性能方面的监控，一直找不到好的方案，这篇文章给了一个很好的实施方向，感谢🙏","like_count":8},{"had_liked":false,"id":105918,"user_name":"ctw","can_delete":false,"product_type":"c1","uid":1373561,"ip_address":"","ucode":"C59971B0BB9D34","user_header":"https://static001.geekbang.org/account/avatar/00/14/f5/79/13132482.jpg","comment_is_top":false,"comment_ctime":1561104550,"is_pvip":false,"replies":[{"id":"58940","content":"1.实践是检验真理的唯一标准，用你的业务实际测一测，不要纸上谈兵<br>2.所以需要html缓存来配合，不能做服务端渲染。","user_name":"作者回复","comment_id":105918,"uid":"1268524","ip_address":"","utype":1,"ctime":1574222078,"user_name_real":"winter"}],"discussion_count":1,"race_medal":0,"score":"18740973734","product_id":100023201,"comment_content":"winter老师好，关于性能优化，我有一点疑问，如果把js，css都打包到html里面，会不会带来两个问题：<br>1. 请求数变少了，但是html变大了，请求html返回时间会变慢<br>2. html一般不设置缓存，这样很大的html每次刷新都会重新请求","like_count":5,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454868,"discussion_content":"1.实践是检验真理的唯一标准，用你的业务实际测一测，不要纸上谈兵\n2.所以需要html缓存来配合，不能做服务端渲染。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574222078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109526,"user_name":"Geek_883b55","can_delete":false,"product_type":"c1","uid":1583440,"ip_address":"","ucode":"5A90B12CB19936","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ4mmPbWgib79xeiaMQU65pgT1gNzSajb0Jg0kPu8dQAU7eXGNJiaLL3TqHLCJtfA7ScmJvMRRs6pPtg/132","comment_is_top":false,"comment_ctime":1562051208,"is_pvip":false,"replies":[{"id":"58924","content":"具体实施可以单独写一本书。","user_name":"作者回复","comment_id":109526,"uid":"1268524","ip_address":"","utype":1,"ctime":1574221270,"user_name_real":"winter"}],"discussion_count":3,"race_medal":0,"score":"14446953096","product_id":100023201,"comment_content":"Winter老师您好，本篇文章看完之后给我的感觉是给了一个大概的方向，但是比如说监控工具具体怎么实施还不够清楚，希望老师能稍微具体的讲解一下，让我们学习一下大厂的技术和方案","like_count":4,"discussions":[{"author":{"id":1268524,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5b/2c/12bfd3cd.jpg","nickname":"winter","note":"","ucode":"2B068EDEAFEB56","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456452,"discussion_content":"具体实施可以单独写一本书。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574221270,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/98ebb20e.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386986,"discussion_content":"简单实施的话，可以使用一些开源的或者云端的 RUM。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627918905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1359476,"avatar":"https://static001.geekbang.org/account/avatar/00/14/be/74/0d900ed9.jpg","nickname":"Tristan","note":"","ucode":"DC454E16AAA66A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305239,"discussion_content":"出书，我王多鱼投了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599824128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169818,"user_name":"稚鸿同学","can_delete":false,"product_type":"c1","uid":1212581,"ip_address":"","ucode":"989804DB990385","user_header":"https://static001.geekbang.org/account/avatar/00/12/80/a5/83b424bc.jpg","comment_is_top":false,"comment_ctime":1578452086,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"10168386678","product_id":100023201,"comment_content":"有个苗头，通过performance API做数据采集和数据展现，具体还真的希望winter大大可以提供一些资料，可以落实到自己to G 的项目中","like_count":3,"discussions":[{"author":{"id":1100750,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/ce/d9e00eb5.jpg","nickname":"undefined","note":"","ucode":"768098DBDBE333","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363408,"discussion_content":"to g是啥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617190146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2086771,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/d7/73/57ee1835.jpg","nickname":"My","note":"","ucode":"BAEC917EBF2C3A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1100750,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cb/ce/d9e00eb5.jpg","nickname":"undefined","note":"","ucode":"768098DBDBE333","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578914,"discussion_content":"to goverment?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657090862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":363408,"ip_address":""},"score":578914,"extra":""}]}]},{"had_liked":false,"id":97129,"user_name":"梦演绎奢华","can_delete":false,"product_type":"c1","uid":1054257,"ip_address":"","ucode":"164833D51565C2","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/31/a40616fd.jpg","comment_is_top":false,"comment_ctime":1558593894,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5853561190","product_id":100023201,"comment_content":"公司前端还没有工程化","like_count":2,"discussions":[{"author":{"id":2033513,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/07/69/43cf2251.jpg","nickname":"Alan He","note":"","ucode":"A0780F4619D388","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551294,"discussion_content":"比如如果就一个公司首页/博客之类的，确实不需要，有需求上就行。\n\n工程化我理解是根据问题规模决定，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644977164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93804,"user_name":"Jurieo","can_delete":false,"product_type":"c1","uid":1382175,"ip_address":"","ucode":"A4ED90DC31F446","user_header":"https://static001.geekbang.org/account/avatar/00/15/17/1f/47868a4a.jpg","comment_is_top":false,"comment_ctime":1557623136,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5852590432","product_id":100023201,"comment_content":"winter老师你好，我们公司的前端是nodejs写的，如何做性能监控呢，如何做页面加载优化呢，我对您的页面性能打分系统很感兴趣，能详细讲一讲吗？谢谢了","like_count":1,"discussions":[{"author":{"id":1710685,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/1a/5d/3c8004c6.jpg","nickname":"*","note":"","ucode":"DB5BA86B4D7E5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559562,"discussion_content":"我觉得重点不是它的技术实现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648816531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016394,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIYg80llu8nzJn5x394p9WsKuac5qgCU506tBXIqUvTbe19YYMLEzo46rf2FQJvNLzcx9lnmYjDeg/132","nickname":"ssaylo","note":"","ucode":"3CBDC64385BEE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299810,"discussion_content":"公司前端是 node.js写的？？？你确定？？？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597827151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1645413,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/OWO43KiahibaWnZWkEzXfNQCAqAvVNia44HLxzaNbPKZxiaic3ameJ72dLros26ibxuCL1B5pl7MRlOVrqutNsTOXegQ/132","nickname":"JY","note":"","ucode":"54DF39E40C0F20","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1016394,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIYg80llu8nzJn5x394p9WsKuac5qgCU506tBXIqUvTbe19YYMLEzo46rf2FQJvNLzcx9lnmYjDeg/132","nickname":"ssaylo","note":"","ucode":"3CBDC64385BEE9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300171,"discussion_content":"应该是服务端渲染吧，请求返回的都是渲染好的页面","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1597975047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":299810,"ip_address":""},"score":300171,"extra":""}]}]},{"had_liked":false,"id":279560,"user_name":"南城","can_delete":false,"product_type":"c1","uid":1377308,"ip_address":"","ucode":"EB6029016A46FE","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/1c/7899bab4.jpg","comment_is_top":false,"comment_ctime":1613821476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613821476","product_id":100023201,"comment_content":"我的愚见，css和js合并来说会比较好，现在网速普遍不慢，减少握手损耗。当然，如果面向未来，http2的话，能减少头信息。","like_count":0},{"had_liked":false,"id":269057,"user_name":"Geek_782401","can_delete":false,"product_type":"c1","uid":1746575,"ip_address":"","ucode":"253F3CC42FA15F","user_header":"","comment_is_top":false,"comment_ctime":1608513081,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1608513081","product_id":100023201,"comment_content":"js和css打包到html中，怎么可以减少请求数？这一点不是很明白，老师能讲明白一点吗","like_count":0,"discussions":[{"author":{"id":1301073,"avatar":"https://static001.geekbang.org/account/avatar/00/13/da/51/784f5166.jpg","nickname":"Geek_321964","note":"","ucode":"F4F87BBCB9FC28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352971,"discussion_content":"都打包到html中，就不用再去请求js和css文件了。这要根据具体情况而定，不是所有的js何css都要打包到html。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614932135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210244,"user_name":"sugar","can_delete":false,"product_type":"c1","uid":1167046,"ip_address":"","ucode":"454538FF253B5F","user_header":"https://static001.geekbang.org/account/avatar/00/11/ce/c6/958212b5.jpg","comment_is_top":false,"comment_ctime":1587704670,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587704670","product_id":100023201,"comment_content":"winter老师在文中主要讲了页面加载性能的统计。请问 动画与操作性能，如何建立客观量化的监控指标呢？","like_count":0},{"had_liked":false,"id":196076,"user_name":"Geek_ab9b5f","can_delete":false,"product_type":"c1","uid":1778076,"ip_address":"","ucode":"080FAE08B0128A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLAmpDkIxlMjoRlVbicOmdAmrdr9bnfsCkcCPzo53ibzMeSt8ygtJXQiaTfU4rSe9qHJkOAQcUOQj9s9A/132","comment_is_top":false,"comment_ctime":1585233780,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585233780","product_id":100023201,"comment_content":"收益匪浅，报了winter老师的课","like_count":0},{"had_liked":false,"id":164183,"user_name":"Sun 🙃","can_delete":false,"product_type":"c1","uid":1396293,"ip_address":"","ucode":"342590FE20F231","user_header":"https://static001.geekbang.org/account/avatar/00/15/4e/45/1e463459.jpg","comment_is_top":false,"comment_ctime":1576903615,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1576903615","product_id":100023201,"comment_content":"我们公司做的是B端的业务，基本上是与数据交互，性能优化基本上体现在服务端，比如万亿库秒开率；前端没有任何的性能优化方案，应该来说整体的性能优化应该放在服务端的架构层面。","like_count":0,"discussions":[{"author":{"id":1085068,"avatar":"https://static001.geekbang.org/account/avatar/00/10/8e/8c/4c430896.jpg","nickname":"DreamFox","note":"","ucode":"3D42D66CB4E128","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":100387,"discussion_content":"这个不太对吧，前端总是有优化空间的，比如你打开页面ready的时间，数据展示图表的渲染和交互时间等等，只是说可能业务上后端性能的天花板更高点","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577256551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103226,"user_name":"靠人品去赢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1560400274,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1560400274","product_id":100023201,"comment_content":"说一下我目前做的小程序方面的前端优化措施：<br>（1）请求处理：尽量减少请求数，减少的无谓的请求，能用一个请求数据解决就用一个请求。异步请求其实也是提高的一部分（注意情况的分类以及callback）<br>（2）利用缓存，有些东西可以放在缓存了，先去缓存中拿这些数据，拿不到在进一步处理。<br>（3）有的图片太大，还是要压缩一下的，最简单的体积小加载的自然也就快。<br><br>问题：之前我也拿过矢量svg图片来替代小程序的png图片，但是效果不好，可能你看svg图片没什么不一样，替代后你会发现矢量svg图片会出现错位的问题，和你拿看图工具看的不一样，什么原因导致的？怎么解？svg图片一定就会比常见的图片格式加载快吗？原理是什么？","like_count":0,"discussions":[{"author":{"id":1385477,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/7xBejUvOATree6j8WxG7fmMpBS3iczybeYWE3wv8nmtFjNNpjxqOOhqUu6L6icnZAx5Iic7evolySnWIniafKHcmUw/132","nickname":"hubyq","note":"","ucode":"75E946A64B4702","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5326,"discussion_content":"svg是HTML标签，图片是资源","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566180929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96300,"user_name":"南墙的树","can_delete":false,"product_type":"c1","uid":1384130,"ip_address":"","ucode":"289B98CA489C09","user_header":"https://static001.geekbang.org/account/avatar/00/15/1e/c2/edf5dfcb.jpg","comment_is_top":false,"comment_ctime":1558396921,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558396921","product_id":100023201,"comment_content":"最近一直在研究前端性能优化和线上错误收集，收效甚微，老师可以讲解一下大厂是怎么处理的吗？","like_count":0}]}