{"id":614518,"title":"14ï½œä»£ç å•å…ƒæµ‹è¯•ï¼šå¦‚ä½•è½»æ¾åœ°ä¿è¯è‡ªå·±çš„ä»£ç è´¨é‡ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æ¨æ–‡åšã€‚</p><p>å›é¡¾å‰é¢Vue.js 3.xè‡ªç ”ç»„ä»¶åº“çš„å‡ èŠ‚è¯¾ï¼Œæˆ‘ä»¬åˆ†åˆ«å­¦ä¹ äº†å¦‚ä½•å¼€å‘ä¸»é¢˜æ–¹æ¡ˆã€åŸºç¡€ç»„ä»¶ã€åŠ¨æ€æ¸²æŸ“ç»„ä»¶ã€å¸ƒå±€ç»„ä»¶å’Œè¡¨å•ç»„ä»¶ï¼Œè¿™äº›éƒ½æ˜¯æ„æˆåŸºç¡€ç»„ä»¶åº“çš„ä¸»è¦å› ç´ ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åç»­å¼€å‘ä¸šåŠ¡ç»„ä»¶åº“å’Œæ‰“é€ ä¸€ä¸ªè¿è¥æ­å»ºå¹³å°çš„å‰ç«¯â€œåŸºçŸ³â€ã€‚</p><p>è¦çŸ¥é“ï¼Œåœ¨å¼€å‘ä¸šåŠ¡ç»„ä»¶åº“å’Œæ‰“é€ è¿è¥æ­å»ºå¹³å°çš„æ—¶å€™ï¼Œç»„ä»¶åº“ä»£ç çš„â€œç¨³å®šæ€§â€å’Œâ€œå¥å£®æ€§â€æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœåŸºç¡€ç»„ä»¶åº“ä¸ç¨³å®šï¼Œç»å¸¸å‡ºé—®é¢˜ï¼Œé‚£ä¹ˆåŸºäºå®ƒæ„æˆçš„ä¸šåŠ¡ç»„ä»¶æˆ–å‰ç«¯é¡µé¢å°±ä¼šé¢‘ç¹å‡ºBugã€‚é‚£ä¹ˆï¼Œç»„ä»¶åº“å‡ºé—®é¢˜ä¼šæœ‰å“ªäº›åŸå› å‘¢ï¼Ÿ</p><p>ä¸€èˆ¬æ˜¯ç»„ä»¶çš„â€œé€»è¾‘åˆ†æ”¯å¤šâ€å’Œâ€œæµ‹è¯•ä¸å½»åº•â€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ å¼€å‘äº†ä¸€ä¸ªæŒ‰é’®ç»„ä»¶ï¼ˆButtonï¼‰ï¼ŒæŒ‰é’®ç»„ä»¶åˆè¢«å¯¹è¯æ¡†ç»„ä»¶ã€è¡¨å•ç»„ä»¶ä½¿ç”¨ã€‚è¿™æ—¶å€™å¦‚æœä½ ç»™æŒ‰é’®ç»„ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬é”®ç›˜å¿«æ·é”®çš„åŠŸèƒ½ï¼Œå¼€å‘å®Œæˆåï¼Œç»è¿‡äººå·¥éªŒè¯ä¿è¯äº†æŒ‰é’®ç»„ä»¶æœ¬èº«åŸæœ‰åŠŸèƒ½ä¸€åˆ‡æ­£å¸¸ï¼Œä½†ä½¿ç”¨äº†æŒ‰é’®ç»„ä»¶çš„å¯¹è¯æ¡†å’Œè¡¨å•ç»„ä»¶ï¼Œä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨å—ï¼Ÿæ˜¯ä¸æ˜¯ä¹Ÿå¾—äººå·¥éªŒè¯ä¸€éï¼Ÿå¦‚æœæŒ‰é’®ç»„ä»¶è¢«åå¤šä¸ªå…¶å®ƒåŸºç¡€ç»„ä»¶å¼•ç”¨ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¾—é€ä¸ªäººå·¥éªŒè¯ï¼Ÿ</p><p><strong>è¿™é‡Œçš„ç»„ä»¶è®¾è®¡å’Œå†…éƒ¨ä¾èµ–ä½¿ç”¨å‡ºç°äº†â€œé€»è¾‘åˆ†æ”¯å¤šâ€çš„é—®é¢˜ï¼Œæ¶‰åŠçš„é€»è¾‘åŠŸèƒ½éƒ½è¦äººå·¥éªŒè¯ï¼Œå®¹æ˜“å¯¼è‡´â€œæµ‹è¯•ä¸å½»åº•â€çš„éšæ‚£ã€‚</strong>éšç€ç»„ä»¶åº“é‡Œçš„ç»„ä»¶ç§¯å°‘æˆå¤šï¼Œè¿™ç±»éšæ‚£ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆå¯èƒ½â€œé‡å˜å¼•èµ·è´¨å˜â€ï¼Œå¯¼è‡´â€œåƒé‡Œä¹‹å ¤ï¼Œæºƒäºèšç©´â€çš„ç”Ÿäº§æ•…éšœã€‚</p><!-- [[[read_end]]] --><p>é‚£ä¹ˆï¼Œæœ‰åŠæ³•æ‰“ç ´è¿™ä¸€å›°å¢ƒå—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œå•å…ƒæµ‹è¯•â€ï¼Œé€šè¿‡æŠ€æœ¯çš„æ‰‹æ®µæ¥è‡ªåŠ¨åŒ–â€œæµ‹è¯•ä»£ç â€ã€‚</p><h2>ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•ï¼Ÿ</h2><p>å•å…ƒæµ‹è¯•ï¼Œè‹±æ–‡æ˜¯Unit Testï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºâ€œæ¨¡å—æµ‹è¯•â€ï¼Œä¸»è¦æ˜¯å¯¹ä»£ç æœ€å°å•ä½é€ä¸€è¿›è¡Œæµ‹è¯•éªŒè¯åŠŸèƒ½ã€‚è¿™é‡Œçš„â€œä»£ç æœ€å°å•ä½â€å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ã€ä¸€ä¸ªç»„ä»¶ã€ä¸€ä¸ªç±»ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå˜é‡ã€‚åªè¦æ˜¯èƒ½æ‰§è¡ŒåŠŸèƒ½çš„ä»£ç æ¨¡å—ï¼Œéƒ½å¯ä»¥ç§°ä¹‹ä¸ºä¸€ä¸ªâ€œæœ€å°å•ä½â€ã€‚</p><p>å•å…ƒæµ‹è¯•é‡Œçš„â€œå•å…ƒâ€ï¼Œæ˜¯ä»£ç é‡Œå¯ä»¥æ‰§è¡Œçš„â€œå•ä½â€ï¼Œæµ‹è¯•å°±æ˜¯éªŒè¯è¿™ä¸ªæœ€å°å•ä½çš„ä»£ç æ‰§è¡Œå®Œåçš„ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªæ•°å­¦åŠ å‡ä¹˜é™¤çš„åŠŸèƒ½ä»£ç ï¼ŒåŠ æ³•å‡½æ•°å°±æ˜¯å…¶ä¸­ä¸€ä¸ªå¯æ‰§è¡Œçš„æœ€å°å•ä½ï¼š</p><pre><code class=\"language-typescript\">// è¿™æ˜¯ä¸€ä¸ªåŠ å‡ä¹˜é™¤çš„å‡½æ•°é›†åˆå¯¹è±¡\nconst myMath = {\n\n  // è¿™é‡ŒåŠ æ³•å‡½æ•°ï¼Œå¯ä»¥å½“åšæ˜¯æœ€å°çš„æµ‹è¯•å•ä½\n  add(num1, num2) {\n    return num1 + num2;\n  },\n\n  subtract(num1, num2) {\n    return num1 - num2;\n  },\n\n  multiply(num1, num2) {\n    return num1 * num2;\n  },\n\n  divide(num1, num2) {\n    return num1 / num2;\n  }\n};\n</code></pre><p>è¿™æ—¶å€™ï¼Œè¦å¯¹åŠ æ³•å‡½æ•°è¿™ä¸ªâ€œå•å…ƒâ€è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œå¦‚æœæµ‹è¯•æˆåŠŸï¼Œå°±è¾“å‡ºæˆåŠŸæç¤ºï¼Œå¦‚æœæµ‹è¯•å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯æµ‹è¯•ç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œå°±æŠ›å‡ºé”™è¯¯ï¼ˆthrow Errorï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ¥å®ç°æµ‹è¯•ä»£ç ï¼š</p><pre><code class=\"language-typescript\">const result = myMath.add(1, 2);\nconst expect = 3;\nif (result === expect) {\n  console.log('myMath.add åŠ æ³•æµ‹è¯•æˆåŠŸï¼');\n} else {\n  throw Error(\n    `myMath.add åŠ æ³•æµ‹è¯•å¤±è´¥ï¼ŒæœŸå¾…ç»“æœåº”è¯¥æ˜¯ï¼š${expect}ï¼Œä½†å®é™…ç»“æœä¸ºï¼š${result}`\n  );\n}\n</code></pre><p>ä¸Šè¿°ä»£ç åœ¨Node.jsç¯å¢ƒé‡Œæµ‹è¯•æˆåŠŸçš„æ•ˆæœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ae/0b/ae98406a6cb05b136baf98f67e9e660b.png?wh=1456x488\" alt=\"å›¾ç‰‡\"></p><p>è¿™æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å°† expect å˜é‡ä¿®æ”¹ä¸€ä¸‹ï¼ŒæœŸå¾…å€¼å°±ä¸ç¬¦åˆé¢„æœŸï¼Œè§¦å‘æµ‹è¯•å¤±è´¥ï¼ŒæŠ¥é”™æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/7a/a1/7aeyy3a2787b8295d6765d9a235d14a1.png?wh=1676x888\" alt=\"å›¾ç‰‡\"></p><p>ä¸è¿‡ï¼Œä¸Šè¿°æµ‹è¯•ä»£ç ä½¿ç”¨throw Errorï¼Œä¼šä¸­æ–­JavaScriptçš„æ‰§è¡Œæµç¨‹ã€‚å¦‚æœæˆ‘ä»¬è¦æµ‹è¯•æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶ä¸”è¦æ”¶é›†ç»“æœï¼Œä¹Ÿè¦throwå‡ºé”™è¯¯ï¼Œé‚£å¯ä»¥è¿™ä¹ˆå®ç°ä¸€ä¸ªæœ€ç®€å•çš„å•å…ƒæµ‹è¯•ç®¡ç†æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-typescript\">const allUnitTestResults = [];\nfunction unitTest(name, callback) {\n  let success = false;\n  let error = null;\n  try {\n    callback();\n    success = true;\n  } catch (err) {\n    error = err;\n  }\n  allUnitTestResults.push({\n    name,\n    success,\n    error\n  });\n}\n\nunitTest('åŠ æ³•å‡½æ•° add', () =&gt; {\n  const result = myMath.add(1, 2);\n  const expect = 3;\n  if (result === expect) {\n    console.log('myMath.add åŠ æ³•æµ‹è¯•æˆåŠŸï¼');\n  } else {\n    throw Error(\n      `myMath.add åŠ æ³•æµ‹è¯•å¤±è´¥ï¼ŒæœŸå¾…ç»“æœåº”è¯¥æ˜¯ï¼š${expect}ï¼Œä½†å®é™…ç»“æœä¸ºï¼š${result}`\n    );\n  }\n});\n\nunitTest('å‡æ³•å‡½æ•° subtract', () =&gt; {\n  const result = myMath.subtract(3, 2);\n  const expect = 1;\n  if (result === expect) {\n    console.log('myMath.add å‡æ³•æµ‹è¯•æˆåŠŸï¼');\n  } else {\n    throw Error(\n      `myMath.add å‡æ³•æµ‹è¯•å¤±è´¥ï¼ŒæœŸå¾…ç»“æœåº”è¯¥æ˜¯ï¼š${expect}ï¼Œä½†å®é™…ç»“æœä¸ºï¼š${result}`\n    );\n  }\n});\n\nlet successCount = 0;\nlet failCount = 0;\nallUnitTestResults.forEach((item) =&gt; {\n  if (item.success === true) {\n    successCount++;\n  } else {\n    failCount++;\n    console.log(item.error);\n  }\n});\n\nconsole.log(`æ€»å…± ${allUnitTestResults.length}ä¸ªæµ‹è¯•ç”¨ä¾‹`);\nconsole.log(`æµ‹è¯•æˆåŠŸä¸ªæ•°ï¼š ${successCount}`);\nconsole.log(`æµ‹è¯•å¤±è´¥ä¸ªæ•°ï¼š ${failCount}`);\n</code></pre><p>æµ‹è¯•æ•ˆæœè¿è¡Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/10/dc/106dd28a7640b834e83ca9d16a01d4dc.png?wh=1544x638\" alt=\"å›¾ç‰‡\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œâ€œå•å…ƒæµ‹è¯•â€æ˜¯æˆ‘äººå·¥å†™JavaScriptä»£ç æ¥ç®¡ç†çš„ï¼Œé‚£ä¹ˆï¼Œèƒ½å¦æœ‰å¯¹åº”çš„JavaScriptæ¡†æ¶å¯ä»¥æ¥ç»Ÿä¸€ç®¡ç†å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹å‰ç«¯å•å…ƒæµ‹è¯•éƒ½è¦å‡†å¤‡ä»€ä¹ˆå·¥å…·ã€‚</p><h2>å‰ç«¯å•å…ƒæµ‹è¯•éœ€è¦ç”¨ä»€ä¹ˆå·¥å…·ï¼Ÿ</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ï¼Œå‰ç«¯å•å…ƒæµ‹è¯•æœ‰ä»€ä¹ˆå¿…å¤‡çš„è¦ç´ ã€‚å‰é¢çš„â€œæ•°å­¦åŠ å‡ä¹˜é™¤â€åŠŸèƒ½ä»£ç çš„æµ‹è¯•å®ç°ï¼Œå¯ä»¥åˆ†æˆä¸‰ä¸ªè¿‡ç¨‹ï¼š</p><ul>\n<li>ç¬¬ä¸€æ­¥ï¼šâ€œè¾“å…¥â€è¦æ‰§è¡Œçš„å•å…ƒä»£ç ï¼Œç­‰å¸¦æ‰§è¡Œå®Œçš„â€œè¾“å‡ºâ€ç»“æœï¼›</li>\n<li>ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œåçš„â€œè¾“å‡ºâ€è¿›è¡Œâ€œæ–­è¨€â€ï¼Œè¿™é‡Œçš„â€œæ–­è¨€â€å°±æ˜¯æŒ‡ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸï¼›</li>\n<li>ç¬¬ä¸‰æ­¥ï¼šé€ä¸ªæ”¶é›†æ‰€æœ‰å•å…ƒæµ‹è¯•ç»“æœï¼Œå¹¶åšæœ€åçš„ç»Ÿè®¡å¤„ç†ã€‚</li>\n</ul><p>çŸ¥é“äº†å‰ç«¯å•å…ƒæµ‹è¯•çš„æ ¸å¿ƒè¿‡ç¨‹åï¼Œä½ è¿˜éœ€è¦æ³¨æ„å‰ç«¯ä»£ç çš„è¿è¡Œç¯å¢ƒã€‚å› ä¸ºåœ¨ç»å¯¹å¤§å¤šæ•°çš„å‰ç«¯é¡¹ç›®ä¸­ï¼ŒJavaScriptçš„è¿è¡Œç¯å¢ƒä¸»è¦æœ‰Node.jså’Œæµè§ˆå™¨è¿™ä¸¤ç§ï¼Œè¿™ä¸¤ç§ç¯å¢ƒæœ‰æ¯”è¾ƒå¤§çš„APIæ”¯æŒå·®å¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨Node.jsç¯å¢ƒä¸­ï¼Œæ²¡æœ‰æµè§ˆå™¨ç¯å¢ƒé‡Œçš„æ“ä½œDOMçš„APIã€‚</p><p>æˆ‘ä»¬ç°åœ¨åšçš„æ˜¯Vue.jsç›¸å…³çš„å•å…ƒæµ‹è¯•ï¼ŒVue.jsæ˜¯æ”¯æŒåœ¨æµè§ˆå™¨æ“ä½œDOMçš„æ¡†æ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é€‰æ‹©å•å…ƒæµ‹è¯•å·¥å…·æ—¶å€™ï¼Œå¿…é¡»æ”¯æŒæµè§ˆå™¨çš„APIã€‚</p><p>ç›®å‰ï¼Œå¸‚é¢æ”¯æŒæµ‹è¯•â€œæ–­è¨€â€æˆ–â€œæµ‹è¯•ç®¡ç†â€çš„ä¸»æµå‰ç«¯JavaScriptå•å…ƒæµ‹è¯•å·¥å…·ï¼Œæœ‰Mochaã€Jestå’ŒVitestï¼š</p><ul>\n<li><a href=\"https://mochajs.org/\">Mocha</a> æ˜¯é¢å‘Node.jsç¯å¢ƒçš„JavaScriptå•å…ƒæµ‹è¯•ï¼Œä¸èƒ½ç›´æ¥æ”¯æŒæµè§ˆå™¨çš„APIï¼Œæ–­è¨€å¯ä»¥ä½¿ç”¨Node.jsè‡ªå¸¦assertæ¨¡å—æˆ–è€…ç¬¬ä¸‰æ–¹æ–­è¨€å·¥å…·ï¼Œä¾‹å¦‚Chaiï¼›</li>\n<li><a href=\"https://jestjs.io/\">Jest</a> æ˜¯åŒæ—¶æ”¯æŒNode.jså’Œåœ¨Node.jsé‡Œæ¨¡æ‹Ÿæµè§ˆå™¨APIçš„æµ‹è¯•å·¥å…·ï¼Œå†…éƒ¨è‡ªå¸¦æµ‹è¯•â€œæ–­è¨€â€å’Œâ€œç®¡ç†â€å·¥å…·ï¼Œæ˜¯React.jså®˜æ–¹ç»´æŠ¤çš„æµ‹è¯•å·¥å…·ã€‚</li>\n<li><a href=\"https://vitest.dev/\">Vitest</a> è·ŸJestä¸€æ ·ï¼Œéƒ½èƒ½æ”¯æŒNode.jså’Œæµè§ˆå™¨APIï¼Œä¹Ÿè‡ªå¸¦æµ‹è¯•â€œæ–­è¨€â€å’Œâ€œç®¡ç†â€å·¥å…·ï¼Œæ˜¯Vue.jså®˜æ–¹ç»´æŠ¤çš„æµ‹è¯•å·¥å…·ï¼Œå¯¹Vue.jsçš„æ”¯æŒèƒ½åŠ›æ¯”è¾ƒå‹å¥½ã€‚</li>\n</ul><p>æ—¢ç„¶Vitestæ˜¯Vue.jså®˜æ–¹æ”¯æŒå’Œç»´æŠ¤ï¼Œé‚£ä¹ˆæ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬é€‰æ‹©Vitestæ˜¯æ¯”è¾ƒæœ‰ä¼˜åŠ¿çš„ã€‚æ‰€ä»¥è¿™èŠ‚è¯¾çš„å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬éƒ½å›´ç»•Vue.jså®˜æ–¹æµ‹è¯•å·¥å…·Vitestæ¥è¿›è¡Œã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•ç”¨Vitestï¼Œç»™Vue.js 3.xç»„ä»¶åº“åšå•å…ƒæµ‹è¯•å‘¢ï¼Ÿ</p><h2>å¦‚ä½•ç”¨Vitestç»™Vue.js 3.xç»„ä»¶åº“åšå•å…ƒæµ‹è¯•ï¼Ÿ</h2><p>ä½¿ç”¨Vitestæ¥åšå•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯ç¯å¢ƒå‡†å¤‡ã€‚ç¯å¢ƒå‡†å¤‡ä¸»è¦åˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼Œå®‰è£…ç›¸å…³npmæ¨¡å—ä¾èµ–å’ŒåšVitestçš„é¡¹ç›®é…ç½®ã€‚</p><p><strong>å…ˆæ¥çœ‹ç¬¬ä¸€æ­¥ï¼Œå®‰è£…ç›¸å…³npmæ¨¡å—ä¾èµ–ï¼š</strong></p><pre><code class=\"language-shell\"># åŸºäº npm å®‰è£…\nnpm i -D vitest @vue/test-utils @vitejs/plugin-vue @vitejs/plugin-vue-jsx jsdom\n\n# æˆ–è€…åŸºäº pnpm æ¥å®‰è£…\npnpm i -D vitest @vue/test-utils @vitejs/plugin-vue @vitejs/plugin-vue-jsx jsdom\n</code></pre><p>æ¯ä¸ªnpmæ¨¡å—çš„ä½œç”¨ï¼š</p><ul>\n<li>vitestï¼Œ æ˜¯Vitestæµ‹è¯•å·¥å…·æ ¸å¿ƒæ¨¡å—ï¼Œæä¾›äº†å•å…ƒæµ‹è¯•ç®¡ç†å’Œæ–­è¨€ç­‰å·¥å…·ï¼›</li>\n<li>@vue/test-utilsï¼Œæ˜¯Vue.jsæµ‹è¯•å·¥å…·ï¼Œè¾…åŠ©å¤„ç†Vue.jsåœ¨Node.jsç¯å¢ƒé‡Œæ“ä½œDOMæ¸²æŸ“å’ŒDOMäº‹ä»¶ç­‰æ“ä½œï¼›</li>\n<li>@vitejs/plugin-vueï¼Œæ˜¯Vitestçš„æ’ä»¶ï¼Œæ”¯æŒç›´æ¥æ„å»ºè¿è¡ŒVue.jsæ¨¡æ¿ä»£ç ï¼›</li>\n<li>@vitejs/plugin-vue-jsxï¼Œæ˜¯Vitestçš„æ’ä»¶ï¼Œæ”¯æŒç›´æ¥æ„å»ºè¿è¡ŒVue.jsçš„JSXä»£ç ï¼›</li>\n<li>jsdomï¼Œç”¨æ¥åœ¨Node.jsç¯å¢ƒä¸­æ¨¡æ‹Ÿæµè§ˆå™¨çš„åŸç”ŸAPIï¼Œä¾‹å¦‚æ“ä½œDOMçš„åŸç”ŸAPIç­‰ã€‚</li>\n</ul><p><strong>ç¬¬äºŒæ­¥ï¼Œåœ¨å®‰è£…ä¾èµ–åï¼Œæˆ‘ä»¬å°±éœ€è¦åšVitestçš„é¡¹ç›®é…ç½®ã€‚</strong>å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶ ./vitest.config.jsï¼š</p><pre><code class=\"language-typescript\">import { defineConfig } from 'vitest/config';\nimport PluginVue from '@vitejs/plugin-vue';\nimport PluginJsx from '@vitejs/plugin-vue-jsx';\nexport default defineConfig({\n  // é…ç½®æ’ä»¶ï¼Œç”¨æ¥åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ç¼–è¯‘Vue.jsçš„æ¨¡æ¿è¯­æ³•å’ŒJSXè¯­æ³•\n  plugins: [PluginVue(), PluginJsx()],\n  // é…ç½®æµ‹è¯•ç¯å¢ƒï¼Œæ”¯æŒå…¨å±€å˜é‡å’Œæµè§ˆå™¨DOM API\n  test: {\n    globals: true,\n    environment: 'jsdom'\n  }\n});\n</code></pre><p>ç„¶ååœ¨æ ¹ç›®å½•çš„ <code>./package.json</code> æ·»åŠ æµ‹è¯•è„šæœ¬ï¼š</p><pre><code class=\"language-javascript\">{\n  // ...\n  \"scripts\": {\n    // ...\n    \"test\": \"vitest\",\n    \"test:update\": \"vitest --update\",\n  }\n  // ...\n}\n</code></pre><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹æ¥å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼Œä¾‹å¦‚æ–°å»ºæ–‡ä»¶ <code>./packages/components/__tests__/demo.test.ts</code>ï¼Œå°è¯•ä¸€ä¸‹å•å…ƒæµ‹è¯•:ï¼š</p><pre><code class=\"language-typescript\">import { describe, test, expect } from 'vitest';\n\ndescribe('Demo', () =&gt; {\n  test('Test case', () =&gt; {\n    const a = 1;\n    const b = 2;\n    expect(a + b).toBe(3);\n  });\n});\n</code></pre><p>æ‰§è¡Œæµ‹è¯•å‘½ä»¤ <code>npm run test</code>ï¼Œvitestä¼šè‡ªåŠ¨è¯†åˆ«å½“å‰é¡¹ç›®ä¸­æ‰€æœ‰ *.test.ts çš„æµ‹è¯•æ–‡ä»¶è¿›è¡Œæ‰§è¡Œæµ‹è¯•ï¼Œç»Ÿè®¡æµ‹è¯•ç»“æœæœ€ååé¦ˆå‡ºæ¥ï¼Œå…·ä½“æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/5e/f3bc0f3811aff75139yycd026e7b945e.png?wh=1544x988\" alt=\"å›¾ç‰‡\"></p><p>Vitesté¡¹ç›®çš„å•å…ƒæµ‹è¯•åŸºç¡€é…ç½®å°±å¼„å¥½äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦è¿›å…¥ä»Šå¤©çš„é‡ç‚¹ï¼Œä¹Ÿæ˜¯éš¾ç‚¹ï¼ŒVue.jsç»„ä»¶çš„åœºæ™¯ã€‚</p><p>Vue.jsç»„ä»¶çš„åœºæ™¯ï¼Œæ¯”å‰é¢ä¸¾ä¾‹çš„â€œæ•°å­¦åŠ å‡ä¹˜é™¤â€çš„åŠŸèƒ½æ›´åŠ å¤æ‚ï¼Œå¤šäº†DOMæ¸²æŸ“ã€DOMäº‹ä»¶æ“ä½œã€è¯·æ±‚å¤„ç†ç­‰æµè§ˆå™¨é‡Œç‹¬æœ‰çš„ç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§ä¸æ˜¯ä¸€ä¸ªç®€å•çš„â€œè¾“å…¥å¾…æµ‹è¯•ä»£ç â€å’Œâ€œæ–­è¨€è¾“å‡ºç»“æœâ€çš„æ“ä½œå°±èƒ½æ»¡è¶³çš„ï¼Œé‚£ä¹ˆè¿™äº›ç‰¹æ€§éš¾ç‚¹è¦æ€ä¹ˆè¿›è¡Œå•å…ƒæµ‹è¯•å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆå¯¹è¿™äº›â€œæµ‹è¯•éš¾ç‚¹â€åˆ†ç±»ï¼Œåˆ†æˆä¸åŒæµ‹è¯•åœºæ™¯ç±»å‹ï¼Œç„¶åæ‰¾åˆ°æ¯ä¸ªåœºæ™¯ç±»å‹ä¸­çš„ä¸€ä¸ªå…¸å‹æ¡ˆä¾‹ï¼Œä¸¾ä¸€åä¸‰å°±èƒ½è¦†ç›–ç»å¤§éƒ¨åˆ†çš„â€œæµ‹è¯•éš¾ç‚¹â€äº†ã€‚è¿™é‡Œï¼Œæˆ‘åˆ’åˆ†æˆå››ç§æµ‹è¯•åœºæ™¯ç±»å‹ï¼š</p><ul>\n<li>æ¸²æŸ“æµ‹è¯•åœºæ™¯ï¼›</li>\n<li>è¡Œä¸ºæµ‹è¯•åœºæ™¯ï¼›</li>\n<li>è¯·æ±‚æµ‹è¯•åœºæ™¯ï¼›</li>\n<li>å…œåº•æµ‹è¯•åœºæ™¯ã€‚</li>\n</ul><p>æˆ‘ä»¬é€ä¸€çœ‹çœ‹ã€‚</p><h3>1. æ¸²æŸ“æµ‹è¯•åœºæ™¯</h3><p>æ¸²æŸ“æµ‹è¯•åœºæ™¯ï¼Œä¸»è¦æ˜¯éªŒè¯Vue.jsç»„ä»¶æ¸²æŸ“åçš„DOMç»“æ„æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œä¹Ÿå°±æ˜¯ç»„ä»¶åœ¨æ¸²æŸ“åçš„HTMLç»“æ„æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œä¸€èˆ¬ä¼šç›´æ¥ç”¨â€œå¿«ç…§æ¯”å¯¹â€çš„æ–¹å¼è¿›è¡Œæ–­è¨€ã€‚</p><p>æ¸²æŸ“åœºæ™¯å•å…ƒæµ‹è¯•çš„â€œè¾“å…¥â€æ˜¯ç»„ä»¶ï¼Œè¾“å‡ºæ˜¯â€œå¿«ç…§â€ï¼Œå…·ä½“æµ‹è¯•æ“ä½œå°±æ˜¯æ–­è¨€â€œå¿«ç…§â€æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸ªç¬¦åˆé¢„æœŸçš„â€œæ­£ç¡®å¿«ç…§â€è¿›è¡Œå¯¹æ¯”ã€‚ä¸€èˆ¬è¿™ä¸ªâ€œæ­£ç¡®å¿«ç…§â€æ˜¯é¦–æ¬¡æµ‹è¯•æ—¶å€™å°±ç”Ÿæˆçš„ï¼Œä¿®æ”¹ä»£ç åï¼Œå†æ¬¡æ‰§è¡Œå•å…ƒæµ‹è¯•ä¼šè·Ÿè¿™ä¸ªâ€œæ­£ç¡®å¿«ç…§â€è¿›è¡Œå¯¹æ¯”ï¼Œè€Œä¸”è¿™ä¸ªâ€œæ­£ç¡®å¿«ç…§â€é¦–æ¬¡ç”Ÿæˆåæ˜¯ä¸ä¼šè‡ªåŠ¨æ›´æ–°çš„ï¼Œå¦‚æœæœ‰éœ€è¦å¿…é¡»è‡ªå·±æ‰‹åŠ¨å¼ºè¡Œæ›´æ–°ã€‚</p><p>æˆ‘æ‹¿å‰å‡ èŠ‚è¯¾çš„åŸºç¡€ç»„ä»¶åº“çš„Boxç»„ä»¶æ¥åšä¸€æ¬¡å¿«ç…§æµ‹è¯•ï¼Œå…·ä½“å•å…ƒæµ‹è¯•å°±åœ¨æ–‡ä»¶ <code>./packages/components/__tests__/box/snapshot1.test.ts</code> é‡Œï¼Œå…·ä½“æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-typescript\">import { describe, test, expect } from 'vitest';\nimport { mount } from '@vue/test-utils';\nimport BoxTest from './index.test.vue';\n\ndescribe('Box', () =&gt; {\n  test('snapshot', () =&gt; {\n    const wrapper = mount(BoxTest);\n    expect(wrapper).toMatchSnapshot();\n  });\n});\n\n</code></pre><p>æµ‹è¯•æ‰€ç”¨çš„è¾“å…¥æ¡ˆä¾‹ä»£ç åœ¨æ–‡ä»¶ <code>./packages/components/__tests__/box/index.test.vue</code> é‡Œï¼š</p><pre><code class=\"language-xml\">&lt;template&gt;\n  &lt;Box&gt;\n    &lt;div class=\"hello\"&gt;Hello World&lt;/div&gt;\n  &lt;/Box&gt;\n&lt;/template&gt;\n\n&lt;script setup lang=\"ts\"&gt;\nimport { Box } from '../../src';\n&lt;/script&gt;\n\n</code></pre><p>æ‰§è¡Œå•å…ƒæµ‹è¯•åå°±ä¼šè‡ªåŠ¨ç”Ÿæˆå¿«ç…§æ–‡ä»¶ï¼Œä¼šè·Ÿå•å…ƒæµ‹è¯•æ–‡ä»¶åç§°åŒåï¼Œè‡ªåŠ¨ç”Ÿæˆåœ¨ç›®å½• <code>./packages/components/__tests__/box/__snapshots__</code> é‡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/01/d5/01e870e3dbb8ee22b5c2b275d0c920d5.png?wh=1920x1031\" alt=\"å›¾ç‰‡\"></p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å†ä¿®æ”¹Boxé‡Œä¸ªåˆ«DOMçš„classNameï¼Œæ‰§è¡Œé»˜è®¤å•å…ƒæµ‹è¯•æ“ä½œæ—¶å°±ä¼šæŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”Ÿæˆçš„å¿«ç…§ä¸é¦–æ¬¡çš„å¿«ç…§ä¸ä¸€æ ·å°±ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/9d/61/9dc839d9dfce1d5474c836fa51b56561.png?wh=1874x1238\" alt=\"å›¾ç‰‡\"></p><p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœä½ è®¤ä¸ºDOMå†…å®¹å˜æ›´æ˜¯å¿…é¡»çš„ï¼Œé‚£æ„å‘³ç€ï¼ŒæœŸå¾…ç»“æœçš„æ­£ç¡®å¿«ç…§ä¹Ÿè¦è¢«æ›´æ–°ï¼Œé‚£ä½ å°±å¯ä»¥æ‰§è¡Œè¿™ä¸ªVitestå‘½ä»¤ <code>vitest --update</code>ï¼Œåœ¨è¿™èŠ‚è¯¾çš„é¡¹ç›®ä¸­ï¼Œæˆ‘æŠŠå®ƒå°è£…æˆäº†è„šæœ¬å‘½ä»¤ <code>npm run test:update</code>ï¼Œæ‰§è¡Œä¸€ä¸‹å°±å¯ä»¥æ›´æ–°å¿«ç…§ã€‚</p><p>çœ‹åˆ°è¿™å„¿ï¼Œä½ å¯èƒ½ä¼šé—®ï¼š<strong>æ€»æ˜¯è¿™ä¹ˆç”Ÿæˆå¿«ç…§ã€å¯¹æ¯”å¿«ç…§ï¼Œæœ‰éœ€è¦å°±è¦æ›´æ–°å¿«ç…§ï¼Œè¿™ä¸ªæ“ä½œæœ‰ç‚¹ç¹çï¼Œè¿˜æœ‰å…¶ä»–çš„æ¸²æŸ“æµ‹è¯•æ–¹æ³•å—ï¼Ÿ</strong></p><p>ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚è¿™ä¸ªæµ‹è¯•çš„â€œè¾“å…¥â€æ˜¯ç»„ä»¶ï¼Œâ€œè¾“å‡ºâ€æ˜¯å¿«ç…§ï¼Œâ€œæ–­è¨€â€æ˜¯å¿«ç…§ï¼Œæ‰€ä»¥åªè¦ä»â€œè¾“å…¥â€ã€â€œè¾“å‡ºâ€å’Œâ€œæ–­è¨€â€è¿™ä¸‰ä¸ªå› ç´ å…¥æ‰‹è°ƒæ•´å°±è¡Œäº†ã€‚æ¸²æŸ“æµ‹è¯•ï¼Œå°±æ˜¯è¦çœ‹DOMæˆ–è€…HTMLç»“æ„æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€äº›é‡è¦çš„DOMæˆ–HTMLæ ‡ç­¾ï¼Œä½œä¸ºæ–­è¨€æ ‡å‡†ã€‚</p><p>å›åˆ°è¿™ä¸ªBoxç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©classNameä½œä¸ºé‡è¦æŒ‡æ ‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå•å…ƒæµ‹è¯•çš„å› ç´ å°±å˜æˆäº†ï¼šâ€œè¾“å…¥â€æ˜¯ç»„ä»¶ï¼Œâ€œè¾“å‡ºâ€æ˜¯DOMç»“æ„ï¼Œâ€œæ–­è¨€â€æ˜¯åˆ¤æ–­classNameçš„DOMæ˜¯å¦å­˜åœ¨ã€‚æˆ‘å°†å®ƒå†™åœ¨äº†è¿™èŠ‚è¯¾ä»£ç æ¡ˆä¾‹çš„ <code>./packages/components/__tests__/box/render.test.ts</code> æ–‡ä»¶é‡Œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-typescript\">import { describe, test, expect } from 'vitest';\nimport { mount } from '@vue/test-utils';\nimport BoxTest from './index.test.vue';\n\ndescribe('Box', () =&gt; {\n  test('className', () =&gt; {\n    const wrapper = mount(BoxTest);\n    const boxDOM = wrapper.find('.my-vue-box');\n    // åˆ¤æ–­classNameä¸ºmy-vue-boxçš„DOMæ˜¯å¦å­˜åœ¨\n    expect(boxDOM).toBeTruthy();\n    \n    const slotDOM = boxDOM.find('.hello');\n    // åˆ¤æ–­classNameä¸ºmy-vue-boxçš„DOMå†…éƒ¨å­èŠ‚ç‚¹DOMæ˜¯å¦å­˜åœ¨\n    expect(slotDOM).toBeTruthy();\n    expect(slotDOM.text()).toBe('Hello World');\n  });\n});\n</code></pre><p>é€šè¿‡è°ƒæ•´åï¼Œä¸éœ€è¦é¢‘ç¹ç”Ÿæˆå¿«ç…§å’Œå¯¹æ¯”å¿«ç…§äº†ã€‚</p><h3>2. è¡Œä¸ºæµ‹è¯•åœºæ™¯</h3><p>è¡Œä¸ºæµ‹è¯•åœºæ™¯ï¼Œä¸»è¦æ˜¯éªŒè¯Vue.jsç»„ä»¶æ¸²æŸ“åï¼Œåœ¨ç”¨æˆ·è¡Œä¸ºæ“ä½œDOMåè§¦å‘çš„DOMç»“æ„çš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·ç‚¹å‡»äº†ç»„ä»¶çš„æŒ‰é’®ï¼Œè§¦å‘äº†ç»„ä»¶å†…éƒ¨å…¶ä»–æ¸²æŸ“å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™â€œè¾“å…¥â€æ˜¯ç»„ä»¶å’Œè¡Œä¸ºæ“ä½œï¼Œâ€œè¾“å‡ºâ€æ˜¯å˜åŒ–åçš„DOMç»“æ„ï¼Œâ€œæ–­è¨€â€æ˜¯åˆ¤æ–­å˜åŒ–åçš„DOMç»“æ„å¿«ç…§æˆ–è€…DOMå˜åŒ–æŒ‡æ ‡ã€‚</p><p>æˆ‘ä»¬å°±æ€ä¹ˆç®€å•æ€ä¹ˆæ¥ï¼ŒæŒ‰ç…§DOMå˜åŒ–çš„æŒ‡æ ‡æ¥åšæ–­è¨€æµ‹è¯•ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ButtonæŒ‰é’®çš„ç‚¹å‡»è¡Œä¸ºæ“ä½œæ˜¯å¦æ­£å¸¸ï¼Œéœ€è¦å†™ä¸€ä¸ªæŒ‰é’®çš„è®¡æ•°å™¨æ¥ä½œä¸ºå•å…ƒæµ‹è¯•éªŒè¯ï¼Œå¾…è¾“å…¥çš„æµ‹è¯•ä»£ç ï¼ˆåœ¨æ¡ˆä¾‹ <code>./packages/components/__tests__/button/index.test.vue</code> æ–‡ä»¶ä¸­ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-xml\">&lt;template&gt;\n  &lt;div class=\"display-text\"&gt;å½“å‰æ•°å€¼={{ num }}&lt;/div&gt;\n  &lt;Button class=\"btn-add\" @click=\"onClick\"&gt;ç‚¹å‡»åŠ 1&lt;/Button&gt;\n&lt;/template&gt;\n\n&lt;script setup lang=\"ts\"&gt;\nimport { ref } from 'vue';\nimport { Button } from '../../src';\nconst props = defineProps&lt;{ num: number }&gt;();\nconst num = ref&lt;number&gt;(props.num);\nconst onClick = () =&gt; {\n  num.value++;\n};\n&lt;/script&gt;\n\n</code></pre><p>å…·ä½“å•å…ƒæµ‹è¯•ä»£ç ï¼ˆåœ¨æ¡ˆä¾‹ <code>./packages/components/__tests__/button/index.test.ts</code> æ–‡ä»¶ä¸­ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-typescript\">import { describe, test, expect } from 'vitest';\nimport { nextTick } from 'vue';\nimport { mount } from '@vue/test-utils';\nimport ButtonTest from './index.test.vue';\n\ndescribe('Button', () =&gt; {\n  test('click event', async () =&gt; {\n    // æ¨¡æ‹Ÿæµè§ˆå™¨æ¸²æŸ“ç»„ä»¶\n    const wrapper = mount(ButtonTest, { props: { num: 123 } });\n    // æ‰¾åˆ°æ•°å­—æ–‡æ¡ˆDOMèŠ‚ç‚¹\n    const textDOM = wrapper.find('.display-text');\n    // æ‰¾åˆ°æŒ‰é’®DOMèŠ‚ç‚¹\n    const btnDOM = wrapper.find('.btn-add');\n    // æ–­è¨€éªŒè¯ç‚¹å‡»å‰çš„æ–‡æ¡ˆ\n    expect(textDOM.text()).toBe('å½“å‰æ•°å€¼=123');\n    // è§¦å‘æŒ‰é’®ç‚¹å‡»\n    btnDOM.trigger('click');\n    // ç­‰å¾…DOMå˜åŒ–ç»“æŸ\n    await nextTick();\n    // æ–­è¨€éªŒè¯ç»“æœ(ç‚¹å‡»åçš„æ–‡æ¡ˆ)\n    expect(textDOM.text()).toBe('å½“å‰æ•°å€¼=124');\n  });\n});\n\n</code></pre><p>ä»£ç é‡Œï¼Œæˆ‘ç”¨å‰å‡ èŠ‚è¯¾é‡Œçš„Buttonç»„ä»¶å’ŒInputç»„ä»¶ï¼Œå†™äº†ä¸€ä¸ªè®¡æ•°å™¨é«˜é˜¶ç»„ä»¶ï¼Œæ¥å®ç°ç‚¹å‡»è®¡æ•°æ•ˆæœï¼ŒéªŒè¯ç”¨æˆ·æ“ä½œButtonå’ŒInputç»„ä»¶æ˜¯å¦æ­£å¸¸ã€‚ç”¨@vue/test-utilsæ¥æ¸²æŸ“ç»„ä»¶å’Œè§¦å‘ç»„ä»¶é‡Œçš„æ“ä½œäº‹ä»¶ï¼Œå°±æ˜¯å¸¸è§çš„æ¨¡æ‹Ÿç”¨æˆ·è¡Œä¸ºçš„å•å…ƒæµ‹è¯•ã€‚</p><h3>3. è¯·æ±‚æµ‹è¯•åœºæ™¯</h3><p>è¯·æ±‚æµ‹è¯•åœºæ™¯ï¼Œæ¯”è¾ƒç‰¹æ®Šï¼Œä¸»è¦é€‚ç”¨äºç»„ä»¶å†…éƒ¨æœ‰æ¶‰åŠè¯·æ±‚æ•°æ®ï¼Œä¾‹å¦‚å›¾ç‰‡è¯·æ±‚çš„æƒ…å†µã€‚é‚£ä¹ˆåœ¨å•å…ƒæµ‹è¯•çš„æµç¨‹é‡Œï¼Œâ€œè¾“å…¥â€å°±æ˜¯ç»„ä»¶å’Œæ•°æ®è¯·æ±‚ï¼Œâ€œè¾“å‡ºâ€å°±æ˜¯æ•°æ®è¯·æ±‚ç»“æœï¼Œâ€œæ–­è¨€â€å°±æ˜¯åˆ¤æ–­è¯·æ±‚ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒNode.jsç¯å¢ƒé‡Œæ¨¡æ‹Ÿæµè§ˆå™¨æ“ä½œï¼Œè¯·æ±‚è¡Œä¸ºæ˜¯æ— æ³•æ¨¡æ‹Ÿçš„ï¼Œæ‰€ä»¥è¿™æ—¶å€™å°±<strong>éœ€è¦æˆ‘ä»¬äººå·¥æ¥æ¨¡æ‹Ÿè¯·æ±‚æ“ä½œ</strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘è¿™é‡Œå¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶Imageï¼Œè¦å†™ä¸ªå›¾ç‰‡ç»„ä»¶çš„è¯·æ±‚å›¾ç‰‡æˆåŠŸå’Œå¤±è´¥çš„å•å…ƒæµ‹è¯•ï¼š</p><pre><code class=\"language-javascript\">import { describe, test, expect } from 'vitest';\nimport { mount, flushPromises } from '@vue/test-utils';\nimport { Image } from '../../src';\n\n// æ¨¡æ‹Ÿé‡å†™ imgæ ‡ç­¾ï¼Œè‡ªåŠ¨è§¦å‘å›¾ç‰‡è¯·æ±‚æ“ä½œ\nwindow.document.createElement = (function (create) {\n  return function () {\n    // @ts-ignore\n    const element: HTMLElement = create.apply(this, arguments);\n    if (element.tagName === 'IMG') {\n      // å›¾ç‰‡å…ƒç´ æ¸²æŸ“åï¼Œæ¨¡æ‹Ÿè‡ªåŠ¨è§¦å‘å›¾ç‰‡è¯·æ±‚çš„å»¶æ—¶è¯·æ±‚æ“ä½œ\n      setTimeout(() =&gt; {\n        const src = element.getAttribute('src');\n        if (src?.includes('error.jpg')) {\n          // å¦‚æœå›¾ç‰‡é“¾æ¥æœ‰å¸¦error.jpgï¼Œå°±è§¦å‘è¯·æ±‚é”™è¯¯\n          element.dispatchEvent(new CustomEvent('error', { bubbles: true }));\n        } else {\n          // å…¶å®ƒé»˜è®¤è§¦å‘è¯·æ±‚æˆåŠŸ\n          element.dispatchEvent(new CustomEvent('load', { bubbles: true }));\n        }\n      }, 100);\n    }\n    return element;\n  };\n})(window.document.createElement);\n\ndescribe('Image', () =&gt; {\n  test('load', async () =&gt; {\n    let resolve: Function;\n    let reject: Function;\n    new Promise((res, rej) =&gt; ((resolve = res), (reject = rej)));\n    // æ¸²æŸ“éªŒè¯å›¾ç‰‡è¯·æ±‚æˆåŠŸ\n    mount(Image, {\n      props: {\n        src: './xxx/xxxx.jpg'\n      },\n      emits: {\n        load: (e: Event) =&gt; {\n          expect(e).toBeTruthy();\n          resolve?.();\n        },\n        error: () =&gt; {\n          reject?.();\n        }\n      }\n    });\n    await flushPromises();\n  });\n\n  test('error', async () =&gt; {\n    let resolve: Function;\n    let reject: Function;\n    new Promise((res, rej) =&gt; ((resolve = res), (reject = rej)));\n    // æ¸²æŸ“éªŒè¯å›¾ç‰‡è¯·æ±‚å¤±è´¥\n    mount(Image, {\n      props: {\n        src: './xxx/error.jpg'\n      },\n      emits: {\n        load: () =&gt; {\n          reject?.();\n        },\n        error: (e: Event) =&gt; {\n          expect(e).toBeTruthy();\n          resolve?.();\n        }\n      }\n    });\n    await flushPromises();\n  });\n});\n\n</code></pre><p>ä¸Šè¿°æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘æ˜¯é‡å†™æ¨¡æ‹Ÿäº†Imageçš„è™šæ‹ŸèŠ‚ç‚¹åˆ›å»ºæ“ä½œï¼Œæ¨¡æ‹Ÿè§¦å‘äº†å›¾ç‰‡æˆåŠŸè¯·æ±‚ä»¥åŠè¯·æ±‚å¤±è´¥çš„æ“ä½œã€‚</p><p>å®é™…å¼€å‘ä¸­ï¼ŒAjaxè¯·æ±‚ä¹Ÿå¯ä»¥åšç±»ä¼¼çš„æ¨¡æ‹Ÿï¼Œä¸»è¦æ˜¯æ¨¡æ‹Ÿé‡å†™HttpRequestXMLè¿™ä¸ªå…¨å±€å¯¹è±¡ï¼Œä¸€èˆ¬æœ‰ç°æˆçš„npmæ¨¡å—ï¼Œä¾‹å¦‚xhr-mockã€‚</p><h3>4. å…œåº•æµ‹è¯•åœºæ™¯</h3><p>å…œåº•æµ‹è¯•åœºæ™¯ï¼Œå°±æ˜¯è¦åšå‰é¢ä¸‰ä¸ªåœºæ™¯éƒ½æ— æ³•è¦†ç›–å…¨é¢çš„æ´»ï¼Œåˆ©ç”¨Vitestçš„æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼Œç”¨Vue.jsä¼ ç»Ÿæ¸²æŸ“æ–¹å¼ä½œä¸ºâ€œè¾“å…¥â€ï¼Œâ€œè¾“å‡ºâ€æ˜¯ä¸€å¼ åœ¨Node.jsç¯å¢ƒé‡Œæ¨¡æ‹Ÿæµè§ˆå™¨é‡Œçš„é¡µé¢ï¼Œâ€œæ–­è¨€â€å°±æ˜¯åˆ¤æ–­åœ¨è¿™ä¸ªâ€œæ¨¡æ‹Ÿé¡µé¢â€ä¸Šæ˜¯å¦å­˜åœ¨æˆ‘ä»¬æƒ³è¦çš„ç»“æœæŒ‡æ ‡ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬è¦æµ‹è¯•æŸä¸ªDOMæ˜¯å¦å­˜åœ¨ï¼Œå°±å¯ä»¥è¿™ä¹ˆå®ç°ä»£ç ï¼š</p><pre><code class=\"language-typescript\">import { describe, test, expect } from 'vitest';\nimport { createApp, nextTick } from 'vue';\nimport AppTest from './app.test.vue';\n\ndescribe('Button', () =&gt; {\n  test('click event', async () =&gt; {\n    // ç”¨jsdomæ¨¡æ‹Ÿçš„æµè§ˆå™¨APIæ¸²æŸ“ä¸€ä¸ªæ ¹èŠ‚ç‚¹DOM div\n    const div = document.createElement('div');\n    // å°†divè¿½åŠ åˆ°é¡µé¢bodyä¸Š\n    document.body.appendChild(div);\n    // ç”¨å¸¸è§„æµè§ˆå™¨é‡ŒVue.jsåˆ›å»ºåº”ç”¨çš„æ–¹å¼åˆ›å»ºåº”ç”¨\n    const app = createApp(AppTest);\n    // ç”¨å¸¸è§„æµè§ˆå™¨é‡ŒVue.jsæŒ‚è½½åº”ç”¨çš„æ–¹å¼æŒ‚è½½ç»„ä»¶\n    app.mount(div);\n    // ç”¨jsdomæ¨¡æ‹Ÿçš„æµè§ˆå™¨API æŸ¥æ‰¾éœ€è¦æ–­è¨€çš„DOM\n    const textDOM = div.querySelector('.display-text');\n    // ç”¨jsdomæ¨¡æ‹Ÿçš„æµè§ˆå™¨API æŸ¥æ‰¾éœ€è¦æ–­è¨€çš„DOM\n    const btnDOM = div.querySelector('.btn-add');\n    expect(textDOM?.textContent).toBe('å½“å‰æ•°å€¼=123');\n    btnDOM?.dispatchEvent(new CustomEvent('click', { bubbles: true }));\n    await nextTick();\n    expect(textDOM?.textContent).toBe('å½“å‰æ•°å€¼=124');\n  });\n});\n\n</code></pre><p>ä»£ç ç›´æ¥åˆ©ç”¨æµè§ˆå™¨çš„APIï¼Œåœ¨Node.jså•å…ƒæµ‹è¯•ç¯å¢ƒä¸­ç›´æ¥è°ƒç”¨ï¼ŒéªŒè¯æ¸²æŸ“åDOMæ˜¯å¦å­˜åœ¨ã€‚</p><p>è¿™å››ä¸ªæµ‹è¯•åœºæ™¯ç±»å‹ï¼Œå·²ç»èƒ½è¦†ç›–ç»å¯¹å¤§å¤šæ•°çš„ç»„ä»¶åœºæ™¯äº†ã€‚åŸºäºå•å…ƒæµ‹è¯•ï¼Œæ¯æ¬¡ä¿®æ”¹ä»£ç åï¼Œæˆ‘ä»¬éƒ½èƒ½ç”¨è‡ªåŠ¨å•å…ƒæµ‹è¯•ï¼Œè‡ªåŠ¨éªŒè¯æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œä¸å†éœ€è¦äººå·¥å½¢å¼æ¥æµ‹è¯•éªŒè¯ï¼Œæå¤§åœ°è§£æ”¾å¼€å‘è€…çš„ç”Ÿäº§åŠ›ã€‚</p><p>ä½†ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œ<strong>ä½œä¸ºä¸€ä¸ªä¿æŠ¤ä»£ç åŠŸèƒ½è´¨é‡çš„å±éšœï¼Œæˆ‘ä»¬èƒ½ç”¨ä»€ä¹ˆæ¥è¡¡é‡å•å…ƒæµ‹è¯•çš„è´¨é‡å‘¢ï¼Ÿ</strong>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬èƒ½ç”¨ä»€ä¹ˆæŒ‡æ ‡æ¥è¡¡é‡å•å…ƒæµ‹è¯•çš„æµ‹è¯•æ•ˆæœå‘¢ï¼Ÿè¿™ä¸ªæŒ‡æ ‡å°±æ˜¯å•å…ƒæµ‹è¯•çš„â€œè¦†ç›–ç‡â€ã€‚</p><h2>å•å…ƒæµ‹è¯•è¦†ç›–ç‡</h2><p>å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ŒæŒ‡çš„æ˜¯åœ¨è¢«æµ‹è¯•çš„ä»£ç ä¸­ï¼Œè¢«æ‰§è¡Œçš„ä»£ç å æ‰€æœ‰ä»£ç çš„æ¯”ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡æ ‡ï¼Œæ‰¾å‡ºå“ªäº›ä»£ç è¿˜æ²¡è¢«æµ‹è¯•è¦†ç›–åˆ°ï¼Œé¿å…å‡ºç°åŠŸèƒ½é€»è¾‘åˆ†æ”¯è¢«é—æ¼çš„é—®é¢˜ã€‚</p><p>æµ‹è¯•è¦†ç›–ç‡ä¸€èˆ¬æœ‰å››ä¸ªæŒ‡æ ‡ï¼š</p><ul>\n<li>çŠ¶æ€è¦†ç›–ç‡ï¼›</li>\n<li>ä»£ç è¡Œæ•°è¦†ç›–ç‡ï¼›</li>\n<li>é€»è¾‘åˆ†æ”¯è¦†ç›–ç‡ï¼›</li>\n<li>æ–¹æ³•è¦†ç›–ç‡ã€‚</li>\n</ul><p>Vitesté…ç½®è¦†ç›–ç‡çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªè¦åšä»¥ä¸‹ä¸‰ä¸ªé…ç½®æ­¥éª¤å°±å¯ä»¥äº†ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå®‰è£…è¦†ç›–ç‡çš„ç»Ÿè®¡npmæ¨¡å—ï¼Œ@vitest/coverage-c8 ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹é…ç½®vitest.config.jsï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class=\"language-typescript\">import { defineConfig } from 'vitest/config';\nimport PluginVue from '@vitejs/plugin-vue';\nimport PluginJsx from '@vitejs/plugin-vue-jsx';\nexport default defineConfig({\n  plugins: [PluginVue(), PluginJsx()],\n  test: {\n    globals: true,\n    environment: 'jsdom',\n    coverage: {\n      // è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·\n      provider: 'c8',\n      // è¦†ç›–ç‡çš„åˆ†æ¯ï¼Œpackages/ ç›®å½•é‡Œ\n      // æ‰€æœ‰srcçš„æºæ–‡ä»¶ä½œä¸ºè¦†ç›–ç‡ç»Ÿè®¡çš„åˆ†æ¯\n      include: ['packages/*/src/**/*'],\n      // å…¨é‡è¦†ç›–ç‡è®¡ç®—\n      all: true\n    }\n  }\n});\n</code></pre><p>ç¬¬ä¸‰æ­¥ï¼Œé…ç½®package.jsonå•å…ƒæµ‹è¯•æ‰§è¡Œè„šæœ¬ã€‚åœ¨æ ¹ç›®å½•çš„ ./package.json æ·»åŠ æµ‹è¯•è¦†ç›–ç‡è„šæœ¬ï¼š</p><pre><code class=\"language-javascript\">{\n  // ...\n  \"scripts\": {\n    // ...\n    \"coverage\": \"vitest run --coverage\"\n  }\n  // ...\n}\n</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯æ‰§è¡Œå•å…ƒæµ‹è¯•æ“ä½œï¼Œæ‰§è¡Œå‘½ä»¤ <code>npm run coverage</code> åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¦†ç›–ç‡ç»Ÿè®¡æŠ¥å‘Šã€‚å…·ä½“ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b6/b3/b627f895d09ea684a7705908f8b9d3b3.png?wh=1920x920\" alt=\"å›¾ç‰‡\"></p><p>æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šåœ¨ coverage/ ç›®å½•é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æµè§ˆå™¨ç›´æ¥æ‰“å¼€ coverage/index.html é¡µã€‚ç”¨æµè§ˆå™¨è®¿é—®åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/f6/cac78c7235b9274dc62be55482022bf6.png?wh=1920x1056\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/ba/7b/ba37152d9795d69b3c520c364297bf7b.png?wh=1920x1158\" alt=\"å›¾ç‰‡\"></p><p>é€šè¿‡æµ‹è¯•æŠ¥å‘Šæˆªå›¾å’Œæç¤ºï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæµ‹è¯•è¦†ç›–ç‡æƒ…å†µï¼Œæ‰¾åˆ°æ²¡è¢«è¦†ç›–åˆ°çš„ä»£ç ï¼Œè¡¥å……å¯¹åº”ä»£ç é€»è¾‘çš„å•å…ƒæµ‹è¯•ã€‚</p><p>å¥½ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å·²ç»ä»Vue.jsç»„ä»¶å•å…ƒæµ‹è¯•éªŒè¯åŠŸèƒ½ï¼Œå†åˆ°è¦†ç›–ç‡éªŒè¯æµ‹è¯•è´¨é‡ï¼Œèµ°äº†ä¸€éä¸€ä¸ªä¼ä¸šçº§Vue.jsç»„ä»¶åº“é¡¹ç›®ï¼Œæ‰€éœ€çš„å®Œæ•´å•å…ƒæµ‹è¯•æµç¨‹ã€‚</p><p>ä½†æ˜¯ï¼Œå•å…ƒæµ‹è¯•ï¼Œåªæ˜¯éªŒè¯ä»£ç â€œè¾“å…¥â€åçš„â€œè¾“å‡ºâ€æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œå®ƒçš„ä¸Šé™å°±æ˜¯éªŒè¯æ ¸å¿ƒåŠŸèƒ½é€»è¾‘ï¼Œæ‰€ä»¥è¯´ï¼Œ<strong>å•å…ƒæµ‹è¯•ä¹Ÿå­˜åœ¨ä¸€å®šçš„å±€é™æ€§ã€‚</strong></p><p>å‰ç«¯çš„å•å…ƒæµ‹è¯•ï¼Œåªèƒ½é€šè¿‡â€œæ•°æ®â€å½¢å¼æ¥ä¿è¯æµ‹è¯•ç»“æœå’Œæµ‹è¯•æ–­è¨€ï¼Œæ— æ³•éªŒè¯æœ€ç»ˆæ¸²æŸ“çš„è§†è§‰æ•ˆæœã€‚è€Œä¸”ï¼Œç›®å‰å¤§å¤šæ•°å‰ç«¯å•å…ƒæµ‹è¯•éƒ½æ˜¯åœ¨Node.jsç¯å¢ƒé‡Œè¿›è¡Œçš„ï¼Œè·Ÿå®é™…æµè§ˆå™¨è¿˜æ˜¯å­˜åœ¨å·®å¼‚ã€‚å¦‚æœè¦éªŒè¯æœ€ç»ˆè§†è§‰æ•ˆæœï¼Œæˆ‘ä»¬å°±è¦ç”¨åˆ°E2Eæµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯â€œEnd to Endâ€çš„ç«¯å¯¹ç«¯æµ‹è¯•ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ Cypress è¿™ä¸ªE2Eæµ‹è¯•å·¥å…·ã€‚</p><p>æ­¤å¤–ï¼Œå•å…ƒæµ‹è¯•è¿˜æœ‰å¦ä¸€ä¸ªå±€é™æ€§ï¼Œåœ¨é¢‘ç¹å˜æ›´åŠŸèƒ½çš„éœ€æ±‚åœºæ™¯ä¸‹ï¼Œæ¯æ¬¡å˜æ›´åŠŸèƒ½ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»é‡å†™æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™æ ·æ—¶é—´æˆæœ¬ä¼šå¤§å¤§å¢åŠ ã€‚æ‰€ä»¥ï¼Œå•å…ƒæµ‹è¯•ç­‰è¿™äº›æµ‹è¯•æ“ä½œï¼Œå¤§å¤šæ•°ç”¨äºæ¯”è¾ƒç¨³å®šçš„ä»£ç ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¸¾ä¾‹çš„ç»„ä»¶åº“ä»£ç ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸ªå±€é™æ€§ä¹Ÿä¸ä»…ä»…å±€é™äºå•å…ƒæµ‹è¯•ï¼ŒE2Eæµ‹è¯•ç­‰æµ‹è¯•æ“ä½œéƒ½æœ‰ã€‚</p><p>æ€»ä¹‹ï¼Œæµ‹è¯•ä¸æ˜¯ä¸‡èƒ½çš„ã€‚æˆ‘ä»¬ç›®æ ‡æ˜¯è¿½æ±‚ç¨³å®šå¥å£®çš„ä»£ç åŠŸèƒ½ï¼Œæµ‹è¯•åªæ˜¯è¾¾åˆ°ç›®çš„çš„ä¸€ä¸ªæ¯”è¾ƒé«˜æ•ˆçš„æ–¹å¼ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„æ–¹å¼ã€‚</p><h2>æ€»ç»“</h2><p>é€šè¿‡è¿™èŠ‚è¯¾å¯¹å‰ç«¯å•å…ƒæµ‹è¯•çš„åˆ†æï¼Œä»¥åŠåŸºäºVitestæ¥å®ç°Vue.js 3.xç»„ä»¶åº“çš„å•å…ƒæµ‹è¯•ï¼Œç›¸ä¿¡ä½ å·²ç»æ·±åˆ»ç†è§£äº†å‰ç«¯å•å…ƒæµ‹è¯•ã€‚</p><p>å‰ç«¯å•å…ƒæµ‹è¯•çš„æ ¸å¿ƒæµç¨‹ï¼Œå°±æ˜¯æœ‰â€œè¾“å…¥â€å’Œâ€œè¾“å‡ºâ€ï¼Œæœ€åâ€œæ–­è¨€â€æ¥éªŒè¯â€œè¾“å‡ºâ€æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚Vue.js 3.xç»„ä»¶å•å…ƒæµ‹è¯•åˆ†æçš„å››ç§åœºæ™¯ç±»å‹ï¼Œåˆ†åˆ«æœ‰ï¼š</p><ul>\n<li>æ¸²æŸ“æµ‹è¯•åœºæ™¯ï¼ŒéªŒè¯Vue.jsç»„ä»¶ä»£ç æœ€ç»ˆDOMæ˜¯å¦ç¬¦åˆé¢„æœŸï¼›</li>\n<li>è¡Œä¸ºæµ‹è¯•åœºæ™¯ï¼ŒéªŒè¯ç”¨æˆ·æ“ä½œVue.jsç»„ä»¶åæœ€ç»ˆå˜åŒ–æ˜¯å¦ç¬¦åˆé¢„æœŸï¼›</li>\n<li>è¯·æ±‚æµ‹è¯•åœºæ™¯ï¼Œç”¨æ¨¡æ‹Ÿæ“ä½œæ–¹å¼ï¼ŒéªŒè¯ç»„ä»¶é‡Œæ•°æ®è¯·æ±‚é€»è¾‘æ˜¯å¦ç¬¦åˆé¢„æœŸï¼›</li>\n<li>å…œåº•æµ‹è¯•åœºæ™¯ï¼Œç”¨ä¼ ç»ŸVue.jsæ¸²æŸ“æ–¹å¼ï¼Œé—´æ¥éªŒè¯ç»„ä»¶åŠŸèƒ½æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚</li>\n</ul><p>å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼Œå°±æ˜¯ç”¨è¦†ç›–ç‡ä½œä¸ºéªŒè¯å•å…ƒæµ‹è¯•æ•ˆæœçš„æŒ‡æ ‡ã€‚ç†è§£äº†å•å…ƒæµ‹è¯•çš„ä½œç”¨ï¼Œå¯¹æé«˜å¼€å‘è€…çš„å·¥ä½œæ•ˆç‡å¾ˆæœ‰å¸®åŠ©ï¼Œä½†ä¹Ÿè¦è®°å¾—ï¼Œå•å…ƒæµ‹è¯•ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå­˜åœ¨å±€é™æ€§ï¼Œä½ éœ€è¦æ ¹æ®å®é™…æƒ…å†µåšå‡ºé€‰æ‹©å’Œåˆ¤æ–­ã€‚</p><h2>æ€è€ƒ</h2><p>è¿™èŠ‚è¯¾éƒ½æ˜¯æ¨¡æ¿è¯­æ³•å†™çš„å•å…ƒæµ‹è¯•ï¼ŒVue.js 3.xçš„JSXè¯­æ³•å•å…ƒæµ‹è¯•è¦æ€ä¹ˆå†™å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ ç•™è¨€å‚ä¸è®¨è®ºï¼Œå¦‚æœæœ‰ç–‘é—®ä¹Ÿæ¬¢è¿è¯„è®ºï¼Œä¸‹ä¸€è®²è§ã€‚</p><h3><a href=\"https://github.com/FE-star/vue3-course/tree/main/chapter/14\">å®Œæ•´çš„ä»£ç åœ¨è¿™é‡Œ</a></h3>","comments":[{"had_liked":false,"id":365143,"user_name":"ä¸«å¤´","can_delete":false,"product_type":"c1","uid":1153387,"ip_address":"åŒ—äº¬","ucode":"435D2E19E291C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/6b/77bb8501.jpg","comment_is_top":false,"comment_ctime":1672191789,"is_pvip":false,"replies":[{"id":132966,"content":"ğŸ’ª å­¦ä¹ åŠ æ²¹ï½","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":2547771,"ctime":1672192880,"ip_address":"åŒ—äº¬","comment_id":365143,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100311101,"comment_content":"æ„Ÿè°¢è€å¸ˆå¸®æˆ‘æ‰«ç›²","like_count":1,"discussions":[{"author":{"id":2547771,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e0/3b/8ec916b2.jpg","nickname":"å¤šå°‘","note":"","ucode":"0A6EF7AA6E4BB7","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597714,"discussion_content":"ğŸ’ª å­¦ä¹ åŠ æ²¹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672192881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394164,"user_name":"ifelse","can_delete":false,"product_type":"c1","uid":2550743,"ip_address":"æµ™æ±Ÿ","ucode":"D0565908C99695","user_header":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","comment_is_top":false,"comment_ctime":1726033713,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":3,"score":2,"product_id":100311101,"comment_content":"å­¦ä¹ æ‰“å¡","like_count":0},{"had_liked":false,"id":386409,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"åŒ—äº¬","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1704785395,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100311101,"comment_content":"Error: &quot;coverage.provider: c8&quot; is not supported anymore. Use &quot;coverage.provider: v8&quot; instead\n\nè¦†ç›–ç‡çš„ npm å¼•æ“å·²ç»ä» c8 å‡çº§åˆ° v8 äº†ï¼Œæ˜¯æˆ‘æ¥çš„å¤ªæ™šäº†ä¹ˆ\n\nnpm i -D @vitest&#47;coverage-c8 ä¼šæŠ¥é”™\nnpm i -D @vitest&#47;coverage-v8 å°±é€šè¿‡äº† \n\nvitest.config.js ä¸­çš„é…ç½®å¦‚ä¸‹ï¼š\n\ncoverage: {\n      &#47;&#47; è¦†ç›–ç‡ç»Ÿè®¡å·¥å…·\n      provider: &#39;v8&#39;,","like_count":0},{"had_liked":false,"id":379035,"user_name":"lightwolf","can_delete":false,"product_type":"c1","uid":3229927,"ip_address":"ä¸­å›½å°æ¹¾","ucode":"9F4E0F742C174D","user_header":"https://static001.geekbang.org/account/avatar/00/31/48/e7/958b7e6c.jpg","comment_is_top":false,"comment_ctime":1691155548,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100311101,"comment_content":"ç¬¬ä¸‰æ®µä»£ç çš„æµ‹è¯•çš„logæ–‡æœ¬æœ‰ç‚¹é—®é¢˜, `myMath.add å‡æ³•æµ‹è¯•æˆåŠŸ`ï¼Œ==&gt;  `myMath.subtract å‡æ³•æµ‹è¯•æˆåŠŸ`","like_count":0}]}