{"id":269707,"title":"34 | 完成文章分类测试用例：解决测试用例依赖问题","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/Selenium\">https://gitee.com/geektime-geekbang/Selenium</a></p>","comments":[{"had_liked":false,"id":286496,"user_name":"测试菜鸟","can_delete":false,"product_type":"c3","uid":1716156,"ip_address":"","ucode":"610650BDE3548C","user_header":"https://static001.geekbang.org/account/avatar/00/1a/2f/bc/71e5dbbc.jpg","comment_is_top":false,"comment_ctime":1617346839,"is_pvip":false,"replies":[{"id":104417,"content":"也可以","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1618018169,"ip_address":"","comment_id":286496,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"我感觉，如果说先测异常再测正常的话，刷新下浏览器就好，不用去清空输入栏","like_count":2,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518011,"discussion_content":"也可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618018169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336301,"user_name":"李海浪","can_delete":false,"product_type":"c3","uid":2828172,"ip_address":"","ucode":"EA7472CACA9E7B","user_header":"","comment_is_top":false,"comment_ctime":1646058598,"is_pvip":false,"replies":[{"id":125485,"content":"可以使用js","user_name":"作者回复","user_name_real":"编辑","uid":1654315,"ctime":1651036658,"ip_address":"","comment_id":336301,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师，现在文章分类里面的必填项变成了&lt;span id=&quot;category.title-error&quot; class=&quot;error invalid-feedback&quot;&gt;这是必填内容&lt;&#47;span&gt;，一个标签显示，这样要怎么把‘这是必填内容给取出来’，试了很多方法都不行","like_count":1,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567989,"discussion_content":"可以使用js","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651036658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2233644,"avatar":"https://static001.geekbang.org/account/avatar/00/22/15/2c/562d55ad.jpg","nickname":"Jone  XH","note":"","ucode":"23C0354CD29C96","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557801,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647961665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263691,"user_name":"Geek_f55d8f","can_delete":false,"product_type":"c3","uid":2167723,"ip_address":"","ucode":"F898B165EAAACE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJzCZibunMDoo0m5c1jo4jeOj831jljvmsZbIqFIH8hiaCAAz35xbIk5ibpFMwjeObJdMnLYUCCOv9Og/132","comment_is_top":false,"comment_ctime":1606219330,"is_pvip":false,"replies":[{"id":97195,"content":"先保证元素可见","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1607853171,"ip_address":"","comment_id":263691,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师，不在当前屏幕的element，需要先scroll to吗","like_count":1,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510271,"discussion_content":"先保证元素可见","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607853171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":241286,"user_name":"Geek_jf52tq","can_delete":false,"product_type":"c3","uid":1350004,"ip_address":"","ucode":"69702DFB599C49","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/V5Q9iapkWRXblWVn7fpnA5l9nAKF023UPDnS7bib8Ylrt91epNicdeJFic0fDH8W4ickO4cdylNN50kYn9pWSDCgHEg/132","comment_is_top":false,"comment_ctime":1597237565,"is_pvip":false,"replies":[{"id":89152,"content":"依赖Login呀 要不拿不到driver","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1597274952,"ip_address":"","comment_id":241286,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"为什么case =TestCategory(login) 要传login的参数，不传参数，按照顺序执行不行吗？","like_count":1,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503698,"discussion_content":"依赖Login呀 要不拿不到driver","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597274952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301792,"user_name":"珂珂","can_delete":false,"product_type":"c3","uid":2676843,"ip_address":"","ucode":"AA851845FE139F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/82LP37IEa9KcSdIg81pHDUgbVPhibibqP2LvEd1I5IFNh4rHg202ZnKxkmQfZt0TO3INc4SqNwI0gC31revBo4OQ/132","comment_is_top":false,"comment_ctime":1625884815,"is_pvip":false,"replies":[{"id":109684,"content":"调用了 close 或者 quit方法了","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1626602833,"ip_address":"","comment_id":301792,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师，请教一下为什么我单独执行下用户登录他执行完后会自动关闭页面呢","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523088,"discussion_content":"调用了 close 或者 quit方法了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626602833,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2676843,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/82LP37IEa9KcSdIg81pHDUgbVPhibibqP2LvEd1I5IFNh4rHg202ZnKxkmQfZt0TO3INc4SqNwI0gC31revBo4OQ/132","nickname":"珂珂","note":"","ucode":"AA851845FE139F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386198,"discussion_content":"老师我解决了没有调用这2个方法，设定一个全局浏览器就行","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627465608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300467,"user_name":"Lanny","can_delete":false,"product_type":"c3","uid":2064369,"ip_address":"","ucode":"C44F18A582B5BA","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7f/f1/80d6d2e2.jpg","comment_is_top":false,"comment_ctime":1625186885,"is_pvip":false,"replies":[{"id":109681,"content":"按道理可以通过cookie实现登录的 但是这个项目我测试是失败的 项目做了限制","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1626602636,"ip_address":"","comment_id":300467,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师，请教一下。如果验证码这个第三方库现在用不了了，我直接跳过，使用登录后的页面地址可行吗？\nclass TestCategory(object):\n    # def __init__(self,login):\n    #     self.login = login\n    def __init__(self):\n        self.driver = webdriver.Chrome()\n        self.driver.get(&#39;http:&#47;&#47;localhost:8080&#47;jpress&#47;admin&#47;index&#39;)\n        self.driver.maximize_window()\n\n    # 测试文章分类失败，名称为空\n    def test_add_category_error(self):\n        name = &#39;&#39;\n        # 前置条件 后置条件\n        parent = &#39;python&#39;\n        slug = &#39;test&#39;\n        expected = &#39;分类名称不能为空&#39;\n\n        # 点击文章\n        self.driver.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;sidebar-menu&quot;]&#47;li[4]&#47;a&#47;span[1]&#39;).click()\n        sleep(1)\n        # 点击分类\n        self.driver.find_element_by_xpath(&#39;&#47;&#47;*[@id=&quot;sidebar-menu&quot;]&#47;li[4]&#47;ul&#47;li[3]&#47;a&#39;).click()\n        sleep(1)\n\n        # 输入分类名称\n        self.driver.find_element_by_name(&#39;category.title&#39;).send_keys(name)\n\n        # 选择父分类\n        parent_category_elem = self.driver.find_element_by_name(&#39;category.pid&#39;)\n        # Select\n        Select(parent_category_elem).select_by_visible_text(parent)\n\n        # 输入slug\n        self.driver.find_element_by_name(&#39;category.slug&#39;).send_keys(slug)\n\n        # 点击添加\n        self.driver.find_element_by_xpath(&#39;&#47;html&#47;body&#47;div&#47;div&#47;section[2]&#47;div&#47;div[1]&#47;div&#47;form&#47;div[2]&#47;div&#47;div&#47;button&#39;).click()\n\n        loc = (By.CLASS_NAME,&#39;toast-message&#39;) # 元组-通过class定位，class名称叫toast-message\n        WebDriverWait(self.driver,5).until(EC.visibility_of_element_located(loc))\n\n        msg = self.driver.find_element(*loc).text\n        assert msg == expected\n\n\n这个目前是报错了\ncase.test_add_category_error()\nTypeError: test_add_category_error() missing 1 required positional argument: &#39;self&#39;\n\n但不太理解是什么原因。求解答 ，谢谢","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522741,"discussion_content":"按道理可以通过cookie实现登录的 但是这个项目我测试是失败的 项目做了限制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626602636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287245,"user_name":"香茗已凉","can_delete":false,"product_type":"c3","uid":2528043,"ip_address":"","ucode":"CA9B4D80B62B22","user_header":"https://static001.geekbang.org/account/avatar/00/26/93/2b/13bf1014.jpg","comment_is_top":false,"comment_ctime":1617853030,"is_pvip":false,"replies":[{"id":104418,"content":"用第三方ai库","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1618018196,"ip_address":"","comment_id":287245,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"识别率太低了，怎么循环识别出正确验证码为止，求代码","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518245,"discussion_content":"用第三方ai库","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618018196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":256503,"user_name":"Geek_a10b40","can_delete":false,"product_type":"c3","uid":2238639,"ip_address":"","ucode":"3D5825085D9788","user_header":"","comment_is_top":false,"comment_ctime":1603640351,"is_pvip":false,"replies":[{"id":93999,"content":"这个是编辑器的问题，不用管它","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1604299387,"ip_address":"","comment_id":256503,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师 我很费解一个问题：\nmain方法中写好了：   \n    login = TestCaseAdminLogin()\n    login.test_admin_login_ok()\n    case = TestCategory(login)\n    case.test_add_category_error()\n在编写分类用例的时候，当写到：\nclass TestCategory(object):\n    def __init__(self,login):\n        self.login = login\n\n    #测试文章分类失败，名称为空\n    def test_add_category_error(self):\n        name = &#39;&#39;\n        parent = &#39;python&#39;\n        slug = &#39;test&#39;\n        expected = &#39;分类名称不能为空&#39;\n\n        #点击文章\n        # self.login.driver_find_element_by_xpath(&quot;&#47;&#47;*[@id=&quot;sidebar-menu&quot;]&#47;li[4]&#47;a&#47;span[1]&quot;).click()\n点击文章这里，为什么我这边self.login.driver不能自动teb补全呢，而且写完了会显示报错\n","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508035,"discussion_content":"这个是编辑器的问题，不用管它","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604299387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255545,"user_name":"陳继","can_delete":false,"product_type":"c3","uid":1794222,"ip_address":"","ucode":"C5923F09D11AF9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/60/ae/d21b92ca.jpg","comment_is_top":false,"comment_ctime":1603369745,"is_pvip":false,"replies":[{"id":94001,"content":"可以","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1604299610,"ip_address":"","comment_id":255545,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"验证码的定位可以用xpath来定位吧，不用id定位","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507747,"discussion_content":"可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604299610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":241386,"user_name":"ShouIdo😂","can_delete":false,"product_type":"c3","uid":1351601,"ip_address":"","ucode":"F8371C54FB4EB2","user_header":"https://static001.geekbang.org/account/avatar/00/14/9f/b1/2894614a.jpg","comment_is_top":false,"comment_ctime":1597282916,"is_pvip":false,"replies":[{"id":89163,"content":"没问题 等待toast出现在定位","user_name":"作者回复","user_name_real":"郭宏志","uid":1654315,"ctime":1597286554,"ip_address":"","comment_id":241386,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100055601,"comment_content":"老师，这行代码loc = (By.CLASS_NAME, &#39;toast-message&#39;)用列表会有问题吗？","like_count":0,"discussions":[{"author":{"id":1654315,"avatar":"https://static001.geekbang.org/account/avatar/00/19/3e/2b/93fb1b73.jpg","nickname":"郭宏志","note":"","ucode":"952E0F3E2AA0F8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503731,"discussion_content":"没问题 等待toast出现在定位","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597286554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240580,"user_name":"15390044090","can_delete":false,"product_type":"c3","uid":2112425,"ip_address":"","ucode":"3C2F1E936DC868","user_header":"","comment_is_top":false,"comment_ctime":1596982530,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100055601,"comment_content":"提示弹窗用调试模式就可以停留定位到了","like_count":3},{"had_liked":false,"id":369307,"user_name":"管小娟","can_delete":false,"product_type":"c3","uid":2617456,"ip_address":"江苏","ucode":"717348301BC560","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJXlflPMj9CuQWnr5YRwCGdB792JfbNs5qbjyOgdAIUlVT3VrvA6BF6Cj6y8n4T1RiaLibHISiaxnXg/132","comment_is_top":false,"comment_ctime":1677383220,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100055601,"comment_content":"老师，这个login传不传好像没啥作用啊","like_count":0}]}