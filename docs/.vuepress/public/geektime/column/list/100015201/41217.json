{"id":41217,"title":"20 | æ·±å…¥ç†è§£StatefulSetï¼ˆä¸‰ï¼‰ï¼šæœ‰çŠ¶æ€åº”ç”¨å®è·µ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šæ·±å…¥ç†è§£StatefulSetä¹‹æœ‰çŠ¶æ€åº”ç”¨å®è·µã€‚</p><p>åœ¨å‰é¢çš„ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è¯¦ç»†è®²è§£äº†StatefulSetçš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¤„ç†æ‹“æ‰‘çŠ¶æ€å’Œå­˜å‚¨çŠ¶æ€çš„æ–¹æ³•ã€‚è€Œåœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œå†æ¬¡ä¸ºä½ æ·±å…¥è§£è¯»ä¸€ä¸‹éƒ¨ç½²ä¸€ä¸ªStatefulSetçš„å®Œæ•´æµç¨‹ã€‚</p><p>ä»Šå¤©æˆ‘é€‰æ‹©çš„å®ä¾‹æ˜¯éƒ¨ç½²ä¸€ä¸ªMySQLé›†ç¾¤ï¼Œè¿™ä¹Ÿæ˜¯Kuberneteså®˜æ–¹æ–‡æ¡£é‡Œçš„ä¸€ä¸ªç»å…¸æ¡ˆä¾‹ã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šå·¥ç¨‹å¸ˆéƒ½æ›¾å‘æˆ‘åæ§½è¯´è¿™ä¸ªä¾‹å­â€œå®Œå…¨çœ‹ä¸æ‡‚â€ã€‚</p><p>å…¶å®ï¼Œè¿™æ ·çš„åæ§½ä¹Ÿå¯ä»¥ç†è§£ï¼šç›¸æ¯”äºEtcdã€Cassandraç­‰â€œåŸç”Ÿâ€å°±è€ƒè™‘äº†åˆ†å¸ƒå¼éœ€æ±‚çš„é¡¹ç›®ï¼ŒMySQLä»¥åŠå¾ˆå¤šå…¶ä»–çš„æ•°æ®åº“é¡¹ç›®ï¼Œåœ¨åˆ†å¸ƒå¼é›†ç¾¤çš„æ­å»ºä¸Šå¹¶ä¸å‹å¥½ï¼Œç”šè‡³æœ‰ç‚¹â€œåŸå§‹â€ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™æ¬¡æˆ‘å°±ç›´æ¥é€‰æ‹©äº†è¿™ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„ä¾‹å­ï¼Œå’Œä½ åˆ†äº«å¦‚ä½•ä½¿ç”¨StatefulSetå°†å®ƒçš„é›†ç¾¤æ­å»ºè¿‡ç¨‹â€œå®¹å™¨åŒ–â€ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šåœ¨å¼€å§‹å®è·µä¹‹å‰ï¼Œè¯·ç¡®ä¿æˆ‘ä»¬ä¹‹å‰ä¸€èµ·éƒ¨ç½²çš„é‚£ä¸ªKubernetesé›†ç¾¤è¿˜æ˜¯å¯ç”¨çš„ï¼Œå¹¶ä¸”ç½‘ç»œæ’ä»¶å’Œå­˜å‚¨æ’ä»¶éƒ½èƒ½æ­£å¸¸è¿è¡Œã€‚å…·ä½“çš„åšæ³•ï¼Œè¯·å‚è€ƒç¬¬11ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/39724\">ã€Šä»0åˆ°1ï¼šæ­å»ºä¸€ä¸ªå®Œæ•´çš„Kubernetesé›†ç¾¤ã€‹</a>çš„å†…å®¹ã€‚</p>\n</blockquote><p>é¦–å…ˆï¼Œç”¨è‡ªç„¶è¯­è¨€æ¥æè¿°ä¸€ä¸‹æˆ‘ä»¬æƒ³è¦éƒ¨ç½²çš„â€œæœ‰çŠ¶æ€åº”ç”¨â€ã€‚</p><!-- [[[read_end]]] --><ol>\n<li>\n<p>æ˜¯ä¸€ä¸ªâ€œä¸»ä»å¤åˆ¶â€ï¼ˆMaser-Slave Replicationï¼‰çš„MySQLé›†ç¾¤ï¼›</p>\n</li>\n<li>\n<p>æœ‰1ä¸ªä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰ï¼›</p>\n</li>\n<li>\n<p>æœ‰å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰ï¼›</p>\n</li>\n<li>\n<p>ä»èŠ‚ç‚¹éœ€è¦èƒ½æ°´å¹³æ‰©å±•ï¼›</p>\n</li>\n<li>\n<p>æ‰€æœ‰çš„å†™æ“ä½œï¼Œåªèƒ½åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼›</p>\n</li>\n<li>\n<p>è¯»æ“ä½œå¯ä»¥åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚</p>\n</li>\n</ol><p>è¿™å°±æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„ä¸»ä»æ¨¡å¼çš„MySQLé›†ç¾¤äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢æè¿°çš„â€œæœ‰çŠ¶æ€åº”ç”¨â€çš„éœ€æ±‚ï¼Œé€šè¿‡ä¸€å¼ å›¾æ¥è¡¨ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/02/bb2d7f03443392ca40ecde6b1a91c002.png?wh=785*735\" alt=\"\"><br>\nåœ¨å¸¸è§„ç¯å¢ƒé‡Œï¼Œéƒ¨ç½²è¿™æ ·ä¸€ä¸ªä¸»ä»æ¨¡å¼çš„MySQLé›†ç¾¤çš„ä¸»è¦éš¾ç‚¹åœ¨äºï¼šå¦‚ä½•è®©ä»èŠ‚ç‚¹èƒ½å¤Ÿæ‹¥æœ‰ä¸»èŠ‚ç‚¹çš„æ•°æ®ï¼Œå³ï¼šå¦‚ä½•é…ç½®ä¸»ï¼ˆMasterï¼‰ä»ï¼ˆSlaveï¼‰èŠ‚ç‚¹çš„å¤åˆ¶ä¸åŒæ­¥ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨å®‰è£…å¥½MySQLçš„MasterèŠ‚ç‚¹ä¹‹åï¼Œä½ éœ€è¦åšçš„ç¬¬ä¸€æ­¥å·¥ä½œï¼Œå°±æ˜¯<strong>é€šè¿‡XtraBackupå°†MasterèŠ‚ç‚¹çš„æ•°æ®å¤‡ä»½åˆ°æŒ‡å®šç›®å½•ã€‚</strong></p><blockquote>\n<p>å¤‡æ³¨ï¼šXtraBackupæ˜¯ä¸šç•Œä¸»è¦ä½¿ç”¨çš„å¼€æºMySQLå¤‡ä»½å’Œæ¢å¤å·¥å…·ã€‚</p>\n</blockquote><p>è¿™ä¸€æ­¥ä¼šè‡ªåŠ¨åœ¨ç›®æ ‡ç›®å½•é‡Œç”Ÿæˆä¸€ä¸ªå¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼Œåå«ï¼šxtrabackup_binlog_infoã€‚è¿™ä¸ªæ–‡ä»¶ä¸€èˆ¬ä¼šåŒ…å«å¦‚ä¸‹ä¸¤ä¸ªä¿¡æ¯ï¼š</p><pre><code>$ cat xtrabackup_binlog_info\nTheMaster-bin.000001     481\n</code></pre><p>è¿™ä¸¤ä¸ªä¿¡æ¯ä¼šåœ¨æ¥ä¸‹æ¥é…ç½®SlaveèŠ‚ç‚¹çš„æ—¶å€™ç”¨åˆ°ã€‚</p><p><strong>ç¬¬äºŒæ­¥ï¼šé…ç½®SlaveèŠ‚ç‚¹</strong>ã€‚SlaveèŠ‚ç‚¹åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨å‰ï¼Œéœ€è¦å…ˆæŠŠMasterèŠ‚ç‚¹çš„å¤‡ä»½æ•°æ®ï¼Œè¿åŒå¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼Œä¸€èµ·æ‹·è´åˆ°è‡ªå·±çš„æ•°æ®ç›®å½•ï¼ˆ/var/lib/mysqlï¼‰ä¸‹ã€‚ç„¶åï¼Œæˆ‘ä»¬æ‰§è¡Œè¿™æ ·ä¸€å¥SQLï¼š</p><pre><code>TheSlave|mysql&gt; CHANGE MASTER TO\n                MASTER_HOST='$masterip',\n                MASTER_USER='xxx',\n                MASTER_PASSWORD='xxx',\n                MASTER_LOG_FILE='TheMaster-bin.000001',\n                MASTER_LOG_POS=481;\n</code></pre><p>å…¶ä¸­ï¼ŒMASTER_LOG_FILEå’ŒMASTER_LOG_POSï¼Œå°±æ˜¯è¯¥å¤‡ä»½å¯¹åº”çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinary Logï¼‰æ–‡ä»¶çš„åç§°å’Œå¼€å§‹çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰ï¼Œä¹Ÿæ­£æ˜¯xtrabackup_binlog_infoæ–‡ä»¶é‡Œçš„é‚£ä¸¤éƒ¨åˆ†å†…å®¹ï¼ˆå³ï¼šTheMaster-bin.000001å’Œ481ï¼‰ã€‚</p><p><strong>ç¬¬ä¸‰æ­¥ï¼Œå¯åŠ¨SlaveèŠ‚ç‚¹</strong>ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œè¿™æ ·ä¸€å¥SQLï¼š</p><pre><code>TheSlave|mysql&gt; START SLAVE;\n</code></pre><p>è¿™æ ·ï¼ŒSlaveèŠ‚ç‚¹å°±å¯åŠ¨äº†ã€‚å®ƒä¼šä½¿ç”¨å¤‡ä»½ä¿¡æ¯æ–‡ä»¶ä¸­çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶å’Œåç§»é‡ï¼Œä¸ä¸»èŠ‚ç‚¹è¿›è¡Œæ•°æ®åŒæ­¥ã€‚</p><p><strong>ç¬¬å››æ­¥ï¼Œåœ¨è¿™ä¸ªé›†ç¾¤ä¸­æ·»åŠ æ›´å¤šçš„SlaveèŠ‚ç‚¹</strong>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–°æ·»åŠ çš„SlaveèŠ‚ç‚¹çš„å¤‡ä»½æ•°æ®ï¼Œæ¥è‡ªäºå·²ç»å­˜åœ¨çš„SlaveèŠ‚ç‚¹ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å°†SlaveèŠ‚ç‚¹çš„æ•°æ®å¤‡ä»½åœ¨æŒ‡å®šç›®å½•ã€‚è€Œè¿™ä¸ªå¤‡ä»½æ“ä½œä¼šè‡ªåŠ¨ç”Ÿæˆå¦ä¸€ç§å¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼Œåå«ï¼šxtrabackup_slave_infoã€‚åŒæ ·åœ°ï¼Œè¿™ä¸ªæ–‡ä»¶ä¹ŸåŒ…å«äº†MASTER_LOG_FILEå’ŒMASTER_LOG_POSä¸¤ä¸ªå­—æ®µã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œè·Ÿå‰é¢ä¸€æ ·çš„â€œCHANGE MASTER TOâ€å’Œâ€œSTART SLAVEâ€ æŒ‡ä»¤ï¼Œæ¥åˆå§‹åŒ–å¹¶å¯åŠ¨è¿™ä¸ªæ–°çš„SlaveèŠ‚ç‚¹äº†ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„å™è¿°ï¼Œæˆ‘ä»¬ä¸éš¾çœ‹åˆ°ï¼Œ<strong>å°†éƒ¨ç½²MySQLé›†ç¾¤çš„æµç¨‹è¿ç§»åˆ°Kubernetesé¡¹ç›®ä¸Šï¼Œéœ€è¦èƒ½å¤Ÿâ€œå®¹å™¨åŒ–â€åœ°è§£å†³ä¸‹é¢çš„â€œä¸‰åº§å¤§å±±â€ï¼š</strong></p><ol>\n<li>\n<p>MasterèŠ‚ç‚¹å’ŒSlaveèŠ‚ç‚¹éœ€è¦æœ‰ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼ˆå³ï¼šä¸åŒçš„my.cnfï¼‰ï¼›</p>\n</li>\n<li>\n<p>MasterèŠ‚ç‚¹å’ŒSlaveèŠ‚ç‚¹éœ€è¦èƒ½å¤Ÿä¼ è¾“å¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼›</p>\n</li>\n<li>\n<p>åœ¨SlaveèŠ‚ç‚¹ç¬¬ä¸€æ¬¡å¯åŠ¨ä¹‹å‰ï¼Œéœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–SQLæ“ä½œï¼›</p>\n</li>\n</ol><p>è€Œç”±äºMySQLæœ¬èº«åŒæ—¶æ‹¥æœ‰æ‹“æ‰‘çŠ¶æ€ï¼ˆä¸»ä»èŠ‚ç‚¹çš„åŒºåˆ«ï¼‰å’Œå­˜å‚¨çŠ¶æ€ï¼ˆMySQLä¿å­˜åœ¨æœ¬åœ°çš„æ•°æ®ï¼‰ï¼Œæˆ‘ä»¬è‡ªç„¶è¦é€šè¿‡StatefulSetæ¥è§£å†³è¿™â€œä¸‰åº§å¤§å±±â€çš„é—®é¢˜ã€‚</p><p><strong>å…¶ä¸­ï¼Œâ€œç¬¬ä¸€åº§å¤§å±±ï¼šMasterèŠ‚ç‚¹å’ŒSlaveèŠ‚ç‚¹éœ€è¦æœ‰ä¸åŒçš„é…ç½®æ–‡ä»¶â€ï¼Œå¾ˆå®¹æ˜“å¤„ç†</strong>ï¼šæˆ‘ä»¬åªéœ€è¦ç»™ä¸»ä»èŠ‚ç‚¹åˆ†åˆ«å‡†å¤‡ä¸¤ä»½ä¸åŒçš„MySQLé…ç½®æ–‡ä»¶ï¼Œç„¶åæ ¹æ®Podçš„åºå·ï¼ˆIndexï¼‰æŒ‚è½½è¿›å»å³å¯ã€‚</p><p>æ­£å¦‚æˆ‘åœ¨å‰é¢æ–‡ç« ä¸­ä»‹ç»è¿‡çš„ï¼Œè¿™æ ·çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼Œåº”è¯¥ä¿å­˜åœ¨ConfigMapé‡Œä¾›Podä½¿ç”¨ã€‚å®ƒçš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: mysql\n  labels:\n    app: mysql\ndata:\n  master.cnf: |\n    # ä¸»èŠ‚ç‚¹MySQLçš„é…ç½®æ–‡ä»¶\n    [mysqld]\n    log-bin\n  slave.cnf: |\n    # ä»èŠ‚ç‚¹MySQLçš„é…ç½®æ–‡ä»¶\n    [mysqld]\n    super-read-only\n</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†master.cnfå’Œslave.cnfä¸¤ä¸ªMySQLçš„é…ç½®æ–‡ä»¶ã€‚</p><ul>\n<li>master.cnfå¼€å¯äº†log-binï¼Œå³ï¼šä½¿ç”¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œä¸»ä»å¤åˆ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è®¾ç½®ã€‚</li>\n<li>slave.cnfçš„å¼€å¯äº†super-read-onlyï¼Œä»£è¡¨çš„æ˜¯ä»èŠ‚ç‚¹ä¼šæ‹’ç»é™¤äº†ä¸»èŠ‚ç‚¹çš„æ•°æ®åŒæ­¥æ“ä½œä¹‹å¤–çš„æ‰€æœ‰å†™æ“ä½œï¼Œå³ï¼šå®ƒå¯¹ç”¨æˆ·æ˜¯åªè¯»çš„ã€‚</li>\n</ul><p>è€Œä¸Šè¿°ConfigMapå®šä¹‰é‡Œçš„dataéƒ¨åˆ†ï¼Œæ˜¯Key-Valueæ ¼å¼çš„ã€‚æ¯”å¦‚ï¼Œmaster.cnfå°±æ˜¯è¿™ä»½é…ç½®æ•°æ®çš„Keyï¼Œè€Œâ€œ|â€åé¢çš„å†…å®¹ï¼Œå°±æ˜¯è¿™ä»½é…ç½®æ•°æ®çš„Valueã€‚è¿™ä»½æ•°æ®å°†æ¥æŒ‚è½½è¿›MasterèŠ‚ç‚¹å¯¹åº”çš„Podåï¼Œå°±ä¼šåœ¨Volumeç›®å½•é‡Œç”Ÿæˆä¸€ä¸ªå«ä½œmaster.cnfçš„æ–‡ä»¶ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šå¦‚æœä½ å¯¹ConfigMapçš„ç”¨æ³•æ„Ÿåˆ°é™Œç”Ÿçš„è¯ï¼Œå¯ä»¥ç¨å¾®å¤ä¹ ä¸€ä¸‹ç¬¬15ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/40466\">ã€Šæ·±å…¥è§£æPodå¯¹è±¡ï¼ˆäºŒï¼‰ï¼šä½¿ç”¨è¿›é˜¶ã€‹</a>ä¸­ï¼Œæˆ‘è®²è§£Secretå¯¹è±¡éƒ¨åˆ†çš„å†…å®¹ã€‚å› ä¸ºï¼ŒConfigMapè·ŸSecretï¼Œæ— è®ºæ˜¯ä½¿ç”¨æ–¹æ³•è¿˜æ˜¯å®ç°åŸç†ï¼Œå‡ ä¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>\n</blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªServiceæ¥ä¾›StatefulSetä»¥åŠç”¨æˆ·ä½¿ç”¨ã€‚è¿™ä¸¤ä¸ªServiceçš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  name: mysql\n  labels:\n    app: mysql\nspec:\n  ports:\n  - name: mysql\n    port: 3306\n  clusterIP: None\n  selector:\n    app: mysql\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: mysql-read\n  labels:\n    app: mysql\nspec:\n  ports:\n  - name: mysql\n    port: 3306\n  selector:\n    app: mysql\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªServiceéƒ½ä»£ç†äº†æ‰€æœ‰æºå¸¦app=mysqlæ ‡ç­¾çš„Podï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„MySQL Podã€‚ç«¯å£æ˜ å°„éƒ½æ˜¯ç”¨Serviceçš„3306ç«¯å£å¯¹åº”Podçš„3306ç«¯å£ã€‚</p><p>ä¸åŒçš„æ˜¯ï¼Œç¬¬ä¸€ä¸ªåå«â€œmysqlâ€çš„Serviceæ˜¯ä¸€ä¸ªHeadless Serviceï¼ˆå³ï¼šclusterIP= Noneï¼‰ã€‚æ‰€ä»¥å®ƒçš„ä½œç”¨ï¼Œæ˜¯é€šè¿‡ä¸ºPodåˆ†é…DNSè®°å½•æ¥å›ºå®šå®ƒçš„æ‹“æ‰‘çŠ¶æ€ï¼Œæ¯”å¦‚â€œmysql-0.mysqlâ€å’Œâ€œmysql-1.mysqlâ€è¿™æ ·çš„DNSåå­—ã€‚å…¶ä¸­ï¼Œç¼–å·ä¸º0çš„èŠ‚ç‚¹å°±æ˜¯æˆ‘ä»¬çš„ä¸»èŠ‚ç‚¹ã€‚</p><p>è€Œç¬¬äºŒä¸ªåå«â€œmysql-readâ€çš„Serviceï¼Œåˆ™æ˜¯ä¸€ä¸ªå¸¸è§„çš„Serviceã€‚</p><p>å¹¶ä¸”æˆ‘ä»¬è§„å®šï¼Œæ‰€æœ‰ç”¨æˆ·çš„è¯»è¯·æ±‚ï¼Œéƒ½å¿…é¡»è®¿é—®ç¬¬äºŒä¸ªServiceè¢«è‡ªåŠ¨åˆ†é…çš„DNSè®°å½•ï¼Œå³ï¼šâ€œmysql-readâ€ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯ä»¥è®¿é—®è¿™ä¸ªServiceçš„VIPï¼‰ã€‚è¿™æ ·ï¼Œè¯»è¯·æ±‚å°±å¯ä»¥è¢«è½¬å‘åˆ°ä»»æ„ä¸€ä¸ªMySQLçš„ä¸»èŠ‚ç‚¹æˆ–è€…ä»èŠ‚ç‚¹ä¸Šã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šKubernetesä¸­çš„æ‰€æœ‰Serviceã€Podå¯¹è±¡ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨åˆ†é…åŒåçš„DNSè®°å½•ã€‚å…·ä½“ç»†èŠ‚ï¼Œæˆ‘ä¼šåœ¨åé¢Serviceéƒ¨åˆ†åšé‡ç‚¹è®²è§£ã€‚</p>\n</blockquote><p>è€Œæ‰€æœ‰ç”¨æˆ·çš„å†™è¯·æ±‚ï¼Œåˆ™å¿…é¡»ç›´æ¥ä»¥DNSè®°å½•çš„æ–¹å¼è®¿é—®åˆ°MySQLçš„ä¸»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ï¼šâ€œmysql-0.mysqlâ€œè¿™æ¡DNSè®°å½•ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ä¸€èµ·è§£å†³â€œç¬¬äºŒåº§å¤§å±±ï¼šMasterèŠ‚ç‚¹å’ŒSlaveèŠ‚ç‚¹éœ€è¦èƒ½å¤Ÿä¼ è¾“å¤‡ä»½æ–‡ä»¶â€çš„é—®é¢˜ã€‚</p><p><strong>ç¿»è¶Šè¿™åº§å¤§å±±çš„æ€è·¯ï¼Œæˆ‘æ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯ï¼šå…ˆæ­å»ºæ¡†æ¶ï¼Œå†å®Œå–„ç»†èŠ‚ã€‚å…¶ä¸­ï¼ŒPodéƒ¨åˆ†å¦‚ä½•å®šä¹‰ï¼Œæ˜¯å®Œå–„ç»†èŠ‚æ—¶çš„é‡ç‚¹ã€‚</strong></p><p><strong>æ‰€ä»¥é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆä¸ºStatefulSetå¯¹è±¡è§„åˆ’ä¸€ä¸ªå¤§è‡´çš„æ¡†æ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</strong></p><p><img src=\"https://static001.geekbang.org/resource/image/16/09/16aa2e42034830a0e64120ecc330a509.png?wh=612*1058\" alt=\"\"></p><p>åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¸ºStatefulSetå®šä¹‰ä¸€äº›é€šç”¨çš„å­—æ®µã€‚</p><p>æ¯”å¦‚ï¼šselectorè¡¨ç¤ºï¼Œè¿™ä¸ªStatefulSetè¦ç®¡ç†çš„Podå¿…é¡»æºå¸¦app=mysqlæ ‡ç­¾ï¼›å®ƒå£°æ˜è¦ä½¿ç”¨çš„Headless Serviceçš„åå­—æ˜¯ï¼šmysqlã€‚</p><p>è¿™ä¸ªStatefulSetçš„replicaså€¼æ˜¯3ï¼Œè¡¨ç¤ºå®ƒå®šä¹‰çš„MySQLé›†ç¾¤æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼šä¸€ä¸ªMasterèŠ‚ç‚¹ï¼Œä¸¤ä¸ªSlaveèŠ‚ç‚¹ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒStatefulSetç®¡ç†çš„â€œæœ‰çŠ¶æ€åº”ç”¨â€çš„å¤šä¸ªå®ä¾‹ï¼Œä¹Ÿéƒ½æ˜¯é€šè¿‡åŒä¸€ä»½Podæ¨¡æ¿åˆ›å»ºå‡ºæ¥çš„ï¼Œä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªDockeré•œåƒã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼šå¦‚æœä½ çš„åº”ç”¨è¦æ±‚ä¸åŒèŠ‚ç‚¹çš„é•œåƒä¸ä¸€æ ·ï¼Œé‚£å°±ä¸èƒ½å†ä½¿ç”¨StatefulSetäº†ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œåº”è¯¥è€ƒè™‘æˆ‘åé¢ä¼šè®²è§£åˆ°çš„Operatorã€‚</p><p>é™¤äº†è¿™äº›åŸºæœ¬çš„å­—æ®µå¤–ï¼Œä½œä¸ºä¸€ä¸ªæœ‰å­˜å‚¨çŠ¶æ€çš„MySQLé›†ç¾¤ï¼ŒStatefulSetè¿˜éœ€è¦ç®¡ç†å­˜å‚¨çŠ¶æ€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡volumeClaimTemplateï¼ˆPVCæ¨¡æ¿ï¼‰æ¥ä¸ºæ¯ä¸ªPodå®šä¹‰PVCã€‚æ¯”å¦‚ï¼Œè¿™ä¸ªPVCæ¨¡æ¿çš„resources.requests.strorageæŒ‡å®šäº†å­˜å‚¨çš„å¤§å°ä¸º10 GiBï¼›ReadWriteOnceæŒ‡å®šäº†è¯¥å­˜å‚¨çš„å±æ€§ä¸ºå¯è¯»å†™ï¼Œå¹¶ä¸”ä¸€ä¸ªPVåªå…è®¸æŒ‚è½½åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šã€‚å°†æ¥ï¼Œè¿™ä¸ªPVå¯¹åº”çš„çš„Volumeå°±ä¼šå……å½“MySQL Podçš„å­˜å‚¨æ•°æ®ç›®å½•ã€‚</p><p><strong>ç„¶åï¼Œæˆ‘ä»¬æ¥é‡ç‚¹è®¾è®¡ä¸€ä¸‹è¿™ä¸ªStatefulSetçš„Podæ¨¡æ¿ï¼Œä¹Ÿå°±æ˜¯templateå­—æ®µã€‚</strong></p><p>ç”±äºStatefulSetç®¡ç†çš„Podéƒ½æ¥è‡ªäºåŒä¸€ä¸ªé•œåƒï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åœ¨ç¼–å†™Podæ—¶ï¼Œä¸€å®šè¦ä¿æŒæ¸…é†’ï¼Œç”¨â€œäººæ ¼åˆ†è£‚â€çš„æ–¹å¼è¿›è¡Œæ€è€ƒï¼š</p><ol>\n<li>\n<p>å¦‚æœè¿™ä¸ªPodæ˜¯MasterèŠ‚ç‚¹ï¼Œæˆ‘ä»¬è¦æ€ä¹ˆåšï¼›</p>\n</li>\n<li>\n<p>å¦‚æœè¿™ä¸ªPodæ˜¯SlaveèŠ‚ç‚¹ï¼Œæˆ‘ä»¬åˆè¦æ€ä¹ˆåšã€‚</p>\n</li>\n</ol><p>æƒ³æ¸…æ¥šè¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§Podçš„å¯åŠ¨è¿‡ç¨‹æ¥ä¸€æ­¥æ­¥å®šä¹‰å®ƒä»¬äº†ã€‚</p><p><strong>ç¬¬ä¸€æ­¥ï¼šä»ConfigMapä¸­ï¼Œè·å–MySQLçš„Podå¯¹åº”çš„é…ç½®æ–‡ä»¶ã€‚</strong></p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€ä¸ªåˆå§‹åŒ–æ“ä½œï¼Œæ ¹æ®èŠ‚ç‚¹çš„è§’è‰²æ˜¯Masterè¿˜æ˜¯SlaveèŠ‚ç‚¹ï¼Œä¸ºPodåˆ†é…å¯¹åº”çš„é…ç½®æ–‡ä»¶ã€‚æ­¤å¤–ï¼ŒMySQLè¿˜è¦æ±‚é›†ç¾¤é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„IDæ–‡ä»¶ï¼Œåå«server-id.cnfã€‚</p><p>è€Œæ ¹æ®æˆ‘ä»¬å·²ç»æŒæ¡çš„PodçŸ¥è¯†ï¼Œè¿™äº›åˆå§‹åŒ–æ“ä½œæ˜¾ç„¶é€‚åˆé€šè¿‡InitContaineræ¥å®Œæˆã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªInitContainerï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>      ...\n      # template.spec\n      initContainers:\n      - name: init-mysql\n        image: mysql:5.7\n        command:\n        - bash\n        - &quot;-c&quot;\n        - |\n          set -ex\n          # ä»Podçš„åºå·ï¼Œç”Ÿæˆserver-id\n          [[ `hostname` =~ -([0-9]+)$ ]] || exit 1\n          ordinal=${BASH_REMATCH[1]}\n          echo [mysqld] &gt; /mnt/conf.d/server-id.cnf\n          # ç”±äºserver-id=0æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæˆ‘ä»¬ç»™IDåŠ ä¸€ä¸ª100æ¥é¿å¼€å®ƒ\n          echo server-id=$((100 + $ordinal)) &gt;&gt; /mnt/conf.d/server-id.cnf\n          # å¦‚æœPodåºå·æ˜¯0ï¼Œè¯´æ˜å®ƒæ˜¯MasterèŠ‚ç‚¹ï¼Œä»ConfigMapé‡ŒæŠŠMasterçš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°/mnt/conf.d/ç›®å½•ï¼›\n          # å¦åˆ™ï¼Œæ‹·è´Slaveçš„é…ç½®æ–‡ä»¶\n          if [[ $ordinal -eq 0 ]]; then\n            cp /mnt/config-map/master.cnf /mnt/conf.d/\n          else\n            cp /mnt/config-map/slave.cnf /mnt/conf.d/\n          fi\n        volumeMounts:\n        - name: conf\n          mountPath: /mnt/conf.d\n        - name: config-map\n          mountPath: /mnt/config-map\n</code></pre><p>åœ¨è¿™ä¸ªåå«init-mysqlçš„InitContainerçš„é…ç½®ä¸­ï¼Œå®ƒä»Podçš„hostnameé‡Œï¼Œè¯»å–åˆ°äº†Podçš„åºå·ï¼Œä»¥æ­¤ä½œä¸ºMySQLèŠ‚ç‚¹çš„server-idã€‚</p><p>ç„¶åï¼Œinit-mysqlé€šè¿‡è¿™ä¸ªåºå·ï¼Œåˆ¤æ–­å½“å‰Podåˆ°åº•æ˜¯MasterèŠ‚ç‚¹ï¼ˆå³ï¼šåºå·ä¸º0ï¼‰è¿˜æ˜¯SlaveèŠ‚ç‚¹ï¼ˆå³ï¼šåºå·ä¸ä¸º0ï¼‰ï¼Œä»è€ŒæŠŠå¯¹åº”çš„é…ç½®æ–‡ä»¶ä»/mnt/config-mapç›®å½•æ‹·è´åˆ°/mnt/conf.d/ç›®å½•ä¸‹ã€‚</p><p>å…¶ä¸­ï¼Œæ–‡ä»¶æ‹·è´çš„æºç›®å½•/mnt/config-mapï¼Œæ­£æ˜¯ConfigMapåœ¨è¿™ä¸ªPodçš„Volumeï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>      ...\n      # template.spec\n      volumes:\n      - name: conf\n        emptyDir: {}\n      - name: config-map\n        configMap:\n          name: mysql\n</code></pre><p>é€šè¿‡è¿™ä¸ªå®šä¹‰ï¼Œinit-mysqlåœ¨å£°æ˜äº†æŒ‚è½½config-mapè¿™ä¸ªVolumeä¹‹åï¼ŒConfigMapé‡Œä¿å­˜çš„å†…å®¹ï¼Œå°±ä¼šä»¥æ–‡ä»¶çš„æ–¹å¼å‡ºç°åœ¨å®ƒçš„/mnt/config-mapç›®å½•å½“ä¸­ã€‚</p><p>è€Œæ–‡ä»¶æ‹·è´çš„ç›®æ ‡ç›®å½•ï¼Œå³å®¹å™¨é‡Œçš„/mnt/conf.d/ç›®å½•ï¼Œå¯¹åº”çš„åˆ™æ˜¯ä¸€ä¸ªåå«confçš„ã€emptyDirç±»å‹çš„Volumeã€‚åŸºäºPod Volumeå…±äº«çš„åŸç†ï¼Œå½“InitContainerå¤åˆ¶å®Œé…ç½®æ–‡ä»¶é€€å‡ºåï¼Œåé¢å¯åŠ¨çš„MySQLå®¹å™¨åªéœ€è¦ç›´æ¥å£°æ˜æŒ‚è½½è¿™ä¸ªåå«confçš„Volumeï¼Œå®ƒæ‰€éœ€è¦çš„.cnfé…ç½®æ–‡ä»¶å·²ç»å‡ºç°åœ¨é‡Œé¢äº†ã€‚è¿™è·Ÿæˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„Tomcatå’ŒWARåŒ…çš„å¤„ç†æ–¹æ³•æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p><p><strong>ç¬¬äºŒæ­¥ï¼šåœ¨Slave Podå¯åŠ¨å‰ï¼Œä»Masteræˆ–è€…å…¶ä»–Slave Podé‡Œæ‹·è´æ•°æ®åº“æ•°æ®åˆ°è‡ªå·±çš„ç›®å½•ä¸‹ã€‚</strong></p><p>ä¸ºäº†å®ç°è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å°±éœ€è¦å†å®šä¹‰ç¬¬äºŒä¸ªInitContainerï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>      ...\n      # template.spec.initContainers\n      - name: clone-mysql\n        image: gcr.io/google-samples/xtrabackup:1.0\n        command:\n        - bash\n        - &quot;-c&quot;\n        - |\n          set -ex\n          # æ‹·è´æ“ä½œåªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶è¿›è¡Œï¼Œæ‰€ä»¥å¦‚æœæ•°æ®å·²ç»å­˜åœ¨ï¼Œè·³è¿‡\n          [[ -d /var/lib/mysql/mysql ]] &amp;&amp; exit 0\n          # MasterèŠ‚ç‚¹(åºå·ä¸º0)ä¸éœ€è¦åšè¿™ä¸ªæ“ä½œ\n          [[ `hostname` =~ -([0-9]+)$ ]] || exit 1\n          ordinal=${BASH_REMATCH[1]}\n          [[ $ordinal -eq 0 ]] &amp;&amp; exit 0\n          # ä½¿ç”¨ncatæŒ‡ä»¤ï¼Œè¿œç¨‹åœ°ä»å‰ä¸€ä¸ªèŠ‚ç‚¹æ‹·è´æ•°æ®åˆ°æœ¬åœ°\n          ncat --recv-only mysql-$(($ordinal-1)).mysql 3307 | xbstream -x -C /var/lib/mysql\n          # æ‰§è¡Œ--prepareï¼Œè¿™æ ·æ‹·è´æ¥çš„æ•°æ®å°±å¯ä»¥ç”¨ä½œæ¢å¤äº†\n          xtrabackup --prepare --target-dir=/var/lib/mysql\n        volumeMounts:\n        - name: data\n          mountPath: /var/lib/mysql\n          subPath: mysql\n        - name: conf\n          mountPath: /etc/mysql/conf.d\n</code></pre><p>åœ¨è¿™ä¸ªåå«clone-mysqlçš„InitContaineré‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯xtrabackupé•œåƒï¼ˆå®ƒé‡Œé¢å®‰è£…äº†xtrabackupå·¥å…·ï¼‰ã€‚</p><p>è€Œåœ¨å®ƒçš„å¯åŠ¨å‘½ä»¤é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆåšäº†ä¸€ä¸ªåˆ¤æ–­ã€‚å³ï¼šå½“åˆå§‹åŒ–æ‰€éœ€çš„æ•°æ®ï¼ˆ/var/lib/mysql/mysql ç›®å½•ï¼‰å·²ç»å­˜åœ¨ï¼Œæˆ–è€…å½“å‰Podæ˜¯MasterèŠ‚ç‚¹çš„æ—¶å€™ï¼Œä¸éœ€è¦åšæ‹·è´æ“ä½œã€‚</p><p>æ¥ä¸‹æ¥ï¼Œclone-mysqlä¼šä½¿ç”¨Linuxè‡ªå¸¦çš„ncatæŒ‡ä»¤ï¼Œå‘DNSè®°å½•ä¸ºâ€œmysql-&lt;å½“å‰åºå·å‡ä¸€&gt;.mysqlâ€çš„Podï¼Œä¹Ÿå°±æ˜¯å½“å‰Podçš„å‰ä¸€ä¸ªPodï¼Œå‘èµ·æ•°æ®ä¼ è¾“è¯·æ±‚ï¼Œå¹¶ä¸”ç›´æ¥ç”¨xbstreamæŒ‡ä»¤å°†æ”¶åˆ°çš„å¤‡ä»½æ•°æ®ä¿å­˜åœ¨/var/lib/mysqlç›®å½•ä¸‹ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼š3307æ˜¯ä¸€ä¸ªç‰¹æ®Šç«¯å£ï¼Œè¿è¡Œç€ä¸€ä¸ªä¸“é—¨è´Ÿè´£å¤‡ä»½MySQLæ•°æ®çš„è¾…åŠ©è¿›ç¨‹ã€‚æˆ‘ä»¬åé¢é©¬ä¸Šä¼šè®²åˆ°å®ƒã€‚</p>\n</blockquote><p>å½“ç„¶ï¼Œè¿™ä¸€æ­¥ä½ å¯ä»¥éšæ„é€‰æ‹©ç”¨è‡ªå·±å–œæ¬¢çš„æ–¹æ³•æ¥ä¼ è¾“æ•°æ®ã€‚æ¯”å¦‚ï¼Œç”¨scpæˆ–è€…rsyncï¼Œéƒ½æ²¡é—®é¢˜ã€‚</p><p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¿™ä¸ªå®¹å™¨é‡Œçš„/var/lib/mysqlç›®å½•ï¼Œ<strong>å®é™…ä¸Šæ­£æ˜¯ä¸€ä¸ªåä¸ºdataçš„PVC</strong>ï¼Œå³ï¼šæˆ‘ä»¬åœ¨å‰é¢å£°æ˜çš„æŒä¹…åŒ–å­˜å‚¨ã€‚</p><p>è¿™å°±å¯ä»¥ä¿è¯ï¼Œå“ªæ€•å®¿ä¸»æœºå®•æœºäº†ï¼Œæˆ‘ä»¬æ•°æ®åº“çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œç”±äºPod Volumeæ˜¯è¢«Podé‡Œçš„å®¹å™¨å…±äº«çš„ï¼Œæ‰€ä»¥åé¢å¯åŠ¨çš„MySQLå®¹å™¨ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªVolumeæŒ‚è½½åˆ°è‡ªå·±çš„/var/lib/mysqlç›®å½•ä¸‹ï¼Œç›´æ¥ä½¿ç”¨é‡Œé¢çš„å¤‡ä»½æ•°æ®è¿›è¡Œæ¢å¤æ“ä½œã€‚</p><p>ä¸è¿‡ï¼Œclone-mysqlå®¹å™¨è¿˜è¦å¯¹/var/lib/mysqlç›®å½•ï¼Œæ‰§è¡Œä¸€å¥xtrabackup --prepareæ“ä½œï¼Œç›®çš„æ˜¯è®©æ‹·è´æ¥çš„æ•°æ®è¿›å…¥ä¸€è‡´æ€§çŠ¶æ€ï¼Œè¿™æ ·ï¼Œè¿™äº›æ•°æ®æ‰èƒ½è¢«ç”¨ä½œæ•°æ®æ¢å¤ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±é€šè¿‡InitContainerå®Œæˆäº†å¯¹â€œä¸»ã€ä»èŠ‚ç‚¹é—´å¤‡ä»½æ–‡ä»¶ä¼ è¾“â€æ“ä½œçš„å¤„ç†è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ç¿»è¶Šäº†â€œç¬¬äºŒåº§å¤§å±±â€ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å®šä¹‰MySQLå®¹å™¨,å¯åŠ¨MySQLæœåŠ¡äº†ã€‚ç”±äºStatefulSeté‡Œçš„æ‰€æœ‰Podéƒ½æ¥è‡ªç”¨åŒä¸€ä¸ªPodæ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦â€œäººæ ¼åˆ†è£‚â€åœ°å»æ€è€ƒï¼šè¿™ä¸ªMySQLå®¹å™¨çš„å¯åŠ¨å‘½ä»¤ï¼Œåœ¨Masterå’ŒSlaveä¸¤ç§æƒ…å†µä¸‹æœ‰ä»€ä¹ˆä¸åŒã€‚</p><p>æœ‰äº†Dockeré•œåƒï¼Œåœ¨Podé‡Œå£°æ˜ä¸€ä¸ªMasterè§’è‰²çš„MySQLå®¹å™¨å¹¶ä¸æ˜¯ä»€ä¹ˆå›°éš¾çš„äº‹æƒ…ï¼šç›´æ¥æ‰§è¡ŒMySQLå¯åŠ¨å‘½ä»¤å³å¯ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªPodæ˜¯ä¸€ä¸ªç¬¬ä¸€æ¬¡å¯åŠ¨çš„SlaveèŠ‚ç‚¹ï¼Œåœ¨æ‰§è¡ŒMySQLå¯åŠ¨å‘½ä»¤ä¹‹å‰ï¼Œå®ƒå°±éœ€è¦ä½¿ç”¨å‰é¢InitContaineræ‹·è´æ¥çš„å¤‡ä»½æ•°æ®è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>å¯æ˜¯ï¼Œåˆ«å¿˜äº†ï¼Œ<strong>å®¹å™¨æ˜¯ä¸€ä¸ªå•è¿›ç¨‹æ¨¡å‹ã€‚</strong></p><p>æ‰€ä»¥ï¼Œä¸€ä¸ªSlaveè§’è‰²çš„MySQLå®¹å™¨å¯åŠ¨ä¹‹å‰ï¼Œè°èƒ½è´Ÿè´£ç»™å®ƒæ‰§è¡Œåˆå§‹åŒ–çš„SQLè¯­å¥å‘¢ï¼Ÿ</p><p>è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦è§£å†³çš„â€œç¬¬ä¸‰åº§å¤§å±±â€çš„é—®é¢˜ï¼Œå³ï¼šå¦‚ä½•åœ¨SlaveèŠ‚ç‚¹çš„MySQLå®¹å™¨ç¬¬ä¸€æ¬¡å¯åŠ¨ä¹‹å‰ï¼Œæ‰§è¡Œåˆå§‹åŒ–SQLã€‚</p><p>ä½ å¯èƒ½å·²ç»æƒ³åˆ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¿™ä¸ªMySQLå®¹å™¨é¢å¤–å®šä¹‰ä¸€ä¸ªsidecarå®¹å™¨ï¼Œæ¥å®Œæˆè¿™ä¸ªæ“ä½œï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>      ...\n      # template.spec.containers\n      - name: xtrabackup\n        image: gcr.io/google-samples/xtrabackup:1.0\n        ports:\n        - name: xtrabackup\n          containerPort: 3307\n        command:\n        - bash\n        - &quot;-c&quot;\n        - |\n          set -ex\n          cd /var/lib/mysql\n          \n          # ä»å¤‡ä»½ä¿¡æ¯æ–‡ä»¶é‡Œè¯»å–MASTER_LOG_FILEMå’ŒMASTER_LOG_POSè¿™ä¸¤ä¸ªå­—æ®µçš„å€¼ï¼Œç”¨æ¥æ‹¼è£…é›†ç¾¤åˆå§‹åŒ–SQL\n          if [[ -f xtrabackup_slave_info ]]; then\n            # å¦‚æœxtrabackup_slave_infoæ–‡ä»¶å­˜åœ¨ï¼Œè¯´æ˜è¿™ä¸ªå¤‡ä»½æ•°æ®æ¥è‡ªäºå¦ä¸€ä¸ªSlaveèŠ‚ç‚¹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒXtraBackupå·¥å…·åœ¨å¤‡ä»½çš„æ—¶å€™ï¼Œå°±å·²ç»åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œè‡ªåŠ¨ç”Ÿæˆäº†&quot;CHANGE MASTER TO&quot; SQLè¯­å¥ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæ–‡ä»¶é‡å‘½åä¸ºchange_master_to.sql.inï¼Œåé¢ç›´æ¥ä½¿ç”¨å³å¯\n            mv xtrabackup_slave_info change_master_to.sql.in\n            # æ‰€ä»¥ï¼Œä¹Ÿå°±ç”¨ä¸ç€xtrabackup_binlog_infoäº†\n            rm -f xtrabackup_binlog_info\n          elif [[ -f xtrabackup_binlog_info ]]; then\n            # å¦‚æœåªå­˜åœ¨xtrabackup_binlog_infæ–‡ä»¶ï¼Œé‚£è¯´æ˜å¤‡ä»½æ¥è‡ªäºMasterèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±éœ€è¦è§£æè¿™ä¸ªå¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼Œè¯»å–æ‰€éœ€çš„ä¸¤ä¸ªå­—æ®µçš„å€¼\n            [[ `cat xtrabackup_binlog_info` =~ ^(.*?)[[:space:]]+(.*?)$ ]] || exit 1\n            rm xtrabackup_binlog_info\n            # æŠŠä¸¤ä¸ªå­—æ®µçš„å€¼æ‹¼è£…æˆSQLï¼Œå†™å…¥change_master_to.sql.inæ–‡ä»¶\n            echo &quot;CHANGE MASTER TO MASTER_LOG_FILE='${BASH_REMATCH[1]}',\\\n                  MASTER_LOG_POS=${BASH_REMATCH[2]}&quot; &gt; change_master_to.sql.in\n          fi\n          \n          # å¦‚æœchange_master_to.sql.inï¼Œå°±æ„å‘³ç€éœ€è¦åšé›†ç¾¤åˆå§‹åŒ–å·¥ä½œ\n          if [[ -f change_master_to.sql.in ]]; then\n            # ä½†ä¸€å®šè¦å…ˆç­‰MySQLå®¹å™¨å¯åŠ¨ä¹‹åæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥è¿æ¥MySQLçš„æ“ä½œ\n            echo &quot;Waiting for mysqld to be ready (accepting connections)&quot;\n            until mysql -h 127.0.0.1 -e &quot;SELECT 1&quot;; do sleep 1; done\n            \n            echo &quot;Initializing replication from clone position&quot;\n            # å°†æ–‡ä»¶change_master_to.sql.inæ”¹ä¸ªåå­—ï¼Œé˜²æ­¢è¿™ä¸ªContaineré‡å¯çš„æ—¶å€™ï¼Œå› ä¸ºåˆæ‰¾åˆ°äº†change_master_to.sql.inï¼Œä»è€Œé‡å¤æ‰§è¡Œä¸€éè¿™ä¸ªåˆå§‹åŒ–æµç¨‹\n            mv change_master_to.sql.in change_master_to.sql.orig\n            # ä½¿ç”¨change_master_to.sql.origçš„å†…å®¹ï¼Œä¹Ÿæ˜¯å°±æ˜¯å‰é¢æ‹¼è£…çš„SQLï¼Œç»„æˆä¸€ä¸ªå®Œæ•´çš„åˆå§‹åŒ–å’Œå¯åŠ¨Slaveçš„SQLè¯­å¥\n            mysql -h 127.0.0.1 &lt;&lt;EOF\n          $(&lt;change_master_to.sql.orig),\n            MASTER_HOST='mysql-0.mysql',\n            MASTER_USER='root',\n            MASTER_PASSWORD='',\n            MASTER_CONNECT_RETRY=10;\n          START SLAVE;\n          EOF\n          fi\n          \n          # ä½¿ç”¨ncatç›‘å¬3307ç«¯å£ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼Œåœ¨æ”¶åˆ°ä¼ è¾“è¯·æ±‚çš„æ—¶å€™ï¼Œç›´æ¥æ‰§è¡Œ&quot;xtrabackup --backup&quot;å‘½ä»¤ï¼Œå¤‡ä»½MySQLçš„æ•°æ®å¹¶å‘é€ç»™è¯·æ±‚è€…\n          exec ncat --listen --keep-open --send-only --max-conns=1 3307 -c \\\n            &quot;xtrabackup --backup --slave-info --stream=xbstream --host=127.0.0.1 --user=root&quot;\n        volumeMounts:\n        - name: data\n          mountPath: /var/lib/mysql\n          subPath: mysql\n        - name: conf\n          mountPath: /etc/mysql/conf.d\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>åœ¨è¿™ä¸ªåå«xtrabackupçš„sidecarå®¹å™¨çš„å¯åŠ¨å‘½ä»¤é‡Œï¼Œå…¶å®å®ç°äº†ä¸¤éƒ¨åˆ†å·¥ä½œã€‚</strong></p><p><strong>ç¬¬ä¸€éƒ¨åˆ†å·¥ä½œï¼Œå½“ç„¶æ˜¯MySQLèŠ‚ç‚¹çš„åˆå§‹åŒ–å·¥ä½œ</strong>ã€‚è¿™ä¸ªåˆå§‹åŒ–éœ€è¦ä½¿ç”¨çš„SQLï¼Œæ˜¯sidecarå®¹å™¨æ‹¼è£…å‡ºæ¥ã€ä¿å­˜åœ¨ä¸€ä¸ªåä¸ºchange_master_to.sql.inçš„æ–‡ä»¶é‡Œçš„ï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>sidecarå®¹å™¨é¦–å…ˆä¼šåˆ¤æ–­å½“å‰Podçš„/var/lib/mysqlç›®å½•ä¸‹ï¼Œæ˜¯å¦æœ‰xtrabackup_slave_infoè¿™ä¸ªå¤‡ä»½ä¿¡æ¯æ–‡ä»¶ã€‚</p><ul>\n<li>å¦‚æœæœ‰ï¼Œåˆ™è¯´æ˜è¿™ä¸ªç›®å½•ä¸‹çš„å¤‡ä»½æ•°æ®æ˜¯ç”±ä¸€ä¸ªSlaveèŠ‚ç‚¹ç”Ÿæˆçš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒXtraBackupå·¥å…·åœ¨å¤‡ä»½çš„æ—¶å€™ï¼Œå°±å·²ç»åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œè‡ªåŠ¨ç”Ÿæˆäº†\"CHANGE MASTER TO\" SQLè¯­å¥ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæ–‡ä»¶é‡å‘½åä¸ºchange_master_to.sql.inï¼Œåé¢ç›´æ¥ä½¿ç”¨å³å¯ã€‚</li>\n<li>å¦‚æœæ²¡æœ‰xtrabackup_slave_infoæ–‡ä»¶ã€ä½†æ˜¯å­˜åœ¨xtrabackup_binlog_infoæ–‡ä»¶ï¼Œé‚£å°±è¯´æ˜å¤‡ä»½æ•°æ®æ¥è‡ªäºMasterèŠ‚ç‚¹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œsidecarå®¹å™¨å°±éœ€è¦è§£æè¿™ä¸ªå¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼Œè¯»å–MASTER_LOG_FILEå’ŒMASTER_LOG_POSè¿™ä¸¤ä¸ªå­—æ®µçš„å€¼ï¼Œç”¨å®ƒä»¬æ‹¼è£…å‡ºåˆå§‹åŒ–SQLè¯­å¥ï¼Œç„¶åæŠŠè¿™å¥SQLå†™å…¥åˆ°change_master_to.sql.inæ–‡ä»¶ä¸­ã€‚</li>\n</ul><p>æ¥ä¸‹æ¥ï¼Œsidecarå®¹å™¨å°±å¯ä»¥æ‰§è¡Œåˆå§‹åŒ–äº†ã€‚ä»ä¸Šé¢çš„å™è¿°ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåªè¦è¿™ä¸ªchange_master_to.sql.inæ–‡ä»¶å­˜åœ¨ï¼Œé‚£å°±è¯´æ˜æ¥ä¸‹æ¥éœ€è¦è¿›è¡Œé›†ç¾¤åˆå§‹åŒ–æ“ä½œã€‚</p><p>æ‰€ä»¥ï¼Œè¿™æ—¶å€™ï¼Œsidecarå®¹å™¨åªéœ€è¦è¯»å–å¹¶æ‰§è¡Œchange_master_to.sql.iné‡Œé¢çš„â€œCHANGE MASTER TOâ€æŒ‡ä»¤ï¼Œå†æ‰§è¡Œä¸€å¥START SLAVEå‘½ä»¤ï¼Œä¸€ä¸ªSlaveèŠ‚ç‚¹å°±è¢«æˆåŠŸå¯åŠ¨äº†ã€‚</p><blockquote>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šPodé‡Œçš„å®¹å™¨å¹¶æ²¡æœ‰å…ˆåé¡ºåºï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œåˆå§‹åŒ–SQLä¹‹å‰ï¼Œå¿…é¡»å…ˆæ‰§è¡Œä¸€å¥SQLï¼ˆselect 1ï¼‰æ¥æ£€æŸ¥ä¸€ä¸‹MySQLæœåŠ¡æ˜¯å¦å·²ç»å¯ç”¨ã€‚</p>\n</blockquote><p>å½“ç„¶ï¼Œä¸Šè¿°è¿™äº›åˆå§‹åŒ–æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬è¿˜è¦åˆ é™¤æ‰å‰é¢ç”¨åˆ°çš„è¿™äº›å¤‡ä»½ä¿¡æ¯æ–‡ä»¶ã€‚å¦åˆ™ï¼Œä¸‹æ¬¡è¿™ä¸ªå®¹å™¨é‡å¯æ—¶ï¼Œå°±ä¼šå‘ç°è¿™äº›æ–‡ä»¶å­˜åœ¨ï¼Œæ‰€ä»¥åˆä¼šé‡æ–°æ‰§è¡Œä¸€æ¬¡æ•°æ®æ¢å¤å’Œé›†ç¾¤åˆå§‹åŒ–çš„æ“ä½œï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚</p><p>åŒç†ï¼Œchange_master_to.sql.inåœ¨ä½¿ç”¨åä¹Ÿè¦è¢«é‡å‘½åï¼Œä»¥å…å®¹å™¨é‡å¯æ—¶å› ä¸ºå‘ç°è¿™ä¸ªæ–‡ä»¶å­˜åœ¨åˆæ‰§è¡Œä¸€éåˆå§‹åŒ–ã€‚</p><p><strong>åœ¨å®ŒæˆMySQLèŠ‚ç‚¹çš„åˆå§‹åŒ–åï¼Œè¿™ä¸ªsidecarå®¹å™¨çš„ç¬¬äºŒä¸ªå·¥ä½œï¼Œåˆ™æ˜¯å¯åŠ¨ä¸€ä¸ªæ•°æ®ä¼ è¾“æœåŠ¡ã€‚</strong></p><p>å…·ä½“åšæ³•æ˜¯ï¼šsidecarå®¹å™¨ä¼šä½¿ç”¨ncatå‘½ä»¤å¯åŠ¨ä¸€ä¸ªå·¥ä½œåœ¨3307ç«¯å£ä¸Šçš„ç½‘ç»œå‘é€æœåŠ¡ã€‚ä¸€æ—¦æ”¶åˆ°æ•°æ®ä¼ è¾“è¯·æ±‚æ—¶ï¼Œsidecarå®¹å™¨å°±ä¼šè°ƒç”¨xtrabackup --backupæŒ‡ä»¤å¤‡ä»½å½“å‰MySQLçš„æ•°æ®ï¼Œç„¶åæŠŠè¿™äº›å¤‡ä»½æ•°æ®è¿”å›ç»™è¯·æ±‚è€…ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨InitContaineré‡Œå®šä¹‰æ•°æ®æ‹·è´çš„æ—¶å€™ï¼Œè®¿é—®çš„æ˜¯â€œä¸Šä¸€ä¸ªMySQLèŠ‚ç‚¹â€çš„3307ç«¯å£ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºsidecarå®¹å™¨å’ŒMySQLå®¹å™¨åŒå¤„äºä¸€ä¸ªPodé‡Œï¼Œæ‰€ä»¥å®ƒæ˜¯ç›´æ¥é€šè¿‡Localhostæ¥è®¿é—®å’Œå¤‡ä»½MySQLå®¹å™¨é‡Œçš„æ•°æ®çš„ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><p>åŒæ ·åœ°ï¼Œæˆ‘åœ¨è¿™é‡Œä¸¾ä¾‹ç”¨çš„åªæ˜¯ä¸€ç§å¤‡ä»½æ–¹æ³•è€Œå·²ï¼Œä½ å®Œå…¨å¯ä»¥é€‰æ‹©å…¶ä»–è‡ªå·±å–œæ¬¢çš„æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨innobackupexå‘½ä»¤åšæ•°æ®å¤‡ä»½å’Œå‡†å¤‡ï¼Œå®ƒçš„ä½¿ç”¨æ–¹æ³•å‡ ä¹ä¸æœ¬æ–‡çš„å¤‡ä»½æ–¹æ³•ä¸€æ ·ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå°±ç¿»è¶Šäº†â€œç¬¬ä¸‰åº§å¤§å±±â€ï¼Œå®Œæˆäº†SlaveèŠ‚ç‚¹ç¬¬ä¸€æ¬¡å¯åŠ¨å‰çš„åˆå§‹åŒ–å·¥ä½œã€‚</p><p>æ‰³å€’äº†è¿™â€œä¸‰åº§å¤§å±±â€åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥å®šä¹‰Podé‡Œçš„ä¸»è§’ï¼ŒMySQLå®¹å™¨äº†ã€‚æœ‰äº†å‰é¢è¿™äº›å®šä¹‰å’Œåˆå§‹åŒ–å·¥ä½œï¼ŒMySQLå®¹å™¨æœ¬èº«çš„å®šä¹‰å°±éå¸¸ç®€å•äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>      ...\n      # template.spec\n      containers:\n      - name: mysql\n        image: mysql:5.7\n        env:\n        - name: MYSQL_ALLOW_EMPTY_PASSWORD\n          value: &quot;1&quot;\n        ports:\n        - name: mysql\n          containerPort: 3306\n        volumeMounts:\n        - name: data\n          mountPath: /var/lib/mysql\n          subPath: mysql\n        - name: conf\n          mountPath: /etc/mysql/conf.d\n        resources:\n          requests:\n            cpu: 500m\n            memory: 1Gi\n        livenessProbe:\n          exec:\n            command: [&quot;mysqladmin&quot;, &quot;ping&quot;]\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          exec:\n            # é€šè¿‡TCPè¿æ¥çš„æ–¹å¼è¿›è¡Œå¥åº·æ£€æŸ¥\n            command: [&quot;mysql&quot;, &quot;-h&quot;, &quot;127.0.0.1&quot;, &quot;-e&quot;, &quot;SELECT 1&quot;]\n          initialDelaySeconds: 5\n          periodSeconds: 2\n          timeoutSeconds: 1\n</code></pre><p>åœ¨è¿™ä¸ªå®¹å™¨çš„å®šä¹‰é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ ‡å‡†çš„MySQL 5.7 çš„å®˜æ–¹é•œåƒã€‚å®ƒçš„æ•°æ®ç›®å½•æ˜¯/var/lib/mysqlï¼Œé…ç½®æ–‡ä»¶ç›®å½•æ˜¯/etc/mysql/conf.dã€‚</p><p>è¿™æ—¶å€™ï¼Œä½ åº”è¯¥èƒ½å¤Ÿæ˜ç™½ï¼Œå¦‚æœMySQLå®¹å™¨æ˜¯SlaveèŠ‚ç‚¹çš„è¯ï¼Œå®ƒçš„æ•°æ®ç›®å½•é‡Œçš„æ•°æ®ï¼Œå°±æ¥è‡ªäºInitContainerä»å…¶ä»–èŠ‚ç‚¹é‡Œæ‹·è´è€Œæ¥çš„å¤‡ä»½ã€‚å®ƒçš„é…ç½®æ–‡ä»¶ç›®å½•/etc/mysql/conf.dé‡Œçš„å†…å®¹ï¼Œåˆ™æ¥è‡ªäºConfigMapå¯¹åº”çš„Volumeã€‚è€Œå®ƒçš„åˆå§‹åŒ–å·¥ä½œï¼Œåˆ™æ˜¯ç”±åŒä¸€ä¸ªPodé‡Œçš„sidecarå®¹å™¨å®Œæˆçš„ã€‚è¿™äº›æ“ä½œï¼Œæ­£æ˜¯æˆ‘åˆšåˆšä¸ºä½ è®²è¿°çš„å¤§éƒ¨åˆ†å†…å®¹ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬ä¸ºå®ƒå®šä¹‰äº†ä¸€ä¸ªlivenessProbeï¼Œé€šè¿‡mysqladmin pingå‘½ä»¤æ¥æ£€æŸ¥å®ƒæ˜¯å¦å¥åº·ï¼›è¿˜å®šä¹‰äº†ä¸€ä¸ªreadinessProbeï¼Œé€šè¿‡æŸ¥è¯¢SQLï¼ˆselect 1ï¼‰æ¥æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦å¯ç”¨ã€‚å½“ç„¶ï¼Œå‡¡æ˜¯readinessProbeæ£€æŸ¥å¤±è´¥çš„MySQL Podï¼Œéƒ½ä¼šä»Serviceé‡Œè¢«æ‘˜é™¤æ‰ã€‚</p><p>è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„ä¸»ä»å¤åˆ¶æ¨¡å¼çš„MySQLé›†ç¾¤å°±å®šä¹‰å®Œäº†ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨kubectlå‘½ä»¤ï¼Œå°è¯•è¿è¡Œä¸€ä¸‹è¿™ä¸ªStatefulSetäº†ã€‚</p><p><strong>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨Kubernetesé›†ç¾¤é‡Œåˆ›å»ºæ»¡è¶³æ¡ä»¶çš„PV</strong>ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯æˆ‘ä»¬åœ¨ç¬¬11ç¯‡æ–‡ç« ã€Š<a href=\"https://time.geekbang.org/column/article/39724\">ä»0åˆ°1ï¼šæ­å»ºä¸€ä¸ªå®Œæ•´çš„Kubernetesé›†ç¾¤ã€‹</a>é‡Œéƒ¨ç½²çš„Kubernetesé›†ç¾¤çš„è¯ï¼Œä½ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä½¿ç”¨å­˜å‚¨æ’ä»¶Rookï¼š</p><pre><code>$ kubectl create -f rook-storage.yaml\n$ cat rook-storage.yaml\napiVersion: ceph.rook.io/v1beta1\nkind: Pool\nmetadata:\n  name: replicapool\n  namespace: rook-ceph\nspec:\n  replicated:\n    size: 3\n---\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: rook-ceph-block\nprovisioner: ceph.rook.io/block\nparameters:\n  pool: replicapool\n  clusterNamespace: rook-ceph\n</code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ç”¨åˆ°äº†StorageClassæ¥å®Œæˆè¿™ä¸ªæ“ä½œã€‚å®ƒçš„ä½œç”¨ï¼Œæ˜¯è‡ªåŠ¨åœ°ä¸ºé›†ç¾¤é‡Œå­˜åœ¨çš„æ¯ä¸€ä¸ªPVCï¼Œè°ƒç”¨å­˜å‚¨æ’ä»¶ï¼ˆRookï¼‰åˆ›å»ºå¯¹åº”çš„PVï¼Œä»è€Œçœå»äº†æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºPVçš„æœºæ¢°åŠ³åŠ¨ã€‚æˆ‘åœ¨åç»­è®²è§£å®¹å™¨å­˜å‚¨çš„æ—¶å€™ï¼Œä¼šå†è¯¦ç»†ä»‹ç»è¿™ä¸ªæœºåˆ¶ã€‚</p><blockquote>\n<p>å¤‡æ³¨ï¼šåœ¨ä½¿ç”¨Rookçš„æƒ…å†µä¸‹ï¼Œmysql-statefulset.yamlé‡Œçš„volumeClaimTemplateså­—æ®µéœ€è¦åŠ ä¸Šå£°æ˜storageClassName=rook-ceph-blockï¼Œæ‰èƒ½ä½¿ç”¨åˆ°è¿™ä¸ªRookæä¾›çš„æŒä¹…åŒ–å­˜å‚¨ã€‚</p>\n</blockquote><p><strong>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºè¿™ä¸ªStatefulSetäº†</strong>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>$ kubectl create -f mysql-statefulset.yaml\n$ kubectl get pod -l app=mysql\nNAME      READY     STATUS    RESTARTS   AGE\nmysql-0   2/2       Running   0          2m\nmysql-1   2/2       Running   0          1m\nmysql-2   2/2       Running   0          1m\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒStatefulSetå¯åŠ¨æˆåŠŸåï¼Œä¼šæœ‰ä¸‰ä¸ªPodè¿è¡Œã€‚</p><p><strong>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å‘è¿™ä¸ªMySQLé›†ç¾¤å‘èµ·è¯·æ±‚ï¼Œæ‰§è¡Œä¸€äº›SQLæ“ä½œæ¥éªŒè¯å®ƒæ˜¯å¦æ­£å¸¸ï¼š</strong></p><pre><code>$ kubectl run mysql-client --image=mysql:5.7 -i --rm --restart=Never --\\\n  mysql -h mysql-0.mysql &lt;&lt;EOF\nCREATE DATABASE test;\nCREATE TABLE test.messages (message VARCHAR(250));\nINSERT INTO test.messages VALUES ('hello');\nEOF\n</code></pre><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬é€šè¿‡å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œä½¿ç”¨MySQL clientæ‰§è¡Œäº†åˆ›å»ºæ•°æ®åº“å’Œè¡¨ã€ä»¥åŠæ’å…¥æ•°æ®çš„æ“ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¿æ¥çš„MySQLçš„åœ°å€å¿…é¡»æ˜¯mysql-0.mysqlï¼ˆå³ï¼šMasterèŠ‚ç‚¹çš„DNSè®°å½•ï¼‰ã€‚å› ä¸ºï¼Œåªæœ‰MasterèŠ‚ç‚¹æ‰èƒ½å¤„ç†å†™æ“ä½œã€‚</p><p>è€Œé€šè¿‡è¿æ¥mysql-readè¿™ä¸ªServiceï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨SQLè¿›è¡Œè¯»æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>$ kubectl run mysql-client --image=mysql:5.7 -i -t --rm --restart=Never --\\\n mysql -h mysql-read -e &quot;SELECT * FROM test.messages&quot;\nWaiting for pod default/mysql-client to be running, status is Pending, pod ready: false\n+---------+\n| message |\n+---------+\n| hello   |\n+---------+\npod &quot;mysql-client&quot; deleted\n</code></pre><p>åœ¨æœ‰äº†StatefulSetä»¥åï¼Œä½ å°±å¯ä»¥åƒDeploymenté‚£æ ·ï¼Œéå¸¸æ–¹ä¾¿åœ°æ‰©å±•è¿™ä¸ªMySQLé›†ç¾¤ï¼Œæ¯”å¦‚ï¼š</p><pre><code>$ kubectl scale statefulset mysql  --replicas=5\n</code></pre><p>è¿™æ—¶å€™ï¼Œä½ å°±ä¼šå‘ç°æ–°çš„Slave Pod mysql-3å’Œmysql-4è¢«è‡ªåŠ¨åˆ›å»ºäº†å‡ºæ¥ã€‚</p><p>è€Œå¦‚æœä½ åƒå¦‚ä¸‹æ‰€ç¤ºçš„è¿™æ ·ï¼Œç›´æ¥è¿æ¥mysql-3.mysqlï¼Œå³mysql-3è¿™ä¸ªPodçš„DNSåå­—æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼š</p><pre><code>$ kubectl run mysql-client --image=mysql:5.7 -i -t --rm --restart=Never --\\\n  mysql -h mysql-3.mysql -e &quot;SELECT * FROM test.messages&quot;\nWaiting for pod default/mysql-client to be running, status is Pending, pod ready: false\n+---------+\n| message |\n+---------+\n| hello   |\n+---------+\npod &quot;mysql-client&quot; deleted\n</code></pre><p>å°±ä¼šçœ‹åˆ°ï¼Œä»StatefulSetä¸ºæˆ‘ä»¬æ–°åˆ›å»ºçš„mysql-3ä¸Šï¼ŒåŒæ ·å¯ä»¥è¯»å–åˆ°ä¹‹å‰æ’å…¥çš„è®°å½•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„æ•°æ®å¤‡ä»½å’Œæ¢å¤ï¼Œéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¥MySQLé›†ç¾¤ä¸ºä¾‹ï¼Œå’Œä½ è¯¦ç»†åˆ†äº«äº†ä¸€ä¸ªå®é™…çš„StatefulSetçš„ç¼–å†™è¿‡ç¨‹ã€‚è¿™ä¸ªYAMLæ–‡ä»¶çš„<a href=\"https://kubernetes.io/docs/tasks/run-application/run-replicated-stateful-application/#statefulset\">é“¾æ¥åœ¨è¿™é‡Œ</a>ï¼Œå¸Œæœ›ä½ èƒ½å¤šèŠ±ä¸€äº›æ—¶é—´è®¤çœŸæ¶ˆåŒ–ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼ˆå‘ï¼‰ç‰¹åˆ«å€¼å¾—ä½ æ³¨æ„å’Œä½“ä¼šã€‚</p><ol>\n<li>\n<p>â€œäººæ ¼åˆ†è£‚â€ï¼šåœ¨è§£å†³éœ€æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šè¦è®°å¾—æ€è€ƒï¼Œè¯¥Podåœ¨æ‰®æ¼”ä¸åŒè§’è‰²æ—¶çš„ä¸åŒæ“ä½œã€‚</p>\n</li>\n<li>\n<p>â€œé˜…åå³ç„šâ€ï¼šå¾ˆå¤šâ€œæœ‰çŠ¶æ€åº”ç”¨â€çš„èŠ‚ç‚¹ï¼Œåªæ˜¯åœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™æ‰éœ€è¦åšé¢å¤–å¤„ç†ã€‚æ‰€ä»¥ï¼Œåœ¨ç¼–å†™YAMLæ–‡ä»¶æ—¶ï¼Œä½ ä¸€å®šè¦è€ƒè™‘â€œå®¹å™¨é‡å¯â€çš„æƒ…å†µï¼Œä¸è¦è®©è¿™ä¸€æ¬¡çš„æ“ä½œå¹²æ‰°åˆ°ä¸‹ä¸€æ¬¡çš„å®¹å™¨å¯åŠ¨ã€‚</p>\n</li>\n<li>\n<p>â€œå®¹å™¨ä¹‹é—´å¹³ç­‰æ— åºâ€ï¼šé™¤éæ˜¯InitContainerï¼Œå¦åˆ™ä¸€ä¸ªPodé‡Œçš„å¤šä¸ªå®¹å™¨ä¹‹é—´ï¼Œæ˜¯å®Œå…¨å¹³ç­‰çš„ã€‚æ‰€ä»¥ï¼Œä½ ç²¾å¿ƒè®¾è®¡çš„sidecarï¼Œç»ä¸èƒ½å¯¹å®¹å™¨çš„é¡ºåºåšå‡ºå‡è®¾ï¼Œå¦åˆ™å°±éœ€è¦è¿›è¡Œå‰ç½®æ£€æŸ¥ã€‚</p>\n</li>\n</ol><p>æœ€åï¼Œç›¸ä¿¡ä½ ä¹Ÿå·²ç»èƒ½å¤Ÿç†è§£ï¼ŒStatefulSetå…¶å®æ˜¯ä¸€ç§ç‰¹æ®Šçš„Deploymentï¼Œåªä¸è¿‡è¿™ä¸ªâ€œDeploymentâ€çš„æ¯ä¸ªPodå®ä¾‹çš„åå­—é‡Œï¼Œéƒ½æºå¸¦äº†ä¸€ä¸ªå”¯ä¸€å¹¶ä¸”å›ºå®šçš„ç¼–å·ã€‚è¿™ä¸ªç¼–å·çš„é¡ºåºï¼Œå›ºå®šäº†Podçš„æ‹“æ‰‘å…³ç³»ï¼›è¿™ä¸ªç¼–å·å¯¹åº”çš„DNSè®°å½•ï¼Œå›ºå®šäº†Podçš„è®¿é—®æ–¹å¼ï¼›è¿™ä¸ªç¼–å·å¯¹åº”çš„PVï¼Œç»‘å®šäº†Podä¸æŒä¹…åŒ–å­˜å‚¨çš„å…³ç³»ã€‚æ‰€ä»¥ï¼Œå½“Podè¢«åˆ é™¤é‡å»ºæ—¶ï¼Œè¿™äº›â€œçŠ¶æ€â€éƒ½ä¼šä¿æŒä¸å˜ã€‚</p><p>è€Œä¸€æ—¦ä½ çš„åº”ç”¨æ²¡åŠæ³•é€šè¿‡ä¸Šè¿°æ–¹å¼è¿›è¡ŒçŠ¶æ€çš„ç®¡ç†ï¼Œé‚£å°±ä»£è¡¨äº†StatefulSetå·²ç»ä¸èƒ½è§£å†³å®ƒçš„éƒ¨ç½²é—®é¢˜äº†ã€‚è¿™æ—¶å€™ï¼Œæˆ‘åé¢è®²åˆ°çš„Operatorï¼Œå¯èƒ½æ‰æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¦‚æœæˆ‘ä»¬ç°åœ¨çš„éœ€æ±‚æ˜¯ï¼šæ‰€æœ‰çš„è¯»è¯·æ±‚ï¼Œåªç”±SlaveèŠ‚ç‚¹å¤„ç†ï¼›æ‰€æœ‰çš„å†™è¯·æ±‚ï¼Œåªç”±MasterèŠ‚ç‚¹å¤„ç†ã€‚é‚£ä¹ˆï¼Œä½ éœ€è¦åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« çš„åŸºç¡€ä¸Šå†åšå“ªäº›æ”¹åŠ¨å‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p>","neighbors":{"left":{"article_title":"19 | æ·±å…¥ç†è§£StatefulSetï¼ˆäºŒï¼‰ï¼šå­˜å‚¨çŠ¶æ€","id":41154},"right":{"article_title":"21 | å®¹å™¨åŒ–å®ˆæŠ¤è¿›ç¨‹çš„æ„ä¹‰ï¼šDaemonSet","id":41366}},"comments":[{"had_liked":false,"id":30682,"user_name":"Vincen","can_delete":false,"product_type":"c1","uid":1218185,"ip_address":"","ucode":"1029A901EC7BA0","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/89/9312b3a2.jpg","comment_is_top":false,"comment_ctime":1538973296,"is_pvip":false,"replies":[{"id":"11062","content":"æ²¡é”™ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ€è·¯","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998732,"ip_address":"","comment_id":30682,"utype":1}],"discussion_count":11,"race_medal":0,"score":"461100473968","product_id":100015201,"comment_content":"å› ä¸ºæ˜¯é€šè¿‡ä¸€ä¸ªstatefulsetæ¥å®ç°çš„ æ„Ÿè§‰å¤ªå¤æ‚äº†ï¼Œmasterå’Œslaveåšæˆä¸¤ä¸ªstatefulsetå°±éå¸¸ç®€å•äº†","like_count":108,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426067,"discussion_content":"æ²¡é”™ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1702769,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTImicSGGrnTWbXu3snxpYJ1yMGhtwckV3sZq7K1YmscXxDBj2YOTGPA9t5hicGiaJjx3Zvm7ibickGynzg/132","nickname":"æ­¦ç¥","note":"","ucode":"EB424DA42D52B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399073,"discussion_content":"ä¸¤ä¸ªstatefulsetç¡®å®ç®€å•å¾ˆå¤šã€‚è€Œä¸”å…ˆåé¡ºåºä¹Ÿå®¹æ˜“æ§åˆ¶ã€‚slaveçš„statefulsetå†åŠ ä¸Šä¸€ä¸ªinitContainerå°±è¡Œäº†ï¼Œè¿™ä¸ªinitContaineråšpingæ“ä½œï¼šuntil nslookup mysql-master; do echo waiting for mysql-master; sleep 1; done;","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1632901873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1302286,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoTiazkXvN29ebN6eotq8xu2pUGbQkrOduwBQsXmicsMBKl9qbfoggjBPacaIgk44zsjxlpbBgOcdaQ/132","nickname":"éª‘èœ—ç‰›ä¸Šé«˜é€Ÿ","note":"","ucode":"36648D52A76CF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":313035,"discussion_content":"ä¸¤ä¸ªstatefullsetçœŸæ˜¯ä¸ªå¥½æ€è·¯ï½æ¯”æ–‡ç« ä¸­çš„éƒ¨ç½²è¿‡ç¨‹åº”è¯¥ç®€å•ï¼Œæ›´å¥½ç†è§£ï½","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602917709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"ä¸ç»æ„é—´","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533406,"discussion_content":"å¦‚æœå°±ä¸€ä¸»ä¸€ä»ï¼Œä¸¤ä¸ªdeployå°±å¯ä»¥å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637852647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1298139,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","nickname":"ç‹      æ…ˆ","note":"","ucode":"EACC3D086674D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351037,"discussion_content":"ä¸¤ä¸ªçš„è¯slaveé›†ç¾¤å¯ä»¥ç”¨deploymentå—ï¼Ÿæ„Ÿè§‰æ²¡å•¥çŠ¶æ€éœ€è¦ç»´æŠ¤äº†ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614129781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1740409,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8e/79/f9d5dd3a.jpg","nickname":"å•è¶…","note":"","ucode":"B36883984BE16B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1298139,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ce/db/bb1821b3.jpg","nickname":"ç‹      æ…ˆ","note":"","ucode":"EACC3D086674D8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352562,"discussion_content":"slaveæœ‰å­˜å‚¨çŠ¶æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614770904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":351037,"ip_address":""},"score":352562,"extra":""}]},{"author":{"id":1066577,"avatar":"https://static001.geekbang.org/account/avatar/00/10/46/51/50457315.jpg","nickname":"å“—ä¸½è½¬èº«","note":"","ucode":"AF59F8211115DD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347465,"discussion_content":"2ä¸ªçš„è¯è„šæœ¬æ›´ç®€å•ç‹¬ç«‹ï¼Œç¼ºç‚¹æ˜¯ä¾èµ–masterå…ˆå¯åŠ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612237255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1497162,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d8/4a/99ba04cc.jpg","nickname":"æ°","note":"","ucode":"8C6AE6374E77B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334769,"discussion_content":"å¦‚æœåšæˆä¸¤ä¸ªstatefullsetçš„è¯å¯èƒ½ä¹Ÿä¼šæœ‰ä¸€äº›å±€é™å§ï¼Œæ¯”å¦‚æ²¡åŠæ³•æ§åˆ¶å¯åŠ¨çš„æ—¶å€™éƒ½æ˜¯masterå…ˆå¯åŠ¨ã€‚ å¦‚æœå¸Œæœ›å¯¹masterå’Œslaveåšåäº²å’Œä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607962869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1109528,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/18/65e89d9c.jpg","nickname":"ç‹å¤§å–µ","note":"","ucode":"C14AAE3ED964DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1497162,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d8/4a/99ba04cc.jpg","nickname":"æ°","note":"","ucode":"8C6AE6374E77B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574002,"discussion_content":"å¥½å¥½çœ‹ä¸‹ æ­¦ç¥ çš„è¯„è®ºï¼Œå’Œè€å¸ˆè¯´çš„â€œå®¹å™¨ä¹‹é—´å¹³ç­‰æ— åºâ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653792765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":334769,"ip_address":""},"score":574002,"extra":""}]},{"author":{"id":1198816,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4a/e0/eff34583.jpg","nickname":"é©¬è¶…","note":"","ucode":"FAFF55DC5DD15C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40745,"discussion_content":"å¯¹çš„ï¼Œå¯ä»¥çœå»å¾ˆå¤špodç¼–å·çš„åˆ¤æ–­åˆ†æ”¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572264810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"æ™æœˆ520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1198816,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4a/e0/eff34583.jpg","nickname":"é©¬è¶…","note":"","ucode":"FAFF55DC5DD15C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302375,"discussion_content":"ä½ ä»¬æ˜¯å†™æˆä¸¤ä¸ªstatefullå—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598889186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":40745,"ip_address":""},"score":302375,"extra":""}]}]},{"had_liked":false,"id":167956,"user_name":"å·´è¥¿","can_delete":false,"product_type":"c1","uid":1119116,"ip_address":"","ucode":"6E68AA02011541","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/8c/c86340ca.jpg","comment_is_top":false,"comment_ctime":1577969161,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"358060254729","product_id":100015201,"comment_content":"ä¿¡æ¯é‡å¤ªå¤§,å®¹æˆ‘å†·é™ä¸€ä¸‹","like_count":84,"discussions":[{"author":{"id":1934785,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Pu41KPIhAp72l0N7kOFL738owSAIT5EyH0oUUMacQRWzeFV77QDjSDNTSFNvjNZib1myibvxAfQAsAY5KzsIia73w/132","nickname":"ç‹é¹","note":"","ucode":"B79003C125BE00","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575446,"discussion_content":"åŒæ ·ï¼Œæœ‰ç‚¹å¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654841185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1152145,"avatar":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","nickname":"æ€€è‰è¯—","note":"","ucode":"78F8B9B4628F15","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555596,"discussion_content":"çœ‹å¾—æˆ‘æœ‰ç‚¹è¢«åŠé€€ğŸ˜‚ğŸ˜‚ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646985044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2147220,"avatar":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","nickname":"ç¥æ¯“é€é¥","note":"","ucode":"83351CB18B190E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":415317,"discussion_content":"çœ‹çš„å¤´æ™•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637054101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31136,"user_name":"DJH","can_delete":false,"product_type":"c1","uid":1256740,"ip_address":"","ucode":"2BDEF123B3DB6A","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/24/28acca15.jpg","comment_is_top":false,"comment_ctime":1539101627,"is_pvip":false,"replies":[{"id":"11215","content":"sidecaræ˜¯å¸¸é©»è¿›ç¨‹ï¼Œè¦ç›‘å¬3370ç«¯å£å‘¢ã€‚ä¸€ä¸ªå®¹å™¨é‡Œæ˜¾ç„¶æ²¡åŠæ³•ç®¡ç†ä¸¤ä¸ªå¸¸é©»è¿›ç¨‹ï¼Œè¿™å°±æ˜¯å®¹å™¨æ˜¯å•è¿›ç¨‹çš„æ„æ€å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539131929,"ip_address":"","comment_id":31136,"utype":1}],"discussion_count":4,"race_medal":0,"score":"173337793467","product_id":100015201,"comment_content":"æœ‰ä¸€ç‚¹æˆ‘è¿˜æ˜¯æ²¡æƒ³é€šï¼Œä¸ºå•¥æ•°æ®å¤åˆ¶æ“ä½œè¦ç”¨sidecarå®¹å™¨æ¥å¤„ç†ï¼Œè€Œä¸ç”¨mysqlä¸»å®¹å™¨æ¥ä¸€å¹¶è§£å†³ã€‚å¦‚æœæŠŠæ•°æ®å¤åˆ¶æ“ä½œå’Œå¯åŠ¨mysqlæœåŠ¡ä¸€å¹¶å†™åˆ°åŒä¸€ä¸ªsh -cåé¢ï¼Œè¿™æ ·ç®—ä¸ç®—ä¸€ä¸ªå•ä¸€è¿›ç¨‹å‘¢ï¼Ÿ","like_count":41,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426245,"discussion_content":"sidecaræ˜¯å¸¸é©»è¿›ç¨‹ï¼Œè¦ç›‘å¬3370ç«¯å£å‘¢ã€‚ä¸€ä¸ªå®¹å™¨é‡Œæ˜¾ç„¶æ²¡åŠæ³•ç®¡ç†ä¸¤ä¸ªå¸¸é©»è¿›ç¨‹ï¼Œè¿™å°±æ˜¯å®¹å™¨æ˜¯å•è¿›ç¨‹çš„æ„æ€å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539131929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1352415,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/YD1RqdHwfuNHSot5OcjlNhWiatJLmlhF47sUiczmzo0znLYvOpssdsqdlGKjUenXJzTG4eBR0bIJkJeUTibQ04Yqw/132","nickname":"jking","note":"","ucode":"05611E2DC82125","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577568,"discussion_content":"M","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656208059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109528,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/18/65e89d9c.jpg","nickname":"ç‹å¤§å–µ","note":"","ucode":"C14AAE3ED964DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574003,"discussion_content":"sidecarä¹Ÿè¦æ¥æ¥æ”¶ å…¶ä»–slaveçš„å¤‡ä»½æ•°æ®ä¼ è¾“çš„è¯·æ±‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653792821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531048,"discussion_content":"Mark.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637212379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33668,"user_name":"å½­é”","can_delete":false,"product_type":"c1","uid":1179669,"ip_address":"","ucode":"F2CB53DE42026D","user_header":"https://static001.geekbang.org/account/avatar/00/12/00/15/6e399ec7.jpg","comment_is_top":false,"comment_ctime":1539849532,"is_pvip":false,"replies":[{"id":"12103","content":"æ²¡é”™ã€‚ä½ è¯´çš„è¿™ç§æƒ…å†µå¾—ç”¨operatorï¼Œåé¢ä¼šè®²ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539868346,"ip_address":"","comment_id":33668,"utype":1}],"discussion_count":3,"race_medal":0,"score":"121798933820","product_id":100015201,"comment_content":"è¿™æ ·çš„æœ‰çŠ¶æ€åº”ç”¨æœ‰ä¸ªçº¦æŸï¼Œpodæ ‡è¯†ä¸€æ—¦ç¡®å®šï¼Œè§’è‰²å°±ç¡®å®šäº†ã€‚ä½†å®é™…åº”ç”¨ä¸­ï¼Œä¸èƒ½æœ‰è¿™æ ·çš„çº¦æŸï¼Œä¸»æŒ‚äº†ï¼Œè¦æœ‰ä¸€ä¸ªä»å‡ä¸»ã€‚è¿™å°±è¦æ±‚è‡³å°‘æœ‰é€‰ä¸»æœºåˆ¶ï¼Œæ‰€æœ‰çš„é…ç½®æ–‡ä»¶ä¹Ÿä¸èƒ½ä¾èµ–idç¡®å®šè§’è‰²ã€‚<br>è¿™æ€ä¹ˆç©å‘¢ï¼Ÿoperaterå—ï¼Ÿoperaterå¯ä»¥çœ‹æˆä¸€ä¸ªç‰¹å®šåº”ç”¨çš„sreä¿å§†å—ï¼Ÿ","like_count":29,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427025,"discussion_content":"æ²¡é”™ã€‚ä½ è¯´çš„è¿™ç§æƒ…å†µå¾—ç”¨operatorï¼Œåé¢ä¼šè®²ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539868346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300547,"discussion_content":"ä¸»æŒ‚äº†ï¼Œk8sä¼šè‡ªåŠ¨åˆ›å»ºæ–°podåšä¸»ï¼Œå°±ä¸ç”¨ä»€ä¹ˆé€‰ä¸¾äº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1598167712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1643296,"avatar":"https://static001.geekbang.org/account/avatar/00/19/13/20/2d22b331.jpg","nickname":"H.Z","note":"","ucode":"728417BD5B4DA8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":306130,"discussion_content":"ä¾èµ–K8Sé‡å¯masterçš„Podï¼Œæ„Ÿè§‰ä¼šæœ‰ä¸€ä¸ªéšæ‚£ï¼Œå¦‚æœå› ä¸ºèŠ‚ç‚¹åŸå› ä¸€ç›´é‡å¯å¤±è´¥ï¼Œæˆ–è€…é‡å¯æ—¶é—´æ¯”é€‰ä¸¾æ—¶é—´é•¿å¾ˆå¤šï¼Œä¸šåŠ¡æ˜¯å¦ä¼šé•¿æ—¶é—´ç»ˆæ­¢ã€‚ç”¨é€‰ä¸¾æœºåˆ¶çš„è¯ï¼Œç›´æ¥å°†ä¸€ä¸ªæ­£åœ¨æ­£å¸¸è¿è¡Œçš„Podé€‰ä¸¾ä¸ºmasterï¼Œæ˜¯å¦ä¼šæ›´å¥½ä¸€äº›ã€‚","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1600177951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300547,"ip_address":""},"score":306130,"extra":""}]}]},{"had_liked":false,"id":123983,"user_name":"sam700000","can_delete":false,"product_type":"c1","uid":1069133,"ip_address":"","ucode":"C2ABDDC56B2D50","user_header":"https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg","comment_is_top":false,"comment_ctime":1565787957,"is_pvip":true,"replies":[{"id":"46506","content":"è¯´çš„å¯¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1566350958,"ip_address":"","comment_id":123983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"117529904949","product_id":100015201,"comment_content":"é€šè¿‡è¿™èŠ‚æˆ‘æ‰æ›´æ¸…æ™°ç†è§£äº†ï¼Œkubernetesæœ€å°çš„ç®¡ç†å•ä½æ˜¯podçš„æ¦‚å¿µï¼ŒæŠŠæ€ç»´ä»å®¹å™¨è¿™å±‚æŠ½å‡ºæ¥ã€‚ç„¶åä¹Ÿæ›´æ¸…æ¥šçš„ç†è§£äº†statefulsetå®ç°æœ‰çŠ¶æ€ï¼Œå°±æ˜¯æŠŠç‰¹å®šçš„çŠ¶æ€é…ç½®ç»‘å®šåœ¨æŸä¸ªå¯¹è±¡åç§°ä¸Šé¢ï¼Œç„¶åé€šè¿‡ä¹‹å‰è¯´çš„æ§åˆ¶å¾ªç¯ä¸æ–­çš„ç»´æŠ¤è¿™ä¸ªå¯¹è±¡çš„ç‰¹æ€§ï¼Œåªè¦è¿™å†™ç‰¹å®šå¯¹è±¡å’Œå®ƒä»¬å„è‡ªç»‘å®šçš„çŠ¶æ€é…ç½®ä¸å˜å°±å®ç°äº†æœ‰çŠ¶æ€çš„åº”ç”¨éƒ¨ç½²å’Œç»´æŠ¤ã€‚æœç„¶å®è·µå‡ºçœŸçŸ¥ğŸ‘","like_count":28,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462939,"discussion_content":"è¯´çš„å¯¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566350958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55074,"user_name":"é»„ä¿Š","can_delete":false,"product_type":"c1","uid":1226759,"ip_address":"","ucode":"183229074B38AE","user_header":"https://static001.geekbang.org/account/avatar/00/12/b8/07/ef28a5f7.jpg","comment_is_top":false,"comment_ctime":1546026370,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"113215176066","product_id":100015201,"comment_content":"error: unable to recognize &quot;rook-storage.yaml&quot;: no matches for kind &quot;Pool&quot; in version &quot;ceph.rook.io&#47;v1&quot;<br><br>åº”è¯¥æ˜¯rookæ–°ç‰ˆæœ¬çš„é—®é¢˜ï¼Œrook-storage.yaml æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªä½ç½®éœ€è¦ä¿®æ”¹ã€‚<br><br>apiVersion: ceph.rook.io&#47;v1<br>kind: CephBlockPool<br>","like_count":27,"discussions":[{"author":{"id":1705468,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/05/fc/bceb3f2b.jpg","nickname":"å¼€å¿ƒå“¥","note":"","ucode":"D44C1F03B23C5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291846,"discussion_content":"æäº†å‡ ä¸ªé’Ÿï¼ŒåŸæ¥ç­”æ¡ˆå°±åœ¨æ­¤æ¥¼ã€‚æ‹œè°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594972303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226752,"user_name":"wenxuan","can_delete":false,"product_type":"c1","uid":1171262,"ip_address":"","ucode":"36840291028D94","user_header":"https://static001.geekbang.org/account/avatar/00/11/df/3e/718d6f1b.jpg","comment_is_top":false,"comment_ctime":1592195068,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"66016704508","product_id":100015201,"comment_content":"å…³äºæ€è€ƒæçš„è§£å†³æ–¹æ¡ˆï¼Œæœ‰å›ç­”æåˆ°å¯ä»¥é€šè¿‡åˆ›å»ºmysql-readå’Œmysql-writeä¸¤ä¸ªserviceï¼Œç”¨ä¸åŒçš„labelæ¥åˆ†åˆ«ç­›é€‰ä¸»ä»ã€‚æˆ‘è§‰å¾—è¿™é‡Œé¢å¿½ç•¥äº†ä¸€ç‚¹ï¼Œå³ä½¿æ˜¯StatefulSetï¼Œå„ä¸ªå‰¯æœ¬çš„metadataä¹Ÿæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œä¸å¯èƒ½åšåˆ°ç»™ä¸»ä»èŠ‚ç‚¹æ‰“ä¸Šä¸åŒçš„æ ‡ç­¾ã€‚ä¸»ä»åˆ†ä¸¤ä¸ªStatefulSetéƒ¨ç½²å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†åˆå¼•å…¥äº†éœ€è¦äººä¸ºæ§åˆ¶ä¸¤ä¸ªStagefulSetå¯åŠ¨é¡ºåºçš„é—®é¢˜ã€‚<br>å…¶å®æˆ‘è§‰å¾—åº”è¯¥å¯ä»¥ä¿®æ”¹mysqlçš„å¯åŠ¨å‚æ•°ï¼Œè®©masterå®¹å™¨å’Œslaveå®¹å™¨ç›‘å¬åœ¨ä¸åŒçš„ç«¯å£ï¼Œç„¶ååˆ†åˆ«åˆ›å»ºreadå’Œwriteä¸¤ä¸ªsvcï¼Œç»‘å®šä¸åŒçš„ç«¯å£ã€‚ç”±äºsvcä¼šæŠŠreadinessæ¢é’ˆå¤±è´¥çš„podå‰”å‡ºå»ï¼Œæ‰€ä»¥å°±è¾¾åˆ°read svcåªæœ‰slaveèŠ‚ç‚¹ï¼Œè€Œwrite svcåªæœ‰masterèŠ‚ç‚¹çš„ç›®çš„ã€‚","like_count":15,"discussions":[{"author":{"id":2291160,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg","nickname":"Woa ğŸ¤","note":"","ucode":"6033F496082F3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545950,"discussion_content":"æ‚¨å°±æ˜¯é­”æ”¹å¤§ç‰›ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642089522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1171262,"avatar":"https://static001.geekbang.org/account/avatar/00/11/df/3e/718d6f1b.jpg","nickname":"wenxuan","note":"","ucode":"36840291028D94","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379605,"discussion_content":"ä¸€å¹´å‰å†™çš„æ—¶å€™æ²¡æœ‰åŠ¨æ‰‹å®è·µï¼Œåº”è¯¥åªç”¨ä¸€ä¸ªsvcæä¾›è¯»å°±å¤Ÿäº†ï¼Œå†™å…¥ç”¨åŸŸåmysql-0.mysqlå°±å¯ä»¥äº†ã€‚ï¼ˆå…¶å®ä¹Ÿæ— æ³•åŒæ—¶å®ç°åªè¯»svcå’Œåªå†™svcï¼Œå› ä¸ºæ¢é’ˆæ˜¯é…ç½®åœ¨å®¹å™¨è¿™ä¸€å±‚çš„ï¼Œè¦ä¹ˆåªèƒ½é€‰å‡ºmasterï¼Œè¦ä¹ˆåªèƒ½é€‰å‡ºslaveï¼Œä¸å¯èƒ½åŒæ—¶æ»¡è¶³2ä¸ªsvcï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624009072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346349,"discussion_content":"mark\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611918399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"æˆ‘æ¥ä¹Ÿ","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342983,"discussion_content":"äººæ‰å•Šï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610892022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1217712,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/b0/b073fe8b.jpg","nickname":"aMaMiMoU","note":"","ucode":"AF1E6CA541E482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319420,"discussion_content":"è¿™ä¸ªæ€è·¯æˆ‘è§‰å¾—å¯è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604026344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31635,"user_name":"ä¾¯æ“å®‡","can_delete":false,"product_type":"c1","uid":1117242,"ip_address":"","ucode":"741E0DC3B8EB55","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/3a/d2161d37.jpg","comment_is_top":false,"comment_ctime":1539250374,"is_pvip":false,"replies":[{"id":"11390","content":"æ²¡å•¥è®²ç©¶ï¼Œèƒ½å®Œæˆä»»åŠ¡å³å¯","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539256971,"ip_address":"","comment_id":31635,"utype":1}],"discussion_count":3,"race_medal":0,"score":"57373825222","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘å‘ç°åœ¨initContainers çš„ini-mysqlå®¹å™¨ä¸­ï¼Œæ‰§è¡Œçš„åªæ˜¯ç®€å•çš„æ–‡ä»¶æ‹·è´å·¥ä½œï¼Œä½†é•œåƒå´ç”¨çš„æ˜¯mysqlçš„é•œåƒï¼Œå¯ä»¥ç”¨å…¶ä»–é•œåƒå–ä»£å—ï¼Ÿé•œåƒçš„é€‰æ‹©æœ‰ä»€ä¹ˆè®²ç©¶å—ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426440,"discussion_content":"æ²¡å•¥è®²ç©¶ï¼Œèƒ½å®Œæˆä»»åŠ¡å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539256971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1035612,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/cd/5c/e09eac13.jpg","nickname":"åˆ˜å¼·","note":"","ucode":"B2E41BB894A727","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580273,"discussion_content":"è¿™é‡Œç”¨mysqlé•œåƒï¼Œåº”è¯¥æ˜¯é‡ç”¨ï¼Œä¸ç”¨å†æ‹‰å–æ–°çš„é•œåƒäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658057226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531050,"discussion_content":"Markï¼Œæ–‡ä¸­æœ‰åŒæ ·ç–‘é—®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637212784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30695,"user_name":"é£è½¨","can_delete":false,"product_type":"c1","uid":1185844,"ip_address":"","ucode":"7B8A5233B61EB0","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/34/c082419c.jpg","comment_is_top":false,"comment_ctime":1538977413,"is_pvip":false,"replies":[{"id":"11061","content":"å…¶å®ä¹Ÿå¯ä»¥å†™æˆä¸¤ä¸ªstatefulset ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998715,"ip_address":"","comment_id":30695,"utype":1}],"discussion_count":1,"race_medal":0,"score":"57373552261","product_id":100015201,"comment_content":"é›†ç¾¤ä¸­çš„master&#47;slaveèŠ‚ç‚¹å…³ç³»ä¸å¯¹ç­‰ã€‚Serviceæ˜¯é€šè¿‡labelæ¥ç»‘å®špodçš„ï¼Œä¸€ä¸ªstatefulSetä¸­æ‰€æœ‰podçš„labeléƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ— æ³•åŒºåˆ†ï¼Œå› æ­¤serviceä¹Ÿæ˜¯æ— æ³•åŒºåˆ«ç»‘å®šslave podçš„ã€‚æ‰€ä»¥ç­”æ¡ˆåº”è¯¥æ˜¯è€å¸ˆåœ¨æ–‡ä¸­å¤šæ¬¡æåŠçš„Operatorï¼Œä¸€æ¬¡ç¼–æ’å¤šä¸ªè§’è‰²ä¸åŒç”šè‡³é•œåƒä¸åŒçš„æœåŠ¡ã€‚","like_count":13,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426069,"discussion_content":"å…¶å®ä¹Ÿå¯ä»¥å†™æˆä¸¤ä¸ªstatefulset ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30676,"user_name":"wtcctw","can_delete":false,"product_type":"c1","uid":1141208,"ip_address":"","ucode":"EECBBB9AC08CD9","user_header":"https://static001.geekbang.org/account/avatar/00/11/69/d8/112f69f8.jpg","comment_is_top":false,"comment_ctime":1538971223,"is_pvip":false,"replies":[{"id":"11063","content":"é‡åˆ°é—®é¢˜èƒ½è¿…é€Ÿå®šä½åˆ°æºç å³å¯","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998768,"ip_address":"","comment_id":30676,"utype":1}],"discussion_count":7,"race_medal":0,"score":"53078578775","product_id":100015201,"comment_content":"å¼ å¤§å¤§ä½ å¥½ï¼Œ<br>æˆ‘ä¹‹å‰è‡ªå·±ç©è¿‡dockerï¼Œåœ¨çœ‹è¿™ä¸ªä¸“æ ä¹‹å‰ï¼Œç‰¹æ„ç®€å•è¿‡äº†ä¸€ä¸‹ã€ŠDockerå®¹å™¨ä¸å®¹å™¨äº‘ ç¬¬äºŒç‰ˆã€‹ï¼Œä¹‹å‰ä¸€äº›ç« èŠ‚çœ‹å¾—éå¸¸è¿‡ç˜¾ï¼Œè®²è§£å¾—éå¸¸é€å½»ã€‚<br>ä½†æ˜¯çœ‹åˆ°StateFulSetçš„æ—¶å€™æ„Ÿè§‰æœ‰ç‚¹æ™•ã€‚ã€‚ã€‚ç‰¹åˆ«æ˜¯é‡Œé¢çš„Pod YAMLå®šä¹‰ï¼Œæ„Ÿè§‰è¦è®°çš„ä¸œè¥¿éå¸¸å¤šï¼Œå­¦ä¹ æ›²çº¿ä¹Ÿæ¯”è¾ƒé™¡å³­ï¼Œä¸€æ®µæ—¶é—´ä¸ç”¨è‚¯å®šå°±å¿˜äº†ã€‚<br>æ‰€ä»¥æƒ³é—®ä¸€ä¸‹ï¼Œä½œä¸ºéä¸“ä¸šçš„è¿ç»´äººå‘˜ï¼Œå¯¹äºk8sçš„æŒæ¡å¤§è‡´è¦åˆ°ä½•ç§ç¨‹åº¦ï¼Œå¤šè°¢å¤šè°¢ã€‚","like_count":12,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426066,"discussion_content":"é‡åˆ°é—®é¢˜èƒ½è¿…é€Ÿå®šä½åˆ°æºç å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300550,"discussion_content":"å®šä½åˆ°k8sæºç ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598167906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1740409,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8e/79/f9d5dd3a.jpg","nickname":"å•è¶…","note":"","ucode":"B36883984BE16B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":352559,"discussion_content":"åº”è¯¥æ˜¯yamlçš„ä»£ç å§","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1614770586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300550,"ip_address":""},"score":352559,"extra":""}]},{"author":{"id":2291160,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg","nickname":"Woa ğŸ¤","note":"","ucode":"6033F496082F3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545952,"discussion_content":"æœ‰çš„æ—¶å€™æ˜¯è¦å®šä½åˆ°k8sæºç çš„ã€å°¤å…¶æ˜¯æ–‡æ¡£æ²¡æœ‰è®²ã€èµ„æ–™ä¹Ÿæ²¡æœ‰ã€åªèƒ½è‡ªå·±åŠ¨æ‰‹äº†ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642089926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"ä¸ç»æ„é—´","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533409,"discussion_content":"å¯èƒ½è®¤ä¸ºæé—®è€…æ˜¯å¼€å‘å§Ù©(à¹‘â€¢ã…‚â€¢)Û¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637853141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1201009,"avatar":"https://static001.geekbang.org/account/avatar/00/12/53/71/a4e9f20e.jpg","nickname":"è¨€åˆæœ¨æ‰","note":"","ucode":"300BEDC1B07DF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393171,"discussion_content":"å®šä½åˆ°k8sçš„æºç ï¼Ÿï¼Ÿè¦è¿™ä¹ˆç¡¬æ ¸çš„å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631275967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1970516,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK4NPyaFDl4rzrd4A9z42tQDibFLdCicbrAdyUa5P2B5u8UCUBenpHX7VgUCibvHvhpza4icMBKVnhmA/132","nickname":"å­¦æ— æ­¢å¢ƒ","note":"","ucode":"2C28E8E54DAB4E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389564,"discussion_content":"åº”è¯¥æ˜¯å®šä½åˆ° yaml å³å¯ï¼Œ ä¸æ˜¯K8Sçš„æºç     ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629340318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44231,"user_name":"V V","can_delete":false,"product_type":"c1","uid":1220390,"ip_address":"","ucode":"9494330A6AA770","user_header":"https://static001.geekbang.org/account/avatar/00/12/9f/26/89eda2c8.jpg","comment_is_top":false,"comment_ctime":1543390616,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"35903128984","product_id":100015201,"comment_content":"è¿™ç§éƒ¨ç½²æ–¹å¼ï¼Œä¸»èŠ‚ç‚¹podæŒ‚äº†çš„æ—¶å€™ï¼Œèƒ½è‡ªåŠ¨é‡æ–°åˆ›å»ºä¸€ä¸ªå‡ºæ¥å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1508329,"avatar":"https://static001.geekbang.org/account/avatar/00/17/03/e9/6358059c.jpg","nickname":"GalaxyCreater","note":"","ucode":"C79E8A088D57CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572120,"discussion_content":"å¯ä»¥ï¼Œä½†æ˜¯æœåŠ¡ä¼šçŸ­æ—¶é—´ä¸å¯ç”¨ï¼Œæ­¤æ–¹å¼éé«˜å¯ç”¨æ–¹æ¡ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652606734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","nickname":"ä¸ç»æ„é—´","note":"","ucode":"C39D98697ACB8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533411,"discussion_content":"å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸ªæ§åˆ¶å¾ªç¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637853243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300548,"discussion_content":"æˆ‘ä¹Ÿæƒ³çŸ¥é“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598167851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1715064,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/2b/78/97532f60.jpg","nickname":"îŠ","note":"","ucode":"FCC8B496F9A621","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2041199,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/25/6f/bbf7bded.jpg","nickname":"Andrew","note":"","ucode":"837D7A71307A49","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":308130,"discussion_content":"å¯ä»¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600851451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300548,"ip_address":""},"score":308130,"extra":""}]}]},{"had_liked":false,"id":30783,"user_name":"swordholder","can_delete":false,"product_type":"c1","uid":1002569,"ip_address":"","ucode":"3D1361126AD3CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/49/d21c134f.jpg","comment_is_top":false,"comment_ctime":1538996771,"is_pvip":false,"replies":[{"id":"11059","content":"å¯¹ï¼Œç”¨rookçš„ç¯å¢ƒåº”è¯¥åŠ ä¸Šè¿™ä¸ªï¼Œæˆ‘åŠ ä¸€å¥æ³¨é‡Šä¸Šå»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998515,"ip_address":"","comment_id":30783,"utype":1}],"discussion_count":4,"race_medal":0,"score":"35898735139","product_id":100015201,"comment_content":"æ€»ç»“é‡Œç»™çš„&#39;mysql-statefulset.yaml&#39;å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œåœ¨å£°æ˜&#39;volumeClaimTemplates&#39;æ—¶ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥é€šè¿‡&#39;storageClassName&#39;å±æ€§å¼•ç”¨å‰é¢å®šä¹‰çš„&#39;StorageClass&#39;:<br><br>storageClassName: rook-ceph-block<br><br>æˆ‘å¼€å§‹ä¸€ç›´é‡åˆ°&quot;pod has unbound immediate PersistentVolumeClaims&quot; é”™è¯¯ï¼Œå¢åŠ äº†è¿™ä¸ªå±æ€§å°±å¥½äº†ã€‚","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426096,"discussion_content":"å¯¹ï¼Œç”¨rookçš„ç¯å¢ƒåº”è¯¥åŠ ä¸Šè¿™ä¸ªï¼Œæˆ‘åŠ ä¸€å¥æ³¨é‡Šä¸Šå»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"ä¸€ç§’","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354960,"discussion_content":"gité“¾æ¥å¤±æ•ˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615368561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218347,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLvdWoCic6ItzibF8ia8vrUTRuyj6AT3tg5f4QicIK0jTIFheJ6274ZkibuRLFP1NXG3jibv5TiaSKNoJpLw/132","nickname":"Geek_37984c","note":"","ucode":"7A319AE28599B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158961,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580644566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1448863,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132","nickname":"tuyu","note":"","ucode":"B235325B541408","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7550,"discussion_content":"è¯·é—®ä¸€äº›åŠ è½½å“ªä¸ªä½ç½®, æ‰¾ä¸åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567562725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54873,"user_name":"D","can_delete":false,"product_type":"c1","uid":1210514,"ip_address":"","ucode":"CCB5CADA48A734","user_header":"https://static001.geekbang.org/account/avatar/00/12/78/92/ae2c1b12.jpg","comment_is_top":false,"comment_ctime":1545974429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31610745501","product_id":100015201,"comment_content":"è¿™é‡Œåˆ›å»ºMySQLçš„æ—¶å€™ï¼Œç”±äºè®¾å®šäº†readnessProbeåœ¨å¯åŠ¨å30ç§’æ‰§è¡Œï¼Œä½†æ˜¯å½“ä½ æ²¡åŠæ³•åœ¨30ç§’ä¹‹å†…å¯åŠ¨æˆåŠŸè¿‡ä¸€ä¼šæ‰§è¡Œlogså°±ä¼šçœ‹åˆ°ä¸€ä¸ªâ€”initâ€¦â€¦çš„é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸ºå®¹å™¨æ£€æµ‹åˆ°ä¸å¯ç”¨å°±é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ï¼Œä½†æ˜¯æ–°çš„å®¹å™¨MySQLæ‰§è¡Œåˆå§‹åŒ–çš„æ—¶å€™å‘ç°æ‰€åœ¨çš„æ•°æ®ç›®å½•(&#47;var&#47;lib&#47;MySQL)ä¸ä¸ºç©ºï¼Œè¿™æ—¶å€™åªè¦å“åº”çš„è°ƒé«˜readnessProbeå’ŒlivenessProbeçš„initialDelaySecondså€¼å°±å¥½äº†","like_count":7},{"had_liked":false,"id":53949,"user_name":"xfan","can_delete":false,"product_type":"c1","uid":1315147,"ip_address":"","ucode":"48ED8D498D7F56","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","comment_is_top":false,"comment_ctime":1545779892,"is_pvip":false,"replies":[{"id":"19833","content":"æ‰€ä»¥æ‰è¦è®²operatorçš„","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1545953794,"ip_address":"","comment_id":53949,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31610550964","product_id":100015201,"comment_content":"æ„Ÿè§‰å®ç°èµ·æ¥å¾ˆå¤æ‚ï¼Œä¸ä¼˜ç¾","like_count":7,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434297,"discussion_content":"æ‰€ä»¥æ‰è¦è®²operatorçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545953794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324208,"user_name":"å°æ°´","can_delete":false,"product_type":"c1","uid":1104456,"ip_address":"","ucode":"808E8E28BA3827","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/48/0d3cd6fa.jpg","comment_is_top":false,"comment_ctime":1638335702,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27408139478","product_id":100015201,"comment_content":"ç”¨äº†å¾ˆå¤§åŠŸå¤«ï¼Œè°ƒé€šäº†è€å¸ˆçš„ç¤ºä¾‹ï¼Œä»£ç éƒ½æ˜¯ç…§ç€è€å¸ˆä»£ç æ•²çš„ï¼Œä¹Ÿæ˜¯ä¸å¯ä»¥é¿å…çš„æœ‰æ‹¼å†™çš„é”™è¯¯ï¼Œé€šè¿‡ä¸æ–­çš„è°ƒè¯•ï¼Œåœ¨é‚£æˆåŠŸçš„ä¸€ç¬é—´ï¼Œå–œæ‚¦ä¸å¯è¨€è¯­ï¼Œè€å¸ˆçš„ç¤ºä¾‹ä¸­ä½¿ç”¨å›½å¤–çš„é•œåƒï¼Œæˆ‘æ˜¯æ›´æ¢ä¸ºå›½å†…çš„æºï¼Œyamlå¦‚ä¸‹é“¾æ¥ï¼Œå¸Œæœ›å¯¹åæ¥çš„åŒå­¦æœ‰æ‰€å¸®åŠ©<br>https:&#47;&#47;github.com&#47;Alexwalt&#47;kubernetes-yamls&#47;blob&#47;master&#47;mysql.yaml<br>è°ƒè¯•å·¥å…·<br>kubectl describe pod podå<br>kubectl logs -p podå -c dockerå","like_count":6},{"had_liked":false,"id":241484,"user_name":"æ­£z","can_delete":false,"product_type":"c1","uid":2057031,"ip_address":"","ucode":"9220ECB4B0A2CC","user_header":"https://static001.geekbang.org/account/avatar/00/1f/63/47/e8164679.jpg","comment_is_top":false,"comment_ctime":1597307608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27367111384","product_id":100015201,"comment_content":"mysqlæ„Ÿè§‰æœ‰ç‚¹å¤æ‚ï¼Œè‡ªå·±è¯•äº†ä¸‹mongoDBï¼Œå¤æ‚åº¦æ„Ÿè§‰ä½ä¸€ç‚¹æ›´å®¹æ˜“æˆåŠŸï¼Œä¹ŸåŒæ ·èƒ½æ·±åˆ»ç†è§£ä¸Šé¢çš„å†…å®¹ï¼Œä¼™è®¡ä»¬ä¹Ÿå¯ä»¥è¯•è¯•","like_count":6},{"had_liked":false,"id":154527,"user_name":"å°åˆš","can_delete":false,"product_type":"c1","uid":1061898,"ip_address":"","ucode":"9CDB75A4083391","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIZtZz0LgYRdP1FKvmPfQUv7vQ04ibTvNTx3wcG0WEblMHQ8dORKqBeMlath93yO5a129tKhFPkA4w/132","comment_is_top":false,"comment_ctime":1574474688,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27344278464","product_id":100015201,"comment_content":"K8S éƒ¨ç½²çš„Mysqlé›†ç¾¤ï¼Œæ˜¯å¦æœ‰HAçš„é£é™©é—®é¢˜ï¼Ÿ è€ƒè™‘ä¸¤ç§åœºæ™¯ï¼š<br>1 å¦‚æœmysq-0 PODå‘ç”Ÿæ„å¤–é‡å¯ï¼Œæ— æ³•å†æ¬¡è°ƒåº¦æˆåŠŸï¼ˆèµ„æºä¸è¶³ç­‰æƒ…å†µï¼‰ï¼Œå…¶ä»–çš„èŠ‚ç‚¹PODæ— æ³•åˆ‡æ¢å¾®ä¸»ç”¨ï¼Œé›†ç¾¤æ•´ä½“å°±ä¸å¯ç”¨äº†ï¼› <br>2 å³ä½¿èƒ½å†æ¬¡è°ƒåº¦æˆåŠŸï¼Œä¹Ÿä¾èµ–K8Sé›†ç¾¤çš„åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé‡æ–°è°ƒåº¦ä¸€ä¸ªPODæ—¶é—´ï¼› æ¯”å¦‚èŠ‚ç‚¹ä¸‹ç”µåï¼ŒK8Så¯èƒ½éœ€è¦5åˆ†é’Ÿï¼Œæ‰ä¼šåœ¨å…¶ä»–èŠ‚ç‚¹è°ƒåº¦ï¼›<br>æ‰€ä»¥æ˜¯å¦æ•°æ®åº“ç­‰é«˜å¯ç”¨æ€§çš„åº”ç”¨ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒï¼Œè¿˜æ˜¯ä¸è¦éƒ¨ç½²åœ¨K8Sä¸ºå¦™ï¼Ÿ","like_count":7},{"had_liked":false,"id":44267,"user_name":"åŠ è²è€çŒ«","can_delete":false,"product_type":"c1","uid":1316514,"ip_address":"","ucode":"65FE75E211BCD3","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/a2/26ed8f44.jpg","comment_is_top":false,"comment_ctime":1543396580,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"27313200356","product_id":100015201,"comment_content":"è€å¸ˆæ–¹ä¾¿æä¾›ä¸€ä¸ªå®˜æ–¹çš„mysql-statefulset.yamlæ ·æœ¬å˜›ï¼Œæˆ‘storageClassName: rook-ceph-blockå‚æ•°æ€ä¹ˆåŠ éƒ½è·‘ä¸å‡ºæ¥ï¼Œå¤šè°¢å¤šè°¢ï¼","like_count":6,"discussions":[{"author":{"id":1217712,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/b0/b073fe8b.jpg","nickname":"aMaMiMoU","note":"","ucode":"AF1E6CA541E482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374876,"discussion_content":"æœ€æ–°:      https://kubernetes.io/docs/tasks/run-application/run-replicated-stateful-application/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621396388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2441261,"avatar":"https://static001.geekbang.org/account/avatar/00/25/40/2d/9a766753.jpg","nickname":"éƒ­è´»é“–","note":"","ucode":"B14B1DB14031F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351563,"discussion_content":"é“¾æ¥æ‰“ä¸å¼€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614325389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346348,"discussion_content":"æ–‡ç« é‡Œæœ‰é“¾æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611918257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"ä¸€ç§’","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354961,"discussion_content":"æ–‡ç« é‡Œçš„é“¾æ¥å¤±æ•ˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615368714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":346348,"ip_address":""},"score":354961,"extra":""}]}]},{"had_liked":false,"id":288450,"user_name":"jesse","can_delete":false,"product_type":"c1","uid":1254691,"ip_address":"","ucode":"8A72075A22D973","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","comment_is_top":false,"comment_ctime":1618473744,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18798342928","product_id":100015201,"comment_content":"å“ˆå“ˆï¼Œçœ‹ç€å¤§ä½¬çš„è¿™ç¯‡æ–‡ç« ï¼Œè·Ÿç€æ­å»ºäº†redisçš„ä¸»å¤‡é›†ç¾¤ï¼Œæ¯”mysqlç®€æ´çš„å¤š","like_count":4},{"had_liked":false,"id":48732,"user_name":"eden","can_delete":false,"product_type":"c1","uid":1220656,"ip_address":"","ucode":"8A5620A5C4BDB8","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/30/5a7247eb.jpg","comment_is_top":false,"comment_ctime":1544525329,"is_pvip":false,"replies":[{"id":"17498","content":"éœ€è¦å­˜å‚¨æ’ä»¶æ”¯æŒ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1544533156,"ip_address":"","comment_id":48732,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18724394513","product_id":100015201,"comment_content":"è€å¸ˆï¼Œè¯·é—®mysql persistent volumeéœ€è¦æ‰©å®¹æ€ä¹ˆåšï¼Ÿé€šè¿‡kubectl scaleä¸èƒ½ä¿®æ”¹volumeå¤§å°ã€‚","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432332,"discussion_content":"éœ€è¦å­˜å‚¨æ’ä»¶æ”¯æŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544533156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31636,"user_name":"ä¾¯æ“å®‡","can_delete":false,"product_type":"c1","uid":1117242,"ip_address":"","ucode":"741E0DC3B8EB55","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/3a/d2161d37.jpg","comment_is_top":false,"comment_ctime":1539250473,"is_pvip":false,"replies":[{"id":"11392","content":"ä¸¤ä¸ªstatefulset è‚¯å®šéœ€è¦ä½ åœ¨å¤–éƒ¨æ§åˆ¶äº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539257003,"ip_address":"","comment_id":31636,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18719119657","product_id":100015201,"comment_content":"å¦‚æœmasterå’Œslaveç”¨ä¸¤ä¸ªStatefulSetçš„è¯ï¼Œæ€ä¹ˆæ¥ä¿è¯masterå’Œslaveçš„å¯åŠ¨é¡ºåºå‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426441,"discussion_content":"ä¸¤ä¸ªstatefulset è‚¯å®šéœ€è¦ä½ åœ¨å¤–éƒ¨æ§åˆ¶äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539257003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1217712,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/b0/b073fe8b.jpg","nickname":"aMaMiMoU","note":"","ucode":"AF1E6CA541E482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319408,"discussion_content":"æ˜¯ä¸æ˜¯å¯ä»¥åœ¨slaveçš„statefullsetçš„initcontaineré‡Œåšå‰ç½®æ£€æŸ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604023970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30772,"user_name":"Caesar","can_delete":false,"product_type":"c1","uid":1253220,"ip_address":"","ucode":"0319C9E19387CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/64/54458855.jpg","comment_is_top":false,"comment_ctime":1538994545,"is_pvip":true,"replies":[{"id":"11060","content":"kataå¯ä¸æ˜¯è™šæ‹ŸæœºåŠ å®¹å™¨ï¼Œkataæ˜¯ç”¨è™šæ‹ŸåŒ–å®ç°çš„å®¹å™¨","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998637,"ip_address":"","comment_id":30772,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18718863729","product_id":100015201,"comment_content":"å‰é¢çœ‹å¤§ç¥è¯´åœ¨ækata-containerï¼Œæˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼Œkata-containerå…¶å®ä¹Ÿæ˜¯è™šæ‹ŸæœºåŠ å®¹å™¨çš„æ–¹å¼ï¼Œé‚£å®ƒå’ŒdockeråŠ è™šæ‹Ÿæœºçš„ä¼˜åŠ¿ç›¸æ¯”åœ¨å“ªå‘¢","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426089,"discussion_content":"kataå¯ä¸æ˜¯è™šæ‹ŸæœºåŠ å®¹å™¨ï¼Œkataæ˜¯ç”¨è™šæ‹ŸåŒ–å®ç°çš„å®¹å™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"ä¸€ç§’","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354963,"discussion_content":"kata è·Ÿkubevirtæ¯”å“ªä¸ªå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615369032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246739,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1599468741,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14484370629","product_id":100015201,"comment_content":"<br>Deploymentæ— æ³•åº”å¯¹å®ä¾‹ä¹‹é—´æœ‰ä¾èµ–å…³ç³»çš„åœºæ™¯ï¼Œå› æ­¤å‡ºç°äº†StatefulSetï¼Œæ¥æ”¯æŒâ€œæœ‰çŠ¶æ€åº”ç”¨â€ã€‚StatefulSetå°†çŠ¶æ€æŠ½è±¡ä¸ºäº†ä¸¤ç§æƒ…å†µï¼šï¼ˆ1ï¼‰æ‹“æ‰‘çŠ¶æ€ ï¼ˆ2ï¼‰å­˜å‚¨çŠ¶æ€ã€‚<br><br>æ‹“æ‰‘çŠ¶æ€çš„ç¨³å®šæ€§å¦‚ä½•ä¿æŒï¼ŸStatefulSetç»™Podå›ºå®šåå­—ï¼Œç„¶åé€šè¿‡Headless Serviceèµ‹äºˆäº†Podå”¯ä¸€çš„â€œç½‘ç»œèº«ä»½â€ï¼Œä½¿ç”¨è¿™ä¸ªç½‘ç»œèº«ä»½é€šè¿‡Podçš„åå­—å³å¯è®¿é—®åˆ°å¯¹åº”çš„Podã€‚<br><br>å­˜å‚¨çŠ¶æ€å¦‚ä½•ç®¡ç†ï¼Ÿ é€šè¿‡å›ºå®šåå­—çš„PVCï¼Œ å½“Podå¼‚å¸¸åã€‚ä¼šé‡æ–°ç»‘å®šè¿™ä¸ªå›ºå®šåå­—çš„PVCæ¥ä¿æŒå­˜å‚¨çŠ¶æ€ã€‚æ¯”å¦‚web-0åˆ é™¤ä¹‹åï¼Œè¿™ä¸ªPodå¯¹åº”çš„PVCå’ŒPVï¼Œå¹¶ä¸ä¼šè¢«åˆ é™¤ï¼Œå› æ­¤æ•°æ®ä¹Ÿä¾ç„¶ä¿å­˜åœ¨è¿œç¨‹å­˜å‚¨æœåŠ¡é‡Œã€‚<br>","like_count":3},{"had_liked":false,"id":100485,"user_name":"å½°ç‰","can_delete":false,"product_type":"c1","uid":1225932,"ip_address":"","ucode":"E35220D59D9B27","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IyrKOr1vBfpdjgKEqRTOMpiciaMZtlVv6WLFt4lENZRtibt0O9EaOuI1DGIyfeiazD8x8Z1hgicVHZhOxIhez6pkQIw/132","comment_is_top":false,"comment_ctime":1559564160,"is_pvip":false,"replies":[{"id":"36290","content":"æŒ‰yamlå¯åŠ¨","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1559618482,"ip_address":"","comment_id":100485,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14444466048","product_id":100015201,"comment_content":"é›†ç¾¤å»ºå¥½äº†  æ•°æ®ä¹Ÿæ’å…¥æˆåŠŸäº†  é›†ç¾¤ä¹Ÿæ­£å¸¸å  ä¸»ä»èŠ‚ç‚¹çš„ä»»ä½•èŠ‚ç‚¹é‡å¯ æ˜¯é‡æ–°æŒ‰yamLå¯åŠ¨ è¿˜æ˜¯ç›´æ¥æŒ‚æ•°æ®ç›˜å¯å¹¼","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452570,"discussion_content":"æŒ‰yamlå¯åŠ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559618482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85638,"user_name":"å¼ºè€…ä¹‹é£","can_delete":false,"product_type":"c1","uid":1500643,"ip_address":"","ucode":"E7608F908B87E1","user_header":"https://static001.geekbang.org/account/avatar/00/16/e5/e3/06aa87b5.jpg","comment_is_top":false,"comment_ctime":1555152446,"is_pvip":false,"replies":[{"id":"31573","content":"è€Œé€šè¿‡è¿æ¥ mysql-read è¿™ä¸ª Serviceï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ SQL è¿›è¡Œè¯»æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1555695747,"ip_address":"","comment_id":85638,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14440054334","product_id":100015201,"comment_content":"çœ‹ä¸å‡ºæ¥ç”¨MySQL-read  service","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446746,"discussion_content":"è€Œé€šè¿‡è¿æ¥ mysql-read è¿™ä¸ª Serviceï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ SQL è¿›è¡Œè¯»æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555695747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1675662,"avatar":"https://static001.geekbang.org/account/avatar/00/19/91/8e/0c834bc3.jpg","nickname":"è±†è±†ç³–","note":"","ucode":"69208BE7771A65","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373778,"discussion_content":"è¿™ä¸ªæˆ‘ä¹Ÿç ”ç©¶äº†ä¸€ä¸‹ï¼Œå¦‚æœæ‚¨æ˜¯ä¸çŸ¥é“å“ªé‡Œä½¿ç”¨äº†mysql-readé‚£æˆ‘å°è¯•è¡¨è¾¾ä¸‹æˆ‘çš„ç†è§£ã€‚\n1.å®é™…ä¸Šstatefulsetå’Œserviceçš„å¯¹åº”å…³ç³»ä¸æ˜¯é€šè¿‡ServiceNameå­—æ®µæ¥å¯¹åº”çš„ï¼Œè€Œæ˜¯é€šè¿‡labelæ¥å¯¹åº”çš„ã€‚æ‰€ä»¥statefulsetæ‹‰èµ·æ¥çš„podä¼šæ˜ å°„å‡ºæ¥ä¸¤ä¸ªserviceï¼Œä¸€ä¸ªæ˜¯mysqlï¼Œä¸€ä¸ªæ˜¯mysql-readã€‚\n2.å¦‚æœæ˜¯å†™æ“ä½œï¼Œå°±ä¼šç›´æ¥è®¿é—®mysql-0ï¼Œè¿™æ˜¯headless serviceã€‚è€Œå¯¹äºè¯»æ“ä½œï¼Œå…¶å®ä¸ç®¡è®¿é—®mysqlçš„masterè¿˜æ˜¯replicaå…¶å®éƒ½æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥å®é™…çš„åº”ç”¨ä¸­æˆ‘ä»¬æ˜¯é€šè¿‡mysql-readè¿™ä¸ªserviceï¼Œæ¥è®¿é—®statefulsetæ‹‰èµ·æ¥çš„ä»»æ„ä¸€ä¸ªpodéƒ½å¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620871826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1330141,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4b/dd/41614582.jpg","nickname":"HomeyLiu","note":"","ucode":"EF4CCB92C369B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7038,"discussion_content":"å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567310224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32357,"user_name":"Joe Black","can_delete":false,"product_type":"c1","uid":1052528,"ip_address":"","ucode":"21FE222A286445","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/70/c8680841.jpg","comment_is_top":false,"comment_ctime":1539559496,"is_pvip":false,"replies":[{"id":"11810","content":"è¿™ä¸ªäº‹å„¿è‡ªåŠ¨åŒ–èƒ½ä¸èƒ½åšï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539571122,"ip_address":"","comment_id":32357,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14424461384","product_id":100015201,"comment_content":"å…¶å®ç»™slaveèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªæ–°çš„æ ‡ç­¾ï¼Œåˆ›å»ºè¯»Serviceçš„æ—¶å€™é€‰æ‹©è¿™ä¸ªæ ‡ç­¾çš„å®¹å™¨å°±è¡Œäº†å§ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426738,"discussion_content":"è¿™ä¸ªäº‹å„¿è‡ªåŠ¨åŒ–èƒ½ä¸èƒ½åšï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539571122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214026,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1588638431,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10178573023","product_id":100015201,"comment_content":"ä¹‹å‰ä¸€ç›´ä»¥ä¸ºsidecarå¿…é¡»æ˜¯initContainerç±»å‹çš„ï¼Œçœ‹è¿™é‡Œæ˜¯åœ¨spec.template.containerä¸‹é¢ï¼Œå’Œmysqlå®¹å™¨åŒçº§çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨slaveå¯åŠ¨ä¹‹å‰åšåˆå§‹åŒ–æ“ä½œï¼Œå¯æ˜¯è¿™ç§å¯åŠ¨å…ˆåçš„é¡ºåºæ˜¯æ€ä¹ˆæ¥å®šä¹‰çš„ï¼Œå¦‚ä½•ç¡®å®šæ˜¯å…ˆæ‰§è¡Œäº†åˆå§‹åŒ–æ“ä½œç„¶åæ‰å¯åŠ¨slaveçš„å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1217712,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/b0/b073fe8b.jpg","nickname":"aMaMiMoU","note":"","ucode":"AF1E6CA541E482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319422,"discussion_content":"æœ‰ä¸ªuntilç”¨æ¥åšå‰ç½®æ£€æŸ¥ï¼Œç¡®ä¿ä¸»å®¹å™¨è¿è¡Œä¹‹åæ‰ä¼šè®©sidecaræ­£å¸¸è¿è¡Œ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604026615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370985,"discussion_content":"initContainerå®¹å™¨å¿…é¡»æ‰§è¡Œå®Œåæ‰ä¼šæ‰§è¡Œä¸»å®¹å™¨ï¼Œè€Œsidecaræœ‰ä¸ªç›‘å¬ç«¯å£çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æ˜¯ä¸ªå¸¸é©»è¿›ç¨‹ï¼Œå¿…é¡»ä¸èƒ½ç”¨initContainerï¼Œä¸ç„¶åé¢å®¹å™¨åˆ«æƒ³æ‰§è¡Œäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1619600739,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":169163,"user_name":"YangFan","can_delete":false,"product_type":"c1","uid":1015850,"ip_address":"","ucode":"52FD97208DFCD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/2a/98e659ca.jpg","comment_is_top":false,"comment_ctime":1578282036,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10168216628","product_id":100015201,"comment_content":"ç°åœ¨å­˜å‚¨éƒ¨åˆ†æ˜¯ä¾èµ–äº†cephçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿèƒ½åŠ›ï¼Œå¦‚æœæˆ‘åªæƒ³ç”¨æœ¬åœ°ç›˜æ­å»ºmysql clusterå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"æˆ‘æ¥ä¹Ÿ","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":182472,"discussion_content":"åŒé—®,æŠ˜è…¾äº†ä¸€å¤©,ç¡¬æ˜¯æ²¡æ³•è®© volumeClaimTemplates ä»æœ¬åœ°ç›˜åˆ†é…pvc.","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1582428273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"é¹¤æ— åŒ","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356137,"discussion_content":"apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: mysql-db0\n  labels:\n    type: local\nspec:\n  volumeMode: Filesystem\n  accessModes:\n  - ReadWriteMany\n  - ReadWriteOnce\n  capacity:\n    storage: 10Gi\n  persistentVolumeReclaimPolicy: Recycle\n  hostPath:\n    path: /data/mysql-db","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615538423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"é¹¤æ— åŒ","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356136,"discussion_content":"ä½ å†™ä¸€ä¸ª pv","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615538410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149057,"user_name":"jack motor","can_delete":false,"product_type":"c1","uid":1248286,"ip_address":"","ucode":"158814F7DBBDC5","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/1e/74d65100.jpg","comment_is_top":false,"comment_ctime":1573132101,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10163066693","product_id":100015201,"comment_content":"æˆ‘ç”¨çš„æ˜¯Google GKE k8s1.13ï¼Œæˆ‘æµ‹è¯•å‘ç°stateful setä»ç„¶æ˜¯é€šè¿‡rsç®¡ç†podï¼Œä½†æ˜¯æ‚¨è¿™é‡Œæåˆ°stateful setç›´æ¥æ§åˆ¶podï¼Œä¸ºä½•ï¼Ÿ","like_count":2},{"had_liked":false,"id":32737,"user_name":"Alery","can_delete":false,"product_type":"c1","uid":1156557,"ip_address":"","ucode":"08F3F49181E67B","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/cd/3aff5d57.jpg","comment_is_top":false,"comment_ctime":1539683625,"is_pvip":false,"replies":[{"id":"11928","content":"æœ‰å½±å“å•Šã€‚æ–‡ä¸­ä¸æ˜¯è®²åˆ°äº†sidecarè¦æ£€æŸ¥mysqlçš„å¯åŠ¨æƒ…å†µä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539691820,"ip_address":"","comment_id":32737,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10129618217","product_id":100015201,"comment_content":"å‰è¾ˆä½ å¥½ï¼Œè¿™é‡Œæœ‰ä¸ªmysqlæ•°æ®åº“çš„ç–‘é—®ï¼Œæ—¢ç„¶xtrabackupä¸mysqlè¿™ä¸¤ä¸ªå®¹å™¨çš„å¯åŠ¨é¡ºåºä¸ä¸€è‡´ä¼šä¸ä¼šå¯¹mysqlçš„æ•°æ®äº§ç”Ÿå½±å“ï¼Ÿå¦‚æœmysqlå…ˆèµ·æ¥äº†ï¼Œå†æ¢å¤å¤‡ä»½æ•°æ®ï¼Œmysqléœ€è¦é‡å¯ç”Ÿæ•ˆå—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426878,"discussion_content":"æœ‰å½±å“å•Šã€‚æ–‡ä¸­ä¸æ˜¯è®²åˆ°äº†sidecarè¦æ£€æŸ¥mysqlçš„å¯åŠ¨æƒ…å†µä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539691820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31054,"user_name":"åƒå¯»","can_delete":false,"product_type":"c1","uid":1058635,"ip_address":"","ucode":"44A559E38819C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/4b/170654bb.jpg","comment_is_top":false,"comment_ctime":1539076801,"is_pvip":false,"replies":[{"id":"11214","content":"nodeæ•°å¤ªå°‘ä¸å¤Ÿå¯åŠ¨å­˜å‚¨èŠ‚ç‚¹äº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539130997,"ip_address":"","comment_id":31054,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10129011393","product_id":100015201,"comment_content":"é›†ç¾¤åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œceph storageclasså“ªé‡Œreplicaè®¾ç½®ä¸º3ï¼Œå¯åŠ¨æ—¶ä¸€ç›´å¤„äºpendingï¼Œenentæç¤ºpod has unbound persistentvolumeclaimsï¼Œå°†replicaè®¾ç½®ä¸º1å°±æ²¡æœ‰é—®é¢˜ï¼Œé—®ä¸€ä¸‹è¿™ä¸ªå¤§æ¦‚æ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ<br>è°¢è°¢è€å¸ˆ","like_count":2,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426204,"discussion_content":"nodeæ•°å¤ªå°‘ä¸å¤Ÿå¯åŠ¨å­˜å‚¨èŠ‚ç‚¹äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539130997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299436,"user_name":"Geek_7a5c6a","can_delete":false,"product_type":"c1","uid":2560280,"ip_address":"","ucode":"B5F795D9CFFFED","user_header":"","comment_is_top":false,"comment_ctime":1624626076,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5919593372","product_id":100015201,"comment_content":"2021.06.25<br>rookç°åœ¨é»˜è®¤ä¸å¼€å¯flexäº†ã€‚æ‰€ä»¥ä½¿ç”¨æ–‡ä¸­çš„é…ç½®å®‰è£…æ—¶operator.yamlä¸æ”¹å‚æ•°çš„è¯ï¼Œä¼šä¸€ç›´Pendingã€‚<br><br>å¯ç”¨çš„rook-storage.yaml<br>```yaml<br>apiVersion: ceph.rook.io&#47;v1<br>kind: CephBlockPool<br>metadata:<br>  name: replicapool<br>  namespace: rook-ceph<br>spec:<br>  failureDomain: host<br>  replicated:<br>    size: 3<br>---<br>apiVersion: storage.k8s.io&#47;v1<br>kind: StorageClass<br>metadata:<br>   name: rook-ceph-block<br>provisioner: rook-ceph.rbd.csi.ceph.com<br>parameters:<br>    clusterID: rook-ceph<br>    pool: replicapool<br><br><br>    imageFormat: &quot;2&quot;<br><br>    imageFeatures: layering<br><br>    csi.storage.k8s.io&#47;provisioner-secret-name: rook-csi-rbd-provisioner<br>    csi.storage.k8s.io&#47;provisioner-secret-namespace: rook-ceph<br>    csi.storage.k8s.io&#47;controller-expand-secret-name: rook-csi-rbd-provisioner<br>    csi.storage.k8s.io&#47;controller-expand-secret-namespace: rook-ceph<br>    csi.storage.k8s.io&#47;node-stage-secret-name: rook-csi-rbd-node<br>    csi.storage.k8s.io&#47;node-stage-secret-namespace: rook-ceph<br><br>    csi.storage.k8s.io&#47;fstype: ext4<br>reclaimPolicy: Delete<br>```<br><br>å®éªŒæ­¥éª¤ï¼š<br>0. åˆ›å»ºRook StorageClass<br>kubectl create -f rook-storage.yaml<br>1. åˆ›å»ºconfigMapï¼Œæ³¨æ„cnfåç§°æ˜¯å¦å’Œå®˜ç½‘ç¤ºä¾‹ç›¸åŒ<br>kubectl create -f 01-mysql-configmap.yaml  <br>2. åˆ›å»ºservices<br>kubectl create -f 02-mysql-services.yaml  <br>3. åˆ›å»ºmysql statefulset<br>kubectl create -f 03-mysql-statefulset.yaml","like_count":1},{"had_liked":false,"id":294487,"user_name":"è¥¿é—¨é˜¿å°”æ³•","can_delete":false,"product_type":"c1","uid":2401305,"ip_address":"","ucode":"C7FDFCBC8583CB","user_header":"https://static001.geekbang.org/account/avatar/00/24/a4/19/3c10b632.jpg","comment_is_top":false,"comment_ctime":1621959150,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5916926446","product_id":100015201,"comment_content":"ç¥ä¹å…¶æŠ€ï¼<br>ä¸€ç›´åœ¨çº ç»“å¦‚ä½•åœ¨k8sä¸­è‡ªåŠ¨åŒ–çš„éƒ¨ç½²è¿™ç§åˆ†å¸ƒå¼çš„æœåŠ¡ï¼Œçœ‹å®Œè¿™ç¯‡ï¼Œæ„è¯†åˆ°è¿˜æ˜¯åŠŸåŠ›ä¸è¶³2333<br>ä¸€ä¸ªstatefulsetè™½ç„¶æœ‰ç‚¹å¤æ‚ï¼Œä½†æ˜¯éå¸¸å·§å¦™ï¼Œå®Œç¾ä¸»ä¹‰è€…è¡¨ç¤ºå¤ªè¿‡çˆ½å¿«ï¼","like_count":1},{"had_liked":false,"id":229562,"user_name":"Spring.Fred","can_delete":false,"product_type":"c1","uid":1055148,"ip_address":"","ucode":"66C84150ACC304","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/ac/32da70c9.jpg","comment_is_top":false,"comment_ctime":1593058410,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5888025706","product_id":100015201,"comment_content":"æŒä¹…åŒ–è¿™å—æœ‰ç‚¹ç–‘é—®ï¼Œ å‡è®¾statefulsetçš„å‰¯æœ¬æ•°ä¸º3ï¼Œ åˆ›å»ºäº†4ä¸ªPV: mysql-pv0, mysql-pv1,mysql-2pv,mysql-pv3,mysql-pv4<br>1. å¤„ç†é€‰æ‹©PVçš„æ—¶å€™ï¼Œ ä¸ä¸€å®šæ˜¯æŒ‰é€‰æ‹©mysql-pv0, mysql-pv1,mysql-pv2ï¼Œ ä¹Ÿå¯èƒ½æ˜¯mysql-pv1,mysql-pv2,mysql-pv3,mysql-pv4ã€‚è¿™ä¸ªæ€ä¹ˆé™å®šmysql-0é€‰æ‹©mysql-pv0ï¼Œ mysql-1é€‰æ‹©mysql-pv1ï¼Ÿ<br>2.å¦‚æœä¸èƒ½é™å®šï¼Œ åœ¨podé‡å¯çš„æ—¶å€™ï¼Œ mysql-0æœ‰æ²¡æœ‰å¯èƒ½é€‰æ‹©mysql-pv1ï¼Ÿæˆ–è€…é€‰æ‹©åˆ°ä»æœªä½¿ç”¨çš„mysql-pv4ï¼Ÿè¿™æ ·çš„è¯ï¼Œ æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1227840,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/40/2279cfb5.jpg","nickname":"å¤§åŠ›æ°´æ‰‹Jerry","note":"","ucode":"E4A6C71E275DB5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297436,"discussion_content":"pvcæ˜¯éšstatefulSetåˆ›å»ºå¹¶å’Œpvç»‘å®šçš„ï¼ŒstatefulSetå†…éƒ¨podå’Œpvcçš„å…³ç³»ä¹Ÿæ˜¯ç¡®å®šçš„ã€‚æ‰€ä»¥æ— è®ºpodå¦‚ä½•é‡å¯ï¼Œåªè¦statefulSetçš„å®šä¹‰ä¿æŒä¸å˜ï¼Œpodå’Œpvçš„å…³ç³»å°±å§‹ç»ˆæ˜¯ç¡®å®šçš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596938220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2057031,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/63/47/e8164679.jpg","nickname":"æ­£z","note":"","ucode":"9220ECB4B0A2CC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298479,"discussion_content":"åœ¨å®šä¹‰pvcæ—¶å€™æ ¹æœ¬æ²¡æœ‰å’Œpvæœ‰ä»»ä½•æŒ‡å®šçš„è”ç³»ï¼Œéƒ½æ˜¯pvcè‡ªå·±å»æ‰¾åˆé€‚çš„pvè¿›è¡Œboundã€‚podå’Œpvçš„å…³ç³»é€šè¿‡pvc bound pvæ—¶å€™å°±ç¡®å®šäº†ï¼Œåªè¦ä¸åˆ é™¤pvcï¼Œè¿™ç§æ˜ å°„å…³ç³»åº”è¯¥æ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œæ— å…³podçš„åˆ é™¤ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597307477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35221,"user_name":"killua","can_delete":false,"product_type":"c1","uid":1005951,"ip_address":"","ucode":"3108F880E48D3B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/7f/1c505317.jpg","comment_is_top":false,"comment_ctime":1540466108,"is_pvip":false,"replies":[{"id":"12565","content":"åªæœ‰ä¸»èŠ‚ç‚¹æ‰éœ€è¦å•Šï¼Œä»èŠ‚ç‚¹æœ‰read serviceå•Šã€‚è¿™ä¸ä¸ºäº†ä¸»ä»åˆ†ç¦»","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540481065,"ip_address":"","comment_id":35221,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5835433404","product_id":100015201,"comment_content":"â€œk8s å†…éƒ¨åº”ç”¨è®¿é—®æ•°æ®åº“ è¦é€šè¿‡ mysql-idçš„æ–¹å¼ è¿™ç§å¯¹äºåº”ç”¨ä»£ç æ˜¯ä¸æ˜¯ä¸å¤ªå¥½ k8sé‡Œå¯ä»¥å±è”½idå—ï¼Ÿâ€<br>æ„æ€æ˜¯åº”ç”¨å†™åœ°å€çš„æ—¶å€™è¦å†™æˆ mysql-0 mysql-1 mysql-2 è¿™ç§ å…¥å£æ²¡æœ‰ç»Ÿä¸€ï¼Œå…¶æ¬¡åº”ç”¨å¯èƒ½å¹¶ä¸çŸ¥é“ mysqlä¸ªæ•°ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427480,"discussion_content":"åªæœ‰ä¸»èŠ‚ç‚¹æ‰éœ€è¦å•Šï¼Œä»èŠ‚ç‚¹æœ‰read serviceå•Šã€‚è¿™ä¸ä¸ºäº†ä¸»ä»åˆ†ç¦»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540481065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30588,"user_name":"æåšè¶Š","can_delete":false,"product_type":"c1","uid":1027808,"ip_address":"","ucode":"E6CDA0CDC0BCE6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/e0/3e636955.jpg","comment_is_top":false,"comment_ctime":1538957083,"is_pvip":false,"replies":[{"id":"11043","content":"å¯ä»¥çš„ï¼Œä¼°è®¡è¿˜æ˜¯é‚£å•¥çš„é—®é¢˜å§","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538967797,"ip_address":"","comment_id":30588,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5833924379","product_id":100015201,"comment_content":"Macä¸Šç”¨minikubeæ˜¯ä¸æ˜¯ç©ä¸èµ·æ¥å•Šï¼Ÿæ„Ÿè§‰æ­å»ºç¯å¢ƒå¥½å¤šçš„å‘","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426041,"discussion_content":"å¯ä»¥çš„ï¼Œä¼°è®¡è¿˜æ˜¯é‚£å•¥çš„é—®é¢˜å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538967797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2291160,"avatar":"https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg","nickname":"Woa ğŸ¤","note":"","ucode":"6033F496082F3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545954,"discussion_content":"é™é¦™è¾£ä¸ä¸‹æ¥çš„ğŸ˜…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642090116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358778,"user_name":"NullPointer","can_delete":false,"product_type":"c1","uid":1179184,"ip_address":"å¹¿ä¸œ","ucode":"83B7DA926A0411","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/30/c9b568c3.jpg","comment_is_top":false,"comment_ctime":1664759189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664759189","product_id":100015201,"comment_content":"æœ‰ç‚¹å¤æ‚ï¼Œ æˆ‘ä»¬å®é™…çš„æƒ…å†µæ•°æ®åº“è¿˜æ˜¯ç”¨è™šæ‹Ÿæœºæˆ–ç‰©ç†æœºã€‚æ²¡æœ‰äº‘åŒ–ï¼Œ åªæœ‰åº”ç”¨ä¸Šäº‘äº†","like_count":0},{"had_liked":false,"id":358676,"user_name":"é™ˆéº’æ–‡","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"ç¦å»º","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1664529950,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664529950","product_id":100015201,"comment_content":"ä¿¡æ¯é‡å¤ªå¤§ï¼Œå®¹æˆ‘å†·é™ğŸ¥¶","like_count":0},{"had_liked":false,"id":349394,"user_name":"çŸ¥è¡Œåˆä¸€","can_delete":false,"product_type":"c1","uid":1521486,"ip_address":"","ucode":"2B8E634FC4CFB7","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/4e/5c3153b2.jpg","comment_is_top":false,"comment_ctime":1655945769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655945769","product_id":100015201,"comment_content":"æ•°æ®å­˜åœ¨è¿œç¨‹æœåŠ¡å™¨æ˜¯æŒ‡å“ªé‡Œï¼Ÿå½“å‰å®¹å™¨æ‰€åœ¨çš„å®¿ä¸»æœºå—ï¼Ÿè¿˜æ˜¯åé¢åŒæ ·æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶æœåŠ¡ï¼Œä¸äº†è§£rook","like_count":0},{"had_liked":false,"id":349140,"user_name":"è‘£æ°¸åˆš","can_delete":false,"product_type":"c1","uid":1169147,"ip_address":"","ucode":"ADA792B226A6CD","user_header":"https://static001.geekbang.org/account/avatar/00/11/d6/fb/837af7bf.jpg","comment_is_top":false,"comment_ctime":1655771145,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655771145","product_id":100015201,"comment_content":"è¿™æ ·éƒ¨ç½²èµ·æ¥åï¼Œå¦‚ä½•å°†æ•°æ®åº“æœåŠ¡æš´éœ²å‡ºæ¥å‘¢ï¼Ÿæ¯”å¦‚éƒ¨ç½²åˆ°äº†é˜¿é‡Œäº‘ä¸Šé¢","like_count":0},{"had_liked":false,"id":329440,"user_name":"åŠªåŠ›åšå¥½æŠ€æœ¯","can_delete":false,"product_type":"c1","uid":2863979,"ip_address":"","ucode":"F4F32F235CF0A7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/FvADgWRdOA1U1KciauXHLiaEn74B007ObTKwAJZIroEiauacJlKb3xhrMPvUyJ7moZ40YqKG4pd2jHejMsIQ83QSQ/132","comment_is_top":false,"comment_ctime":1641351247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641351247","product_id":100015201,"comment_content":"æœ¬äººåˆå‡ºèŒ…åºï¼Œé—®ä¸ªå°ç™½é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªserviceä¸ºHeadless Serviceï¼Œç¬¬äºŒä¸ªserviceæ˜¯å¦‚ä½•è®©ç”¨æˆ·çš„è¯»è¯·æ±‚ï¼Œéƒ½å¿…é¡»è®¿é—®ç¬¬äºŒä¸ª Service è¢«è‡ªåŠ¨åˆ†é…çš„ DNS è®°å½•","like_count":0},{"had_liked":false,"id":324206,"user_name":"å°æ°´","can_delete":false,"product_type":"c1","uid":1104456,"ip_address":"","ucode":"808E8E28BA3827","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/48/0d3cd6fa.jpg","comment_is_top":false,"comment_ctime":1638335326,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638335326","product_id":100015201,"comment_content":"https:&#47;&#47;github.com&#47;Alexwalt&#47;kubernetes-yamls&#47;blob&#47;master&#47;mysql.yaml","like_count":0},{"had_liked":false,"id":324205,"user_name":"å°æ°´","can_delete":false,"product_type":"c1","uid":1104456,"ip_address":"","ucode":"808E8E28BA3827","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/48/0d3cd6fa.jpg","comment_is_top":false,"comment_ctime":1638335308,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638335308","product_id":100015201,"comment_content":"æ ¹æ®è¯¾ç¨‹ï¼Œæ€»ç®—è·‘é€šä»£ç ","like_count":0},{"had_liked":false,"id":315260,"user_name":"é™ˆæ–¯ä½³","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1633771981,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633771981","product_id":100015201,"comment_content":"ç¬¬äºŒåè¯¾:æ·±å…¥ç†è§£StatefulSetï¼ˆä¸‰ï¼‰:æœ‰çŠ¶æ€åº”ç”¨å®è·µ<br>åœ¨åšæœ‰çŠ¶æ€åº”ç”¨å®è·µä¸­ï¼Œæœ‰å‡ ä¸ªå‘è¦å°å¿ƒ<br><br>1.â€œäººæ ¼åˆ†è£‚â€ï¼šåœ¨è§£å†³éœ€æ±‚ä¸­ï¼Œä¸€å®šè¦â€œäººæ ¼åˆ†è£‚â€çš„æ€è€ƒPodåœ¨æ‰®æ¼”ä¸åŒè§’è‰²æ—¶çš„ä¸åŒæ“ä½œã€‚æˆ–è€…å¹²è„†å°±å†™ä¸¤ä¸ªyamlæ–‡ä»¶ï¼Œä¸€ä¸ªä¸»ï¼Œä¸€ä¸ªä»<br>2.â€œé˜…åå³ç„šâ€ï¼šè¦è€ƒè™‘å®¹å™¨é‡å¯çš„æƒ…å†µï¼Œä¸è¦è®©é‡å¯å½±å“äº†ä¸‹ä¸€æ¬¡é‡å¯<br>3.â€œå®¹å™¨ä¹‹é—´å¹³ç­‰æ— åºâ€ï¼šé™¤éæ˜¯initContainerï¼Œå¦åˆ™å®¹å™¨ä¹‹é—´å¹³ç­‰æ— åº","like_count":0},{"had_liked":false,"id":309910,"user_name":"è¾¾å”ç¬","can_delete":false,"product_type":"c1","uid":2404887,"ip_address":"","ucode":"5CCBAF13548F02","user_header":"https://static001.geekbang.org/account/avatar/00/24/b2/17/3161b49c.jpg","comment_is_top":false,"comment_ctime":1630392218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630392218","product_id":100015201,"comment_content":"æ€»ç»“ä¸‹ï¼šå†…å®¹å¤ªå¤šï¼Œéœ€è¦å¤šåˆ·ã€‚","like_count":0},{"had_liked":false,"id":307796,"user_name":"laiï½ï½ï½","can_delete":false,"product_type":"c1","uid":1940339,"ip_address":"","ucode":"9288E0A6E1FDBD","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9b/73/46f65f57.jpg","comment_is_top":false,"comment_ctime":1629259240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629259240","product_id":100015201,"comment_content":"å¤§ä½¬ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³é—®ä¸‹ï¼Œå‡å¦‚æˆ‘ä½¿ç”¨statefulset pod æœ‰äº†ç¼–å·åï¼Œæˆ‘æ€ä¹ˆåšåˆ°æŠŠè¯·æ±‚åˆ¶å®šè§„åˆ™ï¼ˆæ¯”å¦‚ä¸€è‡´æ€§å“ˆå¸Œï¼‰ï¼Œç„¶ååˆ†é…ç»™æŒ‡å®šçš„pod","like_count":0},{"had_liked":false,"id":305360,"user_name":"å—ç›ä¸€æ¢¦","can_delete":false,"product_type":"c1","uid":1030082,"ip_address":"","ucode":"6338D5428DB2B0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b7/c2/196932c7.jpg","comment_is_top":false,"comment_ctime":1627918836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627918836","product_id":100015201,"comment_content":"å†…å®¹å¤ªå¤šäº†ã€‚ã€‚ã€‚å¾—æ¶ˆåŒ–æ¶ˆåŒ–","like_count":0},{"had_liked":false,"id":298800,"user_name":"é’è‹¹æœ","can_delete":false,"product_type":"c1","uid":2057451,"ip_address":"","ucode":"D85EE1743F9CC5","user_header":"https://static001.geekbang.org/account/avatar/00/1f/64/eb/732e9707.jpg","comment_is_top":false,"comment_ctime":1624329279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624329279","product_id":100015201,"comment_content":"å‰åŠéƒ¨åˆ†è¿˜èƒ½è·Ÿä¸Šï¼ŒååŠéƒ¨åˆ†å°±ä¸€è„¸æ‡µé€¼äº†â€¦â€¦ ä¸çŸ¥é“è‡ªå·±ç¼ºåœ¨å“ªé‡Œâ€¦â€¦","like_count":0},{"had_liked":false,"id":296392,"user_name":"å°æ±Ÿå“¥å“¥","can_delete":false,"product_type":"c1","uid":1044266,"ip_address":"","ucode":"E5B3725FC9E366","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ef/2a/e9c5c163.jpg","comment_is_top":false,"comment_ctime":1622950924,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622950924","product_id":100015201,"comment_content":"å…³äºæ€è€ƒé¢˜ï¼Œè¦å®ç°è¯»å†™åˆ†ç¦»ï¼Œä»mysqlçš„å±‚é¢è¦èƒ½æä¾›å¹¶åŒºåˆ†ä¸»åº“ä¸ä»åº“çš„è®¿é—®æ–¹å¼ï¼Œä»ç¨‹åºçš„è§’åº¦è¦èƒ½åˆ†åˆ«æœ¬æ¬¡å¯¹æ•°æ®åº“çš„æ“ä½œæ˜¯è¯»è¿˜æ˜¯å†™ã€‚<br>ä»æ•°æ®åº“æä¾›ä¸»ä»ä¸åŒçš„è®¿é—®æ–¹å¼å¯ä»¥æœ‰ä¸‰ç§ç»“å±€æ–¹æ¡ˆ<br>ç¬¬ä¸€ç§å¯ä»¥è€ƒè™‘ç”¨å®šä¹‰ä¸¤ä¸ªstatefulsetçš„æ–¹å¼æŠŠmasterå’Œslaveåˆ†å¼€ï¼Œsvcå±‚é¢è‡ªç„¶å°±å¯ä»¥åˆ†å¼€è®¿é—®äº†ã€‚ç¬¬äºŒç§å¯ä»¥è€ƒè™‘é€šè¿‡headlessåŒºåˆ†ä¸»ä»çš„è®¿é—®æ–¹å¼ã€‚<br>ç¬¬ä¸‰ç§ç”¨oprateçš„æ–¹å¼<br>ä»ç¨‹åºè§’åº¦åŒºåˆ†å¯¹æ•°æ®åº“çš„è¯»å†™å¯ä»¥è€ƒè™‘å¯¹jdbcå¢å¼ºï¼Œæ¯”å¦‚Apache ShardingSphere","like_count":0},{"had_liked":false,"id":290539,"user_name":"é’±æ³¢","can_delete":false,"product_type":"c1","uid":1958295,"ip_address":"","ucode":"F8FAECCE410B23","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJiaeTzf4V8ib490WBo9AztRXE6ZM15zmFaOZtViabjleATARIpMe4Diaeia5mhGQibNAicAWH3iclCmweDicQ/132","comment_is_top":false,"comment_ctime":1619605054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619605054","product_id":100015201,"comment_content":"è¯·æ•™å¼ è€å¸ˆï¼šä¸»å¤‡é…ç½®æ–‡ä»¶åœ¨initContainersçš„è·¯å¾„æ˜¯&#47;mnt&#47;conf.d&#47;master.cnf è€Œå®é™…Containersè·¯å¾„æ˜¯åœ¨&#47;etc&#47;mysql&#47;conf.dï¼Œé…ç½®æ–‡ä»¶æ˜¯å†…å®¹æ˜¯æ€ä¹ˆè¿‡å»çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":287666,"user_name":"ANUBIS","can_delete":false,"product_type":"c1","uid":1802320,"ip_address":"","ucode":"86EDF421192D9F","user_header":"https://static001.geekbang.org/account/avatar/00/1b/80/50/6b6e0f72.jpg","comment_is_top":false,"comment_ctime":1618085966,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618085966","product_id":100015201,"comment_content":"CephBlockPoolå’ŒStorageClasséƒ½æˆåŠŸåˆ›å»ºäº†ï¼Œä½†æ˜¯æ‰§è¡Œstatefulsetçš„è„šæœ¬ï¼Œpvcåˆ›å»ºå¡åœ¨è¿™é‡Œ<br>persistentvolume-controller  waiting for a volume to be created, either by external provisioner &quot;ceph.rook.io&#47;block&quot; or manually created by system administrator<br>çœ‹æ ·å­æ²¡æœ‰è‡ªåŠ¨åˆ›å»ºå‡ºPVï¼Œæ±‚è§£ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½ï½","like_count":0},{"had_liked":false,"id":287145,"user_name":"noisyes","can_delete":false,"product_type":"c1","uid":2538540,"ip_address":"","ucode":"94EC310B284AD2","user_header":"https://static001.geekbang.org/account/avatar/00/26/bc/2c/963688bb.jpg","comment_is_top":false,"comment_ctime":1617794196,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617794196","product_id":100015201,"comment_content":"çœ‹äº†ä¸‹å…·ä½“å®ç°ï¼Œä¸‹æ¬¡é‡å¯é›†ç¾¤ï¼ŒmasterèŠ‚ç‚¹æ˜¯ä¸æ˜¯ä¹Ÿä¼šæ‰§è¡Œstart slaveæŒ‡ä»¤ï¼Œæ¯•ç«Ÿä¼šæœ‰xtrabackup_binlog_infoæ–‡ä»¶ï¼ˆvolumeæŒä¹…åŒ–æ•°æ®ï¼‰ï¼Œå°±ä¸€å®šä¼šç”Ÿæˆchange_master_to.sql.inï¼Œç„¶åå°±ä¼šæ‰§è¡Œstart slaveã€‚","like_count":0},{"had_liked":false,"id":286551,"user_name":"jiapeish","can_delete":false,"product_type":"c1","uid":1128561,"ip_address":"","ucode":"833983A5F074DF","user_header":"https://static001.geekbang.org/account/avatar/00/11/38/71/65f84229.jpg","comment_is_top":false,"comment_ctime":1617371001,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617371001","product_id":100015201,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆè¯´å®¹å™¨æ˜¯ä¸€ä¸ªå•è¿›ç¨‹æ¨¡å‹ï¼Ÿæˆ‘è®°å¾—ä¹‹å‰å…¬å¸é‡Œçš„ä¸šåŠ¡æ¨¡å‹ï¼Œæ¯ä¸ªå®¹å™¨é‡Œæœ‰2ä¸ªè¿›ç¨‹ï¼Œå¤šçš„æœ‰4ä¸ªè¿›ç¨‹ï¼Œå¥½åƒä¹Ÿè¿è¡Œçš„æŒºå¥½çš„","like_count":0},{"had_liked":false,"id":285719,"user_name":"Geek_f830f4","can_delete":false,"product_type":"c1","uid":2353215,"ip_address":"","ucode":"BB64CC824ADEC5","user_header":"","comment_is_top":false,"comment_ctime":1616989187,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616989187","product_id":100015201,"comment_content":"æˆ‘é‡‡ç”¨rook-ceph v1.5 çš„cluster-test.yamléƒ¨ç½²å•èŠ‚ç‚¹æ¨¡å¼, , åœ¨k8s1.13åŠæ›´é«˜ç‰ˆæœ¬ä¸­rook-cephé‡‡ç”¨CSI RBDé©±åŠ¨ï¼Œåœ¨k8s 1.12åŠæ›´æ—©ç‰ˆæœ¬é‡‡ç”¨Flex é©±åŠ¨ï¼Œå‚è€ƒé“¾æ¥ä¸º: https:&#47;&#47;rook.io&#47;docs&#47;rook&#47;v1.5&#47;ceph-block.html<br>[root@centos7 mysql_cluster]# cat rook-storage.yaml <br>apiVersion: ceph.rook.io&#47;v1<br>kind: CephBlockPool <br>metadata:<br>  name: replicapool<br>  namespace: rook-ceph<br>spec:<br>  failureDomain: host<br>  replicated:<br>    size: 1<br>---<br>apiVersion: storage.k8s.io&#47;v1<br>kind: StorageClass<br>metadata:<br>  name: rook-ceph-block<br>provisioner: rook-ceph.rbd.csi.ceph.com <br>allowVolumeExpansion: true<br>parameters:<br>  clusterID: rook-ceph<br>  pool: replicapool<br> # secret ï¼Œå¦åˆ™ä¼šæŠ¥é”™ provided secret is empty<br>  csi.storage.k8s.io&#47;provisioner-secret-name: rook-csi-rbd-provisioner<br>  csi.storage.k8s.io&#47;provisioner-secret-namespace: rook-ceph # namespace:cluster<br>  csi.storage.k8s.io&#47;controller-expand-secret-name: rook-csi-rbd-provisioner<br>  csi.storage.k8s.io&#47;controller-expand-secret-namespace: rook-ceph # namespace:cluster<br>  csi.storage.k8s.io&#47;node-stage-secret-name: rook-csi-rbd-node<br>  csi.storage.k8s.io&#47;node-stage-secret-namespace: rook-ceph # namespace:cluster<br>  csi.storage.k8s.io&#47;fstype: ext4<br><br># pvc-testæ–‡ä»¶<br>apiVersion: v1<br>kind: PersistentVolumeClaim<br>metadata:<br>  name: test<br>spec:<br>  accessModes:<br>  - ReadWriteOnce<br>  resources:<br>    requests:<br>      storage: 3Gi<br>  storageClassName: rook-ceph-block","like_count":0},{"had_liked":false,"id":282978,"user_name":"éƒ­è´»é“–","can_delete":false,"product_type":"c1","uid":2441261,"ip_address":"","ucode":"B14B1DB14031F2","user_header":"https://static001.geekbang.org/account/avatar/00/25/40/2d/9a766753.jpg","comment_is_top":false,"comment_ctime":1615506769,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1615506769","product_id":100015201,"comment_content":"[root]@[k8s-master]: -&gt; mysqlkubectl logs pod&#47;mysql-1 clone-mysql -n default    <br>+ [[ -d &#47;var&#47;lib&#47;mysql&#47;mysql ]]<br>++ hostname<br>+ [[ mysql-1 =~ -([0-9]+)$ ]]<br>+ ordinal=1<br>+ [[ 1 == 0 ]]<br>+ xbstream -x -C &#47;var&#47;lib&#47;mysql<br>+ ncat --recv-only mysql-0.mysql 3307<br>Ncat: Could not resolve hostname &quot;mysql-0.mysql&quot;: Name or service not known. QUITTING.<br>+ xtrabackup --prepare --target-dir=&#47;var&#47;lib&#47;mysql<br>xtrabackup version 2.4.4 based on MySQL server 5.7.13 Linux (x86_64) (revision id: df58cf2)<br>xtrabackup: cd to &#47;var&#47;lib&#47;mysql<br>xtrabackup: Error: cannot open .&#47;xtrabackup_checkpoints<br>xtrabackup: error: xtrabackup_read_metadata()<br>xtrabackup: This target seems not to have correct metadata...<br>InnoDB: Number of pools: 1<br>InnoDB: Operating system error number 2 in a file operation.<br>InnoDB: The error means the system cannot find the path specified.<br>xtrabackup: Warning: cannot open .&#47;xtrabackup_logfile. will try to find.<br>InnoDB: Operating system error number 2 in a file operation.<br>InnoDB: The error means the system cannot find the path specified.<br>  xtrabackup: Fatal error: cannot find .&#47;xtrabackup_logfile.<br>xtrabackup: Error: xtrabackup_init_temp_log() failed.<br><br><br><br>[root]@[k8s-master]: -&gt; mysql#kubectl logs pod&#47;mysql-0 clone-mysql -n default <br>+ [[ -d &#47;var&#47;lib&#47;mysql&#47;mysql ]]<br>++ hostname<br>+ [[ mysql-0 =~ -([0-9]+)$ ]]<br>+ ordinal=0<br>+ [[ 0 == 0 ]]<br>+ exit 0<br>[root]@[k8s-master]: -&gt; mysql#  å‡ºç°è¿™ä¸ªæ€ä¹ˆè§£å†³ï¼Ÿmysql-1ç¬¬äºŒä¸ª podå¯åŠ¨logsé‡Œé¢","like_count":0,"discussions":[{"author":{"id":2643364,"avatar":"https://static001.geekbang.org/account/avatar/00/28/55/a4/82ad7618.jpg","nickname":"å·¦æ‰‹è¾¹çš„æœŸå¾…","note":"","ucode":"F2BE238E518000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555613,"discussion_content":"ä½ å¥½ï¼Œè¯·é—®è¿™ä¸ªé—®é¢˜è§£å†³äº†å—?åŒæ ·çš„é—®é¢˜ï¼Œç½‘ä¸Šæœ‰è¯´æ˜¯é•œåƒçš„é—®é¢˜ï¼Œä¸æ¸…æ¥šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646991508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2372775,"avatar":"","nickname":"å­æ˜¥èŒ‚æ˜","note":"","ucode":"0DF01F84F6CD0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538283,"discussion_content":"æ‰¾ä¸åˆ°æœåŠ¡ï¼Œä½ è¦å…ˆåˆ›å»ºserviceæ‰è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639395169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282815,"user_name":"ä¸€ç§’","can_delete":false,"product_type":"c1","uid":1311001,"ip_address":"","ucode":"F149B7F60620BD","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","comment_is_top":false,"comment_ctime":1615427917,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1615427917","product_id":100015201,"comment_content":"yamlæ–‡ä»¶é“¾æ¥å¤±æ•ˆäº†","like_count":0,"discussions":[{"author":{"id":1442097,"avatar":"https://static001.geekbang.org/account/avatar/00/16/01/31/4d116521.jpg","nickname":"é¹é¹å“¥","note":"","ucode":"28452AB202EA9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370542,"discussion_content":"é¡¶ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619446958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278956,"user_name":"Scott","can_delete":false,"product_type":"c1","uid":1149152,"ip_address":"","ucode":"8736333CBF3F0E","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/e0/576c9598.jpg","comment_is_top":false,"comment_ctime":1613482974,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613482974","product_id":100015201,"comment_content":"å¼ è€å¸ˆå•¥æ—¶å›æ¥ä¸€æ³¢è®­ç»ƒè¥è¯¾ç¨‹ï¼ŒæœŸå¾…ï¼","like_count":0},{"had_liked":false,"id":274906,"user_name":"Jay66","can_delete":false,"product_type":"c1","uid":2398816,"ip_address":"","ucode":"0461952B6DD4F1","user_header":"https://static001.geekbang.org/account/avatar/00/24/9a/60/4af14727.jpg","comment_is_top":false,"comment_ctime":1611215602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611215602","product_id":100015201,"comment_content":"æ±‚é—®ä¸‹ï¼šä¸€ä¸ªpodä¸­åº”ç”¨ç¨‹åºå’Œsidecardä¹‹é—´ï¼Œå¯åŠ¨é¡ºåºæ˜¯ä¸æ˜¯ä¸èƒ½ä¿è¯çš„ï¼Ÿå¦‚æœå…ˆæ‰§è¡Œåº”ç”¨ç¨‹åºçš„è¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å¯åŠ¨å°±ä¼šå¤±è´¥ï¼ŒStatefulSetä¼šå†æ¬¡é‡å¯ï¼Œæ­¤æ—¶restartä¼š+1ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":247689,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1599794512,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1599794512","product_id":100015201,"comment_content":"å¯¹äºè¯¾åé—®é¢˜æ¥è¯´,æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é‡æ–°åˆ’åˆ†Serviceçš„æ–¹å¼æ¥å®ç°<br>ç»™ä¸»èŠ‚ç‚¹åˆ’åˆ†ä¸€ä¸ªmysql-masterçš„serviceæ¥ä¿è¯ç»‘å®šæ¯æ¬¡è®¿é—®æŒ‡è®¿é—®ä¸»èŠ‚ç‚¹<br>å°†mysql-readæ”¹ä¸ºç»‘å®šæ‰€æœ‰çš„ä»èŠ‚ç‚¹,å°±æ˜¯ä¸çŸ¥é“è¿™æ ·èƒ½ä¸èƒ½èµ°å¾—é€š,ä¸è¡Œçš„è¯,å°±å°†ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸¤ä¸ªStatefulSet","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370978,"discussion_content":"serviceå’Œstatefulsetæ˜¯é€šè¿‡labelsç»‘å®šçš„ï¼Œç”±äºå•ä¸ªstatefulsetä¸­podæ ‡ç­¾æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆä½ ç»‘å®šè¯»å†™serviceæ—¶å°±æ²¡åŠæ³•åŒºåˆ†ä¸»ä»podäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619599794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244665,"user_name":"Geek_5227ac","can_delete":false,"product_type":"c1","uid":1607208,"ip_address":"","ucode":"8C468F5C45696E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiay65IMyD82E59Xnbp370ChMG3N9XQuXoKwfhZJ19zotzKMlJhwzBDxE61bp26jdkf54NY9L41yg/132","comment_is_top":false,"comment_ctime":1598606889,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1598606889","product_id":100015201,"comment_content":"é’ˆå¯¹æ€è€ƒé¢˜ï¼Œå¦‚æœå˜ä¸ºä¸»åªå†™ï¼Œä»åªè¯»çš„è¯ï¼Œåº”è¯¥ä¸»è¦æ”¹çš„æ˜¯serviceçš„yamlå®šä¹‰å—ï¼Œå¯ä¸å¯ä»¥è®¾ç½®ä¸åŒçš„é€‰æ‹©æ ‡ç­¾æ¥è®©k8så˜æ›´æ–°çš„ç»„å†…â€œä¸»èŠ‚ç‚¹â€å‘¢ï¼Œæ¯”å¦‚å¸¸è§„çš„mysql-readç‰ˆserviceåªä½œç”¨äºåŸèŠ‚ç‚¹mysql-2å’Œmysql-3äº†","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370980,"discussion_content":"serviceå’Œstatefulsetæ˜¯é€šè¿‡labelsç»‘å®šçš„ï¼Œç”±äºå•ä¸ªstatefulsetä¸­podæ ‡ç­¾æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆä½ ç»‘å®šè¯»å†™serviceæ—¶å°±æ²¡åŠæ³•åŒºåˆ†ä¸»ä»podäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619599854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242696,"user_name":"å¥‡å¥‡","can_delete":false,"product_type":"c1","uid":1399097,"ip_address":"","ucode":"BC86B0CB55E35A","user_header":"","comment_is_top":false,"comment_ctime":1597818620,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1597818620","product_id":100015201,"comment_content":"è®¨è®ºä¸€ä¸ªæç«¯çš„åœºæ™¯ï¼Œå¦‚æœåœ¨sidecaråˆšåˆšæ‰§è¡Œmv change_master_to.sql.in change_master_to.sql.origåå®¹å™¨è¿›ç¨‹æ­»æ‰äº†ï¼Œé‡å¯å®¹å™¨ã€‚æ–°å¯åŠ¨çš„å®¹å™¨å‘ç°change_master_to.sql.origå­˜åœ¨ï¼Œä»€ä¹ˆéƒ½ä¸åšï¼Œæ‰€ä»¥é™¤äº†å¼€ä¸€ä¸ªæ•°æ®å¤‡ä»½ç«¯å£å¤–ä»€ä¹ˆéƒ½ä¸åšï¼Œå²‚ä¸æ˜¯slaveçš„åŒæ­¥éƒ½æ²¡æœ‰æ‰§è¡Œï¼Œå°±å¯ä»¥å‘å¤–æä¾›æœåŠ¡äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370981,"discussion_content":"change_master_to.sql.inæ–‡ä»¶å¦‚æœæ²¡æ‰§è¡Œchange_masterçš„è¯ä½ æ‰§è¡Œstart slaveä¼šå¤±è´¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619600315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":240461,"user_name":"å¤§åŠ›æ°´æ‰‹Jerry","can_delete":false,"product_type":"c1","uid":1227840,"ip_address":"","ucode":"E4A6C71E275DB5","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/40/2279cfb5.jpg","comment_is_top":false,"comment_ctime":1596938994,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596938994","product_id":100015201,"comment_content":"å•nodeå¦‚ä½•æ­å»ºcephé›†ç¾¤ï¼Ÿå®˜æ–¹çš„commonï¼Œoperatorå’Œclusterå‡ ä¸ªyamléœ€è¦æ€ä¹ˆä¿®æ”¹ï¼Ÿ","like_count":0},{"had_liked":false,"id":240460,"user_name":"å¤§åŠ›æ°´æ‰‹Jerry","can_delete":false,"product_type":"c1","uid":1227840,"ip_address":"","ucode":"E4A6C71E275DB5","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/40/2279cfb5.jpg","comment_is_top":false,"comment_ctime":1596938982,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596938982","product_id":100015201,"comment_content":"æˆ‘ç”¨hostpathåˆ›å»ºäº†ä¸‰ä¸ªpvä¹Ÿç®—æ˜¯æ»¡è¶³äº†è¿™ä¸ªå®éªŒçš„è¦æ±‚ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒï¼š<br>apiVersion: v1<br>kind: PersistentVolume<br>metadata:<br>  name: pv-hostpath<br>spec:<br>  capacity:<br>    storage: 500Mi<br>  accessModes:<br>    - ReadWriteOnce<br>  hostPath:<br>    path: &quot;&#47;tmp&#47;kube&quot;","like_count":0},{"had_liked":false,"id":239452,"user_name":"cobb","can_delete":false,"product_type":"c1","uid":1421306,"ip_address":"","ucode":"0DFF2F0A683B61","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7hsTibhnpQPxd4YexYrFvySzvnmSIzSIpdhBtgcoGlV4hL1BFfttmhz8pdZPOjDQbtDggZyG6NMg/132","comment_is_top":false,"comment_ctime":1596535436,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1596535436","product_id":100015201,"comment_content":"çœ‹å®Œäº† åªèƒ½è¯´å¤§å†™çš„ç‰›é€¼ è¿™ä¹ˆå¤æ‚çš„éƒ¨ç½²æ–¹å¼ éƒ½èƒ½ç†çš„è¿™ä¹ˆæ¸…æ¥š","like_count":0,"discussions":[{"author":{"id":1400827,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/fb/b28e5d57.jpg","nickname":"peer","note":"","ucode":"D6D0A60B4736B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311758,"discussion_content":"èƒ½å¯¹åº”åˆ°æºç çš„ï¼Œ å®¹å™¨åŒ–æ„Ÿè§‰åªæ˜¯å¼€èƒƒèœäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602483117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235332,"user_name":"å¼€å¿ƒå“¥","can_delete":false,"product_type":"c1","uid":1705468,"ip_address":"","ucode":"D44C1F03B23C5A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/05/fc/bceb3f2b.jpg","comment_is_top":false,"comment_ctime":1594976934,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1594976934","product_id":100015201,"comment_content":"ä¸€ç›´pendingï¼Œè¦å¦‚ä½•åˆ›å»ºvolumeï¼Ÿ<br>waiting for a volume to be created, either by external provisioner &quot;ceph.rook.io&#47;block&quot; or manually created by system administrator","like_count":0,"discussions":[{"author":{"id":1705468,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/05/fc/bceb3f2b.jpg","nickname":"å¼€å¿ƒå“¥","note":"","ucode":"D44C1F03B23C5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292025,"discussion_content":"åº”è¯¥æ˜¯æˆ‘è‡ªå·±è·‘k8sçš„äº‘æœºçš„ç›˜é…å°äº†ï¼Œç”¨rook toolboxè¿›å»çœ‹äº† ceph dfï¼Œç©ºé—´ä¸å¤Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595055977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229653,"user_name":"Andy","can_delete":false,"product_type":"c1","uid":1119133,"ip_address":"","ucode":"4BCA899B8E4E85","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/9d/0ff43179.jpg","comment_is_top":false,"comment_ctime":1593088768,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593088768","product_id":100015201,"comment_content":"error while running &quot;VolumeBinding&quot; filter plugin for pod<br>å¦‚æœå‡ºç°è¿™ä¸ªé”™è¯¯ï¼Œæ’é™¤ä¸äº†ï¼Œå°±å…ˆä¸è¦ç”¨ rook-ceph-block<br><br>åˆ é™¤156è¡Œ ä»volumeClaimTemplates å¼€å§‹å¾€ä¸‹çš„å†…å®¹ï¼Œç„¶ååœ¨ç¬¬156è¡Œå¢åŠ å¦‚ä¸‹å†…å®¹<br>      - name: data<br>        emptyDir: {}<br><br>å¦å¿˜è®°è¿è¡Œ service.yaml<br>å¦‚æœå®¹å™¨å¯ä¸æ¥ï¼Œå°±ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ—¥å¿—ã€‚<br>kubectl logs mysql-1 -c init-mysql<br>kubectl logs mysql-1 -c clone-mysql","like_count":0},{"had_liked":false,"id":229145,"user_name":"Spring.Fred","can_delete":false,"product_type":"c1","uid":1055148,"ip_address":"","ucode":"66C84150ACC304","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/ac/32da70c9.jpg","comment_is_top":false,"comment_ctime":1592907896,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1592907896","product_id":100015201,"comment_content":"1.ä¸¤ä¸ªserviceçš„selector:éƒ½æŒ‡å‘app: mysqlï¼Œ æ˜¯è¿™ä¹ˆåŒºåˆ†è¯»å’Œå†™çš„å‘¢ï¼Ÿ<br>2.åº”ç”¨å±‚é¢æ˜¯è®¿é—®mysqlæ˜¯è¯»å’Œå†™ï¼Œ è®¿é—®mysql-readæ˜¯è¯»æ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1227840,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/40/2279cfb5.jpg","nickname":"å¤§åŠ›æ°´æ‰‹Jerry","note":"","ucode":"E4A6C71E275DB5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297437,"discussion_content":"mysqlè¿™ä¸ªserviceçš„ä½œç”¨å°±æ˜¯å›ºå®šstatefulSetçš„æ‹“æ‰‘ã€‚åªèƒ½ç»ç”±mysql-0.mysqlè¿™ä¸ªåŸŸåæ¥å†™åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596938339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224116,"user_name":"åŠ±ç ”å†°","can_delete":false,"product_type":"c1","uid":1106394,"ip_address":"","ucode":"FCBC8266018FA0","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/da/d7f591a7.jpg","comment_is_top":false,"comment_ctime":1591277711,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591277711","product_id":100015201,"comment_content":"æäº†å¥½ä¹…äº†æ²¡æˆåŠŸå•Šï¼Œæˆ‘å®‰è£…rook-cephç”¨çš„release1.3çš„ç‰ˆæœ¬ï¼Œå®‰è£…ä¹‹åæ²¡æœ‰ç”Ÿæˆç›¸å…³osdçš„å®¹å™¨ï¼Œæ‰€ä»¥è¿™é‡Œä¸€ç›´ä¸æˆåŠŸï¼Œå¥½éš¾å—å•Š","like_count":0},{"had_liked":false,"id":221915,"user_name":"Geek_2b4a91","can_delete":false,"product_type":"c1","uid":1994572,"ip_address":"","ucode":"242A32ED80C420","user_header":"","comment_is_top":false,"comment_ctime":1590633421,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1590633421","product_id":100015201,"comment_content":"è¯»å†™åˆ†ç¦»æˆ‘ä¸ªäººç†è§£åº”è¯¥å¯ä»¥åœ¨åšserviceçš„æ—¶å€™é€šè¿‡ä¸åŒçš„labelå»å£°æ˜read-serviceå’Œwrite-serviceï¼Œè¿™æ ·åœ¨ä»£ç ä¸­è¯»æ“ä½œä½¿ç”¨read-serviceï¼Œå†™æ“ä½œä½¿ç”¨write-serviceï¼Œè¿™æ ·åº”è¯¥æ˜¯ä¸€ä¸ªæ€è·¯æŠŠ","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370984,"discussion_content":"ä½ æ›´åº”è¯¥å…ˆç†è§£statefulsetçš„podå‰¯æœ¬çš„labelséƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ä½ å’‹ä¹ˆå»é€šè¿‡ä¸åŒçš„labelsç»‘å®šä¸åŒçš„service...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619600559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210155,"user_name":"å¥”è·‘","can_delete":false,"product_type":"c1","uid":1361556,"ip_address":"","ucode":"A64A0DCA50D9FA","user_header":"https://static001.geekbang.org/account/avatar/00/14/c6/94/48ca3281.jpg","comment_is_top":false,"comment_ctime":1587692223,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1587692223","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæ—¢ç„¶å®¹å™¨æ˜¯å•è¿›ç¨‹çš„ï¼Œé‚£å®¹å™¨é‡Œè¿è¡Œçš„JAVAé¡¹ç›®é‡Œé¢æ˜¯ä¸æ˜¯ä¹Ÿä¸èƒ½è°ƒç”¨Runtime.getRuntimeï¼ˆï¼‰.execï¼ˆâ€œchmod 777 aaaâ€ï¼‰ã€‚æœ€è¿‘æ‰“ç®—é¡¹ç›®è¿ç§»åˆ°äº‘ä¸Šï¼Œçªç„¶æƒ³åˆ°è¿™ä¸ªé—®é¢˜ã€‚","like_count":0,"discussions":[{"author":{"id":1217712,"avatar":"https://static001.geekbang.org/account/avatar/00/12/94/b0/b073fe8b.jpg","nickname":"aMaMiMoU","note":"","ucode":"AF1E6CA541E482","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319424,"discussion_content":"åº”è¯¥æ˜¯ä¸èƒ½è·‘çš„ï¼Œchmodæ‰§è¡Œå®Œä¹‹åæ˜¯ä¸æ˜¯å°±è¢«è®¤ä¸ºè¿›ç¨‹æ‰§è¡Œå®Œæˆï¼Œè¿™ä¸ªå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå°±åˆ°å¤´äº†å§ï¼Ÿæ¥¼ä¸»æœ‰è·‘ä¸€æŠŠåšæµ‹è¯•ä¹ˆï¼Œç»“æœå¦‚ä½•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604026784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194486,"user_name":"Geek_c22199","can_delete":false,"product_type":"c1","uid":1441876,"ip_address":"","ucode":"1CE5B65513E360","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2vn8hyjICTCletGs0omz28lhriaZKX2XX9icYzAEon2IEoRnlXqyOia2bEPP0j7T6xexTnr77JJic8w/132","comment_is_top":false,"comment_ctime":1585061922,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585061922","product_id":100015201,"comment_content":"Podæ²¡å®¹å™¨ä¸åˆ†å…ˆåï¼Œé™¤éæ˜¯initContainer;<br>å¤šä¸ªPodä¸€ä¸ªæ¨¡ç‰ˆ;<br>VolumeæŒ‚è½½åœ¨å®¹å™¨å†…ï¼Œä¸€ä¸ªConfigMapæŒ‚è½½å¤šä¸ªPod;<br>æœ€åæœ‰ä¸€ç‚¹æ²¡æ˜ç™½pvcTemplatesæ˜¯å¦‚ä½•æŒ‚è½½åˆ°å„ä¸ªPodå®¹å™¨çš„ï¼Œéœ€è¦è‡ªå·±å®è·µè¯•ä¸€ä¸‹","like_count":0,"discussions":[{"author":{"id":2121783,"avatar":"https://static001.geekbang.org/account/avatar/00/20/60/37/fdbacf02.jpg","nickname":"å«æˆ‘å°å¢","note":"","ucode":"A789E8407A0DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302422,"discussion_content":"pvcæœ‰ä¸ªå­—æ®µnameï¼Œå®¹å™¨volumemountsé›†åˆä¸­é¡¹çš„nameå’Œpvcçš„nameä¸€æ ·å°±ç»‘å®šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598922143,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185688,"user_name":"StopLiu","can_delete":false,"product_type":"c1","uid":1007344,"ip_address":"","ucode":"1553FA4E3A285D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/f0/fab69114.jpg","comment_is_top":false,"comment_ctime":1583663124,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583663124","product_id":100015201,"comment_content":"å¼ å“¥ï¼Œä¸å¤ªæ˜ç™½DNSè®¿é—®è¿™å—ï¼Œè¿˜è¯·ä½ æŒ‡æ•™ã€‚æ—¢ç„¶DNSè§„åˆ™æ˜¯`&lt;pod-name&gt;.&lt;svc-name&gt;.&lt;namespace&gt;.svc.cluster.local`ï¼Œmysql -h mysql-3.mysql -e &quot;SELECT * FROM test.messages&quot;ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ˜¯mysql-3.mysqlï¼Œè€Œä¸æ˜¯mysql-3.mysql-readï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2121783,"avatar":"https://static001.geekbang.org/account/avatar/00/20/60/37/fdbacf02.jpg","nickname":"å«æˆ‘å°å¢","note":"","ucode":"A789E8407A0DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302424,"discussion_content":"åªæœ‰mysqlé‚£ä¸ªserviceæ˜¯headlessï¼Œåªæœ‰headlessæ‰èƒ½ä½¿ç”¨ä½ ä¸Šé¢çš„é‚£ä¸ªæ ¼å¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598922229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173137,"user_name":"timyl","can_delete":false,"product_type":"c1","uid":1226808,"ip_address":"","ucode":"678546ECE787FC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b8/38/f23fd852.jpg","comment_is_top":false,"comment_ctime":1579434218,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1579434218","product_id":100015201,"comment_content":"hi è€å¸ˆï¼Œè¯·é—®è¿™ä¸ªpvcçš„templateæ˜¯é€šè¿‡ä»€ä¹ˆå­—æ®µæ¥ç»‘å®špvçš„å‘¢ï¼Œæ­£å¸¸å¦‚æœå•ç‹¬åˆ›å»ºpvcï¼Œèƒ½å†™ä¸€ä¸ªstorageclassnameæ¥å’Œpvé‡Œè¾¹çš„å¯¹åº”ï¼Œä½†æ˜¯æˆ‘çœ‹ä½ è¿™ä¸ªä¾‹å­é‡Œè¾¹å¹¶æ²¡æœ‰ï¼Œå¦å¤–å¦‚æœpvæ˜¯ä½¿ç”¨æœ¬åœ°çš„ç›®å½•æ–¹å¼ï¼Œæ˜¯å¦èƒ½åŒ¹é…ä¸Šå‘¢ï¼Œåªæ˜¯ä¸ºäº†æµ‹è¯•ï¼Œè°¢è°¢","like_count":0,"discussions":[{"author":{"id":2117362,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4e/f2/a3314a28.jpg","nickname":"é¹¤æ— åŒ","note":"","ucode":"785B47B34FFBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356138,"discussion_content":"è‡ªåŠ¨åŒ¹é…ï¼Œå’Œä»–å¯¹åº”çš„è§„åˆ™ä»¥åŠè¦ä½¿ç”¨çš„å¤§å°ï¼Œå°±æœ€å°çš„æ¥åŒ¹é…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615538519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2121783,"avatar":"https://static001.geekbang.org/account/avatar/00/20/60/37/fdbacf02.jpg","nickname":"å«æˆ‘å°å¢","note":"","ucode":"A789E8407A0DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302425,"discussion_content":"pvcè‡ªåŠ¨ç»‘å®špvçš„ï¼Œæˆ–è€…ä½¿ç”¨selector","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598922289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172364,"user_name":"feihui","can_delete":false,"product_type":"c1","uid":1007294,"ip_address":"","ucode":"13F1D4A82BC650","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/be/9ea55f46.jpg","comment_is_top":false,"comment_ctime":1579161374,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1579161374","product_id":100015201,"comment_content":"è¯·æ•™ä¸‹ï¼Œä¹‹å‰å¯¹ Sidecar å®¹å™¨çš„ç†è§£æ˜¯åšä¸€äº›è¾…åŠ©æ€§çš„å·¥ä½œï¼Œåƒä¸Šé¢ xtrabackup çš„ Sidecar å®¹å™¨ä¸­æ‰§è¡Œ  START SLAVE æ˜¯åœ¨å½“å‰å®¹å™¨å³ Sidecar å®¹å™¨ä¸­å¯åŠ¨ä¸€ä¸ªè¿›è¡Œè·‘ salve mysql å—ï¼Ÿè¿™æ ·å­ä¸æ˜¯è·Ÿ Sidecar çš„èŒèƒ½ä¸ç¬¦åˆäº†ï¼Ÿä¸çŸ¥é“æˆ‘æœ‰æ²¡æœ‰ç†è§£æ­£ç¡®","like_count":0,"discussions":[{"author":{"id":2121783,"avatar":"https://static001.geekbang.org/account/avatar/00/20/60/37/fdbacf02.jpg","nickname":"å«æˆ‘å°å¢","note":"","ucode":"A789E8407A0DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302426,"discussion_content":"sidecaræ²¡æœ‰æ‰§è¡ŒSTART SLAVEè¿™æ¡å‘½ä»¤ï¼Œå®ƒåªæ˜¯ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œmysqlå®¹å™¨æ˜¯å»¶è¿Ÿå¯åŠ¨çš„ï¼Œå¯åŠ¨åä¼šè‡ªåŠ¨è¯»å–è¿™ä¸ªæ–‡ä»¶ä¸­çš„å‘½ä»¤ï¼Œå› ä¸ºä¸€ä¸ªpodä¸­çš„å¤šä¸ªå®¹å™¨å…±äº«åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598922441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145949,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1572405768,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1572405768","product_id":100015201,"comment_content":"è¯·é—®ä¸‹ï¼Œå½“æˆ‘éƒ¨ç½²å®Œmysqlåï¼Œå‡ºç°å…¶ä¸­mysql-0æ˜¯æ­£å¸¸å¯åŠ¨çš„ï¼Œmysql-1å°±æŠ¥é”™åˆå§‹åŒ–çš„æ—¶å€™Ncatå“ªé‡ŒæŠ¥é”™mysql-0.mysql   æ²¡æœ‰è·¯ç”±ï¼Œä½†æ˜¯æˆ‘éƒ¨ç½²äº†centosï¼Œå†ä¸Šé¢å®‰è£…äº†nslookupåï¼Œæ˜¯èƒ½è§£æåˆ°mysql-0çš„podipçš„ã€‚ä¸çŸ¥é“æ˜¯å“ªé‡Œçš„é—®é¢˜ï¼Œæ±‚è§£ç­”ã€‚é”™è¯¯å†…å¦‚å¦‚ä¸‹ï¼š<br>+ ncat --recv-only mysql-0.mysql 3307<br>+ xbstream -x -C &#47;var&#47;lib&#47;mysql<br>Ncat: No route to host.<br>+ xtrabackup --prepare --target-dir=&#47;var&#47;lib&#47;mysql<br>xtrabackup version 2.4.4 based on MySQL server 5.7.13 Linux (x86_64) (revision id: df58cf2)<br>xtrabackup: cd to &#47;var&#47;lib&#47;mysql<br>xtrabackup: Error: cannot open .&#47;xtrabackup_checkpoints<br>xtrabackup: error: xtrabackup_read_metadata()<br>xtrabackup: This target seems not to have correct metadata...<br>InnoDB: Number of pools: 1<br>InnoDB: Operating system error number 2 in a file operation.<br>InnoDB: The error means the system cannot find the path specified.<br>xtrabackup: Warning: cannot open .&#47;xtrabackup_logfile. will try to find.<br>InnoDB: Operating system error number 2 in a file operation.<br>InnoDB: The error means the system cannot find the path specified.<br>  xtrabackup: Fatal error: cannot find .&#47;xtrabackup_logfile.<br>xtrabackup: Error: xtrabackup_init_temp_log() failed.<br>","like_count":0,"discussions":[{"author":{"id":2441261,"avatar":"https://static001.geekbang.org/account/avatar/00/25/40/2d/9a766753.jpg","nickname":"éƒ­è´»é“–","note":"","ucode":"B14B1DB14031F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":355885,"discussion_content":"[root]@[k8s-master]: -> mysqlkubectl logs pod/mysql-1 clone-mysql -n default    \n+ [[ -d /var/lib/mysql/mysql ]]\n++ hostname\n+ [[ mysql-1 =~ -([0-9]+)$ ]]\n+ ordinal=1\n+ [[ 1 == 0 ]]\n+ xbstream -x -C /var/lib/mysql\n+ ncat --recv-only mysql-0.mysql 3307\nNcat: Could not resolve hostname &#34;mysql-0.mysql&#34;: Name or service not known. QUITTING.\n+ xtrabackup --prepare --target-dir=/var/lib/mysql\nxtrabackup version 2.4.4 based on MySQL server 5.7.13 Linux (x86_64) (revision id: df58cf2)\nxtrabackup: cd to /var/lib/mysql\nxtrabackup: Error: cannot open ./xtrabackup_checkpoints\nxtrabackup: error: xtrabackup_read_metadata()\nxtrabackup: This target seems not to have correct metadata...\nInnoDB: Number of pools: 1\nInnoDB: Operating system error number 2 in a file operation.\nInnoDB: The error means the system cannot find the path specified.\nxtrabackup: Warning: cannot open ./xtrabackup_logfile. will try to find.\nInnoDB: Operating system error number 2 in a file operation.\nInnoDB: The error means the system cannot find the path specified.\n  xtrabackup: Fatal error: cannot find ./xtrabackup_logfile.\nxtrabackup: Error: xtrabackup_init_temp_log() failed.\næˆ‘æ˜¯Ncat: Could not resolve hostname &#34;mysql-0.mysql&#34;: Name or service not known. QUITTING.è¿™ä¸ªæŠ¥é”™ï¼Œè¯·é—®ä½ çš„é—®é¢˜è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615508605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141296,"user_name":"å°å¤ªé˜³","can_delete":false,"product_type":"c1","uid":1566413,"ip_address":"","ucode":"80FD4A871ABFAD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e6/cd/bf5e928c.jpg","comment_is_top":false,"comment_ctime":1571136826,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1571136826","product_id":100015201,"comment_content":"initcontainerä¼šåœ¨statefulsetåˆå§‹åŒ–æ¯ä¸€ä¸ªpodä¹‹å‰éƒ½è¿è¡Œä¸€æ¬¡ä¹ˆï¼Ÿinitcontaineræ˜¯åœ¨æ“ä½œä¸Šä¸€ä¸ªç”Ÿæˆçš„podä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370989,"discussion_content":"æ¯ä¸€ä¸ªæ–°podå¯åŠ¨éƒ½ä¼šè¿è¡Œä¸€æ¬¡initcontainer","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619601406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141277,"user_name":"å°å¤ªé˜³","can_delete":false,"product_type":"c1","uid":1566413,"ip_address":"","ucode":"80FD4A871ABFAD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e6/cd/bf5e928c.jpg","comment_is_top":false,"comment_ctime":1571135031,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1571135031","product_id":100015201,"comment_content":"åœ¨initcontainerçš„commandéƒ¨åˆ†ï¼Œè¯•å›¾è¯»å–åº”ç”¨ç¨‹åºpodçš„hostnameã€‚å¯æ˜¯podä¸æ˜¯ç­‰initcontainerè¿è¡Œå®Œäº†æ‰åˆå§‹åŒ–ä¹ˆï¼Ÿé‚£æ ·è¿è¡Œinitcontainerçš„æ—¶å€™ï¼Œåº”ç”¨ç¨‹åºpodçš„hostnameä¸æ˜¯è¿˜ä¸å­˜åœ¨ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1254691,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/23/06a37753.jpg","nickname":"jesse","note":"","ucode":"8A72075A22D973","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370990,"discussion_content":"initcontainerå°±æ˜¯podé‡Œè¿è¡Œçš„å®¹å™¨ï¼Œé‚£ä¹ˆè¿è¡Œinitcontainer podè‚¯å®šåˆå§‹åŒ–è¿‡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619601512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132370,"user_name":"æ¨å¤©ä¸€","can_delete":false,"product_type":"c1","uid":1640301,"ip_address":"","ucode":"3A10AEFA182A88","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOsGtyIibIo4rvFgbVUiabeVCLMx5nNicfy25LiaNXRtZC9yEpNxkuiax5IMbb02aHoCjj1FWYJQZd9WQ/132","comment_is_top":false,"comment_ctime":1568101568,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568101568","product_id":100015201,"comment_content":"æ‚¨å¥½ï¼Œæƒ³å’¨è¯¢ä¸‹æœ‰æ²¡æœ‰å…¨éƒ¨çš„Yamlæ–‡ä»¶ä»¥åŠå®ƒä»¬çš„å¯åŠ¨é¡ºåºã€‚æˆ‘ä½¿ç”¨apply -f configmap.yamlåæç¤ºgot &quot;string&quot;, expected &quot;map&quot;; if you choose to ignore these errors,turn validation off withâ€¦â€¦","like_count":0},{"had_liked":false,"id":110338,"user_name":"kkkkka","can_delete":false,"product_type":"c1","uid":1281992,"ip_address":"","ucode":"6885A932DDAB8E","user_header":"","comment_is_top":false,"comment_ctime":1562232156,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562232156","product_id":100015201,"comment_content":"ä¹‹å‰æˆ‘è§£å†³çš„åŠæ³•æ˜¯ç”¨deploymentï¼Œæ¯ä¸ªéƒ½æœ‰æƒé™å»è·å–é›†ç¾¤çš„çŠ¶æ€ï¼Œè¿™å—æ˜¯ç”¨äº†ä¸€äº›è‡ªå®šä¹‰çš„é•œåƒã€‚è·å–åˆ°çŠ¶æ€åä¼šç»™è‡ªå·±çš„pod update tagï¼Œserviceå…¶å®æ˜¯é€šè¿‡æ·»åŠ äº†æ¯”è¾ƒå¤šçš„selectoræ¥åˆ¤æ–­çš„ã€‚","like_count":0},{"had_liked":false,"id":105806,"user_name":"18646333118","can_delete":false,"product_type":"c1","uid":1202411,"ip_address":"","ucode":"35576AC4E5ADDD","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/eb/cf3608bd.jpg","comment_is_top":false,"comment_ctime":1561086025,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561086025","product_id":100015201,"comment_content":"statefulset å¤„ç†æœ‰çŠ¶æ€åº”ç”¨æ„Ÿè§‰å¾ˆå¤æ‚ï¼Œè¿™ä¸ªç« èŠ‚ä¼°è®¡è¦æ¶ˆåŒ–å¾ˆä¹…","like_count":0},{"had_liked":false,"id":105800,"user_name":"18646333118","can_delete":false,"product_type":"c1","uid":1202411,"ip_address":"","ucode":"35576AC4E5ADDD","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/eb/cf3608bd.jpg","comment_is_top":false,"comment_ctime":1561085494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561085494","product_id":100015201,"comment_content":"statefulset è§£å†³æœ‰çŠ¶æ€åº”ç”¨è¿˜çœŸæ˜¯å‘å¤æ‚å•Šï¼Œè¿™èŠ‚å°±å¤Ÿæ¶ˆåŒ–çš„äº†","like_count":0},{"had_liked":false,"id":105494,"user_name":"ä¸ç»æ„é—´","can_delete":false,"product_type":"c1","uid":1261493,"ip_address":"","ucode":"C39D98697ACB8B","user_header":"https://static001.geekbang.org/account/avatar/00/13/3f/b5/5fe77e16.jpg","comment_is_top":false,"comment_ctime":1561014613,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1561014613","product_id":100015201,"comment_content":"å…¶å®ä¹Ÿæ²¡å¿…è¦æ‹·è´ä¸»çš„æ•°æ®æ–‡ä»¶å§ã€‚åªè¦ä¸»çš„binaryæ—¥å¿—ä¸€ç›´åœ¨ï¼Œä»èŠ‚ç‚¹åªéœ€è¦æŒ‡å®šä¸»èŠ‚ç‚¹çš„åœ°å€å°±å¥½ã€‚<br>å½“ç„¶ï¼Œè¿è¡Œä¸€æ®µæ—¶é—´åçš„mysqlå¯èƒ½æ•°æ®ä¼šæ¯”è¾ƒå¤§ï¼Œè‡ªåŠ¨åŒæ­¥ä¸æ–¹ä¾¿ï¼›binaryæ—¥å¿—éšç€æ—¶é—´çš„æ¨ç§»è¶Šæ¥è¶Šå¤šï¼Œå¯èƒ½ä¼šé™åˆ¶binaryæ—¥å¿—çš„ä¸ªæ•°æ—§çš„binaryè¢«åˆ é™¤ï¼Œæ— æ³•ç›´æ¥åŒæ­¥ã€‚","like_count":0,"discussions":[{"author":{"id":1356206,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/ae/344fbda3.jpg","nickname":"è¿½é£","note":"","ucode":"D1D463D7B911A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270419,"discussion_content":"æ•°æ®åŒæ­¥ï¼Œç¬¬ä¸€æ¬¡éš¾é“ä¸éœ€è¦å…¨é‡+å¢é‡ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589996354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99689,"user_name":"Dem","can_delete":false,"product_type":"c1","uid":1032595,"ip_address":"","ucode":"C09FF65D904A75","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/93/e8bfb26e.jpg","comment_is_top":false,"comment_ctime":1559280342,"is_pvip":false,"replies":[{"id":"36300","content":"è°¢è°¢æŒ‡å‡º","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1559619273,"ip_address":"","comment_id":99689,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559280342","product_id":100015201,"comment_content":"&quot;Master èŠ‚ç‚¹å’Œ Salve èŠ‚ç‚¹éœ€è¦èƒ½å¤Ÿä¼ è¾“å¤‡ä»½ä¿¡æ¯æ–‡ä»¶ï¼›&quot;<br>&quot;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ä¸€èµ·è§£å†³â€œç¬¬äºŒåº§å¤§å±±ï¼šMaster èŠ‚ç‚¹å’Œ Salve èŠ‚ç‚¹éœ€è¦èƒ½å¤Ÿä¼ è¾“å¤‡ä»½æ–‡ä»¶â€çš„é—®é¢˜ã€‚&quot;<br>ä¸¤ä¸ªæ‹¼å†™é”™è¯¯ï¼šSalve-&gt;Slave<br>","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452224,"discussion_content":"è°¢è°¢æŒ‡å‡º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559619273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90155,"user_name":"cuikt","can_delete":false,"product_type":"c1","uid":1242702,"ip_address":"","ucode":"9A1DB426CEFEEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/4e/0066303c.jpg","comment_is_top":false,"comment_ctime":1556433778,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556433778","product_id":100015201,"comment_content":"åœ¨å®é™…çš„åœºæ™¯ä¸­ï¼Œå¾ˆå¤šæ—¶å€™mySQLéƒ¨ç½²æ¶æ„æ¯”è¿™å¤æ‚çš„å¤šã€‚åˆè¯¥å¦‚ä½•è€ƒè™‘å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":89505,"user_name":"ç½—å¸®å¥","can_delete":false,"product_type":"c1","uid":1271773,"ip_address":"","ucode":"8598D116E1FC3C","user_header":"https://static001.geekbang.org/account/avatar/00/13/67/dd/55aa6e07.jpg","comment_is_top":false,"comment_ctime":1556189187,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1556189187","product_id":100015201,"comment_content":"æœ‰äººèƒ½æŠŠè¿™ä¸ªMysql çš„demoè·‘é€šçš„ä¹ˆã€‚å„ç§æ–¹å¼éƒ½æ²¡åŠæ³•è·‘é€šï¼Œä¸€ç›´æ˜¯pod has unbound immediate PersistentVolumeClaims (repeated 2 times)","like_count":0,"discussions":[{"author":{"id":1109018,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ec/1a/f0dbaad3.jpg","nickname":"é¾™î“î”¤","note":"","ucode":"7ADB94BF8140E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4682,"discussion_content":"èŠ‚ç‚¹å¤ªå°‘äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565660970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88817,"user_name":"ç½—å¸®å¥","can_delete":false,"product_type":"c1","uid":1271773,"ip_address":"","ucode":"8598D116E1FC3C","user_header":"https://static001.geekbang.org/account/avatar/00/13/67/dd/55aa6e07.jpg","comment_is_top":false,"comment_ctime":1556007632,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1556007632","product_id":100015201,"comment_content":"æˆ‘ä¹Ÿæ˜¯ç»‘å®šäº†storageClassNameï¼Œå¯ç”¨äº†ä¸‰ä¸ªnode, è¿˜æ˜¯ä¼šæŠ¥é”™pod has unbound immediate PersistentVolumeClaims (repeated 2 times)ã€‚è€Œä¸”ï¼Œè¿™ä¸ªæå®¢æ—¶é—´åªèƒ½è€å®å›å¤è¯„è®ºï¼Œå­¦ç”Ÿéƒ½æ²¡åŠæ³•è®¨è®ºå’Œäº’ç›¸å›å¤ï¼Œæˆ‘ä¹Ÿæ˜¯é†‰çš„","like_count":0,"discussions":[{"author":{"id":1109018,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ec/1a/f0dbaad3.jpg","nickname":"é¾™î“î”¤","note":"","ucode":"7ADB94BF8140E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4683,"discussion_content":"æ£€æŸ¥nodeæ˜¯å¦æœ‰æ•ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565661029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81015,"user_name":"Geek_e71c3c","can_delete":false,"product_type":"c1","uid":1088807,"ip_address":"","ucode":"707D00CF61694D","user_header":"https://static001.geekbang.org/account/avatar/00/10/9d/27/7e36c9b2.jpg","comment_is_top":false,"comment_ctime":1553776321,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553776321","product_id":100015201,"comment_content":"æŠŠæ•°æ®å­˜å‚¨åœ¨cephç­‰åˆ†å¸ƒå¼å…±äº«å‚¨å­˜ä¸­ï¼Œä¸ä¼šå¯¼è‡´è¯»å†™é€Ÿåº¦ç‰¹åˆ«æ…¢å—ï¼Œæ€§èƒ½åº”è¯¥ä¸è¶³ä»¥ç”Ÿäº§ä½¿ç”¨å§ï¼Ÿå¦‚æœç¡®å®æ€§èƒ½å·®ï¼Œæœ‰ä»€ä¹ˆå…¶ä»–è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿè°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":77033,"user_name":"è¦æ²¡æ—¶é—´äº†","can_delete":false,"product_type":"c1","uid":1015973,"ip_address":"","ucode":"6578732FB4C5B0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/a5/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1552811648,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1552811648","product_id":100015201,"comment_content":"å…³äºæ€è€ƒé¢˜å…¶å®æœ¬è´¨ä¸Šè¿˜æ˜¯ã€ŒPod å¦‚ä½•å¯¹å¤–æš´éœ²è‡ªå·±ã€çš„é—®é¢˜ã€‚ä¹‹å‰æåˆ°è¿‡ Headless Service å’Œ  Normal Service çš„åŒºåˆ«ï¼Œå…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å°±æ˜¯ Normal ç±»å‹çš„å¯ä»¥åšè´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡ä¸€å®šç­–ç•¥æˆ–è€…éšæœºå°†è®¿é—®æµé‡å¯¼å…¥åˆ°åé¢çš„ Podï¼Œ è€Œ Headless Service å°±æ²¡æœ‰è¿™ç§åŠŸèƒ½äº†ï¼Œå®ƒæ˜¯ç›´æ¥ç»™ Sts å†…çš„ Pod ç”Ÿæˆä¸€æ¡ DNSè®°å½•ï¼Œpod DNS Name ç›´æ¥å¯¹åº” Pod IPã€‚<br><br>æ‰€ä»¥ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ª Normal ç±»å‹çš„ Serviceï¼Œé€šè¿‡ label selector é€‰æ‹©æ‰€æœ‰çš„ slave èŠ‚ç‚¹ï¼Œç„¶åå°†è¿™ä¸ª Service åœ°å€æš´éœ²ç»™æœ‰è¯»å–éœ€æ±‚çš„ç”¨æˆ·ã€‚å¦å¤–ï¼Œå¦‚æœä¸æƒ³ç›´æ¥é€šè¿‡ master çš„ dns name è®¿é—®ï¼Œæˆ–è€…å‹æ ¹ master å°±æœ‰å¤šä¸ªï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§å¤„ç† slave èŠ‚ç‚¹çš„æ€è·¯ã€‚åˆ›å»ºæ–°çš„ Service å»åšè¿™ä»¶äº‹æƒ…ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯åœ¨ label Selector çš„ç­›é€‰æ¡ä»¶ä¸Š","like_count":0,"discussions":[{"author":{"id":1356206,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/ae/344fbda3.jpg","nickname":"è¿½é£","note":"","ucode":"D1D463D7B911A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270417,"discussion_content":"åŒä¸€ä¸ªst ï¼Œåˆ›å»ºçš„pod lable éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½ æ€ä¹ˆé€šè¿‡lable selectoré€‰æ‹©ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589996165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73553,"user_name":"Geek_32a1cf","can_delete":false,"product_type":"c1","uid":1203854,"ip_address":"","ucode":"319DDD9BAB6772","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLDC4cj2XKjHPNdOiaZR6oxeO36umdW8cnuW0YfyKCfpia883ib4RheBicuL2TPhMY14HQ7e7Dl4Zvhd8w/132","comment_is_top":false,"comment_ctime":1551923881,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551923881","product_id":100015201,"comment_content":"è€å¸ˆï¼Œmysqlçš„è¿™ç§é›†ç¾¤çš„æ­å»ºæ–¹å¼ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹æ€ä¹ˆèƒ½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å‘¢","like_count":0},{"had_liked":false,"id":72348,"user_name":"è°›å¬","can_delete":false,"product_type":"c1","uid":1228687,"ip_address":"","ucode":"7539D5B06662EA","user_header":"https://static001.geekbang.org/account/avatar/00/12/bf/8f/51f044dc.jpg","comment_is_top":false,"comment_ctime":1551593498,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551593498","product_id":100015201,"comment_content":"xtrabackup å’Œ mysql çš„å¯åŠ¨æœ‰å…ˆåé¡ºåºå—ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œå¦‚ä½•ä¿è¯çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":72150,"user_name":"ä»˜æµ·æ¸…","can_delete":false,"product_type":"c1","uid":1389924,"ip_address":"","ucode":"0E100B9F392EC9","user_header":"https://static001.geekbang.org/account/avatar/00/15/35/64/e1921b8b.jpg","comment_is_top":false,"comment_ctime":1551529757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551529757","product_id":100015201,"comment_content":"å¼ è€å¸ˆï¼Œæ‚¨å¥½ï¼Œä¹‹æ‰€ä»¥InitContainerå¯ä»¥æ£€æµ‹åˆ°ä¸»å®¹å™¨çš„hostnameï¼Œå¹¶æ ¹æ®IDæ‰§è¡Œä¸»ä»æ“ä½œï¼Œæ˜¯å› ä¸ºInitContainerå’Œä¸»å®¹å™¨åœ¨åŒä¸€ä¸ªPODé‡Œé¢ï¼Œä»è€Œå…±äº«å­˜å‚¨ï¼Œç½‘ç»œï¼Œä»¥åŠç›¸åº”namespaceã€‚è¿™æ ·ç†è§£å¯¹ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":62661,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1548125554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548125554","product_id":100015201,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸‹ã€‚è¿™é‡Œéƒ¨ç½²å‡ºæ¥çš„mysqlé›†ç¾¤ï¼Œå‡å¦‚æˆ‘æœ‰éœ€æ±‚ï¼Œè¦ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼ˆå¯è§†åŒ–ï¼‰å»è¿æ¥mysqlçš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¸”èƒ½æœ‰æ‰€æœ‰çš„æ“ä½œçš„æƒé™ã€‚å¦‚ä½•æ¥åšå‘¢ï¼Ÿ   å°è¯•ç”¨nodeportçš„æ–¹å¼çš„è¯ï¼Œå§‹ç»ˆæ˜¯è¿æ¥åˆ°çš„slaveçš„èŠ‚ç‚¹ã€‚","like_count":0},{"had_liked":false,"id":53257,"user_name":"Francis","can_delete":false,"product_type":"c1","uid":1145834,"ip_address":"","ucode":"DC3F69EED29A5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/ea/70bf7e98.jpg","comment_is_top":false,"comment_ctime":1545620058,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545620058","product_id":100015201,"comment_content":"å­˜å‚¨æ’ä»¶rookä¸éœ€è¦æŒ‡å®šå­˜å‚¨ç›®å½•å—ï¼Ÿæ•°æ®æ–‡ä»¶ä¼šå­˜å‚¨åœ¨ä»€ä¹ˆä½ç½®å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":53256,"user_name":"Francis","can_delete":false,"product_type":"c1","uid":1145834,"ip_address":"","ucode":"DC3F69EED29A5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/ea/70bf7e98.jpg","comment_is_top":false,"comment_ctime":1545619942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545619942","product_id":100015201,"comment_content":" Failed to provision volume with StorageClass &quot;rook-ceph-block&quot;: invalid option &quot;value&quot; for volume plugin rookVolumeProvisioner   è€å¸ˆï¼Œåˆ›å»ºpodçš„æ—¶å€™æŠ¥é”™ï¼Œpvcä¸èƒ½å’Œpvç»‘å®šï¼Œèƒ½çœ‹ä¸‹æ€ä¹ˆè§£å†³å—","like_count":0},{"had_liked":false,"id":48731,"user_name":"eden","can_delete":false,"product_type":"c1","uid":1220656,"ip_address":"","ucode":"8A5620A5C4BDB8","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/30/5a7247eb.jpg","comment_is_top":false,"comment_ctime":1544525162,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544525162","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘æŒ‰ä½ çš„æ–¹æ³•æŠŠmysql ä¸»ä»é›†ç¾¤æ­å»ºå¥½äº†ï¼Œä½†æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœmysql persistent volumeå¤§å°éœ€è¦æ‰©å®¹æ€ä¹ˆåŠï¼Œè¿™ä¸ªä¸èƒ½é€šè¿‡kubeadm update æ¥å®ç°çš„ã€‚","like_count":0},{"had_liked":false,"id":47229,"user_name":"æ–™å³­æ˜¥é£","can_delete":false,"product_type":"c1","uid":1144484,"ip_address":"","ucode":"0FEA316B623161","user_header":"https://static001.geekbang.org/account/avatar/00/11/76/a4/acb15bc6.jpg","comment_is_top":false,"comment_ctime":1544082610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544082610","product_id":100015201,"comment_content":"$ kubectl describe pvc data-mysql-0 <br>è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ<br><br>Warning  ProvisioningFailed  2m (x2 over 2m)  ceph.rook.io&#47;block rook-ceph-operator-5bfbf654db-ff5tt 11b8281a-f855-11e8-8904-52168db40a83  Failed to provision volume with StorageClass &quot;rook-ceph-block&quot;: Failed to create rook block image replicapool&#47;pvc-2282d57d-f92b-11e8-8af8-fa163e3b8cd8: failed to create image pvc-2282d57d-f92b-11e8-8af8-fa163e3b8cd8 in pool replicapool of size 1073741824: Failed to complete &#39;&#39;: exit status 2. rbd: error opening pool &#39;replicapool&#39;: (2) No such file or directory<br>. output:<br>","like_count":0},{"had_liked":false,"id":39098,"user_name":"æ­»åçš„å¤©ç©º","can_delete":false,"product_type":"c1","uid":1045293,"ip_address":"","ucode":"1652F8C8FE12F5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/2d/4b7f12b6.jpg","comment_is_top":false,"comment_ctime":1542188032,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542188032","product_id":100015201,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸ªé—®é¢˜ï¼Œåšå®Œmysqlçš„æœ‰çŠ¶æ€åº”ç”¨ï¼Œå¦‚æœå¤–éƒ¨çš„åº”ç”¨è®¿é—®èŠ‚ç‚¹çš„è¯ï¼Œè¦ç”¨ä»€ä¹ˆæ–¹å¼æ¥åšå‘¢ï¼Œingresså—ï¼Ÿå¦å¤–ï¼Œæˆ‘å†™äº†ä¸ªä¸€ä¸ªcronjobå½“ä½œå®šæ—¶ä»»åŠ¡æ¥å¤‡ä»½æ•°æ®åº“çš„æ—¶å€™ï¼Œç™»å½•è´¦å·å¹¶ä¸æ˜¯cronjobæ‰€å¯å®¹å™¨çš„åœ°å€æˆ–è€…DNSï¼Œåè€Œæ˜¯172.17.0.1.è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å‘¢ã€‚","like_count":0},{"had_liked":false,"id":35110,"user_name":"killua","can_delete":false,"product_type":"c1","uid":1005951,"ip_address":"","ucode":"3108F880E48D3B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/7f/1c505317.jpg","comment_is_top":false,"comment_ctime":1540428223,"is_pvip":false,"replies":[{"id":"12530","content":"ä¸ºä»€ä¹ˆä¸å‹å¥½å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540439667,"ip_address":"","comment_id":35110,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1540428223","product_id":100015201,"comment_content":"k8s å†…éƒ¨åº”ç”¨è®¿é—®æ•°æ®åº“ è¦é€šè¿‡ mysql-idçš„æ–¹å¼ è¿™ç§å¯¹äºåº”ç”¨ä»£ç æ˜¯ä¸æ˜¯ä¸å¤ªå¥½ k8sé‡Œå¯ä»¥å±è”½idå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427452,"discussion_content":"ä¸ºä»€ä¹ˆä¸å‹å¥½å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540439667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33667,"user_name":"å½­é”","can_delete":false,"product_type":"c1","uid":1179669,"ip_address":"","ucode":"F2CB53DE42026D","user_header":"https://static001.geekbang.org/account/avatar/00/12/00/15/6e399ec7.jpg","comment_is_top":false,"comment_ctime":1539849531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539849531","product_id":100015201,"comment_content":"è¿™æ ·çš„æœ‰çŠ¶æ€åº”ç”¨æœ‰ä¸ªçº¦æŸï¼Œpodæ ‡è¯†ä¸€æ—¦ç¡®å®šï¼Œè§’è‰²å°±ç¡®å®šäº†ã€‚ä½†å®é™…åº”ç”¨ä¸­ï¼Œä¸èƒ½æœ‰è¿™æ ·çš„çº¦æŸï¼Œä¸»æŒ‚äº†ï¼Œè¦æœ‰ä¸€ä¸ªä»å‡ä¸»ã€‚è¿™å°±è¦æ±‚è‡³å°‘æœ‰é€‰ä¸»æœºåˆ¶ï¼Œæ‰€æœ‰çš„é…ç½®æ–‡ä»¶ä¹Ÿä¸èƒ½ä¾èµ–idç¡®å®šè§’è‰²ã€‚<br>è¿™æ€ä¹ˆç©å‘¢ï¼Ÿoperaterå—ï¼Ÿoperaterå¯ä»¥çœ‹æˆä¸€ä¸ªç‰¹å®šåº”ç”¨çš„sreä¿å§†å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":31067,"user_name":"IOVE.-Minn","can_delete":false,"product_type":"c1","uid":1227784,"ip_address":"","ucode":"9C637EEEF64057","user_header":"https://static001.geekbang.org/account/avatar/00/12/bc/08/c43f85d9.jpg","comment_is_top":false,"comment_ctime":1539079513,"is_pvip":false,"replies":[{"id":"11213","content":"æˆ‘åœ¨æ–‡ç« é‡Œè´´äº†é“¾æ¥å‘€","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539130938,"ip_address":"","comment_id":31067,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539079513","product_id":100015201,"comment_content":"è€å¸ˆèƒ½åˆ†äº«ä¸‹å®Œæ•´çš„yamlæ–‡ä»¶ä¹ˆï¼Ÿæ„Ÿè§‰è‡ªå·±æ¥æ‹¼æ¥çš„è¯å¾ˆè´¹æ—¶é—´ï¼Œè€Œä¸”é”™è¯¯å¥½å¤šå“¦ã€‚æ„Ÿè°¢","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426211,"discussion_content":"æˆ‘åœ¨æ–‡ç« é‡Œè´´äº†é“¾æ¥å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539130938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30912,"user_name":"Caesar","can_delete":false,"product_type":"c1","uid":1253220,"ip_address":"","ucode":"0319C9E19387CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/64/54458855.jpg","comment_is_top":false,"comment_ctime":1539046710,"is_pvip":true,"replies":[{"id":"11136","content":"è¯·å…³æ³¨åç»­å®¹å™¨è¿è¡Œæ—¶éƒ¨åˆ†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539054094,"ip_address":"","comment_id":30912,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539046710","product_id":100015201,"comment_content":"èƒ½ä¸èƒ½æŠŠkata-containerçš„ä¼˜åŠ¿ç®€å•è®²ä¸€ä¸‹ï¼Œæ¯•ç«Ÿkata-containerä¹Ÿæ˜¯è·‘åœ¨è™šæ‹Ÿæœºé‡Œçš„ã€‚æƒ³ä¸å‡ºæ¥å’Œdockerè·‘åœ¨è™šæ‹Ÿæœºé‡Œæœ‰å•¥æœ¬è´¨åŒºåˆ«ã€‚","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426144,"discussion_content":"è¯·å…³æ³¨åç»­å®¹å™¨è¿è¡Œæ—¶éƒ¨åˆ†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539054094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30720,"user_name":"åŒ—å¡","can_delete":false,"product_type":"c1","uid":1218128,"ip_address":"","ucode":"2D947A61689FC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/50/bde525b1.jpg","comment_is_top":false,"comment_ctime":1538982649,"is_pvip":false,"replies":[{"id":"11065","content":"åŸºæœ¬éƒ½å·²ç»è¦†ç›–åˆ°äº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538998851,"ip_address":"","comment_id":30720,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538982649","product_id":100015201,"comment_content":"å¼ è€å¸ˆç‰›é€¼ï¼çœ‹è¿™å¥—æ•™ç¨‹ç®€ç›´å¤ªçˆ½äº†ã€‚<br>æˆ‘è®°å¾—æœ‰ä¸€ç« ï¼Œè€å¸ˆè´´äº†ä¸€äº›k8så†…éƒ¨å®ç°çš„ä¼ªç ã€‚å¸Œæœ›è€å¸ˆåé¢åœ¨è®²ä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥å¤šè®²è®²k8sçš„è®¾è®¡æ€è·¯ï¼Œè´´ä¸€ç‚¹ä»£ç æˆ–è€…å†™ç‚¹ä¼ªç è¿™æ ·å­ã€‚é™¤äº†èƒ½æ›´å¥½çš„ä½¿ç”¨k8så¤–ï¼Œè¿˜å¯¹k8sçš„è®¾è®¡å’Œä»£ç æ€è·¯ç‰¹åˆ«æ„Ÿå…´è¶£ã€‚","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426072,"discussion_content":"åŸºæœ¬éƒ½å·²ç»è¦†ç›–åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538998851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30619,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1538961469,"is_pvip":false,"replies":[{"id":"11045","content":"initcontainerå°±æ˜¯ä¸ªæ™®é€šå®¹å™¨ï¼Œå®ƒå¯ä¸èƒ½æ“ä½œpodæœ¬èº«","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538969272,"ip_address":"","comment_id":30619,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538961469","product_id":100015201,"comment_content":"åœ¨ä¸ä½¿ç”¨è¯»å®šåˆ†ç¦»ä¸­é—´ä»¶çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨k8sçš„serviceçš„è¯ï¼Œç”±äºserviceåˆæ˜¯ä¾èµ–labelé€‰æ‹©podï¼Œæ‰€ä»¥çœ‹æ ·å­åªèƒ½ç»™podæ·»åŠ ç›¸åº”çš„labelæ¥åŒºåˆ†èŠ‚ç‚¹äº†ï¼Œè¿™ä¸ªå·¥ä½œå¯ä»¥æ”¾åœ¨init-containeré‡Œæ¥åšï¼Œä¸çŸ¥æ€è·¯æ˜¯å¦æ­£ç¡®ï¼Œè¿˜è¯·è€å¸ˆæŒ‡ç‚¹ä¸€ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426050,"discussion_content":"initcontainerå°±æ˜¯ä¸ªæ™®é€šå®¹å™¨ï¼Œå®ƒå¯ä¸èƒ½æ“ä½œpodæœ¬èº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538969272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30602,"user_name":"hugeo","can_delete":false,"product_type":"c1","uid":1042824,"ip_address":"","ucode":"438F289EDD21CD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e9/88/941e488a.jpg","comment_is_top":false,"comment_ctime":1538958949,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1538958949","product_id":100015201,"comment_content":"ç»™å¤§é”…ç‚¹èµï¼Œå°ç™½éƒ½çœ‹å¾—æ‡‚","like_count":0,"discussions":[{"author":{"id":2831526,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/34/a6/1562d30e.jpg","nickname":"é’æ˜¥åœ¨å­¦ä¹ ","note":"","ucode":"BC6F3CD835930F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586001,"discussion_content":"å°ç™½å¼€å‘ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¤æ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661933848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}