{"id":201165,"title":"31 | APIController：定义API的最佳实践","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/NET-Core\">https://gitee.com/geektime-geekbang/NET-Core</a></p>","comments":[{"had_liked":false,"id":180251,"user_name":"清涧飞鸟","can_delete":false,"product_type":"c3","uid":1706683,"ip_address":"","ucode":"15F3B5FD4D7822","user_header":"https://static001.geekbang.org/account/avatar/00/1a/0a/bb/2f3b6af3.jpg","comment_is_top":false,"comment_ctime":1582218818,"is_pvip":false,"replies":[{"id":70475,"content":"建议使用DataAnnotations的方式来控制\n或者通过 IPipelineBehavior 插入验证逻辑，\n将验证逻辑独立出来实现","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1582697241,"ip_address":"","comment_id":180251,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，viewmodel(输入参数)的验证，不在controller里做吗？","like_count":2,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484585,"discussion_content":"建议使用DataAnnotations的方式来控制\n或者通过 IPipelineBehavior 插入验证逻辑，\n将验证逻辑独立出来实现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582697241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214264,"discussion_content":"怎么独立出来？能给个例子吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585154732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095682,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b8/02/b2268557.jpg","nickname":"公号:阿Q看世界","note":"","ucode":"5BB20D829789D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":182620,"discussion_content":"也是在controller验证吧，比如在createOrderCommand","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582442310,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180536,"user_name":"高源","can_delete":false,"product_type":"c3","uid":1048887,"ip_address":"","ucode":"751B41FD38EF7D","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/37/12e4c9c9.jpg","comment_is_top":false,"comment_ctime":1582326364,"is_pvip":false,"replies":[{"id":70470,"content":"感谢反馈，后面做补充说明","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1582695886,"ip_address":"","comment_id":180536,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师你这讲的ddd领域驱动知识，应该有一节针对演示程序里面的具体设计实现有详细说明，我现在听课感觉就是这块知识点是说了不是很细，有些没明白就跳到下一个环节了","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484700,"discussion_content":"感谢反馈，后面做补充说明","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582695886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1809759,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/5f/8ac80c01.jpg","nickname":"Coder77","note":"","ucode":"5A133D1BA9981C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":183499,"discussion_content":"没有DDD的一些基础了解听起来确实挺累。你可以看看这系列文章， https://www.cnblogs.com/zhili/p/DDDSummary.html","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1582475253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214265,"discussion_content":"可以学习一下《DDD实战》一课。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585154773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245998,"user_name":"东方之猪","can_delete":false,"product_type":"c3","uid":1084850,"ip_address":"","ucode":"B6EA89F7FDBA3F","user_header":"https://static001.geekbang.org/account/avatar/00/10/8d/b2/1040992f.jpg","comment_is_top":false,"comment_ctime":1599127968,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"如果只是担心Iorderservice定义成公共属性的话，会被其他action中被意外替换的话；我们可以把它定义成readonly 私有字段，这样就只能限制在构造函数中赋值","like_count":1,"discussions":[{"author":{"id":1005290,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/56/ea/32608c44.jpg","nickname":"giteebravo","note":"","ucode":"C087E8D6B5A98B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307973,"discussion_content":"老师提到\n使用 fromservice 便于在单测中 mock\n但不知具体怎样去做\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600819709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369312,"user_name":"仄仄平平仄","can_delete":false,"product_type":"c3","uid":1091916,"ip_address":"广东","ucode":"0AFD349F15E9E1","user_header":"https://static001.geekbang.org/account/avatar/00/10/a9/4c/23509060.jpg","comment_is_top":false,"comment_ctime":1677389259,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"不知道什么原因\npublic async Task&lt;long&gt; CreateOrder([FromBody] CreateOrderCommand cmd)\n{\n\treturn await _meditor.Send(cmd, HttpContext.RequestAborted);\n}\n这段 return 后面一直报错，无法把object转换为long类型。必须要这样写才行\nreturn await _meditor.Send&lt;long&gt;(cmd, HttpContext.RequestAborted);\n给后面学习一点帮助吧","like_count":0},{"had_liked":false,"id":353872,"user_name":"布凡","can_delete":false,"product_type":"c3","uid":1202465,"ip_address":"湖南","ucode":"346FCD332F8BFA","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/21/d2efde18.jpg","comment_is_top":false,"comment_ctime":1659879067,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"虽然两年了，回过头来老师的课程依然超值","like_count":0}]}