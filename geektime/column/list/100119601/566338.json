{"id":566338,"title":"09ï½œReact Hooksï¼ˆä¸Šï¼‰ï¼šä¸ºä»€ä¹ˆè¯´åœ¨Reactä¸­å‡½æ•°ç»„ä»¶å’ŒHooksæ˜¯ç»é…ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å®‹ä¸€ç®ï¼Œæ¬¢è¿å›åˆ°Reactåº”ç”¨å¼€å‘çš„å­¦ä¹ ã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†Reactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬ç»„ä»¶å±‚é¢çš„æŒ‚è½½ã€æ›´æ–°ã€å¸è½½ã€é”™è¯¯å¤„ç†å››ä¸ªé˜¶æ®µï¼Œä»¥åŠæ¡†æ¶å±‚é¢çš„æ¸²æŸ“å’Œæäº¤è¿™ä¸¤ä¸ªé˜¶æ®µã€‚</p><p>åœ¨è¿™äº›é˜¶æ®µä¸­ï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†ç±»ç»„ä»¶çš„ <code>render</code>ã€<code>componentDidMount</code>ã€<code>componentWillUnmount</code> ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»¥åŠè¿™äº›æ–¹æ³•æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œä¹Ÿå¯¹æ¯”äº†å‡½æ•°ç»„ä»¶ä¸­çš„Hooksæ˜¯å¦‚ä½•å‚ä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ã€‚æœ€åï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>useEffect</code> Hookså‡½æ•°ï¼Œä¸º <code>oh-my-kanban</code> é¡¹ç›®æ–°åŠ äº†ä¸€ä¸ªå®šæ—¶æ›´æ–°å¡ç‰‡æ˜¾ç¤ºæ—¶é—´çš„åŠŸèƒ½ã€‚</p><p>æ•é”çš„ä½ å¯èƒ½å‘ç°äº†ï¼Œä¸ŠèŠ‚è¯¾ä¸­ä½ åªä¸ºå‡½æ•°ç»„ä»¶å†™äº†Hooksä»£ç ï¼Œè€Œç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä»…æ˜¯ä»‹ç»è€Œå·²ã€‚è¿˜æœ‰å°±æ˜¯æˆªæ­¢ç›®å‰ï¼Œ<code>oh-my-kanban</code>é¡¹ç›®é‡Œåªæœ‰å‡½æ•°ç»„ä»¶ï¼Œä¸€ä¸ªç±»ç»„ä»¶éƒ½æ²¡æœ‰â€”â€”åŒæ ·æ˜¯ç»„ä»¶ï¼Œç±»ç»„ä»¶æ€ä¹ˆå°±è¢«åŒºåˆ«å¯¹å¾…äº†å‘¢ï¼Ÿå…¶å®ä¸æ˜¯ç±»ç»„ä»¶æ‰äº†é“¾å­ï¼Œåªæ˜¯å‡½æ•°ç»„ä»¶åŠ Hooksè¿™å¯¹é»„é‡‘æ­æ¡£åæ¥å±…ä¸Šï¼ŒæŠ¢äº†ç±»ç»„ä»¶çš„é£å¤´ã€‚</p><p>æ¥ä¸‹æ¥ä½ å¯èƒ½è¿˜ä¼šæœ‰ç–‘é—®ï¼š</p><ul>\n<li>Hooksåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿ</li>\n<li>å‡½æ•°ç»„ä»¶åŠ Hookså¯ä»¥å®Œå…¨æ›¿ä»£ç±»ç»„ä»¶å—ï¼Ÿ</li>\n<li>è¿˜æœ‰å¿…è¦å­¦ä¹ ç±»ç»„ä»¶å—ï¼Ÿ</li>\n</ul><p>è¿™èŠ‚è¯¾å’Œä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†å­¦ä¹ Reactè‡ªv16.8.0ç‰ˆæœ¬åŠ å…¥çš„Hooks APIã€‚å½“ä½ å®Œæˆè¿™ä¸¤èŠ‚è¯¾çš„å­¦ä¹ ï¼Œç›¸ä¿¡åœ¨æŒæ¡Hooksä½¿ç”¨çš„åŒæ—¶ï¼Œä¹Ÿä¼šå¯¹å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶åœ¨ä»ŠåReactåº”ç”¨å¼€å‘ä¸­çš„åœ°ä½ï¼Œæ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹åˆ¤æ–­ã€‚</p><!-- [[[read_end]]] --><h2>ä»€ä¹ˆæ˜¯Hooksï¼Ÿ</h2><p>Hooksæ˜¯Reactå®ç°ç»„ä»¶é€»è¾‘çš„é‡è¦æ–¹å¼ï¼Œå¯ä»¥ç”¨æ¥æ“ä½œstateï¼Œå®šä¹‰å‰¯ä½œç”¨ï¼Œæ›´æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰Hooksã€‚Hookså€Ÿé‰´è‡ªå‡½æ•°å¼ç¼–ç¨‹ï¼Œä½†åŒæ—¶åœ¨ä½¿ç”¨ä¸Šä¹Ÿæœ‰ä¸€äº›é™åˆ¶ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸å¦¨å€ŸåŠ©å‡½æ•°å¼ç¼–ç¨‹ä¸­çº¯å‡½æ•°å’Œå‰¯ä½œç”¨è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ¥ç†è§£ä»€ä¹ˆæ˜¯Hooksã€‚</p><p>Reactå¯¹UIçš„<strong>ç†æƒ³æ¨¡å‹æ˜¯</strong> <code>UI=f(state)</code><strong>ï¼Œå…¶ä¸­UIæ˜¯è§†å›¾ï¼Œstateæ˜¯åº”ç”¨çŠ¶æ€ï¼Œfåˆ™æ˜¯æ¸²æŸ“è¿‡ç¨‹</strong>ã€‚æ¯”èµ·ç±»ç»„ä»¶ï¼Œ<strong>å‡½æ•°ç»„ä»¶æ›´åŠ è´´è¿‘è¿™ä¸€æ¨¡å‹</strong>ï¼Œä½†ä»åŠŸèƒ½æ¥çœ‹ï¼Œæ—©æœŸçš„å‡½æ•°ç»„ä»¶åŠŸèƒ½ä¸ç±»ç»„ä»¶ä»æœ‰ä¸å°å·®è·ã€‚</p><p>åœ¨React v0.14ã€v15ã€v16ï¼ˆv16.8.0ä¹‹å‰ï¼‰ç‰ˆæœ¬æ—¶ï¼Œå…ˆåæœ‰mix-inã€é«˜é˜¶ç»„ä»¶ã€recomposeæ¡†æ¶è¢«ç”¨æ¥å¼¥è¡¥è¿™ä¸ªå·®è·ã€‚ç›´åˆ°å®˜æ–¹åœ¨v16.8.0æ¨å‡ºHooksï¼Œå‡½æ•°ç»„ä»¶æ‰€ç¼ºå°‘çš„ä¸€å—æ‹¼å›¾ç»ˆäºè¡¥é½äº†ã€‚</p><p>è¿™é‡Œæä¸€ä¸‹<strong>çº¯å‡½æ•°</strong>ï¼ˆPure Functionï¼‰çš„æ¦‚å¿µã€‚å½“ä¸€ä¸ªå‡½æ•°æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ—¶ï¼Œå°±å¯ä»¥è¢«è®¤ä¸ºæ˜¯çº¯å‡½æ•°ï¼š</p><ol>\n<li>å‡½æ•°æ— è®ºè¢«è°ƒç”¨å¤šå°‘æ¬¡ï¼Œåªè¦å‚æ•°ç›¸åŒï¼Œè¿”å›å€¼å°±ä¸€å®šç›¸åŒï¼Œè¿™ä¸€è¿‡ç¨‹ä¸å—å¤–éƒ¨çŠ¶æ€æˆ–è€…IOæ“ä½œçš„å½±å“ï¼›</li>\n<li>å‡½æ•°è¢«è°ƒç”¨æ—¶ä¸ä¼šäº§ç”Ÿ<strong>å‰¯ä½œç”¨</strong>ï¼ˆSide Effectï¼‰ï¼Œå³ä¸ä¼šä¿®æ”¹ä¼ å…¥çš„å¼•ç”¨å‚æ•°ï¼Œä¸ä¼šä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼Œä¸ä¼šè§¦å‘IOæ“ä½œï¼Œä¹Ÿä¸ä¼šè°ƒç”¨å…¶ä»–ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„å‡½æ•°ã€‚</li>\n</ol><p>ä¸‹é¢è¿™æ®µJSä»£ç å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„çº¯å‡½æ•°ï¼Œå¯¹äºç»™å®šçš„ <code>a</code> å’Œ <code>b</code>ï¼Œè¿”å›å€¼æ°¸è¿œæ˜¯ä¸¤è€…ä¹‹å’Œï¼š</p><pre><code class=\"language-javascript\">const func = (a, b) =&gt; {\n  return a + b;\n};\n</code></pre><p>ç”¨çº¯å‡½æ•°çš„æ¦‚å¿µæ¥åˆ†æä¸‹é¢çš„Reactå‡½æ•°ç»„ä»¶ï¼Œå¯¹äºç»™å®šçš„props <code>a</code>å’Œ<code>b</code>ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè¿”å›ç›¸åŒçš„æ— åºåˆ—è¡¨å…ƒç´ ï¼š</p><pre><code class=\"language-javascript\">const Component = ({ a, b }) =&gt; {\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;{a}&lt;/li&gt;\n      &lt;li&gt;{b}&lt;/li&gt;\n    &lt;/ul&gt;\n  );\n};\n</code></pre><p>è™½ç„¶Reactå®˜æ–¹å¹¶æ²¡æœ‰ç±»ä¼¼çš„ææ³•ï¼Œä½†ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å§‘ä¸”æŠŠè¿™æ ·ç”¨çº¯å‡½æ•°çš„æ–¹å¼ç¼–å†™çš„Reactç»„ä»¶ç§°ä½œ<strong>â€œçº¯å‡½æ•°ç»„ä»¶â€ã€‚</strong>ç¼–å†™çº¯å‡½æ•°ç»„ä»¶ï¼Œ<strong>å¯ä»¥æœ€ç›´è§‚åœ°å±•ç¤ºè¾“å…¥çš„propsä¸è¾“å‡ºçš„æ¸²æŸ“å…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼Œéå¸¸åˆ©äºå¼€å‘è€…æŠŠæ¡ç»„ä»¶çš„å±‚æ¬¡ç»“æ„å’Œæ ·å¼ã€‚</strong></p><p>ä½†éœ€è¦çŸ¥é“ï¼Œè¿™æ ·çš„çº¯å‡½æ•°ç»„ä»¶é™¤äº†propsã€JSXå¤–ï¼Œå‡ ä¹ä¸èƒ½ä½¿ç”¨Reactç»„ä»¶çš„æ‰€æœ‰å…¶ä»–ç‰¹æ€§â€”â€”<strong>å¯¹äºçº¯å‡½æ•°ç»„ä»¶æ¥è¯´ï¼Œè¿™äº›å…¶ä»–ç‰¹æ€§å…¨éƒ¨éƒ½æ˜¯å¤–éƒ¨çŠ¶æ€æˆ–å‰¯ä½œç”¨</strong>ã€‚</p><p>åè¿‡æ¥è¯´ï¼Œè‹¥æƒ³è®©å‡½æ•°ç»„ä»¶ä½¿ç”¨è¿™äº›å…¶ä»–ç‰¹æ€§ï¼Œåªè¦è®©å®ƒä»¥æŸç§æ–¹å¼ï¼Œæ˜¾å¼åœ°è®¿é—®å‡½æ•°çš„å¤–éƒ¨çŠ¶æ€ï¼ˆåº”é™åˆ¶åœ¨Reactæ¡†æ¶çš„èŒƒå›´ä»¥å†…ï¼Œæ‰€ä»¥å¯¹Reactè€Œè¨€æ˜¯å†…éƒ¨çŠ¶æ€ï¼‰ï¼Œæˆ–è€…æ‰§è¡Œå‰¯ä½œç”¨å°±å¥½äº†ã€‚</p><p><strong>Hookså°±æ˜¯è¿™æ ·ä¸€å¥—ä¸ºå‡½æ•°ç»„ä»¶è®¾è®¡çš„ï¼Œç”¨äºè®¿é—®Reactå†…éƒ¨çŠ¶æ€æˆ–æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œï¼Œä»¥å‡½æ•°å½¢å¼å­˜åœ¨çš„React API</strong>ã€‚æ³¨æ„ï¼Œè¿™é‡Œæåˆ°çš„â€œReactå†…éƒ¨çŠ¶æ€â€æ˜¯æ¯”ç»„ä»¶stateæ›´å¹¿ä¹‰çš„ç»Ÿç§°ï¼Œé™¤äº†stateå¤–ï¼Œè¿˜åŒ…æ‹¬åé¢è¯¾ç¨‹ä¸­ä¼šè¯¦ç»†è®²è§£çš„contextã€memoã€refç­‰ã€‚</p><p>ä½œä¸ºä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢çš„â€œçº¯å‡½æ•°ç»„ä»¶â€ä»£ç ä¸­åŠ å…¥Hooksã€‚<code>useState</code> è¿™ä¸€Hookä¼šè¯»å–æˆ–å­˜å‚¨ç»„ä»¶çš„stateï¼ŒåŠ å…¥å®ƒï¼Œè®©å‡½æ•°ç»„ä»¶å…·æœ‰äº†æ“ä½œstateçš„èƒ½åŠ›ï¼š</p><pre><code class=\"language-javascript\">const Component = ({ a, b }) =&gt; {\n  const [m, setM] = useState(a); // ä¸€ä¸ªHook\n  const [n, setN] = useState(b); // å¦ä¸€ä¸ªHook\n  return (\n    &lt;ul&gt;\n      &lt;li&gt;{m}&lt;button onClick={() =&gt; setM(m + 1)}&gt;+&lt;/button&gt;&lt;/li&gt;\n      &lt;li&gt;{n}&lt;button onClick={() =&gt; setN(n + 1)}&gt;+&lt;/button&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n  );\n};\n</code></pre><p>è¦æ³¨æ„ä¸€ç‚¹ï¼Œç»„ä»¶çš„stateå¹¶ä¸æ˜¯ç»‘å®šåœ¨ç»„ä»¶çš„å‡½æ•°ä¸Šçš„ï¼Œè€Œæ˜¯ç»„ä»¶æ¸²æŸ“äº§ç”Ÿçš„è™šæ‹ŸDOMèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ <code>FiberNode</code> ä¸Šçš„ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„å‡½æ•°ä¸­è°ƒç”¨ <code>useState</code> ï¼Œæ„å‘³ç€å‡½æ•°å°†è®¿é—®å‡½æ•°æœ¬èº«ä»¥å¤–ã€Reactä»¥å†…çš„çŠ¶æ€ï¼Œè¿™å°±è®©å‡½æ•°äº§ç”Ÿäº†å‰¯ä½œç”¨ï¼Œå¯¼è‡´å‡½æ•°ä¸å†æ˜¯çº¯å‡½æ•°ï¼Œä¹Ÿæ„å‘³ç€å‡½æ•°ç»„ä»¶ä¸å†æ˜¯â€œçº¯å‡½æ•°ç»„ä»¶â€ã€‚</p><p>ä½†æˆ‘ä»¬ä»æ¥æ²¡æœ‰å¼ºæ±‚è¿‡ç»„ä»¶å‡½æ•°å¿…é¡»æ˜¯çº¯å‡½æ•°ï¼Œä¸æ˜¯å—ï¼ŸåŠ å…¥Hooksçš„å‡½æ•°ç»„ä»¶ä¸å†çº¯ç²¹ï¼Œä½†æ›´å¼ºå¤§ï¼Œå˜å¾—å¯ä»¥ä½¿ç”¨åŒ…å«stateåœ¨å†…çš„ã€Reactçš„å¤§éƒ¨åˆ†ç‰¹æ€§ã€‚çº¯å‡½æ•°ã€å¤–éƒ¨çŠ¶æ€å’Œå‰¯ä½œç”¨è¿™äº›æ¦‚å¿µï¼Œå¯ä»¥æˆä¸ºæˆ‘ä»¬å­¦ä¹ ä½¿ç”¨Hooksçš„å‚ç…§ç‰©ï¼Œä¹Ÿæ›´æ–¹ä¾¿æˆ‘ä»¬ç†è§£ã€åˆ†æReactç»„ä»¶ã€‚</p><p>æ­¤å¤–å¤šæä¸€ä¸‹ï¼Œåœ¨Reacté‡Œæœ‰ä¸ªæ¦‚å¿µå«â€œçº¯ç»„ä»¶â€ï¼Œä½†æˆ‘ä»¬å´ä¸èƒ½æŠŠä¸Šé¢çš„â€œçº¯å‡½æ•°ç»„ä»¶â€ç­‰åŒäºâ€œçº¯ç»„ä»¶â€ã€‚å› ä¸ºåœ¨Reacté‡Œï¼Œ<strong>çº¯ç»„ä»¶PureComponent</strong>æ˜¯ä¸€ä¸ªä¸»è¦ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„ç‹¬ç«‹APIï¼š<strong>å½“ç»„ä»¶çš„propså’Œstateæ²¡æœ‰å˜åŒ–æ—¶ï¼Œå°†è·³è¿‡è¿™æ¬¡æ¸²æŸ“</strong>ï¼Œç›´æ¥æ²¿ç”¨ä¸Šæ¬¡æ¸²æŸ“çš„ç»“æœã€‚</p><p>è€Œä¸Šé¢çš„<strong>å‡½æ•°ç»„ä»¶ï¼Œæ¯æ¬¡åœ¨æ¸²æŸ“é˜¶æ®µéƒ½ä¼šè¢«æ‰§è¡Œ</strong>ï¼Œå¦‚æœè¿”å›çš„å…ƒç´ æ ‘ç»è¿‡åè°ƒå¼•æ“æ¯”å¯¹åï¼Œä¸å‰ä¸€æ¬¡çš„æ²¡æœ‰å·®å¼‚ï¼Œåˆ™åœ¨æäº¤é˜¶æ®µä¸ä¼šæ›´æ–°å¯¹åº”çš„çœŸå®DOMã€‚</p><h2>React Hooksæœ‰å“ªäº›ï¼Ÿ</h2><p>äº†è§£äº†ä»€ä¹ˆæ˜¯Hooksï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹éƒ½æœ‰å“ªäº›Hooksã€‚React v18.2.0æä¾›çš„åŸºç¡€HooksåŒ…æ‹¬ä¸‰ä¸ªï¼š</p><ol>\n<li>useState</li>\n<li>useEffect</li>\n<li>useContext</li>\n</ol><p>å…¶ä»–Hooksï¼Œæœ‰äº›æ˜¯ä¸Šé¢åŸºç¡€Hooksçš„å˜ä½“ï¼Œæœ‰äº›è™½ç„¶ç”¨é€”ä¸åŒï¼Œä½†ä¸åŸºç¡€Hookså…±äº«åº•å±‚å®ç°ã€‚åŒ…æ‹¬åä¸ªï¼š</p><ol>\n<li>useReducer</li>\n<li>useMemo</li>\n<li>useCallback</li>\n<li>useRef</li>\n<li>useImperativeHandle</li>\n<li>useLayoutEffect</li>\n<li>useDebugValue</li>\n<li>useDeferredValue</li>\n<li>useTransition</li>\n<li>useId</li>\n</ol><p>æ­¤å¤–è¿˜æœ‰ä¸ºç¬¬ä¸‰æ–¹åº“ä½œè€…æä¾›çš„ <code>useSyncExternalStore</code> å’Œ <code>useInsertionEffect</code> ã€‚è™½ç„¶React APIä¸­æä¾›äº†è¿™ä¹ˆå¤šHooksï¼Œä½†å¹¶ä¸æ„å‘³ç€ä½ æ¯ä¸ªHookéƒ½è¦ç²¾é€šã€‚</p><p>æˆ‘çš„å»ºè®®æ˜¯ï¼Œé¦–å…ˆç²¾é€šä¸‰ä¸ªåŸºç¡€Hooksï¼Œä¹Ÿå°±æ˜¯ <code>useState</code> ã€ <code>useEffect</code> å’Œ <code>useContext</code>ã€‚ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šï¼š</p><ol>\n<li>æŒæ¡ <code>useRef</code> çš„ä¸€èˆ¬ç”¨æ³•ï¼›</li>\n<li>å½“éœ€è¦ä¼˜åŒ–æ€§èƒ½ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“æ—¶ï¼Œå­¦ä¹ æŒæ¡ <code>useMemo</code> å’Œ <code>useCallback</code> ï¼›</li>\n<li>å½“éœ€è¦åœ¨å¤§ä¸­å‹Reacté¡¹ç›®ä¸­å¤„ç†å¤æ‚stateæ—¶ï¼Œå­¦ä¹ æŒæ¡ <code>useReducer</code> ï¼›</li>\n<li>å½“éœ€è¦å°è£…ç»„ä»¶ï¼Œå¯¹å¤–æä¾›å‘½ä»¤å¼æ¥å£æ—¶ï¼Œå­¦ä¹ æŒæ¡ <code>useRef</code> åŠ  <code>useImperativeHandle</code>ï¼›</li>\n<li>å½“é¡µé¢ä¸Šç”¨æˆ·æ“ä½œç›´æ¥ç›¸å…³çš„ç´§æ€¥æ›´æ–°ï¼ˆUrgent Updatesï¼Œå¦‚è¾“å…¥æ–‡å­—ã€ç‚¹å‡»ã€æ‹–æ‹½ç­‰ï¼‰ï¼Œå—åˆ°å¼‚æ­¥æ¸²æŸ“æ‹–ç´¯è€Œäº§ç”Ÿå¡é¡¿ï¼Œéœ€è¦ä¼˜åŒ–æ—¶ï¼Œå­¦ä¹ æŒæ¡ <code>useDeferredValue</code> å’Œ <code>useTransition</code> ã€‚</li>\n</ol><p>å…¶ä¸­åŸºç¡€Hooksçš„ <code>useState</code> å’Œ <code>useEffect</code> ï¼Œæˆ‘ä»¬åˆ†åˆ«ä¼šåœ¨è¿™èŠ‚è¯¾å’Œä¸‹èŠ‚è¯¾è¯¦ç»†è®²è§£ï¼Œ<code>useContext</code> æ¶‰åŠåˆ°Contextï¼Œæˆ‘ä»¬ç•™åˆ°12ï½13èŠ‚è¯¾å†å±•å¼€ã€‚</p><p>åŸºç¡€Hooksä¹‹å¤–ï¼Œ<code>useRef</code> ä¹Ÿæ˜¯ç”¨æ¥æ“ä½œæ•°æ®çš„ï¼Œè€Œä¸”ç›¸å¯¹ç‹¬ç«‹ï¼Œæˆ‘ä»¬æ”¾åœ¨è¿™èŠ‚è¯¾æœ«å°¾æ¥è®²ã€‚<code>useMemo</code> å’Œ <code>useCallback</code> åœ¨æ¥å£å½¢å¼ä¸Šä¸useEffectæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¸€å¹¶æ”¾åˆ°ä¸‹èŠ‚è¯¾ä»‹ç»ã€‚</p><p>è¯¾ç¨‹ç¯‡å¹…æœ‰é™ï¼Œä¸€äº›ä¸å¸¸ç”¨æˆ–è€…è¿‡äºæ–°çš„Hooksæˆ‘ä»¬æš‚ä¸æ¶‰åŠï¼Œä½ å¦‚æœæ„Ÿå…´è¶£çš„è¯è¯·å‚è€ƒ<a href=\"https://zh-hans.reactjs.org/docs/hooks-reference.html\">Reactå®˜æ–¹Hooksæ–‡æ¡£</a>ã€‚ä¸‹é¢æˆ‘ä»¬å…ˆæ¥å­¦ä¹  <code>useState</code> å’Œå®ƒçš„ä¼™ä¼´ä»¬ã€‚</p><h2>çŠ¶æ€Hooks</h2><p>åœ¨ä¸Šé¢åˆ—ä¸¾çš„Hooksä¸­ï¼Œæ“ä½œstateçš„HookåŒ…æ‹¬<strong>åŸºç¡€çš„</strong> <code>useState</code> <strong>å’Œå®ƒçš„å˜ä½“</strong> <code>useReducer</code> ï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šå­¦ä¹ åˆ°ã€‚å¤šæä¸€ä¸‹ï¼Œå…¶ä¸­ <code>useState</code> æ˜¯æ‰€æœ‰Hooksä¸­<strong>æœ€</strong>å¸¸ç”¨çš„ï¼ˆæ²¡æœ‰ä¹‹ä¸€ï¼Œé¥é¥é¢†å…ˆï¼‰ï¼Œä¹‹æ‰€ä»¥è¯´æœ€å¸¸ç”¨ï¼Œæ˜¯å› ä¸ºå¼€å‘è€…ç»å¸¸åœ¨ä¸€ä¸ªç»„ä»¶é‡Œå†™å¤šä¸ª <code>useState</code> æ¥æ“ä½œå¤šä¸ªstateã€‚</p><p>æˆ‘ä»¬ä¸‹é¢å°†ä¼šè®²è§£çš„React 18åŠ å…¥çš„<strong>è‡ªåŠ¨æ‰¹å¤„ç†å¤šä¸ªstateæ›´æ–°</strong>çš„åŠŸèƒ½ï¼Œä¹Ÿå°è¯äº†Reactå®˜æ–¹æ˜¯é¼“åŠ±è¿™ç§ç”¨ä¾‹ã€‚</p><h3>useState</h3><p>å¦‚æœä½ è¿˜æœ‰å°è±¡ï¼Œæˆ‘ä»¬è¿™ä¸ªè¯¾ç¨‹é‡Œç¬¬ä¸€æ¬¡å‡ºç° <code>useState</code> æ˜¯åœ¨ç¬¬ä¸‰èŠ‚è¯¾ï¼Œå›å¿†ä¸€ä¸‹é‚£ä¸ªä¸å¤ªä¸¥è°¨ä½†å¾ˆæ–¹ä¾¿çš„è¯´æ³•ï¼š<strong>åœ¨ç»„ä»¶å†…éƒ¨æ”¹å˜stateä¼šè®©ç»„ä»¶é‡æ–°æ¸²æŸ“</strong>ã€‚</p><p>æ˜¯çš„ï¼ŒuseStateå°±æ˜¯ç”¨æ¥æ“ä½œç»„ä»¶stateçš„Hookã€‚<code>oh-my-kanban</code>é¡¹ç›® <code>App</code> ç»„ä»¶çš„ä»£ç ä¸­ç¬¬ä¸€å¥å°±æ˜¯åœ¨åˆ›å»ºåä¸º <code>showAdd</code> çš„stateï¼š</p><pre><code class=\"language-javascript\">import React, { useState } from 'react';\n// ...çœç•¥\nfunction App() {\n  const [showAdd, setShowAdd] = useState(false);\n  //     -------  ----------             -----\n  //        ^         ^                    ^\n  //        |         |                    |\n  //    stateå˜é‡  stateæ›´æ–°å‡½æ•°           stateåˆå§‹å€¼\n  const [todoList, setTodoList] = useState([/* ...çœç•¥ */]);\n</code></pre><p>åœ¨ç»„ä»¶æŒ‚è½½æ—¶ï¼Œç»„ä»¶å†…ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„stateï¼Œåˆå§‹å€¼ä¸º <code>false</code>ã€‚<code>useState</code> å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæˆå‘˜çš„æ•°ç»„ï¼Œé€šè¿‡ES2015çš„æ•°ç»„è§£æ„è¯­æ³•ï¼ˆ <code>[</code> <code>]</code> ï¼‰å¯ä»¥å¾—åˆ°ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ªå‡½æ•°ã€‚</p><p>ç»„ä»¶ä»£ç å¯ä»¥é€šè¿‡ <code>showAdd</code> å˜é‡è¯»å–è¿™ä¸ªstateï¼Œå½“éœ€è¦æ›´æ–°è¿™ä¸ªstateæ—¶ï¼Œåˆ™è°ƒç”¨ <code>setShowAdd</code> å‡½æ•°ï¼Œå¦‚ <code>setShowAdd(true)</code> ã€‚æ¯æ¬¡ç»„ä»¶æ›´æ–°ï¼Œåœ¨æ¸²æŸ“é˜¶æ®µéƒ½ä¼šå†æ¬¡è°ƒç”¨è¿™ä¸ª<code>useState</code> å‡½æ•°ï¼Œä½†å®ƒä¸ä¼šå†é‡æ–°åˆå§‹åŒ–stateï¼Œè€Œæ˜¯ä¿è¯ <code>showAdd</code> å€¼æ˜¯æœ€æ–°çš„ã€‚</p><p>ä¸Šé¢ç»„ä»¶çš„ç¬¬äºŒè¡Œè¯­å¥åˆ›å»ºäº†å¦ä¸€ä¸ªåä¸º <code>todoList</code> çš„stateï¼Œè°ƒç”¨ <code>setTodoList</code> æ›´æ–°stateåªä¼šæ›´æ–° <code>todoList</code> ï¼Œä¸ä¼šå½±å“åˆ°å‰é¢çš„ <code>showAdd</code>ã€‚</p><p>å…¶å®æ— è®º <code>showAdd</code> è¿˜æ˜¯ <code>todoList</code>ï¼Œéƒ½åªæ˜¯å•çº¯çš„å˜é‡åè€Œå·²ï¼ŒçœŸæ­£å†³å®šå®ƒä»¬æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„stateçš„ï¼Œæ˜¯ <code>useState</code> çš„<strong>è°ƒç”¨æ¬¡æ•°å’Œé¡ºåº</strong>ã€‚ä½ å¯ä»¥è‡ªè¡Œå†³å®šstateå˜é‡åå’Œstateæ›´æ–°å‡½æ•°åï¼Œ<code>xxx</code> å’Œ <code>setXxx</code> åªæ˜¯ä¸ªçº¦å®šä¿—æˆçš„å‘½åæ³•ã€‚</p><p>ä¸Šé¢æåˆ°æ¯æ¬¡ç»„ä»¶æ›´æ–°éƒ½ä¼šè°ƒç”¨<code>useState</code> ï¼Œè¿™å…¶å®æ˜¯æœ‰æ€§èƒ½éšæ‚£çš„ã€‚ä½ å¯èƒ½å¥½å¥‡ï¼Œ<code>useState(false)</code>  å¾—è°ƒç”¨å¤šå°‘æ¬¡æ‰èƒ½å½±å“åˆ°æ€§èƒ½å•Šï¼Ÿè€Œä¸”ï¼Œä¸æ˜¯è¯´å®ƒä¸ä¼šå†é‡æ–°åˆå§‹åŒ–stateå—ï¼Ÿ</p><p>ç¡®å®ï¼Œæ¡†æ¶æä¾›çš„ <code>useState</code> æœ¬èº«ä¸ä¼šè¿™ä¹ˆå¼±çš„ã€‚ä¸è¿‡ï¼Œ<code>useState</code> çš„å‚æ•°å°±ä¸ä¸€å®šäº†ã€‚ç°åœ¨çš„å‚æ•°æ˜¯ä¸€ä¸ªç®€å•çš„å¸ƒå°”å€¼ï¼Œä½†å¦‚æœå®ƒæ˜¯ä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼å‘¢ï¼Ÿæ¯æ¬¡ç»„ä»¶æ›´æ–°æ‰§è¡Œæ¸²æŸ“æ—¶ï¼Œå³ä½¿è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ä¸ä¼šè¢« <code>useState</code> å†æ¬¡ä½¿ç”¨ï¼Œä½†è¡¨è¾¾å¼æœ¬èº«è¿˜æ˜¯ä¼šè¢«æ‰§è¡Œçš„ã€‚</p><p>ä¸å¦¨è¯·ä½ å†™ä¸ªç®€å•çš„æ–æ³¢é‚£å¥‘æ•°åˆ—é€’å½’å‡½æ•°ï¼Œç„¶åæŠŠæ‰§è¡Œç»“æœå½“ä½œå‚æ•°ï¼š <code>useState(fibonacci(40))</code> ï¼Œç„¶åæ€§èƒ½è‚‰çœ¼å¯è§åœ°å˜å·®äº†ï¼Œè¡¨è¾¾å¼æ‰§è¡Œçš„æˆæœ¬å¤ªé«˜äº†ï¼ˆå½“ç„¶ä½ å¯ä»¥ä¼˜åŒ–å‡½æ•°æœ¬èº«çš„ç®—æ³•ï¼‰ã€‚ä½†æ²¡å…³ç³»ï¼Œ<code>useState</code> è¿˜æœ‰å¦ä¸€ç§è®¾ç½®é»˜è®¤å€¼çš„æ–¹æ³•ï¼Œå°±æ˜¯ä¼ ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œ<code>useState</code> å†…éƒ¨<strong>åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªå‡½æ•°</strong>ï¼Œæ­¤åç»„ä»¶æ›´æ–°æ—¶ä¸ä¼šå†æ‰§è¡Œã€‚</p><p>äºæ˜¯åˆšæ‰çš„æ–æ³¢é‚£å¥‘åˆå§‹å€¼å°±å¯ä»¥è¿™æ ·å†™ï¼š<code>useState(() =&gt; fibonacci(40))</code>  ã€‚</p><p>æœ‰æ„æ€çš„æ˜¯ï¼Œstateæ›´æ–°å‡½æ•°ï¼Œå³ <code>setShowAdd</code> ä¹Ÿå¯ä»¥ä¼ å‡½æ•°ä½œä¸ºå‚æ•°ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜¯è°ƒç”¨stateæ›´æ–°å‡½æ•°åç»„ä»¶ä¼šæ›´æ–°ï¼Œè€Œä¸æ˜¯åè¿‡æ¥ã€‚æ‰€ä»¥stateæ›´æ–°å‡½æ•°çš„è°ƒç”¨é¢‘ç‡æ²¡é‚£ä¹ˆé«˜ï¼Œä¼ å‡½æ•°å‚æ•°ä¹Ÿå¹¶ä¸æ˜¯ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ã€‚</p><p>è¿™é‡Œå…ˆç»™ä¸€ä¸ªèƒŒæ™¯ï¼Œè°ƒç”¨stateæ›´æ–°å‡½æ•°åï¼Œç»„ä»¶çš„æ›´æ–°æ˜¯<strong>å¼‚æ­¥</strong>çš„ï¼Œä¸ä¼šé©¬ä¸Šæ‰§è¡Œï¼›åœ¨React 18é‡Œï¼Œæ›´æ˜¯ä¸ºæ›´æ–°stateåŠ å…¥äº†<strong>è‡ªåŠ¨æ‰¹å¤„ç†</strong>åŠŸèƒ½ï¼Œå¤šä¸ªstateæ›´æ–°å‡½æ•°è°ƒç”¨ä¼šè¢«åˆå¹¶åˆ°ä¸€æ¬¡é‡æ–°æ¸²æŸ“ä¸­ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½ä»æ¡†æ¶ä¸Šå°±ä¿è¯äº†stateå˜åŒ–è§¦å‘æ¸²æŸ“æ—¶çš„æ€§èƒ½ï¼Œä½†ä¹Ÿå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œåªæœ‰åœ¨ä¸‹æ¬¡æ¸²æŸ“æ—¶stateå˜é‡æ‰ä¼šæ›´æ–°ä¸ºæœ€æ–°å€¼ï¼Œå¦‚æœå¸Œæœ›æ¯æ¬¡æ›´æ–°stateæ—¶éƒ½è¦åŸºäºå½“å‰stateå€¼åšè®¡ç®—ï¼Œé‚£ä¹ˆè¿™ä¸ªè®¡ç®—çš„åŸºå‡†å€¼æœ‰å¯èƒ½å·²ç»è¿‡æ—¶äº†ï¼Œå¦‚ï¼š</p><pre><code class=\"language-javascript\">setShowAdd(!showAdd);\nsetTodoList([...todoList, aNewTodoItem]);\n</code></pre><p>è¿™æ—¶å‡½æ•°å‚æ•°çš„ä½œç”¨å°±ä½“ç°å‡ºæ¥äº†ï¼Œåªè¦æ”¹ä¸ºä¸‹é¢çš„æ–¹å¼ï¼Œå°±å¯ä»¥ä¿è¯<strong>æ›´æ–°å‡½æ•°ä½¿ç”¨æœ€æ–°çš„stateæ¥è®¡ç®—æ–°stateå€¼</strong>ï¼š</p><pre><code class=\"language-javascript\">setShowAdd(prevState =&gt; !prevState);\nsetTodoList(prevState =&gt; {\n  return [...prevState, aNewTodoItem];\n});\n</code></pre><p><code>useState</code> æ˜¯Reactæœ€å¸¸ç”¨çš„Hookï¼Œç†è§£è¿™ä¸ªHookå¯¹ç†è§£å…¶ä»–Hookså¾ˆæœ‰å¸®åŠ©ã€‚</p><h3>useReducer</h3><p>è¿™ä¸ªå°èŠ‚çš„æ ‡é¢˜æ˜¯â€œçŠ¶æ€Hooksâ€ï¼Œä¹‹æ‰€ä»¥æœ‰ä¸ªâ€œsâ€ï¼Œæ˜¯å› ä¸º <code>useState</code> è¿˜æœ‰ä¸€ä¸ªé©¬ç”² <code>useReducer</code> ï¼Œå¦‚æœç”¨ <code>useReducer</code> æ¥æ”¹å†™ä¸Šé¢çš„ <code>useState</code> ï¼Œå¯ä»¥å†™æˆè¿™æ ·ï¼š</p><pre><code class=\"language-javascript\">function reducer(state, action) {\n&nbsp; switch (action.type) {\n&nbsp; &nbsp; case 'show':\n&nbsp; &nbsp; &nbsp; return true;\n&nbsp; &nbsp; case 'hide':\n    default:\n&nbsp; &nbsp; &nbsp; return false;\n&nbsp; }\n}\n\nfunction App() {\n&nbsp; const [showAdd, dispatch] = useReducer(reducer, false);\n  // ...çœç•¥\n  dispatch({ type: 'show' });\n</code></pre><p>è¿™ä¹ˆå†™ä»£ç å¥½åƒå˜å¤šäº†ï¼Ÿè¿™æ˜¯å› ä¸º <code>useReducer</code> æ¯”èµ· <code>useState</code> å¢åŠ äº†é¢å¤–çš„æŠ½è±¡ï¼Œå¼•å…¥äº†<code>dispatch</code> ã€<code>action</code> ã€<code>reducer</code> æ¦‚å¿µã€‚è¿™ä¸è‘—ååº”ç”¨çŠ¶æ€ç®¡ç†æ¡†æ¶ReduxåŸºæœ¬æ˜¯å¯¹åº”çš„ã€‚</p><p>è¯´åˆ°é©¬ç”²ï¼Œå…¶å® <code>useState</code> åº•å±‚å°±æ˜¯åŸºäº <code>useReducer</code> å®ç°çš„ï¼Œ<code>useState</code> æ‰æ˜¯é©¬ç”²ã€‚<code>useReducer</code> é€‚ç”¨äºæŠ½è±¡å°è£…å¤æ‚é€»è¾‘ï¼Œå¯¹äºç°åœ¨çš„ <code>oh-my-kanban</code> é¡¹ç›®æ˜¯æ²¡å¿…è¦çš„ã€‚</p><p>æˆ‘ä»¬åœ¨åé¢é¡¹ç›®ç¯‡çš„è¯¾ç¨‹ä¸­ä¼šè®¾è®¡æ›´å¤æ‚çš„stateï¼Œé‚£æ—¶å°±è½®åˆ° <code>useReducer</code> æ–½å±•æ‹³è„šäº†ï¼Œå±Šæ—¶æˆ‘ä»¬ä¼šè¯¦ç»†è®²è¿™ä¸ªHookã€‚</p><h3>æ›´æ–°stateçš„è‡ªåŠ¨æ‰¹å¤„ç†</h3><p>å‰é¢æåˆ°æ›´æ–°stateçš„æ‰¹å¤„ç†ï¼Œä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡æ›´æ–°stateå‘¢ï¼Ÿæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ <code>oh-my-kanban</code> ä¸­ï¼Œæ·»åŠ æ–°å¡ç‰‡æŒ‰å›è½¦é”®åå‘ç”Ÿçš„äº‹æƒ…ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å…ˆåæ›´æ–°äº† <code>todoList</code> å’Œ <code>showAdd</code> ä¸¤ä¸ªstateå€¼ï¼š</p><pre><code class=\"language-javascript\">function App() {\n&nbsp; const [showAdd, setShowAdd] = useState(false);\n&nbsp; const [todoList, setTodoList] = useState([/*çœç•¥*/]);\n  // ...çœç•¥\n&nbsp; const handleSubmit = (title) =&gt; {\n&nbsp; &nbsp; setTodoList(currentTodoList =&gt; [\n&nbsp; &nbsp; &nbsp; { title, status: new Date().toString() },\n&nbsp; &nbsp; &nbsp; ...currentTodoList\n&nbsp; &nbsp; ]);\n&nbsp; &nbsp; setShowAdd(false);\n&nbsp; };\n&nbsp; // ...çœç•¥\n&nbsp; return (\n&nbsp; &nbsp; &lt;div className=\"App\"&gt;\n&nbsp; &nbsp; &nbsp; {/*çœç•¥*/}\n&nbsp; &nbsp; &nbsp; {showAdd &amp;&amp; &lt;KanbanNewCard onSubmit={handleSubmit} /&gt;}\n      {/*çœç•¥*/}\n    &lt;/div&gt;\n  );\n}\n</code></pre><p>ç»„ä»¶å†…çš„stateè¢«æ›´æ–°äº†ï¼Œç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“ã€‚é‚£ä¹ˆæ¥è¿æ›´æ–°ä¸¤ä¸ªstateï¼Œç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“å‡ æ¬¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<strong>ç»„ä»¶åªä¼šé‡æ–°æ¸²æŸ“ä¸€æ¬¡</strong>ï¼Œè€Œä¸”è¿™æ¬¡æ¸²æŸ“ä½¿ç”¨äº†ä¸¤ä¸ªstateåˆ†åˆ«çš„æœ€æ–°å€¼ã€‚è¿™å°±æ˜¯React<strong>å¯¹å¤šä¸ªstateæ›´æ–°çš„è‡ªåŠ¨æ‰¹å¤„ç†</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå‡è®¾æ²¡æœ‰æ‰¹å¤„ç†åŠŸèƒ½çš„è¯ï¼Œè¿™ä¸¤ä¸ªstateæ›´æ–°ä¼šè§¦å‘ä¸¤æ¬¡é—´éš”éå¸¸è¿‘çš„é‡æ–°æ¸²æŸ“ï¼Œé‚£å‰é¢çš„è¿™æ¬¡é‡æ–°æ¸²æŸ“å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯ä¸€é—ªè€Œè¿‡çš„ï¼Œæ—¢æ²¡æœ‰äº§ç”Ÿå®é™…äº¤äº’ï¼Œä¹Ÿæ²¡æœ‰ä¸šåŠ¡æ„ä¹‰ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¦‚æœå†åŠ ä¸Šå‰é¢è¿™æ¬¡æ¸²æŸ“çš„æˆæœ¬æ¯”è¾ƒé«˜ï¼Œé‚£å°±æ›´æ˜¯ä¸€ç§æµªè´¹äº†ã€‚</p><p>æ‰€ä»¥å¯ä»¥è¯´ï¼Œstateæ›´æ–°çš„è‡ªåŠ¨æ‰¹å¤„ç†æ˜¯Reactç¡®ä¿ç»„ä»¶åŸºç¡€æ€§èƒ½çš„é‡è¦åŠŸèƒ½ã€‚</p><p>ç„¶è€Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‡ªåŠ¨æ‰¹å¤„ç†åŠŸèƒ½åœ¨React 18ç‰ˆæœ¬ä»¥å‰ï¼Œåªåœ¨Reactäº‹ä»¶å¤„ç†å‡½æ•°ä¸­ç”Ÿæ•ˆã€‚å¦‚æœstateæ›´æ–°è¯­å¥æ‰€åœ¨çš„åŒºåŸŸç¨æœ‰ä¸åŒï¼Œæ¯”å¦‚å°†ä¸¤ä¸ªstateæ›´æ–°å†™åœ¨å¼‚æ­¥è¯·æ±‚çš„å›è°ƒå‡½æ•°ä¸­ï¼Œè‡ªåŠ¨æ‰¹å¤„ç†å°±å¤±æ•ˆäº†ã€‚</p><p>ç”¨ä¸‹é¢çš„ä»£ç ä¸¾ä¸ªä¾‹å­ã€‚åœ¨ç‚¹å‡»æœç´¢æŒ‰é’®åï¼Œä¼šå‘æœåŠ¡å™¨ç«¯å‘èµ·æœç´¢è¯·æ±‚ï¼Œå½“è¿”å›ç»“æœæ—¶ï¼Œéœ€è¦å…ˆåæ›´æ–°ä¸¤ä¸ªstateï¼š</p><pre><code class=\"language-javascript\">const Search = () =&gt; {\n  const [province, setProvince] = useState(null);\n  const [cities, setCities] = useState([]);\n  const handleSearchClick = () =&gt; {\n    // æ¨¡æ‹Ÿè°ƒç”¨æœåŠ¡å™¨ç«¯æ¥å£æœç´¢\"å‰æ—\"\n    setTimeout(() =&gt; {\n      setProvince('å‰æ—');\n      setCities(['é•¿æ˜¥', 'å‰æ—']);\n    }, 1000);\n  };\n  return (\n    &lt;&gt;\n      &lt;button onClick={handleSearchClick}&gt;æœç´¢&lt;/button&gt;\n      &lt;ul&gt;\n        &lt;li&gt;{province}&lt;ul&gt;\n          {cities.map(city =&gt; (\n            &lt;li&gt;{city}&lt;/li&gt;\n          ))}\n        &lt;/ul&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/&gt;\n  );\n};\n</code></pre><p>çœ‹èµ·æ¥å†™æ³•ä¸ <code>oh-my-kanban</code> çš„ <code>handleSubmit</code> åŒºåˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä½†åœ¨React 18ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸¤ä¸ªstateæ›´æ–°ä¼šè§¦å‘ä¸¤æ¬¡é‡æ–°æ¸²æŸ“ã€‚</p><p>è€Œä»React 18ç‰ˆæœ¬èµ·ï¼Œæ— è®ºæ˜¯åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ã€å¼‚æ­¥å›è°ƒï¼Œè¿˜æ˜¯ <code>setTimeout</code> é‡Œçš„å¤šä¸ªstateæ›´æ–°ï¼Œé»˜è®¤éƒ½ä¼šè¢«è‡ªåŠ¨æ‰¹å¤„ç†ï¼Œåªè§¦å‘ä¸€æ¬¡é‡æ–°æ¸²æŸ“ã€‚</p><h2>åœ¨ç»„ä»¶å†…ä½¿ç”¨å¯å˜å€¼ï¼šuseRef</h2><p>å‰é¢è®²åˆ°æ›´æ–°stateå€¼æ—¶ï¼Œéœ€è¦ä½¿ç”¨stateæ›´æ–°å‡½æ•°ã€‚ä½ ä¹Ÿè®¸ä¼šå¥½å¥‡ï¼Œæ—¢ç„¶ <code>useState</code> è¿”å›äº†stateå˜é‡ï¼Œç›´æ¥ç»™stateå˜é‡èµ‹å€¼ä¸è¡Œå—ï¼Ÿ</p><p>è¯·ä½ åšä¸ªå°å®éªŒå§ï¼Œåœ¨ <code>App</code> ç»„ä»¶å‡½æ•°å†…ï¼Œä¿®æ”¹ <code>handleAdd</code> å‡½æ•°ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/77/72/77d9a09a270a1c760eb3b4186accbc72.png?wh=1308x322\" alt=\"å›¾ç‰‡\"></p><p>ç‚¹å‡»æ·»åŠ æ–°å¡ç‰‡æŒ‰é’®ï¼Œæµè§ˆå™¨é©¬ä¸Šå°±æŠ¥é”™ï¼š</p><pre><code class=\"language-diff\">Uncaught TypeError: invalid assignment to const 'showAdd'\n&nbsp; &nbsp; handleAdd App.js:204\n</code></pre><p>è¿™æ­£å¦‚åœ¨ç¬¬6èŠ‚è¯¾æåˆ°çš„ï¼šprops å’Œ state éƒ½æ˜¯ä¸å¯å˜çš„ï¼ˆImmutableï¼‰ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœéœ€è¦åœ¨Reactç»„ä»¶ä¸­ä½¿ç”¨å¯å˜å€¼è¯¥æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>useRef</code> è¿™ä¸ªHookã€‚ä¸‹é¢æˆ‘ä»¬ç»“åˆä¸€ä¸ªå…¸å‹ç”¨ä¾‹ï¼Œä¹Ÿå°±æ˜¯åœ¨Reactç»„ä»¶ä¸­è®¿é—®çœŸå®DOMå…ƒç´ ï¼Œæ¥ä»‹ç» <code>useRef</code> çš„ç”¨æ³•ã€‚</p><p>è¯·ä½ ä¸º <code>oh-my-kanban</code> åŠ å…¥ä¸€ä¸ªæå‡ç”¨æˆ·ä½“éªŒçš„å°åŠŸèƒ½ï¼Œå½“æ‰“å¼€â€œæ·»åŠ æ–°å¡ç‰‡â€å¡ç‰‡æ—¶ï¼Œè‡ªåŠ¨å°†å…¶ä¸­çš„æ–‡æœ¬è¾“å…¥æ¡†è®¾ç½®ä¸ºé¡µé¢ç„¦ç‚¹ã€‚è¯¥åŠŸèƒ½éœ€æ±‚å’Œä»¥ä¸‹ä»£ç æ¥è‡ªäºç¬¬3èŠ‚è¯¾ä¸€ä½åä¸ºâ€œ<strong>coder</strong>â€çš„å­¦å‘˜ç•™è¨€ï¼Œåœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/05/fb/05f10984b663041698aa1fc6a51034fb.png?wh=1360x1126\" alt=\"å›¾ç‰‡\"></p><p>åœ¨æµè§ˆå™¨å†…å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„ä»£ç å®ç°äº†æˆ‘ä»¬æœŸå¾…çš„äº¤äº’ï¼Œæ•ˆæœå±•ç¤ºå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/91/58/91cf7a290bffe5951b0d18d03db93d58.gif?wh=400x290\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šé¢çš„ä»£ç åŒ…å«äº†ä¸‰ä¸ªReactç‰¹æ€§ï¼Œ<code>useRef</code>  Hookã€HTMLå…ƒç´ çš„ <code>ref</code> å±æ€§ï¼Œä»¥åŠ <code>useEffect</code>  Hookã€‚å…ˆè¯´ <code>useRef</code> ï¼š</p><pre><code class=\"language-javascript\">const Component = () =&gt; {\n  const myRef = useRef(null);\n  //&nbsp; &nbsp; -----&nbsp;       &nbsp; ----\n  //&nbsp; &nbsp; &nbsp; ^ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ^\n  //&nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n  //&nbsp;  å¯å˜refå¯¹è±¡&nbsp; &nbsp; &nbsp;å¯å˜refå¯¹è±¡currentå±æ€§åˆå§‹å€¼\n\n  // è¯»å–å¯å˜å€¼\n  const value = myRef.current;\n  // æ›´æ–°å¯å˜å€¼\n  myRef.current = newValue;\n\n  return (&lt;div&gt;&lt;/div&gt;);\n};\n</code></pre><p>è°ƒç”¨ <code>useRef</code> ä¼šè¿”å›ä¸€ä¸ªå¯å˜refå¯¹è±¡ï¼Œè€Œä¸”ä¼šä¿è¯ç»„ä»¶æ¯æ¬¡é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ŒåŒä¸€ä¸ª <code>useRef</code> Hookè¿”å›çš„å¯å˜refå¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>å¯å˜refå¯¹è±¡æœ‰ä¸€ä¸ªå¯ä¾›è¯»å†™çš„ <code>current</code> å±æ€§ï¼Œç»„ä»¶é‡æ–°æ¸²æŸ“æœ¬èº«ä¸ä¼šå½±å“ <code>current</code> å±æ€§çš„å€¼ï¼›åè¿‡æ¥ï¼Œå˜æ›´ <code>current</code> å±æ€§å€¼ä¹Ÿä¸ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚åœ¨ç¬¬12-13èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šå±•å¼€ä»‹ç»å¯å˜å€¼çš„ä½¿ç”¨åœºæ™¯ã€‚</p><p>ç„¶åæ˜¯HTMLå…ƒç´ çš„ <code>ref</code> å±æ€§ã€‚è¿™ä¸ªå±æ€§æ˜¯Reactç‰¹æœ‰çš„ï¼Œä¸ä¼šä¼ é€’ç»™çœŸå®DOMã€‚å½“refå±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯å˜refå¯¹è±¡æ—¶ï¼Œç»„ä»¶åœ¨æŒ‚è½½é˜¶æ®µï¼Œä¼šåœ¨HTMLå…ƒç´ å¯¹åº”çš„çœŸå®DOMå…ƒç´ åˆ›å»ºåï¼Œå°†å®ƒèµ‹å€¼ç»™å¯å˜refå¯¹è±¡çš„ <code>current</code> å±æ€§ï¼Œå³ <code>inputElem.current</code>ï¼›åœ¨ç»„ä»¶å¸è½½ï¼ŒçœŸå®DOMé”€æ¯ä¹‹å‰ï¼Œä¹Ÿä¼šæŠŠ <code>current</code> å±æ€§è®¾ç½®ä¸º <code>null</code>ã€‚</p><p>å†æ¥ä¸‹æ¥å°±æ˜¯ <code>useEffect(func, [])</code> ï¼Œè¿™ç§ä½¿ç”¨æ–¹æ³•ä¼šä¿è¯ <code>func</code> åªåœ¨ç»„ä»¶æŒ‚è½½çš„æäº¤é˜¶æ®µæ‰§è¡Œä¸€æ¬¡ï¼Œæ¥ä¸‹æ¥çš„ç»„ä»¶æ›´æ–°æ—¶ä¸ä¼šå†æ‰§è¡Œã€‚</p><p>è¿™ä¸‰ä¸ªç‰¹æ€§ä¸²èµ·æ¥ï¼Œå°±è®© <code>KanbanNewCard</code> ç»„ä»¶åœ¨æŒ‚è½½æ—¶ï¼Œå°† <code>&lt;input&gt;</code> çš„çœŸå®DOMèŠ‚ç‚¹èµ‹å€¼ç»™ <code>inputElem.current</code>ï¼Œç„¶ååœ¨å¤„ç†å‰¯ä½œç”¨æ—¶ä» <code>inputElem.current</code> æ‹¿åˆ°è¿™ä¸ªçœŸå®DOMèŠ‚ç‚¹ï¼Œå‘½ä»¤å¼åœ°æ‰§è¡Œå®ƒçš„ <code>focus()</code> æ–¹æ³•è®¾ç½®ç„¦ç‚¹ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å€ŸåŠ©å‡½æ•°å¼ç¼–ç¨‹é¢†åŸŸçš„çº¯å‡½æ•°å’Œå‰¯ä½œç”¨çš„æ¦‚å¿µï¼Œé€šè¿‡ç±»æ¯”çš„æ–¹å¼ä»‹ç»äº†ä»€ä¹ˆæ˜¯Hooksï¼Œä¹ŸåŒæ—¶å¼ºè°ƒäº†Hooksä¸å‡½æ•°ç»„ä»¶çš„ç´§å¯†è”ç³»ã€‚</p><p>ç„¶åæˆ‘ä»¬åˆ—ä¸¾äº†React 18ç‰ˆæœ¬APIä¸­æä¾›çš„åŸºç¡€Hookså’Œæ‰©å±•Hooksï¼Œå¹¶ç»™å‡ºäº†å­¦ä¹ å»ºè®®ã€‚åœ¨ååŠæ®µï¼Œæˆ‘ä»¬æ·±å…¥å­¦ä¹ äº† <code>useState</code> è¿™ä¸ªHookï¼Œä¹Ÿé‡åˆ°äº†Reactå¯¹äºå¤šä¸ªstateæ›´æ–°çš„è‡ªåŠ¨æ‰¹å¤„ç†åŠŸèƒ½ã€‚</p><p>æœ€åï¼Œé€šè¿‡ä¸º <code>oh-my-kanban</code> å¢åŠ ä¸€ä¸ªå°åŠŸèƒ½ï¼Œç†Ÿæ‚‰äº† <code>useRef</code> çš„ä¸€ä¸ªå¸¸è§ç”¨ä¾‹ã€‚</p><p>ä¸‹èŠ‚è¯¾æˆ‘ä»¬ä¼šç»§ç»­Hooksçš„å­¦ä¹ ï¼Œåœ¨æŒæ¡ä½œä¸ºæœ€é‡è¦çš„åŸºç¡€Hooksçš„ <code>useEffect</code> åŒæ—¶ï¼Œä¹Ÿäº†è§£Reactå¦‚ä½•å¤„ç†å‰¯ä½œç”¨ã€‚ç„¶åä¼šä»‹ç»ä¸»è¦ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„ <code>useMemo</code> å’Œ <code>useCallback</code> ï¼Œä¹Ÿä¼šå¼ºè°ƒæ‰€æœ‰Hookså…±é€šçš„ä½¿ç”¨é™åˆ¶ã€‚æœ€åä¼šå›ç­”ä¸ºä»€ä¹ˆè¦ä¼˜å…ˆå­¦ä¹ å‡½æ•°ç»„ä»¶åŠ Hooksï¼Œä»¥åŠå­¦ä¹ äº†Hooksè¿˜æ˜¯å¦éœ€è¦å­¦ä¹ ç±»ç»„ä»¶çš„é—®é¢˜ã€‚</p><p>æœ€åä¹Ÿé™„ä¸Šæœ¬èŠ‚è¯¾æ‰€æ¶‰åŠçš„é¡¹ç›®æºä»£ç ï¼š<a href=\"https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.9.0%E3%80%82\">https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.9.0ã€‚</a></p><h2>æ€è€ƒé¢˜</h2><ol>\n<li>è¿™èŠ‚è¯¾çš„å­¦ä¹ äº† <code>useState</code> ï¼Œä»è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªJSå‡½æ•°å—ï¼Ÿå…¶å®ä¸ç„¶ã€‚æˆ‘æƒ³è¯·ä½ åšå‡ ä¸ªå®éªŒï¼Œè§‚å¯Ÿä¸€ä¸‹Hookåœ¨ä½¿ç”¨ä¸­éƒ½ä¼šæœ‰å“ªäº›é™åˆ¶ï¼š</li>\n</ol><ul>\n<li>åœ¨å‡½æ•°ç»„ä»¶ä¹‹å¤–çš„ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­è°ƒç”¨ <code>useState</code>ï¼›</li>\n<li>åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨åŠ ä¸€ä¸ªifæ¡ä»¶è¯­å¥ï¼Œåœ¨æ»¡è¶³æ¡ä»¶æ—¶æ‰å»è°ƒç”¨ <code>useState</code>ï¼›</li>\n<li>åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨ <code>useState</code>ï¼Œå†åœ¨å‡½æ•°ç»„ä»¶å†…è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</li>\n</ul><ol start=\"2\">\n<li>è¿™èŠ‚è¯¾æœ«å°¾ä¹Ÿå­¦ä¹ äº†<code>useRef</code> å¯ä»¥ç”¨æ¥ä¿å­˜å’Œè¯»å–å¯å˜å€¼ï¼Œè²Œä¼¼å¾ˆè‡ªç”±çš„æ ·å­ï¼Œé‚£è¯·ä½ <br>\næ ¹æ®å®ƒçš„ç‰¹æ€§æ¥æ¨æ–­ä¸€ä¸‹ï¼Œå¯ä»¥ç”¨ <code>useRef</code> æ¥ä»£æ›¿ <code>useState</code> å—ï¼Ÿ</li>\n</ol><p>æ¬¢è¿å°†ä½ çš„æ€è€ƒå’Œç­”æ¡ˆæ”¾åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šè·Ÿä½ äº¤æµã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":357296,"user_name":"ğŸ‘","can_delete":false,"product_type":"c1","uid":2189689,"ip_address":"åŒ—äº¬","ucode":"DE34B3B14287D1","user_header":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","comment_is_top":true,"comment_ctime":1663140724,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"ä½ å¥½ï¼Œæˆ‘æ˜¯ã€Šç°ä»£React Webå¼€å‘å®æˆ˜ã€‹çš„ç¼–è¾‘è¾°æ´‹ï¼Œè¿™æ˜¯ğŸ‘‡é¡¹ç›®çš„æºä»£ç é“¾æ¥ï¼Œä¾›ä½ å­¦ä¹ ä¸å‚è€ƒï¼š https:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kanban&#47;releases&#47;tag&#47;v0.9.0","like_count":1,"discussions":[{"author":{"id":1109402,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ed/9a/bbeec5bb.jpg","nickname":"liu","note":"","ucode":"041F179BB00A59","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590508,"discussion_content":"ä»giteeä¸Šæ‹‰å–ä¸‹æ¥ï¼Œæ ¹æœ¬å°±æ²¡æœ‰ä»£ç åˆ†æ”¯ã€‚æ¯ä¸ªè¯¾çš„ä»£ç éƒ½æ˜¯è¢«giteeä¼˜åŒ–åˆå¹¶åçš„ã€‚å¾ˆä¸ä¾¿äºè·Ÿè¸ªç»ƒä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665827880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357110,"user_name":"è‹¥å·","can_delete":false,"product_type":"c1","uid":1230852,"ip_address":"åŒ—äº¬","ucode":"B8C3DD4B38CC6F","user_header":"https://static001.geekbang.org/account/avatar/00/12/c8/04/fed4c1ad.jpg","comment_is_top":false,"comment_ctime":1662967169,"is_pvip":true,"replies":[{"id":130190,"content":"ä½ å¥½ï¼Œè‹¥å·ï¼Œå¾ˆæ£’çš„ç­”æ¡ˆï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1663585690,"ip_address":"åŒ—äº¬","comment_id":357110,"utype":1}],"discussion_count":7,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"1. Reactå®˜æ–¹æ–‡æ¡£ï¼šHook è§„åˆ™\nhttps:&#47;&#47;zh-hans.reactjs.org&#47;docs&#47;hooks-rules.html\n1.1 åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hookã€‚ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚\n1.2 åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚ä¸è¦åœ¨æ™®é€šçš„ JavaScript å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚\n\nå› ä¸ºæœ¬è´¨æ˜¯é“¾è¡¨ã€‚åœ¨å„ç§åˆ¤æ–­ä¸­å†™ Hook ä¼šå¯¼è‡´èŠ‚ç‚¹é”™ä¹±ã€‚\n\n2. useRef ä¸­å€¼å˜åŒ–æ˜¯ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚useState ä¸­åˆ™æ˜¯ä¼šè§¦å‘æ¸²æŸ“ã€‚","like_count":17,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588169,"discussion_content":"ä½ å¥½ï¼Œè‹¥å·ï¼Œå¾ˆæ£’çš„ç­”æ¡ˆï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663585691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1230852,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c8/04/fed4c1ad.jpg","nickname":"è‹¥å·","note":"","ucode":"B8C3DD4B38CC6F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":588238,"discussion_content":"æ„Ÿè°¢è€å¸ˆè‚¯å®š~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663603363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":588169,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":588238,"extra":""}]},{"author":{"id":1218183,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/87/bbdeb4ee.jpg","nickname":"æ¨æ°¸å®‰","note":"","ucode":"D23013C30D435B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587642,"discussion_content":"æ‰ä½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663174050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1230852,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c8/04/fed4c1ad.jpg","nickname":"è‹¥å·","note":"","ucode":"B8C3DD4B38CC6F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1218183,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/87/bbdeb4ee.jpg","nickname":"æ¨æ°¸å®‰","note":"","ucode":"D23013C30D435B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588239,"discussion_content":"å“ˆå“ˆï¼Œä½ ä¹Ÿåœ¨å­¦ä¹ è¿™ä¸ªå‘€~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663603385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587642,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":588239,"extra":""}]},{"author":{"id":1039290,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/ba/304a9a4a.jpg","nickname":"JuntÃ­ng","note":"","ucode":"F6A3B528D6F3FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587411,"discussion_content":"å“ªé‡Œéƒ½æœ‰å·å“¥èº«å½±ï¼ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663039665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1230852,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c8/04/fed4c1ad.jpg","nickname":"è‹¥å·","note":"","ucode":"B8C3DD4B38CC6F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1039290,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/ba/304a9a4a.jpg","nickname":"JuntÃ­ng","note":"","ucode":"F6A3B528D6F3FD","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587638,"discussion_content":"å“ˆå“ˆï¼ŒåŸæ¥ä½ ä¹Ÿåœ¨å­¦ä¹ è¿™ä¸ªå•Š~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663171387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587411,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":587638,"extra":""},{"author":{"id":1039290,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/db/ba/304a9a4a.jpg","nickname":"JuntÃ­ng","note":"","ucode":"F6A3B528D6F3FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1230852,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c8/04/fed4c1ad.jpg","nickname":"è‹¥å·","note":"","ucode":"B8C3DD4B38CC6F","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":588249,"discussion_content":"çœ‹çœ‹å¤§ä½¬æ€ä¹ˆå†™react ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663631537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587638,"ip_address":"æ¹–å—","group_id":0},"score":588249,"extra":""}]}]},{"had_liked":false,"id":357382,"user_name":"joel","can_delete":false,"product_type":"c1","uid":1550366,"ip_address":"åŒ—äº¬","ucode":"46E91C3F3F1414","user_header":"https://static001.geekbang.org/account/avatar/00/17/a8/1e/4ec85e24.jpg","comment_is_top":false,"comment_ctime":1663213055,"is_pvip":false,"replies":[{"id":130294,"content":"ä½ å¥½ï¼Œjoelï¼Œå¾ˆæ£’çš„ç­”æ¡ˆã€‚æ›´å…·ä½“æ¥è¯´ï¼Œè°ƒç”¨ useStateè¿”å›çš„stateæ›´æ–°å‡½æ•°ä¼šè§¦å‘Reactçš„åè°ƒè¿‡ç¨‹ï¼Œè€Œä¸ºuseRefè¿”å›çš„ref.currentèµ‹å€¼å¹¶ä¸ä¼šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1663819595,"ip_address":"åŒ—äº¬","comment_id":357382,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"useRef æ¥ä»£æ›¿ useState å—?\nä¸èƒ½ï¼Œè¿™ä¸¤ä¸ªæ˜¯ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œusestate æ˜¯å¯ä»¥å‡ºå‘react çš„åè°ƒè¿‡ç¨‹ï¼Œuseref ä¸èƒ½","like_count":2,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588536,"discussion_content":"ä½ å¥½ï¼Œjoelï¼Œå¾ˆæ£’çš„ç­”æ¡ˆã€‚æ›´å…·ä½“æ¥è¯´ï¼Œè°ƒç”¨ useStateè¿”å›çš„stateæ›´æ–°å‡½æ•°ä¼šè§¦å‘Reactçš„åè°ƒè¿‡ç¨‹ï¼Œè€Œä¸ºuseRefè¿”å›çš„ref.currentèµ‹å€¼å¹¶ä¸ä¼šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663819595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357859,"user_name":"01","can_delete":false,"product_type":"c1","uid":1120612,"ip_address":"åŒ—äº¬","ucode":"3229D8F060AFEC","user_header":"https://static001.geekbang.org/account/avatar/00/11/19/64/6f2b7b86.jpg","comment_is_top":false,"comment_ctime":1663688461,"is_pvip":false,"replies":[{"id":130402,"content":"ä½ å¥½ï¼Œ01ï¼Œæˆ‘èµåŒä½ è¯´çš„ã€‚è°ƒåº¦å™¨ä¼šæ ¹æ®å„ä¸ªstate updaterçš„ä¼˜å…ˆçº§ï¼Œè°ƒæ•´æ‰§è¡Œé¡ºåºï¼Œå¦‚æœè¿™ä¸€è½®æ›´æ–°ä¸è¶…æ—¶ï¼Œæ‰€æœ‰é˜Ÿåˆ—é‡Œçš„state updateréƒ½èƒ½æ‰§è¡Œå®Œï¼Œé‚£å°±ä¸€æ¬¡æ¸²æŸ“æå®šï¼›å¦‚æœæ›´æ–°è¶…æ—¶ï¼Œåˆ™æŠŠæœªå®Œæˆçš„updaterç•™åˆ°ä¸‹æ¬¡æ¸²æŸ“ï¼Œè¿™å°±é€ æˆäº†å¤šæ¬¡æ¸²æŸ“çš„æƒ…å†µï¼ˆä¸ºäº†ä¿è¯stateç»“æœä¸€è‡´ï¼Œæœ‰æ—¶è¿˜éœ€è¦æŠŠä¸Šä¸€æ¬¡æ¸²æŸ“ä¸­å·²ç»æ‰§è¡Œè¿‡çš„é«˜ä¼˜å…ˆçº§updaterå†é‡å¤æ‰§è¡Œä¸€éï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1664213267,"ip_address":"åŒ—äº¬","comment_id":357859,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"18 æ‰¹å¤„ç†ä¾æ‰˜çš„ å®ƒçš„è°ƒåº¦å™¨ã€‚ å¯ä¸­æ–­ã€‚  è¿›å…¥commit é˜¶æ®µ åˆ™ä¸å¯ä¸­æ–­ã€‚  æ˜¯å¦åªæ¸²æŸ“ä¸€æ¬¡ è¿™ä¸ªä¸ä¸€å®šå§","like_count":1,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588919,"discussion_content":"ä½ å¥½ï¼Œ01ï¼Œæˆ‘èµåŒä½ è¯´çš„ã€‚è°ƒåº¦å™¨ä¼šæ ¹æ®å„ä¸ªstate updaterçš„ä¼˜å…ˆçº§ï¼Œè°ƒæ•´æ‰§è¡Œé¡ºåºï¼Œå¦‚æœè¿™ä¸€è½®æ›´æ–°ä¸è¶…æ—¶ï¼Œæ‰€æœ‰é˜Ÿåˆ—é‡Œçš„state updateréƒ½èƒ½æ‰§è¡Œå®Œï¼Œé‚£å°±ä¸€æ¬¡æ¸²æŸ“æå®šï¼›å¦‚æœæ›´æ–°è¶…æ—¶ï¼Œåˆ™æŠŠæœªå®Œæˆçš„updaterç•™åˆ°ä¸‹æ¬¡æ¸²æŸ“ï¼Œè¿™å°±é€ æˆäº†å¤šæ¬¡æ¸²æŸ“çš„æƒ…å†µï¼ˆä¸ºäº†ä¿è¯stateç»“æœä¸€è‡´ï¼Œæœ‰æ—¶è¿˜éœ€è¦æŠŠä¸Šä¸€æ¬¡æ¸²æŸ“ä¸­å·²ç»æ‰§è¡Œè¿‡çš„é«˜ä¼˜å…ˆçº§updaterå†é‡å¤æ‰§è¡Œä¸€éï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664213267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357686,"user_name":"__Initial","can_delete":false,"product_type":"c1","uid":2331427,"ip_address":"åŒ—äº¬","ucode":"36F36CC058AF11","user_header":"https://static001.geekbang.org/account/avatar/00/23/93/23/6b6feb42.jpg","comment_is_top":false,"comment_ctime":1663560299,"is_pvip":false,"replies":[{"id":130400,"content":"ä½ å¥½ï¼Œ__Initialï¼Œåœ¨React 18çš„Fiberåè°ƒå¼•æ“ä¸­ï¼Œstateçš„æ›´æ–°ä¼šè¢«åŠ å…¥åˆ°ä¸€ä¸ªåä¸ºupdateQueueçš„å•å‘é“¾è¡¨ä¸­ï¼Œå½“é¡ºåºæ‰§è¡Œæ›´æ–°æ—¶ï¼Œå¦‚æœå½“å‰æ›´æ–°å°±æ˜¯ä¸€ä¸ªstateå€¼ï¼Œåˆ™è®°å½•è¿™ä¸ªå€¼ä¸ºnewStateï¼Œæ‰§è¡Œå…¥ä¸‹ä¸€ä¸ªæ›´æ–°ï¼›å¦‚æœå½“å‰æ›´æ–°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™æŠŠä¸Šä¸€ä¸ªæ›´æ–°æ—¶è®°å½•çš„newStateå€¼ä¼ ç»™å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ›´æ–°å‡½æ•°æ‰§è¡Œçš„ç»“æœä¼šè¦†ç›–newStateå€¼ï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªæ›´æ–°ã€‚\n\nå¦‚æœä½ æ„Ÿå…´è¶£å¯ä»¥è¯»ä¸€ä¸‹è¿™éƒ¨åˆ†çš„Reactæºç ï¼š https:&#47;&#47;github.com&#47;facebook&#47;react&#47;blob&#47;v18.2.0&#47;packages&#47;react-reconciler&#47;src&#47;ReactFiberClassUpdateQueue.old.js#L573-L580","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1664209358,"ip_address":"åŒ—äº¬","comment_id":357686,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"æˆ‘æƒ³é—®ä¸€ä¸‹ï¼šåœ¨stateè‡ªåŠ¨æ‰¹å¤„ç†æ—¶ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å‚æ•°å°±å¯ä»¥ä¿è¯æ›´æ–°å‡½æ•°ä½¿ç”¨æœ€æ–°çš„state","like_count":1,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588917,"discussion_content":"ä½ å¥½ï¼Œ__Initialï¼Œåœ¨React 18çš„Fiberåè°ƒå¼•æ“ä¸­ï¼Œstateçš„æ›´æ–°ä¼šè¢«åŠ å…¥åˆ°ä¸€ä¸ªåä¸ºupdateQueueçš„å•å‘é“¾è¡¨ä¸­ï¼Œå½“é¡ºåºæ‰§è¡Œæ›´æ–°æ—¶ï¼Œå¦‚æœå½“å‰æ›´æ–°å°±æ˜¯ä¸€ä¸ªstateå€¼ï¼Œåˆ™è®°å½•è¿™ä¸ªå€¼ä¸ºnewStateï¼Œæ‰§è¡Œå…¥ä¸‹ä¸€ä¸ªæ›´æ–°ï¼›å¦‚æœå½“å‰æ›´æ–°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™æŠŠä¸Šä¸€ä¸ªæ›´æ–°æ—¶è®°å½•çš„newStateå€¼ä¼ ç»™å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ›´æ–°å‡½æ•°æ‰§è¡Œçš„ç»“æœä¼šè¦†ç›–newStateå€¼ï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªæ›´æ–°ã€‚\n\nå¦‚æœä½ æ„Ÿå…´è¶£å¯ä»¥è¯»ä¸€ä¸‹è¿™éƒ¨åˆ†çš„Reactæºç ï¼š https://github.com/facebook/react/blob/v18.2.0/packages/react-reconciler/src/ReactFiberClassUpdateQueue.old.js#L573-L580","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664209358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357515,"user_name":"é£å¤ªå¤§å¤ªå¤§","can_delete":false,"product_type":"c1","uid":1368376,"ip_address":"åŒ—äº¬","ucode":"E0221487898D62","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/dCfVz7wIUT4fM7zQO3gIwXo3BGodP5FJuCdMxobZ5dXpzBeTXiaB3icoFqj22EbIGCu1xxd1FLo9xic0a2pGnunibg/132","comment_is_top":false,"comment_ctime":1663323622,"is_pvip":false,"replies":[{"id":130296,"content":"ä½ å¥½ï¼Œé£å¤ªå¤§å¤ªå¤§ï¼Œå¾ˆæ£’çš„ç­”æ¡ˆï¼æ­£å¦‚ä½ æ‰€å›ç­”çš„ï¼Œè¿™äº›å°±æ˜¯ç¬¬10è®²ä¼šè®²åˆ°çš„React Hooksçš„ä½¿ç”¨è§„åˆ™ã€‚\n\nå¦å¤–åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œå½“å¼€å‘è€…è¿åäº†ä½¿ç”¨è§„åˆ™æ—¶ï¼ŒReactçš„Lintè§„åˆ™ä¼šæç¤ºé”™è¯¯ï¼ŒåŒæ—¶ç¼–è¯‘å·¥å…·ä¹Ÿä¼šæŠ¥é”™ï¼Œå¦‚ï¼š\n\n  Compiled with problems:\n  ERROR\n  \n  src&#47;KanbanNewCard.js\n    Line 17:15:  React Hook &quot;useEffect&quot; is called conditionally. React Hooks must be called in the exact same order in every component render  react-hooks&#47;rules-of-hooks\n\nè¿™æ˜¯å¾ˆå¥½çš„å¼€å‘è€…ä½“éªŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1663820153,"ip_address":"åŒ—äº¬","comment_id":357515,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"1. å‡½æ•°ç»„ä»¶ä¹‹å¤–çš„ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­è°ƒç”¨ useState ä¸ä¼šç”Ÿæ•ˆ\n2. å‡½æ•°ç»„ä»¶å†…éƒ¨åŠ ä¸€ä¸ª if æ¡ä»¶è¯­å¥ï¼Œåœ¨æ»¡è¶³æ¡ä»¶æ—¶æ‰å»è°ƒç”¨ useState ä¸ä¼šç”Ÿæ•ˆã€‚\n3. åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨ useStateï¼Œå†åœ¨å‡½æ•°ç»„ä»¶å†…è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚  useState ä¸ä¼šç”Ÿæ•ˆ\n","like_count":1,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588538,"discussion_content":"ä½ å¥½ï¼Œé£å¤ªå¤§å¤ªå¤§ï¼Œå¾ˆæ£’çš„ç­”æ¡ˆï¼æ­£å¦‚ä½ æ‰€å›ç­”çš„ï¼Œè¿™äº›å°±æ˜¯ç¬¬10è®²ä¼šè®²åˆ°çš„React Hooksçš„ä½¿ç”¨è§„åˆ™ã€‚\n\nå¦å¤–åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œå½“å¼€å‘è€…è¿åäº†ä½¿ç”¨è§„åˆ™æ—¶ï¼ŒReactçš„Lintè§„åˆ™ä¼šæç¤ºé”™è¯¯ï¼ŒåŒæ—¶ç¼–è¯‘å·¥å…·ä¹Ÿä¼šæŠ¥é”™ï¼Œå¦‚ï¼š\n\n  Compiled with problems:\n  ERROR\n  \n  src/KanbanNewCard.js\n    Line 17:15:  React Hook &#34;useEffect&#34; is called conditionally. React Hooks must be called in the exact same order in every component render  react-hooks/rules-of-hooks\n\nè¿™æ˜¯å¾ˆå¥½çš„å¼€å‘è€…ä½“éªŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663820153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357566,"user_name":"å­¦ä¹ å‰ç«¯-react","can_delete":false,"product_type":"c1","uid":1331001,"ip_address":"åŒ—äº¬","ucode":"6C873AF98F3498","user_header":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1663401068,"is_pvip":false,"replies":[{"id":130298,"content":"ä½ å¥½ï¼Œå­¦ä¹ å‰ç«¯-reactï¼Œèµï¼Œå¾ˆæ£’çš„ç­”æ¡ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1663820784,"ip_address":"åŒ—äº¬","comment_id":357566,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"éš”äº†å¥½ä¹…ï¼Œå›ç­”ç¬¬äºŒä¸ªé—®é¢˜ã€‚\nuseRef çš„ä½¿ç”¨æ–¹å¼æ˜¯ç”¨ç”¨ä¼šå­˜æ”¾ä¸€ä¸ªæœ€æ–°çš„å€¼å³ currentï¼Œæ¯æ¬¡ä¿®æ”¹ä¹Ÿä¸ä¼šè§¦å‘å½“å‰ç»„ä»¶çš„renderï¼Œè¿™ä¸ªåº”è¯¥å°±åŒºåˆ«äº useState äº†ï¼Œå› ä¸ºsetState ä¼šè§¦å‘å½“å‰ç»„ä»¶çš„renderã€‚","like_count":0,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588540,"discussion_content":"ä½ å¥½ï¼Œå­¦ä¹ å‰ç«¯-reactï¼Œèµï¼Œå¾ˆæ£’çš„ç­”æ¡ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663820784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366132,"user_name":"å¥•æ™¨","can_delete":false,"product_type":"c1","uid":3000956,"ip_address":"å±±ä¸œ","ucode":"59E240369BC1DC","user_header":"https://static001.geekbang.org/account/avatar/00/2d/ca/7c/98193e9e.jpg","comment_is_top":false,"comment_ctime":1673417071,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"Hook åœ¨ä½¿ç”¨ä¸­éƒ½ä¼šæœ‰å“ªäº›é™åˆ¶ï¼š\n1. åœ¨å‡½æ•°ç»„ä»¶ä¹‹å¤–çš„ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­è°ƒç”¨ useStateï¼›\n    åœ¨å‡½æ•°ç»„ä»¶ä¹‹å¤–çš„æ™®é€šå‡½æ•°ä¸èƒ½è°ƒç”¨ useStateï¼›\n2. åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨åŠ ä¸€ä¸ª if æ¡ä»¶è¯­å¥ï¼Œåœ¨æ»¡è¶³æ¡ä»¶æ—¶æ‰å»è°ƒç”¨ useStateï¼›\n   ä¸èƒ½\n3. åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨è°ƒç”¨ useStateï¼Œå†åœ¨å‡½æ•°ç»„ä»¶å†…è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚\n    ä¸èƒ½\nåªèƒ½åœ¨Reactå‡½æ•°ä¸­è°ƒç”¨Hookã€‚\n\n\nå¯ä»¥ç”¨ useRef æ¥ä»£æ›¿ useState å—ï¼Ÿ\nä¸å¯ä»¥ï¼ŒuseStateä¼šé‡æ–°æ¸²æŸ“ï¼ŒuseRef å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚","like_count":1},{"had_liked":false,"id":390940,"user_name":"huangnan0709","can_delete":false,"product_type":"c1","uid":3895692,"ip_address":"å¹¿ä¸œ","ucode":"67F828E89F43F5","user_header":"https://static001.geekbang.org/account/avatar/00/3b/71/8c/0ee14f99.jpg","comment_is_top":false,"comment_ctime":1716810629,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"useStateçš„setå‡½æ•°ï¼Œæ— è®ºæ˜¯ä½¿ç”¨è¡¨è¾¾å¼ï¼Œè¿˜æ˜¯å‡½æ•°è¿”å›å€¼æ›´æ–°çŠ¶æ€ï¼Œéƒ½èƒ½åœ¨ä¸‹ä¸€æ¬¡é‡æ–°æ¸²æŸ“ä¹‹å‰ï¼Œåœ¨setå‡½æ•°çš„å›è°ƒå‡½æ•°å‚æ•°è·å–æœ€æ–°å€¼","like_count":0}]}