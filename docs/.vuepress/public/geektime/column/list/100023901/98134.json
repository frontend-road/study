{"id":98134,"title":"40 | æ¡ˆä¾‹åˆ†æï¼ˆä¸‰ï¼‰ï¼šé«˜æ€§èƒ½é˜Ÿåˆ—Disruptor","content":"<p>æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/90201\">ã€Š20 | å¹¶å‘å®¹å™¨ï¼šéƒ½æœ‰å“ªäº›â€œå‘â€éœ€è¦æˆ‘ä»¬å¡«ï¼Ÿã€‹</a>ä»‹ç»è¿‡Java SDKæä¾›äº†2ä¸ªæœ‰ç•Œé˜Ÿåˆ—ï¼šArrayBlockingQueue å’Œ LinkedBlockingQueueï¼Œå®ƒä»¬éƒ½æ˜¯åŸºäºReentrantLockå®ç°çš„ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œé”çš„æ•ˆç‡å¹¶ä¸é«˜ï¼Œé‚£æœ‰æ²¡æœ‰æ›´å¥½çš„æ›¿ä»£å“å‘¢ï¼Ÿæœ‰ï¼Œä»Šå¤©æˆ‘ä»¬å°±ä»‹ç»ä¸€ç§æ€§èƒ½æ›´é«˜çš„æœ‰ç•Œé˜Ÿåˆ—ï¼šDisruptorã€‚</p><p><strong>Disruptoræ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„æœ‰ç•Œå†…å­˜é˜Ÿåˆ—</strong>ï¼Œç›®å‰åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒLog4j2ã€Spring Messagingã€HBaseã€Storméƒ½ç”¨åˆ°äº†Disruptorï¼Œé‚£Disruptorçš„æ€§èƒ½ä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜å‘¢ï¼ŸDisruptoré¡¹ç›®å›¢é˜Ÿæ›¾ç»å†™è¿‡ä¸€ç¯‡è®ºæ–‡ï¼Œè¯¦ç»†è§£é‡Šäº†å…¶åŸå› ï¼Œå¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹ï¼š</p><ol>\n<li>å†…å­˜åˆ†é…æ›´åŠ åˆç†ï¼Œä½¿ç”¨RingBufferæ•°æ®ç»“æ„ï¼Œæ•°ç»„å…ƒç´ åœ¨åˆå§‹åŒ–æ—¶ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºï¼Œæå‡ç¼“å­˜å‘½ä¸­ç‡ï¼›å¯¹è±¡å¾ªç¯åˆ©ç”¨ï¼Œé¿å…é¢‘ç¹GCã€‚</li>\n<li>èƒ½å¤Ÿé¿å…ä¼ªå…±äº«ï¼Œæå‡ç¼“å­˜åˆ©ç”¨ç‡ã€‚</li>\n<li>é‡‡ç”¨æ— é”ç®—æ³•ï¼Œé¿å…é¢‘ç¹åŠ é”ã€è§£é”çš„æ€§èƒ½æ¶ˆè€—ã€‚</li>\n<li>æ”¯æŒæ‰¹é‡æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…å¯ä»¥æ— é”æ–¹å¼æ¶ˆè´¹å¤šä¸ªæ¶ˆæ¯ã€‚</li>\n</ol><p>å…¶ä¸­ï¼Œå‰ä¸‰ç‚¹æ¶‰åŠåˆ°çš„çŸ¥è¯†æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥ä»Šå¤©å’±ä»¬é‡ç‚¹è®²è§£å‰ä¸‰ç‚¹ï¼Œä¸è¿‡åœ¨è¯¦ç»†ä»‹ç»è¿™äº›çŸ¥è¯†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥èŠèŠDisruptorå¦‚ä½•ä½¿ç”¨ï¼Œå¥½è®©ä½ å…ˆå¯¹Disruptoræœ‰ä¸ªæ„Ÿå®˜çš„è®¤è¯†ã€‚</p><!-- [[[read_end]]] --><p>ä¸‹é¢çš„ä»£ç å‡ºè‡ªå®˜æ–¹ç¤ºä¾‹ï¼Œæˆ‘ç•¥åšäº†ä¸€äº›ä¿®æ”¹ï¼Œç›¸è¾ƒè€Œè¨€ï¼ŒDisruptorçš„ä½¿ç”¨æ¯”Java SDKæä¾›BlockingQueueè¦å¤æ‚ä¸€äº›ï¼Œä½†æ˜¯æ€»ä½“æ€è·¯è¿˜æ˜¯ä¸€è‡´çš„ï¼Œå…¶å¤§è‡´æƒ…å†µå¦‚ä¸‹ï¼š</p><ul>\n<li>åœ¨Disruptorä¸­ï¼Œç”Ÿäº§è€…ç”Ÿäº§çš„å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯æ¶ˆè´¹è€…æ¶ˆè´¹çš„å¯¹è±¡ï¼‰ç§°ä¸ºEventï¼Œä½¿ç”¨Disruptorå¿…é¡»è‡ªå®šä¹‰Eventï¼Œä¾‹å¦‚ç¤ºä¾‹ä»£ç çš„è‡ªå®šä¹‰Eventæ˜¯LongEventï¼›</li>\n<li>æ„å»ºDisruptorå¯¹è±¡é™¤äº†è¦æŒ‡å®šé˜Ÿåˆ—å¤§å°å¤–ï¼Œè¿˜éœ€è¦ä¼ å…¥ä¸€ä¸ªEventFactoryï¼Œç¤ºä¾‹ä»£ç ä¸­ä¼ å…¥çš„æ˜¯<code>LongEvent::new</code>ï¼›</li>\n<li>æ¶ˆè´¹Disruptorä¸­çš„Eventéœ€è¦é€šè¿‡handleEventsWith()æ–¹æ³•æ³¨å†Œä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå‘å¸ƒEventåˆ™éœ€è¦é€šè¿‡publishEvent()æ–¹æ³•ã€‚</li>\n</ul><pre><code>//è‡ªå®šä¹‰Event\nclass LongEvent {\n  private long value;\n  public void set(long value) {\n    this.value = value;\n  }\n}\n//æŒ‡å®šRingBufferå¤§å°,\n//å¿…é¡»æ˜¯2çš„Næ¬¡æ–¹\nint bufferSize = 1024;\n\n//æ„å»ºDisruptor\nDisruptor&lt;LongEvent&gt; disruptor \n  = new Disruptor&lt;&gt;(\n    LongEvent::new,\n    bufferSize,\n    DaemonThreadFactory.INSTANCE);\n\n//æ³¨å†Œäº‹ä»¶å¤„ç†å™¨\ndisruptor.handleEventsWith(\n  (event, sequence, endOfBatch) -&gt;\n    System.out.println(&quot;E: &quot;+event));\n\n//å¯åŠ¨Disruptor\ndisruptor.start();\n\n//è·å–RingBuffer\nRingBuffer&lt;LongEvent&gt; ringBuffer \n  = disruptor.getRingBuffer();\n//ç”Ÿäº§Event\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; true; l++){\n  bb.putLong(0, l);\n  //ç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯\n  ringBuffer.publishEvent(\n    (event, sequence, buffer) -&gt; \n      event.set(buffer.getLong(0)), bb);\n  Thread.sleep(1000);\n}\n</code></pre><h2>RingBufferå¦‚ä½•æå‡æ€§èƒ½</h2><p>Java SDKä¸­ArrayBlockingQueueä½¿ç”¨<strong>æ•°ç»„</strong>ä½œä¸ºåº•å±‚çš„æ•°æ®å­˜å‚¨ï¼Œè€ŒDisruptoræ˜¯ä½¿ç”¨<strong>RingBuffer</strong>ä½œä¸ºæ•°æ®å­˜å‚¨ã€‚RingBufferæœ¬è´¨ä¸Šä¹Ÿæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥ä»…ä»…å°†æ•°æ®å­˜å‚¨ä»æ•°ç»„æ¢æˆRingBufferå¹¶ä¸èƒ½æå‡æ€§èƒ½ï¼Œä½†æ˜¯Disruptoråœ¨RingBufferçš„åŸºç¡€ä¸Šè¿˜åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œå…¶ä¸­ä¸€é¡¹ä¼˜åŒ–å°±æ˜¯å’Œå†…å­˜åˆ†é…æœ‰å…³çš„ã€‚</p><p>åœ¨ä»‹ç»è¿™é¡¹ä¼˜åŒ–ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ç¨‹åºçš„å±€éƒ¨æ€§åŸç†ã€‚ç®€å•æ¥è®²ï¼Œ<strong>ç¨‹åºçš„å±€éƒ¨æ€§åŸç†æŒ‡çš„æ˜¯åœ¨ä¸€æ®µæ—¶é—´å†…ç¨‹åºçš„æ‰§è¡Œä¼šé™å®šåœ¨ä¸€ä¸ªå±€éƒ¨èŒƒå›´å†…</strong>ã€‚è¿™é‡Œçš„â€œå±€éƒ¨æ€§â€å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢æ¥ç†è§£ï¼Œä¸€ä¸ªæ˜¯æ—¶é—´å±€éƒ¨æ€§ï¼Œå¦ä¸€ä¸ªæ˜¯ç©ºé—´å±€éƒ¨æ€§ã€‚<strong>æ—¶é—´å±€éƒ¨æ€§</strong>æŒ‡çš„æ˜¯ç¨‹åºä¸­çš„æŸæ¡æŒ‡ä»¤ä¸€æ—¦è¢«æ‰§è¡Œï¼Œä¸ä¹…ä¹‹åè¿™æ¡æŒ‡ä»¤å¾ˆå¯èƒ½å†æ¬¡è¢«æ‰§è¡Œï¼›å¦‚æœæŸæ¡æ•°æ®è¢«è®¿é—®ï¼Œä¸ä¹…ä¹‹åè¿™æ¡æ•°æ®å¾ˆå¯èƒ½å†æ¬¡è¢«è®¿é—®ã€‚è€Œ<strong>ç©ºé—´å±€éƒ¨æ€§</strong>æ˜¯æŒ‡æŸå—å†…å­˜ä¸€æ—¦è¢«è®¿é—®ï¼Œä¸ä¹…ä¹‹åè¿™å—å†…å­˜é™„è¿‘çš„å†…å­˜ä¹Ÿå¾ˆå¯èƒ½è¢«è®¿é—®ã€‚</p><p>CPUçš„ç¼“å­˜å°±åˆ©ç”¨äº†ç¨‹åºçš„å±€éƒ¨æ€§åŸç†ï¼šCPUä»å†…å­˜ä¸­åŠ è½½æ•°æ®Xæ—¶ï¼Œä¼šå°†æ•°æ®Xç¼“å­˜åœ¨é«˜é€Ÿç¼“å­˜Cacheä¸­ï¼Œå®é™…ä¸ŠCPUç¼“å­˜Xçš„åŒæ—¶ï¼Œè¿˜ç¼“å­˜äº†Xå‘¨å›´çš„æ•°æ®ï¼Œå› ä¸ºæ ¹æ®ç¨‹åºå…·å¤‡å±€éƒ¨æ€§åŸç†ï¼ŒXå‘¨å›´çš„æ•°æ®ä¹Ÿå¾ˆæœ‰å¯èƒ½è¢«è®¿é—®ã€‚ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œå¦‚æœç¨‹åºèƒ½å¤Ÿå¾ˆå¥½åœ°ä½“ç°å‡ºå±€éƒ¨æ€§åŸç†ï¼Œä¹Ÿå°±èƒ½æ›´å¥½åœ°åˆ©ç”¨CPUçš„ç¼“å­˜ï¼Œä»è€Œæå‡ç¨‹åºçš„æ€§èƒ½ã€‚Disruptoråœ¨è®¾è®¡RingBufferçš„æ—¶å€™å°±å……åˆ†è€ƒè™‘äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¯¹æ¯”ç€ArrayBlockingQueueæ¥åˆ†æä¸€ä¸‹ã€‚</p><p>é¦–å…ˆæ˜¯ArrayBlockingQueueã€‚ç”Ÿäº§è€…çº¿ç¨‹å‘ArrayBlockingQueueå¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œæ¯æ¬¡å¢åŠ å…ƒç´ Eä¹‹å‰ï¼Œéƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡Eï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒArrayBlockingQueueå†…éƒ¨æœ‰6ä¸ªå…ƒç´ ï¼Œè¿™6ä¸ªå…ƒç´ éƒ½æ˜¯ç”±ç”Ÿäº§è€…çº¿ç¨‹åˆ›å»ºçš„ï¼Œç”±äºåˆ›å»ºè¿™äº›å…ƒç´ çš„æ—¶é—´åŸºæœ¬ä¸Šæ˜¯ç¦»æ•£çš„ï¼Œæ‰€ä»¥è¿™äº›å…ƒç´ çš„å†…å­˜åœ°å€å¤§æ¦‚ç‡ä¹Ÿä¸æ˜¯è¿ç»­çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/84/90/848fd30644355ea86f3f91b06bfafa90.png?wh=1142*393\" alt=\"\"></p><center><span class=\"reference\">ArrayBlockingQueueå†…éƒ¨ç»“æ„å›¾</span></center><p>ä¸‹é¢æˆ‘ä»¬å†çœ‹çœ‹Disruptoræ˜¯å¦‚ä½•å¤„ç†çš„ã€‚Disruptorå†…éƒ¨çš„RingBufferä¹Ÿæ˜¯ç”¨æ•°ç»„å®ç°çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹åŒ–æ—¶æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºçš„ï¼Œæ‰€ä»¥è¿™äº›å…ƒç´ çš„å†…å­˜åœ°å€å¤§æ¦‚ç‡æ˜¯è¿ç»­çš„ï¼Œç›¸å…³çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code>for (int i=0; i&lt;bufferSize; i++){\n  //entries[]å°±æ˜¯RingBufferå†…éƒ¨çš„æ•°ç»„\n  //eventFactoryå°±æ˜¯å‰é¢ç¤ºä¾‹ä»£ç ä¸­ä¼ å…¥çš„LongEvent::new\n  entries[BUFFER_PAD + i] \n    = eventFactory.newInstance();\n}\n</code></pre><p>Disruptorå†…éƒ¨RingBufferçš„ç»“æ„å¯ä»¥ç®€åŒ–æˆä¸‹å›¾ï¼Œé‚£é—®é¢˜æ¥äº†ï¼Œæ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ å†…å­˜åœ°å€è¿ç»­èƒ½æå‡æ€§èƒ½å—ï¼Ÿèƒ½ï¼ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ¶ˆè´¹è€…çº¿ç¨‹åœ¨æ¶ˆè´¹çš„æ—¶å€™ï¼Œæ˜¯éµå¾ªç©ºé—´å±€éƒ¨æ€§åŸç†çš„ï¼Œæ¶ˆè´¹å®Œç¬¬1ä¸ªå…ƒç´ ï¼Œå¾ˆå¿«å°±ä¼šæ¶ˆè´¹ç¬¬2ä¸ªå…ƒç´ ï¼›å½“æ¶ˆè´¹ç¬¬1ä¸ªå…ƒç´ E1çš„æ—¶å€™ï¼ŒCPUä¼šæŠŠå†…å­˜ä¸­E1åé¢çš„æ•°æ®ä¹ŸåŠ è½½è¿›Cacheï¼Œå¦‚æœE1å’ŒE2åœ¨å†…å­˜ä¸­çš„åœ°å€æ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆE2ä¹Ÿå°±ä¼šè¢«åŠ è½½è¿›Cacheä¸­ï¼Œç„¶åå½“æ¶ˆè´¹ç¬¬2ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œç”±äºE2å·²ç»åœ¨Cacheä¸­äº†ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦ä»å†…å­˜ä¸­åŠ è½½äº†ï¼Œè¿™æ ·å°±èƒ½å¤§å¤§æå‡æ€§èƒ½ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/33/37/33bc0d35615f5d5f7869871e0cfed037.png?wh=1142*568\" alt=\"\"></p><center><span class=\"reference\">Disruptorå†…éƒ¨RingBufferç»“æ„å›¾</span></center><p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨Disruptorä¸­ï¼Œç”Ÿäº§è€…çº¿ç¨‹é€šè¿‡publishEvent()å‘å¸ƒEventçš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„Eventï¼Œè€Œæ˜¯é€šè¿‡event.set()æ–¹æ³•ä¿®æ”¹Eventï¼Œ ä¹Ÿå°±æ˜¯è¯´RingBufferåˆ›å»ºçš„Eventæ˜¯å¯ä»¥å¾ªç¯åˆ©ç”¨çš„ï¼Œè¿™æ ·è¿˜èƒ½é¿å…é¢‘ç¹åˆ›å»ºã€åˆ é™¤Eventå¯¼è‡´çš„é¢‘ç¹GCé—®é¢˜ã€‚</p><h2>å¦‚ä½•é¿å…â€œä¼ªå…±äº«â€</h2><p>é«˜æ•ˆåˆ©ç”¨Cacheï¼Œèƒ½å¤Ÿå¤§å¤§æå‡æ€§èƒ½ï¼Œæ‰€ä»¥è¦åŠªåŠ›æ„å»ºèƒ½å¤Ÿé«˜æ•ˆåˆ©ç”¨Cacheçš„å†…å­˜ç»“æ„ã€‚è€Œä»å¦å¤–ä¸€ä¸ªè§’åº¦çœ‹ï¼ŒåŠªåŠ›é¿å…ä¸èƒ½é«˜æ•ˆåˆ©ç”¨Cacheçš„å†…å­˜ç»“æ„ä¹ŸåŒæ ·é‡è¦ã€‚</p><p>æœ‰ä¸€ç§å«åšâ€œä¼ªå…±äº«ï¼ˆFalse sharingï¼‰â€çš„å†…å­˜å¸ƒå±€å°±ä¼šä½¿Cacheå¤±æ•ˆï¼Œé‚£ä»€ä¹ˆæ˜¯â€œä¼ªå…±äº«â€å‘¢ï¼Ÿ</p><p>ä¼ªå…±äº«å’ŒCPUå†…éƒ¨çš„Cacheæœ‰å…³ï¼ŒCacheå†…éƒ¨æ˜¯æŒ‰ç…§ç¼“å­˜è¡Œï¼ˆCache Lineï¼‰ç®¡ç†çš„ï¼Œç¼“å­˜è¡Œçš„å¤§å°é€šå¸¸æ˜¯64ä¸ªå­—èŠ‚ï¼›CPUä»å†…å­˜ä¸­åŠ è½½æ•°æ®Xï¼Œä¼šåŒæ—¶åŠ è½½Xåé¢ï¼ˆ64-size(X)ï¼‰ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å‡ºè‡ªJava SDKçš„ArrayBlockingQueueï¼Œå…¶å†…éƒ¨ç»´æŠ¤äº†4ä¸ªæˆå‘˜å˜é‡ï¼Œåˆ†åˆ«æ˜¯é˜Ÿåˆ—æ•°ç»„itemsã€å‡ºé˜Ÿç´¢å¼•takeIndexã€å…¥é˜Ÿç´¢å¼•putIndexä»¥åŠé˜Ÿåˆ—ä¸­çš„å…ƒç´ æ€»æ•°countã€‚</p><pre><code>/** é˜Ÿåˆ—æ•°ç»„ */\nfinal Object[] items;\n/** å‡ºé˜Ÿç´¢å¼• */\nint takeIndex;\n/** å…¥é˜Ÿç´¢å¼• */\nint putIndex;\n/** é˜Ÿåˆ—ä¸­å…ƒç´ æ€»æ•° */\nint count;\n</code></pre><p>å½“CPUä»å†…å­˜ä¸­åŠ è½½takeIndexçš„æ—¶å€™ï¼Œä¼šåŒæ—¶å°†putIndexä»¥åŠcountéƒ½åŠ è½½è¿›Cacheã€‚ä¸‹å›¾æ˜¯æŸä¸ªæ—¶åˆ»CPUä¸­Cacheçš„çŠ¶å†µï¼Œä¸ºäº†ç®€åŒ–ï¼Œç¼“å­˜è¡Œä¸­æˆ‘ä»¬ä»…åˆ—å‡ºäº†takeIndexå’ŒputIndexã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fd/5c/fdccf96bda79453e55ed75e418864b5c.png?wh=1142*681\" alt=\"\"></p><center><span class=\"reference\">CPUç¼“å­˜ç¤ºæ„å›¾</span></center><p>å‡è®¾çº¿ç¨‹Aè¿è¡Œåœ¨CPU-1ä¸Šï¼Œæ‰§è¡Œå…¥é˜Ÿæ“ä½œï¼Œå…¥é˜Ÿæ“ä½œä¼šä¿®æ”¹putIndexï¼Œè€Œä¿®æ”¹putIndexä¼šå¯¼è‡´å…¶æ‰€åœ¨çš„æ‰€æœ‰æ ¸ä¸Šçš„ç¼“å­˜è¡Œå‡å¤±æ•ˆï¼›æ­¤æ—¶å‡è®¾è¿è¡Œåœ¨CPU-2ä¸Šçš„çº¿ç¨‹æ‰§è¡Œå‡ºé˜Ÿæ“ä½œï¼Œå‡ºé˜Ÿæ“ä½œéœ€è¦è¯»å–takeIndexï¼Œç”±äºtakeIndexæ‰€åœ¨çš„ç¼“å­˜è¡Œå·²ç»å¤±æ•ˆï¼Œæ‰€ä»¥CPU-2å¿…é¡»ä»å†…å­˜ä¸­é‡æ–°è¯»å–ã€‚å…¥é˜Ÿæ“ä½œæœ¬ä¸ä¼šä¿®æ”¹takeIndexï¼Œä½†æ˜¯ç”±äºtakeIndexå’ŒputIndexå…±äº«çš„æ˜¯ä¸€ä¸ªç¼“å­˜è¡Œï¼Œå°±å¯¼è‡´å‡ºé˜Ÿæ“ä½œä¸èƒ½å¾ˆå¥½åœ°åˆ©ç”¨Cacheï¼Œè¿™å…¶å®å°±æ˜¯<strong>ä¼ªå…±äº«</strong>ã€‚ç®€å•æ¥è®²ï¼Œ<strong>ä¼ªå…±äº«æŒ‡çš„æ˜¯ç”±äºå…±äº«ç¼“å­˜è¡Œå¯¼è‡´ç¼“å­˜æ— æ•ˆçš„åœºæ™¯</strong>ã€‚</p><p>ArrayBlockingQueueçš„å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œæ˜¯ç”¨é”æ¥ä¿è¯äº’æ–¥çš„ï¼Œæ‰€ä»¥å…¥é˜Ÿå’Œå‡ºé˜Ÿä¸ä¼šåŒæ—¶å‘ç”Ÿã€‚å¦‚æœå…è®¸å…¥é˜Ÿå’Œå‡ºé˜ŸåŒæ—¶å‘ç”Ÿï¼Œé‚£å°±ä¼šå¯¼è‡´çº¿ç¨‹Aå’Œçº¿ç¨‹Bäº‰ç”¨åŒä¸€ä¸ªç¼“å­˜è¡Œï¼Œè¿™æ ·ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚æ‰€ä»¥ä¸ºäº†æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ï¼Œæˆ‘ä»¬å¿…é¡»é¿å…ä¼ªå…±äº«ï¼Œé‚£å¦‚ä½•é¿å…å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/d5/27/d5d5afc11fe6b1aaf8c9be7dba643827.png?wh=1142*679\" alt=\"\"></p><center><span class=\"reference\">CPUç¼“å­˜å¤±æ•ˆç¤ºæ„å›¾</span></center><p>æ–¹æ¡ˆå¾ˆç®€å•ï¼Œ<strong>æ¯ä¸ªå˜é‡ç‹¬å ä¸€ä¸ªç¼“å­˜è¡Œã€ä¸å…±äº«ç¼“å­˜è¡Œ</strong>å°±å¯ä»¥äº†ï¼Œå…·ä½“æŠ€æœ¯æ˜¯<strong>ç¼“å­˜è¡Œå¡«å……</strong>ã€‚æ¯”å¦‚æƒ³è®©takeIndexç‹¬å ä¸€ä¸ªç¼“å­˜è¡Œï¼Œå¯ä»¥åœ¨takeIndexçš„å‰åå„å¡«å……56ä¸ªå­—èŠ‚ï¼Œè¿™æ ·å°±ä¸€å®šèƒ½ä¿è¯takeIndexç‹¬å ä¸€ä¸ªç¼“å­˜è¡Œã€‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å‡ºè‡ªDisruptorï¼ŒSequence å¯¹è±¡ä¸­çš„valueå±æ€§å°±èƒ½é¿å…ä¼ªå…±äº«ï¼Œå› ä¸ºè¿™ä¸ªå±æ€§å‰åéƒ½å¡«å……äº†56ä¸ªå­—èŠ‚ã€‚Disruptorä¸­å¾ˆå¤šå¯¹è±¡ï¼Œä¾‹å¦‚RingBufferã€RingBufferå†…éƒ¨çš„æ•°ç»„éƒ½ç”¨åˆ°äº†è¿™ç§å¡«å……æŠ€æœ¯æ¥é¿å…ä¼ªå…±äº«ã€‚</p><pre><code>//å‰ï¼šå¡«å……56å­—èŠ‚\nclass LhsPadding{\n    long p1, p2, p3, p4, p5, p6, p7;\n}\nclass Value extends LhsPadding{\n    volatile long value;\n}\n//åï¼šå¡«å……56å­—èŠ‚\nclass RhsPadding extends Value{\n    long p9, p10, p11, p12, p13, p14, p15;\n}\nclass Sequence extends RhsPadding{\n  //çœç•¥å®ç°\n}\n</code></pre><h2>Disruptorä¸­çš„æ— é”ç®—æ³•</h2><p>ArrayBlockingQueueæ˜¯åˆ©ç”¨ç®¡ç¨‹å®ç°çš„ï¼Œä¸­è§„ä¸­çŸ©ï¼Œç”Ÿäº§ã€æ¶ˆè´¹æ“ä½œéƒ½éœ€è¦åŠ é”ï¼Œå®ç°èµ·æ¥ç®€å•ï¼Œä½†æ˜¯æ€§èƒ½å¹¶ä¸ååˆ†ç†æƒ³ã€‚Disruptoré‡‡ç”¨çš„æ˜¯æ— é”ç®—æ³•ï¼Œå¾ˆå¤æ‚ï¼Œä½†æ˜¯æ ¸å¿ƒæ— éæ˜¯ç”Ÿäº§å’Œæ¶ˆè´¹ä¸¤ä¸ªæ“ä½œã€‚Disruptorä¸­æœ€å¤æ‚çš„æ˜¯å…¥é˜Ÿæ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹æ¥çœ‹çœ‹å…¥é˜Ÿæ“ä½œæ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>å¯¹äºå…¥é˜Ÿæ“ä½œï¼Œæœ€å…³é”®çš„è¦æ±‚æ˜¯ä¸èƒ½è¦†ç›–æ²¡æœ‰æ¶ˆè´¹çš„å…ƒç´ ï¼›å¯¹äºå‡ºé˜Ÿæ“ä½œï¼Œæœ€å…³é”®çš„è¦æ±‚æ˜¯ä¸èƒ½è¯»å–æ²¡æœ‰å†™å…¥çš„å…ƒç´ ï¼Œæ‰€ä»¥Disruptorä¸­ä¹Ÿä¸€å®šä¼šç»´æŠ¤ç±»ä¼¼å‡ºé˜Ÿç´¢å¼•å’Œå…¥é˜Ÿç´¢å¼•è¿™æ ·ä¸¤ä¸ªå…³é”®å˜é‡ã€‚Disruptorä¸­çš„RingBufferç»´æŠ¤äº†å…¥é˜Ÿç´¢å¼•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç»´æŠ¤å‡ºé˜Ÿç´¢å¼•ï¼Œè¿™æ˜¯å› ä¸ºåœ¨Disruptorä¸­å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥åŒæ—¶æ¶ˆè´¹ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½ä¼šæœ‰ä¸€ä¸ªå‡ºé˜Ÿç´¢å¼•ï¼Œæ‰€ä»¥RingBufferçš„å‡ºé˜Ÿç´¢å¼•æ˜¯æ‰€æœ‰æ¶ˆè´¹è€…é‡Œé¢æœ€å°çš„é‚£ä¸€ä¸ªã€‚</p><p>ä¸‹é¢æ˜¯Disruptorç”Ÿäº§è€…å…¥é˜Ÿæ“ä½œçš„æ ¸å¿ƒä»£ç ï¼Œçœ‹ä¸Šå»å¾ˆå¤æ‚ï¼Œå…¶å®é€»è¾‘å¾ˆç®€å•ï¼šå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ç©ºä½™ä½ç½®ï¼Œå°±å‡ºè®©CPUä½¿ç”¨æƒï¼Œç„¶åé‡æ–°è®¡ç®—ï¼›åä¹‹åˆ™ç”¨CASè®¾ç½®å…¥é˜Ÿç´¢å¼•ã€‚</p><pre><code>//ç”Ÿäº§è€…è·å–nä¸ªå†™å…¥ä½ç½®\ndo {\n  //cursorç±»ä¼¼äºå…¥é˜Ÿç´¢å¼•ï¼ŒæŒ‡çš„æ˜¯ä¸Šæ¬¡ç”Ÿäº§åˆ°è¿™é‡Œ\n  current = cursor.get();\n  //ç›®æ ‡æ˜¯åœ¨ç”Ÿäº§nä¸ª\n  next = current + n;\n  //å‡æ‰ä¸€ä¸ªå¾ªç¯\n  long wrapPoint = next - bufferSize;\n  //è·å–ä¸Šä¸€æ¬¡çš„æœ€å°æ¶ˆè´¹ä½ç½®\n  long cachedGatingSequence = gatingSequenceCache.get();\n  //æ²¡æœ‰è¶³å¤Ÿçš„ç©ºä½™ä½ç½®\n  if (wrapPoint&gt;cachedGatingSequence || cachedGatingSequence&gt;current){\n    //é‡æ–°è®¡ç®—æ‰€æœ‰æ¶ˆè´¹è€…é‡Œé¢çš„æœ€å°å€¼ä½ç½®\n    long gatingSequence = Util.getMinimumSequence(\n        gatingSequences, current);\n    //ä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºä½™ä½ç½®ï¼Œå‡ºè®©CPUä½¿ç”¨æƒï¼Œé‡æ–°æ‰§è¡Œä¸‹ä¸€å¾ªç¯\n    if (wrapPoint &gt; gatingSequence){\n      LockSupport.parkNanos(1);\n      continue;\n    }\n    //ä»æ–°è®¾ç½®ä¸Šä¸€æ¬¡çš„æœ€å°æ¶ˆè´¹ä½ç½®\n    gatingSequenceCache.set(gatingSequence);\n  } else if (cursor.compareAndSet(current, next)){\n    //è·å–å†™å…¥ä½ç½®æˆåŠŸï¼Œè·³å‡ºå¾ªç¯\n    break;\n  }\n} while (true);\n</code></pre><h2>æ€»ç»“</h2><p>Disruptoråœ¨ä¼˜åŒ–å¹¶å‘æ€§èƒ½æ–¹é¢å¯è°“æ˜¯åšåˆ°äº†æè‡´ï¼Œä¼˜åŒ–çš„æ€è·¯å¤§ä½“æ˜¯ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯åˆ©ç”¨æ— é”ç®—æ³•é¿å…é”çš„äº‰ç”¨ï¼Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯å°†ç¡¬ä»¶ï¼ˆCPUï¼‰çš„æ€§èƒ½å‘æŒ¥åˆ°æè‡´ã€‚å°¤å…¶æ˜¯åè€…ï¼Œåœ¨Javaé¢†åŸŸåŸºæœ¬ä¸Šå±äºç»å…¸ä¹‹ä½œäº†ã€‚</p><p>å‘æŒ¥ç¡¬ä»¶çš„èƒ½åŠ›ä¸€èˆ¬æ˜¯Cè¿™ç§é¢å‘ç¡¬ä»¶çš„è¯­è¨€å¸¸å¹²çš„äº‹å„¿ï¼ŒCè¯­è¨€é¢†åŸŸç»å¸¸é€šè¿‡è°ƒæ•´å†…å­˜å¸ƒå±€ä¼˜åŒ–å†…å­˜å ç”¨ï¼Œè€ŒJavaé¢†åŸŸåˆ™ç”¨çš„å¾ˆå°‘ï¼ŒåŸå› åœ¨äºJavaå¯ä»¥æ™ºèƒ½åœ°ä¼˜åŒ–å†…å­˜å¸ƒå±€ï¼Œå†…å­˜å¸ƒå±€å¯¹Javaç¨‹åºå‘˜çš„é€æ˜çš„ã€‚è¿™ç§æ™ºèƒ½çš„ä¼˜åŒ–å¤§éƒ¨åˆ†åœºæ™¯æ˜¯å¾ˆå‹å¥½çš„ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³é€šè¿‡å¡«å……æ–¹å¼é¿å…ä¼ªå…±äº«å°±å¿…é¡»ç»•è¿‡è¿™ç§ä¼˜åŒ–ï¼Œå…³äºè¿™æ–¹é¢Disruptoræä¾›äº†ç»å…¸çš„å®ç°ï¼Œä½ å¯ä»¥å‚è€ƒã€‚</p><p>ç”±äºä¼ªå…±äº«é—®é¢˜å¦‚æ­¤é‡è¦ï¼Œæ‰€ä»¥Javaä¹Ÿå¼€å§‹é‡è§†å®ƒäº†ï¼Œæ¯”å¦‚Java 8ä¸­ï¼Œæä¾›äº†é¿å…ä¼ªå…±äº«çš„æ³¨è§£ï¼š@sun.misc.Contendedï¼Œé€šè¿‡è¿™ä¸ªæ³¨è§£å°±èƒ½è½»æ¾é¿å…ä¼ªå…±äº«ï¼ˆéœ€è¦è®¾ç½®JVMå‚æ•°-XX:-RestrictContendedï¼‰ã€‚ä¸è¿‡é¿å…ä¼ªå…±äº«æ˜¯ä»¥ç‰ºç‰²å†…å­˜ä¸ºä»£ä»·çš„ï¼Œæ‰€ä»¥å…·ä½“ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯éœ€è¦ä»”ç»†æ–Ÿé…Œã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"39 | æ¡ˆä¾‹åˆ†æï¼ˆäºŒï¼‰ï¼šé«˜æ€§èƒ½ç½‘ç»œåº”ç”¨æ¡†æ¶Netty","id":97622},"right":{"article_title":"41 | æ¡ˆä¾‹åˆ†æï¼ˆå››ï¼‰ï¼šé«˜æ€§èƒ½æ•°æ®åº“è¿æ¥æ± HiKariCP","id":98491}},"comments":[{"had_liked":false,"id":99335,"user_name":"Juc","can_delete":false,"product_type":"c1","uid":1217566,"ip_address":"","ucode":"EF82A73FAA7F8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/94/1e/973cda79.jpg","comment_is_top":false,"comment_ctime":1559195494,"is_pvip":false,"replies":[{"id":"35741","content":"æ•°ç»„è¿ç»­ï¼Œæ•°ç»„é‡Œåªæœ‰å¼•ç”¨ï¼Œe1 e2è¿™äº›å¯¹è±¡çš„åœ°å€ä¸è¿ç»­","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559226899,"ip_address":"","comment_id":99335,"utype":1}],"discussion_count":2,"race_medal":0,"score":"212012592998","product_id":100023901,"comment_content":"å¸Œæœ›è€å¸ˆè§£é‡Šä¸‹ï¼Œä¸ºä»€ä¹ˆåˆ›å»ºå…ƒç´ çš„æ—¶é—´ç¦»æ•£ä¼šå¯¼è‡´å…ƒç´ çš„å†…å­˜åœ°å€ä¸æ˜¯è¿ç»­çš„?è¿™äº›å…ƒç´ ä¸æ˜¯å­˜åœ¨æ•°ç»„ä¸­çš„å—ï¼Ÿæ•°ç»„åˆå§‹åŒ–ä¸æ˜¯å·²ç»è¿ç»­åˆ†é…å†…å­˜äº†å—ï¼Ÿ","like_count":50,"discussions":[{"author":{"id":1018620,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","nickname":"ipofss","note":"","ucode":"DE3061C9259F9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48054,"discussion_content":"æ˜ç™½äº†ï¼Œä¹Ÿå°±æ˜¯åŸºç¡€ç±»å‹çš„æ•°ç»„ï¼Œæ•°ç»„æ˜¯è¿ç»­çš„ï¼Œæ•°ç»„é‡Œçš„å€¼ä¹Ÿæ˜¯è¿ç»­çš„ï¼›è‹¥æ˜¯å¯¹è±¡æ•°ç»„ï¼Œåˆ™æ•°ç»„å¼•ç”¨æ˜¯è¿ç»­çš„ï¼Œæ•°ç»„é‡Œå­˜æ”¾çš„å…ƒç´ æ˜¯ç¦»æ•£çš„","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1573444752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452064,"discussion_content":"æ•°ç»„è¿ç»­ï¼Œæ•°ç»„é‡Œåªæœ‰å¼•ç”¨ï¼Œe1 e2è¿™äº›å¯¹è±¡çš„åœ°å€ä¸è¿ç»­","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1559226899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110090,"user_name":"å†°æ¿€å‡Œçš„çœ¼æ³ª","can_delete":false,"product_type":"c1","uid":1087945,"ip_address":"","ucode":"5DCB974667E93A","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/c9/a7c77746.jpg","comment_is_top":false,"comment_ctime":1562169558,"is_pvip":false,"replies":[{"id":"39894","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1562199332,"ip_address":"","comment_id":110090,"utype":1}],"discussion_count":5,"race_medal":0,"score":"91756482774","product_id":100023901,"comment_content":"å‰å56ä¸ªå­—èŠ‚ä¿è¯äº†ç›®æ ‡å­—æ®µæ€»æ˜¯ç‹¬å ä¸€ä¸ªcache lineï¼Œä¸å—å‘¨å›´å˜é‡ç¼“å­˜å¤±æ•ˆçš„å½±å“","like_count":21,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456718,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562199332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2329635,"avatar":"https://static001.geekbang.org/account/avatar/00/23/8c/23/f1c5bee0.jpg","nickname":"wang.yu","note":"","ucode":"CCA775784B3EB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387083,"discussion_content":"ä¸ºä»€ä¹ˆæ˜¯56ä¸ªå­—èŠ‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1627977091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1589055,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKKKdCyib4iblXC6JIH7HWDfIFVweTb7SgEOuRjquic3GiaiaGInFSiaU8w2y2bjvZjgiaA3IEQuyibXTaeHQ/132","nickname":"10xiaohu","note":"","ucode":"CAB39DBB93E608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2329635,"avatar":"https://static001.geekbang.org/account/avatar/00/23/8c/23/f1c5bee0.jpg","nickname":"wang.yu","note":"","ucode":"CCA775784B3EB3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538443,"discussion_content":"56+8=64ï¼Œlong 8ä¸ªå­—èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639406040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":387083,"ip_address":""},"score":538443,"extra":""}]},{"author":{"id":1636963,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fa/63/24640b68.jpg","nickname":"å¼ å°ä¼™å­","note":"","ucode":"FA6844F58ECD39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587467,"discussion_content":"ä¸ºä»€ä¹ˆå‰åéƒ½éœ€è¦56ä¸ªå­—èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663069050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2028946,"avatar":"","nickname":"Geek3443","note":"","ucode":"C6351639FD0633","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1636963,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fa/63/24640b68.jpg","nickname":"å¼ å°ä¼™å­","note":"","ucode":"FA6844F58ECD39","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588057,"discussion_content":"å› ä¸ºï¼Œè¿™æ ·å°±ä¿è¯äº†è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œæ¯ä¸ªå±æ€§éƒ½è‚¯å®šéƒ½å¯¹åº”ä¸€ä¸ªç¼“å­˜è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663509341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587467,"ip_address":"åŒ—äº¬"},"score":588057,"extra":""}]}]},{"had_liked":false,"id":268925,"user_name":"ä¸‡å†åäº”å¹´","can_delete":false,"product_type":"c1","uid":1122150,"ip_address":"","ucode":"3D8CF5DF847AE8","user_header":"https://static001.geekbang.org/account/avatar/00/11/1f/66/59e0647a.jpg","comment_is_top":false,"comment_ctime":1608434760,"is_pvip":false,"replies":[{"id":"97552","content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1608465056,"ip_address":"","comment_id":268925,"utype":1}],"discussion_count":1,"race_medal":0,"score":"74622878792","product_id":100023901,"comment_content":"å•æœºæå‡æ€§èƒ½ä¸å¤–ä¹æ˜¯å›´ç»•CPUï¼Œå†…å­˜å’ŒIOæƒ³åŠæ³•ã€‚<br>CPU:Â <br>1.é¿å…çº¿ç¨‹åˆ‡æ¢ï¼šå•çº¿ç¨‹ï¼Œå¯¹äºå¤šçº¿ç¨‹è¿›è¡Œçº¿ç¨‹ç»‘å®šï¼Œä½¿ç”¨CASæ— é”æŠ€æœ¯<br>2.åˆ©ç”¨CPUç¼“å­˜ï¼Œè¿˜æœ‰ç¼“å­˜å¡«å……ï¼Œè®¾è®¡æ•°æ®ç»“æ„å’Œç®—æ³•<br>å†…å­˜ï¼š<br>1.å¤šçº§ç¼“å­˜ï¼šåº”ç”¨ç¼“å­˜ï¼Œç¬¬ä¸‰æ–¹ç¼“å­˜ï¼Œç³»ç»Ÿç¼“å­˜<br>2.æ•°ç»„ä¼˜äºé“¾è¡¨<br>3.é¿å…é¢‘ç¹å†…å­˜ç¢ç‰‡ï¼šåˆ©ç”¨æ± æ€æƒ³å¤ç”¨å¯¹è±¡<br>è§£å†³IOäº§ç”Ÿçš„é€Ÿåº¦å·®:<br>1.å¤šè·¯å¤ç”¨<br>2.é˜Ÿåˆ—å‰Šå³°<br>3.åç¨‹","like_count":17,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512084,"discussion_content":"ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608465056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244133,"user_name":"æƒ˜ é—»","can_delete":false,"product_type":"c1","uid":1181650,"ip_address":"","ucode":"C5909F034BF072","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","comment_is_top":false,"comment_ctime":1598407590,"is_pvip":false,"replies":[{"id":"90176","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1598870194,"ip_address":"","comment_id":244133,"utype":1}],"discussion_count":2,"race_medal":0,"score":"61727949734","product_id":100023901,"comment_content":"if (wrapPoint&gt;cachedGatingSequence || cachedGatingSequence&gt;current)è¿™ä¸ªä½ç½®çš„åˆ¤æ–­åŸæœ¬ä¸æ˜ç™½,çœ‹äº†å‡ éæ€»ç®—æ˜¯æ˜ç™½äº†.    ç¯å½¢é˜Ÿåˆ—,ç”Ÿäº§è€…ä»0ç”Ÿäº§ æ¶ˆè´¹è€…ä»0æ¶ˆè´¹.  wrapPointæ˜¯æŒ‡ç”Ÿäº§äº†ä¸€åœˆ åˆè¾¾åˆ°äº† æ¶ˆè´¹è€…æ¶ˆè´¹çš„æœ€å°çš„ä½ç½®   å¦‚æœæ­¤æ—¶ç»§ç»­ç”Ÿäº§,é‚£ä¹ˆæ¶ˆè´¹æœ€å°‘çš„æ¶ˆè´¹è€…è¿˜æœªæ¶ˆè´¹çš„æ¶ˆæ¯å°†ä¼šè¢«ç”Ÿäº§è€…è¦†ç›–,æ‰€ä»¥æ­¤å¤„è¦åœæ­¢.  è€Œ æœ€å°æ¶ˆè´¹ä½ç½®å¤§äºç”Ÿäº§è€…å½“å‰ç”Ÿäº§ä½ç½®çš„è¯,è¯´æ˜æ¶ˆè´¹åˆ°äº†ç”Ÿäº§è€…è¿˜æœªç”Ÿäº§æ¶ˆæ¯çš„ä½ç½®,æ‰€ä»¥ç­‰å¾…æ¶ˆæ¯çš„ç”Ÿäº§,è¦åœæ­¢.","like_count":14,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504494,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598870194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2070984,"avatar":"","nickname":"dominiczhu","note":"","ucode":"9C87F77CCE06C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387533,"discussion_content":"è°¢è°¢è§£ç­”ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªåˆ¤æ–­æ¡ä»¶é‡Œï¼Œæ¶ˆè´¹è€…æ€ä¹ˆä¼šæ¶ˆè´¹åˆ°äº†æœªç”Ÿäº§æ¶ˆæ¯çš„ä½ç½®ï¼Œä»€ä¹ˆä¼šé€ æˆè¿™ç§æƒ…å†µå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628235861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99352,"user_name":"LW","can_delete":false,"product_type":"c1","uid":1325297,"ip_address":"","ucode":"89820332658E98","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/f1/996a070d.jpg","comment_is_top":false,"comment_ctime":1559198561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53098806113","product_id":100023901,"comment_content":"RingBufferæ˜¯ä¸€ä¸ªç¯å½¢é˜Ÿåˆ—ï¼Ÿ","like_count":12},{"had_liked":false,"id":99296,"user_name":"å­™å¿—å¼º","can_delete":false,"product_type":"c1","uid":1325997,"ip_address":"","ucode":"9C070F1E4EC6FF","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/ad/31193b83.jpg","comment_is_top":false,"comment_ctime":1559187422,"is_pvip":true,"discussion_count":8,"race_medal":0,"score":"44508860382","product_id":100023901,"comment_content":"ç¨‹åºå±€éƒ¨æ€§åŸç†çš„ç©ºé—´å±€éƒ¨æ€§æ˜¯ä¸æ˜¯cpuåˆ†æ”¯é¢„æµ‹?ç¼“å­˜è¡Œä¸€èˆ¬æ˜¯64å­—èŠ‚,takeIndexé‚£ä¸ºä½•å‰åå¡«å……56ä¸ªå­—èŠ‚,å¤§äº64äº†,æ€ä¹ˆç‹¬å ç¼“å­˜è¡Œ?","like_count":10,"discussions":[{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373215,"discussion_content":"56å­—èŠ‚ï¼ˆå‰ï¼‰ï¼Œ8å­—èŠ‚ï¼ˆvalueï¼‰ï¼Œ56å­—èŠ‚ï¼ˆåï¼‰ã€‚64å­—èŠ‚ä¸€ä¸ªcache lineçš„è¯ä¸ç®¡æ€æ ·åˆ‡éƒ½èƒ½ä¿è¯valueåœ¨ä¸€ä¸ªcache line","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1620652665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1179565,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ff/ad/5020a8c5.jpg","nickname":"Farewellä¸¶","note":"","ucode":"A0D69893C5375C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224768,"discussion_content":"å‰åå¡«å……æ˜¯æƒ³è®©ä¿è¯å­—æ®µç‹¬å ä¸€è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä¸€ä¸ªäººå·¦è¾¹æˆ–è€…å³è¾¹éƒ½æ²¡æœ‰ç©ºä½çš„æ—¶å€™ï¼Œæˆ‘å°±è‚¯å®šæ˜¯ç‹¬å ä¸€è¡Œäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586330541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1194853,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3b/65/3a4fc8cf.jpg","nickname":"prepared","note":"","ucode":"00E54A5C7CDCBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336799,"discussion_content":"åªåŠ å‰ä¸€ä¸ª56æˆ–è€…åä¸€ä¸ª56ï¼Œå¹¶ä¸èƒ½ä¿è¯æ•°æ®ç‹¬å ä¸€è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608704831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1620479,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b9/ff/ea6c2e86.jpg","nickname":"æ™¯æ¢¦å›­","note":"","ucode":"0A17708457ACB2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311177,"discussion_content":"ä¸ªäººç†è§£å’Œåˆ†æ”¯é¢„æµ‹ä¸æ˜¯ä¸€å›äº‹ï¼Œå¯ä»¥å‚è€ƒStackOverflowçš„ç»å…¸é—®é¢˜ï¼š https://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602244463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1496998,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d7/a6/1e94e96f.jpg","nickname":"zojian","note":"","ucode":"5EAFEB779BE5C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217178,"discussion_content":"æ„Ÿè§‰å‰å¡«å……æ˜¯å¡«å……å…¶ä»–æ•°æ®çš„ï¼Œåå¡«å……æ‰æ˜¯å¡«å……è‡ªå·±é‚£ä¸€è¡Œçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585524873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106090,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e0/aa/68a7921b.jpg","nickname":"å¸¸æ¸…","note":"","ucode":"EA6975FDFD4D11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":167310,"discussion_content":"Javaä¸­intç±»å‹è‡ªå·±å 8ä¸ªå­—èŠ‚ï¼ŒåŠ ä¸Š56ï¼Œåˆšå¥½ç­‰äº64","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581476058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1118952,"avatar":"https://static001.geekbang.org/account/avatar/00/11/12/e8/aa60f7f1.jpg","nickname":"èµµå­˜é‡‘","note":"","ucode":"89D69F8D2DF269","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1106090,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e0/aa/68a7921b.jpg","nickname":"å¸¸æ¸…","note":"","ucode":"EA6975FDFD4D11","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320873,"discussion_content":"4ä¸ªå­—èŠ‚ è€å“¥","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1604495473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":167310,"ip_address":""},"score":320873,"extra":""}]},{"author":{"id":1008065,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/61/c1/9ad88d67.jpg","nickname":"Mr_æ¨","note":"","ucode":"AD31C2320DF6A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49538,"discussion_content":"è¿˜æœ‰æ•°æ®æœ¬èº«å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99414,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1559209964,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31623981036","product_id":100023901,"comment_content":"mysqlä¹Ÿåˆ©ç”¨äº†ç¨‹åºçš„å±€éƒ¨æ€§åŸç†æ¥å‡å°‘ç£ç›˜çš„ioï¼Œç™¾åº¦å¼€æºçš„åˆ†å¸ƒå¼å”¯ä¸€idç”Ÿæˆå™¨ä¹Ÿä½¿ç”¨äº†RingBufferï¼Œå°†æå‰ç”Ÿæˆçš„idç¼“å­˜åˆ°RingBufferä¸­ã€‚","like_count":7},{"had_liked":false,"id":199825,"user_name":"ğŸ˜œå“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1069001,"ip_address":"","ucode":"1FF58FB3A91135","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/c9/88837387.jpg","comment_is_top":false,"comment_ctime":1585496535,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"27355300311","product_id":100023901,"comment_content":"å°ç±³å°†disruptorç”¨äºç§’æ€åœºæ™¯","like_count":6,"discussions":[{"author":{"id":1736807,"avatar":"","nickname":"Geek_8593e5","note":"","ucode":"B316E40C400CC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549870,"discussion_content":"è¯·é—®å…·ä½“åœºæ™¯æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿå¤šèŠ‚ç‚¹éƒ¨ç½²å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644285342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2288362,"avatar":"https://static001.geekbang.org/account/avatar/00/22/ea/ea/77a59153.jpg","nickname":"è€¶é©¬","note":"","ucode":"3A3CF67B016CDB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547183,"discussion_content":"åˆ©ç”¨Disruptorå°†å¹¶å‘è¯·æ±‚ä¸²è¡ŒåŒ–ï¼ŒåŒæ—¶é¿å…äº†å¤šçº¿ç¨‹ç¼–ç¨‹å¤æ‚åº¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642572695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129150,"user_name":"xinglichea","can_delete":false,"product_type":"c1","uid":1176447,"ip_address":"","ucode":"986DA07BF3CA89","user_header":"https://static001.geekbang.org/account/avatar/00/11/f3/7f/2dd9409b.jpg","comment_is_top":false,"comment_ctime":1567050156,"is_pvip":false,"replies":[{"id":"48086","content":"æˆ‘è§‰å¾—ä»å®˜æ–¹æä¾›æ³¨è§£è¿™ä¸€è¡Œä¸ºæ¥çœ‹ï¼Œåº”è¯¥ä¸è‡³äºä¸é è°±ï¼Œä¸è¿‡javaç¨‹åºå‘˜éƒ½ä¹ æƒ¯äºä¸å…³æ³¨ç¡¬ä»¶ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1567074453,"ip_address":"","comment_id":129150,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18746919340","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ„Ÿè§‰å¡«å……çš„æ¨¡å¼ä¸æ˜¯å¾ˆé è°±ï¼Œç¨‹åºçš„å¥å£®æ€§è¦å¼ºä¾èµ–äºCPUçš„ç¼“å­˜è¡Œçš„å®ç°ï¼Œæ‰“ä¸ªæ¯”å¦‚ï¼Œå¦‚æœä»¥åCPUç¼“å­˜è¡Œå˜æˆäº†128ä¸ªå­—èŠ‚ï¼Œé‚£ä¼ä¸è¦å†™Disruptorçš„å®ç°æºç ï¼Œç„¶ååŸæ¥å®ç°çš„ä»£ç ä»ç„¶ä¼šæœ‰ä¼ªå…±äº«çš„é—®é¢˜ï¼ï¼ï¼","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465305,"discussion_content":"æˆ‘è§‰å¾—ä»å®˜æ–¹æä¾›æ³¨è§£è¿™ä¸€è¡Œä¸ºæ¥çœ‹ï¼Œåº”è¯¥ä¸è‡³äºä¸é è°±ï¼Œä¸è¿‡javaç¨‹åºå‘˜éƒ½ä¹ æƒ¯äºä¸å…³æ³¨ç¡¬ä»¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567074453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99458,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1559220671,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18739089855","product_id":100023901,"comment_content":"disruptoré«˜æ€§èƒ½ä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹è®¾è®¡ï¼š<br>1ï¼Œä»…ç»´æŠ¤ä¸€ä¸ªå…±äº«å˜é‡(å…¥é˜Ÿç´¢å¼•)ï¼Œå‡å°‘é”ç«äº‰ï¼Œå¹¶åˆ©ç”¨å¡«å……è¡ŒæŠ€æœ¯è§£å†³å…±äº«å˜é‡çš„ä¼ªå…±äº«é—®é¢˜ã€‚<br>2ï¼Œåº•å±‚ä½¿ç”¨å¾ªç¯æ•°ç»„ä½œä¸ºå­˜å‚¨ç»“æ„ï¼Œå¼€è¾Ÿä¸€ç»„è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå¾ªç¯åˆ©ç”¨å‡å°‘gcæ¬¡æ•°ï¼Œå¹¶å……åˆ†åˆ©ç”¨äº†ç¨‹åºå±€éƒ¨æ€§åŸç†ã€‚<br>3ï¼Œå…¥é˜Ÿæ—¶æ”¯æŒä¸€æ¬¡æ€§è·å–å¤šä¸ªç´¢å¼•ï¼Œç„¶ååœ¨å½“å‰çº¿ç¨‹å†™å…¥æ•°æ®ï¼Œå‡å°‘é”ç«äº‰ï¼Œæ¶ˆè´¹æ—¶ä¸€æ ·ã€‚<br>ä¸çŸ¥é“æˆ‘ç†è§£çš„å¯¹ä¸å¯¹ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1554995,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ba/33/2d83d174.jpg","nickname":"æ—¶å…‰å®ˆæŠ¤è€…-åŸºå…°","note":"","ucode":"F0B0887B1979D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373216,"discussion_content":"ç¯å½¢é˜Ÿåˆ—çš„ä¼˜åŠ¿ç›¸æ¯”éç¯å½¢é˜Ÿåˆ— æ•°æ®æ¬ç§»æ˜¯0(1)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620652933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248546,"user_name":"é‚£æœˆçœŸç¾","can_delete":false,"product_type":"c1","uid":1441895,"ip_address":"","ucode":"CEF1AF65C6064E","user_header":"https://static001.geekbang.org/account/avatar/00/16/00/67/e24dd940.jpg","comment_is_top":false,"comment_ctime":1600219708,"is_pvip":false,"replies":[{"id":"91343","content":"Disruptor å†…éƒ¨çš„ RingBuffer ä¹Ÿæ˜¯ç”¨æ•°ç»„å®ç°çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹åŒ–æ—¶æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºçš„ï¼Œæ‰€ä»¥è¿™äº›å…ƒç´ çš„å†…å­˜åœ°å€å¤§æ¦‚ç‡æ˜¯è¿ç»­çš„ã€‚ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºï¼Œå¤§æ¦‚ç‡äº‹å…³é”®è¯ã€‚å‚è€ƒæ–‡ä¸­LongEventçš„ä¾‹å­ï¼Œç”Ÿäº§ç”¨çš„æ˜¯setæ–¹æ³•ï¼Œè€Œä¸æ˜¯addæ–¹æ³•","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1600346737,"ip_address":"","comment_id":248546,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14485121596","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ•°ç»„å†…å­˜åœ°å€è¿ç»­ï¼Œæ•°ç»„é‡Œé¢çš„å¼•ç”¨å¯¹è±¡æ€ä¹ˆåšåˆ°è¿ç»­å‘¢ï¼Ÿå®ƒä¸æ˜¯ç”±ç”Ÿäº§è€…äº§ç”Ÿçš„å—ï¼Ÿä½•æ—¶ç”Ÿäº§åªèƒ½ç”±ç”Ÿäº§è€…å†³å®šï¼Œåˆå§‹åŒ–æ•°ç»„çš„æ—¶å€™æ€ä¹ˆä¸€æ¬¡æ€§åˆå§‹åŒ–æ•°ç»„å…ƒç´ å•Šï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505678,"discussion_content":"Disruptor å†…éƒ¨çš„ RingBuffer ä¹Ÿæ˜¯ç”¨æ•°ç»„å®ç°çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹åŒ–æ—¶æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºçš„ï¼Œæ‰€ä»¥è¿™äº›å…ƒç´ çš„å†…å­˜åœ°å€å¤§æ¦‚ç‡æ˜¯è¿ç»­çš„ã€‚ä¸€æ¬¡æ€§å…¨éƒ¨åˆ›å»ºï¼Œå¤§æ¦‚ç‡äº‹å…³é”®è¯ã€‚å‚è€ƒæ–‡ä¸­LongEventçš„ä¾‹å­ï¼Œç”Ÿäº§ç”¨çš„æ˜¯setæ–¹æ³•ï¼Œè€Œä¸æ˜¯addæ–¹æ³•","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600346737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99844,"user_name":"çˆ±åƒå›é”…è‚‰çš„ç˜¦å­","can_delete":false,"product_type":"c1","uid":1233867,"ip_address":"","ucode":"24DBDDC62B2276","user_header":"https://static001.geekbang.org/account/avatar/00/12/d3/cb/f8157ad8.jpg","comment_is_top":false,"comment_ctime":1559321005,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14444222893","product_id":100023901,"comment_content":"éš¾åº¦æŒ‡æ•°æå‡ğŸ˜”åªèƒ½å¾—å¤šçœ‹å‡ é","like_count":3},{"had_liked":false,"id":270729,"user_name":"å¼ æ´‹","can_delete":false,"product_type":"c1","uid":1182914,"ip_address":"","ucode":"549BE5DEEF8417","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/c2/bad34a50.jpg","comment_is_top":false,"comment_ctime":1609230473,"is_pvip":true,"replies":[{"id":"98268","content":"æ•°ç»„é‡Œæ‰€æœ‰çš„å¯¹è±¡çš„å¼•ç”¨ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œä½†æ˜¯å¯¹è±¡ä¸ä¸€å®šè¿ç»­","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1609303383,"ip_address":"","comment_id":270729,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10199165065","product_id":100023901,"comment_content":"1.if (wrapPoint&gt;cachedGatingSequence || cachedGatingSequence&gt;current) è¿™ç‚¹å¼€å§‹ä¸€ç›´æ²¡çœ‹æ‡‚ï¼Œä¹‹å‰å†™è¿‡ç¯å½¢é˜Ÿåˆ—ï¼Œæ¯æ¬¡ç´¢å¼•éƒ½ä¼šé‡ç½®ï¼Œå°±æ˜¯ä¸€ç›´åœ¨0-9ä¹‹é—´ï¼Œç„¶åçœ‹äº†ä¸‹RingBuffer å¥½åƒå®ƒçš„ç´¢å¼•æ˜¯ä¸€ç›´ç´¯åŠ çš„ã€‚è¿™æ ·å°±å¥½æ‡‚å¤šäº†ã€‚<br>2.å…³äºArrayBlockQueue æ·»åŠ çš„å¯¹è±¡æ˜¯ä¸è¿ç»­çš„è¿˜æ˜¯ä¸å¤ªæ˜ç™½ï¼Œæ•°ç»„åˆå§‹åŒ– ä¸æ˜¯åœ¨å†…å­˜ç§å¼€è¾Ÿå‡ºä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´å—ï¼Ÿ è¿˜æ˜¯æŒ‰ç…§æœ‰çš„åŒå­¦ç•™è¨€æ‰€è¯´çš„ï¼Œå¦‚æœæ˜¯å¼•ç”¨å¯¹è±¡ä¸ä¸€å®šæ˜¯è¿ç»­çš„ã€‚","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512733,"discussion_content":"æ•°ç»„é‡Œæ‰€æœ‰çš„å¯¹è±¡çš„å¼•ç”¨ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œä½†æ˜¯å¯¹è±¡ä¸ä¸€å®šè¿ç»­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609303383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125183,"user_name":"neohope","can_delete":false,"product_type":"c1","uid":1043475,"ip_address":"","ucode":"C0268F6E7E2B6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg","comment_is_top":false,"comment_ctime":1566113622,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10156048214","product_id":100023901,"comment_content":"æœ‰ä¸ªåœ°æ–¹æ²¡çœ‹æ‡‚ï¼Œif (wrapPoint&gt;cachedGatingSequence || cachedGatingSequence&gt;current)ï¼Œè¿™ä¸ªæ¡ä»¶é‡Œé¢ï¼Œä¸ºä½•éœ€è¦cachedGatingSequence&gt;currentè¿™ä¸ªé™åˆ¶å‘¢ï¼Ÿ<br>æ˜¯å½“currentçªç ´æœ€å¤§å€¼å˜ä¸º0ä¹‹åï¼Œè¦ç­‰åˆ°cachedGatingSequenceè¿½ä¸Šæ¥æ‰ç»§ç»­ç”Ÿäº§å—ï¼Ÿ","like_count":2},{"had_liked":false,"id":101037,"user_name":"éƒ‘æ™¨Cc","can_delete":false,"product_type":"c1","uid":1324942,"ip_address":"","ucode":"57146E444D6329","user_header":"https://static001.geekbang.org/account/avatar/00/14/37/8e/cf0b4575.jpg","comment_is_top":false,"comment_ctime":1559703926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10149638518","product_id":100023901,"comment_content":"å…¨ä»–å¦ˆçš„æ˜¯å¹²è´§ æ»¡è¶³ï¼","like_count":2},{"had_liked":false,"id":232641,"user_name":"junshuaizhang","can_delete":false,"product_type":"c1","uid":1101502,"ip_address":"","ucode":"5734A9BEA03149","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/be/5cf3f1a0.jpg","comment_is_top":false,"comment_ctime":1594077535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5889044831","product_id":100023901,"comment_content":"çœ‹åˆ°æœ€åï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±æ‹¿äº†ä¸€ä¸ªå‡å­¦å†","like_count":1},{"had_liked":false,"id":224113,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1063734,"ip_address":"","ucode":"EA31201A7C5AE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg","comment_is_top":false,"comment_ctime":1591277549,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5886244845","product_id":100023901,"comment_content":"å…³äºä¼ªå…±äº«ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <br>https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;109874","like_count":1},{"had_liked":false,"id":155711,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1574741130,"is_pvip":false,"replies":[{"id":"65945","content":"ç¼“å­˜å¯¼è‡´çš„å¯è§æ€§é—®é¢˜é çš„æ˜¯HBè§„åˆ™ï¼Œé”æ˜¯é HBè§„åˆ™è§£å†³ç¼“å­˜é—®é¢˜çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1578489098,"ip_address":"","comment_id":155711,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5869708426","product_id":100023901,"comment_content":"ArrayBlockingQueue çš„å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œæ˜¯ç”¨é”æ¥ä¿è¯äº’æ–¥çš„ï¼Œæ‰€ä»¥å…¥é˜Ÿå’Œå‡ºé˜Ÿä¸ä¼šåŒæ—¶å‘ç”Ÿã€‚å¦‚æœå…è®¸å…¥é˜Ÿå’Œå‡ºé˜ŸåŒæ—¶å‘ç”Ÿï¼Œé‚£å°±ä¼šå¯¼è‡´çº¿ç¨‹ A å’Œçº¿ç¨‹ B äº‰ç”¨åŒä¸€ä¸ªç¼“å­˜è¡Œï¼Œè¿™æ ·ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚<br><br>æƒ³é—®ä¸‹åŠ é”äº†å°±æ²¡æœ‰ç¼“å­˜å¹²æ‰°äº†å—ï¼ä¸ºå•¥ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475845,"discussion_content":"ç¼“å­˜å¯¼è‡´çš„å¯è§æ€§é—®é¢˜é çš„æ˜¯HBè§„åˆ™ï¼Œé”æ˜¯é HBè§„åˆ™è§£å†³ç¼“å­˜é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578489098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"è¥¿é—¨å¹ç‰›","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287273,"discussion_content":"åŠ é”ä¹‹åï¼Œå…¥é˜Ÿå‡ºé˜Ÿéƒ½ä¸²è¡ŒåŒ–äº†ã€‚åŒæ—¶æ ¹æ®HBè§„åˆ™ï¼Œè§£é”æ“ä½œHBåç»­åŒä¸€ä¸ªé”çš„åŠ é”æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè§£é”ä¼šå¼ºè¡Œåˆ·ç¼“å­˜ï¼Œæ‰€ä»¥æ²¡æœ‰ç¼“å­˜å¹²æ‰°çš„é—®é¢˜ï¼Œ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1593410394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100198,"user_name":"ç å†œKevinäº®","can_delete":false,"product_type":"c1","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1559476938,"is_pvip":false,"replies":[{"id":"36136","content":"å…±äº«ï¼ŒæŒ‡çš„æ˜¯å¤šä¸ªæ ¸èƒ½å…±äº«ç¼“å­˜ï¼Œé¿å…ä¼ªå…±äº«åï¼Œå¤šä¸ªæ ¸æ˜¯å¯ä»¥å…±äº«ç¼“å­˜çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559541937,"ip_address":"","comment_id":100198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5854444234","product_id":100023901,"comment_content":"è€å¸ˆï¼Œé¿å…ä¼ªå…±äº«çš„é€»è¾‘æœ‰ç‚¹å›°æƒ‘ï¼š<br>ä¼ªå…±äº«é€»è¾‘ä¸Šå°±æ˜¯æ²¡å®ç°å…±äº«ï¼Œè€Œdisruptorç”¨è¡Œå¡«å……ä¹Ÿæ˜¯æ²¡å®ç°å…±äº«ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆé¿å…ä¼ªå…±äº«å°±èƒ½æå‡æ€§èƒ½å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452445,"discussion_content":"å…±äº«ï¼ŒæŒ‡çš„æ˜¯å¤šä¸ªæ ¸èƒ½å…±äº«ç¼“å­˜ï¼Œé¿å…ä¼ªå…±äº«åï¼Œå¤šä¸ªæ ¸æ˜¯å¯ä»¥å…±äº«ç¼“å­˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559541937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99308,"user_name":"henry","can_delete":false,"product_type":"c1","uid":1075941,"ip_address":"","ucode":"0ACD12F363F8DE","user_header":"http://thirdqq.qlogo.cn/qqapp/101418266/D6DD8CB1004D442B48914656340277F3/100","comment_is_top":false,"comment_ctime":1559189419,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854156715","product_id":100023901,"comment_content":"æˆ‘ç”¨è¿‡apache stormï¼Œä¹‹å‰æƒ³äº†è§£åº•å±‚åŸç†ï¼Œåœ¨ç½‘ä¸ŠæŸ¥èµ„æ–™è¯´æ˜¯ç”¨åˆ°äº†disruptor, ç„¶åçœ‹åˆ°ç½‘ä¸Šçš„èµ„æ–™è¯´å®ƒå¿«çš„åŸå› å°±æ˜¯ç”¨åˆ°äº†ä¼ªå…±äº«ï¼Œä½†æ˜¯ç½‘ä¸Šéƒ½æ²¡æœ‰è¯´åˆ°ç‚¹ä¸Šï¼Œå°±æ˜¯æŠŠä¼ªå…±äº«çš„åŸç†è¯´äº†ä¸€éã€‚ã€‚ã€‚çœ‹çš„äº‘é‡Œé›¾é‡Œçš„ï¼Œçœ‹äº†è€å¸ˆçš„æ–‡ç« æ€»ç®—æ˜¯æ˜ç™½äº†ï¼Œä¸»è¦æ˜¯é’ˆå¯¹å…¥é˜Ÿå’Œå‡ºé˜Ÿç´¢å¼•ï¼Œè®©å®ƒä»¬åˆ†åˆ«ç‹¬å è¡Œï¼Œä¸å¤Ÿå­—èŠ‚æ•°çš„è¡¥å…¨","like_count":1},{"had_liked":false,"id":99186,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1559175998,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854143294","product_id":100023901,"comment_content":"æ‰“å¡ï¼","like_count":1},{"had_liked":false,"id":353434,"user_name":"Peter Yu","can_delete":false,"product_type":"c1","uid":1077598,"ip_address":"æµ™æ±Ÿ","ucode":"D56786A6E85321","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/5e/5393a76d.jpg","comment_is_top":false,"comment_ctime":1659434472,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1659434472","product_id":100023901,"comment_content":"è€å¸ˆå¥½ï¼Œdisruptorå½“é˜Ÿåˆ—æ»¡äº†ï¼Œç”Ÿäº§è€…å…¥é˜Ÿçš„æ—¶å€™æ˜¯ä¸æ˜¯é˜»å¡çš„ï¼Œæˆ‘çœ‹æ˜¯casä¸æ–­å¾ªç¯å°è¯•çš„ï¼Œè¿™ç§æƒ…å†µå¾ˆè€—cpuèµ„æºçš„å§","like_count":0},{"had_liked":false,"id":352642,"user_name":"å…¨éº¦å°é¢åŒ…","can_delete":false,"product_type":"c1","uid":1086413,"ip_address":"åŒ—äº¬","ucode":"823C65BF366097","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/cd/dbafc7d1.jpg","comment_is_top":false,"comment_ctime":1658828064,"is_pvip":false,"replies":[{"id":"130236","content":"æ²¡æœ‰è¿™ç§æœºåˆ¶","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1663649706,"ip_address":"åŒ—äº¬","comment_id":352642,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1658828064","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜å“ˆã€‚Disruptoråˆ›å»ºçš„eventä¸æ˜¯ä¸šåŠ¡æ•°æ®ç±»ï¼Œé‡Œé¢setçš„ä¸œè¥¿æ‰æ˜¯ä¸šåŠ¡éœ€è¦çš„ã€‚ä½†setå¯¹è±¡çš„åˆ›å»ºè¿˜æ˜¯ç¦»æ•£çš„ï¼Œéš¾é“setå¯¹è±¡çš„å¼•ç”¨ï¼Œèƒ½å’Œeventä¸€èµ·ç¼“å­˜ï¼Ÿï¼Ÿjavaæœ‰è¿™ç§æœºåˆ¶å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588283,"discussion_content":"æ²¡æœ‰è¿™ç§æœºåˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663649706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333313,"user_name":"Geek_8593e5","can_delete":false,"product_type":"c1","uid":1736807,"ip_address":"","ucode":"B316E40C400CC8","user_header":"","comment_is_top":false,"comment_ctime":1644285637,"is_pvip":false,"replies":[{"id":"123948","content":"é€‚ç”¨äºå¯¹é˜Ÿåˆ—æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä¸€èˆ¬æƒ…å†µä¸å»ºè®®ç”¨","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1269969","ctime":1647949666,"ip_address":"","comment_id":333313,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644285637","product_id":100023901,"comment_content":"è¯·é—®ä¸‹è€å¸ˆï¼Œè¿™ä¸ªé˜Ÿåˆ—å¯ä»¥ç”¨äºæ›¿æ¢ArrayBlockingQueueçš„åœºæ™¯å¯¹å§ï¼Ÿè¿˜æœ‰ä¸€äº›ä»€ä¹ˆåœºæ™¯å¯ä»¥ç”¨å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557744,"discussion_content":"é€‚ç”¨äºå¯¹é˜Ÿåˆ—æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä¸€èˆ¬æƒ…å†µä¸å»ºè®®ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647949666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307436,"user_name":"simple_å­™","can_delete":false,"product_type":"c1","uid":1873629,"ip_address":"","ucode":"A77203E242D652","user_header":"https://static001.geekbang.org/account/avatar/00/1c/96/dd/1620a744.jpg","comment_is_top":false,"comment_ctime":1629100823,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629100823","product_id":100023901,"comment_content":"long wrapPoint = next - bufferSize;<br>åº”è¯¥æ˜¯<br>long wrapPoint = next % bufferSize;<br>å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":292211,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1620721942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620721942","product_id":100023901,"comment_content":"ç¨‹åºçš„å±€éƒ¨æ€§åŸç†   è®¾è®¡æ€æƒ³æœ‰ç‚¹ç±»ä¼¼äºMysqlçš„é¢„è¯»æœºåˆ¶","like_count":0},{"had_liked":false,"id":279243,"user_name":"foggerwoody","can_delete":false,"product_type":"c1","uid":1582174,"ip_address":"","ucode":"DEF5829A10ABEA","user_header":"","comment_is_top":false,"comment_ctime":1613694147,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613694147","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆå…¥é˜Ÿæ“ä½œçš„æ—¶å€™åº”è¯¥éœ€è¦ä¸¤ä¸ªæ“ä½œï¼šset event å’Œ set å…¥é˜Ÿindexã€‚ æ–‡ä¸­ä»£ç ä¾‹å­set å…¥é˜Ÿindexç”¨çš„æ˜¯casï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯å…¶å’Œset eventçš„åŸå­æ€§å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":220375,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1008071,"ip_address":"","ucode":"9FE5F43055D3AB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/61/c7/b64ac05e.jpg","comment_is_top":false,"comment_ctime":1590229564,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1590229564","product_id":100023901,"comment_content":"æ ¹æ®ä»£ç :<br>current = cursor.get();<br>  &#47;&#47;ç›®æ ‡æ˜¯åœ¨ç”Ÿäº§nä¸ª<br>  next = current + n;<br>  &#47;&#47;å‡æ‰ä¸€ä¸ªå¾ªç¯<br>  long wrapPoint = next - bufferSize;<br>  &#47;&#47;è·å–ä¸Šä¸€æ¬¡çš„æœ€å°æ¶ˆè´¹ä½ç½®<br>  long cachedGatingSequence = gatingSequenceCache.get();<br><br>ç¯çŠ¶çš„è¯<br>wrapPoint&gt;cachedGatingSequence è®¤ä¸ºæ˜¯æ»¡äº† èƒ½ç†è§£<br><br>cachedGatingSequence&gt;current ä¸ºä»€ä¹ˆä¹Ÿæ˜¯æ»¡äº†? ä¸ç†è§£äº† , æœ€å°æ¶ˆè´¹ä½ç½® æ¯”å½“å‰å†™å…¥ä½ç½®å¤§,ä¸æ˜¯åº”è¯¥ ç¯çŠ¶ä¸­é—´æœ‰ç©ºéš™ æ˜¯å¯ä»¥å†™å…¥ä¹ˆ?","like_count":0,"discussions":[{"author":{"id":1736807,"avatar":"","nickname":"Geek_8593e5","note":"","ucode":"B316E40C400CC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549917,"discussion_content":"è¿™ä¸ªè¡¨ç¤ºæœ€å°æ¶ˆè´¹ä½ç½®è¶…è¿‡äº†ç”Ÿäº§è€…ç”Ÿäº§ä½ç½®ï¼Œè¦åœæ­¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644293332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209744,"user_name":"ä¾§è€³å€¾å¬","can_delete":false,"product_type":"c1","uid":1512642,"ip_address":"","ucode":"5BF2A2440B54F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","comment_is_top":false,"comment_ctime":1587607862,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587607862","product_id":100023901,"comment_content":"Disruptoræ˜¯ä¸æ˜¯é™å®šåŒä¸€æ—¶ç‚¹ï¼Œåªèƒ½æœ‰ä¸€ä¸ªç”Ÿäº§è€…å…¥é˜Ÿï¼Ÿå¤šä¸ªç”Ÿäº§è€…çš„åœºåˆï¼Œå…¥é˜Ÿçš„åŠ¨ä½œè¿˜éœ€è¦åŠ é”äº’æ–¥ï¼Œè¿™æ ·å­çš„è¯ï¼ŒDisruptorçš„æé™æ€§èƒ½åº”è¯¥æ˜¯åªæœ‰ä¸€ä¸ªç”Ÿäº§è€…","like_count":0},{"had_liked":false,"id":209729,"user_name":"ä¾§è€³å€¾å¬","can_delete":false,"product_type":"c1","uid":1512642,"ip_address":"","ucode":"5BF2A2440B54F0","user_header":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","comment_is_top":false,"comment_ctime":1587605813,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587605813","product_id":100023901,"comment_content":"ä¼ªå…±äº«å°±æ˜¯Cè¯­è¨€é‡Œä½å­—æ®µçš„å¯¹é½ç‰¹æ€§ï¼Œä¸è¿‡æ²¡è€ƒè™‘è¿‡ç”¨åœ¨javaè¯­è¨€é‡Œï¼Œå—æ•™äº†","like_count":0},{"had_liked":false,"id":205342,"user_name":"äºæ˜¯","can_delete":false,"product_type":"c1","uid":1186843,"ip_address":"","ucode":"6FB1BF6B692B0F","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/1b/dceaa378.jpg","comment_is_top":false,"comment_ctime":1586595587,"is_pvip":false,"replies":[{"id":"78697","content":"æ‹·è´åœ°å€å°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1588033778,"ip_address":"","comment_id":205342,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586595587","product_id":100023901,"comment_content":"disruptorä¸­çš„æ•°ç»„ç»“æ„ï¼Œå¦‚æœæˆ‘æ”¾å…¥ä¸€ä¸ªå¼•ç”¨å¯¹è±¡ï¼Œè¿™ä¸ªè¢«å¼•ç”¨å¯¹è±¡çš„å†…å­˜åœ°å€å·²ç»ç¡®å®šäº†ã€‚æ˜¯éœ€è¦æ‹·è´åˆ°ä»–åˆ›å»ºçš„é‚£æ®µè¿ç»­å†…å­˜ä¸­å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491452,"discussion_content":"æ‹·è´åœ°å€å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588033778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172917,"user_name":"kennyji","can_delete":false,"product_type":"c1","uid":1347446,"ip_address":"","ucode":"DAA1BCBCB9C169","user_header":"https://static001.geekbang.org/account/avatar/00/14/8f/76/1d8be696.jpg","comment_is_top":false,"comment_ctime":1579357749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579357749","product_id":100023901,"comment_content":"å¤ªèµäº†ï¼ï¼","like_count":0},{"had_liked":false,"id":155734,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1574746228,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574746228","product_id":100023901,"comment_content":"â€œArrayBlockingQueue çš„å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œæ˜¯ç”¨é”æ¥ä¿è¯äº’æ–¥çš„ï¼Œæ‰€ä»¥å…¥é˜Ÿå’Œå‡ºé˜Ÿä¸ä¼šåŒæ—¶å‘ç”Ÿã€‚å¦‚æœå…è®¸å…¥é˜Ÿå’Œå‡ºé˜ŸåŒæ—¶å‘ç”Ÿï¼Œé‚£å°±ä¼šå¯¼è‡´çº¿ç¨‹ A å’Œçº¿ç¨‹ B äº‰ç”¨åŒä¸€ä¸ªç¼“å­˜è¡Œï¼Œè¿™æ ·ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚æ‰€ä»¥ä¸ºäº†æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ï¼Œæˆ‘ä»¬å¿…é¡»é¿å…ä¼ªå…±äº«ï¼Œé‚£å¦‚ä½•é¿å…å‘¢ï¼Ÿâ€<br><br>JMMå…³äºsynchronizedçš„ä¸¤æ¡è§„å®šï¼š<br>ã€€ã€€1ï¼‰çº¿ç¨‹è§£é”å‰ï¼Œå¿…é¡»æŠŠå…±äº«å˜é‡çš„æœ€æ–°å€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­<br>ã€€ã€€2ï¼‰çº¿ç¨‹åŠ é”æ—¶ï¼Œå°†æ¸…ç©ºå·¥ä½œå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ï¼Œä»è€Œä½¿ç”¨å…±äº«å˜é‡æ—¶éœ€è¦ä»ä¸»å†…å­˜ä¸­é‡æ–°è·å–æœ€æ–°çš„å€¼<br><br>è¿™æ ·æ¥çœ‹ï¼Œç”±äº cpu è¯»å–æ•°æ®æ˜¯æŒ‰ç…§ç¼“å­˜è¡Œè¯»å–çš„ï¼Œé‚£ä¹ˆè™½ç„¶åŠ é”äº†ï¼Œä½†è¿˜æ˜¯ä¼šæŒ‰ç…§ç¼“å­˜è¡Œè¯»å–å•Šï¼Œå¦‚æœæˆ‘åŠ é”åè®¿é—®äº†å¤šä¸ªå˜é‡ï¼Œåé¢ä¾ç„¶ä¼šå…¨éƒ¨è¯»å–è¿›æ¥å§ã€‚<br><br>è¿™ç§æƒ…å†µä¸æ˜¯ä¹Ÿæ˜¯ä¼ªå…±äº«å˜›ï¼Ÿï¼Ÿä¾ç„¶æ˜¯æœ‰æ€§èƒ½é—®é¢˜çš„å§ã€‚ã€‚ã€‚<br><br>é‚£å¯¹äºåŠ é”çš„æƒ…å†µï¼Œä½¿ç”¨ç¼“å­˜è¡Œå¡«å……æ˜¯å¦ä¹Ÿå¯ä»¥ä¼˜åŒ–æ€§èƒ½å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":154423,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1574427275,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574427275","product_id":100023901,"comment_content":"ç¬¬ä¸€æ¬¡çŸ¥é“ä¼ªå…±äº«","like_count":0},{"had_liked":false,"id":119138,"user_name":"é’é“œ5 å‘¨ç¾¤åŠ›","can_delete":false,"product_type":"c1","uid":1111965,"ip_address":"","ucode":"EA80B442EC8A68","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/9d/c7295d17.jpg","comment_is_top":false,"comment_ctime":1564530743,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564530743","product_id":100023901,"comment_content":"å¯¹å†…å­˜ä¼˜åŒ–éƒ¨åˆ†æœ‰è´¨ç–‘:<br>1ç”³è¯·å†…å­˜è¦ç»è¿‡jvmï¼Œç»è¿‡æ“ä½œç³»ç»Ÿï¼Œç»è¿‡å±‚å±‚çš„ä¼˜åŒ–ã€å†…å­˜ç®¡ç†ï¼Œå¡«å……ç¼“å­˜è¡Œæœ‰æ²¡æœ‰ç”¨åªé é€»è¾‘æ¨ç†æ˜¯æ¨ç†ä¸å‡ºæ¥çš„å§ï¼Œæœ‰æ²¡æœ‰æ•°æ®è¯æ˜è¿™ä¸ªæŠ€æœ¯çœŸçš„æœ‰ç”¨?<br>2.é¢„å…ˆç”³è¯·æ‰€æœ‰å…ƒç´ å¯¹è±¡çœŸçš„æœ‰ç”¨å—ï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ å¼•ç”¨çš„æ•°æ®å¯¹è±¡è¿˜åœ¨ç¦»æ•£çš„å†…å­˜ç©ºé—´ï¼Œå–æ•°æ®å¯¹è±¡è¿˜è¦è®¿é—®å†…å­˜ï¼Œä¼šå‘ç”Ÿcache lineæ·˜æ±°ã€‚æ‰€ä»¥æœ‰ä»€ä¹ˆæ•°æ®èƒ½è¯æ˜è¿™ä¸ªæŠ€æœ¯æœ‰ç”¨å—","like_count":0},{"had_liked":false,"id":118753,"user_name":"å°äºˆ","can_delete":false,"product_type":"c1","uid":1442580,"ip_address":"","ucode":"3F5EAEE1746074","user_header":"https://static001.geekbang.org/account/avatar/00/16/03/14/e9ca2d09.jpg","comment_is_top":false,"comment_ctime":1564445447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564445447","product_id":100023901,"comment_content":"å…³äºç¬¬4ç‚¹ï¼Œæ‰¹é‡æ¶ˆè´¹ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡è¯»å–nä¸ªå…ƒç´ ï¼Œé‚£å¦å¤–ä¸€ä¸ªçº¿ç¨‹æƒ³è¦è¯»å–å…ƒç´ æ—¶ï¼Œå¿…é¡»ç­‰å‰ä¸€ä¸ªçº¿ç¨‹çš„nä¸ªå…ƒç´ è¯»å–å®Œï¼Œä¸æ˜ç™½è¿™æ ·ä¸ºä½•èƒ½æé«˜æ€§èƒ½ï¼Œå¸Œæœ›è€å¸ˆè§£ç­”ä¸‹","like_count":0},{"had_liked":false,"id":101981,"user_name":"ç©ºçŸ¥","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1560085639,"is_pvip":false,"replies":[{"id":"36775","content":"é€‚ç”¨ï¼Œåªæ˜¯é¿å…ä¸€ä¸ªç¼“å­˜è¡Œå†…äº’ç›¸å¹²æ‰°è€Œå·²","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1560127049,"ip_address":"","comment_id":101981,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560085639","product_id":100023901,"comment_content":"è€å¸ˆé—®ä¸‹ <br>ç¼“å­˜è¡Œå¡«å……ä¹‹åï¼Œç¼“å­˜è¡Œé‡ŒåŠ è½½çš„ä¸æ˜¯çœŸå®éœ€è¦çš„æ•°æ® æ˜¯å¡«å……æ•°æ®  ç¨‹åºå±€éƒ¨æ€§ä¼šä¸ä¼šä¸é€‚ç”¨äº†? ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453203,"discussion_content":"é€‚ç”¨ï¼Œåªæ˜¯é¿å…ä¸€ä¸ªç¼“å­˜è¡Œå†…äº’ç›¸å¹²æ‰°è€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560127049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101670,"user_name":"nico","can_delete":false,"product_type":"c1","uid":1209075,"ip_address":"","ucode":"DDB5EFE9F3A70E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Pr8laRQY3skrzzgen37ZIt4HQvtaThAcqvyK8eAzc9DRiak803q5HS7gCnXFxpx6CWibqT1Sic0h1TLMmVNUpJRibA/132","comment_is_top":false,"comment_ctime":1559908128,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559908128","product_id":100023901,"comment_content":"è€å¸ˆï¼Œé—®ä¸‹ï¼Œå¤šä¸ªç”Ÿäº§è€…åŒæ—¶ç”Ÿäº§æ—¶ï¼Œå¦‚æœå‰é¢ç”³è¯·æˆåŠŸä½†æ˜¯ç”Ÿäº§å¤±è´¥äº†ï¼Œåé¢çš„ç”Ÿäº§æˆåŠŸäº†ï¼Œä¸­é—´ç©ºå‡ºæ¥çš„ä½ç½®æ€ä¹ˆå¤„ç†ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":100345,"user_name":"åœ¨ä¸‹ä»¤ç‹å†²","can_delete":false,"product_type":"c1","uid":1178651,"ip_address":"","ucode":"6228893CCF8C09","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/1b/7fa5823c.jpg","comment_is_top":false,"comment_ctime":1559531773,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559531773","product_id":100023901,"comment_content":"ç¼“å­˜è¡Œå¡«å……å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œç®€å•æ˜äº†<br>http:&#47;&#47;ifeve.com&#47;disruptor-cacheline-padding&#47;","like_count":0},{"had_liked":false,"id":99500,"user_name":"é‡è§é˜³å…‰","can_delete":false,"product_type":"c1","uid":1203576,"ip_address":"","ucode":"378E5D37B3CD0E","user_header":"https://static001.geekbang.org/account/avatar/00/12/5d/78/f011d586.jpg","comment_is_top":false,"comment_ctime":1559230672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559230672","product_id":100023901,"comment_content":"LinkedBlockingQueueåœ¨æ’å…¥æˆ–è€…åˆ é™¤å¯¹è±¡æ—¶å€™ä¼šäº§ç”Ÿé¢å¤–çš„å¯¹è±¡Node  æ’å…¥æ—¶ä¼šåˆ›å»ºnodeå¯¹è±¡ï¼Œåˆ é™¤æ—¶å¦‚ä½•ç†è§£","like_count":0},{"had_liked":false,"id":99433,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1559212746,"is_pvip":false,"replies":[{"id":"35738","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559226644,"ip_address":"","comment_id":99433,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559212746","product_id":100023901,"comment_content":"å‰å®³äº†æˆ‘çš„å“¥ï¼Œå°½ç„¶çœ‹æ‡‚äº†ï¼Œåˆå­¦åˆ°äº†è°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452108,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559226644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99242,"user_name":"Rancood","can_delete":false,"product_type":"c1","uid":1204333,"ip_address":"","ucode":"052BDF2221F480","user_header":"https://static001.geekbang.org/account/avatar/00/12/60/6d/e2576fda.jpg","comment_is_top":false,"comment_ctime":1559181136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559181136","product_id":100023901,"comment_content":"å¡«å……æŠ€æœ¯ä»£ç æ²¡æœ‰çœ‹æ‡‚ï¼Œèƒ½å¦åœ¨å…·ä½“è§£é‡Šä¸€ä¸‹","like_count":0},{"had_liked":false,"id":99219,"user_name":"å‘¨æ²»æ…§","can_delete":false,"product_type":"c1","uid":1335293,"ip_address":"","ucode":"7D56C4E66BEE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","comment_is_top":false,"comment_ctime":1559178901,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559178901","product_id":100023901,"comment_content":"æ€æƒ³å¾ˆä¸é”™å€¼å¾—å­¦ä¹ ï¼Œä¸€æ¬¡æ€§ç¼“å­˜é˜²æ­¢ç¼“å­˜åŒä¸€è¡Œå¯¼è‡´å¤±æ•ˆç”¨å¡«å……æ–¹å¼æ¥å¼¥è¡¥ï¼Œcasçš„æ— é”æœºåˆ¶ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»","like_count":0},{"had_liked":false,"id":99217,"user_name":"è€æ¨åŒå¿—","can_delete":false,"product_type":"c1","uid":1246199,"ip_address":"","ucode":"3F334F0CFD3DE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg","comment_is_top":false,"comment_ctime":1559178869,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559178869","product_id":100023901,"comment_content":"å¯¹Disruptorçš„æ— é”å¹¶å‘ç®—æ³•è¿˜æ˜¯ä¸€çŸ¥åŠè§£ã€‚è€Œä¸”æ‹…å¿ƒcpuä½¿ç”¨ç‡ä¼šä¸ä¼šå¾ˆé«˜ï¼Œåƒè€å¸ˆä»£ç ä¸­LockSupport.parkNanos(1); ä¼‘æ¯å¾ˆå°‘çš„æ—¶é—´å°±å›æ¥é‡æ–°äº‰å–cpuï¼Œè€ŒDisruptorä¸­æœ‰ä¸ªç­–ç•¥ä¸­ä½¿ç”¨Thread.yield( )ï¼Œäº¤å‡ºcpuåé©¬ä¸Šå›æ¥äº‰å¤ºï¼Œè¿™æ ·ä¼šä¸ä¼šæ˜¯cpuä½¿ç”¨ç‡é£™å‡å‘¢","like_count":0,"discussions":[{"author":{"id":1736807,"avatar":"","nickname":"Geek_8593e5","note":"","ucode":"B316E40C400CC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549872,"discussion_content":"æ‰€ä»¥å®ƒæä¾›äº†å¥½å‡ ç§ç­‰å¾…ç­–ç•¥ï¼Œä¸»è¦çœ‹å…·ä½“åœºæ™¯æ˜¯è¿½æ±‚low latencyè¿˜æ˜¯ç¨³å®šæ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644285566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99191,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1559176520,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559176520","product_id":100023901,"comment_content":"é€šè¿‡åˆå§‹åŒ–æ•°ç»„çš„æ—¶å€™å°†æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ï¼Œè¿™ä¸ªæ„Ÿè§‰å¾ˆä¾èµ–äºjvmæˆ–è€…æ“ä½œç³»ç»Ÿçš„å†…å­˜åˆ†é…ç­–ç•¥å‘€ï¼Œè€Œä¸”å¯¹è±¡æ•°ç»„ä¸­ä¸ä¹Ÿæœ‰å¼•ç”¨å—ï¼Œæ‰€ä»¥å°±ç®—èƒ½ç¼“å­˜å‹å¥½ï¼Œé‚£ä¹Ÿæ˜¯ä¸€å±‚è€Œå·²ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥åœ¨å †ä¸­æä¸€å—åŒºåŸŸå°±ç›´æ¥å­˜è¿™äº›ä¸ªä¸œä¸œå‘¢ã€‚","like_count":0},{"had_liked":false,"id":99151,"user_name":"ææœªæ¥","can_delete":false,"product_type":"c1","uid":1034079,"ip_address":"","ucode":"4A339B35E3B419","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c7/5f/2028aae5.jpg","comment_is_top":false,"comment_ctime":1559171658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559171658","product_id":100023901,"comment_content":"ä»¥å‰åªçŸ¥é“ç¼“å­˜è¡Œçš„å¥½å¤„ï¼Œè¿™æ¬¡çŸ¥é“äº†ç¼“å­˜è¡Œå¯èƒ½çš„åå¤„ï¼Œå—æ•™äº†ï¼","like_count":0}]}