{"id":165252,"title":"03 | 认识文档数据库MongoDB","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":151074,"user_name":"远航的TJ 唐建法","can_delete":false,"product_type":"c3","uid":1260017,"ip_address":"","ucode":"0719807390250A","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","comment_is_top":true,"comment_ctime":1573650741,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"嗯嗯 和标准开源AGPL协议最大的差别就是 Mongo的SSPL不允许公有云厂商在云上卖MongoDB云服务。如果你不是公有云厂商 那么就不需要顾虑什么","like_count":14},{"had_liked":false,"id":174676,"user_name":"文武木子","can_delete":false,"product_type":"c3","uid":1015986,"ip_address":"","ucode":"348752BDECD65F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/80/b2/2e9f442d.jpg","comment_is_top":false,"comment_ctime":1580340374,"is_pvip":false,"replies":[{"id":67965,"content":"正解","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1580446091,"ip_address":"","comment_id":174676,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100040001,"comment_content":"Mongodb很适合作为游戏的数据存储仓库","like_count":6,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482484,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580446091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151933,"user_name":"旺旺","can_delete":false,"product_type":"c3","uid":1159196,"ip_address":"","ucode":"FE2CF90F446BFB","user_header":"https://static001.geekbang.org/account/avatar/00/11/b0/1c/2e30eeb8.jpg","comment_is_top":false,"comment_ctime":1573817570,"is_pvip":false,"replies":[{"id":58428,"content":"\b正解。这个只影响\b云厂商的MongoDB托管服务的部门。你自己\b在云上部署是不受SSPL限制的。\n\n阿里云已经获得商业授权所以他们接下来可以继续提供更新版本。其他云暂时就只能到4.0，正如你已经观察到的。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1573829971,"ip_address":"","comment_id":151933,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，SSPL协议是只对使用云厂商提供的MongoDB存储服务有要求，但是对于我们自己在云厂商主机上部署自己的MongoDB数据库是没有任何限制的，是吧？\n这可能也是阿里云、百度云等云厂商上提供的MongoDB数据库版本最多也是到MongoDB4.0的原因吧，按SSPL协议，最多也只能到MongoDB4.0DB，\n","like_count":5,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474661,"discussion_content":"\b正解。这个只影响\b云厂商的MongoDB托管服务的部门。你自己\b在云上部署是不受SSPL限制的。\n\n阿里云已经获得商业授权所以他们接下来可以继续提供更新版本。其他云暂时就只能到4.0，正如你已经观察到的。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573829971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226045,"user_name":"梦想","can_delete":false,"product_type":"c3","uid":1046939,"ip_address":"","ucode":"F1E8C08813F2E0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/9b/3d056492.jpg","comment_is_top":false,"comment_ctime":1591935267,"is_pvip":false,"replies":[{"id":88236,"content":"可以参考一下这里：\n\nhttps:&#47;&#47;docs.mongodb.com&#47;manual&#47;administration&#47;production-notes&#47;\n","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1596358897,"ip_address":"","comment_id":226045,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"Mongodb 操作系统优化这块 老师有没有推荐的参数","like_count":2,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498091,"discussion_content":"可以参考一下这里：\n\nhttps://docs.mongodb.com/manual/administration/production-notes/\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596358897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151478,"user_name":"码农Kevin亮","can_delete":false,"product_type":"c3","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1573728377,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"请问老师，ElasticSearch与mongoDB很像（个人认为），我在做一个大数据统计的项目选型时甚至很困惑到底要怎么算。老师可否给点参考意见呢","like_count":5,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50544,"discussion_content":"我在下一讲回复了，这里重复下：\n\nMongoDB是一个全功能的数据库，主要应用于增删改查类型的实时交互场景。有非常多的系统只用MongoDB作为唯一的后端数据库，但是你几乎找不出来一个应用是完全用Elastic作为后端的。\n\nElastic最强的是全文搜索场景，后面实现基于Lucene。它最大的问题就是索引更新有延迟，默认是一分钟。所以一般不能用来作为交互应用如手机端或者PC端应用。通常大家都是用一个DB+Elastic组合来使用。\n\nMongoDB的全文搜索功能虽然有，但是很多时候达不到业务要求。所以很多人也会用MongoDB + Elastic 的组合方式。\n\n简单来说，如果你的场景是只读，并且能够接受一定的数据延迟（非最新的数据），那么可以考虑Elastic。如果你的场景有实时写入实时更新，通常MongoDB会是更好的选择。","likes_number":17,"is_delete":false,"is_hidden":false,"ctime":1573733437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198917,"user_name":"Geek_1d08ab","can_delete":false,"product_type":"c3","uid":1935772,"ip_address":"","ucode":"C7B2E51823B4C4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKLHlVUXUnOXuYEC7sKZSBsUbeJUCBDqRxh8p3ymyJzl5Pu1ATibYiblicu5p9puxebKoOOagGTkicbmA/132","comment_is_top":false,"comment_ctime":1585473422,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"用的比较多的是oracle，mysql，对mongoDB 了解的太少了，学习！","like_count":3},{"had_liked":false,"id":151580,"user_name":"奕","can_delete":false,"product_type":"c3","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1573743643,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"MongoDB是一个基于json的数据库，文档模型灵活，很好横向扩展能力\n2.x版本加入聚合的操作\n3.x版本引入wiredtiger引擎\n4.x版本引入事务acid的支持","like_count":3},{"had_liked":false,"id":341462,"user_name":"汪彬英","can_delete":false,"product_type":"c3","uid":2436106,"ip_address":"","ucode":"6E8B21E39BFE6D","user_header":"https://static001.geekbang.org/account/avatar/00/25/2c/0a/61f4a0c3.jpg","comment_is_top":false,"comment_ctime":1649640354,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"打卡第一天","like_count":1},{"had_liked":false,"id":386829,"user_name":"半缘君","can_delete":false,"product_type":"c3","uid":1140265,"ip_address":"广东","ucode":"1266C4E35180A2","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/29/8b471f9d.jpg","comment_is_top":false,"comment_ctime":1705647110,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"访问mongodb集群，反复插入数据后访问会报错 incomplete read of message header: context deadline exceeded，是什么原因呢？https:&#47;&#47;stackoverflow.com&#47;questions&#47;72856947&#47;mongodb-insertmany-incomplete-read-of-message-header-context-deadline-exceed 网上说需要加上TLS认证，但是我是内网访问的，没有相关pem文件。","like_count":0},{"had_liked":false,"id":373836,"user_name":"流云","can_delete":false,"product_type":"c3","uid":1896868,"ip_address":"四川","ucode":"26C5A9166EC6D8","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f1/a4/79c36b87.jpg","comment_is_top":false,"comment_ctime":1683247864,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"好像wiredtiger之前还用过rocksdb当存储引擎","like_count":0},{"had_liked":false,"id":342783,"user_name":"tc","can_delete":false,"product_type":"c3","uid":1797318,"ip_address":"","ucode":"2C1D78B3ED7684","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6c/c6/a0aa0d95.jpg","comment_is_top":false,"comment_ctime":1650462093,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"老师你好！请问\ndb.user_msg_info.update({},{$pull:{infos:{msgId:{$in:[&quot;310c713244e548e5bd4793b5d82120d2&quot;,&quot;2302441b4db94322aac51f81f1bbd75d&quot;]}}}},{multi:true});\n在mongoOperations 中如何使用pusllAll 实现","like_count":0},{"had_liked":false,"id":154322,"user_name":"ls","can_delete":false,"product_type":"c3","uid":1001037,"ip_address":"","ucode":"C18E208B1DFDA7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/4d/161f3779.jpg","comment_is_top":false,"comment_ctime":1574409362,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":151474,"user_name":"少","can_delete":false,"product_type":"c3","uid":1744600,"ip_address":"","ucode":"943A00882ACBE6","user_header":"https://static001.geekbang.org/account/avatar/00/1a/9e/d8/49a2626e.jpg","comment_is_top":false,"comment_ctime":1573727217,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"好好学习天天向上ｸﾞｯ!(๑•̀ㅂ•́)و✧","like_count":0},{"had_liked":false,"id":151052,"user_name":"Cryhard","can_delete":false,"product_type":"c3","uid":1589593,"ip_address":"","ucode":"E0BF4548B502CB","user_header":"https://static001.geekbang.org/account/avatar/00/18/41/59/78042964.jpg","comment_is_top":false,"comment_ctime":1573647774,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"WT存储引擎确实值得大书特书，比起之前MMAP来说优势很大。使用协议的问题建议老师后面稍微多讲讲，说清楚与一般开源协议的区别，打消一般企业的顾虑。毕竟之前和各大云平台及Redhat等的“过节”，各类新闻的标题都对MongoDB不太有利。","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50549,"discussion_content":"MongoDB使用开源协议SSPL。 \n\nAGPL：一种主流开源协议。MySQL和MongoDB 4.0用的都是这个协议。\nSSPL：  AGPL 基础之上加了一个专门针对公有云厂商（如阿里云，腾讯云，亚马逊等）的特别条款。\n\n如果你是99.99999%的非公有云厂商用户，你可以像AGPL一样（MySQL一样）使用MongoDB\n如果你是0.00001%的公有云厂商用户，你不可以用SSPL协议的MongoDB在云里提供MongoDB托管服务。\n\n就这点差别","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1573733677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}