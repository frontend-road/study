{"id":228419,"title":"40 | Polly：熔断慢请求避免雪崩效应","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/NET-Core\">https://gitee.com/geektime-geekbang/NET-Core</a></p>","comments":[{"had_liked":false,"id":211405,"user_name":"🎾🎾🎾🎾🎾","can_delete":false,"product_type":"c3","uid":1886571,"ip_address":"","ucode":"9D427C36E794B1","user_header":"https://static001.geekbang.org/account/avatar/00/1c/c9/6b/eb80f089.jpg","comment_is_top":false,"comment_ctime":1587958959,"is_pvip":false,"replies":[{"id":79652,"content":"顺序是有关系的，后注册的执行在最内层，也就是最先起作用","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1588942686,"ip_address":"","comment_id":211405,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师, 组合策略里参数的先后和策略执行的顺序有关系吗？\n如下的例子:\nPolicy.WarpAsync(fallback, retry, breakPolicy);\nPolicy.WarpAsync(fallback, breakPolicy, retry);","like_count":3,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493268,"discussion_content":"顺序是有关系的，后注册的执行在最内层，也就是最先起作用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588942686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1803908,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/86/84/05a2bbb2.jpg","nickname":"凹凸曼","note":"","ucode":"1EE899822CEAA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":251958,"discussion_content":"应该是从右到左进行调用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588129749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220262,"user_name":"Moonus","can_delete":false,"product_type":"c3","uid":1813327,"ip_address":"","ucode":"F8261DA1E8DF2C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqia9gfbDeu8RqUlSozxmnzr6micGefNs5QGehBBl23xH6V82GxYwjgFgCKIA9n6iafFVKFoxVw5fHWw/132","comment_is_top":false,"comment_ctime":1590217443,"is_pvip":false,"replies":[{"id":81330,"content":"需要注意策略的顺序","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1590235359,"ip_address":"","comment_id":220262,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"熔断后，重试策略还有用吗？写了个测试demo，感觉重试就没有成功过。必须open、reset后才能继续请求。","like_count":2,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496104,"discussion_content":"需要注意策略的顺序","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590235359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214668,"user_name":"stg609","can_delete":false,"product_type":"c3","uid":1073025,"ip_address":"","ucode":"FB70A75A891BB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg","comment_is_top":false,"comment_ctime":1588778550,"is_pvip":false,"replies":[{"id":79637,"content":"可以的，不过要注意哪些策略的共享状态，例如熔断、限流的的情况。","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1588939364,"ip_address":"","comment_id":214668,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"多个httpclient可以使用同一套策略吗？","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494163,"discussion_content":"可以的，不过要注意哪些策略的共享状态，例如熔断、限流的的情况。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588939364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209890,"user_name":"小喵喵","can_delete":false,"product_type":"c3","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1587632549,"is_pvip":false,"replies":[{"id":80609,"content":"是的，策略有顺序，与中间件类似","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1589685451,"ip_address":"","comment_id":209890,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，要是熔断和重试同时满足，应该有一个优先级吧，就是先使用哪个后使用哪个？","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492890,"discussion_content":"是的，策略有顺序，与中间件类似","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589685451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":246062,"discussion_content":"根据策略，应该以最先达到的策略为准吧。像这种熔断和重试两种策略的组合策略，应该是熔断更能满足实际场景吧。毕竟都达到熔断级别了，重试也没多大意义了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587723448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344996,"user_name":"辣么大","can_delete":false,"product_type":"c3","uid":1396951,"ip_address":"","ucode":"AB308B6DCA0108","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","comment_is_top":false,"comment_ctime":1651918451,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"在生产中并发度和队列数是怎么确定的呢？有没有什么经验可以获得？","like_count":0}]}