{"id":264163,"title":"27 | 如何实现遗留系统的解耦拆分？","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-distributed\">https://gitee.com/geektime-geekbang/geektime-distributed</a></p>","comments":[{"had_liked":false,"id":245930,"user_name":"Neal","can_delete":false,"product_type":"c3","uid":1111680,"ip_address":"","ucode":"25F7926377EE1A","user_header":"https://static001.geekbang.org/account/avatar/00/10/f6/80/7dfdd3e3.jpg","comment_is_top":false,"comment_ctime":1599114389,"is_pvip":false,"replies":[{"id":90425,"content":"这个没有业务上下文的话，不太好要给建议。\n\n简单提几点：\n1. 先从业务入手，找到表的业务主人，尽量沟通梳理清楚业务和领域模型的关系。\n2. 复制冗余(也就是反正规化)，是拆分的一般思路。\n3. 渐进式拆分。先找一个要拆分出来的业务域(先找小的)，弄清楚这个业务域和表和其它表的依赖关系(包括你说的超级关联表)，先尝试拆这一个。把这个先搞定，再渐进拆第二、第三个。不要试图一下子全拆开。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1599141192,"ip_address":"","comment_id":245930,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"波波老师，首先感谢老师在微服务20讲里指导了拆分的思路，前后分离还算成功，服务也拆分差不多了，可是数据库始终拆不开，主要是表设计的问题，我们有一张超级中间表，它像一棵树的主干，其他的表都会和它关联，作为枝干，主要字段(parentObjectId, parentObjectClassId, objectId, objectClassId)，我知道在这里讨论业务的问题不太实际，目前我自己的思路是把主干的parentID冗余到枝干的表里，慢慢清除这个巨型中间表，服务和数据库改动都比较大，可否请老师分享一些数据库里主表与中间表拆分的思路。","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505012,"discussion_content":"这个没有业务上下文的话，不太好要给建议。\n\n简单提几点：\n1. 先从业务入手，找到表的业务主人，尽量沟通梳理清楚业务和领域模型的关系。\n2. 复制冗余(也就是反正规化)，是拆分的一般思路。\n3. 渐进式拆分。先找一个要拆分出来的业务域(先找小的)，弄清楚这个业务域和表和其它表的依赖关系(包括你说的超级关联表)，先尝试拆这一个。把这个先搞定，再渐进拆第二、第三个。不要试图一下子全拆开。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599141192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111680,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f6/80/7dfdd3e3.jpg","nickname":"Neal","note":"","ucode":"25F7926377EE1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303177,"discussion_content":"感谢老师，思路变得清晰了！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599179469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298809,"user_name":"独孤九剑","can_delete":false,"product_type":"c3","uid":2230909,"ip_address":"","ucode":"6C1253E2B8C1D4","user_header":"https://static001.geekbang.org/account/avatar/00/22/0a/7d/ac715471.jpg","comment_is_top":false,"comment_ctime":1624331170,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"难点在于“有状态的数据”，通常从“圈表”-&gt;“迁库”开始","like_count":0}]}