{"id":431450,"title":"21ï½œSpark UIï¼ˆä¸Šï¼‰ï¼šå¦‚ä½•é«˜æ•ˆåœ°å®šä½æ€§èƒ½é—®é¢˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å®Œæˆäº†åŸºç¡€çŸ¥è¯†å’ŒSpark SQLè¿™ä¸¤ä¸ªæ¨¡å—çš„å­¦ä¹ ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å®Œæˆäº†Sparkå…¥é—¨â€œä¸‰æ­¥èµ°â€ä¸­çš„å‰ä¸¤æ­¥ï¼Œé¦–å…ˆæ­å–œä½ ï¼åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€æ¸æ„è¯†åˆ°ï¼ŒSpark Coreä¸Spark SQLä½œä¸ºSparkå¹¶é©¾é½é©±çš„æ‰§è¡Œå¼•æ“ä¸ä¼˜åŒ–å¼•æ“ï¼Œæ‰¿è½½ç€æ‰€æœ‰ç±»å‹çš„è®¡ç®—è´Ÿè½½ï¼Œå¦‚æ‰¹å¤„ç†ã€æµè®¡ç®—ã€æ•°æ®åˆ†æã€æœºå™¨å­¦ä¹ ï¼Œç­‰ç­‰ã€‚</p><p>é‚£ä¹ˆæ˜¾ç„¶ï¼ŒSpark Coreä¸Spark SQLè¿è¡Œå¾—æ˜¯å¦ç¨³å®šä¸é«˜æ•ˆï¼Œå†³å®šç€Sparkä½œä¸šæˆ–æ˜¯åº”ç”¨çš„æ•´ä½“â€œå¥åº·çŠ¶å†µâ€ã€‚ä¸è¿‡ï¼Œåœ¨æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ€»ä¼šé‡åˆ°Sparkåº”ç”¨è¿è¡Œå¤±è´¥ã€æˆ–æ˜¯æ‰§è¡Œæ•ˆç‡æœªè¾¾é¢„æœŸçš„æƒ…å†µã€‚å¯¹äº\bè¿™ç±»é—®é¢˜ï¼Œæƒ³æ‰¾åˆ°æ ¹æœ¬åŸå› ï¼ˆRoot Causeï¼‰ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ä¾èµ–Spark UIæ¥è·å–æœ€ç›´æ¥ã€æœ€ç›´è§‚çš„çº¿ç´¢ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠå¤±è´¥çš„ã€æˆ–æ˜¯æ‰§è¡Œä½æ•ˆçš„Sparkåº”ç”¨çœ‹ä½œæ˜¯â€œç—…äººâ€çš„è¯ï¼Œé‚£ä¹ˆSpark UIä¸­å…³äºåº”ç”¨çš„ä¼—å¤šåº¦é‡æŒ‡æ ‡ï¼ˆMetricsï¼‰ï¼Œå°±æ˜¯è¿™ä¸ªç—…äººçš„â€œä½“æ£€æŠ¥å‘Šâ€ã€‚ç»“åˆå¤šæ ·çš„Metricsï¼Œèº«ä¸ºâ€œå¤§å¤«â€çš„å¼€å‘è€…å³å¯ç»“åˆç»éªŒæ¥è¿…é€Ÿåœ°å®šä½â€œç—…ç¶â€ã€‚</p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œè®©æˆ‘ä»¬ä»¥å°æ±½è½¦æ‘‡å·ä¸­â€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€çš„åº”ç”¨ï¼ˆè¯¦ç»†å†…å®¹ä½ å¯ä»¥å›é¡¾<a href=\"https://time.geekbang.org/column/article/374776\">ç¬¬13è®²</a>ï¼‰ä¸ºä¾‹ï¼Œç”¨å›¾è§£çš„æ–¹å¼ï¼Œä¸€æ­¥æ­¥åœ°å»è®¤è¯†Spark UIï¼Œçœ‹ä¸€çœ‹å®ƒæœ‰å“ªäº›å…³é”®çš„åº¦é‡æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡éƒ½æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Œåˆèƒ½ä¸ºå¼€å‘è€…æä¾›å“ªäº›æ´å¯Ÿï¼ˆInsightsï¼‰ï¼Ÿ</p><!-- [[[read_end]]] --><p>è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒSpark UIçš„è®²è§£æ¶‰åŠåˆ°å¤§é‡çš„å›¾è§£ã€ä»£ç ä¸æŒ‡æ ‡é‡Šä¹‰ï¼Œå†…å®¹åºæ‚ã€‚å› æ­¤ï¼Œä¸ºäº†å‡è½»ä½ çš„å­¦ä¹ è´Ÿæ‹…ï¼Œæˆ‘æŒ‰ç…§Spark UIçš„å…¥å£ç±»å‹ï¼ˆä¸€çº§å…¥å£ã€äºŒçº§å…¥å£ï¼‰æŠŠSpark UIæ‹†æˆäº†ä¸Šã€ä¸‹ä¸¤è®²ã€‚ä¸€çº§å…¥å£æ¯”è¾ƒç®€å•ã€ç›´æ¥ï¼Œæˆ‘ä»¬ä»Šå¤©è¿™ä¸€è®²ï¼Œå…ˆæ¥è®²è§£è¿™ä¸€éƒ¨åˆ†ï¼ŒäºŒçº§å…¥å£çš„è®²è§£ç•™åˆ°ä¸‹ä¸€è®²å»å±•å¼€ã€‚</p><h2>å‡†å¤‡å·¥ä½œ</h2><p>åœ¨æ­£å¼å¼€å§‹ä»‹ç»Spark UIä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº¤ä»£ä¸€ä¸‹å›¾è§£æ¡ˆä¾‹ç”¨åˆ°çš„ç¯å¢ƒã€é…ç½®ä¸ä»£ç ã€‚ä½ å¯ä»¥å‚è€ƒè¿™é‡Œç»™å‡ºçš„ç»†èŠ‚ï¼Œå»å¤ç°â€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€æ¡ˆä¾‹Spark UIä¸­çš„æ¯ä¸€ä¸ªç•Œé¢ï¼Œç„¶åå†ç»“åˆä»Šå¤©çš„è®²è§£ï¼Œä»¥â€œçœ‹å¾—è§ã€æ‘¸å¾—ç€â€çš„æ–¹å¼ï¼Œå»æ›´åŠ ç›´è§‚ã€æ·±å…¥åœ°ç†Ÿæ‚‰æ¯ä¸€ä¸ªé¡µé¢ä¸åº¦é‡æŒ‡æ ‡ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ æ‰‹å¤´ä¸€æ—¶æ²¡æœ‰åˆé€‚çš„æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿä¸è¦ç´§ã€‚å’±ä»¬è¿™ä¸€è®²çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯å›¾å¤šï¼Œåé¢æˆ‘ç‰¹æ„å‡†å¤‡äº†å¤§é‡çš„å›¾ç‰‡å’Œè¡¨æ ¼ï¼Œå¸¦ä½ å½»åº•äº†è§£Spark UIã€‚</p><p>ç”±äºå°æ±½è½¦æ‘‡å·æ•°æ®ä½“é‡ä¸å¤§ï¼Œå› æ­¤åœ¨è®¡ç®—èµ„æºæ–¹é¢ï¼Œæˆ‘ä»¬çš„è¦æ±‚å¹¶ä¸é«˜ï¼Œâ€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€æ¡ˆä¾‹ç”¨åˆ°çš„èµ„æºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/0b/2b/0b3635aa7eb123b387c507f6caf4b22b.jpg?wh=1491x737\" alt=\"å›¾ç‰‡\" title=\"ç¡¬ä»¶èµ„æº\"></p><p>æ¥ä¸‹æ¥æ˜¯ä»£ç ï¼Œåœ¨<a href=\"https://time.geekbang.org/column/article/424550\">å°æ±½è½¦æ‘‡å·åº”ç”¨å¼€å‘</a>é‚£ä¸€è®²ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥åœ°å®ç°äº†â€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€çš„è®¡ç®—é€»è¾‘ï¼Œè¿™é‡Œå’±ä»¬ä¸å¦¨ä¸€èµ·å›é¡¾ä¸€ä¸‹ã€‚</p><pre><code class=\"language-scala\">import org.apache.spark.sql.DataFrame\n \nval rootPath: String = _\n// ç”³è¯·è€…æ•°æ®\nval hdfs_path_apply: String = s\"${rootPath}/apply\"\n// sparkæ˜¯spark-shellä¸­é»˜è®¤çš„SparkSessionå®ä¾‹\n// é€šè¿‡read APIè¯»å–æºæ–‡ä»¶\nval applyNumbersDF: DataFrame = spark.read.parquet(hdfs_path_apply)\n \n// ä¸­ç­¾è€…æ•°æ®\nval hdfs_path_lucky: String = s\"${rootPath}/lucky\"\n// é€šè¿‡read APIè¯»å–æºæ–‡ä»¶\nval luckyDogsDF: DataFrame = spark.read.parquet(hdfs_path_lucky)\n \n// è¿‡æ»¤2016å¹´ä»¥åçš„ä¸­ç­¾æ•°æ®ï¼Œä¸”ä»…æŠ½å–ä¸­ç­¾å·ç carNumå­—æ®µ\nval filteredLuckyDogs: DataFrame = luckyDogsDF.filter(col(\"batchNum\") &gt;= \"201601\").select(\"carNum\")\n \n// æ‘‡å·æ•°æ®ä¸ä¸­ç­¾æ•°æ®åšå†…å…³è”ï¼ŒJoin Keyä¸ºä¸­ç­¾å·ç carNum\nval jointDF: DataFrame = applyNumbersDF.join(filteredLuckyDogs, Seq(\"carNum\"), \"inner\")\n \n// ä»¥batchNumã€carNumåšåˆ†ç»„ï¼Œç»Ÿè®¡å€ç‡ç³»æ•°\nval multipliers: DataFrame = jointDF.groupBy(col(\"batchNum\"),col(\"carNum\"))\n.agg(count(lit(1)).alias(\"multiplier\"))\n \n// ä»¥carNumåšåˆ†ç»„ï¼Œä¿ç•™æœ€å¤§çš„å€ç‡ç³»æ•°\nval uniqueMultipliers: DataFrame = multipliers.groupBy(\"carNum\")\n.agg(max(\"multiplier\").alias(\"multiplier\"))\n \n// ä»¥multiplierå€ç‡åšåˆ†ç»„ï¼Œç»Ÿè®¡äººæ•°\nval result: DataFrame = uniqueMultipliers.groupBy(\"multiplier\")\n.agg(count(lit(1)).alias(\"cnt\"))\n.orderBy(\"multiplier\")\n \nresult.collect\n</code></pre><p>ä»Šå¤©æˆ‘ä»¬åœ¨æ­¤åŸºç¡€ä¸Šåšä¸€ç‚¹å˜åŒ–ï¼Œä¸ºäº†æ–¹ä¾¿å±•ç¤ºStorageTabé¡µé¢å†…å®¹ï¼Œæˆ‘ä»¬è¿™é‡Œâ€œå¼ºè¡Œâ€ç»™applyNumbersDF å’ŒluckyDogsDFè¿™ä¸¤ä¸ªDataFrameéƒ½åŠ äº†Cacheã€‚å¯¹äºå¼•ç”¨æ•°é‡ä¸º1çš„æ•°æ®é›†ï¼Œå®é™…ä¸Šæ˜¯æ²¡æœ‰å¿…è¦åŠ Cacheçš„ï¼Œè¿™ä¸€ç‚¹è¿˜éœ€è¦ä½ æ³¨æ„ã€‚</p><p>å›é¡¾å®Œä»£ç ä¹‹åï¼Œå†æ¥çœ‹çœ‹é…ç½®é¡¹ã€‚ä¸ºäº†è®©Spark UIèƒ½å¤Ÿå±•ç¤ºè¿è¡Œä¸­ä»¥åŠæ‰§è¡Œå®Œæ¯•çš„åº”ç”¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®¾ç½®å¦‚ä¸‹é…ç½®é¡¹å¹¶å¯åŠ¨History Serverã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/09/e9/09d9a96316b00de7a5afe015a1444de9.jpg?wh=1889x741\" alt=\"å›¾ç‰‡\" title=\"Event logç›¸å…³é…ç½®é¡¹\"></p><pre><code class=\"language-scala\">// SPARK_HOMEè¡¨ç¤ºSparkå®‰è£…ç›®å½•\n${SPAK_HOME}/sbin/start-history-server.sh\n</code></pre><p>å¥½å•¦ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œä¸€åˆ‡å‡†å¤‡å°±ç»ªã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¯åŠ¨spark-shellï¼Œå¹¶æäº¤â€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€çš„ä»£ç ï¼Œç„¶åæŠŠç›®å…‰è½¬ç§»åˆ°Host1çš„8080ç«¯å£ï¼Œä¹Ÿå°±æ˜¯Driveræ‰€åœ¨èŠ‚ç‚¹çš„8080ç«¯å£ã€‚</p><h2>Spark UI ä¸€çº§å…¥å£</h2><p>ä»Šå¤©çš„æ•…äº‹ï¼Œè¦ä»Spark UIçš„å…¥å£å¼€å§‹ï¼Œå…¶å®åˆšæ‰è¯´çš„8080ç«¯å£æ­£æ˜¯Spark UIçš„å…¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œè¿›å…¥Spark UIã€‚</p><p>æ‰“å¼€Spark UIï¼Œé¦–å…ˆæ˜ å…¥çœ¼å¸˜çš„æ˜¯é»˜è®¤çš„Jobsé¡µé¢ã€‚Jobsé¡µé¢è®°å½•ç€åº”ç”¨ä¸­æ¶‰åŠçš„ActionsåŠ¨ä½œï¼Œä»¥åŠä¸æ•°æ®è¯»å–ã€ç§»åŠ¨æœ‰å…³çš„åŠ¨ä½œã€‚å…¶ä¸­ï¼Œæ¯ä¸€ä¸ªActionéƒ½å¯¹åº”ç€ä¸€ä¸ªJobï¼Œè€Œæ¯ä¸€ä¸ªJobéƒ½å¯¹åº”ç€ä¸€ä¸ªä½œä¸šã€‚æˆ‘ä»¬ä¸€ä¼šå†å»å¯¹Jobsé¡µé¢åšå±•å¼€ï¼Œç°åœ¨å…ˆæŠŠç›®å…‰é›†ä¸­åœ¨Spark UIæœ€ä¸Šé¢çš„å¯¼èˆªæ¡ï¼Œè¿™é‡Œç½—åˆ—ç€Spark UIæ‰€æœ‰çš„ä¸€çº§å…¥å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/d2/56563537c4e0ef597629d42618df21d2.png?wh=718x52\" alt=\"å›¾ç‰‡\" title=\"Spark UIå¯¼èˆªæ¡ï¼šä¸€çº§å…¥å£\"></p><p>å¯¼èˆªæ¡æœ€å·¦ä¾§æ˜¯Spark Logoä»¥åŠç‰ˆæœ¬å·ï¼Œåé¢åˆ™ä¾æ¬¡ç½—åˆ—ç€6ä¸ªä¸€çº§å…¥å£ï¼Œæ¯ä¸ªå…¥å£çš„åŠŸèƒ½ä¸ä½œç”¨æˆ‘æ•´ç†åˆ°äº†å¦‚ä¸‹çš„è¡¨æ ¼ä¸­ï¼Œä½ å¯ä»¥å…ˆæ•´ä½“è¿‡ä¸€ä¸‹ï¼Œåé¢æˆ‘ä»¬å†æŒ¨ä¸ªç»†è®²ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/yy/69/yy40a1yy06a4237dc691e197fa737569.jpg?wh=1920x811\" alt=\"å›¾ç‰‡\" title=\"ä¸€çº§å…¥å£ç®€ä»‹\"></p><p>å½¢è±¡ç‚¹è¯´ï¼Œè¿™6ä¸ªä¸åŒçš„å…¥å£ï¼Œå°±åƒæ˜¯ä½“æ£€æŠ¥å‘Šä¸­6å¤§ç±»ä¸åŒçš„ä½“æ£€é¡¹ï¼Œæ¯”å¦‚å†…ç§‘ã€å¤–ç§‘ã€è¡€å¸¸è§„ï¼Œç­‰ç­‰ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¾æ¬¡ç¿»å¼€â€œä½“æ£€æŠ¥å‘Šâ€çš„æ¯ä¸€ä¸ªå¤§é¡¹ï¼Œå»çœ‹çœ‹â€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€è¿™ä¸ªå®¶ä¼™çš„ä½“è´¨å¦‚ä½•ã€‚</p><p>ä¸è¿‡ï¼Œæœ¬ç€ç”±ç®€å…¥éš¾çš„åŸåˆ™ï¼Œå’±ä»¬å¹¶ä¸ä¼šæŒ‰ç…§Spark UIç½—åˆ—çš„é¡ºåºå»æŸ¥çœ‹å„ä¸ªå…¥å£ï¼Œè€Œæ˜¯æŒ‰ç…§Executors &gt; Environment &gt; Storage &gt; SQL &gt; Jobs &gt; Stagesçš„é¡ºåºï¼Œå»ç¿»çœ‹â€œä½“æ£€æŠ¥å‘Šâ€ã€‚</p><p>å…¶ä¸­ï¼Œå‰3ä¸ªå…¥å£éƒ½æ˜¯è¯¦æƒ…é¡µï¼Œä¸å­˜åœ¨äºŒçº§å…¥å£ï¼›è€Œå3ä¸ªå…¥å£éƒ½æ˜¯é¢„è§ˆé¡µï¼Œéƒ½éœ€è¦è®¿é—®äºŒçº§å…¥å£ï¼Œæ‰èƒ½è·å–æ›´åŠ è¯¦ç»†çš„å†…å®¹ã€‚æ˜¾ç„¶ï¼Œç›¸æ¯”é¢„è§ˆé¡µï¼Œè¯¦æƒ…é¡µæ¥å¾—æ›´åŠ ç›´æ¥ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä»Executorså¼€å§‹ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹åº”ç”¨çš„è®¡ç®—è´Ÿè½½ã€‚</p><h4><strong>Executors</strong></h4><p>Executors Tabçš„ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼Œä¸»è¦åŒ…å«â€œSummaryâ€å’Œâ€œExecutorsâ€ä¸¤éƒ¨åˆ†ã€‚è¿™ä¸¤éƒ¨åˆ†æ‰€è®°å½•çš„åº¦é‡æŒ‡æ ‡æ˜¯ä¸€è‡´çš„ï¼Œå…¶ä¸­â€œExecutorsâ€ä»¥æ›´ç»†çš„ç²’åº¦è®°å½•ç€æ¯ä¸€ä¸ªExecutorçš„è¯¦æƒ…ï¼Œè€Œç¬¬ä¸€éƒ¨åˆ†â€œSummaryâ€æ˜¯ä¸‹é¢æ‰€æœ‰Executorsåº¦é‡æŒ‡æ ‡çš„ç®€å•åŠ å’Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/05/7a/05769aed159ab5a49e336451a9c5ed7a.png?wh=1920x807\" alt=\"å›¾ç‰‡\" title=\"Executorsè¯¦æƒ…é¡µ\"></p><p>æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ï¼ŒSpark UIéƒ½æä¾›äº†å“ªäº›Metricsï¼Œæ¥é‡åŒ–æ¯ä¸€ä¸ªExecutorçš„å·¥ä½œè´Ÿè½½ï¼ˆWorkloadï¼‰ã€‚ä¸ºäº†å™è¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¥è¡¨æ ¼çš„å½¢å¼è¯´æ˜è¿™äº›Metricsçš„å«ä¹‰ä¸ä½œç”¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f7/c8/f7373c0616470bde9eb282eefb64a2c8.jpg?wh=1920x1126\" alt=\"å›¾ç‰‡\" title=\"Executor Metrics\"></p><p>ä¸éš¾å‘ç°ï¼ŒExecutorsé¡µé¢æ¸…æ¸…æ¥šæ¥šåœ°è®°å½•ç€æ¯ä¸€ä¸ªExecutoræ¶ˆè€—çš„æ•°æ®é‡ï¼Œä»¥åŠå®ƒä»¬å¯¹CPUã€å†…å­˜ä¸ç£ç›˜ç­‰ç¡¬ä»¶èµ„æºçš„æ¶ˆè€—ã€‚åŸºäºè¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åˆ¤æ–­ä¸åŒExecutorsä¹‹é—´æ˜¯å¦å­˜åœ¨è´Ÿè½½ä¸å‡è¡¡çš„æƒ…å†µï¼Œè¿›è€Œåˆ¤æ–­åº”ç”¨ä¸­æ˜¯å¦å­˜åœ¨æ•°æ®å€¾æ–œçš„éšæ‚£ã€‚</p><p>å¯¹äºExecutorsé¡µé¢ä¸­æ¯ä¸€ä¸ªMetricsçš„å…·ä½“æ•°å€¼ï¼Œå®ƒä»¬å®é™…ä¸Šæ˜¯Tasksæ‰§è¡ŒæŒ‡æ ‡åœ¨Executorsç²’åº¦ä¸Šçš„æ±‡æ€»ã€‚å› æ­¤ï¼Œå¯¹äºè¿™äº›Metricsçš„é‡Šä¹‰ï¼Œå’±ä»¬ç•™åˆ°StagesäºŒçº§å…¥å£å†å»å±•å¼€ï¼Œè¿™é‡Œæš‚æ—¶ä¸åšä¸€ä¸€æ·±å…¥ã€‚ä½ ä¸å¦¨ç»“åˆâ€œå€ç‡ä¸ä¸­ç­¾ç‡åˆ†æâ€çš„åº”ç”¨ï¼Œå»æµè§ˆä¸€ä¸‹ä¸åŒMetricsçš„å…·ä½“æ•°å€¼ï¼Œå…ˆå¯¹è¿™äº›æ•°å­—æœ‰ä¸€ä¸ªç›´è§‚ä¸Šçš„æ„Ÿå—ã€‚</p><p>å®é™…ä¸Šï¼Œè¿™äº›å…·ä½“çš„æ•°å€¼ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œé™¤äº†RDD Blockså’ŒComplete Tasksè¿™ä¸¤ä¸ªMetricsã€‚ç»†çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªæŒ‡æ ‡ï¼Œä½ ä¼šå‘ç°ï¼ŒRDD Blocksæ˜¯51ï¼ˆæ€»æ•°ï¼‰ï¼Œè€ŒComplete Tasksï¼ˆæ€»æ•°ï¼‰æ˜¯862ã€‚</p><p>ä¹‹å‰è®²RDDå¹¶è¡Œåº¦çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯´è¿‡ï¼ŒRDDå¹¶è¡Œåº¦å°±æ˜¯RDDçš„åˆ†åŒºæ•°é‡ï¼Œæ¯ä¸ªåˆ†åŒºå¯¹åº”ç€ä¸€ä¸ªTaskï¼Œå› æ­¤RDDå¹¶è¡Œåº¦ä¸åˆ†åŒºæ•°é‡ã€åˆ†å¸ƒå¼ä»»åŠ¡æ•°é‡æ˜¯ä¸€è‡´çš„ã€‚å¯æ˜¯ï¼Œæˆªå›¾ä¸­çš„51ä¸862ï¼Œ<strong>æ˜¾ç„¶ä¸åœ¨ä¸€ä¸ªé‡çº§</strong>ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘å…ˆä¹°ä¸ªå…³å­ï¼ŒæŠŠå®ƒç»™ä½ ç•™ä½œæ€è€ƒé¢˜ï¼Œä½ ä¸å¦¨èŠ±äº›æ—¶é—´ï¼Œå»å¥½å¥½æƒ³ä¸€æƒ³ã€‚å¦‚æœæ²¡æƒ³æ¸…æ¥šä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä»¬åœ¨è¯„è®ºåŒºä¼šç»§ç»­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p><h4>Environment</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´Environmentã€‚é¡¾åæ€ä¹‰ï¼ŒEnvironmenté¡µé¢è®°å½•çš„æ˜¯å„ç§å„æ ·çš„ç¯å¢ƒå˜é‡ä¸é…ç½®é¡¹ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/83/79/83byy2288931250e79354dec06cyy079.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Environmentè¯¦æƒ…é¡µ\"></p><p>ä¸ºäº†è®©ä½ æŠ“ä½ä¸»çº¿ï¼Œæˆ‘å¹¶æ²¡æœ‰ç»™ä½ å±•ç¤ºEnvironmenté¡µé¢æ‰€åŒ…å«çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå°±ç±»åˆ«æ¥è¯´ï¼Œå®ƒåŒ…å«5å¤§ç±»ç¯å¢ƒä¿¡æ¯ï¼Œä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘æŠŠå®ƒä»¬ç½—åˆ—åˆ°äº†ä¸‹é¢çš„è¡¨æ ¼ä¸­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/4f/c9596275686485e8a9200b91403b584f.jpg?wh=1699x757\" alt=\"å›¾ç‰‡\" title=\"Environment Metrics\"></p><p>æ˜¾ç„¶ï¼Œè¿™5ç±»ä¿¡æ¯ä¸­ï¼ŒSpark Propertiesæ˜¯é‡ç‚¹ï¼Œå…¶ä¸­è®°å½•ç€æ‰€æœ‰åœ¨è¿è¡Œæ—¶ç”Ÿæ•ˆçš„Sparké…ç½®é¡¹è®¾ç½®ã€‚é€šè¿‡Spark Propertiesï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤è¿è¡Œæ—¶çš„è®¾ç½®ï¼Œä¸æˆ‘ä»¬é¢„æœŸçš„è®¾ç½®æ˜¯å¦ä¸€è‡´ï¼Œä»è€Œæ’é™¤å› é…ç½®é¡¹è®¾ç½®é”™è¯¯è€Œå¯¼è‡´çš„ç¨³å®šæ€§æˆ–æ˜¯æ€§èƒ½é—®é¢˜ã€‚</p><h4>Storage</h4><p>è¯´å®ŒExecutorsä¸Environmentï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çº§å…¥å£çš„æœ€åä¸€ä¸ªè¯¦æƒ…é¡µï¼šStorageã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ff/5b/ff84db596c0c988422e3dfa86a3b865b.png?wh=1920x485\" alt=\"å›¾ç‰‡\" title=\"Storageè¯¦æƒ…é¡µ\"></p><p>Storageè¯¦æƒ…é¡µï¼Œè®°å½•ç€æ¯ä¸€ä¸ªåˆ†å¸ƒå¼ç¼“å­˜ï¼ˆRDD Cacheã€DataFrame Cacheï¼‰çš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬ç¼“å­˜çº§åˆ«ã€å·²ç¼“å­˜çš„åˆ†åŒºæ•°ã€ç¼“å­˜æ¯”ä¾‹ã€å†…å­˜å¤§å°ä¸ç£ç›˜å¤§å°ã€‚</p><p>åœ¨<a href=\"https://time.geekbang.org/column/article/422400\">ç¬¬8è®²</a>ï¼Œæˆ‘ä»¬ä»‹ç»è¿‡Sparkæ”¯æŒçš„ä¸åŒç¼“å­˜çº§åˆ«ï¼Œå®ƒæ˜¯å­˜å‚¨ä»‹è´¨ï¼ˆå†…å­˜ã€ç£ç›˜ï¼‰ã€å­˜å‚¨å½¢å¼ï¼ˆå¯¹è±¡ã€åºåˆ—åŒ–å­—èŠ‚ï¼‰ä¸å‰¯æœ¬æ•°é‡çš„æ’åˆ—ç»„åˆã€‚å¯¹äºDataFrameæ¥è¯´ï¼Œé»˜è®¤çš„çº§åˆ«æ˜¯å•å‰¯æœ¬çš„Disk Memory Deserializedï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨ä»‹è´¨ä¸ºå†…å­˜åŠ ç£ç›˜ï¼Œå­˜å‚¨å½¢å¼ä¸ºå¯¹è±¡çš„å•ä¸€å‰¯æœ¬å­˜å‚¨æ–¹å¼ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/cd/18/cd982cc408b3cdcef01018ab7e565718.jpg?wh=1920x570\" alt=\"å›¾ç‰‡\" title=\"Storage Metrics\"></p><p>Cached Partitionsä¸Fraction Cachedåˆ†åˆ«è®°å½•ç€æ•°æ®é›†æˆåŠŸç¼“å­˜çš„åˆ†åŒºæ•°é‡ï¼Œä»¥åŠè¿™äº›ç¼“å­˜çš„åˆ†åŒºå æ‰€æœ‰åˆ†åŒºçš„æ¯”ä¾‹ã€‚å½“Fraction Cachedå°äº100%çš„æ—¶å€™ï¼Œè¯´æ˜åˆ†å¸ƒå¼æ•°æ®é›†å¹¶æ²¡æœ‰å®Œå…¨ç¼“å­˜åˆ°å†…å­˜ï¼ˆæˆ–æ˜¯ç£ç›˜ï¼‰ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬è¦è­¦æƒ•ç¼“å­˜æ¢å…¥æ¢å‡ºå¯èƒ½ä¼šå¸¦æ¥çš„æ€§èƒ½éšæ‚£ã€‚</p><p>åé¢çš„Size in Memoryä¸Size in Diskï¼Œåˆ™æ›´åŠ ç›´è§‚åœ°å±•ç¤ºäº†æ•°æ®é›†ç¼“å­˜åœ¨å†…å­˜ä¸ç¡¬ç›˜ä¸­çš„åˆ†å¸ƒã€‚ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç”±äºå†…å­˜å—é™ï¼ˆ3GB/Executorï¼‰ï¼Œæ‘‡å·æ•°æ®å‡ ä¹å…¨éƒ¨è¢«ç¼“å­˜åˆ°äº†ç£ç›˜ï¼Œåªæœ‰584MBçš„æ•°æ®ï¼Œç¼“å­˜åˆ°äº†å†…å­˜ä¸­ã€‚å¦ç™½åœ°è¯´ï¼Œè¿™æ ·çš„ç¼“å­˜ï¼Œå¯¹äºæ•°æ®é›†çš„é‡å¤è®¿é—®ï¼Œå¹¶æ²¡æœ‰å¸¦æ¥å®è´¨ä¸Šçš„æ€§èƒ½æ”¶ç›Šã€‚</p><p>åŸºäºStorageé¡µé¢æä¾›çš„è¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰çš„æ”¾çŸ¢åœ°è®¾ç½®ä¸å†…å­˜æœ‰å…³çš„é…ç½®é¡¹ï¼Œå¦‚spark.executor.memoryã€spark.memory.fractionã€spark.memory.storageFractionï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§å¯¹Storage Memoryè¿›è¡Œè°ƒæ•´ã€‚</p><h4>SQL</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­è¯´ä¸€çº§å…¥å£çš„SQLé¡µé¢ã€‚å½“æˆ‘ä»¬çš„åº”ç”¨åŒ…å«DataFrameã€Datasetæˆ–æ˜¯SQLçš„æ—¶å€™ï¼ŒSpark UIçš„SQLé¡µé¢ï¼Œå°±ä¼šå±•ç¤ºç›¸åº”çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/dd/cb/dd3231ca21492ff00c63a111d96516cb.png?wh=1920x613\" alt=\"å›¾ç‰‡\" title=\"SQLæ¦‚è§ˆé¡µ\"></p><p>å…·ä½“æ¥è¯´ï¼Œä¸€çº§å…¥å£é¡µé¢ï¼Œä»¥Actionsä¸ºå•ä½ï¼Œè®°å½•ç€æ¯ä¸ªActionå¯¹åº”çš„Spark SQLæ‰§è¡Œè®¡åˆ’ã€‚æˆ‘ä»¬éœ€è¦ç‚¹å‡»â€œDescriptionâ€åˆ—ä¸­çš„è¶…é“¾æ¥ï¼Œæ‰èƒ½è¿›å…¥åˆ°äºŒçº§é¡µé¢ï¼Œå»äº†è§£æ¯ä¸ªæ‰§è¡Œè®¡åˆ’çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€è®²çš„äºŒçº§å…¥å£è¯¦æƒ…é¡µå†å»å±•å¼€ã€‚</p><h4>Jobs</h4><p>åŒç†ï¼Œå¯¹äºJobsé¡µé¢æ¥è¯´ï¼ŒSpark UIä¹Ÿæ˜¯ä»¥Actionsä¸ºç²’åº¦ï¼Œè®°å½•ç€æ¯ä¸ªActionå¯¹åº”ä½œä¸šçš„æ‰§è¡Œæƒ…å†µã€‚æˆ‘ä»¬æƒ³è¦äº†è§£ä½œä¸šè¯¦æƒ…ï¼Œä¹Ÿå¿…é¡»é€šè¿‡â€œDescriptionâ€é¡µé¢æä¾›çš„äºŒçº§å…¥å£é“¾æ¥ã€‚ä½ å…ˆæœ‰ä¸ªåˆæ­¥è®¤è¯†å°±å¥½ï¼Œä¸‹ä¸€è®²æˆ‘ä»¬å†å»å±•å¼€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/84/4b/84b6f0188d39c7e268e1b5f68224144b.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Jobsæ¦‚è§ˆé¡µ\"></p><p>ç›¸æ¯”SQLé¡µé¢çš„3ä¸ªActionsï¼šsaveï¼ˆä¿å­˜è®¡ç®—ç»“æœï¼‰ã€countï¼ˆç»Ÿè®¡ç”³è¯·ç¼–å·ï¼‰ã€countï¼ˆç»Ÿè®¡ä¸­ç­¾ç¼–å·ï¼‰ï¼Œç»“åˆå‰é¢çš„æ¦‚è§ˆé¡µæˆªå›¾ä½ ä¼šå‘ç°ï¼ŒJobsé¡µé¢ä¼¼ä¹å‡­ç©ºå¤šå‡ºæ¥å¾ˆå¤šActionsã€‚</p><p>ä¸»è¦åŸå› åœ¨äºï¼Œåœ¨Jobsé¡µé¢ï¼ŒSpark UIä¼šæŠŠæ•°æ®çš„è¯»å–ã€è®¿é—®ä¸ç§»åŠ¨ï¼Œä¹Ÿçœ‹ä½œæ˜¯ä¸€ç±»â€œActionsâ€ï¼Œæ¯”å¦‚å›¾ä¸­Job Idä¸º0ã€1ã€3ã€4çš„é‚£äº›ã€‚è¿™å‡ ä¸ªJobï¼Œå®é™…ä¸Šéƒ½æ˜¯åœ¨è¯»å–æºæ•°æ®ï¼ˆå…ƒæ•°æ®ä¸æ•°æ®é›†æœ¬èº«ï¼‰ã€‚</p><p>è‡³äºæœ€åå¤šå‡ºæ¥çš„ã€Job Idä¸º7çš„saveï¼Œä½ ä¸å¦¨ç»“åˆæœ€åä¸€è¡Œä»£ç ï¼Œå»æƒ³æƒ³é—®ä»€ä¹ˆã€‚è¿™é‡Œæˆ‘è¿˜æ˜¯æš‚æ—¶å–ä¸ªå…³å­ï¼Œç•™ç»™ä½ è¶³å¤Ÿçš„æ—¶é—´å»æ€è€ƒï¼Œå’±ä»¬è¯„è®ºåŒºè§ã€‚</p><pre><code class=\"language-scala\">result05_01.write.mode(\"Overwrite\").format(\"csv\").save(s\"${rootPath}/results/result05_01\")\n</code></pre><h4>Stages</h4><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸€ä¸ªä½œä¸šï¼Œéƒ½åŒ…å«å¤šä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„Stagesã€‚åœ¨Stagesé¡µé¢ï¼ŒSpark UIç½—åˆ—äº†åº”ç”¨ä¸­æ¶‰åŠçš„æ‰€æœ‰Stagesï¼Œè¿™äº›Stagesåˆ†å±äºä¸åŒçš„ä½œä¸šã€‚è¦æƒ³æŸ¥çœ‹å“ªäº›Stageséš¶å±äºå“ªä¸ªJobï¼Œè¿˜éœ€è¦ä»Jobsçš„DescriptionsäºŒçº§å…¥å£è¿›å…¥æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/71/7d/71cd54b597be76a1c900864661e3227d.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Stagesæ¦‚è§ˆé¡µ\"></p><p>Stagesé¡µé¢ï¼Œæ›´å¤šåœ°æ˜¯ä¸€ç§é¢„è§ˆï¼Œè¦æƒ³æŸ¥çœ‹æ¯ä¸€ä¸ªStageçš„è¯¦æƒ…ï¼ŒåŒæ ·éœ€è¦ä»â€œDescriptionâ€è¿›å…¥Stageè¯¦æƒ…é¡µï¼ˆä¸‹ä¸€è®²è¯¦ç»†å±•å¼€ï¼‰ã€‚</p><p>å¥½å•¦ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œå¯¹äºå¯¼èˆªæ¡ä¸­çš„ä¸åŒé¡µé¢ï¼Œæˆ‘ä»¬éƒ½åšäº†ä¸åŒç¨‹åº¦çš„å±•å¼€ã€‚ç®€å•æ±‡æ€»ä¸‹æ¥ï¼Œå…¶ä¸­<strong>Executorsã€Environmentã€Storageæ˜¯è¯¦æƒ…é¡µï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡è¿™3ä¸ªé¡µé¢ï¼Œè¿…é€Ÿåœ°äº†è§£é›†ç¾¤æ•´ä½“çš„è®¡ç®—è´Ÿè½½ã€è¿è¡Œç¯å¢ƒï¼Œä»¥åŠæ•°æ®é›†ç¼“å­˜çš„è¯¦ç»†æƒ…å†µï¼›è€ŒSQLã€Jobsã€Stagesï¼Œæ›´å¤šåœ°æ˜¯ä¸€ç§ç½—åˆ—å¼çš„å±•ç¤ºï¼Œæƒ³è¦äº†è§£å…¶ä¸­çš„ç»†èŠ‚ï¼Œè¿˜éœ€è¦è¿›å…¥åˆ°äºŒçº§å…¥å£</strong>ã€‚</p><p>æ­£å¦‚å¼€ç¯‡æ‰€è¯´ï¼ŒäºŒçº§å…¥å£çš„è®²è§£ï¼Œæˆ‘ä»¬ç•™åˆ°ä¸‹ä¸€è®²å†å»æ¢è®¨ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½å•¦ï¼Œä»Šå¤©çš„è¯¾ç¨‹ï¼Œåˆ°è¿™é‡Œå°±è®²å®Œå•¦ã€‚ä»Šå¤©çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œæ¶‰åŠçš„Metricsçº·ç¹è€Œåˆå¤æ‚ï¼Œä»…ä»…å¬ä¸€éæˆ‘çš„è®²è§£ï¼Œè¿˜è¿œè¿œä¸å¤Ÿï¼Œè¿˜éœ€è¦ä½ ç»“åˆæ—¥å¸¸çš„å¼€å‘ï¼Œå»å¤šå¤šæ‘¸ç´¢ä¸ä½“ä¼šï¼ŒåŠ æ²¹ï¼</p><p>ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»ç®€å•ã€ç›´æ¥çš„ä¸€çº§å…¥å£å…¥æ‰‹ï¼ŒæŒ‰ç…§â€œExecutors -&gt; Environment -&gt; Storage -&gt; SQL -&gt; Jobs -&gt; Stagesâ€çš„é¡ºåºï¼Œå…ˆåä»‹ç»äº†ä¸€çº§å…¥å£çš„è¯¦æƒ…é¡µä¸æ¦‚è§ˆé¡µã€‚å¯¹äºè¿™äº›é¡µé¢ä¸­çš„å†…å®¹ï¼Œæˆ‘æŠŠéœ€è¦é‡ç‚¹æŒæ¡çš„éƒ¨åˆ†ï¼Œæ•´ç†åˆ°äº†å¦‚ä¸‹è¡¨æ ¼ï¼Œä¾›ä½ éšæ—¶å‚è€ƒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e3/c7/e324fa0b2db69499d951290dc4351bc7.jpg?wh=1920x811\" alt=\"å›¾ç‰‡\"></p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>ä»Šå¤©çš„æ€è€ƒé¢˜ï¼Œæˆ‘ä»¬åœ¨è¯¾ç¨‹ä¸­å·²ç»æè¿‡äº†ã€‚ä¸€ä¸ªæ˜¯åœ¨Executorsé¡µé¢ï¼Œä¸ºä»€ä¹ˆRDD Blocksä¸Complete Tasksçš„æ•°é‡ä¸ä¸€è‡´ã€‚ç¬¬äºŒä¸ªæ˜¯ï¼Œåœ¨Jobsé¡µé¢ï¼Œä¸ºä»€ä¹ˆæœ€åä¼šå¤šå‡ºæ¥ä¸€ä¸ªsave Actionï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµæ¢è®¨ï¼Œä¹Ÿæ¬¢è¿æ¨èä½ æŠŠè¿™ä¸€è®²åˆ†äº«ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€åŒäº‹ã€‚</p>","comments":[{"had_liked":false,"id":319334,"user_name":"å°æ","can_delete":false,"product_type":"c1","uid":1903790,"ip_address":"","ucode":"30BD251EE1B1E2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/iaQgtbE98VGIVIyribdo6dgLOnaNoe7ZdUuPr60ibsduibscrzQCTzdW2AfL9nxwe8YlSK75gOnK3YbAJKTaFPxibdg/132","comment_is_top":false,"comment_ctime":1635750234,"is_pvip":false,"replies":[{"id":"115947","content":"æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€~ ","user_name":"ä½œè€…å›å¤","comment_id":319334,"uid":"1043100","ip_address":"","utype":1,"ctime":1635954215,"user_name_real":"å´ç£Š"}],"discussion_count":1,"race_medal":1,"score":"23110586714","product_id":100090001,"comment_content":"1ã€æˆ‘æƒ³æ•°é‡ä¸ä¸€è‡´æ˜¯ç”±äºExecutorsåœ¨å¤„ç†è¿™ä¸ªapplicationä¸‹çš„æ‰€æœ‰job(ä¸€ä¸ªjobç”±actionç®—å­æ¥è§¦å‘,æ¯ä¸ªjobåˆä¼šæ ¹æ®shuffleæƒ…å†µåˆ’åˆ†å‡ºå¤šä¸ªstageï¼Œæ¯ä¸ªstageä¸­åˆä¼šåˆ’åˆ†å‡ºå¤šä¸ªtaskï¼Œå†æ ¹æ®taskScheduleråˆ†é…åˆ°å„ä¸ªExcecutor)å¾—å‡ºæ¥çš„Complete Tasksã€‚<br>","like_count":6,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529596,"discussion_content":"æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€~ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635954215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318801,"user_name":"LHF","can_delete":false,"product_type":"c1","uid":2763786,"ip_address":"","ucode":"6A74C9A2BB2B71","user_header":"https://static001.geekbang.org/account/avatar/00/2a/2c/0a/779abf52.jpg","comment_is_top":false,"comment_ctime":1635427595,"is_pvip":false,"replies":[{"id":"115579","content":"æ­£è§£ï¼Œæ»¡åˆ†ğŸ’¯","user_name":"ä½œè€…å›å¤","comment_id":318801,"uid":"1043100","ip_address":"","utype":1,"ctime":1635429217,"user_name_real":"å´ç£Š"}],"discussion_count":3,"race_medal":0,"score":"10225362187","product_id":100090001,"comment_content":"ç¬¬ä¸€ä¸ªï¼šæ¯ä¸ªrddç»è¿‡å¤„ç†åï¼Œåˆå¯èƒ½ç”Ÿæˆå…¶ä»–rddï¼Œè¿™é‡Œçš„tasksåº”è¯¥æ˜¯æ˜¾ç¤ºæ•´ä¸ªexecutorså¤„ç†è¿‡çš„ä»»åŠ¡æ•°ï¼Œè·Ÿrddçš„blocksæ— å…³ã€‚<br>ç¬¬äºŒä¸ªï¼šå› ä¸ºä»£ç æœ€åä¸€ä¸ªæ˜¯saveï¼Œä¼šç”Ÿæˆä¸€ä¸ªsaveçš„action","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529380,"discussion_content":"æ­£è§£ï¼Œæ»¡åˆ†ğŸ’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635429217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410572,"discussion_content":"æœ€åä¸€ä¸ªcollectæ˜¯saveæ“ä½œï¼Ÿä½†æ˜¯æ‰§è¡Œè®¡åˆ’é‡Œä¸æ˜¯æœ‰ä¸¤ä¸ªsaveå—ï¼Ÿå¦ä¸€ä¸ªsaveæ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635732763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1690884,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cd/04/e27b7803.jpg","nickname":"å°æ–°","note":"","ucode":"DCAD04665E2CF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2028277,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","nickname":"Unknown element","note":"","ucode":"34A129800D0238","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535466,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638448547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":410572,"ip_address":""},"score":535466,"extra":""}]}]},{"had_liked":false,"id":331588,"user_name":"æˆ‘çˆ±å¤œæ¥é¦™","can_delete":false,"product_type":"c1","uid":2609930,"ip_address":"","ucode":"10761E677EF05F","user_header":"https://static001.geekbang.org/account/avatar/00/27/d3/0a/92640aae.jpg","comment_is_top":false,"comment_ctime":1642665016,"is_pvip":false,"replies":[{"id":"121195","content":"æ²¡ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»å“ˆ~<br>spark.ui.portè¿™ä¸ªé…ç½®é¡¹ï¼Œç”¨æ¥é…ç½®Spark UIæœåŠ¡ç«¯å£ï¼Œåªè¦è®¾ç½®ä¸ºèŠ‚ç‚¹ä¸Šç©ºé—²çš„ç«¯å£å³å¯","user_name":"ä½œè€…å›å¤","comment_id":331588,"uid":"1043100","ip_address":"","utype":1,"ctime":1642777976,"user_name_real":"ç¼–è¾‘"}],"discussion_count":2,"race_medal":0,"score":"1642665016","product_id":100090001,"comment_content":"è€å¸ˆ,è¯·é—®ä¸‹4040ç«¯å£å’Œ8080ç«¯å£æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»å•Š?","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547636,"discussion_content":"æ²¡ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»å“ˆ~\nspark.ui.portè¿™ä¸ªé…ç½®é¡¹ï¼Œç”¨æ¥é…ç½®Spark UIæœåŠ¡ç«¯å£ï¼Œåªè¦è®¾ç½®ä¸ºèŠ‚ç‚¹ä¸Šç©ºé—²çš„ç«¯å£å³å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642777976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2955154,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/17/92/0af520ef.jpg","nickname":"åæœˆ","note":"","ucode":"95877CD3753595","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568809,"discussion_content":"é»˜è®¤æƒ…å†µä¸‹ï¼Œ4040é»˜è®¤çš„æ˜¯applicationçš„web UIï¼ˆspark  on yarnæ˜¯è¿™æ ·çš„ï¼Œå¹¶ä¸”è¿™ä¸ªç«¯å£ä¼šé€æ¸é€’å¢ï¼‰ï¼Œè€Œ8080æ˜¯standaloneæ¨¡å‹ä¸‹masterçš„web UI","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651233122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319722,"user_name":"Geek_d4ccac","can_delete":false,"product_type":"c1","uid":2319416,"ip_address":"","ucode":"765580851490C3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4gIlRyVTOlTP8p1ucUN7Ahf2XMAicFpOHfk2UcrxEFm8GKIyCKGxd0PgBU0tMKwfPia8Ulk6rYBHVw/132","comment_is_top":false,"comment_ctime":1635922732,"is_pvip":false,"replies":[{"id":"115948","content":"Codeæ˜¯ä¸€è‡´çš„~ å½“ç„¶ï¼Œå˜é‡å‘½åå¯èƒ½å¤šå°‘ä¼šæœ‰äº›å‡ºå…¥ï¼Œè¿™ä¸ªä¸»è¦æ˜¯å› ä¸ºè·‘ä»£ç çš„æ—¶é—´ï¼Œå’Œæ•´ç†æ–‡ç¨¿çš„æ—¶é—´ï¼Œä¸­é—´å¯èƒ½éš”äº†ä¸€æ®µæ—¶é—´ï¼Œæœ‰äº›ç»†èŠ‚æ²¡æœ‰å®Œå…¨å¯¹ä¸Šã€‚ä½†æ˜¯è¿™ä¸ªä¸å½±å“æ­£æ–‡ä¸­è¯´çš„é‚£äº›å…³é”®å†…å®¹ï¼ˆå¦‚æŒ‡æ ‡Metricsã€DAGå›¾è§£ï¼Œç­‰ç­‰ï¼‰çš„è§£é‡Šå’Œé‡Šä¹‰å“ˆ~ ","user_name":"ä½œè€…å›å¤","comment_id":319722,"uid":"1043100","ip_address":"","utype":1,"ctime":1635955102,"user_name_real":"å´ç£Š"}],"discussion_count":1,"race_medal":0,"score":"1635922732","product_id":100090001,"comment_content":"è€å¸ˆå¥½ï¼æˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼Œæ‰€ä»¥è¿™ä¸€èŠ‚å‡†å¤‡å·¥ä½œéƒ¨åˆ†çš„code exampleå¹¶ä¸æ˜¯åé¢spark uié‡Œè·‘çš„codeä¹ˆï¼Ÿ æˆ‘è¿™è¾¹æ˜¾ç¤ºæœ€åæ˜¯result.collectã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529739,"discussion_content":"Codeæ˜¯ä¸€è‡´çš„~ å½“ç„¶ï¼Œå˜é‡å‘½åå¯èƒ½å¤šå°‘ä¼šæœ‰äº›å‡ºå…¥ï¼Œè¿™ä¸ªä¸»è¦æ˜¯å› ä¸ºè·‘ä»£ç çš„æ—¶é—´ï¼Œå’Œæ•´ç†æ–‡ç¨¿çš„æ—¶é—´ï¼Œä¸­é—´å¯èƒ½éš”äº†ä¸€æ®µæ—¶é—´ï¼Œæœ‰äº›ç»†èŠ‚æ²¡æœ‰å®Œå…¨å¯¹ä¸Šã€‚ä½†æ˜¯è¿™ä¸ªä¸å½±å“æ­£æ–‡ä¸­è¯´çš„é‚£äº›å…³é”®å†…å®¹ï¼ˆå¦‚æŒ‡æ ‡Metricsã€DAGå›¾è§£ï¼Œç­‰ç­‰ï¼‰çš„è§£é‡Šå’Œé‡Šä¹‰å“ˆ~ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635955102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}