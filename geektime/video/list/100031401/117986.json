{"id":117986,"title":"51 | Spring Boot如何实现分环境配置","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":124041,"user_name":"陈皮","can_delete":false,"product_type":"c3","uid":1103516,"ip_address":"","ucode":"42088EF5264280","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/9c/c48fd38a.jpg","comment_is_top":false,"comment_ctime":1565795780,"is_pvip":false,"replies":[{"id":45655,"content":"staffjoy的dev环境采用spring的外部集中配置方式，也就是项目根目录下的&#47;config里头的application.yml，spring首先会加载外部集中配置，然后再加载每个项目自己的配置。具体可以参考：https:&#47;&#47;docs.spring.io&#47;spring-boot&#47;docs&#47;current&#47;reference&#47;html&#47;boot-features-external-config.html，其中的24.3 Application Property Files","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1565877988,"ip_address":"","comment_id":124041,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"github readme 中有一段关于私密信息配置的描述，在 config&#47;application.yml 中维护私密数据。请问这个如何在 develop 环境下读取这个文件配置的。","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462977,"discussion_content":"staffjoy的dev环境采用spring的外部集中配置方式，也就是项目根目录下的/config里头的application.yml，spring首先会加载外部集中配置，然后再加载每个项目自己的配置。具体可以参考：https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html，其中的24.3 Application Property Files","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565877988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129762,"user_name":"陆培尔","can_delete":false,"product_type":"c3","uid":1095319,"ip_address":"","ucode":"B9AE067272513B","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/97/93e82345.jpg","comment_is_top":false,"comment_ctime":1567242631,"is_pvip":false,"replies":[{"id":48401,"content":"可以用端口转发(port-forwarding)，课程第9章k8s操作部分有演示。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1567247331,"ip_address":"","comment_id":129762,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"杨波老师，想问下如果是开发人员本地dev环境开发，如何去调用k8集群的微服务？如果是在集群里面，可以直接通过http:&#47;&#47;my-service&#47;addUser这样的形式调用，但是开发人员本地不在集群里面，无法这样调用，如果是通过网关调用，形式如http:&#47;&#47;gateway-ip:gateway-port&#47;my-service&#47;addUser，则感觉对配置代码有污染（各环境不一致），这个问题怎么解决？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465633,"discussion_content":"可以用端口转发(port-forwarding)，课程第9章k8s操作部分有演示。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567247331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095319,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b6/97/93e82345.jpg","nickname":"陆培尔","note":"","ucode":"B9AE067272513B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7010,"discussion_content":"谢谢老师回复，想了下，基于ingress应该也可以吧？ingress 默认部署出来就是80和443端口，这样也不需要做端口转发了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567256587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135355,"user_name":"LSJ","can_delete":false,"product_type":"c3","uid":1299437,"ip_address":"","ucode":"3CF8A457AC6BA9","user_header":"https://static001.geekbang.org/account/avatar/00/13/d3/ed/8d5420ad.jpg","comment_is_top":false,"comment_ctime":1569136599,"is_pvip":false,"replies":[{"id":52030,"content":"个人习惯不同，没有所谓标准做法，我比较习惯用spring profile机制 + 分配置文件方式管理。个人觉得maven profile机制应该也行，后面需要尝试下。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1569242064,"ip_address":"","comment_id":135355,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师 您好 为什么没有用maven的分环境配置呢 是因为maven的profiles不能在docker以及k8s环境是发挥作用吗 或者是说maven的环境配置也可以呢 因为我们一直使用的是maven的profile","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468151,"discussion_content":"个人习惯不同，没有所谓标准做法，我比较习惯用spring profile机制 + 分配置文件方式管理。个人觉得maven profile机制应该也行，后面需要尝试下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569242064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191119,"user_name":"钱","can_delete":false,"product_type":"c3","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1584746695,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"基础依赖环境隔离，这个确实很重要，各种环境相互独立，互不干扰。","like_count":0}]}