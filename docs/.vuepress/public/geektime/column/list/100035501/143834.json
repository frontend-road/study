{"id":143834,"title":"10 | MVCæ¶æ„è§£æï¼šæ§åˆ¶å™¨ï¼ˆControllerï¼‰ç¯‡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å››ç«ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ç»§ç»­å­¦ä¹  MVC æ¶æ„ï¼Œä¸»è¦å†…å®¹å°±æ˜¯ MVC æ¶æ„çš„ç¬¬ä¸‰éƒ¨åˆ†â€”â€”æ§åˆ¶å™¨ï¼ˆControllerï¼‰ã€‚</p><p>æ§åˆ¶å™¨ç”¨äºæ¥æ”¶è¯·æ±‚ï¼Œæ ¡éªŒå‚æ•°ï¼Œè°ƒç”¨ Model å±‚è·å–ä¸šåŠ¡æ•°æ®ï¼Œæ„é€ å’Œç»‘å®šä¸Šä¸‹æ–‡ï¼Œå¹¶è½¬ç»™ View å±‚å»æ¸²æŸ“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ§åˆ¶å™¨æ˜¯ MVC çš„å¤§è„‘ï¼Œå®ƒçŸ¥é“æ¥ä¸‹å»è¯¥è®©è°å»åšä»€ä¹ˆäº‹ã€‚æ§åˆ¶å™¨å±‚æ˜¯å¤§å¤šæ•° MVC æ¡†æ¶ç‰¹åˆ«æ„¿æ„åšæ–‡ç« çš„åœ°æ–¹ï¼Œæˆ‘ç›¸ä¿¡ä½ å¯èƒ½è€³é—»ã€äº†è§£ï¼Œç”šè‡³ç†Ÿç»ƒä½¿ç”¨è¿‡ä¸€äº› MVC æ¡†æ¶äº†ã€‚</p><p>é‚£ä¹ˆä¸å…¶å»æŠ½è±¡åœ°å­¦ä¹ è¿™ä¸€å±‚çš„é‡è¦æ¦‚å¿µã€åŸç†ï¼Œæˆ–æ˜¯å•çº¯åœ°å­¦ä¹ è¿™äº›æ¡†æ¶åœ¨è¿™ä¸€å±‚ç•¥æ˜¾ä¹å‘³çš„å…·ä½“é…ç½®ï¼Œæˆ‘æƒ³æˆ‘ä»¬ä»Šå¤©â€œä¸èµ°å¯»å¸¸è·¯â€ä¸€æ¬¡ï¼ŒæŠŠè¿™ä¸¤è€…ç»“åˆèµ·æ¥â€”â€”<strong>æˆ‘ä»¬æ¥æ¯”è¾ƒ Servletã€Struts å’Œ Spring MVC è¿™ä¸‰ç§å¸¸è§çš„æŠ€æœ¯å’Œ MVC æ¡†æ¶ï¼Œåœ¨æ§åˆ¶å™¨å±‚çš„å·¥ä½œè·¯æ•°ï¼Œä»¥åŠå’Œä¸šåŠ¡ä»£ç æ•´åˆé…ç½®çš„æ–¹å¼ï¼Œçœ‹çœ‹ä»»è¿™äº›æ¡†æ¶å½¢å¼åƒå˜ä¸‡åŒ–ï¼Œåˆ°åº•æœ‰å“ªäº›å…¶å®æ˜¯ä¸å˜çš„â€œå¥—è·¯â€å‘¢ï¼Ÿ</strong></p><p>éšç€è¯·æ±‚åˆ°è¾¾æ§åˆ¶å™¨ï¼Œè®©æˆ‘ä»¬é¡ºç€æ¥ä¸‹å»çš„è¯·æ±‚å¤„ç†æµç¨‹ï¼Œçœ‹çœ‹æ§åˆ¶å™¨ä¼šé€šè¿‡æ€æ ·çš„æ­¥éª¤ï¼Œå±¥è¡Œå®Œå®ƒçš„èŒè´£ï¼Œå¹¶æœ€ç»ˆè½¬åˆ°ç›¸åº”çš„è§†å›¾å§ã€‚</p><h2>1. è·¯å¾„æ˜ å°„å’Œè§†å›¾æŒ‡å‘</h2><p>æˆ‘ä»¬ä¸å¦¨æŠŠ MVC æ¶æ„çš„æ§åˆ¶å™¨æƒ³è±¡æˆä¸€ä¸ªé»‘ç›’ã€‚å½“ HTTP è¯·æ±‚ä»å®¢æˆ·ç«¯é€è¾¾çš„æ—¶å€™ï¼Œè¿™ä¸ªé»‘ç›’è¦å®Œæˆä¸€ç³»åˆ—ä½¿å‘½ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰ä¸€ä¸ªå…¥å£è·¯ç”±å’Œä¸€ä¸ªå‡ºå£è·¯ç”±ï¼š</p><!-- [[[read_end]]] --><ul>\n<li><strong>å…¥å£è·¯ç”±å°±æ˜¯è·¯å¾„æ˜ å°„ï¼Œæ ¹æ®é…ç½®çš„è§„åˆ™ï¼Œä»¥åŠè¯·æ±‚ URI çš„è·¯å¾„ï¼Œæ‰¾åˆ°å…·ä½“æ¥æ”¶å’Œå¤„ç†è¿™ä¸ªè¯·æ±‚çš„æ§åˆ¶å™¨é€»è¾‘ï¼›</strong></li>\n<li><strong>å‡ºå£è·¯ç”±å°±æ˜¯è§†å›¾æŒ‡å‘ï¼Œæ ¹æ®é…ç½®çš„è§„åˆ™ï¼Œä»¥åŠæ§åˆ¶å™¨å¤„ç†å®Œæ¯•åè¿”å›çš„ä¿¡æ¯ï¼Œæ‰¾åˆ°éœ€è¦æ¸²æŸ“çš„è§†å›¾é¡µé¢ã€‚</strong></li>\n</ul><p>è¿™ä¸¤ä»¶äº‹æƒ…ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥ä½¿ç”¨åŸå§‹çš„ if-else æ¥å®Œæˆï¼Œä½†æ˜¯ä¸€èˆ¬çš„ MVC éƒ½æä¾›äº†æ›´æ¸…æ™°å’Œç‹¬ç«‹çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯ä»è€æœ‹å‹ Servlet å¼€å§‹è®²èµ·ï¼Œåœ¨ Tomcat çš„ web.xml ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®è¿™æ ·çš„è·¯å¾„æ˜ å°„ï¼š</p><pre><code>&lt;servlet&gt;\n    &lt;servlet-name&gt;BookServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;com.xxx.xxx.BookServlet&lt;/servlet-class&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;BookServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/books&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre><p>ä½ çœ‹ï¼Œå¯¹äºè·¯å¾„æ˜ å°„ï¼Œä¸€æ—¦è¯·æ±‚æ˜¯ /books è¿™ç§å½¢å¼çš„ï¼Œå°±ä¼šè¢«è½¬åˆ° BookServlet é‡Œå»å¤„ç†ã€‚è€Œå¯¹äºè§†å›¾æŒ‡å‘ï¼ŒServlet æ˜¯é€šè¿‡ä»£ç å®Œæˆçš„ï¼Œæ¯”å¦‚ï¼š</p><pre><code>request.getRequestDispatcher(&quot;/book.jsp&quot;).forward(request, response);\n</code></pre><p>ä½†æ˜¯ï¼ŒServlet è·¯å¾„æ˜ å°„çš„è¡¨è¾¾å¼åŒ¹é…ä¸å¤Ÿçµæ´»ï¼Œè€Œä¸”é…ç½®è¿‡äºå†—é•¿ï¼›è€Œè§†å›¾æŒ‡å‘æ›´æ˜¯å®Œå…¨é€šè¿‡ä»£ç è°ƒç”¨æ¥å®Œæˆï¼Œè§†å›¾çš„ä½ç½®ä¿¡æ¯å®Œå…¨è€¦åˆåœ¨æ§åˆ¶å™¨ä¸»ä»£ç é€»è¾‘ä¸­ï¼Œè€Œä¸”ä¹Ÿå¹¶æ²¡æœ‰ä½“ç°å‡ºé…ç½®çš„é›†ä¸­ã€æ¸…æ™°çš„ç®¡ç†ä¼˜åŠ¿ã€‚äºæ˜¯ç°ä»Šçš„ MVC æ¡†æ¶éƒ½æä¾›äº†ä¸€å¥—è‡ªå·±çš„æ˜ å°„åŒ¹é…é€»è¾‘ï¼Œä¾‹å¦‚ <a href=\"https://struts.apache.org/index.html\">Struts 2</a>ï¼š</p><pre><code>&lt;action name=&quot;books&quot; class=&quot;xxx.xxx.BookAction&quot;&gt;\n    &lt;result name=&quot;success&quot; type=&quot;dispatcher&quot;&gt;/success.jsp&lt;/result&gt;\n    &lt;result name=&quot;input&quot; ... /&gt;\n&lt;/action&gt;\n</code></pre><p>å…¶ä¸­ï¼Œname=â€œbooksâ€ è¿™æ ·çš„é…ç½®å°±ä¼šå°† /books çš„è¯·æ±‚è½¬ç»™ BookActionã€‚è‡³äºæ¥ä¸‹æ¥çš„ä¸¤ä¸ª result æ ‡ç­¾ï¼Œæ˜¯æ ¹æ®æ§åˆ¶å™¨è¿”å›çš„è§†å›¾åæ¥é…å¯¹å…·ä½“çš„è§†å›¾é¡µé¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ BookAction å¤„ç†å®Œæ¯•ï¼Œé€šè¿‡è¿”å›çš„è§†å›¾åå­—ï¼Œè¯·æ±‚å¯ä»¥è¢«è½¬å‘ç»™ç›¸åº”çš„è§†å›¾ã€‚</p><p>è¿™ä¸ªè·¯å¾„æ˜ å°„çš„é…ç½®æ˜¯ç®€å•ä¸€äº›äº†ï¼Œå¯æ˜¯éƒ½éœ€è¦æ”¾åœ¨ä¸€ä¸ªå…¶å®ƒä½ç½®çš„ã€å•ç‹¬çš„ XML ä¸­é…ç½®ã€‚ä¸è¿‡ï¼ŒJava 5 å¼€å§‹æ”¯æŒæ³¨è§£ï¼Œå› æ­¤è®¸å¤š MVC æ¡†æ¶éƒ½å¼€å§‹æ”¯æŒä½¿ç”¨æ³¨è§£æ¥è®©è¿™æ ·çš„é…ç½®å˜å¾—æ›´åŠ è½»é‡ï¼Œä¹Ÿå°±æ˜¯å°†è·¯å¾„æ˜ å°„å’Œå®ƒæ‰€å±çš„æ§åˆ¶å™¨ä»£ç æ”¾åœ¨ä¸€èµ·ã€‚è§ä¸‹é¢ Struts çš„ä¾‹å­ï¼š</p><pre><code>public class BookAction extends ActionSupport {\n    @Action(value=&quot;/books&quot;, results={\n        @Result(name=&quot;success&quot;,location=&quot;/book.jsp&quot;)\n    })\n    public String get() {\n        ...\n        return &quot;success&quot;;\n    }\n}\n</code></pre><p>ä»£ç ä¾ç„¶å¾ˆå¥½ç†è§£ï¼Œå½“ä»¥ /books ä¸ºè·¯å¾„çš„ GET è¯·æ±‚åˆ°æ¥æ—¶ï¼Œä¼šè¢«è½¬ç»™ BookAction çš„ get æ–¹æ³•ã€‚åœ¨æ§åˆ¶å™¨çš„æ´»å¹²å®Œä¹‹åï¼Œæ ¹æ®è¿”å›çš„åç§° successï¼Œä¸‹ä¸€æ­¥è¯·æ±‚å°±ä¼šè½¬åˆ°è§†å›¾ /book.jsp ä¸­å»ã€‚</p><p>ä½ çœ‹ï¼Œå¯¹äºè·¯å¾„æ˜ å°„å’Œè§†å›¾æŒ‡å‘ï¼Œä¸ºäº†ä¸æŠŠè¿™æ ·çš„ä¿¡æ¯å’Œä¸»æµç¨‹ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œä¸Šé¢è®²äº†ä¸¤ç§å®ç°æ–¹æ³•ï¼Œå®ƒä»¬å„æœ‰ä¼˜åŠ£ï¼š</p><ul>\n<li>æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œå¥½å¤„æ˜¯æ‰€æœ‰çš„æ˜ å°„éƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œæ–¹ä¾¿ç®¡ç†ã€‚ä½†æ˜¯å¯¹äºä»»ä½•ä¸€ä¸ªæ§åˆ¶å™¨é€»è¾‘ï¼Œè¦å¯»æ‰¾å®ƒå¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼Œéœ€è¦å»åˆ«çš„ä½ç½®ï¼ˆå³ä¸Šæ–‡çš„ XML ä¸­ï¼‰å¯»æ‰¾ã€‚<strong>è¿™æ˜¯ä¸€ç§ä»£ç æ¨ªå‘åˆ†å±‚è§£è€¦çš„æ–¹å¼ï¼Œå³åˆ†å±‚æ–¹å¼å’Œä¸šåŠ¡æ¨¡å—æ— å…³ï¼Œæˆ–è€…è¯´äºŒè€…æ˜¯â€œæ­£äº¤â€çš„</strong>ï¼Œè¿™ç§æ–¹å¼æˆ‘åœ¨  <a href=\"https://time.geekbang.org/column/article/143882\">[ç¬¬ 11 è®²]</a> è®²è§£ IoCï¼ˆæ§åˆ¶åè½¬ï¼‰æ—¶ä¼šç»§ç»­ä»‹ç»ã€‚</li>\n<li>ä½¿ç”¨æ³¨è§£ï¼Œå’Œæ§åˆ¶å™¨é€»è¾‘æ”¾åœ¨ä¸€èµ·ï¼Œå¥½å¤„æ˜¯æ˜ å°„æœ¬èº«æ˜¯å’Œå…·ä½“çš„æ§åˆ¶å™¨é€»è¾‘æ”¾åœ¨ä¸€èµ·ï¼Œå½“ç„¶ï¼Œå®ƒä»¬å¹¶éä»£ç å±‚é¢çš„è€¦åˆï¼Œè€Œæ˜¯é€šè¿‡æ³¨è§£çš„æ–¹å¼åˆ†ç¦»å¼€ã€‚åå¤„æ˜¯ï¼Œå¦‚æœéœ€è¦è€ƒå¯Ÿæ‰€æœ‰çš„æ˜ å°„é…ç½®ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ–‡ä»¶å¯ä¾›æ¦‚è§ˆã€‚<strong>è¿™æ˜¯ä¸€ç§ä»£ç çºµå‘åˆ†å±‚è§£è€¦çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé…ç½®æ˜¯è·Ÿç€ä¸šåŠ¡æ¨¡å—èµ°çš„</strong>ã€‚</li>\n</ul><p>æ— è®ºä½¿ç”¨ä»¥ä¸Šå“ªä¸€ç§æ–¹æ³•ï¼Œæœ¬è´¨ä¸Šéƒ½é€ƒä¸è¿‡éœ€è¦æ˜¾å¼é…ç½®çš„å‘½è¿ã€‚ä½†æ— è®ºå“ªç§æ–¹æ³•ï¼Œå…¶å®éƒ½å·²ç»å¤Ÿç®€å•äº†ï¼Œå¯å†å²æ€»æ˜¯æƒŠäººçš„ç›¸ä¼¼ï¼Œæ€»æœ‰å¸®â€œéš¾ä¼ºå€™â€çš„ç¨‹åºå‘˜ï¼Œè¿˜æ˜¯å«Œéº»çƒ¦ï¼äºæ˜¯å°±æœ‰äººæƒ³å‡ºäº†ä¸€ä¸ªâ€œç»ˆæå·æ‡’â€çš„åŠæ³•â€”â€”å…æ‰é…ç½®ã€‚</p><p>è¿™å°±éœ€è¦åˆ©ç”¨ <strong>CoC åŸåˆ™ï¼ˆConvention over Configurationï¼Œå³è§„çº¦ä¼˜äºé…ç½®ï¼‰</strong>ã€‚æ¯”å¦‚ï¼Œåœ¨ä½¿ç”¨ <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html\">Spring MVC</a> è¿™ä¸ª MVC æ¡†æ¶æ—¶ï¼Œå£°æ˜äº† ControllerClassNameHandlerMapping ä»¥åï¼Œå¯¹äºè¿™æ ·æ²¡æœ‰é…ç½®ä»»ä½•æ˜ å°„ä¿¡æ¯çš„æ–¹æ³•ï¼Œä¼šæ ¹æ® Controller ç±»åçš„è§„çº¦æ¥å®Œæˆæ˜ å°„ï¼š</p><pre><code>public class BooksController extends AbstractController {\n    @Override\n    protected ModelAndView handleRequestInternal() throws Exception {\n        ...\n    }\n}\n</code></pre><p>åœ¨ä½¿ç”¨ /books å»è®¿é—®çš„æ—¶å€™ï¼Œè¯·æ±‚å°±ä¼šè¢«è‡ªåŠ¨è½¬äº¤ç»™å®šä¹‰å¥½çš„æ§åˆ¶å™¨é€»è¾‘ã€‚</p><p>ä½ çœ‹ï¼Œè§„çº¦ä¼˜äºé…ç½®çœ‹èµ·æ¥å¯ä»¥çœæ‰å¾ˆå¤šå·¥ä½œå¯¹ä¸å¯¹ï¼Ÿæ²¡é”™ï¼ä½†æ˜¯ä»»ä½•æŠ€æœ¯éƒ½æœ‰ä¸¤é¢æ€§ï¼Œ<strong>CoCè™½ç„¶çœæ‰äº†ä¸€éƒ¨åˆ†å®é™…çš„é…ç½®å·¥ä½œï¼Œå´æ²¡æœ‰æ”¹å˜æ˜ å°„åŒ¹é…çš„æµç¨‹æœ¬èº«ï¼Œä¹Ÿä¸èƒ½çœæ‰ä»»ä½•ä¸ºäº†ç†è§£è§„çº¦èƒŒåçš„â€œéšæ€§çŸ¥è¯†â€çš„å­¦ä¹ æˆæœ¬</strong>ã€‚è€Œä¸”ï¼Œè§„çº¦å¾€å¾€åªæ–¹ä¾¿äºè§£å†³æœ€å¸¸è§çš„é…ç½®ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œ<strong>å½“éœ€è¦æ›´çµæ´»çš„é…ç½®æ—¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šè¢«è¿«é€€åŒ–å›æ˜¾å¼é…ç½®</strong>ã€‚</p><h2>2. è¯·æ±‚å‚æ•°ç»‘å®š</h2><p>è¯·æ±‚è¢«é€åˆ°äº†æŒ‡å®šçš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œæ¥ä¸‹å»ï¼Œéœ€è¦ä» HTTP è¯·æ±‚ä¸­æŠŠå‚æ•°å–å‡ºæ¥ï¼Œç»‘å®šåˆ°æ§åˆ¶å™¨è¿™ä¸€å±‚ï¼Œä»¥ä¾¿ä½¿ç”¨ã€‚<strong>æ•´ä¸ªæ§åˆ¶å™¨çš„æµç¨‹ä¸­ï¼Œæœ‰ä¸¤æ¬¡é‡è¦çš„æ•°æ®ç»‘å®šï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡ï¼Œæ˜¯ä¸ºäº†æ§åˆ¶å™¨è€Œç»‘å®šè¯·æ±‚æ•°æ®</strong>ï¼Œåé¢åœ¨è§†å›¾ä¸Šä¸‹æ–‡æ„é€ è¿™ä¸€æ­¥ä¸­è¿˜æœ‰ä¸€æ¬¡ç»‘å®šï¼Œé‚£æ˜¯ä¸ºäº†è§†å›¾è€Œè¿›è¡Œçš„ã€‚</p><p>å’Œè·¯å¾„æ˜ å°„çš„é…ç½®ä¸€æ ·ï¼Œæœ€å…ˆè¢«è€ƒè™‘çš„æ–¹å¼ï¼Œä¸€å®šæ˜¯ç”¨ç¼–ç¨‹çš„æ–¹æ³•å®ç°çš„ã€‚æ¯”å¦‚åœ¨ Servlet ä¸­ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><pre><code>request.getParameter(&quot;name&quot;)\n</code></pre><p>è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆç¨€å¥‡çš„å¯¹ä¸å¯¹ï¼Œæƒ³æƒ³æˆ‘ä»¬å‰é¢å­¦ä¹ çš„å¤„ç†æ–¹æ³•ï¼Œå‚æ•°åº”è¯¥èƒ½é€šè¿‡æŸç§é…ç½®æ–¹å¼è‡ªåŠ¨æ³¨å…¥åˆ°æ§åˆ¶å™¨çš„å¯¹è±¡å±æ€§æˆ–è€…æ–¹æ³•å‚æ•°ä¸­å§ï¼Ÿä¸€ç‚¹éƒ½æ²¡é”™ï¼Œå¹¶ä¸”ï¼ŒStruts å’Œ Spring MVC å„æœ‰å„çš„åšæ³•ï¼ŒäºŒè€…åŠ èµ·æ¥ï¼Œå°±æ°å·§å°è¯äº†è¿™å¥è¯ã€‚</p><p>è¿˜è®°å¾—å‰é¢ Struts çš„é‚£ä¸ªä¾‹å­å—ï¼Ÿç»™ BookAction è®¾ç½®ä¸€ä¸ªå’Œå‚æ•°åŒåçš„å±æ€§ï¼Œå¹¶è¾…ä»¥è§„åˆ™çš„ get/set æ–¹æ³•ï¼Œå°±èƒ½å°†è¯·æ±‚ä¸­çš„å‚æ•°è‡ªåŠ¨æ³¨å…¥ã€‚æ›´å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼Œå¦‚æœè¿™ä¸ªå±æ€§æ˜¯ä¸ªå¤æ‚å¯¹è±¡ï¼Œåªè¦å‚æ•°æŒ‰ç…§è§„çº¦å‘½åäº†ï¼Œé‚£ä¹ˆå®ƒä¹Ÿèƒ½å¤Ÿè¢«æ­£ç¡®å¤„ç†ï¼š</p><pre><code>public class BookAction extends ActionSupport {\n    private Page page;\n    public void setPage { ... }\n    public Page getPage { ... }\n}\n</code></pre><p>åœ¨è¿™ç§è®¾å®šä¸‹ï¼Œå¦‚æœ URI æ˜¯ï¼š</p><pre><code>/books?page.pageSize=1&amp;page.pageNo=2&amp;page.orderBy=desc\n</code></pre><p>é‚£ä¹ˆï¼ŒpageSizeã€pageNo å’Œ orderBy è¿™ä¸‰ä¸ªå€¼å°±ä¼šè¢«è®¾ç½®åˆ°ä¸€ä¸ª Page å¯¹è±¡ä¸­ï¼Œè€Œè¿™ä¸ª Page å¯¹è±¡åˆ™ä¼šè¢«è‡ªåŠ¨æ³¨å…¥åˆ° BookAction çš„å®ä¾‹ä¸­å»ã€‚</p><p>å†æ¥çœ‹çœ‹ Spring MVC ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥å¤„ç†ï¼Œå’Œ URL çš„ç»“æ„æ”¾åœ¨ä¸€èµ·è§‚å¯Ÿï¼Œè¿™ç§æ–¹å¼æ˜¾ç„¶æ›´ä¸ºå½¢è±¡ç›´è§‚ï¼š</p><pre><code>@RequestMapping(&quot;/{category}/books&quot;)\npublic ModelAndView get(@PathVariable(&quot;category&quot;) String category, @RequestParam(&quot;author&quot;) String author){ ... }\n</code></pre><p>åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œå¦‚æœ URI æ˜¯ï¼š</p><pre><code>/comic/books?author=Jim\n</code></pre><p>é‚£ä¹ˆï¼Œåˆ†ç±» comic å°±ä¼šä½œä¸ºæ–¹æ³•å‚æ•° category çš„å€¼ä¼ å…¥ï¼Œè€Œä½œè€… Jim å°±ä¼šä½œä¸ºæ–¹æ³•å‚æ•° author çš„å€¼ä¼ å…¥ã€‚</p><h2>3. å‚æ•°éªŒè¯</h2><p>å‚æ•°éªŒè¯çš„æ“ä½œå› ä¸ºå’Œè¯·æ±‚å¯¹è±¡å¯†åˆ‡ç›¸å…³ï¼Œå› æ­¤é€šå¸¸éƒ½æ˜¯åœ¨æ§åˆ¶å™¨å±‚å®Œæˆçš„ã€‚åœ¨å‚æ•°éªŒè¯æ²¡æœ‰é€šè¿‡çš„æƒ…å†µä¸‹ï¼Œå¾€å¾€ä¼šæ‰§è¡Œå¼‚å¸¸æµç¨‹ï¼Œè½¬åˆ°é”™è¯¯é¡µé¢ï¼Œè¿”å›å¤±è´¥è¯·æ±‚ã€‚Struts æä¾›äº†ä¸€ä¸ªå°†å‚æ•°éªŒè¯è§£è€¦åˆ°é…ç½®æ–‡ä»¶çš„åŠæ³•ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><pre><code>&lt;validators&gt;\n  &lt;field name=&quot;name&quot;&gt;\n    &lt;field-validator type=&quot;requiredstring&quot;&gt;\n      &lt;param name=&quot;trim&quot;&gt;true&lt;/param&gt;\n      &lt;message&gt;ä¹¦åä¸å¾—ä¸ºç©º&lt;/message&gt;\n    &lt;/field-validator&gt;\n    &lt;field-validator type=&quot;stringlength&quot;&gt;\n      &lt;param name=&quot;maxLength&quot;&gt;100&lt;/param&gt;\n      &lt;param name=&quot;minLength&quot;&gt;1&lt;/param&gt;\n      &lt;message&gt;ä¹¦åçš„é•¿åº¦å¿…é¡»åœ¨ 1~100 ä¹‹é—´&lt;/message&gt;\n    &lt;/field-validator&gt;\n  &lt;/field&gt;\n&lt;/validators&gt;\n</code></pre><p>è¿™å°±æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‚æ•°éªŒè¯çš„è§„åˆ™ï¼Œå¯¹äºå±æ€§ name å®šä¹‰äº†ä¸¤æ¡è§„åˆ™ï¼Œä¸€æ¡æ˜¯ä¸å¾—ä¸ºç©ºï¼Œå¦ä¸€æ¡æ˜¯é•¿åº¦å¿…é¡»åœ¨ 1~100 ä¹‹é—´ï¼Œå¦åˆ™å°†è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p><p>ç±»ä¼¼çš„ï¼ŒStruts ä¹Ÿæä¾›äº†åŸºäºæ³¨è§£çš„å‚æ•°éªŒè¯æ–¹å¼ï¼Œä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœä½¿ç”¨æ³¨è§£æ¥å®ç°ï¼Œå°±éœ€è¦å°†æ³¨è§£åŠ åœ¨è‡ªåŠ¨æ³¨å…¥å‚æ•°çš„ set æ–¹æ³•å¤„ã€‚ä»£ç è§ä¸‹ï¼š</p><pre><code>@RequiredFieldValidator(trim = true, message = &quot;ä¹¦åä¸å¾—ä¸ºç©º.&quot;)\n@StringLengthFieldValidator(minLength = &quot;1&quot;, maxLength = &quot;100&quot;, message = &quot;ä¹¦åçš„é•¿åº¦å¿…é¡»åœ¨ 1~100 ä¹‹é—´&quot;)\nvoid setName(String name) { ... }\n</code></pre><h2>4. è§†å›¾ä¸Šä¸‹æ–‡ç»‘å®š</h2><p>åœ¨æ§åˆ¶å™¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†æ•°æ®ä¼ å…¥è§†å›¾å±‚ï¼Œå®ƒå¯èƒ½ä¼šæºå¸¦ç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œä¹Ÿå¯èƒ½ä¼šæºå¸¦åœ¨æ§åˆ¶å™¨ä¸­æŸ¥è¯¢æ¨¡å‹å¾—åˆ°çš„æ•°æ®ï¼Œè€Œè¿™ä¸ªä¼ å…¥æ–¹å¼ï¼Œå°±æ˜¯<strong>å°†æ•°æ®ç»‘å®šåˆ°è§†å›¾çš„ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™å°±æ˜¯æˆ‘åˆšåˆšæåˆ°è¿‡çš„æ§åˆ¶å™¨å±‚ä¸¤å¤§ç»‘å®šä¸­çš„ç¬¬äºŒä¸ª</strong>ã€‚</p><p>å¦‚æœæ˜¯ä½¿ç”¨ Servletï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥ç”¨ setAttribute çš„æ–¹æ³•å°†å‚æ•°è®¾ç½®åˆ° request å¯¹è±¡ä¸­ï¼Œè¿™æ ·åœ¨è§†å›¾å±‚å°±å¯ä»¥ç›¸åº”åœ°ä½¿ç”¨ getAttribute æ–¹æ³•æŠŠè¯¥å‚æ•°çš„å€¼å–å‡ºæ¥ã€‚</p><pre><code>request.setAttribute(&quot;page&quot;, xxx);\n</code></pre><p>å¯¹äº Struts æ¥è¯´ï¼Œå®ƒçš„æ–¹æ³•å’Œå‰é¢è¯´çš„è¯·æ±‚å‚æ•°ç»‘å®šç»Ÿä¸€äº†ï¼Œå³å¯ä»¥å°†æƒ³ä¼ é€’çš„å€¼æ”¾åˆ° Action çš„å¯¹è±¡å±æ€§ä¸­ï¼Œè¿™ç§æ–¹å¼ç»‘å®šçš„å±æ€§ï¼Œå’Œè¯·æ±‚å‚æ•°è‡ªåŠ¨ç»‘å®šçš„å±æ€§æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåœ¨è§†å›¾å±‚éƒ½å¯ä»¥ç›´æ¥ä»ä¸Šä¸‹æ–‡ä¸­å–å‡ºæ¥ã€‚</p><p>æ¥ç€å‰é¢ BookAction çš„ä¾‹å­ï¼Œç»‘å®šäº†ä¸€ä¸ª Page å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨è§†å›¾å±‚ä¸­å°±å¯ä»¥ä½¿ç”¨ OGNLï¼ˆObject-Graph Navigation Languageï¼Œå¯¹è±¡å¯¼èˆªå›¾è¯­è¨€ï¼‰è¡¨è¾¾å¼ç›´æ¥å–å¾—ï¼š</p><pre><code>&lt;p&gt;ç¬¬ ${page.pageNo} é¡µ&lt;/p&gt;\n</code></pre><p>å¯¹äº Spring MVCï¼Œåˆ™æ˜¯éœ€è¦åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸­ä¼ å…¥ä¸€ä¸ªç±»å‹ä¸º Model çš„å¯¹è±¡ï¼ŒåŒæ—¶å°†éœ€è¦ç»‘å®šçš„å¯¹è±¡é€šè¿‡è°ƒç”¨ addAttribute æ¥å®Œæˆç»‘å®šï¼Œè¿™ä¸ªè¿‡ç¨‹å’Œ Servlet æ˜¯ç±»ä¼¼çš„ã€‚</p><h2>æ€»ç»“æ€è€ƒ</h2><p>ä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº† MVC æ¶æ„ä¸­çš„æ§åˆ¶å™¨å±‚ï¼Œæ•´ä¸ªæ§åˆ¶å™¨çš„é€»è¾‘æ¯”è¾ƒå¯†é›†ï¼Œä»è¯·æ±‚æŠµè¾¾ï¼Œåˆ°è½¬å‡ºåˆ°è§†å›¾å±‚å»æ¸²æŸ“ï¼Œæ§åˆ¶å™¨çš„é€»è¾‘é€šå¸¸åŒ…æ‹¬ä¸‹é¢è¿™å‡ æ­¥ï¼Œä½†æ˜¯ï¼Œä¸¥æ ¼è¯´èµ·æ¥ï¼Œä¸‹é¢è¿™äº›æ­¥éª¤çš„ä»»ä½•ä¸€æ­¥ï¼Œæ ¹æ®å®é™…æƒ…å†µï¼Œéƒ½æ˜¯å¯ä»¥çœç•¥çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0a/34/0a0f9ad88c34ab5922e57e2b55ff6834.png?wh=1361*422\" alt=\"\"></p><p>æˆ‘ä»¬å¯¹æ¯”äº†åœ¨åŸç”Ÿ Servletã€Struts æ¡†æ¶å’Œ Spring MVC æ¡†æ¶ä¸‹ï¼Œä¸Šé¢å„ä¸ªæ­¥éª¤çš„å®ç°ï¼Œå¸Œæœ›ä½ èƒ½å¤Ÿæ„Ÿæ‚Ÿåˆ°å…¶ä¸­çš„â€œå¥—è·¯â€ã€‚</p><p>æ˜¯çš„ï¼Œå…·ä½“æŸä¸€ä¸ªæ¡†æ¶çš„é…ç½®ä½¿ç”¨ï¼Œæ˜¯å¾ˆå®¹æ˜“å­¦ä¹ å’ŒæŒæ¡çš„ï¼Œè¿™å½“ç„¶å¾ˆå¥½ï¼Œä½†é‚£åªæ˜¯æ­»çš„çŸ¥è¯†ï¼Œè€Œè¿™ä¹Ÿåªæ˜¯æœºæ¢°è®°å¿†ã€‚è€Œå½“æˆ‘ä»¬å»æ€è€ƒåŒä¸€ä¸ªæ¡†æ¶ä¸­å®ç°åŒä¸€ä¸ªç‰¹æ€§çš„ä¸åŒæ–¹æ³•ï¼Œæˆ–è€…æ˜¯ä¸åŒæ¡†æ¶å®ç°åŒä¸€ä¸ªç‰¹æ€§çš„ä¸åŒæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šæ…¢æ…¢ä½“ä¼šåˆ°æŠ€æœ¯çš„æœ‰è¶£ä¹‹å¤„ã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä¼šå»æ€è€ƒï¼Œè¿™äº›ä¸åŒçš„â€œç©æ³•â€æ¯”è¾ƒèµ·æ¥ï¼Œå„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Œåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥æ€ä¹ˆå»æƒè¡¡å’Œé€‰æ‹©ï¼Œç”šè‡³å»æƒ³ï¼Œå¦‚æœè®©æˆ‘å»è®¾è®¡ä¸€ä¸ªç±»ä¼¼çš„ç‰¹æ€§ï¼Œéƒ½æœ‰å“ªäº›åŠæ³•å¯ä»¥å®ç°ã€‚</p><p>å¥½ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥æ£€éªŒä¸€ä¸‹ä»Šå¤©æ‰€å­¦çš„çŸ¥è¯†ï¼Œè¯·æ€è€ƒä¸‹é¢è¿™æ ·ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul>\n<li>æˆ‘ä»¬æåˆ°äº† MVC æ¡†æ¶ä¸­ï¼Œä¸¤ç§å¸¸è§çš„é…ç½®æ–¹å¼ï¼Œä¸€ç§æ˜¯å°†é…ç½®æ”¾åœ¨æ¨ªå‘è§£è€¦çš„å•ç‹¬ä¸€å±‚ï¼Œå¦ä¸€ç§æ˜¯å°†é…ç½®å’Œä¸šåŠ¡æ¨¡å—æ”¾åœ¨ä¸€èµ·ã€‚ä½ æ›´å–œæ¬¢å“ªä¸€ç§ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li>åœ¨ä¸Šé¢çš„å›¾ä¸­ï¼Œæˆ‘åˆ—å‡ºäº†æ§åˆ¶å™¨å±‚å¸¸è§çš„å…­å¤§æ­¥éª¤ã€‚é‚£ä¹ˆï¼Œå›æƒ³ä½ ç»å†è¿‡çš„é¡¹ç›®ï¼Œæ˜¯å°†æ€æ ·çš„ä»£ç é€»è¾‘æ”¾åœ¨äº†æ§åˆ¶å™¨å±‚å‘¢ï¼Ÿ</li>\n</ul><p>å¯¹äºä»Šå¤©å­¦ä¹ çš„å†…å®¹ï¼Œå¯¹äºæ€è€ƒé¢˜ï¼Œä»¥åŠé€šè¿‡æ¯”è¾ƒå­¦ä¹ â€œå¥—è·¯â€çš„æ–¹å¼ï¼Œå¦‚æœä½ æœ‰æƒ³æ³•ï¼Œä¸å¦¨å’Œæˆ‘åœ¨ç•™è¨€åŒºä¸€èµ·è®¨è®ºå§ã€‚</p><h2>é€‰ä¿®è¯¾å ‚ï¼šåŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€å•çš„ MVC ç³»ç»Ÿ</h2><p>è¿™ä¸€ç« æˆ‘ä»¬ä¸€ç›´åœ¨å­¦ä¹  MVCï¼Œä¸åŠ¨æ‰‹å®è·µæ˜¯ä¸è¡Œçš„ã€‚æˆ‘ä»¬è¦ä½¿ç”¨ Servlet + JSP + JavaBean è¿™ç§ç›¸å¯¹åŸå§‹çš„æ–¹æ³•æ¥å®ç°ä¸€ä¸ªæœ€ç®€å•çš„ MVC ç³»ç»Ÿã€‚</p><p>è¿˜è®°å¾—æˆ‘ä»¬åœ¨ <a href=\"https://time.geekbang.org/column/article/140196\">[ç¬¬ 07 è®²]</a> ä¸­åŠ¨æ‰‹è·‘èµ·æ¥çš„ Tomcat å—ï¼Ÿç°åœ¨è¯·æ‰“å¼€ Tomcat çš„å®‰è£…ç›®å½•ï¼Œè®¾ç½®å¥½ç¯å¢ƒå˜é‡ CATALINA_HOMEï¼Œä»¥ä¾¿äºæˆ‘ä»¬åé¢ä½¿ç”¨æ­£ç¡®çš„ Tomcat è·¯å¾„ã€‚ä»¥æˆ‘çš„ç”µè„‘ä¸ºä¾‹ï¼š</p><pre><code>export CATALINA_HOME=/usr/local/Cellar/tomcat/9.0.22/libexec\n</code></pre><p>æˆ‘ä»¬æ‰“å¼€ ${CATALINA_HOME}/webapps/ROOT/WEB-INF/web.xmlï¼Œåœ¨  è¿™ä¸ªç»“æŸæ ‡ç­¾å‰ï¼Œæ·»åŠ å¦‚ä¸‹å­æ ‡ç­¾ï¼š</p><pre><code>&lt;servlet&gt;\n  &lt;servlet-name&gt;BookServlet&lt;/servlet-name&gt;\n  &lt;servlet-class&gt;BookServlet&lt;/servlet-class&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n  &lt;servlet-name&gt;BookServlet&lt;/servlet-name&gt;\n  &lt;url-pattern&gt;/books&lt;/url-pattern&gt;\n  &lt;url-pattern&gt;/books/*&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre><p>æ³¨æ„è¿™é‡Œé…ç½®äº†ä¸¤ä¸ª URL æ˜ å°„ï¼Œ/books å’Œ /books/{bookId} ä¸¤ç§ç±»å‹çš„è¯·æ±‚ä¼šå…¨éƒ¨æ˜ å°„åˆ°æˆ‘ä»¬å°†å»ºç«‹çš„ Servlet ä¸­ã€‚</p><p>åœ¨é…ç½®å¥½ Servlet çš„æ˜ å°„ä¹‹åï¼Œè¿›å…¥ ${CATALINA_HOME}/webapps/ROOT/WEB-INFï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåä¸º classes çš„æ–‡ä»¶å¤¹ï¼Œæ¥ç€åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å»ºç«‹ä¸€ä¸ªåä¸º BookServlet.java çš„æ–‡ä»¶ï¼Œå¹¶ç¼–è¾‘å®ƒï¼š</p><pre><code>import java.io.IOException;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class BookServlet extends HttpServlet {\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        String category = request.getParameter(&quot;category&quot;);\n        request.setAttribute(&quot;categoryName&quot;, category);\n        request.getRequestDispatcher(&quot;/book.jsp&quot;).forward(request, response);\n    }\n}\n</code></pre><p>å—¯ï¼Œå…¶å®ä»£ç é€»è¾‘å¾ˆç®€å•ï¼ŒæŠŠ URL ä¸­çš„ category å‚æ•°çš„å€¼å–å‡ºæ¥ï¼Œç»™ä¸€ä¸ªæ–°åå­— categoryName å¹¶ä¼ ç»™ book.jspã€‚</p><p>å¥½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æŠŠä¸Šé¢çš„ Java æºæ–‡ä»¶ç¼–è¯‘æˆ class æ–‡ä»¶äº†ï¼Œæ‰§è¡Œï¼š</p><pre><code>javac BookServlet.java -classpath ${CATALINA_HOME}/lib/servlet-api.jar\n</code></pre><p>å…¶ä¸­ servlet-api.jar æ˜¯ Tomcat ä¸­å­˜æ”¾çš„ç¼–è¯‘è¿è¡Œ Servlet æ‰€å¿…é¡»çš„ç±»åº“ã€‚è¿™æ ·ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°åœ¨ classes ç›®å½•ä¸‹ç”Ÿæˆäº† BookServlet.class æ–‡ä»¶ã€‚</p><p>æ¥ç€ï¼Œåœ¨ ${CATALINA_HOME}/webapps/ROOT ä¸‹å»ºç«‹ book.jspï¼Œå¹¶å†™å…¥ï¼š</p><pre><code>&lt;jsp:useBean id=&quot;date&quot; class=&quot;java.util.Date&quot; /&gt;\nCategory name: &lt;%=request.getAttribute(&quot;categoryName&quot;) %&gt;, date: ${date.getYear()+1900}-${date.getMonth()+1}-${date.getDate()}\n</code></pre><p>ç¬¬ä¸€è¡Œè¡¨ç¤ºåˆ›å»ºå¹¶ä½¿ç”¨ä¸€ä¸ª Date ç±»å‹çš„ JavaBeanï¼Œç¬¬äºŒè¡Œåœ¨æ˜¾ç¤ºç»“æœçš„æ—¶å€™ï¼Œcategory ä½¿ç”¨äº† JSP ç‰¹æœ‰çš„ scriptlet çš„è¡¨è¾¾å¼ï¼Œè€Œæ—¥æœŸåˆ™ä½¿ç”¨äº† OGNL è¡¨è¾¾å¼ã€‚æ³¨æ„ Date å¯¹è±¡è¿”å›çš„å¹´ä»½æ˜¯ä»¥ 1900 å¹´ä¸ºåŸºå‡†çš„åç§»é‡ï¼Œå› æ­¤éœ€è¦åŠ ä¸Š 1900ï¼›è€Œè¿”å›çš„æœˆä»½æ˜¯ä» 0 å¼€å§‹å¾€åæ’çš„ï¼Œå› æ­¤éœ€è¦åŠ ä¸Šä¿®æ­£å€¼ 1ã€‚</p><p>å¥½äº†ï¼Œå¤§åŠŸå‘Šæˆï¼Œæˆ‘ä»¬å¿«æ¥æ‰§è¡Œ Tomcat çœ‹çœ‹ç»“æœå§ï¼å¯åŠ¨ Tomcatï¼š</p><pre><code>catalina run\n</code></pre><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š</p><pre><code>http://localhost:8080/books?category=art\n</code></pre><p>å¦‚æœä½ çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹å­—æ ·ï¼Œé‚£ä¹ˆï¼Œæ­å–œä½ ï¼ŒæˆåŠŸäº†ï¼ç°åœ¨ï¼Œä½ å¯ä»¥å›æƒ³ä¸€ä¸‹åˆšæ‰çš„å®ç°ï¼Œè¿™äº›ä»£ç è¯¥æ€æ ·å¯¹åº”åˆ° MVC å„ä¸ªéƒ¨åˆ†å‘¢ï¼Ÿ</p><pre><code>Category name: art, date: 2019-8-5\n</code></pre><h2>æ‰©å±•é˜…è¯»</h2><ul>\n<li>å¯¹äº <a href=\"https://struts.apache.org/index.html\">Struts</a> å’Œ <a href=\"https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html\">Spring MVC</a>ï¼Œæ–‡ä¸­å·²ç»ç»™å‡ºäº†å®˜æ–¹é“¾æ¥ï¼Œå¦‚æœä½ æƒ³é˜…è¯»ç®€æ´çš„ä¸­æ–‡ç‰ˆæ•™ç¨‹ï¼Œå¯ä»¥çœ‹çœ‹è¿™ä¸ª <a href=\"https://doc.yonyoucloud.com/doc/wiki/project/struts-2/architecture.html\">Struts 2 æ•™ç¨‹</a>å’Œè¿™ä¸ª <a href=\"https://www.w3cschool.cn/wkspring/9pf81ha5.html\">Spring MVC æ•™ç¨‹</a>ã€‚</li>\n<li>æ–‡ä¸­æåˆ°äº†ä½¿ç”¨ ControllerClassNameHandlerMapping æ¥è´¯å½»â€œè§„çº¦ä¼˜äºé…ç½®â€çš„æ€æƒ³ï¼Œè¾¾åˆ°å¯¹å…·ä½“çš„æ˜ å°„å…é…ç½®çš„ç›®çš„ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œ<a href=\"https://www.tutorialspoint.com/springmvc/springmvc_controllerclassnamehandlermapping\">Spring MVC - Controller Class Name Handler Mapping Example</a> è¿™ç¯‡æ–‡ç« æœ‰å¾ˆå¥½çš„ä»‹ç»ã€‚</li>\n<li><a href=\"https://www.ibm.com/developerworks/cn/opensource/os-cn-ognl/index.html\">OGNL è¯­è¨€ä»‹ç»ä¸å®è·µ</a>ï¼Œæ–‡ä¸­æåˆ°äº† OGNL è¡¨è¾¾å¼ï¼Œæ„Ÿå…´è¶£çš„è¯è¿™ç¯‡æ–‡ç« æ˜¯å¾ˆå¥½çš„å…¥é—¨ã€‚</li>\n</ul><p></p>","comments":[{"had_liked":false,"id":139148,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1570565545,"is_pvip":false,"replies":[{"id":"53661","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570592111,"ip_address":"","comment_id":139148,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14455467433","product_id":100035501,"comment_content":"1. æ›´å–œæ¬¢æŠŠé…ç½®æ”¾åœ¨å•ç‹¬ä¸€å±‚ï¼Œè¿™ä¹ˆåšçš„å¥½å¤„æ˜¯éƒ¨ç½²çš„æ—¶å€™ï¼Œæ›´æ”¹é…ç½®æ¯”è¾ƒæ–¹ä¾¿è€Œä¸”åŸºæœ¬ä¸ä¼šæœ‰é—æ¼ã€‚è¿™é‡Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å¯ä»¥ä½¿ç”¨äºŒè€…ç»“åˆçš„æ–¹å¼ï¼Œå¯¹äºé‚£äº›ç»å¸¸å˜çš„é…ç½®ï¼Œæ¯”å¦‚ IP åœ°å€ï¼Œç«¯å£å·ï¼Œtokenï¼Œæ•°æ®åº“è¿æ¥å¯ä»¥è€ƒè™‘æ”¾åœ¨å•ç‹¬ä¸€å±‚ï¼Œå…¶ä»–å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ï¼Œä¸å®¹æ˜“æ”¹å˜çš„é…ç½®ï¼Œåˆ©ç”¨æ³¨è§£å’Œå®ç°é€»è¾‘æ”¾åœ¨ä¸€èµ·<br><br>2. æ§åˆ¶å±‚åŸºæœ¬ä¸Šå°±åšæ•°æ®éªŒè¯ã€ç„¶å mapping åˆ°å¯¹åº”çš„ä¸šåŠ¡å¤„ç†å‡½æ•°ï¼Œä¸šåŠ¡å¤„ç†å‡½æ•°å¤„ç†å¥½è¯·æ±‚åä¼šå°†ç»“æœè¿”å›ï¼Œæ§åˆ¶å±‚å°†ä¸šåŠ¡å¤„ç†å‡½æ•°è¿”å›çš„ç»“æœä½œä¸ºå“åº”è¿”å›ç»™å‰ç«¯é¡µé¢<br><br>é€‰ä¿®è¯¾å ‚çš„ä¾‹å­ï¼Œweb.xml å’Œ BookSevlet.java æ‰€åšçš„äº‹æƒ…éƒ½å±äº controller å±‚çš„èŒƒç•´ï¼Œbook.jsp é‡Œé¢å¯¹åº”çš„æ˜¯ Model å±‚å’Œ view å±‚ï¼Œå› ä¸ºä½¿ç”¨äº† JavaBean è¿™é‡Œåº”è¯¥ç®—æ˜¯ View å»ç›´æ¥æ¥è§¦ Modelï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469813,"discussion_content":"ğŸ‘","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1570592111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138137,"user_name":"å››å–œ","can_delete":false,"product_type":"c1","uid":1071389,"ip_address":"","ucode":"C5EBED19C0F332","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/1d/c89abcd8.jpg","comment_is_top":false,"comment_ctime":1570061283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10159995875","product_id":100035501,"comment_content":"Djangoä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ŒFlaskä½¿ç”¨è£…é¥°å™¨ã€‚","like_count":3},{"had_liked":false,"id":140109,"user_name":"é¹ğŸ˜","can_delete":false,"product_type":"c1","uid":1255264,"ip_address":"","ucode":"B691572430BB9D","user_header":"https://static001.geekbang.org/account/avatar/00/13/27/60/7510c6c5.jpg","comment_is_top":false,"comment_ctime":1570810594,"is_pvip":false,"replies":[{"id":"54261","content":"å‰é¢è¯´å¾—æŒºå¥½ï¼Œæœ€åçš„é—®é¢˜æ²¡æœ‰çœ‹æ‡‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570939332,"ip_address":"","comment_id":140109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570810594","product_id":100035501,"comment_content":"1. é…ç½®æ–¹å¼ï¼Œè‡ªå·±æ›´å–œæ¬¢é€šè¿‡æ³¨è§£çš„å½¢å¼ï¼Œä¹‹å‰å®è·µè¿‡ç¨‹ä¸­å°±æ˜¯æ„Ÿè§‰æ¯”è¾ƒç®€å•ï¼Œç”¨æ—¶ç›´æ¥é…ç½®ã€‚ä½†ä»Šå¤©é€šè¿‡å­¦ä¹ è€å¸ˆçš„è¯¾ç¨‹æ„Ÿè§‰ä»»ä½•æŠ€æœ¯éƒ½ä¸ä¼˜åŠ¿å’ŒåŠ£åŠ¿ï¼Œå¯¹äºé…ç½®æ–¹å¼ï¼Œæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯è·¯å¾„æ˜ å°„åˆ†æ•£ï¼Œéš¾äºç»Ÿä¸€ç®¡ç†ï¼ŒåæœŸç»´æŠ¤èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä»¥åé¡¹ç›®è¦å¤šæ³¨æ„è¿™å—ã€‚<br>2. æ¥å£è°ƒç”¨:controlleræ”¶åˆ°è¯·æ±‚ï¼ŒéªŒå‚ï¼Œå°†è¯·æ±‚è½¬åŒ–ä¸ºå†…éƒ¨æœåŠ¡è°ƒç”¨ï¼ŒåŒæ­¥åé¦ˆå¤„ç†ç»“æœæˆ–è€…å¼‚æ­¥å›æ‰ç»“æœï¼Œè§†å›¾è¯·æ±‚:è¯·æ±‚ï¼ŒéªŒå‚ï¼ŒæœåŠ¡è°ƒç”¨ï¼Œè¿”å›è§†å›¾ã€‚<br><br>å››ç«è€å¸ˆåç»­çš„å®¢æˆ·æ˜¯å¦åŒ…å«å‰åç«¯åˆ†ç¦»æŠ€æœ¯ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470249,"discussion_content":"å‰é¢è¯´å¾—æŒºå¥½ï¼Œæœ€åçš„é—®é¢˜æ²¡æœ‰çœ‹æ‡‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570939332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139674,"user_name":"Paradiseä¸¶æœ½æœ¨","can_delete":false,"product_type":"c1","uid":1242819,"ip_address":"","ucode":"4E4B8DCC216FAA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/c3/926f2da9.jpg","comment_is_top":false,"comment_ctime":1570702528,"is_pvip":false,"replies":[{"id":"54200","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570848593,"ip_address":"","comment_id":139674,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570702528","product_id":100035501,"comment_content":"é€‰ä¿®è¯¾å ‚è¡¥å……æˆ‘è‡ªå·±é‡åˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼š<br>1. win10 ç¯å¢ƒä¸‹ç¼–è¾‘javaæ–‡ä»¶ï¼Œç¯å¢ƒå˜é‡é‚£é‡Œæ›¿æ¢æˆ $env:CATAIINA_HOMEï¼ˆpowershellï¼‰<br>2. Tomcatå¯åŠ¨ä¹‹åé¡µé¢æŠ¥é”™500ï¼ˆjavax.servlet.ServletException: Error instantiating servlet class [com.xxx.BookServlet]ï¼‰ï¼Œé…ç½®web.xmlæ—¶ï¼Œservlet-class åªä¿ç•™ç±»åå°±å¯ä»¥äº†","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470049,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570848593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139605,"user_name":"ä¸è®°å¹´","can_delete":false,"product_type":"c1","uid":1045945,"ip_address":"","ucode":"287E40C68356DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg","comment_is_top":false,"comment_ctime":1570689268,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570689268","product_id":100035501,"comment_content":"å¹³æ—¶æ›´å¤šçš„æ˜¯é…ç½®å’Œæ³¨è§£æ··ç”¨çš„æ–¹å¼ï¼Œé…ç½®å¤šç”¨äºå®è§‚ä¸€ç‚¹çš„ä¸œè¥¿ï¼Œä¾‹å¦‚æ§åˆ¶å™¨çš„æ³¨å†Œã€‚æ³¨è§£æ›´åå‘äºå¾®è§‚ä¸€ç‚¹ï¼Œä¾‹å¦‚å‚æ•°ç»‘å®š","like_count":0},{"had_liked":false,"id":139459,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1570656030,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570656030","product_id":100035501,"comment_content":"MVCè¿™å—çŸ¥è¯†å¯¹äºæ—©æœŸåšé¢å‘è¿‡ç¨‹å¼€å‘çš„è€Œè¨€åªèƒ½æ…¢æ…¢çš„å¾ªç¯å•ƒäº†ã€ã€ã€æœ¬æ¥ä»¥ä¸ºä¸ç”¨å†ç¢°è¿™äº›ï¼Œç»•äº†ä¸€åœˆå‘ç°ä¸æ‡‚è¿˜æ˜¯ä¸è¡Œï¼Œä¸è¿‡å•ƒèµ·æ¥ç¡®å®è›®è¾›è‹¦","like_count":0},{"had_liked":false,"id":138940,"user_name":"anginiit","can_delete":false,"product_type":"c1","uid":1105763,"ip_address":"","ucode":"C3FA0CFEADB3BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/63/b7296340.jpg","comment_is_top":false,"comment_ctime":1570513524,"is_pvip":false,"replies":[{"id":"53658","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"å››ç«","uid":"1580075","ctime":1570591748,"ip_address":"","comment_id":138940,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570513524","product_id":100035501,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1ï¼š æˆ‘æ›´å–œæ¬¢æŠŠé…ç½®å’Œä¸šåŠ¡æ”¾åˆ°ä¸€èµ·ï¼Œå› ä¸ºè¿™æ ·æ›´ç›´æ¥ï¼Œæˆ‘å¯ä»¥ç›´æ¥å¯¹åº”åˆ°æ§åˆ¶å±‚æ–¹æ³•ï¼ŒæŸ¥é”™ä¹Ÿæ›´ç›´æ¥ä¸€äº›ï¼Œåœ¨å·¥ä½œä¸­å¾ˆå°‘å»æŸ¥çœ‹æ‰€æœ‰è·¯ç”±çš„ã€‚<br>2ï¼šç°åœ¨çš„é¡¹ç›®éƒ½åœ¨ä½¿ç”¨springmvcï¼Œæ§åˆ¶å±‚å¾ˆç®€å•ï¼Œåªæ˜¯å»è¯·æ±‚æœåŠ¡å±‚ï¼Œåœ¨ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µä¸‹ä¼šæœ‰ä¸€äº›æ ¡éªŒé€»è¾‘ã€‚","like_count":0,"discussions":[{"author":{"id":1580075,"avatar":"https://static001.geekbang.org/account/avatar/00/18/1c/2b/2069abe6.jpg","nickname":"å››ç«","note":"","ucode":"E4BED7DCAADD99","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469708,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570591748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}