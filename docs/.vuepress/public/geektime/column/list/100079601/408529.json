{"id":408529,"title":"36 | ä»£ç æµ‹è¯•ï¼ˆä¸Šï¼‰ï¼šå¦‚ä½•ç¼–å†™ Go è¯­è¨€å•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ç”¨ä¾‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å­”ä»¤é£ã€‚</p><p>ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä»¬å°±è¿›å…¥äº†æœåŠ¡æµ‹è¯•æ¨¡å—ï¼Œè¿™ä¸€æ¨¡å—ä¸»è¦ä»‹ç»å¦‚ä½•æµ‹è¯•æˆ‘ä»¬çš„Goé¡¹ç›®ã€‚</p><p>åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…è¦å¼€å‘åŠŸèƒ½ï¼Œæ›´é‡è¦çš„æ˜¯ç¡®ä¿è¿™äº›åŠŸèƒ½ç¨³å®šå¯é ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€ä¸ªä¸é”™çš„æ€§èƒ½ã€‚è¦ç¡®ä¿è¿™äº›ï¼Œå°±è¦å¯¹ä»£ç è¿›è¡Œæµ‹è¯•ã€‚å¼€å‘äººå‘˜é€šå¸¸ä¼šè¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ï¼Œåˆ†åˆ«ç”¨æ¥æµ‹è¯•ä»£ç çš„åŠŸèƒ½æ˜¯å¦æ­£å¸¸å’Œä»£ç çš„æ€§èƒ½æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚</p><p>æ¯ç§è¯­è¨€é€šå¸¸éƒ½æœ‰è‡ªå·±çš„æµ‹è¯•åŒ…/æ¨¡å—ï¼ŒGoè¯­è¨€ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨Goä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>testing</code>åŒ…å¯¹ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ã€‚è¿™ä¸€è®²ï¼Œæˆ‘ä¼šç”¨ä¸€äº›ç¤ºä¾‹æ¥è®²è§£å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ç”¨ä¾‹ï¼Œä¸‹ä¸€è®²åˆ™ä¼šä»‹ç»å¦‚ä½•ç¼–å†™å…¶ä»–çš„æµ‹è¯•ç±»å‹ï¼Œå¹¶ä»‹ç» IAM é¡¹ç›®çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p><h2>å¦‚ä½•æµ‹è¯• Go ä»£ç ï¼Ÿ</h2><p>Goè¯­è¨€æœ‰è‡ªå¸¦çš„æµ‹è¯•æ¡†æ¶<code>testing</code>ï¼Œå¯ä»¥ç”¨æ¥å®ç°å•å…ƒæµ‹è¯•ï¼ˆTç±»å‹ï¼‰å’Œæ€§èƒ½æµ‹è¯•ï¼ˆBç±»å‹ï¼‰ï¼Œé€šè¿‡<code>go test</code>å‘½ä»¤æ¥æ‰§è¡Œå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ã€‚</p><p>go test æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œæ˜¯ä»¥goåŒ…ä¸ºå•ä½è¿›è¡Œæµ‹è¯•çš„ã€‚æ‰§è¡Œæ—¶éœ€è¦æŒ‡å®šåŒ…åï¼Œæ¯”å¦‚<code>go test åŒ…å</code>ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåŒ…åï¼Œé»˜è®¤ä¼šé€‰æ‹©æ‰§è¡Œå‘½ä»¤æ—¶æ‰€åœ¨çš„åŒ…ã€‚go teståœ¨æ‰§è¡Œæ—¶ï¼Œä¼šéå†ä»¥<code>_test.go</code>ç»“å°¾çš„æºç æ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­ä»¥<code>Test</code>ã€<code>Benchmark</code>ã€<code>Example</code>å¼€å¤´çš„æµ‹è¯•å‡½æ•°ã€‚</p><p>ä¸ºäº†æ¼”ç¤ºå¦‚ä½•ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæˆ‘é¢„å…ˆç¼–å†™äº†4ä¸ªå‡½æ•°ã€‚å‡è®¾è¿™äº›å‡½æ•°ä¿å­˜åœ¨testç›®å½•ä¸‹çš„<code>math.go</code>æ–‡ä»¶ä¸­ï¼ŒåŒ…åä¸º<code>test</code>ï¼Œmath.goä»£ç å¦‚ä¸‹ï¼š</p><!-- [[[read_end]]] --><pre><code class=\"language-go\">package test\n\nimport (\n\t\"fmt\"\n\t\"math\"\n\t\"math/rand\"\n)\n\n// Abs returns the absolute value of x.\nfunc Abs(x float64) float64 {\n\treturn math.Abs(x)\n}\n\n// Max returns the larger of x or y.\nfunc Max(x, y float64) float64 {\n\treturn math.Max(x, y)\n}\n\n// Min returns the smaller of x or y.\nfunc Min(x, y float64) float64 {\n\treturn math.Min(x, y)\n}\n\n// RandInt returns a non-negative pseudo-random int from the default Source.\nfunc RandInt() int {\n\treturn rand.Int()\n}\n</code></pre><p>åœ¨è¿™ä¸€è®²åé¢çš„å†…å®¹ä¸­ï¼Œæˆ‘ä¼šæ¼”ç¤ºå¦‚ä½•ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæ¥å¯¹è¿™äº›å‡½æ•°è¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ã€‚ä¸‹é¢è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹æµ‹è¯•å‘½åè§„èŒƒã€‚</p><h2>æµ‹è¯•å‘½åè§„èŒƒ</h2><p>åœ¨æˆ‘ä»¬å¯¹Goä»£ç è¿›è¡Œæµ‹è¯•æ—¶ï¼Œéœ€è¦ç¼–å†™æµ‹è¯•æ–‡ä»¶ã€æµ‹è¯•å‡½æ•°ã€æµ‹è¯•å˜é‡ï¼Œå®ƒä»¬éƒ½éœ€è¦éµå¾ªä¸€å®šçš„è§„èŒƒã€‚è¿™äº›è§„èŒƒæœ‰äº›æ¥è‡ªäºå®˜æ–¹ï¼Œæœ‰äº›åˆ™æ¥è‡ªäºç¤¾åŒºã€‚è¿™é‡Œï¼Œæˆ‘åˆ†åˆ«æ¥ä»‹ç»ä¸‹æµ‹è¯•æ–‡ä»¶ã€åŒ…ã€æµ‹è¯•å‡½æ•°å’Œæµ‹è¯•å˜é‡çš„å‘½åè§„èŒƒã€‚</p><h3>æµ‹è¯•æ–‡ä»¶çš„å‘½åè§„èŒƒ</h3><p>Goçš„æµ‹è¯•æ–‡ä»¶åå¿…é¡»ä»¥<code>_test.go</code>ç»“å°¾ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º<code>person.go</code>çš„æ–‡ä»¶ï¼Œé‚£å®ƒçš„æµ‹è¯•æ–‡ä»¶å¿…é¡»å‘½åä¸º<code>person_test.go</code>ã€‚è¿™æ ·åšæ˜¯å› ä¸ºï¼ŒGoéœ€è¦åŒºåˆ†å“ªäº›æ–‡ä»¶æ˜¯æµ‹è¯•æ–‡ä»¶ã€‚è¿™äº›æµ‹è¯•æ–‡ä»¶å¯ä»¥è¢«go testå‘½ä»¤è¡Œå·¥å…·åŠ è½½ï¼Œç”¨æ¥æµ‹è¯•æˆ‘ä»¬ç¼–å†™çš„ä»£ç ï¼Œä½†ä¼šè¢«Goçš„æ„å»ºç¨‹åºå¿½ç•¥æ‰ï¼Œå› ä¸ºGoç¨‹åºçš„è¿è¡Œä¸éœ€è¦è¿™äº›æµ‹è¯•ä»£ç ã€‚</p><h3>åŒ…çš„å‘½åè§„èŒƒ</h3><p>Goçš„æµ‹è¯•å¯ä»¥åˆ†ä¸ºç™½ç›’æµ‹è¯•å’Œé»‘ç›’æµ‹è¯•ã€‚</p><ul>\n<li><strong>ç™½ç›’æµ‹è¯•ï¼š</strong>å°†æµ‹è¯•å’Œç”Ÿäº§ä»£ç æ”¾åœ¨åŒä¸€ä¸ªGoåŒ…ä¸­ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥åŒæ—¶æµ‹è¯•GoåŒ…ä¸­å¯å¯¼å‡ºå’Œä¸å¯å¯¼å‡ºçš„æ ‡è¯†ç¬¦ã€‚å½“æˆ‘ä»¬ç¼–å†™çš„å•å…ƒæµ‹è¯•éœ€è¦è®¿é—®GoåŒ…ä¸­ä¸å¯å¯¼å‡ºçš„å˜é‡ã€å‡½æ•°å’Œæ–¹æ³•æ—¶ï¼Œå°±éœ€è¦ç¼–å†™ç™½ç›’æµ‹è¯•ç”¨ä¾‹ã€‚</li>\n<li><strong>é»‘ç›’æµ‹è¯•ï¼š</strong>å°†æµ‹è¯•å’Œç”Ÿäº§ä»£ç æ”¾åœ¨ä¸åŒçš„GoåŒ…ä¸­ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬ä»…å¯ä»¥æµ‹è¯•GoåŒ…çš„å¯å¯¼å‡ºæ ‡è¯†ç¬¦ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„æµ‹è¯•åŒ…å°†æ— æ³•è®¿é—®ç”Ÿäº§ä»£ç ä¸­çš„ä»»ä½•å†…éƒ¨å‡½æ•°ã€å˜é‡æˆ–å¸¸é‡ã€‚</li>\n</ul><p>åœ¨ç™½ç›’æµ‹è¯•ä¸­ï¼ŒGoçš„æµ‹è¯•åŒ…åç§°éœ€è¦è·Ÿè¢«æµ‹è¯•çš„åŒ…åä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚ï¼š<code>person.go</code>å®šä¹‰äº†ä¸€ä¸ª<code>person</code>åŒ…ï¼Œåˆ™<code>person_test.go</code>çš„åŒ…åä¹Ÿè¦ä¸º<code>person</code>ï¼Œè¿™ä¹Ÿæ„å‘³ç€<code>person.go</code>å’Œ<code>person_test.go</code>éƒ½è¦åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ã€‚</p><p>åœ¨é»‘ç›’æµ‹è¯•ä¸­ï¼ŒGoçš„æµ‹è¯•åŒ…åç§°éœ€è¦è·Ÿè¢«æµ‹è¯•çš„åŒ…åä¸åŒï¼Œä½†ä»ç„¶å¯ä»¥å­˜æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚æ¯”å¦‚ï¼Œ<code>person.go</code>å®šä¹‰äº†ä¸€ä¸ª<code>person</code>åŒ…ï¼Œåˆ™<code>person_test.go</code>çš„åŒ…åéœ€è¦è·Ÿ<code>person</code>ä¸åŒï¼Œé€šå¸¸æˆ‘ä»¬å‘½åä¸º<code>person_test</code>ã€‚</p><p>å¦‚æœä¸æ˜¯éœ€è¦ä½¿ç”¨é»‘ç›’æµ‹è¯•ï¼Œæˆ‘ä»¬åœ¨åšå•å…ƒæµ‹è¯•æ—¶è¦å°½é‡ä½¿ç”¨ç™½ç›’æµ‹è¯•ã€‚ä¸€æ–¹é¢ï¼Œè¿™æ˜¯go testå·¥å…·çš„é»˜è®¤è¡Œä¸ºï¼›å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨ç™½ç›’æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•å’Œä½¿ç”¨ä¸å¯å¯¼å‡ºçš„æ ‡è¯†ç¬¦ã€‚</p><p>æµ‹è¯•æ–‡ä»¶å’ŒåŒ…çš„å‘½åè§„èŒƒï¼Œç”±Goè¯­è¨€åŠgo testå·¥å…·æ¥å¼ºåˆ¶çº¦æŸã€‚</p><h3>å‡½æ•°çš„å‘½åè§„èŒƒ</h3><p>æµ‹è¯•ç”¨ä¾‹å‡½æ•°å¿…é¡»ä»¥<code>Test</code>ã€<code>Benchmark</code>ã€<code>Example</code>å¼€å¤´ï¼Œä¾‹å¦‚<code>TestXxx</code>ã€<code>BenchmarkXxx</code>ã€<code>ExampleXxx</code>ï¼Œ<code>Xxx</code>éƒ¨åˆ†ä¸ºä»»æ„å­—æ¯æ•°å­—çš„ç»„åˆï¼Œé¦–å­—æ¯å¤§å†™ã€‚è¿™æ˜¯ç”±Goè¯­è¨€å’Œgo testå·¥å…·æ¥è¿›è¡Œçº¦æŸçš„ï¼Œ<code>Xxx</code>ä¸€èˆ¬æ˜¯éœ€è¦æµ‹è¯•çš„å‡½æ•°åã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç¤¾åŒºçš„çº¦æŸï¼Œè¿™äº›çº¦æŸä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†æ˜¯éµå¾ªè¿™äº›çº¦æŸä¼šè®©æˆ‘ä»¬çš„æµ‹è¯•å‡½æ•°åæ›´åŠ æ˜“æ‡‚ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å‡½æ•°ï¼š</p><pre><code class=\"language-go\">package main\n\ntype Person struct {\n\tage  int64\n}\n\nfunc (p *Person) older(other *Person) bool {\n\treturn p.age &gt; other.age\n}\n</code></pre><p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæµ‹è¯•å‡½æ•°å‘½åä¸º<code>TestOlder</code>ï¼Œè¿™ä¸ªåç§°å¯ä»¥å¾ˆæ¸…æ™°åœ°è¯´æ˜å®ƒæ˜¯<code>Older</code>å‡½æ•°çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç”¨å¤šä¸ªæµ‹è¯•ç”¨ä¾‹æ¥æµ‹è¯•<code>TestOlder</code>å‡½æ•°ï¼Œè¿™äº›æµ‹è¯•ç”¨ä¾‹è¯¥å¦‚ä½•å‘½åå‘¢ï¼Ÿä¹Ÿè®¸ä½ ä¼šè¯´ï¼Œæˆ‘ä»¬å‘½åä¸º<code>TestOlder1</code>ã€<code>TestOlder2</code>ä¸å°±è¡Œäº†ï¼Ÿ</p><p>å…¶å®ï¼Œè¿˜æœ‰å…¶ä»–æ›´å¥½çš„å‘½åæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‡½æ•°å‘½åä¸º<code>TestOlderXxx</code>ï¼Œå…¶ä¸­<code>Xxx</code>ä»£è¡¨<code>Older</code>å‡½æ•°çš„æŸä¸ªåœºæ™¯æè¿°ã€‚ä¾‹å¦‚ï¼Œ<code>strings.Compare</code>å‡½æ•°æœ‰å¦‚ä¸‹æµ‹è¯•å‡½æ•°ï¼š<code>TestCompare</code>ã€<code>TestCompareIdenticalString</code>ã€<code>TestCompareStrings</code>ã€‚</p><h3>å˜é‡çš„å‘½åè§„èŒƒ</h3><p>Goè¯­è¨€å’Œgo testæ²¡æœ‰å¯¹å˜é‡çš„å‘½ååšä»»ä½•çº¦æŸã€‚ä½†æ˜¯ï¼Œåœ¨ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›è§„èŒƒå€¼å¾—æˆ‘ä»¬å»éµå®ˆã€‚</p><p>å•å…ƒæµ‹è¯•ç”¨ä¾‹é€šå¸¸ä¼šæœ‰ä¸€ä¸ªå®é™…çš„è¾“å‡ºï¼Œåœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†é¢„æœŸçš„è¾“å‡ºè·Ÿå®é™…çš„è¾“å‡ºè¿›è¡Œå¯¹æ¯”ï¼Œæ¥åˆ¤æ–­å•å…ƒæµ‹è¯•æ˜¯å¦é€šè¿‡ã€‚ä¸ºäº†æ¸…æ™°åœ°è¡¨è¾¾å‡½æ•°çš„å®é™…è¾“å‡ºå’Œé¢„æœŸè¾“å‡ºï¼Œå¯ä»¥å°†è¿™ä¸¤ç±»è¾“å‡ºå‘½åä¸º<code>expected/actual</code>ï¼Œæˆ–è€…<code>got/want</code>ã€‚ä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">if c.expected != actual {\n  t.Fatalf(\"Expected User-Agent '%s' does not match '%s'\", c.expected, actual)\n}\n</code></pre><p>æˆ–è€…ï¼š</p><pre><code class=\"language-go\">if got, want := diags[3].Description().Summary, undeclPlural; got != want {\n  t.Errorf(\"wrong summary for diagnostic 3\\ngot:  %s\\nwant: %s\", got, want)\n}\n</code></pre><p>å…¶ä»–çš„å˜é‡å‘½åï¼Œæˆ‘ä»¬å¯ä»¥éµå¾ªGoè¯­è¨€æ¨èçš„å˜é‡å‘½åæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p><ul>\n<li>Goä¸­çš„å˜é‡ååº”è¯¥çŸ­è€Œä¸æ˜¯é•¿ï¼Œå¯¹äºèŒƒå›´æœ‰é™çš„å±€éƒ¨å˜é‡æ¥è¯´å°¤å…¶å¦‚æ­¤ã€‚</li>\n<li>å˜é‡ç¦»å£°æ˜è¶Šè¿œï¼Œå¯¹åç§°çš„æè¿°æ€§è¦æ±‚è¶Šé«˜ã€‚</li>\n<li>åƒå¾ªç¯ã€ç´¢å¼•ä¹‹ç±»çš„å˜é‡ï¼Œåç§°å¯ä»¥æ˜¯å•ä¸ªå­—æ¯ï¼ˆiï¼‰ã€‚å¦‚æœæ˜¯ä¸å¸¸è§çš„å˜é‡å’Œå…¨å±€å˜é‡ï¼Œå˜é‡åå°±éœ€è¦å…·æœ‰æ›´å¤šçš„æè¿°æ€§ã€‚</li>\n</ul><p>ä¸Šé¢ï¼Œæˆ‘ä»‹ç»äº†Goæµ‹è¯•çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹å’Œæ€§èƒ½æµ‹è¯•ç”¨ä¾‹ã€‚</p><h2>å•å…ƒæµ‹è¯•</h2><p>å•å…ƒæµ‹è¯•ç”¨ä¾‹å‡½æ•°ä»¥ <code>Test</code> å¼€å¤´ï¼Œä¾‹å¦‚ <code>TestXxx</code> æˆ– <code>Test_xxx</code> ï¼ˆ <code>Xxx</code> éƒ¨åˆ†ä¸ºä»»æ„å­—æ¯æ•°å­—ç»„åˆï¼Œé¦–å­—æ¯å¤§å†™ï¼‰ã€‚å‡½æ•°å‚æ•°å¿…é¡»æ˜¯ <code>*testing.T</code>ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»å‹æ¥è®°å½•é”™è¯¯æˆ–æµ‹è¯•çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>testing.T</code> çš„ <code>Error</code> ã€<code>Errorf</code> ã€<code>FailNow</code> ã€<code>Fatal</code> ã€<code>FatalIf</code> æ–¹æ³•ï¼Œæ¥è¯´æ˜æµ‹è¯•ä¸é€šè¿‡ï¼›è°ƒç”¨ <code>Log</code> ã€<code>Logf</code> æ–¹æ³•æ¥è®°å½•æµ‹è¯•ä¿¡æ¯ã€‚å‡½æ•°åˆ—è¡¨å’Œç›¸å…³æè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b3/ab/b374d392abfe62459d2c22e6ff76c0ab.jpg?wh=1920x1570\" alt=\"å›¾ç‰‡\"></p><p>ä¸‹é¢çš„ä»£ç æ˜¯ä¸¤ä¸ªç®€å•çš„å•å…ƒæµ‹è¯•å‡½æ•°ï¼ˆå‡½æ•°ä½äºæ–‡ä»¶<a href=\"https://github.com/marmotedu/gopractise-demo\">math_test.go</a>ä¸­ï¼‰ï¼š</p><pre><code class=\"language-go\">func TestAbs(t *testing.T) {\n    got := Abs(-1)\n    if got != 1 {\n        t.Errorf(\"Abs(-1) = %f; want 1\", got)\n    }\n}\n\nfunc TestMax(t *testing.T) {\n    got := Max(1, 2)\n    if got != 2 {\n        t.Errorf(\"Max(1, 2) = %f; want 2\", got)\n    }\n}\n</code></pre><p>æ‰§è¡Œ<code>go test</code>å‘½ä»¤æ¥æ‰§è¡Œå¦‚ä¸Šå•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼š</p><pre><code class=\"language-go\">$ go test\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    0.002s\n</code></pre><p><code>go test</code>å‘½ä»¤è‡ªåŠ¨æœé›†æ‰€æœ‰çš„æµ‹è¯•æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ ¼å¼ä¸º<code>*_test.go</code>çš„æ–‡ä»¶ï¼Œä»ä¸­æå–å…¨éƒ¨æµ‹è¯•å‡½æ•°å¹¶æ‰§è¡Œã€‚<br>\ngo testè¿˜æ”¯æŒä¸‹é¢ä¸‰ä¸ªå‚æ•°ã€‚</p><ul>\n<li>-vï¼Œæ˜¾ç¤ºæ‰€æœ‰æµ‹è¯•å‡½æ•°çš„è¿è¡Œç»†èŠ‚ï¼š</li>\n</ul><pre><code class=\"language-go\">$ go test -v\n=== RUN   TestAbs\n--- PASS: TestAbs (0.00s)\n=== RUN   TestMax\n--- PASS: TestMax (0.00s)\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    0.002s\n</code></pre><ul>\n<li>-run &lt; regexp&gt;ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„æµ‹è¯•å‡½æ•°ï¼š</li>\n</ul><pre><code class=\"language-go\">$ go test -v -run='TestA.*'\n=== RUN   TestAbs\n--- PASS: TestAbs (0.00s)\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    0.001s\n</code></pre><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªè¿è¡Œäº†ä»¥<code>TestA</code>å¼€å¤´çš„æµ‹è¯•å‡½æ•°ã€‚</p><ul>\n<li>-count Nï¼ŒæŒ‡å®šæ‰§è¡Œæµ‹è¯•å‡½æ•°çš„æ¬¡æ•°ï¼š</li>\n</ul><pre><code class=\"language-go\">$ go test -v -run='TestA.*' -count=2\n=== RUN   TestAbs\n--- PASS: TestAbs (0.00s)\n=== RUN   TestAbs\n--- PASS: TestAbs (0.00s)\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    0.002s\n</code></pre><h3>å¤šä¸ªè¾“å…¥çš„æµ‹è¯•ç”¨ä¾‹</h3><p>å‰é¢ä»‹ç»çš„å•å…ƒæµ‹è¯•ç”¨ä¾‹åªæœ‰ä¸€ä¸ªè¾“å…¥ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æµ‹è¯•ä¸€ä¸ªå‡½æ•°åœ¨å¤šç§ä¸åŒè¾“å…¥ä¸‹æ˜¯å¦èƒ½æ­£å¸¸è¿”å›ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªç¨å¾®å¤æ‚ç‚¹çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨æ¥æ”¯æŒå¤šè¾“å…¥ä¸‹çš„ç”¨ä¾‹æµ‹è¯•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†<code>TestAbs</code>æ”¹é€ æˆå¦‚ä¸‹å‡½æ•°ï¼š</p><pre><code class=\"language-go\">func TestAbs_2(t *testing.T) {\n    tests := []struct {\n        x    float64\n        want float64\n    }{\n        {-0.3, 0.3},\n        {-2, 2},\n        {-3.1, 3.1},\n        {5, 5},\n    }\n\n    for _, tt := range tests {\n        if got := Abs(tt.x); got != tt.want {\n            t.Errorf(\"Abs() = %f, want %v\", got, tt.want)\n        }\n    }\n}\n</code></pre><p>ä¸Šè¿°æµ‹è¯•ç”¨ä¾‹å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä»£è¡¨ä¸€æ¬¡æµ‹è¯•ç”¨ä¾‹ã€‚æ•°ç»„å…ƒç´ çš„çš„å€¼åŒ…å«è¾“å…¥å’Œé¢„æœŸçš„è¿”å›å€¼ï¼š</p><pre><code class=\"language-go\">tests := []struct {\n    x    float64\n    want float64\n}{\n    {-0.3, 0.3},\n    {-2, 2},\n    {-3.1, 3.1},\n    {5, 5},\n}\n</code></pre><p>ä¸Šè¿°æµ‹è¯•ç”¨ä¾‹ï¼Œå°†è¢«æµ‹å‡½æ•°æ”¾åœ¨forå¾ªç¯ä¸­æ‰§è¡Œï¼š</p><pre><code class=\"language-go\">   for _, tt := range tests {\n        if got := Abs(tt.x); got != tt.want {\n            t.Errorf(\"Abs() = %f, want %v\", got, tt.want)\n        }\n    }\n</code></pre><p>ä¸Šé¢çš„ä»£ç å°†è¾“å…¥ä¼ é€’ç»™è¢«æµ‹å‡½æ•°ï¼Œå¹¶å°†è¢«æµ‹å‡½æ•°çš„è¿”å›å€¼è·Ÿé¢„æœŸçš„è¿”å›å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœç›¸ç­‰ï¼Œåˆ™è¯´æ˜æ­¤æ¬¡æµ‹è¯•é€šè¿‡ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™è¯´æ˜æ­¤æ¬¡æµ‹è¯•ä¸é€šè¿‡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæµ‹è¯•ä¸åŒçš„è¾“å…¥å’Œè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯ä¸åŒçš„æµ‹è¯•ç”¨ä¾‹ã€‚å¦‚æœè¦æ–°å¢ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæ ¹æ®éœ€è¦æ·»åŠ è¾“å…¥å’Œé¢„æœŸçš„è¿”å›å€¼å°±å¯ä»¥äº†ï¼Œè¿™äº›æµ‹è¯•ç”¨ä¾‹éƒ½å…±äº«å…¶ä½™çš„æµ‹è¯•ä»£ç ã€‚</p><p>ä¸Šé¢çš„æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<code>got != tt.want</code>æ¥å¯¹æ¯”å®é™…è¿”å›ç»“æœå’Œé¢„æœŸè¿”å›ç»“æœã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>github.com/stretchr/testify/assert</code>åŒ…ä¸­æä¾›çš„å‡½æ•°æ¥åšç»“æœå¯¹æ¯”ï¼Œä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">func TestAbs_3(t *testing.T) {\n    tests := []struct {\n        x    float64\n        want float64\n    }{\n        {-0.3, 0.3},\n        {-2, 2},\n        {-3.1, 3.1},\n        {5, 5},\n    }\n\n    for _, tt := range tests {\n        got := Abs(tt.x)\n        assert.Equal(t, got, tt.want)\n    }\n}\n</code></pre><p>ä½¿ç”¨<code>assert</code>æ¥å¯¹æ¯”ç»“æœï¼Œæœ‰ä¸‹é¢è¿™äº›å¥½å¤„ï¼š</p><ul>\n<li>å‹å¥½çš„è¾“å‡ºç»“æœï¼Œæ˜“äºé˜…è¯»ã€‚</li>\n<li>å› ä¸ºå°‘äº†<code>if got := Xxx(); got != tt.wang {}</code>çš„åˆ¤æ–­ï¼Œä»£ç å˜å¾—æ›´åŠ ç®€æ´ã€‚</li>\n<li>å¯ä»¥é’ˆå¯¹æ¯æ¬¡æ–­è¨€ï¼Œæ·»åŠ é¢å¤–çš„æ¶ˆæ¯è¯´æ˜ï¼Œä¾‹å¦‚<code>assert.Equal(t, got, tt.want, \"Abs test\")</code>ã€‚</li>\n</ul><p>assertåŒ…è¿˜æä¾›äº†å¾ˆå¤šå…¶ä»–å‡½æ•°ï¼Œä¾›å¼€å‘è€…è¿›è¡Œç»“æœå¯¹æ¯”ï¼Œä¾‹å¦‚<code>Zero</code>ã€<code>NotZero</code>ã€<code>Equal</code>ã€<code>NotEqual</code>ã€<code>Less</code>ã€<code>True</code>ã€<code>Nil</code>ã€<code>NotNil</code>ç­‰ã€‚å¦‚æœæƒ³äº†è§£æ›´å¤šå‡½æ•°ï¼Œä½ å¯ä»¥å‚è€ƒ<code>go doc github.com/stretchr/testify/assert</code>ã€‚</p><h3>è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ç”¨ä¾‹</h3><p>é€šè¿‡ä¸Šé¢çš„å­¦ä¹ ï¼Œä½ ä¹Ÿè®¸å¯ä»¥å‘ç°ï¼Œæµ‹è¯•ç”¨ä¾‹å…¶å®å¯ä»¥æŠ½è±¡æˆä¸‹é¢çš„æ¨¡å‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/fa/8f06e0a1bf2638a9255467a29e6dfcfa.jpg?wh=1920x688\" alt=\"å›¾ç‰‡\"></p><p>ç”¨ä»£ç å¯è¡¨ç¤ºä¸ºï¼š</p><pre><code class=\"language-go\">func TestXxx(t *testing.T) {\n    type args struct {\n        // TODO: Add function input parameter definition.\n    }\n\n    type want struct {\n         // TODO: Add function return parameter definition.\n    }\n    tests := []struct {\n        name string\n        args args\n        want want\n    }{\n        // TODO: Add test cases.\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := Xxx(tt.args); got != tt.want {\n                t.Errorf(\"Xxx() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre><p>æ—¢ç„¶æµ‹è¯•ç”¨ä¾‹å¯ä»¥æŠ½è±¡æˆä¸€äº›æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŸºäºè¿™äº›æ¨¡å‹æ¥è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚Goç¤¾åŒºä¸­æœ‰ä¸€äº›ä¼˜ç§€çš„å·¥å…·å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ï¼Œæˆ‘æ¨èä½ ä½¿ç”¨<a href=\"https://github.com/cweill/gotests\">gotests</a>å·¥å…·ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘æ¥è®²è®²gotestså·¥å…·çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥åˆ†æˆä¸‰ä¸ªæ­¥éª¤ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œå®‰è£…gotestså·¥å…·ï¼š</p><pre><code class=\"language-bash\">$ go get -u github.com/cweill/gotests/...\n</code></pre><p>gotestså‘½ä»¤æ‰§è¡Œæ ¼å¼ä¸ºï¼š<code>gotests [options] [PATH] [FILE] ...</code>ã€‚gotestså¯ä»¥ä¸º<code>PATH</code>ä¸‹çš„æ‰€æœ‰Goæºç æ–‡ä»¶ä¸­çš„å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ï¼Œä¹Ÿå¯ä»¥åªä¸ºæŸä¸ª<code>FILE</code>ä¸­çš„å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œè¿›å…¥æµ‹è¯•ä»£ç ç›®å½•ï¼Œæ‰§è¡Œgotestsç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼š</p><pre><code class=\"language-bash\">$ gotests -all -w .\n</code></pre><p>ä¸Šé¢çš„å‘½ä»¤ä¼šä¸ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰Goæºç æ–‡ä»¶ä¸­çš„å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œæ·»åŠ æµ‹è¯•ç”¨ä¾‹ï¼š</p><p>ç”Ÿæˆå®Œæµ‹è¯•ç”¨ä¾‹ï¼Œä½ åªéœ€è¦æ·»åŠ éœ€è¦æµ‹è¯•çš„è¾“å…¥å’Œé¢„æœŸçš„è¾“å‡ºå°±å¯ä»¥äº†ã€‚ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹æ˜¯é€šè¿‡gotestsç”Ÿæˆçš„ï¼š</p><pre><code class=\"language-go\">func TestUnpointer(t *testing.T) {\n    type args struct {\n        offset *int64\n        limit  *int64\n    }\n    tests := []struct {\n        name string\n        args args\n        want *LimitAndOffset\n    }{\n        // TODO: Add test cases.\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := Unpointer(tt.args.offset, tt.args.limit); !reflect.DeepEqual(got, tt.want) {\n                t.Errorf(\"Unpointer() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre><p>æˆ‘ä»¬åªéœ€è¦è¡¥å…¨<code>TODO</code>ä½ç½®çš„æµ‹è¯•æ•°æ®å³å¯ï¼Œè¡¥å…¨åçš„æµ‹è¯•ç”¨ä¾‹è§<a href=\"https://github.com/marmotedu/iam/blob/v1.0.8/internal/pkg/util/gormutil/gorm_test.go\">gorm_test.go</a>æ–‡ä»¶ã€‚</p><h2>æ€§èƒ½æµ‹è¯•</h2><p>ä¸Šé¢ï¼Œæˆ‘è®²äº†ç”¨æ¥æµ‹è¯•ä»£ç çš„åŠŸèƒ½æ˜¯å¦æ­£å¸¸çš„å•å…ƒæµ‹è¯•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹æ€§èƒ½æµ‹è¯•ï¼Œå®ƒæ˜¯ç”¨æ¥æµ‹è¯•ä»£ç çš„æ€§èƒ½æ˜¯å¦æ»¡è¶³éœ€æ±‚çš„ã€‚</p><p>æ€§èƒ½æµ‹è¯•çš„ç”¨ä¾‹å‡½æ•°å¿…é¡»ä»¥<code>Benchmark</code>å¼€å¤´ï¼Œä¾‹å¦‚<code>BenchmarkXxx</code>æˆ–<code>Benchmark_Xxx</code>ï¼ˆ <code>Xxx</code> éƒ¨åˆ†ä¸ºä»»æ„å­—æ¯æ•°å­—ç»„åˆï¼Œé¦–å­—æ¯å¤§å†™ï¼‰ã€‚</p><p>å‡½æ•°å‚æ•°å¿…é¡»æ˜¯<code>*testing.B</code>ï¼Œå‡½æ•°å†…ä»¥<code>b.N</code>ä½œä¸ºå¾ªç¯æ¬¡æ•°ï¼Œå…¶ä¸­<code>N</code>ä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´ï¼Œç›´åˆ°æ€§èƒ½æµ‹è¯•å‡½æ•°å¯ä»¥æŒç»­è¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œä»¥ä¾¿èƒ½å¤Ÿå¯é åœ°è®¡æ—¶ã€‚ä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„æ€§èƒ½æµ‹è¯•å‡½æ•°ï¼ˆå‡½æ•°ä½äºæ–‡ä»¶<a href=\"https://github.com/marmotedu/gopractise-demo/blob/master/test/math_test.go\">math_test.go</a>ä¸­ï¼‰ï¼š</p><pre><code class=\"language-go\">func BenchmarkRandInt(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        RandInt()\n    }\n}\n</code></pre><p><code>go test</code>å‘½ä»¤é»˜è®¤ä¸ä¼šæ‰§è¡Œæ€§èƒ½æµ‹è¯•å‡½æ•°ï¼Œéœ€è¦é€šè¿‡æŒ‡å®šå‚æ•°<code>-bench &lt;pattern&gt;</code>æ¥è¿è¡Œæ€§èƒ½æµ‹è¯•å‡½æ•°ã€‚<code>-bench</code>åå¯ä»¥è·Ÿæ­£åˆ™è¡¨è¾¾å¼ï¼Œé€‰æ‹©éœ€è¦æ‰§è¡Œçš„æ€§èƒ½æµ‹è¯•å‡½æ•°ï¼Œä¾‹å¦‚<code>go test -bench=\".*\"</code>è¡¨ç¤ºæ‰§è¡Œæ‰€æœ‰çš„å‹åŠ›æµ‹è¯•å‡½æ•°ã€‚æ‰§è¡Œ<code>go test -bench=\".*\"</code>åè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-bash\">$ go test -bench=\".*\"\ngoos: linux\ngoarch: amd64\npkg: github.com/marmotedu/gopractise-demo/31/test\nBenchmarkRandInt-4      97384827                12.4 ns/op\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    1.223s\n</code></pre><p>ä¸Šé¢çš„ç»“æœåªæ˜¾ç¤ºäº†æ€§èƒ½æµ‹è¯•å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚<code>BenchmarkRandInt</code>æ€§èƒ½æµ‹è¯•å‡½æ•°çš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><pre><code class=\"language-bash\">BenchmarkRandInt-4   \t90848414\t        12.8 ns/op\n</code></pre><p>æ¯ä¸ªå‡½æ•°çš„æ€§èƒ½æ‰§è¡Œç»“æœä¸€å…±æœ‰3åˆ—ï¼Œåˆ†åˆ«ä»£è¡¨ä¸åŒçš„æ„æ€ï¼Œè¿™é‡Œç”¨ä¸Šé¢çš„å‡½æ•°ä¸¾ä¾‹å­ï¼š</p><ul>\n<li><code>BenchmarkRandInt-4</code>ï¼Œ<code>BenchmarkRandInt</code>è¡¨ç¤ºæ‰€æµ‹è¯•çš„æµ‹è¯•å‡½æ•°åï¼Œ4è¡¨ç¤ºæœ‰4ä¸ªCPUçº¿ç¨‹å‚ä¸äº†æ­¤æ¬¡æµ‹è¯•ï¼Œé»˜è®¤æ˜¯<code>GOMAXPROCS</code>çš„å€¼ã€‚</li>\n<li><code>90848414</code> ï¼Œè¯´æ˜å‡½æ•°ä¸­çš„å¾ªç¯æ‰§è¡Œäº†<code>90848414</code>æ¬¡ã€‚</li>\n<li><code>12.8 ns/op</code>ï¼Œè¯´æ˜æ¯æ¬¡å¾ªç¯çš„æ‰§è¡Œå¹³å‡è€—æ—¶æ˜¯ <code>12.8</code> çº³ç§’ï¼Œè¯¥å€¼è¶Šå°ï¼Œè¯´æ˜ä»£ç æ€§èƒ½è¶Šé«˜ã€‚</li>\n</ul><p>å¦‚æœæˆ‘ä»¬çš„æ€§èƒ½æµ‹è¯•å‡½æ•°åœ¨æ‰§è¡Œå¾ªç¯å‰ï¼Œéœ€è¦åšä¸€äº›è€—æ—¶çš„å‡†å¤‡å·¥ä½œï¼Œæˆ‘ä»¬å°±éœ€è¦é‡ç½®æ€§èƒ½æµ‹è¯•æ—¶é—´è®¡æ•°ï¼Œä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">func BenchmarkBigLen(b *testing.B) {\n    big := NewBig()\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        big.Len()\n    }\n}\n</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆåœæ­¢æ€§èƒ½æµ‹è¯•çš„æ—¶é—´è®¡æ•°ï¼Œç„¶åå†å¼€å§‹æ—¶é—´è®¡æ•°ï¼Œä¾‹å¦‚ï¼š</p><pre><code class=\"language-go\">func BenchmarkBigLen(b *testing.B) {\n\tb.StopTimer() // è°ƒç”¨è¯¥å‡½æ•°åœæ­¢å‹åŠ›æµ‹è¯•çš„æ—¶é—´è®¡æ•°\n\tbig := NewBig()\n\tb.StartTimer() // é‡æ–°å¼€å§‹æ—¶é—´\n\tfor i := 0; i &lt; b.N; i++ {\n\t\tbig.Len()\n\t}\n}\n</code></pre><p>Bç±»å‹çš„æ€§èƒ½æµ‹è¯•è¿˜æ”¯æŒä¸‹é¢ 4 ä¸ªå‚æ•°ã€‚</p><ul>\n<li>benchmemï¼Œè¾“å‡ºå†…å­˜åˆ†é…ç»Ÿè®¡ï¼š</li>\n</ul><pre><code class=\"language-bash\">$ go test -bench=\".*\" -benchmem\ngoos: linux\ngoarch: amd64\npkg: github.com/marmotedu/gopractise-demo/31/test\nBenchmarkRandInt-4      96776823                12.8 ns/op             0 B/op          0 allocs/op\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    1.255s\n</code></pre><p>æŒ‡å®šäº†<code>-benchmem</code>å‚æ•°åï¼Œæ‰§è¡Œç»“æœä¸­åˆå¤šäº†ä¸¤åˆ—ï¼š 0 B/opï¼Œè¡¨ç¤ºæ¯æ¬¡æ‰§è¡Œåˆ†é…äº†å¤šå°‘å†…å­˜ï¼ˆå­—èŠ‚ï¼‰ï¼Œè¯¥å€¼è¶Šå°ï¼Œè¯´æ˜ä»£ç å†…å­˜å ç”¨è¶Šå°ï¼›0 allocs/opï¼Œè¡¨ç¤ºæ¯æ¬¡æ‰§è¡Œåˆ†é…äº†å¤šå°‘æ¬¡å†…å­˜ï¼Œè¯¥å€¼è¶Šå°ï¼Œè¯´æ˜åˆ†é…å†…å­˜æ¬¡æ•°è¶Šå°‘ï¼Œæ„å‘³ç€ä»£ç æ€§èƒ½è¶Šé«˜ã€‚</p><ul>\n<li>benchtimeï¼ŒæŒ‡å®šæµ‹è¯•æ—¶é—´å’Œå¾ªç¯æ‰§è¡Œæ¬¡æ•°ï¼ˆæ ¼å¼éœ€è¦ä¸ºNxï¼Œä¾‹å¦‚100xï¼‰ï¼š</li>\n</ul><pre><code class=\"language-bash\">$ go test -bench=\".*\" -benchtime=10s # æŒ‡å®šæµ‹è¯•æ—¶é—´\ngoos: linux\ngoarch: amd64\npkg: github.com/marmotedu/gopractise-demo/31/test\nBenchmarkRandInt-4&nbsp; &nbsp; &nbsp; 910328618&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;13.1 ns/op\nPASS\nok&nbsp; &nbsp; &nbsp; github.com/marmotedu/gopractise-demo/31/test&nbsp; &nbsp; 13.260s\n$ go test -bench=\".*\" -benchtime=100x # æŒ‡å®šå¾ªç¯æ‰§è¡Œæ¬¡æ•°\ngoos: linux\ngoarch: amd64\npkg: github.com/marmotedu/gopractise-demo/31/test\nBenchmarkRandInt-4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16.9 ns/op\nPASS\nok&nbsp; &nbsp; &nbsp; github.com/marmotedu/gopractise-demo/31/test&nbsp; &nbsp; 0.003s\n</code></pre><ul>\n<li>cpuï¼ŒæŒ‡å®šGOMAXPROCSã€‚</li>\n<li>timeoutï¼ŒæŒ‡å®šæµ‹è¯•å‡½æ•°æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ï¼š</li>\n</ul><pre><code class=\"language-bash\">$ go test -bench=\".*\" -timeout=10s\ngoos: linux\ngoarch: amd64\npkg: github.com/marmotedu/gopractise-demo/31/test\nBenchmarkRandInt-4      97375881                12.4 ns/op\nPASS\nok      github.com/marmotedu/gopractise-demo/31/test    1.224s\n</code></pre><h2>æ€»ç»“</h2><p>ä»£ç å¼€å‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä»£ç ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶æ ¹æ®éœ€è¦ï¼Œç»™ä¸€äº›å‡½æ•°ç¼–å†™æ€§èƒ½æµ‹è¯•ç”¨ä¾‹ã€‚Goè¯­è¨€æä¾›äº† <code>testing</code> åŒ…ï¼Œä¾›æˆ‘ä»¬ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶é€šè¿‡ <code>go test</code> å‘½ä»¤æ¥æ‰§è¡Œè¿™äº›æµ‹è¯•ç”¨ä¾‹ã€‚</p><p>go teståœ¨æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œä¼šæŸ¥æ‰¾å…·æœ‰å›ºå®šæ ¼å¼çš„Goæºç æ–‡ä»¶åï¼Œå¹¶æ‰§è¡Œå…¶ä¸­å…·æœ‰å›ºå®šæ ¼å¼çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å°±æ˜¯æµ‹è¯•ç”¨ä¾‹ã€‚è¿™å°±è¦æ±‚æˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶åã€å‡½æ•°åè¦ç¬¦åˆ <code>go test</code> å·¥å…·çš„è¦æ±‚ï¼šGoçš„æµ‹è¯•æ–‡ä»¶åå¿…é¡»ä»¥ <code>_test.go</code> ç»“å°¾ï¼›æµ‹è¯•ç”¨ä¾‹å‡½æ•°å¿…é¡»ä»¥ <code>Test</code> ã€ <code>Benchmark</code> ã€ <code>Example</code> å¼€å¤´ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œè¿˜è¦æ³¨æ„åŒ…å’Œå˜é‡çš„å‘½åè§„èŒƒã€‚</p><p>Goé¡¹ç›®å¼€å‘ä¸­ï¼Œç¼–å†™å¾—æœ€å¤šçš„æ˜¯å•å…ƒæµ‹è¯•ç”¨ä¾‹ã€‚å•å…ƒæµ‹è¯•ç”¨ä¾‹å‡½æ•°ä»¥ <code>Test</code> å¼€å¤´ï¼Œä¾‹å¦‚ <code>TestXxx</code> æˆ– <code>Test_xxx</code> ï¼ˆ<code>Xxx</code> éƒ¨åˆ†ä¸ºä»»æ„å­—æ¯æ•°å­—ç»„åˆï¼Œé¦–å­—æ¯å¤§å†™ï¼‰ã€‚å‡½æ•°å‚æ•°å¿…é¡»æ˜¯ <code>*testing.T</code> ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ç±»å‹æ¥è®°å½•é”™è¯¯æˆ–æµ‹è¯•çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>testing.T</code> çš„ <code>Error</code> ã€<code>Errorf</code> ã€<code>FailNow</code> ã€<code>Fatal</code> ã€<code>FatalIf</code> æ–¹æ³•ï¼Œæ¥è¯´æ˜æµ‹è¯•ä¸é€šè¿‡ï¼›è°ƒç”¨ <code>Log</code> ã€<code>Logf</code> æ–¹æ³•æ¥è®°å½•æµ‹è¯•ä¿¡æ¯ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å•å…ƒæµ‹è¯•å‡½æ•°ï¼š</p><pre><code class=\"language-go\">func TestAbs(t *testing.T) {\n&nbsp; &nbsp; got := Abs(-1)\n&nbsp; &nbsp; if got != 1 {\n&nbsp; &nbsp; &nbsp; &nbsp; t.Errorf(\"Abs(-1) = %f; want 1\", got)\n&nbsp; &nbsp; }\n}\n</code></pre><p>ç¼–å†™å®Œæµ‹è¯•ç”¨ä¾‹ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ <code>go test</code> å‘½ä»¤è¡Œå·¥å…·æ¥æ‰§è¡Œè¿™äº›æµ‹è¯•ç”¨ä¾‹ã€‚<br>\næ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<a href=\"https://github.com/cweill/gotests\">gotests</a>å·¥å…·ï¼Œæ¥è‡ªåŠ¨åœ°ç”Ÿæˆå•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œä»è€Œå‡å°‘ç¼–å†™æµ‹è¯•ç”¨ä¾‹çš„å·¥ä½œé‡ã€‚</p><p>æˆ‘ä»¬åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œè¿˜ç»å¸¸éœ€è¦ç¼–å†™æ€§èƒ½æµ‹è¯•ç”¨ä¾‹ã€‚æ€§èƒ½æµ‹è¯•ç”¨ä¾‹å‡½æ•°å¿…é¡»ä»¥<code>Benchmark</code>å¼€å¤´ï¼Œä»¥<code>*testing.B</code> ä½œä¸ºå‡½æ•°å…¥å‚ï¼Œé€šè¿‡ <code>go test -bench &lt;pattern&gt;</code> è¿è¡Œã€‚</p><h2>è¯¾åç»ƒä¹ </h2><ol>\n<li>ç¼–å†™ä¸€ä¸ª <code>PrintHello</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¿”å› <code>Hello World</code> å­—ç¬¦ä¸²ï¼Œå¹¶ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œå¯¹ <code>PrintHello</code> å‡½æ•°è¿›è¡Œæµ‹è¯•ã€‚</li>\n<li>æ€è€ƒä¸€ä¸‹ï¼Œå“ªäº›åœºæ™¯ä¸‹é‡‡ç”¨ç™½ç›’æµ‹è¯•ï¼Œå“ªäº›åœºæ™¯ä¸‹é‡‡ç”¨é»‘ç›’æµ‹è¯•ï¼Ÿ</li>\n</ol><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘äº¤æµè®¨è®ºï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ã€‚</p>","neighbors":{"left":{"article_title":"35 | æ•ˆç‡ç¥å™¨ï¼šå¦‚ä½•è®¾è®¡å’Œå®ç°ä¸€ä¸ªå‘½ä»¤è¡Œå®¢æˆ·ç«¯å·¥å…·ï¼Ÿ","id":407922},"right":{"article_title":"37 | ä»£ç æµ‹è¯•ï¼ˆä¸‹ï¼‰ï¼šGo è¯­è¨€å…¶ä»–æµ‹è¯•ç±»å‹åŠ IAM æµ‹è¯•ä»‹ç»","id":409307}},"comments":[{"had_liked":false,"id":307911,"user_name":"Sch0ng","can_delete":false,"product_type":"c1","uid":1145554,"ip_address":"","ucode":"73F6113931B1AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg","comment_is_top":false,"comment_ctime":1629302553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23104139033","product_id":100079601,"comment_content":"goè‡ªå¸¦æµ‹è¯•æ¡†æ¶testingã€‚<br>ä½¿ç”¨gotestså·¥å…·è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚<br>å•å…ƒæµ‹è¯•çš„ä»·å€¼æ˜¯æé«˜ä»£ç çš„å¯é æ€§ï¼Œé‡æ„çš„æ—¶å€™å¤šä¸€å±‚ä¿éšœã€‚<br>é‡åˆ°å•å…ƒæµ‹è¯•ä¸çŸ¥é“æ€ä¹ˆå†™çš„æƒ…å†µï¼Œé¦–å…ˆè€ƒè™‘å‡½æ•°çš„ç²’åº¦æ˜¯ä¸æ˜¯å¤ªç²—ï¼Œèƒ½ä¸èƒ½æ‹†æˆæ›´å°çš„å‡½æ•°ã€‚","like_count":6},{"had_liked":false,"id":343072,"user_name":"fcl","can_delete":false,"product_type":"c1","uid":2774638,"ip_address":"","ucode":"9FC74C4B1DD0B3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/56/6e/de7da340.jpg","comment_is_top":false,"comment_ctime":1650617539,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18830486723","product_id":100079601,"comment_content":"è‡ªå·±å†™çš„ä»£ç  çŸ¥é“å“ªä¸ªå‡½æ•°ç»å¸¸æ”¹ å¥½æ§åˆ¶  ç”¨ç™½ç›’æµ‹è¯• <br>åˆ«äººå†™çš„å¤æ‚ä»£ç   è‡ªå·±åªæ˜¯è°ƒç”¨æ¥å£  å‡½æ•°å¤ªå¤šä¸çŸ¥é“æµ‹å“ªä¸ª ç”¨é»‘ç›’æµ‹è¯•<br>é¢è¯•å®˜ï¼šæˆ‘æ²¡é—®é¢˜äº†ï¼Œä½ è¿˜æœ‰ä»€ä¹ˆæƒ³é—®çš„å—ï¼Ÿ","like_count":5},{"had_liked":false,"id":307546,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1629156726,"is_pvip":true,"replies":[{"id":"111378","content":"æœ‰fmt.Println&#47;fmt.Printfè¿™ç±»è¾“å‡ºçš„æ—¶å€™","user_name":"ä½œè€…å›å¤","comment_id":307546,"uid":"1167883","ip_address":"","utype":1,"ctime":1629242420,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"18809025910","product_id":100079601,"comment_content":"è€å¸ˆï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨ExampleXxxå‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525194,"discussion_content":"æœ‰fmt.Println/fmt.Printfè¿™ç±»è¾“å‡ºçš„æ—¶å€™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629242420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307552,"user_name":"daz2yy","can_delete":false,"product_type":"c1","uid":1008723,"ip_address":"","ucode":"639A67961EC893","user_header":"https://static001.geekbang.org/account/avatar/00/0f/64/53/c93b8110.jpg","comment_is_top":false,"comment_ctime":1629158185,"is_pvip":false,"replies":[{"id":"111377","content":"æ”¾åœ¨è·Ÿè¢«æµ‹ä»£ç ç›¸åŒçš„ç›®å½•ä¸‹ï¼Œä¾¿äºç»´æŠ¤","user_name":"ä½œè€…å›å¤","comment_id":307552,"uid":"1167883","ip_address":"","utype":1,"ctime":1629242399,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"14514060073","product_id":100079601,"comment_content":"è€å¸ˆï¼Œé—®ä¸‹ï¼Œæµ‹è¯•çš„ä»£ç å»ºè®®æ”¾åœ¨ä»£ç ç›¸åŒç›®å½•åŒ…ä¸‹è¿˜æ˜¯æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ test ç›®å½•å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525196,"discussion_content":"æ”¾åœ¨è·Ÿè¢«æµ‹ä»£ç ç›¸åŒçš„ç›®å½•ä¸‹ï¼Œä¾¿äºç»´æŠ¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629242399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308967,"user_name":"é™ˆéº’æ–‡","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1629875171,"is_pvip":false,"replies":[{"id":"112018","content":"æš‚æ—¶æ²¡å‘ç°æœ‰è‡ªåŠ¨ç”ŸæˆBenchmarkçš„å·¥å…·ã€‚<br><br>ä½¿ç”¨Mockæ¥æµ‹è¯•","user_name":"ä½œè€…å›å¤","comment_id":308967,"uid":"1167883","ip_address":"","utype":1,"ctime":1630113053,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"5924842467","product_id":100079601,"comment_content":"é‚£æœ‰æ²¡æœ‰è‡ªåŠ¨ç”ŸæˆBenchmarkçš„æ€§èƒ½å·¥å…·å‘¢ï¼Ÿè¿˜æœ‰TestXxxä¸€èˆ¬æ˜¯é’ˆå¯¹å‡½æ•°ä¹ˆï¼Œå¦‚æœæ˜¯æ¥å£çš„è¯ï¼Œå‚æ•°å€¼è¯¥æ€ä¹ˆå®šä¹‰ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525696,"discussion_content":"æš‚æ—¶æ²¡å‘ç°æœ‰è‡ªåŠ¨ç”ŸæˆBenchmarkçš„å·¥å…·ã€‚\n\nä½¿ç”¨Mockæ¥æµ‹è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630113053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343221,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1650716775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650716775","product_id":100079601,"comment_content":"ç™½ç›’æµ‹è¯•ï¼š<br>è¦æµ‹è¯•å†…éƒ¨æ ‡è¯†ç¬¦ï¼Œå¸¸è§„æµ‹è¯•<br>é»‘ç›’æµ‹è¯•ï¼š<br>è§£å†³å¾ªç¯å¼•ç”¨ï¼Œä¸»è¦æµ‹è¯•å¤–éƒ¨æ¥å£","like_count":0},{"had_liked":false,"id":333284,"user_name":"coyang","can_delete":false,"product_type":"c1","uid":1024805,"ip_address":"","ucode":"563687E0F6A441","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a3/25/5da16c25.jpg","comment_is_top":false,"comment_ctime":1644245371,"is_pvip":true,"replies":[{"id":"123446","content":"ä»£ç æµ‹è¯•ï¼ˆä¸‹ï¼‰ï¼šGo è¯­è¨€å…¶ä»–æµ‹è¯•ç±»å‹åŠ IAM æµ‹è¯•ä»‹ç» è¿™ä¸€è®²æœ‰ä»‹ç»","user_name":"ä½œè€…å›å¤","comment_id":333284,"uid":"1167883","ip_address":"","utype":1,"ctime":1647039507,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1644245371","product_id":100079601,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·é—®goå¸¸ç”¨&#47;å¥½ç”¨çš„mockæ¡†æ¶æœ‰ä»€ä¹ˆæ¨èçš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555706,"discussion_content":"ä»£ç æµ‹è¯•ï¼ˆä¸‹ï¼‰ï¼šGo è¯­è¨€å…¶ä»–æµ‹è¯•ç±»å‹åŠ IAM æµ‹è¯•ä»‹ç» è¿™ä¸€è®²æœ‰ä»‹ç»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647039508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331972,"user_name":"Struggle~honor","can_delete":false,"product_type":"c1","uid":1975831,"ip_address":"","ucode":"EBC6DFC6CF0973","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rSzzqGwHcvhwPejiaPsCY9XBX7ib7zTxJ6cUDORdhGIakX8dTPVsz6ibud5ec1FeWQGTseF2TPRECCjky5JMlHvDg/132","comment_is_top":false,"comment_ctime":1642929591,"is_pvip":false,"replies":[{"id":"121552","content":"666","user_name":"ä½œè€…å›å¤","comment_id":331972,"uid":"1167883","ip_address":"","utype":1,"ctime":1643454707,"user_name_real":"ç¼–è¾‘"}],"discussion_count":1,"race_medal":0,"score":"1642929591","product_id":100079601,"comment_content":"vscodeå¯ä»¥ç”Ÿæˆæµ‹è¯•ä»£ç ","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548945,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643454707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324759,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1638605189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638605189","product_id":100079601,"comment_content":"æ€»ç»“ï¼š<br>ä»‹ç»äº†å•å…ƒæµ‹è¯•è§„èŒƒå’Œæ€§èƒ½æµ‹è¯•è§„èŒƒ<br>ä½¿ç”¨ github.com&#47;stretchr&#47;testify&#47;assert åšç»“æœå¯¹æ¯”<br>ä½¿ç”¨ gotests è‡ªåŠ¨ç”Ÿæˆ table driven test<br>æ€§èƒ½æµ‹è¯•é»˜è®¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œé‡è¦å‚æ•°æœ‰ benchmem, benchtime, cpu, timeout","like_count":0},{"had_liked":false,"id":323850,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":2851087,"ip_address":"","ucode":"63E53446007D1F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/81/0f/f8ced7d9.jpg","comment_is_top":false,"comment_ctime":1638180925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638180925","product_id":100079601,"comment_content":"go testçœŸçš„å¤ªç²—ç³™äº†","like_count":1},{"had_liked":false,"id":311159,"user_name":"éšé£è€Œè¿‡","can_delete":false,"product_type":"c1","uid":2654999,"ip_address":"","ucode":"FFD17BAA3B2312","user_header":"https://static001.geekbang.org/account/avatar/00/28/83/17/df99b53d.jpg","comment_is_top":false,"comment_ctime":1631090841,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631090841","product_id":100079601,"comment_content":"é‡‘èé¡¹ç›®éœ€è¦å¤§é‡çš„ç™½ç›’æµ‹è¯•ï¼Œappé¡¹ç›®å°±æ˜¯å¸¸è§çš„é»‘ç›’æµ‹è¯•","like_count":1},{"had_liked":false,"id":308916,"user_name":"æˆäººä»¥ğŸŸï¼Œä¸å¦‚æˆäººä»¥æ¸”","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1629859733,"is_pvip":true,"replies":[{"id":"112019","content":"å‰é¢çš„æ›´å‡†ç¡®","user_name":"ä½œè€…å›å¤","comment_id":308916,"uid":"1167883","ip_address":"","utype":1,"ctime":1630113083,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"1629859733","product_id":100079601,"comment_content":"åœ¨â€œå¦‚ä½•æµ‹è¯•Goä»£ç ï¼Ÿâ€è¿™èŠ‚çš„å¼€å¤´ï¼Œâ€œé»˜è®¤ä¼šé€‰æ‹©æ‰§è¡Œå‘½ä»¤æ—¶æ‰€åœ¨çš„åŒ…â€ï¼Œä¿®æ”¹ä¸ºâ€œé»˜è®¤ä¼šé€‰æ‹©æ‰§è¡Œå‘½åæ—¶æ‰€åœ¨çš„ç›®å½•â€å¯èƒ½ä¼šå®¹æ˜“ç†è§£ã€‚","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525681,"discussion_content":"å‰é¢çš„æ›´å‡†ç¡®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630113083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}