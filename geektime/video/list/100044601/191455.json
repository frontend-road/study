{"id":191455,"title":"09 | 命令行配置提供程序：最简单快捷的配置注入方法","content":"<p><strong>各位亲爱的学员：</strong><br>\n推荐大家阅读一下配置框架的源码，代码量虽然不多，但这里面有不少可以借鉴的设计方法和代码风格，另外其中有一个ChainedConfigurationProvider，是课程里没有提到的，可以思考一下这个提供程序的使用场景。<br>\n源码下载地址：<a href=\"https://github.com/dotnet/extensions\">https://github.com/dotnet/extensions</a></p><p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/NET-Core\">https://gitee.com/geektime-geekbang/NET-Core</a></p>","comments":[{"had_liked":false,"id":195565,"user_name":"爱学习的大叔","can_delete":false,"product_type":"c3","uid":1085152,"ip_address":"","ucode":"91F9ABF1EC98D0","user_header":"https://static001.geekbang.org/account/avatar/00/10/8e/e0/847348b1.jpg","comment_is_top":false,"comment_ctime":1585197873,"is_pvip":false,"replies":[{"id":77164,"content":"感谢支持","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1586876814,"ip_address":"","comment_id":195565,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师讲的很不错","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489111,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586876814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183087,"user_name":"Coding中的小姚","can_delete":false,"product_type":"c3","uid":1350445,"ip_address":"","ucode":"C172F4BFE212C3","user_header":"https://static001.geekbang.org/account/avatar/00/14/9b/2d/f2aa5ba0.jpg","comment_is_top":false,"comment_ctime":1582950160,"is_pvip":false,"replies":[{"id":70978,"content":"支持","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1583043706,"ip_address":"","comment_id":183087,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"命令行配置也可以使用分组吗？如果可以那格式是否是这样 --key=section:value","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485558,"discussion_content":"支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583043706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180351,"user_name":"K","can_delete":false,"product_type":"c3","uid":1815324,"ip_address":"","ucode":"CD8059C5AEFD6A","user_header":"https://static001.geekbang.org/account/avatar/00/1b/b3/1c/6649d358.jpg","comment_is_top":false,"comment_ctime":1582265591,"is_pvip":false,"replies":[{"id":70286,"content":"可以借助这个接口IHttpContextAccessor","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1582523831,"ip_address":"","comment_id":180351,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"请问下老师，在服务层 如何获取到当前请求域名，我要根据域名分库","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484621,"discussion_content":"可以借助这个接口IHttpContextAccessor","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582523831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176757,"user_name":"﹏ℳ๓₯㎕  cY","can_delete":false,"product_type":"c3","uid":1808866,"ip_address":"","ucode":"F69E1EA12DE464","user_header":"https://static001.geekbang.org/account/avatar/00/1b/99/e2/9148e474.jpg","comment_is_top":false,"comment_ctime":1581155599,"is_pvip":false,"replies":[{"id":68931,"content":"docker run  image:tag  --arg1=abc --arg2=efg","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1581426263,"ip_address":"","comment_id":176757,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"肖老师，请问下程序启动时附带的参数注入，如果把程序部署到docker中，run的时候这些参数需要怎么编写","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483202,"discussion_content":"docker run  image:tag  --arg1=abc --arg2=efg","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581426263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1808866,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/99/e2/9148e474.jpg","nickname":"﹏ℳ๓₯㎕  cY","note":"","ucode":"F69E1EA12DE464","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":167899,"discussion_content":"谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581522638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175432,"user_name":"熙","can_delete":false,"product_type":"c3","uid":1084863,"ip_address":"","ucode":"6D13CDBEA5CDDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/8d/bf/507144e8.jpg","comment_is_top":false,"comment_ctime":1580718173,"is_pvip":false,"replies":[{"id":68387,"content":"感谢指正，准确的表述是这样的：\n\n1. 当不使用单划线 (-) 或双划线 (--) 前缀时，必须使用等号连字符。\n\n2.替换命令支持单划线 (-) 或双划线 (--) ，这个前缀在switchMappings中注册的前缀必须是对应的。\n","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1580892878,"ip_address":"","comment_id":175432,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，有2个疑问，\n1、您提到备注: 等号分隔符和空格分隔符不能混用   （实践证明混用没问题，依然呢能够读取到正确的配置）。\n2、命令替换模式\n必须以单划线 (-) 或双划线 (--) 开头 （实践证明双划线不能实现替换，双划线会当做一个新的配置）","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482729,"discussion_content":"感谢指正，准确的表述是这样的：\n\n1. 当不使用单划线 (-) 或双划线 (--) 前缀时，必须使用等号连字符。\n\n2.替换命令支持单划线 (-) 或双划线 (--) ，这个前缀在switchMappings中注册的前缀必须是对应的。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580892878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174317,"user_name":"Listener","can_delete":false,"product_type":"c3","uid":1197590,"ip_address":"","ucode":"520C8DFA8AD919","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/16/bf528ab1.jpg","comment_is_top":false,"comment_ctime":1580138137,"is_pvip":false,"replies":[{"id":67829,"content":"感谢支持","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1580269050,"ip_address":"","comment_id":174317,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"肖老师辛苦了 注意身体","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482368,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580269050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307432,"user_name":"O.R.E.A","can_delete":false,"product_type":"c3","uid":2228597,"ip_address":"","ucode":"F4C51D00BEB9C8","user_header":"https://static001.geekbang.org/account/avatar/00/22/01/75/4c5b10b2.jpg","comment_is_top":false,"comment_ctime":1629099297,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"为什么我的应用程序参数不能换行","like_count":0},{"had_liked":false,"id":302973,"user_name":"؞并亲了你一大口؞随风去","can_delete":false,"product_type":"c3","uid":2257640,"ip_address":"","ucode":"38E6F3660783D7","user_header":"https://static001.geekbang.org/account/avatar/00/22/72/e8/da3c644f.jpg","comment_is_top":false,"comment_ctime":1626489230,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"如果不加Console.ReadKey();阻塞的话，正常到后面这句：CreateHostBuilder(args).Build().Run();会报错。System.FormatException:“The short switch &#39;-k1=abc&#39; is not defined in the switch mappings.”","like_count":0},{"had_liked":false,"id":238820,"user_name":"shum","can_delete":false,"product_type":"c3","uid":1200530,"ip_address":"","ucode":"7496242486AB71","user_header":"","comment_is_top":false,"comment_ctime":1596333225,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师您好、我之前买了这个课程、现在没有了！怎么才能添加回来？","like_count":0},{"had_liked":false,"id":238558,"user_name":"Oops","can_delete":false,"product_type":"c3","uid":1162415,"ip_address":"","ucode":"C86267E8296C09","user_header":"https://static001.geekbang.org/account/avatar/00/11/bc/af/2b8797b1.jpg","comment_is_top":false,"comment_ctime":1596197909,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，请教一下，像dotnet 后面跟的没有- 也没有--  的命令（add 或者 build） 是怎么实现的。","like_count":0}]}