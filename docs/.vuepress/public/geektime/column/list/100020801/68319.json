{"id":68319,"title":"01 | 基础架构：一条SQL查询语句是如何执行的？","content":"<p>你好，我是林晓斌。</p><p>这是专栏的第一篇文章，我想来跟你聊聊MySQL的基础架构。我们经常说，看一个事儿千万不要直接陷入细节里，你应该先鸟瞰其全貌，这样能够帮助你从高维度理解问题。同样，对于MySQL的学习也是这样。平时我们使用数据库，看到的通常都是一个整体。比如，你有个最简单的表，表里只有一个ID字段，在执行下面这个查询语句时：</p><pre><code>mysql&gt; select * from T where ID=10；\n</code></pre><p>我们看到的只是输入一条语句，返回一个结果，却不知道这条语句在MySQL内部的执行过程。</p><p>所以今天我想和你一起把MySQL拆解一下，看看里面都有哪些“零件”，希望借由这个拆解过程，让你对MySQL有更深入的理解。这样当我们碰到MySQL的一些异常或者问题时，就能够直戳本质，更为快速地定位并解决问题。</p><p>下面我给出的是MySQL的基本架构示意图，从中你可以清楚地看到SQL语句在MySQL的各个功能模块中的执行过程。</p><p><img src=\"https://static001.geekbang.org/resource/image/0d/d9/0d2070e8f84c4801adbfa03bda1f98d9.png?wh=1920*1440\" alt=\"\"></p><center><span class=\"reference\">MySQL的逻辑架构图</span></center><p>大体来说，MySQL可以分为Server层和存储引擎层两部分。</p><p>Server层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖MySQL的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。</p><!-- [[[read_end]]] --><p>而存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持InnoDB、MyISAM、Memory等多个存储引擎。现在最常用的存储引擎是InnoDB，它从MySQL 5.5.5版本开始成为了默认存储引擎。</p><p>也就是说，你执行create table建表的时候，如果不指定引擎类型，默认使用的就是InnoDB。不过，你也可以通过指定存储引擎的类型来选择别的引擎，比如在create table语句中使用engine=memory, 来指定使用内存引擎创建表。不同存储引擎的表数据存取方式不同，支持的功能也不同，在后面的文章中，我们会讨论到引擎的选择。</p><p>从图中不难看出，不同的存储引擎共用一个<strong>Server层</strong>，也就是从连接器到执行器的部分。你可以先对每个组件的名字有个印象，接下来我会结合开头提到的那条SQL语句，带你走一遍整个执行流程，依次看下每个组件的作用。</p><h1>连接器</h1><p>第一步，你会先连接到这个数据库上，这时候接待你的就是连接器。连接器负责跟客户端建立连接、获取权限、维持和管理连接。连接命令一般是这么写的：</p><pre><code>mysql -h$ip -P$port -u$user -p\n</code></pre><p>输完命令之后，你就需要在交互对话里面输入密码。虽然密码也可以直接跟在-p后面写在命令行中，但这样可能会导致你的密码泄露。如果你连的是生产服务器，强烈建议你不要这么做。</p><p>连接命令中的mysql是客户端工具，用来跟服务端建立连接。在完成经典的TCP握手后，连接器就要开始认证你的身份，这个时候用的就是你输入的用户名和密码。</p><ul>\n<li>如果用户名或密码不对，你就会收到一个\"Access denied for user\"的错误，然后客户端程序结束执行。</li>\n<li>如果用户名密码认证通过，连接器会到权限表里面查出你拥有的权限。之后，这个连接里面的权限判断逻辑，都将依赖于此时读到的权限。</li>\n</ul><p>这就意味着，一个用户成功建立连接后，即使你用管理员账号对这个用户的权限做了修改，也不会影响已经存在连接的权限。修改完成后，只有再新建的连接才会使用新的权限设置。</p><p>连接完成后，如果你没有后续的动作，这个连接就处于空闲状态，你可以在show processlist命令中看到它。文本中这个图是show processlist的结果，其中的Command列显示为“Sleep”的这一行，就表示现在系统里面有一个空闲连接。</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/ed/f2da4aa3a672d48ec05df97b9f992fed.png?wh=875*163\" alt=\"\"><br>\n客户端如果太长时间没动静，连接器就会自动将它断开。这个时间是由参数wait_timeout控制的，默认值是8小时。</p><p>如果在连接被断开之后，客户端再次发送请求的话，就会收到一个错误提醒： Lost connection to MySQL server during query。这时候如果你要继续，就需要重连，然后再执行请求了。</p><p>数据库里面，长连接是指连接成功后，如果客户端持续有请求，则一直使用同一个连接。短连接则是指每次执行完很少的几次查询就断开连接，下次查询再重新建立一个。</p><p>建立连接的过程通常是比较复杂的，所以我建议你在使用中要尽量减少建立连接的动作，也就是尽量使用长连接。</p><p>但是全部使用长连接后，你可能会发现，有些时候MySQL占用内存涨得特别快，这是因为MySQL在执行过程中临时使用的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放。所以如果长连接累积下来，可能导致内存占用太大，被系统强行杀掉（OOM），从现象看就是MySQL异常重启了。</p><p>怎么解决这个问题呢？你可以考虑以下两种方案。</p><ol>\n<li>\n<p>定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连。</p>\n</li>\n<li>\n<p>如果你用的是MySQL 5.7或更新版本，可以在每次执行一个比较大的操作后，通过执行 mysql_reset_connection来重新初始化连接资源。这个过程不需要重连和重新做权限验证，但是会将连接恢复到刚刚创建完时的状态。</p>\n</li>\n</ol><h1>查询缓存</h1><p>连接建立完成后，你就可以执行select语句了。执行逻辑就会来到第二步：查询缓存。</p><p>MySQL拿到一个查询请求后，会先到查询缓存看看，之前是不是执行过这条语句。之前执行过的语句及其结果可能会以key-value对的形式，被直接缓存在内存中。key是查询的语句，value是查询的结果。如果你的查询能够直接在这个缓存中找到key，那么这个value就会被直接返回给客户端。</p><p>如果语句不在查询缓存中，就会继续后面的执行阶段。执行完成后，执行结果会被存入查询缓存中。你可以看到，如果查询命中缓存，MySQL不需要执行后面的复杂操作，就可以直接返回结果，这个效率会很高。</p><p><strong>但是大多数情况下我会建议你不要使用查询缓存，为什么呢？因为查询缓存往往弊大于利。</strong></p><p>查询缓存的失效非常频繁，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。因此很可能你费劲地把结果存起来，还没使用呢，就被一个更新全清空了。对于更新压力大的数据库来说，查询缓存的命中率会非常低。除非你的业务就是有一张静态表，很长时间才会更新一次。比如，一个系统配置表，那这张表上的查询才适合使用查询缓存。</p><p>好在MySQL也提供了这种“按需使用”的方式。你可以将参数query_cache_type设置成DEMAND，这样对于默认的SQL语句都不使用查询缓存。而对于你确定要使用查询缓存的语句，可以用SQL_CACHE显式指定，像下面这个语句一样：</p><pre><code>mysql&gt; select SQL_CACHE * from T where ID=10；\n</code></pre><p>需要注意的是，MySQL 8.0版本直接将查询缓存的整块功能删掉了，也就是说8.0开始彻底没有这个功能了。</p><h1>分析器</h1><p>如果没有命中查询缓存，就要开始真正执行语句了。首先，MySQL需要知道你要做什么，因此需要对SQL语句做解析。</p><p>分析器先会做“词法分析”。你输入的是由多个字符串和空格组成的一条SQL语句，MySQL需要识别出里面的字符串分别是什么，代表什么。</p><p>MySQL从你输入的\"select\"这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名T”，把字符串“ID”识别成“列ID”。</p><p>做完了这些识别以后，就要做“语法分析”。根据词法分析的结果，语法分析器会根据语法规则，判断你输入的这个SQL语句是否满足MySQL语法。</p><p>如果你的语句不对，就会收到“You have an error in your SQL syntax”的错误提醒，比如下面这个语句select少打了开头的字母“s”。</p><pre><code>mysql&gt; elect * from t where ID=1;\n\nERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'elect * from t where ID=1' at line 1\n</code></pre><p>一般语法错误会提示第一个出现错误的位置，所以你要关注的是紧接“use near”的内容。</p><h1>优化器</h1><p>经过了分析器，MySQL就知道你要做什么了。在开始执行之前，还要先经过优化器的处理。</p><p>优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。比如你执行下面这样的语句，这个语句是执行两个表的join：</p><pre><code>mysql&gt; select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;\n</code></pre><ul>\n<li>既可以先从表t1里面取出c=10的记录的ID值，再根据ID值关联到表t2，再判断t2里面d的值是否等于20。</li>\n<li>也可以先从表t2里面取出d=20的记录的ID值，再根据ID值关联到t1，再判断t1里面c的值是否等于10。</li>\n</ul><p>这两种执行方法的逻辑结果是一样的，但是执行的效率会有不同，而优化器的作用就是决定选择使用哪一个方案。</p><p>优化器阶段完成后，这个语句的执行方案就确定下来了，然后进入执行器阶段。如果你还有一些疑问，比如优化器是怎么选择索引的，有没有可能选择错等等，没关系，我会在后面的文章中单独展开说明优化器的内容。</p><h1>执行器</h1><p>MySQL通过分析器知道了你要做什么，通过优化器知道了该怎么做，于是就进入了执行器阶段，开始执行语句。</p><p>开始执行的时候，要先判断一下你对这个表T有没有执行查询的权限，如果没有，就会返回没有权限的错误，如下所示(在工程实现上，如果命中查询缓存，会在查询缓存返回结果的时候，做权限验证。查询也会在优化器之前调用precheck验证权限)。</p><pre><code>mysql&gt; select * from T where ID=10;\n\nERROR 1142 (42000): SELECT command denied to user 'b'@'localhost' for table 'T'\n</code></pre><p>如果有权限，就打开表继续执行。打开表的时候，执行器就会根据表的引擎定义，去使用这个引擎提供的接口。</p><p>比如我们这个例子中的表T中，ID字段没有索引，那么执行器的执行流程是这样的：</p><ol>\n<li>\n<p>调用InnoDB引擎接口取这个表的第一行，判断ID值是不是10，如果不是则跳过，如果是则将这行存在结果集中；</p>\n</li>\n<li>\n<p>调用引擎接口取“下一行”，重复相同的判断逻辑，直到取到这个表的最后一行。</p>\n</li>\n<li>\n<p>执行器将上述遍历过程中所有满足条件的行组成的记录集作为结果集返回给客户端。</p>\n</li>\n</ol><p>至此，这个语句就执行完成了。</p><p>对于有索引的表，执行的逻辑也差不多。第一次调用的是“取满足条件的第一行”这个接口，之后循环取“满足条件的下一行”这个接口，这些接口都是引擎中已经定义好的。</p><p>你会在数据库的慢查询日志中看到一个rows_examined的字段，表示这个语句执行过程中扫描了多少行。这个值就是在执行器每次调用引擎获取数据行的时候累加的。</p><p>在有些场景下，执行器调用一次，在引擎内部则扫描了多行，因此<strong>引擎扫描行数跟rows_examined并不是完全相同的。</strong>我们后面会专门有一篇文章来讲存储引擎的内部机制，里面会有详细的说明。</p><h1>小结</h1><p>今天我给你介绍了MySQL的逻辑架构，希望你对一个SQL语句完整执行流程的各个阶段有了一个初步的印象。由于篇幅的限制，我只是用一个查询的例子将各个环节过了一遍。如果你还对每个环节的展开细节存有疑问，也不用担心，后续在实战章节中我还会再提到它们。</p><p>我给你留一个问题吧，如果表T中没有字段k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？</p><p>感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p><p></p>","neighbors":{"left":{"article_title":"开篇词 | 这一次，让我们一起来搞懂MySQL","id":67888},"right":{"article_title":"02  | 日志系统：一条SQL更新语句是如何执行的？","id":68633}},"comments":[{"had_liked":false,"id":39796,"user_name":"林晓斌","can_delete":false,"product_type":"c1","uid":1264162,"ip_address":"","ucode":"CDE42D44F26240","user_header":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","comment_is_top":true,"comment_ctime":1542357696,"is_pvip":false,"discussion_count":9,"race_medal":0,"score":"9.2233750964138004e+18","product_id":100020801,"comment_content":"感谢大家的积极评论。<br>答案是分析器。<br>@threefat 提到Oracle，MySQL确实在设计上受Oracle影响颇深。<br>@圈圈圆圆  高性能MySQL里面概念学得好。<br>@Yezhiwei 等几位，说正文里面已经暗示答案的同学，你们这么机智👍🏿<br><br>后面每期的问题，我们会在下一期的结尾的给出解释，不过只是“参考”哦，以评论区的质量，我估计到时候只需要引用优秀评论就好了 ^_^<br>","like_count":713,"discussions":[{"author":{"id":1202174,"avatar":"https://static001.geekbang.org/account/avatar/00/12/57/fe/beab006d.jpg","nickname":"Jasper","note":"","ucode":"A07ABF45D39089","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335685,"discussion_content":"我是第500个赞，不知不觉两年过去了，重新看一遍","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1608272364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1340481,"avatar":"https://static001.geekbang.org/account/avatar/00/14/74/41/38e7e2e0.jpg","nickname":"不二王","note":"","ucode":"5FE4D855FD5945","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548023,"discussion_content":"文中有说在词法阶段分析出每个字符串分别是什么，代表什么，我理解“elect”命令在词法分析的时候应该就会过不了？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1642996347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2011564,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b1/ac/c08d9833.jpg","nickname":"小青龙猪儿虫","note":"","ucode":"000CDF9BFEB7B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282266,"discussion_content":"老师，请问判断unknown column是在分析器的词法阶段报错的吗？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591932706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2011564,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b1/ac/c08d9833.jpg","nickname":"小青龙猪儿虫","note":"","ucode":"000CDF9BFEB7B6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296610,"discussion_content":"个人觉得是的 \n因它在识别字符串“k=1”的时候发现 并没有K这一列 所以就抛出错误！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596602380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":282266,"ip_address":""},"score":296610,"extra":""},{"author":{"id":2625319,"avatar":"","nickname":"Geek_c2f914","note":"","ucode":"EF3214A0842D5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2011564,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b1/ac/c08d9833.jpg","nickname":"小青龙猪儿虫","note":"","ucode":"000CDF9BFEB7B6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374620,"discussion_content":"这就是老师布置的问题嘛，在分析器的词法阶段报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621269075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":282266,"ip_address":""},"score":374620,"extra":""},{"author":{"id":1019610,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/da/58066080.jpg","nickname":"张辉","note":"","ucode":"CFBD4F1BEAC70B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2011564,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/b1/ac/c08d9833.jpg","nickname":"小青龙猪儿虫","note":"","ucode":"000CDF9BFEB7B6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388946,"discussion_content":"没错，词法分析会将字符串转换为对应的表，列","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629077344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":282266,"ip_address":""},"score":388946,"extra":""}]},{"author":{"id":2066081,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/86/a1/1e474eb9.jpg","nickname":"Manfestain","note":"","ucode":"66DC6802F502E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372736,"discussion_content":"有个问题，那如果select写成了elect，那在词法分析时还会认为这是一条查询语句吗，文中说这种情况在语法分析的时候会报错，求解答","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620447153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2974200,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/61/f8/783896e3.jpg","nickname":"出云","note":"","ucode":"88EC2292532E88","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":2066081,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/86/a1/1e474eb9.jpg","nickname":"Manfestain","note":"","ucode":"66DC6802F502E6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583509,"discussion_content":"语法分析就会报错了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1660157978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":372736,"ip_address":"湖南"},"score":583509,"extra":""}]},{"author":{"id":1184406,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyibojtJCnzALT1CleOHlTfS1XpFQHibXA7B2j631I2icHL2Uy5XvvviaEXBWPSNkU5G7LQP3JJHicgzQ/132","nickname":"邹","note":"","ucode":"06BB69F19CA34F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344264,"discussion_content":"报错不会缓存吗？如果有缓存是不是会走缓存？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611374618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39178,"user_name":"threefat","can_delete":false,"product_type":"c1","uid":1302597,"ip_address":"","ucode":"40F2C04FB0AE09","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq2fAjzw4bRgOory5XZqlTbSic7p4MmlK6g4wIdQ5628frjibBZ9QyAHrjqnm0TYaO1rePpiaoSv6xzQ/132","comment_is_top":true,"comment_ctime":1542204496,"is_pvip":false,"replies":[{"id":"13991","content":"MySQL确实在设计上受Oracle影响颇深。就是这样哈，分析器做了这个工作。另外有评论里面举例高性能MySQL 里面概念的同学、说正文里面已经暗示答案的同学，远程点赞了哈😄😄 就喜欢你们这么机智的回答👍🏿","user_name":"作者回复","comment_id":39178,"uid":"1264162","ip_address":"","utype":1,"ctime":1542208098,"user_name_real":"林晓斌"}],"discussion_count":7,"race_medal":0,"score":"9.2233734986859008e+18","product_id":100020801,"comment_content":"课后答案:分析器。Oracle会在分析阶段判断语句是否正确，表是否存在，列是否存在等。猜测MySQL也这样。","like_count":340,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428955,"discussion_content":"MySQL确实在设计上受Oracle影响颇深。就是这样哈，分析器做了这个工作。另外有评论里面举例高性能MySQL 里面概念的同学、说正文里面已经暗示答案的同学，远程点赞了哈😄😄 就喜欢你们这么机智的回答👍🏿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542208098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"汉江","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334707,"discussion_content":"有一次面试刚好问到这个问题 ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1607947560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324099,"avatar":"https://static001.geekbang.org/account/avatar/00/14/34/43/941d62a0.jpg","nickname":"Decadent゜","note":"","ucode":"46CECD6635754E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318945,"discussion_content":"分析器应该读取的是frm文件中的数据库元数据吧","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603888333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214640,"discussion_content":"我也是这么考虑的，不是因为Oracle，而是按照Java的编译执行流程在思路上做个对照","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585221285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1170670,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dc/ee/8fb92613.jpg","nickname":"晏鹏","note":"","ucode":"D23BC3B61C257E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338239,"discussion_content":"说明程序原理都是相通的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609221254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214640,"ip_address":""},"score":338239,"extra":""},{"author":{"id":1170670,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dc/ee/8fb92613.jpg","nickname":"晏鹏","note":"","ucode":"D23BC3B61C257E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338240,"discussion_content":"不过与编程语言类比也不一定正确，因为Java是强类型语言，而且是先编译后执行。对于解释型的弱类型语言，好像哪怕使用了一个不存在的局部变量，也只有到了执行的时候才会报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609221347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214640,"ip_address":""},"score":338240,"extra":""},{"author":{"id":2739334,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/CV9kk5M26pdxvFhbrkicjZVuYxSG4vLNcqBzlESUUz2g9mavJ9cf0R4rbow27ZMLXqNted3dKmel8W83Kb2geLw/132","nickname":"Geek_9ee170","note":"","ucode":"273408D8885694","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1170670,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dc/ee/8fb92613.jpg","nickname":"晏鹏","note":"","ucode":"D23BC3B61C257E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389774,"discussion_content":"Java其实也是解释执行的，只不过解释执行是由虚拟机来实现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629428385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":338240,"ip_address":""},"score":389774,"extra":""}]}]},{"had_liked":true,"id":38851,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":true,"comment_ctime":1542154406,"is_pvip":true,"replies":[{"id":"13906","content":"“不是执行器”这一点，你分析得很好😄","user_name":"作者回复","comment_id":38851,"uid":"1264162","ip_address":"","utype":1,"ctime":1542160511,"user_name_real":"林晓斌"}],"discussion_count":17,"race_medal":1,"score":"9.2233731765633004e+18","product_id":100020801,"comment_content":"我认为是优化器的，优化器会进行优化分析，比如用先执行哪个条件，使用哪个索引。如果没有对应的字段就会报错的，我看其他评论说是执行器，原因是这个时候才打开表获取数据，但是表的字段不是数据啊，是事先定义好的，所以可以直接读取的，不需要打开表。这是我的看法，希望老师点评一下是否正确","like_count":265,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428829,"discussion_content":"“不是执行器”这一点，你分析得很好😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542160511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2173148,"avatar":"https://static001.geekbang.org/account/avatar/00/21/28/dc/759cd1d4.jpg","nickname":"Geek_10327","note":"","ucode":"A435B9445F436C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305329,"discussion_content":"字段不是数据，不需要在执行器阶段读取，有道理!","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1599880428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1809802,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/8a/a2d34896.jpg","nickname":"一元(wx:abley1874)","note":"","ucode":"5E7A33642FC767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300957,"discussion_content":"我一开始也觉得是优化器，因为优化器阶段就需要决定使用哪个索引了，说明该阶段或者之前就肯定对字段进行了分析。但答案是分析器有些让人不好理解。按照文章所述分析器仅仅是对sql的语法分析和词法分析而已呀！希望后面的学习能让我恍然大悟起来","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1598341173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1259853,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/4d/9ce28826.jpg","nickname":"luxinfeng","note":"","ucode":"51D0046C4D31AD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1809802,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/9d/8a/a2d34896.jpg","nickname":"一元(wx:abley1874)","note":"","ucode":"5E7A33642FC767","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410485,"discussion_content":"分析器在词法分析阶段，需要知道SQL中的每个字段代表什么意思，所以在这个阶段就可以判断表中存不存在k这一列","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1635693874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300957,"ip_address":""},"score":410485,"extra":""}]},{"author":{"id":2098652,"avatar":"https://static001.geekbang.org/account/avatar/00/20/05/dc/b501933a.jpg","nickname":"有手也不行","note":"","ucode":"D55D23A2C4517E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388405,"discussion_content":"其实不看答案我也这么想的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628753428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1459774,"avatar":"https://static001.geekbang.org/account/avatar/00/16/46/3e/8c75af6d.jpg","nickname":"Z东","note":"","ucode":"037B2BB2715DBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589655,"discussion_content":"逻辑分层，界限清晰，分析器的的定义 就是分析验证输入的sql 的正确性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665222297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1459774,"avatar":"https://static001.geekbang.org/account/avatar/00/16/46/3e/8c75af6d.jpg","nickname":"Z东","note":"","ucode":"037B2BB2715DBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589654,"discussion_content":"其实按我们写api逻辑来思考，验证后的数据是可靠的，在下一层的调用应该是正确的数据。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665222164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2692533,"avatar":"https://static001.geekbang.org/account/avatar/00/29/15/b5/eadd6834.jpg","nickname":"乐缘，青苹果","note":"","ucode":"47309865FD3158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587082,"discussion_content":"要是有的表没有索引的情况,那在优化器这里判断字段是否存在就行不通了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662776634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2713546,"avatar":"","nickname":"Geek_2c6fcd","note":"","ucode":"7A3AF7815351F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583978,"discussion_content":"不需要执行器，那么表字段的信息存储在哪里呢，不是在存储引擎吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660543000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/70/f5845602.jpg","nickname":"A梦多啦A","note":"","ucode":"026669D6CACA8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326686,"discussion_content":"执行器，就可以理解为单纯的去拿数据。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605662726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073115,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/db/8d2b5604.jpg","nickname":"hisoka","note":"","ucode":"38CA3F8E0430D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284784,"discussion_content":"说的好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592636058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":146109,"discussion_content":"是分析器吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579597926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1397058,"avatar":"https://static001.geekbang.org/account/avatar/00/15/51/42/47808b22.jpg","nickname":"HALOXIAO","note":"","ucode":"8EC17EC85EF2D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202311,"discussion_content":"分析器只是对语法进行分析，不涉及字段\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583895963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":146109,"ip_address":""},"score":202311,"extra":""},{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1397058,"avatar":"https://static001.geekbang.org/account/avatar/00/15/51/42/47808b22.jpg","nickname":"HALOXIAO","note":"","ucode":"8EC17EC85EF2D4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214639,"discussion_content":"分析器应该会获取一些数据库和表的元数据吧，可以做一些简单判断：这个库是不是存在，这个库里有没有这个表等等，形成一个类似Java的抽象语法树","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1585221093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":202311,"ip_address":""},"score":214639,"extra":""},{"author":{"id":1073115,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/db/8d2b5604.jpg","nickname":"hisoka","note":"","ucode":"38CA3F8E0430D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":284785,"discussion_content":"也许","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1592636368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":146109,"ip_address":""},"score":284785,"extra":""}]},{"author":{"id":1110662,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/86/d689f77e.jpg","nickname":"Hank_Yan","note":"","ucode":"86899B561C502B","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":90528,"discussion_content":"解释很到位。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576769978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38923,"user_name":"李志博","can_delete":false,"product_type":"c1","uid":1009109,"ip_address":"","ucode":"F3C72573B3C112","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/d5/88beb15a.jpg","comment_is_top":true,"comment_ctime":1542159718,"is_pvip":false,"replies":[{"id":"13917","content":"这个后面专门有一篇《要不要用memory引擎》会说明，先说结论，redis很有必要😄","user_name":"作者回复","comment_id":38923,"uid":"1264162","ip_address":"","utype":1,"ctime":1542163519,"user_name_real":"林晓斌"}],"discussion_count":13,"race_medal":0,"score":"9.2233724850735002e+18","product_id":100020801,"comment_content":"应该是分析器吧，老师我还有个问题，如果有memory 引擎，还有redis 存在的必要吗，应该是有的吧，两者的场景？","like_count":104,"discussions":[{"author":{"id":1018224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/70/f5845602.jpg","nickname":"A梦多啦A","note":"","ucode":"026669D6CACA8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164603,"discussion_content":"虽然redis 也是存储在内存中，但可以做到持久化存储。例如rdb 或者aof 。然而MySQL 中的memory 完全是基于内存存储，无法持久化存储在硬盘中。重启MySQL ，异常服务停止，服务器重启等情况都会导致数据的丢失，","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1581185311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1624574,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c9/fe/874b172b.jpg","nickname":"benxiong","note":"","ucode":"F6498059D439D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/70/f5845602.jpg","nickname":"A梦多啦A","note":"","ucode":"026669D6CACA8A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":303332,"discussion_content":"除了 Redis 可以持久化这个特点外，我觉得更重要的是 Redi 提供的强大的数据结构，使得 Redis 很有必要。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1599212385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":164603,"ip_address":""},"score":303332,"extra":""},{"author":{"id":1018224,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/70/f5845602.jpg","nickname":"A梦多啦A","note":"","ucode":"026669D6CACA8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1624574,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c9/fe/874b172b.jpg","nickname":"benxiong","note":"","ucode":"F6498059D439D9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304828,"discussion_content":"确实数据结构是其的一个优点，但仅仅是与mysql的memory存储引擎相比，其优势在于持久化。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1599670106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303332,"ip_address":""},"score":304828,"extra":""},{"author":{"id":2339164,"avatar":"https://static001.geekbang.org/account/avatar/00/23/b1/5c/0f5c1f69.jpg","nickname":"周小小","note":"","ucode":"69417D560451CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1624574,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c9/fe/874b172b.jpg","nickname":"benxiong","note":"","ucode":"F6498059D439D9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348124,"discussion_content":"redis可以横向扩展","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612433599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":303332,"ip_address":""},"score":348124,"extra":""}]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428850,"discussion_content":"这个后面专门有一篇《要不要用memory引擎》会说明，先说结论，redis很有必要😄","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1542163519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080217,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7b/99/a69001b3.jpg","nickname":"独家记忆","note":"","ucode":"14FCEAAEA0C86E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49891,"discussion_content":"如果用memory引擎  宕机了咋办？会不会凉凉","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573647376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1459774,"avatar":"https://static001.geekbang.org/account/avatar/00/16/46/3e/8c75af6d.jpg","nickname":"Z东","note":"","ucode":"037B2BB2715DBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589657,"discussion_content":"redis 优势：单线程，分布式，持久化，数据结构 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665222532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2055809,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","nickname":"码小呆","note":"","ucode":"44532D6ABF9340","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579339,"discussion_content":"redis 天下无敌","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657358818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206229,"avatar":"https://static001.geekbang.org/account/avatar/00/12/67/d5/1b26b725.jpg","nickname":"Gopher","note":"","ucode":"3C1F9012BB486D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367739,"discussion_content":"redis 的优势不仅仅是内存，还有多种数据结构、高效的网络模型、分布式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618454574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2308968,"avatar":"","nickname":"Geek_9789da","note":"","ucode":"6A4A182A7E2C6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325536,"discussion_content":"Redis有持久化啊大哥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605341271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10103,"discussion_content":"问一下  memory  如何分布式？？？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568264960,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38803,"user_name":"圈圈圆圆","can_delete":false,"product_type":"c1","uid":1300157,"ip_address":"","ucode":"0AE37CDF18803E","user_header":"https://static001.geekbang.org/account/avatar/00/13/d6/bd/4cc3186e.jpg","comment_is_top":false,"comment_ctime":1542130106,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"2509803030970","product_id":100020801,"comment_content":"《高性能mysql》里提到解析器和预处理器。<br><br>解析器处理语法和解析查询, 生成一课对应的解析树。<br><br>预处理器进一步检查解析树的合法。比如: 数据表和数据列是否存在, 别名是否有歧义等。如果通过则生成新的解析树，再提交给优化器。<br><br>所以我觉得课后习题的错误应该发生在在分析器处理阶段&gt;_&lt;","like_count":585,"discussions":[{"author":{"id":2871068,"avatar":"","nickname":"Geek_473ac1","note":"","ucode":"3DFC437087D15A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539422,"discussion_content":"补充：高性能MYSQL，6.4.3查询优化处理","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1639711740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1478040,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/LyXoVuH1CSaLGoiaRFJQqxsB7O4Qf7ibrn49CItUicXtkUjmJ8OFfFtGdEUiczAyqjI5gl2FVuvgcQibcTvYc5y1JuA/132","nickname":"亮仔","note":"","ucode":"78703B5A4D8644","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2871068,"avatar":"","nickname":"Geek_473ac1","note":"","ucode":"3DFC437087D15A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552422,"discussion_content":"209页最上面几行有解释","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1645454775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":539422,"ip_address":""},"score":552422,"extra":""}]},{"author":{"id":1691447,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cf/37/6ed137b9.jpg","nickname":"Dunk","note":"","ucode":"A8F5AB98382719","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542198,"discussion_content":"嗯，应该是发生在一个既不是分析器也不是优化器的预处理器阶段才对，感觉答案是这个！！！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1640679759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008597,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/d5/a300899a.jpg","nickname":"杨丁","note":"","ucode":"D469B0BCA86587","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408292,"discussion_content":"确实是这样，见 第六章：查询性能优化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635218516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2557996,"avatar":"https://static001.geekbang.org/account/avatar/00/27/08/2c/96ab5c83.jpg","nickname":"EUGL","note":"","ucode":"FF7BDEFC95187A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367645,"discussion_content":"刚去看了，还真是！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618411884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214648,"discussion_content":"类似Java的词法语法分析","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585222166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38804,"user_name":"郭","can_delete":false,"product_type":"c1","uid":1306849,"ip_address":"","ucode":"1B2527DE4BC421","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoKKuJnRI0xFuHWwyXcTRJN5DSic0pGz4uOykEL7SNInMoGHgHfkhgquABeksv9dmfM6Bc42HFk0aQ/132","comment_is_top":false,"comment_ctime":1542130955,"is_pvip":false,"replies":[{"id":"13903","content":"有些时候，SQL语句要操作的表不只是SQL字面上那些。比如如果有个触发器，得在执行器阶段（过程中）才能确定。优化器阶段前是无能为力的","user_name":"作者回复","comment_id":38804,"uid":"1264162","ip_address":"","utype":1,"ctime":1542160383,"user_name_real":"林晓斌"}],"discussion_count":25,"race_medal":0,"score":"1715234082059","product_id":100020801,"comment_content":"有个问题不太明白，为什么对权限的检查不在优化器之前做？","like_count":399,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428815,"discussion_content":"有些时候，SQL语句要操作的表不只是SQL字面上那些。比如如果有个触发器，得在执行器阶段（过程中）才能确定。优化器阶段前是无能为力的","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1542160383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1632660,"avatar":"https://static001.geekbang.org/account/avatar/00/18/e9/94/a3177207.jpg","nickname":"胡嚞衎","note":"","ucode":"E8A1874AC68075","race_medal":4,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387301,"discussion_content":"1、在t1上创建了一个触发器，当t1有插入数据之后，触发器把这些输入再插入t2；\n2、给usertest在t1上授insert权限，t1和t2授select权限。\n3、此时usertest对t2并没有insert权限，但是往t1表insert插入数据并没报错而且t2也有这条数据了\n4、问题：如果在执行阶段会对触发做权限验证的话，上述现象如何解释？\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628092854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2336524,"avatar":"https://static001.geekbang.org/account/avatar/00/23/a7/0c/f4fe2ad3.jpg","nickname":"hooohooo","note":"","ucode":"E987DD67D7F574","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1632660,"avatar":"https://static001.geekbang.org/account/avatar/00/18/e9/94/a3177207.jpg","nickname":"胡嚞衎","note":"","ucode":"E8A1874AC68075","race_medal":4,"user_type":1,"is_pvip":false},"discussion":{"id":389014,"discussion_content":"以触发器创建者的权限执行？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629090689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":387301,"ip_address":""},"score":389014,"extra":""}]},{"author":{"id":1318633,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/e9/dcc63d8f.jpg","nickname":"怕什么，抱紧我","note":"","ucode":"CBCEA76E9EF33B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266249,"discussion_content":"如果先检查权限,然后检查语法,最后发现语法不对,权限的工作就白白浪费了.....","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589479696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1318633,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/e9/dcc63d8f.jpg","nickname":"怕什么，抱紧我","note":"","ucode":"CBCEA76E9EF33B","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":271522,"discussion_content":"你优化完了，发现没权限不也很尴尬吗？","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1590152407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":266249,"ip_address":""},"score":271522,"extra":""},{"author":{"id":1318633,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/e9/dcc63d8f.jpg","nickname":"怕什么，抱紧我","note":"","ucode":"CBCEA76E9EF33B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":272456,"discussion_content":"权限需要去磁盘查，查就要有io操作，语法则不需要！性能哪个更好","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1590311423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":271522,"ip_address":""},"score":272456,"extra":""},{"author":{"id":1285652,"avatar":"","nickname":"mycat","note":"","ucode":"6878BD32D042F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1318633,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/e9/dcc63d8f.jpg","nickname":"怕什么，抱紧我","note":"","ucode":"CBCEA76E9EF33B","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":300005,"discussion_content":"权限不是在建立连接的时候就已经加载到内存里面了吗？不是就在那个时候查询一次权限吗？以后的验证也都会依赖于建立连接的时候查询到的结果吗？","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1597906456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":272456,"ip_address":""},"score":300005,"extra":""}]},{"author":{"id":1113937,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/51/9d5cfadd.jpg","nickname":"好运来","note":"","ucode":"F469ED6CEFEF30","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":317591,"discussion_content":"刚好解释了我的疑惑","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603580943,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271516,"discussion_content":"看本节中，mysql逻辑架构图，是先验证权限，再语义分析，再优化的，是图有问题吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590151424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1108438,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e9/d6/07076edb.jpg","nickname":"骑着蜗牛闯红灯","note":"","ucode":"DE52170A17A463","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294885,"discussion_content":"图没有问题，图中的那个权限验证是在连接器上验证客户端连接服务端的权限，这里说的权限指的是有没有操作具体某张表的权限。譬如说你去景区旅游，先在景区门口验票，看你有没有进入里面的权限，进去后可能某个景点也是收费的，想进去也要验票！","likes_number":62,"is_delete":false,"is_hidden":false,"ctime":1596024249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":271516,"ip_address":""},"score":294885,"extra":""},{"author":{"id":1285652,"avatar":"","nickname":"mycat","note":"","ucode":"6878BD32D042F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1108438,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e9/d6/07076edb.jpg","nickname":"骑着蜗牛闯红灯","note":"","ucode":"DE52170A17A463","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300003,"discussion_content":"这个比喻太形象了","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1597906275,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":294885,"ip_address":""},"score":300003,"extra":""},{"author":{"id":2184060,"avatar":"https://static001.geekbang.org/account/avatar/00/21/53/7c/df2dc6cf.jpg","nickname":"王一鸣","note":"","ucode":"D433E46DE00278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306150,"discussion_content":"一个是访问权限，一个是具体的操作权限吧","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600181084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":271516,"ip_address":""},"score":306150,"extra":""}]},{"author":{"id":1135528,"avatar":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","nickname":"return","note":"","ucode":"42B8A3380DF04B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":86251,"discussion_content":"哈哈，本来我也想问这个问题， 原来是这个样子。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576592785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2928763,"avatar":"","nickname":"小羊","note":"","ucode":"B8A684FABC6AD6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580177,"discussion_content":"有个不成熟的类比：\n分析器：编译时异常\n执行器：运行时异常","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657956483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2846369,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/6e/a1/173e8db9.jpg","nickname":"Tintin","note":"","ucode":"A3DBD30E418EF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414457,"discussion_content":"为什么触发器在执行的时候才能确定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636773592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2308104,"avatar":"https://static001.geekbang.org/account/avatar/00/23/38/08/df42980c.jpg","nickname":"文🔪冬🐟🐑的不二心老人","note":"","ucode":"1DDB6D4D1890BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336272,"discussion_content":"我看老师的回复是有些时候，所以是有些时候在优化器之前，有些时候是在执行器打开表之前。具体看是否需要在过程中才能验证权限，这么理解OK？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608543182,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2036287,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/12/3f/aef05e00.jpg","nickname":"坚持","note":"","ucode":"E4803EA1EF078B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282011,"discussion_content":"安全性考虑，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591860936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271523,"discussion_content":"老师说的触发器是干什么的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590152500,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2014573,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/bd/6d/7010f98e.jpg","nickname":"SharpBB","note":"","ucode":"D30C5B798B8E8C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1268609,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","nickname":"lcqbug","note":"","ucode":"08FA17F21BCEC5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552594,"discussion_content":"比如你更新了某个表 用了触发器 可以关联更新另一张表 但业务上基本不大用吧 我觉得","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645521237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":271523,"ip_address":""},"score":552594,"extra":""}]},{"author":{"id":1703175,"avatar":"","nickname":"InfoQ_7ba9fcde76df","note":"","ucode":"31BF7198504579","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":268419,"discussion_content":"了解了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589772015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1487274,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","nickname":"pythonbug","note":"","ucode":"1A70CA92FFF8EB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":78521,"discussion_content":"哦，原来是这个样子的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575991135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246561,"avatar":"https://static001.geekbang.org/account/avatar/00/13/05/61/fc303f93.jpg","nickname":"颜培攀","note":"","ucode":"AC8839AB6C69F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461,"discussion_content":"有的SQL会在解析器之后precheck权限的，建库建表等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561602097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39031,"user_name":"尼古拉斯·赵四","can_delete":false,"product_type":"c1","uid":1306127,"ip_address":"","ucode":"B70B573B37BCB3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epfVZHmbUnsxU67FwotibOjM0Obc47VWMyRBmY06AjqTp0C96A8zhUULWjBerK3XtPC7Q8LVClzPxA/132","comment_is_top":false,"comment_ctime":1542174999,"is_pvip":false,"replies":[{"id":"13936","content":"这个是一个安全方面的考虑。你想想一个用户如果没有查看这个表的权限，你是会告诉他字段不对还是没权限？如果告诉他字段不对，其实给的信息太多了，因为没权限的意思还包含了：没权限知道字段是否存在😄","user_name":"作者回复","comment_id":39031,"uid":"1264162","ip_address":"","utype":1,"ctime":1542183517,"user_name_real":"林晓斌"}],"discussion_count":28,"race_medal":0,"score":"1564910270743","product_id":100020801,"comment_content":"我创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column”，是不是可以说明是在打开表之后才判断读取的列不存在？","like_count":364,"discussions":[{"author":{"id":1245034,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ff/6a/40093356.jpg","nickname":"Hyleon","note":"","ucode":"6587D74575A0B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369241,"discussion_content":"这个权限验证是在分析器阶段之后和优化器之前完成的\n\n分析器有两个过程：词法分析 和 语法解析\n\n词法分析过程拆分语句根据钩词规则识别单词，\n语法解析过程判断SQL是否满足MySQL语法，生成语法树。\n\n上面两步都没有打开表，也没有检查权限，在语法解析之后其实还有一个步骤，这一步骤里会根据一些MySQL规则进一步检查上面生成的语法树，如检查是否有表权限，表名、列名是否正确等\n\n在你提到的问题中，报错主要发生在这个阶段，检查发现没有权限，那么报错无权限，如果是一个有权限的用户，会进一步提示列不存在。\n\n后面那个解析过程有些文章里单独提出来称为“处理器”","likes_number":41,"is_delete":false,"is_hidden":false,"ctime":1618984331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2112408,"avatar":"https://static001.geekbang.org/account/avatar/00/20/3b/98/51aec344.jpg","nickname":"Garrett","note":"","ucode":"AF8242AEAB314F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1245034,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ff/6a/40093356.jpg","nickname":"Hyleon","note":"","ucode":"6587D74575A0B0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382120,"discussion_content":"记录一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625443392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369241,"ip_address":""},"score":382120,"extra":""},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1245034,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ff/6a/40093356.jpg","nickname":"Hyleon","note":"","ucode":"6587D74575A0B0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549627,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644151939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369241,"ip_address":""},"score":549627,"extra":""},{"author":{"id":2928763,"avatar":"","nickname":"小羊","note":"","ucode":"B8A684FABC6AD6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1245034,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ff/6a/40093356.jpg","nickname":"Hyleon","note":"","ucode":"6587D74575A0B0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580180,"discussion_content":"暂时理解为有双重权限判断，一个是在分析器中，一个是在执行器中。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657957601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369241,"ip_address":""},"score":580180,"extra":""}]},{"author":{"id":2104541,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7paIUwnxWN99xhC2omNeAIbKY0FhYX3ibAh85FZqQphlr97UewO51FyqeIjSg31dZ6p7S8tgKk5Q/132","nickname":"冰","note":"","ucode":"685BB45108D2DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307732,"discussion_content":"我觉得针对这个sql，mysql的执行逻辑应该是这样的。在分析器中分析出unknown column.不是立马返回给客户端，而是去执行器阶段验证该用户是否具有针对该表的操作权限，如果有。则返回 unkuown column,如果没有。则返回 select command denied.\n\n这就跟作者写的，在缓存中查询到内容之后，也不能立马将value返回给客户端，而是还要去执行器阶段验证一下该用户是否具有针对该表的操作权限，如果有，则将缓存中查询出的value返回给客户端，如果没有，则提示用户 &#34;针对该表操作的权限不够&#34;","likes_number":20,"is_delete":false,"is_hidden":false,"ctime":1600745199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1474044,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7d/fc/89286700.jpg","nickname":"jibu","note":"","ucode":"FF5CF9054EA477","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2104541,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7paIUwnxWN99xhC2omNeAIbKY0FhYX3ibAh85FZqQphlr97UewO51FyqeIjSg31dZ6p7S8tgKk5Q/132","nickname":"冰","note":"","ucode":"685BB45108D2DB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312193,"discussion_content":"合理推断！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602604807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307732,"ip_address":""},"score":312193,"extra":""},{"author":{"id":2238526,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/3e/0cc2cabe.jpg","nickname":"Z","note":"","ucode":"38350F32853CCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2104541,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7paIUwnxWN99xhC2omNeAIbKY0FhYX3ibAh85FZqQphlr97UewO51FyqeIjSg31dZ6p7S8tgKk5Q/132","nickname":"冰","note":"","ucode":"685BB45108D2DB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312981,"discussion_content":"分析器出错了，还会走到执行器这一步？应该不会了吧？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602901395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307732,"ip_address":""},"score":312981,"extra":""},{"author":{"id":2723576,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epxppZUun6eqepI5hGHjU3fP8yVIicUq7gYRZfR3PoDCMQqd2ia8CmCSa1mIIf6OYGFjbW28RCXmrJQ/132","nickname":"Geek_aef4be","note":"","ucode":"F1C3F2AE3CCA0F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2104541,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7paIUwnxWN99xhC2omNeAIbKY0FhYX3ibAh85FZqQphlr97UewO51FyqeIjSg31dZ6p7S8tgKk5Q/132","nickname":"冰","note":"","ucode":"685BB45108D2DB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586652,"discussion_content":"为什么要再去验证？难道分析器分析的不准确吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662422986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307732,"ip_address":"江苏"},"score":586652,"extra":""}]},{"author":{"id":1286231,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a0/57/8d6deacc.jpg","nickname":"陈彬","note":"","ucode":"17A57B581D682F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5276,"discussion_content":"老师，那意思在分析器分析出表名后，在这一步也需要做权限检查？那检查的范围与执行器执行时的权限检查的范围有些什么差别呢？","likes_number":17,"is_delete":false,"is_hidden":false,"ctime":1566130084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428883,"discussion_content":"这个是一个安全方面的考虑。你想想一个用户如果没有查看这个表的权限，你是会告诉他字段不对还是没权限？如果告诉他字段不对，其实给的信息太多了，因为没权限的意思还包含了：没权限知道字段是否存在😄","likes_number":12,"is_delete":false,"is_hidden":false,"ctime":1542183517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":586287,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662090622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":428883,"ip_address":"重庆"},"score":586287,"extra":""}]},{"author":{"id":2238526,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/3e/0cc2cabe.jpg","nickname":"Z","note":"","ucode":"38350F32853CCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312982,"discussion_content":"我感觉这个问题老师还是没讲清楚，是否连接器也做了表权限判断？分析器出错了还会往下走吗？还是没讲透。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1602901720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2296215,"avatar":"https://static001.geekbang.org/account/avatar/00/23/09/97/3edb25b2.jpg","nickname":"KNKP🤓","note":"","ucode":"141C69DECB74EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2238526,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/3e/0cc2cabe.jpg","nickname":"Z","note":"","ucode":"38350F32853CCB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322361,"discussion_content":"没讲透","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604731928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":312982,"ip_address":""},"score":322361,"extra":""}]},{"author":{"id":1474044,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7d/fc/89286700.jpg","nickname":"jibu","note":"","ucode":"FF5CF9054EA477","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312195,"discussion_content":"你这个问题超棒的！","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1602605105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2696996,"avatar":"https://static001.geekbang.org/account/avatar/00/29/27/24/de3db4fc.jpg","nickname":"转身","note":"","ucode":"465EF91A7793FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392310,"discussion_content":"如果没权限知道字段是否存在--那么是不是可以理解判断顺序是先看看有没有表权限 到再看字段是否存在，这和前面说的判断字段是在分析器，判断表权限是在执行器就存在冲突了吧","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1630940421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2828804,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/2a/04/bf021e49.jpg","nickname":"鹰","note":"","ucode":"5D0A0E6FBA0C74","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2696996,"avatar":"https://static001.geekbang.org/account/avatar/00/29/27/24/de3db4fc.jpg","nickname":"转身","note":"","ucode":"465EF91A7793FC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412636,"discussion_content":"认真看，权限那里说过了，有提前判断权限的机制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636223091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":392310,"ip_address":""},"score":412636,"extra":""}]},{"author":{"id":2173148,"avatar":"https://static001.geekbang.org/account/avatar/00/21/28/dc/759cd1d4.jpg","nickname":"Geek_10327","note":"","ucode":"A435B9445F436C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305482,"discussion_content":"我觉得应该是在连接器阶段就针对用户对该表有没有访问权限做出了判断，然后直接抛出 ‘select command denied’","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599960067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1201350,"avatar":"https://static001.geekbang.org/account/avatar/00/12/54/c6/c2481790.jpg","nickname":"lisiur","note":"","ucode":"CEB2DBCE29CAA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2173148,"avatar":"https://static001.geekbang.org/account/avatar/00/21/28/dc/759cd1d4.jpg","nickname":"Geek_10327","note":"","ucode":"A435B9445F436C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335206,"discussion_content":"连接器阶段还没拿到sql语句吧","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1608119390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":305482,"ip_address":""},"score":335206,"extra":""}]},{"author":{"id":1237583,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e2/4f/df01f65e.jpg","nickname":"Danfēng","note":"","ucode":"E5B3451F1D0441","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278158,"discussion_content":"这个没问题的，作者回复也是正确，就拿我们正常业务逻辑来说，前后端分离，有时候返回前端的信息也是模糊，不会说得很具体到里面去。没去看源码，但看这个报错和作者说的权限实在执行器的时候判断，而这个没有列又是在分析器的时候抛出，感觉可能就是在分析器的时候也会去执行部分需要的权限？我这个只是猜测，具体还是得去看源码","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591156725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2052088,"avatar":"","nickname":"dyh_zero","note":"","ucode":"98029D72597EF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1237583,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e2/4f/df01f65e.jpg","nickname":"Danfēng","note":"","ucode":"E5B3451F1D0441","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291637,"discussion_content":"主要是想问一下，分析器解析出字段不存在后，是否会额外判断下用户权限操作？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594894300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278158,"ip_address":""},"score":291637,"extra":""}]},{"author":{"id":1315049,"avatar":"https://static001.geekbang.org/account/avatar/00/14/10/e9/f5e55ccf.jpg","nickname":"小鬼","note":"","ucode":"52EE8A18B90C6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559649,"discussion_content":"感觉作者说的有点像我们java代码中的try catch就是一个抛错顺序的问题，其实是已经知道了对表没有查询的权限就没有必要在进行对列的抛错了，但是在语法分析的时候应该是把情况都分析出来了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1648864410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022939,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEI0ia2Dz6NRBNZIwOLbIDJQZ5dRrhMVKj8JKic3Qibh7M8Uz1Sf1akuOJSSyHUQnrbZ0OmtmRm9yGvCw/132","nickname":"feng","note":"","ucode":"5E9D36F9BC1697","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":113585,"discussion_content":"这个确实有点问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577924091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1443709,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/4uX05lCn7jZlQ7S7w6CJ8lanbSSTdx66X0bUZsdzdWx6zqwiazRhicaEjTF0DI6srTMrtKcLibe3N1xiatCfvzdTFw/132","nickname":"Geek_388a76","note":"","ucode":"7366E03EAF6DA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385731,"discussion_content":"我猜测在分析器中的流程应该是这样，首先将T识别为表名，k字段识别为对应的列，在识别列的过程中需要去表里面查看对应的列都有哪些，这时候发现压根没有查看表的权限，所以就抛出了权限异常。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627231356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2747514,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqmWLZw4Hkb5AzJxclib5Ud0Qxtd3n5o16xfqUggbFUwickG0DL5njY2dZ3Q3RjqFbbAibJicaruzRGjg/132","nickname":"小猪","note":"","ucode":"E01AAC689E572F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1443709,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/4uX05lCn7jZlQ7S7w6CJ8lanbSSTdx66X0bUZsdzdWx6zqwiazRhicaEjTF0DI6srTMrtKcLibe3N1xiatCfvzdTFw/132","nickname":"Geek_388a76","note":"","ucode":"7366E03EAF6DA6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390653,"discussion_content":"权限判断不是在执行器阶段做的嘛\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629955064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":385731,"ip_address":""},"score":390653,"extra":""}]},{"author":{"id":2238526,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/3e/0cc2cabe.jpg","nickname":"Z","note":"","ucode":"38350F32853CCB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312983,"discussion_content":"确实是一个很好的问题！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602901762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2173731,"avatar":"https://static001.geekbang.org/account/avatar/00/21/2b/23/5e6b2b8c.jpg","nickname":"Träumen","note":"","ucode":"2A5483A67B789D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305333,"discussion_content":"是不是可以这么理解，在分析器阶段出现的错误，都会告诉你没有权限，因为权限检查是在执行器阶段","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599881030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2052088,"avatar":"","nickname":"dyh_zero","note":"","ucode":"98029D72597EF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288746,"discussion_content":"这块是不是说，如果字段错误后，可能还要看用户是否有权限的判断。  再最终给出提示？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593858451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1030449,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b9/31/636e9007.jpg","nickname":"melo","note":"","ucode":"BF381B18E75867","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222704,"discussion_content":"我觉得：连接器是针对用户级别的权限，比如用户是否合法，有哪些操作权限。执行器是对数据记录进行权限校验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586168465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42734,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1543029870,"is_pvip":false,"replies":[{"id":"15297","content":"非常好👍🏿","user_name":"作者回复","comment_id":42734,"uid":"1264162","ip_address":"","utype":1,"ctime":1543041465,"user_name_real":"林晓斌"}],"discussion_count":17,"race_medal":0,"score":"1307213087854","product_id":100020801,"comment_content":"为该讲总结了几个问题, 大家复习的时候可以先尝试回答这些问题检查自己的掌握程度:<br><br>\t1. <br>MySQL的框架有几个组件, 各是什么作用? <br>\t2. <br>Server层和存储引擎层各是什么作用?<br>\t3. <br>you have an error in your SQL syntax 这个保存是在词法分析里还是在语法分析里报错?<br>\t4. <br>对于表的操作权限验证在哪里进行?<br>\t5. <br>执行器的执行查询语句的流程是什么样的? <br>","like_count":305,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430177,"discussion_content":"非常好👍🏿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543041465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1983670,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/44/b6/5979439e.jpg","nickname":"小牛刀","note":"","ucode":"487F63F5FBC03A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258061,"discussion_content":"请指教\n1.\nMySQL的框架有几个组件, 各是什么作用?\n\n连接器：负责跟客户端建立连接、获取权限、维持和管理连接。\n查询缓存：查询请求先访问缓存(key 是查询的语句，value 是查询的结果)。命中直接返回。不推荐使用缓存，更新会把缓存清除(关闭缓存：参数 query_cache_type 设置成 DEMAND)。\n分析器：对 SQL 语句做解析，判断sql是否正确。\n优化器：决定使用哪个索引，多表关联（join）的时候，决定各个表的连接顺序。\n执行器：执行语句，先判断用户有无查询权限，使用表定义的存储引擎。\n\n2.\nServer层和存储引擎层各是什么作用?\nServer 层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。\n\n存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持 InnoDB、MyISAM、Memory 等多个存储引擎。现在最常用的存储引擎是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认存储引擎。\n\n3.\nyou have an error in your SQL syntax 这个保存是在词法分析里还是在语法分析里报错?\n语法分析\n\n4.\n对于表的操作权限验证在哪里进行?\n执行器\n\n5.\n执行器的执行查询语句的流程是什么样的?\n\n1）调用 InnoDB 引擎接口取这个表的第一行，判断 ID 值是不是 10，如果不是则跳过，如果是则将这行存在结果集中；\n2)调用引擎接口取“下一行”，重复相同的判断逻辑，直到取到这个表的最后一行。\n3）执行器将上述遍历过程中所有满足条件的行组成的记录集作为结果集返回给客户端。","likes_number":74,"is_delete":false,"is_hidden":false,"ctime":1588643458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1194060,"avatar":"https://static001.geekbang.org/account/avatar/00/12/38/4c/5426e2e0.jpg","nickname":"CJJ","note":"","ucode":"7E02A6A8547559","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1983670,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/44/b6/5979439e.jpg","nickname":"小牛刀","note":"","ucode":"487F63F5FBC03A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326321,"discussion_content":"权限验证好像在优化器之前也有喔，precheck","likes_number":12,"is_delete":false,"is_hidden":false,"ctime":1605578204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":258061,"ip_address":""},"score":326321,"extra":""}]},{"author":{"id":1498519,"avatar":"https://static001.geekbang.org/account/avatar/00/16/dd/97/6f0092af.jpg","nickname":"莲哥","note":"","ucode":"188E9A4BD23ABD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":22039,"discussion_content":"我就是缺少你这种抓重点的思维 怎么办","likes_number":20,"is_delete":false,"is_hidden":false,"ctime":1569566134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1541577,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxLiaicFpgqpAqYu1ykUXoYDR3PpfSXw2NqOXpQ1GxlyI0QRVv9RHDsgfvC5mSbiaDOO6hAwJEoY1Jg/132","nickname":"Geek_ab88b9","note":"","ucode":"1DAB9B24A2289D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4677,"discussion_content":"兄弟，这种提取重点的能力是怎么训练出来的呢","likes_number":15,"is_delete":false,"is_hidden":false,"ctime":1565658632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083596,"avatar":"https://static001.geekbang.org/account/avatar/00/10/88/cc/11b10a6f.jpg","nickname":"xiaochao321","note":"","ucode":"8F5AC46CD9400C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286571,"discussion_content":"连接器：负责和mysql客户端建立连接，获取用户权限，维持和管理连接\n分析器：分析sql语句是否存在错误，词法分析和语法分析\n优化器：使用那一个索引，多表关联查询，判断使用那种表的连接顺序\n执行器：执行语句，先判断用户有无查询权限，使用表定义的存储引擎\n查询缓存：查询语句先通过key查询缓存，缓存中有直接返回，不推荐使用缓存，更新缓存会让缓存失效\n","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1593229876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2544760,"avatar":"https://static001.geekbang.org/account/avatar/00/26/d4/78/1075619a.jpg","nickname":"名字是乱打的","note":"","ucode":"FC7B6EA8E27EDD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363193,"discussion_content":"课代表 哈哈哈","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617122053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2436852,"avatar":"https://static001.geekbang.org/account/avatar/00/25/2e/f4/4e173734.jpg","nickname":"A passing traveller","note":"","ucode":"D98C9AA345D601","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348305,"discussion_content":"权限验证好像是有两种情况,一个是命中缓存的时候,一个是在执行器返回结果前(不知道对不对,不对的话还望指导,谢谢)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612506208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2370384,"avatar":"https://static001.geekbang.org/account/avatar/00/24/2b/50/94604c07.jpg","nickname":"A light in night","note":"","ucode":"FCE1F30309E2FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2436852,"avatar":"https://static001.geekbang.org/account/avatar/00/25/2e/f4/4e173734.jpg","nickname":"A passing traveller","note":"","ucode":"D98C9AA345D601","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380982,"discussion_content":"第二个是在开始执行前吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624851788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":348305,"ip_address":""},"score":380982,"extra":""}]},{"author":{"id":1526870,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4c/56/3c189b4d.jpg","nickname":"燃客","note":"","ucode":"B4DA3FBCA2AFC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":211761,"discussion_content":"厉害了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584886478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586288,"discussion_content":"🐎","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662091003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3041125,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/67/65/b5b06719.jpg","nickname":"jz","note":"","ucode":"D7ECCBC55DC197","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578581,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656906813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1309484,"avatar":"https://static001.geekbang.org/account/avatar/00/13/fb/2c/8c37a254.jpg","nickname":"打人不打脸","note":"","ucode":"95D94EB72DF5A8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564720,"discussion_content":"m","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650303053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2631051,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqNaOgibcBNDvn1uKOKM1ialAjUbuUXeheNg7pvjk35xbYzFRp9hoVia3dBUkQjLCLcMO8Dptfm6LaibA/132","nickname":"Geek_d7cf6b","note":"","ucode":"38AEF48600A1B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558794,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648468346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2498105,"avatar":"https://static001.geekbang.org/account/avatar/00/26/1e/39/2d9bcf8c.jpg","nickname":"AlbertLcx","note":"","ucode":"0BFD483594CBB2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406545,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634788335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1862919,"avatar":"","nickname":"邝浩鹏","note":"","ucode":"DC8FDE39EFF54B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376090,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621953555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":146033,"discussion_content":"厉害了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579594935,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61323,"user_name":"深藏Blue","can_delete":false,"product_type":"c1","uid":1031616,"ip_address":"","ucode":"CBEBCBDA47281C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/c0/57b06721.jpg","comment_is_top":false,"comment_ctime":1547662911,"is_pvip":false,"replies":[{"id":"21824","content":"哈哈，很不错，有意思啊👍","user_name":"作者回复","comment_id":61323,"uid":"1264162","ip_address":"","utype":1,"ctime":1547690458,"user_name_real":"林晓斌"}],"discussion_count":10,"race_medal":0,"score":"839066285631","product_id":100020801,"comment_content":"入手比较晚，说下个人对为什么是分析器的看法。<br>连接器：门卫，想进请出示准入凭证（工牌、邀请证明一类）。“你好，你是普通员工，只能进入办公大厅，不能到高管区域”此为权限查询。   <br>分析器：“您需要在公司里面找一张头发是黑色的桌子？桌子没有头发啊！臣妾做不到”<br>优化器：“要我在A  B两个办公室找张三和李四啊？那我应该先去B办公室找李四，然后请李四帮我去A办公室找张三，因为B办公室比较近且李四知道张三具体工位在哪”<br>执行器：“好了，找人的计划方案定了，开始行动吧，走你！糟糕，刚门卫大哥说了，我没有权限进B办公室”","like_count":195,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436832,"discussion_content":"哈哈，很不错，有意思啊👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547690458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2169577,"avatar":"","nickname":"Geek_f9d1e9","note":"","ucode":"4336D6A3A957ED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308398,"discussion_content":"来人，把朕拉出去毙了，给秀儿让座。。。","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1600938553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2014573,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/bd/6d/7010f98e.jpg","nickname":"SharpBB","note":"","ucode":"D30C5B798B8E8C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552601,"discussion_content":"有意思 我也来一个\n小明准备出门上班\n连接器：门卫大叔，放我进去吧，我今天真的是门禁卡忘带了，要不我打个电话证明下？(查询库权限) 嗯好，我认得你了，以后你不用带卡了(长连接)\n查询缓存：小米，公司冰箱里有面包吗？没了，老早吃完了。(无对应的缓存信息)\n分析器：那还是准备叫一份黄焖鸡的煲仔饭吧(语句分析无误 )\n优化器:  是点外卖好还是出去吃呢？当然是外面方便(优化为点外卖)\n执行器：行，那就点个外卖吧 (查询表权限，执行语句)","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1645522543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1590779,"avatar":"https://static001.geekbang.org/account/avatar/00/18/45/fb/248c67f7.jpg","nickname":"f畅","note":"","ucode":"32F1901CAEE6EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282260,"discussion_content":"同九年，汝何秀","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591931956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586289,"discussion_content":"很贴切，🐎一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662091032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2852354,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/86/02/622e4925.jpg","nickname":"Swagger","note":"","ucode":"BBD5F2B73E2EC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533185,"discussion_content":"很形象啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637809211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2182464,"avatar":"https://static001.geekbang.org/account/avatar/00/21/4d/40/24e85fbf.jpg","nickname":"宇宙尘埃cosmic dust","note":"","ucode":"CCD21CCD186F73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305838,"discussion_content":"咋能这么优秀！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600093516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1499743,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e2/5f/94595b9e.jpg","nickname":"frank","note":"","ucode":"4888174B90B28F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299979,"discussion_content":"段子手","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597892581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1992786,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/68/52/23174ee1.jpg","nickname":"yoonhi","note":"","ucode":"857D923DFAEF85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258854,"discussion_content":"果然优秀\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588733164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206701,"avatar":"https://static001.geekbang.org/account/avatar/00/12/69/ad/f5df3e6a.jpg","nickname":"罗格","note":"","ucode":"B5DAA40E7DE008","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2275,"discussion_content":"可以的哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563429842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38975,"user_name":"yezhizi","can_delete":false,"product_type":"c1","uid":1302047,"ip_address":"","ucode":"D179ED99286897","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ9oIRvWZARRmB2hNAmSKOQddHYBJr3QXoT8ibtFicfj46PBOTOwGib6WAA3ES2HzzqqXl4ccEEwrLXw/132","comment_is_top":false,"comment_ctime":1542164785,"is_pvip":false,"replies":[{"id":"13920","content":"嗯嗯，Trace 日志是个好东西","user_name":"作者回复","comment_id":38975,"uid":"1264162","ip_address":"","utype":1,"ctime":1542166730,"user_name_real":"林晓斌"}],"discussion_count":10,"race_medal":0,"score":"620017455409","product_id":100020801,"comment_content":"源码安装完MySQL之后,使用Debug模式启动<br>mysqld --debug --console &amp;后，<br>mysql&gt; create database wxb;<br>Query OK, 1 row affected (0.01 sec)<br><br>mysql&gt; use wxb;<br>Database changed<br>mysql&gt; create table t(a int);<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; select * from t where k=1;<br>ERROR 1054 (42S22): Unknown column &#39;k&#39; in &#39;where clause&#39;<br><br>T@4: | | | | | | | | | error: error: 1054  message: &#39;Unknown column &#39;k&#39; in &#39;where clause&#39;&#39;<br><br>Complete optimizer trace:<br>答案就很清楚了<br>","like_count":144,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428868,"discussion_content":"嗯嗯，Trace 日志是个好东西","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542166730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1152599,"avatar":"https://static001.geekbang.org/account/avatar/00/11/96/57/397ead08.jpg","nickname":"一个米屌","note":"","ucode":"8470D3FB4456F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213574,"discussion_content":"我试了一下，optimizer trace是打印查询树,不是单纯的打印优化器信息。select不存在的列卡在第一步，只有join_preparation的信息，说明还没到join_optimization优化器的部分","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585106824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1628688,"avatar":"https://static001.geekbang.org/account/avatar/00/18/da/10/e70aa747.jpg","nickname":"David","note":"","ucode":"68EACF022614D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333016,"discussion_content":"为什么你们从这个debug操作中能看出是哪个阶段？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1607417206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1795793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/zxkns28cIAUZIt3WjDb8G26qiccT84d9GMr9ZpbYR60TU1ibqSj9NoYVHlJvGF1kOltkqNDmEfJCqPuYVkue3WHg/132","nickname":"Geek_55e386","note":"","ucode":"5A727F1323C2D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":190971,"discussion_content":"你这个为什么是优化器","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1582983778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1902203,"avatar":"","nickname":"Geek_31036c","note":"","ucode":"C1EF8A0C0C7055","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1795793,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/zxkns28cIAUZIt3WjDb8G26qiccT84d9GMr9ZpbYR60TU1ibqSj9NoYVHlJvGF1kOltkqNDmEfJCqPuYVkue3WHg/132","nickname":"Geek_55e386","note":"","ucode":"5A727F1323C2D0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213181,"discussion_content":"同问，只能自己装一个试一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585057834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":190971,"ip_address":""},"score":213181,"extra":""}]},{"author":{"id":3169077,"avatar":"https://static001.geekbang.org/account/avatar/00/30/5b/35/ce47da6c.jpg","nickname":"大小姐","note":"","ucode":"07932ADB1FCAFB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585840,"discussion_content":"。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661846680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1583740,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2a/7c/0d6a87c4.jpg","nickname":"dandy","note":"","ucode":"5EE976FCBD9215","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352949,"discussion_content":"学习了，还能这样打印trace","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614920035,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1590610,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/B9vSOjMc2a86kYA8R5yDkVdFiaj2JeBZ1PuI9oUKhbnvuZwuibdUam6FTcGzDaiaFdk2GWJveUGhfCVpv4KaOdicoQ/132","nickname":"帝江","note":"","ucode":"93CBA4E4D05DA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350130,"discussion_content":"Complete optimizer trace 的 optimizer 是优化器的意思.猜测是从这里看出来的吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613719995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1176426,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f3/6a/6d82e7a3.jpg","nickname":"暮雨","note":"","ucode":"4B7F4932446EF7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":94530,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576945976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250199,"avatar":"https://static001.geekbang.org/account/avatar/00/13/13/97/641c2e7c.jpg","nickname":"贤哥","note":"","ucode":"4097CCC49E45AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35684,"discussion_content":"打印日志，可以看出是哪个阶段出错吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571298287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39348,"user_name":"峰","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1542252133,"is_pvip":true,"replies":[{"id":"14073","content":"被…被发现了😺","user_name":"作者回复","comment_id":39348,"uid":"1264162","ip_address":"","utype":1,"ctime":1542256396,"user_name_real":"林晓斌"}],"discussion_count":6,"race_medal":0,"score":"332254733925","product_id":100020801,"comment_content":"分析器，感觉老师故意只讲了词法语法解析，却没有讲语义解析。很坏⊙∀⊙！","like_count":77,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429021,"discussion_content":"被…被发现了😺","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542256396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315438,"avatar":"https://static001.geekbang.org/account/avatar/00/14/12/6e/3a0b4930.jpg","nickname":"FiRerOUNd","note":"","ucode":"571CB6565F9713","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582139,"discussion_content":"看到你的评论我才知道原来语义分析和语法分析不一样呢！","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1659256666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183518,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/1e/6b6eb987.jpg","nickname":"我们在路上","note":"","ucode":"0DB77DB7C64C47","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214654,"discussion_content":"要看看语义分析是做什么的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585223094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1091460,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a7/84/b9b81d8d.jpg","nickname":"大包","note":"","ucode":"07A12BDA5E08D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395645,"discussion_content":"同感, 听的时候还奇怪怎么没有语义分析呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632321098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1601276,"avatar":"https://static001.geekbang.org/account/avatar/00/18/6e/fc/a7ff61e5.jpg","nickname":"迈克尔嘿嘿","note":"","ucode":"F73CAFCE84C8EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1761,"discussion_content":"请问语义分析是在什么阶段呢？在分析器里，还是在优化器里呢。看有同学留意说在优化器里","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562897672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1459774,"avatar":"https://static001.geekbang.org/account/avatar/00/16/46/3e/8c75af6d.jpg","nickname":"Z东","note":"","ucode":"037B2BB2715DBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1601276,"avatar":"https://static001.geekbang.org/account/avatar/00/18/6e/fc/a7ff61e5.jpg","nickname":"迈克尔嘿嘿","note":"","ucode":"F73CAFCE84C8EF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589719,"discussion_content":"应该是在 分析器。 功能分成界限应该是明确的 优化器干的是优化的事","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665282851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":1761,"ip_address":"四川"},"score":589719,"extra":""}]}]},{"had_liked":false,"id":38814,"user_name":"ditiki","can_delete":false,"product_type":"c1","uid":1022012,"ip_address":"","ucode":"C084CDDB005803","user_header":"https://static001.geekbang.org/account/avatar/00/0f/98/3c/47d70fdc.jpg","comment_is_top":false,"comment_ctime":1542142662,"is_pvip":false,"replies":[{"id":"13914","content":"是好建议，下一篇开始这么执行哈😄","user_name":"作者回复","comment_id":38814,"uid":"1264162","ip_address":"","utype":1,"ctime":1542161684,"user_name_real":"林晓斌"}],"discussion_count":1,"race_medal":0,"score":"297894886086","product_id":100020801,"comment_content":"请问能否在专业名词旁边加上它们的英文名称，比如分析器，优化器等等。谢谢！","like_count":69,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428819,"discussion_content":"是好建议，下一篇开始这么执行哈😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542161684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93540,"user_name":"易轻尘","can_delete":false,"product_type":"c1","uid":1136684,"ip_address":"","ucode":"0D0CB9D6D45A70","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","comment_is_top":false,"comment_ctime":1557490998,"is_pvip":true,"replies":[{"id":"34900","content":"👍<br><br>“回到顶部”这个需求很有画面感啊 😆","user_name":"作者回复","comment_id":93540,"uid":"1264162","ip_address":"","utype":1,"ctime":1558709948,"user_name_real":"林晓斌"}],"discussion_count":9,"race_medal":0,"score":"293615267126","product_id":100020801,"comment_content":"靠着耐心翻完所有留言以后，强烈建议极客时间app出一个回到顶部的功能！<br><br>另外总结一下在评论中看到的问题的解答<br>1. 连接器是从权限表里边查询用户权限并保存在一个变量里边以供查询缓存，分析器，执行器在检查权限的时候使用。<br>2. sql执行过程中可能会有触发器这种在运行时才能确定的过程，分析器工作结束后的precheck是不能对这种运行时涉及到的表进行权限校验的，所以需要在执行器阶段进行权限检查。另外正是因为有precheck这个步骤，才会在报错时报的是用户无权，而不是 k字段不存在（为了不向用户暴露表结构）。<br>3. 词法分析阶段是从information schema里面获得表的结构信息的。<br>4. 可以使用连接池的方式，将短连接变为长连接。<br>5. mysql_reset_connection是mysql为各个编程语言提供的api，不是sql语句。<br>6. wait_timeout是非交互式连接的空闲超时，interactive_timeout是交互式连接的空闲超时。执行时间不计入空闲时间。这两个超时设置得是否一样要看情况。","like_count":68,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449671,"discussion_content":"👍\n\n“回到顶部”这个需求很有画面感啊 😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558709948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586290,"discussion_content":"👍，🐎一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662091138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1329566,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IcDlyK6DaBrssVGlmosXnahdJ4bwCesjXa98iaapSDozBiagZTqSCok6iaktu2wOibvpNv9Pd6nfwMg7N7KTSTzYRw/132","nickname":"慢慢卢","note":"","ucode":"853D399100D83B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568338,"discussion_content":"第5点不对，是提供给c的api，没有其他语言","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651109536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1136684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","nickname":"易轻尘","note":"","ucode":"0D0CB9D6D45A70","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1329566,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IcDlyK6DaBrssVGlmosXnahdJ4bwCesjXa98iaapSDozBiagZTqSCok6iaktu2wOibvpNv9Pd6nfwMg7N7KTSTzYRw/132","nickname":"慢慢卢","note":"","ucode":"853D399100D83B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569770,"discussion_content":"嗯嗯 c是叫这个名字 其他的语言是相似的名字","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651549596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":568338,"ip_address":""},"score":569770,"extra":""}]},{"author":{"id":1203132,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5b/bc/c3bcd529.jpg","nickname":"开开心心","note":"","ucode":"42AB03AA49628E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386195,"discussion_content":"mysql_reset_connection java api是什么？我一直没找到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627463127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1329566,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IcDlyK6DaBrssVGlmosXnahdJ4bwCesjXa98iaapSDozBiagZTqSCok6iaktu2wOibvpNv9Pd6nfwMg7N7KTSTzYRw/132","nickname":"慢慢卢","note":"","ucode":"853D399100D83B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1203132,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5b/bc/c3bcd529.jpg","nickname":"开开心心","note":"","ucode":"42AB03AA49628E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568339,"discussion_content":"他说的不对，只有c有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651109551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":386195,"ip_address":""},"score":568339,"extra":""},{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":1203132,"avatar":"https://static001.geekbang.org/account/avatar/00/12/5b/bc/c3bcd529.jpg","nickname":"开开心心","note":"","ucode":"42AB03AA49628E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586269,"discussion_content":"https://dev.mysql.com/doc/c-api/8.0/en/mysql-reset-connection.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662086289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":386195,"ip_address":"重庆"},"score":586269,"extra":""}]},{"author":{"id":1592576,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLIzE6JOuXsOamCWiaq8sHHVyCK44bdIOEqnE42veoZPEqxs5IJ8RT1Hicz0ZlPQFcbEFSwjV7icrfEw/132","nickname":"jjyyun","note":"","ucode":"8824654F673087","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292459,"discussion_content":"分析器工作结束后才precheck，那不是应该分析器的工作就能知道K字段不存在吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595231870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"Frank","note":"","ucode":"9DADD72C193296","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135655,"discussion_content":"wait_timeout是非交互式连接的空闲超时，interactive_timeout是交互式连接的空闲超时。执行时间不计入空闲时间。这两个参数是不是还控制 锁表的时间哦。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579098362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38895,"user_name":"luffy","can_delete":false,"product_type":"c1","uid":1003178,"ip_address":"","ucode":"330EB17E89721B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/aa/2112f41e.jpg","comment_is_top":false,"comment_ctime":1542157695,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"293599933823","product_id":100020801,"comment_content":"应该是分析器 1.从功能模块的职责来考虑 2.从性能来考虑，错误越晚发现成本越高。","like_count":68},{"had_liked":false,"id":38788,"user_name":"Geek_75aada","can_delete":false,"product_type":"c1","uid":1140753,"ip_address":"","ucode":"D79EAFEAF1038A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLOMFZHKEsOVkUWayeWefqyLHXqpZLIOrZicKeJGlVjEPzM7hRGxSibAR8K2hZW02H6fyQlxiaWGGKuQ/132","comment_is_top":false,"comment_ctime":1542126922,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"263535131978","product_id":100020801,"comment_content":"执行器  这个阶段才会打开表 才会知道表有哪些列","like_count":61,"discussions":[{"author":{"id":2046179,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLAsbPRKgaVw8kKp5pKGUE4JdDZaW16RoRTItTI3wJ3pPGNoFIjYQm8FKa3xLlNwRicziclmWKsmp7kA/132","nickname":"清河","note":"","ucode":"AB44CB37FCB026","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301035,"discussion_content":"系统元数据里会记录表有哪些列等信息，不用打开表","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1598368942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1374445,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f8/ed/60fb8fba.jpg","nickname":"陈小渣👻","note":"","ucode":"6B968B06C76C63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321300,"discussion_content":"哪些列在表创建的时候就是确定了的，不需要去打开表才知道的","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604561129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1955459,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/d6/83/bd4a8410.jpg","nickname":"白开水","note":"","ucode":"2E05353E8D9317","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281394,"discussion_content":"和我想法一致，哈哈哈","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591718482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39007,"user_name":"xuan","can_delete":false,"product_type":"c1","uid":1089230,"ip_address":"","ucode":"B388845A7245E3","user_header":"https://static001.geekbang.org/account/avatar/00/10/9e/ce/d8283814.jpg","comment_is_top":false,"comment_ctime":1542171543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"250650274711","product_id":100020801,"comment_content":"答案是分析器，理由如下：<br>\t根据文章分析器主要做两个事情，先做词法分析后做语法分析,词法分析主要做的是根据mysql的关键字进行验证和解析，而语法分析会在词法解析的基础上进一步做表名和字段名称的验证和解析； <br>       看完整篇文章有个疑问望解答，在执行阶段为什么需判断对表是否有执行查询的权限，而不是在分析阶段去做；根据mysql中的information_schema库的存储信息理论上可以在分析器阶段判断是否有权限。<br> ","like_count":58},{"had_liked":false,"id":45187,"user_name":"400磅","can_delete":false,"product_type":"c1","uid":1022396,"ip_address":"","ucode":"3339DC49F2431C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/bc/c1266b7e.jpg","comment_is_top":false,"comment_ctime":1543558313,"is_pvip":false,"replies":[{"id":"16144","content":"很好的总结。<br><br>1. 实际上肯定是要判断出是select语句， 但是之后的解析都没做哈。 要理解成“包含在内”也可以。<br><br>2. Show wanings不会把重写后的显示出来，只是格式化后<br><br>3. 清空缓存失败这个不太可能，这个内部结构的操作没什么依赖","user_name":"作者回复","comment_id":45187,"uid":"1264162","ip_address":"","utype":1,"ctime":1543629711,"user_name_real":"林晓斌"}],"discussion_count":4,"race_medal":0,"score":"233471792297","product_id":100020801,"comment_content":"总结：<br>客户端连接到服务端，获取到权限等信息， 然后在连接的有效时长内(interactive_timeout和wait_timeout参数控制， 5.7版本会断开可以自动重连)对sql进行处理。<br><br>首先会判断查询缓存是否开启，如果已经开启，会判断sql是select还是update&#47;insert&#47;delete，对于select，尝试去查询缓存，如果命中缓存直接返回数据给客户端， 如果缓存没有命中，或者没有开启缓存， 会进入到下一步分析器。<br><br>分析器进行语法分析、词法分析，检查sql的语法顺序等得到解析树， 然后预处理器对解析树进一步分析，验证数据表、字段是否存在，通关之后sql进入下一步优化器，所以课后问题一定是分析器阶段了。<br><br>优化器对sql执行计划分析， 得到最终执行计划，得到优化后的执行计划之后交给执行器。<br><br>执行器调用存储引擎api执行sql，得到响应结果， 将结果返回给客户端，如果缓存是开启状态， 会更新缓存。<br><br>问题1：<br>    在缓存开启状态下， 要判别sql是select还是其他类型，保证只有select才去查询缓存，那么这个判断操作是何时进行的呢？ 我猜测在查询缓存之前， 但是分析器也要对sql关键字进行分析，再分析一遍岂不是重复？ 因为我没有看源码，所以这一块不明白， 如果我来设计的话， 可能是把查询缓存这个模块在分析器阶段来执行， 由分析器进行关键字解析，判断是何种sql语句，如果是select， 再去查询缓存， 如果不是继续往下进行好像更合理，看到大家都说先查询缓存，没有命中再去分析器， 感觉不太通。<br>    <br>问题2：<br>    在mysql中通过“explain extended和show warnings”命令来查看的sql， 是不是优化器重写之后的sql？ 以前我看到一本书中提到，也可能是一篇博客，mysql的单表的union查询其实会优化成or查询， 但是show warnings看到的还是union查询语句，所以有此疑问。<br><br>问题3：<br>    update等sql清空缓存是在sql执行完返回结果给客户端之前还是之后， 还是说同时进行的， 会不会存在清空缓存失败， 但是告诉客户端update success， 缓存的地方一直不是很清楚， 所以正好 will be removed in a future releas， 真是一个大快人心。","like_count":54,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430953,"discussion_content":"很好的总结。\n\n1. 实际上肯定是要判断出是select语句， 但是之后的解析都没做哈。 要理解成“包含在内”也可以。\n\n2. Show wanings不会把重写后的显示出来，只是格式化后\n\n3. 清空缓存失败这个不太可能，这个内部结构的操作没什么依赖","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543629711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2249670,"avatar":"","nickname":"mofee888","note":"","ucode":"F1FB6F68DCF802","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326537,"discussion_content":"对于第一个问题，分析器就像是一个很大的模块，其中有一个方法是判断是select 还是update, delete。所以在查询缓存时，应该只需要调用一下其中的某个方法判断一下而已，并不是执行整个分析","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1605614364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1730052,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/66/04/22190a73.jpg","nickname":"weiming","note":"","ucode":"3EC2968FB08501","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298666,"discussion_content":"这个总结很好. 学习了. ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597374373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1451509,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/P5EIPG3R01lW2MG1HfcPUDLKajMy7BGg8rKn5dKDbdrCreIwabwJ1RqWOJMVKqAusLaf7Y0Utomibp6ibxajflvQ/132","nickname":"我要放大🐂","note":"","ucode":"B280A95E02E7C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286350,"discussion_content":"我也有第一个问题的疑问的，但是看了老师的回答还是没有明白的，有没有大神帮忙解答下的？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593143099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39082,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1308126,"ip_address":"","ucode":"7FFD6DFCE6EB36","user_header":"https://static001.geekbang.org/account/avatar/00/13/f5/de/c33e531e.jpg","comment_is_top":false,"comment_ctime":1542185019,"is_pvip":false,"replies":[{"id":"13948","content":"最后是“等待新的请求”哈，其他部分很不错呢","user_name":"作者回复","comment_id":39082,"uid":"1264162","ip_address":"","utype":1,"ctime":1542192486,"user_name_real":"林晓斌"}],"discussion_count":2,"race_medal":0,"score":"211995582523","product_id":100020801,"comment_content":"1，连接<br>连接管理模块，接收请求；连接进程和用户模块，通过，连接线程和客户端对接<br>2，查询<br>查询缓存 Query Cache<br>分析器，内建解析树，对其语法检查，先from，再on，再join，再where......；检查权限，生成新的解析树，语义检查（没有字段k在这里）等<br>优化器，将前面解析树转换成执行计划，并进行评估最优<br>执行器，获取锁，打开表，通过meta数据，获取数据<br>3，返回结果<br>返回给连接进程和用户模块，然后清理，重新等待新的连接<br><br>请大神指正😂","like_count":49,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428912,"discussion_content":"最后是“等待新的请求”哈，其他部分很不错呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2308104,"avatar":"https://static001.geekbang.org/account/avatar/00/23/38/08/df42980c.jpg","nickname":"文🔪冬🐟🐑的不二心老人","note":"","ucode":"1DDB6D4D1890BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328221,"discussion_content":"检查权限不是在执行器中吗？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606108512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39485,"user_name":"志平","can_delete":false,"product_type":"c1","uid":1033591,"ip_address":"","ucode":"78EC4A2C91C261","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/77/39e01d42.jpg","comment_is_top":false,"comment_ctime":1542287685,"is_pvip":false,"discussion_count":7,"race_medal":0,"score":"173340979525","product_id":100020801,"comment_content":"请问您的逻辑架构图是用什么工具画的？谢谢","like_count":40,"discussions":[{"author":{"id":2020611,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0iaXJRw8F5hHAxDLrtH1ZBQ8DEthG27KNFoZHfcJxIhibkRiaFk1iatE4nuRkHAHciauZnntwTyTTcpLKWKHeHrye8w/132","nickname":"Bununo","note":"","ucode":"09C26C0D24EC0A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281573,"discussion_content":"很明显 iPad 画图 纯手绘的。。。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591767799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1178426,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fb/3a/3dc7c61c.jpg","nickname":"꧁༺༻꧂","note":"","ucode":"8BFD5C1F6ED235","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541329,"discussion_content":"同问啊，老师出来回答一下呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640332793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2731647,"avatar":"","nickname":"Geek_9c7502","note":"","ucode":"69DA982D266365","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532253,"discussion_content":"手搓的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637563719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1180636,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/dc/32ef4590.jpg","nickname":"颛孙","note":"","ucode":"6ED330F5A4DBD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368597,"discussion_content":"我也想知道是什么画图软件。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618757557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1180636,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/dc/32ef4590.jpg","nickname":"颛孙","note":"","ucode":"6ED330F5A4DBD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368596,"discussion_content":"我也想知道是什么画图软件。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618757556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1180636,"avatar":"https://static001.geekbang.org/account/avatar/00/12/03/dc/32ef4590.jpg","nickname":"颛孙","note":"","ucode":"6ED330F5A4DBD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368595,"discussion_content":"我也想知道是什么画图软件。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618757555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1366484,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d9/d4/5bfe1dd8.jpg","nickname":"xbl","note":"","ucode":"78297667D85C92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267622,"discussion_content":"同问这个画图工具是啥!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589649834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38935,"user_name":"zhxilin℃+","can_delete":false,"product_type":"c1","uid":1063659,"ip_address":"","ucode":"1BBDAF534CDD65","user_header":"https://static001.geekbang.org/account/avatar/00/10/3a/eb/b83988e9.jpg","comment_is_top":false,"comment_ctime":1542160263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"160455950215","product_id":100020801,"comment_content":"优化器阶段。个人理解：<br>1.编译原理告诉我们做一个Parser，核心有三步：词法分析、语法分析和语义分析；<br>2.分析器负责词法分析和语法分析，即将查询分解成一个个Identifier（词法分析），构造一棵解析树，整棵树只确保没有语法错误（语法分析），比如检查标识符是否有效、语句是否闭合等；<br>3.优化器紧接着分析上一步的解析树，这时才解决分析器阶段无法做的语义分析，也就是会检查表名、列表等是否正确、是否存在。<br>所以此题我认为是优化器阶段。","like_count":37},{"had_liked":false,"id":39305,"user_name":"Yezhiwei","can_delete":false,"product_type":"c1","uid":1005157,"ip_address":"","ucode":"31E8E33688CBEC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/65/22a37a8e.jpg","comment_is_top":false,"comment_ctime":1542245487,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"143276166255","product_id":100020801,"comment_content":"我觉得是 分析器，看文章中老师的这段：<br><br><br>MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。","like_count":33,"discussions":[{"author":{"id":2038389,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/1a/75/ec8cba01.jpg","nickname":"沉落的时针","note":"","ucode":"A2C3F5FFEC24AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282619,"discussion_content":"你说的这个只是简单的分析关键字，并不能判断一个列名是不是某个T表的列啊","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1592031509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133036,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/ec/6bae1fd7.jpg","nickname":"哇咔咔","note":"","ucode":"54BF877836C591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588302,"discussion_content":"你这是语义分析的事情","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663658075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307088,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/QZBHia4nXtspEaRibpmMIMVcDA2HHkNypfvVJ2IllQC3FeFCt7f9iaHW7z5yQ4lcB79ibJwia6tNtpuFroufntMhc2g/132","nickname":"sotondolphin","note":"","ucode":"42198CE9B201FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379573,"discussion_content":"这里只是把它当作一个列，具体是不是存在于那个表中还不清楚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623987562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39202,"user_name":"徐远","can_delete":false,"product_type":"c1","uid":1303866,"ip_address":"","ucode":"FD8112760E37D2","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/3a/f66372a8.jpg","comment_is_top":false,"comment_ctime":1542209148,"is_pvip":false,"replies":[{"id":"14062","content":"Connect_timeout 指的是“连接过程中”的等待时间， <br><br>wait_timeout指的是“连接完成后，使用过程中”的等待时间","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542250192,"ip_address":"","comment_id":39202,"utype":1}],"discussion_count":4,"race_medal":0,"score":"138981162620","product_id":100020801,"comment_content":"最近开发人员说他们客户端连MySQL时，会有突然断开，然后又自动恢复的情况，我改了connection_timeout参数，但是今天听您介绍说到wait_timeout参数，我有点迷了，请教老师我的情况属于哪种呢","like_count":32,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428963,"discussion_content":"Connect_timeout 指的是“连接过程中”的等待时间， \n\nwait_timeout指的是“连接完成后，使用过程中”的等待时间","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1542250192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111985,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","nickname":"Frank","note":"","ucode":"9DADD72C193296","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135662,"discussion_content":"connect-timeout：连接过程中的等待时间\nwait-timeout：连接完成后，使用过程中的等待时间\ninteractive-timeout：交换式……","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1579098606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1049208,"avatar":"https://static001.geekbang.org/account/avatar/00/10/02/78/23c56bce.jpg","nickname":"james","note":"","ucode":"5701899403917C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":253558,"discussion_content":"任何网络框架都有这两个参数的 一个是连接连不上的超时时间 一个是请求接口的超时时间","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588243914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586833,"discussion_content":"一个是等待创建连接的超时时间，一个是连接idle超时时间","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662534128,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39030,"user_name":"Kids Return","can_delete":false,"product_type":"c1","uid":1304017,"ip_address":"","ucode":"FF8BCFE0136030","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/d1/b7a3db81.jpg","comment_is_top":false,"comment_ctime":1542174970,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"134686161146","product_id":100020801,"comment_content":"建议github上面建立一个仓库 方便大家一起在上面完善笔记脑图之类的 这样我就不用记笔记了","like_count":31,"discussions":[{"author":{"id":1742868,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/JVOiclOoyFvgJHNXRgqB9RDyDueBHEP5lwATC47nFXRJibtK8ibU8phJPiav3BsPCUAssM1X82mnGtEe7bF91p39eA/132","nickname":"Geek_9d8be5","note":"","ucode":"20181C54A2C589","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282517,"discussion_content":"阅读是零食，思考才是咀嚼喔","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1592007845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2408066,"avatar":"https://static001.geekbang.org/account/avatar/00/24/be/82/d7f602da.jpg","nickname":"Geek_czhh8","note":"","ucode":"8872D618FC5B46","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398673,"discussion_content":"自己记一下效果更好","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632829505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1366484,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d9/d4/5bfe1dd8.jpg","nickname":"xbl","note":"","ucode":"78297667D85C92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267621,"discussion_content":"自己还是要记笔记的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589649804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38779,"user_name":"啊油酱紫哇","can_delete":false,"product_type":"c1","uid":1307491,"ip_address":"","ucode":"C999312CCD7E8A","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/63/c0c4f15d.jpg","comment_is_top":false,"comment_ctime":1542125640,"is_pvip":false,"replies":[{"id":"13876","content":"好辛苦，希望语音版会让你学起来轻松些😁","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542126488,"ip_address":"","comment_id":38779,"utype":1}],"discussion_count":1,"race_medal":0,"score":"108916308040","product_id":100020801,"comment_content":"迫不及待想看第一篇文章。 加班回来收拾下刚好到这个点。 希望自己加油。","like_count":25,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428809,"discussion_content":"好辛苦，希望语音版会让你学起来轻松些😁","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542126488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52865,"user_name":"happyLifehappyGirl","can_delete":false,"product_type":"c1","uid":1356046,"ip_address":"","ucode":"15116EF5289D6D","user_header":"https://static001.geekbang.org/account/avatar/00/14/b1/0e/72590f9c.jpg","comment_is_top":false,"comment_ctime":1545544997,"is_pvip":false,"replies":[{"id":"19203","content":"哈哈哈，这个是蚂蚁QA，单身又阳光的妹子，我老乡，征婚本来要置顶,不过后面有招人广告就不置了😄<br><br>你Q都贴了，查出来那个过程根本不叫人肉，就是“查找”而已😄<br><br>还有孔乙己是中学课文哦，你是不是小学时看你哥课本提前预习了😋<br><br>还别说，唯一提到的技术问题是说到点子上了，”like”那么多索引建了也没用。<br><br>只有一个字段还是扩展字段，这已经不是索引的问题而是表结构设计的问题了，好了改成多字段存储，要么就用全文检索的方案<br><br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545562169,"ip_address":"","comment_id":52865,"utype":1}],"discussion_count":6,"race_medal":0,"score":"100329792805","product_id":100020801,"comment_content":"刚开始我跟晓斌哥说我要去你专栏下面征婚，他说他去顶帖，所以我买这个专栏不是为了学习……因为我工作可能简单增删改查保证事务一致就够了，况且现在的项目只有缓存没有db，能不学的一定懒得学，最主要的是大神这么厉害我觉得我也学不会。<br>前天有人说他这个sql要执行一下午，我说你写那么多like废话，你加个索引呗但他那个表只有一列，里面是扩展字段，说加不了索引，所以我也不知道接下来怎么办。<br><br>今天打扫卫生想找个东西听，大神还是心目中的大神，深入浅出幽默风趣浅显易懂，小学课文的故事都能拿来当例子开篇，从简单的select开始。我这种技术小白是能不太动脑听得懂的。<br>推荐给平时需要和数据库打交道的同学，更推荐给做高可用做运维的朋友。<br>最后，蚂蚁招人，容我打个广告，服务端开发，测试，双十一高可用运维团队，统统招人，喜欢的就是你们这些业余时间还这么爱学习专栏选的还是高质量专栏的，级别没有上限，放眼望去单身白富美一堆（我除外）团队主管好氛围好上升空间大<br>简历砸来1038248065@qq.com<br>（为避免被人肉我就先不写公司邮箱了#可能我也是想多了#）<br>#诶我说好的我来学习的，我今天学了四节了没有骗你#<br>————我是一条不正经的评论————你还看完了那就砸个简历来一起来快乐工作开心生活","like_count":23,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433995,"discussion_content":"哈哈哈，这个是蚂蚁QA，单身又阳光的妹子，我老乡，征婚本来要置顶,不过后面有招人广告就不置了😄\n\n你Q都贴了，查出来那个过程根本不叫人肉，就是“查找”而已😄\n\n还有孔乙己是中学课文哦，你是不是小学时看你哥课本提前预习了😋\n\n还别说，唯一提到的技术问题是说到点子上了，”like”那么多索引建了也没用。\n\n只有一个字段还是扩展字段，这已经不是索引的问题而是表结构设计的问题了，好了改成多字段存储，要么就用全文检索的方案\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545562169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2062404,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/78/44/c653ba6b.jpg","nickname":"Anna","note":"","ucode":"7AB97399ECA6CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316813,"discussion_content":"这种水平也能进阿里？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603458855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2062404,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/78/44/c653ba6b.jpg","nickname":"Anna","note":"","ucode":"7AB97399ECA6CF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377327,"discussion_content":"好像QA不需要做技术开发","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622604011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":316813,"ip_address":""},"score":377327,"extra":""}]},{"author":{"id":1322622,"avatar":"https://static001.geekbang.org/account/avatar/00/14/2e/7e/bd3b2a08.jpg","nickname":"@","note":"","ucode":"1BF0CE3F3ED41E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578315,"discussion_content":"请问结婚了吗 哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656656657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2760755,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/20/33/a11967fe.jpg","nickname":"Geek_00f5e7","note":"","ucode":"D95BC7225005C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550974,"discussion_content":"请问最近有校招实习吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644831051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1730052,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/66/04/22190a73.jpg","nickname":"weiming","note":"","ucode":"3EC2968FB08501","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298668,"discussion_content":"全文检索方案很好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597374541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71003,"user_name":"不能扮演天使","can_delete":false,"product_type":"c1","uid":1046172,"ip_address":"","ucode":"9922330BFF7FFB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f6/9c/b457a937.jpg","comment_is_top":false,"comment_ctime":1551243184,"is_pvip":false,"replies":[{"id":"25455","content":"更新完回来失效缓存","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551255376,"ip_address":"","comment_id":71003,"utype":1}],"discussion_count":3,"race_medal":0,"score":"96040523696","product_id":100020801,"comment_content":"不明白分析器到查询缓存那个箭头代表啥意思？","like_count":22,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440942,"discussion_content":"更新完回来失效缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551255376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259876,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KYvWM0tjH8j920S32qkGMDDeRJDIg4LoqRppe74AISyhYyKmGTcia3BvDqjvibhCicx7ncGSRbQyd2phR7ZUZwR6A/132","nickname":"落月","note":"","ucode":"10663079C7096F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391290,"discussion_content":"失效缓存 的实现是由分析器来完成的吗？不是进行SQL的语法分析吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630390800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1470434,"avatar":"https://static001.geekbang.org/account/avatar/00/16/6f/e2/f3b05833.jpg","nickname":"A 拽丫头","note":"","ucode":"F875D99D18DF6E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339968,"discussion_content":"我刚好有这个疑问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609851668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38815,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1542143547,"is_pvip":false,"replies":[{"id":"13902","content":"“引擎”扫描行数是指在引擎内部真正扫描的次数。这个问题我们会在后面文章《为什么我只查一行，也执行这么慢》中会详细说明。引擎对外的接口就主要是存、取数据，当然也会提供建表、锁这些接口的。 不同引擎的区别我们会在后面文章展开。你的问题都很好👍🏿","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542160223,"ip_address":"","comment_id":38815,"utype":1}],"discussion_count":1,"race_medal":0,"score":"91736456763","product_id":100020801,"comment_content":"想请问一下老师，最后说的引擎扫描的行数和实际扫描的行数是不一样的，那引擎扫描的行数具体指的是什么？存储引擎只是负责存储和提取吗？那么不同的存储引擎大致有何区别呢？自己只是写过一些简单的SQL语句，从来没有接触过数据库底层，描述不到位的地方还请老师指正，谢谢老师","like_count":21,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428820,"discussion_content":"“引擎”扫描行数是指在引擎内部真正扫描的次数。这个问题我们会在后面文章《为什么我只查一行，也执行这么慢》中会详细说明。引擎对外的接口就主要是存、取数据，当然也会提供建表、锁这些接口的。 不同引擎的区别我们会在后面文章展开。你的问题都很好👍🏿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542160223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100762,"user_name":"魂牵","can_delete":false,"product_type":"c1","uid":1371574,"ip_address":"","ucode":"8AE778F5DA9178","user_header":"https://static001.geekbang.org/account/avatar/00/14/ed/b6/0a4439f5.jpg","comment_is_top":false,"comment_ctime":1559634651,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"83164013275","product_id":100020801,"comment_content":"学习笔记：<br>查询sql语句的执行过程：<br>\t总的mysql逻辑架构图：如图一：<br>\t客户端 + mysql<br>\tmysql分为Server层 和 引擎层<br>\t\tServer层：查询缓存、分析器、优化器、执行器等 以及所有内置的函数（eg:日期、时间、数学和加密函数等）<br>\t\t\t\t 所有跨存储引擎的功能都在这一层实现，eg：存储过程、触发器、视图<br>\t\t\t\t查询缓存：mysql拿到一个查询后，先查询缓存，（缓存保存形式KV（K为查询的语句，V为查询的结果））\t<br>\t\t\t\t\t\t但建议关闭查询缓存（show variables like &#39;%query_cache_type%&#39;; set GLOBAL query_cache_type=&#39;OFF&#39;;）<br>\t\t\t\t\t\t失效频繁，而且对于压力大的数据库，命中率非常低。mysql8.0版本取消了查询缓存的整个功能模块。<br>\t\t\t\t分析器：词法分析：识别出里面的字符串分别是什么代表什么。<br>\t\t\t\t\t\t语法分析: 根据词法分析的结果和语法规则，判断是否满足Mysql语法。<br>\t\t\t\t优化器：分析器知道要做什么，优化器在便利有多个索引时，决定使用哪个索引；在一个语句有多表关联（join）时，决定<br>\t\t\t\t\t\t各个表的连接顺序。（TODO关于具体的选择方式后续补充）<br>\t\t\t\t执行器：优化器知道怎么做了，执行器进行执行语句<br>\t\t\t\t<br>\t\t引擎层：负责数据的存储和提取。架构模式是插件式的，支持InnoDB（默认）、MyISAM（不支持事务）、Memory（针对具体表，而非数据库）\t\t <br>\t\t     InnoDB、MyISAM、Memory比较：图二：<br>\t\t\t\t\tInnoDB：支持事务处理，支持外键，支持崩溃修复能力和并发控制。如果需要对事务的完整性要求比较高（银行），<br>\t\t\t\t\t\t\t要求实现并发控制（售票），选择InnoDB。如果需要频繁更新、删除操作的数据库也选择InnoDB。因为支持<br>\t\t\t\t\t\t\t事务的提交和回滚<br>\t\t\t\t\tMyISAM：插入数据块、空间和内存使用比较低。如果表主要用于插入新记录和读出记录，选择MyISAM能实现处理高效率。<br>\t\t\t\t\t\t\t如果应用的完整性、并发性要求比较低，也可使用。<br>\t\t\t\t\tMemory：所有数据存在内存中，数据处理速度快，但不安全。如果需要很快的读写速度，对数据的安全性要求低，可选择Memory<br>\t\t\t\t\t\t\t它对表的大小有要求，不能建立太大的表。<br>\t客户端连接server时，长连接和短链接；<br>\t\t长连接：连接成功后，如果客户端持续有请求，则一直使用同一个连接<br>\t\t短链接：每次执行完很少的几次查询就断开连接，下次查询再重新建立一个<br>\t由于建立连接的过程比较复杂，建议尽量减少连接的动作，也就是尽量使用长连接<br>\t但如果使用长连接后，会发现Mysql内存涨的很快。因为Mysql在执行过程中临时使用的内存是管理再连接对象里的。这些资源只有在连接断开<br>\t\t的时候才会释放，如果长连接累计下来，可能会导致内存占用太大，被系统强行杀掉（OOM），从现象上看就是Mysql异常重启。<br>\t解决方案：<br>\t\t1、定期断开长连接 ： 使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，端来连接，之后要查询再重连<br>\t\t2、调用mysql内部函数：如果使用的是Mysql5.7或者更新版本，可以在每次执行一个比较大的操作后，通过执行mysql_reset_connection（mysql内部function）<br>\t\t\t来重新初始化连接资源。这个过程不需要重连和重新做权限验证，但是会将连接恢复到刚刚创建完时的状态。<br>\t","like_count":19,"discussions":[{"author":{"id":1546579,"avatar":"","nickname":"稽山的柚子","note":"","ucode":"E19BCF4604CBB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390054,"discussion_content":"写这么多，你知道Mysql在执行过程中临时使用的内存存放的都是啥玩意么。。？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629624587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2208635,"avatar":"https://static001.geekbang.org/account/avatar/00/21/b3/7b/95adaf84.jpg","nickname":"🏀","note":"","ucode":"5F7ED535134B8F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1546579,"avatar":"","nickname":"稽山的柚子","note":"","ucode":"E19BCF4604CBB9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589808,"discussion_content":"是啥呀\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665315486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":390054,"ip_address":"北京"},"score":589808,"extra":""}]},{"author":{"id":2132654,"avatar":"https://static001.geekbang.org/account/avatar/00/20/8a/ae/2edc03e9.jpg","nickname":"大口吃肉喝酒","note":"","ucode":"E429EAD5262AC9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364825,"discussion_content":"课代表，总结很到位","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617619153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39053,"user_name":"skyoo","can_delete":false,"product_type":"c1","uid":1302503,"ip_address":"","ucode":"EBC0528BA02DD7","user_header":"https://static001.geekbang.org/account/avatar/00/13/df/e7/4ce5ed27.jpg","comment_is_top":false,"comment_ctime":1542179345,"is_pvip":false,"replies":[{"id":"13988","content":"第一个问题：是的，这两个尽量设置成相同。值的话取决于业务。如果你面对的是成熟的开发（比如公司内部团队），可以设置小些，分钟级别就行。 <br><br>第二个问题：这两个都可以，不过用query_cache_type会好些（代码判断路径更短） <br><br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542207423,"ip_address":"","comment_id":39053,"utype":1}],"discussion_count":3,"race_medal":0,"score":"78851590673","product_id":100020801,"comment_content":"wait_timeout 是客户端 非交互式的连接时间，如果程序连接mysql SERVER，是交互连接,关联的时间参数为interactive_timeout, 这两个时间参数需要尽量一致吗,一般设置多少合适?<br>query_cache_size 参数虽然不用了,我想确认下,关闭情况是 query_cache_size=0 要匹配参数query_cache_type=off吗？ 还是直接query_cache_size=0 即可？","like_count":18,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428894,"discussion_content":"第一个问题：是的，这两个尽量设置成相同。值的话取决于业务。如果你面对的是成熟的开发（比如公司内部团队），可以设置小些，分钟级别就行。 \n\n第二个问题：这两个都可以，不过用query_cache_type会好些（代码判断路径更短） \n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542207423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2198841,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erF9Aia2NyP3csEIDhhxj14PicBhgccbEVFIiaBE7WfOCqw751TsKxZZyuZZ260SxIvGq1Fxnib7CPaIw/132","nickname":"Geek_166f3a","note":"","ucode":"9D149C6ADDCF69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311100,"discussion_content":"交互式连接: 通过 mysql 客户端连接.\n非交互式连接: 通过 jdbc 方式连接.","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1602220532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188023,"avatar":"https://static001.geekbang.org/account/avatar/00/12/20/b7/bdb3bcf0.jpg","nickname":"Eternal","note":"","ucode":"EA6FE7CC98F740","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379687,"discussion_content":"成熟的开发，表示操作顺畅，中间不会间歇，空闲很久导致连接超时","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624072802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69850,"user_name":"wvalianty","can_delete":false,"product_type":"c1","uid":1261407,"ip_address":"","ucode":"E5029CD900094B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL17yp3TmdQNXWELQvjIA2azwZ6ib7Riae9Hcf2YFl1uvnvocQoicTOtJLnvjUPtpbYhSng7DtPR9lfg/132","comment_is_top":false,"comment_ctime":1550886177,"is_pvip":false,"replies":[{"id":"24927","content":"👍","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550969366,"ip_address":"","comment_id":69850,"utype":1}],"discussion_count":1,"race_medal":0,"score":"61680428321","product_id":100020801,"comment_content":"1、mysql主要组成部分，连接器，优化器，执行器，存储引擎。<br>2、连接器，验证账号密码，维持链接，超时自动断开，链接过程复杂，建议使用长链接，连接比较占用内存，需要定时断开，5.7之后可以使用mysql_reset_connection。<br>3、分析器，验证语法的合规性，把sql转换成mysql内部识别的语句，表明转换成对应的id。<br>4、判断sql内部的执行顺序。<br>5、执行器，验证操作库表是否有权限，调存储引擎接口查询数据。<br>6、慢查询日志rows_examined，记录查询的时候扫描了多少行，相同表有肯能次数不同。","like_count":14,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440316,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550969366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46421,"user_name":"lucky star","can_delete":false,"product_type":"c1","uid":1311928,"ip_address":"","ucode":"C61FC9CA1C8A60","user_header":"https://static001.geekbang.org/account/avatar/00/14/04/b8/3fd2f448.jpg","comment_is_top":false,"comment_ctime":1543920342,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"53083527894","product_id":100020801,"comment_content":"分析器， 是分析器的预处理阶段， 高性能mysql明确的给出了答案<br><br>两个疑问：<br>    1，首先您说在连接器建立连接后就已经读取了权限信息了， 那为什么又说在每次执行sql的时候在执行器还要判断一次权限？这俩权限不一样吗？有什么不同？<br>    2，高性能mysql中说sql执行的时候权限的验证是在分析器的预处理器中执行的， 您说的是在执行器？那我就蒙圈了。。。<br>    3，问一个本文没提及的问题， mysql最新的版本，客户端和服务器的通信协议还是半双工的吗？","like_count":12,"discussions":[{"author":{"id":2549897,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/GeJFj6vZ5V5Piatibibiajiaxn9tf1beWHSrIPZzyn5t3Czm1lPUYWNkFIoh4Ol8gK07zH0k6LY94hcgZ2wosUGOKsg/132","nickname":"一亩三分地","note":"","ucode":"B0522ABBFFE2FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364557,"discussion_content":"个人理解：\n      连接器阶段的权限指的是：能不能登录到 MySQL，\n      执行器阶段的权限指的是：对 MySQL 里的数据(表)有没有操作权限\n","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1617517507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133036,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/ec/6bae1fd7.jpg","nickname":"哇咔咔","note":"","ucode":"54BF877836C591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588303,"discussion_content":"实际上是认证和鉴权","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663658406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39228,"user_name":"橡皮泥boy","can_delete":false,"product_type":"c1","uid":1011863,"ip_address":"","ucode":"478F5417EDD249","user_header":"https://static001.geekbang.org/account/avatar/00/0f/70/97/e5bf9ddb.jpg","comment_is_top":false,"comment_ctime":1542212627,"is_pvip":true,"replies":[{"id":"14059","content":"排序、变量这些会占用内存，如果要复用，以前释放反而影响性能，MySQL没法自己决定，所以5.7之后提供了方法让客户端有命令来做；<br><br>MySQL的内存池一般说的是查询缓存和引擎里面的（比如InnoDB 的buffe pool), 跟线程内缓存不是一个概念😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542249777,"ip_address":"","comment_id":39228,"utype":1}],"discussion_count":4,"race_medal":0,"score":"48786852883","product_id":100020801,"comment_content":"【对文章的疑问】<br>老师好，文里遇到临时内存会跟随长连接的存在而存在，直到连接被销毁。<br>我想问对是，这部分临时内存是由于什么产生？为什么不提前释放呢？mysql有用到内存池吗？","like_count":11,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428972,"discussion_content":"排序、变量这些会占用内存，如果要复用，以前释放反而影响性能，MySQL没法自己决定，所以5.7之后提供了方法让客户端有命令来做；\n\nMySQL的内存池一般说的是查询缓存和引擎里面的（比如InnoDB 的buffe pool), 跟线程内缓存不是一个概念😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542249777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1360250,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erFY9H3mxyTpZ9gxAmdeKic565hicicDZmv7cjswd8hdernmxib0chdQrlDNKUZQ8AticQCgDdgVEmJNuA/132","nickname":"牧鱼","note":"","ucode":"0EB8FDD7A4BB2E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309315,"discussion_content":"这里所说的内存是指基于session级别的那几个内存吧。比如sort_buffer,join_buffer","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601256810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1091017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a5/c9/fa09b9f5.jpg","nickname":"Solofir","note":"","ucode":"7AD71D8CBCAB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":166325,"discussion_content":"请问，5.7之前的版本，对于长连接内存过大的问题，应该怎么处理呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581384811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1019069,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8c/bd/4895b166.jpg","nickname":"Chelizi","note":"","ucode":"B90CFDB5F7B900","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1091017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a5/c9/fa09b9f5.jpg","nickname":"Solofir","note":"","ucode":"7AD71D8CBCAB8E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314714,"discussion_content":"文中有说：“定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连。”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603188934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":166325,"ip_address":""},"score":314714,"extra":""}]}]},{"had_liked":false,"id":68018,"user_name":"明月能曌三千里","can_delete":false,"product_type":"c1","uid":1305509,"ip_address":"","ucode":"0BB5AF5B56C9F7","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/a5/bb5da1bc.jpg","comment_is_top":false,"comment_ctime":1550389242,"is_pvip":false,"replies":[{"id":"24114","content":"好问题，看一下今天晚上（2月18日凌晨）更新的第42篇哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550402262,"ip_address":"","comment_id":68018,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44500062202","product_id":100020801,"comment_content":"现在有一个普通用户的长连接，权限是select，现在我另开一个root用户会话，把这个普通用户的权限做了修改，加上了insert的权限，在没有断开这个普通用户的长连接，但是发现该长连接可以进行insert，这个现象跟文中所说的已经存在的长连接必须要先断开才可以应用新权限是冲突的。请问这是什么原因？","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439473,"discussion_content":"好问题，看一下今天晚上（2月18日凌晨）更新的第42篇哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550402262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62697,"user_name":"fireflyc","can_delete":false,"product_type":"c1","uid":1024011,"ip_address":"","ucode":"44FDD5729CAE6E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/0b/20123c7a.jpg","comment_is_top":false,"comment_ctime":1548135719,"is_pvip":false,"replies":[{"id":"22191","content":"ipad的pencil，美女编辑画的哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1548138976,"ip_address":"","comment_id":62697,"utype":1}],"discussion_count":6,"race_medal":0,"score":"44497808679","product_id":100020801,"comment_content":"图片用什么画的？方便告知一下名字吗？","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437311,"discussion_content":"ipad的pencil，美女编辑画的哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548138976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1155690,"avatar":"","nickname":"鱼肥","note":"","ucode":"60340A82E5D977","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585670,"discussion_content":"这个字体如果不那么斜会更好啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661758315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1304123,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e6/3b/6d68cb72.jpg","nickname":"邹涛","note":"","ucode":"B81FF267A59CE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":197105,"discussion_content":"划重点，美女！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583406974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1042714,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1NMAMj2T81BGLJhsnJ7IZL9BeP6LoX6ajukkTKficABoStaE6mAFHBibRQ3HiaG3VNJibVtqQy5m9RMibGfic62yibd7g/132","nickname":"kali","note":"","ucode":"7159F913A83016","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2782,"discussion_content":"想问一下美女编辑用的什么应用画的，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563932745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1250199,"avatar":"https://static001.geekbang.org/account/avatar/00/13/13/97/641c2e7c.jpg","nickname":"贤哥","note":"","ucode":"4097CCC49E45AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1042714,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1NMAMj2T81BGLJhsnJ7IZL9BeP6LoX6ajukkTKficABoStaE6mAFHBibRQ3HiaG3VNJibVtqQy5m9RMibGfic62yibd7g/132","nickname":"kali","note":"","ucode":"7159F913A83016","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":35704,"discussion_content":"Goodnotes 或者Notability","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571299421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2782,"ip_address":""},"score":35704,"extra":""},{"author":{"id":1042714,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1NMAMj2T81BGLJhsnJ7IZL9BeP6LoX6ajukkTKficABoStaE6mAFHBibRQ3HiaG3VNJibVtqQy5m9RMibGfic62yibd7g/132","nickname":"kali","note":"","ucode":"7159F913A83016","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1250199,"avatar":"https://static001.geekbang.org/account/avatar/00/13/13/97/641c2e7c.jpg","nickname":"贤哥","note":"","ucode":"4097CCC49E45AE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57863,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574645024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":35704,"ip_address":""},"score":57863,"extra":""}]}]},{"had_liked":false,"id":55998,"user_name":"Long","can_delete":false,"product_type":"c1","uid":1318970,"ip_address":"","ucode":"2417242560360A","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg","comment_is_top":false,"comment_ctime":1546365978,"is_pvip":false,"replies":[{"id":"20224","content":"1. 不是的，由于工程实现的原因，会有前置检查<br>2. 这个也类似，其实如果看调用路径，执行器阶段都在mysql_parse函数里面调用的。 做这些阶段的拆分我觉得主要是方便我们从概念上理解，工程实现的时候确实不是1234这么按部就班的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1546397437,"ip_address":"","comment_id":55998,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44496038938","product_id":100020801,"comment_content":"老师你好，准备重新复习所有的课程。<br>每天都在等你的更新，每篇都能学到新的知识。希望把我之前回答别人的数据库知识时候的词语：应该，估计，我理解，可能是。。。这样的一些词语都渐渐去除了。<br><br>这边有2个问题：复习第一篇的时候发现2个疑问，认真看了大部分留言后发现问题没有关闭，特此再问下：<br>问题1：和下面三位同学有类似的疑问：关于没有权限操作表的时候的报错：<br>@von，@尼古拉斯赵四，@学徒（可以直接评论区搜索这些同学的名字）<br>如果分析器已经知道了“unknown column”之后，为什么还会报错：“select command denied”。你之前的回答是：由于安全考虑，用户没有权限操作这个表，那么也不需要告诉用户这么多，直接告诉用户没有权限。<br><br>【重点疑问】如果是按照这样的话，且对表的权限检查都在执行器的话，那么每个sql在执行的时候至少都会执行到执行器吗？<br><br>因为同时看到文中在执行器章节：于是就进入了执行器阶段，开始执行语句。开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，如果没有，就会返回没有权限的错误，如下所示。<br>SELECT command denied to user &#39;b&#39;@&#39;localhost&#39; for table &#39;T&#39;<br><br><br>问题2：两位测试结果不一样<br>@yezhizi <br>yezhizi的测试结果是Complete optimizer trace:<br>@黑龍Dr夢，从他的描述来看，测试结果应该是分析器<br><br>没有本项目上的MySQL权限，等明天自己本地版下好后，测试下结果。<br>也请老师也帮忙分析下我的疑惑，多谢。","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434908,"discussion_content":"1. 不是的，由于工程实现的原因，会有前置检查\n2. 这个也类似，其实如果看调用路径，执行器阶段都在mysql_parse函数里面调用的。 做这些阶段的拆分我觉得主要是方便我们从概念上理解，工程实现的时候确实不是1234这么按部就班的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546397437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549638,"discussion_content":"Mark，看作者的回复，文中讲的server的几个阶段，不是完全按顺序走的，是互相包含的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644159253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40102,"user_name":"Together","can_delete":false,"product_type":"c1","uid":1306017,"ip_address":"","ucode":"DEBB25700CC7EA","user_header":"https://static001.geekbang.org/account/avatar/00/13/ed/a1/d2953af8.jpg","comment_is_top":false,"comment_ctime":1542502727,"is_pvip":false,"replies":[{"id":"14419","content":"连接器“取”权限，执行器“用”权限","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542521107,"ip_address":"","comment_id":40102,"utype":1}],"discussion_count":5,"race_medal":0,"score":"44492175687","product_id":100020801,"comment_content":"【对权限检验的一点疑问】在连接器里已经做过了权限验证，为什么在执行器里还要再做一次？","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429373,"discussion_content":"连接器“取”权限，执行器“用”权限","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1542521107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318148,"discussion_content":"简单精辟","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603654991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069548,"avatar":"https://static001.geekbang.org/account/avatar/00/10/51/ec/3d51d5e6.jpg","nickname":"上校","note":"","ucode":"DEE1CEE9E4C680","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293719,"discussion_content":"连接器的权限是用户对这个数据库的使用权限，然后还要获取用户对库里的表的权限。执行器是对用户对库里的表的权限的验证","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595647673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1155690,"avatar":"","nickname":"鱼肥","note":"","ucode":"60340A82E5D977","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585671,"discussion_content":"感觉这句话可以放到正文里呢。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661758395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1645665,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/61/0ca1ca43.jpg","nickname":"蒋腾飞同学","note":"","ucode":"AF72D93DDAC536","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":249928,"discussion_content":"这个也正是我想问的！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587976219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39450,"user_name":"James_bai","can_delete":false,"product_type":"c1","uid":1310791,"ip_address":"","ucode":"142F25DED83437","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/47/53f2a776.jpg","comment_is_top":false,"comment_ctime":1542280422,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"40196986086","product_id":100020801,"comment_content":"mysql长连接和短连接怎么理解？需要自己设置吗？默认是长连接还是短连接？","like_count":9,"discussions":[{"author":{"id":1069548,"avatar":"https://static001.geekbang.org/account/avatar/00/10/51/ec/3d51d5e6.jpg","nickname":"上校","note":"","ucode":"DEE1CEE9E4C680","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293713,"discussion_content":"短连接是操作数据库完成就关闭连接。长连接就是不主动关闭，一直使用这个连接操作数据库。wait_timeout是指这个连接建立后，如果一直不使用（比如超过8个小时），那么就会超时断开连接。关于长连接老师最后的特别放送中举了一个场景，每当第二天上班的时候发现连接断开了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595647231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1992786,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/68/52/23174ee1.jpg","nickname":"yoonhi","note":"","ucode":"857D923DFAEF85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258859,"discussion_content":"这个疑问竟然没人回答。同迷惑ing - -\n粗略理解：\n短连接：每操作一次，都需要链接一次\n长连接：规定时间内（比如8小时），一直保持链接状态，超过时间（8小时）后的下一次操作，需要重新链接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588733511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38866,"user_name":"david😄","can_delete":false,"product_type":"c1","uid":1045298,"ip_address":"","ucode":"BBC917FF33438C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/32/ec5403ab.jpg","comment_is_top":false,"comment_ctime":1542155697,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40196861361","product_id":100020801,"comment_content":"觉得分析器会检查列，列都存在一个schema系统表里，查这个表就可以咯😄","like_count":9},{"had_liked":false,"id":108494,"user_name":"日出不落","can_delete":false,"product_type":"c1","uid":1574112,"ip_address":"","ucode":"BF470B973C9F1F","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/e0/9b5892fa.jpg","comment_is_top":false,"comment_ctime":1561783797,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"35921522165","product_id":100020801,"comment_content":"对于长链接时间久了导致mysql oom，这个部分有个疑问，日常我们所用的数据库连接池插件，没见过他做这种reset操作，但是也不会oom，老师来个解惑","like_count":8,"discussions":[{"author":{"id":1178904,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fd/18/c6da407c.jpg","nickname":"ｓｕ＇ｑｉａｎｇ","note":"","ucode":"A5EEEFB8C2F7E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557731,"discussion_content":"好好看一下数据库连接池的源代码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647945836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54351,"user_name":"zc","can_delete":false,"product_type":"c1","uid":1086631,"ip_address":"","ucode":"5A5D4C90DF591C","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/a7/a582f0d0.jpg","comment_is_top":false,"comment_ctime":1545833740,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35905572108","product_id":100020801,"comment_content":"请问丁奇老师，软件结构图是用什么工具画的？","like_count":8},{"had_liked":false,"id":38873,"user_name":"舜","can_delete":false,"product_type":"c1","uid":1221029,"ip_address":"","ucode":"F5778B1F9290FD","user_header":"https://static001.geekbang.org/account/avatar/00/12/a1/a5/2100367c.jpg","comment_is_top":false,"comment_ctime":1542156133,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"35901894501","product_id":100020801,"comment_content":"我觉得是优化器，理由如下：<br>1，从对服务系统来说越早发现错误拒绝掉执行对系统压力越小，相当于及时止损<br>2，前面分析器是分析sql的语法的，可以pass，而优化器是为了确定最终怎么执行sql，那么他是能够知道表字段信息的，比如能够确定哪几个字段能够命中索引，那么分析器应该可以在这个阶段发现不存在的字段的","like_count":8,"discussions":[{"author":{"id":1351755,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a0/4b/b818d731.jpg","nickname":"kkk","note":"","ucode":"33C6170F5E0CD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":190425,"discussion_content":"刚才去看了高性能mysql这本书，书中说优化阶段是从存储引擎读取索引信息，但是不知道存储引擎算不算打开了表","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582943325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351755,"avatar":"https://static001.geekbang.org/account/avatar/00/14/a0/4b/b818d731.jpg","nickname":"kkk","note":"","ucode":"33C6170F5E0CD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":190418,"discussion_content":"我也有这个疑问，如果不打开表的话，怎么知道有哪些索引","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582942630,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72097,"user_name":"啊啊啊哦哦","can_delete":false,"product_type":"c1","uid":1309877,"ip_address":"","ucode":"68C7153ECAAC57","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/RNO4yZyBvic914hewmNNE8iblYDcfv5yGHZ9OnKuCuZXNmGR0F5qV3icKLT2xpMt66GyEpicZVvrmz8A6TIqt92MQg/132","comment_is_top":false,"comment_ctime":1551519355,"is_pvip":false,"replies":[{"id":"26134","content":"这个是程序行为，看你程序怎么写的哈<br><br>也不一定就是2个。<br><br>比如以前用php写web页面，一个页面逻辑执行过程中用同同一个连接，这个页面用完就关掉连接。<br>再刷新页面的时候再创建一个新连接，<br>这个我也认为是短连接","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551529656,"ip_address":"","comment_id":72097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31616290427","product_id":100020801,"comment_content":"短链接。  假设 代码执行2次select语句。  每次都会重新建立连接吗","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441459,"discussion_content":"这个是程序行为，看你程序怎么写的哈\n\n也不一定就是2个。\n\n比如以前用php写web页面，一个页面逻辑执行过程中用同同一个连接，这个页面用完就关掉连接。\n再刷新页面的时候再创建一个新连接，\n这个我也认为是短连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551529656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54744,"user_name":"luoChao","can_delete":false,"product_type":"c1","uid":1322823,"ip_address":"","ucode":"E8A46B41B3178D","user_header":"https://static001.geekbang.org/account/avatar/00/14/2f/47/eadc8482.jpg","comment_is_top":false,"comment_ctime":1545958869,"is_pvip":false,"replies":[{"id":"19838","content":"失效缓存","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545961353,"ip_address":"","comment_id":54744,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31610729941","product_id":100020801,"comment_content":"为什么那个逻辑架构图，会有从分析器指向查询缓存的→箭头。","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434549,"discussion_content":"失效缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545961353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1911661,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDOKcx20Xxmu5j8WxiafoYvo3bIAFDg8OeicRic1icD597QuMC9O8FyV2Al9RxNfVZXK0gkGUx6M3CVQ/132","nickname":"多年以后","note":"","ucode":"D70E7A1ABE0F39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549939,"discussion_content":"是更新的时候去失效这个表的查询缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644304677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1355199,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVqEDcszBlhMs5e4y948EhdZo9Dguic8k8pALwxCEUCyEgSugkzuZ3AvOibcWrBBaibLTSpTEbjL77A/132","nickname":"tkjike","note":"","ucode":"A591CA14166AFC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382812,"discussion_content":"这里的失效缓存，难道是检查发现表不存在等的时候将查询计划中的不存在的表对应的缓存失效掉？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625730039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39230,"user_name":"Nick","can_delete":false,"product_type":"c1","uid":1303145,"ip_address":"","ucode":"D453E42B9A8429","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKa0PdjFnEpvGFBcED2P28ugPmwwRoCbeUfulpGEye8964F4nwChQyVfgVUia74TyDISvXTYJfQpA/132","comment_is_top":false,"comment_ctime":1542213069,"is_pvip":false,"replies":[{"id":"14058","content":"MySQL确实有你提到的这种算法，叫做index_merge. 不过我们这个case里面不会，由于实现的原因，MySQL至今没有支持跨表index_merge","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542249579,"ip_address":"","comment_id":39230,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31606984141","product_id":100020801,"comment_content":"文中join的例子，内表和外表 都有高区分度条件的情况下，先过滤出两表符合条件的记录，再对这些记录做join，可不可以？感觉这样性能更高。","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428974,"discussion_content":"MySQL确实有你提到的这种算法，叫做index_merge. 不过我们这个case里面不会，由于实现的原因，MySQL至今没有支持跨表index_merge","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542249579,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38880,"user_name":"伟忠","can_delete":false,"product_type":"c1","uid":1112089,"ip_address":"","ucode":"FE77CF20ED6065","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/19/05a2695f.jpg","comment_is_top":false,"comment_ctime":1542156642,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31606927714","product_id":100020801,"comment_content":"如果优化器能读表结构，我猜是优化器。<br>如果优化器只是看索引，那就是执行器阶段","like_count":7,"discussions":[{"author":{"id":1604511,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7b/9f/7825b97c.jpg","nickname":"竹荀","note":"","ucode":"3380C18DCAD203","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2354,"discussion_content":"看到你这个回复我想起了以前高中考试的时候，A,B,C,D四个选项，我选择的是AC，结果答案是BD，阿西吧","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1563507398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71155,"user_name":"Aaaaaaaaaaayou","can_delete":false,"product_type":"c1","uid":1073601,"ip_address":"","ucode":"67BA315B87587D","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/c1/93031a2a.jpg","comment_is_top":false,"comment_ctime":1551274755,"is_pvip":false,"replies":[{"id":"25485","content":"不是，<br>这是“行为”，比如连接完，执行一个查询，就断开，这是短连接；<br><br>执行一个查询，不断开，下次查询还用这个连接，持续使用，就是长链接","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551279228,"ip_address":"","comment_id":71155,"utype":1}],"discussion_count":5,"race_medal":0,"score":"27321078531","product_id":100020801,"comment_content":"请问老师，短连接和长连接是怎么设置的？是连接数据库的时候有什么参数吗？","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441016,"discussion_content":"不是，\n这是“行为”，比如连接完，执行一个查询，就断开，这是短连接；\n\n执行一个查询，不断开，下次查询还用这个连接，持续使用，就是长链接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551279228,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1831324,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/f1/9c/cd12361d.jpg","nickname":"黑客时间","note":"","ucode":"7E22D76EECAC4D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293251,"discussion_content":"我觉得应该是这样的，在不用连接池的时候，每次查询都要获取连接，查询完成之后调用close方法，这就是短链接，使用连接池之后，因为连接都被放入容器中，每次用完就放进去，而不是close，这种就是长连接","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595492396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549640,"discussion_content":"理解长短连接不是数据库中的一个绝对的定义，只是调用行为上对连接关闭时间的相对的早晚。做三个查询之后再关闭连接相对做两个查询就关闭连接，就是长连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644159684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1992786,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/68/52/23174ee1.jpg","nickname":"yoonhi","note":"","ucode":"857D923DFAEF85","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258861,"discussion_content":"小白疑惑：\n“下次还用这个链接”中的 “这个链接”是指 mysql>mysql -u xxx -p xxx 这个连接吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588734040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1590090,"avatar":"https://static001.geekbang.org/account/avatar/00/18/43/4a/9590fda5.jpg","nickname":"杨宗纬唱哭了我2","note":"","ucode":"B9AA5ADBC27AC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1992786,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/68/52/23174ee1.jpg","nickname":"yoonhi","note":"","ucode":"857D923DFAEF85","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277911,"discussion_content":"退出客户端或者代码中归还连接就是断开连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591113253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":258861,"ip_address":""},"score":277911,"extra":""}]}]},{"had_liked":false,"id":56975,"user_name":"lee","can_delete":false,"product_type":"c1","uid":1182383,"ip_address":"","ucode":"CD672BDB1B58F2","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/af/6f244997.jpg","comment_is_top":false,"comment_ctime":1546590662,"is_pvip":true,"replies":[{"id":"21099","content":"👍","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547116937,"ip_address":"","comment_id":56975,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27316394438","product_id":100020801,"comment_content":"[ MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。] <br>---------------------------------------------------------------------<br>引用原文的一句话, 由此可见, 文末问题错误是在分析器中抛出来的。老师已经在文中给出答案了","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435343,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547116937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133036,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/ec/6bae1fd7.jpg","nickname":"哇咔咔","note":"","ucode":"54BF877836C591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588304,"discussion_content":"实际上并没有抛出来，这可以算是语义分析的范围，就算表里面没有这个字段，在sql编译的阶段，也可以认为这是一个字段","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663658576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39338,"user_name":"bozy","can_delete":false,"product_type":"c1","uid":1214414,"ip_address":"","ucode":"F865EACD05A5FD","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/ce/66e09293.jpg","comment_is_top":false,"comment_ctime":1542250712,"is_pvip":false,"replies":[{"id":"14067","content":"必须做语句分类，延迟敏感的走主库，不敏感的走从库","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542252973,"ip_address":"","comment_id":39338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27312054488","product_id":100020801,"comment_content":"大侠，请教个业务操作表的场景，如果对一个业务数据表的操作既有查询（分页查询批处理），又有更新，此场景下都是操作主库好呢？还是说查询走从库，更新操作走从库？您有没有好的建议呢，如果遇到了此类业务场景您会怎么分析解决此困扰呢？","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429017,"discussion_content":"必须做语句分类，延迟敏感的走主库，不敏感的走从库","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542252973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38796,"user_name":"tonghuan","can_delete":false,"product_type":"c1","uid":1304010,"ip_address":"","ucode":"FFFD5AC9208361","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/ca/eb9abd6c.jpg","comment_is_top":false,"comment_ctime":1542127744,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27311931520","product_id":100020801,"comment_content":"语法分析","like_count":6},{"had_liked":false,"id":163208,"user_name":"陈浩","can_delete":false,"product_type":"c1","uid":1705648,"ip_address":"","ucode":"B75B253D4002C8","user_header":"https://static001.geekbang.org/account/avatar/00/1a/06/b0/067878ae.jpg","comment_is_top":false,"comment_ctime":1576670277,"is_pvip":false,"replies":[{"id":"62112","content":"不是buffer_pool， 是query_cache","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1576722552,"ip_address":"","comment_id":163208,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23051506757","product_id":100020801,"comment_content":"上面说的缓存，是不是buffer pool?  文中说‘MySQL 8.0 版本直接将查询缓存的整块功能删掉了’，指的是 buffer pool吗","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478297,"discussion_content":"不是buffer_pool， 是query_cache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576722552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106034,"user_name":"浪人","can_delete":false,"product_type":"c1","uid":1302727,"ip_address":"","ucode":"D5943CA5C36092","user_header":"","comment_is_top":false,"comment_ctime":1561133995,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"23035970475","product_id":100020801,"comment_content":"老师，您好。文中有个逻辑我不太理解。<br>分析器首先进行词法分析，然后进行语法分析。词法分析会根据关键字select识别出该语句是一条查询语句，然后语法分析判断该语句是否符合MySQL语法。如果select写成了elect，文中说是在语法分析的时候报错。我觉得应该是在词法分析的时候就已经识别不出来elect是查询语句还是其他更新语句，报错应该是发生在词法分析的时候而不是语法分析的时候。<br><br>我做了如下验证：正确表名是user 首先我输入 select * from use；<br>mysql&gt; select * from use;<br>ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;use&#39; at line 1<br>如果词法分析器要把表明use识别成user，此时应该是在词法分析的时候表名没有映射成功而报错。<br><br>mysql&gt; elect * from user;<br>ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;elect * from user&#39; at line 1<br>这个报错我怎么验证是在词法分析报错还是语法分析报错的。<br>辛苦老师帮忙解答一下，非常感谢林老师，我在这里踏踏实实的学到了很多东西。","like_count":5,"discussions":[{"author":{"id":1019568,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","nickname":"CcczzZ","note":"","ucode":"5F46DA5053D2BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37821,"discussion_content":"我的理解，词法分析是分析识别这个 sql 语句各个字符串和空格，识别完之后会生成一个解析树，这时候词法分析就完成了；\n之后就开始语法分析了，语法分析步骤会进一步分析这个解析树是否合法，也就是各个字符是否合法，不合法则返回错误。\n比如  select * from use 是识别成了 select、*、from、use，而语法分析的时候发现use表不存在就报错了","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1571669629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133036,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/ec/6bae1fd7.jpg","nickname":"哇咔咔","note":"","ucode":"54BF877836C591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588305,"discussion_content":"词法分析只做token分割，你也可以在分割的时候顺便做了select判断，但是，这就好比，我用一个软件可以实现世界上所有的功能，这不太好。这属于工程实践终结出来的知识，大家默认了都这么搞。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663658770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1546579,"avatar":"","nickname":"稽山的柚子","note":"","ucode":"E19BCF4604CBB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390072,"discussion_content":"词法分析只能分析出一个SQL语句中各个单词是干什么的，比如select那个词只能分析出是个Mysql的命令，但是并无法分析出是不是查询，真正进行判断是否是查询还是其他命令，是在语法分析的时候做的校验。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629641785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012371,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/93/46895883.jpg","nickname":"terryking","note":"","ucode":"39433F06D6BEF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":87138,"discussion_content":"我觉得也是，编译原理里面一般对于词法分析都是仅仅识别token.然后才是语法分析，看token是否有效，以及个个token的排列顺序是否有问题，最后才是语义分析，看一下这条SQL语句是否有不正确的语义，比如 列名不存在等，个人见解，欢迎批评指正","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576646548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45530,"user_name":"风行年华","can_delete":false,"product_type":"c1","uid":1303474,"ip_address":"","ucode":"427B741831D5E9","user_header":"https://static001.geekbang.org/account/avatar/00/13/e3/b2/cf2412da.jpg","comment_is_top":false,"comment_ctime":1543661956,"is_pvip":false,"replies":[{"id":"16207","content":"连接器阶段是去系统表读数据，结果放在变量；<br><br>执行器使用这个变量","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543666037,"ip_address":"","comment_id":45530,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23018498436","product_id":100020801,"comment_content":"如果用户名密码认证通过，连接器会到权限表里面查出你拥有的权限和执行阶段去查询有没有select的权限这两个有什么区别","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431080,"discussion_content":"连接器阶段是去系统表读数据，结果放在变量；\n\n执行器使用这个变量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543666037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549641,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644159747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39042,"user_name":"依然范德彪","can_delete":false,"product_type":"c1","uid":1133496,"ip_address":"","ucode":"F17B91BF0AA61A","user_header":"https://static001.geekbang.org/account/avatar/00/11/4b/b8/6d3ed13d.jpg","comment_is_top":false,"comment_ctime":1542177877,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23017014357","product_id":100020801,"comment_content":"末尾问题回答：<br>感觉应该是分析器阶段，在做词法分析的时候，分析器应该无法识别字符串 k 是什么以及代表什么","like_count":5},{"had_liked":false,"id":38979,"user_name":"Sunny","can_delete":false,"product_type":"c1","uid":1066562,"ip_address":"","ucode":"D2A4F0C64246CD","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/42/6e0f3754.jpg","comment_is_top":false,"comment_ctime":1542165810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23017002290","product_id":100020801,"comment_content":"MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。<br><br>所以应该是分析器","like_count":5},{"had_liked":false,"id":38965,"user_name":"icephobia","can_delete":false,"product_type":"c1","uid":1284212,"ip_address":"","ucode":"CD383B35994331","user_header":"https://static001.geekbang.org/account/avatar/00/13/98/74/6edfe4c1.jpg","comment_is_top":false,"comment_ctime":1542163170,"is_pvip":false,"replies":[{"id":"13918","content":"嗯其实执行器玩会写入，但是为避免图乱，把这个箭头去掉了，文章中有说明“执行完成后，结果写入查询缓存”的逻辑。👍🏿细致","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542164696,"ip_address":"","comment_id":38965,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23016999650","product_id":100020801,"comment_content":"基本架构图中，分析器指向了查询缓存，是这时候把KEY放入缓存的吗？执行器不指向缓存Value是什么时候放入缓存的？","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428866,"discussion_content":"嗯其实执行器玩会写入，但是为避免图乱，把这个箭头去掉了，文章中有说明“执行完成后，结果写入查询缓存”的逻辑。👍🏿细致","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542164696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"夜辉","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377323,"discussion_content":"那应该由执行器指向查询缓存，因此更新成功需要失效缓存，查询成功需要存储缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622603379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311781,"user_name":"Geek_6a3c4b","can_delete":false,"product_type":"c1","uid":2671226,"ip_address":"","ucode":"94E5A47FEA78BB","user_header":"","comment_is_top":false,"comment_ctime":1631458074,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18811327258","product_id":100020801,"comment_content":"二刷，没进大厂，但是MySQL相关问题全部回答上来了，总包也涨了40%","like_count":4},{"had_liked":false,"id":284332,"user_name":"五河士稻","can_delete":false,"product_type":"c1","uid":1095316,"ip_address":"","ucode":"CB1809F3B739A6","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/94/190de8f4.jpg","comment_is_top":false,"comment_ctime":1616174670,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18796043854","product_id":100020801,"comment_content":"本章思维导图总结：https:&#47;&#47;www.processon.com&#47;view&#47;link&#47;6054ddb4e0b34d3eef2c3b8a#map","like_count":4,"discussions":[{"author":{"id":2731647,"avatar":"","nickname":"Geek_9c7502","note":"","ucode":"69DA982D266365","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532280,"discussion_content":"很棒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637566755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66622,"user_name":"大胖小子","can_delete":false,"product_type":"c1","uid":1302419,"ip_address":"","ucode":"9ED9F3AA0BFC22","user_header":"https://static001.geekbang.org/account/avatar/00/13/df/93/ad66264b.jpg","comment_is_top":false,"comment_ctime":1549968845,"is_pvip":false,"replies":[{"id":"23578","content":"对的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1549978172,"ip_address":"","comment_id":66622,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18729838029","product_id":100020801,"comment_content":"执行器执行阶段，对于有索引的表执行过程不知道我理解对不对。<br>比如表T 字段id 是索引字段，name非索引字段，执行以下sql<br>select * from T where id = 10 and name = &quot;abc&quot;;<br>执行过程我理解是这样的：调用“取满足条件的第一行&quot;接口（这个满足条件就是id=10），<br>引擎返回结果到server层，然后在mysql server层 判断name值是否相等，如果相等放在结果集 继续下次循环。","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438852,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549978172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51373,"user_name":"小李讲源码","can_delete":false,"product_type":"c1","uid":1107484,"ip_address":"","ucode":"2573037D7C82C8","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/1c/9d3744ee.jpg","comment_is_top":false,"comment_ctime":1545179534,"is_pvip":true,"replies":[{"id":"18544","content":"👍🏿","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545183592,"ip_address":"","comment_id":51373,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18725048718","product_id":100020801,"comment_content":"我觉得是分析器，首先分析器的词法分析器会将k识别为一列。但会不会在语法分析器，判断在T表中找不到这一列，而报错。因为下一步是进入到优化器，在优化器之前sql语句应该不会有问题，否则怎么去进行优化。","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433428,"discussion_content":"👍🏿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545183592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50056,"user_name":"苍天大树","can_delete":false,"product_type":"c1","uid":1105668,"ip_address":"","ucode":"DB56B976E8CE5F","user_header":"https://static001.geekbang.org/account/avatar/00/10/df/04/ca6e1f76.jpg","comment_is_top":false,"comment_ctime":1544852436,"is_pvip":false,"replies":[{"id":"18014","content":"可以","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1544874507,"ip_address":"","comment_id":50056,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18724721620","product_id":100020801,"comment_content":"两个不同引擎的mysql 表能联表查询吗？","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432860,"discussion_content":"可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544874507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45556,"user_name":"拓拔泽","can_delete":false,"product_type":"c1","uid":1323257,"ip_address":"","ucode":"1EB797F64CE26D","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/f9/e4e49771.jpg","comment_is_top":false,"comment_ctime":1543671521,"is_pvip":false,"replies":[{"id":"16281","content":"“遍历”这个动作是执行器让做的，<br>引擎给了两个接口：取第一个、取下一个","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543774957,"ip_address":"","comment_id":45556,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18723540705","product_id":100020801,"comment_content":"老师，你好。你在文中写到，执行器会调用引擎提供的借口查询数据。那我是不是可以这么认为，最终遍历数据是引擎来完成当的。","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431092,"discussion_content":"“遍历”这个动作是执行器让做的，\n引擎给了两个接口：取第一个、取下一个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543774957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43170,"user_name":"ashine","can_delete":false,"product_type":"c1","uid":1071194,"ip_address":"","ucode":"774A09CDCCECE6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoMibon3ib2Vyiatnjj5lGiaUjpicP4fa6ZXHtS3F8ia6yibDTbeYkXHAHLqgnMUeJW38TVeX2gnl2mQR51g/132","comment_is_top":false,"comment_ctime":1543194263,"is_pvip":false,"replies":[{"id":"15453","content":"是","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543196333,"ip_address":"","comment_id":43170,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18723063447","product_id":100020801,"comment_content":"MySQL 拿到一个查询请求后，会先到查询缓存看看，之前是不是执行过这条语句。之前执行过的语句及其结果可能会以 key-value 对的形式，被直接缓存在内存中。key 是查询的语句，value 是查询的结果。如果你的查询能够直接在这个缓存中找到 key，那么这个 value 就会被直接返回给客户端。<br><br><br>你好，是不是只要查询的数据表有更新，这个表所有查询缓存全失效?","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430313,"discussion_content":"是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543196333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2347717,"avatar":"https://static001.geekbang.org/account/avatar/00/23/d2/c5/e0531b7f.jpg","nickname":"自由档","note":"","ucode":"9607A3028AC560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":355553,"discussion_content":"只要查询的数据表有操作就更新，这个不用太纠结。【个人理解有错误欢迎支出】比如 select count（*） from student where class = ‘三班’ 这个查询缓存了，但是下一句来句 insert into student （name，class） value (&#39;zhangsan&#39;，‘三班’)。   虽然的查询语句作为key内容没有发生改变，但是两次的查询count（）值已经改变了。   ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615451192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39737,"user_name":"刀斧手何在","can_delete":false,"product_type":"c1","uid":1202572,"ip_address":"","ucode":"B99D7ECC3EE954","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/8c/ba81a832.jpg","comment_is_top":false,"comment_ctime":1542344218,"is_pvip":false,"replies":[{"id":"14252","content":"还是有区别，哪里都不提倡使用select * 😄 <br><br>我跟DBA团队说，看到select * 就打屁股 😝<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542345570,"ip_address":"","comment_id":39737,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18722213402","product_id":100020801,"comment_content":"查询缓存在mysql8后被废弃了，是不是意味着select * 和 select xx，xx（所有字段）并没有查询效率上的区别，哪是提倡使用*，还是所有字段？这个麻烦老师解答一下 ","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429205,"discussion_content":"还是有区别，哪里都不提倡使用select * 😄 \n\n我跟DBA团队说，看到select * 就打屁股 😝\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542345570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39187,"user_name":"沈峰","can_delete":false,"product_type":"c1","uid":1039023,"ip_address":"","ucode":"4C96D8A91BBD05","user_header":"https://static001.geekbang.org/account/avatar/00/0f/da/af/f367790f.jpg","comment_is_top":false,"comment_ctime":1542205643,"is_pvip":false,"replies":[{"id":"14064","content":"存储引擎有缓存的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542250289,"ip_address":"","comment_id":39187,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18722074827","product_id":100020801,"comment_content":"另外，问个问题，如果说没有查询缓存，那么是不是每次查询都要从硬盘扫描结果呢？还是说存储引擎也有缓存数据？","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428958,"discussion_content":"存储引擎有缓存的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542250289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39171,"user_name":"justd","can_delete":false,"product_type":"c1","uid":1197260,"ip_address":"","ucode":"A8857900C9FA18","user_header":"https://static001.geekbang.org/account/avatar/00/12/44/cc/3e62d111.jpg","comment_is_top":false,"comment_ctime":1542202860,"is_pvip":false,"replies":[{"id":"13981","content":"有索引的话，方便直接定位到这一行，不过再sever层还是会判断一下“值对不对”，值对了才算结果的一部分。 所以其实判断过程没省","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542205794,"ip_address":"","comment_id":39171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18722072044","product_id":100020801,"comment_content":"&quot;第一次调用的是 &#39;取满足条件的第一行&#39; 这个接口，之后循环取 &#39;满足条件的下一行&#39; 这个接口&quot;。可以是否理解为：没有索引则根据InnoDB引擎一行一行判断是否符合条件；有索引的话直接提供了满足条件的接口，省去了判断的过程，直接拿到一行符合条件的数据，然后继续取第二行符合条件的数据？这样理解对么？ 谢谢您的答复。<br><br><br>","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428951,"discussion_content":"有索引的话，方便直接定位到这一行，不过再sever层还是会判断一下“值对不对”，值对了才算结果的一部分。 所以其实判断过程没省","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542205794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39147,"user_name":"cc","can_delete":false,"product_type":"c1","uid":1037891,"ip_address":"","ucode":"68E69205A7D5BC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d6/43/0704d7db.jpg","comment_is_top":false,"comment_ctime":1542199064,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18722068248","product_id":100020801,"comment_content":"个人理解：列虽然不存在，但是SQL语法本身没有错误，所以不应该是语法分析阶段处理，但是这种检查也不应该是优化器的职责。<br><br>查了下《高性能MySQL》：优化器之前会进行预处理，根据一些MySQL规则进一步检查解析树是否合法，例如，检查数据表和数据列是否存在，还会解析名字和别名，看看他们是否有歧义。","like_count":4},{"had_liked":false,"id":39107,"user_name":"嘻嘻","can_delete":false,"product_type":"c1","uid":1063149,"ip_address":"","ucode":"C47140EF144225","user_header":"https://static001.geekbang.org/account/avatar/00/10/38/ed/72f73710.jpg","comment_is_top":false,"comment_ctime":1542189440,"is_pvip":false,"replies":[{"id":"13944","content":"是更新缓存的逻辑","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542192155,"ip_address":"","comment_id":39107,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18722058624","product_id":100020801,"comment_content":"分析器到查询缓存的箭头是干嘛的？","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428922,"discussion_content":"是更新缓存的逻辑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1100928,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cc/80/898c1ed1.jpg","nickname":"sea季陪我去看海","note":"","ucode":"D0CA20E815A157","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":552090,"discussion_content":"更新缓存不应该是执行器完成的吗，查询成功则更新缓存，更新成功则失效缓存，为什么是分析器呢老师。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645281481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":428922,"ip_address":""},"score":552090,"extra":""}]},{"author":{"id":2579112,"avatar":"https://static001.geekbang.org/account/avatar/00/27/5a/a8/bfbd5a16.jpg","nickname":"小李小李快乐无比","note":"","ucode":"A4940B575F2C9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369207,"discussion_content":"权限表又在哪里放着呀？连接器从哪里去找权限表呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618973932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1645665,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1c/61/0ca1ca43.jpg","nickname":"蒋腾飞同学","note":"","ucode":"AF72D93DDAC536","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":249930,"discussion_content":"哈哈，也是我想问的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587976417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38797,"user_name":"lfn","can_delete":false,"product_type":"c1","uid":1026593,"ip_address":"","ucode":"2E1558C6A12A89","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/21/6c3ba9af.jpg","comment_is_top":false,"comment_ctime":1542128242,"is_pvip":false,"replies":[{"id":"13899","content":"索引是建在字段（或多个字段）上的，属于表数据的一部分","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542159839,"ip_address":"","comment_id":38797,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18721997426","product_id":100020801,"comment_content":"索引是针对表的么？还是字段？","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428813,"discussion_content":"索引是建在字段（或多个字段）上的，属于表数据的一部分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542159839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100060,"user_name":"Geek_428551","can_delete":false,"product_type":"c1","uid":1562966,"ip_address":"","ucode":"0AA6E218302B71","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKxa4qB9AsN9fIZ4DiaZicLJhWjMibUutVCCep2y0wCic2docfiaARoWbd6a4RQbcnFGOwgMXqDeA1j3Kw/132","comment_is_top":false,"comment_ctime":1559407527,"is_pvip":false,"replies":[{"id":"37465","content":"先了解一下大概<br>然后用<br>碰到问题查<br><br>有一定经验后再系统的看文档吧","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1560473157,"ip_address":"","comment_id":100060,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14444309415","product_id":100020801,"comment_content":"老师，你好，我想问个菜鸟问题，各种数据库sybase，ppstgres，sql server等等数据库，深入学习的方法用怎样的方式好。比如先查看官方文档，接着百度资料，然后等等。。。。其实就是如何系统、有效的去自学？","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452394,"discussion_content":"先了解一下大概\n然后用\n碰到问题查\n\n有一定经验后再系统的看文档吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560473157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61800,"user_name":"钻天鹞子","can_delete":false,"product_type":"c1","uid":1081568,"ip_address":"","ucode":"55286FF8CD295B","user_header":"https://static001.geekbang.org/account/avatar/00/10/80/e0/0f18a1a7.jpg","comment_is_top":false,"comment_ctime":1547802994,"is_pvip":false,"replies":[{"id":"21924","content":"1. 连接阶段只是“获得权限信息”， 真正开始查询动作，才判断“有没有操作这个表的权限” <br>2. 抱歉，是“返回结果”<br>3. 不同的阶段^_^ 执行器阶段是判断一些关联操作，比如更新一行的时候，由于触发器会再更新别的表，这种情况","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547812401,"ip_address":"","comment_id":61800,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14432704882","product_id":100020801,"comment_content":"&quot;在工程实现上，如果命中查询缓存，会在查询缓存放回结果的时候，做权限验证。查询也会在优化器之前调用 precheck 验证权限。&quot;<br>不是很理解这块。<br>1.命中查询缓存之前在连接阶段不是已经做过权限验证了吗,为什么查询缓存放回结果的时候要再做权限验证.<br>2.命中查询缓存后我理解这个查询缓存直接拿出来用就行了,为什么这里还要有个放回动作.<br>3.优化器之前调用 precheck 验证权限和执行阶段的权限验证有何区别.<br>谢谢老师!<br><br>","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436999,"discussion_content":"1. 连接阶段只是“获得权限信息”， 真正开始查询动作，才判断“有没有操作这个表的权限” \n2. 抱歉，是“返回结果”\n3. 不同的阶段^_^ 执行器阶段是判断一些关联操作，比如更新一行的时候，由于触发器会再更新别的表，这种情况","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547812401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58539,"user_name":"锋","can_delete":false,"product_type":"c1","uid":1317630,"ip_address":"","ucode":"FEC205F6C0261A","user_header":"https://static001.geekbang.org/account/avatar/00/14/1a/fe/27eb8a84.jpg","comment_is_top":false,"comment_ctime":1547107842,"is_pvip":false,"replies":[{"id":"21177","content":"不存，直接发给客户端","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547134508,"ip_address":"","comment_id":58539,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14432009730","product_id":100020801,"comment_content":"请教个问题：select * from table  where id = 10；id上无索引，那么就会使用全表扫描的方式一行行调用，此时server层调用存储引擎接口，拿一行在server层判断一行，然后把符合条件行作为结果集，返回给客户端，那么这个结果集是存在哪的？存储这些数据的内存是什么？","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436111,"discussion_content":"不存，直接发给客户端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547134508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1658706,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJeQVzYNLVuOv8IuxydsXuVXEUoqLmN0vpkiceZuU26KPOt05xuxCSnsbkgBu4q9qmibRfTOvCiaPGJg/132","nickname":"Qualifor","note":"","ucode":"8F42453286719C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":537820,"discussion_content":"请问下老师，那这样的话，客户端是有一个地方存着这一行一行从服务端返回来的数据然后合并展示吗？。因为我们从客户端的角度来说的话，直观上来说获取到的是所有满足条件的数据呀～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639208649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":436111,"ip_address":""},"score":537820,"extra":""}]},{"author":{"id":2625319,"avatar":"","nickname":"Geek_c2f914","note":"","ucode":"EF3214A0842D5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374744,"discussion_content":"那这样就成了只要满足条件就一行一行发？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621332881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50816,"user_name":"晓东","can_delete":false,"product_type":"c1","uid":1003385,"ip_address":"","ucode":"8F18CDFD84A97B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4f/79/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1545050153,"is_pvip":false,"replies":[{"id":"18272","content":"没有，不止时间区间，所有类型这两个都是等价操作","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545055398,"ip_address":"","comment_id":50816,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14429952041","product_id":100020801,"comment_content":"老师，时间区间查询，between and跟&lt;=&gt;=有性能差异吗","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433121,"discussion_content":"没有，不止时间区间，所有类型这两个都是等价操作","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40142,"user_name":"某、 ","can_delete":false,"product_type":"c1","uid":1221247,"ip_address":"","ucode":"44360946CCAC8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/7f/cf86eef9.jpg","comment_is_top":false,"comment_ctime":1542521834,"is_pvip":false,"replies":[{"id":"14470","content":"如果没开查询缓存，就直接走分析器的意思","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542542822,"ip_address":"","comment_id":40142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14427423722","product_id":100020801,"comment_content":"你好，关于sql语句执行链路图， 一般来说，连接器通过后，到查询缓存，命中返回，否则到分析器，直到执行器；<br>有个比较傻的问题，那么连接器到分析器，再到查询缓存？这个箭头走向有一些不明白，就是连接器分两个方向到查询缓存和分析器是什么意思，<br>这里不是很懂，请指点一下，谢谢，本人小白","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429393,"discussion_content":"如果没开查询缓存，就直接走分析器的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542542822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40088,"user_name":"莫珂","can_delete":false,"product_type":"c1","uid":1306126,"ip_address":"","ucode":"1BF813EF524DAD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIia6Gwm46GuXYTD6jwPcsQKQHNfUnYETJOEFK9XukRVKdbs9qNhxzLnic4YRH69CltTOqdbnAWPiaqA/132","comment_is_top":false,"comment_ctime":1542468372,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14427370260","product_id":100020801,"comment_content":"看完加深不少理解，受益匪浅。顺便问一下这个图是什么做的？","like_count":3},{"had_liked":false,"id":39620,"user_name":"崛起的小强","can_delete":false,"product_type":"c1","uid":1008717,"ip_address":"","ucode":"BCDF6F1A0FB055","user_header":"","comment_is_top":false,"comment_ctime":1542328925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14427230813","product_id":100020801,"comment_content":"优化阶段。存储引擎提供了很多“handler API”接口，查询中的每一个表由一个handler的实例表示。handler通过这些接口获取表的相关信息，包括表的所有列名、索引统计信息等。MySQL在优化阶段就会为每个表创建一个handler实例，因此在优化阶段会判断出列是否存在。","like_count":3},{"had_liked":false,"id":39165,"user_name":"hellobfy","can_delete":false,"product_type":"c1","uid":1259019,"ip_address":"","ucode":"CDE51E2FFDA4F4","user_header":"","comment_is_top":false,"comment_ctime":1542201838,"is_pvip":false,"replies":[{"id":"13990","content":"对，还有更新语句会去失效query_cache","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542207604,"ip_address":"","comment_id":39165,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14427103726","product_id":100020801,"comment_content":"请问分析器 指向 查询缓存是因为 操作完，分析器会将sql和操作结果的key-value存入缓存吗？ ","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428950,"discussion_content":"对，还有更新语句会去失效query_cache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542207604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38879,"user_name":"JRich","can_delete":false,"product_type":"c1","uid":1114901,"ip_address":"","ucode":"66AE9D61533960","user_header":"https://static001.geekbang.org/account/avatar/00/11/03/15/293a185d.jpg","comment_is_top":false,"comment_ctime":1542156572,"is_pvip":false,"replies":[{"id":"13886","content":"可以同时存在，会区分的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542159159,"ip_address":"","comment_id":38879,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14427058460","product_id":100020801,"comment_content":"一个数据库里可以存在多个存储引擎建立的表吗，server层会做区分吗。","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428837,"discussion_content":"可以同时存在，会区分的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542159159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38806,"user_name":"oygza","can_delete":false,"product_type":"c1","uid":1154320,"ip_address":"","ucode":"802FE0EBE5D20D","user_header":"https://static001.geekbang.org/account/avatar/00/11/9d/10/44f5fc66.jpg","comment_is_top":false,"comment_ctime":1542131334,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14427033222","product_id":100020801,"comment_content":"我猜测应该在分析阶段，根据文章介绍分析器的作用是让mysql知道你要做什么，对语法的分析应该是第一部，语法词法分析完成后应该是解析这条sql到底要执行什么操作，插入还是更新还是建表还是查询，这时mysql应该已经知道你想操作那个表而这个表存不存在，从而才能匹配不同的优化器类","like_count":3},{"had_liked":false,"id":73194,"user_name":"GLADIATOR","can_delete":false,"product_type":"c1","uid":1448564,"ip_address":"","ucode":"6FE14E0BCD6240","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/74/8f7f8786.jpg","comment_is_top":false,"comment_ctime":1551837400,"is_pvip":false,"replies":[{"id":"27092","content":"1. 没看懂你的意思哈，就是sql是key，查询结果是result<br>2. MySQL里面没有这个功能<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1552112595,"ip_address":"","comment_id":73194,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10141771992","product_id":100020801,"comment_content":"老师您好，关于查询缓存，只是上次查询的结果缓存吗，还是只sql代码缓存？mysql类似oracle中的软解析概念吗？也就是存储sql代码缓存吗？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441964,"discussion_content":"1. 没看懂你的意思哈，就是sql是key，查询结果是result\n2. MySQL里面没有这个功能\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552112595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67248,"user_name":"霁月星辰","can_delete":false,"product_type":"c1","uid":1220362,"ip_address":"","ucode":"BC07FB19E7A3F1","user_header":"","comment_is_top":false,"comment_ctime":1550115060,"is_pvip":false,"replies":[{"id":"23797","content":"这取决于是驱动表还是被驱动表；<br><br>你可以先看一下34 35两篇讲join执行流程的哈<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550127257,"ip_address":"","comment_id":67248,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10140049652","product_id":100020801,"comment_content":"老师，优化器部分有一点疑问，麻烦老师解答一下。<br>在执行sql语句的时候，是根据链接条件生成临时表，再根据where条件进行筛选？还是按照您讲解的可以先根据where进行筛选，再进行表的链接呢？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439114,"discussion_content":"这取决于是驱动表还是被驱动表；\n\n你可以先看一下34 35两篇讲join执行流程的哈\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550127257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66265,"user_name":"Geek_477c02","can_delete":false,"product_type":"c1","uid":1218578,"ip_address":"","ucode":"CB9A714A50B977","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/12/a169bdcd.jpg","comment_is_top":false,"comment_ctime":1549900401,"is_pvip":false,"replies":[{"id":"23579","content":"是的，不是BP。 BP是在InnoDB里面维护的，只有InnoDB才；<br><br>执行过程中的临时内存，是在连接对象里","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1549978225,"ip_address":"","comment_id":66265,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10139834993","product_id":100020801,"comment_content":"MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放。<br>这里的内存是什么？不是BP，对吧。","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438768,"discussion_content":"是的，不是BP。 BP是在InnoDB里面维护的，只有InnoDB才；\n\n执行过程中的临时内存，是在连接对象里","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549978225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66259,"user_name":"窗外","can_delete":false,"product_type":"c1","uid":1311172,"ip_address":"","ucode":"1E8F2D9439E7F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/c4/21c2cde4.jpg","comment_is_top":false,"comment_ctime":1549898614,"is_pvip":false,"replies":[{"id":"25027","content":"这个应该很多文档有讲的<br><br>你可以理解为“读写、存取数据在引擎层”， “连接、鉴权<br>、计算在server层”<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551055400,"ip_address":"","comment_id":66259,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10139833206","product_id":100020801,"comment_content":"老师，您好，看后面的文档中多次提到 server 层与 engine，回过来看了下，还是不大清楚这个界限，有什么文档可以参考吗？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438764,"discussion_content":"这个应该很多文档有讲的\n\n你可以理解为“读写、存取数据在引擎层”， “连接、鉴权\n、计算在server层”\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551055400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64397,"user_name":"靈","can_delete":false,"product_type":"c1","uid":1222324,"ip_address":"","ucode":"A6FC817B5A3300","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epesWg3XayWLfUmIXtVp6p3oRXVe7BdzIic3j0vibVP80WSOgN7icSdr3h41UnshYXlsdwHibc7fZtldg/132","comment_is_top":false,"comment_ctime":1548766053,"is_pvip":false,"replies":[{"id":"22807","content":"查询缓存是在分析器阶段之前的<br>只是如果有更新语句，要去失效查询缓存","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1548768660,"ip_address":"","comment_id":64397,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10138700645","product_id":100020801,"comment_content":"为什么分析器完了还要走查询缓存？不是之前查询缓存没命中吗？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437980,"discussion_content":"查询缓存是在分析器阶段之前的\n只是如果有更新语句，要去失效查询缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548768660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1100928,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cc/80/898c1ed1.jpg","nickname":"sea季陪我去看海","note":"","ucode":"D0CA20E815A157","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":552093,"discussion_content":"有更新A表的语句，去失效缓存，失效的是所有的A表的缓存，还是如果存了B表的数据，也会在缓存里被清空。失效的范围是按照表名进行的吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645281790,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":437980,"ip_address":""},"score":552093,"extra":""}]}]},{"had_liked":false,"id":41921,"user_name":"better man","can_delete":false,"product_type":"c1","uid":1314538,"ip_address":"","ucode":"89E50F6762822F","user_header":"https://static001.geekbang.org/account/avatar/00/14/0e/ea/16291abc.jpg","comment_is_top":false,"comment_ctime":1542873345,"is_pvip":false,"replies":[{"id":"15041","content":"不是，不使用查询缓存就不需要维护，就是查到结果不用写到查询缓存去，这个才是最大的收益哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542877747,"ip_address":"","comment_id":41921,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10132807937","product_id":100020801,"comment_content":"老师有个问题请教下，本人小白。就是关于不建议用查询缓存的，虽然查询缓存命中率很低，但是一旦命中不是就能减少查询时间吗。不使用查询缓存是能节省去查询缓存中匹配查询的流程，还有什么其它好处吗？从你说的内容中我还不是很明白不用查询缓存带来了什么好处","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429947,"discussion_content":"不是，不使用查询缓存就不需要维护，就是查到结果不用写到查询缓存去，这个才是最大的收益哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542877747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2020865,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/d6/01/eaa50203.jpg","nickname":"zft","note":"","ucode":"74DEC5FBA610B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278432,"discussion_content":"简而言之就是：查询缓存维护的成本远远大于带来的收益","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591186176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2625319,"avatar":"","nickname":"Geek_c2f914","note":"","ucode":"EF3214A0842D5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2020865,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/d6/01/eaa50203.jpg","nickname":"zft","note":"","ucode":"74DEC5FBA610B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374745,"discussion_content":"想问问这个维护需要我们自己做吗，还是mysql自动做的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621332984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278432,"ip_address":""},"score":374745,"extra":""},{"author":{"id":2408066,"avatar":"https://static001.geekbang.org/account/avatar/00/24/be/82/d7f602da.jpg","nickname":"Geek_czhh8","note":"","ucode":"8872D618FC5B46","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2625319,"avatar":"","nickname":"Geek_c2f914","note":"","ucode":"EF3214A0842D5B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398680,"discussion_content":"查询缓存是在server层发生的，维护缓存也是在server层。因此应该是mysql内部自己维护的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632830763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":374745,"ip_address":""},"score":398680,"extra":""}]}]},{"had_liked":false,"id":41583,"user_name":"zzq","can_delete":false,"product_type":"c1","uid":1234584,"ip_address":"","ucode":"03FE20B812D15D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d6/98/e2d8f2a9.jpg","comment_is_top":false,"comment_ctime":1542809630,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10132744222","product_id":100020801,"comment_content":"分析器， 语法分析器。 词法分析器进行分析出字符串与空格的作用。 语法分析器经营匹配对应。 不知是否正确。","like_count":2},{"had_liked":false,"id":41386,"user_name":"天","can_delete":false,"product_type":"c1","uid":1310629,"ip_address":"","ucode":"664E42100DE272","user_header":"https://static001.geekbang.org/account/avatar/00/13/ff/a5/02953912.jpg","comment_is_top":false,"comment_ctime":1542771872,"is_pvip":false,"replies":[{"id":"14843","content":"更糟糕的是，两天一讲😓","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542779430,"ip_address":"","comment_id":41386,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132706464","product_id":100020801,"comment_content":"最近找工作，恨不得一天看45讲，现在一天一讲感觉好痛苦。。。。。","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429786,"discussion_content":"更糟糕的是，两天一讲😓","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542779430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39882,"user_name":"Hi","can_delete":false,"product_type":"c1","uid":1178546,"ip_address":"","ucode":"B3D28BB9ECBA5B","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/b2/1e37aa5f.jpg","comment_is_top":false,"comment_ctime":1542374622,"is_pvip":false,"replies":[{"id":"14321","content":"这不是一个SQL语句，是一个接口函数哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542377505,"ip_address":"","comment_id":39882,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132309214","product_id":100020801,"comment_content":"请问怎么执行 mysql_reset_connection<br> 输进去是error<br>","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429274,"discussion_content":"这不是一个SQL语句，是一个接口函数哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542377505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39840,"user_name":"轻歌赋","can_delete":false,"product_type":"c1","uid":1251574,"ip_address":"","ucode":"22F62446208805","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg","comment_is_top":false,"comment_ctime":1542364948,"is_pvip":false,"replies":[{"id":"14305","content":"输入密码以后，才开始跟server交互","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542366145,"ip_address":"","comment_id":39840,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132299540","product_id":100020801,"comment_content":"分析器，文章里面说了，大家评论挺好的，我说一下别的问题吧<br>第一个，登录是TCP握手是在mysql指令之后，输入密码之前执行，还是在密码输入之后再执行？<br>额，应该是三个问题，记不得了，看一下文章再问","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429251,"discussion_content":"输入密码以后，才开始跟server交互","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542366145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39215,"user_name":"tobeageek","can_delete":false,"product_type":"c1","uid":1062934,"ip_address":"","ucode":"7E78B925DC0763","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIz50ciaONXadCf0QgqjbJCNq7r6KYpKzGibMic47DDrdym1Bnseq6Sk5lHkLlfOSArlQzw3a6MSrjTw/132","comment_is_top":false,"comment_ctime":1542210942,"is_pvip":false,"replies":[{"id":"14061","content":"命中了query_cache才可以跳过后面阶段，否则就都得走完","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542249988,"ip_address":"","comment_id":39215,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132145534","product_id":100020801,"comment_content":"每一条SQL语句都要执行解析过程吗？比如前后执行两条一模一样的语句？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428966,"discussion_content":"命中了query_cache才可以跳过后面阶段，否则就都得走完","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542249988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39211,"user_name":"秒本","can_delete":false,"product_type":"c1","uid":1182697,"ip_address":"","ucode":"914F3B854CF801","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/e9/2541b8e2.jpg","comment_is_top":false,"comment_ctime":1542210283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10132144875","product_id":100020801,"comment_content":"看一个事儿千万不要直接陷入细节里，你应该先鸟瞰其全貌，这样能够帮助你从高维度理解问题。","like_count":2},{"had_liked":false,"id":39184,"user_name":"沈峰","can_delete":false,"product_type":"c1","uid":1039023,"ip_address":"","ucode":"4C96D8A91BBD05","user_header":"https://static001.geekbang.org/account/avatar/00/0f/da/af/f367790f.jpg","comment_is_top":false,"comment_ctime":1542205507,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10132140099","product_id":100020801,"comment_content":"我认为是优化器，因为查询是否走索引就是在优化器阶段做的，那么这个阶段会判断where条件用了哪些列，哪些咧上有索引。","like_count":2},{"had_liked":false,"id":39043,"user_name":"风中追风","can_delete":false,"product_type":"c1","uid":1184441,"ip_address":"","ucode":"420AE0097EA32D","user_header":"https://static001.geekbang.org/account/avatar/00/12/12/b9/aab42878.jpg","comment_is_top":false,"comment_ctime":1542177945,"is_pvip":false,"replies":[{"id":"13927","content":"是的，用完放回池子里，给别的业务线程复用，变短链为长链","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542178888,"ip_address":"","comment_id":39043,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10132112537","product_id":100020801,"comment_content":"数据库连接池的作用是不是跟mysql服务器建立多个长连接，sql命令在这些固定的连接上进行？","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428890,"discussion_content":"是的，用完放回池子里，给别的业务线程复用，变短链为长链","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542178888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549652,"discussion_content":"Mark，数据库连接池作用，变短链接为长链接，减少连接创建次数。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644164672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38951,"user_name":"nimil","can_delete":false,"product_type":"c1","uid":1197925,"ip_address":"","ucode":"19933068972746","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/65/cce8eb34.jpg","comment_is_top":false,"comment_ctime":1542161642,"is_pvip":false,"replies":[{"id":"13916","content":"不要担心“瞎猜”，我碰到问题也是按照常理先猜测，然后去验证，这种感觉刚刚好😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542163292,"ip_address":"","comment_id":38951,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132096234","product_id":100020801,"comment_content":"感觉是分析器，像mysql这么久经沙场的软件来说，肯定不可能需要打开表这种费时操作才可以确定有哪些列，源码没看过，瞎猜的(⊙o⊙)…","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428859,"discussion_content":"不要担心“瞎猜”，我碰到问题也是按照常理先猜测，然后去验证，这种感觉刚刚好😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542163292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38817,"user_name":"杨逸林","can_delete":false,"product_type":"c1","uid":1167233,"ip_address":"","ucode":"4BF3CF3E2F1AC7","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","comment_is_top":false,"comment_ctime":1542149073,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10132083665","product_id":100020801,"comment_content":"innodb在存储数据的时候，会产生三种文件，一个用来存储表结构，一个是索引，一个是数据。我觉得的应该是执行器这一步的时候，查了表结构","like_count":2,"discussions":[{"author":{"id":1541518,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/8e/fb2c54a0.jpg","nickname":"Flandrelu` ´","note":"","ucode":"6705B950329C3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41090,"discussion_content":"innodb应该是两种文件吧，一种.frm，一种.ibd","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572349130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1167233,"avatar":"https://static001.geekbang.org/account/avatar/00/11/cf/81/96f656ef.jpg","nickname":"杨逸林","note":"","ucode":"4BF3CF3E2F1AC7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1541518,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/8e/fb2c54a0.jpg","nickname":"Flandrelu` ´","note":"","ucode":"6705B950329C3C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50368,"discussion_content":"不好意思，记错了，上面应该是MyISAM，innodb还有个par文件，如果是分区存储的话","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573711844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":41090,"ip_address":""},"score":50368,"extra":""}]}]},{"had_liked":false,"id":326715,"user_name":"许劲松","can_delete":false,"product_type":"c1","uid":2574760,"ip_address":"","ucode":"1356B4C6CE852D","user_header":"https://static001.geekbang.org/account/avatar/00/27/49/a8/bae13c75.jpg","comment_is_top":false,"comment_ctime":1639642100,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5934609396","product_id":100020801,"comment_content":"我对您讲的“不推荐使用查询缓存”这个建议以及理由，感到很困惑。我过去一直使用oracle，其中有一个建议就是，写SQL尽量规矩一致，提高命中率---这个命中率一方面是说explain计划的时候已有同样的SQL，另一方面，oracle它也存在数据缓存。按理说，有这个数据缓存当然好，虽然它经常被清除。 mysql是后起之秀，我不太理解它反而不推荐用这个东西。当然，或许oracle现在也改变了。","like_count":1,"discussions":[{"author":{"id":1133036,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/ec/6bae1fd7.jpg","nickname":"哇咔咔","note":"","ucode":"54BF877836C591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588307,"discussion_content":"可能在那个年代，数据量不大，不怎么频繁更新？反正频繁更新肯定不适合缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663659341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313243,"user_name":"大彬","can_delete":false,"product_type":"c1","uid":2161057,"ip_address":"","ucode":"0079F8151A4BBE","user_header":"https://static001.geekbang.org/account/avatar/00/20/f9/a1/27bf5a31.jpg","comment_is_top":false,"comment_ctime":1632322999,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5927290295","product_id":100020801,"comment_content":"一条语句就相当于一个Helloworld，由浅入深 从头再次学习","like_count":1},{"had_liked":false,"id":313201,"user_name":"To0R𓃰","can_delete":false,"product_type":"c1","uid":1068928,"ip_address":"","ucode":"051BF703650DDF","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/80/75e1a38d.jpg","comment_is_top":false,"comment_ctime":1632309123,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"5927276419","product_id":100020801,"comment_content":"讲的真牛逼啊","like_count":1},{"had_liked":false,"id":298037,"user_name":"大口吃肉喝酒","can_delete":false,"product_type":"c1","uid":2132654,"ip_address":"","ucode":"E429EAD5262AC9","user_header":"https://static001.geekbang.org/account/avatar/00/20/8a/ae/2edc03e9.jpg","comment_is_top":false,"comment_ctime":1623895180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5918862476","product_id":100020801,"comment_content":"执行器调用一次，在引擎内部则扫描了多行，因此引擎扫描行数跟 rows_examined 并不是完全相同的，这个不是很理解，已经看了好几遍了，到这里还是很迷茫，我理解的是执行器是一个方法A，引擎是一个方法B，所有循环判断取数据的逻辑全在方法B，本身就是执行器调用一次，引擎扫描多次，最终的引擎扫描结果和rows_exmained应该是一致的啊","like_count":1},{"had_liked":false,"id":254342,"user_name":"记事本","can_delete":false,"product_type":"c1","uid":1797901,"ip_address":"","ucode":"3E5018B9550296","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6f/0d/7dc0b289.jpg","comment_is_top":false,"comment_ctime":1603102413,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5898069709","product_id":100020801,"comment_content":"梳理下get到的知识<br># mysql 体系架构：server层、存储引擎层<br><br># server层组件：连接器、查询缓存、分析器、优化器、执行器（内置函数的实现、存储过程、触发器视图等）等，以及组件的功能作用<br># 存储引擎层：以插件的架构方式实现，支持InnoDB、MyISAM、Memory 等多个存储引擎，从mysql 5.5 后默认存储引擎是InnoDB<br><br># 一条查询语句的执行流程<br>连接器--查询缓存--分析器--优化器--执行器<br>连接器作用：建立连接、获取权限（身份认证）、维持和管理连接<br>查询缓存：以key-value对的形式存储之前做过的查询，key是查询语句，value是查询的结果，如果正在执行的查询，存在缓存中，那么直接返回结果。<br><br>查询缓存的利弊？<br>利：返回数据效率高<br>弊：查询缓存失效频繁，只要对一个表上的数据有更新，这个表上所有的查询缓存都会被清空。对于一个更新频繁的表来说，缓存下来的数据，还没来得及用就被更新掉了。<br>mysql 8.0版本后，放弃查询缓存功能<br><br>分析器：词法、语法的分析<br>优化器：索引的选择，原则是尽可能扫描少的数据库行纪录<br>执行器：执行sql，注意在执行之前，还会判断你对这个表是否有 执行查询的权限<br><br># 涉及的mysql 参数：<br>Connect_timeout 指的是“连接过程中”的等待时间， <br>wait_timeout    指的是“连接完成后，使用过程中”的等待时间<br><br>怎么查看数据库中的连接状态？<br>&gt; show processlist;","like_count":1},{"had_liked":false,"id":251092,"user_name":"dbtiger","can_delete":false,"product_type":"c1","uid":1324202,"ip_address":"","ucode":"05E8447593318C","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/aa/431de942.jpg","comment_is_top":false,"comment_ctime":1601362840,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5896330136","product_id":100020801,"comment_content":"列不存在是在解析器的语义解析阶段爆出!<br>MySQL的执行器中的对象权限验证阶段，在oracle数据库当中是合并在语义解析当中了。<br>另外查询缓存，Oracle是在设置的内存范围内进行循环写入，这些内存级的操作效率是很高的，Oracle是支持这么干的。另外Oracle可以支持将静态对象keep到内存当中，至于为啥mysql不支持这么干还是有点疑惑？？？","like_count":1},{"had_liked":false,"id":224147,"user_name":"李刚刚","can_delete":false,"product_type":"c1","uid":2030279,"ip_address":"","ucode":"8732C15E5323DD","user_header":"","comment_is_top":false,"comment_ctime":1591285537,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5886252833","product_id":100020801,"comment_content":"我太菜了，第一讲内容和各个大佬的评论就看了一个多小时，难受！！！","like_count":1,"discussions":[{"author":{"id":2716367,"avatar":"https://static001.geekbang.org/account/avatar/00/29/72/cf/6695c570.jpg","nickname":"朱安","note":"","ucode":"56BB4CBFAAF645","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386796,"discussion_content":"你才看2个小时，我已经看2天了，还要验证各种结论","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627805391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2034632,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/0b/c8/15f055d3.jpg","nickname":"图灵机","note":"","ucode":"EB02DB653AD591","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281524,"discussion_content":"巧了，我也是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591758789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223178,"user_name":"少刷票圈多读书","can_delete":false,"product_type":"c1","uid":1514673,"ip_address":"","ucode":"98147AEA7B61DE","user_header":"https://static001.geekbang.org/account/avatar/00/17/1c/b1/12edee24.jpg","comment_is_top":false,"comment_ctime":1591016348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5885983644","product_id":100020801,"comment_content":"借助一条SQL查询语句的执行过程学习了MySQL的框架，主要包括两部分server层和存储引擎层。server层包括连接器、查询缓存、分析器、优化器和执行器，连接器负责建立连接、权限验证、管理连接；分析器负责词法分析和语法分析，优化器用于确定语句的具体执行过程，执行器用于操作数据引擎返回结果。存储引擎层用于存储数据、提供接口。","like_count":1},{"had_liked":false,"id":207857,"user_name":"红颜铭心","can_delete":false,"product_type":"c1","uid":1889026,"ip_address":"","ucode":"18F94E5444C71A","user_header":"","comment_is_top":false,"comment_ctime":1587198306,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5882165602","product_id":100020801,"comment_content":"分析器组成<br>\t解析器<br>\t\t词法分析：将查询分解为多个元素，如：操作关键字、列表&#47;表名和条件关键字等。<br>\t\t语法分析：语法规则校验，生成语法分析树(也叫&quot;解析树&quot;)。<br>\t\t        验证是否使用错误关键字，关键字顺序是否正确，引号是否正确匹配等。<br>\t预处理器：根据mysql规则进一步验证解析树合法性，并生成新的解析树。<br>\t        语义检查：根据语法分析树和系统元信息(information schema)进行语义检查，对语法分析树上的各个节点进行语义分析，判断对象是否存在、是否重名。<br>\t                (数据表和数据列是否存在就在这个阶段)；解析名字和别名，看看他们是否存在歧义。<br>\t        权限验证：验证用户是否有执行权限","like_count":1},{"had_liked":false,"id":193582,"user_name":"探索无止境","can_delete":false,"product_type":"c1","uid":1044178,"ip_address":"","ucode":"91D2A9907DFA79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/d2/7024431c.jpg","comment_is_top":false,"comment_ctime":1584930587,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5879897883","product_id":100020801,"comment_content":"老师您好，我们采用一些连接池产品的时候，默认可以设置创建一批初始化连接，那么这批连接对象后期执行完操作之后，也不会销毁，而是继续放回到连接池中。那这些连接应该也是长连接的方式，如文中所述，“临时使用的内存是管理在连接对象里面的，这些内存资源只有在连接断开的时候才释放，所以长时间积累，可能会导致内存占用太大（OOM）”那这个问题，是不是很容易出现，不知道分析是否有问题？还请老师指正","like_count":1,"discussions":[{"author":{"id":1069548,"avatar":"https://static001.geekbang.org/account/avatar/00/10/51/ec/3d51d5e6.jpg","nickname":"上校","note":"","ucode":"DEE1CEE9E4C680","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295853,"discussion_content":"一般连接池的数量是固定的，不会导致OOM，连接池是为了复用连接，减少创建连接的消耗。连接池的概念本身不会导致OOM。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596367661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012371,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/72/93/46895883.jpg","nickname":"terryking","note":"","ucode":"39433F06D6BEF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":213671,"discussion_content":"连接池中的数据库连接对象会通过wait_timeout这个参数设置进行重置, 重置过后的连接池对象需要重连才可以(应该是框架自动重连).所以这个问题应该不容易复现吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585112438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187696,"user_name":"it_moons_bird","can_delete":false,"product_type":"c1","uid":1906935,"ip_address":"","ucode":"E5D4E0FF03F462","user_header":"https://static001.geekbang.org/account/avatar/00/1d/18/f7/c24531fe.jpg","comment_is_top":false,"comment_ctime":1584194821,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5879162117","product_id":100020801,"comment_content":"我觉得是执行器，分析器它已经知道了表的结构吗，不是执行器才用过引擎去查表吗，应该执行器才知道表的结构，才知道有没有K字段啊<br>","like_count":1},{"had_liked":false,"id":173614,"user_name":"Wings","can_delete":false,"product_type":"c1","uid":1215464,"ip_address":"","ucode":"047167807048EC","user_header":"https://static001.geekbang.org/account/avatar/00/12/8b/e8/7f09a744.jpg","comment_is_top":false,"comment_ctime":1579616294,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5874583590","product_id":100020801,"comment_content":"定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连<br>这里不是很明白，像用java调用mysql，怎么在java程序判断执行过一个占用内存的大查询然后断开连接呢？一般都是用mysql等框架做数据操作，怎么控制这些那么细粒度的断开连接呢？","like_count":1,"discussions":[{"author":{"id":1069548,"avatar":"https://static001.geekbang.org/account/avatar/00/10/51/ec/3d51d5e6.jpg","nickname":"上校","note":"","ucode":"DEE1CEE9E4C680","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295855,"discussion_content":"我觉得是根据人工判断接口返回的数据量的大小","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596367717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106395,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKcg9I9LFukCRm0r06JZFnUrERQVlh7EZqTWibXcMHHAJdLJGIjy4ZvWlXfqCFvRjBW9RoqkwLXibMg/132","nickname":"醉侠","note":"","ucode":"1DE25BF9A15566","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261201,"discussion_content":"同问，如果有答案帮忙@一下，谢谢层主","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588946617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1091017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a5/c9/fa09b9f5.jpg","nickname":"Solofir","note":"","ucode":"7AD71D8CBCAB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":166338,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581385560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148077,"user_name":"半瓶醋","can_delete":false,"product_type":"c1","uid":1282746,"ip_address":"","ucode":"8C898E244D0417","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/ba/9833f06f.jpg","comment_is_top":false,"comment_ctime":1572937698,"is_pvip":true,"replies":[{"id":"57077","content":"一把过😆","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1572953897,"ip_address":"","comment_id":148077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5867904994","product_id":100020801,"comment_content":"正准备面试来抱佛脚啦，第一篇就有收获😁","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473388,"discussion_content":"一把过😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572953897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117809,"user_name":"missing~~","can_delete":false,"product_type":"c1","uid":1583675,"ip_address":"","ucode":"42DDDD1185BFFF","user_header":"https://static001.geekbang.org/account/avatar/00/18/2a/3b/3b938d03.jpg","comment_is_top":false,"comment_ctime":1564134477,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859101773","product_id":100020801,"comment_content":"老师您好，看到您在评论里说  【查询的时候权限不存在是在执行前单独多的一次判断，是为了安全考虑。就是如果没有权限，你连“字段不存在”这个信息都不应该暴露给客户端】这样是不是意味着虽然在分析器里分析出了，sql有问题还是依然会去优化器和执行器这样岂不是浪费资源吗","like_count":1},{"had_liked":false,"id":109987,"user_name":"编程界的小学生","can_delete":false,"product_type":"c1","uid":1593289,"ip_address":"","ucode":"4A5BE9A5E877FA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4f/c9/9f51fd27.jpg","comment_is_top":false,"comment_ctime":1562146233,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5857113529","product_id":100020801,"comment_content":"老师，我有一个疑问：我看连接器和分析器都指向了查询缓存，那么到底是连接器执行完就去查缓存是否命中，还是说先连接器在分析器，分析器验证通过后再去查询缓存呢？","like_count":1,"discussions":[{"author":{"id":2408066,"avatar":"https://static001.geekbang.org/account/avatar/00/24/be/82/d7f602da.jpg","nickname":"Geek_czhh8","note":"","ucode":"8872D618FC5B46","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398678,"discussion_content":"我是这样理解的，\n查询缓存是在分析器之前，这是连接器指向查询缓存的箭头。\n那么分析器指向缓存的箭头呢？是更新语句要清缓存，保证缓存与存储引擎数据一致。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632830545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810051,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK0uyg1IicbEhLwsgM2A2ROoyVdWdmUqZfQfs6G67w9m3hdRNBMOQJatQoACj3qNGgj2KVIgricaYiaQ/132","nickname":"木得感情的编码机器","note":"","ucode":"9C6CD47ADCB8E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":164213,"discussion_content":"看评论才是真的把网课的价值体现完全。\n\n兄弟，我是这样考虑这个问题的：\n首先搞清楚一个问题，就是如果是涉及多表的查询，那么其中个别表查询是否还会去找缓存呢？比如 A join B，如果缓存中存在相同条件的对B表的查询，那么这个join查询会不会去使用这个缓存呢？会不会把B表缓存和A表实时查询结果合并起来处理呢？虽然新版MySQL已经没有查询缓存了，但还是希望老师能回答一下这个问题。\n\n如果复杂查询中的子查询不会去使用缓存，那我觉得分析器其实不需要指向查询缓存。请老师赐教。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581163277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106896,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1561423227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856390523","product_id":100020801,"comment_content":"精彩，专栏精彩，评论也各显神通，极客时间真真是抓住了我们技术人员的渴望社交和自由的饥渴需求。<br>给极客时间提三个小建议：<br>1：看评论时一键返回评论顶部，显示评论数和已阅评论数<br>2：写留言时可以继续查看原文及评论<br>3：对于问题，其他同学也能回答<br>为了加深印象，来个比喻，小结一下吧！<br>(已有同学如此比喻)<br><br>数据库的核心功能就是存取数据，为此提供了CRUD四种功能，删除和修改的前提是先找到-查询，所以，查询是最重要和复杂的事情。<br>007到纽约找定时炸弹<br>1：连接器-007需要先乘飞机从伦敦到纽约<br>2：查询缓存-007到纽约后先问FBI找到炸弹没，若找到直接带回伦敦，若没有继续找<br>3：分析器-007和FBI沟通，找什么炸弹，在什么范围长什么样子<br>4：优化器-FBI分析怎样才能更好更快的找到007要的炸弹<br>5：执行器-纽约警方开始找炸弹<br>6：存储引擎-放炸弹的恐怖分子，知道怎么放，怎么找<br><br>请问老师，数据在硬盘上是怎么放的，真如我们看到的二维表一样嘛？一个表一行行顺序存放？另外，存储引擎咋找的，他拿到表的地址，然后到磁盘的所做位置一行一行找嘛？<br>期待后面会讲到!","like_count":1},{"had_liked":false,"id":104848,"user_name":"在雨中","can_delete":false,"product_type":"c1","uid":1188220,"ip_address":"","ucode":"C4A0B725C8A009","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/7c/940627a7.jpg","comment_is_top":false,"comment_ctime":1560854875,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5855822171","product_id":100020801,"comment_content":"有一个问题，文中`查询缓存`段落下，说‘MySQL 拿到一个查询请求后，会先到查询缓存看看’，但是这个时候mysql怎么知道这是一条查询语句呢。不是应该走到分析器#语法分析步骤的时候才知道当前是不是一个查询请求嘛？希望作者可以回复一下，先3Q为敬","like_count":1},{"had_liked":false,"id":97192,"user_name":"飞机翅膀上","can_delete":false,"product_type":"c1","uid":1515223,"ip_address":"","ucode":"D239DFFECDBF01","user_header":"https://static001.geekbang.org/account/avatar/00/17/1e/d7/7d28a531.jpg","comment_is_top":false,"comment_ctime":1558605372,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5853572668","product_id":100020801,"comment_content":"假如一条语句有数G的数据也会放在缓存么？缓存除了会受表更新而失效，缓存自己是否也有一些自己的维护机制","like_count":1},{"had_liked":false,"id":93866,"user_name":"koala","can_delete":false,"product_type":"c1","uid":1513776,"ip_address":"","ucode":"D4217EF4BD80F7","user_header":"https://static001.geekbang.org/account/avatar/00/17/19/30/66de51ec.jpg","comment_is_top":false,"comment_ctime":1557644552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852611848","product_id":100020801,"comment_content":"想问下是否是在连接器中只是获取了权限 ，在执行器中才判断是否有这个权限，不知道理解的对不。","like_count":1},{"had_liked":false,"id":87866,"user_name":"王先森","can_delete":false,"product_type":"c1","uid":1022267,"ip_address":"","ucode":"1AF1A395107479","user_header":"https://static001.geekbang.org/account/avatar/00/0f/99/3b/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1555736319,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850703615","product_id":100020801,"comment_content":"老师您好,我想请问一下在关联查询中,有没有注意的点,老上上面说join查询的时候优化器会优化,那么我们在写join的时候有没有什么技巧呢?例如:select * from a left join b on a.id=b.id where a.status = 1;","like_count":1},{"had_liked":false,"id":85680,"user_name":"米斯特.杜","can_delete":false,"product_type":"c1","uid":1089110,"ip_address":"","ucode":"C2C567259FDEE2","user_header":"https://static001.geekbang.org/account/avatar/00/10/9e/56/af7a9435.jpg","comment_is_top":false,"comment_ctime":1555171712,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850139008","product_id":100020801,"comment_content":"请问老师，MySQL 的架构图从官网什么地方可以找到，大概翻了一遍5.7的文档没找见。望相告","like_count":1},{"had_liked":false,"id":71189,"user_name":"Aaaaaaaaaaayou","can_delete":false,"product_type":"c1","uid":1073601,"ip_address":"","ucode":"67BA315B87587D","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/c1/93031a2a.jpg","comment_is_top":false,"comment_ctime":1551279682,"is_pvip":false,"replies":[{"id":"25503","content":"对","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551315451,"ip_address":"","comment_id":71189,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5846246978","product_id":100020801,"comment_content":"懂了，这里的连接的长短是由客户端来决定的，mysql 服务端不会主动断开连接，除非到了 waiting_timeout 所设置的时间。请问这样理解正确吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441036,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551315451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69079,"user_name":"谢明辉42","can_delete":false,"product_type":"c1","uid":1423304,"ip_address":"","ucode":"55139190439A5A","user_header":"https://static001.geekbang.org/account/avatar/00/15/b7/c8/96289904.jpg","comment_is_top":false,"comment_ctime":1550656592,"is_pvip":false,"replies":[{"id":"24512","content":"嗯，其实就是分析器和优化器之间","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550667702,"ip_address":"","comment_id":69079,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5845623888","product_id":100020801,"comment_content":"查询也会在优化器之前调用 precheck 验证权限，这句意思是在执行语句优化的时候也会进行权限验证吗？如果在分析阶段已经分析出了所用到的触发器、视图等等，那么我觉的之后只需要进行一次验证就行了吧？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439944,"discussion_content":"嗯，其实就是分析器和优化器之间","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550667702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67792,"user_name":"岛乾坤","can_delete":false,"product_type":"c1","uid":1078898,"ip_address":"","ucode":"2BCE1D04BFB78D","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/72/14c6a943.jpg","comment_is_top":false,"comment_ctime":1550278903,"is_pvip":true,"replies":[{"id":"24015","content":"这里的接口是指“引擎定义好的函数调用方法”，<br>只是这个定义不是乱定义的，<br>MySQL是一个插件式的结构，要求每个引擎以固定的方式提供调用方法。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550299690,"ip_address":"","comment_id":67792,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5845246199","product_id":100020801,"comment_content":"第一次调用的是“取满足条件的第一行”这个接口，之后循环取“满足条件的下一行”这个接口，这些接口都是引擎中已经定义好的。这里面的接口怎么理解，我们在数据库中说的接口是什么。概念，麻烦老师解答一，谢谢。","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439377,"discussion_content":"这里的接口是指“引擎定义好的函数调用方法”，\n只是这个定义不是乱定义的，\nMySQL是一个插件式的结构，要求每个引擎以固定的方式提供调用方法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550299690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549643,"discussion_content":"理解作者的意思是，引擎提供的接口都是mysql定义好的，引擎是要实现这些接口吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644160894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62109,"user_name":"胡楚坚","can_delete":false,"product_type":"c1","uid":1120212,"ip_address":"","ucode":"225883EDF35BED","user_header":"https://static001.geekbang.org/account/avatar/00/11/17/d4/d7a4e6f5.jpg","comment_is_top":false,"comment_ctime":1547916579,"is_pvip":false,"replies":[{"id":"21982","content":"只取id的话，引擎就只返回id给执行器","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547962218,"ip_address":"","comment_id":62109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5842883875","product_id":100020801,"comment_content":"文中执行器模块给的例子sql是select * from ，引擎层返回了一整行数据，请问老师如果我只是select id from ，引擎层是只返回id一列，还是一整行。","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437098,"discussion_content":"只取id的话，引擎就只返回id给执行器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547962218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57946,"user_name":"唐国平","can_delete":false,"product_type":"c1","uid":1365554,"ip_address":"","ucode":"250E3F2193B09C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJvxqeQYY8B3szibRkHEOGDELIMm5PxjNUxDk9ubgNSmAZeFmyNPYKEP3qWZI6fOibIbjSJFibU45tGw/132","comment_is_top":false,"comment_ctime":1546948603,"is_pvip":true,"replies":[{"id":"20884","content":"不能，这个是个api接口，不行用程度调用的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1546950061,"ip_address":"","comment_id":57946,"utype":1}],"discussion_count":1,"race_medal":4,"score":"5841915899","product_id":100020801,"comment_content":"请问如何mysql_reset_connection操作？可以用Navicat，连接完数据库，用命令行页面输入<br>mysql&gt; mysql_reset_connection; 不是这样吧？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435841,"discussion_content":"不能，这个是个api接口，不行用程度调用的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546950061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57044,"user_name":"亮","can_delete":false,"product_type":"c1","uid":1086346,"ip_address":"","ucode":"5B8E59AEA6E3F2","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/8a/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1546607039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841574335","product_id":100020801,"comment_content":"<br>看完整篇文章有个疑问望解答，在执行阶段为什么需判断对表是否有执行查询的权限，而不是在分析阶段去做；根据mysql中的information_schema库的存储信息理论上可以在分析器阶段判断是否有权限。","like_count":1},{"had_liked":false,"id":56658,"user_name":"唐国平","can_delete":false,"product_type":"c1","uid":1365554,"ip_address":"","ucode":"250E3F2193B09C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJvxqeQYY8B3szibRkHEOGDELIMm5PxjNUxDk9ubgNSmAZeFmyNPYKEP3qWZI6fOibIbjSJFibU45tGw/132","comment_is_top":false,"comment_ctime":1546518529,"is_pvip":true,"replies":[{"id":"20426","content":"不会，这个操作没有写binlog,只是更新连接的线程内部数据","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1546524918,"ip_address":"","comment_id":56658,"utype":1}],"discussion_count":1,"race_medal":4,"score":"5841485825","product_id":100020801,"comment_content":"执行 mysql_reset_connection 来重新初始化连接资源，我想请问下，如果在主从DB服务器执行这个操作会影响主从同步吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435173,"discussion_content":"不会，这个操作没有写binlog,只是更新连接的线程内部数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546524918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54506,"user_name":"李醒","can_delete":false,"product_type":"c1","uid":1361841,"ip_address":"","ucode":"8C89C0B7DB97F1","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/b1/8417542f.jpg","comment_is_top":false,"comment_ctime":1545885124,"is_pvip":false,"replies":[{"id":"19797","content":"其实分析器完成后也加了，执行器也有","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545902946,"ip_address":"","comment_id":54506,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840852420","product_id":100020801,"comment_content":"为什么要在生成执行计划后才判断表的权限呢？为什么不在分析器那里处理，而放在执行器里处理啊","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434479,"discussion_content":"其实分析器完成后也加了，执行器也有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545902946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49308,"user_name":"William","can_delete":false,"product_type":"c1","uid":1346215,"ip_address":"","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1544663587,"is_pvip":true,"replies":[{"id":"17765","content":"不会，查询缓存要求语句一摸一样才行，别说你这个参数变了，就算两个语句差异只是多一个空格都不行哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1544679668,"ip_address":"","comment_id":49308,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5839630883","product_id":100020801,"comment_content":"MySQL 拿到一个查询请求后，会先到查询缓存看看，之前是不是执行过这条语句。之前执行过的语句及其结果可能会以 key-value 对的形式，被直接缓存在内存中。key 是查询的语句，value 是查询的结果。如果你的查询能够直接在这个缓存中找到 key，那么这个 value 就会被直接返回给客户端。<br><br><br>老师请问关于上面的这段，如果执行语句相同，仅仅是条件不同，会走查询缓存么？<br><br><br>如：select * from  user where id=6<br><br>        select * from  user where id=7<br><br> 这两句.<br>","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432566,"discussion_content":"不会，查询缓存要求语句一摸一样才行，别说你这个参数变了，就算两个语句差异只是多一个空格都不行哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544679668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45527,"user_name":"陈园","can_delete":false,"product_type":"c1","uid":1061207,"ip_address":"","ucode":"F04D1065FB8D39","user_header":"https://static001.geekbang.org/account/avatar/00/10/31/57/48aadf91.jpg","comment_is_top":false,"comment_ctime":1543660975,"is_pvip":false,"replies":[{"id":"16210","content":"嗯……… 迁移的时候要做好性能压测哈<br><br>这个你得发表结构和SQL语句（脱敏后）发来看看<br><br>5.6&#47;5.7对优化器做过修改，但可能有副作用。<br><br>可能你刚好掉坑","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543666398,"ip_address":"","comment_id":45527,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838628271","product_id":100020801,"comment_content":"自建MySQL服务，数据迁移到阿里云数据库，云数据库没有默认没开查询缓存，有查询没优化，查询比较慢，业务高峰时大量请求，大量相同查询堵塞，未及时发现，最终导致所有数据库服务堵塞，无法提供查询。之前未迁移有加查询缓存，相同查询第一次慢，后面有再查询时，速度很快，没有造成大量堵塞，MySQL服务没出问题。还有个情况是之前MySQL为5.5版本，每个查询都还挺快的，换成5.7后平均慢一倍。对MySQL了解比较粗浅，请老师解惑一下，谢谢","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431078,"discussion_content":"嗯……… 迁移的时候要做好性能压测哈\n\n这个你得发表结构和SQL语句（脱敏后）发来看看\n\n5.6/5.7对优化器做过修改，但可能有副作用。\n\n可能你刚好掉坑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543666398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45326,"user_name":"boil飞","can_delete":false,"product_type":"c1","uid":1305830,"ip_address":"","ucode":"5EAC44B0AAEE97","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/e6/5e6176be.jpg","comment_is_top":false,"comment_ctime":1543588555,"is_pvip":false,"replies":[{"id":"16107","content":"会话不能kill? 这样程序应该升级，正常的程序要能够处理异常连接连接断开哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543600141,"ip_address":"","comment_id":45326,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838555851","product_id":100020801,"comment_content":"遇到了这个问题。数据库所在的docker配了80G内存。但因数据库配置文件里的参数配置不好，通过计算，达到了1024G，而，现在已经到达容器内存100%了。之后我把参数改到合理值，但内存还没降，应该是保持会话的没生效，新会话生效了。现在数据库不能重启，也不能把会话都kill掉。要怎么处理?才能使内存降下来的，老师?","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430984,"discussion_content":"会话不能kill? 这样程序应该升级，正常的程序要能够处理异常连接连接断开哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543600141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44500,"user_name":"ad","can_delete":false,"product_type":"c1","uid":1060556,"ip_address":"","ucode":"7AC650031EB7A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/2e/cc/964a8bcb.jpg","comment_is_top":false,"comment_ctime":1543453717,"is_pvip":false,"replies":[{"id":"16165","content":"就是“读这个表的定义、获取它的表结构”","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543631122,"ip_address":"","comment_id":44500,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5838421013","product_id":100020801,"comment_content":"老师你好，<br>“如果有权限，就打开表继续执行。打开表的时候，执行器就会根据表的引擎定义，去使用这个引擎提供的接口。”<br>打开表是个什么意思？<br><br>","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430779,"discussion_content":"就是“读这个表的定义、获取它的表结构”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543631122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":549644,"discussion_content":"Mak，打开表的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644162471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":430779,"ip_address":""},"score":549644,"extra":""}]}]},{"had_liked":false,"id":44492,"user_name":"嘉嘉☕","can_delete":false,"product_type":"c1","uid":1059771,"ip_address":"","ucode":"632A5CC4B53BB1","user_header":"https://static001.geekbang.org/account/avatar/00/10/2b/bb/5cf70df8.jpg","comment_is_top":false,"comment_ctime":1543453373,"is_pvip":false,"replies":[{"id":"15886","content":"对，both ","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543459081,"ip_address":"","comment_id":44492,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838420669","product_id":100020801,"comment_content":"你可以将参数 query_cache_type 设置成 DEMAND，这样对于默认的 SQL 语句都不使用查询缓存。<br><br>老师，请问<br>“不使用查询缓存”是指：<br>不会把查询结果做缓存？<br>还是不会去查询缓存的结果？<br>谢谢老师","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430776,"discussion_content":"对，both ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543459081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43801,"user_name":"夕夕熊","can_delete":false,"product_type":"c1","uid":1316808,"ip_address":"","ucode":"8B6EFE43841222","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/c8/ca17d37e.jpg","comment_is_top":false,"comment_ctime":1543297202,"is_pvip":false,"replies":[{"id":"15650","content":"读内存。至于空闲，系统有判断规则的😄，比如QPS这类","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543305477,"ip_address":"","comment_id":43801,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5838264498","product_id":100020801,"comment_content":"老师您好，请问一下：Write-Ahead Logging-先写日志再写磁盘，空闲的时候写入磁盘。那么如何判别空闲呢？假如我增加一条数据 ，而这条数据只写入了日志 ，还没来得及写进磁盘，而我还要读取刚写入的这条数据怎么办呢？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430503,"discussion_content":"读内存。至于空闲，系统有判断规则的😄，比如QPS这类","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543305477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":549645,"discussion_content":"Mark，读未落盘数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644162592,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":430503,"ip_address":""},"score":549645,"extra":""}]}]},{"had_liked":false,"id":42936,"user_name":"马若飞","can_delete":false,"product_type":"c1","uid":1046394,"ip_address":"","ucode":"3D0327329A10AE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/7a/55618020.jpg","comment_is_top":false,"comment_ctime":1543114308,"is_pvip":false,"replies":[{"id":"15345","content":"是，但是要知道schema不是表哈，只是用内存用表的形式显示出来","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543132724,"ip_address":"","comment_id":42936,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5838081604","product_id":100020801,"comment_content":"想知道分析器是根据schema那些表里的信息进行字段 表名合法性的判断吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430250,"discussion_content":"是，但是要知道schema不是表哈，只是用内存用表的形式显示出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543132724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42293,"user_name":"zj-de","can_delete":false,"product_type":"c1","uid":1118020,"ip_address":"","ucode":"87DE1988754932","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/44/396d2d8e.jpg","comment_is_top":false,"comment_ctime":1542937698,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837904994","product_id":100020801,"comment_content":"我感觉分析器中的词法分析和语法分析作者像说反了，一个sql语句，应该是先检查select语句是否符合规范，比如select from等关键字是否写错或者漏写，再判断数据库中是否存在表，是否存在字段。我在测试的时候(一条语句关键字错误，表或者字段不存在)是先报You have an error in your SQL syntax 。。。。，把关键字写正确才报没有表或者字段的错误。希望作者解惑~","like_count":1},{"had_liked":false,"id":41428,"user_name":"学徒","can_delete":false,"product_type":"c1","uid":1309414,"ip_address":"","ucode":"9B35DCAEB06E13","user_header":"","comment_is_top":false,"comment_ctime":1542779428,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837746724","product_id":100020801,"comment_content":"基于一位同学提问的和您的回答，赵四同学描述场景下的“select command denied”报错是分析器报错还是执行器报错的呢？还是说，分析器报错“unknown column”之后，逻辑会继续往下走，在执行器中做权限查看报“select command denied”呢？谢谢<br><br>尼古拉斯·赵四<br><br><br>10<br>我创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column”，是不是可以说明是在打开表之后才判断读取的列不存在？<br>2018-11-14<br> 作者回复<br>这个是一个安全方面的考虑。你想想一个用户如果没有查看这个表的权限，你是会告诉他字段不对还是没权限？如果告诉他字段不对，其实给的信息太多了，因为没权限的意思还包含了：没权限知道字段是否存在😄","like_count":1},{"had_liked":false,"id":40863,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1542684540,"is_pvip":false,"replies":[{"id":"14707","content":"MySQL 支持全文检索(fulltext index)的，比顺序遍历快，不过相比于ES这样的系统，MySQL 的全文检索能力还是有待加强😄<br><br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542689199,"ip_address":"","comment_id":40863,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837651836","product_id":100020801,"comment_content":"老师，我问一下！在mysql中的多字段模糊查询同一个值！怎么写的执行效率高？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429637,"discussion_content":"MySQL 支持全文检索(fulltext index)的，比顺序遍历快，不过相比于ES这样的系统，MySQL 的全文检索能力还是有待加强😄\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542689199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40773,"user_name":"lzjun","can_delete":false,"product_type":"c1","uid":1006975,"ip_address":"","ucode":"E8463C74EB3740","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/7f/f22f9224.jpg","comment_is_top":false,"comment_ctime":1542675808,"is_pvip":false,"replies":[{"id":"14692","content":"数据和表结构更新都会","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542680420,"ip_address":"","comment_id":40773,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837643104","product_id":100020801,"comment_content":"“查询缓存的失效非常频繁，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。”<br><br>这里的更新是指对数据的更新还是表结构的更新","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429605,"discussion_content":"数据和表结构更新都会","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542680420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40121,"user_name":"Safufu","can_delete":false,"product_type":"c1","uid":1311806,"ip_address":"","ucode":"D59C3C136D356B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqNKGqOqXlibicdsywqCDMV1IAiaUEibWufvRHQppFsHeZWIVOho02XLTxegcOoaOiarmvQwgl6VevC1VQ/132","comment_is_top":false,"comment_ctime":1542509312,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837476608","product_id":100020801,"comment_content":"对表的权限验证为什么是在执行阶段呢？","like_count":1},{"had_liked":false,"id":40120,"user_name":"武者","can_delete":false,"product_type":"c1","uid":1313648,"ip_address":"","ucode":"C3FF2AB69F5C31","user_header":"https://static001.geekbang.org/account/avatar/00/14/0b/70/a2c1723c.jpg","comment_is_top":false,"comment_ctime":1542509088,"is_pvip":false,"replies":[{"id":"14417","content":"并没有这种固定规则哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542521030,"ip_address":"","comment_id":40120,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837476384","product_id":100020801,"comment_content":"老师  select a.* from a，b 和 select a.* from a inner join b 这两种方式 查询优化器优化的结果会一样吗  是不是不带inner join 的这种优化器可能会优先查b 而带inner join 的 一直会先查a","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429381,"discussion_content":"并没有这种固定规则哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542521030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40041,"user_name":"Liao","can_delete":false,"product_type":"c1","uid":1112384,"ip_address":"","ucode":"F50A05BB3950A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9OswByeEvxkq53icB7zOoqsf8ibnANzf9AOHic74Wh1syFEquOAzHZFIPC9XkptficR47HqXXbg4C8w/132","comment_is_top":false,"comment_ctime":1542450497,"is_pvip":false,"replies":[{"id":"14411","content":"从query_cache查到结果后，结果里面有表的信息，要做权限验证的，权限不够还是报错处理。 ","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542477942,"ip_address":"","comment_id":40041,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5837417793","product_id":100020801,"comment_content":"有一个问题请指教。文中说明权限判断是在执行器中进行的，那么假如查询的语句命中了查询缓存，按流程就直接返回了，那这种情况权限判断是怎么处理的呢？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429347,"discussion_content":"从query_cache查到结果后，结果里面有表的信息，要做权限验证的，权限不够还是报错处理。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542477942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":549647,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644163099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":429347,"ip_address":""},"score":549647,"extra":""}]}]},{"had_liked":false,"id":39933,"user_name":"Chenl07","can_delete":false,"product_type":"c1","uid":1089132,"ip_address":"","ucode":"0A0A086168A8F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0FI2bUjegtznv7XPC9DB9RJaqiaMiamWkibibPOibuUC3DCvI7XMvBANr6sDjRNbc1jwPic9pIaFxrdaib88VqUJKXSTQ/132","comment_is_top":false,"comment_ctime":1542409665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837376961","product_id":100020801,"comment_content":"执行器阶段会检查权限，这个权限检查连接器阶段从引擎中读取的权限还是此时直接从存储引擎中读取的权限。","like_count":1},{"had_liked":false,"id":39918,"user_name":"余向华","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1542383534,"is_pvip":false,"replies":[{"id":"14348","content":"不用判断，连接建立成功后就是连接，断开就是断开。只是我们建议减少创建连接到次数。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542385254,"ip_address":"","comment_id":39918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837350830","product_id":100020801,"comment_content":"老师，关于在连接器方面，在连接器中怎样给新的连接归类为长连接还是短连接的，判断的标准是什么？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429292,"discussion_content":"不用判断，连接建立成功后就是连接，断开就是断开。只是我们建议减少创建连接到次数。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542385254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39849,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1542366722,"is_pvip":false,"replies":[{"id":"14311","content":"重新","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542368997,"ip_address":"","comment_id":39849,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837334018","product_id":100020801,"comment_content":"老师，想问的是比如一条复杂sql，第一次优化完之后执行得到结果。那么第二次来执行这个语句的话。那么它是否会使用第一次优化后的方案？还是重新优化一遍？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429255,"discussion_content":"重新","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542368997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39754,"user_name":"晨思暮语","can_delete":false,"product_type":"c1","uid":1304974,"ip_address":"","ucode":"F21D2FDCDD6B43","user_header":"https://static001.geekbang.org/account/avatar/00/13/e9/8e/6dc15a91.jpg","comment_is_top":false,"comment_ctime":1542347116,"is_pvip":false,"replies":[{"id":"14260","content":"MySQL 不会重用户，都得重新走一遍（这也是MySQL 优化器一直被吐槽的一个点）","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542347522,"ip_address":"","comment_id":39754,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837314412","product_id":100020801,"comment_content":"丁老师，想问下，如果同一条sql重复执行，也是每次都经过优化器阶段重新生成执行计划还是会重用之前的执行计划呢，谢谢！","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429213,"discussion_content":"MySQL 不会重用户，都得重新走一遍（这也是MySQL 优化器一直被吐槽的一个点）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542347522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39729,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1542342950,"is_pvip":false,"replies":[{"id":"14248","content":"查询进度是没有的，<br>如果是查询结束后，看查到多少行，就是MySQL_num_rows. 不过这个跟rows_examined不一样哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542344791,"ip_address":"","comment_id":39729,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837310246","product_id":100020801,"comment_content":"我们有什么办法实时获取目前已查询到多少行的数据了？比如我用php语言怎么调用rows_examined实时获取查询的进度","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429200,"discussion_content":"查询进度是没有的，\n如果是查询结束后，看查到多少行，就是MySQL_num_rows. 不过这个跟rows_examined不一样哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542344791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39556,"user_name":"oliver","can_delete":false,"product_type":"c1","uid":1311316,"ip_address":"","ucode":"5E032A1BAC3490","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/B0hY6AmHia7LrHPuxtdlP1tOaubLvH8wH1PDsQjslnSII0mU9NT2TILNMehxXg4hCLcib2iaic0uo2hEibyR5uHYmicQ/132","comment_is_top":false,"comment_ctime":1542301998,"is_pvip":false,"replies":[{"id":"14155","content":"这个命令是在连接内做的，初始化的是“这个连接自己”","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542302271,"ip_address":"","comment_id":39556,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837269294","product_id":100020801,"comment_content":"请教下， mysql_reset_connection 会重新初始化所有连接吗，还是说可以指定某个连接进行初始化。","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429112,"discussion_content":"这个命令是在连接内做的，初始化的是“这个连接自己”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542302271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39423,"user_name":"Flythewolf","can_delete":false,"product_type":"c1","uid":1284899,"ip_address":"","ucode":"7A8FCF5AEB17E4","user_header":"https://static001.geekbang.org/account/avatar/00/13/9b/23/16f6f004.jpg","comment_is_top":false,"comment_ctime":1542272619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837239915","product_id":100020801,"comment_content":"看流程应该是优化器，在此之前都是检查查询语句的语法等等","like_count":1},{"had_liked":false,"id":39313,"user_name":"王恩俊","can_delete":false,"product_type":"c1","uid":1200691,"ip_address":"","ucode":"6DC662DC128FB2","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/33/283dab06.jpg","comment_is_top":false,"comment_ctime":1542246339,"is_pvip":false,"replies":[{"id":"14051","content":"是说，跟“引擎内扫描行数”不一致哦，这个我会在答疑文章加个例子说明","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542248440,"ip_address":"","comment_id":39313,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837213635","product_id":100020801,"comment_content":"对rows_examined和执行器实际扫描的行数并不是一致的，还是不理解","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429008,"discussion_content":"是说，跟“引擎内扫描行数”不一致哦，这个我会在答疑文章加个例子说明","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542248440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39310,"user_name":"晨思暮语","can_delete":false,"product_type":"c1","uid":1304974,"ip_address":"","ucode":"F21D2FDCDD6B43","user_header":"https://static001.geekbang.org/account/avatar/00/13/e9/8e/6dc15a91.jpg","comment_is_top":false,"comment_ctime":1542246014,"is_pvip":false,"replies":[{"id":"14065","content":"执行器阶段会碰到需要再判断权限的情况，这时候读内存中事先存好的权限，而这个权限是在连接器阶段算出来存进去的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542250399,"ip_address":"","comment_id":39310,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837213310","product_id":100020801,"comment_content":"丁老师，既然在链接阶段已经通过权限表获取了这个该连接所具有的权限，那么在执行阶段再检查一次的意义何在，谢谢！","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429007,"discussion_content":"执行器阶段会碰到需要再判断权限的情况，这时候读内存中事先存好的权限，而这个权限是在连接器阶段算出来存进去的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542250399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39296,"user_name":"gongxt","can_delete":false,"product_type":"c1","uid":1170750,"ip_address":"","ucode":"222C46E0615152","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/3e/c3028cd5.jpg","comment_is_top":false,"comment_ctime":1542244692,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837211988","product_id":100020801,"comment_content":"词法分析的时候应该识别不出来表名等子段，实在语法分析做的哇？","like_count":1},{"had_liked":false,"id":39283,"user_name":"安静","can_delete":false,"product_type":"c1","uid":1212634,"ip_address":"","ucode":"7C4DB6D81A48EB","user_header":"https://static001.geekbang.org/account/avatar/00/12/80/da/9c0c458c.jpg","comment_is_top":false,"comment_ctime":1542243450,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837210746","product_id":100020801,"comment_content":"晚上回去记录一个脑图","like_count":1},{"had_liked":false,"id":39270,"user_name":"twzd","can_delete":false,"product_type":"c1","uid":1008973,"ip_address":"","ucode":"93341A57D39184","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/4d/06bf7890.jpg","comment_is_top":false,"comment_ctime":1542242179,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837209475","product_id":100020801,"comment_content":"分析器阶段","like_count":1},{"had_liked":false,"id":39263,"user_name":"self-discipline","can_delete":false,"product_type":"c1","uid":1024457,"ip_address":"","ucode":"A5AEDCA9ACC68A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/c9/501a1d02.jpg","comment_is_top":false,"comment_ctime":1542241250,"is_pvip":false,"replies":[{"id":"14054","content":"5.7以上就建议用mysql_reset_connection 方法，低版本就定期断开重连","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542248682,"ip_address":"","comment_id":39263,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837208546","product_id":100020801,"comment_content":"问题2:长连接占用内存猛涨的情况下,您提供两种解决方案,您倾向于在生产环境使用什么方案呢? 为什么呢? 或者你评价这两种方案在生产环境有什么优劣呢?","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428987,"discussion_content":"5.7以上就建议用mysql_reset_connection 方法，低版本就定期断开重连","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542248682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39262,"user_name":"self-discipline","can_delete":false,"product_type":"c1","uid":1024457,"ip_address":"","ucode":"A5AEDCA9ACC68A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/c9/501a1d02.jpg","comment_is_top":false,"comment_ctime":1542241152,"is_pvip":false,"replies":[{"id":"14066","content":"这是个好问题，其实就是类似于很多数据排序，或者一个操作复杂的存储过程。这个是可以在测试环境稳定复现的。 <br><br>如果语句都差不多，或者比较随机，或者可以用另外一种方法，比如一个连接执行了N个语句以后做reset这个动作。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542252917,"ip_address":"","comment_id":39262,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837208448","product_id":100020801,"comment_content":"问题1:如果你用的是 MySQL 5.7 或更新版本，可以在每次执行比较大的操作, 请问比较大的操作的判断维度是什么呢? 即怎么判断是比较大的操作","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428986,"discussion_content":"这是个好问题，其实就是类似于很多数据排序，或者一个操作复杂的存储过程。这个是可以在测试环境稳定复现的。 \n\n如果语句都差不多，或者比较随机，或者可以用另外一种方法，比如一个连接执行了N个语句以后做reset这个动作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542252917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39256,"user_name":"如余","can_delete":false,"product_type":"c1","uid":1184565,"ip_address":"","ucode":"C2005B97CE9593","user_header":"https://static001.geekbang.org/account/avatar/00/12/13/35/b6328a05.jpg","comment_is_top":false,"comment_ctime":1542240579,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837207875","product_id":100020801,"comment_content":"分析器中的语法分析提示的错误","like_count":1},{"had_liked":false,"id":39243,"user_name":"keepmoving","can_delete":false,"product_type":"c1","uid":1298237,"ip_address":"","ucode":"931C61D79B7C1F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl56q3vnzqrWWVdDmYb153UClicwTPhYxzIZGDiboZiapYGFvUCvYWFj6o5KFkgk4gao7oQ/132","comment_is_top":false,"comment_ctime":1542238827,"is_pvip":false,"replies":[{"id":"14056","content":"链接池是缓存链接的。要看你说的是哪里实现的链接池哦。比如一些中间件的链接池，确实就需要在放回池子的时候重新初始化","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542248932,"ip_address":"","comment_id":39243,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5837206123","product_id":100020801,"comment_content":"有个疑问：如果长链接会导致内存无法释放，那么链接池是如何实现的呢？难道是定时释放重连么？谢谢","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428979,"discussion_content":"链接池是缓存链接的。要看你说的是哪里实现的链接池哦。比如一些中间件的链接池，确实就需要在放回池子的时候重新初始化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542248932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":549648,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644163818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":428979,"ip_address":""},"score":549648,"extra":""}]}]},{"had_liked":false,"id":39170,"user_name":"DanielAnton","can_delete":false,"product_type":"c1","uid":1308521,"ip_address":"","ucode":"69D49AC70898B0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f7/69/d8dba3de.jpg","comment_is_top":false,"comment_ctime":1542202608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837169904","product_id":100020801,"comment_content":"应该是优化器，分析器只能分析词法和语法是否正确，而优化器会查找索引字段，说明已经可以检查列字段了，这个时候如果发现列字段不存在，就不会生成执行计划，因此我觉得应该是在优化器阶段。","like_count":1},{"had_liked":false,"id":39164,"user_name":"404  had found","can_delete":false,"product_type":"c1","uid":1025939,"ip_address":"","ucode":"BF6983EB50AC74","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a7/93/62f03467.jpg","comment_is_top":false,"comment_ctime":1542201495,"is_pvip":false,"replies":[{"id":"13982","content":"额这个是个好问题，同时也是个大问题… 😄我会记下，放到答疑文章中","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542205902,"ip_address":"","comment_id":39164,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837168791","product_id":100020801,"comment_content":"我想问下，号称性能怪兽的mySQL 8.0 它优化的是哪部分？做了哪些重大的架构调整，还是在SQL执行的各个阶段都做了提升，如何优化的呢？，可以分享下和之前5.0系列的不同之处吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428949,"discussion_content":"额这个是个好问题，同时也是个大问题… 😄我会记下，放到答疑文章中","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542205902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39155,"user_name":"User","can_delete":false,"product_type":"c1","uid":1293849,"ip_address":"","ucode":"078FEC9CB068E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/be/19/2263d3a5.jpg","comment_is_top":false,"comment_ctime":1542200020,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837167316","product_id":100020801,"comment_content":"个人认为分析器只做语法分析，优化器才会真正寻找表基本信息，确定执行方案","like_count":1},{"had_liked":false,"id":39149,"user_name":"果然如此","can_delete":false,"product_type":"c1","uid":1210003,"ip_address":"","ucode":"C7543BD0A67505","user_header":"https://static001.geekbang.org/account/avatar/00/12/76/93/c78a132a.jpg","comment_is_top":false,"comment_ctime":1542199446,"is_pvip":false,"replies":[{"id":"13984","content":"第一个问题我在你提到的那个评论里面有回复了哈。 <br><br>查询缓存占的内存量跟结果集有关。当然MySQL 有参数控制单个结果集的大小上限 （query_cache_limit)， 也有参数控制总量上限 (query_cache)","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542206815,"ip_address":"","comment_id":39149,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837166742","product_id":100020801,"comment_content":"看了一个留言后，对这个问题有点迷惑，如果没有查询权限表也没有这个查询字段，按权限规则应该优先显示无查询权限在执行阶段，但是这个字段没有是个语法错误，又应该在分析阶段被发现？<br><br>还有个问题，查询缓存能占用多大内存，是否查询select 后面的字段有个数多少和缓存优化有关？<br>还有什么其他和缓存优化有关的方案？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428941,"discussion_content":"第一个问题我在你提到的那个评论里面有回复了哈。 \n\n查询缓存占的内存量跟结果集有关。当然MySQL 有参数控制单个结果集的大小上限 （query_cache_limit)， 也有参数控制总量上限 (query_cache)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542206815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39140,"user_name":"蓝色理想","can_delete":false,"product_type":"c1","uid":1015043,"ip_address":"","ucode":"43C8D83DC19A17","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/03/4e71c307.jpg","comment_is_top":false,"comment_ctime":1542197350,"is_pvip":false,"replies":[{"id":"13985","content":"官方不叫5.8，叫8.0了哦。嗯8.0没了","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542206863,"ip_address":"","comment_id":39140,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5837164646","product_id":100020801,"comment_content":"执行器阶段，与语法和优化无关。5.8版本以后就没有查询缓存了吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428937,"discussion_content":"官方不叫5.8，叫8.0了哦。嗯8.0没了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542206863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549649,"discussion_content":"Mark，5.8叫8.0了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644164067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39139,"user_name":"约书亚","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","comment_is_top":false,"comment_ctime":1542196820,"is_pvip":false,"replies":[{"id":"13986","content":"可以的，比如innodb的buffer pool,不过习惯上我们说查询缓存就是指代这个（query_cache)","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542206930,"ip_address":"","comment_id":39139,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837164116","product_id":100020801,"comment_content":"这里提到了查询缓存，除了这个以外，引擎内部各种池和各种数据页，严格的说就不能称作缓存了么？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428936,"discussion_content":"可以的，比如innodb的buffer pool,不过习惯上我们说查询缓存就是指代这个（query_cache)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542206930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39058,"user_name":"坏淡一个","can_delete":false,"product_type":"c1","uid":1118181,"ip_address":"","ucode":"D9C39F4133D9D6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplMzkLgvebhLujCZI0DZAWS7MQGvYGHb4yeoDHdITVWpbSicvoVKw0dISm9ib3vYU7BqxrmuTV666g/132","comment_is_top":false,"comment_ctime":1542180330,"is_pvip":false,"replies":[{"id":"13952","content":"嗯… 这个展开有点多。我们接下来有两篇基础篇会讲到索引。看完那两篇我们再来讨论。这里简单说下就是，优化器会找引擎要到索引的信息，然后决定使用什么接口","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542192939,"ip_address":"","comment_id":39058,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5837147626","product_id":100020801,"comment_content":"“对于有索引的表，调用满足条件的第一行这个接口，之后循环取满足条件的下一行这个接口，接口都是引擎中定义好的。”这句话，没想明白这个逻辑，执行器需要告诉引擎什么吗？不然引擎怎么知道查询条件有没有用到索引？对于里面提到的接口，能再详细解释一下吗？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428897,"discussion_content":"嗯… 这个展开有点多。我们接下来有两篇基础篇会讲到索引。看完那两篇我们再来讨论。这里简单说下就是，优化器会找引擎要到索引的信息，然后决定使用什么接口","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":549650,"discussion_content":"Mark，从作者的回复，可以得到三个消息: 索引保存在引擎里；优化器阶段就已经和引擎打过交道，从引擎获取索引信息；执行器调用的引擎的接口是由优化器决定的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644164442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":428897,"ip_address":""},"score":549650,"extra":""}]}]},{"had_liked":false,"id":39056,"user_name":"坏淡一个","can_delete":false,"product_type":"c1","uid":1118181,"ip_address":"","ucode":"D9C39F4133D9D6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplMzkLgvebhLujCZI0DZAWS7MQGvYGHb4yeoDHdITVWpbSicvoVKw0dISm9ib3vYU7BqxrmuTV666g/132","comment_is_top":false,"comment_ctime":1542180285,"is_pvip":false,"replies":[{"id":"13974","content":"执行器","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542196868,"ip_address":"","comment_id":39056,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5837147581","product_id":100020801,"comment_content":"“调用innodb接口取这个表的第一行，判断ID值是不是10，如果不是则跳过，如果是则将这行存在结果集中。”这句话中的“判断ID值是不是10”，是执行器判断的？还是存储引擎判断的？","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428895,"discussion_content":"执行器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542196868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549651,"discussion_content":"Mark，引擎只管按执行器调用接口取数据，数据判断由执行器做。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644164572,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39018,"user_name":"ken","can_delete":false,"product_type":"c1","uid":1252876,"ip_address":"","ucode":"57D75510608D51","user_header":"https://static001.geekbang.org/account/avatar/00/13/1e/0c/dee72260.jpg","comment_is_top":false,"comment_ctime":1542173182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837140478","product_id":100020801,"comment_content":"语法解析式中，这个阶段就能解析表名和列明了","like_count":1},{"had_liked":false,"id":39015,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1305125,"ip_address":"","ucode":"7AD5F060C54077","user_header":"","comment_is_top":false,"comment_ctime":1542173146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837140442","product_id":100020801,"comment_content":"分析器阶段报出来的吧～","like_count":1},{"had_liked":false,"id":39004,"user_name":"ajlidue","can_delete":false,"product_type":"c1","uid":1308376,"ip_address":"","ucode":"D6B29E941958E8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6NXib2NGaTAAEe2KCcibH2FiafOOD73kQdcuAMGrnRib5CDWXum0SWDOM9NnWicbUsDpghmxEmJtpk9w/132","comment_is_top":false,"comment_ctime":1542170966,"is_pvip":false,"replies":[{"id":"13924","content":"是，已经更新了，赞你看得细致😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542178163,"ip_address":"","comment_id":39004,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837138262","product_id":100020801,"comment_content":"有个笔误，优化器那里，先从表t2取出d=20的记录的ID","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428880,"discussion_content":"是，已经更新了，赞你看得细致😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542178163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38983,"user_name":"棒棒糖","can_delete":false,"product_type":"c1","uid":1306740,"ip_address":"","ucode":"C634E591E4098B","user_header":"https://static001.geekbang.org/account/avatar/00/13/f0/74/f574b540.jpg","comment_is_top":false,"comment_ctime":1542166796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837134092","product_id":100020801,"comment_content":"个人认为是优化器阶段。<br>分析器只是分析语法是否正确，不会检查列是否存在<br>优化器开始选择更优的查询方式，是否有索引之类，这时候已经知道是否存在此字段<br>执行器如果是这个时候才判断，成本太高","like_count":1},{"had_liked":false,"id":38834,"user_name":"付盼星","can_delete":false,"product_type":"c1","uid":1055542,"ip_address":"","ucode":"E0E4B74E8B361F","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/36/abe6d066.jpg","comment_is_top":false,"comment_ctime":1542153541,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5837120837","product_id":100020801,"comment_content":"我觉得是词法分析阶段，没必要等到真正执行时才发现没有那个字段，那语法分析，优化，岂不是很浪费么？对了，老师，怎么看慢日志。","like_count":1,"discussions":[{"author":{"id":1332945,"avatar":"https://static001.geekbang.org/account/avatar/00/14/56/d1/4b5496c0.jpg","nickname":"BUGCREATOR","note":"","ucode":"E4BDCB685ACB0F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":98613,"discussion_content":"星爷牛逼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577177565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38833,"user_name":"这就是编程","can_delete":false,"product_type":"c1","uid":1009348,"ip_address":"","ucode":"4091B3EB368E9F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/66/c4/e87a61ec.jpg","comment_is_top":false,"comment_ctime":1542153278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837120574","product_id":100020801,"comment_content":"语法分析阶段","like_count":1},{"had_liked":false,"id":38823,"user_name":"flying_bird","can_delete":false,"product_type":"c1","uid":1108844,"ip_address":"","ucode":"1C0FAA64A0535A","user_header":"https://static001.geekbang.org/account/avatar/00/10/eb/6c/9f11f6ff.jpg","comment_is_top":false,"comment_ctime":1542151554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837118850","product_id":100020801,"comment_content":"分析器告诉你做什么，优化器告诉你怎么做。查询错误的列很明显干不了，我觉得应该在做什么阶段发现，发现得越早成本越低。我认为答案是分析器","like_count":1},{"had_liked":false,"id":38802,"user_name":"anit","can_delete":false,"product_type":"c1","uid":1306887,"ip_address":"","ucode":"861F77E30FF7FF","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/07/3bed866e.jpg","comment_is_top":false,"comment_ctime":1542129582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837096878","product_id":100020801,"comment_content":"应该是优化器的时候","like_count":1},{"had_liked":false,"id":38798,"user_name":"坐在海边看风车","can_delete":false,"product_type":"c1","uid":1122774,"ip_address":"","ucode":"000ECF64680586","user_header":"https://static001.geekbang.org/account/avatar/00/11/21/d6/45db03e9.jpg","comment_is_top":false,"comment_ctime":1542128643,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837095939","product_id":100020801,"comment_content":"在分析器阶段就会被发现不存在这个column，就会报错","like_count":1},{"had_liked":false,"id":38794,"user_name":"tonghuan","can_delete":false,"product_type":"c1","uid":1304010,"ip_address":"","ucode":"FFFD5AC9208361","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/ca/eb9abd6c.jpg","comment_is_top":false,"comment_ctime":1542127693,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837094989","product_id":100020801,"comment_content":"语法分析","like_count":1},{"had_liked":false,"id":38786,"user_name":"Geek_X","can_delete":false,"product_type":"c1","uid":1288009,"ip_address":"","ucode":"B31587CFEB254C","user_header":"https://static001.geekbang.org/account/avatar/00/13/a7/49/755ee860.jpg","comment_is_top":false,"comment_ctime":1542126542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837093838","product_id":100020801,"comment_content":"飞总说是分析器，我附议，哈哈","like_count":1},{"had_liked":false,"id":38781,"user_name":"阿胖","can_delete":false,"product_type":"c1","uid":1302380,"ip_address":"","ucode":"86FA4A5B694A43","user_header":"https://static001.geekbang.org/account/avatar/00/13/df/6c/0ee21bef.jpg","comment_is_top":false,"comment_ctime":1542125835,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837093131","product_id":100020801,"comment_content":"答案是语义分析吗","like_count":1},{"had_liked":false,"id":360387,"user_name":"beiliu","can_delete":false,"product_type":"c1","uid":1292128,"ip_address":"江苏","ucode":"06E1EC1244A52B","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLmBgic9UlGySyG377pCVzNnbgsGttrKTCFztunJlBTDS32oTyHsJjAFJJsYJyhk9cNE5OZeGKWJ6Q/132","comment_is_top":false,"comment_ctime":1666532313,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1666532313","product_id":100020801,"comment_content":"优化器之前会进行表权限验证","like_count":0},{"had_liked":false,"id":359077,"user_name":"Z东","can_delete":false,"product_type":"c1","uid":1459774,"ip_address":"四川","ucode":"037B2BB2715DBA","user_header":"https://static001.geekbang.org/account/avatar/00/16/46/3e/8c75af6d.jpg","comment_is_top":false,"comment_ctime":1665221776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665221776","product_id":100020801,"comment_content":"文章问题，答案分析器， 分析器的作用就是 分析语法是否正确， 包括 表，字段等是否正确","like_count":0},{"had_liked":false,"id":358984,"user_name":"dyh_zero","can_delete":false,"product_type":"c1","uid":2052088,"ip_address":"江苏","ucode":"98029D72597EF2","user_header":"","comment_is_top":false,"comment_ctime":1665118704,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665118704","product_id":100020801,"comment_content":"林老师，感谢您的专题分享。 <br>关于执行器，循环调用引擎API接口，存储引擎内部会带着条件判断还是执行器接口返回时判断？","like_count":0},{"had_liked":false,"id":358929,"user_name":"Coco","can_delete":false,"product_type":"c1","uid":1260705,"ip_address":"上海","ucode":"DA6D760248F700","user_header":"https://static001.geekbang.org/account/avatar/00/13/3c/a1/15a50ca8.jpg","comment_is_top":false,"comment_ctime":1665038789,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1665038789","product_id":100020801,"comment_content":"是优化器么，分析器识别为列名，优化器进行进一步的判断","like_count":0},{"had_liked":false,"id":358271,"user_name":"Geek_eabafe","can_delete":false,"product_type":"c1","uid":3167302,"ip_address":"北京","ucode":"4D94487320B33B","user_header":"","comment_is_top":false,"comment_ctime":1664160337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664160337","product_id":100020801,"comment_content":"怎么指定建的连接是长连接还是短连接呢","like_count":0},{"had_liked":false,"id":356720,"user_name":"LWD","can_delete":false,"product_type":"c1","uid":1986739,"ip_address":"广东","ucode":"DDA444DB113C01","user_header":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","comment_is_top":false,"comment_ctime":1662532443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662532443","product_id":100020801,"comment_content":"第5次复读。对mysql知无不言","like_count":0},{"had_liked":false,"id":356372,"user_name":"Geek_5b2ab1","can_delete":false,"product_type":"c1","uid":2628460,"ip_address":"北京","ucode":"C1AF841A9F0B6C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK9Yvy5STDw874VEEuPehIcONR9kEq7knIicUNuINU0ovf2ViabhFqiabZiaoXC5FqL89YDCxp3tBnFzA/132","comment_is_top":false,"comment_ctime":1662205438,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662205438","product_id":100020801,"comment_content":"MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放<br><br>像Java和Python都有垃圾回收机制，自动把没有引用的内存回收掉。<br>为什么MySQL不写个垃圾回收，把长时间没访问的内存释放掉？","like_count":0},{"had_liked":false,"id":356258,"user_name":"二饼","can_delete":false,"product_type":"c1","uid":2415448,"ip_address":"重庆","ucode":"48120565D135F7","user_header":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","comment_is_top":false,"comment_ctime":1662090107,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1662090107","product_id":100020801,"comment_content":"分析器-词法分析阶段，MySQL无法解析`k`为任何T中的字段，所以报`Unknown column ‘k’ in ‘where clause’`，如果`k`存在，才会走到分析器-语法分析阶段进行语法正确性判断，才有可能出现`You have an error in your SQL syntax`错误。","like_count":0},{"had_liked":false,"id":355644,"user_name":"Geek_e75873","can_delete":false,"product_type":"c1","uid":2897667,"ip_address":"北京","ucode":"7638992BFC9FAB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLvdkH0jmPBloZycTL2Qu6eqJZKdLF60J0ic2KMoCqyaqR69QSEvXDRg54cicOBe3YRouONCEhjpQcQ/132","comment_is_top":false,"comment_ctime":1661587501,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661587501","product_id":100020801,"comment_content":"&quot;但是全部使用长连接后，你可能会发现，有些时候 MySQL 占用内存涨得特别快，这是因为 MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放。所以如果长连接累积下来，可能导致内存占用太大，被系统强行杀掉（OOM），从现象看就是 MySQL 异常重启了。&quot;<br><br>为什么mysql不能管理连接使用的内存，必须要客户端重连或者重置？这似乎对使用者来说不太友好","like_count":0},{"had_liked":false,"id":355092,"user_name":"吃水不用钱","can_delete":false,"product_type":"c1","uid":1797135,"ip_address":"广东","ucode":"8A5D5978F0D4E5","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6c/0f/7d242cc2.jpg","comment_is_top":false,"comment_ctime":1661072553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661072553","product_id":100020801,"comment_content":"我认为这个会在分析器的阶段报出来。因为在分析器的阶段，已经能够了解到这个sql是要做什么，因此可以将要查询的字段比对，如果表中没有k，就报错，免得浪费资源。","like_count":0},{"had_liked":false,"id":354998,"user_name":"maybe","can_delete":false,"product_type":"c1","uid":1475528,"ip_address":"广西","ucode":"93D160F617E750","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/c8/5ce842f6.jpg","comment_is_top":false,"comment_ctime":1660963745,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1660963745","product_id":100020801,"comment_content":"分析器，表结构不需要真的执行才知道，所以可在分析器里判断","like_count":0},{"had_liked":false,"id":354107,"user_name":"魏斌斌","can_delete":false,"product_type":"c1","uid":1142239,"ip_address":"上海","ucode":"E443EB0504CA37","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/df/dd536ff5.jpg","comment_is_top":false,"comment_ctime":1660099576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660099576","product_id":100020801,"comment_content":"查询的过程好像没提到inner db的buffer pool. 查询一条数据的时候，对应的数据页会加载到内存吗？如果查询的时候数据页已经在buffer pool，那还需要调用inner db接口获取数据吗？","like_count":0},{"had_liked":false,"id":353471,"user_name":"矿仔","can_delete":false,"product_type":"c1","uid":2596393,"ip_address":"北京","ucode":"6F5D60D4F16250","user_header":"https://static001.geekbang.org/account/avatar/00/27/9e/29/a55da673.jpg","comment_is_top":false,"comment_ctime":1659488862,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1659488862","product_id":100020801,"comment_content":"每一次看都有不同的理解，如果我把mysql这部分功能的整体当做一个服务，那我从与mysql的交互开始就相当于调mysql提供的接口，保存接口、更新接口、删除接口、查询接口…，在接口执行的过程中，需要调很多的方法，比如连接器的check方法；查询缓存的get方法；如果get到就返回，没get到就继续分析器的分析方法，方法里又对词法和语法进行的分析；接着又调了优化器的优化方法，比如执行计划的选择，索引的选择，生成一条最终要执行的语句；接着调执行器与引擎层进行交互，调引擎层提供的读写接口。就像我们平时业务逻辑层处理完要调mysql这样的存储层一样，mysql也要调它的“存储层”，也就是引擎层，mysql提供了三种引擎比如MyIsam,Innodb以及Memory。我们调mysql时候知道我们的数据会落库，但是具体是怎么落的我们不关心，所以mysql在调引擎层最终要实现的应该也是数据落在磁盘，这中间又是怎么个落法，用到了哪些临时的内存等等，还不是特别清晰…","like_count":0},{"had_liked":false,"id":353333,"user_name":"Geek_fa1a6e","can_delete":false,"product_type":"c1","uid":1477422,"ip_address":"浙江","ucode":"79B7626D664546","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKIFIzzHKIFPWwKf5MKvO4Ncjib1hbBzFCsGP6A64lkptR81BH9Y6VlwjrUKkd5fdqyoZOpMJogxDA/132","comment_is_top":false,"comment_ctime":1659362095,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1659362095","product_id":100020801,"comment_content":"数据库分成server 层和存储引擎层，server层包含了从链接到执行的部分，存储引擎mysql5.0后默认是innodb。<br>首先是链接，用户名和密码对不对，链接有分为长链接和短链接，长链接会占据太多的内存，有处理机制解决这个问题。<br>分析器分析sql语句有没有错；<br>优化器检查多个索引时使用哪个索引<br>最后，权限判断，执行。","like_count":0},{"had_liked":false,"id":353327,"user_name":"Geek_926921","can_delete":false,"product_type":"c1","uid":2532285,"ip_address":"浙江","ucode":"51C3B0178D77E1","user_header":"","comment_is_top":false,"comment_ctime":1659356815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659356815","product_id":100020801,"comment_content":"虽然最近大佬风评不咋地，但是这专栏质量确实没得说。","like_count":0},{"had_liked":false,"id":353170,"user_name":"Zander J","can_delete":false,"product_type":"c1","uid":3076139,"ip_address":"北京","ucode":"70112D1F2D7E3E","user_header":"https://static001.geekbang.org/account/avatar/00/2e/f0/2b/93e327ee.jpg","comment_is_top":false,"comment_ctime":1659232546,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659232546","product_id":100020801,"comment_content":"分析器。<br>老师，我有个问题，hive sql、spark sql等其他sql的逻辑框架和课上讲解的mysql逻辑框架的不同点有哪些？","like_count":0},{"had_liked":false,"id":351975,"user_name":"Geek_279849","can_delete":false,"product_type":"c1","uid":2699218,"ip_address":"","ucode":"FC6A3514FC955C","user_header":"","comment_is_top":false,"comment_ctime":1658311647,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658311647","product_id":100020801,"comment_content":"打开表，这个操作具体做了什么呢？","like_count":0},{"had_liked":false,"id":351773,"user_name":"宇孤行","can_delete":false,"product_type":"c1","uid":2414655,"ip_address":"","ucode":"DD27C0E0E25BE8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/u8SEH37eggpap7cgY0sU45YgPaN5LUibWW594XCicqZHpIVcRG7t3nOnIGYv2DH9Okl5gssqI0RIXxS1FiaicaEq1w/132","comment_is_top":false,"comment_ctime":1658190128,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658190128","product_id":100020801,"comment_content":"从备份的时间点开始，将备份的 binlog 依次取出来，重放到中午误删表之前的那个时刻。<br>这里没太理解。如果发现是发生在备份之前的误删除，那使用备份的binlog恢复。如果发生在备份之后的，应该使用备份时间点之后，磁盘上当前到误删除时间点的binlog日志来恢复。。不知道理解对不。。","like_count":0},{"had_liked":false,"id":351469,"user_name":"利刃方开","can_delete":false,"product_type":"c1","uid":1144724,"ip_address":"","ucode":"9CB564BE682ED5","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/94/fca5908e.jpg","comment_is_top":false,"comment_ctime":1657810742,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657810742","product_id":100020801,"comment_content":"老师请教个问题：“因为 MySQL 在执行过程中临时使用的内存是管理在连接对象里面的”，<br>这句话是不是说，类似后面说到的 各种buffer的内存，都是管理在连接对象中了？？<br>","like_count":0},{"had_liked":false,"id":351318,"user_name":"墨非","can_delete":false,"product_type":"c1","uid":1024916,"ip_address":"","ucode":"37B3A6E144E25B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a3/94/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1657698230,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657698230","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":350418,"user_name":"Geek_cc2f3e","can_delete":false,"product_type":"c1","uid":2803520,"ip_address":"","ucode":"3319FACD735990","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK0gneax7GPhZs8dFrNbO1ARcpibF6QpzlmUovJJQtnP16PfjeOKSVGibpXlYSbDIcgouOfhw9Cib15g/132","comment_is_top":false,"comment_ctime":1656905565,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656905565","product_id":100020801,"comment_content":"分析器<br>个人分析的是在分析器阶段。因为分析器那个阶段的工作就是检验sql语法，包括sql关键字、表名以及列名等。","like_count":0},{"had_liked":false,"id":349872,"user_name":"黄辉","can_delete":false,"product_type":"c1","uid":2971097,"ip_address":"","ucode":"A56B47AC049C1A","user_header":"","comment_is_top":false,"comment_ctime":1656398110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656398110","product_id":100020801,"comment_content":"mysql create的时候指定存储引擎 每一张表都可以拥有独自的存储引擎嘛？","like_count":0},{"had_liked":false,"id":347936,"user_name":"lcqbug","can_delete":false,"product_type":"c1","uid":1268609,"ip_address":"","ucode":"08FA17F21BCEC5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","comment_is_top":false,"comment_ctime":1654593011,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654593011","product_id":100020801,"comment_content":"为什么走了分析器后还会去查缓存?","like_count":0},{"had_liked":false,"id":346500,"user_name":"Geek_4446c3","can_delete":false,"product_type":"c1","uid":2985540,"ip_address":"","ucode":"27396866F03A61","user_header":"","comment_is_top":false,"comment_ctime":1653201506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653201506","product_id":100020801,"comment_content":"老师，有个问题，执行器章节，你说在执行where id= 10的时候，是一条条查，由执行器判断是否相等做过滤的么，这样效率是不是比较低。之前的理解，这个查询在没有索引时，应该走全表扫描了","like_count":0},{"had_liked":false,"id":346075,"user_name":"说话的鱼","can_delete":false,"product_type":"c1","uid":1388522,"ip_address":"","ucode":"6AAAF108DB678C","user_header":"https://static001.geekbang.org/account/avatar/00/15/2f/ea/a5173a49.jpg","comment_is_top":false,"comment_ctime":1652802679,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652802679","product_id":100020801,"comment_content":"分析器，并且在某种角度mysql的执行逻辑，可以适用于系统架构，缓存，事务，优化，还有三大log","like_count":0},{"had_liked":false,"id":346038,"user_name":"Soyoger","can_delete":false,"product_type":"c1","uid":2967576,"ip_address":"","ucode":"D4D7BD0ABC4491","user_header":"https://static001.geekbang.org/account/avatar/00/2d/48/18/e524f344.jpg","comment_is_top":false,"comment_ctime":1652781862,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652781862","product_id":100020801,"comment_content":"先说答案，是在分析解析阶段。我想从写代码的角度来看这个问题，字段是否存在、正确，表名是否正确等，这些应该放在前面就判断过滤，而不是在所有准备做好执行的时候，临门踩了刹车退出，这样容易浪费资源。","like_count":0},{"had_liked":false,"id":345436,"user_name":"dyingfair","can_delete":false,"product_type":"c1","uid":1414864,"ip_address":"","ucode":"69089E6CC1318B","user_header":"https://static001.geekbang.org/account/avatar/00/15/96/d0/e7d82212.jpg","comment_is_top":false,"comment_ctime":1652269670,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652269670","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":343900,"user_name":"慢慢卢","can_delete":false,"product_type":"c1","uid":1329566,"ip_address":"","ucode":"853D399100D83B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IcDlyK6DaBrssVGlmosXnahdJ4bwCesjXa98iaapSDozBiagZTqSCok6iaktu2wOibvpNv9Pd6nfwMg7N7KTSTzYRw/132","comment_is_top":false,"comment_ctime":1651114997,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651114997","product_id":100020801,"comment_content":"老师，能建一个微信群吧，把订阅的同学加进去，有很多细节需要探讨","like_count":0},{"had_liked":false,"id":342894,"user_name":"静静聆听","can_delete":false,"product_type":"c1","uid":1263932,"ip_address":"","ucode":"0A8600CB928EFE","user_header":"https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg","comment_is_top":false,"comment_ctime":1650525253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650525253","product_id":100020801,"comment_content":"老师，请问innodb的执行流程，是怎么把磁盘的页数据读到内存进行筛选的，是读到server的内存进行筛选还是到innodb的内存进行筛选，还是两者都有","like_count":0},{"had_liked":false,"id":342102,"user_name":"hao-kuai","can_delete":false,"product_type":"c1","uid":1272354,"ip_address":"","ucode":"DFDFDDDBA4503C","user_header":"https://static001.geekbang.org/account/avatar/00/13/6a/22/527904b2.jpg","comment_is_top":false,"comment_ctime":1650015021,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650015021","product_id":100020801,"comment_content":"1.客户端--连接器--分析器--优化器--执行器<br>2.这个过程很符合人沟通的过程：我（客户端）给你打个电话（连接器）请你帮个忙（SQL），从电话中我知道你是谁了心中有数可以帮什么忙（权限），沟通之后你听完之后清楚了要做什么事情（分析器），发现有多种方式，对比只有选择最优方案（优化器），然后就去做事了（执行器）<br>","like_count":0},{"had_liked":false,"id":341538,"user_name":"再见理想","can_delete":false,"product_type":"c1","uid":1245999,"ip_address":"","ucode":"FAC88B3F6F6DFD","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/2f/0a5e0751.jpg","comment_is_top":false,"comment_ctime":1649682555,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649682555","product_id":100020801,"comment_content":"mysql架构包括 server层 和 存储引擎层<br>server层包括 连接器-查询缓存-分析器-优化器-执行器。<br>存储引擎类似于插件式，目前有innodb，myIsam，memery等引擎<br>连接器：负责和客户端建立连接，连接创建后，更新用户权限，对已有连接不会生效，连接还分为长连接和短链接，因为连接是比较耗时的操作，所以尽量用连接池的方式使用长连接，同时也要注意mysql执行时使用的临时内存是存在连接对象里面的，在连接断开时才释放，所以可能会出现内存占用越来越大，最后出现OOM的现象。可以在执行大的查询操作后，主动释放连接，或者执行mysql_reset_connection() 操作。<br>查询缓存：查询的表中有更新，缓存就会被删除，对于写较多的表，缓存意义不大。<br>分析器：对sql词法分析，语义分析，判断sql是否有错误。<br>优化器：生成执行计划，负责选择合适的索引，决定join的驱动表等。<br>执行器：调用存储引擎的接口获取执行结果，并将符合逻辑的数据，存入结果集。","like_count":0},{"had_liked":false,"id":340678,"user_name":"Geek_21673e","can_delete":false,"product_type":"c1","uid":2719208,"ip_address":"","ucode":"BE2C4ABC846FE1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/poo31O8Gibev15vZoDCgQlWM47nhhe6rBmJtAPeib2La7iadhKP09QQ3XKia7DkIt4rwOiaq3fkD0lBv4ibphvSqwfIw/132","comment_is_top":false,"comment_ctime":1649041618,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649041618","product_id":100020801,"comment_content":"应该是分析器阶段","like_count":0},{"had_liked":false,"id":340600,"user_name":"crazydog","can_delete":false,"product_type":"c1","uid":1197324,"ip_address":"","ucode":"31B401C56BB8B4","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/0c/e1c45187.jpg","comment_is_top":false,"comment_ctime":1648970495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648970495","product_id":100020801,"comment_content":"总结：<br>1.mysql服务端分为两层 Server层和 存储引擎层，Server层包含连接器（连接，权限验证）、查询缓存（8.0版本废除）、分析器（词法分析、语法分析）、优化器（执行计划生成索引选择）、执行器（操作存储引擎返回结果）、内置函数、存储过程、触发器、视图等跨存储引擎功能。<br><br>2. 连接器：建立连接后修改账号权限必须重新连接才会生效。连接自动断开wait_timeout 默认8小时。因为建立连接比较复杂建议使用长链接，但是全部使用长连接mysql的内存会涨的特别快，因为mysql执行过程中临时使用的内存都是管理在连接对象内，这些内存只有在连接断开后才会释放，解决方案1定时断开连接（或者执行完占用内存大的查询后断开）方案2mysql版本大于等于5.7可以执行mysql_reset_connection初始化连接资源（这个过程不需要重连和权限验证）。<br><br>3.查询缓存：不建议使用命中率太低更新一张表表内所有缓存失效（8.0版本废除缓存）<br><br>4.分析器：词法分析SQL是什么要干什么，语法分析SQL是否满足mysql语法。<br><br>5. 优化器：决定使用那个索引，多表关联表连接顺序。<br><br>6.执行器：执行前先判断是否具有表的操作权限，然后再调用存储引擎层的读写接口。<br>","like_count":0},{"had_liked":false,"id":339036,"user_name":"风","can_delete":false,"product_type":"c1","uid":2666076,"ip_address":"","ucode":"A27169BABC8D8F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLBYHhb6tvCjfu7TicXqGbUZgVtof4oulCUXiagC9A5qXZjzwEmtrzggU0bibgB1gEmrHBmAgE2xA2Fg/132","comment_is_top":false,"comment_ctime":1647868528,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647868528","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":337039,"user_name":"刘志鹏","can_delete":false,"product_type":"c1","uid":2546103,"ip_address":"","ucode":"FBA7FA3A392D22","user_header":"","comment_is_top":false,"comment_ctime":1646562449,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646562449","product_id":100020801,"comment_content":"对于Buffer Pool 和 Query Cache的区别，林老师是否可以补充下？","like_count":0},{"had_liked":false,"id":336746,"user_name":"Johar","can_delete":false,"product_type":"c1","uid":1101969,"ip_address":"","ucode":"834136A6F64CDC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/91/89123507.jpg","comment_is_top":false,"comment_ctime":1646352390,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1646352390","product_id":100020801,"comment_content":"老师，执行器和引擎交互的时候，会不会将where的条件给引擎？也就是说是server层还是引擎层进行数据过滤？","like_count":0},{"had_liked":false,"id":336325,"user_name":"成为大神","can_delete":false,"product_type":"c1","uid":2926852,"ip_address":"","ucode":"91E2AC4F8AD706","user_header":"https://static001.geekbang.org/account/avatar/00/2c/a9/04/741fb433.jpg","comment_is_top":false,"comment_ctime":1646097648,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646097648","product_id":100020801,"comment_content":"分析器，我觉得是词法分析阶段，词法词法，应该是判断能否识别，语法是语法。","like_count":0},{"had_liked":false,"id":335518,"user_name":"唐家岭大盗","can_delete":false,"product_type":"c1","uid":2916592,"ip_address":"","ucode":"A3CE8BC5BCCC79","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eptSDsykxSicnicBibUOOmC9FOuuFWRaDkJqK69LOe10yQpIibYURwBgDrdqOTSlWPiaNbQ9Y8cMAhaENA/132","comment_is_top":false,"comment_ctime":1645549876,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645549876","product_id":100020801,"comment_content":"不同引擎共用Server层。那么每个引擎对Server层暴露的接口是相同的吗？Server的优化器会根据Table的引擎不同，生成不同的执行计划吗？","like_count":0},{"had_liked":false,"id":335450,"user_name":"SharpBB","can_delete":false,"product_type":"c1","uid":2014573,"ip_address":"","ucode":"D30C5B798B8E8C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/bd/6d/7010f98e.jpg","comment_is_top":false,"comment_ctime":1645522652,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645522652","product_id":100020801,"comment_content":"笔记：<br>连接器<br>\t我们平时连接mysql的命令 其实就用到了连接器<br>\t\tmysql -h$ip -P$port -u$user -p<br>\t\t\t建议不要在p后面加密码 容易导致密码泄漏<br>\t跟服务端建立连接<br>\t\t完成tcp握手后 验证密码<br>\t\t\t当密码通过在查询表里查出拥有的权限<br>\t\t\t这就意味着 除非断开连接 否则即便权限修改 也不影响已经存在的连接<br>\t查询连接状态<br>\t\tshow processlist;<br>\t\t\t图示<br>\t\t\t可以看到 只要一没操作 就为sleep 即处于空闲连接<br>\t\t太长没动静 默认断开时间为8小时<br>\t长短连接<br>\t\t尽量使用长连接 频繁请求都会用那一个连接<br>\t\t而短连接 则是几次查询就断开连接 下次再建一个 频繁的断开与连接很消耗资源<br>\t\t但是要注意长连接日积月累也很容易导致内存占用过大<br>\t\t\t建议<br>\t\t\t\t定期判断程序占用过大的连接 断开重连<br>\t\t\t\t执行大的操作后 执行mysql_reset_connection初始化连接资源<br>\t\t\t\t具体怎么做呢？<br>查询缓存<br>\t执行select就会执行查询缓存 以查询语句为key 结果为value存入缓存中<br>\t\t但mysql8之后就启用了 <br>分析器<br>\t词法分析关键字 表名列名识别出来<br>\t语法分析 根据规则 如果语句不符合某规则 就会报错<br>优化器<br>\t使用哪个索引 先关联哪个表 都是优化器来决定使用哪套方案的<br>执行器<br>\t先查询你对该表有没有查询权限 根据表定义的引擎去执行引擎提供的接口<br>\t\t然后进行比对 这行是否满足 满足加入结果集 再下一行~","like_count":0},{"had_liked":false,"id":334619,"user_name":"伟","can_delete":false,"product_type":"c1","uid":2369399,"ip_address":"","ucode":"72C5C8D7F2A88F","user_header":"https://static001.geekbang.org/account/avatar/00/24/27/77/8493aa4a.jpg","comment_is_top":false,"comment_ctime":1645021026,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645021026","product_id":100020801,"comment_content":"词法分析阶段吧？","like_count":0},{"had_liked":false,"id":333696,"user_name":"Geek_a72007","can_delete":false,"product_type":"c1","uid":2877513,"ip_address":"","ucode":"393E644DA62293","user_header":"","comment_is_top":false,"comment_ctime":1644476964,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644476964","product_id":100020801,"comment_content":"请问老师，这句话 ”这就意味着，一个用户成功建立连接后，即使你用管理员账号对这个用户的权限做了修改，也不会影响已经存在连接的权限。修改完成后，只有再新建的连接才会使用新的权限设置“。我做实验时，如果一个连接用户没有查询权限，登录执行语句“select * from t”，返回SELECT command denied to user &#39;user1&#39;@&#39;127.0.0.1&#39; for table &#39;t&#39;；执行赋予权限语句grant all privileges on demo.t to &#39;user1&#39;@&#39;%&#39;;之前的连接，不用断开就可以直接访问了呀？","like_count":0},{"had_liked":false,"id":331963,"user_name":"极客土豆","can_delete":false,"product_type":"c1","uid":1179126,"ip_address":"","ucode":"CE48C42B8CBE17","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoOFQ3PxxaIRbdp5o3pNxwyrBl2lyK4Il08cF4ZvXpeAhP5WJA0Rw482WibqweYBnviaX8SdO5Bak8g/132","comment_is_top":false,"comment_ctime":1642923374,"is_pvip":true,"replies":[{"id":"121301","content":"iPad 上有个App叫paper，用这个画的哦","user_name":"编辑回复","user_name_real":"编辑","uid":"1059377","ctime":1642988333,"ip_address":"","comment_id":331963,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1642923374","product_id":100020801,"comment_content":"我就想问问大佬，文中的图是用什么软件画的","like_count":0,"discussions":[{"author":{"id":1059377,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2a/31/9edbf8a6.jpg","nickname":"贾静","note":"","ucode":"081E70CC01F6B8","race_medal":0,"user_type":8,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547984,"discussion_content":"iPad 上有个App叫paper，用这个画的哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642988333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331721,"user_name":"Hunter_Dark","can_delete":false,"product_type":"c1","uid":1342279,"ip_address":"","ucode":"3A07CCBC250B69","user_header":"https://static001.geekbang.org/account/avatar/00/14/7b/47/96dad3ff.jpg","comment_is_top":false,"comment_ctime":1642736335,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642736335","product_id":100020801,"comment_content":"预编译是啥？在哪个“器”里面？有同学能解答下吗？","like_count":0},{"had_liked":false,"id":331459,"user_name":"流线胖姑娘","can_delete":false,"product_type":"c1","uid":2875868,"ip_address":"","ucode":"1E1A88AECCD2CA","user_header":"https://static001.geekbang.org/account/avatar/00/2b/e1/dc/29245484.jpg","comment_is_top":false,"comment_ctime":1642593486,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1642593486","product_id":100020801,"comment_content":"老师您好，问个问题，一个没有提交的事务A，它的redo日志有可能在其他事务提交的时候一起从redo buffer刷盘，后面事务A提交的时候，是到磁盘找回原来的redo日志修改成prepare状态还是直接追加？如果是找回原来的日志修改，那假设这个事务A长时间不提交，那么日志文件循环写必定会将这个没提交的日志覆盖，这个问题是怎么处理的？","like_count":0},{"had_liked":false,"id":330921,"user_name":"Boo","can_delete":false,"product_type":"c1","uid":2657938,"ip_address":"","ucode":"71E8EBDBCDD8CE","user_header":"https://static001.geekbang.org/account/avatar/00/28/8e/92/4ea520f5.jpg","comment_is_top":false,"comment_ctime":1642302073,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1642302073","product_id":100020801,"comment_content":"晓斌你好，关于连接器那块你提到因为&quot;mysql在执行过程中临时使用的内存是管理在连接对象里面的&quot;,所以时间长了会发现mysql内存消耗过快，你也给出了2个优化建议。我是想问，如果长连接个数固定后，内存还会持续增长吗？","like_count":0},{"had_liked":false,"id":330433,"user_name":"卖火柴的加菲猫","can_delete":false,"product_type":"c1","uid":2280126,"ip_address":"","ucode":"9146C9E232A156","user_header":"https://static001.geekbang.org/account/avatar/00/22/ca/be/3771706c.jpg","comment_is_top":false,"comment_ctime":1641976736,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641976736","product_id":100020801,"comment_content":"老师好：请问这里说的查询缓存是指mysql得一级缓存和二级缓存吗","like_count":0},{"had_liked":false,"id":329589,"user_name":"孟令超","can_delete":false,"product_type":"c1","uid":1433609,"ip_address":"","ucode":"37916911C0F9D9","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/09/eb3da11d.jpg","comment_is_top":false,"comment_ctime":1641436654,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641436654","product_id":100020801,"comment_content":"优化器是如何工作，是如何选择索引和表连接顺序?","like_count":0},{"had_liked":false,"id":329496,"user_name":"Crecel","can_delete":false,"product_type":"c1","uid":1651288,"ip_address":"","ucode":"42A9EA00A4181A","user_header":"https://static001.geekbang.org/account/avatar/00/19/32/58/e9262995.jpg","comment_is_top":false,"comment_ctime":1641372180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641372180","product_id":100020801,"comment_content":"老师~有一个疑问：您说 MySQL 连接比较复杂，所以尽量使用长连接，“复杂”指的是很消耗资源嘛。那为什么很消耗资源呢。","like_count":0},{"had_liked":false,"id":329232,"user_name":"不再是入门水平python的小宇","can_delete":false,"product_type":"c1","uid":2094450,"ip_address":"","ucode":"D49429660F2DC8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/S5RFBwro1nY4aRN2WkE08G9HicMTz1WzFm1PuHgRMYLbtMA4SZI7A127muWUVAV2CSpCMmHB64g9Zy8a1kVmRcg/132","comment_is_top":false,"comment_ctime":1641226582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641226582","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":329040,"user_name":"否尅淞","can_delete":false,"product_type":"c1","uid":1575510,"ip_address":"","ucode":"27502CCC6C153A","user_header":"https://static001.geekbang.org/account/avatar/00/18/0a/56/52a9d95a.jpg","comment_is_top":false,"comment_ctime":1641041819,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641041819","product_id":100020801,"comment_content":"请问mysql 缓存池，写缓存是在哪里呢？和读取缓存有什么差异呢？","like_count":0},{"had_liked":false,"id":328706,"user_name":"davie","can_delete":false,"product_type":"c1","uid":1111550,"ip_address":"","ucode":"9924F03041E153","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/fe/69042bc4.jpg","comment_is_top":false,"comment_ctime":1640849283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640849283","product_id":100020801,"comment_content":"是在分析器的词法分析环节。","like_count":0},{"had_liked":false,"id":328470,"user_name":"杨丁","can_delete":false,"product_type":"c1","uid":1008597,"ip_address":"","ucode":"D469B0BCA86587","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/d5/a300899a.jpg","comment_is_top":false,"comment_ctime":1640746882,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640746882","product_id":100020801,"comment_content":"内容总结：<br>连接器：负责连接的管理、维护。<br>查询缓存：顾名思义，对查询结构进行缓存从而提升查询速度。弊大于利，不建议使用，MySQL 8.0去除了该模块。<br>分析器：可分为解析器和预处理器两个阶段，解析器用于生成解析树，预处理器会做校验。<br>优化器：基于分析器阶段生成的解析树，选择最优的执行计划。原则上，访问磁盘最少的执行计划更优。<br>执行器：基于优化器阶段确定的执行计划执行查询，通过调用存储引擎的接口来获取查询结果。<br><br>课后答案：分析器。<br>高性能MySQL中将分析器分为解析器和预处理器两个阶段，解析器通过词法分析、语法分析生成解析树；预处理器会校验表是否存在、列是否存在、别名是否重复等逻辑。","like_count":0},{"had_liked":false,"id":328036,"user_name":"$兜兜里有钱","can_delete":false,"product_type":"c1","uid":1105031,"ip_address":"","ucode":"731AE27A13EC1D","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/87/1901ddaa.jpg","comment_is_top":false,"comment_ctime":1640494052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640494052","product_id":100020801,"comment_content":"mysql执行过程中临时文件的内存是在连接里的，java中连接池或者其他语言链接吃又是如何做这部分优化去防止mysql的oom的。mysql_reset_connection()在mysql客户端如何去执行这个api哈","like_count":0},{"had_liked":false,"id":327490,"user_name":"一个无趣的俗人","can_delete":false,"product_type":"c1","uid":1691669,"ip_address":"","ucode":"25435088B10CA2","user_header":"https://static001.geekbang.org/account/avatar/00/19/d0/15/5851180d.jpg","comment_is_top":false,"comment_ctime":1640146260,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1640146260","product_id":100020801,"comment_content":"专栏过去两年多了，最近开始三刷。总结一下问题：<br><br>1、什么是 MySQL 长连接&#47;短连接？你使用的业务框架使用的是哪一种？如果使用长连接，如何优化 MySQL 内存占用？<br><br>2、要不要关闭 MySQL 查询缓存？查询缓存什么时候会失效？如果一定要使用查询缓存，有没有什么建议？<br><br>3、能否讲讲一条 SQL 查询语句是如何执行的？<br><br>4、为什么 MySQL 对权限的检查不在优化器之前做？","like_count":0,"discussions":[{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586293,"discussion_content":"缓存模块已经在MySQL8.x之后移除了，是否要关闭`MySQL查询缓存`这个问题已经没有必要问了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662092383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326719,"user_name":"许劲松","can_delete":false,"product_type":"c1","uid":2574760,"ip_address":"","ucode":"1356B4C6CE852D","user_header":"https://static001.geekbang.org/account/avatar/00/27/49/a8/bae13c75.jpg","comment_is_top":false,"comment_ctime":1639643195,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1639643195","product_id":100020801,"comment_content":"请教您：你本课中提到说（大意），用户的权限被修改后，对于已经连接的session无法生效，而必须下次连接。这一点不知是否还有什么条件？我揣摩您可能讲这个还有一些附加的条件，比如，哪些权限可以立即全部生效，哪些得待到重新连接。  因我过去一直用oracle，似乎都是立即生效的。我想mysql应当不会比oracle差。 谢谢您。","like_count":0},{"had_liked":false,"id":323694,"user_name":"爸爸爱宝宝","can_delete":false,"product_type":"c1","uid":2856297,"ip_address":"","ucode":"B64E84F5A0B5C7","user_header":"https://static001.geekbang.org/account/avatar/00/2b/95/69/2a997877.jpg","comment_is_top":false,"comment_ctime":1638100301,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638100301","product_id":100020801,"comment_content":"课后答案我想到的是分析器，我想的是，如果我是mysql设计者，我会尽早把能报的错先报出来，越早做出错误提示越好。因此，分析器在分析过程中，已经知道表名和列名，此时，无需做任何后续消耗资源的操作，就能知道发生啥错误，此时报错，消耗最少。","like_count":0},{"had_liked":false,"id":322419,"user_name":"Gabriel","can_delete":false,"product_type":"c1","uid":1437358,"ip_address":"","ucode":"714772A93E93DC","user_header":"https://static001.geekbang.org/account/avatar/00/15/ee/ae/855b7e6e.jpg","comment_is_top":false,"comment_ctime":1637378008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637378008","product_id":100020801,"comment_content":"看第二遍的时候，印象深刻一些。SQL执行过程，联想到代码的执行过程，肯定也是需要进行词法、语法分析最后执行，也想到在浏览器上是怎么执行的，在最细的还想到内存中代码，是如何分配执行的。对比、分析。加深印象。<br>https:&#47;&#47;juejin.cn&#47;post&#47;7032483815817904159&#47;","like_count":0},{"had_liked":false,"id":321870,"user_name":"二三","can_delete":false,"product_type":"c1","uid":2836722,"ip_address":"","ucode":"1DA4CD09497082","user_header":"https://static001.geekbang.org/account/avatar/00/2b/48/f2/a5044f0a.jpg","comment_is_top":false,"comment_ctime":1637074472,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637074472","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":321661,"user_name":"Gabriel","can_delete":false,"product_type":"c1","uid":1437358,"ip_address":"","ucode":"714772A93E93DC","user_header":"https://static001.geekbang.org/account/avatar/00/15/ee/ae/855b7e6e.jpg","comment_is_top":false,"comment_ctime":1636982779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636982779","product_id":100020801,"comment_content":"有一个很好的延伸，就是输入一条sql和将一段url输入浏览器，到看到返回结果都经历哪些过程。","like_count":0},{"had_liked":false,"id":321402,"user_name":"祉幻","can_delete":false,"product_type":"c1","uid":1648334,"ip_address":"","ucode":"ABE19FE8A6A15E","user_header":"https://static001.geekbang.org/account/avatar/00/19/26/ce/acb6c140.jpg","comment_is_top":false,"comment_ctime":1636854623,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636854623","product_id":100020801,"comment_content":"有个问题，我们普通的springboot项目，发起一次查询，或者修改，连接到数据库，是使用的数据库连接池的长连接嘛？","like_count":0},{"had_liked":false,"id":320566,"user_name":"Shall_we_talk ?","can_delete":false,"product_type":"c1","uid":2648914,"ip_address":"","ucode":"9F5E7523D5F8FF","user_header":"https://static001.geekbang.org/account/avatar/00/28/6b/52/b9830e86.jpg","comment_is_top":false,"comment_ctime":1636381885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636381885","product_id":100020801,"comment_content":"老师可以帮我看下我的理解对不对吗<br>1. 一定是在建立连接之后；<br>2. 缓存一定不能确认。缓存中若存在k字段，而命题一个表没有k，该字段一定是从有到无，缓存并不能判断；反之若缓存没有该字段，则无法报错。<br>3. 分析器是做词法及语法分析，将单词识别为表名或列名，并分析这个语句的意图。所以判断出有无这个列一定是在分析器之后。<br>4. 优化器即是负责执行方案的选择。会涉及索引的选择，k本身作为一列，一定要先判断这一列是否是索引列，才能进行索引选择。在判断是否是索引的时候，一定要先判断是否有这一列。<br>综上所述，我认为判断出这个错误的阶段应该是分析器后，优化器前。","like_count":0},{"had_liked":false,"id":320410,"user_name":"menfre","can_delete":false,"product_type":"c1","uid":1925314,"ip_address":"","ucode":"D55E03C5F0217C","user_header":"https://static001.geekbang.org/account/avatar/00/1d/60/c2/ca220fd0.jpg","comment_is_top":false,"comment_ctime":1636297633,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636297633","product_id":100020801,"comment_content":"会在语法分析器的阶段报出来","like_count":0},{"had_liked":false,"id":320392,"user_name":"Geek_22363b","can_delete":false,"product_type":"c1","uid":2838413,"ip_address":"","ucode":"1FC96C22A84F29","user_header":"","comment_is_top":false,"comment_ctime":1636290832,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636290832","product_id":100020801,"comment_content":"登录时不用指定用户吗？","like_count":0},{"had_liked":false,"id":320198,"user_name":"mark for luck","can_delete":false,"product_type":"c1","uid":1798114,"ip_address":"","ucode":"877AC961687A93","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/P7GtgVmSNibiaZY9ibCiaohicscwb03j1ROjJUqFkCOnkMQv5JQXZia56nmhOtxr2jOBUfMS94zsvXvnw7RbtpO0dJbQ/132","comment_is_top":false,"comment_ctime":1636116894,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636116894","product_id":100020801,"comment_content":"在学习mysql时，首先应避免陷入细节，先鸟瞰全貌；分两个大层：server层、存储引擎层。<br>server层里面依次的连接器、查询缓存器、分析器、优化器和执行器--mysql大多数核心服务功能、内置函数、跨存储引擎功能。<br>存储引擎层：插件式，InnoDB、MylSAM、Memory--数据的存储和提取。<br>问题：如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？答案是分析器","like_count":0},{"had_liked":false,"id":319859,"user_name":"🌻","can_delete":false,"product_type":"c1","uid":1509651,"ip_address":"","ucode":"9B4D8CA8C09A70","user_header":"https://static001.geekbang.org/account/avatar/00/17/09/13/d762ce74.jpg","comment_is_top":false,"comment_ctime":1635991510,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635991510","product_id":100020801,"comment_content":"分析器，分析器识别语法","like_count":0},{"had_liked":false,"id":319143,"user_name":"luxinfeng","can_delete":false,"product_type":"c1","uid":1259853,"ip_address":"","ucode":"51D0046C4D31AD","user_header":"https://static001.geekbang.org/account/avatar/00/13/39/4d/9ce28826.jpg","comment_is_top":false,"comment_ctime":1635611665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635611665","product_id":100020801,"comment_content":"是在分析器阶段报出来的，分析器会在词法分析阶段判断语句中的各个字符代表什么，这时候就会判断出存不存在字段k","like_count":0},{"had_liked":false,"id":317797,"user_name":"一个卖火柴的老男人","can_delete":false,"product_type":"c1","uid":1181265,"ip_address":"","ucode":"1227638C457F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/51/1d24ead6.jpg","comment_is_top":false,"comment_ctime":1634972684,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634972684","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":316911,"user_name":"Geek_7de5c5","can_delete":false,"product_type":"c1","uid":2816189,"ip_address":"","ucode":"8226F480278EF1","user_header":"","comment_is_top":false,"comment_ctime":1634609587,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634609587","product_id":100020801,"comment_content":"这变成了一个学习生态了，而不仅仅是学习课程，赞。","like_count":0},{"had_liked":false,"id":316751,"user_name":"名字是乱打的","can_delete":false,"product_type":"c1","uid":2218105,"ip_address":"","ucode":"A1E27CD0219A8D","user_header":"https://static001.geekbang.org/account/avatar/00/21/d8/79/9797c1f6.jpg","comment_is_top":false,"comment_ctime":1634540968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634540968","product_id":100020801,"comment_content":"求问本文里提到的缓存是指buffer_pool吗","like_count":0},{"had_liked":false,"id":316518,"user_name":"闫城哲","can_delete":false,"product_type":"c1","uid":1624846,"ip_address":"","ucode":"1903E022DF6A6F","user_header":"https://static001.geekbang.org/account/avatar/00/18/cb/0e/a9fee0b6.jpg","comment_is_top":false,"comment_ctime":1634368545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634368545","product_id":100020801,"comment_content":"我认为是在分析器部分报出来的,因为分析器部分做的操作是检查语法错误","like_count":0},{"had_liked":false,"id":315963,"user_name":"杨珂","can_delete":false,"product_type":"c1","uid":1156381,"ip_address":"","ucode":"3CD45E0F7A119D","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/1d/071a4d3c.jpg","comment_is_top":false,"comment_ctime":1634088493,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1634088493","product_id":100020801,"comment_content":"分析器： 语法分析阶段会对关键词正确性做出验证，这里的关键词处理SQL关键词以外，还应该包括列名这种","like_count":0},{"had_liked":false,"id":314803,"user_name":"林凡尘哥哥","can_delete":false,"product_type":"c1","uid":1688379,"ip_address":"","ucode":"F740616035448F","user_header":"https://static001.geekbang.org/account/avatar/00/19/c3/3b/c1f9240d.jpg","comment_is_top":false,"comment_ctime":1633441824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633441824","product_id":100020801,"comment_content":"既然优化器会“执行计划”，那缺了字段是会在优化器报出错误提示的","like_count":0},{"had_liked":false,"id":314622,"user_name":"张策","can_delete":false,"product_type":"c1","uid":1434941,"ip_address":"","ucode":"471F3A9D1F158F","user_header":"https://static001.geekbang.org/account/avatar/00/15/e5/3d/e9cf1a67.jpg","comment_is_top":false,"comment_ctime":1633264509,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633264509","product_id":100020801,"comment_content":"mysql整体可以划分为：连接器、分析器、优化器、执行器、存储引擎层。连接器用于接受客户端的连接，校验用户名和密码的正确性，权限的控制。连接的方式为长连接和短连接，默认使用长连接，但是长连接会导致mysql出现OOM的风险，所以需要定时断开或者对连接进行初始化。常见的用户名和密码不合法，too many Connection都是该层抛出的。分析器用于对sql语句进行词法分析和语法分析，mysql抛出的语法错误由该层抛出，课后的问题的答案就连接层。优化器用于确定语句的执行顺序，是否使用索引。执行器用于调用存储引擎执行优化后的sql语句。","like_count":0},{"had_liked":false,"id":314606,"user_name":"wolfe","can_delete":false,"product_type":"c1","uid":2790647,"ip_address":"","ucode":"1B8EEE32A9E0C4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/94/f7/870c7f6c.jpg","comment_is_top":false,"comment_ctime":1633255263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633255263","product_id":100020801,"comment_content":"分析我觉得在分析器在“词法分析”这一步就会报错。文章内提到“将字符串&quot;T&quot;识别为&quot;表T&quot;，字符串&quot;ID&quot;识别为&quot;字段ID&quot;”，那么再这个阶段无法识别字符串&quot;k&quot;之后就会报错了","like_count":0},{"had_liked":false,"id":314061,"user_name":"幼稚园的小朋友","can_delete":false,"product_type":"c1","uid":2725596,"ip_address":"","ucode":"EF63C355BD58A7","user_header":"https://static001.geekbang.org/account/avatar/00/29/96/dc/8adf8971.jpg","comment_is_top":false,"comment_ctime":1632822019,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1632822019","product_id":100020801,"comment_content":"您好 老师 请问一下mysql_reset_connection这个方法该在哪里去执行呢","like_count":0,"discussions":[{"author":{"id":2415448,"avatar":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","nickname":"二饼","note":"","ucode":"48120565D135F7","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586294,"discussion_content":"这不是一个MySQL Client 可以执行的命令，而是一个API接口：https://dev.mysql.com/doc/c-api/8.0/en/mysql-reset-connection.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662092552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313747,"user_name":"ckkjksj","can_delete":false,"product_type":"c1","uid":2044909,"ip_address":"","ucode":"AEE1FE4F0D1DAC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIAEp2HUau1omIib99ib4LbW6QdkazqVicickjZvUr3MkFSQa8g87QjKkiawKg9XktyAJ2tibDfG2lgnO6w/132","comment_is_top":false,"comment_ctime":1632645041,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632645041","product_id":100020801,"comment_content":"如果没有命中查询缓存，就要开始真正执行语句了。首先，MySQL 需要知道你要做什么，因此需要对 SQL 语句做解析。分析器先会做“词法分析”。你输入的是由多个字符串和空格组成的一条 SQL 语句，MySQL 需要识别出里面的字符串分别是什么，代表什么。MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。做完了这些识别以后，就要做“语法分析”。根据词法分析的结果，语法分析器会根据语法规则，判断你输入的这个 SQL 语句是否满足 MySQL 语法。如果你的语句不对，就会收到“You have an error in your SQL syntax”的错误提醒，比如下面这个语句 select 少打了开头的字母“s”。 这原文已经就告诉了答案 为啥还会是执行器 优化器 首先连 解析器就已经错了 优化器是针对解析出正确的语句 有多种执行方案然后选中最优的 最后是执行器去执行。","like_count":0},{"had_liked":false,"id":313724,"user_name":"帝都牛人","can_delete":false,"product_type":"c1","uid":1027982,"ip_address":"","ucode":"53EC02284680C7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/af/8e/6f0f4a56.jpg","comment_is_top":false,"comment_ctime":1632636307,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632636307","product_id":100020801,"comment_content":"应该是在分析器层，确定表和列的时候没发现，进而报错","like_count":0},{"had_liked":false,"id":313398,"user_name":"未聞花名","can_delete":false,"product_type":"c1","uid":2142672,"ip_address":"","ucode":"8BE87AC2CEA286","user_header":"https://static001.geekbang.org/account/avatar/00/20/b1/d0/8c94d49e.jpg","comment_is_top":false,"comment_ctime":1632406684,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632406684","product_id":100020801,"comment_content":" “Unknown column ‘k’ in ‘where clause’ ，应该是在分析器阶段报错，因为在解析列名的时候没有成功","like_count":0},{"had_liked":false,"id":313342,"user_name":"特立独行的猪","can_delete":false,"product_type":"c1","uid":1465344,"ip_address":"","ucode":"1440F96375740A","user_header":"https://static001.geekbang.org/account/avatar/00/16/5c/00/5d11e68d.jpg","comment_is_top":false,"comment_ctime":1632383457,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632383457","product_id":100020801,"comment_content":"最终还是没有闹明白you have an error in your SQL syntax ，这个是在词法分析里还是在语法分析里报错?  这里的分析器，应该就是其他文章对应的解析器和预处理器，我也没有闹明白解析器如果是做sql解析，检查语法是否正确，那预处理器是干啥用？","like_count":0},{"had_liked":false,"id":313225,"user_name":"非墨","can_delete":false,"product_type":"c1","uid":2739046,"ip_address":"","ucode":"6C2F75B04DA1EB","user_header":"https://static001.geekbang.org/account/avatar/00/29/cb/66/c34226a9.jpg","comment_is_top":false,"comment_ctime":1632317489,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632317489","product_id":100020801,"comment_content":"创建连接后，会查询缓存，并且进行权限认证。是先查找缓存还是先认证权限？如果先认证权限，并且未命中缓存，在后续执行时还会权限认证嘛？","like_count":0},{"had_liked":false,"id":313209,"user_name":"VIC","can_delete":false,"product_type":"c1","uid":1343938,"ip_address":"","ucode":"805246B9ABE16C","user_header":"https://static001.geekbang.org/account/avatar/00/14/81/c2/314460b8.jpg","comment_is_top":false,"comment_ctime":1632311093,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632311093","product_id":100020801,"comment_content":"答案 分析器。mysql连接分为几个过程，走缓存，然后查询，8.0缓存已经没了。","like_count":0},{"had_liked":false,"id":313203,"user_name":"Yina","can_delete":false,"product_type":"c1","uid":2656811,"ip_address":"","ucode":"56B3F2DC006273","user_header":"https://static001.geekbang.org/account/avatar/00/28/8a/2b/260231af.jpg","comment_is_top":false,"comment_ctime":1632309416,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632309416","product_id":100020801,"comment_content":"以前学sql也就是学学学个select等语句，从来没有想到底层原理。真的是收益匪浅啊。要坚持学习","like_count":0},{"had_liked":false,"id":313130,"user_name":"Prisoner","can_delete":false,"product_type":"c1","uid":2679253,"ip_address":"","ucode":"AE469ACC071692","user_header":"https://static001.geekbang.org/account/avatar/00/28/e1/d5/c57a4bd8.jpg","comment_is_top":false,"comment_ctime":1632289512,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632289512","product_id":100020801,"comment_content":"温故而知新，常学常新的课程。","like_count":0},{"had_liked":false,"id":313074,"user_name":"Geek_zsy","can_delete":false,"product_type":"c1","uid":2138826,"ip_address":"","ucode":"5CCCBCC16882BF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/w6PB0WPSSfKWNsrdGDultuASOyGAW3HaSicN8rzBS7xQpHxGhpYQ9p61bL43ErnNLsUWtr1JU6PP9jZRISTbpnA/132","comment_is_top":false,"comment_ctime":1632271016,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632271016","product_id":100020801,"comment_content":"那一次查询就要多次调用引擎接口了，这里如果可以从原码展开就更好了🤔 ","like_count":0},{"had_liked":false,"id":313033,"user_name":"峰老板牛逼","can_delete":false,"product_type":"c1","uid":2771960,"ip_address":"","ucode":"5D4EB2F72A86A3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/4b/f8/918870c5.jpg","comment_is_top":false,"comment_ctime":1632219643,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632219643","product_id":100020801,"comment_content":"我觉得在分析器阶段报错，因为没有字段K的话，在词法分析会不过关","like_count":0},{"had_liked":false,"id":312378,"user_name":"冬冬~","can_delete":false,"product_type":"c1","uid":2764936,"ip_address":"","ucode":"92306E794E0996","user_header":"https://static001.geekbang.org/account/avatar/00/2a/30/88/28d37ee0.jpg","comment_is_top":false,"comment_ctime":1631779731,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631779731","product_id":100020801,"comment_content":"请问存储引擎层的架构模式是插件式的，这句话怎么理解呢？不懂什么是插件式，有什么作用呢","like_count":0},{"had_liked":false,"id":312117,"user_name":"一魄","can_delete":false,"product_type":"c1","uid":1134574,"ip_address":"","ucode":"71541125D4AA5A","user_header":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","comment_is_top":false,"comment_ctime":1631630378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631630378","product_id":100020801,"comment_content":"逻辑架构图中，分析器有指向查询缓存，什么情况会走这个逻辑？文中没说明","like_count":0},{"had_liked":false,"id":312106,"user_name":"yyx","can_delete":false,"product_type":"c1","uid":1849101,"ip_address":"","ucode":"853CEC5A12998E","user_header":"https://static001.geekbang.org/account/avatar/00/1c/37/0d/d81a6133.jpg","comment_is_top":false,"comment_ctime":1631627955,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631627955","product_id":100020801,"comment_content":"为什么执行才开始差权限，而不是分析就开始查呢","like_count":0},{"had_liked":false,"id":311793,"user_name":"Geek_6a3c4b","can_delete":false,"product_type":"c1","uid":2671226,"ip_address":"","ucode":"94E5A47FEA78BB","user_header":"","comment_is_top":false,"comment_ctime":1631461838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631461838","product_id":100020801,"comment_content":"请问是怎么验证的 grant后不会重新对已创建连接授权的呢","like_count":0},{"had_liked":false,"id":311528,"user_name":"Peter","can_delete":false,"product_type":"c1","uid":1139456,"ip_address":"","ucode":"9134384E270966","user_header":"https://static001.geekbang.org/account/avatar/00/11/63/00/c0731586.jpg","comment_is_top":false,"comment_ctime":1631267808,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1631267808","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":311523,"user_name":"糖醋味儿的韭菜","can_delete":false,"product_type":"c1","uid":2668172,"ip_address":"","ucode":"AA9FE1A5088472","user_header":"https://static001.geekbang.org/account/avatar/00/28/b6/8c/eef173dc.jpg","comment_is_top":false,"comment_ctime":1631266805,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631266805","product_id":100020801,"comment_content":"因为分析器包含词法分析和语法分析，我个人的理解这里的字段不存在是词法错误，因此会在分析器的词法分析阶段抛出错误","like_count":0},{"had_liked":false,"id":311385,"user_name":"刘少伟","can_delete":false,"product_type":"c1","uid":2760145,"ip_address":"","ucode":"C19681C57B3C35","user_header":"https://static001.geekbang.org/account/avatar/00/2a/1d/d1/370ed1fb.jpg","comment_is_top":false,"comment_ctime":1631196583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631196583","product_id":100020801,"comment_content":"大神好，这个架构图应该只有“请求”的流向，并没有数据“返回”流向，如果加上那就完美了","like_count":0},{"had_liked":false,"id":311314,"user_name":"是海洛呀","can_delete":false,"product_type":"c1","uid":2760457,"ip_address":"","ucode":"EE686391390623","user_header":"https://static001.geekbang.org/account/avatar/00/2a/1f/09/1d9a484c.jpg","comment_is_top":false,"comment_ctime":1631169459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631169459","product_id":100020801,"comment_content":"分析器，分析器进行词法分析，语法分析，不通过就不会向下执行","like_count":0},{"had_liked":false,"id":310849,"user_name":"青年术摄","can_delete":false,"product_type":"c1","uid":1390415,"ip_address":"","ucode":"F8C5E379BEAB8C","user_header":"https://static001.geekbang.org/account/avatar/00/15/37/4f/bc5f120d.jpg","comment_is_top":false,"comment_ctime":1630935461,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1630935461","product_id":100020801,"comment_content":"它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。<br>分析器。","like_count":0},{"had_liked":false,"id":310079,"user_name":"那yi刹那的","can_delete":false,"product_type":"c1","uid":2696407,"ip_address":"","ucode":"EE4949CBBD80E7","user_header":"https://static001.geekbang.org/account/avatar/00/29/24/d7/4b82c1b5.jpg","comment_is_top":false,"comment_ctime":1630480371,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630480371","product_id":100020801,"comment_content":"分析器做的工作是不是也包含语义分析呢，词法分析，语法分析，语义分析，这样它才能知道要做什么吧。是这样的吗","like_count":0},{"had_liked":false,"id":310073,"user_name":"Seven","can_delete":false,"product_type":"c1","uid":2403766,"ip_address":"","ucode":"37D99CF8535CDE","user_header":"https://static001.geekbang.org/account/avatar/00/24/ad/b6/a8caa2c7.jpg","comment_is_top":false,"comment_ctime":1630479307,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1630479307","product_id":100020801,"comment_content":"感觉应该是分析器,阶段出错的","like_count":0},{"had_liked":false,"id":309261,"user_name":"半年 2号","can_delete":false,"product_type":"c1","uid":2562181,"ip_address":"","ucode":"7F23C4532A5513","user_header":"https://static001.geekbang.org/account/avatar/00/27/18/85/83ac977e.jpg","comment_is_top":false,"comment_ctime":1630026267,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630026267","product_id":100020801,"comment_content":"总的来说，分析器。<br>词法分析判断单词是否有错，<br>语法分析判断表，列是否存在。","like_count":0},{"had_liked":false,"id":309137,"user_name":"xtepCool","can_delete":false,"product_type":"c1","uid":1543599,"ip_address":"","ucode":"6181687E98524E","user_header":"https://static001.geekbang.org/account/avatar/00/17/8d/af/01deb987.jpg","comment_is_top":false,"comment_ctime":1629957963,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629957963","product_id":100020801,"comment_content":"Server 层包括连接器、查询缓存、分析器（语法分析，词法分析）、优化器（最优处理路径）、执行器（调用存储引擎，返回结果）等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。而存储引擎层负责数据的存储和提取。","like_count":0},{"had_liked":false,"id":309113,"user_name":"。","can_delete":false,"product_type":"c1","uid":2747402,"ip_address":"","ucode":"7792BD130808E3","user_header":"https://static001.geekbang.org/account/avatar/00/29/ec/0a/b8a9e5ae.jpg","comment_is_top":false,"comment_ctime":1629946634,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629946634","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":308963,"user_name":"Geek_db9950","can_delete":false,"product_type":"c1","uid":2746477,"ip_address":"","ucode":"EEFCB118DD2C6F","user_header":"","comment_is_top":false,"comment_ctime":1629873808,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629873808","product_id":100020801,"comment_content":"在流程图中，为什么连接器下面是两个分支？难道不是先查缓存，在到分析器？","like_count":0},{"had_liked":false,"id":308493,"user_name":"稽山的柚子","can_delete":false,"product_type":"c1","uid":1546579,"ip_address":"","ucode":"E19BCF4604CBB9","user_header":"","comment_is_top":false,"comment_ctime":1629643738,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629643738","product_id":100020801,"comment_content":"课后题：这个错误是在分析器的语法分析阶段做的校验","like_count":0},{"had_liked":false,"id":308129,"user_name":"稽山的柚子","can_delete":false,"product_type":"c1","uid":1546579,"ip_address":"","ucode":"E19BCF4604CBB9","user_header":"","comment_is_top":false,"comment_ctime":1629424404,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629424404","product_id":100020801,"comment_content":"老师  麻烦问一下  文章中说连接 MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。<br><br>下面又说MySQL 拿到一个查询请求后，会先到查询缓存看看，之前是不是执行过这条语句。<br><br>这个连接对相中的执行过程临时使用的内存和这个缓存查询结果是一个东西么？如果不是的话连接管理对相中的临时使用的内存是指什么？","like_count":0},{"had_liked":false,"id":308128,"user_name":"稽山的柚子","can_delete":false,"product_type":"c1","uid":1546579,"ip_address":"","ucode":"E19BCF4604CBB9","user_header":"","comment_is_top":false,"comment_ctime":1629423989,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629423989","product_id":100020801,"comment_content":"这是因为 MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。<br><br>这个地方临时使用的内存是指什么？","like_count":0},{"had_liked":false,"id":307526,"user_name":"晚风。","can_delete":false,"product_type":"c1","uid":2066225,"ip_address":"","ucode":"19E54449690823","user_header":"","comment_is_top":false,"comment_ctime":1629130608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629130608","product_id":100020801,"comment_content":"分析器解析语法，若语法不正确提示错误信息","like_count":0},{"had_liked":false,"id":307100,"user_name":"Geek_738c09","can_delete":false,"product_type":"c1","uid":2736626,"ip_address":"","ucode":"B88E780A3B5FE8","user_header":"","comment_is_top":false,"comment_ctime":1628861274,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628861274","product_id":100020801,"comment_content":"老师是先执行分析器,还是先执行查询缓存,是先执行分析器,然后分析器运行之前会去查询缓存,然后有记录的话,把结果返回给客户端,如果没有记录,分析器继续向下执行,,是这个样子么  0.0<br>k =1 是在优化器报出错误么,优化器根本找不到可以执行的条件值,然后报出错误信息,然后操作器接收到了一个优化器,没有可优化数据值的错误信息,然后执行器执行的步骤不会执行前部分,只是后半部分的返回错误信息么..  0...0 我是个庸才,我不想百度 和 看评论 来总结我的思考,我想请教老师,让老师批判我的思考和答案的差距  老师 请您教我","like_count":0},{"had_liked":false,"id":305694,"user_name":"Geek_51857b","can_delete":false,"product_type":"c1","uid":2705340,"ip_address":"","ucode":"E35CB1879E7955","user_header":"","comment_is_top":false,"comment_ctime":1628123619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628123619","product_id":100020801,"comment_content":"老师，有个疑问，验证权限为什么要在执行器才验证，是因为打开表这个动作吗？为什么不在优化器或者分析器的时候做？","like_count":0},{"had_liked":false,"id":305691,"user_name":"Geek_51857b","can_delete":false,"product_type":"c1","uid":2705340,"ip_address":"","ucode":"E35CB1879E7955","user_header":"","comment_is_top":false,"comment_ctime":1628122961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628122961","product_id":100020801,"comment_content":"分析器，分析器做了两件事，对一个是词法分析，第二个是语法分析，我觉得语法分析通过字典就能做的，到执行器报成本过高吧。","like_count":0},{"had_liked":false,"id":305672,"user_name":"明明如月","can_delete":false,"product_type":"c1","uid":2697683,"ip_address":"","ucode":"937488EEAA522E","user_header":"https://static001.geekbang.org/account/avatar/00/29/29/d3/b193a463.jpg","comment_is_top":false,"comment_ctime":1628092854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628092854","product_id":100020801,"comment_content":"查询缓存<br>key value 保存上次查询，表变化了，所以与该表相关的缓存都会失效，只适合于不怎么更新的数据库表，如系统配置表<br>分析器 <br> 词法语法分析，基于SQL关键字，数据库表名，字段名判断 词的顺序。编译原理<br>优化器<br> 使用哪个索引，多表连接顺序<br>执行器<br> 查询操作权限，调用存储引擎接口。遍历表，将符合条件的记录加入结果集。慢日志的rows_examined显示这个语句在执行过程中扫描了多少行。select * from t where id=1，如果id是主键的话，查到就可以返回，如果不是主键，得遍历全表","like_count":0},{"had_liked":false,"id":305670,"user_name":"明明如月","can_delete":false,"product_type":"c1","uid":2697683,"ip_address":"","ucode":"937488EEAA522E","user_header":"https://static001.geekbang.org/account/avatar/00/29/29/d3/b193a463.jpg","comment_is_top":false,"comment_ctime":1628092364,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628092364","product_id":100020801,"comment_content":"连接器:  <br> 1  验证连接数据库权限，读取该用户拥有的所有权限，以后的权限验证都基于此查询。<br>2 连接管理 show processlist 查看连接进程<br>3 长连接:与客户端保持长连接，time_wait参数指定时间。缺点:长连接占用内存。解决方法:定时断开长连接，或者执行查询后， mysql_reset_connection回到连接的初始状态。<br>4 疑问:执行完查询后，mysql连接占用的内存为什么会变大","like_count":0},{"had_liked":false,"id":305032,"user_name":"Geek_3732db","can_delete":false,"product_type":"c1","uid":2710377,"ip_address":"","ucode":"DC820D0D588205","user_header":"","comment_is_top":false,"comment_ctime":1627785239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627785239","product_id":100020801,"comment_content":"分析器吧","like_count":0},{"had_liked":false,"id":304515,"user_name":"开开心心","can_delete":false,"product_type":"c1","uid":1203132,"ip_address":"","ucode":"42AB03AA49628E","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/bc/c3bcd529.jpg","comment_is_top":false,"comment_ctime":1627463262,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627463262","product_id":100020801,"comment_content":"mysql_reset_connection java api是什么？我一直没找到。老师看到希望能帮忙解答下，麻烦了","like_count":0},{"had_liked":false,"id":304130,"user_name":"Ban","can_delete":false,"product_type":"c1","uid":2086589,"ip_address":"","ucode":"4A5FC3667D94E1","user_header":"https://static001.geekbang.org/account/avatar/00/1f/d6/bd/94bb7d3c.jpg","comment_is_top":false,"comment_ctime":1627267760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627267760","product_id":100020801,"comment_content":"查询缓存会影响服务器扩展，在多核服务器还有可能僵死，这个有例子吗","like_count":0},{"had_liked":false,"id":303331,"user_name":"dst","can_delete":false,"product_type":"c1","uid":1861196,"ip_address":"","ucode":"9177BBB6C8B905","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKx6EdicYYuYK745brMa9yAlkZs2YmzxRAm4BQ2kw9GbtcC8ebnQlyBfIJnGjH57ib4HVlQIpSbTrBw/132","comment_is_top":false,"comment_ctime":1626740353,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626740353","product_id":100020801,"comment_content":"分析器层，因为要做查询优化","like_count":0},{"had_liked":false,"id":303226,"user_name":"꧁༺༻꧂","can_delete":false,"product_type":"c1","uid":1178426,"ip_address":"","ucode":"8BFD5C1F6ED235","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/3a/3dc7c61c.jpg","comment_is_top":false,"comment_ctime":1626675943,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1626675943","product_id":100020801,"comment_content":"准确的说，应该是分析器中的词法分析阶段。把sql中的字符串形式的表名、列名映射为真实的表和列","like_count":0},{"had_liked":false,"id":302313,"user_name":"阿迪","can_delete":false,"product_type":"c1","uid":1461714,"ip_address":"","ucode":"D33FDDC7CA86B2","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/d2/3a3f533a.jpg","comment_is_top":false,"comment_ctime":1626163621,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626163621","product_id":100020801,"comment_content":"1、根据前辈的文章关于鉴权这块，我总结了应该是三个位置，<br>（1）连接器是身份鉴别（ip、username、pwd等），并没有实际校验到数据库往下的权限 ；<br>（2）分析器是针对表和操作 做了权限鉴别；<br>（3）执行器也有做了针对表和操作 做了权限鉴别；<br>但是文中提到优化器、执行器都有权限鉴别，不太理解其是否真的有必要。翻了下评论说是为了处理触发器这种运行期间对象的鉴权；但是按我理解，触发器不是应当和某个表记录挂钩吗，一个 表影响了一个表 ，这应当是属于系统 维护方的一种设计。那为啥鉴权时需要涉及到它呢，不是应当校验这条sql对应的操作和表有无相应权限即可吗？<br>2、关于 连接时加载权限只对当前连接有效，连接途中更高级别的管理员给其增加了权限，会导致在当前连接中读取不到。那么FLUSH PRIVILEGES是针对这种情况的补偿措施吗，强制刷新连接中的权限信息？<br>希望前辈有空回复一下，万分感激！<br>","like_count":0},{"had_liked":false,"id":302225,"user_name":"阿迪","can_delete":false,"product_type":"c1","uid":1461714,"ip_address":"","ucode":"D33FDDC7CA86B2","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/d2/3a3f533a.jpg","comment_is_top":false,"comment_ctime":1626141033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626141033","product_id":100020801,"comment_content":"补充问一点，如果是两个表进行 join操作，join_buffer究竟是缓冲join完的临时表，还是两张join前的表","like_count":0},{"had_liked":false,"id":302224,"user_name":"阿迪","can_delete":false,"product_type":"c1","uid":1461714,"ip_address":"","ucode":"D33FDDC7CA86B2","user_header":"https://static001.geekbang.org/account/avatar/00/16/4d/d2/3a3f533a.jpg","comment_is_top":false,"comment_ctime":1626140916,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626140916","product_id":100020801,"comment_content":"mysql&gt; select * from t1 join t2 using(ID) where t1.c=10 and t2.d=20;<br>既可以先从表 t1 里面取出 c=10 的记录的 ID 值，再根据 ID 值关联到表 t2，再判断 t2 里面 d 的值是否等于 20。<br>也可以先从表 t2 里面取出 d=20 的记录的 ID 值，再根据 ID 值关联到 t1，再判断 t1 里面 c 的值是否等于 10。<br>这段话有个疑问，虽然说这里这么走下来结果是一样的，但where不是都在join...on后面才执行的吗，这种优化会出现吗？ <br>那如果把sql改成  select * from t1 join t2 on t1.c=10 and t2.d=20 and t1.ID=t2.ID;优化器 又 怎么走的呢 ？","like_count":0},{"had_liked":false,"id":301686,"user_name":"有生之年","can_delete":false,"product_type":"c1","uid":1020719,"ip_address":"","ucode":"B713335DE9D37F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/2f/1e193dcc.jpg","comment_is_top":false,"comment_ctime":1625811322,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625811322","product_id":100020801,"comment_content":"关于长短连接的疑问， 只要不主动close连接，那是不是都算是长连接？比如连接池。在一个请求中，使用一个连接即使操作了几次数据库，但是请求结束时，主动close了连接，下次再来请求，需要重新建立连接，那也算是短连接？","like_count":0},{"had_liked":false,"id":300635,"user_name":"灰原同学","can_delete":false,"product_type":"c1","uid":2111532,"ip_address":"","ucode":"6C0A373E53714C","user_header":"https://static001.geekbang.org/account/avatar/00/20/38/2c/bbe0a137.jpg","comment_is_top":false,"comment_ctime":1625280423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625280423","product_id":100020801,"comment_content":"分析器的字段分析过程中","like_count":0},{"had_liked":false,"id":300557,"user_name":"我想睡会儿","can_delete":false,"product_type":"c1","uid":2680447,"ip_address":"","ucode":"735D2EAA6EABD5","user_header":"https://static001.geekbang.org/account/avatar/00/28/e6/7f/1f6134b9.jpg","comment_is_top":false,"comment_ctime":1625217894,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625217894","product_id":100020801,"comment_content":"连接器不是会进行权限验证吗，为啥后面还要验证一次","like_count":0},{"had_liked":false,"id":300164,"user_name":"BeerBear","can_delete":false,"product_type":"c1","uid":2679713,"ip_address":"","ucode":"5BB9A8DDC23818","user_header":"https://static001.geekbang.org/account/avatar/00/28/e3/a1/d50f2188.jpg","comment_is_top":false,"comment_ctime":1625030378,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1625030378","product_id":100020801,"comment_content":"感觉这一小节跟本科时学的《编译原理》中的内容有异曲同工之妙。","like_count":0},{"had_liked":false,"id":299947,"user_name":"prader26","can_delete":false,"product_type":"c1","uid":1433707,"ip_address":"","ucode":"5EFFFC374ADECE","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/6b/f61d7466.jpg","comment_is_top":false,"comment_ctime":1624932402,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624932402","product_id":100020801,"comment_content":"分析器里的词法分析阶段 检查出来，表中是否存在某一行","like_count":0},{"had_liked":false,"id":299704,"user_name":"欧阳","can_delete":false,"product_type":"c1","uid":1409838,"ip_address":"","ucode":"2F16319F592490","user_header":"https://static001.geekbang.org/account/avatar/00/15/83/2e/5a0d111f.jpg","comment_is_top":false,"comment_ctime":1624806044,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624806044","product_id":100020801,"comment_content":"讲解很赞！","like_count":0},{"had_liked":false,"id":299624,"user_name":"GK丶Air","can_delete":false,"product_type":"c1","uid":1181752,"ip_address":"","ucode":"2EBCEDEA012FBF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoMiaBq7N3CDlWoqKUjX9zrVVJ9Xm1BF9iatYmmFl62vx3t9Am1ne4PebqVzgUwexPa53F9VMXlw8yw/132","comment_is_top":false,"comment_ctime":1624766164,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624766164","product_id":100020801,"comment_content":"语法分析，因为会报语法错误。所以答案是分析器。","like_count":0},{"had_liked":false,"id":299606,"user_name":"undefined","can_delete":false,"product_type":"c1","uid":1095965,"ip_address":"","ucode":"F78F71B2A43D62","user_header":"https://static001.geekbang.org/account/avatar/00/10/b9/1d/4859571e.jpg","comment_is_top":false,"comment_ctime":1624759543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624759543","product_id":100020801,"comment_content":"检查表名这个事情理论上在分析器阶段和在执行阶段都可以做，但是这种错误检查一般都要遵循尽早原则来减少不必要的资源开销。能在分析阶段做了，肯定就在分析阶段做。就跟语言的编译器检查一样，现代的编程语言的发展都是尽量把可发现的问题放到编译期而不是运行期。","like_count":0},{"had_liked":false,"id":299596,"user_name":"Ryan","can_delete":false,"product_type":"c1","uid":2665674,"ip_address":"","ucode":"D0DA57BC2783AC","user_header":"https://static001.geekbang.org/account/avatar/00/28/ac/ca/70eceba3.jpg","comment_is_top":false,"comment_ctime":1624755411,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1624755411","product_id":100020801,"comment_content":"这个查询缓存是不是跟 PreparedStatementCache同一概念？","like_count":0},{"had_liked":false,"id":299303,"user_name":"olivia-byte","can_delete":false,"product_type":"c1","uid":1273891,"ip_address":"","ucode":"D54B3833995923","user_header":"https://static001.geekbang.org/account/avatar/00/13/70/23/92d188aa.jpg","comment_is_top":false,"comment_ctime":1624552929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624552929","product_id":100020801,"comment_content":"分析器：MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。","like_count":0},{"had_liked":false,"id":299152,"user_name":"7","can_delete":false,"product_type":"c1","uid":1698089,"ip_address":"","ucode":"76E3ABA7E91470","user_header":"https://static001.geekbang.org/account/avatar/00/19/e9/29/9d3f2b0c.jpg","comment_is_top":false,"comment_ctime":1624494159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624494159","product_id":100020801,"comment_content":"看文章提供的MySQL逻辑架构图，分析器会走查询缓存，请问分析器在什么时候会走查询缓存？","like_count":0},{"had_liked":false,"id":298498,"user_name":"戚帅","can_delete":false,"product_type":"c1","uid":1203898,"ip_address":"","ucode":"8377FC86A475EB","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/ba/01b7c71d.jpg","comment_is_top":false,"comment_ctime":1624158361,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624158361","product_id":100020801,"comment_content":"晓斌老师，为什么这么设置没有效果呢set global  wait_timeout = 10;<br>如果这么设置是有效果的set wait_timeout = 10;","like_count":0},{"had_liked":false,"id":298388,"user_name":"Eternal","can_delete":false,"product_type":"c1","uid":1188023,"ip_address":"","ucode":"EA6FE7CC98F740","user_header":"https://static001.geekbang.org/account/avatar/00/12/20/b7/bdb3bcf0.jpg","comment_is_top":false,"comment_ctime":1624072885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624072885","product_id":100020801,"comment_content":"老师会不会继续分享一个TiDB的课程","like_count":0},{"had_liked":false,"id":298386,"user_name":"Eternal","can_delete":false,"product_type":"c1","uid":1188023,"ip_address":"","ucode":"EA6FE7CC98F740","user_header":"https://static001.geekbang.org/account/avatar/00/12/20/b7/bdb3bcf0.jpg","comment_is_top":false,"comment_ctime":1624071962,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624071962","product_id":100020801,"comment_content":"课后题：语法分析阶段校验失败","like_count":0},{"had_liked":false,"id":298348,"user_name":"随心","can_delete":false,"product_type":"c1","uid":1339136,"ip_address":"","ucode":"BF6F766825D6CB","user_header":"https://static001.geekbang.org/account/avatar/00/14/6f/00/0e9e687e.jpg","comment_is_top":false,"comment_ctime":1624030107,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624030107","product_id":100020801,"comment_content":"分析器吗","like_count":0},{"had_liked":false,"id":298186,"user_name":"王乐","can_delete":false,"product_type":"c1","uid":1891149,"ip_address":"","ucode":"FF4A764EA8AB84","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PYPYsHxv1LhpMvF2cRTCL2TicZrw9ysPlz2TkQFryTibFrBFoKLZ9aSlAayMlJ8Fx7icdW6Ec5CFDyrANTatShQkQ/132","comment_is_top":false,"comment_ctime":1623939940,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1623939940","product_id":100020801,"comment_content":"老师好，文中遇到临时内存会跟随长连接的存在而存在，直到连接被销毁。楼上@jacket的问题，我最近遇到一个类似的案例。一个连接执行了一个大事务消耗了6G内存导致物理内存不足，mysql宕机。使用pidstat监控这个连接对应线程一直在申请内存，但我怎么才能知道这部分内存用在什么地方？","like_count":0},{"had_liked":false,"id":297915,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":2649276,"ip_address":"","ucode":"CEBAD9CDCFC2A3","user_header":"https://static001.geekbang.org/account/avatar/00/28/6c/bc/f751786b.jpg","comment_is_top":false,"comment_ctime":1623842405,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623842405","product_id":100020801,"comment_content":"问题答案：分析器","like_count":0},{"had_liked":false,"id":297763,"user_name":"Geek_b49271","can_delete":false,"product_type":"c1","uid":1800056,"ip_address":"","ucode":"3D3E52B7B7E3C9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLMldux8wkJg2wOOibTrIeUfgY578QFmVRHHeaGeT6YnxVEvN3D8ZMdgmqMzvMSrJCgrX3qK5Gsgng/132","comment_is_top":false,"comment_ctime":1623765547,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623765547","product_id":100020801,"comment_content":"最近发现数据库binlog产生很多个空行,不知道什么原理，求帮助解释下原理。<br># at 892279526<br>#210610  3:12:03 server id 81353307  end_log_pos 892279638 CRC32 0x955e9fb6     Table_map: `db_oms4_im`.`im_channel_sync_snapshot` mapped to number 16443<br># at 892279638<br>#210610  3:12:03 server id 81353307  end_log_pos 892287821 CRC32 0x17811bb6     Write_rows: table id 16443<br># at 892287821<br>#210610  3:12:03 server id 81353307  end_log_pos 892296004 CRC32 0x99906ef9     Write_rows: table id 16443<br># at 892296004<br>#210610  3:12:03 server id 81353307  end_log_pos 892304191 CRC32 0x31379416     Write_rows: table id 16443<br>.....<br>.....<br>.....<br>很多行<br>.....<br>.....<br># at 898384384<br>#210610  3:12:03 server id 81353307  end_log_pos 898390159 CRC32 0x6ee12087     Write_rows: table id 16443 flags: STMT_END_F<br>","like_count":0},{"had_liked":false,"id":297683,"user_name":"小弗。","can_delete":false,"product_type":"c1","uid":1514205,"ip_address":"","ucode":"91B6714B9DC6F8","user_header":"https://static001.geekbang.org/account/avatar/00/17/1a/dd/fe2f7a8a.jpg","comment_is_top":false,"comment_ctime":1623728914,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623728914","product_id":100020801,"comment_content":"分析器的词法分析报的错误。","like_count":0},{"had_liked":false,"id":297437,"user_name":"白黑倒颠","can_delete":false,"product_type":"c1","uid":2657559,"ip_address":"","ucode":"B820E7B0E8BAFA","user_header":"https://static001.geekbang.org/account/avatar/00/28/8d/17/4e810c7a.jpg","comment_is_top":false,"comment_ctime":1623551570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623551570","product_id":100020801,"comment_content":"答案应该是分析器,sql语句执行的时候,分析器需要进行词法分析,把所以词细化后进行语法分析,此时语法分析就会分析出没有这个表,没有这个列之类的问题(词法分析器相当于,让你认得了一个个汉字怎么读,语法分析器则教会你这个词是什么意思),我原本还以为学校教的编译原理不知道有什么用,看到老师的课才知道,编译原理居然用得那么底层,我还以为它一般只是用于编程语言,没想到数据库也涉及","like_count":0},{"had_liked":false,"id":296563,"user_name":"isjinhao","can_delete":false,"product_type":"c1","uid":1789106,"ip_address":"","ucode":"782E3AB144042F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eobmrAsyK9Q6X9cBAG91eicHsLUCARhT5fkhdAjyT5Ha0MdEuEjic9ialsTNVJD19wQbcWV9kLrLplcA/132","comment_is_top":false,"comment_ctime":1623048624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623048624","product_id":100020801,"comment_content":"JDBC的resetServerState是不是最终调用的就是resetServerState呢，有没有同学知道？","like_count":0},{"had_liked":false,"id":296044,"user_name":"钱米","can_delete":false,"product_type":"c1","uid":1225974,"ip_address":"","ucode":"07AA44C6A40D34","user_header":"https://static001.geekbang.org/account/avatar/00/12/b4/f6/e39d5af1.jpg","comment_is_top":false,"comment_ctime":1622714835,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622714835","product_id":100020801,"comment_content":"分析器的语法分析阶段。","like_count":0},{"had_liked":false,"id":295755,"user_name":"本来是亚","can_delete":false,"product_type":"c1","uid":1073592,"ip_address":"","ucode":"14527E5BC3C2A8","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/b8/7b23f8cb.jpg","comment_is_top":false,"comment_ctime":1622592665,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1622592665","product_id":100020801,"comment_content":"这个错误在分析器就会被报出来","like_count":0},{"had_liked":false,"id":295560,"user_name":"胡嚞衎","can_delete":false,"product_type":"c1","uid":1632660,"ip_address":"","ucode":"E8A1874AC68075","user_header":"https://static001.geekbang.org/account/avatar/00/18/e9/94/a3177207.jpg","comment_is_top":false,"comment_ctime":1622475275,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1622475275","product_id":100020801,"comment_content":" 老师你好！mysql_reset_connection这个怎么执行呢？这个好像不是MySQL的命令吧，执行报错呢？","like_count":0},{"had_liked":false,"id":295283,"user_name":"南顺城街","can_delete":false,"product_type":"c1","uid":2644383,"ip_address":"","ucode":"0BDC30E5FBB0C8","user_header":"https://static001.geekbang.org/account/avatar/00/28/59/9f/fb04a5fd.jpg","comment_is_top":false,"comment_ctime":1622344873,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622344873","product_id":100020801,"comment_content":"老师你好，学生是mysql初学者，您说的这个mysql的查询缓存不建议使用，此查询缓存机制是自身提供的还是配合一些redis等缓存设备来实现的，学生优点分不清，望不吝赐教；","like_count":0},{"had_liked":false,"id":295177,"user_name":"gzh4869","can_delete":false,"product_type":"c1","uid":2109213,"ip_address":"","ucode":"C7472DB064C3B4","user_header":"https://static001.geekbang.org/account/avatar/00/20/2f/1d/7793e233.jpg","comment_is_top":false,"comment_ctime":1622284988,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622284988","product_id":100020801,"comment_content":"感觉我没学过数据库","like_count":0},{"had_liked":false,"id":294617,"user_name":"唐磊","can_delete":false,"product_type":"c1","uid":1192092,"ip_address":"","ucode":"428611FEA0C2EF","user_header":"https://static001.geekbang.org/account/avatar/00/12/30/9c/3715a95e.jpg","comment_is_top":false,"comment_ctime":1622019816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622019816","product_id":100020801,"comment_content":"使用java组装多个单表查询的结果快，还是多表直接join查询快？","like_count":0},{"had_liked":false,"id":294415,"user_name":"Geek_dd6027","can_delete":false,"product_type":"c1","uid":2416648,"ip_address":"","ucode":"316F8F61A32812","user_header":"","comment_is_top":false,"comment_ctime":1621934675,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621934675","product_id":100020801,"comment_content":"老师您好，我有个疑问想问您，报unknow column是在分析器执行阶段报出的。但是文中说，在工程实现上，会在查询缓存返回结果的时候做权限验证。查询也会在优化器之前调用precheck验证权限。这样的话，权限验证是在分析器执行之后才进行的吗？如果是的话，那为什么没有查询T表的权限的用户，执行了select * from T where k = 1这个语句后，报的错误为select command denied而不是unknow column k。","like_count":0},{"had_liked":false,"id":293451,"user_name":"grey927","can_delete":false,"product_type":"c1","uid":1202782,"ip_address":"","ucode":"833E02ED835B4A","user_header":"https://static001.geekbang.org/account/avatar/00/12/5a/5e/a897cb0d.jpg","comment_is_top":false,"comment_ctime":1621392168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621392168","product_id":100020801,"comment_content":"林老师，你好！<br>MySQL的安装有各种方式，比如二进制文件，编译安装，通过第三方脚本（比如：OneInStack）安装，请问一般通过哪种方式安装比较好呢？","like_count":0},{"had_liked":false,"id":293112,"user_name":"lsm","can_delete":false,"product_type":"c1","uid":2293117,"ip_address":"","ucode":"495D4082AEC54B","user_header":"https://static001.geekbang.org/account/avatar/00/22/fd/7d/9f9c67d1.jpg","comment_is_top":false,"comment_ctime":1621223143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621223143","product_id":100020801,"comment_content":"最后问题答案是分析器，分析器中会进行词法分析。","like_count":0},{"had_liked":false,"id":292871,"user_name":"Geek_9648b0","can_delete":false,"product_type":"c1","uid":1308428,"ip_address":"","ucode":"31107788C9D0CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLMabqa7dibibemSibGnN1kehGvLgVsHjgruEySkiasicIMc4JDBiaFWKLNGCiaUQvJ1gdtryOrreibiczOn3Q/132","comment_is_top":false,"comment_ctime":1621045895,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621045895","product_id":100020801,"comment_content":"老师，触发器和事务的功能区别体现在哪，为什么有触发器还要事务","like_count":0},{"had_liked":false,"id":292460,"user_name":"郭橙輝-","can_delete":false,"product_type":"c1","uid":2445017,"ip_address":"","ucode":"2B61A22448E5DD","user_header":"https://static001.geekbang.org/account/avatar/00/25/4e/d9/a559e58c.jpg","comment_is_top":false,"comment_ctime":1620830217,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620830217","product_id":100020801,"comment_content":"感觉老师讲得很棒，第一遍看还是有些不懂的，打算再看第二遍","like_count":0},{"had_liked":false,"id":291823,"user_name":"耶马","can_delete":false,"product_type":"c1","uid":2288362,"ip_address":"","ucode":"3A3CF67B016CDB","user_header":"https://static001.geekbang.org/account/avatar/00/22/ea/ea/77a59153.jpg","comment_is_top":false,"comment_ctime":1620531749,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1620531749","product_id":100020801,"comment_content":"第一遍看的时候,收货好多,第二遍有些怎么之前没有看到,现在结合评论再学习,总是有收货的<br>之前是追求速度,没有细品","like_count":0},{"had_liked":false,"id":291561,"user_name":"RoinB","can_delete":false,"product_type":"c1","uid":1514419,"ip_address":"","ucode":"2BA08011370307","user_header":"https://static001.geekbang.org/account/avatar/00/17/1b/b3/5cc4630a.jpg","comment_is_top":false,"comment_ctime":1620365591,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620365591","product_id":100020801,"comment_content":"我想问下查询缓存，缓存是一个链接内共享还是全局共享","like_count":0},{"had_liked":false,"id":289655,"user_name":"夏天","can_delete":false,"product_type":"c1","uid":2542376,"ip_address":"","ucode":"5F224DDAC94DFF","user_header":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","comment_is_top":false,"comment_ctime":1619134225,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1619134225","product_id":100020801,"comment_content":"关于权限需要断开重连生效。做了个实验发现不是这样。MySQL 版本 5.7.33<br><br>mysql&gt; select * from child;<br>ERROR 1142 (42000): SELECT command denied to user &#39;dog&#39;@&#39;localhost&#39; for table &#39;child&#39;<br><br>另一个终端添加权限<br>grant SELECT, INSERT, UPDATE,DELETE ON test.child to &#39;dog&#39;@&#39;localhost&#39;;<br><br>mysql&gt; select * from child;<br>Empty set (0.00 sec)<br><br>并没有断开连接。但是权限有了<br><br>mysql&gt; select * from child;<br>Empty set (0.00 sec)<br>","like_count":0,"discussions":[{"author":{"id":2420294,"avatar":"https://static001.geekbang.org/account/avatar/00/24/ee/46/7d65ae37.jpg","nickname":"木几丶","note":"","ucode":"FFDB958DA64F8C","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390207,"discussion_content":"刚连接的时候执行权限会从权限表取到内存，后续都是判断内存。grant操作会同时更新内存和权限表，去看下第42篇你就懂了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629712369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":289628,"user_name":"yezhizi","can_delete":false,"product_type":"c1","uid":1302047,"ip_address":"","ucode":"D179ED99286897","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ9oIRvWZARRmB2hNAmSKOQddHYBJr3QXoT8ibtFicfj46PBOTOwGib6WAA3ES2HzzqqXl4ccEEwrLXw/132","comment_is_top":false,"comment_ctime":1619102739,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619102739","product_id":100020801,"comment_content":"编译debug 分析了trace 文件  是在mysql_parse<br><br>T@5: | | &gt;mysql_parse<br>T@5: | | | mysql_parse: query: &#39;select k from test&#39;<br>T@5: | | | &gt;mysql_reset_thd_for_next_command<br>T@5: | | | | debug: reset_unsafe_rollback_flags<br>T@5: | | | | &gt;clear_error<br>T@5: | | | | &lt;clear_error 3454<br>T@5: | | | | &gt;reset_diagnostics_area<br>T@5: | | | | &lt;reset_diagnostics_area 378<br>T@5: | | | | &gt;reset_current_stmt_binlog_format_row<br>T@5: | | | | | debug: temporary_tables: no, in_sub_stmt: no, system_thread: NON_SYSTEM_THREAD<br>T@5: | | | | | &gt;set_current_stmt_binlog_format_row<br>T@5: | | | | | &lt;set_current_stmt_binlog_format_row 3744<br>T@5: | | | | &lt;reset_current_stmt_binlog_format_row 3781<br>T@5: | | | | &gt;THD::set_trans_pos<br>T@5: | | | | | return: m_trans_log_file: (null), m_trans_fixed_log_file: (null), m_trans_end_pos: 0<br>T@5: | | | | &lt;THD::set_trans_pos 2848<br>T@5: | | | | | | | | &gt;my_message_sql<br>T@5: | | | | | | | | | error: error: 1054  message: &#39;Unknown column &#39;k&#39; in &#39;field list&#39;&#39;","like_count":0},{"had_liked":false,"id":289543,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1619074200,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619074200","product_id":100020801,"comment_content":"应该在词法分析阶段就识别出来，根据老师的讲解，分析器做词法分析时，需要识别出语句中的表名、字段名，如果列不存在，应该识别不了，所以会报错。","like_count":0},{"had_liked":false,"id":289011,"user_name":"lleft","can_delete":false,"product_type":"c1","uid":1970443,"ip_address":"","ucode":"D573EB509455AE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","comment_is_top":false,"comment_ctime":1618819334,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618819334","product_id":100020801,"comment_content":"查询的结果写入到查询缓存中，是由哪个部件写入的查询缓存？存储引擎还是执行器呢？","like_count":0},{"had_liked":false,"id":288314,"user_name":"caimaoy","can_delete":false,"product_type":"c1","uid":1023720,"ip_address":"","ucode":"4AC04E0D055B2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/e8/fdeb58a0.jpg","comment_is_top":false,"comment_ctime":1618405320,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618405320","product_id":100020801,"comment_content":"分析器，越早返回错误越好","like_count":0},{"had_liked":false,"id":288275,"user_name":"五厘米","can_delete":false,"product_type":"c1","uid":2563505,"ip_address":"","ucode":"01B7A12290AE26","user_header":"https://static001.geekbang.org/account/avatar/00/27/1d/b1/e8264c02.jpg","comment_is_top":false,"comment_ctime":1618389736,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618389736","product_id":100020801,"comment_content":"学习输出地带（希望老师能够指出我理解上的错误）：<br>1.登录语句在连接器的时候被识别和执行<br>2.select 语句在分析器首先进行词法分割提取识别关键词表名、字段名，然后进行语法分析，如果不符合当前mysql服务器版本正确的语法则返回错误。这里会有一个precheck权限验证（我猜测这里只是基本验证，比如一个账号只能读，如果发现是update，则是无权限）<br>3.如果sql语句符合语法，进入优化器，找到mysql认为的引擎方法最好的执行顺序，将执行顺序告诉执行器。<br>4.执行器按照上述顺序调用引擎方法，因为这里就要调用引擎的方法打开表了，在打开表的时候肯定是要验证权限的。<br>5.引擎Innodb理解的不是很清楚，之后的主要目标研究redo log 和undo log机制。","like_count":0},{"had_liked":false,"id":287269,"user_name":"王凯","can_delete":false,"product_type":"c1","uid":1746317,"ip_address":"","ucode":"3A8FE67E83E73F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a5/8d/839becc5.jpg","comment_is_top":false,"comment_ctime":1617863761,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617863761","product_id":100020801,"comment_content":"show variables 返回命令中query_cache_type的值是OFF，作者说的DEMAND是代表关闭的意思吗？","like_count":0},{"had_liked":false,"id":286809,"user_name":"海风","can_delete":false,"product_type":"c1","uid":1465863,"ip_address":"","ucode":"38BA513F7AEC8C","user_header":"https://static001.geekbang.org/account/avatar/00/16/5e/07/61a4cb92.jpg","comment_is_top":false,"comment_ctime":1617605671,"is_pvip":false,"discussion_count":0,"race_medal":5,"score":"1617605671","product_id":100020801,"comment_content":"输入用户名和密码，连接器进行权限验证，是通过连接器后台生成一条sql，然后按照这个逻辑架构图顺序执行sql实现的吗？","like_count":0},{"had_liked":false,"id":286314,"user_name":"c340","can_delete":false,"product_type":"c1","uid":1111176,"ip_address":"","ucode":"D64CC3DDD09A0F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f4/88/133bc14b.jpg","comment_is_top":false,"comment_ctime":1617251272,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1617251272","product_id":100020801,"comment_content":"存储引擎提供的都是单行查询吗？有批量的吗","like_count":0},{"had_liked":false,"id":285069,"user_name":"哈·罗","can_delete":false,"product_type":"c1","uid":2536565,"ip_address":"","ucode":"E79B7B155B1EF1","user_header":"https://static001.geekbang.org/account/avatar/00/26/b4/75/ac039120.jpg","comment_is_top":false,"comment_ctime":1616598148,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1616598148","product_id":100020801,"comment_content":"我的疑问是为什么在执行器阶段做权限判断。直接在分析器阶段做权限检验是不是更合理？如果没有权限，就不用再继续进行优化器了。因为就算优化了，最后没有权限执行，优化操作不是浪费了，感觉无意义","like_count":0},{"had_liked":false,"id":284825,"user_name":"熊猫同学呀","can_delete":false,"product_type":"c1","uid":2336072,"ip_address":"","ucode":"2D583538391A76","user_header":"https://static001.geekbang.org/account/avatar/00/23/a5/48/f17aee4b.jpg","comment_is_top":false,"comment_ctime":1616488156,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1616488156","product_id":100020801,"comment_content":"我有个问题，就是server层的图中分析器有一个箭头指向查询缓存，但是分析器的功能不是只分析词法和语法吗，为什么有箭头指向查询缓存呢","like_count":0,"discussions":[{"author":{"id":2457579,"avatar":"https://static001.geekbang.org/account/avatar/00/25/7f/eb/c26be6c2.jpg","nickname":"🇳 江⃮⃯⃗","note":"","ucode":"276CCAE155BE53","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366315,"discussion_content":"假如是更新或其他操作需要去清空缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618027412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284616,"user_name":"刘硕","can_delete":false,"product_type":"c1","uid":1368179,"ip_address":"","ucode":"20ED22CECF2EE3","user_header":"https://static001.geekbang.org/account/avatar/00/14/e0/73/4d12c281.jpg","comment_is_top":false,"comment_ctime":1616390291,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616390291","product_id":100020801,"comment_content":"我看架构图里面【连接器】部分标注了【权限验证】，所以连接器也做了部分权限验证吗？","like_count":0},{"had_liked":false,"id":284465,"user_name":"Daiver","can_delete":false,"product_type":"c1","uid":1466447,"ip_address":"","ucode":"9B1A03AFBC79BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/60/4f/db0e62b3.jpg","comment_is_top":false,"comment_ctime":1616261000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616261000","product_id":100020801,"comment_content":"分析器吧，我觉得这个跟编译器的前端很相似，先词法分析出token，然后再进行语法分析，这个时候肯定会去检查表结构中是否存在这个字段的，于是乎语法分析阶段就会报错出错误。","like_count":0},{"had_liked":false,"id":284339,"user_name":"maybe","can_delete":false,"product_type":"c1","uid":1475528,"ip_address":"","ucode":"93D160F617E750","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/c8/5ce842f6.jpg","comment_is_top":false,"comment_ctime":1616202023,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1616202023","product_id":100020801,"comment_content":"分析器执行阶段爆出来的，因为分析器分析语法正确性滴","like_count":0},{"had_liked":false,"id":284093,"user_name":"Geek_2d884f","can_delete":false,"product_type":"c1","uid":2325186,"ip_address":"","ucode":"13E2A93127AC3F","user_header":"","comment_is_top":false,"comment_ctime":1616061655,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616061655","product_id":100020801,"comment_content":"请问一个连接建立时，是怎么决定这个连接是长连接还是短连接的？","like_count":0},{"had_liked":false,"id":283301,"user_name":"郑州","can_delete":false,"product_type":"c1","uid":1892769,"ip_address":"","ucode":"5AC9B824946A40","user_header":"https://static001.geekbang.org/account/avatar/00/1c/e1/a1/ff49d79a.jpg","comment_is_top":false,"comment_ctime":1615698446,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615698446","product_id":100020801,"comment_content":"我有点迷糊，基本架构图中，分析器到查询缓存的箭头，是不是应该改为执行器到查询缓存","like_count":0},{"had_liked":false,"id":282794,"user_name":"棒棒糖","can_delete":false,"product_type":"c1","uid":2107111,"ip_address":"","ucode":"7DFFE4B517FCDA","user_header":"https://static001.geekbang.org/account/avatar/00/20/26/e7/1c2c341d.jpg","comment_is_top":false,"comment_ctime":1615423071,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1615423071","product_id":100020801,"comment_content":"连接器：跟客户端建立连接，获取权限，维持和管理连接<br>查询缓存：弊大于利，不建议用<br>分析器：知道了要做什么<br>    词法分析：字符串，空格，代表什么<br>    语法分析：根据语法规则，判断语法是否正确<br>优化器：知道了该怎么做<br>执行器：检查权限，确定是否执行","like_count":0},{"had_liked":false,"id":282054,"user_name":"蜗牛快跑","can_delete":false,"product_type":"c1","uid":1233503,"ip_address":"","ucode":"DA62FABD8F47C1","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83er65tEOAwCnYltcCIZR3VAA3PA9eia0CWe4IJE1pvcYr02XzuIT82I14SaMd6XHPPoKsJnQ5vcUh9Q/132","comment_is_top":false,"comment_ctime":1615037408,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615037408","product_id":100020801,"comment_content":"这个专栏我已经翻来覆去看了好多遍了，受益匪浅，现在想深入一点去看mysql源码，但是又无从下手 好困惑","like_count":0},{"had_liked":false,"id":281865,"user_name":"卖薪沽酒","can_delete":false,"product_type":"c1","uid":2465726,"ip_address":"","ucode":"7F04A84EDBA856","user_header":"https://static001.geekbang.org/account/avatar/00/25/9f/be/14b2ad2e.jpg","comment_is_top":false,"comment_ctime":1614929368,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614929368","product_id":100020801,"comment_content":"<br>\t1.  连接器<br><br><br>            a. 进行经典tcp连接后，用户密码建立连接<br>            b.获取用户的权限<br>             =====&gt; 延伸<br>          连接类型 <br>          a. 长连接  优点  一次连接多次使用<br>                    缺点  内存占用可能比较大  ===&gt; 解决方法       a.  定时重新连接<br>                                                                                             b. 执行完一个较大的查询后，重新连接 mysql_reset_connection`来初始化连接资源，此操作不会重连也不会重新做权限校验，<br>                                                                                                 只是将连接初始化到刚刚建立时的状态<br>          b.短连接  多次连接  消耗比较大，影响性能<br><br><br>\t1. <br>查询缓存器<br><br>\t\t1. <br>key-value ------语句为key， 结果为value<br>\t\t2. <br>不推荐使用<br><br>\t\t\t1. <br>对于频繁更新的表来说， 查询命中率低<br>\t\t\t2. <br>查询后的结果还要写入缓存结果集， 消耗性能<br>\t\t3. <br>可以通过配置query_cache 来配置是否使用缓存<br>\t\t4. <br>mysql8.0 后已经没有查询缓存器了<br>\t2. <br>分析器<br><br>\t\t1. <br>词法分析   主要判断列<br>\t\t2. <br>语法分析   判断sql语法<br>\t3. <br>优化器  <br><br>\t\t1. <br>多索引的选择<br>\t\t2. <br>join的时候的优化， 先查询那个表<br>\t4. <br>执行器<br><br>\t\t1. <br>验证权限<br>\t\t2. <br>根据引擎查询出行，然后判断是否结果 ===》 返回结果集<br>\t\t3. <br>rows_examined ==  语句执行中扫描了多少行   和  但是在有些场景下，执行器调用一次，在引擎内部则扫描了多行，因此引擎扫描行数跟 rows_examined 并不是完全相同的<br>\t5. <br>思考题  <br><br>\t\t1. <br>我给你留一个问题吧，如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？<br><br>\t\t\t1. <br>答 ，分析器， 因为分析器里有词法分析，会判断列存不存在， <br>\t\t\t2. <br>根据网友的一些验证， 如果权限不够， 这分析器的分析结果是不会返回给你的（ unknown column）<br><br>","like_count":0},{"had_liked":false,"id":281737,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1614866255,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614866255","product_id":100020801,"comment_content":"在分析器阶段，会对字段是否合法进行判断","like_count":0},{"had_liked":false,"id":281736,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1614866202,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614866202","product_id":100020801,"comment_content":"在执行器阶段会对这些字段是否存在进行判断","like_count":0},{"had_liked":false,"id":281544,"user_name":"Lee","can_delete":false,"product_type":"c1","uid":1548886,"ip_address":"","ucode":"D64D6D40B9D3D6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiazYmBAsIaPfG5SNyRzxjlEH3ic4RkKrIkLvLIOnpG4Y7qAnekfOSfcj5G0oz3u6zwXkxOiaCnlGug/132","comment_is_top":false,"comment_ctime":1614781279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614781279","product_id":100020801,"comment_content":"答：分析器。分析器的作用有：识别sql语句即词法分析，这块逻辑就会分析“k”的明确意思，如是否是表中的列。","like_count":0},{"had_liked":false,"id":280994,"user_name":"征服天堂","can_delete":false,"product_type":"c1","uid":2445066,"ip_address":"","ucode":"686ED7ECC00004","user_header":"https://static001.geekbang.org/account/avatar/00/25/4f/0a/0ebfbb01.jpg","comment_is_top":false,"comment_ctime":1614517141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614517141","product_id":100020801,"comment_content":"分析器，分析器拆解SQL语句，判断每个字符串关键词的含义，显然“k”这个字符串差找不到","like_count":0},{"had_liked":false,"id":280577,"user_name":"玩法素装","can_delete":false,"product_type":"c1","uid":2266354,"ip_address":"","ucode":"87CA6940746BB8","user_header":"https://static001.geekbang.org/account/avatar/00/22/94/f2/9f54c411.jpg","comment_is_top":false,"comment_ctime":1614252641,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614252641","product_id":100020801,"comment_content":"分析器阶段的语法分析检查到表T不存在该字段k","like_count":0},{"had_liked":false,"id":280415,"user_name":"I","can_delete":false,"product_type":"c1","uid":2310422,"ip_address":"","ucode":"5AE5C972E20477","user_header":"https://static001.geekbang.org/account/avatar/00/23/41/16/fa59febc.jpg","comment_is_top":false,"comment_ctime":1614184459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614184459","product_id":100020801,"comment_content":"分析器   在分析器中的词法分析中，判断列的正确与否","like_count":0},{"had_liked":false,"id":280213,"user_name":"Geek_684984","can_delete":false,"product_type":"c1","uid":2149833,"ip_address":"","ucode":"BAE0E43AA80892","user_header":"","comment_is_top":false,"comment_ctime":1614135497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614135497","product_id":100020801,"comment_content":"更新语句对查询缓存的刷新，是刷本次连接该表的缓存，还是本次连接的所有缓存呀","like_count":0},{"had_liked":false,"id":279146,"user_name":"zach","can_delete":false,"product_type":"c1","uid":2040762,"ip_address":"","ucode":"D6EA1D526F9E85","user_header":"https://static001.geekbang.org/account/avatar/00/1f/23/ba/a20a8c34.jpg","comment_is_top":false,"comment_ctime":1613636732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613636732","product_id":100020801,"comment_content":"分析器环节，在解析语句后，会校验字段、表名是否存在","like_count":0},{"had_liked":false,"id":278194,"user_name":"捍卫简单","can_delete":false,"product_type":"c1","uid":2439682,"ip_address":"","ucode":"264A84463BD8FD","user_header":"https://static001.geekbang.org/account/avatar/00/25/3a/02/11cf22de.jpg","comment_is_top":false,"comment_ctime":1612796083,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612796083","product_id":100020801,"comment_content":"您好，看到连接池部分有个疑问，service中的连接池跟我们应用中的连接池（例如 java中的druid、HikariCP等）有什么联系呢，希望老师不吝赐教，谢谢🙏🙏","like_count":0},{"had_liked":false,"id":276700,"user_name":"卞皓枫","can_delete":false,"product_type":"c1","uid":2417123,"ip_address":"","ucode":"4E5CA61D2A215E","user_header":"https://static001.geekbang.org/account/avatar/00/24/e1/e3/828d9829.jpg","comment_is_top":false,"comment_ctime":1612083367,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612083367","product_id":100020801,"comment_content":"关于优化器我有个疑问望解答。优化器的作用是找到最优的执行计划，但是当可能存在过多可能的执行计划时优化器并不会去找所有的执行计划（MSSQL），Mysql也是这样对么？<br>在SQL Server2008技术内中也看到过查询的执行过程，有一章介绍到了，<br>逻辑查询的过程：第一步：From 子句；对From子句中的前两个表执行笛卡尔积（交叉连接），生成虚拟表VT1。<br>第一步是先Join生成一个虚拟结果集，然后通过on过滤这个结果集，在后面是通过where筛选结果集，最后通过select映射&#47;返回查询结果。看了上面您写的内容，貌似，这个过程是根据优化器来选择执行计划再得出的，我也看过sql server的执行计划 ctrl+l 通常最右边也都是先join或者先拿到from后面的结果集，这是不是mysql和sql server的差异，还是我原先理解错误？望解答","like_count":0},{"had_liked":false,"id":276502,"user_name":"UniqueDirt","can_delete":false,"product_type":"c1","uid":2001375,"ip_address":"","ucode":"1E5555EE495733","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkDobVTaXD0oWouJBHQQSvnicJnzfZ7cSKmZeV20svZ7uWKGkibnL8xXiaOPRPYP7IibVIWPaCBDhjMw/132","comment_is_top":false,"comment_ctime":1611976307,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611976307","product_id":100020801,"comment_content":"分析器 ，如果要经过优化器 前提应该是确定了该语句各字段是否存在；","like_count":0},{"had_liked":false,"id":276407,"user_name":"杨柯威","can_delete":false,"product_type":"c1","uid":1662400,"ip_address":"","ucode":"BDE1BBA0C1ECEA","user_header":"https://static001.geekbang.org/account/avatar/00/19/5d/c0/db416bf0.jpg","comment_is_top":false,"comment_ctime":1611911780,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611911780","product_id":100020801,"comment_content":"分析器<br>分析器的主要作用是将客户端发过来的sql语句进行分析，这将包括预处理与解析过程，在这个阶段会解析sql语句的语义，并进行关键词和非关键词进行提取、解析，并组成一个解析树。具体的关键词包括不限定于以下：select&#47;update&#47;delete&#47;or&#47;in&#47;where&#47;group by&#47;having&#47;count&#47;limit等.如果分析到语法错误，会直接给客户端抛出异常:ERROR:You have an error in your SQL syntax.<br><br>比如：select *  from user where userId =1234;<br><br>在分析器中就通过语义规则器将select from where这些关键词提取和匹配出来,mysql会自动判断关键词和非关键词，将用户的匹配字段和自定义语句识别出来。这个阶段也会做一些校验:比如校验当前数据库是否存在user表，同时假如User表中不存在userId这个字段同样会报错：unknown column in field list.","like_count":0},{"had_liked":false,"id":276308,"user_name":"Geek_19657e","can_delete":false,"product_type":"c1","uid":2428131,"ip_address":"","ucode":"19B0146A1B4732","user_header":"","comment_is_top":false,"comment_ctime":1611883302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611883302","product_id":100020801,"comment_content":"1、mysql架构分server层和存储引擎层，server层有连接器、查询缓存(mysql8已移除)、分析器、优化器、执行器，存储引擎用于存储数据、提供读写接口；<br>2、连接器：管理连接、权限控制<br> 分析器：词意分析，解析sql语句，将sql语句解析成mysql可以识别的语法，语义分析，分析sql语句是否符合规范<br>优化器：索引选择，执行计划<br>执行器：校验执行权限，对表、行的权限再此校验，执行sql语句，响应客户端<br>","like_count":0},{"had_liked":false,"id":275658,"user_name":"树心","can_delete":false,"product_type":"c1","uid":1589523,"ip_address":"","ucode":"6C329F0FF798B9","user_header":"https://static001.geekbang.org/account/avatar/00/18/41/13/ab14ad25.jpg","comment_is_top":false,"comment_ctime":1611635578,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1611635578","product_id":100020801,"comment_content":"应该是在分析器阶段报错，至于是词法分析、还是语法分析，感觉应该更偏向于语法分析。T表中没有k字段，不能通过语法分析。","like_count":0},{"had_liked":false,"id":273180,"user_name":"身体健康万事如意","can_delete":false,"product_type":"c1","uid":2378101,"ip_address":"","ucode":"37246DBCDEB0C6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLlkIiakffb0icyMQqh98qcHPFSFAjI97HiaGk2sozRTXGNVVjcjydenYjib2mgknziaf7zylm3ibr0AmA/132","comment_is_top":false,"comment_ctime":1610467035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610467035","product_id":100020801,"comment_content":"mysql大致可分为server层和存储引擎层。<br>server层连接器、解析器、查询缓存、优化器、执行器<br>存储引擎常用的有innodb、myisam","like_count":0},{"had_liked":false,"id":271781,"user_name":"SuperDai","can_delete":false,"product_type":"c1","uid":1289318,"ip_address":"","ucode":"0CA86D253754CA","user_header":"https://static001.geekbang.org/account/avatar/00/13/ac/66/a256008b.jpg","comment_is_top":false,"comment_ctime":1609808943,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609808943","product_id":100020801,"comment_content":"初学者的猜想。表的schema应该存在内存中，显然分析器阶段就能获取到这个表结构信息，然后做一做检查就知晓了啦。","like_count":0},{"had_liked":false,"id":271442,"user_name":"zjm1314","can_delete":false,"product_type":"c1","uid":2351720,"ip_address":"","ucode":"63B0EAB7045054","user_header":"https://static001.geekbang.org/account/avatar/00/23/e2/68/ce547a12.jpg","comment_is_top":false,"comment_ctime":1609641996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609641996","product_id":100020801,"comment_content":"大佬，特别想问下，sql的预编译跟分析器有什么关系，预编译是mysql做的事么？","like_count":0},{"had_liked":false,"id":270764,"user_name":"laulee","can_delete":false,"product_type":"c1","uid":1304761,"ip_address":"","ucode":"76AC7E6CC15319","user_header":"https://static001.geekbang.org/account/avatar/00/13/e8/b9/582a01d4.jpg","comment_is_top":false,"comment_ctime":1609243440,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609243440","product_id":100020801,"comment_content":"不是分析器就是优化器。语句都不对咋给优化呢，所以是分析器了🤪","like_count":0},{"had_liked":false,"id":269777,"user_name":"Edison","can_delete":false,"product_type":"c1","uid":1135701,"ip_address":"","ucode":"734A561F363720","user_header":"https://static001.geekbang.org/account/avatar/00/11/54/55/613ddc42.jpg","comment_is_top":false,"comment_ctime":1608782416,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608782416","product_id":100020801,"comment_content":"老师，我想问个问题，我往sqlite数据库中一个表中插入数据，该表只有一个字段，数据库总是提示system. IndexOutOfRange Exception 无法找到表0的异常，但是数据已经成功插进去了。请问下这是什么原因引起的？","like_count":0},{"had_liked":false,"id":269598,"user_name":"熊猫宝宝","can_delete":false,"product_type":"c1","uid":1663921,"ip_address":"","ucode":"F082F925933C4E","user_header":"https://static001.geekbang.org/account/avatar/00/19/63/b1/6b9b9d8e.jpg","comment_is_top":false,"comment_ctime":1608709588,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1608709588","product_id":100020801,"comment_content":"你好，我就问一个问题，课程中提到了mysql8移除了查询缓存，那为什么第二次查询会比第一次查询快？应该速度不相上下才对。","like_count":0},{"had_liked":false,"id":269576,"user_name":"nwc","can_delete":false,"product_type":"c1","uid":2349067,"ip_address":"","ucode":"2FEDB3D6D5C12A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIXeicJJQk6sbWzIQfVRHoUIPkQYyXRFZ6V0O42ddCic9ypt0liciaPFwicicfpo5HJ3ibicNtL5wkXlcib5CQ/132","comment_is_top":false,"comment_ctime":1608705625,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1608705625","product_id":100020801,"comment_content":"看了这篇文章有个问题挺困扰的：<br>执行器开始执行，调用存储引擎提供的接口获取数据，但是数据的存储以及索引的实现都是在存储引擎层完成的，所以执行器是如何知道该调用“获取这个表的第一行的接口”还是调用“获取满足条件的第一行的接口”的？","like_count":0},{"had_liked":false,"id":269528,"user_name":"蛐蛐","can_delete":false,"product_type":"c1","uid":2036008,"ip_address":"","ucode":"698DB66BE78F2B","user_header":"https://static001.geekbang.org/account/avatar/00/1f/11/28/358ba71c.jpg","comment_is_top":false,"comment_ctime":1608692406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608692406","product_id":100020801,"comment_content":"连机器：解决你为什么要来<br>分析器： 解决你来干什么<br>优化器： 解决你怎么干效果最好<br>执行器： 无脑执行你选择的方式","like_count":0},{"had_liked":false,"id":269356,"user_name":"Maroon","can_delete":false,"product_type":"c1","uid":2380209,"ip_address":"","ucode":"267F9F3DA6A425","user_header":"https://static001.geekbang.org/account/avatar/00/24/51/b1/3048fe3a.jpg","comment_is_top":false,"comment_ctime":1608621986,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608621986","product_id":100020801,"comment_content":"分析器，因为分析器会做语法分析，判断你输入的SQL语句是不是满足MySQL语法","like_count":0},{"had_liked":false,"id":268439,"user_name":"TT","can_delete":false,"product_type":"c1","uid":1466771,"ip_address":"","ucode":"2D8CE3E45DA7A4","user_header":"https://static001.geekbang.org/account/avatar/00/16/61/93/3191eafa.jpg","comment_is_top":false,"comment_ctime":1608196031,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608196031","product_id":100020801,"comment_content":"## MySQL的基本架构是什么样子的<br>![20200409170440](https:&#47;&#47;taozhang.oss-cn-hongkong.aliyuncs.com&#47;note&#47;20200409170440.png)<br>分为客户端、server层和引擎层，其中引擎层是插件式的，server层的模块包括连接器、查询缓存、分析器、优化器、执行器<br><br>## 连接器的主要功能是什么<br>负责根客户端建立连接、获取权限、维持和管理连接<br><br>## 修改用户的权限后什么时机生效<br>连接建立后，连接器会去权限表获取你拥有的权限，之后的权限判断都依赖此时获取到的权限，所以修改用户的权限并不会对已经建立的连接产生影响。<br><br>## 为什么更加建议使用长连接<br>连接的建立是一个复杂的过程，如果频繁的建立连接，会影响性能<br><br>## 长连接可能会导致哪些问题且如何解决这些问题<br>* MySQL 在执行过程中临时使用的内存是管理在连接对象里面的，连接断开的时候才会被释放，如果长连接过多会导致内存占用过大。<br>* 解决方案有两个：（1）定期断开长连接；（2）MySQL5.7 及以后的版本，可以在每次执行一个较大的操作后执行一次`mysql_reset_connection`来初始化连接资源，此操作不会重连也不会重新做权限校验，只是将连接初始化到刚刚建立时的状态<br><br>## 查询缓存的功能是什么、它是如何工作的<br>查询语句被作为 key，查询结果被作为 value，以 key-value的形式缓存到内存中，这样如果一个查询语句已经存在于内存中，结果可以被直接返回<br><br>## 为什么不建议使用查询缓存<br>查询缓存会频繁失效，缓存命中率特别低，整体来说弊大于利；除非查询的表是一个静态表；<br><br>## 分析器的功能是什么<br>判断要做什么<br>进行词法分析、语法分析，判断输入的 SQL 语法是否正确<br><br>## 优化器的功能是什么<br>决定该怎么做<br>索引选择、多表关联(join)的时候决定表的连接顺序，目的是为了以最快的方式获取数据；<br><br>## 执行器的功能是什么<br>真正去做<br>做之前要判断是否有足够的权限，权限足够，调用引擎提供的接口获取数据<br>(命中查询缓存的情况下，在返回结果前会做权限验证；查询也会在优化器之前调用precheck验证权限)<br><br>## 思考题<br>**问题：** 如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？<br><br>**答案：** 分析器","like_count":0},{"had_liked":false,"id":267504,"user_name":"Geek_40c668","can_delete":false,"product_type":"c1","uid":1685451,"ip_address":"","ucode":"4F7B6A3D4F4DD1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WnbsIzp30vkf8OVicicMHv0Cepxt17aSxdUVIaiaEMullXPE79ywaETSaRl6WeyePiaqqFYoxmK0IXbaUKLpmibD4ng/132","comment_is_top":false,"comment_ctime":1607776624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607776624","product_id":100020801,"comment_content":"理解：<br>1.sql查询过程：<br>    a. 连接器。检验账号密码，建立连接。连接建立比较耗时，所以有必要使用连接池。<br>    b. 分析器。通过词法分析提取select 等关键字，通过语法分析检验sql是否合法。本阶段可以理解成将sql语句转换成mysql可以理解的，然后待执行。<br>  c.优化器。因为我们写的sql会有冗余，mysql进行分析优化，提高执行效率。以及如何选择索引。<br>  d. 执行器。此处需要检验是否有执行权限，如是否有字段，表权限。然后就刚开始调用引擎接口执行sql。<br><br>2.关于连接。连接超时时间是8h。<br>    长连接问题：连接查询的数据都是存在连接对象内，断开连接才会释放。如果使用过多或者过长时间使用长连接，会使得内存占用过多，被系统杀死，造成重启假象。<br>    解决方案：<br>           a.定期或者执行重量级查询sql操作之后断开连接，重新连接。<br>            b. 使用 mysql_reset_connection 在执行占用内存较大的sql以后，初始化连接。不用重新建立连接。","like_count":0},{"had_liked":false,"id":266916,"user_name":"xbin","can_delete":false,"product_type":"c1","uid":1327841,"ip_address":"","ucode":"2ACDAD82E752A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/42/e1/73ecc336.jpg","comment_is_top":false,"comment_ctime":1607524753,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607524753","product_id":100020801,"comment_content":"分析器，语法分析阶段。","like_count":0},{"had_liked":false,"id":266127,"user_name":"小可爱","can_delete":false,"product_type":"c1","uid":1470958,"ip_address":"","ucode":"5379D1F00E8796","user_header":"https://static001.geekbang.org/account/avatar/00/16/71/ee/31b19304.jpg","comment_is_top":false,"comment_ctime":1607178492,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607178492","product_id":100020801,"comment_content":"查询缓存的KEY如果是和query相关的，那后面说的更新会删除表的缓存，那么看起来mysql能从query定位到是哪张表，但是这应该是后面分析器做的事呢。","like_count":0},{"had_liked":false,"id":265401,"user_name":"Geek_edc76d","can_delete":false,"product_type":"c1","uid":2313724,"ip_address":"","ucode":"E6B9E1930C3AAD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/drctCc7ys2K91CKqc1OgBeAJWgx0wvGvtlgCo8gmtobmVicu1W9Z89RCqaHW86emMRt17Cr1RHaQvnR7QqUUPfg/132","comment_is_top":false,"comment_ctime":1606890389,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606890389","product_id":100020801,"comment_content":"分析器，因为这个不是语法上的错误，当知道查询的该表没有这个字段的时候，说明已经获取了是否有这个表的查询权限，而这个过程是分析器做的事情","like_count":0},{"had_liked":false,"id":264962,"user_name":"臭臭","can_delete":false,"product_type":"c1","uid":1225053,"ip_address":"","ucode":"5EDA1D1C524E5C","user_header":"https://wx.qlogo.cn/mmopen/vi_32/ZPx5SlIHaNjKotyoGHrhg0u4cZqmdr033CZtUzb4MY70HzWABYYIEibBLUGAxnfJmMjflHibXB0UgAxHjEL8aOoQ/132","comment_is_top":false,"comment_ctime":1606722479,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606722479","product_id":100020801,"comment_content":"请教下， 为什么当初权限要设计成基于连接，这样会导致修改无法实时生效， 为什么不是设计成支持实时生效的呢？","like_count":0},{"had_liked":false,"id":263555,"user_name":"altair","can_delete":false,"product_type":"c1","uid":2167648,"ip_address":"","ucode":"FE91C23E76412D","user_header":"https://static001.geekbang.org/account/avatar/00/21/13/60/4c569b0b.jpg","comment_is_top":false,"comment_ctime":1606183756,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606183756","product_id":100020801,"comment_content":"应该是分析器阶段，在经过词法分析获得token后，分析器会从一个system catalog表中查找是否存要查询的表，以及要查询的列是某存在于这个表中，类似的，表不存在的错误也是在分析器阶段发现的","like_count":0},{"had_liked":false,"id":263518,"user_name":"张知信","can_delete":false,"product_type":"c1","uid":2144474,"ip_address":"","ucode":"7C896BB3214B3D","user_header":"https://static001.geekbang.org/account/avatar/00/20/b8/da/42284f64.jpg","comment_is_top":false,"comment_ctime":1606147052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606147052","product_id":100020801,"comment_content":"对MySQL的逻辑架构图有个小小的疑问，图中分析器到查询缓存是有一个箭头的，但是文中并没有提及分析器之后会去查询缓存，分析器之后就到优化器了，这个箭头是误画了吗？","like_count":0},{"had_liked":false,"id":262561,"user_name":"张诚","can_delete":false,"product_type":"c1","uid":1115702,"ip_address":"","ucode":"F623703194769B","user_header":"https://static001.geekbang.org/account/avatar/00/11/06/36/d288bcc7.jpg","comment_is_top":false,"comment_ctime":1605768778,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1605768778","product_id":100020801,"comment_content":"mysql_reset_connection()是C 的API","like_count":0},{"had_liked":false,"id":262287,"user_name":"Chnnnne","can_delete":false,"product_type":"c1","uid":2308011,"ip_address":"","ucode":"A1DDEEB9CC0EA7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKichYoUodkm0I6A3ZPxoOe8F0qH45bdAceSicAw4zQ7of5ceKUjiaStiamiaFwZMaeIl6WHbazleZwia2w/132","comment_is_top":false,"comment_ctime":1605684546,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605684546","product_id":100020801,"comment_content":"按照编译原理的理解， 语法分析只是按照文法分析单词组成的句子是否是正确的语法范畴，不知作者的意思是不是这样？如果是的话，那么我认为应该是在优化阶段","like_count":0},{"had_liked":false,"id":262197,"user_name":"A梦多啦A","can_delete":false,"product_type":"c1","uid":1018224,"ip_address":"","ucode":"026669D6CACA8A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/70/f5845602.jpg","comment_is_top":false,"comment_ctime":1605662991,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605662991","product_id":100020801,"comment_content":"老师，我看有的 MySQL 书籍提及到了，分析器与优化器中间有一层预处理，优化器与执行器中间有一层缓存。这里的预处理和缓存主要作用是啥呢？","like_count":0},{"had_liked":false,"id":260650,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1605078098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605078098","product_id":100020801,"comment_content":"老师的课很赞，已推荐给好几个同事","like_count":0},{"had_liked":false,"id":260571,"user_name":"南京-杰神","can_delete":false,"product_type":"c1","uid":2130846,"ip_address":"","ucode":"9338295A099CC8","user_header":"https://static001.geekbang.org/account/avatar/00/20/83/9e/a8b6e839.jpg","comment_is_top":false,"comment_ctime":1605063349,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605063349","product_id":100020801,"comment_content":"最后的问题 肯定是分析器啊！","like_count":0},{"had_liked":false,"id":259452,"user_name":"hao","can_delete":false,"product_type":"c1","uid":1148845,"ip_address":"","ucode":"997F2B57E2F556","user_header":"https://static001.geekbang.org/account/avatar/00/11/87/ad/50a85a04.jpg","comment_is_top":false,"comment_ctime":1604730255,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604730255","product_id":100020801,"comment_content":"连接器（建立连接）、分析器（合法性检查）、优化器（自动优化sql语句）、执行器（有无索引...）","like_count":0},{"had_liked":false,"id":259278,"user_name":"beautiful°","can_delete":false,"product_type":"c1","uid":2292279,"ip_address":"","ucode":"46E7F36DED59FC","user_header":"https://static001.geekbang.org/account/avatar/00/22/fa/37/c6776148.jpg","comment_is_top":false,"comment_ctime":1604669159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604669159","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":258849,"user_name":"陈小渣👻","can_delete":false,"product_type":"c1","uid":1374445,"ip_address":"","ucode":"6B968B06C76C63","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/ed/60fb8fba.jpg","comment_is_top":false,"comment_ctime":1604566967,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604566967","product_id":100020801,"comment_content":"有个问题，执行器去存储数据获取数据是先查内存在查磁盘，还是直接查磁盘，这里能不能在仔细点","like_count":0},{"had_liked":false,"id":258807,"user_name":"陈小渣👻","can_delete":false,"product_type":"c1","uid":1374445,"ip_address":"","ucode":"6B968B06C76C63","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/ed/60fb8fba.jpg","comment_is_top":false,"comment_ctime":1604560564,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604560564","product_id":100020801,"comment_content":"分析器，分析sql的词法和语法，判断sql是否正确","like_count":0},{"had_liked":false,"id":258575,"user_name":"fourth","can_delete":false,"product_type":"c1","uid":1309546,"ip_address":"","ucode":"1DDC648713DA40","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/uCXjH7wlvE7GicGPsYQRzibB7MA6qCaM5Pd50rbxz1QU2X85sD24Qiapk7k9ujYrmJEvCLrZnwLhriaSupBIIZvUeg/132","comment_is_top":false,"comment_ctime":1604488356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604488356","product_id":100020801,"comment_content":"长链接、短链接在MySQL5.7下的默认行为是什么？<br>如何设定让某个表存在查询缓存？","like_count":0},{"had_liked":false,"id":258423,"user_name":"Geek_e9fb13","can_delete":false,"product_type":"c1","uid":2286032,"ip_address":"","ucode":"4A2B2F4505F751","user_header":"","comment_is_top":false,"comment_ctime":1604420542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604420542","product_id":100020801,"comment_content":"老师您好！我觉得对表的权限验证应该是分析器阶段，所有的用户都有访问information_schema下的表权限（但只能看到这些表中与用户具有访问权限的对象相应的数据行），对表的元信息验证就是对information_schema进行查询，在查询information_schema时候就已经决定了是否有对表的权限了，即使是触发器的预编译也是需要对权限的验证，没有权限也会编译不通过！","like_count":0},{"had_liked":false,"id":258300,"user_name":"凌风","can_delete":false,"product_type":"c1","uid":1767871,"ip_address":"","ucode":"9E5A8960CBEB37","user_header":"https://static001.geekbang.org/account/avatar/00/1a/f9/bf/dfe8273d.jpg","comment_is_top":false,"comment_ctime":1604375568,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1604375568","product_id":100020801,"comment_content":"mysql自己本身有连接池吗？","like_count":0},{"had_liked":false,"id":256733,"user_name":"玄真","can_delete":false,"product_type":"c1","uid":2237677,"ip_address":"","ucode":"D21A7096AFB816","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLg04lnicnUNWVmohBVoWiaKPpuYu8j0CHVIjjurfO3YcJqicHZBMYFqjoEpiaa3jrNmRzyzXiaPPt29cA/132","comment_is_top":false,"comment_ctime":1603718859,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603718859","product_id":100020801,"comment_content":"分析器吧，解析k是不是一个列","like_count":0},{"had_liked":false,"id":255848,"user_name":"天晴录","can_delete":false,"product_type":"c1","uid":1656786,"ip_address":"","ucode":"E27A5909F2A67C","user_header":"https://static001.geekbang.org/account/avatar/00/19/47/d2/5a49bbfb.jpg","comment_is_top":false,"comment_ctime":1603443335,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603443335","product_id":100020801,"comment_content":"老师好，问一下很基础的问题，如何在Springboot项目上，在查询后执行mysql_reset_connection？有执行的必要吗？","like_count":0},{"had_liked":false,"id":253876,"user_name":"曾子良","can_delete":false,"product_type":"c1","uid":1856182,"ip_address":"","ucode":"3C2F7234E40451","user_header":"https://static001.geekbang.org/account/avatar/00/1c/52/b6/202076f0.jpg","comment_is_top":false,"comment_ctime":1602927398,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602927398","product_id":100020801,"comment_content":"分析器阶段：<br>分析器阶段做了词法分析和语法分析，在对所输入的SQL语句进行语法、词法分析的同时，还对表、表中的字段是否存在也做了分析。完成该阶段的工作无误后才会进行下一阶段优化器。","like_count":0},{"had_liked":false,"id":252395,"user_name":"柯察金","can_delete":false,"product_type":"c1","uid":1115149,"ip_address":"","ucode":"F722BF8FCD2C47","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/0d/3dc5683a.jpg","comment_is_top":false,"comment_ctime":1602290333,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602290333","product_id":100020801,"comment_content":"老师，你提到长连接要定期断开，不然会产生 oom。可是生产实践过程中，我真的很少碰到这个问题啊，难道是框架帮我做了吗","like_count":0},{"had_liked":false,"id":252141,"user_name":"Yin Lixue","can_delete":false,"product_type":"c1","uid":2221356,"ip_address":"","ucode":"F7FB44065BFC24","user_header":"https://static001.geekbang.org/account/avatar/00/21/e5/2c/91b5c138.jpg","comment_is_top":false,"comment_ctime":1602142530,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602142530","product_id":100020801,"comment_content":"列不存在这个错，我认为应该是在词法分析阶段报出来的","like_count":0},{"had_liked":false,"id":252001,"user_name":"泽临","can_delete":false,"product_type":"c1","uid":2220881,"ip_address":"","ucode":"07F64838056D97","user_header":"https://static001.geekbang.org/account/avatar/00/21/e3/51/b25c67a5.jpg","comment_is_top":false,"comment_ctime":1602048453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602048453","product_id":100020801,"comment_content":"在分析器阶段提出：因为分析器中需要根据字段名去寻找字段id再传到优化器。所以在字段不存在时就会提出错误","like_count":0},{"had_liked":false,"id":251850,"user_name":"Wang","can_delete":false,"product_type":"c1","uid":1052957,"ip_address":"","ucode":"9BEFA46433F86B","user_header":"https://static001.geekbang.org/account/avatar/00/10/11/1d/6ad7eb3c.jpg","comment_is_top":false,"comment_ctime":1601908130,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1601908130","product_id":100020801,"comment_content":"表中没有字段，在分析器解析转换成表中的字段名时候应该会出错了。","like_count":0},{"had_liked":false,"id":251820,"user_name":"涛","can_delete":false,"product_type":"c1","uid":1158168,"ip_address":"","ucode":"48C7BDB7AD650D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/18/25ae9cf7.jpg","comment_is_top":false,"comment_ctime":1601887998,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601887998","product_id":100020801,"comment_content":"总结：MYSQL 主要分为Server层和执行引擎，Server层分为分析器，优化器，执行器。<br>分析器：语法分析<br>优化器：对语法的执行选择最优解<br>执行器：选择执行引擎处理","like_count":0},{"had_liked":false,"id":251540,"user_name":"Li Lei  Han Mei Mei","can_delete":false,"product_type":"c1","uid":1184299,"ip_address":"","ucode":"8F3DC22E91C4BB","user_header":"https://static001.geekbang.org/account/avatar/00/12/12/2b/0d8393ed.jpg","comment_is_top":false,"comment_ctime":1601651093,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601651093","product_id":100020801,"comment_content":"应该会在分析器中的语法分析报错。词分分析器会分离出关键字和标识符。此时分析器还不认识 “k”，等到语法分析时发现 k 字段在表信息中查询不到，抛出错误。","like_count":0},{"had_liked":false,"id":251492,"user_name":"段宇","can_delete":false,"product_type":"c1","uid":1842494,"ip_address":"","ucode":"654B4C6EE8E590","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eofmoMjbImgbVAe4567SqhNy4PphkNAUUtkKIoicLQdC7HtwqYROYUCsibHDjB5uEbcmicGjn4tVLe3g/132","comment_is_top":false,"comment_ctime":1601615105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601615105","product_id":100020801,"comment_content":"老师，麻烦请教下，文中提到“使用长连接可能存在内存占用过多的问题”，是指的内存不会复用吗。<br>假设先执行了一条数据量大的查询，再执行一条数据量小的查询，那么第二次查询是重新申请内存，还是复用上一条查询申请的内存呢？","like_count":0},{"had_liked":false,"id":251381,"user_name":"Geek_770154","can_delete":false,"product_type":"c1","uid":1859066,"ip_address":"","ucode":"2CF231B1AB6008","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKic4ttq8hHdg1gzd2zP7pxyJicHecibc6poicT8clFsHauGtPJxqcDsHv0h5jKTGgYKhf4dO01e65cUw/132","comment_is_top":false,"comment_ctime":1601516138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601516138","product_id":100020801,"comment_content":"话说怎么才能调用mysql_reset_connection","like_count":0},{"had_liked":false,"id":250532,"user_name":"惊蛰","can_delete":false,"product_type":"c1","uid":2089184,"ip_address":"","ucode":"FAC7DF2FF00DB9","user_header":"https://static001.geekbang.org/account/avatar/00/1f/e0/e0/0cc322af.jpg","comment_is_top":false,"comment_ctime":1601118574,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601118574","product_id":100020801,"comment_content":"这些笔记怎么关掉呀？一大坨下划线，却没有什么有价值的信息。感觉有价值的信息都在评论区。","like_count":0},{"had_liked":false,"id":250391,"user_name":"神毓逍遥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1601047041,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1601047041","product_id":100020801,"comment_content":"之前看连接池的源码，对于连接最大使用次数，一直不太懂为啥要有这个参数，今天看到长连接会导致<br>连接对象中的内存不断增大，突然柳暗花明了","like_count":0},{"had_liked":false,"id":249910,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1600849082,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600849082","product_id":100020801,"comment_content":"执行器验证权限是调存储引擎接口吗？这个动作是执行计划的一部分吗？","like_count":0},{"had_liked":false,"id":249908,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1600848231,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600848231","product_id":100020801,"comment_content":"语法分析形成语法树的时候应该要检查词法和语法，所以关键词的错误，语法错误都会在生成语法树的过程中被检测出来。<br><br>优化器其实是做语义分析然后优化生成执行计划交于执行器执行，这部分会做索引的选择，还有复杂语句的等价替换，每种数据库的黑科技大概就在这儿了。（SQL注入是在执行计划生成前做的，如果预先生成执行计划后给变量赋值就不存在SQL注入的情况了）<br><br>执行器先查询权限，有权限就调存储引擎接口","like_count":0},{"had_liked":false,"id":248494,"user_name":"何海林","can_delete":false,"product_type":"c1","uid":2159955,"ip_address":"","ucode":"001EC3E3639C90","user_header":"https://static001.geekbang.org/account/avatar/00/20/f5/53/da4bad66.jpg","comment_is_top":false,"comment_ctime":1600179148,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600179148","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":248350,"user_name":"很大的勇气","can_delete":false,"product_type":"c1","uid":1695608,"ip_address":"","ucode":"7871D1C1E22F3F","user_header":"https://static001.geekbang.org/account/avatar/00/19/df/78/d4946736.jpg","comment_is_top":false,"comment_ctime":1600132083,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600132083","product_id":100020801,"comment_content":"为什么这个报错是分析器提示的呢？","like_count":0},{"had_liked":false,"id":248259,"user_name":"盛情的jack","can_delete":false,"product_type":"c1","uid":1123566,"ip_address":"","ucode":"E4EDA00FDE07E4","user_header":"https://static001.geekbang.org/account/avatar/00/11/24/ee/12068a33.jpg","comment_is_top":false,"comment_ctime":1600083339,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600083339","product_id":100020801,"comment_content":"看Mysql架构图里面，连接器（Connectors）不是JDBC,ODBC这些吗？连接池（Connection pool）不是才是权限验证这些嘛？","like_count":0},{"had_liked":false,"id":247442,"user_name":"王大喵","can_delete":false,"product_type":"c1","uid":1109528,"ip_address":"","ucode":"C14AAE3ED964DE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ee/18/65e89d9c.jpg","comment_is_top":false,"comment_ctime":1599709829,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599709829","product_id":100020801,"comment_content":"希望是在分析的时候爆出来","like_count":0},{"had_liked":false,"id":246446,"user_name":"团队组建中","can_delete":false,"product_type":"c1","uid":2064977,"ip_address":"","ucode":"9ADA622C1F443C","user_header":"","comment_is_top":false,"comment_ctime":1599353709,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599353709","product_id":100020801,"comment_content":"问题分析：<br>1.K列不存在，说明已经触及表结构了。只有在触及表后才能知道该列是否有效。而要触及表则是在执行器执行时才会发生。","like_count":0},{"had_liked":false,"id":245213,"user_name":"元末","can_delete":false,"product_type":"c1","uid":2156850,"ip_address":"","ucode":"AB00C7E2EF36E8","user_header":"https://static001.geekbang.org/account/avatar/00/20/e9/32/b89fcc77.jpg","comment_is_top":false,"comment_ctime":1598864990,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598864990","product_id":100020801,"comment_content":"肯定不是分析器，分析器只分析语义。<br><br>原文中对「执行器」有这么一句话：「开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限」。优化器因为后面要细讲，这里提的也不多，所以还不知道它说判断最优解的逻辑是什么。但是执行器先判断该表的权限，感觉就它了！","like_count":0},{"had_liked":false,"id":244766,"user_name":"Geek_51a4bf","can_delete":false,"product_type":"c1","uid":2154116,"ip_address":"","ucode":"4A238FDFAD5945","user_header":"","comment_is_top":false,"comment_ctime":1598671047,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598671047","product_id":100020801,"comment_content":"应该是分析器阶段","like_count":0},{"had_liked":false,"id":242567,"user_name":"Change","can_delete":false,"product_type":"c1","uid":1611462,"ip_address":"","ucode":"C65BB004EEAF2B","user_header":"https://static001.geekbang.org/account/avatar/00/18/96/c6/5ae62afe.jpg","comment_is_top":false,"comment_ctime":1597763034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597763034","product_id":100020801,"comment_content":"老师，请问在逻辑架构图里面，为什么分析器会查询缓存呢？这个查的是什么数据呢？","like_count":0},{"had_liked":false,"id":241247,"user_name":"兔子吥乖","can_delete":false,"product_type":"c1","uid":1498214,"ip_address":"","ucode":"B81105E93F0ED5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/XJgzdIfhDdADCKoiakm7ib1wibnOxQpcdvzoTmMczFIskYIosCKQrVcILic0Taf3ompHbGbAyfqLF5eLSiagGGXDX6Q/132","comment_is_top":false,"comment_ctime":1597222769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597222769","product_id":100020801,"comment_content":"老师，我有两个问题：<br>长连接里面保存的资源有哪些，比如 query 的临时变量之类的？ <br>mysql 执行 query的时候会不会生成临时文件？如何会的话，临时文件的创建和删除有哪些策略？","like_count":0},{"had_liked":false,"id":240988,"user_name":"WilliamVector","can_delete":false,"product_type":"c1","uid":1898112,"ip_address":"","ucode":"E0D3C3D4FCB7C9","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/80/85ec2c2a.jpg","comment_is_top":false,"comment_ctime":1597142936,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597142936","product_id":100020801,"comment_content":"MySQL检查列是否存在，是在分析器阶段。MySQL 从输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。然后把字符串“T”识别成“表名 T”，把字符串“k”识别成“列 k”，如果没有k列，则报“Unknown column ‘k’ in ‘where clause’”的错误。","like_count":0},{"had_liked":false,"id":239687,"user_name":"han","can_delete":false,"product_type":"c1","uid":2108271,"ip_address":"","ucode":"1596D492F7CFB9","user_header":"https://static001.geekbang.org/account/avatar/00/20/2b/6f/65a61041.jpg","comment_is_top":false,"comment_ctime":1596616047,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596616047","product_id":100020801,"comment_content":"执行器","like_count":0},{"had_liked":false,"id":238589,"user_name":"prepared","can_delete":false,"product_type":"c1","uid":1194853,"ip_address":"","ucode":"00E54A5C7CDCBE","user_header":"https://static001.geekbang.org/account/avatar/00/12/3b/65/3a4fc8cf.jpg","comment_is_top":false,"comment_ctime":1596207223,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596207223","product_id":100020801,"comment_content":"分析器，列K 没有","like_count":0},{"had_liked":false,"id":237489,"user_name":"脱缰的野马__","can_delete":false,"product_type":"c1","uid":1447569,"ip_address":"","ucode":"D5F993E7232C61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WtHCCMoLJ2DvzqQwPYZyj2RlN7eibTLMHDMTSO4xIKjfKR1Eh9L98AMkkZY7FmegWyGLahRQJ5ibPzeeFtfpeSow/132","comment_is_top":false,"comment_ctime":1595844489,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595844489","product_id":100020801,"comment_content":"二刷~<br>老师你好，请问一个问题，针对文章介绍执行器的查询没有索引的查询流程那块，执行器是一条一条的查询，那如果我的查询条件里面有limit限制为1条，这样的话执行器是不是查询到1条满足条件的数据之后加入结果集就不会再继续查询了吧？我用explain查两条sql的rows是差不多的","like_count":0},{"had_liked":false,"id":237464,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1168774,"ip_address":"","ucode":"9A5B148A7E453A","user_header":"https://static001.geekbang.org/account/avatar/00/11/d5/86/5b1ff7d9.jpg","comment_is_top":false,"comment_ctime":1595838323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595838323","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":236856,"user_name":"风","can_delete":false,"product_type":"c1","uid":1147929,"ip_address":"","ucode":"AFDBEFA49F269E","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/19/7ed2ffa6.jpg","comment_is_top":false,"comment_ctime":1595568665,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1595568665","product_id":100020801,"comment_content":"elect * from t where ID=1;<br>这个错误不是在词法分析的时候就可以识别吗？为什么要到语法分析","like_count":0},{"had_liked":false,"id":236658,"user_name":"黑客时间","can_delete":false,"product_type":"c1","uid":1831324,"ip_address":"","ucode":"7E22D76EECAC4D","user_header":"https://static001.geekbang.org/account/avatar/00/1b/f1/9c/cd12361d.jpg","comment_is_top":false,"comment_ctime":1595492939,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595492939","product_id":100020801,"comment_content":"mysql_reset_connection 这个函数怎么调用呢，网上也没找到相关方法","like_count":0},{"had_liked":false,"id":236505,"user_name":"慧","can_delete":false,"product_type":"c1","uid":1658778,"ip_address":"","ucode":"E0FC2EF7AE33B2","user_header":"https://static001.geekbang.org/account/avatar/00/19/4f/9a/e71af464.jpg","comment_is_top":false,"comment_ctime":1595430181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595430181","product_id":100020801,"comment_content":"我觉得这个应该是在分析器执行的阶段爆出来的错误，由于分析器在执行时解决的是要做什么，分析select是做查询，将条件转为对应的列，此时就会报错找不到对应的列","like_count":0},{"had_liked":false,"id":236076,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1531029,"ip_address":"","ucode":"0C66D7707BFD1F","user_header":"https://static001.geekbang.org/account/avatar/00/17/5c/95/553956fb.jpg","comment_is_top":false,"comment_ctime":1595305880,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595305880","product_id":100020801,"comment_content":"在优化器执行时已经是生成了执行计划，所以肯定在此之前就已经报错了。那就只能在分析器的执行过程中报错，分析器中有词法分析，语法分析等一系列操作，具体是哪一步检测并不确定。。。待详解","like_count":0},{"had_liked":false,"id":234351,"user_name":"dingsai88","can_delete":false,"product_type":"c1","uid":1029484,"ip_address":"","ucode":"A725428A983ADC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/6c/617c0193.jpg","comment_is_top":false,"comment_ctime":1594652257,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594652257","product_id":100020801,"comment_content":"是分析器，在分析阶段，会判断你的SQL语句是否合法，查询的字段是否存在","like_count":0},{"had_liked":false,"id":234313,"user_name":"余亮","can_delete":false,"product_type":"c1","uid":1913695,"ip_address":"","ucode":"6CDE1A4D194341","user_header":"","comment_is_top":false,"comment_ctime":1594641705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594641705","product_id":100020801,"comment_content":"分析器，分析语法是否正确。","like_count":0},{"had_liked":false,"id":233573,"user_name":"送过快递的码农","can_delete":false,"product_type":"c1","uid":1587666,"ip_address":"","ucode":"66EA81B3BADC73","user_header":"https://static001.geekbang.org/account/avatar/00/18/39/d2/845c0e39.jpg","comment_is_top":false,"comment_ctime":1594358263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594358263","product_id":100020801,"comment_content":"问一个问题啊  比如这样一句sql select * from table_a where create_time between &#39;2020-01-01 00:00:00&#39; and &#39;2020-06-30 23:59:59&#39;  mysql 会不会在编译层把两个字符串转成对应的时间类型 还是在执行的时候转 换？假如 create_time 是timestmp 类型 且有索引 这种情况 会走索引么？","like_count":0},{"had_liked":false,"id":233127,"user_name":"明天会更好","can_delete":false,"product_type":"c1","uid":2037972,"ip_address":"","ucode":"943223E7DA8D83","user_header":"https://static001.geekbang.org/account/avatar/00/1f/18/d4/80d89bd0.jpg","comment_is_top":false,"comment_ctime":1594223451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594223451","product_id":100020801,"comment_content":"刚买的课程，一看评论都两年前了，不知作者还能看到吗？您说的避免长时间链接？否则非常占用内存，是这样的。但是我在爬取数据入库的时候，一般都是打开链接，然后一直执行插入的操作，而且一链接就是好多天，而且有多个链接同时存在，对于这种，作者有什么好的方法推荐吗？","like_count":0},{"had_liked":false,"id":232502,"user_name":"微信还是支付宝","can_delete":false,"product_type":"c1","uid":1731048,"ip_address":"","ucode":"E9C27DEFB6908C","user_header":"https://static001.geekbang.org/account/avatar/00/1a/69/e8/bba34199.jpg","comment_is_top":false,"comment_ctime":1594020720,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594020720","product_id":100020801,"comment_content":"分析器，不用打开表看value数据，只要看keys 表的字段就可以发现这个字段key是否存在，这是表结构分析的一部分，分析出不存在这个表字段key，都没有往下走，打开表的必要了。","like_count":0},{"had_liked":false,"id":231846,"user_name":"Geek_770154","can_delete":false,"product_type":"c1","uid":1859066,"ip_address":"","ucode":"2CF231B1AB6008","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKic4ttq8hHdg1gzd2zP7pxyJicHecibc6poicT8clFsHauGtPJxqcDsHv0h5jKTGgYKhf4dO01e65cUw/132","comment_is_top":false,"comment_ctime":1593786966,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593786966","product_id":100020801,"comment_content":"本来想说从逻辑上来说最佳的地方是分析器，尽早发现错误尽早返回。但是想想好像也不妥，因为表查询权限的验证不是在分析器之后嘛，如果一个没有权限的用户，用此种方法虽然不能获取到目标表的数据，但是却能白嫖到目标表的结构，感觉这点不是很合理哎。然后看作者回复说是在分析器里验证的，感觉很迷惑。","like_count":0},{"had_liked":false,"id":231824,"user_name":"橄榄","can_delete":false,"product_type":"c1","uid":2030361,"ip_address":"","ucode":"72CF90BD7B4EDB","user_header":"https://static001.geekbang.org/account/avatar/00/1e/fb/19/aa7931c0.jpg","comment_is_top":false,"comment_ctime":1593781778,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593781778","product_id":100020801,"comment_content":"老师可否讲一下 MySQL 的逻辑架构图 从分析器到查询缓存这一步<br>根据文章讲解：<br>-- 若命中查询缓存，直接取结果<br>-- 若未命中，走 分析器 -&gt; 优化器 -&gt; 执行器<br>那么 分析器 -&gt; 查询缓存 是什么意思呢","like_count":0},{"had_liked":false,"id":230905,"user_name":"蜗牛","can_delete":false,"product_type":"c1","uid":1235207,"ip_address":"","ucode":"CB3D55B4011C8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/d9/07/f477e85a.jpg","comment_is_top":false,"comment_ctime":1593519760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593519760","product_id":100020801,"comment_content":"当然是分析器，因为文中已经给出答案了哈哈哈","like_count":0},{"had_liked":false,"id":228947,"user_name":"H","can_delete":false,"product_type":"c1","uid":1793962,"ip_address":"","ucode":"04D7D030245E27","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5f/aa/63e641c1.jpg","comment_is_top":false,"comment_ctime":1592850193,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592850193","product_id":100020801,"comment_content":"有一个权限校验的问题：摘自原文的一段话---“开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，如果没有，就会返回没有权限的错误，如下所示 (在工程实现上，如果命中查询缓存，会在查询缓存返回结果的时候，做权限验证。查询也会在优化器之前调用 precheck 验证权限)。”<br><br>这里括号内，说的是工程上的实现，是在优化器之前执行权限校验，疑问一：为什么是在优化器之前执行权限校验？而不是在其他步骤，比如分析器中做权限校验？设计的目的是？疑问二：括号外，说的是执行前做权限校验，括号内，说的是优化器之前做校验（工程中），究竟哪个才是正确的？望老师解答疑惑","like_count":0},{"had_liked":false,"id":228115,"user_name":"静静聆听","can_delete":false,"product_type":"c1","uid":1263932,"ip_address":"","ucode":"0A8600CB928EFE","user_header":"https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg","comment_is_top":false,"comment_ctime":1592559015,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592559015","product_id":100020801,"comment_content":"老师我用的是8.0版本，用processlist命令查看连接对象的内存，发现只有正在执行的sql才占用连接对象内存，执行完了就不占用连接对象内存了，不会有您文章中说的保持连接就会一直占用连接查询的内存。此处不解，您能解答下么","like_count":0},{"had_liked":false,"id":226823,"user_name":"刘剑","can_delete":false,"product_type":"c1","uid":1140328,"ip_address":"","ucode":"B530AE58C05788","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/68/fe556f2f.jpg","comment_is_top":false,"comment_ctime":1592210913,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592210913","product_id":100020801,"comment_content":"分析器里面报出来的，语法解析，语义分析就会去搜索关键字，表名，列明是否存在","like_count":0},{"had_liked":false,"id":226802,"user_name":"极客中心","can_delete":false,"product_type":"c1","uid":1542363,"ip_address":"","ucode":"F1CE36E3E47A3C","user_header":"https://static001.geekbang.org/account/avatar/00/17/88/db/adad4661.jpg","comment_is_top":false,"comment_ctime":1592206546,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592206546","product_id":100020801,"comment_content":"elect * from t where ID=1;   这条sql语句，为什么不是词法分析判断它不对呢。 ","like_count":0},{"had_liked":false,"id":226417,"user_name":"Geek__风雨","can_delete":false,"product_type":"c1","uid":1447977,"ip_address":"","ucode":"A2CA9983A1EAA0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM70nnPpGc2c9vic68lB3ndZxlWLwXakhpkq8ZzZSPRusynorCafpoAYxkicOYhRic9GTEqWjhagDLp6w/132","comment_is_top":false,"comment_ctime":1592093287,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592093287","product_id":100020801,"comment_content":"分析器包含词法分析，语法分析；优化器选择最优执行方式，是否使用索引，使用哪个索引","like_count":0},{"had_liked":false,"id":226401,"user_name":"Geek_2d1063","can_delete":false,"product_type":"c1","uid":1846614,"ip_address":"","ucode":"DB2C811C085D11","user_header":"https://static001.geekbang.org/account/avatar/00/1c/2d/56/5bd0a219.jpg","comment_is_top":false,"comment_ctime":1592063177,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592063177","product_id":100020801,"comment_content":"有了优化器后，where 后面字段顺序对于效率就没有任何影响了吗？","like_count":0},{"had_liked":false,"id":226290,"user_name":"石彪","can_delete":false,"product_type":"c1","uid":1030478,"ip_address":"","ucode":"CE05449AECA1B2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b9/4e/a585c3d2.jpg","comment_is_top":false,"comment_ctime":1592024520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592024520","product_id":100020801,"comment_content":"这一章提到，读写权限是在执行器判断的。是不是在分析器分析出执行内容，比如是读或者写，以及读取的表，就可以判断是否有权限，不用延迟到执行阶段。","like_count":0},{"had_liked":false,"id":225656,"user_name":"一方通行","can_delete":false,"product_type":"c1","uid":1709955,"ip_address":"","ucode":"F85546122F9781","user_header":"https://static001.geekbang.org/account/avatar/00/1a/17/83/e4141c61.jpg","comment_is_top":false,"comment_ctime":1591806350,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591806350","product_id":100020801,"comment_content":"我个人认为是分析器，用来分析语法是否符合表现有的字段。而优化器和执行器都是根据分析器得出的结果而开始运行的。优化器会在sql语句中选出最佳的方案，执行器根据最佳方案而开始执行","like_count":0},{"had_liked":false,"id":225557,"user_name":"Geek_ab0a2f","can_delete":false,"product_type":"c1","uid":1656887,"ip_address":"","ucode":"CD5692D2049E61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqP1DzTb4nCHtibMj2fMq8V3iaDIcZkjzZxe7gTyU0PYTG727oa3TTLhxNMhtA3Ewp6O1gFcygPymJA/132","comment_is_top":false,"comment_ctime":1591785412,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591785412","product_id":100020801,"comment_content":"我认为是分析器的原因是:在分析器阶段,需要把字符串识别成列，这个时候会拿着出现的字符串去表的元数据里面查询是不是有这个列，如果有就会被识别成列，如果没有就会报出来。我认为这也可以理解成一个语法的错误吧。","like_count":0},{"had_liked":false,"id":225526,"user_name":"Geek_263fd3","can_delete":false,"product_type":"c1","uid":2034718,"ip_address":"","ucode":"876710A41972B2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/OaHcUZduZXZ0DwO7GAOO4HVmib39aml4AW3WgAmPtrjEEDmrfw1X139gDIic3u0Ve8md68HupibRxEJSep7JriccqQ/132","comment_is_top":false,"comment_ctime":1591776816,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591776816","product_id":100020801,"comment_content":"分析器<br>","like_count":0},{"had_liked":false,"id":225260,"user_name":"Geek_d38f30","can_delete":false,"product_type":"c1","uid":1512147,"ip_address":"","ucode":"955D6480731336","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ib1aca6ibMC3bcTZeVdTFalyyhdvy4DLQ7s4WBTWaw95k8IJNTUkZ5VwfB9rYwxVz3PAz4chBJhWcyMHib9KdEEnQ/132","comment_is_top":false,"comment_ctime":1591698225,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591698225","product_id":100020801,"comment_content":"我用了sql智能提示功能,本身既可以自动补全列名和表名。我猜是分析器","like_count":0},{"had_liked":false,"id":224648,"user_name":"陈国林","can_delete":false,"product_type":"c1","uid":1438037,"ip_address":"","ucode":"83D12F3E79F197","user_header":"https://static001.geekbang.org/account/avatar/00/15/f1/55/8ac4f169.jpg","comment_is_top":false,"comment_ctime":1591496955,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591496955","product_id":100020801,"comment_content":"我觉得应该是在 词法分析阶段。<br>因为词法分析要识别出哪些是 table name，哪些是 column，因此可以在这里就进行判断， 没有必要往下一层","like_count":0},{"had_liked":false,"id":224063,"user_name":"jy","can_delete":false,"product_type":"c1","uid":1785172,"ip_address":"","ucode":"F4E179C435451B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJ6G2xZvNRmhyXBjmGbI5G8icGCCMPupr6yxZ1IcURwp7GTRHcpWGWpg9A0fLlyicmVdDwzqZqwiaOQ/132","comment_is_top":false,"comment_ctime":1591264105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591264105","product_id":100020801,"comment_content":"在工程实现上，如果命中查询缓存，会在查询缓存返回结果的时候，做权限验证。查询也会在优化器之前调用 precheck 验证权限<br><br>这个怎么验证的权限呢？","like_count":0},{"had_liked":false,"id":223808,"user_name":"zft","can_delete":false,"product_type":"c1","uid":2020865,"ip_address":"","ucode":"74DEC5FBA610B1","user_header":"https://static001.geekbang.org/account/avatar/00/1e/d6/01/eaa50203.jpg","comment_is_top":false,"comment_ctime":1591184970,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591184970","product_id":100020801,"comment_content":"老师您好，查询缓存这块，文中说到，会把SQL语句当做key,查询结果当做value缓存起来，下次查询时如果缓存中有，那么直接就返回。那如果像 select now(); 这个语句，如果按这个逻辑的话就会出现问题。但是实际每次返回的都是当前的时间，请问这个MySQL内部是怎么处理的？","like_count":0},{"had_liked":false,"id":222358,"user_name":"王加武","can_delete":false,"product_type":"c1","uid":1665471,"ip_address":"","ucode":"DDCFE578C6C428","user_header":"https://static001.geekbang.org/account/avatar/00/19/69/bf/50a824a4.jpg","comment_is_top":false,"comment_ctime":1590758612,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590758612","product_id":100020801,"comment_content":"这是在分析器阶段的“词法分析”时检查出来的，发现根本没有这个列，然后报错、程序结束!再也没有下面优化器和执行器的什么事了","like_count":0},{"had_liked":false,"id":222001,"user_name":"元夕","can_delete":false,"product_type":"c1","uid":2020314,"ip_address":"","ucode":"48599486C2BC5B","user_header":"https://static001.geekbang.org/account/avatar/00/1e/d3/da/60e6eafe.jpg","comment_is_top":false,"comment_ctime":1590654033,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590654033","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":220261,"user_name":"Pray、PF","can_delete":false,"product_type":"c1","uid":1706074,"ip_address":"","ucode":"1E3E4073763490","user_header":"https://static001.geekbang.org/account/avatar/00/1a/08/5a/4d709cf5.jpg","comment_is_top":false,"comment_ctime":1590217052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590217052","product_id":100020801,"comment_content":"是在分析阶段提出来的","like_count":0},{"had_liked":false,"id":220091,"user_name":"lcqbug","can_delete":false,"product_type":"c1","uid":1268609,"ip_address":"","ucode":"08FA17F21BCEC5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","comment_is_top":false,"comment_ctime":1590152760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590152760","product_id":100020801,"comment_content":"看老师的回答中有提到触发器，想知道触发器是做什么的？想知道触发器属于mysql逻辑架构图中的哪部分？","like_count":0},{"had_liked":false,"id":219805,"user_name":"未见","can_delete":false,"product_type":"c1","uid":1939320,"ip_address":"","ucode":"EC8F9B0E5F3D9A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/97/78/9229749e.jpg","comment_is_top":false,"comment_ctime":1590104318,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590104318","product_id":100020801,"comment_content":"看评论还能长知识，爱了爱了。","like_count":0},{"had_liked":false,"id":219447,"user_name":"HE明伟","can_delete":false,"product_type":"c1","uid":1211663,"ip_address":"","ucode":"DC302021D4250A","user_header":"https://static001.geekbang.org/account/avatar/00/12/7d/0f/26c38307.jpg","comment_is_top":false,"comment_ctime":1590026652,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590026652","product_id":100020801,"comment_content":"终归问题是，一条SQL查询语句时如何执行的？<br>连接器进行连接，分析器进行语法分析，优化器进行语句优化，选择哪种索引，执行器返回结果，存储引擎有点不太懂，存数据？","like_count":0},{"had_liked":false,"id":219004,"user_name":"Tomy","can_delete":false,"product_type":"c1","uid":1192601,"ip_address":"","ucode":"D7E49E90B0D60F","user_header":"https://static001.geekbang.org/account/avatar/00/12/32/99/91b58bf7.jpg","comment_is_top":false,"comment_ctime":1589932053,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589932053","product_id":100020801,"comment_content":"有视频没","like_count":0},{"had_liked":false,"id":216707,"user_name":"冯佳兴","can_delete":false,"product_type":"c1","uid":1717342,"ip_address":"","ucode":"41D308E99EF9FF","user_header":"https://static001.geekbang.org/account/avatar/00/1a/34/5e/089ac156.jpg","comment_is_top":false,"comment_ctime":1589330846,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589330846","product_id":100020801,"comment_content":"分析器中的词法分析报出来的","like_count":0},{"had_liked":false,"id":215518,"user_name":"爱因诗贤","can_delete":false,"product_type":"c1","uid":1528379,"ip_address":"","ucode":"150C439B87CED1","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/3b/7a2610a6.jpg","comment_is_top":false,"comment_ctime":1589009734,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589009734","product_id":100020801,"comment_content":"丁老师,请教一个问题,就是在查询的时候 我使用性别字段 sex去查询数据, 用条件 where sex = 0 = &#39;none&#39; 去查询的时候查到一条数据，然后用 where sex = 3 = &#39;sss&#39; 或者 where sex = 3 = &#39;kkk&#39; 就把所有的数据都查出来了，实际 sex 只有 0 和 1 ,请问这种要怎么理解呢, where 条件的词法和语法分析是怎么机制实现","like_count":0,"discussions":[{"author":{"id":1528379,"avatar":"https://static001.geekbang.org/account/avatar/00/17/52/3b/7a2610a6.jpg","nickname":"爱因诗贤","note":"","ucode":"150C439B87CED1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261935,"discussion_content":"还有如何避免这种坑的sql语句呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589026433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215214,"user_name":"yychzjl","can_delete":false,"product_type":"c1","uid":1237418,"ip_address":"","ucode":"A12836B3990AC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e1/aa/c270ca97.jpg","comment_is_top":false,"comment_ctime":1588930795,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588930795","product_id":100020801,"comment_content":"select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;<br><br>网上说是先执行join再执行where筛选，跟文章里说的不太一样。但是如果先join的话在虚拟表上是不是不能用索引了？","like_count":0},{"had_liked":false,"id":215169,"user_name":"BugBean","can_delete":false,"product_type":"c1","uid":1834181,"ip_address":"","ucode":"B51232281AD9BC","user_header":"https://static001.geekbang.org/account/avatar/00/1b/fc/c5/ff8b770e.jpg","comment_is_top":false,"comment_ctime":1588920009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588920009","product_id":100020801,"comment_content":"请问老师，对于有索引的表，这里取满足条件的第一行，和无索引的执行流程取这个表的第一行，这里为什么会有这样的区别呢？","like_count":0},{"had_liked":false,"id":214409,"user_name":"Mr.wang","can_delete":false,"product_type":"c1","uid":1224805,"ip_address":"","ucode":"86F341A5316BBC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/65/90387745.jpg","comment_is_top":false,"comment_ctime":1588742915,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1588742915","product_id":100020801,"comment_content":"我也认为是分析器的阶段就会提示没有这行。","like_count":0},{"had_liked":false,"id":212948,"user_name":"test","can_delete":false,"product_type":"c1","uid":1129610,"ip_address":"","ucode":"C57A175CBC6547","user_header":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","comment_is_top":false,"comment_ctime":1588244313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588244313","product_id":100020801,"comment_content":"既然有优化器是不是可以帮我们把优化工作都做了，即使写的很烂的语句也能优化呢？感觉应该能做到啊","like_count":0},{"had_liked":false,"id":212840,"user_name":"leon_LI","can_delete":false,"product_type":"c1","uid":1636029,"ip_address":"","ucode":"7881396BB38053","user_header":"https://static001.geekbang.org/account/avatar/00/18/f6/bd/f2c07661.jpg","comment_is_top":false,"comment_ctime":1588221057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588221057","product_id":100020801,"comment_content":"解: 我认为是，分析器。在分析阶段进行SQL语句分析，对语法及表进行校验。懵鞋打卡学习~","like_count":0},{"had_liked":false,"id":212207,"user_name":"墨客","can_delete":false,"product_type":"c1","uid":1877704,"ip_address":"","ucode":"9367A8B81E0D4F","user_header":"https://static001.geekbang.org/account/avatar/00/1c/a6/c8/07a45e89.jpg","comment_is_top":false,"comment_ctime":1588074431,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588074431","product_id":100020801,"comment_content":"不知道老师会不会回复我，不过我还是想提出这个疑惑，为什么分析器到查询缓存会有一个箭头，难道不应该是没有命中缓存的时候会有从查询缓存到分析器的箭头吗？我不太明白。","like_count":0},{"had_liked":false,"id":211817,"user_name":"风","can_delete":false,"product_type":"c1","uid":1077538,"ip_address":"","ucode":"104638BF19B048","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/22/b8c596b6.jpg","comment_is_top":false,"comment_ctime":1588027376,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588027376","product_id":100020801,"comment_content":"是在分析器阶段提示字段不存在的，分析器的作用就是验证有效性，字段有效性的校验也不例外，只有这样后面每一块才能专注自己的职能","like_count":0},{"had_liked":false,"id":211180,"user_name":"满","can_delete":false,"product_type":"c1","uid":1805905,"ip_address":"","ucode":"3AF4FEB838C167","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLAA74sVlibOh33upgyseXpkNianRSZJVK9pbM6pQzsjGUWLswYyhpXHrGcaCdeFhdx4YoUzztwlickTg/132","comment_is_top":false,"comment_ctime":1587910313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587910313","product_id":100020801,"comment_content":"分析器，分析器主要作用分析语法 词法，语法分析我是要做什么操作，词法就是去分析这个词是要干什么的或者说条件。","like_count":0},{"had_liked":false,"id":210144,"user_name":"Geek_KZ","can_delete":false,"product_type":"c1","uid":1957662,"ip_address":"","ucode":"021AF795DE1D6F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/gUoakOVnV9nnGPoSvGKGSkQavfImrXehJp9OtFOc7wtje5kAWRibibJfvKpiaWQ8iaxyjjqKzKxwHvDHXcFogtbRRA/132","comment_is_top":false,"comment_ctime":1587691782,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587691782","product_id":100020801,"comment_content":"分析器，因为分析器先做词法分析，由于表里没有k所以显示错误","like_count":0},{"had_liked":false,"id":207901,"user_name":"小屎丸","can_delete":false,"product_type":"c1","uid":1062525,"ip_address":"","ucode":"BD7A1CDF2C92F1","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/7d/0cfc0752.jpg","comment_is_top":false,"comment_ctime":1587211482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587211482","product_id":100020801,"comment_content":"yeah 答对了","like_count":0},{"had_liked":false,"id":207867,"user_name":"红颜铭心","can_delete":false,"product_type":"c1","uid":1889026,"ip_address":"","ucode":"18F94E5444C71A","user_header":"","comment_is_top":false,"comment_ctime":1587200662,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587200662","product_id":100020801,"comment_content":"老师，有个疑问：分析器的预处理器已经完成precheck，在执行器中是否还需要再次check。如果不需要，mysql是怎么标记权限校验已通过的？","like_count":0},{"had_liked":false,"id":204106,"user_name":"汐雨清尘","can_delete":false,"product_type":"c1","uid":1797370,"ip_address":"","ucode":"48D0E89283A883","user_header":"https://static001.geekbang.org/account/avatar/00/1b/6c/fa/369f6b6c.jpg","comment_is_top":false,"comment_ctime":1586333827,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586333827","product_id":100020801,"comment_content":"我觉得是在分析器，词法分析的阶段做出错误判断的。","like_count":0},{"had_liked":false,"id":203839,"user_name":"Poppy","can_delete":false,"product_type":"c1","uid":1501505,"ip_address":"","ucode":"AF656A00521037","user_header":"https://static001.geekbang.org/account/avatar/00/16/e9/41/7cb2cf64.jpg","comment_is_top":false,"comment_ctime":1586272402,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586272402","product_id":100020801,"comment_content":"打卡  好好看","like_count":0},{"had_liked":false,"id":203152,"user_name":"明翼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1586145394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586145394","product_id":100020801,"comment_content":"老师我8.0.3-rc-log 这个版本的情况下，更改了权限连刷新都不用自动具有权限了<br>```<br>mysql&gt; grant select on test.* to &#39;tlink&#39;@localhost;<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; grant delete on test.t_user to &#39;tlink&#39;@localhost;<br>Query OK, 0 rows affected (0.01 sec)<br><br>```<br>另一个客户端没有断开连接的情况下，却具有删除权限了：<br>```<br>mysql&gt; delete from t_user where user_name=&#39;apple&#39;;<br>ERROR 1142 (42000): DELETE command denied to user &#39;tlink&#39;@&#39;localhost&#39; for table &#39;t_user&#39;<br>mysql&gt; delete from t_user where user_name=&#39;apple&#39;;<br>Query OK, 1 row affected (0.01 sec)<br>```","like_count":0},{"had_liked":false,"id":201612,"user_name":"王瑶","can_delete":false,"product_type":"c1","uid":1876188,"ip_address":"","ucode":"7666467681C165","user_header":"","comment_is_top":false,"comment_ctime":1585812097,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585812097","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":200671,"user_name":"迷路的猴子","can_delete":false,"product_type":"c1","uid":1605016,"ip_address":"","ucode":"E64300CD4FB1D0","user_header":"https://static001.geekbang.org/account/avatar/00/18/7d/98/2d1932c9.jpg","comment_is_top":false,"comment_ctime":1585634375,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585634375","product_id":100020801,"comment_content":"应该是分析器，会在分析器这一步把sql语句分成对应的表名 列 。分析出之后应该就会去查询表中有没有这个列 然后提示错误吧","like_count":0},{"had_liked":false,"id":199636,"user_name":"余向华","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1585492974,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585492974","product_id":100020801,"comment_content":"再重新读多几遍","like_count":0},{"had_liked":false,"id":198606,"user_name":"以梦为马","can_delete":false,"product_type":"c1","uid":1907129,"ip_address":"","ucode":"529373FF61034B","user_header":"https://static001.geekbang.org/account/avatar/00/1d/19/b9/c3700576.jpg","comment_is_top":false,"comment_ctime":1585459394,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585459394","product_id":100020801,"comment_content":"坚持打卡","like_count":0},{"had_liked":false,"id":197954,"user_name":"August","can_delete":false,"product_type":"c1","uid":1538486,"ip_address":"","ucode":"72A0CB0C74CD35","user_header":"https://static001.geekbang.org/account/avatar/00/17/79/b6/98834766.jpg","comment_is_top":false,"comment_ctime":1585405108,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585405108","product_id":100020801,"comment_content":"会在分析器阶段的词法分析时候检查出来，这个时候会解析sql字符串中表名和列名，如果遇到非法的名称就会给出错误提示。","like_count":0},{"had_liked":false,"id":197489,"user_name":"刺客","can_delete":false,"product_type":"c1","uid":1098916,"ip_address":"","ucode":"607ABD2F2B5898","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/a4/b9b12d71.jpg","comment_is_top":false,"comment_ctime":1585381611,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585381611","product_id":100020801,"comment_content":"小结：<br>总得来说可以分为Server层和存储引擎层<br>Server层包含 连接器、查询缓存、分析器、优化器、执行器，常见的功能有存储过程、触发器、视图等<br><br>连接器<br>负责和客户端建立连接、鉴权、维持和管理连接<br>通过show processlist 可以查看连接，sleep代表空闲，如果等待时间过长会自动断开，默认是8小时，可以用配置 wait_timeout控制<br><br>Mysql异常重启<br>原因：mysql在执行过程中临时使用的内存是管理在连接对象里面的，这些资源在连接断开的时候才会释放，如果长连接积累下来，可能会导致占用过大，被系统强行杀掉（OOM）<br>解决：1、定时断开长连接  2、5.7以后版本可以使用mysql_reset_connection来重新初始化连接资源<br><br>查询缓存<br>之前执行的语句及其结果会以key-value对的形式直接缓存在内存中，key是查询语句，value是查询结果<br><br>是否使用查询缓存<br>不建议使用，因为查询缓存弊大于利<br>1、查询缓存的失效非常频繁，只要有涉及对表的更新，查询缓存都会被清空<br>2、更新压力大的表，查询缓存命中率非常低<br>3、8.0版本后该功能整体删除<br><br>分析器<br>此阶段会进行词法分析，进行做语法分析，是否满足mysql语法<br><br>优化器<br>存在多个索引的时候，决定使用哪个索引，或者在有多表关联时，决定各个表的连接顺序<br><br>执行器<br>真正开始执行语句","like_count":0},{"had_liked":false,"id":196526,"user_name":"FL","can_delete":false,"product_type":"c1","uid":1928368,"ip_address":"","ucode":"C82D077D6C2277","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLCKzC0IPq9HSaMiaySKyviaBftvz2EjgqKNCwia9C0xIfYnuE7qntQ6fQ9oL2sEyJGWu0Mmj7EbWicrg/132","comment_is_top":false,"comment_ctime":1585290182,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585290182","product_id":100020801,"comment_content":"来晚了 有点疑问希望老师看到能回复下<br>先总结下这篇吧。<br>mysql整体架构是server层和存储引擎层<br>server层主要负责对数据库功能上的一些操作<br>引擎层则负责对数据的存储读写的操作。<br>在经过server的连接器的连接管理 密码校验连接上mysql后，<br>首先会查询当前连接的用户拥有对当前数据库的操作权限，<br>此时的操作权限不会因为同时被调整而产生影响,直至此次连接结束。<br>然后就可以进行各种sql操作了<br>如果是select语句<br>首先会进行查询缓存,这里我有点疑问，不是说分析器会分析这是什么语句,对什么表的什么字段做了什么操作吗,那为何会先进行查询缓存,而不是先去进行分析器分析呢,因为我看是以key-value的形式,是不是他任何形式的sql语句都会去查询缓存,这里不是很理解。<br>然后经过分析器的字段分析 语法分析<br>在经过优化器的优化(如果是查询会在优化前做权限判断)<br>最后进行权限判断在进行执行器的执行语句,<br>执行器会调用InnoDB的读写接口进行操作,返回结果;<br>这里rows_examined是指在一个操作下扫描了多少行,<br>这个行数应该是等于这次执行器调用的分析器的次数*每次对应的扫描行数<br><br>","like_count":0},{"had_liked":false,"id":195393,"user_name":"jzhongchen","can_delete":false,"product_type":"c1","uid":1745949,"ip_address":"","ucode":"B78FD795DB752F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a4/1d/81e93f87.jpg","comment_is_top":false,"comment_ctime":1585185138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585185138","product_id":100020801,"comment_content":"以前只会简单的写写 crud，一直想深入了解一下 mysql。这个系列的文章很不错，有时间会多看几遍。","like_count":0},{"had_liked":false,"id":194518,"user_name":"白开水","can_delete":false,"product_type":"c1","uid":1725387,"ip_address":"","ucode":"0300AB319468D3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yb5R8iaxicD8tROw24eqlC8icMLSz4UeMnebgXASYV8lLahzpaeiapqZkM3oAw55zPBR84KeRQ0ILQHmv3pmibuicxGg/132","comment_is_top":false,"comment_ctime":1585064582,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585064582","product_id":100020801,"comment_content":"分析器:要做无法分析。","like_count":0},{"had_liked":false,"id":194382,"user_name":"金重石頁⁴².₁₉₅","can_delete":false,"product_type":"c1","uid":1648865,"ip_address":"","ucode":"38F3DD549A5676","user_header":"https://static001.geekbang.org/account/avatar/00/19/28/e1/93886c86.jpg","comment_is_top":false,"comment_ctime":1585056239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585056239","product_id":100020801,"comment_content":"后面的错误在K字段是在语法解析的阶段出现的，即分析器提供的判断","like_count":0},{"had_liked":false,"id":193859,"user_name":"万想","can_delete":false,"product_type":"c1","uid":1273102,"ip_address":"","ucode":"CDE4965D597D01","user_header":"https://static001.geekbang.org/account/avatar/00/13/6d/0e/c679b394.jpg","comment_is_top":false,"comment_ctime":1584974906,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584974906","product_id":100020801,"comment_content":"小结中的问题，应该是在词法分析的阶段分析出来k列不满足条件的。","like_count":0},{"had_liked":false,"id":193219,"user_name":"燃客","can_delete":false,"product_type":"c1","uid":1526870,"ip_address":"","ucode":"B4DA3FBCA2AFC5","user_header":"https://static001.geekbang.org/account/avatar/00/17/4c/56/3c189b4d.jpg","comment_is_top":false,"comment_ctime":1584886447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584886447","product_id":100020801,"comment_content":"我不是做开发的  只是想扩展自己的知识，希望学习完能在sql优化方面有进展","like_count":0},{"had_liked":false,"id":193211,"user_name":"燃客","can_delete":false,"product_type":"c1","uid":1526870,"ip_address":"","ucode":"B4DA3FBCA2AFC5","user_header":"https://static001.geekbang.org/account/avatar/00/17/4c/56/3c189b4d.jpg","comment_is_top":false,"comment_ctime":1584886385,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584886385","product_id":100020801,"comment_content":"一个不一样的mysql世界","like_count":0},{"had_liked":false,"id":191960,"user_name":"刘桢","can_delete":false,"product_type":"c1","uid":1482815,"ip_address":"","ucode":"3BFAB1C9772EB4","user_header":"https://static001.geekbang.org/account/avatar/00/16/a0/3f/06b690ba.jpg","comment_is_top":false,"comment_ctime":1584806038,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584806038","product_id":100020801,"comment_content":"打卡打卡","like_count":0},{"had_liked":false,"id":191911,"user_name":"大鹏展翅","can_delete":false,"product_type":"c1","uid":1308449,"ip_address":"","ucode":"244C4648E64E66","user_header":"https://static001.geekbang.org/account/avatar/00/13/f7/21/fbfc06c5.jpg","comment_is_top":false,"comment_ctime":1584803134,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584803134","product_id":100020801,"comment_content":"反复阅读，👍","like_count":0},{"had_liked":false,"id":191843,"user_name":"贾森安德森","can_delete":false,"product_type":"c1","uid":1071680,"ip_address":"","ucode":"7FF58646E0AD86","user_header":"https://static001.geekbang.org/account/avatar/00/10/5a/40/59de94de.jpg","comment_is_top":false,"comment_ctime":1584799771,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584799771","product_id":100020801,"comment_content":"我觉得这个是分析器返回的错误信息。看了好几遍了，工作中一直用到mysql，从来也没有思考过，sql语句是如何执行的。学习了这门课程，受益颇多，似乎有了方向。谢谢老师","like_count":0},{"had_liked":false,"id":191630,"user_name":"黄昏鹿场","can_delete":false,"product_type":"c1","uid":1269801,"ip_address":"","ucode":"BC331B34E878CE","user_header":"https://static001.geekbang.org/account/avatar/00/13/60/29/4564caba.jpg","comment_is_top":false,"comment_ctime":1584785553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584785553","product_id":100020801,"comment_content":"再来","like_count":0},{"had_liked":false,"id":190879,"user_name":"克里斯","can_delete":false,"product_type":"c1","uid":1181844,"ip_address":"","ucode":"00B755C10AC1C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/94/2c22bd4e.jpg","comment_is_top":false,"comment_ctime":1584704109,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1584704109","product_id":100020801,"comment_content":"mysql有redo log，redo log持久化的事务不会立即同步到数据库磁盘。 那么 sql查询数据库时，会查询redo log日志吗？如果只查询数据库，感觉不是最新的数据，查询不准确","like_count":0,"discussions":[{"author":{"id":1541518,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/8e/fb2c54a0.jpg","nickname":"Flandrelu` ´","note":"","ucode":"6705B950329C3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270543,"discussion_content":"不会查询redo log日志的，如果内存里面的脏页还没有刷新的话，直接查询内存里面的脏页，因为这里面的数据就是最新的，如果被刷回磁盘之后，查询的话会再从磁盘里面读取出来进行查询。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590023920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190470,"user_name":"熊猫宝宝","can_delete":false,"product_type":"c1","uid":1663921,"ip_address":"","ucode":"F082F925933C4E","user_header":"https://static001.geekbang.org/account/avatar/00/19/63/b1/6b9b9d8e.jpg","comment_is_top":false,"comment_ctime":1584663049,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1584663049","product_id":100020801,"comment_content":"老师您好，我想问一下mysql去掉了查询缓存，那它是用什么替代的呢？谢谢🙏","like_count":0,"discussions":[{"author":{"id":1119975,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIvfcicLgibga33TrT9pLYbPRD2ZsshEic49LxLS2aAu0grZCIdQU7xoHJiczqUZysbjsAdc3edR8m8Zg/132","nickname":"惊","note":"","ucode":"21668DE55C9AA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229146,"discussion_content":"不用代替吧，这个功能本来就缓存命中率很低，而且还需要频繁去刷新他，即使是静态表也作用甚微，去掉了鸡肋，反而更专注于其他核心功能。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586611959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190335,"user_name":"Sky","can_delete":false,"product_type":"c1","uid":1444700,"ip_address":"","ucode":"CD0DC002614741","user_header":"https://static001.geekbang.org/account/avatar/00/16/0b/5c/2e64c4c2.jpg","comment_is_top":false,"comment_ctime":1584630056,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584630056","product_id":100020801,"comment_content":"才开始看，优化器这个sql，多表关联的时候，难道不是根据表名的前后顺序有关的么","like_count":0},{"had_liked":false,"id":189694,"user_name":"Spring coming","can_delete":false,"product_type":"c1","uid":1116196,"ip_address":"","ucode":"9E01F2D987D08B","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/24/1d3bafaf.jpg","comment_is_top":false,"comment_ctime":1584541076,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584541076","product_id":100020801,"comment_content":"对于在分析器中判断是否有合法字段这个答案我有点疑问，如果开启了缓存，在查询缓存的时候不会判断字段的合法性吗","like_count":0,"discussions":[{"author":{"id":1048661,"avatar":"https://static001.geekbang.org/account/avatar/00/10/00/55/3f0bc345.jpg","nickname":"Ghost","note":"","ucode":"CC6FD1D460ED10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227542,"discussion_content":"查询缓存只会根据查询语句从缓存中找啊  （key，value） ，它肯定不在乎Key的细节是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586498811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189059,"user_name":"向永","can_delete":false,"product_type":"c1","uid":1912228,"ip_address":"","ucode":"8632022CB5B6D4","user_header":"","comment_is_top":false,"comment_ctime":1584451051,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584451051","product_id":100020801,"comment_content":"是分析器吧，首先判断语句是否正确","like_count":0},{"had_liked":false,"id":188601,"user_name":"运维老胡","can_delete":false,"product_type":"c1","uid":1227007,"ip_address":"","ucode":"DF398BEE296E11","user_header":"https://static001.geekbang.org/account/avatar/00/12/b8/ff/249da6da.jpg","comment_is_top":false,"comment_ctime":1584373584,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584373584","product_id":100020801,"comment_content":"查询不存在的字段应该是在语法分析的时候抛出异常","like_count":0},{"had_liked":false,"id":188477,"user_name":"若罹","can_delete":false,"product_type":"c1","uid":1514257,"ip_address":"","ucode":"E2209CC33F714A","user_header":"https://static001.geekbang.org/account/avatar/00/17/1b/11/9d7bcbf7.jpg","comment_is_top":false,"comment_ctime":1584358759,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1584358759","product_id":100020801,"comment_content":"老师，为什么权限检验要放在执行器，而不是更早的分析器？","like_count":0},{"had_liked":false,"id":187074,"user_name":"Jazz--李*华","can_delete":false,"product_type":"c1","uid":1143801,"ip_address":"","ucode":"622F7C7D206655","user_header":"https://static001.geekbang.org/account/avatar/00/11/73/f9/23e61ff4.jpg","comment_is_top":false,"comment_ctime":1584006960,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584006960","product_id":100020801,"comment_content":"我认为是分析器，因为分析器的作用是词法分析，语法分析。而题目一开始就说k是不存在的，所以在分析器阶段就会报错。","like_count":0},{"had_liked":false,"id":187052,"user_name":"交叉路口","can_delete":false,"product_type":"c1","uid":1125680,"ip_address":"","ucode":"D1A636F0F4E147","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/30/b840bd9e.jpg","comment_is_top":false,"comment_ctime":1584001228,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584001228","product_id":100020801,"comment_content":"“ 执行器将上述遍历过程中所有满足条件的行组成的记录集作为结果集返回给客户端”这句话是我想问一下是怎么发送给客户端的？是不是每满足一条就往网卡发送？所以不管查询的数据集多大也不会占用很多 MySQL 实例的内存？","like_count":0},{"had_liked":false,"id":186888,"user_name":"匙亮旭","can_delete":false,"product_type":"c1","uid":1687145,"ip_address":"","ucode":"09A8C132BDFADA","user_header":"https://static001.geekbang.org/account/avatar/00/19/be/69/c2ecf377.jpg","comment_is_top":false,"comment_ctime":1583945049,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583945049","product_id":100020801,"comment_content":"老是，你用的是什么画图工具画的那些流程图","like_count":0},{"had_liked":false,"id":185679,"user_name":"面试怪圈","can_delete":false,"product_type":"c1","uid":1789588,"ip_address":"","ucode":"C9C4B9B2F699C6","user_header":"https://static001.geekbang.org/account/avatar/00/1b/4e/94/af3eb6d4.jpg","comment_is_top":false,"comment_ctime":1583661609,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583661609","product_id":100020801,"comment_content":"老师问一下,<br>1.如果需要回表的话,是普通索引返回的结果回到server端,server端再去查主键索引,还是引擎层回表?<br>2.server端和引擎层是两个进程还是一个进程,只是逻辑划分?","like_count":0},{"had_liked":false,"id":184522,"user_name":"贾森安德森","can_delete":false,"product_type":"c1","uid":1071680,"ip_address":"","ucode":"7FF58646E0AD86","user_header":"https://static001.geekbang.org/account/avatar/00/10/5a/40/59de94de.jpg","comment_is_top":false,"comment_ctime":1583333140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583333140","product_id":100020801,"comment_content":"打卡第一天<br>看完文章之后对sql的执行过程有了了解。之前完全不知道<br>答案：分析器。<br>看完文章之后，看了很长时间评论。感觉评论也是必看的<br>","like_count":0},{"had_liked":false,"id":183048,"user_name":"kkk","can_delete":false,"product_type":"c1","uid":1351755,"ip_address":"","ucode":"33C6170F5E0CD5","user_header":"https://static001.geekbang.org/account/avatar/00/14/a0/4b/b818d731.jpg","comment_is_top":false,"comment_ctime":1582942174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582942174","product_id":100020801,"comment_content":"优化器阶段要选择索引，如果不打开表的话，怎么知道用哪个索引？","like_count":0},{"had_liked":false,"id":182506,"user_name":"韩俊臣","can_delete":false,"product_type":"c1","uid":1475340,"ip_address":"","ucode":"D6A15C025570D5","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/0c/b9e39db4.jpg","comment_is_top":false,"comment_ctime":1582798401,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582798401","product_id":100020801,"comment_content":"请问一下，他到分析器那里具体是怎么分析的呢？是识别select from where这些关键字，然后判断select后面对应的字段名，from后面对应的表名和where后面对应的是判断是么，还有就是他是把列名表名先缓存一份然后用查询语句的字段作比较还是边比较时候边拿表名列名之类的呢","like_count":0},{"had_liked":false,"id":180687,"user_name":"Charlie","can_delete":false,"product_type":"c1","uid":1802709,"ip_address":"","ucode":"4FB7057CEF7697","user_header":"https://static001.geekbang.org/account/avatar/00/1b/81/d5/00efc5b7.jpg","comment_is_top":false,"comment_ctime":1582364646,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582364646","product_id":100020801,"comment_content":"请问各位同学和老师，mysql-reset-connection如何使用？实在配置表里，还是命令行执行？","like_count":0},{"had_liked":false,"id":180382,"user_name":"数星星的大人","can_delete":false,"product_type":"c1","uid":1115928,"ip_address":"","ucode":"C91A9C36A7222A","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/18/ba710f66.jpg","comment_is_top":false,"comment_ctime":1582272083,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582272083","product_id":100020801,"comment_content":"老师你好，<br>“这些资源会在连接断开的时候才释放。所以如果长连接累积下来，可能导致内存占用太大，被系统强行杀掉（OOM），从现象看就是 MySQL 异常重启了。”这句话不太理解，按照这个逻辑的话，长连接的内存岂不是一直累加的，只要长连接不断，内存总有会爆的时刻，是这样吗？","like_count":0},{"had_liked":false,"id":178864,"user_name":"T","can_delete":false,"product_type":"c1","uid":1668015,"ip_address":"","ucode":"4CC56C9EC26B8E","user_header":"https://static001.geekbang.org/account/avatar/00/19/73/af/a0c708ec.jpg","comment_is_top":false,"comment_ctime":1581842140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581842140","product_id":100020801,"comment_content":"在分析器阶段，语法分析报错的","like_count":0},{"had_liked":false,"id":178122,"user_name":"余二","can_delete":false,"product_type":"c1","uid":1359796,"ip_address":"","ucode":"22481137FCBDBC","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/b4/0827ce7d.jpg","comment_is_top":false,"comment_ctime":1581591447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581591447","product_id":100020801,"comment_content":"Day1 MySQL实战第一讲<br>MySQL可以分为Server层和存储引擎两部分。<br>server包括连接器、分析器、优化器、执行器等。涵盖MySQL的大多数核心服务功能以及所有的内置函数（日期、时间、数学和加密函数等），所有款存储引擎的功能（存储过程、触发器、视图等）<br>存储引擎负责数据的存储和提取，支持InnoDB、MyISAMySQL、Memory等。<br>客户端发出一条SQL查询语句的执行过程：<br>（server层）<br>1.连接器--管理链接，权限验证，维持和管理连接<br>2.分析器--词法分析、语法分析<br>3.优化器--执行计划生成、索引选择<br>4.执行器--操作引擎，返回结果。","like_count":0},{"had_liked":false,"id":178005,"user_name":"车底之神杜成义","can_delete":false,"product_type":"c1","uid":1812666,"ip_address":"","ucode":"BEFA103F906C59","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a8/ba/d2aff70a.jpg","comment_is_top":false,"comment_ctime":1581567783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581567783","product_id":100020801,"comment_content":"“查询也会在优化器之前调用 precheck 验证权限”请问相比于执行前的权限验证，这个precheck大概是做什么用的？","like_count":0},{"had_liked":false,"id":178002,"user_name":"车底之神杜成义","can_delete":false,"product_type":"c1","uid":1812666,"ip_address":"","ucode":"BEFA103F906C59","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a8/ba/d2aff70a.jpg","comment_is_top":false,"comment_ctime":1581567668,"is_pvip":false,"replies":[{"id":"69154","content":"确实有主观成分，衡量标准就是“一次连接持续期间，执行了多少个sql语句”","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1581652013,"ip_address":"","comment_id":178002,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1581567668","product_id":100020801,"comment_content":"“数据库里面，长连接是指连接成功后，如果客户端持续有请求，则一直使用同一个连接。短连接则是指每次执行完很少的几次查询就断开连接，下次查询再重新建立一个。”想问下长连接和短连接是不是人为的主观上来判断的，还是通过某些量化标准来定义的？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483631,"discussion_content":"确实有主观成分，衡量标准就是“一次连接持续期间，执行了多少个sql语句”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581652013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176083,"user_name":"微末凡尘","can_delete":false,"product_type":"c1","uid":1099525,"ip_address":"","ucode":"25EDFD0914D0F4","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/05/19c5c255.jpg","comment_is_top":false,"comment_ctime":1580953361,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1580953361","product_id":100020801,"comment_content":"两阶段提交，redo log和binlog，恢复数据的时候是两个都用到了呢，还是只用到了binlog呢","like_count":0,"discussions":[{"author":{"id":1541518,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/8e/fb2c54a0.jpg","nickname":"Flandrelu` ´","note":"","ucode":"6705B950329C3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":270545,"discussion_content":"都用到了，回复数据的时候先看redo里面的状态，commit状态的话事务直接提交，prepare状态的话会去看binlog里面是否有对应事务的二进制日志，如果binlog里面有就提交，如果没有则回滚该事务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590024077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176072,"user_name":"微末凡尘","can_delete":false,"product_type":"c1","uid":1099525,"ip_address":"","ucode":"25EDFD0914D0F4","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/05/19c5c255.jpg","comment_is_top":false,"comment_ctime":1580949621,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580949621","product_id":100020801,"comment_content":"1、mysql主要组成部分，连接器，分析器，优化器，执行器，存储引擎。<br>2、连接器，验证账号密码，维持链接，超时自动断开，链接过程复杂，建议使用长链接，连接比较占用内存，需要定时断开，5.7之后可以使用mysql_reset_connection。<br>3、分析器，验证语法的合规性，把sql转换成mysql内部识别的语句，表明转换成对应的id。<br>4、判断sql内部的执行顺序。<br>5、执行器，验证操作库表是否有权限，调存储引擎接口查询数据。<br>6、慢查询日志rows_examined，记录查询的时候扫描了多少行，相同表有肯能次数不同","like_count":0},{"had_liked":false,"id":175540,"user_name":"天天向上","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1580741008,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1580741008","product_id":100020801,"comment_content":"我们应用中配置的mysql的连接池的连接数是不是指的就是这里的长连接啊。","like_count":0,"discussions":[{"author":{"id":2020865,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/d6/01/eaa50203.jpg","nickname":"zft","note":"","ucode":"74DEC5FBA610B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278439,"discussion_content":"感觉是，连接的复用，不用每次都进行复杂的连接操作","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591186672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175325,"user_name":"Rick","can_delete":false,"product_type":"c1","uid":1245956,"ip_address":"","ucode":"E088D8AA9E985F","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/04/44692930.jpg","comment_is_top":false,"comment_ctime":1580655173,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580655173","product_id":100020801,"comment_content":"老师，那意思在分析器分析出表名后，在这一步也需要做权限检查？那检查的范围与执行器执行时的权限检查的范围有些什么差别呢？","like_count":0},{"had_liked":false,"id":175042,"user_name":"卢培涛","can_delete":false,"product_type":"c1","uid":1809528,"ip_address":"","ucode":"491A47B5F9E24D","user_header":"https://static001.geekbang.org/account/avatar/00/1b/9c/78/2ca983e7.jpg","comment_is_top":false,"comment_ctime":1580536052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580536052","product_id":100020801,"comment_content":"我是刚开始学习，好多词汇都不懂","like_count":0},{"had_liked":false,"id":174796,"user_name":"御风","can_delete":false,"product_type":"c1","uid":1812807,"ip_address":"","ucode":"51C8212BE06364","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/47/ded5da90.jpg","comment_is_top":false,"comment_ctime":1580390779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580390779","product_id":100020801,"comment_content":"了解了mysql 内部的构成，以及一条语句执行过程中，各部分的职责划分。<br>mysql 服务端对于缓存、权限的设计也同企业应用的服务端类似。","like_count":0},{"had_liked":false,"id":174608,"user_name":"TAKI","can_delete":false,"product_type":"c1","uid":1484717,"ip_address":"","ucode":"813010F9C9CE33","user_header":"https://static001.geekbang.org/account/avatar/00/16/a7/ad/c28e317f.jpg","comment_is_top":false,"comment_ctime":1580293830,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1580293830","product_id":100020801,"comment_content":"老师，您好。我想请教一下，MySQL架构示意图中分析器指向查询缓存这一步，具体执行了什么操作？","like_count":0,"discussions":[{"author":{"id":1071680,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5a/40/59de94de.jpg","nickname":"贾森安德森","note":"","ucode":"7FF58646E0AD86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":196190,"discussion_content":"我觉得是，查询以当前sql语句为可以，是否存在value值。如果能查到就直接返回数据了，否则就在执行这个sql.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583332821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":174250,"user_name":"陈竹敏","can_delete":false,"product_type":"c1","uid":1349205,"ip_address":"","ucode":"B3DDFAF1BBD69A","user_header":"https://static001.geekbang.org/account/avatar/00/14/96/55/1d4df2c0.jpg","comment_is_top":false,"comment_ctime":1580108696,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1580108696","product_id":100020801,"comment_content":"查询缓存不是；语法没错，分析器不是；执行器是执行接口和索引，执行器不是，就剩下优化器了。","like_count":0},{"had_liked":false,"id":174032,"user_name":"Eilie","can_delete":false,"product_type":"c1","uid":1245145,"ip_address":"","ucode":"6BAC7E694EDFA6","user_header":"https://static001.geekbang.org/account/avatar/00/12/ff/d9/bc7b114a.jpg","comment_is_top":false,"comment_ctime":1579912102,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579912102","product_id":100020801,"comment_content":"感觉数据库的处理在某个方面跟其他编程语言一样，经过解析器看输入是否有问题之后再执行操作","like_count":0},{"had_liked":false,"id":173854,"user_name":"律飛","can_delete":false,"product_type":"c1","uid":1462608,"ip_address":"","ucode":"65394E437AD2DF","user_header":"https://static001.geekbang.org/account/avatar/00/16/51/50/f5f2a121.jpg","comment_is_top":false,"comment_ctime":1579740328,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579740328","product_id":100020801,"comment_content":"分析层。Mysql分析层负责弄清楚你要做什么，这时就能发现你要做的事不在我的能力范围之内，当然就要拒绝你的要求了，何必还要往下进行呢？","like_count":0},{"had_liked":false,"id":173833,"user_name":"crane","can_delete":false,"product_type":"c1","uid":1114102,"ip_address":"","ucode":"6821A9CF7B8C41","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/f6/a6708f8d.jpg","comment_is_top":false,"comment_ctime":1579716423,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579716423","product_id":100020801,"comment_content":"1.连接消耗的临时内存，到底是个什么概念，是线程池内存吗？为什么不自动释放？<br>2.检查权限延迟到执行器阶段，这个成本太高了吧？","like_count":0},{"had_liked":false,"id":173814,"user_name":"TAKI","can_delete":false,"product_type":"c1","uid":1484717,"ip_address":"","ucode":"813010F9C9CE33","user_header":"https://static001.geekbang.org/account/avatar/00/16/a7/ad/c28e317f.jpg","comment_is_top":false,"comment_ctime":1579704229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579704229","product_id":100020801,"comment_content":"您好，我想问一下，文章中提到的 MySQL在执行过程中临时使用的内存 和 执行过的语句及其结果可能以 key-value对的形式，被直接缓存在内存中。其中的“内存”是指服务器或电脑中的内存吗？","like_count":0},{"had_liked":false,"id":173789,"user_name":"九五年的海带🌞","can_delete":false,"product_type":"c1","uid":1809661,"ip_address":"","ucode":"66FA62589254CD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/9c/fd/2dc118db.jpg","comment_is_top":false,"comment_ctime":1579688948,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579688948","product_id":100020801,"comment_content":"我认为是分析器，重拾mysql，对mysql的一些基本概念更熟悉了","like_count":0},{"had_liked":false,"id":173751,"user_name":"William","can_delete":false,"product_type":"c1","uid":1346215,"ip_address":"","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1579678981,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1579678981","product_id":100020801,"comment_content":"应该是分析器中的“词法分析”过程中,提示的错误吧. <br><br>词法分析: 映射过程中发现这个列木有...  不知道对不对.","like_count":0},{"had_liked":false,"id":173675,"user_name":"自在如风","can_delete":false,"product_type":"c1","uid":1400258,"ip_address":"","ucode":"1ADBD45F0BDC55","user_header":"https://static001.geekbang.org/account/avatar/00/15/5d/c2/277b6cfb.jpg","comment_is_top":false,"comment_ctime":1579657639,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1579657639","product_id":100020801,"comment_content":"思考题判断列是够存在时分析器任务，老师文章介绍了<br>分析器的作用是词法分析和语法分析<br>词法分析包括：<br>       根据关键字判断是哪种CRUD的语句<br>       语句中的表、列需要映射到具体的表和列，就是要判断查询的表、列是否存在<br>语法分析就是判断SQL语句是够符合Mysql语法","like_count":0},{"had_liked":false,"id":173612,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1579616181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579616181","product_id":100020801,"comment_content":"分析器。 优化器做优化 执行器执行sql语句。连接器是负责连接的，排除下来是分析器。分析词法和语法是否正确","like_count":0},{"had_liked":false,"id":173577,"user_name":"ipofss","can_delete":false,"product_type":"c1","uid":1018620,"ip_address":"","ucode":"DE3061C9259F9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","comment_is_top":false,"comment_ctime":1579599687,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579599687","product_id":100020801,"comment_content":"老师在分析器里说道：“如果你的语句不对，就会收到“You have an error in your SQL syntax”的错误提醒”，所以应该是分析器","like_count":0},{"had_liked":false,"id":173553,"user_name":"mgs2002","can_delete":false,"product_type":"c1","uid":1812970,"ip_address":"","ucode":"F5931108BD509B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","comment_is_top":false,"comment_ctime":1579594675,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579594675","product_id":100020801,"comment_content":"我觉得应该出现在分析器里面的词法分析吧，因为语法分析只是分析SQL是否符合MySQL的书写结构","like_count":0},{"had_liked":false,"id":173482,"user_name":"一个顶三","can_delete":false,"product_type":"c1","uid":1745179,"ip_address":"","ucode":"165596847783D9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/j0gBKF8EKfRMTnBOqXR3xcqquJdzYUibXOIb32HejppBPo644p6JB3Et08Su4TUaDRWt8DzPxYtm8iabEJN2uJKw/132","comment_is_top":false,"comment_ctime":1579572230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579572230","product_id":100020801,"comment_content":"二刷打卡  再建一张表t ！","like_count":0},{"had_liked":false,"id":173475,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1579571409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579571409","product_id":100020801,"comment_content":"刚刚的提问，发现文中已经解答了的，没有看完就提问，实在抱歉=_=","like_count":0},{"had_liked":false,"id":173471,"user_name":"xiong","can_delete":false,"product_type":"c1","uid":1099375,"ip_address":"","ucode":"C1BFD9EF96372F","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/6f/ac3003fa.jpg","comment_is_top":false,"comment_ctime":1579571089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579571089","product_id":100020801,"comment_content":"老师你好，我想问下，连接器后为什么是直接就走缓存查询呢？ 不需要先经过分析器分析这句sql吗？<br>比如说 select * from user where id = 1 and gender = &#39;man&#39; 和 select * from user where gender = &#39;man&#39; and id = 1; 这两个sql 应该是一样的， 如果是连接器之后就走缓存查询的话，那怎么判断这两句sql 是一样的呢？ 还是说有相应的字符串排序与比较的过程？","like_count":0},{"had_liked":false,"id":173465,"user_name":"yangmin","can_delete":false,"product_type":"c1","uid":1227341,"ip_address":"","ucode":"494A9D62C8C509","user_header":"https://static001.geekbang.org/account/avatar/00/12/ba/4d/73b29014.jpg","comment_is_top":false,"comment_ctime":1579568822,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579568822","product_id":100020801,"comment_content":"对于课后的问题，个人觉得是在分析器，之所以这么认为，是由正文的：“MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID””，当然这样说目前感觉还是有些空洞，这个“识别”的具体含义是，是需要结合表结构还是直译？如果老师方便，请老师详细说明一下什么叫识别？谢谢！","like_count":0},{"had_liked":false,"id":173463,"user_name":"彭欢欢","can_delete":false,"product_type":"c1","uid":1384005,"ip_address":"","ucode":"92AC240498412E","user_header":"https://static001.geekbang.org/account/avatar/00/15/1e/45/19231e56.jpg","comment_is_top":false,"comment_ctime":1579567824,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579567824","product_id":100020801,"comment_content":"应该是在分析器层面<br>1.分析器层面需要将语句的各个部分解读一遍，当表和列名解释有问题时就会直接报错；<br>2.优化器的主要功能在优化效率，只有当语句没有任何问题，优化器才能工作，语句没有问题是优化器工作的充分必要条件；<br>综述，我的答案是在分析器这一步就报错","like_count":0},{"had_liked":false,"id":173436,"user_name":"庄风","can_delete":false,"product_type":"c1","uid":1267661,"ip_address":"","ucode":"21FC66BA9E7EBB","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/cd/9235341a.jpg","comment_is_top":false,"comment_ctime":1579535500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579535500","product_id":100020801,"comment_content":"请问老师，上面的“mysql_reset_connection”我感觉比较有问，请问如何在Hibernate或者MySQL中调用他。","like_count":0},{"had_liked":false,"id":173398,"user_name":"Belief","can_delete":false,"product_type":"c1","uid":1436695,"ip_address":"","ucode":"DAB95EC1B28A6C","user_header":"https://static001.geekbang.org/account/avatar/00/15/ec/17/c522ccf9.jpg","comment_is_top":false,"comment_ctime":1579523696,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1579523696","product_id":100020801,"comment_content":"本来有些疑惑，看评论全知道了","like_count":0},{"had_liked":false,"id":173394,"user_name":"威特","can_delete":false,"product_type":"c1","uid":1627041,"ip_address":"","ucode":"A04D08D3859792","user_header":"https://static001.geekbang.org/account/avatar/00/18/d3/a1/e5a3ce79.jpg","comment_is_top":false,"comment_ctime":1579522757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579522757","product_id":100020801,"comment_content":"对于没有数据库基础的我来说，听完这节课真是受益匪浅。了解到数据库的组成和一条sql语句的整个执行过程。需要经过连接器，词法分析器，语法分析器，优化器，最后由执行器调用执行引擎执行。<br>思考题，如果没有列k，那么这应该是在语法分析阶段，因为词法分析器只是对输入的单词进行梳理，不关心逻辑问题。","like_count":0},{"had_liked":false,"id":173392,"user_name":"陈大头","can_delete":false,"product_type":"c1","uid":1335400,"ip_address":"","ucode":"F1CA8837BF1E5C","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/68/626cb455.jpg","comment_is_top":false,"comment_ctime":1579521162,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579521162","product_id":100020801,"comment_content":"分析器，词法分析的时候，就没找到","like_count":0},{"had_liked":false,"id":173389,"user_name":"珞珈山","can_delete":false,"product_type":"c1","uid":1441354,"ip_address":"","ucode":"D8CA5C61243712","user_header":"https://static001.geekbang.org/account/avatar/00/15/fe/4a/b2d6ed39.jpg","comment_is_top":false,"comment_ctime":1579519641,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579519641","product_id":100020801,"comment_content":"加油，开始深入学习之旅","like_count":0},{"had_liked":false,"id":173387,"user_name":"chao","can_delete":false,"product_type":"c1","uid":1304921,"ip_address":"","ucode":"0416B3B9D7E634","user_header":"https://static001.geekbang.org/account/avatar/00/13/e9/59/f1d6464f.jpg","comment_is_top":false,"comment_ctime":1579519272,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579519272","product_id":100020801,"comment_content":"再看一次","like_count":0},{"had_liked":false,"id":173377,"user_name":"张明博","can_delete":false,"product_type":"c1","uid":1387993,"ip_address":"","ucode":"4ACF04BECBD7CE","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/d9/360e0abf.jpg","comment_is_top":false,"comment_ctime":1579514976,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579514976","product_id":100020801,"comment_content":"技能get:连接器优化，设置mysql-reset-connection<br>               查询缓存优化，设置query-cache-type","like_count":0},{"had_liked":false,"id":173345,"user_name":"与狼共舞","can_delete":false,"product_type":"c1","uid":1391144,"ip_address":"","ucode":"02AC04B43F0194","user_header":"https://static001.geekbang.org/account/avatar/00/15/3a/28/cf707831.jpg","comment_is_top":false,"comment_ctime":1579508462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579508462","product_id":100020801,"comment_content":"连接器是先经过分析器查询是否有缓存，还是直接查询缓存到分析器？","like_count":0},{"had_liked":false,"id":173322,"user_name":"songhyunmin","can_delete":false,"product_type":"c1","uid":1317847,"ip_address":"","ucode":"D5A98668CD8532","user_header":"https://static001.geekbang.org/account/avatar/00/14/1b/d7/868d26ce.jpg","comment_is_top":false,"comment_ctime":1579504380,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579504380","product_id":100020801,"comment_content":"在Server层中的分析器阶段检查出来。","like_count":0},{"had_liked":false,"id":173304,"user_name":"一只特立独行的猪","can_delete":false,"product_type":"c1","uid":1811622,"ip_address":"","ucode":"B0B30A7487A444","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a4/a6/042994a3.jpg","comment_is_top":false,"comment_ctime":1579500098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579500098","product_id":100020801,"comment_content":"应该是分析器","like_count":0},{"had_liked":false,"id":173302,"user_name":"yooh","can_delete":false,"product_type":"c1","uid":1246419,"ip_address":"","ucode":"7CE1AC224F4BF9","user_header":"https://static001.geekbang.org/account/avatar/00/13/04/d3/cca450d5.jpg","comment_is_top":false,"comment_ctime":1579499779,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579499779","product_id":100020801,"comment_content":"有些不明白的是为什么要在多个阶段多次对权限进行验证，权限信息在一次链接建立之后不是不会变化吗多次验证的意义是什么？","like_count":0},{"had_liked":false,"id":173276,"user_name":"Tan","can_delete":false,"product_type":"c1","uid":1134688,"ip_address":"","ucode":"D261A69A889696","user_header":"https://static001.geekbang.org/account/avatar/00/11/50/60/7c954c92.jpg","comment_is_top":false,"comment_ctime":1579492153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579492153","product_id":100020801,"comment_content":"老师您好，那个MySQL 的逻辑架构图是不是有点问题，查询缓存和分析器的箭头是不是画反了？","like_count":0},{"had_liked":false,"id":173135,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1579432884,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1579432884","product_id":100020801,"comment_content":"mysql_rest_connection会重新回到刚创建状态，请问刚创建状态和原状态有什么不同？","like_count":0},{"had_liked":false,"id":173085,"user_name":"生活是这样子","can_delete":false,"product_type":"c1","uid":1811719,"ip_address":"","ucode":"36F31F799E95F0","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a5/07/65c3aa60.jpg","comment_is_top":false,"comment_ctime":1579422241,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579422241","product_id":100020801,"comment_content":"不理解为什么在优化器之前做权限。","like_count":0},{"had_liked":false,"id":172709,"user_name":"朝阳","can_delete":false,"product_type":"c1","uid":1518038,"ip_address":"","ucode":"F114F0E9E6E35A","user_header":"https://static001.geekbang.org/account/avatar/00/17/29/d6/6a3213a4.jpg","comment_is_top":false,"comment_ctime":1579257803,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579257803","product_id":100020801,"comment_content":"select 这个单词写错不应该是词法分析应该检查到的吗？为什么是语法分析","like_count":0},{"had_liked":false,"id":172667,"user_name":"😂","can_delete":false,"product_type":"c1","uid":1501009,"ip_address":"","ucode":"092F0E87BF4F59","user_header":"https://static001.geekbang.org/account/avatar/00/16/e7/51/714dc264.jpg","comment_is_top":false,"comment_ctime":1579248604,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579248604","product_id":100020801,"comment_content":"虽然学的晚，但我也要留言，是分析器，词法分析阶段，识别不到列K","like_count":0},{"had_liked":false,"id":172650,"user_name":"而立斋","can_delete":false,"product_type":"c1","uid":1087258,"ip_address":"","ucode":"5FED6E9E148195","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/1a/389eab84.jpg","comment_is_top":false,"comment_ctime":1579244548,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579244548","product_id":100020801,"comment_content":"在老师开始的图中，连接器具有权限验证的功能，后面在讲到执行器时也提到权限验证，查询缓存以及precheck的权限验证。是不是可以这么理解，在连接器权限验证的内容是：验证当前用户是否可以连接数据库，后面的其他权限验证的内容是：验证当前用户对要操作的表是否具有权限。","like_count":0},{"had_liked":false,"id":172284,"user_name":"immortaliii","can_delete":false,"product_type":"c1","uid":1309441,"ip_address":"","ucode":"ACF57BD721E1B8","user_header":"https://static001.geekbang.org/account/avatar/00/13/fb/01/313be8c8.jpg","comment_is_top":false,"comment_ctime":1579144403,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579144403","product_id":100020801,"comment_content":"课后题：<br>如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？<br>应该是在分析器阶段。","like_count":0},{"had_liked":false,"id":172117,"user_name":"BigSpinach","can_delete":false,"product_type":"c1","uid":1320917,"ip_address":"","ucode":"81B3D9AD100B2B","user_header":"https://static001.geekbang.org/account/avatar/00/14/27/d5/fa654422.jpg","comment_is_top":false,"comment_ctime":1579092606,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579092606","product_id":100020801,"comment_content":"假如说两个执行语句是一样的,A先执行，B后执行，B语句比A语句中间多了一个空格，按照key-value缓存的概念，这样也不会命中缓存的是吧？","like_count":0},{"had_liked":false,"id":172101,"user_name":"EiKi","can_delete":false,"product_type":"c1","uid":1795470,"ip_address":"","ucode":"3E2B29C368204F","user_header":"https://static001.geekbang.org/account/avatar/00/1b/65/8e/4cf8de06.jpg","comment_is_top":false,"comment_ctime":1579089542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579089542","product_id":100020801,"comment_content":"判断有没有对sql语句中的表有没有查询权限，不应该在执行器阶段，感觉是分析器时更合理一点","like_count":0},{"had_liked":false,"id":169816,"user_name":"向往的生活","can_delete":false,"product_type":"c1","uid":1397298,"ip_address":"","ucode":"0E8DB45357820F","user_header":"https://static001.geekbang.org/account/avatar/00/15/52/32/bb570f48.jpg","comment_is_top":false,"comment_ctime":1578451154,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1578451154","product_id":100020801,"comment_content":"阅读下来有两个小疑问，总结一下<br>1、关于查询缓存的解释，文中提到可以在查询过程中指定是否需要开启缓存，这里的意思是如果开启缓存就会将本次查询的查询语句和结果缓存下来，还是说每次都会将查询语句和结果缓存起来，只不过开启缓存之后就会去缓存中匹配呢？<br>2、关于权限验证的介绍，文中提到多次都会验证权限，比如说语句到达优化器之前会验证权限，既然如此，何必在执行器阶段，再次权限验证呢？<br>希望老师或者同学们帮忙解答一下，谢谢。","like_count":0},{"had_liked":false,"id":169695,"user_name":"Jaden~お張嘉楽","can_delete":false,"product_type":"c1","uid":1803215,"ip_address":"","ucode":"FA2737D6A1D2C9","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/cf/1f3b5b17.jpg","comment_is_top":false,"comment_ctime":1578407654,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578407654","product_id":100020801,"comment_content":"分析器，检查语法的","like_count":0},{"had_liked":false,"id":169632,"user_name":"熊猫宝宝","can_delete":false,"product_type":"c1","uid":1663921,"ip_address":"","ucode":"F082F925933C4E","user_header":"https://static001.geekbang.org/account/avatar/00/19/63/b1/6b9b9d8e.jpg","comment_is_top":false,"comment_ctime":1578393181,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1578393181","product_id":100020801,"comment_content":"老师您好，请问8.0之后，MySQL 查询缓存 是用什么给替代了","like_count":0},{"had_liked":false,"id":169313,"user_name":"定格温暖","can_delete":false,"product_type":"c1","uid":1315395,"ip_address":"","ucode":"FD9DF5BBA905AD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bpyzQkT2iaFgP2xNWnJic6X67fwVJgic5Qwm6FrSEteCh3icEbA3fydPxCOB2aCrFtFhXCoH6k46g8GfleROwib3mTw/132","comment_is_top":false,"comment_ctime":1578312931,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578312931","product_id":100020801,"comment_content":"mysql 执行查询的时候， 一般情况下执行器调用一次，在引擎内部扫描一行吗？这样会不会很浪费啊，麻烦老师解析一下。","like_count":0},{"had_liked":false,"id":169210,"user_name":"羁绊12221","can_delete":false,"product_type":"c1","uid":1463686,"ip_address":"","ucode":"15B47C5053388A","user_header":"https://static001.geekbang.org/account/avatar/00/16/55/86/ca7c94ce.jpg","comment_is_top":false,"comment_ctime":1578293516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578293516","product_id":100020801,"comment_content":"1. MySQL 分为 server 和存储引擎层<br>2. server 层：连接器(管理连接，权限验证)  -- 分析器(词法、语法分析) -- 优化器(执行计划生成、索引选择)  -- 执行器(操作引擎，返回结果)<br>                                          -- 查询缓存(命中则直接返回结果)<br>3. 存储引擎层：插件式，MySQL 5.5.5 版本后，默认 Innodb<br>4. 用户通过客户端跟连接器建立连接，验证用户名密码后，连接器会到权限表里查出用户拥有的权限，之后这个连接里的所有权限判断逻辑将依赖此时读到的权限。<br>   即便后来修改了用户权限，也只有新连接才会生效。<br>5. 查看连接 show processlist,连接空闲达到 wait_timeout(默认8h)后，连接器断开与客户端的连接，客户端再次发送请求会报错。<br>6. 尽量使用长连接。<br>7. MySQL 执行过程中临时使用的内存是管理在连接对象中的，连接断开才会释放，过多长连接会导致 MySQL 进程 OOM。<br>\t---程序判断执行过占用大内存的查询后，断开长连接。<br>\t---5.7 及以后版本，可以通过 mysql_reset_connecttion 初始化连接资源。（不需要重连和重做权限验证）<br>8. 查询缓存以 key&#47;value 的形式存放执行过的 sql 和查询结果，表上的任意更新都会导致表上的所有查询缓存清空。<br>   query_cache_type=DEMAND，默认不查询缓存，可以显示指定从缓存查询 <br>   mysql&gt; select SQL_CACHE * from T where ID=10；<br>   mysql8.0 之后不支持查询缓存。<br>9. “列不存在”，是分析器报出来的错误。","like_count":0},{"had_liked":false,"id":167942,"user_name":"邢宇超","can_delete":false,"product_type":"c1","uid":1105246,"ip_address":"","ucode":"3113F55E60ADE9","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/5e/ddbdde5a.jpg","comment_is_top":false,"comment_ctime":1577967110,"is_pvip":false,"replies":[{"id":"65214","content":"就是说在线程断开的时候，内存肯定就会回收，不跟别的线程混用。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1577971250,"ip_address":"","comment_id":167942,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577967110","product_id":100020801,"comment_content":"MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。  这句话啥意思老师","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480060,"discussion_content":"就是说在线程断开的时候，内存肯定就会回收，不跟别的线程混用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577971250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167253,"user_name":"西风胡杨","can_delete":false,"product_type":"c1","uid":1488212,"ip_address":"","ucode":"7A35856E27F27B","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/54/3f78e3c8.jpg","comment_is_top":false,"comment_ctime":1577752387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577752387","product_id":100020801,"comment_content":"sql执行步骤:<br>1.连接器<br>2.分析器<br>3.优化器<br>4.执行器<br>","like_count":0},{"had_liked":false,"id":167191,"user_name":"小明","can_delete":false,"product_type":"c1","uid":1625618,"ip_address":"","ucode":"5A0357E9849226","user_header":"https://static001.geekbang.org/account/avatar/00/18/ce/12/1488e361.jpg","comment_is_top":false,"comment_ctime":1577712491,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577712491","product_id":100020801,"comment_content":"分析层","like_count":0},{"had_liked":false,"id":166297,"user_name":"从远方过来","can_delete":false,"product_type":"c1","uid":1797551,"ip_address":"","ucode":"4791DBC7E05B1D","user_header":"","comment_is_top":false,"comment_ctime":1577434230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577434230","product_id":100020801,"comment_content":"老师，为什么不把词法分析放到客户端那里做呢？像select单词拼错这种，为什么要放到Server端呢？","like_count":0},{"had_liked":false,"id":165987,"user_name":"沉淀","can_delete":false,"product_type":"c1","uid":1790036,"ip_address":"","ucode":"BC460D5AC78A6B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/50/54/558506ee.jpg","comment_is_top":false,"comment_ctime":1577359037,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577359037","product_id":100020801,"comment_content":"第一节：答案是语法分析阶段吧","like_count":0},{"had_liked":false,"id":164809,"user_name":"最后的水笔仔","can_delete":false,"product_type":"c1","uid":1777851,"ip_address":"","ucode":"52D3E25912AEEA","user_header":"https://static001.geekbang.org/account/avatar/00/1b/20/bb/761e2fb4.jpg","comment_is_top":false,"comment_ctime":1577094182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577094182","product_id":100020801,"comment_content":"之前执行过的语句及其结果可能会以 key-value 对的形式，被直接缓存在内存中.  &#47;&#47; 有个疑问 如果数据有变化这个value 结果不就没意义了么,实际是怎么解决的呢","like_count":0},{"had_liked":false,"id":164806,"user_name":"BUGCREATOR","can_delete":false,"product_type":"c1","uid":1332945,"ip_address":"","ucode":"E4BDCB685ACB0F","user_header":"https://static001.geekbang.org/account/avatar/00/14/56/d1/4b5496c0.jpg","comment_is_top":false,"comment_ctime":1577093801,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577093801","product_id":100020801,"comment_content":"最后一个问题，我的理解是在分析器中报这个错误，再具体一点是在词法分析阶段，这个阶段要分析出你的sql语句中的哪些字符串是列名，哪些是表名，哪些是mysql关键字，哪些是常量，不知道这样理解对不对","like_count":0},{"had_liked":false,"id":164690,"user_name":"握不住手中沙","can_delete":false,"product_type":"c1","uid":1097132,"ip_address":"","ucode":"F194E47C4D42C9","user_header":"https://static001.geekbang.org/account/avatar/00/10/bd/ac/49494ed8.jpg","comment_is_top":false,"comment_ctime":1577072544,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577072544","product_id":100020801,"comment_content":"在“分析器”阶段进行“词法分析”时提出的错误","like_count":0},{"had_liked":false,"id":164181,"user_name":"fusion","can_delete":false,"product_type":"c1","uid":1388534,"ip_address":"","ucode":"83D68543435122","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoMGQgj0b7PWkqB2dL2hejUrvkQA5NNHw4EibMu23XhLnHVR9vrK9jicG5EfG9BzHVyW4dY5czuc9iaw/132","comment_is_top":false,"comment_ctime":1576902699,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576902699","product_id":100020801,"comment_content":"“在有些场景下，执行器调用一次，在引擎内部则扫描了多行，因此引擎扫描行数跟 rows_examined 并不是完全相同的。”，这个该怎么理解？","like_count":0},{"had_liked":false,"id":164179,"user_name":"fusion","can_delete":false,"product_type":"c1","uid":1388534,"ip_address":"","ucode":"83D68543435122","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoMGQgj0b7PWkqB2dL2hejUrvkQA5NNHw4EibMu23XhLnHVR9vrK9jicG5EfG9BzHVyW4dY5czuc9iaw/132","comment_is_top":false,"comment_ctime":1576901857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576901857","product_id":100020801,"comment_content":"&quot;如果你用的是 MySQL 5.7 或更新版本，可以在每次执行一个比较大的操作后，通过执行 mysql_reset_connection 来重新初始化连接资源。&quot;<br>请问，java中mysql驱动包有提供对应的方法吗？是什么？","like_count":0},{"had_liked":false,"id":163972,"user_name":"dingsai88","can_delete":false,"product_type":"c1","uid":1029484,"ip_address":"","ucode":"A725428A983ADC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/6c/617c0193.jpg","comment_is_top":false,"comment_ctime":1576836496,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1576836496","product_id":100020801,"comment_content":"老师麻烦问下  binlog在哪里","like_count":0,"discussions":[{"author":{"id":2020865,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/d6/01/eaa50203.jpg","nickname":"zft","note":"","ucode":"74DEC5FBA610B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278442,"discussion_content":"在MySQL的data目录下，我的5.7的版本如下：\n-rw-r-----. 1 mysql mysql 27908432 5月  31 22:30 mysql-bin.000001\n-rw-r-----. 1 mysql mysql      177 5月  31 22:30 mysql-bin.000002\n-rw-r-----. 1 mysql mysql  2691099 6月   3 10:16 mysql-bin.000003\n-rw-r-----. 1 mysql mysql     2258 6月   3 15:21 mysql-bin.000004","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591186885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163439,"user_name":"李大巴掌","can_delete":false,"product_type":"c1","uid":1400190,"ip_address":"","ucode":"86A7C30BAC67F4","user_header":"https://static001.geekbang.org/account/avatar/00/15/5d/7e/0eddcae0.jpg","comment_is_top":false,"comment_ctime":1576721853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576721853","product_id":100020801,"comment_content":"    如果是我设计肯定放在语法分析的环节. ","like_count":0},{"had_liked":false,"id":162667,"user_name":"RD","can_delete":false,"product_type":"c1","uid":1194858,"ip_address":"","ucode":"E3947B6E1681AD","user_header":"https://static001.geekbang.org/account/avatar/00/12/3b/6a/80d9c545.jpg","comment_is_top":false,"comment_ctime":1576575551,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576575551","product_id":100020801,"comment_content":"mysql_reset_connection 这个怎么用啊，网上没找到答案，求各位指教。。。","like_count":0},{"had_liked":false,"id":159675,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1274787,"ip_address":"","ucode":"C233DF1D224EC1","user_header":"https://static001.geekbang.org/account/avatar/00/13/73/a3/2b077607.jpg","comment_is_top":false,"comment_ctime":1575726066,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1575726066","product_id":100020801,"comment_content":"老师，根据主键查询出的数据量大的话，Java中可能会内存溢出，除了分页查询外，还有什么好的方法呢？","like_count":0},{"had_liked":false,"id":159151,"user_name":"奋斗的小白鼠","can_delete":false,"product_type":"c1","uid":1743483,"ip_address":"","ucode":"752BB901FFB7CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/icHicAP9M4M4DIjAvlj5FDdFxIeA0pR3J15QdvVjXQXbznwunDN8OvrYqnsFchtBTNrZCCfGTE2RpPzIxjkvFAKg/132","comment_is_top":false,"comment_ctime":1575548456,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575548456","product_id":100020801,"comment_content":"老师，select是取一条读一条放到内存里还是全部读取出来一次性放到内存里啊","like_count":0},{"had_liked":false,"id":158256,"user_name":"工藤新一","can_delete":false,"product_type":"c1","uid":1754668,"ip_address":"","ucode":"F2AFB6F6A42FAA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLeXjFHy8wGyrDnm6ib7hjZNjocUHarn0XFc8zLc061Ax99bFmrLN9yAxicklpcjKFx2gHqUKWQ3MRw/132","comment_is_top":false,"comment_ctime":1575358370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575358370","product_id":100020801,"comment_content":"THX~第一节看完","like_count":0},{"had_liked":false,"id":158161,"user_name":"朕爱吾妃","can_delete":false,"product_type":"c1","uid":1733692,"ip_address":"","ucode":"B10EB69934F9E2","user_header":"https://static001.geekbang.org/account/avatar/00/1a/74/3c/da79d2a1.jpg","comment_is_top":false,"comment_ctime":1575340706,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575340706","product_id":100020801,"comment_content":"我认为是分析器，因为   MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”，也就是这时候，他会对表名和列名进行校验","like_count":0},{"had_liked":false,"id":157281,"user_name":"黑豪","can_delete":false,"product_type":"c1","uid":1091639,"ip_address":"","ucode":"87C00E7BE05BF8","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/37/fa2afd0d.jpg","comment_is_top":false,"comment_ctime":1575102443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575102443","product_id":100020801,"comment_content":"来的有点晚，个人感觉是分析器。<br><br>分析器做的工作除了词法分析、语法分析外，应该还有个语义分析。<br>对于要执行的SQL语句select * from T where k=1：<br>词法分析会将&quot;select&quot;这个关键字识别出来，表明这是一个查询语句；<br>与此同时把字符串“T”识别成“表名 T”，把字符串“k”识别成“列 k”，但是这一步只能说是表明身份，不能说这个身份真实存在。<br>语法分析只是根据语法规则判断语法是否正确；<br>关键就是语义分析所做的工作，我觉得MySQL会在这一步去真实验证列k是否真正存在意义，不存在列则报错。<br>","like_count":0},{"had_liked":false,"id":156730,"user_name":"Zereker","can_delete":false,"product_type":"c1","uid":1477877,"ip_address":"","ucode":"B9F9B5E2B214D1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/KcRx9GFeor67LcPjBOKCWv9ooHb46JfJqNbff94AUorXrYCS3vTYicZLWlamtSUESv3qOdKMtxoqQo8BNEvAyAA/132","comment_is_top":false,"comment_ctime":1574943135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574943135","product_id":100020801,"comment_content":"老师您好:<br>    在长连接那一层, 为什么使用长连接会使 &quot;占用内存涨得特别快&quot;, 是因为 每次客户端的查询 结果集, 虚拟表等, 这些内存占用 全部归属于 每个连接? 并且 在查询结束返回客户端数据以后, 仍然没有释放导致的吗? ","like_count":0},{"had_liked":false,"id":156377,"user_name":"瑞瑞余之","can_delete":false,"product_type":"c1","uid":1071060,"ip_address":"","ucode":"E15184E2F97F3A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/tDZWoLOnb7NA15lqBTCJDxCgaHR8M9I872D4pv9XkcGpYxLrebD0JEibPAVjrgRT4bqaowUY3NfLp25APZGDcPQ/132","comment_is_top":false,"comment_ctime":1574863724,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574863724","product_id":100020801,"comment_content":"老师在连接器和执行器当中，mysql都会判断权限，能不能具体解释一下，这两个地方判断内容的区别呢？","like_count":0},{"had_liked":false,"id":155652,"user_name":"好运连连","can_delete":false,"product_type":"c1","uid":1105081,"ip_address":"","ucode":"2A339281321E2A","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/b9/946b181d.jpg","comment_is_top":false,"comment_ctime":1574732879,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574732879","product_id":100020801,"comment_content":"文中提及，执行一次查询，会多次校验权限吗？","like_count":0},{"had_liked":false,"id":154928,"user_name":"syhasia","can_delete":false,"product_type":"c1","uid":1009858,"ip_address":"","ucode":"BD5F4CBBA0C021","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/c2/2280961f.jpg","comment_is_top":false,"comment_ctime":1574598909,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574598909","product_id":100020801,"comment_content":"老师，问个问题：使用阿里云的RDS（MySQL），刚开始不支持表情符emoji，后来需要支持，该如何操作呢？我看网上好多说修改my.cnf，而且需要重启MySQL，RDS咋重启呢？我试着把表改成utf-8mb4，但是不起作用🤨","like_count":0},{"had_liked":false,"id":154626,"user_name":"duang_duang","can_delete":false,"product_type":"c1","uid":1392130,"ip_address":"","ucode":"77AE4ADD4BF3F3","user_header":"https://static001.geekbang.org/account/avatar/00/15/3e/02/45e25bab.jpg","comment_is_top":false,"comment_ctime":1574495951,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574495951","product_id":100020801,"comment_content":"直接命中缓存后返回数据，此时没有表的权限校验吗？如果没有校验？那缓存是按照连接划分的吗？那缓存对于同一个用户新的连接是无效的吗？ 如果是根据用户划分？那用户权限被管理员改了也会有问题的呀？<br>麻烦老师答疑，感谢。","like_count":0},{"had_liked":false,"id":154622,"user_name":"duang_duang","can_delete":false,"product_type":"c1","uid":1392130,"ip_address":"","ucode":"77AE4ADD4BF3F3","user_header":"https://static001.geekbang.org/account/avatar/00/15/3e/02/45e25bab.jpg","comment_is_top":false,"comment_ctime":1574495646,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574495646","product_id":100020801,"comment_content":"按照流程，为什么分析器之后又走向查询缓存了呢？<br>我本来也是这么认为的，我想的可能是查询语句where后面条件一样，仅仅是顺序有区别的时候这样走完语法分析后再查询缓存。但是我仔细想了一下：<br>key-value，中value的结果不用说，key如果是查询的 原本的查询语句，那走分析器之后再回来查缓存就没意义；如果key是 语法分析后的语句，那是不是每次都是语法分析后再查缓存更合理？或者每次查询后在缓存中生成两个key-value对？<br>麻烦老师答疑，感谢。","like_count":0},{"had_liked":false,"id":154107,"user_name":"duang_duang","can_delete":false,"product_type":"c1","uid":1392130,"ip_address":"","ucode":"77AE4ADD4BF3F3","user_header":"https://static001.geekbang.org/account/avatar/00/15/3e/02/45e25bab.jpg","comment_is_top":false,"comment_ctime":1574382105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574382105","product_id":100020801,"comment_content":"疑问：哪些校验是在分析器之后优化器之前校验的？哪些是到执行器才校验的？分析器之后已经校验的内容在执行器阶段是否还会再校验一遍呢？","like_count":0},{"had_liked":false,"id":153238,"user_name":"于^  小北","can_delete":false,"product_type":"c1","uid":1214474,"ip_address":"","ucode":"64BE16887179CD","user_header":"https://static001.geekbang.org/account/avatar/00/12/88/0a/e6c6e65e.jpg","comment_is_top":false,"comment_ctime":1574207141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574207141","product_id":100020801,"comment_content":"老师你好，有个问题请教下，比如您这条错误sql:  elect * from t where ID=1，分析器在执行词法解析的时候，会把elect识别为什么？这个单词的错误等到语法解析的时候才识别出来？","like_count":0},{"had_liked":false,"id":149543,"user_name":"陌臣","can_delete":false,"product_type":"c1","uid":1643898,"ip_address":"","ucode":"EC1B2DA7483F11","user_header":"https://static001.geekbang.org/account/avatar/00/19/15/7a/db9879e1.jpg","comment_is_top":false,"comment_ctime":1573269776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573269776","product_id":100020801,"comment_content":"学完以后，感觉内容通俗易懂，逻辑清晰，评论区学到很多，相信接下来还会学到很多，谢谢老师😁","like_count":0},{"had_liked":false,"id":149333,"user_name":"Kerwin_南","can_delete":false,"product_type":"c1","uid":1285546,"ip_address":"","ucode":"248B1C5F7670CF","user_header":"https://static001.geekbang.org/account/avatar/00/13/9d/aa/12d1fb93.jpg","comment_is_top":false,"comment_ctime":1573195608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573195608","product_id":100020801,"comment_content":"定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连。<br>-----------------------------------------------------------------------<br>请问php如何断开与mysql的长连接呢？","like_count":0},{"had_liked":false,"id":149069,"user_name":"长期规划","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1573135759,"is_pvip":false,"replies":[{"id":"57919","content":"后面有哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1573564597,"ip_address":"","comment_id":149069,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573135759","product_id":100020801,"comment_content":"老师，Server层的查询缓存和InnoDB中的buffer pooI有什么区别吗","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473729,"discussion_content":"后面有哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573564597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149063,"user_name":"长期规划","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1573133918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573133918","product_id":100020801,"comment_content":"老师，优化器中选择索引，使用哪个索引应该由存储引擎决定吧，是Server层给存储引擎提供统一接口，由引擎层实现，然后Server调用这个接口吗？","like_count":0},{"had_liked":false,"id":148056,"user_name":"熊猫宝宝","can_delete":false,"product_type":"c1","uid":1663921,"ip_address":"","ucode":"F082F925933C4E","user_header":"https://static001.geekbang.org/account/avatar/00/19/63/b1/6b9b9d8e.jpg","comment_is_top":false,"comment_ctime":1572933694,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1572933694","product_id":100020801,"comment_content":"select * from test.test1;<br>比如这条sql，查询第一次是0.002s<br>再次查询就是0.000s<br>mysql8 不是砍掉缓存模块了吗？请问这个查询为什么变成0.000s了呢？<br>还有我如何查看时间是少在哪里了呢？","like_count":0},{"had_liked":false,"id":147706,"user_name":"Pluto","can_delete":false,"product_type":"c1","uid":1664180,"ip_address":"","ucode":"F6ADD2464D2800","user_header":"https://static001.geekbang.org/account/avatar/00/19/64/b4/c9862add.jpg","comment_is_top":false,"comment_ctime":1572880148,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572880148","product_id":100020801,"comment_content":"有一个小问题，求解答，就是raws_examined字段表示语句在执行中扫描了多少行，执行器调用一次，引擎内部可能扫描多行，所以引擎扫描行数和raws_examined并不完全相同。这个意思是说raws_examined代表执行器执行的次数吗？这一快有些不明白。","like_count":0},{"had_liked":false,"id":146858,"user_name":"云师兄","can_delete":false,"product_type":"c1","uid":1205777,"ip_address":"","ucode":"EB19F80070FE23","user_header":"https://static001.geekbang.org/account/avatar/00/12/66/11/f7408e3e.jpg","comment_is_top":false,"comment_ctime":1572678945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572678945","product_id":100020801,"comment_content":"这种模块划分思路（server，存储引擎），流水线执行方式（server内逐步流转执行），封装变化的抽象能力(插件方式支持不同存储引擎)是最大的学习价值","like_count":0},{"had_liked":false,"id":146334,"user_name":"敲代码的老王","can_delete":false,"product_type":"c1","uid":1042444,"ip_address":"","ucode":"B641FB945F0C04","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e8/0c/870d2de4.jpg","comment_is_top":false,"comment_ctime":1572501750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572501750","product_id":100020801,"comment_content":"优化器阶段就需要去看表结构了，所以是优化器阶段","like_count":0},{"had_liked":false,"id":146090,"user_name":"有人@我","can_delete":false,"product_type":"c1","uid":1721824,"ip_address":"","ucode":"0D4227BA4B878B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/45/e0/904ae497.jpg","comment_is_top":false,"comment_ctime":1572430286,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572430286","product_id":100020801,"comment_content":"是分析器的阶段爆出来的，词法分析的时候，判断k字段有没有，没有则报错","like_count":0},{"had_liked":false,"id":143665,"user_name":"LIAMCEES","can_delete":false,"product_type":"c1","uid":1439358,"ip_address":"","ucode":"0CDFA63E1A3885","user_header":"https://static001.geekbang.org/account/avatar/00/15/f6/7e/f707cea7.jpg","comment_is_top":false,"comment_ctime":1571753739,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571753739","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":142793,"user_name":"欢乐的小马驹","can_delete":false,"product_type":"c1","uid":1078951,"ip_address":"","ucode":"B594106688CEE7","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/a7/374e86a7.jpg","comment_is_top":false,"comment_ctime":1571536479,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571536479","product_id":100020801,"comment_content":"老师，我还没买课，只是试听。我疑惑的是，为什么最后问一个文章中没有提到的问题？我认为好的问题应该是文中已经讲出来了，但是并没有直接讲出，需要思考才能得出来答案。现在您问一个完全没有提到，只能凭借经验去得出答案。我对MYSQL不了解，反复看了几遍文章。都无法从文章中得出一个结论：分析器做了这些事情。","like_count":0},{"had_liked":false,"id":142453,"user_name":"『芡妳☆dě緈諨』","can_delete":false,"product_type":"c1","uid":1216527,"ip_address":"","ucode":"1105FB19A03D65","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/0f/a805caf3.jpg","comment_is_top":false,"comment_ctime":1571370535,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571370535","product_id":100020801,"comment_content":"问题提问：<br>多表连表分组排序查询的时候（多个表百万数量级别），在排序查询当中存在多个表字段的的排序，这时候会Using temporary产生临时表，原因是因为order by子句的字段是其他表的而并非连查的第一个表；如果将order by优先排序的字段对应的表作为第一个表，同样会造成其他表的排序查询产生临时表而影响查询性能。这个时候有什么好的解决方案？<br><br>例如：A，B，C表连表查，order by B.field1，B.field2，A.field1，A.field2，这时候会产生A表的临时表(Using temporary)；反过来B，A，C连表查，order by 顺序一样，这时候会产生B表的临时表，同样Using temporary","like_count":0},{"had_liked":false,"id":142149,"user_name":"匙亮旭","can_delete":false,"product_type":"c1","uid":1687145,"ip_address":"","ucode":"09A8C132BDFADA","user_header":"https://static001.geekbang.org/account/avatar/00/19/be/69/c2ecf377.jpg","comment_is_top":false,"comment_ctime":1571300483,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571300483","product_id":100020801,"comment_content":"图是拿什么软件画的？感觉好漂亮。","like_count":0},{"had_liked":false,"id":141935,"user_name":"峻铭","can_delete":false,"product_type":"c1","uid":1106202,"ip_address":"","ucode":"63AB23BADACA88","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/1a/20977779.jpg","comment_is_top":false,"comment_ctime":1571271973,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571271973","product_id":100020801,"comment_content":"不明白为什么表的连接顺序会影响查询效率，我觉得两个表都会循环遍历的啊，不管连接的顺序如何，都是遍历次数的乘积，实在不解，还请老师解惑","like_count":0},{"had_liked":false,"id":141807,"user_name":"shirphy","can_delete":false,"product_type":"c1","uid":1372909,"ip_address":"","ucode":"EC2156398A8245","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJmQicAjiaD4icQVlqOJWxtZwL22Ey3Du0wpxcxVpkbzkNsRMUVicNw6wygduXAGiahy26SpKLSCgL6NqQ/132","comment_is_top":false,"comment_ctime":1571229344,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571229344","product_id":100020801,"comment_content":"长连接，短链接是怎么确定的？有什么规则？比如运行命令 mysql -u -h -p，这个会创建长还是短链接？","like_count":0},{"had_liked":false,"id":141747,"user_name":"岁寒","can_delete":false,"product_type":"c1","uid":1066921,"ip_address":"","ucode":"D062733384F4BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/a9/3ace68b6.jpg","comment_is_top":false,"comment_ctime":1571217343,"is_pvip":false,"replies":[{"id":"55146","content":"这种有标准答案的本身不是好问题，<br>不过是一个好的起手问题，根据候选人的答案再追问，<br>同时考验候选人和面试官😆","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1571475056,"ip_address":"","comment_id":141747,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571217343","product_id":100020801,"comment_content":"我觉得面试mysql 第一个问题就应该是mysql的执行流程是什么样子～","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470870,"discussion_content":"这种有标准答案的本身不是好问题，\n不过是一个好的起手问题，根据候选人的答案再追问，\n同时考验候选人和面试官😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571475056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141488,"user_name":"峻铭","can_delete":false,"product_type":"c1","uid":1106202,"ip_address":"","ucode":"63AB23BADACA88","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/1a/20977779.jpg","comment_is_top":false,"comment_ctime":1571184117,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571184117","product_id":100020801,"comment_content":"要是我毕业的时候能遇到你这样的职业导师就好了，能力不及你没关系啊，哪怕指导下也好啊，全靠自己摸索","like_count":0},{"had_liked":false,"id":141353,"user_name":"困到清醒","can_delete":false,"product_type":"c1","uid":1384381,"ip_address":"","ucode":"1CD20C408C0BC9","user_header":"https://static001.geekbang.org/account/avatar/00/15/1f/bd/04100cb4.jpg","comment_is_top":false,"comment_ctime":1571144185,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1571144185","product_id":100020801,"comment_content":"是分析器的词法分析阶段，因为找不到k这个词，所以报错了","like_count":0},{"had_liked":false,"id":140249,"user_name":"沐","can_delete":false,"product_type":"c1","uid":1326537,"ip_address":"","ucode":"678F6A0C778CDD","user_header":"https://static001.geekbang.org/account/avatar/00/14/3d/c9/a1e6a307.jpg","comment_is_top":false,"comment_ctime":1570862962,"is_pvip":false,"discussion_count":0,"race_medal":3,"score":"1570862962","product_id":100020801,"comment_content":"MySQL可以分为Server层和存储引擎层两部分：<br>Server层包括连接器、查询缓存、分析器、优化器和执行器。<br>存储引擎层负责数据的存储和提取。不同的存储引擎共用一个Server层。","like_count":0},{"had_liked":false,"id":140235,"user_name":"H","can_delete":false,"product_type":"c1","uid":1691295,"ip_address":"","ucode":"6AA167F861876D","user_header":"https://static001.geekbang.org/account/avatar/00/19/ce/9f/c45652b2.jpg","comment_is_top":false,"comment_ctime":1570859200,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570859200","product_id":100020801,"comment_content":"分析器，检查语法","like_count":0},{"had_liked":false,"id":139070,"user_name":"肥low","can_delete":false,"product_type":"c1","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1570540145,"is_pvip":false,"replies":[{"id":"53977","content":"😆加了个油~","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1570725497,"ip_address":"","comment_id":139070,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570540145","product_id":100020801,"comment_content":"刚出来就买了 但是一直没看 立个flag 这一次一定要看完 看懂😀","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469776,"discussion_content":"😆加了个油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570725497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138664,"user_name":"🎈  Sugar","can_delete":false,"product_type":"c1","uid":1072526,"ip_address":"","ucode":"4F70221F5CF797","user_header":"https://static001.geekbang.org/account/avatar/00/10/5d/8e/21dc7fd0.jpg","comment_is_top":false,"comment_ctime":1570414444,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570414444","product_id":100020801,"comment_content":"分析器  词法分析  不存在field ","like_count":0},{"had_liked":false,"id":138582,"user_name":"HelloTalk","can_delete":false,"product_type":"c1","uid":1618633,"ip_address":"","ucode":"F898E6A7C61D39","user_header":"https://static001.geekbang.org/account/avatar/00/18/b2/c9/b414a77c.jpg","comment_is_top":false,"comment_ctime":1570349219,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570349219","product_id":100020801,"comment_content":"原文：它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。","like_count":0},{"had_liked":false,"id":138388,"user_name":"happiness","can_delete":false,"product_type":"c1","uid":1026587,"ip_address":"","ucode":"C5F25D57C7A1DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/aa/1b/b43c8519.jpg","comment_is_top":false,"comment_ctime":1570193495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570193495","product_id":100020801,"comment_content":"分析器，答案在正文介绍分析器那一段中","like_count":0},{"had_liked":false,"id":138158,"user_name":"Geek_b3a962","can_delete":false,"product_type":"c1","uid":1681844,"ip_address":"","ucode":"AC51C9390D32FB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ZccFBM9wqKWZAicq7rN3tJGaibD9y0d6THJ1lknOGpdCQUjgU85W2XvibxTcaXHPhnRdjPstTamVVJFo2WRibRNB6A/132","comment_is_top":false,"comment_ctime":1570069776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570069776","product_id":100020801,"comment_content":"有个疑问，连接器连接获取用户权限读取用户权限表的时候不需要通过引擎的吗？","like_count":0},{"had_liked":false,"id":137225,"user_name":"wong ka seng","can_delete":false,"product_type":"c1","uid":1338885,"ip_address":"","ucode":"C1A713082D0D64","user_header":"https://static001.geekbang.org/account/avatar/00/14/6e/05/d47cee18.jpg","comment_is_top":false,"comment_ctime":1569659567,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569659567","product_id":100020801,"comment_content":"请问关于连接层：假如我有一个application server, 逻辑上使用一个user name和password 连接到mysql server, 但该application server有很多不同的用户探访查询，要求各自的资料，那么对mysql server而言是否有很多连接？","like_count":0},{"had_liked":false,"id":136959,"user_name":"莲哥","can_delete":false,"product_type":"c1","uid":1498519,"ip_address":"","ucode":"188E9A4BD23ABD","user_header":"https://static001.geekbang.org/account/avatar/00/16/dd/97/6f0092af.jpg","comment_is_top":false,"comment_ctime":1569566857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569566857","product_id":100020801,"comment_content":"老师你好 有个问题请教一下 文章说先执行词法分析在执行语法分析 但是我把 `select ` 关键字写成`elect` 查询表中的一个不存在字段 结果提示是语法错误。个人感觉是先语法分析再词法分析。 有点迷糊请老师解答下。","like_count":0},{"had_liked":false,"id":135694,"user_name":"浮世间","can_delete":false,"product_type":"c1","uid":1579931,"ip_address":"","ucode":"90230230D2618D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/xXfbHEUK56zFLSQqhSnNj8BicYiardWZbmM3G2zWdvChH4NWEJSIXuAJpZ92FhQxLTslQgxRAWD4NnftNxLyMO2w/132","comment_is_top":false,"comment_ctime":1569242218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569242218","product_id":100020801,"comment_content":"这个错误是在分析器阶段报错的，老师已经给出明确定义表T中没有字段k。而执行语句的几个阶段只有分析器是对语法分析我们究竟要什么，查询什么字段，而优化器执行器都是在分析器之后(字段都没有，更不用谈优化和执行了)。","like_count":0},{"had_liked":false,"id":135532,"user_name":"孙志强","can_delete":false,"product_type":"c1","uid":1325997,"ip_address":"","ucode":"9C070F1E4EC6FF","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/ad/31193b83.jpg","comment_is_top":false,"comment_ctime":1569205533,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1569205533","product_id":100020801,"comment_content":"在分析器要选择索引，选择索引需要判断列是否有索引，这个过程的前置条件就是列存在","like_count":0},{"had_liked":false,"id":134951,"user_name":"Cola_","can_delete":false,"product_type":"c1","uid":1264718,"ip_address":"","ucode":"99996D04CA4171","user_header":"https://static001.geekbang.org/account/avatar/00/13/4c/4e/91267714.jpg","comment_is_top":false,"comment_ctime":1568961144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568961144","product_id":100020801,"comment_content":"连接器：用户输入用户名 密码 用于连接数据库<br>分析器：负责分析用户输入的sql语法<br>优化器：负责索引的选择<br>执行器：操作引擎，返回结果<br>存储引擎：负责存储数据，提供读写接口<br>","like_count":0},{"had_liked":false,"id":134950,"user_name":"Cola_","can_delete":false,"product_type":"c1","uid":1264718,"ip_address":"","ucode":"99996D04CA4171","user_header":"https://static001.geekbang.org/account/avatar/00/13/4c/4e/91267714.jpg","comment_is_top":false,"comment_ctime":1568960887,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568960887","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":134275,"user_name":"嘟嘟熊","can_delete":false,"product_type":"c1","uid":1361018,"ip_address":"","ucode":"8478242F5BD2C5","user_header":"https://static001.geekbang.org/account/avatar/00/14/c4/7a/97b18989.jpg","comment_is_top":false,"comment_ctime":1568791011,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568791011","product_id":100020801,"comment_content":"有两个问题希望老师简单解答一下<br>1、文章说说在执行器执行之前，会先进行precheck校验对表的查询权限，那是不是可以理解为对表的权限的校验是在分析阶段？<br>2、对于提问区的一个问题，说对于一个没有查询权限的用户，即使使用了没有定义的列，也会返回没有权限的错误，而不会返回未定义列的语法错误，老师说是基于安全的考虑，这里我有两个理解，第一个就是权限的check确实是在分析器中做的，2分析器会对各种错误做出分析，然后基于安全考虑，返回最安全的错误，例如没有权限的错误查询是会直接返回权限错，而不会返回其他的错误信息。保证数据库的安全。<br>","like_count":0},{"had_liked":false,"id":132911,"user_name":"Empty","can_delete":false,"product_type":"c1","uid":1029805,"ip_address":"","ucode":"C3DB50D453BFB2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/ad/d9d270eb.jpg","comment_is_top":false,"comment_ctime":1568272441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568272441","product_id":100020801,"comment_content":"请问老师，这里的执行器是不是MySQL体系结构图中的SQL Interface呢？","like_count":0},{"had_liked":false,"id":132704,"user_name":"looper","can_delete":false,"product_type":"c1","uid":1238396,"ip_address":"","ucode":"DA4BCE83836C04","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/7c/2a5a418b.jpg","comment_is_top":false,"comment_ctime":1568197233,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568197233","product_id":100020801,"comment_content":"分析器，词法分析，语法分析","like_count":0},{"had_liked":false,"id":132057,"user_name":"Justin","can_delete":false,"product_type":"c1","uid":1613505,"ip_address":"","ucode":"FC6E2BD6EA0637","user_header":"https://static001.geekbang.org/account/avatar/00/18/9e/c1/ff754fa8.jpg","comment_is_top":false,"comment_ctime":1568016476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568016476","product_id":100020801,"comment_content":"老师有一个问题，在连接器阶段户名密码认证通过后不是已经进行权限判断了嘛，为啥执行器哪里还有进行权限判断，","like_count":0},{"had_liked":false,"id":131399,"user_name":"常文龙","can_delete":false,"product_type":"c1","uid":1204525,"ip_address":"","ucode":"4A126159D24766","user_header":"https://static001.geekbang.org/account/avatar/00/12/61/2d/5ca0a3da.jpg","comment_is_top":false,"comment_ctime":1567739488,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567739488","product_id":100020801,"comment_content":"请教一下：<br>文章中有提到&quot;建议你在使用中要尽量减少建立连接的动作，也就是尽量使用长连接&quot;<br><br>我们在使用时如何实现尽量使用长连接呢，有相应的的配置参数吗？","like_count":0},{"had_liked":false,"id":131197,"user_name":"行者","can_delete":false,"product_type":"c1","uid":1618607,"ip_address":"","ucode":"8179D167D99CB9","user_header":"https://static001.geekbang.org/account/avatar/00/18/b2/af/81303f5a.jpg","comment_is_top":false,"comment_ctime":1567669128,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567669128","product_id":100020801,"comment_content":"一遍看完，实践了部分，认识还不深刻，整理了大部分笔记，扭过头回来看，印象还是不深，二刷开始！坚持做到老师讲的每一个例子都自己跑一次，加油！","like_count":0},{"had_liked":false,"id":130833,"user_name":"sololo","can_delete":false,"product_type":"c1","uid":1161501,"ip_address":"","ucode":"39335B41FF5A15","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/1d/1b95df1f.jpg","comment_is_top":false,"comment_ctime":1567558172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567558172","product_id":100020801,"comment_content":"为什么权限的判断不是在分析器阶段进行的呢？","like_count":0},{"had_liked":false,"id":130807,"user_name":"Monch.D.Luffy","can_delete":false,"product_type":"c1","uid":1175410,"ip_address":"","ucode":"C70C853917294B","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/72/e3850250.jpg","comment_is_top":false,"comment_ctime":1567555530,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567555530","product_id":100020801,"comment_content":"权限验证的地方比较多，有点晕菜。<br>1、为啥缓存命中，结果返回前再做表权限验证？如果放到查询前做表权限验证，在没有权限的情况下，可以减少一次查询。<br>2、优化器前的precheck做的又是什么验证呢？<br>3、执行器的时候，也会对表权限进行验证。","like_count":0},{"had_liked":false,"id":130797,"user_name":"Monch.D.Luffy","can_delete":false,"product_type":"c1","uid":1175410,"ip_address":"","ucode":"C70C853917294B","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/72/e3850250.jpg","comment_is_top":false,"comment_ctime":1567554144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567554144","product_id":100020801,"comment_content":"应该是在分析器中做的吧。","like_count":0},{"had_liked":false,"id":129237,"user_name":"Tao","can_delete":false,"product_type":"c1","uid":1466809,"ip_address":"","ucode":"75FBDF49C601F4","user_header":"https://static001.geekbang.org/account/avatar/00/16/61/b9/dbf629c0.jpg","comment_is_top":false,"comment_ctime":1567068965,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567068965","product_id":100020801,"comment_content":"mysql&gt; elect * from t where ID=1;   林老师这个语句报错不是应该在词法分析的时候报错嘛，因为elect词法分析不出来呢","like_count":0},{"had_liked":false,"id":127233,"user_name":"几米阳光","can_delete":false,"product_type":"c1","uid":1157656,"ip_address":"","ucode":"0FE186125049A6","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/18/dfd867af.jpg","comment_is_top":false,"comment_ctime":1566616790,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566616790","product_id":100020801,"comment_content":"分析器，做语法分析时会报这个错","like_count":0},{"had_liked":false,"id":126004,"user_name":"咕噜咕噜小小鱼","can_delete":false,"product_type":"c1","uid":1324263,"ip_address":"","ucode":"4054743CF5CD1C","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/e7/49d6b8df.jpg","comment_is_top":false,"comment_ctime":1566292102,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566292102","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":125485,"user_name":"确认过眼神","can_delete":false,"product_type":"c1","uid":1245530,"ip_address":"","ucode":"E6D73A9D27A279","user_header":"https://static001.geekbang.org/account/avatar/00/13/01/5a/f7c989e4.jpg","comment_is_top":false,"comment_ctime":1566191047,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566191047","product_id":100020801,"comment_content":"课后问题分析：<br>查询缓存阶段没有这条SQL的key存在；<br>分析器阶段在词法分析中将“k”识别成列，语法分析中满足SQL语法；<br>优化器阶段查询列“k”没有创建索引...<br>分析到此后出现问题：<br>1、连接器去权限表中查询拥有的权限（登录权限？）、优化器之前调用precheck验证权限（根据分析器分析出的关键字如select、update来验证是否有查询修改权限？）、执行器阶段判断执行查询权限，这三者权限有什么区别，都查什么权限？<br>2、这些权限是否都需要在触碰表之前做判断？如果是，那就到达了执行器阶段才会报错，个人认为拥有了权限后才会接触表，否则数据容易泄露，而优化器的例子中就接触到了表中的数据，这么说在优化器会报错，个人认为这个例子应该写在执行器中吧？<br>很多疑惑，继续阅读，希望得到回复。","like_count":0},{"had_liked":false,"id":124653,"user_name":"程序员七七","can_delete":false,"product_type":"c1","uid":1507535,"ip_address":"","ucode":"CF585D6B74677A","user_header":"https://static001.geekbang.org/account/avatar/00/17/00/cf/efc9b3ce.jpg","comment_is_top":false,"comment_ctime":1565938457,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1565938457","product_id":100020801,"comment_content":"关于长、短连接这里不是很明白，在MYSQL中两者都有使用到吗？什么条件下是长连接，什么情况下又是短连接不知道老师在后面的文章中会有专门的讲解吗？","like_count":0,"discussions":[{"author":{"id":1111392,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/60/56314d72.jpg","nickname":"街角处","note":"","ucode":"D136FA44F007BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352790,"discussion_content":"个人理解是在JDBC中执行一个操作获取一个连接操作完之后就立即关闭连接，这就是短连接；长连接就是使用了连接池技术，连接复用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614850183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124372,"user_name":"_你说了不算","can_delete":false,"product_type":"c1","uid":1185159,"ip_address":"","ucode":"212F890565FE5C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/87/d22d8c3e.jpg","comment_is_top":false,"comment_ctime":1565869701,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1565869701","product_id":100020801,"comment_content":"老师 不知道现在能不能看到我的留言  上面尼古拉斯的问题 我有点不懂  用户发起一个查询  如果同时用户即没有select的权限 同时表中也没有查询需要的字段 这种不应该报分析器中报字段找不到的错误吗 select的权限在执行器阶段判断的吧","like_count":0,"discussions":[{"author":{"id":1111392,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f5/60/56314d72.jpg","nickname":"街角处","note":"","ucode":"D136FA44F007BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352789,"discussion_content":"连接建立之后就有权限验证了，所以提示没有select权限在先","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614850059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123908,"user_name":"JJj","can_delete":false,"product_type":"c1","uid":1196463,"ip_address":"","ucode":"EA53F2CEAFCFF1","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/af/4307867a.jpg","comment_is_top":false,"comment_ctime":1565780519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565780519","product_id":100020801,"comment_content":"老师，你好。原文提到连接器时，这个连接里面的权限判断逻辑，都将依赖于此时读到的权限。所以后续讨论的权限都是在连接器时获取的，只不过判断权限在其他阶段做是吧，比如执行器阶段判断对表的权限<br>","like_count":0},{"had_liked":false,"id":123839,"user_name":"天天天晴","can_delete":false,"product_type":"c1","uid":1628636,"ip_address":"","ucode":"4C00F4BBA79EE9","user_header":"https://static001.geekbang.org/account/avatar/00/18/d9/dc/9f5ad6c2.jpg","comment_is_top":false,"comment_ctime":1565769563,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565769563","product_id":100020801,"comment_content":"有个疑问：如果在分析阶段判断语句是否正确，表是否存在，列是否存在，那么检查权限应该是在此之前吧，也就是在分析器中检查权限，当我没有权限并且查询了一个不存在的字段时，先报的是没有权限。","like_count":0},{"had_liked":false,"id":123796,"user_name":"一颗咸鸭蛋","can_delete":false,"product_type":"c1","uid":1629047,"ip_address":"","ucode":"6D61401426B385","user_header":"https://static001.geekbang.org/account/avatar/00/18/db/77/13e23012.jpg","comment_is_top":false,"comment_ctime":1565762772,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565762772","product_id":100020801,"comment_content":"分析器吧。分析的时候就会识别到这个列不存在。","like_count":0},{"had_liked":false,"id":123645,"user_name":"Geek_b92851","can_delete":false,"product_type":"c1","uid":1463431,"ip_address":"","ucode":"2E3D6490796C5A","user_header":"","comment_is_top":false,"comment_ctime":1565739790,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565739790","product_id":100020801,"comment_content":"查询缓存使用的内存是连接管理的那块临时内存吗？","like_count":0},{"had_liked":false,"id":123402,"user_name":"Alpha 👀","can_delete":false,"product_type":"c1","uid":1200971,"ip_address":"","ucode":"3C0BAD36550718","user_header":"https://static001.geekbang.org/account/avatar/00/12/53/4b/28991f30.jpg","comment_is_top":false,"comment_ctime":1565668486,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565668486","product_id":100020801,"comment_content":"老师，请问为什么查询缓存是分析器更新的呢，我理解应该是执行器吧","like_count":0},{"had_liked":false,"id":123211,"user_name":"汉斯·冯·拉特","can_delete":false,"product_type":"c1","uid":1102385,"ip_address":"","ucode":"29F14B0D938A02","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/31/f1bec7fc.jpg","comment_is_top":false,"comment_ctime":1565626711,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565626711","product_id":100020801,"comment_content":"老师，你好，讲了索引是在优化器中，那索引下推是怎么做的，能否解答下？","like_count":0},{"had_liked":false,"id":122772,"user_name":"哦豁。","can_delete":false,"product_type":"c1","uid":1398476,"ip_address":"","ucode":"85727C25E65B7D","user_header":"https://static001.geekbang.org/account/avatar/00/15/56/cc/f7dd622d.jpg","comment_is_top":false,"comment_ctime":1565518863,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565518863","product_id":100020801,"comment_content":"我认为是在「分析器」中的「语法分析」阶段报出来","like_count":0},{"had_liked":false,"id":122769,"user_name":"张浩","can_delete":false,"product_type":"c1","uid":1001225,"ip_address":"","ucode":"DBEAFFB7660813","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/09/316b0aa1.jpg","comment_is_top":false,"comment_ctime":1565517013,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1565517013","product_id":100020801,"comment_content":"分析器的词法分析阶段","like_count":0},{"had_liked":false,"id":122468,"user_name":"赵小洛","can_delete":false,"product_type":"c1","uid":1592232,"ip_address":"","ucode":"A326C12B1A1ABA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/a8/14b8a860.jpg","comment_is_top":false,"comment_ctime":1565400247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565400247","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":122164,"user_name":"蛙声一片","can_delete":false,"product_type":"c1","uid":1305921,"ip_address":"","ucode":"856916A10D6097","user_header":"https://static001.geekbang.org/account/avatar/00/13/ed/41/4823e701.jpg","comment_is_top":false,"comment_ctime":1565312532,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565312532","product_id":100020801,"comment_content":"分析器，词法分析的时候","like_count":0},{"had_liked":false,"id":122045,"user_name":"赵小洛","can_delete":false,"product_type":"c1","uid":1592232,"ip_address":"","ucode":"A326C12B1A1ABA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/a8/14b8a860.jpg","comment_is_top":false,"comment_ctime":1565274935,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565274935","product_id":100020801,"comment_content":"还得多看几遍  感觉理解起来有点费解","like_count":0},{"had_liked":false,"id":122044,"user_name":"赵小洛","can_delete":false,"product_type":"c1","uid":1592232,"ip_address":"","ucode":"A326C12B1A1ABA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/a8/14b8a860.jpg","comment_is_top":false,"comment_ctime":1565274721,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1565274721","product_id":100020801,"comment_content":"分析器吗？","like_count":0},{"had_liked":false,"id":119706,"user_name":"记忆","can_delete":false,"product_type":"c1","uid":1601032,"ip_address":"","ucode":"77EF6B920EA194","user_header":"https://static001.geekbang.org/account/avatar/00/18/6e/08/141385cd.jpg","comment_is_top":false,"comment_ctime":1564660136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564660136","product_id":100020801,"comment_content":"老师我有两个问题：1 当客户端输入用户名和密码，连接器验证通过后就是建立了一次链接吗？如果这个链接一直没有断开就是长链接，如果这个链接操作了几次就断开了，链接就是短链接吗？2，在分析器阶段，就会去查表里有没有K这个字段吗？如果链接没有查这个表的权限，会不会在分析器的时候就返回没有权限的错误呢？","like_count":0},{"had_liked":false,"id":119323,"user_name":"旧城故人勿念","can_delete":false,"product_type":"c1","uid":1307445,"ip_address":"","ucode":"56DDC90FF78EA6","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/35/8369c63f.jpg","comment_is_top":false,"comment_ctime":1564561216,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564561216","product_id":100020801,"comment_content":"想问一下sql server 的逻辑架构和mysql的是否是异曲同工，大同小异呢","like_count":0},{"had_liked":false,"id":118525,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1564380862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564380862","product_id":100020801,"comment_content":"老师，为什么分析器和查询缓存还有连线","like_count":0},{"had_liked":false,"id":115491,"user_name":"Northern","can_delete":false,"product_type":"c1","uid":1060908,"ip_address":"","ucode":"6B8DB4CF385029","user_header":"https://static001.geekbang.org/account/avatar/00/10/30/2c/333d7080.jpg","comment_is_top":false,"comment_ctime":1563604337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563604337","product_id":100020801,"comment_content":"挺不错的文章","like_count":0},{"had_liked":false,"id":114854,"user_name":"罗格","can_delete":false,"product_type":"c1","uid":1206701,"ip_address":"","ucode":"B5DAA40E7DE008","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/ad/f5df3e6a.jpg","comment_is_top":false,"comment_ctime":1563417543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563417543","product_id":100020801,"comment_content":"MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。<br>老师，请问这句话里的连接对象是指客户端这类吗？就是谁连接MySQL谁就是连接对象？","like_count":0},{"had_liked":false,"id":114514,"user_name":"莫问流年","can_delete":false,"product_type":"c1","uid":1249663,"ip_address":"","ucode":"23140E031AED4B","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/7f/80d56c1c.jpg","comment_is_top":false,"comment_ctime":1563328087,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563328087","product_id":100020801,"comment_content":"课后问题：查询语句包含不存在的列名是在分析器阶段，确切的说是被语意分析器识别的。设计上来说，发现越早，对性能的影响越小。<br><br>权限验证发生在执行器阶段，而没有发生在分析器阶段是因为，像触发器这类操作只有执行阶段才能完全确定，因此只能执行器阶段再验证。","like_count":0},{"had_liked":false,"id":113779,"user_name":"师恩磊","can_delete":false,"product_type":"c1","uid":1216657,"ip_address":"","ucode":"237A2B7D19E0A5","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/91/aebfb724.jpg","comment_is_top":false,"comment_ctime":1563154942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563154942","product_id":100020801,"comment_content":"问题答案：该错误是在分析器阶段返回的，因为，分析器阶段会将SQL中的字符串与数据库中的表名和字段名做匹配，匹配不到，则返回错误。<br>今天主要是讲了一条select语句的执行过程，先是连接器，查询器，查询缓存，分析器，优化器，执行器。连接器，通过TCP的三次握手后，建立客户端与服务器的连接，此处讲解了长连接与短连接的区别，长连接是指连接不断开，短连接是指，执行完几个sql语录后，连接断开，客户端再执行SQL则会报错，需要重新建立连接，由于上面说的TCP三次通信握手连接，会造成很耗时，所以此处建议使用长连接，不使用短连接。但使用长连接会造成内存上升，甚至溢出。解决方法，定时关闭长连接或查询大数据量后自动将长连接关闭，因为长连接是将数据存储在连接对象的内存中，连接对象不关闭，该内存不会释放。查询缓存，是以k-v键值对的形式存储的，k代表查询语句，v代表查询结果，如果查询缓存中有则直接返回，没有则走分析器，数据更新频繁的表，不建议使用查询缓存，因为只要数据更新，则缓存失效。分析器，查询缓存中没有，进入分析器，分析器会词法分析和语法分析SQL，一条SQL就是多个字符串和空格组成的，检测到SELECT，则判断为查询语录，将SQL中的字符串与表名和表中的列做匹配。如果拼写有错误，表名和字段名匹配不成功，则返回错误。然后进入优化器，此处需要选择执行器，及执行执行计划，选择最优方案。然后执行器，调用存储引擎的接口查询数据，将满足条件的结果放入结果集，最后将结果集返回客户端。至此一条查询SQL语句执行完毕。","like_count":0},{"had_liked":false,"id":112980,"user_name":"夕林语","can_delete":false,"product_type":"c1","uid":1264180,"ip_address":"","ucode":"B57681D0C73E1B","user_header":"https://static001.geekbang.org/account/avatar/00/13/4a/34/1faac99b.jpg","comment_is_top":false,"comment_ctime":1562859363,"is_pvip":false,"discussion_count":0,"race_medal":2,"score":"1562859363","product_id":100020801,"comment_content":"分析器，分析器的作用是验证语法和词法的，创建表之后表结构理论上就会被缓存起来，在分析器这个层面进行比较验证","like_count":0},{"had_liked":false,"id":112077,"user_name":"太阳一直晒~","can_delete":false,"product_type":"c1","uid":1123874,"ip_address":"","ucode":"46FD547C798483","user_header":"https://static001.geekbang.org/account/avatar/00/11/26/22/43a718ea.jpg","comment_is_top":false,"comment_ctime":1562664745,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562664745","product_id":100020801,"comment_content":"第二遍过 想到一个问题，如何判断创建的这个连接是长连接还是短连接？或者说创建长连接或短连接的方式有什么不同之处？","like_count":0},{"had_liked":false,"id":109360,"user_name":"一个卖火柴的老男人","can_delete":false,"product_type":"c1","uid":1181265,"ip_address":"","ucode":"1227638C457F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/51/1d24ead6.jpg","comment_is_top":false,"comment_ctime":1562026247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562026247","product_id":100020801,"comment_content":"总算明白之前阿里面试的问题了，谢谢分享，受用！","like_count":0},{"had_liked":false,"id":108824,"user_name":"李荣凯","can_delete":false,"product_type":"c1","uid":1520177,"ip_address":"","ucode":"D7567E80F800E7","user_header":"https://static001.geekbang.org/account/avatar/00/17/32/31/b6770a2d.jpg","comment_is_top":false,"comment_ctime":1561890394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561890394","product_id":100020801,"comment_content":"答案词法分析阶段，老师文章中讲词法分析的原句“它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID””。","like_count":0},{"had_liked":false,"id":108797,"user_name":"天空","can_delete":false,"product_type":"c1","uid":1522985,"ip_address":"","ucode":"823CCB51D32706","user_header":"https://static001.geekbang.org/account/avatar/00/17/3d/29/e6f488b8.jpg","comment_is_top":false,"comment_ctime":1561884146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561884146","product_id":100020801,"comment_content":"有个问题不太确定，使用连接池能够解决连接太多造成的内存占用大的问题吗？还有一个，一个大的查询是是指查询结果很大吗？MySQL也需要把查询结果放到内存中保存吗？如果这样的话，一个特别大的查询会不会造成MySQL服务宕机啊","like_count":0},{"had_liked":false,"id":108665,"user_name":"少盐","can_delete":false,"product_type":"c1","uid":1305743,"ip_address":"","ucode":"BCC7E264B75702","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/8f/8299495a.jpg","comment_is_top":false,"comment_ctime":1561825710,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561825710","product_id":100020801,"comment_content":"Server 层有binlog ，而innodb 引擎有relog ，为保证数据的一致性，分为两阶段执行","like_count":0},{"had_liked":false,"id":108092,"user_name":"星环少年","can_delete":false,"product_type":"c1","uid":1012583,"ip_address":"","ucode":"75D5402A6CD724","user_header":"https://static001.geekbang.org/account/avatar/00/0f/73/67/eb6cee42.jpg","comment_is_top":false,"comment_ctime":1561681583,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561681583","product_id":100020801,"comment_content":"老师您好，请问检验权限的逻辑为什么不提前到解析阶段呢？解析阶段不是已经知道了要查询什么表了吗？","like_count":0},{"had_liked":false,"id":107143,"user_name":"克里斯","can_delete":false,"product_type":"c1","uid":1181844,"ip_address":"","ucode":"00B755C10AC1C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/94/2c22bd4e.jpg","comment_is_top":false,"comment_ctime":1561467027,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1561467027","product_id":100020801,"comment_content":"这个k是字段，字段由分析器负责","like_count":0},{"had_liked":false,"id":104574,"user_name":"Rimmy","can_delete":false,"product_type":"c1","uid":1389341,"ip_address":"","ucode":"CA819AEE717652","user_header":"https://static001.geekbang.org/account/avatar/00/15/33/1d/310c7345.jpg","comment_is_top":false,"comment_ctime":1560777703,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1560777703","product_id":100020801,"comment_content":"林老师，分析器为什么不先进行“语法分析”，再做“词法分析”？","like_count":0,"discussions":[{"author":{"id":1453053,"avatar":"https://static001.geekbang.org/account/avatar/00/16/2b/fd/7013289d.jpg","nickname":"温故而知新可以为师矣","note":"","ucode":"FADCDFA9F9E5E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":66712,"discussion_content":"select有select的语法，alter有alter的语法，drop有drop的语法，不知道到底是“select”，&#34;alter&#34;,或者&#34;drop&#34;，肯定做不了任何语法分析的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575100287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104302,"user_name":"Geek_6944ac","can_delete":false,"product_type":"c1","uid":1575002,"ip_address":"","ucode":"CEB0AD8B0EDEAB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKe0iaNYicicxBBCibmu9iaVLdFibnOK4TTtgelqucyKXq9sEX0rGLnfZhdMfvMqDZF1SsibbXXGDoPyVObw/132","comment_is_top":false,"comment_ctime":1560730585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560730585","product_id":100020801,"comment_content":"讲得很清晰，利于理解。","like_count":0},{"had_liked":false,"id":104263,"user_name":"xingxu","can_delete":false,"product_type":"c1","uid":1369771,"ip_address":"","ucode":"EB35019BEF5452","user_header":"https://static001.geekbang.org/account/avatar/00/14/e6/ab/5d16c229.jpg","comment_is_top":false,"comment_ctime":1560701965,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1560701965","product_id":100020801,"comment_content":"认为是分析器，分析器在语法分析会对语句进行一个拆分，应该在这一步会发现列并不存在与表中。","like_count":0},{"had_liked":false,"id":103946,"user_name":"lecy_L","can_delete":false,"product_type":"c1","uid":1127659,"ip_address":"","ucode":"7C96DDBB3D1F7E","user_header":"https://static001.geekbang.org/account/avatar/00/11/34/eb/d00aedb0.jpg","comment_is_top":false,"comment_ctime":1560570154,"is_pvip":false,"replies":[{"id":"37610","content":"没有区别<br>一般是取一次（连接的时候），然后多次判断","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1560585483,"ip_address":"","comment_id":103946,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560570154","product_id":100020801,"comment_content":"老师，你好！<br>问题：连接器会到权限表里面查出你拥有的权限、执行器执行的时候也会做权限验证，我想问一下这两个权限有什么区别？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454069,"discussion_content":"没有区别\n一般是取一次（连接的时候），然后多次判断","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560585483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103855,"user_name":"sunshineling","can_delete":false,"product_type":"c1","uid":1543564,"ip_address":"","ucode":"7E8E03C8568112","user_header":"https://static001.geekbang.org/account/avatar/00/17/8d/8c/ec40964b.jpg","comment_is_top":false,"comment_ctime":1560549108,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1560549108","product_id":100020801,"comment_content":"执行阶段会报错","like_count":0},{"had_liked":false,"id":103657,"user_name":"浅夏","can_delete":false,"product_type":"c1","uid":1393244,"ip_address":"","ucode":"227D4654417905","user_header":"https://static001.geekbang.org/account/avatar/00/15/42/5c/8cd1d734.jpg","comment_is_top":false,"comment_ctime":1560484153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560484153","product_id":100020801,"comment_content":"分析器,分析语法对不对,<br>请晓斌哥指点","like_count":0},{"had_liked":false,"id":103323,"user_name":"杨小凡","can_delete":false,"product_type":"c1","uid":1308912,"ip_address":"","ucode":"5A7ACF4A79FA8F","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/f0/0285e98a.jpg","comment_is_top":false,"comment_ctime":1560414347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560414347","product_id":100020801,"comment_content":"文章中：<br>开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，括号中又说查询也会在优化器之前调用 precheck 验证权限<br><br>1、开始执行的时候不是已经过了优化器阶段吗？<br>2、precheck就是验证权限吗？","like_count":0},{"had_liked":false,"id":102987,"user_name":"冷夜雨","can_delete":false,"product_type":"c1","uid":1047729,"ip_address":"","ucode":"4BD3942F91C854","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/b1/e1f906fa.jpg","comment_is_top":false,"comment_ctime":1560343010,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560343010","product_id":100020801,"comment_content":"优化器","like_count":0},{"had_liked":false,"id":102597,"user_name":"evancao","can_delete":false,"product_type":"c1","uid":1312016,"ip_address":"","ucode":"BD5BBD82B839BB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ephT4ucrKH1F3iagialpTVzUyTgOA84IAfKK7gOywSD3v8TTa9NPf2S83NElb0ScDBNJ5nALOH3lKmQ/132","comment_is_top":false,"comment_ctime":1560259658,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560259658","product_id":100020801,"comment_content":"是不是应该在优化器阶段，测试发现如果列名错误在sql_parse.cc:7057 parse_sql()这个方法并没有检查， 最终的检查err是在 sql_resolver.cc 的SELECT_LEX::prepare(THD *thd) 抛出来的，这个方法里面的注释：  Prepare query block for optimization.。  不知道这个是不是算做优化器的范围了。 不知道的老师说的执行器和优化器在源码上怎么分。我觉得进入到sql_parse.cc:5099 execute_sqlcom_select是不是能算优化或者说执行器的范畴了。","like_count":0},{"had_liked":false,"id":102008,"user_name":"chen","can_delete":false,"product_type":"c1","uid":1446163,"ip_address":"","ucode":"931BF1B5127607","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGmHtibYsGpibKcIlsmcIkeBice9xHE647WXdewzzS8ibqpicW9ibwshzU0GD41Rl4yOhMic23A5ZYTle4w/132","comment_is_top":false,"comment_ctime":1560096281,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560096281","product_id":100020801,"comment_content":"老师你好，之前看到其他书中介绍MySQL体系结构由连接池组件、缓冲组件、查询分析器、SQL优化器、存储引擎、SQL接口组件，管理服务和工具组件和物理文件组成。<br>想问下您文中的“执行器”对应到“MySQL体系结构”中是属于这里面的哪个组件呢？","like_count":0},{"had_liked":false,"id":101095,"user_name":"开始学习吧","can_delete":false,"product_type":"c1","uid":1400873,"ip_address":"","ucode":"1EB24E7FB1C738","user_header":"https://static001.geekbang.org/account/avatar/00/15/60/29/db34c475.jpg","comment_is_top":false,"comment_ctime":1559716587,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559716587","product_id":100020801,"comment_content":"mysql&gt; select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;<br>之前有看过其他资料，有些矛盾的地方，连接查询是先进行 t1 和t2 的笛卡尔积，然后再筛选 ， where后的执行条件是从左往右的<br>不知道和优化器到底是怎么协调的 <br>","like_count":0},{"had_liked":false,"id":100804,"user_name":"张大人","can_delete":false,"product_type":"c1","uid":1200544,"ip_address":"","ucode":"4FCA71788DEB29","user_header":"https://static001.geekbang.org/account/avatar/00/12/51/a0/f3bb1dd7.jpg","comment_is_top":false,"comment_ctime":1559641865,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559641865","product_id":100020801,"comment_content":"在使用连接池的情况下，也应该定期执行mysql_reset_connection方法对吧，现在市面上的连接池都用这个方法了吗？","like_count":0},{"had_liked":false,"id":100388,"user_name":"Yan.W","can_delete":false,"product_type":"c1","uid":1202457,"ip_address":"","ucode":"65623660197958","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/19/b1cc1feb.jpg","comment_is_top":false,"comment_ctime":1559543983,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559543983","product_id":100020801,"comment_content":"分析器阶段，这个阶段决定要做什么，怎么做","like_count":0},{"had_liked":false,"id":100056,"user_name":"水电工٩(｡•ω•｡)﻿و","can_delete":false,"product_type":"c1","uid":1348364,"ip_address":"","ucode":"C43B6B4DDA9BE7","user_header":"https://static001.geekbang.org/account/avatar/00/14/93/0c/dd383681.jpg","comment_is_top":false,"comment_ctime":1559406235,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559406235","product_id":100020801,"comment_content":"分析器。分析器负责语法和词法分析，字段应该算是词法吧？","like_count":0},{"had_liked":false,"id":99750,"user_name":"Geek_019531","can_delete":false,"product_type":"c1","uid":1563214,"ip_address":"","ucode":"90C29D69B5E4D1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyNJCibCAUoZHib55TsCUBGFk5HosAB7ShvlmhJZIXEiaH7yyq184ibia0u0bnfrmdqWLHt1CjeXM4Hicg/132","comment_is_top":false,"comment_ctime":1559291458,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559291458","product_id":100020801,"comment_content":"疑问：spring框架整合druid数据源去连接数据库，那当连接导致内存占用太大时怎么做呢？","like_count":0},{"had_liked":false,"id":99351,"user_name":"Teamillet","can_delete":false,"product_type":"c1","uid":1538903,"ip_address":"","ucode":"66B712805BD5A4","user_header":"https://static001.geekbang.org/account/avatar/00/17/7b/57/16b46235.jpg","comment_is_top":false,"comment_ctime":1559198495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559198495","product_id":100020801,"comment_content":"分析器，词法分析出对应列，发现没有，直接报错","like_count":0},{"had_liked":false,"id":99336,"user_name":"xinnong","can_delete":false,"product_type":"c1","uid":1005415,"ip_address":"","ucode":"3C1F1EB93FBA5B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/67/01d1580f.jpg","comment_is_top":false,"comment_ctime":1559195614,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559195614","product_id":100020801,"comment_content":"CREATE TABLE TEST_190530<br>(ID VARCHAR(50));<br>INSERT INTO TEST_190530 VALUES(&#39;1A&#39;);<br>INSERT INTO TEST_190530 VALUES(&#39;1&#39;);<br>INSERT INTO TEST_190530 VALUES(&#39;2C&#39;);<br><br>mysql&gt; SELECT * FROM TEST_190530 WHERE ID=1A;<br>1054 - Unknown column &#39;1A&#39; in &#39;where clause&#39;<br><br>where语句中的1A需要加单引号才可以正确执行，您能解释一下其中的原因么？为什么1A会被mysql认为是一个列名呢？为什么下面的sql虽然有waring，但是能执行呢？1为什么没有被当成列名呢？<br><br>mysql&gt; SELECT * FROM TEST_190530 WHERE ID=1;<br>+----+<br>| ID |<br>+----+<br>| 1A |<br>| 1  |<br>+----+<br>2 rows in set<br><br>mysql&gt; SHOW WARNINGS;<br>+---------+------+----------------------------------------+<br>| Level   | Code | Message                                |<br>+---------+------+----------------------------------------+<br>| Warning | 1292 | Truncated incorrect DOUBLE value: &#39;1A&#39; |<br>| Warning | 1292 | Truncated incorrect DOUBLE value: &#39;2C&#39; |<br>+---------+------+----------------------------------------+<br>2 rows in set","like_count":0},{"had_liked":false,"id":98017,"user_name":"张sir","can_delete":false,"product_type":"c1","uid":1209431,"ip_address":"","ucode":"52958DF6705208","user_header":"https://static001.geekbang.org/account/avatar/00/12/74/57/7b828263.jpg","comment_is_top":false,"comment_ctime":1558874395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558874395","product_id":100020801,"comment_content":"应该是在分析器吧","like_count":0},{"had_liked":false,"id":96140,"user_name":"Pourquoi","can_delete":false,"product_type":"c1","uid":1192669,"ip_address":"","ucode":"3FBAE13835AFCE","user_header":"https://static001.geekbang.org/account/avatar/00/12/32/dd/e0646fec.jpg","comment_is_top":false,"comment_ctime":1558341979,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558341979","product_id":100020801,"comment_content":"应该是分析器阶段。","like_count":0},{"had_liked":false,"id":95676,"user_name":"天亮前说晚安","can_delete":false,"product_type":"c1","uid":1541014,"ip_address":"","ucode":"1D82EE562A7C71","user_header":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","comment_is_top":false,"comment_ctime":1558140861,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558140861","product_id":100020801,"comment_content":"查询缓存中的key是怎么定义的？对查询语句hash还是说，整条语句转字符串，还是一个其他标识。清除这个缓存是只要update任意一行就整个表的缓存清空嘛？","like_count":0},{"had_liked":false,"id":95445,"user_name":"gkb111","can_delete":false,"product_type":"c1","uid":1224217,"ip_address":"","ucode":"9B3154BCC9046B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLLUic3XzxET3L3QXxcTbeg96GMx1HkiaiaZdudchmOmtPnuEPHK5vYEeMkvJR098XljMbXDialYib3z6w/132","comment_is_top":false,"comment_ctime":1558057098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558057098","product_id":100020801,"comment_content":"鸟瞰思维与陷入细节。不要轻易陷入细节，容易迷茫。<br>连接器，分析器，优化器，执行器","like_count":0},{"had_liked":false,"id":93919,"user_name":"Alon","can_delete":false,"product_type":"c1","uid":1084267,"ip_address":"","ucode":"34069BD445BE95","user_header":"https://static001.geekbang.org/account/avatar/00/10/8b/6b/394177a8.jpg","comment_is_top":false,"comment_ctime":1557667099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557667099","product_id":100020801,"comment_content":"分析器环节，因为这个环节会进行词法检查，和语法检查！","like_count":0},{"had_liked":false,"id":92474,"user_name":"Lucus","can_delete":false,"product_type":"c1","uid":1198800,"ip_address":"","ucode":"CE8EB70CB9D9F1","user_header":"https://static001.geekbang.org/account/avatar/00/12/4a/d0/d319c44a.jpg","comment_is_top":false,"comment_ctime":1557279411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557279411","product_id":100020801,"comment_content":"我猜是执行阶段吧，分析阶段没有语法错误就不会，优化阶段应该只是判断k有没有索引，执行阶段才会打开表检查表结构","like_count":0},{"had_liked":false,"id":92346,"user_name":"Eazow","can_delete":false,"product_type":"c1","uid":1346402,"ip_address":"","ucode":"D81D8FF2B2FF0D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bmgpp5wc8GLmOdHNQccSgrunK0VdIicB6rpTHXCTF5xEkm2YvPHOX2DwNt2EqTzJ70JD41h0u5qW4R0yXRY1ZCg/132","comment_is_top":false,"comment_ctime":1557237922,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1557237922","product_id":100020801,"comment_content":"mysql&gt; select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;<br><br>这里展示有bug","like_count":0},{"had_liked":false,"id":90649,"user_name":"do it","can_delete":false,"product_type":"c1","uid":1309911,"ip_address":"","ucode":"E0753912E8F2AF","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/d7/b102034a.jpg","comment_is_top":false,"comment_ctime":1556599673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556599673","product_id":100020801,"comment_content":"个人小结<br>Mysql逻辑架构(分为存储层和Server层)，包括 连接器、分析器、优化器、执行器、查询缓存。<br>连接器：负责链连接、用户权限验证<br>分析器：词法语法分析，通过这一步知道“要做什么”<br>优化器：优化查询语句。(多索引情况下，决定要使用哪个索引；多表关联(join)情况下，决定多个表之间的连接顺序)<br>执行器：执行优化的语句<br>Mysql 的引擎是插件式的，主要有MYISAM、INODB、MEMORY等。<br>Mysql5.5.5之前默认使用的存储引擎的MYISAM，之后的版本默认采用INODB引擎<br><br>","like_count":0},{"had_liked":false,"id":89454,"user_name":"如果","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1556178240,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556178240","product_id":100020801,"comment_content":"DAY1，打卡","like_count":0},{"had_liked":false,"id":89192,"user_name":"今夜秋风和","can_delete":false,"product_type":"c1","uid":1434066,"ip_address":"","ucode":"453C8197FFC81D","user_header":"https://static001.geekbang.org/account/avatar/00/15/e1/d2/42ad2c87.jpg","comment_is_top":false,"comment_ctime":1556102348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556102348","product_id":100020801,"comment_content":"学习的有点完了，不过内容特别好。这个题的应该是词法分析器分析的时候发现该表中没有相应的字段列。老师，刚才提到的建立长链接那块，假设线上一个接口每秒并发请求量很大，mysql 一次最多支持多少的并发连接，要是大于这个并发连接数，对于剩下的连接是不排队等待呢？","like_count":0},{"had_liked":false,"id":88773,"user_name":"wtrsakura","can_delete":false,"product_type":"c1","uid":1353110,"ip_address":"","ucode":"27C43591EF599A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq2AjG9LLDd69vIKYV0JlP5iaAWhtZ45m000iclvKPoaZyRrQTQo56I9SCtSj3ZeerNfN4Ek2nUvANw/132","comment_is_top":false,"comment_ctime":1555997140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555997140","product_id":100020801,"comment_content":"423","like_count":0},{"had_liked":false,"id":88551,"user_name":"jacy","can_delete":false,"product_type":"c1","uid":1103456,"ip_address":"","ucode":"0022A8759DDCE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","comment_is_top":false,"comment_ctime":1555940674,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1555940674","product_id":100020801,"comment_content":"分析器中的词法分析步骤","like_count":0},{"had_liked":false,"id":88054,"user_name":"刘冲","can_delete":false,"product_type":"c1","uid":1000439,"ip_address":"","ucode":"0C4F66921AE76C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/f7/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1555829453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555829453","product_id":100020801,"comment_content":"终于拉到了最后，这评论也太多了","like_count":0},{"had_liked":false,"id":87898,"user_name":"☞Barnett☜","can_delete":false,"product_type":"c1","uid":1463780,"ip_address":"","ucode":"573E378E075642","user_header":"https://static001.geekbang.org/account/avatar/00/16/55/e4/3f2ed22d.jpg","comment_is_top":false,"comment_ctime":1555746680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555746680","product_id":100020801,"comment_content":"我觉得是分析器，文中已经给出了说明，在分析器会识别表、列。","like_count":0},{"had_liked":false,"id":87168,"user_name":"o9","can_delete":false,"product_type":"c1","uid":1101332,"ip_address":"","ucode":"E373E82A39BBFE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/14/b488f241.jpg","comment_is_top":false,"comment_ctime":1555524145,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1555524145","product_id":100020801,"comment_content":"有个疑问，单表查询不是查到一条数据向客户端反回一条数据，也就是数据会一条一条 返回，您文章里说要存到结果集中，如果查询返回的记录条数巨多，内存不就爆了吗？","like_count":0},{"had_liked":false,"id":87151,"user_name":"客舟听雨来coding","can_delete":false,"product_type":"c1","uid":1026219,"ip_address":"","ucode":"753F4B779CC416","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a8/ab/5d25cd32.jpg","comment_is_top":false,"comment_ctime":1555517886,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555517886","product_id":100020801,"comment_content":"老师，是分析器返回查询结果给查询缓存器的吗","like_count":0},{"had_liked":false,"id":87066,"user_name":"Survivor","can_delete":false,"product_type":"c1","uid":1016872,"ip_address":"","ucode":"06EF9BDBD90F32","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/28/1175240c.jpg","comment_is_top":false,"comment_ctime":1555506838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555506838","product_id":100020801,"comment_content":"请问一下，分析器指向查询缓存那条线是有什么作用？","like_count":0},{"had_liked":false,"id":86268,"user_name":"君莫惜","can_delete":false,"product_type":"c1","uid":1101408,"ip_address":"","ucode":"FD570371148000","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/60/7d17522d.jpg","comment_is_top":false,"comment_ctime":1555335430,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555335430","product_id":100020801,"comment_content":"分析器，文章说了，分析器会将id与&quot;列id&quot;进行去对应，当全部对应完成之后才会进行分析mysql语法，所以肯定是对应的时候发现对应不上，然后抛出了这个错误","like_count":0},{"had_liked":false,"id":85860,"user_name":"FOCUS","can_delete":false,"product_type":"c1","uid":1140080,"ip_address":"","ucode":"DFE3078B632026","user_header":"https://static001.geekbang.org/account/avatar/00/11/65/70/7e137498.jpg","comment_is_top":false,"comment_ctime":1555260592,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555260592","product_id":100020801,"comment_content":"写得不错 底层的知识特别重要","like_count":0},{"had_liked":false,"id":85512,"user_name":"Geek_WBL","can_delete":false,"product_type":"c1","uid":1473803,"ip_address":"","ucode":"1768A03CEF4CCE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epcLktmsepiaUn9Y45Rsibhqc8t0EvISvrpoKx9ahG7sV1KU7DLbgEIKdTgIpm2GSd9ulsSUiawj4fjg/132","comment_is_top":false,"comment_ctime":1555085487,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555085487","product_id":100020801,"comment_content":"还有一个问题就是MySQL的逻辑架构图<br>1.命中缓存，则直接查询缓存返回<br>2.未命中，则进入到分析器<br>但是架构图上还有一个从分析器到查询缓存的箭头， 这是什么情况才会产生的呢？","like_count":0},{"had_liked":false,"id":85511,"user_name":"Geek_WBL","can_delete":false,"product_type":"c1","uid":1473803,"ip_address":"","ucode":"1768A03CEF4CCE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epcLktmsepiaUn9Y45Rsibhqc8t0EvISvrpoKx9ahG7sV1KU7DLbgEIKdTgIpm2GSd9ulsSUiawj4fjg/132","comment_is_top":false,"comment_ctime":1555085337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555085337","product_id":100020801,"comment_content":"老师，请教个问题：有点迷惑关于执行器部分 《 “查询也会在优化器之前调用 precheck 验证权限”？》<br>我理解的是<br>1. 未命中缓存，在执行器执行的时候做权限验证<br>2. 命中缓存时，在返回结果的时候做权限认证<br>那么上面那句话要怎么理解呢？<br>","like_count":0},{"had_liked":false,"id":84281,"user_name":"Geek_maxwell","can_delete":false,"product_type":"c1","uid":1446442,"ip_address":"","ucode":"15FBD7BE46AC81","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbtcXw5PHzibHcXlupLmnZOYXBLR10U4Hvn5tib14EYlkMBERYgGlgZ63BxgFSBTQmUErfSXibcKl6w/132","comment_is_top":false,"comment_ctime":1554819008,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1554819008","product_id":100020801,"comment_content":"感觉既然都分层了，第一层接入层，接下来分析层，语法分析，词法分析，语义解析，这里词法都解析出来了，应该就会做一下词法的结果可靠性吧，毕竟下一层是优化，优化的话应该是路径最优选择，而不应该再关注是否参数合理了，这样比较符合高内聚的特色吧","like_count":0},{"had_liked":false,"id":84261,"user_name":"bolo","can_delete":false,"product_type":"c1","uid":1357170,"ip_address":"","ucode":"7C91CEA2F1970E","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/72/bb10f3d0.jpg","comment_is_top":false,"comment_ctime":1554814887,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554814887","product_id":100020801,"comment_content":"分析器，会判断表是否存在有这个字段...","like_count":0},{"had_liked":false,"id":83745,"user_name":"Kermit Sun","can_delete":false,"product_type":"c1","uid":1245430,"ip_address":"","ucode":"9B0560FB228629","user_header":"https://static001.geekbang.org/account/avatar/00/13/00/f6/f6cf138c.jpg","comment_is_top":false,"comment_ctime":1554709035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554709035","product_id":100020801,"comment_content":"有个疑问，为何sql执行权限不在分析器阶段判断，该阶段可以获得sql执行的类型，并且能够获得用户的权限，而是要在优化器之后才判断，这不是很影响性能么？以及原文中那句&quot;查询也会在优化器之前调用 precheck 验证权限&quot; 不是很理解。","like_count":0},{"had_liked":false,"id":83472,"user_name":"南山","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1554616549,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1554616549","product_id":100020801,"comment_content":"执行阶段","like_count":0},{"had_liked":false,"id":83395,"user_name":"拯救地球好累","can_delete":false,"product_type":"c1","uid":1339022,"ip_address":"","ucode":"7643439601EF4C","user_header":"https://static001.geekbang.org/account/avatar/00/14/6e/8e/5d309a85.jpg","comment_is_top":false,"comment_ctime":1554556534,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554556534","product_id":100020801,"comment_content":"我认为是执行器，词法分析和语法分析并不知晓具体的数据模型信息。","like_count":0},{"had_liked":false,"id":83002,"user_name":"陈","can_delete":false,"product_type":"c1","uid":1304668,"ip_address":"","ucode":"81A54B3BA9C721","user_header":"https://static001.geekbang.org/account/avatar/00/13/e8/5c/561caff2.jpg","comment_is_top":false,"comment_ctime":1554369794,"is_pvip":false,"replies":[{"id":"30008","content":"嗯，不是直接使用的，这个是c的api<br><br>https:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;5.7&#47;en&#47;mysql-reset-connection.html","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1554431755,"ip_address":"","comment_id":83002,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554369794","product_id":100020801,"comment_content":"老师，现在看第二遍了，看得比较细，在测试中突然发现mysql_reset_connection()这个函数不会用，这个不能用select，看官网是api接口，这个怎么执行呢在java中。百度都没找到，谢谢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445813,"discussion_content":"嗯，不是直接使用的，这个是c的api\n\nhttps://dev.mysql.com/doc/refman/5.7/en/mysql-reset-connection.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554431755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82970,"user_name":"Flash","can_delete":false,"product_type":"c1","uid":1236163,"ip_address":"","ucode":"E285075C9E0B02","user_header":"https://static001.geekbang.org/account/avatar/00/12/dc/c3/e4ba51d5.jpg","comment_is_top":false,"comment_ctime":1554361961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554361961","product_id":100020801,"comment_content":"评论区很多同学有点咬文嚼字，说是因为在执行器阶段会“打开表”，所以他们觉得在执行器阶段才会验证。我觉得是分析器&quot;词法分析&quot;阶段，就会判断出这个列或者表是否存在。","like_count":0},{"had_liked":false,"id":82924,"user_name":"woaiwnagqiu","can_delete":false,"product_type":"c1","uid":1484333,"ip_address":"","ucode":"2FE9FB90F9EAD6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Ccdlzibsv0umJB4QeX0K6JDg77STBwaMbTk9WCRRlFiaLCNY0DNUWEH4o9ktOeRYuFbSYuEtOhWlu7Fic2BpLREeg/132","comment_is_top":false,"comment_ctime":1554349383,"is_pvip":false,"replies":[{"id":"30012","content":"嗯 工程实现上有一个precheck，提前判断了一下","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1554431890,"ip_address":"","comment_id":82924,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554349383","product_id":100020801,"comment_content":"老师，我有一个问题，判断是否有这个表的select权限是在执行器这个是不是不合理<br>前面的优化器都走完了，如果在没有执行权限岂不是白走了，多影响效率","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445777,"discussion_content":"嗯 工程实现上有一个precheck，提前判断了一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554431890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82470,"user_name":"小四","can_delete":false,"product_type":"c1","uid":1259428,"ip_address":"","ucode":"A2F56965EEE3CF","user_header":"","comment_is_top":false,"comment_ctime":1554219052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554219052","product_id":100020801,"comment_content":"老师，您好，您这里说的执行阶段让我很困惑，您在括号中又说查询也会在优化器之前调用percheck验证权限，这样容易让人误会真的是在执行器阶段才做的权限验证，求老师解答一下","like_count":0},{"had_liked":false,"id":82465,"user_name":"小四","can_delete":false,"product_type":"c1","uid":1259428,"ip_address":"","ucode":"A2F56965EEE3CF","user_header":"","comment_is_top":false,"comment_ctime":1554218407,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554218407","product_id":100020801,"comment_content":"想问下老师的版本是多少，我在MySQL5.7.25<br>发现mysql_percheck方法是在mysql_execte_command中执行的，而optimizer方法在后面，而文中讲执行阶段才会去检查权限，所以就很不解","like_count":0},{"had_liked":false,"id":82027,"user_name":"Lane","can_delete":false,"product_type":"c1","uid":1008257,"ip_address":"","ucode":"F70459D1BBD9F4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg","comment_is_top":false,"comment_ctime":1554105708,"is_pvip":true,"replies":[{"id":"30018","content":"对","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1554432432,"ip_address":"","comment_id":82027,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554105708","product_id":100020801,"comment_content":"server层调引擎接口取第一行，判断条件，重复，直到不满足。rows_examined不等于引擎层扫描行数。<br><br>问：条件判断是在server层？是不是可以理解为：B+树是在引擎层，引擎层取到索引userid=1的主键id=1，回表取到id=1的所有字段，然后直接返回给server层，server层来判断sex和age等字段？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445433,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554432432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81838,"user_name":"Geek_cxz","can_delete":false,"product_type":"c1","uid":1482158,"ip_address":"","ucode":"AAEC9BDEE492E3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q8tVHVrialm0x9iaF9aLoibq8MQ7oI1QPZMHz4EabKPkHdy6gFklQTUXIEAp3iaRKficRLhCravEp56u6euXMOgavbA/132","comment_is_top":false,"comment_ctime":1554047289,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554047289","product_id":100020801,"comment_content":"请问一下<br>1.如何解释使用短连接具体带来的坏处呢，频繁建立连接带来的影响是会导致连接数不够用吗，那么连接数又是有什么控制的呢？<br>2.长连接和短连接是有参数控制吗，这个连接是由应用程序自己维护，还是MySql帮我们维护的呢，假如我在短时间内执行了一个Sql，那么那么是随机选一个未断开的连接去执行的吗","like_count":0},{"had_liked":false,"id":81748,"user_name":"Danpier","can_delete":false,"product_type":"c1","uid":1463474,"ip_address":"","ucode":"11E208FDE34961","user_header":"https://static001.geekbang.org/account/avatar/00/16/54/b2/5ea0b709.jpg","comment_is_top":false,"comment_ctime":1554025423,"is_pvip":false,"replies":[{"id":"29642","content":"👍","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1554047670,"ip_address":"","comment_id":81748,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554025423","product_id":100020801,"comment_content":"单看留言就能感受到这个专栏的质量之高了，耐心看完评论，其他人都把我好几个疑问提出来了，QA互动也能学到很多干货。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445326,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554047670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81319,"user_name":"林贻民","can_delete":false,"product_type":"c1","uid":1202213,"ip_address":"","ucode":"F7185C61CAE4D0","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/25/2088864b.jpg","comment_is_top":false,"comment_ctime":1553859761,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553859761","product_id":100020801,"comment_content":"老师您好,我有个疑问:我看前面有人说:&quot;创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column”&quot;<br><br>由于k列是不存在的,那么说明这条语句不会执行到优化器和执行器部分,而此时给出了没有权限,那岂不是说在分析器部分也进行了权限验证吗?","like_count":0},{"had_liked":false,"id":80242,"user_name":"williamcai","can_delete":false,"product_type":"c1","uid":1158294,"ip_address":"","ucode":"B158F52C2D39BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/96/46b13896.jpg","comment_is_top":false,"comment_ctime":1553644470,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553644470","product_id":100020801,"comment_content":"应该在分析器阶段，如果到了其他阶段，资源浪费严重","like_count":0},{"had_liked":false,"id":78774,"user_name":"云之影","can_delete":false,"product_type":"c1","uid":1324795,"ip_address":"","ucode":"71432D65855A68","user_header":"https://static001.geekbang.org/account/avatar/00/14/36/fb/e3cc49a2.jpg","comment_is_top":false,"comment_ctime":1553238933,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553238933","product_id":100020801,"comment_content":"按照老师的讲解，我觉得是不是把权限判断放到分析器后合理些？这样子不用先匹配查询缓存，然后才发现权限不够，也不用等优化完成，执行前再判断权限","like_count":0},{"had_liked":false,"id":78526,"user_name":"小俊","can_delete":false,"product_type":"c1","uid":1463862,"ip_address":"","ucode":"3F026B0F7AF804","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/36/8ceccad1.jpg","comment_is_top":false,"comment_ctime":1553167279,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553167279","product_id":100020801,"comment_content":"老师 是判断用户是否有查询权限在分线器，判断对具体表有没有查询权限在执行器吗？","like_count":0},{"had_liked":false,"id":78315,"user_name":"木木","can_delete":false,"product_type":"c1","uid":1445743,"ip_address":"","ucode":"364F67C6186D22","user_header":"https://static001.geekbang.org/account/avatar/00/16/0f/6f/897a4592.jpg","comment_is_top":false,"comment_ctime":1553130012,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553130012","product_id":100020801,"comment_content":"分析器吧","like_count":0},{"had_liked":false,"id":78131,"user_name":"张仕华","can_delete":false,"product_type":"c1","uid":1054248,"ip_address":"","ucode":"8D41E96A5889FC","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/28/c11e7aae.jpg","comment_is_top":false,"comment_ctime":1553075882,"is_pvip":false,"replies":[{"id":"28901","content":"分析器那条线是“更新”查询缓存","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1553415396,"ip_address":"","comment_id":78131,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553075882","product_id":100020801,"comment_content":"逻辑架构图中,查询缓存有连接器和分析器两条线，是否说明有时候直接从连接器去查询缓存查看是否命中，有时候会先经过分析器之后再去找查询缓存？如果是的话，为什么会有两种情况呢？缓存的key是一条sql语句吗？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443980,"discussion_content":"分析器那条线是“更新”查询缓存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553415396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77397,"user_name":"Tomcat","can_delete":false,"product_type":"c1","uid":1346364,"ip_address":"","ucode":"B270CEED693256","user_header":"https://static001.geekbang.org/account/avatar/00/14/8b/3c/0462eca7.jpg","comment_is_top":false,"comment_ctime":1552918736,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552918736","product_id":100020801,"comment_content":"很明显是词法分析器。因为你输入的k，分析器“不认识”！字段不存在，所以它不懂的可以理解吧？","like_count":0},{"had_liked":false,"id":77138,"user_name":"委员","can_delete":false,"product_type":"c1","uid":1339254,"ip_address":"","ucode":"FD1F8FDA42E7ED","user_header":"https://static001.geekbang.org/account/avatar/00/14/6f/76/6f810155.jpg","comment_is_top":false,"comment_ctime":1552868653,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552868653","product_id":100020801,"comment_content":"为什么mysql8会把query cache去掉？是因为希望让缓存组件去做这部分的事情，让专业的人做专业的事？这是一种发展方向吗？未来可能再被剔除的功能是什么呢？","like_count":0},{"had_liked":false,"id":76242,"user_name":"永光","can_delete":false,"product_type":"c1","uid":1102702,"ip_address":"","ucode":"0C54531ABED1B0","user_header":"https://static001.geekbang.org/account/avatar/00/10/d3/6e/281b85aa.jpg","comment_is_top":false,"comment_ctime":1552555752,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552555752","product_id":100020801,"comment_content":"rows_examined:执行器每次调用引擎获取数据行时累加的。<br>问题：是根据执行器执行次数累加的还是记录数？<br>如果根据执行次数累加，那怎么和扫描次数对比？莫非是执行器执行一次最多返回一条数据？<br>引申出的问题：如果事实是每次执行器调用引擎接口最多只返回一条，那么为什么不设计成一次返回多条？","like_count":0},{"had_liked":false,"id":75884,"user_name":"Sinyo","can_delete":false,"product_type":"c1","uid":1307297,"ip_address":"","ucode":"57B243E7AB86A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132","comment_is_top":false,"comment_ctime":1552487850,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552487850","product_id":100020801,"comment_content":"分析器先会做“词法分析”。你输入的是由多个字符串和空格组成的一条 SQL 语句，MySQL 需要识别出里面的字符串分别是什么，代表什么。<br>MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。<br><br>老师好，请问这里的词法分析为什么不会发现select关键字有问题呢？如果词法分析发现问题了，为什么在语法分析才报错呢？","like_count":0},{"had_liked":false,"id":75751,"user_name":"永光","can_delete":false,"product_type":"c1","uid":1102702,"ip_address":"","ucode":"0C54531ABED1B0","user_header":"https://static001.geekbang.org/account/avatar/00/10/d3/6e/281b85aa.jpg","comment_is_top":false,"comment_ctime":1552463654,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552463654","product_id":100020801,"comment_content":"老师您好，<br>您提到：有些时候+MySQL+占用内存涨得特别快，这是因为+MySQL+在执行过程中临时使用的内存是管理在连接对象里面的。可以通过执行mysql_reset_connection来重新初始化连接资源<br>问题：既然是临时使用的内存，mysql为什么不直接用完就释放呀？","like_count":0},{"had_liked":false,"id":75688,"user_name":"pearl","can_delete":false,"product_type":"c1","uid":1034632,"ip_address":"","ucode":"56D9D9D92DFE5E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c9/88/22fde45c.jpg","comment_is_top":false,"comment_ctime":1552450217,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552450217","product_id":100020801,"comment_content":"1.在客户端想数据库发起连接请求的时候，做了一次权限验证(针对用户对整个数据库的权限）<br>2.在执行器查询语句的时候又针对用户对改表的权限进行了验证。<br>以上这样理解对吗？<br>另外，看见文章里提到“缓存中有，就在缓存验证”是不是每次对同一张表执行操作时都要重新验证一次。就如同客户端链接数据库一但断开要重新连接（权限验证）一样。<br>谢谢","like_count":0},{"had_liked":false,"id":74967,"user_name":"谷子","can_delete":false,"product_type":"c1","uid":1067128,"ip_address":"","ucode":"B7D98A6489DBC0","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/78/5f27744b.jpg","comment_is_top":false,"comment_ctime":1552325193,"is_pvip":false,"replies":[{"id":"27539","content":"是c的api","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1552407331,"ip_address":"","comment_id":74967,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552325193","product_id":100020801,"comment_content":"mysql_reset_connection  请问这个命令怎么执行？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442761,"discussion_content":"是c的api","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552407331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74740,"user_name":"夏雨润心","can_delete":false,"product_type":"c1","uid":1439044,"ip_address":"","ucode":"DC629D23BE3AF6","user_header":"https://static001.geekbang.org/account/avatar/00/15/f5/44/19858687.jpg","comment_is_top":false,"comment_ctime":1552289870,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552289870","product_id":100020801,"comment_content":"肯定是分析器 。","like_count":0},{"had_liked":false,"id":74554,"user_name":"姚伟","can_delete":false,"product_type":"c1","uid":1324091,"ip_address":"","ucode":"5218AE2384AE92","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/3b/a5fddd35.jpg","comment_is_top":false,"comment_ctime":1552233565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552233565","product_id":100020801,"comment_content":"丁老师，复读了您的这讲内容，有个问题想请教。<br>1、对于wait_timeout和interactive_timeout如果都设置了1小时，我在客户端有个查询的query一直查询了1小时还没查完，是不是mysql就会把这个会话断掉？如果断掉了会话，是不是只有在客户端代码设置了自动重新连接才能连上？那么重新连上之后，之前查询的会话是重新开始查还是会继续之前的查询下去？<br><br>2、还有一个问题，mysql客户端维持心跳是怎么做的？<br><br>谢谢。","like_count":0},{"had_liked":false,"id":74387,"user_name":"T","can_delete":false,"product_type":"c1","uid":1253758,"ip_address":"","ucode":"A2504CACA70D86","user_header":"https://static001.geekbang.org/account/avatar/00/13/21/7e/33f1faca.jpg","comment_is_top":false,"comment_ctime":1552210523,"is_pvip":false,"replies":[{"id":"27196","content":"1. 最好是在交互模式里面输入密码<br>2. 对，测试或开发环境，最好也是交互模式里面输入密码😆","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1552229039,"ip_address":"","comment_id":74387,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552210523","product_id":100020801,"comment_content":"“输完命令之后，你就需要在交互对话里面输入密码。虽然密码也可以...”<br>老师您好，小白想问两个问题。<br>如果是生产上面的数据库，为了查询，不在交互模式里直接输入密码，那么按照正确流程是如何进行连接的？场景是：在生产环境访问数据库。<br>发散一下，如果为了要养成良好习惯，我们在测试或者开发环境也不直接输入密码，<br>那在测试或者开发环境怎样访问数据库是正确的？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442554,"discussion_content":"1. 最好是在交互模式里面输入密码\n2. 对，测试或开发环境，最好也是交互模式里面输入密码😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552229039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73778,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1115284,"ip_address":"","ucode":"D412FB8BF1CEB8","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/94/c04ddcf6.jpg","comment_is_top":false,"comment_ctime":1551979579,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551979579","product_id":100020801,"comment_content":"老师 根据文章内容，我理解的流程是如果写一个语法错误或者如你思考题所说的的那样不存的列时，会在分析器阶段被查出来。<br>这时假设权限都是没问题，那么这种抛错还是要等到进入优化器之前做的那次precheck后抛出吗。而不是分析器阶段发现有这两种错误后立马进行鉴权然后抛出错误吧。 不知道是否正确","like_count":0},{"had_liked":false,"id":73329,"user_name":"icephobia","can_delete":false,"product_type":"c1","uid":1284212,"ip_address":"","ucode":"CD383B35994331","user_header":"https://static001.geekbang.org/account/avatar/00/13/98/74/6edfe4c1.jpg","comment_is_top":false,"comment_ctime":1551862002,"is_pvip":false,"replies":[{"id":"26692","content":"就是mysql_real_connect返回的句柄对象","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551875537,"ip_address":"","comment_id":73329,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551862002","product_id":100020801,"comment_content":"查了文档 int mysql_reset_connection(MYSQL *mysql); 这个函数的文档，没搞明白如何调用。希望老师能回复一下，并讲讲MYSQL *mysql这个参数。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442027,"discussion_content":"就是mysql_real_connect返回的句柄对象","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551875537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73214,"user_name":"👽","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1551841496,"is_pvip":false,"replies":[{"id":"27151","content":"这个是单指全表扫描的情况，后面几篇索引相关的你看看哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1552147243,"ip_address":"","comment_id":73214,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551841496","product_id":100020801,"comment_content":"看了本文，有一点理解的不是很到位。就是文中描述执行器的执行过程：<br>检索第一行的id，是否符合条件，如果符合，则存在结果集中。<br>这样的话，是不是就相当于吧一个list遍历然后返回符合条件的值？<br>如果是这样的话，那使用数据库的优势仅仅是为了持久化嘛？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441971,"discussion_content":"这个是单指全表扫描的情况，后面几篇索引相关的你看看哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552147243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72847,"user_name":"不能扮演天使","can_delete":false,"product_type":"c1","uid":1046172,"ip_address":"","ucode":"9922330BFF7FFB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f6/9c/b457a937.jpg","comment_is_top":false,"comment_ctime":1551747414,"is_pvip":false,"replies":[{"id":"26396","content":"你是说sort_buffer吧？是的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551751023,"ip_address":"","comment_id":72847,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551747414","product_id":100020801,"comment_content":"老师请问下排序属不属于连接对象临时使用的内存？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441783,"discussion_content":"你是说sort_buffer吧？是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551751023,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72724,"user_name":"Geek_66cfcf","can_delete":false,"product_type":"c1","uid":1303965,"ip_address":"","ucode":"DA38468CCAFFE4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLfogWrXZbZJjau0Z5fGhw04QIHAnZ3DJyvmQ96P1surczqUROeApu3ia9aAIIccKa1uDiaald58jGQ/132","comment_is_top":false,"comment_ctime":1551705643,"is_pvip":true,"replies":[{"id":"27040","content":"不晚😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1552092547,"ip_address":"","comment_id":72724,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551705643","product_id":100020801,"comment_content":"写的很详细，评论部分都有解答，老师真的是好老师，好多问题也都问的很精彩，真的应该早点过来","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441710,"discussion_content":"不晚😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552092547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72718,"user_name":"Gordon","can_delete":false,"product_type":"c1","uid":1447449,"ip_address":"","ucode":"5CC8D40FA9CFBB","user_header":"https://static001.geekbang.org/account/avatar/00/16/16/19/e6a99866.jpg","comment_is_top":false,"comment_ctime":1551702332,"is_pvip":false,"replies":[{"id":"26372","content":"👌","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551725427,"ip_address":"","comment_id":72718,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551702332","product_id":100020801,"comment_content":"按道理应该是分析器，都已经识别出table了，而且这种错误拦截在越早期越好","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441707,"discussion_content":"👌","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551725427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72611,"user_name":"我非青蝗","can_delete":false,"product_type":"c1","uid":1177920,"ip_address":"","ucode":"AE82D0BCE31E19","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/40/5dd3538b.jpg","comment_is_top":false,"comment_ctime":1551677921,"is_pvip":false,"replies":[{"id":"26825","content":"正常不会的，会自动失效查询缓存的呀","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551940013,"ip_address":"","comment_id":72611,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551677921","product_id":100020801,"comment_content":"曾经遇到一个Mysql缓存问题： 就是从Mysql查询出来的与表里看到的数据不一致，找了半天原因，最后把 Mysql 缓存清空就好了。那么Mysql的缓存有更新的话，为什么会出现和表里的实际数据不一致的情况呢？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441659,"discussion_content":"正常不会的，会自动失效查询缓存的呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551940013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71792,"user_name":"Max","can_delete":false,"product_type":"c1","uid":1184664,"ip_address":"","ucode":"5E9644DC00B7C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/13/98/e6240c55.jpg","comment_is_top":false,"comment_ctime":1551433798,"is_pvip":true,"replies":[{"id":"26025","content":"是的，会","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551456848,"ip_address":"","comment_id":71792,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551433798","product_id":100020801,"comment_content":"老师，容小白我对查询缓存提个问题:<br>select a from t where c=&#39;p1&#39;;<br>select a from t where c=&#39;p2&#39;;<br>这两条sql是不会分别建立缓存？从老师的讲解我的答案是：是，会分别建立缓存。<br>因为where条件不一样，结果集可能就不一样","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441332,"discussion_content":"是的，会","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551456848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71610,"user_name":"pearl","can_delete":false,"product_type":"c1","uid":1034632,"ip_address":"","ucode":"56D9D9D92DFE5E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c9/88/22fde45c.jpg","comment_is_top":false,"comment_ctime":1551401174,"is_pvip":false,"replies":[{"id":"25733","content":"不是哦，（这样就bug了）<br><br>使用了sql_cache，如果缓存查不到，就走到正常的流程继续执行了","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551404027,"ip_address":"","comment_id":71610,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551401174","product_id":100020801,"comment_content":"如果使用了SQL_cache功能是仅在缓存中查询嘛，如果缓存不存在结果，也不去库里重新查询嘛？谢谢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441232,"discussion_content":"不是哦，（这样就bug了）\n\n使用了sql_cache，如果缓存查不到，就走到正常的流程继续执行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551404027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71076,"user_name":"拉欧","can_delete":false,"product_type":"c1","uid":1206605,"ip_address":"","ucode":"40996A8093A95F","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/4d/81c44f45.jpg","comment_is_top":false,"comment_ctime":1551259506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551259506","product_id":100020801,"comment_content":"应该是在分析器中报出来的","like_count":0},{"had_liked":false,"id":70938,"user_name":"CN....","can_delete":false,"product_type":"c1","uid":1228489,"ip_address":"","ucode":"2C265A33D4C642","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/c9/505bfb99.jpg","comment_is_top":false,"comment_ctime":1551230346,"is_pvip":false,"replies":[{"id":"25426","content":"内存是一起发给客户端的，<br>客户端一般是一条条读的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551235526,"ip_address":"","comment_id":70938,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551230346","product_id":100020801,"comment_content":"select * from table 这样简单的查询语句，查询结果是一起放到结果集一起返回到客户端，还是一条一条返回客户端，谢谢老师","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440908,"discussion_content":"内存是一起发给客户端的，\n客户端一般是一条条读的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551235526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70858,"user_name":"forcht","can_delete":false,"product_type":"c1","uid":1395849,"ip_address":"","ucode":"4CECBEB8251364","user_header":"","comment_is_top":false,"comment_ctime":1551195016,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551195016","product_id":100020801,"comment_content":"是在词法分析阶段吧，编译原理是个好东西","like_count":0},{"had_liked":false,"id":70328,"user_name":"可可","can_delete":false,"product_type":"c1","uid":1439947,"ip_address":"","ucode":"DAEF22B24A6317","user_header":"https://static001.geekbang.org/account/avatar/00/15/f8/cb/506edc3c.jpg","comment_is_top":false,"comment_ctime":1551076032,"is_pvip":false,"replies":[{"id":"25104","content":"官方版本还没有支持直接看内存消耗的，<br>不能再shell执行的，是一个c的api<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551092489,"ip_address":"","comment_id":70328,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551076032","product_id":100020801,"comment_content":"mysql connection 内存占用过多，有没有办法在shell中看到具体的内存占用呢？<br>mysql_reset_connection 能不能再shell中执行？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440564,"discussion_content":"官方版本还没有支持直接看内存消耗的，\n不能再shell执行的，是一个c的api\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551092489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70198,"user_name":"9080","can_delete":false,"product_type":"c1","uid":1114072,"ip_address":"","ucode":"D4DFBBC1B8394D","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/d8/fa77b4eb.jpg","comment_is_top":false,"comment_ctime":1551048361,"is_pvip":false,"replies":[{"id":"25020","content":"是在连接器阶段，<br>建议全部设置为 skip-name-resolve<br><br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551052899,"ip_address":"","comment_id":70198,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551048361","product_id":100020801,"comment_content":"老师您好，skip-name-resolve这个参数是不是都需要配置优化呢，之前由于这个参数没有配置导致sql查询特别慢，好多接口也因为这个响应时间特别长，请问老师域名解析是在连接器阶段吗？还有这个参数是否为必须优化参数呢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440486,"discussion_content":"是在连接器阶段，\n建议全部设置为 skip-name-resolve\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551052899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69398,"user_name":"陨落之光","can_delete":false,"product_type":"c1","uid":1100304,"ip_address":"","ucode":"F820203053C619","user_header":"https://static001.geekbang.org/account/avatar/00/10/ca/10/689441b6.jpg","comment_is_top":false,"comment_ctime":1550734984,"is_pvip":false,"replies":[{"id":"24659","content":"打开general log直接看日志😆","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1550738640,"ip_address":"","comment_id":69398,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550734984","product_id":100020801,"comment_content":"我是小白啦，我想问下使用toad啊这样的工具还有在脚本里面连接的时候是怎么设置连接时长的呢？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440099,"discussion_content":"打开general log直接看日志😆","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550738640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68288,"user_name":"猫小印","can_delete":false,"product_type":"c1","uid":1317469,"ip_address":"","ucode":"79CC4BFFA50249","user_header":"https://static001.geekbang.org/account/avatar/00/14/1a/5d/07f7968b.jpg","comment_is_top":false,"comment_ctime":1550478206,"is_pvip":false,"replies":[{"id":"25000","content":"在优化器之前有做","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1551001969,"ip_address":"","comment_id":68288,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550478206","product_id":100020801,"comment_content":"@尼古拉斯·赵...【我创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column”，是不是可以说明是在打开表之后才判断读取的列不存在？】--的解释：是在分析器分析出字段存不存在之前优先判断权限？和@郭↓的解释是不是冲突了？<br> @郭【有个问题不太明白，为什么对权限的检查不在优化器之前做？】","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439609,"discussion_content":"在优化器之前有做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551001969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63915,"user_name":"杰之7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1548592680,"is_pvip":false,"replies":[{"id":"22599","content":"一般你提问题的时候如果可以把报错信息贴出来最好啦。<br>可以直接贴文字，更好的是截图，发个微博，然后贴地址在这边也可以","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1548593906,"ip_address":"","comment_id":63915,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548592680","product_id":100020801,"comment_content":"老师，连接操作我没有理解，mysql -h$ip -P$port -u$user -p,在输入查询语句之后，输入连接操作，显示语法错误，请老师给予更正。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437761,"discussion_content":"一般你提问题的时候如果可以把报错信息贴出来最好啦。\n可以直接贴文字，更好的是截图，发个微博，然后贴地址在这边也可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548593906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63156,"user_name":"OK哥","can_delete":false,"product_type":"c1","uid":1391227,"ip_address":"","ucode":"500C6FF6835D3A","user_header":"https://static001.geekbang.org/account/avatar/00/15/3a/7b/29bae922.jpg","comment_is_top":false,"comment_ctime":1548291083,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548291083","product_id":100020801,"comment_content":"以前用了很久 没有去了解过这些基础原理","like_count":0},{"had_liked":false,"id":62117,"user_name":"二马","can_delete":false,"product_type":"c1","uid":1006802,"ip_address":"","ucode":"4F1DF8732242A1","user_header":"","comment_is_top":false,"comment_ctime":1547942910,"is_pvip":false,"replies":[{"id":"21984","content":"那你这个就是典型的短连接了<br><br>建议改成长链接方案","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547962335,"ip_address":"","comment_id":62117,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547942910","product_id":100020801,"comment_content":"怎样查看是长连接还是短连接，定期断开长连接怎样配置?另外最近做性能测试时发现大并发用户同时连接MySQL时会有部分用户连接超时(设置的最大连接数1000，实际使用的最大连接不会超过200)，关于MySQL连接管理这块该怎样优化?谢谢！","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437105,"discussion_content":"那你这个就是典型的短连接了\n\n建议改成长链接方案","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547962335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58619,"user_name":"待我瘦到八十斤","can_delete":false,"product_type":"c1","uid":1273949,"ip_address":"","ucode":"51553E48C2237E","user_header":"https://static001.geekbang.org/account/avatar/00/13/70/5d/2c313dad.jpg","comment_is_top":false,"comment_ctime":1547137776,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547137776","product_id":100020801,"comment_content":"明显是分析器，MYSQL没有命中查询缓存往下走的时候是走到分析器，对SQL语句进行词法分析。分析是你的增删改查等行为，接着识别表名，然后识别表里的列。找不到列的时候就报这个错了","like_count":0},{"had_liked":false,"id":57491,"user_name":"Vincent","can_delete":false,"product_type":"c1","uid":1135159,"ip_address":"","ucode":"CD8B84A57A6A0C","user_header":"https://static001.geekbang.org/account/avatar/00/11/52/37/13b4c8aa.jpg","comment_is_top":false,"comment_ctime":1546822537,"is_pvip":false,"replies":[{"id":"21103","content":"对的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1547117547,"ip_address":"","comment_id":57491,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546822537","product_id":100020801,"comment_content":"课后习题答案: 分析器的语法分析阶段","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435604,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547117547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57354,"user_name":"尔东","can_delete":false,"product_type":"c1","uid":1360829,"ip_address":"","ucode":"C0983536C63E2A","user_header":"https://static001.geekbang.org/account/avatar/00/14/c3/bd/ec8b3044.jpg","comment_is_top":false,"comment_ctime":1546761693,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546761693","product_id":100020801,"comment_content":"应该是分析器，不过不确定是词法分析阶段还是语法分析阶段","like_count":0},{"had_liked":false,"id":56997,"user_name":"lee","can_delete":false,"product_type":"c1","uid":1182383,"ip_address":"","ucode":"CD672BDB1B58F2","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/af/6f244997.jpg","comment_is_top":false,"comment_ctime":1546595947,"is_pvip":true,"replies":[{"id":"20570","content":"这个可以explain验证一下","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1546609653,"ip_address":"","comment_id":56997,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546595947","product_id":100020801,"comment_content":"老师有个问题咨询一下，select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;像这个SQL，如果用INNER JOIN &#47;LEFT JOIN &#47;RIGHT JOIN等也会被优化器优化如何连接吗<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435352,"discussion_content":"这个可以explain验证一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546609653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56399,"user_name":"涛哥哥","can_delete":false,"product_type":"c1","uid":1361159,"ip_address":"","ucode":"329A1384E3AB5E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqJobg767PUeqrqQQ4B6YvMatj2SRyOicKZZ4gWTf30dMketiaj58Gc3RFTmckGxAXlL9ERSxGovq9g/132","comment_is_top":false,"comment_ctime":1546437210,"is_pvip":false,"replies":[{"id":"20317","content":"这里在工程实现上，权限有提前判断","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1546440588,"ip_address":"","comment_id":56399,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1546437210","product_id":100020801,"comment_content":"老师，故意将一个字段名写错，并且不赋予权限，您说会报权限不足错误。然，您又说检查字段名是在分析阶段，检查权限是在执行阶段，，不明白分析阶段异常，为什么还要走执行阶段呢？望老师解答，微笑～","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435020,"discussion_content":"这里在工程实现上，权限有提前判断","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546440588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1911661,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDOKcx20Xxmu5j8WxiafoYvo3bIAFDg8OeicRic1icD597QuMC9O8FyV2Al9RxNfVZXK0gkGUx6M3CVQ/132","nickname":"多年以后","note":"","ucode":"D70E7A1ABE0F39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550070,"discussion_content":"在优化器之前有个precheck验证权限吧，在这里应该就判断了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644374892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56179,"user_name":"kevinsu","can_delete":false,"product_type":"c1","uid":1078506,"ip_address":"","ucode":"BAD46B815D6A5C","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/ea/10661bdc.jpg","comment_is_top":false,"comment_ctime":1546400374,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546400374","product_id":100020801,"comment_content":"mysql主要包括： Server层+存储引擎层。<br>Server层：连接器，查询缓存，分析器，优化器，执行器。<br>存储引擎层：MyISAM，InnoDB，Memory等。<br><br>例子总结：<br>连接器<br>查询缓存<br>语法分析，要做什么。<br>优化器，怎么做。<br>执行器，做。<br><br>最后那个问题个人觉得是没有在所有column中找到k。","like_count":0},{"had_liked":false,"id":55680,"user_name":"大宝","can_delete":false,"product_type":"c1","uid":1102771,"ip_address":"","ucode":"224458E5D1A35A","user_header":"https://static001.geekbang.org/account/avatar/00/10/d3/b3/4f5550c0.jpg","comment_is_top":false,"comment_ctime":1546260285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546260285","product_id":100020801,"comment_content":"我觉得是优化器，因为这里应该属于语法分析，但是也引出一个问题，是否在表结构修改的时候，也同样会对这一层的某些配置做更改呢？","like_count":0},{"had_liked":false,"id":55393,"user_name":"Klaus","can_delete":false,"product_type":"c1","uid":1326597,"ip_address":"","ucode":"BF2683C893E20A","user_header":"https://static001.geekbang.org/account/avatar/00/14/3e/05/cc934cb3.jpg","comment_is_top":false,"comment_ctime":1546157417,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546157417","product_id":100020801,"comment_content":"文章中有说到在执行器阶段才会打开表，取出一行一行的数据，那分析器的时候表都没打开，是如何知道是否有查询语句中的那个字段呢？","like_count":0},{"had_liked":false,"id":55030,"user_name":"Jarry","can_delete":false,"product_type":"c1","uid":1197928,"ip_address":"","ucode":"EBA85507E78849","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/68/bfc0d0cf.jpg","comment_is_top":false,"comment_ctime":1546004405,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546004405","product_id":100020801,"comment_content":"就是我想学的内容，很棒！","like_count":0},{"had_liked":false,"id":55018,"user_name":"fdconan","can_delete":false,"product_type":"c1","uid":1244596,"ip_address":"","ucode":"01C71C6E9FD1E4","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLv9HJIW4OACkjlwOQJ9cU7HzvaDFYkACWCib2lzOMef9ZiaGDTVFqjPicpVK5KDRbBRVGGHrMHQO1Rw/132","comment_is_top":false,"comment_ctime":1546000912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546000912","product_id":100020801,"comment_content":"请问老师，rows_examined跟explain出来的rows有什么不同吗？","like_count":0},{"had_liked":false,"id":54861,"user_name":"luoChao","can_delete":false,"product_type":"c1","uid":1322823,"ip_address":"","ucode":"E8A46B41B3178D","user_header":"https://static001.geekbang.org/account/avatar/00/14/2f/47/eadc8482.jpg","comment_is_top":false,"comment_ctime":1545972552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545972552","product_id":100020801,"comment_content":"缓存失效应该是从查询缓存指向→分析器。","like_count":0},{"had_liked":false,"id":54468,"user_name":"吴青","can_delete":false,"product_type":"c1","uid":1048965,"ip_address":"","ucode":"26DBF37AAF0000","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/85/a2279772.jpg","comment_is_top":false,"comment_ctime":1545876834,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545876834","product_id":100020801,"comment_content":"分析器分析sql对错","like_count":0},{"had_liked":false,"id":54366,"user_name":"Leo","can_delete":false,"product_type":"c1","uid":1046404,"ip_address":"","ucode":"30D61E85A98C45","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/84/1c56c8a5.jpg","comment_is_top":false,"comment_ctime":1545835524,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545835524","product_id":100020801,"comment_content":"如果你用的是 MySQL 5.7 或更新版本，可以在每次执行一个比较大的操作后，通过执行 mysql_reset_connection 来重新初始化连接资源。<br><br>这个是要如何开启？","like_count":0},{"had_liked":false,"id":54057,"user_name":"Hyun","can_delete":false,"product_type":"c1","uid":1014376,"ip_address":"","ucode":"EF6E7F6D17793D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/68/f2bc8fcb.jpg","comment_is_top":false,"comment_ctime":1545790118,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1545790118","product_id":100020801,"comment_content":"当一个数据库连接进行了大量的操作，比如查询，导入等费内存的操作之后，会占用大量的内存。此时系统会将这连接杀死。作者的意思是每过一段时间 就要进行数据库连接的重启，以保证连接按需操作及时高效完成。问题：为什么连接上操作完毕之后，系统不自动释放查询等占用的内存，是因为系统无法感知占用内存是否还有用，还是取决于连接上是否自带有释放内存的操作，比如开了一张临时表，塞了大量数据，结果临时表用完，没有及时丢弃？","like_count":0},{"had_liked":false,"id":53782,"user_name":"SaimSaim","can_delete":false,"product_type":"c1","uid":1344007,"ip_address":"","ucode":"E4755472EF6C1E","user_header":"https://static001.geekbang.org/account/avatar/00/14/82/07/5940b400.jpg","comment_is_top":false,"comment_ctime":1545724379,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545724379","product_id":100020801,"comment_content":"答案是优化器的话 我可不可以这么理解 分析器做了词法,语法分析 而语义分析(编译原理概念)这一步工作在优化器中完成","like_count":0},{"had_liked":false,"id":53663,"user_name":"悠悠","can_delete":false,"product_type":"c1","uid":1041765,"ip_address":"","ucode":"A9B8EF7A275AEF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/65/cf1243f4.jpg","comment_is_top":false,"comment_ctime":1545707089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545707089","product_id":100020801,"comment_content":"在分析层检查表结构","like_count":0},{"had_liked":false,"id":53021,"user_name":"沁雨烟城","can_delete":false,"product_type":"c1","uid":1243707,"ip_address":"","ucode":"CAA5AD6A74A9EB","user_header":"https://static001.geekbang.org/account/avatar/00/12/fa/3b/29c9240f.jpg","comment_is_top":false,"comment_ctime":1545571706,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545571706","product_id":100020801,"comment_content":"写的真的蛮好的，刚了解mysql看到第一篇果断入坑了。","like_count":0},{"had_liked":false,"id":52975,"user_name":"test","can_delete":false,"product_type":"c1","uid":1167448,"ip_address":"","ucode":"0EF164C6B18485","user_header":"https://static001.geekbang.org/account/avatar/00/11/d0/58/4cc72f4d.jpg","comment_is_top":false,"comment_ctime":1545560842,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545560842","product_id":100020801,"comment_content":"感觉有点难，坚持打卡，先看一遍回来再反复看","like_count":0},{"had_liked":false,"id":52546,"user_name":"隰有荷","can_delete":false,"product_type":"c1","uid":1357944,"ip_address":"","ucode":"2BE9A32AB28963","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/78/2828195b.jpg","comment_is_top":false,"comment_ctime":1545414129,"is_pvip":false,"replies":[{"id":"19158","content":"其实也有…确定表以后会判断一下。执行阶段也有","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545458953,"ip_address":"","comment_id":52546,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545414129","product_id":100020801,"comment_content":"为啥到了执行阶段才去分析用户权限？在词法解析的时候分析用户权限，如果操作权限不够，那直接结束不就省了后面的优化等操作了吗？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433905,"discussion_content":"其实也有…确定表以后会判断一下。执行阶段也有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545458953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51830,"user_name":"靈","can_delete":false,"product_type":"c1","uid":1222324,"ip_address":"","ucode":"A6FC817B5A3300","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epesWg3XayWLfUmIXtVp6p3oRXVe7BdzIic3j0vibVP80WSOgN7icSdr3h41UnshYXlsdwHibc7fZtldg/132","comment_is_top":false,"comment_ctime":1545268138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545268138","product_id":100020801,"comment_content":"上面分析器那块说得很明白了嘛，会将T转换成表T，会将Id转换成字段iD。没有肯定转换不过去的。","like_count":0},{"had_liked":false,"id":51540,"user_name":"桃之夭夭","can_delete":false,"product_type":"c1","uid":1091722,"ip_address":"","ucode":"4CDD45167288BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/8a/76e1e828.jpg","comment_is_top":false,"comment_ctime":1545196205,"is_pvip":false,"replies":[{"id":"18967","content":"不是。执行器是同步调用引擎接口，不是异步调用。执行过程中累计的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1545334307,"ip_address":"","comment_id":51540,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545196205","product_id":100020801,"comment_content":"老师，小白问个问题：执行器去操作引擎获取数据的时候，因为引擎查询数据也需要时间，那执行器是不是有个等待的过程？？您说的rows_examined是记录执行器每调用引擎获取数据刚时累加，那是不是可以这样理解在一个查询过程中，执行器会间隔一段时间去引擎获取数据？？？如果是这种的话，我又有一个疑问了，执行器怎么知道引擎已经查询完了，最终返回数据的呢？？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433505,"discussion_content":"不是。执行器是同步调用引擎接口，不是异步调用。执行过程中累计的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545334307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50242,"user_name":"Yao","can_delete":false,"product_type":"c1","uid":1056994,"ip_address":"","ucode":"F975B21AB0DC1B","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/e2/de58e1fd.jpg","comment_is_top":false,"comment_ctime":1544931334,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1544931334","product_id":100020801,"comment_content":"想请教下，长连接维护的对象里除了链接信息，权限信息外还会有哪些内容，为什么会导致内存持续增加，意思是还会有使用这个长连接的每次请求信息吗？希望得到您的恢复，谢谢","like_count":0},{"had_liked":false,"id":50191,"user_name":"cf","can_delete":false,"product_type":"c1","uid":1350280,"ip_address":"","ucode":"C54EAC010F06EC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIcEaEVhpm3up3wX4PzVlgJ1ibsRobcWFUu4RRXu8Mfw3nIFibDSmm8x9rbpFlDIhfHOMBadYBhaeVQ/132","comment_is_top":false,"comment_ctime":1544891303,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544891303","product_id":100020801,"comment_content":"分析器，可以根据原文暗示得到结果。<br>根据查询到的更具体的分析过程如下：<br>（1）首先是解析器将查询分解成一个个标识，然后构造一颗“解析树”，解析器保证查询中的标识都是有效的，会检查其中的基本错误，比如字符串上面的引号没有闭合等。<br>（2）然后预处理器检查解析器生成的解析树，解决解析器无法解析的语义。比如，它会检查表和列名是否存在，检查名字和别名，保证没有歧义。<br>有个疑问：网络上有文章表示是预处理器检查权限，即词法分析阶段。而且如果是没有select权限加上查询的字段不存在，不应该是先报错“找不到对应的列”吗？这时候会继续检查权限？虽然说返回权限不对才是正确的，但是对于这个在哪个步骤进行权限检查还是有点糊涂，希望大神指点。","like_count":0},{"had_liked":false,"id":49616,"user_name":"迷彩","can_delete":false,"product_type":"c1","uid":1221205,"ip_address":"","ucode":"B560D501B27C7E","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/55/19354b3c.jpg","comment_is_top":false,"comment_ctime":1544747386,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544747386","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":49111,"user_name":"念你如昔","can_delete":false,"product_type":"c1","uid":1323531,"ip_address":"","ucode":"FCAD88AB57D084","user_header":"https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg","comment_is_top":false,"comment_ctime":1544605814,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544605814","product_id":100020801,"comment_content":"什么场景下调用“取满足条件的第一行”，引擎所扫描的行数会扫描很多行呢","like_count":0},{"had_liked":false,"id":49099,"user_name":"艾草","can_delete":false,"product_type":"c1","uid":1302279,"ip_address":"","ucode":"E0D8F58FE6D122","user_header":"https://static001.geekbang.org/account/avatar/00/13/df/07/7bf65329.jpg","comment_is_top":false,"comment_ctime":1544603969,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544603969","product_id":100020801,"comment_content":"赞赞赞，大佬说的很详细。例子也很有典范性，很适合我这种mysql初学想要深入了解的。","like_count":0},{"had_liked":false,"id":49079,"user_name":"colben","can_delete":false,"product_type":"c1","uid":1200769,"ip_address":"","ucode":"5E5DBA48578E96","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/81/745475e9.jpg","comment_is_top":false,"comment_ctime":1544599913,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544599913","product_id":100020801,"comment_content":"开课好几天了，刚开始看，这评论长度是文章的6、7倍 ……","like_count":0},{"had_liked":false,"id":48959,"user_name":"一一","can_delete":false,"product_type":"c1","uid":1344255,"ip_address":"","ucode":"29D73AC1DCFFB6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/JkMtA7dN7V9Z9iaX2w5zTuPOU6mxhARmEZxicXG7vOs5snjAQrlU0Km8pk9eOibJlhdV3aQk2zkFXOQwZEu1mDgLg/132","comment_is_top":false,"comment_ctime":1544581715,"is_pvip":false,"replies":[{"id":"17579","content":"如果这么分，那只能算在optimizer里面了…","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1544584729,"ip_address":"","comment_id":48959,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544581715","product_id":100020801,"comment_content":"老师我想问下：mysql官网上的体系图是 SQL Interface、Parser、Optimizer、Caches&amp;Buffers、Pluggable Storage Engines这几部分， 分别是sql接口，分析器，优化器，查询缓存，引擎<br>那我们我们文中的执行器是在哪一部分的","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432436,"discussion_content":"如果这么分，那只能算在optimizer里面了…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544584729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48154,"user_name":".","can_delete":false,"product_type":"c1","uid":1304543,"ip_address":"","ucode":"1853CDE6A98A61","user_header":"https://static001.geekbang.org/account/avatar/00/13/e7/df/84f214c3.jpg","comment_is_top":false,"comment_ctime":1544371238,"is_pvip":false,"replies":[{"id":"17162","content":"一般APP不会直连数据库吧？是不是都有个服务端，让服务端维持长连接，响应客户端请求就好了<br><br>初始化连接资源只是初始化自己的，不影响其他人创建连接或者读写请求的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1544404905,"ip_address":"","comment_id":48154,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544371238","product_id":100020801,"comment_content":"老师，有个问题，希望你帮我回答一下。谢谢。<br>比如我们做一个app的时候，会对不同的功能数据，放在不同的数据库中。有些数据库是会频道读取数据的，有些也是不频繁。那么针对频道读取数据的我们是一直保留长连接吗。那如果是使用方案二的话，再重新初始化连接资源的时候，会出现另外一个请求也要进行数据读写的话，是否会卡住呢？<br>不懂我这个问题是否描述清楚了。希望老师帮我解答一下。也有可能是我对重新初始化连接资源理解错误了。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432056,"discussion_content":"一般APP不会直连数据库吧？是不是都有个服务端，让服务端维持长连接，响应客户端请求就好了\n\n初始化连接资源只是初始化自己的，不影响其他人创建连接或者读写请求的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544404905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47904,"user_name":"qinggeouye","can_delete":false,"product_type":"c1","uid":1251536,"ip_address":"","ucode":"5B53EEDD7BEC9C","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg","comment_is_top":false,"comment_ctime":1544251908,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544251908","product_id":100020801,"comment_content":"分析器中的词法检查～","like_count":0},{"had_liked":false,"id":46876,"user_name":"智能家居-九俊楚子","can_delete":false,"product_type":"c1","uid":1252414,"ip_address":"","ucode":"3D0734E2EDA3EC","user_header":"https://static001.geekbang.org/account/avatar/00/13/1c/3e/2ebc7c96.jpg","comment_is_top":false,"comment_ctime":1543995462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543995462","product_id":100020801,"comment_content":"看不懂，老师，有没有更基础一点的介绍呢？","like_count":0},{"had_liked":false,"id":46763,"user_name":"菜菜","can_delete":false,"product_type":"c1","uid":1302241,"ip_address":"","ucode":"D798B831A89AAF","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/e1/f648c746.jpg","comment_is_top":false,"comment_ctime":1543978515,"is_pvip":false,"replies":[{"id":"16692","content":"查询缓存拿到结果后判断权限，我觉得这个逻辑就算在“查询缓存”这一步吧😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543982477,"ip_address":"","comment_id":46763,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543978515","product_id":100020801,"comment_content":"林老师，您好！高性能中有这么一句话：如果当前的查询恰好命中了查询缓存，那么返回查询结果之前MySQL会检查一次用户权限。这里检查权限是去连接器中检查权限还是执行器？看评论您说过这么一句话，连接器取权限，执行器用权限，我自己感觉应该是连接器。<br>如果是连接器的话，图中不是先要经过连接器，这个时候检查是要返回去再做检查？<br>如果是这执行器的话，是需要跳过下面的分析器和优化器么？<br>还请林老师指点一下,感谢！","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431535,"discussion_content":"查询缓存拿到结果后判断权限，我觉得这个逻辑就算在“查询缓存”这一步吧😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543982477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46672,"user_name":"姚伟","can_delete":false,"product_type":"c1","uid":1324091,"ip_address":"","ucode":"5218AE2384AE92","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/3b/a5fddd35.jpg","comment_is_top":false,"comment_ctime":1543970638,"is_pvip":false,"replies":[{"id":"16703","content":"1. 不是，连接池是server层的。<br>2. Thread_pool是线程池，给不同的连接复用线程；连接池是复用连接","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543985181,"ip_address":"","comment_id":46672,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543970638","product_id":100020801,"comment_content":"老师，MySQL的连接池就是把用完的链接放回池子里，给别的业务线程复用，变短链接为长链接。<br>MySQL的连接池是在InnoDB 的buffe pool里面的吗？和MySQL企业版的thread_pool的实现原理类似吗？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431503,"discussion_content":"1. 不是，连接池是server层的。\n2. Thread_pool是线程池，给不同的连接复用线程；连接池是复用连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543985181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46395,"user_name":"THROW","can_delete":false,"product_type":"c1","uid":1112141,"ip_address":"","ucode":"A3C089A8F5F941","user_header":"https://static001.geekbang.org/account/avatar/00/10/f8/4d/4b748ff1.jpg","comment_is_top":false,"comment_ctime":1543915160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543915160","product_id":100020801,"comment_content":"老师请教一个问题，select数据的时候是最后一步是按页加载数据行并过滤出来返回的吧？那如果表中有类似blob这种数据比较大的数据列，一页能加载的数据行是不是就少，会导致select操作很慢？","like_count":0},{"had_liked":false,"id":46313,"user_name":"我是啊","can_delete":false,"product_type":"c1","uid":1203867,"ip_address":"","ucode":"A21D9613A34C15","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/9b/a25306b1.jpg","comment_is_top":false,"comment_ctime":1543898378,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543898378","product_id":100020801,"comment_content":"请问select (T.a+T.b) as result from T where result &gt; 0; 这类语句发生报错的发生过程是什么样的呢？<br>因为分析器只会对表中拥有的列的别名做识别，而select中函数的处理是在引擎返回筛选结果后在server中处理的吗。","like_count":0},{"had_liked":false,"id":46141,"user_name":"杰之7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1543852951,"is_pvip":false,"replies":[{"id":"16514","content":"嗯嗯共同学习😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543886861,"ip_address":"","comment_id":46141,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543852951","product_id":100020801,"comment_content":"这时Mysql数据库技术的第一课，我最好的一个心愿就是能和老师一起读过这短暂的两个月时间，搞懂Mysql的核心架构与技术。在今天的第一课里，给我们介绍了一条查询语言在Mysql中的全流程，涉及到Mysql的架构体系，Server层和存储引擎。首先在连接上数据库，之后对语句进行分析，从词法和句法对语句进行分析，然后使用优化器优化查询的效率，最后到了执行层面对查询语句进行执行。所以一个简单 的查询背后的技术设计到数据库的架构原理，理解架构之后，对我们更好的使用数据库技术及发现问题更有裨益。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431354,"discussion_content":"嗯嗯共同学习😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543886861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":46137,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1543852276,"is_pvip":false,"replies":[{"id":"16528","content":"嗯，确实是“识别出这个是一个查询缓存”这个动作是在连接器之后，查询缓存之前的，但是在查询缓存之前也只做了这一步小小的解析哈。<br>","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543887777,"ip_address":"","comment_id":46137,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543852276","product_id":100020801,"comment_content":"老师，您好<br>文章提到：<br>1. 建立连接成功之后，在连接器阶段会先到查询缓存查看是否存在该 SQL 的缓存。<br>2. 针对一条 SQL 语句，在分析器的词法分析阶段，从关键字 select 中识别出是一条查询语句。<br><br>这里有一个疑问，在分析器阶段才识别出 SQL 是查询语句，而在连接器阶段，如何决定是否需要到查询缓存看看呢？<br><br>谢谢老师！","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431352,"discussion_content":"嗯，确实是“识别出这个是一个查询缓存”这个动作是在连接器之后，查询缓存之前的，但是在查询缓存之前也只做了这一步小小的解析哈。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543887777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45727,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1543760653,"is_pvip":false,"replies":[{"id":"16272","content":"1. 是，还有更新语句失效缓存<br>2. 对的，而调用一次可能引擎内部访问了多行，就是这句话要表达的意思","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543774422,"ip_address":"","comment_id":45727,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543760653","product_id":100020801,"comment_content":"课后思考题：<br>分析器词法分析时报的错误。<br>文章分析器的词法分析介绍有提到“从 SQL 语句中识别出里面的字符串分别是什么，代表什么。要识别出 select 关键字是查询语句，字符串 T 是表 T，字符串 ID 是列 ID”。<br>因此是在分析器阶段报：Unknown column xxx。<br><br>---<br><br>疑问 1<br>MySQL 的逻辑架构图中，分析器左指向查询缓存，是执行器操作返回的结果原路返回给优化器，分析器，然后将结果保存到查询缓存里么？<br><br>---<br><br>疑问 2. <br>原文提到：<br>   rows_examined 表示这个语句执行过程中扫描了多少行。这个值就是在执行器每次调用引擎获取数据行的时候累加的。在有些场景下，执行器调用一次，在引擎内部则扫描了多行，因此引擎扫描行数跟 rows_examined 并不是完全相同的。<br><br>rows_examined 是不是表示执行器共调用了多少次引擎接口？也可以认为是引擎接口返回行数的累计值（因为引擎接口每次只返回一行）？我这样理解对么？<br><br>谢谢老师<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431177,"discussion_content":"1. 是，还有更新语句失效缓存\n2. 对的，而调用一次可能引擎内部访问了多行，就是这句话要表达的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543774422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45456,"user_name":"陈园","can_delete":false,"product_type":"c1","uid":1061207,"ip_address":"","ucode":"F04D1065FB8D39","user_header":"https://static001.geekbang.org/account/avatar/00/10/31/57/48aadf91.jpg","comment_is_top":false,"comment_ctime":1543645886,"is_pvip":false,"replies":[{"id":"16182","content":"额，为什么会这样，并不是redis缓存，是数据库内部的 query_cache","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543650986,"ip_address":"","comment_id":45456,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543645886","product_id":100020801,"comment_content":"禁用查询缓存，造成查询雪崩怎么办","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431047,"discussion_content":"额，为什么会这样，并不是redis缓存，是数据库内部的 query_cache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543650986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45324,"user_name":"boil飞","can_delete":false,"product_type":"c1","uid":1305830,"ip_address":"","ucode":"5EAC44B0AAEE97","user_header":"https://static001.geekbang.org/account/avatar/00/13/ec/e6/5e6176be.jpg","comment_is_top":false,"comment_ctime":1543587135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543587135","product_id":100020801,"comment_content":"mysql_reset_connection   这个重新初始化连接，要如何使用呢？","like_count":0},{"had_liked":false,"id":45246,"user_name":"芝士老爹","can_delete":false,"product_type":"c1","uid":1071316,"ip_address":"","ucode":"5F2935967574D0","user_header":"https://static001.geekbang.org/account/avatar/00/10/58/d4/c52f9f6d.jpg","comment_is_top":false,"comment_ctime":1543566988,"is_pvip":false,"replies":[{"id":"16140","content":"就是把库、表的权限也一起拿了哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543628787,"ip_address":"","comment_id":45246,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543566988","product_id":100020801,"comment_content":"Hi，老师！<br>图里面的连接器这块，“权限认证”如果只看图的话感觉很容易和后面的库、表权限这块形成误解，不知道改成“连接的权限认证”之类的是否会好一些。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430966,"discussion_content":"就是把库、表的权限也一起拿了哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543628787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44985,"user_name":"守护.","can_delete":false,"product_type":"c1","uid":1327849,"ip_address":"","ucode":"14FE863C2FF948","user_header":"https://static001.geekbang.org/account/avatar/00/14/42/e9/e27c659d.jpg","comment_is_top":false,"comment_ctime":1543537613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543537613","product_id":100020801,"comment_content":"SELECT<br>\tCOUNT(1)<br>FROM<br>\t(<br>\t\tSELECT<br>\t\t\ta.enterprise_name,<br>\t\t\ta.`name`,<br>\t\t\ta.isopen,<br>\t\t\ta.claim,<br>\t\t\tb.*<br>\t\tFROM<br>\t\t\tt_sc_staff_info a<br>\t\tLEFT JOIN t_sc_staff_roles b ON a.staff_info_id = b.staff_info_id<br>\t\tWHERE<br>\t\t\t1 = 1<br>\t\tGROUP BY<br>\t\t\tb.staff_info_id<br>\t) TOTAL<br><br>这个关联查询.有索引.查询也好慢，去除group by 效果差不多. a b表数据均在1千万以上.","like_count":0},{"had_liked":false,"id":44942,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1543528318,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543528318","product_id":100020801,"comment_content":"如果我想管理mysql长连接，是应该在客户端（连接池里）做吗？查了一下 mysql_reset_connection 这个好像是C的函数，我客户端语言使用的是java，翻了mysql-connector&#47;j 似乎没有类似的功能？<br>","like_count":0},{"had_liked":false,"id":44664,"user_name":"W","can_delete":false,"product_type":"c1","uid":1311861,"ip_address":"","ucode":"42AF5593C1763B","user_header":"https://static001.geekbang.org/account/avatar/00/14/04/75/d9d6e2a1.jpg","comment_is_top":false,"comment_ctime":1543471911,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543471911","product_id":100020801,"comment_content":"我认为是分析器<br>分析器首先是&quot;词法分析&quot;。你输入的是由多个字符串和空格组成的一条sql语句，mysql需要识别里面的字符串分别是什么，代表什么，然后在做“语法分析”，是否满足mysql语法。","like_count":0},{"had_liked":false,"id":44400,"user_name":"刘晓宇","can_delete":false,"product_type":"c1","uid":1079935,"ip_address":"","ucode":"6E4623C1B40ADA","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/7f/1b389e44.jpg","comment_is_top":false,"comment_ctime":1543420502,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543420502","product_id":100020801,"comment_content":"分析器，开始对SQL语句进行分析。所以课后答案是分析器。","like_count":0},{"had_liked":false,"id":44294,"user_name":"路飞君1234","can_delete":false,"product_type":"c1","uid":1304789,"ip_address":"","ucode":"37E47097212BA7","user_header":"https://static001.geekbang.org/account/avatar/00/13/e8/d5/16450867.jpg","comment_is_top":false,"comment_ctime":1543402271,"is_pvip":false,"replies":[{"id":"15823","content":"不会，只影响之后新建的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543409311,"ip_address":"","comment_id":44294,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543402271","product_id":100020801,"comment_content":"当修改数据权限之后，执行flush privileges; 此时服务端会通知客户端的连接器更新权限么？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430715,"discussion_content":"不会，只影响之后新建的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543409311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44281,"user_name":"von","can_delete":false,"product_type":"c1","uid":1248289,"ip_address":"","ucode":"82C827800D3C23","user_header":"https://static001.geekbang.org/account/avatar/00/13/0c/21/c166f3cc.jpg","comment_is_top":false,"comment_ctime":1543399444,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543399444","product_id":100020801,"comment_content":"我接着@尼古拉斯赵四的问题，创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column”，报unknown column是在分析器阶段，但是到执行器的时候才检察权限，所以这个&quot;select command denied&quot;是在哪个阶段报的呢？","like_count":0},{"had_liked":false,"id":44165,"user_name":"守护.","can_delete":false,"product_type":"c1","uid":1327849,"ip_address":"","ucode":"14FE863C2FF948","user_header":"https://static001.geekbang.org/account/avatar/00/14/42/e9/e27c659d.jpg","comment_is_top":false,"comment_ctime":1543376897,"is_pvip":false,"replies":[{"id":"16005","content":"记得有索引，驱动表字段要有，被驱动表关联字段也要有。<br><br>建议后面提问的时候具体给出例子哈，否则就只能泛泛回答","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543537364,"ip_address":"","comment_id":44165,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543376897","product_id":100020801,"comment_content":"两张千万级别的表关联查询怎么优化(◐‿◑)﻿","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430660,"discussion_content":"记得有索引，驱动表字段要有，被驱动表关联字段也要有。\n\n建议后面提问的时候具体给出例子哈，否则就只能泛泛回答","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543537364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44113,"user_name":"wsw","can_delete":false,"product_type":"c1","uid":1117874,"ip_address":"","ucode":"68885262052BCD","user_header":"https://static001.geekbang.org/account/avatar/00/11/0e/b2/7cf7e91c.jpg","comment_is_top":false,"comment_ctime":1543369750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543369750","product_id":100020801,"comment_content":"对于连接器，有些疑问。<br>文中提到一旦全部使用长连接会使内存使用率暴涨，那么一个长连接或者短连接是一个进程吗，而长连接是常驻进程，所以才会占用大量内存<br><br>若是上面是对，那么可能又引出一个问题，既然长连接或短连接都是进程，那么连接（进程）一旦建立是不是可以处理所以请求，而不用在建立连接？<br><br>应该不会是一个查询语句就是一个连接吧。<br>","like_count":0},{"had_liked":false,"id":43812,"user_name":"卅～脱","can_delete":false,"product_type":"c1","uid":1126428,"ip_address":"","ucode":"D34A4221CEC6B4","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/1c/58031fb5.jpg","comment_is_top":false,"comment_ctime":1543302113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543302113","product_id":100020801,"comment_content":"根据MySQL架构图分析，会在分析器阶段检查要执行的SQL语句，包括关键字、表名、列名（字段），如果没有找到该执行语句的字段会报错。","like_count":0},{"had_liked":false,"id":43753,"user_name":"CPU不停转","can_delete":false,"product_type":"c1","uid":1037780,"ip_address":"","ucode":"EE2606A580A0A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d5/d4/1a030e85.jpg","comment_is_top":false,"comment_ctime":1543287624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543287624","product_id":100020801,"comment_content":"分析器猜对了","like_count":0},{"had_liked":false,"id":43614,"user_name":"蓝天","can_delete":false,"product_type":"c1","uid":1318702,"ip_address":"","ucode":"E17EFE8FA5D5B0","user_header":"https://static001.geekbang.org/account/avatar/00/14/1f/2e/27d8b06d.jpg","comment_is_top":false,"comment_ctime":1543246380,"is_pvip":false,"replies":[{"id":"15625","content":"这个缓存是查询缓存，不需要“写磁盘”的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543288537,"ip_address":"","comment_id":43614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543246380","product_id":100020801,"comment_content":"请教老师，为什么表被更新后，缓存中已缓存的该表结果集就会被全部清空，是因为数据被更新后，所有脏数据将被刷到磁盘，导致了缓存中的结果集相对于新数据来说是不可用的，所以就全部清空了么。这里不是很理解。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430433,"discussion_content":"这个缓存是查询缓存，不需要“写磁盘”的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543288537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43605,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1543244980,"is_pvip":false,"replies":[{"id":"15571","content":"你要看下这个客户端的代码实现哦。看看他是不是自己会重新获得连接，或者是不是会维持心跳","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543246350,"ip_address":"","comment_id":43605,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543244980","product_id":100020801,"comment_content":"java用jdbc或者mybatis连接数据库，对于定时任务（每天执行一次），连接器会在8小时自动断开链接？那每天执行的时候是重新获取连接？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430430,"discussion_content":"你要看下这个客户端的代码实现哦。看看他是不是自己会重新获得连接，或者是不是会维持心跳","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543246350,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43599,"user_name":"刘胜","can_delete":false,"product_type":"c1","uid":1251625,"ip_address":"","ucode":"487374D72543E3","user_header":"https://static001.geekbang.org/account/avatar/00/13/19/29/f9490983.jpg","comment_is_top":false,"comment_ctime":1543243723,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543243723","product_id":100020801,"comment_content":"大家都很用心的去思考。如果凭感觉的话，像这种错误应该在一个查询过程很开始的地方就抛出来。连接成功鉴权成功，下一步就该把它揪出来了，当然本文确实有点提示。一开始从文章找答案的时候，我一度认为是最后一步才执行之后才抛出来的。尴尬啊尴尬😓","like_count":0},{"had_liked":false,"id":43580,"user_name":"小陈","can_delete":false,"product_type":"c1","uid":1009385,"ip_address":"","ucode":"A03A299310AD18","user_header":"https://static001.geekbang.org/account/avatar/00/0f/66/e9/814d057a.jpg","comment_is_top":false,"comment_ctime":1543242048,"is_pvip":false,"replies":[{"id":"15573","content":"你看下索引下篇😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543246442,"ip_address":"","comment_id":43580,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543242048","product_id":100020801,"comment_content":"林老师，引擎扫描行数跟 rows_examined 并不是完全相同的。rows_examined不是引擎扫描行数吗？怎么又不相等了呢？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430424,"discussion_content":"你看下索引下篇😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543246442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43167,"user_name":"endea","can_delete":false,"product_type":"c1","uid":1187396,"ip_address":"","ucode":"CBF3FEC0620F02","user_header":"","comment_is_top":false,"comment_ctime":1543194117,"is_pvip":false,"replies":[{"id":"15458","content":"查询缓存不是”select语句”，是查询内部的一个数据结构。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543196864,"ip_address":"","comment_id":43167,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543194117","product_id":100020801,"comment_content":"老师，查询缓存的时候需要执行select语句，这个时候不需要经过分析器对语法词法进行分析吗？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430312,"discussion_content":"查询缓存不是”select语句”，是查询内部的一个数据结构。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543196864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43032,"user_name":"文上泉","can_delete":false,"product_type":"c1","uid":1019784,"ip_address":"","ucode":"6933B6685FB159","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/88/9b916f50.jpg","comment_is_top":false,"comment_ctime":1543144993,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1543144993","product_id":100020801,"comment_content":"花示意图用的什么软件，挺好看的😄","like_count":0},{"had_liked":false,"id":42944,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1543115875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543115875","product_id":100020801,"comment_content":"有个疑问：表A有一个触发器T是写表B，那么当用户有读写表A权限但没有读写表B权限时写表A会在执行阶段被拒绝吗？","like_count":0},{"had_liked":false,"id":42934,"user_name":"大大大dvavid","can_delete":false,"product_type":"c1","uid":1323238,"ip_address":"","ucode":"1434DE4DB3DEF1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJW3d3MZwQwaq0aKfQsL4TUaaVULibpNwA8e3OAoCCwGBco5mAbjybhhvv99UlNEkHJoPmFZN3z4kg/132","comment_is_top":false,"comment_ctime":1543113454,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543113454","product_id":100020801,"comment_content":"打卡D1，答案是分析器，分析阶段就要知道索引，列等信息了。","like_count":0},{"had_liked":false,"id":42842,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1082187,"ip_address":"","ucode":"FC323371453C97","user_header":"https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg","comment_is_top":false,"comment_ctime":1543055870,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543055870","product_id":100020801,"comment_content":"老师好！查询缓存开启的情况下，每次查询的结果就一定会被放入缓存中吗？比如会不会对结果集大小做区间的校验","like_count":0},{"had_liked":false,"id":42838,"user_name":"大胃高怕飞","can_delete":false,"product_type":"c1","uid":1047735,"ip_address":"","ucode":"EEC5151E1A8062","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/b7/6cef8bf0.jpg","comment_is_top":false,"comment_ctime":1543054576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543054576","product_id":100020801,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":42798,"user_name":"高祥喜","can_delete":false,"product_type":"c1","uid":1018169,"ip_address":"","ucode":"23D9BD41AF28A7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/89/39/8c08dc10.jpg","comment_is_top":false,"comment_ctime":1543048041,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543048041","product_id":100020801,"comment_content":"语法解析阶段","like_count":0},{"had_liked":false,"id":42765,"user_name":"SakuraM","can_delete":false,"product_type":"c1","uid":1297280,"ip_address":"","ucode":"18596F1CC7E2B4","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/80/16849dd4.jpg","comment_is_top":false,"comment_ctime":1543038288,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543038288","product_id":100020801,"comment_content":"大多数情况下不使用数据库中自带的查询缓存，所以才会引入第三方缓存么？","like_count":0},{"had_liked":false,"id":42719,"user_name":"为你写下天边的眷顾","can_delete":false,"product_type":"c1","uid":1305110,"ip_address":"","ucode":"E09C81804F6D44","user_header":"https://static001.geekbang.org/account/avatar/00/13/ea/16/0eb1cc5a.jpg","comment_is_top":false,"comment_ctime":1543027637,"is_pvip":false,"replies":[{"id":"15299","content":"《该不该使用分区表》这篇会讨论这个问题，按日子算过年前会发😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1543041634,"ip_address":"","comment_id":42719,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1543027637","product_id":100020801,"comment_content":"老师，可不可以讲一些Mysql分区，这种历史数据的处理，按月，按天分区等……","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430173,"discussion_content":"《该不该使用分区表》这篇会讨论这个问题，按日子算过年前会发😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543041634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42712,"user_name":"吴飞","can_delete":false,"product_type":"c1","uid":1103619,"ip_address":"","ucode":"CC58A5534BD457","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/03/eb991e02.jpg","comment_is_top":false,"comment_ctime":1543025994,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543025994","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":42682,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1543020055,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543020055","product_id":100020801,"comment_content":"应该是分析其报出来的, 因为报不存在的列应该也是在分析的时候通过语句解析出来的错误.","like_count":0},{"had_liked":false,"id":42625,"user_name":"FelixSun","can_delete":false,"product_type":"c1","uid":1289035,"ip_address":"","ucode":"C52A87C7F3D672","user_header":"https://static001.geekbang.org/account/avatar/00/13/ab/4b/01c56dda.jpg","comment_is_top":false,"comment_ctime":1542981329,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542981329","product_id":100020801,"comment_content":"正文一开始就说了，经过了连接器，在缓存器没命中的话，就会到达分析器，分析词法","like_count":0},{"had_liked":false,"id":42618,"user_name":"欧阳波","can_delete":false,"product_type":"c1","uid":1124750,"ip_address":"","ucode":"A19B46DBC4FEBF","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/8e/f6241f28.jpg","comment_is_top":false,"comment_ctime":1542980373,"is_pvip":false,"replies":[{"id":"15276","content":"Explain + SQL语句","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542995007,"ip_address":"","comment_id":42618,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542980373","product_id":100020801,"comment_content":"我想看看我得mysql执行计划 看看有没有执行索引等 怎么弄","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430142,"discussion_content":"Explain + SQL语句","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542995007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42603,"user_name":"balancer","can_delete":false,"product_type":"c1","uid":1145758,"ip_address":"","ucode":"A865FAFF2FE1FA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/9e/37d69ff0.jpg","comment_is_top":false,"comment_ctime":1542977338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542977338","product_id":100020801,"comment_content":"分析器；它的分析器：做的是语句文法词法语义分析吧；","like_count":0},{"had_liked":false,"id":42348,"user_name":"大白杨","can_delete":false,"product_type":"c1","uid":1238048,"ip_address":"","ucode":"6C34FB392A388F","user_header":"https://static001.geekbang.org/account/avatar/00/12/e4/20/71ea229b.jpg","comment_is_top":false,"comment_ctime":1542941977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542941977","product_id":100020801,"comment_content":"优化器阶段。","like_count":0},{"had_liked":false,"id":42339,"user_name":"Yaowen","can_delete":false,"product_type":"c1","uid":1200136,"ip_address":"","ucode":"AEAD5F3C14064A","user_header":"https://static001.geekbang.org/account/avatar/00/12/50/08/318297a1.jpg","comment_is_top":false,"comment_ctime":1542941306,"is_pvip":false,"replies":[{"id":"15151","content":"这样就是","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542949481,"ip_address":"","comment_id":42339,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542941306","product_id":100020801,"comment_content":"老师你好，请问下，如果MySQL客户端与服务端在同一台机器上，那么在 shell 使用 `mysql` 连接服务端的话，使用的是 unix 域套接字吗？因为我设置的开发机中我的`my.cnf` 设置是<br>```<br>[client]<br>host  = localhost<br>user = user-name<br>password = password<br>socket = &#47;var&#47;run&#47;mysqld&#47;mysqld.sock<br>```","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430058,"discussion_content":"这样就是","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542949481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41994,"user_name":"天空之城","can_delete":false,"product_type":"c1","uid":1316326,"ip_address":"","ucode":"571B92401BD566","user_header":"https://static001.geekbang.org/account/avatar/00/14/15/e6/2920b160.jpg","comment_is_top":false,"comment_ctime":1542888856,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542888856","product_id":100020801,"comment_content":"没想到mysql权限判断是在执行的时候，一直以为在前面解析的时候就做了。ps：oracle解析的时候就做了。","like_count":0},{"had_liked":false,"id":41895,"user_name":"Larwas","can_delete":false,"product_type":"c1","uid":1105436,"ip_address":"","ucode":"AF6BAA7769311A","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/1c/60ff644d.jpg","comment_is_top":false,"comment_ctime":1542868760,"is_pvip":false,"replies":[{"id":"15017","content":"每个连接对应一个THD对象，这些内容都在这个对象里","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542871544,"ip_address":"","comment_id":41895,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542868760","product_id":100020801,"comment_content":"“MySQL 在执行过程中临时使用的内存是管理在连接对象里面的”<br>请问 “管理在连接对象里面” 这个怎么理解呢？是还有管理在其它什么地方的吗？是因为管理在对象里面才会被 OOM 的吗？谢谢~<br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429936,"discussion_content":"每个连接对应一个THD对象，这些内容都在这个对象里","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542871544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41884,"user_name":"TIMKeeper-sxs","can_delete":false,"product_type":"c1","uid":1321102,"ip_address":"","ucode":"A703D9EC1E1638","user_header":"https://static001.geekbang.org/account/avatar/00/14/28/8e/4c6c0ba2.jpg","comment_is_top":false,"comment_ctime":1542867286,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542867286","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":41855,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1082187,"ip_address":"","ucode":"FC323371453C97","user_header":"https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg","comment_is_top":false,"comment_ctime":1542860796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542860796","product_id":100020801,"comment_content":"“所以如果长连接累积下来，可能导致内存占用太大，被系统强行杀掉（OOM），从现象看就是 MySQL 异常重启了。”<br><br>问题1：内存具体占用多大时才会被杀掉呢，或者说我可以本地模拟这种情况吗？如何确认是因为内存占用太大被系统杀掉的呢 <br><br>问题2：异常重启指的是整个mysql重启吗 如果是的话那么此时有其他链接正在执行怎么处理？还有重启过程中是中止对外提供服务吗<br><br>期待老师的解答 谢谢！","like_count":0},{"had_liked":false,"id":41728,"user_name":"小傻丫头","can_delete":false,"product_type":"c1","uid":1311151,"ip_address":"","ucode":"6BF28B1BC4328C","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/af/04224761.jpg","comment_is_top":false,"comment_ctime":1542847029,"is_pvip":false,"replies":[{"id":"15031","content":"是的。只是现在国内基本上生产上都还是在用5.X系列，所以还是介绍下","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542872949,"ip_address":"","comment_id":41728,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542847029","product_id":100020801,"comment_content":"文章中提到，连接成功后执行语句会到第二步查询缓存，但是这个功能在8.0版本已经被去掉了，那是不是在8.0后连接成功后下一步是分析阶段呢？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429881,"discussion_content":"是的。只是现在国内基本上生产上都还是在用5.X系列，所以还是介绍下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542872949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41604,"user_name":"Nic辉少","can_delete":false,"product_type":"c1","uid":1163674,"ip_address":"","ucode":"1680DD8B12C48D","user_header":"https://static001.geekbang.org/account/avatar/00/11/c1/9a/40b3a0e5.jpg","comment_is_top":false,"comment_ctime":1542811009,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542811009","product_id":100020801,"comment_content":"应该是分析器","like_count":0},{"had_liked":false,"id":41363,"user_name":"行知","can_delete":false,"product_type":"c1","uid":1052542,"ip_address":"","ucode":"457876AFC0D8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/7e/f10ff251.jpg","comment_is_top":false,"comment_ctime":1542769173,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542769173","product_id":100020801,"comment_content":"mysql&gt; select * from t1 join t2 using(ID)  where t1.c=10 and t2.d=20;<br>既可以先从表 t1 里面取出 c=10 的记录的 ID 值，再根据 ID 值关联到表 t2，再判断 t2 里面 d 的值是否等于 20。也可以先从表 t2 里面取出 d=20 的记录的 ID 值，再根据 ID 值关联到 t1，再判断 t1 里面 c 的值是否等于 10。 优化器 是怎么选择？","like_count":0},{"had_liked":false,"id":41283,"user_name":"HaloMonkey丶","can_delete":false,"product_type":"c1","uid":1302164,"ip_address":"","ucode":"A1BD8D62E4689F","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/94/14ff2f73.jpg","comment_is_top":false,"comment_ctime":1542763977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542763977","product_id":100020801,"comment_content":"分析器阶段，语法分析判定此列不存在，不予执行，这里猜测是根据表的定义文件对列合法性进行判定","like_count":0},{"had_liked":false,"id":41087,"user_name":"晓","can_delete":false,"product_type":"c1","uid":1155149,"ip_address":"","ucode":"C8EF82680F30A6","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/4d/37116342.jpg","comment_is_top":false,"comment_ctime":1542723947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542723947","product_id":100020801,"comment_content":"先词法分析后语法分析，我觉得是在词法分析那一步","like_count":0},{"had_liked":false,"id":41019,"user_name":"felix","can_delete":false,"product_type":"c1","uid":1086157,"ip_address":"","ucode":"DF514D0BB9B508","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/cd/d39e568c.jpg","comment_is_top":false,"comment_ctime":1542713923,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542713923","product_id":100020801,"comment_content":"条件写在join on 后面和写在where后面有没有区别？哪个好？","like_count":0},{"had_liked":false,"id":40998,"user_name":"清风果果果","can_delete":false,"product_type":"c1","uid":1317397,"ip_address":"","ucode":"33A67F0689BACD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK6iaaVrkqyUrDE4j5XCiaTQrmCkQKRWk7aCfSUhKsd0ybibDSD4FpxQYh1U6Q1XHK7o9STYmTcibn4NA/132","comment_is_top":false,"comment_ctime":1542710716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542710716","product_id":100020801,"comment_content":"长连接消耗内存有其他解决办法么？","like_count":0},{"had_liked":false,"id":40992,"user_name":"柠檬","can_delete":false,"product_type":"c1","uid":1311006,"ip_address":"","ucode":"E7A7293E438FFF","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/1e/3aa8d7ec.jpg","comment_is_top":false,"comment_ctime":1542709602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542709602","product_id":100020801,"comment_content":"1.先连接连接器<br>2.验证用户名密码<br>3.查询用户权限<br>4.查询SQL<br>5.在缓存中查看是否执行过，如果有，直接返回结果<br>6.缓存没有，分析器解析语句，<br>7.优化器选择较优执行方式<br>8.执行器，执行返回结果<br><br>SQL问题在分析器进行分析时，验证是否正确","like_count":0},{"had_liked":false,"id":40990,"user_name":"柠檬","can_delete":false,"product_type":"c1","uid":1311006,"ip_address":"","ucode":"E7A7293E438FFF","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/1e/3aa8d7ec.jpg","comment_is_top":false,"comment_ctime":1542709435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542709435","product_id":100020801,"comment_content":"根据课程，整理了SQL执行过程<br>1.客户端先连接连接器(oracle 监听)<br>2.验证用户名密码，通过<br>3.查询用户权限<br>4.用户运行查询SQL<br>5.在缓存中查看是否执行过，如果有，直接返回结果<br>6.缓存没有，优化器解析语句，选择较优执行方式<br>7.执行器，执行返回结果<br><br>最后，语句条件错误，应该是在优化器对语句进行解析时发现的。","like_count":0},{"had_liked":false,"id":40921,"user_name":"萬萬沒想到","can_delete":false,"product_type":"c1","uid":1301944,"ip_address":"","ucode":"62C74988BFCA73","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/b8/9cfb6ada.jpg","comment_is_top":false,"comment_ctime":1542695925,"is_pvip":false,"replies":[{"id":"14714","content":"写文章之前还去确认过眼神，5.5.5的哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542698307,"ip_address":"","comment_id":40921,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542695925","product_id":100020801,"comment_content":"我记得innodb是从5.5.8版本成为MySQL默认的存储引擎~~","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429649,"discussion_content":"写文章之前还去确认过眼神，5.5.5的哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542698307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40881,"user_name":"My dream","can_delete":false,"product_type":"c1","uid":1077733,"ip_address":"","ucode":"2FEFB344230C17","user_header":"https://static001.geekbang.org/account/avatar/00/10/71/e5/bcdc382a.jpg","comment_is_top":false,"comment_ctime":1542688041,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542688041","product_id":100020801,"comment_content":"或者是一个字段模糊查询多个key的值，就像百度那样加空格","like_count":0},{"had_liked":false,"id":40828,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1302610,"ip_address":"","ucode":"7238F5206D6953","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/52/b700ae82.jpg","comment_is_top":false,"comment_ctime":1542679837,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542679837","product_id":100020801,"comment_content":"用户权限修改后，会即时刷新到新旧连接吧","like_count":0},{"had_liked":false,"id":40720,"user_name":"任鹏斌","can_delete":false,"product_type":"c1","uid":1104086,"ip_address":"","ucode":"34319B05EA6E74","user_header":"https://static001.geekbang.org/account/avatar/00/10/d8/d6/47da34bf.jpg","comment_is_top":false,"comment_ctime":1542669047,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542669047","product_id":100020801,"comment_content":"第一反应就是分析器因为属于语法语义范畴，但看到第一条留言是优化器老师还做了点评以为又错了，继续看评论后释然","like_count":0},{"had_liked":false,"id":40604,"user_name":"王子鹏","can_delete":false,"product_type":"c1","uid":1296763,"ip_address":"","ucode":"2B0494362E68A8","user_header":"https://static001.geekbang.org/account/avatar/00/13/c9/7b/a89761ce.jpg","comment_is_top":false,"comment_ctime":1542635820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542635820","product_id":100020801,"comment_content":"老师，我想问下，索引字段加了函数后用不了索引是因为函数在Server 层，而索引是在存储引擎上用的，所以要把所有该字段的数据全部查出来，再用函数，是这样吗？","like_count":0},{"had_liked":false,"id":40526,"user_name":"拉格朗日的忧桑","can_delete":false,"product_type":"c1","uid":1312991,"ip_address":"","ucode":"5FCB2C6616E113","user_header":"https://static001.geekbang.org/account/avatar/00/14/08/df/4e5c2b29.jpg","comment_is_top":false,"comment_ctime":1542629608,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542629608","product_id":100020801,"comment_content":"课后答案：分析器的语法分析阶段","like_count":0},{"had_liked":false,"id":40505,"user_name":"rh","can_delete":false,"product_type":"c1","uid":1314786,"ip_address":"","ucode":"6B651CFD3F01A8","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/e2/8cda07ca.jpg","comment_is_top":false,"comment_ctime":1542627368,"is_pvip":false,"replies":[{"id":"14611","content":"开发看到你的留言后觉得有必要也开始啃啃原理😄 便是极好的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542634203,"ip_address":"","comment_id":40505,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542627368","product_id":100020801,"comment_content":"分析器阶段，分析SQL语句语法是否正确。有学到内容，以前用到一些数据库，但都不是很深入，希望跟老师学到更多的内容，我是测试，学精通了，找你们这些开发的麻烦去😁","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429543,"discussion_content":"开发看到你的留言后觉得有必要也开始啃啃原理😄 便是极好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542634203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40495,"user_name":"wln","can_delete":false,"product_type":"c1","uid":1152297,"ip_address":"","ucode":"25961D385D8519","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIkicJ9lic0iawxiag1icicamkhriaiabE204B6dVxy99ia1fEMibRP5qVyervqunVeGiak0dmMbtv6c1icmYr0dQ/132","comment_is_top":false,"comment_ctime":1542625958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542625958","product_id":100020801,"comment_content":"这个在生成语法树parseTree的阶段针对where条件处理时就会报错。<br>","like_count":0},{"had_liked":false,"id":40382,"user_name":"LGY001","can_delete":false,"product_type":"c1","uid":1188176,"ip_address":"","ucode":"29CA0F9501D3EC","user_header":"https://static001.geekbang.org/account/avatar/00/12/21/50/265671fd.jpg","comment_is_top":false,"comment_ctime":1542610733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542610733","product_id":100020801,"comment_content":"老师 请问一下建立短连接是只有查询请求这种情况吗？ 谢谢老师","like_count":0},{"had_liked":false,"id":40351,"user_name":"lone","can_delete":false,"product_type":"c1","uid":1311609,"ip_address":"","ucode":"68986F17574B77","user_header":"https://static001.geekbang.org/account/avatar/00/14/03/79/830c68f2.jpg","comment_is_top":false,"comment_ctime":1542598627,"is_pvip":false,"replies":[{"id":"14532","content":"虽然会自动了，但是如果是程序里有用到事务，还是需要处理的，否则事务被拆成两个（前面一半自动回滚）业务还不知道，也不是好事哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542600606,"ip_address":"","comment_id":40351,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542598627","product_id":100020801,"comment_content":"老师好，c  mysql接口连接设置好mysql_ping自动重连之后。查询时候会自动调用吗？还是要自己主动定时检测。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429489,"discussion_content":"虽然会自动了，但是如果是程序里有用到事务，还是需要处理的，否则事务被拆成两个（前面一半自动回滚）业务还不知道，也不是好事哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542600606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40179,"user_name":"孟秋","can_delete":false,"product_type":"c1","uid":1303782,"ip_address":"","ucode":"E4A5AD5C4CEB35","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/e6/4a647084.jpg","comment_is_top":false,"comment_ctime":1542540361,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542540361","product_id":100020801,"comment_content":"分析器。文稿中有提到识别T表，识别列","like_count":0},{"had_liked":false,"id":40160,"user_name":"worthy","can_delete":false,"product_type":"c1","uid":1142202,"ip_address":"","ucode":"88E3D623C7EE7F","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/ba/0821c8a7.jpg","comment_is_top":false,"comment_ctime":1542532411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542532411","product_id":100020801,"comment_content":"加油(ง •̀_•́)ง","like_count":0},{"had_liked":false,"id":40115,"user_name":"huazsh","can_delete":false,"product_type":"c1","uid":1100866,"ip_address":"","ucode":"FDD79FB48F4046","user_header":"https://static001.geekbang.org/account/avatar/00/10/cc/42/13aaddfb.jpg","comment_is_top":false,"comment_ctime":1542506624,"is_pvip":false,"replies":[{"id":"14421","content":"主要还是效果不好","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542521206,"ip_address":"","comment_id":40115,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542506624","product_id":100020801,"comment_content":"分析器词法分析检查关键字表名字段名。<br>nysql8为何去掉查询缓存呢？针对指定查询缓存的，mysql8里面是怎样实现呢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429378,"discussion_content":"主要还是效果不好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542521206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40098,"user_name":"Genius  小嘉","can_delete":false,"product_type":"c1","uid":1238566,"ip_address":"","ucode":"B53F7C1FE3FC49","user_header":"https://static001.geekbang.org/account/avatar/00/12/e6/26/de4f01e7.jpg","comment_is_top":false,"comment_ctime":1542497469,"is_pvip":false,"replies":[{"id":"14418","content":"这个系列会篇实战+原理部分，trace,组提交这些可能会少些","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542521078,"ip_address":"","comment_id":40098,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542497469","product_id":100020801,"comment_content":"您好，后面会讲如何看trace , 组提交，二阶段提交等么？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429370,"discussion_content":"这个系列会篇实战+原理部分，trace,组提交这些可能会少些","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542521078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40063,"user_name":"kghch","can_delete":false,"product_type":"c1","uid":1313334,"ip_address":"","ucode":"E7E9DD543379B7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIJKia3LYh56vXYniaOuY75PfsIAznb07H0WL0UDrceu4KGJFB3Xia2HAq1gw5KfaSse3kl2MHek79BQ/132","comment_is_top":false,"comment_ctime":1542460949,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542460949","product_id":100020801,"comment_content":"分析器-词法分析 阶段","like_count":0},{"had_liked":false,"id":40030,"user_name":"余向华","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1542446171,"is_pvip":false,"replies":[{"id":"14403","content":"1. 官方版本还没有<br>2. 你的理解对的","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542470006,"ip_address":"","comment_id":40030,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542446171","product_id":100020801,"comment_content":"老师，又打扰你了，我这里有两个疑问：<br>1、连接的过程中消耗的内存是怎么管理的，老师有过优化连接这方面的经验分享吗，怎样在通过内存的大小来判断关于这个连接是小内存还是大内存（有可视化的连接），从而是否选择**mysql_reset_connection**来初始化连接资源。<br>2、【查询缓存的失效非常频繁，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。】<br>老师，这句话，我的理解是 【只要有对一个表的更新，涉及到这张表的查询缓存都会失效】，对吗<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429339,"discussion_content":"1. 官方版本还没有\n2. 你的理解对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542470006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39998,"user_name":"evancao","can_delete":false,"product_type":"c1","uid":1312016,"ip_address":"","ucode":"BD5BBD82B839BB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ephT4ucrKH1F3iagialpTVzUyTgOA84IAfKK7gOywSD3v8TTa9NPf2S83NElb0ScDBNJ5nALOH3lKmQ/132","comment_is_top":false,"comment_ctime":1542433738,"is_pvip":false,"replies":[{"id":"14365","content":"无所谓“最稳定”了，每个版本都在有些小bug😄 关键做好上线前验证","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542440082,"ip_address":"","comment_id":39998,"utype":1}],"discussion_count":0,"race_medal":0,"score":"1542433738","product_id":100020801,"comment_content":"老师，有个问题，现在mysql5.7 ，什么小版本最稳定？生产使用，请给个建议。","like_count":0},{"had_liked":false,"id":39983,"user_name":"cbooy","can_delete":false,"product_type":"c1","uid":1105558,"ip_address":"","ucode":"841A7EE022B52E","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/96/92822753.jpg","comment_is_top":false,"comment_ctime":1542427667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542427667","product_id":100020801,"comment_content":"课后答案，假设我来设计这块的逻辑，应该是在程序最早处将这类异常或者错误终结掉，越往后处理会给系统带来很大的负担，从老师介绍的架构图看，最好在分析器阶段处理，而且应该是词法分析处（强忍没去看答案）","like_count":0},{"had_liked":false,"id":39980,"user_name":"cbooy","can_delete":false,"product_type":"c1","uid":1105558,"ip_address":"","ucode":"841A7EE022B52E","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/96/92822753.jpg","comment_is_top":false,"comment_ctime":1542426807,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542426807","product_id":100020801,"comment_content":"哎呀，P9讲的东西就是不一样，意犹未尽的赶脚，这一课完结后，会不会有新的续集出来啊，比如啥实战一类的","like_count":0},{"had_liked":false,"id":39934,"user_name":"琳","can_delete":false,"product_type":"c1","uid":1281093,"ip_address":"","ucode":"8674EFD9E31354","user_header":"https://static001.geekbang.org/account/avatar/00/13/8c/45/fb573de7.jpg","comment_is_top":false,"comment_ctime":1542409851,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542409851","product_id":100020801,"comment_content":"分析器。<br>在写SQL文时如果表名字段名写错了，也是会报“You have an error in your SQL syntax”的错误提醒。这时候其实也是因为这个表名字段名不存在才会报这个错误的。","like_count":0},{"had_liked":false,"id":39926,"user_name":"Judy","can_delete":false,"product_type":"c1","uid":1125103,"ip_address":"","ucode":"AF48B83F0C8CB6","user_header":"https://static001.geekbang.org/account/avatar/00/11/2a/ef/592cb371.jpg","comment_is_top":false,"comment_ctime":1542388540,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542388540","product_id":100020801,"comment_content":"分析器里面的语法分析，来晚啦😊","like_count":0},{"had_liked":false,"id":39904,"user_name":"披头","can_delete":false,"product_type":"c1","uid":1306172,"ip_address":"","ucode":"17DBF99412E77C","user_header":"https://static001.geekbang.org/account/avatar/00/13/ee/3c/bd106477.jpg","comment_is_top":false,"comment_ctime":1542380556,"is_pvip":false,"replies":[{"id":"14345","content":"谢谢你提出来。<br><br>是这样的，我再出问题的时候，确实是有意提“无法从文章中直接得到答案”的问题，这样可能有利有弊，我会认为利更多些。<br><br>在评论的内容里面有新的信息输入，这样这一整篇文章交付的内容更多，希望大家更有收获。<br><br>音频和文字会尽量一致，就是有些文本口语化说出来。","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542384863,"ip_address":"","comment_id":39904,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542380556","product_id":100020801,"comment_content":"课后习题对于小白来说有点超纲，从本文讲到的知识点很难得出正确的答案，以后可否照顾下小白同学，有部分读者是小白。知识点尽量不要省略，谢谢。<br><br>还有个小问题，文字和音频教学内容相比，不完全一致，如果有人选择了一种学习方式，会丢失一部分信息量。","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429283,"discussion_content":"谢谢你提出来。\n\n是这样的，我再出问题的时候，确实是有意提“无法从文章中直接得到答案”的问题，这样可能有利有弊，我会认为利更多些。\n\n在评论的内容里面有新的信息输入，这样这一整篇文章交付的内容更多，希望大家更有收获。\n\n音频和文字会尽量一致，就是有些文本口语化说出来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542384863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39846,"user_name":"轻歌赋","can_delete":false,"product_type":"c1","uid":1251574,"ip_address":"","ucode":"22F62446208805","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg","comment_is_top":false,"comment_ctime":1542365506,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542365506","product_id":100020801,"comment_content":"最后就作者的问题，分析为什么是分析器，因为文章中说了词法分析的时候会解析出查询的表，列等等，所以此时就应该能知道表列的存在性。而且从我个人的拙见来看，如果先一步判断出这种无法查询的错误，避免后续执行，则可以避免无谓的性能开销。而表列的数据较少，完全可以这里判断。<br>当然，也可以在句法分析的步骤判断，个人数据库不太熟悉，只能从程序设计的角度考虑，望各位大佬真诚的评论","like_count":0},{"had_liked":false,"id":39841,"user_name":"轻歌赋","can_delete":false,"product_type":"c1","uid":1251574,"ip_address":"","ucode":"22F62446208805","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg","comment_is_top":false,"comment_ctime":1542365216,"is_pvip":false,"replies":[{"id":"14306","content":"2. 在评论里搜 index_merge 😄<br>3. 执行过程可能会有触发器这些，还是得到这一步才判断。 但是为了安全，有一个precheck会在优化器之前判断一下权限","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542366403,"ip_address":"","comment_id":39841,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542365216","product_id":100020801,"comment_content":"第二个问题，优化器那里，为什么不是先查第一张表符合条件的字段，再查第二张表符合条件的字段，最后连接呢？<br>第三个问题，权限为什么不在句法分析之前呢，此时已经完成了词法分析，知道了查询的表和列了，完全可以分析","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429252,"discussion_content":"2. 在评论里搜 index_merge 😄\n3. 执行过程可能会有触发器这些，还是得到这一步才判断。 但是为了安全，有一个precheck会在优化器之前判断一下权限","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542366403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39837,"user_name":"落叶飞逝的恋","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1542364380,"is_pvip":false,"replies":[{"id":"14302","content":"不会缓存查询计划","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542365963,"ip_address":"","comment_id":39837,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542364380","product_id":100020801,"comment_content":"真实项目中依赖MySQL的查询缓存少之又少吧。不过之前看到文章有说MySQL会缓存执行计划吧，一般建议使用参数化查询就是想利用缓存执行计划提升性能吧！","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429249,"discussion_content":"不会缓存查询计划","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542365963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39763,"user_name":"毛毛","can_delete":false,"product_type":"c1","uid":1071536,"ip_address":"","ucode":"41361FCBC9CD9F","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/b0/76907d40.jpg","comment_is_top":false,"comment_ctime":1542351936,"is_pvip":false,"replies":[{"id":"14276","content":"看肯定没有“不适合”，可以了解不同的数据库机制，<br>我也学一些平时工作暂时不会用到的数据库，也会有助于我理解MySQL.","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542354909,"ip_address":"","comment_id":39763,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542351936","product_id":100020801,"comment_content":"老师，从参加工作一直接触的是SqlServer，适合看这个吗","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429215,"discussion_content":"看肯定没有“不适合”，可以了解不同的数据库机制，\n我也学一些平时工作暂时不会用到的数据库，也会有助于我理解MySQL.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542354909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39659,"user_name":"蛋炒番茄","can_delete":false,"product_type":"c1","uid":1095049,"ip_address":"","ucode":"3F963347C4A97C","user_header":"https://static001.geekbang.org/account/avatar/00/10/b5/89/9a1b4dee.jpg","comment_is_top":false,"comment_ctime":1542332586,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542332586","product_id":100020801,"comment_content":"为什么执行权限是放在执行器里面，而不是在分析器或者优化器里面，这样的话岂不是可以更加节省资源，耳不是等到执行的时候才返回权限不足","like_count":0},{"had_liked":false,"id":39650,"user_name":"lh_wsh","can_delete":false,"product_type":"c1","uid":1073887,"ip_address":"","ucode":"E8D89F09FF41F2","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/df/284f0de2.jpg","comment_is_top":false,"comment_ctime":1542331343,"is_pvip":false,"replies":[{"id":"14198","content":"就是语句做key, 这时候还没到分析器阶段，确实还没检查。 不过不影响逻辑正确性，你分析的时候要带上失效逻辑哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542337374,"ip_address":"","comment_id":39650,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542331343","product_id":100020801,"comment_content":"我有个疑问，上面说如果开启缓存查询在不命中的情况下开始执行分析器，分析语句，那么我发送语句的key是什么时候生成的还是直接拿语句作为key，这时候我过我语句的列中包含了错误的列名在这个阶段是不检查的吗？求指教啊，谢谢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429159,"discussion_content":"就是语句做key, 这时候还没到分析器阶段，确实还没检查。 不过不影响逻辑正确性，你分析的时候要带上失效逻辑哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542337374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39616,"user_name":"renew","can_delete":false,"product_type":"c1","uid":1306157,"ip_address":"","ucode":"15127C1F23DC59","user_header":"https://static001.geekbang.org/account/avatar/00/13/ee/2d/01a23ad4.jpg","comment_is_top":false,"comment_ctime":1542328760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542328760","product_id":100020801,"comment_content":"分析器吧","like_count":0},{"had_liked":false,"id":39572,"user_name":"Chenl07","can_delete":false,"product_type":"c1","uid":1089132,"ip_address":"","ucode":"0A0A086168A8F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0FI2bUjegtznv7XPC9DB9RJaqiaMiamWkibibPOibuUC3DCvI7XMvBANr6sDjRNbc1jwPic9pIaFxrdaib88VqUJKXSTQ/132","comment_is_top":false,"comment_ctime":1542325131,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542325131","product_id":100020801,"comment_content":"在执行器阶段会验证权限查询，这个权限认证是在连接器阶段读取权限缓存中验证还是又去查询一次数据库？如果是前者，连接器缓存的权限是固定的，如果中途修改了权限，对于一个已经存在的链接来说，其权限缓存不会跟随实际权限而变化，所以即便更新了权限，是不是执行器也获取不到最新？","like_count":0},{"had_liked":false,"id":39537,"user_name":"凉快","can_delete":false,"product_type":"c1","uid":1305139,"ip_address":"","ucode":"BD6DFC495B75CA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er17O1Y2B8WibUQgQDibrVvTPqwF6dF6bKJLWE7gg2M2mEgZ5cHicn6KUJYHp9gmJfuP4bqshCUxfnGA/132","comment_is_top":false,"comment_ctime":1542297730,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542297730","product_id":100020801,"comment_content":"分析器阶段啊，找不到对应的列","like_count":0},{"had_liked":false,"id":39517,"user_name":"五年","can_delete":false,"product_type":"c1","uid":1081224,"ip_address":"","ucode":"28A6F945FB0626","user_header":"https://static001.geekbang.org/account/avatar/00/10/7f/88/c4263c58.jpg","comment_is_top":false,"comment_ctime":1542294172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542294172","product_id":100020801,"comment_content":"词法分析吧; 关键字.","like_count":0},{"had_liked":false,"id":39512,"user_name":"位鹏飞","can_delete":false,"product_type":"c1","uid":1302596,"ip_address":"","ucode":"417F6CB41F9534","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/44/1c3cebf9.jpg","comment_is_top":false,"comment_ctime":1542293509,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542293509","product_id":100020801,"comment_content":"权限检查 放到  分析器这一层是不是更好一点呢？","like_count":0},{"had_liked":false,"id":39506,"user_name":"AA星星点灯","can_delete":false,"product_type":"c1","uid":1306238,"ip_address":"","ucode":"684C7FACCA4192","user_header":"https://static001.geekbang.org/account/avatar/00/13/ee/7e/955b686d.jpg","comment_is_top":false,"comment_ctime":1542292235,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542292235","product_id":100020801,"comment_content":"我感觉可以见名识义：分析器就是分析词法语法，对客户端发的sql语句进行分析，看语法符合不符合mysql的规定，发送的表名字段名在数据库找到找不到等等，如果一切通过了，就进行下一步处理。优化器很显然就是对确定了sql语句进行优化，比如是否使用索引、使用哪一种类型的索引等等。执行器就是真正的执行语句了。如果按这样理解的话存储过程、触发器、视图等都是在执行器进行的？","like_count":0},{"had_liked":false,"id":39496,"user_name":"随风燃烧","can_delete":false,"product_type":"c1","uid":1310492,"ip_address":"","ucode":"5B4EAA18E45FB6","user_header":"https://static001.geekbang.org/account/avatar/00/13/ff/1c/1eb756ad.jpg","comment_is_top":false,"comment_ctime":1542290572,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542290572","product_id":100020801,"comment_content":"分析器，原文里说&quot;MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。这个时候就可以知道k是不是有效","like_count":0},{"had_liked":false,"id":39489,"user_name":"wolf|▍奇葩","can_delete":false,"product_type":"c1","uid":1283222,"ip_address":"","ucode":"04B1BB06CF446E","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/96/520185f0.jpg","comment_is_top":false,"comment_ctime":1542289061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542289061","product_id":100020801,"comment_content":"老师，请问学习了mysql之后，还有必要学Oracle吗？是否会过时","like_count":0},{"had_liked":false,"id":39471,"user_name":"是我的海","can_delete":false,"product_type":"c1","uid":1197457,"ip_address":"","ucode":"4BCE240829676A","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/91/afda3094.jpg","comment_is_top":false,"comment_ctime":1542285622,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542285622","product_id":100020801,"comment_content":"光看评论就已经瑟瑟发抖了，各种大神显现","like_count":0},{"had_liked":false,"id":39463,"user_name":"_yiunia##远","can_delete":false,"product_type":"c1","uid":1138369,"ip_address":"","ucode":"AF508C3D0EB954","user_header":"https://static001.geekbang.org/account/avatar/00/11/5e/c1/cd721d46.jpg","comment_is_top":false,"comment_ctime":1542283427,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542283427","product_id":100020801,"comment_content":"针对缓存有个地方不解，专栏中说，只要对一个表更新，这个表上所以查询都会清空。mysql为什么不针对，影响的缓存进行更新呢？","like_count":0},{"had_liked":false,"id":39438,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1542276149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542276149","product_id":100020801,"comment_content":"很有收获","like_count":0},{"had_liked":false,"id":39433,"user_name":"最初的印象","can_delete":false,"product_type":"c1","uid":1228852,"ip_address":"","ucode":"4DD68307FA274E","user_header":"https://static001.geekbang.org/account/avatar/00/12/c0/34/0574bb44.jpg","comment_is_top":false,"comment_ctime":1542275261,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542275261","product_id":100020801,"comment_content":"分析器在进行词法分析的时候就会报k这个字的不存在的错误","like_count":0},{"had_liked":false,"id":39425,"user_name":"知行合一","can_delete":false,"product_type":"c1","uid":1303577,"ip_address":"","ucode":"855686AF1B6BE2","user_header":"","comment_is_top":false,"comment_ctime":1542272925,"is_pvip":false,"replies":[{"id":"14133","content":"其实操作的不多，所以采用音频的当时也差不多。后面我会更多的用图，来方便大家阅读","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542289777,"ip_address":"","comment_id":39425,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542272925","product_id":100020801,"comment_content":"奇哥，你好，请问我看这个课程，为什么只能听到你的声音，看不到你讲课时在你的电脑上操作数据库过程的图像呀？一般视频网站讲师讲课都会看到他们讲课时的图像，我听了你的第一节课后，觉得真的讲的十分精彩，但是就是有一个问题：只能听到你的声音，看不到你在你的电脑上操作的过程，如果你要是能让我们看到你在电脑上操作数据库的过程，那么我们听的结果会更好，听完后印象会更加深刻。所以想冒昧问问您，看您是否能够考虑一下，讲课时把操作数据库的过程的图像也让我们看到，要是您觉得不合适，那就算了，希望奇哥你能考虑一下，谢谢！","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429061,"discussion_content":"其实操作的不多，所以采用音频的当时也差不多。后面我会更多的用图，来方便大家阅读","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542289777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39415,"user_name":"Alex Qin","can_delete":false,"product_type":"c1","uid":1014706,"ip_address":"","ucode":"AA265A401EAD80","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/b2/55185ccd.jpg","comment_is_top":false,"comment_ctime":1542271165,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542271165","product_id":100020801,"comment_content":"在分析器的词法分析阶段，因为会分析“字符串ID”为“列ID”","like_count":0},{"had_liked":false,"id":39408,"user_name":"Alex Qin","can_delete":false,"product_type":"c1","uid":1014706,"ip_address":"","ucode":"AA265A401EAD80","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/b2/55185ccd.jpg","comment_is_top":false,"comment_ctime":1542268246,"is_pvip":false,"replies":[{"id":"14084","content":"留了一个契子😄 后面会有文章提到","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542272798,"ip_address":"","comment_id":39408,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542268246","product_id":100020801,"comment_content":"rows_examined与引擎扫描行数不完全相同，看文章根本没看懂为啥...","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429054,"discussion_content":"留了一个契子😄 后面会有文章提到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542272798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39394,"user_name":"　　　　","can_delete":false,"product_type":"c1","uid":1093389,"ip_address":"","ucode":"CBA429900EAC17","user_header":"https://static001.geekbang.org/account/avatar/00/10/af/0d/04df774f.jpg","comment_is_top":false,"comment_ctime":1542263836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542263836","product_id":100020801,"comment_content":"按理是在分析器这里返回的，库中是否有表，是否有表中的字段，这个应该在最前面就做判断了。而不是要等到执行的时候才来报错返回。","like_count":0},{"had_liked":false,"id":39387,"user_name":"壹朴心","can_delete":false,"product_type":"c1","uid":1035255,"ip_address":"","ucode":"D8E91CE87A5331","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/f7/229a4fc7.jpg","comment_is_top":false,"comment_ctime":1542261377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542261377","product_id":100020801,"comment_content":"分析器：分解句子，检查语法，不进行存在性检测。<br>优化器：演习查询，择优而行，故，对表名、字段名有判断。","like_count":0},{"had_liked":false,"id":39374,"user_name":"蓝士钦","can_delete":false,"product_type":"c1","uid":1229516,"ip_address":"","ucode":"726EB5C8EF1249","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","comment_is_top":false,"comment_ctime":1542258603,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542258603","product_id":100020801,"comment_content":"我觉得“Unknown column”这个错误是执行器返回的，理由如下：<br>1.分析器做词法和语法分析，只关心词法和对应的sql语句，判断哪些字符是表，哪些字符是列等<br>2.优化器：针对索引进行优化处理，根据分析器得到的列去判断是否有索引，索引是否存在和是否存在列无关，如果传入一个“K”列，优化器只是会判断找不到该列索引而已<br>3.执行器最终执行sql，才打开表进行执行，这时候才可以判断哪些列不存在。","like_count":0},{"had_liked":false,"id":39350,"user_name":"chen","can_delete":false,"product_type":"c1","uid":1305421,"ip_address":"","ucode":"E104F15FC48846","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/4d/80ab09d9.jpg","comment_is_top":false,"comment_ctime":1542252146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542252146","product_id":100020801,"comment_content":"词法分析吗","like_count":0},{"had_liked":false,"id":39345,"user_name":"Luke","can_delete":false,"product_type":"c1","uid":1216016,"ip_address":"","ucode":"C34D4C44DBCE03","user_header":"https://static001.geekbang.org/account/avatar/00/12/8e/10/10092bb1.jpg","comment_is_top":false,"comment_ctime":1542251601,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542251601","product_id":100020801,"comment_content":"分析器阶段的词法分析阶段。<br><br>对于其他人说的权限错误的例子，我的理解是，在发现错误的时候也需要通过执行器。<br><br>执行器首先检查权限，以确定你是否有知道表字段错误的权限，否则会有暴露表结构的风险。","like_count":0},{"had_liked":false,"id":39334,"user_name":"简单的幸福","can_delete":false,"product_type":"c1","uid":1019154,"ip_address":"","ucode":"B1A441371D7B72","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/12/99ebe783.jpg","comment_is_top":false,"comment_ctime":1542250452,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542250452","product_id":100020801,"comment_content":"是在分析器这个阶段报出来的么？","like_count":0},{"had_liked":false,"id":39332,"user_name":"栗子的栗子","can_delete":false,"product_type":"c1","uid":1109895,"ip_address":"","ucode":"482645D358ADD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/87/7b399946.jpg","comment_is_top":false,"comment_ctime":1542250222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542250222","product_id":100020801,"comment_content":"应该是执行器，前几个阶段并没有打开表","like_count":0},{"had_liked":false,"id":39328,"user_name":"余焱林ॐ","can_delete":false,"product_type":"c1","uid":1040436,"ip_address":"","ucode":"01234897C5AFB4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e0/34/0a229e32.jpg","comment_is_top":false,"comment_ctime":1542249615,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542249615","product_id":100020801,"comment_content":"我的答案是词法分析器，从老师讲的内容来推断的<br><br>词法分析器进行的操作是：需要识别出里面的字符串分别是什么，代表什么，MySQL 从你输入的&quot;select&quot;这个关键字识别出来，把字符串T识别成表名T，把ID识别成列ID","like_count":0},{"had_liked":false,"id":39321,"user_name":"小铁匠","can_delete":false,"product_type":"c1","uid":1033990,"ip_address":"","ucode":"E99124E3F888EB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c7/06/9485d9ab.jpg","comment_is_top":false,"comment_ctime":1542248282,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542248282","product_id":100020801,"comment_content":"我觉得是分析器阶段，看分析是否合理：<br>上面那四个步骤这样理解：客户端跟MySQL建立连接，然后告诉MySQL 执行什么、怎么执行、真正执行。文中的问题是要解决执行什么。<br>分析器阶段，会根据关键字生成一颗解析树，做词法和语法分析。这个时候已经明确知道要执行什么了，这个时候最适合让MySQL预处理器来对库表是否存在做判断。优化器要解决怎么执行，走什么路经，这本身就是个很复杂的过程，想着不会留到这一步;优化器都确定好怎么执行了，更不可能放到执行器才判断表和字段是否存在了。","like_count":0},{"had_liked":false,"id":39307,"user_name":"ISADBA","can_delete":false,"product_type":"c1","uid":1302119,"ip_address":"","ucode":"08FDB8F685CD59","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/67/0a8fe54e.jpg","comment_is_top":false,"comment_ctime":1542245593,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542245593","product_id":100020801,"comment_content":"发音很标准，音色很磁性，有播音员的潜质。🍻","like_count":0},{"had_liked":false,"id":39293,"user_name":"不忘初心","can_delete":false,"product_type":"c1","uid":1302204,"ip_address":"","ucode":"5BC8A5DD41012F","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/bc/1245cd12.jpg","comment_is_top":false,"comment_ctime":1542244479,"is_pvip":false,"replies":[{"id":"14052","content":"应用如果重新连接了，就不会报异常了。 其实数据库断开了连接，就是希望客户端重连的哦","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542248551,"ip_address":"","comment_id":39293,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542244479","product_id":100020801,"comment_content":"老师，你好，我想问下，数据库连接默认保持8个小时，8个小时失去连接后，应用会重新连接，这个时候数据库会报异常，这个时候数据库是不会返回数据的是吗，是下次再次连接得时候才会返回数据吗","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429001,"discussion_content":"应用如果重新连接了，就不会报异常了。 其实数据库断开了连接，就是希望客户端重连的哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542248551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39280,"user_name":"itdream","can_delete":false,"product_type":"c1","uid":1042083,"ip_address":"","ucode":"D3E9766072A819","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e6/a3/029c8df3.jpg","comment_is_top":false,"comment_ctime":1542243263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542243263","product_id":100020801,"comment_content":"感觉是执行器，查询完第一行，发现没有 k 字段，报错。","like_count":0},{"had_liked":false,"id":39266,"user_name":"self-discipline","can_delete":false,"product_type":"c1","uid":1024457,"ip_address":"","ucode":"A5AEDCA9ACC68A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/c9/501a1d02.jpg","comment_is_top":false,"comment_ctime":1542241528,"is_pvip":false,"replies":[{"id":"14053","content":"没理解你的问题，这个value就是查询结果，返回给客户端，客户端就能看到结果了","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542248626,"ip_address":"","comment_id":39266,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542241528","product_id":100020801,"comment_content":"问题3:查询缓存的问题:之前执行过的语句及其结果可能会以 key-value 对的形式,那么实际是如何处理的处理的呢?","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428989,"discussion_content":"没理解你的问题，这个value就是查询结果，返回给客户端，客户端就能看到结果了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542248626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39252,"user_name":"cyberbit","can_delete":false,"product_type":"c1","uid":1303197,"ip_address":"","ucode":"1BD53A25F5277F","user_header":"https://static001.geekbang.org/account/avatar/00/13/e2/9d/fbbd4611.jpg","comment_is_top":false,"comment_ctime":1542240006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542240006","product_id":100020801,"comment_content":"分析器，老师文章里已经暗示答案。觉得老师讲的深入浅出，容易接受，挺好的，期待下一篇。","like_count":0},{"had_liked":false,"id":39248,"user_name":"Hesher","can_delete":false,"product_type":"c1","uid":1026832,"ip_address":"","ucode":"99AB8B1704CB7E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ab/10/b812ff3e.jpg","comment_is_top":false,"comment_ctime":1542239595,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542239595","product_id":100020801,"comment_content":"不看其他答案，我觉得放在分析器或优化器都可以，看具体实现了。看完那个trace log，明显优化器。","like_count":0},{"had_liked":false,"id":39235,"user_name":"考拉出山","can_delete":false,"product_type":"c1","uid":1303954,"ip_address":"","ucode":"917E35FD7B2D06","user_header":"https://wx.qlogo.cn/mmopen/vi_32/1mOvT5fApeicXppMP3zADG6XIPicNt5D9dL6y46SF5UUcH0hicG21LM6xSgHJj5oAdzCyeGtLZYHYmlvaFwecrGOA/132","comment_is_top":false,"comment_ctime":1542215051,"is_pvip":false,"replies":[{"id":"14057","content":"查询的时候权限不存在是在执行前单独多的一次判断，是为了安全考虑。就是如果没有权限，你连“字段不存在”这个信息都不应该暴露给客户端","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542249018,"ip_address":"","comment_id":39235,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542215051","product_id":100020801,"comment_content":"末尾问题有个疑问。是在分析器里面检查的列是否存在。且文章中说到执行器会检查有没有权限。那为什么一个没有查询权限的用户进行查询语句，提示的是&quot;没有权限&quot;而不是&quot;列不存在&quot;。按照这个逻辑权限应该是在执行器做的，那这个&quot;权限不存在&quot;是哪个模块检查的？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428976,"discussion_content":"查询的时候权限不存在是在执行前单独多的一次判断，是为了安全考虑。就是如果没有权限，你连“字段不存在”这个信息都不应该暴露给客户端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542249018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39226,"user_name":"橡皮泥boy","can_delete":false,"product_type":"c1","uid":1011863,"ip_address":"","ucode":"478F5417EDD249","user_header":"https://static001.geekbang.org/account/avatar/00/0f/70/97/e5bf9ddb.jpg","comment_is_top":false,"comment_ctime":1542212385,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542212385","product_id":100020801,"comment_content":"【回答问题】<br>我觉得在优化器的阶段就可以检测出k是不存在的一列。因为在这之前的语法分析仅限于mysql的语法，没跟表结构有任何关系。而在优化器阶段会读取表结构，来确定这条语句应该走什么样的扫描逻辑，是命中索引还是得全表扫描。这里有了表结构自然就能判断出查询的列是否存在。","like_count":0},{"had_liked":false,"id":39222,"user_name":"玉芟","can_delete":false,"product_type":"c1","uid":1058187,"ip_address":"","ucode":"42A49FBA69C59F","user_header":"","comment_is_top":false,"comment_ctime":1542212167,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542212167","product_id":100020801,"comment_content":"Maybe:<br>sql_parse sql_optimizer sql_executor<br>Conclusion:<br>sql_parse<br>Version: 8.0.13<br>Call Stack:<br>::my_message_sql(uint, const char *, myf) mysqld.cc:2974<br>my_error(int, int, ...) my_error.cc:247<br>find_field_in_tables(THD*, Item_ident*, TABLE_LIST*, TABLE_LIST*, Item**, find_item_error_report_type, unsigned long, bool) sql_base.cc:7750<br>Item_field::fix_outer_field(THD*, Field**, Item**) item.cc:4949<br>Item_field::fix_fields(THD*, Item**) item.cc:5221<br>Item_func::fix_func_arg(THD*, Item**) item_fucc.cc:293<br>Item_func::fix_fields(THD*, Item**) item_fucc.cc:282<br>SELECT_LEX::setup_conds(THD*) sql_resolver.cc:1278<br>SELECT_LEX::prepare(THD*) sql_resolver.cc:264<br>Sql_cmd_select::prepare_inner(THD*) sql_select.cc:466<br>Sql_cmd_dml::prepare(THD*) sql_select.cc:405<br>Sql_cmd_dml::execute(THD*) sql_select.cc:533<br>mysql_execute_command(THD*, bool) sql_parse.cc:4307<br>mysql_parse(THD*, Parser_state*, bool) sql_parse.cc:5041<br>dispatch_command(THD*, COM_DATA const*, enum_server_command) sql_parse.cc:1687<br>do_command(THD*) sql_parse.cc:1260","like_count":0},{"had_liked":false,"id":39218,"user_name":"tobeageek","can_delete":false,"product_type":"c1","uid":1062934,"ip_address":"","ucode":"7E78B925DC0763","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIz50ciaONXadCf0QgqjbJCNq7r6KYpKzGibMic47DDrdym1Bnseq6Sk5lHkLlfOSArlQzw3a6MSrjTw/132","comment_is_top":false,"comment_ctime":1542211385,"is_pvip":false,"replies":[{"id":"14060","content":"有加密，中间还有涉及挑战码和加盐操作；<br><br>是的，所以后来有了线程池方案","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542249904,"ip_address":"","comment_id":39218,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542211385","product_id":100020801,"comment_content":"再问个问题，文中提到的-p 输入密码，这个密码在传输过程中加密吗？使用的是什么加密方法？<br>还有MySQL中处理网络连接有的是one thread per connection，这种情况下并发连接数是不是很受限？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428969,"discussion_content":"有加密，中间还有涉及挑战码和加盐操作；\n\n是的，所以后来有了线程池方案","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542249904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39213,"user_name":"缘分呐","can_delete":false,"product_type":"c1","uid":1031748,"ip_address":"","ucode":"6A23397F1947D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/44/1320215f.jpg","comment_is_top":false,"comment_ctime":1542210476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542210476","product_id":100020801,"comment_content":"林老师，我看您留言里解答说是分析器阶段去更新的缓存，难道不是应该在执行器阶段取到了结果再去更新缓存的吗？先谢谢了。","like_count":0},{"had_liked":false,"id":39206,"user_name":"董怿博","can_delete":false,"product_type":"c1","uid":1302757,"ip_address":"","ucode":"191742A2D5F665","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/e5/8b09c406.jpg","comment_is_top":false,"comment_ctime":1542209356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542209356","product_id":100020801,"comment_content":"我觉得应该是分析器阶段。根据老师说的，分析器做词法分析，通过select关键字知道是查询语句，也知道把t识别成表名，但是到了k的时候，它就不知道k是什么了，语法规则就有问题了。我觉得应该是分析器，不知道对不对啊","like_count":0},{"had_liked":false,"id":39204,"user_name":"zyy","can_delete":false,"product_type":"c1","uid":1048515,"ip_address":"","ucode":"1D0B2BD7E93C64","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ff/c3/b90b862c.jpg","comment_is_top":false,"comment_ctime":1542209305,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542209305","product_id":100020801,"comment_content":"优化器选择执行方案，那就应该知道表的结构，才能选择最优，在这里已经知道了表的结构。然后不存在的字段进行了报错！","like_count":0},{"had_liked":false,"id":39203,"user_name":"书策稠浊","can_delete":false,"product_type":"c1","uid":1307497,"ip_address":"","ucode":"A29875CE15FDA3","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg","comment_is_top":false,"comment_ctime":1542209242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542209242","product_id":100020801,"comment_content":"对于最后的问题，我认为是优化器，因为优化器就是对sql语句进行分析优化了，肯定已经对字段和表进行了一些分析了，不然怎么确定索引和执行顺序。然后在这个过程中发现根本没有k这个字段，就会报错了。","like_count":0},{"had_liked":false,"id":39201,"user_name":"Nick","can_delete":false,"product_type":"c1","uid":1303145,"ip_address":"","ucode":"D453E42B9A8429","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKa0PdjFnEpvGFBcED2P28ugPmwwRoCbeUfulpGEye8964F4nwChQyVfgVUia74TyDISvXTYJfQpA/132","comment_is_top":false,"comment_ctime":1542208925,"is_pvip":false,"replies":[{"id":"14063","content":"另一个评论中回复了哈","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542250213,"ip_address":"","comment_id":39201,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542208925","product_id":100020801,"comment_content":"两表inner join的例子，可不可以 先取出两表中符合条件的记录，然后在做join？感觉效率更高","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428962,"discussion_content":"另一个评论中回复了哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542250213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39200,"user_name":"Lervin","can_delete":false,"product_type":"c1","uid":1304424,"ip_address":"","ucode":"D51A8782D42981","user_header":"https://static001.geekbang.org/account/avatar/00/13/e7/68/339e5c6d.jpg","comment_is_top":false,"comment_ctime":1542208863,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542208863","product_id":100020801,"comment_content":"只是表结构的话数据量不会大  分析表结构就不需要到执行打开表了吧  越早发现成本越低 应该分析器吧","like_count":0},{"had_liked":false,"id":39197,"user_name":"小森","can_delete":false,"product_type":"c1","uid":1152660,"ip_address":"","ucode":"48073DE2A74A89","user_header":"https://static001.geekbang.org/account/avatar/00/11/96/94/5cc0704f.jpg","comment_is_top":false,"comment_ctime":1542207795,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542207795","product_id":100020801,"comment_content":"个人认为是优化器的，优化器会对即将执行的sql进行优化分析，分析器只是针对sql的语法分析，语法分析，优化器会生成执行计划","like_count":0},{"had_liked":false,"id":39193,"user_name":"Lugyedo","can_delete":false,"product_type":"c1","uid":1011793,"ip_address":"","ucode":"EB5E456B638E70","user_header":"https://static001.geekbang.org/account/avatar/00/0f/70/51/f1825adb.jpg","comment_is_top":false,"comment_ctime":1542206991,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1542206991","product_id":100020801,"comment_content":"创建了一个没有select权限的用户，执行select * from T where k=1，报错“select command denied”，并没有报错“unknown column&quot;<br><br>在文章中老师说在执行器里面才校验权限，如果是在分析器或优化器里判断列名是否正确的话，还会到执行器吗？","like_count":0,"discussions":[{"author":{"id":1314724,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/a4/0b49469f.jpg","nickname":"木子00","note":"","ucode":"8F78CA722EB29B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273504,"discussion_content":"都没select 权限当然提示你select command denied ,难道提示unknow column吗?\n你要进一个房间找手机,你都没有钥池,能告诉你房间里有没有手机吗? 当然告诉你打不开门了.\n分析器:词法分析,语法分析.(T识别为表T,ID识别为字段\nID,这里只是识别.不代表就有T这个表,ID字段就有这个ID字段.)\n优化器:索引选择等.\n执行器: 是真正执行的地方.在执行前判断权限.文章些的很清楚的.","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590464664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39190,"user_name":"栋能","can_delete":false,"product_type":"c1","uid":1006849,"ip_address":"","ucode":"8BD9C939D3E8E1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/01/9cd84003.jpg","comment_is_top":false,"comment_ctime":1542205980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542205980","product_id":100020801,"comment_content":"太棒了... 收获好多经验","like_count":0},{"had_liked":false,"id":39183,"user_name":"出水肥龙","can_delete":false,"product_type":"c1","uid":1303749,"ip_address":"","ucode":"562D5649877B6C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/nfMuwekkR3iccibe2UbNyQZJeqoQcztutJLWk2WcxaDXnwQzffiarGDU0X33SV93Vic19ibArw3ic0ICg5smVKq0U6rQ/132","comment_is_top":false,"comment_ctime":1542205431,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542205431","product_id":100020801,"comment_content":"终于等到了第一篇","like_count":0},{"had_liked":false,"id":39182,"user_name":"刘lx","can_delete":false,"product_type":"c1","uid":1304875,"ip_address":"","ucode":"8DE6F222711CAF","user_header":"https://static001.geekbang.org/account/avatar/00/13/e9/2b/423eaa3e.jpg","comment_is_top":false,"comment_ctime":1542205365,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542205365","product_id":100020801,"comment_content":"我认为是分析器的词法分析阶段，词法分析的方法就是把识别sql关键字和表、字段名，如果这个字段没有定义，分析器是没办法知道这个词到底是个表名还是字段名或者是拼错的关键字，就会把不能识别的位置报出来。","like_count":0},{"had_liked":false,"id":39158,"user_name":"Oathkeeper","can_delete":false,"product_type":"c1","uid":1303702,"ip_address":"","ucode":"9B8BEB0D7A5928","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/96/d37599ff.jpg","comment_is_top":false,"comment_ctime":1542200575,"is_pvip":false,"replies":[{"id":"13983","content":"多谢，不过不敢跟经典对比，希望换一个方式阐述，并有效😁","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542205990,"ip_address":"","comment_id":39158,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542200575","product_id":100020801,"comment_content":"优秀！感觉结构方面比《高性能MySQL》更清晰，也许是这种复杂的内容不适合在32k的纸上表现…","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428945,"discussion_content":"多谢，不过不敢跟经典对比，希望换一个方式阐述，并有效😁","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542205990,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39145,"user_name":"陈军海-Hugo","can_delete":false,"product_type":"c1","uid":1306044,"ip_address":"","ucode":"D21140331DFD8D","user_header":"https://static001.geekbang.org/account/avatar/00/13/ed/bc/b1bb959e.jpg","comment_is_top":false,"comment_ctime":1542198714,"is_pvip":false,"replies":[{"id":"13989","content":"好的，后面的文章会多用图😄","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542207556,"ip_address":"","comment_id":39145,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542198714","product_id":100020801,"comment_content":"希望在配图上丰富一点，尽量将原理展现出来就更好了","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428939,"discussion_content":"好的，后面的文章会多用图😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542207556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39135,"user_name":"cody","can_delete":false,"product_type":"c1","uid":1005907,"ip_address":"","ucode":"C6F372292D2D70","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/53/e63382fd.jpg","comment_is_top":false,"comment_ctime":1542196319,"is_pvip":false,"replies":[{"id":"13987","content":"我也是会被评论的问题提醒到，感觉真是额外赚到：）","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542206967,"ip_address":"","comment_id":39135,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542196319","product_id":100020801,"comment_content":"看评论里作者这么耐心地回复解答，真是赞，而且从别人的解答里也能学到不少东西","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428935,"discussion_content":"我也是会被评论的问题提醒到，感觉真是额外赚到：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542206967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39128,"user_name":"潮汐","can_delete":false,"product_type":"c1","uid":1042208,"ip_address":"","ucode":"F5E4F6DF9CEA9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e7/20/70a95f94.jpg","comment_is_top":false,"comment_ctime":1542194727,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1542194727","product_id":100020801,"comment_content":"学习了！逻辑清晰，明白易懂。下面的评论都有各自的思考方式和猜测方式，也有很细致的读者提出文中的错误地方或建议，看评论都能学到好多东西！","like_count":0},{"had_liked":false,"id":39126,"user_name":"JRich","can_delete":false,"product_type":"c1","uid":1114901,"ip_address":"","ucode":"66AE9D61533960","user_header":"https://static001.geekbang.org/account/avatar/00/11/03/15/293a185d.jpg","comment_is_top":false,"comment_ctime":1542194467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542194467","product_id":100020801,"comment_content":"答案很明显了，作者已经在文章里说了，字符串id会替换成列id","like_count":0},{"had_liked":false,"id":39123,"user_name":"wyatt","can_delete":false,"product_type":"c1","uid":1101681,"ip_address":"","ucode":"5450F44FA69B74","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/71/801e175f.jpg","comment_is_top":false,"comment_ctime":1542194048,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542194048","product_id":100020801,"comment_content":"从trace日志，Complete optimizer trace看出，答案是优化器。<br>“分析器先会做“词法分析”。你输入的是由多个字符串和空格组成的一条 SQL 语句，MySQL 需要识别出里面的字符串分别是什么，代表什么。<br><br>MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。”<br><br>老师上面所说的词法分析阶段字符串k识别成“列k”，这里识别过程没有对应列k，会跳过而不报错么？能否说下具体识别流程呢，谢谢。","like_count":0},{"had_liked":false,"id":39119,"user_name":"Eason Tai","can_delete":false,"product_type":"c1","uid":1200676,"ip_address":"","ucode":"4707577CC9C9E9","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/24/bd63c4de.jpg","comment_is_top":false,"comment_ctime":1542192712,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542192712","product_id":100020801,"comment_content":"原文: <br>MySQL 从你输入的&quot;select&quot;这个关键字识别出来，这是一个查询语句。它也要把字符串“T”识别成“表名 T”，把字符串“ID”识别成“列 ID”。<br><br>如果，换成问题，需要把K识别成 列K，如果没有 列K 就直接报错了。","like_count":0},{"had_liked":false,"id":39118,"user_name":"Lynn","can_delete":false,"product_type":"c1","uid":1100272,"ip_address":"","ucode":"83A0CF04C7049C","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/f0/a35f60a5.jpg","comment_is_top":false,"comment_ctime":1542192541,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542192541","product_id":100020801,"comment_content":"mysql.user 表中是没有这个用户的，为什么显示 unauthenticated user呢？","like_count":0},{"had_liked":false,"id":39113,"user_name":"daka","can_delete":false,"product_type":"c1","uid":1307998,"ip_address":"","ucode":"A23D82FF956793","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ8ibLXicovSNwEJhP4BOIPxEMle1ZUq1He58xztgBXTQFicdp5m5ibRHwUSoUVk5xQMWFwFXhp56ibm1Q/132","comment_is_top":false,"comment_ctime":1542189880,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542189880","product_id":100020801,"comment_content":"答案应该是语法分析阶段","like_count":0},{"had_liked":false,"id":39112,"user_name":"S@Y@M","can_delete":false,"product_type":"c1","uid":1297700,"ip_address":"","ucode":"F5658220C883FA","user_header":"https://static001.geekbang.org/account/avatar/00/13/cd/24/76b56b0b.jpg","comment_is_top":false,"comment_ctime":1542189729,"is_pvip":false,"replies":[{"id":"13943","content":"普通select不会，后面关注事务这一讲，会讲到🤝","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542192117,"ip_address":"","comment_id":39112,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542189729","product_id":100020801,"comment_content":"查询视图时，会锁定创建视图的相关表吗？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428924,"discussion_content":"普通select不会，后面关注事务这一讲，会讲到🤝","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39106,"user_name":"lhs","can_delete":false,"product_type":"c1","uid":1252206,"ip_address":"","ucode":"41178CC21337FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/6e/1bc87ac8.jpg","comment_is_top":false,"comment_ctime":1542189216,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542189216","product_id":100020801,"comment_content":"优化器","like_count":0},{"had_liked":false,"id":39101,"user_name":"Lynn","can_delete":false,"product_type":"c1","uid":1100272,"ip_address":"","ucode":"83A0CF04C7049C","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/f0/a35f60a5.jpg","comment_is_top":false,"comment_ctime":1542188665,"is_pvip":false,"replies":[{"id":"13946","content":"这个是验证完了，结果就是这个连接是 unauthenticated …","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542192357,"ip_address":"","comment_id":39101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542188665","product_id":100020801,"comment_content":"| 55584 | unauthenticated user | 172.16.8.112:33078 | NULL      | Connect |    0 | Receiving from client      | NULL             |<br><br>老师你好，我本地测试表中没有匿名用户这里为什么状态显示未验证的呢，不是在连接层已经验证好用户名密码是否正确，才允许这个线程连接进来，那为什么会是unauthenticated user 呢？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428919,"discussion_content":"这个是验证完了，结果就是这个连接是 unauthenticated …","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39100,"user_name":"开开心心","can_delete":false,"product_type":"c1","uid":1203132,"ip_address":"","ucode":"42AB03AA49628E","user_header":"https://static001.geekbang.org/account/avatar/00/12/5b/bc/c3bcd529.jpg","comment_is_top":false,"comment_ctime":1542188621,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542188621","product_id":100020801,"comment_content":"分析器吧","like_count":0},{"had_liked":false,"id":39080,"user_name":"遥遥无妻","can_delete":false,"product_type":"c1","uid":1251243,"ip_address":"","ucode":"30A765B411D059","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/ab/c0235b70.jpg","comment_is_top":false,"comment_ctime":1542184689,"is_pvip":false,"replies":[{"id":"13949","content":"连接器从系统取（这里面涉及到读表，涉及到逻辑操作）结果存在内存变量里面。 执行器使用这个变量","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542192562,"ip_address":"","comment_id":39080,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542184689","product_id":100020801,"comment_content":"麻烦问下，第一步连接器的时候会进行权限验证，连接器会到权限表里面查出你拥有的权限。之后，这个连接里面的权限逻辑判断，都依赖于此时读到的权限。但是在执行器在执行的时候又会判断对这个表是不是有权限执行查询。连接器那一步拿到的权限是什么，代表当前用户能看到那些表还是怎么？执行器对权限进行判断的时候，也是从第一步中的权限表中获取到是否能执行这次查询有没有权限？这两步的权限有什么不同？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428911,"discussion_content":"连接器从系统取（这里面涉及到读表，涉及到逻辑操作）结果存在内存变量里面。 执行器使用这个变量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542192562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39075,"user_name":"小文同学","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1542183558,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542183558","product_id":100020801,"comment_content":"执行器是打开表，但不一定需要打开表才能知道表结构。<br>表结构是存储在information_schema的，我想在MySQL的定义里，数据读写有权限，结构的信息并没有那么保密。<br>在优化器里，MySQL Server 层会根据表结构的信息来对SQL语句进行优化，这里是最有可能判断出字段是否存在，并报错。我觉得思考题答案应该是优化器，而不需要是执行器。","like_count":0},{"had_liked":false,"id":39051,"user_name":"坏淡一个","can_delete":false,"product_type":"c1","uid":1118181,"ip_address":"","ucode":"D9C39F4133D9D6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplMzkLgvebhLujCZI0DZAWS7MQGvYGHb4yeoDHdITVWpbSicvoVKw0dISm9ib3vYU7BqxrmuTV666g/132","comment_is_top":false,"comment_ctime":1542179294,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542179294","product_id":100020801,"comment_content":"首先排除掉连接器和查询缓存，优化器要决定用哪个索引，以及多表关联的时候，决定各个表的连接顺序，那么肯定要用到where后面的条件，不然怎么判断优化？所以要在这个阶段或这个阶段之前检查列，执行器就可以排除，分析器、优化器都有可能，表结构是提前定义好的，我觉得在分析器阶段就可以完成，优化器只负责优化好了，没必要多个判断列是否存在的功能","like_count":0},{"had_liked":false,"id":39021,"user_name":"磊","can_delete":false,"product_type":"c1","uid":1070732,"ip_address":"","ucode":"858BF8BFBFB0B8","user_header":"https://static001.geekbang.org/account/avatar/00/10/56/8c/a8317e23.jpg","comment_is_top":false,"comment_ctime":1542173336,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542173336","product_id":100020801,"comment_content":"检查表中列是否存在，应该是在执行器的时候。","like_count":0},{"had_liked":false,"id":39020,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1082793,"ip_address":"","ucode":"55E90A89D5BCB4","user_header":"https://static001.geekbang.org/account/avatar/00/10/85/a9/d31b7f43.jpg","comment_is_top":false,"comment_ctime":1542173290,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542173290","product_id":100020801,"comment_content":"优化器，分析器主要分析语法吧","like_count":0},{"had_liked":false,"id":39019,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1305125,"ip_address":"","ucode":"7AD5F060C54077","user_header":"","comment_is_top":false,"comment_ctime":1542173193,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542173193","product_id":100020801,"comment_content":"应该是分析器阶段词法分析时报错的","like_count":0},{"had_liked":false,"id":39011,"user_name":"饼子","can_delete":false,"product_type":"c1","uid":1085953,"ip_address":"","ucode":"981A44836A5216","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/01/c723d180.jpg","comment_is_top":false,"comment_ctime":1542172022,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542172022","product_id":100020801,"comment_content":"优化器，按照正常逻辑，会层层过滤，在最终执行的时候应该是一个准确的sql语句！如果将表字段丢给执行器判断，这样会对执行器带来太多压力。","like_count":0},{"had_liked":false,"id":39008,"user_name":"猿人谷","can_delete":false,"product_type":"c1","uid":1100149,"ip_address":"","ucode":"85106C7FB14C43","user_header":"https://static001.geekbang.org/account/avatar/00/10/c9/75/62ce2d69.jpg","comment_is_top":false,"comment_ctime":1542171550,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542171550","product_id":100020801,"comment_content":"优化器","like_count":0},{"had_liked":false,"id":39001,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1118976,"ip_address":"","ucode":"35F4FFAC4A4B15","user_header":"https://static001.geekbang.org/account/avatar/00/11/13/00/a4a2065f.jpg","comment_is_top":false,"comment_ctime":1542170160,"is_pvip":false,"replies":[{"id":"13922","content":"后面有文章会讲到explain 结果的表示的意思","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542175999,"ip_address":"","comment_id":39001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542170160","product_id":100020801,"comment_content":"老师是否会将 MySQL 查询计划 explain，以便我们自己在分析SQL的时候能够做得更好 ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428878,"discussion_content":"后面有文章会讲到explain 结果的表示的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542175999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38976,"user_name":"子夜2104","can_delete":false,"product_type":"c1","uid":1070286,"ip_address":"","ucode":"C4FF54AEA6002F","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/ce/92029d2f.jpg","comment_is_top":false,"comment_ctime":1542165522,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542165522","product_id":100020801,"comment_content":"回答问题:<br>在分析器中执行的，因为分析器中的词法分析会识别语句中的词是否是表中的列。","like_count":0},{"had_liked":false,"id":38972,"user_name":"蚂蚁小黑","can_delete":false,"product_type":"c1","uid":1305205,"ip_address":"","ucode":"DE79F0D72C7062","user_header":"https://static001.geekbang.org/account/avatar/00/13/ea/75/6644f028.jpg","comment_is_top":false,"comment_ctime":1542164260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542164260","product_id":100020801,"comment_content":"分析器阶段","like_count":0},{"had_liked":false,"id":38971,"user_name":"孙彦奎","can_delete":false,"product_type":"c1","uid":1305374,"ip_address":"","ucode":"14531EA119E6CB","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/1e/ddc1b53d.jpg","comment_is_top":false,"comment_ctime":1542164117,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542164117","product_id":100020801,"comment_content":"个人认为：<br>1，mysql在分析器时，做的是语法分析。<br>2，在分析器之后，还有个模块（访问控制模块），此模块用于调用存储引擎，打开表，检查相关表、列等权限（在有些书中可能叫预处理器或其他名字，见高可用），这应该叫做语义分析。<br>3，前两步完成后，来到优化器，对sql进行重写，生成执行计划（cbo+rbo）<br>","like_count":0},{"had_liked":false,"id":38967,"user_name":"鹏飞天下","can_delete":false,"product_type":"c1","uid":1101792,"ip_address":"","ucode":"EB9FFD9FE64A4C","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/e0/f6819d03.jpg","comment_is_top":false,"comment_ctime":1542163701,"is_pvip":false,"replies":[{"id":"13919","content":"是，之后如果你保持连接的话。 所以如果5.7以上建议用mysql_reset_connection方法","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542164763,"ip_address":"","comment_id":38967,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542163701","product_id":100020801,"comment_content":"&quot;MySQL执行过程中临时使用的内存是管理在连接对象里面的&quot;，是不是我们建立连接里面使用的内存就是连接中每次查询数据<br>最大量时候占用的内存？？","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428867,"discussion_content":"是，之后如果你保持连接的话。 所以如果5.7以上建议用mysql_reset_connection方法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542164763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38966,"user_name":"BigMortal","can_delete":false,"product_type":"c1","uid":1302057,"ip_address":"","ucode":"6236118A0FFCBB","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/29/71685b0b.jpg","comment_is_top":false,"comment_ctime":1542163345,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542163345","product_id":100020801,"comment_content":"优化器阶段","like_count":0},{"had_liked":false,"id":38962,"user_name":"刘十一","can_delete":false,"product_type":"c1","uid":1035899,"ip_address":"","ucode":"5927D77D248E30","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/7b/fa0f9368.jpg","comment_is_top":false,"comment_ctime":1542162605,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542162605","product_id":100020801,"comment_content":"理论上应该是从分析器中做判断的，但是分析只是对mysql关键字做校验，其它的表和字段相当于留了个位置，打了个“？”号，具体检查抛出异常还是要在执行器阶段，才会去判断有否有表，是有字段。还有就是权限问题，因为权限也是在执行器这里判断的，所以这个抛异常应该是在执行器检查的。但是同上有疑问，这些基本的检查，包括权限，为什么不在分析器就检查？不是更好吗？","like_count":0},{"had_liked":false,"id":38960,"user_name":"^_^","can_delete":false,"product_type":"c1","uid":1088001,"ip_address":"","ucode":"EE5DAC03CFC2EE","user_header":"https://static001.geekbang.org/account/avatar/00/10/9a/01/1489f98d.jpg","comment_is_top":false,"comment_ctime":1542162386,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542162386","product_id":100020801,"comment_content":"我认为是优化器抛出来的，理由如下：分析器只是对输入的语句做词法和语法的分析，优化器做优化的时候，需要结合分析器的分析结果和表的现状做决策，这个时候应该会去检查表，发现列不存在，就抛错，不往下进行了","like_count":0},{"had_liked":false,"id":38939,"user_name":"Enterprize","can_delete":false,"product_type":"c1","uid":1215130,"ip_address":"","ucode":"3C120E9023B6C5","user_header":"https://static001.geekbang.org/account/avatar/00/12/8a/9a/7270d764.jpg","comment_is_top":false,"comment_ctime":1542160381,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542160381","product_id":100020801,"comment_content":"获益匪浅","like_count":0},{"had_liked":false,"id":38937,"user_name":"醉红颜","can_delete":false,"product_type":"c1","uid":1118507,"ip_address":"","ucode":"66C7FA47CC4D7A","user_header":"https://static001.geekbang.org/account/avatar/00/11/11/2b/4053b256.jpg","comment_is_top":false,"comment_ctime":1542160295,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542160295","product_id":100020801,"comment_content":"关于文章末所提的错误，应该是在词法分析发生的","like_count":0},{"had_liked":false,"id":38933,"user_name":"市集养猫者","can_delete":false,"product_type":"c1","uid":1240629,"ip_address":"","ucode":"D44FF82C51C617","user_header":"https://static001.geekbang.org/account/avatar/00/12/ee/35/5647c7e5.jpg","comment_is_top":false,"comment_ctime":1542160174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542160174","product_id":100020801,"comment_content":"分析阶段","like_count":0},{"had_liked":false,"id":38932,"user_name":"Shadow","can_delete":false,"product_type":"c1","uid":1308042,"ip_address":"","ucode":"37893C54CFEB1C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bnE6A7diaOmMbOSYnu11Be43QrIUdhWOwgDA73d6vxgzyV8ty7tvYV3ysW2uQPvYyJze2WgjcKDGIRmjzWcc4PQ/132","comment_is_top":false,"comment_ctime":1542160147,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542160147","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":38929,"user_name":"ServerCoder","can_delete":false,"product_type":"c1","uid":1066487,"ip_address":"","ucode":"7F266C97696E16","user_header":"https://static001.geekbang.org/account/avatar/00/10/45/f7/0f9bcf1f.jpg","comment_is_top":false,"comment_ctime":1542159998,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159998","product_id":100020801,"comment_content":"执行器。理由：文中提到表的权限问题的错误是在执行器的时候反馈的，所以我认为是执行器","like_count":0},{"had_liked":false,"id":38927,"user_name":"风轨","can_delete":false,"product_type":"c1","uid":1185844,"ip_address":"","ucode":"7B8A5233B61EB0","user_header":"https://static001.geekbang.org/account/avatar/00/12/18/34/c082419c.jpg","comment_is_top":false,"comment_ctime":1542159898,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159898","product_id":100020801,"comment_content":"语法分析没问题，语句优化索引选择需要查看数据的存储状态，这时候应该就会报错了，报错位置在优化器或优化器之前。","like_count":0},{"had_liked":false,"id":38926,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":false,"comment_ctime":1542159832,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159832","product_id":100020801,"comment_content":"取决于在哪个阶段能够获取到表的列信息。个人觉得应该在分析器阶段，在分析的时候便会判断列名是否存在。同时也是越早发现越好。 并且字段是否存在，表是否存在等一系列问题，肯定会在某个阶段集中校验，这个阶段放在分析器部分，是性价比最高的。","like_count":0},{"had_liked":false,"id":38924,"user_name":"炀","can_delete":false,"product_type":"c1","uid":1104339,"ip_address":"","ucode":"85046B416F6CF1","user_header":"https://static001.geekbang.org/account/avatar/00/10/d9/d3/63742921.jpg","comment_is_top":false,"comment_ctime":1542159741,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159741","product_id":100020801,"comment_content":"应该是分析器的词法分析阶段，判断列名及列是否存在","like_count":0},{"had_liked":false,"id":38921,"user_name":"银太","can_delete":false,"product_type":"c1","uid":1051765,"ip_address":"","ucode":"B505D15F7CB839","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/75/e7c6c403.jpg","comment_is_top":false,"comment_ctime":1542159694,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159694","product_id":100020801,"comment_content":"这里应该在分析器报错，分析器进行此法分析就需要知道对应的表结构","like_count":0},{"had_liked":false,"id":38920,"user_name":"黑妞","can_delete":false,"product_type":"c1","uid":1304591,"ip_address":"","ucode":"009082C816ECBF","user_header":"https://static001.geekbang.org/account/avatar/00/13/e8/0f/c4fd1011.jpg","comment_is_top":false,"comment_ctime":1542159634,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159634","product_id":100020801,"comment_content":"分析器","like_count":0},{"had_liked":false,"id":38915,"user_name":"喔～","can_delete":false,"product_type":"c1","uid":1172171,"ip_address":"","ucode":"FE2C87CE6FEBD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/cb/6bc95e09.jpg","comment_is_top":false,"comment_ctime":1542159387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159387","product_id":100020801,"comment_content":"执行器","like_count":0},{"had_liked":false,"id":38914,"user_name":"橙色星球","can_delete":false,"product_type":"c1","uid":1275399,"ip_address":"","ucode":"FAE0D995D781DC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLjAggFqmebIIJTiajVhEXUpHgAib9wVDWciasicaogCvEeibvPzjkGzc6s488Itt4c397WFyAkkIicjZicA/132","comment_is_top":false,"comment_ctime":1542159384,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159384","product_id":100020801,"comment_content":"优化器吧，是不存在字段，所以索引的时候就知道了","like_count":0},{"had_liked":false,"id":38911,"user_name":"Kaer","can_delete":false,"product_type":"c1","uid":1113558,"ip_address":"","ucode":"1BD233D3FAC2B1","user_header":"https://static001.geekbang.org/account/avatar/00/10/fd/d6/71e1cc29.jpg","comment_is_top":false,"comment_ctime":1542159269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159269","product_id":100020801,"comment_content":"按照分层职责，分析器只检查语法，优化器只是优化查询路径，执行器才会真正去执行表结构访问。所以我觉得应该是执行器。","like_count":0},{"had_liked":false,"id":38908,"user_name":"普通的一天","can_delete":false,"product_type":"c1","uid":1007445,"ip_address":"","ucode":"9F1A81DFA7005A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5f/55/8cfeb42e.jpg","comment_is_top":false,"comment_ctime":1542159061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542159061","product_id":100020801,"comment_content":"分析器阶段","like_count":0},{"had_liked":false,"id":38904,"user_name":"Gojustforfun","can_delete":false,"product_type":"c1","uid":1187021,"ip_address":"","ucode":"7513A40F27344F","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/cd/8d552516.jpg","comment_is_top":false,"comment_ctime":1542158805,"is_pvip":true,"replies":[{"id":"13915","content":"嗯嗯已修正，很细致哦，多谢指出🙏","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542162936,"ip_address":"","comment_id":38904,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542158805","product_id":100020801,"comment_content":"##疑问## 在“执行器”小结有如下一段内容：<br>“如果有权限，就打开表继续执行。打开表的时候，【优化器】就会根据表的引擎定义，去使用这个引擎提供的接口。”请问这里是否是【执行器】？<br><br>对于老师的留的作业，我认为是优化器。<br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428845,"discussion_content":"嗯嗯已修正，很细致哦，多谢指出🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542162936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38894,"user_name":"才才","can_delete":false,"product_type":"c1","uid":1242373,"ip_address":"","ucode":"94D76106261987","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/05/d6547381.jpg","comment_is_top":false,"comment_ctime":1542157678,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542157678","product_id":100020801,"comment_content":"优化器","like_count":0},{"had_liked":false,"id":38892,"user_name":"golden.胡","can_delete":false,"product_type":"c1","uid":1117695,"ip_address":"","ucode":"D000CBECCC0223","user_header":"https://static001.geekbang.org/account/avatar/00/11/0d/ff/d15595f3.jpg","comment_is_top":false,"comment_ctime":1542157561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542157561","product_id":100020801,"comment_content":"应该是优化器阶段，猜的","like_count":0},{"had_liked":false,"id":38891,"user_name":"Adonis","can_delete":false,"product_type":"c1","uid":1301943,"ip_address":"","ucode":"862F009789E72D","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/b7/74e81db0.jpg","comment_is_top":false,"comment_ctime":1542157473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542157473","product_id":100020801,"comment_content":"执行器","like_count":0},{"had_liked":false,"id":38872,"user_name":"jeffery","can_delete":false,"product_type":"c1","uid":1219972,"ip_address":"","ucode":"35E2DAA386FB86","user_header":"https://static001.geekbang.org/account/avatar/00/12/9d/84/171b2221.jpg","comment_is_top":false,"comment_ctime":1542156059,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542156059","product_id":100020801,"comment_content":"优化器吧 语法没问题","like_count":0},{"had_liked":false,"id":38870,"user_name":"xiaoyao","can_delete":false,"product_type":"c1","uid":1166008,"ip_address":"","ucode":"8623B9E45FC90D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/b8/bcfb6e4a.jpg","comment_is_top":false,"comment_ctime":1542155908,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542155908","product_id":100020801,"comment_content":"应该是执行器<br>分析器应该只是对表面的字段进行分析","like_count":0},{"had_liked":false,"id":38862,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1542154950,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154950","product_id":100020801,"comment_content":"赞同分析器，语法分析阶段","like_count":0},{"had_liked":false,"id":38861,"user_name":"杨宝强","can_delete":false,"product_type":"c1","uid":1189290,"ip_address":"","ucode":"B2352D7EA24F31","user_header":"https://static001.geekbang.org/account/avatar/00/12/25/aa/ced0170d.jpg","comment_is_top":false,"comment_ctime":1542154943,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154943","product_id":100020801,"comment_content":"很期待文章的内容，零基础的我有点担心看不太懂","like_count":0},{"had_liked":false,"id":38860,"user_name":"云学","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":false,"comment_ctime":1542154778,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154778","product_id":100020801,"comment_content":"听起来行云流水，逻辑清晰，非常好","like_count":0},{"had_liked":false,"id":38857,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":1027383,"ip_address":"","ucode":"B624679AFDF61B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ad/37/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1542154609,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154609","product_id":100020801,"comment_content":"执行器里，这时才打开表","like_count":0},{"had_liked":false,"id":38847,"user_name":"鹏程万里","can_delete":false,"product_type":"c1","uid":1294607,"ip_address":"","ucode":"613D2A5E802E33","user_header":"https://static001.geekbang.org/account/avatar/00/13/c1/0f/5785bddb.jpg","comment_is_top":false,"comment_ctime":1542154278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154278","product_id":100020801,"comment_content":"执行器，判断有打开权限，打开表之后","like_count":0},{"had_liked":false,"id":38844,"user_name":"moocbaby","can_delete":false,"product_type":"c1","uid":1304301,"ip_address":"","ucode":"A4A4695C974388","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKsiajQ8pZL5Lm9lEVWWECLXF0jTvW2RqiaS8aZCDNiaQG6f6hT3XImzXiakFxT9TELtpOVptt62McMrA/132","comment_is_top":false,"comment_ctime":1542154062,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154062","product_id":100020801,"comment_content":"回答最后的问题，“我给你留一个问题吧，如果表 T 中没有字段 k，而你执行了这个语句 select * from T where k=1, 那肯定是会报“不存在这个列”的错误： “Unknown column ‘k’ in ‘where clause’”。你觉得这个错误是在我们上面提到的哪个阶段报出来的呢？”是分析器么？","like_count":0},{"had_liked":false,"id":38843,"user_name":"fatcat","can_delete":false,"product_type":"c1","uid":1050919,"ip_address":"","ucode":"447A3AD9D9A1A8","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/27/0c68b5a8.jpg","comment_is_top":false,"comment_ctime":1542154054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154054","product_id":100020801,"comment_content":"执行器","like_count":0},{"had_liked":false,"id":38842,"user_name":"非牛不可","can_delete":false,"product_type":"c1","uid":1307780,"ip_address":"","ucode":"2394214F1FC1CD","user_header":"https://static001.geekbang.org/account/avatar/00/13/f4/84/457952ab.jpg","comment_is_top":false,"comment_ctime":1542153937,"is_pvip":false,"replies":[{"id":"13908","content":"你猜😁 ","user_name":"作者回复","user_name_real":"林晓斌","uid":"1264162","ctime":1542160755,"ip_address":"","comment_id":38842,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542153937","product_id":100020801,"comment_content":"有个问题想问林大大，您是先写的文案还是先录的语音。。。😂 😂 😂 ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"林晓斌","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428827,"discussion_content":"你猜😁 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542160755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38840,"user_name":"amazon1011","can_delete":false,"product_type":"c1","uid":1001032,"ip_address":"","ucode":"BD745BDCBD7059","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/48/e959b1e0.jpg","comment_is_top":false,"comment_ctime":1542153781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542153781","product_id":100020801,"comment_content":"应该是优化器","like_count":0},{"had_liked":false,"id":38835,"user_name":"guoqp","can_delete":false,"product_type":"c1","uid":1107066,"ip_address":"","ucode":"B12A5757215D0E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epRVT3U6UOpRAoOOYMm0flMeX4P1VJpSnZBlaBvdW4KhWKr0BunLFlCxibdHc9s6VArA124FpwzRiaw/132","comment_is_top":false,"comment_ctime":1542153668,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542153668","product_id":100020801,"comment_content":"优化器","like_count":0},{"had_liked":false,"id":38830,"user_name":"Y J C CMbesos","can_delete":false,"product_type":"c1","uid":1306040,"ip_address":"","ucode":"64E29E84B7EE3C","user_header":"https://static001.geekbang.org/account/avatar/00/13/ed/b8/16343549.jpg","comment_is_top":false,"comment_ctime":1542153057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542153057","product_id":100020801,"comment_content":"执行器吧","like_count":0},{"had_liked":false,"id":38829,"user_name":"江江","can_delete":false,"product_type":"c1","uid":1304929,"ip_address":"","ucode":"01BD997063188D","user_header":"https://static001.geekbang.org/account/avatar/00/13/e9/61/c205e678.jpg","comment_is_top":false,"comment_ctime":1542152991,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542152991","product_id":100020801,"comment_content":"执行器阶段吧。","like_count":0},{"had_liked":false,"id":38828,"user_name":"每天晒白牙","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1542152381,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1542152381","product_id":100020801,"comment_content":"执行阶段","like_count":0},{"had_liked":false,"id":38827,"user_name":"delete is create","can_delete":false,"product_type":"c1","uid":1147979,"ip_address":"","ucode":"A8C751219A7746","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/4b/e4738ba8.jpg","comment_is_top":false,"comment_ctime":1542152321,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542152321","product_id":100020801,"comment_content":"分析语句合法的问题应该是在分析器完成的吧","like_count":0},{"had_liked":false,"id":38821,"user_name":"yang","can_delete":false,"product_type":"c1","uid":1141387,"ip_address":"","ucode":"42FC9AC363D1FC","user_header":"","comment_is_top":false,"comment_ctime":1542150895,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542150895","product_id":100020801,"comment_content":"执行器","like_count":0},{"had_liked":false,"id":38819,"user_name":"Weixiao","can_delete":false,"product_type":"c1","uid":1020698,"ip_address":"","ucode":"E627DE43521E64","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/1a/79b052df.jpg","comment_is_top":false,"comment_ctime":1542150715,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542150715","product_id":100020801,"comment_content":"应该是执行器吧，因为这句话是符合语法的，分析器分析不出啥来，只有真正打开表执行的时候才会发现没有这一列。","like_count":0},{"had_liked":false,"id":38800,"user_name":"丶全靠演技丶","can_delete":false,"product_type":"c1","uid":1294354,"ip_address":"","ucode":"CB830730554DF8","user_header":"https://static001.geekbang.org/account/avatar/00/13/c0/12/7bf43ce5.jpg","comment_is_top":false,"comment_ctime":1542129321,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542129321","product_id":100020801,"comment_content":"我猜是执行器","like_count":0},{"had_liked":false,"id":38799,"user_name":"朱月俊","can_delete":false,"product_type":"c1","uid":1017707,"ip_address":"","ucode":"4DA0728B862FBD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/6b/0b6cd39a.jpg","comment_is_top":false,"comment_ctime":1542128708,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542128708","product_id":100020801,"comment_content":"在执行器判断吧。 分析如下:<br>连接器是负责连接以及加权限；<br>分析器是负责将完整的sql语句进行拆解；<br>优化器是负责存在多个索引的时候到底选择哪一个索引，这里最多只有一个索引，优化器在这里没啥用；<br>执行器应该是使用接口时，查询出错，然后提示。","like_count":0},{"had_liked":false,"id":38793,"user_name":"啊油酱紫哇","can_delete":false,"product_type":"c1","uid":1307491,"ip_address":"","ucode":"C999312CCD7E8A","user_header":"https://static001.geekbang.org/account/avatar/00/13/f3/63/c0c4f15d.jpg","comment_is_top":false,"comment_ctime":1542127466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542127466","product_id":100020801,"comment_content":"emmm 我觉的没有字段k的话会在优化器阶段保存。。首先在分析器时 词法 语法应该都满足 优化器在判断索引时 应该就会查不到这列保错了 。","like_count":0},{"had_liked":false,"id":38790,"user_name":"恺撒","can_delete":false,"product_type":"c1","uid":1177599,"ip_address":"","ucode":"EB15CF49E3A058","user_header":"","comment_is_top":false,"comment_ctime":1542127129,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542127129","product_id":100020801,"comment_content":"从正文讲述看我猜是优化器","like_count":0},{"had_liked":false,"id":38785,"user_name":"chaosii","can_delete":false,"product_type":"c1","uid":1000731,"ip_address":"","ucode":"3A9BDC9B35C33F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/45/1b/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1542126489,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542126489","product_id":100020801,"comment_content":"应该是优化器处理阶段","like_count":0}]}