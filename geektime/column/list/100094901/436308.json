{"id":436308,"title":"06 | é™æ€é“¾æ¥ï¼šå˜é‡ä¸å†…å­˜åœ°å€æ˜¯å¦‚ä½•æ˜ å°„çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æµ·çº³ã€‚</p><p>åœ¨ç¬¬3èŠ‚è¯¾é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°è¿›ç¨‹çš„å†…å­˜ç©ºé—´åŒ…å«ä»£ç æ®µã€æ•°æ®æ®µã€bssæ®µã€å †å’Œæ ˆç­‰åŒºåŸŸã€‚åœ¨ç¬¬4èŠ‚å’Œç¬¬5èŠ‚è¯¾é‡Œï¼Œæˆ‘ä»¬å¯¹æ ˆçš„ç›¸å…³çŸ¥è¯†è¿›è¡Œäº†æ·±å…¥å­¦ä¹ ã€‚ä»Šå¤©æˆ‘ä»¬æ¥çœ‹çœ‹å†…å­˜ä¸­çš„å¦ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼šä»£ç æ®µå’Œæ•°æ®æ®µçš„ç»„ç»‡æ–¹å¼ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œç¼–ç¨‹çš„ä»£ç æ— éæ˜¯ç”±å‡½æ•°å’Œå„ç§å˜é‡ï¼Œä»¥åŠå¯¹è¿™äº›å˜é‡çš„è¯»ã€å†™æ‰€ç»„æˆï¼Œè€Œä¸ç®¡æ˜¯å˜é‡è¿˜æ˜¯å‡½æ•°ï¼Œå®ƒä»¬æœ€ç»ˆéƒ½è¦å­˜å‚¨åœ¨å†…å­˜é‡Œã€‚ä¸ºæ¯ä¸ªå˜é‡å’Œå‡½æ•°æ­£ç¡®åœ°åˆ†é…å†…å­˜ç©ºé—´ï¼Œè®°å½•å®ƒä»¬çš„åœ°å€ï¼Œå¹¶æŠŠè¿™ä¸ªåœ°å€å¤å†™å›è°ƒç”¨æˆ–å¼•ç”¨å®ƒä»¬çš„åœ°æ–¹ï¼Œè¿™æ˜¯ä¸€ä¸ªååˆ†é‡è¦ä¸”å›°éš¾çš„ä»»åŠ¡ã€‚</p><p>åœ¨æˆ‘ä»¬ä½¿ç”¨gccæ—¶ï¼Œå¾€å¾€æ‰§è¡Œä¸€ä¸ªå‘½ä»¤åï¼Œå°±èƒ½å¾—åˆ°å¯æ‰§è¡Œç¨‹åºï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šè¯¯ä»¥ä¸ºæ˜¯ç¼–è¯‘å™¨è´Ÿè´£ä¸ºå˜é‡åˆ†é…å†…å­˜åœ°å€ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œè¿™ä¸ªå·¥ä½œæ˜¯ç”±é“¾æ¥å™¨æ¥å®Œæˆçš„ã€‚æ¯ä¸ªå˜é‡å’Œå‡½æ•°éƒ½æœ‰è‡ªå·±çš„åç§°ï¼Œé€šå¸¸æˆ‘ä»¬æŠŠè¿™äº›åç§°å«åšç¬¦å·ã€‚ç®€å•æ¥è®²ï¼Œé“¾æ¥å™¨çš„ä½œç”¨å°±æ˜¯ä¸ºç¬¦å·è½¬æ¢æˆåœ°å€ï¼Œä¸€èˆ¬æ¥è¯´å¯ä»¥åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š</p><ol>\n<li>ç”ŸæˆäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ã€‚è¿™ç§æƒ…å†µç§°ä¸ºé™æ€é“¾æ¥ï¼›</li>\n<li>åœ¨äºŒè¿›åˆ¶æ–‡ä»¶è¢«åŠ è½½è¿›å†…å­˜æ—¶ã€‚è¿™ç§æƒ…å†µæ˜¯åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¿ç•™ç¬¦å·ï¼Œåœ¨åŠ è½½æ—¶å†æŠŠç¬¦å·è§£ææˆçœŸå®çš„å†…å­˜åœ°å€ï¼Œè¿™ç§è¢«ç§°ä¸ºåŠ¨æ€é“¾æ¥ï¼›</li>\n<li>åœ¨è¿è¡ŒæœŸé—´è§£æç¬¦å·ã€‚è¿™ç§æƒ…å†µä¼šæŠŠç¬¦å·çš„è§£æå»¶è¿Ÿåˆ°æœ€åä¸å¾—ä¸åšæ—¶æ‰å»åšç¬¦å·çš„è§£æï¼Œè¿™ä¹Ÿæ˜¯åŠ¨æ€é“¾æ¥çš„ä¸€ç§ã€‚</li>\n</ol><!-- [[[read_end]]] --><p>ç›¸ä¿¡ä½ åœ¨å·¥ä½œä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ç¼–è¯‘å„ç§å¼€æºé¡¹ç›®æ—¶ï¼Œè‚¯å®šé‡åˆ°è¿‡â€œæ‰¾ä¸åˆ°ç¬¦å·â€ï¼Œæˆ–è€…â€œundefined reference to Xâ€è¿™æ ·çš„æŠ¥é”™ä¿¡æ¯ï¼Œå…¶å®è¿™äº›é”™è¯¯éƒ½å’Œç¼–è¯‘é“¾æ¥çš„è¿‡ç¨‹æœ‰å…³ç³»ã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥çš„3èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±é‡ç‚¹æ¥åˆ†æä¸€ä¸‹é“¾æ¥å™¨æ˜¯æ€ä¹ˆå®Œæˆå†…å­˜åœ°å€çš„æ˜ å°„å·¥ä½œçš„ï¼Œäº†è§£äº†è¿™ä¸ªåŸç†åï¼Œå†é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œä½ å°±çŸ¥é“å¦‚ä½•ç€æ‰‹å»åˆ†æäº†ã€‚</p><p>ä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä»¬å…ˆæ¥æ¢è®¨é™æ€é“¾æ¥çš„è¿‡ç¨‹ã€‚</p><h3>å…³äºé“¾æ¥çš„å°ä¾‹å­</h3><p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å±•ç¤ºä¸€éç¼–è¯‘å’Œé“¾æ¥çš„å…¨éƒ¨è¿‡ç¨‹ï¼Œç„¶åå†åˆ†ææ¯ä¸€æ­¥çš„åŸç†ã€‚è¿™ä¸ªä¾‹å­åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ–‡ä»¶æ˜¯example.cï¼š</p><pre><code>// example.c\nextern int extern_var;\nint global_var = 1;\nstatic int static_var = 2;\n \nextern int extern_func();\nint global_func() {\n    return 10;\n}\n \nstatic int static_func() {\n    return 20;\n}\n \nint main() {\n    int var0 = extern_var;\n    int var1 = global_var;\n    int var2 = static_var;\n    int var3 = extern_func();\n    int var4 = global_func();\n    int var5 = static_func();\n    return var0 + var1 + var2 + var3 + var4 + var5;\n}\n</code></pre><p>ç¬¬äºŒä¸ªæ–‡ä»¶æ˜¯external.cï¼š</p><pre><code>// external.c\nint extern_var = 3;\nint extern_func() {\n    return 30;\n}\n</code></pre><p>æˆ‘ä»¬å…ˆä½¿ç”¨gccå°†ä¸¤ä¸ªcæ–‡ä»¶åˆ†åˆ«ç¼–è¯‘æˆ.oç›®æ ‡æ–‡ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç¼–è¯‘ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code># gcc example.c -c -o example.o -fno-PIC -g\n# gcc external.c -c -o external.o -fno-PIC -g\n</code></pre><p>è¿™é‡Œæˆ‘ç»™ä½ è§£é‡Šä¸€ä¸‹å‘½ä»¤ä¸­çš„å‡ ä¸ªé€‰é¡¹ï¼š</p><ul>\n<li>-cæ„æ€æ˜¯å‘Šè¯‰gccä¸è¦è¿›è¡Œé“¾æ¥ï¼Œåªè¦ç¼–è¯‘åˆ°.oå°±å¯ä»¥äº†ï¼›</li>\n<li>-oæŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶å;</li>\n<li>-fno-PICæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ä¸è¦ç”ŸæˆPICçš„ä»£ç ã€‚å› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯gcc4.8ç‰ˆæœ¬ï¼Œåœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­é»˜è®¤çš„æ¨¡å¼æ˜¯PICæ¨¡å¼ï¼Œç”±äºæˆ‘ä»¬ä»Šå¤©è®¨è®ºçš„å†…å®¹ä¸»è¦æ˜¯é™æ€é“¾æ¥çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥éœ€è¦æ‰“å¼€-fno-PICé€‰é¡¹ã€‚è¿™ä¸ªé€‰é¡¹å¯¹åŠ¨æ€é“¾æ¥çš„æ„ä¹‰æ¯”è¾ƒå¤§ï¼Œåœ¨ä¸‹èŠ‚è¯¾è®²åŠ¨æ€é“¾æ¥æ—¶ï¼Œæˆ‘ä¼šå¯¹è¿™ä¸ªé€‰é¡¹ç»™ä½ åšè¯¦ç»†è§£é‡Šã€‚</li>\n<li>-gé€‰é¡¹æ˜¯æ‰“å¼€è°ƒè¯•ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬åœ¨åˆ†æè¿‡ç¨‹ä¸­èƒ½å¤Ÿå¯¹æºç æœ‰æ›´å®Œæ•´çš„å¯¹åº”å…³ç³»ã€‚</li>\n</ul><p>ç„¶åï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ª.oæ–‡ä»¶é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç”±ç›®æ ‡æ–‡ä»¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹å°±æ˜¯é“¾æ¥ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code># gcc external.o example.o -o a.out -no-pie\n</code></pre><p>åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼Œ-no-pieè¡¨ç¤ºå…³é—­pieçš„æ¨¡å¼ã€‚gccä¼šé»˜è®¤æ‰“å¼€pieæ¨¡å¼ï¼Œä¹Ÿå°±æ„å‘³ç€ç³»ç»Ÿloaderå¯¹åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶æ—¶çš„èµ·å§‹åœ°å€ï¼Œä¼šéšæœºåŠ è½½ã€‚å…³é—­pieä¹‹åï¼Œåœ¨Linux 64ä½çš„ç³»ç»Ÿä¸‹ï¼Œé»˜è®¤çš„åŠ è½½èµ·å§‹åœ°å€æ˜¯0x400000ã€‚å…³äºè¿™ä¸ªé€‰é¡¹ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹èŠ‚è¯¾è¯¦ç»†è®²è§£ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶a.outï¼Œä»¥ä¸Šå†…å®¹å°±æ˜¯ç¼–è¯‘å’Œé“¾æ¥çš„å…¨è¿‡ç¨‹äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†çœ‹ä¸€çœ‹é“¾æ¥å™¨åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‘æŒ¥çš„ä½œç”¨ã€‚</p><h3>é“¾æ¥å™¨çš„ä½œç”¨</h3><p>æˆ‘ä»¬ç»§ç»­ç»“åˆä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜ï¼Œè¿™ä¸ªä¾‹å­å…¶å®æ¶µç›–äº†ç¨‹åºå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ€å¸¸ç”¨çš„å‡ ç§å˜é‡ç±»å‹ä»¥åŠå‡½æ•°ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol>\n<li>\n<p>å…¨å±€å˜é‡ï¼šglobal_varã€‚</p>\n</li>\n<li>\n<p>é™æ€å˜é‡ï¼šstatic_varã€‚</p>\n</li>\n<li>\n<p>å¤–éƒ¨å˜é‡ï¼šextern_varï¼Œåœ¨example.cä¸­ä½¿ç”¨externå…³é”®å­—è¿›è¡Œå£°æ˜ï¼Œå®šä¹‰åœ¨external.cé‡Œã€‚</p>\n</li>\n<li>\n<p>å±€éƒ¨å˜é‡ï¼švar0 â€¦ var5ã€‚</p>\n</li>\n<li>\n<p>å…¨å±€å‡½æ•°ï¼šglobal_funcã€‚</p>\n</li>\n<li>\n<p>é™æ€å‡½æ•°ï¼šstatic_funcã€‚</p>\n</li>\n<li>\n<p>å¤–éƒ¨å‡½æ•°ï¼šextern_funcï¼Œåœ¨example.cä¸­ä½¿ç”¨externå…³é”®å­—è¿›è¡Œå£°æ˜ï¼Œå®šä¹‰åœ¨external.cé‡Œã€‚</p>\n</li>\n</ol><p>ç¨‹åºå‘˜åœ¨å¼€å‘ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæ˜¯ç›´æ¥è·Ÿè¿™äº›ç¬¦å·æ‰“äº¤é“çš„ã€‚å¦‚æœæƒ³è·å–æŸä¸ªå˜é‡çš„å€¼ï¼Œå°±ç›´æ¥ä»å˜é‡ç¬¦å·é‡Œè¯»å–å†…å®¹ï¼›å¦‚æœæƒ³è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œä¹Ÿæ˜¯ç›´æ¥å†™ä¸€ä¸ªå‡½æ•°ç¬¦å·çš„è°ƒç”¨è¯­å¥ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒCPUåœ¨æ‰§è¡Œç¨‹åºä»£ç çš„æ—¶å€™ï¼Œå¹¶ä¸ç†è§£ç¬¦å·çš„æ¦‚å¿µï¼Œå®ƒæ‰€èƒ½ç†è§£çš„åªæœ‰å†…å­˜åœ°å€çš„æ¦‚å¿µã€‚ä¸ç®¡æ˜¯è¯»æ•°æ®ï¼Œè°ƒç”¨å‡½æ•°è¿˜æ˜¯è¯»æŒ‡ä»¤ï¼Œå¯¹äºCPUè€Œè¨€éƒ½æ˜¯ä¸€ä¸ªä¸ªçš„å†…å­˜åœ°å€ã€‚å› æ­¤ï¼Œ<strong>è¿™é‡Œå°±éœ€è¦ä¸€ä¸ªè¿æ¥CPUä¸ç¨‹åºå‘˜ä¹‹é—´çš„æ¡¥æ¢ï¼ŒæŠŠç¨‹åºä¸­çš„ç¬¦å·è½¬æ¢æˆCPUæ‰§è¡Œæ—¶çš„å†…å­˜åœ°å€</strong>ã€‚<strong>è¿™ä¸ªæ¡¥æ¢å°±æ˜¯é“¾æ¥å™¨ï¼Œå®ƒè´Ÿè´£å°†ç¬¦å·è½¬æ¢ä¸ºåœ°å€ã€‚</strong></p><p><strong>é“¾æ¥å™¨çš„ç¬¬ä¸€ä¸ªä½œç”¨å°±æ˜¯æŠŠå¤šä¸ªä¸­é—´æ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</strong>ã€‚æˆ‘ä»¬åœ¨ç¬¬3èŠ‚è¯¾åˆ†æè¿‡ï¼Œæ¯ä¸ªä¸­é—´æ–‡ä»¶éƒ½æœ‰è‡ªå·±çš„ä»£ç æ®µå’Œæ•°æ®æ®µç­‰å¤šä¸ªsectionï¼Œåœ¨åˆå¹¶æˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæ—¶ï¼Œå¤šä¸ªä¸­é—´æ–‡ä»¶çš„ä»£ç æ®µä¼šè¢«åˆå¹¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ä»£ç æ®µï¼Œå®ƒä»¬æ•°æ®æ®µä¹Ÿä¼šè¢«åˆå¹¶ä¸ºå¯æ‰§è¡Œæ–‡ä»¶çš„æ•°æ®æ®µã€‚å…·ä½“çš„è¿‡ç¨‹å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªå›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e2/82/e22cc1820a1e9b5e3fc44b844dba7182.jpg?wh=2284x1301\" alt=\"\"></p><p>ä½†æ˜¯é“¾æ¥å™¨åœ¨åˆå¹¶å¤šä¸ªç›®æ ‡æ–‡ä»¶çš„æ—¶å€™å¹¶ä¸æ˜¯ç®€å•åœ°å°†å„ä¸ªsectionåˆå¹¶å°±å¯ä»¥äº†ï¼Œå®ƒè¿˜éœ€è¦è€ƒè™‘æ¯ä¸ªç›®æ ‡ä¸­çš„ç¬¦å·çš„åœ°å€ã€‚è¿™å°±å¼•å‡ºäº†<strong>é“¾æ¥å™¨çš„ç¬¬äºŒä¸ªä»»åŠ¡ï¼šé‡å®šä½</strong>ã€‚æ‰€è°“é‡å®šä½ï¼Œå°±æ˜¯å½“è¢«è°ƒç”¨è€…çš„åœ°å€å˜åŒ–äº†ï¼Œè¦è®©è°ƒç”¨è€…çŸ¥é“æ–°çš„åœ°å€æ˜¯ä»€ä¹ˆã€‚</p><h4>ä¸¤æ­¥é“¾æ¥</h4><p>æ ¹æ®ä¸Šè¾¹çš„åˆ†æï¼Œé“¾æ¥å™¨çš„å·¥ä½œæµç¨‹ä¹Ÿä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼š</p><p><strong>ç¬¬ä¸€æ­¥æ˜¯ï¼Œé“¾æ¥å™¨éœ€è¦å¯¹ç¼–è¯‘å™¨ç”Ÿæˆçš„å¤šä¸ªç›®æ ‡ï¼ˆ.o)æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œä¸€èˆ¬é‡‡å–çš„ç­–ç•¥æ˜¯ç›¸ä¼¼æ®µçš„åˆå¹¶ï¼Œæœ€ç»ˆç”Ÿæˆå…±äº«æ–‡ä»¶(.so)æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶</strong>ã€‚è¿™ä¸ªé˜¶æ®µä¸­ï¼Œé“¾æ¥å™¨å¯¹è¾“å…¥çš„å„ä¸ªç›®æ ‡æ–‡ä»¶è¿›è¡Œæ‰«æï¼Œè·å–å„ä¸ªæ®µçš„å¤§å°ï¼Œå¹¶ä¸”åŒæ—¶ä¼šæ”¶é›†æ‰€æœ‰çš„ç¬¦å·å®šä¹‰ä»¥åŠå¼•ç”¨ä¿¡æ¯ï¼Œæ„å»ºä¸€ä¸ªå…¨å±€çš„ç¬¦å·è¡¨ã€‚å½“é“¾æ¥å™¨æ„é€ å¥½äº†æœ€ç»ˆçš„æ–‡ä»¶å¸ƒå±€ä»¥åŠè™šæ‹Ÿå†…å­˜å¸ƒå±€åï¼Œæˆ‘ä»¬æ ¹æ®ç¬¦å·è¡¨ï¼Œä¹Ÿå°±èƒ½ç¡®å®šäº†æ¯ä¸ªç¬¦å·çš„è™šæ‹Ÿåœ°å€äº†ã€‚</p><p><strong>ç¬¬äºŒæ­¥æ˜¯ï¼Œé“¾æ¥å™¨ä¼šå¯¹æ•´ä¸ªæ–‡ä»¶å†è¿›è¡Œç¬¬äºŒéæ‰«æï¼Œè¿™ä¸€é˜¶æ®µï¼Œä¼šåˆ©ç”¨ç¬¬ä¸€éæ‰«æå¾—åˆ°çš„ç¬¦å·è¡¨ä¿¡æ¯ï¼Œä¾æ¬¡å¯¹æ–‡ä»¶ä¸­æ¯ä¸ªç¬¦å·å¼•ç”¨çš„åœ°æ–¹è¿›è¡Œåœ°å€æ›¿æ¢ã€‚ä¹Ÿå°±æ˜¯å¯¹ç¬¦å·çš„è§£æä»¥åŠé‡å®šä½è¿‡ç¨‹</strong>ã€‚</p><p>è¿™å°±æ˜¯é“¾æ¥å™¨å¸¸ç”¨çš„ä¸¤æ­¥é“¾æ¥(Two-pass linking)çš„æ­¥éª¤ã€‚ç®€å•æ¥è®²å°±æ˜¯è¿›è¡Œä¸¤éæ‰«æï¼šç¬¬ä¸€éæ‰«æå®Œæˆæ–‡ä»¶åˆå¹¶ã€è™šæ‹Ÿå†…å­˜å¸ƒå±€çš„åˆ†é…ä»¥åŠç¬¦å·ä¿¡æ¯æ”¶é›†ï¼›ç¬¬äºŒéæ‰«æåˆ™æ˜¯å®Œæˆäº†ç¬¦å·çš„é‡å®šä½è¿‡ç¨‹ã€‚</p><p>é‡å®šä½æ˜¯ç¬¦å·è§£æçš„é‡è¦æ­¥éª¤ï¼Œæ˜¯æˆ‘ä»¬ç†è§£é™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥çš„åŸºç¡€åŸç†ã€‚åœ¨JVMæˆ–è€…V8è™šæ‹Ÿæœºä¸­ï¼Œå¯¹ç¬¦å·çš„è§£æçš„åŸç†ä¸é“¾æ¥å™¨çš„é‡å®šä½è¿‡ç¨‹æ˜¯ååˆ†ç›¸ä¼¼çš„ï¼Œå¯è§é‡å®šä½åº”ç”¨å¾—éå¸¸å¹¿æ³›ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è¦é‡ç‚¹äº†è§£ä¸€ä¸‹é‡å®šä½çš„åŸç†ã€‚</p><h3>æ·±å…¥åˆ†æé‡å®šä½è¿‡ç¨‹</h3><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ï¼Œåœ¨GNU/linuxä¸‹ï¼ŒGNUçš„binutilsæä¾›äº†ä¸€ç³»åˆ—ç¼–ç¨‹è¯­è¨€çš„å·¥å…·ç¨‹åºï¼Œç”¨æ¥æŸ¥çœ‹ä¸åŒæ ¼å¼ä¸‹çš„ç›®æ ‡æ–‡ä»¶ã€‚ä»Šå¤©æˆ‘è¦ç»™ä½ é‡ç‚¹ä»‹ç»ä¸¤ä¸ªå·¥å…·ï¼šreadelfå’Œobjdumpï¼Œè¿™ä¸¤ä¸ªå·¥å…·å¯ä»¥ç”¨æ¥è§£æå’Œè¯»å–ä¸Šä¸€èŠ‚ç¼–è¯‘é˜¶æ®µç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘åœ¨å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåæ±‡ç¼–æ—¶ä¼šä½¿ç”¨objdumpå·¥å…·ï¼Œå› ä¸ºreadelfå·¥å…·æ²¡æœ‰æä¾›åæ±‡ç¼–çš„èƒ½åŠ›ï¼Œå®ƒæ›´å¤šæ˜¯ç”¨æ¥è§£æäºŒè¿›åˆ¶æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç¼–è¯‘å‡ºä¸¤ä¸ª.oç›®æ ‡æ–‡ä»¶ï¼Œä»¥åŠæœ€ç»ˆé“¾æ¥åçš„a.outå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡å¯¹æ¯”.oæ–‡ä»¶ä»¥åŠa.outæ–‡ä»¶ä¸­ç¬¦å·çš„å·®å¼‚æ¥åˆ†æé‡å®šä½çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡objdumpçœ‹ä¸€ä¸‹æ­¤æ—¶ç›®æ ‡æ–‡ä»¶é‡Œçš„åæ±‡ç¼–æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><pre><code># objdump -S example.o\n0000000000000000 &lt;global_func&gt;:\n   0:   55                      push   %rbp\n   1:   48 89 e5                mov    %rsp,%rbp\n   4:   b8 0a 00 00 00          mov    $0xa,%eax\n   9:   5d                      pop    %rbp\n   a:   c3                      retq\n \n000000000000000b &lt;static_func&gt;:\n   b:   55                      push   %rbp\n   c:   48 89 e5                mov    %rsp,%rbp\n   f:   b8 14 00 00 00          mov    $0x14,%eax\n  14:   5d                      pop    %rbp\n  15:   c3                      retq\n \n0000000000000016 &lt;main&gt;:\nint main() {\n  16:   55                      push   %rbp\n  17:   48 89 e5                mov    %rsp,%rbp\n  1a:   48 83 ec 20             sub    $0x20,%rsp\n    int var0 = extern_var;\n  1e:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 24 &lt;main+0xe&gt;\n  24:   89 45 e8                mov    %eax,-0x18(%rbp)\n    int var1 = global_var;\n  27:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 2d &lt;main+0x17&gt;\n  2d:   89 45 ec                mov    %eax,-0x14(%rbp)\n    int var2 = static_var;\n  30:   8b 05 00 00 00 00       mov    0x0(%rip),%eax        # 36 &lt;main+0x20&gt;\n  36:   89 45 f0                mov    %eax,-0x10(%rbp)\n    int var3 = extern_func();\n  39:   b8 00 00 00 00          mov    $0x0,%eax\n  3e:   e8 00 00 00 00          callq  43 &lt;main+0x2d&gt;\n  43:   89 45 f4                mov    %eax,-0xc(%rbp)\n    int var4 = global_func();\n  46:   b8 00 00 00 00          mov    $0x0,%eax\n  4b:   e8 00 00 00 00          callq  50 &lt;main+0x3a&gt;\n  50:   89 45 f8                mov    %eax,-0x8(%rbp)\n    int var5 = static_func();\n  53:   b8 00 00 00 00          mov    $0x0,%eax\n  58:   e8 ae ff ff ff          callq  b &lt;static_func&gt;\n  5d:   89 45 fc                mov    %eax,-0x4(%rbp)\n  â€¦\n} \n</code></pre><p>ç”±äºç©ºé—´çš„é™åˆ¶ï¼Œæˆ‘åªä¿ç•™äº†mainå‡½æ•°ä¸­æºç ä¸æ±‡ç¼–ç å¯¹åº”çš„éƒ¨åˆ†å†…å®¹ã€‚ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¾¹æºç ä¸æ±‡ç¼–çš„å¯¹åº”ï¼Œéœ€è¦åœ¨ç¼–è¯‘.oæ–‡ä»¶æ—¶æ‰“å¼€-gé€‰é¡¹ï¼Œå¦åˆ™å°±åªæœ‰æ±‡ç¼–ä»£ç ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥åˆ†ç±»è®¨è®ºå„ç§ç¬¦å·çš„å¤„ç†æ–¹å¼ã€‚</p><h4>å„ç§ç¬¦å·çš„å¤„ç†æ–¹å¼</h4><p><strong>é¦–å…ˆï¼Œæˆ‘æ¥çœ‹çœ‹å±€éƒ¨å˜é‡çš„å¤„ç†è¿‡ç¨‹</strong>ã€‚ä»åæ±‡ç¼–çš„ç»“æœé‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå±€éƒ¨å˜é‡åœ¨ç¨‹åºä¸­çš„åœ°å€ï¼Œéƒ½æ˜¯åŸºäº%rbpçš„åç§»è¿™ç§å½¢å¼ï¼Œrbpå¯„å­˜å™¨å­˜æ”¾çš„æ˜¯å½“å‰å‡½æ•°æ ˆå¸§çš„åŸºåœ°å€ã€‚è¿™äº›å±€éƒ¨å˜é‡çš„å†…å­˜åˆ†é…ä¸é‡Šæ”¾ï¼Œéƒ½æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡%rbpçš„æ”¹å˜æ¥è¿›è¡Œçš„ï¼Œå› æ­¤ï¼Œå±€éƒ¨å˜é‡çš„å†…å­˜åœ°å€ä¸éœ€è¦é“¾æ¥å™¨æ¥æ“å¿ƒã€‚</p><p><strong>ç„¶åï¼Œå†æ¥çœ‹çœ‹æ¯”è¾ƒç®€å•çš„static_funcï¼Œå®ƒæ˜¯å”¯ä¸€ä¸éœ€è¦é‡å®šä½çš„ç±»å‹</strong>ã€‚å¯¹static_funcçš„è°ƒç”¨ï¼Œæ‰€ç”Ÿæˆçš„æŒ‡ä»¤çš„äºŒè¿›åˆ¶æ˜¯ e8 ae ff ff ffã€‚å…¶ä¸­ï¼Œe8æ˜¯callqæŒ‡ä»¤çš„ç¼–ç ï¼Œåè¾¹4ä¸ªå­—èŠ‚å°±å¯¹åº”è¢«è°ƒå‡½æ•°çš„åœ°å€ã€‚æ³¨æ„ï¼Œè¿™é‡Œç”Ÿæˆçš„ae ff ff ffï¼Œå¦‚æœé‡‡ç”¨å°ç«¯çš„å­—èŠ‚åºæ•°å€¼æ¥è¡¨ç¤ºï¼Œåº”è¯¥æ˜¯0xffffffaeï¼Œä¹Ÿå°±æ˜¯å¯¹åº”åè¿›åˆ¶çš„-82ã€‚</p><p>æ­¤æ—¶ï¼Œå½“CPUæ‰§è¡Œåˆ°callqè¿™æ¡æŒ‡ä»¤æ—¶ï¼Œripå¯„å­˜å™¨çš„å€¼æŒ‡å‘çš„æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Œä¹Ÿå°±æ˜¯5dè¿™æ¡æŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Œé€šè¿‡è®¡ç®—0x5d â€“ 82å¯ä»¥å¾—åˆ°0xbã€‚ä»åæ±‡ç¼–ä¸­å¯ä»¥å¾—åˆ°ï¼Œ0xbåˆšå¥½æ˜¯static_funcçš„åœ°å€ã€‚static_funcçš„é“¾æ¥åŸç†ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢è¿™å¹…å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ae/3f/ae5b19734d342453826b41538d2d603f.jpg?wh=2284x1304\" alt=\"\"></p><p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒåŒä¸€ä¸ªç¼–è¯‘å•å…ƒå†…éƒ¨ï¼Œstatic_funcä¸mainå‡½æ•°çš„ç›¸å¯¹ä½ç½®æ˜¯å›ºå®šä¸å˜çš„ï¼Œå³ä¾¿é“¾æ¥çš„è¿‡ç¨‹ä¸­ä¼šå¯¹ä¸åŒ.oæ–‡ä»¶ä¸­çš„ä»£ç æ®µè¿›è¡Œåˆå¹¶ï¼Œä½†æ˜¯åŒä¸€ä¸ª.oæ–‡ä»¶å†…éƒ¨ä¸åŒå‡½æ•°ä¹‹é—´çš„ä½ç½®ä¹Ÿä¼šä¿æŒä¸å˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œå°±èƒ½ç¡®å®šå¯¹é™æ€å‡½æ•°è°ƒç”¨çš„åç§»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™æ€å‡½æ•°çš„è°ƒç”¨åœ°å€åœ¨ç¼–è¯‘é˜¶æ®µå°±å¯ä»¥ç¡®å®šä¸‹æ¥ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨æœ€ç»ˆç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„mainå‡½æ•°ä¸­ï¼ŒæŸ¥çœ‹å¯¹åº”ä½ç½®ä»£ç çš„åæ±‡ç¼–ã€‚å¯ä»¥éªŒè¯çš„æ˜¯ï¼Œè¿™é‡Œç¡®å®æ²¡æœ‰è¿›è¡Œé‡å®šä½çš„ä¿®æ­£ï¼š</p><pre><code>0000000004004ad &lt;main&gt;:\n  ...\n  4004ef:       e8 ae ff ff ff          callq  4004a2 &lt;static_func&gt;\n  ... \n</code></pre><p><strong>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ç¬¬ä¸‰ç±»ç¬¦å·ï¼Œä¹Ÿå°±æ˜¯å¤–éƒ¨å˜é‡ã€å…¨å±€å˜é‡ä»¥åŠé™æ€å˜é‡çš„å¤„ç†è¿‡ç¨‹</strong>ã€‚ä½ å¯ä»¥ä»åæ±‡ç¼–ç»“æœä¸­çœ‹åˆ°ï¼Œå‰ä¸‰æ¡è¯­å¥å¯¹extern_varã€global_varå’Œstatic_varçš„è®¿é—®ï¼Œéƒ½ç”Ÿæˆäº†ä¸€æ¡ mov 0x0(%rip)ï¼Œ%eaxçš„æŒ‡ä»¤ã€‚è¿™æ˜¯å› ä¸ºåœ¨è¿™ä¸ªæ—¶å€™ï¼Œç¼–è¯‘å™¨è¿˜æ— æ³•ç¡®å®šè¿™ä¸‰ä¸ªå˜é‡çš„åœ°å€ï¼Œå› æ­¤ï¼Œè¿™é‡Œå…ˆé€šè¿‡0æ¥è¿›è¡Œå ä½ï¼Œä»¥åé“¾æ¥å™¨ä¼šå°†çœŸæ­£çš„åœ°å€å›å¡«åœ¨è¿™é‡Œã€‚</p><p><strong>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹å¯¹äºextern_funcå’Œglobal_funcçš„è°ƒç”¨</strong>ï¼ŒcallæŒ‡ä»¤åŒæ ·æ˜¯é€šè¿‡0æ¥è¿›è¡Œå ä½ï¼Œè¿™å’Œå…¨å±€å˜é‡çš„å¤„ç†æ–¹å¼ä¸€æ ·ã€‚</p><h4>å¤„ç†å ä½ç¬¦</h4><p>æˆ‘ä»¬å‰é¢è¯´åˆ°ï¼Œåœ¨æ— æ³•ç¡®å®šå˜é‡çš„çœŸå®åœ°å€æ—¶ï¼Œå…ˆé€šè¿‡0æ¥è¿›è¡Œå ä½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™é‡Œç»§ç»­è§‚å¯Ÿé“¾æ¥å™¨å¯¹extern_varï¼Œstatic_varï¼Œglobal_varï¼Œglobal_funcä»¥åŠextern_funcçš„é‡å®šä½è¿‡ç¨‹ï¼Œçœ‹çœ‹å®ƒä»¬çš„å ä½ç¬¦æ˜¯å¦‚ä½•å¤„ç†çš„ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦é€šè¿‡readelfå·¥å…·æ¥æŸ¥çœ‹ä¸€ä¸‹ç›®æ ‡æ–‡ä»¶é‡Œæœ‰å“ªäº›ä¿¡æ¯ï¼š</p><pre><code># readelf -S example.o\nThere are 12 section headers, starting at offset 0x478:\n \nSection Headers:\n  [Nr] Name              Type             Address           Offset\n       Size              EntSize          Flags  Link  Info  Align\n  [ 0]                   NULL             0000000000000000  00000000\n       0000000000000000  0000000000000000           0     0     0\n  [ 1] .text             PROGBITS         0000000000000000  00000040\n       000000000000007e  0000000000000000  AX       0     0     1\n  [ 2] .rela.text        RELA             0000000000000000  00000358\n       0000000000000078  0000000000000018   I       9     1     8\n  [ 3] .data             PROGBITS         0000000000000000  000000c0\n       0000000000000004  0000000000000000  WA       0     0     4\n  [ 4] .bss              NOBITS           0000000000000000  000000c4\n       0000000000000004  0000000000000000  WA       0     0     4\n  [ 5] .comment          PROGBITS         0000000000000000  000000c4\n       000000000000002a  0000000000000001  MS       0     0     1\n  [ 6] .note.GNU-stack   PROGBITS         0000000000000000  000000ee\n       0000000000000000  0000000000000000           0     0     1\n  [ 7] .eh_frame         PROGBITS         0000000000000000  000000f0\n       0000000000000078  0000000000000000   A       0     0     8\n  [ 8] .rela.eh_frame    RELA             0000000000000000  000003d0\n       0000000000000048  0000000000000018   I       9     7     8\n  [ 9] .symtab           SYMTAB           0000000000000000  00000168\n       0000000000000180  0000000000000018          10    10     8\n  [10] .strtab           STRTAB           0000000000000000  000002e8\n       000000000000006b  0000000000000000           0     0     1\n  [11] .shstrtab         STRTAB           0000000000000000  00000418\n       0000000000000059  0000000000000000           0     0     1\n</code></pre><p>å…¶ä¸­çš„readelf -Sé€‰é¡¹æ˜¯æ‰“å°å‡ºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰€æœ‰section-headerçš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°example.oé‡Œæ€»å…±åŒ…å«äº†12ä¸ªsectionï¼Œå…¶ä¸­ï¼Œ.textæ®µã€.dataæ®µå’Œ.bssæ®µæˆ‘åœ¨å‰é¢çš„è¯¾ç¨‹é‡Œéƒ½æåˆ°è¿‡ï¼Œè¿™é‡Œæˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹.rela.textæ®µã€‚</p><p>ä»section-headerçš„ä¿¡æ¯é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ.rela.textæ®µçš„ç±»å‹æ˜¯RELAç±»å‹ï¼Œä¹Ÿå°±æ˜¯é‡å®šä½è¡¨ã€‚æˆ‘ä»¬åœ¨å‰é¢è®²åˆ°ï¼Œé“¾æ¥å™¨åœ¨å¤„ç†ç›®æ ‡æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦å¯¹ç›®æ ‡æ–‡ä»¶é‡Œä»£ç æ®µå’Œæ•°æ®æ®µå¼•ç”¨åˆ°çš„ç¬¦å·è¿›è¡Œé‡å®šä½ï¼Œè€Œè¿™äº›é‡å®šä½çš„ä¿¡æ¯éƒ½è®°å½•åœ¨å¯¹åº”çš„é‡å®šä½è¡¨é‡Œã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œé‡å®šä½è¡¨çš„åå­—éƒ½æ˜¯ä»¥.relaå¼€å¤´ï¼Œæ¯”å¦‚.rela.textå°±æ˜¯å¯¹.textæ®µçš„é‡å®šä½è¡¨ï¼Œ.rela.dataæ˜¯å¯¹.dataæ®µçš„é‡å®šä½è¡¨ã€‚å› ä¸ºæˆ‘ä»¬çš„ä¾‹å­ä¸­å¹¶æ²¡æœ‰æ¶‰åŠ.dataæ®µçš„é‡å®šä½ï¼Œæ‰€ä»¥ï¼Œåœ¨ä¸Šé¢æ‰“å°çš„ä¿¡æ¯ä¸­æ²¡æœ‰å‡ºç°.rela.dataæ®µã€‚</p><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹.rela.texté‡å®šä½è¡¨é‡Œçš„å†…å®¹ã€‚ä½ å¯ä»¥é€šè¿‡readelf -ré€‰é¡¹æ¥æ‰“å°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„é‡å®šä½è¡¨ä¿¡æ¯ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code>Relocation section '.rela.text' at offset 0x330 contains 5 entries:\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n000000000020  000d00000002 R_X86_64_PC32     0000000000000000 extern_var - 4\n000000000029  000a00000002 R_X86_64_PC32     0000000000000000 global_var - 4\n000000000032  000300000002 R_X86_64_PC32     0000000000000000 .data + 0\n00000000003f  000e00000002 R_X86_64_PC32     0000000000000000 extern_func - 4\n00000000004c  000b00000002 R_X86_64_PC32     0000000000000000 global_func - 4\n</code></pre><p>.rela.textçš„é‡å®šä½è¡¨é‡Œå­˜æ”¾äº†textæ®µä¸­éœ€è¦è¿›è¡Œé‡å®šä½çš„æ¯ä¸€å¤„ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œæ¯ä¸ªé‡å®šä½é¡¹éƒ½ä¼šåŒ…å«éœ€è¦é‡å®šä½çš„åç§»ã€é‡å®šä½ç±»å‹å’Œé‡å®šä½ç¬¦å·ã€‚é‡å®šä½è¡¨çš„æ•°æ®ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p><pre><code>  typedef struct {\n    Elf64_Addrâ€º   r_offset; /* é‡å®šä½è¡¨é¡¹çš„åç§»åœ°å€ */\n    Elf64_Xwordâ€º  r_info;   /* é‡å®šä½çš„ç±»å‹ä»¥åŠé‡å®šä½ç¬¦å·çš„ç´¢å¼• */\n    Elf64_Sxwordâ€º r_addend; /* é‡å®šä½è¿‡ç¨‹ä¸­éœ€è¦çš„è¾…åŠ©ä¿¡æ¯ */\n  } Elf64_Rela;\n</code></pre><p>å…¶ä¸­ï¼Œr_infoçš„é«˜32bitå­˜æ”¾çš„æ˜¯é‡å®šä½ç¬¦å·åœ¨ç¬¦å·è¡¨çš„ç´¢å¼•ï¼Œr_infoçš„ä½32bitå­˜æ”¾çš„æ˜¯é‡å®šä½çš„ç±»å‹çš„ç´¢å¼•ã€‚ç¬¦å·è¡¨å°±æ˜¯.symtabæ®µï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè¿™ä¸ªå­—å…¸ä»¥æ•´æ•°ä¸ºkeyï¼Œä»¥ç¬¦å·åä¸ºvalueã€‚</p><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ ¹æ®ä¸Šæ–‡çš„æ±‡ç¼–ä»£ç æ¥çœ‹ï¼Œ.rela.textæ®µä¸­çš„é‡å®šä½è¡¨æ€»å…±æœ‰5é¡¹ï¼Œåˆ†åˆ«å¯¹åº”åˆ°.textçš„0x20, 0x29, 0x32, 0x3f, 0x4cåç§»å¤„ã€‚æˆ‘ä»¬ä»¥0x20ä¸ºä¾‹ï¼Œå®ƒå¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤æ˜¯0x1eä½ç½®çš„8b 05 00 00 00 00ã€‚0x20æŒ‡å‘çš„æ˜¯è¿™æ¡æŒ‡ä»¤çš„æ“ä½œæ•°ï¼Œåœ¨æ²¡æœ‰é‡å®šä½ä¹‹å‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªå››å­—èŠ‚å¡«å……çš„0ï¼Œå¯¹åº”çš„æ˜¯å¯¹å˜é‡extern_varçš„è®¿é—®ã€‚</p><p>åŒæ ·åœ°ï¼Œå…¶ä½™çš„å‡ å¤„åç§»ä½ç½®åˆ†åˆ«æ˜¯è®¿é—®global_varã€static_varã€global_funcå’Œextern_funcè¿™å››ä¸ªç¬¦å·ï¼ˆå‡½æ•°å’Œå˜é‡éƒ½å¯ç»Ÿä¸€çœ‹æˆæ˜¯ç¬¦å·ï¼‰çš„åœ°æ–¹ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç€é‡åˆ†æè¿™å››ä¸ªç¬¦å·çš„é‡å®šä½è¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡å®šä½è¡¨ä¸­çš„è¿™å››é¡¹ï¼Œ<strong>å®ƒä»¬çš„ç±»å‹éƒ½æ˜¯R_X86_64_PC32ã€‚è¿™ç§ç±»å‹çš„é‡å®šä½è®¡ç®—æ–¹å¼ä¸ºï¼šS + A â€“ P</strong>ã€‚</p><ul>\n<li>\n<p>è¿™é‡Œçš„Sè¡¨ç¤ºå®Œæˆé“¾æ¥åè¯¥ç¬¦å·çš„å®é™…åœ°å€ã€‚åœ¨é“¾æ¥å™¨å°†å¤šä¸ªä¸­é—´æ–‡ä»¶çš„æ®µåˆå¹¶ä»¥åï¼Œæ¯ä¸ªç¬¦å·å°±æŒ‰å…ˆåé¡ºåºä¾æ¬¡éƒ½ä¼šåˆ†é…åˆ°ä¸€ä¸ªåœ°å€ï¼Œè¿™å°±æ˜¯å®ƒçš„æœ€ç»ˆåœ°å€Sã€‚</p>\n</li>\n<li>\n<p>Aè¡¨ç¤ºAddendçš„å€¼ï¼Œå®ƒä»£è¡¨äº†å ä½ç¬¦çš„é•¿åº¦ã€‚å®ƒçš„å…·ä½“ç”¨æ³•æˆ‘ä»¬ä¸‹æ–‡è¿˜ä¼šè¯¦ç»†åˆ†æã€‚</p>\n</li>\n<li>\n<p>Pè¡¨ç¤ºè¦è¿›è¡Œé‡å®šä½ä½ç½®çš„åœ°å€æˆ–åç§»ï¼Œå¯ä»¥é€šè¿‡r_offsetçš„å€¼è·å–åˆ°ï¼Œè¿™æ˜¯å¼•ç”¨ç¬¦å·çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦å›å¡«åœ°å€çš„åœ°æ–¹ï¼Œç®€å•è¯´ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¸Šæ–‡æåˆ°çš„ç”¨0å¡«å……çš„å ä½ç¬¦çš„åœ°å€ã€‚</p>\n</li>\n</ul><p>è¿™é‡ŒSä¸Pæ‰€è¡¨ç¤ºçš„åœ°å€éƒ½æ˜¯æ–‡ä»¶åˆå¹¶ä¹‹åæœ€ç»ˆçš„è™šæ‹Ÿåœ°å€ï¼Œç”±äºæˆ‘ä»¬æ— æ³•è·å–é“¾æ¥å™¨ä¸­é—´è¿‡ç¨‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æŸ¥çœ‹é“¾æ¥å®Œæˆåçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¥å¯»æ‰¾è¿™ä¸¤ä¸ªåœ°å€ã€‚</p><p>æˆ‘ä»¬ä»¥extern_varçš„å˜é‡ä¸ºä¾‹ï¼Œå…·ä½“è·Ÿè¸ªä¸€éé‡å®šä½çš„è¿‡ç¨‹ã€‚</p><pre><code>00000000004004ad &lt;main&gt;:\n  4004ad:       55                      push   %rbp\n  4004ae:       48 89 e5                mov    %rsp,%rbp\n  4004b1:       48 83 ec 20             sub    $0x20,%rsp\n  4004b5:       8b 05 75 0b 20 00       mov    0x200b75(%rip),%eax        # 601030 &lt;extern_var&gt;\n  4004bb:       89 45 e8                mov    %eax,-0x18(%rbp)\n</code></pre><p>ä¸Šè¾¹è¾“å‡ºéƒ¨åˆ†æ˜¯å¯¹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„åæ±‡ç¼–ã€‚æ ¹æ®Sã€Aã€Pçš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºextern_varæ¥è®²ï¼š</p><ul>\n<li>Sæ˜¯å…¶æœ€ç»ˆç¬¦å·çš„çœŸå®åœ°å€ï¼Œå¦‚ä¸Šæ±‡ç¼–é‡Œè¾¹çš„æ³¨é‡Šæ‰€ç¤º  ä¹Ÿå°±æ˜¯ä¸Šé¢æ³¨é‡Šçš„0x601030è¿™ä¸ªåœ°å€ï¼›</li>\n<li>Aæ˜¯Addendçš„å€¼ï¼Œå¯ä»¥ä»é‡å®šä½è¡¨é‡ŒæŸ¥åˆ°æ˜¯-4ï¼Œå¯¹äºAçš„å…·ä½“å«ä¹‰æˆ‘è¿˜ä¼šè¿›ä¸€æ­¥è§£é‡Šï¼›</li>\n<li>Pæ˜¯é‡å®šä½offsetçš„åœ°å€ï¼Œè¿™é‡Œæ˜¯0x4004b7ã€‚</li>\n</ul><p>æ ¹æ®å…¬å¼ï¼Œæˆ‘ä»¬ç®—å‡ºé‡å®šä½å¤„éœ€è¦å¡«å†™çš„å€¼åº”è¯¥æ˜¯ 0x601030 + (-4) â€“ 0x4004b7 = 0x200b75ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆå¯æ‰§è¡Œæ–‡ä»¶ä¸­è¿™æ¡movæŒ‡ä»¤é‡Œçš„å€¼ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»é“¾æ¥å™¨çš„è§†è§’æ¨å‡ºäº†æœ€ç»ˆé‡å®šä½ä½ç½®çš„å€¼ï¼Œä½ å¯èƒ½ä¼šæ¯”è¾ƒè¿·ç³Šï¼šç³»ç»Ÿä¸ºä»€ä¹ˆæè¿™ä¹ˆä¸€å¥—å¤æ‚çš„å…¬å¼æ¥è®¡ç®—å‡ºè¿™ä¹ˆä¸€ä¸ªå€¼å‘¢ï¼Ÿè¿™ä¸ªå€¼çš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†ä»CPUçš„è§’åº¦æ¥çœ‹ä¸‹è¿™é‡Œçš„å–å€¼å…³ç³»ã€‚ä»ä¸Šé¢mainå‡½æ•°çš„åç¼–è¯‘çš„ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æœ€ç»ˆå¯¹extern_varçš„è®¿é—®ç”Ÿæˆçš„æ±‡ç¼–æ˜¯ï¼š</p><pre><code>mov    0x200b75(%rip), %eax\n</code></pre><p>è¿™æ˜¯ä¸€æ¡PCç›¸å¯¹åç§»çš„å¯»å€æ–¹å¼ã€‚å½“CPUæ‰§è¡Œåˆ°è¿™æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œ%ripçš„å€¼å­˜æ”¾çš„æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯0x4004bbã€‚è¿™æ—¶å€™å¯ä»¥ç®—å‡º0x4004bb + 0x200b75 = 0x601030ï¼Œåˆšå¥½æ˜¯extern_varçš„å®é™…åœ°å€ã€‚</p><p>ç»è¿‡æ­£é¢åˆ†æè¿™ä¸ªé‡å®šä½çš„å€¼çš„ä½œç”¨åï¼Œè¿™é‡Œæˆ‘ä»¬å†æ¥ç†è§£ä¸€ä¸‹S+A-Pè¿™ä¸ªå…¬å¼çš„ä½œç”¨ã€‚é“¾æ¥å™¨æœ‰äº†æ•´ä½“çš„è™šæ‹Ÿå†…å­˜å¸ƒå±€åï¼ŒçŸ¥é“çš„ä¿¡æ¯æ˜¯ï¼šéœ€è¦é‡å®šä½ç¬¦å·çš„åœ°å€Sçš„å€¼æ˜¯(0x601030)ï¼Œä»¥åŠéœ€è¦é‡å®šä½çš„ä½ç½®åœ°å€Pçš„å€¼æ˜¯(0x4004b7)ã€‚</p><p>è¿™æ—¶å€™ï¼Œé“¾æ¥å™¨éœ€è¦åœ¨æŒ‡ä»¤ä¸­å ä½ç¬¦çš„ä½ç½®å¡«ä¸€ä¸ªå€¼ï¼Œè®©ç¨‹åºè¿è¡Œçš„æ—¶å€™èƒ½å¤Ÿæ‰¾åˆ°Sã€‚ä½†ç¨‹åºè¿è¡Œåˆ°è¿™æ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œèƒ½å¤Ÿæ‹¿åˆ°çš„åœ°å€å°±åªæœ‰PCçš„å€¼ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€(0x4004bb)ã€‚ä½ ä¼šå‘ç°ï¼Œé‡å®šä½åœ°å€çš„å€¼è·Ÿä¸‹ä¸€æ¡pcçš„å€¼ï¼Œç›¸å·®çš„å°±æ˜¯è¿™ä¸ªAddend(-4)ï¼Œè¿™ä¸ªAddendå®é™…ä¸Šå°±æ˜¯ç”¨æ¥è°ƒæ•´Pçš„å€¼å’Œæ‰§è¡Œæ—¶PCçš„å€¼ä¹‹é—´çš„å·®å¼‚çš„ï¼Œæ‰€ä»¥å®ƒåˆšå¥½å°±æ˜¯å ä½ç¬¦çš„å®½åº¦ã€‚</p><h4>é™æ€å˜é‡</h4><p>é™¤äº†ä¸Šè¿°æ‰€è®²çš„å››ä¸ªç¬¦å·ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„æ˜¯static_varå˜é‡ã€‚æˆ‘ä»¬å¯ä»¥ä»Sym. Nameé‡Œæ‰¾åˆ°å…¶ä½™å˜é‡çš„ç¬¦å·ï¼Œä½†static_varçš„ç¬¦å·æ²¡æœ‰å‡ºç°ï¼Œåªæœ‰ä¸€ä¸ª.dataçš„ç¬¦å·ã€‚</p><p>è¿™æ˜¯å› ä¸ºstatic_varå˜é‡æœ¬èº«æ˜¯ä¸€ä¸ªé™æ€å˜é‡ï¼Œåªåœ¨æœ¬ç¼–è¯‘å•å…ƒå†…å¯è§ï¼Œä¸ä¼šå¯¹å¤–è¿›è¡Œæš´éœ²ï¼Œæ‰€ä»¥å®ƒæ˜¯æ ¹æ®æœ¬ç¼–è¯‘å•å…ƒçš„.dataæ®µçš„åœ°å€æ¥è¿›è¡Œé‡å®šä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>static_varçš„æœ€ç»ˆåœ°å€å°±æ˜¯æœ¬ç¼–è¯‘å•å…ƒçš„.dataæ®µçš„æœ€ç»ˆåœ°å€</strong>ã€‚æ‰€ä»¥ï¼Œå®ƒçš„é‡å®šä¹‰æ–¹æ³•ä¸extern_varç­‰ç¬¦å·çš„é‡å®šä½æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«ä»…ä»…åœ¨äºå®ƒçš„ç¬¦å·è¢«éšè—äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2e/be/2e29c9c26a715015ce08d3946dee6fbe.jpg?wh=2284x1032\" alt=\"\"></p><p>ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œæ—¢ç„¶é™æ€å‡½æ•°å¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ç¡®å®šç›¸å¯¹åç§»ï¼Œé‚£ä¸ºä»€ä¹ˆé™æ€å˜é‡åšä¸åˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºé™æ€å˜é‡çš„ä½ç½®æ˜¯åœ¨dataæ®µï¼Œè€Œå¯¹é™æ€å‡½æ•°çš„è®¿é—®æ˜¯åœ¨textæ®µã€‚å¯¹åº”textæ®µå†…éƒ¨çš„åç§»å¯ä»¥ä¿è¯åœ¨é“¾æ¥çš„è¿‡ç¨‹ä¸­ä¸å‘ç”Ÿæ”¹å˜ï¼Œä½†ç”±äºtextæ®µå’Œdataæ®µåˆ†å±ä¸åŒçš„æ®µï¼Œåœ¨é“¾æ¥çš„æ—¶å€™å¤§æ¦‚ç‡ä¼šè¿›è¡Œé‡æ–°æ’å¸ƒï¼Œæ‰€ä»¥å®ƒå’Œå¼•ç”¨å®ƒçš„åœ°æ–¹ä¹‹é—´çš„ç›¸å¯¹ä½ç½®å°±å‘ç”Ÿå˜åŒ–äº†ã€‚æ‰€ä»¥é™æ€å˜é‡çš„åœ°å€å°±éœ€è¦é“¾æ¥å™¨æ¥è¿›è¡Œé‡å®šä½äº†ã€‚</p><p>å¥½ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯¹æ•´ä¸ªé‡å®šä½çš„è¿‡ç¨‹æœ‰äº†æ¸…æ™°çš„äº†è§£ã€‚</p><h3>æ€»ç»“</h3><p>æˆ‘ä»¬ä»Šå¤©è®²è§£äº†åœ¨é™æ€é“¾æ¥è¿‡ç¨‹ä¸­ï¼Œå˜é‡ä¸å†…å­˜åœ°å€æ˜¯å¦‚ä½•å¯¹åº”èµ·æ¥çš„ã€‚å…¶ä¸­ï¼Œé“¾æ¥å™¨çš„é‡å®šä½æ“ä½œæ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒæ­¥éª¤ã€‚</p><p>æˆ‘ä»¬è¯´ï¼Œä»æºæ–‡ä»¶ç”ŸæˆäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸€è¿‡ç¨‹ä¸»è¦åŒ…å«äº†ç¼–è¯‘å’Œé“¾æ¥ä¸¤ä¸ªæ­¥éª¤ã€‚å…¶ä¸­ï¼Œç¼–è¯‘çš„ä½œç”¨æ˜¯ç”Ÿæˆæ€§èƒ½ä¼˜è¶Šçš„æœºå™¨ç ã€‚å¯¹äºç¼–è¯‘å•å…ƒå†…éƒ¨çš„é™æ€å‡½æ•°ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶é€šè¿‡ç›¸å¯¹åœ°å€çš„åŠæ³•ï¼Œç”ŸæˆcallæŒ‡ä»¤ï¼Œå› ä¸ºæ— è®ºå°†æ¥è°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€…è¢«å®‰ç½®åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œå®ƒä»¬ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>è€Œå…¶ä»–ç±»å‹çš„å˜é‡å’Œå‡½æ•°åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“å®ƒä»¬çš„æœ€ç»ˆåœ°å€ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨å ä½ç¬¦ï¼ˆæ¯”å¦‚0ï¼‰æ¥ä¸´æ—¶ä»£æ›¿ç›®æ ‡åœ°å€ã€‚</p><p>è€Œé“¾æ¥å™¨çš„ä»»åŠ¡æ˜¯ä¸ºæ‰€æœ‰å˜é‡å’Œå‡½æ•°åˆ†é…åœ°å€ï¼Œå¹¶æŠŠè¢«åˆ†é…åˆ°çš„åœ°å€å›å†™åˆ°è°ƒç”¨è€…å¤„ã€‚é“¾æ¥çš„è¿‡ç¨‹ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å¤šæ–‡ä»¶åˆå¹¶ï¼ŒåŒæ—¶ä¸ºç¬¦å·åˆ†é…åœ°å€ï¼Œç¬¬äºŒæ­¥åˆ™æ˜¯å°†ç¬¦å·çš„åœ°å€å›å†™åˆ°å¼•ç”¨å®ƒçš„åœ°æ–¹ã€‚å…¶ä¸­ï¼Œåœ°å€å›å†™æœ‰ä¸€ä¸ªä¸“é—¨çš„åå­—å«åšé‡å®šä½ã€‚é‡å®šä½çš„è¿‡ç¨‹ä¾èµ–ç›®æ ‡æ–‡ä»¶ä¸­çš„é‡å®šä½è¡¨ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å¯¹ä¾‹å­ä¸­çš„å‡ ç§ä¸åŒç±»å‹ç¬¦å·çš„é™æ€é“¾æ¥æœ‰äº†ä¸€ä¸ªæ¸…æ™°çš„è®¤è¯†ã€‚ä¸‹é¢çš„è¯¾ç¨‹æˆ‘ä¼šç»§ç»­è®²è§£loaderå’ŒåŠ¨æ€é“¾æ¥çš„è¿‡ç¨‹ã€‚</p><h3>æ€è€ƒé¢˜</h3><p>ç»è¿‡äº†è¿™èŠ‚è¯¾çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æ·±åˆ»åœ°ç†è§£äº†å…¨å±€å˜é‡ï¼Œé™æ€å˜é‡çš„ç”¨æ³•ã€‚è¯·ä½ æ€è€ƒä¸€ä¸‹ï¼Œå…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„åˆå€¼æ˜¯åœ¨å“ªä¸ªé˜¶æ®µå†³å®šçš„ï¼Ÿæ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯ç¼–è¯‘ã€é“¾æ¥ã€åŠ è½½å’Œè¿è¡Œè¿™å››ä¸ªé˜¶æ®µä¸­çš„å“ªä¸€ä¸ªé˜¶æ®µå†³å®šçš„ï¼Ÿæˆ–è€…ä½ ä¹Ÿå¯ä»¥è¿›è¡Œè¿™æ ·çš„æ€è€ƒï¼Œæˆ‘ä»¬åœ¨ç›®æ ‡æ–‡ä»¶ã€å¯æ‰§è¡Œæ–‡ä»¶å’Œè¿è¡Œæ—¶å†…å­˜é‡Œï¼Œèƒ½ä¸èƒ½è§‚å¯Ÿåˆ°å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„åˆå§‹å€¼ï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµä½ çš„æƒ³æ³•ï¼Œæˆ‘åœ¨ç•™è¨€åŒºç­‰ä½ ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/78/3a/78039e07de9e869b6e966da9a61e963a.jpg?wh=2284x1523\" alt=\"\"><br>\nå¥½å•¦ï¼Œè¿™èŠ‚è¯¾åˆ°è¿™å°±ç»“æŸå•¦ã€‚æ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šå¯¹è®¡ç®—æœºå†…å­˜æ„Ÿå…´è¶£çš„æœ‹å‹ã€‚æˆ‘æ˜¯æµ·çº³ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":320301,"user_name":"keepgoing","can_delete":false,"product_type":"c1","uid":1471387,"ip_address":"","ucode":"A2FE0687FB17E0","user_header":"https://static001.geekbang.org/account/avatar/00/16/73/9b/67a38926.jpg","comment_is_top":false,"comment_ctime":1636209757,"is_pvip":false,"replies":[{"id":"116153","content":"æ€»ç»“å¾—çœŸå¥½ï¼æ¥ï¼Œæ¥ï¼Œæ¥ï¼Œç¬”ç»™ä½ ï¼Œä½ æ¥å†™ã€‚å“ˆå“ˆå“ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636279556,"ip_address":"","comment_id":320301,"utype":1}],"discussion_count":2,"race_medal":0,"score":"113305359453","product_id":100094901,"comment_content":"è‡ªå·±çš„è¯æ€»ç»“ï¼š<br><br>1. é™æ€å‡½æ•°ä¸éœ€è¦é‡å®šä½å› ä¸ºå’Œæ‰§è¡Œå•å…ƒä»£ç éƒ½åœ¨.textæ®µï¼Œç›¸å¯¹ä½ç½®åœ¨ç¼–è¯‘çš„æ—¶å€™å°±èƒ½ç¡®å®šäº†ï¼Œå› ä¸ºé“¾æ¥å™¨åˆå¹¶ä¸­é—´æ–‡ä»¶æ—¶ç›¸å¯¹ä½ç½®ä¸ä¼šå˜ã€‚<br>2. é™æ€å˜é‡éœ€è¦é‡å®šä½ï¼Œå› ä¸ºå’Œç¼–è¯‘å•å…ƒä»£ç æ®µ.textåˆ†å±ä¸åŒçš„sectionï¼Œåœ¨.dataï¼Œé“¾æ¥å™¨åˆå¹¶æ–‡ä»¶æ—¶ä¼šé‡æ–°æ’å¸ƒï¼Œæ‰€ä»¥éœ€è¦é‡å®šä½ã€‚<br>3. å…¨å±€å˜é‡&#47;å‡½æ•°ï¼Œå¤–éƒ¨å˜é‡&#47;å‡½æ•°éƒ½æ˜¯éœ€è¦è¢«é‡å®šä½çš„ï¼Œå¤§è‡´æ–¹æ³•å°±æ˜¯ï¼š<br>ç¼–è¯‘å™¨å…ˆç”¨0å ä½ç¬¦å·ã€é“¾æ¥é‡å®šä½è¡¨æ‰¾ç¬¦å·ã€å®šä½ç¬¦å·åœ°å€ã€ç„¶ååœ¨å½“å‰ä»£ç æ®µè®¡ç®—RIPç›¸å¯¹åç§»ä½ç½®å¡«ä¸Šã€‚<br><br>ç¼–è¯‘å™¨ï¼šç”Ÿæˆæœºå™¨ç ã€ç¬¦å·0å ä½<br>é“¾æ¥å™¨ï¼šåˆå¹¶æ–‡ä»¶ï¼Œåˆ†é…ç¬¦å·åœ°å€ï¼Œç»™ç¬¦å·åœ°å€å†™å›ç¼–è¯‘å‡ºçš„ä»£ç ","like_count":27,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529949,"discussion_content":"æ€»ç»“å¾—çœŸå¥½ï¼æ¥ï¼Œæ¥ï¼Œæ¥ï¼Œç¬”ç»™ä½ ï¼Œä½ æ¥å†™ã€‚å“ˆå“ˆå“ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636279556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2304123,"avatar":"","nickname":"Geek_ed84ef","note":"","ucode":"D64973A23FCAA8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":587544,"discussion_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œå¯¹äºexample.cä¸­çš„å…¨å±€å‡½æ•°global_funcï¼Œå½“æœ¬ç¼–è¯‘å•å…ƒå†…å¼•ç”¨å®ƒæ—¶ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åƒé™æ€å‡½æ•°é‚£æ ·ä½¿ç”¨ç›¸å¯¹åç§»è§£æç¬¦å·å‘¢ï¼Ÿä»–ä»¬ä¸æ˜¯éƒ½å¤„äºtextæ®µå—ï¼Ÿè¿™æ ·å°±ä¸éœ€è¦é“¾æ¥å™¨æ¥è¿›è¡Œé‡å®šä½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663139090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529949,"ip_address":"å¹¿ä¸œ"},"score":587544,"extra":""}]}]},{"had_liked":false,"id":320304,"user_name":"æ…¢åŠ¨ä½œ","can_delete":false,"product_type":"c1","uid":1133945,"ip_address":"","ucode":"62C944F4A4D8AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/79/803537db.jpg","comment_is_top":false,"comment_ctime":1636211522,"is_pvip":true,"replies":[{"id":"116152","content":"Sæ˜¯ç»å¯¹åœ°å€ï¼Œè€ŒS+A-Pç®—å‡ºæ¥çš„æ˜¯ç›¸å¯¹åœ°å€ã€‚ä½¿ç”¨ç›¸å¯¹åœ°å€çš„å¥½å¤„æ˜¯åªè¦å¼•ç”¨è€…å’Œè¢«å¼•ç”¨è€…çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œé‚£ä¹ˆå®ƒä»¬å°±å¯ä»¥è¢«å®‰æ’åˆ°ä»»æ„çš„ä½ç½®ä¸Šã€‚è¿™å°±å¯ä»¥æ”¯æŒåŠ è½½åœ°å€éšæœºåŒ–ç­‰å®‰å…¨å¢å¼ºæŠ€æœ¯å•¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636279520,"ip_address":"","comment_id":320304,"utype":1}],"discussion_count":2,"race_medal":0,"score":"48880851778","product_id":100094901,"comment_content":"ä¸ºä»€ä¹ˆè¦Sï¼‹Aï¼Pï¼Œç›´æ¥ç”¨Sæœ‰ä»€ä¹ˆä¸å¥½çš„ï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529950,"discussion_content":"Sæ˜¯ç»å¯¹åœ°å€ï¼Œè€ŒS+A-Pç®—å‡ºæ¥çš„æ˜¯ç›¸å¯¹åœ°å€ã€‚ä½¿ç”¨ç›¸å¯¹åœ°å€çš„å¥½å¤„æ˜¯åªè¦å¼•ç”¨è€…å’Œè¢«å¼•ç”¨è€…çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œé‚£ä¹ˆå®ƒä»¬å°±å¯ä»¥è¢«å®‰æ’åˆ°ä»»æ„çš„ä½ç½®ä¸Šã€‚è¿™å°±å¯ä»¥æ”¯æŒåŠ è½½åœ°å€éšæœºåŒ–ç­‰å®‰å…¨å¢å¼ºæŠ€æœ¯å•¦ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1636279520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1702566,"avatar":"","nickname":"GEEKBANG_6400905","note":"","ucode":"1F89B6CBD3FB00","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586629,"discussion_content":"æˆ‘è§‰å¾—åº”è¯¥è¿™ä¹ˆç†è§£ï¼Œæ€ä¹ˆè®¡ç®—å–å†³äºä½ æ˜¯æ€ä¹ˆå¼•ç”¨çš„ï¼Œä½ å¼•ç”¨çš„æŒ‡ä»¤é‡‡ç”¨ç»å¯¹åœ°å€å°±æ˜¯ç»å¯¹åœ°å€ï¼Œä½ å¼•ç”¨çš„åœ°æ–¹é‡‡ç”¨ç›¸å¯¹åœ°å€å°±æ˜¯ç›¸å¯¹åœ°å€ï¼Œmov    0x0(%rip),%eaxæŒ‡ä»¤å…¶æœ¬èº«å°±æ˜¯é‡‡ç”¨ç›¸å¯¹åœ°å€å¯»å€æ–¹å¼ï¼Œæ‰€ä»¥ä½ è¦æ”¾ä¸€ä¸ªç›¸å¯¹åœ°å€è¿›å»ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®æ‰¾åˆ°extern_varå˜é‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662383695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321210,"user_name":"éµ¼","can_delete":false,"product_type":"c1","uid":1101766,"ip_address":"","ucode":"F6561743835F7E","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/c6/6a2d0a5e.jpg","comment_is_top":false,"comment_ctime":1636708713,"is_pvip":false,"replies":[{"id":"117076","content":"very good:)","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637375555,"ip_address":"","comment_id":321210,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14521610601","product_id":100094901,"comment_content":"å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„åˆå€¼åœ¨ç¼–è¯‘é˜¶æ®µå§ã€‚åˆå§‹å€¼åº”è¯¥éƒ½åœ¨.dataæ®µã€‚é“¾æ¥çš„ä¸»è¦å·¥ä½œæ˜¯åˆå¹¶ç›®æ ‡æ–‡ä»¶ä»¥åŠé‡å®šå‘ç¬¦å·ã€‚å¯ä»¥çœ‹åˆ°é‡å®šå‘æ˜¯è¿›è¡Œåœ°å€çš„è½¬æ¢ã€‚ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å˜é‡å’Œå‡½æ•°çš„åœ°å€éƒ½ç”¨0å ä½ï¼Œé™æ€æ–¹æ³•é™¤å¤–ï¼Œå› ä¸ºé™æ€æ–¹æ³•æ˜¯è®¡ç®—çš„ç›¸å¯¹åç§»é‡ï¼Œåœ°å€æ€ä¹ˆå˜æ— æ‰€è°“ï¼Œåç§»é‡æ˜¯å›ºå®šçš„ã€‚ä½†æ˜¯é“¾æ¥ä¸»è¦æ˜¯ç¬¦å·åœ°å€è½¬åŒ–ï¼Œå¹¶ä¸ä»£è¡¨æ˜¯å€¼ï¼Œå€¼åº”è¯¥æ˜¯åœ¨ dataæ®µä¿å­˜å¥½çš„ï¼Œåªæ˜¯é€šè¿‡é“¾æ¥æŠŠåœ°å€å€¼å›å¡«ã€‚å› æ­¤ï¼Œæˆ‘çŒœæµ‹æ˜¯ç¼–è¯‘é˜¶æ®µï¼Œç›®æ ‡æ–‡ä»¶åº”è¯¥æ˜¯èƒ½çœ‹åˆ°åˆå§‹å€¼çš„ã€‚å¯¹äºæ•°ç»„ç±»å‹çš„å…¨å±€å˜é‡ï¼Œå› ä¸ºéƒ½æ˜¯0ï¼Œæ‰€ä»¥æ”¾åœ¨bssæ®µï¼Œåº”è¯¥æ˜¯åœ¨åŠ è½½çš„æ—¶å€™å†åˆ†é…å†…å­˜å§ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯åœ¨åŠ è½½çš„æ—¶å€™å†³å®šå§ã€‚","like_count":4,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531656,"discussion_content":"very good:)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637375555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1153978,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","nickname":"Linuxer","note":"","ucode":"272D9D8089C3D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547605,"discussion_content":"åŸºæœ¬ç±»å‹å¯ä»¥ç†è§£ï¼Œè¯·é—®å¦‚æœæ˜¯ç±»å®ä¾‹å‘¢ï¼Ÿè°å»è´Ÿè´£è°ƒç”¨æ„é€ æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642764730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2839104,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/52/40/1fe5be2b.jpg","nickname":"è”é€š","note":"","ucode":"EAA1331CFAFDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1153978,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","nickname":"Linuxer","note":"","ucode":"272D9D8089C3D6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551355,"discussion_content":"ç±»å®ä¾‹åŒ–çš„æ—¶å€™æ‰ä¼šè°ƒç”¨æ„é€ æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºè¿è¡Œçš„æ—¶å€™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644996573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":547605,"ip_address":""},"score":551355,"extra":""}]}]},{"had_liked":false,"id":320767,"user_name":"éƒ‘ç«¥æ–‡","can_delete":false,"product_type":"c1","uid":1030733,"ip_address":"","ucode":"3D193715CB8549","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/4d/7ba09ff0.jpg","comment_is_top":false,"comment_ctime":1636508248,"is_pvip":false,"replies":[{"id":"116618","content":"æ ˆæ˜¯åœ¨ç”¨æˆ·ç©ºé—´çš„é¡¶éƒ¨ï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿå†³å®šçš„ä½ç½®ã€‚å¯¹äºç¼–è¯‘å™¨å’Œé“¾æ¥å™¨æ¥è¯´ï¼Œæ ˆåŸºå€åœ¨å“ªé‡Œéƒ½æ˜¯å¯ä»¥çš„ã€‚å› ä¸ºå¯¹æ ˆçš„æ“ä½œéƒ½æ˜¯é€šè¿‡æ ˆé¡¶æŒ‡é’ˆå®Œæˆçš„ã€‚åªè¦æ ˆé¡¶çš„æ•°æ®æ˜¯å¯¹çš„ï¼Œå°±éƒ½æ˜¯å¯¹çš„ã€‚å †çš„èµ·å§‹è¾¹ç•Œæ˜¯brkæŒ‡é’ˆå†³å®šçš„ã€‚è€Œbrkæ˜¯ä»£ç æ®µé•¿åº¦+æ•°æ®æ®µé•¿åº¦+bssæ®µé•¿åº¦å†³å®šçš„ã€‚å½“åŠ è½½å™¨åœ¨åŠ è½½å„ä¸ªæ®µçš„æ—¶å€™ä¼šè®¡ç®—brkæŒ‡é’ˆçš„ã€‚æ‰€ä»¥ç­”æ¡ˆæ˜¯æ–‡ä»¶ä¸­ä¸ç”¨ä¿å­˜ï¼Œä½†åŠ è½½å™¨ä¼šæ ¹æ®æ–‡ä»¶ä¸­çš„ä¿¡æ¯å»è®¡ç®—brkæŒ‡é’ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636698647,"ip_address":"","comment_id":320767,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10226442840","product_id":100094901,"comment_content":"è°¢è°¢è€å¸ˆå¯¹æˆ‘å‰ä¸€ä¸ªé—®é¢˜çš„å›ç­”ï¼Œå¯èƒ½æˆ‘å½“æ—¶æ²¡æœ‰è¡¨è¾¾æ¸…æ¥šã€‚ å†æ¥ç€é—®ä¸€ä¸‹ã€‚ æˆ‘çš„æ„æ€æ˜¯æ ˆå’Œå †åŒºåŸŸåœ¨è™šæ‹Ÿå†…å­˜å¸ƒå±€çš„èµ·å§‹è™šæ‹Ÿåœ°å€ï¼ˆä¹Ÿå°±æ˜¯å®ƒä»¬çš„èµ·å§‹è¾¹ç•Œï¼‰æ˜¯å¦‚ä½•ç¡®å®šçš„ï¼Ÿ ä¼šä¿å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­å—ï¼Ÿ è°¢è°¢ï¼","like_count":2,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530104,"discussion_content":"æ ˆæ˜¯åœ¨ç”¨æˆ·ç©ºé—´çš„é¡¶éƒ¨ï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿå†³å®šçš„ä½ç½®ã€‚å¯¹äºç¼–è¯‘å™¨å’Œé“¾æ¥å™¨æ¥è¯´ï¼Œæ ˆåŸºå€åœ¨å“ªé‡Œéƒ½æ˜¯å¯ä»¥çš„ã€‚å› ä¸ºå¯¹æ ˆçš„æ“ä½œéƒ½æ˜¯é€šè¿‡æ ˆé¡¶æŒ‡é’ˆå®Œæˆçš„ã€‚åªè¦æ ˆé¡¶çš„æ•°æ®æ˜¯å¯¹çš„ï¼Œå°±éƒ½æ˜¯å¯¹çš„ã€‚å †çš„èµ·å§‹è¾¹ç•Œæ˜¯brkæŒ‡é’ˆå†³å®šçš„ã€‚è€Œbrkæ˜¯ä»£ç æ®µé•¿åº¦+æ•°æ®æ®µé•¿åº¦+bssæ®µé•¿åº¦å†³å®šçš„ã€‚å½“åŠ è½½å™¨åœ¨åŠ è½½å„ä¸ªæ®µçš„æ—¶å€™ä¼šè®¡ç®—brkæŒ‡é’ˆçš„ã€‚æ‰€ä»¥ç­”æ¡ˆæ˜¯æ–‡ä»¶ä¸­ä¸ç”¨ä¿å­˜ï¼Œä½†åŠ è½½å™¨ä¼šæ ¹æ®æ–‡ä»¶ä¸­çš„ä¿¡æ¯å»è®¡ç®—brkæŒ‡é’ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636698647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2170263,"avatar":"https://static001.geekbang.org/account/avatar/00/21/1d/97/9a8b2d0c.jpg","nickname":"ğŸ™ƒ","note":"","ucode":"6E41B3D10A33CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413677,"discussion_content":"å †æ ˆåŒºçš„èµ·å§‹åœ°å€ä¸ä¼šä¿å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå› ä¸ºå †æ ˆå¯ä»¥çœ‹åšæ˜¯è¿›ç¨‹çš„åœ°å€ç©ºé—´èµ„æºï¼Œä¹Ÿå°±æ˜¯ç”±æ“ä½œç³»ç»Ÿç®¡ç†çš„å†…å­˜ç©ºé—´ï¼Œå…·ä½“çš„è¿›ç¨‹ç©ºé—´åˆ†é…å¯ä»¥å‚è€ƒã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹ç¬¬å…­ç« â€”â€”å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½ä¸è¿›ç¨‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1636539558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324739,"user_name":"å°æ—¶å€™å¯é²œå•¦","can_delete":false,"product_type":"c1","uid":1050777,"ip_address":"","ucode":"C88B3EDF758230","user_header":"https://static001.geekbang.org/account/avatar/00/10/08/99/6ab45a2f.jpg","comment_is_top":false,"comment_ctime":1638597325,"is_pvip":false,"replies":[{"id":"117857","content":"å·²ä¿®å¤ï¼Œè°¢è°¢","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1638719752,"ip_address":"","comment_id":324739,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5933564621","product_id":100094901,"comment_content":"å°æ ‡é¢˜é™æ€å˜é‡å’Œæ€»ç»“ä¹‹é—´çš„é‚£å¼ è®²è¿°é™æ€å˜é‡é‡å®šä½çš„ç¤ºæ„å›¾ä¸­ï¼ˆæœ‰é”™è¯¯ï¼‰ï¼š<br>227åœ°å€å¤„çš„æŒ‡ä»¤é•¿åº¦åº”è¯¥ä¸º6å­—èŠ‚ï¼š8b 05 00 00 00 00, é‚£ä¹ˆæ ¹æ®OFFSET = S + A - P = (102 + (- 4) -  227ï¼‰ = 0x12D è€Œä¸æ˜¯å›¾ä¸­çš„0x12C","like_count":1,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536236,"discussion_content":"å·²ä¿®å¤ï¼Œè°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638719752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1026818,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ab/02/8688abed.jpg","nickname":"nightn","note":"","ucode":"39FC4FF0281637","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536744,"discussion_content":"ã€Œå°æ—¶å€™å¯é²œå•¦ã€åŒå­¦çš„è®¡ç®—è¿‡ç¨‹æœ‰ç‚¹å°é—®é¢˜ã€‚static_var çš„åœ°å€æ˜¯ 0x100ï¼Œå³ S æ˜¯ 0x100ï¼Œè¿™æ¡ mov æŒ‡ä»¤çš„åœ°å€æ˜¯ 0x227ï¼Œå…± 6 å­—èŠ‚ï¼Œéœ€è¦é‡å®šä½çš„æ˜¯è¿™æ¡æŒ‡ä»¤çš„å 4 ä¸ªå­—èŠ‚ï¼Œå› æ­¤é‡å®šä½å…¥å£æ˜¯ 0x229ï¼Œå³ P æ˜¯ 0x229ã€‚A æ˜¯ -4ã€‚è®¡ç®—ç»“æœä¸ºï¼šS + A - P = (0x100 + (-4) - 0x229) = 0x12Dã€‚å¦å¤–æœ‰ä¸ªç–‘æƒ‘æƒ³è¯·æ•™ä¸€ä¸‹æµ·çº³è€å¸ˆï¼Œaddend æ˜¯ PC åˆ°é‡å®šä½å…¥å£çš„è·ç¦»ï¼Œæ–‡ç« ä¹Ÿæåˆ° addend ä»£è¡¨äº†å ä½ç¬¦çš„é•¿åº¦ã€‚å¦‚æœéœ€è¦é‡å®šä½çš„é‚£å‡ ä¸ªå­—èŠ‚å¹¶ä¸ä½äºæŒ‡ä»¤çš„æœ«ç«¯ï¼Œè€Œæ˜¯ä½äºæŒ‡ä»¤çš„ä¸­é—´ï¼Œé‚£ä¹ˆ addend å’Œå ä½ç¬¦é•¿åº¦å°±ä¸ä¸€æ ·äº†å§ï¼Ÿï¼ˆæ¯”å¦‚è¿™æ ·ä¸€æ¡æŒ‡ä»¤ï¼šxx 00 00 00 00 xxï¼Œä¸€å…± 6 å­—èŠ‚ï¼Œä¸­é—´ 4 å­—èŠ‚éœ€è¦é‡å®šä½ï¼Œaddend åº”è¯¥æ˜¯ -5ï¼Œä½†å ä½ç¬¦é•¿åº¦æ˜¯ 4ï¼‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1638860982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":536236,"ip_address":""},"score":536744,"extra":""}]}]},{"had_liked":false,"id":322559,"user_name":"æ¨å†›","can_delete":false,"product_type":"c1","uid":1988156,"ip_address":"","ucode":"AF881224E54C14","user_header":"https://static001.geekbang.org/account/avatar/00/1e/56/3c/f9ff3ed8.jpg","comment_is_top":false,"comment_ctime":1637481570,"is_pvip":false,"replies":[{"id":"117189","content":"ä»æ³¨é‡Šé‡Œçœ‹åˆ°çš„ã€‚objdumpåœ¨åç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šæŠŠåœ°å€æ”¾åœ¨æ³¨é‡Šé‡Œç»™ä½ çœ‹ã€‚å®é™…ä¸Šï¼Œåç¼–è¯‘çš„è¿‡ç¨‹å°±æ˜¯ä»æ–‡ä»¶ä¸­æŠŠè¿™äº›ä¿¡æ¯è¯»å‡ºæ¥å¹¶å±•ç¤ºç»™ä½ çš„è¿‡ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637587601,"ip_address":"","comment_id":322559,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5932448866","product_id":100094901,"comment_content":"è€å¸ˆï¼ŒS+A-Pï¼Œè¿™é‡Œçš„S æ˜¯å…¶æœ€ç»ˆç¬¦å·çš„çœŸå®åœ°å€ï¼Œä¹Ÿå°±æ˜¯ 0x601030 ï¼›A æ˜¯ Addend çš„å€¼ï¼Œå¯ä»¥ä»é‡å®šä½è¡¨é‡ŒæŸ¥åˆ°æ˜¯ -4ï¼Œï¼›P æ˜¯é‡å®šä½ offset çš„åœ°å€ï¼Œè¿™é‡Œæ˜¯ 0x4004b7ã€‚0x601030ï¼Œ0x4004b7å¯ä»¥ä»å“ªé‡ŒæŸ¥åˆ°äº†ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532371,"discussion_content":"ä»æ³¨é‡Šé‡Œçœ‹åˆ°çš„ã€‚objdumpåœ¨åç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šæŠŠåœ°å€æ”¾åœ¨æ³¨é‡Šé‡Œç»™ä½ çœ‹ã€‚å®é™…ä¸Šï¼Œåç¼–è¯‘çš„è¿‡ç¨‹å°±æ˜¯ä»æ–‡ä»¶ä¸­æŠŠè¿™äº›ä¿¡æ¯è¯»å‡ºæ¥å¹¶å±•ç¤ºç»™ä½ çš„è¿‡ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637587601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019138,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/02/6a16058a.jpg","nickname":"liu_liu","note":"","ucode":"24283806A07759","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532844,"discussion_content":"åœ¨æœªé“¾æ¥æ—¶ï¼Œå¯ä»¥çœ‹åˆ° 1e: 8b 05 00 00 00 00 éœ€è¦é‡å®šä½åœ°å€æ˜¯ 0x20ï¼ˆ1e åä¸¤ä¸ªå­—èŠ‚ï¼‰ï¼Œç›¸å¯¹äº main çš„åç§»æ˜¯ 0x20 - 0x16 = 0xaï¼›\n\nåœ¨é“¾æ¥åï¼Œmain çš„åœ°å€å˜æˆ 0x4004adï¼Œé‚£ä¹ˆéœ€è¦é‡å®šä½ç¬¦å·çš„åœ°å€å˜æˆï¼š0x4004ad + 0xa = 0x4004b7ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1637718538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320804,"user_name":"Geek_27eb54","can_delete":false,"product_type":"c1","uid":2715118,"ip_address":"","ucode":"7D1EE10A61C7C0","user_header":"","comment_is_top":false,"comment_ctime":1636515338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5931482634","product_id":100094901,"comment_content":"æµ·çº³è€å¸ˆï¼Œæ‚¨å¥½ï¼Œæˆ‘åœ¨åˆ†æç¨‹åºè£…è½½è¿‡ç¨‹ä¸­æœ‰å‡ ä¸ªç–‘é—®:<br>readelf -l æŸ¥çœ‹ç¨‹åº,æœ‰ä»¥ä¸‹å†…å®¹<br>```<br>TYPE    Offset         VirtAddr          PhysAddr       FileSiz         MemSiz      Flg   Align<br>LOAD   0x000000   0x00000000   0x00000000   0x12272c    0x12272c    R E  0X1000<br>LOAD   0x122814   0x00123814   0x00123814   0x04bdc      0x7210        RW  0x1000<br>...<br>00 .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .plt .plt.got .text .fini.rodata .eh_frame_hdr .eh_frame<br>01 .init_array .fini_array .jcr .data.rel.ro .dynamic .got .got.plt .data .bss<br>```<br>åŠ è½½åˆ°å†…å­˜ä¸­åï¼Œ<br>```<br>7dcef000 -7de12000 r-xp 00000000 08:01 1598491     &#47;lib&#47;i386-linux-gnu&#47;libSDL2-2.0.so.0.4.0<br>7de12000-7de15000 r--p  00122000 08:01 1598491    &#47;lib&#47;i386-linux-gnu&#47;libSDL2-2.0.so.0.4.0<br>7de15000-7de18000 rw-p 00125000 08:01 1598491   &#47;lib&#47;i386-linux-gnu&#47;libSDL2-2.0.so.0.4.0<br>7de18000-7de1a000 rw-p 00000000 00:00 0<br>```<br>q1: readelf -lè¯»å–çš„ä¿¡æ¯ä¸­ï¼Œç¬¬äºŒæ®µä¸­çš„filesizeè·Ÿmemsizeä¸ºä»€ä¹ˆä¸ä¸€æ ·ï¼Ÿldé“¾æ¥å™¨åŠ è½½è¿‡ç¨‹ä¸­ç”³è¯·å†…å­˜åº”è¯¥æŒ‰ç…§å“ªä¸ªå»ç”³è¯·?<br>q2: elfä¸­æ˜¾ç¤ºéœ€è¦åŠ è½½ä¸¤ä¸ªæ®µï¼Œä½†æ˜¯å®é™…ä¸Šæœ‰3æ¬¡æ–‡ä»¶æ˜ å°„ï¼Œå…¶ä¸­ç¬¬ä¸€ç¬¬äºŒæ¬¡æ˜¯å¦å°±æ˜¯elfä¸­åŠ è½½çš„ç¬¬ä¸€ä¸ªæ®µï¼Œä¸ºä»€ä¹ˆä¼šæ˜ å°„ä¸¤æ¬¡ï¼Ÿ<br>q3: ç¬¬3æ¬¡æ–‡ä»¶æ˜ å°„æ˜¯å¦å°±æ˜¯elfä¸­çš„ç¬¬äºŒä¸ªéœ€è¦åŠ è½½çš„æ®µï¼Œè¿™é‡Œæ–‡ä»¶æ˜ å°„çš„å¤§å°æ˜¯0x3000ï¼Œæ˜æ˜¾å°äºelfä¸­æ˜¾ç¤ºçš„éœ€è¦çš„å¤§å°ï¼Œè¿™å—åˆæ˜¯æ€ä¹ˆå›äº‹ï¼Ÿç¬¬4æ¬¡åŒ¿åæ˜ å°„æ˜¯å¦ä¹Ÿæ˜¯åŠ è½½äº†æ–‡ä»¶æ˜ å°„?","like_count":1},{"had_liked":false,"id":346006,"user_name":"åè§†é•œ","can_delete":false,"product_type":"c1","uid":1250406,"ip_address":"","ucode":"0975031017BA02","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/66/70a6a206.jpg","comment_is_top":false,"comment_ctime":1652763731,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652763731","product_id":100094901,"comment_content":"æœ¬æ¥æƒ³é—®æ˜¯ä¸æ˜¯ä¸‹é¢çš„æƒ…å†µä¸éœ€è¦PICäº†ï¼Œåæ¥åœ¨æ·±å…¥ç ”ç©¶å‘ç°äº†ä¸€ä¸‹ï¼Œè€å¸ˆå¸®å¿™çœ‹ä¸‹æ˜¯ä¸æ˜¯ä¸æ˜¯å¯¹çš„ã€‚<br><br>æˆ‘ç†è§£åŠ¨æ€åº“é‡Œé¢å¯èƒ½ä¼šéœ€è¦GOTè¡¨æ¥å¤„ç†ä¾èµ–ã€‚ä½†ä¸€ä¸ªmain.cä¾èµ–äº†ä¸€ä¸ªlibfoo.soï¼Œè€Œlibfoo.soä¸ä¾èµ–ä»»ä½•å…¶ä»–åº“åŠ¨æ€åº“äº†ï¼Œæˆ‘æ‰‹åŠ¨æµ‹è¯•äº†ä¸‹ï¼š<br><br> ```<br> readelf -S main<br> [21] .got              PROGBITS        0804bffc 002ffc 000004 04  WA  0   0  4<br>  [22] .got.plt          PROGBITS        0804c000 003000 000014 04  WA  0   0  4<br>  [23] .data             PROGBITS        0804c014 003014 00000c 00  WA  0   0  4<br>   [24] .bss              NOBITS          0804c020 003020 000008 00  WA  0   0  4<br>```<br>```<br> objdump  -d .&#47;main | grep &quot;&lt;main&gt;&quot; -A 15<br><br> 8049173:       a1 1c c0 04 08          mov    0x804c01c,%eax<br> 8049178:       89 45 f4                mov    %eax,-0xc(%ebp)<br> 804917b:       a1 20 c0 04 08          mov    0x804c020,%eax ; my_var å¤–éƒ¨å˜é‡<br> 8049180:       89 45 f0                mov    %eax,-0x10(%ebp)<br>```<br>```<br>objdump -s -d main<br>Contents of section .got:<br> 804bffc 00000000                             ....<br>Contents of section .data:<br> 804c014 00000000 00000000 0a000000           ............<br>Contents of section .comment:<br> 0000 4743433a 20284465 6269616e 20382e33  GCC: (Debian 8.3<br> 0010 2e302d36 2920382e 332e3000           .0-6) 8.3.0.<br>```<br><br>```<br>readelf -r main<br>Relocation section &#39;.rel.dyn&#39; at offset 0x300 contains 2 entries:<br> Offset     Info    Type            Sym.Value  Sym. Name<br>0804bffc  00000206 R_386_GLOB_DAT    00000000   __gmon_start__<br>0804c020  00000405 R_386_COPY        0804c020   my_var<br>```<br>mainç¨‹åºç¼–è¯‘åï¼Œæˆ‘è™½ç„¶ç”¨readelf -S mainçœ‹åˆ°.gotï¼Œä½†å¼•ç”¨åŠ¨æ€åº“çš„å˜é‡my_varæˆ‘çœ‹åˆ°åœ°å€è¿˜æ˜¯è½åœ¨.bssæ®µæŸ¥æ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°è¯´æ˜¯åœ¨é“¾æ¥çš„æ—¶å€™ä¼šä»å…±äº«åº“å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å·²åˆ†é…ç©ºé—´ã€‚<br><br>&gt;å°†åœ¨åŠ¨æ€å¯æ‰§è¡Œæ–‡ä»¶çš„ .bss ä¸­åˆ†é…ç©ºé—´ï¼Œç©ºé—´çš„å¤§å°ç­‰äºå…±äº«åº“ä¸­çš„æ•°æ®é¡¹çš„å¤§å°ã€‚è¿˜ä¸ºæ­¤ç©ºé—´æŒ‡å®šåœ¨å…±äº«åº“ä¸­å®šä¹‰çš„ç¬¦å·åç§°ã€‚åˆ†é…æ­¤æ•°æ®æ—¶ï¼Œé“¾æ¥ç¼–è¾‘å™¨ä¼šç”Ÿæˆç‰¹æ®Šçš„å¤åˆ¶é‡å®šä½è®°å½•ï¼ŒæŒ‡ç¤ºè¿è¡Œæ—¶é“¾æ¥ç¨‹åºå°†æ•°æ®ä»å…±äº«åº“å¤åˆ¶åˆ°åŠ¨æ€å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å·²åˆ†é…ç©ºé—´ã€‚<br><br>","like_count":0},{"had_liked":false,"id":331900,"user_name":"Geek_Lawrence","can_delete":false,"product_type":"c1","uid":1578549,"ip_address":"","ucode":"B4EF5B124AF082","user_header":"","comment_is_top":false,"comment_ctime":1642859631,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642859631","product_id":100094901,"comment_content":"è¯·é—®æœºå™¨ç æ˜¯å¦‚ä½•é©±åŠ¨cpuå†…å­˜ç­‰ç¡¬ä»¶æ‰§è¡Œçš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2839104,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/52/40/1fe5be2b.jpg","nickname":"è”é€š","note":"","ucode":"EAA1331CFAFDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551357,"discussion_content":"ä¸æ˜¯æœºå™¨ç é©±åŠ¨cpuç­‰ç¡¬ä»¶ï¼Œæ˜¯cpuä¸­çš„æœ‰ä¸ªpcæŒ‡é’ˆè¯»å–æœºå™¨ç ä¸­çš„æŒ‡ä»¤æ‰§è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644996649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327024,"user_name":"i Love 3ğŸ€","can_delete":false,"product_type":"c1","uid":2336991,"ip_address":"","ucode":"3AC31D3B2BA6FE","user_header":"https://static001.geekbang.org/account/avatar/00/23/a8/df/f3eaf89e.jpg","comment_is_top":false,"comment_ctime":1639843349,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1639843349","product_id":100094901,"comment_content":"â€œP æ˜¯é‡å®šä½ offset çš„åœ°å€ï¼Œè¿™é‡Œæ˜¯ 0x4004b7ã€‚â€ï¼Œé—®ä¸€ä¸‹0x4004b7è¿™ä¸ªåœ°å€æ˜¯å“ªé‡Œå¾—å‡ºæ¥çš„ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":2419502,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","nickname":"æŸ’","note":"","ucode":"D41241629321A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547179,"discussion_content":"Pæ˜¯è¿™ä¸ªå˜é‡/å‡½æ•°çš„offeståœ°å€ï¼Œä½ çœ‹é‚£æ®µä»£ç ï¼Œå°±æ˜¯åœ¨0x4004b5ï¼Œæ‰€ä»¥å˜é‡å°±æ˜¯åœ¨0x4004b7äº†ã€‚opcodeå äº†ä¸¤ä¸ªå­—èŠ‚ï¼Œæ“ä½œæ•°ï¼ˆå³å˜é‡ï¼‰å ç”¨åé¢4ä¸ªå­—èŠ‚ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1642570179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325446,"user_name":"å–µå‰è±†è±†","can_delete":false,"product_type":"c1","uid":1144651,"ip_address":"","ucode":"1F3322FF5EDF58","user_header":"https://static001.geekbang.org/account/avatar/00/11/77/4b/ede8aa13.jpg","comment_is_top":false,"comment_ctime":1638958945,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1638958945","product_id":100094901,"comment_content":"åŒä¸€ä¸ªæ–‡ä»¶å†…çš„å‡½æ•°ä¹‹é—´çš„ä½ç½®å…³ç³»åœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šæ”¹å˜å—ï¼Ÿå¦‚æœä¸å˜ï¼Œè¿™æ ·ä¹‹é—´çš„å‡½æ•°è°ƒç”¨ä¸ºä»€ä¹ˆä¸å¯ä»¥åƒé™æ€å‡½æ•°ä¸€æ ·å¤„ç†å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2419502,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/2e/90fea784.jpg","nickname":"æŸ’","note":"","ucode":"D41241629321A1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540779,"discussion_content":"å®ƒè¢«å…¶ä»–æ–‡ä»¶çš„å‡½æ•°å¼•ç”¨çš„æ—¶å€™ï¼Œä»–ä»¬ä¹‹é—´å°±ä¸èƒ½ç”¨ç›¸å¯¹ä½ç½®äº†å‘€ï¼Œéƒ½å±äºä¸¤ä¸ªä¸åŒçš„.oæ–‡ä»¶äº†ï¼Œé¬¼çŸ¥é“ä»–ä»¬çš„textæ®µåˆå¹¶çš„å…ˆåé¡ºåºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640165478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1235551,"avatar":"https://static001.geekbang.org/account/avatar/00/12/da/5f/3c68103d.jpg","nickname":"éƒ­æ¢“è‰¯","note":"","ucode":"50E57E6A723E14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538239,"discussion_content":"é™æ€å‡½æ•°åªèƒ½åœ¨æœ¬æ–‡ä»¶è¢«è°ƒç”¨ï¼Œè€Œå…¶ä»–å‡½æ•°æœ‰å¯èƒ½è¢«å…¶ä»–æ–‡ä»¶è°ƒç”¨ï¼Œæ„Ÿè§‰æ˜¯è¿™ä¸ªåŸå› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639378481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324742,"user_name":"å°æ—¶å€™å¯é²œå•¦","can_delete":false,"product_type":"c1","uid":1050777,"ip_address":"","ucode":"C88B3EDF758230","user_header":"https://static001.geekbang.org/account/avatar/00/10/08/99/6ab45a2f.jpg","comment_is_top":false,"comment_ctime":1638599843,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1638599843","product_id":100094901,"comment_content":"å¯¹äºé™æ€å˜é‡çš„Så€¼ï¼ˆæœ€ç»ˆåœ°å€ï¼‰å¾—è·å–æœ‰ç–‘é—®ï¼š<br>static_var çš„æœ€ç»ˆåœ°å€å°±æ˜¯æœ¬ç¼–è¯‘å•å…ƒçš„.data æ®µçš„æœ€ç»ˆåœ°å€ã€‚<br>åœ¨æœ¬åœ°çš„æµ‹è¯•ä¸­ readelf -S a.outè·å¾—çš„.dataçš„åœ°å€ä¸º0x601018ï¼Œè€Œç”¨objdump -S a.outè·å¾—çš„åæ±‡ç¼–ä¸­å¯ä»¥çœ‹åˆ°static_varå¯¹åº”çš„çœŸå®åœ°å€å€¼ä¸º0x601030ï¼Œä¸¤è€…ä¸ä¸€è‡´ã€‚","like_count":0,"discussions":[{"author":{"id":1959822,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","nickname":"Spoon","note":"","ucode":"2FF9193AD482C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590705,"discussion_content":"æˆ‘ä¹Ÿå‘ç°äº†è¿™ä¸ªé—®é¢˜ã€‚ã€‚ã€‚ã€‚å¯ä»¥äº¤æµä¸€ä¸‹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666018618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324379,"user_name":"ITå°åƒ§","can_delete":false,"product_type":"c1","uid":1036906,"ip_address":"","ucode":"4DC9B291AAD748","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d2/6a/a9039139.jpg","comment_is_top":false,"comment_ctime":1638409323,"is_pvip":true,"replies":[{"id":"117799","content":"ä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯ä¸ºäº†è®©æ ˆå¸§å¯¹é½ï¼Œæœ‰åˆ©äºåŠ é€Ÿè®¿å­˜é€Ÿåº¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1638537809,"ip_address":"","comment_id":324379,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638409323","product_id":100094901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªè·‘é¢˜çš„é—®é¢˜ï¼Œä¸Šé¢mainå‡½æ•°æœ‰6ä¸ªæ•´å½¢å˜é‡ï¼Œå…±éœ€24å­—èŠ‚å†…å­˜ï¼Œä¸ºå•¥ç¼–è¯‘å™¨ä¼šé¢„åˆ†é…å†…å­˜ç©ºé—´sub    $0x20,%rspï¼Œåˆ†é…äº†32å­—èŠ‚å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535767,"discussion_content":"ä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯ä¸ºäº†è®©æ ˆå¸§å¯¹é½ï¼Œæœ‰åˆ©äºåŠ é€Ÿè®¿å­˜é€Ÿåº¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638537809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322633,"user_name":"å§‘å°„ä»™äºº","can_delete":false,"product_type":"c1","uid":1008517,"ip_address":"","ucode":"3EFC1F3E592165","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/85/1dc41622.jpg","comment_is_top":false,"comment_ctime":1637506896,"is_pvip":false,"replies":[{"id":"117270","content":"javaä¹Ÿæœ‰ç¬¦å·è§£æçš„è¿‡ç¨‹ã€‚åŸºæœ¬åŸç†å’Œç¬¬8è¯¾é‡Œè¯´çš„è¿è¡Œæ—¶è§£ææ¯”è¾ƒç›¸ä¼¼ã€‚ç¬¦å·çš„åœ°å€éƒ½æ˜¯è¿è¡Œæ—¶å¾—åˆ°çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637733559,"ip_address":"","comment_id":322633,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637506896","product_id":100094901,"comment_content":"Javaè¯­è¨€çš„ç¼–è¯‘å’Œé“¾æ¥å’Œè¿™ä¸ªä¸ä¸€æ ·å§ï¼Œè¿˜æœ‰JVMé‡Œåº”è¯¥æ²¡æœ‰è™šæ‹Ÿå†…å­˜çš„æ¦‚å¿µï¼Œå¤§å®¶éƒ½åœ¨ä¸€ä¸ªå†…å­˜ç©ºé—´å†…ã€‚é‚£äº›å­—å˜é‡çš„åœ°å€ä»€ä¹ˆçš„ï¼Œæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ç¡®å®šçš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532923,"discussion_content":"javaä¹Ÿæœ‰ç¬¦å·è§£æçš„è¿‡ç¨‹ã€‚åŸºæœ¬åŸç†å’Œç¬¬8è¯¾é‡Œè¯´çš„è¿è¡Œæ—¶è§£ææ¯”è¾ƒç›¸ä¼¼ã€‚ç¬¦å·çš„åœ°å€éƒ½æ˜¯è¿è¡Œæ—¶å¾—åˆ°çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637733559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322236,"user_name":"LDxy","can_delete":false,"product_type":"c1","uid":1188710,"ip_address":"","ucode":"956432CE7B7761","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/66/413c0bb5.jpg","comment_is_top":false,"comment_ctime":1637251602,"is_pvip":false,"replies":[{"id":"117043","content":"ä¸å¦‚è‡ªå·±åŠ¨æ‰‹è¯•ä¸€ä¸‹ï¼Ÿä½ å¯ä»¥é€šè¿‡catå‘½ä»¤ï¼ŒæŸ¥çœ‹&amp;#47;proc&amp;#47;pid&amp;#47;mapå’Œ&amp;#47;proc&amp;#47;pid&amp;#47;smapæ–‡ä»¶ï¼Œçœ‹çœ‹ä»–ä»¬çš„å„ä¸ªå­—æ®µçš„ä½œç”¨ã€‚å®ƒçš„ä¿¡æ¯æ˜¯éå¸¸å…¨é¢çš„ï¼Œæˆ‘è¿™é‡Œæ— æ³•ä¸€ä¸€åˆ—ä¸¾ã€‚ä½ å¯ä»¥é€šè¿‡manå‘½ä»¤è¿›è¡Œå­¦ä¹ ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637325462,"ip_address":"","comment_id":322236,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637251602","product_id":100094901,"comment_content":"æˆ‘ç»å¸¸å¬äººè¯´è¦æŸ¥çœ‹ä¸€ä¸‹mapæ–‡ä»¶ï¼Œè¯·é—®è€å¸ˆmapæ–‡ä»¶æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼ŸæŸ¥çœ‹mapæ–‡ä»¶èƒ½çœ‹å‡ºä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531499,"discussion_content":"ä¸å¦‚è‡ªå·±åŠ¨æ‰‹è¯•ä¸€ä¸‹ï¼Ÿä½ å¯ä»¥é€šè¿‡catå‘½ä»¤ï¼ŒæŸ¥çœ‹&amp;#47;proc&amp;#47;pid&amp;#47;mapå’Œ&amp;#47;proc&amp;#47;pid&amp;#47;smapæ–‡ä»¶ï¼Œçœ‹çœ‹ä»–ä»¬çš„å„ä¸ªå­—æ®µçš„ä½œç”¨ã€‚å®ƒçš„ä¿¡æ¯æ˜¯éå¸¸å…¨é¢çš„ï¼Œæˆ‘è¿™é‡Œæ— æ³•ä¸€ä¸€åˆ—ä¸¾ã€‚ä½ å¯ä»¥é€šè¿‡manå‘½ä»¤è¿›è¡Œå­¦ä¹ ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637325462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322199,"user_name":"æˆ‘æ˜¯å†…å­˜","can_delete":false,"product_type":"c1","uid":1711838,"ip_address":"","ucode":"3D763D4F434D50","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1e/de/cdee1780.jpg","comment_is_top":false,"comment_ctime":1637230153,"is_pvip":false,"replies":[{"id":"117014","content":"ä½ è¯´çš„å±€éƒ¨å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿé—®é¢˜åœ¨äºä½ ä¸åŠ staticçš„è¯ï¼ŒCçš„ç¼–è¯‘å™¨åªèƒ½æŠŠå®ƒå½“åšå…¨å±€å‡½æ•°å¤„ç†ã€‚æ‰€ä»¥æˆ‘ä»¬è¯´çš„å±€éƒ¨å‡½æ•°æ—¶ï¼Œå°±æ˜¯æŒ‡staticå‡½æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637290991,"ip_address":"","comment_id":322199,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1637230153","product_id":100094901,"comment_content":"å±€éƒ¨å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å¯¼å‡ºç»™å…¶ä»–ç¼–è¯‘å•å…ƒä½¿ç”¨çš„é‚£äº›å¸¸è§„å‡½æ•°ï¼Œå’Œé™æ€å‡½æ•°ä¸€æ ·ï¼Œå®ƒä»¬éƒ½åœ¨æœ¬ç¼–è¯‘å•å…ƒçš„.textæ®µå†…ï¼Œé“¾æ¥çš„æ—¶å€™ä¹Ÿæ˜¯æ•´ä½“æŠŠæœ¬ç¼–è¯‘å•å…ƒçš„.textå’Œå…¶ä»–ç¼–è¯‘å•å…ƒçš„.textåˆå¹¶ï¼Œä¹Ÿä¸éœ€è¦é‡å®šä½å§?","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531349,"discussion_content":"ä½ è¯´çš„å±€éƒ¨å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿé—®é¢˜åœ¨äºä½ ä¸åŠ staticçš„è¯ï¼ŒCçš„ç¼–è¯‘å™¨åªèƒ½æŠŠå®ƒå½“åšå…¨å±€å‡½æ•°å¤„ç†ã€‚æ‰€ä»¥æˆ‘ä»¬è¯´çš„å±€éƒ¨å‡½æ•°æ—¶ï¼Œå°±æ˜¯æŒ‡staticå‡½æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637290991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1711838,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/1e/de/cdee1780.jpg","nickname":"æˆ‘æ˜¯å†…å­˜","note":"","ucode":"3D763D4F434D50","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":531352,"discussion_content":"å—¯ï¼Œåæ¥æƒ³æƒ³å¥½åƒæ²¡æœ‰å±€éƒ¨å‡½æ•°è¿™ç§è¯´æ³•ã€‚å½“æ—¶è‰ç‡çš„æŒ‰ç…§å…¨å±€å‡½æ•°å…¨å±€å˜é‡ï¼Œå¤–éƒ¨å‡½æ•°å¤–éƒ¨å˜é‡ï¼Œé™æ€å‡½æ•°é™æ€å˜é‡ï¼Œå±€éƒ¨å˜é‡å’Œå±€éƒ¨å‡½æ•°æ¥æ’åˆ—çš„ã€‚ç¡¬ç”Ÿç”Ÿæ’æ¯”çš„é€ å‡ºäº†ä¸€ä¸ªå±€éƒ¨å‡½æ•°â€¦.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637291344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":531349,"ip_address":""},"score":531352,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":321222,"user_name":"éµ¼","can_delete":false,"product_type":"c1","uid":1101766,"ip_address":"","ucode":"F6561743835F7E","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/c6/6a2d0a5e.jpg","comment_is_top":false,"comment_ctime":1636713508,"is_pvip":false,"replies":[{"id":"117075","content":"æ˜¯çš„ã€‚å…¨å±€å˜é‡åœ¨dataæ®µï¼Œåœ¨ç£ç›˜æ–‡ä»¶ä¸­å°±èƒ½çœ‹åˆ°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1360512","ctime":1637375506,"ip_address":"","comment_id":321222,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636713508","product_id":100094901,"comment_content":" readelf -S example.o<br><br>[ 3] .data             PROGBITS         0000000000000000  000000c0<br>       0000000000000008  0000000000000000  WA       0     0     4<br><br>od -Ax -t x1 -j  192 -N 8 example.o<br>0000c0 01 00 00 00 02 00 00 00<br><br>è¿™æ˜¯ä¸æ˜¯å°±æ˜¯å€¼åˆå§‹åŒ–åœ¨ç¼–è¯‘çš„ä½è¯ã€‚<br>","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531655,"discussion_content":"æ˜¯çš„ã€‚å…¨å±€å˜é‡åœ¨dataæ®µï¼Œåœ¨ç£ç›˜æ–‡ä»¶ä¸­å°±èƒ½çœ‹åˆ°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637375506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320625,"user_name":"éƒ‘ç«¥æ–‡","can_delete":false,"product_type":"c1","uid":1030733,"ip_address":"","ucode":"3D193715CB8549","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/4d/7ba09ff0.jpg","comment_is_top":false,"comment_ctime":1636426959,"is_pvip":false,"replies":[{"id":"116322","content":"ä¸æ˜¯ã€‚ä»£ç æ®µå’Œæ•°æ®æ®µæ˜¯å¯ä»¥ç¡®å®šåœ°å€çš„ã€‚æ ˆå’Œå †æ˜¯è¿è¡Œæ—¶ï¼Œåº”ç”¨ç¨‹åºå‘æ“ä½œç³»ç»Ÿç”³è¯·æ¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636507778,"ip_address":"","comment_id":320625,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1636426959","product_id":100094901,"comment_content":"è¯·é—®è€å¸ˆï¼Œå †å’Œæ ˆåœ¨è™šæ‹Ÿå†…å­˜çš„ä¸­çš„èµ·å§‹åœ°å€ï¼ˆè™šæ‹Ÿåœ°å€ï¼‰æ˜¯åœ¨ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶æ—¶å°±ç¡®å®šäº†çš„å—ï¼Ÿ æ˜¯ä¿å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„å—ï¼Ÿ è°¢è°¢ï¼","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530067,"discussion_content":"ä¸æ˜¯ã€‚ä»£ç æ®µå’Œæ•°æ®æ®µæ˜¯å¯ä»¥ç¡®å®šåœ°å€çš„ã€‚æ ˆå’Œå †æ˜¯è¿è¡Œæ—¶ï¼Œåº”ç”¨ç¨‹åºå‘æ“ä½œç³»ç»Ÿç”³è¯·æ¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636507778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1030733,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ba/4d/7ba09ff0.jpg","nickname":"éƒ‘ç«¥æ–‡","note":"","ucode":"3D193715CB8549","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413518,"discussion_content":"è°¢è°¢è€å¸ˆçš„å›ç­”ï¼Œæˆ‘çš„æ„æ€æ˜¯æ ˆå’Œå †åŒºåŸŸåœ¨è™šæ‹Ÿå†…å­˜å¸ƒå±€çš„èµ·å§‹è™šæ‹Ÿåœ°å€ï¼ˆä¹Ÿå°±æ˜¯å®ƒä»¬çš„èµ·å§‹è¾¹ç•Œï¼‰æ˜¯å¦‚ä½•ç¡®å®šçš„ï¼Ÿ ä¼šä¿å­˜åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­å—ï¼Ÿ è°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636508106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320584,"user_name":"Benjamin","can_delete":false,"product_type":"c1","uid":1940162,"ip_address":"","ucode":"C661E5358FE764","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9a/c2/8fcd5a2d.jpg","comment_is_top":false,"comment_ctime":1636386546,"is_pvip":false,"replies":[{"id":"116327","content":"sorryã€‚å›¾ç‰‡æœ‰è¯¯ï¼Œå¤šè°¢æŒ‡å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636508265,"ip_address":"","comment_id":320584,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636386546","product_id":100094901,"comment_content":"æˆ‘æ„Ÿè§‰åœ¨â€é™æ€å˜é‡â€œé‚£ä¸€éƒ¨åˆ†çš„æ’å›¾æœ‰é—®é¢˜ï¼š<br>1ï¼‰127: mov 0x127(%rip), %eax # è¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªè´Ÿå‘çš„åœ°å€åç§»ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯-0x127<br>2ï¼‰æ­¤æ—¶ripå¯„å­˜å™¨æŒ‡å‘çš„æ˜¯movæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå‡è®¾å½“å‰movæŒ‡ä»¤(åŒ…æ‹¬æ“ä½œæ•°)å¤§å°5byteï¼Œé‚£ä¹ˆæ­£ç¡®çš„æ±‡ç¼–æŒ‡ä»¤æ˜¯ï¼š227ï¼šmov -0x12c(%rip), %eax","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530055,"discussion_content":"sorryã€‚å›¾ç‰‡æœ‰è¯¯ï¼Œå¤šè°¢æŒ‡å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636508265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320548,"user_name":"kylin","can_delete":false,"product_type":"c1","uid":1351248,"ip_address":"","ucode":"3588B62A4F9534","user_header":"https://static001.geekbang.org/account/avatar/00/14/9e/50/21e0beca.jpg","comment_is_top":false,"comment_ctime":1636375343,"is_pvip":true,"replies":[{"id":"116329","content":"è¿™é‡Œè¦è®°ä½çš„æ˜¯é‡å®šä½è¡¨çš„ä½œç”¨æ˜¯æè¿°â€œéœ€è¦è¢«é‡å®šä½â€çš„ä½ç½®ã€‚æ‰€ä»¥å®ƒæè¿°çš„æ˜¯â€œå¼•ç”¨â€ç¬¦å·çš„åœ°æ–¹ï¼Œä¸æ˜¯ç¬¦å·æ‰€åœ¨çš„ä½ç½®ã€‚ä½ å¯ä»¥è¯•è¯•å£°æ˜ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œåˆå§‹åŒ–æ—¶ç»™ä»–ä¸€ä¸ªå¤–éƒ¨å˜é‡çš„åœ°å€ã€‚ä¸€å®šè¦è®°ä½ï¼Œé‡å®šä½è¡¨æè¿°çš„æ˜¯â€œå¼•ç”¨è€…â€ï¼Œä¸æ˜¯è¢«å¼•ç”¨è€…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æµ·çº³","uid":"1360512","ctime":1636509025,"ip_address":"","comment_id":320548,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636375343","product_id":100094901,"comment_content":"ä¸€èˆ¬æ¥è¯´ï¼Œé‡å®šä½è¡¨çš„åå­—éƒ½æ˜¯ä»¥.rela å¼€å¤´ï¼Œæ¯”å¦‚.rela.text å°±æ˜¯å¯¹.text æ®µçš„é‡å®šä½è¡¨ï¼Œ.rela.data æ˜¯å¯¹.data æ®µçš„é‡å®šä½è¡¨ã€‚å› ä¸ºæˆ‘ä»¬çš„ä¾‹å­ä¸­å¹¶æ²¡æœ‰æ¶‰åŠ.data æ®µçš„é‡å®šä½ï¼Œæ‰€ä»¥ï¼Œåœ¨ä¸Šé¢æ‰“å°çš„ä¿¡æ¯ä¸­æ²¡æœ‰å‡ºç°.rela.data æ®µã€‚<br>---<br>è¯·é—®ä¸Šé¢ä»£ç çš„ extern_varä¸ºå•¥ä¸åœ¨rela.dataä¸­ï¼Œè€Œæ˜¯åœ¨rela.texté‡Œé¢å‘¢ï¼Ÿé™æ€å˜é‡ä¸æ˜¯åº”è¯¥åœ¨rela.dataä¸­å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1360512,"avatar":"https://static001.geekbang.org/account/avatar/00/14/c2/80/6ebf32e8.jpg","nickname":"æµ·çº³","note":"","ucode":"AB9F7ADB1428D2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530040,"discussion_content":"è¿™é‡Œè¦è®°ä½çš„æ˜¯é‡å®šä½è¡¨çš„ä½œç”¨æ˜¯æè¿°â€œéœ€è¦è¢«é‡å®šä½â€çš„ä½ç½®ã€‚æ‰€ä»¥å®ƒæè¿°çš„æ˜¯â€œå¼•ç”¨â€ç¬¦å·çš„åœ°æ–¹ï¼Œä¸æ˜¯ç¬¦å·æ‰€åœ¨çš„ä½ç½®ã€‚ä½ å¯ä»¥è¯•è¯•å£°æ˜ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œåˆå§‹åŒ–æ—¶ç»™ä»–ä¸€ä¸ªå¤–éƒ¨å˜é‡çš„åœ°å€ã€‚ä¸€å®šè¦è®°ä½ï¼Œé‡å®šä½è¡¨æè¿°çš„æ˜¯â€œå¼•ç”¨è€…â€ï¼Œä¸æ˜¯è¢«å¼•ç”¨è€…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636509025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320231,"user_name":"kylin","can_delete":false,"product_type":"c1","uid":1351248,"ip_address":"","ucode":"3588B62A4F9534","user_header":"https://static001.geekbang.org/account/avatar/00/14/9e/50/21e0beca.jpg","comment_is_top":false,"comment_ctime":1636165639,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1636165639","product_id":100094901,"comment_content":"å¤§ç«¯å’Œå°ç«¯éƒ½æ˜¯ä»å†…å­˜çš„ä½åœ°å€å‘é«˜åœ°å€é¡ºåºå†™å…¥å¤§ç«¯ å…ˆå†™å­—é¢å€¼é«˜ä½å°ç«¯ å…ˆå†™å­—é¢å€¼ä½ä½ä¾‹å¦‚ï¼š0x ff ff ff aeå¤§ç«¯ ä»ä½åœ°å€åˆ°é«˜åœ°å€å†™å…¥é¡ºåºä¸ºï¼šff ff ff aeå°ç«¯ ä»ä½åœ°å€åˆ°é«˜åœ°å€å†™å…¥é¡ºåºä¸ºï¼šae ff ff ff","like_count":0}]}