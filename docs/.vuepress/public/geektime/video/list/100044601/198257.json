{"id":198257,"title":"25 | 路由与终结点：如何规划好你的Web API","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/NET-Core\">https://gitee.com/geektime-geekbang/NET-Core</a></p>","comments":[{"had_liked":false,"id":226343,"user_name":"小喵喵","can_delete":false,"product_type":"c3","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1592042031,"is_pvip":false,"replies":[{"id":86008,"content":"这里主要是为了介绍约束功能，如你所说，一般建议参数放到body中，用错误码表示验证结果","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1594222971,"ip_address":"","comment_id":226343,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"请教下老师，关于约束的问题。\n比如max，required，如果输入超过max或者为空，路由匹配失败，第三方调用者觉得很奇怪，这样很不友好吧。我更加倾向于代码逻辑返回错误码和描述告诉调用者，不知道老师是如何看待这个问题的。","like_count":2,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498204,"discussion_content":"这里主要是为了介绍约束功能，如你所说，一般建议参数放到body中，用错误码表示验证结果","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594222971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218142,"user_name":"张志炜","can_delete":false,"product_type":"c3","uid":1221549,"ip_address":"","ucode":"31643B345C5B27","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/ad/79b26eea.jpg","comment_is_top":false,"comment_ctime":1589723666,"is_pvip":false,"replies":[{"id":81340,"content":"你看一下告警的类型，在项目的属性-&gt;生成-&gt;错误和告警 \n 面板，有一项“取消显示告警”，可以屏蔽信息","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1590236245,"ip_address":"","comment_id":218142,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，我第一次输出，提示找不到XML。\n然后我在项目属性中，设置了输出XML文档文件\n然后一些没有注释的public方法出现了波浪线提示，要我补充文档。。\n我想知道，有没有办法既可以输出xml，又不会有文档补充提示的办法？\n那些接口注释，需要的时候就写，不需要的我就不用写，也不要提醒？","like_count":2,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495360,"discussion_content":"你看一下告警的类型，在项目的属性-&amp;gt;生成-&amp;gt;错误和告警 \n 面板，有一项“取消显示告警”，可以屏蔽信息","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590236245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210029,"user_name":"墨墨墨墨小宇","can_delete":false,"product_type":"c3","uid":1590707,"ip_address":"","ucode":"4C17920448C285","user_header":"https://static001.geekbang.org/account/avatar/00/18/45/b3/c21b2d2c.jpg","comment_is_top":false,"comment_ctime":1587654095,"is_pvip":false,"replies":[{"id":80620,"content":"“把它置于产线这样的一个资源下面”是在定义“产线”与“治具”的关系，你的场景对不同“治具”不同的校验需要专门设计实现。\n看起来这部分业务是经常变动的，需要设计为扩展点","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1589688052,"ip_address":"","comment_id":210029,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，问个接口设计方面的问题，我们是一家制造业公司，生产中经常会换线，因为每条线使用的治具不同，在换线后需要对这些治具进行一个校验，对于这样的一个行为，在设计时，是不是应该把它置于产线这样的一个资源下面","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492919,"discussion_content":"“把它置于产线这样的一个资源下面”是在定义“产线”与“治具”的关系，你的场景对不同“治具”不同的校验需要专门设计实现。\n看起来这部分业务是经常变动的，需要设计为扩展点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589688052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204192,"user_name":"小爷我","can_delete":false,"product_type":"c3","uid":1152139,"ip_address":"","ucode":"1478E56B480B7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/94/8b/2d56f150.jpg","comment_is_top":false,"comment_ctime":1586349162,"is_pvip":false,"replies":[{"id":77424,"content":"建议使用RouteAttribute，一方面API定义灵活且明确，一方面对swagger友好。","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1587041271,"ip_address":"","comment_id":204192,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，.net core3.x之后，API是必须要在controllers里写属性路由么，可不可以在startup统一配置，controllers里不写？项目里采用的路由格式统一是api&#47;controller&#47;action","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491098,"discussion_content":"建议使用RouteAttribute，一方面API定义灵活且明确，一方面对swagger友好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587041271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180898,"user_name":"stg609","can_delete":false,"product_type":"c3","uid":1073025,"ip_address":"","ucode":"FB70A75A891BB8","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg","comment_is_top":false,"comment_ctime":1582439212,"is_pvip":false,"replies":[{"id":70281,"content":"后面会有章节专门讲这个场景","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1582521686,"ip_address":"","comment_id":180898,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"LinkGenerator 遇到反向代理 能不能正确解析出 url","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484838,"discussion_content":"后面会有章节专门讲这个场景","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582521686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":200856,"discussion_content":"这个应该尽量使用path开头的方法，少用uri开头的方法吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583730155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179448,"user_name":"多读书","can_delete":false,"product_type":"c3","uid":1151239,"ip_address":"","ucode":"A0F87F106C5BED","user_header":"https://static001.geekbang.org/account/avatar/00/11/91/07/f270f35f.jpg","comment_is_top":false,"comment_ctime":1582007532,"is_pvip":false,"replies":[{"id":70474,"content":"services.AddControllers()\n                .AddNewtonsoftJson(options =&gt;\n                {\n                    options.SerializerSettings.DateFormatString = &quot;yyyy-MM-dd HH:mm:ss&quot;;\n                });","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1582697026,"ip_address":"","comment_id":179448,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"有个问题，老师。webapi输出的时间带T，怎么解决","like_count":1,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484261,"discussion_content":"services.AddControllers()\n                .AddNewtonsoftJson(options =&amp;gt;\n                {\n                    options.SerializerSettings.DateFormatString = &amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;;\n                });","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582697026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1151239,"avatar":"https://static001.geekbang.org/account/avatar/00/11/91/07/f270f35f.jpg","nickname":"多读书","note":"","ucode":"A0F87F106C5BED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":186598,"discussion_content":"这种需要引入那个newtonsoftjson那个包，原生那种应该怎么搞\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582697150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1151239,"avatar":"https://static001.geekbang.org/account/avatar/00/11/91/07/f270f35f.jpg","nickname":"多读书","note":"","ucode":"A0F87F106C5BED","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":200860,"discussion_content":"原生的那就将时间转成字符串格式，format就是&#34;yyyy-MM-dd HH:mm:ss&#34;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583730290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":186598,"ip_address":"","group_id":0},"score":200860,"extra":""}]}]},{"had_liked":false,"id":217340,"user_name":"我有我的骄傲","can_delete":false,"product_type":"c3","uid":1808827,"ip_address":"","ucode":"6A073CB1B9A2FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/v3t9q3zFGqiauh5IichnyDWcnTLDS2ArKHDkhG62cYdAavlGKZEVPd2iatPFt1HZrEIRLFf7ueZDMmW01eaQEd0wA/132","comment_is_top":false,"comment_ctime":1589466913,"is_pvip":false,"replies":[{"id":80572,"content":"感谢支持","user_name":"作者回复","user_name_real":"肖伟宇","uid":1756585,"ctime":1589681825,"ip_address":"","comment_id":217340,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，加油，你是知识的传播者，学到了很多","like_count":0,"discussions":[{"author":{"id":1756585,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/cd/a9/791d0f5e.jpg","nickname":"老肖想当外语大佬","note":"","ucode":"F662D1BF671E92","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495114,"discussion_content":"感谢支持","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589681825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221671,"user_name":"王亚","can_delete":false,"product_type":"c3","uid":1810841,"ip_address":"","ucode":"765CDC2A4DF8CF","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a1/99/137f5ff7.jpg","comment_is_top":false,"comment_ctime":1590562777,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师： IRouteConstraint 这个路由自定义器    貌似只能针对webapi 方法的 单个参数设置   如果请求的参数在两个或以上   就没法判断了","like_count":1},{"had_liked":false,"id":218149,"user_name":"张志炜","can_delete":false,"product_type":"c3","uid":1221549,"ip_address":"","ucode":"31643B345C5B27","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/ad/79b26eea.jpg","comment_is_top":false,"comment_ctime":1589724633,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100044601,"comment_content":"老师，我Get接口上，有没有[FromRoute]，都可以正常接收参数，那么这个加与不加有什么区别么。","like_count":1}]}