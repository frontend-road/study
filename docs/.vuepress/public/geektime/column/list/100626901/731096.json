{"id":731096,"title":"20ï½œç”Ÿå‘½å‘¨æœŸï¼šRustå¦‚ä½•åšåŸºæœ¬çš„ç”Ÿå‘½å‘¨æœŸç¬¦å·æ ‡æ³¨ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeï¼Œä»Šå¤©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹Rustä¸­çš„ç”Ÿå‘½å‘¨æœŸåˆ°åº•æ˜¯ä»€ä¹ˆã€‚</p><p>ä½ å¯èƒ½åœ¨äº’è”ç½‘ä¸Šçš„å„ç§èµ„æ–™é‡Œæ—©å°±è§åˆ°è¿‡è¿™ä¸ªæ¦‚å¿µäº†ï¼Œç”Ÿå‘½å‘¨æœŸå¯ä»¥è¯´æ˜¯Rustè¯­è¨€é‡Œæœ€éš¾ç†è§£çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å¯¼è‡´å‡ ä¹æ‰€æœ‰äººéƒ½è§‰å¾—Rustå¾ˆéš¾ï¼Œç”šè‡³å¾ˆä¸‘çš„åŸå› ã€‚å…¶å®å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œè‡³å°‘åœ¨å¼€å§‹çš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸æ˜¯å¿…é¡»æŒæ¡çš„ï¼Œç½‘ä¸Šå¤§é‡çš„èµ„æ–™å¹¶æ²¡æœ‰æŒ‡æ˜è¿™ä¸€ç‚¹ï¼Œæ›´åŠ æ²¡æœ‰è€ƒè™‘åˆ°çš„æ˜¯åº”è¯¥å¦‚ä½•è®©åˆå­¦è€…æ›´åŠ æ— ç—›åœ°æ¥å—ç”Ÿå‘½å‘¨æœŸè¿™ä¸ªæ¦‚å¿µï¼Œè€Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿™é—¨è¯¾ç¨‹å°è¯•è§£å†³çš„é—®é¢˜ã€‚</p><p>ä¸‹é¢è®©æˆ‘ä»¬ä»ä¸€ä¸ªç¤ºä¾‹è¯´èµ·ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µåœ¨Rustä¸­æ˜¯å¿…è¦çš„ã€‚</p><h2>ä»URLè§£æè¯´èµ·</h2><p>URLåè®®ç±»ä¼¼ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå¯ä»¥ç²—ç•¥åœ°å°†ä¸€ä¸ªURLåˆ†å‰²æˆ5éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ protocolã€hostã€pathã€queryã€fragmentã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/af/yy/af56c3bbec82d825d566c43af83048yy.jpg?wh=1755x436\" alt=\"\"></p><p>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªURLå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚å°±æ˜¯å›¾ç‰‡é‡Œçš„è¿™ä¸ªã€‚</p><pre><code class=\"language-plain\">let s = \"https://rustcc.cn/article?id=019f9937#title\".to_string();\n</code></pre><p>ç°åœ¨è¦æŠŠå®ƒè§£ææˆRustçš„ç»“æ„ä½“ç±»å‹ï¼ŒæŒ‰ç…§æˆ‘ä»¬å·²æŒæ¡çš„çŸ¥è¯†ï¼Œå…ˆå®šä¹‰URLç»“æ„ä½“æ¨¡å‹ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">struct Url {\n    protocol: String,\n    host: String,\n    path: String,\n    query: String,\n    fragment: String,\n}\n</code></pre><!-- [[[read_end]]] --><p>æ²¡æœ‰é—®é¢˜ï¼ŒURLå›¾ç¤ºé‡Œçš„5å¤§éƒ¨åˆ†éƒ½å·²å®šä¹‰å¥½äº†ã€‚è§£æå‡ºæ¥å¤§è‡´å°±æ˜¯è¿™æ ·ä¸€ä¸ªæ•ˆæœã€‚</p><pre><code class=\"language-plain\">let a_url = Url {\n    protocol: \"https\".to_string(),\n    host: \"rustcc.cn\".to_string(),\n    path: \"/article\".to_string(),\n    query: \"id=019f9937\".to_string(),\n    fragment: \"title\".to_string(),\n};\n</code></pre><p>è¿™æ ·å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªå­—ç¬¦ä¸²åˆ‡å‰²æˆ5éƒ¨åˆ†ï¼Œè½¬æ¢æˆäº†ä¸€ä¸ªç»“æ„ä½“ã€‚ä¸è¿‡è¿™å¹¶ä¸ç®—ä¸€ç§é«˜æ•ˆçš„åšæ³•ï¼Œåœ¨è®¡ç®—æœºç³»ç»Ÿé‡Œé¢ï¼Œä¼šåš5æ¬¡å †å†…å­˜åˆ†é…çš„æ“ä½œã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å­—ç¬¦ä¸²è½¬æ¢æˆç»“æ„ä½“ä¹‹åæ ˆå’Œå †çš„ç¤ºæ„å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/70/ebf134bdc146ccf0de5cbf62ae032270.jpg?wh=1644x1152\" alt=\"\"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªå¤§çš„å­—ç¬¦ä¸²ï¼Œåˆ†æˆäº†5ä¸ªå°çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ¯ä¸ªå°çš„å­—ç¬¦ä¸²åœ¨å †é‡Œéƒ½å•ç‹¬åˆ†é…äº†ä¸€å—å†…å­˜ï¼ŒåŸç†ä¸Šç¡®å®æ²¡é—®é¢˜ï¼Œä½†ä»è®¡ç®—æœºç§‘å­¦æ¥è®²ï¼Œ5æ¬¡å †å†…å­˜çš„åˆ†é…ä»£ä»·æœ‰ç‚¹å¤§ã€‚</p><p>é‚£åˆ°åº•åœ¨æ€§èƒ½ä¸Šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæˆ–è€…æ¢å¥è¯é—®ï¼Œæœ‰ä»€ä¹ˆä¼˜åŒ–çš„æ–¹æ¡ˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯å¯¹äºè¿™ç§<strong>åªè¯»è§£æ</strong>ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¿®æ”¹éœ€æ±‚çš„åœºæ™¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç¢ç‰‡å•ç‹¬åˆ†é…ä¸€ä¸ªå †å†…å­˜ï¼Œåªéœ€è¦å®šä¹‰5ä¸ªåˆ‡ç‰‡å¼•ç”¨å°±å¯ä»¥äº†ã€‚</p><p>åœ¨Rustè¯­è¨€é‡Œï¼Œä½ å¯ä»¥è¿™æ ·å»å®šä¹‰è¿™ä¸ªç»“æ„ä½“ã€‚</p><pre><code class=\"language-plain\">struct Url {\n    protocol: &amp;str,\n    host: &amp;str,\n    path: &amp;str,\n    query: &amp;str,\n    fragment: &amp;str,\n}\n</code></pre><p>ä½†æ˜¯è¿™æ ·æ˜¯æ²¡æ³•é€šè¿‡ç¼–è¯‘çš„ï¼Œéœ€è¦åŠ ä¸Šä¸€ä¸ªä¸œè¥¿ï¼Œå°±æ˜¯ <code>&lt;'a&gt;</code>ã€‚</p><pre><code class=\"language-plain\">struct Url&lt;'a&gt; {\n    protocol: &amp;'a str,\n    host: &amp;'a str,\n    path: &amp;'a str,\n    query: &amp;'a str,\n    fragment: &amp;'a str,\n}\n</code></pre><p>ç„¶ååƒè¿™æ ·æ¥åˆ›å»ºUrlå®ä¾‹ã€‚</p><pre><code class=\"language-plain\">let a_url = Url {\n    protocol: &amp;s[..5],\n    host: &amp;s[8..17],\n    path: &amp;s[17..25],\n    query: &amp;s[26..37],\n    fragment: &amp;s[38..43],\n};\n</code></pre><p>ç„¶åï¼Œåˆ›å»ºå‡ºæ¥çš„å†…å­˜ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/27/62/278716989240e8f04ed4851e4ac07a62.jpg?wh=1644x1157\" alt=\"\"></p><p>æœ‰çœ‹åˆ°åŒºåˆ«å—ï¼Ÿæ–°çš„æ–¹å¼ Url å®ä¾‹ a_url é‡Œçš„5ä¸ªå­—æ®µ protocolã€hostã€pathã€queryã€fragment éƒ½åªæ˜¯å­˜çš„åˆ‡ç‰‡å¼•ç”¨ï¼ŒæŒ‡å‘åŸå§‹å­—ç¬¦ä¸²sçš„æŸä¸€ä¸ªç‰‡æ–­ï¼Œä¸å†å•ç‹¬åˆ†é…ä¸€å—å—å†…å­˜ç¢ç‰‡äº†ã€‚è¿™æ ·æ•´ä¸ªè¿‡ç¨‹å°±å°‘åˆ†é…äº†5æ¬¡å †å†…å­˜ï¼Œè§£æå‡ºæ¥çš„ç»“æ„ä½“å ç”¨å†…å­˜æ¯”è¾ƒå°‘ï¼Œè€Œä¸”è§£æè¿‡ç¨‹ä¸­çš„æ€§èƒ½å¾ˆé«˜ã€‚</p><p>è¿™ä¸ªç¤ºä¾‹åæ˜ äº†Rustè¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹ï¼Œå°±æ˜¯<strong>æä¾›äº†æœ€å¤§çš„å¯èƒ½æ€§</strong>ï¼Œæ—¢å¯ä»¥ç®€å•ç²—æš´ä¾§é‡äºæ˜“ç”¨æ€§ï¼Œå…ˆæŠŠä¸œè¥¿åšå‡ºæ•ˆæœï¼Œåˆå¯ä»¥ç”¨å¦å¤–çš„æ–¹æ¡ˆä»åº•å±‚å®ç°ä¸Šåšä¼˜åŒ–ã€‚<strong>è¿™ç§ä¼˜åŒ–åœ¨Rustè¯­è¨€å°±èƒ½å®Œæˆï¼Œè€Œä¸éœ€è¦å€ŸåŠ©é¢å¤–çš„è¯­è¨€æˆ–è®¾æ–½</strong>ã€‚</p><p>ä»è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å¼•å‡ºäº†è¿™æ ·ä¸€ç§ç¬¦å· <code>'a</code>ã€‚</p><pre><code class=\"language-plain\">struct Url&lt;'a&gt; {\n    protocol: &amp;'a str,\n    host: &amp;'a str,\n    path: &amp;'a str,\n    query: &amp;'a str,\n    fragment: &amp;'a str,\n}\n</code></pre><p>å®ƒæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><h2>Rustä¸­çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><code>'a</code> è¿™ç§ç¬¦å·æ˜¯å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸç¬¦å·ï¼Œç”¨æ¥æ ‡è¯†ä¸€ä¸ªç»“æ„ä½“é‡Œæ˜¯å¦æœ‰å¯¹å¤–éƒ¨èµ„æºçš„å¼•ç”¨ï¼Œä»è€Œå¸®åŠ©Rustçš„å€Ÿç”¨æ£€æŸ¥å™¨ï¼ˆBorrow Checkerï¼‰å¯¹å¼•ç”¨çš„æœ‰æ•ˆæ€§è¿›è¡Œ<strong>ç¼–è¯‘æ—¶</strong>åˆ†æã€‚</p><p>å’Œå¤§éƒ¨åˆ†è¯­è¨€ä¸€æ ·ï¼Œåœ¨Rusté‡Œï¼Œä»»ä½•å˜é‡éƒ½æœ‰scopeï¼Œä¸€èˆ¬ç”±æœ€é‡Œå±‚çš„èŠ±æ‹¬å·æ‰€å®šä¹‰ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">fn foo() -&gt; {\n    let a = String::from(\"abc\");\n    //\n    {\n      let b = String::from(\"def\");\n    }\n}\n</code></pre><p>ä¾‹å­é‡Œï¼Œå˜é‡açš„scopeä¸ºä»å®šä¹‰æ—¶å¼€å§‹ï¼Œåˆ°ç¬¬7è¡Œ <code>foo()</code> å‡½æ•°çš„èŠ±æ‹¬å·ç»“æŸã€‚è€Œå˜é‡bçš„scopeä¸ºä»å®šä¹‰æ—¶å¼€å§‹åˆ°ç¬¬6è¡ŒèŠ±æ‹¬å·ç»“æŸã€‚</p><p>ä½†è¿™ä¸ªè§„åˆ™åœ¨Rustä¸­åªæ˜¯é’ˆå¯¹æ‰€æœ‰æƒå‹å˜é‡çš„ã€‚å¯¹å¼•ç”¨å‹å˜é‡æ¥è¯´ï¼Œåœ¨Rusté‡Œæœ‰æ›´ä¸¥æ ¼çš„scopeè¦æ±‚ã€‚</p><pre><code class=\"language-plain\">fn foo() -&gt; {\n    let a = String::from(\"abc\");\n    let a_ref = &amp;a;\n    println!(\"{}\", a_ref);\n    //\n}\n</code></pre><p>ä¾‹å­ä¸­ï¼Œå¯¹äºå¼•ç”¨å‹å˜é‡ <code>a_ref</code> æ¥è®²ï¼Œç”±äºå®ƒæŒæœ‰çš„æ˜¯å¯¹æ‰€æœ‰æƒå‹å˜é‡açš„å¼•ç”¨ï¼Œ<code>a_ref</code> å®é™…çš„scopeåªæ˜¯ä»ç¬¬3è¡Œå®šä¹‰æ—¶å¼€å§‹åˆ°ç¬¬4è¡Œæœ€åä¸€æ¬¡ä½¿ç”¨æ—¶ç»“æŸï¼ˆè¿™ä¸ªè§„åˆ™æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/720128\">ç¬¬ 3 è®²</a>ä¸­å·²ç»éªŒè¯è¿‡ï¼‰ï¼Œåˆ°ä¸äº†ç¬¬6è¡Œçš„èŠ±æ‹¬å·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒRusté‡Œçš„å¼•ç”¨å‹å˜é‡çš„scopeçœ‹èµ·æ¥æ€»æ˜¯è¦æ¯”å¯¹åº”çš„æ‰€æœ‰æƒå‹å˜é‡çš„scopeè¦å°ã€‚</p><p>è¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºæ‰€è°“å¼•ç”¨ï¼Œå°±æ˜¯å¿…å®šæœ‰æ•ˆçš„æŒ‡é’ˆã€‚<strong>å¿…å®šæœ‰æ•ˆçš„æ„æ€å°±æ˜¯ï¼Œåªè¦è¿™ä¸ªå¼•ç”¨å‹å˜é‡è¿˜åœ¨ï¼Œé‚£å®ƒæ‰€æŒ‡å‘çš„é‚£ä¸ªç›®æ ‡å¯¹è±¡å°±ä¸€å®šåœ¨</strong>ã€‚Rustä¸­é‡‡ç”¨çš„æ˜¯å½»åº•çš„é™æ€åˆ†ææŠ€æœ¯ï¼ˆç›¸å¯¹äºè¿è¡Œæ—¶æ£€æŸ¥ï¼‰ï¼Œå¸Œæœ›åœ¨ç¼–è¯‘æœŸé—´èƒ½å¤Ÿæ¸…æ¥šåœ°è®¡ç®—å‡ºæ¯ä¸ªèµ„æºï¼Œè¿˜æœ‰æŒ‡å‘è¿™ä¸ªèµ„æºçš„å¼•ç”¨çš„æœ‰æ•ˆå­˜åœ¨åŒºé—´ã€‚è¦å‡†ç¡®ï¼Œæ—¢ä¸èƒ½å¤šï¼Œä¹Ÿä¸èƒ½å°‘ï¼Œå¹¶ä¸”ä¸¤ä¸ªè¦åŒ¹é…å¥½ã€‚äºæ˜¯Rustå¼•å…¥äº†æ‰€æœ‰æƒçš„è®¾è®¡ï¼Œæ¥æè¿°å¯¹èµ„æºçš„ç®¡ç†ã€‚è¿™æ˜¯ä¸€ä¸ªæ ¹ä¸Šçš„è®¾è®¡ï¼Œå®ƒçš„å¼•å…¥ä¸å¯é¿å…åœ°å¸¦æ¥äº†ä¸€æ•´å¥—åç»­çš„æœºåˆ¶ã€‚</p><ul>\n<li>å€Ÿç”¨ä¸å¼•ç”¨\n<ul>\n<li>ä¸å¯å˜å¼•ç”¨</li>\n<li>å¯å˜å¼•ç”¨</li>\n</ul>\n</li>\n<li>å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸåˆ†æ</li>\n</ul><p>æ‰€æœ‰æƒçš„ç”Ÿå‘½å‘¨æœŸscopeçš„åˆ†ææ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç”¨æ‰€åœ¨å±‚æ¬¡èŠ±æ‹¬å·è§„åˆ™å°±å¯ä»¥å¤„ç†ã€‚éš¾ç‚¹åœ¨äºå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸscopeçš„åˆ†æï¼Œè¿™ä¸ªå·¥ä½œå°±æ˜¯ç”±Borrow Checkeræ¥åšçš„ã€‚å› ä¸ºä»£ç é€»è¾‘å¯èƒ½éå¸¸å¤æ‚ï¼Œå¾ˆéš¾æ‰¾åˆ°ä¸€ç§æ™ºèƒ½çš„æ–¹æ³•å¯ä»¥é€šç”¨åœ°å¹¶ä¸”å®Œå…¨æ­£ç¡®åœ°å¤„ç†æ‰€æœ‰ä»£ç ä¸­çš„å¼•ç”¨ã€‚è¿™éå¸¸å›°éš¾ï¼Œç¼–ç¨‹è¯­è¨€å‘å±•äº†å‡ åå¹´ï¼Œå…¶ä»–è¯­è¨€è¦ä¹ˆå¦‚Cè¿™ç§æ”¾å¼ƒæ²»ç–—ï¼ŒæŠŠè¿™ä¸ªé—®é¢˜å…¨éƒ¨äº¤ç»™ç¨‹åºå‘˜è‡ªå·±å¤„ç†ï¼Œè¦ä¹ˆåƒ  Java è¿™ç§å¼•å…¥GCå±‚ï¼Œç”¨GCæ¥ç»Ÿä¸€ç®¡ç†å¯¹èµ„æºçš„å¼•ç”¨ã€‚</p><p>å› æ­¤ç›®å‰é˜¶æ®µRustè¿˜éœ€è¦æˆ‘ä»¬ç¨‹åºå‘˜äººä¸ºåœ°ä¸ºå®ƒæä¾›ä¸€äº›ä¿¡æ¯æ ‡æ³¨ï¼Œè€Œ <code>'a</code> å°±æ˜¯è¿™æ ·ä¸€ç§ä¿¡æ¯æ ‡æ³¨æœºåˆ¶ã€‚æœ‰å¯èƒ½åé¢éšç€AIçš„è“¬å‹ƒå‘å±•ï¼Œæœªæ¥èƒ½å‡ºç°å¯é çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬å°±ä¸å†éœ€è¦æ‰‹åŠ¨æ·»åŠ è¿™äº›æ ‡æ³¨ä¿¡æ¯äº†ï¼Œä½†ç›®å‰è¿˜æ˜¯éœ€è¦çš„ã€‚</p><p><strong><code>'a</code> ä»£è¡¨æŸä¸€ç‰‡ä»£ç åŒºé—´ï¼Œè¿™ç‰‡ä»£ç åŒºé—´å°±æ˜¯è¢«è¿™ç§ç¬¦å·æ ‡æ³¨çš„å¼•ç”¨çš„æœ‰æ•ˆå­˜åœ¨åŒºé—´ã€‚</strong></p><h3>ç»“æ„ä½“ä¸­çš„å¼•ç”¨</h3><p>ä¸Šé¢ç¤ºä¾‹çš„ç»“æ„ä½“Urlä¸­ï¼Œ<code>&lt;'a&gt;</code> æ˜¯è¡¨ç¤ºå®šä¹‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸç¬¦å· <code>'a</code>ï¼Œè¿™ä¸ª <code>'a</code> çš„åå­—å¯ä»¥ä»»æ„å–ï¼Œæ¯”å¦‚å–å <code>'abc</code>ã€<code>'h</code>ã€<code>'helloworld</code> ç­‰éƒ½æ˜¯å¯ä»¥çš„ã€‚ä¸€èˆ¬ä½¿ç”¨å•å°å†™å­—æ¯è¡¨ç¤ºï¼Œä½†æ˜¯ä½ å¦‚æœçœ‹åˆ°å•è¯å½¢å¼çš„ç”Ÿå‘½å‘¨æœŸç¬¦å·ä¹Ÿä¸è¦æƒŠè®¶ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">struct Url&lt;'helloworld&gt; {\n  protocol: &amp;'helloworld str,\n  // ...\n}\n</code></pre><p>å®šä¹‰å¥½ <code>'a</code> ç¬¦å·åï¼Œéœ€è¦æ ‡æ³¨åˆ°ç›®æ ‡çš„å¼•ç”¨ä¸Šé¢å»ï¼Œä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ&amp;strçš„ &amp; å’Œ str ä¹‹é—´ï¼ŒåŠ  <code>'a</code>ï¼Œå†™æˆ <code>&amp;'a str</code>ã€‚è¿™æ ·å°±è¡¨ç¤º<strong>ç»“æ„ä½“Urlä¾èµ–ä¸€ä¸ªå¤–éƒ¨èµ„æº</strong>ï¼Œå…·ä½“æ¥è¯´ï¼Œæ˜¯å…¶protocolå­—æ®µä¾èµ–äºä¸€ä¸ªå¤–éƒ¨çš„å­—ç¬¦ä¸²ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒUrlçš„5ä¸ªå­—æ®µéƒ½ä¾èµ–äºåŒä¸€ä¸ªå¤–éƒ¨å­—ç¬¦ä¸²èµ„æºï¼Œå› æ­¤åªéœ€è¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code> å°±è¡Œäº†ã€‚å¦‚æœæ˜¯ä¾èµ–äºä¸åŒçš„å­—ç¬¦ä¸²èµ„æºï¼Œå¯ä»¥åˆ†å¼€å†™æˆä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ã€<code>'b</code> ç­‰ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">struct Url&lt;'a, 'b, 'c&gt; {\n    protocol: &amp;'a str,\n    host: &amp;'a str,\n    path: &amp;'b str,\n    query: &amp;'b str,\n    fragment: &amp;'c str,\n}\n</code></pre><p>ä¸Šé¢çš„å®šä¹‰ä¸­ï¼ŒUrlå®šä¹‰äº†ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ã€<code>'b</code>ã€<code>'c</code>ã€‚ä»è¿™ä¸ªå®šä¹‰æˆ‘ä»¬èƒ½æ¸…æ™°åœ°çœ‹å‡ºï¼ŒUrlç±»å‹<strong>å¯èƒ½</strong>ä¾èµ–äº3ä¸ªå¤–éƒ¨å­—ç¬¦ä¸²èµ„æºã€‚</p><p>å½“åœ¨ç±»å‹ä¸Šæ·»åŠ äº†ç”Ÿå‘½å‘¨æœŸç¬¦å·æ ‡æ³¨åï¼Œå¯¹å®ƒåšimplçš„æ—¶å€™ä¹Ÿéœ€è¦å¸¦ä¸Šè¿™ä¸ªå‚æ•°äº†ã€‚</p><pre><code class=\"language-plain\">struct Url&lt;'a&gt; {\n&nbsp; &nbsp; protocol: &amp;'a str,\n&nbsp; &nbsp; host: &amp;'a str,\n&nbsp; &nbsp; path: &amp;'a str,\n&nbsp; &nbsp; query: &amp;'a str,\n&nbsp; &nbsp; fragment: &amp;'a str,\n}\n\nimpl&lt;'a&gt; Url&lt;'a&gt; {    // è¿™é‡Œ\n&nbsp; &nbsp; fn play() {}\n}\n</code></pre><p>è¯·æ³¨æ„ä¸Šé¢ä»£ç é‡Œçš„ç¬¬9è¡Œ impl åå®šä¹‰çš„ <code>&lt;'a&gt;</code> å‚æ•°ï¼Œä½ å¯ä»¥å‘ç° <code>'a</code> çš„åœ°ä½å¥½åƒä¸ç±»å‹å‚æ•° T ç±»ä¼¼ã€‚</p><p>ç”Ÿå‘½å‘¨æœŸç¬¦å· <code>'a</code> å…·æœ‰ä¼ æŸ“æ€§ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç»“æ„ä½“ç”¨äºæ„å»ºå¦ä¸€ä¸ªç»“æ„ä½“å­—æ®µçš„æ—¶å€™ã€‚</p><pre><code class=\"language-plain\">struct Url&lt;'a&gt; {\n    protocol: &amp;'a str,\n    // ...\n}\n\nstruct Request&lt;'a&gt; {\n    url: Url&lt;'a&gt;,\n    body: String,\n    // ...\n}\n</code></pre><p>ä¸Šé¢ç¤ºä¾‹é‡Œï¼ŒRequestç»“æ„ä½“ä¸­åŒ…å«ä¸€ä¸ªUrlç»“æ„ä½“çš„å®ä¾‹ï¼Œå› ä¸ºUrlç±»å‹å¸¦ç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ï¼Œå› æ­¤Requestä¸­ä¹Ÿ<strong>ä¸å¾—ä¸</strong>å¸¦ä¸ŠåŒä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ã€‚è¿™å°±æ˜¯<strong>ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„ä¼ æŸ“æ€§</strong>ã€‚</p><p>è¿™æ ·æ ‡è¯†æ˜¯æœ‰å¥½å¤„çš„ï¼Œå› ä¸ºUrlçš„å®ä¾‹ä¾èµ–äºå¤–éƒ¨æ‰€æœ‰æƒèµ„æºï¼Œé‚£ä¹ˆé¡ºæ¨Requestç±»å‹çš„å®ä¾‹ä¹Ÿè¦ä¾èµ–äºé‚£äº›å¤–éƒ¨æ‰€æœ‰æƒèµ„æºã€‚å¦‚æœä¸æ ‡è¯†ï¼Œå½“åµŒå¥—å±‚æ¬¡è¿‡å¤šäº†ä¹‹åï¼Œä½ å¾ˆéš¾ç”¨è‚‰çœ¼åˆ†æå‡ºä¸€ä¸ªç»“æ„ä½“ç±»å‹åˆ°åº•æ˜¯ä¸æ˜¯<strong>è‡ªåŒ…å«</strong>ï¼ˆself-containedï¼Œä¹Ÿå°±æ˜¯ç”±è‡ªå·±æŒæ¡æ¶‰åŠèµ„æºçš„æ‰€æœ‰æƒï¼‰çš„ã€‚</p><p>å¥½åœ¨Rustçš„ä¸¥æ ¼æ€§ï¼Œè¦æ±‚ä½ å¿…é¡»ä¾æ¬¡ä¸€ä¸ªä¸å·®åœ°æ ‡è¯†å‡ºæ¥ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°æ½œåœ¨çš„é—®é¢˜äº†ã€‚ä¸è¿‡æ€»çš„æ¥è¯´ï¼Œç”Ÿå‘½å‘¨æœŸç¬¦å· <code>'a</code> ä¸»è¦è¿˜æ˜¯å¸®åŠ©Rustç¼–è¯‘å™¨çš„ï¼Œè€Œä¸æ˜¯ç»™ç¨‹åºå‘˜çœ‹çš„ã€‚ç¨‹åºå‘˜çš„ç›´è§‚æ„Ÿè§‰æ˜¯å®ƒéå¸¸ä¸‘é™‹è€Œä¸”å¸¦æ¥è¯­æ³•å™ªéŸ³ã€‚</p><p>åœ¨ç›®å‰çš„æŠ€æœ¯èƒ½åŠ›ä¸‹ï¼Œé€šè¿‡å¼•å…¥ç”Ÿå‘½å‘¨æœŸç¬¦å·æ ‡æ³¨ï¼ŒRustèƒ½å®ç°ç²¾å‡†åœ°åˆ†æå¼•ç”¨çš„æœ‰æ•ˆæœŸã€‚</p><h3>å‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨</h3><p>é™¤äº†ç»“æ„ä½“ä¸­ï¼Œåœ¨å…¶ä»–è¯­è¨€å…ƒç´ ä¸Šä¹Ÿä¼šå‡ºç°å¼•ç”¨çš„åœºæ™¯ã€‚ä¸€å¤§åœºæ™¯å°±æ˜¯å‡½æ•°è¿”å›å€¼ä¸­å¸¦å¼•ç”¨ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢è¿™ä¸ªå‡½æ•°ã€‚</p><pre><code class=\"language-plain\">fn foo() -&gt; &amp;str {\n&nbsp; &nbsp; let s = String::from(\"abc\");\n&nbsp; &nbsp; &amp;s&nbsp; \n}\n</code></pre><p>æˆ‘ä»¬æƒ³è¿”å› <code>foo</code> å‡½æ•°é‡Œçš„å±€éƒ¨å˜é‡sçš„å¼•ç”¨ï¼Œå¯ä»¥å—ï¼Ÿè‚¯å®šæ˜¯ä¸å¯ä»¥çš„ã€‚æ‰€æœ‰æƒå˜é‡såœ¨ <code>foo()</code> å‡½æ•°æ‰§è¡Œå®Œåå°±è¢«å›æ”¶äº†ï¼Œè¿”å›å¯¹è¿™ä¸ªå­—ç¬¦ä¸²èµ„æºçš„å¼•ç”¨ä¸å°±æ˜¯æ‚¬æŒ‚æŒ‡é’ˆäº†å—ï¼Ÿç¼–è¯‘æç¤ºå¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">error[E0515]: cannot return reference to local variable `s`\n&nbsp;--&gt; src/main.rs:3:5\n&nbsp; |\n3 |&nbsp; &nbsp; &nbsp;&amp;s&nbsp; \n&nbsp; |&nbsp; &nbsp; &nbsp;^^ returns a reference to data owned by the current function\n</code></pre><p>é‚£ä¹ˆï¼Œä¸€ä¸ªå‡½æ•°ä¸­è¿”å›ä¸€ä¸ªç±»å‹çš„å¼•ç”¨ï¼Œæœ‰å‡ ç§å¯èƒ½çš„æƒ…å†µå‘¢ï¼Ÿåªæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯è¿”å›å¯¹å¤–éƒ¨å…¨å±€å˜é‡çš„å¼•ç”¨ï¼›å¦ä¸€ç§æ˜¯è¿”å›å‡½æ•°çš„å¼•ç”¨å‚æ•°æ‰€æŒ‡å‘èµ„æºçš„å¼•ç”¨ã€‚</p><p>æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç§æƒ…å†µã€‚</p><pre><code class=\"language-plain\">static ASTRING: &amp;'static str = \"abc\";\nfn foo() -&gt; &amp;str {\n&nbsp; &nbsp; ASTRING\n}\n</code></pre><p>è¿™æ˜¯å¯ä»¥çš„ã€‚ä½†å®é™…è¿™æ ·å†™çš„ä»·å€¼ä¸å¤§ï¼Œæ²¡å¤šå¤§ç”¨ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µï¼š</p><pre><code class=\"language-plain\">fn foo(a: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; a\n}\n</code></pre><p>è¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†è¿™ç§åªæœ‰ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å‚æ•°ä¼ å…¥ï¼Œå†è¿”å›å›å»ï¼Œå¥½åƒä¹Ÿæ²¡å¤šå¤§æ„æ€ã€‚å¦‚æœæœ‰å¤šä¸ªå¼•ç”¨ç±»å‹çš„å‚æ•°ä¼ å…¥å‘¢ï¼Ÿæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">fn foo(a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; a\n}\n</code></pre><p>Rustç¼–è¯‘å™¨å¼€å§‹æŠ±æ€¨äº†ã€‚</p><pre><code class=\"language-plain\">error[E0106]: missing lifetime specifier\n&nbsp;--&gt; src/lib.rs:1:29\n&nbsp; |\n1 | fn foo(a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;----&nbsp; &nbsp; &nbsp;----&nbsp; &nbsp; &nbsp;^ expected named lifetime parameter\n&nbsp; |\n&nbsp; = help: this function's return type contains a borrowed value, but the signature does not say whether it is borrowed from `a` or `b`\nhelp: consider introducing a named lifetime parameter\n&nbsp; |\n1 | fn foo&lt;'a&gt;(a: &amp;'a str, b: &amp;'a str) -&gt; &amp;'a str {\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp;++++&nbsp; &nbsp; &nbsp;++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ++\n</code></pre><p>å®ƒæŠ±æ€¨è¯´ï¼Œä½ å°‘å†™äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œå› ä¸ºå‡½æ•°çš„è¿”å›ç±»å‹ä¸­åŒ…å«ä¸€ä¸ªå€Ÿç”¨å€¼ï¼Œä½†æ˜¯å‡½æ•°ç­¾åä¸­æ²¡æœ‰è¯´è¿™ä¸ªå€Ÿç”¨æ˜¯æ¥è‡ªaè¿˜æ˜¯bã€‚ç„¶åè¿˜ç»™å‡ºäº†ä¸€ä¸ªå»ºè®®ï¼Œåœ¨å‡½æ•°å‚æ•°å’Œè¿”å›ç±»å‹ä¸Šï¼Œéƒ½åŠ ä¸Šç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ï¼Œå°±æ˜¯åƒä¸‹é¢è¿™ä¸ªæ ·å­ã€‚</p><pre><code class=\"language-plain\">fn foo&lt;'a&gt;(a: &amp;'a str, b: &amp;'a str) -&gt; &amp;'a str {\n&nbsp; &nbsp; a\n}\n</code></pre><p>ç±»ä¼¼äºåœ¨ç»“æ„ä½“ä¸Šå®šä¹‰ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œåœ¨å‡½æ•°ç­¾åä¸­ï¼Œå¦‚æœè¦å¼•å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œä¹Ÿéœ€è¦å…ˆå®šä¹‰ï¼Œå°±æ˜¯å®šä¹‰åœ¨å‡½æ•°å <code>foo</code> åçš„ <code>&lt;&gt;</code> é‡Œã€‚å…ˆå®šä¹‰ï¼Œå†ä½¿ç”¨ã€‚å®šä¹‰ä¹‹åï¼Œåœ¨åé¢çš„å¼•ç”¨ä¸Šæ‰èƒ½ä½¿ç”¨è¿™ä¸ªç¬¦å·ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬å‡½æ•°å®ç°ä¸­æ˜ç¡®å†™äº†è¿”å›açš„ï¼Œæ„Ÿè§‰Rustç•¥ç¬¨ã€‚å®é™…ä¸Šåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒRuståªä¼šåŸºäºå‡½æ•°ç­¾åï¼Œä¹Ÿå°±æ˜¯ä¼ å…¥ä¼ å‡ºçš„ç±»å‹è¿›è¡Œåˆ†æï¼Œè€Œä¸ä¼šå»åˆ†æå‡½æ•°ä½“çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå»åˆ†æå‡½æ•°ä¸­çš„å®ç°é€»è¾‘ã€‚åªè¦è¿”å›å€¼çš„ç±»å‹æ²¡æœ‰é—®é¢˜ï¼Œå®ƒå°±ä¸ä¼šæŠ±æ€¨ã€‚æˆ‘ä»¬å†çœ‹ä¸€ä¸ªç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">fn foo(i: u32, a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; if i == 1 {\n&nbsp; &nbsp; &nbsp; &nbsp; a\n&nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; b\n&nbsp; &nbsp; }\n}\n// ä¹Ÿéœ€è¦å†™æˆ\nfn foo&lt;'a&gt;(i: u32, a: &amp;'a str, b: &amp;'a str) -&gt; &amp;'a str {\n&nbsp; &nbsp; if i == 1 {\n&nbsp; &nbsp; &nbsp; &nbsp; a\n&nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; b\n&nbsp; &nbsp; }\n}\n</code></pre><p>è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œåˆ°åº•è¿”å›aè¿˜æ˜¯bï¼Œåœ¨ç¼–è¯‘æœŸæ˜¯æ²¡åŠæ³•ç¡®å®šä¸‹æ¥çš„ï¼Œåªèƒ½åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œç”±å…·ä½“ä¼ å…¥çš„ <code>i</code> å€¼æ¥ç¡®å®šã€‚ä¸è¿‡ï¼ŒRuståˆ†æçš„æ—¶å€™ï¼Œä¸å…³å¿ƒè¿™ä¸ªå…·ä½“çš„é€»è¾‘ï¼Œå®ƒåªçœ‹å‡½æ•°ç­¾åä¸­çš„å¼•ç”¨ä¹‹é—´ï¼Œæœ‰æ²¡æœ‰å¯èƒ½ä¼šå‘ç”Ÿå…³è”ã€‚</p><pre><code class=\"language-plain\">fn foo&lt;'a&gt;(a: &amp;'a str, b: &amp;'a str) -&gt; &amp;'a str {\n</code></pre><p>åœ¨fooå‡½æ•°ç­¾åä¸­å‡ºç°äº†4æ¬¡ <code>'a</code> ç¬¦å·ï¼Œé™¤å»ç¬¬ä¸€ä¸ªæ˜¯å®šä¹‰ <code>'a</code>ï¼Œåé¢3æ¬¡éƒ½æ˜¯ä½¿ç”¨ <code>'a</code>ã€‚è¿™åé¢ä¸‰ä¸ªä¸åŒä½ç½®çš„ <code>'a</code> çš„æ„ä¹‰åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œfooå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°aã€bï¼Œå®ƒæ˜¯å¤–éƒ¨å­—ç¬¦ä¸²èµ„æºçš„å¼•ç”¨ã€‚å®ƒä»¬æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²èµ„æºï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol>\n<li>ä¸ºåŒä¸€ä¸ªå­—ç¬¦ä¸²èµ„æºï¼›</li>\n<li>ä¸ºä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²èµ„æºã€‚</li>\n</ol><p>ç¬¬ä¸€ç§æƒ…å†µæ¯”è¾ƒå¥½ç†è§£ï¼Œè¿”å›çš„å¼•ç”¨ä»ç„¶æŒ‡å‘è¿™ä¸ªå­—ç¬¦ä¸²èµ„æºï¼Œå› æ­¤å®ƒä»¬æ ‡æ³¨ä¸ºåŒä¸€ä¸ª <code>'a</code> ç”Ÿå‘½å‘¨æœŸå‚æ•°ç¬¦å·ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µç¨å¾®å¤æ‚ä¸€äº›ã€‚aå’ŒbæŒ‡å‘çš„æ˜¯ä¸åŒçš„å­—ç¬¦ä¸²èµ„æºï¼Œå¯¹åº”çš„èµ„æºæˆ‘ä»¬æ ‡è®°ä¸º Ra å’Œ Rbï¼ŒRaå’ŒRbæœ‰å„è‡ªçš„scopeã€‚aæ˜¯Raçš„å¼•ç”¨ï¼Œbæ˜¯Rbçš„å¼•ç”¨ï¼Œæˆ‘ä»¬å¼ºè¡Œåœ¨è¿™ä¸¤ä¸ªä¸åŒèµ„æºçš„å¼•ç”¨ä¸Šæ ‡æ³¨ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‚æ•° <code>'a</code>ï¼Œå®ƒä¸€å®šæ˜¯åšäº†æŸç§æ“ä½œï¼Œæä¾›ä¸€äº›é¢å¤–çš„ä¿¡æ¯ã€‚</p><p>å› ä¸ºRaå’ŒRbçš„scopeä¸€èˆ¬ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å‡è®¾Rbèµ„æºå…ˆé‡Šæ”¾ï¼ŒRaèµ„æºåé‡Šæ”¾ã€‚é‚£æˆ‘ä»¬é¦–å…ˆè¦ä¿è¯çš„æ˜¯åœ¨ <code>foo()</code> å‡½æ•°æ‰§è¡ŒæœŸé—´ï¼ŒRaå’ŒRbéƒ½å­˜åœ¨ã€‚åœ¨aå’Œbçš„ç±»å‹ä¸Šå¼ºåˆ¶æ ‡è¯† <code>'a</code>ï¼Œ<strong>å®é™…ä¸Šæ˜¯ç»™ <code>'a</code> å–äº†ä¸€ä¸ªæ¯”è¾ƒå°çš„ä»£ç åŒºé—´</strong>ï¼Œä¹Ÿå°±æ˜¯åˆ°Rbçš„èµ„æºé‡Šæ”¾çš„é‚£ä¸€è¡Œä»£ç ä¸ºæ­¢ã€‚</p><p>åŒæ—¶æˆ‘ä»¬è¿˜æŠŠ <code>'a</code> æ ‡æ³¨åˆ°è¿”å›ç±»å‹ä¸Šï¼Œå°±<strong>æ„å‘³ç€å°† <code>'a</code> æŒ‡ä»£çš„ç”Ÿå‘½å‘¨æœŸåŒºé—´æ–½åŠ åˆ°äº†è¿”å›çš„å¼•ç”¨ä¸Š</strong>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªç¤ºä¾‹æ¥éªŒè¯è¿™ä¸ªè®ºæ–­ã€‚</p><pre><code class=\"language-plain\">fn longest&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str {\n&nbsp; &nbsp; if x.len() &gt; y.len() {\n&nbsp; &nbsp; &nbsp; &nbsp; x\n&nbsp; &nbsp; } else {\n&nbsp; &nbsp; &nbsp; &nbsp; y\n&nbsp; &nbsp; }\n}\n\nfn main() {\n&nbsp; &nbsp; let s1 = String::from(\"long string is long\");\n&nbsp; &nbsp; let result;\n&nbsp; &nbsp; {\n&nbsp; &nbsp; &nbsp; &nbsp; let s2 = String::from(\"xyz\");\n&nbsp; &nbsp; &nbsp; &nbsp; result = longest(s1.as_str(), s2.as_str());\n&nbsp; &nbsp; }\n&nbsp; &nbsp; println!(\"The longest string is {}\", result);\n}\n</code></pre><p>ç¼–è¯‘ä¼šæŠ¥é”™ï¼š</p><pre><code class=\"language-plain\">error[E0597]: `s2` does not live long enough\n&nbsp; --&gt; src/main.rs:14:39\n&nbsp; &nbsp;|\n13 |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let s2 = String::from(\"xyz\");\n&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-- binding `s2` declared here\n14 |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;result = longest(s1.as_str(), s2.as_str());\n&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^^^^^^^^^^^ borrowed value does not live long enough\n15 |&nbsp; &nbsp; &nbsp;}\n&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp;- `s2` dropped here while still borrowed\n16 |&nbsp; &nbsp; &nbsp;println!(\"The longest string is {}\", result);\n&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ------ borrow later used here\n</code></pre><p>ä»æˆ‘ä»¬è‚‰çœ¼åˆ†ææ¥çœ‹ï¼Œresultå˜é‡æœ€åå–çš„æ˜¯s1çš„å¼•ç”¨ï¼Œå¹¶æ²¡æœ‰å€Ÿç”¨s2ï¼Œå®ƒåº”è¯¥æ˜¯åœ¨mainå‡½æ•°é‡Œä¸€ç›´æœ‰æ•ˆçš„ï¼Œå°±æ˜¯ç¬¬16è¡Œåº”è¯¥èƒ½æ‰“å°å‡ºæ­£ç¡®çš„å€¼ã€‚ä½†æ˜¯ç¼–è¯‘å´ä¸é€šè¿‡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å°±æ˜¯å› ä¸º<strong>Rustæ˜¯æŒ‰ç”Ÿå‘½å‘¨æœŸæ¥åˆ†æå€Ÿç”¨çš„ï¼Œè€Œä¸æ˜¯é å‡½æ•°é€»è¾‘</strong>ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼ŒRustä¼šåˆ†æå‡ºæ¥ï¼Œ<code>longest()</code> å‡½æ•°è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸ <code>'a</code>ï¼Œæ˜¯åˆ°ä»£ç ç¬¬15è¡Œï¼Œä¹Ÿå°±æ˜¯s2è¢«å›æ”¶çš„åœ°æ–¹ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œä¼šåœ¨s1å’Œs2ä¸¤ä¸ªèµ„æºçš„scopeä¸­å–è¾ƒå°çš„é‚£ä¸ªåŒºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œresultè¿™ä¸ªå¼•ç”¨å‹å˜é‡çš„scopeåˆ°ç¬¬15è¡Œä¸ºæ­¢ï¼Œæ‰€ä»¥åœ¨ç¬¬16è¡Œå°±ä¸èƒ½å†ä½¿ç”¨å®ƒäº†ã€‚è¿™ä¸ªä¾‹å­ä½ å¯ä»¥ä»”ç»†ä½“ä¼šä¸€ä¸‹ã€‚</p><p>æ˜¯ä¸æ˜¯æœ‰ç‚¹åç›´è§‰ï¼Ÿå¦‚æœé æˆ‘ä»¬äººçœ¼å»åˆ†æï¼Œè¿™ä¸ªä¾‹å­åº”è¯¥æ˜¯å¯ä»¥æ­£å¸¸æ‰“å°çš„ã€‚è¿™ä¹Ÿæ˜¯Ruståˆå­¦è€…å¸¸å¸¸ç–‘æƒ‘è€Œä¸”å´©æºƒçš„åœ°æ–¹ï¼Œä¸å¤ªå¥½æ‡‚ã€‚ä½ å¯ä»¥éª‚ä¸€ä¸‹ï¼ŒRustå‚»ã€‚ç¡®å®å‚»ï¼Œç›®å‰åˆ†æé¢†åŸŸçš„æŠ€æœ¯è¿˜åšä¸åˆ°å®Œç¾è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æœ‰ç‚¹å‚»ï¼Œæˆ‘ä»¬åªèƒ½å¸Œæœ›åœ¨æœªæ¥çš„ç‰ˆæœ¬è¿­ä»£ä¸­é€æ¸å¢å¼ºRustçš„æ¨ç†èƒ½åŠ›ã€‚</p><h3>ç±»å‹æ–¹æ³•ä¸­çš„å¼•ç”¨</h3><p>å›é¡¾å‰é¢çš„å†…å®¹ï¼Œç±»å‹çš„æ–¹æ³•åªæ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºSelfçš„æ‰€æœ‰æƒæˆ–å¼•ç”¨ç±»å‹çš„å‡½æ•°ã€‚å› æ­¤ä¸Šé¢åˆ†æçš„å‡½æ•°è¿”å›å€¼é‡Œå¼•ç”¨çš„ç»†èŠ‚ä¹Ÿé€‚ç”¨äºç±»å‹çš„æ–¹æ³•ã€‚</p><p>æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œå¦‚æœè¿”å›çš„å€¼æ˜¯Selfæœ¬èº«æˆ–æœ¬èº«ä¸€éƒ¨åˆ†çš„å¼•ç”¨ï¼Œå°±ä¸ç”¨æ‰‹åŠ¨å†™ <code>'a</code> ç”Ÿå‘½å‘¨æœŸç¬¦å·ï¼ŒRustä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åœ¨æ–¹æ³•è¿”å›å€¼å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸå’ŒSelfçš„scopeä¹‹é—´è¿›è¡Œç»‘å®šï¼Œè¿™æ˜¯ä¸€æ¡é»˜è®¤çš„è§„åˆ™ã€‚</p><pre><code class=\"language-plain\">struct A {\n&nbsp; &nbsp; foo: String,\n}\n\nimpl A {\n&nbsp; &nbsp; fn play(&amp;self, a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; &nbsp; &nbsp; &amp;self.foo\n&nbsp; &nbsp; }\n}\n</code></pre><p>æˆ‘ä»¬ç¨ç¨æ”¹ä¸€ä¸‹ä»£ç å°±æ²¡åŠæ³•ç¼–è¯‘é€šè¿‡äº†ã€‚</p><pre><code class=\"language-plain\">struct A {\n&nbsp; &nbsp; foo: String,\n}\n\nimpl A {\n&nbsp; &nbsp; fn play(&amp;self, a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; &nbsp; &nbsp; a\n&nbsp; &nbsp; }\n}\n</code></pre><p>ç¼–è¯‘æç¤ºï¼š</p><pre><code class=\"language-plain\">error: lifetime may not live long enough\n&nbsp;--&gt; src/lib.rs:8:9\n&nbsp; |\n7 |&nbsp; &nbsp; &nbsp;fn play(&amp;self, a: &amp;str, b: &amp;str) -&gt; &amp;str {\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- let's call the lifetime of this reference `'1`\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let's call the lifetime of this reference `'2`\n8 |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;a\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^ method was supposed to return data with lifetime `'2` but it is returning data with lifetime `'1`\n&nbsp; |\nhelp: consider introducing a named lifetime parameter and update trait if needed\n&nbsp; |\n7 |&nbsp; &nbsp; &nbsp;fn play&lt;'a&gt;(&amp;'a self, a: &amp;'a str, b: &amp;str) -&gt; &amp;str {\n&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ++++&nbsp; ++&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;++\n</code></pre><p>è§£é‡Šè¯´ï¼Œæœ¬æ¥æˆ‘ä»¬æœŸæœ›æ–¹æ³•è¿”å›ç±»å‹çš„ç”Ÿå‘½å‘¨æœŸä¸ºSelfçš„ç”Ÿå‘½å‘¨æœŸï¼Œç»“æœä½ ç»™æˆ‘è¿”å›äº†å¦ä¸€ä¸ªèµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘å¹¶ä¸è®¤è¯†é‚£ä¸ªèµ„æºï¼Œæ‰€ä»¥éœ€è¦ä½ æ‰‹åŠ¨æ ‡æ³¨ã€‚å¹¶ä¸”ç»™å‡ºäº†ä¿®æ”¹å»ºè®®ï¼Œæˆ‘ä»¬æŒ‰å»ºè®®ä¿®æ”¹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-plain\">struct A {\n&nbsp; &nbsp; foo: String,\n}\n\nimpl A {\n&nbsp; &nbsp; fn play&lt;'a&gt;(&amp;'a self, a: &amp;'a str, b: &amp;str) -&gt; &amp;str {\n&nbsp; &nbsp; &nbsp; &nbsp; a\n&nbsp; &nbsp; }\n}\n</code></pre><p>è¿™ä¸‹å°±å¯ä»¥é€šè¿‡äº†ã€‚å¯ä»¥çœ‹åˆ°ä¸Šé¢ç¤ºä¾‹é‡Œçš„playæ–¹æ³•åœ¨å‚æ•°aã€å‚æ•°selfå’Œè¿”å›å€¼ä¹‹é—´è¿›è¡Œäº†ç»‘å®šã€‚</p><h3>'static</h3><p>åœ¨æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°ç¬¦å·é‡Œæœ‰ä¸€ä¸ªæ˜¯ç‰¹æ®Šçš„ï¼Œé‚£å°±æ˜¯ 'staticï¼Œå®ƒä»£è¡¨æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­æœ€é•¿çš„é‚£ä¸€ä¸ªï¼Œå’Œç¨‹åºå­˜åœ¨çš„æ—¶é—´ä¸€æ ·é•¿ã€‚å®ƒè¡¨ç¤ºè¢«æ ‡æ³¨çš„å¼•ç”¨æ‰€æŒ‡å‘çš„èµ„æºåœ¨æ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚æ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">fn main() {\n    let s: &amp;'static str = \"I have a static lifetime.\";\n}\n</code></pre><p>ä¸Šé¢è¿™ä¸ªç¤ºä¾‹åº”è¯¥å¾ˆå®¹æ˜“ç†è§£ï¼Œå› ä¸ºå­—ç¬¦ä¸²å­—é¢é‡æ˜¯å­˜å‚¨åœ¨é™æ€æ•°æ®åŒºçš„ï¼Œç¨‹åºå­˜åœ¨å¤šä¹…ï¼Œå®ƒå°±å­˜åœ¨å¤šä¹…ï¼Œå®ƒå¯¹åº”çš„å±€éƒ¨å˜é‡ sï¼ˆ&amp;'static strï¼‰çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå°±è·Ÿç€å¯ä»¥æŒç»­åˆ°ç¨‹åºç»“æŸã€‚</p><p>å› æ­¤ 'static æ˜¯æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸç¬¦å·ä¸­æœ€é•¿çš„ä¸€ä¸ªã€‚</p><h2>å¯¹ç”Ÿå‘½å‘¨æœŸçš„ç†è§£</h2><h3>ä¸ºä»€ä¹ˆæ”¾åœ¨å°–æ‹¬å·ä¸­ï¼Ÿ</h3><p>åœ¨å‰é¢çš„è®²è§£ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œç”Ÿå‘½å‘¨æœŸå‚æ•°æ˜¯æ”¾åœ¨ <code>&lt;&gt;</code> å°–æ‹¬å·é‡Œçš„ã€‚å›æƒ³ä¸€ä¸‹ä¹‹å‰çš„çŸ¥è¯†ç‚¹ï¼Œåªæœ‰ç±»å‹å‚æ•°æ‰ä¼šæ”¾åœ¨å°–æ‹¬å·é‡Œï¼Œä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸå‚æ•°ä¹Ÿæ”¾åœ¨è¿™é‡Œé¢å‘¢ï¼Ÿ</p><p>å¦‚æœç”¨ä¸€å¥è¯è§£é‡Šï¼Œé‚£å°±æ˜¯å› ä¸º<strong>ç”Ÿå‘½å‘¨æœŸå‚æ•°è·Ÿç±»å‹å‚æ•°ä¸€æ ·ï¼Œä¹Ÿæ˜¯ generic parameter çš„ä¸€ç§</strong>ï¼Œæ‰€ä»¥æ”¾åœ¨å°–æ‹¬å·é‡Œï¼Œå®ƒä¿©çš„åœ°ä½ç›¸åŒã€‚</p><p>æˆ‘ä»¬çš„ç¨‹åºè·‘èµ·æ¥ï¼Œå“ªäº›èµ„æºä¼šåœ¨ä»€ä¹ˆæ—¶é—´åˆ†é…å‡ºæ¥ï¼Œå“ªäº›èµ„æºä¼šåœ¨ä»€ä¹ˆæ—¶é—´å›æ”¶ï¼Œå…¶å®æ˜¯ä¸ªè¿è¡ŒæœŸé—´çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯ä¸ªæ—¶é—´ä¸Šçš„æ¦‚å¿µã€‚ä½†å¯¹è®¡ç®—æœºæ¥è®²ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œï¼Œæ˜¯è¦èŠ±ç›¸å¯¹ç¡®å®šçš„æ—¶é—´é•¿åº¦çš„ï¼Œæ‰€ä»¥å°±åœ¨è¦æ‰§è¡Œçš„CPUæŒ‡ä»¤æ¡æ•°å’Œæ‰§è¡Œæ—¶é—´æ®µä¸Šäº§ç”Ÿäº†æ­£æ¯”æ˜ å°„å…³ç³»ã€‚è¿™å°±è®©æˆ‘ä»¬åœ¨ä»£ç çš„ç¼–è¯‘æœŸé—´å»åˆ†æè¿è¡ŒæœŸé—´å˜é‡çš„ç”Ÿå­˜æ—¶é—´åŒºé—´å˜æˆå¯èƒ½ã€‚è¿™å°±æ˜¯Rustèƒ½å¤Ÿåšç”Ÿå‘½å‘¨æœŸåˆ†æçš„åŸå› ã€‚</p><p>å½“æˆ‘ä»¬ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‚æ•°æ ‡æ³¨ <code>'a</code> çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½çŸ¥é“å®ƒæ‰€ä»£è¡¨çš„å°†è¦è¿è¡Œçš„å‡†ç¡®æ—¶é—´åŒºé—´ï¼Œæˆ–è€…è¯´ä»£ç åŒºé—´ã€‚æ¯”å¦‚å¯¹äºå‡½æ•°æ¥è¯´ï¼Œæœ‰å¯èƒ½å®ƒåªè¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿæœ‰å¯èƒ½è¿è¡Œå¤šæ¬¡ï¼Œè¿è¡Œåœ¨ä¸åŒæ¬¡æ•°çš„æ—¶å€™ï¼ŒåŒä¸€ä¸ª <code>'a</code> å‚æ•°å¯èƒ½ä»£è¡¨çš„ä»£ç åŒºé—´æ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">fn foo&lt;'a&gt;(a: &amp;'a str, b: &amp;'a str) -&gt; &amp;'a str {\n&nbsp; &nbsp; a\n}\n\nfn main() {\n    {\n        let s1 = \"abc\".to_string();\n        let s2 = \"def\".to_string();\n        let s3 = foo(&amp;s1, &amp;s2);\n        println!(\"{}\", s3);\n    }\n    // ...\n    let s4 = \"ghk\".to_string();\n    let s5 = \"uvw\".to_string();\n    let s6 = foo(&amp;s4, &amp;s5);\n    println!(\"{}\", s6);\n}\n</code></pre><p>åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>foo()</code> å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>'a</code> ä»£è¡¨çš„ç”Ÿå‘½å‘¨æœŸåŒºé—´æ˜¯åˆ°ç¬¬11è¡Œçš„èŠ±æ‹¬å·æˆªæ­¢ã€‚åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>'a</code> ä»£è¡¨çš„ç”Ÿå‘½å‘¨æœŸåŒºé—´æ˜¯åˆ°ç¬¬17è¡Œçš„èŠ±æ‹¬å·æˆªæ­¢ã€‚æ‰€ä»¥ä¸¤æ¬¡ <code>'a</code> çš„å€¼æ˜¯ä¸åŒçš„ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¦æŠŠ <code>'a</code> å«åšç”Ÿå‘½å‘¨æœŸå‚æ•°çš„åŸå› ã€‚</p><p><code>'a</code> ä»£è¡¨ä»£ç åŒºé—´æˆ–æ—¶é—´åŒºé—´ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œé€šè¿‡åˆ†ææ‰ä¼šç¡®å®šä¸‹æ¥ã€‚å› æ­¤å’Œç±»å‹å‚æ•°ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿè¦æŠŠè¿™ç§ç”Ÿå‘½å‘¨æœŸå‚æ•°æ”¾åˆ°å°–æ‹¬å·é‡Œå®šä¹‰ã€‚<strong>ç±»å‹å‚æ•°æ˜¯ç©ºé—´ä¸Šçš„å±•å¼€ï¼ˆåˆ†æï¼‰ï¼Œç”Ÿå‘½å‘¨æœŸå‚æ•°æ˜¯æ—¶é—´ä¸Šçš„å±•å¼€ï¼ˆåˆ†æï¼‰</strong>ã€‚</p><h3>å…³äº <code>'a</code> çš„è¯­æ³•å™ªéŸ³</h3><p>å‰é¢æˆ‘ä»¬è®²è§£äº†Rustå¼•å…¥ç”Ÿå‘½å‘¨æœŸåˆ†æå’Œç”Ÿå‘½å‘¨æœŸå‚æ•°æ ‡æ³¨ç¬¦å·çš„å¿…è¦æ€§å’ŒåŸå› ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œè¿™æ ·çš„ç¬¦å·å¦‚æœå¤§é‡å‡ºç°åœ¨ä»£ç ä¸­ï¼Œä¼šè®©ä»£ç å˜å¾—å¾ˆä¸‘ï¼Œå……æ»¡å™ªéŸ³ã€‚</p><p>ç¡®å®æ˜¯è¿™æ ·çš„ã€‚è‡³äºå½“åˆä¸ºä»€ä¹ˆé€‰æ‹© <code>'a</code> è¿™ç§ç¬¦å·è€Œä¸æ˜¯å…¶ä»–ç¬¦å·ï¼Œè¿™ä¸ªå°±ä¸å¾—è€ŒçŸ¥äº†ã€‚ä¹Ÿæœ‰å¯èƒ½é”®ç›˜ä¸Šçš„ç¬¦å·éƒ½å·®ä¸å¤šç”¨å®Œäº†ï¼Œæ‰€ä»¥å¥½åƒä¹Ÿæ²¡æœ‰å…¶ä»–æ›´å¥½çš„ç¬¦å·å¯ä»¥é€‰ã€‚</p><p>å¥½åœ¨ä½ å»é˜…è¯»Rustç”Ÿæ€é‡Œçš„ä»£ç çš„æ—¶å€™ï¼Œ<code>'a</code> ç¬¦å·å‡ºç°çš„é¢‘ç‡å¹¶ä¸é«˜ã€‚ç‰¹åˆ«æ˜¯åœ¨åä¸Šå±‚çš„ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹è§ä¸åˆ° <code>'a</code> ç¬¦å·ã€‚</p><h3>ä»€ä¹ˆæ—¶å€™å¯èƒ½ä¼šå†™ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Ÿ</h3><p>ä»€ä¹ˆæ—¶å€™ä¼šå€¾å‘äºå†™ç”Ÿå‘½å‘¨æœŸå‚æ•°å‘¢ï¼Ÿä¸€èˆ¬å†™åº•å±‚åº“æˆ–å¯¹ä»£ç åšæè‡´æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ã€‚</p><p>å¦‚æœåªæ˜¯å†™ä¸Šå±‚çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸ä¼šæœ‰å†™ç”Ÿå‘½å‘¨æœŸå‚æ•°ç¬¦å·çš„éœ€æ±‚ã€‚Rustçš„ä¸€äº›æœºåˆ¶æ¯”å¦‚æ™ºèƒ½æŒ‡é’ˆï¼Œèƒ½ä¿è¯æˆ‘ä»¬åœ¨åªæŒæœ‰è‡ªåŒ…å«ç±»å‹çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å¾—åˆ°éå¸¸é«˜çš„æ€§èƒ½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå†™ä»£ç æœ‰ä¸‰ä¸ªé˜¶æ®µã€‚</p><p>é¦–å…ˆæ˜¯å…ˆè·‘é€šï¼Œå®Œæˆéœ€æ±‚ã€‚Rustçš„èµ·ç‚¹è¾ƒé«˜ï¼Œä½¿ç”¨Rustå†™å‡ºæ¥çš„ä»£ç ä¸éœ€è¦æ€ä¹ˆä¼˜åŒ–ï¼Œå°±èƒ½è®©ä½ åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹èµ¢åœ¨èµ·è·‘çº¿ä¸Šã€‚</p><p>ç¬¬äºŒé˜¶æ®µæ˜¯ï¼Œè¿½æ±‚æ¶æ„ä¸Šçš„ç¾æ„Ÿã€‚å½“ä½ å®Œæˆç¬¬ä¸€é˜¶æ®µéªŒè¯ï¼Œå¹¶ç¨³å®šè¿è¡Œåï¼Œä½ å¯èƒ½ä¼šè¿½æ±‚æ›´å¥½çš„æ¶æ„ï¼Œæ›´æ¼‚äº®çš„ä»£ç ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ å¯ä»¥åœ¨Rustä¸­çš„æ‰€æœ‰æƒä¸‰æ€ç†è®ºã€å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿã€çµæ´»çš„traitæŠ½è±¡èƒ½åŠ›çš„æŒ‡å¯¼ä¸‹é‡æ„ä½ çš„é¡¹ç›®ã€‚æœ‰èªæ˜çš„Rustå°åŠ©æ‰‹åœ¨ï¼Œä½ çš„é‡æ„ä¹‹è·¯ä¼šå˜å¾—å¼‚å¸¸è½»æ¾ã€‚</p><p>ç¬¬ä¸‰ä¸ªé˜¶æ®µæ‰æ˜¯å½“ä½ åœ¨ä¸šåŠ¡ä¸ŠçœŸæ­£é‡åˆ°æ€§èƒ½ç“¶é¢ˆçš„æ—¶å€™ï¼Œå†å›è¿‡å¤´æ¥ä¼˜åŒ–ã€‚Rustæé«˜çš„ä¸Šé™å’Œå¯å®¹çº³ä»»ä½•æœºåˆ¶çš„èƒ½åŠ›ï¼Œè®©ä½ æ— éœ€å€ŸåŠ©å…¶ä»–è¯­è¨€å°±èƒ½å®Œæˆä¼˜åŒ–ä»»åŠ¡ã€‚ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨å¼•ç”¨å’Œç”Ÿå‘½å‘¨æœŸåˆ†æï¼Œå‡å°‘å†…å­˜åˆ†é…æ¬¡æ•°ï¼Œä»è€Œæå‡æ€§èƒ½ã€‚å½“ç„¶ï¼Œæ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€é¡¹ç»¼åˆæ€§çš„è¯¾é¢˜ï¼ŒRustä¸èƒ½å¸®ä½ è§£å†³æ‰€æœ‰é—®é¢˜ã€‚</p><h3>å…³äºAPIçš„æœ€ä½³å®è·µ</h3><p>åœ¨åº“çš„APIè®¾è®¡ä¸Šï¼ŒRustç¤¾åŒºæœ‰ä¸€æ¡å…±è¯†ï¼šä¸è¦å‘å¤–æš´éœ²ç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚è¿™æ ·æ‰èƒ½è®©APIçš„ä½¿ç”¨æ›´ç®€å•ï¼Œå¹¶ä¸”ä¸ä¼šæŠŠç”Ÿå‘½å‘¨æœŸç¬¦å·ä¼ æŸ“åˆ°ä¸Šå±‚ã€‚</p><p>ä¸€ä¸ªåä¾‹å°±æ˜¯stdé‡ŒCowç±»å‹çš„è®¾è®¡ï¼Œå¯¼è‡´ç°åœ¨å¾ˆå°‘æœ‰äººä¼šä¼˜å…ˆé€‰æ‹©ä½¿ç”¨Cowç±»å‹ã€‚</p><pre><code class=\"language-plain\">pub enum Cow&lt;'a, B&gt; {}\n</code></pre><p>ä½ å¯ä»¥æŸ¥é˜…<a href=\"https://doc.rust-lang.org/std/borrow/enum.Cow.html\">é“¾æ¥</a>äº†è§£æ›´å¤šå†…å®¹ã€‚</p><h2>å°ç»“</h2><p>æ‰€æœ‰æƒã€å€Ÿç”¨ï¼ˆå¼•ç”¨ï¼‰ã€ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸‰å…„å¼Ÿæ˜¯Rustä¸­çš„ä¸€å¥—é«˜åº¦è€¦åˆçš„æ¦‚å¿µï¼Œå®ƒä»¬å…±åŒæ‰¿æ‹…èµ·äº†Ruståº•å±‚çš„è„æ´»ç´¯æ´»ï¼Œå½»åº•æ‰«æ¸…äº†æœ€å›°éš¾çš„éšœç¢â€”â€”æ­£ç¡®é«˜æ•ˆåœ°ç®¡ç†å†…å­˜èµ„æºï¼Œä¸ºRustå®ç°å®‰å…¨ç¼–ç¨‹å’Œé«˜æ€§èƒ½ç¼–ç¨‹æ‰“ä¸‹äº†æœ€åšå®çš„åŸºç¡€ã€‚</p><p>æ‰€æœ‰æƒè´¯ç©¿äº†Rustè¯­è¨€çš„æ‰€æœ‰ä¸»è¦ç‰¹æ€§ï¼Œå¯¹åº”åœ°ï¼Œå¦‚æœä½ ç»§ç»­æ·±å…¥é’»ç ”ä¸‹å»ï¼Œä½ ä¼šå‘ç°ç”Ÿå‘½å‘¨æœŸæ¦‚å¿µä¹Ÿä¼šè´¯ç©¿é‚£äº›ç‰¹æ€§ã€‚ä½†æ˜¯å¦å¤–ä¸€æ–¹é¢ï¼Œåˆå­¦Rustä¹Ÿä¼šæœ‰ä¸¤ä¸ªå…¸å‹çš„è®¤çŸ¥é”™è¯¯ã€‚</p><ol>\n<li>æˆ‘å¾—æŠŠç”Ÿå‘½å‘¨æœŸå½»åº•æŒæ¡ï¼Œæ‰ç®—å­¦ä¼šRustã€‚</li>\n<li>ç”Ÿå‘½å‘¨æœŸå¤ªéš¾ï¼Œæˆ‘è¿ˆä¸è¿‡å»åªèƒ½æ”¾å¼ƒã€‚</li>\n</ol><p>å¯¹è¿™ä¸¤ç§è®¤çŸ¥ï¼Œæˆ‘æƒ³è¯´ï¼šå³ä½¿ä½ æŠŠç”Ÿå‘½å‘¨æœŸæŒæ¡å¾—å¾ˆæºœï¼Œä¹Ÿä¸ä»£è¡¨ä½ å°±èƒ½ç”¨å¥½Rustã€‚Rustæ˜¯ä¸€é—¨é¢å‘å®ç”¨çš„è¯­è¨€ï¼Œå°†Rustç”¨å¥½æ¶‰åŠå¤§é‡çš„é¢†åŸŸçŸ¥è¯†ï¼Œè¿™äº›éƒ½éœ€è¦ä½ èŠ±æ—¶é—´å»å­¦ä¹ ã€‚éœ€è¦ä½ æœ‰æ•ˆåœ°åˆ†é…æ—¶é—´ã€‚å‰æœŸåˆå­¦çš„æ—¶å€™åŸºæœ¬ç¢°ä¸åˆ°å†™ç”Ÿå‘½å‘¨æœŸç¬¦å·çš„æœºä¼šï¼Œç†è§£åˆ°è¿™èŠ‚è¯¾æ‰€è¦†ç›–çš„å†…å®¹å°±å·®ä¸å¤šäº†ã€‚æ‰€ä»¥ä½ ä¸è¦æƒ§æ€•è¿™ä¸ªæ¦‚å¿µï¼Œç”¨Rustæ¥è§£å†³ä½ çš„å®é™…é—®é¢˜ï¼Œä¸è¦å®³æ€•cloneã€‚</p><p>Rustç‰µæ¶‰é¢è¿‡äºå¹¿æ³›ï¼Œå­¦ä¹ è¯­è¨€ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œåº”è¯¥ä»¥å®ç”¨ä¸ºä¸»ï¼Œå­¦ä»¥è‡´ç”¨ï¼Œè¾¹å­¦è¾¹ç”¨ã€‚Rustæ²¡æœ‰å¤©èŠ±æ¿ï¼Œè¿™ä¹Ÿæ„å‘³ç€ä½ çš„æˆé•¿ä¹Ÿä¸ä¼šæœ‰ä¸Šé™ï¼ŒåŠ æ²¹å§ï¼</p><p><img src=\"https://static001.geekbang.org/resource/image/84/d0/84bcee8370aca3dacaeac720f01af6d0.jpg?wh=2746x2517\" alt=\"\"></p><h2>æ€è€ƒé¢˜</h2><p>ä½ èƒ½è¯´ä¸€è¯´ç”Ÿå‘½å‘¨æœŸç¬¦å· <code>'a</code> æ”¾åœ¨ <code>&lt;&gt;</code> ä¸­å®šä¹‰çš„åŸå› å’Œæ„ä¹‰å—ï¼Ÿæ¬¢è¿ä½ æŠŠè‡ªå·±çš„ç†è§£åˆ†äº«åˆ°è¯„è®ºåŒºï¼Œå¦‚æœä½ è§‰å¾—æœ‰æ”¶è·çš„è¯ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"19ï½œRustçš„å®ä½“ç³»ï¼šä¸ºè‡ªå·±çš„é¡¹ç›®å†™ä¸€ä¸ªç®€å•çš„å£°æ˜å®","id":731043},"right":{"article_title":"ç­”ç–‘è¯¾å ‚ï¼ˆä¸€ï¼‰ï½œç¬¬ä¸€ç« RuståŸºç¡€ç¯‡æ€è€ƒé¢˜ç­”æ¡ˆ","id":732080}},"comments":[{"had_liked":false,"id":385153,"user_name":"buoge","can_delete":false,"product_type":"c1","uid":1018506,"ip_address":"åŒ—äº¬","ucode":"646FC6717A09BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/8a/7c1baa25.jpg","comment_is_top":false,"comment_ctime":1702211015,"is_pvip":false,"replies":[{"id":140394,"content":"yeah","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1702251929,"ip_address":"é‡åº†","comment_id":385153,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ä¸‹å‘¨å¯ä»¥å®æˆ˜äº†ï¼Œå¥½å¼€å¿ƒğŸ˜","like_count":5,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633478,"discussion_content":"yeah","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1702251929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386651,"user_name":"seven9t","can_delete":false,"product_type":"c1","uid":1979955,"ip_address":"å¹¿ä¸œ","ucode":"B7CA7D62C56938","user_header":"https://static001.geekbang.org/account/avatar/00/1e/36/33/3411df0d.jpg","comment_is_top":false,"comment_ctime":1705290652,"is_pvip":false,"replies":[{"id":140977,"content":"ä½ çš„å»ºè®®ä¸é”™ã€‚è¿™æ®µçš„æ„æ€å…¶å®æ˜¯è¦è¯´æ˜æŒ‡ä»¤åºåˆ—çš„æ‰§è¡Œéœ€è¦å ç”¨ä¸€æ®µæ—¶é—´ï¼Œä»¥å¯¹åº”ä¸€æ®µç”Ÿå‘½å‘¨æœŸã€‚å…·ä½“æè¿°ä¸Šè¿˜å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼Œæ„Ÿè°¢ğŸ™","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1705410996,"ip_address":"é‡åº†","comment_id":386651,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"&quot;ä½†å¯¹è®¡ç®—æœºæ¥è®²ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œï¼Œæ˜¯è¦èŠ±ç›¸å¯¹ç¡®å®šçš„æ—¶é—´é•¿åº¦çš„ï¼Œæ‰€ä»¥å°±åœ¨è¦æ‰§è¡Œçš„ CPU æŒ‡ä»¤æ¡æ•°å’Œæ‰§è¡Œæ—¶é—´æ®µä¸Šäº§ç”Ÿäº†æ­£æ¯”æ˜ å°„å…³ç³»ã€‚è¿™å°±è®©æˆ‘ä»¬åœ¨ä»£ç çš„ç¼–è¯‘æœŸé—´å»åˆ†æè¿è¡ŒæœŸé—´å˜é‡çš„ç”Ÿå­˜æ—¶é—´åŒºé—´å˜æˆå¯èƒ½ã€‚è¿™å°±æ˜¯ Rust èƒ½å¤Ÿåšç”Ÿå‘½å‘¨æœŸåˆ†æçš„åŸå› ã€‚&quot;  é™æ€åˆ†æå’ŒæŒ‡ä»¤æ‰§è¡Œæ—¶é—´åº”è¯¥æ²¡å…³ç³»ï¼Œå»ºè®®è°ƒæ•´","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635967,"discussion_content":"ä½ çš„å»ºè®®ä¸é”™ã€‚è¿™æ®µçš„æ„æ€å…¶å®æ˜¯è¦è¯´æ˜æŒ‡ä»¤åºåˆ—çš„æ‰§è¡Œéœ€è¦å ç”¨ä¸€æ®µæ—¶é—´ï¼Œä»¥å¯¹åº”ä¸€æ®µç”Ÿå‘½å‘¨æœŸã€‚å…·ä½“æè¿°ä¸Šè¿˜å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼Œæ„Ÿè°¢ğŸ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705410996,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384820,"user_name":"ä¼¯é˜³","can_delete":false,"product_type":"c1","uid":1596631,"ip_address":"åŒ—äº¬","ucode":"DBDC8735AA54AD","user_header":"https://static001.geekbang.org/account/avatar/00/18/5c/d7/3b92bb0d.jpg","comment_is_top":false,"comment_ctime":1701636996,"is_pvip":false,"replies":[{"id":140315,"content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701740383,"ip_address":"é‡åº†","comment_id":384820,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"Rust ç‰µæ¶‰é¢è¿‡äºå¹¿æ³›ï¼Œå­¦ä¹ è¯­è¨€ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œåº”è¯¥ä»¥å®ç”¨ä¸ºä¸»ï¼Œå­¦ä»¥è‡´ç”¨ï¼Œè¾¹å­¦è¾¹ç”¨ã€‚Rust æ²¡æœ‰å¤©èŠ±æ¿ï¼Œæ„Ÿè§‰å­¦æ— æ­¢å¢ƒï¼Œå­¦ä¹ ä»»ä½•ä¸€é¡¹çŸ¥è¯†éƒ½æ˜¯å­¦ä»¥è‡´ç”¨","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632985,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701740383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384935,"user_name":"eriklee","can_delete":false,"product_type":"c1","uid":2826132,"ip_address":"åŒ—äº¬","ucode":"6F755DB7C29DD6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIyhbzdkFM64Npva5ZKf4IPwhy6rDAX0L77QNESbalnXhnGKibcTbwtSaNC0hO6z0icO8DYI9Nf4xwg/132","comment_is_top":false,"comment_ctime":1701827741,"is_pvip":false,"replies":[{"id":140379,"content":"å¯¹çš„å¯¹çš„ï¼Œæ˜¯è¿™æ ·æ»´","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701919646,"ip_address":"é‡åº†","comment_id":384935,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"rustç¼–è¯‘å™¨ä¹Ÿåœ¨ä¸æ–­è¿›åŒ–ï¼Œå®é™…ä¸Š2021ç‰ˆå°±æ¯”2018ç‰ˆå°‘äº†å¾ˆå¤šéœ€è¦ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨çš„åœºæ™¯ï¼Œæˆ‘ç›¸ä¿¡éšç€rustç¼–è¯‘å™¨çš„è¿›åŒ–ï¼Œä»¥åå¯èƒ½åªæœ‰1%çš„åœºæ™¯éœ€è¦ç”¨åˆ°ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633234,"discussion_content":"å¯¹çš„å¯¹çš„ï¼Œæ˜¯è¿™æ ·æ»´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701919646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":385016,"user_name":"cfanbo","can_delete":false,"product_type":"c1","uid":1043738,"ip_address":"æ¾³å¤§åˆ©äºš","ucode":"39D8D71453E575","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/1a/269eb3d6.jpg","comment_is_top":false,"comment_ctime":1701935962,"is_pvip":false,"replies":[{"id":140381,"content":"å¯¹çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701958157,"ip_address":"é‡åº†","comment_id":385016,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"åœ¨ â€œå‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨â€ è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ç†è§£ä¸º è¿”å›çš„å€¼æ˜¯s1, ä½†å®ƒçš„ç”Ÿå‘½å‘¨æœŸå´æ˜¯s2çš„ç”Ÿå‘½å‘¨æœŸï¼Œå› æ­¤å¯¼è‡´æœ€åæ‰“å°è¯­å¥æ‰§è¡Œå‰, ç”±äº s2 ç”Ÿå‘½å‘¨æœŸåŸå› è¢«dropï¼Œè€Œå¯¼è‡´ç¼–è¯‘å‡ºé”™ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633294,"discussion_content":"å¯¹çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701958157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384910,"user_name":"PEtFiSh","can_delete":false,"product_type":"c1","uid":1765926,"ip_address":"å››å·","ucode":"C4922398A92E05","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLO6XvxfFPMGcVSSX8uIZY2yib29qlyat178pU4QM3gIic5GXZ8PC0tzRiazP3FiajXbTj19SE4ZhV0gQ/132","comment_is_top":false,"comment_ctime":1701776355,"is_pvip":false,"replies":[{"id":140372,"content":"å¯ä»¥ç±»ä¼¼ç†è§£ï¼Œä¸è¿‡â€˜aä¸æ˜¯ç±»å‹ï¼Œå‡†ç¡®æœ¯è¯­å« generic lifetime parameter ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701919278,"ip_address":"é‡åº†","comment_id":384910,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œçœ‹åˆ°&lt;&gt;å°±æ˜¯è¦å¹²æ´»çš„ã€‚&lt;&#39;a&gt;å¯ä»¥ç†è§£ä¸ºä¸€ç§ç‰¹æ®Šçš„ç±»å‹å‚æ•°ï¼Œç¼–è¯‘å™¨çœ‹åˆ°&lt;&gt;é‡Œçš„&#39;aå¹¶ä¸ä¼šå¯¹ç±»å‹åšå±•å¼€ï¼Œè€Œæ˜¯å»æ£€æŸ¥å¹¶è®¡ç®—å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633227,"discussion_content":"å¯ä»¥ç±»ä¼¼ç†è§£ï¼Œä¸è¿‡â€˜aä¸æ˜¯ç±»å‹ï¼Œå‡†ç¡®æœ¯è¯­å« generic lifetime parameter ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701919278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384873,"user_name":"Geek_e72251","can_delete":false,"product_type":"c1","uid":3733050,"ip_address":"å¹¿ä¸œ","ucode":"894904DE2E6AC0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VF71Gcf2C2bjYPFCRv0TPfwhkJmT5WhtusltuaXQM0KMDibdallNFypqWV6v2FJ4bqNwzujiaF5LEDeia7JMZTTtw/132","comment_is_top":false,"comment_ctime":1701705278,"is_pvip":false,"replies":[{"id":140327,"content":"å“ˆå“ˆï¼Œè¿™ä¸ªè¯¾ç¨‹ä¹‹åæˆ‘è¿˜ä¼šæŒç»­è¾“å‡ºçš„ï¼Œå¯ä»¥å…³æ³¨è¿™æ–¹é¢çš„å†…å®¹ã€‚rusté¢†åŸŸå¤ªå¹¿æ³›äº†ï¼Œå€¼å¾—ç ”ç©¶ä¸€è¾ˆå­","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701745864,"ip_address":"","comment_id":384873,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"è¿˜æ²¡åˆ°å®æˆ˜å°±å·²ç»63%çš„è¿›åº¦äº†ğŸ˜­å®æˆ˜å†…å®¹ä¸ä¼šå¾ˆå°‘å§ã€‚å¸Œæœ›èƒ½å¤Ÿæœ‰æ€ä¹ˆdebugçš„æ•™å­¦ã€‚","like_count":1,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":633009,"discussion_content":"å“ˆå“ˆï¼Œè¿™ä¸ªè¯¾ç¨‹ä¹‹åæˆ‘è¿˜ä¼šæŒç»­è¾“å‡ºçš„ï¼Œå¯ä»¥å…³æ³¨è¿™æ–¹é¢çš„å†…å®¹ã€‚rusté¢†åŸŸå¤ªå¹¿æ³›äº†ï¼Œå€¼å¾—ç ”ç©¶ä¸€è¾ˆå­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701745864,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384827,"user_name":"-","can_delete":false,"product_type":"c1","uid":1546505,"ip_address":"åŒ—äº¬","ucode":"7B34258D346793","user_header":"https://static001.geekbang.org/account/avatar/00/17/99/09/29c46a7b.jpg","comment_is_top":false,"comment_ctime":1701652076,"is_pvip":false,"replies":[{"id":140317,"content":"è‡ªå·±åŠ¨æ‰‹åšå®éªŒå¾—æ¥çš„çŸ¥è¯†ï¼ŒçœŸæ£’ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1701740477,"ip_address":"é‡åº†","comment_id":384827,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"struct A {\n    foo: String,\n}\n\nimpl A {\n    fn play&lt;&#39;a&gt;(&amp;&#39;a self, a: &amp;&#39;a str, b: &amp;str) -&gt; &amp;str {\n        a\n    }\n}\nè¿”å›açš„æ—¶å€™åªéœ€è¦æ ‡æ³¨aå‚æ•°ï¼Œè€Œè¿”å›bçš„æ—¶å€™åªéœ€è¦æ ‡å‡†bå‚æ•°ï¼Œè¿™é‡Œè¿›ä¸€æ­¥è¯´æ˜äº†ç±»å‹æ ‡æ³¨åªå…³æ³¨ä¼ å…¥ä¼ å‡º","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":632987,"discussion_content":"è‡ªå·±åŠ¨æ‰‹åšå®éªŒå¾—æ¥çš„çŸ¥è¯†ï¼ŒçœŸæ£’ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1701740477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389992,"user_name":"Calvin","can_delete":false,"product_type":"c1","uid":1603004,"ip_address":"å¹¿ä¸œ","ucode":"0EEF5B207623B5","user_header":"https://static001.geekbang.org/account/avatar/00/18/75/bc/89d88775.jpg","comment_is_top":false,"comment_ctime":1714044190,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ã€å‡½æ•°è¿”å›å€¼ä¸­çš„å¼•ç”¨ã€‘ä¸€ä¸ªå‡½æ•°ä¸­è¿”å›ä¸€ä¸ªç±»å‹çš„å¼•ç”¨çš„ç¬¬ä¸€ç§å¯èƒ½çš„æƒ…å†µï¼ˆè¿”å›å¯¹å¤–éƒ¨å…¨å±€å˜é‡çš„å¼•ç”¨ï¼‰ç¤ºä¾‹çš„ foo() å‡½æ•°çš„è¿”å›å€¼ç±»å‹åº”è¯¥ä¹Ÿéœ€è¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‚æ•°æ ‡æ³¨ï¼š\nstatic ASTRING: &amp;&#39;static str = &quot;abc&quot;;\nfn foo() -&gt; &amp;&#39;static str {    &#47;&#47; é»˜è®¤çš„å…¨å±€ &#39;static\n    ASTRING\n}\næˆ–ï¼š\nstatic ASTRING: &amp;&#39;static str = &quot;abc&quot;;\nfn foo&lt;&#39;a&gt;() -&gt; &amp;&#39;a str {    &#47;&#47; è‡ªå®šä¹‰çš„ &#39;a\n    ASTRING\n}","like_count":0},{"had_liked":false,"id":384819,"user_name":"ä¼¯é˜³","can_delete":false,"product_type":"c1","uid":1596631,"ip_address":"åŒ—äº¬","ucode":"DBDC8735AA54AD","user_header":"https://static001.geekbang.org/account/avatar/00/18/5c/d7/3b92bb0d.jpg","comment_is_top":false,"comment_ctime":1701636950,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"Rust ç‰µæ¶‰é¢è¿‡äºå¹¿æ³›ï¼Œå­¦ä¹ è¯­è¨€ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œåº”è¯¥ä»¥å®ç”¨ä¸ºä¸»ï¼Œå­¦ä»¥è‡´ç”¨ï¼Œè¾¹å­¦è¾¹ç”¨ã€‚Rust æ²¡æœ‰å¤©èŠ±æ¿","like_count":0}]}