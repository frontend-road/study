{"id":801726,"title":"02ï½œMySQLè´¦å·å’Œæƒé™ç®¡ç†","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿Šè¾¾ã€‚</p><p>åœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å®‰è£…MySQLçš„å‡ ç§æ–¹æ³•ã€‚MySQLå®‰è£…å¥½ä¹‹åï¼Œç³»ç»Ÿé»˜è®¤å»ºå¥½äº†root@localhostç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½åœ¨MySQLæœåŠ¡å™¨ä¸Šç™»å½•æœ¬åœ°çš„æ•°æ®åº“ã€‚rootè´¦å·æ‹¥æœ‰æ•°æ®åº“æ‰€æœ‰çš„æƒé™ï¼Œå¯ä»¥æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› æ­¤æˆ‘å»ºè®®åº”ç”¨ç¨‹åºä¸è¦ä½¿ç”¨rootè´¦å·è®¿é—®æ•°æ®åº“ï¼Œè¿™å­˜åœ¨å¾ˆå¤§çš„å®‰å…¨éšæ‚£ã€‚</p><p>æˆ‘ä»¬éœ€è¦æ ¹æ®å„ä¸ªä¸šåŠ¡æ–¹çš„è®¿é—®éœ€æ±‚ï¼Œåˆ†åˆ«åˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼Œå¹¶æˆäºˆåˆç†çš„æƒé™ã€‚åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•åˆ›å»ºå’Œç®¡ç†æ•°æ®åº“ç”¨æˆ·ï¼Œä»¥åŠå¦‚ä½•ç»™ç”¨æˆ·æˆæƒã€‚</p><h2>ç”¨æˆ·ç®¡ç†</h2><p>æˆ‘ä»¬ä½¿ç”¨create userå‘½ä»¤åˆ›å»ºç”¨æˆ·ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹å‘½ä»¤çš„åŸºæœ¬æ ¼å¼ã€‚</p><pre><code class=\"language-plain\">create user 'username'@'host' identified by 'complex_password';\n</code></pre><p>åœ¨MySQLä¸­ï¼Œä¸€ä¸ªç”¨æˆ·ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œusernameæ˜¯ç”¨æˆ·åï¼Œhostæ˜¯å…è®¸ç™»å½•æ•°æ®åº“çš„å®¢æˆ·ç«¯çš„ä¸»æœºåæˆ–IPã€‚hostä¸­å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä½¿ç”¨ç™¾åˆ†å· <code>\"%\"</code> åŒ¹é…ä»»æ„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿ <code>\"_\"</code> åŒ¹é…ä¸€ä¸ªå­—ç¬¦ã€‚æ¯”å¦‚æˆ‘ä»¬ä¸‹é¢åˆ›å»ºçš„è¿™ä¸ªç”¨æˆ·ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç™»å½•æ•°æ®åº“ã€‚</p><pre><code class=\"language-plain\">create user 'u01'@'%' identified by 'somepassword';\n</code></pre><p>åˆ›å»ºè´¦å·æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨IPåœ°å€æ®µæ¥æŒ‡å®šå®¢æˆ·ç«¯IPèŒƒå›´ï¼Œæ¯”å¦‚ä¸‹é¢åˆ›å»ºçš„u02ç”¨æˆ·å¯ä»¥åœ¨172.16è¿™ä¸ªç½‘æ®µå†…è®¿é—®æ•°æ®åº“ã€‚</p><!-- [[[read_end]]] --><pre><code class=\"language-plain\">create user 'u02'@'172.16.0.0/16' identified by 'somepassword';\n</code></pre><h3>ç”¨æˆ·æ¡ç›®çš„ä¼˜å…ˆçº§</h3><p>MySQLå…è®¸åˆ›å»ºusernameç›¸åŒï¼Œä½†hostä¸åŒçš„ç”¨æˆ·ã€‚</p><pre><code class=\"language-plain\">create user 'u03'@'%' identified by 'somepassword';\ncreate user 'u03'@'172.16.0.0/16' identified by 'somepassword';\ncreate user 'u03'@'mysql02' identified by 'somepassword';\ncreate user 'u03'@'172.16.121.%' identified by 'somepassword';\ncreate user 'u03'@'172.16.121.237' identified by 'somepassword';\n</code></pre><p>æˆ‘ä»¬ä¸Šé¢åˆ›å»ºäº†5ä¸ªç”¨æˆ·ï¼Œè™½ç„¶ç”¨æˆ·åéƒ½æ˜¯u03ï¼Œä½†è¿™æ˜¯5ä¸ªä¸åŒçš„ç”¨æˆ·ï¼Œå¯ä»¥åˆ†åˆ«ç»™è¿™5ä¸ªç”¨æˆ·è®¾ç½®ä¸åŒçš„å¯†ç ã€æˆäºˆä¸åŒçš„æƒé™ã€‚ä½ å¯ä»¥åœ¨mysql.userè¡¨ä¸­æŸ¥è¯¢åˆ°è¿™äº›ç”¨æˆ·ã€‚</p><pre><code class=\"language-plain\">mysql&gt; select user,host from mysql.user where user='u03';\n+------+----------------+\n| user | host           |\n+------+----------------+\n| u03  | %              |\n| u03  | 172.16.0.0/16  |\n| u03  | 172.16.121.%   |\n| u03  | 172.16.121.237 |\n| u03  | mysql02        |\n+------+----------------+\n5 rows in set (0.00 sec)\n</code></pre><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“ä½¿ç”¨u03è¿™ä¸ªç”¨æˆ·åç™»å½•æ•°æ®åº“æ—¶ï¼ŒæœåŠ¡ç«¯åº”è¯¥ä½¿ç”¨å“ªæ¡ç”¨æˆ·ä¿¡æ¯æ¥éªŒè¯ç”¨æˆ·å¯†ç å‘¢ï¼Ÿä¸ä¹‹ç›¸å…³çš„è¿˜æœ‰å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œä½¿ç”¨u03ç™»å½•æ•°æ®åº“åï¼Œæˆ‘æ€ä¹ˆçŸ¥é“å½“å‰ç™»å½•çš„æ˜¯å“ªä¸ªu03ï¼Ÿæˆ‘ä»¬å…ˆæ¥å›ç­”åé¢è¿™ä¸ªé—®é¢˜ï¼Œç™»å½•æ•°æ®åº“ä¹‹åï¼Œå¯ä»¥ç”¨å‡½æ•°current_useræ¥è·å–å½“å‰çš„ç™»å½•ç”¨æˆ·ï¼Œæˆ–è€…ç”¨show grantså‘½ä»¤ä¹Ÿèƒ½çœ‹åˆ°å½“å‰çš„ç™»å½•ç”¨æˆ·ã€‚</p><pre><code class=\"language-plain\"># mysql -u u03 -psomepassword -h172.16.121.234\n\nmysql&gt; select current_user();\n+-------------------+\n| current_user()    |\n+-------------------+\n| u03@172.16.0.0/16 |\n+-------------------+\n1 row in set (0.01 sec)\n\n\nmysql&gt; show grants;\n+---------------------------------------------+\n| Grants for u03@172.16.0.0/16                |\n+---------------------------------------------+\n| GRANT USAGE ON *.* TO `u03`@`172.16.0.0/16` |\n+---------------------------------------------+\n1 row in set (0.00 sec)\n</code></pre><p>è‡³äºå‰é¢é‚£ä¸ªé—®é¢˜ï¼Œç”¨æˆ·è¡¨ä¸­çš„æ¯ä¸€è¡Œè®°å½•ï¼Œéƒ½æœ‰ç›¸åº”çš„ä¼˜å…ˆçº§ã€‚MySQLä¼šæŠŠæ‰€æœ‰çš„ç”¨æˆ·è®°å½•æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½çš„é¡ºåºæ’åˆ—ï¼Œç¼“å­˜åˆ°å†…å­˜é‡Œã€‚æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘èµ·çš„è¿æ¥è¯·æ±‚åï¼Œä»è¯·æ±‚åŒ…ä¸­è§£æå‡ºç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œä»tcpè¿æ¥ä¿¡æ¯ä¸­å¾—åˆ°å®¢æˆ·ç«¯çš„IPï¼Œç„¶åä¾æ¬¡åŒ¹é…ç¼“å­˜çš„ç”¨æˆ·è®°å½•åˆ—è¡¨ä¸­çš„æ¡ç›®ã€‚</p><p>å…ˆåŒ¹é…hostå­—æ®µï¼Œå¦‚æœhoståŒ¹é…ï¼Œå†åŒ¹é…ç”¨æˆ·åï¼Œç”¨æˆ·åä¹ŸåŒ¹é…åï¼Œå†éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœåŒ¹é…ä¸åˆ°å¯¹åº”çš„ç”¨æˆ·è®°å½•ï¼Œæˆ–å¯†ç ä¸æ­£ç¡®ï¼Œæˆ–å­˜åœ¨å…¶å®ƒé—®é¢˜ï¼ŒæœåŠ¡ç«¯ä¼šæŠŠé”™è¯¯ä¿¡æ¯å‘é€ç»™å®¢æˆ·ç«¯ã€‚ç”¨æˆ·éªŒè¯æˆåŠŸåï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥å¼€å§‹æ‰§è¡Œå„ç±»å‘½ä»¤æˆ–SQLï¼Œæ­¤æ—¶æœåŠ¡ç«¯ä¼šéªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡Œè¿™äº›å‘½ä»¤å’ŒSQLã€‚</p><p>mysql.userè¡¨ä¸­ç”¨æˆ·æ¡ç›®çš„ä¼˜å…ˆçº§å¦‚ä½•ç¡®å®šå‘¢ï¼Ÿ</p><p>åŸºæœ¬çš„è§„åˆ™æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>IPæ¡ç›®çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚IPæ¡ç›®ä¸­æ²¡æœ‰é€šé…ç¬¦ï¼Œç²¾ç¡®çš„IPå’ŒIPåœ°å€æ®µéƒ½æ˜¯IPæ¡ç›®ã€‚</li>\n<li>ç²¾ç¡®IPçš„ä¼˜å…ˆçº§æ¯”IPåœ°å€æ®µçš„ä¼˜å…ˆçº§é«˜ã€‚</li>\n<li>å¯¹äº2ä¸ªIPåœ°å€æ®µï¼Œå‰ç¼€é•¿çš„ä¼˜å…ˆçº§æ›´é«˜ã€‚æ¯”å¦‚172.16.121.0/24ä¼˜å…ˆçº§æ¯”172.16.0.0/16é«˜ã€‚</li>\n<li>ä¸ä½¿ç”¨é€šé…ç¬¦çš„æ¡ç›®æ¯”ä½¿ç”¨é€šé…ç¬¦çš„æ¡ç›®ä¼˜å…ˆçº§é«˜ã€‚</li>\n<li>å¯¹äºéƒ½ä½¿ç”¨äº†é€šé…ç¬¦çš„æ¡ç›®ï¼Œåˆ™æ ¹æ®ç¬¬ä¸€ä¸ªé€šé…ç¬¦åœ¨hostå­—æ®µä¸­å‡ºç°çš„ä½ç½®æ¥åˆ¤æ–­ä¼˜å…ˆçº§ã€‚é€šé…ç¬¦å‡ºç°çš„ä½ç½®è¶Šé å‰ï¼Œä¼˜å…ˆçº§è¶Šä½ã€‚æ¯”å¦‚ <code>'%'</code> çš„ä¼˜å…ˆçº§æœ€ä½ï¼Œ<code>'abc%'</code> çš„ä¼˜å…ˆçº§æ¯” <code>'abcd%'</code> ä½ã€‚</li>\n</ol><p>åœ¨æˆ‘ä»¬å‰é¢çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œu03çš„5æ¡ç”¨æˆ·æ¡ç›®æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åºåæ˜¯è¿™æ ·çš„ã€‚</p><pre><code class=\"language-plain\">'u03'@'172.16.121.237'\n'u03'@'172.16.0.0/16'\n'u03'@'mysql02'\n'u03'@'172.16.121.%'\n'u03'@'%'\n</code></pre><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ä¾‹å­æ¥è¿›è¡ŒéªŒè¯ã€‚</p><ul>\n<li>å®¢æˆ·ç«¯åœ°å€ä¸º172.16.121.236ï¼ŒåŒ¹é…åˆ°çš„ç”¨æˆ·æ¡ç›®ä¸º <code>'u03'@'172.16.0.0/16'</code>ã€‚</li>\n</ul><pre><code class=\"language-plain\">[root@172-16-121-236 ~]# mysql -u u03 -psomepassword -h172.16.121.234 -e 'select current_user()'\n+-------------------+\n| current_user()    |\n+-------------------+\n| u03@172.16.0.0/16 |\n+-------------------+\n</code></pre><ul>\n<li>å®¢æˆ·ç«¯åœ°å€ä¸º172.16.121.237ï¼ŒåŒ¹é…åˆ°çš„ç”¨æˆ·æ¡ç›®ä¸º <code>'u03'@'172.16.121.237'</code>ã€‚</li>\n</ul><pre><code class=\"language-plain\">[root@172-16-121-237 ~]# mysql -u u03 -psomepassword -h172.16.121.234 -e 'select current_user()'\n+--------------------+\n| current_user()     |\n+--------------------+\n| u03@172.16.121.237 |\n+--------------------+\n</code></pre><ul>\n<li>å®¢æˆ·ç«¯åœ°å€ä¸º192.168.x.xï¼ŒåŒ¹é…åˆ°çš„ç”¨æˆ·æ¡ç›®ä¸º <code>'u03'@'%'</code>ã€‚</li>\n</ul><pre><code class=\"language-plain\">mysql -u u03 -psomepassword -h172.16.121.234 -e 'select current_user()'\nmysql: [Warning] Using a password on the command line interface can be insecure.\n+----------------+\n| current_user() |\n+----------------+\n| u03@%          |\n+----------------+\n</code></pre><p>å‰é¢æˆ‘ä»¬æåˆ°äº†ï¼ŒæœåŠ¡ç«¯ä¼šæ ¹æ®å®¢æˆ·ç«¯çš„IPåœ°å€æ¥æŸ¥æ‰¾ç”¨æˆ·æ¡ç›®ã€‚MySQLæ€ä¹ˆåˆ¤æ–­æŸä¸ªå®¢æˆ·ç«¯è·ŸæŸä¸ªä¸»æœºåç›¸åŒ¹é…å‘¢ï¼ŸæœåŠ¡ç«¯éœ€è¦å°†å®¢æˆ·ç«¯çš„IPåè§£ææˆä¸»æœºåï¼Œç„¶åæ‰èƒ½è¿›è¡Œåˆ¤æ–­ã€‚æ¯”å¦‚MySQLæœåŠ¡å™¨çš„/etc/hostsæœ‰ä¸‹é¢è¿™æ¡ä¿¡æ¯ã€‚</p><pre><code class=\"language-plain\">## /etc/hosts\n172.16.121.236 mysql02\n</code></pre><p>é‚£ä¹ˆä»172.16.121.236è¿æ¥æ•°æ®åº“æ—¶ï¼Œå®¢æˆ·ç«¯ä¸»æœºåå°±ä¼šè§£æä¸ºmysql02ï¼Œä½¿ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬æ•…æ„ä½¿ç”¨äº†é”™è¯¯çš„å¯†ç ï¼ŒæœåŠ¡ç«¯ä¼šå°†é”™è¯¯æ¶ˆæ¯å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¯·æ³¨æ„ä¸‹é¢ä¾‹å­é‡Œé”™è¯¯æ¶ˆæ¯ä¸­ç”¨æˆ·åçš„æ ¼å¼ã€‚</p><pre><code class=\"language-plain\">[root@172-16-121-236 ~]#  mysql -u u03 -pwrongpassword -h172.16.121.234\nERROR 1045 (28000): Access denied for user 'u03'@'mysql02' (using password: YES)\n\n\n$ mysql -u u03 -pwrongpassword -h172.16.121.234 -e 'select current_user()'\nERROR 1045 (28000): Access denied for user 'u03'@'192.168.113.13' (using password: YES)\n</code></pre><p>åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šè®¾ç½®skip_name_resolveï¼Œè¿™æ ·MySQLå°±åªä¼šæ ¹æ®IPæ¥éªŒè¯ç”¨æˆ·ï¼Œä¸éœ€è¦å†å°†IPåè§£ææˆä¸»æœºåã€‚</p><pre><code class=\"language-plain\">## my.cnf\nskip_name_resolve\n</code></pre><p>åœ¨MySQL 5.6å’Œæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨mysql_install_dbæ¥åˆå§‹åŒ–æ•°æ®åº“ã€‚åˆå§‹åŒ–è„šæœ¬æ‰§è¡Œæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸ºç©ºçš„æ— å¯†ç ç”¨æˆ·ï¼Œè¿™ä¼šå¼•èµ·ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸ºç©ºçš„ç”¨æˆ·ï¼Œæ¨¡æ‹Ÿæ—©æœŸMySQLç‰ˆæœ¬çš„è¡Œä¸ºã€‚</p><pre><code class=\"language-plain\">mysql&gt; create user ''@'localhost' ;\nQuery OK, 0 rows affected (1.26 sec)\n</code></pre><p>ç„¶ååœ¨æ•°æ®åº“æœåŠ¡å™¨æœ¬åœ°ä½¿ç”¨ä¸€ä¸ªæ­£å¸¸çš„è´¦å·ç™»å½•æ•°æ®åº“ï¼Œä½ ä¼šå‘ç°æ— æ³•ç™»å½•ï¼ŒæŠ¥å¯†ç é”™è¯¯ã€‚</p><pre><code class=\"language-plain\">[root@172-16-121-234 ~]# mysql -u u03 -psomepassword -h 127.0.0.1\nERROR 1045 (28000): Access denied for user 'u03'@'localhost' (using password: YES)\n</code></pre><p>ä½†å®é™…ä¸Šï¼Œè¿™å¹¶ä¸æ˜¯å¯†ç é—®é¢˜ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°ç™»å½•æ—¶ï¼Œä½¿ç”¨äº† <code>''@'localhost'</code> è¿™ä¸ªæ¡ç›®æ¥è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚ä¸‹é¢è¿™ä¸ªæµ‹è¯•æ¡ˆä¾‹å°±èƒ½è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p><pre><code class=\"language-plain\">[root@172-16-121-234 ~]# mysql -u u03 -h 127.0.0.1 -e 'select current_user()'\n+----------------+\n| current_user() |\n+----------------+\n| @localhost     |\n+----------------+\n</code></pre><p>è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•ä¸€èˆ¬å°±æ˜¯<strong>åˆ é™¤ç”¨æˆ·åä¸ºç©ºçš„ç”¨æˆ·</strong>ã€‚</p><h3>å¯†ç éªŒè¯ç»„ä»¶</h3><p>ä¸è¦ç»™MySQLç”¨æˆ·è®¾ç½®è¿‡äºç®€å•çš„å¯†ç ï¼Œå¯ä»¥é€šè¿‡å¯†ç éªŒè¯ç»„ä»¶æ¥å¼ºåˆ¶å¯†ç çš„å¤æ‚åº¦ã€‚ä½¿ç”¨RPMå®‰è£…çš„MySQLé»˜è®¤å°±å·²ç»å¼€å¯äº†å¯†ç éªŒè¯ç»„ä»¶ã€‚å¦‚æœä½ ä½¿ç”¨äº†äºŒè¿›åˆ¶å®‰è£…ï¼Œå¯ä»¥ç”¨å‘½ä»¤INSTALL COMPONENTæ¥å¯ç”¨å¯†ç éªŒè¯ã€‚</p><pre><code class=\"language-plain\">mysql&gt; INSTALL COMPONENT 'file://component_validate_password';\nQuery OK, 0 rows affected (1.03 sec)\n</code></pre><p>å¼€å¯å¯†ç éªŒè¯ç»„ä»¶åï¼Œä½ å°±æ— æ³•åˆ›å»ºå¯†ç è¿‡äºç®€å•çš„ç”¨æˆ·äº†ã€‚</p><pre><code class=\"language-plain\">mysql&gt; create user 'ux'@'%' identified by 'simplepassword';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n</code></pre><p>éœ€è¦åœ¨å¯†ç ä¸­ä½¿ç”¨æ•°å­—ã€å¤§å°å†™å­—æ¯å’Œç‰¹æ®Šå­—ç¬¦ï¼Œè€Œä¸”å¯†ç è¦è¶…è¿‡ä¸€å®šçš„é•¿åº¦ã€‚</p><pre><code class=\"language-plain\">mysql&gt; create user 'ux'@'%' identified by 'Complex-Password-2024';\nQuery OK, 0 rows affected (1.04 sec)\n</code></pre><p>å¯†ç éªŒè¯ç»„ä»¶æœ‰å‡ ä¸ªå‚æ•°å¯ä»¥é…ç½®ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‚å½“è°ƒæ•´è¿™äº›å‚æ•°ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show variables like 'validate_password%';\n+--------------------------------------+--------+\n| Variable_name                        | Value  |\n+--------------------------------------+--------+\n| validate_password.check_user_name    | ON     |\n| validate_password.dictionary_file    |        |\n| validate_password.length             | 8      |\n| validate_password.mixed_case_count   | 1      |\n| validate_password.number_count       | 1      |\n| validate_password.policy             | MEDIUM |\n| validate_password.special_char_count | 1      |\n+--------------------------------------+--------+\n</code></pre><h3>å¿˜è®°å¯†ç å¤„ç†</h3><p>ä¸Šä¸€è®²ç»“æŸæ—¶ï¼Œæˆ‘ç•™äº†ä¸€ä¸ªæ€è€ƒé¢˜ï¼Œrootå¯†ç å¿˜è®°äº†æ€ä¹ˆå¤„ç†ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•°skip-grant-tablesæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…ˆåœæ­¢MySQLï¼Œç”±äºå·²ç»å¿˜è®°äº†ç®¡ç†å‘˜å¯†ç ï¼Œæ— æ³•ä½¿ç”¨shutdownå‘½ä»¤æ­£å¸¸å…³é—­MySQLï¼Œå¯ä»¥ç›´æ¥kill mysqldè¿›ç¨‹ã€‚</p><p>ç„¶åå¯åŠ¨MySQLï¼ŒåŠ ä¸Šskip-grant-tablesé€‰é¡¹ã€‚</p><pre><code class=\"language-plain\">/usr/local/mysql/bin/mysqld_safe \\\n    --defaults-file=/data/mysql01/my.cnf \\\n    --skip-grant-tables \\\n    --skip-networking  &amp;\n</code></pre><p>åŠ ä¸Šskip-grant-tablesé€‰é¡¹åï¼Œä¸éœ€è¦å¯†ç å°±èƒ½ç™»å½•æ•°æ®åº“ã€‚æ­¤æ—¶MySQLä¹Ÿä¸ä¼šéªŒè¯æƒé™ã€‚</p><pre><code class=\"language-plain\"># mysql -uroot -S /data/mysql01/run/mysql.sock\n</code></pre><p>ç™»å½•åï¼Œéœ€è¦å…ˆæ‰§è¡Œflush privilegeså‘½ä»¤ï¼ŒåŠ è½½ç”¨æˆ·å’Œæƒé™ç›¸å…³çš„è¡¨ï¼Œå†æ‰§è¡Œalter userå‘½ä»¤ä¿®æ”¹å¯†ç ï¼Œç„¶åé‡æ–°å¯åŠ¨MySQLï¼Œå°±å¯ä»¥æ­£å¸¸è®¿é—®æ•°æ®åº“äº†ã€‚</p><pre><code class=\"language-plain\">mysql&gt; flush privileges;\nQuery OK, 0 rows affected (0.55 sec)\n\nmysql&gt; alter user 'root'@'localhost' identified by 'newpassword';\nQuery OK, 0 rows affected (0.93 sec)\n</code></pre><h2>æƒé™ç®¡ç†</h2><p>æ–°åˆ›å»ºçš„ç”¨æˆ·åªæœ‰Usageæƒé™ï¼Œåªèƒ½æ‰§è¡Œä¸€äº›æœ€åŸºæœ¬çš„æ“ä½œã€‚ç”¨æˆ·éœ€è¦æˆæƒåï¼Œæ‰èƒ½æ‰§è¡Œå…¶ä»–çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚å»ºåº“å»ºè¡¨ï¼Œè¯»å†™æ•°æ®ã€‚åœ¨MySQLä¸­ä½¿ç”¨grantè¯­å¥è¿›è¡Œæˆæƒã€‚grantè¯­å¥çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">grant privileges\non something\nto 'user'@'host';\n</code></pre><p>æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œå¦‚æœè¢«æˆæƒçš„ç”¨æˆ·ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œgrantè¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªç”¨æˆ·ã€‚åœ¨MySQL 5.7ä¸­ï¼ŒSQL_MODEä¸­åŠ å…¥äº†NO_AUTO_CREATE_USERé€‰é¡¹ï¼Œç”¨æ¥é¿å…è¿™ç§grantè¯­å¥è‡ªåŠ¨åˆ›å»ºç”¨æˆ·çš„è¡Œä¸ºã€‚åˆ°äº†MySQL 8.0ï¼Œå·²ç»ä¸å†æ”¯æŒNO_AUTO_CREATE_USERé€‰é¡¹äº†ã€‚</p><p>æ‰§è¡Œgrantæ—¶ï¼Œè¢«æˆæƒçš„ç”¨æˆ·å¿…é¡»å·²ç»å­˜åœ¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><pre><code class=\"language-plain\">mysql&gt; grant select on *.* to 'readonly'@'%';\nERROR 1410 (42000): You are not allowed to create a user with GRANT\n</code></pre><p>åœ¨MySQLä¸­ï¼Œæœ‰çš„æƒé™æ˜¯å…¨å±€çš„ï¼Œè¿™äº›æƒé™è·ŸæŸä¸ªå…·ä½“çš„æ•°æ®åº“æ²¡æœ‰å…³ç³»ï¼Œæˆæƒæ—¶éœ€è¦ä½¿ç”¨ <code>on *.*</code>ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ç»™ç”¨æˆ·u03æˆæƒäº†æŸ¥çœ‹processåˆ—è¡¨çš„æƒé™ã€‚</p><pre><code class=\"language-plain\">grant process on *.* to 'u03'@'%';\n</code></pre><p>æœ‰çš„æƒé™è·Ÿæ•°æ®åº“æˆ–æ•°æ®åº“ä¸­çš„å¯¹è±¡ç›¸å…³ï¼Œæˆæƒæ—¶å¯ä»¥æŒ‡å®šå…·ä½“çš„æ•°æ®åº“æˆ–æ•°æ®åº“å¯¹è±¡ã€‚ä¸‹é¢è¿™ä¸ªgrantè¯­å¥ç»™ç”¨æˆ·u03æˆæƒäº†æ•°æ®åº“db01çš„DDLæƒé™ã€‚</p><pre><code class=\"language-plain\">grant create,index,alter,drop on db01.* to 'u03'@'%';\n</code></pre><p>æˆæƒåï¼Œu03å¯ä»¥åˆ›å»ºåº“åä¸ºdb01çš„æ•°æ®åº“ï¼Œå¹¶åœ¨è¿™ä¸ªåº“ä¸­åˆ›å»ºè¡¨ã€ä¿®æ”¹è¡¨ç»“æ„ã€DROPè¡¨ï¼Œä½†æ˜¯ä¸èƒ½è¯»å†™è¡¨ä¸­çš„æ•°æ®ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show grants;\n+----------------------------------------------------+\n| Grants for u03@%                                   |\n+----------------------------------------------------+\n| GRANT USAGE ON *.* TO `u03`@`%`                    |\n| GRANT CREATE, INDEX, DROP, ALTER ON `db01`.* TO `u03`@`%` |\n+----------------------------------------------------+\n\n## å¯ä»¥åˆ›å»ºåº“åä¸ºdb01çš„æ•°æ®åº“\nmysql&gt; create database db01;\nQuery OK, 1 row affected (2.91 sec)\n\n## ä½†æ˜¯ä¸èƒ½åˆ›å»ºå…¶ä»–æ•°æ®åº“\nmysql&gt; create database db02;\nERROR 1044 (42000): Access denied for user 'u03'@'%' to database 'db02'\n\n\n## å¯ä»¥åˆ›å»ºè¡¨ï¼Œä¿®æ”¹è¡¨ç»“æ„ï¼ŒDROPè¡¨ï¼Œä½†æ˜¯ä¸èƒ½è¯»å†™è¡¨ä¸­çš„æ•°æ®\nmysql&gt; create table t1(a int, b int);\nQuery OK, 0 rows affected (11.54 sec)\n\nmysql&gt; alter table t1 add c int;\nQuery OK, 0 rows affected (4.98 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql&gt; insert into t1 values(1,2,3);\nERROR 1142 (42000): INSERT command denied to user 'u03'@'192.168.113.13' for table 't1'\n\nmysql&gt; select * from t1;\nERROR 1142 (42000): SELECT command denied to user 'u03'@'192.168.113.13' for table 't1'\n</code></pre><p>éœ€è¦ç»™è´¦å·æ·»åŠ ç›¸åº”çš„æƒé™åï¼Œæ‰èƒ½è®¿é—®è¡¨ä¸­çš„æ•°æ®ã€‚</p><pre><code class=\"language-plain\">mysql&gt; grant select,insert,update,delete on db01.* to 'u03'@'%';\nQuery OK, 0 rows affected (2.31 sec) \n</code></pre><pre><code class=\"language-plain\">mysql&gt; show grants;\n+-------------------------------------------------------------------------------------------+\n| Grants for u03@%                                                                          |\n+-------------------------------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO `u03`@`%`                                                           |\n| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `db01`.* TO `u03`@`%` |\n+-------------------------------------------------------------------------------------------+\n2 rows in set (0.01 sec)\n\nmysql&gt; insert into t1 values(1,2,3);\nQuery OK, 1 row affected (0.28 sec)\n\nmysql&gt; select * from t1;\n+------+------+------+\n| a    | b    | c    |\n+------+------+------+\n|    1 |    2 |    3 |\n+------+------+------+\n1 row in set (0.01 sec)\n</code></pre><p>grantè¯­å¥ä¸­ï¼Œæˆæƒå¯¹è±¡ï¼ˆåº“åå’Œå¯¹è±¡åï¼‰ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä½¿ç”¨ <code>\"%\"</code> åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œä½¿ç”¨ <code>\"_\"</code> åŒ¹é…ä¸€ä¸ªå­—ç¬¦ã€‚</p><pre><code class=\"language-plain\">grant create,drop,alter,index on `db__`.* to 'u03'@'%';\n</code></pre><p>æˆæƒåï¼Œu03ç”¨æˆ·å¯ä»¥åˆ›å»ºåº“åä»¥dbå¼€å¤´ï¼Œå¹¶ä¸”åº“åé•¿åº¦æ˜¯4ä¸ªå­—èŠ‚çš„æ•°æ®åº“ã€‚</p><pre><code class=\"language-plain\">mysql&gt; create database db_1;\nQuery OK, 1 row affected (1.89 sec)\n\nmysql&gt; create database db_2;\nQuery OK, 1 row affected (0.12 sec)\n\nmysql&gt; create database db_10;\nERROR 1044 (42000): Access denied for user 'u03'@'%' to database 'db_10'\n</code></pre><p>å¦‚æœåº“åä¸­æœ‰ä¸‹åˆ’çº¿ <code>\"_\"</code>ï¼Œå¯ä»¥åœ¨grantæ—¶ä½¿ç”¨è½¬ä¹‰ç¬¦å¯¹é€šé…ç¬¦ <code>\"_\"</code> è¿›è¡Œè½¬ä¹‰ã€‚ä¸‹é¢çš„SQLæŠŠdb_1åº“çš„è¯»å†™æƒé™èµ‹ç»™äº†u03ç”¨æˆ·ã€‚</p><pre><code class=\"language-plain\">mysql&gt; grant select,insert,update,delete on `db\\_1`.* to 'u03'@'%';\nQuery OK, 0 rows affected (0.91 sec)\n</code></pre><p>æˆ‘ä»¬å…ˆä½¿ç”¨show grantså‘½ä»¤æŸ¥çœ‹u03ç”¨æˆ·å½“å‰çš„æƒé™ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show grants;\n+----------------------------------------------------------------+\n| Grants for u03@%                                               |\n+----------------------------------------------------------------+\n| GRANT USAGE ON *.* TO `u03`@`%`                                |\n| GRANT SELECT, INSERT, UPDATE, DELETE ON `db01`.* TO `u03`@`%`  |\n| GRANT SELECT, INSERT, UPDATE, DELETE ON `db\\_1`.* TO `u03`@`%` |\n| GRANT CREATE, DROP, INDEX, ALTER ON `db__`.* TO `u03`@`%`      |\n+----------------------------------------------------------------+\n</code></pre><p>ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œu03ç”¨æˆ·æœ‰æ•°æ®åº“db01ã€db_1çš„DDLæƒé™å’Œæ•°æ®è¯»å†™æƒé™ï¼Œæœ‰åº“åä»¥dbå¼€å¤´å¹¶ä¸”é•¿åº¦ä¸º4ä¸ªå­—èŠ‚çš„æ•°æ®åº“çš„DDLæƒé™ã€‚</p><p>ä½†æ˜¯åœ¨ä¸‹é¢è¿™ä¸ªæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨db_1åº“ä¸­æ‰§è¡ŒDDLæ—¶ï¼ŒæŠ¥æƒé™ä¸è¶³ã€‚</p><pre><code class=\"language-plain\">mysql&gt; use db_2;\nDatabase changed\n\nmysql&gt; create table t1(a int);\nQuery OK, 0 rows affected (14.64 sec)\n\nmysql&gt; use db_1;\nDatabase changed\n\nmysql&gt; create table t1(a int);\nERROR 1142 (42000): CREATE command denied to user 'u03'@'192.168.113.13' for table 't1'\n</code></pre><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜å‘¢ï¼Ÿå¤§æ¦‚æ˜¯å› ä¸ºMySQLåªä½¿ç”¨äº†åº“åä¸º <code>'db\\_1'</code> çš„è¿™æ¡æˆæƒè®°å½•ã€‚ä»æƒé™è¡¨mysql.dbä¸­å¯ä»¥çœ‹åˆ°ï¼Œdb_1è¿™ä¸ªåº“æ²¡æœ‰createæƒé™ã€‚</p><pre><code class=\"language-plain\">mysql&gt; select user,host, db, create_priv from mysql.db where user='u03';\n+------+------+-------+-------------+\n| user | host | db    | create_priv |\n+------+------+-------+-------------+\n| u03  | %    | db01  | N           |\n| u03  | %    | db\\_1 | N           |\n| u03  | %    | db__  | Y           |\n+------+------+-------+-------------+\n3 rows in set (0.00 sec)\n</code></pre><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†æ•°æ®åº“db_1çš„DDLçš„æƒé™ä¹Ÿæˆäºˆu03ã€‚</p><pre><code class=\"language-plain\">mysql&gt; grant create,alter,index,drop on `db\\_1`.* to 'u03'@'%';\nQuery OK, 0 rows affected (0.55 sec)\n</code></pre><p>é‡æ–°æˆæƒåï¼Œç”¨æˆ·u03å°±å¯ä»¥åœ¨æ•°æ®åº“db_1ä¸­æ‰§è¡ŒDDLæ“ä½œäº†ã€‚</p><h3>MySQLä¸­æœ‰å“ªäº›æƒé™</h3><p>æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢è¿™ä¸ªè¡¨æ ¼å¯¹MySQLä¸­çš„ä¸€äº›æƒé™åšä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e9/ac/e914049f835f8c8563db560b104d78ac.jpg?wh=1920x2848\" alt=\"å›¾ç‰‡\"></p><h3>æœ€å°æƒé™åŸåˆ™</h3><p>ç®¡ç†æ•°æ®åº“ç”¨æˆ·çš„æƒé™æ—¶ï¼Œè¦éµå¾ªæœ€å°æƒé™åŸåˆ™ã€‚rootç”¨æˆ·è¦äº¤ç»™å°‘æ•°ç®¡ç†äººå‘˜ç®¡ç†ï¼Œå…¶ä»–ä»»ä½•äººä¸èƒ½ä½¿ç”¨rootç”¨æˆ·ã€‚æœ‰çš„å…¬å¸å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¿˜ä¼šåˆ é™¤ç³»ç»Ÿè‡ªå¸¦çš„rootç”¨æˆ·ï¼Œå¹¶å•ç‹¬åˆ›å»ºä¸€ä¸ªè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·ã€‚ç»™ä¸åŒçš„ä¸šåŠ¡æ–¹åˆ†é…ä¸åŒçš„ç”¨æˆ·ï¼Œå¹¶æŒ‰ä¸šåŠ¡çš„å®é™…éœ€æ±‚æˆäºˆæœ€å°çš„æƒé™ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä¸šåŠ¡æ–¹çš„éœ€æ±‚æ˜¯åŒæ­¥æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œåªéœ€è¦å¯¹åº“è¡¨æˆäºˆSELECTæƒé™ã€‚å¯¹äºä¸€èˆ¬çš„åº”ç”¨ç¨‹åºï¼Œéœ€è¦è¯»å†™æ•°æ®ï¼ŒæˆäºˆSELECTã€INSERTã€UPDATEã€DELETEã€EXECUTEè¿™äº›æƒé™å°±å¯ä»¥äº†ã€‚å¯¹äºDBAæˆ–è¿ç»´äººå‘˜ï¼Œéœ€è¦æ‰§è¡Œæ•°æ®åº“å˜æ›´ï¼Œå¯ä»¥æˆäºˆCREATEã€ALTERã€DROPã€INDEXç­‰DDLæƒé™ï¼Œä»¥åŠPROCESSã€SUPERç­‰ç®¡ç†æƒé™ã€‚</p><p>å¦å¤–éœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œç»™ä¸åŒç¯å¢ƒçš„æ•°æ®åº“åˆ›å»ºä¸åŒçš„ç”¨æˆ·ã€‚å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„ç”¨æˆ·ï¼Œä¸è¦ä½¿ç”¨ç›¸åŒçš„å¯†ç ã€‚ä¸åŒçš„ä¸šåŠ¡æ–¹å…±ç”¨åŒä¸€ä¸ªç”¨æˆ·ã€æˆäºˆç”¨æˆ·è¶…å‡ºéœ€è¦çš„æƒé™ã€å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œéƒ½ä¼šç»™æ•°æ®åº“å®‰å…¨å¸¦æ¥æå¤§çš„é£é™©ã€‚</p><p>æœ‰æ—¶å€™ä¸ºäº†æ–¹ä¾¿ï¼Œä½ å¯èƒ½ä¼šæŠŠall privilegesæˆäºˆä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åæ‰€æœ‰ä¸šåŠ¡æ–¹éƒ½ä½¿ç”¨è¿™ä¸ªç”¨æˆ·æ¥è®¿é—®æ•°æ®åº“ã€‚è¿™æ˜¯éå¸¸å±é™©çš„ï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆåšã€‚</p><p>æˆ‘é‡åˆ°è¿‡å¾ˆå¤šæ•°æ®åº“æƒé™è®¾ç½®ä¸å½“å¼•èµ·çš„æ•…éšœã€‚æ¯”å¦‚å¼€å‘äººå‘˜ä½¿ç”¨å›¾å½¢åŒ–ç®¡ç†å·¥å…·è¿æ¥åˆ°æ­£å¼ç¯å¢ƒçš„æ•°æ®åº“ï¼Œç„¶ååœ¨ç•Œé¢ä¸ŠæŠŠæ•´ä¸ªåº“éƒ½åˆ æ‰äº†ã€‚æ•°æ®åˆ†æäººå‘˜ä½¿ç”¨ç¬¬ä¸‰æ–¹ç¨‹åºåº“è¿æ¥ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“åšæ•°æ®åˆ†æï¼Œä½†æ˜¯ç”±äºé…ç½®ä¸å½“ï¼Œç¬¬ä¸‰æ–¹ç¨‹åºåº“åœ¨å…³é—­æ•°æ®åº“è¿æ¥æ—¶å°†è¡¨DROPäº†ã€‚DBAåœ¨å¯¼å…¥æ•°æ®æ—¶ï¼Œæœ¬æ¥åº”è¯¥åˆ°æµ‹è¯•ç¯å¢ƒæ“ä½œï¼Œä½†æ˜¯é”™è¯¯åœ°å°†å¯¼å…¥å‘½ä»¤è´´åˆ°äº†ç”Ÿäº§ç¯å¢ƒçš„ç»ˆç«¯ä¸‹æ‰§è¡Œï¼Œè€Œä¸”ç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒçš„ç”¨æˆ·åå’Œå¯†ç è¿˜éƒ½æ˜¯ä¸€æ ·çš„ï¼Œç„¶ååœ¨å¯¼å…¥æ•°æ®æ—¶å°†ç”Ÿäº§ç¯å¢ƒçš„è¡¨éƒ½å…ˆDROPæ‰äº†ã€‚</p><p>è¿™äº›åœºæ™¯ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬éµå¾ªäº†æœ€å°æƒé™åŸåˆ™ï¼Œè‡³å°‘å¯ä»¥é¿å…ä¸€éƒ¨åˆ†é‡å¤§æ•…éšœã€‚å¦‚æœä½ ä½¿ç”¨äº†åªè¯»è´¦å·ï¼Œå³ä½¿é”™è¯¯åœ°æ‰§è¡Œäº†DROPå‘½ä»¤ï¼Œä½†æ˜¯ç”±äºç”¨æˆ·æƒé™ä¸è¶³ï¼Œæ•°æ®åº“å’Œè¡¨å¹¶ä¸ä¼šè¢«çœŸæ­£DROPã€‚å¦‚æœç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒè®¾ç½®äº†ä¸åŒçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå³ä½¿é”™è¯¯åœ°å°†å‘½ä»¤è´´åˆ°äº†ç”Ÿäº§ç¯å¢ƒï¼Œå› ä¸ºå¯†ç ä¸å¯¹ï¼Œä¹Ÿä¸ä¼šå¯¹ç”Ÿäº§ç¯å¢ƒé€ æˆå½±å“ã€‚</p><h2>æ€»ç»“</h2><p>è¿™ä¸€è®²æˆ‘ä»¬å­¦ä¹ äº†MySQLç”¨æˆ·å’Œæƒé™ç®¡ç†ã€‚MySQLçš„ç”¨æˆ·ç”±ç”¨æˆ·åå’Œä¸»æœºåä¸¤éƒ¨åˆ†ç»„æˆã€‚ç”¨æˆ·åç›¸åŒï¼Œä½†ä¸»æœºåä¸åŒçš„å¤šä¸ªç”¨æˆ·ï¼Œå®é™…ä¸Šæ˜¯å®Œå…¨ç‹¬ç«‹çš„ç”¨æˆ·ï¼Œä¸ºäº†ä¾¿äºç®¡ç†ï¼Œè¦å°½é‡é¿å…åˆ›å»ºè¿™æ ·çš„ç”¨æˆ·ã€‚å¦‚æœä½ è¦é™åˆ¶æ•°æ®åº“åªå…è®¸æŸäº›IPè®¿é—®ï¼Œå¯ä»¥è€ƒè™‘ä»ç½‘ç»œé˜²ç«å¢™å±‚é¢æ¥é™åˆ¶ã€‚ç”¨æˆ·å¯†ç åº”è¯¥è¦æœ‰ä¸€å®šçš„å¤æ‚åº¦ï¼Œå¯ä»¥å¯ç”¨å¯†ç éªŒè¯ç»„ä»¶ï¼Œé˜²æ­¢ç»™æ•°æ®åº“ç”¨æˆ·è®¾ç½®è¿‡äºç®€å•çš„å¯†ç ã€‚æˆæƒæ—¶ï¼Œè¦éµå¾ª<strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼Œç»™ç”¨æˆ·æˆäºˆæ­£å¸¸ä¸šåŠ¡éœ€æ±‚ä¹‹å¤–çš„æƒé™ä¼šå¸¦æ¥é¢å¤–çš„å®‰å…¨é£é™©ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å»ºè®®å°†æ•°æ®åº“éƒ¨ç½²åˆ°å†…ç½‘ï¼Œå› ä¸ºå°†æ•°æ®åº“æš´éœ²åˆ°å…¬ç½‘ä¸Šæœ‰æ¯”è¾ƒå¤§çš„å®‰å…¨é£é™©ã€‚ä½†æ˜¯ä½ çš„å…¬å¸æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ä¸šåŠ¡ï¼Œå°±æ˜¯éœ€è¦é€šè¿‡å…¬ç½‘è®¿é—®MySQLæ•°æ®åº“ã€‚è¯·ä½ è¯„ä¼°ä¸‹å°†æ•°æ®åº“æ”¾åˆ°å…¬ç½‘æœ‰å“ªäº›é£é™©ï¼Ÿä½ åº”ä½¿ç”¨å“ªäº›æ–¹æ³•æ¥å°½é‡ä¿è¯æ•°æ®åº“å’Œæ•°æ®çš„å®‰å…¨ï¼Ÿ</p><p>æœŸå¾…ä½ çš„æ€è€ƒï¼Œæ¬¢è¿åœ¨ç•™è¨€åŒºä¸­ä¸æˆ‘äº¤æµã€‚å¦‚æœä»Šå¤©çš„è¯¾ç¨‹è®©ä½ æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿è½¬å‘ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":393564,"user_name":"Geek_0126","can_delete":false,"product_type":"c1","uid":3952196,"ip_address":"æµ™æ±Ÿ","ucode":"2916F7FB3F6D71","user_header":"https://static001.geekbang.org/account/avatar/00/3c/4e/44/49b29792.jpg","comment_is_top":false,"comment_ctime":1724222313,"is_pvip":false,"replies":[{"id":142919,"content":"æ€»ç»“å¾ˆåˆ°ä½ğŸ‘ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724287504,"ip_address":"æµ™æ±Ÿ","comment_id":393564,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"1.ç½‘ç»œé˜²ç«å¢™åšå¥½ç«¯å£æ”¾è¡Œç­–ç•¥ã€‚\n2.ä½¿ç”¨å•ç‹¬çš„è´¦å·ï¼Œå¹¶ç»™äºˆæœ€å°æƒé™\n3.ä¼ è¾“åŠ å¯†","like_count":3,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650035,"discussion_content":"æ€»ç»“å¾ˆåˆ°ä½ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724287504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393591,"user_name":"binzhang","can_delete":false,"product_type":"c1","uid":1647189,"ip_address":"ç¾å›½","ucode":"F2670F2EA24FAD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM59PTNiaDASVicbVaeWBU1WKmOgyHcqVtl85nDwAqDicib1EUKE2RRoU0x0vZctZO4kbPDUTTke8qKfAw/132","comment_is_top":false,"comment_ctime":1724257650,"is_pvip":false,"replies":[{"id":142925,"content":"Thank you","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":2843479,"ctime":1724310897,"ip_address":"åŒ—äº¬","comment_id":393591,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"This class not only talk about mysql knowledge ,but it also mention lots of best practices in production daily operation job. It&#39;s fantastic. ","like_count":1,"discussions":[{"author":{"id":2843479,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","nickname":"å°è™å­ğŸ¯","note":"","ucode":"4C9530B3FB407B","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650057,"discussion_content":"Thank you","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724310897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393557,"user_name":"123","can_delete":false,"product_type":"c1","uid":2662872,"ip_address":"æµ™æ±Ÿ","ucode":"5A343B568B9524","user_header":"https://static001.geekbang.org/account/avatar/00/28/a1/d8/42252c48.jpg","comment_is_top":false,"comment_ctime":1724207165,"is_pvip":false,"replies":[{"id":142917,"content":"æˆ‘æƒ³è¿™é‡Œé¢çš„åŸç†æ˜¯ç±»ä¼¼çš„ã€‚åœ¨åˆ¤æ–­ç”¨æˆ·å¯¹æŸä¸ªæ•°æ®åº“çš„æƒé™æ—¶ï¼Œä»mysql.dbè¡¨æ£€æŸ¥ï¼Œå¦‚æœè¿™ä¸ªè¡¨é‡Œæœ‰å¤šæ¡è®°å½•éƒ½åŒ¹é…æŸä¸ªdbåï¼Œä¼šä½¿ç”¨åŒ¹é…åº¦æœ€é«˜çš„é‚£æ¡æƒé™è®°å½•ã€‚æ‰€ä»¥æˆæƒæ—¶ï¼Œæˆæƒå¯¹è±¡çš„åç§°ä¹Ÿè¦å°½é‡ä¿æŒä¸€è‡´ã€‚\n\næ¯”å¦‚ ç”¨æˆ·ut1æœ‰è¿™æ ·çš„æƒé™ï¼š\nmysql&gt; show grants;\n+---------------------------------------+\n| Grants for ut1@%                      |\n+---------------------------------------+\n| GRANT USAGE ON *.* TO `ut1`@`%`       |\n| GRANT CREATE ON `dbxx`.* TO `ut1`@`%` |\n| GRANT SELECT ON `db__`.* TO `ut1`@`%` |\n+---------------------------------------+\n\nè®¿é—®dbxxæ—¶ï¼Œä½¿ç”¨dbxxè¿™æ¡æƒé™è®°å½•ã€‚è®¿é—®dbyyæ—¶ï¼Œä½¿ç”¨`db__`è¿™æ¡æƒé™è®°å½•ã€‚å› æ­¤å°±æœ‰è¿™æ ·çš„æƒ…å†µå‡ºç°ï¼š\n\nmysql&gt; select * from dbxx.t1;\nERROR 1142 (42000): SELECT command denied to user \n &#39;ut1&#39;@&#39;localhost&#39; for table &#39;t1&#39;\n\nmysql&gt; select * from dbzz.t1;\nEmpty set (0.00 sec)","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724287360,"ip_address":"æµ™æ±Ÿ","comment_id":393557,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è€å¸ˆï¼Œæƒé™èµ‹å€¼å“ªä¸€å—æ˜¯å¦å’Œç”¨æˆ·ç™»å½•çš„é€»è¾‘æ˜¯ä¸€è‡´ï¼ˆä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜å‘¢ï¼Ÿå¤§æ¦‚æ˜¯å› ä¸º MySQL åªä½¿ç”¨äº†åº“åä¸º &#39;db\\_1&#39; çš„è¿™æ¡æˆæƒè®°å½•ã€‚ï¼‰ï¼Œå…·å¤‡ä¸€å®šçš„ä¼˜å…ˆçº§ï¼Œè‹¥å­˜åœ¨æŒ‡å®šè¡¨å°±ä¸ä¼šå»åŒ¹é…é€šé…ç¬¦ï¼Ÿ\n+-------------------------------------------------------------------------------------------+\n| Grants for u03@%                                                                          |\n+-------------------------------------------------------------------------------------------+\n| GRANT PROCESS ON *.* TO `u03`@`%`                                                         |\n| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `db01`.* TO `u03`@`%` |\n| GRANT SELECT, INSERT, UPDATE, DELETE ON `db\\_1`.* TO `u03`@`%`                            |\n| GRANT CREATE, DROP, INDEX, ALTER ON `db__`.* TO `u03`@`%`                                 |\n+-------------------------------------------------------------------------------------------+\n\nå¯¹u03èµ‹æƒDDLï¼šgrant create,alter,index,drop on `db\\_1`.* to &#39;u03&#39;@&#39;%&#39;;\n+--------------------------------------------------------------------------------------------+\n| Grants for u03@%                                                                           |\n+--------------------------------------------------------------------------------------------+\n| GRANT PROCESS ON *.* TO `u03`@`%`                                                          |\n| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `db01`.* TO `u03`@`%`  |\n| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `db\\_1`.* TO `u03`@`%` |\n| GRANT CREATE, DROP, INDEX, ALTER ON `db__`.* TO `u03`@`%`                                  |\n+--------------------------------------------------------------------------------------------+\n\nå› ä¸ºå¯¹äºåŒä¸€ä¸ªè¡¨ï¼ŒDDLå’ŒDMLæ˜¯åœ¨åŒä¸€è¡Œï¼ŒåŒ¹é…åˆ°å¯¹åº”è¡¨çš„æ•°æ®é¡¹åå°±ç›´æ¥è¿”å›äº†","like_count":1,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650033,"discussion_content":"æˆ‘æƒ³è¿™é‡Œé¢çš„åŸç†æ˜¯ç±»ä¼¼çš„ã€‚åœ¨åˆ¤æ–­ç”¨æˆ·å¯¹æŸä¸ªæ•°æ®åº“çš„æƒé™æ—¶ï¼Œä»mysql.dbè¡¨æ£€æŸ¥ï¼Œå¦‚æœè¿™ä¸ªè¡¨é‡Œæœ‰å¤šæ¡è®°å½•éƒ½åŒ¹é…æŸä¸ªdbåï¼Œä¼šä½¿ç”¨åŒ¹é…åº¦æœ€é«˜çš„é‚£æ¡æƒé™è®°å½•ã€‚æ‰€ä»¥æˆæƒæ—¶ï¼Œæˆæƒå¯¹è±¡çš„åç§°ä¹Ÿè¦å°½é‡ä¿æŒä¸€è‡´ã€‚\n\næ¯”å¦‚ ç”¨æˆ·ut1æœ‰è¿™æ ·çš„æƒé™ï¼š\nmysql&gt; show grants;\n+---------------------------------------+\n| Grants for ut1@%                      |\n+---------------------------------------+\n| GRANT USAGE ON *.* TO `ut1`@`%`       |\n| GRANT CREATE ON `dbxx`.* TO `ut1`@`%` |\n| GRANT SELECT ON `db__`.* TO `ut1`@`%` |\n+---------------------------------------+\n\nè®¿é—®dbxxæ—¶ï¼Œä½¿ç”¨dbxxè¿™æ¡æƒé™è®°å½•ã€‚è®¿é—®dbyyæ—¶ï¼Œä½¿ç”¨`db__`è¿™æ¡æƒé™è®°å½•ã€‚å› æ­¤å°±æœ‰è¿™æ ·çš„æƒ…å†µå‡ºç°ï¼š\n\nmysql&gt; select * from dbxx.t1;\nERROR 1142 (42000): SELECT command denied to user \n &#39;ut1&#39;@&#39;localhost&#39; for table &#39;t1&#39;\n\nmysql&gt; select * from dbzz.t1;\nEmpty set (0.00 sec)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724287360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393548,"user_name":"Amosãƒ¾","can_delete":false,"product_type":"c1","uid":1567014,"ip_address":"å¹¿ä¸œ","ucode":"833F6FCB4042AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e9/26/472e16e4.jpg","comment_is_top":false,"comment_ctime":1724171613,"is_pvip":true,"replies":[{"id":142903,"content":"è¿™ä¸¤ç‚¹ç¡®å®æ˜¯æ•°æ®åº“æ”¾å…¬ç½‘æœ€å¤§çš„é£é™©ã€‚\nä¸è¿‡å¯¹äºé£é™©ä¸€ï¼Œæˆ‘ä¸ªäººæ›´å€¾å‘ç”¨ç½‘ç»œè®¿é—®ç­–ç•¥ã€é˜²ç«å¢™ç­‰æ–¹å¼æ¥é™åˆ¶ã€‚ä¸€æ˜¯å¦‚æœç”¨mysqlå†…éƒ¨æœºåˆ¶æ¥é™åˆ¶ç™»å½•ä¸»æœºï¼Œå¦‚æœç™½åå•é•¿äº†ï¼Œéœ€è¦åˆ›å»ºå’Œç»´æŠ¤å¾ˆå¤šä¸ªç”¨æˆ·ã€‚äºŒæ˜¯ç«¯å£å¦‚æœåœ¨å¤–éƒ¨èƒ½è®¿é—®ï¼Œé»‘å®¢å¯èƒ½ä¼šä½¿ç”¨ä½ æ„æƒ³ä¸åˆ°çš„å„ç§æ–¹å¼æ¥æ”»å‡»æ•°æ®åº“ã€‚\n\né£é™©äºŒç”¨SSL åŠ å¯†ä¼ è¾“æ¥è§£å†³ã€‚è¿˜å¯ä»¥é™åˆ¶ç”¨æˆ·å¿…é¡»æä¾›æ»¡è¶³æ¡ä»¶çš„è¯ä¹¦æ‰èƒ½è®¿é—®æ•°æ®åº“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724205936,"ip_address":"æµ™æ±Ÿ","comment_id":393548,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"éä¸“ä¸šå›ç­”ï¼š\né£é™©ä¸€ï¼šä»»æ„æ¥æºè®¿é—®ï¼Œæ•°æ®åº“è¢«çˆ†ç ´ç™»å½•\nè§„é¿æ–¹æ¡ˆï¼šæˆæƒå°½é‡ä¸ä½¿ç”¨ %ï¼Œè¶Šç²¾ç¡®è¶Šå¥½\né£é™©äºŒï¼šæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æ‹¦æˆªæ•è·\nè§„èŒƒæ–¹æ¡ˆï¼šSSL åŠ å¯†ä¼ è¾“","like_count":1,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649969,"discussion_content":"è¿™ä¸¤ç‚¹ç¡®å®æ˜¯æ•°æ®åº“æ”¾å…¬ç½‘æœ€å¤§çš„é£é™©ã€‚\nä¸è¿‡å¯¹äºé£é™©ä¸€ï¼Œæˆ‘ä¸ªäººæ›´å€¾å‘ç”¨ç½‘ç»œè®¿é—®ç­–ç•¥ã€é˜²ç«å¢™ç­‰æ–¹å¼æ¥é™åˆ¶ã€‚ä¸€æ˜¯å¦‚æœç”¨mysqlå†…éƒ¨æœºåˆ¶æ¥é™åˆ¶ç™»å½•ä¸»æœºï¼Œå¦‚æœç™½åå•é•¿äº†ï¼Œéœ€è¦åˆ›å»ºå’Œç»´æŠ¤å¾ˆå¤šä¸ªç”¨æˆ·ã€‚äºŒæ˜¯ç«¯å£å¦‚æœåœ¨å¤–éƒ¨èƒ½è®¿é—®ï¼Œé»‘å®¢å¯èƒ½ä¼šä½¿ç”¨ä½ æ„æƒ³ä¸åˆ°çš„å„ç§æ–¹å¼æ¥æ”»å‡»æ•°æ®åº“ã€‚\n\né£é™©äºŒç”¨SSL åŠ å¯†ä¼ è¾“æ¥è§£å†³ã€‚è¿˜å¯ä»¥é™åˆ¶ç”¨æˆ·å¿…é¡»æä¾›æ»¡è¶³æ¡ä»¶çš„è¯ä¹¦æ‰èƒ½è®¿é—®æ•°æ®åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724205936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395502,"user_name":"ä¸€æœ¬ä¹¦","can_delete":false,"product_type":"c1","uid":2767251,"ip_address":"æ¹–åŒ—","ucode":"4C07047F052BB4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/39/93/f0247cf8.jpg","comment_is_top":false,"comment_ctime":1730986804,"is_pvip":true,"replies":[{"id":143591,"content":"è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸é…ç½®ï¼Œé»˜è®¤å°±æ˜¯ç›‘å¬æ‰€æœ‰åœ°å€ã€‚\nå¦‚æœé…ç½®æˆ127.0.0.1ï¼Œå°±ä¸èƒ½è¿œç¨‹è®¿é—®äº†ã€‚\n\nå…³äºæƒé™æ§åˆ¶ï¼Œå»ºè®®åœ¨æ•°æ®åº“è´¦å·å’Œç½‘ç»œå±‚é¢ä¸€èµ·ç®¡æ§ã€‚\nè´¦å·å±‚é¢è¦éµå¾ªæœ€å°æƒé™åŸåˆ™ï¼Œç»™ä¸åŒçš„ä¸šåŠ¡åˆ†é…ä¸åŒçš„è´¦å·ã€‚\nç½‘ç»œå±‚é¢ï¼Œé€šè¿‡é˜²ç«å¢™ç­‰æœºåˆ¶ï¼Œåªå…è®¸ç‰¹å®šèŒƒå›´çš„IPè®¿é—®æ•°æ®åº“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1731313324,"ip_address":"æµ™æ±Ÿ","comment_id":395502,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"è€å¸ˆï¼Œè¯·é—®åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®bind-address = 0.0.0.0æ˜¯å¿…é¡»çš„å§ï¼Œå¦åˆ™å°±æ— æ³•è¿œç¨‹ç™»å½•æ•°æ®åº“ï¼Ÿå…³äºæƒé™çš„æ§åˆ¶ï¼Œè¦åœ¨è´¦å·å±‚é¢ä»¥åŠç½‘ç»œé˜²ç«å¢™å±‚é¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653618,"discussion_content":"è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä¸é…ç½®ï¼Œé»˜è®¤å°±æ˜¯ç›‘å¬æ‰€æœ‰åœ°å€ã€‚\nå¦‚æœé…ç½®æˆ127.0.0.1ï¼Œå°±ä¸èƒ½è¿œç¨‹è®¿é—®äº†ã€‚\n\nå…³äºæƒé™æ§åˆ¶ï¼Œå»ºè®®åœ¨æ•°æ®åº“è´¦å·å’Œç½‘ç»œå±‚é¢ä¸€èµ·ç®¡æ§ã€‚\nè´¦å·å±‚é¢è¦éµå¾ªæœ€å°æƒé™åŸåˆ™ï¼Œç»™ä¸åŒçš„ä¸šåŠ¡åˆ†é…ä¸åŒçš„è´¦å·ã€‚\nç½‘ç»œå±‚é¢ï¼Œé€šè¿‡é˜²ç«å¢™ç­‰æœºåˆ¶ï¼Œåªå…è®¸ç‰¹å®šèŒƒå›´çš„IPè®¿é—®æ•°æ®åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1731313324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393831,"user_name":"ä¸€æœ¬ä¹¦","can_delete":false,"product_type":"c1","uid":2767251,"ip_address":"æ¹–åŒ—","ucode":"4C07047F052BB4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/39/93/f0247cf8.jpg","comment_is_top":false,"comment_ctime":1725005764,"is_pvip":true,"replies":[{"id":142997,"content":"-e &#39;select current_user()&#39; å°±æ˜¯ç™»é™†æ•°æ®åº“åæ‰§è¡Œè¿™ä¸ªSQLã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725069434,"ip_address":"æµ™æ±Ÿ","comment_id":393831,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"å¦å¤–åŠ çš„è¿™ä¸ª-e &#39;select current_user()&#39;æ˜¯ç”±ä»€ä¹ˆç‰¹æ®Šæ„ä¹‰å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650472,"discussion_content":"-e &#39;select current_user()&#39; å°±æ˜¯ç™»é™†æ•°æ®åº“åæ‰§è¡Œè¿™ä¸ªSQLã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725069434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2759242,"avatar":"","nickname":"Geek_8bdefc","note":"","ucode":"2875C7A0432987","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650462,"discussion_content":"æŸ¥çœ‹å½“å‰çš„ç™»å½•ç”¨æˆ·ï¼Œç›¸å½“äºç”¨mysqlå‘½ä»¤ç™»å½•æ•°æ®åï¼Œæ‰§è¡Œ:select current_user() æŸ¥è¯¢è¯­å¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725029930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393830,"user_name":"ä¸€æœ¬ä¹¦","can_delete":false,"product_type":"c1","uid":2767251,"ip_address":"æ¹–åŒ—","ucode":"4C07047F052BB4","user_header":"https://static001.geekbang.org/account/avatar/00/2a/39/93/f0247cf8.jpg","comment_is_top":false,"comment_ctime":1725005715,"is_pvip":true,"replies":[{"id":142996,"content":"æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚æœåŠ¡ç«¯å¦‚æœèƒ½åè§£æå‡ºå®¢æˆ·ç«¯çš„ä¸»æœºåï¼Œå°±æ˜¾ç¤ºusername@hostnameï¼Œä¸ç„¶å°±æ˜¾ç¤ºusername@ipã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1725069337,"ip_address":"æµ™æ±Ÿ","comment_id":393830,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"[root@172-16-121-236 ~]# mysql -u u03 -pwrongpassword -h172.16.121.234ERROR 1045 (28000): Access denied for user &#39;u03&#39;@&#39;mysql02&#39; (using password: YES)$ mysql -u u03 -pwrongpassword -h172.16.121.234 -e &#39;select current_user()&#39;ERROR 1045 (28000): Access denied for user &#39;u03&#39;@&#39;192.168.113.13&#39; (using password: YES)\nè¯·é—®è€å¸ˆè¿™ä¸¤æ®µSQLçš„å¯¹æ¯”æ˜¯ä»€ä¹ˆæ„æ€å•Š,æ„æ€æ˜¯å¦‚æœåœ¨æœåŠ¡å™¨ä¸Šå­˜åœ¨172.16.121.236 mysql02çš„æ˜ å°„å…³ç³»ï¼Œè¿”å›æŠ¥é”™ä¿¡æ¯é‡Œé¢çš„å®¢æˆ·ç«¯IPä¼šä¿®æ”¹ä¸ºä¸»æœºåï¼Œå½“å®¢æˆ·ç«¯IPæ˜¯192.168.113.13æ—¶ï¼Œç”±äºæ˜ å°„å…³ç³»ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æŠ¥é”™ä¿¡æ¯é‡Œé¢è¿”å›å®¢æˆ·ç«¯IPï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650471,"discussion_content":"æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚æœåŠ¡ç«¯å¦‚æœèƒ½åè§£æå‡ºå®¢æˆ·ç«¯çš„ä¸»æœºåï¼Œå°±æ˜¾ç¤ºusername@hostnameï¼Œä¸ç„¶å°±æ˜¾ç¤ºusername@ipã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1725069338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393624,"user_name":"TheOne","can_delete":false,"product_type":"c1","uid":1582134,"ip_address":"åŒ—äº¬","ucode":"2A359780156A8B","user_header":"https://static001.geekbang.org/account/avatar/00/18/24/36/0829cbdc.jpg","comment_is_top":false,"comment_ctime":1724336418,"is_pvip":false,"replies":[{"id":142933,"content":"é—®é¢˜1ï¼šæˆ‘å»ºè®®å¯ä»¥ä¸¤ç§æ–¹å¼éƒ½ç†Ÿæ‚‰ä¸€ä¸‹ã€‚dockerä¹Ÿæ˜¯è¿è¡Œæ•°æ®åº“çš„ä¸€ç§æ–¹å¼ã€‚\n\né—®é¢˜2ï¼š\na) äº‘æ•°æ®åº“æŠŠåŸºç¡€è¿ç»´éƒ½äº§åŒ–äº†ï¼Œå®ä¾‹å®‰è£…é…ç½®ã€å¤‡ä»½æ¢å¤ã€é«˜å¯ç”¨ã€è¯»å†™åˆ†ç¦»è¿™äº›éƒ½ç»è¿‡äº†å¤§é‡å®¢æˆ·çš„éªŒè¯ã€‚\nb) RDSåœ¨åº•å±‚ç¡¬ä»¶ä¸Šä¸€èˆ¬ä¹Ÿä¼šæœ‰ä¸€äº›æ ‡å‡†è¦æ±‚ï¼Œæ€§èƒ½å’Œç¨³å®šæ€§ä¸Šæœ‰ä¿éšœã€‚\nc) å„ä¸ªäº‘äº§å•†å¯¹æ•°æ®åº“å†…æ ¸ä¸€èˆ¬éƒ½ä¼šåœ¨å¼€æºç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼Œåšä¸€äº›åŠŸèƒ½å¢å¼ºã€bugä¿®å¤ã€‚\n\nè‡ªå·±æ­å»ºæ•°æ®åº“ç¯å¢ƒçš„è¯ï¼Œæœ‰æ›´å¤šçš„è‡ªä¸»æ€§ã€‚å¦å¤–ä»å­¦ä¹ çš„è§’åº¦ï¼Œè¿˜æ˜¯è¦äº²æ‰‹ä»0å¼€å§‹ï¼ŒæŠŠæ•´å¥—ç¯å¢ƒæ­å»ºèµ·æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724375805,"ip_address":"æµ™æ±Ÿ","comment_id":393624,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100799401,"comment_content":"ä¿Šè¾¾è€å¸ˆä½ å¥½ï¼Œæˆ‘æœ‰å‡ ä¸ªé—®é¢˜æƒ³è¯·æ•™ä¸€ä¸‹\r\n1. æˆ‘è‡ªå·±æƒ³æ­å»ºä¸€ä¸ªmysqlçš„å®éªŒç¯å¢ƒï¼Œæˆ‘æ˜¯ç”¨dokcerçš„æ–¹å¼æ¥å¯åŠ¨å¥½ï¼Œè¿˜æ˜¯åƒæ‚¨è¿™ç« è®²çš„ä¸€æ ·è‡ªå·±å»æ‰‹æŠŠæ‰‹å®‰è£…ä¸€ä¸ªå¥½ï¼Ÿå¦‚æœæœªæ¥æˆ‘æƒ³æ­å»ºmysqlçš„ä¸»ä»é›†ç¾¤ï¼Œé…ç½®è¯»å†™åˆ†ç¦»è¿™æ ·çš„å®éªŒç¯å¢ƒï¼Œç”¨å“ªä¸ªä¼šæ›´æ–¹ä¾¿ä¸€ç‚¹å‘¢ï¼Ÿå¯¹äºå­¦ä¹ å’Œå®è·µæ¥è¯´ï¼Œæ‚¨æ›´æ¨èå“ªç§å‘¢ã€‚\r\n2. è¿˜æœ‰å°±æ˜¯ç°åœ¨äº‘æ•°æ®åº“å¾ˆæµè¡Œäº†ï¼Œè‡ªå·±æœ¬åœ°éƒ¨ç½²çš„åº“å’Œäº‘æ•°æ®åº“é™¤äº†ç¡¬ä»¶ä¸Šï¼Œå…¶ä»–æ–¹é¢çš„å·®åˆ«å¤§æ¦‚æœ‰å“ªäº›å‘¢ï¼Ÿæˆ‘çš„ç†è§£æ˜¯äº‘æ•°æ®åº“ä¼šæŠŠ redolog binlog å„ç§ buff çš„ä»¥åŠå…¶ä»–é…ç½®è®¾ç½®çš„æ›´åˆç†ï¼Œè®©å®¢æˆ·ä¸“æ³¨äºè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰é‚£äº›å…¶ä»–ä¼˜åŠ¿å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650106,"discussion_content":"é—®é¢˜1ï¼šæˆ‘å»ºè®®å¯ä»¥ä¸¤ç§æ–¹å¼éƒ½ç†Ÿæ‚‰ä¸€ä¸‹ã€‚dockerä¹Ÿæ˜¯è¿è¡Œæ•°æ®åº“çš„ä¸€ç§æ–¹å¼ã€‚\n\né—®é¢˜2ï¼š\na) äº‘æ•°æ®åº“æŠŠåŸºç¡€è¿ç»´éƒ½äº§åŒ–äº†ï¼Œå®ä¾‹å®‰è£…é…ç½®ã€å¤‡ä»½æ¢å¤ã€é«˜å¯ç”¨ã€è¯»å†™åˆ†ç¦»è¿™äº›éƒ½ç»è¿‡äº†å¤§é‡å®¢æˆ·çš„éªŒè¯ã€‚\nb) RDSåœ¨åº•å±‚ç¡¬ä»¶ä¸Šä¸€èˆ¬ä¹Ÿä¼šæœ‰ä¸€äº›æ ‡å‡†è¦æ±‚ï¼Œæ€§èƒ½å’Œç¨³å®šæ€§ä¸Šæœ‰ä¿éšœã€‚\nc) å„ä¸ªäº‘äº§å•†å¯¹æ•°æ®åº“å†…æ ¸ä¸€èˆ¬éƒ½ä¼šåœ¨å¼€æºç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼Œåšä¸€äº›åŠŸèƒ½å¢å¼ºã€bugä¿®å¤ã€‚\n\nè‡ªå·±æ­å»ºæ•°æ®åº“ç¯å¢ƒçš„è¯ï¼Œæœ‰æ›´å¤šçš„è‡ªä¸»æ€§ã€‚å¦å¤–ä»å­¦ä¹ çš„è§’åº¦ï¼Œè¿˜æ˜¯è¦äº²æ‰‹ä»0å¼€å§‹ï¼ŒæŠŠæ•´å¥—ç¯å¢ƒæ­å»ºèµ·æ¥ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1724375805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1582134,"avatar":"https://static001.geekbang.org/account/avatar/00/18/24/36/0829cbdc.jpg","nickname":"TheOne","note":"","ucode":"2A359780156A8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":650146,"discussion_content":"å¥½çš„ï¼Œæ„Ÿè°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724425655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":650106,"ip_address":"åŒ—äº¬","group_id":0},"score":650146,"extra":""}]}]},{"had_liked":false,"id":393549,"user_name":"ç¾å¦™çš„ä»£ç ","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"å››å·","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1724173210,"is_pvip":true,"replies":[{"id":142904,"content":"1. è¢«æ”»å‡»ã€‚\n2. æ•°æ®è¢«çªƒå–ã€‚\nå¦‚æœç½‘ç»œä¼ è¾“æ²¡åŠ å¯†ï¼Œå®¢æˆ·ç«¯å’Œæ•°æ®åº“ä¹‹é—´çš„TCPæµé‡å¦‚æœè¢«æŠ“å–äº†ï¼Œå¯ä»¥è§£æå‡ºå®¢æˆ·ç«¯æ‰§è¡Œçš„SQLè¯­å¥ã€æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3898827,"ctime":1724206204,"ip_address":"æµ™æ±Ÿ","comment_id":393549,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100799401,"comment_content":"åœ¨å…¬ç½‘å®¹æ˜“è¢«æ”»å‡»ã€‚è¿˜æœ‰å…¶ä»–é£é™©å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3898827,"avatar":"https://static001.geekbang.org/account/avatar/00/3b/7d/cb/fa3dae58.jpg","nickname":"ä¿Šè¾¾","note":"","ucode":"F79BF9651AD086","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649970,"discussion_content":"1. è¢«æ”»å‡»ã€‚\n2. æ•°æ®è¢«çªƒå–ã€‚\nå¦‚æœç½‘ç»œä¼ è¾“æ²¡åŠ å¯†ï¼Œå®¢æˆ·ç«¯å’Œæ•°æ®åº“ä¹‹é—´çš„TCPæµé‡å¦‚æœè¢«æŠ“å–äº†ï¼Œå¯ä»¥è§£æå‡ºå®¢æˆ·ç«¯æ‰§è¡Œçš„SQLè¯­å¥ã€æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724206204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}