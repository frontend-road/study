{"id":78409,"title":"27 | æ¡ˆä¾‹ç¯‡ï¼šä¸ºä»€ä¹ˆæˆ‘çš„ç£ç›˜I/Oå»¶è¿Ÿå¾ˆé«˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬ç ”ç©¶äº†ä¸€ä¸ªç‹‚æ‰“æ—¥å¿—å¼•å‘ I/O æ€§èƒ½é—®é¢˜çš„æ¡ˆä¾‹ï¼Œå…ˆæ¥ç®€å•å›é¡¾ä¸€ä¸‹ã€‚</p><p>æ—¥å¿—ï¼Œæ˜¯äº†è§£åº”ç”¨ç¨‹åºå†…éƒ¨è¿è¡Œæƒ…å†µï¼Œæœ€å¸¸ç”¨ä¹Ÿæ˜¯æœ€æœ‰æ•ˆçš„å·¥å…·ã€‚æ—¥å¿—ä¸€èˆ¬ä¼šåˆ†ä¸ºè°ƒè¯•ã€ä¿¡æ¯ã€è­¦å‘Šã€é”™è¯¯ç­‰å¤šä¸ªä¸åŒçº§åˆ«ã€‚</p><p>é€šå¸¸ï¼Œç”Ÿäº§ç¯å¢ƒåªç”¨å¼€å¯è­¦å‘Šçº§åˆ«çš„æ—¥å¿—ï¼Œè¿™ä¸€èˆ¬ä¸ä¼šå¯¼è‡´ I/O é—®é¢˜ã€‚ä½†åœ¨å¶å°”æ’æŸ¥é—®é¢˜æ—¶ï¼Œå¯èƒ½éœ€è¦æˆ‘ä»¬å¼€å¯è°ƒè¯•æ—¥å¿—ã€‚è°ƒè¯•ç»“æŸåï¼Œå¾ˆå¯èƒ½å¿˜äº†æŠŠæ—¥å¿—çº§åˆ«è°ƒå›å»ã€‚è¿™æ—¶ï¼Œå¤§é‡çš„è°ƒè¯•æ—¥å¿—å°±å¯èƒ½ä¼šå¼•å‘ I/O æ€§èƒ½é—®é¢˜ã€‚</p><p>ä½ å¯ä»¥ç”¨ iostat ï¼Œç¡®è®¤æ˜¯å¦æœ‰ I/O æ€§èƒ½ç“¶é¢ˆã€‚å†ç”¨ strace å’Œ lsof ï¼Œæ¥å®šä½åº”ç”¨ç¨‹åºä»¥åŠå®ƒæ­£åœ¨å†™å…¥çš„æ—¥å¿—æ–‡ä»¶è·¯å¾„ã€‚æœ€åé€šè¿‡åº”ç”¨ç¨‹åºçš„æ¥å£è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œå®Œç¾è§£å†³ I/O é—®é¢˜ã€‚</p><p>ä¸è¿‡ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«çš„åŠŸèƒ½ï¼Œä½ è¿˜éœ€è¦ä¿®æ”¹åº”ç”¨é…ç½®å¹¶é‡å¯åº”ç”¨ï¼Œä»¥ä¾¿è®©é…ç½®ç”Ÿæ•ˆã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ–°çš„æ¡ˆä¾‹ã€‚è¿™æ¬¡æ¡ˆä¾‹æ˜¯ä¸€ä¸ªåŸºäº Python Flask æ¡†æ¶çš„ Web åº”ç”¨ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæŸ¥è¯¢å•è¯çƒ­åº¦çš„ APIï¼Œä½†æ˜¯API çš„å“åº”é€Ÿåº¦å¹¶ä¸è®©äººæ»¡æ„ã€‚</p><p>éå¸¸æ„Ÿè°¢æºç¨‹ç³»ç»Ÿç ”å‘éƒ¨èµ„æ·±åç«¯å·¥ç¨‹å¸ˆè‘£å›½æ˜Ÿï¼Œå¸®åŠ©æä¾›äº†ä»Šå¤©çš„æ¡ˆä¾‹ã€‚</p><h2><strong>æ¡ˆä¾‹å‡†å¤‡</strong></h2><p>æœ¬æ¬¡æ¡ˆä¾‹è¿˜æ˜¯åŸºäº Ubuntu 18.04ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–çš„ Linux ç³»ç»Ÿã€‚æˆ‘ä½¿ç”¨çš„æ¡ˆä¾‹ç¯å¢ƒå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul>\n<li>\n<p>æœºå™¨é…ç½®ï¼š2 CPUï¼Œ8GB å†…å­˜</p>\n</li>\n<li>\n<p>é¢„å…ˆå®‰è£… dockerã€sysstat ç­‰å·¥å…·ï¼Œå¦‚ apt install <a href=\"http://docker.io\">docker.io</a> sysstat</p>\n</li>\n</ul><!-- [[[read_end]]] --><p>ä¸ºäº†æ–¹ä¾¿ä½ è¿è¡Œä»Šå¤©çš„æ¡ˆä¾‹ï¼Œæˆ‘æŠŠå®ƒæ‰“åŒ…æˆäº†ä¸€ä¸ª Docker é•œåƒã€‚è¿™æ ·ï¼Œä½ å°±åªéœ€è¦è¿è¡Œ Docker å‘½ä»¤å°±å¯ä»¥å¯åŠ¨å®ƒã€‚</p><p>ä»Šå¤©çš„æ¡ˆä¾‹éœ€è¦ä¸¤å°è™šæ‹Ÿæœºï¼Œå…¶ä¸­ä¸€å°æ˜¯æ¡ˆä¾‹åˆ†æçš„ç›®æ ‡æœºå™¨ï¼Œè¿è¡Œ Flask åº”ç”¨ï¼Œå®ƒçš„ IP åœ°å€æ˜¯ 192.168.0.10ï¼›è€Œå¦ä¸€å°ä½œä¸ºå®¢æˆ·ç«¯ï¼Œè¯·æ±‚å•è¯çš„çƒ­åº¦ã€‚æˆ‘ç”»äº†ä¸€å¼ å›¾è¡¨ç¤ºå®ƒä»¬çš„å…³ç³»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a8/bf/a8cc1b02b8c896380d2c53b8018bddbf.png?wh=1752*1040\" alt=\"\"></p><p>æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œåˆ†åˆ« SSH ç™»å½•åˆ°è¿™ä¸¤å°è™šæ‹Ÿæœºä¸­ï¼Œå¹¶åœ¨ç¬¬ä¸€å°è™šæ‹Ÿæœºä¸­ï¼Œå®‰è£…ä¸Šè¿°å·¥å…·ã€‚</p><p>è·Ÿä»¥å‰ä¸€æ ·ï¼Œæ¡ˆä¾‹ä¸­æ‰€æœ‰å‘½ä»¤éƒ½é»˜è®¤ä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœä½ æ˜¯ç”¨æ™®é€šç”¨æˆ·èº«ä»½ç™»é™†ç³»ç»Ÿï¼Œè¯·è¿è¡Œ sudo su root å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p><p>åˆ°è¿™é‡Œï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥æ“ä½œç¯èŠ‚ã€‚</p><blockquote>\n<p>æ¸©é¦¨æç¤ºï¼šæ¡ˆä¾‹ä¸­ Python åº”ç”¨çš„æ ¸å¿ƒé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œä½ å¯èƒ½ä¸€çœ¼å°±èƒ½çœ‹å‡ºé—®é¢˜ï¼Œä½†å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„æºç å°±å¤æ‚å¤šäº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä¾æ—§å»ºè®®ï¼Œæ“ä½œä¹‹å‰åˆ«çœ‹æºç ï¼Œé¿å…å…ˆå…¥ä¸ºä¸»ï¼Œè€Œè¦æŠŠå®ƒå½“æˆä¸€ä¸ªé»‘ç›’æ¥åˆ†æã€‚è¿™æ ·ï¼Œä½ å¯ä»¥æ›´å¥½æŠŠæ¡ï¼Œæ€ä¹ˆä»ç³»ç»Ÿçš„èµ„æºä½¿ç”¨é—®é¢˜å‡ºå‘ï¼Œåˆ†æå‡ºç“¶é¢ˆæ‰€åœ¨çš„åº”ç”¨ï¼Œä»¥åŠç“¶é¢ˆåœ¨åº”ç”¨ä¸­å¤§æ¦‚çš„ä½ç½®ã€‚</p>\n</blockquote><h2><strong>æ¡ˆä¾‹åˆ†æ</strong></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œè¿è¡Œæœ¬æ¬¡æ¡ˆä¾‹è¦åˆ†æçš„ç›®æ ‡åº”ç”¨ï¼š</p><pre><code>$ docker run --name=app -p 10000:80 -itd feisky/word-pop \n</code></pre><p>ç„¶åï¼Œåœ¨ç¬¬äºŒä¸ªç»ˆç«¯ä¸­è¿è¡Œ curl å‘½ä»¤ï¼Œè®¿é—® <a href=\"http://192.168.0.10:1000/\">http://192.168.0.10:1000/</a>ï¼Œç¡®è®¤æ¡ˆä¾‹æ­£å¸¸å¯åŠ¨ã€‚ä½ åº”è¯¥å¯ä»¥åœ¨ curl çš„è¾“å‡ºç•Œé¢é‡Œï¼Œçœ‹åˆ°ä¸€ä¸ª hello world çš„è¾“å‡ºï¼š</p><pre><code>$ curl http://192.168.0.10:10000/ \nhello world \n</code></pre><p>æ¥ä¸‹æ¥ï¼Œåœ¨ç¬¬äºŒä¸ªç»ˆç«¯ä¸­ï¼Œè®¿é—®æ¡ˆä¾‹åº”ç”¨çš„å•è¯çƒ­åº¦æ¥å£ï¼Œä¹Ÿå°±æ˜¯ <a href=\"http://192.168.0.10:1000/popularity/word\">http://192.168.0.10:1000/popularity/word</a>ã€‚</p><pre><code>$ curl http://192.168.0.10:1000/popularity/word \n</code></pre><p>ç¨ç­‰ä¸€ä¼šå„¿ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªæ¥å£å±…ç„¶è¿™ä¹ˆé•¿æ—¶é—´éƒ½æ²¡å“åº”ï¼Œç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿæˆ‘ä»¬å…ˆå›åˆ°ç»ˆç«¯ä¸€æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬è¯•è¯•åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯é‡Œï¼Œéšä¾¿æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚æ‰§è¡Œ df å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µã€‚å¥‡æ€ªçš„æ˜¯ï¼Œè¿™ä¹ˆç®€å•çš„å‘½ä»¤ï¼Œå±…ç„¶ä¹Ÿè¦ç­‰å¥½ä¹…æ‰æœ‰è¾“å‡ºã€‚</p><pre><code>$ df \nFilesystem     1K-blocks    Used Available Use% Mounted on \nudev             4073376       0   4073376   0% /dev \ntmpfs             816932    1188    815744   1% /run \n/dev/sda1       30308240 8713640  21578216  29% / \n</code></pre><p>é€šè¿‡dfæˆ‘ä»¬çŸ¥é“ï¼Œç³»ç»Ÿè¿˜æœ‰è¶³å¤Ÿå¤šçš„ç£ç›˜ç©ºé—´ã€‚é‚£ä¸ºä»€ä¹ˆå“åº”ä¼šå˜æ…¢å‘¢ï¼Ÿçœ‹æ¥è¿˜æ˜¯å¾—è§‚å¯Ÿä¸€ä¸‹ï¼Œç³»ç»Ÿçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œåƒæ˜¯ CPUã€å†…å­˜å’Œç£ç›˜ I/O ç­‰çš„å…·ä½“ä½¿ç”¨æƒ…å†µã€‚</p><p>è¿™é‡Œçš„æ€è·¯å…¶å®è·Ÿä¸Šä¸€ä¸ªæ¡ˆä¾‹æ¯”è¾ƒç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ top æ¥è§‚å¯Ÿ CPU å’Œå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œç„¶åå†ç”¨ iostat æ¥è§‚å¯Ÿç£ç›˜çš„ I/O æƒ…å†µã€‚</p><p>ä¸ºäº†é¿å…åˆ†æè¿‡ç¨‹ä¸­curl è¯·æ±‚çªç„¶ç»“æŸï¼Œæˆ‘ä»¬å›åˆ°ç»ˆç«¯äºŒï¼ŒæŒ‰ Ctrl+C åœæ­¢åˆšæ‰çš„åº”ç”¨ç¨‹åºï¼›ç„¶åï¼ŒæŠŠcurl å‘½ä»¤æ”¾åˆ°ä¸€ä¸ªå¾ªç¯é‡Œæ‰§è¡Œï¼›è¿™æ¬¡æˆ‘ä»¬è¿˜è¦åŠ ä¸€ä¸ª time å‘½ä»¤ï¼Œè§‚å¯Ÿæ¯æ¬¡çš„æ‰§è¡Œæ—¶é—´ï¼š</p><pre><code>$ while true; do time curl http://192.168.0.10:10000/popularity/word; sleep 1; done \n</code></pre><p>ç»§ç»­å›åˆ°ç»ˆç«¯ä¸€æ¥åˆ†ææ€§èƒ½ã€‚æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸€ä¸­è¿è¡Œ top å‘½ä»¤ï¼Œè§‚å¯Ÿ CPU å’Œå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼š</p><pre><code>$ top \ntop - 14:27:02 up 10:30,  1 user,  load average: 1.82, 1.26, 0.76 \nTasks: 129 total,   1 running,  74 sleeping,   0 stopped,   0 zombie \n%Cpu0  :  3.5 us,  2.1 sy,  0.0 ni,  0.0 id, 94.4 wa,  0.0 hi,  0.0 si,  0.0 st \n%Cpu1  :  2.4 us,  0.7 sy,  0.0 ni, 70.4 id, 26.5 wa,  0.0 hi,  0.0 si,  0.0 st \nKiB Mem :  8169300 total,  3323248 free,   436748 used,  4409304 buff/cache \nKiB Swap:        0 total,        0 free,        0 used.  7412556 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND \n12280 root      20   0  103304  28824   7276 S  14.0  0.4   0:08.77 python \n   16 root      20   0       0      0      0 S   0.3  0.0   0:09.22 ksoftirqd/1 \n1549 root      20   0  236712  24480   9864 S   0.3  0.3   3:31.38 python3 \n</code></pre><p>è§‚å¯Ÿ top çš„è¾“å‡ºå¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªCPUçš„ iowait éƒ½éå¸¸é«˜ã€‚ç‰¹åˆ«æ˜¯ CPU0ï¼Œ iowait å·²ç»é«˜è¾¾ 94 %ï¼Œè€Œå‰©ä½™å†…å­˜è¿˜æœ‰ 3GBï¼Œçœ‹èµ·æ¥ä¹Ÿæ˜¯å……è¶³çš„ã€‚</p><p>å†å¾€ä¸‹çœ‹ï¼Œè¿›ç¨‹éƒ¨åˆ†æœ‰ä¸€ä¸ª python è¿›ç¨‹çš„CPUä½¿ç”¨ç‡ç¨å¾®æœ‰ç‚¹é«˜ï¼Œè¾¾åˆ°äº† 14%ã€‚è™½ç„¶ 14% å¹¶ä¸èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œä¸è¿‡æœ‰ç‚¹å«Œç–‘â€”â€”å¯èƒ½è·Ÿ iowait çš„å‡é«˜æœ‰å…³ã€‚</p><p>é‚£è¿™ä¸ªPID å·ä¸º 12280 çš„ python è¿›ç¨‹ï¼Œåˆ°åº•æ˜¯ä¸æ˜¯æˆ‘ä»¬çš„æ¡ˆä¾‹åº”ç”¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä¸­ï¼ŒæŒ‰ä¸‹ Ctrl+Cï¼Œåœæ­¢ top å‘½ä»¤ï¼›ç„¶åæ‰§è¡Œä¸‹é¢çš„ ps å‘½ä»¤ï¼ŒæŸ¥æ‰¾æ¡ˆä¾‹åº”ç”¨ <a href=\"http://app.py\">app.py</a> çš„ PID å·ï¼š</p><pre><code>$ ps aux | grep app.py \nroot     12222  0.4  0.2  96064 23452 pts/0    Ss+  14:37   0:00 python /app.py \nroot     12280 13.9  0.3 102424 27904 pts/0    Sl+  14:37   0:09 /usr/local/bin/python /app.py \n</code></pre><p>ä» ps çš„è¾“å‡ºï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ª CPU ä½¿ç”¨ç‡è¾ƒé«˜çš„è¿›ç¨‹ï¼Œæ­£æ˜¯æˆ‘ä»¬çš„æ¡ˆä¾‹åº”ç”¨ã€‚ä¸è¿‡å…ˆåˆ«ç€æ€¥åˆ†æ CPU é—®é¢˜ï¼Œæ¯•ç«Ÿ iowait å·²ç»é«˜è¾¾ 94%ï¼Œ I/O é—®é¢˜æ‰æ˜¯æˆ‘ä»¬é¦–è¦è§£å†³çš„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ iostat å‘½ä»¤ï¼Œå…¶ä¸­:</p><ul>\n<li>\n<p>-d é€‰é¡¹æ˜¯æŒ‡æ˜¾ç¤ºå‡º I/O çš„æ€§èƒ½æŒ‡æ ‡ï¼›</p>\n</li>\n<li>\n<p>-x é€‰é¡¹æ˜¯æŒ‡æ˜¾ç¤ºå‡ºæ‰©å±•ç»Ÿè®¡ä¿¡æ¯ï¼ˆå³æ˜¾ç¤ºæ‰€æœ‰I/OæŒ‡æ ‡ï¼‰ã€‚</p>\n</li>\n</ul><pre><code>$ iostat -d -x 1\nDevice            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util \nloop0            0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00 \nsda              0.00   71.00      0.00  32912.00     0.00     0.00   0.00   0.00    0.00 18118.31 241.89     0.00   463.55  13.86  98.40 \n</code></pre><p>å†æ¬¡çœ‹åˆ° iostat çš„è¾“å‡ºï¼Œä½ è¿˜è®°å¾—è¿™ä¸ªç•Œé¢ä¸­çš„æ€§èƒ½æŒ‡æ ‡å«ä¹‰å—ï¼Ÿå…ˆè‡ªå·±å›å¿†ä¸€ä¸‹ï¼Œå¦‚æœå®åœ¨æƒ³ä¸èµ·æ¥ï¼Œä¸€å®šè¦å…ˆæŸ¥çœ‹ä¸ŠèŠ‚å†…å®¹ï¼Œæˆ–è€…ç”¨ man iostat æŸ¥æ˜ç™½ã€‚</p><p>æ˜ç™½äº†æŒ‡æ ‡å«ä¹‰ï¼Œå†æ¥å…·ä½“è§‚å¯Ÿ iostat çš„è¾“å‡ºã€‚ä½ å¯ä»¥å‘ç°ï¼Œç£ç›˜ sda çš„ I/O ä½¿ç”¨ç‡å·²ç»è¾¾åˆ° 98% ï¼Œæ¥è¿‘é¥±å’Œäº†ã€‚è€Œä¸”ï¼Œå†™è¯·æ±‚çš„å“åº”æ—¶é—´é«˜è¾¾ 18 ç§’ï¼Œæ¯ç§’çš„å†™æ•°æ®ä¸º 32 MBï¼Œæ˜¾ç„¶å†™ç£ç›˜ç¢°åˆ°äº†ç“¶é¢ˆã€‚</p><p>é‚£è¦æ€ä¹ˆçŸ¥é“ï¼Œè¿™äº› I/Oè¯·æ±‚åˆ°åº•æ˜¯å“ªäº›è¿›ç¨‹å¯¼è‡´çš„å‘¢ï¼Ÿæˆ‘æƒ³ï¼Œä½ å·²ç»è¿˜è®°å¾—ä¸Šä¸€èŠ‚æˆ‘ä»¬ç”¨åˆ°çš„ pidstatã€‚</p><p>åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ pidstat å‘½ä»¤ï¼Œè§‚å¯Ÿè¿›ç¨‹çš„ I/O æƒ…å†µï¼š</p><pre><code>$ pidstat -d 1 \n14:39:14      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command \n14:39:15        0     12280      0.00 335716.00      0.00       0  python \n</code></pre><p>ä» pidstat çš„è¾“å‡ºï¼Œæˆ‘ä»¬å†æ¬¡çœ‹åˆ°äº†PID å·ä¸º 12280çš„ç»“æœã€‚è¿™è¯´æ˜ï¼Œæ­£æ˜¯æ¡ˆä¾‹åº”ç”¨å¼•å‘I/O çš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>èµ°åˆ°è¿™ä¸€æ­¥ï¼Œä½ ä¼°è®¡è§‰å¾—ï¼Œæ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œä¸Šä¸€ä¸ªæ¡ˆä¾‹ä¸åˆšåˆšå­¦è¿‡å—ï¼Ÿæ— éå°±æ˜¯ï¼Œå…ˆç”¨ strace ç¡®è®¤å®ƒæ˜¯ä¸æ˜¯åœ¨å†™æ–‡ä»¶ï¼Œå†ç”¨ lsof æ‰¾å‡ºæ–‡ä»¶æè¿°ç¬¦å¯¹åº”çš„æ–‡ä»¶å³å¯ã€‚</p><p>åˆ°åº•æ˜¯ä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨æ¥è¯•è¯•ã€‚è¿˜æ˜¯åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ strace å‘½ä»¤ï¼š</p><pre><code>$ strace -p 12280 \nstrace: Process 12280 attached \nselect(0, NULL, NULL, NULL, {tv_sec=0, tv_usec=567708}) = 0 (Timeout) \nstat(&quot;/usr/local/lib/python3.7/importlib/_bootstrap.py&quot;, {st_mode=S_IFREG|0644, st_size=39278, ...}) = 0 \nstat(&quot;/usr/local/lib/python3.7/importlib/_bootstrap.py&quot;, {st_mode=S_IFREG|0644, st_size=39278, ...}) = 0 \n</code></pre><p>ä» strace ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°å¤§é‡çš„ stat ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶ä¸”å¤§éƒ½ä¸º python çš„æ–‡ä»¶ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰ä»»ä½• write ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>ç”±äº strace çš„è¾“å‡ºæ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ grep ï¼Œæ¥è¿‡æ»¤ä¸€ä¸‹ writeï¼Œæ¯”å¦‚ï¼š</p><pre><code>$ strace -p 12280 2&gt;&amp;1 | grep write \n</code></pre><p>é—æ†¾çš„æ˜¯ï¼Œè¿™é‡Œä»ç„¶æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚</p><p>éš¾é“æ­¤æ—¶å·²ç»æ²¡æœ‰æ€§èƒ½é—®é¢˜äº†å—ï¼Ÿé‡æ–°æ‰§è¡Œåˆšæ‰çš„ top å’Œ iostat å‘½ä»¤ï¼Œä½ ä¼šä¸å¹¸åœ°å‘ç°ï¼Œæ€§èƒ½é—®é¢˜ä»ç„¶å­˜åœ¨ã€‚</p><p>æˆ‘ä»¬åªå¥½ç»¼åˆ straceã€pidstat å’Œ iostat è¿™ä¸‰ä¸ªç»“æœæ¥åˆ†æäº†ã€‚å¾ˆæ˜æ˜¾ï¼Œä½ åº”è¯¥å‘ç°äº†è¿™é‡Œçš„çŸ›ç›¾ï¼šiostat å·²ç»è¯æ˜ç£ç›˜ I/O æœ‰æ€§èƒ½ç“¶é¢ˆï¼Œè€Œ pidstat ä¹Ÿè¯æ˜äº†ï¼Œè¿™ä¸ªç“¶é¢ˆæ˜¯ç”± 12280 å·è¿›ç¨‹å¯¼è‡´çš„ï¼Œä½† strace è·Ÿè¸ªè¿™ä¸ªè¿›ç¨‹ï¼Œå´æ²¡æœ‰æ‰¾åˆ°ä»»ä½• write ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>è¿™å°±å¥‡æ€ªäº†ã€‚éš¾é“å› ä¸ºæ¡ˆä¾‹ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ˜¯ Python ï¼Œè€ŒPython æ˜¯è§£é‡Šå‹çš„ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°ï¼Ÿè¿˜æ˜¯è¯´ï¼Œå› ä¸ºæ¡ˆä¾‹è¿è¡Œåœ¨ Docker ä¸­å‘¢ï¼Ÿè¿™é‡Œç•™ä¸ªæ‚¬å¿µï¼Œä½ è‡ªå·±æƒ³æƒ³ã€‚</p><p>æ–‡ä»¶å†™ï¼Œæ˜æ˜åº”è¯¥æœ‰ç›¸åº”çš„writeç³»ç»Ÿè°ƒç”¨ï¼Œä½†ç”¨ç°æœ‰å·¥å…·å´æ‰¾ä¸åˆ°ç—•è¿¹ï¼Œè¿™æ—¶å°±è¯¥æƒ³æƒ³æ¢å·¥å…·çš„é—®é¢˜äº†ã€‚æ€æ ·æ‰èƒ½çŸ¥é“å“ªé‡Œåœ¨å†™æ–‡ä»¶å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ç»™ä½ ä»‹ç»ä¸€ä¸ªæ–°å·¥å…·ï¼Œ  <a href=\"https://github.com/iovisor/bcc/blob/master/tools/filetop.py\">filetop</a>ã€‚å®ƒæ˜¯ <a href=\"https://github.com/iovisor/bcc\">bcc</a> è½¯ä»¶åŒ…çš„ä¸€éƒ¨åˆ†ï¼ŒåŸºäº Linux å†…æ ¸çš„ eBPFï¼ˆextended Berkeley Packet Filtersï¼‰æœºåˆ¶ï¼Œä¸»è¦è·Ÿè¸ªå†…æ ¸ä¸­æ–‡ä»¶çš„è¯»å†™æƒ…å†µï¼Œå¹¶è¾“å‡ºçº¿ç¨‹IDï¼ˆTIDï¼‰ã€è¯»å†™å¤§å°ã€è¯»å†™ç±»å‹ä»¥åŠæ–‡ä»¶åç§°ã€‚</p><p>eBPF çš„å·¥ä½œåŸç†ï¼Œä½ æš‚æ—¶ä¸ç”¨æ·±ç©¶ï¼Œåé¢å†…å®¹æˆ‘ä»¬ä¼šé€æ¸æ¥è§¦åˆ°ï¼Œå…ˆä¼šä½¿ç”¨å°±å¯ä»¥äº†ã€‚</p><p>è‡³äºè€æœ‹å‹ bcc çš„å®‰è£…æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå®ƒçš„ Github ç½‘ç«™ <a href=\"https://github.com/iovisor/bcc\">https://github.com/iovisor/bcc</a>ã€‚æ¯”å¦‚åœ¨ Ubuntu 16 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å®‰è£…å®ƒï¼š</p><pre><code>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD \necho &quot;deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main&quot; | sudo tee /etc/apt/sources.list.d/iovisor.list \nsudo apt-get update \nsudo apt-get install bcc-tools libbcc-examples linux-headers-$(uname -r)\n</code></pre><p>å®‰è£…åï¼Œbcc æä¾›çš„æ‰€æœ‰å·¥å…·ï¼Œå°±å…¨éƒ¨å®‰è£…åˆ°äº† /usr/share/bcc/tools è¿™ä¸ªç›®å½•ä¸­ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç”¨è¿™ä¸ªå·¥å…·ï¼Œè§‚å¯Ÿä¸€ä¸‹æ–‡ä»¶çš„è¯»å†™æƒ…å†µã€‚</p><p>é¦–å…ˆï¼Œåœ¨ç»ˆç«¯ä¸€ä¸­è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code># åˆ‡æ¢åˆ°å·¥å…·ç›®å½• \n$ cd /usr/share/bcc/tools \n\n# -C é€‰é¡¹è¡¨ç¤ºè¾“å‡ºæ–°å†…å®¹æ—¶ä¸æ¸…ç©ºå±å¹• \n$ ./filetop -C \n\nTID    COMM             READS  WRITES R_Kb    W_Kb    T FILE \n514    python           0      1      0       2832    R 669.txt \n514    python           0      1      0       2490    R 667.txt \n514    python           0      1      0       2685    R 671.txt \n514    python           0      1      0       2392    R 670.txt \n514    python           0      1      0       2050    R 672.txt \n\n...\n\nTID    COMM             READS  WRITES R_Kb    W_Kb    T FILE \n514    python           2      0      5957    0       R 651.txt \n514    python           2      0      5371    0       R 112.txt \n514    python           2      0      4785    0       R 861.txt \n514    python           2      0      4736    0       R 213.txt \n514    python           2      0      4443    0       R 45.txt \n\n</code></pre><p>ä½ ä¼šçœ‹åˆ°ï¼Œfiletop è¾“å‡ºäº† 8 åˆ—å†…å®¹ï¼Œåˆ†åˆ«æ˜¯çº¿ç¨‹IDã€çº¿ç¨‹å‘½ä»¤è¡Œã€è¯»å†™æ¬¡æ•°ã€è¯»å†™çš„å¤§å°ï¼ˆå•ä½KBï¼‰ã€æ–‡ä»¶ç±»å‹ä»¥åŠè¯»å†™çš„æ–‡ä»¶åç§°ã€‚</p><p>è¿™äº›å†…å®¹é‡Œï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°å¾ˆå¤šåŠ¨æ€é“¾æ¥åº“ï¼Œä¸è¿‡è¿™ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ï¼Œæš‚ä¸”å¿½ç•¥å³å¯ã€‚æˆ‘ä»¬çš„é‡ç‚¹ï¼Œæ˜¯ä¸€ä¸ª python åº”ç”¨ï¼Œæ‰€ä»¥è¦ç‰¹åˆ«å…³æ³¨ python ç›¸å…³çš„å†…å®¹ã€‚</p><p>å¤šè§‚å¯Ÿä¸€ä¼šå„¿ï¼Œä½ å°±ä¼šå‘ç°ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œçº¿ç¨‹å·ä¸º 514 çš„ python åº”ç”¨å°±ä¼šå…ˆå†™å…¥å¤§é‡çš„ txt æ–‡ä»¶ï¼Œå†å¤§é‡åœ°è¯»ã€‚</p><p>çº¿ç¨‹å·ä¸º 514 çš„çº¿ç¨‹ï¼Œå±äºå“ªä¸ªè¿›ç¨‹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨ ps å‘½ä»¤æŸ¥çœ‹ã€‚å…ˆåœ¨ç»ˆç«¯ä¸€ä¸­ï¼ŒæŒ‰ä¸‹ Ctrl+C ï¼Œåœæ­¢ filetop ï¼›ç„¶åï¼Œè¿è¡Œä¸‹é¢çš„ ps å‘½ä»¤ã€‚è¿™ä¸ªè¾“å‡ºçš„ç¬¬äºŒåˆ—å†…å®¹ï¼Œå°±æ˜¯æˆ‘ä»¬æƒ³çŸ¥é“çš„è¿›ç¨‹å·ï¼š</p><pre><code>$ ps -efT | grep 514\nroot     12280  514 14626 33 14:47 pts/0    00:00:05 /usr/local/bin/python /app.py \n</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™ä¸ªçº¿ç¨‹æ­£æ˜¯æ¡ˆä¾‹åº”ç”¨ 12280çš„çº¿ç¨‹ã€‚ç»ˆäºå¯ä»¥å…ˆæ¾ä¸€å£æ°”ï¼Œä¸è¿‡è¿˜æ²¡å®Œï¼Œfiletop åªç»™å‡ºäº†æ–‡ä»¶åç§°ï¼Œå´æ²¡æœ‰æ–‡ä»¶è·¯å¾„ï¼Œè¿˜å¾—ç»§ç»­æ‰¾å•Šã€‚</p><p>æˆ‘å†ä»‹ç»ä¸€ä¸ªå¥½ç”¨çš„å·¥å…·ï¼Œopensnoop ã€‚å®ƒåŒå±äº bcc è½¯ä»¶åŒ…ï¼Œå¯ä»¥åŠ¨æ€è·Ÿè¸ªå†…æ ¸ä¸­çš„ open ç³»ç»Ÿè°ƒç”¨ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾å‡ºè¿™äº› txt æ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œåœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ opensnoop å‘½ä»¤ï¼š</p><pre><code>$ opensnoop \n12280  python              6   0 /tmp/9046db9e-fe25-11e8-b13f-0242ac110002/650.txt \n12280  python              6   0 /tmp/9046db9e-fe25-11e8-b13f-0242ac110002/651.txt \n12280  python              6   0 /tmp/9046db9e-fe25-11e8-b13f-0242ac110002/652.txt \n</code></pre><p>è¿™æ¬¡ï¼Œé€šè¿‡ opensnoop çš„è¾“å‡ºï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº› txt è·¯å¾„ä½äº /tmp ç›®å½•ä¸‹ã€‚ä½ è¿˜èƒ½çœ‹åˆ°ï¼Œå®ƒæ‰“å¼€çš„æ–‡ä»¶æ•°é‡ï¼ŒæŒ‰ç…§æ•°å­—ç¼–å·ï¼Œä» 0.txt ä¾æ¬¡å¢å¤§åˆ° 999.txtï¼Œè¿™å¯è¿œå¤šäºå‰é¢ç”¨ filetop çœ‹åˆ°çš„æ•°é‡ã€‚</p><p>ç»¼åˆ filetop å’Œ opensnoop ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›ä¸€æ­¥åˆ†æäº†ã€‚æˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæµ‹ï¼Œæ¡ˆä¾‹åº”ç”¨åœ¨å†™å…¥ 1000 ä¸ªtxtæ–‡ä»¶åï¼ŒåˆæŠŠè¿™äº›å†…å®¹è¯»åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†ã€‚æˆ‘ä»¬æ¥æ£€æŸ¥ä¸€ä¸‹ï¼Œè¿™ä¸ªç›®å½•ä¸­æ˜¯ä¸æ˜¯çœŸçš„æœ‰ 1000 ä¸ªæ–‡ä»¶ï¼š</p><pre><code>$ ls /tmp/9046db9e-fe25-11e8-b13f-0242ac110002 | wc -l \nls: cannot access '/tmp/9046db9e-fe25-11e8-b13f-0242ac110002': No such file or directory \n0 \n</code></pre><p>æ“ä½œåå´å‘ç°ï¼Œç›®å½•å±…ç„¶ä¸å­˜åœ¨äº†ã€‚æ€ä¹ˆå›äº‹å‘¢ï¼Ÿæˆ‘ä»¬å›åˆ° opensnoop å†è§‚å¯Ÿä¸€ä¼šå„¿ï¼š</p><pre><code>$ opensnoop \n12280  python              6   0 /tmp/defee970-fe25-11e8-b13f-0242ac110002/261.txt \n12280  python              6   0 /tmp/defee970-fe25-11e8-b13f-0242ac110002/840.txt \n12280  python              6   0 /tmp/defee970-fe25-11e8-b13f-0242ac110002/136.txt \n</code></pre><p>åŸæ¥ï¼Œè¿™æ—¶çš„è·¯å¾„å·²ç»å˜æˆäº†å¦ä¸€ä¸ªç›®å½•ã€‚è¿™è¯´æ˜ï¼Œè¿™äº›ç›®å½•éƒ½æ˜¯åº”ç”¨ç¨‹åºåŠ¨æ€ç”Ÿæˆçš„ï¼Œç”¨å®Œå°±åˆ äº†ã€‚</p><p>ç»“åˆå‰é¢çš„æ‰€æœ‰åˆ†æï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥åˆ¤æ–­ï¼Œæ¡ˆä¾‹åº”ç”¨ä¼šåŠ¨æ€ç”Ÿæˆä¸€æ‰¹æ–‡ä»¶ï¼Œç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ï¼Œç”¨å®Œå°±ä¼šåˆ é™¤å®ƒä»¬ã€‚ä½†ä¸å¹¸çš„æ˜¯ï¼Œæ­£æ˜¯è¿™äº›æ–‡ä»¶è¯»å†™ï¼Œå¼•å‘äº† I/O çš„æ€§èƒ½ç“¶é¢ˆï¼Œå¯¼è‡´æ•´ä¸ªå¤„ç†è¿‡ç¨‹éå¸¸æ…¢ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦éªŒè¯è¿™ä¸ªçŒœæƒ³ã€‚è€åŠæ³•ï¼Œè¿˜æ˜¯æŸ¥çœ‹åº”ç”¨ç¨‹åºçš„æºç  <a href=\"https://github.com/feiskyer/linux-perf-examples/blob/master/io-latency/app.py\">app.py</a>ï¼Œ</p><pre><code>@app.route(&quot;/popularity/&lt;word&gt;&quot;) \ndef word_popularity(word): \n  dir_path = '/tmp/{}'.format(uuid.uuid1()) \n  count = 0 \n  sample_size = 1000 \n   \n  def save_to_file(file_name, content): \n    with open(file_name, 'w') as f: \n    f.write(content) \n\n  try: \n    # initial directory firstly \n    os.mkdir(dir_path) \n\n    # save article to files \n    for i in range(sample_size): \n        file_name = '{}/{}.txt'.format(dir_path, i) \n        article = generate_article() \n        save_to_file(file_name, article) \n\n    # count word popularity \n    for root, dirs, files in os.walk(dir_path): \n        for file_name in files: \n            with open('{}/{}'.format(dir_path, file_name)) as f: \n                if validate(word, f.read()): \n                    count += 1 \n    finally: \n        # clean files \n        shutil.rmtree(dir_path, ignore_errors=True) \n\n    return jsonify({'popularity': count / sample_size * 100, 'word': word}) \n</code></pre><p>æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ¡ˆä¾‹åº”ç”¨ï¼Œåœ¨æ¯ä¸ªè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šç”Ÿæˆä¸€æ‰¹ä¸´æ—¶æ–‡ä»¶ï¼Œç„¶åè¯»å…¥å†…å­˜å¤„ç†ï¼Œæœ€åå†æŠŠæ•´ä¸ªç›®å½•åˆ é™¤æ‰ã€‚</p><p>è¿™æ˜¯ä¸€ç§å¸¸è§çš„åˆ©ç”¨ç£ç›˜ç©ºé—´å¤„ç†å¤§é‡æ•°æ®çš„æŠ€å·§ï¼Œä¸è¿‡ï¼Œæœ¬æ¬¡æ¡ˆä¾‹ä¸­çš„ I/O è¯·æ±‚å¤ªé‡ï¼Œå¯¼è‡´ç£ç›˜ I/O åˆ©ç”¨ç‡è¿‡é«˜ã€‚</p><p>è¦è§£å†³è¿™ä¸€ç‚¹ï¼Œå…¶å®å°±æ˜¯ç®—æ³•ä¼˜åŒ–é—®é¢˜äº†ã€‚æ¯”å¦‚åœ¨å†…å­˜å……è¶³æ—¶ï¼Œå°±å¯ä»¥æŠŠæ‰€æœ‰æ•°æ®éƒ½æ”¾åˆ°å†…å­˜ä¸­å¤„ç†ï¼Œè¿™æ ·å°±èƒ½é¿å… I/O çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>ä½ å¯ä»¥æ£€éªŒä¸€ä¸‹ï¼Œåœ¨ç»ˆç«¯äºŒä¸­åˆ†åˆ«è®¿é—® <a href=\"http://192.168.0.10:10000/popularity/word\">http://192.168.0.10:10000/popularity/word</a> å’Œ <a href=\"http://192.168.0.10:10000/popular/word\">http://192.168.0.10:10000/popular/word</a>  ï¼Œå¯¹æ¯”å‰åçš„æ•ˆæœï¼š</p><pre><code>$ time curl http://192.168.0.10:10000/popularity/word\n{ \n  &quot;popularity&quot;: 0.0, \n  &quot;word&quot;: &quot;word&quot; \n} \nreal    2m43.172s \nuser    0m0.004s \nsys    0m0.007s\n</code></pre><pre><code>$ time curl http://192.168.0.10:10000/popular/word\n{\n  &quot;popularity&quot;: 0.0,\n  &quot;word&quot;: &quot;word&quot;\n}\n\nreal    0m8.810s\nuser    0m0.010s\nsys    0m0.000s \n</code></pre><p>æ–°çš„æ¥å£åªè¦8ç§’å°±å¯ä»¥è¿”å›ï¼Œæ˜æ˜¾æ¯”ä¸€å¼€å§‹çš„ 3 åˆ†é’Ÿå¥½å¾ˆå¤šã€‚</p><p>å½“ç„¶ï¼Œè¿™åªæ˜¯ä¼˜åŒ–çš„ç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸”æ–¹æ³•ä¹Ÿä¸ç®—å®Œå–„ï¼Œè¿˜å¯ä»¥åšè¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚ä¸è¿‡ï¼Œåœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¤§éƒ½æ˜¯ç±»ä¼¼çš„åšæ³•ï¼Œå…ˆç”¨æœ€ç®€å•çš„æ–¹æ³•ï¼Œå°½æ—©è§£å†³çº¿ä¸Šé—®é¢˜ï¼Œç„¶åå†ç»§ç»­æ€è€ƒæ›´å¥½çš„ä¼˜åŒ–æ–¹æ³•ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘ä»¬åˆ†æäº†ä¸€ä¸ªå“åº”è¿‡æ…¢çš„å•è¯çƒ­åº¦æ¡ˆä¾‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ topã€iostatï¼Œåˆ†æäº†ç³»ç»Ÿçš„ CPU å’Œç£ç›˜ä½¿ç”¨æƒ…å†µã€‚æˆ‘ä»¬å‘ç°äº†ç£ç›˜ I/O ç“¶é¢ˆï¼Œä¹ŸçŸ¥é“äº†è¿™ä¸ªç“¶é¢ˆæ˜¯æ¡ˆä¾‹åº”ç”¨å¯¼è‡´çš„ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬è¯•ç€ç…§æ¬ä¸Šä¸€èŠ‚æ¡ˆä¾‹çš„æ–¹æ³•ï¼Œç”¨ strace æ¥è§‚å¯Ÿè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¸è¿‡è¿™æ¬¡å¾ˆä¸èµ°è¿ï¼Œæ²¡æ‰¾åˆ°ä»»ä½• write ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬åˆç”¨äº†æ–°çš„å·¥å…·ï¼Œå€ŸåŠ©åŠ¨æ€è¿½è¸ªå·¥å…·åŒ… bcc ä¸­çš„ filetop å’Œ opensnoop ï¼Œæ‰¾å‡ºäº†æ¡ˆä¾‹åº”ç”¨çš„é—®é¢˜ï¼Œå‘ç°è¿™ä¸ªæ ¹æºæ˜¯å¤§é‡è¯»å†™ä¸´æ—¶æ–‡ä»¶ã€‚</p><p>æ‰¾å‡ºé—®é¢˜åï¼Œä¼˜åŒ–æ–¹æ³•å°±ç›¸å¯¹æ¯”è¾ƒç®€å•äº†ã€‚å¦‚æœå†…å­˜å……è¶³æ—¶ï¼Œæœ€ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ•°æ®éƒ½æ”¾åœ¨é€Ÿåº¦æ›´å¿«çš„å†…å­˜ä¸­ï¼Œè¿™æ ·å°±æ²¡æœ‰ç£ç›˜ I/O çš„ç“¶é¢ˆäº†ã€‚å½“ç„¶ï¼Œå†è¿›ä¸€æ­¥ï¼Œä½ å¯ä»¥è¿˜å¯ä»¥åˆ©ç”¨ Trie æ ‘ç­‰å„ç§ç®—æ³•ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–å•è¯å¤„ç†çš„æ•ˆç‡ã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨æ–‡ç« ä¸­æåˆ°è¿‡çš„ï¼Œè®©ä½ æ€è€ƒçš„é—®é¢˜ã€‚</p><p>ä»Šå¤©çš„æ¡ˆä¾‹ä¸­ï¼Œiostat å·²ç»è¯æ˜ï¼Œç£ç›˜ I/O å‡ºç°äº†æ€§èƒ½ç“¶é¢ˆï¼Œ pidstat ä¹Ÿè¯æ˜äº†è¿™ä¸ªç“¶é¢ˆæ˜¯ç”± 12280 å·è¿›ç¨‹å¯¼è‡´çš„ã€‚ä½†æ˜¯ï¼Œstrace è·Ÿè¸ªè¿™ä¸ªè¿›ç¨‹ï¼Œå´æ²¡æœ‰å‘ç°ä»»ä½• write ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>è¿™ç©¶ç«Ÿæ˜¯æ€ä¹ˆå›äº‹ï¼Ÿéš¾é“æ˜¯å› ä¸ºæ¡ˆä¾‹ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ Python æœ¬èº«æ˜¯è§£é‡Šå‹ï¼Ÿè¿˜æ˜¯è¯´ï¼Œå› ä¸ºæ¡ˆä¾‹è¿è¡Œåœ¨ Docker ä¸­å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘å°å°æç¤ºä¸€ä¸‹ã€‚å½“ä½ å‘ç°æ€§èƒ½å·¥å…·çš„è¾“å‡ºæ— æ³•è§£é‡Šæ—¶ï¼Œæœ€å¥½è¿”å›å»æƒ³æƒ³ï¼Œæ˜¯ä¸æ˜¯åˆ†æä¸­æ¼æ‰äº†ä»€ä¹ˆçº¿ç´¢ï¼Œæˆ–è€…å»ç¿»ç¿»å·¥å…·æ‰‹å†Œï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸäº›é»˜è®¤é€‰é¡¹å¯¼è‡´çš„ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","neighbors":{"left":{"article_title":"26 | æ¡ˆä¾‹ç¯‡ï¼šå¦‚ä½•æ‰¾å‡ºç‹‚æ‰“æ—¥å¿—çš„â€œå†…é¬¼â€ï¼Ÿ","id":77885},"right":{"article_title":"28 | æ¡ˆä¾‹ç¯‡ï¼šä¸€ä¸ªSQLæŸ¥è¯¢è¦15ç§’ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","id":78633}},"comments":[{"had_liked":false,"id":62348,"user_name":"åˆ’æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1548036328,"is_pvip":false,"replies":[{"id":"22134","content":"ğŸ‘ ","user_name":"ä½œè€…å›å¤","comment_id":62348,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116346,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"504059209960","product_id":100020901,"comment_content":"èµåŒåœ¨strace -p PIDååŠ ä¸Š-fï¼Œå¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹éƒ½å¯ä»¥è·Ÿè¸ªã€‚","like_count":117,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437177,"discussion_content":"ğŸ‘ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1229617,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK009KMmXKFVSEdjicpDD4ick3NZpM3JdIUibWGB03lG6yicibad0tGmQD7E3DpZ0sVRenxWNfd7iaPdp7g/132","nickname":"å°å°èœé¸Ÿ","note":"","ucode":"1CECC0A664CFD1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390649,"discussion_content":"strace -f -tt -p ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629952183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62318,"user_name":"jeff","can_delete":false,"product_type":"c1","uid":1063344,"ip_address":"","ucode":"3B13989DF44D6C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJSGU1LkzTK76HicuZ1IbiboziakPmL6KzcmlvgIibZ7tq0Tlt6OwhRKLAaTttbY6vSPY5XupEAWjT0eg/132","comment_is_top":false,"comment_ctime":1548031746,"is_pvip":false,"replies":[{"id":"22136","content":"ğŸ‘ é»˜è®¤é€‰é¡¹æ˜¯ä¸å¼€å¯çº¿ç¨‹çš„","user_name":"ä½œè€…å›å¤","comment_id":62318,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116479,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"293605807874","product_id":100020901,"comment_content":"å†™æ–‡ä»¶æ˜¯ç”±å­çº¿ç¨‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ç›´æ¥straceè·Ÿè¸ªè¿›ç¨‹æ²¡æœ‰çœ‹åˆ°writeç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡pstreeæŸ¥çœ‹è¿›ç¨‹çš„çº¿ç¨‹ä¿¡æ¯ï¼Œå†ç”¨straceè·Ÿè¸ªã€‚æˆ–è€…ï¼Œé€šè¿‡strace -fp pidÂ è·Ÿè¸ªæ‰€æœ‰çº¿ç¨‹ã€‚","like_count":68,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437169,"discussion_content":"ğŸ‘ é»˜è®¤é€‰é¡¹æ˜¯ä¸å¼€å¯çº¿ç¨‹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63019,"user_name":"éƒ­æ±Ÿä¼Ÿ","can_delete":false,"product_type":"c1","uid":1313994,"ip_address":"","ucode":"613D638619B5A2","user_header":"https://static001.geekbang.org/account/avatar/00/14/0c/ca/6173350b.jpg","comment_is_top":false,"comment_ctime":1548228754,"is_pvip":false,"replies":[{"id":"22345","content":"èµï¼Œå¾ˆå¥½çš„æ€è·¯","user_name":"ä½œè€…å›å¤","comment_id":63019,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252571,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"117512345746","product_id":100020901,"comment_content":"strace -p -få¯ä»¥æŸ¥çœ‹è¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹ä¿¡æ¯ï¼Œæœ¬ä¾‹ä¸­pythonè¿›ç¨‹ä¸‹å¯èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹æ˜¯socketç›¸å…³ï¼Œä¸€ä¸ªæ˜¯è·Ÿæ–‡ä»¶è¯»å†™ç›¸å…³ï¼Œä¸æ–‡ä»¶è¯»å†™ç›¸å…³çš„ä¼šé¢‘ç¹å˜åŒ–ï¼Œåªéœ€è·Ÿè¸ªè¿›ç¨‹æ ‘çš„æœ€åä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥ã€‚<br>å¯ä»¥ç”¨pstree -p æŸ¥çœ‹Pythonçš„è¿›ç¨‹æ ‘ï¼Œç„¶åstrace -p çº¿ç¨‹å·ï¼Œä¸è¿‡æœ¬ä¾‹ä¸­çº¿ç¨‹æ¶ˆå¤±éå¸¸å¿«ï¼Œéœ€è¦å†™ä¸ªè„šæœ¬æ‰è¡Œ æ¯”å¦‚ï¼šPythonè¿›ç¨‹å·æ˜¯13205 strace -p `pstree -p  13205 | tail -n 1 |  awk -F &#39;(&#39; &#39;{print $NF}&#39; | awk -F &#39;)&#39; &#39;{print $1}&#39;","like_count":27,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437440,"discussion_content":"èµï¼Œå¾ˆå¥½çš„æ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461349,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4c/65/93557eb9.jpg","nickname":"aChan","note":"","ucode":"22BEC3055D5AE5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374186,"discussion_content":"strace -p  æ˜¯è·Ÿè¸ªè¿›ç¨‹çš„å †æ ˆä¿¡æ¯ï¼Œé»˜è®¤æ˜¯è·Ÿè¸ªé‚£ä¸ªçº¿ç¨‹å•Šï¼Œå°±å¦‚æœ¬ä¾‹ï¼Œstrace -p  12280ï¼Œè¿™ä¸ªæ˜¯è¿›ç¨‹idï¼Œæ˜¯è¿›ç¨‹çš„å †æ ˆï¼Ÿå…·ä½“å¯¹åº”å“ªä¸€ä¸ªçº¿ç¨‹å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621055048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099379,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","nickname":"ç–¯ç´","note":"","ucode":"82ACAA4A27753D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364108,"discussion_content":"åº”è¯¥æ˜¯æ¯ä¸ªè¯·æ±‚éƒ½å¯ä¸€ä¸ªçº¿ç¨‹å¤„ç†å§ğŸ˜‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617366552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62754,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1548148781,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"78857560109","product_id":100020901,"comment_content":"[D27æ‰“å¡]<br>è¿˜å¥½æˆ‘å¹³å¸¸ä¹ æƒ¯ç”¨ `pidstat -wut 1` æ—¢å¯ä»¥çœ‹ä¸Šä¸‹æ–‡åˆ‡æ¢ åˆå¯ä»¥çœ‹cpuä½¿ç”¨ç»Ÿè®¡ è¿˜å¯ä»¥çœ‹å„çº¿ç¨‹.<br><br>ä»Šå¤©åˆè§è¯†åˆ°äº†ä¸¤ä¸ªå·¥å…·:<br>filetop:å¯ä»¥æŸ¥çœ‹è¿›ç¨‹æ“ä½œçš„æ–‡ä»¶åç§°ç­‰ä¿¡æ¯<br>opensnoop:ç”šè‡³è¿æ“ä½œçš„æ–‡ä»¶è·¯å¾„ä¹Ÿæœ‰.<br><br>çœ‹è¯„è®ºè¿˜çŸ¥é“äº† strace å¯ä»¥è¿½é€å­çº¿ç¨‹.<br>` strace -p 3387 -f 2&gt;&amp;1 | grep write `<br>è¿™æ ·ä¹‹åå°±å¯ä»¥æœç´¢åˆ°å¾ˆå¤šç³»ç»Ÿè°ƒç”¨äº†.<br><br>åº”è¯¥è·Ÿä»€ä¹ˆè¯­è¨€è¿è¡Œ å’Œ åœ¨å“ªè¿è¡Œæ²¡å…³ç³»,æœ€ç»ˆéƒ½æ˜¯è¦è½å®åˆ°ç³»ç»Ÿè°ƒç”¨ä¸Šå»çš„å§.<br>","like_count":18,"discussions":[{"author":{"id":1284474,"avatar":"https://static001.geekbang.org/account/avatar/00/13/99/7a/558666a5.jpg","nickname":"AceslupK","note":"","ucode":"048F84D019CBBB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391790,"discussion_content":"çœ‹æ¥åº”è¯¥æ—¶åˆ»å…³æ³¨çº¿ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630635909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63078,"user_name":"è§æ˜“å®¢","can_delete":false,"product_type":"c1","uid":1061552,"ip_address":"","ucode":"ABE0FE9C73CBDC","user_header":"https://static001.geekbang.org/account/avatar/00/10/32/b0/74f1e266.jpg","comment_is_top":false,"comment_ctime":1548245777,"is_pvip":false,"replies":[{"id":"22350","content":"å—¯å—¯ï¼Œè°¢è°¢åˆ†äº«æ–°çš„æ€è·¯ã€‚<br><br>ä¸è¿‡perf report æ›´å¤šçš„æ˜¯ç»Ÿè®¡ä¸Šçš„åˆ†æï¼Œè€Œ strace åˆ™æ˜¯å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªè°ƒç”¨çš„ç»†èŠ‚ã€‚","user_name":"ä½œè€…å›å¤","comment_id":63078,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252985,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"61677787921","product_id":100020901,"comment_content":"perf record -e &#39;fs:*&#39; -ag<br>perf report<br>ä½¿ç”¨perfå‘½ä»¤å¯ä»¥ä»kernelå±‚çº§è®°å½•æ–‡ä»¶ç³»ç»Ÿçš„å†…æ ¸äº‹ä»¶ï¼Œç›¸å¯¹straceæˆ‘è§‰å¾—perfè¿˜æœ‰ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯å¯¹ç³»ç»Ÿçš„æ¶ˆè€—æ›´ä½ï¼Œæ›´åˆ©äºåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚<br>http:&#47;&#47;www.brendangregg.com&#47;perf.html","like_count":14,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437461,"discussion_content":"å—¯å—¯ï¼Œè°¢è°¢åˆ†äº«æ–°çš„æ€è·¯ã€‚\n\nä¸è¿‡perf report æ›´å¤šçš„æ˜¯ç»Ÿè®¡ä¸Šçš„åˆ†æï¼Œè€Œ strace åˆ™æ˜¯å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªè°ƒç”¨çš„ç»†èŠ‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269400,"user_name":"KennyQ","can_delete":false,"product_type":"c1","uid":1449481,"ip_address":"","ucode":"5F9AFFCBC086DB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIt0nAFvqib3fpf9AIKUrEJMdbiaPjnKqCryevwjRdqrbzAIxdOn3P5wCz28MNb5Bgb2PwEdCezLEWg/132","comment_is_top":false,"comment_ctime":1608633022,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"48853273278","product_id":100020901,"comment_content":"straceä¸‡èƒ½å‘½ä»¤ï¼š<br>strace -T -f -tt -e trace=all -p pid -o xxxx.txt<br>","like_count":11},{"had_liked":false,"id":200875,"user_name":"æ€€æ£æ¢¦æƒ³çš„å­¦æ¸£","can_delete":false,"product_type":"c1","uid":1916685,"ip_address":"","ucode":"2349B9F4F6FDE3","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg","comment_is_top":false,"comment_ctime":1585665349,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"44535338309","product_id":100020901,"comment_content":"çœ‹çš„æ—¶å€™å¤´è„‘æ¸…æ™°ï¼Œæ”¾åˆ°å®æˆ˜ç¯å¢ƒå°±è„‘å­å¼€å§‹çŠ¯æµ‘äº†","like_count":10},{"had_liked":false,"id":62789,"user_name":"åŒ","can_delete":false,"product_type":"c1","uid":1031605,"ip_address":"","ucode":"D0AC0A69A611C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/b5/b8dfa30a.jpg","comment_is_top":false,"comment_ctime":1548157679,"is_pvip":false,"replies":[{"id":"22343","content":"ç®€å•åœºæ™¯ä¸€æ¡ lsof å°±è§£å†³äº†ï¼Œä½†å¤æ‚çš„åœºæ™¯åˆ™è¿˜éœ€è¦æ›´å¤šçš„æ­¥éª¤","user_name":"ä½œè€…å›å¤","comment_id":62789,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252389,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"31612928751","product_id":100020901,"comment_content":"ä¸ç”¨é‚£ä¹ˆéº»çƒ¦å§ï¼Œä¸€èˆ¬çœ‹ç”¨æˆ·è¿›ç¨‹cpué«˜çš„ï¼Œiowaitæ˜¾è‘—çš„è¯ï¼Œç›´æ¥lsof -på°±èƒ½æ‰¾åˆ°äº†ä»€ä¹ˆæ–‡ä»¶äº†","like_count":7,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437350,"discussion_content":"ç®€å•åœºæ™¯ä¸€æ¡ lsof å°±è§£å†³äº†ï¼Œä½†å¤æ‚çš„åœºæ™¯åˆ™è¿˜éœ€è¦æ›´å¤šçš„æ­¥éª¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78316,"user_name":"Geek_00d753","can_delete":false,"product_type":"c1","uid":1253949,"ip_address":"","ucode":"2ED08B1A425994","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJUP6ibuQssqJBNtQdSaFNhzzibdf7I3nyVGCeJPoDYqfsRndqRY19GpOJCOibMXQmOv2EchtHh0SXow/132","comment_is_top":false,"comment_ctime":1553130118,"is_pvip":false,"replies":[{"id":"29609","content":"å¾ˆå¥½çš„é—®é¢˜ã€‚å¤šä¸ªå·¥å…·å¯¹æ¯”è®¡ç®—çš„æ—¶å€™ä¸€å®šè¦ä½¿ç”¨ç›¸åŒçš„æ—¶é—´é—´éš”ï¼Œé—´éš”ä¸åŒæ—¶ï¼Œå¾ˆå¯èƒ½å°±ä¼šç¢°åˆ°è¿™ä¸ªé—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":78316,"uid":"1001282","ip_address":"","utype":1,"ctime":1554018849,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"18732999302","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ã€‚åœ¨cpuå¯†é›†å‹ä»»åŠ¡ä¸­ä¸€ä¸ªè¿›ç¨‹çš„cpuåˆ©ç”¨ç‡æ˜¯å„cpuçš„us%+sy%ä¹‹å’Œã€‚ä½†å½“iow%é«˜çš„æ—¶å€™ï¼Œè¿™ä¸ªè¿›ç¨‹çš„cpuåˆ©ç”¨ç‡æ˜¯æ€ä¹ˆç®—çš„å‘¢ï¼Ÿå°±åƒç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œè¿›ç¨‹cpuåˆ©ç”¨ç‡14%ï¼Œæ¯”ä¸¤ä¸ªcpuçš„us%+sy%å¤§å¾ˆå¤šã€‚æˆ‘ä¹‹å‰ç†è§£çš„iowçŠ¶æ€ï¼Œè¿›ç¨‹åœ¨ç­‰ioèµ„æºï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥æ˜¯off-cpuçš„ï¼Œæ˜¯ä¸æ˜¯æˆ‘ç†è§£é”™äº†ã€‚éš¾é“iow%æœ‰ä¸€éƒ¨åˆ†ä¹Ÿç®—æ˜¯cpuå ç”¨çš„å—ï¼Ÿé‚£åˆæ˜¯æ€ä¹ˆè®¡ç®—çš„å‘¢ï¼Ÿè°¢è°¢","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444046,"discussion_content":"å¾ˆå¥½çš„é—®é¢˜ã€‚å¤šä¸ªå·¥å…·å¯¹æ¯”è®¡ç®—çš„æ—¶å€™ä¸€å®šè¦ä½¿ç”¨ç›¸åŒçš„æ—¶é—´é—´éš”ï¼Œé—´éš”ä¸åŒæ—¶ï¼Œå¾ˆå¯èƒ½å°±ä¼šç¢°åˆ°è¿™ä¸ªé—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554018849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62744,"user_name":"ä»²é¬¼","can_delete":false,"product_type":"c1","uid":1314692,"ip_address":"","ucode":"DB1CD7052D5BA6","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/84/d8e63885.jpg","comment_is_top":false,"comment_ctime":1548146878,"is_pvip":false,"replies":[{"id":"22336","content":"åº”è¯¥åè¿‡æ¥ï¼Œè¿›ç¨‹å¤§é‡çš„ I&#47;O æ—¶ï¼Œè‡ªå·±å¯èƒ½é—®é¢˜ä¸å¤§ï¼Œä½†å´å¯¼è‡´äº†å…¶ä»–è¿›ç¨‹å‡ºç°é—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":62744,"uid":"1001282","ip_address":"","utype":1,"ctime":1548251800,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"18728016062","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œæ¡ˆä¾‹é‡Œpidstatçš„iodelayä¸º0ï¼ŒkB_wr&#47;sä¹Ÿæœ‰300MBï¼Œæ˜¯å¦è¯´æ˜åº”ç”¨ç¨‹åºå†™æ–‡ä»¶çš„æ€§èƒ½æ²¡æœ‰æ”¶åˆ°å½±å“ï¼Œé€ æˆè¿›ç¨‹å“åº”æ…¢çš„å¯èƒ½æ˜¯å…¶ä»–é—®é¢˜ï¼ˆå¦‚ç³»ç»Ÿè°ƒç”¨ã€æ‰“å¼€æ–‡ä»¶ç­‰ï¼‰ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437333,"discussion_content":"åº”è¯¥åè¿‡æ¥ï¼Œè¿›ç¨‹å¤§é‡çš„ I/O æ—¶ï¼Œè‡ªå·±å¯èƒ½é—®é¢˜ä¸å¤§ï¼Œä½†å´å¯¼è‡´äº†å…¶ä»–è¿›ç¨‹å‡ºç°é—®é¢˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1548251800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187535,"user_name":"Acter","can_delete":false,"product_type":"c1","uid":1082561,"ip_address":"","ucode":"EF747BEAD2A797","user_header":"https://static001.geekbang.org/account/avatar/00/10/84/c1/dfcad82a.jpg","comment_is_top":false,"comment_ctime":1584154014,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14469055902","product_id":100020901,"comment_content":"ç¬¬ä¸‰éè¯»æœ¬æ–‡ï¼ŒçœŸæ˜¯æ¯ä¸€ééƒ½æœ‰æ”¶è·ï¼Œæ„Ÿæ©ğŸ˜„ã€‚","like_count":3},{"had_liked":false,"id":62504,"user_name":"ä»²é¬¼","can_delete":false,"product_type":"c1","uid":1314692,"ip_address":"","ucode":"DB1CD7052D5BA6","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/84/d8e63885.jpg","comment_is_top":false,"comment_ctime":1548077047,"is_pvip":false,"replies":[{"id":"22127","content":"åˆ«æ€¥ï¼Œå·¥å…·æ˜¯æœ‰çš„ï¼Œä½†æ—§ç‰ˆæœ¬çš„å·¥å…·éš¾ç”¨çš„å¤šï¼Œæ‰€ä»¥ä»ç®€å•æ˜“ç”¨çš„å¼€å§‹è®²èµ·","user_name":"ä½œè€…å›å¤","comment_id":62504,"uid":"1001282","ip_address":"","utype":1,"ctime":1548115908,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14432978935","product_id":100020901,"comment_content":"è€å¸ˆï¼Œçº¿ä¸Šç¯å¢ƒkernalç‰ˆæœ¬4.1ä»¥ä¸Šçš„å¾ˆå°‘ï¼Œèƒ½ä¸èƒ½åŒæ—¶è®²ä¸€äº›2.6ã€3.1ç­‰ç‰ˆæœ¬çš„æ›¿ä»£å·¥å…·ï¼Ÿæä¸€ä¸‹åå­—ä¹Ÿå¥½ï¼Œä¸ç„¶å­¦åŠå¤©åŸç†ï¼Œè¿˜æ˜¯ä¸èƒ½â€œå®æˆ˜â€å•Šï¼","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437242,"discussion_content":"åˆ«æ€¥ï¼Œå·¥å…·æ˜¯æœ‰çš„ï¼Œä½†æ—§ç‰ˆæœ¬çš„å·¥å…·éš¾ç”¨çš„å¤šï¼Œæ‰€ä»¥ä»ç®€å•æ˜“ç”¨çš„å¼€å§‹è®²èµ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548115908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62310,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1548030699,"is_pvip":false,"replies":[{"id":"22138","content":"å—¯ï¼Œä¸è¿‡æ³¨æ„straceé»˜è®¤ä¸è·Ÿè¸ªå­çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨","user_name":"ä½œè€…å›å¤","comment_id":62310,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116560,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"14432932587","product_id":100020901,"comment_content":"æ‰“å¡day28<br>æˆ‘ä¸€èˆ¬ç”¨strace -cp æ¥çœ‹ç³»ç»Ÿè°ƒç”¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œç„¶åç”¨-e æŸ¥çœ‹å¯¹åº”è°ƒç”¨çš„è¯¦æƒ…","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437166,"discussion_content":"å—¯ï¼Œä¸è¿‡æ³¨æ„straceé»˜è®¤ä¸è·Ÿè¸ªå­çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581961,"discussion_content":"åŠ ä¸Š-f, å¯ä»¥æ‰“å¼€çº¿ç¨‹è·Ÿè¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659086492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62309,"user_name":"è¿œæ–¹","can_delete":false,"product_type":"c1","uid":1064732,"ip_address":"","ucode":"244C74F9857196","user_header":"https://static001.geekbang.org/account/avatar/00/10/3f/1c/1e4dfbc9.jpg","comment_is_top":false,"comment_ctime":1548030610,"is_pvip":false,"replies":[{"id":"22139","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":62309,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116573,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14432932498","product_id":100020901,"comment_content":"ä½¿ç”¨straceæ—¶ï¼Œæ²¡æœ‰åŠ -fé€‰é¡¹æŸ¥çœ‹çº¿ç¨‹","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437165,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62741,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1548146526,"is_pvip":false,"replies":[{"id":"22333","content":"è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":62741,"uid":"1001282","ip_address":"","utype":1,"ctime":1548251601,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10138081118","product_id":100020901,"comment_content":"[D27æ‰“å¡]<br>Ubuntu 18.04åœ¨å®‰è£…bccæ—¶å‡ºé”™,ç„¶åå‚è€ƒ[https:&#47;&#47;www.codetd.com&#47;article&#47;3092913]å¯ä»¥æˆåŠŸå®‰è£….<br><br>å› ä¸ºppa:hzwhuang&#47;ss-qt5 å¹¶æ²¡æœ‰18.04ç‰ˆæœ¬çš„æºï¼Œå› æ­¤ä¼šå‡ºç°<br>E: ä»“åº“ â€œhttp:&#47;&#47;ppa.launchpad.net&#47;hzwhuang&#47;ss-qt5&#47;ubuntu bionic Releaseâ€ æ²¡æœ‰ Release æ–‡ä»¶ çš„é”™è¯¯ã€‚<br>è¿™æ—¶ï¼Œåªè¦ç¼–è¾‘&#47;etc&#47;apt&#47;sources.list.d&#47;hzwhuang-ubuntu-ss-qt5-bionic.list æ–‡ä»¶ï¼Œå°†bionic (18.04ç‰ˆæœ¬ä»£å·)æ”¹æˆxenialï¼ˆ16.04ç‰ˆæœ¬ä»£å·ï¼‰<br>ç„¶åå†æ‰§è¡Œç¬¬äºŒä¸‰æ­¥éª¤å³å¯ã€‚","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437331,"discussion_content":"è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548251601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62314,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1548030997,"is_pvip":false,"replies":[{"id":"22137","content":"straceé»˜è®¤ä¸è·Ÿè¸ªå­çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨","user_name":"ä½œè€…å›å¤","comment_id":62314,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116543,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10137965589","product_id":100020901,"comment_content":"æ˜¯ä¸æ˜¯straceè¦å¢åŠ -f","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437168,"discussion_content":"straceé»˜è®¤ä¸è·Ÿè¸ªå­çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82244,"user_name":"å¤§ä¹Œè´¼ (\\(â—-â—)&#47;)","can_delete":false,"product_type":"c1","uid":1207293,"ip_address":"","ucode":"B1FB489558F176","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/fd/14e1f6bb.jpg","comment_is_top":false,"comment_ctime":1554168614,"is_pvip":true,"replies":[{"id":"29839","content":"å—¯ï¼Œå¾ˆæœ‰å¯èƒ½ï¼Œè¯•è¯•æŠŠæ•°æ®é‡å†å¢å¤§ä¸€äº›ï¼Œiowaitåº”è¯¥ä¼šè·Ÿç€å‡é«˜","user_name":"ä½œè€…å›å¤","comment_id":82244,"uid":"1001282","ip_address":"","utype":1,"ctime":1554210175,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5849135910","product_id":100020901,"comment_content":"ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘ssdçš„åŸå› ï¼Œiowaitåªæœ‰ä¸€ç‚¹å‡ ï¼Œåè€Œä¸Šä¸‹æ–‡åˆ‡æ¢è¿‡å¤šå¯¼è‡´syå¾ˆé«˜","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445521,"discussion_content":"å—¯ï¼Œå¾ˆæœ‰å¯èƒ½ï¼Œè¯•è¯•æŠŠæ•°æ®é‡å†å¢å¤§ä¸€äº›ï¼Œiowaitåº”è¯¥ä¼šè·Ÿç€å‡é«˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554210175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81919,"user_name":"å¤§é£","can_delete":false,"product_type":"c1","uid":1320080,"ip_address":"","ucode":"2D98888FC63CA9","user_header":"","comment_is_top":false,"comment_ctime":1554082554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5849049850","product_id":100020901,"comment_content":"æ‰“å¡","like_count":1},{"had_liked":false,"id":62761,"user_name":"è…¾è¾¾","can_delete":false,"product_type":"c1","uid":1079876,"ip_address":"","ucode":"72F9CFBA44FDEE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9hlAIKQ1sGDu16oWLOHyCSicr18XibygQSMLMjuDvKk73deDlH9aMphFsj41WYJh121aniaqBLiaMNg/132","comment_is_top":false,"comment_ctime":1548150671,"is_pvip":false,"replies":[{"id":"22575","content":"è¿™é‡Œæ˜¯å¤šä¸ªæ–‡ä»¶çš„I&#47;Oï¼Œä¸åŒæ–‡ä»¶çš„è¯»å†™ä½ç½®å¯èƒ½ä¸æ˜¯é¡ºåºçš„ã€‚å¦‚æœè¦åˆ¶é€ é¡ºåºI&#47;Oï¼Œéœ€è¦ç›´æ¥æ“ä½œè£¸ç£ç›˜ï¼Œä»æŸä¸ªåœ°å€å¼€å§‹é¡ºåºå†™æ•°æ®å°±å¯ä»¥ï¼ˆæ¯”å¦‚ä½¿ç”¨ddæˆ–è€…write()ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚","user_name":"ä½œè€…å›å¤","comment_id":62761,"uid":"1001282","ip_address":"","utype":1,"ctime":1548575604,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"5843117967","product_id":100020901,"comment_content":"è¿™æ ·çš„å†™æ–‡ä»¶æ˜¯éšæœºioï¼Œè¿˜æ˜¯é¡ºåºioï¼Ÿå¦‚ä½•èƒ½åˆ¶é€ å‡ºä¸€ä¸ªé¡ºåºioï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437340,"discussion_content":"è¿™é‡Œæ˜¯å¤šä¸ªæ–‡ä»¶çš„I/Oï¼Œä¸åŒæ–‡ä»¶çš„è¯»å†™ä½ç½®å¯èƒ½ä¸æ˜¯é¡ºåºçš„ã€‚å¦‚æœè¦åˆ¶é€ é¡ºåºI/Oï¼Œéœ€è¦ç›´æ¥æ“ä½œè£¸ç£ç›˜ï¼Œä»æŸä¸ªåœ°å€å¼€å§‹é¡ºåºå†™æ•°æ®å°±å¯ä»¥ï¼ˆæ¯”å¦‚ä½¿ç”¨ddæˆ–è€…write()ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548575604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2016221,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c3/dd/33648195.jpg","nickname":"é‡‘åˆš","note":"","ucode":"9657132D6E5D9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586691,"discussion_content":"#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define DISK_PATH\t&#34;/dev/sda&#34;\n#define MAX_WRITE\t16\n#define WRITE_SIZE\t0x200\n\nunsigned int DISK_SIZE_GB ;\nunsigned int DISK_SIZE_MB ;\n\nvoid *write_disk_thread(void *offset)\n{\n\tint fd;\n\tchar *buff;\n\tunsigned int loffset = *(unsigned int *)offset;\n\tbuff = (char *) malloc(sizeof(char)*WRITE_SIZE);\t//write block data(512Byte)\n\tif (!buff) {\n\t\tprintf(&#34;Malloc area for buff failed!\\n&#34;);\n\t\texit(1);\n\t}\n\n\tmemset(buff, 0, sizeof(buff));\n\t\t\n\tfd = open(DISK_PATH, O_WRONLY|O_SYNC);\n\tif (fd &lt; 0) {\n\t\tprintf(&#34;Open disk failed\\n&#34;);\n\t\texit(1);\n\t}\n\n\t//set offset of fd\n\tlseek(fd, loffset, SEEK_SET);\n\twrite(fd, buff, strlen(buff));\n\tclose(fd);\n}\n\n\nint main(void)\n{\n\tpthread_t write_thread[MAX_WRITE];\n\tint i,ret, res;\n\tunsigned int address;\n\tDISK_SIZE_GB = system(&#34;./parted -l|grep /dev/sda | awk &#39;gsub(/[^[:digit:]]/,&#34; &#34;,$0)&#39;&#34;);\n\tDISK_SIZE_MB = DISK_SIZE_GB*1024;\n\n\tprintf(&#34;Disk Size in system is %dMB\\n&#34;, DISK_SIZE_MB);\n\t//ç¡¬ç›˜å…¨ç›˜æµ‹è¯•\n\twhile (1) {\n\t\tfor (i = 0; i &lt; MAX_WRITE; i++) {\n\t\t\t\tret = pthread_create(&amp;write_thread[i], NULL, (void *)write_disk_thread, &amp;address);\n\t\t\t\taddress += 1;\n\t\t\t\t\n\t\t\t\tif (address &lt; DISK_SIZE_MB)\n\t\t\t\t\taddress += 1;\n\t\t\t\telse {\n\t\t\t\t\tprintf(&#34;write disk offset%d\\n&#34;, address);\n\t\t\t\t\tprintf(&#34;All disk write done\\n&#34;);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\n\t\t\t\tif (ret != 0) {\n\t\t\t\t\tprintf(&#34;Create pthread %d error!\\n&#34;,i);\n\t\t\t\t\texit(1);\n\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tres = pthread_join(write_thread[i], NULL);\n\t\t\t\tprintf(&#34;The result is %d\\n&#34;, res);\n\t\t}\n\t}\n\n\tprintf(&#34;ALL disk multithread write doned!\\n&#34;);\t\n}\n\nè€å¸ˆè¿™ä¸ªå¤šçº¿ç¨‹å†™å¯¹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662437666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å®‰å¾½"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62464,"user_name":"ä¼å…­ä¸ƒ","can_delete":false,"product_type":"c1","uid":1257909,"ip_address":"","ucode":"1660D841731935","user_header":"https://static001.geekbang.org/account/avatar/00/13/31/b5/72bee483.jpg","comment_is_top":false,"comment_ctime":1548063382,"is_pvip":false,"replies":[{"id":"22133","content":"pidstatåŠ ä¸Š -t çº¿ç¨‹é€‰é¡¹è¯•è¯•","user_name":"ä½œè€…å›å¤","comment_id":62464,"uid":"1001282","ip_address":"","utype":1,"ctime":1548116325,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5843030678","product_id":100020901,"comment_content":"å¤§ä½¬ï¼Œæœ‰æ—¶é—´ä»‹ç»ä¸€ä¸‹ï¼Œè„é¡µæ•°æ®ï¼Œç¼“å­˜ï¼Œç°åœ¨ç”¨dstat å‘ç°ä¸å®šæ—¶æœ‰100 util ä½†æ˜¯é€šè¿‡iotop pidstat ç›‘æ§ä¸åˆ°æ˜¯å“ªä¸ªè¿›ç¨‹å¼•èµ·çš„","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437225,"discussion_content":"pidstatåŠ ä¸Š -t çº¿ç¨‹é€‰é¡¹è¯•è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548116325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354356,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"æ¹–å—","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1660295500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660295500","product_id":100020901,"comment_content":"æ‰‹åŠ¨å•æ¬¡è®¿é—®å†straceå’Œlsoféƒ½å¯ä»¥æ£€æµ‹åˆ°å†™æ–‡ä»¶ï¼Œshell å¾ªç¯è®¿é—®å°±æ£€æµ‹ä¸åˆ°ã€‚","like_count":0},{"had_liked":false,"id":322507,"user_name":"å¤æœˆå¼“è™½1993","can_delete":false,"product_type":"c1","uid":1237500,"ip_address":"","ucode":"86122CC701F02A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI3jSpV7VvK6NaUH6X1LNYWGsQdFSTu4SwTZ0nQlSYGTOY2FrDCcMic9qFXnu2ZGR88hBlUQK28Whg/132","comment_is_top":false,"comment_ctime":1637429112,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637429112","product_id":100020901,"comment_content":"æˆ‘ç†è§£çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œä¸ºä»€ä¹ˆstraceè·Ÿè¸ªä¸åˆ°å‘¢","like_count":0},{"had_liked":false,"id":320278,"user_name":"geektime_zpf","can_delete":false,"product_type":"c1","uid":1041743,"ip_address":"","ucode":"FD61BCAD02CA54","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e5/4f/731ef2c1.jpg","comment_is_top":false,"comment_ctime":1636194782,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1636194782","product_id":100020901,"comment_content":"æ¡ˆä¾‹ä¸­docker runè®¾ç½®çš„hostPort=10000, curlçš„ç«¯å£=1000, éœ€è¦ä¿®æ”¹ä¸€è‡´..","like_count":0},{"had_liked":false,"id":255879,"user_name":"14155084066","can_delete":false,"product_type":"c1","uid":2245375,"ip_address":"","ucode":"EF5BFE8773578C","user_header":"https://static001.geekbang.org/account/avatar/00/22/42/ff/2a067d5d.jpg","comment_is_top":false,"comment_ctime":1603449756,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603449756","product_id":100020901,"comment_content":"lsofæ”¾åœ¨whileå¾ªç¯é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°æœ‰æ–‡ä»¶ç”Ÿæˆ","like_count":0},{"had_liked":false,"id":251368,"user_name":"Geek_a16bbc","can_delete":false,"product_type":"c1","uid":2008721,"ip_address":"","ucode":"6F12AFEF638413","user_header":"","comment_is_top":false,"comment_ctime":1601502214,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1601502214","product_id":100020901,"comment_content":"python codesè£¡é¢æ²’æœ‰ç”¨thread, ç‚ºä½•å¯«å…¥æ–‡ä»¶æ˜¯ç”±threadä¾†åŸ·è¡Œçš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1017245,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/85/9d/e6d3998e.jpg","nickname":"è–›äº®äº®","note":"","ucode":"04696A6192BE93","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310407,"discussion_content":"çŒœæµ‹Flask æ¯ä¸ªRequestæ˜¯new Threadæ¥å¤„ç†çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601818178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205855,"user_name":"åˆ˜å‹æ·™","can_delete":false,"product_type":"c1","uid":1620058,"ip_address":"","ucode":"97F3A69A308313","user_header":"","comment_is_top":false,"comment_ctime":1586747362,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586747362","product_id":100020901,"comment_content":"D12 æ‰“å¡","like_count":0},{"had_liked":false,"id":202053,"user_name":"æ–‘é©¬Z","can_delete":false,"product_type":"c1","uid":1500262,"ip_address":"","ucode":"ABB55B4652452F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK0K9AM6xxDzVV6pF66jyus5NuuxZzT9icad8AQDMKibwUOy3UnoZIZdyKIKd9sA06rgFnIWwiakSeOQ/132","comment_is_top":false,"comment_ctime":1585894321,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585894321","product_id":100020901,"comment_content":"è¿™ä¸ªæ¡ˆä¾‹æˆ‘åœ¨æœ€å¼€å§‹åšçš„æ—¶å€™ä¹Ÿæ˜¯å…ˆç”¨topã€iostatã€pidstatã€straceä¸€æ­¥ä¸€æ­¥æ¥ï¼Œæ‰¾åˆ°é—®é¢˜è¿›ç¨‹ï¼Œè‡³äºè€å¸ˆåé¢ç”¨åˆ°çš„filetop å’Œ opensnoopï¼Œæˆ‘ä¸€å¼€å§‹ä¸äº†è§£è¿™ä¸ªåº”ç”¨ï¼Œå½“straceè¿½è¸ªä¸åˆ°æ—¶ï¼Œæˆ‘ç”¨äº†lsof å‘ç°äº†åœ¨&#47;tmpä¸‹æœ‰æ–‡ä»¶ç”Ÿæˆç„¶åæ¶ˆå¤±ï¼Œä½†æ˜¯é¢‘æ¬¡ä¸å¦‚è€å¸ˆè¯´çš„ä¸¤ä¸ªå‘½ä»¤æ¥çš„ç›´è§‚ã€‚","like_count":0},{"had_liked":false,"id":167211,"user_name":"æ°¸","can_delete":false,"product_type":"c1","uid":1297269,"ip_address":"","ucode":"F1737EBDB046FB","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/75/0106cd63.jpg","comment_is_top":false,"comment_ctime":1577717790,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577717790","product_id":100020901,"comment_content":"äº†è§£åˆ°äº†ï¼Œfiletop å’Œ opensnoopå·¥å…·ï¼Œå†™å…¥äº†å¤§é‡çš„ä¸´æ—¶æ–‡ä»¶å¯¼è‡´çš„ã€‚ç£ç›˜ç©ºé—´å¤„ç†å¤§é‡æ•°æ®çš„æŠ€å·§æ˜¯å¥½çš„ã€‚ä½†æ˜¯å¤ªå¤šçš„å†™å…¥äº†ã€‚","like_count":0},{"had_liked":false,"id":135591,"user_name":"NoBody","can_delete":false,"product_type":"c1","uid":1173766,"ip_address":"","ucode":"72E1B4FCDA2469","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/06/038a9cea.jpg","comment_is_top":false,"comment_ctime":1569222947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569222947","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ã€‚æˆ‘æƒ³é—®ä¸€ä¸‹å¦‚ä½•å®šä½é‚£ç§å¿«é€Ÿæ¶ˆäº¡çš„çº¿ç¨‹tidï¼Œæ¥æŸ¥æ‰¾pidã€‚æˆ‘æ ¹æ®ä¸Šé¢çš„æ­¥éª¤ä»¥åã€‚filetopç»“æŸä»¥åç”¨ps -efTå·²ç»è·å–ä¸åˆ°pidäº†ã€‚æœ€åæœç´¢ç”¨ps -eLo pid= -o tid= | awk &#39;$2 == xxx{print $1}&#39;æˆåŠŸè¾“å‡ºpidã€‚ä½†æ˜¯å¦‚æœçº¿ç¨‹å¦‚æœæ¶ˆäº¡æ›´å¿«çš„è¯ï¼Œåº”è¯¥æ€ä¹ˆå®šä½ï¼Ÿ","like_count":0},{"had_liked":false,"id":96113,"user_name":"Musisan","can_delete":false,"product_type":"c1","uid":1500498,"ip_address":"","ucode":"A9A9FE56AABEBA","user_header":"https://static001.geekbang.org/account/avatar/00/16/e5/52/35bc9c07.jpg","comment_is_top":false,"comment_ctime":1558334875,"is_pvip":false,"replies":[{"id":"34563","content":"è¯•è¯•é‡å¯docker","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1558447703,"ip_address":"","comment_id":96113,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558334875","product_id":100020901,"comment_content":"docker: Error response from daemon: driver failed programming external connectivity on endpoint app (175d6e56d8b0ac97ae0ae46a8b809785dcca95481147f73b71d01670d0546ad4):  (iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0&#47;0 --dport 10000 -j DNAT --to-destination 172.17.0.2:80 ! -i docker0: iptables: No chain&#47;target&#47;match by that name.<br> (exit status 1)).<br><br>è€å¸ˆï¼Œåˆ›å»ºdockeré•œåƒæ—¶å€™å‡ºç°è¿™ä¸ªï¼Œæ— æ³•è¿è¡ŒæˆåŠŸ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450725,"discussion_content":"è¯•è¯•é‡å¯docker","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558447703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75202,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1552363284,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552363284","product_id":100020901,"comment_content":"DAY27,æ‰“å¡","like_count":0},{"had_liked":false,"id":65413,"user_name":"é¥¼å­","can_delete":false,"product_type":"c1","uid":1085953,"ip_address":"","ucode":"981A44836A5216","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/01/c723d180.jpg","comment_is_top":false,"comment_ctime":1549340369,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1549340369","product_id":100020901,"comment_content":"æ‰“å¡å­¦ä¹ ","like_count":0},{"had_liked":false,"id":63169,"user_name":"zzl","can_delete":false,"product_type":"c1","uid":1324898,"ip_address":"","ucode":"35096E644D853E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJibNCmnayibgDna5zJJC8jWWzRq3nA5NtsiasjvqYa5vU6QudUNwm8B1B5naz5cib0fjU2YzVUajrhLw/132","comment_is_top":false,"comment_ctime":1548292841,"is_pvip":false,"replies":[{"id":"22580","content":"å¯¹æ•°æ®åº“æ¥è¯´ï¼ŒI&#47;Oé—®é¢˜é™¤äº†ç¡¬ä»¶é”™è¯¯ä¹‹å¤–ï¼Œå¾ˆæœ‰å¯èƒ½é—®é¢˜å¤„åœ¨æ•°æ®åº“æœ¬èº«çš„ä½¿ç”¨ä¸Šã€‚æ‰€ä»¥ï¼Œå¯ä»¥ä»æ•°æ®åº“çš„ä½¿ç”¨ä¸Šå»æ’æŸ¥ï¼Œæ¯”å¦‚è¡¨ç»“æ„ã€SQLã€æ…¢æŸ¥è¯¢ç­‰ç­‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548576255,"ip_address":"","comment_id":63169,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1548292841","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œä½ è®²çš„è¿™ä¸ªæ­£å¸¸ç£ç›˜ç“¶é¢ˆæƒ…å†µï¼Œè€Œæˆ‘ç»å¸¸é‡åˆ°çš„ä¸æ˜¯è¿™æ ·ã€‚æ¯”å¦‚æˆ‘æ˜¯ç”¨çš„ä¸­é«˜ç«¯å­˜å‚¨é˜µåˆ—ï¼Œè·‘çš„æ˜¯oracleæ•°æ®åº“ï¼Œçªç„¶å‡ºç°ioæ…¢çš„é—®é¢˜ï¼ŒæŸ¥çœ‹ç£ç›˜ä½¿ç”¨ç‡100%ï¼Œioç­‰å¾…æ—¶é—´å¾ˆé«˜ï¼Œioè¯»å†™åªæœ‰æ¯ç§’å‡ Kåˆ°å‡ å…†ï¼Œç£ç›˜é˜Ÿåˆ—æ­£å¸¸ï¼Œå®Œå…¨è¾¾ä¸åˆ°å­˜å‚¨é˜µåˆ—åº”æœ‰çš„æ ·å­ï¼Œè€Œæ•°æ®åº“æ–¹é¢åªç»™å‡ºäº†ioè¯»å†™ç¼“æ…¢å¯¼è‡´æ•°æ®åº“è®¿é—®ç¼“æ…¢ï¼Œè®©æ£€æŸ¥ç³»ç»Ÿç£ç›˜ioï¼Œåº”ç”¨å±‚åˆ™æ˜¯è¡¨ç¤ºæœ€è¿‘æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œçªç„¶å°±å˜æ…¢äº†ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œæ²¡ä»€ä¹ˆåŠæ³•ï¼Œçœ‹ä¸‹å­˜å‚¨ç¡¬ä»¶æ²¡é—®é¢˜å°±ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠäº†ã€‚æ‚¨çœ‹è¿™ç§æƒ…å†µåº”è¯¥æ€ææ¸…æ¥šå…·ä½“åº•å±‚çš„åŸå› å‘¢","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437488,"discussion_content":"å¯¹æ•°æ®åº“æ¥è¯´ï¼ŒI/Oé—®é¢˜é™¤äº†ç¡¬ä»¶é”™è¯¯ä¹‹å¤–ï¼Œå¾ˆæœ‰å¯èƒ½é—®é¢˜å¤„åœ¨æ•°æ®åº“æœ¬èº«çš„ä½¿ç”¨ä¸Šã€‚æ‰€ä»¥ï¼Œå¯ä»¥ä»æ•°æ®åº“çš„ä½¿ç”¨ä¸Šå»æ’æŸ¥ï¼Œæ¯”å¦‚è¡¨ç»“æ„ã€SQLã€æ…¢æŸ¥è¯¢ç­‰ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2016221,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/c3/dd/33648195.jpg","nickname":"é‡‘åˆš","note":"","ucode":"9657132D6E5D9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586692,"discussion_content":"æœ€è¿‘é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼ŒåµŒå…¥å¼æ–¹é¢çš„ï¼Œå’Œ@zzl é‡åˆ°æƒ…å†µç±»ä¼¼ï¼Œä¸Šå±‚å‘å­˜å‚¨ç¡¬ç›˜ä¸­å†™æ•°æ®ï¼Œä½†è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œç¡¬ç›˜ioæ¥è¿‘100%ï¼ŒiostatæŸ¥çœ‹ç¡¬ç›˜iowait90%å¤šï¼Œåœ¨scsié©±åŠ¨å±‚åŠ æ‰“å°:scsi_executeå‡½æ•°å‰ååŠ å…¥è®¡æ—¶æ‰“å°ï¼Œå‘ç°è¿™ä¸ªæ‰§è¡Œå¾ˆæ…¢ï¼›è‡³äºåˆ°libataå±‚scsiä¸ataå‘½ä»¤è½¬æ¢ä»¥åŠmapåˆ°taskfileæ‰§è¡Œè¿˜æ²¡åšç»Ÿè®¡è®¡æ—¶åŠŸèƒ½ï¼Œç›®å‰å°šä¸å¯çŸ¥ï¼Œä½†scsiå±‚ç¡®å®æ‰§è¡Œæ—¶é—´æ¯”æ­£å¸¸æ—¶æ…¢äº†å‡ åå€ä¸æ­¢ï¼Œè¿™å°±å¯¼è‡´äº†ioå†™æ…¢ã€‚ã€‚ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662438018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å®‰å¾½"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62778,"user_name":"code2","can_delete":false,"product_type":"c1","uid":1281792,"ip_address":"","ucode":"BBA5748FB6A01C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/8OPzdpDraQMvCNWAicicDt54sDaIYJZicBLfMyibXVs4V0ZibEdkZlbzxxL7aGpRoeyvibag5LaAaaGKSdwYQMY2hUrQ/132","comment_is_top":false,"comment_ctime":1548155609,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1548155609","product_id":100020901,"comment_content":"è§‚å¯Ÿæ•°æ®åº“ç³»ç»Ÿçš„I&#47;Oé—®é¢˜æ—¶ï¼Œæ˜¯å¦æ³¨æ„åŠ›åº”é›†ä¸­åœ¨æ•°æ®åº“è¿›ç¨‹ä¸Šï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1479120,"avatar":"https://static001.geekbang.org/account/avatar/00/16/91/d0/35bc62b1.jpg","nickname":"æ— å’","note":"","ucode":"B9759B5646F3AB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587587,"discussion_content":"æœ‰å¯èƒ½è¢«å…¶å®ƒè¿›ç¨‹å½±å“ï¼Œè¿˜æ˜¯æŒ‰éƒ¨å°±ç­ç¨³å¦¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663157910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}