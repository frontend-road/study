{"id":79407,"title":"33 | æˆ‘æŸ¥è¿™ä¹ˆå¤šæ•°æ®ï¼Œä¼šä¸ä¼šæŠŠæ•°æ®åº“å†…å­˜æ‰“çˆ†ï¼Ÿ","content":"<p>æˆ‘ç»å¸¸ä¼šè¢«é—®åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘çš„ä¸»æœºå†…å­˜åªæœ‰100Gï¼Œç°åœ¨è¦å¯¹ä¸€ä¸ª200Gçš„å¤§è¡¨åšå…¨è¡¨æ‰«æï¼Œä¼šä¸ä¼šæŠŠæ•°æ®åº“ä¸»æœºçš„å†…å­˜ç”¨å…‰äº†ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜ç¡®å®å€¼å¾—æ‹…å¿ƒï¼Œè¢«ç³»ç»ŸOOMï¼ˆout of memoryï¼‰å¯ä¸æ˜¯é—¹ç€ç©çš„ã€‚ä½†æ˜¯ï¼Œåè¿‡æ¥æƒ³æƒ³ï¼Œé€»è¾‘å¤‡ä»½çš„æ—¶å€™ï¼Œå¯ä¸å°±æ˜¯åšæ•´åº“æ‰«æå—ï¼Ÿå¦‚æœè¿™æ ·å°±ä¼šæŠŠå†…å­˜åƒå…‰ï¼Œé€»è¾‘å¤‡ä»½ä¸æ˜¯æ—©å°±æŒ‚äº†ï¼Ÿ</p><p>æ‰€ä»¥è¯´ï¼Œå¯¹å¤§è¡¨åšå…¨è¡¨æ‰«æï¼Œçœ‹æ¥åº”è¯¥æ˜¯æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæµç¨‹åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><h1>å…¨è¡¨æ‰«æå¯¹serverå±‚çš„å½±å“</h1><p>å‡è®¾ï¼Œæˆ‘ä»¬ç°åœ¨è¦å¯¹ä¸€ä¸ª200Gçš„InnoDBè¡¨db1. tï¼Œæ‰§è¡Œä¸€ä¸ªå…¨è¡¨æ‰«æã€‚å½“ç„¶ï¼Œä½ è¦æŠŠæ‰«æç»“æœä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¼šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å‘½ä»¤ï¼š</p><pre><code>mysql -h$host -P$port -u$user -p$pwd -e &quot;select * from db1.t&quot; &gt; $target_file\n</code></pre><p>ä½ å·²ç»çŸ¥é“äº†ï¼ŒInnoDBçš„æ•°æ®æ˜¯ä¿å­˜åœ¨ä¸»é”®ç´¢å¼•ä¸Šçš„ï¼Œæ‰€ä»¥å…¨è¡¨æ‰«æå®é™…ä¸Šæ˜¯ç›´æ¥æ‰«æè¡¨tçš„ä¸»é”®ç´¢å¼•ã€‚è¿™æ¡æŸ¥è¯¢è¯­å¥ç”±äºæ²¡æœ‰å…¶ä»–çš„åˆ¤æ–­æ¡ä»¶ï¼Œæ‰€ä»¥æŸ¥åˆ°çš„æ¯ä¸€è¡Œéƒ½å¯ä»¥ç›´æ¥æ”¾åˆ°ç»“æœé›†é‡Œé¢ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™ä¸ªâ€œç»“æœé›†â€å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼ŒæœåŠ¡ç«¯å¹¶ä¸éœ€è¦ä¿å­˜ä¸€ä¸ªå®Œæ•´çš„ç»“æœé›†ã€‚å–æ•°æ®å’Œå‘æ•°æ®çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol>\n<li>\n<p>è·å–ä¸€è¡Œï¼Œå†™åˆ°net_bufferä¸­ã€‚è¿™å—å†…å­˜çš„å¤§å°æ˜¯ç”±å‚æ•°net_buffer_lengthå®šä¹‰çš„ï¼Œé»˜è®¤æ˜¯16kã€‚</p>\n</li>\n<li>\n<p>é‡å¤è·å–è¡Œï¼Œç›´åˆ°net_bufferå†™æ»¡ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘å‡ºå»ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå‘é€æˆåŠŸï¼Œå°±æ¸…ç©ºnet_bufferï¼Œç„¶åç»§ç»­å–ä¸‹ä¸€è¡Œï¼Œå¹¶å†™å…¥net_bufferã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå‘é€å‡½æ•°è¿”å›EAGAINæˆ–WSAEWOULDBLOCKï¼Œå°±è¡¨ç¤ºæœ¬åœ°ç½‘ç»œæ ˆï¼ˆsocket send bufferï¼‰å†™æ»¡äº†ï¼Œè¿›å…¥ç­‰å¾…ã€‚ç›´åˆ°ç½‘ç»œæ ˆé‡æ–°å¯å†™ï¼Œå†ç»§ç»­å‘é€ã€‚</p>\n</li>\n</ol><!-- [[[read_end]]] --><p>è¿™ä¸ªè¿‡ç¨‹å¯¹åº”çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a0/bd/a027c300d7dde8cea4fad8f34b670ebd.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾1 æŸ¥è¯¢ç»“æœå‘é€æµç¨‹</span></center><p>ä»è¿™ä¸ªæµç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼š</p><ol>\n<li>\n<p>ä¸€ä¸ªæŸ¥è¯¢åœ¨å‘é€è¿‡ç¨‹ä¸­ï¼Œå ç”¨çš„MySQLå†…éƒ¨çš„å†…å­˜æœ€å¤§å°±æ˜¯net_buffer_lengthè¿™ä¹ˆå¤§ï¼Œå¹¶ä¸ä¼šè¾¾åˆ°200Gï¼›</p>\n</li>\n<li>\n<p>socket send buffer ä¹Ÿä¸å¯èƒ½è¾¾åˆ°200Gï¼ˆé»˜è®¤å®šä¹‰/proc/sys/net/core/wmem_defaultï¼‰ï¼Œå¦‚æœsocket send bufferè¢«å†™æ»¡ï¼Œå°±ä¼šæš‚åœè¯»æ•°æ®çš„æµç¨‹ã€‚</p>\n</li>\n</ol><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>MySQLæ˜¯â€œè¾¹è¯»è¾¹å‘çš„â€</strong>ï¼Œè¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœå®¢æˆ·ç«¯æ¥æ”¶å¾—æ…¢ï¼Œä¼šå¯¼è‡´MySQLæœåŠ¡ç«¯ç”±äºç»“æœå‘ä¸å‡ºå»ï¼Œè¿™ä¸ªäº‹åŠ¡çš„æ‰§è¡Œæ—¶é—´å˜é•¿ã€‚</p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªçŠ¶æ€ï¼Œå°±æ˜¯æˆ‘æ•…æ„è®©å®¢æˆ·ç«¯ä¸å»è¯»socket receive bufferä¸­çš„å†…å®¹ï¼Œç„¶ååœ¨æœåŠ¡ç«¯show processlistçœ‹åˆ°çš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/18/c3/183a704d4495bebbc13c524695b5b6c3.png?wh=1024*168\" alt=\"\"></p><center><span class=\"reference\">å›¾2 æœåŠ¡ç«¯å‘é€é˜»å¡</span></center><p>å¦‚æœä½ çœ‹åˆ°Stateçš„å€¼ä¸€ç›´å¤„äº<strong>â€œSending to clientâ€</strong>ï¼Œå°±è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ç½‘ç»œæ ˆå†™æ»¡äº†ã€‚</p><p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ›¾æåˆ°ï¼Œå¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨â€“quickå‚æ•°ï¼Œä¼šä½¿ç”¨mysql_use_resultæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯è¯»ä¸€è¡Œå¤„ç†ä¸€è¡Œã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå‡è®¾æœ‰ä¸€ä¸ªä¸šåŠ¡çš„é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæ¯è¯»ä¸€è¡Œæ•°æ®ä»¥åè¦å¤„ç†çš„é€»è¾‘å¦‚æœå¾ˆæ…¢ï¼Œå°±ä¼šå¯¼è‡´å®¢æˆ·ç«¯è¦è¿‡å¾ˆä¹…æ‰ä¼šå»å–ä¸‹ä¸€è¡Œæ•°æ®ï¼Œå¯èƒ½å°±ä¼šå‡ºç°å¦‚å›¾2æ‰€ç¤ºçš„è¿™ç§æƒ…å†µã€‚</p><p>å› æ­¤ï¼Œ<strong>å¯¹äºæ­£å¸¸çš„çº¿ä¸Šä¸šåŠ¡æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢çš„è¿”å›ç»“æœä¸ä¼šå¾ˆå¤šçš„è¯ï¼Œæˆ‘éƒ½å»ºè®®ä½ ä½¿ç”¨mysql_store_resultè¿™ä¸ªæ¥å£ï¼Œç›´æ¥æŠŠæŸ¥è¯¢ç»“æœä¿å­˜åˆ°æœ¬åœ°å†…å­˜ã€‚</strong></p><p>å½“ç„¶å‰ææ˜¯æŸ¥è¯¢è¿”å›ç»“æœä¸å¤šã€‚åœ¨<a href=\"https://time.geekbang.org/column/article/78427\">ç¬¬30ç¯‡æ–‡ç« </a>è¯„è®ºåŒºï¼Œæœ‰åŒå­¦è¯´åˆ°è‡ªå·±å› ä¸ºæ‰§è¡Œäº†ä¸€ä¸ªå¤§æŸ¥è¯¢å¯¼è‡´å®¢æˆ·ç«¯å ç”¨å†…å­˜è¿‘20Gï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æ”¹ç”¨mysql_use_resultæ¥å£äº†ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ åœ¨è‡ªå·±è´Ÿè´£ç»´æŠ¤çš„MySQLé‡Œçœ‹åˆ°å¾ˆå¤šä¸ªçº¿ç¨‹éƒ½å¤„äºâ€œSending to clientâ€è¿™ä¸ªçŠ¶æ€ï¼Œå°±æ„å‘³ç€ä½ è¦è®©ä¸šåŠ¡å¼€å‘åŒå­¦ä¼˜åŒ–æŸ¥è¯¢ç»“æœï¼Œå¹¶è¯„ä¼°è¿™ä¹ˆå¤šçš„è¿”å›ç»“æœæ˜¯å¦åˆç†ã€‚</p><p>è€Œå¦‚æœè¦å¿«é€Ÿå‡å°‘å¤„äºè¿™ä¸ªçŠ¶æ€çš„çº¿ç¨‹çš„è¯ï¼Œå°†net_buffer_lengthå‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªæ›´å¤§çš„å€¼æ˜¯ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚</p><p>ä¸â€œSending to clientâ€é•¿ç›¸å¾ˆç±»ä¼¼çš„ä¸€ä¸ªçŠ¶æ€æ˜¯<strong>â€œSending dataâ€</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªç»å¸¸è¢«è¯¯ä¼šçš„é—®é¢˜ã€‚æœ‰åŒå­¦é—®æˆ‘è¯´ï¼Œåœ¨è‡ªå·±ç»´æŠ¤çš„å®ä¾‹ä¸Šçœ‹åˆ°å¾ˆå¤šæŸ¥è¯¢è¯­å¥çš„çŠ¶æ€æ˜¯â€œSending dataâ€ï¼Œä½†æŸ¥çœ‹ç½‘ç»œä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜å•Šï¼Œä¸ºä»€ä¹ˆSending dataè¦è¿™ä¹ˆä¹…ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„çŠ¶æ€å˜åŒ–æ˜¯è¿™æ ·çš„ï¼ˆæ³¨æ„ï¼šè¿™é‡Œï¼Œæˆ‘ç•¥å»äº†å…¶ä»–æ— å…³çš„çŠ¶æ€ï¼‰ï¼š</p><ul>\n<li>MySQLæŸ¥è¯¢è¯­å¥è¿›å…¥æ‰§è¡Œé˜¶æ®µåï¼Œé¦–å…ˆæŠŠçŠ¶æ€è®¾ç½®æˆâ€œSending dataâ€ï¼›</li>\n<li>ç„¶åï¼Œå‘é€æ‰§è¡Œç»“æœçš„åˆ—ç›¸å…³çš„ä¿¡æ¯ï¼ˆmeta data) ç»™å®¢æˆ·ç«¯ï¼›</li>\n<li>å†ç»§ç»­æ‰§è¡Œè¯­å¥çš„æµç¨‹ï¼›</li>\n<li>æ‰§è¡Œå®Œæˆåï¼ŒæŠŠçŠ¶æ€è®¾ç½®æˆç©ºå­—ç¬¦ä¸²ã€‚</li>\n</ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œâ€œSending dataâ€å¹¶ä¸ä¸€å®šæ˜¯æŒ‡â€œæ­£åœ¨å‘é€æ•°æ®â€ï¼Œè€Œå¯èƒ½æ˜¯å¤„äºæ‰§è¡Œå™¨è¿‡ç¨‹ä¸­çš„ä»»æ„é˜¶æ®µã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ„é€ ä¸€ä¸ªé”ç­‰å¾…çš„åœºæ™¯ï¼Œå°±èƒ½çœ‹åˆ°Sending dataçŠ¶æ€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/76/4b/7640b0d82965bf8b305514f30425424b.png?wh=1246*278\" alt=\"\"></p><center><span class=\"reference\">å›¾3 è¯»å…¨è¡¨è¢«é”</span></center><p><img src=\"https://static001.geekbang.org/resource/image/84/c0/84533515cf36be65582309fbb85e13c0.png?wh=1224*190\" alt=\"\"></p><center><span class=\"reference\">å›¾ 4 Sending dataçŠ¶æ€</span></center><p>å¯ä»¥çœ‹åˆ°ï¼Œsession Bæ˜æ˜¾æ˜¯åœ¨ç­‰é”ï¼ŒçŠ¶æ€æ˜¾ç¤ºä¸ºSending dataã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»…å½“ä¸€ä¸ªçº¿ç¨‹å¤„äºâ€œç­‰å¾…å®¢æˆ·ç«¯æ¥æ”¶ç»“æœâ€çš„çŠ¶æ€ï¼Œæ‰ä¼šæ˜¾ç¤º\"Sending to client\"ï¼›è€Œå¦‚æœæ˜¾ç¤ºæˆâ€œSending dataâ€ï¼Œå®ƒçš„æ„æ€åªæ˜¯â€œæ­£åœ¨æ‰§è¡Œâ€ã€‚</p><p>ç°åœ¨ä½ çŸ¥é“äº†ï¼ŒæŸ¥è¯¢çš„ç»“æœæ˜¯åˆ†æ®µå‘ç»™å®¢æˆ·ç«¯çš„ï¼Œå› æ­¤æ‰«æå…¨è¡¨ï¼ŒæŸ¥è¯¢è¿”å›å¤§é‡çš„æ•°æ®ï¼Œå¹¶ä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚</p><p>åœ¨serverå±‚çš„å¤„ç†é€»è¾‘æˆ‘ä»¬éƒ½æ¸…æ¥šäº†ï¼Œåœ¨InnoDBå¼•æ“é‡Œé¢åˆæ˜¯æ€ä¹ˆå¤„ç†çš„å‘¢ï¼Ÿ æ‰«æå…¨è¡¨ä¼šä¸ä¼šå¯¹å¼•æ“ç³»ç»Ÿé€ æˆå½±å“å‘¢ï¼Ÿ</p><h1>å…¨è¡¨æ‰«æå¯¹InnoDBçš„å½±å“</h1><p>åœ¨<a href=\"https://time.geekbang.org/column/article/68633\">ç¬¬2</a>å’Œ<a href=\"https://time.geekbang.org/column/article/73161\">ç¬¬15ç¯‡</a>æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»WALæœºåˆ¶çš„æ—¶å€™ï¼Œå’Œä½ åˆ†æäº†InnoDBå†…å­˜çš„ä¸€ä¸ªä½œç”¨ï¼Œæ˜¯ä¿å­˜æ›´æ–°çš„ç»“æœï¼Œå†é…åˆredo logï¼Œå°±é¿å…äº†éšæœºå†™ç›˜ã€‚</p><p>å†…å­˜çš„æ•°æ®é¡µæ˜¯åœ¨Buffer Pool (BP)ä¸­ç®¡ç†çš„ï¼Œåœ¨WALé‡ŒBuffer Pool èµ·åˆ°äº†åŠ é€Ÿæ›´æ–°çš„ä½œç”¨ã€‚è€Œå®é™…ä¸Šï¼ŒBuffer Pool è¿˜æœ‰ä¸€ä¸ªæ›´é‡è¦çš„ä½œç”¨ï¼Œå°±æ˜¯åŠ é€ŸæŸ¥è¯¢ã€‚</p><p>åœ¨ç¬¬2ç¯‡æ–‡ç« çš„è¯„è®ºåŒºæœ‰åŒå­¦é—®é“ï¼Œç”±äºæœ‰WALæœºåˆ¶ï¼Œå½“äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œç£ç›˜ä¸Šçš„æ•°æ®é¡µæ˜¯æ—§çš„ï¼Œé‚£å¦‚æœè¿™æ—¶å€™é©¬ä¸Šæœ‰ä¸€ä¸ªæŸ¥è¯¢è¦æ¥è¯»è¿™ä¸ªæ•°æ®é¡µï¼Œæ˜¯ä¸æ˜¯è¦é©¬ä¸ŠæŠŠredo logåº”ç”¨åˆ°æ•°æ®é¡µå‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä¸éœ€è¦ã€‚å› ä¸ºè¿™æ—¶å€™å†…å­˜æ•°æ®é¡µçš„ç»“æœæ˜¯æœ€æ–°çš„ï¼Œç›´æ¥è¯»å†…å­˜é¡µå°±å¯ä»¥äº†ã€‚ä½ çœ‹ï¼Œè¿™æ—¶å€™æŸ¥è¯¢æ ¹æœ¬ä¸éœ€è¦è¯»ç£ç›˜ï¼Œç›´æ¥ä»å†…å­˜æ‹¿ç»“æœï¼Œé€Ÿåº¦æ˜¯å¾ˆå¿«çš„ã€‚æ‰€ä»¥è¯´ï¼ŒBuffer Poolè¿˜æœ‰åŠ é€ŸæŸ¥è¯¢çš„ä½œç”¨ã€‚</p><p>è€ŒBuffer Poolå¯¹æŸ¥è¯¢çš„åŠ é€Ÿæ•ˆæœï¼Œä¾èµ–äºä¸€ä¸ªé‡è¦çš„æŒ‡æ ‡ï¼Œå³ï¼š<strong>å†…å­˜å‘½ä¸­ç‡</strong>ã€‚</p><p>ä½ å¯ä»¥åœ¨show engine innodb statusç»“æœä¸­ï¼ŒæŸ¥çœ‹ä¸€ä¸ªç³»ç»Ÿå½“å‰çš„BPå‘½ä¸­ç‡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç¨³å®šæœåŠ¡çš„çº¿ä¸Šç³»ç»Ÿï¼Œè¦ä¿è¯å“åº”æ—¶é—´ç¬¦åˆè¦æ±‚çš„è¯ï¼Œå†…å­˜å‘½ä¸­ç‡è¦åœ¨99%ä»¥ä¸Šã€‚</p><p>æ‰§è¡Œshow engine innodb status ï¼Œå¯ä»¥çœ‹åˆ°â€œBuffer pool hit rateâ€å­—æ ·ï¼Œæ˜¾ç¤ºçš„å°±æ˜¯å½“å‰çš„å‘½ä¸­ç‡ã€‚æ¯”å¦‚å›¾5è¿™ä¸ªå‘½ä¸­ç‡ï¼Œå°±æ˜¯99.0%ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/2e/c70a95ee99826812c292c46de508982e.png?wh=457*42\" alt=\"\"></p><center><span class=\"reference\">å›¾5 show engine innodb statusæ˜¾ç¤ºå†…å­˜å‘½ä¸­ç‡</span></center><p>å¦‚æœæ‰€æœ‰æŸ¥è¯¢éœ€è¦çš„æ•°æ®é¡µéƒ½èƒ½å¤Ÿç›´æ¥ä»å†…å­˜å¾—åˆ°ï¼Œé‚£æ˜¯æœ€å¥½çš„ï¼Œå¯¹åº”çš„å‘½ä¸­ç‡å°±æ˜¯100%ã€‚ä½†ï¼Œè¿™åœ¨å®é™…ç”Ÿäº§ä¸Šæ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚</p><p>InnoDB Buffer Poolçš„å¤§å°æ˜¯ç”±å‚æ•° innodb_buffer_pool_sizeç¡®å®šçš„ï¼Œä¸€èˆ¬å»ºè®®è®¾ç½®æˆå¯ç”¨ç‰©ç†å†…å­˜çš„60%~80%ã€‚</p><p>åœ¨å¤§çº¦åå¹´å‰ï¼Œå•æœºçš„æ•°æ®é‡æ˜¯ä¸Šç™¾ä¸ªGï¼Œè€Œç‰©ç†å†…å­˜æ˜¯å‡ ä¸ªGï¼›ç°åœ¨è™½ç„¶å¾ˆå¤šæœåŠ¡å™¨éƒ½èƒ½æœ‰128Gç”šè‡³æ›´é«˜çš„å†…å­˜ï¼Œä½†æ˜¯å•æœºçš„æ•°æ®é‡å´è¾¾åˆ°äº†Tçº§åˆ«ã€‚</p><p>æ‰€ä»¥ï¼Œinnodb_buffer_pool_sizeå°äºç£ç›˜çš„æ•°æ®é‡æ˜¯å¾ˆå¸¸è§çš„ã€‚å¦‚æœä¸€ä¸ª Buffer Poolæ»¡äº†ï¼Œè€Œåˆè¦ä»ç£ç›˜è¯»å…¥ä¸€ä¸ªæ•°æ®é¡µï¼Œé‚£è‚¯å®šæ˜¯è¦æ·˜æ±°ä¸€ä¸ªæ—§æ•°æ®é¡µçš„ã€‚</p><p>InnoDBå†…å­˜ç®¡ç†ç”¨çš„æ˜¯æœ€è¿‘æœ€å°‘ä½¿ç”¨ (Least Recently Used, LRU)ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯æ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªLRUç®—æ³•çš„åŸºæœ¬æ¨¡å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e0/65/e0ac92febac50a5d881f1188ea5bfd65.jpg?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾6 åŸºæœ¬LRUç®—æ³•</span></center><p>InnoDBç®¡ç†Buffer Poolçš„LRUç®—æ³•ï¼Œæ˜¯ç”¨é“¾è¡¨æ¥å®ç°çš„ã€‚</p><ol>\n<li>\n<p>åœ¨å›¾6çš„çŠ¶æ€1é‡Œï¼Œé“¾è¡¨å¤´éƒ¨æ˜¯P1ï¼Œè¡¨ç¤ºP1æ˜¯æœ€è¿‘åˆšåˆšè¢«è®¿é—®è¿‡çš„æ•°æ®é¡µï¼›å‡è®¾å†…å­˜é‡Œåªèƒ½æ”¾ä¸‹è¿™ä¹ˆå¤šæ•°æ®é¡µï¼›</p>\n</li>\n<li>\n<p>è¿™æ—¶å€™æœ‰ä¸€ä¸ªè¯»è¯·æ±‚è®¿é—®P3ï¼Œå› æ­¤å˜æˆçŠ¶æ€2ï¼ŒP3è¢«ç§»åˆ°æœ€å‰é¢ï¼›</p>\n</li>\n<li>\n<p>çŠ¶æ€3è¡¨ç¤ºï¼Œè¿™æ¬¡è®¿é—®çš„æ•°æ®é¡µæ˜¯ä¸å­˜åœ¨äºé“¾è¡¨ä¸­çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨Buffer Poolä¸­æ–°ç”³è¯·ä¸€ä¸ªæ•°æ®é¡µPxï¼ŒåŠ åˆ°é“¾è¡¨å¤´éƒ¨ã€‚ä½†æ˜¯ç”±äºå†…å­˜å·²ç»æ»¡äº†ï¼Œä¸èƒ½ç”³è¯·æ–°çš„å†…å­˜ã€‚äºæ˜¯ï¼Œä¼šæ¸…ç©ºé“¾è¡¨æœ«å°¾Pmè¿™ä¸ªæ•°æ®é¡µçš„å†…å­˜ï¼Œå­˜å…¥Pxçš„å†…å®¹ï¼Œç„¶åæ”¾åˆ°é“¾è¡¨å¤´éƒ¨ã€‚</p>\n</li>\n<li>\n<p>ä»æ•ˆæœä¸Šçœ‹ï¼Œå°±æ˜¯æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„æ•°æ®é¡µPmï¼Œè¢«æ·˜æ±°äº†ã€‚</p>\n</li>\n</ol><p>è¿™ä¸ªç®—æ³•ä¹ä¸€çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœè€ƒè™‘åˆ°è¦åšä¸€ä¸ªå…¨è¡¨æ‰«æï¼Œä¼šä¸ä¼šæœ‰é—®é¢˜å‘¢ï¼Ÿ</p><p>å‡è®¾æŒ‰ç…§è¿™ä¸ªç®—æ³•ï¼Œæˆ‘ä»¬è¦æ‰«æä¸€ä¸ª200Gçš„è¡¨ï¼Œè€Œè¿™ä¸ªè¡¨æ˜¯ä¸€ä¸ªå†å²æ•°æ®è¡¨ï¼Œå¹³æ—¶æ²¡æœ‰ä¸šåŠ¡è®¿é—®å®ƒã€‚</p><p>é‚£ä¹ˆï¼ŒæŒ‰ç…§è¿™ä¸ªç®—æ³•æ‰«æçš„è¯ï¼Œå°±ä¼šæŠŠå½“å‰çš„Buffer Poolé‡Œçš„æ•°æ®å…¨éƒ¨æ·˜æ±°æ‰ï¼Œå­˜å…¥æ‰«æè¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„æ•°æ®é¡µçš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´Buffer Poolé‡Œé¢ä¸»è¦æ”¾çš„æ˜¯è¿™ä¸ªå†å²æ•°æ®è¡¨çš„æ•°æ®ã€‚</p><p>å¯¹äºä¸€ä¸ªæ­£åœ¨åšä¸šåŠ¡æœåŠ¡çš„åº“ï¼Œè¿™å¯ä¸å¦™ã€‚ä½ ä¼šçœ‹åˆ°ï¼ŒBuffer Poolçš„å†…å­˜å‘½ä¸­ç‡æ€¥å‰§ä¸‹é™ï¼Œç£ç›˜å‹åŠ›å¢åŠ ï¼ŒSQLè¯­å¥å“åº”å˜æ…¢ã€‚</p><p>æ‰€ä»¥ï¼ŒInnoDBä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™ä¸ªLRUç®—æ³•ã€‚å®é™…ä¸Šï¼ŒInnoDBå¯¹LRUç®—æ³•åšäº†æ”¹è¿›ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/21/28/21f64a6799645b1410ed40d016139828.png?wh=1142*880\" alt=\"\"></p><center><span class=\"reference\">å›¾ 7 æ”¹è¿›çš„LRUç®—æ³•</span></center><p>åœ¨InnoDBå®ç°ä¸Šï¼ŒæŒ‰ç…§5:3çš„æ¯”ä¾‹æŠŠæ•´ä¸ªLRUé“¾è¡¨åˆ†æˆäº†youngåŒºåŸŸå’ŒoldåŒºåŸŸã€‚å›¾ä¸­LRU_oldæŒ‡å‘çš„å°±æ˜¯oldåŒºåŸŸçš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œæ˜¯æ•´ä¸ªé“¾è¡¨çš„5/8å¤„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé è¿‘é“¾è¡¨å¤´éƒ¨çš„5/8æ˜¯youngåŒºåŸŸï¼Œé è¿‘é“¾è¡¨å°¾éƒ¨çš„3/8æ˜¯oldåŒºåŸŸã€‚</p><p>æ”¹è¿›åçš„LRUç®—æ³•æ‰§è¡Œæµç¨‹å˜æˆäº†ä¸‹é¢è¿™æ ·ã€‚</p><ol>\n<li>\n<p>å›¾7ä¸­çŠ¶æ€1ï¼Œè¦è®¿é—®æ•°æ®é¡µP3ï¼Œç”±äºP3åœ¨youngåŒºåŸŸï¼Œå› æ­¤å’Œä¼˜åŒ–å‰çš„LRUç®—æ³•ä¸€æ ·ï¼Œå°†å…¶ç§»åˆ°é“¾è¡¨å¤´éƒ¨ï¼Œå˜æˆçŠ¶æ€2ã€‚</p>\n</li>\n<li>\n<p>ä¹‹åè¦è®¿é—®ä¸€ä¸ªæ–°çš„ä¸å­˜åœ¨äºå½“å‰é“¾è¡¨çš„æ•°æ®é¡µï¼Œè¿™æ—¶å€™ä¾ç„¶æ˜¯æ·˜æ±°æ‰æ•°æ®é¡µPmï¼Œä½†æ˜¯æ–°æ’å…¥çš„æ•°æ®é¡µPxï¼Œæ˜¯æ”¾åœ¨LRU_oldå¤„ã€‚</p>\n</li>\n<li>\n<p>å¤„äºoldåŒºåŸŸçš„æ•°æ®é¡µï¼Œæ¯æ¬¡è¢«è®¿é—®çš„æ—¶å€™éƒ½è¦åšä¸‹é¢è¿™ä¸ªåˆ¤æ–­ï¼š</p>\n<ul>\n<li>è‹¥è¿™ä¸ªæ•°æ®é¡µåœ¨LRUé“¾è¡¨ä¸­å­˜åœ¨çš„æ—¶é—´è¶…è¿‡äº†1ç§’ï¼Œå°±æŠŠå®ƒç§»åŠ¨åˆ°é“¾è¡¨å¤´éƒ¨ï¼›</li>\n<li>å¦‚æœè¿™ä¸ªæ•°æ®é¡µåœ¨LRUé“¾è¡¨ä¸­å­˜åœ¨çš„æ—¶é—´çŸ­äº1ç§’ï¼Œä½ç½®ä¿æŒä¸å˜ã€‚1ç§’è¿™ä¸ªæ—¶é—´ï¼Œæ˜¯ç”±å‚æ•°innodb_old_blocks_timeæ§åˆ¶çš„ã€‚å…¶é»˜è®¤å€¼æ˜¯1000ï¼Œå•ä½æ¯«ç§’ã€‚</li>\n</ul>\n</li>\n</ol><p>è¿™ä¸ªç­–ç•¥ï¼Œå°±æ˜¯ä¸ºäº†å¤„ç†ç±»ä¼¼å…¨è¡¨æ‰«æçš„æ“ä½œé‡èº«å®šåˆ¶çš„ã€‚è¿˜æ˜¯ä»¥åˆšåˆšçš„æ‰«æ200Gçš„å†å²æ•°æ®è¡¨ä¸ºä¾‹ï¼Œæˆ‘ä»¬çœ‹çœ‹æ”¹è¿›åçš„LRUç®—æ³•çš„æ“ä½œé€»è¾‘ï¼š</p><ol>\n<li>\n<p>æ‰«æè¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ–°æ’å…¥çš„æ•°æ®é¡µï¼Œéƒ½è¢«æ”¾åˆ°oldåŒºåŸŸ;</p>\n</li>\n<li>\n<p>ä¸€ä¸ªæ•°æ®é¡µé‡Œé¢æœ‰å¤šæ¡è®°å½•ï¼Œè¿™ä¸ªæ•°æ®é¡µä¼šè¢«å¤šæ¬¡è®¿é—®åˆ°ï¼Œä½†ç”±äºæ˜¯é¡ºåºæ‰«æï¼Œè¿™ä¸ªæ•°æ®é¡µç¬¬ä¸€æ¬¡è¢«è®¿é—®å’Œæœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´é—´éš”ä¸ä¼šè¶…è¿‡1ç§’ï¼Œå› æ­¤è¿˜æ˜¯ä¼šè¢«ä¿ç•™åœ¨oldåŒºåŸŸï¼›</p>\n</li>\n<li>\n<p>å†ç»§ç»­æ‰«æåç»­çš„æ•°æ®ï¼Œä¹‹å‰çš„è¿™ä¸ªæ•°æ®é¡µä¹‹åä¹Ÿä¸ä¼šå†è¢«è®¿é—®åˆ°ï¼Œäºæ˜¯å§‹ç»ˆæ²¡æœ‰æœºä¼šç§»åˆ°é“¾è¡¨å¤´éƒ¨ï¼ˆä¹Ÿå°±æ˜¯youngåŒºåŸŸï¼‰ï¼Œå¾ˆå¿«å°±ä¼šè¢«æ·˜æ±°å‡ºå»ã€‚</p>\n</li>\n</ol><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç­–ç•¥æœ€å¤§çš„æ”¶ç›Šï¼Œå°±æ˜¯åœ¨æ‰«æè¿™ä¸ªå¤§è¡¨çš„è¿‡ç¨‹ä¸­ï¼Œè™½ç„¶ä¹Ÿç”¨åˆ°äº†Buffer Poolï¼Œä½†æ˜¯å¯¹youngåŒºåŸŸå®Œå…¨æ²¡æœ‰å½±å“ï¼Œä»è€Œä¿è¯äº†Buffer Poolå“åº”æ­£å¸¸ä¸šåŠ¡çš„æŸ¥è¯¢å‘½ä¸­ç‡ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©ï¼Œæˆ‘ç”¨â€œå¤§æŸ¥è¯¢ä¼šä¸ä¼šæŠŠå†…å­˜ç”¨å…‰â€è¿™ä¸ªé—®é¢˜ï¼Œå’Œä½ ä»‹ç»äº†MySQLçš„æŸ¥è¯¢ç»“æœï¼Œå‘é€ç»™å®¢æˆ·ç«¯çš„è¿‡ç¨‹ã€‚</p><p>ç”±äºMySQLé‡‡ç”¨çš„æ˜¯è¾¹ç®—è¾¹å‘çš„é€»è¾‘ï¼Œå› æ­¤å¯¹äºæ•°æ®é‡å¾ˆå¤§çš„æŸ¥è¯¢ç»“æœæ¥è¯´ï¼Œä¸ä¼šåœ¨serverç«¯ä¿å­˜å®Œæ•´çš„ç»“æœé›†ã€‚æ‰€ä»¥ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯»ç»“æœä¸åŠæ—¶ï¼Œä¼šå µä½MySQLçš„æŸ¥è¯¢è¿‡ç¨‹ï¼Œä½†æ˜¯ä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚</p><p>è€Œå¯¹äºInnoDBå¼•æ“å†…éƒ¨ï¼Œç”±äºæœ‰æ·˜æ±°ç­–ç•¥ï¼Œå¤§æŸ¥è¯¢ä¹Ÿä¸ä¼šå¯¼è‡´å†…å­˜æš´æ¶¨ã€‚å¹¶ä¸”ï¼Œç”±äºInnoDBå¯¹LRUç®—æ³•åšäº†æ”¹è¿›ï¼Œå†·æ•°æ®çš„å…¨è¡¨æ‰«æï¼Œå¯¹Buffer Poolçš„å½±å“ä¹Ÿèƒ½åšåˆ°å¯æ§ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬å‰é¢æ–‡ç« æœ‰è¯´è¿‡ï¼Œå…¨è¡¨æ‰«æè¿˜æ˜¯æ¯”è¾ƒè€—è´¹IOèµ„æºçš„ï¼Œæ‰€ä»¥ä¸šåŠ¡é«˜å³°æœŸè¿˜æ˜¯ä¸èƒ½ç›´æ¥åœ¨çº¿ä¸Šä¸»åº“æ‰§è¡Œå…¨è¡¨æ‰«æçš„ã€‚</p><p>æœ€åï¼Œæˆ‘ç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜å§ã€‚</p><p>æˆ‘åœ¨æ–‡ç« ä¸­è¯´åˆ°ï¼Œå¦‚æœç”±äºå®¢æˆ·ç«¯å‹åŠ›å¤ªå¤§ï¼Œè¿Ÿè¿Ÿä¸èƒ½æ¥æ”¶ç»“æœï¼Œä¼šå¯¼è‡´MySQLæ— æ³•å‘é€ç»“æœè€Œå½±å“è¯­å¥æ‰§è¡Œã€‚ä½†ï¼Œè¿™è¿˜ä¸æ˜¯æœ€ç³Ÿç³•çš„æƒ…å†µã€‚</p><p>ä½ å¯ä»¥è®¾æƒ³å‡ºç”±äºå®¢æˆ·ç«¯çš„æ€§èƒ½é—®é¢˜ï¼Œå¯¹æ•°æ®åº“å½±å“æ›´ä¸¥é‡çš„ä¾‹å­å—ï¼Ÿæˆ–è€…ä½ æ˜¯å¦ç»å†è¿‡è¿™æ ·çš„åœºæ™¯ï¼Ÿä½ åˆæ˜¯æ€ä¹ˆä¼˜åŒ–çš„ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„ç»éªŒå’Œåˆ†æå†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸçš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡è¢«killä¹‹åï¼ŒæŒç»­å¤„äºå›æ»šçŠ¶æ€ï¼Œä»æ¢å¤é€Ÿåº¦çš„è§’åº¦çœ‹ï¼Œä½ æ˜¯åº”è¯¥é‡å¯ç­‰å®ƒæ‰§è¡Œç»“æŸï¼Œè¿˜æ˜¯åº”è¯¥å¼ºè¡Œé‡å¯æ•´ä¸ªMySQLè¿›ç¨‹ã€‚</p><p>å› ä¸ºé‡å¯ä¹‹åè¯¥åšçš„å›æ»šåŠ¨ä½œè¿˜æ˜¯ä¸èƒ½å°‘çš„ï¼Œæ‰€ä»¥ä»æ¢å¤é€Ÿåº¦çš„è§’åº¦æ¥è¯´ï¼Œåº”è¯¥è®©å®ƒè‡ªå·±ç»“æŸã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœè¿™ä¸ªè¯­å¥å¯èƒ½ä¼šå ç”¨åˆ«çš„é”ï¼Œæˆ–è€…ç”±äºå ç”¨IOèµ„æºè¿‡å¤šï¼Œä»è€Œå½±å“åˆ°äº†åˆ«çš„è¯­å¥æ‰§è¡Œçš„è¯ï¼Œå°±éœ€è¦å…ˆåšä¸»å¤‡åˆ‡æ¢ï¼Œåˆ‡åˆ°æ–°ä¸»åº“æä¾›æœåŠ¡ã€‚</p><p>åˆ‡æ¢ä¹‹ååˆ«çš„çº¿ç¨‹éƒ½æ–­å¼€äº†è¿æ¥ï¼Œè‡ªåŠ¨åœæ­¢æ‰§è¡Œã€‚æ¥ä¸‹æ¥è¿˜æ˜¯ç­‰å®ƒè‡ªå·±æ‰§è¡Œå®Œæˆã€‚è¿™ä¸ªæ“ä½œå±äºæˆ‘ä»¬åœ¨æ–‡ç« ä¸­è¯´åˆ°çš„ï¼Œå‡å°‘ç³»ç»Ÿå‹åŠ›ï¼ŒåŠ é€Ÿç»ˆæ­¢é€»è¾‘ã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>\n<p>@HuaMax çš„å›ç­”ä¸­æåˆ°äº†å¯¹å…¶ä»–çº¿ç¨‹çš„å½±å“ï¼›<br>\n@å¤¹å¿ƒé¢åŒ… @Ryoma @æ›¾å‰‘ åŒå­¦æåˆ°äº†é‡å¯åä¾ç„¶ç»§ç»­åšå›æ»šæ“ä½œçš„é€»è¾‘ã€‚</p>\n</blockquote><p></p>","comments":[{"had_liked":false,"id":64042,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":true,"comment_ctime":1548646275,"is_pvip":false,"replies":[{"id":"22654","content":"å¥½é—®é¢˜ğŸ‘ å¾ˆå¥½çš„æ€è€ƒğŸ‘<br><br>æ˜¯è¿™æ ·çš„ï¼Œnet_buffer_length çš„æœ€å¤§å€¼æ˜¯ 1Gï¼Œè¿™ä¸ªå€¼æ¯” socket send bufferå¤§ï¼ˆä¸€èˆ¬æ˜¯å‡ Mï¼‰<br><br>æ¯”å¦‚å‡è®¾ä¸€ä¸ªä¸šåŠ¡ï¼Œä»–çš„å¹³å‡æŸ¥è¯¢ç»“æœéƒ½æ˜¯10M ï¼ˆå½“ç„¶è¿™ä¸ªä¸šåŠ¡æœ‰æœ‰é—®é¢˜ï¼Œæœ€ç»ˆæ˜¯è¦é€šè¿‡ä¸šåŠ¡è§£å†³ï¼‰<br><br>ä½†æ˜¯å¦‚æœæˆ‘æŠŠnet_buffer_length æ”¹æˆ10Mï¼Œå°±ä¸ä¼šæœ‰â€œSending to clientâ€ çš„æƒ…å†µã€‚è™½ç„¶ç½‘ç»œæ ˆè¿˜æ˜¯æ…¢æ…¢å‘çš„ï¼Œä½†æ˜¯é‚£äº›æ²¡å‘å®Œçš„éƒ½ç¼“å­˜åœ¨net_bufferä¸­ï¼Œå¯¹äºæ‰§è¡Œå™¨æ¥è¯´ï¼Œéƒ½æ˜¯â€œå·²ç»å†™å‡ºå»äº†â€ã€‚<br>","user_name":"ä½œè€…å›å¤","comment_id":64042,"uid":"1264162","ip_address":"","utype":1,"ctime":1548655904,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":9,"race_medal":0,"score":"9.2233724378353992e+18","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚æ ¹æ®æ–‡ç« å†…å®¹ï¼Œæç‚¼å¦‚ä¸‹ä¿¡æ¯ï¼š<br>å¦‚æœä½ çœ‹åˆ° State çš„å€¼ä¸€ç›´å¤„äºâ€œSending to clientâ€ï¼Œå°±è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ç½‘ç»œæ ˆå†™æ»¡äº†ã€‚<br>å¦‚ä½•å¤„ç†ï¼Ÿ<br>1)ä½¿ç”¨ mysql_store_result è¿™ä¸ªæ¥å£ï¼Œç›´æ¥æŠŠæŸ¥è¯¢ç»“æœä¿å­˜åˆ°æœ¬åœ°å†…å­˜ã€‚<br>2)ä¼˜åŒ–æŸ¥è¯¢ç»“æœï¼Œå¹¶è¯„ä¼°è¿™ä¹ˆå¤šçš„è¿”å›ç»“æœæ˜¯å¦åˆç†ã€‚<br>3)è€Œå¦‚æœè¦å¿«é€Ÿå‡å°‘å¤„äºè¿™ä¸ªçŠ¶æ€çš„çº¿ç¨‹çš„è¯ï¼Œå°† net_buffer_length å‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªæ›´å¤§çš„å€¼æ˜¯ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚<br>å¯¹äºç¬¬3)æ–¹æ¡ˆä¸æ˜¯å¾ˆæ‡‚ï¼Œâ€œSending to clientâ€ è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ç½‘è·¯æ ˆå†™æ»¡äº†ï¼Œé‚£ä¸æ˜¯åº”è¯¥åŠ å¤§ socket send buffer å—ï¼Ÿè·ŸåŠ å¤§ net_buffer_length æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿnet_buffer_length åŠ å†å¤§ï¼Œä½† socket send buffer å¾ˆå°çš„è¯ï¼Œç½‘ç»œæ ˆä¸è¿˜æ˜¯å¤„äºå†™æ»¡çŠ¶æ€ï¼Ÿ","like_count":92,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437826,"discussion_content":"å¥½é—®é¢˜ğŸ‘ å¾ˆå¥½çš„æ€è€ƒğŸ‘\n\næ˜¯è¿™æ ·çš„ï¼Œnet_buffer_length çš„æœ€å¤§å€¼æ˜¯ 1Gï¼Œè¿™ä¸ªå€¼æ¯” socket send bufferå¤§ï¼ˆä¸€èˆ¬æ˜¯å‡ Mï¼‰\n\næ¯”å¦‚å‡è®¾ä¸€ä¸ªä¸šåŠ¡ï¼Œä»–çš„å¹³å‡æŸ¥è¯¢ç»“æœéƒ½æ˜¯10M ï¼ˆå½“ç„¶è¿™ä¸ªä¸šåŠ¡æœ‰æœ‰é—®é¢˜ï¼Œæœ€ç»ˆæ˜¯è¦é€šè¿‡ä¸šåŠ¡è§£å†³ï¼‰\n\nä½†æ˜¯å¦‚æœæˆ‘æŠŠnet_buffer_length æ”¹æˆ10Mï¼Œå°±ä¸ä¼šæœ‰â€œSending to clientâ€ çš„æƒ…å†µã€‚è™½ç„¶ç½‘ç»œæ ˆè¿˜æ˜¯æ…¢æ…¢å‘çš„ï¼Œä½†æ˜¯é‚£äº›æ²¡å‘å®Œçš„éƒ½ç¼“å­˜åœ¨net_bufferä¸­ï¼Œå¯¹äºæ‰§è¡Œå™¨æ¥è¯´ï¼Œéƒ½æ˜¯â€œå·²ç»å†™å‡ºå»äº†â€ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548655904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1228424,"avatar":"https://static001.geekbang.org/account/avatar/00/12/be/88/8d15796f.jpg","nickname":"John","note":"","ucode":"A46AF2906C38C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311187,"discussion_content":"Each client thread is associated with a connection buffer and result buffer. Both begin with a size given by net_buffer_length but are dynamically enlarged up to max_allowed_packet bytes as needed. The result buffer shrinks to net_buffer_length after each SQL statement.\n\nThis variable should not normally be changed, but if you have very little memory, you can set it to the expected length of statements sent by clients. If statements exceed this length, the connection buffer is automatically enlarged. The maximum value to which net_buffer_length can be set is 1MB.\n\nThe session value of this variable is read only.\n\né’ˆå¯¹æ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥éƒ½ä¼šæœ‰ä¸¤ä¸ªç¼“å†²åŒºï¼Œä¸€ä¸ªæ˜¯è¿æ¥ç¼“å†²ä¸€ä¸ªæ˜¯ç»“æœé›†ç¼“å†²ï¼Œnet_buffer_length æŒ‡å®šè¿™ä¸ªç¼“å†²åŒºçš„åˆå§‹å€¼ï¼Œmax_allowed_packet æ˜¯è¿™ä¸ªç¼“å†²åŒºå¯ä»¥è¾¾åˆ°çš„æœ€å¤§å€¼ï¼Œç¼“å†²åŒºéšç€éœ€è¦æ‰©å®¹ã€‚ç»“æœé›†æ¯æ¬¡ statement æ‰§è¡Œä¹‹åä¼šæ¢å¤ä¸ºåˆå§‹å€¼å³ net_buffer_length\n\nhttps://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_net_buffer_length","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1602247471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1368901,"avatar":"","nickname":"miu","note":"","ucode":"3D73FF3C09231A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135116,"discussion_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚\nå®˜æ–¹æ–‡æ¡£ä¸­net_buffer_lengthæœ€å¤§å¯è®¾ç½®çš„å€¼æ˜¯1Mï¼Œmax_allowed_packetæœ€å¤§å¯è®¾ç½®çš„å€¼æ˜¯1Gï¼Œâ€œæ˜¯è¿™æ ·çš„ï¼Œnet_buffer_length çš„æœ€å¤§å€¼æ˜¯ 1Gâ€è¿™å¥è¯æ˜¯ä¸æ˜¯è¯´net_bufferæœ€å¤§å¯è¾¾åˆ°1Gï¼ˆå³max_allowed_packetçš„æœ€å¤§å¯è®¾ç½®å€¼ï¼‰ã€‚\né‚£ä¹ˆnet_bufferå†™æ»¡æ˜¯æŒ‡å†™åˆ°net_buffer_lengthè®¾ç½®çš„å€¼ï¼Œè¿˜æ˜¯max_allowed_packetçš„å€¼å‘¢ï¼Ÿ","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1579069958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2761358,"avatar":"","nickname":"Geek_d38758","note":"","ucode":"7BE0963E18DDDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404657,"discussion_content":"è¿˜æ˜¯æ²¡æ‡‚ï¼Œè¢«ç»•è¿›å»äº†\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1634375032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1195775,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3e/ff/657b8d76.jpg","nickname":"æ¨å¯","note":"","ucode":"F9D43CADAC2B8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2761358,"avatar":"","nickname":"Geek_d38758","note":"","ucode":"7BE0963E18DDDC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557883,"discussion_content":"ä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œè¯­å¥çš„æŸ¥è¯¢ç»“æœå¦‚æœå…¨éƒ¨æ”¾å…¥äº† net_buffer é‡Œï¼Œå°±è¡¨ç¤ºè¯­å¥æ‰§è¡Œç»“æŸäº†ï¼Œä¸ä¼šé˜»å¡åé¢çš„è¯­å¥æ‰§è¡Œã€‚socket send buffer åªè´Ÿè´£æŠŠç»“æœå‘ç»™å®¢æˆ·ç«¯ï¼Œä¸éœ€è¦ç­‰ socket send buffer é‡Œçš„å†…å®¹éƒ½å‘å‡ºå»äº†æ‰è®¤ä¸ºè¯­å¥æ‰§è¡Œç»“æŸã€‚è°ƒå¤§ net_buffer_length çš„å€¼å¯ä»¥æ”¾å…¥æ›´å¤šçš„è¯­å¥æ‰§è¡Œç»“æœ","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1648017206,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":404657,"ip_address":""},"score":557883,"extra":""}]},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588093,"discussion_content":"å…¶å®å¯ä»¥ç†è§£ä¸ºsocketoutputstreamå¤–é¢å¥—äº†ä¸€å±‚bufferï¼›bufferçš„å®¹é‡å°±æ˜¯net_buffer_lengthï¼Œåªæœ‰è¾¾åˆ°net_buffer_lengthæ‰ä¼šè°ƒç”¨ä¸€æ¬¡çœŸæ­£çš„writeæ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663551970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098505,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c3/09/dc368335.jpg","nickname":"æ°sir","note":"","ucode":"80BB56B3BFB71A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556926,"discussion_content":"å°è¯•å›å¤ @miu çš„æé—®ï¼š\nmax_allowed_packet é™åˆ¶net_bufferçš„æœ€å¤§å€¼\n\nnet_bufferä¿—ç§°è¿æ¥ç¼“å†²åŒºï¼ŒæœåŠ¡ç«¯æ¥å—å®¢æˆ·ç«¯æŸ¥è¯¢è¯­å¥çš„ç¼“å†²åŒºä¹Ÿæ˜¯ç”¨çš„net_bufferï¼Œå½“å®¢æˆ·ç«¯å‘é€å¤ªå¤šä¼šå¯¼è‡´net_bufferå¢é•¿ï¼Œæœ€å¤§max_allowed_packetï¼ˆè¿™ä¸ªå€¼æœ€å¤§å¯é…1Gï¼‰\n\næœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯å‘é€å“åº”æ—¶å…ˆæŠŠç»“æœç¼“å†²åˆ°net_buffer,å¦‚æœnet_bufferæ»¡äº†ä¼šé˜»å¡ï¼Œä½†ä¸ä¼šè‡ªåŠ¨å¢é•¿net_bufferï¼Œæ‰€ä»¥åªèƒ½é å¢åŠ net_buffer_lengthæ¥æé«˜å‘é€å“åº”æ—¶ç”¨åˆ°çš„net_bufferå¤§å°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647573972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1341276,"avatar":"https://static001.geekbang.org/account/avatar/00/14/77/5c/8d53165e.jpg","nickname":"bingo","note":"","ucode":"DD96820EC8871D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403340,"discussion_content":"å¦‚æœ net_buffer_length è®¾ç½®çš„è¶³å¤Ÿå¤§ï¼Œå°±å¯ä»¥åªèµ°ä¸€æ¬¡å¼•æ“å±‚ï¼Œç„¶åæ‰€æœ‰çš„æ•°æ®å°±éƒ½ä¿å­˜åœ¨äº† server å±‚ï¼Œå®¢æˆ·ç«¯æ¥ç€å–æ•°æ®å°±å¯ä»¥ç›´æ¥ä» server å±‚æ‹¿åˆ°ï¼Œä¸å†è¿›å…¥å¼•æ“å±‚ï¼Œè¿™æ ·å°±å°‘äº†å¾ˆå¤šå†…éƒ¨æ­¥éª¤ï¼Œæå‡äº†æœåŠ¡ç«¯æ€§èƒ½ã€‚æ¯”å¦‚å¾ˆæ˜æ˜¾çš„ä¸€ä¸ªæå‡å°±æ˜¯ï¼Œå¯ä»¥å‡å°‘è¿›å…¥ innodb çš„å¹¶å‘çº¿ç¨‹æ•°é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634050829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2147220,"avatar":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","nickname":"ç¥æ¯“é€é¥","note":"","ucode":"83351CB18B190E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307380,"discussion_content":"miuæäº†å¥½é—®é¢˜ï¼Œéº»çƒ¦è€å¸ˆå›å¤ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600612981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64183,"user_name":"é•¿æ°","can_delete":false,"product_type":"c1","uid":1312212,"ip_address":"","ucode":"DD52C9494005F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg","comment_is_top":false,"comment_ctime":1548688578,"is_pvip":false,"replies":[{"id":"22787","content":"éå¸¸å¥½ï¼Œæ­£æ˜¯æˆ‘è¦è¯´æ˜çš„ä¸€ä¸ªåœºæ™¯å‘¢ï¼Œç›´æ¥ç”¨ä½ çš„ä¾‹å­æ”¾åœ¨ä¸‹ç¯‡ç­”ç–‘éƒ¨åˆ†å“ˆ","user_name":"ä½œè€…å›å¤","comment_id":64183,"uid":"1264162","ip_address":"","utype":1,"ctime":1548755076,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":4,"race_medal":0,"score":"362325941442","product_id":100020801,"comment_content":"é‡åˆ°è¿‡ä¸€ä¸ªåœºæ™¯ï¼Œç”¨mysqldumpå¯¹ä¸šåŠ¡dbåšé€»è¾‘å¤‡ä»½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ˜¯è™šæ‹Ÿæœºï¼Œç£ç›˜å¾ˆå¿«æ»¡äº†ï¼Œå¯¼è‡´serverç«¯å‡ºç°sending to clientçŠ¶æ€ï¼Œæ›´ç³Ÿç³•çš„æ˜¯ä¸šåŠ¡dbæ›´æ–°é¢‘ç¹ï¼Œå¯¼è‡´undoè¡¨ç©ºé—´å˜å¤§ï¼ŒdbæœåŠ¡å µå¡ï¼ŒæœåŠ¡ç«¯ç£ç›˜ç©ºé—´ä¸è¶³ã€‚","like_count":85,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437896,"discussion_content":"éå¸¸å¥½ï¼Œæ­£æ˜¯æˆ‘è¦è¯´æ˜çš„ä¸€ä¸ªåœºæ™¯å‘¢ï¼Œç›´æ¥ç”¨ä½ çš„ä¾‹å­æ”¾åœ¨ä¸‹ç¯‡ç­”ç–‘éƒ¨åˆ†å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548755076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1794060,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/60/0c/e1f012cb.jpg","nickname":"frankie","note":"","ucode":"813D1352B68A21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535312,"discussion_content":"ä¸ºå•¥ä¸çœ‹ç£ç›˜å°±å¤‡ä»½å‘¢ã€‚ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1638410201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588094,"discussion_content":"åº”è¯¥æ˜¯rræ‰ä¼šæœ‰è¿™ç§é—®é¢˜å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663552070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2088647,"avatar":"","nickname":"é›·é¹","note":"","ucode":"1B0A3A1D969A93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552833,"discussion_content":"net_write_timeoutè¶…æ—¶ï¼Œmysqldumpçš„æŠ¥é”™äº†å§ï¼Œé»˜è®¤60ç§’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645606812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67374,"user_name":"IceGeek17","can_delete":false,"product_type":"c1","uid":1103101,"ip_address":"","ucode":"1B42D7260449B4","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/fd/43802282.jpg","comment_is_top":false,"comment_ctime":1550136373,"is_pvip":false,"replies":[{"id":"23997","content":"1. â€œæ˜¯ä¸€è¡Œä¸€è¡Œçš„æ‰”ç»™socket send bufferï¼Œè¿˜æ˜¯æŠŠnet_buffer é‡Œçš„å†…å®¹ä¸€ä¸‹å­å…¨éƒ¨æ‰”ç»™ socket send buffer ï¼Ÿâ€ <br>---- net_bufferå†™æ»¡ï¼Œä¸€èµ·å‘ï¼Œç„¶åæ¸…ç©ºnet_buffer,ç»„è£…ä¸‹ä¸€æ‰¹ ã€‚å¥½é—®é¢˜<br>2. è·Ÿä¸Šä¸€ä¸ªé—®é¢˜åŒä¸€ä¸ªç­”æ¡ˆï¼›<br>3. â€œå¯¹äºä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰§è¡Œå™¨æ‹¿åˆ°çš„æ‰€æœ‰ç»“æœï¼Œå¦‚æœå¯ä»¥ä¸€æ¬¡æ€§æ”¾å…¥net_buffer, å¯¹äºæ‰§è¡Œå™¨æ¥è¯´æ˜¯ä¸æ˜¯æ„å‘³ç€â€œå…¨éƒ½å†™å‡ºå»äº†â€ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ sending to client çŠ¶æ€ï¼Ÿâ€ ----æ˜¯çš„<br><br>4. æ˜¯çš„<br>5. å¯¹ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å…¶ä»–æ–‡ç« ä¸­ä»‹ç»çš„ï¼Œâ€œå¸¦ç€é‚»å±…èŠ‚ç‚¹ä¸€èµ·åˆ·â€çš„é‚£ä¸ªé˜¶æ®µã€‚<br><br>","user_name":"ä½œè€…å›å¤","comment_id":67374,"uid":"1264162","ip_address":"","utype":1,"ctime":1550298045,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":6,"race_medal":0,"score":"246363272245","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå‡ ä¸ªé—®é¢˜ï¼š<br><br>æŒ‰ç…§æ–‡ä¸­æ‰€è¿°ï¼Œnet_bufferæ˜¯å±äºMySQL Serverå±‚çš„ï¼Œåœ¨InnoDBå¼•æ“å±‚ï¼Œä¼šä½¿ç”¨buffer pool (ä»¥pageçš„å½¢å¼)ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæŸ¥è¯¢æ‰€å ç”¨çš„å†…å­˜æ˜¯ï¼š net_buffer + buffer poolé‡Œç›¸å…³çš„pageé¡µ<br>æ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆç†è§£ï¼Ÿ<br><br>å½“net_bufferå†™æ»¡ï¼Œä¼šè°ƒç”¨ç½‘ç»œæ¥å£å‘å‡ºå»ï¼Œnet_bufferé‡Œçš„å†…å®¹æ˜¯å¦‚ä½•å‘ç»™socket send bufferçš„ï¼Œ<br>æ˜¯ä¸€è¡Œä¸€è¡Œçš„æ‰”ç»™socket send bufferï¼Œè¿˜æ˜¯æŠŠnet_buffer é‡Œçš„å†…å®¹ä¸€ä¸‹å­å…¨éƒ¨æ‰”ç»™ socket send buffer ï¼Ÿ<br><br>æ–‡ä¸­è¯´å‘é€æˆåŠŸç„¶åæ¸…ç©ºnet_buffer, è¿™é‡Œnet_bufferæ˜¯å¦‚ä½•æ¸…ç©ºçš„ï¼Œæ˜¯ç­‰net_bufferé‡Œçš„å†…å®¹å…¨éƒ¨å‘é€æˆåŠŸï¼Œç„¶åä¸€æ¬¡æ€§æ¸…ç†ï¼Œè¿˜æ˜¯å‘é€æˆåŠŸä¸€éƒ¨åˆ†æ¸…ç†ä¸€éƒ¨åˆ†ï¼Ÿ<br><br>çœ‹äº†ç½®é¡¶çš„700é—®é¢˜å’Œå›å¤ï¼Œå‡ ç‚¹ç–‘é—®ï¼š<br>å¯¹äºä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰§è¡Œå™¨æ‹¿åˆ°çš„æ‰€æœ‰ç»“æœï¼Œå¦‚æœå¯ä»¥ä¸€æ¬¡æ€§æ”¾å…¥net_buffer, å¯¹äºæ‰§è¡Œå™¨æ¥è¯´æ˜¯ä¸æ˜¯æ„å‘³ç€â€œå…¨éƒ½å†™å‡ºå»äº†â€ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ sending to client çŠ¶æ€ï¼Ÿ<br>åªæœ‰å½“æŸ¥è¯¢çš„ç»“æœï¼Œä¸èƒ½å¤Ÿå…¨éƒ¨æ”¾å…¥net_bufferï¼Œéœ€è¦ç­‰net_bufferé‡Œçš„å†…å®¹æ¸…ç©ºåå†ç»§ç»­æ”¾å…¥åç»­çš„ç»“æœï¼Œè¿™æ—¶å€™çŠ¶æ€æ‰æ˜¯æ˜¾ç¤º sending to client ï¼Ÿ<br>å½“æŸ¥è¯¢ç»“æœå¯ä»¥å…¨éƒ¨æ”¾å…¥net_buffer, æ‰§è¡Œå™¨ä¹Ÿä¸ç®¡ net_bufferæ˜¯å¦å‘é€ç»™ socket send bufferï¼Œéƒ½è®¤ä¸ºæ‰§è¡Œå®Œäº† ï¼Ÿ<br>æ˜¯ä¸æ˜¯è¿™ä¹ˆç†è§£ï¼Ÿ<br><br>å¯¹buffer poolï¼Œå½“é€šè¿‡LRU æ·˜æ±°æ•°æ®é¡µçš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶è¯¥é¡µçš„å†…å®¹æ˜¯æ–°çš„ï¼ˆä¹Ÿå°±æ˜¯ç£ç›˜ä¸Šçš„å†…å®¹æ˜¯è€çš„ï¼‰ï¼Œæ˜¯ä¸æ˜¯éœ€è¦å¼ºåˆ¶å…ˆèµ°ä¸€ä¸ªåˆ·è„é¡µçš„æµç¨‹ï¼Œç­‰è„é¡µåˆ·å®Œäº†ï¼Œç„¶åæ‰èƒ½æ·˜æ±°è¯¥æ•°æ®é¡µï¼Ÿ<br>","like_count":58,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439164,"discussion_content":"1. â€œæ˜¯ä¸€è¡Œä¸€è¡Œçš„æ‰”ç»™socket send bufferï¼Œè¿˜æ˜¯æŠŠnet_buffer é‡Œçš„å†…å®¹ä¸€ä¸‹å­å…¨éƒ¨æ‰”ç»™ socket send buffer ï¼Ÿâ€ \n---- net_bufferå†™æ»¡ï¼Œä¸€èµ·å‘ï¼Œç„¶åæ¸…ç©ºnet_buffer,ç»„è£…ä¸‹ä¸€æ‰¹ ã€‚å¥½é—®é¢˜\n2. è·Ÿä¸Šä¸€ä¸ªé—®é¢˜åŒä¸€ä¸ªç­”æ¡ˆï¼›\n3. â€œå¯¹äºä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰§è¡Œå™¨æ‹¿åˆ°çš„æ‰€æœ‰ç»“æœï¼Œå¦‚æœå¯ä»¥ä¸€æ¬¡æ€§æ”¾å…¥net_buffer, å¯¹äºæ‰§è¡Œå™¨æ¥è¯´æ˜¯ä¸æ˜¯æ„å‘³ç€â€œå…¨éƒ½å†™å‡ºå»äº†â€ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ sending to client çŠ¶æ€ï¼Ÿâ€ ----æ˜¯çš„\n\n4. æ˜¯çš„\n5. å¯¹ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å…¶ä»–æ–‡ç« ä¸­ä»‹ç»çš„ï¼Œâ€œå¸¦ç€é‚»å±…èŠ‚ç‚¹ä¸€èµ·åˆ·â€çš„é‚£ä¸ªé˜¶æ®µã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550298045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1124075,"avatar":"https://static001.geekbang.org/account/avatar/00/11/26/eb/24e0ac9c.jpg","nickname":"å¬´æ¢¦å·","note":"","ucode":"104CDFD26A1711","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374879,"discussion_content":"æŠŠè¿™äº›æé—®å˜æˆé™ˆè¿°å¥ï¼Œå°±æˆäº†æœ¬ç¯‡æ–‡ç« çš„å¾ˆå¥½è¡¥å……ã€‚å—æ•™äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621398167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1522824,"avatar":"https://static001.geekbang.org/account/avatar/00/17/3c/88/e83528da.jpg","nickname":"uking","note":"","ucode":"41005AC547327B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373563,"discussion_content":"æŒ‰å…¶ä»–è¯„è®ºä¸­çš„å›ç­”æ¥çœ‹ï¼Œnet_bufferä¸€èˆ¬æ¯”socket send buffer å¤§ï¼Œé‚£net_bufferä¸­çš„æ•°æ®æ˜¯å¦‚ä½•ä¸€èµ·å‘ç»™socket send bufferå‘¢ï¼Ÿéš¾é“ä¸åº”è¯¥æ˜¯æŒ‰socket send bufferçš„å¤§å°åˆ†æ‰¹å‘ä¹ˆï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620786111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1552364,"avatar":"https://static001.geekbang.org/account/avatar/00/17/af/ec/5f5bed0f.jpg","nickname":"å¦‚ é“","note":"","ucode":"C1D241B344741B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409135,"discussion_content":"ä¹‹å‰è¯´net buffer æ¯” send buffer å¤§ï¼Œä¸€æ¬¡æŠŠnetbuffer æ¸…ç©ºæ€ä¹ˆå®ç°çš„å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635384073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1450651,"avatar":"https://static001.geekbang.org/account/avatar/00/16/22/9b/4486d287.jpg","nickname":"é»„å¸¸å‡¯","note":"","ucode":"A8D40EA8EB6BFD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1552364,"avatar":"https://static001.geekbang.org/account/avatar/00/17/af/ec/5f5bed0f.jpg","nickname":"å¦‚ é“","note":"","ucode":"C1D241B344741B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556662,"discussion_content":"æ¸…ç©ºä¸äº†å°±å‰©ä¸€éƒ¨åˆ†åœ¨net_bufferå‘—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647442831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":409135,"ip_address":""},"score":556662,"extra":""}]},{"author":{"id":1627397,"avatar":"https://static001.geekbang.org/account/avatar/00/18/d5/05/8fd8ca4c.jpg","nickname":"å¿«å¿«ä¹ä¹","note":"","ucode":"D093D8D5836FF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348041,"discussion_content":"å†™çš„å¾ˆé€å½»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612410346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67287,"user_name":"XXL","can_delete":false,"product_type":"c1","uid":1036615,"ip_address":"","ucode":"0532132BB53193","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d1/47/41e4bada.jpg","comment_is_top":false,"comment_ctime":1550123842,"is_pvip":false,"replies":[{"id":"23993","content":"å¯¹ï¼Œè¿™ç§ä¸€èˆ¬å°±æ˜¯ç”¨mysql_use_result<br>å„æœ‰ä¼˜åŠ£å§<br><br>ä¸€æ¬¡æ€§å–çš„å¥½å¤„æ˜¯ï¼Œå¯¹æœåŠ¡ç«¯åªå…¨è¡¨ï¼Œåªæ‰«æä¸€éï¼›åå¤„æ˜¯å¯èƒ½ä¼šå‡ºç°å¤§äº‹åŠ¡ã€‚<br><br>ä¸€èˆ¬æ›´å¸¸è§çš„åšæ³•æ˜¯ï¼Œåˆ†æ‰¹å–ï¼Œç„¶åæ¯ä¸€æ‰¹æ‹¿åˆ°æœ€å¤§çš„ä¸€ä¸ªidï¼ˆä¸»é”®å€¼ï¼‰<br>ä¸‹ä¸€æ‰¹æŸ¥è¯¢çš„æ—¶å€™ç”¨ where Id &gt; N è¿™ç§å†™æ³•<br><br>å¥½é—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":67287,"uid":"1264162","ip_address":"","utype":1,"ctime":1550297655,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"212003521346","product_id":100020801,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼Œ <br>ä¹‹å‰åœ¨å¼€å‘å·¥ç¨‹ä¸­å®é™…æœ‰ç¢°åˆ°è¿™æ ·çš„ä¸šåŠ¡ï¼Œæ‰¹é‡ä»MySQLä¸­æŸ¥è¯¢å¤§é‡æ•°æ®ï¼Œæ¯æ¬¡é€šè¿‡é™åˆ¶èµ·å§‹+limitæ•°é‡çš„æ¥åˆ†æ‰¹æ¬¡æŸ¥è¯¢ï¼Œåæ¥æœ‰åŒäº‹æ¨èä½¿ç”¨MySQL JDBCä¸­çš„fetchSize()æ–¹æ³•ï¼Œä¸åšåˆ†é¡µé€šè¿‡ä¸€æ¬¡å¤§æŸ¥è¯¢ç„¶åå®¢æˆ·ç«¯æµå¼è¯»å–æ¥æ‰¹é‡æŸ¥è¯¢æ•°æ®ï¼Œè¿™ä¸ªå†…éƒ¨åŸç†æ˜¯å¦å°±æ˜¯æ–‡ä¸­æ‰€è¯´çš„ä½¿ç”¨äº†mysql_use_resultæ¥å£è¯»ä¸€è¡Œå¤„ç†ä¸€è¡Œå®ç°çš„æµå¼ï¼Ÿæˆ–è€…ä¹Ÿæ˜¯mysql_store_resultæ–¹å¼å®¢æˆ·ç«¯è¾¹ç¼“å­˜è¾¹å¤„ç†ï¼Ÿè¯·è€å¸ˆæŒ‡æ•™","like_count":50,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439132,"discussion_content":"å¯¹ï¼Œè¿™ç§ä¸€èˆ¬å°±æ˜¯ç”¨mysql_use_result\nå„æœ‰ä¼˜åŠ£å§\n\nä¸€æ¬¡æ€§å–çš„å¥½å¤„æ˜¯ï¼Œå¯¹æœåŠ¡ç«¯åªå…¨è¡¨ï¼Œåªæ‰«æä¸€éï¼›åå¤„æ˜¯å¯èƒ½ä¼šå‡ºç°å¤§äº‹åŠ¡ã€‚\n\nä¸€èˆ¬æ›´å¸¸è§çš„åšæ³•æ˜¯ï¼Œåˆ†æ‰¹å–ï¼Œç„¶åæ¯ä¸€æ‰¹æ‹¿åˆ°æœ€å¤§çš„ä¸€ä¸ªidï¼ˆä¸»é”®å€¼ï¼‰\nä¸‹ä¸€æ‰¹æŸ¥è¯¢çš„æ—¶å€™ç”¨ where Id &amp;gt; N è¿™ç§å†™æ³•\n\nå¥½é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550297655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1194853,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3b/65/3a4fc8cf.jpg","nickname":"prepared","note":"","ucode":"00E54A5C7CDCBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337955,"discussion_content":"å…¬å¸å¼€å‘è§„èŒƒä¸­ï¼Œå¯¹äºå¤§æ•°æ®åˆ†é¡µçš„å¸¸è§ï¼Œå»ºè®®ä½¿ç”¨è€å¸ˆè¯´çš„æ–¹æ¡ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609136113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64544,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1548818247,"is_pvip":false,"replies":[{"id":"22865","content":"å¯¹çš„<br>","user_name":"ä½œè€…å›å¤","comment_id":64544,"uid":"1264162","ip_address":"","utype":1,"ctime":1548822923,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"186232411975","product_id":100020801,"comment_content":"å¦‚æœå®¢æˆ·ç«¯è¯»ç»“æœä¸åŠæ—¶ï¼Œä¼šå µä½ MySQL çš„æŸ¥è¯¢è¿‡ç¨‹ï¼Œä½†æ˜¯ä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚è¿™ä¸ªæ˜¯æŒ‡å®¢æˆ·ç«¯çš„tcpæ»‘åŠ¨çª—å£å¤„ç†æ²¡æœ‰åŠæ—¶ç¡®è®¤ï¼Œå¯¼è‡´serverç«¯çš„ç½‘ç»œåè®®æ ˆæ²¡æœ‰å¤šä½™çš„ç©ºé—´å¯ä»¥å‘é€æ•°æ®ï¼Œå¯¼è‡´serverçš„å¤„ç†çº¿ç¨‹åœæ­¢ä»dbè¯»å–æ•°æ®å‘é€ç»™clientï¼Œæ˜¯è¿™æ ·ç†è§£å—","like_count":44,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438060,"discussion_content":"å¯¹çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548822923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81609,"user_name":"æ¸…é£","can_delete":false,"product_type":"c1","uid":1129749,"ip_address":"","ucode":"59932E13FAF607","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/15/7f5fd6d3.jpg","comment_is_top":false,"comment_ctime":1553961386,"is_pvip":false,"replies":[{"id":"29644","content":"ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œæ¯ä¸ªçº¿ç¨‹(session)ä¸€ä¸ª","user_name":"ä½œè€…å›å¤","comment_id":81609,"uid":"1264162","ip_address":"","utype":1,"ctime":1554047892,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"138992914858","product_id":100020801,"comment_content":"net_buffer åº”è¯¥æ˜¯é’ˆå¯¹æ¯ä¸ªè¯·æ±‚çº¿ç¨‹å•ç‹¬åˆ†é…çš„ï¼Œè¿˜æ˜¯å…±äº«net_buffer . æˆ‘çš„ç†è§£åº”è¯¥æ˜¯æ¯ä¸ªçº¿ç¨‹ä¸€å—ã€‚mysql å¯ä»¥æ ¹æ®æœ€å¤§è¯·æ±‚è¿æ¥æ•°ï¼Œèƒ½å¤Ÿç®—å‡ºæ¥mysql ä½¿ç”¨net_buffer çš„æ€»å¤§å°ã€‚åŒæ—¶å¦‚æœmysql å ç”¨çš„å†…å­˜ä¸å¤§ï¼Œä¹Ÿå°†å½±å“åˆ°Mysql èƒ½å¤Ÿå¤„ç†è¿æ¥è¿æ¥æ•°çš„å¤§å°ã€‚ ä¸çŸ¥é“è¿™ç§çŒœæµ‹æ˜¯å¦å‡†ç¡®ã€‚  åé¢é‚£ä¸ªæ”¹è¿›å‹çš„LRU ç®—æ³•çœŸçš„éå¸¸å¥½ï¼Œå°±è·ŸJVM ä¸­å¹´è½»å¸¦ è€å¹´ä»£çš„å†…å­˜åŒºåŸŸåˆ’åˆ†å’Œæ·˜æ±°æœºåˆ¶ä¸€æ ·ã€‚åœ¨åšç³»ç»Ÿè®¾è®¡çš„æ—¶å€™å¯ä»¥æŠŠè¿™ç§è®¾è®¡åº”ç”¨ä¸€ä¸‹ã€‚","like_count":33,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445267,"discussion_content":"ä½ çš„ç†è§£æ˜¯å¯¹çš„ï¼Œæ¯ä¸ªçº¿ç¨‹(session)ä¸€ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554047892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64005,"user_name":"è€æ¨åŒå¿—","can_delete":false,"product_type":"c1","uid":1246199,"ip_address":"","ucode":"3F334F0CFD3DE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg","comment_is_top":false,"comment_ctime":1548640553,"is_pvip":false,"replies":[{"id":"22638","content":"ğŸ‘<br>å†è€ƒè™‘ä¸‹éƒ½æ˜¯updateçš„æƒ…å†µ ğŸ˜†","user_name":"ä½œè€…å›å¤","comment_id":64005,"uid":"1264162","ip_address":"","utype":1,"ctime":1548643265,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"108922822953","product_id":100020801,"comment_content":"æœ¬èº«æ˜¯ç ”å‘æ²¡è¿‡è¿™ç§ç»å†ã€‚çŒœä¸€ç§å§<br>å¦‚æœå®¢æˆ·ç«¯Aæ€§èƒ½æ…¢ï¼Œè¿Ÿè¿Ÿä¸å»è¯»å–socket receive bufferï¼Œserverç«¯å°±ä¸èƒ½å‘é€ï¼Œæ­¤æ—¶å¦‚æœå®¢æˆ·ç«¯Aè¦è¯»å–çš„æ•°æ®è¢«å…¶ä»–çº¿ç¨‹é¢‘ç¹updateï¼Œç”±äºmvccçš„å®ç°ï¼Œè¿™ä¸ªå˜æ›´ä¼šè®°å½•åˆ°undo logï¼Œå¤§é‡çš„æ—¥å¿—ä¼šä¸ä¼šä½¿ioé£™å‡ï¼Ÿå¯èƒ½æ¯”è¾ƒæç«¯æ‰ä¼šå§ã€‚å¦‚æœæ­¤æ—¶å®¢æˆ·ç«¯æ€§èƒ½æ¢å¤ï¼ŒæœåŠ¡ç«¯è¦è¯»å–æœ€æ–°æ•°æ®ï¼Œå¹¶é€šè¿‡undo logè®¡ç®—è¾ƒæ—©çš„ç‰ˆæœ¬ï¼Œæ˜¯ä¸æ˜¯è¦ä¹Ÿå ç”¨å¤§é‡çš„cpuèµ„æºæˆ–è€…ioèµ„æºï¼Ÿè°¢è°¢è€å¸ˆ","like_count":26,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437805,"discussion_content":"ğŸ‘\nå†è€ƒè™‘ä¸‹éƒ½æ˜¯updateçš„æƒ…å†µ ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548643265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1219198,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIEl3fX9nvzUF26ekUIicp4sgA5jZ1mGvGMhIHkwJabbjt9h5uTLw5zzU1U6JZbCSpRXBNQwuejLJg/132","nickname":"è½»æ¾çš„é±¼","note":"","ucode":"F4FF653209C47B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369238,"discussion_content":"net_wirte_timeouté»˜è®¤60sï¼Œnet_buffer è¿Ÿè¿Ÿä¸æ¸…ç©ºï¼ŒMySQL Server å†™ net_buffer ä¼šé˜»å¡ï¼Œè¶…è¿‡ 60s å°±ä¼šæŠ¥é”™æ–­å¼€è¿æ¥å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618983256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2088647,"avatar":"","nickname":"é›·é¹","note":"","ucode":"1B0A3A1D969A93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1219198,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIEl3fX9nvzUF26ekUIicp4sgA5jZ1mGvGMhIHkwJabbjt9h5uTLw5zzU1U6JZbCSpRXBNQwuejLJg/132","nickname":"è½»æ¾çš„é±¼","note":"","ucode":"F4FF653209C47B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552834,"discussion_content":"æ˜¯çš„ï¼Œä¼šæŠ¥é”™æ–­å¼€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645606941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":369238,"ip_address":""},"score":552834,"extra":""}]}]},{"had_liked":false,"id":64044,"user_name":"Zzz","can_delete":false,"product_type":"c1","uid":1116272,"ip_address":"","ucode":"4AA47797F48315","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIu1n1DhUGGKTjelrQaLYOSVK2rsFeia0G8ASTIftib5PTOx4pTqdnfwb0NiaEFGRgS661nINyZx9sUg/132","comment_is_top":false,"comment_ctime":1548646548,"is_pvip":false,"replies":[{"id":"22652","content":"è¿™ä¸‰ä¸ªé—®é¢˜å…¶å®æ˜¯åŒä¸€ä¸ª<br><br>â€œè¾¹è¯»è¾¹å‘â€çš„æ„æ€æ˜¯ï¼Œç®—å‡ºæ¥çš„ç»“æœæ‰èƒ½å‘<br>åƒorder byï¼Œå¾—å…ˆæ’åºå¾—åˆ°ç»“æœï¼Œç„¶åæ‰å‘å‡ºå»ï¼Œå¦‚æœè¯»äº†æ•°æ®ç›´æ¥å‘ï¼Œé‚£è‚¯å®šä¸è¡Œï¼Œé‚£æ˜¯é”™è¯¯çš„ç»“æœã€‚<br><br>æ‰€ä»¥è¦æ’åºäº†ä»¥åå†å‘ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä¸­é—´æ•°æ®ç»“æ„ï¼Œsort buffer<br>","user_name":"ä½œè€…å›å¤","comment_id":64044,"uid":"1264162","ip_address":"","utype":1,"ctime":1548655626,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":6,"race_medal":0,"score":"87447992468","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œæœ‰å‡ ä¸ªé—®é¢˜æƒ³è¯·æ•™ä»¥ä¸‹ï¼š<br>1ã€å“ªç§æŸ¥è¯¢è¯­å¥ä¸‹MySQL æ˜¯â€œè¾¹è¯»è¾¹å‘çš„â€çš„å‘¢ï¼Ÿå¯¹äºorder byè¿™ç§è¯­å¥è‚¯å®šæ˜¯éœ€è¦å…ˆå…¨éƒ¨æ‹¿åˆ°å†…å­˜å†åšæ’åºå¤„ç†æœ€åè¿”å›ç»“æœã€‚<br>2ã€MySQLæ˜¯æ€ä¹ˆåˆ¤æ–­å‡ºå¯ä»¥â€œè¾¹è¯»è¾¹å‘çš„â€ï¼Œæ˜¯ä¸æ˜¯çœ‹ä¸‹è¯­å¥æ˜¯å¦å¸¦order byè¿™ç§å…³é”®å­—ï¼Ÿ<br>3ã€æˆ‘æœ‰åŠæ³•çŸ¥é“è¯¥æ‰§è¡Œè¯­å¥æ˜¯å¦â€œè¾¹è¯»è¾¹å‘çš„â€å—ï¼Ÿ","like_count":21,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437828,"discussion_content":"è¿™ä¸‰ä¸ªé—®é¢˜å…¶å®æ˜¯åŒä¸€ä¸ª\n\nâ€œè¾¹è¯»è¾¹å‘â€çš„æ„æ€æ˜¯ï¼Œç®—å‡ºæ¥çš„ç»“æœæ‰èƒ½å‘\nåƒorder byï¼Œå¾—å…ˆæ’åºå¾—åˆ°ç»“æœï¼Œç„¶åæ‰å‘å‡ºå»ï¼Œå¦‚æœè¯»äº†æ•°æ®ç›´æ¥å‘ï¼Œé‚£è‚¯å®šä¸è¡Œï¼Œé‚£æ˜¯é”™è¯¯çš„ç»“æœã€‚\n\næ‰€ä»¥è¦æ’åºäº†ä»¥åå†å‘ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä¸­é—´æ•°æ®ç»“æ„ï¼Œsort buffer\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548655626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018620,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","nickname":"ipofss","note":"","ucode":"DE3061C9259F9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":205665,"discussion_content":"å…ˆæŠŠæ­£ç¡®çš„ç»“æœæ•°æ®è¿›è¡Œç»„è£…ï¼Œç„¶åå†è¿›è¡Œå‘é€ï¼Œå¯ä»¥è¿™æ ·ç†è§£å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584330359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1310518,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ff/36/83281758.jpg","nickname":"L","note":"","ucode":"C18B98D3DC3387","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1018620,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","nickname":"ipofss","note":"","ucode":"DE3061C9259F9E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335636,"discussion_content":"æ˜¯çš„ï¼Œå°±æ˜¯è¿™æ ·ã€‚å› ä¸ºè®¡ç®—å‡ºçš„ç»“æœæ˜¯è¾¹ç®—è¾¹å‘ï¼Œæ‰€ä»¥ä¸ä¼šoomã€‚è®¡ç®—æ‰€å çš„ç©ºé—´ï¼Œä¼šåˆ©ç”¨å„ç§bufferå’Œç£ç›˜ï¼Œä¹Ÿä¸ä¼šoomã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1608259083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":205665,"ip_address":""},"score":335636,"extra":""},{"author":{"id":1043325,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c9xpiakQ3OC1AlfCeW03lLnnb7mj5v35Hib8YDs66zpnVib2n2qFichFmFp2Ec4QDPR0dKh38MkBBLyD3bE4NiaanZQ/132","nickname":"é¾™æ™“","note":"","ucode":"FAF34F1C65D103","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1310518,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ff/36/83281758.jpg","nickname":"L","note":"","ucode":"C18B98D3DC3387","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358726,"discussion_content":"å¤§é‡æ’åºåº”è¯¥æ˜¯å¾ˆå å†…å­˜çš„ï¼Œå…·ä½“å½±å“å¾ˆéš¾è¯´ï¼Œä¸çŸ¥é“ä¼šä¸ä¼šoom","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616037175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335636,"ip_address":""},"score":358726,"extra":""},{"author":{"id":1901428,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwIAiaxOJWE3Ut6hRvTzvFkCIibcURojC0XrQI1lC3h58enlNcpXQ98rmUOr5lA6ST3m24micj191Gw/132","nickname":"ä¸ç–¾","note":"","ucode":"18AA0F294C1586","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043325,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c9xpiakQ3OC1AlfCeW03lLnnb7mj5v35Hib8YDs66zpnVib2n2qFichFmFp2Ec4QDPR0dKh38MkBBLyD3bE4NiaanZQ/132","nickname":"é¾™æ™“","note":"","ucode":"FAF34F1C65D103","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375144,"discussion_content":"å¤§é‡æ’åºå‰è¾¹æåˆ°è¿‡é€šè¿‡sort_bufferå‚æ•°æ§åˆ¶ï¼Œå†…å­˜ä¸å¤Ÿä¼šåˆ©ç”¨ç£ç›˜ç©ºé—´æ’åº","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1621495387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":358726,"ip_address":""},"score":375144,"extra":""}]}]},{"had_liked":false,"id":81940,"user_name":"å†°ç‚¹18","can_delete":false,"product_type":"c1","uid":1112370,"ip_address":"","ucode":"0BD9DBE5D3242E","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/32/8ced1824.jpg","comment_is_top":false,"comment_ctime":1554084135,"is_pvip":false,"replies":[{"id":"30020","content":"ä¼šçš„","user_name":"ä½œè€…å›å¤","comment_id":81940,"uid":"1264162","ip_address":"","utype":1,"ctime":1554432652,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":4,"race_medal":0,"score":"57388658983","product_id":100020801,"comment_content":"InnoDBæ”¹è¿›çš„LRUç®—æ³•ï¼Œå¦‚æœé‡åˆ°è¿ç»­ä¸¤æ¬¡çš„å…¨è¡¨æ‰«æï¼Œä¼šä¸ä¼šå°±æŠŠyoungåŒºçš„3&#47;5ç»™è¦†ç›–æ‰äº†ï¼Ÿå› ä¸ºä¸¤æ¬¡æ‰«ææ—¶é—´é—´éš”ä¼šè¶…è¿‡ä¸€ç§’ï¼Ÿ","like_count":14,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445399,"discussion_content":"ä¼šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554432652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358443,"discussion_content":"5/8 ä¸æ˜¯ 3/5","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1615982925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1136059,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epIz8Iynichoe0aF8IXFmUZMR1z364XoukxiaFbUJMsiazeM2odbWNVxDuO5KaCSqecibnFGNvM5peibhA/132","nickname":"younger","note":"","ucode":"C40C64D052CB3E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591187,"discussion_content":"äººå®¶è¯´çš„æ˜¯youngåŒºçš„3/5ï¼Œæ²¡é—®é¢˜å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666344675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":358443,"ip_address":"åŒ—äº¬"},"score":591187,"extra":""}]},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296704,"discussion_content":"å“ˆ æ‰€ä»¥è¿™ä¸ªæ—¶å€™ ä¹Ÿå¯ä»¥çœ‹ä¸‹å…¶ä»– LRUç®—æ³•ï¼ŒåŒ…å«LRU-K,LRU-2Qï¼Œç”šè‡³LRU-MQï¼Œæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æ¥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596627459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188317,"user_name":"ipofss","can_delete":false,"product_type":"c1","uid":1018620,"ip_address":"","ucode":"DE3061C9259F9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","comment_is_top":false,"comment_ctime":1584339281,"is_pvip":false,"replies":[{"id":"72681","content":"ç†è§£æ­£ç¡®çš„ğŸ‘Œ","user_name":"ä½œè€…å›å¤","comment_id":188317,"uid":"1264162","ip_address":"","utype":1,"ctime":1584342102,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"48828979537","product_id":100020801,"comment_content":"MySQLæ˜¯â€œè¾¹è¯»è¾¹å‘â€çš„ï¼Œæ‰€ä»¥å¯¹äºä¸€ä¸ªå¤§æŸ¥è¯¢ï¼Œä¸ä¼šåœ¨serverå±‚æŠŠæ•°æ®åº“å†…å­˜æ‰“çˆ†ã€‚<br>è€Œå¯¹äºinnodbå†…éƒ¨ï¼Œä¹Ÿä½¿ç”¨äº†æ”¹è¿›çš„LRUç®—æ³•ï¼Œå»ä½¿ç”¨å†…å­˜ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚<br><br>è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜ï¼š<br>æ—¢ç„¶æ•°æ®æ˜¯â€œè¾¹è¯»è¾¹å‘â€çš„ï¼Œå¯¹äºä¸€ä¸ªè¯»è¯·æ±‚ï¼Œå¦‚æœæ—¶é—´å¤ªé•¿äº†ï¼Œè€Œæ²¡æœ‰å¤„ç†å®Œï¼Œå¦å¤–ä¸€ä¸ªå†™è¯·æ±‚è¿›æ¥äº†ï¼Œå¦‚ä½•ä¿è¯å‰é¢çš„è¯»è¯·æ±‚ä¸ä¼šè¯»åˆ°è„æ•°æ®ï¼Ÿ<br>æˆ‘çš„ç†è§£æ˜¯MVCCæ§åˆ¶çš„ï¼Œåªå»è¯»å–å½“æ—¶çš„æ•°æ®ï¼Œå³ä½¿åæ¥è¿›è¡Œäº†æ•°æ®çš„å¢ã€åˆ ã€æ”¹ï¼Œä½†æ˜¯è¯»çš„æ—¶å€™ï¼Œåªå»è¯»å–å½“æ—¶çš„é‚£ä¸ªç‰ˆæœ¬ã€‚","like_count":12,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487373,"discussion_content":"ç†è§£æ­£ç¡®çš„ğŸ‘Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584342102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120562,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1564929507,"is_pvip":false,"replies":[{"id":"44335","content":"ä½ è¿™ä¸ªä¾‹å­ä¸é”™ğŸ˜†","user_name":"ä½œè€…å›å¤","comment_id":120562,"uid":"1264162","ip_address":"","utype":1,"ctime":1564983905,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"35924667875","product_id":100020801,"comment_content":"ç”¨ä¸€ä¸ªå°å‹ºå­æ€ä¹ˆåƒå®Œä¸€ç¢—ç±³ï¼Œæƒ³å¿…å¤§å®¶éƒ½ä¼šï¼Œå“ˆå“ˆã€‚è¿™ä¸ªå’Œè¾¹è¯»è¾¹å‘å¼‚æ›²åŒå·¥å‘€!","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461386,"discussion_content":"ä½ è¿™ä¸ªä¾‹å­ä¸é”™ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564983905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2161554,"avatar":"https://static001.geekbang.org/account/avatar/00/20/fb/92/17923e19.jpg","nickname":"å›¢åœ†ä¸","note":"","ucode":"23DD0146F43C7D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340651,"discussion_content":"åšæˆç²½å­ï¼Œä¸€å‹ºå­ä¸€ä¸ªğŸ˜ŠğŸ˜ŠğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610088140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69006,"user_name":"å‡ è¿‘è™šå¹´","can_delete":false,"product_type":"c1","uid":1355831,"ip_address":"","ucode":"28CD6486EED8E2","user_header":"https://static001.geekbang.org/account/avatar/00/14/b0/37/d654fbac.jpg","comment_is_top":false,"comment_ctime":1550643291,"is_pvip":false,"replies":[{"id":"24487","content":"ç½‘ç»œæ ˆ socket receive buffer å†™æ»¡äº†","user_name":"ä½œè€…å›å¤","comment_id":69006,"uid":"1264162","ip_address":"","utype":1,"ctime":1550652626,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":7,"race_medal":0,"score":"35910381659","product_id":100020801,"comment_content":"è€å¸ˆï¼Œçœ‹äº†è¯¾æ–‡å’Œç•™è¨€ï¼Œæœ‰ä¸ªé—®é¢˜æœ‰ç‚¹æ‡µã€‚<br>Sending to client çŠ¶æ€ï¼Œåˆ°åº•æ˜¯ä½“ç°äº†æœåŠ¡ç«¯çš„ç½‘ç»œæ ˆ socket receive buffer å†™æ»¡äº†ï¼ˆå®¢æˆ·ç«¯æœªåŠæ—¶è¯»å–ï¼‰ï¼Œè¿˜æ˜¯ net_buffer æ»¡äº†ï¼Œè¿˜æœ‰æŸ¥è¯¢ç»“æœæ²¡æœ‰å†™å…¥åˆ° net_buffer ä¸­ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439909,"discussion_content":"ç½‘ç»œæ ˆ socket receive buffer å†™æ»¡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550652626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1177797,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f8/c5/6d38f3e3.jpg","nickname":"é»‘å¾®ç‹—â€®â€®","note":"","ucode":"D44505E7E97BB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":546610,"discussion_content":"è€å¸ˆ socket receive buffer æ˜¯å®¢æˆ·ç«¯çš„å§ï¼Ÿå¥½åƒå’Œæ–‡ä¸­çš„æè¿°ï¼ˆâ€œå¦‚æœä½ çœ‹åˆ° State çš„å€¼ä¸€ç›´å¤„äºâ€œSending to clientâ€ï¼Œå°±è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ç½‘ç»œæ ˆå†™æ»¡äº†ã€‚â€ï¼‰å¯¹ä¸ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642348027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":439909,"ip_address":""},"score":546610,"extra":""},{"author":{"id":1195775,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3e/ff/657b8d76.jpg","nickname":"æ¨å¯","note":"","ucode":"F9D43CADAC2B8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1177797,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f8/c5/6d38f3e3.jpg","nickname":"é»‘å¾®ç‹—â€®â€®","note":"","ucode":"D44505E7E97BB3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557885,"discussion_content":"åº”è¯¥å°±æ˜¯æœåŠ¡ç«¯çš„ socket send bufferï¼Œè€å¸ˆè¿™é‡Œä¼°è®¡æ˜¯å¤åˆ¶é”™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648017513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":546610,"ip_address":""},"score":557885,"extra":""}]},{"author":{"id":1107690,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/ea/cf8ffc85.jpg","nickname":"shijiazo","note":"","ucode":"E2F32581829F11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":170225,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯net_bufferæ˜¯åˆ†æ‰¹æ”¾çš„ï¼Œæ¯æ‰¹éƒ½æ”¾æ»¡net_bufferï¼Œç„¶åæ•°æ®æ”¾ä»net_bufferå¤åˆ¶åˆ°socket receive bufferä¸­æ…¢æ…¢å‘é€ï¼Œè™½ç„¶æ­¤æ—¶net_bufferéƒ¨åˆ†å¯ç”¨äº†ï¼Œä½†æ˜¯ä¸ä¼šæ¸…æ•°æ®ï¼Œä¹Ÿä¸ä¼šå†æ”¾é‡Œæ”¾æ•°æ®ï¼Œç›´åˆ°å‘é€æˆåŠŸäº†ï¼Œæ‰ä¼šæ¸…ç©ºnet_bufferï¼Œæ”¾å…¥ä¸‹ä¸€æ‰¹æ•°æ®ã€‚æ‰€ä»¥Sending to client çŠ¶æ€æ„å‘³ç€ç½‘ç»œæ ˆ socket receive buffer å’Œnet_bufferéƒ½æ»¡äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581675845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1020492,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/4c/40783447.jpg","nickname":"ä½•éª§","note":"","ucode":"11DCC74CE2F300","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1107690,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/ea/cf8ffc85.jpg","nickname":"shijiazo","note":"","ucode":"E2F32581829F11","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301862,"discussion_content":"æˆ‘ä¹Ÿè¿™ä¹ˆè®¤ä¸ºï¼Œä½†æ˜¯è¿™é‡Œçš„ socket receive buffer å’Œ socket send bufferæ˜¯ä¸€ä¸ªbuffer å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598688912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":170225,"ip_address":""},"score":301862,"extra":""},{"author":{"id":1644104,"avatar":"https://static001.geekbang.org/account/avatar/00/19/16/48/09493874.jpg","nickname":"èŒ¶æ²¡å–å®Œ","note":"","ucode":"D72D88C42A1258","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1020492,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/4c/40783447.jpg","nickname":"ä½•éª§","note":"","ucode":"11DCC74CE2F300","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347285,"discussion_content":"ä¸æ˜¯ï¼Œsocket receive bufferæ˜¯å®¢æˆ·ç«¯é‚£è¾¹çš„(ä½ ä½¿ç”¨jdbcçš„æœåŠ¡å™¨tcpå±‚) socket send bufferæ˜¯mysqlæ‰€åœ¨æœåŠ¡å™¨çš„tcpå±‚ã€‚æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612187730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":301862,"ip_address":""},"score":347285,"extra":""}]},{"author":{"id":1043325,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/c9xpiakQ3OC1AlfCeW03lLnnb7mj5v35Hib8YDs66zpnVib2n2qFichFmFp2Ec4QDPR0dKh38MkBBLyD3bE4NiaanZQ/132","nickname":"é¾™æ™“","note":"","ucode":"FAF34F1C65D103","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358727,"discussion_content":"è¿™æ˜¯ä¸€ä¸ªé“¾æ¡ï¼Œå°±æƒ³æœ¨æ¡¶çŸ­æ¿ä¸€æ ·ï¼Œä»»ä½•ä¸€ç¯æ»¡éƒ½å¯èƒ½å¯¼è‡´é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616037388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64006,"user_name":"å…‹åŠ³å¾·","can_delete":false,"product_type":"c1","uid":1323851,"ip_address":"","ucode":"F94AD5C3D607AE","user_header":"https://static001.geekbang.org/account/avatar/00/14/33/4b/71905da9.jpg","comment_is_top":false,"comment_ctime":1548640743,"is_pvip":false,"replies":[{"id":"22641","content":"ä¸€èˆ¬æˆ‘ä»¬è¯´â€œMySQLæŒ‚æ‰â€ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å°±æ˜¯å“åº”æ…¢äº†ï¼›<br><br>å¦‚æœè¯´é‡å¯çš„è¯ï¼Œ æœ‰ä¸€ç§æ˜¯InnoDB è¯» ioè¿Ÿè¿Ÿä¸è¿”å›ï¼Œä¼šè‡ªå·±é‡å¯ï¼›<br>è¿˜æœ‰æ˜¯innodb_buffer_pool_size è®¾ç½®å¤ªå¤§ï¼Œå†åŠ ä¸Šserverå±‚ä½¿ç”¨çš„å†…å­˜ï¼Œå¯¼è‡´å†…å­˜è¶…è¿‡ç³»ç»Ÿä¸Šé™è¢«oomã€‚æˆ‘ä»¬è¯´ä¸€ä¸ªå¤§æŸ¥è¯¢ä¸ä¼šæ‰“çˆ†ï¼Œä½†æ˜¯å¦‚æœå¾ˆå¤šå¹¶å‘æŸ¥è¯¢ï¼Œè¿˜æ˜¯å¯èƒ½çš„ã€‚<br> ","user_name":"ä½œè€…å›å¤","comment_id":64006,"uid":"1264162","ip_address":"","utype":1,"ctime":1548643687,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"35908379111","product_id":100020801,"comment_content":"æœ€è¿‘ç³»ç»Ÿå‡ºç°äº†ç”±äºæŸ¥è¯¢å¤§é‡æ•°æ®è€Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨çš„æƒ…å†µï¼Œå½“æ—¶ç¬¬ä¸€ååº”æ˜¯æ•°æ®åº“å†…å­˜æ‰“æ»¡äº†ï¼Œåæ¥å‘ç°æ•°æ®åº“æ­£å¸¸ï¼Œåº”ç”¨æœåŠ¡å› ä¸ºOOMæŒ‚æ‰äº†ï¼Œè™½ç„¶è¿™ä¸ªé—®é¢˜è§£å†³äº†ï¼Œä½†ä¸€ç›´æ‹…å¿ƒå¦‚æœåº”ç”¨æœåŠ¡å¹¶å‘è¿™æ ·çš„æŸ¥è¯¢è¯­å¥ï¼ŒMySQLæ˜¯å¦ä¹Ÿä¼šOOMã€‚æ‰€ä»¥è¯´ä»Šå¤©è¿™ç¯‡æ–‡ç« çœŸæ˜¯å¤ªåŠæ—¶äº†ã€‚<br>ä¸€ç›´æœ‰ä¸€ä¸ªç–‘é—®ï¼Œæˆ‘ä¸ªäººç†è§£ç”¨æˆ·è¿›ç¨‹æŒ‚æ‰çš„æ ¹æœ¬åŸå› å‡ ä¹éƒ½æ˜¯æ¥è‡ªå†…å­˜ï¼ˆè®¿é—®éæ³•åœ°å€æˆ–è€…OOMç­‰ï¼‰ã€‚æ—¢ç„¶MySQLåœ¨æŸ¥è¯¢å¤§é‡æ•°æ®æ—¶ä¸ä¼šå¯¼è‡´OOMï¼Œåœ¨è¿æ¥æ•°å’Œå†…å­˜å¤§å°æ–¹é¢å¦‚æœå‚æ•°è®¾ç½®åˆç†åº”è¯¥ä¹Ÿä¸ä¼šå¯¼è‡´OOMï¼Œé‚£è¿˜æœ‰ä»€ä¹ˆæƒ…å†µå¯ä»¥ä½¿MySQLæŒ‚æ‰ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437806,"discussion_content":"ä¸€èˆ¬æˆ‘ä»¬è¯´â€œMySQLæŒ‚æ‰â€ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å°±æ˜¯å“åº”æ…¢äº†ï¼›\n\nå¦‚æœè¯´é‡å¯çš„è¯ï¼Œ æœ‰ä¸€ç§æ˜¯InnoDB è¯» ioè¿Ÿè¿Ÿä¸è¿”å›ï¼Œä¼šè‡ªå·±é‡å¯ï¼›\nè¿˜æœ‰æ˜¯innodb_buffer_pool_size è®¾ç½®å¤ªå¤§ï¼Œå†åŠ ä¸Šserverå±‚ä½¿ç”¨çš„å†…å­˜ï¼Œå¯¼è‡´å†…å­˜è¶…è¿‡ç³»ç»Ÿä¸Šé™è¢«oomã€‚æˆ‘ä»¬è¯´ä¸€ä¸ªå¤§æŸ¥è¯¢ä¸ä¼šæ‰“çˆ†ï¼Œä½†æ˜¯å¦‚æœå¾ˆå¤šå¹¶å‘æŸ¥è¯¢ï¼Œè¿˜æ˜¯å¯èƒ½çš„ã€‚\n ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548643687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66836,"user_name":"zzz2","can_delete":false,"product_type":"c1","uid":1358407,"ip_address":"","ucode":"C1FB57A8FD7849","user_header":"","comment_is_top":false,"comment_ctime":1550027422,"is_pvip":false,"replies":[{"id":"23672","content":"qcache hitsè¯´çš„å°±æ˜¯æŸ¥è¯¢ç¼“å­˜å‘½ä¸­ç‡å§<br><br>ä¸€èˆ¬æˆ‘ä»¬è¯´å†…å­˜å‘½ä¸­ç‡ï¼Œä¸€èˆ¬æ˜¯æŒ‡buffer poolå‘½ä¸­ç‡","user_name":"ä½œè€…å›å¤","comment_id":66836,"uid":"1264162","ip_address":"","utype":1,"ctime":1550047712,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"31614798494","product_id":100020801,"comment_content":"è€å¸ˆ ï¼Œè¯·é—®mysqlå†…å­˜å‘½ä¸­ç‡å’Œç¼“å­˜å‘½ä¸­ç‡qcache hitsæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438937,"discussion_content":"qcache hitsè¯´çš„å°±æ˜¯æŸ¥è¯¢ç¼“å­˜å‘½ä¸­ç‡å§\n\nä¸€èˆ¬æˆ‘ä»¬è¯´å†…å­˜å‘½ä¸­ç‡ï¼Œä¸€èˆ¬æ˜¯æŒ‡buffer poolå‘½ä¸­ç‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550047712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000550,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/66/95976d10.jpg","nickname":"ä¸€è·¯å‘å‰","note":"","ucode":"853B90DF308425","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344912,"discussion_content":"å†…å­˜å‘½ä¸­æ˜¯æŒ‡innodbæŸ¥è¯¢æ—¶å€™ç›´æ¥ä»å†…å­˜å–æ•°æ®ï¼Œä¸éœ€è¦è¯»ç›˜ï¼ŒæŸ¥è¯¢ç¼“å­˜æ˜¯serverç«¯å‘½ä¸­ï¼Œè¿˜æ²¡åˆ°å¼•æ“ã€‚å¦å¤–8.0å·²ç»é»˜è®¤ä¸å¼€å¯æŸ¥è¯¢ç¼“å­˜äº†","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1611625653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64119,"user_name":"å¤©ä½¿æ¢¦æ³ª","can_delete":false,"product_type":"c1","uid":1235750,"ip_address":"","ucode":"782991747DD424","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/26/3c8d68fb.jpg","comment_is_top":false,"comment_ctime":1548670639,"is_pvip":false,"replies":[{"id":"22664","content":"â€œä¿å­˜ä¸€æ®µæ—¶é—´â€æ˜¯å•¥æ„æ€ï¼ŒLRUç®—æ³•ä¸æ˜¯æŒ‰ç…§æ—¶é—´çš„å“ˆï¼Œå¦‚æœæ²¡äººæ¥æ·˜æ±°ï¼Œæ˜¯å¯ä»¥ä¸€ç›´ä¿å­˜çš„ã€‚","user_name":"ä½œè€…å›å¤","comment_id":64119,"uid":"1264162","ip_address":"","utype":1,"ctime":1548673794,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"31613441711","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªé—®é¢˜ä¸æ˜ç™½ï¼Œmysqlä»ç¼“å­˜ä¸­å–æ•°æ®ï¼Œç¼“å­˜é‡Œçš„æ•°æ®æ˜¯æ€ä¹ˆå®ç°å¯ä»¥ä¿å­˜ä¸€æ®µæ—¶é—´çš„ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437868,"discussion_content":"â€œä¿å­˜ä¸€æ®µæ—¶é—´â€æ˜¯å•¥æ„æ€ï¼ŒLRUç®—æ³•ä¸æ˜¯æŒ‰ç…§æ—¶é—´çš„å“ˆï¼Œå¦‚æœæ²¡äººæ¥æ·˜æ±°ï¼Œæ˜¯å¯ä»¥ä¸€ç›´ä¿å­˜çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1548673794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64076,"user_name":"å¦‚æ˜å¦‚æœˆ","can_delete":false,"product_type":"c1","uid":1161049,"ip_address":"","ucode":"0D7FD0FCC11FAF","user_header":"https://static001.geekbang.org/account/avatar/00/11/b7/59/cf13fc22.jpg","comment_is_top":false,"comment_ctime":1548660463,"is_pvip":false,"replies":[{"id":"22655","content":"å—¯ï¼Œè¿™ä¸ªä¸ä¼šè¿”å›ç»“æœåˆ°å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ç½‘ç»œä¸Šä¸ä¼šæœ‰é—®é¢˜<br><br>å¼•æ“å†…éƒ¨çš„æ‰«ææœºåˆ¶æ˜¯å·®ä¸å¤šçš„<br><br>å”¯ä¸€ä¸åŒæ˜¯è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¯¹åŸè¡¨æœ‰è¡Œé”ï¼ˆå¦‚æœè®¾ç½®çš„æ˜¯RRï¼‰<br><br>ä¸‡æˆ–è€…åä¸‡è¿˜å¥½ï¼Œæ˜¯å°æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘æ‹¿åˆ°å®¢æˆ·ç«¯å†å†™å›å»ï¼Œé¿å…é”çš„é—®é¢˜<br><br><br>","user_name":"ä½œè€…å›å¤","comment_id":64076,"uid":"1264162","ip_address":"","utype":1,"ctime":1548663064,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"31613431535","product_id":100020801,"comment_content":"ä¹‹å‰æœ‰ç‰¹æ®ŠåŠŸèƒ½éœ€è¦ä»ä¸»è¦ä¸šåŠ¡åº“æ‹‰å–æŒ‡å®šèŒƒå›´çš„æ•°æ®åˆ°å¦å¤–åŒä¸€ä¸ªåº“çš„å…¶ä»–æ•°æ®è¡¨çš„åŠ¨ä½œï¼ˆinsert  into xxxxx select xxx from xxx è¿™ç§æ“ä½œï¼‰æ•°æ®é‡åœ¨ä¸‡çº§æˆ–è€…åä¸‡çº§ï¼Œå¯¹äºè¿™ç§æ“ä½œï¼Œå’Œæœ¬æ–‡è®²çš„åº”è¯¥æœ‰äº›ä¸åŒå§ï¼Ÿèƒ½å¦å¸®åˆ†æä¸€ä¸‹è¿™ç§åœºæ™¯çš„å¤§è‡´æƒ…å†µå‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®å—ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437846,"discussion_content":"å—¯ï¼Œè¿™ä¸ªä¸ä¼šè¿”å›ç»“æœåˆ°å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ç½‘ç»œä¸Šä¸ä¼šæœ‰é—®é¢˜\n\nå¼•æ“å†…éƒ¨çš„æ‰«ææœºåˆ¶æ˜¯å·®ä¸å¤šçš„\n\nå”¯ä¸€ä¸åŒæ˜¯è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¯¹åŸè¡¨æœ‰è¡Œé”ï¼ˆå¦‚æœè®¾ç½®çš„æ˜¯RRï¼‰\n\nä¸‡æˆ–è€…åä¸‡è¿˜å¥½ï¼Œæ˜¯å°æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘æ‹¿åˆ°å®¢æˆ·ç«¯å†å†™å›å»ï¼Œé¿å…é”çš„é—®é¢˜\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548663064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63964,"user_name":"å°˜å°","can_delete":false,"product_type":"c1","uid":1247006,"ip_address":"","ucode":"CEE0C006387A03","user_header":"https://static001.geekbang.org/account/avatar/00/13/07/1e/bdbe93f4.jpg","comment_is_top":false,"comment_ctime":1548632364,"is_pvip":false,"replies":[{"id":"22626","content":"æ»¡16kå°±å‘ç»™socket send buffer","user_name":"ä½œè€…å›å¤","comment_id":63964,"uid":"1264162","ip_address":"","utype":1,"ctime":1548636568,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":5,"race_medal":0,"score":"31613403436","product_id":100020801,"comment_content":"å¦‚æœä¸€è¡Œæ•°æ®è¶…è¿‡äº†net buffer lengthçš„é»˜è®¤å€¼16KBä¼šå¦‚ä½•ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437785,"discussion_content":"æ»¡16kå°±å‘ç»™socket send buffer","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548636568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":176536,"discussion_content":"é‚£æ˜¯ä¸æ˜¯æœ‰æƒ…å†µå®¢æˆ·ç«¯åªæ”¶åˆ°åŠè¡Œæ•°æ®ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582037103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":178541,"discussion_content":"å¦‚æœè¿™æ ·ï¼Œç¨‹åºå±‚é¢ä¼šæŠ›å¼‚å¸¸é”™è¯¯å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582172319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":176536,"ip_address":""},"score":178541,"extra":""},{"author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":180240,"discussion_content":"å¼‚å¸¸åº”è¯¥æ˜¯æœ‰çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582287728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":178541,"ip_address":""},"score":180240,"extra":""},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1541014,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/96/73ff13a0.jpg","nickname":"å¤©äº®å‰è¯´æ™šå®‰","note":"","ucode":"1D82EE562A7C71","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588098,"discussion_content":"ä¸ä¼šæŠ›å¼‚å¸¸å§ï¼›tcpæœ¬æ¥å°±æ˜¯æµå¼å¤„ç†ï¼Œæ”¶åˆ°çš„åŒ…ä¸å®Œæ•´å¾ˆæ­£å¸¸ï¼Œä¸€èˆ¬éƒ½æ˜¯å®¢æˆ·ç«¯é˜»å¡è·å–ç›´åˆ°æ„æˆä¸€ä¸ªå®Œæ•´æ•°æ®æŠ¥è¿™æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663554884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":176536,"ip_address":"å¹¿ä¸œ"},"score":588098,"extra":""}]}]},{"had_liked":false,"id":64164,"user_name":"Ryoma","can_delete":false,"product_type":"c1","uid":1130590,"ip_address":"","ucode":"7F692369239692","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","comment_is_top":false,"comment_ctime":1548682520,"is_pvip":true,"replies":[{"id":"22712","content":"0  ğŸ˜†<br><br>1.  æœä¸€ä¸‹ innodb_buffer_pool_instances è¿™ä¸ªå‚æ•°çš„è§£é‡Šå“ˆ","user_name":"ä½œè€…å›å¤","comment_id":64164,"uid":"1264162","ip_address":"","utype":1,"ctime":1548689984,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":2,"score":"27318486296","product_id":100020801,"comment_content":"æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š<br>0ï¼šMySQL ä¸­çš„æ–°ç”Ÿä»£å’Œè€ç”Ÿä»£çš„åå­—è¿™ä¹ˆåäººç±»çš„ä¹ˆ<br>1ï¼šæˆ‘åœ¨ä½¿ç”¨show engine innodb statusçœ‹Buffer Poolæ—¶ï¼Œå‘ç°Buffer Poolæœ‰8ä¸ªï¼ˆ0~8ï¼‰ï¼Œè¯·é—®è€å¸ˆè¿™ä¸ªæ˜¯ä»€ä¹ˆç­–ç•¥å‘¢ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437893,"discussion_content":"0  ğŸ˜†\n\n1.  æœä¸€ä¸‹ innodb_buffer_pool_instances è¿™ä¸ªå‚æ•°çš„è§£é‡Šå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548689984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63988,"user_name":"00æ±Ÿ","can_delete":false,"product_type":"c1","uid":1391005,"ip_address":"","ucode":"70A0419B0D3D15","user_header":"https://static001.geekbang.org/account/avatar/00/15/39/9d/52107153.jpg","comment_is_top":false,"comment_ctime":1548637701,"is_pvip":false,"replies":[{"id":"22642","content":"å°±æ˜¯å®¢æˆ·ç«¯ä¸å»è¯»<br><br>æ¯”å¦‚å®¢æˆ·ç«¯å‹åŠ›å¾ˆå¤§ï¼Œcpuæ²¡æœ‰è½®è½¬ä¸åˆ°ï¼›<br>æˆ–è€…è¯»å®Œä¸€è¡Œæ•°æ®åï¼Œåˆå»è¯»åˆ«çš„ç³»ç»Ÿï¼ˆæ¯”å¦‚æœç´¢ç³»ç»Ÿï¼‰ï¼Œå’Œç±»ä¼¼çš„è€—æ—¶æ“ä½œ","user_name":"ä½œè€…å›å¤","comment_id":63988,"uid":"1264162","ip_address":"","utype":1,"ctime":1548643756,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":2,"race_medal":0,"score":"27318441477","product_id":100020801,"comment_content":"æ–‡ä¸­æåˆ°ï¼š æœåŠ¡ç«¯æ˜¯è¾¹è¯»è¾¹å‘çš„<br>å³æœåŠ¡ç«¯è¯»å–å‘é€ï¼Œè¯»å–å‘é€ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå‡ºç°å®¢æˆ·ç«¯ä¸èƒ½æ¥å—ç»“æœå‘¢ï¼ˆ ç”±äºå®¢æˆ·ç«¯å‹åŠ›å¤ªå¤§ï¼Œè¿Ÿè¿Ÿä¸èƒ½æ¥æ”¶ç»“æœï¼‰<br>","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437796,"discussion_content":"å°±æ˜¯å®¢æˆ·ç«¯ä¸å»è¯»\n\næ¯”å¦‚å®¢æˆ·ç«¯å‹åŠ›å¾ˆå¤§ï¼Œcpuæ²¡æœ‰è½®è½¬ä¸åˆ°ï¼›\næˆ–è€…è¯»å®Œä¸€è¡Œæ•°æ®åï¼Œåˆå»è¯»åˆ«çš„ç³»ç»Ÿï¼ˆæ¯”å¦‚æœç´¢ç³»ç»Ÿï¼‰ï¼Œå’Œç±»ä¼¼çš„è€—æ—¶æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548643756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1227511,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ba/f7/eaa138ee.jpg","nickname":"Eric","note":"","ucode":"7D886CF30A8E22","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559871,"discussion_content":"æ€ä¹ˆæ¨¡æ‹Ÿæ•…æ„è®©å®¢æˆ·ç«¯ä¸å»è¯» socket receive buffer ä¸­çš„å†…å®¹ï¼Ÿç„¶ååœ¨æœåŠ¡ç«¯ show processlist çœ‹åˆ°çš„ç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649024896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80896,"user_name":"æ˜¯æˆ‘çš„æµ·","can_delete":false,"product_type":"c1","uid":1197457,"ip_address":"","ucode":"4BCE240829676A","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/91/afda3094.jpg","comment_is_top":false,"comment_ctime":1553751895,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23028588375","product_id":100020801,"comment_content":"åœ¨çº¿ä¸Šé‡åˆ°è¿‡ä¸€ä¸ªé—®é¢˜ï¼š<br>1.åœ¨æ…¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€æ¡ä¸šåŠ¡ sql è¯­å¥æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œä½†æ˜¯è‡ªå·±åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œæ—¶ç¬é—´è¿”å›ç»“æœï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿä¼šæ˜¯ç”±äºå‘é€çš„æ•°æ®å¤šé˜»å¡é€ æˆçš„ä¹ˆ ï¼Ÿ(net_buffer_lengthå¤ªå° ï¼Ÿï¼‰ <br>2.æ…¢æŸ¥è¯¢è¯­å¥åˆ°åº•æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Ÿå¤„äºsending to client çŠ¶æ€ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿä¼šç»Ÿè®¡ç­‰å¾…å†™å…¥net_buffer_length çš„æ—¶é—´å‘¢ ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1607424,"avatar":"https://static001.geekbang.org/account/avatar/00/18/87/00/18eea339.jpg","nickname":"ğŸ§","note":"","ucode":"ED54DE6D0CF497","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392225,"discussion_content":"æ˜¯å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630914439,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1303322,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/1a/061e77b6.jpg","nickname":"äº¢æ˜Ÿä¸œ","note":"","ucode":"5E4063E83B2BB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331865,"discussion_content":"å®¢æˆ·ç«¯åº”è¯¥æ˜¯åŠ äº†limité™åˆ¶è¿”å›æ¡æ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606996041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64228,"user_name":"SICUN","can_delete":false,"product_type":"c1","uid":1254261,"ip_address":"","ucode":"22A384904EB9E9","user_header":"https://static001.geekbang.org/account/avatar/00/13/23/75/2b599841.jpg","comment_is_top":false,"comment_ctime":1548723124,"is_pvip":false,"replies":[{"id":"22758","content":"1.  æ˜¯ ï¼Œä½†æ˜¯ä¹Ÿä¸æ˜¯â€œå…¨éƒ¨æ”¾åˆ°buffer poolä»¥åâ€æ‰å‘ï¼Œè¯»çš„æ—¶å€™æ˜¯ä¸€ä¸ªpage ä¸€ä¸ªpage åœ°è¯»çš„<br>2. ä¼šï¼Œå¥½åœ¨è¿™ä¸ªæ˜¯â€œæŸä¸€é¡µâ€è€Œå·²ï¼Œé‡ä¸å¤§ã€‚ å¥½é—®é¢˜<br><br>å¾ˆå¥½çš„æ€è€ƒ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548731472,"ip_address":"","comment_id":64228,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23023559604","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜éº»çƒ¦è§£æƒ‘ä¸€ä¸‹<br>1.æ‰«æ200Gçš„è¡¨æ—¶æ•°æ®ä¼šå…ˆæ”¾åˆ°InnoDB buffer pool,ç„¶åå‘é€æ—¶åœ¨è¯»å–åˆ°net_bufferå—ï¼Ÿ<br>2.å¦‚æœæ˜¯çš„è¯ï¼Œå¼‚å¸¸æƒ…å†µå¯¼è‡´socket send bufferè¢«å†™æ»¡ï¼Œæ˜¯ä¸æ˜¯ä¼šå‡ºç°InnoDB bufferä¸­çš„æŸä¸€é¡µæœ‰å¯èƒ½å‡ºç°è¯»å–åé¢çš„è¡Œæ—¶ï¼Œè¶…è¿‡1sï¼Œè€Œè¢«æ”¾åˆ°yongåŒºåŸŸçš„æƒ…å†µï¼Ÿ<br>ä¸çŸ¥é“è¿™æ ·è¡¨è¿°æˆ–è€…ç†è§£çš„å¯¹å—","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437913,"discussion_content":"1.  æ˜¯ ï¼Œä½†æ˜¯ä¹Ÿä¸æ˜¯â€œå…¨éƒ¨æ”¾åˆ°buffer poolä»¥åâ€æ‰å‘ï¼Œè¯»çš„æ—¶å€™æ˜¯ä¸€ä¸ªpage ä¸€ä¸ªpage åœ°è¯»çš„\n2. ä¼šï¼Œå¥½åœ¨è¿™ä¸ªæ˜¯â€œæŸä¸€é¡µâ€è€Œå·²ï¼Œé‡ä¸å¤§ã€‚ å¥½é—®é¢˜\n\nå¾ˆå¥½çš„æ€è€ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548731472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63959,"user_name":"Long","can_delete":false,"product_type":"c1","uid":1318970,"ip_address":"","ucode":"2417242560360A","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg","comment_is_top":false,"comment_ctime":1548623421,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23023459901","product_id":100020801,"comment_content":"æœ€è¿‘æ²¡æ—¶é—´çœ‹ï¼Œä»Šå¤©ç»ˆäºè¡¥å®Œäº†å‡ å¤©çš„è¯¾ã€‚","like_count":5},{"had_liked":false,"id":68640,"user_name":"Richard","can_delete":false,"product_type":"c1","uid":1302876,"ip_address":"","ucode":"C16AE7CE877DCA","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/5c/b32f00b1.jpg","comment_is_top":false,"comment_ctime":1550564220,"is_pvip":false,"replies":[{"id":"24390","content":"å—¯ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯å¯èƒ½å¯¼è‡´ä½ çš„å®¢æˆ·ç«¯åº”ç”¨å ç”¨å†…å­˜è¿‡å¤šçš„ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550571983,"ip_address":"","comment_id":68640,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18730433404","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œä½œä¸ºä¸€ä¸ªjavaåç«¯å¼€å‘äººå‘˜æœ‰ä¸ªç–‘é—®ï¼Œå¦‚æœå¯¹ä¸€ä¸ªå¤§è¡¨è¿›è¡Œselectï¼Œå¦‚ï¼šselect * from big_table;<br>ç”¨ä¸€ä¸ªList&lt;Object&gt;æ¥æ¥ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯æŠŠæ•°æ®éƒ½ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜äº†å§ï¼Œæ˜¯å’Œä¸Šé¢çš„å…¨è¡¨æ‰«æè¾¹è¯»è¾¹å†™çš„æƒ…å†µä¸åŒçš„å§ï¼Ÿä¹Ÿå°±æ˜¯æˆ‘æ‰€è¯´çš„è¿™ç§æ“ä½œæ˜¯å¯èƒ½å¯¼è‡´OOMçš„æ˜¯å—","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439773,"discussion_content":"å—¯ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯å¯èƒ½å¯¼è‡´ä½ çš„å®¢æˆ·ç«¯åº”ç”¨å ç”¨å†…å­˜è¿‡å¤šçš„ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550571983,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2086624,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/d6/e0/3ccaaa7b.jpg","nickname":"é¢†å­","note":"","ucode":"64AC4E6AB74E68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295121,"discussion_content":"æ•°æ®åº“ç«¯ä¸ä¼šçˆ†ï¼Œçˆ†çš„æ˜¯ä½ javaè°ƒç”¨ç«¯","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596096004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297093,"discussion_content":"ä½ è¿™ç§æƒ…å†µè·Ÿæ•°æ®åº“é‚£è¾¹æ²¡å…³ç³»äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596772659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64630,"user_name":"æ¢ä¸­å","can_delete":false,"product_type":"c1","uid":1006789,"ip_address":"","ucode":"52FE40242CBAD0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg","comment_is_top":false,"comment_ctime":1548838055,"is_pvip":true,"replies":[{"id":"22879","content":"<br>å¥½å‡ ä¸ªåŒå­¦è¿™ä¹ˆè¯´ï¼Œæˆ‘éƒ½æ–¹äº†ğŸ˜†<br>è¿™å¥æ˜¯å®˜æ–¹æ–‡æ¡£ä¸Šçš„<br><br>â€œAccessing a page in the old sublist makes it â€œyoungâ€, moving it to the head of the buffer poolâ€<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548839597,"ip_address":"","comment_id":64630,"utype":1}],"discussion_count":4,"race_medal":1,"score":"18728707239","product_id":100020801,"comment_content":"æ„Ÿè§‰young å’Œold çš„å«æ³•åäº†ï¼Œåé¢çš„åº”è¯¥å«young æ‰å¥½ç†è§£ã€‚å¦å¤–æ–‡ä¸­çš„old åŒºä¹Ÿä¼šæœ‰ç±»ä¼¼young åŒºåŸŸçš„æ·˜æ±°ç­–ç•¥å§","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438110,"discussion_content":"\nå¥½å‡ ä¸ªåŒå­¦è¿™ä¹ˆè¯´ï¼Œæˆ‘éƒ½æ–¹äº†ğŸ˜†\nè¿™å¥æ˜¯å®˜æ–¹æ–‡æ¡£ä¸Šçš„\n\nâ€œAccessing a page in the old sublist makes it â€œyoungâ€, moving it to the head of the buffer poolâ€\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548839597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"æ¨å®‡","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329618,"discussion_content":"ä¸JVMçš„å †ç›¸åã€‚ä¹Ÿè®¸MySQLè®¤ä¸ºè€çš„æ‰å®¹æ˜“å»ä¸–å§","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606436427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018972,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","nickname":"äºšæ—","note":"","ucode":"4A5A6D24314B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570258,"discussion_content":"å’ŒJVMæœ‰ç‚¹ç±»ä¼¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651718554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098504,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c3/08/28c327d0.jpg","nickname":"å†°æ²³æ—¶ä»£","note":"","ucode":"F4375FB7CE4FD4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339584,"discussion_content":"æˆ‘æœ€å¼€å§‹ä¹Ÿæ‡µäº†ä¸€å“ˆï¼Œåé¢æƒ³æ˜¯å¯¹çš„ï¼Œæ·˜æ±°æœ€è€çš„å˜›ï¼Œæ‰€ä»¥åŠ åˆ°å tail éƒ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609741003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64162,"user_name":"è€æ¨åŒå¿—","can_delete":false,"product_type":"c1","uid":1246199,"ip_address":"","ucode":"3F334F0CFD3DE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg","comment_is_top":false,"comment_ctime":1548682470,"is_pvip":false,"replies":[{"id":"22711","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548689925,"ip_address":"","comment_id":64162,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18728551654","product_id":100020801,"comment_content":"è€å¸ˆæç¤ºè€ƒè™‘ä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½è¿›è¡Œupdateçš„æƒ…å†µã€‚<br>å¦‚æœç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œselect * from t for update è€Œè¿Ÿè¿Ÿä¸è¯»å–è¿”å›çš„æ•°æ®ï¼Œä¼šé€ æˆserverç«¯é•¿æœŸå ç”¨è®°å½•çš„è¡Œé”ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹è¦æ›´æ–°è¢«é”å®šçš„è®°å½•ï¼Œä¼šæŠ¥é”ç­‰å¾…è¶…æ—¶çš„é”™è¯¯<br>","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437892,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548689925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64090,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":false,"comment_ctime":1548664552,"is_pvip":false,"replies":[{"id":"22713","content":"å†™net_buffer -- &gt; net_bufferæ»¡äº†ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘ --&gt;å‘ä¸å‡ºå»<br>è¿™ä¸ªæ˜¯åŒä¸€ä¸ªè°ƒç”¨é“¾æ¡å‘€<br><br>â€œå“ªä¸ªé˜¶æ®µâ€æ²¡çœ‹æ‡‚ï¼Œæ˜¯åŒä¸€ä¸ªæ—¶åˆ»","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548690089,"ip_address":"","comment_id":64090,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18728533736","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚æ„Ÿè°¢è§£ç­”ã€‚<br>æ¥ä¸Šä¸ªé—®é¢˜ã€‚<br>Sending to client æ˜¯å‘ç”Ÿåœ¨ä¸‹é¢å“ªä¸ªé˜¶æ®µçš„äº‹ä»¶å‘¢ï¼Ÿ<br>1)æ˜¯ â€œè·å–ä¸€è¡Œï¼Œå†™åˆ° net_buffer ä¸­ã€‚â€<br>2)è¿˜æ˜¯â€œç›´åˆ° net_buffer å†™æ»¡ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘å‡ºå»ã€‚â€ &#47;&#47;å³æ•°æ®ä» net_buffer å‘åˆ° socket send bufferï¼Ÿ<br>3)è¿˜æ˜¯â€œå°† socket send buffer çš„æ•°æ®å‘é€ç»™ socket receive bufferâ€<br><br>ä»æ‚¨çš„å›ç­”â€œä½†æ˜¯å¦‚æœæˆ‘æŠŠnet_buffer_length æ”¹æˆ10Mï¼Œå°±ä¸ä¼šæœ‰â€œSending to clientâ€ çš„æƒ…å†µã€‚â€ï¼Œæˆ‘æ„Ÿè§‰åº”è¯¥æ˜¯å±äºç¬¬1)é˜¶æ®µçš„äº‹ä»¶ã€‚ä½†æ„Ÿè§‰è¿™åˆä¸æ‚¨è¯´çš„â€œSending to client è¡¨ç¤ºçš„æ˜¯æœåŠ¡å™¨ç«¯çš„ç½‘ç»œæ ˆå†™æ»¡äº†â€ç›¸çŸ›ç›¾ã€‚","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437853,"discussion_content":"å†™net_buffer -- &amp;gt; net_bufferæ»¡äº†ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘ --&amp;gt;å‘ä¸å‡ºå»\nè¿™ä¸ªæ˜¯åŒä¸€ä¸ªè°ƒç”¨é“¾æ¡å‘€\n\nâ€œå“ªä¸ªé˜¶æ®µâ€æ²¡çœ‹æ‡‚ï¼Œæ˜¯åŒä¸€ä¸ªæ—¶åˆ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548690089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261360,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/30/23f6b413.jpg","nickname":"äº”åä¹ç§’","note":"","ucode":"1F34F62193CFF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308690,"discussion_content":"çœ‹è¿‡å‡ ä¸ªé—®ç­”åï¼Œå¯¹äºä¸ºä»€ä¹ˆè¯´å¤šä¸ªçº¿ç¨‹å¤„äºSending to clientçŠ¶æ€ï¼Œæ˜¯å› ä¸ºç½‘ç»œæ ˆæ»¡äº†ï¼Œä½†æ–‡ä¸­å´è¯´å¢åŠ net_bufferçš„å€¼ï¼Œå¯ä»¥å¿«é€Ÿå‡å°‘Sending to clientçŠ¶æ€çš„çº¿ç¨‹ï¼Œæ˜¯ä¸æ˜¯å› ä¸ºåªè¦æ‰§è¡Œå™¨æŠŠæ•°æ®éƒ½å†™å…¥net_bufferäº†ï¼Œçº¿ç¨‹å°±ä¸å¤„äºSending to clientçš„çŠ¶æ€äº†ï¼Œä½†è¿™åˆè·Ÿç½‘ç»œæ ˆæ»¡äº†æœ‰ä»€ä¹ˆå…³ç³»ï¼Œå¦‚æœè¿™ä¹ˆåšåªæ˜¯è§£å†³äº†ä¸ä½¿å¤šä¸ªçº¿ç¨‹å¤„äºSending to clientçŠ¶æ€çš„é—®é¢˜ï¼Œå¹¶æ²¡æœ‰è§£å†³ç½‘ç»œæ ˆæ»¡äº†çš„é—®é¢˜ï¼Œè¿™ä¹ˆå¤„ç†ä¸æ˜¯è‡ªæ¬ºæ¬ºäººå—ï¼Œå¿ƒä¸­ä¹Ÿæ„Ÿè§‰æ¯”è¾ƒå›°æƒ‘ã€‚\nç¬¬ä¸€ç§æƒ…å†µï¼šå¦‚æœæ‰§è¡Œå™¨è¯»å–å®Œå¹¶æŠŠæŠŠæ•°æ®å†™åˆ°net_bufferå°±è®¤ä¸ºå·²ç»æ˜¯æ‰§è¡Œå®Œäº†ï¼Œå³çº¿ç¨‹ä¸ä¼šåœ¨å¤„äºSending to clientçš„çŠ¶æ€ï¼Œå¯èƒ½å› ä¸ºæ•°æ®ä»net_bufferåˆ°socket send bufferæ˜¯å¾ˆå¿«çš„ï¼Œæ‰€ä»¥å¦‚æœç½‘ç»œæ ˆæ²¡æœ‰å†™æ»¡ä¸ä¼šæœ‰å¾ˆå¤šçº¿ç¨‹å¤„äºè¿™ä¸ªçŠ¶æ€ï¼Œä»è€Œæ¨æµ‹å‡ºå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹å‡ºäºSending to clientçš„çŠ¶æ€ï¼Œæ˜¯å› ä¸ºç½‘ç»œæ ˆå†™æ»¡äº†ã€‚\nç¬¬äºŒç§æƒ…å†µï¼šæŠŠæ•°æ®ä»net_bufferåˆ°socket send bufferç®—æ˜¯æ‰§è¡Œå®Œï¼Œå³çº¿ç¨‹ä¸ä¼šåœ¨å¤„äºSending to clientçš„çŠ¶æ€,ï¼Œè¿™ç§æƒ…å†µå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹å‡ºäºSending to clientçš„çŠ¶æ€ï¼Œè‚¯å®šæ˜¯å› ä¸ºç½‘ç»œæ ˆå†™æ»¡äº†ã€‚\nä»åˆ†æé—®é¢˜çš„è§’åº¦çœ‹ï¼Œå¦‚æœå‡ºç°äº†å¤šä¸ªçº¿ç¨‹å¤„äºSending to clientçš„çŠ¶æ€ï¼ŒæŠŠå…³æ³¨ç‚¹ä»Sending to clientçš„çŠ¶æ€ï¼Œè½¬ç§»åˆ°ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œå¦‚ä½•é™ä½å½±å“ã€‚net_bufferæ˜¯æ¯ä¸ªçº¿ç¨‹ç‹¬æœ‰çš„å†…å­˜ï¼Œå†™æ»¡åå¾ˆå¿«å°±èƒ½å‘é€åˆ°socket send bufferï¼Œsocket send bufferæ˜¯å…¬ç”¨çš„ï¼Œå¹¶ä¸”ç©ºé—´ä¸å¤§ï¼Œæ‰€ä»¥ç“¶é¢ˆæœ€å¯èƒ½åœ¨ç½‘ç»œæ ˆã€‚è€Œæ­¤æ—¶å¢å¤§net_bufferçš„å€¼ç›®çš„æ˜¯è®©inodbå¼•æ“ä¸­çš„æ“ä½œæ‰§è¡Œå®Œï¼Œé‡Šæ”¾é”ç­‰èµ„æºï¼Œä¸å¯¹å…¶ä»–çš„ä¸šåŠ¡é€ æˆå½±å“ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601032049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64037,"user_name":"lochenî„","can_delete":false,"product_type":"c1","uid":1309747,"ip_address":"","ucode":"CE48502320EAB6","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/33/dd48f1c5.jpg","comment_is_top":false,"comment_ctime":1548645205,"is_pvip":false,"replies":[{"id":"22650","content":"ä¸æ­£å¸¸ <br>æ‰§è¡Œè¿‡ç¨‹ä¸­show processlistå’Œshow engine innodb status çœ‹çœ‹åœ¨å¹²å•¥","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548655531,"ip_address":"","comment_id":64037,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18728514389","product_id":100020801,"comment_content":"æ‰ä¸€ç™¾å¤šä¸‡æ¡æ•°æ® ä¸ºå•¥æŸ¥ä¸ªæ€»æ•°èŠ±äº†30æ¥ç§’å“¦ ç®—æ­£å¸¸å— select count(id) from table;","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437824,"discussion_content":"ä¸æ­£å¸¸ \næ‰§è¡Œè¿‡ç¨‹ä¸­show processlistå’Œshow engine innodb status çœ‹çœ‹åœ¨å¹²å•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548655531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64008,"user_name":"é”…å­","can_delete":false,"product_type":"c1","uid":1323048,"ip_address":"","ucode":"4A9143AFB07FF2","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/28/6e019a7a.jpg","comment_is_top":false,"comment_ctime":1548640919,"is_pvip":false,"replies":[{"id":"22640","content":"1. è¿™æ˜¯ä¸€ç§å¯èƒ½å“¦ï¼Œå¾ˆå¥½çš„ä¾‹å­<br>2. å…¶å®net_bufferï¼Œå’Œ socket send bufferå·²ç»æ˜¯å½“åšç¼“å­˜æ¥ç†è§£äº†ã€‚å¦‚æœè¿˜ä¸å¤Ÿï¼Œè¦æŠŠæ•°æ®éƒ½å­˜èµ·æ¥ï¼Œå°±æ€•æ•°æ®é‡å¤ªå¤§ï¼Œåƒæˆ‘ä»¬æ–‡ä¸­æçš„200Gçš„æ•°æ®è¡¨æ‰«æï¼Œé‚£è¿˜æ˜¯å—ä¸äº†çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548643359,"ip_address":"","comment_id":64008,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18728510103","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œçœ‹å®Œè¿™ç¯‡æ–‡ç« æœ‰ä¸¤ä¸ªç–‘é—®ï¼š<br>1ã€å¦‚æœnet_bufferè®¾ç½®è¿‡å°ï¼Œä¼šä¸ä¼šé€ æˆæ•°æ®é¡µåœ¨LRUé“¾è¡¨ä¸­è¶…è¿‡innodb_old_blocks_timeçš„å€¼ï¼Œé™ä½å†…å­˜å‘½ä¸­ç‡å•Šï¼Ÿ<br>2ã€MySQLæœ‰æ²¡æœ‰ç±»ä¼¼ç¼“å­˜çš„ä¸œè¥¿ï¼Œå°†æŸ¥è¯¢çš„æ•°æ®å…ˆå­˜èµ·æ¥ï¼Œè€Œä¸æ˜¯ç›´æ¥å‘é€ç»™net_bufferï¼Œé¿å…é—®é¢˜1çš„æƒ…å†µå‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437807,"discussion_content":"1. è¿™æ˜¯ä¸€ç§å¯èƒ½å“¦ï¼Œå¾ˆå¥½çš„ä¾‹å­\n2. å…¶å®net_bufferï¼Œå’Œ socket send bufferå·²ç»æ˜¯å½“åšç¼“å­˜æ¥ç†è§£äº†ã€‚å¦‚æœè¿˜ä¸å¤Ÿï¼Œè¦æŠŠæ•°æ®éƒ½å­˜èµ·æ¥ï¼Œå°±æ€•æ•°æ®é‡å¤ªå¤§ï¼Œåƒæˆ‘ä»¬æ–‡ä¸­æçš„200Gçš„æ•°æ®è¡¨æ‰«æï¼Œé‚£è¿˜æ˜¯å—ä¸äº†çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548643359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71778,"user_name":"è¿›é˜¶çš„ç å†œ","can_delete":false,"product_type":"c1","uid":1017821,"ip_address":"","ucode":"D8991282640334","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg","comment_is_top":false,"comment_ctime":1551430763,"is_pvip":false,"replies":[{"id":"25976","content":"ä½ æŠŠä»–ä»¬å½“ä½œä¸¤ä¸ªå•ç‹¬çš„è¡Œä¸ºï¼Œåªæ˜¯åˆšå¥½å…±åŒåŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè€Œå·²","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1551439724,"ip_address":"","comment_id":71778,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14436332651","product_id":100020801,"comment_content":"å¦‚æœå®¢æˆ·ç«¯æ˜¯åœ¨ä¸»æœºä¸Šå‘¢","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441326,"discussion_content":"ä½ æŠŠä»–ä»¬å½“ä½œä¸¤ä¸ªå•ç‹¬çš„è¡Œä¸ºï¼Œåªæ˜¯åˆšå¥½å…±åŒåŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551439724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64292,"user_name":"Sinyo","can_delete":false,"product_type":"c1","uid":1307297,"ip_address":"","ucode":"57B243E7AB86A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132","comment_is_top":false,"comment_ctime":1548735835,"is_pvip":false,"replies":[{"id":"22774","content":"è¿˜æ˜¯ä¼šæ˜¾ç¤ºä¸ºâ€œSending to clientâ€ï¼Œä½†æ˜¯è¯­å¥å·²ç»æ‰§è¡Œå®Œäº†ã€‚<br>ä¸ä¼šå ç€èµ„æºï¼ˆæ¯”å¦‚MDLè¯»é”ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548741010,"ip_address":"","comment_id":64292,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14433637723","product_id":100020801,"comment_content":"@700 çš„ç½®é¡¶æé—® <br>è€å¸ˆä½ è¯´ï¼š&quot;ä½†æ˜¯å¦‚æœæŠŠ net_buffer_length æ”¹æˆ 10Mï¼Œå°±ä¸ä¼šæœ‰â€œSending to clientâ€çš„æƒ…å†µã€‚è™½ç„¶ç½‘ç»œæ ˆè¿˜æ˜¯æ…¢æ…¢å‘çš„ï¼Œä½†æ˜¯é‚£äº›æ²¡å‘å®Œçš„éƒ½ç¼“å­˜åœ¨net_bufferä¸­ï¼Œå¯¹äºæ‰§è¡Œå™¨æ¥è¯´ï¼Œéƒ½æ˜¯â€œå·²ç»å†™å‡ºå»äº†â€ã€‚&quot;<br><br>å‡å¦‚æ•°æ®é‡æœ‰1Gï¼Œè€Œå¦‚æœè¦å¿«é€Ÿå‡å°‘å¤„äºè¿™ä¸ªçŠ¶æ€çš„çº¿ç¨‹çš„è¯ï¼Œæˆ‘ä»¬æŠŠnet_buffer_length ä»10Mæ”¹æˆ1Gï¼Œå¿«é€Ÿå‡å°‘çš„é‚£éƒ¨åˆ†æ“ä½œæ˜¯ä¸æ˜¯åªæœ‰æœåŠ¡ç«¯å‘é€åˆ°net_bufferçš„è¿™éƒ¨åˆ†ï¼Ÿè¿™æ ·å°±ä¸ä¼šæœ‰â€œSending to clientâ€çš„æƒ…å†µä¹ˆï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437945,"discussion_content":"è¿˜æ˜¯ä¼šæ˜¾ç¤ºä¸ºâ€œSending to clientâ€ï¼Œä½†æ˜¯è¯­å¥å·²ç»æ‰§è¡Œå®Œäº†ã€‚\nä¸ä¼šå ç€èµ„æºï¼ˆæ¯”å¦‚MDLè¯»é”ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548741010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64242,"user_name":"Max","can_delete":false,"product_type":"c1","uid":1302420,"ip_address":"","ucode":"E3F1CD8FCB66B3","user_header":"https://static001.geekbang.org/account/avatar/00/13/df/94/84296110.jpg","comment_is_top":false,"comment_ctime":1548725632,"is_pvip":false,"replies":[{"id":"22956","content":"1. æ˜¯çš„ï¼Œshow columns å…¶å®ä¸æ˜¯ä¸€ä¸ªå¥½æ“ä½œğŸ˜„<br>2. è¿™ä¸ªæ²¡è§è¿‡ï¼Œä¹Ÿæ²¡å°è±¡åœ¨ç¤¾åŒºä¸­ç¢°åˆ°è¿™ç§ç°è±¡ï¼Œé™æˆ5.6å°±å¥½äº†æ˜¯å—ï¼Ÿ<br>3. ä¸ä¼šçš„ï¼Œ34ã€35ä¸¤ç¯‡å°±æ˜¯è¯´è¿™ä¸ªé—®é¢˜çš„å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548940886,"ip_address":"","comment_id":64242,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14433627520","product_id":100020801,"comment_content":"æ—Sir,ä½ å¥½ã€‚<br>æ›¾ç»å‘ç”Ÿè¿‡äºŒä¸ªé—®é¢˜<br>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯show columns from tableå¸¦æ¥çš„ä¸´æ—¶è¡¨äº§ç”Ÿå’Œç§»é™¤<br>å¤§é‡çš„session opening tmp tables å’Œremoving tmp tables<br>ä¹Ÿkillä¸æ‰ä¼šè¯ï¼Œé¦–å…ˆä¸»ä»å…ˆåˆ‡ï¼Œè®©åŸä¸»åœæ­¢å¯¹å¤–æœåŠ¡ã€‚åœ¨killæ‰æ‰€æœ‰ç”¨æˆ·ä¼šè¯ã€‚<br>é—®é¢˜è§£å†³ï¼ŒåŒæ—¶ä¿®æ”¹innodb_thread_concurrencyå‚æ•°æ•°é‡ã€‚<br><br>å¦å¤–ä¸€ä¸ªæ„Ÿè§‰æ˜¯mysql bugå¼•èµ·çš„ã€‚<br>å½“æ—¶ç¯å¢ƒæ˜¯percona-mysql-20-21ä¸»ä»ç¯å¢ƒ<br>æ²¡æœ‰é«˜å¹¶å‘æ‰€ï¼Œæ‰€æœ‰çš„ç”¨æˆ·ä¼šè¯çŠ¶æ€éƒ½æ˜¯query endï¼Œä¼šè¯ä¸é‡Šæ”¾ã€‚<br>é€ æˆä¼šè¯è¿æ¥æ•°æš´æ¶¨ã€‚æ’‘æ»¡äº†æ‰€æœ‰çš„ä¼šè¯ã€‚<br>æŸ¥çœ‹engine innodb statusï¼Œå‘ç°latchç­‰å¾…éå¸¸é«˜ <br>OS WAIT ARRAY INFO: signal count 5607657<br>RW-shared spins 0, rounds 2702261, OS waits 70377<br>RW-excl spins 0, rounds 216191633, OS waits 1802414<br>RW-sx spins 1588, rounds 5965, OS waits 70<br><br>Spin rounds per wait: 2702261.00 RW-shared, 216191633.00 RW-excl, 3.76 RW-sx<br>MySQL thread id 79467374, OS thread handle 140327525230336, query id 949505008 10.0.2.6 apirwuser query end<br>INSERT INTO `xxxxxx` (`xxxx`,`xxxx`,`xxxx`,`xxxx`) VALUES (&#39;c2aab326-adf9-470b-940e-133fa2c7f685&#39;,&#39;android&#39;,&#39;862915033153129&#39;,1535597836)<br>---TRANSACTION 1154797559, ACTIVE (PREPARED) 1 sec<br>mysql tables in use 1, locked 1<br><br>ç¬¬äºŒä¸ªé—®é¢˜ä¸€ç›´æ²¡æœ‰è§£å†³ï¼Œåæ¥æŠŠmysql 5.7 é™åˆ°mysql 5.6<br><br>è¿˜æœ‰ä¸€ä¸ªå…³äºout of memoryé—®é¢˜<br>sqlå¦‚ä¸‹: aæ˜¯çˆ¶è¡¨ï¼Œbæ˜¯å­è¡¨<br>select a.id,a.name,b.title from a inner join b on a.id=b.aid <br>where a.create_time&gt;&#39;2010-08-01 00:00:00&#39; and a.create_time&lt;&#39;2010-08-10 23:59:59&#39; <br>å®ƒçš„æ‰§è¡Œè®¡åˆ’åº”è¯¥æ˜¯<br>1 aè¡¨å’Œbè¡¨ç”Ÿäº§è¿ªå¡é›†äº§ç”Ÿè™šåˆ—é›†åˆTã€‚2ä»é›†åˆTç­›é€‰å‡º a.id(ä¸»é”®)=b.aid(å¤–é”®)äº§ç”Ÿè™šé›†åˆV 3æœ€åä»é›†åˆvç­›é€‰å‡ºwhereæ¡ä»¶ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœã€‚<br>å¦‚æœäºŒä¸ªè¡¨éƒ½è¶…è¿‡åƒä¸‡æ¡è®°å½•ï¼Œäº§ç”Ÿçš„é›†åˆæ•°æ®åº”è¯¥æ˜¯æ”¾åˆ°å†…å­˜ä¸­ã€‚å¦‚æœæ˜¯è¿™æ ·ä¼šä¸ä¼šæ‰“æš´å†…å­˜","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437920,"discussion_content":"1. æ˜¯çš„ï¼Œshow columns å…¶å®ä¸æ˜¯ä¸€ä¸ªå¥½æ“ä½œğŸ˜„\n2. è¿™ä¸ªæ²¡è§è¿‡ï¼Œä¹Ÿæ²¡å°è±¡åœ¨ç¤¾åŒºä¸­ç¢°åˆ°è¿™ç§ç°è±¡ï¼Œé™æˆ5.6å°±å¥½äº†æ˜¯å—ï¼Ÿ\n3. ä¸ä¼šçš„ï¼Œ34ã€35ä¸¤ç¯‡å°±æ˜¯è¯´è¿™ä¸ªé—®é¢˜çš„å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548940886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64033,"user_name":"Zzz","can_delete":false,"product_type":"c1","uid":1116272,"ip_address":"","ucode":"4AA47797F48315","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIu1n1DhUGGKTjelrQaLYOSVK2rsFeia0G8ASTIftib5PTOx4pTqdnfwb0NiaEFGRgS661nINyZx9sUg/132","comment_is_top":false,"comment_ctime":1548644796,"is_pvip":false,"replies":[{"id":"22657","content":"ğŸ‘<br><br>è¢«ä½ ä¸€è¯´æˆ‘èµ¶ç´§å†å»ç¿»äº†ä¸‹ä»£ç ï¼Œå—¯å—¯ï¼ŒInnoDBç¡®å®æ˜¯æœ€è¿‘è®¿é—®çš„å«åšyoung ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548663288,"ip_address":"","comment_id":64033,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14433546684","product_id":100020801,"comment_content":"æ”¹è¿›åçš„ LRU ç®—æ³•çš„æ€è·¯æœ‰ç‚¹åƒJVM GCé‡Œé¢åˆ†ä»£å›æ”¶çš„æ€æƒ³ï¼ŒæŠŠæ•°æ®åˆ†æˆæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œä¸€ä¸ªç”¨äºå­˜å‚¨çŸ­æ—¶é—´å†…å°±ä¼šè¢«æ¸…ç†çš„å¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºå­˜å‚¨å­˜æ´»æ—¶é—´é•¿çš„å¯¹è±¡ã€‚ä¸è¿‡æœ‰è¶£çš„æ˜¯å¯¹äºä¸¤ç§åŒºåŸŸçš„å«æ³•ï¼Œåˆšå¥½ç›¸åï¼šJVMé‡Œé¢æŠŠçŸ­æ—¶é—´å†…è¢«æ¸…é™¤çš„åŒºåŸŸå«åšâ€youngâ€œï¼ŒInnoDBé‡Œé¢å´æ˜¯å«åšâ€old&quot;ã€‚","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437821,"discussion_content":"ğŸ‘\n\nè¢«ä½ ä¸€è¯´æˆ‘èµ¶ç´§å†å»ç¿»äº†ä¸‹ä»£ç ï¼Œå—¯å—¯ï¼ŒInnoDBç¡®å®æ˜¯æœ€è¿‘è®¿é—®çš„å«åšyoung ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548663288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242976,"user_name":"æ—è‚¯","can_delete":false,"product_type":"c1","uid":1008582,"ip_address":"","ucode":"D2C97220230DE5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/c6/d6ea3df3.jpg","comment_is_top":false,"comment_ctime":1597910032,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10187844624","product_id":100020801,"comment_content":"æ”¹è‰¯åçš„LRUç®—æ³•å’ŒJVMçš„åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œå¾ˆå¤šç®—æ³•éƒ½æ˜¯ç›¸é€šçš„å•Š","like_count":2},{"had_liked":false,"id":64352,"user_name":"ç‰§é±¼","can_delete":false,"product_type":"c1","uid":1360250,"ip_address":"","ucode":"0EB8FDD7A4BB2E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erFY9H3mxyTpZ9gxAmdeKic565hicicDZmv7cjswd8hdernmxib0chdQrlDNKUZQ8AticQCgDdgVEmJNuA/132","comment_is_top":false,"comment_ctime":1548751278,"is_pvip":false,"replies":[{"id":"22783","content":"çœ‹ä¸€ä¸‹20å’Œ21ç¯‡å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548752503,"ip_address":"","comment_id":64352,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10138685870","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œå’¨è¯¢ä¸€ä¸ªäºä¹‹å‰æ–‡ç« æœ‰å…³çš„é—®é¢˜ï¼Œåœ¨rréš”ç¦»çº§åˆ«ä¸‹ä¼šäº§ç”Ÿå¹»è¯»ï¼Œç„¶è€Œè¿™ä¸ªå¹»è¯»mysqlæ˜¯é€šè¿‡ä»€ä¹ˆæœºåˆ¶æ¥è§£å†³çš„å‘¢ï¼Ÿæœ‰çš„è¯´æ˜¯mvccï¼Œæœ‰çš„è¯´æ˜¯next-keyé”ã€‚æœ‰ç‚¹ç–‘æƒ‘äº†ã€‚å¦å¤–ï¼Œæ€ä¹ˆèƒ½å¤ŸéªŒè¯mysqlä½¿ç”¨å…·ä½“çš„å“ªç§æŠ€æœ¯è§£å†³äº†å¹»è¯»ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437969,"discussion_content":"çœ‹ä¸€ä¸‹20å’Œ21ç¯‡å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548752503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1466840,"avatar":"https://static001.geekbang.org/account/avatar/00/16/61/d8/3bc19bff.jpg","nickname":"æ‹åœ¨é‚£æ—¶","note":"","ucode":"7F026B4B708C7D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555657,"discussion_content":"innodbé€šè¿‡å¼•å…¥é—´éš™é”æ¥è§£å†³äº†å¹»è¯»é—®é¢˜ï¼Œåœ¨rrçº§åˆ«ä¸‹ï¼Œåªæœ‰å½“å‰è¯»æ‰ä¼šå‘ç”Ÿå¹»è¯»ç°è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647008266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64296,"user_name":"å¤©ä½¿æ¢¦æ³ª","can_delete":false,"product_type":"c1","uid":1235750,"ip_address":"","ucode":"782991747DD424","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/26/3c8d68fb.jpg","comment_is_top":false,"comment_ctime":1548736720,"is_pvip":false,"replies":[{"id":"22773","content":"InnoDB çš„æ˜¯buffer poolï¼Œæ˜¯åœ¨å†…å­˜é‡Œã€‚<br><br>â€å†…å­˜é‡å¯äº†ä¹‹åï¼Œç¼“å­˜ä¸å°±ä¹Ÿä¸¢å¤±äº†ï¼Œæ˜¯æ€ä¹ˆåšåˆ°æŒä¹…åŒ–ä¿å­˜çš„ï¼Œè€å¸ˆå¯ä»¥å¸®å¿™è¯¦ç»†è§£ç­”ä¸‹ä¹ˆï¼Ÿâ€œ<br>æ²¡æœ‰ä¿å­˜ï¼Œé‡å¯å°±æ²¡æœ‰äº†ï¼Œè¦è®¿é—®çš„æ—¶å€™éœ€è¦é‡æ–°å»ç£ç›˜è¯»","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548740885,"ip_address":"","comment_id":64296,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10138671312","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œé’ˆå¯¹æˆ‘ä¸Šæ¬¡é—®æ‚¨çš„mysqlç¼“å­˜ä¸­çš„æ•°æ®å‚¨å­˜é—®é¢˜ï¼Œæ‚¨å›ç­”å¯ä»¥ä¸€ç›´ä¿å­˜çš„ï¼Œå…·ä½“æ˜¯æ€ä¹ˆå®ç°ä¸€ç›´ä¿å­˜çš„ï¼ˆä¹Ÿä¸æ˜¯å‚¨å­˜åœ¨ç£ç›˜ä¸Šï¼Œæ˜¯ä½¿ç”¨çš„å†…å­˜ï¼‰ï¼Ÿå†…å­˜é‡å¯äº†ä¹‹åï¼Œç¼“å­˜ä¸å°±ä¹Ÿä¸¢å¤±äº†ï¼Œæ˜¯æ€ä¹ˆåšåˆ°æŒä¹…åŒ–ä¿å­˜çš„ï¼Œè€å¸ˆå¯ä»¥å¸®å¿™è¯¦ç»†è§£ç­”ä¸‹ä¹ˆï¼Ÿ<br>","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437948,"discussion_content":"InnoDB çš„æ˜¯buffer poolï¼Œæ˜¯åœ¨å†…å­˜é‡Œã€‚\n\nâ€å†…å­˜é‡å¯äº†ä¹‹åï¼Œç¼“å­˜ä¸å°±ä¹Ÿä¸¢å¤±äº†ï¼Œæ˜¯æ€ä¹ˆåšåˆ°æŒä¹…åŒ–ä¿å­˜çš„ï¼Œè€å¸ˆå¯ä»¥å¸®å¿™è¯¦ç»†è§£ç­”ä¸‹ä¹ˆï¼Ÿâ€œ\næ²¡æœ‰ä¿å­˜ï¼Œé‡å¯å°±æ²¡æœ‰äº†ï¼Œè¦è®¿é—®çš„æ—¶å€™éœ€è¦é‡æ–°å»ç£ç›˜è¯»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548740885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64259,"user_name":"æœ‰é“­","can_delete":false,"product_type":"c1","uid":1046302,"ip_address":"","ucode":"2C7CB36CA5C04C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","comment_is_top":false,"comment_ctime":1548727786,"is_pvip":false,"replies":[{"id":"22759","content":"çœ‹ä¸€ä¸‹ https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;73479 è¿™ç¯‡æ–‡ç« çš„å›¾5å“ˆ<br>æœ‰è¯´åˆ°å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548731904,"ip_address":"","comment_id":64259,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10138662378","product_id":100020801,"comment_content":"æ„Ÿè§‰mysqlçš„åšæ³•æœ‰ç‚¹æµå¼è¯»å–çš„æ„æ€ã€‚<br>ä½†æ˜¯ï¼Œè€å¸ˆï¼Œè™½ç„¶è¿™ç¯‡æ–‡ç« è®²è¿°äº†Mysqlæ˜¯å¦‚ä½•â€œè¾¹è¯»è¾¹å‘â€ã€‚ä½†æ˜¯æ›´å¤æ‚çš„æƒ…å†µæ²¡æœ‰è¯´æ˜ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨è¦æ‰§è¡Œä¸€ä¸ªå¤æ‚çš„æŸ¥è¯¢ï¼Œè€Œä¸”æŸ¥è¯¢æ˜¯æ’åºçš„ï¼Œè¿™æ„å‘³ç€mysqléœ€è¦å¯¹æ•´ä¸ªç»“æ„æ’åºï¼Œç„¶åæ‰èƒ½ä¸€æ¡æ¡çš„å‘å‡ºå»ï¼Œå¦‚æœæ•°æ®é‡æå¤§çš„æƒ…å†µï¼ŒMysqlå¦‚ä½•å®Œæˆæ’åºè¿‡ç¨‹ï¼Œéœ€è¦æŠŠæ•°æ®å…¨éƒ¨è½½å…¥å†…å­˜å—ï¼Ÿè¿˜æ˜¯å­˜å‚¨åœ¨ç¼“å­˜æ–‡ä»¶é‡Œæåˆ†è€Œæ²»ä¹‹çš„æ’åºï¼Œç„¶åå†â€œè¾¹è¯»è¾¹å‘â€","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437926,"discussion_content":"çœ‹ä¸€ä¸‹ https://time.geekbang.org/column/article/73479 è¿™ç¯‡æ–‡ç« çš„å›¾5å“ˆ\næœ‰è¯´åˆ°å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548731904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64045,"user_name":"garming","can_delete":false,"product_type":"c1","uid":1023526,"ip_address":"","ucode":"529F405DD13F43","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9e/26/7aede07e.jpg","comment_is_top":false,"comment_ctime":1548646564,"is_pvip":false,"replies":[{"id":"22651","content":"ä¹Ÿæ˜¯ä¸ä¼šçš„ï¼Œè·ŸInnoDBä¸€æ ·","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548655547,"ip_address":"","comment_id":64045,"utype":1}],"discussion_count":1,"race_medal":1,"score":"10138581156","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¦‚æœæ˜¯MyISAMå­˜å‚¨å¼•æ“ï¼Œå¤§æŸ¥è¯¢ä¼šå¯¼è‡´å†…å­˜æš´æ¶¨å—ï¼Ÿå¦‚æœè¿‡ï¼Œæ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437829,"discussion_content":"ä¹Ÿæ˜¯ä¸ä¼šçš„ï¼Œè·ŸInnoDBä¸€æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548655547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64043,"user_name":"æœå˜‰å˜‰","can_delete":false,"product_type":"c1","uid":1306430,"ip_address":"","ucode":"C23DE27E7886BD","user_header":"https://static001.geekbang.org/account/avatar/00/13/ef/3e/9c3a8abc.jpg","comment_is_top":false,"comment_ctime":1548646344,"is_pvip":false,"replies":[{"id":"22653","content":"ä¸ä¼šä¸“é—¨è®²ä¸€ä¸ªå·¥å…·å“ˆï¼Œ<br>å¯ä»¥è¯´ä¸‹ä½ ç¢°åˆ°çš„é—®é¢˜ï¼Œç„¶åæˆ‘åœ¨ç­”ç–‘æ–‡ç« ä¸­å±•å¼€ï¼Œè¿™æ ·æ¯”è¾ƒå¥½å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548655661,"ip_address":"","comment_id":64043,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10138580936","product_id":100020801,"comment_content":"æ”¶è·å¾ˆå¤§ï¼Œè€å¸ˆçš„è¯¾ç¨‹ä¸€ç›´å¾ˆç”¨å¿ƒã€‚æƒ³é—®ä¸‹åç»­ä¼šä¸ä¼šå•ç‹¬è®²å¤‡ä»½æ¢å¤ç« èŠ‚ï¼Œæ¯”å¦‚xtrabackupè¿™ç§","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437827,"discussion_content":"ä¸ä¼šä¸“é—¨è®²ä¸€ä¸ªå·¥å…·å“ˆï¼Œ\nå¯ä»¥è¯´ä¸‹ä½ ç¢°åˆ°çš„é—®é¢˜ï¼Œç„¶åæˆ‘åœ¨ç­”ç–‘æ–‡ç« ä¸­å±•å¼€ï¼Œè¿™æ ·æ¯”è¾ƒå¥½å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548655661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246548,"user_name":"Anthony","can_delete":false,"product_type":"c1","uid":1309908,"ip_address":"","ucode":"9E0C98A9123365","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/d4/743d3f02.jpg","comment_is_top":false,"comment_ctime":1599398977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5894366273","product_id":100020801,"comment_content":"<br>è€å¸ˆï¼Œå¦‚æœä½¿ç”¨äº†change buffer,é‚£æ›´æ–°ä¸€æ¡éä¸»é”®ç´¢å¼•æ•°æ®ï¼Œæ•°æ®å†™å…¥äº†change buffer,æ˜¯å¦ä¼šå°†è¿™æ¡æ›´æ–°å†™å…¥åˆ°binlogä¸­å‘¢ï¼Ÿå¦‚æœæ˜¯æ›´æ–°äº†binlog, binlogæ˜¯ä½¿ç”¨äº†rowæ ¼å¼ï¼Œéœ€è¦çŸ¥é“å½“å‰è¿™æ¡æ•°æ®çš„å€¼ï¼Œè€Œè¿™æ¡å€¼åˆä¸åœ¨å†…å­˜ä¸­ï¼Œåªèƒ½è¯»ç£ç›˜ï¼›å¦‚æœæ˜¯ä¸æ›´æ–°ï¼Œä¸»ä»åˆæ€ä¹ˆåšåˆ°åŒæ­¥å‘¢ï¼Ÿç›¼å¤ï¼","like_count":1},{"had_liked":false,"id":237834,"user_name":"æé£","can_delete":false,"product_type":"c1","uid":1555180,"ip_address":"","ucode":"930458850AA05B","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/ec/2b1c6afc.jpg","comment_is_top":false,"comment_ctime":1595984527,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5890951823","product_id":100020801,"comment_content":"ä½œä¸ºä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œæ„Ÿè§‰æ¯èŠ‚è¯¾éƒ½å€¼å¾—äºŒåˆ·","like_count":1,"discussions":[{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297148,"discussion_content":"æ˜¯çš„ï¼Œæˆ‘ç°åœ¨æ‰ä¸€åˆ·ï¼Œæ„Ÿè§‰å¾ˆå¤šç†è§£ä¸é€ï¼Œå¿…é¡»è¦äºŒåˆ·é‡æ¸©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596787691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102928,"user_name":"Jzzw","can_delete":false,"product_type":"c1","uid":1508208,"ip_address":"","ucode":"4B642AADF48BD6","user_header":"https://static001.geekbang.org/account/avatar/00/17/03/70/01dc4853.jpg","comment_is_top":false,"comment_ctime":1560330008,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5855297304","product_id":100020801,"comment_content":"è€å¸ˆï¼Œçœ‹å®˜æ–¹æ–‡æ¡£ä¸Šè¯´ï¼Œnet_bufferå¦‚æœå†™å…¥æ•°æ®é‡è¾¾åˆ°net_buffer_lengthçš„è¯ï¼Œå…¶å¤§å°ä¼šç»§ç»­æ‰©å¤§åˆ°max_allowed_packetï¼Œsqlæ‰§è¡Œç»“æŸåå†æ”¶ç¼©åˆ°net_buffer_lengthçš„å¤§å°","like_count":1,"discussions":[{"author":{"id":1368901,"avatar":"","nickname":"miu","note":"","ucode":"3D73FF3C09231A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":135102,"discussion_content":"ä¹Ÿå¾ˆç–‘æƒ‘ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­net_buffer_lengthçš„å€¼æœ€å¤§åªèƒ½è®¾ç½®åˆ°1Mï¼Œå¦‚ä½•èƒ½å¤Ÿè®¾ç½®åˆ°10Mï¼Œå¹¶ä¸”max_allowed_packetçš„å€¼æœ€å¤§1G","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579068290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69064,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":false,"comment_ctime":1550654907,"is_pvip":false,"replies":[{"id":"24493","content":"æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸èƒ½ç”¨mysql_reset_connection æ¥é‡Šæ”¾å†…å­˜ï¼Œéƒ½è¿˜æ²¡æ‰§è¡Œå®Œæˆå‘¢ã€‚<br><br>æ˜¯cçš„apiï¼Œhttps:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;5.7&#47;en&#47;c-api-functions.html","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550659635,"ip_address":"","comment_id":69064,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5845622203","product_id":100020801,"comment_content":"è€å¸ˆï¼Œé‚£è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä½ ä»‹ç»çš„å‡½æ•° mysql_reset_connection æ¥é‡Šæ”¾è¿æ¥çš„å†…å­˜å—ï¼Ÿè¿™ä¸ªå‡½æ•°æ˜¯æ€ä¹ˆä½¿ç”¨çš„ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439940,"discussion_content":"æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸èƒ½ç”¨mysql_reset_connection æ¥é‡Šæ”¾å†…å­˜ï¼Œéƒ½è¿˜æ²¡æ‰§è¡Œå®Œæˆå‘¢ã€‚\n\næ˜¯cçš„apiï¼Œhttps://dev.mysql.com/doc/refman/5.7/en/c-api-functions.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550659635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66876,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":false,"comment_ctime":1550033738,"is_pvip":false,"replies":[{"id":"23990","content":"å…¶ä»–å†…å­˜ä¸€èˆ¬æ˜¯ä½¿ç”¨çš„æ—¶å€™æ‰ç”³è¯·ï¼Œä¸ç”¨å°±é”€æ¯äº†<br><br>ä½ è¿™ä¸ªå®ä¾‹çš„çŠ¶æ€ä¸å¤ªåˆç†ï¼Œä½ è´´ä¸€ä¸‹è¿™ä¸ªè¿›ç¨‹çš„top ç»“æœçœ‹ä¸‹ï¼Ÿè¿˜æœ‰è¿™å‡ ä¸ªå†…å­˜å‚æ•°çš„é…ç½®ã€‚<br>250ä¸ªçº¿ç¨‹27Gæ˜¯å¤ªå¤šäº†~","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550297303,"ip_address":"","comment_id":66876,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5845001034","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚è¯·æ•™ MySQL ä½¿ç”¨çš„å†…å­˜æ˜¯ä¸€å¼€å§‹å°±æ ¹æ®å‚æ•°è®¾ç½®ç›´æ¥åˆ†é…å¥½ï¼Œè¿˜æ˜¯åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æ ¹æ®å®é™…æƒ…å†µç”¨å¤šå°‘åˆ†é…å¤šå°‘çš„ï¼Ÿ<br><br>ä¸‹é¢çš„åˆ†ç±»å¯¹å—ï¼Ÿè¿˜æœ‰æ²¡æœ‰è¡¥å……çš„ï¼Ÿ<br>å…±äº«å†…å­˜ï¼ˆç±»ä¼¼äºOracle çš„ SGAï¼‰<br>key_buffer_sizeã€query_cache_sizeã€innodb_buffer_pool_sizeã€innodb_log_buffer_size<br><br>çº¿ç¨‹å†…å­˜ï¼ˆç±»ä¼¼äºOracleçš„ PGAï¼‰<br>binlog_cache_sizeã€join_buffer_sizeã€read_buffer_sizeã€read_rnd_buffer_sizeã€sort_buffer_sizeã€tmp_table_sizeã€thread_stackã€net_buffer_lengthã€max_allowed_packet<br><br>ç›®å‰çº¿ä¸Šç¯å¢ƒé‡åˆ°è¿™ä¹ˆä¸ªæƒ…å†µï¼Œæœºå™¨æ€»å†…å­˜125GBï¼Œåˆ†ç»™ innodb_buffer_pool_size 84GBï¼Œè¿æ¥æ•°å¤§æ¦‚250ä¸ªã€‚ä» top å‘½ä»¤æ¥çœ‹ï¼Œmysqld ç”¨äº† 111.9GBã€‚å…¶ä»–27.9GBæ˜¯ç»™çº¿ç¨‹å†…å­˜å ç”¨äº†ï¼Ÿ<br>","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438954,"discussion_content":"å…¶ä»–å†…å­˜ä¸€èˆ¬æ˜¯ä½¿ç”¨çš„æ—¶å€™æ‰ç”³è¯·ï¼Œä¸ç”¨å°±é”€æ¯äº†\n\nä½ è¿™ä¸ªå®ä¾‹çš„çŠ¶æ€ä¸å¤ªåˆç†ï¼Œä½ è´´ä¸€ä¸‹è¿™ä¸ªè¿›ç¨‹çš„top ç»“æœçœ‹ä¸‹ï¼Ÿè¿˜æœ‰è¿™å‡ ä¸ªå†…å­˜å‚æ•°çš„é…ç½®ã€‚\n250ä¸ªçº¿ç¨‹27Gæ˜¯å¤ªå¤šäº†~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550297303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65012,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":false,"comment_ctime":1549001066,"is_pvip":false,"replies":[{"id":"23042","content":"å¥½é—®é¢˜ğŸ‘ï¼Œç¬¬40ç¯‡ä¼šè¯´è¿™ä¸ªé—®é¢˜å“ˆï¼Œæ–°å¹´å¿«ä¹","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549008615,"ip_address":"","comment_id":65012,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5843968362","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>æˆ‘çœ‹åˆ°è¯„è®ºçš„é—®é¢˜ï¼Œæœ‰ä¸ªç–‘æƒ‘ï¼š<br>â€œ<br>ä¹‹å‰æœ‰ç‰¹æ®ŠåŠŸèƒ½éœ€è¦ä»ä¸»è¦ä¸šåŠ¡åº“æ‹‰å–æŒ‡å®šèŒƒå›´çš„æ•°æ®åˆ°å¦å¤–åŒä¸€ä¸ªåº“çš„å…¶ä»–æ•°æ®è¡¨çš„åŠ¨ä½œï¼ˆinsert into xxxxx select xxx from xxx è¿™ç§æ“ä½œï¼‰æ•°æ®é‡åœ¨ä¸‡çº§æˆ–è€…åä¸‡çº§ï¼Œå¯¹äºè¿™ç§æ“ä½œï¼Œå’Œæœ¬æ–‡è®²çš„åº”è¯¥æœ‰äº›ä¸åŒå§ï¼Ÿèƒ½å¦å¸®åˆ†æä¸€ä¸‹è¿™ç§åœºæ™¯çš„å¤§è‡´æƒ…å†µå‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆå¥½çš„å»ºè®®å—ï¼Ÿ<br><br>ä½œè€…å›å¤: å—¯ï¼Œè¿™ä¸ªä¸ä¼šè¿”å›ç»“æœåˆ°å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ç½‘ç»œä¸Šä¸ä¼šæœ‰é—®é¢˜<br><br>å¼•æ“å†…éƒ¨çš„æ‰«ææœºåˆ¶æ˜¯å·®ä¸å¤šçš„<br><br>å”¯ä¸€ä¸åŒæ˜¯è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¯¹åŸè¡¨æœ‰è¡Œé”ï¼ˆå¦‚æœè®¾ç½®çš„æ˜¯RRï¼‰<br><br>ä¸‡æˆ–è€…åä¸‡è¿˜å¥½ï¼Œæ˜¯å°æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘æ‹¿åˆ°å®¢æˆ·ç«¯å†å†™å›å»ï¼Œé¿å…é”çš„é—®é¢˜<br>â€<br><br>å…ˆæŠŠæ•°æ®æ‹¿å›å®¢æˆ·ç«¯ï¼Œå†insertåˆ°å¦ä¸€ä¸ªåº“ã€‚æ˜¯ä¸ºäº†é¿å…é”çš„é—®é¢˜ã€‚<br>è¿™é‡Œä»åŸåº“æ‹‰å–æ•°æ®å°±æ˜¯selectè¯­å¥ï¼Œæ²¡æœ‰æ¶‰åŠåˆ°next-keyé”å‘€ï¼Œä¸ºå•¥ä¼šæœ‰é”çš„é—®é¢˜å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438273,"discussion_content":"å¥½é—®é¢˜ğŸ‘ï¼Œç¬¬40ç¯‡ä¼šè¯´è¿™ä¸ªé—®é¢˜å“ˆï¼Œæ–°å¹´å¿«ä¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549008615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64031,"user_name":"åº“æ·˜æ·˜","can_delete":false,"product_type":"c1","uid":1310240,"ip_address":"","ucode":"90813B0C46E978","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqibSwKPg7hiapc49qoM4dibhM3fYANPjfltF2ibBZ3dHX2hibjg5EIIcziahrmjO5R2XrcRibvU39TQS7jg/132","comment_is_top":false,"comment_ctime":1548644349,"is_pvip":false,"replies":[{"id":"22658","content":"æœåŠ¡ç«¯æ²¡é—®é¢˜ï¼Œè¿™ä¸ªè¿˜ç®—æ˜¯å¥½æ¶ˆæ¯å§ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548663341,"ip_address":"","comment_id":64031,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5843611645","product_id":100020801,"comment_content":"é‚£å®¢æˆ·ç«¯ä¸ç”¨-q ä½¿ç”¨mysql_store_result è¿™æ ·çš„è¯æŸ¥è¯¢20Gæ•°æ®,æ˜¯ä¸æ˜¯å°±å¯¼è‡´å®¢æˆ·ç«¯å†…å­˜æº¢å‡º,è€ŒæœåŠ¡å™¨ç«¯æ²¡é—®é¢˜ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437820,"discussion_content":"æœåŠ¡ç«¯æ²¡é—®é¢˜ï¼Œè¿™ä¸ªè¿˜ç®—æ˜¯å¥½æ¶ˆæ¯å§ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548663341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63982,"user_name":"æŸšå­","can_delete":false,"product_type":"c1","uid":1002136,"ip_address":"","ucode":"7641A699DA0CFD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/NhbRicjvf8v3K6D3v1FtOicxOciaPZQsCjCmuGCqea4vJeRVaLicKLpAcFQlcTgLvczBWY7SYDkeOtibxXj1PGl7Nug/132","comment_is_top":false,"comment_ctime":1548636880,"is_pvip":true,"replies":[{"id":"22643","content":"å—¯ï¼Œä½ è¿™ä¸ªè¯´çš„æ˜¯ç«¯è¿æ¥é—®é¢˜<br><br>è·Ÿæˆ‘ä»¬è¿™ç¯‡æ–‡ç« è¯´çš„é—®é¢˜ä¸æ˜¯åŒä¸€ä¸ªï¼Œä¸è¿‡ä¹Ÿç¡®å®æ˜¯æŒºå¸¸è§çš„ï¼Œå®¢æˆ·ç«¯æ²¡è®¾è®¡å¥½å¯¼è‡´çš„æœåŠ¡ç«¯é—®é¢˜ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548643828,"ip_address":"","comment_id":63982,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5843604176","product_id":100020801,"comment_content":"å›ç­”é—®é¢˜ï¼Œå¾ˆlowçš„ä¸€ç§æƒ…å†µï¼Œå®¢æˆ·ç«¯è¿æ¥æ²¡æœ‰ä½¿ç”¨å•ä¾‹ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šé‡æ–°å»ºç«‹è¿æ¥ã€‚","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437793,"discussion_content":"å—¯ï¼Œä½ è¿™ä¸ªè¯´çš„æ˜¯ç«¯è¿æ¥é—®é¢˜\n\nè·Ÿæˆ‘ä»¬è¿™ç¯‡æ–‡ç« è¯´çš„é—®é¢˜ä¸æ˜¯åŒä¸€ä¸ªï¼Œä¸è¿‡ä¹Ÿç¡®å®æ˜¯æŒºå¸¸è§çš„ï¼Œå®¢æˆ·ç«¯æ²¡è®¾è®¡å¥½å¯¼è‡´çš„æœåŠ¡ç«¯é—®é¢˜ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548643828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":178543,"discussion_content":"ç³»ç»Ÿç¨‹åºå±‚é¢ï¼Œä½¿ç”¨è¿æ¥æ± ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582172570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344666,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1651717028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651717028","product_id":100020801,"comment_content":"MySQL8æ²¡æœ‰å›¾3å’Œå›¾4çš„é—®é¢˜","like_count":0},{"had_liked":false,"id":342307,"user_name":"å®æ¬¡å›","can_delete":false,"product_type":"c1","uid":1475979,"ip_address":"","ucode":"F1DD0B189C5856","user_header":"https://static001.geekbang.org/account/avatar/00/16/85/8b/dd7ecd53.jpg","comment_is_top":false,"comment_ctime":1650183602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650183602","product_id":100020801,"comment_content":"åšå¤§æŸ¥è¯¢æ—¶ï¼Œç”±äºnet_buffer_lengthé™åˆ¶äº†æ•°æ®å‘é€çš„å¤§å°ï¼ˆæœåŠ¡ç«¯å‘ç»™å®¢æˆ·ç«¯ï¼‰ï¼Œå½“å®¢æˆ·ç«¯æœªæ¥å¾—åŠæ¥æ”¶æ•°æ®æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œæ‰€ä»¥å¤§æŸ¥è¯¢å ç”¨çš„å†…å­˜æ˜¯net_buffer_lengthå®é™…çš„å¤§å°ã€‚net_buffer_lengthæ˜¯æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªï¼Œå½“å¹¶å‘å¤§æŸ¥è¯¢æ—¶å¤šä¸ªçº¿ç¨‹çš„net_buffer_lengthåŒæ—¶å æœ‰å†…å­˜ï¼Œä»ä¼šå¯èƒ½å‡ºç°oomçš„æƒ…å†µå§ï¼Œè¿™æ ·ç†è§£æ­£ç¡®å—","like_count":1},{"had_liked":false,"id":327448,"user_name":"zhoubo_eric","can_delete":false,"product_type":"c1","uid":1584208,"ip_address":"","ucode":"34725AA3A9D59C","user_header":"https://static001.geekbang.org/account/avatar/00/18/2c/50/64365ef7.jpg","comment_is_top":false,"comment_ctime":1640138196,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640138196","product_id":100020801,"comment_content":"æç‚¼ä¸‹<br><br>mysql client è¯»å–æœ¬åœ°socket receive bufferâ€”ã€‹mysql server socket send buffer-ã€‰ mysql net_buffer_length<br> <br><br> mysql_store_resultæ¥å£å¯ç”¨äºæ•°æ®ç»“æœè¿”å›ä¸å¤šçš„ å› ä¸ºå­˜å‚¨åˆ°æœ¬åœ°åŠ é€Ÿäº†è¯»å–<br><br>mysql_use_resultæ˜¯è¾¹è¯»è¾¹å‘è¾¹æ¸…ç† æ‰€ä»¥ç”¨äºæ•°æ®é‡è¿”å›æ¯”è¾ƒå¤šçš„åˆé€‚ <br><br><br>innodbçš„lruæ·˜æ±°æœºåˆ¶æ˜¯é€šè¿‡åŒºåˆ† youngå’Œoldçš„åŒºåŸŸï¼Œæœ€è¿‘è¢«è®¿é—®çš„æ”¾åˆ°youngåŒºçš„head rangeï¼Œç©ºé—´ä¸å¤Ÿä»tailä¾§æ·˜æ±°.ä¸ºäº†é¿å…å…¨è¡¨æ‰«ææŠŠæ‰€æœ‰headçš„ç©ºé—´å æ»¡é€ æˆå‘½ä¸­ç‡é™ä½ï¼Œè®¾ç½®äº†ä¸€ä¸ªé€»è¾‘ å°±æ˜¯å¯¹äºç¬¬ä¸€æ¬¡éœ€è¦æ¬¡ç£ç›˜è¯»çš„pageéƒ½xæ”¾åˆ°oldåŒºåŸŸï¼Œæ¥ä¸‹æ¥å†æ¬¡éœ€è¦è¯»å–è¯¥pageçš„è¯å¦‚æœ pageé¡µé¢ä¸¤æ¬¡è¯»å–é—´éš”è¶…è¿‡1sä¸­é‚£ä¹ˆæ”¾åˆ°headåŒºåŸŸï¼ˆè¯´æ˜æ•°æ®è¿˜æœ‰å†æ¬¡è®¿é—®çš„éœ€è¦ï¼Œéœ€è¦é¢‘ç¹è¯»å–ï¼‰å‰©ä¸‹é‚£äº›page å› ä¸ºåªåšäº†ä¸€æ¬¡ç£ç›˜è¯»ï¼Œéƒ½æ²¡æœ‰æœºä¼šå†æ¬¡è¢«å†…å­˜è¯»çš„æœºä¼š è‡ªç„¶ä¼šæ ¹æ®éšç€ä¸Šé¢çš„æ·˜æ±°æœºåˆ¶é€æ¸ç§»åˆ°tailåŒºåŸŸ æœ€ç»ˆè¢«æ·˜æ±°æ‰","like_count":0},{"had_liked":false,"id":317359,"user_name":"ç‰¹ç«‹ç‹¬è¡Œçš„çŒª","can_delete":false,"product_type":"c1","uid":1465344,"ip_address":"","ucode":"1440F96375740A","user_header":"https://static001.geekbang.org/account/avatar/00/16/5c/00/5d11e68d.jpg","comment_is_top":false,"comment_ctime":1634770137,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634770137","product_id":100020801,"comment_content":"æ–‡ä¸­æåˆ°â€œç”±äºæœ‰ WAL æœºåˆ¶ï¼Œå½“äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œç£ç›˜ä¸Šçš„æ•°æ®é¡µæ˜¯æ—§çš„ï¼Œé‚£å¦‚æœè¿™æ—¶å€™é©¬ä¸Šæœ‰ä¸€ä¸ªæŸ¥è¯¢è¦æ¥è¯»è¿™ä¸ªæ•°æ®é¡µï¼Œæ˜¯ä¸æ˜¯è¦é©¬ä¸ŠæŠŠ redo log åº”ç”¨åˆ°æ•°æ®é¡µå‘¢ï¼Ÿâ€-ç­”æ¡ˆæ˜¯ä¸éœ€è¦ï¼Œç›´æ¥ä»å†…å­˜è¿”å›ã€‚æˆ‘çš„ç–‘é—®æ˜¯ï¼Œå¦‚æœè¿™ä¸ªäº‹åŠ¡æ˜¯updateæ“ä½œï¼Œè€Œupdateçš„è¿™å¼ æ•°æ®é¡µä¸å­˜åœ¨å†…å­˜ä¸­ï¼Œæ˜¯å…ˆè®°å½•åˆ°change  bufferä¸­ï¼Œå½“ä¸‹ä¸€ä¸ªäº‹åŠ¡æ¯”å¦‚selectå…¨è¡¨æ—¶ï¼Œéš¾é“ä¸ä¼šæŠŠç£ç›˜çš„æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œå»æ‰§è¡Œmergeæ“ä½œåï¼Œåœ¨è¿”å›ç»™å®¢æˆ·ç«¯å˜›ï¼Ÿï¼Ÿï¼Ÿ","like_count":0},{"had_liked":false,"id":316914,"user_name":"Geek_99ae14","can_delete":false,"product_type":"c1","uid":1909732,"ip_address":"","ucode":"268852986A6B69","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLY0FFoux40Negib6LrE7EwT3T2BUbpYzOzUeiaiaXBmNGDGVgIZr5NeWBTEeCuALOg3ODtWa21bHMgg/132","comment_is_top":false,"comment_ctime":1634610543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634610543","product_id":100020801,"comment_content":"æ¯æ¬¡é‡æ–°çœ‹ä¸€ééƒ½æ”¶è·æ»¡æ»¡","like_count":0},{"had_liked":false,"id":309071,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":1100387,"ip_address":"","ucode":"5B168A03809557","user_header":"https://static001.geekbang.org/account/avatar/00/10/ca/63/9be9ac89.jpg","comment_is_top":false,"comment_ctime":1629933183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629933183","product_id":100020801,"comment_content":"å‘ç°mysqlçš„LRUå’Œcaffeineçš„LRUå¾ˆç±»ä¼¼ï¼Œæœç„¶åŸç†éƒ½æ˜¯ç›¸é€šçš„","like_count":0},{"had_liked":false,"id":298674,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1624257874,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624257874","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä¸ºå•¥æ¯æ¬¡è®¿é—®å°‘äº1ç§’çš„ä½ç½®ä¸å˜ï¼Œæ¯æ¬¡è®¿é—®å°‘äºä¸€ç§’æ›´è¯´æ˜è¿™ä¸ªæ•°æ®é¡µä½¿ç”¨é¢‘ç¹å•Šï¼Œåº”è¯¥ç§»åŠ¨åˆ°youngåŒºæ‰å¯¹å•Šã€‚","like_count":0},{"had_liked":false,"id":294896,"user_name":"å¤§æ¼ ","can_delete":false,"product_type":"c1","uid":1124461,"ip_address":"","ucode":"B7973B9FD7CB61","user_header":"https://static001.geekbang.org/account/avatar/00/11/28/6d/d776d35a.jpg","comment_is_top":false,"comment_ctime":1622124942,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622124942","product_id":100020801,"comment_content":"InnoDB Buffer Pool çš„ LRU åˆ†åŒºç®—æ³•å¾ˆæœ‰å€Ÿé‰´æ„ä¹‰","like_count":0},{"had_liked":false,"id":292336,"user_name":"uking","can_delete":false,"product_type":"c1","uid":1522824,"ip_address":"","ucode":"41005AC547327B","user_header":"https://static001.geekbang.org/account/avatar/00/17/3c/88/e83528da.jpg","comment_is_top":false,"comment_ctime":1620785775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620785775","product_id":100020801,"comment_content":"net_bufferæŒ‰æ–‡ä¸­çš„æè¿°æ¥çœ‹ï¼Œæ„Ÿè§‰åƒæ˜¯å…¨å±€å…±äº«çš„ï¼Œé‚£å¦‚ä½•åŒºåˆ†ä¸åŒçš„æ•°æ®å‘ç»™ä¸åŒçš„å®¢æˆ·ç«¯å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":275957,"user_name":"æ«ä¸­æµªå­","can_delete":false,"product_type":"c1","uid":2351949,"ip_address":"","ucode":"860BEA32059B37","user_header":"https://static001.geekbang.org/account/avatar/00/23/e3/4d/8a26dbb2.jpg","comment_is_top":false,"comment_ctime":1611729866,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1611729866","product_id":100020801,"comment_content":"innodb_buffer_pool_sizeçš„å¤§å°å¥½åƒè·Ÿinnodb_buffer_pool_chunk_sizeå’Œinnodb_buffer_pool_instancesæœ‰å…³ï¼Œè€å¸ˆèƒ½ä¸èƒ½è®²ä¸‹åé¢ä¸¤ä¸ªã€‚","like_count":0},{"had_liked":false,"id":271674,"user_name":"Sun.YuLong","can_delete":false,"product_type":"c1","uid":1127696,"ip_address":"","ucode":"AFFC9072A41A26","user_header":"https://static001.geekbang.org/account/avatar/00/11/35/10/2a6e4cb5.jpg","comment_is_top":false,"comment_ctime":1609753299,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609753299","product_id":100020801,"comment_content":"â€œæ‰«æè¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ–°æ’å…¥çš„æ•°æ®é¡µï¼Œéƒ½è¢«æ”¾åˆ° old åŒºåŸŸ ;â€<br>è€å¸ˆï¼Œè¿™ç‚¹ä¸æ˜ç™½ï¼Œæ–°æ’å…¥çš„ä¸åº”è¯¥åœ¨youngä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":259742,"user_name":"hao","can_delete":false,"product_type":"c1","uid":1148845,"ip_address":"","ucode":"997F2B57E2F556","user_header":"https://static001.geekbang.org/account/avatar/00/11/87/ad/50a85a04.jpg","comment_is_top":false,"comment_ctime":1604823619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604823619","product_id":100020801,"comment_content":"å½“ä¸‹å¤§å¤šæ•°çš„ä¸šåŠ¡åœºæ™¯å±äºå¤šè¯»å†™å°‘ï¼Œé¿å…å…¨è¡¨æ‰«æè¦†ç›–æ‰ çœŸÂ·çƒ­ç‚¹æ•°æ®<br>mysql lruä¼˜åŒ–ç­–ç•¥ è®¿é—®yongåŒºæ—¶ç”¨ç»å…¸çš„lruç®—æ³•  è®¿é—®oldåŒºæ—¶å…ˆåˆ¤æ–­æ•°æ®å­˜æ´»æ—¶é—´å†æ™‹å‡åˆ°yongåŒº<br>redis lruä¼˜åŒ–ç­–ç•¥   åœ¨redisobjectå¯¹è±¡ä¸Š è®¾ç½®å­˜æ´»æ—¶é—´å’Œå¼•ç”¨æ¬¡æ•°ï¼ˆå¢åŠ ï¼Œè¡°é€€ï¼‰","like_count":0},{"had_liked":false,"id":254301,"user_name":"å’–å•¡","can_delete":false,"product_type":"c1","uid":1413645,"ip_address":"","ucode":"7A6AE43700CC8F","user_header":"https://static001.geekbang.org/account/avatar/00/15/92/0d/909f9aab.jpg","comment_is_top":false,"comment_ctime":1603098278,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603098278","product_id":100020801,"comment_content":"è¯·é—®ä¸‹è€å¸ˆï¼Œä¸ºä»€ä¹ˆå†…å­˜æ·˜æ±°æœºåˆ¶æ™®éä½¿ç”¨LRUå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":244128,"user_name":"å¬é£æ¥","can_delete":false,"product_type":"c1","uid":1422123,"ip_address":"","ucode":"DBB646BFA8BFA0","user_header":"","comment_is_top":false,"comment_ctime":1598407132,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598407132","product_id":100020801,"comment_content":"ä½¿ç”¨kettleï¼ŒæŸ¥è¯¢æœ¬åœ°æ•°æ®åº“æŸä¸ªè¡¨idï¼Œç”¨idå»å¦ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢æ•°æ®ï¼Œéšåå°†æŸ¥å‡ºæ•°æ®è½åˆ°æœ¬åœ°æ•°æ®åº“ã€‚æœ¬åœ°æ•°æ®åº“ä¸€ç›´æ˜¯sending to clientçŠ¶æ€ï¼Œæœ€åå¯¼è‡´wait timeoutï¼Œjvmæ»¡è´Ÿè½½ã€‚è¿™ä¸ªé—®é¢˜å‡ºç°åŸå› æˆ‘è€ƒè™‘åº”è¯¥ä¸»è¦åœ¨jvmï¼Œéšåå°†æ•°æ®åº“wait timeoutç”±300sè°ƒå¤§ã€‚è€å¸ˆè¿™ä¸ªå¤„ç†å¯å¦","like_count":0},{"had_liked":false,"id":243074,"user_name":"H","can_delete":false,"product_type":"c1","uid":1793962,"ip_address":"","ucode":"04D7D030245E27","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5f/aa/63e641c1.jpg","comment_is_top":false,"comment_ctime":1597939751,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597939751","product_id":100020801,"comment_content":"show engine innodb statusä¸€ç›´æ²¡æ‰¾åˆ°buffer_pool_hit_rate","like_count":0},{"had_liked":false,"id":238413,"user_name":"å«ç« ","can_delete":false,"product_type":"c1","uid":1434831,"ip_address":"","ucode":"A7CA116D5275C9","user_header":"https://static001.geekbang.org/account/avatar/00/15/e4/cf/906f47c9.jpg","comment_is_top":false,"comment_ctime":1596162548,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1596162548","product_id":100020801,"comment_content":"ç°åœ¨ï¼Œæ—è€å¸ˆè¿˜çœ‹å—ğŸ˜‚ï¼Ÿä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼  å†…å­˜å¤§å°8Gï¼Œbufferpoolè®¾ç½®20Gï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸å¯åŠ¨ã€‚è¿™ä¸ªå‚æ•°ä¼šè‡ªåŠ¨è°ƒèŠ‚å—ï¼Ÿé‚£å¦‚æœé»˜è®¤è®¾ç½®128Mï¼Œåˆä¼šæ€æ ·å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":233195,"user_name":"åŸå†›","can_delete":false,"product_type":"c1","uid":1016202,"ip_address":"","ucode":"003C988716FBCC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/81/8a/0b065758.jpg","comment_is_top":false,"comment_ctime":1594257689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594257689","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œä¹‹å‰æœ‰çœ‹è¿‡å¥½å¤šæ–‡ç« æè¿°ï¼Œè®¾ç½®innodb_buffer_pool_sizeä¹‹åï¼Œæœ€å¥½ä¹Ÿæ‰‹åŠ¨ä¿®æ”¹ä¸‹innobd_buffer_pool_instancesï¼Œæ¥å¢åŠ buffer poolçš„æ•°é‡ä»è€Œæå‡æ€§èƒ½ï¼Œé‚£instancesåˆ°åº•éœ€ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šæ•°é‡ï¼Ÿå¸Œæœ›è€å¸ˆèƒ½å¸®å¿™è§£ç­”ä¸‹ã€‚","like_count":0},{"had_liked":false,"id":232925,"user_name":"jugg","can_delete":false,"product_type":"c1","uid":1639286,"ip_address":"","ucode":"3CD779C93609CF","user_header":"https://static001.geekbang.org/account/avatar/00/19/03/76/55df3b09.jpg","comment_is_top":false,"comment_ctime":1594170316,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594170316","product_id":100020801,"comment_content":"mysql client server è¿æ¥ä¼¼ä¹æ˜¯æ²¡æœ‰ åº”ç”¨å±‚å¿ƒè·³ã€‚å¦‚æœä¸€ä¸ªæ…¢å®¢æˆ·ç«¯å®•æœºåï¼Œserver éœ€è¦8å°æ—¶æ‰èƒ½æ£€æµ‹åˆ°ï¼Ÿ","like_count":0},{"had_liked":false,"id":220212,"user_name":"å¼ é’Ÿå¼º","can_delete":false,"product_type":"c1","uid":1586908,"ip_address":"","ucode":"EE0D5CAEDBBAC8","user_header":"https://static001.geekbang.org/account/avatar/00/18/36/dc/97369381.jpg","comment_is_top":false,"comment_ctime":1590204716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590204716","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ã€‚<br>1. å¦‚æœæˆ‘åªæ˜¯selectéƒ¨åˆ†å­—æ®µï¼Œbuffer poolä¸­ç¼“å­˜çš„æ˜¯å®Œæ•´çš„æ•°æ®é¡µå—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œinnodbä¼šå¯¹çš„è¯»å–åˆ°çš„å®Œæ•´æ•°æ®è¿›è¡Œè¿‡æ»¤ç„¶åè¿”å›ç»™serverå±‚ï¼Ÿ<br>2. åƒselect count(1)è¿™ç§è¿˜ä¼šå°†æ•°æ®é¡µè¯»å…¥åˆ°ï¼Œbuffer poolä¸­ï¼Ÿ","like_count":0},{"had_liked":false,"id":205881,"user_name":"Kvicii.Y","can_delete":false,"product_type":"c1","uid":1442588,"ip_address":"","ucode":"446BFA633569EA","user_header":"https://static001.geekbang.org/account/avatar/00/16/03/1c/c9fe6738.jpg","comment_is_top":false,"comment_ctime":1586750398,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586750398","product_id":100020801,"comment_content":"å¦‚æœè¶…è¿‡äº†åœ¨3&#47;8å¤´éƒ¨çš„æ•°æ®é¡µå­˜åœ¨æ—¶é—´è¶…è¿‡äº†1sç§»åŠ¨åˆ°äº†å‰5&#47;8ï¼Œé‚£ä¹ˆ5&#47;8çš„å°¾éƒ¨æ˜¯æ€ä¹ˆæ·˜æ±°çš„ï¼Ÿé™çº§åˆ°3&#47;8ï¼Ÿè¿˜æ˜¯ç›´æ¥æ·˜æ±°æ‰ï¼Ÿ","like_count":0},{"had_liked":false,"id":199807,"user_name":"é£é›ªå¤œå½’äºº","can_delete":false,"product_type":"c1","uid":1583347,"ip_address":"","ucode":"40B4C6DB4351EB","user_header":"https://static001.geekbang.org/account/avatar/00/18/28/f3/103b5bec.jpg","comment_is_top":false,"comment_ctime":1585496218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585496218","product_id":100020801,"comment_content":"æ‰“å¡æ‰“å¡","like_count":0},{"had_liked":false,"id":179100,"user_name":"é™†ä¸•å±±","can_delete":false,"product_type":"c1","uid":1814215,"ip_address":"","ucode":"DC82F5CED5B7FF","user_header":"https://static001.geekbang.org/account/avatar/00/1b/ae/c7/47631b20.jpg","comment_is_top":false,"comment_ctime":1581914565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581914565","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæµ‹è¯•ç¯å¢ƒç™»å½•çš„æ—¶å€™æ€»æ˜¯å¾ˆæ…¢ï¼Œuatå’Œæ­£å¼ç¯å¢ƒæ²¡é—®é¢˜ã€‚çœ‹äº†show proocesslistä»¥åï¼Œå‘ç°æ˜¯æœ‰ä¸ªæŸ¥è¯¢è¯­å¥æ€»æ˜¯å¤„äºwarting to netçŠ¶æ€ï¼Œè€Œä¸”æ—¶é—´å¾ˆé•¿ã€‚ç”±äºæµ‹è¯•ç¯å¢ƒçš„æ•°æ®åº“é…ç½®å¾ˆåƒåœ¾ï¼Œæ‰€æœ‰çš„é¡¹ç›®ç”¨çš„éƒ½æ˜¯è¿™ä¸ªæœåŠ¡å™¨çš„æ•°æ®åº“ï¼Œæˆ‘çŒœåº”è¯¥æ˜¯ç½‘ç»œå ç”¨çš„åŸå› ã€‚è¯·é—®ä¸‹ï¼Œä¼šä¸ä¼šæ˜¯å…¶ä»–åŸå› æˆ–è¿˜æœ‰å…¶ä»–åŸå› å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":175355,"user_name":"åèç§‘æŠ€","can_delete":false,"product_type":"c1","uid":1808280,"ip_address":"","ucode":"B6BA3C47C05073","user_header":"","comment_is_top":false,"comment_ctime":1580689081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580689081","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ã€‚ <br>å…³äºé—®é¢˜â€œå¦‚æœä¸€ä¸ªäº‹åŠ¡è¢« kill ä¹‹åï¼ŒæŒç»­å¤„äºå›æ»šçŠ¶æ€ï¼Œä»æ¢å¤é€Ÿåº¦çš„è§’åº¦çœ‹ï¼Œä½ æ˜¯åº”è¯¥é‡å¯ç­‰å®ƒæ‰§è¡Œç»“æŸï¼Œè¿˜æ˜¯åº”è¯¥å¼ºè¡Œé‡å¯æ•´ä¸ª MySQL è¿›ç¨‹ã€‚â€<br>æ–¹æ¡ˆï¼šå…ˆåšä¸»å¤‡åˆ‡æ¢ï¼Œåˆ‡åˆ°æ–°ä¸»åº“æä¾›æœåŠ¡ã€‚ å¦‚æœä¸»åº“ä¸Šæœ‰äº‹åŠ¡å›æ»šæ²¡åšå®Œï¼š<br>1. å¯èƒ½åˆ‡ä¸è¿‡å»ï¼Œå› ä¸ºseconds behind master å¯èƒ½è¿‡å¤§ã€‚<br>2. å¼ºåˆ‡è¿‡å»åï¼Œä¸»åº“è¿˜æœ‰äº‹åŠ¡å›æ»šï¼Œä¼šå¯¼è‡´ä¸¤è¾¹æ•°æ®ä¸ä¸€è‡´ã€‚è¿™å…·ä½“æ˜¯æ€ä¹ˆæ“ä½œçš„ï¼Ÿè¯·è€å¸ˆæŒ‡æ•™ã€‚è°¢è°¢ï¼<br>","like_count":0},{"had_liked":false,"id":174368,"user_name":"Zhaoyang","can_delete":false,"product_type":"c1","uid":1037190,"ip_address":"","ucode":"131D83AC2566D2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d3/86/b5d72c87.jpg","comment_is_top":false,"comment_ctime":1580181909,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580181909","product_id":100020801,"comment_content":"æ˜ç™½äº†innodbçš„æœ€è¿‘æœ€å°‘ä½¿ç”¨ç­–ç•¥ï¼šå¹¶ä¸æ˜¯å…¨éƒ¨æ›¿æ¢ï¼Œè€Œæ˜¯5&#47;8çš„æ¯”ä¾‹æ‰æ›¿æ¢çš„ï¼Œè¿™æ ·çš„è¯ï¼Œèƒ½é¿å…æç«¯çš„æ•ˆç‡ä½çš„æƒ…å†µã€‚","like_count":0},{"had_liked":false,"id":169450,"user_name":"Apologize","can_delete":false,"product_type":"c1","uid":1503320,"ip_address":"","ucode":"F2F179241EDA4F","user_header":"https://static001.geekbang.org/account/avatar/00/16/f0/58/87104eab.jpg","comment_is_top":false,"comment_ctime":1578359320,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578359320","product_id":100020801,"comment_content":"å¤§æŸ¥è¯¢ä¼šä¸ä¼šæŠŠå®¢æˆ·ç«¯å†…å­˜æ’‘çˆ†ï¼Ÿ","like_count":0},{"had_liked":false,"id":165876,"user_name":"Anthony","can_delete":false,"product_type":"c1","uid":1309908,"ip_address":"","ucode":"9E0C98A9123365","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/d4/743d3f02.jpg","comment_is_top":false,"comment_ctime":1577337676,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577337676","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘åˆä¸€ä¸ªç–‘é—®ï¼Œå¦‚æœå°†å†·æ•°æ®å…¨è¡¨æ‰«æï¼Œé‚£æ˜¯ä¸æ˜¯æœ€åä¸€æ‰¹è¿›buffer_poolçš„æ•°æ®ä¹Ÿä¼šç”±oldåŒºåŸŸç§»åˆ°youngåŒºåŸŸï¼Œå½±å“æŸ¥è¯¢çš„ç¼“å­˜å‘½ä¸­ç‡å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":153891,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1574326549,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574326549","product_id":100020801,"comment_content":"ç¼“å­˜çœŸæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œç”¨çš„å¥½å¤§å¤§æé«˜äº†æ•ˆç‡ã€‚","like_count":0},{"had_liked":false,"id":144169,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1571874517,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1571874517","product_id":100020801,"comment_content":"33 å…¨è¡¨æ‰«æï¼Œä¼šä¸ä¼šæŠŠå†…å­˜æ’‘çˆ† 1 å…¨è¡¨æ‰«æï¼Œå¯¹serverå±‚çš„å½±å“ï¼Œserverå±‚æŠŠè¯»åˆ°çš„ä¸€è¡Œè¡Œæ•°æ®æ”¾åˆ°net_bufferï¼Œ16kå¤§å°ç›´åˆ°å†™æ»¡ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œå¤„ç†çš„çº¿ç¨‹å¤„äºsending to clientçš„çŠ¶æ€ï¼Œ2 å…¨è¡¨æ‰«æ å¯¹innodbçš„å½±å“ï¼Œ2.1 WALæœºåˆ¶ï¼Œinnodbå†…å­˜æ˜¯ç”¨BPå³buffer poolç®¡ç†çš„ï¼Œé…åˆredo logï¼Œèƒ½é¿å…éšæœºå†™ç›˜ï¼Œä¹Ÿèƒ½åŠ é€ŸæŸ¥è¯¢ï¼Œ2.2 BPç®¡ç†å†…å­˜ç”¨çš„æ˜¯æ”¹è¿›åçš„LRUç®—æ³•ï¼Œå‰é¢æ˜¯youngåŒºåŸŸï¼Œåé¢æ˜¯oldåŒºåŸŸã€‚youngåŒºåŸŸå’Œoldçš„æ¯”ä¾‹æ˜¯5æ¯”3ï¼Œæ‰«æçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®åœ¨youngåŒºåŸŸåˆ™æŠŠæ•°æ®ç§»åˆ°youngåŒºåŸŸçš„å¤´éƒ¨ï¼Œå¦‚æœåœ¨oldåŒºåŸŸï¼Œçœ‹ä¸‹è¿™ä¸ªæ•°æ®é¡µåœ¨é“¾è¡¨ä¸­å­˜åœ¨çš„æ—¶é—´æ˜¯å¦è¶…è¿‡ä¸€ç§’ï¼Œä¸€ç§’ä»¥å†…ä½ç½®ä¸å˜ï¼Œè¶…è¿‡ä¸€ç§’ä¼šç§»åˆ°é“¾è¡¨å¤´éƒ¨å³youngåŒºåŸŸå¤´éƒ¨ã€‚æ–°æ’å…¥çš„æ•°æ®åœ¨oldåŒºåŸŸå¤´éƒ¨ï¼Œé™¤éè¢«äºŒæ¬¡è®¿é—®ï¼Œå¦åˆ™ä¼šè¢«é€æ¸æ·˜æ±°åˆ°å°¾éƒ¨ï¼Œæ·˜æ±°å‡ºå»ã€‚youngåŒºåŸŸä¿è¯äº†å¸¸è®¿é—®æ•°æ®çš„å‘½ä¸­ç‡ã€‚","like_count":0,"discussions":[{"author":{"id":1794060,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/60/0c/e1f012cb.jpg","nickname":"frankie","note":"","ucode":"813D1352B68A21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302675,"discussion_content":"æœ‰æ²¡æœ‰å¯èƒ½oldåŒºåŸŸçš„é¡µä»oldå¤´éƒ¨æ·˜æ±°åˆ°æœ€åçš„æ—¶å€™ è¿™ä¸ªæ—¶é—´è¶…è¿‡1ç§’å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599007872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143808,"user_name":"é¥­ç²’","can_delete":false,"product_type":"c1","uid":1153455,"ip_address":"","ucode":"4C3220B0D43997","user_header":"https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg","comment_is_top":false,"comment_ctime":1571794474,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571794474","product_id":100020801,"comment_content":"ä¸€ç‚¹ç†è§£ï¼šå•æ¬¡æŸ¥è¯¢çš„æ•°æ®æ— æ³•ä¸€æ¬¡æ€§å…¨éƒ¨æ”¾å…¥  net_buffer ä¸­ï¼Œéœ€è¦å¤šæ¬¡é€šè¿‡ net_buffer ä¸­è½¬å¤„ç†ï¼ŒSending to client çš„çŠ¶æ€æ‰ä¼šæ˜¾è‘—å‡ºç°ã€‚å¦‚æœå®¢æˆ·ç«¯å¤„ç†çš„å¾ˆæ…¢ï¼Œé‚£ socket send buffer å‘é€å¤„ç†æ…¢ï¼Œæ²¡åŠæ³•å¿«é€Ÿå– net_buffer çš„æ•°æ®ï¼Œnet_buffer ä¸­è½¬å¤„ç†æ—¶é—´å°±æ›´é•¿äº†ï¼ŒSending to client çš„çŠ¶æ€æŒç»­æ›´ä¹…ã€‚","like_count":0},{"had_liked":false,"id":142596,"user_name":"æ¶…æ§ƒ666","can_delete":false,"product_type":"c1","uid":1003405,"ip_address":"","ucode":"8E37DF3861AF81","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJtyy6XYfNM6kZ0c1FUu6KL0hQLlwwAko7RwCz16j4PnnGtnOJVvDKO2iajdJ3Jer8verf1AiaAyzHA/132","comment_is_top":false,"comment_ctime":1571408943,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571408943","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œèƒ½è¯´ä¸‹åˆ†é¡µçš„åŸç†å—","like_count":0},{"had_liked":false,"id":135729,"user_name":"æé‘«ç£Š","can_delete":false,"product_type":"c1","uid":1101615,"ip_address":"","ucode":"D06517CFCEEE00","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/2f/4f89f22a.jpg","comment_is_top":false,"comment_ctime":1569248177,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1569248177","product_id":100020801,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼Œå†…å­˜ä¸­çš„æ•°æ®é¡µæ˜¯åœ¨ Server å±‚è¿˜æ˜¯åœ¨ InnoDBï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":178542,"discussion_content":"innodb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582172421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130948,"user_name":"æ¸¡åŠ«è¾¾æ‘©","can_delete":false,"product_type":"c1","uid":1465391,"ip_address":"","ucode":"A7005CBB34B698","user_header":"https://static001.geekbang.org/account/avatar/00/16/5c/2f/a9c8d42f.jpg","comment_is_top":false,"comment_ctime":1567582150,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567582150","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå½“æˆ‘ç”¨jdbcå»æƒæ ‡æŸ¥è¯¢çš„æ—¶å€™ï¼Œä¼šçˆ†å†…å­˜æº¢å‡ºï¼Œå› ä¸ºæ•°æ®å¤ªå¤šäº†ã€‚ä½†æ˜¯ä¾ç…§ä½ ä¸Šé¢çš„è¯´æ³•ï¼Œå®ƒä¸æ˜¯ä¸€æ‰¹ä¸€æ‰¹çš„è¿”å›æ•°æ®å—ã€‚ä¸ºä»€ä¹ˆæˆ‘æœ€å—æ¥å—çš„listçš„æ•°æ®é‡å’Œå…¨è¡¨çš„æ•°æ®é‡æ˜¯ä¸€æ ·ï¼Œæœ€åæˆ‘ä½¿ç”¨äº†æµå¼æŸ¥è¯¢ï¼Œæ‰é€¼é¿å…äº†å†…å­˜æº¢å‡ºã€‚æ˜¯ä¸æ˜¯ä¸ä½¿ç”¨jdbcå°è£…çš„æµå¼è¯»å–ï¼Œå°±ä¸ä¼šæ˜¯ä¸€æ‰¹ä¸€æ‰¹çš„è¿”å›æ•°æ®","like_count":0},{"had_liked":false,"id":130297,"user_name":"MrVito","can_delete":false,"product_type":"c1","uid":1252169,"ip_address":"","ucode":"716FF6F8871706","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/49/ddefc656.jpg","comment_is_top":false,"comment_ctime":1567419925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567419925","product_id":100020801,"comment_content":"åŸæ¥LRUç¼“å­˜æ·˜æ±°ç­–ç•¥åœ¨buffer poolä¹Ÿæœ‰ä½¿ç”¨ï¼Œæˆ‘ä¹Ÿå®ç°è¿‡LRUï¼Œçœ‹æ¥è¿™ä¸ªçœŸçš„æ˜¯å¿…å¤‡æŠ€èƒ½å‘€ï¼","like_count":0},{"had_liked":false,"id":118714,"user_name":"é£ç¿”","can_delete":false,"product_type":"c1","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1564423520,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1564423520","product_id":100020801,"comment_content":"ä¸ºä»€ä¹ˆè¿™æ ·å†™ this.preparedStatement.executeQuery() ä¸ä¼šçˆ†å†…å­˜å‘€ï¼Œthis.sqlæ˜¯å…¨è¡¨æŸ¥è¯¢è¯­å¥<br>protected void openCursor(Connection con) {<br>        try {<br>            if (this.isUseSharedExtendedConnection()) {<br>                this.preparedStatement = con.prepareStatement(this.sql, 1003, 1007, 1);<br>            } else {<br>                this.preparedStatement = con.prepareStatement(this.sql, 1003, 1007);<br>            }<br><br>            this.applyStatementSettings(this.preparedStatement);<br>            if (this.preparedStatementSetter != null) {<br>                this.preparedStatementSetter.setValues(this.preparedStatement);<br>            }<br><br>            this.rs = this.preparedStatement.executeQuery();<br>            this.handleWarnings(this.preparedStatement);<br>        } catch (SQLException var3) {<br>            this.close();<br>            throw this.getExceptionTranslator().translate(&quot;Executing query&quot;, this.getSql(), var3);<br>        }<br>    }","like_count":0},{"had_liked":false,"id":109923,"user_name":"thomas","can_delete":false,"product_type":"c1","uid":1016777,"ip_address":"","ucode":"9AB945308F1B50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/c9/5d03981a.jpg","comment_is_top":false,"comment_ctime":1562134115,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1562134115","product_id":100020801,"comment_content":"è€å¸ˆä½ è¯´ï¼šâ€æŸ¥è¯¢è¯­å¥ç”±äºæ²¡æœ‰å…¶ä»–çš„åˆ¤æ–­æ¡ä»¶ï¼Œæ‰€ä»¥æŸ¥åˆ°çš„æ¯ä¸€è¡Œéƒ½å¯ä»¥ç›´æ¥æ”¾åˆ°ç»“æœé›†â€œï¼Œè‹¥åŠ ä¸Šå…¶ä»–åˆ¤æ–­æ¡ä»¶çš„è¯ï¼Œä¸ºä»€ä¹ˆå°±ä¸èƒ½æ”¾åˆ°ç»“æœé›†å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":103975,"user_name":"hal","can_delete":false,"product_type":"c1","uid":1359844,"ip_address":"","ucode":"98E625F7327FD9","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/e4/45758517.jpg","comment_is_top":false,"comment_ctime":1560579159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560579159","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œæ–‡ä¸­è¯´innodbå†…å­˜ç®¡ç†ä½¿ç”¨LRUç®—æ³•ï¼Œä½¿ç”¨é“¾è¡¨å®ç°ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼šä¸€ä¸ªæŸ¥è¯¢ï¼Œæˆ–è€…è¯·æ±‚å§ï¼Œæ€ä¹ˆæ‰¾åˆ°è¿™ä¸ªå·²ç»åœ¨é“¾è¡¨ä¸­çš„é¡µï¼Œå› ä¸ºè¿™ä¸ªé“¾è¡¨å¯èƒ½è¿˜ä¼šéšæ—¶å˜åŠ¨(æ–°è€äº¤æ›¿)","like_count":0},{"had_liked":false,"id":97868,"user_name":"ä¹”çº³æ£®","can_delete":false,"product_type":"c1","uid":1045107,"ip_address":"","ucode":"51EC9FAE071388","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/73/1c7bceae.jpg","comment_is_top":false,"comment_ctime":1558799476,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1558799476","product_id":100020801,"comment_content":"å¤§è¡¨èšåˆå‘¢ï¼Ÿå¦‚ group byï¼Œæ”¾åœ¨ç£ç›˜ä¸´æ—¶è¡¨ä¸­èšåˆï¼Ÿç£ç›˜ç©ºé—´å¤šå¤§å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":68102,"user_name":"700","can_delete":false,"product_type":"c1","uid":1072896,"ip_address":"","ucode":"E4BD0CBADAF951","user_header":"","comment_is_top":false,"comment_ctime":1550413014,"is_pvip":false,"replies":[{"id":"24270","content":"è¿™æ ·ç¡®å®çœ‹ä¸å‡ºæ¥ğŸ˜…","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550539071,"ip_address":"","comment_id":68102,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1550413014","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæ¥æˆ‘ä¸Šä¸ªé—®é¢˜ã€‚æ‚¨è¦çš„ä¿¡æ¯å¦‚ä¸‹ï¼š<br><br>top å‘½ä»¤<br>   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                 <br>144369 mysql     20   0  132.1g 111.8g   6712 S 101.0 88.9  19261:21 mysqld                                                                                  <br>161455 root      20   0  162500   2836   1584 R   0.7  0.0   0:00.17 top  <br><br>[root@******* ~]# <br>[root@******* ~]# free -m<br>              total        used        free      shared  buff&#47;cache   available<br>Mem:         128826      115682        8053        4032        5089        7588<br>Swap:         16383         505       15878<br>[root@******* ~]# <br><br>mysql&gt;select @@version;<br>+---------------------+<br>| @@version           |<br>+---------------------+<br>| 10.2.16-MariaDB-log |<br>+---------------------+<br>1 row in set (0.00 sec)<br><br>+-------------------------+-------------+<br>| Variable_name           | Value       |<br>+-------------------------+-------------+<br>| binlog_cache_size       | 4194304     |<br>| innodb_buffer_pool_size | 90194313216 |<br>| innodb_log_buffer_size  | 16777216    |<br>| join_buffer_size        | 2097152     |<br>| key_buffer_size         | 4194304     |<br>| max_allowed_packet      | 67108864    |<br>| max_heap_table_size     | 33554432    |<br>| net_buffer_length       | 32768       |<br>| query_cache_size        | 0           |<br>| read_buffer_size        | 262144      |<br>| read_rnd_buffer_size    | 2097152     |<br>| sort_buffer_size        | 1048576     |<br>| thread_stack            | 131072      |<br>| tmp_table_size          | 33554432    |<br>+-------------------------+-------------+","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439514,"discussion_content":"è¿™æ ·ç¡®å®çœ‹ä¸å‡ºæ¥ğŸ˜…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550539071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1231289,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM56TmIEXDkHOfMNr7cAlCyGSQHiab7frfp59ibfuIibyPcpG1vugMLjNDeosfewg3sUkIfE0mzicqGgtw/132","nickname":"åŒ—æç†Š","note":"","ucode":"80B9CB59E151CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587883,"discussion_content":"700  è¯·é—®é—®é¢˜å®šä½äº†å— æ”¶åˆ°è¯·reply  \n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663343654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65252,"user_name":"æ…•å¡”","can_delete":false,"product_type":"c1","uid":1302106,"ip_address":"","ucode":"5C6C668C1106A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/A94RKUfWfwzRzb68T9xskctQ43TBgXSBIL78p0N0ria2tQxmsTTJebYmefhkbHK7zwpoxokxs43UxpgDTdwm5tg/132","comment_is_top":false,"comment_ctime":1549162418,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1549162418","product_id":100020801,"comment_content":"youngåŒºåŸŸå…¶å®è¿˜æœ‰ä¼˜åŒ–ï¼Œé¢‘é“è°ƒæ•´LRUé¡µçš„é¡ºåºä¸ºå½±å“æ€§èƒ½(LRUå¾ˆé•¿)ï¼Œå¦‚æœè¦è¯»é¡µåœ¨youngåŒºåŸŸæŸä½ç½®ï¼Œå…¶å®æ˜¯æ²¡æœ‰å¿…è¦å°†è¦è¯»é¡µæ‹¿åˆ°å¤´éƒ¨ï¼Œæœ¬èº«å·²åœ¨çƒ­ç‚¹åŒºã€‚é¡µçš„å±æ€§æœ‰ä¸€ä¸ªæ—¶é—´æˆ³å­—æ®µï¼Œå¯ä»¥ç”¨äºè®¡ç®—å¤„äºoldåŒºåŸŸçš„æ—¶é—´ã€‚ğŸ˜","like_count":0},{"had_liked":false,"id":64443,"user_name":"Richie","can_delete":false,"product_type":"c1","uid":1111377,"ip_address":"","ucode":"1426E1B2E82A43","user_header":"https://static001.geekbang.org/account/avatar/00/10/f5/51/60e91438.jpg","comment_is_top":false,"comment_ctime":1548797470,"is_pvip":false,"replies":[{"id":"23186","content":"è¿™ä¸ªå®˜æ–¹ç‰ˆæœ¬ç¡®å®æ˜¯è¿˜æ²¡æœ‰ç³»ç»Ÿçš„åœ°æ–¹æŸ¥çœ‹~","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549270578,"ip_address":"","comment_id":64443,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548797470","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ€ä¹ˆæ‰èƒ½äº†è§£ä»€ä¹ˆåœ°æ–¹å ç”¨å†…å­˜ï¼ŒæŸ¥äº†å¾ˆå¤šèµ„æ–™éƒ½æ²¡æœ‰è¿™æ–¹é¢çš„ä¿¡æ¯ï¼ŒMySQL5.6","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437999,"discussion_content":"è¿™ä¸ªå®˜æ–¹ç‰ˆæœ¬ç¡®å®æ˜¯è¿˜æ²¡æœ‰ç³»ç»Ÿçš„åœ°æ–¹æŸ¥çœ‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549270578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}