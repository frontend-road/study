{"id":447579,"title":"16 | 实战痛点2：项目开发中的权限系统","content":"<p>你好，我是大圣。</p><p>在上一讲中，我们使用组件库完成了项目的搭建，并且引入了Element3和axios等基础库。基于Element3，我们可以很方便地使用组件搭建项目。而使用axios，可以很方便地获取后端数据。在项目中，权限系统的控制需要前后端配合完成，而且权限系统也是后端管理系统中常见的一个难点。不过，今天我们主要从前端的角度，来聊一下项目的权限系统。</p><p>下面，我们先从登录权限谈起，因为登录权限对于一个项目来说是必备的功能模块。完成了登录选项的设置后，下一步需要做的是管理项目中的页面权限，而角色权限在这一过程中则可以帮助我们精细化地去控制页面权限。</p><h2>登录权限</h2><p>继续上一讲我们搭建起来的项目，你可以看到现在所有的页面都可以直接访问了，通常来说管理系统的内部页面都需要登录之后才可以访问，比如个人中心、订单页面等等。首先，我们来设计一个这样的权限限制功能，它能保证某些页面在登录之后才能访问。</p><p>为了实现这个功能，我们首先需要模拟登录的接口和页面。我们先新增路由页面，进入到项目目录下，在router.js中新增路由配置。下面的代码中，routes数组新增/login路由访问。</p><pre><code class=\"language-javascript\">  import Login from '../components/Login.vue'\n  const routes = [\n  ...\n  {\n    path: '/login',\n    component: Login,\n    hidden: true,\n  }\n  ]\n</code></pre><!-- [[[read_end]]] --><p>然后，我们进入到src/components/Login.vue组件中，组件的代码如下所示。在代码中，我们能看到，用户在输入用户名和密码之后，把用户名和密码传递给后端，然后就可以实现登录认证。</p><pre><code class=\"language-javascript\">handleLogin() {\n  formRef.value.validate(async valid =&gt; {\n    if (valid) {\n      loading.value = true\n      const {code, message} = await useStore.login(loginForm)\n      loading.value = false\n      if(code===0){\n        router.replace( toPath || '/')\n      }else{\n        message({\n          message: '登录失败',\n          type: 'error'\n        })\n      }\n    } else {\n      console.log('error submit!!')\n      return false\n    }\n  })\n}\n</code></pre><p>由于我们的项目是一个前端项目，所以我们需要在Vite内部做数据结构的模拟。我们在src目录下面新建mock目录，用来放置假数据的结构。我们写死一个用户名dasheng，使用用户名dasheng登录成功之后，我们把用户名、过期日期等重要信息进行加密，生成一个token返回给前端。</p><p><strong>这个token就算是一个钥匙，<strong><strong>对于那些</strong></strong>需要权限<strong><strong>才能读取到</strong></strong>的页面数据，前端需要带上这个钥匙才能读取到数据，否则<strong><strong>访问那些页面的时候</strong></strong>就会显示没有权限</strong>。</p><pre><code class=\"language-javascript\">  {\n    url: '/geek-admin/user/login',\n    type: 'post',\n    response: config =&gt; {\n      const { username } = config.body\n      const token = tokens[username]\n\n      // mock error\n      if (user!=='dasheng') {\n        return {\n          code: 60204,\n          message: 'Account and password are incorrect.'\n        }\n      }\n\n      return {\n        code: 20000,\n        data: token\n      }\n    }\n  }\n</code></pre><p>我们回到前端页面，登录成功后，首先需要做的事情，就是把这个token存储在本地存储里面，留着后续发送数据。这一步的实现比较简单，直接把token存储到localStorage中就可以了。我们拿到这个token后，为了进行接口权限认证，要把token放在HTTP请求的header内部。</p><p>我们看下面的代码，在axios的请求发出之前，我们在配置中使用getToken从localStorage中读取token，放在请求的header里发送。由于我们使用了请求拦截的方式，所以所有的后端数据发送的时候，都会带上这个token，完成受限数据的请求。</p><pre><code class=\"language-javascript\">service.interceptors.request.use(\n  config =&gt; {\n    const token = getToken()\n    // do something before request is sent\n    if (token) {\n      config.headers.gtoken = token\n    }\n    return config\n  },\n  error =&gt; {\n    // do something with request error\n    console.log(error) // for debug\n    return Promise.reject(error)\n  }\n)\n</code></pre><p>通过上面的操作，我们完成了前端网络请求的token限制。但是还有一个需求没有实现，就是用户没有登录某个受限页面的时候，或者说没有token的时候，如果直接访问受限页面，比如个人中心，那么就需要让vue-router拦截这次页面的跳转。</p><p>与vue-router拦截页面的跳转，并显示无权限的报错信息相比，直接跳转登录页是现在更流行的交互方式。但这种方式需要在vue-router上加一层限制，这层限制就是说，在路由跳转的时候做权限认证，我们把vue-router的这个功能称作导航守卫。</p><p>关于导航守卫的API，你可以从Vue Router的官网看到很详细的<a href=\"https://next.router.vuejs.org/zh/guide/advanced/navigation-guards.html\">介绍</a>。这里我们实际应用下，下面的代码中，我们在router.beforeEach函数中设置一个全局的守卫。</p><p>每次页面跳转的时候，vue-router会自动执行守卫函数，如果函数返回false的话，页面跳转就会失败。不过，我们也可以手动地跳转到其他页面。现在我们设置的路由很简单，如果token不存在的话直接跳转登录页面，否则返回true，页面正常跳转。</p><pre><code class=\"language-javascript\">router.beforeEach(async (to, from,next) =&gt; {\n  // canUserAccess() 返回 `true` 或 `false`\n  let token = getToken()\n  if(!token){\n     next('/login')\n  }\n  return true\n})\n</code></pre><p>当然，在路由守卫的函数内，只要是页面跳转时想实现的操作，都可以放在这个函数内部实现，比如一些常见的交互效果，就像给项目的主页面顶部设置一个页面跳转的进度条、设置和修改页面标题等等。和我们现在对全部页面进行一次性的粗略拦截相比，后面还会在路由守卫那里进行更精确的路由拦截。</p><p>到这里你可能会有疑问：之前开发项目的时候，和登录注册相关的配置，不需要自己管理token，都是后端直接设置cookie。那么这里用到的token和之前项目开发时，交给后端设置的cookie到底有什么区别呢？</p><p>这是个非常好的问题，我们在第一讲聊前端发展史的时候，提到了jQuery时代的前端项目是作为后端项目的模块部署的。</p><p>那时候前后端不分家，整个应用的入口是后端控制模板的渲染。在模板渲染前，后端会直接判断路由的权限来决定是否跳转。登录的时候，后端只需要设置setCookie这个header，之后浏览器会自动把cookie写入到我们的浏览器存起来，然后当前域名在发送请求的时候都会自动带上这个cookie。</p><p>在Chrome浏览器中，我们先进入极客时间的官网，然后打开调试窗口页面，再选择Network页面。之后，我们在页面中点击Fetch/XHR，然后在Name这一栏中，我们可以任选一个接口点开。这样，我们就可以看到这个接口请求的所有细节了。</p><p>在下图中，我们点击list请求，也就是极客时间的推荐接口时，HTTP的Request Headers里就有Cookie这个数据，这是浏览器自动管理和发送的，也算是权限认证的最佳方案之一。</p><p><img src=\"https://static001.geekbang.org/resource/image/98/8e/98b1ce4137ecfb9ea01dc4ea0381e68e.png?wh=1920x1084\" alt=\"图片\"></p><p>但是，在现在这种前后端分离的场景下，通常前后端项目都会部署在不同的机器和服务器之上，Cookie在跨域上有诸多的限制。所以在这种场景下，我们更愿意手动地去管理权限，于是就诞生了现在流行的基于token的权限解决方案，你也可以把token理解为我们手动管理的cookie。</p><h2>角色权限</h2><p>实现登录权限验证之后，我们就可以针对项目中的页面进行登录的保护。但现在，我们只能通过登录状态去判断页面的显示与否，而这远远达不到我们实际开发的需求。</p><p>比如，在我们的管理系统开发中，订单页面是所有人都可以看到的，但是像账单的查询页面，以及其他一些权限更高的页面，我们需要管理员权限才能看到。这时候，我们就需要对系统内部的权限进行分级，每个级别都对应着可以访问的不同页面。</p><p>我们通常使用的权限解决方案就是RBAC权限管理机制。简单来说，就是在下图所示的这个模型里，除了用户和页面之外，<strong>我们需要一个新的概念，就是角色</strong><strong>。</strong>每个用户有不同的角色，每个角色对应不同的页面权限，这个数据结构的关系设计主要是由后端来实现。</p><p>根据下图这个结构，在用户登录完成之后我们会获取页面的权限数据，也就是说后端会返回给我们当前页面的动态权限部分。</p><p><img src=\"https://static001.geekbang.org/resource/image/e9/95/e93dd5a15c93b193debe462eb0349c95.jpg?wh=1347x697\" alt=\"图片\"></p><p>这样有一部分页面是写在代码的src/router/index.js中，另外一部分页面我们通过axios获取数据后，通过调用vue-router的addRoute方法动态添加进项目整体的路由配置中。</p><p>关于这部分动态路由的内容，官网的文档中有详细的<a href=\"https://next.router.vuejs.org/zh/guide/advanced/dynamic-routing.html\">API介绍</a>。在下面的代码中，我们在Vuex中注册addRoute这个action，通过后端返回的权限页面数据，调用router.addRoute新增路由。</p><pre><code class=\"language-javascript\">  addRoutes({ commit }, accessRoutes) {\n    // 添加动态路由，同时保存移除函数，将来如果需要重置路由可以用到它们\n    const removeRoutes = []\n    accessRoutes.forEach(route =&gt; {\n      const removeRoute = router.addRoute(route)\n      removeRoutes.push(removeRoute)\n    })\n    commit('SET_REMOVE_ROUTES', removeRoutes)\n  },\n</code></pre><p>与新增路由对应，在页面重新设置权限的时候，我们需要用router.removeRoute来删除注册的路由，这也是上面的代码中我们还有一个remoteRoutes来管理动态路由的原因。</p><p>然后，我们需要把动态路由的状态存储在本地存储里，否则刷新页面之后，动态的路由部分就会被清空，页面就会显示404报错。我们需要在localStorage中把静态路由和动态路由分开对待，在页面刷新的时候，通过src/router/index.js入口文件中的routes配置，从localStorage中获取完整的路由信息，并且新增到vue-router中，才能加载完整的路由。</p><p>权限系统中还有一个常见的问题，就是登录是有时间限制的。在常见的登录状态下，token有效期只能保持24小时或者72小时，过了这个期限，token会自动失效。即使我们依然存在token，刷新页面后也会跳转到登录页。所以，对token有效期的判断这个需求该如何实现呢？</p><p>首先，token的过期时间认证是由后端来实现和完成的。如果登录状态过期，那么会有一个单独的报错信息，我们需要在接口拦截函数中，统一对接口的响应结果进行拦截。如果报错信息显示的是登录过期，我们需要清理所有的token和页面权限数据，并且跳转到登录页面。</p><p>下面的代码中，50008和50012都代表着状态过期，我们可以直接使用Element3的messageBox组件显示一个错误信息，提示用户需要重新登录，然后直接跳转到登录页面就可以了。</p><pre><code class=\"language-javascript\">// 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;\nif (res.code === 50008 || res.code === 50012) {\n  // to re-login\n  Msgbox.confirm('You have been logged out, you can cancel to stay on this page, or log in again', 'Confirm logout', {\n    confirmButtonText: 'Re-Login',\n    cancelButtonText: 'Cancel',\n    type: 'warning',\n  }).then(() =&gt; {\n    store.dispatch('user/resetToken').then(() =&gt; {\n      location.reload()\n    })\n  })\n}\nreturn Promise.reject(new Error(res.message || 'Error'))\n</code></pre><h2>总结</h2><p>今天这一讲的内容就讲完了，我们来总结一下今天学到的重点吧。首先，在登录权限这一部分，我们模拟了登录的接口和页面，登录成功后的token存储在localStorage中，使用axios的拦截器管理所有接口的token信息。</p><p>然后，我们学习了路由守卫的概念，借助路由守卫，我们可以实现页面的权限保护，让指定页面需要登录之后才可以访问。我们使用的是token权限校验机制，在用户登录之后，后端会把用户信息加密成一个token返回给前端，然后前端把token存储在localStorage中。</p><p>在axios的全局拦截函数中，每个请求发出去之前都会获取token，然后放在HTTP请求的header之中，后端会读取这个token进行权限认证。除了后端接口的权限，vue-router也会做页面的权限拦截，这个功能也就是路由守卫，vue-router允许你在所有路由跳转之前执行钩子函数，这个函数内部我们做权限认证，如果符合要求就允许跳转，否则就跳转到404页面。</p><p>最后，我们还了解了更复杂一些的权限系统设计，在这种设计下，用户可以根据角色的划分，对应到不同的页面权限，一部分页面是登录后就可以访问，一部分页面是需要额外地获取后端接口，匹配到当前用户权限之后，才可以访问的页面，我们把这种权限设计称之为动态路由。vue-router提供的addRoute和removeRoute这两个函数，可以很好地帮助我们实现这一功能。</p><h2>思考题</h2><p>最后，是给你留的一个思考题，如果在任意一个页面里，我们想实现按钮级别的权限认证，那我们应该如何扩展我们的权限系统呢？</p><p>欢迎在留言区分享你的看法，也欢迎你把这一讲的内容分享给你的同事、朋友们，我们下一讲再见。</p>","comments":[{"had_liked":false,"id":323167,"user_name":"关关君","can_delete":false,"product_type":"c1","uid":1562774,"ip_address":"","ucode":"98EAD61438860A","user_header":"https://static001.geekbang.org/account/avatar/00/17/d8/96/dcf52430.jpg","comment_is_top":false,"comment_ctime":1637748225,"is_pvip":false,"replies":[{"id":"118383","content":"cool  ! 非常好的实战经验","user_name":"作者回复","comment_id":323167,"uid":"1003715","ip_address":"","utype":1,"ctime":1639401922,"user_name_real":"编辑"}],"discussion_count":3,"race_medal":0,"score":"96127028737","product_id":100094401,"comment_content":"使用老师之前的代码按照文章的流程实现：<br>1. mock数据<br>2. jwt生成Token验证<br>3. 拦截器Token加头<br>4. 路由守卫权限验证<br>5. 登录逻辑<br>对前端了解不全面的同学克隆下来看看整个流程代码，希望对你有帮助<br>https:&#47;&#47;github.com&#47;yanbinkwan&#47;Vite-Course<br>git clone https:&#47;&#47;github.com&#47;yanbinkwan&#47;Vite-Course.git","like_count":23,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538389,"discussion_content":"cool  ! 非常好的实战经验","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639401922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2258618,"avatar":"https://static001.geekbang.org/account/avatar/00/22/76/ba/2373075b.jpg","nickname":"陈豆","note":"","ucode":"7E2A0766B035C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538818,"discussion_content":"刚看了下，牛逼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639532159,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1165817,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg","nickname":"阿阳","note":"","ucode":"20A35FB86B1C5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534451,"discussion_content":"厉害了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638193139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322654,"user_name":"酱汁","can_delete":false,"product_type":"c1","uid":2436955,"ip_address":"","ucode":"B206BFCD8416AA","user_header":"https://static001.geekbang.org/account/avatar/00/25/2f/5b/74ba6ffa.jpg","comment_is_top":false,"comment_ctime":1637544046,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"83241922670","product_id":100094401,"comment_content":"封装自定义指令 v-auth 可以精确到按钮级别的权限","like_count":20},{"had_liked":false,"id":322745,"user_name":"ll","can_delete":false,"product_type":"c1","uid":1296458,"ip_address":"","ucode":"57C5DAC5B51036","user_header":"https://static001.geekbang.org/account/avatar/00/13/c8/4a/3a322856.jpg","comment_is_top":false,"comment_ctime":1637573234,"is_pvip":true,"replies":[{"id":"118412","content":"其实最简单的方式就是设置一个缓存层比如redis存储token，每次登录都生成新的token，会吧之前的token覆盖掉，校验的时候从缓存校验一次就可以实现","user_name":"作者回复","comment_id":322745,"uid":"1003715","ip_address":"","utype":1,"ctime":1639404765,"user_name_real":"编辑"}],"discussion_count":7,"race_medal":0,"score":"74652017266","product_id":100094401,"comment_content":"大圣讲的很详细，点赞，我在课后还是要实际写遍代码，跑起项目来才能更好的吸收知识。<br><br>另外关于登录状态有个疑问，网上搜索了下，不确定是否叫做，多点登录状态限制问题。就是像极客时间这种网页登录后，在别的设备登录后，这边就下线了。<br>我能猜到的大概有两种方式：<br>1. 轮询查询，setInterval 之类的定时器，定时查询，然后我打开dev-tool的Performance发现是有定时任务在跑，不过代码最小化过，不太容易看。<br>2. webSocket 长链接，某个设备登录以后用webSocket之类的方式保持长连接，其他设备登录后，登录状态改变，服务端发个下线的指令这种。<br>已上，望指教，大概的思路或有相关文章就好，谢谢","like_count":18,"discussions":[{"author":{"id":1985141,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4a/75/51435f4b.jpg","nickname":"@","note":"","ucode":"B308157E3FA393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532934,"discussion_content":"别吹了，这章太水了吧","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1637734682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":1,"child_discussions":[{"author":{"id":1296458,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/4a/3a322856.jpg","nickname":"ll","note":"","ucode":"57C5DAC5B51036","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1985141,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4a/75/51435f4b.jpg","nickname":"@","note":"","ucode":"B308157E3FA393","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532952,"discussion_content":"朋友，你的看法跟我有毛关系呢？会说你就说，不说也没人把你当那个，你说对吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637738331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":532934,"ip_address":""},"score":532952,"extra":"{\"user_type\":1}"}]},{"author":{"id":2826990,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/22/ee/4c26bdf4.jpg","nickname":"=。=","note":"","ucode":"8C2F9474FEC080","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533597,"discussion_content":"没你说的这么麻烦....别的设备登录后就会产生新的token，旧的token就会过期失效了，后面就和大圣老师文章里面写的处理token失效的方法弄就好了","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1637914200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1296458,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/4a/3a322856.jpg","nickname":"ll","note":"","ucode":"57C5DAC5B51036","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2826990,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/22/ee/4c26bdf4.jpg","nickname":"=。=","note":"","ucode":"8C2F9474FEC080","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536652,"discussion_content":"棒，谢谢分享","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638841546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":533597,"ip_address":""},"score":536652,"extra":""}]},{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538427,"discussion_content":"其实最简单的方式就是设置一个缓存层比如redis存储token，每次登录都生成新的token，会吧之前的token覆盖掉，校验的时候从缓存校验一次就可以实现","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639404765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071974,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","nickname":"党","note":"","ucode":"EE531DB3EA124D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577615,"discussion_content":"这个很好实现的 每次登陆都发你个登陆编码 同时存储在redis中 你请求除了带上toke还要带上这个登陆编码 登陆编码变了 则拒绝使用 直接跳登陆界面 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656234852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2425641,"avatar":"https://static001.geekbang.org/account/avatar/00/25/03/29/9c88ff77.jpg","nickname":"青箬笠","note":"","ucode":"526F0A15CBEEAD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536821,"discussion_content":"这个交给后端去判断。后端返回特定的业务码来清除本地数据","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638875929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322688,"user_name":"一个自闭的人","can_delete":false,"product_type":"c1","uid":1283806,"ip_address":"","ucode":"55CD5FD82670B8","user_header":"https://static001.geekbang.org/account/avatar/00/13/96/de/cc26d1eb.jpg","comment_is_top":false,"comment_ctime":1637551127,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"61767093271","product_id":100094401,"comment_content":"老师能否把代码贴出来呢，这样比较直观点","like_count":15,"discussions":[{"author":{"id":1290864,"avatar":"","nickname":"Geek_14ae76","note":"","ucode":"37034AA6882CE5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532717,"discussion_content":"强烈建议，非前段同学学习好难。前面几章还很详细，后面越来越不清晰了","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1637673065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2818001,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/ff/d1/7a4a6f4f.jpg","nickname":"风一样","note":"","ucode":"5EA5129D487E43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535873,"discussion_content":"是的，既然没有录视频，就请老师把所有代码都贴出来，并且讲的要详细一些，比如像下面这个语句\n  formRef.value.validate(async valid =&gt; {\n还需要进一步讲解","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1638587190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1985141,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4a/75/51435f4b.jpg","nickname":"@","note":"","ucode":"B308157E3FA393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532936,"discussion_content":"https://github.com/shengxinjing/geektime-vue-course","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637734749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2826802,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/22/32/10c26ee4.jpg","nickname":"一线蓝光","note":"","ucode":"CDF0FF31756774","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532865,"discussion_content":"是的，希望老师代码能够再详细些，刚刚开始接触这写写法，还是比较懵圈的状态，如果代码讲解更完善一些会比较好，","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637722389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323641,"user_name":"M.","can_delete":false,"product_type":"c1","uid":2748690,"ip_address":"","ucode":"9F81D8B52089A5","user_header":"https://static001.geekbang.org/account/avatar/00/29/f1/12/b832c0b2.jpg","comment_is_top":false,"comment_ctime":1638063191,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44587736151","product_id":100094401,"comment_content":"每一讲应该附带这一讲对应的整体代码结构，应该更容易了解！！","like_count":11},{"had_liked":false,"id":322662,"user_name":"Geek_liuke","can_delete":false,"product_type":"c1","uid":1504193,"ip_address":"","ucode":"77E2D782FCFBBD","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/c1/466bd5e9.jpg","comment_is_top":false,"comment_ctime":1637546219,"is_pvip":false,"replies":[{"id":"117376","content":"我做过类似的需求，是对接了三个系统，三个token的过期时间不一样","user_name":"作者回复","comment_id":322662,"uid":"1003715","ip_address":"","utype":1,"ctime":1637932964,"user_name_real":"编辑"}],"discussion_count":4,"race_medal":0,"score":"31702317291","product_id":100094401,"comment_content":"做项目的时候遇到过大厂后台不愿意做token过期判断的情况。只有前端自己设置token过期时间和判断，需要在axios里增加一个每成功调用一次接口就自动延长token期限的逻辑。在页面中还需要增加一个watch，监听token期限的变化，期限到了或者token被清空了就自动跳转到登录页去。","like_count":8,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533685,"discussion_content":"我做过类似的需求，是对接了三个系统，三个token的过期时间不一样","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637932964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071974,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","nickname":"党","note":"","ucode":"EE531DB3EA124D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577617,"discussion_content":"“大厂不愿意做token过期判断吧”是什么意思？token过期接口无权访问，这是token基本使用，大厂不可能不去做的，但你要说token过期进行刷新，这个工作确实不适合后端去处理，前端去处理反而是最简单的，至于为啥不适合后端做，做过的人都懂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656235263,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039601,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/f1/fe55d0dd.jpg","nickname":"方枪枪_work","note":"","ucode":"744FBCA61E0FF7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566563,"discussion_content":"app 一般都是这么做的，每次你打开 app；自动给你登录一次，更新一次token\n你想想，你app是不是很多时候都是无感的，输入过一次，此后基本不需要再次输入","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650714476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1023296,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9d/40/c6568531.jpg","nickname":"帅迪","note":"","ucode":"19365E67027D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549141,"discussion_content":"学习了～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643618133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326435,"user_name":"Geek_e97208","can_delete":false,"product_type":"c1","uid":2816772,"ip_address":"","ucode":"6115337E89EA1E","user_header":"","comment_is_top":false,"comment_ctime":1639530362,"is_pvip":false,"replies":[{"id":"118540","content":"路由和菜单绑定一起控制权限，用户肯定是是看不到按钮的，路由的控制主要是防止直接输入对应地址的访问<br>还有一种情况是有些页面你想让用户看到，但是用户点进去需要升级或者付费才能有权限，入口打开但是不能访问  ，具体怎么控制其实要看具体的需求","user_name":"作者回复","comment_id":326435,"uid":"1003715","ip_address":"","utype":1,"ctime":1639531581,"user_name_real":"编辑"}],"discussion_count":2,"race_medal":0,"score":"27409334138","product_id":100094401,"comment_content":"路由控制权限感觉是个伪命题，项目实际情况都是无权限看不到具体按钮或者菜单。不会给用户点了菜单结果是404。大圣觉得呢","like_count":7,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538814,"discussion_content":"路由和菜单绑定一起控制权限，用户肯定是是看不到按钮的，路由的控制主要是防止直接输入对应地址的访问\n还有一种情况是有些页面你想让用户看到，但是用户点进去需要升级或者付费才能有权限，入口打开但是不能访问  ，具体怎么控制其实要看具体的需求","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1639531581,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1071974,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","nickname":"党","note":"","ucode":"EE531DB3EA124D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577618,"discussion_content":"很多管理平台是有权限控制 比如学校用的系统 要根据工作岗位不同 创建不同角色 对应不同权限 展示不同页面和按钮 虽然开发可以根据客户实际情况提前都定好 但是客户就要自己能新增权限 做不同功能的组合","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656235520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322640,"user_name":"海阔天空","can_delete":false,"product_type":"c1","uid":1327016,"ip_address":"","ucode":"16C87A0052A08B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3f/a8/8da58e53.jpg","comment_is_top":false,"comment_ctime":1637538156,"is_pvip":false,"replies":[{"id":"118402","content":"其实也需要，因为请求拦截需要数据返回后，页面拦截可以在跳转之前，体验会更好","user_name":"作者回复","comment_id":322640,"uid":"1003715","ip_address":"","utype":1,"ctime":1639404142,"user_name_real":"编辑"}],"discussion_count":4,"race_medal":0,"score":"23112374636","product_id":100094401,"comment_content":"权限系统确实是实战疼点。token 的过期时间认证是由后端来实现和完成的。所以我们需要做http请求的响应拦截。以此判断是否登录和是否登录过期。请问老师，如果做了响应拦截，是否还需要路由守卫呢？如果使用路由守卫？","like_count":5,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538414,"discussion_content":"其实也需要，因为请求拦截需要数据返回后，页面拦截可以在跳转之前，体验会更好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639404142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1334652,"avatar":"https://static001.geekbang.org/account/avatar/00/14/5d/7c/3cfece5e.jpg","nickname":"润培","note":"","ucode":"1CC2CD568CECC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532174,"discussion_content":"一般还是会使用路由守卫，这样可以避免没有token的情况下还继续向服务端发送请求，可以减少服务器的压力","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637549627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1985141,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4a/75/51435f4b.jpg","nickname":"@","note":"","ucode":"B308157E3FA393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532938,"discussion_content":"没token直接拦截器里刷新token或者跳登录了。token登录态放到拦截器里，路由级权限放到守卫里。刚进项目需要算出当前角色可访问的路由用addRoute添加","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637735276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2816505,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/f9/f9/da3e2950.jpg","nickname":"默然","note":"","ucode":"443D525B6B9D52","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532362,"discussion_content":"响应拦截是接口请求的拦截器，路由守卫是路由也就是页面的拦截器，都有有自己的的分工，同时也可以配合工作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637585778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322689,"user_name":"清歌终南","can_delete":false,"product_type":"c1","uid":2815124,"ip_address":"","ucode":"4EEE4C63F01762","user_header":"https://static001.geekbang.org/account/avatar/00/2a/f4/94/94262d52.jpg","comment_is_top":false,"comment_ctime":1637551229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18817420413","product_id":100094401,"comment_content":"使用Vue中的自定义指令，加入按钮权限","like_count":4},{"had_liked":false,"id":323762,"user_name":"666de6","can_delete":false,"product_type":"c1","uid":1382382,"ip_address":"","ucode":"C5485E1AE199CB","user_header":"https://static001.geekbang.org/account/avatar/00/15/17/ee/fa085494.jpg","comment_is_top":false,"comment_ctime":1638154537,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14523056425","product_id":100094401,"comment_content":"实现按钮级别的权限认证:<br>1. 维护页面下需要控制权限的按钮权限标识，后台保存；<br>2. 登录后，获取权限数据，将该用户的按钮权限数组存放到对应页面的路由信息里；<br>3. 可编写v-auth的自定义指令（可以拿当前按钮标识去当前页面路由信息的按钮权限数组里去找，存在则显示，否则隐藏）；","like_count":4,"discussions":[{"author":{"id":1023296,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9d/40/c6568531.jpg","nickname":"帅迪","note":"","ucode":"19365E67027D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549143,"discussion_content":"详细，学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643618745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323096,"user_name":"Jace","can_delete":false,"product_type":"c1","uid":1382887,"ip_address":"","ucode":"E8190B8D93984D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep9lG8VH1ryzD0TQTOvfUzropVQOkcAodmxcFibichgxetuyibbvHM1IagEvp2HFX9DONfxEzxIWrpOg/132","comment_is_top":false,"comment_ctime":1637726006,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"14522627894","product_id":100094401,"comment_content":"大圣老师，能不能搞一个完整的项目，然后再结合知识点讲解下，这样效果好点","like_count":3,"discussions":[{"author":{"id":1608101,"avatar":"https://static001.geekbang.org/account/avatar/00/18/89/a5/f89a1946.jpg","nickname":"快乐一家","note":"","ucode":"37156DF2DC27E3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533592,"discussion_content":"同问，看的有些蒙圈","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637912871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1848314,"avatar":"","nickname":"一块小砖头","note":"","ucode":"4FA84F57FDEC18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533271,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637829871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325785,"user_name":"疯琴","can_delete":false,"product_type":"c1","uid":1099379,"ip_address":"","ucode":"82ACAA4A27753D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c6/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1639129695,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10229064287","product_id":100094401,"comment_content":"这节的代码没在仓库里？","like_count":3},{"had_liked":false,"id":325545,"user_name":"cwang","can_delete":false,"product_type":"c1","uid":1465246,"ip_address":"","ucode":"04CB9F4CA2CEAD","user_header":"https://static001.geekbang.org/account/avatar/00/16/5b/9e/a8dec12d.jpg","comment_is_top":false,"comment_ctime":1639019590,"is_pvip":false,"replies":[{"id":"118320","content":"大部分场景封装一个v-auth指令","user_name":"作者回复","comment_id":325545,"uid":"1003715","ip_address":"","utype":1,"ctime":1639397976,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"10228954182","product_id":100094401,"comment_content":"如果在任意一个页面里，我们想实现按钮级别的权限认证，那我们应该如何扩展我们的权限系统呢？<br><br>按钮级别的权限，是跟角色对应的。具体实现上，可以使用Vue自定义指令，但是某些情况自定义指令会很鸡肋，需要配合v-if 模板语法来实现。","like_count":3,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538307,"discussion_content":"大部分场景封装一个v-auth指令","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639397976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323268,"user_name":"ohmylittleego .","can_delete":false,"product_type":"c1","uid":2815975,"ip_address":"","ucode":"609914359495FE","user_header":"https://static001.geekbang.org/account/avatar/00/2a/f7/e7/9a6e68c4.jpg","comment_is_top":false,"comment_ctime":1637807886,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10227742478","product_id":100094401,"comment_content":"大圣，实战篇的代码 Git上还没出吗？","like_count":2,"discussions":[{"author":{"id":1848314,"avatar":"","nickname":"一块小砖头","note":"","ucode":"4FA84F57FDEC18","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533270,"discussion_content":"没有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637829860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330117,"user_name":"coder","can_delete":false,"product_type":"c1","uid":1656956,"ip_address":"","ucode":"3A0940EBF94577","user_header":"https://static001.geekbang.org/account/avatar/00/19/48/7c/2aaf50e5.jpg","comment_is_top":false,"comment_ctime":1641803021,"is_pvip":false,"replies":[{"id":"120846","content":"现在代码都集中推到这个仓库里<br>https:&#47;&#47;github.com&#47;shengxinjing&#47;geektime-vue-course","user_name":"作者回复","comment_id":330117,"uid":"1003715","ip_address":"","utype":1,"ctime":1642338707,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"5936770317","product_id":100094401,"comment_content":"还是没代码啊，非前端同学表示太难受了","like_count":1,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546550,"discussion_content":"现在代码都集中推到这个仓库里\nhttps://github.com/shengxinjing/geektime-vue-course","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642338707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324434,"user_name":"。。。","can_delete":false,"product_type":"c1","uid":2048692,"ip_address":"","ucode":"7781EC756411A4","user_header":"https://static001.geekbang.org/account/avatar/00/1f/42/b4/c9cbf1b0.jpg","comment_is_top":false,"comment_ctime":1638433164,"is_pvip":false,"replies":[{"id":"117732","content":"后面组件设计部分会带着大家用代码体验一下。","user_name":"编辑回复","comment_id":324434,"uid":"1501385","ip_address":"","utype":2,"ctime":1638435076,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"5933400460","product_id":100094401,"comment_content":"希望结合一个项目从零到运用来结合讲解更能理解  这样太散了","like_count":1,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"听水的湖","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535417,"discussion_content":"后面组件设计部分会带着大家用代码体验一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638435076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323312,"user_name":"一块小砖头","can_delete":false,"product_type":"c1","uid":1848314,"ip_address":"","ucode":"4FA84F57FDEC18","user_header":"","comment_is_top":false,"comment_ctime":1637829836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5932797132","product_id":100094401,"comment_content":"我还是希望老师能结合视频一起来，这个样缺胳膊少腿容易。","like_count":1},{"had_liked":false,"id":322731,"user_name":"Condor Hero","can_delete":false,"product_type":"c1","uid":1528334,"ip_address":"","ucode":"BD850FE812D22F","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/0e/c5ff46d2.jpg","comment_is_top":false,"comment_ctime":1637570743,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"5932538039","product_id":100094401,"comment_content":"自定义组件和自定义指令都行，更推荐自定义组件来实现。","like_count":1},{"had_liked":false,"id":322646,"user_name":"小胖","can_delete":false,"product_type":"c1","uid":1098584,"ip_address":"","ucode":"B1C0EFDD821630","user_header":"https://static001.geekbang.org/account/avatar/00/10/c3/58/ba171e09.jpg","comment_is_top":false,"comment_ctime":1637541792,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5932509088","product_id":100094401,"comment_content":"我们项目按键权限的实现是，后端返回所有用户权限信息，直接v-if权限表里面有没有这个字段(这中间匹配有个方法)。<br>同时，后端也会对按钮对应的接口在权限上添加上限制。","like_count":1},{"had_liked":false,"id":322639,"user_name":"南山","can_delete":false,"product_type":"c1","uid":1239362,"ip_address":"","ucode":"1B5EF54A2A56F8","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/42/1de79e71.jpg","comment_is_top":false,"comment_ctime":1637538129,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"5932505425","product_id":100094401,"comment_content":"封装v-auth指令，控制按钮显示，老师能讲下refreshToken的处理吗？","like_count":1,"discussions":[{"author":{"id":2818154,"avatar":"","nickname":"Geek_e92dcb","note":"","ucode":"B33B8BA27E0B99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532172,"discussion_content":"刷新token也是后台给对应刷新token的状态码和新的toekn，前台只需要判断该状态码，如果返回对应刷新token的状态码，比如007，咱们前端只需要更新toekn就可以了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1637549084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2832259,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epmBmNzSU9po7PX7NapoPlIPoRWOUUAiaQ1RvOnqmMZkFLnVTKiafHEMzwiamEqWyDCYWcvpYunAJ5Kg/132","nickname":"aehyok","note":"","ucode":"5170D8FC3143D6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532128,"discussion_content":"这个跟刷新token有什么关系，能再具体说一下嘛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637543117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":2,"child_discussions":[{"author":{"id":1562774,"avatar":"https://static001.geekbang.org/account/avatar/00/17/d8/96/dcf52430.jpg","nickname":"关关君","note":"","ucode":"98EAD61438860A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2832259,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epmBmNzSU9po7PX7NapoPlIPoRWOUUAiaQ1RvOnqmMZkFLnVTKiafHEMzwiamEqWyDCYWcvpYunAJ5Kg/132","nickname":"aehyok","note":"","ucode":"5170D8FC3143D6","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":532869,"discussion_content":"因为安全原因Token的时效很短，如果没有RereshToken会导致用户需要频繁登录，所以需要在Token过期时携带RefreshToken请求新的token 这样用户无需重新登录可以获取到新Token","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637723584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":532128,"ip_address":""},"score":532869,"extra":"{\"user_type\":1}"},{"author":{"id":1985141,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4a/75/51435f4b.jpg","nickname":"@","note":"","ucode":"B308157E3FA393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1562774,"avatar":"https://static001.geekbang.org/account/avatar/00/17/d8/96/dcf52430.jpg","nickname":"关关君","note":"","ucode":"98EAD61438860A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":532939,"discussion_content":"其实RefreshToken也可以由后端刷新后直接给出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637735408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":532869,"ip_address":""},"score":532939,"extra":"{\"user_type\":1}"}]}]},{"had_liked":false,"id":349698,"user_name":"党","can_delete":false,"product_type":"c1","uid":1071974,"ip_address":"","ucode":"EE531DB3EA124D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg","comment_is_top":false,"comment_ctime":1656234682,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656234682","product_id":100094401,"comment_content":"token还有个经常涉及到的问题 token刷新问题(token续租) 在规定时间内对token进行无感刷新 用户不必非要72小时登陆就登陆一次 那样体验太差了 关于刷新问题 后端可以提供刷新接口 前端设计刷新时机 比如每次到首页后 首页检查token生命期还有多久 如果还剩下一半则进行token刷新 如果token过期就跳到登录页","like_count":0},{"had_liked":false,"id":345078,"user_name":"鐘","can_delete":false,"product_type":"c1","uid":1518535,"ip_address":"","ucode":"0106652D5F7BD9","user_header":"https://static001.geekbang.org/account/avatar/00/17/2b/c7/9c8647c8.jpg","comment_is_top":false,"comment_ctime":1652004393,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652004393","product_id":100094401,"comment_content":"不太懂 Mock 這邊的設定, 感覺沒頭沒尾<br>我知道自己要訂假數據, 只是這個怎麼在現有的流程發揮作用","like_count":0},{"had_liked":false,"id":344770,"user_name":"Summer夏","can_delete":false,"product_type":"c1","uid":1565400,"ip_address":"","ucode":"D26F33CA79F92E","user_header":"https://static001.geekbang.org/account/avatar/00/17/e2/d8/913105f5.jpg","comment_is_top":false,"comment_ctime":1651759677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651759677","product_id":100094401,"comment_content":"在vuex中使用useRouter获取router实例为undefined，不知道是啥原因，有大佬这一步实现的吗？","like_count":0},{"had_liked":false,"id":334697,"user_name":"木子初秋","can_delete":false,"product_type":"c1","uid":2893706,"ip_address":"","ucode":"6DDCB55232E1B3","user_header":"https://static001.geekbang.org/account/avatar/00/2c/27/8a/d65e34c4.jpg","comment_is_top":false,"comment_ctime":1645081989,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645081989","product_id":100094401,"comment_content":"结合大圣老师和关关君同学的代码，完整的写了一遍实战前两节的代码。进行了代码优化，样式优化，看着更舒服点了。很棒的一次体验。","like_count":0},{"had_liked":false,"id":334444,"user_name":"木子初秋","can_delete":false,"product_type":"c1","uid":2893706,"ip_address":"","ucode":"6DDCB55232E1B3","user_header":"https://static001.geekbang.org/account/avatar/00/2c/27/8a/d65e34c4.jpg","comment_is_top":false,"comment_ctime":1644939169,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1644939169","product_id":100094401,"comment_content":"老师 可以解释一下 路由里面的 hidden: true具体有什么作用？查了下百度感觉说的很含糊 比较详细的是 <br>if `hidden:true` will not show(default is false)  不知道这个不显示指的在老师这个实战中对应什么位置？小白问题 别打 O(∩_∩)O哈哈~","like_count":0,"discussions":[{"author":{"id":2893706,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/27/8a/d65e34c4.jpg","nickname":"木子初秋","note":"","ucode":"6DDCB55232E1B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551681,"discussion_content":"完善了这前两章的代码。clone地址如下\nhttps://github.com/AAsmallz/vite-vue3.git","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645082509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326528,"user_name":"Bob","can_delete":false,"product_type":"c1","uid":1297000,"ip_address":"","ucode":"C7F32FAEBAC2CA","user_header":"https://static001.geekbang.org/account/avatar/00/13/ca/68/161971d5.jpg","comment_is_top":false,"comment_ctime":1639553379,"is_pvip":false,"replies":[{"id":"118692","content":"这几天我赶完手写vue源码的稿子和代码后会更新一版","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1639644371,"ip_address":"","comment_id":326528,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639553379","product_id":100094401,"comment_content":"大圣老师，这一节在https:&#47;&#47;github.com&#47;shengxinjing&#47;geektime-vue-course.git这个仓库里好像没有文中提到的代码，是还没有来得及更新吗？","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539223,"discussion_content":"这几天我赶完手写vue源码的稿子和代码后会更新一版","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639644371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3161270,"avatar":"","nickname":"Geek_5b510e","note":"","ucode":"00351BC1FE3243","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585664,"discussion_content":"大圣老师，还是没有找到啊，是没有更新吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661755306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324274,"user_name":"葱味黑咖啡","can_delete":false,"product_type":"c1","uid":2063970,"ip_address":"","ucode":"9BF75E8CCF8E0B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8YX35AFKL60uUNM5YGloEx8uDbv0VGB5VddYvqKDgPRiauyW1ggJIs9p6B7ad3AricFMZAp8ahAqP4FmzaTP1few/132","comment_is_top":false,"comment_ctime":1638353505,"is_pvip":true,"replies":[{"id":"118356","content":"localstorage或者网络接口中存储的权限数据，component保存的其实是字符串，也就是compoennt的名字","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1639400601,"ip_address":"","comment_id":324274,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638353505","product_id":100094401,"comment_content":"&quot;在页面刷新的时候，通过 src&#47;router&#47;index.js 入口文件中的 routes 配置，从 localStorage 中获取完整的路由信息&quot;。<br>老师，有一个问题，路由对象的component可以存储在localStorage中吗？localStorage应该是只能存字符串吧，把路由信息json化之后，component也无效了，这个怎么解决","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538355,"discussion_content":"localstorage或者网络接口中存储的权限数据，component保存的其实是字符串，也就是compoennt的名字","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323880,"user_name":"阿阳","can_delete":false,"product_type":"c1","uid":1165817,"ip_address":"","ucode":"20A35FB86B1C5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/c9/f9/39492855.jpg","comment_is_top":false,"comment_ctime":1638192540,"is_pvip":false,"replies":[{"id":"118366","content":"这里的userStore.log其实就是在login函数内部执行了登录方法","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1639401160,"ip_address":"","comment_id":323880,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638192540","product_id":100094401,"comment_content":"请问老师，在登录时这条语句 const {code, message} = await useStore.login(loginForm)，能解释详细一点嘛，不理解useStore.login()这种用法。","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538365,"discussion_content":"这里的userStore.log其实就是在login函数内部执行了登录方法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639401161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2279433,"avatar":"https://static001.geekbang.org/account/avatar/00/22/c8/09/b34b1473.jpg","nickname":"鱼腩","note":"","ucode":"54C97E73A75854","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537625,"discussion_content":"盲猜应该是vue store状态管理里面的Action/Mutation，通过loginForm对象里面的登录信息，到后台校对，返回解构 code ， message","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639123583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323038,"user_name":"Danny1","can_delete":false,"product_type":"c1","uid":1196402,"ip_address":"","ucode":"BBD581B38D8470","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/72/ecc49429.jpg","comment_is_top":false,"comment_ctime":1637715059,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637715059","product_id":100094401,"comment_content":"Mock那块需要改动vite 的配置吗？","like_count":0},{"had_liked":false,"id":322679,"user_name":"淡若清风过","can_delete":false,"product_type":"c1","uid":2816633,"ip_address":"","ucode":"A589310DD82EA7","user_header":"https://static001.geekbang.org/account/avatar/00/2a/fa/79/c5cfe88c.jpg","comment_is_top":false,"comment_ctime":1637548542,"is_pvip":false,"replies":[{"id":"118400","content":"试试maybeRef <br>type MaybeRef&lt;T&gt; = T | Ref&lt;T&gt;","user_name":"作者回复","user_name_real":"编辑","uid":"1003715","ctime":1639403834,"ip_address":"","comment_id":322679,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1637548542","product_id":100094401,"comment_content":"属性(property) Ref&lt;null&gt;.value: null这个怎么解决？<br>const p＝ref(null)<br><br>onMounted(() =&gt; {<br>  p.value.<br>  <br>})","like_count":0,"discussions":[{"author":{"id":1003715,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/50/c3/0aa50246.jpg","nickname":"花果山大圣","note":"","ucode":"25C0A36D628037","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538411,"discussion_content":"试试maybeRef \ntype MaybeRef&lt;T&gt; = T | Ref&lt;T&gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639403834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2279433,"avatar":"https://static001.geekbang.org/account/avatar/00/22/c8/09/b34b1473.jpg","nickname":"鱼腩","note":"","ucode":"54C97E73A75854","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537626,"discussion_content":"如果是TS的话，必须初始化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639123699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2816633,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/fa/79/c5cfe88c.jpg","nickname":"淡若清风过","note":"","ucode":"A589310DD82EA7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2279433,"avatar":"https://static001.geekbang.org/account/avatar/00/22/c8/09/b34b1473.jpg","nickname":"鱼腩","note":"","ucode":"54C97E73A75854","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":538024,"discussion_content":"怎么初始化？ref获取dom时一直这样，对象可能为null","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639302562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":537626,"ip_address":""},"score":538024,"extra":""}]}]}]}