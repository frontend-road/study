{"id":119497,"title":"09 | ZooKeeper API：Watch示例","content":"<p><strong>课件和Demo地址</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geekbang-zk-course\">https://gitee.com/geektime-geekbang/geekbang-zk-course</a></p>","comments":[{"had_liked":false,"id":135301,"user_name":"fomy","can_delete":false,"product_type":"c3","uid":1125834,"ip_address":"","ucode":"CD87EA03B1F327","user_header":"https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg","comment_is_top":false,"comment_ctime":1569120748,"is_pvip":false,"replies":[{"id":52037,"content":"这个demo是有点儿复杂。这是ZooKeeper官方给的第一个Java程序，我想大家最开始学ZooKeeper都会看到它，就用了它。\n\n你可以多看一下https:&#47;&#47;github.com&#47;yaojingguo&#47;geekbang-zk-course&#47;blob&#47;master&#47;src&#47;test&#47;java&#47;org&#47;yao&#47;WatcherTests.java。这个是我自己写的，比较适合入门。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1569248446,"ip_address":"","comment_id":135301,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"希望demo能写的简单一点吧","like_count":0,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468133,"discussion_content":"这个demo是有点儿复杂。这是ZooKeeper官方给的第一个Java程序，我想大家最开始学ZooKeeper都会看到它，就用了它。\n\n你可以多看一下https://github.com/yaojingguo/geekbang-zk-course/blob/master/src/test/java/org/yao/WatcherTests.java。这个是我自己写的，比较适合入门。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569248446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1924538,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eodyXx8Hsqtp7DYyKOgMLyRm0JhGFgheMPiaf4QYeVUUcMHpgZs2PQNxEIUMHqJpOZH2r6qlb8nrPg/132","nickname":"大兴","note":"","ucode":"DCFE7877AF6719","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332345,"discussion_content":"我看了一天,弄的不是很明白","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607162052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125656,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c3","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1566222183,"is_pvip":false,"replies":[{"id":47649,"content":"GitHub 的 ReadMe 文档里面有链接。","user_name":"编辑回复","user_name_real":"张浩","uid":1000075,"ctime":1566894274,"ip_address":"","comment_id":125656,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"演示的代码，能给提供下么？","like_count":0,"discussions":[{"author":{"id":1000075,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/8b/6ea91a1b.jpg","nickname":"Sean","note":"","ucode":"6D1A2F16FA4A41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463648,"discussion_content":"GitHub 的 ReadMe 文档里面有链接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566894274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366937,"user_name":"Pecan","can_delete":false,"product_type":"c3","uid":2020819,"ip_address":"陕西","ucode":"8C79F7EB11F415","user_header":"https://static001.geekbang.org/account/avatar/00/1e/d5/d3/1e85a3c4.jpg","comment_is_top":false,"comment_ctime":1674635362,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师好，watch和callBack两种回调方式的区别是什么呢","like_count":1},{"had_liked":false,"id":161939,"user_name":"北野哀","can_delete":false,"product_type":"c3","uid":1586502,"ip_address":"","ucode":"84EE2A6EF1BAA0","user_header":"https://static001.geekbang.org/account/avatar/00/18/35/46/19a35527.jpg","comment_is_top":false,"comment_ctime":1576409994,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师你好，我在mac上没有将 &#47;bin 配到环境变量里面。以下是我改过的 executor.sh:\n#!&#47;usr&#47;bin&#47;env bash\n&#47;usr&#47;local&#47;tools&#47;apache-zookeeper-3.5.6-bin&#47;bin&#47;zkEnv.sh\n\nexport CLASSPATH=&quot;build&#47;classes&#47;java&#47;main:$CLASSPATH&#47;bin&quot;\nmkdir -p data\njava org.yao.watchclient.Executor &quot;$@&quot;\n\n现在启动不起来，报这个错。请教老师怎么解决\n\n&#47;usr&#47;bin&#47;java\n错误: 找不到或无法加载主类 org.yao.watchclient.Executor\n ","like_count":1,"discussions":[{"author":{"id":1442588,"avatar":"https://static001.geekbang.org/account/avatar/00/16/03/1c/c9fe6738.jpg","nickname":"Kvicii.Y","note":"","ucode":"446BFA633569EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214742,"discussion_content":"请问解决了吗，我也是一样的。。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585230477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1623715,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c6/a3/2a780bc6.jpg","nickname":"强哥","note":"","ucode":"F062E874C5AFEB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":645923,"discussion_content":"我将zk安装目录下的Lib添加到环境classpath下就好使了，额外执行export CLASSPATH=&#34;/home/software/apache-zookeeper-3.9.2-bin/lib/*:$CLASSPATH&#34;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1716997524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309673,"user_name":"Geek_3c0a42","can_delete":false,"product_type":"c3","uid":2676433,"ip_address":"","ucode":"421EAC1D8401ED","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/gk0eWK7HXPic7q4YRjKeETXXOB66drcyLp8QmLeJWFJH9y2icft4S96gKAxmGDicjzcXE2AZ1ZsGOvF6DuZaMysbg/132","comment_is_top":false,"comment_ctime":1630297824,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"请问作者，src&#47;test&#47;java&#47;org&#47;yao&#47;WatcherTests.java文件，43行testWatchChildren方法，zk用getChildren方法监控&quot;&#47;father&quot; znode，getChildren方法 只触发NodeChildrenChanged事件，这个test case的watcher用的 143行 DefaultWatcher方法，DefaultWatcher只监听了SyncConnected，NodeCreated事件，请问testWatchChildren 这个case以什么用例触发，这里的含义是什么，又没注释。","like_count":0},{"had_liked":false,"id":258338,"user_name":"王建","can_delete":false,"product_type":"c3","uid":1153792,"ip_address":"","ucode":"68000818D8AA41","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/00/8c1b9631.jpg","comment_is_top":false,"comment_ctime":1604390570,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"server.1=127.0.0.1:3333:3334\nserver.2=127.0.0.1:4444:4445\nserver.3=127.0.0.1:5555:5556\n\n请问如果要支持IPv6这个应该怎么配置，zk什么版本才支持ipv6呢（因为ipv6地址是用冒号分割的）","like_count":0}]}