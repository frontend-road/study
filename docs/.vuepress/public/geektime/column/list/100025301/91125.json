{"id":91125,"title":"03 | å¤§è§„æ¨¡æ•°æ®å¤„ç†åˆä½“éªŒï¼šæ€æ ·å®ç°å¤§å‹ç”µå•†çƒ­é”€æ¦œï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä»Šå¤©æˆ‘è¦ä¸ä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯â€œæ€æ ·å®ç°å¤§å‹ç”µå•†çƒ­é”€æ¦œâ€ã€‚</p><p>æˆ‘åœ¨Googleé¢è¯•è¿‡å¾ˆå¤šä¼˜ç§€çš„å€™é€‰äººï¼Œåº”å¯¹æ™®é€šçš„ç¼–ç¨‹é—®é¢˜codingèƒ½åŠ›å¾ˆå¼ºï¼Œç®—æ³•æ•°æ®ç»“æ„ä¹Ÿåº”ç”¨å¾—ä¸é”™ã€‚</p><p>å¯æ˜¯å½“æˆ‘è¿½é—®æ•°æ®è§„æ¨¡å˜å¤§æ—¶è¯¥æ€ä¹ˆè®¾è®¡ç³»ç»Ÿï¼Œä»–ä»¬å´è¯´ä¸å‡ºæ‰€ä»¥ç„¶æ¥ã€‚è¿™è¯´æ˜ä»–ä»¬ç¼ºä¹å¿…å¤‡çš„è§„æ¨¡å¢é•¿çš„æŠ€æœ¯æ€ç»´ï¼ˆmindset of scalingï¼‰ã€‚è¿™ä¼šé™åˆ¶è¿™äº›å€™é€‰äººçš„èŒä¸šæˆé•¿ã€‚</p><p>å› ä¸ºäº§å“ä»1ä¸‡ç”¨æˆ·åˆ°1äº¿ç”¨æˆ·ï¼ŒæŠ€æœ¯å›¢é˜Ÿä»10ä¸ªäººåˆ°1000ä¸ªäººï¼Œä½ çš„æŠ€æœ¯è§„æ¨¡å’Œæ•°æ®è§„æ¨¡éƒ½ä¼šå®Œå…¨ä¸ä¸€æ ·ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±ä»¥å¤§å‹ç”µå•†çƒ­é”€æ¦œä¸ºä¾‹ï¼Œæ¥è°ˆä¸€è°ˆä»1ä¸‡ç”¨æˆ·åˆ°1äº¿ç”¨æˆ·ï¼Œä»GBæ•°æ®åˆ°PBæ•°æ®ç³»ç»Ÿï¼ŒæŠ€æœ¯æ€ç»´éœ€è¦æ€æ ·çš„è½¬å‹å‡çº§ï¼Ÿ</p><p>åŒæ ·çš„é—®é¢˜ä¸¾ä¸€åä¸‰ï¼Œå¯ä»¥åº”ç”¨åœ¨æ·˜å®çƒ­å–ï¼ŒAppæ’è¡Œæ¦œï¼ŒæŠ–éŸ³çƒ­é—¨ï¼Œç”šè‡³æ˜¯èƒ¡æ¶¦ç™¾å¯Œæ¦œï¼Œå› ä¸ºå®é™…ä¸Šä»–ä»¬èƒŒåéƒ½åº”ç”¨äº†ç›¸ä¼¼çš„å¤§è§„æ¨¡æ•°æ®å¤„ç†æŠ€æœ¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/46/ec/469707990cf33d24d8713efab8fe34ec.png?wh=900*1600\" alt=\"\"></p><p>çœŸæ­£çš„æ’åºç³»ç»Ÿéå¸¸å¤æ‚ï¼Œä»…ä»…æ˜¯ç”¨æ¥æ’åºçš„ç‰¹å¾ï¼ˆfeaturesï¼‰å°±éœ€è¦å¤šå¹´çš„è¿­ä»£è®¾è®¡ã€‚</p><p>ä¸ºäº†ä¾¿äºè¿™ä¸€è®²çš„è®¨è®ºï¼Œæˆ‘ä»¬æ¥æ„æƒ³ä¸€ä¸ªç®€åŒ–çš„ç©å…·é—®é¢˜ï¼Œæ¥å¸®åŠ©ä½ ç†è§£ã€‚</p><p>å‡è®¾ä½ çš„ç”µå•†ç½‘ç«™é”€å”®10äº¿ä»¶å•†å“ï¼Œå·²ç»è·Ÿè¸ªäº†ç½‘ç«™çš„é”€å”®è®°å½•ï¼šå•†å“idå’Œè´­ä¹°æ—¶é—´ {product_id, timestamp}ï¼Œæ•´ä¸ªäº¤æ˜“è®°å½•æ˜¯1000äº¿è¡Œæ•°æ®ï¼ŒTBçº§ã€‚ä½œä¸ºæŠ€æœ¯è´Ÿè´£äººï¼Œä½ ä¼šæ€æ ·è®¾è®¡ä¸€ä¸ªç³»ç»Ÿï¼Œæ ¹æ®é”€å”®è®°å½•ç»Ÿè®¡å»å¹´é”€é‡å‰10çš„å•†å“å‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬çš„æ•°æ®æ˜¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/bd/9d/bdafa7f74c568c107c38317e0a1a669d.png?wh=1031*582\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥æŠŠçƒ­é”€æ¦œæŒ‰ product_id æ’åä¸ºï¼š1, 2, 3ã€‚</p><h2>å°è§„æ¨¡çš„ç»å…¸ç®—æ³•</h2><p>å¦‚æœä¸Šè¿‡æå®¢æ—¶é—´çš„ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾ã€‹ï¼Œä½ å¯èƒ½ä¸€çœ¼å°±çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªé—®é¢˜çš„è§£æ³•åˆ†ä¸ºä¸¤æ­¥ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3e/af/3eaea261df4257f0cff4509d82f211af.png?wh=1992*638?wh=1992*638\" alt=\"\"></p><p>ç¬¬ä¸€æ­¥ï¼Œç»Ÿè®¡æ¯ä¸ªå•†å“çš„é”€é‡ã€‚ä½ å¯ä»¥ç”¨å“ˆå¸Œè¡¨ï¼ˆhashtableï¼‰æ•°æ®ç»“æ„æ¥è§£å†³ï¼Œæ˜¯ä¸€ä¸ªO(n)çš„ç®—æ³•ï¼Œè¿™é‡Œnæ˜¯1000äº¿ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œæ‰¾å‡ºé”€é‡å‰åï¼Œå¯ä»¥ç”¨ç»å…¸çš„Top Kç®—æ³•ï¼Œä¹Ÿæ˜¯O(n)çš„ç®—æ³•ã€‚</p><p>å¦‚æœä½ è€ƒè™‘åˆ°äº†è¿™äº›ï¼Œå…ˆæ­å–œä½ ç­”å¯¹äº†ã€‚</p><p>åœ¨å°è§„æ¨¡ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç¡®å®å®Œå…¨å¯ä»¥ç”¨ç»å…¸çš„ç®—æ³•ç®€æ´æ¼‚äº®åœ°è§£å†³ã€‚ä»¥Pythonç¼–ç¨‹çš„è¯å¯èƒ½æ˜¯ç±»ä¼¼è¿™æ ·çš„ï¼š</p><pre><code>def CountSales(sale_records):\n  &quot;&quot;&quot;Calculate number of sales for each product id.  \n  \n  Args:\n    sales_records: list of SaleRecord, SaleRecord is a named tuple,     \n      e.g. {product_id: â€œ1â€, timestamp: 1553721167}.\n  Returns:\n    dict of {product_id: num_of_sales}. E.g. {â€œ1â€: 1, â€œ2â€: 1}\n  &quot;&quot;&quot;\n  sales_count = {}\n  for record in sale_records:\n    sales_count[record[product_id]] += 1\n  \n  return sales_count\n\ndef TopSellingItems(sale_records, k=10):  \n  &quot;&quot;&quot;Calculate the best selling k products.  \n  \n  Args:\n    sales_records: list of SaleRecord, SaleRecord is a named tuple,   \n      e.g. {product_id: â€œ1â€, timestamp: 1553721167}.\n    K: num of top products you want to output.\n  Returns:\n    List of k product_id, sorted by num of sales.\n  &quot;&quot;&quot;\n  sales_count = CountSales(sale_records)\n  return heapq.nlargest(k, sales_count, key=sales_count.get)\n</code></pre><p>ä½†åœ¨ä¸€åˆ‡ç³»ç»Ÿä¸­ï¼Œéšç€å°ºåº¦çš„å˜å¤§ï¼Œå¾ˆå¤šæ–¹æ³•å°±ä¸å†é€‚ç”¨ã€‚</p><p>æ¯”å¦‚ï¼Œåœ¨å°å°ºåº¦ç»å…¸ç‰©ç†å­¦ä¸­é€‚ç”¨çš„ç‰›é¡¿åŠ›å­¦å…¬å¼æ˜¯è¿™æ ·çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d1/dd/d1baf9cb72b099990c0f0476a79be2dd.png?wh=236*82\" alt=\"\"></p><p>è¿™åœ¨é«˜é€Ÿå¼ºåŠ›çš„ç‰©ç†ç³»ç»Ÿä¸­å°±ä¸å†é€‚ç”¨ï¼Œåœ¨ç‹­ä¹‰ç›¸å¯¹è®ºä¸­æœ‰å¦å¤–çš„è¡¨è¾¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2c/f7/2c59194f8bebaecd88f5942bcccf75f7.png?wh=452*98\" alt=\"\"></p><p>åœ¨ç¤¾ä¼šç³»ç»Ÿä¸­ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç®¡ç†10äººå›¢é˜Ÿï¼Œå’Œæ²»ç†14äº¿äººå£çš„å›½å®¶ï¼Œå¤æ‚åº¦ä¹Ÿä¸å¯åŒæ—¥è€Œè¯­ã€‚</p><p>å…·ä½“åœ¨æˆ‘ä»¬è¿™ä¸ªé—®é¢˜ä¸­ï¼ŒåŒæ ·çš„Top Kç®—æ³•å½“æ•°æ®è§„æ¨¡å˜å¤§ä¼šé‡åˆ°å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</p><p>ç¬¬ä¸€ï¼Œå†…å­˜å ç”¨ã€‚</p><p>å¯¹äºTBçº§çš„äº¤æ˜“è®°å½•æ•°æ®ï¼Œå¾ˆéš¾æ‰¾åˆ°å•å°è®¡ç®—æœºå®¹çº³é‚£ä¹ˆå¤§çš„å“ˆå¸Œè¡¨äº†ã€‚ä½ å¯èƒ½æƒ³åˆ°ï¼Œé‚£æˆ‘ä¸è¦ç”¨å“ˆå¸Œè¡¨å»ç»Ÿè®¡å•†å“é”€å”®é‡äº†ï¼Œæˆ‘æŠŠé”€é‡è®¡æ•°æ”¾åœ¨ç£ç›˜é‡Œå®Œæˆå¥½äº†ã€‚</p><p>æ¯”å¦‚ï¼Œå°±ç”¨ä¸€ä¸ª1000äº¿è¡Œçš„æ–‡ä»¶æˆ–è€…è¡¨ï¼Œç„¶åå†æŠŠé”€é‡ç»Ÿè®¡ç»“æœä¸€è¡Œä¸€è¡Œè¯»è¿›åé¢çš„å †æ ‘/ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚ç†è®ºä¸Šå¬èµ·æ¥ä¸é”™ï¼Œå®é™…ä¸Šæ˜¯å¦çœŸçš„å¯è¡Œå‘¢ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸‹ä¸€ç‚¹ã€‚</p><p>ç¬¬äºŒï¼Œç£ç›˜I/Oç­‰å»¶æ—¶é—®é¢˜ã€‚</p><p>å½“æ•°æ®è§„æ¨¡å˜å¤§ï¼Œæˆ‘ä»¬éš¾ä»¥é¿å…åœ°éœ€è¦æŠŠä¸€äº›ä¸­é—´ç»“æœå­˜è¿›ç£ç›˜ï¼Œä»¥åº”å¯¹å•æ­¥ä»»åŠ¡å‡ºé”™ç­‰é—®é¢˜ã€‚ä¸€æ¬¡ç£ç›˜è¯»å–å¤§æ¦‚éœ€è¦10msçš„æ—¶é—´ã€‚</p><p>å¦‚æœæŒ‰ç…§ä¸Šä¸€ç‚¹æåˆ°çš„æ–‡ä»¶æ›¿ä»£æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä¸€ä¸ªO(n * log k)çš„ç®—æ³•ï¼Œå°±éœ€è¦10ms * 10^9 = 10 ^ 7 s = 115 å¤©çš„æ—¶é—´ã€‚ä½ å¯èƒ½éœ€è¦è´¾è·ƒäº­é™„ä½“ï¼Œæ‰èƒ½å¿½æ‚ è€æ¿æ¥å—è¿™æ ·çš„è®¾è®¡æ–¹æ¡ˆäº†ã€‚</p><p>è¿™äº›é—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿä½ å¯èƒ½å·²ç»æƒ³åˆ°ï¼Œå½“å•å°æœºå™¨å·²ç»æ— æ³•é€‚åº”æˆ‘ä»¬æ•°æ®æˆ–è€…é—®é¢˜çš„è§„æ¨¡ï¼Œæˆ‘ä»¬éœ€è¦æ¨ªå‘æ‰©å±•ã€‚</p><h2>å¤§è§„æ¨¡åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆ</h2><p>ä¹‹å‰çš„æ€è·¯ä¾ç„¶æ²¡é”™ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ¯ä¸€æ­¥ä»ç®€å•çš„å‡½æ•°ç®—æ³•ï¼Œå‡çº§ä¸ºè®¡ç®—é›†ç¾¤çš„åˆ†å¸ƒå¼ç®—æ³•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3e/af/3eaea261df4257f0cff4509d82f211af.png?wh=1992*638?wh=1992*638\" alt=\"\"></p><h3>ç»Ÿè®¡æ¯ä¸ªå•†å“çš„é”€é‡</h3><p>æˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€ä¸ªè®¡ç®—é›†ç¾¤ï¼Œå°±æ˜¯ç»Ÿè®¡å•†å“é”€é‡çš„é›†ç¾¤ã€‚</p><p>ä¾‹å¦‚ï¼Œ1000å°æœºå™¨ï¼Œæ¯å°æœºå™¨ä¸€æ¬¡å¯ä»¥å¤„ç†1ä¸‡æ¡é”€å”®è®°å½•ã€‚å¯¹äºæ¯å°æœºå™¨è€Œè¨€ï¼Œå®ƒçš„å•æ¬¡å¤„ç†åˆå›å½’åˆ°äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„ä¼ ç»Ÿç®—æ³•ï¼Œæ•°æ®è§„æ¨¡å¤§å¤§ç¼©å°ã€‚</p><p>ä¸‹å›¾å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå›¾ä¸­æ¯å°æœºå™¨è¾“å…¥æ˜¯2æ¡é”€å”®è®°å½•ï¼Œè¾“å‡ºæ˜¯å¯¹äºä»–ä»¬çš„æœ¬åœ°è¾“å…¥è€Œè¨€çš„äº§å“é”€é‡è®¡æ•°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8e/8a/8eeff3376743e886d5f2d481ca8ddb8a.jpg?wh=1626*1018\" alt=\"\"></p><h3>æ‰¾å‡ºé”€é‡å‰K</h3><p>æˆ‘ä»¬éœ€è¦çš„ç¬¬äºŒä¸ªè®¡ç®—é›†ç¾¤ï¼Œåˆ™æ˜¯æ‰¾å‡ºé”€é‡å‰åçš„é›†ç¾¤ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä¸å¦¨æŠŠé—®é¢˜æŠ½è±¡ä¸€ä¸‹ï¼ŒæŠ½è±¡å‡ºæ˜¯é”€é‡å‰Kçš„äº§å“ã€‚å› ä¸ºä½ çš„è€æ¿éšæ—¶å¯èƒ½æŠŠäº§å“éœ€æ±‚æ”¹æˆå‰20é”€é‡ï¼Œè€Œä¸æ˜¯å‰10äº†ã€‚</p><p>åœ¨ä¸Šä¸€ä¸ªç»Ÿè®¡é”€é‡é›†ç¾¤å¾—åˆ°çš„æ•°æ®è¾“å‡ºï¼Œå°†ä¼šæ˜¯æˆ‘ä»¬è¿™ä¸ªå¤„ç†æµç¨‹çš„è¾“å…¥ã€‚æ‰€ä»¥è¿™é‡Œéœ€è¦æŠŠåˆ†å¸ƒåœ¨å„ä¸ªæœºå™¨åˆ†æ•£çš„äº§å“é”€é‡æ±‡æ€»å‡ºæ¥ã€‚ä¾‹å¦‚ï¼ŒæŠŠæ‰€æœ‰product_id = 1çš„é”€é‡å…¨éƒ¨å åŠ ã€‚</p><p>ä¸‹å›¾ç¤ºä¾‹æ˜¯K = 1çš„æƒ…å†µï¼Œæ¯å°æœºå™¨å…ˆæŠŠæ‰€æœ‰product_id = 1çš„é”€é‡å åŠ åœ¨äº†ä¸€èµ·ï¼Œå†æ‰¾å‡ºè‡ªå·±æœºå™¨ä¸Šé”€é‡å‰K = 1çš„å•†å“ã€‚å¯ä»¥çœ‹åˆ°å¯¹äºæ¯å°æœºå™¨è€Œè¨€ï¼Œä»–ä»¬çš„è¾“å‡ºå°±æ˜¯æœ€ç»ˆæ’åå‰K = 1çš„å•†å“å€™é€‰è€…ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/38/fc/38933e25ca315bd56321753573d5bbfc.jpg?wh=1616*1010\" alt=\"\"></p><h3>æ±‡æ€»æœ€ç»ˆç»“æœ</h3><p>åˆ°äº†æœ€åä¸€æ­¥ï¼Œä½ éœ€è¦æŠŠåœ¨â€œé”€é‡å‰Ké›†ç¾¤â€ä¸­çš„ç»“æœæ±‡æ€»å‡ºæ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»æ‰€æœ‰æ’åå‰K=1çš„å•†å“å€™é€‰è€…ä¸­æ‰¾å‡ºçœŸæ­£çš„é”€é‡å‰K=1çš„å•†å“ã€‚</p><p>è¿™æ—¶å€™å®Œå…¨å¯ä»¥ç”¨å•ä¸€æœºå™¨è§£å†³äº†ã€‚å› ä¸ºå®é™…ä¸Šä½ æ±‡æ€»çš„å°±æ˜¯è¿™1000å°æœºå™¨çš„ç»“æœï¼Œè§„æ¨¡è¶³å¤Ÿå°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/ab/cab28c9e3ba9031072a4e6949328bbab.jpg?wh=2127*877\" alt=\"\"></p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å·²ç»ä½“ä¼šåˆ°å¤„ç†è¶…å¤§è§„æ¨¡æ•°æ®çš„ç³»ç»Ÿæ˜¯å¾ˆå¤æ‚çš„ã€‚</p><p>å½“ä½ è¾›è¾›è‹¦è‹¦è®¾è®¡äº†åº”å¯¹1äº¿ç”¨æˆ·çš„æ•°æ®å¤„ç†ç³»ç»Ÿæ—¶ï¼Œå¯èƒ½ä½ å°±è¦é¢ä¸´å¦ä¸€ä¸ªç»´åº¦çš„è§„æ¨¡åŒ–ï¼ˆscalingï¼‰ã€‚é‚£å°±æ˜¯åº”ç”¨åœºæ™¯æ•°é‡ä»1ä¸ªå˜æˆ1000ä¸ªã€‚æ¯ä¸€æ¬¡éƒ½ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯å•ç‹¬è®¾è®¡åˆ†å¸ƒå¼é›†ç¾¤ï¼Œæ‹›å‹Ÿæ–°çš„å·¥ç¨‹å¸ˆç»´æŠ¤å˜å¾—ä¸å†â€œå¯æŒç»­å‘å±•â€ã€‚</p><p>è¿™æ—¶ï¼Œä½ éœ€è¦ä¸€ä¸ªæ•°æ®å¤„ç†çš„<strong>æ¡†æ¶</strong>ã€‚</p><h2>å¤§è§„æ¨¡æ•°æ®å¤„ç†æ¡†æ¶çš„åŠŸèƒ½è¦æ±‚</h2><p>åœ¨ç¬¬äºŒè®²â€œMapReduceåè°ä¸»æ²‰æµ®ï¼šæ€æ ·è®¾è®¡ç°ä»£å¤§è§„æ¨¡æ•°æ®å¤„ç†æŠ€æœ¯â€ä¸­ï¼Œæˆ‘ä»¬å¯¹äºæ•°æ®å¤„ç†<strong>æ¡†æ¶</strong>å·²ç»æœ‰äº†åŸºæœ¬çš„æ–¹æ¡ˆã€‚</p><p>ä»Šå¤©è¿™ä¸ªå®é™…çš„ä¾‹å­å…¶å®ä¸ºæˆ‘ä»¬çš„è®¾è®¡å¢åŠ äº†æ–°çš„æŒ‘æˆ˜ã€‚</p><p>å¾ˆå¤šäººé¢å¯¹é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯æ‰¾æœ‰æ²¡æœ‰å¼€æºæŠ€æœ¯å¯ä»¥ç”¨ä¸€ä¸‹ã€‚</p><p>ä½†æˆ‘ç»å¸¸è¯´æœåˆ«äººä¸è¦å…ˆå»çœ‹ä»€ä¹ˆå¼€æºæŠ€æœ¯å¯ä»¥ç”¨ï¼Œè€Œæ˜¯ä»è‡ªå·±é¢å¯¹çš„é—®é¢˜å‡ºå‘ç‹¬ç«‹æ€è€ƒï¼Œå¿˜æ‰MapReduceï¼Œå¿˜æ‰Apache Sparkï¼Œå¿˜æ‰Apache Beamã€‚</p><p>å¦‚æœè¿™ä¸ªä¸–ç•Œä¸€æ— æ‰€æœ‰ï¼Œä½ ä¼šè®¾è®¡æ€æ ·çš„å¤§è§„æ¨¡æ•°æ®å¤„ç†æ¡†æ¶ï¼Ÿä½ è¦ç»å¸¸åšä¸€äº›æ€ç»´å®éªŒï¼Œè¯•è¯•å¸¦é¢†ä¸€ä¸‹æŠ€æœ¯çš„å‘å±•ï¼Œè€Œä¸æ˜¯æ°¸è¿œè·Ÿéšåˆ«äººçš„æŠ€æœ¯æ–¹å‘ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œä¸¤ä¸ªæœ€åŸºæœ¬çš„éœ€æ±‚æ˜¯ï¼š</p><ol>\n<li>\n<p>é«˜åº¦æŠ½è±¡çš„æ•°æ®å¤„ç†æµç¨‹æè¿°è¯­è¨€ã€‚ä½œä¸ºå°ç™½ç”¨æˆ·ï¼Œæˆ‘è‚¯å®šå†ä¹Ÿä¸æƒ³ä¸€ä¸€é…ç½®åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¯å°æœºå™¨äº†ã€‚ä½œä¸ºæ¡†æ¶ä½¿ç”¨è€…ï¼Œæˆ‘å¸Œæœ›æ¡†æ¶æ˜¯éå¸¸ç®€å•çš„ï¼Œèƒ½å¤Ÿç”¨å‡ è¡Œä»£ç æŠŠä¸šåŠ¡é€»è¾‘æè¿°æ¸…æ¥šã€‚</p>\n</li>\n<li>\n<p>æ ¹æ®æè¿°çš„æ•°æ®å¤„ç†æµç¨‹ï¼Œè‡ªåŠ¨åŒ–çš„ä»»åŠ¡åˆ†é…ä¼˜åŒ–ã€‚è¿™ä¸ªæ¡†æ¶èƒŒåçš„å¼•æ“éœ€è¦è¶³å¤Ÿæ™ºèƒ½ï¼Œç®€å•åœ°è¯´ï¼Œè¦æŠŠé‚£äº›æœ¬æ¥æ‰‹åŠ¨é…ç½®çš„ç³»ç»Ÿï¼Œè¿›è¡Œè‡ªåŠ¨ä»»åŠ¡åˆ†é…ã€‚</p>\n</li>\n</ol><p>é‚£ä¹ˆç†æƒ³çŠ¶å†µæ˜¯ä»€ä¹ˆï¼Ÿå¯¹äºä¸Šé¢çš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä½œä¸ºç”¨æˆ·åªæƒ³å†™ä¸¤è¡Œä»£ç ã€‚</p><p>ç¬¬ä¸€è¡Œä»£ç ï¼š</p><pre><code>sales_count = sale_records.Count()\n</code></pre><p>è¿™æ ·ç®€å•çš„æè¿°ï¼Œåœ¨æˆ‘ä»¬æ¡†æ¶è®¾è®¡å±‚é¢ï¼Œå°±è¦èƒ½è‡ªåŠ¨æ„å»ºæˆä¸Šæ–‡æè¿°çš„â€œé”€é‡ç»Ÿè®¡è®¡ç®—é›†ç¾¤â€ã€‚</p><p>ç¬¬äºŒè¡Œä»£ç </p><pre><code>top_k_sales = sales_count.TopK(k)\n</code></pre><p>è¿™è¡Œä»£ç éœ€è¦è‡ªåŠ¨æ„å»ºæˆä¸Šæ–‡æè¿°çš„â€œæ‰¾å‡ºé”€é‡å‰Ké›†ç¾¤â€ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ èƒ½å‘ç°è¿™å¹¶ä¸å¤æ‚ã€‚æˆ‘ä»¬åˆ°è¿™é‡Œå°±å·²ç»åŸºæœ¬ä¸ŠæŠŠç°ä»£å¤§è§„æ¨¡æ•°æ®å¤„ç†æ¶æ„çš„é¡¶å±‚æ„é€ æŒæ¡äº†ã€‚è€ŒèƒŒåçš„å…·ä½“å®ç°ï¼Œæˆ‘ä¼šåœ¨åé¢çš„ä¸“æ ç« èŠ‚ä¸­ä¸ºä½ ä¸€ä¸€æ­æ™“ã€‚</p><h2>å°ç»“</h2><p>è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬ç²—æµ…åœ°åˆ†æäº†ä¸€ä¸ªç”µå•†æ’è¡Œæ¦œçš„æ•°æ®å¤„ç†ä¾‹å­ã€‚</p><p>ä»GBæ•°æ®åˆ°TBæ•°æ®ï¼Œæˆ‘ä»¬ä»å°è§„æ¨¡ç®—æ³•å‡çº§åˆ°äº†åˆ†å¸ƒå¼å¤„ç†çš„è®¾è®¡æ–¹æ¡ˆï¼›ä»å•ä¸€TBæ•°æ®åœºæ™¯åˆ°1000ä¸ªåº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬æ¢ç´¢äº†å¤§è§„æ¨¡æ•°æ®å¤„ç†æ¡†æ¶çš„è®¾è®¡ã€‚</p><p>è¿™äº›éƒ½æ˜¯ä¸ºäº†å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£åé¢æ‰€è¦è®²çš„æ‰€æœ‰çŸ¥è¯†ã€‚æ¯”å¦‚ï¼Œä¸ºä»€ä¹ˆä¼ ç»Ÿç®—æ³•ä¸å†å¥æ•ˆï¼Ÿä¸ºä»€ä¹ˆè¦å»å€ŸåŠ©æŠ½è±¡çš„æ•°æ®å¤„ç†æè¿°è¯­è¨€ï¼Ÿå¸Œæœ›åœ¨åé¢çš„å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œä½ èƒ½ä¸€ç›´å¸¦ç€è¿™äº›é—®é¢˜å‡ºå‘ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>åœ¨ä½ çš„å·¥ä½œä¸­ï¼Œæœ‰æ²¡æœ‰éšç€æ•°æ®è§„æ¨¡å˜å¤§ï¼Œç³»ç»Ÿå‡ºé—®é¢˜çš„æƒ…å†µï¼Œä½ åˆæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠè‡ªå·±çš„æƒ³æ³•å†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","neighbors":{"left":{"article_title":"02 | MapReduceåè°ä¸»æ²‰æµ®ï¼šæ€æ ·è®¾è®¡ä¸‹ä¸€ä»£æ•°æ®å¤„ç†æŠ€æœ¯ï¼Ÿ","id":90533},"right":{"article_title":"04 | åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆä¸Šï¼‰ï¼šå­¦ä¼šç”¨æœåŠ¡ç­‰çº§åè®®SLAæ¥è¯„ä¼°ä½ çš„ç³»ç»Ÿ","id":91166}},"comments":[{"had_liked":false,"id":88293,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1555902193,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"177649561329","product_id":100025301,"comment_content":"å¥½å¤šå¹´å‰è¿˜æœªæ¥è§¦å¤§æ•°æ®æ—¶ï¼Œå†™è¿‡æ—¥å¿—é‡‡é›†ç»Ÿè®¡å„æ¥å£è¯·æ±‚æŠ¥è¡¨åŠpuvçš„è„šæœ¬ï¼Œç»å†äº†å‡ ä¸ªé˜¶æ®µã€‚<br>1. æœ€åˆæ˜¯æ±‡æ€»æ‰€æœ‰æ—¥å¿—åˆ°ä¸€å°æœåŠ¡å™¨ï¼Œåœ¨å¤„ç†æ—¥å¿—ï¼Œæµ‹è¯•ç¯å¢ƒæ²¡é—®é¢˜ï¼Œä¸Šç”Ÿäº§è·‘èµ·æ¥å°±å‡ ä¸ªå°æ—¶ã€‚<br>2. åæ¥åˆ†åˆ°WebæœåŠ¡å™¨å„è‡ªå¤„ç†æ•°æ®ï¼Œæ—¶é—´ç¼©çŸ­äº†ï¼Œä½†æ˜¯æ±‡æ€»æ•°æ®å¶å°”ä¼šæœ‰é—®é¢˜ã€‚<br>3. å°†æ•°æ®å†™å…¥åˆ°æ•°æ®åº“ï¼Œè§£å†³æ±‡æ€»æ•°æ®é—®é¢˜ã€‚ä½†æ˜¯å•è¡¨æ•°æ®é‡è¿‡å¤§ï¼Œç»Ÿè®¡åˆå¾ˆæ…¢ã€‚<br>4. æŒ‰å¤©åˆ†è¡¨è§£å†³æ•°æ®é‡é—®é¢˜ï¼Œæœ€åå°±è¿™ä¹ˆä¸€ç›´è¿è¡Œä¸‹å»äº†ã€‚<br><br>è¿™æ®µç»å†å…¶å®å¾ˆæ™®é€šï¼Œä½†ä¹Ÿç¡®å®è®©æˆ‘æ›´è½»æ¾çš„å­¦ä¹ å’Œç†è§£å¤§æ•°æ®ã€‚å½“æˆ‘å­¦åˆ°mapreduceå†…å®¹çš„æ—¶å€™ï¼Œå›å¿†èµ·è¿™æ®µç»å†ï¼Œè®©æˆ‘å¾ˆå®¹æ˜“å°±æ¥å—äº†mapreduceçš„åˆ†æ²»æ€æƒ³ã€‚<br><br>å°±åƒçœ‹åˆ°hbaseçš„æ—¶å€™ï¼Œæˆ‘çš„ç†è§£å®ƒå°±æ˜¯åœ¨å®ç°æ•°æ®çš„å¯»å€ã€ä¸æ–­çš„æ‹†åˆ†&#47;åˆå¹¶è¡¨ï¼Œä½†æ˜¯åŸæ¥çš„äººå·¥æ“ä½œå˜æˆç°åœ¨è‡ªåŠ¨åŒ–æ“ä½œã€‚","like_count":42,"discussions":[{"author":{"id":1393975,"avatar":"https://static001.geekbang.org/account/avatar/00/15/45/37/7125afa6.jpg","nickname":"jeff","note":"","ucode":"DBF6BC727D4E77","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531944,"discussion_content":"ES /CLICKGHOUSE + kibana","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637478104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88180,"user_name":"Liu C.","can_delete":false,"product_type":"c1","uid":1504607,"ip_address":"","ucode":"29F3988DD8128A","user_header":"https://static001.geekbang.org/account/avatar/00/16/f5/5f/217c6a14.jpg","comment_is_top":false,"comment_ctime":1555888389,"is_pvip":false,"replies":[{"id":"31700","content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_88e0d7","uid":"1503187","ctime":1555889259,"ip_address":"","comment_id":88180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"138994841861","product_id":100025301,"comment_content":"æœ‰ä¸€æ¬¡å¤„ç†ä¸€ä¸ªéå¸¸é«˜ç»´çš„featureçŸ©é˜µï¼Œè¦ç»™å®ƒé™ç»´ï¼Œä½†æ‰‹å¤´çš„ç”µè„‘cpuå’Œå†…å­˜éƒ½ä¸å¤Ÿå¥½ã€‚äºæ˜¯æˆ‘ç”¨äº†éå¸¸hackçš„æ‰‹æ®µï¼šå…ˆä½¿ç”¨random projectionç®—æ³•é™ä½ä¸€å®šç»´åº¦ï¼Œè¿™æ˜¯ä¸€ä¸ªçº¯çŸ©é˜µä¹˜æ³•ï¼Œå¯ä»¥åˆ†å—æ”¾å…¥å†…å­˜è®¡ç®—ã€‚ä¹‹åå‰©ä½™çš„ç»´åº¦è¿˜æ˜¯æœ‰äº›å¤§ï¼Œäºæ˜¯æˆ‘æŠŠfeatureæ‹†æˆå‡ ç»„ï¼Œå¯¹æ¯ç»„åˆ†åˆ«åšpcaï¼Œä¹‹åå†é€‰å‡ºæ¯ç»„æœ€å¤§çš„ä¸»æˆåˆ†æ‹¼èµ·æ¥ï¼Œå°±å®Œæˆäº†é™ç»´ã€‚<br>","like_count":33,"discussions":[{"author":{"id":1503187,"avatar":"","nickname":"Geek_88e0d7","note":"","ucode":"3E2596F3EB9165","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447759,"discussion_content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555889259,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89981,"user_name":"bwv825","can_delete":false,"product_type":"c1","uid":1508445,"ip_address":"","ucode":"23447AD4E864E0","user_header":"https://static001.geekbang.org/account/avatar/00/17/04/5d/259d1768.jpg","comment_is_top":false,"comment_ctime":1556356420,"is_pvip":false,"discussion_count":9,"race_medal":0,"score":"65980865860","product_id":100025301,"comment_content":"Top 1 çš„æƒ…å†µï¼Œåªç»Ÿè®¡æ¯å°æœºå™¨çš„top 1æ˜¯ä¸æ˜¯å¯èƒ½ä¼šä¸å‡†ç¡®å‘¢ï¼Ÿæ¯”å¦‚æ•°æ®æŒ‰æ—¶é—´æ®µåˆ†ç‰‡ï¼ŒæŸä¸ªå•†å“é”€é‡å¾ˆå¤§å¾ˆç¨³å®šï¼Œç´¯è®¡æ€»æ•°ç¬¬ä¸€ä½†å¾ˆå°‘æ˜¯top 1, å› ä¸ºå„ä¸ªæ—¶é—´æ®µéƒ½æœ‰ä¸åŒçš„çˆ†æ¬¾... ","like_count":16,"discussions":[{"author":{"id":1204919,"avatar":"https://static001.geekbang.org/account/avatar/00/12/62/b7/1fed6f02.jpg","nickname":"é†‡é›¾","note":"","ucode":"4A4C27B530FA30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":33039,"discussion_content":"ä¸æ˜¯ç›´æ¥æ¯å°æœºå™¨å–TOP Kï¼Œè€Œæ˜¯æ¯å°æœºå™¨å¯¹æ•°æ® combine åï¼Œå°†ç»“æœé€šè¿‡ hash æ˜ å°„åˆ°å¦å¤–çš„é›†ç¾¤ï¼Œè¿™æ ·æ‰€æœ‰ç›¸åŒ id çš„æ•°æ®å°±åœ¨åŒä¸€å°æœºå™¨ï¼Œcombine åå† sort å–æ¯å°æœºå™¨çš„ TOP Kã€‚è¿™æ˜¯æˆ‘çš„ç†è§£","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1571073748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1504652,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/8c/82fb5890.jpg","nickname":"æŠ±å°æ˜Ÿ","note":"","ucode":"BA7B0DAFDA4AF5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299595,"discussion_content":"ä¸»è¦æ˜¯ä¸ä¼šæŒ‰æ—¶é—´åˆ†ç‰‡ï¼Œä¸å‡åŒ€ï¼Œä¸€èˆ¬æŒ‰IDåˆ†ç‰‡ï¼Œè¦shuffle","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597744523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1504652,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/8c/82fb5890.jpg","nickname":"æŠ±å°æ˜Ÿ","note":"","ucode":"BA7B0DAFDA4AF5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299593,"discussion_content":"æ€»é”€é‡ä¼šç»Ÿè®¡è¿›å»çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597744231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1191143,"avatar":"https://static001.geekbang.org/account/avatar/00/12/2c/e7/3c0eba8b.jpg","nickname":"wuhulala","note":"","ucode":"6DBF2C9E19B930","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224628,"discussion_content":"æœ‰shuffleè¿‡ç¨‹çš„ å°±æ˜¯ä¸€ä¸ªkeyçš„ä¿è¯åœ¨ä¸€å°æœºå™¨ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586320649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1876363,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/C5DBpgTvQ6ianXxhWia1QTQEJgQ1Pg1bRm1SwxxtDut0Pkzic6ImicQH6dMT3Uu7ibUbBL97zKkianNDKfheiaLHrCbyA/132","nickname":"æ‰˜å°¼å“ˆæ ¹å“’è¥¿","note":"","ucode":"809066A0E477A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192687,"discussion_content":"åè¯æ³•ï¼Œå‡è®¾æŸä¸ªidæ˜¯æœ€ç»ˆçš„topkï¼Œé‚£å®ƒè‡³å°‘å¿…å®šæ˜¯ä¸€ä¸ªlocal æœºå™¨çš„top kï¼Œä¸ç„¶æ‰€æœ‰æœºå™¨æ±‡æ€»ä¹‹åï¼Œä¸å¯èƒ½æ˜¯topkã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583077912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1504652,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/8c/82fb5890.jpg","nickname":"æŠ±å°æ˜Ÿ","note":"","ucode":"BA7B0DAFDA4AF5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1876363,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/C5DBpgTvQ6ianXxhWia1QTQEJgQ1Pg1bRm1SwxxtDut0Pkzic6ImicQH6dMT3Uu7ibUbBL97zKkianNDKfheiaLHrCbyA/132","nickname":"æ‰˜å°¼å“ˆæ ¹å“’è¥¿","note":"","ucode":"809066A0E477A6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299594,"discussion_content":"ä¸ä¸€å®šï¼Œå‡è®¾Aå•†å“ç¨³å®štop2ï¼Œè€Œtop1ç»å¸¸å˜ï¼Œæœ€åæ±‡æ€»Aä¹Ÿå¯èƒ½æ˜¯top1ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1597744318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":192687,"ip_address":""},"score":299594,"extra":""}]},{"author":{"id":1640346,"avatar":"","nickname":"ä½™æ™–","note":"","ucode":"9673C8C65BAA16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7243,"discussion_content":"æœ‰åŒæ ·çš„ç–‘é—®ï¼Œæ¯å°æœºå™¨çš„TOP K åšä¸ºæ±‡æ€»æœºå™¨çš„è¾“å…¥ï¼Œè¿™ä¸ªä¸ä¸¥è°¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567427403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1204919,"avatar":"https://static001.geekbang.org/account/avatar/00/12/62/b7/1fed6f02.jpg","nickname":"é†‡é›¾","note":"","ucode":"4A4C27B530FA30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1640346,"avatar":"","nickname":"ä½™æ™–","note":"","ucode":"9673C8C65BAA16","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":33038,"discussion_content":"ä¸æ˜¯ç›´æ¥æ¯å°æœºå™¨å–TOP Kï¼Œè€Œæ˜¯æ¯å°æœºå™¨å¯¹æ•°æ® combine åï¼Œå°†ç»“æœé€šè¿‡ hash æ˜ å°„åˆ°å¦å¤–çš„é›†ç¾¤ï¼Œè¿™æ ·æ‰€æœ‰ç›¸åŒ id çš„æ•°æ®å°±åœ¨åŒä¸€å°æœºå™¨ï¼Œcombine åå† sort å–æ¯å°æœºå™¨çš„ TOP Kã€‚è¿™æ˜¯æˆ‘çš„ç†è§£","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1571073732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":7243,"ip_address":""},"score":33038,"extra":""}]},{"author":{"id":1323362,"avatar":"https://static001.geekbang.org/account/avatar/00/14/31/62/103e276b.jpg","nickname":"å°ç°ç°zyh","note":"","ucode":"47C5B1C7002FCD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5619,"discussion_content":"æœ‰åŒæ ·çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566385831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88260,"user_name":"Mr Zhuo","can_delete":false,"product_type":"c1","uid":1243980,"ip_address":"","ucode":"821A7AA3825D85","user_header":"https://static001.geekbang.org/account/avatar/00/12/fb/4c/dc35efce.jpg","comment_is_top":false,"comment_ctime":1555901455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57390476303","product_id":100025301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘ç›®å‰æ˜¯åšNLPè½åœ°çš„ï¼Œæœ¬æ¥æ˜¯ä½œä¸ºè¡¥å……çŸ¥è¯†å­¦çš„è¿™ä¸ªä¸“æ ï¼Œä½†æ˜¯å­¦äº†è¿™å‡ èŠ‚åå‘ç°è¿™ä¸ªæ–¹å‘å¾ˆæœ‰æ½œåŠ›ï¼Œä¹Ÿå¾ˆæ„Ÿå…´è¶£ã€‚å¦å¤–ç”±äºä½ ä»¬googleçš„BERTæ¨ªç©ºå‡ºä¸–ï¼Œæ„Ÿè§‰NLPæ–¹å‘çš„ä¸ªäººå‘å±•æœ‰äº›è¿·èŒ«ï¼Œæ‰€ä»¥æƒ³è¯·é—®è€å¸ˆï¼Œå¯¹äºä¸“æ å†…å®¹å’ŒNLPçš„ç»“åˆï¼Œåœ¨æœªæ¥å‘å±•æœ‰æ²¡æœ‰å¥½çš„å»ºè®®å‘¢ï¼Ÿ","like_count":14},{"had_liked":false,"id":88837,"user_name":"å­™ç¨šæ˜Š","can_delete":false,"product_type":"c1","uid":1010660,"ip_address":"","ucode":"44283BA4A577B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/e4/afacba1c.jpg","comment_is_top":false,"comment_ctime":1556010735,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53095618287","product_id":100025301,"comment_content":"æ•°æ®é‡ä¸€å¤§ï¼Œæœ€å¸¸è§çš„é—®é¢˜é™¤äº†å„ç§exceptionï¼Œå°±æ˜¯key å€¼åˆ†å¸ƒä¸å‡è¡¡ã€‚ç”µå•†ä¸€èˆ¬éƒ½æ˜¯é•¿å°¾çš„ï¼Œå°‘é‡çš„item å æ®å¤§å¤šæ•°è´­ä¹°é‡ï¼Œå¾ˆå®¹æ˜“å‘é€æ•°æ®å€¾æ–œï¼Œéœ€è¦è®¾è®¡æ›´æ–°çš„hash-sharding æ–¹æ³•","like_count":11},{"had_liked":false,"id":88405,"user_name":"Kev1n","can_delete":false,"product_type":"c1","uid":1507624,"ip_address":"","ucode":"A066DDA82F98C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/01/28/56410b04.jpg","comment_is_top":false,"comment_ctime":1555916846,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48800557102","product_id":100025301,"comment_content":"ä¸ªäººç»éªŒï¼Œæ‹†åˆ†ï¼Œå¤åˆ¶ï¼Œå¼‚æ­¥ï¼Œå¹¶è¡Œï¼Œæ˜¯å¤§è§„æ¨¡æ•°æ®å¤„ç†å’Œåº”ç”¨æ¶æ„çš„å¸¸è§æ‰‹æ®µï¼Œä¸€è‡´æ€§æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‚å½“å¦¥å","like_count":11},{"had_liked":false,"id":88469,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1555925606,"is_pvip":false,"replies":[{"id":"31739","content":"ä½ è¿™æ¯”å–»å¾ˆå±Œ","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1555929434,"ip_address":"","comment_id":88469,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44505598566","product_id":100025301,"comment_content":"åˆ†è§£æ³•â€¦åƒå‰é±¼é‚£æ ·ï¼Œä¸€æ¡ä¸€å£åƒä¸ä¸‹å°±åˆ‡æˆå—ï¼Œå—ä¸€å£åƒè¿˜å¤§ï¼Œæœ‰é£é™©ï¼Œå†å°±å†ç”¨ç­·å­åˆ†å°â€¦<br>å…³é”®é—®é¢˜æ˜¯æ€ä¹ˆåˆ‡ï¼Œåˆ‡å¤šå¤§ï¼Ÿæ€ä¹ˆä¸å…¨åˆ‡ç¢ï¼Œè®©å®ƒå®Œæ•´çš„ï¼Œè®©äººçŸ¥é“æ˜¯æ¡é±¼ğŸ˜„","like_count":10,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447806,"discussion_content":"ä½ è¿™æ¯”å–»å¾ˆå±Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555929434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88238,"user_name":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","can_delete":false,"product_type":"c1","uid":1132661,"ip_address":"","ucode":"C4C9915866E769","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","comment_is_top":false,"comment_ctime":1555899363,"is_pvip":false,"replies":[{"id":"31785","content":"è¿™ä¸ªå›¾é‡Œé¢æ˜¯æŒ‰ç…§product_idåˆ†ç»„äº†ï¼Œæ‰€ä»¥æ‰€æœ‰product id =1çš„éƒ½å½’ç¬¬ä¸€ä¸ªæœºå™¨","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1555988377,"ip_address":"","comment_id":88238,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40210605027","product_id":100025301,"comment_content":"ä½œè€…å¥½ï¼æ‰¾å‡ºå‰Kä¸ªé›†ç¾¤å°èŠ‚é‡Œé¢çš„ç¬¬ä¸€ä¸ªè®¡ç®—é›†ç¾¤çš„ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼ˆæœºå™¨ï¼‰ï¼Œæ˜¯å¦åº”è¯¥åƒç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸€æ ·è®¡ç®—product_id=1çš„æ‰€æœ‰è®°å½•ã€‚æ–‡ä¸­å›¾ç¤ºè²Œä¼¼åªæœ‰ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è®¡ç®—äº†ã€‚è¯·ä½œè€…æŸ¥è¯ã€‚","like_count":10,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447778,"discussion_content":"è¿™ä¸ªå›¾é‡Œé¢æ˜¯æŒ‰ç…§product_idåˆ†ç»„äº†ï¼Œæ‰€ä»¥æ‰€æœ‰product id =1çš„éƒ½å½’ç¬¬ä¸€ä¸ªæœºå™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555988377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88840,"user_name":"å­™ç¨šæ˜Š","can_delete":false,"product_type":"c1","uid":1010660,"ip_address":"","ucode":"44283BA4A577B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/e4/afacba1c.jpg","comment_is_top":false,"comment_ctime":1556011195,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"35915749563","product_id":100025301,"comment_content":"æˆ‘ä»¬åœ¨åšå•†å“è®¢å•ç»Ÿè®¡çš„æ—¶å€™ï¼Œä¼šæŒ‰itemid + order year + order month å¯¹è®¢å•åšhashæ¥åšgroup çš„ keyï¼Œåˆ†å‰²æˆæ›´å°å—ï¼Œé˜²æ­¢popular item å †ç§¯é€ æˆçš„ç“¶é¢ˆ","like_count":9,"discussions":[{"author":{"id":2050590,"avatar":"","nickname":"æ¢§æ¡è¿˜æ˜¯é‚£æ£µæ¢§æ¡","note":"","ucode":"01BE6B75FC0C7E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289682,"discussion_content":"å³ä¾¿æŒ‰å¹´æœˆåˆ†å‰²ï¼Œçƒ­é”€çš„äº§å“çš„è®¢å•ç›¸æ¯”äºå…¶ä»–äº§å“çš„è®¢å•è¿˜æ˜¯ä¼šå¤šå¾ˆå¤šå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594178090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199669,"discussion_content":"æœ‰æ²¡æœ‰è€ƒè™‘è¿‡ç”¨item id+ order id æ¥åšhash? order year/monthåº”è¯¥è¿˜æ˜¯æœ‰æ˜æ˜¾çš„ä¸å‡åŒ€åˆ†å¸ƒçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583596461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89047,"user_name":"leeon","can_delete":false,"product_type":"c1","uid":1083723,"ip_address":"","ucode":"74C23558036552","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/4b/56d290f5.jpg","comment_is_top":false,"comment_ctime":1556068913,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31620839985","product_id":100025301,"comment_content":"å¤§è§„æ¨¡çš„topkåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“å¼•å‘æ•°æ®å€¾æ–œçš„é—®é¢˜ï¼Œåœ¨å®é™…ä¸šåŠ¡é‡Œï¼Œè®¡ç®—çš„ä¼˜åŒ–æ˜¯ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™ä»æ•°æ®å±‚é¢å»ä¼˜åŒ–ä¹Ÿä¼šæœ‰æ›´å¥½çš„æ•ˆæœï¼Œä»¥æ¦œå•ä¸ºä¾‹ï¼Œå¯ä»¥åœ¨æ—¶é—´ç»´åº¦å’Œåœ°åŸŸä¸ºåº¦å»æ‹†è§£æ•°æ®ï¼Œå…ˆå°èšå†å¤§èš","like_count":7},{"had_liked":false,"id":88810,"user_name":"Codelife","can_delete":false,"product_type":"c1","uid":1041421,"ip_address":"","ucode":"10458683978083","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLhMtBwGqqmyhxp5uaDTvvp18iaalQj8qHv6u8rv1FQXGozfl3alPvdPHpEsTWwFPFVOoP6EeKT4bw/132","comment_is_top":false,"comment_ctime":1556006857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27325810633","product_id":100025301,"comment_content":"æœ€åˆï¼ŒGPSæ•°æ®ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨ç›˜é˜µä¸­ï¼Œæ•°æ®å¢é•¿è¾¾åˆ°TBçº§åˆ«åï¼Œè€ƒè™‘åˆ°æ€§èƒ½å’Œæˆæœ¬ä»¥åŠå¯æ‰©å±•æ€§ï¼Œç³»ç»Ÿè¿ç§»åˆ°HDFSä¸­ï¼Œç¦»çº¿ä»»åŠ¡ç”¨MRï¼Œåœ¨çº¿æŸ¥è¯¢é‡‡ç”¨HBSEï¼Œç°åœ¨ï¼Œæ•°æ®PBçº§åˆ«åï¼Œå‘ç°çƒ­ç‚¹æ•°æ®hbaseæˆæœ¬å¤ªé«˜ï¼Œç³»ç»Ÿè¿ç§»åˆ°æ—¶åºæ•°æ®åº“ï¼Œä¸“ä¾›çº¿ä¸Šå®æ—¶æŸ¥è¯¢ï¼ŒåŒæ—¶ï¼Œå®æ—¶åˆ†æé‡‡ç”¨stormï¼Œæ‰¹å¤„ç†ç”¨sparkã€‚å…¶å®ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œé‡‡ç”¨ä»€ä¹ˆæŠ€æœ¯ï¼Œæˆæœ¬å…·æœ‰å†³å®šæ€§å› ç´ ","like_count":6},{"had_liked":false,"id":88368,"user_name":"zhihai.tu","can_delete":false,"product_type":"c1","uid":1045888,"ip_address":"","ucode":"61371EA3EF6988","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/80/baddf03b.jpg","comment_is_top":false,"comment_ctime":1555912608,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"23030749088","product_id":100025301,"comment_content":"æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œè¯•ç‚¹çš„æ—¶å€™ç”±äºç”¨æˆ·è®¿é—®é‡å°ï¼Œä¼ ç»Ÿè´Ÿè½½å‡è¡¡F5ä¸‹è¿6å°åº”ç”¨æœåŠ¡å™¨è®¿é—®ä¸ºå•¥é—®é¢˜ã€‚åç»­æ¨å¹¿åï¼Œç”±äºè®¿é—®é‡å‡ºç°äº†50å€ä»¥ä¸Šçš„å¢åŠ ï¼Œå‰å°å“åº”æ…¢ï¼ŒæœåŠ¡å™¨ä¹Ÿå‡ºç°å†…å­˜æº¢å‡ºç­‰é—®é¢˜ã€‚åç»­é‡‡ç”¨äº†dockerå®¹å™¨æŠ€æœ¯ï¼Œä»åº”ç”¨æœåŠ¡å™¨ä¸ŠæŠ½å–å‡ºå¹¶å‘è®¿é—®è¾ƒé«˜çš„æœåŠ¡æ¨¡å—ï¼Œå•ç‹¬éƒ¨ç½²æœåŠ¡å±‚ï¼Œæ”¯æŒæ¨ªå‘æ‰©å±•ä»¥åŠåœ¨çº¿æ‰©å®¹ï¼Œè¾ƒå¥½çš„è§£å†³äº†é—®é¢˜ã€‚","like_count":5},{"had_liked":false,"id":88203,"user_name":"æ¶µ","can_delete":false,"product_type":"c1","uid":1502742,"ip_address":"","ucode":"BB8575DB13F1E0","user_header":"https://static001.geekbang.org/account/avatar/00/16/ee/16/742956ac.jpg","comment_is_top":false,"comment_ctime":1555894418,"is_pvip":false,"replies":[{"id":"31718","content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_88e0d7","uid":"1503187","ctime":1555897370,"ip_address":"","comment_id":88203,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18735763602","product_id":100025301,"comment_content":"åšä¼ ç»Ÿæ•°ä»“æ—¶ï¼Œä½¿ç”¨oracleæ•°æ®åº“ï¼Œéšç€æ•°æ®é‡å¢å¤§ä¼šéœ€è¦ä½¿ç”¨åˆ°åˆ†åŒºã€‚åˆ†åŒºéœ€è¦æ€è€ƒä½¿ç”¨å“ªä¸ªå±æ€§æ¥åˆ†ï¼Œåˆ†æˆå¤šå¤§çš„åŒºé—´åˆé€‚ã€‚å¦å¤–ï¼Œå½“è§†å›¾å¾ˆå¤§æ—¶ï¼Œæœ‰æ—¶æŸ¥è¯¢å¾ˆæ…¢ï¼Œä¼šä½¿ç”¨ç‰©åŒ–è§†å›¾çš„æ–¹æ³•ã€‚","like_count":4,"discussions":[{"author":{"id":1503187,"avatar":"","nickname":"Geek_88e0d7","note":"","ucode":"3E2596F3EB9165","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447766,"discussion_content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555897370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88192,"user_name":"JohnT3e","can_delete":false,"product_type":"c1","uid":1063982,"ip_address":"","ucode":"CF4AAAC933529C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLdWHFCr66TzHS2CpCkiaRaDIk3tU5sKPry16Q7ic0mZZdy8LOCYc38wOmyv5RZico7icBVeaPX8X2jcw/132","comment_is_top":false,"comment_ctime":1555892515,"is_pvip":false,"replies":[{"id":"31719","content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_88e0d7","uid":"1503187","ctime":1555897400,"ip_address":"","comment_id":88192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18735761699","product_id":100025301,"comment_content":"æ•°æ®å€¾æ–œï¼Œå¯¼è‡´ä»»åŠ¡è¿è¡Œæ—¶é—´è¶…å‡ºé¢„æœŸï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¯¹æ•°æ®åšä¸€äº›åˆ†æå’Œé‡‡æ ·ï¼Œä¼˜åŒ–shuffleã€‚ä»»åŠ¡å‡ºé”™åï¼Œè°ƒè¯•å‘¨æœŸå˜é•¿ï¼Œè¿™ä¸ªç›®å‰æ²¡æœ‰å¾ˆå¥½çš„è§£å†³ã€‚ä¸è¿‡ï¼Œä¹‹å‰çœ‹flumejavaè®ºæ–‡ï¼Œå…¶é‡‡ç”¨äº†ç¼“å­˜ä¸å˜ç»“æœæ¥åŠ å¿«è°ƒè¯•å‘¨æœŸã€‚å¦å¤–ï¼Œå°±æ˜¯é›†ç¾¤è§„æ¨¡å¢å¤§ï¼ŒåæœŸè¿ç»´çš„é—®é¢˜äº†","like_count":5,"discussions":[{"author":{"id":1503187,"avatar":"","nickname":"Geek_88e0d7","note":"","ucode":"3E2596F3EB9165","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447764,"discussion_content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555897400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90502,"user_name":"Daryl","can_delete":false,"product_type":"c1","uid":1333757,"ip_address":"","ucode":"3757AB87702FBD","user_header":"https://static001.geekbang.org/account/avatar/00/14/59/fd/128cc75b.jpg","comment_is_top":false,"comment_ctime":1556539020,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14441440908","product_id":100025301,"comment_content":"ä½œè€…å…¶å®å…³äºtop kæ²¡æè¿°æ¸…æ¥šï¼Œè™½ç„¶æˆ‘æ˜ç™½ä»–çš„æ„æ€ï¼Œå› ä¸ºæˆ‘äº†è§£è¿™è¾¹ï¼Œä½†æ˜¯å¯¹äºæ²¡æœ‰äº†è§£çš„åŒå­¦ä¼šæœ‰ç‚¹æ™•ä¹","like_count":3},{"had_liked":false,"id":88793,"user_name":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","can_delete":false,"product_type":"c1","uid":1132661,"ip_address":"","ucode":"C4C9915866E769","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","comment_is_top":false,"comment_ctime":1556001611,"is_pvip":false,"replies":[{"id":"31843","content":"è¿™é‡ŒKè¿œå°äºnï¼Œå†™æˆO(n)æ²¡æœ‰é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1556037820,"ip_address":"","comment_id":88793,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14440903499","product_id":100025301,"comment_content":"é¡ºä¾¿å¤ä¹ äº†ç‹äº‰è€å¸ˆçš„ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ã€‹ï¼Œçœ‹åˆ°Topç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å‡†ç¡®æ¥è®²åº”è¯¥æ˜¯æ˜¯O(nLogK)","like_count":3,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447902,"discussion_content":"è¿™é‡ŒKè¿œå°äºnï¼Œå†™æˆO(n)æ²¡æœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556037820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88457,"user_name":"Charles.Gast","can_delete":false,"product_type":"c1","uid":1301945,"ip_address":"","ucode":"E485B55CB1E95B","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/b9/ce84d577.jpg","comment_is_top":false,"comment_ctime":1555924050,"is_pvip":false,"replies":[{"id":"31784","content":"å“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1555988282,"ip_address":"","comment_id":88457,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14440825938","product_id":100025301,"comment_content":"æ•°æ®ä¸æ•°æ®ä»€ä¹ˆçš„æ— æ‰€è°“ï¼Œæˆ‘å°±æƒ³å¬å¬é‚£ä¸ªåŠ›å­¦å…¬å¼çš„è®²è§£ãŠ£","like_count":3,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447801,"discussion_content":"å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555988282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93554,"user_name":"å“ˆå“ˆ","can_delete":false,"product_type":"c1","uid":1240120,"ip_address":"","ucode":"8B6D697CE6C83D","user_header":"https://static001.geekbang.org/account/avatar/00/12/ec/38/c7819759.jpg","comment_is_top":false,"comment_ctime":1557495066,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147429658","product_id":100025301,"comment_content":"å°†å¤§è§„æ¨¡æ•°æ®æ‹†è§£åˆ°å¤šå°æœºå™¨å¤„ç†ï¼Œè¿˜åº”è¯¥ç”¨ä¸€å®šçš„è§„åˆ™å“ˆå¸Œåˆ°æ¯å°æœºå™¨å§","like_count":2},{"had_liked":false,"id":89872,"user_name":"æœ±åŒå­¦","can_delete":false,"product_type":"c1","uid":1514233,"ip_address":"","ucode":"2EF7D5A051712C","user_header":"https://static001.geekbang.org/account/avatar/00/17/1a/f9/180f347a.jpg","comment_is_top":false,"comment_ctime":1556290889,"is_pvip":false,"replies":[{"id":"32198","content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_88e0d7","uid":"1503187","ctime":1556328027,"ip_address":"","comment_id":89872,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10146225481","product_id":100025301,"comment_content":"å®é™…ä¸Šä¼ ç»ŸæœåŠ¡ä¹Ÿæ˜¯è¿™æ ·ï¼Œä¸šåŠ¡åˆæœŸæˆ‘ä»¬ä¸€å°ç‰©ç†æœºï¼Œåé¢åˆæ˜¯ä¸‰å°ç‰©ç†æœºï¼Œåšçš„åå‘ä»£ç†å°é›†ç¾¤ï¼Œåˆ°ç°åœ¨å‡ ä¸ªæœºæŸœåšäº†è™šæ‹ŸåŒ–ï¼Œæ•°æ®åº“ä¹Ÿåšäº†è¯»å†™åˆ†ç¦»ï¼Œè¯´åˆ°åº•å°±æ˜¯é›†ç¾¤åŒ–å¤„ç†","like_count":2,"discussions":[{"author":{"id":1503187,"avatar":"","nickname":"Geek_88e0d7","note":"","ucode":"3E2596F3EB9165","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448297,"discussion_content":"è°¢è°¢ä½ çš„ç»éªŒåˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556328027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89084,"user_name":"hufox","can_delete":false,"product_type":"c1","uid":1022874,"ip_address":"","ucode":"94675994D8EE16","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/9a/dcb2b713.jpg","comment_is_top":false,"comment_ctime":1556073850,"is_pvip":false,"replies":[{"id":"32091","content":"è°¢è°¢æ”¯æŒï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_88e0d7","uid":"1503187","ctime":1556223819,"ip_address":"","comment_id":89084,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10146008442","product_id":100025301,"comment_content":"ä»¥å‰åšè®¢å•ç³»ç»Ÿçš„æ—¶å€™ï¼Œç”±äºæ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å¤§è§„æ¨¡æ•°æ®å¤„ç†é—®é¢˜ï¼Œä½†æ˜¯ä¸€æ—¦æ•°æ®é‡ä¸Šæ¥äº†ï¼Œç»Ÿè®¡æŸ¥è¯¢éƒ½å¾ˆæ…¢ï¼Œä»Šå¤©é˜…è¯»äº†è€å¸ˆè¿™ä¸€è®²ï¼ŒåŸæ¥å¯ä»¥è¿™æ ·è®¾è®¡å¤„ç†å¤§è§„æ¨¡æ•°æ®é—®é¢˜ï¼Œæ¶¨å§¿åŠ¿äº†ï¼ç»§ç»­å­¦ä¹ ï¼","like_count":2,"discussions":[{"author":{"id":1503187,"avatar":"","nickname":"Geek_88e0d7","note":"","ucode":"3E2596F3EB9165","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448010,"discussion_content":"è°¢è°¢æ”¯æŒï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556223819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312488,"user_name":"é«˜æ™¯æ´‹","can_delete":false,"product_type":"c1","uid":2717072,"ip_address":"","ucode":"532188513579E4","user_header":"","comment_is_top":false,"comment_ctime":1631841266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5926808562","product_id":100025301,"comment_content":"1ã€æ•°æ®é‡åƒä¸‡çº§åˆ«æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯mysqlåˆ†åº“åˆ†è¡¨çš„æ–¹å¼ï¼Œæ•°æ®å¤§å°GBçº§åˆ«ï¼Œæœªè¾¾åˆ°TBçº§åˆ«<br>2ã€æˆ‘ä»¬æ˜¯åšç”µå•†æ•°æ®çš„ï¼Œå½“åº“ä¸­å•†å“skuæ•°é‡ï¼Œä»åƒä¸‡çº§åˆ«ï¼Œè†¨èƒ€åˆ°äº¿çº§çš„æ—¶å€™ï¼Œåˆ†åº“åˆ†è¡¨æ˜¯ä¸€ä»¶ç»´æŠ¤æˆæœ¬æé«˜çš„äº‹æƒ…ã€‚å› ä¸ºæ¯ä¸ªè¡¨ä¸­çš„æ•°æ®é‡è¾¾åˆ°ä¸€å®šçº§åˆ«æ—¶ï¼Œæ€»è¦äººä¸ºçš„ï¼Œå»é‡åšæ•£åˆ—<br><br>3ã€å› æ­¤ï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯ï¼Œå°†æ‰€æœ‰æ•°æ®æŒ‰5å¹´å¢é•¿é‡é¢„ç®—ï¼Œéƒ½å¯¼åˆ°äº†hbaseä¸­<br>4ã€è°ƒåº¦ç¨‹åºç”±æ™®é€šçš„ç¨‹åºè„šæœ¬ï¼Œæ¢æˆäº†sparké›†ç¾¤ã€‚<br>5ã€æˆ‘ä»¬çš„è°ƒåº¦é€Ÿåº¦ï¼Œç”±è€ç‰ˆæœ¬çš„1hï¼Œæé«˜åˆ°12min<br><br>â€”â€”â€”â€”â€”â€”â€”-<br>å¦‚æœæˆ‘æ¥åšï¼Œè¯¾ç¨‹é‡Œè®²çš„é”€é‡ç»Ÿè®¡ï¼Œæˆ‘å¯èƒ½ä¼šè¿™æ ·åšï¼š<br>1ã€æŒ‰è®¢å•å°†æ•°æ®æ•£åˆ—åˆ°hbaseä¸­<br>2ã€sparké›†ç¾¤å°†hbaseä¸­çš„æ•°æ®æ‹‰å‡ºæ¥<br>3ã€æŒ‰skuç»´åº¦åšcountç»Ÿè®¡æ“ä½œ<br>4ã€ä»¥jdä¸ºä¾‹ï¼Œskuæ•°é‡çº§å¤§æ¦‚50äº¿<br>5ã€å…¶ä¸­ æœˆç»´åº¦æœ‰é”€é‡çš„skué‡çº§ å¤§æ¦‚30%<br>6ã€ä¹Ÿå°±æ˜¯ç»è¿‡ç¬¬ä¸‰æ­¥åï¼Œç»Ÿè®¡å‡ºæ¥çš„æ•°æ®é‡çº§åœ¨15äº¿-20äº¿<br>7ã€å°†è¿™äº›æœ‰é”€é‡çš„æ•°æ®æŒ‰t-1çš„æ—¶é—´ç»´åº¦ï¼Œå…¥åˆ°hiveä¸­<br>8ã€æŒ‰è€æ¿ä»¬çš„éœ€æ±‚ä»hiveä¸­ï¼Œæ‹‰å–topNçš„é”€é‡sku","like_count":1},{"had_liked":false,"id":102517,"user_name":"è¥¿åŒ—ååŒ—","can_delete":false,"product_type":"c1","uid":1043160,"ip_address":"","ucode":"64BD69C84EE6A1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erdpKbFgRLnicjsr6qkrPVKZcFrG3aS2V51HhjFP6Mh2CYcjWric9ud1Qiclo8A49ia3eZ1NhibDib0AOCg/132","comment_is_top":false,"comment_ctime":1560241958,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5855209254","product_id":100025301,"comment_content":"æ•°æ®é‡å¤§åï¼Œæ•°æ®å¤„ç†æ€ç»´ï¼Œé™¤äº†è¦åˆ©ç”¨æ•°æ®ç»“æ„ï¼Œç®—æ³•åœ¨å•å°æœºå™¨ä¸Šåšä¼˜åŒ–ä¹‹å¤–ï¼Œè¿˜è¦æ€è€ƒï¼Œæ€ä¹ˆåˆ©ç”¨é›†ç¾¤çš„æ€§èƒ½æ¥æå®šã€‚","like_count":1},{"had_liked":false,"id":88792,"user_name":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","can_delete":false,"product_type":"c1","uid":1132661,"ip_address":"","ucode":"C4C9915866E769","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","comment_is_top":false,"comment_ctime":1556001283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850968579","product_id":100025301,"comment_content":"æˆ‘çš„æ€è€ƒæ˜¯ï¼šå¦‚æœK=3ï¼Œè€Œproduct_id = 1, product_id = 2, ......product_id = 9(product_idæœ‰9ç§è€Œä¸”æ¯ç§product_idå¯èƒ½ä¼šé‡å¤å‡ºç°ï¼Œä¸ªæ•°æ˜¯åŠ¨æ€çš„)ï¼Œé‚£ä¹ˆåœ¨ç»Ÿè®¡é”€é‡é›†ç¾¤ï¼Œåˆ†é…è®¡ç®—çš„æ–¹æ³•ä¸å˜ï¼Œä½†æ˜¯åœ¨æ‰¾å‡ºé”€é‡å‰Kçš„é›†ç¾¤ï¼Œæ¯å°æœºå™¨å¯ä»¥æŒ‰ç…§Kè´Ÿè´£3ä¸ªproduct_id, å¦‚ç¬¬1å°æœºå™¨è´Ÿè´£product_id = 1, 2, 3ï¼Œ ç¬¬äºŒå°è´Ÿè´£product_id = 4, 5, 6ä»¥æ­¤ç±»æ¨......  è¿™æ ·éœ€è¦3å°æœºå™¨ï¼Œæ¯å°æœºå™¨çš„è¾“å‡ºæ­£å¥½å°±æ˜¯æ¯å°æœºå™¨æœ¬åœ°çš„æœ€å¤§Kã€‚ä½†æ˜¯å¯ä»¥è¿›ä¸€æ­¥é€šç”¨åŒ–ï¼Œå¦‚æœproduct_idæœ‰11ç§æƒ…å†µï¼Œä½†æ˜¯åªæœ‰3å°æœºå™¨ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘æƒ³çš„æ–¹æ¡ˆæ˜¯ç¬¬1å°æœºå™¨åˆ†é…product_id = 1~3ï¼Œ ç¬¬2å°æœºå™¨åˆ†é…product_id = 4~7ï¼Œç¬¬3å°æœºå™¨åˆ†é…product_id = 8~11ã€‚ç„¶åé’ˆå¯¹äºæ¯å°æœºå™¨çš„è¾“å‡ºï¼Œç¬¬2ç¬¬3å°æœºå™¨å‡éœ€è¦ä»4ç§æƒ…å†µæ‰¾å‡ºæ’åå‰3çš„æƒ…å†µã€‚ä¸ç¡®å®šè¿™æ ·çš„ç†è§£æ˜¯å¦åœ¨æ­£ç¡®çš„é“è·¯ä¸Šï¼Œè¯·æŒ‡æ­£ã€‚","like_count":1},{"had_liked":false,"id":88578,"user_name":"å­¤é¹œé½é£","can_delete":false,"product_type":"c1","uid":1149144,"ip_address":"","ucode":"33CF3142DAD56C","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/d8/fdd2cecd.jpg","comment_is_top":false,"comment_ctime":1555945902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5850913198","product_id":100025301,"comment_content":"å¤§é“è‡³ç®€ï¼Œå¤§æ•°æ®å¤„ç†æœ¬è´¨ä¸Šè¿˜æ˜¯è¦åŒ–ç¹ä¸ºç®€ã€ä»¥å¤§åŒ–å°ï¼Œåˆ†å¸ƒå¼å¹¶è¡Œå¤„ç†å¹¶æ±‡æ€»ã€‚","like_count":1},{"had_liked":false,"id":88244,"user_name":"ä¹˜åTornadoçš„çº¿ç¨‹é­”æ³•å¸ˆ","can_delete":false,"product_type":"c1","uid":1132661,"ip_address":"","ucode":"C4C9915866E769","user_header":"https://static001.geekbang.org/account/avatar/00/11/48/75/02b4366a.jpg","comment_is_top":false,"comment_ctime":1555900166,"is_pvip":false,"replies":[{"id":"31786","content":"æˆ‘è§‰å¾—ä½ æƒ³çš„å¾ˆä»”ç»†å•Šã€‚å¯ä»¥æœ‰ä¸€ä¸ªæœºå™¨ä¸“é—¨å¤„ç†æ‰€æœ‰çš„product_id=2ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1555988440,"ip_address":"","comment_id":88244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5850867462","product_id":100025301,"comment_content":"å¦‚æœK=3çš„æƒ…å†µä¸‹ å¹¶ä¸”product=2 product_id=3å‡æœ‰å¤šæ¡è®°å½• è¯·é—®ä¸‹å…³äºproduct_id=2 product=3çš„è®°å½•è¯¥å¦‚ä½•å¤„ç† ä¹Ÿæ˜¯ æ¯å°æœºå™¨éƒ½è¦åšproduct_id=1çš„èšåˆå—","like_count":1,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447780,"discussion_content":"æˆ‘è§‰å¾—ä½ æƒ³çš„å¾ˆä»”ç»†å•Šã€‚å¯ä»¥æœ‰ä¸€ä¸ªæœºå™¨ä¸“é—¨å¤„ç†æ‰€æœ‰çš„product_id=2ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555988440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266950,"user_name":"Phantom01","can_delete":false,"product_type":"c1","uid":1140424,"ip_address":"","ucode":"9FA50D3B0A06DB","user_header":"https://static001.geekbang.org/account/avatar/00/11/66/c8/f598a816.jpg","comment_is_top":false,"comment_ctime":1607533197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607533197","product_id":100025301,"comment_content":"ä¸»è¦æ˜¯åˆ†æ²»ã€‚è€ƒè™‘æ€ä¹ˆæ‹†åˆ†åˆå¹¶ï¼Œæœ‰ç‚¹åƒå¤–æ’åºã€‚ç„¶åæƒ³åŠæ³•æé«˜å•æ¬¡æ“ä½œçš„æ•ˆç‡ï¼Œå‡å°‘è½ç›˜æˆ–è€…é€šä¿¡æ¬¡æ•°ã€‚<br><br>ä¹Ÿå¯ä»¥å…ˆåˆ†æ®µtopKç„¶ååˆå¹¶","like_count":0},{"had_liked":false,"id":259350,"user_name":"æŠ€æœ¯ä¿®è¡Œè€…","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1604711346,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1604711346","product_id":100025301,"comment_content":"è¯·æ•™ä¸€ä¸‹ï¼Œå¤§è§„æ¨¡æ•°æ®å¤„ç†ç³»ç»Ÿçš„è®¾è®¡å¯¹äºä¼ ç»Ÿçš„æ•°æ®ETLç³»ç»Ÿè®¾è®¡æœ‰ä»€ä¹ˆå‚è€ƒå’Œå€Ÿé‰´ä»·å€¼å—ï¼Ÿ<br>æˆ‘ä»¬ç›®å‰çš„ç³»ç»Ÿä¸»è¦é’ˆå¯¹æ‰¹é‡æ•°æ®ï¼Œåœ¨ä½¿ç”¨Kettle+Carteæ¥å¤„ç†ï¼Œä½†æ˜¯å¯¹äºå¼‚å¸¸å¤„ç†å’Œç³»ç»Ÿç›‘æ§æ–¹é¢åšçš„ä¸æ˜¯å¾ˆå¥½ã€‚","like_count":0},{"had_liked":false,"id":256264,"user_name":"Geek_639183","can_delete":false,"product_type":"c1","uid":2265206,"ip_address":"","ucode":"A4356886697745","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/IVIhn9AycTlGFSPvA4FB4b8GicYgFoqBkBRnRROOAjR6IUDcYxvJzDKGbBOh7YibqaAYLICX450rcWHZhq6ic5jdg/132","comment_is_top":false,"comment_ctime":1603589168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603589168","product_id":100025301,"comment_content":"ç¬¬ä¸€æ­¥ï¼Œç»Ÿè®¡æ¯ä¸ªå•†å“çš„é”€é‡ã€‚ä½ å¯ä»¥ç”¨å“ˆå¸Œè¡¨ï¼ˆhashtableï¼‰æ•°æ®ç»“æ„æ¥è§£å†³ï¼Œæ˜¯ä¸€ä¸ª O(n) çš„ç®—æ³•ï¼Œè¿™é‡Œ n æ˜¯ 1000 äº¿ã€‚<br><br>è€å¸ˆ è¯·é—®ä¸ºä»€ä¹ˆæ­¤å¤„ç”¨hashtable è€Œä¸ç”¨hashmapå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":243884,"user_name":"å¸ƒå‡¡","can_delete":false,"product_type":"c1","uid":1202465,"ip_address":"","ucode":"346FCD332F8BFA","user_header":"https://static001.geekbang.org/account/avatar/00/12/59/21/d2efde18.jpg","comment_is_top":false,"comment_ctime":1598319287,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598319287","product_id":100025301,"comment_content":"è€å¸ˆï¼Œ&quot;æ¯å°æœºå™¨å…ˆæŠŠæ‰€æœ‰ product_id = 1 çš„é”€é‡å åŠ åœ¨äº†ä¸€èµ·ï¼Œå†æ‰¾å‡ºè‡ªå·±æœºå™¨ä¸Šé”€é‡å‰ K = 1 çš„å•†å“ã€‚å¯ä»¥çœ‹åˆ°å¯¹äºæ¯å°æœºå™¨è€Œè¨€ï¼Œä»–ä»¬çš„è¾“å‡ºå°±æ˜¯æœ€ç»ˆæ’åå‰ K = 1 çš„å•†å“å€™é€‰è€…ã€‚&quot;è¿™é‡Œæœ‰ä¸ªç–‘é—®ã€‚<br>æˆ‘ç†è§£çš„æ˜¯å› ä¸ºæ¯å°æœºå™¨ä¸Šçš„product_idçš„å€¼å·®ä¸å¤šéƒ½æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œå¦‚æœåœ¨æ¯å°æœºå™¨ä¸Šé”€é‡æ’å‰K é‚£ä¹ˆæ•´ä½“ä¸Šä¹Ÿä¼šæ’å‰Kã€‚é‚£ä¼šä¸ä¼šå­˜product_idå¯¹åº”çš„countåœ¨æœºå™¨1ä¸Šæ’å‰K, æœºå™¨2ä¸Šæ’å‰K ä»¥åçš„æƒ…å†µå‘¢ï¼Ÿé‚£è¿™æ ·æœºå™¨2ä¸Šæ’å‰Kä»¥åçš„æ•°æ˜¯ä¸æ˜¯å°±ä¸ä¼šè¢«æ±‡æ€»äº†å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":186073,"user_name":"Eden2020","can_delete":false,"product_type":"c1","uid":1899158,"ip_address":"","ucode":"0DEE62F2335237","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fa/96/4a7b7505.jpg","comment_is_top":false,"comment_ctime":1583750659,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583750659","product_id":100025301,"comment_content":"å¤§æ•°æ®ä¸‹ï¼Œä¸€èˆ¬éƒ½ä¼šæ„å»ºç‰©åŒ–è§†å›¾ï¼Œä¸€èˆ¬çš„ä¼ä¸šä¸ä¼šæœ‰è¿™ä¹ˆå¤šæœºå™¨çš„è®¡ç®—é›†ç¾¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™è¾¹å¸¸ç”¨æ–¹æ³•å°±æ˜¯æ„å»ºè§†å›¾äº†ï¼Œå½“ç„¶è¿™ä¸€å—ç»´æŠ¤èµ·æ¥æ˜¯æ¯”è¾ƒéº»çƒ¦çš„","like_count":0},{"had_liked":false,"id":162482,"user_name":"ä½•å¦¨","can_delete":false,"product_type":"c1","uid":1385377,"ip_address":"","ucode":"EC3983BFF7992A","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg","comment_is_top":false,"comment_ctime":1576544798,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576544798","product_id":100025301,"comment_content":"è™½ç„¶ç†è§£äº†æ€æƒ³ï¼Œä½†æ˜¯å…·ä½“çš„å®ç°ç»†èŠ‚è¿˜æ˜¯å¾ˆæ¨¡ç³Šï¼Œæ¯”å¦‚åˆ†å¸ƒå¼é›†ç¾¤è®¡ç®—ä¹‹åæ˜¯å¦‚ä½•æ±‡æ€»çš„å‘¢ï¼Ÿè¿˜æœ‰ beam ç°åœ¨å·²ç»æ˜¯ç›®å‰ä¸»æµçš„å¤„ç†æ–¹æ¡ˆäº†ä¹ˆï¼Ÿå› ä¸ºç½‘ä¸Šæœæ•™ç¨‹å¥½åƒè›®å°‘çš„ï¼Œæ›´å¤šçš„è¿˜æ˜¯ mp,hadoop,sparkã€‚å°ç™½ä¸æ˜¯å¾ˆæ‡‚æœ›ç§‘æ™®~","like_count":0},{"had_liked":false,"id":120094,"user_name":"éœ²å¨œ","can_delete":false,"product_type":"c1","uid":1289012,"ip_address":"","ucode":"CC3EF71EB30EE1","user_header":"https://static001.geekbang.org/account/avatar/00/13/ab/34/ef002163.jpg","comment_is_top":false,"comment_ctime":1564789994,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564789994","product_id":100025301,"comment_content":"é‡åˆ°ä¸ªæ¨¡å‹è¾“å‡ºçš„é¡¹ç›®ï¼Œç”¨Node.JSå®ç°è®­ç»ƒå¥½çš„æ•°æ®æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹è¦è®¡ç®—200å¤šä¸ªå˜é‡ã€‚å•æœºè®¡ç®—æ—¶é—´5ç§’ï¼Œå¤ªä¹…äº†ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚åæ¥æ‹†æˆ5ä¸ªå¾®æœåŠ¡ï¼ŒæŠŠ200ä¸ªä¸åŒå˜é‡çš„è®¡ç®—é€»è¾‘åˆ†é…åˆ°5å°æœºå™¨ä¸Šã€‚åŒæ—¶è®¡ç®—ï¼Œæœ€ååœ¨æ±‡æ€»åç»Ÿä¸€è¿”å›ç»™å‰ç«¯ã€‚5ç§’è®¡ç®—æ—¶é—´å˜1ç§’äº†ã€‚","like_count":0},{"had_liked":false,"id":114141,"user_name":"liliumss","can_delete":false,"product_type":"c1","uid":1333094,"ip_address":"","ucode":"A52AC5042F3115","user_header":"https://static001.geekbang.org/account/avatar/00/14/57/66/e57bdb18.jpg","comment_is_top":false,"comment_ctime":1563242089,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563242089","product_id":100025301,"comment_content":"æ„Ÿå—ï¼šæŠ½è±¡å±‚æ¬¡å¾ˆé‡è¦ï¼Œå¯¹äºå¤§æ•°æ®æ¡†æ¶æ¥è¯´ åº”ç”¨åªæƒ³å…³å¿ƒé«˜å±‚çš„è°ƒç”¨ï¼Œç»†èŠ‚å°è£…å†å¤§æ•°æ®æ¡†æ¶é‡Œ","like_count":0},{"had_liked":false,"id":104836,"user_name":"ä¸€å¶çŸ¥ç§‹","can_delete":false,"product_type":"c1","uid":1171698,"ip_address":"","ucode":"7193850DF34312","user_header":"https://static001.geekbang.org/account/avatar/00/11/e0/f2/e73b3269.jpg","comment_is_top":false,"comment_ctime":1560850834,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560850834","product_id":100025301,"comment_content":"é€‰TopKçš„ç®—æ³•æ˜¯ä¸æ˜¯ä¸å¯¹ï¼Œåˆ†ç§‘æˆç»©æ¯ç§‘éƒ½æ˜¯ç¬¬äºŒï¼Œæ€»æˆç»©ç¬¬ä¸€çš„æƒ…å†µä¹Ÿæ˜¯å­˜åœ¨çš„ã€‚","like_count":0},{"had_liked":false,"id":94711,"user_name":"å´æ™“äº®","can_delete":false,"product_type":"c1","uid":1529305,"ip_address":"","ucode":"BA8D7D31137201","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/d9/326dd1fd.jpg","comment_is_top":false,"comment_ctime":1557884349,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557884349","product_id":100025301,"comment_content":"darren<br>æ¯å°æœºå™¨è®¡ç®—topK,æ±‡æ€»åˆ°masteråŸºäºæ¯å°æœºå™¨çš„topkæ•°æ®ï¼Œå†åštop,æ˜¯ä¸å‡†ç¡®çš„ï¼Œç›¸å½“äºåŸºäºtopçš„æ•°æ®ï¼Œæ¥è®¡ç®—topï¼Œæ˜¯ä¸å‡†ç¡®çš„ã€‚<br>î˜»<br>2019-05-08<br>ä½œè€…å›å¤: æ²¡æœ‰æ˜ç™½ä½ çš„æ„æ€ã€‚è¿™é‡Œçš„ç®—æ³•æ˜¯å…¨å±€çš„topkè‚¯å®šåœ¨å±€éƒ¨topkä¸­<br><br>å…¶å®é—®é¢˜çš„å…³é”®æ˜¯:æ˜¯ä¸æ˜¯æ¯å°æœºå™¨å¤„ç†çš„product idæ˜¯ä¸é‡å¤çš„,å¦‚æœç¬¬ä¸€å°æœºå™¨å¤„ç†product 1å’Œ2,ç¬¬äºŒå°ä¹Ÿæ˜¯æœ‰1å’Œ2,é‚£å°±æ˜¯ä¸å‡†çš„äº†,æ¯”æ–¹ç¬¬ä¸€å°æœºå™¨å‘ç°product1 = 1000,product2=500,ç¬¬äºŒå°æœºå™¨å‘ç°product1=0 ,product2=900 ,é‚£ä¹ˆæŒ‰ä½ çš„ç®—æ³•å°±æ˜¯product1èƒœå‡ºäº†,ä½†æ˜¯å®é™…ä¸Šproduct2=900+500=1400æ‰æ˜¯é”€é‡æœ€å¤§çš„","like_count":0,"discussions":[{"author":{"id":1014138,"avatar":"","nickname":"LGC247CG","note":"","ucode":"2193C266017057","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4411,"discussion_content":"æ ¹æ®ä½œè€…è€å¸ˆæè¿°ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼Œtopkä¹‹å‰product1å’Œ2çš„è®°å½•æ•°å·²ç»æ˜¯æ±‡æ€»åçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ªproduct1å’Œä¸€ä¸ªproduct2ï¼Œä½ æ‰€æè¿°çš„æ˜¯æ²¡æœ‰æ±‡æ€»çš„æ—¶å€™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565382251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92413,"user_name":"darren","can_delete":false,"product_type":"c1","uid":1027735,"ip_address":"","ucode":"386736C90F32CA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/97/ba512167.jpg","comment_is_top":false,"comment_ctime":1557268686,"is_pvip":false,"replies":[{"id":"33080","content":"æ²¡æœ‰æ˜ç™½ä½ çš„æ„æ€ã€‚è¿™é‡Œçš„ç®—æ³•æ˜¯å…¨å±€çš„topkè‚¯å®šåœ¨å±€éƒ¨topkä¸­","user_name":"ä½œè€…å›å¤","user_name_real":"Yuannanè”¡å…ƒæ¥ ","uid":"1257426","ctime":1557289685,"ip_address":"","comment_id":92413,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557268686","product_id":100025301,"comment_content":"æ¯å°æœºå™¨è®¡ç®—topK,æ±‡æ€»åˆ°masteråŸºäºæ¯å°æœºå™¨çš„topkæ•°æ®ï¼Œå†åštop,æ˜¯ä¸å‡†ç¡®çš„ï¼Œç›¸å½“äºåŸºäºtopçš„æ•°æ®ï¼Œæ¥è®¡ç®—topï¼Œæ˜¯ä¸å‡†ç¡®çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1257426,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2f/d2/0b6a8945.jpg","nickname":"Yuannanè”¡å…ƒæ¥ ","note":"","ucode":"695E183CE496A8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449248,"discussion_content":"æ²¡æœ‰æ˜ç™½ä½ çš„æ„æ€ã€‚è¿™é‡Œçš„ç®—æ³•æ˜¯å…¨å±€çš„topkè‚¯å®šåœ¨å±€éƒ¨topkä¸­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557289685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92412,"user_name":"darren","can_delete":false,"product_type":"c1","uid":1027735,"ip_address":"","ucode":"386736C90F32CA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/97/ba512167.jpg","comment_is_top":false,"comment_ctime":1557268009,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557268009","product_id":100025301,"comment_content":"æœ‰æ²¡æœ‰éšç€æ•°æ®è§„æ¨¡å˜å¤§ï¼Œç³»ç»Ÿå‡ºé—®é¢˜çš„æƒ…å†µï¼Œä½ åˆæ˜¯æ€ä¹ˆè§£å†³çš„<br>æ—¥å¿—å®¡è®¡åˆ†æç³»ç»Ÿï¼ŒåŒ…å«æ•°æ®æ¥æ”¶ã€å½’ä¸€åŒ–ã€ç»Ÿè®¡åˆ†æã€å­˜å‚¨å’Œç´¢å¼•æ¨¡å—ï¼Œå½“å•å°è§„æ¨¡ä¸è¶³ä»¥æ”¯æ’‘æ—¶ï¼Œé€šè¿‡ä¸åŒæ—¥å¿—æºå°†æ•°æ®åˆ‡åˆ†åˆ°ä¸åŒçš„æœºå™¨ï¼ˆåªåŒ…å«æ•°æ®æ¥æ”¶å’Œå½’ä¸€åŒ–å¤„ç†ï¼‰ï¼Œå°†ç»“æœå‘é€åˆ°ä¸­å¿ƒï¼ˆåŒ…å«æ•°æ®æ¥æ”¶ã€ç»Ÿè®¡åˆ†æã€å­˜å‚¨å’Œç´¢å¼•æ¨¡å—ï¼‰ï¼Œå°†è®¡ç®—æˆæœ¬æ¯”è¾ƒå¤§çš„å½’ä¸€åŒ–çš„æ¨¡å—ï¼Œåˆ†æ•£åˆ°ä¸åŒçš„æœºå™¨ï¼›æ¯”è¾ƒéº»çƒ¦çš„è¦å¤„ç†èµ„äº§åŒæ­¥ã€é…ç½®åŒæ­¥ã€åˆ†å¸ƒå¼idå†²çªé—®é¢˜ç­‰ã€‚","like_count":0,"discussions":[{"author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":199744,"discussion_content":"åˆ†å¸ƒå¼idå†²çªæ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿidåˆ†é…æŒ‰rangeæˆ–è€…hashä¼šå†²çªå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583602015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89698,"user_name":"Geek_1c9f7c","can_delete":false,"product_type":"c1","uid":1110419,"ip_address":"","ucode":"9A5611F231C474","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKic4Sia2vW3FdODLrSLzGEXqq2s6wRywMXSWHNdPY9Ge1ecW57pQ29dXRMSSl6aYLpv2uXH2U3Nliaw/132","comment_is_top":false,"comment_ctime":1556246001,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556246001","product_id":100025301,"comment_content":"å¤§è§„æ¨¡æœç´¢ ç²¾ç¡®çš„KNNï¼Œå¾€å¾€éš¾ä»¥å®ç°ï¼Œé€šè¿‡é¢„å¤„ç†ï¼Œç›´æ¥ANNæ±‚è§£ã€‚<br>å¹¶å¢åŠ å¤šé˜Ÿåˆ—çš„è®¾è®¡è¾…åŠ©KNN","like_count":0},{"had_liked":false,"id":89469,"user_name":"é’è§","can_delete":false,"product_type":"c1","uid":1031271,"ip_address":"","ucode":"F6E0D3D6D1C5BE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bc/67/5b97ba24.jpg","comment_is_top":false,"comment_ctime":1556180646,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556180646","product_id":100025301,"comment_content":"æ•°æ®è§„æ¨¡å˜å¤§çš„æ—¶å€™ï¼Œæ•°æ®åº“è¿›è¡Œäº†åˆ†åº“åˆ†è¡¨ï¼›å¯¹äºä¸€ä¸‹ä½¿ç”¨å¹³å‡¡çš„æ•°æ®è¿›è¡ŒREDIS å­˜å‚¨+å†…å­˜å¤„ç†ï¼Œå¹¶ä¸”è¿›è¡ŒæœåŠ¡å™¨çš„æ¨ªå‘æ‰©å±•ï¼›","like_count":0},{"had_liked":false,"id":89060,"user_name":"hd900","can_delete":false,"product_type":"c1","uid":1057579,"ip_address":"","ucode":"8CCC03F3BA080A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/IjFRWDxE5DUQZ4YJHVjN862xsDjhLObf2kKibFha2vcpNoHdzoqoBsvGibdPSNGZCJI8akhVPecf8vS9xgee2Dng/132","comment_is_top":false,"comment_ctime":1556070239,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556070239","product_id":100025301,"comment_content":"æ›¾ç»æœ‰è¿‡ä¸€ä¸ªå­¦ç”Ÿé€‰è¯¾çš„ç³»ç»Ÿï¼Œä¸€ä¸ªå­¦æ ¡çš„é€‰è¯¾å­¦ç”Ÿæ•°é‡å¤§æ¦‚2Â·3käººï¼Œè¯¾ç¨‹æ•°é‡ä¸å®šï¼Œæ¯æ¬¡é€‰è¯¾äº§ç”Ÿçš„æ•°æ®å­¦ç”Ÿæ•°é‡*è¯¾ç¨‹æ•°é‡çš„æ•°æ®ï¼Œç„¶ååœ¨æœ€ç»ˆç»Ÿè®¡çš„æ—¶å€™æ€»æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„sqlæ–¹æ³•å»ç»Ÿè®¡æ¯ä¸ªå­¦ç”Ÿçš„é€‰è¯¾æƒ…å†µï¼ˆæ¯”å¦‚å¿…ä¿®å¤šå°‘ï¼Œé€‰ä¿®å¤šå°‘ï¼‰ï¼Œä½†æ˜¯å› ä¸ºæ•°é‡å¾ˆå¤šï¼Œéœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´æ‰å®Œæˆç»Ÿè®¡ï¼Œè¯·é—®è€å¸ˆæœ‰æ²¡æœ‰å¥½çš„æ–¹æ³•ï¼Œèƒ½å¤Ÿä½¿å¾—å¿«é€Ÿçš„ç»Ÿè®¡æ¯ä¸ªå­¦ç”Ÿçš„é€‰è¯¾æƒ…å†µï¼ˆä¸æ˜¯å…·ä½“åˆ°é€‰äº†ä»€ä¹ˆè¯¾ç¨‹çš„å†…å®¹ï¼Œåªç»Ÿè®¡å­¦ç”Ÿé€‰äº†å¤šå°‘è¯¾ï¼Œå“ªäº›å­¦ç”Ÿæ²¡æœ‰é€‰å¤Ÿè¯¾ç¨‹ï¼‰ï¼Œè°¢è°¢","like_count":0},{"had_liked":false,"id":88908,"user_name":"æ‹’ç»","can_delete":false,"product_type":"c1","uid":1335155,"ip_address":"","ucode":"CB0264C4D3FE17","user_header":"https://static001.geekbang.org/account/avatar/00/14/5f/73/bb3dc468.jpg","comment_is_top":false,"comment_ctime":1556025246,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556025246","product_id":100025301,"comment_content":"è€å¸ˆæ‚¨å¥½:<br>      å¯¹äºæ²¡æœ‰ç»éªŒçš„æˆ‘æ¥è¯´ï¼Œå¬èµ·æ¥æ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒåƒåŠ›çš„ï¼Œè™½ç„¶è€å¸ˆå·²å°½å¯èƒ½çš„æè¿°çš„å¾ˆå¥½äº†ï¼Œä½†æˆ‘è¿˜æ˜¯æ²¡æœ‰é‚£ç§æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰ï¼Œå¸Œæœ›è€å¸ˆå¯¹æˆ‘è¿™æ ·çš„å­¦ç”ŸæŒ‡ç‚¹ä¸€ä¸‹ã€‚","like_count":0},{"had_liked":false,"id":88784,"user_name":"æ²ˆç‘","can_delete":false,"product_type":"c1","uid":1503694,"ip_address":"","ucode":"0AED2CFDA8CE28","user_header":"https://static001.geekbang.org/account/avatar/00/16/f1/ce/dab00082.jpg","comment_is_top":false,"comment_ctime":1556000175,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556000175","product_id":100025301,"comment_content":"æˆ‘ä»¬å…¬å¸æœ‰ä¸ªprojectï¼Œæ›¾ä»Šåœ¨storm ä¸Šåšäº†å±‚çš„sqlæŠ½è±¡ï¼Œå¯ä»¥æŠ½è±¡çš„è¡¨è¾¾","like_count":0},{"had_liked":false,"id":88770,"user_name":"Vito","can_delete":false,"product_type":"c1","uid":1058567,"ip_address":"","ucode":"9AB7BC1AB3EF7A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersxYcRm1mxLy6RlE5p1yibk5qFYwPS0E5XnI3XrS42rQW8pWJIDeTlshEGjSvl4uOVtEzU6IuOwOA/132","comment_is_top":false,"comment_ctime":1555996589,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555996589","product_id":100025301,"comment_content":"å½“æ—¶ç”¨C++å¤„ç†æ—¥å¿—ï¼Œæœ€å¼€å§‹ä¹Ÿæ˜¯å•æœºå•çº¿ç¨‹å¤„ç†ï¼Œåæ¥ç®—çš„è¶Šæ¥è¶Šæ…¢ï¼Œç„¶åé‡‡ç”¨å•è¿›ç¨‹å¤šçº¿ç¨‹ï¼ˆæŒ‰ç…§ç”¨æˆ·IDï¼Œå–æ¨¡åˆ†åˆ°ä¸åŒçš„çº¿ç¨‹ï¼‰å¤„ç†ï¼Œå‘æŒ¥æœ¬æœºCPUæ€§èƒ½ï¼Œå†åæ¥æ”¹ä¸ºå¤šå°æœºå™¨å¤šçº¿ç¨‹å¤„ç†ï¼Œå½“ç„¶ï¼Œæˆ‘æ²¡æœ‰å»å®ç°ä»€ä¹ˆåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ˜¯æŠŠæ–‡ä»¶åˆ†å‘åˆ°æ¯å°æœºå™¨ï¼Œåæ¥æ¥è§¦åˆ°äº†MRï¼Œæ„Ÿè§‰è‡ªå·±å½“æ—¶çš„æƒ³æ³•å’ŒMRæ€è·¯å¾ˆé›·åŒï¼Œå“ˆå“ˆã€‚","like_count":0},{"had_liked":false,"id":88629,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1555976709,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555976709","product_id":100025301,"comment_content":"æ€»ç»“ï¼šç”±äºæ•°æ®è§„æ¨¡å¾ˆå¤§ä¸€å°æœºå™¨æ— æ³•å¤„ç†ï¼Œæˆ–è€…å¤„ç†çš„æ—¶é—´æ— æ³•æ¥å—ï¼Œé‚£å°±æŠŠæ•°æ®åˆ‡åˆ†æˆå¤šå—ï¼Œæ¯ä¸ªæœºå™¨å¤„ç†ä¸€éƒ¨åˆ†é—®é¢˜ï¼Œæœ€ç»ˆåœ¨ä¸€å°æœºå™¨ä¸Šæ±‡æ€»ã€‚<br>æƒ³è®¾è®¡ä¸€å¥—ç±»ä¼¼ç³»ç»Ÿè¦å¤„ç†å¥½å¦‚ä½•åˆ‡åˆ†ï¼Œå¦‚ä½•æ§åˆ¶å„ä¸ªæœºå™¨è¿è¡Œè®¡ç®—ï¼Œå¦‚ä½•å¯¹è¿è¡Œç»“æœåšç›‘æ§ï¼Œå¦‚ä½•åšæ±‡æ€»ï¼Œå‡ºé”™å¦‚ä½•å¤„ç†ï¼Ÿ<br>å½“ç„¶è¿˜è¦è®¾è®¡è‡ªå·±çš„æŠ½è±¡è¯­è¨€ï¼Œé€šè¿‡æŠ½è±¡è¯­è¨€å…ˆæç»˜å‡ºæœ€ç»ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œé€ æˆå¤´è„‘ä¸­çš„åˆ›ä½œï¼Œå†æ¥å®Œæˆç°å®çš„åˆ›ä½œã€‚<br><br>å›ç­”ï¼šæˆ‘ä»¬é‡åˆ°å¤§çš„é—®é¢˜å°±ç›´æ¥ä¸Šå¤§æ•°æ®å¼€æºè½¯ä»¶äº†ï¼Œä¸è¿‡åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æœ‰çš„è½¯ä»¶æ¯”å¦‚solré‡åˆ°å¤§è§„æ¨¡æ•°æ®ä¹Ÿæœ‰é—®é¢˜ï¼Œä»¥å‰çš„ç‰ˆæœ¬ç´¢å¼•å…ƒæ•°æ®æ˜¯å­˜åœ¨zookeeperçš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå½“ç´¢å¼•å¤šäº†ï¼Œåˆ†åŒºå¤šäº†è¿™ä¸ªèŠ‚ç‚¹è¶Šæ¥è¶Šå¤§ï¼Œè¶…è¿‡zookeeperé»˜è®¤çš„1Mï¼Œåé¢solræŠŠæ¯ä¸ªcollectionå…ƒæ•°æ®æ‹†åˆ†åˆ°ä¸åŒèŠ‚ç‚¹ä¸‹ï¼Œè¿™ä¹Ÿç®—æ–‡ä¸­ç±»ä¼¼çš„åˆ†æ²»æ€æƒ³","like_count":0},{"had_liked":false,"id":88616,"user_name":"Bing","can_delete":false,"product_type":"c1","uid":1095367,"ip_address":"","ucode":"B0309C89022EC8","user_header":"https://static001.geekbang.org/account/avatar/00/10/b6/c7/e7c04558.jpg","comment_is_top":false,"comment_ctime":1555972899,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555972899","product_id":100025301,"comment_content":"å¤§æ•°æ®å¤„ç†æ€ç»´æ–¹å¼å°±æ˜¯ä¸€ä¸ªäº‹æƒ…åˆ†ç»™å¤šäººå¹²ï¼Œäº‹æƒ…ä¹Ÿæœ‰å…ˆåé¡ºåºï¼Œæ€ä¹ˆåè°ƒç®¡ç†å¥½ï¼Œæœ€ç»ˆå¿«é€Ÿåšå®Œï¼Œå…³å»ºè¿˜æ˜¯ä¸šåŠ¡ç†Ÿæ‚‰ï¼Œæ•°æ®æ¨¡å‹äº†è§£ï¼Œè¿™æ ·å¯ä»¥å‡åŒ€æ‹†åˆ†æ•°æ®å¹¶è¡Œå¤„ç†ï¼Œé€šè¿‡å®é™…æ¡ˆä¾‹è®²éå¸¸ç»™åŠ›","like_count":0},{"had_liked":false,"id":88573,"user_name":"å®‡å®™","can_delete":false,"product_type":"c1","uid":1048260,"ip_address":"","ucode":"0D7B50EED8024B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fe/c4/aeb13012.jpg","comment_is_top":false,"comment_ctime":1555944505,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555944505","product_id":100025301,"comment_content":"ä»ç†è®ºä¸Šæ¥è¯´top K ä¸èƒ½æ¯ä¸ªèŠ‚ç‚¹éƒ½æ‰¾Kä¸ªå§ å¯èƒ½æœ€åå‡ ä¸ªä¼šä¸å‡†ç¡®?","like_count":0},{"had_liked":false,"id":88511,"user_name":"æ¥ç¢—ç»¿è±†æ±¤","can_delete":false,"product_type":"c1","uid":1070051,"ip_address":"","ucode":"B0AB63B8D9729F","user_header":"https://static001.geekbang.org/account/avatar/00/10/53/e3/39dcfb11.jpg","comment_is_top":false,"comment_ctime":1555933401,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555933401","product_id":100025301,"comment_content":"æ„Ÿè§‰å¤§æ•°æ®å¤„ç†æœ¬è´¨å°±æ˜¯ï¼Œ æŠŠå¤§æ•°æ®åˆ†å‰²æˆå°æ•°æ®ï¼Œç„¶åå°æ•°æ®ç”¨ä¼ ç»Ÿçš„æ•°æ®ç»“æ„å’Œç®—æ³•çŸ¥è¯†è§£å†³ã€‚æ‰€ä»¥å¤§æ•°æ®æ¡†æ¶çš„æ ¸å¿ƒå°±æ˜¯æ€ä¹ˆæ¥ç®¡ç†å’Œåè°ƒé›†ç¾¤ä¸­çš„å„ä¸ªæœºå™¨ã€‚","like_count":0},{"had_liked":false,"id":88356,"user_name":":)","can_delete":false,"product_type":"c1","uid":1239198,"ip_address":"","ucode":"23D505949442B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/9e/6550a051.jpg","comment_is_top":false,"comment_ctime":1555910006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555910006","product_id":100025301,"comment_content":"æœŸå¾…æ›´æ–°ï¼","like_count":0},{"had_liked":false,"id":88354,"user_name":"é™ˆ","can_delete":false,"product_type":"c1","uid":1006448,"ip_address":"","ucode":"A8E6AFF6E5775D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5b/70/6411282d.jpg","comment_is_top":false,"comment_ctime":1555909665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555909665","product_id":100025301,"comment_content":"å¯å‘äº†æˆ‘ä¸€ä¸ªå¯¹å¤§æ•°æ®æ¡†æ¶çš„ä¼˜åŒ–æ€è·¯ï¼Œå°±æ˜¯åœ¨æ¡†æ¶ä¸€èˆ¬åšå¥½é›†ç¾¤æ–¹é¢å¤§è§„æ¨¡æ•°æ®å¤„ç†ï¼Œå¯¹å•æœºåˆ†ç‰‡ä¸Šçš„æ•°æ®å¯ä»¥é€šè¿‡ä¼ ç»Ÿçš„å•æœºç®—æ³•åšä¼˜åŒ–ï¼Œæé«˜å•æœºå¤„ç†æ•°æ®çš„æ€§èƒ½ï¼Œè¿›è€Œæå‡æ•´ä¸ªé›†ç¾¤å¤„ç†æ•°æ®çš„æ€§èƒ½ã€‚","like_count":0},{"had_liked":false,"id":88246,"user_name":"yiwu","can_delete":false,"product_type":"c1","uid":1307909,"ip_address":"","ucode":"712056FCDFE504","user_header":"https://static001.geekbang.org/account/avatar/00/13/f5/05/09aaa06c.jpg","comment_is_top":false,"comment_ctime":1555900681,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555900681","product_id":100025301,"comment_content":"å½“å¹´åšçš„ç¬¬ä¸€å¥—å¤§æ•°æ®åº”ç”¨ï¼Œå† å­—å·ç³»ç»Ÿå°±æ˜¯é‡‡ç”¨hbaseè§£å†³æ•°æ®å¤§è¡¨çš„ç®€å•crudæ“ä½œã€‚è¿™ä¸ªä¸œè¥¿å¦‚æœæ”¾åœ¨ä¼ ç»Ÿæ•°æ®åº“+å•ä¸€å­˜å‚¨ï¼Œç»å¯¹æ˜¯å¤§æŠ•å…¥ã€‚","like_count":0}]}