{"id":429665,"title":"åŠ é¤ï½œRust2021ç‰ˆæ¬¡é—®ä¸–äº†ï¼","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯é™ˆå¤©ã€‚</p><p>åƒå‘¼ä¸‡å”¤å§‹å‡ºæ¥çš„ Rust 2021 editionï¼ˆä¸‹ç§°ç‰ˆæ¬¡ï¼‰ï¼Œç»ˆäºä¼´éšç€ 1.56 ç‰ˆæœ¬å‡ºæ¥äº†ã€‚åœ¨ä½¿ç”¨ <code>rustup update stable</code> å®Œæˆå·¥å…·é“¾çš„å‡çº§ä¹‹åï¼Œå°ä¼™ä¼´ä»¬å°±å¯ä»¥å°è¯•ç€æŠŠè‡ªå·±ä¹‹å‰çš„ä»£ç å‡çº§åˆ° 2021 ç‰ˆäº†ã€‚</p><p>å…·ä½“åšæ³•å¾ˆç®€å•ï¼š</p><ol>\n<li><code>cargo fix --edition</code></li>\n<li>ä¿®æ”¹ Cargo.tomlï¼Œæ›¿æ¢ edition = â€œ2021â€</li>\n<li><code>cargo build</code> /  <code>cargo test</code> ç¡®ä¿ä¸€åˆ‡æ­£å¸¸</li>\n</ol><p>åœ¨åšç¬¬ä¸€æ­¥ä¹‹å‰ï¼Œè®°å¾—å…ˆæŠŠæœªæäº¤çš„ä»£ç æäº¤ã€‚</p><p>å¦‚æœä½ æ˜¯åˆæ¬¡æ¶‰çŒ Rust çš„åŒå­¦ï¼Œå¯èƒ½ä¸æ¸…æ¥š Rust ä¸­â€œç‰ˆæ¬¡â€çš„ä½œç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„ã€å‘åå…¼å®¹çš„å‘å¸ƒå·¥å…·ã€‚</p><p>ä¸çŸ¥é“åœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸­æœ‰æ²¡æœ‰ç±»ä¼¼çš„æ¦‚å¿µï¼Œåæ­£æˆ‘æ‰€äº†è§£çš„è¯­è¨€ï¼Œæ²¡æœ‰ç±»ä¼¼çš„ä¸œè¥¿ã€‚C++ è™½ç„¶å…è®¸ä½ ç¼–è¯‘ lib A æ—¶ç”¨ --std=C++17ï¼Œç¼–è¯‘ lib B æ—¶ç”¨ --std=C++20ï¼Œä½†è¿™ç§ç”¨æ³•æœ‰ä¸å°‘å±€é™ï¼Œç”¨èµ·æ¥ä¹Ÿæ²¡æœ‰ç‰ˆæ¬¡è¿™ä¹ˆæ¸…çˆ½ã€‚æˆ‘ä»¬å…ˆå¯¹å®ƒçš„ç†è§£è¾¾æˆä¸€è‡´ï¼Œå†èŠè¿™æ¬¡â€œç‰ˆæ¬¡â€æ›´æ–°çš„é‡ç‚¹å†…å®¹ã€‚</p><p>åœ¨ Rust ä¸­ï¼Œç‰ˆæ¬¡ä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸åŒçš„ä¿ç•™å­—å’Œç¼ºçœè¡Œä¸ºã€‚æ¯”å¦‚ 2018çš„ async / await / dynï¼Œåœ¨ 2015 ä¸­å°±æ²¡æœ‰ä¸¥æ ¼ä¿ç•™æˆå…³é”®å­—ã€‚</p><p>å‡è®¾è¯­è¨€åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­å‘ç° actor éœ€è¦æˆä¸ºä¿ç•™å­—ï¼Œä½†å¦‚æœå°†å…¶è®¾ç½®ä¸ºä¿ç•™å­—å°±ä¼šç ´åå…¼å®¹æ€§ï¼Œä¼šè®©ä¹‹å‰æŠŠ actor å½“æˆæ™®é€šåç§°ä½¿ç”¨çš„ä»£ç æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿå‡çº§å¤§ç‰ˆæœ¬ï¼Œè®©ä»£ç åˆ†è£‚æˆä¸å…¼å®¹çš„ v1 å’Œ v2 ä¹ˆï¼Ÿè¿™ä¸ªé—®é¢˜æ˜¯ä»¤æ‰€æœ‰è¯­è¨€å¼€å‘è€…å¤´ç–¼çš„äº‹æƒ…ã€‚</p><!-- [[[read_end]]] --><p>è¯­è¨€æ€»æ˜¯è¦å‘å±•çš„ï¼Œæ€»ä¼šä»ä¸å®Œå–„åˆ°å®Œå–„ï¼Œæ‰€ä»¥ï¼Œä¸€å¼€å§‹è€ƒè™‘ä¸å‘¨ï¼Œåæ¥ä¸å¾—ä¸é€šè¿‡ç ´åæ€§æ›´æ–°æ¥å¼¥è¡¥çš„äº‹æƒ…ï¼Œå±¡è§ä¸é²œã€‚</p><p>å‡çº§å¤§ç‰ˆæœ¬å·ï¼Œæ˜¯ä¹‹å‰å¤„ç†è¿™ç±»é—®é¢˜çš„æƒ¯å¸¸æ‰‹æ®µã€‚</p><p>ç„¶è€Œï¼Œå¯¹äºåº“çš„ä½œè€…æ¥è¯´ï¼Œå¦‚æœä»–ä¸æƒ³å‡çº§å¤§ç‰ˆæœ¬æˆ–è€…å—é™äºæŸäº›åŸå› æ— æ³•å¾ˆå¿«å‡çº§ï¼Œæœ€ç»ˆï¼Œè¦ä¹ˆæ˜¯ä½¿ç”¨è¿™ä¸ªåº“çš„å¼€å‘è€…åªå¥½åšå®ˆåœ¨ v1ï¼Œè¦ä¹ˆæ˜¯ä½¿ç”¨è¿™ä¸ªåº“çš„å¼€å‘è€…ä¸å¾—ä¸æ‰¾åˆ°å¯¹åº”çš„å’Œ v2 å…¼å®¹çš„æ›¿ä»£å“ã€‚ä½†æ— è®ºå“ªç§æ–¹å¼ï¼Œæ•´ä¸ªç”Ÿæ€ç¯å¢ƒéƒ½ä¼šå—åˆ°æ’•è£‚ã€‚</p><p>Rust é€šè¿‡â€œç‰ˆæ¬¡â€éå¸¸èªæ˜åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åº“çš„ä½œè€…è¿˜æ˜¯ä»¥æ—§çš„ç‰ˆæ¬¡å‘å¸ƒä»–çš„ä»£ç ï¼Œä½¿ç”¨åº“çš„å¼€å‘è€…å¯ä»¥é€‰æ‹©ä»–ä»¬æƒ³ä½¿ç”¨æœ€æ–°çš„ç‰ˆæ¬¡ï¼ŒäºŒè€…å¯ä»¥å®Œå…¨ä¸ä¸€è‡´ï¼Œ<strong>ç¼–è¯‘æ—¶ï¼ŒRust ç¼–è¯‘å™¨ä»¥æ—§çš„ç‰ˆæ¬¡çš„åŠŸèƒ½ç¼–è¯‘æ—§çš„åº“ï¼Œè€Œä»¥æ–°çš„ç‰ˆæ¬¡ç¼–è¯‘ä½¿ç”¨è€…çš„ä»£ç </strong>ã€‚</p><p>çœ‹ä¸€ä¸ªå®é™…ä¾‹å­å§ã€‚åœ¨ <a href=\"http://crates.io\">crates.io</a> é‡Œæˆ‘éšä¾¿æœäº†ä¸€ä¸ªæœ€åæ›´æ–°æ­¢æ­¥äºä¸‰å¹´å‰çš„åº“ <a href=\"https://crates.io/crates/rbpf\">rbpf</a>ã€‚çœ‹å®ƒçš„ <a href=\"https://github.com/qmonnet/rbpf/blob/master/Cargo.toml\">Cargo.toml</a>ï¼Œè¿™æ˜¯ä¸ª 2015 ç‰ˆæ¬¡çš„åº“ï¼ˆä¸å£°æ˜ç‰ˆæ¬¡å°±æ„å‘³ç€ 2015ï¼‰ï¼Œå’Œç°åœ¨çš„ä»£ç æ–­äº†ä¸¤ä»£ã€‚æˆ‘ä»¬æ¥å°è¯•åˆ›å»ºä¸€ä¸ª 2021 ç‰ˆæ¬¡çš„ crateï¼ŒåŒæ—¶å¼•å…¥è¿™ä¸ªåº“ï¼Œä»¥åŠ 2018 ç‰ˆæ¬¡çš„ futures åº“ï¼Œçœ‹æœ‰æ²¡æœ‰é—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ Rust å‡çº§åˆ°äº† 1.56ã€‚ç„¶å <code>cargo new test-rust-edition</code>ã€‚åœ¨ç”Ÿæˆçš„é¡¹ç›®é‡Œï¼Œä¸º Cargo.toml åŠ å…¥ï¼š</p><pre><code class=\"language-rust\">[package]\nname = \"test-rust-edition\"\nversion = \"0.1.0\"\nedition = \"2021\"\n\n[dependencies]\nrbpf = \"0.1.0\"\nfutures = \"0.3\"\n</code></pre><p>è¿™é‡Œæˆ‘æ•…æ„è®©ä¸¤ä¸ªæœ¬æ¥æ˜¯ä¸å…¼å®¹çš„ crate æ”¾åœ¨ä¸€èµ·çœ‹çœ‹æ˜¯å¦å¯ä»¥ååŒå·¥ä½œã€‚futures ä½¿ç”¨äº† async/awaitï¼Œè¿™æ˜¯ Rust 2018 æ‰å¼•å…¥çš„å…³é”®å­—ï¼Œä½† rbpf ä½¿ç”¨çš„ 2015 ç‰ˆæ¬¡ã€‚</p><p>ä¿®æ”¹å¥½ Cargo.toml åï¼Œæˆ‘ä»¬åœ¨ src/main.rs ä¸­æ‹·å…¥ï¼š</p><pre><code class=\"language-rust\">use futures::executor::block_on;\n\nfn main() {\n    // This is the eBPF program, in the form of bytecode instructions.\n    let prog = &amp;[\n        0xb4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // mov32 r0, 0\n        0xb4, 0x01, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, // mov32 r1, 2\n        0x04, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, // add32 r0, 1\n        0x0c, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // add32 r0, r1\n        0x95, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // exit\n    ];\n\n    // Instantiate a struct EbpfVmNoData. This is an eBPF VM for programs that\n    // takes no packet data in argument.\n    // The eBPF program is passed to the constructor.\n    let vm = rbpf::EbpfVmNoData::new(Some(prog)).unwrap();\n\n    block_on(async move {\n        dummy(vm.execute_program().unwrap()).await;\n    });\n}\n\nasync fn dummy(result: u64) {\n    println!(\"hello world! Result is {} (should be 0x3)\", result);\n}\n</code></pre><p>è¿™ä¸ªä»£ç åœ¨åšä»€ä¹ˆæˆ‘ä»¬ä¸ç”¨å…³å¿ƒï¼Œåªéœ€è¦å…³å¿ƒå®ƒèƒ½ä¸èƒ½åœ¨ 2021 ç‰ˆæ¬¡çš„ crate é‡Œè·‘èµ·æ¥ï¼Œ<code>cargo run</code> åï¼Œå‘ç° rbpf å’Œ futures èæ´½åœ°å¤„åœ¨äº†ä¸€èµ·ã€‚</p><p>ä¸€ä»½ä»£ç ï¼Œä½¿ç”¨äº†ä¸‰ä¸ªç‰ˆæ¬¡çš„ä»£ç ï¼Œå´èƒ½å¤Ÿæ— ç¼å¯¹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™ç”šè‡³å¯ä»¥ä¸ç”¨å…³å¿ƒè°æ˜¯ä»€ä¹ˆç‰ˆæ¬¡ï¼Œä½ è¯´å‰å®³ä¸å‰å®³ï¼Ÿ</p><p>æ‰€ä»¥ä½ çœ‹ï¼Œç‰ˆæ¬¡èµ·åˆ°äº†é˜²ç«å¢™çš„ä½œç”¨ï¼Œä½¿å¾—æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸ç”¨åˆ†è£‚ï¼Œå¤§å®¶æ— éœ€æ”¹åŠ¨ï¼Œä¾æ—§èƒ½å¤Ÿå„å¸å…¶èŒã€‚è¿™å°±æ˜¯ç‰ˆæ¬¡å¯¹ Rust æœ€å¤§çš„è´¡çŒ®ã€‚å¦‚æœä½ ç»å†è¿‡ Python2 åˆ° Python3 å‡çº§è¿‡ç¨‹ä¸­çš„å·¨å¤§é˜µç—›ï¼Œé‚£åº”è¯¥èƒ½å¤Ÿéå¸¸æ„Ÿæ¿€ Rust å¼•å…¥äº†è¿™ä¹ˆä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚</p><h2>Rust 2021 åŒ…æ‹¬äº†ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Ÿ</h2><p>åœ¨ä½ ç†è§£ Rust 2021 ç‰ˆæ¬¡çš„æ„ä¹‰ä¹‹åï¼Œå†æ¥çœ‹çœ‹å¯¹æˆ‘ä»¬å½±å“æœ€å¤§çš„å‡ ä¸ªæ›´æ–°ã€‚</p><h3>é—­åŒ…çš„ä¸ç›¸äº¤æ•è·</h3><p>åœ¨ 2021 ä¹‹å‰ï¼Œå“ªæ€•ä½ åªç”¨åˆ°äº†å…¶ä¸­ä¸€ä¸ªåŸŸï¼Œé—­åŒ…ä¹Ÿéœ€è¦æ•è·æ•´ä¸ªæ•°æ®ç»“æ„ï¼Œå³ä½¿æ˜¯å¼•ç”¨ã€‚ä½†æ˜¯ 2021 ä¹‹åï¼Œé—­åŒ…å¯ä»¥åªæ•è·éœ€è¦çš„åŸŸã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„<a href=\"https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=f7428fb00bd8648808e82618e5e8916a\">ä»£ç </a>ï¼š</p><pre><code class=\"language-rust\">struct Employee {\n    name: String,\n    title: String,\n}\n\nfn main() {\n    let tom = Employee {\n        name: \"Tom\".into(),\n        title: \"Engineer\".into(),\n    };\n\n    drop(tom.name);\n\n    println!(\"title: {}\", tom.title);\n\n    // ä¹‹å‰è¿™å¥ä¸èƒ½å·¥ä½œï¼Œ2021 å¯ä»¥ç¼–è¯‘\n    let c = || println!(\"{}\", tom.title);\n    c();\n}\n</code></pre><p>é—­åŒ…çš„ä¸ç›¸äº¤æ•è·å¯¹æˆ‘ä»¬ä½¿ç”¨çš„å¥½å¤„æ˜¯ï¼Œé‚£äº›é—­åŒ…ä¸­æ•è·äº†ç»“æ„ä½“çš„ä¸€éƒ¨åˆ†å­—æ®µï¼Œè€Œå…¶å®ƒåœ°æ–¹åˆç”¨äº†å¦ä¸€éƒ¨åˆ†ä¸ä¹‹ä¸ç›¸äº¤çš„å­—æ®µï¼ŒåŸæœ¬åœ¨ 2018 ä¸­æ˜¯ç¼–è¯‘ä¸è¿‡çš„ï¼Œä½ åªèƒ½ clone() è¿™ä¸ªç»“æ„ä½“æ»¡è¶³åŒæ–¹çš„éœ€è¦ï¼Œç°åœ¨å¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚</p><h3>feature resolver</h3><p>ä¾èµ–ç®¡ç†æ˜¯ä¸€ä¸ªéš¾é¢˜ï¼Œå…¶ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ä¹‹ä¸€å°±æ˜¯åœ¨ä¾èµ–ä¸¤ä¸ªä¸åŒçš„åŒ…æ—¶ï¼Œé€‰æ‹©è¦ä½¿ç”¨çš„ä¾èµ–ç‰ˆæœ¬ã€‚è¿™é‡ŒæŒ‡çš„ä¸ä»…åŒ…æ‹¬å…¶ç‰ˆæœ¬å·ï¼Œè¿˜åŒ…æ‹¬ä¸ºè¯¥è½¯ä»¶åŒ…å¯ç”¨æˆ–æœªå¯ç”¨çš„åŠŸèƒ½ï¼ˆfeatureï¼‰ã€‚å› ä¸ºCargo çš„é»˜è®¤è¡Œä¸ºæ˜¯åœ¨ä¾èµ–ä¸­å¤šæ¬¡å¼•ç”¨å•ä¸ªåŒ…æ—¶åˆå¹¶æ‰€ç”¨åˆ°çš„åŠŸèƒ½ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸º Foo çš„ crateï¼Œå…¶ä¸­æœ‰ A å’Œ B ä¸¤ä¸ªåŠŸèƒ½ï¼Œè¯¥ä¾èµ–é¡¹è¢«åŒ… bar å’Œ baz ä½¿ç”¨ï¼Œä½† bar ä¾èµ– Foo + Aï¼Œè€Œ baz ä¾èµ– Foo + Bã€‚Cargo ä¼šåˆå¹¶è¿™ä¸¤ä¸ªåŠŸèƒ½å¹¶ç¼–è¯‘ Foo + A Bã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/b8/53/b8601e7c005ff666d1597dd174346d53.jpg?wh=2044x1332\" alt=\"\"></p><p>è¿™ç¡®å®æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œä½ åªéœ€è¦ç¼–è¯‘ä¸€æ¬¡ Fooï¼Œå°±å¯ä»¥è¢« bar å’Œ baz ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœ A å’Œ B ä¸åº”è¯¥ä¸€èµ·ç¼–è¯‘å‘¢ï¼Ÿå¦‚æœä½ å¯¹è¿™æ ·çš„åœºæ™¯æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ Rust 1.51 ç¼–è¯‘ç­–ç•¥çš„é“¾æ¥ã€‚è¿™æ˜¯ Rust ä¸€ä¸ªé•¿æœŸå­˜åœ¨å¹¶å›°æ‰°ç¤¾åŒºçš„é—®é¢˜ã€‚</p><p>ä¹‹å‰ Rust 1.51 ç»ˆäºæä¾›äº†æ–°çš„æ–¹æ³•ï¼Œé€šè¿‡ä¸åŒçš„<a href=\"https://blog.rust-lang.org/2021/03/25/Rust-1.51.0.html#cargos-new-feature-resolver\">ç¼–è¯‘ç­–ç•¥</a>è§£å†³è¿™ä¸€é—®é¢˜ã€‚å¦‚ä»Šï¼Œè¿™ä¸ªç­–ç•¥å·²ç»æˆä¸º 2021 çš„ç¼ºçœè¡Œä¸ºï¼Œå®ƒä¼šå¸¦æ¥ä¸€äº›ç¼–è¯‘é€Ÿåº¦çš„æŸå¤±ï¼Œä½†ä¼šè®©ç¼–è¯‘ç»“æœæ›´åŠ ç²¾ç¡®ã€‚</p><h3>æ–°çš„ prelude</h3><p>ä»»ä½•è¯­è¨€éƒ½ä¼šç¼ºçœå¼•å…¥æŸäº›å‘½åç©ºé—´ä¸‹çš„ä¸€äº›éå¸¸å¸¸è§çš„è¡Œä¸ºï¼Œè¿™æ ·è®©å¼€å‘è€…ä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚Rust ä¹Ÿä¸ä¾‹å¤–ï¼Œå®ƒä¼šç¼ºçœå¼•å…¥ä¸€äº› trait ã€æ•°æ®ç»“æ„å’Œå®ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„ From / Into è¿™æ ·çš„ traitã€Vec è¿™æ ·çš„æ•°æ®ç»“æ„ï¼Œä»¥åŠ println! / vec! è¿™æ ·çš„å®ã€‚è¿™æ ·åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦é¢‘ç¹åœ°ä½¿ç”¨ useã€‚</p><p>åœ¨ 2021 ç‰ˆæ¬¡ä¸­ï¼ŒTryIntoã€TryFrom å’Œ FromIterator é»˜è®¤è¢«å¼•å…¥åˆ° prelude ä¸­ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ä½¿ç”¨ use å£°æ˜äº†ã€‚æ¯”å¦‚ç°åœ¨ä¸‹é¢çš„è¯­å¥å°±æ²¡å¿…è¦äº†ï¼Œå› ä¸º prelude å·²ç»åŒ…å«äº†ï¼š</p><pre><code class=\"language-rust\">use std::convert::TryFrom;\n</code></pre><h2>å°ç»“</h2><p>æ€»çš„æ¥è¯´ï¼ŒRust 2021 ä¸æ˜¯ä¸€ä¸ªå¤§çš„ç‰ˆæ¬¡æ›´æ–°ï¼Œé‡Œé¢åªåŒ…å«äº†å°‘é‡å’Œä¹‹å‰ç‰ˆæœ¬ä¸å…¼å®¹çš„åœ°æ–¹ã€‚æœªæ¥ 3 å¹´ï¼ŒRust éƒ½å°†ç¨³å®šåœ¨è¿™ä¸ªç‰ˆæ¬¡ä¸Šã€‚</p><p>ä¹Ÿè®¸ä½ ä¼šä¸ç†è§£ï¼šæè¿™ä¹ˆå¤§åŠ¨é™ï¼Œå°±è¿™ï¼Ÿä½†è¿™æ­£æ˜¯ Rust å½“åˆè®¾è®¡ç”¨å¿ƒè‰¯è‹¦çš„åœ°æ–¹ã€‚</p><p>ä¸‰å¹´å†…ï¼Œä»¥ 6 å‘¨ä¸ºå•ä½ï¼Œä¸æ–­è¿­ä»£æ–°çš„åŠŸèƒ½ï¼Œé£é›¨æ— é˜»ï¼Œä½†ä¸å¼•å…¥ç ´åæ€§æ›´æ–°ï¼Œæˆ–è€…ç”¨æŸäº›ç¼–è¯‘é€‰é¡¹å°†å…¶éš”ç¦»ï¼Œä½¿ç”¨è€…å¿…é¡»æ‰‹å·¥æ‰“å¼€ï¼ˆæ¯”å¦‚ resolver = â€œ2â€ï¼‰ï¼›ä¸‰å¹´æœŸæ»¡ï¼Œå‡çº§ç‰ˆæ¬¡ï¼Œä¸€æ¬¡æ€§æŠŠè¿™ä¸‰å¹´å†…æ½œåœ¨çš„ç ´åæ€§æ›´æ–°ï¼Œä»¥åŠå¯é¢„è§çš„æœªæ¥ä¼šå¼•å…¥çš„ç ´åæ€§æ›´æ–°ï¼ˆæ¯”å¦‚ä¿ç•™æ–°çš„å…³é”®å­—ï¼‰ï¼Œé€šè¿‡ç‰ˆæ¬¡æ¥åŒºéš”ã€‚</p><p>ç‰ˆæ¬¡ä¸­å‡ºç°çš„å¤§åŠ¨ä½œè¶Šå°‘ï¼Œå°±è¯´æ˜è¯­è¨€è¶Šè¶‹å‘æˆç†Ÿã€‚</p><p>å¥½ï¼Œå…³äº 2021 ç‰ˆæ¬¡çš„ä»‹ç»å°±åˆ°è¿™é‡Œï¼Œè¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ä¿®æ”¹ï¼Œè¿™é‡Œæˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹<a href=\"https://blog.rust-lang.org/2021/10/21/Rust-1.56.0.html#rust-2021\">å‘å¸ƒæ–‡æ¡£</a>ã€‚è¿™é—¨è¯¾çš„ä»£ç ä»“åº“ <a href=\"https://github.com/tyrchen/geektime-rust\">tyrchen/geektime-rust</a> ä¹Ÿéšä¹‹å‡çº§åˆ°äº† 2021 ç‰ˆæ¬¡ï¼Œå…·ä½“ä¿®æ”¹ä½ å¯ä»¥çœ‹è¿™ä¸ª <a href=\"https://github.com/tyrchen/geektime-rust/pull/3\">pull request</a>ã€‚</p>","neighbors":{"left":{"article_title":"25ï½œç±»å‹ç³»ç»Ÿï¼šå¦‚ä½•å›´ç»•traitæ¥è®¾è®¡å’Œæ¶æ„ç³»ç»Ÿï¼Ÿ","id":429063},"right":{"article_title":"26ï½œé˜¶æ®µå®æ“ï¼ˆ3ï¼‰ï¼šæ„å»ºä¸€ä¸ªç®€å•çš„KV server-é«˜çº§traitæŠ€å·§","id":429666}},"comments":[{"had_liked":false,"id":318027,"user_name":"ç½—æ°","can_delete":false,"product_type":"c1","uid":1320487,"ip_address":"","ucode":"96BAFAA147341F","user_header":"https://static001.geekbang.org/account/avatar/00/14/26/27/eba94899.jpg","comment_is_top":false,"comment_ctime":1635126596,"is_pvip":false,"replies":[{"id":"115302","content":":)","user_name":"ä½œè€…å›å¤","comment_id":318027,"uid":"1079375","ip_address":"","utype":1,"ctime":1635133681,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":2,"score":"18814995780","product_id":100085301,"comment_content":"æ˜¨æ™šçœ‹åˆ°è€å¸ˆçš„ä»“åº“çš„ç‰ˆæ¬¡å˜æˆ 2021ï¼Œä»Šå¤©å°±åŠ é¤ï¼Œçˆ½ğŸ˜Š","like_count":4,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529070,"discussion_content":":)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635133681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318324,"user_name":"qinsi","can_delete":false,"product_type":"c1","uid":1667175,"ip_address":"","ucode":"090D9C4068FF12","user_header":"https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg","comment_is_top":false,"comment_ctime":1635241838,"is_pvip":true,"replies":[{"id":"116580","content":"ç›®å‰çœ‹æ²¡æœ‰è¿™ä¸ªå¿…è¦ï¼Œåªéœ€è¦ç¼–è¯‘å™¨åšå¥½å‘åå…¼å®¹å³å¯ã€‚å¦‚æœæ”¯æŒæ—§ç‰ˆæ¬¡å¯¼è‡´ç¼–è¯‘å™¨å¤ªè¿‡åºæ‚ï¼Œä¸”æ—§ç‰ˆæ¬¡å‡ ä¹æ²¡äººä½¿ç”¨äº†ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å‡çº§å¤§ç‰ˆæœ¬ï¼Œæ¯”å¦‚è·³åˆ° rust 2ï¼Œæ¥æ˜¾å¼åœ°æ”¾å¼ƒä¸€äº›ç‰ˆæ¬¡çš„æ”¯æŒã€‚å‡ å¹´å†…å†…çœ‹ä¸åˆ°è¿™æ ·åšçš„å¿…è¦æ€§ã€‚","user_name":"ä½œè€…å›å¤","comment_id":318324,"uid":"1079375","ip_address":"","utype":1,"ctime":1636642783,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"10225176430","product_id":100085301,"comment_content":"æœ‰æ²¡æœ‰å¯èƒ½éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ—§çš„ç‰ˆæ¬¡å°±ä¸è¢«ç»§ç»­æ”¯æŒå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529189,"discussion_content":"ç›®å‰çœ‹æ²¡æœ‰è¿™ä¸ªå¿…è¦ï¼Œåªéœ€è¦ç¼–è¯‘å™¨åšå¥½å‘åå…¼å®¹å³å¯ã€‚å¦‚æœæ”¯æŒæ—§ç‰ˆæ¬¡å¯¼è‡´ç¼–è¯‘å™¨å¤ªè¿‡åºæ‚ï¼Œä¸”æ—§ç‰ˆæ¬¡å‡ ä¹æ²¡äººä½¿ç”¨äº†ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å‡çº§å¤§ç‰ˆæœ¬ï¼Œæ¯”å¦‚è·³åˆ° rust 2ï¼Œæ¥æ˜¾å¼åœ°æ”¾å¼ƒä¸€äº›ç‰ˆæ¬¡çš„æ”¯æŒã€‚å‡ å¹´å†…å†…çœ‹ä¸åˆ°è¿™æ ·åšçš„å¿…è¦æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636642783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320312,"user_name":"Marvichov","can_delete":false,"product_type":"c1","uid":1111835,"ip_address":"","ucode":"7482099415C41C","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/1b/db7a0edc.jpg","comment_is_top":false,"comment_ctime":1636223471,"is_pvip":false,"replies":[{"id":"116354","content":"æ‰€ä»¥ç”¨ç‰ˆæ¬¡æŠŠ breaking change éš”å¼€å•Šã€‚æ¯”å¦‚åœ¨ 2015 ç‰ˆæ¬¡ä¸­ä½¿ç”¨äº†æŸä¸ªåœ¨ 2024 ç‰ˆæ¬¡ä¸­å®šä¹‰çš„å…³é”®å­—åšå˜é‡ï¼Œç¼–è¯‘å™¨çŸ¥é“è¿™æ˜¯ 2015 ç‰ˆæ¬¡ï¼Œæ‰€ä»¥ä¸æŠŠè¿™ä¸ªåå­—ä½œä¸ºå…³é”®å­—è§£é‡Šã€‚è¿™æ ·å°±é¿å… breaking change çš„å½±å“ã€‚æ‰€ä»¥ï¼Œç¼–è¯‘å™¨ä¼šä¸€ç›´åšå‘åå…¼å®¹","user_name":"ä½œè€…å›å¤","comment_id":320312,"uid":"1079375","ip_address":"","utype":1,"ctime":1636527086,"user_name_real":"Tyr"}],"discussion_count":2,"race_medal":0,"score":"5931190767","product_id":100085301,"comment_content":"æ€ä¹ˆæ„Ÿè§‰ç‰ˆæ¬¡å°±æ˜¯è‡ªåŠ¨åŒ–äº†ä¸åŒç¼–è¯‘feature flag, ç„¶åæŠŠæ‰€æœ‰binary linkåœ¨ä¸€èµ·? (https:&#47;&#47;stackoverflow.com&#47;questions&#47;46746878&#47;is-it-safe-to-link-c17-c14-and-c11-objects<br><br>```<br>[c++ pseudo dep]<br>rbpf = &quot;--std=c++14&quot;<br>futures = &quot;--std=c++17&quot;<br>```<br><br>æ„Ÿè§‰, ç¼–è¯‘å™¨è¿˜æ˜¯éœ€è¦å‘åå…¼å®¹å•Š, å¦‚æœä½¿ç”¨1.56ç¼–è¯‘2015ç‰ˆæ¬¡çš„ä»£ç ...<br><br>å¦‚æœéœ€è¦å¼•å…¥breaking changeæ€ä¹ˆåŠå‘¢? (ä¸‡ä¸€å‘¢","like_count":1,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529953,"discussion_content":"æ‰€ä»¥ç”¨ç‰ˆæ¬¡æŠŠ breaking change éš”å¼€å•Šã€‚æ¯”å¦‚åœ¨ 2015 ç‰ˆæ¬¡ä¸­ä½¿ç”¨äº†æŸä¸ªåœ¨ 2024 ç‰ˆæ¬¡ä¸­å®šä¹‰çš„å…³é”®å­—åšå˜é‡ï¼Œç¼–è¯‘å™¨çŸ¥é“è¿™æ˜¯ 2015 ç‰ˆæ¬¡ï¼Œæ‰€ä»¥ä¸æŠŠè¿™ä¸ªåå­—ä½œä¸ºå…³é”®å­—è§£é‡Šã€‚è¿™æ ·å°±é¿å… breaking change çš„å½±å“ã€‚æ‰€ä»¥ï¼Œç¼–è¯‘å™¨ä¼šä¸€ç›´åšå‘åå…¼å®¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636527086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111835,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/1b/db7a0edc.jpg","nickname":"Marvichov","note":"","ucode":"7482099415C41C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":412902,"discussion_content":"è¿˜æœ‰ä¸€ç‚¹, rustç›®å‰è¿˜æ˜¯binary distribution; æœ¬è´¨ä¸Šè¿˜æ˜¯ç”¨ä¸€ä¸ªcompilerç‰ˆæœ¬ç¼–è¯‘æœ€åçš„binary;\n\nå¦‚æœæ˜¯binary distribution, å¯èƒ½å°±ä¸è¡Œäº†; æ¯”å¦‚è¯´1.40ç¼–è¯‘çš„2015ç‰ˆæœ¬Fooå’Œ1.56ç¼–è¯‘çš„2021çš„Barå¯èƒ½å°±ä¸èƒ½linkåœ¨ä¸€èµ·äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636326601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351101,"user_name":"ELSE","can_delete":false,"product_type":"c1","uid":1172907,"ip_address":"","ucode":"72448D7271C8B0","user_header":"https://static001.geekbang.org/account/avatar/00/11/e5/ab/56f348e5.jpg","comment_is_top":false,"comment_ctime":1657528592,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657528592","product_id":100085301,"comment_content":"äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨RUST","like_count":0},{"had_liked":false,"id":318152,"user_name":"Jagger","can_delete":false,"product_type":"c1","uid":1914208,"ip_address":"","ucode":"0BD13223AEE076","user_header":"https://static001.geekbang.org/account/avatar/00/1d/35/60/d3e723a7.jpg","comment_is_top":false,"comment_ctime":1635165502,"is_pvip":true,"replies":[{"id":"116586","content":"lol","user_name":"ä½œè€…å›å¤","comment_id":318152,"uid":"1079375","ip_address":"","utype":1,"ctime":1636643952,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"1635165502","product_id":100085301,"comment_content":"rustï¼šæˆ‘æ‹’ç»æ›´æ–°ï¼Œå› ä¸ºæˆ‘æœ¬æ¥å°±å¾ˆä¼˜ç§€ï¼","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529121,"discussion_content":"lol","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636643952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318069,"user_name":"é‡å±±é—¨","can_delete":false,"product_type":"c1","uid":1019276,"ip_address":"","ucode":"4430AF308209A0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/8c/8e3d356c.jpg","comment_is_top":false,"comment_ctime":1635139671,"is_pvip":false,"replies":[{"id":"116590","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":318069,"uid":"1079375","ip_address":"","utype":1,"ctime":1636644095,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"1635139671","product_id":100085301,"comment_content":"ä»Šå¤©åˆšå‡çº§rustå¹¶å°è¯•2021ç‰ˆæ¬¡ï¼Œè¿™ä¸ªåŠ é¤å¾ˆåŠæ—¶ï¼Œæ”¶è·è‰¯å¤šï¼<br>æ„Ÿè°¢æä¾›è¿™ä¸ªæ£’çš„è¯¾ç¨‹ã€‚","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529089,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636644095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318064,"user_name":"æˆ‘å¬ç€å‘¢","can_delete":false,"product_type":"c1","uid":2130928,"ip_address":"","ucode":"5A74C44478F144","user_header":"https://static001.geekbang.org/account/avatar/00/20/83/f0/9f063379.jpg","comment_is_top":false,"comment_ctime":1635138170,"is_pvip":false,"replies":[{"id":"116591","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":318064,"uid":"1079375","ip_address":"","utype":1,"ctime":1636644099,"user_name_real":"Tyr"}],"discussion_count":1,"race_medal":0,"score":"1635138170","product_id":100085301,"comment_content":"æ¥å•¦æ¥å•¦ï¼Œé©¬ä¸åœè¹„å»æ›´æ–°","like_count":0,"discussions":[{"author":{"id":1079375,"avatar":"https://static001.geekbang.org/account/avatar/00/10/78/4f/e74f870c.jpg","nickname":"Tyr","note":"","ucode":"EAAFC8063202E0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529085,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636644099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318030,"user_name":"æ¸æçº¢èŒ¶","can_delete":false,"product_type":"c1","uid":2738941,"ip_address":"","ucode":"03D80953AF984E","user_header":"https://static001.geekbang.org/account/avatar/00/29/ca/fd/4e6dd31c.jpg","comment_is_top":false,"comment_ctime":1635127639,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635127639","product_id":100085301,"comment_content":"å¦™å•Š","like_count":0}]}