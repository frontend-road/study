{"id":120176,"title":"69 | Kubernetes背景和架构","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":140473,"user_name":"海罗沃德","can_delete":false,"product_type":"c3","uid":1165364,"ip_address":"","ucode":"8704F1D6980FA0","user_header":"https://static001.geekbang.org/account/avatar/00/11/c8/34/fb871b2c.jpg","comment_is_top":false,"comment_ctime":1570954118,"is_pvip":false,"replies":[{"id":54460,"content":"skywalking agent的配置里头，SW_打头的都是可以通过环境变量传入，包括\n服务名：SW_AGENT_NAME\nCollector地址：SW_AGENT_COLLECTOR_BACKEND_SERVICES\n\nhttps:&#47;&#47;github.com&#47;apache&#47;skywalking&#47;blob&#47;master&#47;apm-sniffer&#47;config&#47;agent.config","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1571057675,"ip_address":"","comment_id":140473,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"请问在docker里是怎么连接skywalking的，如何把service name和java agent的地址传给docker image的？在docker file里没有找到相关的配置信息","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470406,"discussion_content":"skywalking agent的配置里头，SW_打头的都是可以通过环境变量传入，包括\n服务名：SW_AGENT_NAME\nCollector地址：SW_AGENT_COLLECTOR_BACKEND_SERVICES\n\nhttps://github.com/apache/skywalking/blob/master/apm-sniffer/config/agent.config","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571057675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":154393,"user_name":"Lomo Fu","can_delete":false,"product_type":"c3","uid":1610161,"ip_address":"","ucode":"B7B9761F156593","user_header":"https://static001.geekbang.org/account/avatar/00/18/91/b1/e4769e6d.jpg","comment_is_top":false,"comment_ctime":1574421707,"is_pvip":false,"replies":[{"id":59643,"content":"如果是公有云(比如阿里云或腾讯云)，它们提供k8s云服务，建议直接购买使用。一般不建议在公有云上再自建k8s集群，搭建和运维都非常复杂，除非业务确实需要，而且你有很强的k8s运维团队。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1574688834,"ip_address":"","comment_id":154393,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师您好 我搭建k8s用的是不同云平台的esc云服务器 不知道有可行方案嘛 课程和网上很多都是基于内网搭建的。","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475453,"discussion_content":"如果是公有云(比如阿里云或腾讯云)，它们提供k8s云服务，建议直接购买使用。一般不建议在公有云上再自建k8s集群，搭建和运维都非常复杂，除非业务确实需要，而且你有很强的k8s运维团队。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574688834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146975,"user_name":"322","can_delete":false,"product_type":"c3","uid":1697037,"ip_address":"","ucode":"3BC0F72A0D25F5","user_header":"https://static001.geekbang.org/account/avatar/00/19/e5/0d/e4689fd8.jpg","comment_is_top":false,"comment_ctime":1572748159,"is_pvip":false,"replies":[{"id":56951,"content":"你好，Staffjoy的前端构建是要求Linux或者Mac环境的，如果是Windows环境，有几个办法可以尝试：\n\n1. 安装Linux虚拟机(比如用Vagrant），在虚拟机里头构建。\n2. 有学员给出了一个在windows构建的修复方案(https:&#47;&#47;github.com&#47;spring2go&#47;staffjoy&#47;issues&#47;6)，可以尝试下\n3. 跳过构建，直接用波波已经打好的镜像(https:&#47;&#47;hub.docker.com&#47;u&#47;boboweike)，构建实际就是生成静态的html&#47;js文件，然后放在nginx目录下，打成镜像，这步骤理解即可，没必要完全动手操作。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1572920111,"ip_address":"","comment_id":146975,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"波波老师，windows环境下dockercompose报错了。\nBuilding myaccount-service\nStep 1&#47;13 : FROM node:alpine as builder\n ---&gt; 59be7d262786\nStep 2&#47;13 : WORKDIR &#39;&#47;build&#39;\n ---&gt; Using cache\n ---&gt; ef355f2740bb\nStep 3&#47;13 : COPY myaccount .&#47;myaccount\n ---&gt; Using cache\n ---&gt; 163c1fd5ce7f\nStep 4&#47;13 : COPY resources .&#47;resources\n ---&gt; Using cache\n ---&gt; 5a249647ae46\nStep 5&#47;13 : COPY third_party .&#47;third_party\n ---&gt; Using cache\n ---&gt; 919aa3c96e16\nStep 6&#47;13 : WORKDIR &#39;&#47;build&#47;myaccount&#39;\n ---&gt; Using cache\n ---&gt; 071d45a27978\nStep 7&#47;13 : RUN npm install\n ---&gt; Using cache\n ---&gt; 2b9129e1d693\nStep 8&#47;13 : RUN npm rebuild node-sass\n ---&gt; Running in f7cd735f6ebe\n\n&gt; node-sass@4.12.0 install &#47;build&#47;myaccount&#47;node_modules&#47;node-sass\n&gt; node scripts&#47;install.js\n\nDownloading binary from https:&#47;&#47;github.com&#47;sass&#47;node-sass&#47;releases&#47;download&#47;v4.12.0&#47;linux_musl-x64-79_binding.node\nCannot download &quot;https:&#47;&#47;github.com&#47;sass&#47;node-sass&#47;releases&#47;download&#47;v4.12.0&#47;linux_musl-x64-79_binding.node&quot;:\n\nHTTP error 404 Not Found\n\nHint: If github.com is not accessible in your location\n      try setting a proxy via HTTP_PROXY, e.g.\n\n      export HTTP_PROXY=http:&#47;&#47;example.com:1234\n\nor configure npm proxy via\n\n      npm config set proxy http:&#47;&#47;example.com:8080\n\n&gt; node-sass@4.12.0 postinstall &#47;build&#47;myaccount&#47;node_modules&#47;node-sass\n&gt; node scripts&#47;build.js\n\nBuilding: &#47;usr&#47;local&#47;bin&#47;node &#47;build&#47;myaccount&#47;node_modules&#47;node-gyp&#47;bin&#47;node-gyp.js rebuild --verbose --libsass_ext= --libsass_cflags= --libsass_ldflags= --libsass_library=\ngyp info it worked if it ends with ok\ngyp verb cli [\ngyp verb cli   &#39;&#47;usr&#47;local&#47;bin&#47;node&#39;,\n\n...\n\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     &#47;root&#47;.npm&#47;_logs&#47;2019-11-03T02_26_30_084Z-debug.log\nERROR: Service &#39;myaccount-service&#39; failed to build: The command &#39;&#47;bin&#47;sh -c npm rebuild node-sass&#39; returned a non-zero code: 1","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473083,"discussion_content":"你好，Staffjoy的前端构建是要求Linux或者Mac环境的，如果是Windows环境，有几个办法可以尝试：\n\n1. 安装Linux虚拟机(比如用Vagrant），在虚拟机里头构建。\n2. 有学员给出了一个在windows构建的修复方案(https://github.com/spring2go/staffjoy/issues/6)，可以尝试下\n3. 跳过构建，直接用波波已经打好的镜像(https://hub.docker.com/u/boboweike)，构建实际就是生成静态的html/js文件，然后放在nginx目录下，打成镜像，这步骤理解即可，没必要完全动手操作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572920111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066576,"avatar":"https://static001.geekbang.org/account/avatar/00/10/46/50/511205c3.jpg","nickname":"louis","note":"","ucode":"3292516C8A9786","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":47449,"discussion_content":"看我今天刚提的issue，跟你这个很像，看下是不是node_sass的版本跟node不匹配","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573352511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137252,"user_name":"杨波","can_delete":false,"product_type":"c3","uid":1030344,"ip_address":"","ucode":"FA3418BB703BCA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","comment_is_top":false,"comment_ctime":1569668786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"课程补充材料，作者撰写的参考文章《如何理解Kubernetes架构？》\nhttps:&#47;&#47;blog.csdn.net&#47;yang75108&#47;article&#47;details&#47;100215486","like_count":7},{"had_liked":false,"id":373513,"user_name":"Nydia","can_delete":false,"product_type":"c3","uid":1591962,"ip_address":"广东","ucode":"52B08829B95FFE","user_header":"https://static001.geekbang.org/account/avatar/00/18/4a/9a/ac4ae803.jpg","comment_is_top":false,"comment_ctime":1682588673,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"可见地址失效了吗，打不开","like_count":0}]}