{"id":654414,"title":"24ï½œStable Diffusionï¼šæœ€çƒ­é—¨çš„å¼€æºAIç”»å›¾å·¥å…·","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ–‡æµ©ã€‚</p><p><a href=\"https://time.geekbang.org/column/article/653489\">ä¸Šä¸€è®²</a>ï¼Œæˆ‘ä»¬ä¸€èµ·ä½“éªŒäº†CLIPè¿™ä¸ªå¤šæ¨¡æ€çš„æ¨¡å‹ã€‚åœ¨è¿™ä¸ªæ¨¡å‹é‡Œï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤ŸæŠŠä¸€æ®µæ–‡æœ¬å’Œå¯¹åº”çš„å›¾ç‰‡å…³è”èµ·æ¥äº†ã€‚çœ‹åˆ°æ–‡æœ¬å’Œå›¾ç‰‡çš„å…³è”ï¼Œæƒ³å¿…ä½ ä¹Ÿèƒ½è”æƒ³åˆ°è¿‡å»åŠå¹´éå¸¸ç«çƒ­çš„â€œæ–‡ç”Ÿå›¾â€ï¼ˆText-To-Imageï¼‰çš„åº”ç”¨æµªæ½®äº†ã€‚ç›¸æ¯”äºåœ¨å¤§è¯­è¨€æ¨¡å‹é‡ŒOpenAIçš„ä¸€æç‹¬ç§€ã€‚æ–‡ç”Ÿå›¾é¢†åŸŸå°±å±äºç™¾èŠ±é½æ”¾äº†ï¼ŒOpenAIé™†ç»­å‘è¡¨äº†DALL-Eå’Œ <a href=\"https://labs.openai.com/\">DALL-E 2</a>ï¼ŒGoogleä¹Ÿä¸ç”˜ç¤ºå¼±åœ°å‘è¡¨äº† <a href=\"https://imagen.research.google/\">Imagen</a>ï¼Œè€Œå¸‚åœºä¸Šå®é™…è¢«ç”¨å¾—æœ€å¤šã€åé¦ˆæœ€å¥½çš„ç”¨æˆ·ç«¯äº§å“æ˜¯ <a href=\"https://midjourney.com/home/\">Midjourney</a>ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨æ•´ä¸ªæŠ€æœ¯ç¤¾åŒºé‡Œï¼Œæœ€æµè¡Œçš„äº§å“åˆ™æ˜¯Stable Diffusionã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„äº§å“ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥è°ƒç”¨Stable Diffusionå†…ç½®çš„æ¨¡å‹æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œè¿˜èƒ½å¤Ÿä¸‹è½½ç¤¾åŒºé‡Œå…¶ä»–äººè®­ç»ƒå¥½çš„æ¨¡å‹æ¥ç”Ÿæˆå›¾ç‰‡ã€‚æˆ‘ä»¬ä¸ä»…å¯ä»¥é€šè¿‡æ–‡æœ¬æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œè¿˜èƒ½é€šè¿‡å›¾ç‰‡æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œé€šè¿‡æ–‡æœ¬æ¥ç¼–è¾‘å›¾ç‰‡ã€‚</p><p>é‚£ä¹ˆä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Stable Diffusionï¼Œåšåˆ°ä¸Šé¢è¿™äº›äº‹æƒ…ã€‚</p><h2>ä½¿ç”¨Stable Diffusionç”Ÿæˆå›¾ç‰‡</h2><h3>æ–‡ç”Ÿå›¾</h3><p>å¯èƒ½ä½ è¿˜æ²¡æ€ä¹ˆä½“éªŒè¿‡æ–‡ç”Ÿå›¾çš„åº”ç”¨ï¼Œé‚£æˆ‘ä»¬å…ˆç”¨å‡ è¡Œæœ€ç®€å•çš„ä»£ç ä½“éªŒä¸€ä¸‹ã€‚åœ¨è¿™ä¸€è®²é‡Œï¼Œæˆ‘å»ºè®®ä¸€å®šè¦ç”¨Colabæˆ–è€…å…¶ä»–çš„GPUç¯å¢ƒï¼Œå› ä¸ºç”¨CPUæ¥æ‰§è¡Œçš„è¯ï¼Œé€Ÿåº¦ä¼šæ…¢åˆ°è®©äººæ— æ³•æ¥å—ã€‚</p><!-- [[[read_end]]] --><p>å®‰è£…ä¾èµ–åŒ…ï¼š</p><pre><code class=\"language-python\">%pip install diffusers accelerate transformers\n</code></pre><p>ä»£ç ï¼š</p><pre><code class=\"language-python\">from diffusers import DiffusionPipeline\npipeline = DiffusionPipeline.from_pretrained(\"runwayml/stable-diffusion-v1-5\")\npipeline.to(\"cuda\")\nimage = pipeline(\"a photograph of an astronaut riding a horse\").images[0]\nimage\n</code></pre><p>è¾“å‡ºç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/72/57/7217f995c7fd7143ef6807d8e0dfc057.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><p>ä»£ç éå¸¸ç®€å•ï¼Œåªæœ‰å¯¥å¯¥å‡ è¡Œã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Huggingfaceçš„Diffusersåº“ï¼Œé€šè¿‡DiffusionPipelineåŠ è½½äº†RunwayMLçš„stable-diffusion-v1-5çš„æ¨¡å‹ã€‚ç„¶åï¼ŒæŒ‡å®šäº†è¿™ä¸ªPipelineä½¿ç”¨CUDAä¹Ÿå°±æ˜¯åˆ©ç”¨GPUæ¥è¿›è¡Œè®¡ç®—ã€‚æœ€åå‘è¿™ä¸ªPipelineè¾“å…¥äº†ä¸€æ®µæ–‡æœ¬ï¼Œé€šè¿‡è¿™æ®µæ–‡æœ¬æˆ‘ä»¬å°±ç”Ÿæˆäº†ä¸€å¼ å›¾ç‰‡ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ç”»çš„æ˜¯åœ¨Stable Diffusioné‡Œéå¸¸ç»å…¸çš„ä¸€å¼ â€œå®‡èˆªå‘˜åœ¨å¤ªç©ºéª‘é©¬â€çš„å›¾ç‰‡ã€‚ä¹‹æ‰€ä»¥ç”»è¿™ä¹ˆä¸€å¼ å›¾ç‰‡ï¼Œæ˜¯ä¸ºäº†è¯æ˜æˆ‘ä»¬å¹¶ä¸æ˜¯é€šè¿‡â€œæœç´¢â€çš„æ–¹å¼æ‰¾åˆ°ä¸€å¼ å·²ç»å­˜åœ¨çš„å›¾ç‰‡ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€è®²é‡Œæˆ‘ä»¬ä»‹ç»è¿‡CLIPæ¨¡å‹ï¼Œå…¶å®å°±å¯ä»¥å®Œæˆä»æ–‡æœ¬åˆ°å›¾ç‰‡çš„æœç´¢åŠŸèƒ½ã€‚è€ŒStable Diffusionï¼Œæ˜¯çœŸçš„è®©AIâ€œç”»â€å‡ºæ¥ä¸€å¼ æ–°çš„å›¾ç‰‡ã€‚æ¯•ç«Ÿï¼Œä»¥å‰å®‡èˆªå‘˜ä¹Ÿä»æ¥æ²¡æœ‰åœ¨å¤ªç©ºéª‘è¿‡é©¬ï¼Œä¹Ÿä¸å¯èƒ½æœ‰äººæ‹ä¸‹è¿‡è¿™æ ·çš„ç…§ç‰‡ã€‚</p><h3>Stable Diffusionçš„åŸºæœ¬åŸç†</h3><p>Stable Diffusionç”Ÿæˆçš„å›¾ç‰‡æ•ˆæœçš„ç¡®ä¸é”™ï¼Œç›¸ä¿¡ä½ ä¹Ÿå¾ˆå¥½å¥‡è¿™ä¸ªäº‹æƒ…çš„åŸç†æ˜¯ä»€ä¹ˆã€‚å…¶å®ï¼ŒStable DiffusionèƒŒåä¸æ˜¯å•ç‹¬çš„ä¸€ä¸ªæ¨¡å‹ï¼Œè€Œæ˜¯ç”±å¤šä¸ªæ¨¡å‹ç»„åˆè€Œæˆçš„ã€‚æ•´ä¸ªStable Diffusionæ–‡ç”Ÿå›¾çš„è¿‡ç¨‹æ˜¯ç”±è¿™æ ·ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ç»„æˆçš„ã€‚</p><ul>\n<li>ç¬¬ä¸€ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªText-Encoderï¼ŒæŠŠæˆ‘ä»¬è¾“å…¥çš„æ–‡æœ¬å˜æˆä¸€ä¸ªå‘é‡ã€‚å®é™…ä½¿ç”¨çš„å°±æ˜¯æˆ‘ä»¬ä¸Šä¸€è®²ä»‹ç»çš„CLIPæ¨¡å‹ã€‚å› ä¸ºCLIPæ¨¡å‹å­¦ä¹ çš„æ˜¯æ–‡æœ¬å’Œå›¾åƒä¹‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥å¾—åˆ°çš„è¿™ä¸ªå‘é‡æ—¢ç†è§£äº†æ–‡æœ¬çš„å«ä¹‰ï¼Œåˆèƒ½å’Œå›¾ç‰‡çš„ä¿¡æ¯å…³è”èµ·æ¥ã€‚</li>\n<li>ç¬¬äºŒä¸ªæ˜¯Generationæ¨¡å—ï¼Œé¡¾åæ€ä¹‰æ˜¯ä¸€ä¸ªå›¾ç‰‡ä¿¡æ¯ç”Ÿæˆæ¨¡å—ã€‚è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå«åšUNetï¼Œè¿˜æœ‰ä¸€ä¸ªè°ƒåº¦å™¨ï¼ˆSchedulerï¼‰ï¼Œç”¨æ¥ä¸€æ­¥æ­¥åœ°å»é™¤å™ªå£°ã€‚è¿™ä¸ªæ¨¡å—çš„å·¥ä½œæµç¨‹æ˜¯å…ˆå¾€å‰é¢çš„ç”¨CLIPæ¨¡å‹æ¨ç†å‡ºæ¥çš„å‘é‡é‡Œæ·»åŠ å¾ˆå¤šå™ªå£°ï¼Œå†é€šè¿‡UNet+Scheduleré€æ¸å»é™¤å™ªå£°ï¼Œæœ€åæ‹¿åˆ°äº†ä¸€ä¸ªæ–°çš„å¼ é‡ã€‚è¿™ä¸ªå¼ é‡å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªå°ºå¯¸ä¸Šç¼©å°äº†çš„å›¾ç‰‡ä¿¡æ¯å‘é‡ï¼Œé‡Œé¢éšå«äº†æˆ‘ä»¬è¦ç”Ÿæˆçš„å›¾ç‰‡ä¿¡æ¯ã€‚</li>\n<li>æœ€åä¸€ä¸ªæ¨¡å—ï¼Œåˆ™æ˜¯Decoderæˆ–è€…å«åšè§£ç å™¨ã€‚èƒŒåä¹Ÿæ˜¯ä¸€ä¸ªæœºå™¨å­¦ä¹ çš„æ¨¡å‹ï¼Œå«åšVAEã€‚å®ƒä¼šæ ¹æ®ç¬¬äºŒæ­¥çš„è¿”å›ç»“æœæŠŠè¿™ä¸ªå›¾åƒä¿¡æ¯è¿˜åŸæˆæœ€ç»ˆçš„å›¾ç‰‡ã€‚</li>\n</ul><p>è¿™ä¸ªè¿‡ç¨‹ï¼Œä½ å¯ä»¥ç»“åˆStable Diffusionç›¸å…³è®ºæ–‡é‡Œçš„ä¸€å¼ æ¨¡å‹æ¶æ„å›¾æ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4c/cb/4ca19441686120b9c28c8d5ba11baacb.png?wh=598x310\" alt=\"å›¾ç‰‡\"></p><p>è¿™æ ·å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹å¤ªç†è®ºäº†ï¼Œé‚£æˆ‘ä»¬è¿˜æ˜¯çœ‹çœ‹å…·ä½“çš„ä»£ç å’Œå›¾ç‰‡ç”Ÿæˆçš„è¿‡ç¨‹å§ï¼Œè¿™æ ·å°±æ¯”è¾ƒå®¹æ˜“ç†è§£å›¾ç‰‡æ˜¯æ€ä¹ˆç”Ÿæˆçš„äº†ã€‚</p><p>æˆ‘ä»¬å…ˆæŠŠDiffusionPipelineæ‰“å°å‡ºæ¥ï¼Œçœ‹çœ‹å®ƒå†…éƒ¨æ˜¯ç”±å“ªäº›éƒ¨åˆ†ç»„æˆçš„ã€‚</p><pre><code class=\"language-python\">pipeline\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-python\">StableDiffusionPipeline {\n  \"_class_name\": \"StableDiffusionPipeline\",\n  \"_diffusers_version\": \"0.15.1\",\n  \"feature_extractor\": [\n    \"transformers\",\n    \"CLIPFeatureExtractor\"\n  ],\n  \"requires_safety_checker\": true,\n  \"safety_checker\": [\n    \"stable_diffusion\",\n    \"StableDiffusionSafetyChecker\"\n  ],\n  \"scheduler\": [\n    \"diffusers\",\n    \"PNDMScheduler\"\n  ],\n  \"text_encoder\": [\n    \"transformers\",\n    \"CLIPTextModel\"\n  ],\n  \"tokenizer\": [\n    \"transformers\",\n    \"CLIPTokenizer\"\n  ],\n  \"unet\": [\n    \"diffusers\",\n    \"UNet2DConditionModel\"\n  ],\n  \"vae\": [\n    \"diffusers\",\n    \"AutoencoderKL\"\n  ]\n}\n</code></pre><p>è¿™ä¸ªå¯¹è±¡é‡Œé¢æœ‰3éƒ¨åˆ†ã€‚</p><ol>\n<li>Tokenizerå’ŒText_Encoderï¼Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´çš„æŠŠæ–‡æœ¬å˜æˆå‘é‡çš„Text Encoderã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿™é‡Œç”¨çš„æ¨¡å‹å°±æ˜¯ä¸Šä¸€è®²çš„CLIPæ¨¡å‹ã€‚</li>\n<li>UNetå’ŒSchedulerï¼Œå°±æ˜¯å¯¹æ–‡æœ¬å‘é‡ä»¥åŠè¾“å…¥çš„å™ªå£°è¿›è¡Œå™ªå£°å»é™¤çš„ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯Generationæ¨¡å—ã€‚è¿™é‡Œç”¨çš„æ˜¯UNet2DConditionModelæ¨¡å‹ï¼Œè¿˜æŠŠPNDMSchedulerç”¨ä½œäº†å»é™¤å™ªå£°çš„è°ƒåº¦å™¨ã€‚</li>\n<li>VAEï¼Œä¹Ÿå°±æ˜¯è§£ç å™¨ï¼ˆDecoderï¼‰ï¼Œè¿™é‡Œç”¨çš„æ˜¯AutoencoderKLï¼Œå®ƒä¼šæ ¹æ®ä¸Šé¢ç”Ÿæˆçš„å›¾ç‰‡ä¿¡æ¯æœ€åè¿˜åŸå‡ºä¸€å¼ é«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡ã€‚</li>\n</ol><p>å‰©ä¸‹çš„feature_extractorï¼Œå¯ä»¥ç”¨æ¥æå–å›¾åƒç‰¹å¾ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³æ–‡ç”Ÿå›¾ï¼Œæƒ³è¦å›¾ç”Ÿå›¾ï¼Œå®ƒå°±ä¼šè¢«ç”¨æ¥æŠŠæˆ‘ä»¬è¾“å…¥çš„å›¾ç‰‡çš„ç‰¹å¾æå–æˆä¸ºå‘é‡ã€‚è€Œsafety_checkeråˆ™æ˜¯ç”¨æ¥æ£€æŸ¥ç”Ÿæˆå†…å®¹ï¼Œé¿å…ç”Ÿæˆå…·æœ‰å†’çŠ¯æ€§çš„å›¾ç‰‡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è‡ªå·±æ¥ç»„åˆä¸€ä¸‹è¿™äº›æ¨¡å‹ï¼Œæ¥æŠŠæ•´ä¸ªå›¾ç‰‡ç”Ÿæˆçš„è¿‡ç¨‹ç»™æ¼”ç¤ºå‡ºæ¥ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠä¸Šé¢Stable Diffusion 1.5éœ€è¦çš„æ¨¡å‹ç»„ä»¶éƒ½åŠ è½½å‡ºæ¥ã€‚</p><pre><code class=\"language-python\">from transformers import CLIPTextModel, CLIPTokenizer\nfrom diffusers import AutoencoderKL, UNet2DConditionModel, PNDMScheduler\n\nvae = AutoencoderKL.from_pretrained(\"runwayml/stable-diffusion-v1-5\", subfolder=\"vae\")\ntokenizer = CLIPTokenizer.from_pretrained(\"openai/clip-vit-large-patch14\")\ntext_encoder = CLIPTextModel.from_pretrained(\"openai/clip-vit-large-patch14\")\nunet = UNet2DConditionModel.from_pretrained(\"runwayml/stable-diffusion-v1-5\", subfolder=\"unet\")\nscheduler = PNDMScheduler.from_pretrained(\"runwayml/stable-diffusion-v1-5\", subfolder=\"scheduler\")\n\ntorch_device = \"cuda\"\nvae.to(torch_device)\ntext_encoder.to(torch_device)\nunet.to(torch_device)\n</code></pre><p><strong>æ³¨æ„ï¼Œå¯¹åº”çš„CLIPTokenizerå’ŒCLIPTextModelçš„åå­—å¹¶ä¸æ˜¯stable-diffusion-v1-5ï¼Œå¦‚æœä½¿ç”¨Diffusersåº“çš„Pipelineçš„è¯ï¼Œå¯ä»¥ä»æ¨¡å‹é‡Œé¢å¯¹åº”æ¨¡å—çš„ <a href=\"https://huggingface.co/runwayml/stable-diffusion-v1-5/blob/main/text_encoder/config.json\">config.json</a> è¯»å–åˆ°å®ƒä»¬ã€‚</strong></p><p>ç„¶åï¼Œæˆ‘ä»¬æŠŠæ¥ä¸‹æ¥ç”Ÿæˆå›¾ç‰‡çš„å‚æ•°åˆå§‹åŒ–ä¸€ä¸‹ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å¯¹åº”çš„å›¾ç‰‡åˆ†è¾¨ç‡ï¼Œä»¥åŠä¸€ç³»åˆ—æ¨¡å‹ä¸­éœ€è¦ä½¿ç”¨çš„è¶…å‚æ•°ã€‚</p><pre><code class=\"language-python\">import torch\n\nprompt = [\"a photograph of an astronaut riding a horse\"]\nheight = 512  # default height of Stable Diffusion\nwidth = 512  # default width of Stable Diffusion\nnum_inference_steps = 25  # Number of denoising steps\nguidance_scale = 7.5  # Scale for classifier-free guidance\ngenerator = torch.manual_seed(42)  # Seed generator to create the inital latent noise\nbatch_size = len(prompt)\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬æŠŠå¯¹åº”çš„è¾“å…¥æ–‡æœ¬å˜æˆä¸€ä¸ªå‘é‡ï¼Œç„¶åå†æ ¹æ®ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ç”Ÿæˆä¸€ä¸ªâ€œæ— æ¡ä»¶â€çš„å‘é‡ï¼Œæœ€åæŠŠä¸¤ä¸ªå‘é‡æ‹¼æ¥åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å®é™…ç”Ÿæˆå›¾ç‰‡çš„è¿‡ç¨‹ï¼Œå°±æ˜¯é€æ¸ä»è¿™ä¸ªæ— æ¡ä»¶çš„å‘é‡å‘è¾“å…¥æ–‡æœ¬è¡¨ç¤ºçš„å‘é‡é æ‹¢çš„è¿‡ç¨‹ã€‚</p><pre><code class=\"language-python\">text_input = tokenizer(\n    prompt, padding=\"max_length\", max_length=tokenizer.model_max_length, truncation=True, return_tensors=\"pt\"\n)\n\nwith torch.no_grad():\n    text_embeddings = text_encoder(text_input.input_ids.to(torch_device))[0]\n\nmax_length = text_input.input_ids.shape[-1]\nuncond_input = tokenizer([\"\"] * batch_size, padding=\"max_length\", max_length=max_length, return_tensors=\"pt\")\nuncond_embeddings = text_encoder(uncond_input.input_ids.to(torch_device))[0]\n\ntext_embeddings = torch.cat([uncond_embeddings, text_embeddings])\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”Ÿæˆä¸€ç³»åˆ—éšæœºå™ªå£°ã€‚</p><pre><code class=\"language-python\">latents = torch.randn(\n    (batch_size, unet.in_channels, height // 8, width // 8),\n    generator=generator,\n)\nlatents = latents.to(torch_device)\n\nlatents = latents * scheduler.init_noise_sigma\n</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯ç”Ÿæˆå›¾ç‰‡çš„ä»£ç äº†ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸¤ä¸ªå‡½æ•°ï¼Œå®ƒä»¬ä¼šåˆ†åˆ«æ˜¾ç¤ºGenerationæ¨¡å—ç”Ÿæˆå‡ºæ¥çš„å›¾ç‰‡ä¿¡æ¯ï¼Œä»¥åŠDecoderæ¨¡å—è¿˜åŸå‡ºæ¥çš„æœ€ç»ˆå›¾ç‰‡ã€‚</p><pre><code class=\"language-python\">import PIL\nimport torch\nimport numpy as np\nfrom PIL import Image\nfrom IPython.display import display\n\ndef display_denoised_sample(sample, i):\n    image_processed = sample.cpu().permute(0, 2, 3, 1)\n    image_processed = (image_processed + 1.0) * 127.5\n    image_processed = image_processed.numpy().astype(np.uint8)\n\n    image_pil = PIL.Image.fromarray(image_processed[0])\n    display(f\"Denoised Sample @ Step {i}\")\n    display(image_pil)\n    return image_pil\n\ndef display_decoded_image(latents, i):\n  # scale and decode the image latents with vae\n  latents = 1 / 0.18215 * latents\n  with torch.no_grad():\n    image = vae.decode(latents).sample\n    image = (image / 2 + 0.5).clamp(0, 1)\n    image = image.detach().cpu().permute(0, 2, 3, 1).numpy()\n    images = (image * 255).round().astype(\"uint8\")\n    pil_images = [Image.fromarray(image) for image in images]\n    display(f\"Decoded Image @ step {i}\")\n    display(pil_images[0])\n    return pil_images[0]\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡Diffusionç®—æ³•ä¸€æ­¥ä¸€æ­¥æ¥ç”Ÿæˆå›¾ç‰‡å°±å¥½äº†ã€‚æˆ‘ä»¬æ ¹æ®å‰é¢æŒ‡å®šçš„å‚æ•°ï¼Œå¾ªç¯äº†25æ­¥ï¼Œæ¯ä¸€æ­¥éƒ½é€šè¿‡Schedulerå’ŒUNetæ¥è¿›è¡Œå›¾ç‰‡å»å™ªå£°çš„æ“ä½œã€‚å¹¶ä¸”æ¯5æ­¥éƒ½æŠŠå¯¹åº”å»å™ªåçš„å›¾ç‰‡ä¿¡æ¯ï¼Œä»¥åŠè§£ç åè¿˜åŸçš„å›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥ã€‚</p><pre><code class=\"language-python\">from tqdm.auto import tqdm\n\nscheduler.set_timesteps(num_inference_steps)\n\ndenoised_images = []\ndecoded_images = []\nfor i, t in enumerate(tqdm(scheduler.timesteps)):\n    # expand the latents if we are doing classifier-free guidance to avoid doing two forward passes.\n    latent_model_input = torch.cat([latents] * 2)\n\n    latent_model_input = scheduler.scale_model_input(latent_model_input, timestep=t)\n\n    # predict the noise residual\n    with torch.no_grad():\n        noise_pred = unet(latent_model_input, t, encoder_hidden_states=text_embeddings).sample\n\n    # perform guidance\n    noise_pred_uncond, noise_pred_text = noise_pred.chunk(2)\n    noise_pred = noise_pred_uncond + guidance_scale * (noise_pred_text - noise_pred_uncond)\n\n    # compute the previous noisy sample x_t -&gt; x_t-1\n    latents = scheduler.step(noise_pred, t, latents).prev_sample\n    if i % 5 == 0:\n      denoised_image = display_denoised_sample(latents, i)\n      decoded_image = display_decoded_image(latents, i)\n      denoised_images.append(denoised_image)\n      decoded_images.append(decoded_image)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">Denoised Sample @ Step 0\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e8/77/e8fa98c88172482a84f3dbfeb0ecdf77.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 0\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e2/b9/e2ef3c2972d3b73a3c93976ce19a6fb9.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Denoised Sample @ Step 5\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/7e/c1/7e385e61f741f470c490c39d41b0c3c1.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 5\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/b8/dd/b81cb29b003412c80519c7b9f01baedd.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Denoised Sample @ Step 10\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/fd/06/fd262baafbb52271b0d906d00a167c06.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 10\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/a6/22/a6be734e2813e80b8bd8b936c0741a22.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Denoised Sample @ Step 15\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/04/8c/04e1da57c913da86b83a6e30ddc1338c.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 15\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/88/88/888d083873245d5b08780f52d8990788.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Denoised Sample @ Step 20\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/8a/b3/8a8ee2751036cfe7yy6e2c0d70104bb3.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 20\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/8f/f7/8f094d4deacec42876201388c2ab24f7.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Denoised Sample @ Step 25\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/6a/a3/6a4c08550f36f249ac495e4f966a90a3.png?wh=64x64\" alt=\"å›¾ç‰‡\"></p><pre><code class=\"language-plain\">Decoded Image @ step 25\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e3/37/e3de66377a02e3db266ced384de8b337.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><p>è¿è¡Œå®Œç¨‹åºï¼Œä½ å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å›¾ç‰‡æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥ä»å®Œå…¨çš„å™ªç‚¹è¿˜åŸæˆä¸€å¼ å›¾ç‰‡çš„äº†ã€‚è€Œä¸”ä½ ä»”ç»†è§‚å¯Ÿï¼Œè¿˜å¯ä»¥çœ‹åˆ°Generationç”Ÿæˆçš„å›¾åƒä¿¡æ¯ï¼Œç±»ä¼¼äºDecoderè¿˜åŸå‡ºæ¥çš„å›¾åƒä¿¡æ¯çš„è½®å»“ã€‚è¿™æ˜¯å› ä¸ºU-Netå…¶å®æ˜¯ä¸€ä¸ªå›¾ç‰‡è¯­ä¹‰åˆ†å‰²çš„æ¨¡å‹ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬æ‰“å°ä¸€ä¸‹ç”Ÿæˆçš„å›¾ç‰‡çš„ç»´åº¦ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒGenerationç”Ÿæˆçš„å›¾åƒä¿¡æ¯åˆ†è¾¨ç‡åªæœ‰64x64ï¼Œè€Œæˆ‘ä»¬è¿˜åŸå‡ºæ¥çš„å›¾ç‰‡åˆ†è¾¨ç‡æ˜¯512x512ã€‚</p><pre><code class=\"language-plain\">print(latents.shape)\nlatents = 1 / 0.18215 * latents\nwith torch.no_grad():\n    image = vae.decode(latents).sample\n    print(image.shape)\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">torch.Size([1, 4, 64, 64])\ntorch.Size([1, 3, 512, 512])\n</code></pre><h3>å›¾ç”Ÿå›¾</h3><p>ç›¸ä¿¡ä½ å·²ç»ç†è§£äº†è¿™ä¸ªStable Diffusionç”Ÿæˆå›¾ç‰‡çš„è¿‡ç¨‹ï¼Œä»¥åŠè¿‡ç¨‹é‡Œæ¯ä¸ªæ¨¡å—çš„å·¥ä½œäº†ã€‚é‚£ä½ åº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£å¦‚ä½•é€šè¿‡Stable Diffusionå®ç°å›¾ç”Ÿå›¾äº†ï¼Œæˆ‘ä»¬ä¸‹é¢å°±æ¥å…·ä½“çœ‹ä¸€çœ‹ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å°±ä¸ç”¨è‡ªå·±ä¸€æ­¥æ­¥è°ƒç”¨å„ä¸ªæ¨¡å—æ¥å®ç°å›¾ç”Ÿå›¾äº†ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨Diffusersåº“é‡Œè‡ªå¸¦çš„Pipelineã€‚</p><pre><code class=\"language-plain\">import torch\nfrom PIL import Image\nfrom io import BytesIO\n\nfrom diffusers import StableDiffusionImg2ImgPipeline\n\ndevice = \"cuda\"\nmodel_id_or_path = \"runwayml/stable-diffusion-v1-5\"\npipe = StableDiffusionImg2ImgPipeline.from_pretrained(model_id_or_path, torch_dtype=torch.float16)\npipe = pipe.to(device)\n\nimage_file = \"./data/sketch-mountains-input.jpg\"\n\ninit_image = Image.open(image_file).convert(\"RGB\")\ninit_image = init_image.resize((768, 512))\n\nprompt = \"A fantasy landscape, trending on artstation\"\n\nimages = pipe(prompt=prompt, image=init_image, strength=0.75, guidance_scale=7.5).images\n\ndisplay(init_image)\ndisplay(images[0])\n</code></pre><p>è¾“å‡ºç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/d2/2c/d262d17cb96yyd721eeca30c70e40c2c.png?wh=768x512\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/71/e4/712c084e85b258ceeb2ca64c8d043fe4.png?wh=768x512\" alt=\"å›¾ç‰‡\"></p><p>å¯¹åº”çš„ä»£ç ä¹Ÿéå¸¸ç®€å•ï¼Œæˆ‘ä»¬æŠŠPipelineæ¢æˆäº†StableDiffusionImg2ImgPipelineï¼Œæ­¤å¤–é™¤äº†è¾“å…¥ä¸€æ®µæ–‡æœ¬ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€å¼ è‰ç¨¿å›¾ã€‚ç„¶åï¼Œä½ å¯ä»¥çœ‹åˆ°å¯¹åº”ç”Ÿæˆçš„å›¾ç‰‡çš„è½®å»“ï¼Œå°±ç±»ä¼¼äºæˆ‘ä»¬æä¾›çš„è‰ç¨¿å›¾ã€‚è€Œå›¾ç‰‡çš„å†…å®¹é£æ ¼ï¼Œåˆ™æ˜¯æŒ‰ç…§æˆ‘ä»¬æ–‡æœ¬æç¤ºè¯­çš„å†…å®¹ç”Ÿæˆçš„ã€‚</p><p>StableDiffusionImg2ImgPipelineçš„ç”Ÿæˆè¿‡ç¨‹ï¼Œå…¶å®å’Œæˆ‘ä»¬ä¹‹å‰æ‹†è§£çš„ä¸€æ­¥æ­¥ç”Ÿæˆå›¾ç‰‡çš„è¿‡ç¨‹æ˜¯ç›¸åŒçš„ã€‚<strong>å”¯ä¸€çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œæˆ‘ä»¬å…¶å®ä¸æ˜¯ä»ä¸€ä¸ªå®Œå…¨éšæœºçš„å™ªå£°å¼€å§‹çš„ï¼Œè€Œæ˜¯æŠŠå¯¹åº”çš„è‰ç¨¿å›¾ï¼Œé€šè¿‡VAEçš„ç¼–ç å™¨ï¼Œå˜æˆå›¾åƒç”Ÿæˆä¿¡æ¯ï¼Œåˆåœ¨ä¸Šé¢åŠ äº†éšæœºçš„å™ªå£°ã€‚</strong>æ‰€ä»¥ï¼Œå»é™¤å™ªéŸ³çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹åº”çš„è‰ç¨¿å›¾çš„è½®å»“å°±ä¼šé€æ­¥å‡ºç°äº†ã€‚è€Œåœ¨ä¸€æ­¥æ­¥ç”Ÿæˆå›¾ç‰‡çš„è¿‡ç¨‹ä¸­ï¼Œå†…å®¹åˆä¼šå‘æˆ‘ä»¬ç»™å‡ºçš„æç¤ºè¯­çš„å†…å®¹æ¥å­¦ä¹ ã€‚</p><p>è€Œå¦‚æœæˆ‘ä»¬æ¢ä¸€ä¸‹æç¤ºè¯­ï¼Œå°±èƒ½æ›´æ”¹ç”Ÿæˆçš„å…·ä½“å†…å®¹ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³æ¢æˆå®«å´éªçš„é£æ ¼ï¼Œå¹¶ä¸”å¸Œæœ›åé¢é«˜è€¸çš„ä¸æ˜¯å±±ï¼Œè€Œæ˜¯åŸå ¡ï¼Œå‡ºç°çš„å›¾ç‰‡è¿˜æ˜¯ç›¸åŒçš„è½®å»“ï¼Œä½†æ˜¯ç”¨ä¸åŒçš„å†…å®¹ã€‚æˆ‘åœ¨ä¸‹é¢ç»™å‡ºäº†ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œä½ å¯ä»¥è‡ªå·±çœ‹ä¸€çœ‹ã€‚</p><pre><code class=\"language-plain\">prompt = \"ghibli style, a fantasy landscape with castles\"\nimages = pipe(prompt=prompt, image=init_image, strength=0.75, guidance_scale=7.5).images\n\ndisplay(init_image)\ndisplay(images[0])\n</code></pre><p>è¾“å‡ºç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/bb/ff/bb7a09c91feda214ee71a57d3ab479ff.png?wh=768x512\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/b8/de/b8c0054e8abc08a5657f8a6f9c6afede.png?wh=768x512\" alt=\"å›¾ç‰‡\"></p><h3>æ›´å¤šä½¿ç”¨æ–¹æ³•</h3><p>ç†è§£äº†Stable Diffusionçš„åŸºæœ¬æ¡†æ¶ï¼Œä½ å¯ä»¥è¯•ä¸€è¯•æ›´å¤šç›¸å…³çš„Pipelineçš„ç”¨æ³•ã€‚æ¯”å¦‚ï¼Œé™¤äº†å¼•å¯¼å†…å®¹ç”Ÿæˆçš„æç¤ºè¯­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®ä¸€ä¸ªè´Ÿé¢çš„æç¤ºè¯­ï¼ˆnegative promptï¼‰ï¼Œä¹Ÿå°±æ˜¯æ’é™¤ä¸€äº›å†…å®¹ã€‚</p><pre><code class=\"language-plain\">prompt = \"ghibli style, a fantasy landscape with castles\"\nnegative_prompt = \"river\"\nimages = pipe(prompt=prompt, negative_prompt=negative_prompt, image=init_image, strength=0.75, guidance_scale=7.5).images\n\ndisplay(images[0])\n</code></pre><p>è¾“å‡ºç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/2b/1c/2b9ce1b91e306d256fc29dc13d68d51c.png?wh=768x512\" alt=\"å›¾ç‰‡\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å›¾ç‰‡é‡Œé¢å°½é‡æ’é™¤â€œRiverâ€ã€‚è€Œæ–°ç”Ÿæˆçš„å›¾ç‰‡ï¼Œå³è¾¹å°±æ²¡æœ‰äº†ä»»ä½•ç±»ä¼¼äºæ²³æµçš„å†…å®¹ï¼Œè€Œä¸­é—´è“è‰²çš„éƒ¨åˆ†ä¹Ÿæ›´åƒä¸€ä¸ªæ’æ°´æ¸ è€Œä¸æ˜¯è‡ªç„¶çš„æ²³æµã€‚è´Ÿé¢æç¤ºè¯­å¹¶ä¸ä¼šæ”¹å˜æ¨¡å‹çš„ç»“æ„ã€‚å®ƒå…¶å®å°±æ˜¯æŠŠåŸå…ˆçš„â€œæ— æ¡ä»¶â€å‘é‡ï¼Œæ›¿æ¢æˆäº†è´Ÿé¢æç¤ºè¯­çš„å‘é‡ã€‚è¿™æ ·ï¼Œæ¨¡å‹å°±å°½å¯èƒ½ä»è´Ÿé¢çš„æç¤ºè¯­æ–‡æœ¬å†…å®¹ä¸­å‘æˆ‘ä»¬æ­£é¢çš„æç¤ºè¯­æ–‡æœ¬å†…å®¹å­¦ä¹ ï¼Œä¹Ÿå°±æ˜¯å°½é‡è¿œç¦»è´Ÿé¢æç¤ºè¯­çš„å†…å®¹ã€‚</p><p>åŒæ ·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡Stable Diffusionæ¥æå‡å›¾ç‰‡çš„åˆ†è¾¨ç‡ï¼Œåªä¸è¿‡éœ€è¦ä¸€ä¸ªå•ç‹¬çš„æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹å°±æ˜¯ä¸“é—¨åœ¨ä¸€ä¸ªé«˜ä½åˆ†è¾¨ç‡çš„å›¾ç‰‡ç»„åˆä¸Šè®­ç»ƒå‡ºæ¥çš„ã€‚å¯¹åº”çš„UNetå’ŒVAEçš„æ¨¡å‹æ˜¯å’ŒåŸå§‹çš„Stable Diffusionä¸ä¸€æ ·çš„ã€‚</p><pre><code class=\"language-plain\">from diffusers import StableDiffusionUpscalePipeline\n\n# load model and scheduler\nmodel_id = \"stabilityai/stable-diffusion-x4-upscaler\"\npipeline = StableDiffusionUpscalePipeline.from_pretrained(\n    model_id, revision=\"fp16\", torch_dtype=torch.float16\n)\npipeline = pipeline.to(\"cuda\")\n\n# let's download an  image\nlow_res_img_file = \"./data/low_res_cat.png\"\nlow_res_img = Image.open(low_res_img_file).convert(\"RGB\")\nlow_res_img = low_res_img.resize((128, 128))\n\nprompt = \"a white cat\"\n\nupscaled_image = pipeline(prompt=prompt, image=low_res_img).images[0]\n\nlow_res_img_resized = low_res_img.resize((512, 512))\n\ndisplay(low_res_img_resized)\ndisplay(upscaled_image)\n</code></pre><p>è¾“å‡ºç»“æœï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/f4/c4/f47e50c28203eb7a0d8f7667f69023c4.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/2b/b6/2be70a657f415b11489afa86639faeb6.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><p>å¦‚æœæˆ‘ä»¬æ‰“å°ä¸€ä¸‹pipelineï¼Œå¯¹åº”çš„æ¨¡å‹çš„ç»„ä»¶è¿˜æ˜¯ç›¸åŒçš„ã€‚</p><pre><code class=\"language-plain\">pipeline\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-plain\">StableDiffusionUpscalePipeline {\n  \"_class_name\": \"StableDiffusionUpscalePipeline\",\n  \"_diffusers_version\": \"0.15.1\",\n  \"low_res_scheduler\": [\n    \"diffusers\",\n    \"DDPMScheduler\"\n  ],\n  \"max_noise_level\": 350,\n  \"scheduler\": [\n    \"diffusers\",\n    \"DDIMScheduler\"\n  ],\n  \"text_encoder\": [\n    \"transformers\",\n    \"CLIPTextModel\"\n  ],\n  \"tokenizer\": [\n    \"transformers\",\n    \"CLIPTokenizer\"\n  ],\n  \"unet\": [\n    \"diffusers\",\n    \"UNet2DConditionModel\"\n  ],\n  \"vae\": [\n    \"diffusers\",\n    \"AutoencoderKL\"\n  ]\n}\n</code></pre><p>ä½†æ˜¯å¦‚æœä½ å»çœ‹å¯¹åº”æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ° <a href=\"https://huggingface.co/stabilityai/stable-diffusion-x4-upscaler/blob/main/vae/config.json\">VAE</a> å’Œ <a href=\"https://huggingface.co/stabilityai/stable-diffusion-x4-upscaler/blob/main/unet/config.json\">UNet</a> é‡Œä½¿ç”¨çš„æ¨¡å‹éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h2>ä½¿ç”¨ç¤¾åŒºé‡Œçš„å…¶ä»–æ¨¡å‹</h2><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°Stable Diffusionå¹¶ä¸æ˜¯æŒ‡æŸä¸€ä¸ªç‰¹å®šçš„æ¨¡å‹ï¼Œè€Œæ˜¯æŒ‡ä¸€ç±»æ¨¡å‹ç»“æ„ã€‚å› ä¸ºStable Diffusionæ˜¯å®Œå…¨å¼€æºçš„ï¼Œæ‰€ä»¥ä½ å¤§å¯ä»¥åˆ©ç”¨è‡ªå·±çš„æ•°æ®å»è®­ç»ƒä¸€ä¸ªå±äºè‡ªå·±çš„æ¨¡å‹ã€‚äº‹å®ä¸Šï¼Œå¸‚é¢ä¸Šå¼€æºè®­ç»ƒå‡ºæ¥çš„Stable Diffusionçš„æ¨¡å‹éå¸¸å¤šï¼Œä¹Ÿå·²ç»æœ‰äº†åƒ <a href=\"https://civitai.com/\">CIVITAI</a> è¿™æ ·çš„åˆ†äº«Stable Diffusionæ¨¡å‹çš„å¹³å°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a1/4d/a119771cc79yyf74d283a195c663c04d.png?wh=1240x1213\" alt=\"å›¾ç‰‡\" title=\"CIVITAI é‡Œæœ‰ç”¨æˆ·ä»¬è‡ªå·±è®­ç»ƒçš„å„ç§é£æ ¼çš„æ¨¡å‹\"></p><p>æˆ‘ä»¬å¯ä»¥å»CIVITAIçš„ç½‘ç«™ï¼Œæ‰¾åˆ°æˆ‘ä»¬å–œæ¬¢çš„æ¨¡å‹ã€‚æ¯”å¦‚æˆ‘ä»¬ä¸“é—¨æ‰¾ä¸€ä¸ªäºŒæ¬¡å…ƒçš„æ¨¡å‹ <a href=\"https://civitai.com/models/4468/counterfeit-v25\">counterfeit-V2.5</a>ã€‚åœ¨å¯¹åº”çš„æ¨¡å‹é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒç›´æ¥å°±åŒ…å«äº†Huggingfaceé‡Œé¢çš„æ¨¡å‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2c/15/2cd2d729e7ac70e0f829c319d85a1715.png?wh=1240x730\" alt=\"å›¾ç‰‡\"></p><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥é€šè¿‡Diffuersåº“æ¥è°ƒç”¨è¿™ä¸ªæ¨¡å‹ã€‚</p><pre><code class=\"language-plain\">pipeline.to(\"cuda\")\n\nprompt = \"((masterpiece,best quality)),1girl, solo, animal ears, rabbit, barefoot, knees up, dress, sitting, rabbit ears, short sleeves, looking at viewer, grass, short hair, smile, white hair, puffy sleeves, outdoors, puffy short sleeves, bangs, on ground, full body, animal, white dress, sunlight, brown eyes, dappled sunlight, day, depth of field\"\nnegative_prompt = \"EasyNegative, extra fingers,fewer fingers,\"\nimage = pipeline(prompt=prompt, negative_prompt=negative_prompt).images[0]\nimage\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/03/50/03041115b93c8d53ed71fd2ff7fcf750.png?wh=512x512\" alt=\"å›¾ç‰‡\"></p><p>å½“ç„¶ï¼Œä¸æ˜¯æ‰€æœ‰CIVITAIé‡Œçš„æ¨¡å‹éƒ½åœ¨Huggingfaceä¸Šæä¾›äº†è‡ªå·±çš„æ¨¡å‹ç‰ˆæœ¬ã€‚é»˜è®¤CIVITAIçš„æ¨¡å‹ï¼Œå¾€å¾€åªæ˜¯æä¾›äº†ä¸€ä¸ªæ¨¡å‹æƒé‡æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ç°åœ¨æœ€æµè¡Œçš„ <a href=\"https://github.com/AUTOMATIC1111/stable-diffusion-webui\">Stable-Diffusion-Web-UI åº”ç”¨</a>æ¥ä½¿ç”¨è¿™ä¸ªæ¨¡å‹æƒé‡æ–‡ä»¶ã€‚ä½ å¯ä»¥æŠŠWeb-UIåœ¨æœ¬åœ°éƒ¨ç½²èµ·æ¥ï¼Œå®ƒä¼šæä¾›ä¸€ä¸ªå›¾å½¢ç•Œé¢è®©ä½ ä¸ç”¨å†™ä»£ç å°±å¯ä»¥ç›´æ¥è°ƒæ•´å„ç§å‚æ•°æ¥ç”Ÿæˆå›¾ç‰‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/61/1d/616244d69ed59bb3e8935ec7fbfba91d.png?wh=1236x966\" alt=\"å›¾ç‰‡\" title=\"æ¥è‡ª stable-diffusion-web-ui çš„å›¾å½¢ç•Œé¢\"></p><p><a href=\"https://github.com/civitai/civitai/wiki\">CIVITAI çš„ Wiki</a> é‡Œé¢ä¹Ÿè¯¦ç»†æä¾›äº†åœ¨Stable-Diffusion-Web-UIé‡Œé¢ä½¿ç”¨æ¨¡å‹çš„æ­¥éª¤ï¼Œä½ å¯ä»¥ç…§ç€è¿™ä¸ªæ­¥éª¤å¤šæ‹¿å‡ ä¸ªæ¨¡å‹è¯•è¯•çœ‹ã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œè¿™å°±æ˜¯ä»Šå¤©çš„ä¸»è¦å†…å®¹ï¼Œæœ€åæˆ‘ä»¬ä¸€èµ·æ¥å›é¡¾ä¸€ä¸‹ã€‚</p><p>è¿™ä¸€è®²ï¼Œæˆ‘å¸¦ç€ä½ ä½“éªŒäº†ä¸€ä¸‹Stable Diffusionè¿™ä¸ªå›¾ç‰‡ç”Ÿæˆçš„å¼€æºæ¨¡å‹ã€‚æˆ‘ä»¬ä¸ä»…é€šè¿‡Diffusersè¿™ä¸ªå°è£…å¥½çš„Pythonåº“ï¼Œä½“éªŒäº†æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€æå‡å›¾ç‰‡åˆ†è¾¨ç‡ç­‰ä¸€ç³»åˆ—åº”ç”¨ï¼Œä¹Ÿæ·±å…¥åˆ°Stable Diffusionçš„æ¨¡å‹å†…éƒ¨ï¼Œç†è§£äº†æ•´ä¸ªæ¨¡å‹çš„ç»“æ„ï¼Œè¿˜çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥ä»ä¸€å¼ å…¨æ˜¯å™ªç‚¹çš„å›¾ç‰‡ï¼Œé€æ¸å»é™¤å™ªå£°å˜æˆä¸€å¼ å¯ç”¨çš„å›¾ç‰‡çš„ã€‚</p><p>åœ¨ä½“éªŒäº†åŸºç¡€çš„æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬ä¹Ÿä¸€èµ·å°è¯•äº†ä¸€ä¸‹å…¶ä»–çˆ±å¥½è€…è‡ªå·±ç”Ÿæˆçš„æ¨¡å‹ã€‚è¿™ä¹Ÿæ˜¯ä¸‹ä¸€è®²æˆ‘ä»¬è¦ä»‹ç»çš„é‡ç‚¹å†…å®¹ã€‚æˆ‘ä»¬ä¼šäº†è§£åˆ°å¦‚ä½•é€šè¿‡ LoRa è¿™æ ·çš„ç®—æ³•è¿›è¡Œæ¨¡å‹å¾®è°ƒï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ControlNetè®©æˆ‘ä»¬ç”Ÿæˆçš„å›¾ç‰‡æ›´åŠ å¯æ§ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼ŒæŒ‰ç…§æƒ¯ä¾‹è¿˜æ˜¯ç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜ã€‚é™¤äº†ä»Šå¤©ç»™ä½ æ¼”ç¤ºçš„è¿™äº›åº”ç”¨ä¹‹å¤–ï¼ŒHuggingFaceè¿˜æä¾›äº†å¾ˆå¤šå®æˆ˜åœºæ™¯ã€‚æ¯”å¦‚ï¼Œä½ å°±å¯ä»¥é€šè¿‡ <a href=\"https://huggingface.co/docs/diffusers/using-diffusers/inpaint\">StableDiffusionInpaintPipeline</a>ï¼Œç”¨ä¸€ä¸ªé®ç…§å›¾ç‰‡å’Œä¸€æ®µæç¤ºè¯­æ¥ä¿®æ”¹å›¾ç‰‡ç”»é¢ä¸­çš„æŸä¸€éƒ¨åˆ†å…ƒç´ ã€‚</p><p>ä½ å¯ä»¥ç…§ç€<a href=\"https://huggingface.co/docs/diffusers/using-diffusers/inpaint\">å®˜æ–¹æ–‡æ¡£</a>ï¼Œä½“éªŒä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ï¼Œç ”ç©¶ä¸€ä¸‹æºä»£ç ï¼Œæƒ³æƒ³è¿™ä¸ªåŠŸèƒ½æ˜¯å¦‚ä½•é€šè¿‡Stable Diffusionçš„æ¨¡å‹ç»“æ„å®ç°çš„ã€‚æ¬¢è¿ä½ æŠŠä½ ä½“éªŒä¹‹åçš„æ„Ÿå—ä»¥åŠæ€è€ƒåçš„ç»“æœåˆ†äº«åœ¨è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ä¸€è®²åˆ†äº«ç»™æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²å†è§ï¼</p><h2>æ¨èé˜…è¯»</h2><p>è¿™ä¸€è®²é‡Œï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•ä»‹ç»äº†ä¸€ä¸‹Stable Diffusionçš„æ¨¡å‹ç»“æ„ã€‚å…¶å®ï¼Œæ— è®ºæ˜¯DALL-E 2è¿˜æ˜¯Imagenï¼Œé‡‡ç”¨çš„å›¾ç‰‡ç”Ÿæˆæ–¹å¼éƒ½æ˜¯å’ŒStable Diffusionç±»ä¼¼çš„ã€‚å¦‚æœä½ æƒ³è¦æ·±å…¥äº†è§£ä¸€ä¸‹è¿™äº›æ¨¡å‹çš„ç»“æ„ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹Bç«™é‡Œé¢â€œè·Ÿææ²å­¦AIâ€é‡Œé¢å¯¹äº <a href=\"https://www.bilibili.com/video/BV17r4y1u77B/?spm_id_from=333.999.0.0\">DALL-E 2 è®ºæ–‡çš„è®²è§£</a>ã€‚</p>","neighbors":{"left":{"article_title":"23ï½œOpenClipï¼šè®©æˆ‘ä»¬ææ¸…æ¥šå›¾ç‰‡è¯´äº†äº›ä»€ä¹ˆ","id":653489},"right":{"article_title":"25ï½œControlNetï¼šè®©ä½ çš„å›¾æ‹¥æœ‰ä¸€ä¸ªâ€œéª¨æ¶â€","id":655496}},"comments":[{"had_liked":false,"id":373857,"user_name":"ä¸œæ–¹å¥‡éª¥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"å››å·","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1683267308,"is_pvip":false,"replies":[{"id":136856,"content":"æ¥è‡ªGPT-4çš„å›ç­”ï¼š\n\nâ€œStable Diffusionæ˜¯ä¸€ç§ç”Ÿæˆæ¨¡å‹ï¼Œå®ƒé€šè¿‡åœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œå¹¶åœ¨éšåçš„æ­¥éª¤ä¸­é€æ¸å‡å°‘è¿™ç§å™ªå£°ï¼Œæ¥ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ã€‚è¿™ç§æ–¹æ³•çš„çµæ„Ÿæ¥è‡ªç‰©ç†å­¦ä¸­çš„æ‰©æ•£è¿‡ç¨‹ï¼Œè¿™å°±æ˜¯å®ƒçš„åç§°ä¸­åŒ…å«&quot;Diffusion&quot;çš„åŸå› ã€‚æ‰©æ•£è¿‡ç¨‹é€šå¸¸æ¶‰åŠåˆ°éšæœºæ€§å’Œæ¢¯åº¦ä¸‹é™ï¼Œå®ƒä»¬éƒ½åœ¨Stable Diffusionæ¨¡å‹ä¸­æ‰¾åˆ°äº†ä½“ç°ã€‚\n\nç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸ºä»€ä¹ˆè¿™æ ·åšï¼š\n\nä¿ç•™åŸæœ‰æ•°æ®çš„å¤æ‚æ€§ï¼šç›´æ¥ä»åŸå§‹æ•°æ®ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬å¯èƒ½éå¸¸å›°éš¾ï¼Œå› ä¸ºåŸå§‹æ•°æ®çš„å¤æ‚æ€§å’Œå¤šæ ·æ€§ã€‚é€šè¿‡åœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ¨¡å‹ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒï¼ˆå¦‚é«˜æ–¯å™ªå£°åˆ†å¸ƒï¼‰å¼€å§‹å·¥ä½œï¼Œç„¶åé€æ¸é€šè¿‡å‡å°‘å™ªå£°ï¼Œä½¿å¾—æ–°çš„æ•°æ®æ ·æœ¬é€æ¸æ¥è¿‘äºåŸå§‹æ•°æ®çš„å¤æ‚åˆ†å¸ƒã€‚\n\nä½¿æ¨¡å‹æ›´å¥å£®ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ·»åŠ å’Œå‡å°‘å™ªå£°å¯ä»¥ä½œä¸ºä¸€ç§æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œå¸®åŠ©é˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆã€‚å®ƒå¼ºè¿«æ¨¡å‹åœ¨ä¸åŒçš„å™ªå£°çº§åˆ«ä¸‹éƒ½èƒ½æ­£ç¡®åœ°è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚\n\nåå‘ç”Ÿæˆï¼šå™ªå£°çš„é€æ¸å‡å°‘å®é™…ä¸Šæ˜¯å¯¹æ•°æ®ç”Ÿæˆè¿‡ç¨‹çš„é€†å‘æ¨¡æ‹Ÿã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ä»åŸå§‹æ•°æ®ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ï¼Œè€Œä¸”è¿˜å¯ä»¥åè¿‡æ¥ï¼Œä»æ–°çš„æ•°æ®æ ·æœ¬åæ¨å…¶å¯èƒ½çš„åŸå§‹æ•°æ®ã€‚\n\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆStable Diffusionæ¨¡å‹ä¼šé¦–å…ˆåœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œç„¶åé€æ¸å‡å°‘å™ªå£°çš„åŸå› ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£å’Œå¤ç°åŸå§‹æ•°æ®çš„å¤æ‚æ€§å’Œå¤šæ ·æ€§ã€‚â€","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684749920,"ip_address":"ä¸Šæµ·","comment_id":373857,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆè¦åŠ äº†å™ªå£°ï¼Œå†å»é™¤å™ªå£°ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619036,"discussion_content":"æ¥è‡ªGPT-4çš„å›ç­”ï¼š\n\nâ€œStable Diffusionæ˜¯ä¸€ç§ç”Ÿæˆæ¨¡å‹ï¼Œå®ƒé€šè¿‡åœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œå¹¶åœ¨éšåçš„æ­¥éª¤ä¸­é€æ¸å‡å°‘è¿™ç§å™ªå£°ï¼Œæ¥ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ã€‚è¿™ç§æ–¹æ³•çš„çµæ„Ÿæ¥è‡ªç‰©ç†å­¦ä¸­çš„æ‰©æ•£è¿‡ç¨‹ï¼Œè¿™å°±æ˜¯å®ƒçš„åç§°ä¸­åŒ…å«&#34;Diffusion&#34;çš„åŸå› ã€‚æ‰©æ•£è¿‡ç¨‹é€šå¸¸æ¶‰åŠåˆ°éšæœºæ€§å’Œæ¢¯åº¦ä¸‹é™ï¼Œå®ƒä»¬éƒ½åœ¨Stable Diffusionæ¨¡å‹ä¸­æ‰¾åˆ°äº†ä½“ç°ã€‚\n\nç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸ºä»€ä¹ˆè¿™æ ·åšï¼š\n\nä¿ç•™åŸæœ‰æ•°æ®çš„å¤æ‚æ€§ï¼šç›´æ¥ä»åŸå§‹æ•°æ®ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬å¯èƒ½éå¸¸å›°éš¾ï¼Œå› ä¸ºåŸå§‹æ•°æ®çš„å¤æ‚æ€§å’Œå¤šæ ·æ€§ã€‚é€šè¿‡åœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ¨¡å‹ä»ä¸€ä¸ªç›¸å¯¹ç®€å•çš„åˆ†å¸ƒï¼ˆå¦‚é«˜æ–¯å™ªå£°åˆ†å¸ƒï¼‰å¼€å§‹å·¥ä½œï¼Œç„¶åé€æ¸é€šè¿‡å‡å°‘å™ªå£°ï¼Œä½¿å¾—æ–°çš„æ•°æ®æ ·æœ¬é€æ¸æ¥è¿‘äºåŸå§‹æ•°æ®çš„å¤æ‚åˆ†å¸ƒã€‚\n\nä½¿æ¨¡å‹æ›´å¥å£®ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ·»åŠ å’Œå‡å°‘å™ªå£°å¯ä»¥ä½œä¸ºä¸€ç§æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œå¸®åŠ©é˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆã€‚å®ƒå¼ºè¿«æ¨¡å‹åœ¨ä¸åŒçš„å™ªå£°çº§åˆ«ä¸‹éƒ½èƒ½æ­£ç¡®åœ°è¿›è¡Œé¢„æµ‹ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚\n\nåå‘ç”Ÿæˆï¼šå™ªå£°çš„é€æ¸å‡å°‘å®é™…ä¸Šæ˜¯å¯¹æ•°æ®ç”Ÿæˆè¿‡ç¨‹çš„é€†å‘æ¨¡æ‹Ÿã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥ä»åŸå§‹æ•°æ®ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ï¼Œè€Œä¸”è¿˜å¯ä»¥åè¿‡æ¥ï¼Œä»æ–°çš„æ•°æ®æ ·æœ¬åæ¨å…¶å¯èƒ½çš„åŸå§‹æ•°æ®ã€‚\n\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆStable Diffusionæ¨¡å‹ä¼šé¦–å…ˆåœ¨æ•°æ®ä¸ŠåŠ å…¥å™ªå£°ï¼Œç„¶åé€æ¸å‡å°‘å™ªå£°çš„åŸå› ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£å’Œå¤ç°åŸå§‹æ•°æ®çš„å¤æ‚æ€§å’Œå¤šæ ·æ€§ã€‚â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684749920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1953765,"avatar":"","nickname":"Geek_d54869","note":"","ucode":"CF55462EF65B9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649233,"discussion_content":"åŠ å™ªçš„è¿‡ç¨‹ï¼Œå¯ä»¥ç†è§£ä¸ºæ¨¡å‹å­¦ä¹ åœ¨ä¸åŒå™ªå£°å¼ºåº¦æ‰°åŠ¨ä¸‹å›¾ç‰‡çš„ç‰¹å¾ä¿¡æ¯ï¼Œä»¥ä¾¿èƒ½å‡†ç¡®è¿˜åŸå‡ºå›¾ç‰‡å†…å®¹ï¼Œå¢å¼ºæ¨¡å‹çš„ç†è§£åŠ›å’Œé²æ£’æ€§ã€‚è€Œç”Ÿæˆè¿‡ç¨‹ï¼Œåˆ™æ˜¯åŸºäºå­¦ä¹ æˆæœä¸€æ­¥æ­¥å»å™ªï¼Œå¹¶ä¸”æ³¨å…¥promptæ–‡æœ¬è¯­ä¹‰ä¿¡æ¯ï¼Œè®©å›¾ç‰‡ä¸promptæ›´å»åˆã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1723018055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617375,"discussion_content":"è®­ç»ƒå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683534426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373957,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1683379403,"is_pvip":false,"replies":[{"id":136855,"content":"1. Stable Diffusionç”¨äº†å¤šä¸ªæ¨¡å‹ç»„åˆå•Šã€‚å…¶ä¸­è¾“å…¥çš„Promptè½¬æ¢æˆå‘é‡ç›´æ¥ç”¨çš„CLIPæ¨¡å‹\n2. è¿™ä¸ªæ˜¯è®­ç»ƒè¿‡ç¨‹ï¼Œå¯ä»¥ç†è§£ä¸ºé€šè¿‡å¢åŠ å™ªå£°å’Œæ¨¡å‹è®­ç»ƒï¼Œæˆ‘ä»¬å°±å­¦ä¼šäº†æ€ä¹ˆä»ä¸€ä¸ªéšæœºå™ªå£°çš„ä¿¡æ¯å¤åŸå‡ºä¸€å¼ å›¾ç‰‡çš„èƒ½åŠ›ã€‚\n3. å¦‚æœæœ‰GPUï¼Œæœ¬æœºå¯ä»¥è¿è¡Œï¼Œä¸ç„¶å»ºè®®ä½¿ç”¨Colabçš„åœ¨çº¿GPUç¯å¢ƒ\n4. å¯ä»¥å•Šï¼Œå¯ä»¥çœ‹çœ‹åé¢çš„VisualChatGPT\n3ï¼Œ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684749793,"ip_address":"ä¸Šæµ·","comment_id":373957,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¯·æ•™è€å¸ˆå‡ ä¸ªé—®é¢˜ï¼š\nQ1ï¼šstable Diffusioné‡‡ç”¨çš„CLIPæ˜¯è‡ªèº«çš„å—ï¼Ÿè¿˜æ˜¯è°ƒç”¨chatGPTï¼Ÿ\nQ2ï¼šå…ˆåŠ å™ªå£°ï¼Œå†å»æ‰ï¼Œæœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿåƒä¸€å£å†åä¸€å£ï¼Œæœ‰æ„æ€å—ï¼Ÿ\nâ€œå…ˆå¾€å‰é¢çš„ç”¨ CLIP æ¨¡å‹æ¨ç†å‡ºæ¥çš„å‘é‡é‡Œæ·»åŠ å¾ˆå¤šå™ªå£°ï¼Œå†é€šè¿‡ UNet+Scheduler é€æ¸å»é™¤å™ªå£°ï¼Œæœ€åæ‹¿åˆ°äº†ä¸€ä¸ªæ–°çš„å¼ é‡â€ã€‚\nQ3ï¼šæœ¬è¯¾çš„ä»£ç æ˜¯åœ¨æœ¬æœºä¸Šè¿è¡Œçš„å—ï¼Ÿæˆ‘çš„ç¬”è®°æœ¬ä¸Šæ˜¯æ™®é€šé…ç½®ï¼Œèƒ½è¿è¡Œå¹¶ç”Ÿæˆå›¾å—ï¼Ÿï¼ˆæˆ–è€…ï¼Œå›¾çš„ç”Ÿæˆæ˜¯è°ƒç”¨äº†æŸä¸ªæœåŠ¡å™¨ï¼Ÿï¼‰\nQ4ï¼šå¯ä»¥å¯¹å›¾ç‰‡è¿›è¡ŒåŠ å·¥å—ï¼Ÿ æ¯”å¦‚åœ¨ä¸€ä¸ªç…§ç‰‡çš„å¤´ä¸ŠåŠ ä¸€ä¸ªå¸½å­ã€‚","like_count":2,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619035,"discussion_content":"1. Stable Diffusionç”¨äº†å¤šä¸ªæ¨¡å‹ç»„åˆå•Šã€‚å…¶ä¸­è¾“å…¥çš„Promptè½¬æ¢æˆå‘é‡ç›´æ¥ç”¨çš„CLIPæ¨¡å‹\n2. è¿™ä¸ªæ˜¯è®­ç»ƒè¿‡ç¨‹ï¼Œå¯ä»¥ç†è§£ä¸ºé€šè¿‡å¢åŠ å™ªå£°å’Œæ¨¡å‹è®­ç»ƒï¼Œæˆ‘ä»¬å°±å­¦ä¼šäº†æ€ä¹ˆä»ä¸€ä¸ªéšæœºå™ªå£°çš„ä¿¡æ¯å¤åŸå‡ºä¸€å¼ å›¾ç‰‡çš„èƒ½åŠ›ã€‚\n3. å¦‚æœæœ‰GPUï¼Œæœ¬æœºå¯ä»¥è¿è¡Œï¼Œä¸ç„¶å»ºè®®ä½¿ç”¨Colabçš„åœ¨çº¿GPUç¯å¢ƒ\n4. å¯ä»¥å•Šï¼Œå¯ä»¥çœ‹çœ‹åé¢çš„VisualChatGPT\n3ï¼Œ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684749793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1514261,"avatar":"https://static001.geekbang.org/account/avatar/00/17/1b/15/75c16cb5.jpg","nickname":"æœ±æœ±","note":"","ucode":"889FBF262D5DDD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618644,"discussion_content":"Q1: CLIP æ˜¯ä¸€ä¸ªå¼€æºæ¨¡å‹ï¼Œè¿™é‡Œå½“ç„¶ä¸ä¼šå’Œ GPT æœ‰å…³ç³»ï¼›\nQ2: åŠ å™ªå£°å’Œå»é™¤å™ªå£°çš„ç›®çš„ä¸ºäº†è®©æ¨¡å‹èƒ½åœ¨å¾ˆå¤æ‚çš„ç¯å¢ƒä¸‹ï¼ˆå¯ä»¥å»çœ‹ä¸‹é«˜æ–¯å™ªå£°ï¼Œå¯ä»¥ç†è§£ä¸ºæŠŠå›¾ç‰‡æ’•ç¢ä¸¢æ‰å¾ˆå¤šç¢ç‰‡ä½†æ˜¯è¿˜è¦è®©æ¨¡å‹èƒ½è®¤è¯†ï¼‰è¯†åˆ«å›¾ç‰‡ï¼Œä»è€ŒåŠ å¤§é¢„æµ‹å›¾ç‰‡çš„å‡†ç¡®æ€§;\nQ3: æœ€å¥½æ˜¯ç”¨ Colabï¼Œä¸æ¨èç”¨ä¸ªäººæœºå™¨ï¼Œéœ€è¦çœ‹ä½ çš„æ˜¾å¡é…ç½®èƒ½ä¸èƒ½è¾¾åˆ°è¦æ±‚ï¼›\nQ4ï¼šå½“ç„¶å¯ä»¥ï¼Œç±»ä¼¼äºæŠŠæ¨¡ç³Šå›¾ç‰‡åšé«˜æ¸…æ˜¯ä¸€æ ·çš„é“ç†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1684403970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2397945,"avatar":"https://static001.geekbang.org/account/avatar/00/24/96/f9/e52955e1.jpg","nickname":"å´äº®","note":"","ucode":"CEB3995975654C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618443,"discussion_content":"æ˜¯2ä¸ªå®Œå…¨ä¸åŒçš„ç³»ç»Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684244078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2397945,"avatar":"https://static001.geekbang.org/account/avatar/00/24/96/f9/e52955e1.jpg","nickname":"å´äº®","note":"","ucode":"CEB3995975654C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618440,"discussion_content":"æ˜¯2ä¸ªå®Œå…¨ä¸åŒçš„ç³»ç»Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684243156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2397945,"avatar":"https://static001.geekbang.org/account/avatar/00/24/96/f9/e52955e1.jpg","nickname":"å´äº®","note":"","ucode":"CEB3995975654C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618439,"discussion_content":"chatgptå’Œstable diffution ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684243117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374168,"user_name":"ä¸€å¶","can_delete":false,"product_type":"c1","uid":3577168,"ip_address":"ç¦å»º","ucode":"21E5455D0814E5","user_header":"https://static001.geekbang.org/account/avatar/00/36/95/50/01199ae9.jpg","comment_is_top":false,"comment_ctime":1683676099,"is_pvip":false,"replies":[{"id":136858,"content":"æ‰¾æ‰¾çœ‹å›½å†…æ˜¯å¦æœ‰é•œåƒï¼Ÿä»¥å‰æ¸…åæœ‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684752175,"ip_address":"ä¸Šæµ·","comment_id":374168,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆ å¦‚ä½• æ‰‹åŠ¨æŠŠæ¨¡å‹ä¸‹è½½,ç„¶åå†ä¸Šä¼ åˆ°æœåŠ¡å™¨ ? æˆ‘æœåŠ¡å™¨æœ¬åœ°liunxçš„,å‘ç°ä¸‹è½½å¾ˆæ…¢..... DiffusionPipeline.from_pretrained","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619041,"discussion_content":"æ‰¾æ‰¾çœ‹å›½å†…æ˜¯å¦æœ‰é•œåƒï¼Ÿä»¥å‰æ¸…åæœ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684752175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1082338,"avatar":"https://static001.geekbang.org/account/avatar/00/10/83/e2/297518ab.jpg","nickname":"ä½³ä½³çš„çˆ¸","note":"","ucode":"9D4FE7C3552087","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":638149,"discussion_content":"huggingfaceå°†æ‰€æœ‰ä¸‹è½½çš„æ¨¡å‹éƒ½ç¼“å­˜åœ¨ $HOME/.cache\\huggingface/hubç›®å½•ä¸‹ï¼Œå¦‚æœåœ¨windowsè¿è¡Œï¼Œç›®å½•æ˜¯c:\\windows\\%å½“å‰ç™»é™†çš„ç”¨æˆ·å%\\.cache\\huggingface\\hub,  å¯ä»¥å»HFå®˜ç½‘å…ˆæœç´¢åˆ°å¯¹åº”çš„æ¨¡å‹æ–‡ä»¶ï¼Œä¸‹è½½åˆ°è¿™ä¸ªç¼“å­˜ç›®å½•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1709280238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374074,"user_name":"åšç§¯è–„å‘","can_delete":false,"product_type":"c1","uid":1206674,"ip_address":"åŒ—äº¬","ucode":"8640C07176C249","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/92/69c2c135.jpg","comment_is_top":false,"comment_ctime":1683556549,"is_pvip":false,"replies":[{"id":136874,"content":"è¯¾ç¨‹é‡Œå•ä¸ªä»»åŠ¡Colabé‡ŒT4çš„16GBå†…å­˜åº”è¯¥æ˜¯å¤Ÿçš„ã€‚\n\nå½“ç„¶å¦‚æœä½ éœ€è¦åˆ«çš„æ¨¡å‹ï¼ŒGPUæ˜¾å­˜ä¸å¤Ÿå°±éœ€è¦æ›´å¤§æ˜¾å­˜çš„GPUç”šè‡³å¤šå¡äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684753863,"ip_address":"ä¸Šæµ·","comment_id":374074,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 14.75 GiB total capacity; 13.46 GiB \nalready allocated; 10.81 MiB free; 13.46 GiB reserved in total by PyTorch) If reserved memory is &gt;&gt; allocated \nmemory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and \nPYTORCH_CUDA_ALLOC_CONF   è€å¸ˆï¼Œcolab gpuä¸å¤Ÿäº†ï¼Œé»˜è®¤çš„16gä¸å¤Ÿï¼Œæ˜¯ä¸æ˜¯éœ€è¦è´­ä¹°æ›´å¤§çš„gpu","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619063,"discussion_content":"è¯¾ç¨‹é‡Œå•ä¸ªä»»åŠ¡Colabé‡ŒT4çš„16GBå†…å­˜åº”è¯¥æ˜¯å¤Ÿçš„ã€‚\n\nå½“ç„¶å¦‚æœä½ éœ€è¦åˆ«çš„æ¨¡å‹ï¼ŒGPUæ˜¾å­˜ä¸å¤Ÿå°±éœ€è¦æ›´å¤§æ˜¾å­˜çš„GPUç”šè‡³å¤šå¡äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684753863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1481283,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcEKI64IovCBe0XvmatsRjRI3AYdBzicjqHHWsDXb5vAG0V4rgg2Gv6XRFOfD6lMhDN9Eud6bRTqw/132","nickname":"Geek_71a740","note":"","ucode":"ABBE2C9927301C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619478,"discussion_content":"å†…å­˜ä¸å¤Ÿå¯ä»¥è¯•è¯•DiffusionPipeline.from_pretrained(&#34;./stable-diffusion-v1-5/&#34;,torch_dtype=torch.float16)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685160217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373903,"user_name":"Oliå¼ å¸†","can_delete":false,"product_type":"c1","uid":1338098,"ip_address":"åŒ—äº¬","ucode":"6E60A370C3C14A","user_header":"https://static001.geekbang.org/account/avatar/00/14/6a/f2/db90fa96.jpg","comment_is_top":false,"comment_ctime":1683329696,"is_pvip":false,"replies":[{"id":136841,"content":"å¦‚æœæ˜¯æœ‰äººéƒ¨ç½²äº†ä¸€ä¸ªä»˜è´¹çš„spaceç„¶åå¼€æ”¾å‡ºæ¥è®©å¤§å®¶ç”¨ï¼Œé‚£å°±æ˜¯éƒ¨ç½²çš„äººä¹°å•\nå¦‚æœæ˜¯HFå®˜æ–¹æä¾›çš„Spaceæˆ–è€…Inference APIï¼Œå°±æ˜¯HFå®˜æ–¹ç»™é’±\n\nå¹¶æ²¡æœ‰é‚£ä¹ˆå¤šå…è´¹çš„ç®—åŠ›å¯ä»¥ç”¨ï¼Œå…è´¹å¼€æ”¾çš„GPUèµ„æºå¾ˆå°‘çš„ï¼Œæœ€å¤šè®©ä½ è¯•ä¸€ä¸‹APIï¼Œå¤§å®¶æ’é˜Ÿæ…¢æ…¢ç”¨è€Œå·²","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684748557,"ip_address":"ä¸Šæµ·","comment_id":373903,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼Œç»“åˆæ‚¨ä¹‹å‰è®²çš„HuggingFaceï¼Œæˆ‘å¯ä»¥é€šè¿‡HuggingFaceï¼Œå…è´¹è°ƒç”¨Stable Diffusionçš„æ¥å£ï¼Œæ¥äº§ç”Ÿå¤§é‡çš„å›¾ç‰‡ã€‚é‚£è¿™æ•´ä¸ªæµç¨‹ä¸­éœ€è¦çš„å¤§é‡ç®—åŠ›ï¼Œæ˜¯è°æ¥ä¹°å•çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619019,"discussion_content":"å¦‚æœæ˜¯æœ‰äººéƒ¨ç½²äº†ä¸€ä¸ªä»˜è´¹çš„spaceç„¶åå¼€æ”¾å‡ºæ¥è®©å¤§å®¶ç”¨ï¼Œé‚£å°±æ˜¯éƒ¨ç½²çš„äººä¹°å•\nå¦‚æœæ˜¯HFå®˜æ–¹æä¾›çš„Spaceæˆ–è€…Inference APIï¼Œå°±æ˜¯HFå®˜æ–¹ç»™é’±\n\nå¹¶æ²¡æœ‰é‚£ä¹ˆå¤šå…è´¹çš„ç®—åŠ›å¯ä»¥ç”¨ï¼Œå…è´¹å¼€æ”¾çš„GPUèµ„æºå¾ˆå°‘çš„ï¼Œæœ€å¤šè®©ä½ è¯•ä¸€ä¸‹APIï¼Œå¤§å®¶æ’é˜Ÿæ…¢æ…¢ç”¨è€Œå·²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684748557,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066542,"avatar":"https://static001.geekbang.org/account/avatar/00/10/46/2e/c5827ea5.jpg","nickname":"initlife","note":"","ucode":"6F0E2D9B0EAEBC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617234,"discussion_content":"å¦‚æœæ˜¯ä½ çš„æœ¬æœºå°±æ˜¯ä½ çš„ç”µè„‘ä¹°å•ï¼Œå¦‚æœæ˜¯colabï¼Œå°±æ˜¯ç”¨äº‘ç®—åŠ›ï¼Œå¯èƒ½è¦ä»˜è´¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683389651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373885,"user_name":"Toni","can_delete":false,"product_type":"c1","uid":3206957,"ip_address":"ç‘å£«","ucode":"E6B2FACCC1E000","user_header":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","comment_is_top":false,"comment_ctime":1683288324,"is_pvip":false,"replies":[{"id":136828,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741749,"ip_address":"ä¸Šæµ·","comment_id":373885,"utype":1}],"discussion_count":10,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"1. ä½¿ç”¨ GPU æ— ç–‘ä¼šåŠ å¿«å›¾åƒçš„ç”Ÿæˆï¼Œä½†å®åœ¨æ²¡æœ‰åŠæ³•ä½¿ç”¨ GPU æ—¶ï¼Œå°±ç”¨ CPUï¼Œåªè¦å°†ä¸‹é¢ä»£ç ä¸­çš„ &quot;cuda&quot; æ”¹æˆ &quot;cpu&quot; å³å¯ï¼Œæ…¢æ¯”æ²¡æœ‰å¼ºã€‚\n\npipeline.to(&quot;cuda&quot;) =&gt; pipeline.to(&quot;cpu&quot;) \n---------------------\nfrom diffusers import DiffusionPipeline\npipeline = DiffusionPipeline.from_pretrained(&quot;runwayml&#47;stable-diffusion-v1-5&quot;)\npipeline.to(&quot;cpu&quot;)\n\nimage = pipeline(&quot;Sports car, road, rural areas, blue sky, white clouds, endless grassland in the background&quot;).images[0]\nimage\n\n--------------\nç”Ÿæˆä¸Šé¢çš„å›¾åœ¨ cpu æ¡ä»¶ä¸‹çº¦10åˆ†é’Ÿã€‚\n\n2. æè¿°å›¾åƒçš„ prompt å¦‚æœå¤ªé•¿ä¼šæŠ¥é”™ï¼Œ æ¯”å¦‚\nToken indices sequence length is longer than the specified maximum sequence length for this model (161 &gt; 77). \n\nç¨‹åºä¼šç»§ç»­è¿è¡Œï¼Œä½†è¾“å‡ºç»“æœæ˜¯é»‘æ¿ã€‚\nPotential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and&#47;or seed.\n\nprompt ä¸­çš„ Token æ•°è¶…è¿‡é™å®šæ—¶ï¼Œè¦åœæ­¢è¿è¡Œï¼Œä»¥èŠ‚çœæ—¶é—´ã€‚","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618995,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617137,"discussion_content":"è€æœºå™¨ 710æ˜¾å¡è·‘ä¸èµ·æ¥ï¼Œç”¨ CPU è·‘ç”Ÿæˆä¸€æ¬¡å¿« 20 åˆ†é’Ÿäº†  :(","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1683340750,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618415,"discussion_content":"æ­å»º Automatic1111 ï¼Œåœ¨å…¶ä¸Šç”¨ CPUï¼Œç”Ÿæˆ 512x512 çš„å›¾çº¦ä¸ƒï¼Œå…«åˆ†é’Ÿï¼Œå¯ä»¥ä¸€è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684234398,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":617137,"ip_address":"ç‘å£«","group_id":0},"score":618415,"extra":""}]},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617209,"discussion_content":"@ç™½èœ: æ˜¯åœ¨ jupyter-lab è¿˜æ˜¯åœ¨ colab ä¸Š? æœ€åä¸€è¡Œä»£ç æ˜¯ä»€ä¹ˆ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683381364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç‘å£«","group_id":0},"score":2,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":2230467,"avatar":"https://static001.geekbang.org/account/avatar/00/22/08/c3/bf4fe285.jpg","nickname":"ç™½èœ","note":"","ucode":"C3AE527ECE970E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617265,"discussion_content":"æˆ‘æ˜¯åœ¨è‡ªå·±æœºå™¨ä¸Šè¿è¡Œçš„ï¼Œiterm2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683441299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":617209,"ip_address":"åŒ—äº¬","group_id":0},"score":617265,"extra":""},{"author":{"id":2230467,"avatar":"https://static001.geekbang.org/account/avatar/00/22/08/c3/bf4fe285.jpg","nickname":"ç™½èœ","note":"","ucode":"C3AE527ECE970E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617266,"discussion_content":"from diffusers import DiffusionPipeline\npipeline = DiffusionPipeline.from_pretrained(&#34;runwayml/stable-diffusion-v1-5&#34;)\npipeline.to(&#34;cpu&#34;)\n\nimage = pipeline(&#34;Sports car, road, rural areas, blue sky, white clouds, endless grassland in the background&#34;).images[0]\nimage","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683441331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":617209,"ip_address":"åŒ—äº¬","group_id":0},"score":617266,"extra":""},{"author":{"id":3206957,"avatar":"https://static001.geekbang.org/account/avatar/00/30/ef/2d/757bb0d3.jpg","nickname":"Toni","note":"","ucode":"E6B2FACCC1E000","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2230467,"avatar":"https://static001.geekbang.org/account/avatar/00/22/08/c3/bf4fe285.jpg","nickname":"ç™½èœ","note":"","ucode":"C3AE527ECE970E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617284,"discussion_content":"åœ¨ jupyter-lab æˆ– colab ä¸Šè¿è¡Œä¸Šé¢ä»£ç æ—¶ï¼Œæœ€åä¸€è¡Œçš„ image å°±æ˜¯å°†ä¸Šä¸€è¡Œçš„ image = pipeline(...).images[0] åˆšå½¢æˆçš„å›¾åƒæ˜¾ç¤ºå‡ºæ¥ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯Windows 11ã€‚\nåœ¨ iTerm2 ä¸Šæ˜¾ç¤ºå›¾åƒï¼Œæœ‰ä¸åŒçš„æ–¹æ³•ï¼Œè¯•è¯•å°†æœ€åä¸€è¡Œçš„ image æ”¹æˆ image.show()ã€‚Windows ä¸‹è¿™å°†æ‰“å¼€å›¾ç‰‡æµè§ˆå™¨çª—å£ï¼Œæ˜¾ç¤ºå›¾åƒã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1683460383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":617266,"ip_address":"ç‘å£«","group_id":0},"score":617284,"extra":""}]},{"author":{"id":2230467,"avatar":"https://static001.geekbang.org/account/avatar/00/22/08/c3/bf4fe285.jpg","nickname":"ç™½èœ","note":"","ucode":"C3AE527ECE970E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617192,"discussion_content":"è¿™ä¸ªå›¾ç‰‡è¾“å‡ºåˆ°å“ªäº†ï¼Ÿæˆ‘æ˜¯åœ¨å‘½ä»¤è¡Œé‡Œè¿è¡Œçš„ï¼Œå‘½ä»¤è¡Œä¸èƒ½æ˜¾ç¤ºå›¾ç‰‡å•Šï¼Œä¹Ÿæ²¡æœ‰åœ°æ–¹è¾“å‡ºå›¾ç‰‡ï¼Œæ˜¯æˆ‘è¿è¡Œçš„æ–¹å¼ä¸å¯¹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683371827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373870,"user_name":"Jack","can_delete":false,"product_type":"c1","uid":1297112,"ip_address":"å¹¿ä¸œ","ucode":"F3863DAEF449D5","user_header":"https://static001.geekbang.org/account/avatar/00/13/ca/d8/b109ed85.jpg","comment_is_top":false,"comment_ctime":1683275969,"is_pvip":false,"replies":[{"id":136829,"content":"å¯ä»¥å¤šè¯•è¯•ä½¿ç”¨ä¸åŒçš„éšæœºæ•°seedï¼Œä¸åŒéšæœºæ•°çš„å·®åˆ«å¾ˆå¤§ï¼Œæˆ‘ä¹Ÿæ˜¯æŒ‘äº†ä¸€ä¸ªå¥½çœ‹çš„æ”¾å‡ºæ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741785,"ip_address":"ä¸Šæµ·","comment_id":373870,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"ç¬¬ä¸€æ¬¡è¿è¡Œâ€œa photograph of an astronaut riding a horseâ€ï¼Œåªæœ‰é©¬ï¼Œæ²¡æœ‰å®‡èˆªå‘˜ï¼Œå¤šè¿è¡Œå‡ æ¬¡å°±æœ‰äº†ï¼Œä¸è¿‡å›¾ç‰‡æ²¡æœ‰è€å¸ˆçš„å¥½çœ‹","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618996,"discussion_content":"å¯ä»¥å¤šè¯•è¯•ä½¿ç”¨ä¸åŒçš„éšæœºæ•°seedï¼Œä¸åŒéšæœºæ•°çš„å·®åˆ«å¾ˆå¤§ï¼Œæˆ‘ä¹Ÿæ˜¯æŒ‘äº†ä¸€ä¸ªå¥½çœ‹çš„æ”¾å‡ºæ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253652,"avatar":"https://static001.geekbang.org/account/avatar/00/13/21/14/423a821f.jpg","nickname":"Steven","note":"","ucode":"3FE64459842015","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617136,"discussion_content":"æˆ‘ç¬¬ä¸€æ¬¡è¿è¡Œï¼Œåªæœ‰å®‡èˆªå‘˜ï¼Œæ²¡æœ‰é©¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683340637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373854,"user_name":"Jacob.C","can_delete":false,"product_type":"c1","uid":1070253,"ip_address":"å¹¿ä¸œ","ucode":"034998E7A7CCD1","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/ad/6ee2b7cb.jpg","comment_is_top":false,"comment_ctime":1683264138,"is_pvip":false,"replies":[{"id":136830,"content":"Colabä¸‹ç”¨GPU T4è·‘ï¼Œä¸€èˆ¬åœ¨5-20ç§’ä¹‹é—´å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741846,"ip_address":"ä¸Šæµ·","comment_id":373854,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆå¯ä»¥è®²ä¸€ä¸‹ï¼Œcolab ä¸Šï¼Œè·‘è¿™ä¸ªå¤ªç©ºäººéª‘é©¬è¦è¿è¡Œè€—æ—¶å¤šä¹…å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618997,"discussion_content":"Colabä¸‹ç”¨GPU T4è·‘ï¼Œä¸€èˆ¬åœ¨5-20ç§’ä¹‹é—´å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1430132,"avatar":"https://static001.geekbang.org/account/avatar/00/15/d2/74/7861f504.jpg","nickname":"é©¬å¬","note":"","ucode":"93D83CB5FAE5AD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617158,"discussion_content":"æˆ‘å°è¯•çš„æ˜¯20å¤šç§’","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1683355330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3617247,"avatar":"https://static001.geekbang.org/account/avatar/00/37/31/df/caace193.jpg","nickname":"é™ˆæ³¢","note":"","ucode":"D8881782CED835","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617389,"discussion_content":"è·‘ä¸€ä¸‹å°±çŸ¥é“äº†ï¼Œå¾ˆå¿«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683538366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373840,"user_name":"Geek_7ee455","can_delete":false,"product_type":"c1","uid":1527581,"ip_address":"æµ™æ±Ÿ","ucode":"76C69F26B0F653","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/270T9KAFd4oCxXXB1giaMDaJuTQVib8gPt77VkM5dbS3hW60kwTNnxMYpVibwWVdnASCrymBbwT7HI77URia0KUylw/132","comment_is_top":false,"comment_ctime":1683254374,"is_pvip":false,"replies":[{"id":136826,"content":"å¯ä»¥å•Šï¼Œå¦‚æœæ˜¯æ–°çš„M1&#47;M2èŠ¯ç‰‡çš„Macçš„è¯ï¼ŒIntel CPUçš„å› ä¸ºæ˜¾å¡çš„åŸå› ä¸ç¡®å®šè¡Œä¸è¡Œã€‚\n\nAppleå®˜æ–¹ç»™äº†è§£å†³æ–¹æ¡ˆ https:&#47;&#47;huggingface.co&#47;docs&#47;diffusers&#47;optimization&#47;mps","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1053568,"ctime":1684741720,"ip_address":"ä¸Šæµ·","comment_id":373840,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"è€å¸ˆ,åœ¨macä¸Šèƒ½è‡ªå·±éƒ¨ç½²ä¸€å¥—stable diffusionå—","like_count":0,"discussions":[{"author":{"id":1053568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/80/8de66543.jpg","nickname":"å¾æ–‡æµ©","note":"","ucode":"1D39AC564172E9","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618993,"discussion_content":"å¯ä»¥å•Šï¼Œå¦‚æœæ˜¯æ–°çš„M1/M2èŠ¯ç‰‡çš„Macçš„è¯ï¼ŒIntel CPUçš„å› ä¸ºæ˜¾å¡çš„åŸå› ä¸ç¡®å®šè¡Œä¸è¡Œã€‚\n\nAppleå®˜æ–¹ç»™äº†è§£å†³æ–¹æ¡ˆ https://huggingface.co/docs/diffusers/optimization/mps","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684741720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1248128,"avatar":"https://static001.geekbang.org/account/avatar/00/13/0b/80/a0533acb.jpg","nickname":"å‹‡.Max","note":"","ucode":"AE5DBC10805A9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":619130,"discussion_content":"æˆ‘ç”¨è€å¸ˆæ¨èçš„ç¤ºä¾‹ä»£ç åœ¨colabä¸Šè¿˜æ˜¯è·‘ä¸èµ·æ¥ï¼Œapple m1èŠ¯ç‰‡ã€‚RuntimeError: PyTorch is not linked with support for mps devicesï¼Œåœ¨chatgptæœè§£å†³æ–¹æ¡ˆæ¨è!pip install --upgrade torch torchvisionï¼Œæ‰§è¡Œå®Œä¹‹åä¾ç„¶ä¸è¡Œã€‚ è¿™ä¸ªè¿˜æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå—ï¼Ÿcolabå¦‚æœä¸èŠ±é’±ä¹Ÿæ˜¯ç”¨çš„æœ¬åœ°èµ„æºï¼Ÿé‚£åœ¨colabè¿è¡Œä»£ç å’Œåœ¨æœ¬åœ°jupyter-labä¸Šè¿è¡Œæœ‰ä½•åŒºåˆ«å‘¢ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684810881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ¾³å¤§åˆ©äºš","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1231908,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cc/24/8988304f.jpg","nickname":"æ–¹ç»´","note":"","ucode":"0E50A1BECD1746","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617064,"discussion_content":"èƒ½ï¼Œæˆ‘æœ€è¿‘è·‘èµ·æ¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683287711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1520703,"avatar":"https://static001.geekbang.org/account/avatar/00/17/34/3f/4b6cd370.jpg","nickname":"Viktor","note":"","ucode":"DCAFD1DD5C6A0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1231908,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cc/24/8988304f.jpg","nickname":"æ–¹ç»´","note":"","ucode":"0E50A1BECD1746","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617122,"discussion_content":"è¿è¡Œå¿«ä¸å¿«ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683334897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":617064,"ip_address":"å››å·","group_id":0},"score":617122,"extra":""}]}]},{"had_liked":false,"id":375577,"user_name":"è¹","can_delete":false,"product_type":"c1","uid":1020356,"ip_address":"ç¾å›½","ucode":"395C6C4191B091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/91/c4/40609b81.jpg","comment_is_top":false,"comment_ctime":1685682482,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100541001,"comment_content":"ç›´æ¥æ–°å»ºä¸€ä¸ªcolab notebookåé»˜è®¤ä¸æ˜¯ç”¨çš„GPUï¼Œè¿è¡Œä»£ç å‡ºé”™äº†&quot;RuntimeError: Found no NVIDIA driver on your system. Please check that you have an NVIDIA GPU and installed a driver from http:&#47;&#47;www.nvidia.com&#47;Download&#47;index.aspx&quot;\n\né‡åˆ°åŒæ ·é”™è¯¯çš„å°ä¼™ä¼´è®°å¾—åœ¨Runtimeèœå•é‡Œé€‰æ‹©Change runtime typeï¼Œé€‰æ‹©GPU, T4ã€‚æˆ‘é‡åˆ°äº†åœ¨è¿è¡Œä¹Ÿä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™æ—¶å¯ä»¥å†åœ¨Runtimeèœå•é‡Œé€‰æ‹©Restart runtimeæˆ–è€…Restart and run allã€‚è¿™æ ·ï¼Œæˆ‘é‡åˆ°çš„é”™è¯¯å°±è§£å†³äº†ã€‚","like_count":1},{"had_liked":false,"id":387233,"user_name":"Amark","can_delete":false,"product_type":"c1","uid":1121326,"ip_address":"é™•è¥¿","ucode":"E5F48633654002","user_header":"https://static001.geekbang.org/account/avatar/00/11/1c/2e/93812642.jpg","comment_is_top":false,"comment_ctime":1706758440,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"ä¸ºå•¥æœ‰çš„å›¾ç‰‡è·Ÿæ–‡å­—ä¸ç¬¦ï¼Œæ–‡å­—æè¿°æœ‰å•¥è¦æ±‚å—","like_count":0},{"had_liked":false,"id":384057,"user_name":"å°ç†æƒ³ã€‚","can_delete":false,"product_type":"c1","uid":2238528,"ip_address":"åŒ—äº¬","ucode":"EDC35A907570DB","user_header":"https://static001.geekbang.org/account/avatar/00/22/28/40/82d748e6.jpg","comment_is_top":false,"comment_ctime":1700192537,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"å¤§å®¶æ²¡é‡åˆ°huggingfaceå®Œå…¨è®¿é—®ä¸äº†çš„æƒ…å†µå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1082338,"avatar":"https://static001.geekbang.org/account/avatar/00/10/83/e2/297518ab.jpg","nickname":"ä½³ä½³çš„çˆ¸","note":"","ucode":"9D4FE7C3552087","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":638147,"discussion_content":"huggingface åœ¨å›½å†…è®¿é—®çš„è¯ éœ€è¦ç¿»å¢™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1709279153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3811644,"avatar":"https://static001.geekbang.org/account/avatar/00/3a/29/3c/5e539b12.jpg","nickname":"æ·±è…¾","note":"","ucode":"D119FD13BBC2E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635528,"discussion_content":"ä½ ç°åœ¨è§£å†³äº†å—ï¼Œæˆ‘æƒ³åŠ ä½ é—®æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704935854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¦å»º","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378445,"user_name":"æ˜µç§°C","can_delete":false,"product_type":"c1","uid":1234963,"ip_address":"åŒ—äº¬","ucode":"1BB2D537942DC2","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/13/082013bc.jpg","comment_is_top":false,"comment_ctime":1690268935,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"æ€è€ƒé¢˜æœ‰åšå‡ºæ¥çš„å—ï¼Ÿè€å¸ˆæœ‰ç­”æ¡ˆå—ï¼Ÿ\n","like_count":0},{"had_liked":false,"id":376596,"user_name":"å’ŒæŸæ¬¢","can_delete":false,"product_type":"c1","uid":2120663,"ip_address":"ç¾å›½","ucode":"5E0F27533597F1","user_header":"https://static001.geekbang.org/account/avatar/00/20/5b/d7/d88c1850.jpg","comment_is_top":false,"comment_ctime":1687058698,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è€å¸ˆï¼Œcolabå¦‚ä½•å¼•å…¥Counterfeit-V3.0 è¿™ä¸ªæ¨¡å‹å‘¢ï¼Ÿç¤ºä¾‹ä»£ç æ²¡çœ‹æ‡‚ï¼Œè¿è¡Œçš„æ—¶å€™æŠ¥ NameError: name &#39;pipeline&#39; is not defined.","like_count":0},{"had_liked":false,"id":375019,"user_name":"å‹‡.Max","can_delete":false,"product_type":"c1","uid":1248128,"ip_address":"æ¾³å¤§åˆ©äºš","ucode":"AE5DBC10805A9B","user_header":"https://static001.geekbang.org/account/avatar/00/13/0b/80/a0533acb.jpg","comment_is_top":false,"comment_ctime":1684811029,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"è¯·é—®ä¸‹è€å¸ˆcolabçš„åœ¨çº¿GPUç¯å¢ƒæ˜¯ä¸æ˜¯è·Ÿæœ¬åœ°çš„macos(m1)ä¹Ÿæœ‰ä¸€å®šå…³ç³»ï¼Ÿä¸å¤ªç†è§£ä¸ºå•¥m1è·‘colabä¸ºå•¥è¿˜è¦ä¿®æ”¹æˆcpuçš„æ–¹å¼","like_count":0},{"had_liked":false,"id":375018,"user_name":"å‹‡.Max","can_delete":false,"product_type":"c1","uid":1248128,"ip_address":"æ¾³å¤§åˆ©äºš","ucode":"AE5DBC10805A9B","user_header":"https://static001.geekbang.org/account/avatar/00/13/0b/80/a0533acb.jpg","comment_is_top":false,"comment_ctime":1684810916,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"æˆ‘ç”¨è€å¸ˆæ¨èçš„ç¤ºä¾‹ä»£ç (https:&#47;&#47;huggingface.co&#47;docs&#47;diffusers&#47;optimization&#47;mps)åœ¨colabä¸Šè¿˜æ˜¯è·‘ä¸èµ·æ¥ï¼Œapple m1èŠ¯ç‰‡ã€‚RuntimeError: PyTorch is not linked with support for mps devicesï¼Œåœ¨chatgptæœè§£å†³æ–¹æ¡ˆæ¨è!pip install --upgrade torch torchvisionï¼Œæ‰§è¡Œå®Œä¹‹åä¾ç„¶ä¸è¡Œã€‚ è¿™ä¸ªè¿˜æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå—ï¼Ÿcolabå¦‚æœä¸èŠ±é’±ä¹Ÿæ˜¯ç”¨çš„æœ¬åœ°èµ„æºï¼Ÿé‚£åœ¨colabè¿è¡Œä»£ç å’Œåœ¨æœ¬åœ°jupyter-labä¸Šè¿è¡Œæœ‰ä½•åŒºåˆ«å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":373890,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"å¹¿ä¸œ","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1683293696,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"ææ²çš„è¯¾ç¨‹å¤ªå¥½äº†","like_count":0},{"had_liked":false,"id":373835,"user_name":"Santiago","can_delete":false,"product_type":"c1","uid":3572315,"ip_address":"å±±è¥¿","ucode":"E7301F6A5076DC","user_header":"https://static001.geekbang.org/account/avatar/00/36/82/5b/df97e03c.jpg","comment_is_top":false,"comment_ctime":1683247690,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100541001,"comment_content":"å­¦ä¹ æ‰“å¡\n","like_count":0}]}