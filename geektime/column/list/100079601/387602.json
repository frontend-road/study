{"id":387602,"title":"13 | API é£æ ¼ï¼ˆä¸‹ï¼‰ï¼šRPC APIä»‹ç»","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å­”ä»¤é£ã€‚è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹ä¸‹å¦‚ä½•è®¾è®¡åº”ç”¨çš„APIé£æ ¼ã€‚</p><p>ä¸Šä¸€è®²ï¼Œæˆ‘ä»‹ç»äº†REST APIé£æ ¼ï¼Œè¿™ä¸€è®²æˆ‘æ¥ä»‹ç»ä¸‹å¦å¤–ä¸€ç§å¸¸ç”¨çš„APIé£æ ¼ï¼ŒRPCã€‚åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œå¦‚æœä¸šåŠ¡å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”éœ€è¦æä¾›ç»™å¤šç§ç¼–ç¨‹è¯­è¨€è°ƒç”¨ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨RPC APIæ¥å£ã€‚RPCåœ¨Goé¡¹ç›®å¼€å‘ä¸­ç”¨å¾—ä¹Ÿéå¸¸å¤šï¼Œéœ€è¦æˆ‘ä»¬è®¤çœŸæŒæ¡ã€‚</p><h2>RPCä»‹ç»</h2><p>æ ¹æ®ç»´åŸºç™¾ç§‘çš„å®šä¹‰ï¼ŒRPCï¼ˆRemote Procedure Callï¼‰ï¼Œå³è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ä¸ªè®¡ç®—æœºé€šä¿¡åè®®ã€‚è¯¥åè®®å…è®¸è¿è¡Œäºä¸€å°è®¡ç®—æœºçš„ç¨‹åºè°ƒç”¨å¦ä¸€å°è®¡ç®—æœºçš„å­ç¨‹åºï¼Œè€Œç¨‹åºå‘˜ä¸ç”¨é¢å¤–åœ°ä¸ºè¿™ä¸ªäº¤äº’ä½œç”¨ç¼–ç¨‹ã€‚</p><p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯æœåŠ¡ç«¯å®ç°äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨RPCæ¡†æ¶æä¾›çš„æ¥å£ï¼Œåƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è·å–è¿”å›å€¼ã€‚RPCå±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œä½¿å¾—å¼€å‘äººå‘˜æ— éœ€å…³æ³¨ç½‘ç»œç¼–ç¨‹çš„ç»†èŠ‚ï¼Œå¯ä»¥å°†æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›æ”¾åœ¨ä¸šåŠ¡é€»è¾‘æœ¬èº«çš„å®ç°ä¸Šï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><p>RPCçš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/98/1d/984yy094616b9b24193b22a1f2f2271d.png?wh=2521x1671\" alt=\"\"></p><p>RPCè°ƒç”¨å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><ol>\n<li>Clienté€šè¿‡æœ¬åœ°è°ƒç”¨ï¼Œè°ƒç”¨Client Stubã€‚</li>\n<li>Client Stubå°†å‚æ•°æ‰“åŒ…ï¼ˆä¹Ÿå«Marshallingï¼‰æˆä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åå‘é€è¿™ä¸ªæ¶ˆæ¯ã€‚</li>\n<li>Clientæ‰€åœ¨çš„OSå°†æ¶ˆæ¯å‘é€ç»™Serverã€‚</li>\n<li>Serverç«¯æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™Server Stubã€‚</li>\n<li>Server Stubå°†æ¶ˆæ¯è§£åŒ…ï¼ˆä¹Ÿå« Unmarshallingï¼‰å¾—åˆ°å‚æ•°ã€‚</li>\n<li>Server Stubè°ƒç”¨æœåŠ¡ç«¯çš„å­ç¨‹åºï¼ˆå‡½æ•°ï¼‰ï¼Œå¤„ç†å®Œåï¼Œå°†æœ€ç»ˆç»“æœæŒ‰ç…§ç›¸åçš„æ­¥éª¤è¿”å›ç»™ Clientã€‚</li>\n</ol><!-- [[[read_end]]] --><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒStubè´Ÿè´£è°ƒç”¨å‚æ•°å’Œè¿”å›å€¼çš„æµåŒ–ï¼ˆserializationï¼‰ã€å‚æ•°çš„æ‰“åŒ…å’Œè§£åŒ…ï¼Œä»¥åŠç½‘ç»œå±‚çš„é€šä¿¡ã€‚Clientç«¯ä¸€èˆ¬å«Stubï¼ŒServerç«¯ä¸€èˆ¬å«Skeletonã€‚</p><p>ç›®å‰ï¼Œä¸šç•Œæœ‰å¾ˆå¤šä¼˜ç§€çš„RPCåè®®ï¼Œä¾‹å¦‚è…¾è®¯çš„Tarsã€é˜¿é‡Œçš„Dubboã€å¾®åšçš„Motanã€Facebookçš„Thriftã€RPCXï¼Œç­‰ç­‰ã€‚ä½†ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯<a href=\"https://github.com/grpc/grpc-go\">gRPC</a>ï¼Œè¿™ä¹Ÿæ˜¯æœ¬ä¸“æ æ‰€é‡‡ç”¨çš„RPCæ¡†æ¶ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä¼šé‡ç‚¹ä»‹ç»gRPCæ¡†æ¶ã€‚</p><h2>gRPCä»‹ç»</h2><p>gRPCæ˜¯ç”±Googleå¼€å‘çš„é«˜æ€§èƒ½ã€å¼€æºã€è·¨å¤šç§ç¼–ç¨‹è¯­è¨€çš„é€šç”¨RPCæ¡†æ¶ï¼ŒåŸºäºHTTP 2.0åè®®å¼€å‘ï¼Œé»˜è®¤é‡‡ç”¨Protocol Buffersæ•°æ®åºåˆ—åŒ–åè®®ã€‚gRPCå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><ul>\n<li>æ”¯æŒå¤šç§è¯­è¨€ï¼Œä¾‹å¦‚ Goã€Javaã€Cã€C++ã€C#ã€Node.jsã€PHPã€Pythonã€Rubyç­‰ã€‚</li>\n<li>åŸºäºIDLï¼ˆInterface Definition Languageï¼‰æ–‡ä»¶å®šä¹‰æœåŠ¡ï¼Œé€šè¿‡proto3å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯æ¥å£ä»¥åŠå®¢æˆ·ç«¯Stubã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¹Ÿå¯ä»¥å°†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯è§£è€¦ï¼Œä½¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥å¹¶è¡Œå¼€å‘ã€‚</li>\n<li>é€šä¿¡åè®®åŸºäºæ ‡å‡†çš„HTTP/2è®¾è®¡ï¼Œæ”¯æŒåŒå‘æµã€æ¶ˆæ¯å¤´å‹ç¼©ã€å•TCPçš„å¤šè·¯å¤ç”¨ã€æœåŠ¡ç«¯æ¨é€ç­‰ç‰¹æ€§ã€‚</li>\n<li>æ”¯æŒProtobufå’ŒJSONåºåˆ—åŒ–æ•°æ®æ ¼å¼ã€‚Protobufæ˜¯ä¸€ç§è¯­è¨€æ— å…³çš„é«˜æ€§èƒ½åºåˆ—åŒ–æ¡†æ¶ï¼Œå¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æµé‡ï¼Œæé«˜é€šä¿¡æ•ˆç‡ã€‚</li>\n</ul><p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒgRPCçš„å…¨ç§°ä¸æ˜¯golang Remote Procedure Callï¼Œè€Œæ˜¯google Remote Procedure Callã€‚</p><p>gRPCçš„è°ƒç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/01/09/01ac424c7c1d64f678e1218827bc0109.png?wh=2079x1025\" alt=\"\"></p><p>åœ¨gRPCä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥è°ƒç”¨éƒ¨ç½²åœ¨ä¸åŒæœºå™¨ä¸Šçš„gRPCæœåŠ¡æ‰€æä¾›çš„æ–¹æ³•ï¼Œè°ƒç”¨è¿œç«¯çš„gRPCæ–¹æ³•å°±åƒè°ƒç”¨æœ¬åœ°çš„æ–¹æ³•ä¸€æ ·ï¼Œéå¸¸ç®€å•æ–¹ä¾¿ï¼Œé€šè¿‡gRPCè°ƒç”¨<strong>ï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“åœ°æ„å»ºå‡ºä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨ã€‚</strong></p><p>åƒå¾ˆå¤šå…¶ä»–çš„RPCæœåŠ¡ä¸€æ ·ï¼ŒgRPCä¹Ÿæ˜¯é€šè¿‡IDLè¯­è¨€ï¼Œé¢„å…ˆå®šä¹‰å¥½æ¥å£ï¼ˆæ¥å£çš„åå­—ã€ä¼ å…¥å‚æ•°å’Œè¿”å›å‚æ•°ç­‰ï¼‰ã€‚åœ¨æœåŠ¡ç«¯ï¼ŒgRPCæœåŠ¡å®ç°æˆ‘ä»¬æ‰€å®šä¹‰çš„æ¥å£ã€‚åœ¨å®¢æˆ·ç«¯ï¼ŒgRPCå­˜æ ¹æä¾›äº†è·ŸæœåŠ¡ç«¯ç›¸åŒçš„æ–¹æ³•ã€‚</p><p>gRPCæ”¯æŒå¤šç§è¯­è¨€ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨Goè¯­è¨€å®ç°gRPCæœåŠ¡ï¼Œå¹¶é€šè¿‡Javaè¯­è¨€å®¢æˆ·ç«¯è°ƒç”¨gRPCæœåŠ¡æ‰€æä¾›çš„æ–¹æ³•ã€‚é€šè¿‡å¤šè¯­è¨€æ”¯æŒï¼Œæˆ‘ä»¬ç¼–å†™çš„gRPCæœåŠ¡èƒ½æ»¡è¶³å®¢æˆ·ç«¯å¤šè¯­è¨€çš„éœ€æ±‚ã€‚</p><p>gRPC APIæ¥å£é€šå¸¸ä½¿ç”¨çš„æ•°æ®ä¼ è¾“æ ¼å¼æ˜¯Protocol Buffersã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·äº†è§£ä¸‹Protocol Buffersã€‚</p><h2>Protocol Buffersä»‹ç»</h2><p>Protocol Buffersï¼ˆProtocolBuffer/ protobufï¼‰æ˜¯Googleå¼€å‘çš„ä¸€å¥—å¯¹æ•°æ®ç»“æ„è¿›è¡Œåºåˆ—åŒ–çš„æ–¹æ³•ï¼Œå¯ç”¨ä½œï¼ˆæ•°æ®ï¼‰é€šä¿¡åè®®ã€æ•°æ®å­˜å‚¨æ ¼å¼ç­‰ï¼Œä¹Ÿæ˜¯ä¸€ç§æ›´åŠ çµæ´»ã€é«˜æ•ˆçš„æ•°æ®æ ¼å¼ï¼Œä¸XMLã€JSONç±»ä¼¼ã€‚å®ƒçš„ä¼ è¾“æ€§èƒ½éå¸¸å¥½ï¼Œæ‰€ä»¥å¸¸è¢«ç”¨åœ¨ä¸€äº›å¯¹æ•°æ®ä¼ è¾“æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ç³»ç»Ÿä¸­ï¼Œä½œä¸ºæ•°æ®ä¼ è¾“æ ¼å¼ã€‚Protocol Buffersçš„ä¸»è¦ç‰¹æ€§æœ‰ä¸‹é¢è¿™å‡ ä¸ªã€‚</p><ul>\n<li>æ›´å¿«çš„æ•°æ®ä¼ è¾“é€Ÿåº¦ï¼šprotobufåœ¨ä¼ è¾“æ—¶ï¼Œä¼šå°†æ•°æ®åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œå’ŒXMLã€JSONçš„æ–‡æœ¬ä¼ è¾“æ ¼å¼ç›¸æ¯”ï¼Œè¿™å¯ä»¥èŠ‚çœå¤§é‡çš„IOæ“ä½œï¼Œä»è€Œæé«˜æ•°æ®ä¼ è¾“é€Ÿåº¦ã€‚</li>\n<li>è·¨å¹³å°å¤šè¯­è¨€ï¼šprotobufè‡ªå¸¦çš„ç¼–è¯‘å·¥å…· protoc å¯ä»¥åŸºäºprotobufå®šä¹‰æ–‡ä»¶ï¼Œç¼–è¯‘å‡ºä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯ï¼Œä¾›ç¨‹åºç›´æ¥è°ƒç”¨ï¼Œå› æ­¤å¯ä»¥æ»¡è¶³å¤šè¯­è¨€éœ€æ±‚çš„åœºæ™¯ã€‚</li>\n<li>å…·æœ‰éå¸¸å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼Œå¯ä»¥æ›´æ–°å·²æœ‰çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸ç ´åå’Œå½±å“åŸæœ‰çš„ç¨‹åºã€‚</li>\n<li>åŸºäºIDLæ–‡ä»¶å®šä¹‰æœåŠ¡ï¼Œé€šè¿‡proto3å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ¥å£ã€‚</li>\n</ul><p>åœ¨gRPCçš„æ¡†æ¶ä¸­ï¼ŒProtocol Buffersä¸»è¦æœ‰ä¸‰ä¸ªä½œç”¨ã€‚</p><p><strong>ç¬¬ä¸€ï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰æ•°æ®ç»“æ„ã€‚</strong>ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªSecretInfoæ•°æ®ç»“æ„ï¼š</p><pre><code>// SecretInfo contains secret details.\nmessage SecretInfo {\n    string name = 1;\n    string secret_id  = 2;\n    string username   = 3;\n    string secret_key = 4;\n    int64 expires = 5;\n    string description = 6;\n    string created_at = 7;\n    string updated_at = 8;\n}\n</code></pre><p><strong>ç¬¬äºŒï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰æœåŠ¡æ¥å£ã€‚</strong>ä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªCacheæœåŠ¡ï¼ŒæœåŠ¡åŒ…å«äº†ListSecretså’ŒListPolicies ä¸¤ä¸ªAPIæ¥å£ã€‚</p><pre><code>// Cache implements a cache rpc service.\nservice Cache{\n  rpc ListSecrets(ListSecretsRequest) returns (ListSecretsResponse) {}\n  rpc ListPolicies(ListPoliciesRequest) returns (ListPoliciesResponse) {}\n}\n</code></pre><p><strong>ç¬¬ä¸‰ï¼Œå¯ä»¥é€šè¿‡protobufåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæå‡ä¼ è¾“æ•ˆç‡ã€‚</strong></p><h2>gRPCç¤ºä¾‹</h2><p>æˆ‘ä»¬å·²ç»å¯¹gRPCè¿™ä¸€é€šç”¨RPCæ¡†æ¶æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œä½†æ˜¯ä½ å¯èƒ½è¿˜ä¸æ¸…æ¥šæ€ä¹ˆä½¿ç”¨gRPCç¼–å†™APIæ¥å£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±é€šè¿‡gRPCå®˜æ–¹çš„ä¸€ä¸ªç¤ºä¾‹æ¥å¿«é€Ÿç»™å¤§å®¶å±•ç¤ºä¸‹ã€‚è¿è¡Œæœ¬ç¤ºä¾‹éœ€è¦åœ¨LinuxæœåŠ¡å™¨ä¸Šå®‰è£…Goç¼–è¯‘å™¨ã€Protocol bufferç¼–è¯‘å™¨ï¼ˆprotocï¼Œv3ï¼‰å’Œ protoc çš„Goè¯­è¨€æ’ä»¶ï¼Œåœ¨ <a href=\"https://time.geekbang.org/column/article/378076\"><strong>02è®²</strong></a> ä¸­æˆ‘ä»¬å·²ç»å®‰è£…è¿‡ï¼Œè¿™é‡Œä¸å†è®²å…·ä½“çš„å®‰è£…æ–¹æ³•ã€‚</p><p>è¿™ä¸ªç¤ºä¾‹åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li>å®šä¹‰gRPCæœåŠ¡ã€‚</li>\n<li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ã€‚</li>\n<li>å®ç°gRPCæœåŠ¡ã€‚</li>\n<li>å®ç°gRPCå®¢æˆ·ç«¯ã€‚</li>\n</ol><p>ç¤ºä¾‹ä»£ç å­˜æ”¾åœ¨<a href=\"https://github.com/marmotedu/gopractise-demo/tree/main/apistyle/greeter\">gopractise-demo/apistyle/greeter</a>ç›®å½•ä¸‹ã€‚ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code>$ tree\nâ”œâ”€â”€ client\nâ”‚   â””â”€â”€ main.go\nâ”œâ”€â”€ helloworld\nâ”‚   â”œâ”€â”€ helloworld.pb.go\nâ”‚   â””â”€â”€ helloworld.proto\nâ””â”€â”€ server\n    â””â”€â”€ main.go\n</code></pre><p>clientç›®å½•å­˜æ”¾Clientç«¯çš„ä»£ç ï¼Œhelloworldç›®å½•ç”¨æ¥å­˜æ”¾æœåŠ¡çš„IDLå®šä¹‰ï¼Œserverç›®å½•ç”¨æ¥å­˜æ”¾Serverç«¯çš„ä»£ç ã€‚</p><p>ä¸‹é¢æˆ‘å…·ä½“ä»‹ç»ä¸‹è¿™ä¸ªç¤ºä¾‹çš„å››ä¸ªæ­¥éª¤ã€‚</p><ol>\n<li>å®šä¹‰gRPCæœåŠ¡ã€‚</li>\n</ol><p>é¦–å…ˆï¼Œéœ€è¦å®šä¹‰æˆ‘ä»¬çš„æœåŠ¡ã€‚è¿›å…¥helloworldç›®å½•ï¼Œæ–°å»ºæ–‡ä»¶helloworld.protoï¼š</p><pre><code>$ cd helloworld\n$ vi helloworld.proto\n</code></pre><p>å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>syntax = &quot;proto3&quot;;\n\noption go_package = &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;;\n\npackage helloworld;\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n</code></pre><p>åœ¨helloworld.protoå®šä¹‰æ–‡ä»¶ä¸­ï¼Œoptionå…³é”®å­—ç”¨æ¥å¯¹.protoæ–‡ä»¶è¿›è¡Œä¸€äº›è®¾ç½®ï¼Œå…¶ä¸­go_packageæ˜¯å¿…éœ€çš„è®¾ç½®ï¼Œè€Œä¸”go_packageçš„å€¼å¿…é¡»æ˜¯åŒ…å¯¼å…¥çš„è·¯å¾„ã€‚packageå…³é”®å­—æŒ‡å®šç”Ÿæˆçš„.pb.goæ–‡ä»¶æ‰€åœ¨çš„åŒ…åã€‚æˆ‘ä»¬é€šè¿‡serviceå…³é”®å­—å®šä¹‰æœåŠ¡ï¼Œç„¶åå†æŒ‡å®šè¯¥æœåŠ¡æ‹¥æœ‰çš„RPCæ–¹æ³•ï¼Œå¹¶å®šä¹‰æ–¹æ³•çš„è¯·æ±‚å’Œè¿”å›çš„ç»“æ„ä½“ç±»å‹ï¼š</p><pre><code>service Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n}\n</code></pre><p>gRPCæ”¯æŒå®šä¹‰4ç§ç±»å‹çš„æœåŠ¡æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç®€å•æ¨¡å¼ã€æœåŠ¡ç«¯æ•°æ®æµæ¨¡å¼ã€å®¢æˆ·ç«¯æ•°æ®æµæ¨¡å¼å’ŒåŒå‘æ•°æ®æµæ¨¡å¼ã€‚</p><ul>\n<li>\n<p>ç®€å•æ¨¡å¼ï¼ˆSimple RPCï¼‰ï¼šæ˜¯æœ€ç®€å•çš„gRPCæ¨¡å¼ã€‚å®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å“åº”ä¸€ä¸ªæ•°æ®ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (HelloRequest) returns (HelloReply) {}ã€‚</p>\n</li>\n<li>\n<p>æœåŠ¡ç«¯æ•°æ®æµæ¨¡å¼ï¼ˆServer-side streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®æµå“åº”ï¼Œå®¢æˆ·ç«¯ä»æµä¸­è¯»å–æ•°æ®ç›´åˆ°ä¸ºç©ºã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (HelloRequest) returns (stream HelloReply) {}ã€‚</p>\n</li>\n<li>\n<p>å®¢æˆ·ç«¯æ•°æ®æµæ¨¡å¼ï¼ˆClient-side streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å°†æ¶ˆæ¯ä»¥æµçš„æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å…¨éƒ¨å¤„ç†å®Œæˆä¹‹åè¿”å›ä¸€æ¬¡å“åº”ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (stream HelloRequest) returns (HelloReply) {}ã€‚</p>\n</li>\n<li>\n<p>åŒå‘æ•°æ®æµæ¨¡å¼ï¼ˆBidirectional streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘å¯¹æ–¹å‘é€æ•°æ®æµï¼Œè¿™ä¸ªæ—¶å€™åŒæ–¹çš„æ•°æ®å¯ä»¥åŒæ—¶äº’ç›¸å‘é€ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å®ç°å®æ—¶äº¤äº’RPCæ¡†æ¶åŸç†ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (stream HelloRequest) returns (stream HelloReply) {}ã€‚</p>\n</li>\n</ul><p>æœ¬ç¤ºä¾‹ä½¿ç”¨äº†ç®€å•æ¨¡å¼ã€‚.protoæ–‡ä»¶ä¹ŸåŒ…å«äº†Protocol Buffers æ¶ˆæ¯çš„å®šä¹‰ï¼ŒåŒ…æ‹¬è¯·æ±‚æ¶ˆæ¯å’Œè¿”å›æ¶ˆæ¯ã€‚ä¾‹å¦‚è¯·æ±‚æ¶ˆæ¯ï¼š</p><pre><code>// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n</code></pre><ol start=\"2\">\n<li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ã€‚</li>\n</ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®.protoæœåŠ¡å®šä¹‰ç”ŸæˆgRPCå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨protocç¼–è¯‘å·¥å…·ï¼Œå¹¶æŒ‡å®šä½¿ç”¨å…¶Goè¯­è¨€æ’ä»¶æ¥ç”Ÿæˆï¼š</p><pre><code>$ protoc -I. --go_out=plugins=grpc:$GOPATH/src helloworld.proto\n$ ls\nhelloworld.pb.go  helloworld.proto\n</code></pre><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ–°å¢äº†ä¸€ä¸ªhelloworld.pb.goæ–‡ä»¶ã€‚</p><ol start=\"3\">\n<li>å®ç°gRPCæœåŠ¡ã€‚</li>\n</ol><p>æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°gRPCæœåŠ¡äº†ã€‚è¿›å…¥serverç›®å½•ï¼Œæ–°å»ºmain.goæ–‡ä»¶ï¼š</p><pre><code>$ cd ../server\n$ vi main.go\n</code></pre><p>main.goå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>// Package main implements a server for Greeter service.\npackage main\n\nimport (\n\t&quot;context&quot;\n\t&quot;log&quot;\n\t&quot;net&quot;\n\n\tpb &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;\n\t&quot;google.golang.org/grpc&quot;\n)\n\nconst (\n\tport = &quot;:50051&quot;\n)\n\n// server is used to implement helloworld.GreeterServer.\ntype server struct {\n\tpb.UnimplementedGreeterServer\n}\n\n// SayHello implements helloworld.GreeterServer\nfunc (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {\n\tlog.Printf(&quot;Received: %v&quot;, in.GetName())\n\treturn &amp;pb.HelloReply{Message: &quot;Hello &quot; + in.GetName()}, nil\n}\n\nfunc main() {\n\tlis, err := net.Listen(&quot;tcp&quot;, port)\n\tif err != nil {\n\t\tlog.Fatalf(&quot;failed to listen: %v&quot;, err)\n\t}\n\ts := grpc.NewServer()\n\tpb.RegisterGreeterServer(s, &amp;server{})\n\tif err := s.Serve(lis); err != nil {\n\t\tlog.Fatalf(&quot;failed to serve: %v&quot;, err)\n\t}\n}\n</code></pre><p>ä¸Šé¢çš„ä»£ç å®ç°äº†æˆ‘ä»¬ä¸Šä¸€æ­¥æ ¹æ®æœåŠ¡å®šä¹‰ç”Ÿæˆçš„Goæ¥å£ã€‚</p><p>æˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ªGoç»“æ„ä½“serverï¼Œå¹¶ä¸ºserverç»“æ„ä½“æ·»åŠ <code>SayHello(context.Context, pb.HelloRequest) (pb.HelloReply, error)</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´serveræ˜¯GreeterServeræ¥å£ï¼ˆä½äºhelloworld.pb.goæ–‡ä»¶ä¸­ï¼‰çš„ä¸€ä¸ªå®ç°ã€‚</p><p>åœ¨æˆ‘ä»¬å®ç°äº†gRPCæœåŠ¡æ‰€å®šä¹‰çš„æ–¹æ³•ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ <code>net.Listen(...)</code> æŒ‡å®šç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚çš„ç«¯å£ï¼›æ¥ç€ï¼Œé€šè¿‡ <code>grpc.NewServer()</code> åˆ›å»ºä¸€ä¸ªgRPC Serverå®ä¾‹ï¼Œå¹¶é€šè¿‡ <code>pb.RegisterGreeterServer(s, &amp;server{})</code> å°†è¯¥æœåŠ¡æ³¨å†Œåˆ°gRPCæ¡†æ¶ä¸­ï¼›æœ€åï¼Œé€šè¿‡ <code>s.Serve(lis)</code> å¯åŠ¨gRPCæœåŠ¡ã€‚</p><p>åˆ›å»ºå®Œmain.goæ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œ <code>go run main.go</code> ï¼Œå¯åŠ¨gRPCæœåŠ¡ã€‚</p><ol start=\"4\">\n<li>å®ç°gRPCå®¢æˆ·ç«¯ã€‚</li>\n</ol><p>æ‰“å¼€ä¸€ä¸ªæ–°çš„Linuxç»ˆç«¯ï¼Œè¿›å…¥clientç›®å½•ï¼Œæ–°å»ºmain.goæ–‡ä»¶ï¼š</p><pre><code>$ cd ../client\n$ vi main.go\n</code></pre><p>main.goå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>// Package main implements a client for Greeter service.\npackage main\n\nimport (\n\t&quot;context&quot;\n\t&quot;log&quot;\n\t&quot;os&quot;\n\t&quot;time&quot;\n\n\tpb &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;\n\t&quot;google.golang.org/grpc&quot;\n)\n\nconst (\n\taddress     = &quot;localhost:50051&quot;\n\tdefaultName = &quot;world&quot;\n)\n\nfunc main() {\n\t// Set up a connection to the server.\n\tconn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock())\n\tif err != nil {\n\t\tlog.Fatalf(&quot;did not connect: %v&quot;, err)\n\t}\n\tdefer conn.Close()\n\tc := pb.NewGreeterClient(conn)\n\n\t// Contact the server and print out its response.\n\tname := defaultName\n\tif len(os.Args) &gt; 1 {\n\t\tname = os.Args[1]\n\t}\n\tctx, cancel := context.WithTimeout(context.Background(), time.Second)\n\tdefer cancel()\n\tr, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: name})\n\tif err != nil {\n\t\tlog.Fatalf(&quot;could not greet: %v&quot;, err)\n\t}\n\tlog.Printf(&quot;Greeting: %s&quot;, r.Message)\n}\n</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¦‚ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªgRPCè¿æ¥ï¼Œç”¨æ¥è·ŸæœåŠ¡ç«¯è¿›è¡Œé€šä¿¡ï¼š</p><pre><code>// Set up a connection to the server.\nconn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock())\nif err != nil {\n    log.Fatalf(&quot;did not connect: %v&quot;, err)\n}\ndefer conn.Close()\n</code></pre><p>åœ¨åˆ›å»ºè¿æ¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸åŒçš„é€‰é¡¹ï¼Œç”¨æ¥æ§åˆ¶åˆ›å»ºè¿æ¥çš„æ–¹å¼ï¼Œä¾‹å¦‚grpc.WithInsecure()ã€grpc.WithBlock()ç­‰ã€‚gRPCæ”¯æŒå¾ˆå¤šé€‰é¡¹ï¼Œæ›´å¤šçš„é€‰é¡¹å¯ä»¥å‚è€ƒgrpcä»“åº“ä¸‹<a href=\"https://github.com/grpc/grpc-go/blob/v1.37.0/dialoptions.go\">dialoptions.go</a>æ–‡ä»¶ä¸­ä»¥Withå¼€å¤´çš„å‡½æ•°ã€‚</p><p>è¿æ¥å»ºç«‹èµ·æ¥ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯stubï¼Œç”¨æ¥æ‰§è¡ŒRPCè¯·æ±‚<code>c := pb.NewGreeterClient(conn)</code>ã€‚åˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨è¿œç¨‹çš„æ–¹æ³•äº†ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢ä¸€æ®µä»£ç é€šè¿‡ <code>c.SayHello</code> è¿™ç§æœ¬åœ°å¼è°ƒç”¨æ–¹å¼è°ƒç”¨äº†è¿œç«¯çš„SayHelloæ¥å£ï¼š</p><pre><code>r, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: name})\nif err != nil {\n    log.Fatalf(&quot;could not greet: %v&quot;, err)\n}\nlog.Printf(&quot;Greeting: %s&quot;, r.Message)\n</code></pre><p>ä»ä¸Šé¢çš„è°ƒç”¨æ ¼å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°RPCè°ƒç”¨å…·æœ‰ä¸‹é¢ä¸¤ä¸ªç‰¹ç‚¹ã€‚</p><ul>\n<li>è°ƒç”¨æ–¹ä¾¿ï¼šRPCå±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œä½¿å¾—è°ƒç”¨RPCå°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·æ–¹ä¾¿ï¼Œè°ƒç”¨æ–¹å¼è·Ÿå¤§å®¶æ‰€ç†ŸçŸ¥çš„è°ƒç”¨ç±»çš„æ–¹æ³•ä¸€è‡´ï¼š<code>ClassName.ClassFuc(params)</code>ã€‚</li>\n<li>ä¸éœ€è¦æ‰“åŒ…å’Œè§£åŒ…ï¼šRPCè°ƒç”¨çš„å…¥å‚å’Œè¿”å›çš„ç»“æœéƒ½æ˜¯Goçš„ç»“æ„ä½“ï¼Œä¸éœ€è¦å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œæ‰“åŒ…æ“ä½œï¼Œä¹Ÿä¸éœ€è¦å¯¹è¿”å›å‚æ•°è¿›è¡Œè§£åŒ…æ“ä½œï¼Œç®€åŒ–äº†è°ƒç”¨æ­¥éª¤ã€‚</li>\n</ul><p>æœ€åï¼Œåˆ›å»ºå®Œmain.goæ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæ‰§è¡Œgo run main.goå‘èµ·RPCè°ƒç”¨ï¼š</p><pre><code>$ go run main.go\n2020/10/17 07:55:00 Greeting: Hello world\n</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ç”¨å››ä¸ªæ­¥éª¤ï¼Œåˆ›å»ºå¹¶è°ƒç”¨äº†ä¸€ä¸ªgRPCæœåŠ¡ã€‚æ¥ä¸‹æ¥æˆ‘å†ç»™å¤§å®¶è®²è§£ä¸€ä¸ªåœ¨å…·ä½“åœºæ™¯ä¸­çš„æ³¨æ„äº‹é¡¹ã€‚</p><p>åœ¨åšæœåŠ¡å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ç§åœºæ™¯ï¼šå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ä¼šé€šè¿‡åˆ¤æ–­æ˜¯å¦ä¼ å…¥æŸä¸ªå‚æ•°ï¼Œå†³å®šæ¥å£è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³æä¾›ä¸€ä¸ªGetUseræ¥å£ï¼ŒæœŸæœ›GetUseræ¥å£åœ¨ä¼ å…¥usernameå‚æ•°æ—¶ï¼Œæ ¹æ®usernameæŸ¥è¯¢ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥usernameï¼Œåˆ™é»˜è®¤æ ¹æ®userIdæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å®¢æˆ·ç«¯æœ‰æ²¡æœ‰ä¼ å…¥usernameå‚æ•°ã€‚æˆ‘ä»¬ä¸èƒ½æ ¹æ®usernameæ˜¯å¦ä¸ºç©ºå€¼æ¥åˆ¤æ–­ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½åŒºåˆ†å®¢æˆ·ç«¯ä¼ çš„æ˜¯ç©ºå€¼ï¼Œè¿˜æ˜¯æ²¡æœ‰ä¼ usernameå‚æ•°ã€‚è¿™æ˜¯ç”±Goè¯­è¨€çš„è¯­æ³•ç‰¹æ€§å†³å®šçš„ï¼šå¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰ä¼ å…¥usernameå‚æ•°ï¼ŒGoä¼šé»˜è®¤èµ‹å€¼ä¸ºæ‰€åœ¨ç±»å‹çš„é›¶å€¼ï¼Œè€Œå­—ç¬¦ä¸²ç±»å‹çš„é›¶å€¼å°±æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</p><p>é‚£æˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­å®¢æˆ·ç«¯æœ‰æ²¡æœ‰ä¼ å…¥usernameå‚æ•°å‘¢ï¼Ÿæœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡æŒ‡é’ˆæ¥åˆ¤æ–­ï¼Œå¦‚æœæ˜¯nilæŒ‡é’ˆå°±è¯´æ˜æ²¡æœ‰ä¼ å…¥ï¼ŒénilæŒ‡é’ˆå°±è¯´æ˜ä¼ å…¥ï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol>\n<li>ç¼–å†™protobufå®šä¹‰æ–‡ä»¶ã€‚</li>\n</ol><p>æ–°å»ºuser.protoæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹:</p><pre><code>syntax = &quot;proto3&quot;;\n\npackage proto;\noption go_package = &quot;github.com/marmotedu/gopractise-demo/protobuf/user&quot;;\n\n//go:generate protoc -I. --experimental_allow_proto3_optional --go_out=plugins=grpc:.\n\nservice User {\n  rpc GetUser(GetUserRequest) returns (GetUserResponse) {}\n}\n\nmessage GetUserRequest {\n  string class = 1;\n  optional string username = 2;\n  optional string user_id = 3;\n}\n\nmessage GetUserResponse {\n  string class = 1;\n  string user_id = 2;\n  string username = 3;\n  string address = 4;\n  string sex = 5;\n  string phone = 6;\n}\n</code></pre><p>ä½ éœ€è¦æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨éœ€è¦è®¾ç½®ä¸ºå¯é€‰å­—æ®µçš„å‰é¢æ·»åŠ äº†<strong>optional</strong>æ ‡è¯†ã€‚</p><ol start=\"2\">\n<li>ä½¿ç”¨protocå·¥å…·ç¼–è¯‘protobufæ–‡ä»¶ã€‚</li>\n</ol><p>åœ¨æ‰§è¡Œprotocå‘½ä»¤æ—¶ï¼Œéœ€è¦ä¼ å…¥<code>--experimental_allow_proto3_optional</code>å‚æ•°ä»¥æ‰“å¼€<strong>optional</strong>é€‰é¡¹ï¼Œç¼–è¯‘å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code>$ protoc --experimental_allow_proto3_optional --go_out=plugins=grpc:. user.proto\n</code></pre><p>ä¸Šè¿°ç¼–è¯‘å‘½ä»¤ä¼šç”Ÿæˆuser.pb.goæ–‡ä»¶ï¼Œå…¶ä¸­çš„GetUserRequestç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>type GetUserRequest struct {\n    state         protoimpl.MessageState\n    sizeCache     protoimpl.SizeCache\n    unknownFields protoimpl.UnknownFields\n\n    Class    string  `protobuf:&quot;bytes,1,opt,name=class,proto3&quot; json:&quot;class,omitempty&quot;`\n    Username *string `protobuf:&quot;bytes,2,opt,name=username,proto3,oneof&quot; json:&quot;username,omitempty&quot;`\n    UserId   *string `protobuf:&quot;bytes,3,opt,name=user_id,json=userId,proto3,oneof&quot; json:&quot;user_id,omitempty&quot;`\n}\n</code></pre><p>é€šè¿‡ <code>optional</code> + <code>--experimental_allow_proto3_optional</code> ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå­—æ®µç¼–è¯‘ä¸ºæŒ‡é’ˆç±»å‹ã€‚</p><ol start=\"3\">\n<li>ç¼–å†™gRPCæ¥å£å®ç°ã€‚</li>\n</ol><p>æ–°å»ºä¸€ä¸ªuser.goæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>package user\n\nimport (\n    &quot;context&quot;\n\n    pb &quot;github.com/marmotedu/api/proto/apiserver/v1&quot;\n\n    &quot;github.com/marmotedu/iam/internal/apiserver/store&quot;\n)\n\ntype User struct {\n}\n\nfunc (c *User) GetUser(ctx context.Context, r *pb.GetUserRequest) (*pb.GetUserResponse, error) {\n    if r.Username != nil {\n        return store.Client().Users().GetUserByName(r.Class, r.Username)\n    }\n\n    return store.Client().Users().GetUserByID(r.Class, r.UserId)\n}\n</code></pre><p>æ€»ä¹‹ï¼Œåœ¨GetUseræ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­r.Usernameæ˜¯å¦ä¸ºnilï¼Œæ¥åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦ä¼ å…¥äº†Usernameå‚æ•°ã€‚</p><h2>RESTful VS gRPC</h2><p>åˆ°è¿™é‡Œï¼Œä»Šå¤©æˆ‘ä»¬å·²ç»ä»‹ç»å®Œäº†gRPC APIã€‚å›æƒ³ä¸€ä¸‹æˆ‘ä»¬æ˜¨å¤©å­¦ä¹ çš„RESTful APIï¼Œä½ å¯èƒ½æƒ³é—®ï¼šè¿™ä¸¤ç§APIé£æ ¼åˆ†åˆ«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Œé€‚ç”¨äºä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿæˆ‘æŠŠè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ”¾åœ¨äº†ä¸‹é¢è¿™å¼ è¡¨ä¸­ï¼Œä½ å¯ä»¥å¯¹ç…§ç€å®ƒï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚åœ¨å®é™…åº”ç”¨æ—¶è¿›è¡Œé€‰æ‹©ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e6/ab/e6ae61fc4b0fc821f94d257239f332ab.png?wh=1483x1026\" alt=\"\"></p><p>å½“ç„¶ï¼Œæ›´å¤šçš„æ—¶å€™ï¼ŒRESTful API å’ŒgRPC APIæ˜¯ä¸€ç§åˆä½œçš„å…³ç³»ï¼Œå¯¹å†…ä¸šåŠ¡ä½¿ç”¨gRPC APIï¼Œå¯¹å¤–ä¸šåŠ¡ä½¿ç”¨RESTful APIï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/47/18/471ac923d2eaeca8fe13cb74731c1318.png?wh=1606x1144\" alt=\"\"></p><h2>æ€»ç»“</h2><p>åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨ RESTful API é£æ ¼å’Œ RPC API é£æ ¼ï¼Œè¿™ä¸¤ç§æœåŠ¡éƒ½ç”¨å¾—å¾ˆå¤šã€‚å…¶ä¸­ï¼ŒRESTful APIé£æ ¼å› ä¸ºè§„èŒƒã€æ˜“ç†è§£ã€æ˜“ç”¨ï¼Œæ‰€ä»¥<strong>é€‚åˆç”¨åœ¨éœ€è¦å¯¹å¤–æä¾›APIæ¥å£çš„åœºæ™¯ä¸­</strong>ã€‚è€ŒRPC APIå› ä¸ºæ€§èƒ½æ¯”è¾ƒé«˜ã€è°ƒç”¨æ–¹ä¾¿ï¼Œ<strong>æ›´é€‚åˆç”¨åœ¨å†…éƒ¨ä¸šåŠ¡ä¸­</strong>ã€‚</p><p>RESTful APIä½¿ç”¨çš„æ˜¯HTTPåè®®ï¼Œè€ŒRPC APIä½¿ç”¨çš„æ˜¯RPCåè®®ã€‚ç›®å‰ï¼Œæœ‰å¾ˆå¤šRPCåè®®å¯ä¾›ä½ é€‰æ‹©ï¼Œè€Œæˆ‘æ¨èä½ ä½¿ç”¨gRPCï¼Œå› ä¸ºå®ƒå¾ˆè½»é‡ï¼ŒåŒæ—¶æ€§èƒ½å¾ˆé«˜ã€å¾ˆç¨³å®šï¼Œæ˜¯ä¸€ä¸ªä¼˜ç§€çš„RPCæ¡†æ¶ã€‚æ‰€ä»¥ç›®å‰ä¸šç•Œç”¨çš„æœ€å¤šçš„è¿˜æ˜¯gRPCåè®®ï¼Œè…¾è®¯ã€é˜¿é‡Œç­‰å¤§å‚å†…éƒ¨å¾ˆå¤šæ ¸å¿ƒçš„çº¿ä¸ŠæœåŠ¡ç”¨çš„å°±æ˜¯gRPCã€‚</p><p>é™¤äº†ä½¿ç”¨gRPCåè®®ï¼Œåœ¨è¿›è¡ŒGoé¡¹ç›®å¼€å‘å‰ï¼Œä½ ä¹Ÿå¯ä»¥äº†è§£ä¸šç•Œä¸€äº›å…¶ä»–çš„ä¼˜ç§€Go RPCæ¡†æ¶ï¼Œæ¯”å¦‚è…¾è®¯çš„tars-goã€é˜¿é‡Œçš„dubbo-goã€Facebookçš„thriftã€rpcxç­‰ï¼Œä½ å¯ä»¥åœ¨é¡¹ç›®å¼€å‘ä¹‹å‰ä¸€å¹¶è°ƒç ”ï¼Œæ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚</p><h2>è¯¾åç»ƒä¹ </h2><ol>\n<li>ä½¿ç”¨gRPCåŒ…ï¼Œå¿«é€Ÿå®ç°ä¸€ä¸ªRPC APIæœåŠ¡ï¼Œå¹¶å®ç°PrintHelloæ¥å£ï¼Œè¯¥æ¥å£ä¼šè¿”å›â€œHello Worldâ€å­—ç¬¦ä¸²ã€‚</li>\n<li>è¯·ä½ æ€è€ƒè¿™ä¸ªåœºæ™¯ï¼šä½ æœ‰ä¸€ä¸ªgRPCæœåŠ¡ï¼Œä½†æ˜¯å´å¸Œæœ›è¯¥æœåŠ¡åŒæ—¶ä¹Ÿèƒ½æä¾›RESTful APIæ¥å£ï¼Œè¿™è¯¥å¦‚ä½•å®ç°ï¼Ÿ</li>\n</ol><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿å’Œæˆ‘ä¸€èµ·æ¢è®¨å…³äºRPC APIç›¸å…³çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼</p>","comments":[{"had_liked":false,"id":299141,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1624491736,"is_pvip":false,"replies":[{"id":"108634","content":"æ­£è§£","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624708817,"ip_address":"","comment_id":299141,"utype":1}],"discussion_count":1,"race_medal":0,"score":"250732594904","product_id":100079601,"comment_content":"å‡å®šå¸Œæœ›ç”¨RPCä½œä¸ºå†…éƒ¨APIçš„é€šè®¯ï¼ŒåŒæ—¶ä¹Ÿæƒ³å¯¹å¤–æä¾›RESTful APIï¼Œåˆä¸æƒ³å†™ä¸¤å¥—ï¼Œå¯ä»¥ä½¿ç”¨gRPC Gateway æ’ä»¶ï¼Œåœ¨ç”ŸæˆRPCçš„åŒæ—¶ä¹Ÿç”ŸæˆRESTful web  serverã€‚","like_count":58,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522345,"discussion_content":"æ­£è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624708817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331768,"user_name":"Geek_e7af5e","can_delete":false,"product_type":"c1","uid":2886894,"ip_address":"","ucode":"C3ADEC3F8DC65B","user_header":"","comment_is_top":false,"comment_ctime":1642753964,"is_pvip":false,"replies":[{"id":"121266","content":"æ„Ÿè°¢åˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1642867786,"ip_address":"","comment_id":331768,"utype":1}],"discussion_count":2,"race_medal":0,"score":"109016936364","product_id":100079601,"comment_content":"è¿™é‡Œæä¾›ä¸€äº›æ›´æ–°è¯´æ˜ï¼ˆåˆšè¸©è¿‡çš„å‘ï¼‰<br>github.com&#47;golang&#47;protobuf&#47;protoc-gen-goå’Œgoogle.golang.org&#47;protobuf&#47;cmd&#47;protoc-gen-goæ˜¯ä¸åŒçš„ã€‚åŒºåˆ«åœ¨äºå‰è€…æ˜¯æ—§ç‰ˆæœ¬ï¼ˆæ“ä½œç±»ä¼¼äºä½œè€…å¤§å¤§çš„ï¼‰ï¼Œåè€…æ˜¯googleæ¥ç®¡åçš„æ–°ç‰ˆæœ¬ï¼Œä»–ä»¬ä¹‹é—´çš„APIæ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨äºç”Ÿæˆçš„å‘½ä»¤ï¼Œä»¥åŠç”Ÿæˆçš„æ–‡ä»¶éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚å› ä¸ºç›®å‰çš„gRPC-goæºç ä¸­çš„exampleç”¨çš„æ˜¯åè€…çš„ç”Ÿæˆæ–¹å¼ï¼Œæ‰€ä»¥è¿™é‡Œæä¾›åè€…è¯´æ˜ï¼š<br>1. é¦–å…ˆéœ€è¦å®‰è£…ä¸¤ä¸ªåº“ï¼š<br>go install google.golang.org&#47;protobuf&#47;cmd&#47;protoc-gen-go<br>go install google.golang.org&#47;grpc&#47;cmd&#47;protoc-gen-go-grpc<br>2. ç„¶å.protoæ–‡ä»¶ä¿æŒä¸€è‡´ï¼Œè¾“å…¥ä¸¤ä¸ªç”Ÿæˆä»£ç å‘½ä»¤ï¼š<br>protoc -I. --go_out=$GOPATH&#47;src helloworld.proto<br>protoc -I. --go-grpc_out=$GOPATH&#47;src helloworld.proto<br>3. ä¸Šè¿°ä¸¤ä¸ªå‘½ä»¤ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š<br>helloworld.pb.go      helloworld_grpc.pb.go<br>è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«ç”Ÿæˆmessageå’Œserviceçš„ä»£ç ï¼Œåˆèµ·æ¥å°±æ˜¯è€ç‰ˆæœ¬çš„ä»£ç <br><br>è¿™æ˜¯æ’æŸ¥äº†ä¸¤å°æ—¶çš„å‘ï¼Œå¸Œæœ›å¤§å®¶æ³¨æ„ï¼","like_count":26,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547827,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642867787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1651032,"avatar":"https://static001.geekbang.org/account/avatar/00/19/31/58/5384ee72.jpg","nickname":"ä½è°ƒdä½è°ƒ","note":"","ucode":"06674CDE1B2BA7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574191,"discussion_content":"ä¹Ÿé‡åˆ°è¿™ä¸ªå‘äº†ã€‚ æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653893524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299388,"user_name":"æŸ æŸ ","can_delete":false,"product_type":"c1","uid":1185179,"ip_address":"","ucode":"B3442C29FDE624","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/9b/9ce9f374.jpg","comment_is_top":false,"comment_ctime":1624607740,"is_pvip":false,"replies":[{"id":"108625","content":"å¯¹çš„ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624707446,"ip_address":"","comment_id":299388,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53164215292","product_id":100079601,"comment_content":"RPC ä¸ RESTful å…±é€šé€»è¾‘æŠ½è±¡å‡ºæ¥ Service å±‚ï¼ŒRPC server å’Œ RESTful server åˆå§‹åŒ–or å¯åŠ¨æ—¶æ—¶éƒ½éœ€è¦æŒ‡å®š serviceï¼ŒçœŸæ­£æä¾›æœåŠ¡çš„æ˜¯ Service å±‚","like_count":12,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522429,"discussion_content":"å¯¹çš„ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624707446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299320,"user_name":"ğŸ’A","can_delete":false,"product_type":"c1","uid":1075412,"ip_address":"","ucode":"914FFA92CA2713","user_header":"https://static001.geekbang.org/account/avatar/00/10/68/d4/c9b5d3f9.jpg","comment_is_top":false,"comment_ctime":1624581537,"is_pvip":false,"replies":[{"id":"108626","content":"æ„Ÿè°¢åˆ†äº«ï¼Œæ–‡ç« éå¸¸æ£’ï¼å·²æ”¶è—ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624707519,"ip_address":"","comment_id":299320,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40279287201","product_id":100079601,"comment_content":"https:&#47;&#47;www.bookstack.cn&#47;read&#47;API-design-guide&#47;API-design-guide-04-%E6%A0%87%E5%87%86%E6%96%B9%E6%B3%95.md  æˆ‘åˆæ¥åšè´¡çŒ®äº†","like_count":9,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522404,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œæ–‡ç« éå¸¸æ£’ï¼å·²æ”¶è—ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624707519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299216,"user_name":"ä¸æ˜çœŸç›¸çš„ç¾¤ä¼—","can_delete":false,"product_type":"c1","uid":2267730,"ip_address":"","ucode":"046A7D345171B8","user_header":"https://static001.geekbang.org/account/avatar/00/22/9a/52/93416b65.jpg","comment_is_top":false,"comment_ctime":1624515886,"is_pvip":true,"replies":[{"id":"108631","content":"ç”¨è¿™ä¸ªï¼šhttps:&#47;&#47;github.com&#47;grpc-ecosystem&#47;grpc-gateway","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624708651,"ip_address":"","comment_id":299216,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27394319662","product_id":100079601,"comment_content":"ä½ æœ‰ä¸€ä¸ª gRPC æœåŠ¡ï¼Œä½†æ˜¯å´å¸Œæœ›è¯¥æœåŠ¡åŒæ—¶ä¹Ÿèƒ½æä¾› RESTful API æ¥å£ï¼Œè¿™è¯¥å¦‚ä½•å®ç°ï¼Ÿ<br>---------------------------<br>åœ¨å°è£…ä¸€å±‚ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522366,"discussion_content":"ç”¨è¿™ä¸ªï¼šhttps://github.com/grpc-ecosystem/grpc-gateway","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624708651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330163,"user_name":"é™ˆæ™“æ¶›","can_delete":false,"product_type":"c1","uid":1588873,"ip_address":"","ucode":"E80D318348CA47","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/89/ccc2ebd9.jpg","comment_is_top":false,"comment_ctime":1641822756,"is_pvip":false,"replies":[{"id":"120945","content":"æ„Ÿè°¢åˆ†äº«ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1642434014,"ip_address":"","comment_id":330163,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18821691940","product_id":100079601,"comment_content":"æƒ³æ–¹ä¾¿è°ƒç”¨grpcï¼Œå¯ä»¥ä½¿ç”¨grpcurlå’Œgrpcuiï¼ŒåŸºäºåå°„çš„æ–¹å¼ä½¿ç”¨","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546846,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642434014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302376,"user_name":"å¼ åå“²","can_delete":false,"product_type":"c1","uid":1260121,"ip_address":"","ucode":"0476910BC2FE81","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/59/d0f326e7.jpg","comment_is_top":false,"comment_ctime":1626183282,"is_pvip":false,"replies":[{"id":"109487","content":"ç®€å•æ¨¡å¼ç”¨çš„æ¯”è¾ƒå¤š","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1626280205,"ip_address":"","comment_id":302376,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18806052466","product_id":100079601,"comment_content":"è€å¸ˆï¼Œæ–‡ç« ä¸­æœ‰å››ç§æ¨¡å¼ï¼Œå¹³æ—¶ç”¨çš„æœ€å¤šçš„æ˜¯å“ªä¸€ç§æ¨¡å¼ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523282,"discussion_content":"ç®€å•æ¨¡å¼ç”¨çš„æ¯”è¾ƒå¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626280205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306889,"user_name":"wei ä¸¶","can_delete":false,"product_type":"c1","uid":1234929,"ip_address":"","ucode":"331DE893F75B95","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/f1/ce10759d.jpg","comment_is_top":false,"comment_ctime":1628764122,"is_pvip":false,"replies":[{"id":"111398","content":"ç¬¬äºŒä¸ªæŒ‡å®šäº†grpc plugin","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1629243535,"ip_address":"","comment_id":306889,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14513666010","product_id":100079601,"comment_content":"è€å¸ˆæœ‰ä¸ªç–‘é—®<br>protoc --go_out=. *.proto<br>protoc --go_out=plugins=grpc:. *.proto<br>è¿™ä¿©æœ‰å•¥å•¥åŒºåˆ«  ğŸ˜µ","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524963,"discussion_content":"ç¬¬äºŒä¸ªæŒ‡å®šäº†grpc plugin","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629243535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1674992,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8e/f0/18720510.jpg","nickname":"50%","note":"","ucode":"3E4247B5844B5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537659,"discussion_content":"åé¢çš„ç”Ÿæˆäº†serviceç›¸å…³çš„ä»£ç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639131637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314479,"user_name":"Juniper","can_delete":false,"product_type":"c1","uid":1174794,"ip_address":"","ucode":"1BC24554034BD3","user_header":"https://static001.geekbang.org/account/avatar/00/11/ed/0a/18201290.jpg","comment_is_top":false,"comment_ctime":1633104156,"is_pvip":false,"replies":[{"id":"114079","content":"æˆ‘è¯•äº†ï¼Œåé¢çš„ç‰ˆæœ¬å»æ‰äº†--experimental_allow_proto3_optionalå‚æ•°çš„é™åˆ¶ã€‚é‚£å°±å¯ä»¥ä¸ç”¨åŠ è¿™ä¸ªé€‰é¡¹äº†ï¼Œä»£ç æˆ‘ä¹Ÿæ›´æ–°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1633664625,"ip_address":"","comment_id":314479,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10223038748","product_id":100079601,"comment_content":"æŸ¥äº†ä¸‹æ–‡æ¡£ï¼Œoptionalæ˜¯protoco 3.12ç‰ˆæœ¬åŠ å…¥çš„ï¼Œå¦‚æœå‚æ•°è®¾ç½®æˆoptionalï¼Œæ‰§è¡Œæ—¶å¿…é¡»è¦å¸¦--experimental_allow_proto3_optionalã€‚ä½†æ˜¯æˆ‘æ˜¯3.15.8ç‰ˆæœ¬ï¼Œæ‰§è¡Œæ—¶æ²¡æœ‰åŠ ä¸Š--experimental_allow_proto3_optionalä¹Ÿæ²¡æœ‰æŠ¥é”™","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527694,"discussion_content":"æˆ‘è¯•äº†ï¼Œåé¢çš„ç‰ˆæœ¬å»æ‰äº†--experimental_allow_proto3_optionalå‚æ•°çš„é™åˆ¶ã€‚é‚£å°±å¯ä»¥ä¸ç”¨åŠ è¿™ä¸ªé€‰é¡¹äº†ï¼Œä»£ç æˆ‘ä¹Ÿæ›´æ–°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633664625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1017289,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKDe7Ep3YW87sWJLc9GzgA2z1CSyHI3iaZQpCLzM2O1e30CQywGsMj5cQyh6pTGybvFgN0bTuWE8nA/132","nickname":"é£éª‘","note":"","ucode":"D96526F7F37442","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":537313,"discussion_content":"è¿™ä¸ªåº”è¯¥æ˜¯åœ¨3.15åçš„ç‰ˆæœ¬å–æ¶ˆçš„,æˆ‘ç”¨3.14ç‰ˆæœ¬è¯•äº†ä¸‹,è¿˜æ˜¯ä¼šæç¤ºè¿™ä¸ªå‚æ•°æ²¡æœ‰è®¾ç½®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639030922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":527694,"ip_address":""},"score":537313,"extra":""}]}]},{"had_liked":false,"id":352898,"user_name":"é¡ºåŠ¿è€Œä¸º","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"åŒ—äº¬","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1658999553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5953966849","product_id":100079601,"comment_content":"å»ºè®®ä½œè€…çš„å‘½ä»¤è¡Œï¼Œå¤šç‚¹pwdï¼Œæ–¹ä¾¿æˆ‘ä»¬å®šä½","like_count":1},{"had_liked":false,"id":317685,"user_name":"æ±Ÿæ¹–å¤œé›¨åå¹´ç¯","can_delete":false,"product_type":"c1","uid":1520772,"ip_address":"","ucode":"0CCFCA6F855AC8","user_header":"https://static001.geekbang.org/account/avatar/00/17/34/84/27ecfcab.jpg","comment_is_top":false,"comment_ctime":1634889876,"is_pvip":false,"replies":[{"id":"116904","content":"protocç¼–è¯‘å™¨çš„è®¾å®šå“ˆï¼Œéµå¾ªå°±æ˜¯äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1637104878,"ip_address":"","comment_id":317685,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5929857172","product_id":100079601,"comment_content":"è€å¸ˆï¼Œæˆ‘çš„protoæ–‡ä»¶æ˜¯è¿™æ ·å†™çš„ï¼Œgo_packageç”¨çš„æ˜¯æˆ‘æœ¬åœ°é¡¹ç›®çš„ç›®å½•ï¼š<br>option go_package = &quot;whw_scripts_stroage&#47;a_grpc_tests&#47;helloworld&quot;;<br>åœ¨helloworldç›®å½•ä¸­æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š<br>sudo protoc -I. --go_out=. .&#47;helloworld.proto <br>ä½†æ˜¯æœ€ååœ¨helloworldç›®å½•ä¸­ï¼Œä¸helloworld.protoæ–‡ä»¶åŒä¸€ä¸ªçº§åˆ«ç”Ÿæˆçš„ä¸æ˜¯helloworld.pb.goï¼Œè€Œæ˜¯ï¼šwhw_scripts_stroage&#47;a_grpc_tests&#47;helloworld.pb.go<br>è¯·é—®ä¸ºä»€ä¹ˆç”Ÿæˆçš„æ˜¯ç›®å½•åŠ goæ–‡ä»¶å‘¢ï¼Ÿ<br><br><br><br>","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530557,"discussion_content":"protocç¼–è¯‘å™¨çš„è®¾å®šå“ˆï¼Œéµå¾ªå°±æ˜¯äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637104878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316175,"user_name":"andox","can_delete":false,"product_type":"c1","uid":1312987,"ip_address":"","ucode":"28C037A0F82E7D","user_header":"","comment_is_top":false,"comment_ctime":1634192232,"is_pvip":false,"replies":[{"id":"114926","content":"istioè¯•è¯•ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å­”ä»¤é£","uid":"1167883","ctime":1634737892,"ip_address":"","comment_id":316175,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5929159528","product_id":100079601,"comment_content":"grpcæœ‰æ¨èçš„æœåŠ¡æ²»ç†æ–¹æ¡ˆå—","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528294,"discussion_content":"istioè¯•è¯•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634737892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306004,"user_name":"Sch0ng","can_delete":false,"product_type":"c1","uid":1145554,"ip_address":"","ucode":"73F6113931B1AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg","comment_is_top":false,"comment_ctime":1628268757,"is_pvip":false,"replies":[{"id":"110903","content":"å¼ºï¼","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1628524888,"ip_address":"","comment_id":306004,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5923236053","product_id":100079601,"comment_content":"ä¸€æ–‡ææ‡‚rpcï¼Œè¿™ä¸ªå‘¨æœ«å†™ä¸€ä¸‹demoã€‚å‘¨æ—¥æ™šä¸Šå†æ¥æ‰“å¡ã€‚","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524592,"discussion_content":"å¼ºï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628524888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145554,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg","nickname":"Sch0ng","note":"","ucode":"73F6113931B1AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387836,"discussion_content":"æ²¡å†™ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628440724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303487,"user_name":"æ¼‚æ³Šçš„å°é£˜","can_delete":false,"product_type":"c1","uid":1222578,"ip_address":"","ucode":"25C0CA4887D8AD","user_header":"https://static001.geekbang.org/account/avatar/00/12/a7/b2/274a4192.jpg","comment_is_top":false,"comment_ctime":1626828757,"is_pvip":false,"replies":[{"id":"110234","content":"1. å¥½åƒæ²¡æœ‰å¤ªå›ºå®šçš„åœºæ™¯ï¼Œå…·ä½“æ ¹æ®éœ€è¦é€‰æ‹©å°±è¡Œäº†ã€‚<br><br>2. ç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ”¾åœ¨Gitä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1627600087,"ip_address":"","comment_id":303487,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5921796053","product_id":100079601,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜è¯·æ•™ä¸‹ï¼š<br>1ï¼Œèƒ½å¦è®²ä¸‹å››ç§æ¨¡å¼çš„åº”ç”¨åœºæ™¯ï¼Ÿ<br>2ï¼Œä¸€èˆ¬ç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ”¾è¿›gité‡Œé¢å—","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523702,"discussion_content":"1. å¥½åƒæ²¡æœ‰å¤ªå›ºå®šçš„åœºæ™¯ï¼Œå…·ä½“æ ¹æ®éœ€è¦é€‰æ‹©å°±è¡Œäº†ã€‚\n\n2. ç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ”¾åœ¨Gitä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627600087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299298,"user_name":"learner2021","can_delete":false,"product_type":"c1","uid":1223059,"ip_address":"","ucode":"2568862DB4ABC5","user_header":"https://static001.geekbang.org/account/avatar/00/12/a9/93/2a26fe6e.jpg","comment_is_top":false,"comment_ctime":1624550052,"is_pvip":false,"replies":[{"id":"108627","content":"çœ‹çœ‹github.com&#47;marmotedu&#47;gopractise-demoç›®å½•ä¸‹ï¼Œæœ‰æ²¡æœ‰go.modã€‚<br><br>å¦‚æœæœ‰å»ºè®®æ‰§è¡Œä¸‹ï¼šgo mod tidy","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624707658,"ip_address":"","comment_id":299298,"utype":1}],"discussion_count":4,"race_medal":0,"score":"5919517348","product_id":100079601,"comment_content":"å“ªé‡Œè®¾ç½®é”™è¯¯äº†ï¼Ÿ<br>[going@dev server]$ pwd<br>&#47;home&#47;going&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;server<br>[going@dev server]$ go run main.go<br>main.go:8:2: no required module provides package github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;helloworld: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;<br>main.go:9:2: no required module provides package google.golang.org&#47;grpc: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522392,"discussion_content":"çœ‹çœ‹github.com/marmotedu/gopractise-demoç›®å½•ä¸‹ï¼Œæœ‰æ²¡æœ‰go.modã€‚\n\nå¦‚æœæœ‰å»ºè®®æ‰§è¡Œä¸‹ï¼šgo mod tidy","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624707658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2737221,"avatar":"https://static001.geekbang.org/account/avatar/00/29/c4/45/88287ede.jpg","nickname":"chinandy","note":"","ucode":"396E8478BB0393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389941,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ï¼Œæˆ‘æ˜¯ä¸ªæ–°æ‰‹ï¼Œä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡goè¯­è¨€ï¼Œæˆ‘åˆ†æäº†ä¸€ä¸‹åŸå› ï¼Œä¸å¯¹å‹¿å–·ã€‚\n1. ç”±äºç¬¬äºŒç« é…ç½®äº†GO111MODULEä¸º  onã€‚åœ¨ä½¿ç”¨æ¨¡å—çš„æ—¶å€™ï¼Œ$GOPATH æ˜¯æ— æ„ä¹‰çš„ï¼Œä¸è¿‡å®ƒè¿˜æ˜¯ä¼šæŠŠä¸‹è½½çš„ä¾èµ–å‚¨å­˜åœ¨ $GOPATH/pkg/mod ç›®å½•ä¸­ï¼Œä¹Ÿä¼šæŠŠ go install çš„äºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾åœ¨ $GOPATH/bin ç›®å½•ä¸­ã€‚\n2. æ‰€ä»¥å¦‚æœæ˜¯è‡ªå·±æ‰‹åŠ¨å†™çš„ä»£ç ï¼Œåº”è¯¥åœ¨gopractise-demoä¸‹æ‰§è¡Œgo mod initï¼Œè¿™ä¸ªæ—¶å€™ä½ ä»¬åªæ˜¯ç»™ä½ åˆå§‹åŒ–äº†ä¸€ä¸ªgo.mod,é‡Œé¢å†…å®¹åªæ˜¯æŒ‡æ˜äº†goçš„ç‰ˆæœ¬è¿™æ ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ­¤æ—¶å†ä½¿ç”¨go mod tidyå‘½ä»¤ï¼Œè¿™æ ·ä»–ä¼šè‡ªåŠ¨æŠŠé¡¹ç›®çš„ä¾èµ–å®‰è£…å¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629529657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2654999,"avatar":"https://static001.geekbang.org/account/avatar/00/28/83/17/df99b53d.jpg","nickname":"éšé£è€Œè¿‡","note":"","ucode":"FFD17BAA3B2312","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2737221,"avatar":"https://static001.geekbang.org/account/avatar/00/29/c4/45/88287ede.jpg","nickname":"chinandy","note":"","ucode":"396E8478BB0393","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390334,"discussion_content":"å¯ä»¥è¡¥ä¸‹goä¾èµ–è¿™å—çš„åŸºç¡€","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629786626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":389941,"ip_address":""},"score":390334,"extra":""}]},{"author":{"id":1223059,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a9/93/2a26fe6e.jpg","nickname":"learner2021","note":"","ucode":"2568862DB4ABC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380847,"discussion_content":"è‡ªå·±æ‰‹å·¥åˆ›å»ºç›®å½•å’Œä»£ç æ–‡ä»¶ï¼Œæ²¡æœ‰go.modï¼Œä»gitä»“åº“ä¸‹è½½go.modåæ­£å¸¸äº†ï¼Œè°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624723124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299295,"user_name":"kkgo","can_delete":false,"product_type":"c1","uid":1199356,"ip_address":"","ucode":"AFCCBFD96CFA21","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg","comment_is_top":false,"comment_ctime":1624547940,"is_pvip":false,"replies":[{"id":"108628","content":"æ²¡å¯¹æ¯”è¿‡ï¼Œè€å“¥å¯ä»¥å¯¹æ¯”ä¸‹æ€§èƒ½ï¼Œåˆ†äº«å‡ºæ¥","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624707676,"ip_address":"","comment_id":299295,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5919515236","product_id":100079601,"comment_content":"è€å¸ˆæœ‰å¯¹æ¯”è¿‡grpcå’Œrpcxä¹‹é—´çš„æ€§èƒ½ï¼Œç¨³å®šæ€§æ–¹é¢ä¸? çœ‹å®˜æ–¹è¯´æ˜rpcxæ€§èƒ½æ˜¯grpcçš„2å€","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522391,"discussion_content":"æ²¡å¯¹æ¯”è¿‡ï¼Œè€å“¥å¯ä»¥å¯¹æ¯”ä¸‹æ€§èƒ½ï¼Œåˆ†äº«å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624707676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299285,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624543647,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5919510943","product_id":100079601,"comment_content":"ä¼˜ç§€ğŸ‘","like_count":1},{"had_liked":false,"id":360689,"user_name":"enjoylearning","can_delete":false,"product_type":"c1","uid":1000237,"ip_address":"åŒ—äº¬","ucode":"DCAF8538DEA277","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/2d/af86d73f.jpg","comment_is_top":false,"comment_ctime":1666761661,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666761661","product_id":100079601,"comment_content":"ä¸é”™ï¼Œgrpcgateway","like_count":0},{"had_liked":false,"id":355198,"user_name":"æœ±å…ƒå½¬ğŸ—¿","can_delete":false,"product_type":"c1","uid":2725689,"ip_address":"å¹¿ä¸œ","ucode":"9CBD43225EE65B","user_header":"https://static001.geekbang.org/account/avatar/00/29/97/39/1f5c6350.jpg","comment_is_top":false,"comment_ctime":1661165647,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1661165647","product_id":100079601,"comment_content":"ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨æœåŠ¡æä¾›è€…çš„æ¥å£ï¼Œå¦‚æœé‡åˆ°æ¥å£æ›´æ–°çš„æƒ…å†µï¼Œè¦æ€ä¹ˆè·ŸæœåŠ¡æä¾›è€…æ²Ÿé€šæ›´æ–°åè®®å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":353004,"user_name":"é¡ºåŠ¿è€Œä¸º","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"é™•è¥¿","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1659074212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659074212","product_id":100079601,"comment_content":"å¯¹protocä¸ºä»€ä¹ˆç”Ÿæˆ.pb.goçš„å‡½æ•°ï¼Œä¸æ˜¯å¾ˆç†è§£ã€‚","like_count":0},{"had_liked":false,"id":353003,"user_name":"é¡ºåŠ¿è€Œä¸º","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"é™•è¥¿","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1659073806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659073806","product_id":100079601,"comment_content":"protoc --experimental_allow_proto3_optional --go_out=plugins=grpc:. user.proto<br><br>å½“ä½ çš„golangç‰ˆæœ¬æ˜¯1.8çš„ï¼Œè¿™ä¸ªå‘½ä»¤åº”è¯¥é‡‡ç”¨ä¸‹æ–¹çš„<br>protoc --experimental_allow_proto3_optional --go_out=plugins=grpc:$GOPATH&#47;src user.proto<br><br>æˆ–è€…é‡‡å– cd $GOPATH&#47;src ç„¶å æ‰§è¡Œgo use work .","like_count":0},{"had_liked":false,"id":351075,"user_name":"Jack","can_delete":false,"product_type":"c1","uid":1529319,"ip_address":"","ucode":"DB7A509E726220","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/e7/86ae89f0.jpg","comment_is_top":false,"comment_ctime":1657512873,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657512873","product_id":100079601,"comment_content":"ç›®å‰ä¸»è¦ç”¨çš„æ˜¯go-zeroè„šæ‰‹æ¶ï¼Œè¿˜ç®—æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„","like_count":0},{"had_liked":false,"id":349402,"user_name":"èƒ¡å°æ¶µ","can_delete":false,"product_type":"c1","uid":2004538,"ip_address":"","ucode":"2E750C65EC282C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/96/3a/e06f8367.jpg","comment_is_top":false,"comment_ctime":1655948722,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655948722","product_id":100079601,"comment_content":"è¯·é—®è€å¸ˆæ€ä¹ˆçœ‹å¾…tarsï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ç”¨tarsä¼šæ¯”ç”¨grpcå¥½ä¸€ç‚¹ï¼Ÿ","like_count":0},{"had_liked":false,"id":342728,"user_name":"Bradford","can_delete":false,"product_type":"c1","uid":2958009,"ip_address":"","ucode":"FE781D4874778E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJl2cs8X08aK8GiaUYcH0V2L7QJ14Y1YCfjT42Ta3CwnJEczVvwsAOA1InCNg5PqUuCCTEda287PYg/132","comment_is_top":false,"comment_ctime":1650436244,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650436244","product_id":100079601,"comment_content":"postmanç°åœ¨ä¹Ÿæ”¯æŒgrpcå•¦","like_count":0},{"had_liked":false,"id":332516,"user_name":"Struggle~honor","can_delete":false,"product_type":"c1","uid":1975831,"ip_address":"","ucode":"EBC6DFC6CF0973","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rSzzqGwHcvhwPejiaPsCY9XBX7ib7zTxJ6cUDORdhGIakX8dTPVsz6ibud5ec1FeWQGTseF2TPRECCjky5JMlHvDg/132","comment_is_top":false,"comment_ctime":1643287470,"is_pvip":false,"replies":[{"id":"121559","content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ã€‚æ˜¯æŒ‡å¦‚ä½•å»ºç«‹æŒ‡å®šURLçš„grpcå®¢æˆ·ç«¯å—ï¼Ÿ<br>conn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock()) <br>if err != nil { <br>  log.Fatalf(&quot;did not connect: %v&quot;, err) <br>} <br>defer conn.Close()<br><br>ä¸çŸ¥é“è¿™ä¸ªèƒ½ä¸èƒ½å›ç­”ä½ ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1643455301,"ip_address":"","comment_id":332516,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1643287470","product_id":100079601,"comment_content":"è€å¸ˆï¼Œçœ‹ä»£ç æ˜¯ä½¿ç”¨äº†grpcä¸­çš„invokeå‡½æ•°ï¼ŒæŒ‡å®šURLï¼Œè¯·é—®è¿™ä¸ªæ˜¯æ€æ ·ç”¨çš„å‘¢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548953,"discussion_content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ã€‚æ˜¯æŒ‡å¦‚ä½•å»ºç«‹æŒ‡å®šURLçš„grpcå®¢æˆ·ç«¯å—ï¼Ÿ\nconn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock()) \nif err != nil { \n  log.Fatalf(&#34;did not connect: %v&#34;, err) \n} \ndefer conn.Close()\n\nä¸çŸ¥é“è¿™ä¸ªèƒ½ä¸èƒ½å›ç­”ä½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643455301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328351,"user_name":"å·¦è€³æœµä¸œ","can_delete":false,"product_type":"c1","uid":1160678,"ip_address":"","ucode":"60134ACF12BB52","user_header":"https://static001.geekbang.org/account/avatar/00/11/b5/e6/c67f12bd.jpg","comment_is_top":false,"comment_ctime":1640681336,"is_pvip":false,"replies":[{"id":"119705","content":"protocç‰ˆæœ¬çš„é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1640825678,"ip_address":"","comment_id":328351,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640681336","product_id":100079601,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘æ‰§è¡Œè¿™ä¸ªå‘½ä»¤çš„æ—¶å€™ protoc --go_out=plugins=grpc:. helloworld.proto æŠ¥é”™ï¼š<br>--go_out: protoc-gen-go: plugins are not supported; use &#39;protoc --go-grpc_out=...&#39; to generate gRPC","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542649,"discussion_content":"protocç‰ˆæœ¬çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640825678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326023,"user_name":"åœ†æ»šæ»š","can_delete":false,"product_type":"c1","uid":1351012,"ip_address":"","ucode":"E4D81822A87D50","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/64/272dc1b7.jpg","comment_is_top":false,"comment_ctime":1639313066,"is_pvip":false,"replies":[{"id":"118331","content":"protoc-gen-goæ²¡æœ‰å®‰è£…ã€‚å¯ä»¥å‚è€ƒç¬¬ 02 è®²ä¸­ï¼šProtoBuf ç¼–è¯‘ç¯å¢ƒå®‰è£… éƒ¨åˆ† å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š<br><br>go get -u github.com&#47;golang&#47;protobuf&#47;protoc-gen-go","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1639398527,"ip_address":"","comment_id":326023,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1639313066","product_id":100079601,"comment_content":"protoc-gen-go: program not found or is not executable<br>Please specify a program using absolute path or make sure the program is available in your PATH system variable<br>--go_out: protoc-gen-go: Plugin failed with status code ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538320,"discussion_content":"protoc-gen-goæ²¡æœ‰å®‰è£…ã€‚å¯ä»¥å‚è€ƒç¬¬ 02 è®²ä¸­ï¼šProtoBuf ç¼–è¯‘ç¯å¢ƒå®‰è£… éƒ¨åˆ† å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š\n\ngo get -u github.com/golang/protobuf/protoc-gen-go","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639398527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351012,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/64/272dc1b7.jpg","nickname":"åœ†æ»šæ»š","note":"","ucode":"E4D81822A87D50","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538120,"discussion_content":"å·²è§£å†³ï¼šhttps://grpc.io/docs/languages/go/quickstart/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639325637,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325364,"user_name":"Struggle~honor","can_delete":false,"product_type":"c1","uid":1975831,"ip_address":"","ucode":"EBC6DFC6CF0973","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/rSzzqGwHcvhwPejiaPsCY9XBX7ib7zTxJ6cUDORdhGIakX8dTPVsz6ibud5ec1FeWQGTseF2TPRECCjky5JMlHvDg/132","comment_is_top":false,"comment_ctime":1638932098,"is_pvip":false,"replies":[{"id":"118475","content":"è¡¨ç¤ºå­—æ®µæ ‡å·ã€‚<br>åœ¨ProtoBufä¸­ï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–å·ã€‚è¿™äº›ç¼–å·ç”¨æ¥æ ‡è¯†æ¶ˆæ¯ä¸­çš„å­—æ®µï¼Œè¿™ä¸ªå¯ä»¥ç±»æ¯”ä¸€äº›é€šä¿¡åè®®ä¸­çš„ç¼–ç æ ¼å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1167883","ctime":1639454929,"ip_address":"","comment_id":325364,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638932098","product_id":100079601,"comment_content":"è€å¸ˆï¼Œè¯·é—®grpcæ•°æ®ç»“æ„ä¸­çš„ 1 2 3 4 è¿™äº›å®šä¹‰åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538614,"discussion_content":"è¡¨ç¤ºå­—æ®µæ ‡å·ã€‚\nåœ¨ProtoBufä¸­ï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–å·ã€‚è¿™äº›ç¼–å·ç”¨æ¥æ ‡è¯†æ¶ˆæ¯ä¸­çš„å­—æ®µï¼Œè¿™ä¸ªå¯ä»¥ç±»æ¯”ä¸€äº›é€šä¿¡åè®®ä¸­çš„ç¼–ç æ ¼å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639454929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323011,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1637690464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637690464","product_id":100079601,"comment_content":"æ€»ç»“ï¼š<br>    1. gRPC æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ RPC åè®®çš„ä¸€ç§ã€‚<br>    2. protobuf å’Œ Json çš„åŒºåˆ«ï¼Ÿéƒ½å¯ä»¥æ‰¿è½½æ¶ˆæ¯è¿›è¡Œä¼ é€’ï¼Œä½†æ˜¯gRPCä½¿ç”¨äºŒè¿›åˆ¶å¯¹æ¶ˆæ¯è¿›è¡Œç¼–ç ï¼›protobuf å¯ä»¥ç”¨æ¥æè¿°æ•°æ®ç»“æ„å’ŒæœåŠ¡ï¼Œé€šè¿‡ protoc ç”Ÿæˆæ•°æ®ç»“æ„ã€æœåŠ¡ç«¯æ¥å£ã€å®¢æˆ·ç«¯ä»£ç ã€‚<br>    3. åŸºäº HTTP 2 åè®®ï¼Œå¯ä»¥å®ç°å¤šç§é€šä¿¡æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":318675,"user_name":"yss","can_delete":false,"product_type":"c1","uid":1922488,"ip_address":"","ucode":"793E8448355F3F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkOj8VUxLjDKp6jRWJrABnnsg7U1sMSkM8FO6ULPwrqNpicZvTQ7kwctmu38iaJYHybXrmbusd8trg/132","comment_is_top":false,"comment_ctime":1635387271,"is_pvip":false,"replies":[{"id":"115968","content":"çœ‹ä¸‹ï¼Œgo buildçš„å‚æ•°GOOS=linux GOARCH=amd64ï¼Œèƒ½å¦æ»¡è¶³ä½ çš„éœ€æ±‚","user_name":"ä½œè€…å›å¤","user_name_real":"å­”ä»¤é£","uid":"1167883","ctime":1636004507,"ip_address":"","comment_id":318675,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635387271","product_id":100079601,"comment_content":"ä¸çŸ¥é“è€å¸ˆæœ‰æ²¡æœ‰è·¨è¯­è¨€ï¼Œè·¨å¤„ç†å™¨å¹³å°åš gRPC å¼€å‘çš„ç»éªŒã€‚<br><br>å¼€å‘æœºæ˜¯ windows + x86 <br>ç›®æ ‡æœºæ˜¯ Linux + arm<br><br>å¸Œæœ›å®ç° golang ä¸ QT çš„ gRPC é€šè®¯ã€‚å¹¶æƒ³åœ¨å¼€å‘æœºç›´æ¥æ„å»ºå®Œæˆååˆ°ç›®æ ‡æœºæ‰§è¡Œã€‚è¿™ä¸ªæ€è·¯å¯¹äº c++ ç¨‹åºæ˜¯ä¸æ˜¯ä¸å¯è¡Œï¼Œç¼–è¯‘è¿˜æ˜¯å¿…é¡»åœ¨å¯¹åº”çš„å¹³å°ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529340,"discussion_content":"çœ‹ä¸‹ï¼Œgo buildçš„å‚æ•°GOOS=linux GOARCH=amd64ï¼Œèƒ½å¦æ»¡è¶³ä½ çš„éœ€æ±‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636004507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922488,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkOj8VUxLjDKp6jRWJrABnnsg7U1sMSkM8FO6ULPwrqNpicZvTQ7kwctmu38iaJYHybXrmbusd8trg/132","nickname":"yss","note":"","ucode":"793E8448355F3F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":411783,"discussion_content":"è¿™ä¸ªåªæ˜¯golangçš„å¤„ç†ï¼Œç›®å‰c++çš„grpcæˆ‘è¿˜ä¸èƒ½å¾ˆå¥½çš„è‡ªå·±ç¼–è¯‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636005142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316779,"user_name":"é™å¿ƒ","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1634549213,"is_pvip":true,"replies":[{"id":"114915","content":"gRPCå§ï¼Œç”¨çš„æ¯”è¾ƒå¤šï¼Œæ¯”è¾ƒå¹¿","user_name":"ä½œè€…å›å¤","user_name_real":"å­”ä»¤é£","uid":"1167883","ctime":1634737058,"ip_address":"","comment_id":316779,"utype":1}],"discussion_count":1,"race_medal":5,"score":"1634549213","product_id":100079601,"comment_content":"ä»¥å‰ç”¨è¿‡Thriftï¼Œå½“æ—¶é€‰ç”¨å®ƒçš„åŸå› æ˜¯ä¸gRPCç›¸æ¯”æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€æ¯”è¾ƒå¤šã€‚ä¸çŸ¥é“ç°åœ¨ä¸¤è€…å“ªä¸ªæ›´å¼ºä¸€äº›ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528496,"discussion_content":"gRPCå§ï¼Œç”¨çš„æ¯”è¾ƒå¤šï¼Œæ¯”è¾ƒå¹¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634737058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316054,"user_name":"æˆäººä»¥ğŸŸï¼Œä¸å¦‚æˆäººä»¥æ¸”","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1634116779,"is_pvip":true,"replies":[{"id":"114948","content":"ä¸æ˜¯çš„å“ˆã€‚<br><br>JSONè¿™ç§æ ¼å¼åœ¨ä¼ è¾“çš„æ—¶å€™æ˜¯å­—ç¬¦ä¸²çš„æ ¼å¼ã€‚å ç”¨çš„å­—èŠ‚å¤šã€‚ä½†Protobufåœ¨ä¼ è¾“æ—¶ç›´æ¥æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œå ç”¨çš„å­—èŠ‚å°‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å­”ä»¤é£","uid":"1167883","ctime":1634743844,"ip_address":"","comment_id":316054,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1634116779","product_id":100079601,"comment_content":"å­”è€å¸ˆï¼Œè¯·é—®ï¼šã€Œåœ¨æè¿° Protocol Buffer æ—¶ï¼Œè°ˆåˆ°çš„ç¬¬ä¸€ä¸ªç‰¹å¾ç›¸å¯¹äº JSON&#47;XML â€œèŠ‚çœäº†å¤§é‡çš„ IO æ“ä½œâ€ï¼Œè¿™ä¸€ç‚¹ä¸ç†è§£ï¼ã€æˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼šJSON&#47;XMLï¼Œæˆ–è€…æ˜¯ Protobuf éƒ½æ˜¯éœ€è¦è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œä½†åè€…æ•°æ®é‡å°ã€‚æ­£å› ä¸ºæ•°æ®é‡å°ï¼Œå‡å°‘äº†åº•å±‚ç½‘ç»œæ•°æ®ä¼ è¾“çš„ IOã€‚æˆ‘å¯ä»¥è¿™æ ·ç†è§£å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528249,"discussion_content":"ä¸æ˜¯çš„å“ˆã€‚\n\nJSONè¿™ç§æ ¼å¼åœ¨ä¼ è¾“çš„æ—¶å€™æ˜¯å­—ç¬¦ä¸²çš„æ ¼å¼ã€‚å ç”¨çš„å­—èŠ‚å¤šã€‚ä½†Protobufåœ¨ä¼ è¾“æ—¶ç›´æ¥æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œå ç”¨çš„å­—èŠ‚å°‘ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1634743844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311158,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/b6/e2184e3c.jpg","nickname":"Vokey","note":"","ucode":"6F248223FF0885","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404032,"discussion_content":"è¿˜å‡å°‘äº†ä¸å¿…è¦çš„è¯·æ±‚å¤´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634212763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305733,"user_name":"wfatec","can_delete":false,"product_type":"c1","uid":1300686,"ip_address":"","ucode":"AB86F73A12E59C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoeNMibYsgHBsbhIwf9YR4Shy6psfqiblneVHA5CYrBRoqJwkw1ZUbVAPRGAfFfWjia7MZlDZzddeE2w/132","comment_is_top":false,"comment_ctime":1628136175,"is_pvip":false,"replies":[{"id":"110912","content":"protocå·¥å…·çš„ç‰¹æ€§ã€‚çœ‹ä¸‹option go_packageæ˜¯å¦æŒ‡å®šå¯¹äº†","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1628525905,"ip_address":"","comment_id":305733,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1628136175","product_id":100079601,"comment_content":"æˆ‘è¿™é‡Œé‡åˆ°ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨&#47;workspace&#47;greeter&#47;helloworld&#47;ä¸‹æ–°å»ºäº†ä¸€ä¸ªhelloworld.protoæ–‡ä»¶ï¼Œå¹¶cdåˆ°å½“å‰ç›®å½•æ‰§è¡Œï¼š<br>protoc --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>ä¹‹åï¼Œhelloworld.pb.go å¹¶ä¸ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆï¼ŒæŸ¥çœ‹:$GOPATH&#47;srcä¹‹åï¼Œå‘ç°å¤šäº†ä¸ª home æ–‡ä»¶å¤¹ï¼Œæœ€ç»ˆå‘ç°ï¼Œhelloworld.pb.go ç”Ÿæˆçš„ä½ç½®æ˜¯$GOPATH&#47;src&#47;home&#47;username&#47;workspace&#47;greeter&#47;helloworld&#47;helloworld.pb.goä¸‹ï¼Œè¯·é—®è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524496,"discussion_content":"protocå·¥å…·çš„ç‰¹æ€§ã€‚çœ‹ä¸‹option go_packageæ˜¯å¦æŒ‡å®šå¯¹äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628525905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2757858,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","nickname":"é¡ºåŠ¿è€Œä¸º","note":"","ucode":"FE7D688D24823E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581927,"discussion_content":"å› ä¸ºä½ æ˜¯1.8ç‰ˆæœ¬ï¼Œå…ˆcd $GOPATH/src , ç„¶åæ‰§è¡Œ go work use .","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659074074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304207,"user_name":"oneWalker","can_delete":false,"product_type":"c1","uid":1368775,"ip_address":"","ucode":"0FC573E3243760","user_header":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","comment_is_top":false,"comment_ctime":1627292706,"is_pvip":false,"replies":[{"id":"110222","content":"è…¾è®¯æ–‡æ¡£è¢«åˆ é™¤äº†","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1627597906,"ip_address":"","comment_id":304207,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627292706","product_id":100079601,"comment_content":"ä¸ºä½•æˆ‘ç”¨protocè‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶å’Œä½œè€…çš„å®Œå…¨ä¸ä¸€æ ·ï¼š<br>è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å¦‚é“¾æ¥ï¼šã€è…¾è®¯æ–‡æ¡£ã€‘13  API é£æ ¼ï¼ˆä¸‹ï¼‰RPC APIä»‹ç»-protobufè‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶<br>https:&#47;&#47;docs.qq.com&#47;doc&#47;DS3Nmc1dqRmFkSVZT<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523979,"discussion_content":"è…¾è®¯æ–‡æ¡£è¢«åˆ é™¤äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627597906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299283,"user_name":"StarÂ°æ—¶å…‰â„¡","can_delete":false,"product_type":"c1","uid":2670980,"ip_address":"","ucode":"DF9CCE8D715C0B","user_header":"https://static001.geekbang.org/account/avatar/00/28/c1/84/c4ddaddd.jpg","comment_is_top":false,"comment_ctime":1624543393,"is_pvip":false,"replies":[{"id":"108639","content":"è¾“å…¥ä¿¡æ¯æœ‰ç‚¹å°‘ï¼Œä¸æ¸…æ¥šä¸ºå•¥ä½ çš„å‘½ä»¤æ²¡æœ‰ç”Ÿæˆæ–‡ä»¶ï¼Œå¯èƒ½è·Ÿç¯å¢ƒæœ‰å…³ã€‚<br><br>ä¹Ÿå¯ä»¥è¯•è¯•è¿™ç¯‡æ•™ç¨‹ï¼šhttps:&#47;&#47;developers.google.com&#47;protocol-buffers&#47;docs&#47;gotutorialã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"CK1.0","uid":"1167883","ctime":1624709837,"ip_address":"","comment_id":299283,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1624543393","product_id":100079601,"comment_content":"protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>æ‰§è¡Œå‘½ä»¤åæ— ä»»ä½•è¾“å‡ºï¼Œä¹Ÿæ²¡æœ‰äº§ç”Ÿhelloworld.pb.goæ–‡ä»¶","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"å­”ä»¤é£","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522386,"discussion_content":"è¾“å…¥ä¿¡æ¯æœ‰ç‚¹å°‘ï¼Œä¸æ¸…æ¥šä¸ºå•¥ä½ çš„å‘½ä»¤æ²¡æœ‰ç”Ÿæˆæ–‡ä»¶ï¼Œå¯èƒ½è·Ÿç¯å¢ƒæœ‰å…³ã€‚\n\nä¹Ÿå¯ä»¥è¯•è¯•è¿™ç¯‡æ•™ç¨‹ï¼šhttps://developers.google.com/protocol-buffers/docs/gotutorialã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624709837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1368775,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","nickname":"oneWalker","note":"","ucode":"0FC573E3243760","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385837,"discussion_content":"å¦å¤–å»æ‰åŸæ¥æœ‰çš„ï¼š$GOPATH/srcï¼Œç›´æ¥protoc -I. --go_out=plugins=grpc helloworld.proto","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627294152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1368775,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","nickname":"oneWalker","note":"","ucode":"0FC573E3243760","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385822,"discussion_content":"æ˜¯ç”¨çš„macoså—ï¼Ÿmacosçš„è¯ï¼Œgo getä¼šé»˜è®¤å®‰è£…åˆ°gopathè€Œä¸æ˜¯gorootä¸­ï¼Œéœ€è¦å°†ç›®å½•protoc-gen-goå¤åˆ¶åˆ°gorootä¸‹ï¼Œå¦å¤–,åŸä»£ç ä¸­ä½¿ç”¨çš„optionè·¯å¾„éœ€è¦è°ƒæ•´ä¸ºå½“å‰é¡¹ç›®ç›®å½•çš„è·¯å¾„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627288017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299281,"user_name":"StarÂ°æ—¶å…‰â„¡","can_delete":false,"product_type":"c1","uid":2670980,"ip_address":"","ucode":"DF9CCE8D715C0B","user_header":"https://static001.geekbang.org/account/avatar/00/28/c1/84/c4ddaddd.jpg","comment_is_top":false,"comment_ctime":1624543327,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1624543327","product_id":100079601,"comment_content":"protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>```<br>[root@dev helloword]# ls<br>helloworld.proto<br>[root@dev helloword]# cat helloworld.proto <br>syntax = &quot;proto3&quot;;<br><br>option go_package = &quot;github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;helloworld&quot;;<br><br>package helloworld;<br><br>&#47;&#47; the greeting service definition<br>service Greeter {<br>    &#47;&#47; sends a greeting<br>    rpc SayHello (HelloRequest) returns (HelloReply) {}<br>}<br><br>&#47;&#47; the request message containing the user&#39;s name.<br>message HelloRequest {<br>    string name = 1;<br>}<br><br>&#47;&#47; the response message containing the greetings<br>message HelloReply {<br>    string message = 1;<br>}[root@dev helloword]# protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>[root@dev helloword]# ls<br>helloworld.proto<br>```","like_count":0,"discussions":[{"author":{"id":1657948,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/5c/9ea0f752.jpg","nickname":"ç¨‹åºçŒ¿ä¸åœ†","note":"","ucode":"BC8926A84A07C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581413,"discussion_content":"å¯ä»¥å»æ‰$GOPATH/srcï¼Œç›´æ¥protoc -I. --go_out=plugins=grpc:. helloworld.protoï¼Œå½“å‰ç›®å½•ä¸‹åº”è¯¥ä¼šæœ‰å˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658762856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1657948,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/5c/9ea0f752.jpg","nickname":"ç¨‹åºçŒ¿ä¸åœ†","note":"","ucode":"BC8926A84A07C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581411,"discussion_content":"åœ¨$GOPATH/src/github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworldæ‰¾æ‰¾çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658762487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299237,"user_name":"å¤å¤œæ˜Ÿè¯­","can_delete":false,"product_type":"c1","uid":1017644,"ip_address":"","ucode":"586BF3149A9D1D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/2c/013afd74.jpg","comment_is_top":false,"comment_ctime":1624523328,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624523328","product_id":100079601,"comment_content":"ä¹‹å‰è‡ªå·±è¿˜ç”¨jsonrpc å†™rpc, ç°åœ¨ç”¨è¿™ä¸ªæ„Ÿè§‰å®Œå…¨æ¥å£æ›´è§„èŒƒï¼Œæ›´ç®€å•","like_count":0}]}