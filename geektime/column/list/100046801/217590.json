{"id":217590,"title":"16 | ç”¨Redisæ„å»ºç¼“å­˜é›†ç¾¤çš„æœ€ä½³å®è·µæœ‰å“ªäº›ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æç¥ã€‚</p><p>ä¹‹å‰è¿ç»­å‡ èŠ‚è¯¾ï¼Œæˆ‘ä»¬éƒ½åœ¨ä»¥MySQLä¸ºä¾‹å­ï¼Œè®²å¦‚ä½•åº”å¯¹æµ·é‡æ•°æ®ï¼Œå¦‚ä½•åº”å¯¹é«˜å¹¶å‘ï¼Œå¦‚ä½•å®ç°é«˜å¯ç”¨ï¼Œæˆ‘å…ˆå¸¦ä½ ç®€å•å¤ä¹ ä¸€ä¸‹ã€‚</p><ul>\n<li>æ•°æ®é‡å¤ªå¤§æŸ¥è¯¢æ…¢æ€ä¹ˆåŠï¼Ÿå­˜æ¡£å†å²æ•°æ®æˆ–è€…åˆ†åº“åˆ†è¡¨ï¼Œè¿™æ˜¯æ•°æ®åˆ†ç‰‡ã€‚</li>\n<li>å¹¶å‘å¤ªé«˜æ‰›ä¸ä½æ€ä¹ˆåŠï¼Ÿè¯»å†™åˆ†ç¦»ï¼Œè¿™æ˜¯å¢åŠ å®ä¾‹æ•°ã€‚</li>\n<li>æ•°æ®åº“å®•æœºæ€ä¹ˆåŠï¼Ÿå¢åŠ ä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ç”¨ä»èŠ‚ç‚¹é¡¶ä¸Šï¼Œè¿™æ˜¯ä¸»ä»å¤åˆ¶ã€‚ä½†æ˜¯è¿™é‡Œé¢è¦ç‰¹åˆ«æ³¨æ„æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</li>\n</ul><p>æˆ‘åœ¨ä¹‹å‰è¯¾ç¨‹ä¸­ï¼Œä¹Ÿå¤šæ¬¡æåˆ°è¿‡ï¼Œ<strong>è¿™äº›æ–¹æ³•ä¸ä»…ä»…æ˜¯MySQLç‰¹æœ‰çš„ï¼Œå¯¹äºå‡ ä¹æ‰€æœ‰çš„å­˜å‚¨ç³»ç»Ÿï¼Œéƒ½æ˜¯é€‚ç”¨çš„ã€‚</strong></p><p>ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¥èŠä¸€èŠï¼Œå¦‚ä½•æ„å»ºä¸€ä¸ªç”Ÿäº§ç³»ç»Ÿå¯ç”¨çš„Redisç¼“å­˜é›†ç¾¤ã€‚ä½ å°†ä¼šçœ‹åˆ°ï¼Œå‡ ç§é›†ç¾¤è§£å†³æ–¹æ¡ˆç”¨åˆ°çš„æ€æƒ³ï¼ŒåŸºæœ¬å’Œæˆ‘ä»¬ä¸Šé¢è®²çš„éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><h2>Redis Clusterå¦‚ä½•è§£å†³æ•°æ®é‡å¤§ã€é«˜å¯ç”¨å’Œé«˜å¹¶å‘é—®é¢˜ï¼Ÿ</h2><p>Redisä»3.0ç‰ˆæœ¬å¼€å§‹ï¼Œæä¾›äº†å®˜æ–¹çš„é›†ç¾¤æ”¯æŒï¼Œä¹Ÿå°±æ˜¯Redis Cluserã€‚<strong>Redis Clusterç›¸æ¯”äºå•ä¸ªèŠ‚ç‚¹çš„Redisï¼Œèƒ½ä¿å­˜æ›´å¤šçš„æ•°æ®ï¼Œæ”¯æŒæ›´å¤šçš„å¹¶å‘ï¼Œå¹¶ä¸”å¯ä»¥åšåˆ°é«˜å¯ç”¨ï¼Œåœ¨å•ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚</strong></p><p>ä¸ºäº†èƒ½å¤Ÿä¿å­˜æ›´å¤šçš„æ•°æ®ï¼Œå’ŒMySQLåˆ†åº“åˆ†è¡¨çš„æ–¹å¼ç±»ä¼¼ï¼ŒRedis Clusterä¹Ÿæ˜¯é€šè¿‡åˆ†ç‰‡çš„æ–¹å¼ï¼ŒæŠŠæ•°æ®åˆ†å¸ƒåˆ°é›†ç¾¤çš„å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚</p><!-- [[[read_end]]] --><p>Redis Clusteræ˜¯å¦‚ä½•æ¥åˆ†ç‰‡çš„å‘¢ï¼Ÿå®ƒå¼•å…¥äº†ä¸€ä¸ªâ€œæ§½ï¼ˆSlotï¼‰â€çš„æ¦‚å¿µï¼Œè¿™ä¸ªæ§½å°±æ˜¯å“ˆå¸Œè¡¨ä¸­çš„å“ˆå¸Œæ§½ï¼Œæ§½æ˜¯Redisåˆ†ç‰‡çš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªæ§½é‡Œé¢åŒ…å«ä¸€äº›Keyã€‚æ¯ä¸ªé›†ç¾¤çš„æ§½æ•°æ˜¯å›ºå®šçš„16384ï¼ˆ16 * 1024ï¼‰ä¸ªï¼Œæ¯ä¸ªKeyè½åœ¨å“ªä¸ªæ§½ä¸­ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œè®¡ç®—æ–¹æ³•æ˜¯ï¼š</p><pre><code>HASH_SLOT = CRC16(key) mod 16384\n</code></pre><p>è¿™ä¸ªç®—æ³•å¾ˆç®€å•ï¼Œå…ˆè®¡ç®—Keyçš„CRCå€¼ï¼Œç„¶åæŠŠè¿™ä¸ªCRCä¹‹åçš„Keyå€¼ç›´æ¥é™¤ä»¥16384ï¼Œä½™æ•°å°±æ˜¯Keyæ‰€åœ¨çš„æ§½ã€‚è¿™ä¸ªç®—æ³•å°±æ˜¯æˆ‘ä»¬ä¸ŠèŠ‚è¯¾è®²è¿‡çš„å“ˆå¸Œåˆ†ç‰‡ç®—æ³•ã€‚</p><p>è¿™äº›æ§½åˆæ˜¯å¦‚ä½•å­˜æ”¾åˆ°å…·ä½“çš„RedisèŠ‚ç‚¹ä¸Šçš„å‘¢ï¼Ÿè¿™ä¸ªæ˜ å°„å…³ç³»ä¿å­˜åœ¨é›†ç¾¤çš„æ¯ä¸ªRedisèŠ‚ç‚¹ä¸Šï¼Œé›†ç¾¤åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒRedisä¼šè‡ªåŠ¨å¹³å‡åˆ†é…è¿™16384ä¸ªæ§½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤æ¥è°ƒæ•´ã€‚è¿™ä¸ªåˆ†æ§½çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸ŠèŠ‚è¯¾è®²åˆ°è¿‡çš„åˆ†ç‰‡ç®—æ³•ï¼šæŸ¥è¡¨æ³•ã€‚</p><p>å®¢æˆ·ç«¯å¯ä»¥è¿æ¥é›†ç¾¤çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æ¥è®¿é—®é›†ç¾¤çš„æ•°æ®ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªKeyçš„æ—¶å€™ï¼Œè¢«è¯·æ±‚çš„é‚£ä¸ªRediså®ä¾‹å…ˆé€šè¿‡ä¸Šé¢çš„å…¬å¼ï¼Œè®¡ç®—å‡ºè¿™ä¸ªKeyåœ¨å“ªä¸ªæ§½ä¸­ï¼Œç„¶åå†æŸ¥è¯¢æ§½å’ŒèŠ‚ç‚¹çš„æ˜ å°„å…³ç³»ï¼Œæ‰¾åˆ°æ•°æ®æ‰€åœ¨çš„çœŸæ­£èŠ‚ç‚¹ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ­£å¥½æ˜¯è‡ªå·±ï¼Œé‚£å°±ç›´æ¥æ‰§è¡Œå‘½ä»¤è¿”å›ç»“æœã€‚å¦‚æœæ•°æ®ä¸åœ¨å½“å‰è¿™ä¸ªèŠ‚ç‚¹ä¸Šï¼Œé‚£å°±ç»™å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ªé‡å®šå‘çš„å‘½ä»¤ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œåº”è¯¥å»è¿å“ªä¸ªèŠ‚ç‚¹ä¸Šè¯·æ±‚è¿™ä¸ªKeyçš„æ•°æ®ã€‚ç„¶åå®¢æˆ·ç«¯ä¼šå†è¿æ¥æ­£ç¡®çš„èŠ‚ç‚¹æ¥è®¿é—®ã€‚</p><p>è§£å†³åˆ†ç‰‡é—®é¢˜ä¹‹åï¼ŒRedis Clusterå°±å¯ä»¥é€šè¿‡æ°´å¹³æ‰©å®¹æ¥å¢åŠ é›†ç¾¤çš„å­˜å‚¨å®¹é‡ï¼Œä½†æ˜¯ï¼Œæ¯æ¬¡å¾€é›†ç¾¤å¢åŠ èŠ‚ç‚¹çš„æ—¶å€™ï¼Œéœ€è¦ä»é›†ç¾¤çš„é‚£äº›è€èŠ‚ç‚¹ä¸­ï¼Œæ¬è¿ä¸€äº›æ§½åˆ°æ–°èŠ‚ç‚¹ï¼Œä½ å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå“ªäº›æ§½è¿ç§»åˆ°æ–°èŠ‚ç‚¹ä¸Šï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å®˜æ–¹æä¾›çš„<a href=\"http://download.redis.io/redis-stable/src/redis-trib.rb\">redis-trib.rb</a>è„šæœ¬æ¥è‡ªåŠ¨é‡æ–°åˆ†é…æ§½ï¼Œè‡ªåŠ¨è¿ç§»ã€‚</p><p>åˆ†ç‰‡å¯ä»¥è§£å†³Redisä¿å­˜æµ·é‡æ•°æ®çš„é—®é¢˜ï¼Œå¹¶ä¸”å®¢è§‚ä¸Šæå‡äº†Redisçš„å¹¶å‘èƒ½åŠ›å’ŒæŸ¥è¯¢æ€§èƒ½ã€‚ä½†æ˜¯å¹¶ä¸èƒ½è§£å†³é«˜å¯ç”¨çš„é—®é¢˜ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜äº†æ•´ä¸ªé›†ç¾¤æ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œéƒ½ä¼šå¯¼è‡´è¿™ä¸ªå®•æœºèŠ‚ç‚¹ä¸Šçš„é‚£éƒ¨åˆ†æ•°æ®æ— æ³•è®¿é—®ã€‚</p><p>é‚£Redis Clusteræ˜¯æ€ä¹ˆè§£å†³é«˜å¯ç”¨é—®é¢˜çš„ï¼Ÿ</p><p>å‚è§ä¸Šé¢æˆ‘ä»¬è®²åˆ°çš„æ–¹æ³•ï¼š<strong>å¢åŠ ä»èŠ‚ç‚¹ï¼Œåšä¸»ä»å¤åˆ¶</strong>ã€‚Redis Clusteræ”¯æŒç»™æ¯ä¸ªåˆ†ç‰‡å¢åŠ ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œæ¯ä¸ªä»èŠ‚ç‚¹åœ¨è¿æ¥åˆ°ä¸»èŠ‚ç‚¹ä¸Šä¹‹åï¼Œä¼šå…ˆç»™ä¸»èŠ‚ç‚¹å‘é€ä¸€ä¸ªSYNCå‘½ä»¤ï¼Œè¯·æ±‚ä¸€æ¬¡å…¨é‡å¤åˆ¶ï¼Œä¹Ÿå°±æ˜¯æŠŠä¸»èŠ‚ç‚¹ä¸Šå…¨éƒ¨çš„æ•°æ®éƒ½å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ä¸Šã€‚å…¨é‡å¤åˆ¶å®Œæˆä¹‹åï¼Œè¿›å…¥åŒæ­¥é˜¶æ®µï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠåˆšåˆšå…¨é‡å¤åˆ¶æœŸé—´æ”¶åˆ°çš„å‘½ä»¤ï¼Œä»¥åŠåç»­æ”¶åˆ°çš„å‘½ä»¤æŒç»­åœ°è½¬å‘ç»™ä»èŠ‚ç‚¹ã€‚</p><p>å› ä¸ºRedisä¸æ”¯æŒäº‹åŠ¡ï¼Œæ‰€ä»¥å®ƒçš„å¤åˆ¶ç›¸æ¯”MySQLæ›´ç®€å•ï¼Œè¿Binlogéƒ½çœäº†ï¼Œç›´æ¥å°±æ˜¯è½¬å‘å®¢æˆ·ç«¯å‘æ¥çš„æ›´æ–°æ•°æ®å‘½ä»¤æ¥å®ç°ä¸»ä»åŒæ­¥ã€‚å¦‚æœæŸä¸ªåˆ†ç‰‡çš„ä¸»èŠ‚ç‚¹å®•æœºäº†ï¼Œé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ä¼šåœ¨è¿™ä¸ªåˆ†ç‰‡çš„ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ç»§ç»­æä¾›æœåŠ¡ã€‚æ–°çš„ä¸»èŠ‚ç‚¹é€‰ä¸¾å‡ºæ¥åï¼Œé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ„ŸçŸ¥åˆ°ï¼Œè¿™æ ·ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚Keyè½åœ¨æ•…éšœåˆ†ç‰‡ä¸Šï¼Œå°±ä¼šè¢«é‡å®šå‘åˆ°æ–°çš„ä¸»èŠ‚ç‚¹ä¸Šã€‚</p><p>æœ€åæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼ŒRedis Clusteræ˜¯å¦‚ä½•åº”å¯¹é«˜å¹¶å‘çš„ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼ŒRedis Clusterè¿›è¡Œäº†åˆ†ç‰‡ä¹‹åï¼Œæ¯ä¸ªåˆ†ç‰‡éƒ½ä¼šæ‰¿æ¥ä¸€éƒ¨åˆ†å¹¶å‘çš„è¯·æ±‚ï¼ŒåŠ ä¸ŠRedisæœ¬èº«å•èŠ‚ç‚¹çš„æ€§èƒ½å°±éå¸¸é«˜ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸éœ€è¦å†åƒMySQLé‚£æ ·åšè¯»å†™åˆ†ç¦»æ¥è§£å†³é«˜å¹¶å‘çš„é—®é¢˜ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé›†ç¾¤çš„è¯»å†™è¯·æ±‚éƒ½æ˜¯ç”±ä¸»èŠ‚ç‚¹è´Ÿè´£çš„ï¼Œä»èŠ‚ç‚¹åªæ˜¯èµ·ä¸€ä¸ªçƒ­å¤‡çš„ä½œç”¨ã€‚å½“ç„¶äº†ï¼ŒRedis Clusterä¹Ÿæ”¯æŒè¯»å†™åˆ†ç¦»ï¼Œåœ¨ä»èŠ‚ç‚¹ä¸Šè¯»å–æ•°æ®ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯Redis Clusterçš„åŸºæœ¬åŸç†ï¼Œä½ å¯ä»¥å¯¹ç…§ä¸‹å›¾æ¥åŠ æ·±ç†è§£ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c4/fd/c405e73a4fd797ca0cda82b383e46ffd.png?wh=778*555\" alt=\"\"></p><center>ï¼ˆå›¾ç‰‡æ¥æºï¼š<a href=\"https://rancher.com/blog/2019/deploying-redis-cluster/\">ç½‘ç»œ</a>ï¼‰</center><p>ä½ å¯ä»¥çœ‹åˆ°ï¼ŒRedis Clusteræ•´ä½“çš„æ¶æ„å®Œå…¨å°±æ˜¯ç…§æŠ„MySQLæ„å»ºé›†ç¾¤çš„é‚£ä¸€å¥—ä¸œè¥¿ï¼ˆå½“ç„¶ï¼Œè¿™äº›è®¾è®¡å’Œæ–¹æ³•ä¹Ÿä¸æ˜¯MySQLå‘æ˜çš„ï¼‰ï¼ŒæŠ„ä½œä¸šæŠ„çš„å°±å·®æŠŠåå­—ä¸€èµ·ä¹ŸæŠ„ä¸Šäº†ã€‚</p><p>å…·ä½“å¦‚ä½•æ­å»ºRedis Clusterä»¥åŠç›¸å…³çš„æ“ä½œå‘½ä»¤ä½ å¯ä»¥çœ‹ä¸€ä¸‹<a href=\"https://redis.io/topics/cluster-tutorial\">Rediså®˜æ–¹çš„è¿™ç¯‡æ•™ç¨‹</a>ã€‚</p><h2>ä¸ºä»€ä¹ˆRedis Clusterä¸é€‚åˆè¶…å¤§è§„æ¨¡é›†ç¾¤ï¼Ÿ</h2><p>Redis Clusterçš„ä¼˜ç‚¹æ˜¯æ˜“äºä½¿ç”¨ã€‚åˆ†ç‰‡ã€ä¸»ä»å¤åˆ¶ã€å¼¹æ€§æ‰©å®¹è¿™äº›åŠŸèƒ½éƒ½å¯ä»¥åšåˆ°è‡ªåŠ¨åŒ–ï¼Œé€šè¿‡ç®€å•çš„éƒ¨ç½²å°±å¯ä»¥è·å¾—ä¸€ä¸ªå¤§å®¹é‡ã€é«˜å¯é ã€é«˜å¯ç”¨çš„Redisé›†ç¾¤ï¼Œå¹¶ä¸”å¯¹äºåº”ç”¨æ¥è¯´ï¼Œè¿‘ä¹äºæ˜¯é€æ˜çš„ã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>Redis Clusteræ˜¯éå¸¸é€‚åˆæ„å»ºä¸­å°è§„æ¨¡Redisé›†ç¾¤</strong>ï¼Œè¿™é‡Œçš„ä¸­å°è§„æ¨¡æŒ‡çš„æ˜¯ï¼Œå¤§æ¦‚å‡ ä¸ªåˆ°å‡ åä¸ªèŠ‚ç‚¹è¿™æ ·è§„æ¨¡çš„Redisé›†ç¾¤ã€‚</p><p><strong>ä½†æ˜¯Redis Clusterä¸å¤ªé€‚åˆæ„å»ºè¶…å¤§è§„æ¨¡é›†ç¾¤ï¼Œä¸»è¦åŸå› æ˜¯ï¼Œå®ƒé‡‡ç”¨äº†å»ä¸­å¿ƒåŒ–çš„è®¾è®¡ã€‚</strong>åˆšåˆšæˆ‘ä»¬è®²äº†ï¼ŒRedisçš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œéƒ½ä¿å­˜äº†æ‰€æœ‰æ§½å’ŒèŠ‚ç‚¹çš„æ˜ å°„å…³ç³»è¡¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥è®¿é—®ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå†é€šè¿‡é‡å®šå‘å‘½ä»¤ï¼Œæ‰¾åˆ°æ•°æ®æ‰€åœ¨çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚é‚£ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªæ˜ å°„å…³ç³»è¡¨ï¼Œå®ƒæ˜¯å¦‚ä½•æ›´æ–°çš„å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œé›†ç¾¤åŠ å…¥äº†æ–°èŠ‚ç‚¹ï¼Œæˆ–è€…æŸä¸ªä¸»èŠ‚ç‚¹å®•æœºäº†ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹è¢«é€‰ä¸¾å‡ºæ¥ï¼Œè¿™äº›æƒ…å†µä¸‹ï¼Œéƒ½éœ€è¦æ›´æ–°é›†ç¾¤æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„æ˜ å°„å…³ç³»è¡¨ã€‚</p><p>Redis Clusteré‡‡ç”¨äº†ä¸€ç§å»ä¸­å¿ƒåŒ–çš„<a href=\"https://en.wikipedia.org/wiki/Gossip_protocol\">æµè¨€(Gossip)åè®®</a>æ¥ä¼ æ’­é›†ç¾¤é…ç½®çš„å˜åŒ–ã€‚ä¸€èˆ¬æ¶‰åŠåˆ°åè®®éƒ½æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å»æ·±ç©¶å…·ä½“åè®®å’Œå®ç°ç®—æ³•ï¼Œæˆ‘å¤§æ¦‚ç»™ä½ è®²ä¸€ä¸‹è¿™ä¸ªåè®®åŸç†ã€‚</p><p>æ‰€è°“æµè¨€ï¼Œå°±æ˜¯å…«å¦ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬ä¸Šå­¦çš„æ—¶å€™ï¼Œç­ä¸Šè°å’Œè°å·å·å¥½ä¸Šäº†ï¼Œæå¯¹è±¡ï¼Œé‚£ç”¨ä¸äº†ä¸€å¤©ï¼Œå…¨ç­åŒå­¦éƒ½çŸ¥é“äº†ã€‚å’‹çŸ¥é“çš„ï¼Ÿå¼ ä¸‰çœ‹è§äº†ï¼Œå‘Šè¯‰æå››ï¼Œæå››å’Œç‹å°äºŒç‰¹åˆ«å¥½ï¼Œåˆå‘Šè¯‰äº†ç‹å°äºŒï¼Œè¿™æ ·äººä¼ äººï¼Œä¸ä¹…å°±ä¼ éå…¨ç­äº†ã€‚è¿™ä¸ªå°±æ˜¯å…«å¦åè®®çš„ä¼ æ’­åŸç†ã€‚</p><p>è¿™ä¸ªå…«å¦åè®®å®ƒçš„å¥½å¤„æ˜¯å»ä¸­å¿ƒåŒ–ï¼Œä¼ å…«å¦ä¸éœ€è¦ç»„ç»‡ï¼Œåƒç“œç¾¤ä¼—è‡ªå‘å°±ä¼ å¼€äº†ã€‚è¿™æ ·éƒ¨ç½²å’Œç»´æŠ¤å°±æ›´ç®€å•ï¼Œä¹Ÿèƒ½é¿å…ä¸­å¿ƒèŠ‚ç‚¹çš„å•ç‚¹æ•…éšœã€‚å…«å¦åè®®çš„ç¼ºç‚¹å°±æ˜¯ä¼ æ’­é€Ÿåº¦æ…¢ï¼Œå¹¶ä¸”æ˜¯é›†ç¾¤è§„æ¨¡è¶Šå¤§ï¼Œä¼ æ’­çš„è¶Šæ…¢ã€‚è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚è¯´ï¼Œæ¢æˆæŸä¸¤ä¸ªç‰¹åˆ«å‡ºåçš„æ˜æ˜Ÿæå¯¹è±¡ï¼Œå³ä½¿æ˜¯å…¨å›½äººæ°‘éƒ½å¾ˆå…«å¦ï¼Œä½†è¦æƒ³è®©å…¨å›½æ¯ä¸€ä¸ªäººéƒ½çŸ¥é“è¿™ä¸ªæ¶ˆæ¯ï¼Œè¿˜æ˜¯éœ€è¦å¾ˆé•¿çš„æ—¶é—´ã€‚åœ¨é›†ç¾¤è§„æ¨¡å¤ªå¤§çš„æƒ…å†µä¸‹ï¼Œæ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ä¼šè¢«æ˜æ˜¾æ”¾å¤§ï¼Œè¿˜æœ‰ä¸€å®šçš„ä¸ç¡®å®šæ€§ï¼Œå¦‚æœå‡ºç°é—®é¢˜å¾ˆéš¾æ’æŸ¥ã€‚</p><h2>å¦‚ä½•ç”¨Redisæ„å»ºè¶…å¤§è§„æ¨¡é›†ç¾¤ï¼Ÿ</h2><p>Redis Clusterä¸å¤ªé€‚åˆç”¨äºå¤§è§„æ¨¡é›†ç¾¤ï¼Œæ‰€ä»¥å¾ˆå¤šå¤§å‚ï¼Œéƒ½é€‰æ‹©è‡ªå·±å»æ­å»ºRedisé›†ç¾¤ã€‚è¿™é‡Œé¢ï¼Œæ¯ä¸€å®¶çš„è§£å†³æ–¹æ¡ˆéƒ½æœ‰è‡ªå·±çš„ç‰¹è‰²ï¼Œä½†å…¶å®æ€»ä½“çš„æ¶æ„éƒ½æ˜¯å¤§åŒå°å¼‚çš„ã€‚</p><p>ä¸€ç§æ˜¯åŸºäºä»£ç†çš„æ–¹å¼ï¼Œåœ¨å®¢æˆ·ç«¯å’ŒRedisèŠ‚ç‚¹ä¹‹é—´ï¼Œè¿˜éœ€è¦å¢åŠ ä¸€å±‚ä»£ç†æœåŠ¡ã€‚è¿™ä¸ªä»£ç†æœåŠ¡æœ‰ä¸‰ä¸ªä½œç”¨ã€‚</p><p>ç¬¬ä¸€ä¸ªä½œç”¨æ˜¯ï¼Œè´Ÿè´£åœ¨å®¢æˆ·ç«¯å’ŒRedisèŠ‚ç‚¹ä¹‹é—´è½¬å‘è¯·æ±‚å’Œå“åº”ã€‚å®¢æˆ·ç«¯åªå’Œä»£ç†æœåŠ¡æ‰“äº¤é“ï¼Œä»£ç†æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ä¹‹åï¼Œå†è½¬å‘åˆ°å¯¹åº”çš„RedisèŠ‚ç‚¹ä¸Šï¼ŒèŠ‚ç‚¹è¿”å›çš„å“åº”å†ç»ç”±ä»£ç†è½¬å‘è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>ç¬¬äºŒä¸ªä½œç”¨æ˜¯ï¼Œè´Ÿè´£ç›‘æ§é›†ç¾¤ä¸­æ‰€æœ‰RedisèŠ‚ç‚¹çŠ¶æ€ï¼Œå¦‚æœå‘ç°æœ‰é—®é¢˜èŠ‚ç‚¹ï¼ŒåŠæ—¶è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚</p><p>ç¬¬ä¸‰ä¸ªä½œç”¨å°±æ˜¯ç»´æŠ¤é›†ç¾¤çš„å…ƒæ•°æ®ï¼Œè¿™ä¸ªå…ƒæ•°æ®ä¸»è¦å°±æ˜¯é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹çš„ä¸»ä»ä¿¡æ¯ï¼Œä»¥åŠæ§½å’ŒèŠ‚ç‚¹å…³ç³»æ˜ å°„è¡¨ã€‚è¿™ä¸ªæ¶æ„å’Œæˆ‘åœ¨ã€Š<a href=\"https://time.geekbang.org/column/article/215330\">12 | MySQLå¦‚ä½•åº”å¯¹é«˜å¹¶å‘ï¼ˆäºŒï¼‰ï¼šè¯»å†™åˆ†ç¦»</a>ã€‹è¿™èŠ‚è¯¾ä¸­ç»™ä½ è®²è¿‡çš„ï¼Œç”¨HAProxy+Keepalivedæ¥ä»£ç†MySQLè¯·æ±‚çš„æ¶æ„æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªè‡ªåŠ¨è·¯ç”±åˆ†ç‰‡çš„åŠŸèƒ½è€Œå·²ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/03/d6/03c2901db83c02cbfe90a8c9b78d04d6.jpg?wh=1142*513\" alt=\"\"></p><p>åƒå¼€æºçš„Redisé›†ç¾¤æ–¹æ¡ˆ<a href=\"https://github.com/twitter/twemproxy\">twemproxy</a>å’Œ<a href=\"https://github.com/CodisLabs/codis\">Codis</a>ï¼Œéƒ½æ˜¯è¿™ç§æ¶æ„çš„ã€‚</p><p>è¿™ä¸ªæ¶æ„æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯¹å®¢æˆ·ç«¯é€æ˜ï¼Œåœ¨å®¢æˆ·ç«¯è§†è§’æ¥çœ‹ï¼Œæ•´ä¸ªé›†ç¾¤å’Œä¸€ä¸ªè¶…å¤§å®¹é‡çš„å•èŠ‚ç‚¹Redisæ˜¯ä¸€æ ·çš„ã€‚å¹¶ä¸”ï¼Œç”±äºåˆ†ç‰‡ç®—æ³•æ˜¯ä»£ç†æœåŠ¡æ§åˆ¶çš„ï¼Œæ‰©å®¹ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œæ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤åï¼Œç›´æ¥ä¿®æ”¹ä»£ç†æœåŠ¡ä¸­çš„å…ƒæ•°æ®å°±å¯ä»¥å®Œæˆæ‰©å®¹ã€‚</p><p>ä¸è¿‡ï¼Œè¿™ä¸ªæ¶æ„çš„ç¼ºç‚¹ä¹Ÿå¾ˆçªå‡ºï¼Œå¢åŠ äº†ä¸€å±‚ä»£ç†è½¬å‘ï¼Œæ¯æ¬¡æ•°æ®è®¿é—®çš„é“¾è·¯æ›´é•¿äº†ï¼Œå¿…ç„¶ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½æŸå¤±ã€‚è€Œä¸”ï¼Œä»£ç†æœåŠ¡æœ¬èº«åˆæ˜¯é›†ç¾¤çš„ä¸€ä¸ªå•ç‚¹ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç†æœåŠ¡ä¹Ÿåšæˆä¸€ä¸ªé›†ç¾¤æ¥è§£å†³å•ç‚¹é—®é¢˜ï¼Œé‚£æ ·é›†ç¾¤å°±æ›´å¤æ‚äº†ã€‚</p><p>å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ï¼Œä¸ç”¨è¿™ä¸ªä»£ç†æœåŠ¡ï¼ŒæŠŠä»£ç†æœåŠ¡çš„å¯»å€åŠŸèƒ½å‰ç§»åˆ°å®¢æˆ·ç«¯ä¸­å»ã€‚å®¢æˆ·ç«¯åœ¨å‘èµ·è¯·æ±‚ä¹‹å‰ï¼Œå…ˆå»æŸ¥è¯¢å…ƒæ•°æ®ï¼Œå°±å¯ä»¥çŸ¥é“è¦è®¿é—®çš„æ˜¯å“ªä¸ªåˆ†ç‰‡å’Œå“ªä¸ªèŠ‚ç‚¹ï¼Œç„¶åç›´è¿å¯¹åº”çš„RedisèŠ‚ç‚¹è®¿é—®æ•°æ®ã€‚</p><p>å½“ç„¶ï¼Œå®¢æˆ·ç«¯ä¸ç”¨æ¯æ¬¡éƒ½å»æŸ¥è¯¢å…ƒæ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªå…ƒæ•°æ®æ˜¯ä¸æ€ä¹ˆå˜åŒ–çš„ï¼Œå®¢æˆ·ç«¯å¯ä»¥è‡ªå·±ç¼“å­˜å…ƒæ•°æ®ï¼Œè¿™æ ·è®¿é—®æ€§èƒ½åŸºæœ¬ä¸Šå’Œå•æœºç‰ˆçš„Redisæ˜¯ä¸€æ ·çš„ã€‚å¦‚æœæŸä¸ªåˆ†ç‰‡çš„ä¸»èŠ‚ç‚¹å®•æœºäº†ï¼Œæ–°çš„ä¸»èŠ‚ç‚¹è¢«é€‰ä¸¾å‡ºæ¥ä¹‹åï¼Œæ›´æ–°å…ƒæ•°æ®é‡Œé¢çš„ä¿¡æ¯ã€‚å¯¹é›†ç¾¤çš„æ‰©å®¹æ“ä½œä¹Ÿæ¯”è¾ƒç®€å•ï¼Œé™¤äº†è¿ç§»æ•°æ®çš„å·¥ä½œå¿…é¡»è¦åšä»¥å¤–ï¼Œæ›´æ–°ä¸€ä¸‹å…ƒæ•°æ®å°±å¯ä»¥äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/dc/da/dcaced0a9ce9842ef688c9626accdcda.jpg?wh=1142*605\" alt=\"\"></p><p>è™½ç„¶è¯´ï¼Œè¿™ä¸ªå…ƒæ•°æ®æœåŠ¡ä»ç„¶æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œä½†æ˜¯å®ƒçš„æ•°æ®é‡ä¸å¤§ï¼Œè®¿é—®é‡ä¹Ÿä¸å¤§ï¼Œç›¸å¯¹å°±æ¯”è¾ƒå®¹æ˜“å®ç°ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ZooKeeperã€etcdç”šè‡³MySQLéƒ½èƒ½æ»¡è¶³è¦æ±‚ã€‚è¿™ä¸ªæ–¹æ¡ˆåº”è¯¥æ˜¯æœ€é€‚åˆè¶…å¤§è§„æ¨¡Redisé›†ç¾¤çš„æ–¹æ¡ˆäº†ï¼Œåœ¨æ€§èƒ½ã€å¼¹æ€§ã€é«˜å¯ç”¨å‡ æ–¹é¢è¡¨ç°éƒ½éå¸¸å¥½ï¼Œç¼ºç‚¹æ˜¯æ•´ä¸ªæ¶æ„æ¯”è¾ƒå¤æ‚ï¼Œå®¢æˆ·ç«¯ä¸èƒ½é€šç”¨ï¼Œéœ€è¦å¼€å‘å®šåˆ¶åŒ–çš„Rediså®¢æˆ·ç«¯ï¼Œåªæœ‰è§„æ¨¡è¶³å¤Ÿå¤§çš„ä¼ä¸šæ‰è´Ÿæ‹…å¾—èµ·ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©è¿™èŠ‚è¯¾æˆ‘ä»¬è®²äº†ä»å°åˆ°å¤§ä¸‰ç§æ„å»ºRedisé›†ç¾¤çš„æ–¹å¼ã€‚</p><ul>\n<li>å°è§„æ¨¡çš„é›†ç¾¤å»ºè®®ä½¿ç”¨å®˜æ–¹çš„Redis Clusterï¼Œåœ¨èŠ‚ç‚¹æ•°é‡ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œå„æ–¹é¢è¡¨ç°éƒ½ä¸é”™ã€‚</li>\n<li>å†å¤§ä¸€äº›è§„æ¨¡çš„é›†ç¾¤ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨twemproxyæˆ–è€…Codisè¿™ç±»çš„åŸºäºä»£ç†çš„é›†ç¾¤æ¶æ„ï¼Œè™½ç„¶æ˜¯å¼€æºæ–¹æ¡ˆï¼Œä½†æ˜¯å·²ç»è¢«å¾ˆå¤šå…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯è¿‡ã€‚</li>\n<li>ç›¸æ¯”äºä»£ç†æ–¹æ¡ˆï¼Œä½¿ç”¨å®šåˆ¶å®¢æˆ·ç«¯çš„æ–¹æ¡ˆæ€§èƒ½æ›´å¥½ï¼Œå¾ˆå¤šå¤§å‚é‡‡ç”¨çš„éƒ½æ˜¯ç±»ä¼¼çš„æ¶æ„ã€‚</li>\n</ul><p>è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™å‡ ç§é›†ç¾¤æ–¹æ¡ˆå¯¹ä¸€äº›ç±»ä¼¼äºâ€œKEYSâ€è¿™ç±»çš„å¤šKEYå‘½ä»¤ï¼Œéƒ½æ²¡æ³•åšåˆ°ç™¾åˆ†ç™¾æ”¯æŒã€‚åŸå› å¾ˆç®€å•ï¼Œæ•°æ®è¢«åˆ†ç‰‡äº†ä¹‹åï¼Œè¿™ç§å¤šKEYçš„å‘½ä»¤å¾ˆå¯èƒ½éœ€è¦è·¨å¤šä¸ªåˆ†ç‰‡æŸ¥è¯¢ã€‚å½“ä½ çš„ç³»ç»Ÿä»å•ä¸ªRedisåº“å‡çº§åˆ°é›†ç¾¤æ—¶ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘ä¸€ä¸‹è¿™æ–¹é¢çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¾ˆå¤šå­˜å‚¨ç³»ç»Ÿä¹‹é—´éƒ½å­˜åœ¨â€œäº’ç›¸æŠ„ä½œä¸šâ€çš„å«Œç–‘ï¼Œå…¶å®è¿™å¯¹äºæˆ‘ä»¬è¿™äº›å­˜å‚¨ç³»ç»Ÿçš„ä½¿ç”¨è€…æ¥è¯´æ˜¯å¥½äº‹å„¿ï¼Œæ¯”å¦‚æˆ‘ä»¬æŠŠMySQLéƒ½å­¦é€äº†ï¼Œä½ å†å»çœ‹Redisï¼ŒçŸ¥é“å®ƒæŠ„äº†å“ªäº›ä½œä¸šï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬å°±å¯ä»¥è¿…é€ŸæŒæ¡äº†ï¼Œåªè¦å†ç ”ç©¶ä¸€ä¸‹ä¸ä¸€æ ·çš„é‚£ä¸€å°éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç²¾é€šRedisäº†æ˜¯ä¸ï¼Ÿ</p><p>è¯¾åè¯·ä½ å†å»çœ‹ä¸€ä¸‹HDFSï¼Œå®ƒåœ¨è§£å†³åˆ†ç‰‡ã€å¤åˆ¶å’Œé«˜å¯ç”¨è¿™å‡ æ–¹é¢ï¼Œå“ªäº›æ˜¯â€œæŠ„ä½œä¸šâ€ï¼Œå“ªäº›åˆæ˜¯è‡ªå·±ç‹¬åˆ›çš„ã€‚æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘è®¨è®ºã€‚</p><p>æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","comments":[{"had_liked":false,"id":201934,"user_name":"æç¥","can_delete":false,"product_type":"c1","uid":1501046,"ip_address":"","ucode":"B19E91EE248591","user_header":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","comment_is_top":true,"comment_ctime":1585879111,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"9.2233722274191995e+18","product_id":100046801,"comment_content":"Hiï¼Œæˆ‘æ˜¯æç¥ã€‚<br><br>è¿™é‡Œå›é¡¾ä¸€ä¸‹ä¸ŠèŠ‚è¯¾çš„æ€è€ƒé¢˜ï¼š<br><br>è¯¾åè¯·ä½ æƒ³ä¸€ä¸‹ï¼ŒæŠŠè®¢å•è¡¨æ‹†åˆ†ä¹‹åï¼Œé‚£äº›å’Œè®¢å•æœ‰å¤–é”®å…³è”çš„è¡¨ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ<br><br>å¯¹äºè¿™äº›è¡¨ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼Œå’Œè®¢å•è¡¨ä¸€èµ·æ‹†åˆ†ï¼Œè®©ç›¸åŒè®¢å•IDçš„è®¢å•å’Œå…³è”è¡¨çš„æ•°æ®åˆ†å¸ƒåˆ°ç›¸åŒçš„åˆ†ç‰‡ä¸Šï¼Œè¿™æ ·ä¾¿äºæŸ¥è¯¢ã€‚","like_count":45,"discussions":[{"author":{"id":1336783,"avatar":"https://static001.geekbang.org/account/avatar/00/14/65/cf/f4305170.jpg","nickname":"ALEX","note":"","ucode":"02031DD9EADFE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541114,"discussion_content":"ç‰µä¸€å‘ï¼ŒåŠ¨å…¨èº«\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1640257175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366379,"discussion_content":"ä¸åŒçš„è®¢å•å¯èƒ½åŒ…å«ç›¸åŒçš„å•†å“ï¼Œå¦‚ä½•ä½¿å…¶ä¸€èµ·æ‹†åˆ†å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618045041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1520538,"avatar":"https://static001.geekbang.org/account/avatar/00/17/33/9a/f295dea5.jpg","nickname":"ææ­£g","note":"","ucode":"A7BEA03BB6537A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581358,"discussion_content":"è®¢å•å¼ºç›¸å…³çš„å•†å“ä¿¡æ¯å¯èƒ½éœ€è¦å†—ä½™åˆ°è®¢å•åº“é‡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658738356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":366379,"ip_address":""},"score":581358,"extra":""}]}]},{"had_liked":false,"id":215890,"user_name":"LVM_23","can_delete":false,"product_type":"c1","uid":1039544,"ip_address":"","ucode":"5E54F9DB582E9F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/b8/31c7e110.jpg","comment_is_top":false,"comment_ctime":1589126061,"is_pvip":false,"replies":[{"id":"79949","content":"<br>å»ºè®®ä½ åœ¨listä¸­çš„æ¯ä¸ªå…ƒç´ ç”¨å•ç‹¬çš„kvå­˜å‚¨ï¼Œåœ¨kvä¸Šè®¾ç½®è¿‡æœŸæ—¶é—´ã€‚listä¸­åªä¿å­˜å…ƒç´ çš„keyã€‚<br><br>è¯»å–listä¸­çš„å…ƒç´ æ—¶ï¼Œéœ€è¦å…ˆéå†listï¼Œç„¶åå†æ ¹æ®keyå»æ‰¾åˆ°å…ƒç´ çš„å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¯´æ˜è¿‡æœŸäº†ã€‚<br><br>listä¸­çš„keyå¯ä»¥ç”¨å®šæ—¶ä»»åŠ¡æ¸…ç†ä¸€ä¸‹ï¼Œè¿™ä¸ªå®šæ—¶ä»»åŠ¡å¯ä»¥ä¸ç”¨æ‰§è¡Œçš„å¤ªé¢‘ç¹ï¼Œå› ä¸ºå³ä½¿æ¥ä¸åŠæ¸…ç†ï¼Œä¹Ÿä¸å½±å“keyè¿‡æœŸã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589172052,"ip_address":"","comment_id":215890,"utype":1}],"discussion_count":1,"race_medal":0,"score":"177682785197","product_id":100046801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæƒ³é—®ä¸ªé—®é¢˜ã€‚redisçš„listå†…å…ƒç´ çš„å•ç‹¬è¿‡æœŸæ€ä¹ˆåšï¼Œè€Œä¸æ˜¯æ•´ä¸ªlistè¿‡æœŸã€‚ ç½‘ä¸Šéƒ½æ˜¯ç”¨æ—¶é—´æˆ³å­˜ï¼Œç„¶åç”¨å®šæ—¶ä»»åŠ¡æ¥æ¸…é™¤ã€‚æœ‰å…¶ä»–çš„æ–¹æ¡ˆå—? å†™å…¥é¢‘ç¹çš„ï¼Œè°¢è°¢è€å¸ˆè§£ç­”äº†","like_count":42,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494596,"discussion_content":"\nå»ºè®®ä½ åœ¨listä¸­çš„æ¯ä¸ªå…ƒç´ ç”¨å•ç‹¬çš„kvå­˜å‚¨ï¼Œåœ¨kvä¸Šè®¾ç½®è¿‡æœŸæ—¶é—´ã€‚listä¸­åªä¿å­˜å…ƒç´ çš„keyã€‚\n\nè¯»å–listä¸­çš„å…ƒç´ æ—¶ï¼Œéœ€è¦å…ˆéå†listï¼Œç„¶åå†æ ¹æ®keyå»æ‰¾åˆ°å…ƒç´ çš„å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¯´æ˜è¿‡æœŸäº†ã€‚\n\nlistä¸­çš„keyå¯ä»¥ç”¨å®šæ—¶ä»»åŠ¡æ¸…ç†ä¸€ä¸‹ï¼Œè¿™ä¸ªå®šæ—¶ä»»åŠ¡å¯ä»¥ä¸ç”¨æ‰§è¡Œçš„å¤ªé¢‘ç¹ï¼Œå› ä¸ºå³ä½¿æ¥ä¸åŠæ¸…ç†ï¼Œä¹Ÿä¸å½±å“keyè¿‡æœŸã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589172052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201916,"user_name":"å‘æ¡æ©™å­ ã€‚","can_delete":false,"product_type":"c1","uid":1259218,"ip_address":"","ucode":"ED076F4534FFED","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","comment_is_top":false,"comment_ctime":1585876894,"is_pvip":false,"replies":[{"id":"75537","content":"æ¯ä¸ªå…¬å¸çš„å®ç°æ–¹æ¡ˆä¹Ÿéƒ½ä¸ä¸€æ ·ï¼Œå‡ ç§å“ˆå¸Œæ–¹æ³•æ²¡æœ‰å“ªç§æ˜¯ç»å¯¹çš„å¥½ï¼Œæ‰€ä»¥å¹¶ä¸ç»Ÿä¸€ã€‚<br><br>å“¨å…µè¿™ç§æ–¹å¼åœ¨é€æ­¥çš„è¢«å¼ƒç”¨ï¼Œæ›´å¤šçš„ä½¿ç”¨ç±»ä¼¼äºPaxoså’ŒRaftçš„ä¸€è‡´æ€§åè®®æ¥é€šè¿‡é€‰ä¸¾å’Œå¤åˆ¶å®ç°é«˜å¯ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1585908626,"ip_address":"","comment_id":201916,"utype":1}],"discussion_count":3,"race_medal":0,"score":"66010386334","product_id":100046801,"comment_content":"è€å¸ˆ æœ‰ä¸¤ä¸ªç–‘é—®ç‚¹<br><br>1.  å¤§å‚è‡ªå»ºé›†ç¾¤ æ˜¯ä¸æ˜¯å°±æ˜¯å¸¸è¯´çš„ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œæ¥åšæ§½çš„æ˜ å°„<br><br>2. æ—¢ç„¶è‡ªå¸¦é›†ç¾¤åŒ…å«äº†å“¨å…µï¼Œ ä»£ç†ä¹ŸåŒ…å« ï¼Œæ˜¯ä¸æ˜¯å“¨å…µçš„åŠŸèƒ½ä¹Ÿæ˜¯åœ¨è‡ªå»ºä¸­ä½¿ç”¨ ï¼Œè¿˜æ˜¯å¤§å‚è‡ªå»ºçš„ä¹Ÿä¸ç”¨å“¨å…µ æ˜¯è‡ªå·±åšçš„é«˜å¯ç”¨","like_count":16,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490456,"discussion_content":"æ¯ä¸ªå…¬å¸çš„å®ç°æ–¹æ¡ˆä¹Ÿéƒ½ä¸ä¸€æ ·ï¼Œå‡ ç§å“ˆå¸Œæ–¹æ³•æ²¡æœ‰å“ªç§æ˜¯ç»å¯¹çš„å¥½ï¼Œæ‰€ä»¥å¹¶ä¸ç»Ÿä¸€ã€‚\n\nå“¨å…µè¿™ç§æ–¹å¼åœ¨é€æ­¥çš„è¢«å¼ƒç”¨ï¼Œæ›´å¤šçš„ä½¿ç”¨ç±»ä¼¼äºPaxoså’ŒRaftçš„ä¸€è‡´æ€§åè®®æ¥é€šè¿‡é€‰ä¸¾å’Œå¤åˆ¶å®ç°é«˜å¯ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585908626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1386818,"avatar":"https://static001.geekbang.org/account/avatar/00/15/29/42/43d4b1a8.jpg","nickname":"çƒ«çƒ«çƒ«","note":"","ucode":"C06018670DE76A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330910,"discussion_content":"Redis å“¨å…µç”¨çš„ä¹Ÿæ˜¯Raftç®—æ³•å§","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606729631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1386818,"avatar":"https://static001.geekbang.org/account/avatar/00/15/29/42/43d4b1a8.jpg","nickname":"çƒ«çƒ«çƒ«","note":"","ucode":"C06018670DE76A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":410907,"discussion_content":"raftæ˜¯å¼ºä¸€è‡´æ€§ã€å»ä¸­å¿ƒåŒ–ã€é«˜å¯ç”¨çš„åˆ†å¸ƒå¼åè®®ï¼Œä½¿ç”¨raftç®—æ³•ä¹‹åå°±ä¸éœ€è¦å“¨å…µçš„å­˜åœ¨äº†ï¼Œredis clusterçš„èŠ‚ç‚¹è‡ªæ²»ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1635813596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":330910,"ip_address":""},"score":410907,"extra":""}]}]},{"had_liked":false,"id":201438,"user_name":"ç‰¹ç§æµæ°“","can_delete":false,"product_type":"c1","uid":1248825,"ip_address":"","ucode":"D9985CBA8B4AAD","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/39/174741d1.jpg","comment_is_top":false,"comment_ctime":1585788907,"is_pvip":false,"replies":[{"id":"75365","content":"æ˜¯çš„ï¼Œredis clusterå·²ç»åŒ…å«å“¨å…µçš„åŠŸèƒ½äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1585792657,"ip_address":"","comment_id":201438,"utype":1}],"discussion_count":1,"race_medal":0,"score":"48830429163","product_id":100046801,"comment_content":"redis clusteré›†ç¾¤ æ˜¯ä¸æ˜¯å°±æ²¡æœ‰å“¨å…µçš„æ¦‚å¿µäº†","like_count":12,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490334,"discussion_content":"æ˜¯çš„ï¼Œredis clusterå·²ç»åŒ…å«å“¨å…µçš„åŠŸèƒ½äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585792657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201516,"user_name":"æ­£åœ¨å‡è‚¥çš„èƒ–ç±½ã€‚","can_delete":false,"product_type":"c1","uid":1033728,"ip_address":"","ucode":"99E2E4DF599236","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c6/00/683bb4f0.jpg","comment_is_top":false,"comment_ctime":1585797858,"is_pvip":false,"replies":[{"id":"75386","content":"å¦‚æœç”¨çš„æ˜¯å®˜æ–¹çš„Redis Clusterï¼Œå¯ä»¥ç”¨å®ƒæä¾›çš„redis-trib.rbè‡ªåŠ¨å¹³æ»‘è¿ç§»ã€‚<br><br>åƒCodisä¹Ÿæä¾›äº†å¹³æ»‘è¿ç§»çš„ç®¡ç†å·¥å…·ã€‚å¦‚æœæ˜¯è‡ªå»ºçš„é›†ç¾¤ï¼Œç›¸å¯¹å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚<br><br>æˆ‘ä¼šåœ¨åé¢çš„ç¬¬20èŠ‚è¯¾è®²ï¼Œæ€ä¹ˆæ¥å¹³æ»‘çš„è¿ç§»æ•°æ®åº“ï¼Œæ–¹æ³•åŒæ ·é€‚ç”¨äºè¿ç§»Redisã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1585803355,"ip_address":"","comment_id":201516,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31650568930","product_id":100046801,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼š<br> 1.redisé›†ç¾¤æ–°å¢åˆ†ç‰‡åï¼Œçº¿ä¸Šæ€ä¹ˆå®ç°å¥½çš„å¹³æ»‘è¿ç§»ï¼Ÿè¿™ä¸ªä¸€ç›´æ²¡æœ‰æƒ³åˆ°å¥½çš„è§£å†³æ–¹æ³•","like_count":8,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490357,"discussion_content":"å¦‚æœç”¨çš„æ˜¯å®˜æ–¹çš„Redis Clusterï¼Œå¯ä»¥ç”¨å®ƒæä¾›çš„redis-trib.rbè‡ªåŠ¨å¹³æ»‘è¿ç§»ã€‚\n\nåƒCodisä¹Ÿæä¾›äº†å¹³æ»‘è¿ç§»çš„ç®¡ç†å·¥å…·ã€‚å¦‚æœæ˜¯è‡ªå»ºçš„é›†ç¾¤ï¼Œç›¸å¯¹å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚\n\næˆ‘ä¼šåœ¨åé¢çš„ç¬¬20èŠ‚è¯¾è®²ï¼Œæ€ä¹ˆæ¥å¹³æ»‘çš„è¿ç§»æ•°æ®åº“ï¼Œæ–¹æ³•åŒæ ·é€‚ç”¨äºè¿ç§»Redisã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585803355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201471,"user_name":"haijian.yang","can_delete":false,"product_type":"c1","uid":1162081,"ip_address":"","ucode":"E3D13ABA2CA347","user_header":"https://static001.geekbang.org/account/avatar/00/11/bb/61/2c2f5024.jpg","comment_is_top":false,"comment_ctime":1585792466,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27355596242","product_id":100046801,"comment_content":"é˜¿é‡Œäº‘æœ‰ä¸ª redis æ–¹æ¡ˆï¼Œå†·æ•°æ®å­˜ç£ç›˜ï¼Œçƒ­æ•°æ®æ”¾åœ¨å†…å­˜ã€‚","like_count":7},{"had_liked":false,"id":217650,"user_name":"ç”³å­¦æ™‹","can_delete":false,"product_type":"c1","uid":1748750,"ip_address":"","ucode":"3F329A4DEBEE97","user_header":"https://static001.geekbang.org/account/avatar/00/1a/af/0e/ac955022.jpg","comment_is_top":false,"comment_ctime":1589556725,"is_pvip":false,"replies":[{"id":"80849","content":"redis-cluster-proxy è¿™ä¸ªé¡¹ç›®ç›®å‰è¿˜å¤„äºalphaé˜¶æ®µï¼Œå®˜æ–¹ä¸å»ºè®®ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥æŒç»­å…³æ³¨å®ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589868837,"ip_address":"","comment_id":217650,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23064393205","product_id":100046801,"comment_content":"redis6.0çš„å®˜æ–¹é›†ç¾¤ä»£ç†å’Œå®¢æˆ·ç«¯ç¼“å­˜æ˜¯ä¸æ˜¯å¯ä»¥æŠŠæ‚¨è®²çš„ä¸¤ç§æ–¹æ¡ˆç»“åˆä½¿ç”¨ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495206,"discussion_content":"redis-cluster-proxy è¿™ä¸ªé¡¹ç›®ç›®å‰è¿˜å¤„äºalphaé˜¶æ®µï¼Œå®˜æ–¹ä¸å»ºè®®ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥æŒç»­å…³æ³¨å®ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589868837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208534,"user_name":"æš´å›â€¢ç†Š","can_delete":false,"product_type":"c1","uid":1101531,"ip_address":"","ucode":"AD1C6055E1F665","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/db/9dba29ea.jpg","comment_is_top":false,"comment_ctime":1587376081,"is_pvip":false,"replies":[{"id":"78332","content":"è¿™ç§ä¸€èˆ¬æ•°æ®èŠ‚ç‚¹ä¸Šå°±åªç”¨åŸç”Ÿçš„Redisï¼Œå…ƒæ•°æ®å­˜å‚¨åœ¨å…ƒæ•°æ®æœåŠ¡ä¸Šã€‚æ‰©å®¹ä¹Ÿåªæ˜¯å˜æ›´å…ƒæ•°æ®ï¼Œä¸éœ€è¦RedisæœåŠ¡æ¥å‚ä¸ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1587694734,"ip_address":"","comment_id":208534,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18767245265","product_id":100046801,"comment_content":"è€å¸ˆï¼Œæœ€åä»‹ç»çš„å®šåˆ¶å®¢æˆ·ç«¯æ¨¡å¼æ¥ä¿å­˜åˆ†ç‰‡è¡¨ã€‚é‚£redisçš„æœåŠ¡ç«¯ä¸éœ€è¦åŠ¨å˜›ï¼Ÿå½“æœ‰æ–°å¢æˆ–è€…åˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å†…éƒ¨ä¸è¿˜æ˜¯éœ€è¦ä½¿ç”¨æµè¨€æ¥ä¼ æ’­ä¸€æ¬¡å˜›ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492497,"discussion_content":"è¿™ç§ä¸€èˆ¬æ•°æ®èŠ‚ç‚¹ä¸Šå°±åªç”¨åŸç”Ÿçš„Redisï¼Œå…ƒæ•°æ®å­˜å‚¨åœ¨å…ƒæ•°æ®æœåŠ¡ä¸Šã€‚æ‰©å®¹ä¹Ÿåªæ˜¯å˜æ›´å…ƒæ•°æ®ï¼Œä¸éœ€è¦RedisæœåŠ¡æ¥å‚ä¸ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587694734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215282,"user_name":"å–œæ¬¢åœ°çƒçš„é˜¿åŸ¹åŒå­¦","can_delete":false,"product_type":"c1","uid":1361746,"ip_address":"","ucode":"5F97037585F857","user_header":"https://static001.geekbang.org/account/avatar/00/14/c7/52/c5adf218.jpg","comment_is_top":false,"comment_ctime":1588947262,"is_pvip":false,"replies":[{"id":"79939","content":"æ˜¯çš„ï¼Œåé¢äºŒç§æ–¹æ³•éƒ½ä¸ä¼šç”¨åˆ°æµè¨€åè®®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æç¥","uid":"1501046","ctime":1589170820,"ip_address":"","comment_id":215282,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14473849150","product_id":100046801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œé—®ä¸€ä¸ªé—®é¢˜ã€‚æœ€åä»‹ç»çš„å®šåˆ¶å®¢æˆ·ç«¯æ¨¡å¼ã€‚æ˜¯ä¸æ˜¯è¿™äº›redisæ˜¯ä¸€ä¸ªä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æ²¡æœ‰ä¸€èµ·ç»„æˆä¸€ä¸ªé›†ç¾¤ã€‚å¦‚æœè¿™äº›redisç»„æˆä¸€ä¸ªé›†ç¾¤çš„è¯ï¼Œé‚£å²‚ä¸æ˜¯æ¯æ¬¡æ–°å¢å’Œåˆ é™¤redisèŠ‚ç‚¹æ—¶ï¼Œä¹Ÿä¼šæµè¨€ä¼ æ’­ä¸€æ¬¡å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1501046,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e7/76/79c1f23a.jpg","nickname":"æç¥","note":"","ucode":"B19E91EE248591","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494382,"discussion_content":"æ˜¯çš„ï¼Œåé¢äºŒç§æ–¹æ³•éƒ½ä¸ä¼šç”¨åˆ°æµè¨€åè®®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589170820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201493,"user_name":"sami","can_delete":false,"product_type":"c1","uid":1033240,"ip_address":"","ucode":"9A66FCA00D8A37","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJkwbyTYtSCx6Qc7cQPnnRWv38Jybh3etziaPmuP8gHcgS6FMxcdftrKgWiamH6fc2iciaicDKDVEwcEibQ/132","comment_is_top":false,"comment_ctime":1585795505,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10175730097","product_id":100046801,"comment_content":"clusterå‘½ä»¤æ˜¯å—é™çš„ï¼Œè·Ÿmysqlçš„åˆ†åº“åˆ†è¡¨ä¸€æ ·ï¼Œæœ‰ä¸€äº›åœºæ™¯ä¹Ÿæ˜¯æ— æ³•æ”¯æŒ","like_count":2},{"had_liked":false,"id":201398,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1585763999,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5880731295","product_id":100046801,"comment_content":"å…¶å®è¿™ä¹Ÿåå‘æå‡ºäº†å¦ä¸€ä¸ªé—®é¢˜mysql clusterçš„é—®é¢˜ï¼šå…¶è‡ªèº«åŒæ ·æœ‰cluster,å¯æ˜¯çœŸå®ç¯å¢ƒä¸‹å¾ˆå°‘ä¼ä¸šä¼šå»ç”¨mysql clusterï¼›éƒ½æ˜¯å„è‡ªè¿ç”¨è‡ªå·±çš„æ–¹æ¡ˆå»åšé›†ç¾¤ï¼Œæ–¹æ¡ˆä¹‹å‰çš„è¯¾ç¨‹ä¸­éƒ½æœ‰æåŠå°±ä¸æäº†ã€‚<br>è‡ªèº«çš„clusteråœ¨å®é™…ç”Ÿäº§ä¸­æå°‘è¢«æŸäº›æ•°æ®åº“ä½¿ç”¨è¿™å¤§æ¦‚ç®—æ˜¯ä¸€å¤§ç‰¹ç‚¹ï¼Œå°¤å…¶åƒæˆ‘ä»¬æ‰€å¸¸è§çš„mysqlã€redisã€ä»¥åŠåé¢æ–°å‡ºæ¥çš„ã€ã€ã€","like_count":1,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366408,"discussion_content":"æ¢è¨€ä¹‹å…¶å®é›†ç¾¤å°±æ˜¯ä¸ºäº†è§£å†³é«˜æ€§èƒ½ï¼ˆåˆ†è¡¨ï¼‰ï¼Œé«˜å¯ç”¨ï¼ˆæ•…éšœè½¬ç§»ï¼‰ï¼Œé«˜å¹¶å‘ï¼ˆåˆ†åº“ï¼‰é—®é¢˜ï¼Œè§£å†³å¾—ä¸å¥½ï¼ˆæ€§èƒ½ä¸å¥½ï¼Œä½¿ç”¨ä¸ä¾¿ï¼‰ï¼Œå°±ä¼šè‡ªè¡Œç ”å‘","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618054422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336651,"user_name":"åƒé”¤ç™¾ç‚¼é¢†æ‚Ÿä¹‹æé™","can_delete":false,"product_type":"c1","uid":1744257,"ip_address":"","ucode":"224B5CF2101716","user_header":"https://static001.geekbang.org/account/avatar/00/1a/9d/81/d748b7eb.jpg","comment_is_top":false,"comment_ctime":1646276182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646276182","product_id":100046801,"comment_content":"å°è§„æ¨¡é›†ç¾¤é€‚åˆä½¿ç”¨Redis Clusterï¼Œé€‚åˆå‡ ä¸ªåˆ°å‡ åä¸ªèŠ‚ç‚¹çš„è§„æ¨¡ã€‚<br><br>ä¸ºä»€ä¹ˆä¸é€‚åˆå¤§è§„æ¨¡çš„é›†ç¾¤? å› ä¸ºRedis Clusterä½¿ç”¨äº†ä¸€ç§å»ä¸­å¿ƒåŒ–è®¾è®¡çš„Gossipï¼ˆæµè¨€ï¼‰åè®®ï¼Œç”¨äºèŠ‚ç‚¹ä¹‹é—´æ›´æ–°æ˜ å°„è¡¨ã€‚<br><br>å¦‚æœé›†ç¾¤çš„èŠ‚ç‚¹æ•°é‡å¤šï¼Œæ›´æ–°æ˜ å°„è¡¨é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯¼è‡´æ•°æ®åŒæ­¥ç­‰é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":282545,"user_name":"é”","can_delete":false,"product_type":"c1","uid":1110915,"ip_address":"","ucode":"A245BA96C9471F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/83/e2612d81.jpg","comment_is_top":false,"comment_ctime":1615295571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615295571","product_id":100046801,"comment_content":"å®šåˆ¶å®¢æˆ·ç«¯è¿™ä¸ªæ–¹æ¡ˆï¼Œå®¢æˆ·ç«¯ç¼“å­˜å…ƒæ•°æ®ï¼Œå½“é›†ç¾¤ä¸­æœºå™¨å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ˜¯é€šè¿‡zookeeperé€šçŸ¥å®¢æˆ·ç«¯æ›´æ–°å…ƒæ•°æ®å—","like_count":0},{"had_liked":false,"id":246408,"user_name":"Lynn","can_delete":false,"product_type":"c1","uid":2165368,"ip_address":"","ucode":"D4CB95A1F1D60A","user_header":"https://static001.geekbang.org/account/avatar/00/21/0a/78/5ac3666f.jpg","comment_is_top":false,"comment_ctime":1599313039,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1599313039","product_id":100046801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå‡å¦‚ä¸¤ä¸ªkeyè®¡ç®—å‡ºæ¥çš„æ§½æ˜¯åŒä¸€ä¸ªï¼Œé‚£æ˜¯ä»¥é“¾è¡¨çš„æ–¹å¼ä¿å­˜åˆ°æ§½é‡Œé¢å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366405,"discussion_content":"redisä¸­hashçš„åº•å±‚ç»“æ„æ˜¯hash tableæˆ–è€…skiplist","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618053422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242022,"user_name":"lcfæ«","can_delete":false,"product_type":"c1","uid":1144171,"ip_address":"","ucode":"D51E8F68BD41CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/75/6b/fd685164.jpg","comment_is_top":false,"comment_ctime":1597564473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597564473","product_id":100046801,"comment_content":"è€å¸ˆ redis cluster çš„é«˜å¯ç”¨åº”è¯¥æ˜¯æœ‰ä¸¤æ–¹é¢æ¥ä¿è¯çš„å§ï¼Ÿä¸­ä»åº“ + å“¨å…µå¸®åŠ©ç›‘æ§åˆ‡æ¢","like_count":0},{"had_liked":false,"id":238515,"user_name":"å“ˆå¾·éŸ¦","can_delete":false,"product_type":"c1","uid":1637085,"ip_address":"","ucode":"E7C9B3D087D2D9","user_header":"https://static001.geekbang.org/account/avatar/00/18/fa/dd/f640711f.jpg","comment_is_top":false,"comment_ctime":1596186477,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596186477","product_id":100046801,"comment_content":"è¯·é—®ä¸‹è€å¸ˆï¼Œè·¨æ•°æ®ä¸­å¿ƒçš„ Redis æ•°æ®åŒæ­¥æœ‰æ²¡æœ‰æœ€ä½³å®è·µï¼Ÿæ¯”å¦‚ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯Sessionæ•°æ®ç¼“å­˜åœ¨Redisï¼Œé‚£ä¹ˆå›½å†…é›†ç¾¤å’Œæµ·å¤–é›†ç¾¤æ€ä¹ˆåŒæ­¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":231852,"user_name":"è¿œèˆª","can_delete":false,"product_type":"c1","uid":2051135,"ip_address":"","ucode":"A16171F1EAF7A1","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/3f/5a343ddd.jpg","comment_is_top":false,"comment_ctime":1593788693,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593788693","product_id":100046801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå¦‚æœç³»ç»Ÿéƒ¨ç½²åœ¨ä¸¤ä¸ªæœºæˆ¿ï¼Œ1:1éƒ¨ç½²ä¸šåŠ¡ï¼Œredisé‡‡ç”¨ä½•ç§éƒ¨ç½²æ–¹å¼ï¼Ÿä¸¤ä¸ªæœºæˆ¿éœ€è¦ä¿è¯redisçš„æ•°æ®ä¸€è‡´æ€§","like_count":0},{"had_liked":false,"id":231383,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1593660715,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1593660715","product_id":100046801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼š<br>æˆ‘ä»¬ç°åœ¨åšrediså°è§„æ¨¡çš„é«˜å¯ç”¨ï¼Œåªæœ‰3å°æœºå™¨ï¼Œéƒ¨ç½²çš„å°±æ˜¯redis clusteré›†ç¾¤ï¼Œä¸€å…±éƒ¨ç½²äº†6ä¸ªå®ä¾‹ï¼Œ3ä¸ªmasterï¼Œ3ä¸ªslaveï¼ˆé”™å¼€éƒ¨ç½²ï¼ŒAæœºå™¨ä¸Šmaster1, slave3; B æœºå™¨ä¸Š master2, slave1; C æœºå™¨ä¸Šmaster 3, slave2 è¿™æ ·ï¼‰ã€‚<br>æˆ‘æµ‹è¯•æ—¶ï¼ŒæŠŠAæœºå™¨ä¸Šçš„ä¸¤ä¸ªå®ä¾‹åœæ‰ï¼Œjava jediså®¢æˆ·ç«¯è¿æ¥æŠ¥é”™ä¸€ä¼šåï¼Œå°±æ­£å¸¸äº†ï¼›ç„¶åæˆ‘æŠŠAæ¢å¤ï¼Œå†æŠŠBæœºå™¨ä¸Šçš„ä¸¤ä¸ªå®ä¾‹åœæ‰ï¼Œjava jediså®¢æˆ·ç«¯è¿æ¥æŠ¥é”™å°±æ— æ³•æ¢å¤æ­£å¸¸äº†ï¼ˆé”™è¯¯ï¼šthrow new JedisClusterMaxRedirectionsException(&quot;Too many Cluster redirections?&quot;)ï¼‰ï¼Œé‡å¯javaæœåŠ¡ä¹Ÿæ— æ•ˆã€‚ç„¶åæˆ‘é€šè¿‡CLUSTER NODESå‘½ä»¤çœ‹åˆ°Bæœºå™¨ä¸Šçš„ä¸¤ä¸ªå®ä¾‹éƒ½æ˜¯master ï¼ˆfailï¼Œ disconnectdçŠ¶æ€ï¼‰ã€‚<br><br>æˆ‘ç†è§£æ˜¯ç¬¬ä¸€æ¬¡åœæ­¢Aæœºå™¨ä¸Šå®ä¾‹çš„æ—¶å€™ï¼Œmasteræ¼‚åˆ°Bæœºå™¨ä¸Šäº†ï¼Œç„¶ååœæ­¢Bæœºå™¨ä¸Šå®ä¾‹çš„æ—¶å€™ï¼Œmasteræ²¡æœ‰æ¼‚åˆ°å…¶ä»–æœºå™¨ä¸Šï¼Œä¸æ¸…æ¥šä¸ºä»€ä¹ˆï¼Ÿ<br>åŒäº‹å»ºè®®æ¢å“¨å…µæ¨¡å¼ï¼Œæˆ‘è‡ªå·±æƒ³äº†ä¸€ä¸‹ï¼Œè§‰å¾—å“¨å…µå¥½åƒæ›´é è°±äº›ï¼Œä½†æˆ‘çœ‹è€å¸ˆè¯´å“¨å…µå·²ç»æ…¢æ…¢è¿‡æ—¶äº†ï¼Œä¸”redis clusterå·²ç»æœ‰å“¨å…µçš„åŠŸèƒ½äº†ï¼Œè¯·è€å¸ˆé’ˆå¯¹æˆ‘è¿™ç§åœºæ™¯ï¼Œç»™ç‚¹æ„è§ï¼Œè°¢è°¢ã€‚","like_count":0},{"had_liked":false,"id":224364,"user_name":"åš","can_delete":false,"product_type":"c1","uid":1798979,"ip_address":"","ucode":"F7CA69FF5D09BA","user_header":"https://static001.geekbang.org/account/avatar/00/1b/73/43/ae139b1f.jpg","comment_is_top":false,"comment_ctime":1591355242,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591355242","product_id":100046801,"comment_content":"è€å¸ˆï¼Œredisçš„key æœ‰ä»€ä¹ˆç»Ÿä¸€çš„è®¾è®¡è§„èŒƒå—ï¼Œçœ‹åˆ°å¥½å¤šéƒ½æ˜¯ä¸æ•°æ®åº“è¡¨ç›¸å¯¹åº”çš„æ–¹å¼","like_count":0},{"had_liked":false,"id":220340,"user_name":"ğŸ˜š 46","can_delete":false,"product_type":"c1","uid":1433535,"ip_address":"","ucode":"EED0EBBBF80A43","user_header":"https://static001.geekbang.org/account/avatar/00/15/df/bf/96b50d1e.jpg","comment_is_top":false,"comment_ctime":1590224522,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590224522","product_id":100046801,"comment_content":"æœ€åä¸€ç§é›†ç¾¤æ–¹æ¡ˆï¼Œæ„Ÿè§‰æœ‰ç‚¹ç±»ä¼¼äºsharding sphereè¿™æ ·çš„ä¸­é—´ä»¶ï¼Œå®¢æˆ·ç«¯è¯»å–å…ƒæ•°æ®ç„¶åè·¯ç”±åˆ°å…·ä½“çš„rediså®ä¾‹è¯·æ±‚","like_count":0},{"had_liked":false,"id":213875,"user_name":"æ—…é€”","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1588581231,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1588581231","product_id":100046801,"comment_content":"è€å¸ˆ,ä¸ºä»€ä¹ˆredisæ²¡æœ‰äº‹åŠ¡åŒæ­¥å°±ä¸éœ€è¦binlogäº†?","like_count":0,"discussions":[{"author":{"id":1886331,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c8/7b/153181d7.jpg","nickname":"å¤œè¾‰","note":"","ucode":"9421385F51FF9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366407,"discussion_content":"æ²¡æœ‰äº‹åŠ¡ç›´æ¥æ›´æ–°æ•°æ®å³å¯\nbinlogé…åˆredo logï¼Œundo logå®ç°åŸå­æ€§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618053489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208387,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1587348426,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587348426","product_id":100046801,"comment_content":"HDFSåˆ†ç‰‡ã€å¤åˆ¶å’Œé«˜å¯ç”¨åŸç†åŸºæœ¬ä¸€æ ·ï¼Œæœºæ¶æ„ŸçŸ¥æ˜¯ç‹¬åˆ›ã€‚","like_count":0}]}