{"id":10386,"title":"第22讲 | VPN：朝中有人好做官","content":"<p>前面我们讲到了数据中心，里面很复杂，但是有的公司有多个数据中心，需要将多个数据中心连接起来，或者需要办公室和数据中心连接起来。这该怎么办呢？</p><ul>\n<li>\n<p>第一种方式是走公网，但是公网太不安全，你的隐私可能会被别人偷窥。</p>\n</li>\n<li>\n<p>第二种方式是租用专线的方式把它们连起来，这是土豪的做法，需要花很多钱。</p>\n</li>\n<li>\n<p>第三种方式是用VPN来连接，这种方法比较折中，安全又不贵。</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/9f/68/9f797934cb5cf40543b716d97e214868.jpg?wh=707*500\" alt=\"\"></p><p><strong>VPN</strong>，全名<strong>Virtual Private Network</strong>，<strong>虚拟专用网</strong>，就是利用开放的公众网络，建立专用数据传输通道，将远程的分支机构、移动办公人员等连接起来。</p><h2>VPN是如何工作的？</h2><p>VPN通过隧道技术在公众网络上仿真一条点到点的专线，是通过利用一种协议来传输另外一种协议的技术，这里面涉及三种协议：<strong>乘客协议</strong>、<strong>隧道协议</strong>和<strong>承载协议</strong>。</p><p>我们以IPsec协议为例来说明。</p><p><img src=\"https://static001.geekbang.org/resource/image/52/7f/52c72a2a29c6b8526a243125e101f77f.jpeg?wh=1498*413\" alt=\"\"></p><p>你知道如何通过自驾进行海南游吗？这其中，你的车怎么通过琼州海峡呢？这里用到轮渡，其实这就用到<strong>隧道协议</strong>。</p><p>在广州这边开车是有“协议”的，例如靠右行驶、红灯停、绿灯行，这个就相当于“被封装”的<strong>乘客协议</strong>。当然在海南那面，开车也是同样的协议。这就相当于需要连接在一起的一个公司的两个分部。</p><p>但是在海上坐船航行，也有它的协议，例如要看灯塔、要按航道航行等。这就是外层的<strong>承载协议</strong>。</p><!-- [[[read_end]]] --><p>那我的车如何从广州到海南呢？这就需要你遵循开车的协议，将车开上轮渡，所有通过轮渡的车都关在船舱里面，按照既定的规则排列好，这就是<strong>隧道协议</strong>。</p><p>在大海上，你的车是关在船舱里面的，就像在隧道里面一样，这个时候内部的乘客协议，也即驾驶协议没啥用处，只需要船遵从外层的承载协议，到达海南就可以了。</p><p>到达之后，外部承载协议的任务就结束了，打开船舱，将车开出来，就相当于取下承载协议和隧道协议的头。接下来，在海南该怎么开车，就怎么开车，还是内部的乘客协议起作用。</p><p>在最前面的时候说了，直接使用公网太不安全，所以接下来我们来看一种十分安全的VPN，<strong>IPsec VPN</strong>。这是基于IP协议的<strong>安全隧道协议</strong>，为了保证在公网上面信息的安全，因而采取了一定的机制保证安全性。</p><ul>\n<li>\n<p>机制一：<strong>私密性</strong>，防止信息泄露给未经授权的个人，通过加密把数据从明文变成无法读懂的密文，从而确保数据的私密性。<br>\n前面讲HTTPS的时候，说过加密可以分为对称加密和非对称加密。对称加密速度快一些。而VPN一旦建立，需要传输大量数据，因而我们采取对称加密。但是同样，对称加密还是存在加密密钥如何传输的问题，这里需要用到因特网密钥交换（IKE，Internet Key Exchange）协议。</p>\n</li>\n<li>\n<p>机制二：<strong>完整性</strong>，数据没有被非法篡改，通过对数据进行hash运算，产生类似于指纹的数据摘要，以保证数据的完整性。</p>\n</li>\n<li>\n<p>机制三：<strong>真实性</strong>，数据确实是由特定的对端发出，通过身份认证可以保证数据的真实性。</p>\n</li>\n</ul><p>那如何保证对方就是真正的那个人呢？</p><ul>\n<li>\n<p>第一种方法就是<strong>预共享密钥</strong>，也就是双方事先商量好一个暗号，比如“天王盖地虎，宝塔镇河妖”，对上了，就说明是对的。</p>\n</li>\n<li>\n<p>另外一种方法就是<strong>用数字签名来验证</strong>。咋签名呢？当然是使用私钥进行签名，私钥只有我自己有，所以如果对方能用我的数字证书里面的公钥解开，就说明我是我。</p>\n</li>\n</ul><p>基于以上三个特性，组成了<strong>IPsec VPN的协议簇</strong>。这个协议簇内容比较丰富。</p><p><img src=\"https://static001.geekbang.org/resource/image/e4/c2/e43f13e5c68c9a5455b3793fb530a4c2.jpeg?wh=1920*742\" alt=\"\"></p><p>在这个协议簇里面，有两种协议，这两种协议的区别在于封装网络包的格式不一样。</p><ul>\n<li>\n<p>一种协议称为<strong>AH</strong>（<strong>Authentication Header</strong>），只能进行数据摘要 ，不能实现数据加密。</p>\n</li>\n<li>\n<p>还有一种<strong>ESP</strong>（<strong>Encapsulating Security Payload</strong>），能够进行数据加密和数据摘要。</p>\n</li>\n</ul><p>在这个协议簇里面，还有两类算法，分别是<strong>加密算法</strong>和<strong>摘要算法</strong>。</p><p>这个协议簇还包含两大组件，一个用于VPN的双方要进行对称密钥的交换的<strong>IKE组件</strong>，另一个是VPN的双方要对连接进行维护的<strong>SA（Security Association）组件</strong>。</p><h2>IPsec VPN的建立过程</h2><p>下面来看IPsec VPN的建立过程，这个过程分两个阶段。</p><p><strong>第一个阶段，建立IKE自己的SA</strong>。这个SA用来维护一个通过身份认证和安全保护的通道，为第二个阶段提供服务。在这个阶段，通过DH（Diffie-Hellman）算法计算出一个对称密钥K。</p><p>DH算法是一个比较巧妙的算法。客户端和服务端约定两个公开的质数p和q，然后客户端随机产生一个数a作为自己的私钥，服务端随机产生一个b作为自己的私钥，客户端可以根据p、q和a计算出公钥A，服务端根据p、q和b计算出公钥B，然后双方交换公钥A和B。</p><p>到此客户端和服务端可以根据已有的信息，各自独立算出相同的结果K，就是<strong>对称密钥</strong>。但是这个过程，对称密钥从来没有在通道上传输过，只传输了生成密钥的材料，通过这些材料，截获的人是无法算出的。</p><p><img src=\"https://static001.geekbang.org/resource/image/24/ea/24c89b7703ffcb7ce966f9d259b06eea.jpeg?wh=1920*1080\" alt=\"\"></p><p>有了这个对称密钥K，接下来是<strong>第二个阶段，建立IPsec SA</strong>。在这个SA里面，双方会生成一个随机的对称密钥M，由K加密传给对方，然后使用M进行双方接下来通信的数据。对称密钥M是有过期时间的，会过一段时间，重新生成一次，从而防止被破解。</p><p>IPsec SA里面有以下内容：</p><ul>\n<li>\n<p>SPI（Security Parameter Index），用于标识不同的连接；</p>\n</li>\n<li>\n<p>双方商量好的加密算法、哈希算法和封装模式；</p>\n</li>\n<li>\n<p>生存周期，超过这个周期，就需要重新生成一个IPsec SA，重新生成对称密钥。</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/4d/75/4dd02eaa9a0242252371248a1b455275.jpeg?wh=1920*835\" alt=\"\"></p><p>当IPsec建立好，接下来就可以开始打包封装传输了。</p><p><img src=\"https://static001.geekbang.org/resource/image/15/65/158af554e14dd93237b136a99d07d165.jpg?wh=4329*6491\" alt=\"\"></p><p>左面是原始的IP包，在IP头里面，会指定上一层的协议为TCP。ESP要对IP包进行封装，因而IP头里面的上一层协议为ESP。在ESP的正文里面，ESP的头部有双方商讨好的SPI，以及这次传输的序列号。</p><p>接下来全部是加密的内容。可以通过对称密钥进行解密，解密后在正文的最后，指明了里面的协议是什么。如果是IP，则需要先解析IP头，然后解析TCP头，这是从隧道出来后解封装的过程。</p><p>有了IPsec VPN之后，客户端发送的明文的IP包，都会被加上ESP头和IP头，在公网上传输，由于加密，可以保证不被窃取，到了对端后，去掉ESP的头，进行解密。</p><p><img src=\"https://static001.geekbang.org/resource/image/48/d2/487d8dde5ec7758b4c169509fba59cd2.jpeg?wh=1920*866\" alt=\"\"></p><p>这种点对点的基于IP的VPN，能满足互通的要求，但是速度往往比较慢，这是由底层IP协议的特性决定的。IP不是面向连接的，是尽力而为的协议，每个IP包自由选择路径，到每一个路由器，都自己去找下一跳，丢了就丢了，是靠上一层TCP的重发来保证可靠性。</p><p><img src=\"https://static001.geekbang.org/resource/image/29/8e/29f4dff1f40a252dda2ac6f9d1d4088e.jpg?wh=747*316\" alt=\"\"></p><p>因为IP网络从设计的时候，就认为是不可靠的，所以即使同一个连接，也可能选择不同的道路，这样的好处是，一条道路崩溃的时候，总有其他的路可以走。当然，带来的代价就是，不断的路由查找，效率比较差。</p><p>和IP对应的另一种技术称为ATM。这种协议和IP协议的不同在于，它是面向连接的。你可以说TCP也是面向连接的啊。这两个不同，ATM和IP是一个层次的，和TCP不是一个层次的。</p><p>另外，TCP所谓的面向连接，是不停地重试来保证成功，其实下层的IP还是不面向连接的，丢了就丢了。ATM是传输之前先建立一个连接，形成一个虚拟的通路，一旦连接建立了，所有的包都按照相同的路径走，不会分头行事。</p><p><img src=\"https://static001.geekbang.org/resource/image/af/48/afea2a2cecb8bfe6c1c40585000f1c48.jpg?wh=756*305\" alt=\"\"></p><p>好处是不需要每次都查路由表的，虚拟路径已经建立，打上了标签，后续的包傻傻的跟着走就是了，不用像IP包一样，每个包都思考下一步怎么走，都按相同的路径走，这样效率会高很多。</p><p>但是一旦虚拟路径上的某个路由器坏了，则这个连接就断了，什么也发不过去了，因为其他的包还会按照原来的路径走，都掉坑里了，它们不会选择其他的路径走。</p><p>ATM技术虽然没有成功，但其屏弃了繁琐的路由查找，改为简单快速的标签交换，将具有全局意义的路由表改为只有本地意义的标签表，这些都可以大大提高一台路由器的转发功力。</p><p>有没有一种方式将两者的优点结合起来呢？这就是<strong>多协议标签交换</strong>（<strong>MPLS</strong>，<strong>Multi-Protocol Label Switching</strong>）。MPLS的格式如图所示，在原始的IP头之外，多了MPLS的头，里面可以打标签。</p><p><img src=\"https://static001.geekbang.org/resource/image/c4/96/c45a0a2f11678f15e126449e64644596.jpeg?wh=1920*560\" alt=\"\"></p><p>在二层头里面，有类型字段，0x0800表示IP，0x8847表示MPLS Label。</p><p>在MPLS头里面，首先是标签值占20位，接着是3位实验位，再接下来是1位栈底标志位，表示当前标签是否位于栈底了。这样就允许多个标签被编码到同一个数据包中，形成标签栈。最后是8位TTL存活时间字段，如果标签数据包的出发TTL值为0，那么该数据包在网络中的生命期被认为已经过期了。</p><p>有了标签，还需要设备认这个标签，并且能够根据这个标签转发，这种能够转发标签的路由器称为<strong>标签交换路由器</strong>（LSR，Label Switching Router）。</p><p>这种路由器会有两个表格，一个就是传统的FIB，也即路由表，另一个就是LFIB，标签转发表。有了这两个表，既可以进行普通的路由转发，也可以进行基于标签的转发。</p><p><img src=\"https://static001.geekbang.org/resource/image/66/97/66df10af27dbyycee673dc47667dbb97.jpeg?wh=1920*767\" alt=\"\"></p><p>有了标签转发表，转发的过程如图所示，就不用每次都进行普通路由的查找了。</p><p>这里我们区分MPLS区域和非MPLS区域。在MPLS区域中间，使用标签进行转发，非MPLS区域，使用普通路由转发，在边缘节点上，需要有能力将对于普通路由的转发，变成对于标签的转发。</p><p>例如图中要访问114.1.1.1，在边界上查找普通路由，发现马上要进入MPLS区域了，进去了对应标签1，于是在IP头外面加一个标签1，在区域里面，标签1要变成标签3，标签3到达出口边缘，将标签去掉，按照路由发出。</p><p>这样一个通过标签转换而建立的路径称为LSP，标签交换路径。在一条LSP上，沿数据包传送的方向，相邻的LSR分别叫<strong>上游LSR</strong>（<strong>upstream LSR</strong>）和<strong>下游LSR</strong>（<strong>downstream LSR</strong>）。</p><p>有了标签，转发是很简单的事，但是如何生成标签，却是MPLS中最难修炼的部分。在MPLS秘笈中，这部分被称为<strong>LDP</strong>（<strong>Label Distribution Protocol</strong>），是一个动态的生成标签的协议。</p><p>其实LDP与IP帮派中的路由协议十分相像，通过LSR的交互，互相告知去哪里应该打哪个标签，称为标签分发，往往是从下游开始的。</p><p><img src=\"https://static001.geekbang.org/resource/image/91/67/91cd0038877da8933365494625280b67.jpeg?wh=1920*870\" alt=\"\"></p><p>如果有一个边缘节点发现自己的路由表中出现了新的目的地址，它就要给别人说，我能到达一条新的路径了。</p><p>如果此边缘节点存在上游LSR，并且尚有可供分配的标签，则该节点为新的路径分配标签，并向上游发出标签映射消息，其中包含分配的标签等信息。</p><p>收到标签映射消息的LSR记录相应的标签映射信息，在其标签转发表中增加相应的条目。此LSR为它的上游LSR分配标签，并继续向上游LSR发送标签映射消息。</p><p>当入口LSR收到标签映射消息时，在标签转发表中增加相应的条目。这时，就完成了LSP的建立。有了标签，转发轻松多了，但是这个和VPN什么关系呢？</p><p>可以想象，如果我们VPN通道里面包的转发，都是通过标签的方式进行，效率就会高很多。所以要想个办法把MPLS应用于VPN。</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/ae/eb01c7d748b99bc94017f667eb74caae.jpeg?wh=1920*724\" alt=\"\"></p><p>在MPLS VPN中，网络中的路由器分成以下几类：</p><ul>\n<li>\n<p>PE（Provider Edge）：运营商网络与客户网络相连的边缘网络设备；</p>\n</li>\n<li>\n<p>CE（Customer Edge）：客户网络与PE相连接的边缘设备；</p>\n</li>\n<li>\n<p>P（Provider）：这里特指运营商网络中除PE之外的其他运营商网络设备。</p>\n</li>\n</ul><p>为什么要这样分呢？因为我们发现，在运营商网络里面，也即P Router之间，使用标签是没有问题的，因为都在运营商的管控之下，对于网段，路由都可以自己控制。但是一旦客户要接入这个网络，就复杂得多。</p><p>首先是客户地址重复的问题。客户所使用的大多数都是私网的地址(192.168.X.X;10.X.X.X;172.X.X.X)，而且很多情况下都会与其它的客户重复。</p><p>比如，机构A和机构B都使用了192.168.101.0/24网段的地址，这就发生了地址空间重叠（Overlapping Address Spaces）。</p><p>首先困惑的是BGP协议，既然VPN将两个数据中心连起来，应该看起来像一个数据中心一样，那么如何到达另一端需要通过BGP将路由广播过去，传统BGP无法正确处理地址空间重叠的VPN的路由。</p><p>假设机构A和机构B都使用了192.168.101.0/24网段的地址，并各自发布了一条去往此网段的路由，BGP将只会选择其中一条路由，从而导致去往另一个VPN的路由丢失。</p><p>所以PE路由器之间使用特殊的MP-BGP来发布VPN路由，在相互沟通的消息中，在一般32位IPv4的地址之前加上一个客户标示的区分符用于客户地址的区分，这种称为VPN-IPv4地址族，这样PE路由器会收到如下的消息，机构A的192.168.101.0/24应该往这面走，机构B的192.168.101.0/24则应该去另外一个方向。</p><p>另外困惑的是<strong>路由表</strong>，当两个客户的IP包到达PE的时候，PE就困惑了，因为网段是重复的。</p><p>如何区分哪些路由是属于哪些客户VPN内的？如何保证VPN业务路由与普通路由不相互干扰？</p><p>在PE上，可以通过VRF（VPN Routing&amp;Forwarding Instance）建立每个客户一个路由表，与其它VPN客户路由和普通路由相互区分。可以理解为专属于客户的小路由器。</p><p>远端PE通过MP-BGP协议把业务路由放到近端PE，近端PE根据不同的客户选择出相关客户的业务路由放到相应的VRF路由表中。</p><p>VPN报文转发采用两层标签方式：</p><ul>\n<li>\n<p>第一层（外层）标签在骨干网内部进行交换，指示从PE到对端PE的一条LSP。VPN报文利用这层标签，可以沿LSP到达对端PE；</p>\n</li>\n<li>\n<p>第二层（内层）标签在从对端PE到达CE时使用，在PE上，通过查找VRF表项，指示报文应被送到哪个VPN用户，或者更具体一些，到达哪一个CE。这样，对端PE根据内层标签可以找到转发报文的接口。</p>\n</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/43/1f/43e9ee00e3db2b0cd8315058d38d701f.jpeg?wh=1920*839\" alt=\"\"></p><p>我们来举一个例子，看MPLS VPN的包发送过程。</p><ol>\n<li>\n<p>机构A和机构B都发出一个目的地址为192.168.101.0/24的IP报文，分别由各自的CE将报文发送至PE。</p>\n</li>\n<li>\n<p>PE会根据报文到达的接口及目的地址查找VPN实例表项VRF，匹配后将报文转发出去，同时打上内层和外层两个标签。假设通过MP-BGP配置的路由，两个报文在骨干网走相同的路径。</p>\n</li>\n<li>\n<p>MPLS网络利用报文的外层标签，将报文传送到出口PE，报文在到达出口PE 2前一跳时已经被剥离外层标签，仅含内层标签。</p>\n</li>\n<li>\n<p>出口PE根据内层标签和目的地址查找VPN实例表项VRF，确定报文的出接口，将报文转发至各自的CE。</p>\n</li>\n<li>\n<p>CE根据正常的IP转发过程将报文传送到目的地。</p>\n</li>\n</ol><h2>小结</h2><p>好了，这一节就到这里了，我们来总结一下：</p><ul>\n<li>\n<p>VPN可以将一个机构的多个数据中心通过隧道的方式连接起来，让机构感觉在一个数据中心里面，就像自驾游通过琼州海峡一样；</p>\n</li>\n<li>\n<p>完全基于软件的IPsec VPN可以保证私密性、完整性、真实性、简单便宜，但是性能稍微差一些；</p>\n</li>\n<li>\n<p>MPLS-VPN综合和IP转发模式和ATM的标签转发模式的优势，性能较好，但是需要从运营商购买。</p>\n</li>\n</ul><p>接下来，给你留两个思考题：</p><ol>\n<li>\n<p>当前业务的高可用性和弹性伸缩很重要，所以很多机构都会在自建私有云之外，采购公有云，你知道私有云和公有云应该如何打通吗？</p>\n</li>\n<li>\n<p>前面所有的上网行为，都是基于电脑的，但是移动互联网越来越成为核心，你知道手机上网都需要哪些协议吗？</p>\n</li>\n</ol><p>我们的专栏更新到第22讲，不知你掌握得如何？每节课后我留的思考题，你都有没有认真思考，并在留言区写下答案呢？我会从<strong>已发布的文章中选出一批认真留言的同学</strong>，赠送<span class=\"orange\">学习奖励礼券</span>和我整理的<span class=\"orange\">独家网络协议知识图谱</span>。</p><p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>","neighbors":{"left":{"article_title":"第21讲 | 数据中心：我是开发商，自己拿地盖别墅","id":10098},"right":{"article_title":"第23讲 | 移动网络：去巴塞罗那，手机也上不了脸书","id":10534}},"comments":[{"had_liked":false,"id":89094,"user_name":"徐晨","can_delete":false,"product_type":"c1","uid":1401283,"ip_address":"","ucode":"A55F0E730A562A","user_header":"https://static001.geekbang.org/account/avatar/00/15/61/c3/5f1ec5e5.jpg","comment_is_top":false,"comment_ctime":1556075980,"is_pvip":false,"replies":[{"id":"32035","content":"这个例子太好了，我原来一直想不出一个具体的例子","user_name":"作者回复","comment_id":89094,"uid":"1001590","ip_address":"","utype":1,"ctime":1556195780,"user_name_real":"刘超@网易云"}],"discussion_count":6,"race_medal":0,"score":"937858946508","product_id":100007101,"comment_content":"@Fisher <br>我可以举个例子，比如说我们先约定一种颜色比如黄色（p, q 大质数），这时候我把黄色涂上红色（我的随机数 a）生成新的橙色，你把黄色涂上蓝色（你的随机数 b）生成新的绿色。这时候我们交换橙色和绿色，然后我再在绿色上加上红色生成棕色，同样你拿到橙色后加上蓝色也生成棕色。这就是最终的密钥了。如果有人在中间窃取的话，他只能拿到橙色和绿色，是拿不到最终的密钥棕色的。","like_count":219,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448014,"discussion_content":"这个例子太好了，我原来一直想不出一个具体的例子","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556195780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1464592,"avatar":"https://static001.geekbang.org/account/avatar/00/16/59/10/c0d24978.jpg","nickname":"春风和煦","note":"","ucode":"4E2769BDD73291","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":162238,"discussion_content":"这例子是网易云课堂可汗学院里面的现代密码学讲的，里面还有相应的数学原理，视频很短，很形象，推荐看看","likes_number":18,"is_delete":false,"is_hidden":false,"ctime":1580975922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113587,"avatar":"https://static001.geekbang.org/account/avatar/00/10/fd/f3/77223a8c.jpg","nickname":"清新灬小柠檬","note":"","ucode":"F3004F2F385096","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6190,"discussion_content":"厉害，因为都会用到黄蓝绿，所以最终颜色必定一样","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1566778463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338637,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6d/0d/71053329.jpg","nickname":"il李li","note":"","ucode":"2193A7E41DEC68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283478,"discussion_content":"这里的一个关键点是如果中间人拿到黄色（p，q大质数）和橙色是反推不出来随机数a的。还有仅依靠DH算法存在中间人攻击的风险，还需要引入身份认证机制确保通信双方身份的合法性","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1592280049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2087245,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/d9/4d/02dbb871.jpg","nickname":"Ks🦁","note":"","ucode":"2D8DE2AFC7BEE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307427,"discussion_content":"数学公式本就很简单。你可能搞不懂这个数学公式为啥是这样，但是本身比这些举例好理解很多","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600648829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1655117,"avatar":"https://static001.geekbang.org/account/avatar/00/19/41/4d/f6d6d13a.jpg","nickname":"啊良梓是我","note":"","ucode":"E42FC1A60D331C","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360594,"discussion_content":"问题来了  黄色我拿到了呢，我完全可以尝试用一个真连接去拿到质数，假如这个质数不是每次都更换的话","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616483460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15120,"user_name":"赵强强","can_delete":false,"product_type":"c1","uid":1073596,"ip_address":"","ucode":"1B8AE07484C69A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/bc/88a905a5.jpg","comment_is_top":false,"comment_ctime":1530880175,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"345128263855","product_id":100007101,"comment_content":"近期两节内容跳跃好厉害，跟不上了😁 ","like_count":80,"discussions":[{"author":{"id":1647133,"avatar":"","nickname":"Corn","note":"","ucode":"BE934468BAB652","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267950,"discussion_content":"最近兩期都要來回看的三遍才稍微懂一點點 ><","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589716504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1541386,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","nickname":"N_H","note":"","ucode":"109B67557AB3CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3873,"discussion_content":"最近两期太专业了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564907029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15413,"user_name":"lovelife","can_delete":false,"product_type":"c1","uid":1031745,"ip_address":"","ucode":"AC39E599A53448","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/41/e3ece193.jpg","comment_is_top":false,"comment_ctime":1531182594,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"190509743618","product_id":100007101,"comment_content":"公有云和私有云之间打通主要通过两种方式，一种是专线，这个需要跟运营商购买，而且需要花时间搭建。一种是VPN, VPN包括今天说的IPSec VPN和MPLS VPN。这个还需要在公有云厂商那边购买VPN网关，将其和私有云的网关联通","like_count":45},{"had_liked":false,"id":19470,"user_name":"Liutsing","can_delete":false,"product_type":"c1","uid":1038418,"ip_address":"","ucode":"CCDED60304D0BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d8/52/034eb0f1.jpg","comment_is_top":false,"comment_ctime":1533860254,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"48778500510","product_id":100007101,"comment_content":"能讲讲VPN跟ngrok内网穿透的区别么？","like_count":11,"discussions":[{"author":{"id":1167803,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d1/bb/617fbffa.jpg","nickname":"冰封飞飞","note":"","ucode":"D9675F479A746F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388091,"discussion_content":"ngork应该是基于传输层的，你只能将某一个服务穿透出去。 VPN是IP层，相当于将你接入对方的内网里面，相当于直接在内网访问一样。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1628585501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1248326,"avatar":"https://static001.geekbang.org/account/avatar/00/13/0c/46/dfe32cf4.jpg","nickname":"多选参数","note":"","ucode":"B2294D80AB075F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399539,"discussion_content":"一个感觉更多是在做代理，一个是直接从 IP 层打通","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632987779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15170,"user_name":"Fisher","can_delete":false,"product_type":"c1","uid":1138887,"ip_address":"","ucode":"F3063BCEBC9F14","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/c7/a147b71b.jpg","comment_is_top":false,"comment_ctime":1530949526,"is_pvip":false,"replies":[{"id":"5113","content":"不可以的，私钥截获不到","user_name":"作者回复","comment_id":15170,"uid":"1001590","ip_address":"","utype":1,"ctime":1530981818,"user_name_real":"刘超@网易云"}],"discussion_count":2,"race_medal":0,"score":"44480622486","product_id":100007101,"comment_content":"花了两个小时做了笔记，除了最后的 MPLS VPN前面的基本都理解了<br><br>有一个问题，在 DH 算法生成对称密钥 K 的时候，需要交换公开质数 pq 然后生成公钥 AB，交换 AB 生成密钥 K<br><br>这个交换过程虽然没有直接交换密钥，但是如果我是个中间人，拿到了所有的材料，我也是可以生成同样的密钥的吧？那这样怎么保证安全性？还是说我理解的不对，这个过程没法出现中间人？希望老师能够解答一下<br><br>做的笔记：https:&#47;&#47;mubu.com&#47;doc&#47;1cZYndRrAg","like_count":10,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420267,"discussion_content":"不可以的，私钥截获不到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530981818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2708370,"avatar":"https://static001.geekbang.org/account/avatar/00/29/53/92/21c78176.jpg","nickname":"小黄鸭","note":"","ucode":"2800E3A723AEBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553378,"discussion_content":"感谢笔记","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645867975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97166,"user_name":"起风了001","can_delete":false,"product_type":"c1","uid":1529929,"ip_address":"","ucode":"8DCDBA40B8CC9F","user_header":"","comment_is_top":false,"comment_ctime":1558600584,"is_pvip":false,"replies":[{"id":"49255","content":"两个的作用不一样，证书是证明非对称秘钥的证明","user_name":"作者回复","comment_id":97166,"uid":"1001590","ip_address":"","utype":1,"ctime":1567607785,"user_name_real":"刘超@网易云"}],"discussion_count":4,"race_medal":0,"score":"40213306248","product_id":100007101,"comment_content":"我有一个问题, 就是私钥交换协议这么厉害,为什么不在HTTPS协议上也加入这个呢? 这样就不需要证书了呀?","like_count":9,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451160,"discussion_content":"两个的作用不一样，证书是证明非对称秘钥的证明","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567607785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1136684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","nickname":"易轻尘","note":"","ucode":"0D0CB9D6D45A70","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":103811,"discussion_content":"https那里交换对称密钥也是用的DH算法；证书的存在是为了防止中间人攻击","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1577387010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1312644,"avatar":"","nickname":"容若","note":"","ucode":"902863F0B1B921","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":46192,"discussion_content":"证书可以证明和你通信的人是正确的，如果和你进行私钥交换协议的是坏人怎么办？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1573129544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1142025,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6d/09/ffeabc27.jpg","nickname":"任鑫","note":"","ucode":"9803EB15B634C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":183997,"discussion_content":"证书一般是需要权威机构颁发的，相当于引入一个可信的第三方","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582537978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54454,"user_name":"谢真","can_delete":false,"product_type":"c1","uid":1124650,"ip_address":"","ucode":"8C3402DE107C9F","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/2a/9079f152.jpg","comment_is_top":false,"comment_ctime":1545874135,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23020710615","product_id":100007101,"comment_content":"这篇文章讲的太好了，信息量很大，非常解惑，以前只知道概念，不知道有什么用，现在知道协议的由来了","like_count":5},{"had_liked":false,"id":15067,"user_name":"favorlm","can_delete":false,"product_type":"c1","uid":1120997,"ip_address":"","ucode":"CFD52127AA6E1D","user_header":"https://static001.geekbang.org/account/avatar/00/11/1a/e5/6899701e.jpg","comment_is_top":false,"comment_ctime":1530840494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23005676974","product_id":100007101,"comment_content":"1通过路由端口映射，或者vpn<br>2.移动端上网需要gprs协议层","like_count":5},{"had_liked":false,"id":15054,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1530838068,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"23005674548","product_id":100007101,"comment_content":"老师，独家网络协议图，大家都需要啊。 公有云与私有云 还是用 Mpls 。","like_count":5},{"had_liked":false,"id":15061,"user_name":"我是谁","can_delete":false,"product_type":"c1","uid":1073487,"ip_address":"","ucode":"D6C67E29D62EA9","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/4f/e0b71e72.jpg","comment_is_top":false,"comment_ctime":1530839793,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18710708977","product_id":100007101,"comment_content":"感觉越来越难了，没办法多看几遍吧","like_count":5},{"had_liked":false,"id":203424,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1324863,"ip_address":"","ucode":"FFC31A3FE3A285","user_header":"https://static001.geekbang.org/account/avatar/00/14/37/3f/a9127a73.jpg","comment_is_top":false,"comment_ctime":1586187946,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"14471089834","product_id":100007101,"comment_content":"就是一个VPN，居然有这么复杂的交互在里面。真的涨姿势啦。","like_count":3},{"had_liked":false,"id":128809,"user_name":"咩咩咩","can_delete":false,"product_type":"c1","uid":1237849,"ip_address":"","ucode":"9DEC7D5D52D972","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/6a8fRQFxX5VXOpRKyYibsemKwDMexMxkzZOBquPo6T4HOcYicBiaTcqibDoTIhZSjVjF3nKXTEGDYOGPt2xqqwiawjg/132","comment_is_top":false,"comment_ctime":1566966807,"is_pvip":false,"replies":[{"id":"48755","content":"一样的，都是隧道","user_name":"作者回复","comment_id":128809,"uid":"1001590","ip_address":"","utype":1,"ctime":1567494392,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"14451868695","product_id":100007101,"comment_content":"想弱弱问一下:文中VPN和平时说的挂个VPN翻墙是两个不同的概念吗","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465114,"discussion_content":"一样的，都是隧道","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567494392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90150,"user_name":"珠闪闪","can_delete":false,"product_type":"c1","uid":1300447,"ip_address":"","ucode":"45BE0D586A3839","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eov38ZkwCyNoBdr5drgX0cp2eOGCv7ibkhUIqCvcnFk8FyUIS6K4gHXIXh0fu7TB67jaictdDlic4OwQ/132","comment_is_top":false,"comment_ctime":1556433021,"is_pvip":false,"replies":[{"id":"49525","content":"哦，搭建vpn没有讲的，不过网上有很多这种文章的","user_name":"作者回复","comment_id":90150,"uid":"1001590","ip_address":"","utype":1,"ctime":1567680252,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"14441334909","product_id":100007101,"comment_content":"看的有些懵。意图是来了解一下VPN如何连接丝网和公网连接的技术，老师直接讲到报文层次，没有太多的介绍网络如何打通进行业务传输。同求老师如何这么深刻理解这些网络技术的，感叹跟老师的差距真实望尘莫及~","like_count":3,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448407,"discussion_content":"哦，搭建vpn没有讲的，不过网上有很多这种文章的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567680252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52414,"user_name":"William","can_delete":false,"product_type":"c1","uid":1241365,"ip_address":"","ucode":"4499F99B180102","user_header":"https://static001.geekbang.org/account/avatar/00/12/f1/15/8fcf8038.jpg","comment_is_top":false,"comment_ctime":1545378177,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"14430280065","product_id":100007101,"comment_content":"请问老师打标签的方式为什么比查路由快?打标签每跳路由器还得写数据包，查路由表查找到之后转发出去就行了。","like_count":3},{"had_liked":false,"id":30167,"user_name":"李博越","can_delete":false,"product_type":"c1","uid":1027808,"ip_address":"","ucode":"E6CDA0CDC0BCE6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/e0/3e636955.jpg","comment_is_top":false,"comment_ctime":1538710260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14423612148","product_id":100007101,"comment_content":"最近用minikube本地搭建个环境玩玩，发现了很多镜像pull超时的问题，我把本地iterm设置了socks5代理以后，手工pull镜像还是失败：<br>➜  ~ minikube ssh -- docker pull k8s.gcr.io&#47;pause-amd64:3.1<br>Error response from daemon: Get https:&#47;&#47;k8s.gcr.io&#47;v2&#47;: net&#47;http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)<br>尝试curl看看代理是否成功：<br>➜  ~ curl -ik &quot;https:&#47;&#47;k8s.gcr.io&#47;v2&#47;&quot;<br>HTTP&#47;1.1 200 Connection established<br>尝试ping，却ping不通k8s.gcr.io域名<br>➜  ~ ping k8s.gcr.io<br>PING googlecode.l.googleusercontent.com (64.233.189.82): 56 data bytes<br>Request timeout for icmp_seq 0<br>Request timeout for icmp_seq 1<br>Request timeout for icmp_seq 2<br><br>查了下socks5应该是属于会话层的，而icmp是三层协议，因此ping没有走代理所以翻不了墙，然后curl走应用层因此被代理了所以返回200，但是为啥执行minikube ssh -- docker pull k8s.gcr.io&#47;pause-amd64:3.1拉不下来镜像呢？","like_count":3},{"had_liked":false,"id":20177,"user_name":"楚人","can_delete":false,"product_type":"c1","uid":1136791,"ip_address":"","ucode":"A25527A14BBD6C","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/97/8e14e7d0.jpg","comment_is_top":false,"comment_ctime":1534298337,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14419200225","product_id":100007101,"comment_content":"老师能简单介绍一下专线吗？专线架设等","like_count":4},{"had_liked":false,"id":15308,"user_name":"A7","can_delete":false,"product_type":"c1","uid":1139012,"ip_address":"","ucode":"3181456C2BB8F7","user_header":"https://static001.geekbang.org/account/avatar/00/11/61/44/66cd6f3f.jpg","comment_is_top":false,"comment_ctime":1531101015,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"14416002903","product_id":100007101,"comment_content":"终于开始上难度了","like_count":3},{"had_liked":false,"id":154360,"user_name":"teddytyy","can_delete":false,"product_type":"c1","uid":1268738,"ip_address":"","ucode":"E1569D81A4154E","user_header":"https://static001.geekbang.org/account/avatar/00/13/5c/02/e7af1750.jpg","comment_is_top":false,"comment_ctime":1574415082,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10164349674","product_id":100007101,"comment_content":"既然密钥传输是可行的，那https为啥不直接用对称加密？","like_count":2,"discussions":[{"author":{"id":2352021,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e3/95/bc8241d9.jpg","nickname":"剁手","note":"","ucode":"0925A8C7782A99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338671,"discussion_content":"https 先使用证书传递公钥，通过公钥建立非对称密钥链接交换对称密钥，然后才是使用对称密钥进行的数据通信。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609335634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1136684,"avatar":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","nickname":"易轻尘","note":"","ucode":"0D0CB9D6D45A70","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":103812,"discussion_content":"https那里交换对称密钥也是用的DH算法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577387054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":91220,"user_name":"大旗","can_delete":false,"product_type":"c1","uid":1050733,"ip_address":"","ucode":"6A8177F0A15BC2","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIa4aLtpt1wiagBzKGKicQX3KyaulgVzmIdaSj38yYWXPBpK5gjw7Gp4EicTzq34R6raTh1ftAXBHqNA/132","comment_is_top":false,"comment_ctime":1556935860,"is_pvip":false,"replies":[{"id":"49488","content":"没研究过SDW ","user_name":"作者回复","comment_id":91220,"uid":"1001590","ip_address":"","utype":1,"ctime":1567675297,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":0,"score":"10146870452","product_id":100007101,"comment_content":"SDW 和MPLS的区别在哪里呢？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448848,"discussion_content":"没研究过SDW ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567675297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83500,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1554628326,"is_pvip":false,"replies":[{"id":"49892","content":"隧道里面，也可以看成一个局域网","user_name":"作者回复","comment_id":83500,"uid":"1001590","ip_address":"","utype":1,"ctime":1567781087,"user_name_real":"刘超@网易云"}],"discussion_count":1,"race_medal":2,"score":"10144562918","product_id":100007101,"comment_content":"IPSec在隧道模式下，新IP地址的如何加上去的呢？","like_count":2,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446050,"discussion_content":"隧道里面，也可以看成一个局域网","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567781087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283515,"user_name":"我是谁","can_delete":false,"product_type":"c1","uid":1131907,"ip_address":"","ucode":"AE3996142811F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/45/83/93d389ba.jpg","comment_is_top":false,"comment_ctime":1615803071,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5910770367","product_id":100007101,"comment_content":"有个问题哈<br><br>已知p、q和 算法q^a mod p（q^b mod p）不就可以反推a和b了吗？","like_count":1,"discussions":[{"author":{"id":1289998,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKWbibp27BTaUaB9Buib6VLKer2ahSZEhCjdibdtIfA9ricyYE3A7m1wicZzsUMmXtGnGqthwPibic81CiaxA/132","nickname":"kxmm","note":"","ucode":"81183868986F68","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571013,"discussion_content":"哈哈，因为要求使用的数字很大，要反推出来很难，这是数学界的一个难题！  如果能够快速反推出来，就在数学界获奖了。\n就是因为反推出来太难了（可以认为运算量太大，在有限的时间内反推不出来），所以这个算法的实现选择了使用这个数学方法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652034118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262833,"user_name":"响雨","can_delete":false,"product_type":"c1","uid":1581705,"ip_address":"","ucode":"C5FB3A3BC68F92","user_header":"https://static001.geekbang.org/account/avatar/00/18/22/89/73397ccb.jpg","comment_is_top":false,"comment_ctime":1605856132,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5900823428","product_id":100007101,"comment_content":"私有地址可能重复的问题，不是有NAT转化吗？","like_count":1,"discussions":[{"author":{"id":1260141,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","nickname":"Wheat","note":"","ucode":"7D99EA149B6DE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349942,"discussion_content":"老师讲复杂了，我刚才查了一下，VRF就相当于NAT的作用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613636959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251017,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1601308347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5896275643","product_id":100007101,"comment_content":"老师 可以讲下SSL VPN 隧道内部的报文封装细节吗 ？源IP： 物理设备IP  ,目的IP： VPN 虚拟站点IP    , port :443       以太网卡---&gt;IP--&gt;TCP---&gt;HTTP  .      以太网卡----IP----&gt;ICMP  ,建立VPN后，隧道内部报文是怎么封装的 ，没抓到包","like_count":1},{"had_liked":false,"id":176933,"user_name":"倡印","can_delete":false,"product_type":"c1","uid":1455958,"ip_address":"","ucode":"4F53AA5D017D89","user_header":"https://static001.geekbang.org/account/avatar/00/16/37/56/11068390.jpg","comment_is_top":false,"comment_ctime":1581230981,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5876198277","product_id":100007101,"comment_content":"DH算法加密不用在Https是不是因为加密等级不够很容易破解？？？？","like_count":1},{"had_liked":false,"id":170681,"user_name":"Ruter","can_delete":false,"product_type":"c1","uid":1588266,"ip_address":"","ucode":"B6A4C52E33504F","user_header":"https://static001.geekbang.org/account/avatar/00/18/3c/2a/446d7a1f.jpg","comment_is_top":false,"comment_ctime":1578663660,"is_pvip":false,"replies":[{"id":"66270","content":"加油，后面会越来越干货","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1578823338,"ip_address":"","comment_id":170681,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5873630956","product_id":100007101,"comment_content":"老师讲的专业啊，感觉越来越难了，但是也得说这课买的太直了。","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481064,"discussion_content":"加油，后面会越来越干货","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578823338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159617,"user_name":"flow","can_delete":false,"product_type":"c1","uid":1270302,"ip_address":"","ucode":"B482ACF0E413C7","user_header":"https://static001.geekbang.org/account/avatar/00/13/62/1e/ad721e61.jpg","comment_is_top":false,"comment_ctime":1575707623,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5870674919","product_id":100007101,"comment_content":"IPsec的内部ip头和外部ip头有什么区别呢? 为什么内部ip也要加密?","like_count":1},{"had_liked":false,"id":101821,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1559983569,"is_pvip":false,"replies":[{"id":"49176","content":"最后有的","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567598223,"ip_address":"","comment_id":101821,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5854950865","product_id":100007101,"comment_content":"跟不上了，多看几遍  需要老师的知识图谱","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453129,"discussion_content":"最后有的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567598223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":44404,"user_name":"vic","can_delete":false,"product_type":"c1","uid":1258236,"ip_address":"","ucode":"6C59A40DF9310A","user_header":"https://static001.geekbang.org/account/avatar/00/13/32/fc/5d901185.jpg","comment_is_top":false,"comment_ctime":1543421963,"is_pvip":false,"replies":[{"id":"16037","content":"一个长期，一个短期","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1543542970,"ip_address":"","comment_id":44404,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5838389259","product_id":100007101,"comment_content":"既然有对称密钥M为何还要生成对称密钥K来做加密传输？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430749,"discussion_content":"一个长期，一个短期","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543542970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1274457,"avatar":"https://static001.geekbang.org/account/avatar/00/13/72/59/1a932daf.jpg","nickname":"阿拉D","note":"","ucode":"CCED5B38E3B092","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7886,"discussion_content":"我的理解是：虽然有密钥K，但是生成K的材料还是暴露过，存在风险。而密钥M是完全未暴露过的。再加上M短期换一次，K长期换一次。想要破解，我觉得很难。（不知道分析的对嘛，求老师看见）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567697711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37375,"user_name":"扬～","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1541561104,"is_pvip":false,"replies":[{"id":"13440","content":"标签简单，属于直接匹配型的，甚至可以用硬件实现，路由表算法复杂，要最长匹配，每个都要算cidr","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1541596766,"ip_address":"","comment_id":37375,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5836528400","product_id":100007101,"comment_content":"IP转发是查路由表，标签转发是查标签表，为什么说标签转发就比路由表快呢？  <br>还有我一直不明白的是当访问一个网址的时候，一般给的都是公有地址。何时我们才能获得要访问的是私有地址呢","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428316,"discussion_content":"标签简单，属于直接匹配型的，甚至可以用硬件实现，路由表算法复杂，要最长匹配，每个都要算cidr","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541596766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15368,"user_name":"why","can_delete":false,"product_type":"c1","uid":1012937,"ip_address":"","ucode":"C9E796E53F6F5E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/74/c9/d3439ca4.jpg","comment_is_top":false,"comment_ctime":1531145596,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5826112892","product_id":100007101,"comment_content":"1. 为什么 ESP 头部之后还会再封装一个 IP头？<br>2. MPLS VPN 是否也是通过 IKE 和 SA 来保证内容的安全，只是相对应 ipsec 有更稳定的传输路径？","like_count":1},{"had_liked":false,"id":15228,"user_name":"赵强强","can_delete":false,"product_type":"c1","uid":1073596,"ip_address":"","ucode":"1B8AE07484C69A","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/bc/88a905a5.jpg","comment_is_top":false,"comment_ctime":1531018984,"is_pvip":false,"replies":[{"id":"5160","content":"是的，在讲https的时候也说过原来的效率比较低，请参考最新ssl","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1531101002,"ip_address":"","comment_id":15228,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5825986280","product_id":100007101,"comment_content":"刘老师您好，我有两个疑问。1、讲解HTTPS章节的时候介绍过对称密钥的生成方法，和本节的生成方法不同，就是说对称密钥有多种生成方法吗？为什么不采用一样的呢？2、本节的对称密钥K和M，文中介绍防止被破解，会定期更新M，哪如何防止K被破解呢？","like_count":1,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420294,"discussion_content":"是的，在讲https的时候也说过原来的效率比较低，请参考最新ssl","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531101002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15119,"user_name":"梦想启动的蜗牛","can_delete":false,"product_type":"c1","uid":1111602,"ip_address":"","ucode":"781F2A6DA6FEB3","user_header":"https://static001.geekbang.org/account/avatar/00/10/f6/32/358f9411.jpg","comment_is_top":false,"comment_ctime":1530878983,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5825846279","product_id":100007101,"comment_content":"太复杂了，直接看蒙。。。","like_count":1},{"had_liked":false,"id":354903,"user_name":"Geek_93970d","can_delete":false,"product_type":"c1","uid":1452167,"ip_address":"北京","ucode":"52AC308BEC7737","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcwXucibksEYRSYg6icjibzGa7efcMrCsGec2UwibjTd57icqDz0zzkEEOM2pXVju60dibzcnQKPfRkN9g/132","comment_is_top":false,"comment_ctime":1660875271,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660875271","product_id":100007101,"comment_content":"&quot;在 PE 上，可以通过 VRF（VPN Routing&amp;Forwarding Instance）建立每个客户一个路由表，与其它 VPN 客户路由和普通路由相互区分。可以理解为专属于客户的小路由器。&quot;<br>那么，问题来了，同一个用户的两个数据中心要是有地址空间重叠，还能用 vpn 通信吗？","like_count":0},{"had_liked":false,"id":351232,"user_name":"| ~浑蛋~","can_delete":false,"product_type":"c1","uid":3024820,"ip_address":"","ucode":"B6904B44DFA805","user_header":"https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg","comment_is_top":false,"comment_ctime":1657625199,"is_pvip":true,"discussion_count":0,"race_medal":3,"score":"1657625199","product_id":100007101,"comment_content":"逐渐看不懂系例+1","like_count":0},{"had_liked":false,"id":342158,"user_name":"Geek_2446b7","can_delete":false,"product_type":"c1","uid":2170391,"ip_address":"","ucode":"4DCEDA37F9F6AA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKTAKspiaW6t3IWicYjIfyRskFYibBauMW79vhXWI6CNj0L7jmQs1X9wZg8pricNQWNHXGFzw2ibQkAKtA/132","comment_is_top":false,"comment_ctime":1650075134,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1650075134","product_id":100007101,"comment_content":"最开始几章看到有人留言说老师用的比喻太多了，导致阅读体验下降，当时的也有同感。然而从这一章上难度（或者说这部分知识比较陌生）开始发现比喻确实挺有用的，而之前只是因为当时那部分知识可能自己相对熟悉一些。","like_count":0},{"had_liked":false,"id":341778,"user_name":"半点茶凉","can_delete":false,"product_type":"c1","uid":2520742,"ip_address":"","ucode":"188BB33969D2D2","user_header":"https://static001.geekbang.org/account/avatar/00/26/76/a6/aac72751.jpg","comment_is_top":false,"comment_ctime":1649830717,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649830717","product_id":100007101,"comment_content":"看过后，有如下两个问题<br>1. 在IPSec建立IKE之前，如何进行身份认证的？又是如何确保身份认证的信息是保密的呢？<br>2. IPSec VPN中对于源数据，比如源ip头和源tcp头都是加密的，那么napt路由如何做路由转发呢？","like_count":0},{"had_liked":false,"id":333463,"user_name":"刘玉琪","can_delete":false,"product_type":"c1","uid":2400676,"ip_address":"","ucode":"9CAFC96E725F12","user_header":"https://static001.geekbang.org/account/avatar/00/24/a1/a4/4def335a.jpg","comment_is_top":false,"comment_ctime":1644374511,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644374511","product_id":100007101,"comment_content":"即使使用 https，走公网也是不太安全的是吗？","like_count":0},{"had_liked":false,"id":307991,"user_name":"Allan","can_delete":false,"product_type":"c1","uid":1310388,"ip_address":"","ucode":"8DA4DBECC2C45C","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/b4/295338e7.jpg","comment_is_top":false,"comment_ctime":1629352479,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629352479","product_id":100007101,"comment_content":"课后题不是思考不思考的问题，是这东西也不会，思考脑子也没东西，只能百度一下只是知道了。然后怎么用，实际怎么操作？还是要结合实际操作，最后来个练习才会更明白。","like_count":0},{"had_liked":false,"id":288588,"user_name":"Geek_8e9e8d","can_delete":false,"product_type":"c1","uid":2525365,"ip_address":"","ucode":"CAF4056275B00E","user_header":"","comment_is_top":false,"comment_ctime":1618552602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618552602","product_id":100007101,"comment_content":"请问ipsec中是如何对数据来源进行验证的？","like_count":0},{"had_liked":false,"id":216550,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1589281437,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589281437","product_id":100007101,"comment_content":"看了两遍看明白了,最后的两层标签的概念,一个用于解决在其中P内部分发的路径问题,解决了BGP问题<br>一个解决了边缘网络交换的问题,知道该往边缘哪个上面发送","like_count":0},{"had_liked":false,"id":199117,"user_name":"wsjx","can_delete":false,"product_type":"c1","uid":1039932,"ip_address":"","ucode":"5A89612ADF71CD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/de/3c/b1fe1f52.jpg","comment_is_top":false,"comment_ctime":1585478950,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585478950","product_id":100007101,"comment_content":"VPN靠谱又便宜的不好找","like_count":0},{"had_liked":false,"id":198252,"user_name":"Geek_f0bd6b","can_delete":false,"product_type":"c1","uid":1905495,"ip_address":"","ucode":"54C2BD14F77F72","user_header":"","comment_is_top":false,"comment_ctime":1585438956,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585438956","product_id":100007101,"comment_content":"私有云和公有云之间可以用专线或者VPN，考虑到安全性和私密性，VPN的选择中我觉得应该是IPSec","like_count":0},{"had_liked":false,"id":194455,"user_name":"King-ZJ","can_delete":false,"product_type":"c1","uid":1915385,"ip_address":"","ucode":"7448A4BBB5A118","user_header":"https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg","comment_is_top":false,"comment_ctime":1585060552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585060552","product_id":100007101,"comment_content":"这一节的IPSec VPN是之前对安全内容理解的一个缺漏，通过老师对其报文结构和整个VPN中的协议族各个协议作用的解析，更加接近了这个知识点。在以后的应用和学习中，能更加去亲近它吧。后面的MPLS VPN是IP和ATM集成的产物，这段历史是没有了解过的，同时为了解决地址重叠和租户的互通，引入了RD和RT、VRF，真是很奇妙。","like_count":0},{"had_liked":false,"id":180191,"user_name":"belongcai蔡炳榕","can_delete":false,"product_type":"c1","uid":1047677,"ip_address":"","ucode":"2196D413FEABA3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/7d/800888a3.jpg","comment_is_top":false,"comment_ctime":1582207595,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582207595","product_id":100007101,"comment_content":"说公网可能不太安全，那么用HTTPS加密后还是这样吗？<br>为什么要采取VPN呢？<br>我百度了一下，说是有认证机制？ 但是还是很费解， 希望得到解答 ","like_count":0},{"had_liked":false,"id":175281,"user_name":"猫头鹰波波","can_delete":false,"product_type":"c1","uid":1019787,"ip_address":"","ucode":"573AC477FA869C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/8b/9080f1fa.jpg","comment_is_top":false,"comment_ctime":1580642431,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580642431","product_id":100007101,"comment_content":"老师，我们平时买的VPN是基于IPsec VPN还是基于MPLS-VPN的啊","like_count":0},{"had_liked":false,"id":131067,"user_name":"zKerry","can_delete":false,"product_type":"c1","uid":1497740,"ip_address":"","ucode":"9FB006D1A38D3F","user_header":"","comment_is_top":false,"comment_ctime":1567624128,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567624128","product_id":100007101,"comment_content":"这章对DH密钥交换算法的解释，是网络上所有相关文章中最清楚的。","like_count":0},{"had_liked":false,"id":80812,"user_name":"Untitled","can_delete":false,"product_type":"c1","uid":1039464,"ip_address":"","ucode":"8DD6ABA3E81A2E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/68/006ba72c.jpg","comment_is_top":false,"comment_ctime":1553737123,"is_pvip":false,"replies":[{"id":"50129","content":"不是其他运营商，而是其他设备。就是运营商的设备分PE设备和其他设备。<br><br>","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1567824007,"ip_address":"","comment_id":80812,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1553737123","product_id":100007101,"comment_content":"P（Provider）：这里特指运营商网络中除 PE 之外的其他运营商网络设备<br><br>这句话怎么理解为：P就是公网外除PE的其他路由设备，即包括相同运营商，也包括其他运营商。<br>但是下文又理解为是同一个运营商的网络设备，求解释一下~","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444986,"discussion_content":"不是其他运营商，而是其他设备。就是运营商的设备分PE设备和其他设备。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567824007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80133,"user_name":"天使也有爱","can_delete":false,"product_type":"c1","uid":1368010,"ip_address":"","ucode":"3CCB7C47A0919E","user_header":"https://static001.geekbang.org/account/avatar/00/14/df/ca/7c223fce.jpg","comment_is_top":false,"comment_ctime":1553609119,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553609119","product_id":100007101,"comment_content":"前面基础的还可以看得懂，最近几节课看得有点懵，很多概念是新接触的，很懵逼","like_count":0},{"had_liked":false,"id":64608,"user_name":"roaming","can_delete":false,"product_type":"c1","uid":1039232,"ip_address":"","ucode":"2736679690AB81","user_header":"https://static001.geekbang.org/account/avatar/00/0f/db/80/6b7629d7.jpg","comment_is_top":false,"comment_ctime":1548834971,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548834971","product_id":100007101,"comment_content":"这节内容干货满满，就是没讲到L2TP","like_count":0},{"had_liked":false,"id":64414,"user_name":"bboot9001","can_delete":false,"product_type":"c1","uid":1001684,"ip_address":"","ucode":"1BFAA7CED00804","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/d4/755f058b.jpg","comment_is_top":false,"comment_ctime":1548771341,"is_pvip":false,"replies":[{"id":"25950","content":"封装包到vpn隧道里面","user_name":"作者回复","user_name_real":"刘超@网易云","uid":"1001590","ctime":1551437577,"ip_address":"","comment_id":64414,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548771341","product_id":100007101,"comment_content":"你好老师 能解释一下 vpn客户端依赖的虚拟网卡的作用吗？","like_count":0,"discussions":[{"author":{"id":1001590,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/48/76/0c7d4d23.jpg","nickname":"刘超","note":"","ucode":"196BF3F499E8FE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437988,"discussion_content":"封装包到vpn隧道里面","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551437577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51815,"user_name":"Wisdom","can_delete":false,"product_type":"c1","uid":1098980,"ip_address":"","ucode":"0787F954B66E93","user_header":"https://static001.geekbang.org/account/avatar/00/10/c4/e4/81ee2d8f.jpg","comment_is_top":false,"comment_ctime":1545266720,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1545266720","product_id":100007101,"comment_content":"Openvpn 的协议能讲讲吗","like_count":0},{"had_liked":false,"id":41755,"user_name":"刘宗尧","can_delete":false,"product_type":"c1","uid":1009476,"ip_address":"","ucode":"3E10A471C9177D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/44/1d63fc03.jpg","comment_is_top":false,"comment_ctime":1542848955,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542848955","product_id":100007101,"comment_content":"有点难度","like_count":0},{"had_liked":false,"id":15949,"user_name":"Yaqi","can_delete":false,"product_type":"c1","uid":1130894,"ip_address":"","ucode":"2622AA8F0E8379","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/8e/2d477f16.jpg","comment_is_top":false,"comment_ctime":1531679461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531679461","product_id":100007101,"comment_content":"看完最新更新后打算再从头看一遍 梳理一下。老师知识图谱很需要啊","like_count":0},{"had_liked":false,"id":15337,"user_name":"summer","can_delete":false,"product_type":"c1","uid":1103386,"ip_address":"","ucode":"A57684B7A90129","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/1a/532f8a66.jpg","comment_is_top":false,"comment_ctime":1531129624,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531129624","product_id":100007101,"comment_content":"私有云和公有云的联通方法应该包括：VPN和专线","like_count":0},{"had_liked":false,"id":15265,"user_name":"朱显杰","can_delete":false,"product_type":"c1","uid":1072683,"ip_address":"","ucode":"F7B8258B941D9D","user_header":"https://static001.geekbang.org/account/avatar/00/10/5e/2b/df3983e2.jpg","comment_is_top":false,"comment_ctime":1531058990,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1531058990","product_id":100007101,"comment_content":"私有云和公有云的互联可以通过裸光纤或MSTP专线","like_count":0},{"had_liked":false,"id":15155,"user_name":"易轻尘","can_delete":false,"product_type":"c1","uid":1136684,"ip_address":"","ucode":"0D0CB9D6D45A70","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg","comment_is_top":false,"comment_ctime":1530936880,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1530936880","product_id":100007101,"comment_content":"第一个问题，<br>私有云可以通过公网ip直接访问公有云。公有云访问私有云应该可以通过vpn连接进行。<br><br>-------<br>看了三遍终于梳理清楚了。好想知道作者怎么记住这一大堆的英文缩写的。。","like_count":0},{"had_liked":false,"id":15118,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1530877716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530877716","product_id":100007101,"comment_content":"真是越来越复杂了啊 有点跟不上了","like_count":0},{"had_liked":false,"id":15096,"user_name":"有铭","can_delete":false,"product_type":"c1","uid":1046302,"ip_address":"","ucode":"2C7CB36CA5C04C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","comment_is_top":false,"comment_ctime":1530857737,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530857737","product_id":100007101,"comment_content":"中间那段传输协议太复杂了，人看懵逼了","like_count":0},{"had_liked":false,"id":15087,"user_name":"蓝色理想","can_delete":false,"product_type":"c1","uid":1015043,"ip_address":"","ucode":"43C8D83DC19A17","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/03/4e71c307.jpg","comment_is_top":false,"comment_ctime":1530847679,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530847679","product_id":100007101,"comment_content":"问题1内云外云通过vpn或者内外网的ip连接吧！<br>问题2移动网络应该过了个gsm和gprs协议☺<br>老师我也要图谱<br>另外越听越懵，好多知识点都没接触过，感觉我一个小开发只需要搞懂传输层协议就够了😭","like_count":0},{"had_liked":false,"id":15083,"user_name":"feifei","can_delete":false,"product_type":"c1","uid":1105431,"ip_address":"","ucode":"B1F8AE3AD82C51","user_header":"https://static001.geekbang.org/account/avatar/00/10/de/17/75e2b624.jpg","comment_is_top":false,"comment_ctime":1530846227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530846227","product_id":100007101,"comment_content":"当前业务的高可用性和弹性伸缩很重要，所以很多机构都会在自建私有云之外，采购公有云，你知道私有云和公有云应该如何打通吗？<br><br>如果资金充足还是专线吧，一般就可以用vpn<br><br>前面所有的上网行为，都是基于电脑的，但是移动互联网越来越成为核心，你知道手机上网都需要哪些协议吗？<br><br>4g的协议附着、pdn连接（类似pdp激活）、承载建立、get或者post","like_count":0},{"had_liked":false,"id":15050,"user_name":"大梦一场","can_delete":false,"product_type":"c1","uid":1007448,"ip_address":"","ucode":"EEFB7D5904F120","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5f/58/f58ad899.jpg","comment_is_top":false,"comment_ctime":1530837518,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1530837518","product_id":100007101,"comment_content":"私有云和公有云这个还真不知道，私有云会不会有一个对内对外两个ip来进行访问呢？<br>除了IPSec还有IKEv2，不过现在移动互联网时代很多通过在路由器上面装vpn或者专属内部网络来访问内部网络，还有一种通过ssr或者ss方式进行连接","like_count":0}]}