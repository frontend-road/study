{"id":612574,"title":"03 | ä¸šåŠ¡æ°¸ä¸å®•æœºï¼ŒK8så¦‚ä½•å®ç°è‡ªåŠ¨æ‰©å®¹å’Œè‡ªæ„ˆï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹ç‚œã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬ä»‹ç»äº† K8s Pod ä»¥åŠå¦‚ä½•é€šè¿‡ Pod éƒ¨ç½²å®¹å™¨é•œåƒï¼Œå­¦ä¹ äº† K8s äº¤äº’å·¥å…· Kubectl çš„åŸºæœ¬æ“ä½œã€‚</p><p>é‚£ä¹ˆï¼ŒK8s åˆ°åº•æœ‰ä»€ä¹ˆå¼ºå¤§ä¹‹å¤„è®©å¤§å®¶è¶‹ä¹‹è‹¥é¹œå‘¢ï¼Ÿå®ƒåˆèƒ½ç»™æˆ‘ä»¬çš„ä¸šåŠ¡å¸¦æ¥å“ªäº›æ–°çš„å˜åŒ–ï¼Ÿæˆ‘è®¤ä¸ºï¼Œå…¶ä¸­æœ€é‡è¦ä¹Ÿæ˜¯æœ€å¸å¼•äººçš„å°±æ˜¯å®ƒçš„è‡ªåŠ¨æ‰©å®¹å’Œè‡ªæ„ˆæœºåˆ¶ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä¼šç»§ç»­å»¶å±•ä¸ŠèŠ‚è¯¾çš„å†…å®¹ï¼Œä»ä¼ ç»Ÿ VM çš„æ‰©å®¹å’Œè‡ªæ„ˆå‡ºå‘ï¼Œåˆ†æè¿™ç§æ¶æ„çš„ç¼ºç‚¹ã€‚ç„¶åï¼Œæˆ‘ä¼šä»¥æˆ‘ä»¬ä¹‹å‰éƒ¨ç½²çš„ Pod ä¸ºä¾‹ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥åœ¨ K8s ä¸Šé…ç½®æ‰©å®¹å’Œè‡ªæ„ˆï¼Œè®©ä½ ç›´è§‚åœ°æ„Ÿå— K8s çš„å¼ºå¤§ä¼˜åŠ¿ã€‚</p><p>åœ¨å¼€å§‹ä»Šå¤©çš„æ¼”ç»ƒä¹‹å‰ï¼Œä½ éœ€è¦åšå¥½ä»¥ä¸‹å‡†å¤‡ï¼š</p><ul>\n<li>å‡†å¤‡ä¸€å°ç”µè„‘ï¼ˆé¦–é€‰ Linux æˆ– macOSï¼ŒWindows ä¹Ÿé€‚ç”¨ï¼Œæ³¨æ„æ“ä½œå·®å¼‚ï¼‰ï¼›</li>\n<li><a href=\"https://docs.docker.com/engine/install/\">å®‰è£… Docker</a>ï¼›</li>\n<li><a href=\"https://kubernetes.io/docs/tasks/tools/\">å®‰è£… Kubectl</a>ï¼›</li>\n<li>æŒ‰ä¸Šä¸€èŠ‚è¯¾çš„å†…å®¹åœ¨æœ¬åœ°åˆ›å»º Kind é›†ç¾¤ã€‚</li>\n</ul><h2>ä¼ ç»Ÿçš„æ‰©å®¹å’Œè‡ªæ„ˆ</h2><p>åœ¨ VM æ—¶ä»£ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡ä»¥è¿›ç¨‹çš„æ–¹å¼è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šï¼Œå¹¶ç”±è™šæ‹Ÿæœºå¯¹å¤–æä¾›æœåŠ¡ã€‚éšç€ä¸šåŠ¡è§„æ¨¡çš„æ‰©å¤§ï¼Œæˆ‘ä»¬éœ€è¦æ”¯æ’‘æ›´å¤šçš„è®¿é—®æµé‡ï¼Œè¿™æ—¶ä¸šåŠ¡æ‰©å®¹å°±æˆäº†é¦–å…ˆè¦è€ƒè™‘çš„é—®é¢˜ã€‚</p><p>åœ¨å…¬æœ‰äº‘ç¯å¢ƒä¸‹ï¼ŒVM æ¶æ„æœ€å…¸å‹çš„ä¸€ç§æ‰©å®¹æ–¹å¼æ˜¯<strong>å¼¹æ€§ä¼¸ç¼©ç»„ã€‚</strong>æ„æ€æ˜¯é€šè¿‡å¯¹è™šæ‹Ÿæœºå†…å­˜ã€CPU ç­‰ç›‘æ§æŒ‡æ ‡é…ç½®ä¼¸ç¼©é˜ˆå€¼ï¼Œå®ç°åŠ¨æ€åœ°è‡ªåŠ¨ä¼¸ç¼©ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸€èˆ¬è¿˜ä¼šç»“åˆè™šæ‹Ÿæœºé•œåƒã€è´Ÿè½½å‡è¡¡å™¨ç­‰äº‘äº§å“ä¸€å¹¶ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/ab/b1/abe8e1450af02byy53cc3ea8c29617b1.jpg?wh=1920x955\" alt=\"å›¾ç‰‡\"></p><p>åœ¨è¿™ä¸ªæ¶æ„ä¸­ï¼Œè´Ÿè½½å‡è¡¡å™¨æ˜¯é›†ç¾¤çš„å”¯ä¸€å…¥å£ï¼Œå®ƒåœ¨æ¥å—è®¿é—®æµé‡åï¼Œä¸€èˆ¬ä¼šå°†æµé‡é€šè¿‡åŠ æƒè½®è®­çš„æ–¹å¼è½¬å‘åˆ°åç«¯é›†ç¾¤ã€‚è´Ÿè½½å‡è¡¡å™¨ä¸€èˆ¬æ˜¯ç›´æ¥ä½¿ç”¨äº‘å‚å•†çš„äº§å“ï¼Œæœ‰ä¸€äº›å›¢é˜Ÿä¹Ÿä¼šè‡ªå»ºé«˜å¯ç”¨çš„  Nginx ä½œä¸ºé›†ç¾¤å…¥å£ã€‚ä¸ºäº†ä¿è¯ä¼¸ç¼©ç»„èŠ‚ç‚¹çš„ä¸šåŠ¡ä¸€è‡´æ€§ï¼Œå¼¹æ€§ä¼¸ç¼©ç»„çš„æ‰€æœ‰ VM éƒ½ä½¿ç”¨åŒä¸€ä¸ªè™šæ‹Ÿæœºé•œåƒã€‚</p><p>å…¶æ¬¡ï¼Œè¦åœ¨ VM ç²’åº¦å®ç°ä¸šåŠ¡è‡ªæ„ˆï¼Œå¸¸è§çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨ Crontab å®šæ—¶æ£€æŸ¥ä¸šåŠ¡è¿›ç¨‹æˆ–è€…é€šè¿‡å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼æ¥è¿è¡Œï¼Œä¾‹å¦‚ Node PM2ã€‚</p><h2>ä¼ ç»Ÿæ‰©å®¹å’Œè‡ªæ„ˆçš„ç¼ºç‚¹</h2><p>ä½†æ˜¯ï¼Œè¿™ç§æ¶æ„æœ‰ä¸€äº›æ˜¾è€Œæ˜“è§çš„ç¼ºé™·ã€‚æœ€å¤§çš„é—®é¢˜æœ‰ä¸¤ä¸ªï¼š</p><ol>\n<li>æ‰©å®¹æ…¢ï¼›</li>\n<li>è´Ÿè½½å‡è¡¡æ— æ³•æ„ŸçŸ¥ä¸šåŠ¡å¥åº·æƒ…å†µã€‚</li>\n</ol><p>æ‰©å®¹æ…¢ä¸»è¦ä½“ç°åœ¨ä¸¤æ–¹é¢ã€‚é¦–å…ˆæ˜¯ VM æŒ‡æ ‡ä¼šæœ‰ä¸€å®šçš„å»¶è¿Ÿï¼›å…¶æ¬¡ï¼Œæ‰©å®¹çš„ VM å†·å¯åŠ¨æ—¶é—´æ¯”è¾ƒæ…¢ï¼Œå¼¹æ€§ä¼¸ç¼©ç»„éœ€è¦æ‰§è¡Œè´­ä¹° VMã€é…ç½®é•œåƒã€åŠ å…¥ä¼¸ç¼©ç»„ã€å¯åŠ¨ VM ç­‰æ“ä½œã€‚è¿™ä¼šè®©æˆ‘ä»¬å¤±å»æ‰©å®¹çš„æœ€ä½³æ—¶æœºï¼Œå¹¶æœ€ç»ˆå½±å“ç”¨æˆ·ä½“éªŒã€‚</p><p>è´Ÿè½½å‡è¡¡æ— æ³•æ„ŸçŸ¥ä¸šåŠ¡å¥åº·æƒ…å†µçš„æ„æ€æ˜¯ï¼ŒVM æ˜¯å¦åŠ å…¥åˆ°å¼¹æ€§ä¼¸ç¼©ç»„æ¥æ”¶å¤–éƒ¨æµé‡ï¼Œä¸€èˆ¬å–å†³äº VM çš„å¥åº·çŠ¶æ€ï¼Œä½† VM å¥åº·å¹¶ä¸ç­‰äºä¸šåŠ¡å¥åº·ï¼Œè¿™å¯¼è‡´åœ¨æ‰©ç¼©å®¹çš„è¿‡ç¨‹ä¸­ï¼Œè¯·æ±‚ä»ç„¶æœ‰å¯èƒ½ä¼šè½¬å‘è‡³ä¸šåŠ¡ä¸å¥åº·çš„èŠ‚ç‚¹ï¼Œé€ æˆä¸šåŠ¡çŸ­æš‚ä¸­æ–­çš„é—®é¢˜ã€‚</p><h2>K8s çš„è‡ªåŠ¨è‡ªæ„ˆ</h2><p><strong>K8sæ˜¯å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„å‘¢ã€‚</strong></p><p>åœ¨è¯¦ç»†ä»‹ç» K8s çš„è‡ªæ„ˆä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆé—®ä½ ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œä½ å¸Œæœ›è‡ªæ„ˆè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>æˆ‘æƒ³ï¼Œä½ å¯èƒ½æœ€å¸Œæœ›è‡ªæ„ˆèƒ½å¤Ÿå¸®æˆ‘ä»¬è§£å†³æœåŠ¡è‡ªåŠ¨é‡å¯çš„é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸šåŠ¡è¿›ç¨‹æ„å¤–ä¸­æ–­ï¼Œæˆ–è€…èŠ‚ç‚¹äº§ç”Ÿæ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯ä»¥å¿«é€Ÿè¯†åˆ«ï¼Œè‡ªåŠ¨é‡å¯å¹¶æ¢å¤æœåŠ¡ã€‚å…¶æ¬¡ï¼Œä½ å¯èƒ½è¿˜ä¼šå¸Œæœ›è‡ªæ„ˆèƒ½å¤Ÿè‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯è®©ä¸šåŠ¡ä¸å¥åº·çš„èŠ‚ç‚¹ä¸æ¥æ”¶æµé‡ï¼Œä¿è¯ç”¨æˆ·ä½“éªŒã€‚</p><p>å¬èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼Œè€Œ K8s çš„è‡ªåŠ¨è‡ªæ„ˆåŠŸèƒ½éƒ½å¯ä»¥å¸®ä½ è§£å†³ä¸Šé¢çš„è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ç»ˆäºèƒ½æ‘†è„± 7*24 å°æ—¶ Oncall äº†ã€‚</p><p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥å®æˆ˜ç¯èŠ‚ã€‚</strong></p><p>è¿˜è®°å¾—æˆ‘ä»¬ä¸ŠèŠ‚è¯¾å­¦ä¹ çš„å·¥ä½œè´Ÿè½½å—ï¼Ÿåœ¨å°†é•œåƒéƒ¨ç½²åˆ° K8s é›†ç¾¤æ—¶ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Pod å·¥ä½œè´Ÿè½½ç±»å‹ã€‚åœ¨è¿™èŠ‚è¯¾çš„å®æˆ˜ç¯èŠ‚é‡Œï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¦ä¸€ç§å·¥ä½œè´Ÿè½½ç±»å‹ï¼šDeploymentã€‚</p><p>å¬èµ·æ¥ä¼¼ä¹å¾ˆé™Œç”Ÿï¼Œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬å…ˆä¸è®²æ¦‚å¿µï¼Œè®©æˆ‘ä»¬å…ˆåŠ¨æ‰‹åˆ›å»ºä¸€ä¸ª Deployment å·¥ä½œè´Ÿè½½ã€‚</p><p>é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦åƒåˆ›å»º Pod é‚£æ ·å…ˆç¼–å†™ Manifestï¼Œå†é€šè¿‡ kubectl apply å‘½ä»¤æ¥åˆ›å»ºå·¥ä½œè´Ÿè½½ã€‚ä½†æ˜¯ç”±äº Deployment çš„å­—æ®µå®šä¹‰æ¯”è¾ƒå¤šï¼Œç†è§£èµ·æ¥ä¹Ÿç›¸å¯¹å¤æ‚ï¼Œè¿™é‡Œæˆ‘å…ˆæä¾›å¦ä¸€ç§ç›¸å¯¹ç®€å•çš„åŠæ³•ï¼Œé‚£å°±æ˜¯ kubectl create å‘½ä»¤ï¼š</p><pre><code class=\"language-powershell\">$ kubectl create deployment hello-world-flask --image=lyzhang1999/hello-world-flask:latest --replicas=2 \ndeployment.apps/hello-world-flask created\n</code></pre><p>åœ¨è¿™é‡Œï¼Œhello-world-flask ä»£è¡¨å·¥ä½œè´Ÿè½½çš„åç§°ï¼Œâ€“image ä»£è¡¨é•œåƒï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚è¯¾éƒ¨ç½²çš„é•œåƒï¼Œâ€“replicas æŒ‡çš„æ˜¯ Pod å‰¯æœ¬æ•°ï¼Œä½ å¯ä»¥æŠŠå®ƒç±»æ¯”ä¸ºå¼¹æ€§ä¼¸ç¼©ç»„çš„ VM æ•°é‡ã€‚</p><p>æœ¬è´¨ä¸Šï¼Œä½ å¯ä»¥ç†è§£ä¸ºè¿™æ¡å‘½ä»¤ä¼šç”Ÿæˆ Deployment Manifestï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ kubectl apply å°† Manifest åº”ç”¨åˆ°é›†ç¾¤å†…ï¼Œçœç•¥äº†æˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™ Manifest çš„è¿‡ç¨‹ã€‚ä½ è¿˜å¯ä»¥ä¸ºä¸Šé¢çš„å‘½ä»¤å¢åŠ  --dry-run å’Œ -o å‚æ•°ï¼Œå•çº¯è¾“å‡º Manifest å†…å®¹ã€‚</p><pre><code class=\"language-powershell\">$ kubectl create deployment hello-world-flask --image lyzhang1999/hello-world-flask:latest --replicas=2 --dry-run=client -o yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n&nbsp; creationTimestamp: null\n&nbsp; labels:\n&nbsp; &nbsp; app: hello-world-flask\n&nbsp; name: hello-world-flask\nspec:\n&nbsp; replicas: 2\n&nbsp; selector:\n&nbsp; &nbsp; matchLabels:\n&nbsp; &nbsp; &nbsp; app: hello-world-flask\n&nbsp; strategy: {}\n&nbsp; template:\n&nbsp; &nbsp; metadata:\n&nbsp; &nbsp; &nbsp; creationTimestamp: null\n&nbsp; &nbsp; &nbsp; labels:\n&nbsp; &nbsp; &nbsp; &nbsp; app: hello-world-flask\n&nbsp; &nbsp; spec:\n&nbsp; &nbsp; &nbsp; containers:\n&nbsp; &nbsp; &nbsp; - image: lyzhang1999/hello-world-flask:latest\n&nbsp; &nbsp; &nbsp; &nbsp; name: hello-world-flask\n&nbsp; &nbsp; &nbsp; &nbsp; resources: {}\nstatus: {}\n</code></pre><p>ä¸Šé¢è¾“å‡ºçš„ Manifest å…¶å®å°±æ˜¯æˆ‘ä»¬åº”ç”¨åˆ°é›†ç¾¤å†…çš„ Manifest å†…å®¹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå„å‚æ•°éƒ½ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ kubectl create service å‘½ä»¤åˆ›å»º Serviceï¼š</p><pre><code class=\"language-powershell\">$ kubectl create service clusterip hello-world-flask&nbsp;--tcp=5000:5000\nservice/hello-world-flask created\n</code></pre><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ kubectl create ingress å‘½ä»¤åˆ›å»º Ingressï¼š</p><pre><code class=\"language-powershell\">$ kubectl create ingress hello-world-flask --rule=\"/=hello-world-flask:5000\"\ningress.networking.k8s.io/hello-world-flask created\n</code></pre><p><strong>æœ€åï¼Œåˆ«å¿˜äº†éƒ¨ç½² Ingress-nginxï¼š</strong></p><pre><code class=\"language-powershell\">$ kubectl create -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/resource/main/ingress-nginx/ingress-nginx.yaml\nnamespace/ingress-nginx created\nserviceaccount/ingress-nginx created\nserviceaccount/ingress-nginx-admission created\n......\n</code></pre><p>è¿™é‡Œå‡ºç°äº†å‡ ä¸ªé™Œç”Ÿçš„æ¦‚å¿µï¼Œä¾‹å¦‚ Deploymentã€Service å’Œ Ingressã€‚åˆ«æ‹…å¿ƒï¼Œç°åœ¨ä½ å¹¶ä¸éœ€è¦ç†è§£ä»–ä»¬ï¼Œè¿™éƒ¨åˆ†å†…å®¹æˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ä¸ºä½ è¯¦ç»†ä»‹ç»ã€‚</p><p><strong>ç°é˜¶æ®µï¼Œä½ åªéœ€è¦çŸ¥é“ä¸‰ä»¶äº‹ï¼š</strong></p><ol>\n<li>Pod ä¼šè¢« Deployment å·¥ä½œè´Ÿè½½ç®¡ç†èµ·æ¥ï¼Œä¾‹å¦‚åˆ›å»ºå’Œé”€æ¯ç­‰ï¼›</li>\n<li>Service ç›¸å½“äºå¼¹æ€§ä¼¸ç¼©ç»„çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œå®ƒèƒ½ä»¥åŠ æƒè½®è®­çš„æ–¹å¼å°†æµé‡è½¬å‘åˆ°å¤šä¸ª Pod å‰¯æœ¬ä¸Šï¼›</li>\n<li>Ingress ç›¸å½“äºé›†ç¾¤çš„å¤–ç½‘è®¿é—®å…¥å£ã€‚</li>\n</ol><p><strong>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹ K8s è‡ªæ„ˆå®éªŒã€‚</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦é€šè¿‡ kubectl get pods åˆ—å‡º Podï¼š</p><pre><code class=\"language-powershell\">$ kubectl get pods\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;READY&nbsp; &nbsp;STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE\nhello-world-flask-56fbff68c8-2xz7w&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3m38s\nhello-world-flask-56fbff68c8-4f9qz&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3m38s\n</code></pre><p>ä»è¿”å›ç»“æœå¯ä»¥çœ‹å‡ºï¼ŒDeployment ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ª Pod å‰¯æœ¬ï¼Œå®ƒä»¬æ‹¥æœ‰ä¸åŒçš„åå­—ã€‚ï¼ˆä¸ä¸Šä¸€èŠ‚è¯¾æ‰‹åŠ¨éƒ¨ç½²çš„ Pod ä¸åŒï¼Œé€šè¿‡ Deployment åˆ›å»ºçš„ Pod å¸¦æœ‰éšæœºåç¼€ã€‚ï¼‰</p><p>ç”±äºä¹‹å‰æˆ‘ä»¬å·²ç»é€šè¿‡ Kind åœ¨æœ¬åœ°åˆ›å»ºäº†é›†ç¾¤ï¼Œä¹Ÿæš´éœ²ç›‘å¬äº†æœ¬åœ°çš„ 80 ç«¯å£ï¼Œæ‰€ä»¥é›†ç¾¤çš„ Ingress è®¿é—®å…¥å£æ˜¯ <strong>127.0.0.1ã€‚</strong></p><p>æœ‰äº† Ingressï¼Œæˆ‘ä»¬è®¿é—® Pod å°±ä¸å†éœ€è¦è¿›è¡Œç«¯å£è½¬å‘äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—® 127.0.0.1ã€‚ä¸‹é¢çš„å‘½ä»¤ä¼šæ¯éš” 1 ç§’é’Ÿå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œå¹¶æ‰“å°å‡ºæ—¶é—´å’Œè¿”å›å†…å®¹ï¼š</p><pre><code class=\"language-powershell\">$ while true; do sleep 1; curl http://127.0.0.1; echo -e '\\n'$(date);done\nHello, my first docker images! hello-world-flask-56fbff68c8-4f9qz\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶21åˆ†03ç§’ CST\nHello, my first docker images! hello-world-flask-56fbff68c8-2xz7w\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶21åˆ†04ç§’ CST\n</code></pre><p>åœ¨è¿™é‡Œï¼Œâ€œHello, my first docker imagesâ€ åé¢ç´§æ¥çš„å†…å®¹æ˜¯ Pod åç§°ã€‚é€šè¿‡è¿”å›å†…å®¹æˆ‘ä»¬ä¼šå‘ç°ï¼Œè¯·æ±‚è¢«å¹³å‡åˆ†é…åˆ°äº†ä¸¤ä¸ª Pod ä¸Šï¼ŒPod åç§°æ˜¯äº¤æ›¿å‡ºç°çš„ã€‚æˆ‘ä»¬è¦ä¿ç•™è¿™ä¸ªå‘½ä»¤è¡Œçª—å£ï¼Œä»¥ä¾¿ç»§ç»­è§‚å¯Ÿã€‚</p><p><strong>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿå…¶ä¸­çš„ä¸€ä¸ª Pod å®•æœºï¼Œè§‚å¯Ÿè¿”å›å†…å®¹ã€‚</strong></p><p>æ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤è¡Œçª—å£ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ç»ˆæ­¢å®¹å™¨å†…çš„ Python è¿›ç¨‹ï¼Œè¿™ä¸ªæ“ä½œæ˜¯åœ¨æ¨¡æ‹Ÿè¿›ç¨‹æ„å¤–ä¸­æ­¢å¯¼è‡´å®•æœºçš„æƒ…å†µã€‚</p><pre><code class=\"language-powershell\">$ kubectl exec -it hello-world-flask-56fbff68c8-2xz7w -- bash -c \"killall python3\"\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å›åˆ°åˆšæ‰çš„è¯·æ±‚çª—å£æŸ¥çœ‹è¿”å›å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°éå¸¸ç¥å¥‡çš„ä¸€å¹•ï¼š</p><pre><code class=\"language-powershell\">Hello, my first docker images! hello-world-flask-56fbff68c8-4f9qz\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶27åˆ†44ç§’ CST\nHello, my first docker images! hello-world-flask-56fbff68c8-4f9qz\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶27åˆ†45ç§’ CST\nHello, my first docker images! hello-world-flask-56fbff68c8-4f9qz\n</code></pre><p>æ‰€æœ‰çš„è¯·æ±‚æµé‡éƒ½è¢«è½¬å‘åˆ°äº†æ²¡æœ‰æ•…éšœçš„ Podï¼Œ<strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•…éšœæˆåŠŸåœ°è¢«è½¬ç§»äº†ï¼</strong></p><p>ç­‰å¾…å‡ ç§’é’Ÿï¼Œç»§ç»­è§‚å¯Ÿï¼Œæˆ‘ä»¬ä¼šé‡æ–°å‘ç° hello-world-flask-56fbff68c8-2xz7w Pod çš„è¿”å›å†…å®¹ï¼Œè¿™è¯´æ˜ Pod è¢«é‡å¯æ¢å¤åï¼Œé‡æ–°åŠ å…¥åˆ°äº†è´Ÿè½½å‡è¡¡æ¥æ”¶å¤–éƒ¨æµé‡ï¼š</p><pre><code class=\"language-powershell\">Hello, my first docker images! hello-world-flask-56fbff68c8-2xz7w\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶27åˆ†52ç§’ CST\nHello, my first docker images! hello-world-flask-56fbff68c8-4f9qz\n2022å¹´ 9æœˆ 7æ—¥ æ˜ŸæœŸä¸‰ 19æ—¶27åˆ†53ç§’ CST\nHello, my first docker images! hello-world-flask-56fbff68c8-2xz7w\n</code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨ kubectl get pods æŸ¥çœ‹ Podï¼š</p><pre><code class=\"language-powershell\">$ kubectl get pods\nNAME                                 READY   STATUS    RESTARTS   AGE\nhello-world-flask-56fbff68c8-2xz7w   1/1     Running   1(1m ago)  3m38s\nhello-world-flask-56fbff68c8-4f9qz   1/1     Running   0          3m38s\n</code></pre><p>è¿™é‡Œè¦æ³¨æ„çœ‹ï¼Œ hello-world-flask-56fbff68c8-2xz7w Pod çš„ RESTARTS å€¼ä¸º 1 ï¼Œä¹Ÿå°±æ˜¯è¯´ K8s è‡ªåŠ¨å¸®æˆ‘ä»¬é‡å¯äº†è¿™ä¸ª Podã€‚</p><p>å¥½äº†ï¼Œè®©æˆ‘ä»¬é‡æ–°æ¥æ¢³ç†ä¸€ä¸‹å…¨è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œ K8s æ„ŸçŸ¥åˆ°äº†ä¸šåŠ¡ Pod æ•…éšœï¼Œç«‹åˆ»è¿›è¡Œäº†æ•…éšœè½¬ç§»å¹¶éš”ç¦»äº†æœ‰æ•…éšœçš„ Podï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°äº†å…¶ä»–å¥åº·çš„ Pod ä¸­ã€‚éšåé‡å¯äº†æœ‰æ•…éšœçš„ Podï¼Œæœ€åå°†é‡å¯åçš„ Pod åŠ å…¥åˆ°äº†è´Ÿè½½å‡è¡¡å¹¶å¼€å§‹æ¥æ”¶å¤–éƒ¨è¯·æ±‚ã€‚è¿™äº›è¿‡ç¨‹éƒ½æ˜¯è‡ªåŠ¨åŒ–å®Œæˆçš„ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å®Œæˆäº† K8s è‡ªæ„ˆçš„å®éªŒã€‚æœ‰äº† K8s çš„è‡ªæ„ˆåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ä¸å†éœ€è¦ä¸ºæ½œåœ¨çš„ä¸šåŠ¡ä¸­æ–­é—®é¢˜è€Œçƒ¦æ¼äº†ã€‚</p><h2>K8s çš„è‡ªåŠ¨æ‰©å®¹</h2><p>é™¤äº†è‡ªæ„ˆåŠŸèƒ½ä»¥å¤–ï¼ŒK8s è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†è‡ªåŠ¨æ‰©å®¹çš„èƒ½åŠ›ã€‚</p><p>è‡ªåŠ¨æ‰©å®¹ä¾èµ–äº K8s Metric Server æä¾›çš„ç›‘æ§æŒ‡æ ‡ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…å®ƒï¼š</p><pre><code class=\"language-powershell\">$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/resource/main/metrics/metrics.yaml\nserviceaccount/metrics-server created\nclusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created\nclusterrole.rbac.authorization.k8s.io/system:metrics-server created\n......\n</code></pre><p>å®‰è£…å®Œæˆåï¼Œç­‰å¾… Metric å·¥ä½œè´Ÿè½½å°±ç»ªï¼š</p><pre><code class=\"language-powershell\">$ kubectl wait deployment -n kube-system metrics-server --for condition=Available=True --timeout=90s\ndeployment.apps/metrics-server condition met\n</code></pre><p>Metric Server å°±ç»ªåï¼Œé€šè¿‡ kubectl autoscale å‘½ä»¤æ¥ä¸º Deployment åˆ›å»ºè‡ªåŠ¨æ‰©å®¹ç­–ç•¥ï¼š</p><pre><code class=\"language-powershell\">$ kubectl autoscale deployment hello-world-flask --cpu-percent=50 --min=2 --max=10\n</code></pre><p>è¿™å…¶ä¸­ï¼Œâ€“cpu-percent è¡¨ç¤º CPU ä½¿ç”¨ç‡é˜ˆå€¼ï¼Œå½“ CPU è¶…è¿‡ 50% æ—¶å°†è¿›è¡Œè‡ªåŠ¨æ‰©å®¹ï¼Œâ€“min ä»£è¡¨æœ€å°çš„ Pod å‰¯æœ¬æ•°ï¼Œâ€“max ä»£è¡¨æœ€å¤§æ‰©å®¹çš„å‰¯æœ¬æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªåŠ¨æ‰©å®¹ä¼šæ ¹æ® CPU çš„ä½¿ç”¨ç‡åœ¨ 2 ä¸ªå‰¯æœ¬å’Œ 10 ä¸ªå‰¯æœ¬ä¹‹é—´è¿›è¡Œæ‰©ç¼©å®¹ã€‚</p><p>æœ€åï¼Œè¦ä½¿è‡ªåŠ¨æ‰©å®¹ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦ä¸ºæˆ‘ä»¬åˆšæ‰éƒ¨ç½²çš„ hello-world-flask Deployment è®¾ç½®èµ„æºé…é¢ã€‚ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥é…ç½®ï¼š</p><pre><code class=\"language-powershell\">$ kubectl patch deployment hello-world-flask --type='json' -p='[{\"op\": \"add\", \"path\": \"/spec/template/spec/containers/0/resources\", \"value\": {\"requests\": {\"memory\": \"100Mi\", \"cpu\": \"100m\"}}}]'\ndeployment.apps/hello-world-flask patched\n</code></pre><p>ç°åœ¨ï¼ŒDeployment å°†ä¼š<strong>é‡æ–°åˆ›å»º</strong>ä¸¤ä¸ªæ–°çš„ Podï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç­›é€‰å‡ºæ–°çš„ Podï¼š</p><pre><code class=\"language-powershell\">$ kubectl get pod --field-selector=status.phase==Running\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;READY&nbsp; &nbsp;STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE\nhello-world-flask-64dd645c57-4clbp&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 117s\nhello-world-flask-64dd645c57-cc6g6&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 117s\n</code></pre><p>é€‰æ‹©ä¸€ä¸ª Pod å¹¶ä½¿ç”¨ kubectl exec è¿›å…¥åˆ°å®¹å™¨å†…ï¼š</p><pre><code class=\"language-powershell\">$ kubectl exec -it hello-world-flask-64dd645c57-4clbp -- bash\nroot@hello-world-flask-64dd645c57-4clbp:/app#\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸šåŠ¡é«˜å³°æœŸåœºæ™¯ï¼Œä½¿ç”¨ ab å‘½ä»¤æ¥åˆ›å»ºå¹¶å‘è¯·æ±‚ï¼š</p><pre><code class=\"language-powershell\">root@hello-world-flask-64dd645c57-4clbp:/app# ab -c 50 -n 10000 http://127.0.0.1:5000/\n</code></pre><p>åœ¨è¿™æ¡å‹åŠ›æµ‹è¯•çš„å‘½ä»¤ä¸­ï¼Œ-c ä»£è¡¨ 50 ä¸ªå¹¶å‘æ•°ï¼Œ-n ä»£è¡¨ä¸€å…±è¯·æ±‚ 10000 æ¬¡ï¼Œæ•´ä¸ªè¿‡ç¨‹å¤§æ¦‚ä¼šæŒç»­åå‡ ç§’ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤è¡Œçª—å£ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŒç»­ç›‘æ§ Pod çš„çŠ¶æ€ï¼š</p><pre><code class=\"language-powershell\">$ kubectl get pods --watch\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;READY&nbsp; &nbsp;STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE\nhello-world-flask-64dd645c57-9x869&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4m6s\nhello-world-flask-64dd645c57-vw8nc&nbsp; &nbsp;0/1&nbsp; &nbsp; &nbsp;Pending&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0s\nhello-world-flask-64dd645c57-46b6s&nbsp; &nbsp;0/1&nbsp; &nbsp; &nbsp;ContainerCreating&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0s\nhello-world-flask-64dd645c57-vw8nc&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 18s\n</code></pre><p>â€“watch å‚æ•°ä¼šä¸€ç›´ç­‰å¾…ï¼Œä½ å¯ä»¥ä½¿ç”¨ ctrl+c æˆ–å…³é—­çª—å£æ¥ç»ˆæ­¢ã€‚</p><p>è¿™é‡Œå‚æ•° --watch è¡¨ç¤ºæŒç»­ç›‘å¬ Pod çŠ¶æ€å˜åŒ–ã€‚åœ¨ ab å‹åŠ›æµ‹è¯•çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸æ–­åˆ›å»ºæ–°çš„ Pod å‰¯æœ¬ï¼Œ<strong>è¿™è¯´æ˜ K8s å·²ç»æ„ŸçŸ¥åˆ°äº† Pod çš„ä¸šåŠ¡å‹åŠ›ï¼Œå¹¶ä¸”æ­£åœ¨è‡ªåŠ¨è¿›è¡Œæ¨ªå‘æ‰©å®¹</strong>ã€‚</p><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘å…ˆä»‹ç»äº†åŸºäº VM çš„æ‰©å®¹å’Œè‡ªæ„ˆæ–¹æ¡ˆï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬åœ¨æ‰©å®¹é€Ÿåº¦å’Œæµé‡ç®¡ç†ä¸Šå­˜åœ¨è¾ƒå¤§çš„ä¸è¶³ä¹‹å¤„ã€‚ç„¶åï¼Œæˆ‘é€šè¿‡ä¸¤ä¸ªå®é™…çš„ä¾‹å­å‘ä½ ç›´è§‚åœ°å±•ç¤ºäº† K8s è‡ªæ„ˆå’Œè‡ªåŠ¨æ‰©å®¹çš„å¼ºå¤§ä¹‹å¤„ã€‚</p><p>K8s çš„è‡ªæ„ˆå’Œæ‰©å®¹çš„å¯¹è±¡éƒ½æ˜¯ Podï¼Œå®ƒæ˜¯ K8s çš„æœ€å°è°ƒåº¦å•ä½ã€‚åœ¨åˆ›å»º Pod çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åƒä¸Šä¸€èŠ‚è¯¾é‚£æ ·ç›´æ¥åˆ›å»º Pod å·¥ä½œè´Ÿè½½ï¼Œè€Œæ˜¯é€šè¿‡åˆ›å»º Deployment å·¥ä½œè´Ÿè½½æ¥é—´æ¥åˆ›å»º Podã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºå¤šä¸ª Pod å‰¯æœ¬ï¼Œå¹¶ä¸”åªéœ€è¦å…³æ³¨ Deployment çš„çŠ¶æ€å°±å¯ä»¥é—´æ¥åœ°æ§åˆ¶ Pod çš„çŠ¶æ€ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘è¿˜ä¸ºä½ ä»‹ç»äº†ä¸€ç§ç¼–å†™ Manifest çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ kubectl create deployment --dry-run=client -o yaml å‘½ä»¤ï¼Œå®ƒä¼šä¸ºæˆ‘ä»¬è¾“å‡ºè¯¦ç»†çš„ Manifest ä¿¡æ¯ã€‚è¿™æ¡å‘½ä»¤é€‚ç”¨äºéå¸¸å¤šçš„ K8s å¯¹è±¡ï¼Œå…·ä½“æœ‰å“ªäº›å¯¹è±¡ä½ å¯ä»¥ä½¿ç”¨ kubectl create --help æŸ¥çœ‹ã€‚åœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œå½“ä½ éœ€è¦ç¼–å†™ Manifest åˆä¸è®°å¾—è¯­æ³•æ—¶ï¼Œå®ƒä¼šå¯¹ä½ éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>é™¤äº† Deployment å·¥ä½œè´Ÿè½½ï¼Œåœ¨è‡ªåŠ¨æ‰©å®¹çš„å®éªŒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å¼•å‡ºäº†å¥½å‡ ä¸ªæ–°æ¦‚å¿µï¼Œæˆ‘ä»¬ç°é˜¶æ®µåªéœ€è¦çŸ¥é“å®ƒä»¬çš„åŠŸèƒ½å³å¯ï¼Œåœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­æˆ‘è¿˜ä¼šä¸ºä½ è¯¦ç»†ä»‹ç»ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜å§ã€‚</p><p>èƒ½ä¸èƒ½åˆ†äº«ä¸€ä¸‹ä½ ç°åœ¨ä½¿ç”¨çš„è‡ªæ„ˆå’Œæ‰©å®¹æ–¹æ¡ˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç›¸æ¯”è¾ƒ K8s ï¼Œå®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿å’Œç¼ºç‚¹ï¼Ÿ</p><p>æ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€äº¤æµè®¨è®ºï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","comments":[{"had_liked":false,"id":364934,"user_name":"ghostwritten","can_delete":false,"product_type":"c1","uid":1308196,"ip_address":"å¹¿ä¸œ","ucode":"AE512F2E24A1A0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/24/547439f1.jpg","comment_is_top":false,"comment_ctime":1671722795,"is_pvip":false,"replies":[{"id":132885,"content":"éå¸¸æ£’çš„å‘½ä»¤å¤‡å¿˜å½•ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671762064,"ip_address":"å¹¿ä¸œ","comment_id":364934,"utype":1}],"discussion_count":2,"race_medal":1,"score":2,"product_id":100312001,"comment_content":"1. å®‰è£… podmanã€kubectlã€kind\n2. åˆ›å»º kind ï¼škind create cluster --config config.yaml\n3. åˆ›å»º deploymentï¼škubectl create deployment hello-world-flask --image=lyzhang1999&#47;hello-world-flask:latest --replicas=2\n4. ç”Ÿæˆ yamlæ–‡ä»¶ï¼škubectl create deployment hello-world-flask --image lyzhang1999&#47;hello-world-flask:latest --replicas=2 --dry-run=client -o yaml\n5. åˆ›å»º serviceï¼škubectl create service clusterip hello-world-flask --tcp=5000:5000\n6. åˆ›å»º ingressï¼škubectl create ingress hello-world-flask --rule=&quot;&#47;=hello-world-flask:5000&quot;\n7. åˆ›å»º ingress-nginxï¼škubectl create -f https:&#47;&#47;ghproxy.com&#47;https:&#47;&#47;raw.githubusercontent.com&#47;lyzhang1999&#47;resource&#47;main&#47;ingress-nginx&#47;ingress-nginx.yaml\n8. è®¿é—®æµ‹è¯•ï¼šwhile true; do sleep 1; curl http:&#47;&#47;127.0.0.1; echo -e &#39;\\n&#39;$(date);done\n9. æ¨¡æ‹Ÿå®•æœºï¼škubectl exec -it hello-world-flask-56fbff68c8-2xz7w -- bash -c &quot;killall python3&quot;\n10. åˆ›å»º metric serverï¼škubectl apply -f https:&#47;&#47;ghproxy.com&#47;https:&#47;&#47;raw.githubusercontent.com&#47;lyzhang1999&#47;resource&#47;main&#47;metrics&#47;metrics.yaml\n11. ç­‰å¾…deploymentåˆ›å»ºæˆåŠŸï¼škubectl wait deployment -n kube-system metrics-server --for condition=Available=True --timeout=90s\n12. åˆ›å»ºè‡ªåŠ¨æ‰©å®¹ç­–ç•¥ï¼š kubectl autoscale deployment hello-world-flask --cpu-percent=50 --min=2 --max=10\n13. deployment è®¾ç½®èµ„æºé…é¢ï¼škubectl patch deployment hello-world-flask --type=&#39;json&#39; -p=&#39;[{&quot;op&quot;: &quot;add&quot;, &quot;path&quot;: &quot;&#47;spec&#47;template&#47;spec&#47;containers&#47;0&#47;resources&quot;, &quot;value&quot;: {&quot;requests&quot;: {&quot;memory&quot;: &quot;100Mi&quot;, &quot;cpu&quot;: &quot;100m&quot;}}}]&#39;\n14. æŸ¥çœ‹æœ€æ–°åˆ›å»ºçš„podï¼škubectl get pod --field-selector=status.phase==Running\n15. åˆ›å»ºå¹¶å‘è¯·æ±‚ï¼škubectl exec -it hello-world-flask-64dd645c57-4clbp -- ab -c 50 -n 10000 http:&#47;&#47;127.0.0.1:5000&#47;\n16. æŸ¥çœ‹ pod æ•°é‡ï¼šk get pods -w\n","like_count":11,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597378,"discussion_content":"éå¸¸æ£’çš„å‘½ä»¤å¤‡å¿˜å½•ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671762064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3663489,"avatar":"","nickname":"Geek_5c9b08","note":"","ucode":"D34ADEE139356C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625406,"discussion_content":"æ‹¿æ¥å§ä½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691653886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364935,"user_name":"ghostwritten","can_delete":false,"product_type":"c1","uid":1308196,"ip_address":"å¹¿ä¸œ","ucode":"AE512F2E24A1A0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/24/547439f1.jpg","comment_is_top":false,"comment_ctime":1671724142,"is_pvip":false,"replies":[{"id":132884,"content":"æ˜¯çš„ï¼Œæœ€ç»å¸¸ä½¿ç”¨çš„æ˜¯ HPAã€‚\n\nCA ç›®å‰ä¸»æµçš„äº‘å‚å•†éƒ½æ”¯æŒï¼ŒåŒ…æ‹¬å›½å†…ä¸‰å¤§äº‘å‚å•†ã€‚\n\nVPA çš„ç‰¹æ€§å¯¹ç”Ÿäº§å¸®åŠ©å¾ˆå¤§ï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰ GAï¼Œå¯ä»¥è¿›ä¸€æ­¥ç•™æ„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671761981,"ip_address":"å¹¿ä¸œ","comment_id":364935,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100312001,"comment_content":"å®ç° K8s autoscalers è‡ªåŠ¨æ‰©å®¹ ä¸‰ç±»ç»„ä»¶ï¼š\nHorizoâ€‹â€‹ntal Pod Autoscaler (HPA)ï¼šæ ¹æ® CPU åˆ©ç”¨ç‡å¢åŠ æˆ–å‡å°‘å¤åˆ¶æ§åˆ¶å™¨ã€éƒ¨ç½²ã€å‰¯æœ¬é›†æˆ–æœ‰çŠ¶æ€é›†ä¸­çš„ pod æ•°é‡â€”â€”ç¼©æ”¾æ˜¯æ°´å¹³çš„ï¼›\nCluster Autoscalerï¼š æ ¹æ® pod çš„èµ„æºè¯·æ±‚è‡ªåŠ¨æ·»åŠ æˆ–åˆ é™¤é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼›\nVertical Pod Autoscaler (VPA)ï¼šå®ƒå¢åŠ å’Œå‡å°‘å®¹å™¨ CPU å’Œå†…å­˜èµ„æºé…ç½®ï¼Œä»¥ä½¿é›†ç¾¤èµ„æºåˆ†é…ä¸å®é™…ä½¿ç”¨æƒ…å†µä¿æŒä¸€è‡´ã€‚","like_count":7,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597377,"discussion_content":"æ˜¯çš„ï¼Œæœ€ç»å¸¸ä½¿ç”¨çš„æ˜¯ HPAã€‚\n\nCA ç›®å‰ä¸»æµçš„äº‘å‚å•†éƒ½æ”¯æŒï¼ŒåŒ…æ‹¬å›½å†…ä¸‰å¤§äº‘å‚å•†ã€‚\n\nVPA çš„ç‰¹æ€§å¯¹ç”Ÿäº§å¸®åŠ©å¾ˆå¤§ï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰ GAï¼Œå¯ä»¥è¿›ä¸€æ­¥ç•™æ„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671761982,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364474,"user_name":"Promise","can_delete":false,"product_type":"c1","uid":1038646,"ip_address":"å¹¿ä¸œ","ucode":"3E07E270EED2E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d9/36/92d8eb91.jpg","comment_is_top":false,"comment_ctime":1671004534,"is_pvip":true,"replies":[{"id":132506,"content":"æ˜¯çš„ï¼ŒK8s çš„å†…å®¹æ·±ä¸è§åº•ï¼Œå­¦ä¹ ä¸€ä¸¤é¡¹æŠ€æœ¯æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚è¿™ä¹Ÿæ˜¯è¿™é—¨è¯¾ç¨‹å¼€è¯¾çš„åˆè¡·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671095242,"ip_address":"å¹¿ä¸œ","comment_id":364474,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"æˆ‘ä»¬å…¬å¸ä¹‹å‰ä½¿ç”¨pm2å¼€è¿›è¡ŒæœåŠ¡è‡ªæ„ˆï¼Œæ‰‹åŠ¨æ‰©ç¼©å®¹ã€‚åé¢æ­å»ºäº†k8sç¯å¢ƒä½¿ç”¨k8så¼€è¿›è¡ŒæœåŠ¡çš„éƒ¨ç½²å’Œä¸Šçº¿å¾ˆæ–¹ä¾¿ã€‚ä½†æ˜¯k8sè¿™ä¸ªä¸œè¥¿è¦å­¦çš„æ˜¯åœ¨å¤ªå¤šäº†ã€‚ã€‚ã€‚ã€‚","like_count":4,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596576,"discussion_content":"æ˜¯çš„ï¼ŒK8s çš„å†…å®¹æ·±ä¸è§åº•ï¼Œå­¦ä¹ ä¸€ä¸¤é¡¹æŠ€æœ¯æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚è¿™ä¹Ÿæ˜¯è¿™é—¨è¯¾ç¨‹å¼€è¯¾çš„åˆè¡·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671095243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372250,"user_name":"Geek_df0d4d","can_delete":false,"product_type":"c1","uid":3583561,"ip_address":"ä¸Šæµ·","ucode":"C801D2B152AB63","user_header":"","comment_is_top":false,"comment_ctime":1680884855,"is_pvip":false,"replies":[{"id":135848,"content":"Pod çš„å¹³å‡èµ„æºåˆ©ç”¨ç‡","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1680920153,"ip_address":"æ–°åŠ å¡","comment_id":372250,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"è¯·æ•™ä¸€ä¸‹ï¼Œhpaçš„é»˜è®¤ç¼©å®¹ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ--cpu-percent=50ï¼Œå½“ CPU è¶…è¿‡ 50% æ—¶å°†è¿›è¡Œè‡ªåŠ¨æ‰©å®¹ï¼Œé‚£æ˜¯å¦é™åˆ°50ä»¥ä¸‹å°±ç¼©å®¹ï¼Ÿæ˜¯å•ä¸ªpodé™åˆ°50ä»¥ä¸‹ç¼©å®¹ï¼Œè¿˜æ˜¯deployæ•´ä½“é™åˆ°50ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612763,"discussion_content":"Pod çš„å¹³å‡èµ„æºåˆ©ç”¨ç‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680920153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364372,"user_name":"Michael","can_delete":false,"product_type":"c1","uid":1274787,"ip_address":"å¹¿ä¸œ","ucode":"C233DF1D224EC1","user_header":"https://static001.geekbang.org/account/avatar/00/13/73/a3/2b077607.jpg","comment_is_top":false,"comment_ctime":1670907920,"is_pvip":false,"replies":[{"id":132499,"content":"å–å†³äº K8s é›†ç¾¤çš„ kube-proxy çš„å®ç°æ–¹å¼ï¼ŒIptables é»˜è®¤æ˜¯éšæœºï¼ŒIPVS æ¨¡å¼é»˜è®¤æ˜¯åŠ æƒè½®è®­çš„ç®—æ³•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671094242,"ip_address":"å¹¿ä¸œ","comment_id":364372,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"è¿™ä¸ªsvcé»˜è®¤çš„è½¬å‘ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿè½®è¯¢å˜›ï¼Ÿæˆ‘éªŒè¯ä¸æ˜¯è½®è¯¢çš„\n[root@iZwz90sfnybprmnd5ojhr9Z data]# while true; do sleep 1; curl http:&#47;&#47;127.0.0.1; echo -e &#39;\\n&#39;$(date);done\nHello, my first docker images! hello-world-flask-c68dc87d7-tfvcs\nTue Dec 13 12:58:02 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-kbv4j\nTue Dec 13 12:58:03 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-tfvcs\nTue Dec 13 12:58:04 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-tfvcs\nTue Dec 13 12:58:05 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-kbv4j\nTue Dec 13 12:58:06 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-kbv4j\nTue Dec 13 12:58:07 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-tfvcs\nTue Dec 13 12:58:08 CST 2022\nHello, my first docker images! hello-world-flask-c68dc87d7-kbv4j\nTue Dec 13 12:58:09 CST 2022","like_count":2,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596568,"discussion_content":"å–å†³äº K8s é›†ç¾¤çš„ kube-proxy çš„å®ç°æ–¹å¼ï¼ŒIptables é»˜è®¤æ˜¯éšæœºï¼ŒIPVS æ¨¡å¼é»˜è®¤æ˜¯åŠ æƒè½®è®­çš„ç®—æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671094242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1646028,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1d/cc/f5ec3f23.jpg","nickname":"Clay","note":"","ucode":"B9058AC1681875","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":599971,"discussion_content":"è¿™ä¸ªä¸åº”è¯¥æ˜¯ ingress æ§åˆ¶çš„å—ï¼Œingress ä» etcd é‡Œé¢è·å– svc å¯¹åº”çš„ endpoints, ingress å°† endpoints åŠ å…¥åˆ° upstream åˆ—è¡¨é‡Œé¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1673922184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596568,"ip_address":"ä¸Šæµ·","group_id":0},"score":599971,"extra":""}]},{"author":{"id":1038646,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d9/36/92d8eb91.jpg","nickname":"Promise","note":"","ucode":"3E07E270EED2E8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596463,"discussion_content":"ä¸æ˜¯è½®è¯¢æ˜¯éšæœºï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹Serviceå¦‚ä½•åˆ›å»ºiptablesè§„åˆ™","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1671004341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364502,"user_name":"Y","can_delete":false,"product_type":"c1","uid":1179432,"ip_address":"å¹¿ä¸œ","ucode":"952AA9B2CD91CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/28/040f6f01.jpg","comment_is_top":false,"comment_ctime":1671037328,"is_pvip":true,"replies":[{"id":132508,"content":"æ£€æŸ¥ä¸€ä¸‹ Metric-Server æ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œéœ€è¦å®ƒæä¾› CPU å’Œå†…å­˜æŒ‡æ ‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671095362,"ip_address":"å¹¿ä¸œ","comment_id":364502,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"å‰é¢éƒ½æˆåŠŸäº†ã€‚è‡ªåŠ¨æ‰©å®¹æ²¡æœ‰å®éªŒæˆåŠŸã€‚","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596578,"discussion_content":"æ£€æŸ¥ä¸€ä¸‹ Metric-Server æ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œéœ€è¦å®ƒæä¾› CPU å’Œå†…å­˜æŒ‡æ ‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671095362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1347935,"avatar":"https://static001.geekbang.org/account/avatar/00/14/91/5f/88d36112.jpg","nickname":"ä¸æ±‚","note":"","ucode":"3F1FA537E67A5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":607026,"discussion_content":"kubectl create ingress hello-world-flask --rule æŠ¥é”™ rule è¿™ä¸ªå‚æ•°æ²¡æœ‰å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677562382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":596578,"ip_address":"åŒ—äº¬","group_id":0},"score":607026,"extra":""}]},{"author":{"id":1347935,"avatar":"https://static001.geekbang.org/account/avatar/00/14/91/5f/88d36112.jpg","nickname":"ä¸æ±‚","note":"","ucode":"3F1FA537E67A5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607027,"discussion_content":"è¯·æ•™ä¸ªé—®é¢˜ kubectl create ingress hello-world-flask --rule ä½ æ²¡æœ‰æŠ¥é”™å—ï¼Ÿ æç¤ºError: unknown flag: --rule\nSee &#39;kubectl create --help&#39; for usage","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677562524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376826,"user_name":"äº®","can_delete":false,"product_type":"c1","uid":1000087,"ip_address":"æµ™æ±Ÿ","ucode":"3987C5F8B7523F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/97/86e96741.jpg","comment_is_top":false,"comment_ctime":1687513281,"is_pvip":false,"replies":[{"id":137359,"content":"ç”¨ minikube addons enable ingress å‘½ä»¤æ¥æ·»åŠ  ingressï¼Œç„¶åå¯ä»¥ä½¿ç”¨ minikube tunnel æ¥æš´éœ²æœåŠ¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1687520654,"ip_address":"å¹¿ä¸œ","comment_id":376826,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œå¦‚æœæˆ‘ä½¿ç”¨minikubeéƒ¨ç½²çš„é›†ç¾¤ï¼Œæ“ä½œä¸Šä¼šæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿè²Œä¼¼æ— æ³•è®¿é—®80ç«¯å£","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621700,"discussion_content":"ç”¨ minikube addons enable ingress å‘½ä»¤æ¥æ·»åŠ  ingressï¼Œç„¶åå¯ä»¥ä½¿ç”¨ minikube tunnel æ¥æš´éœ²æœåŠ¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687520654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374229,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1085659,"ip_address":"å››å·","ucode":"588EBC835D34B3","user_header":"https://static001.geekbang.org/account/avatar/00/10/90/db/8429cdfa.jpg","comment_is_top":false,"comment_ctime":1683730552,"is_pvip":false,"replies":[{"id":136661,"content":"ğŸ‘ğŸ»æ„Ÿè°¢åˆ†äº«å’ŒæŒ‡æ­£","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1683764564,"ip_address":"å¹¿ä¸œ","comment_id":374229,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"Windows10+Docker Desktop+Kubectl+Kindç¯å¢ƒä¸‹â€œä¸ºéƒ¨ç½²çš„ hello-world-flask Deployment è®¾ç½®èµ„æºé…é¢â€çš„å‘½ä»¤ä¸æ­£ç¡®ï¼Œç»éªŒè¯ï¼Œæ­£ç¡®çš„å‘½ä»¤å¦‚ä¸‹ï¼š\nkubectl patch deployment hello-world-flask --type=json -p=&quot;[{&#39;op&#39;: &#39;add&#39;, &#39;path&#39;: &#39;&#47;spec&#47;template&#47;spec&#47;containers&#47;0&#47;resources&#39;, &#39;value&#39;: {&#39;requests&#39;: {&#39;memory&#39;: &#39;100Mi&#39;, &#39;cpu&#39;: &#39;100m&#39;}}}]&quot;","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617667,"discussion_content":"ğŸ‘ğŸ»æ„Ÿè°¢åˆ†äº«å’ŒæŒ‡æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683764564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370999,"user_name":"å°é©¬ğŸ","can_delete":false,"product_type":"c1","uid":1107540,"ip_address":"ä¸Šæµ·","ucode":"8CA466A4004BDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/54/86056001.jpg","comment_is_top":false,"comment_ctime":1679454283,"is_pvip":false,"replies":[{"id":135393,"content":"åœ¨ç¬¬äºŒå°èŠ‚åˆ›å»º KIND é›†ç¾¤çš„æ—¶å€™æŒ‡å®šäº† PortMappingï¼Œæš´éœ²äº†80ç«¯å£ï¼š\n\n\nkind: Cluster\napiVersion: kind.x-k8s.io&#47;v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: &quot;ingress-ready=true&quot;\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1679573392,"ip_address":"å¹¿ä¸œ","comment_id":370999,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"å•¥æ—¶å€™ç›‘å¬äº†80ç«¯å£äº† æˆ‘è¯·æ•™ä¸‹","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610465,"discussion_content":"åœ¨ç¬¬äºŒå°èŠ‚åˆ›å»º KIND é›†ç¾¤çš„æ—¶å€™æŒ‡å®šäº† PortMappingï¼Œæš´éœ²äº†80ç«¯å£ï¼š\n\n\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: &#34;ingress-ready=true&#34;\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679573392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370380,"user_name":"å…»å…»","can_delete":false,"product_type":"c1","uid":2418972,"ip_address":"å¹¿ä¸œ","ucode":"DF417C51CBCE7A","user_header":"https://static001.geekbang.org/account/avatar/00/24/e9/1c/81dc0585.jpg","comment_is_top":false,"comment_ctime":1678772640,"is_pvip":false,"replies":[{"id":135076,"content":"ä½¿ç”¨ K8s æ¢é’ˆï¼Œåœ¨ 12 è®²ä¸­æœ‰è¯¦ç»†ä»‹ç»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1678802265,"ip_address":"å¹¿ä¸œ","comment_id":370380,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"æ€ä¹ˆåˆ¤æ–­podæ•…éšœçš„ï¼Ÿæ–‡ç« ä¸­æ²¡çœ‹åˆ°è®¾ç½®çš„åœ°æ–¹ï¼Œæ˜¯é€šè¿‡å¯¹åº”podçš„ç«¯å£å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609061,"discussion_content":"ä½¿ç”¨ K8s æ¢é’ˆï¼Œåœ¨ 12 è®²ä¸­æœ‰è¯¦ç»†ä»‹ç»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1678802265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369457,"user_name":"ä¸æ±‚","can_delete":false,"product_type":"c1","uid":1347935,"ip_address":"åŒ—äº¬","ucode":"3F1FA537E67A5C","user_header":"https://static001.geekbang.org/account/avatar/00/14/91/5f/88d36112.jpg","comment_is_top":false,"comment_ctime":1677560492,"is_pvip":false,"replies":[{"id":134669,"content":"ä½ å¯èƒ½éœ€è¦æ£€æŸ¥ä¸€ä¸‹ K8s ç‰ˆæœ¬å’Œ Kubectl çš„ç‰ˆæœ¬ï¼Œå¯ä»¥å…ˆå°è¯•æŠŠ kubectl å‡çº§åˆ°æœ€æ–°ç‰ˆã€‚\næˆ‘æœ¬åœ°çš„ Kubectl ç‰ˆæœ¬æ˜¯ v1.24.3ï¼Œåˆ›å»ºæ­£å¸¸ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1677638707,"ip_address":"å¹¿ä¸œ","comment_id":369457,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"ä½ å¥½ è€å¸ˆ ä½¿ç”¨ kubectl create ingress å‘½ä»¤åˆ›å»º Ingressæ—¶ error: unknown flag: --rule æ˜¯ä¸æ˜¯æ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607139,"discussion_content":"ä½ å¯èƒ½éœ€è¦æ£€æŸ¥ä¸€ä¸‹ K8s ç‰ˆæœ¬å’Œ Kubectl çš„ç‰ˆæœ¬ï¼Œå¯ä»¥å…ˆå°è¯•æŠŠ kubectl å‡çº§åˆ°æœ€æ–°ç‰ˆã€‚\næˆ‘æœ¬åœ°çš„ Kubectl ç‰ˆæœ¬æ˜¯ v1.24.3ï¼Œåˆ›å»ºæ­£å¸¸ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677638707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1347935,"avatar":"https://static001.geekbang.org/account/avatar/00/14/91/5f/88d36112.jpg","nickname":"ä¸æ±‚","note":"","ucode":"3F1FA537E67A5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607163,"discussion_content":"å¯ä»¥äº†ï¼Œ ç¡®å®æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ æ„Ÿè°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677652124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367390,"user_name":"åƒä¸¤å—äº‘","can_delete":false,"product_type":"c1","uid":2383857,"ip_address":"ä¸Šæµ·","ucode":"A50874612046AF","user_header":"https://static001.geekbang.org/account/avatar/00/24/5f/f1/c66c8c51.jpg","comment_is_top":false,"comment_ctime":1675181830,"is_pvip":false,"replies":[{"id":133895,"content":"é›†ç¾¤èµ„æºä¸å¤Ÿï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ Docker Desktop å¯ä»¥è°ƒæ•´ä¸€ä¸‹èµ„æºè®¾ç½®ï¼Œå®åœ¨è§£å†³ä¸äº†å¯ä»¥è€ƒè™‘å¼€é€šä¸€ä¸ªäº‘å‚å•†é›†ç¾¤æ¥æµ‹è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1675414479,"ip_address":"å¹¿ä¸œ","comment_id":367390,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"éƒ¨ç½²ingress-nginxçš„æ—¶å€™ pod èµ·ä¸æ¥ï¼ŒæŠ¥é”™ï¼š\n0&#47;1 nodes are available: 1 Insufficient cpu. preemption: 0&#47;1 nodes are available: 1 No preemption victims found for incoming pod.\nçœ‹ç€å‰é¢åƒæ˜¯cpuä¸å¤Ÿï¼Œæœ‰å…¶ä»–äººä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜çš„ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601798,"discussion_content":"é›†ç¾¤èµ„æºä¸å¤Ÿï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ Docker Desktop å¯ä»¥è°ƒæ•´ä¸€ä¸‹èµ„æºè®¾ç½®ï¼Œå®åœ¨è§£å†³ä¸äº†å¯ä»¥è€ƒè™‘å¼€é€šä¸€ä¸ªäº‘å‚å•†é›†ç¾¤æ¥æµ‹è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675414480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366370,"user_name":"èŒƒé£æ‰¬","can_delete":false,"product_type":"c1","uid":2721761,"ip_address":"ä¸Šæµ·","ucode":"A665DF46833A81","user_header":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","comment_is_top":false,"comment_ctime":1673643265,"is_pvip":false,"replies":[{"id":133498,"content":"åˆ é™¤æ‰€æœ‰çš„ deployment å·¥ä½œè´Ÿè½½å°±å¯ä»¥äº†ï¼Œåˆ é™¤ Pod çš„è¯å·¥ä½œè´Ÿè½½ä¼šæŠŠ Pod é‡æ–°æ‹‰èµ·æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1673668845,"ip_address":"å¹¿ä¸œ","comment_id":366370,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"è€å¸ˆå®éªŒå®Œæ€ä¹ˆæ”¶å°¾å‘€ï¼Œæˆ‘å‘ç°ç”¨kubectl delete pod --all ä¹‹åï¼Œk8sè¿˜æ˜¯ä¼šé‡æ–°æ‹‰ä¸¤ä¸ªpodsèµ·æ¥","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599649,"discussion_content":"åˆ é™¤æ‰€æœ‰çš„ deployment å·¥ä½œè´Ÿè½½å°±å¯ä»¥äº†ï¼Œåˆ é™¤ Pod çš„è¯å·¥ä½œè´Ÿè½½ä¼šæŠŠ Pod é‡æ–°æ‹‰èµ·æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673668846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2721761,"avatar":"https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg","nickname":"èŒƒé£æ‰¬","note":"","ucode":"A665DF46833A81","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":599653,"discussion_content":"è°¢è°¢è€å¸ˆï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673671383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":599649,"ip_address":"å¹¿ä¸œ","group_id":0},"score":599653,"extra":""}]}]},{"had_liked":false,"id":366101,"user_name":"LouisYuan","can_delete":false,"product_type":"c1","uid":2536553,"ip_address":"ä¸Šæµ·","ucode":"8D16568EC5A7DB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/LvrILicoibOUNTcVQFHSHtia0D8LZ8iaWMibtGYTZiaI9Xr8Oqsl2YfGmjKzKqOXy3Yb1fbkEFNe4g7CoPxvc7mZxjyw/132","comment_is_top":false,"comment_ctime":1673403059,"is_pvip":true,"replies":[{"id":133418,"content":"CPU å’Œå†…å­˜ä½¿ç”¨ç‡é™ä¸‹æ¥ä¹‹åä¼šè‡ªåŠ¨ç¼©å®¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1673443999,"ip_address":"å¹¿ä¸œ","comment_id":366101,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"è¿™æ‰©å®¹å®Œäº†ä¹‹åå’‹è‡ªåŠ¨ç¼©å®¹","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599322,"discussion_content":"CPU å’Œå†…å­˜ä½¿ç”¨ç‡é™ä¸‹æ¥ä¹‹åä¼šè‡ªåŠ¨ç¼©å®¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673444000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364538,"user_name":"fireshort","can_delete":false,"product_type":"c1","uid":1008312,"ip_address":"å¹¿ä¸œ","ucode":"10550CA9C6C730","user_header":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","comment_is_top":false,"comment_ctime":1671091690,"is_pvip":false,"replies":[{"id":132517,"content":"kubectl get service æ£€æŸ¥ä¸€ä¸‹ service æ˜¯å¦éƒ¨ç½²äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671101481,"ip_address":"å¹¿ä¸œ","comment_id":364538,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"kubectl describe ingress hello-world-flask\nName:             hello-world-flask\nLabels:           &lt;none&gt;\nNamespace:        default\nAddress:\nDefault backend:  default-http-backend:80 (&lt;error: endpoints &quot;default-http-backend&quot; not found&gt;)\nRules:\n  Host        Path  Backends\n  ----        ----  --------\n  *\n              &#47;   hello-world-flask:5000 (10.10.2.209:5000,10.10.2.210:5000)\nAnnotations:  &lt;none&gt;\nEvents:       &lt;none&gt;\n\nè¿™ä¸ªçœ‹èµ·æ¥æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯æ‰§è¡Œ\n curl http:&#47;&#47;127.0.0.1\nå¾—åˆ°ï¼š\ncurl: (7) Failed to connect to 127.0.0.1 port 80 after 0 ms: Connection refused\n\nè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596595,"discussion_content":"kubectl get service æ£€æŸ¥ä¸€ä¸‹ service æ˜¯å¦éƒ¨ç½²äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671101481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008312,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","nickname":"fireshort","note":"","ucode":"10550CA9C6C730","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597096,"discussion_content":"ä¸å¥½æ„æ€ï¼Œæ‰¾åˆ°åŸå› äº†ã€‚æˆ‘çš„k8sä¸æ˜¯ç”¨kindéƒ¨ç½²çš„ï¼Œnodeä¸Šæ²¡æœ‰åŠ ä¸Šlabelâ€œingress-ready=trueâ€ï¼Œingress-nginx-controlleræ‰¾ä¸åˆ°å¯ä»¥éƒ¨ç½²çš„nodeã€‚ç»™nodeåŠ ä¸Šå¯¹åº”labelå°±å¥½äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1671433174,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008312,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/b8/0e1b655e.jpg","nickname":"fireshort","note":"","ucode":"10550CA9C6C730","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596632,"discussion_content":"serviceä¹Ÿéƒ¨ç½²äº†çš„ã€‚serviceçœ‹èµ·æ¥ä¹Ÿæ˜¯æ­£å¸¸çš„ã€‚\n\nkubectl describe service hello-world-flask\nName:              hello-world-flask\nNamespace:         default\nLabels:            app=hello-world-flask\nAnnotations:       &lt;none&gt;\nSelector:          app=hello-world-flask\nType:              ClusterIP\nIP Family Policy:  SingleStack\nIP Families:       IPv4\nIP:                10.102.11.174\nIPs:               10.102.11.174\nPort:              5000-5000  5000/TCP\nTargetPort:        5000/TCP\nEndpoints:         10.1.0.201:5000,10.1.0.209:5000\nSession Affinity:  None\nEvents:            &lt;none&gt;","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1671159568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386417,"user_name":"ä¼šç®—æ•°çš„å°ç‹—","can_delete":false,"product_type":"c1","uid":3802362,"ip_address":"ç¾å›½","ucode":"176DEA78D3637E","user_header":"https://static001.geekbang.org/account/avatar/00/3a/04/fa/270c11d3.jpg","comment_is_top":false,"comment_ctime":1704788257,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"ä½ å¥½ï¼Œå¦‚æœæ˜¯ç”¨kubeadmå»ºçš„é›†ç¾¤è¦æ€ä¹ˆæš´éœ²80ç«¯å£ï¼Ÿingressçš„yamlæ–‡ä»¶éœ€è¦åšä»€ä¹ˆä¿®æ”¹å—","like_count":1},{"had_liked":false,"id":388365,"user_name":"Edward Guo","can_delete":false,"product_type":"c1","uid":1372780,"ip_address":"ä¸Šæµ·","ucode":"7235E87BAB3CD0","user_header":"https://static001.geekbang.org/account/avatar/00/14/f2/6c/1a080d7c.jpg","comment_is_top":false,"comment_ctime":1710038249,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"# kubectl create -f https:&#47;&#47;ghproxy.com&#47;https:&#47;&#47;raw.githubusercontent.com&#47;lyzhang1999&#47;resource&#47;main&#47;ingress-nginx&#47;ingress-nginx.yaml\nUnable to connect to the server: dial tcp 138.2.88.86:443: i&#47;o timeout\n\nè¯¾ç¨‹åˆæœŸä½¿ç”¨çš„ä¸€äº›é“¾æ¥å·²ç»å¤±æ•ˆäº†ï¼Œè¯·è€å¸ˆåŠæ—¶æ›´æ–°ä¸‹ï¼Œåç»§çš„å­¦å‘˜ä»¬æŒ‰ç€æ­¥éª¤è¿›è¡Œæ“ä½œå°±å¡å£³äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1078222,"avatar":"https://static001.geekbang.org/account/avatar/00/10/73/ce/23bd3997.jpg","nickname":"Wiggins","note":"","ucode":"021EE98CF0E4EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651145,"discussion_content":"å¯ä»¥å°†ghproxy.comæ›¿æ¢ä¸ºghp.ci","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1726282004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370170,"user_name":"dulp","can_delete":false,"product_type":"c1","uid":1314877,"ip_address":"æ±Ÿè‹","ucode":"4CFC3CB87A6640","user_header":"https://static001.geekbang.org/account/avatar/00/14/10/3d/b3991de7.jpg","comment_is_top":false,"comment_ctime":1678448780,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"ç°åœ¨ä½¿ç”¨çš„å°±æ˜¯k8sï¼Œè‡ªåŠ¨æ‰©å®¹ä½¿ç”¨autoscaleå®ç°ã€‚","like_count":0},{"had_liked":false,"id":364706,"user_name":"Geek_7c4279","can_delete":false,"product_type":"c1","uid":3247407,"ip_address":"æ²³åŒ—","ucode":"A085F4F1C29E77","user_header":"","comment_is_top":false,"comment_ctime":1671362941,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"ç§’","like_count":0}]}