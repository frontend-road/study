{"id":422016,"title":"02ï½œè“„åŠ¿å¾…å‘ï¼šç§’æ€ç³»ç»Ÿæ¶æ„è®¾è®¡å’Œç¯å¢ƒå‡†å¤‡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¿—ä¸œï¼Œæ¬¢è¿å’Œæˆ‘ä¸€èµ·ä»é›¶æ‰“é€ ç§’æ€ç³»ç»Ÿã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œç³»ç»Ÿçš„è®¾è®¡æ˜¯ä¸ªç”±å·¨å…¥ç»†çš„è¿‡ç¨‹ï¼Œæƒ³å»è®¾è®¡å¥½å®ƒï¼Œé‚£ä½ é¦–å…ˆå¾—å»äº†è§£æ¸…æ¥šå®ƒã€‚å°±åƒä¸ŠèŠ‚è¯¾æˆ‘ä»¬å¯¹HTTPè¯·æ±‚æ‰€èµ°é“¾è·¯çš„ä»‹ç»ï¼Œå­¦å®Œåä½ å°±ä¼šæ˜ç™½ï¼Œåšç§’æ€ç³»ç»Ÿè®¾è®¡æ—¶ï¼Œä¼šç”¨åˆ°å“ªäº›å±‚çº§ç³»ç»Ÿï¼Œå¹¶ä¸”æ¯ä¸ªå±‚çº§ç³»ç»Ÿå¯ä»¥åšä»€ä¹ˆäº‹æƒ…ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»™æ¯ä¸ªå±‚çº§ç³»ç»Ÿåšæœ€åˆé€‚çš„<strong>æŠ€æœ¯é€‰å‹å’ŒèŒèƒ½è¾¹ç•Œåˆ’åˆ†</strong>ï¼Œæœ€ç»ˆå®ç°è®©å„ç³»ç»Ÿã€æŠ€æœ¯åšå®ƒä»¬æ‰€æ“…é•¿çš„äº‹æƒ…ï¼Œå¹¶åœ¨æœ€åæ­å»ºèµ·æˆ‘ä»¬çš„å¼€å‘ä¾èµ–ç¯å¢ƒã€‚</p><p>é‚£å¦‚ä½•ç»™å±‚çº§ç³»ç»ŸåšæŠ€æœ¯é€‰å‹å’ŒèŒèƒ½è¾¹ç•Œåˆ’åˆ†å‘¢ï¼Ÿæˆ‘ä»¬é€šå¸¸éƒ½è¯´ï¼Œæ²¡æœ‰æœ€å¥½çš„æŠ€æœ¯ï¼Œåªæœ‰æœ€å¥‘åˆå½“ä¸‹ä¸šåŠ¡åœºæ™¯çš„æŠ€æœ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å…ˆäº†è§£ä¸€ä¸‹ï¼Œå¦‚æœä½¿ç”¨æˆ‘ä»¬ä¼ ç»Ÿçš„æ¶æ„ç³»ç»Ÿæ¥æ”¯æŒç§’æ€ä¸šåŠ¡ï¼Œå¯èƒ½ä¼šå‡ºç°å“ªäº›é—®é¢˜ã€‚åªæœ‰æ¸…æ¥šäº†è¦é¢å¯¹çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ‰èƒ½åšé’ˆå¯¹æ€§çš„æ€è€ƒå’Œä¼˜åŒ–ã€‚</p><p>æ‰€ä»¥è¿™èŠ‚è¯¾æˆ‘ä»¬å°†é‡ç‚¹åˆ†æä¼ ç»Ÿæ¶æ„è®¾è®¡çš„ç‰¹ç‚¹ï¼Œæ¥ç€ä»‹ç»æœ€æ–°çš„ç§’æ€ç³»ç»Ÿæ¶æ„ï¼Œå¹¶åšå¥½æŠ€æœ¯é€‰å‹å’Œç¯å¢ƒå‡†å¤‡ã€‚</p><h2>ä¼ ç»Ÿç§’æ€ç³»ç»Ÿæ¶æ„</h2><p>ä¸‹é¢å…ˆçœ‹ä¸€ä¸ªå¤§å®¶å¸¸ç”¨çš„ç³»ç»ŸåŠŸèƒ½æ¶æ„å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/75/10/75c66bf2cb65bdbb125b06765d148c10.jpg?wh=1800x1575\" alt=\"\"></p><p></p><p>è¿™ç§åŠŸèƒ½ç»“æ„ä»¥åŠç³»ç»Ÿæ¶æ„ï¼Œæ˜¯æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰çš„ã€‚åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼ŒNginxåªåšåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ï¼Œç”šè‡³è¿™å±‚å¯¹æˆ‘ä»¬åšä¸šåŠ¡å¼€å‘çš„ç ”å‘äººå‘˜æ¥è¯´ï¼Œéƒ½æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œä¸€èˆ¬è¿ç»´åŒäº‹åœ¨åšç”Ÿäº§ç¯å¢ƒæ­å»ºæ—¶ï¼Œéƒ½ä¼šå¸®æˆ‘ä»¬é…å¥½ã€‚ç ”å‘äººå‘˜æ›´å¤šçš„æ˜¯åœ¨å¼€å‘WebæœåŠ¡å’ŒRPCæœåŠ¡ï¼Œæˆ‘ä»¬æŠŠé¡µé¢ä»¥åŠé¡µé¢æ‰€ä¾èµ–çš„é™æ€èµ„æºéƒ½æ”¾åˆ°WebæœåŠ¡ä¸­ï¼ŒåŒæ—¶WebæœåŠ¡è¿˜æä¾›ä¸šåŠ¡æ¥å£ï¼ŒRPCæœåŠ¡æä¾›ä¸€äº›æ”¯æ’‘æœåŠ¡ã€‚</p><!-- [[[read_end]]] --><p>å¦‚æœè¿™æ˜¯ä¸ªToBçš„è¿è¥ç®¡ç†ç³»ç»Ÿï¼Œè¿™æ ·æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºè¯·æ±‚é‡éå¸¸ä½ï¼Œç³»ç»ŸåŸºæœ¬ä¸ä¼šæœ‰å¤ªå¤§çš„è´Ÿè½½ã€‚ä½†æ˜¯å¯¹äºToCï¼Œä¸”ç¬æ—¶æµé‡éå¸¸å¤§çš„æƒ…å†µï¼Œé—®é¢˜å°±ä¼šæš´éœ²å‡ºæ¥ï¼Œé‚£å®ƒç©¶ç«Ÿä¼šæœ‰å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</p><p></p><h3>åŸŸåä¸å¸¦å®½é—®é¢˜</h3><p>æˆ‘ä»¬ä»æœ€åŸºç¡€çš„è®²èµ·ã€‚å¦‚æœWebæœåŠ¡æ—¢æä¾›H5é¡µé¢ã€é™æ€èµ„æºï¼ŒåŒæ—¶ä¹Ÿæä¾›ä¸šåŠ¡æ¥å£ï¼Œè¿™å°±æ„å‘³ç€æ‰€æœ‰çš„è¯·æ±‚ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªåŸŸåï¼Œåœ¨æ´»åŠ¨åˆšå¼€å§‹æ—¶ï¼Œå¤§å®¶éƒ½ç‚¹å‡»æŠ¢è´­æŒ‰é’®è¿›ç»“ç®—é¡µï¼Œè€Œç»“ç®—é¡µé¡µé¢æ‹‰å–é™æ€èµ„æºï¼Œä¼šå ç”¨å¾ˆå¤šå¸¦å®½èµ„æºã€‚</p><p>è¿™åœ¨æ´»åŠ¨å¼€å§‹çš„ç¬é—´ï¼Œå¸¦å®½èµ„æºå¾ˆç¨€ç¼ºçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç”¨æˆ·è¿›ä¸äº†ç»“ç®—é¡µï¼Œæˆ–è€…è¿›äº†ç»“ç®—é¡µå´ä¸èƒ½æ­£å¸¸æ¸²æŸ“é¡µé¢çš„é—®é¢˜ï¼Œå¯¼è‡´æŠ¢è´­ä½“éªŒå¤§å¹…ä¸‹é™ã€‚</p><p></p><h3>WebæœåŠ¡å™¨æ€§èƒ½é—®é¢˜</h3><p>æ¥ç€ï¼Œè®²ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚æˆ‘ä»¬ä¸€èˆ¬éƒ¨ç½²WebæœåŠ¡ï¼Œéƒ½æ˜¯ä½¿ç”¨Apacheçš„Tomcatæ¥éƒ¨ç½²çš„ï¼ŒTomcatåœ¨å¤„ç†è¯·æ±‚çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡çº¿ç¨‹å»å¤„ç†çš„ã€‚</p><p>è¿™æ ·çš„é—®é¢˜å°±æ˜¯å¦‚æœç¬æ—¶çš„å¤§é‡è¯·æ±‚è¿‡æ¥ï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¸å¤Ÿç”¨ï¼ŒTomcatå°±ä¼šç¬é—´æ–°å»ºå¾ˆå¤šçº¿ç¨‹ï¼Œç›´è‡³è¾¾åˆ°é…ç½®çš„æœ€å¤§çº¿ç¨‹æ•°ï¼Œå¦‚æœçº¿ç¨‹æ•°è®¾ç½®çš„è¿‡å¤§ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šç›´æ¥å°†æœºå™¨çš„CPUæ‰“æ»¡ï¼Œå¯¼è‡´æœºå™¨æ­»æ‰ã€‚å³ä½¿æ²¡æœ‰æŒ‚æ‰ï¼Œåœ¨é«˜è´Ÿè½½ä¸‹ï¼Œå½“è®¾ç½®çš„ç­‰å¾…é˜Ÿåˆ—ä¹Ÿæ»¡äº†ä¹‹åï¼Œåé¢çš„è¯·æ±‚éƒ½ä¼šè¢«æ‹’ç»è¿æ¥ï¼Œç›´åˆ°æœ‰ç©ºå‡ºçš„èµ„æºå»å¤„ç†æ–°è¯·æ±‚ã€‚è¿™æ—¶å€™ä½ å¯èƒ½ä¼šæƒ³ï¼Œæˆ‘åŠ æœºå™¨åˆ†æ‘Šæµé‡ä¸å°±è¡Œäº†ï¼Ÿå¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†ç”±æ­¤å¢åŠ çš„æ´»åŠ¨æˆæœ¬ä¸çŸ¥é“ä½ çš„è€æ¿ä¼šä¸ä¼šä¹°å•ï¼Ÿ</p><p></p><p>å½“ç„¶äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè¿˜ä¼šä¼´æœ‰çƒ­ç‚¹æ•°æ®è¯»å†™ã€åº“å­˜è¶…å–ç­‰é—®é¢˜ï¼Œè¿™äº›ç»†èŠ‚ä¹Ÿéå¸¸é‡è¦ï¼Œæˆ‘ä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­ä¸€ä¸€ç»™ä½ å±•å¼€è¯´æ˜ã€‚</p><p></p><h2><strong>æ–°çš„ç§’æ€ç³»ç»Ÿæ¶æ„</strong></h2><p>ä¸Šé¢æˆ‘ä»¬è°ˆåˆ°äº†ä¼ ç»Ÿç³»ç»Ÿæ¶æ„çš„å±€é™æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ–°çš„ç³»ç»Ÿè¯¥å¦‚ä½•è®¾è®¡æ‰èƒ½é¿å…å‡ºç°ä»¥ä¸Šé—®é¢˜å‘¢ï¼Ÿç»“åˆä¸ŠèŠ‚è¯¾å¯¹äºå„é“¾è·¯å±‚çº§çš„ä»‹ç»ï¼Œæˆ‘ç”»äº†ä¸€å¼ æ–°çš„åŠŸèƒ½ç»“æ„ä¸ç³»ç»Ÿæ¶æ„å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/6e/8e/6eaca4f202c11ca5fc4954512cda858e.jpg?wh=1800x1671\" alt=\"\"></p><p>é¦–å…ˆæ–°ç³»ç»Ÿæˆ‘ä»¬ä¾ç„¶ä¿ç•™äº†HTTPæœåŠ¡å¸¸ç”¨çš„å±‚çº§è°ƒç”¨å…³ç³»ï¼Œå³ <strong>Nginx-&gt;WebæœåŠ¡-&gt;RPCæœåŠ¡</strong>ï¼Œè¿™ä¹Ÿæ˜¯ç»å¤§éƒ¨åˆ†å…¬å¸éƒ½ä¼šä½¿ç”¨çš„ä¸€ç§ç³»ç»Ÿç»“æ„ã€‚</p><p>å…¶æ¬¡å°†åŸå…ˆç”±WebæœåŠ¡æä¾›çš„é™æ€èµ„æºæ”¾åˆ°äº†CDNï¼ˆCDNæ˜¯å…¨å›½éƒ½æœ‰çš„æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ ¹æ®æ‰€å¤„ä½ç½®è‡ªåŠ¨å°±è¿‘ä»CDNä¸Šæ‹‰å–é™æ€èµ„æºï¼Œé€Ÿåº¦æ›´å¿«ï¼‰ï¼Œæ¥å¤§å¤§å‡è½»æŠ¢è´­ç¬æ—¶ç§’æ€åŸŸåçš„è´Ÿæ‹…ã€‚</p><p>æœ€åï¼ŒåŒæ—¶ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€åšçš„æœ€å¤§æ”¹å˜ï¼Œå°±æ˜¯<strong>å°†Nginxçš„èŒè´£æ”¾å¤§</strong>ï¼Œå‰ç½®ç”¨æ¥åšWebç½‘å…³ï¼Œæ‰¿æ‹…éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘æ ¡éªŒï¼Œå¹¶ä¸”å¢åŠ é»‘ç™½åå•ã€é™æµå’Œæµæ§çš„åŠŸèƒ½ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯è€ƒè™‘åˆ°æˆ‘ä»¬çš„ç§’æ€ä¸šåŠ¡ç‰¹ç‚¹æ‰€åšçš„è°ƒæ•´ã€‚è¿™ç§åœ¨Nginxé‡Œå†™ä¸šåŠ¡çš„åšæ³•åœ¨å¾ˆå¤šå¤§å…¬å¸é‡Œéƒ½æ˜¯å¾ˆå¸¸è§çš„ï¼Œåƒäº¬ä¸œæ˜¯ç”¨æ¥åšå•†è¯¦ã€ç§’æ€çš„ä¸šåŠ¡ç½‘å…³ï¼Œç¾å›¢ç”¨æ¥åšè´Ÿè½½å‡è¡¡æ¥å…¥å±‚ï¼Œ12306ç”¨æ¥åšè½¦ç¥¨æŸ¥è¯¢ç­‰ç­‰ï¼Œä»–ä»¬çš„å…±åŒç‰¹ç‚¹éƒ½æ˜¯è¦é¢å¯¹é«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯ï¼Œè¿™ä¹Ÿè¯´æ˜åœ¨è¿™ç§ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬çš„è®¾è®¡æ˜¯å¾—åˆ°äº†çœŸå®å®è·µå’Œå¹¿æ³›è®¤å¯çš„ã€‚</p><p>è€Œè¿™ä¹ˆåšçš„ç›®çš„ï¼Œå°±æ˜¯è¦å……åˆ†åˆ©ç”¨Nginxçš„é«˜å¹¶å‘ã€é«˜ååèƒ½åŠ›ï¼Œå¹¶ä¸”éå¸¸å¥‘åˆæˆ‘ä»¬ç§’æ€ä¸šåŠ¡çš„ç‰¹ç‚¹ï¼Œå³å…¥å£æµé‡å¤§ã€‚ä½†æµé‡ç»„æˆå´éå¸¸çš„æ··æ‚ï¼Œè¿™äº›è¯·æ±‚ä¸­ï¼Œä¸€éƒ¨åˆ†æ˜¯åˆ·å­è¯·æ±‚ï¼Œä¸€éƒ¨åˆ†æ˜¯æ— æ•ˆè¯·æ±‚ï¼ˆä¼ å‚ç­‰å¼‚å¸¸ï¼‰ï¼Œå‰©ä¸‹çš„æ‰æ˜¯æ­£å¸¸è¯·æ±‚ï¼Œè¿™ä¸ªçš„æ¯”ä¾‹å¯èƒ½æ˜¯6ï¼š1ï¼š3ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬åœ¨ç½‘å…³å±‚å°½å¯èƒ½å¤šåœ°æ¥æ”¶æµé‡è¿›æ¥ï¼Œå¹¶åšç²¾ç¡®åœ°ç­›é€‰ï¼Œå°†çœŸæ­£æœ‰æ•ˆçš„3æˆè¯·æ±‚åˆ†å‘åˆ°ä¸‹æ¸¸ï¼Œå‰©ä½™çš„7æˆæ‹¦æˆªåœ¨ç½‘å…³å±‚ã€‚ä¸ç„¶æŠŠè¿™äº›æµé‡éƒ½æ‰“åˆ°WebæœåŠ¡å±‚ï¼ŒWebæœåŠ¡å†æ–°èµ·çº¿ç¨‹æ¥å¤„ç†åˆ·å­å’Œæ— æ•ˆè¯·æ±‚ï¼Œè¿™æ˜¯ç§èµ„æºçš„æµªè´¹ã€‚</p><p>æ‰€ä»¥ç½‘å…³å±‚å¯¹ç§’æ€ç³»ç»Ÿè€Œè¨€ï¼Œè‡³å…³é‡è¦ï¼Œè€ŒNginxåˆšå¥½å¯ä»¥èƒœä»»æ­¤é¡¹ä»»åŠ¡ã€‚ç”±æ­¤å¯è§ï¼ŒNginxåœ¨æˆ‘ä»¬çš„ç³»ç»Ÿè®¾è®¡ä¸­ï¼Œæ‰®æ¼”ç€éå¸¸é‡è¦çš„è§’è‰²ï¼Œä½†ä½ å¯¹Nginxä¹Ÿè®¸æ²¡é‚£ä¹ˆäº†è§£ï¼Œåˆ«æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘å°±ç»™ä½ ç®€å•ä»‹ç»ä¸€ä¸‹Nginxï¼Œå¹¶å¸¦ä½ è§£å¼€Nginxåœ¨é«˜å¹¶å‘ä¸‹ä»å…·æœ‰é«˜æ€§èƒ½çš„ç§˜å¯†ã€‚</p><p></p><h3><strong>Nginxä»‹ç»</strong></h3><p>Nginxæœ€æ—©è¢«å‘æ˜å‡ºæ¥ï¼Œå°±æ˜¯æ¥åº”å¯¹äº’è”ç½‘é«˜é€Ÿå‘å±•ä¸‹ï¼Œå‡ºç°çš„å¹¶å‘å‡ åä¸‡ã€ä¸Šç™¾ä¸‡çš„ç½‘ç»œè¯·æ±‚è¿æ¥åœºæ™¯çš„ï¼Œä¼ ç»ŸApacheæœåŠ¡å™¨æ— æ³•æœ‰æ•ˆåœ°è§£å†³è¿™ç§é—®é¢˜ï¼Œè€ŒNginxå´å…·æœ‰å¹¶å‘èƒ½åŠ›å¼ºã€èµ„æºæ¶ˆè€—ä½çš„ç‰¹æ€§ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒNginxæœ‰5å¤§ä¼˜ç‚¹ï¼Œå³<strong>æ¨¡å—åŒ–ã€äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥ã€éé˜»å¡ã€å¤šè¿›ç¨‹å•çº¿ç¨‹</strong>ã€‚ä»¥ä¸‹æ˜¯Nginxçš„æ¶æ„åŸç†å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/3a/9b/3a811fe3cec72e5487e48a5f236f739b.jpg?wh=2406x1084\" alt=\"\"></p><p>Nginxæ˜¯ç”±ä¸€ä¸ªmasterè¿›ç¨‹å’Œå¤šä¸ªworkerè¿›ç¨‹ï¼ˆå¯é…ç½®ï¼‰æ¥é…åˆå®Œæˆå·¥ä½œçš„ã€‚å…¶ä¸­masterè¿›ç¨‹è´Ÿè´£Nginxé…ç½®æ–‡ä»¶çš„åŠ è½½å’Œworkerè¿›ç¨‹çš„ç®¡ç†å·¥ä½œï¼Œè€Œworkerè¿›ç¨‹è´Ÿè´£è¯·æ±‚çš„å¤„ç†ä¸è½¬å‘ï¼Œè¿›ç¨‹ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œäº’ä¸å¹²æ‰°ã€‚åŒæ—¶æ¯ä¸ªè¿›ç¨‹ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™å°±çœå»äº†å¹¶å‘æƒ…å†µä¸‹çš„åŠ é”ä»¥åŠçº¿ç¨‹çš„åˆ‡æ¢å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</p><p><strong>ä½†ä¸€ä¸ªçº¿ç¨‹èƒ½æ”¯æŒé«˜å¹¶å‘çš„ä¸šåŠ¡åœºæ™¯å—ï¼Ÿ</strong></p><p>è¿™å°±è¦è¯´åˆ°Nginxçš„å·¥ä½œæ¨¡å‹ã€‚ä»¥Linuxä¸ºä¾‹ï¼Œå…¶é‡‡ç”¨çš„æ˜¯epollæ¨¡å‹ï¼ˆå³äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼‰ï¼Œè¯¥æ¨¡å‹æ˜¯IOå¤šè·¯å¤ç”¨æ€æƒ³çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œæ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯ä¸€ä¸ªè¯·æ±‚è¿›æ¥åï¼Œä¼šç”±ä¸€ä¸ªworkerè¿›ç¨‹å»å¤„ç†ï¼Œå½“ç¨‹åºä»£ç æ‰§è¡Œåˆ°IOæ—¶ï¼Œæ¯”å¦‚è°ƒç”¨å¤–éƒ¨æœåŠ¡æˆ–æ˜¯é€šè¿‡upstreamåˆ†å‘è¯·æ±‚åˆ°åç«¯WebæœåŠ¡æ—¶ï¼ŒIOæ˜¯é˜»å¡çš„ï¼Œä½†æ˜¯workerè¿›ç¨‹ä¸ä¼šä¸€ç›´åœ¨è¿™ç­‰ç€ï¼Œè€Œæ˜¯ç­‰IOæœ‰ç»“æœäº†å†å¤„ç†ï¼Œåœ¨è¿™æœŸé—´å®ƒä¼šå»å¤„ç†åˆ«çš„è¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨CPUèµ„æºå»å¤„ç†å¤šä¸ªè¯·æ±‚äº†ã€‚</p><p>è¿™é‡Œä½ è¿˜å¯ä»¥æ€è€ƒè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šLinuxæ”¯æŒçš„ä»¥IOå¤šè·¯å¤ç”¨æ€æƒ³æ¥å®ç°çš„æ¨¡å‹è¿˜æœ‰selectå’Œpollï¼Œä¸ºä»€ä¹ˆé€‰æ‹©äº†epollå‘¢ï¼Ÿ<strong>å› ä¸ºepollçš„æ•ˆç‡æ›´é«˜ã€‚</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼Œåˆšåˆšæˆ‘ä»¬ä¸Šé¢è¯´åˆ°workeråœ¨å¤„ç†è¯·æ±‚åˆ°IOæ—¶ï¼Œä¸ä¼šé˜»å¡ç­‰å¾…ï¼Œè€Œæ˜¯å»å¹²å…¶ä»–äº‹æƒ…ï¼Œç­‰IOæœ‰ç»“æœäº†å†å›å¤´å¤„ç†ï¼Œé‚£workerè¿›ç¨‹æ€ä¹ˆçŸ¥é“åˆšåˆšçš„IOå¤„ç†å®Œæ¯•äº†å‘¢ï¼Ÿ</p><p>å‡è®¾ä¸€ä¸ªwork&nbsp;processå¤„ç†äº†1000ä¸ªè¿æ¥ï¼Œä½†å…¶ä¸­åªæœ‰10ä¸ªIOå®Œæˆäº†ï¼Œå¹¶å¯ä»¥ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œselect/pollçš„åšæ³•æ˜¯éå†è¿™1000ä¸ªFDï¼ˆFile Descriptionï¼Œå¯ä»¥ç†è§£æˆæ¯ä¸ªå»ºç«‹äº†è¿æ¥çš„ä¸€ä¸ªæ ‡è¯†ï¼‰ï¼Œæ‰¾åˆ°é‚£10ä¸ªå°±ç»ªçŠ¶æ€çš„ï¼Œå¹¶æŠŠæ²¡åšå®Œçš„äº‹æƒ…ç»§ç»­åšå®Œï¼Œè¿™æ ·æ£€ç´¢çš„æ•ˆç‡æ˜æ˜¾å¾ˆä½ã€‚æ‰€ä»¥epollçš„åšæ³•æ˜¯å½“è¿™10ä¸ªIOå‡†å¤‡å°±ç»ªæ—¶ï¼Œé€šè¿‡ç³»ç»Ÿçš„å›è°ƒå‡½æ•°å°†FDæ”¾åˆ°ä¸€ä¸ªä¸“é—¨çš„å°±ç»ªåˆ—è¡¨ä¸­ï¼Œè¿™æ ·ç³»ç»Ÿåªéœ€è¦å»æ‰¾è¿™ä¸ªå°±ç»ªåˆ—è¡¨å°±å¯ä»¥äº†ï¼Œè¿™å¤§å¤§æé«˜äº†ç³»ç»Ÿçš„å“åº”æ•ˆç‡ã€‚å½“ç„¶è¿™åªæ˜¯epollçš„å…¶ä¸­ä¸€ä¸ªä¼˜ç‚¹ï¼Œå…·ä½“ä¸‰ç§æ¨¡å‹çš„å¯¹æ¯”ï¼Œä½ å¯ä»¥è‡ªè¡Œå»äº†è§£ä¸€ä¸‹ï¼Œç½‘ä¸Šç›¸å…³çš„èµ„æ–™æœ‰å¾ˆå¤šï¼Œæˆ–è€…æˆ‘ä»¬åœ¨ç•™è¨€åŒºè®¨è®ºä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>æ­£æ˜¯<strong>å¤šè¿›ç¨‹+äº‹ä»¶é©±åŠ¨</strong>çš„å·¥ä½œåŸç†ï¼Œæ‰ä½¿å¾—Nginxå…·æœ‰éå¸¸è‰¯å¥½çš„æ€§èƒ½è¡¨ç°ï¼ŒåŒæ—¶Nginxçš„æ¨¡å—åŒ–ï¼Œä¹Ÿèƒ½å¤Ÿæ”¯æ’‘å¼ºå¤§çš„ç¬¬ä¸‰æ–¹è‡ªå®šä¹‰å·¥å…·æ¨¡å—ï¼Œè®©ä½ çš„å¼€å‘æ›´åŠ çµæ´»è‡ªç”±ã€‚</p><p></p><h3><strong>OpenRestyä»‹ç»</strong></h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒNginxçš„åº•å±‚æ¨¡å—ä¸€èˆ¬éƒ½æ˜¯ç”¨Cè¯­è¨€å†™çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨Nginxçš„åŸºç¡€ä¹‹ä¸Šå†™ä¸šåŠ¡é€»è¾‘ï¼Œè¿˜å¾—å€ŸåŠ©OpenRestyï¼Œå®ƒæ˜¯Nginxçš„ä¸€ä¸ªç¤¾åŒºåˆ†æ”¯ã€‚è¿™é‡Œæˆ‘ä¹Ÿç®€å•ä»‹ç»ä¸€ä¸‹å®ƒã€‚</p><p>OpenRestyæ˜¯ä¸€ä¸ªåŸºäº Nginx ä¸ Lua çš„é«˜æ€§èƒ½ Web å¹³å°ï¼Œå®ƒä½¿æˆ‘ä»¬å…·å¤‡åœ¨Nginxä¸Šä½¿ç”¨Luaè¯­è¨€æ¥å¼€å‘ä¸šåŠ¡é€»è¾‘çš„èƒ½åŠ›ï¼Œå¹¶å……åˆ†åˆ©ç”¨ Nginx çš„éé˜»å¡ IO æ¨¡å‹ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬éå¸¸æ–¹ä¾¿åœ°æ­å»ºèƒ½å¤Ÿå¤„ç†è¶…é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ã€Web æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚</p><p>è¿™é‡Œæ’ä¸€å¥ï¼Œ<strong>ä¸ºä»€ä¹ˆè¦ç”¨Luaè¯­è¨€æ¥åšNginxå¼€å‘å‘¢ï¼Ÿ</strong>è¿™å°±è¦è¯´åˆ°Luaè¯­è¨€çš„ç‰¹ç‚¹äº†ï¼ŒLuaçš„çº¿ç¨‹æ¨¡å‹æ˜¯å•çº¿ç¨‹å¤šåç¨‹çš„æ¨¡å¼ï¼Œè€ŒNginxåˆšå¥½æ˜¯å•è¿›ç¨‹å•çº¿ç¨‹ï¼Œå¤©ç”Ÿçš„å®Œç¾æ­æ¡£ã€‚åŒæ—¶Luaæ˜¯ä¸€ç§å°å·§çš„è„šæœ¬è¯­è¨€ï¼Œè¯­æ³•éå¸¸çš„ç®€å•ï¼Œå¾ˆå®¹æ˜“å­¦ä¹ æŒæ¡ï¼Œæ‰€ä»¥å¯¹äºæ–°è¯­è¨€ä½ å…ˆä¸è¦æœ‰æ’æ–¥å¿ƒç†ï¼Œæˆ‘ä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­æ…¢æ…¢å‘ä½ å±•ç¤ºè®²è§£ã€‚</p><h2><strong>Web/RPCæœåŠ¡æŠ€æœ¯é€‰å‹</strong></h2><p>ä»¥ä¸Šæˆ‘ä»‹ç»å®Œäº†NginxæœåŠ¡å±‚çš„æŠ€æœ¯é€‰å‹ï¼ŒåŒæ—¶ä¹Ÿè®²è§£äº†ä¸ºä»€ä¹ˆè¿™ä¹ˆé€‰çš„åŸå› ï¼Œä¸‹é¢å°±è½®åˆ°WebæœåŠ¡å’ŒRPCæœåŠ¡äº†ã€‚</p><p>è¿™é‡Œå¤§çš„æ¡†æ¶é€‰æ‹©ï¼Œå…¶å®å°±æ²¡æœ‰å¤ªå¤šè¦æ±‚äº†ï¼Œåªè¦èƒ½æä¾›æˆ‘ä»¬éœ€è¦çš„èƒ½åŠ›å³å¯ï¼Œæ¯”å¦‚åŸºç¡€æ¡†æ¶æ˜¯ä½¿ç”¨SpringMVCè¿˜æ˜¯SpringBootï¼ŒæŒä¹…å±‚æ˜¯å–œæ¬¢ç”¨MyBatisè¿˜æ˜¯JPAï¼Œæ•°æ®åº“æ˜¯ç”¨MySQLè¿˜æ˜¯Oracleï¼Œè¿™äº›éƒ½å¯ä»¥æ ¹æ®ä½ çš„ä¸ªäººä½¿ç”¨ä¹ æƒ¯æˆ–è€…æ‰€åœ¨å…¬å¸çš„æŠ€æœ¯æ ˆåšçµæ´»å˜é€šã€‚</p><p>åŒæ—¶å¯¹äºå·²ç»æœ‰ç§’æ€ç³»ç»Ÿï¼Œä½†æ˜¯æƒ³è¦åšä¼˜åŒ–çš„æƒ…å†µï¼Œä¹Ÿå®Œå…¨ä¸ç”¨æ‹…å¿ƒï¼Œè·Ÿç€æˆ‘å­¦ä¹ ä¹‹åï¼Œä½ åªéœ€å°†æ—§ç³»ç»Ÿä¸­çš„éƒ¨åˆ†è½»ä¸šåŠ¡é€»è¾‘è¿ç§»åˆ°Nginxå±‚æ¥ï¼Œä½“é‡æœ€å¤§çš„ä¸šåŠ¡é€»è¾‘ä»£ç åŸºæœ¬éƒ½ä¸ç”¨åŠ¨çš„ï¼Œå¹¶ä¸”æ—§ç³»ç»Ÿä¸­çš„ä¸€äº›ä¼˜åŒ–ç‚¹ï¼Œä¹Ÿéƒ½æœ‰å•ç‹¬çš„æŠ€æœ¯æ¥å®ç°ï¼Œè€Œè¿™äº›éƒ½ä¸éœ€è¦å¤ªå¤šçš„å­¦ä¹ æˆæœ¬å’Œè¿ç§»æˆæœ¬ã€‚</p><p>é‚£ä¹ˆä¸ºäº†æ›´å¥½çš„æœ¬åœ°å¼€å‘æ•™å­¦ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹<strong>æˆ‘æ‰€ä½¿ç”¨çš„æŠ€æœ¯æ ˆ</strong>ï¼šWebæœåŠ¡å’ŒRPCæœåŠ¡çš„åŸºç¡€æ¡†æ¶éƒ½æ˜¯ä½¿ç”¨SpringMVCï¼ŒRPCæ¡†æ¶ä½¿ç”¨çš„æ˜¯Dubboï¼Œæ•°æ®åº“ä½¿ç”¨å…è´¹å¼€æºçš„MySQLï¼Œåˆ†å¸ƒå¼ç¼“å­˜æ•°æ®åº“ä½¿ç”¨Redisï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯å¤§å¤šæ•°å…¬å¸ä¼šä½¿ç”¨çš„æŠ€æœ¯æ ˆã€‚</p><p>åœ¨æŠ€æœ¯é€‰å‹å’Œå±‚çº§ç³»ç»ŸèŒèƒ½åˆ’åˆ†éƒ½ç¡®å®šäº†ä¹‹åï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬åŠ¨èµ·æ‰‹æ¥ï¼Œå…ˆæŠŠå¼€å‘çš„ä¾èµ–ç¯å¢ƒå‡†å¤‡å¥½ã€‚</p><h3><strong>ç¯å¢ƒå‡†å¤‡</strong></h3><p>ä»¥ä¸‹æ˜¯æˆ‘åœ¨æœ¬åœ°Macä¸Šçš„å®‰è£…æ–¹å¼ï¼Œå¦‚æœä½ æ˜¯å…¶ä»–ç³»ç»Ÿï¼Œå¯ä»¥æ‰¾å¯¹åº”çš„å®‰è£…æ–¹æ³•ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´åº”è¯¥æ˜¯æ²¡éš¾åº¦çš„ã€‚å¦‚æœMacä¸Šæ²¡æœ‰å®‰è£…è¿‡Homebrewï¼Œå¯ä»¥å®‰è£…ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªMacè½¯ä»¶çš„å·¥å…·åŒ…ï¼Œå¾ˆå¥½ç”¨ã€‚ä»¥ä¸‹æ“ä½œéƒ½æ˜¯åœ¨Macçš„ç»ˆç«¯é‡Œè¾“å…¥ç›¸å…³å‘½ä»¤æ¥å®Œæˆæ“ä½œçš„ã€‚</p><p></p><h3><strong> Homebrewå®‰è£…</strong></h3><p>ruby -e â€œ$(curl -fsSL <a href=\"https://raw.githubusercontent.com/Homebrew/install/master/install\">https://raw.githubusercontent.com/Homebrew/install/master/install)</a>)â€</p><p></p><h3><strong>OpenRestyå®‰è£…</strong></h3><ol>\n<li>brew install openresty/brew/openresty</li>\n</ol><p>ä»Homebrewå®‰è£…OpenRestyã€‚</p><ol start=\"2\">\n<li>export PATH=/usr/local/Cellar/openresty/1.19.3.2_1/nginx/sbin:$PATH</li>\n</ol><p>å®‰è£…å®Œæˆä¹‹åï¼Œé»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ /usr/local/Cellar/openresty/1.19.3.2_1ï¼Œè¿™æ—¶æˆ‘ä»¬è®¾ç½®ä¸‹ç¯å¢ƒå˜é‡ï¼ˆå³å‘Šè¯‰ç»ˆç«¯è¾“å…¥çš„å‘½ä»¤å»å“ªé‡Œæ‰¾ï¼‰ã€‚</p><ol start=\"3\">\n<li>Nginx&nbsp;-V</li>\n</ol><p>ç„¶åå°±å¯ä»¥æŸ¥çœ‹OpenRestyæ˜¯å¦å®‰è£…æˆåŠŸã€‚å¦‚ä¸‹å›¾ï¼Œæ‰§è¡Œçº¢æ¡†å†…çš„å‘½ä»¤ï¼Œå‡ºç°ç»¿æ¡†çš„è¾“å‡ºå†…å®¹ï¼Œå³è¡¨ç¤ºå®‰è£…æˆåŠŸäº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/d8/2a9d383d17932088c11281ac8d4605d8.png?wh=1920x668\" alt=\"å›¾ç‰‡\"></p><ol start=\"4\">\n<li>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•ä¸‹Nginxæ˜¯å¦å¥½ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æœ¬åœ°æ–°å»ºäº†ä¸ªnginx.confé…ç½®æ–‡ä»¶ï¼Œå°±æ”¾åœ¨/Users/ï½/Documents/seckillproject/nginx/confä¸‹ï¼Œå¹¶ä¸”åœ¨nginxæ–‡ä»¶å¤¹ä¸‹æ–°å»ºlogsæ–‡ä»¶å¤¹ï¼Œç”¨äºlogæ—¥å¿—çš„è¾“å‡ºï¼Œæ–°å»ºåçš„æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/93/69/934cb93ab4c052081a921ffb84966169.png?wh=1920x515\" alt=\"å›¾ç‰‡\"></p><p>nginx.confçš„å†…å®¹å°±ç”¨å®˜æ–¹çš„æ¨¡æ¿ï¼Œè¾“å‡ºä¸ªhello&nbsp;worldï¼š</p><pre><code class=\"language-plain\">worker_processes &nbsp;1;\nerror_log logs/error.log;\nevents {\n&nbsp;&nbsp;&nbsp;&nbsp;worker_connections 1024;\n}\nhttp {\n&nbsp;&nbsp;&nbsp;&nbsp;server {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listen 8080;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location / {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_type text/html;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content_by_lua_block {\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ngx.say(\"&lt;p&gt;hello, world&lt;/p&gt;\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\n</code></pre><p>5. cd /Users/wangzhangfei5/Documents/seckillproject/nginx</p><p>è¿›å…¥åˆ°æˆ‘ä»¬æ–°å»ºçš„nginxæ–‡ä»¶å¤¹ä¸‹ã€‚</p><ol start=\"6\">\n<li>nginx -p `pwd`/ -c conf/nginx.conf</li>\n</ol><p>å¯åŠ¨NginxæœåŠ¡ï¼Œè¿™æ—¶è¾“å…¥ `ps&nbsp;-ef|grep nginx` å¯ä»¥æŸ¥çœ‹èµ·æ¥Nginxè¿›ç¨‹ï¼Œæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªmaster&nbsp;ï¼Œä¸€ä¸ªworkerã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6c/27/6c25ac6529f8afe884a2yyce84326427.png?wh=1920x182\" alt=\"å›¾ç‰‡\"></p><p>7.&nbsp;curl <a href=\"http://localhost:8080\">http://localhost:8080</a></p><p>è®¿é—®æœ¬åœ°8080ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¾“å‡ºäº†\"&lt;p&gt;hello, world&lt;/p&gt;\"ï¼Œä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨è¾“å…¥ <a href=\"http://localhost:8080\">http://localhost:8080</a>ï¼Œçœ‹åˆ° hello,world çš„è¿”å›ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/af/25/afbf1ed0c3fyyb8bd759eb9d21d7c925.png?wh=1920x287\" alt=\"å›¾ç‰‡\"></p><p>8.&nbsp;nginx -p `pwd` -s stop</p><p>åœæ­¢NginxæœåŠ¡ã€‚</p><p></p><h3><strong>MySQLå®‰è£…</strong></h3><p>brew install <a href=\"mailto:mysql@5.7\">mysql@5.7</a></p><p>ä¹Ÿå¯ä»¥é€šè¿‡<a href=\"https://downloads.mysql.com/archives/community/\">å®˜ç½‘</a>ä¸‹è½½ï¼Œæ ¹æ®ç³»ç»Ÿç‰ˆæœ¬ï¼Œä¸‹è½½å¥½å¯¹åº”åŒ…ä¹‹åç›´æ¥å®‰è£…ï¼Œå®Œæˆå®‰è£…ä¹‹åå¯ä»¥æµ‹è¯•ä¸‹ã€‚</p><p>1.&nbsp;export PATH=<a href=\"mailto:/usr/local/opt/mysql@5.7/bin:$PATH\">/usr/local/opt/mysql@5.7/bin:$PATH</a></p><p>é»˜è®¤çš„å®‰è£…ä½ç½®åœ¨ <a href=\"mailto:/usr/local/opt/mysql@5.7\">/usr/local/opt/mysql@5.7</a>&nbsp;è¿™æ—¶æˆ‘ä»¬è®¾ç½®ä¸‹ç¯å¢ƒå˜é‡ï¼ˆå³å‘Šè¯‰ç»ˆç«¯è¾“å…¥çš„å‘½ä»¤å»å“ªé‡Œæ‰¾ï¼‰ã€‚</p><p>2.&nbsp;mysql.server start</p><p>å¯åŠ¨MySQLã€‚</p><p>3.&nbsp;mysql_secure_installation</p><p>è®¾ç½®æ•°æ®åº“å¯†ç ï¼ŒæŒ‰ç…§å¯¹åº”çš„æç¤ºï¼Œè®©é€‰æ‹©Y/Næ—¶ï¼Œè¾“å…¥Yï¼Œç„¶åä¼šè®©é€‰æ‹©å¯†ç ç­‰çº§ï¼Œä¸€å…±ä¸‰ä¸ªçº§åˆ« 0,1,2&nbsp;å¼ºåº¦ç”±ä½åˆ°å¼ºï¼Œé€‰æ‹©åè®¾ç½®å¯†ç ï¼Œå¹¶è®°ä½åˆšè®¾çš„å¯†ç ã€‚</p><p>4.&nbsp;mysql -uroot -p</p><p>ç™»å½•æ•°æ®åº“ï¼Œè¿™æ—¶ä¼šæç¤ºä½ è¾“å…¥å¯†ç ï¼Œè¾“å…¥åˆšè®¾ç½®çš„å¯†ç å³å¯è¿›å…¥ã€‚</p><p>5.&nbsp;show databases;</p><p>æŸ¥çœ‹ä¸‹å½“å‰çš„æ‰€æœ‰åº“ï¼Œåˆ°è¿™é‡Œä¹Ÿè¯´æ˜æˆ‘ä»¬çš„MySQLå‡†å¤‡å¥½äº†ï¼Œå¯ä»¥å»ºåº“å»ºè¡¨äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/03/a5/034609767df8ecbe23bc6a74f1c4f6a5.png?wh=1920x979\" alt=\"å›¾ç‰‡\"></p><p>6.&nbsp;mysql.server stop</p><p>control+zé€€å‡ºMySQLåï¼Œæ‰§è¡Œè¯¥å‘½ä»¤ï¼Œå…³é—­MySQLã€‚</p><p></p><h3><strong>Rediså®‰è£…</strong></h3><p>brew install redis</p><p>å®‰è£…å®Œæˆä¹‹å ï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•ã€‚</p><p></p><ol>\n<li>/usr/local/opt/redis/bin/redis-server /usr/local/etc/redis.conf</li>\n</ol><p>å¯åŠ¨RedisæœåŠ¡ç«¯ï¼Œå¦‚ä¸‹å›¾ç»¿æ¡†ï¼Œåœ¨å®‰è£…å¥½åæç¤ºæˆ‘ä»¬å¦‚ä½•å¯åŠ¨Redisï¼ŒæŒ‰ç…§æç¤ºè¾“å…¥å‘½ä»¤ï¼Œä¾¿å¯ä»¥çœ‹åˆ°å¯åŠ¨æˆåŠŸç­‰å¾…è¿æ¥ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/3d/d3c99f1a374cd99635567c7c91a2083d.png?wh=1920x1223\" alt=\"å›¾ç‰‡\"></p><ol start=\"2\">\n<li>redis-cli -h 127.0.0.1 -p 6379</li>\n</ol><p>è¿™æ—¶æ–°å»ºä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œæ¨¡æ‹Ÿå®¢æˆ·ç«¯è¿æ¥RedisæœåŠ¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥setä¸€ä¸ªå€¼ï¼Œå¹¶getæŸ¥è¯¢å‡ºæ¥ï¼Œè¯´æ˜Redisä¹Ÿæ­£å¸¸å®‰è£…æˆåŠŸå¹¶å¯ä»¥ä½¿ç”¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/11/51/117820fcf5f023d46312dae5530da851.png?wh=1920x502\" alt=\"å›¾ç‰‡\"></p><ol start=\"3\">\n<li>æœåŠ¡ç«¯åœæ­¢ï¼Œå¯ä»¥ç›´æ¥control+zé€€å‡ºï¼Œä¹Ÿå¯ä»¥ sudo pkill redis-server å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ redis-cli shutdownã€‚</li>\n</ol><p></p><p>åˆ°è¿™æˆ‘ä»¬ä¸»è¦çš„ä¾èµ–ç¯å¢ƒéƒ½å·²ç»æ­å¥½äº†ï¼Œè€Œé¡¹ç›®çš„æ­å»ºä¸å¼€å‘ï¼Œæˆ‘ä¼šåœ¨ä¸‹èŠ‚è¯¾ä¸ºä½ è®²è§£ã€‚</p><p></p><h2><strong>å°ç»“</strong></h2><p>åœ¨è¿™èŠ‚è¯¾é‡Œï¼Œé’ˆå¯¹ç§’æ€ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†ä¼ ç»Ÿçš„æ¶æ„è®¾è®¡ä¸æˆ‘ä»¬æ–°çš„æ¶æ„è®¾è®¡åšäº†ä¸€ä¸ªå¯¹æ¯”ï¼Œå¯ä»¥çœ‹å‡ºä¼ ç»Ÿæ¶æ„è®¾è®¡çš„å±€é™æ€§ï¼Œå…¶ä¸­ä»…åˆ—ä¸¾äº†åŸŸåå¸¦å®½é—®é¢˜å’ŒTomcatæœåŠ¡å™¨æ€§èƒ½é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä»å®è§‚ä¸ŠåšæŠ€æœ¯é€‰å‹æ—¶ï¼Œå°±éœ€è¦å»è®¤çœŸæ€è€ƒçš„é—®é¢˜ã€‚</p><p>è€Œé’ˆå¯¹è¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬ä¹Ÿç»™å‡ºäº†æˆ‘ä»¬çš„ç­”æ¡ˆï¼Œå³åˆ©ç”¨Nginxåœ¨é«˜å¹¶å‘ä¸‹ä»å…·æœ‰é«˜æ€§èƒ½çš„ç‰¹æ€§ï¼Œå°†Webç½‘å…³èŒèƒ½å‰ç½®ï¼Œå°½é‡åœ¨æµé‡å…¥å£å¤„æ‹¦æˆªæ‰é£é™©æµé‡ä»¥åŠç¼©çŸ­è¯·æ±‚é“¾è·¯ï¼Œä¿æŠ¤ä¸‹æ¸¸ç³»ç»Ÿï¼Œå¹¶æé«˜æœåŠ¡çš„å“åº”é€Ÿåº¦ã€‚</p><p>æœ‰äº†å¤§çš„æ–¹å‘æŒ‡å¯¼ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é’ˆå¯¹ä¸€äº›æ›´ç»†çš„æŠ€æœ¯ç‚¹å»åšä¼˜åŒ–å’Œè®¾è®¡ï¼Œæ¯”å¦‚å“ªç§é™æµç®—æ³•æ›´å¥½ï¼Œæ€ä¹ˆèƒ½åœ¨é«˜å¹¶å‘ä¸‹ä¿è¯åº“å­˜ä¸è¶…å–ç­‰ç­‰è¿™äº›ã€‚</p><p>åŒæ—¶åœ¨åšæŠ€æœ¯é€‰å‹æ—¶ï¼Œæˆ‘ä¹Ÿå°½å¯èƒ½åœ°ä½¿ç”¨äº†å¤šæ•°å…¬å¸éƒ½åœ¨ä½¿ç”¨çš„æŠ€æœ¯æ ˆï¼Œä»¥é™ä½ä½ çš„å­¦ä¹ æˆæœ¬ã€‚ä½†æ˜¯ç”¨Luaè¯­è¨€æ¥åšNginxä¸šåŠ¡å¼€å‘ï¼Œæˆ–è®¸è¿˜æœ‰ä¸å°‘åŒå­¦æ˜¯ç¬¬ä¸€æ¬¡ç”¨ï¼Œä¸è¿‡ä¸ç€æ€¥ï¼Œåé¢è·Ÿç€æˆ‘æ…¢æ…¢å­¦ï¼Œç›¸ä¿¡ä½ è‡ªå·±ä¸€å®šå¯ä»¥ï¼Œæˆ–è®¸è¿™è¿˜å°†æˆä¸ºä½ æ¯”åˆ«äººå‰å®³çš„æ³•å®ï¼</p><h2>æ€è€ƒé¢˜</h2><p>å…³äºTomcatçš„æ€è€ƒï¼Œä¸ºä»€ä¹ˆTomcatä¹Ÿæ”¯æŒNIOï¼Œä½†æ€§èƒ½å´æ¯”Nginxå·®é‚£ä¹ˆå¤šå‘¢ï¼Ÿ</p><p>ä»¥ä¸Šå°±æ˜¯è¿™èŠ‚è¯¾çš„å…¨éƒ¨å†…å®¹ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå’Œæˆ‘è®¨è®ºé—®é¢˜ï¼Œäº¤æµæƒ³æ³•ï¼</p>","comments":[{"had_liked":false,"id":321306,"user_name":"å•","can_delete":false,"product_type":"c1","uid":1210890,"ip_address":"","ucode":"8F08E2CB81C4C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/7a/0a/0ce5c232.jpg","comment_is_top":false,"comment_ctime":1636775069,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"27406578845","product_id":100091501,"comment_content":"æ–‡ä¸­è¯´çš„epollæ˜¯å¼‚æ­¥éé˜»å¡çš„ç»“è®ºæˆ‘æå‡ºæŒ‘æˆ˜ï¼Œæ‰€è°“çš„å¤šè·¯å¤ç”¨å™¨ï¼Œä¸ç®¡æ˜¯selectã€pollã€epollä¸éƒ½æ˜¯åŒæ­¥éé˜»å¡ä¹ˆï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1877862,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLu3MgZBAyyiavX2CMF2KRib791j3bBGiaQDzuQwBF2k6AKHANV2uTAAss2vVaeC7xcSYYD8vjmibRpTQ/132","nickname":"çºµä¸æœ½","note":"","ucode":"DB2CA2C46B2EF1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589485,"discussion_content":"epollæœ¬èº«æ˜¯åŒæ­¥éé˜»å¡çš„ï¼Œåƒä¸Šå±‚å¦‚ngã€nettyä¸ºä»€ä¹ˆè¯´æ˜¯å¼‚æ­¥çš„æ˜¯å› ä¸ºï¼šç«™åœ¨è§’åº¦ä¸ä¸€æ ·ï¼Œç«™åœ¨ä½ å†™åœ¨nettyé‡Œçš„ä¸šåŠ¡é€»è¾‘å‡½æ•°æˆ–è€…ngé‡Œé¢å†™å¥½çš„é€»è¾‘å‡½æ•°ï¼ˆæˆ–è€…ä½ è‡ªå·±å†™çš„ï¼‰è¿™ä¸ªè§’åº¦çš„æ—¶å€™ï¼Œæ˜¯å¼‚æ­¥è¢«è°ƒç”¨çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665039934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106152,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e0/e8/66439469.jpg","nickname":"å¤§æ©˜ä¸ºé‡","note":"","ucode":"96479F205B8384","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586161,"discussion_content":"ç¡®å®ä¸æ˜¯å¼‚æ­¥éé˜»å¡~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662014480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2726409,"avatar":"https://static001.geekbang.org/account/avatar/00/29/9a/09/5ea7704e.jpg","nickname":"çŸ³æ—","note":"","ucode":"DD678E5C8FA0C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574835,"discussion_content":"åº•å±‚IOäº‹ä»¶å°±ç»ªå’Œä¸Šå±‚IOçº¿ç¨‹è¯»å†™å¼‚æ­¥å¹¶è¡Œï¼ŒIOçº¿ç¨‹ç­‰å¾…IOè¯»å†™äº‹ä»¶å‘ç”Ÿéšåå¤„ç†ï¼ŒåŒæ—¶æ³¨å†Œæ–°IOäº‹ä»¶ï¼Œæ–°IOäº‹ä»¶å¼‚æ­¥å‘ç”Ÿï¼Œä¸‹æ¬¡epollå°±å¯ä»¥è·å–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654397098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2345325,"avatar":"https://static001.geekbang.org/account/avatar/00/23/c9/6d/d00e7741.jpg","nickname":"Z","note":"","ucode":"71271DF35BB58F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569632,"discussion_content":"æ²¡é”™ éƒ½æ˜¯åŒæ­¥éé˜»å¡ select ä¼šæœ‰fd å¤§å°é™åˆ¶ pollæ²¡æœ‰ è¿™é‡Œç‰ˆä¸»ä¸å¤Ÿä¸¥è°¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651500830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314472,"user_name":"é»„åº","can_delete":false,"product_type":"c1","uid":2037282,"ip_address":"","ucode":"C8C2749E2DE72B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erpYAcOqrNNxmMuKsd6Dh69BzxiaXjJRh6IMnQlxOqBFiae1EMic32Wv6aFESWytliaL7uniaZ4DgNUwxg/132","comment_is_top":false,"comment_ctime":1633099560,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23107936040","product_id":100091501,"comment_content":"1ï¼‰ä¸¤è€…çš„ä½¿ç”¨ä¾§é‡ç‚¹ä¸åŒï¼ŒNginxä¸»è¦æ˜¯åå‘ä»£ç†ä»¥åŠè´Ÿè½½å‡è¡¡ï¼ŒTomcatæ˜¯ä¸€ä¸ªservletå®¹å™¨ï¼Œéœ€è¦å¤„ç†å„ç§åŠ¨æ€è¯·æ±‚ï¼Œæ¯”å¦‚è¯´ç½‘ç»œIOä»¥åŠå’Œæ•°æ®åº“çš„äº¤äº’ï¼›<br>2ï¼‰æœºåˆ¶ä¸åŒï¼šä½œè€…å¤§å¤§æåŠåˆ°ï¼Œluaè„šæœ¬åº•å±‚ç”¨åˆ°äº†æºç¨‹ï¼ŒTomcatä½¿ç”¨çš„æ˜¯çº¿ç¨‹ï¼Œæ€§èƒ½ä¸Šä¹Ÿä¼šå­˜åœ¨å·®è·","like_count":5,"discussions":[{"author":{"id":2726409,"avatar":"https://static001.geekbang.org/account/avatar/00/29/9a/09/5ea7704e.jpg","nickname":"çŸ³æ—","note":"","ucode":"DD678E5C8FA0C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574837,"discussion_content":"æ˜¯çš„ï¼ŒTomcatéƒ¨ç½²çš„åº”ç”¨ä¸€èˆ¬ä¼šè¿›è¡ŒIOé˜»å¡è°ƒç”¨ï¼Œè¿™äº›è°ƒç”¨åœ¨çº¿ç¨‹æ± è¿›è¡Œå¹¶åŒæ­¥ç­‰å¾…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654397696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314395,"user_name":"Z.G","can_delete":false,"product_type":"c1","uid":1641331,"ip_address":"","ucode":"AF2D041F9CBDF1","user_header":"https://static001.geekbang.org/account/avatar/00/19/0b/73/a04b5d3f.jpg","comment_is_top":false,"comment_ctime":1632995717,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14517897605","product_id":100091501,"comment_content":"è€å¸ˆä½ å¥½ï¼Œé—®ä¸‹å¦‚æœæ˜¯åŸºäºç°ä»£äº‘åŸç”Ÿçš„K8såŸºç¡€è®¾æ–½ï¼Œè¿˜éœ€è¦Nginxå—ï¼Ÿåˆåº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ","like_count":3},{"had_liked":false,"id":318950,"user_name":"é’å¹´æœ¯æ‘„","can_delete":false,"product_type":"c1","uid":1390415,"ip_address":"","ucode":"F8C5E379BEAB8C","user_header":"https://static001.geekbang.org/account/avatar/00/15/37/4f/bc5f120d.jpg","comment_is_top":false,"comment_ctime":1635489235,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10225423827","product_id":100091501,"comment_content":"å¯¹äºM1 Macçš„å‘ï¼Œå®‰è£…ä½ç½®ä¸å¯¹ã€‚ä¼šæ˜¯ï¼š&#47;opt&#47;homebrew&#47;Cellar&#47;openresty&#47;ç‰ˆæœ¬å·&#47;...","like_count":2},{"had_liked":false,"id":320682,"user_name":"é™ˆå¼º","can_delete":false,"product_type":"c1","uid":2059131,"ip_address":"","ucode":"EF836A811D844A","user_header":"https://static001.geekbang.org/account/avatar/00/1f/6b/7b/727c1741.jpg","comment_is_top":false,"comment_ctime":1636449251,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5931416547","product_id":100091501,"comment_content":"ä¸ºä»€ä¹ˆtomcatä¹Ÿæ”¯æŒNIOä½†æ˜¯æ…¢çš„åŸå› ã€‚<br>1ã€tomcatçš„è¯·æ±‚æ¥å…¥ä½¿ç”¨çš„æ˜¯Java NIOçš„selectableæ¨¡å‹ï¼Œä¹Ÿæ˜¯å¼‚æ­¥äº‹ä»¶ç›‘å¬çš„æ¨¡å¼ï¼Œå¹¶ä¸æ…¢ã€‚ï¼ˆå¹¶ä¸æ¸…æ¥šselectableæ¨¡å‹æ˜¯ä¸æ˜¯åŸºäºepollå®ç°çš„ï¼‰<br>2ã€tomcatåŒæ—¶éœ€è¦å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œé»˜è®¤æƒ…å†µä¸‹(ä¸æå‰åŠ è½½servletå’Œjspæ¨¡æ¿)ç¬¬ä¸€æ¬¡å¤„ç†è¯·æ±‚ä¼šæ¶‰åŠç±»çš„åŠ è½½å’Œjspæ–‡ä»¶çš„æ¨¡æ¿ç¿»è¯‘ï¼Œè¿˜æœ‰æœ¬èº«çš„ä¸šåŠ¡å¤„ç†ï¼Œè¿™äº›è¿‡ç¨‹å¯èƒ½æ¯”è¾ƒæ…¢ã€‚<br>3ã€selectableæ˜¯å¦æ˜¯Javaè¯­è¨€å¯¹epollçš„æŠ½è±¡ï¼Ÿä¸å¤ªæ¸…æ¥šã€‚ä¸è¿‡æ— è®ºæ˜¯ä¸æ˜¯ï¼Œåœ¨ç›‘å¬åˆ°äº‹ä»¶åï¼ŒselectionKeyé›†åˆæœ¬èº«è¿˜æ˜¯è¦äº¤ç»™çº¿ç¨‹æ± å»æ‰§è¡Œçš„ï¼Œè¿™æ¶‰åŠå¤§é‡çš„å¯¹è±¡åˆ›å»ºä»¥åŠçº¿ç¨‹æ± æ˜¯å¦é¢„çƒ­ã€‚<br>4ã€æ¯•ç«ŸJavaè¯­è¨€ï¼Œåº•å±‚è¿˜æ˜¯è¦æ‰Cå’ŒC++çš„åº“ï¼Œä¸çŸ¥é“è¿™ç®—ä¸ç®—ä¸€ç‚¹ï¼Œå“ˆå“ˆå“ˆï¼ˆä¸ä¼šCè¯­è¨€ï¼Œå…·ä½“è°ƒå•¥æˆ‘ä¹Ÿä¸çŸ¥é“...è¿™å°±æ˜¯åŠè·¯å‡ºå®¶çš„ç—›è‹¦...ï¼‰ã€‚<br><br>æ„Ÿè§‰è‡ªå·±å›ç­”çš„æœ‰äº›ä¸ä¸¥è°¨ï¼Œå‡è®¾ä¸æ¶‰åŠä¸šåŠ¡å¤„ç†ï¼Œå•ä»è¯·æ±‚æ¥å…¥è¿™ä¸ªè§’åº¦çš„è¯ï¼Œæ„Ÿè§‰JavaNIOåº”è¯¥å¾ˆèƒ½æ‰“ï¼Œå¸Œæœ›è€å¸ˆç‚¹è¯„ã€‚","like_count":1},{"had_liked":false,"id":314096,"user_name":"nanağŸ‘„","can_delete":false,"product_type":"c1","uid":2448469,"ip_address":"","ucode":"A9A35BAED23215","user_header":"https://static001.geekbang.org/account/avatar/00/25/5c/55/d113d3ea.jpg","comment_is_top":false,"comment_ctime":1632834018,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5927801314","product_id":100091501,"comment_content":"éº»çƒ¦é€Ÿæ›´å•Šå•Šå•Šï¼Œå®Œå…¨ä¸å¤Ÿçœ‹","like_count":1},{"had_liked":false,"id":344390,"user_name":"Nullrable","can_delete":false,"product_type":"c1","uid":1086590,"ip_address":"","ucode":"783C68FC773EF3","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/7e/7a895e5a.jpg","comment_is_top":false,"comment_ctime":1651504538,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651504538","product_id":100091501,"comment_content":"ä»¥ä¸Šå·¥å…·ç”¨dockerï¼Œç®¡ç†æ¯”è¾ƒæ–¹ä¾¿","like_count":0},{"had_liked":false,"id":332953,"user_name":"pc","can_delete":false,"product_type":"c1","uid":1652836,"ip_address":"","ucode":"1AD538B9A900B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epKJlW7sqts2ZbPuhMbseTAdvHWnrc4ficAeSZyKibkvn6qyxflPrkKKU3mH6XCNmYvDg11tB6y0pxg/132","comment_is_top":false,"comment_ctime":1643877097,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1643877097","product_id":100091501,"comment_content":"æœ‰ä¸€ä¸ªæ¦‚å¿µæ²¡æœ‰ç†è§£ï¼šï¼ˆä¸ŠèŠ‚è¯¾ä¹Ÿæœ‰æåˆ°ï¼‰â€œWeb æœåŠ¡æ—¢æä¾› H5 é¡µé¢ã€é™æ€èµ„æºï¼ŒåŒæ—¶ä¹Ÿæä¾›ä¸šåŠ¡æ¥å£â€ã€‚è¿™æ˜¯æŒ‡å‰åç«¯æ²¡æœ‰åˆ†ç¦»å—ï¼Ÿç›¸å½“äºæ˜¯ä¸€ä¸ªæœåŠ¡åˆæä¾›é¡µé¢ï¼Œåˆæä¾›æ¥å£çš„æ„æ€å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1183841,"avatar":"https://static001.geekbang.org/account/avatar/00/12/10/61/7ba48062.jpg","nickname":"èœé¸¡å°ç‹å­","note":"","ucode":"29E6382455E729","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557920,"discussion_content":"å°±ç®—å‰åç«¯åˆ†ç¦»ï¼Œä½ çš„H5é¡µé¢ã€é™æ€èµ„æºä¸æ˜¯è¿˜å¾—é€šè¿‡webæœåŠ¡æ‰“åŒ…æ‰èƒ½è®¿é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648024877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324768,"user_name":"Feng","can_delete":false,"product_type":"c1","uid":1015205,"ip_address":"","ucode":"42DB60B7BF69D0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/a5/930c9103.jpg","comment_is_top":false,"comment_ctime":1638610679,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1638610679","product_id":100091501,"comment_content":"Nginxåªåšè¯·æ±‚å’Œå“åº”çš„è½¬å‘ï¼Œä»¥åŠè½»ä¸šåŠ¡å¤„ç†ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨IOä¸Šï¼›Nginxçš„IOé‡‡ç”¨çš„æ˜¯å•çº¿ç¨‹ã€å¼‚æ­¥éé˜»å¡çš„æ¨¡å¼ï¼Œé¿å…æ‰“å¼€IOé€šé“ç­‰å¾…æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ï¼Œç¼©çŸ­äº†çº¿ç¨‹è°ƒåº¦å’ŒIOå¤„ç†çš„æ—¶é—´ã€‚<br><br>Tomcatçš„IOçº¿ç¨‹ä¸€èˆ¬æ§åˆ¶åœ¨400ä»¥å†…ï¼Œå¦‚æœæ¯ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´ä¸º300msï¼Œä¸€ä¸ªçº¿ç¨‹3QPSï¼Œæ€»ä½“ä¸Šä¸€ä¸ªTomcatçš„å¹¶å‘èƒ½åŠ›ä¸º1000QPSã€‚","like_count":0},{"had_liked":false,"id":323608,"user_name":"intomymind","can_delete":false,"product_type":"c1","uid":1105126,"ip_address":"","ucode":"B954C9BFEC8667","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/e6/cfb409ab.jpg","comment_is_top":false,"comment_ctime":1638018624,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1638018624","product_id":100091501,"comment_content":"è°èƒ½å¸®å¿™è§£ç­”ä¸‹ï¼Œåœ¨IOå¤šè·¯å¤ç”¨æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ä¹‹åæ˜¯åœ¨ç­‰ç€è¿”å›ç»“æœå—ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ç»“æœæ˜¯å¦‚ä½•æ¥å—åˆ°çš„","like_count":0,"discussions":[{"author":{"id":2969168,"avatar":"","nickname":"Geek_a94a8b","note":"","ucode":"098B7DABDE4697","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560530,"discussion_content":"å®¢æˆ·ç«¯æ˜¯åŒæ­¥çš„ï¼ŒæœåŠ¡ç«¯æ˜¯éé˜»å¡çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649381716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1292669,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIaaDFHiag4sFcO7JUn028Mtk1YvFpibIibLzcTE7Qak0icJklMpqh7k5dSK27dibicMuNgYMozgaibeYppA/132","nickname":"Bball","note":"","ucode":"E483CAFE50CB99","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544010,"discussion_content":"æ˜¯ç­‰ç€è¿”å›ï¼Œå®¢æœç«¯è¿˜æ˜¯è¦ç­‰çš„ï¼Œåªæ˜¯æœåŠ¡å™¨çš„CPUä¸ç”¨ç­‰ç€å¯ä»¥å»å¹²å…¶ä»–æ´»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641379360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316853,"user_name":"é…±ç´«çš„å°ç™½å…”","can_delete":false,"product_type":"c1","uid":1066547,"ip_address":"","ucode":"5A919678D3C039","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/33/2e71b679.jpg","comment_is_top":false,"comment_ctime":1634569019,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1634569019","product_id":100091501,"comment_content":"ä¸ºä»€ä¹ˆH5å’Œhtmlä¸æ”¾åœ¨nginxæˆ–è€…cdnå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":315879,"user_name":"nanağŸ‘„","can_delete":false,"product_type":"c1","uid":2448469,"ip_address":"","ucode":"A9A35BAED23215","user_header":"https://static001.geekbang.org/account/avatar/00/25/5c/55/d113d3ea.jpg","comment_is_top":false,"comment_ctime":1634029805,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634029805","product_id":100091501,"comment_content":"tomcatï¼Œå¤šä¸ªè¯·æ±‚ä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹æ¥å¤„ç†æƒ…ä¹¦ï¼Œæ¶‰åŠåˆ°çº¿ç¨‹çš„åˆ‡æ¢å’Œé”çš„å¼€é”€ã€‚nginxæ˜¯å•çº¿ç¨‹å¤šè¿›ç¨‹ï¼Œè¯·æ±‚è¿‡æ¥å°±å°‘äº†é‚£éƒ¨åˆ†å¼€é”€ã€‚ä¸çŸ¥é“å›ç­”å¯¹ä¸å¯¹ï¼Œå¸Œæœ›ä½œè€…æ¯æœŸéƒ½å›ç­”ä¸‹ä¸ŠæœŸé—®é¢˜ï¼Œè°¢è°¢ã€‚","like_count":0},{"had_liked":false,"id":314281,"user_name":"Geek_5b2ab1","can_delete":false,"product_type":"c1","uid":2628460,"ip_address":"","ucode":"C1AF841A9F0B6C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK9Yvy5STDw874VEEuPehIcONR9kEq7knIicUNuINU0ovf2ViabhFqiabZiaoXC5FqL89YDCxp3tBnFzA/132","comment_is_top":false,"comment_ctime":1632937533,"is_pvip":true,"replies":[{"id":"113855","content":"å‘å·²å¡«å¹³ï¼Œ``åŒ…è£¹æ²¡æœ‰æ­£å¸¸æ˜¾ç¤ºã€‚","user_name":"ä½œè€…å›å¤","comment_id":314281,"uid":"1356014","ip_address":"","utype":1,"ctime":1632986553,"user_name_real":"å†¬é’"}],"discussion_count":1,"race_medal":0,"score":"1632937533","product_id":100091501,"comment_content":"è¸©å‘ä¹‹ä¸€ï¼š nginx -p pwd&#47; -c conf&#47;nginx.conf åº”ä¸ºnginx -p Â·pwdÂ·&#47; -c conf&#47;nginx.conf<br>pwdå·¦å³çš„æ˜¯åå¼•å·ï¼Œè¡¨ç¤ºæ‰§è¡Œpwdå‘½ä»¤ï¼Œè·å–å½“å‰å·¥ä½œç›®å½•è·¯å¾„","like_count":0,"discussions":[{"author":{"id":1356014,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b0/ee/d0871efd.jpg","nickname":"å†¬é’","note":"","ucode":"14576781B499FB","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527627,"discussion_content":"å‘å·²å¡«å¹³ï¼Œ``åŒ…è£¹æ²¡æœ‰æ­£å¸¸æ˜¾ç¤ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632986553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313865,"user_name":"é€è¿‡å¿«é€’çš„ç å†œ","can_delete":false,"product_type":"c1","uid":1587666,"ip_address":"","ucode":"66EA81B3BADC73","user_header":"https://static001.geekbang.org/account/avatar/00/18/39/d2/845c0e39.jpg","comment_is_top":false,"comment_ctime":1632723256,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1632723256","product_id":100091501,"comment_content":"æˆ‘è§‰å¾—å¯èƒ½æ˜¯tomcat å’Œ Nginxçš„ä¾§é‡ç‚¹æ˜¯ä¸ä¸€æ ·ï¼Œnginxè®²ç©¶ä¸»è¦ç®¡è¿™ä¸ªè¯·æ±‚ï¼Œä»å“ªå„¿æ¥ï¼Œåˆ°å“ªå„¿å»ã€‚å®ƒä¸æ±‚è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¸­è½¬ç«™ã€‚è€Œtomcatæ˜¯ä¸€ä¸ªservletå®¹å™¨ï¼Œå®ƒè®²ç©¶æ€ä¹ˆåƒä¸‹è¿™äº›è¯·æ±‚ï¼Œå¹¶ä¸”éƒ½å¤„ç†å¥½ï¼Œå› æ­¤ï¼Œå®ƒéœ€è¦é€‚é…å„ç§æ¶ˆæ¯ä½“ï¼Œå¤„ç†ä¸åŒçš„äº”èŠ±å…«é—¨çš„è¯·æ±‚ï¼Œç”šè‡³äºè¿˜å¾—è€ƒè™‘ï¼Œcookieï¼Œsessionï¼Œä¸Šä¸‹æ–‡ç­‰é—®é¢˜ã€‚è™½ç„¶tomcatå¾ˆä¼Ÿå¤§çš„ç”¨servletå’Œservletå®¹å™¨çš„æ–¹å¼æ¥è§£è€¦å„ä¸ªä¸šåŠ¡è¯·æ±‚ï¼Œå‡å°‘äº†å¼€å‘æˆæœ¬ï¼Œä½†æ˜¯æ€§èƒ½æˆæœ¬ç¡®å®æŒ¥ä¹‹ä¸å»äº†","like_count":0,"discussions":[{"author":{"id":1183042,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0d/42/22eae851.jpg","nickname":"Rod","note":"","ucode":"A3F675888D9061","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398322,"discussion_content":"è¿˜æœ‰ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜ï¼Œä»»ä½•ä¸šåŠ¡éƒ½è¦å¯¹æ•°æ®åº“åšè¯»å†™ï¼Œè¿™ä¸€æ­¥ä¹Ÿæ˜¯åœ¨tomcatä¸Šæ‰§è¡Œã€‚æ°æ°çœŸæ­£è€—æ—¶çš„éƒ½æ˜¯åœ¨æ•°æ®åº“ä¸Šã€‚å¦å¤–è¿˜æœ‰ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜ï¼Œä½œè€…ä¹Ÿè¯´äº†luaåç¨‹æœºåˆ¶ï¼Œtomcatæ˜¯javaå†™çš„ï¼Œæ˜¯çº¿ç¨‹è€Œéåç¨‹ï¼Œæ€§èƒ½æ²¡å¾—æ¯”ï¼Œæ¯ä¸ªthreadå°±æ˜¯ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼Œæ€§èƒ½è‡ªç„¶å°±å·®","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1632757468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313839,"user_name":"èŒƒ","can_delete":false,"product_type":"c1","uid":1574450,"ip_address":"","ucode":"D115514B2AA5CC","user_header":"https://static001.geekbang.org/account/avatar/00/18/06/32/3de6a189.jpg","comment_is_top":false,"comment_ctime":1632706004,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1632706004","product_id":100091501,"comment_content":"å¯¹äºWindowsç³»ç»Ÿï¼Œå¯¹åº”çš„è½¯ä»¶æ˜¯ä»€ä¹ˆï¼Ÿmysql+redis+nginx+IIS?","like_count":0,"discussions":[{"author":{"id":2707697,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erXzA6OE2JYiboOjlZlHrFicoKsN154LnwNn4OEAbm0SGaW1IXJrbFswqvmxk8o3xbTvcBWGmLGd7zw/132","nickname":"æ— è„‘ç†Š","note":"","ucode":"3CC957F4239353","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":398077,"discussion_content":"openrestyæœ‰winç‰ˆæœ¬","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632730800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1238757,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e6/e5/e3daa1a7.jpg","nickname":"æ— åŒ","note":"","ucode":"405779043D091E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399180,"discussion_content":"æ²¡æœ‰IIS","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632917271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}