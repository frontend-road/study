{"id":96792,"title":"16 | Spark Streamingï¼šSparkçš„å®æ—¶æµè®¡ç®—API","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä»Šå¤©æˆ‘è¦ä¸ä½ åˆ†äº«çš„å†…å®¹æ˜¯â€œSpark Streamingâ€ã€‚</p><p>é€šè¿‡ä¸Šä¸€è®²çš„å†…å®¹ï¼Œæˆ‘ä»¬æ·±å…¥äº†è§£äº†Spark SQL APIã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åƒæŸ¥è¯¢å…³ç³»å‹æ•°æ®åº“ä¸€æ ·æŸ¥è¯¢Sparkçš„æ•°æ®ï¼Œå¹¶ä¸”å¯¹åŸç”Ÿæ•°æ®åšç›¸åº”çš„è½¬æ¢å’ŒåŠ¨ä½œã€‚</p><p>ä½†æ˜¯ï¼Œæ— è®ºæ˜¯DataFrame APIè¿˜æ˜¯DataSet APIï¼Œéƒ½æ˜¯åŸºäºæ‰¹å¤„ç†æ¨¡å¼å¯¹é™æ€æ•°æ®è¿›è¡Œå¤„ç†çš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ¯å¤©æŸä¸ªç‰¹å®šçš„æ—¶é—´å¯¹ä¸€å¤©çš„æ—¥å¿—è¿›è¡Œå¤„ç†åˆ†æã€‚</p><p>åœ¨ç¬¬äºŒç« ä¸­ä½ å·²ç»çŸ¥é“äº†ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†æ˜¯å¤§æ•°æ®å¤„ç†æœ€å¸¸è§çš„ä¸¤ä¸ªåœºæ™¯ã€‚é‚£ä¹ˆä½œä¸ºå½“ä¸‹æœ€æµè¡Œçš„å¤§æ•°æ®å¤„ç†å¹³å°ä¹‹ä¸€ï¼ŒSparkæ˜¯å¦æ”¯æŒæµå¤„ç†å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p><p>æ—©åœ¨2013å¹´ï¼ŒSparkçš„æµå¤„ç†ç»„ä»¶Spark Streamingå°±å‘å¸ƒäº†ã€‚ä¹‹åç»è¿‡å¥½å‡ å¹´çš„è¿­ä»£ä¸æ”¹è¿›ï¼Œç°åœ¨çš„Spark Streamingå·²ç»éå¸¸æˆç†Ÿï¼Œåœ¨ä¸šç•Œåº”ç”¨ååˆ†å¹¿æ³›ã€‚</p><p>ä»Šå¤©å°±è®©æˆ‘ä»¬ä¸€èµ·æ­å¼€Spark Streamingçš„ç¥ç§˜é¢çº±ï¼Œè®©å®ƒæˆä¸ºæˆ‘ä»¬æ‰‹ä¸­çš„åˆ©å™¨ã€‚</p><h2>Spark Streamingçš„åŸç†</h2><p>Spark Streamingçš„åŸç†ä¸å¾®ç§¯åˆ†çš„æ€æƒ³å¾ˆç±»ä¼¼ã€‚</p><p>åœ¨å¤§å­¦çš„å¾®ç§¯åˆ†è¯¾ä¸Šï¼Œä½ çš„è€å¸ˆä¸€å®šè¯´è¿‡ï¼Œå¾®åˆ†å°±æ˜¯æ— é™ç»†åˆ†ï¼Œç§¯åˆ†å°±æ˜¯å¯¹æ— é™ç»†åˆ†çš„æ¯ä¸€æ®µè¿›è¡Œæ±‚å’Œã€‚å®ƒæœ¬è´¨ä¸ŠæŠŠä¸€ä¸ªè¿ç»­çš„é—®é¢˜è½¬æ¢æˆäº†æ— é™ä¸ªç¦»æ•£çš„é—®é¢˜ã€‚</p><!-- [[[read_end]]] --><p>æ¯”å¦‚ï¼Œç”¨å¾®ç§¯åˆ†æ€æƒ³æ±‚ä¸‹å›¾ä¸­é˜´å½±éƒ¨åˆ†Sçš„é¢ç§¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/eb/1cef18cc51ef652c90d05c170c04e7eb.png?wh=1142*640\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥æŠŠSæ— é™ç»†åˆ†æˆæ— æ•°ä¸ªå°çŸ©å½¢ï¼Œå› ä¸ºçŸ©å½¢çš„å®½è¶³å¤ŸçŸ­ï¼Œæ‰€ä»¥å®ƒé¡¶ç«¯çš„è¾¹è¿‘ä¼¼æ˜¯ä¸€ä¸ªç›´çº¿ã€‚è¿™æ ·ï¼ŒæŠŠå®¹æ˜“è®¡ç®—çš„çŸ©å½¢é¢ç§¯ç›¸åŠ ï¼Œå°±å¾—åˆ°ä¸å®¹æ˜“ç›´æ¥è®¡ç®—çš„ä¸è§„åˆ™å›¾å½¢é¢ç§¯ã€‚</p><p>ä½ çŸ¥é“ï¼Œæµå¤„ç†çš„æ•°æ®æ˜¯ä¸€ç³»åˆ—è¿ç»­ä¸æ–­å˜åŒ–ï¼Œä¸”æ— è¾¹ç•Œçš„ã€‚æˆ‘ä»¬æ°¸è¿œæ— æ³•é¢„æµ‹ä¸‹ä¸€ç§’çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·ã€‚Spark Streamingç”¨æ—¶é—´ç‰‡æ‹†åˆ†äº†æ— é™çš„æ•°æ®æµï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªæ•°æ®ç‰‡ç”¨ç±»ä¼¼äºæ‰¹å¤„ç†çš„æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œè¾“å‡ºçš„æ•°æ®ä¹Ÿæ˜¯ä¸€å—ä¸€å—çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2e/a2/2e5d3fdbe0bb09a7f2cf219df1d41ca2.png?wh=4758*1348\" alt=\"\"></p><p>Spark Streamingæä¾›ä¸€ä¸ªå¯¹äºæµæ•°æ®çš„æŠ½è±¡DStreamã€‚DStreamå¯ä»¥ç”±æ¥è‡ªApache Kafkaã€Flumeæˆ–è€…HDFSçš„æµæ•°æ®ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ç”±åˆ«çš„DStreamç»è¿‡å„ç§è½¬æ¢æ“ä½œå¾—æ¥ã€‚è®²åˆ°è¿™é‡Œï¼Œä½ æ˜¯ä¸æ˜¯è§‰å¾—å†…å®¹ä¼¼æ›¾ç›¸è¯†ï¼Ÿ</p><p>æ²¡é”™ï¼Œåº•å±‚DStreamä¹Ÿæ˜¯ç”±å¾ˆå¤šä¸ªåºåˆ—åŒ–çš„RDDæ„æˆï¼ŒæŒ‰æ—¶é—´ç‰‡ï¼ˆæ¯”å¦‚ä¸€ç§’ï¼‰åˆ‡åˆ†æˆçš„æ¯ä¸ªæ•°æ®å•ä½éƒ½æ˜¯ä¸€ä¸ªRDDã€‚ç„¶åï¼ŒSparkæ ¸å¿ƒå¼•æ“å°†å¯¹DStreamçš„Transformationæ“ä½œå˜ä¸ºé’ˆå¯¹Sparkä¸­å¯¹ RDDçš„Transformationæ“ä½œï¼Œå°†RDDç»è¿‡æ“ä½œå˜æˆä¸­é—´ç»“æœä¿å­˜åœ¨å†…å­˜ä¸­ã€‚</p><p>ä¹‹å‰çš„DataFrameå’ŒDataSetä¹Ÿæ˜¯åŒæ ·åŸºäºRDDï¼Œæ‰€ä»¥è¯´RDDæ˜¯Sparkæœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡ã€‚å°±åƒJavaé‡Œçš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆPrimitive Typeï¼‰ä¸€æ ·ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½å¯ä»¥ç”¨åŸºæœ¬æ•°æ®ç±»å‹æè¿°ã€‚</p><p>ä¹Ÿæ­£æ˜¯å› ä¸ºè¿™æ ·ï¼Œæ— è®ºæ˜¯DataFrameï¼Œè¿˜æ˜¯DStreamï¼Œéƒ½å…·æœ‰RDDçš„ä¸å¯å˜æ€§ã€åˆ†åŒºæ€§å’Œå®¹é”™æ€§ç­‰ç‰¹è´¨ã€‚</p><p>æ‰€ä»¥ï¼ŒSparkæ˜¯ä¸€ä¸ªé«˜åº¦ç»Ÿä¸€çš„å¹³å°ï¼Œæ‰€æœ‰çš„é«˜çº§APIéƒ½æœ‰ç›¸åŒçš„æ€§è´¨ï¼Œå®ƒä»¬ä¹‹é—´å¯ä»¥å¾ˆå®¹æ˜“åœ°ç›¸äº’è½¬åŒ–ã€‚Sparkçš„é‡å¿ƒå°±æ˜¯ç”¨è¿™ä¸€å¥—å·¥å…·ç»Ÿä¸€æ‰€æœ‰æ•°æ®å¤„ç†çš„åœºæ™¯ã€‚</p><p>ç”±äºSpark Streamingå°†åº•å±‚çš„ç»†èŠ‚å°è£…èµ·æ¥äº†ï¼Œæ‰€ä»¥å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œåªéœ€è¦æ“ä½œDStreamå°±è¡Œã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ DStreamçš„ç»“æ„ä»¥åŠå®ƒæ”¯æŒçš„è½¬æ¢æ“ä½œã€‚</p><h2>DStream</h2><p>ä¸‹å›¾å°±æ˜¯DStreamçš„å†…éƒ¨å½¢å¼ï¼Œå³ä¸€ä¸ªè¿ç»­çš„RDDåºåˆ—ï¼Œæ¯ä¸€ä¸ªRDDä»£è¡¨ä¸€ä¸ªæ—¶é—´çª—å£çš„è¾“å…¥æ•°æ®æµã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/66/ac/66b4562bcbd4772160f0f5766b59b5ac.png?wh=4758*1217\" alt=\"\"></p><p>å¯¹DStreamçš„è½¬æ¢æ“ä½œï¼Œæ„å‘³ç€å¯¹å®ƒåŒ…å«çš„æ¯ä¸€ä¸ªRDDè¿›è¡ŒåŒæ ·çš„è½¬æ¢æ“ä½œã€‚æ¯”å¦‚ä¸‹è¾¹çš„ä¾‹å­ã€‚</p><pre><code>sc = SparkContext(master, appName)\nssc = StreamingContext(sc, 1)\nlines = sc.socketTextStream(&quot;localhost&quot;, 9999)\nwords = lines.flatMap(lambda line: line.split(&quot; &quot;))\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/72/b4/72d05c02bf547f5c993fb0b3349343b4.png?wh=4758*2084\" alt=\"\"></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªlinesçš„DStreamï¼Œå»ç›‘å¬æ¥è‡ªæœ¬æœº9999ç«¯å£çš„æ•°æ®æµï¼Œæ¯ä¸€ä¸ªæ•°æ®ä»£è¡¨ä¸€è¡Œæ–‡æœ¬ã€‚ç„¶åï¼Œå¯¹linesè¿›è¡ŒflatMapçš„è½¬æ¢æ“ä½œï¼ŒæŠŠæ¯ä¸€ä¸ªæ–‡æœ¬è¡Œæ‹†åˆ†æˆè¯è¯­ã€‚</p><p>æœ¬è´¨ä¸Šï¼Œå¯¹ä¸€ä¸ªDStreamè¿›è¡ŒflatMapæ“ä½œï¼Œå°±æ˜¯å¯¹å®ƒé‡Œè¾¹çš„æ¯ä¸€ä¸ªRDDè¿›è¡ŒflatMapæ“ä½œï¼Œç”Ÿæˆäº†ä¸€ç³»åˆ—æ–°çš„RDDï¼Œæ„æˆäº†ä¸€ä¸ªæ–°çš„ä»£è¡¨è¯è¯­çš„DStreamã€‚</p><p>æ­£å› ä¸ºDStreamå’ŒRDDçš„å…³ç³»ï¼ŒRDDæ”¯æŒçš„æ‰€æœ‰è½¬æ¢æ“ä½œï¼ŒDStreaméƒ½æ”¯æŒï¼Œæ¯”å¦‚mapã€flatMapã€filterã€unionç­‰ã€‚è¿™äº›æ“ä½œæˆ‘ä»¬åœ¨å‰è¾¹å­¦ä¹ RDDæ—¶éƒ½è¯¦ç»†ä»‹ç»è¿‡ï¼Œåœ¨æ­¤ä¸åšèµ˜è¿°ã€‚</p><p>æ­¤å¤–ï¼ŒDStreamè¿˜æœ‰ä¸€äº›ç‰¹æœ‰æ“ä½œï¼Œå¦‚æ»‘åŠ¨çª—å£æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·æ¢è®¨ã€‚</p><h3>æ»‘åŠ¨çª—å£æ“ä½œ</h3><p>ä»»ä½•Spark Streamingçš„ç¨‹åºéƒ½è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ª<strong>StreamingContext</strong>çš„å¯¹è±¡ï¼Œå®ƒæ˜¯æ‰€æœ‰Streamingæ“ä½œçš„å…¥å£ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡StreamingContextæ¥åˆ›å»ºDStreamã€‚å‰è¾¹æåˆ°çš„ä¾‹å­ä¸­ï¼Œlinesè¿™ä¸ªDStreamå°±æ˜¯ç”±åä¸ºscçš„StreamingContextåˆ›å»ºçš„ã€‚</p><p>StreamingContextä¸­æœ€é‡è¦çš„å‚æ•°æ˜¯æ‰¹å¤„ç†çš„<strong>æ—¶é—´é—´éš”</strong>ï¼Œå³æŠŠæµæ•°æ®ç»†åˆ†æˆæ•°æ®å—çš„ç²’åº¦ã€‚</p><p>è¿™ä¸ªæ—¶é—´é—´éš”å†³å®šäº†æµå¤„ç†çš„å»¶è¿Ÿæ€§ï¼Œæ‰€ä»¥ï¼Œéœ€è¦æˆ‘ä»¬æ ¹æ®éœ€æ±‚å’Œèµ„æºæ¥æƒè¡¡é—´éš”çš„é•¿åº¦ã€‚ä¸Šè¾¹çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠè¾“å…¥çš„æ•°æ®æµä»¥ç§’ä¸ºå•ä½åˆ’åˆ†ï¼Œæ¯ä¸€ç§’çš„æ•°æ®ä¼šç”Ÿæˆä¸€ä¸ªRDDè¿›è¡Œè¿ç®—ã€‚</p><p>æœ‰äº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œç»Ÿè®¡è¿‡å»æŸä¸ªæ—¶é—´æ®µå†…çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¯¹çƒ­ç‚¹æœç´¢è¯è¯­è¿›è¡Œç»Ÿè®¡ï¼Œæ¯éš”10ç§’é’Ÿè¾“å‡ºè¿‡å»60ç§’å†…æ’åå‰åä½çš„çƒ­ç‚¹è¯ã€‚è¿™æ˜¯æµå¤„ç†çš„ä¸€ä¸ªåŸºæœ¬åº”ç”¨åœºæ™¯ï¼Œå¾ˆå¤šæµå¤„ç†æ¡†æ¶å¦‚Apache Flinkéƒ½æœ‰åŸç”Ÿçš„æ”¯æŒã€‚æ‰€ä»¥ï¼ŒSparkä¹ŸåŒæ ·æ”¯æŒæ»‘åŠ¨çª—å£æ“ä½œã€‚</p><p>ä»ç»Ÿè®¡çƒ­ç‚¹è¯è¿™ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥çœ‹å‡ºæ»‘åŠ¨çª—å£æ“ä½œæœ‰ä¸¤ä¸ªåŸºæœ¬å‚æ•°ï¼š</p><ul>\n<li>çª—å£é•¿åº¦ï¼ˆwindow lengthï¼‰ï¼šæ¯æ¬¡ç»Ÿè®¡çš„æ•°æ®çš„æ—¶é—´è·¨åº¦ï¼Œåœ¨ä¾‹å­ä¸­æ˜¯60ç§’ï¼›</li>\n<li>æ»‘åŠ¨é—´éš”ï¼ˆsliding intervalï¼‰ï¼šæ¯æ¬¡ç»Ÿè®¡çš„æ—¶é—´é—´éš”ï¼Œåœ¨ä¾‹å­ä¸­æ˜¯10ç§’ã€‚</li>\n</ul><p>æ˜¾ç„¶ï¼Œç”±äºSpark Streamingæµå¤„ç†çš„æœ€å°æ—¶é—´å•ä½å°±æ˜¯StreamingContextçš„æ—¶é—´é—´éš”ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‚æ•°ä¸€å®šæ˜¯å®ƒçš„æ•´æ•°å€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/93/e3/933bd108299c65a3eb00329f345119e3.png?wh=4758*2066\" alt=\"\"></p><p>æœ€åŸºæœ¬çš„æ»‘åŠ¨çª—å£æ“ä½œæ˜¯windowï¼Œå®ƒå¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„DStreamï¼Œè¿™ä¸ªDStreamä¸­æ¯ä¸ªRDDä»£è¡¨ä¸€æ®µæ—¶é—´çª—å£å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p><pre><code>windowed_words = words.window(60, 10)\n</code></pre><p>windowed_wordsä»£è¡¨çš„å°±æ˜¯çƒ­è¯ç»Ÿè®¡ä¾‹å­ä¸­æˆ‘ä»¬æ‰€éœ€çš„DStreamï¼Œå³å®ƒé‡Œè¾¹æ¯ä¸€ä¸ªæ•°æ®å—éƒ½åŒ…å«è¿‡å»60ç§’å†…çš„è¯è¯­ï¼Œè€Œä¸”è¿™æ ·çš„å—æ¯10ç§’é’Ÿå°±ä¼šç”Ÿæˆä¸€ä¸ªã€‚</p><p>æ­¤å¤–ï¼ŒSpark Streamingè¿˜æ”¯æŒä¸€äº›â€œè¿›é˜¶â€çª—å£æ“ä½œã€‚å¦‚countByWindowã€reduceByWindowã€reduceByKeyAndWindowå’ŒcountByValueAndWindowï¼Œåœ¨æ­¤ä¸åšæ·±å…¥è®¨è®ºã€‚</p><h2>Spark Streamingçš„ä¼˜ç¼ºç‚¹</h2><p>è®²äº†è¿™ä¹ˆå¤šSpark Streamingï¼Œä¸ç®¡å†…éƒ¨å®ç°ä¹Ÿå¥½ï¼Œæ”¯æŒçš„APIä¹Ÿå¥½ï¼Œæˆ‘ä»¬è¿˜å¹¶ä¸æ˜ç™½å®ƒçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Œç›¸æ¯”èµ·å…¶ä»–æµå¤„ç†æ¡†æ¶çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆã€‚åªæœ‰æ˜ç™½äº†è¿™äº›ï¼Œæ‰èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨å®é™…å·¥ä½œä¸­å†³å®šæ˜¯å¦ä½¿ç”¨Spark Streamingã€‚</p><p>é¦–å…ˆï¼ŒSpark Streamingçš„ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼Œç”±äºå®ƒçš„åº•å±‚æ˜¯åŸºäºRDDå®ç°çš„ï¼Œæ‰€ä»¥RDDçš„ä¼˜è‰¯ç‰¹æ€§åœ¨å®ƒè¿™é‡Œéƒ½æœ‰ä½“ç°ã€‚</p><p>æ¯”å¦‚ï¼Œæ•°æ®å®¹é”™æ€§ï¼Œå¦‚æœRDD çš„æŸäº›åˆ†åŒºä¸¢å¤±äº†ï¼Œå¯ä»¥é€šè¿‡ä¾èµ–ä¿¡æ¯é‡æ–°è®¡ç®—æ¢å¤ã€‚</p><p>å†æ¯”å¦‚è¿è¡Œé€Ÿåº¦ï¼ŒDStreamåŒæ ·ä¹Ÿèƒ½é€šè¿‡persist()æ–¹æ³•å°†æ•°æ®æµå­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯é‡åˆ°éœ€è¦å¤šæ¬¡è¿­ä»£è®¡ç®—çš„ç¨‹åºæ—¶ï¼Œé€Ÿåº¦ä¼˜åŠ¿ååˆ†æ˜æ˜¾ã€‚</p><p>è€Œä¸”ï¼ŒSpark Streamingæ˜¯Sparkç”Ÿæ€çš„ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥ï¼Œå®ƒå¯ä»¥å’ŒSparkçš„æ ¸å¿ƒå¼•æ“ã€Spark SQLã€MLlibç­‰æ— ç¼è¡”æ¥ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹å®æ—¶å¤„ç†å‡ºæ¥çš„ä¸­é—´æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³åœ¨ç¨‹åºä¸­æ— ç¼è¿›è¡Œæ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢ç­‰æ“ä½œã€‚è¿™ä¸ªç‰¹ç‚¹å¤§å¤§å¢å¼ºäº†Spark Streamingçš„ä¼˜åŠ¿å’ŒåŠŸèƒ½ï¼Œä½¿å¾—åŸºäºSpark Streamingçš„åº”ç”¨ç¨‹åºå¾ˆå®¹æ˜“æ‰©å±•ã€‚</p><p>è€ŒSpark Streamingçš„ä¸»è¦ç¼ºç‚¹æ˜¯å®æ—¶è®¡ç®—å»¶è¿Ÿè¾ƒé«˜ï¼Œä¸€èˆ¬åœ¨ç§’çš„çº§åˆ«ã€‚è¿™æ˜¯ç”±äºSpark Streamingä¸æ”¯æŒå¤ªå°çš„æ‰¹å¤„ç†çš„æ—¶é—´é—´éš”ã€‚</p><p>åœ¨ç¬¬äºŒç« ä¸­ï¼Œæˆ‘ä»¬è®²è¿‡å‡†å®æ—¶å’Œå®æ—¶ç³»ç»Ÿï¼Œæ— ç–‘Spark Streamingæ˜¯ä¸€ä¸ªå‡†å®æ—¶ç³»ç»Ÿã€‚åˆ«çš„æµå¤„ç†æ¡†æ¶ï¼Œå¦‚Stormçš„å»¶è¿Ÿæ€§å°±å¥½å¾ˆå¤šï¼Œå¯ä»¥åšåˆ°æ¯«ç§’çº§ã€‚</p><h2>å°ç»“</h2><p>Spark Streamingï¼Œä½œä¸ºSparkä¸­çš„æµå¤„ç†ç»„ä»¶ï¼ŒæŠŠè¿ç»­çš„æµæ•°æ®æŒ‰æ—¶é—´é—´éš”åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªæ•°æ®å—ï¼Œç„¶åå¯¹æ¯ä¸ªæ•°æ®å—åˆ†åˆ«è¿›è¡Œæ‰¹å¤„ç†ã€‚</p><p>åœ¨å†…éƒ¨ï¼Œæ¯ä¸ªæ•°æ®å—å°±æ˜¯ä¸€ä¸ªRDDï¼Œæ‰€ä»¥Spark Streamingæœ‰RDDçš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œå¤„ç†é€Ÿåº¦å¿«ï¼Œæ•°æ®å®¹é”™æ€§å¥½ï¼Œæ”¯æŒé«˜åº¦å¹¶è¡Œè®¡ç®—ã€‚</p><p>ä½†æ˜¯ï¼Œå®ƒçš„å®æ—¶å»¶è¿Ÿç›¸æ¯”èµ·åˆ«çš„æµå¤„ç†æ¡†æ¶æ¯”è¾ƒé«˜ã€‚åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å…·ä½“æƒ…å†µå…·ä½“åˆ†æï¼Œé€‰æ‹©æ­£ç¡®çš„å¤„ç†æ¡†æ¶ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¦‚æœæƒ³è¦ä¼˜åŒ–ä¸€ä¸ªSpark Streamingç¨‹åºï¼Œä½ ä¼šä»å“ªäº›è§’åº¦å…¥æ‰‹ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠç­”æ¡ˆå†™åœ¨ç•™è¨€åŒºï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":97315,"user_name":"Hobbin","can_delete":false,"product_type":"c1","uid":1513048,"ip_address":"","ucode":"3341E0241C5E3E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqTwSGXttkspRF37CTYQvVsibWicKJDtseiaE3DibfsSAHiaFM2Iwb04hg3O0Bq9JfG358A7Tlhia6vAhDw/132","comment_is_top":false,"comment_ctime":1558654977,"is_pvip":false,"replies":[{"id":"48472","content":"ä½ è¯´çš„å¾ˆå¯¹ï¼ŒStructured streamingæ˜¯Sparkæµå¤„ç†çš„æœªæ¥ï¼Œæ‰€ä»¥æˆ‘åœ¨ç¬¬17è®²ä»¥åŠä¹‹åçš„å®æˆ˜æ¼”ç»ƒæ‰é‡ç‚¹ä»‹ç»äº†å®ƒã€‚æ­¤å¤„ä»‹ç»spark streamingä¸€æ¥æ˜¯å› ä¸ºå®ƒçš„åŸç†å¾ˆåŸºæœ¬ä¹Ÿå¾ˆé‡è¦ï¼ŒäºŒæ¥å®ƒæ‰¿æ¥äº†ä¹‹å‰ä»‹ç»çš„RDD APIã€‚<br><br>æ‰€ä»¥æˆ‘è§‰å¾—Structured Streamingä¼šæ›¿ä»£Spark Streamingï¼Œä½†æ˜¯å¾ˆéš¾æ›¿ä»£Flinkã€‚Flinkåœ¨æµå¤„ç†ä¸Šçš„å¤©ç„¶ä¼˜åŠ¿å¾ˆéš¾è¢«Sparkè¶…è¶Šï¼Œè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…Strucutred Streamingæœªæ¥ä¼šå¦‚ä½•å‘å±•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567373530,"ip_address":"","comment_id":97315,"utype":1}],"discussion_count":6,"race_medal":0,"score":"134702641153","product_id":100025301,"comment_content":"è€å¸ˆï¼ŒSparkå›¢é˜Ÿå¯¹Spark streamingæ›´æ–°è¶Šæ¥è¶Šå°‘ï¼ŒSpark streamingå­˜åœ¨ä½¿ç”¨Processing time è€Œé Event timeï¼Œæ‰¹æµä»£ç ä¸ç»Ÿä¸€ç­‰é—®é¢˜ï¼Œè€ŒStructured streamingå¯¹è¿™äº›éƒ½æœ‰ä¸€å®šæ”¹è¿›ã€‚æ‰€ä»¥Structure streaming ä¼šæ›¿ä»£Spark streamingæˆ–è€…Flinkï¼Œæˆä¸ºä¸»æµçš„æµè®¡ç®—å¼•æ“å—ï¼Ÿ","like_count":32,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451222,"discussion_content":"ä½ è¯´çš„å¾ˆå¯¹ï¼ŒStructured streamingæ˜¯Sparkæµå¤„ç†çš„æœªæ¥ï¼Œæ‰€ä»¥æˆ‘åœ¨ç¬¬17è®²ä»¥åŠä¹‹åçš„å®æˆ˜æ¼”ç»ƒæ‰é‡ç‚¹ä»‹ç»äº†å®ƒã€‚æ­¤å¤„ä»‹ç»spark streamingä¸€æ¥æ˜¯å› ä¸ºå®ƒçš„åŸç†å¾ˆåŸºæœ¬ä¹Ÿå¾ˆé‡è¦ï¼ŒäºŒæ¥å®ƒæ‰¿æ¥äº†ä¹‹å‰ä»‹ç»çš„RDD APIã€‚\n\næ‰€ä»¥æˆ‘è§‰å¾—Structured Streamingä¼šæ›¿ä»£Spark Streamingï¼Œä½†æ˜¯å¾ˆéš¾æ›¿ä»£Flinkã€‚Flinkåœ¨æµå¤„ç†ä¸Šçš„å¤©ç„¶ä¼˜åŠ¿å¾ˆéš¾è¢«Sparkè¶…è¶Šï¼Œè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…Strucutred Streamingæœªæ¥ä¼šå¦‚ä½•å‘å±•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567373530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10962,"discussion_content":"è¿™ç¯‡æ²¡æœ‰è¯¾ä»£è¡¨ã€‚\nå¯¹äºå®æ—¶è®¡ç®—æ…¢çš„é—®é¢˜ï¼Œå¯å¦é€šè¿‡ç¼“å­˜çš„å½¢å¼è¾¾åˆ°æ”¹å–„å‘¢ï¼Œæ¯”å¦‚æŠŠå‰å‡ åˆ†é’Ÿçš„ç»“æœè®¡ç®—å‡ºæ¥ï¼Œç„¶åå’Œæœ€è¿‘1ç§’çš„ç»“æœåšå»é‡ä¹‹ç±»çš„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1568344442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1111899,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/5b/d2e7c2c4.jpg","nickname":"æ—¶éšæ—¶ç°","note":"","ucode":"DA4D622FF84920","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32229,"discussion_content":"è¿™ä¸ªæ€è·¯å¥½ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½è§£å†³æ—¶é—´ç²¾åº¦é—®é¢˜ï¼Œå³å¦‚ä½•è·å–æ¯«ç§’çº§çš„å®æ—¶æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571018187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":10962,"ip_address":""},"score":32229,"extra":""},{"author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202561,"discussion_content":"è¿™å°±æ˜¯micro-lambdaæ¶æ„å˜›ï¼Œä¸è¿‡åº”è¯¥æœ‰ä¸å°‘aggregationå¹¶ä¸æ”¯æŒè¿™ç§æ•´åˆå§ï¼Ÿè€Œä¸”ä¸ªäººè®¤ä¸ºsparkå¹¶ä¸æ˜¯å®æ—¶è®¡ç®—æ…¢ï¼Œè€Œæ˜¯RDDè¿™å¥—é’ˆå¯¹æ‰¹å¤„ç†çš„æŠ½è±¡åœ¨spark streamingä¸­è½¬è¯‘æˆæµçª—å£çš„workflowæ—¶å¤©ç”Ÿæ‰€å›ºæœ‰çš„æ—¶é—´æŸå¤±ï¼ŒçŸ›å¤´åªèƒ½æŒ‡å‘sparkçš„æ‰¹å¤„ç†è®¾è®¡æ€æƒ³äº†","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1583933397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":10962,"ip_address":""},"score":202561,"extra":""},{"author":{"id":1266620,"avatar":"https://static001.geekbang.org/account/avatar/00/13/53/bc/72baeee8.jpg","nickname":"æ—é»›ç‰","note":"","ucode":"F8507366012881","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209572,"discussion_content":"æœ‰å¯å‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584637354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":202561,"ip_address":""},"score":209572,"extra":""}]},{"author":{"id":1129610,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/8a/900ca88a.jpg","nickname":"test","note":"","ucode":"C57A175CBC6547","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382981,"discussion_content":"æ²¡å¤ªæ‡‚ï¼ŒæŠŠå‰å‡ åˆ†é’Ÿçš„ç»“æœè®¡ç®—å‡ºæ¥ï¼Œå’Œæœ€è¿‘1ç§’çš„ç»“æœåšå»é‡æ˜¯ä»€ä¹ˆæ„æ€çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625815504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97509,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1558686669,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"70278163405","product_id":100025301,"comment_content":"æ‰¹å¤„ç†å¯ä»¥é€‰æ‹©sparkï¼›æµå¤„ç†ï¼šspark streamï¼Œstormï¼ŒFlinkï¼›è¿˜æœ‰ç°åœ¨å¤§ç»Ÿä¸€çš„beam<br>è¯·é—®ï¼šè¿™äº›æŠ€æœ¯éƒ½è¦å­¦ä¸€éå—ï¼Ÿç²¾åŠ›æ”¾åœ¨å“ªä¸ªæŠ€æœ¯ä¸Šï¼Ÿ<br>å¦‚æœæˆ‘æ˜¯åˆå­¦è€…ï¼Œæˆ‘èƒ½ç›´æ¥å­¦beamå…¶å®ƒéƒ½ä¸å­¦å—ï¼Ÿ","like_count":17,"discussions":[{"author":{"id":1503796,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/6XZUTxfoWu6qsSbVYsP9HBbIFpO0PSPRHVVtrqTd8e7gOOJzicLt4EeaJtxXBpLpPrBd1Xm8zl9b6iaLSPLwNOsQ/132","nickname":"ArchieGu","note":"","ucode":"F66CA1E09CA222","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":882,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562136175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1247844,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/4J6FicYsBYPrEibPaYX0f5e9ArNr21vE0UyhLQZxiaNdlOoia61b2sH5Aemux520IeL0FzmIic8G4a7z02zRBMwE6iaA/132","nickname":"å¨å¨","note":"","ucode":"2930DFEFB3CB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1503796,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/6XZUTxfoWu6qsSbVYsP9HBbIFpO0PSPRHVVtrqTd8e7gOOJzicLt4EeaJtxXBpLpPrBd1Xm8zl9b6iaLSPLwNOsQ/132","nickname":"ArchieGu","note":"","ucode":"F66CA1E09CA222","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6958,"discussion_content":"hadoopï¼Œzookeeper,hbase,kafkaç­‰ç­‰ä¹Ÿæ˜¯éœ€è¦äº†è§£çš„ã€‚äº†è§£è¿™äº›æœ‰åŠ©äºä½ æ›´å¥½çš„å‘ç°å¹¶è§£å†³é—®é¢˜ã€‚å›½å†…ç°çŠ¶ä¸€äº›batå…¬å¸åˆ†çš„å¾ˆç»†å…·ä½“åˆ°æŸä¸€ä¸ªæŠ€æœ¯æ¯”å¦‚ä½ è¯´çš„åªå­¦ä¸€ä¸ªæŠ€æœ¯ï¼Œå­¦åˆ°å¯ä»¥ä¸ºäº†é€‚åº”å…¬å¸ä¸šåŠ¡è€Œè°ƒæ•´æºç ã€‚åˆ«çš„å…¬å¸å¯èƒ½ä¼šè¦æ±‚ä½ äº†è§£çš„è¶Šå¤šè¶Šå¥½ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1567220344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":882,"ip_address":""},"score":6958,"extra":""}]}]},{"had_liked":false,"id":97970,"user_name":"é‚±ä»è´¤â€»klion26","can_delete":false,"product_type":"c1","uid":1027239,"ip_address":"","ucode":"36DF21F2B9E94C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a7/4d41966a.jpg","comment_is_top":false,"comment_ctime":1558856825,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57393431673","product_id":100025301,"comment_content":"ä¸Šä¸€æ¡ç•™è¨€æ²¡æœ‰è¯´å®Œã€‚<br>spark streaming éœ€è¦è®¾ç½® batch time æ˜¯å¤šå°‘ï¼Œè¿™å†³å®šæ—¶æ•ˆæ€§ï¼Œä»¥åŠè°ƒåº¦çš„ overheadï¼Œå¦å¤–è¦çœ‹è‡ªå·±éœ€è¦çš„ååå¤šå¤§ï¼Œå¹¶å‘æ˜¯ä¸æ˜¯æœ‰ç‰¹æ®Šéœ€æ±‚ã€‚<br>spark streaming æœ‰å‡ ä¸ªç‚¹ä¸å¤ªå–œæ¬¢ï¼Œä¿®æ”¹ä¸šåŠ¡é€»è¾‘åï¼Œéœ€è¦åˆ é™¤ checkpoint æ‰è¡Œï¼Œè¿™ä¼šå¯¼è‡´ä»å¤´è®¡ç®—ï¼›æ…¢èŠ‚ç‚¹æ²¡æ³•è§£å†³ï¼Œå½“ä¸€ä¸ª batch é‡Œé¢æœ‰ä¸€ä¸ªèŠ‚ç‚¹å¾ˆéš¾çš„æ—¶å€™ï¼Œæ•´ä¸ª batch éƒ½æ— æ³•å®Œæˆã€‚<br>ä¸€ä¸ªåå¸¸è¯†çš„ç‚¹ï¼šå®æ—¶ etl åŒæ ·ååä¸‹ï¼Œflink æ¯” spark streaming æ›´èŠ‚çœèµ„æºã€‚<br>å¦å¤–å®˜æ–¹å·²ç»æ”¾å¼ƒ spark streamingï¼Œè½¬å‘structured streamingï¼Œä½†æ˜¯ä»é‚®ä»¶åˆ—è¡¨çœ‹åˆæ²¡æœ‰ commiter åœ¨ç®¡ï¼Œå¯¼è‡´ pr æ²¡äºº reviewï¼Œæˆ–è®¸è¿™å’Œ spark æ•´ä½“çš„é‡å¿ƒæˆ–è€…æ–¹å‘æœ‰å…³å§","like_count":14},{"had_liked":false,"id":97362,"user_name":"lwenbin","can_delete":false,"product_type":"c1","uid":1202109,"ip_address":"","ucode":"05C4CC6BE0B56C","user_header":"https://static001.geekbang.org/account/avatar/00/12/57/bd/acf40fa0.jpg","comment_is_top":false,"comment_ctime":1558660361,"is_pvip":false,"replies":[{"id":"48578","content":"å¦‚æœtransformé“¾å¾ˆé•¿ï¼Œåœ¨æµå¤„ç†ä¸­ç¡®å®ä¼šå½±å“å¤„ç†çš„å®æ—¶æ€§ï¼Œä½ çš„æƒ³æ³•æ˜¯å¯¹çš„ã€‚å¦‚æœåªæœ‰ä¸€æ¡å¾ˆé•¿çš„é“¾ï¼Œåœ¨Sparkçš„æ¡†æ¶ä¸­ï¼Œä¹Ÿå¾ˆéš¾å»ä¼˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567411789,"ip_address":"","comment_id":97362,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35918398729","product_id":100025301,"comment_content":"æ²¡ç”¨è¿‡spark streaming, ç”¨stormæ¯”è¾ƒå¤šã€‚<br>è§‰å¾—æµå¤„ç†å…³é”®åœ¨äºè¦åœ¨çª—å£å†…å°½å¿«åœ°æŠŠåˆ°æ¥çš„æ•°æ®å¤„ç†å®Œï¼Œä¸è¦é€ æˆæ•°æ®å †ç§¯ï¼Œå†…å­˜æº¢å‡ºã€‚<br>å…¶ä¸­ç‰µæ¶‰åˆ°äº†å¦‚ä½•é«˜æ•ˆåœ°æ¥å—æ•°æ®ï¼Œå¦‚ä½•å¹¶è¡Œå°½å¿«åœ°å¤„ç†æ•°æ®ã€‚<br>è§‰å¾—ä¼˜åŒ–å¯ä»¥ä»ï¼šæ¥å—è¾“å…¥ï¼Œå¤„ç†ç®—æ³•ï¼Œå¤„ç†å•å…ƒæ•°é‡ï¼ŒGCè°ƒä¼˜ç­‰æ–¹é¢å…¥æ‰‹å§ã€‚<br>æœ‰ä¸ªé—®é¢˜ï¼Œå¯¹äºRDDå¦‚æœtransformé“¾å¾ˆé•¿ï¼Œæ„Ÿè§‰æ˜¯å¦ä¼šå¯¹æ€§èƒ½é€ æˆä¸€å®šå½±å“ï¼Œç‰¹åˆ«æ˜¯æµå¼æˆ–è€…å›¾å½¢è®¡ç®—ï¼Ÿè€å¸ˆèƒ½å¦è§£ç­”ä¸€ä¸‹ã€‚<br>è°¢è°¢ï¼","like_count":9,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451249,"discussion_content":"å¦‚æœtransformé“¾å¾ˆé•¿ï¼Œåœ¨æµå¤„ç†ä¸­ç¡®å®ä¼šå½±å“å¤„ç†çš„å®æ—¶æ€§ï¼Œä½ çš„æƒ³æ³•æ˜¯å¯¹çš„ã€‚å¦‚æœåªæœ‰ä¸€æ¡å¾ˆé•¿çš„é“¾ï¼Œåœ¨Sparkçš„æ¡†æ¶ä¸­ï¼Œä¹Ÿå¾ˆéš¾å»ä¼˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567411789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111899,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f7/5b/d2e7c2c4.jpg","nickname":"æ—¶éšæ—¶ç°","note":"","ucode":"DA4D622FF84920","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32238,"discussion_content":"å‰é¢æŸè®²ä¸­ä¸æ˜¯æœ‰ä¸ªä¾‹å­æ˜¯è¯»å–æ–‡ä»¶ï¼Œè¿‡æ»¤å…³é”®å­—ï¼Œè¿”å›æ»¡è¶³æ¡ä»¶çš„ç¬¬1è¡Œå—ï¼Œè¿™ä¸ªä¸æ˜¯transformé“¾å—ï¼Œå¦‚ä½•è¿™æ¡é“¾å¾ˆé•¿ï¼Œä¸æ­£å¥½å¯ä»¥ä»æ•´ä½“é€»è¾‘è¿›è¡Œä¼˜åŒ–å—ï¼Œé¿å…äº†å…¨æ–‡ä»¶æ‰«æï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571018421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186828,"user_name":"Fiery","can_delete":false,"product_type":"c1","uid":1897610,"ip_address":"","ucode":"CDB000687A6B14","user_header":"","comment_is_top":false,"comment_ctime":1583934917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27353738693","product_id":100025301,"comment_content":"æ—¢ç„¶DStreamåº•å±‚è¿˜æ˜¯RDDï¼Œé‚£æˆ‘è®¤ä¸ºé’ˆå¯¹RDDçš„ä¸€äº›ä¼˜åŒ–ç­–ç•¥å¯¹DStreamä¹Ÿæœ‰æ•ˆã€‚æ¯”å¦‚å¹³è¡¡RDDåˆ†åŒºå‡å°‘æ•°æ®å€¾æ–œï¼Œåœ¨tranformationé“¾ä¸­ä¼˜å…ˆä½¿ç”¨filter&#47;select&#47;firstå‡å°‘æ•°æ®é‡ï¼Œå°½é‡ä¸²æ¥çª„ä¾èµ–å‡½æ•°æ–¹ä¾¿å®ç°èŠ‚ç‚¹é—´å¹¶è¡Œè®¡ç®—å’Œå•èŠ‚ç‚¹é“¾å¼è®¡ç®—ä¼˜åŒ–ï¼Œjoinæ—¶ä¼˜åŒ–åˆ†åŒºæˆ–ä½¿ç”¨broadcastå‡å°‘stageé—´shuffleã€‚<br><br>å¦å¤–ä¸“é—¨é’ˆå¯¹æµæ•°æ®çš„å¤„ç†ï¼Œä¸ªäººç»éªŒä¸Šä¸»è¦æ˜¯è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚å¾®è°ƒwindow lengthå’Œsliding intervalä»¥è¾¾åˆ°ååé‡å’Œå»¶æ—¶ä¹‹é—´çš„ä¸€ä¸ªæœ€ä¼˜å¹³è¡¡ï¼Œæ—¶é—´çª—å£è¶Šå¤§ï¼Œä¸€ä¸ªRDDå¯ä»¥ä¸€æ¬¡æ‰¹å¤„ç†çš„æ•°æ®å°±è¶Šå¤šï¼ŒSparkçš„ä¼˜åŠ¿å°±å¯ä»¥å‘æŒ¥å‡ºæ¥ï¼Œååé‡å°±ä¸Šå»äº†ã€‚è€Œæ»‘åŠ¨é—´éš”è¶Šå¤§ï¼Œwindowed DStreamåœ¨å›ºå®šæ—¶é—´å†…çš„RDDå°±è¶Šå°‘ï¼Œç³»ç»Ÿçš„ä»»åŠ¡é˜Ÿåˆ—é‡ŒåŒæ—¶éœ€è¦å¤„ç†çš„è®¡ç®—å½“ç„¶å°±è¶Šå°‘ï¼Œä¸è¿‡è¿™ä¸¤ä¸ªè°ƒæ•´éƒ½ä¼šåŠ å¤§æ•°æ®æ›´æ–°å»¶è¿Ÿå’Œç‰ºç‰²æ•°æ®å®æ—¶æ€§ï¼Œæ‰€ä»¥è¯´è¦æ ¹æ®ä¸šåŠ¡çœŸå®éœ€æ±‚è°¨æ…è°ƒæ•´ã€‚<br><br>ä¸è¿‡ä¸ªäººç†è§£RDDé‡Œé¢ç”¨æ¥é¿å…é‡å¤è®¡ç®—çš„cacheå’Œpersistæ— æ³•ç”¨æ¥å‡å°‘çª—å£æ»‘åŠ¨äº§ç”Ÿçš„é‡å¤è®¡ç®—ï¼Œå› ä¸ºçª—å£æ¯æ»‘åŠ¨ä¸€æ¬¡ï¼Œéƒ½äº§ç”Ÿä¸€ä¸ªæ–°çš„RDDï¼Œè€Œpersiståªé’ˆå¯¹å…¶ä¸­æŸä¸ªRDDè¿›è¡Œç¼“å­˜ï¼Œåœ¨RDDè¿™ç§low level apié‡Œé¢ï¼Œåº”è¯¥æ˜¯æ— æ³•çŸ¥é“ä¸‹ä¸ªçª—å£ä¸­çš„RDDå’Œç°åœ¨çš„RDDåˆ°åº•æœ‰å¤šå°‘æ•°æ®æ˜¯é‡å çš„ã€‚å¯¹äºè¿™ç‚¹ç†è§£æ˜¯å¦æ­£ç¡®æœ›è€å¸ˆè§£ç­”ï¼","like_count":7},{"had_liked":false,"id":97596,"user_name":"Ming","can_delete":false,"product_type":"c1","uid":1516011,"ip_address":"","ucode":"69BB73B8AB7E3F","user_header":"https://static001.geekbang.org/account/avatar/00/17/21/eb/bb2e7a3b.jpg","comment_is_top":false,"comment_ctime":1558705049,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14443606937","product_id":100025301,"comment_content":"ä¼˜åŒ–çš„å®šä¹‰å¾ˆå¹¿ï¼Œä¸çŸ¥é“åœ¨è¿™ä¸ªé¢†åŸŸå¤§å®¶æåˆ°è¿™ä¸ªè¯ä¸»è¦æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿæœ›è§£ç­”<br><br>ä¸è¿‡ï¼Œå¯¹å…·ä½“å®ç°ç»†èŠ‚ä¸äº†è§£çš„æƒ…å†µä¸‹æœ‰å‡ ä¸ªçŒœæµ‹ï¼š<br>æˆ‘ä¼šæ”¹å˜æ—¶é—´ç²’åº¦ï¼Œæ¥å‡å°‘RDDæœ¬èº«å¸¦æ¥çš„å¼€é”€ï¼Œä¸Šæ–‡çš„ä¾‹å­é‡Œæ—¶é—´ç²’åº¦å¦‚æœè®¾ç½®æˆ10ç§’åº”è¯¥é€»è¾‘ä¸Šä¹Ÿæ˜¯å¯è¡Œçš„ã€‚<br>å¦å¤–ï¼Œæˆ‘å¤§æ¦‚ä¼šè€ƒè™‘å¤šä½¿ç”¨persistæ¥å‡å°‘å› ä¸ºçª—å£æ»‘åŠ¨äº§ç”Ÿçš„é‡å¤è®¡ç®—ã€‚","like_count":3,"discussions":[{"author":{"id":1897610,"avatar":"","nickname":"Fiery","note":"","ucode":"CDB000687A6B14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202570,"discussion_content":"ä¸ªäººæ„Ÿè§‰persistæ— æ³•ç”¨æ¥å‡å°‘çª—å£æ»‘åŠ¨äº§ç”Ÿçš„é‡å¤è®¡ç®—ï¼Œå› ä¸ºçª—å£æ¯æ»‘åŠ¨ä¸€æ¬¡ï¼Œéƒ½äº§ç”Ÿä¸€ä¸ªæ–°çš„RDDï¼Œè€Œpersiståªé’ˆå¯¹å…¶ä¸­æŸä¸ªRDDè¿›è¡Œç¼“å­˜ï¼Œåœ¨RDDè¿™ç§low level apié‡Œé¢ï¼Œåº”è¯¥æ˜¯æ— æ³•çŸ¥é“ä¸‹ä¸ªçª—å£ä¸­çš„RDDå’Œç°åœ¨çš„RDDåˆ°åº•æœ‰å¤šå°‘æ•°æ®æ˜¯é‡å çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583934027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200108,"user_name":"ä¸è®°å¹´","can_delete":false,"product_type":"c1","uid":1045945,"ip_address":"","ucode":"287E40C68356DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg","comment_is_top":false,"comment_ctime":1585544586,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880511882","product_id":100025301,"comment_content":"åœ¨æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹å°½å¯èƒ½çš„ä½¿ç”¨æ›´å®½çš„çª—å£é•¿åº¦ï¼Œå‡å°‘rddçš„å¤„ç†é“¾","like_count":1},{"had_liked":false,"id":113293,"user_name":"ç‹ç¿”å®‡ğŸ¼","can_delete":false,"product_type":"c1","uid":1177925,"ip_address":"","ucode":"D7AA5EDEC8D612","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/45/eaa8beb0.jpg","comment_is_top":false,"comment_ctime":1562937064,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562937064","product_id":100025301,"comment_content":"scå’Œsscçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ç†è§£sscæ‰æ˜¯é‚£ä¸ªstreamingContextå§ï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆåˆå‡ºç°é”™è¯¯äº†ã€‚","like_count":0},{"had_liked":false,"id":98453,"user_name":"æ¸¡ç ","can_delete":false,"product_type":"c1","uid":1348536,"ip_address":"","ucode":"8FD8B863D1DA0C","user_header":"https://static001.geekbang.org/account/avatar/00/14/93/b8/6510592e.jpg","comment_is_top":false,"comment_ctime":1559005838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559005838","product_id":100025301,"comment_content":"ç¨³å®šæ€§ï¼šå¯¹äº7*24å°æ—¶çš„æµå¼ä»»åŠ¡è‡³å…³é‡è¦<br>ä½å»¶è¿Ÿé«˜ååé‡","like_count":1},{"had_liked":false,"id":97969,"user_name":"é‚±ä»è´¤â€»klion26","can_delete":false,"product_type":"c1","uid":1027239,"ip_address":"","ucode":"36DF21F2B9E94C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a7/4d41966a.jpg","comment_is_top":false,"comment_ctime":1558856415,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558856415","product_id":100025301,"comment_content":"spark streaming æ‰¹æ¬¡çš„å¤§å°è®¾ç½®å¤šå°‘åˆé€‚ï¼Œä»å®˜æ–¹å®£ä¼ æ¥çœ‹å·²ç»è¢« structure steeaming æ›¿ä»£ã€‚","like_count":0}]}