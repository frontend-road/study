{"id":12711,"title":"78 |【实验】Zuul 网关集成 CAT","content":"无","comments":[{"had_liked":false,"id":267148,"user_name":"mickey","can_delete":false,"product_type":"c3","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1607608745,"is_pvip":false,"replies":[{"id":97205,"content":"谢谢你的提示！⛽️","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1607867458,"ip_address":"","comment_id":267148,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"注意1：\n\n以下两个地方需要用同一版本，建议把zuul改为cat-client改为2.0.\n\n微服务网关Zuul架构和实践\ns2g-zuul项目中\nhttps:&#47;&#47;github.com&#47;spring2go&#47;s2g-zuul&#47;blob&#47;master&#47;pom.xml\n&lt;cat.version&gt;3.0.0&lt;&#47;cat.version&gt;\n\n微服务调用链监控CAT架构和实践\n实验二、CAT埋点案例实验\nhttps:&#47;&#47;github.com&#47;geektime-geekbang&#47;cat_lab&#47;blob&#47;master&#47;lab02&#47;acme-financial-ui&#47;pom.xml\n&lt;dependency&gt;\n   &lt;groupId&gt;com.dianping.cat&lt;&#47;groupId&gt;\n   &lt;artifactId&gt;cat-client&lt;&#47;artifactId&gt;\n   &lt;version&gt;2.0.0&lt;&#47;version&gt;\n&lt;&#47;dependency&gt;","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511526,"discussion_content":"谢谢你的提示！⛽️","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607867458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267078,"user_name":"mickey","can_delete":false,"product_type":"c3","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1607590663,"is_pvip":false,"replies":[{"id":97203,"content":"可以根据需要修改端口，只要保证zuul和apollo没有端口冲突，就可以部署在同一台机器上。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1607866685,"ip_address":"","comment_id":267078,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"在讲zuul和apollo集成的时候，zuul端口已改为了9000了吧","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511499,"discussion_content":"可以根据需要修改端口，只要保证zuul和apollo没有端口冲突，就可以部署在同一台机器上。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607866685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267077,"user_name":"mickey","can_delete":false,"product_type":"c3","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1607590592,"is_pvip":false,"replies":[{"id":97202,"content":"两个服务端应用在同一台机器上不能使用相同端口，否则会有端口冲突，建议修改其中一个使用不同的端口，只要端口不冲突，应该都可以部署在一个tomcat下。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1607866611,"ip_address":"","comment_id":267077,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"请问老师，把cat放到zuul同一个tomcat下，使用同一个端口，应该也可以吧。","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511498,"discussion_content":"两个服务端应用在同一台机器上不能使用相同端口，否则会有端口冲突，建议修改其中一个使用不同的端口，只要端口不冲突，应该都可以部署在一个tomcat下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607866611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":267151,"user_name":"mickey","can_delete":false,"product_type":"c3","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1607609420,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100007001,"comment_content":"注意2：\n\n如果采用配置文件 mobile_zuul.properties 增加路由表，\nzuul.routing_table_string=acme@http:&#47;&#47;localhost:8081\n\n需要将 InitializeServletListener.java 中 InitializeServletListener 方法中，注释Constants.DEPLOY_CONFIG_URL配置，否则将成Apollo配置中心获取路由表。\n   System.setProperty(Constants.DEPLOYMENT_APPLICATION_ID, &quot;mobile_zuul&quot;);\n   &#47;&#47;System.setProperty(Constants.DEPLOY_CONFIG_URL, &quot;http:&#47;&#47;localhost:8080&#47;configfiles&#47;mobile_zuul&#47;default&#47;application&quot;);\t\n","like_count":1}]}