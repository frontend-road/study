{"id":94097,"title":"31 | Guarded Suspensionæ¨¡å¼ï¼šç­‰å¾…å”¤é†’æœºåˆ¶çš„è§„èŒƒå®ç°","content":"<p>å‰ä¸ä¹…ï¼ŒåŒäº‹å°ç°å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä»–å¼€å‘äº†ä¸€ä¸ªWebé¡¹ç›®ï¼šWebç‰ˆçš„æ–‡ä»¶æµè§ˆå™¨ï¼Œé€šè¿‡å®ƒç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨é‡ŒæŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„ç›®å½•å’Œæ–‡ä»¶ã€‚è¿™ä¸ªé¡¹ç›®ä¾èµ–è¿ç»´éƒ¨é—¨æä¾›çš„æ–‡ä»¶æµè§ˆæœåŠ¡ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶æµè§ˆæœåŠ¡åªæ”¯æŒæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰æ–¹å¼æ¥å…¥ã€‚æ¶ˆæ¯é˜Ÿåˆ—åœ¨äº’è”ç½‘å¤§å‚ä¸­ç”¨çš„éå¸¸å¤šï¼Œä¸»è¦ç”¨ä½œæµé‡å‰Šå³°å’Œç³»ç»Ÿè§£è€¦ã€‚åœ¨è¿™ç§æ¥å…¥æ–¹å¼ä¸­ï¼Œå‘é€æ¶ˆæ¯å’Œæ¶ˆè´¹ç»“æœè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´æ˜¯å¼‚æ­¥çš„ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„ç¤ºæ„å›¾æ¥ç†è§£ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d1/21/d1ad5ce1df66d85698308c41e4e93a21.png?wh=1142*393\" alt=\"\"></p><center><span class=\"reference\">æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰ç¤ºæ„å›¾</span></center><p>åœ¨å°ç°çš„è¿™ä¸ªWebé¡¹ç›®ä¸­ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨å‘è¿‡æ¥ä¸€ä¸ªè¯·æ±‚ï¼Œä¼šè¢«è½¬æ¢æˆä¸€ä¸ªå¼‚æ­¥æ¶ˆæ¯å‘é€ç»™MQï¼Œç­‰MQè¿”å›ç»“æœåï¼Œå†å°†è¿™ä¸ªç»“æœè¿”å›è‡³æµè§ˆå™¨ã€‚å°ç°åŒå­¦çš„é—®é¢˜æ˜¯ï¼šç»™MQå‘é€æ¶ˆæ¯çš„çº¿ç¨‹æ˜¯å¤„ç†Webè¯·æ±‚çš„çº¿ç¨‹T1ï¼Œä½†æ¶ˆè´¹MQç»“æœçš„çº¿ç¨‹å¹¶ä¸æ˜¯çº¿ç¨‹T1ï¼Œé‚£çº¿ç¨‹T1å¦‚ä½•ç­‰å¾…MQçš„è¿”å›ç»“æœå‘¢ï¼Ÿä¸ºäº†ä¾¿äºä½ ç†è§£è¿™ä¸ªåœºæ™¯ï¼Œæˆ‘å°†å…¶ä»£ç åŒ–äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ã€‚</p><pre><code>class Message{\n  String id;\n  String content;\n}\n//è¯¥æ–¹æ³•å¯ä»¥å‘é€æ¶ˆæ¯\nvoid send(Message msg){\n  //çœç•¥ç›¸å…³ä»£ç \n}\n//MQæ¶ˆæ¯è¿”å›åä¼šè°ƒç”¨è¯¥æ–¹æ³•\n//è¯¥æ–¹æ³•çš„æ‰§è¡Œçº¿ç¨‹ä¸åŒäº\n//å‘é€æ¶ˆæ¯çš„çº¿ç¨‹\nvoid onMessage(Message msg){\n  //çœç•¥ç›¸å…³ä»£ç \n}\n//å¤„ç†æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚\nRespond handleWebReq(){\n  //åˆ›å»ºä¸€æ¶ˆæ¯\n  Message msg1 = new \n    Message(&quot;1&quot;,&quot;{...}&quot;);\n  //å‘é€æ¶ˆæ¯\n  send(msg1);\n  //å¦‚ä½•ç­‰å¾…MQè¿”å›çš„æ¶ˆæ¯å‘¢ï¼Ÿ\n  String result = ...;\n}\n</code></pre><p>çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ ä¸€å®šæœ‰ç‚¹ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œè¿™ä¸å°±æ˜¯å‰é¢æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/88487\">ã€Š15 | Lockå’ŒConditionï¼ˆä¸‹ï¼‰ï¼šDubboå¦‚ä½•ç”¨ç®¡ç¨‹å®ç°å¼‚æ­¥è½¬åŒæ­¥ï¼Ÿã€‹</a>ä¸­æ›¾ä»‹ç»è¿‡çš„å¼‚æ­¥è½¬åŒæ­¥é—®é¢˜å—ï¼Ÿä»”ç»†åˆ†æï¼Œçš„ç¡®æ˜¯è¿™æ ·ï¼Œä¸è¿‡åœ¨é‚£ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬åªæ˜¯ä»‹ç»äº†æœ€ç»ˆæ–¹æ¡ˆï¼Œè®©ä½ çŸ¥å…¶ç„¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»‹ç»è¿™ä¸ªæ–¹æ¡ˆæ˜¯å¦‚ä½•è®¾è®¡å‡ºæ¥çš„ï¼Œä»Šå¤©å’±ä»¬å†ä»”ç»†èŠèŠè¿™ä¸ªé—®é¢˜ï¼Œè®©ä½ çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œé‡åˆ°ç±»ä¼¼é—®é¢˜ä¹Ÿèƒ½è‡ªå·±è®¾è®¡å‡ºæ–¹æ¡ˆæ¥ã€‚</p><!-- [[[read_end]]] --><h2>Guarded Suspensionæ¨¡å¼</h2><p>ä¸Šé¢å°ç°é‡åˆ°çš„é—®é¢˜ï¼Œåœ¨ç°å®ä¸–ç•Œé‡Œæ¯”æ¯”çš†æ˜¯ï¼Œåªæ˜¯æˆ‘ä»¬ä¸€ä¸å°å¿ƒå°±å¿½ç•¥äº†ã€‚æ¯”å¦‚ï¼Œé¡¹ç›®ç»„å›¢å»ºè¦å¤–å‡ºèšé¤ï¼Œæˆ‘ä»¬æå‰é¢„è®¢äº†ä¸€ä¸ªåŒ…é—´ï¼Œç„¶åå…´å†²å†²åœ°å¥”è¿‡å»ï¼Œåˆ°é‚£å„¿åå¤§å ‚ç»ç†çœ‹äº†ä¸€çœ¼åŒ…é—´ï¼Œå‘ç°æœåŠ¡å‘˜æ­£åœ¨æ”¶æ‹¾ï¼Œå°±ä¼šå‘Šè¯‰æˆ‘ä»¬ï¼šâ€œæ‚¨é¢„è®¢çš„åŒ…é—´æœåŠ¡å‘˜æ­£åœ¨æ”¶æ‹¾ï¼Œè¯·æ‚¨ç¨ç­‰ç‰‡åˆ»ã€‚â€è¿‡äº†ä¸€ä¼šï¼Œå¤§å ‚ç»ç†å‘ç°åŒ…é—´å·²ç»æ”¶æ‹¾å®Œäº†ï¼Œäºæ˜¯é©¬ä¸Šå¸¦æˆ‘ä»¬å»åŒ…é—´å°±é¤ã€‚</p><p>æˆ‘ä»¬ç­‰å¾…åŒ…é—´æ”¶æ‹¾å®Œçš„è¿™ä¸ªè¿‡ç¨‹å’Œå°ç°é‡åˆ°çš„ç­‰å¾…MQè¿”å›æ¶ˆæ¯æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯<strong>ç­‰å¾…ä¸€ä¸ªæ¡ä»¶æ»¡è¶³</strong>ï¼šå°±é¤éœ€è¦ç­‰å¾…åŒ…é—´æ”¶æ‹¾å®Œï¼Œå°ç°çš„ç¨‹åºé‡Œè¦ç­‰å¾…MQè¿”å›æ¶ˆæ¯ã€‚</p><p>é‚£æˆ‘ä»¬æ¥çœ‹çœ‹ç°å®ä¸–ç•Œé‡Œæ˜¯å¦‚ä½•è§£å†³è¿™ç±»é—®é¢˜çš„å‘¢ï¼Ÿç°å®ä¸–ç•Œé‡Œå¤§å ‚ç»ç†è¿™ä¸ªè§’è‰²å¾ˆé‡è¦ï¼Œæˆ‘ä»¬æ˜¯å¦ç­‰å¾…ï¼Œå®Œå…¨æ˜¯ç”±ä»–æ¥åè°ƒçš„ã€‚é€šè¿‡ç±»æ¯”ï¼Œç›¸ä¿¡ä½ ä¹Ÿä¸€å®šæœ‰æ€è·¯äº†ï¼šæˆ‘ä»¬çš„ç¨‹åºé‡Œï¼Œä¹Ÿéœ€è¦è¿™æ ·ä¸€ä¸ªå¤§å ‚ç»ç†ã€‚çš„ç¡®æ˜¯è¿™æ ·ï¼Œé‚£ç¨‹åºä¸–ç•Œé‡Œçš„å¤§å ‚ç»ç†è¯¥å¦‚ä½•è®¾è®¡å‘¢ï¼Ÿå…¶å®è®¾è®¡æ–¹æ¡ˆå‰äººæ—©å°±æå®šäº†ï¼Œè€Œä¸”è¿˜å°†å…¶æ€»ç»“æˆäº†ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼š<strong>Guarded Suspension</strong>ã€‚æ‰€è°“Guarded Suspensionï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯â€œä¿æŠ¤æ€§åœ°æš‚åœâ€ã€‚é‚£ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼ŒGuarded Suspensionæ¨¡å¼æ˜¯å¦‚ä½•æ¨¡æ‹Ÿå¤§å ‚ç»ç†è¿›è¡Œä¿æŠ¤æ€§åœ°æš‚åœçš„ã€‚</p><p>ä¸‹å›¾å°±æ˜¯Guarded Suspensionæ¨¡å¼çš„ç»“æ„å›¾ï¼Œéå¸¸ç®€å•ï¼Œä¸€ä¸ªå¯¹è±¡GuardedObjectï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡â€”â€”å—ä¿æŠ¤çš„å¯¹è±¡ï¼Œä»¥åŠä¸¤ä¸ªæˆå‘˜æ–¹æ³•â€”â€”<code>get(Predicate&lt;T&gt; p)</code>å’Œ<code>onChanged(T obj)</code>æ–¹æ³•ã€‚å…¶ä¸­ï¼Œå¯¹è±¡GuardedObjectå°±æ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„å¤§å ‚ç»ç†ï¼Œå—ä¿æŠ¤å¯¹è±¡å°±æ˜¯é¤å…é‡Œé¢çš„åŒ…é—´ï¼›å—ä¿æŠ¤å¯¹è±¡çš„get()æ–¹æ³•å¯¹åº”çš„æ˜¯æˆ‘ä»¬çš„å°±é¤ï¼Œå°±é¤çš„å‰ææ¡ä»¶æ˜¯åŒ…é—´å·²ç»æ”¶æ‹¾å¥½äº†ï¼Œå‚æ•°på°±æ˜¯ç”¨æ¥æè¿°è¿™ä¸ªå‰ææ¡ä»¶çš„ï¼›å—ä¿æŠ¤å¯¹è±¡çš„onChanged()æ–¹æ³•å¯¹åº”çš„æ˜¯æœåŠ¡å‘˜æŠŠåŒ…é—´æ”¶æ‹¾å¥½äº†ï¼Œé€šè¿‡onChanged()æ–¹æ³•å¯ä»¥fireä¸€ä¸ªäº‹ä»¶ï¼Œè€Œè¿™ä¸ªäº‹ä»¶å¾€å¾€èƒ½æ”¹å˜å‰ææ¡ä»¶pçš„è®¡ç®—ç»“æœã€‚ä¸‹å›¾ä¸­ï¼Œå·¦ä¾§çš„ç»¿è‰²çº¿ç¨‹å°±æ˜¯éœ€è¦å°±é¤çš„é¡¾å®¢ï¼Œè€Œå³ä¾§çš„è“è‰²çº¿ç¨‹å°±æ˜¯æ”¶æ‹¾åŒ…é—´çš„æœåŠ¡å‘˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/63/dc/630f3eda98a0e6a436953153c68464dc.png?wh=1142*503\" alt=\"\"></p><center><span class=\"reference\">Guarded Suspensionæ¨¡å¼ç»“æ„å›¾</span></center><p>GuardedObjectçš„å†…éƒ¨å®ç°éå¸¸ç®€å•ï¼Œæ˜¯ç®¡ç¨‹çš„ä¸€ä¸ªç»å…¸ç”¨æ³•ï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œæ ¸å¿ƒæ˜¯ï¼šget()æ–¹æ³•é€šè¿‡æ¡ä»¶å˜é‡çš„await()æ–¹æ³•å®ç°ç­‰å¾…ï¼ŒonChanged()æ–¹æ³•é€šè¿‡æ¡ä»¶å˜é‡çš„signalAll()æ–¹æ³•å®ç°å”¤é†’åŠŸèƒ½ã€‚é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å†è¯¦ç»†ä»‹ç»äº†ã€‚</p><pre><code>class GuardedObject&lt;T&gt;{\n  //å—ä¿æŠ¤çš„å¯¹è±¡\n  T obj;\n  final Lock lock = \n    new ReentrantLock();\n  final Condition done =\n    lock.newCondition();\n  final int timeout=1;\n  //è·å–å—ä¿æŠ¤å¯¹è±¡  \n  T get(Predicate&lt;T&gt; p) {\n    lock.lock();\n    try {\n      //MESAç®¡ç¨‹æ¨èå†™æ³•\n      while(!p.test(obj)){\n        done.await(timeout, \n          TimeUnit.SECONDS);\n      }\n    }catch(InterruptedException e){\n      throw new RuntimeException(e);\n    }finally{\n      lock.unlock();\n    }\n    //è¿”å›éç©ºçš„å—ä¿æŠ¤å¯¹è±¡\n    return obj;\n  }\n  //äº‹ä»¶é€šçŸ¥æ–¹æ³•\n  void onChanged(T obj) {\n    lock.lock();\n    try {\n      this.obj = obj;\n      done.signalAll();\n    } finally {\n      lock.unlock();\n    }\n  }\n}\n</code></pre><h2>æ‰©å±•Guarded Suspensionæ¨¡å¼</h2><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†Guarded Suspensionæ¨¡å¼åŠå…¶å®ç°ï¼Œè¿™ä¸ªæ¨¡å¼èƒ½å¤Ÿæ¨¡æ‹Ÿç°å®ä¸–ç•Œé‡Œå¤§å ‚ç»ç†çš„è§’è‰²ï¼Œé‚£ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹è¿™ä¸ªâ€œå¤§å ‚ç»ç†â€èƒ½å¦è§£å†³å°ç°åŒå­¦é‡åˆ°çš„é—®é¢˜ã€‚</p><p>Guarded Suspensionæ¨¡å¼é‡ŒGuardedObjectæœ‰ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯get()æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯onChanged()æ–¹æ³•ã€‚å¾ˆæ˜¾ç„¶ï¼Œåœ¨å¤„ç†Webè¯·æ±‚çš„æ–¹æ³•handleWebReq()ä¸­ï¼Œå¯ä»¥è°ƒç”¨GuardedObjectçš„get()æ–¹æ³•æ¥å®ç°ç­‰å¾…ï¼›åœ¨MQæ¶ˆæ¯çš„æ¶ˆè´¹æ–¹æ³•onMessage()ä¸­ï¼Œå¯ä»¥è°ƒç”¨GuardedObjectçš„onChanged()æ–¹æ³•æ¥å®ç°å”¤é†’ã€‚</p><pre><code>//å¤„ç†æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚\nRespond handleWebReq(){\n  //åˆ›å»ºä¸€æ¶ˆæ¯\n  Message msg1 = new \n    Message(&quot;1&quot;,&quot;{...}&quot;);\n  //å‘é€æ¶ˆæ¯\n  send(msg1);\n  //åˆ©ç”¨GuardedObjectå®ç°ç­‰å¾…\n  GuardedObject&lt;Message&gt; go\n    =new GuardObjec&lt;&gt;();\n  Message r = go.get(\n    t-&gt;t != null);\n}\nvoid onMessage(Message msg){\n  //å¦‚ä½•æ‰¾åˆ°åŒ¹é…çš„goï¼Ÿ\n  GuardedObject&lt;Message&gt; go=???\n  go.onChanged(msg);\n}\n</code></pre><p>ä½†æ˜¯åœ¨å®ç°çš„æ—¶å€™ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒhandleWebReq()é‡Œé¢åˆ›å»ºäº†GuardedObjectå¯¹è±¡çš„å®ä¾‹goï¼Œå¹¶è°ƒç”¨å…¶get()æ–¹ç­‰å¾…ç»“æœï¼Œé‚£åœ¨onMessage()æ–¹æ³•ä¸­ï¼Œå¦‚ä½•æ‰èƒ½å¤Ÿæ‰¾åˆ°åŒ¹é…çš„GuardedObjectå¯¹è±¡å‘¢ï¼Ÿè¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼æœåŠ¡å‘˜å‘Šè¯‰å¤§å ‚ç»ç†æŸæŸåŒ…é—´å·²ç»æ”¶æ‹¾å¥½äº†ï¼Œå¤§å ‚ç»ç†å¦‚ä½•æ ¹æ®åŒ…é—´æ‰¾åˆ°å°±é¤çš„äººã€‚ç°å®ä¸–ç•Œé‡Œï¼Œå¤§å ‚ç»ç†çš„å¤´è„‘ä¸­ï¼Œæœ‰åŒ…é—´å’Œå°±é¤äººä¹‹é—´çš„å…³ç³»å›¾ï¼Œæ‰€ä»¥æœåŠ¡å‘˜è¯´å®Œä¹‹åå¤§å ‚ç»ç†ç«‹åˆ»å°±èƒ½æŠŠå°±é¤äººæ‰¾å‡ºæ¥ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å‚è€ƒå¤§å ‚ç»ç†è¯†åˆ«å°±é¤äººçš„åŠæ³•ï¼Œæ¥æ‰©å±•ä¸€ä¸‹Guarded Suspensionæ¨¡å¼ï¼Œä»è€Œä½¿å®ƒèƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°è§£å†³å°ç°åŒå­¦çš„é—®é¢˜ã€‚åœ¨å°ç°çš„ç¨‹åºä¸­ï¼Œæ¯ä¸ªå‘é€åˆ°MQçš„æ¶ˆæ¯ï¼Œéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ€§çš„å±æ€§idï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªMQæ¶ˆæ¯idå’ŒGuardedObjectå¯¹è±¡å®ä¾‹çš„å…³ç³»ï¼Œè¿™ä¸ªå…³ç³»å¯ä»¥ç±»æ¯”å¤§å ‚ç»ç†å¤§è„‘é‡Œç»´æŠ¤çš„åŒ…é—´å’Œå°±é¤äººçš„å…³ç³»ã€‚</p><p>æœ‰äº†è¿™ä¸ªå…³ç³»ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“å¦‚ä½•å®ç°ã€‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ˜¯æ‰©å±•Guarded Suspensionæ¨¡å¼çš„å®ç°ï¼Œæ‰©å±•åçš„GuardedObjectå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªMapï¼Œå…¶Keyæ˜¯MQæ¶ˆæ¯idï¼Œè€ŒValueæ˜¯GuardedObjectå¯¹è±¡å®ä¾‹ï¼ŒåŒæ—¶å¢åŠ äº†é™æ€æ–¹æ³•create()å’ŒfireEvent()ï¼›create()æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªGuardedObjectå¯¹è±¡å®ä¾‹ï¼Œå¹¶æ ¹æ®keyå€¼å°†å…¶åŠ å…¥åˆ°Mapä¸­ï¼Œè€ŒfireEvent()æ–¹æ³•åˆ™æ˜¯æ¨¡æ‹Ÿçš„å¤§å ‚ç»ç†æ ¹æ®åŒ…é—´æ‰¾å°±é¤äººçš„é€»è¾‘ã€‚</p><pre><code>class GuardedObject&lt;T&gt;{\n  //å—ä¿æŠ¤çš„å¯¹è±¡\n  T obj;\n  final Lock lock = \n    new ReentrantLock();\n  final Condition done =\n    lock.newCondition();\n  final int timeout=2;\n  //ä¿å­˜æ‰€æœ‰GuardedObject\n  final static Map&lt;Object, GuardedObject&gt; \n  gos=new ConcurrentHashMap&lt;&gt;();\n  //é™æ€æ–¹æ³•åˆ›å»ºGuardedObject\n  static &lt;K&gt; GuardedObject \n      create(K key){\n    GuardedObject go=new GuardedObject();\n    gos.put(key, go);\n    return go;\n  }\n  static &lt;K, T&gt; void \n      fireEvent(K key, T obj){\n    GuardedObject go=gos.remove(key);\n    if (go != null){\n      go.onChanged(obj);\n    }\n  }\n  //è·å–å—ä¿æŠ¤å¯¹è±¡  \n  T get(Predicate&lt;T&gt; p) {\n    lock.lock();\n    try {\n      //MESAç®¡ç¨‹æ¨èå†™æ³•\n      while(!p.test(obj)){\n        done.await(timeout, \n          TimeUnit.SECONDS);\n      }\n    }catch(InterruptedException e){\n      throw new RuntimeException(e);\n    }finally{\n      lock.unlock();\n    }\n    //è¿”å›éç©ºçš„å—ä¿æŠ¤å¯¹è±¡\n    return obj;\n  }\n  //äº‹ä»¶é€šçŸ¥æ–¹æ³•\n  void onChanged(T obj) {\n    lock.lock();\n    try {\n      this.obj = obj;\n      done.signalAll();\n    } finally {\n      lock.unlock();\n    }\n  }\n}\n</code></pre><p>è¿™æ ·åˆ©ç”¨æ‰©å±•åçš„GuardedObjectæ¥è§£å†³å°ç°åŒå­¦çš„é—®é¢˜å°±å¾ˆç®€å•äº†ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code>//å¤„ç†æµè§ˆå™¨å‘æ¥çš„è¯·æ±‚\nRespond handleWebReq(){\n  int id=åºå·ç”Ÿæˆå™¨.get();\n  //åˆ›å»ºä¸€æ¶ˆæ¯\n  Message msg1 = new \n    Message(id,&quot;{...}&quot;);\n  //åˆ›å»ºGuardedObjectå®ä¾‹\n  GuardedObject&lt;Message&gt; go=\n    GuardedObject.create(id);  \n  //å‘é€æ¶ˆæ¯\n  send(msg1);\n  //ç­‰å¾…MQæ¶ˆæ¯\n  Message r = go.get(\n    t-&gt;t != null);  \n}\nvoid onMessage(Message msg){\n  //å”¤é†’ç­‰å¾…çš„çº¿ç¨‹\n  GuardedObject.fireEvent(\n    msg.id, msg);\n}\n</code></pre><h2>æ€»ç»“</h2><p>Guarded Suspensionæ¨¡å¼æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç­‰å¾…å”¤é†’æœºåˆ¶çš„å®ç°ï¼Œåªä¸è¿‡Guarded Suspensionæ¨¡å¼å°†å…¶è§„èŒƒåŒ–äº†ã€‚è§„èŒƒåŒ–çš„å¥½å¤„æ˜¯ä½ æ— éœ€é‡å¤´æ€è€ƒå¦‚ä½•å®ç°ï¼Œä¹Ÿæ— éœ€æ‹…å¿ƒå®ç°ç¨‹åºçš„å¯ç†è§£æ€§é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿèƒ½é¿å…ä¸€ä¸å°å¿ƒå†™å‡ºä¸ªBugæ¥ã€‚ä½†Guarded Suspensionæ¨¡å¼åœ¨è§£å†³å®é™…é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€è¿˜æ˜¯éœ€è¦æ‰©å±•çš„ï¼Œæ‰©å±•çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæœ¬ç¯‡æ–‡ç« å°±ç›´æ¥å¯¹GuardedObjectçš„åŠŸèƒ½è¿›è¡Œäº†å¢å¼ºï¼ŒDubboä¸­DefaultFutureè¿™ä¸ªç±»ä¹Ÿæ˜¯é‡‡ç”¨çš„è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¯¹æ¯”ç€æ¥çœ‹ï¼Œç›¸ä¿¡å¯¹DefaultFutureçš„å®ç°åŸç†ä¼šç†è§£å¾—æ›´é€å½»ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºæ–°çš„ç±»æ¥å®ç°å¯¹Guarded Suspensionæ¨¡å¼çš„æ‰©å±•ã€‚</p><p>Guarded Suspensionæ¨¡å¼ä¹Ÿå¸¸è¢«ç§°ä½œGuarded Waitæ¨¡å¼ã€Spin Lockæ¨¡å¼ï¼ˆå› ä¸ºä½¿ç”¨äº†whileå¾ªç¯å»ç­‰å¾…ï¼‰ï¼Œè¿™äº›åå­—éƒ½å¾ˆå½¢è±¡ï¼Œä¸è¿‡å®ƒè¿˜æœ‰ä¸€ä¸ªæ›´å½¢è±¡çš„éå®˜æ–¹åå­—ï¼šå¤šçº¿ç¨‹ç‰ˆæœ¬çš„ifã€‚å•çº¿ç¨‹åœºæ™¯ä¸­ï¼Œifè¯­å¥æ˜¯ä¸éœ€è¦ç­‰å¾…çš„ï¼Œå› ä¸ºåœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„æ¡ä»¶ä¸‹ï¼Œå¦‚æœè¿™ä¸ªçº¿ç¨‹è¢«é˜»å¡ï¼Œé‚£å°±æ²¡æœ‰å…¶ä»–æ´»åŠ¨çº¿ç¨‹äº†ï¼Œè¿™æ„å‘³ç€ifåˆ¤æ–­æ¡ä»¶çš„ç»“æœä¹Ÿä¸ä¼šå‘ç”Ÿå˜åŒ–äº†ã€‚ä½†æ˜¯å¤šçº¿ç¨‹åœºæ™¯ä¸­ï¼Œç­‰å¾…å°±å˜å¾—æœ‰æ„ä¹‰äº†ï¼Œè¿™ç§åœºæ™¯ä¸‹ï¼Œifåˆ¤æ–­æ¡ä»¶çš„ç»“æœæ˜¯å¯èƒ½å‘ç”Ÿå˜åŒ–çš„ã€‚æ‰€ä»¥ï¼Œç”¨â€œå¤šçº¿ç¨‹ç‰ˆæœ¬çš„ifâ€æ¥ç†è§£è¿™ä¸ªæ¨¡å¼ä¼šæ›´ç®€å•ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>æœ‰åŒå­¦è§‰å¾—ç”¨done.await()è¿˜è¦åŠ é”ï¼Œå¤ªå•°å—¦ï¼Œè¿˜ä¸å¦‚ç›´æ¥ä½¿ç”¨sleep()æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä»–çš„å®ç°ï¼Œä½ è§‰å¾—ä»–çš„å†™æ³•æ­£ç¡®å—ï¼Ÿ</p><pre><code>//è·å–å—ä¿æŠ¤å¯¹è±¡  \nT get(Predicate&lt;T&gt; p) {\n  try {\n    while(!p.test(obj)){\n      TimeUnit.SECONDS\n        .sleep(timeout);\n    }\n  }catch(InterruptedException e){\n    throw new RuntimeException(e);\n  }\n  //è¿”å›éç©ºçš„å—ä¿æŠ¤å¯¹è±¡\n  return obj;\n}\n//äº‹ä»¶é€šçŸ¥æ–¹æ³•\nvoid onChanged(T obj) {\n  this.obj = obj;\n}\n</code></pre><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p></p>","comments":[{"had_liked":false,"id":92883,"user_name":"é’è²","can_delete":false,"product_type":"c1","uid":1181787,"ip_address":"","ucode":"6BA5D5D47DE38E","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/5b/2a342424.jpg","comment_is_top":false,"comment_ctime":1557361840,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"362334614704","product_id":100023901,"comment_content":"sleep æ— æ³•è¢«å”¤é†’ï¼Œåªèƒ½æ—¶é—´åˆ°åè‡ªå·±æ¢å¤è¿è¡Œï¼Œå½“çœŸæ­£çš„æ¡ä»¶æ»¡è¶³äº†ï¼Œæ—¶é—´æœªåˆ°ï¼Œæ¥ç€ç¡çœ ï¼Œæ— æ€§èƒ½å¯è¨€","like_count":85},{"had_liked":false,"id":92949,"user_name":"ä¸€é“é˜³å…‰","can_delete":false,"product_type":"c1","uid":1239557,"ip_address":"","ucode":"F35207CCCEC6E2","user_header":"https://static001.geekbang.org/account/avatar/00/12/ea/05/c0d8014d.jpg","comment_is_top":false,"comment_ctime":1557367293,"is_pvip":false,"replies":[{"id":"33212","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557412342,"ip_address":"","comment_id":92949,"utype":1}],"discussion_count":9,"race_medal":0,"score":"259255405053","product_id":100023901,"comment_content":"å½“ä»æ¶ˆæ¯é˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯å¤±è´¥æ—¶ï¼Œwhileå¾ªç¯ä¼šä¸€ç›´æ‰§è¡Œä¸‹å»ï¼Œæ°¸è¿œä¸ä¼šç»“æŸï¼Œå›å ç”¨å¤§é‡èµ„æºã€‚","like_count":59,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449435,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557412342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1512642,"avatar":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","nickname":"ä¾§è€³å€¾å¬","note":"","ucode":"5BF2A2440B54F0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":243436,"discussion_content":"waitå’Œsleepä¸éƒ½æ˜¯ä¸€ç›´å¾ªç¯ä¸‹å»å—ï¼Ÿwaitè®©å‡ºé”ï¼Œsleepæ²¡åŠ é”ä¹Ÿä¸ä¼šå é”ï¼Œä»–ä¿©æœ‰å•¥åŒºåˆ«ï¼Ÿé—®é¢˜åœ¨äºå†™è¿™è¡Œä»£ç ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸è¿”å›ä¼šæ­»å¾ªç¯ï¼Œè·Ÿç”¨ä¸ç”¨sleepæœ‰å…³ç³»å—ï¼Ÿçº¿ç¨‹ä¸€ç›´å¾—ä¸åˆ°é‡Šæ”¾ï¼Œå¯¹è±¡ä¸èƒ½è¢«å›æ”¶ï¼Œéšç€æ—¶é—´çš„è¿ç§»ï¼Œçº¿ç¨‹è¶Šæ¥è¶Šå¤šï¼Œä¸€ä¸ªé—®é¢˜æ˜¯æ ˆæº¢å‡ºï¼Œå¦ä¸€ä¸ªé—®é¢˜æ˜¯ç³»ç»Ÿæ— æ³•è®¿é—®ï¼Œç¬¬ä¸‰ä¸ªé—®é¢˜cpuä½¿ç”¨ç‡å‡é«˜","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1587540614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1045090,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f2/62/f873cd8f.jpg","nickname":"tongmin_tsai","note":"","ucode":"D9423E770D5846","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1512642,"avatar":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","nickname":"ä¾§è€³å€¾å¬","note":"","ucode":"5BF2A2440B54F0","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":299752,"discussion_content":"æˆ‘ä¹Ÿæœ‰åŒæ ·çš„ç–‘é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597806975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":243436,"ip_address":""},"score":299752,"extra":""},{"author":{"id":1441895,"avatar":"https://static001.geekbang.org/account/avatar/00/16/00/67/e24dd940.jpg","nickname":"é‚£æœˆçœŸç¾","note":"","ucode":"CEF1AF65C6064E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1512642,"avatar":"https://static001.geekbang.org/account/avatar/00/17/14/c2/46ebe3a0.jpg","nickname":"ä¾§è€³å€¾å¬","note":"","ucode":"5BF2A2440B54F0","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":302502,"discussion_content":"waitæ˜¯ä¸ä¼šæ¶ˆè€—çº¿ç¨‹èµ„æºçš„ï¼Œsleepä¼š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598936526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":243436,"ip_address":""},"score":302502,"extra":""}]},{"author":{"id":1174199,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ea/b7/1a18a39d.jpg","nickname":"5-åˆ˜æ–°æ³¢(Arvin)","note":"","ucode":"DBD135D2587A93","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":220200,"discussion_content":"å¯ä»¥åœ¨ç­‰å¾…è®¾ç½®è®¡æ•°ï¼Œé¿å…æ­»å¾ªç¯","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585840300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1128491,"avatar":"https://static001.geekbang.org/account/avatar/00/11/38/2b/9db9406b.jpg","nickname":"æ˜Ÿå¤œ","note":"","ucode":"3B46C09D994CEB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342546,"discussion_content":"sleepä¼šå ç”¨çº¿ç¨‹è€Œwaitä¸ä¼šå ç”¨çº¿ç¨‹ï¼Œä»–ä»¬ä¸¤ä¸ªéƒ½ä¸ä¼šæ¶ˆè€—CPU","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610710875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2070984,"avatar":"","nickname":"dominiczhu","note":"","ucode":"9C87F77CCE06C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386140,"discussion_content":"é‚£ä½¿ç”¨waitå°±ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µä¹ˆï¼Œå‡å¦‚ä»»åŠ¡å¤±è´¥äº†ï¼Œç®¡ç¨‹å®ç°æ–¹æ¡ˆä¸ä¹Ÿä¼šä¸€ç›´æŒ‚ç€ä¹ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627439396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1241064,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ef/e8/076a6f59.jpg","nickname":"å¼ ç¿€","note":"","ucode":"835A01424FDD5E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115950,"discussion_content":"ä»€ä¹ˆæ„æ€ï¼Œè¯·æ•™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578047743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1241064,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ef/e8/076a6f59.jpg","nickname":"å¼ ç¿€","note":"","ucode":"835A01424FDD5E","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":162869,"discussion_content":"onMessageæ–¹æ³•ä¸€ç›´ä¸ä¼šè¢«è°ƒç”¨(å³æ¥æ”¶æ¶ˆæ¯å¤±è´¥),æ­¤æ—¶whileå¾ªç¯çš„æ¡ä»¶ä¸€ç›´ä¸æ»¡è¶³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581029817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":115950,"ip_address":""},"score":162869,"extra":""}]}]},{"had_liked":false,"id":93854,"user_name":"Felix Envy","can_delete":false,"product_type":"c1","uid":1200085,"ip_address":"","ucode":"24E0F2165AD108","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/d5/e23dc965.jpg","comment_is_top":false,"comment_ctime":1557637710,"is_pvip":false,"replies":[{"id":"33668","content":"ğŸ‘ éœ€è¦ï¼Œç­‰å¾…è¶…æ—¶åè¦æŠŠä»–ç§»é™¤ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557757453,"ip_address":"","comment_id":93854,"utype":1}],"discussion_count":2,"race_medal":0,"score":"194831166030","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ„Ÿè§‰å¦‚æœæœ‰æ–¹æ³•è°ƒç”¨äº†GuardedObect.createæ–¹æ³•ä½†æ˜¯æ²¡æœ‰ä»»ä½•å…¶ä»–çº¿ç¨‹è°ƒç”¨fireEventæ–¹æ³•ä¼šé€ æˆå†…å­˜æ³„æ¼å•Šï¼Œè¿™ç§æƒ…å†µéœ€è¦è€ƒè™‘å—ï¼Ÿ","like_count":45,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449797,"discussion_content":"ğŸ‘ éœ€è¦ï¼Œç­‰å¾…è¶…æ—¶åè¦æŠŠä»–ç§»é™¤ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557757453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1172759,"avatar":"https://static001.geekbang.org/account/avatar/00/11/e5/17/084dc246.jpg","nickname":"NLand","note":"","ucode":"07F7AE58EC68C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":556923,"discussion_content":"é‚£ç§»é™¤ä»¥åæ˜¯å¦ä¹Ÿå¾—è·³å‡ºwhileå¾ªç¯äº†ï¼Œæ¯•ç«Ÿguardobjectå¯¹è±¡éƒ½æ²¡äº†ï¼Ÿè€Œä¸”è¿™ä¸ªç§»é™¤åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ˜¯ï¼šobj==null&amp;&amp;å·²è¶…æ—¶ ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647573225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":449797,"ip_address":""},"score":556923,"extra":""}]}]},{"had_liked":false,"id":95805,"user_name":"zhangwei","can_delete":false,"product_type":"c1","uid":1246639,"ip_address":"","ucode":"B71CBA5311846F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIvrwfqAuRkaK8Pl2apHKFZxd5mjnFhROMNcg5qXUT4AxE2ZTTia5Hg6pmFM1vozq3vZiagJoaJ4Pyg/132","comment_is_top":false,"comment_ctime":1558182141,"is_pvip":false,"replies":[{"id":"34272","content":"æˆ‘äº†è§£æœ‰äººæ˜¯è¿™ä¹ˆåšçš„ï¼šæŠŠå›æ‰§æ¶ˆæ¯æ”¾åˆ°redisçš„listä¸­ï¼ŒæŒ‰ç…§ipé‡æ–°åˆ†ç»„ä¹‹åä»redisä¸­å†æ¬¡æ¶ˆè´¹ã€‚<br>ä¹Ÿå¯ä»¥æŒ‰ç…§ipå»ºç«‹ä¸åŒçš„topicã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558185138,"ip_address":"","comment_id":95805,"utype":1}],"discussion_count":14,"race_medal":0,"score":"169061906685","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªç–‘é—®ï¼Œå¸Œæœ›å¸®å¿™è§£ç­”ã€‚å¦‚æœWebåº”ç”¨æ˜¯é›†ç¾¤çš„ï¼ŒAèŠ‚ç‚¹å¤„ç†HTTPè¯·æ±‚åå‘äº†MQï¼ŒBèŠ‚ç‚¹çš„onMessageæ¶ˆè´¹äº†å›æ‰§æ¶ˆæ¯ï¼Œé‚£ä¹ˆAèŠ‚ç‚¹æ€ä¹ˆæŠŠç»“æœå“åº”ç»™å®¢æˆ·ç«¯å‘¢ï¼Ÿç–‘é—®å¥½ä¹…äº†ï¼Œå¸Œæœ›è€å¸ˆç»™ä¸ªæ€è·¯ï¼Œè°¢è°¢ï¼","like_count":40,"discussions":[{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":162891,"discussion_content":"ä»–è¯´çš„æ„æ€æ˜¯,ABä¸¤ä¸ªèŠ‚ç‚¹æ˜¯é›†ç¾¤,Aæ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚å,å‘é€æ¶ˆæ¯åˆ°mq,æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯,é›†ç¾¤ä¸­æ¥æ”¶åˆ°å›å¤æ¶ˆæ¯çš„ä¸ºèŠ‚ç‚¹Bä¸æ˜¯é›†ç¾¤ä¸­å‘é€æ¶ˆæ¯çš„èŠ‚ç‚¹A;ç›¸å½“äºå†…å­˜ç»´æŠ¤åœ¨Aä¸­ä¸åœ¨Bä¸­,æ­¤æ—¶å°±éœ€è¦Aå’ŒBçš„å†…å­˜æ•°æ®å…±äº«æ¯”å¦‚redisæˆ–è€…mq","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1581035393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339166,"discussion_content":"rediså†…å­˜æ–¹æ¡ˆå’‹è§£å†³  çœ‹ä¸æ‡‚äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609533394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":162891,"ip_address":""},"score":339166,"extra":""},{"author":{"id":1261360,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3f/30/23f6b413.jpg","nickname":"äº”åä¹ç§’","note":"","ucode":"1F34F62193CFF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368809,"discussion_content":"ä½¿ç”¨redisæ¶ˆæ¯å¤„ç†å®Œæˆåï¼Œæ ¹æ®æœºå™¨ipæŠŠç›¸åº”çš„æœºå™¨çš„æ¶ˆæ¯æ”¾åˆ°è¿™ä¸ªipä¸‹ï¼Œæ¯å°æœºå™¨æ¶ˆè´¹æ—¶ä»redisä¸­å–å±äºè‡ªå·±çš„æ¶ˆæ¯ï¼Œæˆ–è€…ä¸åŒçš„æœºå™¨å»ºç«‹ä¸åŒçš„topicã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618837443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":339166,"ip_address":""},"score":368809,"extra":""},{"author":{"id":1367043,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dc/03/ad9574b3.jpg","nickname":"ä¹ å…®ä¹ å…®","note":"","ucode":"E616E924188CBA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380487,"discussion_content":"å°±æ˜¯é€šè¿‡åŒå‘MQ, æˆ–è€…é›†ç¾¤å…±äº«ç¼“å­˜çš„æ–¹æ³•, é€šè¿‡ä¸€å®šçš„æŸ“è‰²ç¡®å®šæ¥æ”¶å’Œå“åº”backendä¸ºåŒä¸€èŠ‚ç‚¹; ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624525229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":339166,"ip_address":""},"score":380487,"extra":""}]},{"author":{"id":1400703,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/7f/3d005d61.jpg","nickname":"Tyrone","note":"","ucode":"DA6F289438A750","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219689,"discussion_content":"è¿™å°±æ˜¯æœ¬åœ°ç¼“å­˜ä¸åˆ†å¸ƒå¼ç¼“å­˜çš„ä¸åŒåœºæ™¯ä½¿ç”¨å‘—ã€‚ä½ å•æœºç”¨æœ¬åœ°ç¼“å­˜å°±æ»¡è¶³äº†ï¼Œé›†ç¾¤ç¯å¢ƒä¸‹ä½ å°±ç”¨åˆ†å¸ƒå¼ç¼“å­˜å‘—æ¯”å¦‚redis...è¿™å°±å¥½æ¯”ç™»å½•ã€‚éš¾é“è¯´ä½ åœ¨AèŠ‚ç‚¹ç™»å½•äº†ï¼Œåœ¨BèŠ‚ç‚¹ä¸Šå†é‡æ–°ç™»å½•ä¸€æ¬¡ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585795800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450604,"discussion_content":"æˆ‘äº†è§£æœ‰äººæ˜¯è¿™ä¹ˆåšçš„ï¼šæŠŠå›æ‰§æ¶ˆæ¯æ”¾åˆ°redisçš„listä¸­ï¼ŒæŒ‰ç…§ipé‡æ–°åˆ†ç»„ä¹‹åä»redisä¸­å†æ¬¡æ¶ˆè´¹ã€‚\nä¹Ÿå¯ä»¥æŒ‰ç…§ipå»ºç«‹ä¸åŒçš„topicã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1558185138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1246639,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIvrwfqAuRkaK8Pl2apHKFZxd5mjnFhROMNcg5qXUT4AxE2ZTTia5Hg6pmFM1vozq3vZiagJoaJ4Pyg/132","nickname":"zhangwei","note":"","ucode":"B71CBA5311846F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311837,"discussion_content":"æœ€è¿‘ç”¨rocketmqå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¶ˆè´¹æ¨¡å¼é€‰æ‹©BRODCASTINGï¼ŒConsumerGroupçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æ¶ˆè´¹ã€‚å‰¯ä½œç”¨æ˜¯åªæœ‰ä¸€ä¸ªæ¶ˆè´¹èŠ‚ç‚¹æœ‰æ•ˆï¼Œå…¶ä»–èŠ‚ç‚¹éƒ½ç©ºè·‘äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602499544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1246639,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEIvrwfqAuRkaK8Pl2apHKFZxd5mjnFhROMNcg5qXUT4AxE2ZTTia5Hg6pmFM1vozq3vZiagJoaJ4Pyg/132","nickname":"zhangwei","note":"","ucode":"B71CBA5311846F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339164,"discussion_content":"æˆ‘çœ‹æ‡‚äº†ä½ çš„æ–¹æ³•   ä½†ä½œè€…çš„æ–¹æ³•æ²¡çœ‹æ‡‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609533156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":311837,"ip_address":""},"score":339164,"extra":""}]},{"author":{"id":1400703,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/7f/3d005d61.jpg","nickname":"Tyrone","note":"","ucode":"DA6F289438A750","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219695,"discussion_content":"æ„Ÿè§‰åªè¦å®ç°ä¸€ä¸ªåƒnginxçš„å®šå‘è½¬å‘çš„å°±è¡Œã€‚æˆ–è€…ç›´æ¥å°±æ˜¯å¹¿æ’­ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½æ”¶çš„åˆ°ã€‚ä½†æ˜¯ç»™æ¯ä¸ªèŠ‚ç‚¹å–ä¸ªåï¼Œåªæœ‰æŸä¸ªèŠ‚ç‚¹å‘çš„ã€‚å°±åªèƒ½æŸä¸ªèŠ‚ç‚¹æ¶ˆè´¹ã€‚æ„Ÿè§‰å°±å¯ä»¥äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585796276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1810156,"avatar":"","nickname":"poordickey","note":"","ucode":"2A436EC813AF97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1400703,"avatar":"https://static001.geekbang.org/account/avatar/00/15/5f/7f/3d005d61.jpg","nickname":"Tyrone","note":"","ucode":"DA6F289438A750","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339165,"discussion_content":"msgé‡ŒæŠŠhostä¿¡æ¯åŠ ä¸Š  å¹¿æ’­æ¨¡å¼å¾ˆå¿«å°±èƒ½è¿‡æ»¤æ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609533288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":219695,"ip_address":""},"score":339165,"extra":""}]},{"author":{"id":1528931,"avatar":"https://static001.geekbang.org/account/avatar/00/17/54/63/3a3f7d4c.jpg","nickname":"Giraffe","note":"","ucode":"2F272FFD6CD0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553107,"discussion_content":"ä¸ºä»€ä¹ˆè¦ç”¨MQï¼ŒåŒæ­¥è°ƒç”¨ç”¨RPCä¸å¥½å—ï¼ŒMQæ›´é€‚åˆå¼‚æ­¥çš„åœºæ™¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645714689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2143675,"avatar":"","nickname":"Geek_9101a0","note":"","ucode":"55DED90E052AB2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302054,"discussion_content":"è¿™ä¸æ˜¯é›†ç¾¤å§ï¼Œé¡¶å¤šæ˜¯ä¸ªè´Ÿè½½å‡è¡¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598774497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1234281,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d5/69/d1f2f7c8.jpg","nickname":"ç½—æ´ªå· IT","note":"","ucode":"3688313E7D010A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2298,"discussion_content":"AèŠ‚ç‚¹è¯·æ±‚MQåº”è¯¥ä¸ä¼šå“åº”åˆ°BèŠ‚ç‚¹ï¼Œç”¨ä»€ä¹ˆåšçš„é›†ç¾¤ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563441608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93272,"user_name":"Mr.Brooks","can_delete":false,"product_type":"c1","uid":1118650,"ip_address":"","ucode":"D47A6B0236A79F","user_header":"https://static001.geekbang.org/account/avatar/00/11/11/ba/2175bc50.jpg","comment_is_top":false,"comment_ctime":1557449026,"is_pvip":true,"replies":[{"id":"33677","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557758075,"ip_address":"","comment_id":93272,"utype":1}],"discussion_count":2,"race_medal":0,"score":"108931631426","product_id":100023901,"comment_content":"æ²¡æœ‰é”ä¹Ÿæ— æ³•ä¿è¯å†…å­˜å¯è§æ€§å§","like_count":25,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449554,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557758075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1199213,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","nickname":"LJK","note":"","ucode":"12B2441099FF1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332425,"discussion_content":"è¿™é‡Œç”¨çš„æ˜¯å¯é‡å…¥é”ï¼Œç”¨æ™®é€šé”ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607207709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":97812,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1558782810,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"65983292250","product_id":100023901,"comment_content":"æ€»ç»“ï¼šGuarded Suspensionæ¨¡å¼ï¼Œè¦è§£å†³çš„æ˜¯ï¼Œå‘é€æ¶ˆæ¯çš„çº¿ç¨‹å’Œæ¶ˆè´¹æ¶ˆæ¯ç»“æœçš„çº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªï¼Œä½†æ˜¯æ¶ˆæ¯ç»“æœåˆéœ€è¦ç”±å‘é€çš„çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œä¸ºæ­¤éœ€è¦ä¸ºæ¯ä¸ªæ¶ˆæ¯åˆ›å»ºå‡ºç±»ä¼¼å¤§å ‚ç»ç†ï¼Œç”Ÿæ´»ä¸­ä¸€èˆ¬æ˜¯åªæœ‰ä¸€ä¸ªå¤§å ‚ç»ç†ï¼Œä½†æ˜¯åœ¨ç¼–ç¨‹ä¸–ç•Œé‡Œéœ€è¦ä¸ºæ¯ä¸ªåˆ†é…ä¸€ä¸ªå¤§å ‚ç»ç†ï¼Œå¤§å ‚ç»ç†ä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯å‘é€çº¿ç¨‹å‘é€å®Œæ¶ˆæ¯æ—¶ï¼Œå°†å…¶é˜»å¡ï¼Œæä¾›æ¶ˆæ¯ç»“æœçš„å›è°ƒæ¥å£ï¼Œé€šçŸ¥é˜»å¡çš„å‘é€çº¿ç¨‹æ¶ˆè´¹æ¶ˆæ¯ç»“æœã€‚<br>è¯¾åä¹ é¢˜ï¼š1ã€ä½¿ç”¨sleepå¦‚æœæ¶ˆæ¯ç»“æœå·²ç»è¿”å›ï¼Œè¿˜éœ€ç­‰åˆ°sleepè¶…æ—¶ï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œ2ã€ä½¿ç”¨åŠ é”çš„awaitæ–¹æ³•å¯ä»¥ä¿è¯å¯è§æ€§ï¼Œå¦‚æœä½¿ç”¨sleepçš„è¯ï¼Œéœ€è¦ç»™objåŠ ä¸Švolatile3ã€æ„Ÿè§‰åœ¨sentï¼ˆmessageï¼‰æˆåŠŸåæ‰é˜»å¡ï¼Œä¸ç„¶æœ‰å¯èƒ½mqæ¥æ”¶æ¶ˆæ¯å¤±è´¥ï¼Œwhileå¾ªç¯ä¼šä¸€ç›´æ‰§è¡Œä¸‹å»ï¼Œsentå¤±è´¥ï¼Œç›´æ¥å“åº”æç¤ºç»™å‰ç«¯ã€‚<br>","like_count":15},{"had_liked":false,"id":201173,"user_name":"æœµæœµé›†å›¢æ€»è£","can_delete":false,"product_type":"c1","uid":1338806,"ip_address":"","ucode":"871ACA41655401","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Dh6hib6KsQDsucBZztpyAp6hEhb4j2aJrLdsYnH1Ll6D0yaTuYPpYj1vmwWN97lfxsH6V8CZp8nCXdIejffslVg/132","comment_is_top":false,"comment_ctime":1585727902,"is_pvip":false,"replies":[{"id":"75458","content":"æ€»è£æ‚¨è¯´çš„å¯¹ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1585872995,"ip_address":"","comment_id":201173,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44535400862","product_id":100023901,"comment_content":"å¦‚æœmqæœåŠ¡æŒ‚äº†æ— æ³•æ¶ˆè´¹ï¼Œä¼šå¼•èµ·webè¯·æ±‚æœåŠ¡å¾ˆå¤šçº¿ç¨‹å‡ºäºç­‰å¾…çŠ¶æ€ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥whlieå¾ªç¯åŠ ä¸Šè¶…æ—¶ã€‚","like_count":10,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490258,"discussion_content":"æ€»è£æ‚¨è¯´çš„å¯¹ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585872995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93289,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1557450242,"is_pvip":false,"replies":[{"id":"33509","content":"è¿™ä¸ªå›è°ƒå‡½æ•°å’Œmqçš„å›è°ƒå‡½æ•°ä»æœåŠ¡æ¥å…¥æ–¹çš„è§’åº¦çœ‹æ˜¯ä¸€æ ·çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557644086,"ip_address":"","comment_id":93289,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40212155906","product_id":100023901,"comment_content":"æ¥å…¥å¾®ä¿¡æ”¯ä»˜æ”¯ä»˜å®æ”¯ä»˜é‡Œè¾¹ï¼Œä¹Ÿéœ€è¦æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ŒonChange()å°±æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°å§ï¼Œä¸è¿‡å¾®ä¿¡æ”¯ä»˜å®æ”¯ä»˜æ˜¯å¼‚æ­¥å›è°ƒï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æ”¹æˆè¿™ç§ï¼Ÿå¾®ä¿¡æ”¯ä»˜å®é‡Œè¾¹çš„å…¶å®ƒç¬¬ä¸‰æ–¹æ”¯ä»˜æ˜¯ä¸æ˜¯å°±æ˜¯è¿™ç§æ¨¡å¼ï¼Œå› ä¸ºæ”¯ä»˜æˆåŠŸä¹‹åè·³è½¬åˆ°å®ƒä»¬è‡ªå·±çš„é¡µé¢ï¼Œè€Œä¸æ˜¯å¾®ä¿¡æ”¯ä»˜å®å®˜æ–¹çš„æ”¯ä»˜æˆåŠŸç•Œé¢","like_count":9,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449565,"discussion_content":"è¿™ä¸ªå›è°ƒå‡½æ•°å’Œmqçš„å›è°ƒå‡½æ•°ä»æœåŠ¡æ¥å…¥æ–¹çš„è§’åº¦çœ‹æ˜¯ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557644086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92941,"user_name":"å›å“¥èŠæŠ€æœ¯","can_delete":false,"product_type":"c1","uid":1325816,"ip_address":"","ucode":"2C9A22BCE4C79E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","comment_is_top":false,"comment_ctime":1557365932,"is_pvip":false,"replies":[{"id":"33208","content":"awaitå’Œnotifyè·å–é”æ‰èƒ½è°ƒç”¨ï¼Œæ‰€ä»¥ä¸èƒ½å»æ‰é”","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557411839,"ip_address":"","comment_id":92941,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31622137004","product_id":100023901,"comment_content":"å¦‚æœä»¥æ–‡ä¸­çš„æœ€åä¸€æ®µç¤ºä¾‹ä»£ç æ¥çœ‹ï¼Œæ¯ä¸€ä¸ªè¯·æ±‚ç”Ÿæˆä¸€ä¸ªidï¼Œå¯¹åº”ä¸€ä¸ªGuardedObjectï¼Œå¹¶æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚æˆ‘è§‰å¾—å¯ä»¥å»æ‰é”ã€‚<br>ä½†æ˜¯åŠ sleepçš„è¯ï¼Œæ²¡æœ‰åŠæ³•å”¤é†’ï¼Œåªèƒ½ç­‰åˆ°è¶…æ—¶ã€‚","like_count":7,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449432,"discussion_content":"awaitå’Œnotifyè·å–é”æ‰èƒ½è°ƒç”¨ï¼Œæ‰€ä»¥ä¸èƒ½å»æ‰é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557411839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92863,"user_name":"zero","can_delete":false,"product_type":"c1","uid":1299615,"ip_address":"","ucode":"528DD5C8399AEC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlwpFM3tkeG15YqyJTYWkfqkdmro9POq6SicYm57TaEFDOUZCXjoe0Z0Iz6UibGQqic3icJRsHdFzibtw/132","comment_is_top":false,"comment_ctime":1557358832,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"31622129904","product_id":100023901,"comment_content":"waitä¼šé‡Šæ”¾å æœ‰çš„èµ„æºï¼Œsleepä¸ä¼šé‡Šæ”¾","like_count":7},{"had_liked":false,"id":131442,"user_name":"åº„å¢¨å¯’","can_delete":false,"product_type":"c1","uid":1063970,"ip_address":"","ucode":"BBD9EFA891BF06","user_header":"https://static001.geekbang.org/account/avatar/00/10/3c/22/9024c062.jpg","comment_is_top":false,"comment_ctime":1567753638,"is_pvip":false,"replies":[{"id":"49891","content":"è¿™æ˜¯ä¸ªçœŸå®çš„ä¾‹å­ï¼Œé›†ç¾¤ä¸­æœ‰ä¸¤å°æœºå™¨ï¼Œa-&gt;bæœ‰ä¸€ä¸ªå‚æ•°topicï¼Œb-&gt;açš„æ—¶å€™æ ¹æ®ä¼ å…¥çš„topicå‚æ•°æ¥ç¡®å®šå†™å…¥å“ªä¸ªtopicçš„ï¼Œä¸¤å°æœºå™¨çš„topicå‚æ•°ä¸åŒï¼Œæ‰€ä»¥å‘é€å’Œæ¥æ”¶æ˜¯èƒ½å¯¹åº”ä¸Šçš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1567780919,"ip_address":"","comment_id":131442,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23042590118","product_id":100023901,"comment_content":"è€å¸ˆ, æˆ‘è§‰å¾—æ‚¨åªæ˜¯ä¸¾ä¸ªä¾‹å­å§. çœŸå®çš„ç”Ÿæˆç¯å¢ƒ, Aå’ŒBè‚¯å®šéƒ½æ˜¯ä¸€ä¸ªé›†ç¾¤; A ç»™ Bå‘ä¸€ä¸ªæ¶ˆæ¯. Bå¤„ç†å®Œåå†ç»™Aå‘ä¸€ä¸ªæ¶ˆæ¯,  åœ¨A é›†ç¾¤ä¸­å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„å¤§æ¦‚ç‡ä¸¤å°ä¸åŒçš„æœºå™¨. è§£å†³è¿™ä¸ªé—®é¢˜ä¸¤ç§åŠæ³•: 1. web è¯·æ±‚é•¿è½®è¯¢; 2. Aé›†ç¾¤æœ‰åˆ†å¸ƒå¼çš„ç¼“å­˜, Açš„æŸå°æœºå™¨å¤„ç†æ¶ˆæ¯åæŠŠç»“æœå†™åˆ°ç¼“å­˜, å¤„ç†webè¯·æ±‚çš„æœºå™¨æœ‰ä¸“é—¨çš„çº¿ç¨‹å»è½®è¯¢. ","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466455,"discussion_content":"è¿™æ˜¯ä¸ªçœŸå®çš„ä¾‹å­ï¼Œé›†ç¾¤ä¸­æœ‰ä¸¤å°æœºå™¨ï¼Œa-&amp;gt;bæœ‰ä¸€ä¸ªå‚æ•°topicï¼Œb-&amp;gt;açš„æ—¶å€™æ ¹æ®ä¼ å…¥çš„topicå‚æ•°æ¥ç¡®å®šå†™å…¥å“ªä¸ªtopicçš„ï¼Œä¸¤å°æœºå™¨çš„topicå‚æ•°ä¸åŒï¼Œæ‰€ä»¥å‘é€å’Œæ¥æ”¶æ˜¯èƒ½å¯¹åº”ä¸Šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567780919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176936,"user_name":"Chuan","can_delete":false,"product_type":"c1","uid":1438352,"ip_address":"","ucode":"FACEC5DAC36A7A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI4akcIyIOXB2OqibTe7FF90hwsBicxkjdicUNTMorGeIictdr3OoMxhc20yznmZWwAvQVThKPFWgOyMw/132","comment_is_top":false,"comment_ctime":1581231479,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18761100663","product_id":100023901,"comment_content":"è¿™é‡Œæœ‰ä¸€ä¸ªåŒºåˆ«å°±æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºäº†ä¸€ä¸ªGuardedObjectï¼Œç›¸å½“äºåˆ›å»ºäº†å¤šä¸ªå¤§å ‚ç»ç†ï¼Œè¿™é‡Œå’Œç°å®ä¸­æœ‰ç‚¹ä¸ä¸€æ ·ã€‚ç›®çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨ä¸€ä¸ªGuardedObjectï¼Œåœ¨singalAllæ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹2çš„å›æ‰§ç»“æœè¢«çº¿ç¨‹1æ¶ˆè´¹ï¼Œå³é”å†²çªã€‚æ‰€ä»¥è¿™é‡Œæ¯æ¬¡éƒ½åˆ›å»ºä¸åŒçš„GuardedObjectï¼Œå…¶å†…éƒ¨çš„é”ä¹Ÿä¸åŒï¼Œåœ¨å”¤é†’çš„æ—¶å€™å°±ä¸ä¼šå‡ºé”™äº†ã€‚","like_count":4,"discussions":[{"author":{"id":1418179,"avatar":"https://static001.geekbang.org/account/avatar/00/15/a3/c3/91aa0e32.jpg","nickname":"è¿","note":"","ucode":"ECB1DC885B25D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383016,"discussion_content":"   // è¿™ä¸ªæ˜¯å¤§å ‚ç»ç†  ä»–æ˜¯  staticçš„ åªæœ‰ä¸€ä¸ª\n    final static Map<Object, GuardedObject> gos=new ConcurrentHashMap<>();","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625823709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137293,"user_name":"DFighting","can_delete":false,"product_type":"c1","uid":1233193,"ip_address":"","ucode":"F3BA2426FF8582","user_header":"https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg","comment_is_top":false,"comment_ctime":1569678630,"is_pvip":true,"replies":[{"id":"52753","content":"waitæ˜¯ç®¡ç¨‹é‡Œçš„æ“ä½œï¼Œsleepå°±æ˜¯ä¸€ä¸ªç³»ç»Ÿapiï¼Œä»–ä»¬å…¶å®æ²¡å…³ç³»ï¼Œæ‰€ä»¥sleepä¸ä¼šé‡Šæ”¾ç®¡ç¨‹çš„é”ï¼Œä»–ä»¬æ²¡å…³ç³»","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1569683230,"ip_address":"","comment_id":137293,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18749547814","product_id":100023901,"comment_content":"é—®é¢˜çš„åŸå› ä¸»è¦æ˜¯sleepæ²¡åŠæ³•æä¾›ç­‰å¾…-å”¤é†’æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´æç«¯æƒ…å†µä¸‹å¯èƒ½ä¼šä¸€ç›´å¤„äºç¡çœ çŠ¶æ€ã€‚<br>è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆsleepä¸èƒ½è¢«å”¤é†’å•Šï¼Ÿç½‘ä¸ŠæŸ¥äº†ä¸‹ç­”æ¡ˆï¼Œå¥½åƒæ˜¯è¯´waitä¼šæŒæœ‰ä¸€ä¸ªå¯¹è±¡é”(JVM)æä¾›çš„ï¼Œç„¶ååœ¨æ‰§è¡Œnotifyæ“ä½œçš„æ—¶å€™ï¼ŒJVMä¼šé‡Šæ”¾è¿™ä¸ªå¯¹è±¡é”ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹æ‰§è¡Œã€‚è€Œsleepå¹¶æ²¡æœ‰é‡Šæ”¾è¿™ä¸ªé”ï¼Œæ‰€ä»¥æ²¡åŠæ³•å”¤é†’ï¼Ÿæ„Ÿè§‰æœ‰ç‚¹é“ç†ï¼Œä½†æ˜¯ä¸çŸ¥é“å¯¹ä¸å¯¹ï¼Œæœ›è€å¸ˆä¸åèµæ•™","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469022,"discussion_content":"waitæ˜¯ç®¡ç¨‹é‡Œçš„æ“ä½œï¼Œsleepå°±æ˜¯ä¸€ä¸ªç³»ç»Ÿapiï¼Œä»–ä»¬å…¶å®æ²¡å…³ç³»ï¼Œæ‰€ä»¥sleepä¸ä¼šé‡Šæ”¾ç®¡ç¨‹çš„é”ï¼Œä»–ä»¬æ²¡å…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569683230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1818343,"avatar":"","nickname":"åˆ˜åŒé’","note":"","ucode":"84B62DF8BC61FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281626,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591780123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136046,"user_name":"é£ç¿”","can_delete":false,"product_type":"c1","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1569335391,"is_pvip":true,"replies":[{"id":"52559","content":"æ˜¯çš„ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1569582219,"ip_address":"","comment_id":136046,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18749204575","product_id":100023901,"comment_content":"è€å¸ˆ future.get å°±æ˜¯guarded suspension çš„åº”ç”¨å§","like_count":5,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468431,"discussion_content":"æ˜¯çš„ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569582219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134574,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","nickname":"ä¸€é­„","note":"","ucode":"71541125D4AA5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392516,"discussion_content":"æ²¡å°‘çœ‹æºç å•Šå…„å°","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631025547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1818343,"avatar":"","nickname":"åˆ˜åŒé’","note":"","ucode":"84B62DF8BC61FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281625,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591780109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128009,"user_name":"Ab","can_delete":false,"product_type":"c1","uid":1039466,"ip_address":"","ucode":"8E9261782F025D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/dc/6a/b5478b65.jpg","comment_is_top":false,"comment_ctime":1566820210,"is_pvip":false,"replies":[{"id":"48643","content":"æ¯ä¸ªè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªGuardedObjectï¼Œgetå’ŒonChangedä¸æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæ‰§è¡Œçš„ï¼Œä¹Ÿä¸åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1567428554,"ip_address":"","comment_id":128009,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18746689394","product_id":100023901,"comment_content":"è€å¸ˆï¼Œ æœ‰ä¸€ä¸ªåœ°æ–¹ä¸å¤ªç†è§£ï¼Œæ‰©å±• Guarded Suspension æ¨¡å¼ è¿™ä¸€èŠ‚ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œgetå’ŒonChangeæ–¹æ³•åº”è¯¥æ˜¯åœ¨åŒä¸€ä¸ªGuardedObjectä¸Šè°ƒç”¨çš„å§ï¼Œä¸ºå•¥è¿˜æœ‰ç»´æŠ¤ä¸€ä¸ªMapæ¥å­˜å‚¨msgIdå’ŒGuardedObjectä¹‹é—´çš„å…³ç³»å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464751,"discussion_content":"æ¯ä¸ªè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªGuardedObjectï¼Œgetå’ŒonChangedä¸æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæ‰§è¡Œçš„ï¼Œä¹Ÿä¸åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567428554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1018240,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/80/3666ced3.jpg","nickname":"é»„æµ©ç‰¹","note":"","ucode":"C3A4BBF4FB8519","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35357,"discussion_content":"è°ƒç”¨ onChange æ–¹æ³•çš„çº¿ç¨‹å¿…é¡»é€šè¿‡ fireEvent æ–¹æ³•è°ƒç”¨ onChangedã€‚è¿™é‡ŒonChanged åº”è¯¥å¯ä»¥æ˜¯ç§æœ‰çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571272715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":146008,"user_name":"ipofss","can_delete":false,"product_type":"c1","uid":1018620,"ip_address":"","ucode":"DE3061C9259F9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","comment_is_top":false,"comment_ctime":1572417918,"is_pvip":false,"replies":[{"id":"56355","content":"waitä¼šé‡Šæ”¾é”ï¼Œå»ºè®®é‡çœ‹ç¬¬ä¸€éƒ¨åˆ†ç®¡ç¨‹ç›¸å…³çš„å†…å®¹","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1572428748,"ip_address":"","comment_id":146008,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14457319806","product_id":100023901,"comment_content":"è€å¸ˆï¼Œè¿™èŠ‚å¬äº†ä¸ªå¤§æ¦‚ï¼Œä¸æ˜¯éå¸¸æ‡‚ã€‚å…¶ä¸­æœ‰ä¸€ç‚¹æ²¡ç†è§£ï¼Œgetæ–¹æ³•åŠ é”åï¼Œwhileåˆ¤æ–­ä¸€ç›´éƒ½ä¸ºtrueï¼Œä¹Ÿå°±ä¸€ç›´ä¸ä¼šé‡Šæ”¾é”ï¼Œé‚£onChangedæ–¹æ³•è¿›å»ä¹‹åï¼Œè·å–ä¸åˆ°é”ï¼ŒåŒæ–¹ä¸ä¹…äº’ç›¸æ­»ç­‰ä¸‹å»äº†ä¹ˆï¼Œæˆ‘åº”è¯¥è¿˜æ˜¯å“ªé‡Œæ²¡æƒ³æ˜ç™½","like_count":4,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472667,"discussion_content":"waitä¼šé‡Šæ”¾é”ï¼Œå»ºè®®é‡çœ‹ç¬¬ä¸€éƒ¨åˆ†ç®¡ç¨‹ç›¸å…³çš„å†…å®¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572428748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269984,"user_name":"Geek_110f21","can_delete":false,"product_type":"c1","uid":2355391,"ip_address":"","ucode":"67495EAEAF5D61","user_header":"","comment_is_top":false,"comment_ctime":1608867360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10198801952","product_id":100023901,"comment_content":"sleepä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯å®æ•ˆæ€§ä¸åŠç­‰å¾…å”¤é†’ï¼Œç¬¬äºŒæ˜¯objå˜é‡è¦åŠ volatileä¿è¯å¯è§æ€§","like_count":3},{"had_liked":false,"id":230007,"user_name":"zapup","can_delete":false,"product_type":"c1","uid":1397351,"ip_address":"","ucode":"388D6BB5D7B137","user_header":"https://static001.geekbang.org/account/avatar/00/15/52/67/fcba0967.jpg","comment_is_top":false,"comment_ctime":1593240617,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10183175209","product_id":100023901,"comment_content":"go åƒæ˜¯ msg çš„ä¸“å±ç§äººç»ç†ã€‚<br>1. æ‹¿ç€ idï¼ˆé¢„çº¦çš„æˆ¿å·ï¼‰ æ¥ï¼Œç”±å¤§å ‚æ€»éƒ¨ GuardedObject æ´¾ä¸€ä½ç§äººç»ç† go ä¸“é—¨è´Ÿè´£ï¼ˆstatic create()ï¼‰ï¼Œå¹¶è®°å½•åœ¨å†Œï¼ˆgosï¼‰ï¼›<br>2. å¦‚æœä½ æå‰é—®ä½ çš„ç§äººç»ç†ã€Œå¥½äº†å—ã€ï¼ˆgo.get()ï¼‰ï¼Œä»–ä¼šå…ˆ hold ä½ä½ ï¼Œå¹¶ç­‰å¾…æ€»éƒ¨å–Šè¯ï¼›<br>3. åå‹¤éƒ¨æ‰“æ‰«å¥½å«ç”Ÿä¹‹åï¼Œä¸ä¼šç›´æ¥ä¸æŸä¸ªç§äººç»ç†ï¼ˆgoï¼‰è¯´ï¼Œè€Œæ˜¯ç›´æ¥å‘Šè¯‰å¤§å ‚æ€»éƒ¨å“ªé—´æˆ¿ï¼ˆidï¼‰å·²ç»å¥½äº†ï¼ˆstatic fireEvent(id)ï¼‰ï¼›<br>4. å¤§å ‚æ€»éƒ¨åœ¨å°å†Œå­ï¼ˆgosï¼‰ä¸­æ‰¾åˆ°è´Ÿè´£æ­¤æˆ¿é—´ï¼ˆidï¼‰çš„ç§äººç»ç†ï¼ˆgoï¼‰ï¼Œå¹¶é€šçŸ¥ä»–ã€Œæˆ¿é—´å¥½äº†ã€ï¼ˆgo.onChanged(obj)ï¼‰ï¼›<br>5. ç§äººç»ç†æŠŠè¢« hold ä½çš„ä½ å”¤é†’ï¼ˆsignAllï¼‰","like_count":2},{"had_liked":false,"id":100313,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1559526789,"is_pvip":false,"replies":[{"id":"36128","content":"åªè¦å”¤é†’çš„æ—¶å€™èƒ½æ‰¾åˆ°æ­£ç¡®çš„çº¿ç¨‹å°±å¯ä»¥ï¼Œä¸çŸ¥é“ä½ çš„æ–¹æ³•æ˜¯ä¸æ˜¯èƒ½åšåˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1559541121,"ip_address":"","comment_id":100313,"utype":1}],"discussion_count":4,"race_medal":0,"score":"10149461381","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼<br>æˆ‘æƒ³åˆ°äº†ä¸€ä¸ªåœºæ™¯ï¼šâ€‹çº¿ç¨‹ t1 æäº¤äº†æ¶ˆæ¯ m1ï¼Œçº¿ç¨‹ t2 æäº¤äº†æ¶ˆæ¯ m2ï¼Œæ­¤æ—¶éƒ½åœ¨ get() æ–¹æ³•å¤„ç­‰å¾…ç»“æœè¿”å›ã€‚m2 å…ˆè¢«å¤„ç†å®Œï¼Œthis.obj å¯¹åº”çš„æ˜¯æ¶ˆæ¯ m2 çš„ç»“æœï¼Œè°ƒç”¨ fireEvent() å”¤é†’ t1 å’Œ t2ï¼Œt1 ç«äº‰åˆ°é”èµ„æºï¼Œæ¶ˆè´¹äº† m2 çš„ç»“æœ this.objã€‚<br><br>å¦‚æœå­˜åœ¨è¿™ç§åœºæ™¯ï¼Œå†ç»´æŠ¤ä¸€ä¸ª ConcurrentHashMapï¼Œkey æ˜¯ msg.idï¼Œvalue æ˜¯å¯¹åº”çš„ objï¼Œæ˜¯å¦å°±èƒ½è§£å†³ç»“æœè¿™é—®é¢˜ï¼Ÿ<br><br>è°¢è°¢è€å¸ˆï¼","like_count":2,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452496,"discussion_content":"åªè¦å”¤é†’çš„æ—¶å€™èƒ½æ‰¾åˆ°æ­£ç¡®çš„çº¿ç¨‹å°±å¯ä»¥ï¼Œä¸çŸ¥é“ä½ çš„æ–¹æ³•æ˜¯ä¸æ˜¯èƒ½åšåˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559541121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1095445,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b7/15/6a2b6b83.jpg","nickname":"è‘£å®—ç£Š","note":"","ucode":"D7005A328BC2EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3006,"discussion_content":"æˆ‘ç†è§£m1ã€m2ä¼šå¯¹åº”ä¸¤ä¸ªä¸åŒçš„GuardedObjectå¯¹è±¡çš„ï¼Œæ¯ä¸ªå¯¹è±¡å†…éƒ¨éƒ½æ˜¯å•ç‹¬çš„Lockï¼ŒfireEventæ–¹æ³•åªä¼šå”¤é†’å„è‡ªçš„çº¿ç¨‹","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1564107507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":162893,"discussion_content":"ä¸¤ä¸ªä¸åŒçš„GuardedObjectå¯¹è±¡ç»´æŠ¤çš„æ˜¯ä¸åŒçš„lockå’Œcondition,ä¸å­˜åœ¨é”çš„å†²çªé—®é¢˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581035670,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1896587,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/f0/8b/e307f616.jpg","nickname":"æ²æµ´éœ²ğŸ§´","note":"","ucode":"CFAFDE6450BC2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263234,"discussion_content":"åªæœ‰static ä¿®é¥°çš„æˆå‘˜å˜é‡ newå‡ºæ¥çš„å¯¹è±¡æ‰ä¼šå…±äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589190954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92965,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1557369461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10147304053","product_id":100023901,"comment_content":"ç”¨sleepçš„è¯åªèƒ½ç­‰ç¡çœ æ—¶é—´åˆ°äº†ä¹‹åå†è¿”å›whileå¾ªç¯æ¡ä»¶å»åˆ¤æ–­ï¼Œä½†æ˜¯waitç›¸å½“äºå’Œsingalç»„æˆç­‰å¾…å”¤é†’çš„æœºåˆ¶ï¼Œè¿™æ ·æ»¡è¶³æ¡ä»¶çš„æ¦‚ç‡æ›´å¤§ä¸€äº›ï¼Œæ€§èƒ½ä¹Ÿæ›´å¥½","like_count":2},{"had_liked":false,"id":268403,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1608177871,"is_pvip":false,"replies":[{"id":"97469","content":"å­¦ä»¥è‡´ç”¨å•Šï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1608249578,"ip_address":"","comment_id":268403,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5903145167","product_id":100023901,"comment_content":"guarded suspensionæ¨¡å¼è§£å†³äº†æˆ‘å·¥ä½œä¸­çš„ä¸€ä¸ªé—®é¢˜<br>clientåŒæ­¥æ‰æˆ‘çš„æœåŠ¡aï¼ŒæœåŠ¡aå¤„ç†å¹¶éœ€è¦ç­‰å¾…ä¸€ä¸ªå®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511935,"discussion_content":"å­¦ä»¥è‡´ç”¨å•Šï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608249578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155799,"user_name":"çŸ³å¤´ğŸŠ","can_delete":false,"product_type":"c1","uid":1550500,"ip_address":"","ucode":"D68673430450B8","user_header":"https://static001.geekbang.org/account/avatar/00/17/a8/a4/ea898a39.jpg","comment_is_top":false,"comment_ctime":1574758363,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5869725659","product_id":100023901,"comment_content":"ä½¿ç”¨LockSupporté…åˆmapæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å®ç°","like_count":1},{"had_liked":false,"id":155011,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1574617092,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5869584388","product_id":100023901,"comment_content":"sleep ä¸æ˜¯é‡Šæ”¾é”","like_count":1,"discussions":[{"author":{"id":1644104,"avatar":"https://static001.geekbang.org/account/avatar/00/19/16/48/09493874.jpg","nickname":"èŒ¶æ²¡å–å®Œ","note":"","ucode":"D72D88C42A1258","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271851,"discussion_content":"sleepä¸æ”¹å˜é”çŠ¶æ€ï¼šsleepä¹‹å‰è·å–äº†é”ï¼Œä¸ä¼šé‡Šæ”¾é”ï¼›ä¹‹å‰æ²¡æœ‰è·å–é”ï¼Œä¹Ÿä¸ä¼šè·å–é”ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590205045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149374,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1573203914,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5868171210","product_id":100023901,"comment_content":"å¦‚æœæŒ‰ç…§ä»£ç ä¸Šé¢æ¥çœ‹ï¼Œè¿™è¿˜æ˜¯ä¸€ä¸ªå®¢æˆ·å¯¹åº”ä¸€ä¸ªå¤§å ‚ç»ç†äº†å‘—ã€‚ã€‚æ¯æ¬¡è¿˜è¦æ¢æ–°çš„å¤§å ‚ç»ç†çš„æ„Ÿè§‰ã€‚","like_count":1},{"had_liked":false,"id":110536,"user_name":"æ¨é¹ç¨‹baci","can_delete":false,"product_type":"c1","uid":1205949,"ip_address":"","ucode":"3D22F6B74340A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/66/bd/bd5d503e.jpg","comment_is_top":false,"comment_ctime":1562291311,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5857258607","product_id":100023901,"comment_content":"è€å¸ˆå¥½ï¼ŒMessage r = get(t-&gt;t != null); è¿™ä¸ªåœ°æ–¹é‡Œé¢çš„tæ˜¯ä»€ä¹ˆå‚æ•°å•Šï¼Œæœ‰ç‚¹çœ‹çš„ä¸æ˜¯å¾ˆæ‡‚ï¼Œç„¶ååœ¨getæ–¹æ³•é‡Œé¢!p.test(obj)é‡Œé¢æ˜¯åˆ¤æ–­äº†å•¥ï¼Œå°±è¿™é‡Œæœ‰ç‚¹çœ‹çš„ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œè°¢è°¢ï¼","like_count":1,"discussions":[{"author":{"id":1583588,"avatar":"https://static001.geekbang.org/account/avatar/00/18/29/e4/ade74d94.jpg","nickname":"hejun","note":"","ucode":"DCF01B4159178F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217499,"discussion_content":"Predicateæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•testã€‚â€œt->t != nullâ€å°±æ˜¯é‡å†™è¿™ä¸ªæŠ½è±¡æ–¹æ³•ã€‚â€œ!p.test(obj)â€è¡¨æ˜testçš„å…¥å‚ t=objï¼Œåˆ¤æ–­äº† obj != nullã€‚ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585565680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1644104,"avatar":"https://static001.geekbang.org/account/avatar/00/19/16/48/09493874.jpg","nickname":"èŒ¶æ²¡å–å®Œ","note":"","ucode":"D72D88C42A1258","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":271852,"discussion_content":"java8çš„FunctionInterface","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590205153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1061748,"avatar":"https://static001.geekbang.org/account/avatar/00/10/33/74/d9d143fa.jpg","nickname":"silentyears","note":"","ucode":"6E137BFEB874CA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":123293,"discussion_content":"test å°±æ˜¯ t ï¼= null","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578399300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104504,"user_name":"ç‹ç››æ­¦","can_delete":false,"product_type":"c1","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1560768862,"is_pvip":false,"replies":[{"id":"38347","content":"æœ€ä½³å®è·µä¸ä¸€å®šæ˜¯æœ€ä¼˜æ–¹æ¡ˆï¼Œä½†æ˜¯èƒ½é˜²æ­¢å‡ºé”™","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1561161196,"ip_address":"","comment_id":104504,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5855736158","product_id":100023901,"comment_content":"ç‹è€å¸ˆï¼Œè¯·é—®è¿™é‡Œlockæ˜¯å®ä¾‹ç§æœ‰å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ lock.signalï¼Ÿ  æ„Ÿè§‰æ–‡æ¡ˆé‡Œçš„ä»£ç ä¸éœ€è¦signalallå‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªlockæ˜¯æ¯æ¬¡éƒ½newå‡ºæ¥çš„ï¼Œçº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—é‡Œæ°¸è¿œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥signalallæ„ä¹‰ä¸å¤§","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454298,"discussion_content":"æœ€ä½³å®è·µä¸ä¸€å®šæ˜¯æœ€ä¼˜æ–¹æ¡ˆï¼Œä½†æ˜¯èƒ½é˜²æ­¢å‡ºé”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561161196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1450758,"avatar":"https://static001.geekbang.org/account/avatar/00/16/23/06/47bb92bc.jpg","nickname":"Tyrion","note":"","ucode":"3F8C57F7F60DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2168,"discussion_content":"æˆ‘è§‰å¾—è¥¿æ»‹æ»‹è¯´çš„å¯¹ï¼è™½ç„¶è€å¸ˆè¯´çš„æ˜¯æœ€ä¼˜å®è·µï¼Œä½†æ˜¯ä¹Ÿå¾—çœ‹åœºæ™¯å§ã€‚å¦‚æœèƒ½å¤Ÿç¡®å®šæ¯æ¬¡éƒ½æ˜¯newçš„æ–°å¯¹è±¡ï¼Œé‚£ç”¨singalä¹Ÿæ˜¯å¾ˆå¥½ï¼ˆè€Œä¸”å‡å¦‚singalæ¯”singalAllæ€§èƒ½æ›´å¥½çš„è¯ï¼Œé‚£æ˜¯ä¸æ˜¯æ•ˆæœæ›´å¥½å‘¢ï¼‰ã€‚å½“ç„¶è€å¸ˆè¯´çš„é—®é¢˜ä¹Ÿæ˜¯å¯¹çš„ï¼Œå†™æˆæœ€ä¼˜å®è·µï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å¼‚å¸¸å‘ç”Ÿå§ï¼Œæ¯”å¦‚æœ¬æ¥åº”è¯¥æ˜¯æ¯æ¬¡newä¸€ä¸ªå¯¹è±¡çš„ï¼Œç»“æœæŸä¸ªåœ°æ–¹æ²¡æœ‰newï¼Œè€Œé‡å¤ç”¨äº†ä¹‹å‰newçš„å¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563326656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96852,"user_name":"Rancood","can_delete":false,"product_type":"c1","uid":1204333,"ip_address":"","ucode":"052BDF2221F480","user_header":"https://static001.geekbang.org/account/avatar/00/12/60/6d/e2576fda.jpg","comment_is_top":false,"comment_ctime":1558521327,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5853488623","product_id":100023901,"comment_content":"è¿™ä¸ªæ¨¡å¼äº†è§£äº†ï¼Œä½†æ˜¯å®ä¾‹ä¸­ä¸šåŠ¡æœ‰ç‚¹æ‡µï¼ŒhandleWebReqæ–¹æ³•æœ€ç»ˆæ‹¿åˆ°çš„æ˜¯è‡ªå·±å‘é€å‡ºå»çš„messageæ¶ˆæ¯ï¼›æ˜¯ä¸æ˜¯åº”è¯¥åœ¨onMessageæ–¹æ³•å”¤é†’ç­‰å¾…çº¿ç¨‹ä¹‹å‰è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œç”Ÿæˆæ–°çš„Messageæ¶ˆæ¯newMsgï¼Œç„¶åæŠŠnewMsgä¼ åˆ°fireEventé‡Œé¢ï¼Œè¿™æ ·æ‹¿åˆ°çš„æ˜¯åé¦ˆçš„ç»“æœã€‚è¯·è€å¸ˆæŒ‡ç‚¹ä¸€ä¸‹","like_count":1,"discussions":[{"author":{"id":1018240,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/89/80/3666ced3.jpg","nickname":"é»„æµ©ç‰¹","note":"","ucode":"C3A4BBF4FB8519","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35341,"discussion_content":"å®é™…ä¸šåŠ¡åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼Œè€å¸ˆçš„ä»£ç æ˜¯å®¢æˆ·ç«¯çš„. å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯åç­‰å¾…å”¤é†’ï¼ŒæœåŠ¡ç«¯æ¥æ”¶æ¶ˆæ¯è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œå°†ç»“æœå‘é€å›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°ç»“æœæ¶ˆæ¯ï¼Œè°ƒç”¨fireEvent å”¤é†’å¯¹åº”çš„ç­‰å¾…çº¿ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571272069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94706,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1557883948,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852851244","product_id":100023901,"comment_content":"é¢ æˆ‘çœ‹æœ‰ä¸ªåŒå­¦è¯´ å¯è§æ€§ä¹Ÿæ— æ³•ä¿è¯ã€‚<br><br>é”æ˜¯ä¿è¯å¯è§æ€§çš„å˜›ï¼Ÿ æˆ‘è®°å¾—é”æ˜¯ä¿è¯åŸå­æ€§çš„å“‡ï¼Œ å¯è§æ€§ä¸æ˜¯volatileå˜é‡æ¥ä¿è¯çš„å˜›ï¼Ÿ ","like_count":1},{"had_liked":false,"id":93667,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1557554981,"is_pvip":false,"replies":[{"id":"33500","content":"æ€è·¯ä¸åŒï¼Œä¸è¿‡ç»“æœæ˜¯ä¸€æ ·çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557642626,"ip_address":"","comment_id":93667,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5852522277","product_id":100023901,"comment_content":"é¡¹ç›®ä¸­æˆ‘ä½¿ç”¨äº†Map&lt;key, CountdownLatch&gt;æ¥å¤„ç†å¼‚æ­¥è½¬åŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥ç­‰å¾…æ—¶é€šè¿‡countdownLatch.await(timeout)è®¾ç½®è¶…æ—¶æ—¶é•¿ï¼Œè¯·é—®è€å¸ˆè¿™è·Ÿä½ è®²çš„lock nitifyAllç®¡ç¨‹æ–¹æ³•æ˜¯å¦ç±»ä¼¼ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449722,"discussion_content":"æ€è·¯ä¸åŒï¼Œä¸è¿‡ç»“æœæ˜¯ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557642626,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1670763,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","nickname":"FIRE","note":"","ucode":"85861D990FB3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326716,"discussion_content":"é«˜,æ ¸å¿ƒå°±æ˜¯çº¿ç¨‹çš„wait/notify","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605666722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93147,"user_name":"æ©˜å­","can_delete":false,"product_type":"c1","uid":1368522,"ip_address":"","ucode":"EDF6145878F897","user_header":"https://static001.geekbang.org/account/avatar/00/14/e1/ca/d8b0835f.jpg","comment_is_top":false,"comment_ctime":1557407918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5852375214","product_id":100023901,"comment_content":"è¿™è®©æˆ‘æƒ³åˆ°äº†ä¹‹å‰å¾ˆç«çš„sleepæ’åºç®—æ³•ï¼Œå“ˆå“ˆ","like_count":1},{"had_liked":false,"id":92935,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1557365446,"is_pvip":false,"replies":[{"id":"53899","content":"æˆ‘å–œæ¬¢è‡ªå·±æ‰¾åº§ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1570709612,"ip_address":"","comment_id":92935,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5852332742","product_id":100023901,"comment_content":"<br><br>è€å¸ˆï¼Œé—®ä¸ªç»†èŠ‚é—®é¢˜ï¼šå°±é¤äººä¸é¤æ¡Œçš„å…³ç³»ä¸æ˜¯åœ¨å¤§å ‚ç»ç†è„‘ä¸­å—ï¼Ÿæ€ä¹ˆå†™åœ¨å°±é¤äººçš„å†…éƒ¨å‘¢ï¼Ÿæ˜¯å› ä¸ºGuardedObjectçš„ç±»æœ¬èº«å……å½“çš„å¤§å ‚ç»ç†è§’è‰²ï¼Œç±»å®ä¾‹å……å½“å°±é¤äººè§’è‰²å—ï¼Ÿ<br>å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œé‚£å¤§å ‚ç»ç†æ˜¯å”¯ä¸€çš„å—ï¼Ÿ<br><br>å›ç­”é—®é¢˜ï¼šæ”¹æˆsleepä¸åŠ é”å°±å˜æˆçº¿ç¨‹ä¸å®‰å…¨çš„å¿™ç­‰å¾…æ¨¡å¼ï¼Œåº”è¯¥ä¸ç¬¦åˆéœ€æ±‚ã€‚","like_count":1,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449430,"discussion_content":"æˆ‘å–œæ¬¢è‡ªå·±æ‰¾åº§ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570709612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353026,"user_name":"é”®ç›˜ä¸Šçš„é­”æœ¯","can_delete":false,"product_type":"c1","uid":2697700,"ip_address":"åŒ—äº¬","ucode":"A731D721FB8D3A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/LFJZ4x47rvShGhsePLIxc8EzdlBxAmVAIjJ2FQZ4NEpo8E4JCZQEOb2NIfOuiaQLL6Otkt7W3Rmu6Tv3AkgYdRA/132","comment_is_top":false,"comment_ctime":1659081476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659081476","product_id":100023901,"comment_content":"é”+wait+notifyæ˜¯ç®¡ç¨‹æ¨¡å‹èŒƒå¼ã€‚ sleepæ²¡æœ‰è¿™ç§ç”¨æ³•ã€‚å…¶å®å•ä»é¡µé¢è§’åº¦è¯´ï¼Œ å¦‚æœç”¨ sleepçš„è¯åˆ°åº•ç¡å¤šå°‘ç§’åˆé€‚å‘¢ï¼Ÿ  å°±çŸ¥é“ç”¨sleepä¸åˆç†äº†","like_count":0},{"had_liked":false,"id":346196,"user_name":"å­¦ä¹ å­¦ä¸ªå±","can_delete":false,"product_type":"c1","uid":1049017,"ip_address":"","ucode":"DF2D61E6FB2FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","comment_is_top":false,"comment_ctime":1652886078,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652886078","product_id":100023901,"comment_content":"sleep ä¸èƒ½è¢«å”¤é†’ï¼Œè€Œä¸”ä¹Ÿå ç”¨èµ„æºã€‚","like_count":0},{"had_liked":false,"id":343971,"user_name":"ä½ä½çœŸå›","can_delete":false,"product_type":"c1","uid":2761438,"ip_address":"","ucode":"CE6E1A08C30DB1","user_header":"https://static001.geekbang.org/account/avatar/00/2a/22/de/1351551d.jpg","comment_is_top":false,"comment_ctime":1651150026,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651150026","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæˆ‘è§‰å¾—è¿™èŠ‚è¯¾æ‚¨ä¸¾å¾—ä¾‹å­ä¸å¤ªåˆé€‚ã€‚<br>ä¸€èˆ¬æ¥è¯´æœåŠ¡è°ƒç”¨æ–¹ã€MQå’ŒæœåŠ¡æä¾›æ–¹æ˜¯åˆ†å¸ƒåœ¨ä¸åŒçš„è¿›ç¨‹é‡Œçš„ã€‚<br>è€Œæ‚¨çš„å®ç°æ˜¯é’ˆå¯¹ä¸€ä¸ªè¿›ç¨‹é‡Œçš„ä¸åŒçº¿ç¨‹æ¥è¯´çš„ã€‚<br>","like_count":0},{"had_liked":false,"id":329942,"user_name":"æˆ‘ æˆ‘ æˆ‘","can_delete":false,"product_type":"c1","uid":1180597,"ip_address":"","ucode":"DB9BC7110A7B3F","user_header":"https://static001.geekbang.org/account/avatar/00/12/03/b5/cf6a5f97.jpg","comment_is_top":false,"comment_ctime":1641665149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641665149","product_id":100023901,"comment_content":"è¿™å„¿ä½¿ç”¨é”ï¼Œ æ˜¯å› ä¸ºæ¶ˆæ¯æ˜¯å¼‚æ­¥çš„ï¼Œ å­˜åœ¨èµ„æºç«äº‰çš„é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":324253,"user_name":"å¤§æ˜çŒ©","can_delete":false,"product_type":"c1","uid":1494622,"ip_address":"","ucode":"61D330B42AE3C4","user_header":"https://static001.geekbang.org/account/avatar/00/16/ce/5e/b103d538.jpg","comment_is_top":false,"comment_ctime":1638349287,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1638349287","product_id":100023901,"comment_content":"çœ‹äº†å¥½å‡ éï¼Œæˆ‘å’‹æ²¡æ„Ÿè§‰åˆ°è¿™ä¸ªæ¨¡å¼çš„ç‰›é€¼ä¹‹å¤„å‘¢ï¼Œå¤§è‡´æ€æƒ³æ˜¯æµè§ˆå™¨è¯·æ±‚éƒ½å‘è¿‡æ¥ï¼Œç„¶åå“ªå„¿ä¸ªè¯·æ±‚å¾—åˆ°ç»“æœå°±ç»™ä»–è¿”å›<br>","like_count":0},{"had_liked":false,"id":266148,"user_name":"LJK","can_delete":false,"product_type":"c1","uid":1199213,"ip_address":"","ucode":"12B2441099FF1D","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","comment_is_top":false,"comment_ctime":1607207641,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607207641","product_id":100023901,"comment_content":"æœ‰ä¸ªé—®é¢˜ï¼Œgetå’ŒonChangeæ–¹æ³•ä¸­ä¸ºä»€ä¹ˆè¦ç”¨RLock? ç”¨æ™®é€šçš„Lockå¯ä»¥å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":260666,"user_name":"xzy","can_delete":false,"product_type":"c1","uid":1002095,"ip_address":"","ucode":"1A44368083A19E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/6f/e36b3908.jpg","comment_is_top":false,"comment_ctime":1605080597,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605080597","product_id":100023901,"comment_content":"ç±»æ¯”ï¼ŒåŠ ä»£ç è®²è§£ï¼Œè€å¸ˆè¿™ç§è®²æ³•ï¼Œå¾ˆèµï¼","like_count":0},{"had_liked":false,"id":233865,"user_name":"delete is create","can_delete":false,"product_type":"c1","uid":1147979,"ip_address":"","ucode":"A8C751219A7746","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/4b/e4738ba8.jpg","comment_is_top":false,"comment_ctime":1594482675,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1594482675","product_id":100023901,"comment_content":"å•æœºå¯ä»¥çš„  ä½†æ˜¯é›†ç¾¤ä¸‹è¿™ç§æ¨¡å¼å°±å¤±æ•ˆäº† <br> ","like_count":0,"discussions":[{"author":{"id":2697700,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/LFJZ4x47rvShGhsePLIxc8EzdlBxAmVAIjJ2FQZ4NEpo8E4JCZQEOb2NIfOuiaQLL6Otkt7W3Rmu6Tv3AkgYdRA/132","nickname":"é”®ç›˜ä¸Šçš„é­”æœ¯","note":"","ucode":"A731D721FB8D3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581940,"discussion_content":"é›†ç¾¤æŠŠå†…å­˜mapæ”¹æˆrediså°±å¥½äº†ï¼Œæ€æƒ³æ˜¯ä¸€æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659079057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195625,"user_name":"Mr.wang","can_delete":false,"product_type":"c1","uid":1224805,"ip_address":"","ucode":"86F341A5316BBC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/65/90387745.jpg","comment_is_top":false,"comment_ctime":1585206399,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1585206399","product_id":100023901,"comment_content":"ä¸è¡Œï¼Œä½¿ç”¨sleepä¸ä¼šé‡Šæ”¾çº¿ç¨‹ï¼Œç›¸å½“äºå ç”¨çº¿ç¨‹ç­‰å¾…ï¼Œä¼šé€ æˆå†…å­˜æº¢å‡ºã€‚","like_count":0},{"had_liked":false,"id":193612,"user_name":"james","can_delete":false,"product_type":"c1","uid":1049208,"ip_address":"","ucode":"5701899403917C","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/78/23c56bce.jpg","comment_is_top":false,"comment_ctime":1584933469,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584933469","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆ, æˆ‘çš„ç†è§£æ˜¯å¦æ­£ç¡®: <br>ä¸€å…± 3 ä¸ªè§’è‰²<br>åº”ç”¨Aå†…è¯·æ±‚å¤„ç†ç±»<br>RocketMQ<br>åº”ç”¨Aå†…å¼‚æ­¥å¤„ç†è¯·æ±‚çš„æ¶ˆè´¹è€…<br><br><br>åº”ç”¨Aå†…è¯·æ±‚å¤„ç†ç±»<br>1. æ¥æ”¶webè¯·æ±‚<br>2. å‘mqæ¶ˆæ¯<br><br>RocketMQ<br>1. æ¥æ”¶æ¶ˆæ¯<br><br><br>åº”ç”¨Aå†…å¼‚æ­¥å¤„ç†è¯·æ±‚çš„æ¶ˆè´¹è€…<br>1. ä»RocketMQæ‹‰å–æ¶ˆæ¯<br>2. å¤„ç†æ¶ˆæ¯<br>3. è¿›è¡Œé€šçŸ¥<br><br><br>åº”ç”¨Aå†…è¯·æ±‚å¤„ç†ç±»<br>1. æ¥åˆ°é€šçŸ¥<br>2. å“åº”å®¢æˆ·ç«¯ - æ•´ä¸ªç»“æŸ","like_count":0},{"had_liked":false,"id":188184,"user_name":"Evan","can_delete":false,"product_type":"c1","uid":1344281,"ip_address":"","ucode":"B877ABD0CF4661","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/19/0a3fe8c1.jpg","comment_is_top":false,"comment_ctime":1584327305,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1584327305","product_id":100023901,"comment_content":"ä¸åŠ é”ï¼Œæ²¡åŠæ³•ä¿è¯ä»£ç åŸå­æ€§ã€å¯è§æ€§ã€‚å­˜åœ¨ç«æ€æ¡ä»¶çš„é—®é¢˜","like_count":0},{"had_liked":false,"id":183389,"user_name":"æ—…é€”","can_delete":false,"product_type":"c1","uid":1212902,"ip_address":"","ucode":"5022477E8E9441","user_header":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","comment_is_top":false,"comment_ctime":1583032167,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583032167","product_id":100023901,"comment_content":"è¿™æ®µä»£ç  ç”±äºä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªé”å¯¹è±¡ æ˜¯ä¸²è¡Œçš„ æ‰€ä»¥æ˜¯ä¸æ˜¯å¯ä»¥æŠŠ é”å’Œæ¡ä»¶å¯¹è±¡ ä¹Ÿä½¿ç”¨æˆæ¯ä¸ªæ¶ˆæ¯ä¸€ä»½ è¿›è¡Œä¼˜åŒ–?","like_count":0},{"had_liked":false,"id":173235,"user_name":"ä¹¦ä¸­è¿·æ¢¦","can_delete":false,"product_type":"c1","uid":1103010,"ip_address":"","ucode":"1C6B697F41698F","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/a2/fa41c8a8.jpg","comment_is_top":false,"comment_ctime":1579483186,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579483186","product_id":100023901,"comment_content":"è€å¸ˆè¿™ä¸ªç¤ºä¾‹åˆ—ä¸¾çš„ä¸å¤ªä¸¥è°¨ï¼Œåœ¨å•æœºæƒ…å†µæ˜¯ï¼Œæ–‡ä¸­è¯´çš„æ²¡é—®é¢˜ï¼Œä½†æ˜¯åˆ°äº†åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œé¢ï¼Œå°±ä¼šå¯¼è‡´ï¼Œæœ‰çš„é€šçŸ¥äº†ä½†æ˜¯è¯¥èŠ‚ç‚¹å¹¶æ²¡æœ‰é˜»å¡é˜Ÿåˆ—","like_count":0},{"had_liked":false,"id":168274,"user_name":"Cv","can_delete":false,"product_type":"c1","uid":1062797,"ip_address":"","ucode":"C77CE172B5AA28","user_header":"","comment_is_top":false,"comment_ctime":1578040553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578040553","product_id":100023901,"comment_content":"ç­‰å¾…çº¿ç¨‹å’Œå›æ‰§çº¿ç¨‹æ˜¯ä¸¤ä¸ªçº¿ç¨‹, å¯è§æ€§å¯ä»¥é€šè¿‡æ·»åŠ volatileè§£å†³, ä½†æ˜¯ä¸åŠ é”ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜: p.test(obj)æ‰§è¡Œè¿‡ç¨‹ä¸­objè¢«æ”¹å˜äº†å¯èƒ½ä¼šæœ‰æœªçŸ¥é—®é¢˜.<br>","like_count":0},{"had_liked":false,"id":165212,"user_name":"anotherJJz","can_delete":false,"product_type":"c1","uid":1547742,"ip_address":"","ucode":"260F4B125D20FB","user_header":"https://static001.geekbang.org/account/avatar/00/17/9d/de/90c1ddf4.jpg","comment_is_top":false,"comment_ctime":1577180110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577180110","product_id":100023901,"comment_content":"æƒ³è¯·é—®ä¸€ä¸‹ï¼Œé€šå¸¸æœ¬åœ°çš„onMessageæ–¹æ³•ï¼Œæ€ä¹ˆæš´éœ²ç»™å¤–éƒ¨çš„æœåŠ¡è°ƒç”¨ï¼Ÿ","like_count":0},{"had_liked":false,"id":161002,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1576076312,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576076312","product_id":100023901,"comment_content":"JavaæœåŠ¡æ¥æ”¶è¯·æ±‚ï¼Œå¤„ç†ï¼Œå“åº”æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥å˜åŒæ­¥çš„è¿‡ç¨‹ã€‚<br><br>å¤šçº¿ç¨‹å¤„ç†ï¼Œå¯¹äºå®¢æˆ·ç«¯è€Œè¨€æ˜¯åŒæ­¥çš„ã€‚","like_count":0},{"had_liked":false,"id":148631,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1573041396,"is_pvip":false,"replies":[{"id":"57431","content":"é™¤äº†è¿™ä¸ªåŠæ³•å¥½åƒæ²¡åˆ«çš„åŠæ³•äº†ğŸ˜‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1573217058,"ip_address":"","comment_id":148631,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1573041396","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆï¼ŒçœŸæ­£æ¶ˆæ¯é˜Ÿåˆ—çš„è¯·æ±‚ä¸­ï¼Œå¦‚æœæ˜¯éœ€è¦æœ‰æ¶ˆæ¯å¤„ç†è¿”å›å€¼çš„æƒ…å†µï¼Œå°±æ˜¯é‡‡ç”¨è¿™ç§æ¨¡å¼å®ç°çš„å—ï¼Œä¾‹å¦‚RabbitMQ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473559,"discussion_content":"é™¤äº†è¿™ä¸ªåŠæ³•å¥½åƒæ²¡åˆ«çš„åŠæ³•äº†ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573217058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1818343,"avatar":"","nickname":"åˆ˜åŒé’","note":"","ucode":"84B62DF8BC61FB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281627,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591780131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137457,"user_name":"Sharry","can_delete":false,"product_type":"c1","uid":1239293,"ip_address":"","ucode":"045DDB864659F6","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/fd/035f4c94.jpg","comment_is_top":false,"comment_ctime":1569745685,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569745685","product_id":100023901,"comment_content":"çœ‹äº†è¿™ç¯‡æ–‡ç« ä¹‹åæ‰å‘ç°, åœ¨ä½¿ç”¨ç®¡ç¨‹è§£å†³å¹¶å‘ç¼–ç¨‹çš„åä½œé—®é¢˜æ—¶, Guarded Suspension æ¨¡å‹å‡ ä¹æ— å¤„ä¸åœ¨, å®ƒå¤ªå¸¸ç”¨äº†, æ²¡æƒ³åˆ°å®ƒå±…ç„¶å·²ç»æŠ½è±¡æˆä¸€ç§ç¼–ç¨‹æ¨¡å¼. ","like_count":0},{"had_liked":false,"id":126701,"user_name":"æ–‡","can_delete":false,"product_type":"c1","uid":1090847,"ip_address":"","ucode":"E2DBA62248052E","user_header":"https://static001.geekbang.org/account/avatar/00/10/a5/1f/d2f6a1f7.jpg","comment_is_top":false,"comment_ctime":1566453417,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"1566453417","product_id":100023901,"comment_content":"while å¯ä¸å¯ä»¥æ¢æˆ ifï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2697700,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/LFJZ4x47rvShGhsePLIxc8EzdlBxAmVAIjJ2FQZ4NEpo8E4JCZQEOb2NIfOuiaQLL6Otkt7W3Rmu6Tv3AkgYdRA/132","nickname":"é”®ç›˜ä¸Šçš„é­”æœ¯","note":"","ucode":"A731D721FB8D3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581941,"discussion_content":"è¿›å…¥wait()ç„¶åè¢«notify()åï¼Œéœ€è¦å†åˆ¤æ–­ä¸€æ¬¡å½“å‰æ˜¯å¦æ¡ä»¶æ»¡è¶³äº†ã€‚ ifçš„è¯å°±ä¸ä¼šå†åˆ¤æ–­äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659079363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1670763,"avatar":"https://static001.geekbang.org/account/avatar/00/19/7e/6b/36fc4516.jpg","nickname":"FIRE","note":"","ucode":"85861D990FB3AB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326713,"discussion_content":"ä¸è¡Œ,å¤§æ¦‚æ˜¯ä¸èƒ½å¾ªç¯äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605666424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135912,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","nickname":"é»‘è‰²æ¯›è¡£","note":"","ucode":"FF7E235F91BA5C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57586,"discussion_content":"ä¸è¡Œï¼Œåˆ«å‚»äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574617176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1039466,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/dc/6a/b5478b65.jpg","nickname":"Ab","note":"","ucode":"8E9261782F025D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6278,"discussion_content":"ä¸å¯ä»¥ï¼Œè¿™ä¸ªæ˜¯èŒƒå¼ï¼Œå‰é¢ç« èŠ‚å°†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566820341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117535,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1564069250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564069250","product_id":100023901,"comment_content":"è€å¸ˆï¼Œçº¿ç¨‹t1éœ€è¦é˜»å¡ç­‰å¾…æ¶ˆæ¯å¯¹åˆ—è¿”å›ç»“æœä¹ˆ","like_count":0},{"had_liked":false,"id":105750,"user_name":"xuery","can_delete":false,"product_type":"c1","uid":1027584,"ip_address":"","ucode":"F461B61BE06131","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg","comment_is_top":false,"comment_ctime":1561080744,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1561080744","product_id":100023901,"comment_content":"ä¸å¯¹ï¼Œæ€»ç»“æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š<br>1.ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œå³ä½¿whileä¸æ»¡æ„æ¡ä»¶äº†ï¼Œsleepè¿˜æ˜¯ä¼šç»§ç»­ç­‰å¾…é‚£ä¹ˆå¤šæ—¶é—´<br>2.æ²¡æœ‰é”å°±æ— æ³•ä¿è¯objå¯¹è±¡çš„å¯è§æ€§<br>3.å¦‚æœæ¶ˆè´¹å¤±è´¥ï¼Œåˆ™ä¼šä¸€ç›´sleep","like_count":0},{"had_liked":false,"id":97463,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1558676156,"is_pvip":false,"replies":[{"id":"34879","content":"websocketå¯ä»¥å—ï¼Œæ²¡äº†è§£åˆ°ä½ è¯´çš„éš¾ç‚¹åœ¨å“ªé‡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558699719,"ip_address":"","comment_id":97463,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558676156","product_id":100023901,"comment_content":"æƒ³é—®ä¸€ä¸‹åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œå¼‚æ­¥è½¬åŒæ­¥çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿä¾‹å¦‚ï¼Œæ•°æ®æœåŠ¡éƒ¨ç½²å¤šä¸ªinstanceï¼Œå®¢æˆ·åœ¨Web UIä¸Šç‚¹å‡»å¤–éƒ¨æ•°æ®æºè¯•ç”¨ï¼Œåç«¯é€šè¿‡ä¸€ä¸ªæ•°æ®æœåŠ¡instanceè¯·æ±‚å¤–éƒ¨æ•°æ®æºï¼Œå¤–éƒ¨æ•°æ®æºä¼šå¼‚æ­¥å›è°ƒç»“æœ(LBåœ°å€)è¿”å›ï¼Œæ€ä¹ˆæ ·å°†ç»“æœæ˜¾ç¤ºåœ¨è¯·æ±‚æ•°æ®æœåŠ¡çš„Web UIä¸Š? å®¢æˆ·è¯•ç”¨çš„è¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œä½†è¯·æ±‚å¤–éƒ¨æ•°æ®æºæ“ä½œæµç¨‹æ˜¯å¼‚æ­¥çš„ã€‚è°¢è°¢ï¼","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451286,"discussion_content":"websocketå¯ä»¥å—ï¼Œæ²¡äº†è§£åˆ°ä½ è¯´çš„éš¾ç‚¹åœ¨å“ªé‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558699719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96101,"user_name":"andy","can_delete":false,"product_type":"c1","uid":1063321,"ip_address":"","ucode":"F03BE5E20B471C","user_header":"https://static001.geekbang.org/account/avatar/00/10/39/99/42929758.jpg","comment_is_top":false,"comment_ctime":1558331217,"is_pvip":false,"replies":[{"id":"34432","content":"å‰è€…","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558357971,"ip_address":"","comment_id":96101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558331217","product_id":100023901,"comment_content":"æˆ‘æœ‰ä¸ªç–‘æƒ‘å°±æ˜¯ï¼Œè¿™é‡Œæ‰€è¯´çš„MQå¯ä»¥æ˜¯RabittMQæˆ–è€…æ˜¯å…¶ä»–ç±»å‹çš„MQå—ï¼Ÿè¿˜æ˜¯è¯´è¿™ä¸ªMQå…¶å®å°±JAVAä¸­çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450720,"discussion_content":"å‰è€…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558357971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95879,"user_name":"ä¸‰æœ¨ç¦¾","can_delete":false,"product_type":"c1","uid":1109458,"ip_address":"","ucode":"39C37228236860","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg","comment_is_top":false,"comment_ctime":1558240174,"is_pvip":false,"replies":[{"id":"34354","content":"onmessageè°ƒç”¨ onchange,ä»–ä»¬æ˜¯ä¸¤ä¸ªç±»é‡Œçš„æ–¹æ³•","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1558313729,"ip_address":"","comment_id":95879,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558240174","product_id":100023901,"comment_content":"è€å¸ˆï¼Œæ‚¨è¿™ä»£ç èƒ½ä¸èƒ½å†™çš„å®Œæ•´ä¸€ç‚¹å•Šï¼Œå‰é¢æœ‰ä¸ªonMessage ,åé¢æœ‰ä¸ªonChange","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450626,"discussion_content":"onmessageè°ƒç”¨ onchange,ä»–ä»¬æ˜¯ä¸¤ä¸ªç±»é‡Œçš„æ–¹æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558313729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94786,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1557897802,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557897802","product_id":100023901,"comment_content":"await(timeout);  æœ¬æ¥æ˜¯å»ç­‰å¾…é˜Ÿåˆ—é‡Œé¢å‘†timeouté•¿çš„æ—¶é—´ï¼Œå¦‚æœåˆ°timeoutä¹‹å‰æ²¡æœ‰è¢«signalå°±å‡ºé˜Ÿ;å¦‚æœè¢«signaläº†å°±æ˜¯æœºåˆ¶çš„æ­£å¸¸è¿è¡Œã€‚æœ€ç»ˆéƒ½return obj;<br><br>sleep(timeout);  å®ˆæŠ¤æ¡ä»¶ä¸æˆç«‹å°±sleep timeout, è¿˜ä¸æˆç«‹å†sleep timeout, â€¦ å¦‚æœåœ¨å‘ç”Ÿæ­»é”æˆ–è€…onchangeå¤±è´¥çš„æƒ…å†µä¸‹ï¼Œ get()æ–¹æ³•ä¼šå› ä¸ºçŠ¶æ€æ”¹å˜çš„å¤±è´¥è€Œä¸€ç›´ åˆ¤æ–­ sleepä¸‹å» â€¦â€¦ <br>è€å¸ˆæˆ‘è¿™é‡Œæ·»åŠ äº†æ­»é”ï¼Œä¸çŸ¥é“è¯´çš„å¯¹ä¸å¯¹å•Šï¼Œæ³è¯·è€å¸ˆå›å¤ã€‚<br><br>è¿˜æœ‰ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡åŠæ³•ç”¨è¿™ç§ç‹¬åˆ°çš„çœ¼åŠ›å»å¥—ç”¨ä¸€äº›æ¡†æ¶ä»£ç çš„ç›¸ä¼¼å¤„å•Š? æ˜¯çŸ¥é“çš„å¤ªå°‘äº†å˜›ï¼Ÿ ","like_count":0},{"had_liked":false,"id":94488,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1557823468,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557823468","product_id":100023901,"comment_content":"sleepæ–¹æ³•ï¼ŒsleepæœŸé—´ï¼Œä¸ä¼šé‡Šæ”¾å¯¹è±¡çš„é”ï¼Œçº¿ç¨‹T1æ‰§è¡Œgetï¼Œè·å–çš„lockåœ¨sleepæœŸé—´ä»–çš„é”ä¸ä¼šé‡Šæ”¾ï¼Œå¦‚æœt2çº¿ç¨‹å»æ‰§è¡Œonchangedæ–¹æ³•ï¼Œè¿™æ—¶å€™è·å–ä¸åˆ°lockçš„é”çš„ï¼Œä¼šå¯¼è‡´ç¨‹åºæ­»é”ï¼Œ<br>awaitæ–¹æ³•ï¼Œçº¿ç¨‹T1æ‰§è¡Œget,åœ¨ç­‰å¾…æœŸé—´ï¼Œä»–ä¼šé‡Šæ”¾æ‰é”ï¼Œè¿™æ—¶t2æ‰§è¡Œonchangedï¼Œå¯ä»¥è·å–åˆ°lockç„¶åç»™objèµ‹å€¼ï¼Œget1å°±å¯ä»¥è·å–åˆ°æœ€æ–°çš„obj<br><br>å¯¹äºreentrantlockï¼Œæ‰§è¡Œlockåï¼Œå¦‚æœä¸é‡Šæ”¾unlockï¼Œæ‰§è¡Œäº†awaitï¼Œå…¶ä»–çº¿ç¨‹è¿˜æ˜¯å¯ä»¥è·å–åˆ°lock","like_count":0},{"had_liked":false,"id":94476,"user_name":"ä½‘å„¿","can_delete":false,"product_type":"c1","uid":1226196,"ip_address":"","ucode":"0629888E7A5E16","user_header":"https://static001.geekbang.org/account/avatar/00/12/b5/d4/3bd5b77b.jpg","comment_is_top":false,"comment_ctime":1557821131,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557821131","product_id":100023901,"comment_content":"å­¦ä¹ å¿ƒå¾—ï¼šæ¯ä¸€ç§è®¾è®¡æ¨¡å¼éƒ½é€‚åº”æŸç§åœºæ™¯ï¼Œä¸ªäººè®¤ä¸ºGuarded Suspensionæ¨¡å¼çš„æ ¹æœ¬åœ¨äºgetæ•°æ®çš„æ—¶å€™ä¸€å®šèƒ½å¤Ÿè·å–ï¼Œå¦‚æœè·å–ä¸åˆ°å°±ç­‰å¾…ï¼Œä¿æŠ¤æ€§æš‚åœä¹Ÿå°±æ˜¯è¿™ä¸ªæ„æ€ï¼Œé˜»å¡é˜Ÿåˆ—å¤§éƒ¨åˆ†éƒ½æ˜¯è¿™ç§æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":94350,"user_name":"Kaleidoscoper","can_delete":false,"product_type":"c1","uid":1031741,"ip_address":"","ucode":"E705716641B08F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/3d/b782c7a5.jpg","comment_is_top":false,"comment_ctime":1557794428,"is_pvip":false,"replies":[{"id":"33939","content":"çº¿ç¨‹å®‰å…¨çš„å®¹å™¨èƒ½é¿å…ä½ è¯´çš„è¿™ç§æƒ…å†µ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557930666,"ip_address":"","comment_id":94350,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557794428","product_id":100023901,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆï¼ŒCreateå’ŒfireEventæ–¹æ³•ä¸åŠ é”å¯ä»¥ä¹ˆï¼ŒåƒCreateæ–¹æ³•ä¸åŠ é”æŒ‡ä»¤é‡æ’ä¼˜åŒ–ï¼Œå…ˆè¿”å›objectå†åŠ è¿›mapé‡Œä¼šä¸ä¼šæœ‰é—®é¢˜","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450032,"discussion_content":"çº¿ç¨‹å®‰å…¨çš„å®¹å™¨èƒ½é¿å…ä½ è¯´çš„è¿™ç§æƒ…å†µ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557930666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93252,"user_name":"æ›¾è½¼éºŸ","can_delete":false,"product_type":"c1","uid":1451391,"ip_address":"","ucode":"D418371AC11270","user_header":"https://static001.geekbang.org/account/avatar/00/16/25/7f/473d5a77.jpg","comment_is_top":false,"comment_ctime":1557448076,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557448076","product_id":100023901,"comment_content":"sleepä¼šæ— æ³•å”¤é†’å¯¼è‡´è¶…æ—¶ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨æ—¶é—´è½®HashTimeWheelçš„æ–¹å¼å»è®¾ç½®æ¯ä¸€æ¬¡è¯·æ±‚çš„è¶…æ—¶æ—¶é—´","like_count":0},{"had_liked":false,"id":93171,"user_name":"å›å“¥èŠæŠ€æœ¯","can_delete":false,"product_type":"c1","uid":1325816,"ip_address":"","ucode":"2C9A22BCE4C79E","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/f8/c1a939e7.jpg","comment_is_top":false,"comment_ctime":1557413516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557413516","product_id":100023901,"comment_content":"è€å¸ˆï¼Œå†é—®ä¸€ä¸‹ï¼Œå¦‚æœä¸ç”¨é”ï¼Œä¹Ÿä¸ç”¨awaitï¼Œnotifyï¼Œå°±ç”¨sleepï¼Œè·Ÿæœ€åä¸€æ®µä»£ç ä¸€æ ·ã€‚<br>åœ¨testæ–¹æ³•ä¸­åŠ objæ£€éªŒï¼Œé™¤äº†sleepå”¤é†’é—®é¢˜å¤–ï¼Œä¼šæœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":93149,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1557408149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557408149","product_id":100023901,"comment_content":"æ‰“å¡ï¼","like_count":0},{"had_liked":false,"id":92916,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1557364637,"is_pvip":false,"replies":[{"id":"33211","content":"ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥è·å–ä¸åˆ°<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å®ä»¤","uid":"1269969","ctime":1557411956,"ip_address":"","comment_id":92916,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557364637","product_id":100023901,"comment_content":"è¯·é—®è€å¸ˆMQä¸æ˜¯å¯ä»¥ç‚¹å¯¹ç‚¹å—ï¼Œé‚£æœåŠ¡æä¾›æ–¹ä¸å¯ä»¥æŒ‡å®šæ¶ˆè´¹æŸæ¡æ¶ˆæ¯å—ï¼Œè¿™æ ·çº¿ç¨‹Tæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥è·å¾—MQè¿”å›çš„ç»“æœ","like_count":0,"discussions":[{"author":{"id":1269969,"avatar":"https://static001.geekbang.org/account/avatar/00/13/60/d1/8efa89ab.jpg","nickname":"ç‹å®ä»¤","note":"","ucode":"4FE19F5BC32FCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449424,"discussion_content":"ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥è·å–ä¸åˆ°\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557411956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92899,"user_name":"kyle","can_delete":false,"product_type":"c1","uid":1179158,"ip_address":"","ucode":"DB05C0F7D2C472","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/16/0f096793.jpg","comment_is_top":false,"comment_ctime":1557363120,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557363120","product_id":100023901,"comment_content":"Java8çš„æ— æ³•çš„è¡¥è¡¥ï¼ğŸ˜°","like_count":0},{"had_liked":false,"id":92889,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1557362181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557362181","product_id":100023901,"comment_content":"ç­‰å¾…ä¸ç¡®å®šæ—¶å“ªä¸ªçº¿ç¨‹æˆåŠŸï¼Œç­‰å¾…æ—¶é—´å›ºå®šï¼Œä¸ç²¾ç¡®","like_count":0}]}