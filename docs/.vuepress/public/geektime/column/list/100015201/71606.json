{"id":71606,"title":"47 | ç»ä¸ä»…ä»…æ˜¯å®‰å…¨ï¼šKata Containers ä¸ gVisor","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šç»ä¸ä»…ä»…æ˜¯å®‰å…¨ä¹‹Kata Containers ä¸ gVisorã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†åœ°è®²è§£äº† kubelet å’Œ CRI çš„è®¾è®¡å’Œå…·ä½“çš„å·¥ä½œåŸç†ã€‚è€Œåœ¨è®²è§£ CRI çš„è¯ç”ŸèƒŒæ™¯æ—¶ï¼Œæˆ‘ä¹Ÿæåˆ°è¿‡ï¼Œè¿™å…¶ä¸­çš„ä¸€ä¸ªé‡è¦æ¨åŠ¨åŠ›ï¼Œå°±æ˜¯åŸºäºè™šæ‹ŸåŒ–æˆ–è€…ç‹¬ç«‹å†…æ ¸çš„å®‰å…¨å®¹å™¨é¡¹ç›®çš„é€æ¸æˆç†Ÿã€‚</p><p>ä½¿ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯æ¥åšä¸€ä¸ªåƒ Docker ä¸€æ ·çš„å®¹å™¨é¡¹ç›®ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°é²œçš„ä¸»æ„ã€‚æ—©åœ¨ Docker é¡¹ç›®å‘å¸ƒä¹‹åï¼ŒGoogle å…¬å¸å°±å¼€æºäº†ä¸€ä¸ªå®éªŒæ€§çš„é¡¹ç›®ï¼Œå«ä½œ novmã€‚è¿™ï¼Œå¯ä»¥ç®—æ˜¯è¯•å›¾ä½¿ç”¨å¸¸è§„çš„è™šæ‹ŸåŒ–æŠ€æœ¯æ¥è¿è¡Œ Docker é•œåƒçš„ç¬¬ä¸€æ¬¡å°è¯•ã€‚ä¸è¿‡ï¼Œnovm åœ¨å¼€æºåä¸ä¹…ï¼Œå°±è¢«æ”¾å¼ƒäº†ï¼Œè¿™å¯¹äº Google å…¬å¸æ¥è¯´æˆ–è®¸ä¸ç®—æ˜¯ä»€ä¹ˆæ–°é²œäº‹ï¼Œä½†æ˜¯ novm çš„æ˜™èŠ±ä¸€ç°ï¼Œè¿˜æ˜¯æ¿€å‘å‡ºäº†å¾ˆå¤šå†…æ ¸å¼€å‘è€…çš„çµæ„Ÿã€‚</p><p>æ‰€ä»¥åœ¨2015å¹´ï¼Œå‡ ä¹åœ¨åŒä¸€ä¸ªæ˜ŸæœŸï¼ŒIntel OTC ï¼ˆOpen Source Technology Centerï¼‰ å’Œå›½å†…çš„ HyperHQ å›¢é˜ŸåŒæ—¶å¼€æºäº†ä¸¤ä¸ªåŸºäºè™šæ‹ŸåŒ–æŠ€æœ¯çš„å®¹å™¨å®ç°ï¼Œåˆ†åˆ«å«åš Intel Clear Container å’Œ runV é¡¹ç›®ã€‚</p><p>è€Œåœ¨2017å¹´ï¼Œå€Ÿç€ Kubernetes çš„ä¸œé£ï¼Œè¿™ä¸¤ä¸ªç›¸ä¼¼çš„å®¹å™¨è¿è¡Œæ—¶é¡¹ç›®åœ¨ä¸­ç«‹åŸºé‡‘ä¼šçš„æ’®åˆä¸‹æœ€ç»ˆåˆå¹¶ï¼Œå°±æˆäº†ç°åœ¨å¤§å®¶è€³ç†Ÿèƒ½è¯¦çš„ Kata Containers é¡¹ç›®ã€‚ ç”±äº Kata Containers çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç²¾ç®€åçš„è½»é‡çº§è™šæ‹Ÿæœºï¼Œæ‰€ä»¥å®ƒçš„ç‰¹ç‚¹ï¼Œå°±æ˜¯â€œåƒè™šæ‹Ÿæœºä¸€æ ·å®‰å…¨ï¼Œåƒå®¹å™¨ä¸€æ ·æ•æ·â€ã€‚</p><!-- [[[read_end]]] --><p>è€Œåœ¨2018å¹´ï¼ŒGoogle å…¬å¸åˆ™å‘å¸ƒäº†ä¸€ä¸ªåå« gVisor çš„é¡¹ç›®ã€‚gVisor é¡¹ç›®ç»™å®¹å™¨è¿›ç¨‹é…ç½®ä¸€ä¸ªç”¨ Go è¯­è¨€å®ç°çš„ã€è¿è¡Œåœ¨ç”¨æˆ·æ€çš„ã€æå°çš„â€œç‹¬ç«‹å†…æ ¸â€ã€‚è¿™ä¸ªå†…æ ¸å¯¹å®¹å™¨è¿›ç¨‹æš´éœ² Linux å†…æ ¸ ABIï¼Œæ‰®æ¼”ç€â€œGuest Kernelâ€çš„è§’è‰²ï¼Œä»è€Œè¾¾åˆ°äº†å°†å®¹å™¨å’Œå®¿ä¸»æœºéš”ç¦»å¼€çš„ç›®çš„ã€‚</p><p>ä¸éš¾çœ‹åˆ°ï¼Œæ— è®ºæ˜¯ Kata Containersï¼Œè¿˜æ˜¯ gVisorï¼Œå®ƒä»¬å®ç°å®‰å…¨å®¹å™¨çš„æ–¹æ³•å…¶å®æ˜¯æ®Šé€”åŒå½’çš„ã€‚è¿™ä¸¤ç§å®¹å™¨å®ç°çš„æœ¬è´¨ï¼Œéƒ½æ˜¯ç»™è¿›ç¨‹åˆ†é…äº†ä¸€ä¸ªç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä»è€Œé¿å…äº†è®©å®¹å™¨å…±äº«å®¿ä¸»æœºçš„å†…æ ¸ã€‚è¿™æ ·ï¼Œå®¹å™¨è¿›ç¨‹èƒ½å¤Ÿçœ‹åˆ°çš„æ”»å‡»é¢ï¼Œå°±ä»æ•´ä¸ªå®¿ä¸»æœºå†…æ ¸å˜æˆäº†ä¸€ä¸ªæå°çš„ã€ç‹¬ç«‹çš„ã€ä»¥å®¹å™¨ä¸ºå•ä½çš„å†…æ ¸ï¼Œä»è€Œæœ‰æ•ˆè§£å†³äº†å®¹å™¨è¿›ç¨‹å‘ç”Ÿâ€œé€ƒé€¸â€æˆ–è€…å¤ºå–æ•´ä¸ªå®¿ä¸»æœºçš„æ§åˆ¶æƒçš„é—®é¢˜ã€‚è¿™ä¸ªåŸç†ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„ç¤ºæ„å›¾æ¥è¡¨ç¤ºæ¸…æ¥šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/95/1d/959c4c40c767acb6a3ffe6e144202e1d.png?wh=1108*783\" alt=\"\"></p><p>è€Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼ŒKata Containers ä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿçš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œé€šè¿‡è™šæ‹Ÿç¡¬ä»¶æ¨¡æ‹Ÿå‡ºäº†ä¸€å°â€œå°è™šæ‹Ÿæœºâ€ï¼Œç„¶ååœ¨è¿™ä¸ªå°è™šæ‹Ÿæœºé‡Œå®‰è£…äº†ä¸€ä¸ªè£å‰ªåçš„ Linux å†…æ ¸æ¥å®ç°å¼ºéš”ç¦»ã€‚</p><p>è€Œ gVisor çš„åšæ³•åˆ™æ›´åŠ æ¿€è¿›ï¼ŒGoogle çš„å·¥ç¨‹å¸ˆç›´æ¥ç”¨ Go è¯­è¨€â€œæ¨¡æ‹Ÿâ€å‡ºäº†ä¸€ä¸ªè¿è¡Œåœ¨ç”¨æˆ·æ€çš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œç„¶åé€šè¿‡è¿™ä¸ªæ¨¡æ‹Ÿçš„å†…æ ¸æ¥ä»£æ›¿å®¹å™¨è¿›ç¨‹å‘å®¿ä¸»æœºå‘èµ·æœ‰é™çš„ã€å¯æ§çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±æ¥ä¸ºä½ è¯¦ç»†è§£è¯»ä¸€ä¸‹ KataContainers å’Œ gVisor å…·ä½“çš„è®¾è®¡åŸç†ã€‚</p><p><strong>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ KataContainers</strong>ã€‚å®ƒçš„å·¥ä½œåŸç†å¯ä»¥ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„ç¤ºæ„å›¾æ¥æè¿°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8d/89/8d7bbc8acaf27adff890f0be637df889.png?wh=1876*514\" alt=\"\"></p><p>æˆ‘ä»¬å‰é¢è¯´è¿‡ï¼ŒKata Containers çš„æœ¬è´¨ï¼Œå°±æ˜¯ä¸€ä¸ªè½»é‡åŒ–è™šæ‹Ÿæœºã€‚æ‰€ä»¥å½“ä½ å¯åŠ¨ä¸€ä¸ª Kata Containers ä¹‹åï¼Œä½ å…¶å®å°±ä¼šçœ‹åˆ°ä¸€ä¸ªæ­£å¸¸çš„è™šæ‹Ÿæœºåœ¨è¿è¡Œã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿæœºç®¡ç†ç¨‹åºï¼ˆVirtual Machine Manager, VMMï¼‰æ˜¯è¿è¡Œ Kata Containers å¿…å¤‡çš„ä¸€ä¸ªç»„ä»¶ã€‚åœ¨æˆ‘ä»¬ä¸Šé¢å›¾ä¸­ï¼Œä½¿ç”¨çš„ VMM å°±æ˜¯ Qemuã€‚</p><p>è€Œä½¿ç”¨äº†è™šæ‹Ÿæœºä½œä¸ºè¿›ç¨‹çš„éš”ç¦»ç¯å¢ƒä¹‹åï¼ŒKata Containers åŸç”Ÿå°±å¸¦æœ‰äº† Pod çš„æ¦‚å¿µã€‚å³ï¼šè¿™ä¸ªKata Containers å¯åŠ¨çš„è™šæ‹Ÿæœºï¼Œå°±æ˜¯ä¸€ä¸ª Podï¼›è€Œç”¨æˆ·å®šä¹‰çš„å®¹å™¨ï¼Œå°±æ˜¯è¿è¡Œåœ¨è¿™ä¸ªè½»é‡çº§è™šæ‹Ÿæœºé‡Œçš„è¿›ç¨‹ã€‚åœ¨å…·ä½“å®ç°ä¸Šï¼ŒKata Containers çš„è™šæ‹Ÿæœºé‡Œä¼šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ Init è¿›ç¨‹è´Ÿè´£ç®¡ç†è™šæ‹Ÿæœºé‡Œé¢çš„ç”¨æˆ·å®¹å™¨ï¼Œå¹¶ä¸”åªä¸ºè¿™äº›å®¹å™¨å¼€å¯ Mount Namespaceã€‚æ‰€ä»¥ï¼Œè¿™äº›ç”¨æˆ·å®¹å™¨ä¹‹é—´ï¼ŒåŸç”Ÿå°±æ˜¯å…±äº« Network ä»¥åŠå…¶ä»–Namespace çš„ã€‚</p><p>æ­¤å¤–ï¼Œä¸ºäº†è·Ÿä¸Šå±‚ç¼–æ’æ¡†æ¶æ¯”å¦‚ Kubernetes è¿›è¡Œå¯¹æ¥ï¼ŒKata Containers é¡¹ç›®ä¼šå¯åŠ¨ä¸€ç³»åˆ—è·Ÿç”¨æˆ·å®¹å™¨å¯¹åº”çš„ shim è¿›ç¨‹ï¼Œæ¥è´Ÿè´£æ“ä½œè¿™äº›ç”¨æˆ·å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚å½“ç„¶ï¼Œè¿™äº›æ“ä½œï¼Œå®é™…ä¸Šè¿˜æ˜¯è¦é è™šæ‹Ÿæœºé‡Œçš„ Init è¿›ç¨‹æ¥å¸®ä½ åšåˆ°ã€‚</p><p>è€Œåœ¨å…·ä½“çš„æ¶æ„ä¸Šï¼ŒKata Containersçš„å®ç°æ–¹å¼åŒä¸€ä¸ªæ­£å¸¸çš„è™šæ‹Ÿæœºå…¶å®ä¹Ÿéå¸¸ç±»ä¼¼ã€‚è¿™é‡Œçš„åŸç†ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„ä¸€å¹…ç¤ºæ„å›¾æ¥è¡¨ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/16/f3/1684d0d89c170c2f8e6d050919c883f3.jpg?wh=2284*1900\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ Kata Containers è¿è¡Œèµ·æ¥ä¹‹åï¼Œè™šæ‹Ÿæœºé‡Œçš„ç”¨æˆ·è¿›ç¨‹ï¼ˆå®¹å™¨ï¼‰ï¼Œå®é™…ä¸Šåªèƒ½çœ‹åˆ°è™šæ‹Ÿæœºé‡Œçš„ã€è¢«è£å‡è¿‡çš„ Guest Kernelï¼Œä»¥åŠé€šè¿‡ Hypervisor è™šæ‹Ÿå‡ºæ¥çš„ç¡¬ä»¶è®¾å¤‡ã€‚</p><p>è€Œä¸ºäº†èƒ½å¤Ÿå¯¹è¿™ä¸ªè™šæ‹Ÿæœºçš„ I/O æ€§èƒ½è¿›è¡Œä¼˜åŒ–ï¼ŒKata Containers ä¹Ÿä¼šé€šè¿‡ vhost æŠ€æœ¯ï¼ˆæ¯”å¦‚ï¼švhost-userï¼‰æ¥å®ç° Guest ä¸ Host ä¹‹é—´çš„é«˜æ•ˆçš„ç½‘ç»œé€šä¿¡ï¼Œå¹¶ä¸”ä½¿ç”¨ PCI Passthrough ï¼ˆPCI ç©¿é€ï¼‰æŠ€æœ¯æ¥è®© Guest é‡Œçš„è¿›ç¨‹ç›´æ¥è®¿é—®åˆ°å®¿ä¸»æœºä¸Šçš„ç‰©ç†è®¾å¤‡ã€‚è¿™äº›æ¶æ„è®¾è®¡ä¸å®ç°ï¼Œå…¶å®è·Ÿå¸¸è§„è™šæ‹Ÿæœºçš„ä¼˜åŒ–æ‰‹æ®µæ˜¯åŸºæœ¬ä¸€è‡´çš„ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒgVisor çš„è®¾è®¡å…¶å®è¦æ›´åŠ â€œæ¿€è¿›â€ä¸€äº›ã€‚å®ƒçš„åŸç†ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„ç¤ºæ„å›¾æ¥è¡¨ç¤ºæ¸…æ¥šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2f/7b/2f7903a7c494ddf6989d00c794bd7a7b.png?wh=1082*298\" alt=\"\"></p><p>gVisorå·¥ä½œçš„æ ¸å¿ƒï¼Œåœ¨äºå®ƒä¸ºåº”ç”¨è¿›ç¨‹ã€ä¹Ÿå°±æ˜¯ç”¨æˆ·å®¹å™¨ï¼Œå¯åŠ¨äº†ä¸€ä¸ªåå« Sentry çš„è¿›ç¨‹ã€‚ è€ŒSentry è¿›ç¨‹çš„ä¸»è¦èŒè´£ï¼Œå°±æ˜¯æä¾›ä¸€ä¸ªä¼ ç»Ÿçš„æ“ä½œç³»ç»Ÿå†…æ ¸çš„èƒ½åŠ›ï¼Œå³ï¼šè¿è¡Œç”¨æˆ·ç¨‹åºï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚æ‰€ä»¥è¯´ï¼ŒSentry å¹¶ä¸æ˜¯ä½¿ç”¨ Go è¯­è¨€é‡æ–°å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ Linux å†…æ ¸ï¼Œè€Œåªæ˜¯ä¸€ä¸ªå¯¹åº”ç”¨è¿›ç¨‹â€œå†’å……â€å†…æ ¸çš„ç³»ç»Ÿç»„ä»¶ã€‚</p><p>åœ¨è¿™ç§è®¾è®¡æ€æƒ³ä¸‹ï¼Œæˆ‘ä»¬å°±ä¸éš¾ç†è§£ï¼ŒSentry å…¶å®éœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªå®Œæ•´çš„ Linux å†…æ ¸ç½‘ç»œæ ˆï¼Œä»¥ä¾¿å¤„ç†åº”ç”¨è¿›ç¨‹çš„é€šä¿¡è¯·æ±‚ã€‚ç„¶åï¼ŒæŠŠå°è£…å¥½çš„äºŒå±‚å¸§ç›´æ¥å‘é€ç»™ Kubernetes è®¾ç½®çš„ Pod çš„Network Namespace å³å¯ã€‚</p><p>æ­¤å¤–ï¼ŒSentry å¯¹äºVolume çš„æ“ä½œï¼Œåˆ™éœ€è¦é€šè¿‡ 9p åè®®äº¤ç»™ä¸€ä¸ªå«åš Gofer çš„ä»£ç†è¿›ç¨‹æ¥å®Œæˆã€‚Gofer ä¼šä»£æ›¿åº”ç”¨è¿›ç¨‹ç›´æ¥æ“ä½œå®¿ä¸»æœºä¸Šçš„æ–‡ä»¶ï¼Œå¹¶ä¾é seccompæœºåˆ¶å°†è‡ªå·±çš„èƒ½åŠ›é™åˆ¶åœ¨æœ€å°é›†ï¼Œä»è€Œé˜²æ­¢æ¶æ„åº”ç”¨è¿›ç¨‹é€šè¿‡ Gofer æ¥ä»å®¹å™¨ä¸­â€œé€ƒé€¸â€å‡ºå»ã€‚</p><p>è€Œåœ¨å…·ä½“çš„å®ç°ä¸Šï¼ŒgVisor çš„ Sentry è¿›ç¨‹ï¼Œå…¶å®è¿˜åˆ†ä¸ºä¸¤ç§ä¸åŒçš„å®ç°æ–¹å¼ã€‚è¿™é‡Œçš„å·¥ä½œåŸç†ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ç¤ºæ„å›¾æ¥æè¿°æ¸…æ¥šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5a/b8/5a1d6e0291306417864033b3f40f74b8.png?wh=1102*730\" alt=\"\"></p><p><strong>ç¬¬ä¸€ç§å®ç°æ–¹å¼</strong>ï¼Œæ˜¯ä½¿ç”¨Ptraceæœºåˆ¶æ¥æ‹¦æˆªç”¨æˆ·åº”ç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ï¼Œç„¶åæŠŠè¿™äº›ç³»ç»Ÿè°ƒç”¨äº¤ç»™ Sentry æ¥è¿›è¡Œå¤„ç†ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯¹äºåº”ç”¨è¿›ç¨‹æ¥è¯´ï¼Œæ˜¯å®Œå…¨é€æ˜çš„ã€‚è€Œ Sentry æ¥ä¸‹æ¥ï¼Œåˆ™ä¼šæ‰®æ¼”æ“ä½œç³»ç»Ÿçš„è§’è‰²ï¼Œåœ¨ç”¨æˆ·æ€æ‰§è¡Œç”¨æˆ·ç¨‹åºï¼Œç„¶åä»…åœ¨éœ€è¦çš„æ—¶å€™ï¼Œæ‰å‘å®¿ä¸»æœºå‘èµ· Sentry è‡ªå·±æ‰€éœ€è¦æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚è¿™ï¼Œå°±æ˜¯ gVisor å¯¹ç”¨æˆ·åº”ç”¨è¿›ç¨‹è¿›è¡Œå¼ºéš”ç¦»çš„ä¸»è¦æ‰‹æ®µã€‚ä¸è¿‡ï¼Œ Ptrace è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ‹¦æˆªçš„æ€§èƒ½å®åœ¨æ˜¯å¤ªå·®ï¼Œä»…èƒ½ä¾› Demo æ—¶ä½¿ç”¨ã€‚</p><p>è€Œ<strong>ç¬¬äºŒç§å®ç°æ–¹å¼</strong>ï¼Œåˆ™æ›´åŠ å…·æœ‰æ™®é€‚æ€§ã€‚å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3f/bf/3faf90550425378be91eb8cd2f0c63bf.png?wh=947*810\" alt=\"\"></p><p>åœ¨è¿™ç§å®ç°é‡Œï¼ŒSentry ä¼šä½¿ç”¨ KVM æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„æ‹¦æˆªï¼Œè¿™ä¸ªæ€§èƒ½æ¯” Ptrace å°±è¦å¥½å¾ˆå¤šäº†ã€‚</p><p>å½“ç„¶ï¼Œä¸ºäº†èƒ½å¤Ÿåšåˆ°è¿™ä¸€ç‚¹ï¼ŒSentry è¿›ç¨‹å°±å¿…é¡»æ‰®æ¼”ä¸€ä¸ª Guest Kernel çš„è§’è‰²ï¼Œè´Ÿè´£æ‰§è¡Œç”¨æˆ·ç¨‹åºï¼Œå‘èµ·ç³»ç»Ÿè°ƒç”¨ã€‚è€Œè¿™äº›ç³»ç»Ÿè°ƒç”¨è¢« KVM æ‹¦æˆªä¸‹æ¥ï¼Œè¿˜æ˜¯ç»§ç»­äº¤ç»™ Sentry è¿›è¡Œå¤„ç†ã€‚åªä¸è¿‡åœ¨è¿™æ—¶å€™ï¼ŒSentry å°±åˆ‡æ¢æˆäº†ä¸€ä¸ªæ™®é€šçš„å®¿ä¸»æœºè¿›ç¨‹çš„è§’è‰²ï¼Œæ¥å‘å®¿ä¸»æœºå‘èµ·å®ƒæ‰€éœ€è¦çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>åœ¨è¿™ç§å®ç°é‡Œï¼ŒSentry å¹¶ä¸ä¼šçœŸçš„åƒè™šæ‹Ÿæœºé‚£æ ·å»è™šæ‹Ÿå‡ºç¡¬ä»¶è®¾å¤‡ã€å®‰è£… Guest æ“ä½œç³»ç»Ÿã€‚å®ƒåªæ˜¯å€ŸåŠ© KVM è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„æ‹¦æˆªï¼Œä»¥åŠå¤„ç†åœ°å€ç©ºé—´åˆ‡æ¢ç­‰ç»†èŠ‚ã€‚</strong></p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ Google å†…éƒ¨ï¼Œä»–ä»¬ä¹Ÿæ˜¯ä½¿ç”¨çš„ç¬¬äºŒç§åŸºäº Hypervisor çš„gVisor å®ç°ã€‚åªä¸è¿‡ Google å†…éƒ¨æœ‰è‡ªå·±ç ”å‘çš„ Hypervisorï¼Œæ‰€ä»¥è¦æ¯” KVM å®ç°çš„æ€§èƒ½è¿˜è¦å¥½ã€‚</p><p>é€šè¿‡ä»¥ä¸Šçš„è®²è¿°ï¼Œç›¸ä¿¡ä½ å¯¹ Kata Containers å’Œ gVisor çš„å®ç°åŸç†ï¼Œå·²ç»æœ‰ä¸€ä¸ªæ„Ÿæ€§çš„è®¤è¯†äº†ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒgVisor çš„å®ç°ä¾ç„¶ä¸æ˜¯éå¸¸å®Œå–„ï¼Œæœ‰å¾ˆå¤š Linuxç³»ç»Ÿè°ƒç”¨å®ƒè¿˜ä¸æ”¯æŒï¼›æœ‰å¾ˆå¤šåº”ç”¨ï¼Œåœ¨ gVisor é‡Œè¿˜æ²¡åŠæ³•è¿è¡Œèµ·æ¥ã€‚ æ­¤å¤–ï¼ŒgVisorä¹Ÿæš‚æ—¶æ²¡æœ‰å®ç°ä¸€ä¸ª Pod å¤šä¸ªå®¹å™¨çš„æ”¯æŒã€‚å½“ç„¶ï¼Œåœ¨åé¢çš„å‘å±•ä¸­ï¼Œè¿™äº›å·¥ç¨‹é—®é¢˜ä¸€å®šä¼šé€æ¸è§£å†³æ‰çš„ã€‚</p><p>å¦å¤–ï¼Œä½ å¯èƒ½è¿˜å¬è¯´è¿‡ AWS åœ¨2018å¹´æœ«å‘å¸ƒçš„ä¸€ä¸ªå«åš Firecracker çš„å®‰å…¨å®¹å™¨é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®çš„æ ¸å¿ƒï¼Œå…¶å®æ˜¯ä¸€ä¸ªç”¨ Rust è¯­è¨€é‡æ–°ç¼–å†™çš„ VMMï¼ˆå³ï¼šè™šæ‹Ÿæœºç®¡ç†å™¨ï¼‰ã€‚è¿™å°±æ„å‘³ç€ï¼Œ Firecracker å’Œ Kata Containers çš„æœ¬è´¨åŸç†ï¼Œå…¶å®æ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡ï¼Œ Kata Containers é»˜è®¤ä½¿ç”¨çš„ VMM æ˜¯ Qemuï¼Œè€Œ Firecrackerï¼Œåˆ™ä½¿ç”¨è‡ªå·±ç¼–å†™çš„ VMMã€‚æ‰€ä»¥ï¼Œç†è®ºä¸Šï¼ŒKata Containers ä¹Ÿå¯ä»¥ä½¿ç”¨ Firecracker è¿è¡Œèµ·æ¥ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†åœ°ä»‹ç»äº†æ‹¥æœ‰ç‹¬ç«‹å†…æ ¸çš„å®‰å…¨å®¹å™¨é¡¹ç›®ï¼Œå¯¹æ¯”äº† KataContainers å’Œ gVisor çš„è®¾è®¡ä¸å®ç°ç»†èŠ‚ã€‚</p><p>åœ¨æ€§èƒ½ä¸Šï¼ŒKataContainers å’Œ KVM å®ç°çš„ gVisor åŸºæœ¬ä¸åˆ†ä¼¯ä»²ï¼Œåœ¨å¯åŠ¨é€Ÿåº¦å’Œå ç”¨èµ„æºä¸Šï¼ŒåŸºäºç”¨æˆ·æ€å†…æ ¸çš„ gVisor è¿˜ç•¥èƒœä¸€ç­¹ã€‚ä½†æ˜¯ï¼Œå¯¹äºç³»ç»Ÿè°ƒç”¨å¯†é›†çš„åº”ç”¨ï¼Œæ¯”å¦‚é‡ I/O æˆ–è€…é‡ç½‘ç»œçš„åº”ç”¨ï¼ŒgVisor å°±ä¼šå› ä¸ºéœ€è¦é¢‘ç¹æ‹¦æˆªç³»ç»Ÿè°ƒç”¨è€Œå‡ºç°æ€§èƒ½æ€¥å‰§ä¸‹é™çš„æƒ…å†µã€‚æ­¤å¤–ï¼ŒgVisor ç”±äºè¦è‡ªå·±ä½¿ç”¨ Sentry å»æ¨¡æ‹Ÿä¸€ä¸ªLinux å†…æ ¸ï¼Œæ‰€ä»¥å®ƒèƒ½æ”¯æŒçš„ç³»ç»Ÿè°ƒç”¨æ˜¯æœ‰é™çš„ï¼Œåªæ˜¯ Linux ç³»ç»Ÿè°ƒç”¨çš„ä¸€ä¸ªå­é›†ã€‚</p><p>ä¸è¿‡ï¼ŒgVisor è™½ç„¶ç°åœ¨æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œä½†æ˜¯è¿™ç§é€šè¿‡åœ¨ç”¨æˆ·æ€è¿è¡Œä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œæ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›å¼ºéš”ç¦»çš„æ€è·¯ï¼Œçš„ç¡®æ˜¯æœªæ¥å®‰å…¨å®¹å™¨è¿›ä¸€æ­¥æ¼”åŒ–çš„ä¸€ä¸ªéå¸¸æœ‰å‰é€”çš„æ–¹å‘ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒKata Containers å›¢é˜Ÿåœ¨ gVisor ä¹‹å‰ï¼Œå°±å·²ç» Demo äº†ä¸€ä¸ªåå« Linuxd çš„é¡¹ç›®ã€‚è¿™ä¸ªé¡¹ç›®ï¼Œä½¿ç”¨äº† User Mode Linux (UML)æŠ€æœ¯ï¼Œåœ¨ç”¨æˆ·æ€è¿è¡Œèµ·äº†ä¸€ä¸ªçœŸæ­£çš„ Linux Kernel æ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›å¼ºéš”ç¦»ï¼Œä»è€Œé¿å…äº†é‡æ–°å®ç° Linux Kernel å¸¦æ¥çš„å„ç§éº»çƒ¦ã€‚</p><p>æœ‰å…´è¶£çš„è¯ï¼Œä½ å¯ä»¥<a href=\"https://lc32018.sched.com/event/ER8x/run-linux-kernel-as-a-daemon-lai-jiangshan-hypersh\">åœ¨è¿™é‡ŒæŸ¥çœ‹</a>è¿™ä¸ªæ¼”è®²ã€‚æˆ‘ç›¸ä¿¡ï¼Œè¿™ä¸ªæ–¹å‘ï¼Œåº”è¯¥æ‰æ˜¯å®‰å…¨å®¹å™¨è¿›åŒ–çš„æœªæ¥ã€‚è¿™æ¯” Unikernels è¿™ç§æ ¹æœ¬ä¸é€‚åˆå®é™…åœºæ™¯ä¸­ä½¿ç”¨çš„æ€è·¯ï¼Œè¦é è°±å¾—å¤šã€‚</p><blockquote>\n<p>æœ¬ç¯‡å›¾ç‰‡å‡ºå¤„å‡å¼•è‡ª<a href=\"https://www.openstack.org/assets/presentation-media/kata-containers-and-gvisor-a-quantitave-comparison.pdf\"> Kata Containers çš„å®˜æ–¹å¯¹æ¯”èµ„æ–™</a>ã€‚</p>\n</blockquote><h2>æ€è€ƒé¢˜</h2><p>å®‰å…¨å®¹å™¨çš„æ„ä¹‰ï¼Œç»ä¸ä»…ä»…æ­¢äºå®‰å…¨ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šæ¯”å¦‚ï¼Œä½ çš„å®¿ä¸»æœºçš„ Linux å†…æ ¸ç‰ˆæœ¬æ˜¯3.6ï¼Œä½†æ˜¯åº”ç”¨å´å¿…é¡»è¦æ±‚ Linux å†…æ ¸ç‰ˆæœ¬æ˜¯4.0ã€‚è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥æŠŠè¿™ä¸ªåº”ç”¨è¿è¡Œåœ¨ä¸€ä¸ª KataContainers é‡Œã€‚é‚£ä¹ˆè¯·é—®ï¼Œä½ è§‰å¾—ä½¿ç”¨ gVisor æ˜¯å¦ä¹Ÿèƒ½æä¾›è¿™ç§èƒ½åŠ›å‘¢ï¼ŸåŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p>","comments":[{"had_liked":false,"id":48280,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1246046,"ip_address":"","ucode":"68E92087D486E0","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/5e/818a8b1b.jpg","comment_is_top":false,"comment_ctime":1544410333,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"220587742429","product_id":100015201,"comment_content":"å›ç­”æœ€åçš„é—®é¢˜ï¼š<br>æä¾›ä¸äº†ï¼›å› ä¸ºgVisoræ˜¯åŸºäºç”¨æˆ·æ€å†…æ ¸çš„ï¼Œæ— æ³•çœŸæ­£åšåˆ°ä¸å®¿ä¸»æœºå†…æ ¸ä¸ä¸€è‡´çš„è¯·æ±‚å“åº”ï¼Œå› æ­¤æ»¡è¶³ä¸äº†å¯¹é«˜ç‰ˆæœ¬å†…æ ¸è¯·æ±‚çš„éœ€æ±‚","like_count":52},{"had_liked":false,"id":50004,"user_name":"å‹‡æ•¢çš„å¿ƒ","can_delete":false,"product_type":"c1","uid":1198639,"ip_address":"","ucode":"43678591F1A558","user_header":"https://static001.geekbang.org/account/avatar/00/12/4a/2f/42aa48d7.jpg","comment_is_top":false,"comment_ctime":1544837953,"is_pvip":false,"replies":[{"id":"18187","content":"èªæ˜","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1545026601,"ip_address":"","comment_id":50004,"utype":1}],"discussion_count":1,"race_medal":0,"score":"138983791425","product_id":100015201,"comment_content":"getåˆ°äº†é‡ç‚¹ï¼šâ€œgVisor è™½ç„¶ç°åœ¨æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œä½†æ˜¯è¿™ç§é€šè¿‡åœ¨ç”¨æˆ·æ€è¿è¡Œä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œæ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›å¼ºéš”ç¦»çš„æ€è·¯ï¼Œçš„ç¡®æ˜¯æœªæ¥å®‰å…¨å®¹å™¨è¿›ä¸€æ­¥æ¼”åŒ–çš„ä¸€ä¸ªéå¸¸æœ‰å‰é€”çš„æ–¹å‘ã€‚â€","like_count":33,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432836,"discussion_content":"èªæ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545026601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":157266,"user_name":"æ‹‰æ¬§","can_delete":false,"product_type":"c1","uid":1206605,"ip_address":"","ucode":"40996A8093A95F","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/4d/81c44f45.jpg","comment_is_top":false,"comment_ctime":1575100717,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"70294577453","product_id":100015201,"comment_content":"æ— æ³•æä¾›ï¼ŒgVisorè¯´ç™½äº†åªæ˜¯ä¸€å±‚ä»£ç†ï¼Œä¸æ˜¯çœŸæ­£çš„å†…æ ¸ï¼›ä½†æ˜¯è¿™ä¹Ÿæ˜¯googleçš„ç‰›é€¼ä¹‹å¤„ï¼ŒæŠŠæ‰€æœ‰çš„ç³»ç»Ÿè°ƒç”¨å’Œåè®®éƒ½ä»£ç†å‡ºæ¥ï¼Œä¸æ˜¯å¤§ç¥çº§çš„æŠ€æœ¯ä¸“å®¶ï¼Œè¿™ç§æ´»æ ¹æœ¬åšä¸äº†","like_count":17},{"had_liked":false,"id":58024,"user_name":"ğŸµ","can_delete":false,"product_type":"c1","uid":1252579,"ip_address":"","ucode":"A35B044B2A76A8","user_header":"https://static001.geekbang.org/account/avatar/00/13/1c/e3/b8c5bfa2.jpg","comment_is_top":false,"comment_ctime":1546962057,"is_pvip":false,"replies":[{"id":"21837","content":"redhat çš„ kubevirt","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1547695940,"ip_address":"","comment_id":58024,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44496635017","product_id":100015201,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼Œèƒ½ä¸èƒ½æ¨èä¸‹K8Så¯ä»¥é€šè¿‡å“ªäº›é¡¹ç›®ç®¡ç†KVMè™šæ‹Ÿæœº","like_count":11,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435870,"discussion_content":"redhat çš„ kubevirt","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547695940,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48175,"user_name":"æ··æ²Œæ¸ºæ— æ","can_delete":false,"product_type":"c1","uid":1221896,"ip_address":"","ucode":"A8517768BF1E77","user_header":"https://static001.geekbang.org/account/avatar/00/12/a5/08/10b18682.jpg","comment_is_top":false,"comment_ctime":1544384963,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40199090627","product_id":100015201,"comment_content":"æ€è€ƒé¢˜ç†è§£:<br>gvisoræ˜¯å®¿ä¸»æœºkernelçš„&quot;å®¢æˆ·ç«¯&quot;ï¼Œä¸ç®¡æ€ä¹ˆæ‹¦æˆªå®¹å™¨çš„è°ƒç”¨ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦è½¬ä¸ºå¯¹å®¿ä¸»æœºkernelçš„è°ƒç”¨ï¼Œå› æ­¤ä½ç‰ˆæœ¬çš„å®¿ä¸»æœºkernelæ²¡æœ‰çš„èƒ½åŠ›è¿”å›å®¹å™¨æƒ³è¦çš„å“åº”ã€‚è¿™æ—¶å€™è¿˜æ˜¯è™šæ‹Ÿæœºç®¡ç”¨ï¼Œå› ä¸ºç”šè‡³èƒ½åœ¨Linuxä¸Šè™šæ‹Ÿå‡ºwindowã€‚","like_count":10},{"had_liked":false,"id":50091,"user_name":"extraterrestrialï¼ï¼","can_delete":false,"product_type":"c1","uid":1017987,"ip_address":"","ucode":"74AE07CA68F6B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/GDYkD2X7pXSKUSaUFC8u3TBPaakaibnOBV2NYDc2TNfb8Su9icFMwSod6iaQX5iaGU2gT6xkPuhXeWvY8KaVEZAYzg/132","comment_is_top":false,"comment_ctime":1544863595,"is_pvip":true,"replies":[{"id":"18031","content":"è¿™ä¸ªå°±å¾ˆå…¸å‹çš„ç”¨æˆ·æ€kernelæŠ€æœ¯å•Šï¼Œå¯ä»¥å‚è€ƒuser mode linux","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1544904307,"ip_address":"","comment_id":50091,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18724732779","product_id":100015201,"comment_content":"ä¹‹å‰çš„ç•™è¨€ä¸èƒ½ç¼–è¾‘ï¼Œè¿˜å‘è¯·æ•™ä¸ªé—®é¢˜ï¼šgvisoræ‹¦æˆªç³»ç»Ÿè°ƒç”¨ï¼Œä½†æ˜¯ç³»ç»Ÿè°ƒç”¨æ˜¯å†…æ ¸æ€æ‰èƒ½æ‰§è¡Œï¼Œgvisoræ‹¦æˆªä¸‹æ¥é™¤äº†ç›´æ¥æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è¿˜æœ‰å•¥æ“ä½œç©ºé—´ä¹ˆï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432872,"discussion_content":"è¿™ä¸ªå°±å¾ˆå…¸å‹çš„ç”¨æˆ·æ€kernelæŠ€æœ¯å•Šï¼Œå¯ä»¥å‚è€ƒuser mode linux","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544904307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269644,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1608724696,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10198659288","product_id":100015201,"comment_content":"Kata Containeræœ¬è´¨å°±æ˜¯ä¸€ä¸ªç²¾ç®€åçš„è½»é‡çº§è™šæ‹Ÿæœºï¼Œæ‰€ä»¥å®ƒçš„ç‰¹ç‚¹ï¼Œå°±æ˜¯â€œåƒè™šæ‹Ÿæœºä¸€æ ·å®‰å…¨ï¼Œåƒå®¹å™¨ä¸€æ ·æ•æ·â€ã€‚2018å¹´ï¼ŒGoogleå‘å¸ƒäº†gVisorï¼Œç»™å®¹å™¨è¿›ç¨‹é…ç½®äº†ä¸€ä¸ªç”¨Goè¯­è¨€å®ç°çš„â€œæå°ç‹¬ç«‹å†…æ ¸â€ã€‚<br><br>æ— è®ºæ˜¯Kata Containerè¿˜æ˜¯gVisorï¼Œå®ç°å®‰å…¨çš„æ–¹å¼æœ¬è´¨ä¸Šéƒ½æ˜¯è®©å®¹å™¨ç‹¬ç«‹ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œé¿å…å…±äº«å®¿ä¸»æœºå†…æ ¸ã€‚ä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼ŒKata é€šè¿‡ç¡¬ä»¶è™šæ‹ŸåŒ–å‡ºä¸€å°â€œå°è™šæ‹Ÿæœºâ€ï¼Œåœ¨â€œå°è™šæ‹Ÿæœºâ€å®‰è£…è£å‰ªåçš„Linuxå†…æ ¸ï¼Œè€ŒgVisoråˆ™æ˜¯â€œæ¨¡æ‹Ÿâ€å‡ºäº†ä¸€ä¸ªè¿è¡Œåœ¨ç”¨æˆ·æ€çš„æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œé€šè¿‡è¿™ä¸ªå†…æ ¸æ¥é™åˆ¶å®¹å™¨è¿›ç¨‹å‘å®¿ä¸»æœºå‘èµ·çš„è°ƒç”¨ã€‚<br><br>gVisorè™½ç„¶ç°åœ¨æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œä½†æ˜¯è¿™ç§é€šè¿‡åœ¨ç”¨æˆ·æ€è¿è¡Œä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œæ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›å¼ºéš”ç¦»çš„æ€è·¯ï¼Œçš„ç¡®æ˜¯æœªæ¥å®‰å…¨å®¹å™¨è¿›ä¸€æ­¥æ¼”åŒ–çš„ä¸€ä¸ªéå¸¸æœ‰å‰é€”çš„æ–¹å‘ã€‚<br>","like_count":3},{"had_liked":false,"id":50087,"user_name":"extraterrestrialï¼ï¼","can_delete":false,"product_type":"c1","uid":1017987,"ip_address":"","ucode":"74AE07CA68F6B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/GDYkD2X7pXSKUSaUFC8u3TBPaakaibnOBV2NYDc2TNfb8Su9icFMwSod6iaQX5iaGU2gT6xkPuhXeWvY8KaVEZAYzg/132","comment_is_top":false,"comment_ctime":1544863116,"is_pvip":true,"replies":[{"id":"18186","content":"linuxå†…æ ¸ï¼Œå¤§éƒ¨åˆ†å¤Ÿç”¨ï¼Œæ€§èƒ½è¦çœ‹å…·ä½“å“ªç§æƒ…å†µï¼Œæœ‰æ²¡æœ‰å¼€ä¼˜åŒ–","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1545026527,"ip_address":"","comment_id":50087,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5839830412","product_id":100015201,"comment_content":"é—®ä¸ªåˆçº§é—®é¢˜ï¼šçœ‹ä¸‹æ¥è§‰å¾—kataä½¿ç”¨äº†qemuï¼Œå’Œæˆ‘è‡ªå·±åœ¨qemuä¸Šè·‘ä¸ªæ­£å¸¸çš„ubuntuå•¥çš„ç³»ç»Ÿå¥½åƒæ²¡å•¥åŒºåˆ«ï¼Œå°±æ˜¯**åšäº†äº†ç²¾å‰ª**? è¿™æ ·ç²¾å‰ªä»¥åæ˜¯ä¸ªä»€ä¹ˆå†…æ ¸ï¼ŒåŠŸèƒ½å¤Ÿç”¨ä¹ˆï¼Œä¼šä¸ä¼šæ€§èƒ½å’Œç°åœ¨çš„containerå·®å¾ˆå¤šä¹‹ç±»çš„...","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432870,"discussion_content":"linuxå†…æ ¸ï¼Œå¤§éƒ¨åˆ†å¤Ÿç”¨ï¼Œæ€§èƒ½è¦çœ‹å…·ä½“å“ªç§æƒ…å†µï¼Œæœ‰æ²¡æœ‰å¼€ä¼˜åŒ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545026527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320222,"user_name":"é™ˆæ–¯ä½³","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1636159346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636159346","product_id":100015201,"comment_content":"è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼ŒSingularityå®¹å™¨æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯åŸºäºç”¨æˆ·æ€çš„å®¹å™¨å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":254682,"user_name":"å°è°¢åŒå­¦","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1603167244,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1603167244","product_id":100015201,"comment_content":"Kataå®¹å™¨å¯¹vmmçš„å±‚çš„ä¾èµ–ä¸ä»…æ˜¯qemuå§ï¼Ÿè¿˜éœ€è¦kvmå§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1233455,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d2/2f/04882ff8.jpg","nickname":"é¾™å¤","note":"","ucode":"D1724E68D6304D","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370352,"discussion_content":"ç°é˜¶æ®µkvmä¸qemuå·²ç»å¯ä»¥è¯´æ˜¯ä¸€ç§å¼ºè€¦åˆäº†ï¼Œä¸¤ç§éƒ½æ˜¯ä¸€å—å‡ºç°çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619367752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253908,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1602944785,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602944785","product_id":100015201,"comment_content":"ä¸èƒ½è¿è¡Œåœ¨gVisorä¸­,gVisoræœ¬è´¨ä¸Šæ˜¯å§”æ‰˜ç»™äº†å®é™…çš„å®¿ä¸»æœºå†…æ ¸å»æ‰§è¡Œ,æœ‰äº›é«˜ç‰ˆæœ¬çš„api,ä½ç‰ˆæœ¬å†å¦‚ä½•ä¹Ÿæ— æ³•å®ç°","like_count":1},{"had_liked":false,"id":162202,"user_name":"LH","can_delete":false,"product_type":"c1","uid":1211178,"ip_address":"","ucode":"819B9B2409E834","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/2a/7d8b5943.jpg","comment_is_top":false,"comment_ctime":1576476700,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576476700","product_id":100015201,"comment_content":"è¦æŒæ¡çš„ä¸œè¥¿å¤ªå¤šäº†","like_count":0},{"had_liked":false,"id":48363,"user_name":"å°æ˜root","can_delete":false,"product_type":"c1","uid":1231573,"ip_address":"","ucode":"BE080897AC53DB","user_header":"https://static001.geekbang.org/account/avatar/00/12/ca/d5/a2cd57c9.jpg","comment_is_top":false,"comment_ctime":1544428713,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544428713","product_id":100015201,"comment_content":"åç»­è¯¾ç¨‹ä¸­ä¼šè®²è§£routeè¿™ä¸ªæ¦‚å¿µä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":48255,"user_name":"starnop","can_delete":false,"product_type":"c1","uid":1124858,"ip_address":"","ucode":"2064FA9AC3F99F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIbKCwLRY5icgW3WtLn0JD7EDksicGFqLAsXTm89SjNhR0KIt3N5iaQEmeic4Ld50Yxsceicia5kBODibZPA/132","comment_is_top":false,"comment_ctime":1544406792,"is_pvip":false,"replies":[{"id":"17503","content":"æ²¡å•¥å¤§åŒºåˆ«ï¼Œæ‰€ä»¥æ‰åˆå¹¶äº†","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1544533347,"ip_address":"","comment_id":48255,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1544406792","product_id":100015201,"comment_content":"ç£Šå“¥æ‚¨å¥½ï¼Œæœ‰ä¸ªç–‘é—®è¯·æ•™ä¸€ä¸‹ï¼Œkataç»“åˆäº†runvä¸clear containerï¼Œé‚£ä¹ˆrunvä¸clear containerä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå„æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿkataç›¸æ¯”äºä»–ä»¬åˆåšäº†å“ªäº›ä¼˜åŒ–å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432088,"discussion_content":"æ²¡å•¥å¤§åŒºåˆ«ï¼Œæ‰€ä»¥æ‰åˆå¹¶äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544533347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}