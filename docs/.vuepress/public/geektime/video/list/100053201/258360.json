{"id":258360,"title":"28 | åº”ç”¨ï¼šä½¿ç”¨TensorFlow 2è®­ç»ƒRetinaNet","content":"<h1>è¯¾ä»¶å’Œ Demo åœ°å€</h1><p><a href=\"https://gitee.com/geektime-geekbang/tensorflow-101/tree/master/experts\">https://gitee.com/geektime-geekbang/tensorflow-101/tree/master/experts</a></p>","comments":[{"had_liked":false,"id":237969,"user_name":"å­æ›°","can_delete":false,"product_type":"c3","uid":1161256,"ip_address":"","ucode":"34127192DD8876","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/28/8c83d109.jpg","comment_is_top":false,"comment_ctime":1596016621,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"æœ€æ–°çš„çš„Keras ç‰ˆæœ¬ keras.optimizers.adam æ”¹ä¸º keras.optimizers.Adamäº†\ntrain.pyä¸­çš„ä¸€å¤„ä¿®æ”¹","like_count":2},{"had_liked":false,"id":385535,"user_name":"åˆ˜å‹‡","can_delete":false,"product_type":"c3","uid":1590033,"ip_address":"å¹¿ä¸œ","ucode":"D38D925FB932E0","user_header":"https://static001.geekbang.org/account/avatar/00/18/43/11/5e221c05.jpg","comment_is_top":false,"comment_ctime":1702892522,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"è®­ç»ƒå¥½çš„h5æ¨¡å‹èƒ½å¦æä¾›ï¼Ÿè¿™æ ·å°±å¯ä»¥ä¸ç”¨ç­‰ç»“æœï¼Œç»§ç»­åé¢çš„å†…å®¹äº†ã€‚\nabu820@qq.com","like_count":0},{"had_liked":false,"id":371314,"user_name":"æå¢é˜³","can_delete":false,"product_type":"c3","uid":3572750,"ip_address":"åŒ—äº¬","ucode":"8DD15137CB268C","user_header":"","comment_is_top":false,"comment_ctime":1679795842,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"è¯·é—®è€å¸ˆï¼Œè®­ç»ƒæ¨¡å‹é˜¶æ®µï¼Œè¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³: File &quot;&#47;tensorflow_python&#47;workspace&#47;tensorflow-101-master&#47;experts&#47;code_sample&#47;chapter-456&#47;keras-retinanet&#47;keras_retinanet&#47;bin&#47;..&#47;..&#47;keras_retinanet&#47;models&#47;resnet.py&quot;, line 37, in retinanet\n    return resnet_retinanet(*args, backbone=self.backbone, **kwargs)\n  File &quot;&#47;tensorflow_python&#47;workspace&#47;tensorflow-101-master&#47;experts&#47;code_sample&#47;chapter-456&#47;keras-retinanet&#47;keras_retinanet&#47;bin&#47;..&#47;..&#47;keras_retinanet&#47;models&#47;resnet.py&quot;, line 98, in resnet_retinanet\n    resnet = keras_resnet.models.ResNet50(inputs, include_top=False, freeze_bn=True)\n  File &quot;&#47;home&#47;ps&#47;anaconda3&#47;envs&#47;tf2_gpu&#47;lib&#47;python3.8&#47;site-packages&#47;keras_resnet&#47;models&#47;_2d.py&quot;, line 233, in __init__\n    super(ResNet2D50, self).__init__(\n  File &quot;&#47;home&#47;ps&#47;anaconda3&#47;envs&#47;tf2_gpu&#47;lib&#47;python3.8&#47;site-packages&#47;keras_resnet&#47;models&#47;_2d.py&quot;, line 76, in __init__\n    x = keras.layers.Conv2D(64, (7, 7), strides=(2, 2), use_bias=False, name=&quot;conv1&quot;, padding=&quot;same&quot;)(inputs)\n  File &quot;&#47;home&#47;ps&#47;anaconda3&#47;envs&#47;tf2_gpu&#47;lib&#47;python3.8&#47;site-packages&#47;keras&#47;backend&#47;tensorflow_backend.py&quot;, line 75, in symbolic_fn_wrapper\n    return func(*args, **kwargs)\n  File &quot;&#47;home&#47;ps&#47;anaconda3&#47;envs&#47;tf2_gpu&#47;lib&#47;python3.8&#47;site-packages&#47;keras&#47;engine&#47;base_layer.py&quot;, line 446, in __call__\n    self.assert_input_compatibility(inputs)\n  File &quot;&#47;home&#47;ps&#47;anaconda3&#47;envs&#47;tf2_gpu&#47;lib&#47;python3.8&#47;site-packages&#47;keras&#47;engine&#47;base_layer.py&quot;, line 312, in assert_input_compatibility\n    raise ValueError(&#39;Layer &#39; + self.name + &#39; was called with &#39;\nValueError: Layer conv1 was called with an input that isn&#39;t a symbolic tensor. Received type: &lt;class &#39;tensorflow.python.keras.engine.keras_tensor.KerasTensor&#39;&gt;. Full input: [&lt;KerasTensor: shape=(None, None, None, 3) dtype=float32 (created by layer &#39;input_1&#39;)&gt;]. All inputs to the layer should be tensors.","like_count":0},{"had_liked":false,"id":347424,"user_name":"èµµå¯æ˜","can_delete":false,"product_type":"c3","uid":3012204,"ip_address":"","ucode":"96AFD073DCF129","user_header":"","comment_is_top":false,"comment_ctime":1654006041,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"Traceback (most recent call last):\n  File &quot;keras-retinanet&#47;keras-retinanet&#47;keras_retinanet&#47;bin&#47;train.py&quot;, line 34, in &lt;module&gt;\n    from .. import layers  # noqa: F401\n  File &quot;keras-retinanet&#47;keras-retinanet&#47;keras_retinanet&#47;bin\\..\\..\\keras_retinanet\\layers\\__init__.py&quot;, line 1, in &lt;module&gt;\n    from ._misc import RegressBoxes, UpsampleLike, Anchors, ClipBoxes  # noqa: F401\n  File &quot;keras-retinanet&#47;keras-retinanet&#47;keras_retinanet&#47;bin\\..\\..\\keras_retinanet\\layers\\_misc.py&quot;, line 20, in &lt;module&gt;\n    from ..utils import anchors as utils_anchors\n  File &quot;keras-retinanet&#47;keras-retinanet&#47;keras_retinanet&#47;bin\\..\\..\\keras_retinanet\\utils\\anchors.py&quot;, line 20, in &lt;module&gt;\n    from ..utils.compute_overlap import compute_overlap\nImportError: DLL load failed: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚\nè€å¸ˆèƒ½å¸®çœ‹çœ‹ä»€ä¹ˆé—®é¢˜å—","like_count":0},{"had_liked":false,"id":347422,"user_name":"èµµå¯æ˜","can_delete":false,"product_type":"c3","uid":3012204,"ip_address":"","ucode":"96AFD073DCF129","user_header":"","comment_is_top":false,"comment_ctime":1654005444,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"ModuleNotFoundError: No module named &#39;keras_retinanet.utils.compute_overlap&#39;,æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°è¿™ä¸ªé”™è¯¯å¦‚ä½•è§£å†³","like_count":0},{"had_liked":false,"id":251264,"user_name":"Phil","can_delete":false,"product_type":"c3","uid":2033590,"ip_address":"","ucode":"C81C6A48E8C2DD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/07/b6/d35ef85c.jpg","comment_is_top":false,"comment_ctime":1601444788,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"è€å¸ˆï¼Œç”¨NVIDIA Quadro P620è®­ç»ƒæ˜¾ç¤ºå†…å­˜ä¸è¶³ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼ŒGPUå†…å­˜æ˜¯2Gçš„","like_count":0},{"had_liked":false,"id":241308,"user_name":"Chandler","can_delete":false,"product_type":"c3","uid":1440896,"ip_address":"","ucode":"A6D97CFF01FF70","user_header":"https://static001.geekbang.org/account/avatar/00/15/fc/80/4d1369bc.jpg","comment_is_top":false,"comment_ctime":1597243421,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"è¯·é—®è€å¸ˆï¼Œæ€ä¹ˆè®²keras_retinanet è®­ç»ƒå‡ºæ¥çš„h5è½¬åŒ–ä¸ºtflite?\n\nmodel = tf.keras.models.load_model(&#39;models&#47;resnet50_csv_02.h5&#39;)\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\ntflite_model = converter.convert()\nopen(&quot;converted_model.tflite&quot;, &quot;wb&quot;).write(tflite_model)\n\nè¿™æ®µä»£ç ä¼šæŠ¥TypeError: (&#39;Keyword argument not understood:&#39;, &#39;freeze&#39;) é”™è¯¯","like_count":0},{"had_liked":false,"id":239454,"user_name":"Mr. Z","can_delete":false,"product_type":"c3","uid":1145108,"ip_address":"","ucode":"D5EE1168215783","user_header":"https://static001.geekbang.org/account/avatar/00/11/79/14/bfeae652.jpg","comment_is_top":false,"comment_ctime":1596535565,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"åœ¨train_infoé‡ŒæŠ¥äº†ä¸€ä¸ªè¿™æ ·çš„é”™è¯¯,ValueError: invalid CSV class file: data&#47;baijiu\\class.csv: line 2: format should be &#39;class_name,class_id&#39; æ‰¾äº†å¾ˆä¹…æ²¡æ‰¾åˆ°æ€ä¹ˆè§£å†³","like_count":0,"discussions":[{"author":{"id":1440896,"avatar":"https://static001.geekbang.org/account/avatar/00/15/fc/80/4d1369bc.jpg","nickname":"Chandler","note":"","ucode":"A6D97CFF01FF70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298068,"discussion_content":"æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯ç”Ÿæˆçš„æ•°æ®å¤šäº†ä¸€è¡Œç©ºæ ¼ï¼Œå°†gen_csv.pyä¸­çš„open(class_csv_path, &#34;w&#34;ï¼‰ æ”¹æˆ open(class_csv_path, &#34;w&#34;, newline=&#39;&#39;) å°±å¯ä»¥äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1597160673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237965,"user_name":"å­æ›°","can_delete":false,"product_type":"c3","uid":1161256,"ip_address":"","ucode":"34127192DD8876","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/28/8c83d109.jpg","comment_is_top":false,"comment_ctime":1596015207,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"æœ€æ–°ç‰ˆæœ¬é‡Œå¥½åƒæ‰¾ä¸åˆ° keras.initializers.normalï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ç»™åˆ°çš„æ˜¯initializers.RandomNormal","like_count":0},{"had_liked":false,"id":234164,"user_name":"å°é»‘ğŸ·","can_delete":false,"product_type":"c3","uid":1991504,"ip_address":"","ucode":"08A8C68801EFE9","user_header":"https://static001.geekbang.org/account/avatar/00/1e/63/50/3efb3dba.jpg","comment_is_top":false,"comment_ctime":1594607786,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100053201,"comment_content":"è€å¸ˆï¼Œå…³äºRetinaNetçš„è®­ç»ƒå‡ºç°ä¸€ä¸ªerrorï¼Œå®‰è£…githubä¸Šæµ‹è¯•çš„ä¾‹å­ï¼Œâ€œResNet-50-model.keras.h5â€å·²ä¸‹è½½å¹¶æ”¾åœ¨å½“å‰ç›®å½•ï¼Œè¿›å…¥pythonå‘½ä»¤è¡Œï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼š\nfrom keras_retinanet.models import load_model\nmodel = load_model(&#39;ResNet-50-model.keras.h5&#39;,backbone_name=&#39;resnet50&#39;)\næŠ¥ï¼š\n    &#47;root&#47;.local&#47;lib&#47;python3.7&#47;site-packages&#47;keras_resnet&#47;layers&#47;_batch_normalization.py:17 call  *\n        return super(BatchNormalization, self).call(training=(not self.freeze), *args, **kwargs)\n\n    TypeError: type object got multiple values for keyword argument &#39;training&#39;","like_count":0,"discussions":[{"author":{"id":1082951,"avatar":"https://static001.geekbang.org/account/avatar/00/10/86/47/e40e3a70.jpg","nickname":"æç»´é–","note":"","ucode":"537E1DF61A34A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295160,"discussion_content":"ç‰ˆæœ¬çš„é—®é¢˜ï¼Œtensorflow==2.2.0ï¼Œ keras==2.3.1ï¼Œå°±å¯ä»¥æ­£å¸¸æ‰§è¡Œäº†","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1596107053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234129,"user_name":"@.@","can_delete":false,"product_type":"c3","uid":1244750,"ip_address":"","ucode":"6E45DD91FC9150","user_header":"https://static001.geekbang.org/account/avatar/00/12/fe/4e/176c7eab.jpg","comment_is_top":false,"comment_ctime":1594602008,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100053201,"comment_content":"è€å¸ˆï¼Œèƒ½ä¸èƒ½è¯´ä¸‹ä¹‹å‰æçš„é‚£ä¸ªå¦‚æœæŸä¸ªç±»åˆ«æ£€æµ‹æ•ˆæœæ¯”è¾ƒå·®ï¼Œå¦‚ä½•å¯¹è¿™ä¸ªç±»åˆ«æ•°æ®åšäºŒæ¬¡è®­ç»ƒçš„å…·ä½“æµç¨‹æ–¹æ³•ã€‚å‡å¦‚æˆ‘æœ‰10ä¸ªç±»åˆ«å…¶ä¸­ä¸¤ä¸ªæ•ˆæœæ¯”è¾ƒå·®ï¼Œé‚£æˆ‘åœ¨å½“å‰æ¨¡å‹çš„åŸºç¡€ä¸Šå•ç‹¬è®­ç»ƒè¿™ä¸¤ä¸ªç±»åˆ«çš„æ•°æ®ï¼Œæˆ‘è®­ç»ƒå®Œåï¼Œæ˜¯ä¸æ˜¯è¿˜è¦åˆ‡å›åˆ°10ä¸ªç±»åˆ«çš„æ•°æ®å†å»è®­ç»ƒå‡ è½®ï¼Œç„¶åè¿™ä¸ªæ¨¡å‹æ‰èƒ½ç”¨ã€‚","like_count":0}]}