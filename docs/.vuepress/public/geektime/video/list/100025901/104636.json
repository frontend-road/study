{"id":104636,"title":"66 | 使用AutoLayout实现通用ToolBar视图","content":"<p><strong>PDF 课件和源代码下载地址：</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geektime-ios-course\">https://gitee.com/geektime-geekbang/geektime-ios-course</a></p>","comments":[{"had_liked":false,"id":214424,"user_name":"Geek_i59t1w","can_delete":false,"product_type":"c3","uid":1233103,"ip_address":"","ucode":"8A1FEFCB4F9E04","user_header":"https://static001.geekbang.org/account/avatar/00/12/d0/cf/98f9dfac.jpg","comment_is_top":false,"comment_ctime":1588745530,"is_pvip":false,"replies":[{"id":81220,"content":"大概是这样，我身边大部分团队使用AutoLayout的，都使用了一些语法糖类型的框架。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1590151087,"ip_address":"","comment_id":214424,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"Masonry的应用场景是不是比原生的更广泛？","like_count":2,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494050,"discussion_content":"大概是这样，我身边大部分团队使用AutoLayout的，都使用了一些语法糖类型的框架。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590151087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113687,"user_name":"Geek_jg3r26","can_delete":false,"product_type":"c3","uid":1454691,"ip_address":"","ucode":"7D093ED7273CBE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5icO2A4K7HYTYfQoagTz7VbtgxfS2ibBqLnKVWwQZgsePibZWFvFJEhPT8BtpQSaFx9IEodyp6c0dw/132","comment_is_top":false,"comment_ctime":1563118088,"is_pvip":false,"replies":[{"id":41485,"content":"通常情况下layoutSubviews会调用多次，包括view尺寸变化的时候，init只会调用一次。所以对于依赖父View bounds变化的子view来说，设置frame 最好放到layoutSubviews中随时的响应调整，而不依赖的子view其实放到哪里都可以。同样的如果仅仅依赖数据的应该放到设置数据的时候，如果放到layoutSubviews中会调用多次。整体上就是要看布局的逻辑是依赖什么，是独立的&#47;依赖数据&#47;还是依赖父view或其他view。如果view较少不影响性能，保证UI展示正确的前提下，并没有什么强制的要求。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1563171603,"ip_address":"","comment_id":113687,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师，布局的代码，是写在初始化方法，还是设置数据的时候，或者是layoutsubview的时候；有点迷惑， 写在哪里最合适呢","like_count":2,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458346,"discussion_content":"通常情况下layoutSubviews会调用多次，包括view尺寸变化的时候，init只会调用一次。所以对于依赖父View bounds变化的子view来说，设置frame 最好放到layoutSubviews中随时的响应调整，而不依赖的子view其实放到哪里都可以。同样的如果仅仅依赖数据的应该放到设置数据的时候，如果放到layoutSubviews中会调用多次。整体上就是要看布局的逻辑是依赖什么，是独立的/依赖数据/还是依赖父view或其他view。如果view较少不影响性能，保证UI展示正确的前提下，并没有什么强制的要求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563171603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1529929,"avatar":"","nickname":"起风了001","note":"","ucode":"8DCDBA40B8CC9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1970,"discussion_content":"一般一次性的写在控制器load view那个地方, 其他view可以写在初始化方法里. 只有跟数据内容有关系的约束才需要写在加载数据的地方.一般约束写一次就可以了, 所以比较少写在layoutsubview里, 因为这样会重复删除再添加从而降低效率.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563156773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115486,"user_name":"Geek_jg3r26","can_delete":false,"product_type":"c3","uid":1454691,"ip_address":"","ucode":"7D093ED7273CBE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5icO2A4K7HYTYfQoagTz7VbtgxfS2ibBqLnKVWwQZgsePibZWFvFJEhPT8BtpQSaFx9IEodyp6c0dw/132","comment_is_top":false,"comment_ctime":1563601679,"is_pvip":false,"replies":[{"id":42839,"content":"主要就是协助布局VFL中的视图元素的排列方向和位置属性。NSLayoutFormatOptions其实可以简单的对应NSLayoutAttribute，比如从左布局、从右布局、居中等，我们在代码中constraintWithItem方法也讲解过NSLayoutAttribute的使用。当然NSLayoutFormatOptions会和VFL以及其他使用NSLayoutConstraint的约束产生一些冲突，所以在使用的过程中也需要注意下。其实最好的研究系统函数的方法就是写小Demo，我们可以创建一个简单的view使用AutoLayout布局，然后修改不同的NSLayoutFormatOptions观察下效果。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1563973908,"ip_address":"","comment_id":115486,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师 vfl 初始化方法里的options 还是有点不明白怎么用， 这个怎么去理解去使用呢","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459128,"discussion_content":"主要就是协助布局VFL中的视图元素的排列方向和位置属性。NSLayoutFormatOptions其实可以简单的对应NSLayoutAttribute，比如从左布局、从右布局、居中等，我们在代码中constraintWithItem方法也讲解过NSLayoutAttribute的使用。当然NSLayoutFormatOptions会和VFL以及其他使用NSLayoutConstraint的约束产生一些冲突，所以在使用的过程中也需要注意下。其实最好的研究系统函数的方法就是写小Demo，我们可以创建一个简单的view使用AutoLayout布局，然后修改不同的NSLayoutFormatOptions观察下效果。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563973908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114884,"user_name":"skingyuu","can_delete":false,"product_type":"c3","uid":1025317,"ip_address":"","ucode":"617BA704FD6CE0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKCIurjqOQUDG1TrpezADn6PJxEPaPsBWqWfXDVicxsWgLXg9FLAZyl1zreQsDF0fslty0dq7LtXug/132","comment_is_top":false,"comment_ctime":1563422839,"is_pvip":false,"replies":[{"id":42533,"content":"为了讲解演示，项目中一部分图标使用的Bundle管理，一部分图标使用的Asset管理的。","user_name":"作者回复","user_name_real":"dequanzhu","uid":1041455,"ctime":1563845352,"ip_address":"","comment_id":114884,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师,github上怎么不提供图标了.","like_count":1,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458865,"discussion_content":"为了讲解演示，项目中一部分图标使用的Bundle管理，一部分图标使用的Asset管理的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563845352,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040549,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e0/a5/da168c0d.jpg","nickname":"VHJM","note":"","ucode":"B8319C44989612","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":78134,"discussion_content":"可是没讲过怎么用 Asset啊？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575979929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143634,"user_name":"Storage","can_delete":false,"product_type":"c3","uid":1506973,"ip_address":"","ucode":"ABF019D3B3365D","user_header":"https://static001.geekbang.org/account/avatar/00/16/fe/9d/dc0db557.jpg","comment_is_top":false,"comment_ctime":1571749065,"is_pvip":false,"replies":[{"id":56024,"content":"你提供的地址，clone下来文件夹内是空的。检查下Signing&amp;Capabilities 中，Automatically manage signing是否有勾选，如果是勾选的，取消一下就可以在下面选择对应的Provisioning profile等。","user_name":"作者回复","user_name_real":"zzz","uid":1041455,"ctime":1572240007,"ip_address":"","comment_id":143634,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"老师，还是原来的问题，还是AppleID的问题，运行就提示我的AppleID用不了，只能用你的https:&#47;&#47;gitee.com&#47;zhang_bing_hui&#47;Demo.git，你帮我看一下吧","like_count":0,"discussions":[{"author":{"id":1041455,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJ3dLlYr6tznfnZXJNsD7Jw48BVnFSib3RO3VWEN0pgebRY1jaR8YXLQ6iaAjTsFiamOWSA3UPAa37A/132","nickname":"Geek_e7jq8k","note":"","ucode":"352964E5D793DA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471627,"discussion_content":"你提供的地址，clone下来文件夹内是空的。检查下Signing&amp;amp;Capabilities 中，Automatically manage signing是否有勾选，如果是勾选的，取消一下就可以在下面选择对应的Provisioning profile等。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572240007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1506973,"avatar":"https://static001.geekbang.org/account/avatar/00/16/fe/9d/dc0db557.jpg","nickname":"Storage","note":"","ucode":"ABF019D3B3365D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40755,"discussion_content":"老师，我改了一下，你看看行了没有https://gitee.com/zhang_bing_hui/Demo.git\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572266078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190127,"user_name":"Shnerd","can_delete":false,"product_type":"c3","uid":1440263,"ip_address":"","ucode":"3630276571AF66","user_header":"https://static001.geekbang.org/account/avatar/00/15/fa/07/1d50f530.jpg","comment_is_top":false,"comment_ctime":1584605271,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"这个课程是越听越好，主要是思路清晰","like_count":1},{"had_liked":false,"id":374924,"user_name":"大大小小","can_delete":false,"product_type":"c3","uid":2178133,"ip_address":"广东","ucode":"8A21DC629A24F5","user_header":"https://static001.geekbang.org/account/avatar/00/21/3c/55/74844d08.jpg","comment_is_top":false,"comment_ctime":1684660573,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100025901,"comment_content":"ios开发工资高是有原因的，写布局都这么麻烦，这么难，写css的看了想放弃","like_count":0}]}