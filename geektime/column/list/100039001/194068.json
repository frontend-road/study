{"id":194068,"title":"42 | å•ä¾‹æ¨¡å¼ï¼ˆä¸­ï¼‰ï¼šæˆ‘ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Ÿåˆæœ‰ä½•æ›¿ä»£æ–¹æ¡ˆï¼Ÿ","content":"<p>ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œè®²è§£äº†å•ä¾‹æ¨¡å¼çš„ä¸€äº›åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ï¼Œé¿å…èµ„æºè®¿é—®å†²çªã€è¡¨ç¤ºä¸šåŠ¡æ¦‚å¿µä¸Šçš„å…¨å±€å”¯ä¸€ç±»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ äº†Javaè¯­è¨€ä¸­ï¼Œå•ä¾‹æ¨¡å¼çš„å‡ ç§å®ç°æ–¹æ³•ã€‚å¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œä¸çŸ¥é“ä½ è¯¾åæœ‰æ²¡æœ‰è‡ªå·±å»å¯¹ç…§ç€å®ç°ä¸€ä¸‹å‘¢ï¼Ÿ</p><p>å°½ç®¡å•ä¾‹æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç¡®å®ç»å¸¸ç”¨åˆ°å®ƒï¼Œä½†æ˜¯ï¼Œæœ‰äº›äººè®¤ä¸ºå•ä¾‹æ˜¯ä¸€ç§åæ¨¡å¼ï¼ˆanti-patternï¼‰ï¼Œå¹¶ä¸æ¨èä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œä»Šå¤©ï¼Œæˆ‘å°±é’ˆå¯¹è¿™ä¸ªè¯´æ³•è¯¦ç»†åœ°è®²è®²è¿™å‡ ä¸ªé—®é¢˜ï¼šå•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šè¢«ç§°ä¸ºåæ¨¡å¼ï¼Ÿå¦‚æœä¸ç”¨å•ä¾‹ï¼Œè¯¥å¦‚ä½•è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»ï¼Ÿæœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ</p><p>è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæ­£å¼å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼</p><h2>å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜?</h2><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å•ä¾‹ï¼Œéƒ½æ˜¯ç”¨å®ƒæ¥è¡¨ç¤ºä¸€äº›å…¨å±€å”¯ä¸€ç±»ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯ç±»ã€è¿æ¥æ± ç±»ã€IDç”Ÿæˆå™¨ç±»ã€‚å•ä¾‹æ¨¡å¼ä¹¦å†™ç®€æ´ã€ä½¿ç”¨æ–¹ä¾¿ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼Œç›´æ¥é€šè¿‡ç±»ä¼¼IdGenerator.getInstance().getId()è¿™æ ·çš„æ–¹æ³•æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œè¿™ç§ä½¿ç”¨æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ç¡¬ç¼–ç ï¼ˆhard codeï¼‰ï¼Œä¼šå¸¦æ¥è¯¸å¤šé—®é¢˜ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹åˆ°åº•æœ‰å“ªäº›é—®é¢˜ã€‚</p><h3>1.å•ä¾‹å¯¹OOPç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½</h3><!-- [[[read_end]]] --><p>æˆ‘ä»¬çŸ¥é“ï¼ŒOOPçš„å››å¤§ç‰¹æ€§æ˜¯å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€ã€‚å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å¯¹äºå…¶ä¸­çš„æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€éƒ½æ”¯æŒå¾—ä¸å¥½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯é€šè¿‡IdGeneratorè¿™ä¸ªä¾‹å­æ¥è®²è§£ã€‚</p><pre><code>public class Order {\n  public void create(...) {\n    //...\n    long id = IdGenerator.getInstance().getId();\n    //...\n  }\n}\n\npublic class User {\n  public void create(...) {\n    // ...\n    long id = IdGenerator.getInstance().getId();\n    //...\n  }\n}\n</code></pre><p>IdGeneratorçš„ä½¿ç”¨æ–¹å¼è¿èƒŒäº†åŸºäºæ¥å£è€Œéå®ç°çš„è®¾è®¡åŸåˆ™ï¼Œä¹Ÿå°±è¿èƒŒäº†å¹¿ä¹‰ä¸Šç†è§£çš„OOPçš„æŠ½è±¡ç‰¹æ€§ã€‚å¦‚æœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬å¸Œæœ›é’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡é‡‡ç”¨ä¸åŒçš„IDç”Ÿæˆç®—æ³•ã€‚æ¯”å¦‚ï¼Œè®¢å•IDå’Œç”¨æˆ·IDé‡‡ç”¨ä¸åŒçš„IDç”Ÿæˆå™¨æ¥ç”Ÿæˆã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªéœ€æ±‚å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ‰€æœ‰ç”¨åˆ°IdGeneratorç±»çš„åœ°æ–¹ï¼Œè¿™æ ·ä»£ç çš„æ”¹åŠ¨å°±ä¼šæ¯”è¾ƒå¤§ã€‚</p><pre><code>public class Order {\n  public void create(...) {\n    //...\n    long id = IdGenerator.getInstance().getId();\n    // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç \n    long id = OrderIdGenerator.getIntance().getId();\n    //...\n  }\n}\n\npublic class User {\n  public void create(...) {\n    // ...\n    long id = IdGenerator.getInstance().getId();\n    // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç \n    long id = UserIdGenerator.getIntance().getId();\n  }\n}\n</code></pre><p>é™¤æ­¤ä¹‹å¤–ï¼Œå•ä¾‹å¯¹ç»§æ‰¿ã€å¤šæ€ç‰¹æ€§çš„æ”¯æŒä¹Ÿä¸å‹å¥½ã€‚è¿™é‡Œæˆ‘ä¹‹æ‰€ä»¥ä¼šç”¨â€œä¸å‹å¥½â€è¿™ä¸ªè¯ï¼Œè€Œéâ€œå®Œå…¨ä¸æ”¯æŒâ€ï¼Œæ˜¯å› ä¸ºä»ç†è®ºä¸Šæ¥è®²ï¼Œå•ä¾‹ç±»ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ã€ä¹Ÿå¯ä»¥å®ç°å¤šæ€ï¼Œåªæ˜¯å®ç°èµ·æ¥ä¼šéå¸¸å¥‡æ€ªï¼Œä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§å˜å·®ã€‚ä¸æ˜ç™½è®¾è®¡æ„å›¾çš„äººï¼Œçœ‹åˆ°è¿™æ ·çš„è®¾è®¡ï¼Œä¼šè§‰å¾—è«åå…¶å¦™ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦ä½ é€‰æ‹©å°†æŸä¸ªç±»è®¾è®¡æˆåˆ°å•ä¾‹ç±»ï¼Œä¹Ÿå°±æ„å‘³ç€æ”¾å¼ƒäº†ç»§æ‰¿å’Œå¤šæ€è¿™ä¸¤ä¸ªå¼ºæœ‰åŠ›çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œä¹Ÿå°±ç›¸å½“äºæŸå¤±äº†å¯ä»¥åº”å¯¹æœªæ¥éœ€æ±‚å˜åŒ–çš„æ‰©å±•æ€§ã€‚</p><h3>2.å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œä»£ç çš„å¯è¯»æ€§éå¸¸é‡è¦ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€çœ¼å°±èƒ½çœ‹å‡ºç±»ä¸ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œææ¸…æ¥šè¿™ä¸ªç±»ä¾èµ–äº†å“ªäº›å¤–éƒ¨ç±»ã€‚</p><p>é€šè¿‡æ„é€ å‡½æ•°ã€å‚æ•°ä¼ é€’ç­‰æ–¹å¼å£°æ˜çš„ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹å‡½æ•°çš„å®šä¹‰ï¼Œå°±èƒ½å¾ˆå®¹æ˜“è¯†åˆ«å‡ºæ¥ã€‚ä½†æ˜¯ï¼Œå•ä¾‹ç±»ä¸éœ€è¦æ˜¾ç¤ºåˆ›å»ºã€ä¸éœ€è¦ä¾èµ–å‚æ•°ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­ç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚å¦‚æœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»å°±ä¼šéå¸¸éšè”½ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»”ç»†æŸ¥çœ‹æ¯ä¸ªå‡½æ•°çš„ä»£ç å®ç°ï¼Œæ‰èƒ½çŸ¥é“è¿™ä¸ªç±»åˆ°åº•ä¾èµ–äº†å“ªäº›å•ä¾‹ç±»ã€‚</p><h3>3.å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œå•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚å¦‚æœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­åˆ›å»ºä¸¤ä¸ªå®ä¾‹æˆ–å¤šä¸ªå®ä¾‹ï¼Œé‚£å°±è¦å¯¹ä»£ç æœ‰æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚ä½ å¯èƒ½ä¼šè¯´ï¼Œä¼šæœ‰è¿™æ ·çš„éœ€æ±‚å—ï¼Ÿæ—¢ç„¶å•ä¾‹ç±»å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½ç”¨æ¥è¡¨ç¤ºå…¨å±€ç±»ï¼Œæ€ä¹ˆä¼šéœ€è¦ä¸¤ä¸ªæˆ–è€…å¤šä¸ªå®ä¾‹å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œè¿™æ ·çš„éœ€æ±‚å¹¶ä¸å°‘è§ã€‚æˆ‘ä»¬æ‹¿æ•°æ®åº“è¿æ¥æ± æ¥ä¸¾ä¾‹è§£é‡Šä¸€ä¸‹ã€‚</p><p>åœ¨ç³»ç»Ÿè®¾è®¡åˆæœŸï¼Œæˆ‘ä»¬è§‰å¾—ç³»ç»Ÿä¸­åªåº”è¯¥æœ‰ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿™æ ·èƒ½æ–¹ä¾¿æˆ‘ä»¬æ§åˆ¶å¯¹æ•°æ®åº“è¿æ¥èµ„æºçš„æ¶ˆè€—ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠæ•°æ®åº“è¿æ¥æ± ç±»è®¾è®¡æˆäº†å•ä¾‹ç±»ã€‚ä½†ä¹‹åæˆ‘ä»¬å‘ç°ï¼Œç³»ç»Ÿä¸­æœ‰äº›SQLè¯­å¥è¿è¡Œå¾—éå¸¸æ…¢ã€‚è¿™äº›SQLè¯­å¥åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œé•¿æ—¶é—´å ç”¨æ•°æ®åº“è¿æ¥èµ„æºï¼Œå¯¼è‡´å…¶ä»–SQLè¯·æ±‚æ— æ³•å“åº”ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ…¢SQLä¸å…¶ä»–SQLéš”ç¦»å¼€æ¥æ‰§è¡Œã€‚ä¸ºäº†å®ç°è¿™æ ·çš„ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸¤ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œæ…¢SQLç‹¬äº«ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œå…¶ä»–SQLç‹¬äº«å¦å¤–ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿™æ ·å°±èƒ½é¿å…æ…¢SQLå½±å“åˆ°å…¶ä»–SQLçš„æ‰§è¡Œã€‚</p><p>å¦‚æœæˆ‘ä»¬å°†æ•°æ®åº“è¿æ¥æ± è®¾è®¡æˆå•ä¾‹ç±»ï¼Œæ˜¾ç„¶å°±æ— æ³•é€‚åº”è¿™æ ·çš„éœ€æ±‚å˜æ›´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•ä¾‹ç±»åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå½±å“ä»£ç çš„æ‰©å±•æ€§ã€çµæ´»æ€§ã€‚æ‰€ä»¥ï¼Œæ•°æ®åº“è¿æ¥æ± ã€çº¿ç¨‹æ± è¿™ç±»çš„èµ„æºæ± ï¼Œæœ€å¥½è¿˜æ˜¯ä¸è¦è®¾è®¡æˆå•ä¾‹ç±»ã€‚å®é™…ä¸Šï¼Œä¸€äº›å¼€æºçš„æ•°æ®åº“è¿æ¥æ± ã€çº¿ç¨‹æ± ä¹Ÿç¡®å®æ²¡æœ‰è®¾è®¡æˆå•ä¾‹ç±»ã€‚</p><h3>4.å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½</h3><p>å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨ä¼šå½±å“åˆ°ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚å¦‚æœå•ä¾‹ç±»ä¾èµ–æ¯”è¾ƒé‡çš„å¤–éƒ¨èµ„æºï¼Œæ¯”å¦‚DBï¼Œæˆ‘ä»¬åœ¨å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œå¸Œæœ›èƒ½é€šè¿‡mockçš„æ–¹å¼å°†å®ƒæ›¿æ¢æ‰ã€‚è€Œå•ä¾‹ç±»è¿™ç§ç¡¬ç¼–ç å¼çš„ä½¿ç”¨æ–¹å¼ï¼Œå¯¼è‡´æ— æ³•å®ç°mockæ›¿æ¢ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœå•ä¾‹ç±»æŒæœ‰æˆå‘˜å˜é‡ï¼ˆæ¯”å¦‚IdGeneratorä¸­çš„idæˆå‘˜å˜é‡ï¼‰ï¼Œé‚£å®ƒå®é™…ä¸Šç›¸å½“äºä¸€ç§å…¨å±€å˜é‡ï¼Œè¢«æ‰€æœ‰çš„ä»£ç å…±äº«ã€‚å¦‚æœè¿™ä¸ªå…¨å±€å˜é‡æ˜¯ä¸€ä¸ªå¯å˜å…¨å±€å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„æˆå‘˜å˜é‡æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼Œé‚£æˆ‘ä»¬åœ¨ç¼–å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸åŒæµ‹è¯•ç”¨ä¾‹ä¹‹é—´ï¼Œä¿®æ”¹äº†å•ä¾‹ç±»ä¸­çš„åŒä¸€ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œä»è€Œå¯¼è‡´æµ‹è¯•ç»“æœäº’ç›¸å½±å“çš„é—®é¢˜ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥å›è¿‡å¤´å»çœ‹ä¸‹<a href=\"https://time.geekbang.org/column/article/186691\">ç¬¬29è®²</a>ä¸­çš„â€œå…¶ä»–å¸¸è§çš„Anti-Patternsï¼šå…¨å±€å˜é‡â€é‚£éƒ¨åˆ†çš„ä»£ç ç¤ºä¾‹å’Œè®²è§£ã€‚</p><h3>5.å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°</h3><p>å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿æ¥æ± çš„å•ä¾‹å¯¹è±¡ï¼Œæˆ‘ä»¬æ²¡æ³•é€šè¿‡å‚æ•°æ¥æŒ‡å®šè¿æ¥æ± çš„å¤§å°ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹éƒ½æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆã€‚</p><p>ç¬¬ä¸€ç§è§£å†³æ€è·¯æ˜¯ï¼šåˆ›å»ºå®Œå®ä¾‹ä¹‹åï¼Œå†è°ƒç”¨init()å‡½æ•°ä¼ é€’å‚æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œè¦å…ˆè°ƒç”¨init()æ–¹æ³•ï¼Œç„¶åæ‰èƒ½è°ƒç”¨getInstance()æ–¹æ³•ï¼Œå¦åˆ™ä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Singleton {\n  private static Singleton instance = null;\n  private final int paramA;\n  private final int paramB;\n\n  private Singleton(int paramA, int paramB) {\n    this.paramA = paramA;\n    this.paramB = paramB;\n  }\n\n  public static Singleton getInstance() {\n    if (instance == null) {\n       throw new RuntimeException(&quot;Run init() first.&quot;);\n    }\n    return instance;\n  }\n\n  public synchronized static Singleton init(int paramA, int paramB) {\n    if (instance != null){\n       throw new RuntimeException(&quot;Singleton has been created!&quot;);\n    }\n    instance = new Singleton(paramA, paramB);\n    return instance;\n  }\n}\n\nSingleton.init(10, 50); // å…ˆinitï¼Œå†ä½¿ç”¨\nSingleton singleton = Singleton.getInstance();\n</code></pre><p>ç¬¬äºŒç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ°getIntance()æ–¹æ³•ä¸­ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public class Singleton {\n  private static Singleton instance = null;\n  private final int paramA;\n  private final int paramB;\n\n  private Singleton(int paramA, int paramB) {\n    this.paramA = paramA;\n    this.paramB = paramB;\n  }\n\n  public synchronized static Singleton getInstance(int paramA, int paramB) {\n    if (instance == null) {\n      instance = new Singleton(paramA, paramB);\n    }\n    return instance;\n  }\n}\n\nSingleton singleton = Singleton.getInstance(10, 50);\n</code></pre><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šé¢çš„ä»£ç å®ç°ç¨å¾®æœ‰ç‚¹é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬å¦‚ä¸‹ä¸¤æ¬¡æ‰§è¡ŒgetInstance()æ–¹æ³•ï¼Œé‚£è·å–åˆ°çš„singleton1å’Œsignleton2çš„paramAå’ŒparamBéƒ½æ˜¯10å’Œ50ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒæ¬¡çš„å‚æ•°ï¼ˆ20ï¼Œ30ï¼‰æ²¡æœ‰èµ·ä½œç”¨ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿç•™ç»™ä½ è‡ªå·±æ€è€ƒï¼Œä½ å¯ä»¥åœ¨ç•™è¨€åŒºè¯´è¯´ä½ çš„è§£å†³æ€è·¯ã€‚</p><pre><code>Singleton singleton1 = Singleton.getInstance(10, 50);\nSingleton singleton2 = Singleton.getInstance(20, 30);\n</code></pre><p>ç¬¬ä¸‰ç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ°å¦å¤–ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ã€‚Configæ˜¯ä¸€ä¸ªå­˜å‚¨äº†paramAå’ŒparamBå€¼çš„å…¨å±€å˜é‡ã€‚é‡Œé¢çš„å€¼æ—¢å¯ä»¥åƒä¸‹é¢çš„ä»£ç é‚£æ ·é€šè¿‡é™æ€å¸¸é‡æ¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½å¾—åˆ°ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€å€¼å¾—æ¨èçš„ã€‚</p><pre><code>public class Config {\n  public static final int PARAM_A = 123;\n  public static final int PARAM_B = 245;\n}\n\npublic class Singleton {\n  private static Singleton instance = null;\n  private final int paramA;\n  private final int paramB;\n\n  private Singleton() {\n    this.paramA = Config.PARAM_A;\n    this.paramB = Config.PARAM_B;\n  }\n\n  public synchronized static Singleton getInstance() {\n    if (instance == null) {\n      instance = new Singleton();\n    }\n    return instance;\n  }\n}\n</code></pre><h2>æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ</h2><p>åˆšåˆšæˆ‘ä»¬æåˆ°äº†å•ä¾‹çš„å¾ˆå¤šé—®é¢˜ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œå³ä¾¿å•ä¾‹æœ‰è¿™ä¹ˆå¤šé—®é¢˜ï¼Œä½†æˆ‘ä¸ç”¨ä¸è¡Œå•Šã€‚æˆ‘ä¸šåŠ¡ä¸Šæœ‰è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»çš„éœ€æ±‚ï¼Œå¦‚æœä¸ç”¨å•ä¾‹ï¼Œæˆ‘æ€ä¹ˆæ‰èƒ½ä¿è¯è¿™ä¸ªç±»çš„å¯¹è±¡å…¨å±€å”¯ä¸€å‘¢ï¼Ÿ</p><p>ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®ç°ã€‚è¿™ä¹Ÿæ˜¯é¡¹ç›®å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€ç§å®ç°æ€è·¯ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€èŠ‚è¯¾ä¸­è®²çš„IDå”¯ä¸€é€’å¢ç”Ÿæˆå™¨çš„ä¾‹å­ï¼Œç”¨é™æ€æ–¹æ³•å®ç°ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><pre><code>// é™æ€æ–¹æ³•å®ç°æ–¹å¼\npublic class IdGenerator {\n  private static AtomicLong id = new AtomicLong(0);\n  \n  public static long getId() { \n    return id.incrementAndGet();\n  }\n}\n// ä½¿ç”¨ä¸¾ä¾‹\nlong id = IdGenerator.getId();\n</code></pre><p>ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®ç°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å®é™…ä¸Šï¼Œå®ƒæ¯”å•ä¾‹æ›´åŠ ä¸çµæ´»ï¼Œæ¯”å¦‚ï¼Œå®ƒæ— æ³•æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åŠæ³•ã€‚å®é™…ä¸Šï¼Œå•ä¾‹é™¤äº†æˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„ä½¿ç”¨æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§ä½¿ç”¨æ–¹æ³•ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>// 1. è€çš„ä½¿ç”¨æ–¹å¼\npublic demofunction() {\n  //...\n  long id = IdGenerator.getInstance().getId();\n  //...\n}\n\n// 2. æ–°çš„ä½¿ç”¨æ–¹å¼ï¼šä¾èµ–æ³¨å…¥\npublic demofunction(IdGenerator idGenerator) {\n  long id = idGenerator.getId();\n}\n// å¤–éƒ¨è°ƒç”¨demofunction()çš„æ—¶å€™ï¼Œä¼ å…¥idGenerator\nIdGenerator idGenerator = IdGenerator.getInsance();\ndemofunction(idGenerator);\n</code></pre><p>åŸºäºæ–°çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘ä»¬å°†å•ä¾‹ç”Ÿæˆçš„å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ç»™ç±»çš„æˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥è§£å†³å•ä¾‹éšè—ç±»ä¹‹é—´ä¾èµ–å…³ç³»çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œå¯¹äºå•ä¾‹å­˜åœ¨çš„å…¶ä»–é—®é¢˜ï¼Œæ¯”å¦‚å¯¹OOPç‰¹æ€§ã€æ‰©å±•æ€§ã€å¯æµ‹æ€§ä¸å‹å¥½ç­‰é—®é¢˜ï¼Œè¿˜æ˜¯æ— æ³•è§£å†³ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»æ ¹ä¸Šï¼Œå¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®ç°å…¨å±€å”¯ä¸€ç±»ã€‚å®é™…ä¸Šï¼Œç±»å¯¹è±¡çš„å…¨å±€å”¯ä¸€æ€§å¯ä»¥é€šè¿‡å¤šç§ä¸åŒçš„æ–¹å¼æ¥ä¿è¯ã€‚æˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡å•ä¾‹æ¨¡å¼æ¥å¼ºåˆ¶ä¿è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å·¥å‚æ¨¡å¼ã€IOCå®¹å™¨ï¼ˆæ¯”å¦‚Spring IOCå®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚è¿™å°±ç±»ä¼¼Javaä¸­å†…å­˜å¯¹è±¡çš„é‡Šæ”¾ç”±JVMæ¥è´Ÿè´£ï¼Œè€ŒC++ä¸­ç”±ç¨‹åºå‘˜è‡ªå·±è´Ÿè´£ï¼Œé“ç†æ˜¯ä¸€æ ·çš„ã€‚</p><p>å¯¹äºæ›¿ä»£æ–¹æ¡ˆå·¥å‚æ¨¡å¼ã€IOCå®¹å™¨çš„è¯¦ç»†è®²è§£ï¼Œæˆ‘ä»¬æ”¾åˆ°åé¢çš„ç« èŠ‚ä¸­è®²è§£ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬æ¥ä¸€å—æ€»ç»“å›é¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦æŒæ¡çš„é‡ç‚¹å†…å®¹ã€‚</p><p><strong>1.å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ</strong></p><ul>\n<li>å•ä¾‹å¯¹OOPç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½</li>\n<li>å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»</li>\n<li>å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½</li>\n<li>å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½</li>\n<li>å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°</li>\n</ul><p><strong>2.å•ä¾‹æœ‰ä»€ä¹ˆæ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ</strong></p><p>ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®ç°ã€‚ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®ç°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å¦‚æœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»æ ¹ä¸Šï¼Œå¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®ç°å…¨å±€å”¯ä¸€ç±»äº†ã€‚æ¯”å¦‚ï¼Œé€šè¿‡å·¥å‚æ¨¡å¼ã€IOCå®¹å™¨ï¼ˆæ¯”å¦‚Spring IOCå®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œç”±ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚</p><p>æœ‰äººæŠŠå•ä¾‹å½“ä½œåæ¨¡å¼ï¼Œä¸»å¼ æœç»åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚æˆ‘ä¸ªäººè§‰å¾—è¿™æœ‰ç‚¹æç«¯ã€‚æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œå…³é”®çœ‹ä½ æ€ä¹ˆç”¨ã€‚å¦‚æœå•ä¾‹ç±»å¹¶æ²¡æœ‰åç»­æ‰©å±•çš„éœ€æ±‚ï¼Œå¹¶ä¸”ä¸ä¾èµ–å¤–éƒ¨ç³»ç»Ÿï¼Œé‚£è®¾è®¡æˆå•ä¾‹ç±»å°±æ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚å¯¹äºä¸€äº›å…¨å±€çš„ç±»ï¼Œæˆ‘ä»¬åœ¨å…¶ä»–åœ°æ–¹newçš„è¯ï¼Œè¿˜è¦åœ¨ç±»ä¹‹é—´ä¼ æ¥ä¼ å»ï¼Œä¸å¦‚ç›´æ¥åšæˆå•ä¾‹ç±»ï¼Œä½¿ç”¨èµ·æ¥ç®€æ´æ–¹ä¾¿ã€‚</p><h2>è¯¾å ‚è®¨è®º</h2><p>1.å¦‚æœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ</p><pre><code>public class Demo {\n  private UserRepo userRepo; // é€šè¿‡æ„é€ å“ˆå‡½æ•°æˆ–IOCå®¹å™¨ä¾èµ–æ³¨å…¥\n  \n  public boolean validateCachedUser(long userId) {\n    User cachedUser = CacheManager.getInstance().getUser(userId);\n    User actualUser = userRepo.getUser(userId);\n    // çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...\n  }\n}\n</code></pre><p>2.åœ¨å•ä¾‹æ”¯æŒå‚æ•°ä¼ é€’çš„ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸¤æ¬¡æ‰§è¡ŒgetInstance(paramA, paramB)æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><pre><code>Singleton singleton1 = Singleton.getInstance(10, 50);\nSingleton singleton2 = Singleton.getInstance(20, 30);\n</code></pre><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æ€è€ƒå’Œè§è§£ã€‚å¦‚æœæœ‰æ”¶è·ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","comments":[{"had_liked":false,"id":176344,"user_name":"å°æ™å­","can_delete":false,"product_type":"c1","uid":1132337,"ip_address":"","ucode":"3AAA6FB5ACB6AE","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/31/f35367c8.jpg","comment_is_top":false,"comment_ctime":1581039489,"is_pvip":false,"discussion_count":20,"race_medal":1,"score":"482617376641","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºï¼Œ<br>1. æŠŠä»£ç â€œUser cachedUser = CacheManager.getInstance().getUser(userId);â€å•ç‹¬æå–å‡ºæ¥åšæˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œè¿™æ ·è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¿›è¡Œmockäº†ï¼Œè¿›è€Œæ–¹ä¾¿æµ‹è¯•validateCachedUserã€‚<br>2. å¯ä»¥åˆ¤æ–­ä¼ è¿›æ¥çš„å‚æ•°å’Œå·²ç»å­˜åœ¨çš„instanceé‡Œé¢çš„ä¸¤ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œå°±ç›´æ¥è¿”å›å·²ç»å­˜åœ¨çš„instanceï¼Œå¦åˆ™å°±æ–°åˆ›å»ºä¸€ä¸ªinstanceè¿”å›ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š<br><br>public synchronized static Singleton getInstance(int paramA, int paramB) { <br>    if (instance == null) { <br>        instance = new Singleton(paramA, paramB); <br>    } else if (instance.paramA == paramA &amp;&amp; instance.paramB == paramB) {<br>        return instance;<br>    } else {<br>        instance = new Singleton(paramA, paramB);<br>    }<br>    return instance; <br>}","like_count":113,"discussions":[{"author":{"id":1231549,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ca/bd/a51ae4b2.jpg","nickname":"åƒé¥­é¥­","note":"","ucode":"95CFA07CDA2957","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49759,"discussion_content":"è¿™ä¸ªè²Œä¼¼åœ¨ Java ç¼–ç¨‹æ€æƒ³ä¸­æåˆ°è¿‡ï¼Œæ˜¯å¯ä»¥è¿™ä¹ˆç†è§£çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573631492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176503,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1581073343,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"327998587839","product_id":100039001,"comment_content":"æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œå…³é”®çœ‹ä½ æ€ä¹ˆç”¨ã€‚è¿™å¥è¯è¯´çš„å¾ˆå¯¹ï¼Œæ‰€ä»¥å…¶å®æ‰€è°“å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹è¿™ç§è¯´æ³•è¿˜æ˜¯æœ‰ç‚¹ç‰µå¼ºï¼","like_count":77,"discussions":[{"author":{"id":2336999,"avatar":"https://static001.geekbang.org/account/avatar/00/23/a8/e7/bedf7932.jpg","nickname":"å“‡å“ˆå“ˆ","note":"","ucode":"3A4FD1A3E657C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559692,"discussion_content":"ä¸ªäººè§‰å¾—å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§æ€æƒ³ï¼Œè¦çœ‹ä½ æ€ä¹ˆå®ç°è¿™ç§æ€æƒ³ï¼Œå°±java ç›®å‰é‚£å‡ ç§å®ç°æ€æƒ³çš„ä»£ç æœ‰å±€é™æ€§ï¼Œæ‰€ä»¥è¯´å«åšç¼ºç‚¹ï¼Œè¿™æ‰éœ€è¦æ”¹è¿›ä½¿å®ƒå¯ä»¥æ»¡è¶³ä¸€äº›å…¶ä»–çš„ä¸šåŠ¡éœ€æ±‚å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648883573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015189,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7d/95/dd73022c.jpg","nickname":"æˆ‘æ˜¯æ›¾ç»é‚£ä¸ªå°‘å¹´","note":"","ucode":"9F02F7FF147D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530425,"discussion_content":"æ˜¯çš„ï¼Œç”¨å•ä¾‹è¦çŸ¥é“ä»–ä½¿ç”¨çš„åœºæ™¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637071845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185662,"user_name":"Richie","can_delete":false,"product_type":"c1","uid":1019588,"ip_address":"","ucode":"12314EF0347693","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/c4/8d1150f3.jpg","comment_is_top":false,"comment_ctime":1583657389,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"250691760557","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºç¬¬2ç‚¹ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥å…ˆææ¸…æ¥šéœ€æ±‚ï¼Œä¸ºä»€ä¹ˆéœ€è¦åœ¨getInstance()æ–¹æ³•ä¸­åŠ å‚æ•°ï¼Œæƒ³è¦è¾¾åˆ°ä»€ä¹ˆç›®çš„ï¼Ÿ<br>è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µè®¨è®ºä¸€ä¸‹ï¼š<br>1. å¦‚æœçš„ç¡®éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ç±»ï¼Œå¹¶ä¸”è¿™ä¸ªç±»åªèƒ½è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œé‚£ä¹ˆåº”è¯¥é‡‡ç”¨æ–‡ä¸­æåˆ°çš„ç¬¬ä¸‰ç§è§£å†³æ€è·¯ï¼Œå³å°†æ‰€éœ€å‚æ•°æ”¾åˆ°å…¨å±€çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œä»è€Œé¿å…å¤šæ¬¡åˆå§‹åŒ–å‚æ•°è¢«å¿½ç•¥æˆ–è€…æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸çš„é—®é¢˜ï¼›<br>2. å¦‚æœæ˜¯è¦æ ¹æ®ä¸åŒå‚æ•°æ„é€ å‡ºä¸åŒçš„å¯¹è±¡ï¼Œå¹¶ä¸”ç›¸åŒå‚æ•°çš„å¯¹è±¡åªè¢«æ„é€ ä¸€æ¬¡ï¼Œé‚£ä¹ˆåº”è¯¥æ”¹æˆåœ¨Singletonç±»ä¸­ç»´æŠ¤ä¸€ä¸ªHashMapï¼Œç„¶åæ¯æ¬¡è°ƒç”¨getInstance()æ–¹æ³•çš„æ—¶å€™ï¼Œæ ¹æ®å‚æ•°å»åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨äº†ï¼ˆå¯ä»¥é‡‡ç”¨åŒé‡æ£€æµ‹ï¼‰ï¼Œå­˜åœ¨åˆ™ç›´æ¥è¿”å›ï¼Œä¸å­˜åœ¨å†å»åˆ›å»ºï¼Œç„¶åå­˜å‚¨ï¼Œè¿”å›ã€‚ä¸ªäººç†è§£ï¼Œè¿™åº”è¯¥æ˜¯å•ä¾‹+ç®€å•å·¥å‚çš„ç»“åˆã€‚","like_count":59,"discussions":[{"author":{"id":2063037,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7a/bd/1f461acf.jpg","nickname":"è¥¿ç”µ","note":"","ucode":"95BD4CE9D93018","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293265,"discussion_content":"æ€è·¯æ¸…æ™°ï¼Œæ£’","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595494918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1019588,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/c4/8d1150f3.jpg","nickname":"Richie","note":"","ucode":"12314EF0347693","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2063037,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7a/bd/1f461acf.jpg","nickname":"è¥¿ç”µ","note":"","ucode":"95BD4CE9D93018","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293419,"discussion_content":"è°¢è°¢é¼“åŠ±ğŸ˜¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595524659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293265,"ip_address":""},"score":293419,"extra":""}]},{"author":{"id":1049235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/02/93/fed4baec.jpg","nickname":"Null","note":"","ucode":"D48077EBAD2E87","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388682,"discussion_content":"èµåŒï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628909654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180740,"user_name":"æå°å››","can_delete":false,"product_type":"c1","uid":1112747,"ip_address":"","ucode":"2A766BE16B276B","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/ab/0d39e745.jpg","comment_is_top":false,"comment_ctime":1582379036,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"126136430620","product_id":100039001,"comment_content":"è®¾è®¡æ¨¡å¼_42:<br># ä½œä¸š<br>1. å¯ä»¥æŠŠå•ä¾‹çš„å¯¹è±¡ä»¥ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¼ å…¥æ–¹æ³•ï¼›<br>2. ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œå¦‚æœå‚æ•°å‘ç”Ÿäº†å˜åŒ–ï¼Œåº”è¯¥æŠ›å‡ºå¼‚å¸¸ã€‚<br><br># æ„Ÿæƒ³<br>å¦ç™½è®²ï¼Œä¸€ç›´ä»¥ä½¿ç”¨åŒé‡æ£€æµ‹æ²¾æ²¾è‡ªå–œã€‚ã€‚ã€‚ç°åœ¨çœ‹æ¥ï¼Œè¦ä¸è¦ä½¿ç”¨å•ä¾‹è¦æ¯”ä½¿ç”¨é‚£ç§å•ä¾‹çš„å®ç°æ–¹å¼æ›´éœ€è¦æŠ•å…¥æ€è€ƒã€‚","like_count":29,"discussions":[{"author":{"id":1055475,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1a/f3/41d5ba7d.jpg","nickname":"iLeGeND","note":"","ucode":"4055A628A6E97C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352064,"discussion_content":"ä¼˜é›…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614588515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209710,"user_name":"æ—å­er","can_delete":false,"product_type":"c1","uid":1629256,"ip_address":"","ucode":"85637288F22CF0","user_header":"https://static001.geekbang.org/account/avatar/00/18/dc/48/9796286e.jpg","comment_is_top":false,"comment_ctime":1587603843,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61717145987","product_id":100039001,"comment_content":"ç”±äºå•ä¾‹æœ¬èº«å­˜åœ¨çš„ä¸€ç³»åˆ—ç¼ºç‚¹ï¼Œè€Œå•ä¾‹ä¸€èˆ¬åˆéƒ½æ˜¯å…¨å±€çš„ï¼Œå› è€Œä¸€èˆ¬æˆ‘ä»¬é¡¹ç›®ä¸­å¾ˆå°‘ç›´æ¥ä½¿ç”¨å•ä¾‹ï¼Œè€Œæ˜¯é€šè¿‡å®¹å™¨æ³¨å…¥ï¼Œè®©å®¹å™¨å……å½“å•ä¾‹å’Œå·¥å‚ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ç”šè‡³ä½¿ç”¨ä¼ªå•ä¾‹ï¼Œå³ç±»æœ¬èº«å¹¶ä¸æ˜¯å•ä¾‹çš„ï¼Œè€Œæ˜¯é€šè¿‡å®¹å™¨ä¿è¯å•ä¾‹æ€§ï¼Œå®é™…ç¼–ç¨‹ä¸­æŒ‰ç…§çº¦å®šåªé€šè¿‡å®¹å™¨è·å–è¯¥å®ä¾‹ã€‚<br>å‚æ•°åŒ–å•ä¾‹å®é™…ä¸­æ˜¯é€šè¿‡Mapè§£å†³çš„ï¼Œå³åŒæ ·çš„å‚æ•°æ‰è¿”å›åŒä¸€ä¸ªå®ä¾‹ï¼Œä¸åŒçš„å‚æ•°è¿”å›ä¸åŒçš„å®ä¾‹ï¼Œä¸ºäº†ä¿è¯å®ä¾‹ä¸ä¼šå¤ªå¤šï¼Œä¸€èˆ¬å¯ä¼ çš„å‚æ•°æˆ‘ä»¬ä¼šäº‹å…ˆåšäº†é™åˆ¶ï¼Œæ¯”å¦‚åªèƒ½ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± çš„åç§°ï¼‰","like_count":15},{"had_liked":false,"id":176413,"user_name":"webmin","can_delete":false,"product_type":"c1","uid":1047014,"ip_address":"","ucode":"98B0CA882454E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg","comment_is_top":false,"comment_ctime":1581053702,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"35940792070","product_id":100039001,"comment_content":"1. å¦‚æœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ<br>CacheManager.getInstance(long userId)ä¸­å¢åŠ Mockå¼€å…³ï¼Œå¦‚ï¼š<br>private User mockUser;<br>public CacheManager.setMockObj(User mockUser)<br>public User getInstance(long userId) {<br>     if(mockUser != null &amp;&amp; mockUser.getUserId() == userId) {<br>          return mockUser<br>     }<br>}<br>2. åœ¨å•ä¾‹æ”¯æŒå‚æ•°ä¼ é€’çš„ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸¤æ¬¡æ‰§è¡Œ getInstance(paramA, paramB) æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>ç¬¬ä¸€æ¬¡æ„é€ InstanceæˆåŠŸæ—¶éœ€è¦è®°å½•paramAå’ŒparamBï¼Œåœ¨ä»¥åçš„è°ƒç”¨éœ€è¦åŒ¹é…paramAä¸paramBæ„é€ æˆåŠŸInstanceæ—¶çš„å‚æ•°æ˜¯å¦ä¸€è‡³ï¼Œä¸ä¸€è‡³æ—¶éœ€è¦æŠ›å‡ºå¼‚å¸¸ã€‚","like_count":8},{"had_liked":false,"id":202103,"user_name":"å°éº¦","can_delete":false,"product_type":"c1","uid":1216881,"ip_address":"","ucode":"55C7199A0D5659","user_header":"https://static001.geekbang.org/account/avatar/00/12/91/71/0b16655d.jpg","comment_is_top":false,"comment_ctime":1585903525,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"27355707301","product_id":100039001,"comment_content":"ä¸å¤ªèƒ½ç†è§£çš„ä½¿ç”¨æ–¹å¼è¿èƒŒäº†åŸºäºæ¥å£è€Œéå®ç°çš„è®¾è®¡åŸåˆ™ï¼Œæ¯”å¦‚ spring ä¸­çš„ service ç±»ä¸€èˆ¬ä¹Ÿæ˜¯å•ä¾‹çš„ï¼Œä¹Ÿæ˜¯ç»§æ‰¿æ¥å£ï¼Œcontroller çš„è°ƒç”¨ä¹Ÿæ˜¯åŸºäºæ¥å£ï¼Œä¸è§‰å¾—æœ‰ä»€ä¹ˆé—®é¢˜å•Šï¼Œå¦‚æœå®ç°ç±»å˜äº†ï¼Œä¹Ÿåªæ˜¯æ”¹æ³¨å…¥è€Œå·²å•Šã€‚ ","like_count":6,"discussions":[{"author":{"id":1456188,"avatar":"https://static001.geekbang.org/account/avatar/00/16/38/3c/77738aa4.jpg","nickname":"æ¯«æ— æ ¹æ®çš„æ²‰æººäºç¾å¦™çš„å¹»æƒ³","note":"","ucode":"CE318147D99E3D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49543,"discussion_content":"OC æ˜¯Objective-C? é‚£å®ƒä¸æ”¯æŒå¤šç»§æ‰¿å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573611748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176308,"user_name":"é»„æ—æ™´","can_delete":false,"product_type":"c1","uid":1362631,"ip_address":"","ucode":"B15C38AECDA88F","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/c7/00e544c2.jpg","comment_is_top":false,"comment_ctime":1581012441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27350816217","product_id":100039001,"comment_content":"æ‰“å¡","like_count":6},{"had_liked":false,"id":176397,"user_name":"Eden Ma","can_delete":false,"product_type":"c1","uid":1457408,"ip_address":"","ucode":"755312F0D154F9","user_header":"https://static001.geekbang.org/account/avatar/00/16/3d/00/7daa7403.jpg","comment_is_top":false,"comment_ctime":1581049024,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23055885504","product_id":100039001,"comment_content":"<br>2ã€instanceä¸ä¸ºç©ºæŠ›å‡ºå¼‚å¸¸","like_count":5,"discussions":[{"author":{"id":1239557,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ea/05/c0d8014d.jpg","nickname":"ä¸€é“é˜³å…‰","note":"","ucode":"F35207CCCEC6E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49498,"discussion_content":"å¯¹ï¼Œæˆ‘ä¹Ÿæƒ³åˆ°äº†è¿™ç‚¹ï¼Œä½†æ˜¯ä¸ºå•¥æœ‰äº›éœ€è¦å¯ä»¥å®ç°å¤šé‡ç»§æ‰¿å‘¢ï¼Ÿç™¾æ€ä¸å¾—å…¶è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573606124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178311,"user_name":"å°å–µå–µ","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1581658828,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171593420","product_id":100039001,"comment_content":"2.å¯ä»¥ä½¿ç”¨åå°„ä¿®æ”¹å•ä¾‹ä¸­å‚æ•°ä¿¡æ¯","like_count":2},{"had_liked":false,"id":176952,"user_name":"Kenå¼ äº‘å¿ ","can_delete":false,"product_type":"c1","uid":1134288,"ip_address":"","ucode":"D0BAC9FC17DE2B","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/d0/d8a5f720.jpg","comment_is_top":false,"comment_ctime":1581235090,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171169682","product_id":100039001,"comment_content":"1.ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ<br>å°†å•ä¾‹ç±»ä¸­æ–°å¢ä¸€ä¸ªç”¨äºè·å–æµ‹è¯•instanceçš„å‡½æ•°,å‘½ågetTestInstance(User testUser),è¯¥å‡½æ•°ä¸­æŠŠéœ€è¦çš„æµ‹è¯•ç”¨ä¾‹é€šè¿‡å‚æ•°ä¼ å…¥instanceå½“ä¸­,å½“è¦åšæµ‹è¯•æ—¶å°±å¯ä»¥é€šè¿‡getTestInstanceå‡½æ•°æ¥è·å–å®ä¾‹å¾—åˆ°éœ€è¦çš„æµ‹è¯•æ•°æ®.<br>public boolean validateCachedUser(long userId) {<br>    User actualUser = userRepo.getUser(userId);<br>    &#47;&#47;User cachedUser = CacheManager.getInstance().getUser(userId);&#47;&#47;ç”Ÿäº§ä½¿ç”¨<br>    User cachedUser = CacheManager.getTestInstance(actualUser).getUser(userId);&#47;&#47;æµ‹è¯•ä½¿ç”¨<br>    &#47;&#47; çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...<br>  }<br>2.ç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>ç¬¬äºŒæ¬¡è°ƒç”¨getInstanceæ—¶å¦‚æœå¸¦æœ‰ä¸ä¹‹å‰ç›¸åŒå‚æ•°å°±ç›´æ¥è¿”å›instanceå®ä¾‹;å¦‚æœå‚æ•°ä¸ç›¸åŒä¸”ä¸šåŠ¡å…è®¸æ„å»ºæ–°çš„instanceå®ä¾‹å°±å…è®¸å†ç¬¬äºŒæ¬¡getInstanceæ—¶æ„å»ºæ–°çš„å®ä¾‹,å¦‚æœä¸šåŠ¡ä¸å…è®¸å°±åœ¨æ„å»ºæ—¶æŠ›å‡ºå¼‚å¸¸.<br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br>    if (instance == null) {<br>      instance = new Singleton(paramA, paramB);<br>    } else if (this.paramA != paramA || this.paramB != paramB) {<br>       &#47;&#47;instance = new Singleton(paramA, paramB);&#47;&#47; ä¸šåŠ¡å…è®¸<br>       throw new RuntimeException(&quot;Singleton has been created!&quot;);&#47;&#47; ä¸šåŠ¡ä¸å…è®¸<br>   }<br>    return instance;<br>  }","like_count":2},{"had_liked":false,"id":176357,"user_name":"è¾£ä¹ˆå¤§","can_delete":false,"product_type":"c1","uid":1396951,"ip_address":"","ucode":"AB308B6DCA0108","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","comment_is_top":false,"comment_ctime":1581042238,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"10170976830","product_id":100039001,"comment_content":"æ€è€ƒé¢˜1ï¼š<br>æå‡ºä¸€ä¸ªæ–¹æ³•ï¼špublic Uer getCahcedUser(userId){}ï¼Œç„¶åmock getCahcedUseræ–¹æ³•ã€‚<br>æµ‹è¯•ï¼š<br>public boolean validateCachedUesr(userid){<br>  User cachedUser = getMockCachedUserâ€¦<br>  User actualUser = userRepo.getUser(userid)<br>&#47;&#47; validate â€¦<br>}<br><br>æ€è€ƒé¢˜2ï¼š<br>A singleton with parameters is NOT a singleton because you may have more object than one of them.<br>æ”¹è¿›ï¼šå¾—åˆ°å•ä¾‹å¯¹è±¡åï¼Œå†åˆå§‹åŒ–å‚æ•°ã€‚<br>SingletonObj singleton = SingletonObj.getInstance()<br>singleton.init(paramA, paramB)<br>","like_count":2,"discussions":[{"author":{"id":1153978,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","nickname":"Linuxer","note":"","ucode":"272D9D8089C3D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49961,"discussion_content":"ä¸æ˜¯ä½ æ˜¯è¿™æ ·ï¼Œæˆ‘ä¹Ÿå¦‚æ­¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573653478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217443,"user_name":"Rogerå®‡","can_delete":false,"product_type":"c1","uid":1703222,"ip_address":"","ucode":"CBA23C01409349","user_header":"https://static001.geekbang.org/account/avatar/00/19/fd/36/f947c340.jpg","comment_is_top":false,"comment_ctime":1589506215,"is_pvip":false,"replies":[{"id":"80476","content":"æ ¹æ®ä¸šåŠ¡æ¥ä¼°ç®—çš„ï¼Œæœ‰äº›ä¸šåŠ¡æœ¬èº«å°±å¾ˆæ…¢ï¼Œå°±åˆ¤å®šä¸ºæ…¢sql","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹äº‰","uid":"1190123","ctime":1589524621,"ip_address":"","comment_id":217443,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5884473511","product_id":100039001,"comment_content":"æƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œæ‰€è°“ä¸¤ä¸ªèµ„æºæ± ï¼Œæ…¢çš„è¯·æ±‚ç‹¬å ä¸€ä¸ªçš„è®¾è®¡ï¼Œå¦‚ä½•çŸ¥é“ä¸€ä¸ªsqlè¯·æ±‚ä¼šå¿«ä¼šæ…¢ï¼Ÿå¿«ä¸æ…¢æ›´å¤šæ˜¯åœ¨è¿è¡Œåæ‰çŸ¥é“çš„ï¼Œå·²ç»è¿›å»è¿è¡Œäº†è¿˜æ€ä¹ˆä¿è¯ç‹¬å å‘¢ï¼Ÿé™¤éæœ‰æœºåˆ¶å¯ä»¥åœ¨å¤„ç†sqlè¯·æ±‚ä¹‹å‰è¯„ä¼°å¯èƒ½éœ€è¦çš„æ—¶é—´ã€‚","like_count":2,"discussions":[{"author":{"id":1396951,"avatar":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","nickname":"è¾£ä¹ˆå¤§","note":"","ucode":"AB308B6DCA0108","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49493,"discussion_content":"Goåªæœ‰æ¥å£ï¼Œå“ˆå“ˆå“ˆï¼è¿›ä¸€æ­¥ç®€åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573605791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202817,"user_name":"å°åŠ¨ç‰©","can_delete":false,"product_type":"c1","uid":1031683,"ip_address":"","ucode":"BCC35CE768EB99","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/03/404edf37.jpg","comment_is_top":false,"comment_ctime":1586073571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5881040867","product_id":100039001,"comment_content":"ä¹‹å‰é‡æ„è¿‡ä¸€ä¸ªç®€å•ä¸šåŠ¡æ¨¡å—ï¼ŒåŸå…¥å£æ˜¯ä¸€ä¸ªç®€å•çš„å•ä¾‹ï¼šbiz1class.getinstance().doSomething()ã€‚ä½†æ–°éœ€æ±‚å•ä¾‹æ¨¡å¼ä¸æ”¯æŒï¼Œéœ€è¦æ”¯æŒä¸åŒå¤„ç†ä¸šåŠ¡çš„æ¨¡å¼ï¼Œäºæ˜¯é‡æ„ã€‚<br>å½“æ—¶çš„æ€è·¯æ˜¯ï¼Œå…¶å®å®é™…ä¸šåŠ¡ä»£ç å¹¶ä¸å…³å¿ƒgetinstance()åè¿”å›çš„æ˜¯ä»€ä¹ˆã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•çš„è¿”å›ç±»å‹ç”±åŸæ¥çš„ç±»æ¢æˆæ¥å£å¯¹ä¸šåŠ¡ä»£ç è€Œè¨€ï¼ŒåŸºæœ¬æ— å½±å“ï¼Œæœ€å¤šé‡æ–°ç¼–è¯‘ä¸‹ä»£ç ã€‚<br>æ‰€ä»¥æœ€åçš„æ–¹æ¡ˆæ˜¯å°†åŸä¸šåŠ¡ç±»æä¾›çš„æ–¹æ³•æå–æˆåˆé€‚çš„æ¥å£ï¼Œå¹¶ç¼–å†™ç›¸å…³å®ç°ç±»ã€‚åŸgetInstance()æ–¹æ³•è¿”å›ç±»å‹æ”¹æˆæ¥å£ã€‚å¹¶æ ¹æ®å½“å‰é…ç½®è¿”å›ä¸åŒçš„å®ç°ç±»ä»¥æ»¡è¶³ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚<br><br>åŸºäºè¿™ä¸ªæ€è·¯ï¼Œæ–‡ç« ä¸­çš„é—®é¢˜åº”è¯¥å°±èƒ½è§£å†³äº†ã€‚è®©åŸå…ˆçš„biz1classçš„getinstanceæ–¹æ³•æ”¯æŒè¿”å›è‡ªå·±æƒ³è¦çš„å®ç°å³å¯ã€‚","like_count":1},{"had_liked":false,"id":176548,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1581084545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5876051841","product_id":100039001,"comment_content":" ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºäº†å¢åŠ å¯æµ‹è¯•æ€§ï¼Œä¹Ÿå°±æ˜¯å°½é‡å¯ä»¥æµ‹è¯•ä¸­é—´ç»“æœã€‚æˆ‘è§‰å¾—å¯ä»¥å°†cacheUseré‚£ä¸€è¡Œä»£ç å’Œä¸‹ä¸€è¡Œä»£ç åˆ†åˆ«æŠ½å–å‡ºæ¥å°è£…ğŸ“¦ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†å‚æ•°ä¿å­˜åœ¨é™æ€ç±»ä¸­ï¼Œæœ¬èº«è¿™ä¸ªç±»æ–°å¢ä¸€ä¸ªinitå‡½æ•°ï¼Œåœ¨new å¯¹è±¡åè¿›è¡Œè°ƒç”¨initã€‚è¿™æ ·ç”¨æˆ·å¯ä»¥ä¸éœ€è¦åŠ è½½å‚æ•°ã€‚å½“ç„¶äº†ï¼Œå¦‚æœä¸€å®šè¦åœ¨getInstanceæ—¶ä¼ å…¥å‚æ•°ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥æ ¡éªŒå‚æ•°æ˜¯å¦å’Œä¸Šä¸€æ¬¡ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸€è‡´ã€‚","like_count":1},{"had_liked":false,"id":358408,"user_name":"@äºŒåä¸€å¤§å”","can_delete":false,"product_type":"c1","uid":1075954,"ip_address":"ä¸Šæµ·","ucode":"394A7E80C5034C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6a/f2/8829a0b8.jpg","comment_is_top":false,"comment_ctime":1664276132,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664276132","product_id":100039001,"comment_content":"1.<br>public class Demo {<br><br>        private UserRepo userRepo; &#47;&#47; é€šè¿‡æ„é€ å“ˆå‡½æ•°æˆ–IOCå®¹å™¨ä¾èµ–æ³¨å…¥<br>        private CacheManager cacheManager; &#47;&#47; å°†è·å–CacheManagerå¯¹è±¡æå‡ºæ¥ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼åˆå§‹åŒ–<br><br>        public Demo(CacheManager cacheManager){<br>            this.cacheManager = cacheManager;<br>        }<br><br>        public boolean validateCachedUser(long userId) {<br>            User cachedUser = getCachedUser(userId);<br>            User actualUser =userRepo.getUser(userId);<br>            &#47;&#47; çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...<br>        }<br>        <br>        public User getCachedUser(long userId){<br>            return cacheManager.getInstance().getUser(userId);<br>        }<br><br>        static class MockManager extends CacheManager {<br>            private static MockManager mockManager;<br>            <br>            private MockManager(){}<br><br>            public static MockManager getInstance(){<br>                &#47;&#47;todo<br>                return mockManager;<br>            }<br><br>            public static User getUser(long userId){<br>                &#47;&#47; è¿”å›mockæ•°æ®<br>                return new User(userId);<br>            }<br>        }<br><br>    public static void main(String[] args) {<br>        CacheManager cacheManager = MockManager().getInstance();<br>        Demo demo = new Demo(cacheManager);<br>        User user = demo.getCachedUser(123L);<br>    }","like_count":0},{"had_liked":false,"id":354747,"user_name":"çº¢çƒ§å†°æ·‡æ·‹","can_delete":false,"product_type":"c1","uid":2650490,"ip_address":"åŒ—äº¬","ucode":"CF59ECC2FE70C6","user_header":"https://static001.geekbang.org/account/avatar/00/28/71/7a/3230370a.jpg","comment_is_top":false,"comment_ctime":1660741331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660741331","product_id":100039001,"comment_content":"éš¾é“å•ä¾‹æ¨¡å¼æœ€å¤§çš„é—®é¢˜ä¸æ˜¯æ²¡åŠæ³•æ¨ªå‘æ‰©å±•å—ï¼Ÿ<br><br>ç°åœ¨éƒ½æ˜¯å¤šå®ä¾‹éƒ¨ç½²äº†ï¼Œå•ä¸ªå®ä¾‹å†…éƒ¨çš„å•ä¾‹æ¨¡å¼æ²¡æœ‰å•¥æ„ä¹‰","like_count":1},{"had_liked":false,"id":350540,"user_name":"æ¬ç –å†œæ°‘å·¥ğŸ‘©â€ğŸŒ¾","can_delete":false,"product_type":"c1","uid":2873541,"ip_address":"","ucode":"50E0602562E968","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d8/c5/6a553741.jpg","comment_is_top":false,"comment_ctime":1656993362,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656993362","product_id":100039001,"comment_content":"ä¸ŠèŠ‚è¯¾ä¸­åˆè¯´é“ï¼Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥åšåˆ°å»¶è¿ŸåŠ è½½ï¼Œè¿™èŠ‚è¯¾è¯´åšä¸åˆ°ï¼Œæˆ‘çœ‹äº†ä¸‹èœé¸Ÿæ•™ç¨‹ï¼Œé™æ€å†…éƒ¨ç±»æ˜¯å¯ä»¥åšåˆ°å»¶è¿ŸåŠ è½½çš„ï¼Œä¸çŸ¥æ˜¯æˆ‘ç†è§£åšé”™äº†ï¼Œè¿˜æ˜¯è€å¸ˆä¸å°å¿ƒæ‰“é”™äº†","like_count":0},{"had_liked":false,"id":342969,"user_name":"Geek_7e0e83","can_delete":false,"product_type":"c1","uid":2142423,"ip_address":"","ucode":"554DEE2AAAE33C","user_header":"","comment_is_top":false,"comment_ctime":1650554154,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650554154","product_id":100039001,"comment_content":"1. å¯ä»¥æŠŠå•ä¾‹çš„è·å–IDçš„åŠŸèƒ½ç§»åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸­å°è£…èµ·æ¥ï¼Œç„¶åmocké‚£ä¸ªæ–°çš„æ–¹æ³•å³å¯<br>2.å¯ä»¥å½“instanceä¸ä¸ºnull çš„æ—¶å€™ æ‰“å°warnæ—¥å¿—ï¼Œæç¤ºç”¨æˆ·è¾“å…¥çš„å‚æ•°å·²ç»ä¸ç”Ÿæ•ˆäº†ï¼Œæˆ–è€…æ¢åˆ«çš„æ–¹å¼å®ç°å•ä¾‹ï¼Œæ¯”å¦‚é…ç½®æ–‡ä»¶çš„æ–¹å¼ã€‚è€Œä¸æ˜¯åœ¨instanceæ–¹æ³•ä¸ŠåŠ å…¥å‚","like_count":0},{"had_liked":false,"id":334311,"user_name":"çŸ¥è¡Œ","can_delete":false,"product_type":"c1","uid":1802022,"ip_address":"","ucode":"5AC8CBCC0AD48B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/7f/26/c5127e9a.jpg","comment_is_top":false,"comment_ctime":1644884359,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1644884359","product_id":100039001,"comment_content":"å…¶å®ï¼Œå•ä¾‹æ¨¡å¼å¯ä»¥è¢«åå°„ç ´å","like_count":0},{"had_liked":false,"id":319498,"user_name":"charmsongo","can_delete":false,"product_type":"c1","uid":1609051,"ip_address":"","ucode":"4FBEE716E93A1A","user_header":"https://static001.geekbang.org/account/avatar/00/18/8d/5b/383a49e4.jpg","comment_is_top":false,"comment_ctime":1635836854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635836854","product_id":100039001,"comment_content":"æ€»ç»“<br>1ã€å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜?<br>\t1. å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½<br>\t2. å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»<br>\t3. å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½<br>\t4. å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½<br>\t5. å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°<br>2ã€æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ<br>\tä¿è¯å…¨å±€å”¯ä¸€ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ã€‚ä½†å®ƒä¹Ÿä¸å¤Ÿçµæ´»ï¼Œä¸èƒ½æ‡’åŠ è½½<br>\tå·¥å‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰ä¹Ÿå¯ä»¥ä¿è¯å”¯ä¸€","like_count":0},{"had_liked":false,"id":319495,"user_name":"charmsongo","can_delete":false,"product_type":"c1","uid":1609051,"ip_address":"","ucode":"4FBEE716E93A1A","user_header":"https://static001.geekbang.org/account/avatar/00/18/8d/5b/383a49e4.jpg","comment_is_top":false,"comment_ctime":1635836387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635836387","product_id":100039001,"comment_content":"ä½œä¸š<br>1ã€ä¸¤ä¸ªå¯¹è±¡ä»¥å‚æ•°ä¼ å…¥ï¼Œç„¶åç›´æ¥å¯¹æ¯”2ä¸ªå¯¹è±¡å³å¯ï¼Œå¤–éƒ¨å¯ä»¥å•å†™2ä¸ªæ–¹æ³•<br>2ã€çœ‹äº†å¥½å¤šè¯„è®ºä¸ªäººçœ‹æ³•æœ‰ä¸¤ä¸ªï¼Œä¸€å¦‚æœä¸šåŠ¡éœ€è¦å­˜åœ¨ä¸åŒå‚æ•°çš„å®ä¾‹ï¼Œé‚£å•ä¾‹çš„è®¾è®¡å…¶å®å°±ä¸ç¬¦åˆäº†ï¼›äºŒå¦‚æœéœ€è¦åªèƒ½ä¸€ä¸ªå®ä¾‹ï¼Œä¸”æ ¹æ®ä¸šåŠ¡å‚æ•°å®æ—¶å˜åŠ¨é‚£æœ€å¥½æ˜¯å¼€æ”¾ä¸€ä¸ªupdateæ–¹æ³•å–ä¿®æ”¹ï¼Œåˆå§‹åŒ–å°±ä¸€æ¬¡ï¼Œåé¢ä¿®æ”¹ç”¨updateæ–¹æ³•","like_count":0},{"had_liked":false,"id":316920,"user_name":"MOSLX","can_delete":false,"product_type":"c1","uid":2732715,"ip_address":"","ucode":"FFE0FE1AED2BFB","user_header":"https://static001.geekbang.org/account/avatar/00/29/b2/ab/db3ce62d.jpg","comment_is_top":false,"comment_ctime":1634613271,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634613271","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®º2ï¼Œå°è¯•ç»´æŠ¤ä¸€ä¸ªHashMapå®¹å™¨ï¼Œåº”è¯¥èƒ½æ ¹æ®ä¸åŒçš„å‚æ•°ä¿æŒå•ä¾‹   <br> private static ParamSingleton instance = null;<br>    private static HashMap&lt;String, ParamSingleton&gt; context = new HashMap&lt;&gt;();<br>    private final int paramA;<br>    private final int paramB;<br><br>    private ParamSingleton(int paramA, int paramB){<br>        this.paramA = paramA;<br>        this.paramB = paramB;<br>    }<br><br>    public synchronized static ParamSingleton getInstance(int paramA, int paramB){<br>        String key = paramA + &quot;-&quot; + paramB;<br>        if(instance == null){<br>            instance = new ParamSingleton(paramA,paramB);<br>            context.put(key,instance);<br>        } else {<br>            instance = context.computeIfAbsent(key,k -&gt; new ParamSingleton(paramA,paramB));<br>        }<br>        return instance;<br>    }","like_count":0},{"had_liked":false,"id":304493,"user_name":"è¿æ˜Ÿç§‘æŠ€","can_delete":false,"product_type":"c1","uid":2642229,"ip_address":"","ucode":"C84FF7FF4AAE56","user_header":"https://static001.geekbang.org/account/avatar/00/28/51/35/d3a1144b.jpg","comment_is_top":false,"comment_ctime":1627454575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627454575","product_id":100039001,"comment_content":"go è¯­è¨€å¯ä»¥ç”¨é™æ€å…¨å±€å¯¹è±¡ï¼Œç»“æ„å¯¹è±¡å‘½åå°å†™ï¼Œåªèƒ½é€šè¿‡ä¸€ä¸ªGetå‡½æ•°å»è·å–ã€‚","like_count":0},{"had_liked":false,"id":296733,"user_name":"å°æ±Ÿçˆ±å­¦æœ¯","can_delete":false,"product_type":"c1","uid":2628601,"ip_address":"","ucode":"554F40C6627AF4","user_header":"https://static001.geekbang.org/account/avatar/00/28/1b/f9/018197f1.jpg","comment_is_top":false,"comment_ctime":1623136180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623136180","product_id":100039001,"comment_content":"é—®é¢˜1. åœ¨æ„é€ æ–¹æ³•ä¸­é€šè¿‡å‚æ•°çš„å½¢å¼æŠŠå•ä¾‹ä¼ è¿›æ¥ã€‚<br>é—®é¢˜2. æ—¢ç„¶å«å•ä¾‹ï¼Œæˆ‘è®¤ä¸ºæœ¬èº«å°±åº”è¯¥ä¿è¯å…¨å±€å”¯ä¸€æ€§ï¼Œé€šè¿‡getInstanceä¼ å‚çš„æ–¹æ³•å¸Œæœ›å•ä¾‹å¯ä»¥æ ¹æ®ä¼ å‚çš„ä¸åŒåŠ¨æ€æ”¹å˜ï¼Œæˆ‘è®¤ä¸ºæœ¬èº«ä¸å¤ªå¯å–ï¼Œæ˜¯ä»¤äººç–‘æƒ‘çš„åšæ³•ï¼Œè¿˜æ˜¯åº”è¯¥åœ¨å•ä¾‹ç±»ä¸­ï¼Œä»¥é…ç½®æ–‡ä»¶çš„æ–¹å¼åŠ è½½å‚æ•°ï¼Œä¿è¯å•ä¾‹å”¯ä¸€æ€§","like_count":0},{"had_liked":false,"id":295058,"user_name":"åº„å‘¨æ¢¦è¶","can_delete":false,"product_type":"c1","uid":1693576,"ip_address":"","ucode":"7878ED3EB11E97","user_header":"https://static001.geekbang.org/account/avatar/00/19/d7/88/7dcde249.jpg","comment_is_top":false,"comment_ctime":1622199566,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1622199566","product_id":100039001,"comment_content":"è€å¸ˆï¼Œæ‚¨è®²çš„ä»£æ›¿æ–¹æ¡ˆçš„æ„æ€ä¸è¿˜æ˜¯è¦ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹ä¹ˆï¼Œä¹Ÿå±äºå•ä¾‹å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":294944,"user_name":"JKwar","can_delete":false,"product_type":"c1","uid":1047466,"ip_address":"","ucode":"B733CA24D5701F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/aa/01fedf6c.jpg","comment_is_top":false,"comment_ctime":1622163168,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1622163168","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºä¸€ï¼šå¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§ï¼Œmockç±»å³åˆ»ã€‚<br>è¯¾å ‚è®¨è®ºäºŒï¼šç›´æ¥åˆ¤æ–­æ˜¯å¦å·²ç»åˆå§‹åŒ–ï¼Œå·²ç»åˆå§‹åŒ–å°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚","like_count":0},{"had_liked":false,"id":288064,"user_name":"Better me","can_delete":false,"product_type":"c1","uid":1261959,"ip_address":"","ucode":"CADF08D357489A","user_header":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","comment_is_top":false,"comment_ctime":1618284408,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1618284408","product_id":100039001,"comment_content":"1ã€è€ƒè™‘å°†å•ä¾‹CacheMangerå•ä¾‹å¯¹è±¡ä½œä¸ºDemoç±»çš„æˆå‘˜å˜é‡ï¼Œé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ï¼Œé‚£å°±å¯ä»¥é€šè¿‡Mockå‡ºæŒ‡å®šUserå¯¹è±¡è¿›è¡Œåç»­å¯¹æ¯”æµ‹è¯•<br>2ã€ä¸»è¦è¿˜æ˜¯è€ƒå¯Ÿéœ€æ±‚æ˜¯è¿™æ ·çš„ï¼ŒæŒ‰åŸæ–‡æ„æ€æ˜¯éœ€è¦ä¸åŒå‚æ•°ä¸åŒå®ä¾‹ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é€šè¿‡Mapç»´æŠ¤ä¼ å…¥å‚æ•°å’Œå®ä¾‹çš„æ˜ å°„å…³ç³»ï¼Œéœ€è¦æ³¨æ„æ„å»ºè¿‡ç¨‹çš„å®‰å…¨æ€§å’ŒæŒ‡å®šå‚æ•°çš„å”¯ä¸€æ€§","like_count":0},{"had_liked":false,"id":279105,"user_name":"è¾‰","can_delete":false,"product_type":"c1","uid":1697810,"ip_address":"","ucode":"0D7B2C24BA8BD2","user_header":"https://static001.geekbang.org/account/avatar/00/19/e8/12/74f387c8.jpg","comment_is_top":false,"comment_ctime":1613623236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613623236","product_id":100039001,"comment_content":"å•ä¾‹çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ä¸€äº›å­˜åœ¨çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚è‡³äºè¯´è¿™æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œæˆ‘è§‰å¾—ä¸å¤ªå¦¥ã€‚ä»»ä½•ä¸œè¥¿éƒ½æœ‰ä¸¤é¢æ€§ï¼Œå•ä¾‹ä¹Ÿä¸€æ ·ã€‚å¯¹äºä¸€äº›å…¬å…±çš„ç®¡ç†ç±»æ¥è¯´ï¼Œå•ä¾‹ç¡®å®æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚æ¯”å¦‚æˆ‘è¦ç®¡ç†ä¸€ä¸ªå…¨å±€çš„ç½‘ç»œçŠ¶æ€ï¼Œè¿™æ—¶å€™è®²è¿™ä¸ªç®¡ç†ç±»è®¾ç½®ä¸ºå•ä¾‹å°±æ˜¯åˆç†çš„ã€‚","like_count":0},{"had_liked":false,"id":267475,"user_name":"David","can_delete":false,"product_type":"c1","uid":1021825,"ip_address":"","ucode":"22CBBC13FC97A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/97/81/e1eaf621.jpg","comment_is_top":false,"comment_ctime":1607761564,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1607761564","product_id":100039001,"comment_content":"1. æŠŠUser cachedUser = CacheManager.getInstance().getUser(userId); <br>User actualUser = userRepo.getUser(userId);æ‹†æˆä¸¤ä¸ªæ–¹æ³•ï¼Œä¾¿äºä½¿ç”¨mockæµ‹è¯•<br>2. getInstanceæ–¹æ³•ä¸è¦åŠ å‚æ•°ã€‚","like_count":0},{"had_liked":false,"id":259777,"user_name":"å¿ƒæœ‰ä¸ç”˜","can_delete":false,"product_type":"c1","uid":2222598,"ip_address":"","ucode":"4B48BC4B357C3A","user_header":"https://static001.geekbang.org/account/avatar/00/21/ea/06/1bfbbf4f.jpg","comment_is_top":false,"comment_ctime":1604830351,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604830351","product_id":100039001,"comment_content":"è®¨è®ºä¸€ï¼š<br>  å•¥æ˜¯mockå•Šï¼Œå•¥æ˜¯å¯æµ‹è¯•æ€§å‘¢ã€‚ å¦‚æœæˆ‘è¦æµ‹è¯•validateCachedUser(long userId) æ–¹æ³•, ç›´æ¥å•å…ƒæµ‹è¯•è¿™ä¸ªæ–¹æ³•, ä¼ é€’å‚æ•°è¿›å»ï¼Œç”¨æ–­è¨€åˆ¤æ–­è¿è¡Œå€¼å’ŒæœŸæœ›å€¼ï¼Œè¿™ä¸ªç®—æµ‹è¯•ä¹ˆï¼Ÿæ²¡æœ‰ç†è§£å•ä¾‹æ¨¡å¼å¯¹è¿™é‡Œçš„å½±å“ã€‚<br><br>è®¨è®ºäºŒï¼šä¸ºä»€ä¹ˆç±»ä¸­çš„å‚æ•°ABè¦è®¾ç½®æˆfinalå‘¢ï¼Œä¸æä¾›ä¿®æ”¹æ–¹æ³•ï¼Œå€¼ä¹Ÿä¼šä¿®æ”¹ä¹ˆã€‚å¯å¦å»æ‰final,åœ¨getInsatanceæ–¹æ³•ä¸­ï¼Œå†åŠ å…¥ä¸€æ¬¡èµ‹å€¼å‘¢?<br><br>public class Singleton { <br>  private static Singleton instance = null; <br>  private int paramA; <br>  private int paramB; <br>  private Singleton(int paramA, int paramB) { <br>    this.paramA = paramA; <br>    this.paramB = paramB; <br>  } <br>  public synchronized static Singleton getInstance(int paramA, int paramB) { <br>    if (instance == null) { <br>      instance = new Singleton(paramA, paramB); <br>    } <br>    instance.paramA = paramA;<br>    instance.paramB = paramB;<br>    return instance; <br>  }<br>}<br>","like_count":0},{"had_liked":false,"id":257411,"user_name":"Daiver","can_delete":false,"product_type":"c1","uid":1466447,"ip_address":"","ucode":"9B1A03AFBC79BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/60/4f/db0e62b3.jpg","comment_is_top":false,"comment_ctime":1603962907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603962907","product_id":100039001,"comment_content":"å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªMapï¼Œå‚æ•°ABä½œä¸ºkeyï¼Œmapå­˜åœ¨åˆ™ç›´æ¥è¿”å›ï¼Œmapä¸å­˜åœ¨å®ä¾‹åŒ–ä¸€ä¸ªï¼Œå¹¶å­˜å…¥mapä¸­ï¼Œç„¶åè¿”å›ã€‚","like_count":0},{"had_liked":false,"id":253458,"user_name":"RedDevil","can_delete":false,"product_type":"c1","uid":1131128,"ip_address":"","ucode":"F8F5DC209BB3B9","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/78/7ba89c75.jpg","comment_is_top":false,"comment_ctime":1602744320,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602744320","product_id":100039001,"comment_content":"çœ‹äº‰å“¥çš„æ–‡ç« æœ‰ç§èŒ…å¡é¡¿å¼€çš„æ„Ÿè§‰","like_count":0},{"had_liked":false,"id":250696,"user_name":"Gopher","can_delete":false,"product_type":"c1","uid":1206229,"ip_address":"","ucode":"3C1F9012BB486D","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/d5/1b26b725.jpg","comment_is_top":false,"comment_ctime":1601198500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601198500","product_id":100039001,"comment_content":"1ã€åº”è¯¥æ˜¯æŠŠCacheMangerè¿™ä¸ªå¯¹åº”çš„ç±»ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°é‡Œï¼Œé€šè¿‡å‡½æ•°æ¥getInstance()ï¼Œè¿™æ ·mock çš„CacheManger å°±å¯ä»¥ä½œä¸ºå‚æ•°ä¼ è¿›å»äº†<br><br>2ã€æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæ˜¯é€šè¿‡ä¸åŒå‚æ•°æ¥è¿”å›ä¸åŒçš„å®ä¾‹ï¼Œå°±ä¸åº”è¯¥ç”¨å•åˆ©æ¥åšäº†","like_count":0},{"had_liked":false,"id":249774,"user_name":"Leaf","can_delete":false,"product_type":"c1","uid":1102194,"ip_address":"","ucode":"9AB56B7971237D","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/72/4cc8475c.jpg","comment_is_top":false,"comment_ctime":1600785885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600785885","product_id":100039001,"comment_content":"é¢˜ç›®ä¸€ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç±»åŒ…ä¸€å±‚ï¼Œå°è£…ä¸‹ CacheManagerï¼Œç„¶å mock è¿™å°è£…ç±»<br>é¢˜ç›®äºŒï¼Œå¦‚æœå…è®¸å­˜åœ¨å‚æ•°ä¸åŒå®ä¾‹ä¸åŒï¼Œå¯ä»¥ç”¨æ”¯æŒå¹¶å‘çš„å­—å…¸ä¿å­˜å¯¹è±¡(keyä¸ºparamsç”Ÿæˆï¼‰ï¼Œè¿™æ ·å°±èƒ½æ”¯æŒå‚æ•°ä¸åŒå®ä¾‹ä¸åŒ","like_count":0},{"had_liked":false,"id":248068,"user_name":"ç¥æ¯“é€é¥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1599999909,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1599999909","product_id":100039001,"comment_content":"æˆ‘æ˜¯Pythonå¼€å‘è€…ï¼Œç¬¬äºŒç§å¸Œæœ›ä¼ å…¥å‚æ•°ç”Ÿæ•ˆæ˜¯æœ‰è¿™ä¸ªåœºæ™¯éœ€æ±‚çš„ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥æ± ï¼Œå½“åœ¨forkå­è¿›ç¨‹æ—¶ï¼Œé…ç½®å‚æ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¸Œæœ›é‡æ–°ç”Ÿæˆå¯¹è±¡ï¼Œè¿™æ—¶å€™éœ€è¦ä¸åœ¨__init__ä¸­å®ä¾‹åŒ–ï¼Œè€Œè®¾è®¡ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå½“ä¼ å…¥force_refreshå‚æ•°ä¸ºTrueæ—¶é‡æ–°å®ä¾‹åŒ–","like_count":0,"discussions":[{"author":{"id":1079816,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","nickname":"Aaron Cheung","note":"","ucode":"03972759C53667","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305763,"discussion_content":"å¾ˆèµçš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600078471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242481,"user_name":"æœ¨å­","can_delete":false,"product_type":"c1","uid":1784886,"ip_address":"","ucode":"F9548C192F9687","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3c/36/94762d1c.jpg","comment_is_top":false,"comment_ctime":1597739114,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1597739114","product_id":100039001,"comment_content":"åœ¨æˆ‘ä»¬è§†é‡å†…ï¼ˆç»éªŒæˆ–è€…ä¸šåŠ¡å»ºæ¨¡ä¸Šï¼‰ï¼Œç«‹è¶³è„šä¸‹çš„å–åº”ç”¨å•ä¾‹æ¨¡å¼","like_count":0},{"had_liked":false,"id":238508,"user_name":"Next","can_delete":false,"product_type":"c1","uid":1748213,"ip_address":"","ucode":"D5ADDF248A9504","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ac/f5/2f97e279.jpg","comment_is_top":false,"comment_ctime":1596185766,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596185766","product_id":100039001,"comment_content":"é’ˆå¯¹å•ä¾‹æ‰©å±•æ€§çš„è§£å†³æ–¹æ³•ä¸¾ä¾‹ï¼š<br>ç”¨æˆ·IDç”Ÿæˆå™¨ï¼š<br>è¯­ä¹‰æ˜¯çœŸæ­£çš„å…¨å±€å”¯ä¸€ï¼Œé‡‡ç”¨å•åˆ—ï¼›<br>ä¸”ï¼›<br>IDç”Ÿæˆç®—æ³•æ˜¯å¯å˜æ›´çš„ï¼Œæ‰€ä»¥ä¸ç›´æ¥ä½¿ç”¨æŸä¸ªé€šç”¨çš„IDç”Ÿæˆå™¨ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·IDä¸“ç”¨çš„ç”Ÿæˆå™¨ï¼ŒåŒ…å«æŸä¸ªå®é™…çš„IDç”Ÿæˆç±»çš„å¼•ç”¨ã€‚å¦‚ä¸‹ï¼Œå¦‚æœè¦æ›´æ¢IDçš„ç”Ÿæˆæ–¹æ³•ï¼Œåªéœ€æ›¿æ¢æ‰SimpleSequenceIDGenã€‚<br>public enum UserID {<br>    I;<br>    private IIDLongGen gen = new SimpleSequenceIDGen();<br><br>    public long generate() {<br>        return gen.generate();<br>    }<br><br>}","like_count":0},{"had_liked":false,"id":237939,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1596010232,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596010232","product_id":100039001,"comment_content":"æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œå•ä¾‹ä¹Ÿæ˜¯å¯ä»¥å®ç°æ¥å£çš„ï¼Œå¯ä»¥é€šè¿‡é¢å‘æ¥å£ä¾èµ–æ³¨å…¥ã€‚","like_count":0},{"had_liked":false,"id":237541,"user_name":"å¤§æ–¹æ–¹","can_delete":false,"product_type":"c1","uid":1354013,"ip_address":"","ucode":"621AD8F1485753","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/6cyOoRd2dROgiblAJkW6RLhUyH1wwU0NNibIIuV930eQ9TiaNT41K61kBSVkvYoDYg7mJtuEoCQY1awBmV0WW6BFg/132","comment_is_top":false,"comment_ctime":1595858875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595858875","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ å‰é¢çš„ä»£ç æµ‹è¯•æ€§å·²ç»è®²è¿‡ï¼Œå°†éœ€è¦ç”¨åˆ°å•ä¾‹çš„åŠŸèƒ½å†wrapå‡ºæ¥ä¸€ä¸ªå‡½æ•°å’Œå­ç±»ï¼Œæµ‹è¯•æ—¶mockè¿™ä¸ªå­ç±» å¹¶æµ‹è¯•è¿™ä¸ªåŒ…è£¹å‡½æ•°å³å¯ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œè¿˜æ˜¯ç”¨ä¸ª initæˆ–è€…updateParameteræ¯”è¾ƒå¥½ ï¼Œä¸è¿‡é¡¹ç›®ä¸­å‡ ä¹æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„å®é™…é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":235815,"user_name":"Chord","can_delete":false,"product_type":"c1","uid":2019109,"ip_address":"","ucode":"6E248DA470FACC","user_header":"https://static001.geekbang.org/account/avatar/00/1e/cf/25/8c91fd43.jpg","comment_is_top":false,"comment_ctime":1595209852,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595209852","product_id":100039001,"comment_content":"è¯·é—®ï¼ŒåŒé‡æ ¡éªŒé”+é™æ€å†…éƒ¨ç±»çš„å®ç°æ–¹å¼ï¼Œæ— æ³•æ”¯æŒå«å‚æ„é€ å‡½æ•°å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":229555,"user_name":"maybe","can_delete":false,"product_type":"c1","uid":1475528,"ip_address":"","ucode":"93D160F617E750","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/c8/5ce842f6.jpg","comment_is_top":false,"comment_ctime":1593056722,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1593056722","product_id":100039001,"comment_content":"1ã€å•ä¾‹å¯¹OOPä¸å‹å¥½ã€‚OOPå››å¤§ç‰¹æ€§ï¼Œå°è£…ã€ç»§æ‰¿ã€æŠ½è±¡ã€å¤šæ€ã€‚å•ä¾‹è¿èƒŒåŸºäºæ¥å£è€Œéå®ç°è®¾è®¡åŸåˆ™ï¼Œå¹¿ä¹‰ä¸Šæ¥è¯´è¿èƒŒäº†æŠ½è±¡ç‰¹æ€§ã€‚å•ä¾‹ä¸€èˆ¬ä¸ä¼šè¢«ç»§æ‰¿ï¼Œæ‰€ä»¥ç›´æ¥æ”¾å¼ƒäº†ç»§æ‰¿ã€å¤šæ€ã€‚<br>2ã€å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚é˜…è¯»ä»£ç å¸Œæœ›ä¸€çœ¼èƒ½çœ‹å‡ºç±»ä¹‹é—´å…³ç³»ã€‚ä¸€èˆ¬é€šè¿‡æ„é€ å‡½æ•°ã€å‚æ•°ä¼ é€’ç­‰æ–¹å¼å£°æ˜ç±»ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œè€Œå•ä¾‹ä¸éœ€æ˜¾ç¤ºåˆ›å»ºã€ä¸éœ€è¦ä¼ é€’å‚æ•°ã€‚å¦‚æœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»æ¯”è¾ƒéšè”½ï¼Œé˜…è¯»ä»£ç å°±éœ€è¦éƒ½çœ‹å®Œæ¯ä¸ªå‡½æ•°çš„å®ç°æ‰èƒ½çœ‹å‡ºè¿™ç§å…³ç³»ã€‚<br>3ã€å•ä¾‹å¯¹ä»£ç æ‰©å±•æ€§ä¸å¥½ã€‚å•ä¾‹åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœæƒ³æ‰©å±•å¤šä¸ªå®ä¾‹ï¼Œä»£ç æ”¹åŠ¨å¤§ï¼Œä¿®æ”¹æˆæœ¬é«˜ã€‚<br>4ã€å•ä¾‹å¯¹ä»£ç å¯æµ‹è¯•æ€§ä¸å¥½ã€‚å•ä¾‹å¦‚æœä¾èµ–å¤–éƒ¨èµ„æºï¼Œæƒ³è¿›è¡Œmockæ›¿æ¢æµ‹è¯•ï¼Œä½†ç”±äºå•ä¾‹çš„ç¡¬ç¼–ç ï¼Œæ— æ³•mockã€‚è¿˜æœ‰å¦‚æœæœ‰å¯å˜æˆå‘˜å˜é‡ï¼Œå¤šä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œï¼Œéœ€è¦æ’é™¤æˆå‘˜å˜é‡çš„å˜åŒ–å¯¼è‡´æµ‹è¯•ç”¨ä¾‹é€šä¸è¿‡é—®é¢˜ã€‚<br>5ã€å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ„é€ å‡½æ•°ã€‚å¦‚æœæƒ³å®šåˆ¶è¿™ä¸ªå•ç±»ï¼Œå°±æ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿä¼šå¼•å‘ä¸€äº›è¯¯è§£ã€‚<br><br>æ€è€ƒé¢˜1ï¼šUser cachedUser = CacheManager.getInstance().getUser(userId);è¿™ä¸ªå•ç‹¬æŠ½æˆä¸€ä¸ªæ–¹æ³•ï¼ŒCacheManagerå•ä¾‹é€šè¿‡ä¾èµ–æ³¨å…¥æ–¹å¼æ³¨å…¥ã€‚User actualUser = userRepo.getUser(userId);è¿™ä¸ªä¹Ÿå•ç‹¬æŠ½æˆä¸€ä¸ªæ–¹æ³•ã€‚é’ˆå¯¹validateCachedUserå†™å•å…ƒæµ‹è¯•ï¼Œåªéœ€è¦å°†è·å–ä¸¤ä¸ªç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ç”¨mockæ›¿æ¢å³å¯ã€‚<br>æ€è€ƒé¢˜2ï¼šç¬¬ä¸€ç§é€šè¿‡æŠ›å‡ºå¼‚å¸¸æ¥æç¤ºé‡å¤ã€‚ç¬¬äºŒç§é€šè¿‡è¦†ç›–æ–¹å¼è¿›è¡Œã€‚","like_count":0},{"had_liked":false,"id":225700,"user_name":"scmath","can_delete":false,"product_type":"c1","uid":1149022,"ip_address":"","ucode":"641023BB246C29","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/5e/7c76f422.jpg","comment_is_top":false,"comment_ctime":1591837324,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591837324","product_id":100039001,"comment_content":"ä½¿ç”¨æ—¶æ›¿æ¢ï¼Œå•ä¾‹æ— æ³•ä½¿ç”¨æ—¶æ›¿æ¢","like_count":0},{"had_liked":false,"id":223326,"user_name":"å®ˆæ‹™","can_delete":false,"product_type":"c1","uid":1738326,"ip_address":"","ucode":"F594B2DA3F6D4F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/56/509535da.jpg","comment_is_top":false,"comment_ctime":1591062809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591062809","product_id":100039001,"comment_content":"&lt;äºŒå‘¨ç›®æ‹¾é—&gt;<br><br><br>&#47;**<br> * ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šé¢çš„ä»£ç å®ç°ç¨å¾®æœ‰ç‚¹é—®é¢˜ã€‚<br> * å¦‚æœæˆ‘ä»¬å¦‚ä¸‹ä¸¤æ¬¡æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œ<br> * é‚£è·å–åˆ°çš„ singleton1 å’Œ signleton2 çš„ paramA å’Œ paramB éƒ½æ˜¯ 10 å’Œ 50ã€‚<br> * ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒæ¬¡çš„å‚æ•°ï¼ˆ20ï¼Œ30ï¼‰æ²¡æœ‰èµ·ä½œç”¨ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br> * ç•™ç»™ä½ è‡ªå·±æ€è€ƒï¼Œä½ å¯ä»¥åœ¨ç•™è¨€åŒºè¯´è¯´ä½ çš„è§£å†³æ€è·¯ã€‚*&#47;<br>public class Singleton {<br><br>    private static volatile Singleton INSTANCE;<br><br>    private static int paramA;<br>    private static int paramB;<br><br>    private Singleton(){}<br><br>    public static Singleton getInstance(int paramA, int paramB){<br>        if (INSTANCE == null){<br>            synchronized (Singleton.class){<br>                if (INSTANCE == null){<br>                    INSTANCE = new Singleton();<br>                }<br>            }<br>        }<br><br>        if (INSTANCE.paramA != paramA || INSTANCE.paramB != paramB){<br>            INSTANCE.paramA = paramA;<br>            INSTANCE.paramB = paramB;<br>        }<br><br>        return INSTANCE;<br>    }<br>}","like_count":0},{"had_liked":false,"id":221023,"user_name":"buggetout","can_delete":false,"product_type":"c1","uid":1880582,"ip_address":"","ucode":"63A948EF415FDD","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/06/2086d76d.jpg","comment_is_top":false,"comment_ctime":1590383215,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590383215","product_id":100039001,"comment_content":"å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹<br>ä¸æ”¯æŒé¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œæ›´åƒæ˜¯é¢å‘è¿‡ç¨‹ã€‚<br>å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å¥½<br>å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å¥½<br>ä¸èƒ½æœ‰å¸¦å‚æ„é€ å‡½æ•°<br>","like_count":0},{"had_liked":false,"id":221005,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1590377409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590377409","product_id":100039001,"comment_content":"1. æˆ‘è§‰å¾—ç¬¬ä¸€é—®çš„å…³é”®åœ¨äº é‡Œé¢ç”¨äº†ä¸ªå•åˆ—(å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åœ¨ç”¨è¿™ä¸ªå•ä¾‹) ä¼šå½±å“æµ‹è¯•ç»“æœï¼Œæ‰€ä»¥æ‰ä¼šå¯¼è‡´å¯æµ‹è¯•æ€§ä¸é«˜ æ‰€ä»¥è€ƒè™‘æ–°å¢ä¸€ä¸ªæµ‹è¯•çš„æ•°æ®æˆ–è€…å®ä¾‹ è®©æ­£å¼çš„å’Œæµ‹è¯•çš„æ•°æ®åˆ†å¼€  åŒæ—¶è¿˜è¦åŠ é” ï¼Œé¿å…èµ„æºç«äº‰<br>2. ç¬¬äºŒé—® æˆ‘è§‰å¾— åº”è¯¥æ˜¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸(æˆ–è€…ç»™å‡ºä¸ªæç¤º) å·²ç»åˆå§‹åŒ–è¿‡äº† æœ€å¥½æ˜¯åŠ ä¸ªè¿”å›å€¼ åˆ¤æ–­initæ˜¯å¦æˆåŠŸå·²ç»å¤±è´¥çš„åŸå› ","like_count":0},{"had_liked":false,"id":215220,"user_name":"worthto","can_delete":false,"product_type":"c1","uid":1387712,"ip_address":"","ucode":"41D7ABBBD2E7FF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/N6yjnrLnMW4XVSkBr3f0N3F962l35b5j0kib9VSlAqqbf6iaoCPicL1WnJ9KjgT4egQ7A2G0Zx3OayaK4yuoZrUVA/132","comment_is_top":false,"comment_ctime":1588931968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588931968","product_id":100039001,"comment_content":"å…³äºé—®é¢˜ ç°æœ‰çš„ä»£ç ä¸­æœ‰å¤ªå¤šçš„å•ä¾‹ï¼Œå¯ä»¥è€ƒè™‘é‡å†™ç°æœ‰çš„å•ä¾‹å¯¹è±¡çš„newStanceæ–¹æ³•ï¼Œç„¶åå†ä¾èµ–æ³¨å…¥ä¸€ä¸ªå•ä¾‹å¯¹è±¡çš„ç”Ÿæˆå™¨InstanceBuilderç±»ï¼ŒæŠŠåˆ›å»ºçš„æ–¹æ³•æ”¾åˆ°è¿™ä¸ªç±»ä¸­ã€‚è¿™æ ·çš„è¯ï¼Œå°±æŠŠåˆ›å»ºè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„é€»è¾‘è§£è€¦äº†ï¼Œå•ä¾‹åªè´Ÿè´£å•ä¾‹å¯¹è±¡çš„ç®¡ç†ã€‚èŒè´£ä¹Ÿå•ä¸€ã€‚å¦‚æœéœ€è¦è¿›è¡Œmockï¼Œé‚£å°±å†™ä¸€ä¸ªInstanceBuilderMockç±»è¿›è¡Œæµ‹è¯•ã€‚","like_count":0},{"had_liked":false,"id":211983,"user_name":"ğŸ¸spray","can_delete":false,"product_type":"c1","uid":1062202,"ip_address":"","ucode":"D183FDBB32222C","user_header":"https://static001.geekbang.org/account/avatar/00/10/35/3a/3afc8d67.jpg","comment_is_top":false,"comment_ctime":1588042805,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1588042805","product_id":100039001,"comment_content":"2 - swift<br>final class Singleton {<br>    private static let _shared = Singleton()<br>    private var a: Int?<br>    private var b: Int?<br>    <br>    private init () {}<br>    public static func shared(a: Int = 0, b: Int = 0) -&gt; Singleton {<br>        _shared.a = a<br>        _shared.b = b<br>        return _shared<br>    }<br>}","like_count":0},{"had_liked":false,"id":210214,"user_name":"zhengyu.nie","can_delete":false,"product_type":"c1","uid":1541669,"ip_address":"","ucode":"FFE0377D323E46","user_header":"https://static001.geekbang.org/account/avatar/00/17/86/25/25ded6c3.jpg","comment_is_top":false,"comment_ctime":1587698807,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587698807","product_id":100039001,"comment_content":"æ•°æ®è¿æ¥æ± ã€çº¿ç¨‹æ± åœ¨Springç¯å¢ƒä¸‹å…¶å®è¿˜æ˜¯å•ä¾‹çš„ï¼Œåœ¨Springé‡å‹æ³¨å…¥æ¡†æ¶ä½“ç³»ä¸‹ï¼ŒåŸºæœ¬ä¸Šç¼–ç¨‹èŒƒå¼éƒ½æ˜¯ç”¨å¯¹åº”çš„@Configurationæ³¨è§£ä¸‹ï¼Œæ³¨å…¥éš”ç¦»çš„æ± å­ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªThreadPoolConfigurationï¼Œé‡Œé¢å‡ ä¸ª@Beanï¼Œæ¯ä¸€ä¸ªBeanæ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä¸šåŠ¡èº«ä»½éš”ç¦»ï¼Œä½¿ç”¨çš„åœ°æ–¹ä¾èµ–æŸ¥æ‰¾å¯¹åº”beanNameçš„æ± å­ï¼Œæ‰˜ç»™Springç®¡ç†äº†ã€‚","like_count":0},{"had_liked":false,"id":204737,"user_name":"Wh1","can_delete":false,"product_type":"c1","uid":1282715,"ip_address":"","ucode":"6D28506B99A285","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/9b/65f98192.jpg","comment_is_top":false,"comment_ctime":1586447706,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586447706","product_id":100039001,"comment_content":"å°†å•ä¾‹åˆå§‹åŒ–å‚æ•°æ”¾åˆ°Configç±»ä¸­è¿™æ®µä»£ç å…¶å®å­˜åœ¨é—®é¢˜ï¼Œå’Œç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹äº†åˆå§‹åŒ–å‚æ•°ï¼Œé‚£ä¹ˆè·å–åˆ°çš„ä¹Ÿä¼šæ˜¯ç”¨ä¹‹å‰çš„å‚æ•°åˆ›å»ºçš„å•ä¾‹å¯¹è±¡ã€‚<br>è§£å†³æ–¹æ¡ˆå¯ä»¥æ˜¯ï¼šä¸ç›´æ¥å¯¹Configç±»ä¸­çš„å‚æ•°èµ‹å€¼ï¼Œè€Œæ˜¯é€šè¿‡ setter åœ¨åˆå§‹åŒ– instance ä¹‹å‰è¿›è¡Œèµ‹å€¼ã€‚åŸç†å…¶å®å’Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆå·®ä¸å¤ªå¤šã€‚<br>ä½†å›è¿‡å¤´æƒ³ï¼Œå¦‚æœä¸€å¼€å§‹å°±é¢„æ–™åˆ°è¦é€šè¿‡ä¸åŒå‚æ•°åˆ›å»ºä¸åŒçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ç§åœºæ™¯ä¹Ÿä¸é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":204460,"user_name":"å¢¨é±¼","can_delete":false,"product_type":"c1","uid":1022720,"ip_address":"","ucode":"8FB5E4DCB8A024","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/00/654be3f7.jpg","comment_is_top":false,"comment_ctime":1586402734,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586402734","product_id":100039001,"comment_content":"ç¬¬äºŒé¢˜ï¼Œå¦‚æœç¬¬äºŒæ¬¡æ²¡æˆåŠŸï¼ŒæŠ›å‡ºå¼‚å¸¸å³å¯ã€‚<br><br>æ²¡æƒ³åˆ°å•ä¾‹æ¨¡å¼è¿˜æœ‰è¿™ä¹ˆå¤šç¼ºç‚¹ï¼Œè¿™æ˜¯æˆ‘æ²¡æƒ³åˆ°è¿‡çš„ï¼Œæˆ‘çœ‹åˆ«çš„æ–‡ç« éƒ½æ˜¯ç›´æ¥å‘Šè¯‰æˆ‘æ€ä¹ˆå®ç°å•ä¾‹æ¨¡å¼ï¼Œäº‰å“¥ç‰›é€¼","like_count":0},{"had_liked":false,"id":203114,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1324863,"ip_address":"","ucode":"FFC31A3FE3A285","user_header":"https://static001.geekbang.org/account/avatar/00/14/37/3f/a9127a73.jpg","comment_is_top":false,"comment_ctime":1586141362,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1586141362","product_id":100039001,"comment_content":"##æ€è€ƒé¢˜2<br>ç¬¬äºŒæ¬¡æ²¡æœ‰ç”Ÿæ•ˆä¹Ÿæ²¡æœ‰ç‰¹æ®Šæç¤ºçš„åŸå› åˆ†æï¼šå› ä¸ºç¬¬ä¸€æ¬¡å·²ç»åˆ›å»ºäº†å®ä¾‹ï¼Œæ‰€ä»¥ï¼Œç¬¬äºŒæ¬¡ç›´æ¥è¿”å›äº†ã€‚å¹¶æ²¡æœ‰èµ°å†æ¬¡èµ°åˆ°å•ä¾‹æ„é€ å‡½æ•°çš„æ‰§è¡Œï¼Œæ•…è€Œç›¸å…³çš„å€¼è¿˜æ˜¯åŸæ¥çš„å€¼ã€‚","like_count":0},{"had_liked":false,"id":202968,"user_name":"å²æœˆ","can_delete":false,"product_type":"c1","uid":1337598,"ip_address":"","ucode":"29A2A2BC3C4FE4","user_header":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","comment_is_top":false,"comment_ctime":1586095039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586095039","product_id":100039001,"comment_content":"æˆ‘æ„Ÿè§‰å•ä¾‹çš„è¿™äº›é—®é¢˜éƒ½ä¸æ˜¯é—®é¢˜ï¼Œå¤§ä¸äº†å°±ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼ï¼Œä»å¤–é¢ä¼ è¿›å»å®ä¾‹ã€‚è‡³äºå•ä¾‹æœ¬èº«å¯ä»¥äº†ä¾èµ–æ¥å£å¼€å‘","like_count":0},{"had_liked":false,"id":201494,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1585795651,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585795651","product_id":100039001,"comment_content":"åˆ°åº•å“ªä¸€ç‰ˆjdkå®ç°äº†å®ä¾‹åŒ–å¯¹è±¡é¿å…æŒ‡ä»¤é‡æ’ï¼Ÿï¼ŸæŒ‡ä»¤é‡æ’æœ¬æ¥å°±æ˜¯ä¸€ç§ä¼˜åŒ–æ‰‹æ®µï¼Œæˆ‘æ„Ÿè§‰ä¸å¯èƒ½ä¼šå…¨éƒ¨ç¦ç”¨æ‰å§ï¼Œæ‰‹åŠ¨volatileç¦ç”¨æ‰æ˜¯æœ€åˆç†çš„ã€‚è¯·è€å¸ˆå›å¤ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":200973,"user_name":"Geek_0a912e","can_delete":false,"product_type":"c1","uid":1797776,"ip_address":"","ucode":"3764D74EECF8E6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKAyfsLlZkYjRiaSiaxf07h6hNEu2AKyoZpCYqoE5K7xv13LdwCwE7ZDnSxr8drc5gOumgiapbn27KicA/132","comment_is_top":false,"comment_ctime":1585700766,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1585700766","product_id":100039001,"comment_content":"è¿™æ¡æ²¡å¤ªçœ‹æ˜ç™½ï¼Œéº»çƒ¦å†è§£é‡Šä¸€ä¸‹ï¼šå•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°","like_count":0,"discussions":[{"author":{"id":2446652,"avatar":"","nickname":"Geek_70aee8","note":"","ucode":"ABC47717D5B655","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354533,"discussion_content":"æˆ‘çš„çœ‹æ³•æ˜¯ï¼šæ­£å¦‚é—®é¢˜è®¨è®º2ä¸­çš„æƒ…å†µï¼Œå¦‚æœè¾“å…¥ä¸¤ç»„å‚æ•°è¿›å»çš„è¯ï¼Œéœ€è¦ä¿®æ”¹å•ä¾‹ç±»çš„ä»£ç ï¼Œæ‰èƒ½ä¿è¯è¾“å…¥ä¸åŒå‚æ•°æ—¶ç”Ÿæˆä¸åŒå•ä¾‹ç±»ï¼›å¦‚æœä¸¤æ¬¡è¾“å…¥å‚æ•°ä¸€è‡´ï¼Œè¿˜å¾—ä¿è¯ä¸¤æ¬¡è°ƒç”¨åŒä¸€ä¸ªå•ä¾‹ç±»ã€‚æ‰€ä»¥ï¼Œå•ä¾‹æ”¯æŒå¸¦å‚æ•°çš„æ„é€ å‡½æ•°çš„è¯ï¼Œä¼šäº§ç”Ÿè¯¯å¯¼ã€‚\nè§£å†³æ–¹æ³•ï¼šé€šè¿‡å°†å‚æ•°å†™æˆé…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œç„¶åæ„é€ å‡½æ•°å†…éƒ¨é€šè¿‡è¯»å–é…ç½®ä¿¡æ¯ç”Ÿæˆå¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615300102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1967515,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/7xB3OdNLiaPgZQibVAD52Jx04buk6Tb3I7A4wcdea2c6YXxJGdKgGCPgPuGWh69CffdSJKOqJFzVRVOEWBqFybJA/132","nickname":"Geek_83f2ce","note":"","ucode":"471D47B2A342E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294546,"discussion_content":"æˆ‘ä¹Ÿä¸å¤ªæ‡‚è¿™ä¸€ç‚¹ï¼Œæœ‰æ²¡æœ‰æ‡‚çš„å°ä¼™ä¼´ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595922749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198102,"user_name":"junmawang","can_delete":false,"product_type":"c1","uid":1763466,"ip_address":"","ucode":"977E9E25CE6C94","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e8/8a/803a42e0.jpg","comment_is_top":false,"comment_ctime":1585409229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585409229","product_id":100039001,"comment_content":"é’ˆå¯¹ä¸ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œå¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ä¸¤ä¸ªä¸´æ—¶å˜é‡ï¼Œå¯¹ä¸Šä¸€æ¬¡åˆ›å»ºå®ä¾‹å¯¹paramA, paramBèµ‹å€¼åˆ°ä¸´æ—¶å˜é‡ï¼Œä¸‹æ¬¡è°ƒç”¨åˆ¤æ–­æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™é‡æ–°åˆ›å»º","like_count":0},{"had_liked":false,"id":193623,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1584935396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584935396","product_id":100039001,"comment_content":"è€å¸ˆ   æˆ‘æ„Ÿè§‰è¿™æ®µå…¶å®ä¸ç®—æ˜¯ä¸€ç§æ–°çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒä»ç„¶ç®—æ˜¯â€œå•ä¾‹æ¨¡å¼â€å•Šï¼Œåªä¸è¿‡è¿™ä¸ªä¾‹å­æ¯”è¾ƒç‰¹æ®Šã€‚<br><br>public class IdGenerator {  private static AtomicLong id = new AtomicLong(0);    public static long getId() {     return id.incrementAndGet();  }}<br><br><br>","like_count":0},{"had_liked":false,"id":187307,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1584080674,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584080674","product_id":100039001,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1. ç”¨å·¥å‚æ¨¡å¼æŠŠCacheManager.getInstance()å¯¹è±¡åˆ›å»ºæå‡ºæ¥<br>2. <br>public class Singleton {<br>    private static Singleton instance = null;<br>    private final int paramA;<br>    private final int paramB;<br>    private static int variableA = 0;<br>    private static int variableB = 0;<br><br>    private Singleton(int paramA, int paramB) {<br>        this.paramA = paramA;<br>        this.paramB = paramB;<br>    }<br><br>    public synchronized static Singleton getInstance(int paramA, int paramB) {<br>        if (instance == null) {<br>            instance = new Singleton(paramA, paramB);<br>            variableA = paramA;<br>            variableB = paramB;<br>        } else if (paramA == variableA &amp;&amp; paramB == variableB) {<br>            return instance;<br>        } else {<br>            throw new RuntimeException(&quot;Parameter 20&#47;30 creation failed&quot;);<br>        }<br>        return instance;<br>    }<br><br>}<br>","like_count":0},{"had_liked":false,"id":183107,"user_name":"é›·åˆš","can_delete":false,"product_type":"c1","uid":1655725,"ip_address":"","ucode":"115FE2BE1AAB61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","comment_is_top":false,"comment_ctime":1582954565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582954565","product_id":100039001,"comment_content":"ä»¥å‰å†™è¿‡ä¸€ä¸ª TelnetManager çš„ç±»ï¼Œå†™å•å…ƒæµ‹è¯•çš„æ—¶å€™å¾ˆç—›è‹¦ï¼Œä¸è¿‡é‚£æ—¶å€™åªæ˜¯è§‰å¾—å•ä¾‹ä¸å¥½å†™å•å…ƒæµ‹è¯•ï¼Œæ²¡æœ‰ç»†æƒ³ï¼Œå¬äº†è€å¸ˆçš„åˆ†ææ‰è±ç„¶å¼€æœ—","like_count":0},{"had_liked":false,"id":181047,"user_name":"DullBird","can_delete":false,"product_type":"c1","uid":1110494,"ip_address":"","ucode":"80E2FD5F9687CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/de/3ebcbb3f.jpg","comment_is_top":false,"comment_ctime":1582465760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582465760","product_id":100039001,"comment_content":"1. æŠŠ CacheManager.getInstance().getUser(userId);å°è£…æˆæ–¹æ³•<br>2. åšä¸€ä¸ªåˆ¤æ–­ã€‚å¦‚æœå·²ç»åˆå§‹åŒ–æŠ›å‡ºå¼‚å¸¸","like_count":0},{"had_liked":false,"id":179793,"user_name":"å²æœˆ","can_delete":false,"product_type":"c1","uid":1337598,"ip_address":"","ucode":"29A2A2BC3C4FE4","user_header":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","comment_is_top":false,"comment_ctime":1582100552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582100552","product_id":100039001,"comment_content":"è®¨è®ºé¢˜1: è¿™é‡Œæµ‹è¯•çš„ä¸æ˜¯å•ä¾‹å¯¹è±¡, è€Œæ˜¯ä¾èµ–å•ä¾‹çš„ç±», æ‰€ä»¥å•ä¾‹å¯ä»¥ç›´æ¥ç”¨ä¾èµ–æ³¨å…¥çš„å½¢å¼ä¼ å…¥å³å¯, Demoç±»ä¸è¦åœ¨å†…éƒ¨åˆ›å»ºå•ä¾‹å¯¹è±¡, è€Œæ˜¯ç›´æ¥ä½¿ç”¨å¤–éƒ¨ä¼ å…¥çš„å•ä¾‹å¯¹è±¡.<br>è®¨è®ºé¢˜2: æŠŠä¸åŒçš„å‚æ•°è½¬æˆå­—ç¬¦ä¸²ä½œä¸ºkey, å†ç”¨ä¸€ä¸ªå­—å…¸é’ˆå¯¹æ¯ä¸€ä¸ªkeyå•ç‹¬åˆ›å»ºå•ä¾‹å¯¹è±¡, è¿™æ ·å¯ä»¥ä¿è¯ä¼ å…¥çš„å‚æ•°ç›¸åŒæ—¶è·å–åˆ°çš„å¯¹è±¡æ˜¯åŒä¸€ä¸ª, ä¸åŒå‚æ•°å¯¹åº”ä¸åŒå•ä¾‹å¯¹è±¡.","like_count":0},{"had_liked":false,"id":179495,"user_name":"HYM","can_delete":false,"product_type":"c1","uid":1054178,"ip_address":"","ucode":"4E82D9A285DAFF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/e2/c21553c4.jpg","comment_is_top":false,"comment_ctime":1582015910,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582015910","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæŠŠcache userçš„è·å–æ”¹æˆå‡½æ•°è¿”å›ï¼Œè¿™æ ·å¯ä»¥åœ¨æµ‹è¯•çš„æ—¶å€™å¯¹å‡½æ•°è¿›è¡Œmockã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼šæ­¤æ—¶éœ€è¦æ¯”è¾ƒå·²ç»å­˜åœ¨çš„instanceçš„å‚æ•°å’Œä¼ å…¥çš„æ–°å‚æ•°æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´å°±è¿”å›instanceï¼Œä¸ä¸€è‡´ç›´æ¥æŠ¥é”™ã€‚","like_count":0},{"had_liked":false,"id":178737,"user_name":"æ¡‚åŸè€æ‰˜å°¼","can_delete":false,"product_type":"c1","uid":1306032,"ip_address":"","ucode":"139E4B8EE88B79","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","comment_is_top":false,"comment_ctime":1581810136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581810136","product_id":100039001,"comment_content":"æ„Ÿè°¢åˆ†äº«ï¼Œå°è¯•å›ç­”ä¸‹<br>1,cacheManagerä½œä¸ºdemoçš„å±æ€§ï¼Œæ„é€ demoå¯¹è±¡æ—¶ è·å–å•ä¾‹ï¼Œè€Œéæ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶è·å–ã€‚<br>2ï¼ŒcompareAndUpdate æ€è·¯å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡è™½ç„¶èƒ½è§£å†³é—®é¢˜ï¼Œä½†è¿™ç§ç”¨æ³•çœŸçš„å¥½å—ï¼Ÿå¤ªåˆé’»äº†~","like_count":0},{"had_liked":false,"id":178618,"user_name":"FIGNT","can_delete":false,"product_type":"c1","uid":1540988,"ip_address":"","ucode":"D9DB185AE9E67C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ16iaIia0029oI1Qh5NicibpbTiaBAaCOPYXoLplKHr6uQ2rSVxPZanBvpMcL2NuhwKQYCFnaHP5tedQ/132","comment_is_top":false,"comment_ctime":1581760000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581760000","product_id":100039001,"comment_content":"1ã€å°†å•ä¾‹è·å–å¯¹è±¡çš„ä»£ç æŠ½ç¦»å•ç‹¬æ–¹æ³•ã€‚å†å¯¹æ–¹æ³•mock<br>2ã€å¦‚æœå‚æ•°ä¸ç›¸åŒï¼Œç›´æ¥æŠ¥é”™ï¼Œå‘Šè¯‰ä½¿ç”¨è€…å¦‚ä½•ä½¿ç”¨ã€‚<br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br>    if (instance == null) {<br>      instance = new Singleton(paramA, paramB);<br>    }else{<br>    \tif(paramA == this.paramA &amp;&amp; paramB == this.paramB){<br>    \t\treturn instance;<br>    \t}else{<br>    \t\tthrow new RuntimeException(&quot;illegal argument,please use getInstance(&quot;+this.paramA+&quot;,&quot;+this.paramB+&quot;) method&quot;);<br>    \t}<br>    }<br>  }","like_count":0},{"had_liked":false,"id":178045,"user_name":"LğŸš²ğŸ±","can_delete":false,"product_type":"c1","uid":1577856,"ip_address":"","ucode":"08A012739614DE","user_header":"https://static001.geekbang.org/account/avatar/00/18/13/80/2c9da1b1.jpg","comment_is_top":false,"comment_ctime":1581577673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581577673","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®º: 1. æŠŠ User cachedUser = CacheManager.getInstance().getUser(userId); æŠ½å‡ºæ¥, å˜æˆä¸€ä¸ªå‡½æ•°,è¿™æ ·å°±å¯ä»¥å¯¹å‡½æ•° mock äº†<br>             2. åœ¨è¿› getInstanceå‡½æ•°çš„æ—¶å€™, å¯¹å…¨å±€å˜é‡ instance ç½®ç©º<br><br>","like_count":0},{"had_liked":false,"id":177933,"user_name":"ä¸€åå°å­¦ç”Ÿ","can_delete":false,"product_type":"c1","uid":1137292,"ip_address":"","ucode":"5C73082E6B6370","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/8c/1fec5fa2.jpg","comment_is_top":false,"comment_ctime":1581553616,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581553616","product_id":100039001,"comment_content":"æ‰“å¡ï½","like_count":0},{"had_liked":false,"id":177448,"user_name":"å°åˆ€","can_delete":false,"product_type":"c1","uid":1351063,"ip_address":"","ucode":"94DF8C45E09E42","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/iaByN5IfYbE9jMtWrtTDXtPEIHeV77KW1p7ZkiasiaGgA50VXaibo4fbp5ib2JkFP3iaIe4AUudLibufkEIofu5euCNHg/132","comment_is_top":false,"comment_ctime":1581394703,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581394703","product_id":100039001,"comment_content":"ç¬¬äºŒæ¬¡è°ƒç”¨getInstanceæ—¶å¦‚æœå¸¦æœ‰ä¸ä¹‹å‰ç›¸åŒå‚æ•°å°±ç›´æ¥è¿”å›instanceå®ä¾‹;å¦‚æœå‚æ•°ä¸ç›¸åŒä¸”ä¸šåŠ¡å…è®¸æ„å»ºæ–°çš„instanceå®ä¾‹å°±å…è®¸å†ç¬¬äºŒæ¬¡getInstanceæ—¶æ„å»ºæ–°çš„å®ä¾‹,å¦‚æœä¸šåŠ¡ä¸å…è®¸å°±åœ¨æ„å»ºæ—¶æŠ›å‡ºå¼‚å¸¸.","like_count":0},{"had_liked":false,"id":177283,"user_name":"bin","can_delete":false,"product_type":"c1","uid":1307082,"ip_address":"","ucode":"EC4F4194082715","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/ca/9b9b8a7c.jpg","comment_is_top":false,"comment_ctime":1581341486,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581341486","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæŠŠ CacheManager.getInstance().getUser() å°è£…æˆä¸€ä¸ªå‡½æ•°,å¯ä»¥ç”¨æ¥mock<br>public User getCacheUser(long userId){<br>}<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒåŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œ<br><br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br> if (instance == null) { <br>     instance = new Singleton(paramA, paramB); <br>     return instance;<br> }<br>if( instance != null &amp;&amp; (paramA != this.paramA || paramB != this.paramB )  ){<br>     throw new RunTimeException(&quot;ä¸èƒ½é‡å¤åˆå§‹åŒ–&quot;);<br>}<br> return instance; <br>}","like_count":0},{"had_liked":false,"id":177239,"user_name":"å¤©å¤©å‘ä¸Šå¡ç´¢","can_delete":false,"product_type":"c1","uid":1009850,"ip_address":"","ucode":"E3724C3B39BD3F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/ba/c0cf8bf3.jpg","comment_is_top":false,"comment_ctime":1581330360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581330360","product_id":100039001,"comment_content":"åœ¨ .net core é‡Œï¼Œä¾èµ–æ³¨å…¥æ¨¡å¼çš„ä½¿ç”¨æ¯”è¾ƒå¤šï¼Œå¯¹äºä¸€äº›é…ç½®ä¼šé€šè¿‡optionsæ¨¡å¼æ¥å¤„ç†ï¼Œoptionä¹Ÿå¯ä»¥æ³¨å…¥ï¼Œå¾ˆçµæ´»","like_count":0},{"had_liked":false,"id":176980,"user_name":"Uncle.Wang","can_delete":false,"product_type":"c1","uid":1456955,"ip_address":"","ucode":"9A4F646CFC237F","user_header":"https://static001.geekbang.org/account/avatar/00/16/3b/3b/b8c00291.jpg","comment_is_top":false,"comment_ctime":1581240820,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581240820","product_id":100039001,"comment_content":"æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šåœ¨clientç«¯å¼€å‘çš„æ—¶å€™ï¼Œå·¥ç¨‹ä¸­æœ‰å¤§é‡å•ä¾‹ï¼Œè¿™äº›å•ä¾‹ä¸­ä¿å­˜ç€æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®å¯èƒ½æ˜¯å’Œç”¨æˆ·è´¦æˆ·ç›¸å…³è”çš„ï¼Œä¸€æ—¦åˆ‡æ¢è´¦å·ï¼Œé¢ä¸´resetè¿™äº›å•ä¾‹çš„é—®é¢˜ï¼Œå¾€å¾€å­˜åœ¨é—æ¼ã€‚å¦‚æœå¤§é‡å­˜åœ¨è¿™ç§å•ä¾‹ï¼Œä¼šå¾ˆéš¾ç»´æŠ¤ã€‚","like_count":0,"discussions":[{"author":{"id":1337598,"avatar":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","nickname":"å²æœˆ","note":"","ucode":"29A2A2BC3C4FE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222043,"discussion_content":"ä½ è¿™ä¸ªè¦ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè§‚å¯Ÿåˆ°è´¦å·å˜äº†ï¼Œå„è‡ªè‡ªè§‰æ›´æ–°æ•°æ®ã€‚è€Œä¸æ˜¯è¢«åŠ¨æ›´æ–°æ•°æ®ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586094515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176924,"user_name":"å®ˆæ‹™","can_delete":false,"product_type":"c1","uid":1738326,"ip_address":"","ucode":"F594B2DA3F6D4F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/56/509535da.jpg","comment_is_top":false,"comment_ctime":1581228054,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581228054","product_id":100039001,"comment_content":"<br><br><br><br>è¯¾å ‚è®¨è®º <br><br>1. ä¿®æ”¹validateCachedUser()æ–¹æ³•å½¢å‚: <br><br>   public boolean validateCachedUser(int userId, \tCacheManager manager){...}<br><br>â€‹    <br><br>2. å¸¦æœ‰å‚æ•°çš„getInstance()çš„ä¸€ç§å®ç°æ–¹å¼:<br><br>   public syncrinized static Singleton getInstance(int paramA, int paramB){<br><br>   â€‹    if(instance == null){<br><br>   â€‹        instance = new Singleton(paramA, paramB);<br><br>   â€‹        }<br><br>   <br><br>   â€‹    if(this.paramA != paramA || this.paramB != paramB){<br><br>   â€‹        instance = new Singleton(paramA, paramB);<br><br>   â€‹        }<br><br>   <br><br>   â€‹    return instance;<br><br>   }","like_count":0,"discussions":[{"author":{"id":1046893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f9/6d/b623562a.jpg","nickname":"éœ¹é›³å¤§ä»™pp","note":"","ucode":"F654FD9AEC1D56","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":195625,"discussion_content":" CacheManagerå¸¦åœ¨å½¢å‚é‡Œï¼Œè¿åäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼ŒæŠ½æˆä¸€ä¸ªprotectedæ–¹æ³•æ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583291970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176920,"user_name":"mghio","can_delete":false,"product_type":"c1","uid":1213078,"ip_address":"","ucode":"74883EDE4FD0DC","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","comment_is_top":false,"comment_ctime":1581225613,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581225613","product_id":100039001,"comment_content":"ä¼˜ç§€ï¼Œå•ä¾‹æ¨¡å¼ç«Ÿç„¶è¿˜æœ‰è¿™ä¹ˆå¤šé—®é¢˜ä»¥å‰åªæ˜¯ç”¨ï¼Œä»æ¥æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ–¹é¢","like_count":0},{"had_liked":false,"id":176699,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1581141690,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581141690","product_id":100039001,"comment_content":"1.æŠŠå•ä¾‹éƒ¨åˆ†æŠ½å‡ºæ¥ï¼›<br>2.ä¸ºç©ºæˆ–è€…ä¸€è‡´çš„æ—¶å€™è¿”å›å¯ç”¨instanceï¼Œä¸ä¸€è‡´åˆ™æŠ›é”™ã€‚","like_count":0},{"had_liked":false,"id":176680,"user_name":"å¹³é£é€ é›¨","can_delete":false,"product_type":"c1","uid":1014349,"ip_address":"","ucode":"F9EE4704F31E22","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/4d/b0228a1a.jpg","comment_is_top":false,"comment_ctime":1581137134,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581137134","product_id":100039001,"comment_content":"é—®é¢˜2ä½¿ç”¨ä¸åŒå‚æ•°æ„é€ ä¸åŒå•ä¾‹ï¼Œæ˜¯è¿™ä¸ªéœ€æ±‚å—ï¼Ÿå¦‚æœæ˜¯é‚£ä¹ˆç»´æŠ¤ç±»å°±ä¸èƒ½åªæœ‰ä¸€ä¸ªinstanceçš„æˆå‘˜å˜é‡ï¼Œåº”è¯¥è€ƒè™‘æœ‰ç±»ä¼¼cachedMapçš„æ–¹å¼ï¼Œinstanceè¦å®ç°equalså’ŒhashCodeæ–¹æ³•ï¼Œé’ˆå¯¹ä¸åŒå…¥å‚ä½œä¸ºä¸åŒçš„keyï¼Œçº¿ç¨‹å®‰å…¨çš„å»è®¿é—®cachedMapè¿›è¡Œå­˜å–ã€‚","like_count":0},{"had_liked":false,"id":176581,"user_name":"å¤±ç«çš„å¤å¤©","can_delete":false,"product_type":"c1","uid":1241770,"ip_address":"","ucode":"10C6E66EB2A65F","user_header":"https://static001.geekbang.org/account/avatar/00/12/f2/aa/32fc0d54.jpg","comment_is_top":false,"comment_ctime":1581091338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581091338","product_id":100039001,"comment_content":"ç›´æ¥æ›´æ–°å±æ€§æ€•æ˜¯ä¼šæœ‰ä¸€ä¸ªå®‰å…¨é—®é¢˜å§ï¼Œä¸€ä¸ªé•¿çº¿ç¨‹å¦‚æœä¸€ç›´åœ¨ä½¿ç”¨å¯¹è±¡ï¼Œä¸€ä¸ªå…¶ä»–çº¿ç¨‹è¿›æ¥åï¼ŒæŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„å±æ€§ç›´æ¥ä¿®æ”¹äº†ã€‚é•¿çº¿ç¨‹æ¥ä¸‹æ¥å¦‚æœä½¿ç”¨åˆ°å•ä¾‹å¯¹è±¡ï¼Œå±æ€§å°±å…¨å˜äº†ã€‚çº¿ç¨‹å®‰å…¨æ€§å¤ªå·®äº†ã€‚","like_count":0},{"had_liked":false,"id":176407,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1581052034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581052034","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥å…ˆæŠ½å–ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åmock ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥æ¯”è¾ƒä¼ å…¥çš„å‚æ•°å¯¹æ¯”ï¼Œç›¸åŒæ‰è¿›è¡Œæ–°å»ºå¯¹åº”å¯¹è±¡","like_count":0},{"had_liked":false,"id":176358,"user_name":"å¥½åƒä¸è´µ","can_delete":false,"product_type":"c1","uid":1316993,"ip_address":"","ucode":"6576E2BECE4F7C","user_header":"https://static001.geekbang.org/account/avatar/00/14/18/81/83b6ade2.jpg","comment_is_top":false,"comment_ctime":1581042586,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581042586","product_id":100039001,"comment_content":"å…³äºå•ä¾‹æ¨¡å¼çš„æ›¿æ¢æ–¹æ¡ˆã€‚ç±»å®ç°æ—¶normalClassç”¨æ™®é€šå†™æ³•ï¼Œæ„é€ å‡½æ•°ä¹Ÿæ˜¯publicçš„ã€‚åœ¨ç±»å¤–é¢ï¼Œå…¨å±€å®šä¹‰static normalClass obj;è¿™æ ·ç›´æ¥è°ƒç”¨objçš„æ–¹æ³•æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯å…¨å±€å”¯ä¸€äº†ï¼Œè‡³å°‘åŒä¸€è¿›ç¨‹å†…æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§å•ä¾‹çš„æ›¿ä»£æ–¹æ¡ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":176349,"user_name":"è¿·ç¾Š","can_delete":false,"product_type":"c1","uid":1286251,"ip_address":"","ucode":"85AF8CED3436C8","user_header":"https://static001.geekbang.org/account/avatar/00/13/a0/6b/0a21b2b8.jpg","comment_is_top":false,"comment_ctime":1581040330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581040330","product_id":100039001,"comment_content":"1.é€šè¿‡å‚æ•°çš„æ–¹å¼å°†å•ä¾‹ç±»ä¼ é€’è¿›å‡½æ•°ã€‚<br>2.å¦‚æœå•ä¾‹å¯¹è±¡å­˜åœ¨ï¼Œå°±å¯¹æ¯”ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œä¸ä¸€è‡´å°±æŠ›å‡ºå¼‚å¸¸æç¤ºè°ƒç”¨æ–¹ï¼Œä¸€è‡´å°±ç›´æ¥è¿”å›å•ä¾‹å¯¹è±¡ã€‚","like_count":0},{"had_liked":false,"id":176337,"user_name":"çŸ³ç»´åº·","can_delete":false,"product_type":"c1","uid":1067564,"ip_address":"","ucode":"E39ED8416B2C01","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/2c/f8451d77.jpg","comment_is_top":false,"comment_ctime":1581038842,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581038842","product_id":100039001,"comment_content":"<br>public class Singleton {<br>  private static Singleton instance = null;<br>  private final int paramA;<br>  private final int paramB;<br><br>  private Singleton(int paramA, int paramB) {<br>    this.paramA = paramA;<br>    this.paramB = paramB;<br>  }<br><br>  public static Singleton getInstance() {<br>    if (instance == null) {<br>       throw new RuntimeException(&quot;Run init() first.&quot;);<br>    }<br>    return instance;<br>  }<br><br>  public synchronized static Singleton init(int paramA, int paramB) {<br>    if (instance != null){<br>       throw new RuntimeException(&quot;Singleton has been created!&quot;);<br>    }<br>    instance = new Singleton(paramA, paramB);<br>    return instance;<br>  }<br>}<br><br>Singleton.init(10, 50); &#47;&#47; å…ˆinitï¼Œå†ä½¿ç”¨<br>Singleton singleton = Singleton.getInstance();<br><br>è¯·é—®è€å¸ˆè¿™é‡Œçš„initæ–¹æ³•ä¸ºä½•éœ€è¦è¿”å›ä¸€ä¸ªSingletonï¼Ÿå†™æˆvoidä¸è¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1316993,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/81/83b6ade2.jpg","nickname":"å¥½åƒä¸è´µ","note":"","ucode":"6576E2BECE4F7C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":163161,"discussion_content":"è²Œä¼¼voidä¹Ÿå¯ä»¥ï¼Ÿä¸è¿‡è¿”å›çš„instanceçš„è¯ï¼Œç³»ç»Ÿåˆå§‹åŒ–æ—¶å€™å¯ä»¥åˆ¤æ–­æ˜¯ä¸æ˜¯åˆå§‹åŒ–æˆåŠŸäº†ï¼Œæ›´å¥½äº›ã€‚çŒœæµ‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581055682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176344,"user_name":"å°æ™å­","can_delete":false,"product_type":"c1","uid":1132337,"ip_address":"","ucode":"3AAA6FB5ACB6AE","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/31/f35367c8.jpg","comment_is_top":false,"comment_ctime":1581039489,"is_pvip":false,"discussion_count":20,"race_medal":1,"score":"482617376641","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºï¼Œ<br>1. æŠŠä»£ç â€œUser cachedUser = CacheManager.getInstance().getUser(userId);â€å•ç‹¬æå–å‡ºæ¥åšæˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œè¿™æ ·è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¿›è¡Œmockäº†ï¼Œè¿›è€Œæ–¹ä¾¿æµ‹è¯•validateCachedUserã€‚<br>2. å¯ä»¥åˆ¤æ–­ä¼ è¿›æ¥çš„å‚æ•°å’Œå·²ç»å­˜åœ¨çš„instanceé‡Œé¢çš„ä¸¤ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œå°±ç›´æ¥è¿”å›å·²ç»å­˜åœ¨çš„instanceï¼Œå¦åˆ™å°±æ–°åˆ›å»ºä¸€ä¸ªinstanceè¿”å›ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š<br><br>public synchronized static Singleton getInstance(int paramA, int paramB) { <br>    if (instance == null) { <br>        instance = new Singleton(paramA, paramB); <br>    } else if (instance.paramA == paramA &amp;&amp; instance.paramB == paramB) {<br>        return instance;<br>    } else {<br>        instance = new Singleton(paramA, paramB);<br>    }<br>    return instance; <br>}","like_count":113,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510703,"discussion_content":"åŠ æ²¹ï¼Œçˆ±ä½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606700485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176503,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1581073343,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"327998587839","product_id":100039001,"comment_content":"æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œå…³é”®çœ‹ä½ æ€ä¹ˆç”¨ã€‚è¿™å¥è¯è¯´çš„å¾ˆå¯¹ï¼Œæ‰€ä»¥å…¶å®æ‰€è°“å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹è¿™ç§è¯´æ³•è¿˜æ˜¯æœ‰ç‚¹ç‰µå¼ºï¼","like_count":77,"discussions":[{"author":{"id":2336999,"avatar":"https://static001.geekbang.org/account/avatar/00/23/a8/e7/bedf7932.jpg","nickname":"å“‡å“ˆå“ˆ","note":"","ucode":"3A4FD1A3E657C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559692,"discussion_content":"ä¸ªäººè§‰å¾—å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§æ€æƒ³ï¼Œè¦çœ‹ä½ æ€ä¹ˆå®ç°è¿™ç§æ€æƒ³ï¼Œå°±java ç›®å‰é‚£å‡ ç§å®ç°æ€æƒ³çš„ä»£ç æœ‰å±€é™æ€§ï¼Œæ‰€ä»¥è¯´å«åšç¼ºç‚¹ï¼Œè¿™æ‰éœ€è¦æ”¹è¿›ä½¿å®ƒå¯ä»¥æ»¡è¶³ä¸€äº›å…¶ä»–çš„ä¸šåŠ¡éœ€æ±‚å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648883573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015189,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7d/95/dd73022c.jpg","nickname":"æˆ‘æ˜¯æ›¾ç»é‚£ä¸ªå°‘å¹´","note":"","ucode":"9F02F7FF147D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530425,"discussion_content":"æ˜¯çš„ï¼Œç”¨å•ä¾‹è¦çŸ¥é“ä»–ä½¿ç”¨çš„åœºæ™¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637071845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185662,"user_name":"Richie","can_delete":false,"product_type":"c1","uid":1019588,"ip_address":"","ucode":"12314EF0347693","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/c4/8d1150f3.jpg","comment_is_top":false,"comment_ctime":1583657389,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"250691760557","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºç¬¬2ç‚¹ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥å…ˆææ¸…æ¥šéœ€æ±‚ï¼Œä¸ºä»€ä¹ˆéœ€è¦åœ¨getInstance()æ–¹æ³•ä¸­åŠ å‚æ•°ï¼Œæƒ³è¦è¾¾åˆ°ä»€ä¹ˆç›®çš„ï¼Ÿ<br>è¿™é‡Œåˆ†ä¸¤ç§æƒ…å†µè®¨è®ºä¸€ä¸‹ï¼š<br>1. å¦‚æœçš„ç¡®éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ç±»ï¼Œå¹¶ä¸”è¿™ä¸ªç±»åªèƒ½è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œé‚£ä¹ˆåº”è¯¥é‡‡ç”¨æ–‡ä¸­æåˆ°çš„ç¬¬ä¸‰ç§è§£å†³æ€è·¯ï¼Œå³å°†æ‰€éœ€å‚æ•°æ”¾åˆ°å…¨å±€çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œä»è€Œé¿å…å¤šæ¬¡åˆå§‹åŒ–å‚æ•°è¢«å¿½ç•¥æˆ–è€…æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸çš„é—®é¢˜ï¼›<br>2. å¦‚æœæ˜¯è¦æ ¹æ®ä¸åŒå‚æ•°æ„é€ å‡ºä¸åŒçš„å¯¹è±¡ï¼Œå¹¶ä¸”ç›¸åŒå‚æ•°çš„å¯¹è±¡åªè¢«æ„é€ ä¸€æ¬¡ï¼Œé‚£ä¹ˆåº”è¯¥æ”¹æˆåœ¨Singletonç±»ä¸­ç»´æŠ¤ä¸€ä¸ªHashMapï¼Œç„¶åæ¯æ¬¡è°ƒç”¨getInstance()æ–¹æ³•çš„æ—¶å€™ï¼Œæ ¹æ®å‚æ•°å»åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨äº†ï¼ˆå¯ä»¥é‡‡ç”¨åŒé‡æ£€æµ‹ï¼‰ï¼Œå­˜åœ¨åˆ™ç›´æ¥è¿”å›ï¼Œä¸å­˜åœ¨å†å»åˆ›å»ºï¼Œç„¶åå­˜å‚¨ï¼Œè¿”å›ã€‚ä¸ªäººç†è§£ï¼Œè¿™åº”è¯¥æ˜¯å•ä¾‹+ç®€å•å·¥å‚çš„ç»“åˆã€‚","like_count":59,"discussions":[{"author":{"id":2063037,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7a/bd/1f461acf.jpg","nickname":"è¥¿ç”µ","note":"","ucode":"95BD4CE9D93018","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293265,"discussion_content":"æ€è·¯æ¸…æ™°ï¼Œæ£’","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595494918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1019588,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/c4/8d1150f3.jpg","nickname":"Richie","note":"","ucode":"12314EF0347693","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2063037,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/7a/bd/1f461acf.jpg","nickname":"è¥¿ç”µ","note":"","ucode":"95BD4CE9D93018","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293419,"discussion_content":"è°¢è°¢é¼“åŠ±ğŸ˜¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595524659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293265,"ip_address":""},"score":293419,"extra":""}]},{"author":{"id":1049235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/02/93/fed4baec.jpg","nickname":"Null","note":"","ucode":"D48077EBAD2E87","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388682,"discussion_content":"èµåŒï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628909654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180740,"user_name":"æå°å››","can_delete":false,"product_type":"c1","uid":1112747,"ip_address":"","ucode":"2A766BE16B276B","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/ab/0d39e745.jpg","comment_is_top":false,"comment_ctime":1582379036,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"126136430620","product_id":100039001,"comment_content":"è®¾è®¡æ¨¡å¼_42:<br># ä½œä¸š<br>1. å¯ä»¥æŠŠå•ä¾‹çš„å¯¹è±¡ä»¥ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¼ å…¥æ–¹æ³•ï¼›<br>2. ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œå¦‚æœå‚æ•°å‘ç”Ÿäº†å˜åŒ–ï¼Œåº”è¯¥æŠ›å‡ºå¼‚å¸¸ã€‚<br><br># æ„Ÿæƒ³<br>å¦ç™½è®²ï¼Œä¸€ç›´ä»¥ä½¿ç”¨åŒé‡æ£€æµ‹æ²¾æ²¾è‡ªå–œã€‚ã€‚ã€‚ç°åœ¨çœ‹æ¥ï¼Œè¦ä¸è¦ä½¿ç”¨å•ä¾‹è¦æ¯”ä½¿ç”¨é‚£ç§å•ä¾‹çš„å®ç°æ–¹å¼æ›´éœ€è¦æŠ•å…¥æ€è€ƒã€‚","like_count":29,"discussions":[{"author":{"id":1055475,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1a/f3/41d5ba7d.jpg","nickname":"iLeGeND","note":"","ucode":"4055A628A6E97C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352064,"discussion_content":"ä¼˜é›…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614588515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":209710,"user_name":"æ—å­er","can_delete":false,"product_type":"c1","uid":1629256,"ip_address":"","ucode":"85637288F22CF0","user_header":"https://static001.geekbang.org/account/avatar/00/18/dc/48/9796286e.jpg","comment_is_top":false,"comment_ctime":1587603843,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61717145987","product_id":100039001,"comment_content":"ç”±äºå•ä¾‹æœ¬èº«å­˜åœ¨çš„ä¸€ç³»åˆ—ç¼ºç‚¹ï¼Œè€Œå•ä¾‹ä¸€èˆ¬åˆéƒ½æ˜¯å…¨å±€çš„ï¼Œå› è€Œä¸€èˆ¬æˆ‘ä»¬é¡¹ç›®ä¸­å¾ˆå°‘ç›´æ¥ä½¿ç”¨å•ä¾‹ï¼Œè€Œæ˜¯é€šè¿‡å®¹å™¨æ³¨å…¥ï¼Œè®©å®¹å™¨å……å½“å•ä¾‹å’Œå·¥å‚ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ç”šè‡³ä½¿ç”¨ä¼ªå•ä¾‹ï¼Œå³ç±»æœ¬èº«å¹¶ä¸æ˜¯å•ä¾‹çš„ï¼Œè€Œæ˜¯é€šè¿‡å®¹å™¨ä¿è¯å•ä¾‹æ€§ï¼Œå®é™…ç¼–ç¨‹ä¸­æŒ‰ç…§çº¦å®šåªé€šè¿‡å®¹å™¨è·å–è¯¥å®ä¾‹ã€‚<br>å‚æ•°åŒ–å•ä¾‹å®é™…ä¸­æ˜¯é€šè¿‡Mapè§£å†³çš„ï¼Œå³åŒæ ·çš„å‚æ•°æ‰è¿”å›åŒä¸€ä¸ªå®ä¾‹ï¼Œä¸åŒçš„å‚æ•°è¿”å›ä¸åŒçš„å®ä¾‹ï¼Œä¸ºäº†ä¿è¯å®ä¾‹ä¸ä¼šå¤ªå¤šï¼Œä¸€èˆ¬å¯ä¼ çš„å‚æ•°æˆ‘ä»¬ä¼šäº‹å…ˆåšäº†é™åˆ¶ï¼Œæ¯”å¦‚åªèƒ½ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± çš„åç§°ï¼‰","like_count":15},{"had_liked":false,"id":176413,"user_name":"webmin","can_delete":false,"product_type":"c1","uid":1047014,"ip_address":"","ucode":"98B0CA882454E8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg","comment_is_top":false,"comment_ctime":1581053702,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"35940792070","product_id":100039001,"comment_content":"1. å¦‚æœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ<br>CacheManager.getInstance(long userId)ä¸­å¢åŠ Mockå¼€å…³ï¼Œå¦‚ï¼š<br>private User mockUser;<br>public CacheManager.setMockObj(User mockUser)<br>public User getInstance(long userId) {<br>     if(mockUser != null &amp;&amp; mockUser.getUserId() == userId) {<br>          return mockUser<br>     }<br>}<br>2. åœ¨å•ä¾‹æ”¯æŒå‚æ•°ä¼ é€’çš„ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸¤æ¬¡æ‰§è¡Œ getInstance(paramA, paramB) æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>ç¬¬ä¸€æ¬¡æ„é€ InstanceæˆåŠŸæ—¶éœ€è¦è®°å½•paramAå’ŒparamBï¼Œåœ¨ä»¥åçš„è°ƒç”¨éœ€è¦åŒ¹é…paramAä¸paramBæ„é€ æˆåŠŸInstanceæ—¶çš„å‚æ•°æ˜¯å¦ä¸€è‡³ï¼Œä¸ä¸€è‡³æ—¶éœ€è¦æŠ›å‡ºå¼‚å¸¸ã€‚","like_count":8,"discussions":[{"author":{"id":1387712,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/N6yjnrLnMW4XVSkBr3f0N3F962l35b5j0kib9VSlAqqbf6iaoCPicL1WnJ9KjgT4egQ7A2G0Zx3OayaK4yuoZrUVA/132","nickname":"worthto","note":"","ucode":"41D7ABBBD2E7FF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261030,"discussion_content":"ä¸ªäººè§‰å¾—mockä»£ç æ”¾å…¥åˆ°æ­£å¸¸çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæ˜¯ä¸å¯å–çš„ï¼Œä¾µå…¥æ€§å¤ªå¼ºã€‚ç°æœ‰çš„ä»£ç ä¸­æœ‰å¤ªå¤šçš„å•ä¾‹ï¼Œå¯ä»¥è€ƒè™‘é‡å†™ç°æœ‰çš„å•ä¾‹å¯¹è±¡çš„newStanceæ–¹æ³•ï¼Œç„¶åå†ä¾èµ–æ³¨å…¥ä¸€ä¸ªå•ä¾‹å¯¹è±¡çš„ç”Ÿæˆå™¨InstanceBuilderç±»ï¼ŒæŠŠåˆ›å»ºçš„æ–¹æ³•æ”¾åˆ°è¿™ä¸ªç±»ä¸­ã€‚è¿™æ ·çš„è¯ï¼Œå°±æŠŠåˆ›å»ºè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„é€»è¾‘è§£è€¦äº†ï¼Œå•ä¾‹åªè´Ÿè´£å•ä¾‹å¯¹è±¡çš„ç®¡ç†ã€‚èŒè´£ä¹Ÿå•ä¸€ã€‚","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1588931903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1611025,"avatar":"https://static001.geekbang.org/account/avatar/00/18/95/11/eb431e52.jpg","nickname":"æ²ˆåº·","note":"","ucode":"02AFA50738AB8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":165097,"discussion_content":"ç¬¬ä¸€ç§æ–¹æ³•ä¸å¥½å‘€ï¼Œæ„Ÿè§‰1æ¥¼çš„å¥½ç‚¹","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1581254603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019588,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8e/c4/8d1150f3.jpg","nickname":"Richie","note":"","ucode":"12314EF0347693","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":200069,"discussion_content":"ç¬¬ä¸€é—®çš„å›ç­”ä¸­ï¼Œæˆ‘è§‰å¾—æ€è·¯ä¸é”™ï¼Œä½†æ˜¯ä»£ç å†™æ³•æœ‰ç‚¹é—®é¢˜ã€‚è¦Mockçš„åº”è¯¥æ˜¯CacheManagerå®ä¾‹ï¼Œè€Œä¸æ˜¯Userå®ä¾‹ï¼›è€Œä¸”ï¼ŒgetInstance()æ–¹æ³•æœ¬æ˜¯æ— å‚æ•°çš„ï¼Œè¿™æ ·å†™å°±ä¸å…¼å®¹äº†ï¼Œè¯­ä¹‰ä¸Šä¹Ÿä¸å¯¹ï¼Œæ–¹æ³•è¿”å›çš„åº”è¯¥æ˜¯CacheManagerå¯¹è±¡è€Œä¸æ˜¯Userå¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583654117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202103,"user_name":"å°éº¦","can_delete":false,"product_type":"c1","uid":1216881,"ip_address":"","ucode":"55C7199A0D5659","user_header":"https://static001.geekbang.org/account/avatar/00/12/91/71/0b16655d.jpg","comment_is_top":false,"comment_ctime":1585903525,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"27355707301","product_id":100039001,"comment_content":"ä¸å¤ªèƒ½ç†è§£çš„ä½¿ç”¨æ–¹å¼è¿èƒŒäº†åŸºäºæ¥å£è€Œéå®ç°çš„è®¾è®¡åŸåˆ™ï¼Œæ¯”å¦‚ spring ä¸­çš„ service ç±»ä¸€èˆ¬ä¹Ÿæ˜¯å•ä¾‹çš„ï¼Œä¹Ÿæ˜¯ç»§æ‰¿æ¥å£ï¼Œcontroller çš„è°ƒç”¨ä¹Ÿæ˜¯åŸºäºæ¥å£ï¼Œä¸è§‰å¾—æœ‰ä»€ä¹ˆé—®é¢˜å•Šï¼Œå¦‚æœå®ç°ç±»å˜äº†ï¼Œä¹Ÿåªæ˜¯æ”¹æ³¨å…¥è€Œå·²å•Šã€‚ ","like_count":6,"discussions":[{"author":{"id":1394822,"avatar":"https://static001.geekbang.org/account/avatar/00/15/48/86/54c68afe.jpg","nickname":"é“ç”·ç¥sama","note":"","ucode":"0A3E3E61D36EDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308996,"discussion_content":"é€»è¾‘é¬¼æ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601166144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296314,"discussion_content":"Springè¿™ç§å®¹å™¨æŠ€æœ¯ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å•ä¾‹çš„æ›¿ä»£å“äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596508101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1958147,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/e1/03/f937e673.jpg","nickname":"ğŸ€","note":"","ucode":"60E0AC2A55B63B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226619,"discussion_content":"æ­¤æ¥å£éå½¼æ¥å£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586437420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176308,"user_name":"é»„æ—æ™´","can_delete":false,"product_type":"c1","uid":1362631,"ip_address":"","ucode":"B15C38AECDA88F","user_header":"https://static001.geekbang.org/account/avatar/00/14/ca/c7/00e544c2.jpg","comment_is_top":false,"comment_ctime":1581012441,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27350816217","product_id":100039001,"comment_content":"æ‰“å¡","like_count":6},{"had_liked":false,"id":176397,"user_name":"Eden Ma","can_delete":false,"product_type":"c1","uid":1457408,"ip_address":"","ucode":"755312F0D154F9","user_header":"https://static001.geekbang.org/account/avatar/00/16/3d/00/7daa7403.jpg","comment_is_top":false,"comment_ctime":1581049024,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23055885504","product_id":100039001,"comment_content":"<br>2ã€instanceä¸ä¸ºç©ºæŠ›å‡ºå¼‚å¸¸","like_count":5},{"had_liked":false,"id":178311,"user_name":"å°å–µå–µ","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1581658828,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171593420","product_id":100039001,"comment_content":"2.å¯ä»¥ä½¿ç”¨åå°„ä¿®æ”¹å•ä¾‹ä¸­å‚æ•°ä¿¡æ¯","like_count":2},{"had_liked":false,"id":176952,"user_name":"Kenå¼ äº‘å¿ ","can_delete":false,"product_type":"c1","uid":1134288,"ip_address":"","ucode":"D0BAC9FC17DE2B","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/d0/d8a5f720.jpg","comment_is_top":false,"comment_ctime":1581235090,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10171169682","product_id":100039001,"comment_content":"1.ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æ„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ<br>å°†å•ä¾‹ç±»ä¸­æ–°å¢ä¸€ä¸ªç”¨äºè·å–æµ‹è¯•instanceçš„å‡½æ•°,å‘½ågetTestInstance(User testUser),è¯¥å‡½æ•°ä¸­æŠŠéœ€è¦çš„æµ‹è¯•ç”¨ä¾‹é€šè¿‡å‚æ•°ä¼ å…¥instanceå½“ä¸­,å½“è¦åšæµ‹è¯•æ—¶å°±å¯ä»¥é€šè¿‡getTestInstanceå‡½æ•°æ¥è·å–å®ä¾‹å¾—åˆ°éœ€è¦çš„æµ‹è¯•æ•°æ®.<br>public boolean validateCachedUser(long userId) {<br>    User actualUser = userRepo.getUser(userId);<br>    &#47;&#47;User cachedUser = CacheManager.getInstance().getUser(userId);&#47;&#47;ç”Ÿäº§ä½¿ç”¨<br>    User cachedUser = CacheManager.getTestInstance(actualUser).getUser(userId);&#47;&#47;æµ‹è¯•ä½¿ç”¨<br>    &#47;&#47; çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...<br>  }<br>2.ç¬¬äºŒæ¬¡ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>ç¬¬äºŒæ¬¡è°ƒç”¨getInstanceæ—¶å¦‚æœå¸¦æœ‰ä¸ä¹‹å‰ç›¸åŒå‚æ•°å°±ç›´æ¥è¿”å›instanceå®ä¾‹;å¦‚æœå‚æ•°ä¸ç›¸åŒä¸”ä¸šåŠ¡å…è®¸æ„å»ºæ–°çš„instanceå®ä¾‹å°±å…è®¸å†ç¬¬äºŒæ¬¡getInstanceæ—¶æ„å»ºæ–°çš„å®ä¾‹,å¦‚æœä¸šåŠ¡ä¸å…è®¸å°±åœ¨æ„å»ºæ—¶æŠ›å‡ºå¼‚å¸¸.<br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br>    if (instance == null) {<br>      instance = new Singleton(paramA, paramB);<br>    } else if (this.paramA != paramA || this.paramB != paramB) {<br>       &#47;&#47;instance = new Singleton(paramA, paramB);&#47;&#47; ä¸šåŠ¡å…è®¸<br>       throw new RuntimeException(&quot;Singleton has been created!&quot;);&#47;&#47; ä¸šåŠ¡ä¸å…è®¸<br>   }<br>    return instance;<br>  }","like_count":2},{"had_liked":false,"id":176357,"user_name":"è¾£ä¹ˆå¤§","can_delete":false,"product_type":"c1","uid":1396951,"ip_address":"","ucode":"AB308B6DCA0108","user_header":"https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg","comment_is_top":false,"comment_ctime":1581042238,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"10170976830","product_id":100039001,"comment_content":"æ€è€ƒé¢˜1ï¼š<br>æå‡ºä¸€ä¸ªæ–¹æ³•ï¼špublic Uer getCahcedUser(userId){}ï¼Œç„¶åmock getCahcedUseræ–¹æ³•ã€‚<br>æµ‹è¯•ï¼š<br>public boolean validateCachedUesr(userid){<br>  User cachedUser = getMockCachedUserâ€¦<br>  User actualUser = userRepo.getUser(userid)<br>&#47;&#47; validate â€¦<br>}<br><br>æ€è€ƒé¢˜2ï¼š<br>A singleton with parameters is NOT a singleton because you may have more object than one of them.<br>æ”¹è¿›ï¼šå¾—åˆ°å•ä¾‹å¯¹è±¡åï¼Œå†åˆå§‹åŒ–å‚æ•°ã€‚<br>SingletonObj singleton = SingletonObj.getInstance()<br>singleton.init(paramA, paramB)<br>","like_count":2,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501424,"discussion_content":"åœ¨å¤¹ç¼ä¸­æ±‚ç”Ÿå­˜å•Š~è®¨å£é¥­åƒä¸å®¹æ˜“çš„ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594781167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217443,"user_name":"Rogerå®‡","can_delete":false,"product_type":"c1","uid":1703222,"ip_address":"","ucode":"CBA23C01409349","user_header":"https://static001.geekbang.org/account/avatar/00/19/fd/36/f947c340.jpg","comment_is_top":false,"comment_ctime":1589506215,"is_pvip":false,"replies":[{"id":"80476","content":"æ ¹æ®ä¸šåŠ¡æ¥ä¼°ç®—çš„ï¼Œæœ‰äº›ä¸šåŠ¡æœ¬èº«å°±å¾ˆæ…¢ï¼Œå°±åˆ¤å®šä¸ºæ…¢sql","user_name":"ä½œè€…å›å¤","comment_id":217443,"uid":"1190123","ip_address":"","utype":1,"ctime":1589524621,"user_name_real":"ç‹äº‰"}],"discussion_count":1,"race_medal":0,"score":"5884473511","product_id":100039001,"comment_content":"æƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œæ‰€è°“ä¸¤ä¸ªèµ„æºæ± ï¼Œæ…¢çš„è¯·æ±‚ç‹¬å ä¸€ä¸ªçš„è®¾è®¡ï¼Œå¦‚ä½•çŸ¥é“ä¸€ä¸ªsqlè¯·æ±‚ä¼šå¿«ä¼šæ…¢ï¼Ÿå¿«ä¸æ…¢æ›´å¤šæ˜¯åœ¨è¿è¡Œåæ‰çŸ¥é“çš„ï¼Œå·²ç»è¿›å»è¿è¡Œäº†è¿˜æ€ä¹ˆä¿è¯ç‹¬å å‘¢ï¼Ÿé™¤éæœ‰æœºåˆ¶å¯ä»¥åœ¨å¤„ç†sqlè¯·æ±‚ä¹‹å‰è¯„ä¼°å¯èƒ½éœ€è¦çš„æ—¶é—´ã€‚","like_count":2,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501298,"discussion_content":"å…ˆä¼‘æ¯ä¼‘æ¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594632602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202817,"user_name":"å°åŠ¨ç‰©","can_delete":false,"product_type":"c1","uid":1031683,"ip_address":"","ucode":"BCC35CE768EB99","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/03/404edf37.jpg","comment_is_top":false,"comment_ctime":1586073571,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5881040867","product_id":100039001,"comment_content":"ä¹‹å‰é‡æ„è¿‡ä¸€ä¸ªç®€å•ä¸šåŠ¡æ¨¡å—ï¼ŒåŸå…¥å£æ˜¯ä¸€ä¸ªç®€å•çš„å•ä¾‹ï¼šbiz1class.getinstance().doSomething()ã€‚ä½†æ–°éœ€æ±‚å•ä¾‹æ¨¡å¼ä¸æ”¯æŒï¼Œéœ€è¦æ”¯æŒä¸åŒå¤„ç†ä¸šåŠ¡çš„æ¨¡å¼ï¼Œäºæ˜¯é‡æ„ã€‚<br>å½“æ—¶çš„æ€è·¯æ˜¯ï¼Œå…¶å®å®é™…ä¸šåŠ¡ä»£ç å¹¶ä¸å…³å¿ƒgetinstance()åè¿”å›çš„æ˜¯ä»€ä¹ˆã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•çš„è¿”å›ç±»å‹ç”±åŸæ¥çš„ç±»æ¢æˆæ¥å£å¯¹ä¸šåŠ¡ä»£ç è€Œè¨€ï¼ŒåŸºæœ¬æ— å½±å“ï¼Œæœ€å¤šé‡æ–°ç¼–è¯‘ä¸‹ä»£ç ã€‚<br>æ‰€ä»¥æœ€åçš„æ–¹æ¡ˆæ˜¯å°†åŸä¸šåŠ¡ç±»æä¾›çš„æ–¹æ³•æå–æˆåˆé€‚çš„æ¥å£ï¼Œå¹¶ç¼–å†™ç›¸å…³å®ç°ç±»ã€‚åŸgetInstance()æ–¹æ³•è¿”å›ç±»å‹æ”¹æˆæ¥å£ã€‚å¹¶æ ¹æ®å½“å‰é…ç½®è¿”å›ä¸åŒçš„å®ç°ç±»ä»¥æ»¡è¶³ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚<br><br>åŸºäºè¿™ä¸ªæ€è·¯ï¼Œæ–‡ç« ä¸­çš„é—®é¢˜åº”è¯¥å°±èƒ½è§£å†³äº†ã€‚è®©åŸå…ˆçš„biz1classçš„getinstanceæ–¹æ³•æ”¯æŒè¿”å›è‡ªå·±æƒ³è¦çš„å®ç°å³å¯ã€‚","like_count":1},{"had_liked":false,"id":176548,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1581084545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5876051841","product_id":100039001,"comment_content":" ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºäº†å¢åŠ å¯æµ‹è¯•æ€§ï¼Œä¹Ÿå°±æ˜¯å°½é‡å¯ä»¥æµ‹è¯•ä¸­é—´ç»“æœã€‚æˆ‘è§‰å¾—å¯ä»¥å°†cacheUseré‚£ä¸€è¡Œä»£ç å’Œä¸‹ä¸€è¡Œä»£ç åˆ†åˆ«æŠ½å–å‡ºæ¥å°è£…ğŸ“¦ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†å‚æ•°ä¿å­˜åœ¨é™æ€ç±»ä¸­ï¼Œæœ¬èº«è¿™ä¸ªç±»æ–°å¢ä¸€ä¸ªinitå‡½æ•°ï¼Œåœ¨new å¯¹è±¡åè¿›è¡Œè°ƒç”¨initã€‚è¿™æ ·ç”¨æˆ·å¯ä»¥ä¸éœ€è¦åŠ è½½å‚æ•°ã€‚å½“ç„¶äº†ï¼Œå¦‚æœä¸€å®šè¦åœ¨getInstanceæ—¶ä¼ å…¥å‚æ•°ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥æ ¡éªŒå‚æ•°æ˜¯å¦å’Œä¸Šä¸€æ¬¡ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸€è‡´ã€‚","like_count":1},{"had_liked":false,"id":358408,"user_name":"@äºŒåä¸€å¤§å”","can_delete":false,"product_type":"c1","uid":1075954,"ip_address":"ä¸Šæµ·","ucode":"394A7E80C5034C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6a/f2/8829a0b8.jpg","comment_is_top":false,"comment_ctime":1664276132,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1664276132","product_id":100039001,"comment_content":"1.<br>public class Demo {<br><br>        private UserRepo userRepo; &#47;&#47; é€šè¿‡æ„é€ å“ˆå‡½æ•°æˆ–IOCå®¹å™¨ä¾èµ–æ³¨å…¥<br>        private CacheManager cacheManager; &#47;&#47; å°†è·å–CacheManagerå¯¹è±¡æå‡ºæ¥ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼åˆå§‹åŒ–<br><br>        public Demo(CacheManager cacheManager){<br>            this.cacheManager = cacheManager;<br>        }<br><br>        public boolean validateCachedUser(long userId) {<br>            User cachedUser = getCachedUser(userId);<br>            User actualUser =userRepo.getUser(userId);<br>            &#47;&#47; çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...<br>        }<br>        <br>        public User getCachedUser(long userId){<br>            return cacheManager.getInstance().getUser(userId);<br>        }<br><br>        static class MockManager extends CacheManager {<br>            private static MockManager mockManager;<br>            <br>            private MockManager(){}<br><br>            public static MockManager getInstance(){<br>                &#47;&#47;todo<br>                return mockManager;<br>            }<br><br>            public static User getUser(long userId){<br>                &#47;&#47; è¿”å›mockæ•°æ®<br>                return new User(userId);<br>            }<br>        }<br><br>    public static void main(String[] args) {<br>        CacheManager cacheManager = MockManager().getInstance();<br>        Demo demo = new Demo(cacheManager);<br>        User user = demo.getCachedUser(123L);<br>    }","like_count":0},{"had_liked":false,"id":354747,"user_name":"çº¢çƒ§å†°æ·‡æ·‹","can_delete":false,"product_type":"c1","uid":2650490,"ip_address":"åŒ—äº¬","ucode":"CF59ECC2FE70C6","user_header":"https://static001.geekbang.org/account/avatar/00/28/71/7a/3230370a.jpg","comment_is_top":false,"comment_ctime":1660741331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660741331","product_id":100039001,"comment_content":"éš¾é“å•ä¾‹æ¨¡å¼æœ€å¤§çš„é—®é¢˜ä¸æ˜¯æ²¡åŠæ³•æ¨ªå‘æ‰©å±•å—ï¼Ÿ<br><br>ç°åœ¨éƒ½æ˜¯å¤šå®ä¾‹éƒ¨ç½²äº†ï¼Œå•ä¸ªå®ä¾‹å†…éƒ¨çš„å•ä¾‹æ¨¡å¼æ²¡æœ‰å•¥æ„ä¹‰","like_count":1},{"had_liked":false,"id":350540,"user_name":"æ¬ç –å†œæ°‘å·¥ğŸ‘©â€ğŸŒ¾","can_delete":false,"product_type":"c1","uid":2873541,"ip_address":"","ucode":"50E0602562E968","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d8/c5/6a553741.jpg","comment_is_top":false,"comment_ctime":1656993362,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656993362","product_id":100039001,"comment_content":"ä¸ŠèŠ‚è¯¾ä¸­åˆè¯´é“ï¼Œé™æ€å†…éƒ¨ç±»ä¹Ÿå¯ä»¥åšåˆ°å»¶è¿ŸåŠ è½½ï¼Œè¿™èŠ‚è¯¾è¯´åšä¸åˆ°ï¼Œæˆ‘çœ‹äº†ä¸‹èœé¸Ÿæ•™ç¨‹ï¼Œé™æ€å†…éƒ¨ç±»æ˜¯å¯ä»¥åšåˆ°å»¶è¿ŸåŠ è½½çš„ï¼Œä¸çŸ¥æ˜¯æˆ‘ç†è§£åšé”™äº†ï¼Œè¿˜æ˜¯è€å¸ˆä¸å°å¿ƒæ‰“é”™äº†","like_count":0},{"had_liked":false,"id":342969,"user_name":"Geek_7e0e83","can_delete":false,"product_type":"c1","uid":2142423,"ip_address":"","ucode":"554DEE2AAAE33C","user_header":"","comment_is_top":false,"comment_ctime":1650554154,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650554154","product_id":100039001,"comment_content":"1. å¯ä»¥æŠŠå•ä¾‹çš„è·å–IDçš„åŠŸèƒ½ç§»åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸­å°è£…èµ·æ¥ï¼Œç„¶åmocké‚£ä¸ªæ–°çš„æ–¹æ³•å³å¯<br>2.å¯ä»¥å½“instanceä¸ä¸ºnull çš„æ—¶å€™ æ‰“å°warnæ—¥å¿—ï¼Œæç¤ºç”¨æˆ·è¾“å…¥çš„å‚æ•°å·²ç»ä¸ç”Ÿæ•ˆäº†ï¼Œæˆ–è€…æ¢åˆ«çš„æ–¹å¼å®ç°å•ä¾‹ï¼Œæ¯”å¦‚é…ç½®æ–‡ä»¶çš„æ–¹å¼ã€‚è€Œä¸æ˜¯åœ¨instanceæ–¹æ³•ä¸ŠåŠ å…¥å‚","like_count":0},{"had_liked":false,"id":334311,"user_name":"çŸ¥è¡Œ","can_delete":false,"product_type":"c1","uid":1802022,"ip_address":"","ucode":"5AC8CBCC0AD48B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/7f/26/c5127e9a.jpg","comment_is_top":false,"comment_ctime":1644884359,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1644884359","product_id":100039001,"comment_content":"å…¶å®ï¼Œå•ä¾‹æ¨¡å¼å¯ä»¥è¢«åå°„ç ´å","like_count":0,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501275,"discussion_content":"å–œæ¬¢ä½ çš„æ˜µç§°ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594598495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319498,"user_name":"charmsongo","can_delete":false,"product_type":"c1","uid":1609051,"ip_address":"","ucode":"4FBEE716E93A1A","user_header":"https://static001.geekbang.org/account/avatar/00/18/8d/5b/383a49e4.jpg","comment_is_top":false,"comment_ctime":1635836854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635836854","product_id":100039001,"comment_content":"æ€»ç»“<br>1ã€å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜?<br>\t1. å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½<br>\t2. å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»<br>\t3. å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½<br>\t4. å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½<br>\t5. å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°<br>2ã€æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ<br>\tä¿è¯å…¨å±€å”¯ä¸€ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ã€‚ä½†å®ƒä¹Ÿä¸å¤Ÿçµæ´»ï¼Œä¸èƒ½æ‡’åŠ è½½<br>\tå·¥å‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰ä¹Ÿå¯ä»¥ä¿è¯å”¯ä¸€","like_count":0},{"had_liked":false,"id":319495,"user_name":"charmsongo","can_delete":false,"product_type":"c1","uid":1609051,"ip_address":"","ucode":"4FBEE716E93A1A","user_header":"https://static001.geekbang.org/account/avatar/00/18/8d/5b/383a49e4.jpg","comment_is_top":false,"comment_ctime":1635836387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635836387","product_id":100039001,"comment_content":"ä½œä¸š<br>1ã€ä¸¤ä¸ªå¯¹è±¡ä»¥å‚æ•°ä¼ å…¥ï¼Œç„¶åç›´æ¥å¯¹æ¯”2ä¸ªå¯¹è±¡å³å¯ï¼Œå¤–éƒ¨å¯ä»¥å•å†™2ä¸ªæ–¹æ³•<br>2ã€çœ‹äº†å¥½å¤šè¯„è®ºä¸ªäººçœ‹æ³•æœ‰ä¸¤ä¸ªï¼Œä¸€å¦‚æœä¸šåŠ¡éœ€è¦å­˜åœ¨ä¸åŒå‚æ•°çš„å®ä¾‹ï¼Œé‚£å•ä¾‹çš„è®¾è®¡å…¶å®å°±ä¸ç¬¦åˆäº†ï¼›äºŒå¦‚æœéœ€è¦åªèƒ½ä¸€ä¸ªå®ä¾‹ï¼Œä¸”æ ¹æ®ä¸šåŠ¡å‚æ•°å®æ—¶å˜åŠ¨é‚£æœ€å¥½æ˜¯å¼€æ”¾ä¸€ä¸ªupdateæ–¹æ³•å–ä¿®æ”¹ï¼Œåˆå§‹åŒ–å°±ä¸€æ¬¡ï¼Œåé¢ä¿®æ”¹ç”¨updateæ–¹æ³•","like_count":0},{"had_liked":false,"id":316920,"user_name":"MOSLX","can_delete":false,"product_type":"c1","uid":2732715,"ip_address":"","ucode":"FFE0FE1AED2BFB","user_header":"https://static001.geekbang.org/account/avatar/00/29/b2/ab/db3ce62d.jpg","comment_is_top":false,"comment_ctime":1634613271,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634613271","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®º2ï¼Œå°è¯•ç»´æŠ¤ä¸€ä¸ªHashMapå®¹å™¨ï¼Œåº”è¯¥èƒ½æ ¹æ®ä¸åŒçš„å‚æ•°ä¿æŒå•ä¾‹   <br> private static ParamSingleton instance = null;<br>    private static HashMap&lt;String, ParamSingleton&gt; context = new HashMap&lt;&gt;();<br>    private final int paramA;<br>    private final int paramB;<br><br>    private ParamSingleton(int paramA, int paramB){<br>        this.paramA = paramA;<br>        this.paramB = paramB;<br>    }<br><br>    public synchronized static ParamSingleton getInstance(int paramA, int paramB){<br>        String key = paramA + &quot;-&quot; + paramB;<br>        if(instance == null){<br>            instance = new ParamSingleton(paramA,paramB);<br>            context.put(key,instance);<br>        } else {<br>            instance = context.computeIfAbsent(key,k -&gt; new ParamSingleton(paramA,paramB));<br>        }<br>        return instance;<br>    }","like_count":0},{"had_liked":false,"id":304493,"user_name":"è¿æ˜Ÿç§‘æŠ€","can_delete":false,"product_type":"c1","uid":2642229,"ip_address":"","ucode":"C84FF7FF4AAE56","user_header":"https://static001.geekbang.org/account/avatar/00/28/51/35/d3a1144b.jpg","comment_is_top":false,"comment_ctime":1627454575,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627454575","product_id":100039001,"comment_content":"go è¯­è¨€å¯ä»¥ç”¨é™æ€å…¨å±€å¯¹è±¡ï¼Œç»“æ„å¯¹è±¡å‘½åå°å†™ï¼Œåªèƒ½é€šè¿‡ä¸€ä¸ªGetå‡½æ•°å»è·å–ã€‚","like_count":0},{"had_liked":false,"id":296733,"user_name":"å°æ±Ÿçˆ±å­¦æœ¯","can_delete":false,"product_type":"c1","uid":2628601,"ip_address":"","ucode":"554F40C6627AF4","user_header":"https://static001.geekbang.org/account/avatar/00/28/1b/f9/018197f1.jpg","comment_is_top":false,"comment_ctime":1623136180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623136180","product_id":100039001,"comment_content":"é—®é¢˜1. åœ¨æ„é€ æ–¹æ³•ä¸­é€šè¿‡å‚æ•°çš„å½¢å¼æŠŠå•ä¾‹ä¼ è¿›æ¥ã€‚<br>é—®é¢˜2. æ—¢ç„¶å«å•ä¾‹ï¼Œæˆ‘è®¤ä¸ºæœ¬èº«å°±åº”è¯¥ä¿è¯å…¨å±€å”¯ä¸€æ€§ï¼Œé€šè¿‡getInstanceä¼ å‚çš„æ–¹æ³•å¸Œæœ›å•ä¾‹å¯ä»¥æ ¹æ®ä¼ å‚çš„ä¸åŒåŠ¨æ€æ”¹å˜ï¼Œæˆ‘è®¤ä¸ºæœ¬èº«ä¸å¤ªå¯å–ï¼Œæ˜¯ä»¤äººç–‘æƒ‘çš„åšæ³•ï¼Œè¿˜æ˜¯åº”è¯¥åœ¨å•ä¾‹ç±»ä¸­ï¼Œä»¥é…ç½®æ–‡ä»¶çš„æ–¹å¼åŠ è½½å‚æ•°ï¼Œä¿è¯å•ä¾‹å”¯ä¸€æ€§","like_count":0},{"had_liked":false,"id":295058,"user_name":"åº„å‘¨æ¢¦è¶","can_delete":false,"product_type":"c1","uid":1693576,"ip_address":"","ucode":"7878ED3EB11E97","user_header":"https://static001.geekbang.org/account/avatar/00/19/d7/88/7dcde249.jpg","comment_is_top":false,"comment_ctime":1622199566,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1622199566","product_id":100039001,"comment_content":"è€å¸ˆï¼Œæ‚¨è®²çš„ä»£æ›¿æ–¹æ¡ˆçš„æ„æ€ä¸è¿˜æ˜¯è¦ä¿è¯åªæœ‰ä¸€ä¸ªå®ä¾‹ä¹ˆï¼Œä¹Ÿå±äºå•ä¾‹å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":294944,"user_name":"JKwar","can_delete":false,"product_type":"c1","uid":1047466,"ip_address":"","ucode":"B733CA24D5701F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/aa/01fedf6c.jpg","comment_is_top":false,"comment_ctime":1622163168,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1622163168","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®ºä¸€ï¼šå¯ä»¥é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§ï¼Œmockç±»å³åˆ»ã€‚<br>è¯¾å ‚è®¨è®ºäºŒï¼šç›´æ¥åˆ¤æ–­æ˜¯å¦å·²ç»åˆå§‹åŒ–ï¼Œå·²ç»åˆå§‹åŒ–å°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚","like_count":0},{"had_liked":false,"id":288064,"user_name":"Better me","can_delete":false,"product_type":"c1","uid":1261959,"ip_address":"","ucode":"CADF08D357489A","user_header":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","comment_is_top":false,"comment_ctime":1618284408,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1618284408","product_id":100039001,"comment_content":"1ã€è€ƒè™‘å°†å•ä¾‹CacheMangerå•ä¾‹å¯¹è±¡ä½œä¸ºDemoç±»çš„æˆå‘˜å˜é‡ï¼Œé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ï¼Œé‚£å°±å¯ä»¥é€šè¿‡Mockå‡ºæŒ‡å®šUserå¯¹è±¡è¿›è¡Œåç»­å¯¹æ¯”æµ‹è¯•<br>2ã€ä¸»è¦è¿˜æ˜¯è€ƒå¯Ÿéœ€æ±‚æ˜¯è¿™æ ·çš„ï¼ŒæŒ‰åŸæ–‡æ„æ€æ˜¯éœ€è¦ä¸åŒå‚æ•°ä¸åŒå®ä¾‹ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é€šè¿‡Mapç»´æŠ¤ä¼ å…¥å‚æ•°å’Œå®ä¾‹çš„æ˜ å°„å…³ç³»ï¼Œéœ€è¦æ³¨æ„æ„å»ºè¿‡ç¨‹çš„å®‰å…¨æ€§å’ŒæŒ‡å®šå‚æ•°çš„å”¯ä¸€æ€§","like_count":0},{"had_liked":false,"id":279105,"user_name":"è¾‰","can_delete":false,"product_type":"c1","uid":1697810,"ip_address":"","ucode":"0D7B2C24BA8BD2","user_header":"https://static001.geekbang.org/account/avatar/00/19/e8/12/74f387c8.jpg","comment_is_top":false,"comment_ctime":1613623236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613623236","product_id":100039001,"comment_content":"å•ä¾‹çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ä¸€äº›å­˜åœ¨çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚è‡³äºè¯´è¿™æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œæˆ‘è§‰å¾—ä¸å¤ªå¦¥ã€‚ä»»ä½•ä¸œè¥¿éƒ½æœ‰ä¸¤é¢æ€§ï¼Œå•ä¾‹ä¹Ÿä¸€æ ·ã€‚å¯¹äºä¸€äº›å…¬å…±çš„ç®¡ç†ç±»æ¥è¯´ï¼Œå•ä¾‹ç¡®å®æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚æ¯”å¦‚æˆ‘è¦ç®¡ç†ä¸€ä¸ªå…¨å±€çš„ç½‘ç»œçŠ¶æ€ï¼Œè¿™æ—¶å€™è®²è¿™ä¸ªç®¡ç†ç±»è®¾ç½®ä¸ºå•ä¾‹å°±æ˜¯åˆç†çš„ã€‚","like_count":0},{"had_liked":false,"id":267475,"user_name":"David","can_delete":false,"product_type":"c1","uid":1021825,"ip_address":"","ucode":"22CBBC13FC97A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/97/81/e1eaf621.jpg","comment_is_top":false,"comment_ctime":1607761564,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1607761564","product_id":100039001,"comment_content":"1. æŠŠUser cachedUser = CacheManager.getInstance().getUser(userId); <br>User actualUser = userRepo.getUser(userId);æ‹†æˆä¸¤ä¸ªæ–¹æ³•ï¼Œä¾¿äºä½¿ç”¨mockæµ‹è¯•<br>2. getInstanceæ–¹æ³•ä¸è¦åŠ å‚æ•°ã€‚","like_count":0},{"had_liked":false,"id":259777,"user_name":"å¿ƒæœ‰ä¸ç”˜","can_delete":false,"product_type":"c1","uid":2222598,"ip_address":"","ucode":"4B48BC4B357C3A","user_header":"https://static001.geekbang.org/account/avatar/00/21/ea/06/1bfbbf4f.jpg","comment_is_top":false,"comment_ctime":1604830351,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604830351","product_id":100039001,"comment_content":"è®¨è®ºä¸€ï¼š<br>  å•¥æ˜¯mockå•Šï¼Œå•¥æ˜¯å¯æµ‹è¯•æ€§å‘¢ã€‚ å¦‚æœæˆ‘è¦æµ‹è¯•validateCachedUser(long userId) æ–¹æ³•, ç›´æ¥å•å…ƒæµ‹è¯•è¿™ä¸ªæ–¹æ³•, ä¼ é€’å‚æ•°è¿›å»ï¼Œç”¨æ–­è¨€åˆ¤æ–­è¿è¡Œå€¼å’ŒæœŸæœ›å€¼ï¼Œè¿™ä¸ªç®—æµ‹è¯•ä¹ˆï¼Ÿæ²¡æœ‰ç†è§£å•ä¾‹æ¨¡å¼å¯¹è¿™é‡Œçš„å½±å“ã€‚<br><br>è®¨è®ºäºŒï¼šä¸ºä»€ä¹ˆç±»ä¸­çš„å‚æ•°ABè¦è®¾ç½®æˆfinalå‘¢ï¼Œä¸æä¾›ä¿®æ”¹æ–¹æ³•ï¼Œå€¼ä¹Ÿä¼šä¿®æ”¹ä¹ˆã€‚å¯å¦å»æ‰final,åœ¨getInsatanceæ–¹æ³•ä¸­ï¼Œå†åŠ å…¥ä¸€æ¬¡èµ‹å€¼å‘¢?<br><br>public class Singleton { <br>  private static Singleton instance = null; <br>  private int paramA; <br>  private int paramB; <br>  private Singleton(int paramA, int paramB) { <br>    this.paramA = paramA; <br>    this.paramB = paramB; <br>  } <br>  public synchronized static Singleton getInstance(int paramA, int paramB) { <br>    if (instance == null) { <br>      instance = new Singleton(paramA, paramB); <br>    } <br>    instance.paramA = paramA;<br>    instance.paramB = paramB;<br>    return instance; <br>  }<br>}<br>","like_count":0},{"had_liked":false,"id":257411,"user_name":"Daiver","can_delete":false,"product_type":"c1","uid":1466447,"ip_address":"","ucode":"9B1A03AFBC79BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/60/4f/db0e62b3.jpg","comment_is_top":false,"comment_ctime":1603962907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603962907","product_id":100039001,"comment_content":"å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªMapï¼Œå‚æ•°ABä½œä¸ºkeyï¼Œmapå­˜åœ¨åˆ™ç›´æ¥è¿”å›ï¼Œmapä¸å­˜åœ¨å®ä¾‹åŒ–ä¸€ä¸ªï¼Œå¹¶å­˜å…¥mapä¸­ï¼Œç„¶åè¿”å›ã€‚","like_count":0},{"had_liked":false,"id":253458,"user_name":"RedDevil","can_delete":false,"product_type":"c1","uid":1131128,"ip_address":"","ucode":"F8F5DC209BB3B9","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/78/7ba89c75.jpg","comment_is_top":false,"comment_ctime":1602744320,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602744320","product_id":100039001,"comment_content":"çœ‹äº‰å“¥çš„æ–‡ç« æœ‰ç§èŒ…å¡é¡¿å¼€çš„æ„Ÿè§‰","like_count":0},{"had_liked":false,"id":250696,"user_name":"Gopher","can_delete":false,"product_type":"c1","uid":1206229,"ip_address":"","ucode":"3C1F9012BB486D","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/d5/1b26b725.jpg","comment_is_top":false,"comment_ctime":1601198500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601198500","product_id":100039001,"comment_content":"1ã€åº”è¯¥æ˜¯æŠŠCacheMangerè¿™ä¸ªå¯¹åº”çš„ç±»ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°é‡Œï¼Œé€šè¿‡å‡½æ•°æ¥getInstance()ï¼Œè¿™æ ·mock çš„CacheManger å°±å¯ä»¥ä½œä¸ºå‚æ•°ä¼ è¿›å»äº†<br><br>2ã€æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæ˜¯é€šè¿‡ä¸åŒå‚æ•°æ¥è¿”å›ä¸åŒçš„å®ä¾‹ï¼Œå°±ä¸åº”è¯¥ç”¨å•åˆ©æ¥åšäº†","like_count":0},{"had_liked":false,"id":249774,"user_name":"Leaf","can_delete":false,"product_type":"c1","uid":1102194,"ip_address":"","ucode":"9AB56B7971237D","user_header":"https://static001.geekbang.org/account/avatar/00/10/d1/72/4cc8475c.jpg","comment_is_top":false,"comment_ctime":1600785885,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600785885","product_id":100039001,"comment_content":"é¢˜ç›®ä¸€ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç±»åŒ…ä¸€å±‚ï¼Œå°è£…ä¸‹ CacheManagerï¼Œç„¶å mock è¿™å°è£…ç±»<br>é¢˜ç›®äºŒï¼Œå¦‚æœå…è®¸å­˜åœ¨å‚æ•°ä¸åŒå®ä¾‹ä¸åŒï¼Œå¯ä»¥ç”¨æ”¯æŒå¹¶å‘çš„å­—å…¸ä¿å­˜å¯¹è±¡(keyä¸ºparamsç”Ÿæˆï¼‰ï¼Œè¿™æ ·å°±èƒ½æ”¯æŒå‚æ•°ä¸åŒå®ä¾‹ä¸åŒ","like_count":0},{"had_liked":false,"id":248068,"user_name":"ç¥æ¯“é€é¥","can_delete":false,"product_type":"c1","uid":2147220,"ip_address":"","ucode":"83351CB18B190E","user_header":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","comment_is_top":false,"comment_ctime":1599999909,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1599999909","product_id":100039001,"comment_content":"æˆ‘æ˜¯Pythonå¼€å‘è€…ï¼Œç¬¬äºŒç§å¸Œæœ›ä¼ å…¥å‚æ•°ç”Ÿæ•ˆæ˜¯æœ‰è¿™ä¸ªåœºæ™¯éœ€æ±‚çš„ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥æ± ï¼Œå½“åœ¨forkå­è¿›ç¨‹æ—¶ï¼Œé…ç½®å‚æ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¸Œæœ›é‡æ–°ç”Ÿæˆå¯¹è±¡ï¼Œè¿™æ—¶å€™éœ€è¦ä¸åœ¨__init__ä¸­å®ä¾‹åŒ–ï¼Œè€Œè®¾è®¡ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå½“ä¼ å…¥force_refreshå‚æ•°ä¸ºTrueæ—¶é‡æ–°å®ä¾‹åŒ–","like_count":0,"discussions":[{"author":{"id":1079816,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","nickname":"Aaron Cheung","note":"","ucode":"03972759C53667","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305763,"discussion_content":"å¾ˆèµçš„åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600078471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242481,"user_name":"æœ¨å­","can_delete":false,"product_type":"c1","uid":1784886,"ip_address":"","ucode":"F9548C192F9687","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3c/36/94762d1c.jpg","comment_is_top":false,"comment_ctime":1597739114,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1597739114","product_id":100039001,"comment_content":"åœ¨æˆ‘ä»¬è§†é‡å†…ï¼ˆç»éªŒæˆ–è€…ä¸šåŠ¡å»ºæ¨¡ä¸Šï¼‰ï¼Œç«‹è¶³è„šä¸‹çš„å–åº”ç”¨å•ä¾‹æ¨¡å¼","like_count":0},{"had_liked":false,"id":238508,"user_name":"Next","can_delete":false,"product_type":"c1","uid":1748213,"ip_address":"","ucode":"D5ADDF248A9504","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ac/f5/2f97e279.jpg","comment_is_top":false,"comment_ctime":1596185766,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596185766","product_id":100039001,"comment_content":"é’ˆå¯¹å•ä¾‹æ‰©å±•æ€§çš„è§£å†³æ–¹æ³•ä¸¾ä¾‹ï¼š<br>ç”¨æˆ·IDç”Ÿæˆå™¨ï¼š<br>è¯­ä¹‰æ˜¯çœŸæ­£çš„å…¨å±€å”¯ä¸€ï¼Œé‡‡ç”¨å•åˆ—ï¼›<br>ä¸”ï¼›<br>IDç”Ÿæˆç®—æ³•æ˜¯å¯å˜æ›´çš„ï¼Œæ‰€ä»¥ä¸ç›´æ¥ä½¿ç”¨æŸä¸ªé€šç”¨çš„IDç”Ÿæˆå™¨ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·IDä¸“ç”¨çš„ç”Ÿæˆå™¨ï¼ŒåŒ…å«æŸä¸ªå®é™…çš„IDç”Ÿæˆç±»çš„å¼•ç”¨ã€‚å¦‚ä¸‹ï¼Œå¦‚æœè¦æ›´æ¢IDçš„ç”Ÿæˆæ–¹æ³•ï¼Œåªéœ€æ›¿æ¢æ‰SimpleSequenceIDGenã€‚<br>public enum UserID {<br>    I;<br>    private IIDLongGen gen = new SimpleSequenceIDGen();<br><br>    public long generate() {<br>        return gen.generate();<br>    }<br><br>}","like_count":0},{"had_liked":false,"id":237939,"user_name":"é»‘è‰²æ¯›è¡£","can_delete":false,"product_type":"c1","uid":1135912,"ip_address":"","ucode":"FF7E235F91BA5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/55/28/31b0cf2f.jpg","comment_is_top":false,"comment_ctime":1596010232,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596010232","product_id":100039001,"comment_content":"æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œå•ä¾‹ä¹Ÿæ˜¯å¯ä»¥å®ç°æ¥å£çš„ï¼Œå¯ä»¥é€šè¿‡é¢å‘æ¥å£ä¾èµ–æ³¨å…¥ã€‚","like_count":0},{"had_liked":false,"id":237541,"user_name":"å¤§æ–¹æ–¹","can_delete":false,"product_type":"c1","uid":1354013,"ip_address":"","ucode":"621AD8F1485753","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/6cyOoRd2dROgiblAJkW6RLhUyH1wwU0NNibIIuV930eQ9TiaNT41K61kBSVkvYoDYg7mJtuEoCQY1awBmV0WW6BFg/132","comment_is_top":false,"comment_ctime":1595858875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595858875","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ å‰é¢çš„ä»£ç æµ‹è¯•æ€§å·²ç»è®²è¿‡ï¼Œå°†éœ€è¦ç”¨åˆ°å•ä¾‹çš„åŠŸèƒ½å†wrapå‡ºæ¥ä¸€ä¸ªå‡½æ•°å’Œå­ç±»ï¼Œæµ‹è¯•æ—¶mockè¿™ä¸ªå­ç±» å¹¶æµ‹è¯•è¿™ä¸ªåŒ…è£¹å‡½æ•°å³å¯ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œè¿˜æ˜¯ç”¨ä¸ª initæˆ–è€…updateParameteræ¯”è¾ƒå¥½ ï¼Œä¸è¿‡é¡¹ç›®ä¸­å‡ ä¹æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„å®é™…é—®é¢˜ã€‚","like_count":0},{"had_liked":false,"id":235815,"user_name":"Chord","can_delete":false,"product_type":"c1","uid":2019109,"ip_address":"","ucode":"6E248DA470FACC","user_header":"https://static001.geekbang.org/account/avatar/00/1e/cf/25/8c91fd43.jpg","comment_is_top":false,"comment_ctime":1595209852,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595209852","product_id":100039001,"comment_content":"è¯·é—®ï¼ŒåŒé‡æ ¡éªŒé”+é™æ€å†…éƒ¨ç±»çš„å®ç°æ–¹å¼ï¼Œæ— æ³•æ”¯æŒå«å‚æ„é€ å‡½æ•°å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":229555,"user_name":"maybe","can_delete":false,"product_type":"c1","uid":1475528,"ip_address":"","ucode":"93D160F617E750","user_header":"https://static001.geekbang.org/account/avatar/00/16/83/c8/5ce842f6.jpg","comment_is_top":false,"comment_ctime":1593056722,"is_pvip":false,"discussion_count":0,"race_medal":4,"score":"1593056722","product_id":100039001,"comment_content":"1ã€å•ä¾‹å¯¹OOPä¸å‹å¥½ã€‚OOPå››å¤§ç‰¹æ€§ï¼Œå°è£…ã€ç»§æ‰¿ã€æŠ½è±¡ã€å¤šæ€ã€‚å•ä¾‹è¿èƒŒåŸºäºæ¥å£è€Œéå®ç°è®¾è®¡åŸåˆ™ï¼Œå¹¿ä¹‰ä¸Šæ¥è¯´è¿èƒŒäº†æŠ½è±¡ç‰¹æ€§ã€‚å•ä¾‹ä¸€èˆ¬ä¸ä¼šè¢«ç»§æ‰¿ï¼Œæ‰€ä»¥ç›´æ¥æ”¾å¼ƒäº†ç»§æ‰¿ã€å¤šæ€ã€‚<br>2ã€å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚é˜…è¯»ä»£ç å¸Œæœ›ä¸€çœ¼èƒ½çœ‹å‡ºç±»ä¹‹é—´å…³ç³»ã€‚ä¸€èˆ¬é€šè¿‡æ„é€ å‡½æ•°ã€å‚æ•°ä¼ é€’ç­‰æ–¹å¼å£°æ˜ç±»ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œè€Œå•ä¾‹ä¸éœ€æ˜¾ç¤ºåˆ›å»ºã€ä¸éœ€è¦ä¼ é€’å‚æ•°ã€‚å¦‚æœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»æ¯”è¾ƒéšè”½ï¼Œé˜…è¯»ä»£ç å°±éœ€è¦éƒ½çœ‹å®Œæ¯ä¸ªå‡½æ•°çš„å®ç°æ‰èƒ½çœ‹å‡ºè¿™ç§å…³ç³»ã€‚<br>3ã€å•ä¾‹å¯¹ä»£ç æ‰©å±•æ€§ä¸å¥½ã€‚å•ä¾‹åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœæƒ³æ‰©å±•å¤šä¸ªå®ä¾‹ï¼Œä»£ç æ”¹åŠ¨å¤§ï¼Œä¿®æ”¹æˆæœ¬é«˜ã€‚<br>4ã€å•ä¾‹å¯¹ä»£ç å¯æµ‹è¯•æ€§ä¸å¥½ã€‚å•ä¾‹å¦‚æœä¾èµ–å¤–éƒ¨èµ„æºï¼Œæƒ³è¿›è¡Œmockæ›¿æ¢æµ‹è¯•ï¼Œä½†ç”±äºå•ä¾‹çš„ç¡¬ç¼–ç ï¼Œæ— æ³•mockã€‚è¿˜æœ‰å¦‚æœæœ‰å¯å˜æˆå‘˜å˜é‡ï¼Œå¤šä¸ªæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œï¼Œéœ€è¦æ’é™¤æˆå‘˜å˜é‡çš„å˜åŒ–å¯¼è‡´æµ‹è¯•ç”¨ä¾‹é€šä¸è¿‡é—®é¢˜ã€‚<br>5ã€å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ„é€ å‡½æ•°ã€‚å¦‚æœæƒ³å®šåˆ¶è¿™ä¸ªå•ç±»ï¼Œå°±æ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿä¼šå¼•å‘ä¸€äº›è¯¯è§£ã€‚<br><br>æ€è€ƒé¢˜1ï¼šUser cachedUser = CacheManager.getInstance().getUser(userId);è¿™ä¸ªå•ç‹¬æŠ½æˆä¸€ä¸ªæ–¹æ³•ï¼ŒCacheManagerå•ä¾‹é€šè¿‡ä¾èµ–æ³¨å…¥æ–¹å¼æ³¨å…¥ã€‚User actualUser = userRepo.getUser(userId);è¿™ä¸ªä¹Ÿå•ç‹¬æŠ½æˆä¸€ä¸ªæ–¹æ³•ã€‚é’ˆå¯¹validateCachedUserå†™å•å…ƒæµ‹è¯•ï¼Œåªéœ€è¦å°†è·å–ä¸¤ä¸ªç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ç”¨mockæ›¿æ¢å³å¯ã€‚<br>æ€è€ƒé¢˜2ï¼šç¬¬ä¸€ç§é€šè¿‡æŠ›å‡ºå¼‚å¸¸æ¥æç¤ºé‡å¤ã€‚ç¬¬äºŒç§é€šè¿‡è¦†ç›–æ–¹å¼è¿›è¡Œã€‚","like_count":0},{"had_liked":false,"id":225700,"user_name":"scmath","can_delete":false,"product_type":"c1","uid":1149022,"ip_address":"","ucode":"641023BB246C29","user_header":"https://static001.geekbang.org/account/avatar/00/11/88/5e/7c76f422.jpg","comment_is_top":false,"comment_ctime":1591837324,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591837324","product_id":100039001,"comment_content":"ä½¿ç”¨æ—¶æ›¿æ¢ï¼Œå•ä¾‹æ— æ³•ä½¿ç”¨æ—¶æ›¿æ¢","like_count":0},{"had_liked":false,"id":223326,"user_name":"å®ˆæ‹™","can_delete":false,"product_type":"c1","uid":1738326,"ip_address":"","ucode":"F594B2DA3F6D4F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/56/509535da.jpg","comment_is_top":false,"comment_ctime":1591062809,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591062809","product_id":100039001,"comment_content":"&lt;äºŒå‘¨ç›®æ‹¾é—&gt;<br><br><br>&#47;**<br> * ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œä¸Šé¢çš„ä»£ç å®ç°ç¨å¾®æœ‰ç‚¹é—®é¢˜ã€‚<br> * å¦‚æœæˆ‘ä»¬å¦‚ä¸‹ä¸¤æ¬¡æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œ<br> * é‚£è·å–åˆ°çš„ singleton1 å’Œ signleton2 çš„ paramA å’Œ paramB éƒ½æ˜¯ 10 å’Œ 50ã€‚<br> * ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒæ¬¡çš„å‚æ•°ï¼ˆ20ï¼Œ30ï¼‰æ²¡æœ‰èµ·ä½œç”¨ï¼Œè€Œæ„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸æç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br> * ç•™ç»™ä½ è‡ªå·±æ€è€ƒï¼Œä½ å¯ä»¥åœ¨ç•™è¨€åŒºè¯´è¯´ä½ çš„è§£å†³æ€è·¯ã€‚*&#47;<br>public class Singleton {<br><br>    private static volatile Singleton INSTANCE;<br><br>    private static int paramA;<br>    private static int paramB;<br><br>    private Singleton(){}<br><br>    public static Singleton getInstance(int paramA, int paramB){<br>        if (INSTANCE == null){<br>            synchronized (Singleton.class){<br>                if (INSTANCE == null){<br>                    INSTANCE = new Singleton();<br>                }<br>            }<br>        }<br><br>        if (INSTANCE.paramA != paramA || INSTANCE.paramB != paramB){<br>            INSTANCE.paramA = paramA;<br>            INSTANCE.paramB = paramB;<br>        }<br><br>        return INSTANCE;<br>    }<br>}","like_count":0},{"had_liked":false,"id":221023,"user_name":"buggetout","can_delete":false,"product_type":"c1","uid":1880582,"ip_address":"","ucode":"63A948EF415FDD","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b2/06/2086d76d.jpg","comment_is_top":false,"comment_ctime":1590383215,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590383215","product_id":100039001,"comment_content":"å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹<br>ä¸æ”¯æŒé¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œæ›´åƒæ˜¯é¢å‘è¿‡ç¨‹ã€‚<br>å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å¥½<br>å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å¥½<br>ä¸èƒ½æœ‰å¸¦å‚æ„é€ å‡½æ•°<br>","like_count":0},{"had_liked":false,"id":221005,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1590377409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590377409","product_id":100039001,"comment_content":"1. æˆ‘è§‰å¾—ç¬¬ä¸€é—®çš„å…³é”®åœ¨äº é‡Œé¢ç”¨äº†ä¸ªå•åˆ—(å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½åœ¨ç”¨è¿™ä¸ªå•ä¾‹) ä¼šå½±å“æµ‹è¯•ç»“æœï¼Œæ‰€ä»¥æ‰ä¼šå¯¼è‡´å¯æµ‹è¯•æ€§ä¸é«˜ æ‰€ä»¥è€ƒè™‘æ–°å¢ä¸€ä¸ªæµ‹è¯•çš„æ•°æ®æˆ–è€…å®ä¾‹ è®©æ­£å¼çš„å’Œæµ‹è¯•çš„æ•°æ®åˆ†å¼€  åŒæ—¶è¿˜è¦åŠ é” ï¼Œé¿å…èµ„æºç«äº‰<br>2. ç¬¬äºŒé—® æˆ‘è§‰å¾— åº”è¯¥æ˜¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸(æˆ–è€…ç»™å‡ºä¸ªæç¤º) å·²ç»åˆå§‹åŒ–è¿‡äº† æœ€å¥½æ˜¯åŠ ä¸ªè¿”å›å€¼ åˆ¤æ–­initæ˜¯å¦æˆåŠŸå·²ç»å¤±è´¥çš„åŸå› ","like_count":0},{"had_liked":false,"id":215220,"user_name":"worthto","can_delete":false,"product_type":"c1","uid":1387712,"ip_address":"","ucode":"41D7ABBBD2E7FF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/N6yjnrLnMW4XVSkBr3f0N3F962l35b5j0kib9VSlAqqbf6iaoCPicL1WnJ9KjgT4egQ7A2G0Zx3OayaK4yuoZrUVA/132","comment_is_top":false,"comment_ctime":1588931968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1588931968","product_id":100039001,"comment_content":"å…³äºé—®é¢˜ ç°æœ‰çš„ä»£ç ä¸­æœ‰å¤ªå¤šçš„å•ä¾‹ï¼Œå¯ä»¥è€ƒè™‘é‡å†™ç°æœ‰çš„å•ä¾‹å¯¹è±¡çš„newStanceæ–¹æ³•ï¼Œç„¶åå†ä¾èµ–æ³¨å…¥ä¸€ä¸ªå•ä¾‹å¯¹è±¡çš„ç”Ÿæˆå™¨InstanceBuilderç±»ï¼ŒæŠŠåˆ›å»ºçš„æ–¹æ³•æ”¾åˆ°è¿™ä¸ªç±»ä¸­ã€‚è¿™æ ·çš„è¯ï¼Œå°±æŠŠåˆ›å»ºè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„é€»è¾‘è§£è€¦äº†ï¼Œå•ä¾‹åªè´Ÿè´£å•ä¾‹å¯¹è±¡çš„ç®¡ç†ã€‚èŒè´£ä¹Ÿå•ä¸€ã€‚å¦‚æœéœ€è¦è¿›è¡Œmockï¼Œé‚£å°±å†™ä¸€ä¸ªInstanceBuilderMockç±»è¿›è¡Œæµ‹è¯•ã€‚","like_count":0},{"had_liked":false,"id":211983,"user_name":"ğŸ¸spray","can_delete":false,"product_type":"c1","uid":1062202,"ip_address":"","ucode":"D183FDBB32222C","user_header":"https://static001.geekbang.org/account/avatar/00/10/35/3a/3afc8d67.jpg","comment_is_top":false,"comment_ctime":1588042805,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1588042805","product_id":100039001,"comment_content":"2 - swift<br>final class Singleton {<br>    private static let _shared = Singleton()<br>    private var a: Int?<br>    private var b: Int?<br>    <br>    private init () {}<br>    public static func shared(a: Int = 0, b: Int = 0) -&gt; Singleton {<br>        _shared.a = a<br>        _shared.b = b<br>        return _shared<br>    }<br>}","like_count":0},{"had_liked":false,"id":210214,"user_name":"zhengyu.nie","can_delete":false,"product_type":"c1","uid":1541669,"ip_address":"","ucode":"FFE0377D323E46","user_header":"https://static001.geekbang.org/account/avatar/00/17/86/25/25ded6c3.jpg","comment_is_top":false,"comment_ctime":1587698807,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587698807","product_id":100039001,"comment_content":"æ•°æ®è¿æ¥æ± ã€çº¿ç¨‹æ± åœ¨Springç¯å¢ƒä¸‹å…¶å®è¿˜æ˜¯å•ä¾‹çš„ï¼Œåœ¨Springé‡å‹æ³¨å…¥æ¡†æ¶ä½“ç³»ä¸‹ï¼ŒåŸºæœ¬ä¸Šç¼–ç¨‹èŒƒå¼éƒ½æ˜¯ç”¨å¯¹åº”çš„@Configurationæ³¨è§£ä¸‹ï¼Œæ³¨å…¥éš”ç¦»çš„æ± å­ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªThreadPoolConfigurationï¼Œé‡Œé¢å‡ ä¸ª@Beanï¼Œæ¯ä¸€ä¸ªBeanæ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä¸šåŠ¡èº«ä»½éš”ç¦»ï¼Œä½¿ç”¨çš„åœ°æ–¹ä¾èµ–æŸ¥æ‰¾å¯¹åº”beanNameçš„æ± å­ï¼Œæ‰˜ç»™Springç®¡ç†äº†ã€‚","like_count":0},{"had_liked":false,"id":204737,"user_name":"Wh1","can_delete":false,"product_type":"c1","uid":1282715,"ip_address":"","ucode":"6D28506B99A285","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/9b/65f98192.jpg","comment_is_top":false,"comment_ctime":1586447706,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586447706","product_id":100039001,"comment_content":"å°†å•ä¾‹åˆå§‹åŒ–å‚æ•°æ”¾åˆ°Configç±»ä¸­è¿™æ®µä»£ç å…¶å®å­˜åœ¨é—®é¢˜ï¼Œå’Œç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹äº†åˆå§‹åŒ–å‚æ•°ï¼Œé‚£ä¹ˆè·å–åˆ°çš„ä¹Ÿä¼šæ˜¯ç”¨ä¹‹å‰çš„å‚æ•°åˆ›å»ºçš„å•ä¾‹å¯¹è±¡ã€‚<br>è§£å†³æ–¹æ¡ˆå¯ä»¥æ˜¯ï¼šä¸ç›´æ¥å¯¹Configç±»ä¸­çš„å‚æ•°èµ‹å€¼ï¼Œè€Œæ˜¯é€šè¿‡ setter åœ¨åˆå§‹åŒ– instance ä¹‹å‰è¿›è¡Œèµ‹å€¼ã€‚åŸç†å…¶å®å’Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆå·®ä¸å¤ªå¤šã€‚<br>ä½†å›è¿‡å¤´æƒ³ï¼Œå¦‚æœä¸€å¼€å§‹å°±é¢„æ–™åˆ°è¦é€šè¿‡ä¸åŒå‚æ•°åˆ›å»ºä¸åŒçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ç§åœºæ™¯ä¹Ÿä¸é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":204460,"user_name":"å¢¨é±¼","can_delete":false,"product_type":"c1","uid":1022720,"ip_address":"","ucode":"8FB5E4DCB8A024","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/00/654be3f7.jpg","comment_is_top":false,"comment_ctime":1586402734,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586402734","product_id":100039001,"comment_content":"ç¬¬äºŒé¢˜ï¼Œå¦‚æœç¬¬äºŒæ¬¡æ²¡æˆåŠŸï¼ŒæŠ›å‡ºå¼‚å¸¸å³å¯ã€‚<br><br>æ²¡æƒ³åˆ°å•ä¾‹æ¨¡å¼è¿˜æœ‰è¿™ä¹ˆå¤šç¼ºç‚¹ï¼Œè¿™æ˜¯æˆ‘æ²¡æƒ³åˆ°è¿‡çš„ï¼Œæˆ‘çœ‹åˆ«çš„æ–‡ç« éƒ½æ˜¯ç›´æ¥å‘Šè¯‰æˆ‘æ€ä¹ˆå®ç°å•ä¾‹æ¨¡å¼ï¼Œäº‰å“¥ç‰›é€¼","like_count":0},{"had_liked":false,"id":203114,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1324863,"ip_address":"","ucode":"FFC31A3FE3A285","user_header":"https://static001.geekbang.org/account/avatar/00/14/37/3f/a9127a73.jpg","comment_is_top":false,"comment_ctime":1586141362,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1586141362","product_id":100039001,"comment_content":"##æ€è€ƒé¢˜2<br>ç¬¬äºŒæ¬¡æ²¡æœ‰ç”Ÿæ•ˆä¹Ÿæ²¡æœ‰ç‰¹æ®Šæç¤ºçš„åŸå› åˆ†æï¼šå› ä¸ºç¬¬ä¸€æ¬¡å·²ç»åˆ›å»ºäº†å®ä¾‹ï¼Œæ‰€ä»¥ï¼Œç¬¬äºŒæ¬¡ç›´æ¥è¿”å›äº†ã€‚å¹¶æ²¡æœ‰èµ°å†æ¬¡èµ°åˆ°å•ä¾‹æ„é€ å‡½æ•°çš„æ‰§è¡Œï¼Œæ•…è€Œç›¸å…³çš„å€¼è¿˜æ˜¯åŸæ¥çš„å€¼ã€‚","like_count":0},{"had_liked":false,"id":202968,"user_name":"å²æœˆ","can_delete":false,"product_type":"c1","uid":1337598,"ip_address":"","ucode":"29A2A2BC3C4FE4","user_header":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","comment_is_top":false,"comment_ctime":1586095039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586095039","product_id":100039001,"comment_content":"æˆ‘æ„Ÿè§‰å•ä¾‹çš„è¿™äº›é—®é¢˜éƒ½ä¸æ˜¯é—®é¢˜ï¼Œå¤§ä¸äº†å°±ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼ï¼Œä»å¤–é¢ä¼ è¿›å»å®ä¾‹ã€‚è‡³äºå•ä¾‹æœ¬èº«å¯ä»¥äº†ä¾èµ–æ¥å£å¼€å‘","like_count":0},{"had_liked":false,"id":201494,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1585795651,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585795651","product_id":100039001,"comment_content":"åˆ°åº•å“ªä¸€ç‰ˆjdkå®ç°äº†å®ä¾‹åŒ–å¯¹è±¡é¿å…æŒ‡ä»¤é‡æ’ï¼Ÿï¼ŸæŒ‡ä»¤é‡æ’æœ¬æ¥å°±æ˜¯ä¸€ç§ä¼˜åŒ–æ‰‹æ®µï¼Œæˆ‘æ„Ÿè§‰ä¸å¯èƒ½ä¼šå…¨éƒ¨ç¦ç”¨æ‰å§ï¼Œæ‰‹åŠ¨volatileç¦ç”¨æ‰æ˜¯æœ€åˆç†çš„ã€‚è¯·è€å¸ˆå›å¤ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":200973,"user_name":"Geek_0a912e","can_delete":false,"product_type":"c1","uid":1797776,"ip_address":"","ucode":"3764D74EECF8E6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKAyfsLlZkYjRiaSiaxf07h6hNEu2AKyoZpCYqoE5K7xv13LdwCwE7ZDnSxr8drc5gOumgiapbn27KicA/132","comment_is_top":false,"comment_ctime":1585700766,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1585700766","product_id":100039001,"comment_content":"è¿™æ¡æ²¡å¤ªçœ‹æ˜ç™½ï¼Œéº»çƒ¦å†è§£é‡Šä¸€ä¸‹ï¼šå•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æ„é€ å‡½æ•°","like_count":0,"discussions":[{"author":{"id":2446652,"avatar":"","nickname":"Geek_70aee8","note":"","ucode":"ABC47717D5B655","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354533,"discussion_content":"æˆ‘çš„çœ‹æ³•æ˜¯ï¼šæ­£å¦‚é—®é¢˜è®¨è®º2ä¸­çš„æƒ…å†µï¼Œå¦‚æœè¾“å…¥ä¸¤ç»„å‚æ•°è¿›å»çš„è¯ï¼Œéœ€è¦ä¿®æ”¹å•ä¾‹ç±»çš„ä»£ç ï¼Œæ‰èƒ½ä¿è¯è¾“å…¥ä¸åŒå‚æ•°æ—¶ç”Ÿæˆä¸åŒå•ä¾‹ç±»ï¼›å¦‚æœä¸¤æ¬¡è¾“å…¥å‚æ•°ä¸€è‡´ï¼Œè¿˜å¾—ä¿è¯ä¸¤æ¬¡è°ƒç”¨åŒä¸€ä¸ªå•ä¾‹ç±»ã€‚æ‰€ä»¥ï¼Œå•ä¾‹æ”¯æŒå¸¦å‚æ•°çš„æ„é€ å‡½æ•°çš„è¯ï¼Œä¼šäº§ç”Ÿè¯¯å¯¼ã€‚\nè§£å†³æ–¹æ³•ï¼šé€šè¿‡å°†å‚æ•°å†™æˆé…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œç„¶åæ„é€ å‡½æ•°å†…éƒ¨é€šè¿‡è¯»å–é…ç½®ä¿¡æ¯ç”Ÿæˆå¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615300102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1967515,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/7xB3OdNLiaPgZQibVAD52Jx04buk6Tb3I7A4wcdea2c6YXxJGdKgGCPgPuGWh69CffdSJKOqJFzVRVOEWBqFybJA/132","nickname":"Geek_83f2ce","note":"","ucode":"471D47B2A342E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294546,"discussion_content":"æˆ‘ä¹Ÿä¸å¤ªæ‡‚è¿™ä¸€ç‚¹ï¼Œæœ‰æ²¡æœ‰æ‡‚çš„å°ä¼™ä¼´ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595922749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198102,"user_name":"junmawang","can_delete":false,"product_type":"c1","uid":1763466,"ip_address":"","ucode":"977E9E25CE6C94","user_header":"https://static001.geekbang.org/account/avatar/00/1a/e8/8a/803a42e0.jpg","comment_is_top":false,"comment_ctime":1585409229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585409229","product_id":100039001,"comment_content":"é’ˆå¯¹ä¸ä¼ é€’è¿›å»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œå¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ä¸¤ä¸ªä¸´æ—¶å˜é‡ï¼Œå¯¹ä¸Šä¸€æ¬¡åˆ›å»ºå®ä¾‹å¯¹paramA, paramBèµ‹å€¼åˆ°ä¸´æ—¶å˜é‡ï¼Œä¸‹æ¬¡è°ƒç”¨åˆ¤æ–­æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™é‡æ–°åˆ›å»º","like_count":0},{"had_liked":false,"id":193623,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1584935396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584935396","product_id":100039001,"comment_content":"è€å¸ˆ   æˆ‘æ„Ÿè§‰è¿™æ®µå…¶å®ä¸ç®—æ˜¯ä¸€ç§æ–°çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒä»ç„¶ç®—æ˜¯â€œå•ä¾‹æ¨¡å¼â€å•Šï¼Œåªä¸è¿‡è¿™ä¸ªä¾‹å­æ¯”è¾ƒç‰¹æ®Šã€‚<br><br>public class IdGenerator {  private static AtomicLong id = new AtomicLong(0);    public static long getId() {     return id.incrementAndGet();  }}<br><br><br>","like_count":0},{"had_liked":false,"id":187307,"user_name":"M","can_delete":false,"product_type":"c1","uid":1810576,"ip_address":"","ucode":"06F26E1D62E9C9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/eLNeJNaEkwGSK7xvtamMibVLMy2MpbIqX3iaEhT7JtSnTRMRTwZ2j4HX7WAapiashbiaBDVriaXKSP0Oeic6ZAEVEXag/132","comment_is_top":false,"comment_ctime":1584080674,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584080674","product_id":100039001,"comment_content":"æ€è€ƒé¢˜ï¼š<br>1. ç”¨å·¥å‚æ¨¡å¼æŠŠCacheManager.getInstance()å¯¹è±¡åˆ›å»ºæå‡ºæ¥<br>2. <br>public class Singleton {<br>    private static Singleton instance = null;<br>    private final int paramA;<br>    private final int paramB;<br>    private static int variableA = 0;<br>    private static int variableB = 0;<br><br>    private Singleton(int paramA, int paramB) {<br>        this.paramA = paramA;<br>        this.paramB = paramB;<br>    }<br><br>    public synchronized static Singleton getInstance(int paramA, int paramB) {<br>        if (instance == null) {<br>            instance = new Singleton(paramA, paramB);<br>            variableA = paramA;<br>            variableB = paramB;<br>        } else if (paramA == variableA &amp;&amp; paramB == variableB) {<br>            return instance;<br>        } else {<br>            throw new RuntimeException(&quot;Parameter 20&#47;30 creation failed&quot;);<br>        }<br>        return instance;<br>    }<br><br>}<br>","like_count":0},{"had_liked":false,"id":183107,"user_name":"é›·åˆš","can_delete":false,"product_type":"c1","uid":1655725,"ip_address":"","ucode":"115FE2BE1AAB61","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/pTD8nS0SsORKiaRD3wB0NK9Bpd0wFnPWtYLPfBRBhvZ68iaJErMlM2NNSeEibwQfY7GReILSIYZXfT9o8iaicibcyw3g/132","comment_is_top":false,"comment_ctime":1582954565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582954565","product_id":100039001,"comment_content":"ä»¥å‰å†™è¿‡ä¸€ä¸ª TelnetManager çš„ç±»ï¼Œå†™å•å…ƒæµ‹è¯•çš„æ—¶å€™å¾ˆç—›è‹¦ï¼Œä¸è¿‡é‚£æ—¶å€™åªæ˜¯è§‰å¾—å•ä¾‹ä¸å¥½å†™å•å…ƒæµ‹è¯•ï¼Œæ²¡æœ‰ç»†æƒ³ï¼Œå¬äº†è€å¸ˆçš„åˆ†ææ‰è±ç„¶å¼€æœ—","like_count":0},{"had_liked":false,"id":181047,"user_name":"DullBird","can_delete":false,"product_type":"c1","uid":1110494,"ip_address":"","ucode":"80E2FD5F9687CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/f1/de/3ebcbb3f.jpg","comment_is_top":false,"comment_ctime":1582465760,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582465760","product_id":100039001,"comment_content":"1. æŠŠ CacheManager.getInstance().getUser(userId);å°è£…æˆæ–¹æ³•<br>2. åšä¸€ä¸ªåˆ¤æ–­ã€‚å¦‚æœå·²ç»åˆå§‹åŒ–æŠ›å‡ºå¼‚å¸¸","like_count":0},{"had_liked":false,"id":179793,"user_name":"å²æœˆ","can_delete":false,"product_type":"c1","uid":1337598,"ip_address":"","ucode":"29A2A2BC3C4FE4","user_header":"https://static001.geekbang.org/account/avatar/00/14/68/fe/1353168d.jpg","comment_is_top":false,"comment_ctime":1582100552,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582100552","product_id":100039001,"comment_content":"è®¨è®ºé¢˜1: è¿™é‡Œæµ‹è¯•çš„ä¸æ˜¯å•ä¾‹å¯¹è±¡, è€Œæ˜¯ä¾èµ–å•ä¾‹çš„ç±», æ‰€ä»¥å•ä¾‹å¯ä»¥ç›´æ¥ç”¨ä¾èµ–æ³¨å…¥çš„å½¢å¼ä¼ å…¥å³å¯, Demoç±»ä¸è¦åœ¨å†…éƒ¨åˆ›å»ºå•ä¾‹å¯¹è±¡, è€Œæ˜¯ç›´æ¥ä½¿ç”¨å¤–éƒ¨ä¼ å…¥çš„å•ä¾‹å¯¹è±¡.<br>è®¨è®ºé¢˜2: æŠŠä¸åŒçš„å‚æ•°è½¬æˆå­—ç¬¦ä¸²ä½œä¸ºkey, å†ç”¨ä¸€ä¸ªå­—å…¸é’ˆå¯¹æ¯ä¸€ä¸ªkeyå•ç‹¬åˆ›å»ºå•ä¾‹å¯¹è±¡, è¿™æ ·å¯ä»¥ä¿è¯ä¼ å…¥çš„å‚æ•°ç›¸åŒæ—¶è·å–åˆ°çš„å¯¹è±¡æ˜¯åŒä¸€ä¸ª, ä¸åŒå‚æ•°å¯¹åº”ä¸åŒå•ä¾‹å¯¹è±¡.","like_count":0},{"had_liked":false,"id":179495,"user_name":"HYM","can_delete":false,"product_type":"c1","uid":1054178,"ip_address":"","ucode":"4E82D9A285DAFF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/e2/c21553c4.jpg","comment_is_top":false,"comment_ctime":1582015910,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582015910","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæŠŠcache userçš„è·å–æ”¹æˆå‡½æ•°è¿”å›ï¼Œè¿™æ ·å¯ä»¥åœ¨æµ‹è¯•çš„æ—¶å€™å¯¹å‡½æ•°è¿›è¡Œmockã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼šæ­¤æ—¶éœ€è¦æ¯”è¾ƒå·²ç»å­˜åœ¨çš„instanceçš„å‚æ•°å’Œä¼ å…¥çš„æ–°å‚æ•°æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´å°±è¿”å›instanceï¼Œä¸ä¸€è‡´ç›´æ¥æŠ¥é”™ã€‚","like_count":0},{"had_liked":false,"id":178737,"user_name":"æ¡‚åŸè€æ‰˜å°¼","can_delete":false,"product_type":"c1","uid":1306032,"ip_address":"","ucode":"139E4B8EE88B79","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","comment_is_top":false,"comment_ctime":1581810136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581810136","product_id":100039001,"comment_content":"æ„Ÿè°¢åˆ†äº«ï¼Œå°è¯•å›ç­”ä¸‹<br>1,cacheManagerä½œä¸ºdemoçš„å±æ€§ï¼Œæ„é€ demoå¯¹è±¡æ—¶ è·å–å•ä¾‹ï¼Œè€Œéæ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶è·å–ã€‚<br>2ï¼ŒcompareAndUpdate æ€è·¯å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸è¿‡è™½ç„¶èƒ½è§£å†³é—®é¢˜ï¼Œä½†è¿™ç§ç”¨æ³•çœŸçš„å¥½å—ï¼Ÿå¤ªåˆé’»äº†~","like_count":0},{"had_liked":false,"id":178618,"user_name":"FIGNT","can_delete":false,"product_type":"c1","uid":1540988,"ip_address":"","ucode":"D9DB185AE9E67C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ16iaIia0029oI1Qh5NicibpbTiaBAaCOPYXoLplKHr6uQ2rSVxPZanBvpMcL2NuhwKQYCFnaHP5tedQ/132","comment_is_top":false,"comment_ctime":1581760000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581760000","product_id":100039001,"comment_content":"1ã€å°†å•ä¾‹è·å–å¯¹è±¡çš„ä»£ç æŠ½ç¦»å•ç‹¬æ–¹æ³•ã€‚å†å¯¹æ–¹æ³•mock<br>2ã€å¦‚æœå‚æ•°ä¸ç›¸åŒï¼Œç›´æ¥æŠ¥é”™ï¼Œå‘Šè¯‰ä½¿ç”¨è€…å¦‚ä½•ä½¿ç”¨ã€‚<br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br>    if (instance == null) {<br>      instance = new Singleton(paramA, paramB);<br>    }else{<br>    \tif(paramA == this.paramA &amp;&amp; paramB == this.paramB){<br>    \t\treturn instance;<br>    \t}else{<br>    \t\tthrow new RuntimeException(&quot;illegal argument,please use getInstance(&quot;+this.paramA+&quot;,&quot;+this.paramB+&quot;) method&quot;);<br>    \t}<br>    }<br>  }","like_count":0},{"had_liked":false,"id":178045,"user_name":"LğŸš²ğŸ±","can_delete":false,"product_type":"c1","uid":1577856,"ip_address":"","ucode":"08A012739614DE","user_header":"https://static001.geekbang.org/account/avatar/00/18/13/80/2c9da1b1.jpg","comment_is_top":false,"comment_ctime":1581577673,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581577673","product_id":100039001,"comment_content":"è¯¾å ‚è®¨è®º: 1. æŠŠ User cachedUser = CacheManager.getInstance().getUser(userId); æŠ½å‡ºæ¥, å˜æˆä¸€ä¸ªå‡½æ•°,è¿™æ ·å°±å¯ä»¥å¯¹å‡½æ•° mock äº†<br>             2. åœ¨è¿› getInstanceå‡½æ•°çš„æ—¶å€™, å¯¹å…¨å±€å˜é‡ instance ç½®ç©º<br><br>","like_count":0},{"had_liked":false,"id":177933,"user_name":"ä¸€åå°å­¦ç”Ÿ","can_delete":false,"product_type":"c1","uid":1137292,"ip_address":"","ucode":"5C73082E6B6370","user_header":"https://static001.geekbang.org/account/avatar/00/11/5a/8c/1fec5fa2.jpg","comment_is_top":false,"comment_ctime":1581553616,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581553616","product_id":100039001,"comment_content":"æ‰“å¡ï½","like_count":0},{"had_liked":false,"id":177448,"user_name":"å°åˆ€","can_delete":false,"product_type":"c1","uid":1351063,"ip_address":"","ucode":"94DF8C45E09E42","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/iaByN5IfYbE9jMtWrtTDXtPEIHeV77KW1p7ZkiasiaGgA50VXaibo4fbp5ib2JkFP3iaIe4AUudLibufkEIofu5euCNHg/132","comment_is_top":false,"comment_ctime":1581394703,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581394703","product_id":100039001,"comment_content":"ç¬¬äºŒæ¬¡è°ƒç”¨getInstanceæ—¶å¦‚æœå¸¦æœ‰ä¸ä¹‹å‰ç›¸åŒå‚æ•°å°±ç›´æ¥è¿”å›instanceå®ä¾‹;å¦‚æœå‚æ•°ä¸ç›¸åŒä¸”ä¸šåŠ¡å…è®¸æ„å»ºæ–°çš„instanceå®ä¾‹å°±å…è®¸å†ç¬¬äºŒæ¬¡getInstanceæ—¶æ„å»ºæ–°çš„å®ä¾‹,å¦‚æœä¸šåŠ¡ä¸å…è®¸å°±åœ¨æ„å»ºæ—¶æŠ›å‡ºå¼‚å¸¸.","like_count":0},{"had_liked":false,"id":177283,"user_name":"bin","can_delete":false,"product_type":"c1","uid":1307082,"ip_address":"","ucode":"EC4F4194082715","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/ca/9b9b8a7c.jpg","comment_is_top":false,"comment_ctime":1581341486,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581341486","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæŠŠ CacheManager.getInstance().getUser() å°è£…æˆä¸€ä¸ªå‡½æ•°,å¯ä»¥ç”¨æ¥mock<br>public User getCacheUser(long userId){<br>}<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒåŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œ<br><br>public synchronized static Singleton getInstance(int paramA, int paramB) {<br> if (instance == null) { <br>     instance = new Singleton(paramA, paramB); <br>     return instance;<br> }<br>if( instance != null &amp;&amp; (paramA != this.paramA || paramB != this.paramB )  ){<br>     throw new RunTimeException(&quot;ä¸èƒ½é‡å¤åˆå§‹åŒ–&quot;);<br>}<br> return instance; <br>}","like_count":0},{"had_liked":false,"id":177239,"user_name":"å¤©å¤©å‘ä¸Šå¡ç´¢","can_delete":false,"product_type":"c1","uid":1009850,"ip_address":"","ucode":"E3724C3B39BD3F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/ba/c0cf8bf3.jpg","comment_is_top":false,"comment_ctime":1581330360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581330360","product_id":100039001,"comment_content":"åœ¨ .net core é‡Œï¼Œä¾èµ–æ³¨å…¥æ¨¡å¼çš„ä½¿ç”¨æ¯”è¾ƒå¤šï¼Œå¯¹äºä¸€äº›é…ç½®ä¼šé€šè¿‡optionsæ¨¡å¼æ¥å¤„ç†ï¼Œoptionä¹Ÿå¯ä»¥æ³¨å…¥ï¼Œå¾ˆçµæ´»","like_count":0},{"had_liked":false,"id":176980,"user_name":"Uncle.Wang","can_delete":false,"product_type":"c1","uid":1456955,"ip_address":"","ucode":"9A4F646CFC237F","user_header":"https://static001.geekbang.org/account/avatar/00/16/3b/3b/b8c00291.jpg","comment_is_top":false,"comment_ctime":1581240820,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581240820","product_id":100039001,"comment_content":"æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šåœ¨clientç«¯å¼€å‘çš„æ—¶å€™ï¼Œå·¥ç¨‹ä¸­æœ‰å¤§é‡å•ä¾‹ï¼Œè¿™äº›å•ä¾‹ä¸­ä¿å­˜ç€æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®å¯èƒ½æ˜¯å’Œç”¨æˆ·è´¦æˆ·ç›¸å…³è”çš„ï¼Œä¸€æ—¦åˆ‡æ¢è´¦å·ï¼Œé¢ä¸´resetè¿™äº›å•ä¾‹çš„é—®é¢˜ï¼Œå¾€å¾€å­˜åœ¨é—æ¼ã€‚å¦‚æœå¤§é‡å­˜åœ¨è¿™ç§å•ä¾‹ï¼Œä¼šå¾ˆéš¾ç»´æŠ¤ã€‚","like_count":0,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503177,"discussion_content":"å°ä¼™ä½ å¦¹å•Š æˆ‘éƒ½ä¸­å¹´æ²¹è…»å¤§å”äº†ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597412235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176924,"user_name":"å®ˆæ‹™","can_delete":false,"product_type":"c1","uid":1738326,"ip_address":"","ucode":"F594B2DA3F6D4F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/86/56/509535da.jpg","comment_is_top":false,"comment_ctime":1581228054,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581228054","product_id":100039001,"comment_content":"<br><br><br><br>è¯¾å ‚è®¨è®º <br><br>1. ä¿®æ”¹validateCachedUser()æ–¹æ³•å½¢å‚: <br><br>   public boolean validateCachedUser(int userId, \tCacheManager manager){...}<br><br>â€‹    <br><br>2. å¸¦æœ‰å‚æ•°çš„getInstance()çš„ä¸€ç§å®ç°æ–¹å¼:<br><br>   public syncrinized static Singleton getInstance(int paramA, int paramB){<br><br>   â€‹    if(instance == null){<br><br>   â€‹        instance = new Singleton(paramA, paramB);<br><br>   â€‹        }<br><br>   <br><br>   â€‹    if(this.paramA != paramA || this.paramB != paramB){<br><br>   â€‹        instance = new Singleton(paramA, paramB);<br><br>   â€‹        }<br><br>   <br><br>   â€‹    return instance;<br><br>   }","like_count":0,"discussions":[{"author":{"id":1046893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f9/6d/b623562a.jpg","nickname":"éœ¹é›³å¤§ä»™pp","note":"","ucode":"F654FD9AEC1D56","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":195625,"discussion_content":" CacheManagerå¸¦åœ¨å½¢å‚é‡Œï¼Œè¿åäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼ŒæŠ½æˆä¸€ä¸ªprotectedæ–¹æ³•æ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583291970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176920,"user_name":"mghio","can_delete":false,"product_type":"c1","uid":1213078,"ip_address":"","ucode":"74883EDE4FD0DC","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","comment_is_top":false,"comment_ctime":1581225613,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581225613","product_id":100039001,"comment_content":"ä¼˜ç§€ï¼Œå•ä¾‹æ¨¡å¼ç«Ÿç„¶è¿˜æœ‰è¿™ä¹ˆå¤šé—®é¢˜ä»¥å‰åªæ˜¯ç”¨ï¼Œä»æ¥æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ–¹é¢","like_count":0},{"had_liked":false,"id":176699,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1581141690,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581141690","product_id":100039001,"comment_content":"1.æŠŠå•ä¾‹éƒ¨åˆ†æŠ½å‡ºæ¥ï¼›<br>2.ä¸ºç©ºæˆ–è€…ä¸€è‡´çš„æ—¶å€™è¿”å›å¯ç”¨instanceï¼Œä¸ä¸€è‡´åˆ™æŠ›é”™ã€‚","like_count":0},{"had_liked":false,"id":176680,"user_name":"å¹³é£é€ é›¨","can_delete":false,"product_type":"c1","uid":1014349,"ip_address":"","ucode":"F9EE4704F31E22","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/4d/b0228a1a.jpg","comment_is_top":false,"comment_ctime":1581137134,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581137134","product_id":100039001,"comment_content":"é—®é¢˜2ä½¿ç”¨ä¸åŒå‚æ•°æ„é€ ä¸åŒå•ä¾‹ï¼Œæ˜¯è¿™ä¸ªéœ€æ±‚å—ï¼Ÿå¦‚æœæ˜¯é‚£ä¹ˆç»´æŠ¤ç±»å°±ä¸èƒ½åªæœ‰ä¸€ä¸ªinstanceçš„æˆå‘˜å˜é‡ï¼Œåº”è¯¥è€ƒè™‘æœ‰ç±»ä¼¼cachedMapçš„æ–¹å¼ï¼Œinstanceè¦å®ç°equalså’ŒhashCodeæ–¹æ³•ï¼Œé’ˆå¯¹ä¸åŒå…¥å‚ä½œä¸ºä¸åŒçš„keyï¼Œçº¿ç¨‹å®‰å…¨çš„å»è®¿é—®cachedMapè¿›è¡Œå­˜å–ã€‚","like_count":0},{"had_liked":false,"id":176581,"user_name":"å¤±ç«çš„å¤å¤©","can_delete":false,"product_type":"c1","uid":1241770,"ip_address":"","ucode":"10C6E66EB2A65F","user_header":"https://static001.geekbang.org/account/avatar/00/12/f2/aa/32fc0d54.jpg","comment_is_top":false,"comment_ctime":1581091338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581091338","product_id":100039001,"comment_content":"ç›´æ¥æ›´æ–°å±æ€§æ€•æ˜¯ä¼šæœ‰ä¸€ä¸ªå®‰å…¨é—®é¢˜å§ï¼Œä¸€ä¸ªé•¿çº¿ç¨‹å¦‚æœä¸€ç›´åœ¨ä½¿ç”¨å¯¹è±¡ï¼Œä¸€ä¸ªå…¶ä»–çº¿ç¨‹è¿›æ¥åï¼ŒæŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„å±æ€§ç›´æ¥ä¿®æ”¹äº†ã€‚é•¿çº¿ç¨‹æ¥ä¸‹æ¥å¦‚æœä½¿ç”¨åˆ°å•ä¾‹å¯¹è±¡ï¼Œå±æ€§å°±å…¨å˜äº†ã€‚çº¿ç¨‹å®‰å…¨æ€§å¤ªå·®äº†ã€‚","like_count":0},{"had_liked":false,"id":176407,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1581052034,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581052034","product_id":100039001,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥å…ˆæŠ½å–ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åmock ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥æ¯”è¾ƒä¼ å…¥çš„å‚æ•°å¯¹æ¯”ï¼Œç›¸åŒæ‰è¿›è¡Œæ–°å»ºå¯¹åº”å¯¹è±¡","like_count":0},{"had_liked":false,"id":176358,"user_name":"å¥½åƒä¸è´µ","can_delete":false,"product_type":"c1","uid":1316993,"ip_address":"","ucode":"6576E2BECE4F7C","user_header":"https://static001.geekbang.org/account/avatar/00/14/18/81/83b6ade2.jpg","comment_is_top":false,"comment_ctime":1581042586,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1581042586","product_id":100039001,"comment_content":"å…³äºå•ä¾‹æ¨¡å¼çš„æ›¿æ¢æ–¹æ¡ˆã€‚ç±»å®ç°æ—¶normalClassç”¨æ™®é€šå†™æ³•ï¼Œæ„é€ å‡½æ•°ä¹Ÿæ˜¯publicçš„ã€‚åœ¨ç±»å¤–é¢ï¼Œå…¨å±€å®šä¹‰static normalClass obj;è¿™æ ·ç›´æ¥è°ƒç”¨objçš„æ–¹æ³•æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯å…¨å±€å”¯ä¸€äº†ï¼Œè‡³å°‘åŒä¸€è¿›ç¨‹å†…æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§å•ä¾‹çš„æ›¿ä»£æ–¹æ¡ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":176349,"user_name":"è¿·ç¾Š","can_delete":false,"product_type":"c1","uid":1286251,"ip_address":"","ucode":"85AF8CED3436C8","user_header":"https://static001.geekbang.org/account/avatar/00/13/a0/6b/0a21b2b8.jpg","comment_is_top":false,"comment_ctime":1581040330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581040330","product_id":100039001,"comment_content":"1.é€šè¿‡å‚æ•°çš„æ–¹å¼å°†å•ä¾‹ç±»ä¼ é€’è¿›å‡½æ•°ã€‚<br>2.å¦‚æœå•ä¾‹å¯¹è±¡å­˜åœ¨ï¼Œå°±å¯¹æ¯”ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œä¸ä¸€è‡´å°±æŠ›å‡ºå¼‚å¸¸æç¤ºè°ƒç”¨æ–¹ï¼Œä¸€è‡´å°±ç›´æ¥è¿”å›å•ä¾‹å¯¹è±¡ã€‚","like_count":0},{"had_liked":false,"id":176337,"user_name":"çŸ³ç»´åº·","can_delete":false,"product_type":"c1","uid":1067564,"ip_address":"","ucode":"E39ED8416B2C01","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/2c/f8451d77.jpg","comment_is_top":false,"comment_ctime":1581038842,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1581038842","product_id":100039001,"comment_content":"<br>public class Singleton {<br>  private static Singleton instance = null;<br>  private final int paramA;<br>  private final int paramB;<br><br>  private Singleton(int paramA, int paramB) {<br>    this.paramA = paramA;<br>    this.paramB = paramB;<br>  }<br><br>  public static Singleton getInstance() {<br>    if (instance == null) {<br>       throw new RuntimeException(&quot;Run init() first.&quot;);<br>    }<br>    return instance;<br>  }<br><br>  public synchronized static Singleton init(int paramA, int paramB) {<br>    if (instance != null){<br>       throw new RuntimeException(&quot;Singleton has been created!&quot;);<br>    }<br>    instance = new Singleton(paramA, paramB);<br>    return instance;<br>  }<br>}<br><br>Singleton.init(10, 50); &#47;&#47; å…ˆinitï¼Œå†ä½¿ç”¨<br>Singleton singleton = Singleton.getInstance();<br><br>è¯·é—®è€å¸ˆè¿™é‡Œçš„initæ–¹æ³•ä¸ºä½•éœ€è¦è¿”å›ä¸€ä¸ªSingletonï¼Ÿå†™æˆvoidä¸è¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1316993,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/81/83b6ade2.jpg","nickname":"å¥½åƒä¸è´µ","note":"","ucode":"6576E2BECE4F7C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":163161,"discussion_content":"è²Œä¼¼voidä¹Ÿå¯ä»¥ï¼Ÿä¸è¿‡è¿”å›çš„instanceçš„è¯ï¼Œç³»ç»Ÿåˆå§‹åŒ–æ—¶å€™å¯ä»¥åˆ¤æ–­æ˜¯ä¸æ˜¯åˆå§‹åŒ–æˆåŠŸäº†ï¼Œæ›´å¥½äº›ã€‚çŒœæµ‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1581055682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}