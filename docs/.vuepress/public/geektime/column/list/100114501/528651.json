{"id":528651,"title":"03｜容器化的应用：会了这些你就是Docker高手","content":"<p>你好，我是Chrono。</p><p>在上一次课里，我们了解了容器技术中最核心的概念：容器，知道它就是一个系统中被隔离的特殊环境，进程可以在其中不受干扰地运行。我们也可以把这段描述再简化一点：<strong>容器就是被隔离的进程</strong>。</p><p>相比笨重的虚拟机，容器有许多优点，那我们应该如何创建并运行容器呢？是要用Linux内核里的namespace、cgroup、chroot三件套吗？</p><p>当然不会，那样的方式实在是太原始了，所以今天，我们就以Docker为例，来看看什么是容器化的应用，怎么来操纵容器化的应用。</p><h2>什么是容器化的应用</h2><p>之前我们运行容器的时候，显然不是从零开始的，而是要先拉取一个“镜像”（image），再从这个“镜像”来启动容器，像<a href=\"https://time.geekbang.org/column/article/528619\">第一节课</a>这样：</p><pre><code class=\"language-plain\">docker pull busybox      \ndocker run busybox echo hello world\n</code></pre><p>那么，这个“镜像”到底是什么东西呢？它又和“容器”有什么关系呢？</p><p>其实我们在其他场合中也曾经见到过“镜像”这个词，比如最常见的光盘镜像，重装电脑时使用的硬盘镜像，还有虚拟机系统镜像。这些“镜像”都有一些相同点：只读，不允许修改，以标准格式存储了一系列的文件，然后在需要的时候再从中提取出数据运行起来。</p><!-- [[[read_end]]] --><p>容器技术里的镜像也是同样的道理。因为容器是由操作系统动态创建的，那么必然就可以用一种办法把它的初始环境给固化下来，保存成一个静态的文件，相当于是把容器给“拍扁”了，这样就可以非常方便地存放、传输、版本化管理了。</p><p><img src=\"https://static001.geekbang.org/resource/image/59/33/59a1cd035e21fe297072b20475d3c833.jpg?wh=1418x759\" alt=\"图片\"></p><p>如果还拿之前的“小板房”来做比喻的话，那么镜像就可以说是一个“样板间”，把运行进程所需要的文件系统、依赖库、环境变量、启动参数等所有信息打包整合到了一起。之后镜像文件无论放在哪里，操作系统都能根据这个“样板间”快速重建容器，应用程序看到的就会是一致的运行环境了。</p><p>从功能上来看，镜像和常见的tar、rpm、deb等安装包一样，都打包了应用程序，<strong>但最大的不同点在于它里面不仅有基本的可执行文件，还有应用运行时的整个系统环境。这就让镜像具有了非常好的跨平台便携性和兼容性</strong>，能够让开发者在一个系统上开发（例如Ubuntu），然后打包成镜像，再去另一个系统上运行（例如CentOS），完全不需要考虑环境依赖的问题，是一种更高级的应用打包方式。</p><p>理解了这一点，我们再回过头来看看第一节课里运行的Docker命令。</p><p><code>docker pull busybox</code> ，就是获取了一个打包了busybox应用的镜像，里面固化了busybox程序和它所需的完整运行环境。</p><p><code>docker run&nbsp;busybox echo hello world</code> ，就是提取镜像里的各种信息，运用namespace、cgroup、chroot技术创建出隔离环境，然后再运行busybox的 <code>echo</code> 命令，输出 <code>hello world</code> 的字符串。</p><p>这两个步骤，由于是基于标准的Linux系统调用和只读的镜像文件，所以，无论是在哪种操作系统上，或者是使用哪种容器实现技术，都会得到完全一致的结果。</p><p>推而广之，任何应用都能够用这种形式打包再分发后运行，这也是无数开发者梦寐以求的“一次编写，到处运行（Build once, Run anywhere）”的至高境界。所以，<strong>所谓的“容器化的应用”，或者“应用的容器化”，就是指应用程序不再直接和操作系统打交道，而是封装成镜像，再交给容器环境去运行</strong>。</p><p>现在你就应该知道了，镜像就是静态的应用容器，容器就是动态的应用镜像，两者互相依存，互相转化，密不可分。</p><p>之前的那张Docker官方架构图你还有印象吧，我们在第一节课曾经简单地介绍过。可以看到，在Docker里的核心处理对象就是镜像（image）和容器（container）：</p><p><img src=\"https://static001.geekbang.org/resource/image/c8/fe/c8116066bdbf295a7c9fc25b87755dfe.jpg?wh=1920x1048\" alt=\"图片\"></p><p>好，理解了什么是容器化的应用，接下来我们再来学习怎么操纵容器化的应用。因为镜像是容器运行的根本，先有镜像才有容器，所以先来看看关于镜像的一些常用命令。</p><h2>常用的镜像操作有哪些</h2><p>在前面的课程里你应该已经了解了两个基本命令，<code>docker pull</code> 从远端仓库拉取镜像，<code>docker images</code> 列出当前本地已有的镜像。</p><p><code>docker pull</code> 的用法还是比较简单的，和普通的下载非常像，不过我们需要知道镜像的命名规则，这样才能准确地获取到我们想要的容器镜像。</p><p><strong>镜像的完整名字由两个部分组成，名字和标签，中间用 <code>:</code> 连接起来。</strong></p><p>名字表明了应用的身份，比如busybox、Alpine、Nginx、Redis等等。标签（tag）则可以理解成是为了区分不同版本的应用而做的额外标记，任何字符串都可以，比如3.15是纯数字的版本号、jammy是项目代号、1.21-alpine是版本号加操作系统名等等。其中有一个比较特殊的标签叫“latest”，它是默认的标签，如果只提供名字没有附带标签，那么就会使用这个默认的“latest”标签。</p><p>那么现在，你就可以把名字和标签组合起来，使用 <code>docker pull</code> 来拉取一些镜像了：</p><pre><code class=\"language-plain\">docker pull alpine:3.15\ndocker pull ubuntu:jammy\ndocker pull nginx:1.21-alpine\ndocker pull nginx:alpine\ndocker pull redis\n</code></pre><p>有了这些镜像之后，我们再用 <code>docker images</code> 命令来看看它们的具体信息：</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/00/3c6e24139acc6d791c189879a7608c00.png?wh=1818x608\" alt=\"图片\"></p><p>在这个列表里，你可以看到，REPOSITORY列就是镜像的名字，TAG就是这个镜像的标签，那么第三列“IMAGE ID”又是什么意思呢？</p><p>它可以说是镜像唯一的标识，就好像是身份证号一样。比如这里我们可以用“ubuntu:jammy”来表示Ubuntu 22.04镜像，同样也可以用它的ID“d4c2c……”来表示。</p><p>另外，你可能还会注意到，截图里的两个镜像“nginx:1.21-alpine”和“nginx:alpine”的IMAGE ID是一样的，都是“a63aa……”。这其实也很好理解，这就像是人的身份证号码是唯一的，但可以有大名、小名、昵称、绰号，同一个镜像也可以打上不同的标签，这样应用在不同的场合就更容易理解。</p><p>IMAGE ID还有一个好处，因为它是十六进制形式且唯一，Docker特意为它提供了“短路”操作，在本地使用镜像的时候，我们不用像名字那样要完全写出来这一长串数字，通常只需要写出前三位就能够快速定位，在镜像数量比较少的时候用两位甚至一位数字也许就可以了。</p><p>来看另一个镜像操作命令 <code>docker rmi</code> ，它用来删除不再使用的镜像，可以节约磁盘空间，注意命令 <code>rmi</code> ，实际上是“remove image”的简写。</p><p>下面我们就来试验一下，使用名字和IMAGE ID来删除镜像：</p><pre><code class=\"language-plain\">docker rmi redis    \ndocker rmi d4c\n</code></pre><p>这里的第一个 <code>rmi</code> 删除了Redis镜像，因为没有显式写出标签，默认使用的就是“latest”。第二个 <code>rmi</code> 没有给出名字，而是直接使用了IMAGE ID的前三位，也就是“d4c”，Docker就会直接找到这个ID前缀的镜像然后删除。</p><p>Docker里与镜像相关的命令还有很多，不过以上的 <code>docker pull</code>、<code>docker images</code>、<code>docker rmi</code> 就是最常用的三个了，其他的命令我们后续课程会陆续介绍。</p><p><img src=\"https://static001.geekbang.org/resource/image/27/19/27364161a8d3c1f960a91e07b5094419.jpg?wh=1920x963\" alt=\"图片\"></p><h2>常用的容器操作有哪些</h2><p>现在我们已经在本地存放了镜像，就可以使用 <code>docker run</code> 命令把这些静态的应用运行起来，变成动态的容器了。</p><p>基本的格式是“<strong>docker run 设置参数</strong>”，再跟上“<strong>镜像名或ID</strong>”，后面可能还会有附加的“<strong>运行命令</strong>”。</p><p>比如这个命令：</p><pre><code class=\"language-plain\">docker run -h srv alpine hostname\n</code></pre><p>这里的 <code>-h srv</code> 就是容器的运行参数，<code>alpine</code> 是镜像名，它后面的 <code>hostname</code> 表示要在容器里运行的“hostname”这个程序，输出主机名。</p><p><code>docker run</code> 是最复杂的一个容器操作命令，有非常多的额外参数用来调整容器的运行状态，你可以加上 <code>--help</code> 来看它的帮助信息，今天我只说几个最常用的参数。</p><p><code>-it</code> 表示开启一个交互式操作的Shell，这样可以直接进入容器内部，就好像是登录虚拟机一样。（它实际上是“-i”和“-t”两个参数的组合形式）</p><p><code>-d</code> 表示让容器在后台运行，这在我们启动Nginx、Redis等服务器程序的时候非常有用。</p><p><code>--name</code> 可以为容器起一个名字，方便我们查看，不过它不是必须的，如果不用这个参数，Docker会分配一个随机的名字。</p><p>下面我们就来练习一下这三个参数，分别运行Nginx、Redis和Ubuntu：</p><pre><code class=\"language-plain\">docker run -d nginx:alpine            # 后台运行Nginx\ndocker run -d --name red_srv redis    # 后台运行Redis\ndocker run -it --name ubuntu 2e6 sh   # 使用IMAGE ID，登录Ubuntu18.04\n</code></pre><p>因为第三个命令使用的是 <code>-it</code> 而不是 <code>-d</code> ，所以它会进入容器里的Ubuntu系统，我们需要另外开一个终端窗口，使用 <code>docker ps</code> 命令来查看容器的运行状态：</p><p><img src=\"https://static001.geekbang.org/resource/image/18/d9/18a20772328c55e22ae3529f2b7f70d9.png?wh=1920x197\" alt=\"图片\"></p><p>可以看到，每一个容器也会有一个“CONTAINER ID”，它的作用和镜像的“IMAGE ID”是一样的，唯一标识了容器。</p><p>对于正在运行中的容器，我们可以使用 <code>docker exec</code> 命令在里面执行另一个程序，效果和 <code>docker run</code> 很类似，但因为容器已经存在，所以不会创建新的容器。它最常见的用法是使用 <code>-it</code> 参数打开一个Shell，从而进入容器内部，例如：</p><pre><code class=\"language-plain\">docker exec -it red_srv sh\n</code></pre><p>这样我们就“登录”进了Redis容器，可以很方便地查看服务的运行状态或者日志。</p><p>运行中的容器还可以使用 <code>docker stop</code> 命令来强制停止，这里我们仍然可以使用容器名字，不过或许用“CONTAINER ID”的前三位数字会更加方便。</p><pre><code class=\"language-plain\">docker stop ed4 d60 45c\n</code></pre><p>容器被停止后使用 <code>docker ps</code> 命令就看不到了，不过容器并没有被彻底销毁，我们可以使用 <code>docker ps -a</code> 命令查看系统里所有的容器，当然也包括已经停止运行的容器：</p><p><img src=\"https://static001.geekbang.org/resource/image/61/4d/616d93a9998fee3b958ca892yy33d14d.png?wh=1920x204\" alt=\"图片\"></p><p>这些停止运行的容器可以用 <code>docker start</code> 再次启动运行，如果你确定不再需要它们，可以使用 <code>docker rm</code> 命令来彻底删除。</p><p><strong>注意，这个命令与 <code>docker rmi</code> 非常像，区别在于它没有后面的字母“i”，所以只会删除容器，不删除镜像。</strong></p><p>下面我们就来运行 <code>docker rm</code> 命令，使用“CONTAINER ID”的前两位数字来删除这些容器：</p><pre><code class=\"language-plain\">docker rm ed d6 45\n</code></pre><p>执行删除命令之后，再用 <code>docker ps -a</code> 查看列表就会发现这些容器已经彻底消失了。</p><p>你可能会感觉这样的容器管理方式很麻烦，启动后要ps看ID再删除，如果稍微不注意，系统就会遗留非常多的“死”容器，占用系统资源，有没有什么办法能够让Docker自动删除不需要的容器呢？</p><p>办法当然有，就是在执行 <code>docker run</code> 命令的时候加上一个 <code>--rm</code> 参数，这就会告诉Docker不保存容器，只要运行完毕就自动清除，省去了我们手工管理容器的麻烦。</p><p>我们还是用刚才的Nginx、Redis和Ubuntu这三个容器来试验一下，加上 <code>--rm</code> 参数（省略了name参数）：</p><pre><code class=\"language-plain\">docker run -d --rm nginx:alpine \ndocker run -d --rm redis\ndocker run -it --rm 2e6 sh \n</code></pre><p>然后我们用 <code>docker stop</code> 停止容器，再用 <code>docker ps -a</code> ，就会发现不需要我们再手动执行 <code>docker rm</code> ，Docker已经自动删除了这三个容器。</p><p><img src=\"https://static001.geekbang.org/resource/image/c8/85/c8cd008e91aaff2cd91e0392b0079085.jpg?wh=1920x1747\" alt=\"图片\"></p><h2>小结</h2><p>好了，今天我们一起学习了容器化的应用，然后使用Docker实际操作了镜像和容器，运行了被容器化的Alpine、Nginx、Redis等应用。</p><p>镜像是容器的静态形式，它打包了应用程序的所有运行依赖项，方便保存和传输。使用容器技术运行镜像，就形成了动态的容器，由于镜像只读不可修改，所以应用程序的运行环境总是一致的。</p><p>而容器化的应用就是指以镜像的形式打包应用程序，然后在容器环境里从镜像启动容器。</p><p>由于Docker的命令比较多，而且每个命令还有许多参数，一节课里很难把它们都详细说清楚，希望你课下参考Docker自带的帮助或者官网文档（<a href=\"https://docs.docker.com/reference/\">https://docs.docker.com/reference/</a>），再多加实操练习，相信你一定能够成为Docker高手。</p><p>我这里就对今天的镜像操作和容器操作做个小结：</p><ol>\n<li>常用的镜像操作有 <code>docker pull</code>、<code>docker images</code>、<code>docker rmi</code>，分别是拉取镜像、查看镜像和删除镜像。</li>\n<li>用来启动容器的 <code>docker run</code> 是最常用的命令，它有很多参数用来调整容器的运行状态，对于后台服务来说应该使用 <code>-d</code>。</li>\n<li><code>docker exec</code> 命令可以在容器内部执行任意程序，对于调试排错特别有用。</li>\n<li>其他常用的容器操作还有 <code>docker ps</code>、<code>docker stop</code>、<code>docker rm</code>，用来查看容器、停止容器和删除容器。</li>\n</ol><h2>课下作业</h2><p>最后是课下作业时间，给你留两个思考题：</p><ol>\n<li>说一说你对容器镜像的理解，它与rpm、deb安装包有哪些不同和优缺点。</li>\n<li>你觉得 <code>docker run</code> 和 <code>docker exec</code> 的区别在哪里，应该怎么使用它们？</li>\n</ol><p>欢迎在留言区参与讨论，据说打字发言能把自己学到的新知识再加工一遍，可以显著提升理解哦。</p><p>我们下节课再见。<br>\n<img src=\"https://static001.geekbang.org/resource/image/74/f9/7405faa28109b810cace4975eb3a4ef9.jpg?wh=1920x2481\" alt=\"\"></p>","neighbors":{"left":{"article_title":"02｜被隔离的进程：一起来看看容器的本质","id":528640},"right":{"article_title":"04｜创建容器镜像：如何编写正确、高效的Dockerfile","id":528660}},"comments":[{"had_liked":false,"id":349736,"user_name":"星垂平野阔","can_delete":false,"product_type":"c1","uid":3010581,"ip_address":"","ucode":"036EC20979D406","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/WrANpwBMr6DsGAE207QVs0YgfthMXy3MuEKJxR8icYibpGDCI1YX4DcpDq1EsTvlP8ffK1ibJDvmkX9LUU4yE8X0w/132","comment_is_top":false,"comment_ctime":1656295274,"is_pvip":false,"replies":[{"id":127271,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656300036,"ip_address":"","comment_id":349736,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"作业1：\n容器镜像比起这些安装包的差别就在于通用，不同linux版本下的安装包还不同。\n作业2:\nrun是针对容器本身启动，而exec是进入了容器内部去跑命令，相当于进去操作系统跑应用。","like_count":28,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577697,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656300036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350906,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1049994,"ip_address":"","ucode":"C0859057592720","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/8a/e7c5a7e2.jpg","comment_is_top":false,"comment_ctime":1657332718,"is_pvip":false,"replies":[{"id":127660,"content":"save、load、cp等命令后面会讲，docker命令太多了，全讲不现实，得尽快进入Kubernetes。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657353649,"ip_address":"","comment_id":350906,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"还有一些命令docker  save,docker  load,docker stats,docker cp也很有用","like_count":10,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579326,"discussion_content":"save、load、cp等命令后面会讲，docker命令太多了，全讲不现实，得尽快进入Kubernetes。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657353649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349768,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1656318075,"is_pvip":false,"replies":[{"id":127315,"content":"会部署WordPress应用，但要是真实场景就不太好找了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656323329,"ip_address":"","comment_id":349768,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师后面的课程是会用k8s带领我们模拟真实场景，部署应用吗？\n\n「纸上得来终觉浅」。","like_count":8,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577766,"discussion_content":"会部署WordPress应用，但要是真实场景就不太好找了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656323329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349732,"user_name":"拾掇拾掇","can_delete":false,"product_type":"c1","uid":1051873,"ip_address":"","ucode":"D775F374C2A1D3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","comment_is_top":false,"comment_ctime":1656292754,"is_pvip":false,"replies":[{"id":127279,"content":"是的。nginx:alpine始终是最新版本的Nginx，现在是1.23了，我当时是一样的。\n\n你可以试试nginx:alpine和nginx:1.23-alpine 。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656300354,"ip_address":"","comment_id":349732,"utype":1}],"discussion_count":3,"race_medal":1,"score":2,"product_id":100114501,"comment_content":"我实操了下，nginx:alpine 和 nginx:1.21-alpine image_id是不一样的，我猜是被更新了导致image_id不一样了，因为created也不一样","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577706,"discussion_content":"是的。nginx:alpine始终是最新版本的Nginx，现在是1.23了，我当时是一样的。\n\n你可以试试nginx:alpine和nginx:1.23-alpine 。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656300354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1051873,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","nickname":"拾掇拾掇","note":"","ucode":"D775F374C2A1D3","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577679,"discussion_content":"打卡一下","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1656294811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1152145,"avatar":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","nickname":"怀草诗","note":"","ucode":"78F8B9B4628F15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579860,"discussion_content":"刚想问这个问题，实验了下nginx:alpine和nginx:1.23-alpine，ID是一样的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657723453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349725,"user_name":"Bill","can_delete":false,"product_type":"c1","uid":2904248,"ip_address":"","ucode":"10B70368940264","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJk3PElN2J96DtyWuIg6xPSs3zRFsIMibOvIn5kuRkESORsRIkDJMUekymI2wiaYiaP0UzibXWEl0aLYw/132","comment_is_top":false,"comment_ctime":1656288672,"is_pvip":true,"replies":[{"id":127278,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656300294,"ip_address":"","comment_id":349725,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1.容器镜像通过分层打包，安装所有依赖包，并可以在主机上共享使用，减少存储空间需求，它与 rpm、deb 安装包作为某一个功能的所有依赖包安装，聚焦某个命令的上下文，容器是整个应用的打包。\n2.docker run利用镜像运行容器，拥有丰富的启动参数，如挂载volume，端口映射等。是容器运行启动的基础。docker exec启动session，在一个已运行的容器中执行命令，仅当PID 1进程存在时运行，容器重启后，session将失效。","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577704,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656300294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577754,"discussion_content":"同学，这里的“减少存储空间需求”怎么理解？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656320292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577767,"discussion_content":"后面到镜像时会讲到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656323400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":577754,"ip_address":"","group_id":0},"score":577767,"extra":""},{"author":{"id":3631780,"avatar":"","nickname":"Geek_lucky","note":"","ucode":"0950E7F9E7CBD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620886,"discussion_content":"相同数据层只保留一份，其它要用时直接引用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686643840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":577754,"ip_address":"广东","group_id":0},"score":620886,"extra":""}]}]},{"had_liked":false,"id":349735,"user_name":"忧天小鸡","can_delete":false,"product_type":"c1","uid":1073947,"ip_address":"","ucode":"A1412BDC108FD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/1b/83ac7733.jpg","comment_is_top":false,"comment_ctime":1656294499,"is_pvip":false,"replies":[{"id":127270,"content":"great，努力学习进步吧。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656300023,"ip_address":"","comment_id":349735,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"苦于没有docker入门，耗费大量时间，这教程真是太creat了。\n大佬的课我全入了，对你的讲述感觉十分易懂，不需要绕弯理解，nice的。\n等我cpp入门，去试试你们公司","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577696,"discussion_content":"great，努力学习进步吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656300023,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349770,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1656319514,"is_pvip":false,"replies":[{"id":127312,"content":"\n1. 用rmi删除镜像，不用image id，而是用名字加标签，当其他的名字加标签的引用都没有的时候就可以直接删除了。\n\n2.这个删除镜像没有什么最佳实践，这个其实是docker防止误删除的一个保险。\n\n3.简单来说，docker run是用命令启动一个容器，而docker exec是在已有容器里执行命令","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656323254,"ip_address":"","comment_id":349770,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1. 课外贴士的第四条，有同学问了，怎么删除，老师的回答我没太明白，最佳实践是如何操作呢？\n\n2. 想听听老师的回答：docker run 和 docker exec 的区别在哪里？","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577763,"discussion_content":"\n1. 用rmi删除镜像，不用image id，而是用名字加标签，当其他的名字加标签的引用都没有的时候就可以直接删除了。\n\n2.这个删除镜像没有什么最佳实践，这个其实是docker防止误删除的一个保险。\n\n3.简单来说，docker run是用命令启动一个容器，而docker exec是在已有容器里执行命令","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1656323254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349719,"user_name":"Amosヾ","can_delete":false,"product_type":"c1","uid":1567014,"ip_address":"","ucode":"833F6FCB4042AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e9/26/472e16e4.jpg","comment_is_top":false,"comment_ctime":1656261270,"is_pvip":true,"replies":[{"id":127277,"content":"把多余的tag依次删除，最后就可以直接删除镜像了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656300276,"ip_address":"","comment_id":349719,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师，课外贴士中的第4条如何删除呢？有时候强制删除也没用","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577703,"discussion_content":"把多余的tag依次删除，最后就可以直接删除镜像了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656300276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1051873,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg","nickname":"拾掇拾掇","note":"","ucode":"D775F374C2A1D3","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577678,"discussion_content":"应该是利用标签吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656294801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354611,"user_name":"小伙儿","can_delete":false,"product_type":"c1","uid":2161558,"ip_address":"北京","ucode":"470DEA71CDD4F0","user_header":"https://static001.geekbang.org/account/avatar/00/20/fb/96/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1660612186,"is_pvip":false,"replies":[{"id":128963,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660614028,"ip_address":"北京","comment_id":354611,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"docker镜像和rpm包的区别\n\n镜像在打包推送到仓库后不管在那个操作系统中都能运行，而rpm包不行\ndocker镜像中包含了完整的应用依赖和系统环境，而rpm包则没有\n镜像比较能节约磁盘空间，如果镜像的部分层已经在本地中有了，就可以直接复用，rpm包不行\n\n\ndocker的run和exec的区别\n\nrun是从镜像创建运行一个容器的必备命令，exec则是在已经运行的容器中执行另外一个程序，他们的优先级是先run后exec。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584067,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660614028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349807,"user_name":"朱雯","can_delete":false,"product_type":"c1","uid":1035744,"ip_address":"","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1656335811,"is_pvip":false,"replies":[{"id":127332,"content":"镜像都用的是OCI标准，不存在兼容问题，应该从其他方面找原因。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656396910,"ip_address":"","comment_id":349807,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师好，想问一个问题，那就是k8s的container和docker容器有什么区别吗，我使用dockerfile打包一个镜像，在docker环境中是可以打包成功，但是放到使用k8s的jenkins流水线上，就无法打包成功，云平台相关工程师告诉我可能是k8s和docker的不兼容导致的，想请问一下这个问题","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577864,"discussion_content":"镜像都用的是OCI标准，不存在兼容问题，应该从其他方面找原因。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656396910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352246,"user_name":"YueShi","can_delete":false,"product_type":"c1","uid":1625530,"ip_address":"","ucode":"8F7AFAE4641A7D","user_header":"https://static001.geekbang.org/account/avatar/00/18/cd/ba/3a348f2d.jpg","comment_is_top":false,"comment_ctime":1658478632,"is_pvip":true,"replies":[{"id":128143,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658486440,"ip_address":"","comment_id":352246,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"之前一直以为IMAGE ID是随机的，又学到了，原来是跟镜像文件相关的，特意去看了一下，不同的机器上的同一个image的同一个tag，IMAGE ID确实是一样的","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581081,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658486440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374572,"user_name":"Jarvis Chan","can_delete":false,"product_type":"c1","uid":2917923,"ip_address":"陕西","ucode":"96FFA554B95410","user_header":"https://static001.geekbang.org/account/avatar/00/2c/86/23/fe95fdf7.jpg","comment_is_top":false,"comment_ctime":1684200003,"is_pvip":false,"replies":[{"id":136735,"content":"many thanks","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1684289284,"ip_address":"北京","comment_id":374572,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"chrono真的太牛了，真的是小白都能快速上手，沉淀多年才有这么深入浅出的能力","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618491,"discussion_content":"many thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684289285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374529,"user_name":"小马哥","can_delete":false,"product_type":"c1","uid":1358045,"ip_address":"中国台湾","ucode":"B2C0FF38F8C9BC","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/dd/37726c34.jpg","comment_is_top":false,"comment_ctime":1684158202,"is_pvip":false,"replies":[{"id":136725,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1684204107,"ip_address":"上海","comment_id":374529,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"问题1: 说一说你对容器镜像的理解，它与 rpm、deb 安装包有哪些不同和优缺点。\n主要在可移植性和隔离性上不同: 容器镜像依赖于容器环境, 一次打包处处运行; 而rpm,deb等安装包依赖与特定的操作系统环境.\n\n优缺点对比: 可移植性与隔离性强的容器技术, 在性能上肯定不如直接安装在本地的应用包, 是优点也是缺点.看解决的问题场景是什么.\n\n如果要解决的问题是移植性, 打包部署的方便, 当然选择容器技术. ","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":618353,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1684204107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366424,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"四川","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1673767584,"is_pvip":false,"replies":[{"id":133520,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1673826567,"ip_address":"澳大利亚","comment_id":366424,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"补充一下：\n一次停止所有容器：docker stop `docker ps -a -q`\n一次删除所有容器：docker rm    `docker ps -a -q`","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599807,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673826568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"澳大利亚","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361950,"user_name":"ReCharge","can_delete":false,"product_type":"c1","uid":1712470,"ip_address":"北京","ucode":"07DACA0F8BA65D","user_header":"https://static001.geekbang.org/account/avatar/00/1a/21/56/91669d26.jpg","comment_is_top":false,"comment_ctime":1667999714,"is_pvip":false,"replies":[{"id":131669,"content":"在结束语里写了一点心得，简单来说就是多记笔记多练习，勤思考，不过说起来容易做起来就难了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1668038153,"ip_address":"北京","comment_id":361950,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"买了老师很多的专栏了，每次都受益匪浅，老师能分享下学习新知识的方法么？如何能够做到这么深入浅出的。。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593221,"discussion_content":"在结束语里写了一点心得，简单来说就是多记笔记多练习，勤思考，不过说起来容易做起来就难了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668038153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351364,"user_name":"怀草诗","can_delete":false,"product_type":"c1","uid":1152145,"ip_address":"","ucode":"78F8B9B4628F15","user_header":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","comment_is_top":false,"comment_ctime":1657726015,"is_pvip":false,"replies":[{"id":127811,"content":"执行的是“sh”，退出shell自然就结束运行了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657764215,"ip_address":"","comment_id":351364,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"为什么我刚执行docker run -it --name ubuntu ad0 sh  ，用docker ps -a 查到他的状态就是Exited？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579901,"discussion_content":"执行的是“sh”，退出shell自然就结束运行了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657764215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350785,"user_name":"自由","can_delete":false,"product_type":"c1","uid":2576960,"ip_address":"","ucode":"4E3B53D29D86CA","user_header":"https://static001.geekbang.org/account/avatar/00/27/52/40/db9b0eb2.jpg","comment_is_top":false,"comment_ctime":1657191724,"is_pvip":false,"replies":[{"id":127633,"content":"是的，这是因为容器引用了镜像，有引用就不能直接删除镜像。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657248650,"ip_address":"","comment_id":350785,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"docker 镜像运行以后，如果想要删除镜像，需要通过 docker rm [xxx containerId]（可以通过 docker ps -a 查看 containerId）删除容器，才能通过 docker rmi [xxx imageId] 删除镜像。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579205,"discussion_content":"是的，这是因为容器引用了镜像，有引用就不能直接删除镜像。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657248650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350031,"user_name":"逗逼师父","can_delete":false,"product_type":"c1","uid":1017863,"ip_address":"","ucode":"ECC2D82F83CBE6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/88/07/7804f4cc.jpg","comment_is_top":false,"comment_ctime":1656513079,"is_pvip":false,"replies":[{"id":127378,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656546091,"ip_address":"","comment_id":350031,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"1. 容器镜像就是预先配置好的一个带有操作系统的环境；rpm, deb包与当前操作系统是强依赖关系，还会依赖于其他应用等，而容器镜像只要在装有docker的机器上pull下来就能用了，运行起来就是一套独立的环境。\n2. run是用指定镜像创建一个新的容器并运行；exec是在已经运行的容器中执行命令。","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578148,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656546091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349773,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1656319907,"is_pvip":false,"replies":[{"id":127314,"content":"是这个镜像的创建时间，说是镜像仓库最近的版本更新情况勉强也可以。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656323299,"ip_address":"","comment_id":349773,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"老师，执行docker images 命令，展示栏的 CREATED 代表的是这个 镜像仓库最近的版本更新情况吗？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577765,"discussion_content":"是这个镜像的创建时间，说是镜像仓库最近的版本更新情况勉强也可以。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1656323299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386375,"user_name":"Geek_6e3c78","can_delete":false,"product_type":"c1","uid":3810455,"ip_address":"山东","ucode":"08DBA32987BB8F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/gdrRWp2Q9wJ4P2NcLxLicuvhHKwFSk7QkeBOEAo0hJtPo9Y94hrRm631o7mtBaBclBZvZko7oHXecURpWuBJBQA/132","comment_is_top":false,"comment_ctime":1704709364,"is_pvip":false,"replies":[{"id":140854,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1704850011,"ip_address":"上海","comment_id":386375,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"1、rpm包这些依赖操作系统安装其他基础软件，比如gc++等，而镜像只对操作系统架构有依赖；\n2、docker run 是生成一个容器并执行命令，docker exec 是基于一个已运行的容器执行命令；docker exec我常用于进入容器终端","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635446,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704850011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377452,"user_name":"shadow","can_delete":false,"product_type":"c1","uid":1144335,"ip_address":"广东","ucode":"79233241B31C10","user_header":"https://static001.geekbang.org/account/avatar/00/11/76/0f/acc7342c.jpg","comment_is_top":false,"comment_ctime":1688526314,"is_pvip":false,"replies":[{"id":137555,"content":"后面有的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1688562402,"ip_address":"北京","comment_id":377452,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"老师，有视频课程么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622707,"discussion_content":"后面有的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688562403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375720,"user_name":"原则","can_delete":false,"product_type":"c1","uid":3574650,"ip_address":"广东","ucode":"12E98F3728CC53","user_header":"https://static001.geekbang.org/account/avatar/00/36/8b/7a/ec36ff82.jpg","comment_is_top":false,"comment_ctime":1685920752,"is_pvip":false,"replies":[{"id":137125,"content":"打包的是内核之外的其他依赖环境，比如操作系统、运行库。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1685926105,"ip_address":"北京","comment_id":375720,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"总是听说 docker 会把应用的依赖和环境都打包好，然后又听说 docker 是基于宿主机的内核的，和虚拟机不同。\n这里就比较懵了，docker 打包的到底是什么东西呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620181,"discussion_content":"打包的是内核之外的其他依赖环境，比如操作系统、运行库。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685926105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375719,"user_name":"原则","can_delete":false,"product_type":"c1","uid":3574650,"ip_address":"广东","ucode":"12E98F3728CC53","user_header":"https://static001.geekbang.org/account/avatar/00/36/8b/7a/ec36ff82.jpg","comment_is_top":false,"comment_ctime":1685920144,"is_pvip":false,"replies":[{"id":137124,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1685926052,"ip_address":"北京","comment_id":375719,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"1. 说一说你对容器镜像的理解，它与 rpm、deb 安装包有哪些不同和优缺点。\n容器镜像具有一个一次打包，到处运行的特点。而其他的安装包在不同的操作系统上是不同的。\n2. 你觉得 docker run 和 docker exec 的区别在哪里，应该怎么使用它们？\ndocker run 是针对镜像而言，基于一个镜像启动一个容器；\ndocker exec 是针对已经启动的容器而言，执行命令和操作。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620180,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1685926052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369627,"user_name":"蔡晓慧","can_delete":false,"product_type":"c1","uid":1588301,"ip_address":"北京","ucode":"8D177D2B37BD6D","user_header":"https://static001.geekbang.org/account/avatar/00/18/3c/4d/3dec4bfe.jpg","comment_is_top":false,"comment_ctime":1677737954,"is_pvip":false,"replies":[{"id":134694,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1677746163,"ip_address":"上海","comment_id":369627,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"1.容器镜像更像是一个完整的操作系统+环境、rpm、deb是软件安装包；\n2.docker run是运行一个容器，docker exec是进入容器；","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607292,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677746163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369039,"user_name":"V.","can_delete":false,"product_type":"c1","uid":3542181,"ip_address":"辽宁","ucode":"7D553FB708D73E","user_header":"https://static001.geekbang.org/account/avatar/00/36/0c/a5/344c1ea2.jpg","comment_is_top":false,"comment_ctime":1677037254,"is_pvip":false,"replies":[{"id":134383,"content":"2e6是Ubuntu 1804的image id，需要看一下自己的docker环境里的image id是什么，有可能不是这个数字。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1677047260,"ip_address":"上海","comment_id":369039,"utype":1}],"discussion_count":3,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"&quot;docker run -it --name ubuntu 2e6 sh   # 使用IMAGE ID，登录Ubuntu18.04&quot;\n这个是不是错了呀 会提示找不到2e6 这个镜像，我改成“--name 2e6 ubuntu ” 就可以启动了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606234,"discussion_content":"2e6是Ubuntu 1804的image id，需要看一下自己的docker环境里的image id是什么，有可能不是这个数字。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1677047260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":3542181,"avatar":"https://static001.geekbang.org/account/avatar/00/36/0c/a5/344c1ea2.jpg","nickname":"V.","note":"","ucode":"7D553FB708D73E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":606241,"discussion_content":"谢谢罗老师！回复的很快 ，是我忘了可以省略id。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677050828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":606234,"ip_address":"辽宁","group_id":0},"score":606241,"extra":""}]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606411,"discussion_content":"启动镜像用镜像的image id或者镜像名字都可以启动\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677132447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366534,"user_name":"一久","can_delete":false,"product_type":"c1","uid":3297421,"ip_address":"重庆","ucode":"287F9C36D154CD","user_header":"https://static001.geekbang.org/account/avatar/00/32/50/8d/ded8482f.jpg","comment_is_top":false,"comment_ctime":1673896088,"is_pvip":false,"replies":[{"id":133568,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1673947742,"ip_address":"北京","comment_id":366534,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"问题一：\n容器镜像可以是一个打包好的应用系统文件，里面包含了基础镜像和服务依赖，可以跨同架构的多个发行版Linux系统上运行；rpm和deb包是Linux某个功能的安装包文件，在支持相应包管理的系统下才可以安装使用\n问题二：\ndocker run是运行一个容器；docker exec是进入已运行的容器","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600027,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673947743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365700,"user_name":"Mr.J","can_delete":false,"product_type":"c1","uid":1267172,"ip_address":"北京","ucode":"372D8C614F6C3D","user_header":"https://static001.geekbang.org/account/avatar/00/13/55/e4/7061abd5.jpg","comment_is_top":false,"comment_ctime":1672907858,"is_pvip":false,"replies":[{"id":133204,"content":"镜像是一个静态文件，而容器是从镜像运行起来的进程，进程就有运行和停止的状态。\n\nexec只能进入运行的容器。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672967030,"ip_address":"北京","comment_id":365700,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"镜像运行起来是容器？那容器stop掉之后又是什么？还是有点模糊\n另外exec是进入已有的容器，无论容器是运行中还是stop的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598622,"discussion_content":"镜像是一个静态文件，而容器是从镜像运行起来的进程，进程就有运行和停止的状态。\n\nexec只能进入运行的容器。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672967030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365608,"user_name":"一行","can_delete":false,"product_type":"c1","uid":1305810,"ip_address":"上海","ucode":"849B58C31455DC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/prLO6VIcvsXMibOichyNgeMmgDlh8nS7q4F9a0PCkrL0OypFj0dQicDMRH0El7sdOF6srhJyKsfRNQJe10IJwHhoQ/132","comment_is_top":false,"comment_ctime":1672821620,"is_pvip":false,"replies":[{"id":133170,"content":"第一个说得很好，第二个理解的不太正确，run和exec不是执行权限的区别，可以参考其他同学的回答。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672823188,"ip_address":"上海","comment_id":365608,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"思考1：说一说你对容器镜像的理解，它与 rpm、deb 安装包有哪些不同和优缺点。\n容器的技术基础是 namespace、cgroup、chroot，实现了对应用依赖、运行环境的打包，并且可以对应用运行所需的资源进行限制。 可以快速运行在任何有容器的环境中。 一处打包，处处运行。\nrpm、deb是linux支持的一种应用打包方式，只能在特定的发行版本中运行，对应用运行时的依赖处理比较麻烦。\n\n思考2：你觉得 docker run 和 docker exec 的区别在哪里，应该怎么使用它们？\n类似 linux系统中的 su 与 sudo 命令。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598440,"discussion_content":"第一个说得很好，第二个理解的不太正确，run和exec不是执行权限的区别，可以参考其他同学的回答。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672823188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363930,"user_name":"蛮野","can_delete":false,"product_type":"c1","uid":1010459,"ip_address":"上海","ucode":"4475AF1598FBFD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/1b/4b397b80.jpg","comment_is_top":false,"comment_ctime":1670372820,"is_pvip":false,"replies":[{"id":132288,"content":"\n1. 容器是隔离的运行环境，所以不会与外界系统冲突，所以我们可以在容器里自由地运行任意的Linux版本，比如在Ubuntu里跑Alpine。\n\n2.镜像是分层的，重复的数据只会存一份，后面会讲到。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1670381232,"ip_address":"上海","comment_id":363930,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"容器底层原理使用三件套，容器镜像也能附带其他操作系统或其他版本的库，在容器实际执行时候，是否会与源系统库打架的问题？镜像中老是重复保存相同的操作系统库，是不是也是一种浪费？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":595800,"discussion_content":"\n1. 容器是隔离的运行环境，所以不会与外界系统冲突，所以我们可以在容器里自由地运行任意的Linux版本，比如在Ubuntu里跑Alpine。\n\n2.镜像是分层的，重复的数据只会存一份，后面会讲到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670381233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361269,"user_name":"snake","can_delete":false,"product_type":"c1","uid":3183263,"ip_address":"上海","ucode":"0C7398D3A68119","user_header":"https://static001.geekbang.org/account/avatar/00/30/92/9f/d5255fe8.jpg","comment_is_top":false,"comment_ctime":1667377217,"is_pvip":false,"replies":[{"id":131385,"content":"基本正确，然后再多加一些理解就更好了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1667384254,"ip_address":"上海","comment_id":361269,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"docker run 和exec区别主要是前者用于创建新容器并启动，后者在已有容器的基础上执行，这样理解对吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592398,"discussion_content":"基本正确，然后再多加一些理解就更好了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667384254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361039,"user_name":"第一装甲集群司令克莱斯特","can_delete":false,"product_type":"c1","uid":1265707,"ip_address":"上海","ucode":"4E8FBB23AD860B","user_header":"https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg","comment_is_top":false,"comment_ctime":1667139001,"is_pvip":false,"replies":[{"id":131331,"content":"nice","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1667186917,"ip_address":"上海","comment_id":361039,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"Image container=new Image();","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592181,"discussion_content":"nice","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667186917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358183,"user_name":"乘风","can_delete":false,"product_type":"c1","uid":2112229,"ip_address":"北京","ucode":"D25976CDD1D39B","user_header":"https://static001.geekbang.org/account/avatar/00/20/3a/e5/1a1b08ad.jpg","comment_is_top":false,"comment_ctime":1664007208,"is_pvip":true,"replies":[{"id":130360,"content":"run Ubuntu是启动了一个shell命令，命令结束后也就意味着容器结束运行，要看启动容器是否是一个长时间运行的命令，比如Nginx、MySQL这样就是一直运行，容器也就不会停止。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1664092510,"ip_address":"北京","comment_id":358183,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"docker run ubuntu后，docker ps 容器停止了。\ndocker start 容器id后，docker ps 容器还是停止了。\ndocker run -it ubuntu bash后，进入容器，exit退出，docker ps容器停止了。\ndocker start 容器id后，docker ps 容器正常运行。\n请问老师，这是什么原因呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588769,"discussion_content":"run Ubuntu是启动了一个shell命令，命令结束后也就意味着容器结束运行，要看启动容器是否是一个长时间运行的命令，比如Nginx、MySQL这样就是一直运行，容器也就不会停止。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664092510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357254,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1663120759,"is_pvip":false,"replies":[{"id":130013,"content":"第4讲里是没有说清楚吗？run是镜像的构建过程，cmd是镜像启动容器的命令。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1663124273,"ip_address":"北京","comment_id":357254,"utype":1}],"discussion_count":2,"race_medal":2,"score":5,"product_id":100114501,"comment_content":"关于 RUN 和 CMD 的区别，这里说的不是特别详细，我在第08节的提问老师也没有回答，我查了下相关资料，尝试理解下：\n\n1. RUN 和 CMD 都是 Shell 编程，但是作用的生命周期和目的不同。\n2. RUN 是在构建镜像时生效，会在当前镜像 Layer 的基础上生成一个新 Layer，并将构建结果提交给下一步的 Layer；而 CMD 是在容器启动时生效，用于指定容器的运行命令，不会生成额外的 Layer。\n3. 以 Java 应用为例：在构建镜像时，会指定 JDK 基础镜像，并通过 RUN 命令创建容器目录、拉取依赖、执行 Maven 构建；在容器启动时通过 CMD 执行 java -jar 启动应用。\n\n参考官方文档：https:&#47;&#47;docs.docker.com&#47;engine&#47;reference&#47;builder&#47;","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587516,"discussion_content":"第4讲里是没有说清楚吗？run是镜像的构建过程，cmd是镜像启动容器的命令。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663124273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1182372,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","nickname":"张申傲","note":"","ucode":"22D46BC529BA8A","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":587525,"discussion_content":"好吧 是我看得不够仔细","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663129876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":587516,"ip_address":"北京","group_id":0},"score":587525,"extra":""}]}]},{"had_liked":false,"id":356843,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1662631898,"is_pvip":false,"replies":[{"id":129870,"content":"基本正确，不过还有一些需要纠正。\n\n1. 镜像屏蔽了操作系统，但硬件体系的差异还是有的，32&#47;64位、arm&#47;x86必须用不同的镜像。\n\n2.run和exec和容器引擎没有关系，run是从镜像启动一个新容器，而exec是已经存在了运行的容器，再进入这个容器环境里执行程序。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662644901,"ip_address":"北京","comment_id":356843,"utype":1}],"discussion_count":2,"race_medal":2,"score":5,"product_id":100114501,"comment_content":"做作业：\n1. rpm、deb 这些安装包还需要区分不同的操作系统平台和版本，如 Linux32位&#47;64位，而容器镜像屏蔽了底层平台的差异，直接面向应用程序。\n2. docker run 是在容器引擎层面执行操作；而 docker exec 是进入到具体某个容器内部进行操作。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586988,"discussion_content":"基本正确，不过还有一些需要纠正。\n\n1. 镜像屏蔽了操作系统，但硬件体系的差异还是有的，32/64位、arm/x86必须用不同的镜像。\n\n2.run和exec和容器引擎没有关系，run是从镜像启动一个新容器，而exec是已经存在了运行的容器，再进入这个容器环境里执行程序。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1662644902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1182372,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","nickname":"张申傲","note":"","ucode":"22D46BC529BA8A","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":586989,"discussion_content":"理解了 谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662645642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":586988,"ip_address":"北京","group_id":0},"score":586989,"extra":""}]}]},{"had_liked":false,"id":356465,"user_name":"阿卡","can_delete":false,"product_type":"c1","uid":2829494,"ip_address":"北京","ucode":"04F3C90DF51A5D","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2c/b6/61b1d6be.jpg","comment_is_top":false,"comment_ctime":1662347125,"is_pvip":false,"replies":[{"id":129775,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1662351619,"ip_address":"北京","comment_id":356465,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"1. 镜像是容器的抽象定义，含有容器运行所需文件及参数描述，有版本概念且镜像本身并不能作为应用使用，类似rpm、deb源中的安装包及其依赖定义。\n容器是运行的镜像实例，是可使用的应用，一个镜像可以创建多个实例，类似rpm、deb安装运行的软件。\n2. docker run 作用对象镜像，用于定制容器启动。\ndocker exec 作用对象是容器，用于在容器内部执行特定指令。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586581,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662351619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356090,"user_name":"Chengfei.Xu","can_delete":false,"product_type":"c1","uid":2440848,"ip_address":"北京","ucode":"00A895B0B4CA3E","user_header":"https://static001.geekbang.org/account/avatar/00/25/3e/90/c86ec4ca.jpg","comment_is_top":false,"comment_ctime":1661958571,"is_pvip":false,"replies":[{"id":129627,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1661997353,"ip_address":"北京","comment_id":356090,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"1、说一说你对容器镜像的理解，它与 rpm、deb 安装包有哪些不同和优缺点。\n答：主要不同或者说是优点在于，容器镜像能够以“操作系统”以上的层次把当前运行的环境、依赖等打包，只要是同一架构+docker，就能完美的运行，层次更广。而rpm安装包等只是专注于某个软件、功能依赖等，比较单一与强相关。\n而且镜像的文件联合系统更能节省存储空间，总之就是更加方便，效率至上！\n\n2、你觉得 docker run 和 docker exec 的区别在哪里，应该怎么使用它们？\n答：run相当于start+exec，实际生产中用的比较多的，run主要常见于各类启动脚本中或调试镜像时使用，exec用于进入正在运行的容器后排错等场景。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586127,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661997353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354294,"user_name":"Z.","can_delete":false,"product_type":"c1","uid":1568589,"ip_address":"北京","ucode":"9C9C97C470D761","user_header":"https://static001.geekbang.org/account/avatar/00/17/ef/4d/83a56dad.jpg","comment_is_top":false,"comment_ctime":1660268179,"is_pvip":false,"replies":[{"id":128871,"content":"用exit退出shell","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660279660,"ip_address":"北京","comment_id":354294,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"老师 我想问一下通过exec进入容器之后我们如何回到上一级呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583665,"discussion_content":"用exit退出shell","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660279660,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354114,"user_name":"朱孟","can_delete":false,"product_type":"c1","uid":2272712,"ip_address":"北京","ucode":"C7F7020815F90F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoiciablzbKt3PW9BKLYcFwKWVO618UqM7XbAoRKYZPQJRqsnXzP6sL4xiaQOjedsDbXyIz8qyiano1pA/132","comment_is_top":false,"comment_ctime":1660101942,"is_pvip":false,"replies":[{"id":128798,"content":"比如用Dockerfile，build两次，那第二次就会把第一次的tag给“冲”掉了。\n\n其实不用太关心这个问题，有none就直接删除吧。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1660108584,"ip_address":"北京","comment_id":354114,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"老师，什么情况下会出现镜像的name或者tag为&lt;none&gt;呀？，我这遇到了，不知道咋出现的","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583418,"discussion_content":"比如用Dockerfile，build两次，那第二次就会把第一次的tag给“冲”掉了。\n\n其实不用太关心这个问题，有none就直接删除吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660108584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1265707,"avatar":"https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg","nickname":"第一装甲集群司令克莱斯特","note":"","ucode":"4E8FBB23AD860B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592133,"discussion_content":"虚悬镜像？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667138890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351359,"user_name":"怀草诗","can_delete":false,"product_type":"c1","uid":1152145,"ip_address":"","ucode":"78F8B9B4628F15","user_header":"https://static001.geekbang.org/account/avatar/00/11/94/91/6d6ca42f.jpg","comment_is_top":false,"comment_ctime":1657723362,"is_pvip":false,"replies":[{"id":127809,"content":"我写文章的时候是一样的，现在nginx:alpine是1.23，所以就不一样了，它应该和nginx:1.23-alpine一样。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657764097,"ip_address":"","comment_id":351359,"utype":1}],"discussion_count":2,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"“nginx:1.21-alpine”和“nginx:alpine”的 IMAGE ID 是一样的，都是“a63aa……”。这其实也很好理解，这就像是人的身份证号码是唯一的。\n这边不太理解，我系统中pull 的nginx的两个镜像的ID就不一样，还可以用身份证来说明吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579899,"discussion_content":"我写文章的时候是一样的，现在nginx:alpine是1.23，所以就不一样了，它应该和nginx:1.23-alpine一样。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657764097,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"花花大脸猫","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580299,"discussion_content":"其实就是老师那时候操作的时候，latest与指定tag版本对应的镜像是同一个，所以拉下来生成的imageId是一样的，但是后续latest又更新过了，这时候两个版本不一致了，所以就不一样了又","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1658068902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350735,"user_name":"dao","can_delete":false,"product_type":"c1","uid":1087879,"ip_address":"","ucode":"4181FB270462CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","comment_is_top":false,"comment_ctime":1657124627,"is_pvip":false,"replies":[{"id":127605,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657159691,"ip_address":"","comment_id":350735,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"镜像、rpm 和 deb 包都是静态的。容器是基于镜像运行的带有执行环境、资源限制和配置的应用进程。安装 rpm 和 deb 包，与容器运行前需要从 registry 拉取镜像类似，需要从 package repo 下载 rpm &#47; deb 包然后安装、配置。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579057,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657159691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350730,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1657121506,"is_pvip":false,"replies":[{"id":127604,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657159679,"ip_address":"","comment_id":350730,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"学会了docker run --rm 命令哈哈哈","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579056,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657159679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350729,"user_name":"pythonbug","can_delete":false,"product_type":"c1","uid":1487274,"ip_address":"","ucode":"1A70CA92FFF8EB","user_header":"https://wx.qlogo.cn/mmopen/vi_32/wgMMrp1hvSB3E30KqZvMsj3KQdAI3T1uQM77LT7hZ65nVSjPGRg3AbUOyiahnssA6AIT5PAkyHFmlTBzUH9gdyQ/132","comment_is_top":false,"comment_ctime":1657121359,"is_pvip":false,"replies":[{"id":127603,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657159671,"ip_address":"","comment_id":350729,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"1、只要是linux系统，不论什么版本，符合docker要求的就能安装镜像，安装命令都一样。rpm，deb不同linux系统命令不同，所以docker镜像更加方便。\n2、docker run 生成一个全新的容器，docker exec 在一个已经存在并且正在运行的容器上执行命令。差别还是很大的。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579055,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657159672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350653,"user_name":"纳兰容若","can_delete":false,"product_type":"c1","uid":1605876,"ip_address":"","ucode":"2E1EA2CDFDA1A9","user_header":"https://static001.geekbang.org/account/avatar/00/18/80/f4/564209ea.jpg","comment_is_top":false,"comment_ctime":1657074869,"is_pvip":false,"replies":[{"id":127538,"content":"nginx:alpine是最新的Nginx版本，现在应该是1.23了，所以会和nginx:1.21-alpine不一样，我当时是一样的。\n\n现在nginx:alpine应该和nginx:1.23-alpine相同，可以尝试一下。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657077369,"ip_address":"","comment_id":350653,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"老师您好 有个问题请教一下\n我pull下来的“nginx:1.21-alpine”和“nginx:alpine” image id是不一样的 一个是b1c3acb28882 一个是f246e6f9d0b2\n这个image id 也会改变的么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578885,"discussion_content":"nginx:alpine是最新的Nginx版本，现在应该是1.23了，所以会和nginx:1.21-alpine不一样，我当时是一样的。\n\n现在nginx:alpine应该和nginx:1.23-alpine相同，可以尝试一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657077369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350512,"user_name":"giteebravo","can_delete":false,"product_type":"c1","uid":1005290,"ip_address":"","ucode":"C087E8D6B5A98B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/ea/32608c44.jpg","comment_is_top":false,"comment_ctime":1656979542,"is_pvip":false,"replies":[{"id":127497,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656986898,"ip_address":"","comment_id":350512,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"\n容器镜像，一个持久化的应用运行环境；  docker run 可使应用基于镜像启动，而 docker exec 则可在应用启动后与其交互。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578711,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656986898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350478,"user_name":"Kepler","can_delete":false,"product_type":"c1","uid":1214303,"ip_address":"","ucode":"0C9CA3DB8B3CF0","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","comment_is_top":false,"comment_ctime":1656937931,"is_pvip":false,"replies":[{"id":127511,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656994840,"ip_address":"","comment_id":350478,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"容器镜像拉下来了直接跑， rpm拉下来包后还需要安装一堆依赖，前者更方便","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578751,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656994840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349962,"user_name":"IT蜗壳-Tango","can_delete":false,"product_type":"c1","uid":1000612,"ip_address":"","ucode":"92330844C1EF9C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/44/a4/7a45d979.jpg","comment_is_top":false,"comment_ctime":1656473482,"is_pvip":true,"replies":[{"id":127362,"content":"因为第一条命令运行sh后立即结束，容器停止了，所以不能再exec，可以用docker ps -a查看容器的状态。\n\n写笔记的习惯非常好，great。","user_name":"作者回复","user_name_real":"作者","uid":1181974,"ctime":1656482794,"ip_address":"","comment_id":349962,"utype":1}],"discussion_count":1,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"打卡：https:&#47;&#47;xie.infoq.cn&#47;article&#47;9d66e712fd7b8e72b674d9405\n\n我们上面可以通过 -d 来后台运行，然后在通过 exec 来执行某个程序，但是为什么我后台运行 ubuntu 就不可以执行 sh 呢？报错截图在上面笔记的末尾。求解答","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578039,"discussion_content":"因为第一条命令运行sh后立即结束，容器停止了，所以不能再exec，可以用docker ps -a查看容器的状态。\n\n写笔记的习惯非常好，great。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656482794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349869,"user_name":"Juha","can_delete":false,"product_type":"c1","uid":1347609,"ip_address":"","ucode":"5B9301CC960D84","user_header":"https://static001.geekbang.org/account/avatar/00/14/90/19/b3403815.jpg","comment_is_top":false,"comment_ctime":1656395040,"is_pvip":true,"replies":[{"id":127340,"content":"确实很像，chroot是切换进程的文件系统根目录，相当于mnt namespace &#47;。不过我没有在容器具体技术上花时间细研究，不能给出更详细的说明，sorry。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1656404016,"ip_address":"","comment_id":349869,"utype":1}],"discussion_count":3,"race_medal":0,"score":6,"product_id":100114501,"comment_content":"老师好，关于namespace和chroot的区别可以讲一下嘛，感觉mnt namespace就和chroot是一样的呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577888,"discussion_content":"确实很像，chroot是切换进程的文件系统根目录，相当于mnt namespace /。不过我没有在容器具体技术上花时间细研究，不能给出更详细的说明，sorry。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656404016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1347609,"avatar":"https://static001.geekbang.org/account/avatar/00/14/90/19/b3403815.jpg","nickname":"Juha","note":"","ucode":"5B9301CC960D84","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":577923,"discussion_content":"嗯嗯，好的，感谢老师解答","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656416684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":577888,"ip_address":"","group_id":0},"score":577923,"extra":""}]},{"author":{"id":2314854,"avatar":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","nickname":"includestdio.h","note":"","ucode":"5027BACE9319CD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578045,"discussion_content":"mnt ns 只是声明了容器对挂载点的认知，并不提供 mount 功能。如果要让容器进程的文件系统视图发生变化，需要在容器启动前先进行 mount 操作，而这个 mount 是由 chroot 或 pivot_root 实现的","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1656486465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}