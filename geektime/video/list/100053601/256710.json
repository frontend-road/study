{"id":256710,"title":"17 | 消息队列设计和治理最佳实践","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-distributed\">https://gitee.com/geektime-geekbang/geektime-distributed</a></p>","comments":[{"had_liked":false,"id":237198,"user_name":"robincoin","can_delete":false,"product_type":"c3","uid":1053243,"ip_address":"","ucode":"BA89BCEA1D6B9D","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/3b/969eedf2.jpg","comment_is_top":false,"comment_ctime":1595734069,"is_pvip":false,"replies":[{"id":87655,"content":"可以考虑放在消费端，通过消息头标记+Apollo配置中心来做灰度。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1595763855,"ip_address":"","comment_id":237198,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"mq灰度一般是放在发送端处理，发送到不同的topic呢，还是在消费端处理，在消费端根据流量标记进行转发？","like_count":1,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502334,"discussion_content":"可以考虑放在消费端，通过消息头标记+Apollo配置中心来做灰度。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595763855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394474,"user_name":"Allan","can_delete":false,"product_type":"c3","uid":1310388,"ip_address":"内蒙古","ucode":"8DA4DBECC2C45C","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/b4/295338e7.jpg","comment_is_top":false,"comment_ctime":1726906865,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"让老师设计完感觉好简单啊，但是细节怎么开发？这还是一个比较难的问题。","like_count":0},{"had_liked":false,"id":379225,"user_name":"Cindy","can_delete":false,"product_type":"c3","uid":1158570,"ip_address":"山东","ucode":"FE05FD1C16F36B","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/aa/e83eadf0.jpg","comment_is_top":false,"comment_ctime":1691575183,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"老师，请问实际生产环境里面如何是性价比高的分布式系统环境呢？如果不用 k8s","like_count":0},{"had_liked":false,"id":368995,"user_name":"曹操的曹🐈","can_delete":false,"product_type":"c3","uid":1343595,"ip_address":"广东","ucode":"B3FBB479BE98EC","user_header":"https://static001.geekbang.org/account/avatar/00/14/80/6b/4d795196.jpg","comment_is_top":false,"comment_ctime":1676984080,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"coordinator是单点的吗，会不会出现coordinator挂了导致下线consumer无法感知使得数据无法及时消费&#47;新上线consumer挂起","like_count":0,"discussions":[{"author":{"id":1046552,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/18/3e5e7db3.jpg","nickname":"Lorgine","note":"","ucode":"DB64E85327A252","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610476,"discussion_content":"不会，协调器会自动选举，产生一个新的协调器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679574728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340876,"user_name":"lxhxmf","can_delete":false,"product_type":"c3","uid":1098049,"ip_address":"","ucode":"15BC0AADC48869","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wicH4ZZcMl8iaavjPldak0jxkm9tc19sjLiaGKsuicUNibEPbrvluaCIZnBCHLT61LBj6uic4lLibFau6U0v1ZxC6ZAqw/132","comment_is_top":false,"comment_ctime":1649210954,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100053601,"comment_content":"老师，我们这里有个业务系统涉及的业务场景比较多，系统大量使用了RocketMQ技术对系统进行解耦，创建了30来个topic,这样做业务流程确实清晰了许多，业务需求有变化也能快速响应。但带来的问题是要启动大量的消息消费程序去订阅处理这些topic,占用了比较多的内存资源，而且这么多进程不好监控。针对这种应用场景，有没有什么好框架在不改变topic数量的情况下可以减少消息消费程序的数量，或者有没有其它好的建议，非常感谢。","like_count":0}]}