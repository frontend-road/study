{"id":41876,"title":"24 | æ·±å…¥è§£æå£°æ˜å¼APIï¼ˆä¸€ï¼‰ï¼šAPIå¯¹è±¡çš„å¥¥ç§˜","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ç£Šã€‚ä»Šå¤©æˆ‘å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šæ·±å…¥è§£æå£°æ˜å¼APIä¹‹APIå¯¹è±¡çš„å¥¥ç§˜ã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†è®²è§£äº†Kuberneteså£°æ˜å¼APIçš„è®¾è®¡ã€ç‰¹ç‚¹ï¼Œä»¥åŠä½¿ç”¨æ–¹å¼ã€‚</p><p>è€Œåœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°±æ¥ä¸ºä½ è®²è§£ä¸€ä¸‹Kuberneteså£°æ˜å¼APIçš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨è¿™å¥—APIæœºåˆ¶ï¼Œåœ¨Kubernetesé‡Œæ·»åŠ è‡ªå®šä¹‰çš„APIå¯¹è±¡ã€‚</p><p>ä½ å¯èƒ½ä¸€ç›´å°±å¾ˆå¥½å¥‡ï¼šå½“æˆ‘æŠŠä¸€ä¸ªYAMLæ–‡ä»¶æäº¤ç»™Kubernetesä¹‹åï¼Œå®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•åˆ›å»ºå‡ºä¸€ä¸ªAPIå¯¹è±¡çš„å‘¢ï¼Ÿ</p><p>è¿™å¾—ä»å£°æ˜å¼APIçš„è®¾è®¡è°ˆèµ·äº†ã€‚</p><p>åœ¨Kubernetesé¡¹ç›®ä¸­ï¼Œä¸€ä¸ªAPIå¯¹è±¡åœ¨Etcdé‡Œçš„å®Œæ•´èµ„æºè·¯å¾„ï¼Œæ˜¯ç”±ï¼šGroupï¼ˆAPIç»„ï¼‰ã€Versionï¼ˆAPIç‰ˆæœ¬ï¼‰å’ŒResourceï¼ˆAPIèµ„æºç±»å‹ï¼‰ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆçš„ã€‚</p><p>é€šè¿‡è¿™æ ·çš„ç»“æ„ï¼Œæ•´ä¸ªKubernetesé‡Œçš„æ‰€æœ‰APIå¯¹è±¡ï¼Œå®é™…ä¸Šå°±å¯ä»¥ç”¨å¦‚ä¸‹çš„æ ‘å½¢ç»“æ„è¡¨ç¤ºå‡ºæ¥ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/70/da/709700eea03075bed35c25b5b6cdefda.png?wh=1820*783\" alt=\"\"><br>\nåœ¨è¿™å¹…å›¾ä¸­ï¼Œä½ å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°<strong>Kubernetesé‡ŒAPIå¯¹è±¡çš„ç»„ç»‡æ–¹å¼ï¼Œå…¶å®æ˜¯å±‚å±‚é€’è¿›çš„ã€‚</strong></p><p>æ¯”å¦‚ï¼Œç°åœ¨æˆ‘è¦å£°æ˜è¦åˆ›å»ºä¸€ä¸ªCronJobå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘çš„YAMLæ–‡ä»¶çš„å¼€å§‹éƒ¨åˆ†ä¼šè¿™ä¹ˆå†™ï¼š</p><pre><code>apiVersion: batch/v2alpha1\nkind: CronJob\n...\n</code></pre><p>åœ¨è¿™ä¸ªYAMLæ–‡ä»¶ä¸­ï¼Œâ€œCronJobâ€å°±æ˜¯è¿™ä¸ªAPIå¯¹è±¡çš„èµ„æºç±»å‹ï¼ˆResourceï¼‰ï¼Œâ€œbatchâ€å°±æ˜¯å®ƒçš„ç»„ï¼ˆGroupï¼‰ï¼Œv2alpha1å°±æ˜¯å®ƒçš„ç‰ˆæœ¬ï¼ˆVersionï¼‰ã€‚</p><!-- [[[read_end]]] --><p>å½“æˆ‘ä»¬æäº¤äº†è¿™ä¸ªYAMLæ–‡ä»¶ä¹‹åï¼ŒKuberneteså°±ä¼šæŠŠè¿™ä¸ªYAMLæ–‡ä»¶é‡Œæè¿°çš„å†…å®¹ï¼Œè½¬æ¢æˆKubernetesé‡Œçš„ä¸€ä¸ªCronJobå¯¹è±¡ã€‚</p><p>é‚£ä¹ˆï¼Œ<span class=\"orange\">Kubernetesæ˜¯å¦‚ä½•å¯¹Resourceã€Groupå’ŒVersionè¿›è¡Œè§£æï¼Œä»è€Œåœ¨Kubernetesé¡¹ç›®é‡Œæ‰¾åˆ°CronJobå¯¹è±¡çš„å®šä¹‰å‘¢ï¼Ÿ</span></p><p><strong>é¦–å…ˆï¼ŒKubernetesä¼šåŒ¹é…APIå¯¹è±¡çš„ç»„ã€‚</strong></p><p>éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œå¯¹äºKubernetesé‡Œçš„æ ¸å¿ƒAPIå¯¹è±¡ï¼Œæ¯”å¦‚ï¼šPodã€Nodeç­‰ï¼Œæ˜¯ä¸éœ€è¦Groupçš„ï¼ˆå³ï¼šå®ƒä»¬çš„Groupæ˜¯â€œâ€ï¼‰ã€‚æ‰€ä»¥ï¼Œå¯¹äºè¿™äº›APIå¯¹è±¡æ¥è¯´ï¼ŒKubernetesä¼šç›´æ¥åœ¨/apiè¿™ä¸ªå±‚çº§è¿›è¡Œä¸‹ä¸€æ­¥çš„åŒ¹é…è¿‡ç¨‹ã€‚</p><p>è€Œå¯¹äºCronJobç­‰éæ ¸å¿ƒAPIå¯¹è±¡æ¥è¯´ï¼ŒKuberneteså°±å¿…é¡»åœ¨/apisè¿™ä¸ªå±‚çº§é‡ŒæŸ¥æ‰¾å®ƒå¯¹åº”çš„Groupï¼Œè¿›è€Œæ ¹æ®â€œbatchâ€è¿™ä¸ªGroupçš„åå­—ï¼Œæ‰¾åˆ°/apis/batchã€‚</p><p>ä¸éš¾å‘ç°ï¼Œè¿™äº›API Groupçš„åˆ†ç±»æ˜¯ä»¥å¯¹è±¡åŠŸèƒ½ä¸ºä¾æ®çš„ï¼Œæ¯”å¦‚Jobå’ŒCronJobå°±éƒ½å±äºâ€œbatchâ€ ï¼ˆç¦»çº¿ä¸šåŠ¡ï¼‰è¿™ä¸ªGroupã€‚</p><p><strong>ç„¶åï¼ŒKubernetesä¼šè¿›ä¸€æ­¥åŒ¹é…åˆ°APIå¯¹è±¡çš„ç‰ˆæœ¬å·ã€‚</strong></p><p>å¯¹äºCronJobè¿™ä¸ªAPIå¯¹è±¡æ¥è¯´ï¼ŒKubernetesåœ¨batchè¿™ä¸ªGroupä¸‹ï¼ŒåŒ¹é…åˆ°çš„ç‰ˆæœ¬å·å°±æ˜¯v2alpha1ã€‚</p><p>åœ¨Kubernetesä¸­ï¼ŒåŒä¸€ç§APIå¯¹è±¡å¯ä»¥æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œè¿™æ­£æ˜¯Kubernetesè¿›è¡ŒAPIç‰ˆæœ¬åŒ–ç®¡ç†çš„é‡è¦æ‰‹æ®µã€‚è¿™æ ·ï¼Œæ¯”å¦‚åœ¨CronJobçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¼šå½±å“åˆ°ç”¨æˆ·çš„å˜æ›´å°±å¯ä»¥é€šè¿‡å‡çº§æ–°ç‰ˆæœ¬æ¥å¤„ç†ï¼Œä»è€Œä¿è¯äº†å‘åå…¼å®¹ã€‚</p><p><strong>æœ€åï¼ŒKubernetesä¼šåŒ¹é…APIå¯¹è±¡çš„èµ„æºç±»å‹ã€‚</strong></p><p>åœ¨å‰é¢åŒ¹é…åˆ°æ­£ç¡®çš„ç‰ˆæœ¬ä¹‹åï¼ŒKuberneteså°±çŸ¥é“ï¼Œæˆ‘è¦åˆ›å»ºçš„åŸæ¥æ˜¯ä¸€ä¸ª/apis/batch/v2alpha1ä¸‹çš„CronJobå¯¹è±¡ã€‚</p><p>è¿™æ—¶å€™ï¼Œ<span class=\"orange\">APIServerå°±å¯ä»¥ç»§ç»­åˆ›å»ºè¿™ä¸ªCronJobå¯¹è±¡äº†</span>ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä¸ºä½ æ€»ç»“äº†ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºæµç¨‹å›¾æ¥é˜è¿°è¿™ä¸ªåˆ›å»ºè¿‡ç¨‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/df/6f/df6f1dda45e9a353a051d06c48f0286f.png?wh=1867*748\" alt=\"\"><br>\n<strong>é¦–å…ˆ</strong>ï¼Œå½“æˆ‘ä»¬å‘èµ·äº†åˆ›å»ºCronJobçš„POSTè¯·æ±‚ä¹‹åï¼Œæˆ‘ä»¬ç¼–å†™çš„YAMLçš„ä¿¡æ¯å°±è¢«æäº¤ç»™äº†APIServerã€‚</p><p>è€ŒAPIServerçš„ç¬¬ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯è¿‡æ»¤è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶å®Œæˆä¸€äº›å‰ç½®æ€§çš„å·¥ä½œï¼Œæ¯”å¦‚æˆæƒã€è¶…æ—¶å¤„ç†ã€å®¡è®¡ç­‰ã€‚</p><p><strong>ç„¶å</strong>ï¼Œè¯·æ±‚ä¼šè¿›å…¥MUXå’ŒRoutesæµç¨‹ã€‚å¦‚æœä½ ç¼–å†™è¿‡Web Serverçš„è¯å°±ä¼šçŸ¥é“ï¼ŒMUXå’ŒRoutesæ˜¯APIServerå®ŒæˆURLå’ŒHandlerç»‘å®šçš„åœºæ‰€ã€‚è€ŒAPIServerçš„Handlerè¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯æŒ‰ç…§æˆ‘åˆšåˆšä»‹ç»çš„åŒ¹é…è¿‡ç¨‹ï¼Œæ‰¾åˆ°å¯¹åº”çš„CronJobç±»å‹å®šä¹‰ã€‚</p><p><strong>æ¥ç€</strong>ï¼ŒAPIServeræœ€é‡è¦çš„èŒè´£å°±æ¥äº†ï¼šæ ¹æ®è¿™ä¸ªCronJobç±»å‹å®šä¹‰ï¼Œä½¿ç”¨ç”¨æˆ·æäº¤çš„YAMLæ–‡ä»¶é‡Œçš„å­—æ®µï¼Œåˆ›å»ºä¸€ä¸ªCronJobå¯¹è±¡ã€‚</p><p>è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒAPIServerä¼šè¿›è¡Œä¸€ä¸ªConvertå·¥ä½œï¼Œå³ï¼šæŠŠç”¨æˆ·æäº¤çš„YAMLæ–‡ä»¶ï¼Œè½¬æ¢æˆä¸€ä¸ªå«ä½œSuper Versionçš„å¯¹è±¡ï¼Œå®ƒæ­£æ˜¯è¯¥APIèµ„æºç±»å‹æ‰€æœ‰ç‰ˆæœ¬çš„å­—æ®µå…¨é›†ã€‚è¿™æ ·ç”¨æˆ·æäº¤çš„ä¸åŒç‰ˆæœ¬çš„YAMLæ–‡ä»¶ï¼Œå°±éƒ½å¯ä»¥ç”¨è¿™ä¸ªSuper Versionå¯¹è±¡æ¥è¿›è¡Œå¤„ç†äº†ã€‚</p><p><strong>æ¥ä¸‹æ¥</strong>ï¼ŒAPIServerä¼šå…ˆåè¿›è¡ŒAdmission()å’ŒValidation()æ“ä½œã€‚æ¯”å¦‚ï¼Œæˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„Admission Controllerå’ŒInitializerï¼Œå°±éƒ½å±äºAdmissionçš„å†…å®¹ã€‚</p><p>è€ŒValidationï¼Œåˆ™è´Ÿè´£éªŒè¯è¿™ä¸ªå¯¹è±¡é‡Œçš„å„ä¸ªå­—æ®µæ˜¯å¦åˆæ³•ã€‚è¿™ä¸ªè¢«éªŒè¯è¿‡çš„APIå¯¹è±¡ï¼Œéƒ½ä¿å­˜åœ¨äº†APIServeré‡Œä¸€ä¸ªå«ä½œRegistryçš„æ•°æ®ç»“æ„ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ä¸€ä¸ªAPIå¯¹è±¡çš„å®šä¹‰èƒ½åœ¨Registryé‡ŒæŸ¥åˆ°ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„Kubernetes APIå¯¹è±¡ã€‚</p><p><strong>æœ€å</strong>ï¼ŒAPIServerä¼šæŠŠéªŒè¯è¿‡çš„APIå¯¹è±¡è½¬æ¢æˆç”¨æˆ·æœ€åˆæäº¤çš„ç‰ˆæœ¬ï¼Œè¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œå¹¶è°ƒç”¨Etcdçš„APIæŠŠå®ƒä¿å­˜èµ·æ¥ã€‚</p><p>ç”±æ­¤å¯è§ï¼Œå£°æ˜å¼APIå¯¹äºKubernetesæ¥è¯´éå¸¸é‡è¦ã€‚æ‰€ä»¥ï¼Œ<strong>APIServerè¿™æ ·ä¸€ä¸ªåœ¨å…¶ä»–é¡¹ç›®é‡Œâ€œå¹³æ·¡æ— å¥‡â€çš„ç»„ä»¶ï¼Œå´æˆäº†Kubernetesé¡¹ç›®çš„é‡ä¸­ä¹‹é‡</strong>ã€‚å®ƒä¸ä»…æ˜¯Google Borgè®¾è®¡æ€æƒ³çš„é›†ä¸­ä½“ç°ï¼Œä¹Ÿæ˜¯Kubernetesé¡¹ç›®é‡Œå”¯ä¸€ä¸€ä¸ªè¢«Googleå…¬å¸å’ŒRedHatå…¬å¸åŒé‡æ§åˆ¶ã€å…¶ä»–åŠ¿åŠ›æ ¹æœ¬æ— æ³•å‚ä¸å…¶ä¸­çš„ç»„ä»¶ã€‚</p><p>æ­¤å¤–ï¼Œç”±äºåŒæ—¶è¦å…¼é¡¾æ€§èƒ½ã€APIå®Œå¤‡æ€§ã€ç‰ˆæœ¬åŒ–ã€å‘åå…¼å®¹ç­‰å¾ˆå¤šå·¥ç¨‹åŒ–æŒ‡æ ‡ï¼Œæ‰€ä»¥Kuberneteså›¢é˜Ÿåœ¨APIServeré¡¹ç›®é‡Œå¤§é‡ä½¿ç”¨äº†Goè¯­è¨€çš„ä»£ç ç”ŸæˆåŠŸèƒ½ï¼Œæ¥è‡ªåŠ¨åŒ–è¯¸å¦‚Convertã€DeepCopyç­‰ä¸APIèµ„æºç›¸å…³çš„æ“ä½œã€‚è¿™éƒ¨åˆ†è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œæ›¾ä¸€åº¦å åˆ°Kubernetesé¡¹ç›®æ€»ä»£ç çš„20%~30%ã€‚</p><p>è¿™ä¹Ÿæ˜¯ä¸ºä½•ï¼Œåœ¨è¿‡å»å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œåœ¨è¿™æ ·ä¸€ä¸ªæå…¶â€œå¤æ‚â€çš„APIServerä¸­ï¼Œæ·»åŠ ä¸€ä¸ªKubernetesé£æ ¼çš„APIèµ„æºç±»å‹ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å›°éš¾çš„å·¥ä½œã€‚</p><p>ä¸è¿‡ï¼Œåœ¨Kubernetes v1.7 ä¹‹åï¼Œè¿™ä¸ªå·¥ä½œå°±å˜å¾—è½»æ¾å¾—å¤šäº†ã€‚è¿™ï¼Œå½“ç„¶å¾—ç›Šäºä¸€ä¸ªå…¨æ–°çš„APIæ’ä»¶æœºåˆ¶ï¼šCRDã€‚</p><p>CRDçš„å…¨ç§°æ˜¯Custom Resource Definitionã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒæŒ‡çš„å°±æ˜¯ï¼Œå…è®¸ç”¨æˆ·åœ¨Kubernetesä¸­æ·»åŠ ä¸€ä¸ªè·ŸPodã€Nodeç±»ä¼¼çš„ã€æ–°çš„APIèµ„æºç±»å‹ï¼Œå³ï¼šè‡ªå®šä¹‰APIèµ„æºã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œ<span class=\"orange\">æˆ‘ç°åœ¨è¦ä¸ºKubernetesæ·»åŠ ä¸€ä¸ªåå«Networkçš„APIèµ„æºç±»å‹</span>ã€‚</p><p>å®ƒçš„ä½œç”¨æ˜¯ï¼Œä¸€æ—¦ç”¨æˆ·åˆ›å»ºä¸€ä¸ªNetworkå¯¹è±¡ï¼Œé‚£ä¹ˆKuberneteså°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå¯¹è±¡å®šä¹‰çš„ç½‘ç»œå‚æ•°ï¼Œè°ƒç”¨çœŸå®çš„ç½‘ç»œæ’ä»¶ï¼Œæ¯”å¦‚Neutroné¡¹ç›®ï¼Œä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„â€œç½‘ç»œâ€ã€‚è¿™æ ·ï¼Œå°†æ¥ç”¨æˆ·åˆ›å»ºçš„Podï¼Œå°±å¯ä»¥å£°æ˜ä½¿ç”¨è¿™ä¸ªâ€œç½‘ç»œâ€äº†ã€‚</p><p>è¿™ä¸ªNetworkå¯¹è±¡çš„YAMLæ–‡ä»¶ï¼Œåå«example-network.yamlï¼Œå®ƒçš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>apiVersion: samplecrd.k8s.io/v1\nkind: Network\nmetadata:\n  name: example-network\nspec:\n  cidr: &quot;192.168.0.0/16&quot;\n  gateway: &quot;192.168.0.1&quot;\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æƒ³è¦æè¿°â€œç½‘ç»œâ€çš„APIèµ„æºç±»å‹æ˜¯Networkï¼›APIç»„æ˜¯<code>samplecrd.k8s.io</code>ï¼›API ç‰ˆæœ¬æ˜¯v1ã€‚</p><p>é‚£ä¹ˆï¼Œ<span class=\"orange\">Kubernetesåˆè¯¥å¦‚ä½•çŸ¥é“è¿™ä¸ªAPIï¼ˆ<code>samplecrd.k8s.io/v1/network</code>ï¼‰çš„å­˜åœ¨å‘¢ï¼Ÿ</span></p><p>å…¶å®ï¼Œä¸Šé¢çš„è¿™ä¸ªYAMLæ–‡ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªå…·ä½“çš„â€œè‡ªå®šä¹‰APIèµ„æºâ€å®ä¾‹ï¼Œä¹Ÿå«CRï¼ˆCustom Resourceï¼‰ã€‚è€Œä¸ºäº†èƒ½å¤Ÿè®©Kubernetesè®¤è¯†è¿™ä¸ªCRï¼Œä½ å°±éœ€è¦è®©Kubernetesæ˜ç™½è¿™ä¸ªCRçš„å®è§‚å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯CRDï¼ˆCustom Resource Definitionï¼‰ã€‚</p><p>è¿™å°±å¥½æ¯”ï¼Œä½ æƒ³è®©è®¡ç®—æœºè®¤è¯†å„ç§å…”å­çš„ç…§ç‰‡ï¼Œå°±å¾—å…ˆè®©è®¡ç®—æœºæ˜ç™½ï¼Œå…”å­çš„æ™®éå®šä¹‰æ˜¯ä»€ä¹ˆã€‚æ¯”å¦‚ï¼Œå…”å­â€œæ˜¯å“ºä¹³åŠ¨ç‰©â€â€œæœ‰é•¿è€³æœµï¼Œä¸‰ç“£å˜´â€ã€‚</p><p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°±å…ˆç¼–å†™ä¸€ä¸ªCRDçš„YAMLæ–‡ä»¶ï¼Œå®ƒçš„åå­—å«ä½œnetwork.yamlï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>apiVersion: apiextensions.k8s.io/v1beta1\nkind: CustomResourceDefinition\nmetadata:\n  name: networks.samplecrd.k8s.io\nspec:\n  group: samplecrd.k8s.io\n  version: v1\n  names:\n    kind: Network\n    plural: networks\n  scope: Namespaced\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªCRDä¸­ï¼Œæˆ‘æŒ‡å®šäº†â€œ<code>group: samplecrd.k8s.io</code>â€â€œ<code>version: v1</code>â€è¿™æ ·çš„APIä¿¡æ¯ï¼Œä¹ŸæŒ‡å®šäº†è¿™ä¸ªCRçš„èµ„æºç±»å‹å«ä½œNetworkï¼Œå¤æ•°ï¼ˆpluralï¼‰æ˜¯networksã€‚</p><p>ç„¶åï¼Œæˆ‘è¿˜å£°æ˜äº†å®ƒçš„scopeæ˜¯Namespacedï¼Œå³ï¼šæˆ‘ä»¬å®šä¹‰çš„è¿™ä¸ªNetworkæ˜¯ä¸€ä¸ªå±äºNamespaceçš„å¯¹è±¡ï¼Œç±»ä¼¼äºPodã€‚</p><p>è¿™å°±æ˜¯ä¸€ä¸ªNetwork APIèµ„æºç±»å‹çš„APIéƒ¨åˆ†çš„å®è§‚å®šä¹‰äº†ã€‚è¿™å°±ç­‰åŒäºå‘Šè¯‰äº†è®¡ç®—æœºï¼šâ€œå…”å­æ˜¯å“ºä¹³åŠ¨ç‰©â€ã€‚æ‰€ä»¥è¿™æ—¶å€™ï¼ŒKuberneteså°±èƒ½å¤Ÿè®¤è¯†å’Œå¤„ç†æ‰€æœ‰å£°æ˜äº†APIç±»å‹æ˜¯â€œ<code>samplecrd.k8s.io/v1/network</code>â€çš„YAMLæ–‡ä»¶äº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘è¿˜éœ€è¦è®©Kubernetesâ€œè®¤è¯†â€è¿™ç§YAMLæ–‡ä»¶é‡Œæè¿°çš„â€œç½‘ç»œâ€éƒ¨åˆ†ï¼Œæ¯”å¦‚â€œcidrâ€ï¼ˆç½‘æ®µï¼‰ï¼Œâ€œgatewayâ€ï¼ˆç½‘å…³ï¼‰è¿™äº›å­—æ®µçš„å«ä¹‰ã€‚è¿™å°±ç›¸å½“äºæˆ‘è¦å‘Šè¯‰è®¡ç®—æœºï¼šâ€œå…”å­æœ‰é•¿è€³æœµå’Œä¸‰ç“£å˜´â€ã€‚</p><p>è¿™æ—¶å€™å‘¢ï¼Œæˆ‘å°±éœ€è¦ç¨å¾®åšäº›ä»£ç å·¥ä½œäº†ã€‚</p><p><strong>é¦–å…ˆï¼Œæˆ‘è¦åœ¨GOPATHä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªç»“æ„å¦‚ä¸‹çš„é¡¹ç›®ï¼š</strong></p><blockquote>\n<p>å¤‡æ³¨ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘å¹¶ä¸è¦æ±‚ä½ å…·æœ‰å®Œå¤‡çš„Goè¯­è¨€çŸ¥è¯†ä½“ç³»ï¼Œä½†æˆ‘ä¼šå‡è®¾ä½ å·²ç»äº†è§£äº†Golangçš„ä¸€äº›åŸºæœ¬çŸ¥è¯†ï¼ˆæ¯”å¦‚ï¼ŒçŸ¥é“ä»€ä¹ˆæ˜¯GOPATHï¼‰ã€‚è€Œå¦‚æœä½ è¿˜ä¸äº†è§£çš„è¯ï¼Œå¯ä»¥åœ¨æ¶‰åŠåˆ°ç›¸å…³å†…å®¹æ—¶ï¼Œå†å»æŸ¥é˜…ä¸€äº›ç›¸å…³èµ„æ–™ã€‚</p>\n</blockquote><pre><code>$ tree $GOPATH/src/github.com/&lt;your-name&gt;/k8s-controller-custom-resource\n.\nâ”œâ”€â”€ controller.go\nâ”œâ”€â”€ crd\nâ”‚   â””â”€â”€ network.yaml\nâ”œâ”€â”€ example\nâ”‚   â””â”€â”€ example-network.yaml\nâ”œâ”€â”€ main.go\nâ””â”€â”€ pkg\n    â””â”€â”€ apis\n        â””â”€â”€ samplecrd\n            â”œâ”€â”€ register.go\n            â””â”€â”€ v1\n                â”œâ”€â”€ doc.go\n                â”œâ”€â”€ register.go\n                â””â”€â”€ types.go\n</code></pre><p>å…¶ä¸­ï¼Œpkg/apis/samplecrdå°±æ˜¯APIç»„çš„åå­—ï¼Œv1æ˜¯ç‰ˆæœ¬ï¼Œè€Œv1ä¸‹é¢çš„types.goæ–‡ä»¶é‡Œï¼Œåˆ™å®šä¹‰äº†Networkå¯¹è±¡çš„å®Œæ•´æè¿°ã€‚æˆ‘å·²ç»æŠŠè¿™ä¸ªé¡¹ç›®<a href=\"https://github.com/resouer/k8s-controller-custom-resource\">ä¸Šä¼ åˆ°äº†GitHubä¸Š</a>ï¼Œä½ å¯ä»¥éšæ—¶å‚è€ƒã€‚</p><p><strong>ç„¶åï¼Œæˆ‘åœ¨pkg/apis/samplecrdç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªregister.goæ–‡ä»¶ï¼Œç”¨æ¥æ”¾ç½®åé¢è¦ç”¨åˆ°çš„å…¨å±€å˜é‡</strong>ã€‚è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>package samplecrd\n\nconst (\n GroupName = &quot;samplecrd.k8s.io&quot;\n Version   = &quot;v1&quot;\n)\n</code></pre><p><strong>æ¥ç€ï¼Œæˆ‘éœ€è¦åœ¨pkg/apis/samplecrdç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªdoc.goæ–‡ä»¶ï¼ˆGolangçš„æ–‡æ¡£æºæ–‡ä»¶ï¼‰</strong>ã€‚è¿™ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>// +k8s:deepcopy-gen=package\n\n// +groupName=samplecrd.k8s.io\npackage v1\n</code></pre><p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œä½ ä¼šçœ‹åˆ°+&lt;tag_name&gt;[=value]æ ¼å¼çš„æ³¨é‡Šï¼Œè¿™å°±æ˜¯Kubernetesè¿›è¡Œä»£ç ç”Ÿæˆè¦ç”¨çš„Annotationé£æ ¼çš„æ³¨é‡Šã€‚</p><p>å…¶ä¸­ï¼Œ+k8s:deepcopy-gen=packageæ„æ€æ˜¯ï¼Œè¯·ä¸ºæ•´ä¸ªv1åŒ…é‡Œçš„æ‰€æœ‰ç±»å‹å®šä¹‰è‡ªåŠ¨ç”ŸæˆDeepCopyæ–¹æ³•ï¼›è€Œ<code>+groupName=samplecrd.k8s.io</code>ï¼Œåˆ™å®šä¹‰äº†è¿™ä¸ªåŒ…å¯¹åº”çš„APIç»„çš„åå­—ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›å®šä¹‰åœ¨doc.goæ–‡ä»¶çš„æ³¨é‡Šï¼Œèµ·åˆ°çš„æ˜¯å…¨å±€çš„ä»£ç ç”Ÿæˆæ§åˆ¶çš„ä½œç”¨ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºGlobal Tagsã€‚</p><p><strong>æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦æ·»åŠ types.goæ–‡ä»¶</strong>ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å®šä¹‰ä¸€ä¸ªNetworkç±»å‹åˆ°åº•æœ‰å“ªäº›å­—æ®µï¼ˆæ¯”å¦‚ï¼Œspecå­—æ®µé‡Œçš„å†…å®¹ï¼‰ã€‚è¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>package v1\n...\n// +genclient\n// +genclient:noStatus\n// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object\n\n// Network describes a Network resource\ntype Network struct {\n // TypeMeta is the metadata for the resource, like kind and apiversion\n metav1.TypeMeta `json:&quot;,inline&quot;`\n // ObjectMeta contains the metadata for the particular object, including\n // things like...\n //  - name\n //  - namespace\n //  - self link\n //  - labels\n //  - ... etc ...\n metav1.ObjectMeta `json:&quot;metadata,omitempty&quot;`\n \n Spec networkspec `json:&quot;spec&quot;`\n}\n// networkspec is the spec for a Network resource\ntype networkspec struct {\n Cidr    string `json:&quot;cidr&quot;`\n Gateway string `json:&quot;gateway&quot;`\n}\n\n// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object\n\n// NetworkList is a list of Network resources\ntype NetworkList struct {\n metav1.TypeMeta `json:&quot;,inline&quot;`\n metav1.ListMeta `json:&quot;metadata&quot;`\n \n Items []Network `json:&quot;items&quot;`\n}\n</code></pre><p>åœ¨ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°Networkç±»å‹å®šä¹‰æ–¹æ³•è·Ÿæ ‡å‡†çš„Kuberneteså¯¹è±¡ä¸€æ ·ï¼Œéƒ½åŒ…æ‹¬äº†TypeMetaï¼ˆAPIå…ƒæ•°æ®ï¼‰å’ŒObjectMetaï¼ˆå¯¹è±¡å…ƒæ•°æ®ï¼‰å­—æ®µã€‚</p><p>è€Œå…¶ä¸­çš„Specå­—æ®µï¼Œå°±æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„éƒ¨åˆ†ã€‚æ‰€ä»¥ï¼Œåœ¨networkspecé‡Œï¼Œæˆ‘å®šä¹‰äº†Cidrå’ŒGatewayä¸¤ä¸ªå­—æ®µã€‚å…¶ä¸­ï¼Œæ¯ä¸ªå­—æ®µæœ€åé¢çš„éƒ¨åˆ†æ¯”å¦‚<code>json:\"cidr\"</code>ï¼ŒæŒ‡çš„å°±æ˜¯è¿™ä¸ªå­—æ®µè¢«è½¬æ¢æˆJSONæ ¼å¼ä¹‹åçš„åå­—ï¼Œä¹Ÿå°±æ˜¯YAMLæ–‡ä»¶é‡Œçš„å­—æ®µåå­—ã€‚</p><blockquote>\n<p>å¦‚æœä½ ä¸ç†Ÿæ‚‰è¿™ä¸ªç”¨æ³•çš„è¯ï¼Œå¯ä»¥æŸ¥é˜…ä¸€ä¸‹Golangçš„æ–‡æ¡£ã€‚</p>\n</blockquote><p>æ­¤å¤–ï¼Œé™¤äº†å®šä¹‰Networkç±»å‹ï¼Œä½ è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ªNetworkListç±»å‹ï¼Œç”¨æ¥æè¿°<strong>ä¸€ç»„Networkå¯¹è±¡</strong>åº”è¯¥åŒ…æ‹¬å“ªäº›å­—æ®µã€‚ä¹‹æ‰€ä»¥éœ€è¦è¿™æ ·ä¸€ä¸ªç±»å‹ï¼Œæ˜¯å› ä¸ºåœ¨Kubernetesä¸­ï¼Œè·å–æ‰€æœ‰Xå¯¹è±¡çš„List()æ–¹æ³•ï¼Œè¿”å›å€¼éƒ½æ˜¯<x>Listç±»å‹ï¼Œè€Œä¸æ˜¯Xç±»å‹çš„æ•°ç»„ã€‚è¿™æ˜¯ä¸ä¸€æ ·çš„ã€‚</x></p><p>åŒæ ·åœ°ï¼Œåœ¨Networkå’ŒNetworkListç±»å‹ä¸Šï¼Œä¹Ÿæœ‰ä»£ç ç”Ÿæˆæ³¨é‡Šã€‚</p><p>å…¶ä¸­ï¼Œ+genclientçš„æ„æ€æ˜¯ï¼šè¯·ä¸ºä¸‹é¢è¿™ä¸ªAPIèµ„æºç±»å‹ç”Ÿæˆå¯¹åº”çš„Clientä»£ç ï¼ˆè¿™ä¸ªClientï¼Œæˆ‘é©¬ä¸Šä¼šè®²åˆ°ï¼‰ã€‚è€Œ+genclient:noStatusçš„æ„æ€æ˜¯ï¼šè¿™ä¸ªAPIèµ„æºç±»å‹å®šä¹‰é‡Œï¼Œæ²¡æœ‰Statuså­—æ®µã€‚å¦åˆ™ï¼Œç”Ÿæˆçš„Clientå°±ä¼šè‡ªåŠ¨å¸¦ä¸ŠUpdateStatusæ–¹æ³•ã€‚</p><p>å¦‚æœä½ çš„ç±»å‹å®šä¹‰åŒ…æ‹¬äº†Statuså­—æ®µçš„è¯ï¼Œå°±ä¸éœ€è¦è¿™å¥+genclient:noStatusæ³¨é‡Šäº†ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><pre><code>// +genclient\n\n// Network is a specification for a Network resource\ntype Network struct {\n metav1.TypeMeta   `json:&quot;,inline&quot;`\n metav1.ObjectMeta `json:&quot;metadata,omitempty&quot;`\n \n Spec   NetworkSpec   `json:&quot;spec&quot;`\n Status NetworkStatus `json:&quot;status&quot;`\n}\n</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ+genclientåªéœ€è¦å†™åœ¨Networkç±»å‹ä¸Šï¼Œè€Œä¸ç”¨å†™åœ¨NetworkListä¸Šã€‚å› ä¸ºNetworkListåªæ˜¯ä¸€ä¸ªè¿”å›å€¼ç±»å‹ï¼ŒNetworkæ‰æ˜¯â€œä¸»ç±»å‹â€ã€‚</p><p>è€Œç”±äºæˆ‘åœ¨Global Tagsé‡Œå·²ç»å®šä¹‰äº†ä¸ºæ‰€æœ‰ç±»å‹ç”ŸæˆDeepCopyæ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸éœ€è¦å†æ˜¾å¼åœ°åŠ ä¸Š+k8s:deepcopy-gen=trueäº†ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä½ å¯ä»¥ç”¨+k8s:deepcopy-gen=falseæ¥é˜»æ­¢ä¸ºæŸäº›ç±»å‹ç”ŸæˆDeepCopyã€‚</p><p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨è¿™ä¸¤ä¸ªç±»å‹ä¸Šé¢è¿˜æœ‰ä¸€å¥<code>+k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object</code>çš„æ³¨é‡Šã€‚å®ƒçš„æ„æ€æ˜¯ï¼Œè¯·åœ¨ç”ŸæˆDeepCopyçš„æ—¶å€™ï¼Œå®ç°Kubernetesæä¾›çš„runtime.Objectæ¥å£ã€‚å¦åˆ™ï¼Œåœ¨æŸäº›ç‰ˆæœ¬çš„Kubernetesé‡Œï¼Œä½ çš„è¿™ä¸ªç±»å‹å®šä¹‰ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ã€‚è¿™æ˜¯ä¸€ä¸ªå›ºå®šçš„æ“ä½œï¼Œè®°ä½å³å¯ã€‚</p><p>ä¸è¿‡ï¼Œä½ æˆ–è®¸ä¼šæœ‰è¿™æ ·çš„é¡¾è™‘ï¼šè¿™äº›ä»£ç ç”Ÿæˆæ³¨é‡Šè¿™ä¹ˆçµæ´»ï¼Œæˆ‘è¯¥æ€ä¹ˆæŒæ¡å‘¢ï¼Ÿ</p><p>å…¶å®ï¼Œä¸Šé¢æˆ‘æ‰€è®²è¿°çš„å†…å®¹ï¼Œå·²ç»è¶³ä»¥åº”å¯¹99%çš„åœºæ™¯äº†ã€‚å½“ç„¶ï¼Œå¦‚æœä½ å¯¹ä»£ç ç”Ÿæˆæ„Ÿå…´è¶£çš„è¯ï¼Œæˆ‘æ¨èä½ é˜…è¯»<a href=\"https://blog.openshift.com/kubernetes-deep-dive-code-generation-customresources/\">è¿™ç¯‡åšå®¢</a>ï¼Œå®ƒè¯¦ç»†åœ°ä»‹ç»äº†Kubernetesçš„ä»£ç ç”Ÿæˆè¯­æ³•ã€‚</p><p><strong>æœ€åï¼Œæˆ‘éœ€è¦å†ç¼–å†™ä¸€ä¸ªpkg/apis/samplecrd/v1/register.goæ–‡ä»¶</strong>ã€‚</p><p>åœ¨å‰é¢å¯¹APIServerå·¥ä½œåŸç†çš„è®²è§£ä¸­ï¼Œæˆ‘å·²ç»æåˆ°ï¼Œâ€œregistryâ€çš„ä½œç”¨å°±æ˜¯æ³¨å†Œä¸€ä¸ªç±»å‹ï¼ˆTypeï¼‰ç»™APIServerã€‚å…¶ä¸­ï¼ŒNetworkèµ„æºç±»å‹åœ¨æœåŠ¡å™¨ç«¯æ³¨å†Œçš„å·¥ä½œï¼ŒAPIServerä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆã€‚ä½†ä¸ä¹‹å¯¹åº”çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®©å®¢æˆ·ç«¯ä¹Ÿèƒ½â€œçŸ¥é“â€Networkèµ„æºç±»å‹çš„å®šä¹‰ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬åœ¨é¡¹ç›®é‡Œæ·»åŠ ä¸€ä¸ªregister.goæ–‡ä»¶ã€‚å®ƒæœ€ä¸»è¦çš„åŠŸèƒ½ï¼Œå°±æ˜¯å®šä¹‰äº†å¦‚ä¸‹æ‰€ç¤ºçš„addKnownTypes()æ–¹æ³•ï¼š</p><pre><code>package v1\n...\n// addKnownTypes adds our types to the API scheme by registering\n// Network and NetworkList\nfunc addKnownTypes(scheme *runtime.Scheme) error {\n scheme.AddKnownTypes(\n  SchemeGroupVersion,\n  &amp;Network{},\n  &amp;NetworkList{},\n )\n \n // register the type in the scheme\n metav1.AddToGroupVersion(scheme, SchemeGroupVersion)\n return nil\n}\n</code></pre><p>æœ‰äº†è¿™ä¸ªæ–¹æ³•ï¼ŒKuberneteså°±èƒ½å¤Ÿåœ¨åé¢ç”Ÿæˆå®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œâ€œçŸ¥é“â€Networkä»¥åŠNetworkListç±»å‹çš„å®šä¹‰äº†ã€‚</p><p>åƒä¸Šé¢è¿™ç§<strong>register.goæ–‡ä»¶é‡Œçš„å†…å®¹å…¶å®æ˜¯éå¸¸å›ºå®šçš„ï¼Œä½ ä»¥åå¯ä»¥ç›´æ¥ä½¿ç”¨æˆ‘æä¾›çš„è¿™éƒ¨åˆ†ä»£ç åšæ¨¡æ¿ï¼Œç„¶åæŠŠå…¶ä¸­çš„èµ„æºç±»å‹ã€GroupNameå’ŒVersionæ›¿æ¢æˆä½ è‡ªå·±çš„å®šä¹‰å³å¯ã€‚</strong></p><p>è¿™æ ·ï¼ŒNetworkå¯¹è±¡çš„å®šä¹‰å·¥ä½œå°±å…¨éƒ¨å®Œæˆäº†ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå…¶å®å®šä¹‰äº†ä¸¤éƒ¨åˆ†å†…å®¹ï¼š</p><ul>\n<li>ç¬¬ä¸€éƒ¨åˆ†æ˜¯ï¼Œè‡ªå®šä¹‰èµ„æºç±»å‹çš„APIæè¿°ï¼ŒåŒ…æ‹¬ï¼šç»„ï¼ˆGroupï¼‰ã€ç‰ˆæœ¬ï¼ˆVersionï¼‰ã€èµ„æºç±»å‹ï¼ˆResourceï¼‰ç­‰ã€‚è¿™ç›¸å½“äºå‘Šè¯‰äº†è®¡ç®—æœºï¼šå…”å­æ˜¯å“ºä¹³åŠ¨ç‰©ã€‚</li>\n<li>ç¬¬äºŒéƒ¨åˆ†æ˜¯ï¼Œè‡ªå®šä¹‰èµ„æºç±»å‹çš„å¯¹è±¡æè¿°ï¼ŒåŒ…æ‹¬ï¼šSpecã€Statusç­‰ã€‚è¿™ç›¸å½“äºå‘Šè¯‰äº†è®¡ç®—æœºï¼šå…”å­æœ‰é•¿è€³æœµå’Œä¸‰ç“£å˜´ã€‚</li>\n</ul><p>æ¥ä¸‹æ¥ï¼Œ<span class=\"orange\">æˆ‘å°±è¦ä½¿ç”¨Kubernetesæä¾›çš„ä»£ç ç”Ÿæˆå·¥å…·ï¼Œä¸ºä¸Šé¢å®šä¹‰çš„Networkèµ„æºç±»å‹è‡ªåŠ¨ç”Ÿæˆclientsetã€informerå’Œlisterã€‚</span>å…¶ä¸­ï¼Œclientsetå°±æ˜¯æ“ä½œNetworkå¯¹è±¡æ‰€éœ€è¦ä½¿ç”¨çš„å®¢æˆ·ç«¯ï¼Œè€Œinformerå’Œlisterè¿™ä¸¤ä¸ªåŒ…çš„ä¸»è¦åŠŸèƒ½ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­é‡ç‚¹è®²è§£ã€‚</p><p>è¿™ä¸ªä»£ç ç”Ÿæˆå·¥å…·åå«<code>k8s.io/code-generator</code>ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code># ä»£ç ç”Ÿæˆçš„å·¥ä½œç›®å½•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„é¡¹ç›®è·¯å¾„\n$ ROOT_PACKAGE=&quot;github.com/resouer/k8s-controller-custom-resource&quot;\n# API Group\n$ CUSTOM_RESOURCE_NAME=&quot;samplecrd&quot;\n# API Version\n$ CUSTOM_RESOURCE_VERSION=&quot;v1&quot;\n\n# å®‰è£…k8s.io/code-generator\n$ go get -u k8s.io/code-generator/...\n$ cd $GOPATH/src/k8s.io/code-generator\n\n# æ‰§è¡Œä»£ç è‡ªåŠ¨ç”Ÿæˆï¼Œå…¶ä¸­pkg/clientæ˜¯ç”Ÿæˆç›®æ ‡ç›®å½•ï¼Œpkg/apisæ˜¯ç±»å‹å®šä¹‰ç›®å½•\n$ ./generate-groups.sh all &quot;$ROOT_PACKAGE/pkg/client&quot; &quot;$ROOT_PACKAGE/pkg/apis&quot; &quot;$CUSTOM_RESOURCE_NAME:$CUSTOM_RESOURCE_VERSION&quot;\n</code></pre><p>ä»£ç ç”Ÿæˆå·¥ä½œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å†æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼š</p><pre><code>$ tree\n.\nâ”œâ”€â”€ controller.go\nâ”œâ”€â”€ crd\nâ”‚   â””â”€â”€ network.yaml\nâ”œâ”€â”€ example\nâ”‚   â””â”€â”€ example-network.yaml\nâ”œâ”€â”€ main.go\nâ””â”€â”€ pkg\n    â”œâ”€â”€ apis\n    â”‚   â””â”€â”€ samplecrd\n    â”‚       â”œâ”€â”€ constants.go\n    â”‚       â””â”€â”€ v1\n    â”‚           â”œâ”€â”€ doc.go\n    â”‚           â”œâ”€â”€ register.go\n    â”‚           â”œâ”€â”€ types.go\n    â”‚           â””â”€â”€ zz_generated.deepcopy.go\n    â””â”€â”€ client\n        â”œâ”€â”€ clientset\n        â”œâ”€â”€ informers\n        â””â”€â”€ listers\n</code></pre><p>å…¶ä¸­ï¼Œpkg/apis/samplecrd/v1ä¸‹é¢çš„zz_generated.deepcopy.goæ–‡ä»¶ï¼Œå°±æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„DeepCopyä»£ç æ–‡ä»¶ã€‚</p><p>è€Œæ•´ä¸ªclientç›®å½•ï¼Œä»¥åŠä¸‹é¢çš„ä¸‰ä¸ªåŒ…ï¼ˆclientsetã€informersã€ listersï¼‰ï¼Œéƒ½æ˜¯Kubernetesä¸ºNetworkç±»å‹ç”Ÿæˆçš„å®¢æˆ·ç«¯åº“ï¼Œè¿™äº›åº“ä¼šåœ¨åé¢ç¼–å†™è‡ªå®šä¹‰æ§åˆ¶å™¨çš„æ—¶å€™ç”¨åˆ°ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ°ç›®å‰ä¸ºæ­¢çš„è¿™äº›å·¥ä½œï¼Œå…¶å®å¹¶ä¸è¦æ±‚ä½ å†™å¤šå°‘ä»£ç ï¼Œä¸»è¦è€ƒéªŒçš„æ˜¯â€œå¤åˆ¶ã€ç²˜è´´ã€æ›¿æ¢â€è¿™æ ·çš„â€œåŸºæœ¬åŠŸâ€ã€‚</p><p>è€Œæœ‰äº†è¿™äº›å†…å®¹ï¼Œç°åœ¨ä½ å°±å¯ä»¥<span class=\"orange\">åœ¨Kubernetesé›†ç¾¤é‡Œåˆ›å»ºä¸€ä¸ªNetworkç±»å‹çš„APIå¯¹è±¡</span>äº†ã€‚æˆ‘ä»¬ä¸å¦¨ä¸€èµ·æ¥è¯•éªŒä¸‹ã€‚</p><p><strong>é¦–å…ˆ</strong>ï¼Œä½¿ç”¨network.yamlæ–‡ä»¶ï¼Œåœ¨Kubernetesä¸­åˆ›å»ºNetworkå¯¹è±¡çš„CRDï¼ˆCustom Resource Definitionï¼‰ï¼š</p><pre><code>$ kubectl apply -f crd/network.yaml\ncustomresourcedefinition.apiextensions.k8s.io/networks.samplecrd.k8s.io created\n</code></pre><p>è¿™ä¸ªæ“ä½œï¼Œå°±å‘Šè¯‰äº†Kubernetesï¼Œæˆ‘ç°åœ¨è¦æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„APIå¯¹è±¡ã€‚è€Œè¿™ä¸ªå¯¹è±¡çš„APIä¿¡æ¯ï¼Œæ­£æ˜¯network.yamlé‡Œå®šä¹‰çš„å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡kubectl getå‘½ä»¤ï¼ŒæŸ¥çœ‹è¿™ä¸ªCRDï¼š</p><pre><code>$ kubectl get crd\nNAME                        CREATED AT\nnetworks.samplecrd.k8s.io   2018-09-15T10:57:12Z\n</code></pre><p><strong>ç„¶å</strong>ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªNetworkå¯¹è±¡äº†ï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯example-network.yamlï¼š</p><pre><code>$ kubectl apply -f example/example-network.yaml \nnetwork.samplecrd.k8s.io/example-network created\n</code></pre><p>é€šè¿‡è¿™ä¸ªæ“ä½œï¼Œä½ å°±åœ¨Kubernetesé›†ç¾¤é‡Œåˆ›å»ºäº†ä¸€ä¸ªNetworkå¯¹è±¡ã€‚å®ƒçš„APIèµ„æºè·¯å¾„æ˜¯<code>samplecrd.k8s.io/v1/networks</code>ã€‚</p><p>è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥é€šè¿‡kubectl getå‘½ä»¤ï¼ŒæŸ¥çœ‹åˆ°æ–°åˆ›å»ºçš„Networkå¯¹è±¡ï¼š</p><pre><code>$ kubectl get network\nNAME              AGE\nexample-network   8s\n</code></pre><p>ä½ è¿˜å¯ä»¥é€šè¿‡kubectl describeå‘½ä»¤ï¼Œçœ‹åˆ°è¿™ä¸ªNetworkå¯¹è±¡çš„ç»†èŠ‚ï¼š</p><pre><code>$ kubectl describe network example-network\nName:         example-network\nNamespace:    default\nLabels:       &lt;none&gt;\n...API Version:  samplecrd.k8s.io/v1\nKind:         Network\nMetadata:\n  ...\n  Generation:          1\n  Resource Version:    468239\n  ...\nSpec:\n  Cidr:     192.168.0.0/16\n  Gateway:  192.168.0.1\n</code></pre><p>å½“ç„¶ ï¼Œä½ ä¹Ÿå¯ä»¥ç¼–å†™æ›´å¤šçš„YAMLæ–‡ä»¶æ¥åˆ›å»ºæ›´å¤šçš„Networkå¯¹è±¡ï¼Œè¿™å’Œåˆ›å»ºPodã€Deploymentçš„æ“ä½œï¼Œæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨ä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¸ºä½ è¯¦ç»†è§£æäº†Kuberneteså£°æ˜å¼APIçš„å·¥ä½œåŸç†ï¼Œè®²è§£äº†å¦‚ä½•éµå¾ªå£°æ˜å¼APIçš„è®¾è®¡ï¼Œä¸ºKubernetesæ·»åŠ ä¸€ä¸ªåå«Networkçš„APIèµ„æºç±»å‹ã€‚ä»è€Œè¾¾åˆ°äº†é€šè¿‡æ ‡å‡†çš„kubectl createå’Œgetæ“ä½œï¼Œæ¥ç®¡ç†è‡ªå®šä¹‰APIå¯¹è±¡çš„ç›®çš„ã€‚</p><p>ä¸è¿‡ï¼Œåˆ›å»ºå‡ºè¿™æ ·ä¸€ä¸ªè‡ªå®šä¹‰APIå¯¹è±¡ï¼Œæˆ‘ä»¬åªæ˜¯å®Œæˆäº†Kuberneteså£°æ˜å¼APIçš„ä¸€åŠå·¥ä½œã€‚</p><p>æ¥ä¸‹æ¥çš„å¦ä¸€åŠå·¥ä½œæ˜¯ï¼šä¸ºè¿™ä¸ªAPIå¯¹è±¡ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰æ§åˆ¶å™¨ï¼ˆCustom Controllerï¼‰ã€‚è¿™æ ·ï¼Œ Kubernetesæ‰èƒ½æ ¹æ®Network APIå¯¹è±¡çš„â€œå¢ã€åˆ ã€æ”¹â€æ“ä½œï¼Œåœ¨çœŸå®ç¯å¢ƒä¸­åšå‡ºç›¸åº”çš„å“åº”ã€‚æ¯”å¦‚ï¼Œâ€œåˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹â€çœŸæ­£çš„Neutronç½‘ç»œã€‚</p><p>è€Œè¿™ï¼Œæ­£æ˜¯Networkè¿™ä¸ªAPIå¯¹è±¡æ‰€å…³æ³¨çš„â€œä¸šåŠ¡é€»è¾‘â€ã€‚</p><p>è¿™ä¸ªä¸šåŠ¡é€»è¾‘çš„å®ç°è¿‡ç¨‹ï¼Œä»¥åŠå®ƒæ‰€ä½¿ç”¨çš„Kubernetes APIç¼–ç¨‹åº“çš„å·¥ä½œåŸç†ï¼Œå°±æ˜¯æˆ‘è¦åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è®²è§£çš„ä¸»è¦å†…å®¹ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>åœ¨äº†è§£äº†CRDçš„å®šä¹‰æ–¹æ³•ä¹‹åï¼Œä½ æ˜¯å¦å·²ç»åœ¨è€ƒè™‘ä½¿ç”¨CRDï¼ˆæˆ–è€…å·²ç»ä½¿ç”¨äº†CRDï¼‰æ¥æè¿°ç°å®ä¸­çš„æŸç§å®ä½“äº†å‘¢ï¼Ÿèƒ½å¦åˆ†äº«ä¸€ä¸‹ä½ çš„æ€è·¯ï¼Ÿï¼ˆä¸¾ä¸ªä¾‹å­ï¼šæŸæŠ€æœ¯å›¢é˜Ÿä½¿ç”¨CRDæè¿°äº†â€œå®¿ä¸»æœºâ€ï¼Œç„¶åç”¨Kuberneteséƒ¨ç½²äº†Kubernetesï¼‰</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p>","comments":[{"had_liked":false,"id":33501,"user_name":"åŒ—å¡","can_delete":false,"product_type":"c1","uid":1218128,"ip_address":"","ucode":"2D947A61689FC6","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/50/bde525b1.jpg","comment_is_top":false,"comment_ctime":1539798385,"is_pvip":false,"replies":[{"id":"12060","content":"æ²¡é”™ã€‚æˆ‘è§‰å¾—è¿™éƒ¨åˆ†æ‰æ˜¯è¿ç»´æœ€å–œæ¬¢çš„ã€‚è°ä¸å–œæ¬¢å†™ä»£ç å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539822041,"ip_address":"","comment_id":33501,"utype":1}],"discussion_count":2,"race_medal":0,"score":"285007639921","product_id":100015201,"comment_content":"è¿ç»´äººå‘˜ä¼šå¿ƒç¢?<br>æˆ‘æ˜¯è¿ç»´äººå‘˜ï¼Œæ­¤åˆ»çœ‹å®Œæˆ‘æ„Ÿåˆ°å¾ˆå…´å¥‹ã€‚","like_count":67,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426976,"discussion_content":"æ²¡é”™ã€‚æˆ‘è§‰å¾—è¿™éƒ¨åˆ†æ‰æ˜¯è¿ç»´æœ€å–œæ¬¢çš„ã€‚è°ä¸å–œæ¬¢å†™ä»£ç å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1539822041,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"æ™æœˆ520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287683,"discussion_content":"ç°åœ¨æ¥çœ‹ è¿ç»´äººå‘˜ä¹Ÿè¦å­¦ä¹ python å’Œgoäº†  å¿ƒç¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593509438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33261,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1539767796,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"207698198004","product_id":100015201,"comment_content":"ä¸€èˆ¬æ¥è¯´ï¼Œæ‰©å±•api server (æˆ–è€…è¯´æ·»åŠ è‡ªå®šä¹‰ resource )æœ‰ä¸¤ç§æ–¹å¼ï¼š<br>1. é€šè¿‡åˆ›å»ºCRDs, ä¸»API serverå¯ä»¥å¤„ç† CRDs çš„ REST è¯·æ±‚ï¼ˆCRUDï¼‰å’ŒæŒä¹…æ€§å­˜å‚¨ã€‚ç®€å•ï¼Œä¸éœ€è¦å…¶ä»–çš„ç¼–ç¨‹ã€‚æ›´é€‚ç”¨äºå£°æ˜å¼çš„APIï¼Œå’Œkubernetesé«˜åº¦é›†æˆç»Ÿä¸€ã€‚<br>2. API Aggregation, ä¸€ä¸ªç‹¬ç«‹çš„API serverã€‚ä¸»API serverå§”æ‰˜æ­¤ç‹¬ç«‹çš„API serverå¤„ç†è‡ªå®šä¹‰resourceã€‚ éœ€è¦ç¼–ç¨‹ï¼Œä½†èƒ½å¤Ÿæ›´åŠ çµæ´»çš„æ§åˆ¶APIçš„è¡Œä¸ºï¼Œæ›´åŠ çµæ´»çš„è‡ªå®šä¹‰å­˜å‚¨ï¼Œä»¥åŠä¸APIä¸åŒç‰ˆæœ¬ä¹‹é—´çš„è½¬æ¢ã€‚ä¸€èˆ¬æ›´é€‚ç”¨äºå‘½ä»¤æ¨¡å¼ï¼Œæˆ–è€…å¤ç”¨å·²ç»å­˜åœ¨REST APIä»£ç ï¼Œä¸ç›´æ¥æ”¯æŒkubectl å’Œ k8s UI, ä¸æ”¯æŒscope resource in a cluster&#47;namespace.<br><br>è‡ªå®šä¹‰ resource å¯ä»¥ä½¿ä½ æ–¹ä¾¿çš„å­˜å–ç»“æ„åŒ–çš„resource æ•°æ®ã€‚ä½†æ˜¯åªæœ‰å’Œcontrollerç»„åˆåœ¨ä¸€èµ·æ‰æ˜¯å£°æ˜å¼APIã€‚å£°æ˜å¼APIå…è®¸ä½ å®šä¹‰ä¸€ä¸ªæœŸæœ›çš„çŠ¶æ€ã€‚controlleré€šè¿‡è§£è¯»ç»“æ„åŒ–çš„resourceæ•°æ®ï¼Œè·å¾—æœŸæœ›çŠ¶æ€ï¼Œä»è€Œä¸æ–­çš„è°ƒåæœŸæœ›çŠ¶æ€å’Œå®é™…çŠ¶æ€ã€‚<br><br>ç»¼ä¸Šï¼Œä»Šå¤©æ–‡æ¡£ä¸­çš„types.go åº”è¯¥æ˜¯ç»™controlleræ¥ç†è§£CRDsçš„schemaç”¨çš„ã€‚åªæœ‰æŒæ¡äº†resourceçš„schemaï¼Œæ‰èƒ½è§£é‡Šå¹¶å¾—åˆ°ç”¨æˆ·åˆ›å»ºçš„resource API objectã€‚<br>è€Œ kubectl create -f resourcedefinition.yaml æˆ–è€… è‡ªå®šä¹‰API serverï¼Œ åˆ™å®šä¹‰äº†RESTful API endpoint. ç”¨äºæ¥å— REST è¯·æ±‚ï¼Œæ”¹å˜ resource çš„æœŸæœ›çŠ¶æ€ã€‚<br>","like_count":49},{"had_liked":false,"id":35619,"user_name":"å°é‡‘åˆš","can_delete":false,"product_type":"c1","uid":1019593,"ip_address":"","ucode":"F5987C7F44EDA3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/c9/9f783069.jpg","comment_is_top":false,"comment_ctime":1540712979,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"156159535635","product_id":100015201,"comment_content":"å¯ä»¥ç”¨ kubebuild è‡ªåŠ¨ç”Ÿæˆé¡¹ç›®æ¡†æ¶ï¼Œæ·»åŠ è‡ªå·±çš„ CRD å¹¶å®ç° controller å³å¯ã€‚","like_count":37},{"had_liked":false,"id":41898,"user_name":"å°æ˜root","can_delete":false,"product_type":"c1","uid":1231573,"ip_address":"","ucode":"BE080897AC53DB","user_header":"https://static001.geekbang.org/account/avatar/00/12/ca/d5/a2cd57c9.jpg","comment_is_top":false,"comment_ctime":1542869408,"is_pvip":false,"discussion_count":9,"race_medal":0,"score":"151866724768","product_id":100015201,"comment_content":"æˆ‘æ˜¯è¿ç»´äººå‘˜ï¼Œæˆ‘å¾ˆå¿ƒç¢.....æˆ‘ä¸ä¼šgoè¯­è¨€","like_count":36,"discussions":[{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308466,"discussion_content":"æˆ‘æ˜¯ç¨‹åºå‘˜ï¼Œä½†ä¸ä¼šgo","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1600958609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207457,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6c/a1/80d83f0a.jpg","nickname":"Ellison","note":"","ucode":"A2FB94D4F6A332","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":331540,"discussion_content":"æˆ‘æ˜¯è¿ç»´äººå‘˜ï¼Œ æˆ‘å¾ˆå…´å¥‹ï¼Œ æˆ‘ä¼šgoå’Œpython","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1606896856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2405411,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b4/23/0e296758.jpg","nickname":"å§œå°§","note":"","ucode":"D813E046DD81E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364528,"discussion_content":"7å¹´å¼€å‘åˆšè½¬è¿ç»´ï¼Œæˆ‘ä¸ä¼šgoï¼Œä½†æˆ‘çŒœå¾ˆç®€å•ï¼Œå¸Œæœ›ä¸è¦æ‰“è„¸â€¦â€¦","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617508971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1740409,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/8e/79/f9d5dd3a.jpg","nickname":"å•è¶…","note":"","ucode":"B36883984BE16B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354317,"discussion_content":"ä¸ä¼šå°±å­¦å˜›ï¼Œè°è¿˜ä¸æ˜¯ä¸€è·¯ä¸ƒä¸ƒå…«å…«å­¦è¿‡æ¥çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1615274390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2405411,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b4/23/0e296758.jpg","nickname":"å§œå°§","note":"","ucode":"D813E046DD81E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589100,"discussion_content":"è¿‡äº†ä¸€å¹´åŠäº†ï¼Œå·²ç»å­¦ä¼šgolangäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664419247,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"è¾½å®"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1183711,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/df/e0eb437e.jpg","nickname":"æ— ç—•","note":"","ucode":"61B92B75092E4B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2405411,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b4/23/0e296758.jpg","nickname":"å§œå°§","note":"","ucode":"D813E046DD81E8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589947,"discussion_content":"è½¬è¿ç»´äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665409776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":589100,"ip_address":"æµ™æ±Ÿ"},"score":589947,"extra":""}]},{"author":{"id":1657948,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/5c/9ea0f752.jpg","nickname":"ç¨‹åºçŒ¿ä¸åœ†","note":"","ucode":"BC8926A84A07C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370372,"discussion_content":"åˆšä»è¶…å“¥çš„ã€Šè¶£è°ˆLinuxæ“ä½œç³»ç»Ÿã€‹è¿‡æ¥ï¼Œè‰°éš¾çš„å­¦åˆ°è¿™é‡Œæ‰çŸ¥é“å­¦ä¹ Kubernetesè¿˜è¦ä¼šgoï¼Œåªèƒ½å«æ³ªæ»šå»å­¦goäº†......","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619394508,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1785821,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3f/dd/f918566d.jpg","nickname":"å¤ç›®","note":"","ucode":"038B4FDFE8A306","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1657948,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/5c/9ea0f752.jpg","nickname":"ç¨‹åºçŒ¿ä¸åœ†","note":"","ucode":"BC8926A84A07C8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543055,"discussion_content":"å­¦ä¹ ä¸€ç‚¹åŸºç¡€è¯­æ³•å°±å¤Ÿäº†å¦‚æœæœ‰å…¶ä»–è¯­è¨€åŸºç¡€ï¼Œä¸€å¤©çš„æ—¶é—´å°±èƒ½æŠŠåŸºç¡€è¯­æ³•çœ‹å®Œï¼Œæ²¡å¿…è¦æŠŠæ‰€æœ‰å†…å®¹éƒ½çœ‹ä¸€éã€‚æˆ‘åœ¨èœé¸Ÿä¸Šé¢å­¦çš„ https://www.runoob.com/go/go-structures.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640940246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":370372,"ip_address":""},"score":543055,"extra":""}]},{"author":{"id":1805809,"avatar":"","nickname":"ccz å¼€å‘(è°¢ä¸é‚€)","note":"","ucode":"B8803B050AAC68","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343901,"discussion_content":"ç¢ç¢å¹³å®‰~ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611212165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33176,"user_name":"åƒå¯»","can_delete":false,"product_type":"c1","uid":1058635,"ip_address":"","ucode":"44A559E38819C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/4b/170654bb.jpg","comment_is_top":false,"comment_ctime":1539756408,"is_pvip":false,"replies":[{"id":"12035","content":"å› ä¸ºç”Ÿæˆçš„ä»£ç æ˜¯ç»™ä¸‹ä¸€ç¯‡å†™æ§åˆ¶å™¨ä»£ç ç”¨çš„ï¼Œå“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539783708,"ip_address":"","comment_id":33176,"utype":1}],"discussion_count":5,"race_medal":0,"score":"108913938808","product_id":100015201,"comment_content":"æˆ‘ä»ä»£ç å¼€å§‹ï¼Œå°±æŒ‰ç€æ­¥éª¤èµ°ï¼Œæœ€ååˆ›å»ºnetworkçš„CRDå’Œexample-networkéƒ½æˆåŠŸäº†ï¼Œ<br>ä½†æ˜¯æˆ‘ç›´æ¥å°†cdr&#47;network.ymlå’Œexample&#47;example-network.ymlæ–‡ä»¶å•ç‹¬æ‹¿å‡ºæ¥ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œä»£ç ç”Ÿæˆé‚£äº›æ­¥éª¤ï¼Œå‘ç°ä¹Ÿåˆ›å»ºæˆåŠŸäº†ï¼Œæå¾—æœ‰ç‚¹æ‡µã€‚<br>è€å¸ˆå¯ä»¥è¯´ä¸€ä¸‹è¿™å¤§æ¦‚æ˜¯ä»€ä¹ˆå›äº‹å—ï¼Ÿ","like_count":26,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426947,"discussion_content":"å› ä¸ºç”Ÿæˆçš„ä»£ç æ˜¯ç»™ä¸‹ä¸€ç¯‡å†™æ§åˆ¶å™¨ä»£ç ç”¨çš„ï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539783708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1500888,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e6/d8/8939848a.jpg","nickname":"Andy","note":"","ucode":"E895030BE6D4CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536738,"discussion_content":"è€å¸ˆ ä½ å¤ªè°ƒçš®äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638860171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":426947,"ip_address":""},"score":536738,"extra":""}]},{"author":{"id":1797584,"avatar":"","nickname":"å¶å³¥ç‘¶","note":"","ucode":"170E0F29BC6D4D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348717,"discussion_content":"æ‰€ä»¥ä¸ºå•¥ä¸è¯´æ¸…æ¥šå‘¢ ç§€äº†åŠå¤©çš„ä»£ç æœ€åå‘ç°æ²¡å•¥ç”¨","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1612688474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"å›¢","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533889,"discussion_content":"å¦‚æœä»£ç åœ¨è¿™é‡Œæ²¡ç”¨ã€‚é‚£èµ„æºçš„å­—æ®µå®šä¹‰éƒ½åœ¨ä»£ç é‡Œï¼Œå¦‚æœæ²¡æœ‰ä»£ç é‚£éƒ¨åˆ†ï¼Œåªéƒ¨ç½²ä¸¤ä¸ªyamlï¼Œé‚£validationé‚£æ­¥ï¼Œå¯¹å­—æ®µçš„æ ¡éªŒæ˜¯å¦‚ä½•é€šè¿‡çš„?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638011894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2524415,"avatar":"https://static001.geekbang.org/account/avatar/00/26/84/ff/419e9e68.jpg","nickname":"Cara","note":"","ucode":"AAD0FCC3B8BBB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377399,"discussion_content":"å“ˆå“ˆå“ˆä½ ç»™æˆ‘çœ‹ç¬‘äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622627552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63762,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":false,"comment_ctime":1548490789,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"74562934821","product_id":100015201,"comment_content":"æˆ‘æ˜¯å¼€å‘äººå‘˜ï¼Œä¼šgo,ä¹Ÿä¼šC++ï¼Œä¹Ÿè‡ªå·±è®¾è®¡è¿‡ä¸šåŠ¡åè®®ï¼Œçœ‹åˆ°è¿™ç¯‡å¼‚å¸¸å…´å¥‹","like_count":17,"discussions":[{"author":{"id":1482350,"avatar":"https://static001.geekbang.org/account/avatar/00/16/9e/6e/6ba20b5a.jpg","nickname":"Song","note":"","ucode":"6409701195771A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555401,"discussion_content":"å¤ªå·äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646893343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277063,"user_name":"Vndi","can_delete":false,"product_type":"c1","uid":2114744,"ip_address":"","ucode":"23DA6A7BE63E9F","user_header":"https://static001.geekbang.org/account/avatar/00/20/44/b8/d5fe40fb.jpg","comment_is_top":false,"comment_ctime":1612251017,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48856891273","product_id":100015201,"comment_content":"CRDå°±åƒä½ å»æ•°æ®åº“å®šä¹‰ä¸€å¼ è¡¨ï¼ŒCRå°±åƒè¡¨é‡Œçš„è®°å½•","like_count":12},{"had_liked":false,"id":33096,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1539744747,"is_pvip":false,"replies":[{"id":"11984","content":"å½“ç„¶ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539745834,"ip_address":"","comment_id":33096,"utype":1}],"discussion_count":3,"race_medal":0,"score":"48784385003","product_id":100015201,"comment_content":"å¥½å¥½å¥½ã€‚ä¹‹å‰å­¦ä¹ è¿‡è¿™äº›å†…å®¹ï¼Œä½†æ˜¯å¾ˆä¸ç³»ç»Ÿï¼Œåªæ˜¯å¤§æ¦‚çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œå¾ˆå¤šç»†èŠ‚æ²¡æœ‰ç©¿èµ·æ¥ã€‚è·Ÿè€å¸ˆæ¯”èµ·æ¥ï¼Œæˆ‘å¤ªä¸å–„äºæ€»ç»“äº†ã€‚<br>ç£Šå“¥å¤§ç¥ï¼Œç­‰æˆ‘æŠŠä½ çš„è¯¾éƒ½å­¦ä¼šäº†ï¼Œèƒ½è·Ÿç€ä½ å¹²å—ï¼Ÿ<br><br>å¦å¤–æˆ‘çœ‹åˆ°æœ‰äººé—®éœ€è¦æŠŠä»£ç é‡æ–°ç¼–è¯‘è¿›k8sä¸­ä¹ˆï¼Ÿä¸éœ€è¦ã€‚ä½œä¸ºæ’ä»¶åº”è¯¥æ˜¯å¯ä»¥çƒ­æ’æ‹”çš„ã€‚æ¯”å¦‚service catalogï¼Œflannelï¼Œéƒ½ä¸è¦æ±‚ä½ é‡å¯k8sã€‚<br>åœ¨k8sé‡Œå®šä¹‰äº†ä½ çš„CRåï¼Œcontrollerå¯ä»¥ä½œä¸ºä¸€ä¸ªcontainerè·‘åœ¨k8sé›†ç¾¤é‡Œï¼Œæ¥å“åº”CRçš„å¢åˆ æ”¹ã€‚<br><br>","like_count":12,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426933,"discussion_content":"å½“ç„¶ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539745834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218367,"avatar":"https://static001.geekbang.org/account/avatar/00/12/97/3f/70f08a80.jpg","nickname":"SakuraTears","note":"","ucode":"998B20C428EA7B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554868,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646643659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1340211,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIh68mljZzz1SWJia94GaQ68tBE43zpCgHZsPJLEnlFl6uK49eEHdKdlutbItNKviaqOQ6kclMs1C0w/132","nickname":"herbxu","note":"","ucode":"AA6D45478D2A2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525,"discussion_content":"å¼ è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼›\nInitializersåœ¨1.4æ—¶å·²ç»è¢«ç¤¾åŒºåºŸå¼ƒï¼Œç›®å‰ä¸»è¦ä½¿ç”¨Mutating Admission Webhookæ¥æ³¨å…¥ï¼Œæˆ‘çœ‹å¹¶æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«çš„ï¼Œç¤¾åŒºåŸºäºä»€ä¹ˆåŸå› å»é™¤äº†Initializersã€‚æ€§èƒ½ï¼Œå¤æ‚åº¦å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561641335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33311,"user_name":"å°å®‡å®™","can_delete":false,"product_type":"c1","uid":1029649,"ip_address":"","ucode":"BBFFC39CB9E26F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/11/e8506a04.jpg","comment_is_top":false,"comment_ctime":1539778280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44489451240","product_id":100015201,"comment_content":"ç”¨CRDæ¥å¼€å‘å®šä¹‰è‡ªä¸»åŒ–çš„operator ï¼Œå°†æœ‰çŠ¶æ€çš„åº”ç”¨è‡ªåŠ¨åŒ–","like_count":10},{"had_liked":false,"id":57233,"user_name":"éª¨æ±¤é¸¡è›‹é¢","can_delete":false,"product_type":"c1","uid":1050002,"ip_address":"","ucode":"2AC141A523E710","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/92/b609f7e3.jpg","comment_is_top":false,"comment_ctime":1546693609,"is_pvip":true,"replies":[{"id":"22068","content":"å¯¹çš„ï¼Œå†…ç½®å’Œå¤–æŒ‚çš„åŒºåˆ«","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1548053840,"ip_address":"","comment_id":57233,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35906431977","product_id":100015201,"comment_content":"è‡ªå®šä¹‰resourceçš„Controller å•ç‹¬è¿è¡Œï¼Œåªæ˜¯é€šè¿‡client-go ä¸api äº¤äº’ï¼Ÿ æ˜¯å¦å¯ä»¥è®¤ä¸ºï¼Œk8så†…å»ºçš„Resource å¯¹åº”çš„Controllerï¼Œç”±Controller-manager ç»Ÿä¸€ç®¡ç†å‘¢ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435474,"discussion_content":"å¯¹çš„ï¼Œå†…ç½®å’Œå¤–æŒ‚çš„åŒºåˆ«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548053840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54888,"user_name":"yuanlinios","can_delete":false,"product_type":"c1","uid":1223176,"ip_address":"","ucode":"0861321E352FE0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/nhLS152kEs5J65bBpM2fzMn4agfoow8xibFzNSDcmo9Oiby2lNB4hWRcetRWFyY2y05IJu8GbkZer9BUiahtadU0w/132","comment_is_top":false,"comment_ctime":1545978119,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35905716487","product_id":100015201,"comment_content":".&#47;generate-groups.sh all &quot;$ROOT_PACKAGE&#47;pkg&#47;client&quot; &quot;$ROOT_PACKAGE&#47;pkg&#47;apis&quot; &quot;$CUSTOM_RESOURCE_NAME:$CUSTOM_RESOURCE_VERSION&quot;<br>Generating deepcopy funcs<br>F1228 01:11:20.543446    2908 deepcopy.go:866] Hit an unsupported type invalid type.<br>","like_count":8},{"had_liked":false,"id":32967,"user_name":"Vincen","can_delete":false,"product_type":"c1","uid":1218185,"ip_address":"","ucode":"1029A901EC7BA0","user_header":"https://static001.geekbang.org/account/avatar/00/12/96/89/9312b3a2.jpg","comment_is_top":false,"comment_ctime":1539738266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31604509338","product_id":100015201,"comment_content":"ä»kubernetesç”¨æˆ·åˆ°kubernetesç©å®¶æˆé•¿ä¸­...","like_count":7},{"had_liked":false,"id":65874,"user_name":"ç–¯ç‹‚çš„å°ä¼é¹…","can_delete":false,"product_type":"c1","uid":1029578,"ip_address":"","ucode":"3BB71C53382BAD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/ca/c3949f49.jpg","comment_is_top":false,"comment_ctime":1549714474,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27319518250","product_id":100015201,"comment_content":"æç¤º Hit an unsupported type invalid typeçš„åŒå­¦ï¼Œå¯ä»¥å…ˆå®‰è£…ä¸‹k8s.io&#47;apimachineryåŒ…ã€‚åº”è¯¥æ˜¯deepcopyæ‰¾ä¸åˆ°metav1.ObjectMetaå’Œmetav1.TypeMeta<br>go get -u k8s.io&#47;apimachinery","like_count":6},{"had_liked":false,"id":228490,"user_name":"DayDayUp","can_delete":false,"product_type":"c1","uid":1610552,"ip_address":"","ucode":"9C53659518AB74","user_header":"https://static001.geekbang.org/account/avatar/00/18/93/38/71615300.jpg","comment_is_top":false,"comment_ctime":1592710466,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"23067546946","product_id":100015201,"comment_content":"çœ‹äº†å¥½å…´å¥‹ï¼ŒçœŸçš„æ„Ÿè§‰è‡ªå·±èƒ½å¤Ÿä»ä¸€ä¸ªæ—è§‚è€…æ…¢æ…¢å˜æˆä¸€ä¸ªå¼€å‘è´¡çŒ®è€…","like_count":6},{"had_liked":false,"id":58525,"user_name":"Joe","can_delete":false,"product_type":"c1","uid":1033290,"ip_address":"","ucode":"79AC38C1F44D76","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c4/4a/c02c597b.jpg","comment_is_top":false,"comment_ctime":1547104123,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"23021940603","product_id":100015201,"comment_content":"Generating deepcopy funcs<br>F0110 15:05:38.168635   11946 deepcopy.go:866] Hit an unsupported type invalid type.<br><br>æŒ‰æ–‡æ¡£èµ°äº†ä¸€åŠï¼ŒæŠ¥é”™~ è¿™ä¸ªæ˜¯ä»€ä¹ˆé—®é¢˜å‘€ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1639496,"avatar":"","nickname":"joeycheng","note":"","ucode":"22917FA3BC0BAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":277628,"discussion_content":"å¯èƒ½æ˜¯goç‰ˆæœ¬çš„åŸå› ,ç”¨1.13+è¯•è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591084085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34675,"user_name":"Pixar","can_delete":false,"product_type":"c1","uid":1197659,"ip_address":"","ucode":"E653387BA8EA16","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/5b/07858c33.jpg","comment_is_top":false,"comment_ctime":1540257312,"is_pvip":false,"replies":[{"id":"12350","content":"ä½ æäº¤äº†ä¸€ä¸ªCR yamläº†ä¸æ˜¯ï¼Ÿåæ­£æ˜¯å­˜åœ¨etcdé‡Œï¼Œç»™ä½ è¿”å›å³å¯ã€‚ä¸è¿‡kubernetes å¹¶ä¸æ‡‚å­—æ®µçš„æ„æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540259719,"ip_address":"","comment_id":34675,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23015093792","product_id":100015201,"comment_content":"æœ‰ä¸€ä¸ªé—®é¢˜å¼ è€å¸ˆï¼Œä¸€ç›´ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šâ€¦ é€šè¿‡ crd åˆ›å»ºçš„è‡ªå®šä¹‰èµ„æºæˆ‘è¿˜å¹¶æ²¡æœ‰å®šä¹‰ä»–çš„ç»“æ„ï¼Œä¸ºä»€ä¹ˆå°±å¯ä»¥é€šè¿‡ kubectl get æ‹¿åˆ°è¿™ä¸ªèµ„æºçš„è¯¦æƒ…å‘¢ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427295,"discussion_content":"ä½ æäº¤äº†ä¸€ä¸ªCR yamläº†ä¸æ˜¯ï¼Ÿåæ­£æ˜¯å­˜åœ¨etcdé‡Œï¼Œç»™ä½ è¿”å›å³å¯ã€‚ä¸è¿‡kubernetes å¹¶ä¸æ‡‚å­—æ®µçš„æ„æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540259719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33597,"user_name":"swordholder","can_delete":false,"product_type":"c1","uid":1002569,"ip_address":"","ucode":"3D1361126AD3CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/49/d21c134f.jpg","comment_is_top":false,"comment_ctime":1539830564,"is_pvip":false,"replies":[{"id":"12081","content":"å› ä¸ºä½ è¿˜æ²¡æœ‰è°ƒç”¨ç”Ÿæˆçš„clientï¼Œregister.goæ˜¯å®¢æˆ·ç«¯ç”¨æ¥è¿›è¡Œåˆå§‹åŒ–çš„ä»£ç çš„ä¸€éƒ¨åˆ†ã€‚ä½ è¿™ä¸¤æ­¥åšå®Œï¼ŒæœåŠ¡ç«¯å·²ç»çŸ¥é“è¿™ä¸ªcrdäº†ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¾—æœ‰åŠæ³•çŸ¥é“å•Šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539850614,"ip_address":"","comment_id":33597,"utype":1}],"discussion_count":4,"race_medal":0,"score":"23014667044","product_id":100015201,"comment_content":"register.goä¼šå°†è‡ªå®šä¹‰Typeæ³¨å†Œåˆ°APIServerï¼Œé‚£register.goæœ¬èº«æ˜¯æ€ä¹ˆäº¤ç»™APIServerï¼Œç„¶åè¢«APIServerè°ƒç”¨æ³¨å†Œè¿‡ç¨‹çš„ï¼Ÿ<br><br>$ kubectl apply -f crd&#47;network.yaml<br>$ kubectl apply -f example&#47;example-network.yaml <br><br>æ‰§è¡Œå®Œè¿™ä¸¤æ­¥ï¼Œè‡ªå®šä¹‰çš„Newworkå¯¹è±¡è¢«åˆ›å»ºå‡ºæ¥ï¼Œæ€ä¹ˆæ„Ÿè§‰register.goå¹¶æ²¡æœ‰è¢«ç”¨åˆ°","like_count":6,"discussions":[{"author":{"id":1175329,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ef/21/69c181b8.jpg","nickname":"Rain","note":"","ucode":"603DFFAC6A3755","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302101,"discussion_content":"æ„Ÿè§‰è¿™é‡Œçš„é€»è¾‘æœ‰äº›æ··æ·†ï¼Œè¿™é‡Œå†™çš„ä»£ç åº”è¯¥éƒ½æ˜¯ç»™ä¸‹ä¸€ç¯‡è‡ªå®šä¹‰æ§åˆ¶å™¨ç”¨çš„ï¼Œè°ƒAPIåˆ›å»ºCRDå¯¹è±¡ï¼Œæœ¬èº«ä¸éœ€è¦ç¼–ç ã€‚register.goåœ¨ç”Ÿæˆçš„å®¢æˆ·ç«¯ä»£ç ä¸­ç”¨åˆ°äº†ï¼špkg/client/clientset/versioned/scheme/register.go","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1598788867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427008,"discussion_content":"å› ä¸ºä½ è¿˜æ²¡æœ‰è°ƒç”¨ç”Ÿæˆçš„clientï¼Œregister.goæ˜¯å®¢æˆ·ç«¯ç”¨æ¥è¿›è¡Œåˆå§‹åŒ–çš„ä»£ç çš„ä¸€éƒ¨åˆ†ã€‚ä½ è¿™ä¸¤æ­¥åšå®Œï¼ŒæœåŠ¡ç«¯å·²ç»çŸ¥é“è¿™ä¸ªcrdäº†ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¾—æœ‰åŠæ³•çŸ¥é“å•Šã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1539850614,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004666,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/54/7a/bf7e6f40.jpg","nickname":"Driveby","note":"","ucode":"81D7796F9277DB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576634,"discussion_content":"å°† go ç›¸å…³çš„ä»£ç ä»‹ç»æŒªåˆ°ä¸‹ä¸€ç¯‡å»ï¼Œèƒ½è§£å†³å¾ˆå¤šäººçš„ç–‘æƒ‘ã€‚\n\nè¯´ç™½äº† cr åƒä¸€ä¸ªåè®®ï¼Œapi server ä¸ controller éœ€è¦ä»¥åŒä¸€ç§åè®®æ¥ç†è§£ cr","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655714213,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2344081,"avatar":"https://static001.geekbang.org/account/avatar/00/23/c4/91/a017bf72.jpg","nickname":"coconut","note":"","ucode":"07B95C7A6AC2F7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572725,"discussion_content":"æˆ‘ä¹Ÿæ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼šæˆ‘æœ¬æ¥ä»¥ä¸ºNetwork apiå¯¹è±¡æ—¶POST /apis/samplecrd.k8s.io/v1/Networkæ—¶ï¼Œæ¥ç€apiserverä¼šè°ƒç”¨åˆ°register.goæ³¨å†Œçš„&#34;æ¥å£å®ç°&#34;ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652935464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323976,"user_name":"ä¸¶æµ·å£","can_delete":false,"product_type":"c1","uid":1002881,"ip_address":"","ucode":"F06707B787F3DB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/81/8dd164fb.jpg","comment_is_top":false,"comment_ctime":1638246951,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18818116135","product_id":100015201,"comment_content":"ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ cd åˆ° code-generator ç›®å½•å»æ‰§è¡Œä¼šæŠ¥é”™ï¼Œæ”¹æˆè¿™æ ·å°±å¥½äº†ï¼š<br># ä»£ç ç”Ÿæˆçš„å·¥ä½œç›®å½•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„é¡¹ç›®è·¯å¾„<br>ROOT_PACKAGE=&quot;github.com&#47;resouer&#47;k8s-controller-custom-resource&quot;<br># API Group<br>CUSTOM_RESOURCE_NAME=&quot;samplecrd&quot;<br># API Version<br>CUSTOM_RESOURCE_VERSION=&quot;v1&quot;<br># Code-Generator Directory<br>EXEC_DIR=$GOPATH&#47;src&#47;k8s.io&#47;code-generator<br><br># å®‰è£… k8s.io&#47;code-generator<br>go get -u k8s.io&#47;code-generator&#47;...<br><br># æ‰§è¡Œä»£ç è‡ªåŠ¨ç”Ÿæˆï¼Œå…¶ä¸­pkg&#47;clientæ˜¯ç”Ÿæˆç›®æ ‡ç›®å½•ï¼Œpkg&#47;apisæ˜¯ç±»å‹å®šä¹‰ç›®å½•<br>&quot;${EXEC_DIR}&quot;&#47;generate-groups.sh all &quot;$ROOT_PACKAGE&#47;pkg&#47;client&quot; &quot;$ROOT_PACKAGE&#47;pkg&#47;apis&quot; &quot;$CUSTOM_RESOURCE_NAME:$CUSTOM_RESOURCE_VERSION&quot; --go-header-file &quot;${EXEC_DIR}&quot;&#47;hack&#47;boilerplate.go.txt -v 10","like_count":5},{"had_liked":false,"id":34535,"user_name":"åœ£è¯ä½¿è€…","can_delete":false,"product_type":"c1","uid":1028183,"ip_address":"","ucode":"E59436F6392122","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b0/57/a84d633e.jpg","comment_is_top":false,"comment_ctime":1540200190,"is_pvip":false,"replies":[{"id":"12357","content":"è¿™æ˜¯ä¸ªè‡ªå·±çš„å¸®åŠ©åº“","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540260593,"ip_address":"","comment_id":34535,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18720069374","product_id":100015201,"comment_content":"è€å¸ˆï¼Œæˆ‘ç…§ç€ä½ çš„ä»£ç æ•²äº†ä¸€éï¼Œè¿™ä¸ªpkg&#47;signalsç›®å½•æ˜¯è‡ªå·±åˆ›å»ºçš„å—ï¼Ÿæˆ‘è¿™ä¸ªç”Ÿæˆå®Œä»£ç ä¹Ÿæ²¡æœ‰è¿™ä¸ªç›®å½•ã€‚","like_count":4,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427239,"discussion_content":"è¿™æ˜¯ä¸ªè‡ªå·±çš„å¸®åŠ©åº“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540260593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221043,"user_name":"waterjiao","can_delete":false,"product_type":"c1","uid":1283989,"ip_address":"","ucode":"74F2F75BF0CA6F","user_header":"https://static001.geekbang.org/account/avatar/00/13/97/95/aad51e9b.jpg","comment_is_top":false,"comment_ctime":1590390688,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"14475292576","product_id":100015201,"comment_content":"deepcopyçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿruntime.Objectæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯Networkè¿™ä¸ªèµ„æºåœ¨k8så®¢æˆ·ç«¯çš„å½¢æ€å‘¢ï¼Ÿ","like_count":4},{"had_liked":false,"id":213268,"user_name":"åˆ˜å°é¹","can_delete":false,"product_type":"c1","uid":1988055,"ip_address":"","ucode":"7DCD9A4705277A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/55/d7/67c517c0.jpg","comment_is_top":false,"comment_ctime":1588346552,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14473248440","product_id":100015201,"comment_content":"è€å¸ˆï¼Œå®¹å™¨æ˜¯å•è¿›ç¨‹æ¨¡å‹çš„ï¼Œé‚£åœ¨ä¸€ä¸ªå®¹å™¨ä¸­èƒ½è¿è¡Œå¤šä¸ªä¸åŒè¿›ç¨‹ä¹ˆï¼Ÿå¤šä¸ªç›¸åŒè¿›ç¨‹åˆå¯ä»¥ä¹ˆï¼Ÿ","like_count":3,"discussions":[{"author":{"id":2179383,"avatar":"https://static001.geekbang.org/account/avatar/00/21/41/37/b89f3d67.jpg","nickname":"æˆ‘åœ¨ç¡è§‰","note":"","ucode":"6503B611151D3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339187,"discussion_content":"å¯ä»¥ï¼Œä½†æ˜¯ä½ è¦å…ˆè¯´æ˜ä½ è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä»€ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609557363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32923,"user_name":"Joe Black","can_delete":false,"product_type":"c1","uid":1052528,"ip_address":"","ucode":"21FE222A286445","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/70/c8680841.jpg","comment_is_top":false,"comment_ctime":1539735709,"is_pvip":false,"replies":[{"id":"11972","content":"å½“ç„¶ä¸éœ€è¦ã€‚ä½ å°±æŒ‰æ–‡ç« é‡Œçš„æ­¥éª¤æ¥å°±å…¨å¦¥äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539743618,"ip_address":"","comment_id":32923,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14424637597","product_id":100015201,"comment_content":"è¿™ç« ä¼šè®©è¿ç»´äººå‘˜å¿ƒç¢çš„...å¹¸å¥½ä¿ºä¼šGoè¯­è¨€! <br>è¯·æ•™ä¸‹è¿™ä¸ªç”Ÿæˆçš„ä»£ç ï¼Œè¿˜å¾—åˆå¹¶åˆ°apiserverçš„ä»£ç æ ‘ä¸­å§ï¼Ÿè¿˜æ˜¯å¾—é‡æ–°ç¼–è¯‘apiserverå§ï¼Ÿæ¯•ç«ŸGoç›®å‰è¿˜æ²¡æœ‰åŠ¨æ€åŠ è½½æœºåˆ¶ã€‚","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426912,"discussion_content":"å½“ç„¶ä¸éœ€è¦ã€‚ä½ å°±æŒ‰æ–‡ç« é‡Œçš„æ­¥éª¤æ¥å°±å…¨å¦¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539743618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2589474,"avatar":"https://static001.geekbang.org/account/avatar/00/27/83/22/a44b65f5.jpg","nickname":"JamonJou","note":"","ucode":"C77E647E2FA7A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545176,"discussion_content":"å®é™…å°±æ˜¯ç±»ä¼¼ä½ åœ¨linuxç¯å¢ƒä¸‹ï¼Œä¸‹è½½äº†ä»£ç ï¼Œæœ¬åœ°ç¼–è¯‘åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚è¿™ä¸ªCRDä¹Ÿæ˜¯æœ¬é›†ç¾¤ä½¿ç”¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1641870895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322600,"user_name":"jason","can_delete":false,"product_type":"c1","uid":2680235,"ip_address":"","ucode":"0886E1D88BB7CC","user_header":"https://static001.geekbang.org/account/avatar/00/28/e5/ab/cece3199.jpg","comment_is_top":false,"comment_ctime":1637494731,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10227429323","product_id":100015201,"comment_content":"v1.22.2æ‰§è¡Œcreate -f network.yamlæŠ¥é”™ï¼Œerror validating &quot;network.yaml&quot;: error validating data: [ValidationError(CustomResourceDefinition.spec): unknown field &quot;version&quot;","like_count":2},{"had_liked":false,"id":136772,"user_name":"tuyu","can_delete":false,"product_type":"c1","uid":1448863,"ip_address":"","ucode":"B235325B541408","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132","comment_is_top":false,"comment_ctime":1569505759,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10159440351","product_id":100015201,"comment_content":"è€å¸ˆä½ å¥½, é—®ä¸€ä¸‹è¿™ä¸ªmetav1æ˜¯å•¥æ„æ€","like_count":2,"discussions":[{"author":{"id":2589474,"avatar":"https://static001.geekbang.org/account/avatar/00/27/83/22/a44b65f5.jpg","nickname":"JamonJou","note":"","ucode":"C77E647E2FA7A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545182,"discussion_content":"åç§°è€Œå·²ï¼ŒæŠŠmeta/v1ç”¨è¿™ä¸ªç”¨metav1æ¥ä»£æ›¿ï¼Œä»¥å…é‡åã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641870958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304001,"user_name":"limix","can_delete":false,"product_type":"c1","uid":1166614,"ip_address":"","ucode":"76401FF54AE0D8","user_header":"https://static001.geekbang.org/account/avatar/00/11/cd/16/981cc4f8.jpg","comment_is_top":false,"comment_ctime":1627179866,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5922147162","product_id":100015201,"comment_content":"æ ·ä¾‹ç¨‹åºä¸­çš„é€»è¾‘ï¼Œæœ¬åœ°æµ‹è¯•æ—¶ï¼Œå‘ç°äº†ä¸å°‘é—®é¢˜ï¼Œä¸è¿‡è¿™ä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯æˆ‘çœ‹äº†çœ‹å®˜æ–¹çš„æ–‡æ¡£ï¼Œå‘ç°æœ€æ–°çš„k8sç‰ˆæœ¬çš„Apiå¯¹è±¡çš„åˆ›å»ºå·²ç»å¯ä»¥é€šè¿‡openapi schemaæ¥å®ç°äº†ï¼Œä¹Ÿæ·»åŠ äº†webhookè½¬æ¢ï¼Œ1.16ç‰ˆæœ¬ä¹Ÿå·²ç»ç¨³å®šäº†ã€‚ç›®å‰æ¯”è¾ƒå›°æƒ‘æ–‡ç« ä¸­çš„å®ç°å’Œå½“å‰k8sæ–°ç‰¹æ€§çš„å…³ç³»~ æœ‰ä¸€ç§æ˜¯ä¸æ˜¯æˆ‘ç°åœ¨æ–‡ç« ä¸­çš„å®ç°å·²ç»ä¸æ¨èä½¿ç”¨äº†","like_count":1,"discussions":[{"author":{"id":1675456,"avatar":"https://static001.geekbang.org/account/avatar/00/19/90/c0/91df1add.jpg","nickname":"Lambo","note":"","ucode":"B49DA767A4F439","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387063,"discussion_content":"åŒæ ·çš„é—®é¢˜ï¼Œå¸Œæœ›èƒ½æœ‰äººè§£ç­”~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627967373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142874,"user_name":"Geek_260c9a","can_delete":false,"product_type":"c1","uid":1602233,"ip_address":"","ucode":"6A95A19F12ECB5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoxRRRXqZ3FjR7kaeTmj73C6zjeX8SWDX70Tg0OOBG44vQ4Xtr7xphVeHhdtp6RwbwrTMfaOFTkRQ/132","comment_is_top":false,"comment_ctime":1571571951,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5866539247","product_id":100015201,"comment_content":"æ²¡æœ‰å¼„æ˜ç™½ç”Ÿæˆè¿™äº›ä»£ç å’ŒCRDå¯ä»¥è¢«k8s è¯†åˆ«çš„å¿…ç„¶è”ç³»ã€‚","like_count":1,"discussions":[{"author":{"id":1195204,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg","nickname":"è‰¾åˆ©ç‰¹-G","note":"","ucode":"8C4DA0ABE77CDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203033,"discussion_content":"ä¸ªäººç†è§£ï¼Œå°±è·Ÿç¼–ç¨‹æ€æƒ³é‡Œçš„åå°„æ¦‚å¿µç›¸ä¼¼ã€‚æäº¤äº†ä¸€ä¸ªyamlç»™API serverï¼Œå°±æ³¨å†Œäº†ç›¸å…³å¯¹è±¡çš„URLå’Œå±æ€§è¿›å»äº†ï¼Œå¤§å¤šwebæ¡†æ¶ä¹Ÿæ˜¯åœ¨é…ç½®æ–‡ä»¶é‡Œå®šä¹‰URLç„¶åå†å¦å†™ä¸€ä¸ªç±»æ¥å®ç°é‡Œé¢çš„é€»è¾‘ã€‚\nè¿™é‡Œç”Ÿæˆçš„ä»£ç å°±åƒwebæ¡†æ¶ç”Ÿæˆçš„åŸºç¡€ä»£ç ä¸€æ ·ã€‚\næˆ‘æƒ³åº”è¯¥æ˜¯åœ¨operatorå†™å¥½ä¹‹åç¼–è¯‘æˆé•œåƒéƒ¨ç½²åœ¨é›†ç¾¤é‡Œï¼Œé€šè¿‡RBACç»™operatorçš„å®¹å™¨æˆäºˆæƒé™æ“ä½œè¿™é‡Œå®šä¹‰çš„CRï¼Œoperatorä¼°è®¡ä¹Ÿæ˜¯æœ‰æ¡†æ¶çš„ï¼Œå¯èƒ½è¿˜æœ‰k8sç»´æŠ¤çš„åŸºç¡€é•œåƒã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583986711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2121783,"avatar":"https://static001.geekbang.org/account/avatar/00/20/60/37/fdbacf02.jpg","nickname":"å«æˆ‘å°å¢","note":"","ucode":"A789E8407A0DBE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380603,"discussion_content":"CRDåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªapi resource, ä½†æ˜¯è¿™ä¸ªresourceå…·ä½“æœ‰ä»€ä¹ˆå«ä¹‰ï¼Œapi serveræ˜¯ä¸æ¸…æ¥šçš„ï¼Œå¦‚æœè¦æƒ³å…·ä½“è§£æè¿™ä¸ªapi resourceï¼Œé‚£ä¹ˆå°±éœ€è¦ä½ è‡ªå·±ç¼–å†™ä¸€ä¸ªcontroller, ä¹Ÿå°±æ˜¯æ–‡ç« ä¸­ç”Ÿæˆçš„ä»£ç ï¼Œè¿™ä¸ªä»£ç é€šè¿‡ç”Ÿæˆçš„clientå’Œapi serveré€šä¿¡ï¼Œç”Ÿæˆçš„clientå’Œapi serceré€šä¿¡é“¾æ¥æ—¶ä¼šæ³¨å†Œè‡ªå·±æƒ³è¦ä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯åœ¨register.goä¸­å®šä¹‰çš„ã€‚controlleræ‹¿åˆ°æ•°æ®åå°±å¯ä»¥å¯¹è¿™ä¸ªresourceè¿›è¡Œè°ƒåº¦äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1624602395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004666,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/54/7a/bf7e6f40.jpg","nickname":"Driveby","note":"","ucode":"81D7796F9277DB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576635,"discussion_content":"è¯´å®åœ¨çš„ï¼Œæ²¡æœ‰è”ç³»ï¼Œè¿™äº›ä»£ç æ˜¯ç»™ controller ä½¿ç”¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655714380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113987,"user_name":"åŠå¤œè°åœ¨çœ‹ç”µè§†","can_delete":false,"product_type":"c1","uid":1165314,"ip_address":"","ucode":"6C72D23B517BC7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/cjichzNjhghHD9DJEXCBrh5iagbSIepia3vshGhDy7le4aicnT9cKHvSC0iaDYnSeWg9S4SxAPaOlAJcmib2DRicvgeyA/132","comment_is_top":false,"comment_ctime":1563198518,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858165814","product_id":100015201,"comment_content":"CRDæ–¹å¼æ˜¯å¦èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å—ï¼Ÿ","like_count":1},{"had_liked":false,"id":73373,"user_name":"iuwai","can_delete":false,"product_type":"c1","uid":1071032,"ip_address":"","ucode":"4DC94CEFDE1A0F","user_header":"https://static001.geekbang.org/account/avatar/00/10/57/b8/cd055bed.jpg","comment_is_top":false,"comment_ctime":1551872760,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5846840056","product_id":100015201,"comment_content":"çœ‹åˆ°èƒ½å¯¹k8sè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œå¾ˆå…´å¥‹ï¼ä¸è¿‡ï¼Œè‡ªå®šä¹‰APIserveråœ¨å…·ä½“çš„å®è·µä¸­æœ‰å“ªäº›å®é™…çš„ç”¨é€”å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":67436,"user_name":"Charles","can_delete":false,"product_type":"c1","uid":1201560,"ip_address":"","ucode":"C8C8A4F2B6C20F","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/98/a49061ab.jpg","comment_is_top":false,"comment_ctime":1550146500,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5845113796","product_id":100015201,"comment_content":"è€å¸ˆ, ä½ è®²è¯¾ä¸­ä½¿ç”¨åˆ°çš„å®¹å™¨çš„é•œåƒæœ‰æ²¡æœ‰ç»Ÿä¸€çš„åœ°å€å¯ä»¥ç»™ä¸€ä¸‹, æ‰¾å¯¹åº”çš„é•œåƒçœŸå¿ƒä¸å®¹æ˜“å•Š","like_count":1},{"had_liked":false,"id":55445,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1546180854,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5841148150","product_id":100015201,"comment_content":"çœ‹åˆ°è¿™æŒºå…´å¥‹çš„ï¼Œæ„Ÿè§‰ rookã€etcd-operatorã€prometheus-operator åº”è¯¥éƒ½æ˜¯è¿™ä¹ˆåšçš„ã€‚","like_count":1},{"had_liked":false,"id":37850,"user_name":"zz@zz","can_delete":false,"product_type":"c1","uid":1108783,"ip_address":"","ucode":"87B2AD97471FBC","user_header":"https://static001.geekbang.org/account/avatar/00/10/eb/2f/63004f1a.jpg","comment_is_top":false,"comment_ctime":1541751590,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5836718886","product_id":100015201,"comment_content":"æŠ¥é”™ Generating deepcopy funcs<br>F1109 16:09:50.592462   59073 main.go:81] Error: Failed executing generator: some packages had errors:<br>type &quot;vendor&#47;k8s.io&#47;apimachinery&#47;pkg&#47;runtime.Object&quot; in k8s:deepcopy-gen:interfaces tag of type vendor&#47;k8s.io&#47;apimachinery&#47;pkg&#47;runtime.Object is not an interface, but: &quot;&quot;<br><br>go get -u k8s.io&#47;apimachinery åå¥½äº†","like_count":1},{"had_liked":false,"id":33401,"user_name":"è™è™â¤ï¸","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1539782666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5834749962","product_id":100015201,"comment_content":"ä»Šå¤©è¿™äº›ä»£ç ï¼ŒåŒ…æ‹¬ç”Ÿæˆçš„ä»£ç éƒ½æ˜¯controllerç”¨çš„ã€‚å…¶å®æ•´ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œå°±æ˜¯ä¸€ä¸ªsample controllerã€‚å¤§å®¶ç­‰ç€è€å¸ˆä¸‹å›åˆ†è§£å§ ï¼šï¼‰<br><br>é€šè¿‡è¯»ä»£ç å’Œæ³¨é‡Šï¼Œæˆ‘çš„ç†è§£æ˜¯ Controller è°ƒç”¨ register.go ä¸­ addToScheme æ–¹æ³•ï¼Œæ¥æ·»åŠ è‡ªå®šä¹‰ resource types(å®šä¹‰åœ¨types.goä¸­) åˆ° Schemeæ•°æ®ç»“æ„ä¸­ï¼Œå¹¶æŠŠSchemeä¼ å…¥eventRecorderã€‚è¿™æ ·recorderå°±å¯ä»¥ç”Ÿæˆå¹¶è®°å½•è‡ªå®šä¹‰ typesç›¸å…³çš„eventsäº†ã€‚å¹¶ä¸”å¯ä»¥æŠŠeventä¼ é€ç»™INFO logï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å°±æ˜¯æˆ‘ä»¬åœ¨describeé‡Œçœ‹åˆ°çš„eventså‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":33270,"user_name":"swordholder","can_delete":false,"product_type":"c1","uid":1002569,"ip_address":"","ucode":"3D1361126AD3CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4c/49/d21c134f.jpg","comment_is_top":false,"comment_ctime":1539769460,"is_pvip":false,"replies":[{"id":"12036","content":"ä½ ä»”ç»†çœ‹ä¸€ä¸‹apiserveré‚£å¼ å›¾ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539783745,"ip_address":"","comment_id":33270,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5834736756","product_id":100015201,"comment_content":"æ€ä¹ˆæ„Ÿè§‰register.goæ²¡æœ‰ç”¨åˆ°ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ—¶æœºæŠŠè‡ªå®šä¹‰Typeæ³¨å†Œåˆ°APIServerçš„ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426959,"discussion_content":"ä½ ä»”ç»†çœ‹ä¸€ä¸‹apiserveré‚£å¼ å›¾ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539783745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341069,"user_name":"æ±Ÿä¸œ","can_delete":false,"product_type":"c1","uid":1793475,"ip_address":"","ucode":"391A62BC7039B3","user_header":"https://static001.geekbang.org/account/avatar/00/1b/5d/c3/69019d24.jpg","comment_is_top":false,"comment_ctime":1649327069,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1649327069","product_id":100015201,"comment_content":"æ˜¯ä¸æ˜¯å¯ä»¥ç†è§£ä¸ºï¼šetcdä¸­æœ€ç»ˆå­˜å‚¨çš„æ˜¯ç”¨æˆ·æœ€åˆæäº¤çš„yml è€Œä¸æ˜¯apiserveråœ¨admissionå’Œvalidationåçš„apiå¯¹è±¡","like_count":0},{"had_liked":false,"id":337259,"user_name":"é©¬ä»¥","can_delete":false,"product_type":"c1","uid":1344431,"ip_address":"","ucode":"3FEA06CA14DE28","user_header":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","comment_is_top":false,"comment_ctime":1646723812,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1646723812","product_id":100015201,"comment_content":"å¦‚æœä½ ç”¨çš„æ˜¯æœ€æ–°ç‰ˆçš„kubenetesï¼Œå¹¶ä¸”é‡åˆ°äº†ä¸‹é¢è¿™ä¸ªé”™è¯¯-The CustomResourceDefinition &quot;networks.samplecrd.k8s.io&quot; is invalid<br>é‚£ä¹ˆè¯·æŠŠè¿™é‡Œçš„network.yamlçš„namespaceä¿®æ”¹ä¸‹ï¼Œä¸è¦ä½¿ç”¨k8s.ioæˆ–è€…kubernetes.ioåç¼€ï¼Œæ”¹ä¸º*.x-k8s.io;<br>å‚è€ƒæ–‡æ¡£åœ°å€ï¼šhttps:&#47;&#47;github.com&#47;kubernetes&#47;community&#47;blob&#47;master&#47;sig-architecture&#47;api-review-process.md#what-apis-need-to-be-reviewed<br><br>é™„èµ ä¸€ä¸‹æˆ‘çš„network.yamlæ–‡ä»¶å†…å®¹ï¼š<br><br>apiVersion: apiextensions.k8s.io&#47;v1<br>kind: CustomResourceDefinition<br>metadata:<br>  # name must match the spec fields below, and be in the form: &lt;plural&gt;.&lt;group&gt;<br>  name: networks.samplecrd.x-k8s.io<br>spec:<br>  # group name to use for REST API: &#47;apis&#47;&lt;group&gt;&#47;&lt;version&gt;<br>  group: samplecrd.x-k8s.io<br>  versions:<br>    - name: v1<br>      # Each version can be enabled&#47;disabled by Served flag.<br>      served: true<br>      # One and only one version must be marked as the storage version.<br>      storage: true<br>      schema:<br>        openAPIV3Schema:<br>          type: object<br>          properties:<br>            spec:<br>              type: object<br>              properties:<br>                cronSpec:<br>                  type: string<br>                image:<br>                  type: string<br>                replicas:<br>                  type: integer<br>  # either Namespaced or Cluster<br>  scope: Namespaced<br>  names:<br>    # plural name to be used in the URL: &#47;apis&#47;&lt;group&gt;&#47;&lt;version&gt;&#47;&lt;plural&gt;<br>    plural: networks<br>    # singular name to be used as an alias on the CLI and for display<br>    singular: network<br>    # kind is normally the CamelCased singular type. Your resource manifests use this.<br>    kind: Network<br>    shortNames:<br>    - nw","like_count":0,"discussions":[{"author":{"id":1346098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8a/32/ba870394.jpg","nickname":"é‚¢å“²æº","note":"","ucode":"0DF345FB61B069","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559215,"discussion_content":"ä½ çš„è¿™ä¸ªexample-network.yamlæ–‡ä»¶æœ‰éƒ¨åˆ†è¿˜æ˜¯ä¸æ­£ç¡®çš„ã€‚openAPIV3Schemaä¸­çš„specåº”è¯¥æ˜¯æè¿°cidrå’Œgatewayã€‚\n\næ­£ç¡®çš„æ ¼å¼å¦‚ä¸‹ï¼š\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: networks.samplecrd.x-k8s.io\nspec:\n  group: samplecrd.x-k8s.io\n  versions:\n    - name: v1\n      served: true\n      storage: true\n      schema:\n        openAPIV3Schema:\n          type: object\n          properties:\n            spec:\n              type: object\n              properties:\n                cidr:\n                  type: string\n                gateway:\n                  type: string\n  names:\n    kind: Network\n    singular: network\n    plural: networks\n    shortNames:\n      - nw\n  scope: Namespaced","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1648646973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1344431,"avatar":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","nickname":"é©¬ä»¥","note":"","ucode":"3FEA06CA14DE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1346098,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8a/32/ba870394.jpg","nickname":"é‚¢å“²æº","note":"","ucode":"0DF345FB61B069","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":559378,"discussion_content":"æ˜¯çš„ï¼Œæˆ‘åé¢æ”¹äº†ï¼Œæ²¡æœ‰æ›´æ–°ï¼Œå¤šè°¢æŒ‡æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648724903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":559215,"ip_address":""},"score":559378,"extra":""}]}]},{"had_liked":false,"id":335281,"user_name":"è±†è±†","can_delete":false,"product_type":"c1","uid":1275407,"ip_address":"","ucode":"97788B134C3212","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/0f/c7c8021d.jpg","comment_is_top":false,"comment_ctime":1645438637,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1645438637","product_id":100015201,"comment_content":"ä¹‹å‰æ­»ç£•è¿™ä¸€å—ï¼Œå•ƒä¸ä¸‹å»ã€‚è·³æ§½åï¼ŒåŒäº‹è·Ÿæˆ‘è¯´ï¼Œç›´æ¥ä¸Škubebuilderï¼Œæˆ‘ä¸æƒ³ï¼Œæˆ‘å°±æƒ³ææ‡‚ï¼Œå›è¿‡å¤´æ¥ï¼Œä¸€è¡Œä¸€è¡Œçš„çœ‹è¿™å‡ èŠ‚å…³äºoperatorçš„å¼€å‘ç« èŠ‚ï¼Œå°±æƒ³ææ¸…æ¥šå†…éƒ¨åŸç†ï¼Œç»ˆäºçœ‹æ‡‚äº†ï¼Œç»ˆäºææ˜ç™½äº†ã€‚","like_count":1,"discussions":[{"author":{"id":1675966,"avatar":"https://static001.geekbang.org/account/avatar/00/19/92/be/8de4e1fe.jpg","nickname":"kaizen","note":"","ucode":"313EEA97AEC7C3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576005,"discussion_content":"ä¸é”™ï¼Œçœ‹åˆ°kubebuilderï¼ŒæŸ¥äº†ä¸‹ä»€ä¹ˆä¸œè¥¿ï¼Œå¦‚è·è‡³å®ï¼ŒçŠ¹å¦‚ç¥åŠ©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655223012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333519,"user_name":"çªçªå¤´","can_delete":false,"product_type":"c1","uid":1063866,"ip_address":"","ucode":"5C2635ED6484F8","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/ba/3b30dcde.jpg","comment_is_top":false,"comment_ctime":1644393120,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1644393120","product_id":100015201,"comment_content":"å¾ˆå¤šk8sè¾…åŠ©ä¸šåŠ¡æ‰€éœ€çš„ä¸€äº›èµ„æºéƒ½å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å»æ³¨å†Œå£°æ˜ä½¿ç”¨äº†ï¼Œè€Œä¸éœ€è¦é¢å¤–çš„æ•°æ®å­˜å‚¨æœåŠ¡æ¥æ”¯æ’‘ï¼Œå¯¹äºè¿ç»´æˆ–è€…ç›¸å…³å¼€å‘äººå‘˜æ¥è¯´ç»å¯¹æ˜¯å¥½äº‹","like_count":0},{"had_liked":false,"id":332187,"user_name":"å£®å£®341914","can_delete":false,"product_type":"c1","uid":2400293,"ip_address":"","ucode":"CDBF8F49C8B3B2","user_header":"https://static001.geekbang.org/account/avatar/00/24/a0/25/35efee8e.jpg","comment_is_top":false,"comment_ctime":1643090439,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643090439","product_id":100015201,"comment_content":"æˆ‘è¿è¡Œgo get -u k8s.io&#47;code-generator&#47;... ä¼šæŠ¥é”™Your configuration specifies to merge with the ref &#39;refs&#47;heads&#47;master&#39;<br>from the remote, but no such ref was fetched. æœ‰åŒå­¦çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜å—","like_count":0},{"had_liked":false,"id":324983,"user_name":"è¿½é£ç­çš„äºº","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1638770804,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638770804","product_id":100015201,"comment_content":"ä¸º Kubernetes æ·»åŠ ä¸€ä¸ªåå« Network çš„ API èµ„æºç±»å‹ã€‚ä»è€Œè¾¾åˆ°äº†é€šè¿‡æ ‡å‡†çš„ kubectl create å’Œ get æ“ä½œï¼Œæ¥ç®¡ç†è‡ªå®šä¹‰ API å¯¹è±¡çš„ç›®çš„ã€‚","like_count":0},{"had_liked":false,"id":323602,"user_name":"å›¢","can_delete":false,"product_type":"c1","uid":1113864,"ip_address":"","ucode":"D56ABBCE4E4D90","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","comment_is_top":false,"comment_ctime":1638013197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638013197","product_id":100015201,"comment_content":"æœ‰ä¸€ä¸ªç–‘é—®ï¼ŒNetworkèµ„æºç±»å‹çš„å­—æ®µæ˜¯åœ¨goä»£ç é‡Œå®šä¹‰çš„ï¼Œåœ¨yamlæ–‡ä»¶é‡Œæ²¡çœ‹åˆ°å­—æ®µçš„å®šä¹‰ã€‚è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä»£ç è¿˜æ²¡æœ‰åšä»»ä½•æ‰§è¡Œï¼Œå°±é€šè¿‡ä¸¤ä¸ªyamlæ–‡ä»¶åˆ›å»ºäº†Networkèµ„æºå’Œå¯¹åº”çš„èµ„æºå¯¹è±¡ï¼Œä½†æ˜¯å‰é¢çš„è¯´åˆ›å»ºå¯¹è±¡æ—¶åœ¨validationé˜¶æ®µä¼šæ ¡éªŒå­—æ®µçš„æ­£ç¡®æ€§ï¼Œå¯è¿™æ—¶kubernetesæ€ä¹ˆçŸ¥é“å¯¹è±¡ä¸­åº”è¯¥æœ‰ä»€ä¹ˆå­—æ®µå‘¢ï¼Ÿå¦‚æœä¸çŸ¥é“å­—æ®µå®šä¹‰ï¼Œæ˜¯æ€ä¹ˆåšçš„validateï¼Œç„¶åå°†å¯¹è±¡å­˜å…¥registryå‘¢?","like_count":0},{"had_liked":false,"id":316070,"user_name":"é™ˆæ–¯ä½³","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1634120229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634120229","product_id":100015201,"comment_content":"ç¬¬äºŒåå››è¯¾:æ·±å…¥è§£æå£°æ˜å¼APIï¼ˆä¸€ï¼‰ï¼šAPIå¯¹è±¡çš„å¥¥ç§˜<br>åœ¨k8sä¸­ï¼Œä¸€ä¸ªAPIå¯¹è±¡åœ¨Etcdé‡Œå®Œæ•´çš„èµ„æºè·¯å¾„ï¼Œæ˜¯ç”±ï¼šGroupï¼ŒVersionå’ŒResourceç»„æˆã€‚å…¶ä¸­æ ¸å¿ƒAPIï¼Œæ¯”å¦‚Podã€Nodeç­‰ï¼Œä¸éœ€è¦Groupï¼ˆGroupæ˜¯â€œâ€ï¼‰","like_count":0},{"had_liked":false,"id":295135,"user_name":"æˆ‘æ‰æ˜¯ç–¯å­","can_delete":false,"product_type":"c1","uid":1899884,"ip_address":"","ucode":"87620FC7E1CB3A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/6ibZV11xYoMwUjRr8YOc1x9SPK0KbricciamhiazKnx7B46PDZXIU0gibH86IMNn73qcexhbtOny9srOG0Xw99sCrEg/132","comment_is_top":false,"comment_ctime":1622259692,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622259692","product_id":100015201,"comment_content":"go get -u k8s.io&#47;code-generator&#47;... æŠ¥é”™ ï¼ˆgo1.16.1 go1.14.2éƒ½è¯•è¿‡ï¼‰<br># k8s.io&#47;code-generator&#47;cmd&#47;applyconfiguration-gen&#47;generators<br>k8s.io&#47;code-generator@v0.21.1&#47;cmd&#47;applyconfiguration-gen&#47;generators&#47;openapi.go:116:40: cannot use info (type &quot;gopkg.in&#47;yaml.v2&quot;.MapSlice) as type *&quot;gopkg.in&#47;yaml.v3&quot;.Node in argument to openapi_v2.NewDocument<br>k8s.io&#47;code-generator@v0.21.1&#47;cmd&#47;applyconfiguration-gen&#47;generators&#47;openapi.go:116:66: not <br><br>enough arguments in call to compiler.NewContext<br>        have (string, nil)<br>        want (string, *&quot;gopkg.in&#47;yaml.v3&quot;.Node, *compiler.Context)<br>","like_count":0},{"had_liked":false,"id":290315,"user_name":"èµ·åºŠå›","can_delete":false,"product_type":"c1","uid":1473232,"ip_address":"","ucode":"E49429D6821A6F","user_header":"https://static001.geekbang.org/account/avatar/00/16/7a/d0/57d50170.jpg","comment_is_top":false,"comment_ctime":1619494880,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619494880","product_id":100015201,"comment_content":"# é—®é¢˜1ï¼šå®‰è£…k8s.io&#47;code-generatorï¼Œå¦‚æœå‡ºç°&quot;Hit an unsupported type invalid type for invalid type&quot;ï¼Œå°±åˆ æ‰é‡è£…ä¸€ä¸‹<br>[[ -d $GOPATH&#47;src&#47;k8s.io&#47;code-generator ]] || go get -u -d k8s.io&#47;code-generator&#47;...<br><br># é—®é¢˜2ï¼šå¦‚æœæ²¡æœ‰ç”Ÿæˆå“åº”çš„æ–‡ä»¶ï¼Œæ‰‹åŠ¨æ‰§è¡Œä¸‹å“åº”çš„generatorï¼Œå¹¶æ·»åŠ  -v 5 --alsologtostderrå‚æ•°<br># 2.1 å‘ç°é”™è¯¯ï¼šcould not import k8s.io&#47;klog&#47;v2 (Config.Importer.Import(k8s.io&#47;klog&#47;v2) returned nil but no error)<br># 2.1è§£å†³ï¼š cp -r $GOPATH&#47;pkg&#47;mod&#47;k8s.io&#47;klog&#47;v2@v2.8.0  $GOPATH&#47;src&#47;k8s.io&#47;klog&#47;v2<br># 2.2 é”™è¯¯ï¼š &#47;Users&#47;lzd&#47;.gvm&#47;pkgsets&#47;go1.16.3&#47;global&#47;src&#47;k8s.io&#47;apimachinery&#47;pkg&#47;apis&#47;meta&#47;v1&#47;register.go:57:2: cannot use &amp;(ListOptions literal) (value of type *ListOptions) as &quot;k8s.io&#47;apimachinery&#47;pkg&#47;runtime&quot;.Object value in array or slice literal: missing method DeepCopyObject<br># 2.2 è§£å†³ï¼štypes.goä¸Šçš„k8sæ³¨é‡Šä¸€å®šè¦æŒ¨ç€ç»“æ„ä½“&#47;&#47; +k8s:deepcopy-gen:interfaces=k8s.io&#47;apimachinery&#47;pkg&#47;runtime.Objectï¼Œä¸ç„¶å¯èƒ½æ²¡æœ‰åŒ¹é…ï¼Œä»¥è‡´äºæ²¡æœ‰ç”ŸæˆDeepCopyObject","like_count":0},{"had_liked":false,"id":289147,"user_name":"æ™“æ³¢","can_delete":false,"product_type":"c1","uid":1311843,"ip_address":"","ucode":"F65573FB3C0E51","user_header":"https://static001.geekbang.org/account/avatar/00/14/04/63/112780b3.jpg","comment_is_top":false,"comment_ctime":1618889655,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618889655","product_id":100015201,"comment_content":"ç”Ÿæˆcrdä»£ç çš„è„šæœ¬ï¼Œå…¶ä¸­<br># API Group<br>$ CUSTOM_RESOURCE_NAME=&quot;samplecrd&quot;<br><br>CUSTOM_RESOURCE_NAME å»ºè®®åº”è¯¥æ”¹åä¸ºï¼šCUSTOM_GROUP_NAMEï¼Œä¸ç„¶æ¯”è¾ƒå®¹æ˜“è¯¯å¯¼äºº","like_count":0},{"had_liked":false,"id":287668,"user_name":"ææ˜¾è‰¯","can_delete":false,"product_type":"c1","uid":1228340,"ip_address":"","ucode":"0A79CB419E4F89","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/34/de6d9ce7.jpg","comment_is_top":false,"comment_ctime":1618099402,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618099402","product_id":100015201,"comment_content":"è¿™äº›ç”Ÿæˆçš„è‡ªå®šä¹‰crdæ˜¯ç¼–è¯‘åˆ°api-serverè¿˜æ˜¯é‚£ä¸ªç»„ä»¶ï¼Ÿ","like_count":0},{"had_liked":false,"id":286699,"user_name":"å§œå°§","can_delete":false,"product_type":"c1","uid":2405411,"ip_address":"","ucode":"D813E046DD81E8","user_header":"https://static001.geekbang.org/account/avatar/00/24/b4/23/0e296758.jpg","comment_is_top":false,"comment_ctime":1617509301,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617509301","product_id":100015201,"comment_content":"è¿™ä¸ªåšå®Œäº†ï¼Œæ€ä¹ˆè®©å…¶ä»–äººä½¿ç”¨ï¼Ÿæœ‰dockerhubè¿™ç§å¯ä»¥pushçš„åœ°æ–¹å—","like_count":0},{"had_liked":false,"id":284845,"user_name":"å¢æ‰¿ç","can_delete":false,"product_type":"c1","uid":1672266,"ip_address":"","ucode":"80805A03308CA4","user_header":"https://static001.geekbang.org/account/avatar/00/19/84/4a/50940078.jpg","comment_is_top":false,"comment_ctime":1616495985,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1616495985","product_id":100015201,"comment_content":"å„ç§å§¿åŠ¿éƒ½è¯•è¿‡äº†ï¼Œæœ€åä¹‹åclientseté‡Œé¢çš„versionedèƒ½ç”Ÿæˆã€‚ã€‚ã€‚æ˜¯ä¸æ˜¯å’Œgoç‰ˆæœ¬æœ‰å…³ã€‚ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1698112,"avatar":"https://static001.geekbang.org/account/avatar/00/19/e9/40/912ecac1.jpg","nickname":"Y.","note":"","ucode":"E4736F6C40154F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361791,"discussion_content":"ä½ æ˜¯åªèƒ½ç”Ÿæˆclientsetä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616757783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284079,"user_name":"types","can_delete":false,"product_type":"c1","uid":2449777,"ip_address":"","ucode":"8B50927EF1804F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLDUJyeq54fiaXAgF62tNeocO3lHsKT4mygEcNoZLnibg6ONKicMgCgUHSfgW8hrMUXlwpNSzR8MHZwg/132","comment_is_top":false,"comment_ctime":1616058794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616058794","product_id":100015201,"comment_content":"è¯·æ•™ä¸ªé—®é¢˜ï¼ŒCRDå®šä¹‰äºŒäº†Group&#47;API&#47;Resouce.<br>æ­¤æ—¶ç›´æ¥é€šè¿‡CR yamlå¯ä»¥åˆ›å»ºå‡ºèµ„æºã€‚<br>è¯·é—®API Server å¦‚ä½•å¯¹CR çš„æ ¼å¼è¿›è¡Œæ ¡éªŒå‘¢ï¼Ÿï¼Ÿï¼Ÿ<br>æˆ‘å†™å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„å­—æ®µï¼ŒCRä¹Ÿèƒ½è¢«æ­£å¸¸åˆ›å»ºï¼Œä½†æ˜¯å¦‚æœæ˜¯POD&#47;Deploymentçš„yamlæ ¼å¼ä¸æ­£ç¡®ï¼Œkubectl apply ä¼šæç¤ºé”™è¯¯çš„ã€‚","like_count":0},{"had_liked":false,"id":281702,"user_name":"è½»å–ƒ","can_delete":false,"product_type":"c1","uid":1628795,"ip_address":"","ucode":"5D5989E3D4D84C","user_header":"https://static001.geekbang.org/account/avatar/00/18/da/7b/21cb1287.jpg","comment_is_top":false,"comment_ctime":1614852260,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1614852260","product_id":100015201,"comment_content":"æŒ‰ç…§è€å¸ˆçš„æ“ä½œï¼Œç”Ÿæˆäº†cilentåº“ï¼Œä½†æ˜¯æ²¡æœ‰ç”Ÿæˆdeepcopyä»£ç ï¼Œå¾ˆå¥‡æ€ª","like_count":0,"discussions":[{"author":{"id":2400293,"avatar":"https://static001.geekbang.org/account/avatar/00/24/a0/25/35efee8e.jpg","nickname":"å£®å£®341914","note":"","ucode":"CDBF8F49C8B3B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548220,"discussion_content":"æˆ‘ä¹Ÿæ˜¯ åç»­æœ‰è§£å†³å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643091094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1628795,"avatar":"https://static001.geekbang.org/account/avatar/00/18/da/7b/21cb1287.jpg","nickname":"è½»å–ƒ","note":"","ucode":"5D5989E3D4D84C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2400293,"avatar":"https://static001.geekbang.org/account/avatar/00/24/a0/25/35efee8e.jpg","nickname":"å£®å£®341914","note":"","ucode":"CDBF8F49C8B3B2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567592,"discussion_content":"æ²¡æœ‰å“¦å¯èƒ½æ˜¯æœ‰å˜åŒ–äº†å§ï¼Œæ–‡ç« æœ‰å¹´é™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650952532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":548220,"ip_address":""},"score":567592,"extra":""}]}]},{"had_liked":false,"id":267042,"user_name":"å†²å†²å†²","can_delete":false,"product_type":"c1","uid":1614908,"ip_address":"","ucode":"82F7D8829E3797","user_header":"https://static001.geekbang.org/account/avatar/00/18/a4/3c/e7e1c0f0.jpg","comment_is_top":false,"comment_ctime":1607580208,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1607580208","product_id":100015201,"comment_content":"Generating deepcopy funcs<br>Generating clientset for samplecrd:v1 at github.com&#47;resouer&#47;k8s-controller-custom-resource&#47;pkg&#47;client&#47;clientset<br>Generating listers for samplecrd:v1 at github.com&#47;resouer&#47;k8s-controller-custom-resource&#47;pkg&#47;client&#47;listers<br>Generating informers for samplecrd:v1 at github.com&#47;resouer&#47;k8s-controller-custom-resource&#47;pkg&#47;client&#47;informers<br><br>è¿™å››å¥æˆ‘åªæœ‰clienté‚£ä¸ªçœ‹åˆ°äº†æ•ˆæœï¼Œå…¶ä»–è¿˜æ˜¯ä¸€ç‚¹å˜åŒ–éƒ½æ²¡æœ‰ï¼Œæœ‰äººå’Œæˆ‘ä¸€æ ·ä¹ˆ","like_count":0,"discussions":[{"author":{"id":2400293,"avatar":"https://static001.geekbang.org/account/avatar/00/24/a0/25/35efee8e.jpg","nickname":"å£®å£®341914","note":"","ucode":"CDBF8F49C8B3B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548221,"discussion_content":"è§£å†³äº†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643091108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2558254,"avatar":"https://static001.geekbang.org/account/avatar/00/27/09/2e/9421273d.jpg","nickname":"ç”œæ©™","note":"","ucode":"AC98BAED91B43E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370969,"discussion_content":"æ‰€ä»¥è¿™ä¸ªæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619599115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1698112,"avatar":"https://static001.geekbang.org/account/avatar/00/19/e9/40/912ecac1.jpg","nickname":"Y.","note":"","ucode":"E4736F6C40154F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361794,"discussion_content":"è§£å†³äº†ä¹ˆï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616757958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266669,"user_name":"Marshall","can_delete":false,"product_type":"c1","uid":1476507,"ip_address":"","ucode":"0FB004E8163F44","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/9b/8bebc8b6.jpg","comment_is_top":false,"comment_ctime":1607434064,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1607434064","product_id":100015201,"comment_content":"è¿™é‡Œé¢çš„gopathæ˜¯apiserverçš„gopathå—","like_count":0,"discussions":[{"author":{"id":2156207,"avatar":"https://static001.geekbang.org/account/avatar/00/20/e6/af/acf4a949.jpg","nickname":"å±±å¤–é’å±±æ¥¼å¤–æ¥¼å¤–æ¥¼","note":"","ucode":"19FDB1FA5D394F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341202,"discussion_content":"ä¸æ˜¯å§\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610350123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253413,"user_name":"Geek_b6df54","can_delete":false,"product_type":"c1","uid":1655970,"ip_address":"","ucode":"55D7E998D83878","user_header":"","comment_is_top":false,"comment_ctime":1602731564,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602731564","product_id":100015201,"comment_content":"è¯·é—®ä¸€ä¸‹ï¼Œk8s project layout é‡Œçš„apiæ–‡ä»¶å¤¹å’Œapisæ–‡ä»¶å¤¹åœ¨æ¦‚å¿µä¸Šçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ","like_count":0},{"had_liked":false,"id":248869,"user_name":"æ±‚æ¸”","can_delete":false,"product_type":"c1","uid":1103671,"ip_address":"","ucode":"6EABC5A0C703C9","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/37/d8c8acdf.jpg","comment_is_top":false,"comment_ctime":1600339464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600339464","product_id":100015201,"comment_content":"ç”¨ Kubernetes éƒ¨ç½²äº† Kubernetesï¼Œæ˜¯æŒ‡æŠŠä¸€ä¸ªk8så½“åšç±»ä¼¼saltstackçš„å·¥å…·å»åšå…¶ä»–k8sçš„éƒ¨ç½²å§ï¼Ÿï¼","like_count":0},{"had_liked":false,"id":130328,"user_name":"Geek_603e81","can_delete":false,"product_type":"c1","uid":1338668,"ip_address":"","ucode":"FA9ECB1E6D707B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJerY3WgO21tR7ZTREl99rqII9YNIe2lAkTa53EL1UL4zOgId6o9FOnqLYERwania0m4pyslfkfeug/132","comment_is_top":false,"comment_ctime":1567426503,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567426503","product_id":100015201,"comment_content":".&#47;generate-groups.sh all &quot;github.com&#47;k8s-controller-custom-resource&#47;pkg&#47;client&quot;  &quot;gitbub.com&#47;k8s-controller-custom-resource&#47;pkg&#47;apis&quot; &quot;samplecrd:v1&quot; <br>Generating deepcopy funcs<br>.&#47;generate-groups.sh: line 71: GOPATH: unbound variable ä»£ç ç”Ÿæˆæœ‰é—®é¢˜ï¼Œæœ‰è°çŸ¥é“è¿™ä¹ˆæ€ä¹ˆè§£å†³ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":130019,"user_name":"Wiwen","can_delete":false,"product_type":"c1","uid":1156306,"ip_address":"","ucode":"91466C0AE76903","user_header":"https://static001.geekbang.org/account/avatar/00/11/a4/d2/c483b836.jpg","comment_is_top":false,"comment_ctime":1567352353,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567352353","product_id":100015201,"comment_content":"åº”è¯¥æ˜¯pkg&#47;apis&#47;samplecrd&#47;v1ä¸‹é¢æ·»åŠ doc.go, register.go types.goä¸‰ä¸ªæ–‡ä»¶å§","like_count":0},{"had_liked":false,"id":112885,"user_name":"Geek_92d7a9","can_delete":false,"product_type":"c1","uid":1546709,"ip_address":"","ucode":"EEA6F253A4F110","user_header":"","comment_is_top":false,"comment_ctime":1562837267,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562837267","product_id":100015201,"comment_content":"è¯·é—®æ˜¯æ‰§è¡Œ generate-group.sh æ™‚ï¼ŒæŠŠç›¸é—œçš„å®ä½œä¸¢ç»™API serverå—ï¼Ÿ æˆ‘çš„æ„æ€æ˜¯API server åœ¨ä½•æ—¶è·çŸ¥æœ‰æ–°å®šä¹‰çš„å¯¹è±¡...æœ‰ç‚¹ä¸å¤ªç¡®å®š<br>è°¢è°¢","like_count":0},{"had_liked":false,"id":67434,"user_name":"Charles","can_delete":false,"product_type":"c1","uid":1201560,"ip_address":"","ucode":"C8C8A4F2B6C20F","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/98/a49061ab.jpg","comment_is_top":false,"comment_ctime":1550146132,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550146132","product_id":100015201,"comment_content":"æ­£å¥½å­¦è¿‡go, å¯ä»¥æ´¾ä¸Šç”¨åœºäº†","like_count":0},{"had_liked":false,"id":55462,"user_name":"HHHumbert","can_delete":false,"product_type":"c1","uid":1300847,"ip_address":"","ucode":"04089DE3F0E093","user_header":"https://static001.geekbang.org/account/avatar/00/13/d9/6f/8f5a4f02.jpg","comment_is_top":false,"comment_ctime":1546187140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546187140","product_id":100015201,"comment_content":"typo: æ¥ç€ï¼Œæˆ‘éœ€è¦åœ¨ pkg&#47;apis&#47;samplecrd ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ª doc.go æ–‡ä»¶<br>åº”ä¸º: pkg&#47;apis&#47;samplecrd&#47;v1 ç›®å½•ä¸‹","like_count":0},{"had_liked":false,"id":36192,"user_name":"æ˜Ÿæ˜Ÿç‹","can_delete":false,"product_type":"c1","uid":1219635,"ip_address":"","ucode":"09C97283309BC4","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/33/45eea921.jpg","comment_is_top":false,"comment_ctime":1540972002,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540972002","product_id":100015201,"comment_content":"ç£Šå“¥é—®ä¸ªé—®é¢˜ï¼Œkubernetes.io é‡Œé¢è¯´auditå±äºaudit.k8s.io API group ä½†æ˜¯æˆ‘apiserverå¯åŠ¨é¡¹ä¸­æ·»åŠ  --runtime-config=audit.k8s.io&#47;v1alpha1å apiserverå¯åŠ¨ä¸äº† æŠ¥é”™ unknown api groups audit.k8s.ioğŸ˜£","like_count":0},{"had_liked":false,"id":34270,"user_name":"silver","can_delete":false,"product_type":"c1","uid":1186740,"ip_address":"","ucode":"908E3C8560D6E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/1b/b4/a6db1c1e.jpg","comment_is_top":false,"comment_ctime":1540079367,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1540079367","product_id":100015201,"comment_content":"resourceçš„å®šä¹‰é€šè¿‡CustomResourceDefinitionï¼Œè¿™æ˜¯å¦æ„å‘³k8såœ¨åˆ›å»ºresourceæ—¶åªèƒ½å¯¹fieldçš„typeè¿›è¡Œvalidation?æ¯”å¦‚è¯´å®ƒä¸èƒ½æ£€æŸ¥ä¸€ä¸ªfieldçš„æ•°å€¼ä¸ºç©ºæˆ–è¶…å‡ºæŸä¸ªæœ€å¤§å€¼?","like_count":0},{"had_liked":false,"id":33762,"user_name":"å°ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1229457,"ip_address":"","ucode":"4E20DFD3D4FF82","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/91/fba79b87.jpg","comment_is_top":false,"comment_ctime":1539874839,"is_pvip":false,"replies":[{"id":"12113","content":"å»ºè®®è¿˜æ˜¯å¤šå®è·µè¿™é‡Œè®²è§£çš„å†…å®¹","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539876071,"ip_address":"","comment_id":33762,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539874839","product_id":100015201,"comment_content":"è€å¸ˆå¥½ï¼Œä½œä¸ºä¸€ä¸ªè¿ç»´ï¼Œè§‰å¾—ä½ è®²çš„å†…å®¹å¥½æ·±ï¼Œå­¦å¾—å¥½åƒåŠ›ï¼Œä¸çŸ¥èƒ½å¦åˆ†äº«ä¸€äº›å®é™…ç”Ÿäº§ç¯å¢ƒçš„troubleshooting çš„æ¡ˆä¾‹å’Œæ€è·¯ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427042,"discussion_content":"å»ºè®®è¿˜æ˜¯å¤šå®è·µè¿™é‡Œè®²è§£çš„å†…å®¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539876071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33159,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1539751572,"is_pvip":false,"replies":[{"id":"12034","content":"å½“ç„¶æ˜¯ç»™ä¸‹ä¸€ç¯‡å†™controllerç”¨çš„","user_name":"ä½œè€…å›å¤","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1539783675,"ip_address":"","comment_id":33159,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1539751572","product_id":100015201,"comment_content":"è¯·é—®è€å¸ˆ é€šè¿‡é‚£ä¸ªCustomResourceDefinitionç›¸å…³çš„ymalæ–‡ä»¶å·²ç»å¯ä»¥æ­£å¸¸å®šä¹‰æŸ¥çœ‹crdäº† ä¸ºä»€ä¹ˆè¿˜éœ€è¦å†™ç›¸å…³çš„goä»£ç å‘¢ï¼Ÿç”Ÿæˆçš„clientsåˆæ˜¯ç»™è°ç”¨çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"å¼ ç£Š Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426944,"discussion_content":"å½“ç„¶æ˜¯ç»™ä¸‹ä¸€ç¯‡å†™controllerç”¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539783675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":33133,"user_name":"mgxian","can_delete":false,"product_type":"c1","uid":1014806,"ip_address":"","ucode":"7B7E77E6A83B87","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7c/16/4d1e5cc1.jpg","comment_is_top":false,"comment_ctime":1539748218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539748218","product_id":100015201,"comment_content":"å¯åŠ¨ä¸€ä¸ªæœåŠ¡ ï¼ˆdeployment+serviceï¼‰watch ç›¸å…³api å¤„ç†ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘","like_count":0}]}