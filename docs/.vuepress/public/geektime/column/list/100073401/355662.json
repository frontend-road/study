{"id":355662,"title":"07 | å†…å­˜ç®¡ç†åŸºç¡€ï¼šSparkå¦‚ä½•é«˜æ•ˆåˆ©ç”¨æœ‰é™çš„å†…å­˜ç©ºé—´ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>å¯¹äºSparkè¿™æ ·çš„å†…å­˜è®¡ç®—å¼•æ“æ¥è¯´ï¼Œå†…å­˜çš„ç®¡ç†ä¸åˆ©ç”¨è‡³å…³é‡è¦ã€‚ä¸šåŠ¡åº”ç”¨åªæœ‰å……åˆ†åˆ©ç”¨å†…å­˜ï¼Œæ‰èƒ½è®©æ‰§è¡Œæ€§èƒ½è¾¾åˆ°æœ€ä¼˜ã€‚</p><p>é‚£ä¹ˆï¼Œä½ çŸ¥é“Sparkæ˜¯å¦‚ä½•ä½¿ç”¨å†…å­˜çš„å—ï¼Ÿä¸åŒçš„å†…å­˜åŒºåŸŸä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Œå®ƒä»¬åˆæ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼Ÿä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘å°±ç»“åˆä¸€ä¸ªæœ‰è¶£çš„å°æ•…äº‹ï¼Œæ¥å’Œä½ æ·±å…¥æ¢è®¨ä¸€ä¸‹Sparkå†…å­˜ç®¡ç†çš„åŸºç¡€çŸ¥è¯†ã€‚</p><h2>å†…å­˜çš„ç®¡ç†æ¨¡å¼</h2><p>åœ¨ç®¡ç†æ–¹å¼ä¸Šï¼ŒSparkä¼šåŒºåˆ†<strong>å †å†…å†…å­˜</strong>ï¼ˆOn-heap Memoryï¼‰å’Œ<strong>å †å¤–å†…å­˜</strong>ï¼ˆOff-heap Memoryï¼‰ã€‚è¿™é‡Œçš„â€œå †â€æŒ‡çš„æ˜¯JVM Heapï¼Œå› æ­¤å †å†…å†…å­˜å®é™…ä¸Šå°±æ˜¯Executor JVMçš„å †å†…å­˜ï¼›å †å¤–å†…å­˜æŒ‡çš„æ˜¯é€šè¿‡Java Unsafe APIï¼ŒåƒC++é‚£æ ·ç›´æ¥ä»æ“ä½œç³»ç»Ÿä¸­ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚</p><p><strong>å…¶ä¸­ï¼Œå †å†…å†…å­˜çš„ç”³è¯·ä¸é‡Šæ”¾ç»Ÿä¸€ç”±JVMä»£åŠ³ã€‚</strong>æ¯”å¦‚è¯´ï¼ŒSparkéœ€è¦å†…å­˜æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼ŒJVMè´Ÿè´£ä»å †å†…åˆ†é…ç©ºé—´å¹¶åˆ›å»ºå¯¹è±¡ï¼Œç„¶åæŠŠå¯¹è±¡çš„å¼•ç”¨è¿”å›ï¼Œæœ€åç”±Sparkä¿å­˜å¼•ç”¨ï¼ŒåŒæ—¶è®°å½•å†…å­˜æ¶ˆè€—ã€‚åè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·ï¼ŒSparkç”³è¯·åˆ é™¤å¯¹è±¡ä¼šåŒæ—¶è®°å½•å¯ç”¨å†…å­˜ï¼ŒJVMè´Ÿè´£æŠŠè¿™æ ·çš„å¯¹è±¡æ ‡è®°ä¸ºâ€œå¾…åˆ é™¤â€ï¼Œç„¶åå†é€šè¿‡åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼ŒGCï¼‰æœºåˆ¶å°†å¯¹è±¡æ¸…é™¤å¹¶çœŸæ­£é‡Šæ”¾å†…å­˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/ca/6b7c27e8b2e02e2698a031ff871313ca.jpg?wh=2889*883\" alt=\"\" title=\"JVMå †å†…å†…å­˜çš„ç”³è¯·ä¸é‡Šæ”¾\"></p><p>åœ¨è¿™æ ·çš„ç®¡ç†æ¨¡å¼ä¸‹ï¼ŒSparkå¯¹å†…å­˜çš„é‡Šæ”¾æ˜¯æœ‰å»¶è¿Ÿçš„ï¼Œå› æ­¤ï¼Œå½“Sparkå°è¯•ä¼°ç®—å½“å‰å¯ç”¨å†…å­˜æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šé«˜ä¼°å †å†…çš„å¯ç”¨å†…å­˜ç©ºé—´ã€‚</p><!-- [[[read_end]]] --><p><strong>å †å¤–å†…å­˜åˆ™ä¸åŒï¼ŒSparké€šè¿‡è°ƒç”¨Unsafeçš„allocateMemoryå’ŒfreeMemoryæ–¹æ³•ç›´æ¥åœ¨æ“ä½œç³»ç»Ÿå†…å­˜ä¸­ç”³è¯·ã€é‡Šæ”¾å†…å­˜ç©ºé—´</strong>ï¼Œè¿™å¬ä¸Šå»æ˜¯ä¸æ˜¯å’ŒC++ç®¡ç†å†…å­˜çš„æ–¹å¼å¾ˆåƒå‘¢ï¼Ÿè¿™æ ·çš„å†…å­˜ç®¡ç†æ–¹å¼è‡ªç„¶ä¸å†éœ€è¦åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä¹Ÿå°±å…å»äº†å®ƒå¸¦æ¥çš„é¢‘ç¹æ‰«æå’Œå›æ”¶å¼•å…¥çš„æ€§èƒ½å¼€é”€ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œç©ºé—´çš„ç”³è¯·ä¸é‡Šæ”¾å¯ä»¥ç²¾ç¡®è®¡ç®—ï¼Œå› æ­¤Sparkå¯¹å †å¤–å¯ç”¨å†…å­˜çš„ä¼°ç®—ä¼šæ›´ç²¾ç¡®ï¼Œå¯¹å†…å­˜çš„åˆ©ç”¨ç‡ä¹Ÿæ›´æœ‰æŠŠæ¡ã€‚</p><p>ä¸ºäº†å¸®åŠ©ä½ æ›´è½»æ¾åœ°ç†è§£è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘æ¥ç»™ä½ è®²ä¸€ä¸ªå°æ•…äº‹ã€‚</p><h3>åœ°ä¸»æ‹›ç§Ÿï¼ˆä¸Šï¼‰ï¼šåœŸåœ°åˆ’åˆ†</h3><p>å¾ˆä¹…ä»¥å‰ï¼Œç‡•å±±è„šä¸‹æœ‰ä¸€ä¸ªå°æ‘åº„ï¼Œæ‘é‡Œæœ‰ä¸ªåœ°ä¸»ï¼Œåå«é»„å››éƒï¼Œå››éƒå®¶æœ‰è‰¯ç”°åƒé¡·ï¼Œæ–¹åœ†æ•°ç™¾é‡Œéƒ½æ˜¯ä»–çš„ç”°åœ°ã€‚é»„å››éƒå…»å°Šå¤„ä¼˜ï¼Œè‡ªç„¶ä¸ä¼šäº²è‡ªä¸‹åœ°ç§ç”°ï¼Œä¸è¿‡è¿™ä¹ˆå¤šç”°åœ°ä¹Ÿä¸èƒ½å°±è¿™ä¹ˆè’ç€ã€‚äºæ˜¯ï¼Œä»–æƒ³äº†ä¸ªåŠæ³•ï¼Œæ—¢ä¸ç”¨äº²è‡ªåŠ¨æ‰‹åˆèƒ½æ—¥è¿›æ–—é‡‘ï¼šæ”¶ç§Ÿå­ï¼</p><p>é»„å››éƒè™½ç„¶å¥½åƒæ‡’åšï¼Œä½†åœ¨ç®¡ç†ä¸Šè¿˜æ˜¯ç›¸å½“æœ‰ä¸€å¥—çš„ï¼Œä»–æŠŠç”°åœ°åˆ’åˆ†ä¸ºä¸¤å—ï¼Œä¸€å—å«â€œæ‰˜ç®¡ç”°â€ï¼Œå¦ä¸€å—å«â€œè‡ªç®¡ç”°â€ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåº„ç¨¼<strong>ä¸°æ”¶ä¹‹åï¼Œç”°åœ°éœ€è¦ç¿»åœŸã€æ•´å¹³ã€æ™¾æ™’</strong>ï¼Œæ¥å¹´æ‰èƒ½ç§ä¸‹ä¸€èŒ¬åº„ç¨¼ã€‚é‚£ä¹ˆï¼Œæ‰˜ç®¡ç”°æŒ‡çš„å°±æ˜¯ä¸°æ”¶ä¹‹åï¼Œç”±é»„å››éƒæ´¾ä¸“äººå¸®ä½ æå®šç¿»åœŸã€æ•´å¹³è¿™äº›çäº‹ï¼Œä¸ç”¨ä½ æ“å¿ƒã€‚ç›¸åº”çš„ï¼Œè‡ªç®¡ç”°çš„æ„æ€å°±æ˜¯åº„ç¨¼ä½ è‡ªå·±ç§ï¼Œç§‹æ”¶ä¹‹åçš„ç”°åœ°ä¹Ÿå¾—ä½ è‡ªå·±æ”¶æ‹¾ã€‚</p><p><strong>æ¯«æ— ç–‘é—®ï¼Œå¯¹ç§Ÿæˆ·æ¥è¯´æ‰˜ç®¡ç”°æ›´çœå¿ƒä¸€äº›ï¼Œè‡ªç®¡ç”°æ›´éº»çƒ¦ã€‚</strong>å½“ç„¶äº†ï¼Œç›¸æ¯”è‡ªç®¡ç”°ï¼Œæ‰˜ç®¡ç”°çš„ç§Ÿé‡‘è‡ªç„¶æ›´é«˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b1/31/b1a5fbe3701051126cb4e92yyfaeea31.jpg?wh=1626*1178\" alt=\"\" title=\"æ‰˜ç®¡ç”°ä¸è‡ªç®¡ç”°\"></p><p>é‚£ä¹ˆï¼Œè¿™ä¸ªæ•…äº‹ä¸­é»„å››éƒçš„æ‰˜ç®¡ç”°å°±æ˜¯å†…å­˜ç®¡ç†ä¸­çš„å †å†…å†…å­˜ï¼Œè‡ªç®¡ç”°ç±»æ¯”çš„åˆ™æ˜¯å †å¤–å†…å­˜ï¼Œç”°åœ°çš„ç¿»åœŸã€æ•´å¹³è¿™äº›æ“ä½œå®é™…ä¸Šå°±æ˜¯JVMä¸­çš„GCã€‚è¿™æ ·ç±»æ¯”èµ·æ¥æ˜¯ä¸æ˜¯æ›´å¥½ç†è§£äº†å‘¢ï¼Ÿ</p><h2>å†…å­˜åŒºåŸŸçš„åˆ’åˆ†</h2><p>æ•…äº‹å…ˆè®²åˆ°è¿™å„¿ï¼Œè®©æˆ‘ä»¬æš‚æ—¶å…ˆå›åˆ°Sparkçš„å†…å­˜ç®¡ç†ä¸Šã€‚ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“äº†Sparkå†…å­˜ç®¡ç†æœ‰å †å†…å’Œå †å¤–ä¸¤ç§æ¨¡å¼ï¼Œé‚£Sparkåˆæ˜¯æ€ä¹ˆåˆ’åˆ†å†…å­˜åŒºåŸŸçš„å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥è¯´è¯´å †å¤–å†…å­˜ã€‚SparkæŠŠå †å¤–å†…å­˜åˆ’åˆ†ä¸ºä¸¤å—åŒºåŸŸï¼šä¸€å—ç”¨äºæ‰§è¡Œåˆ†å¸ƒå¼ä»»åŠ¡ï¼Œå¦‚Shuffleã€Sortå’ŒAggregateç­‰æ“ä½œï¼Œè¿™éƒ¨åˆ†å†…å­˜å«åš<strong>Execution Memory</strong>ï¼›ä¸€å—ç”¨äºç¼“å­˜RDDå’Œå¹¿æ’­å˜é‡ç­‰æ•°æ®ï¼Œå®ƒè¢«ç§°ä¸º<strong>Storage Memory</strong>ã€‚</p><p>å †å†…å†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œå †å¤–å·®ä¸å¤šï¼ŒSparkä¹Ÿä¼šåˆ’åˆ†å‡ºç”¨äºæ‰§è¡Œå’Œç¼“å­˜çš„ä¸¤ä»½å†…å­˜ç©ºé—´ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒSparkåœ¨å †å†…è¿˜ä¼šåˆ’åˆ†å‡ºä¸€ç‰‡å«åš<strong>User Memory</strong>çš„å†…å­˜ç©ºé—´ï¼Œå®ƒç”¨äºå­˜å‚¨å¼€å‘è€…è‡ªå®šä¹‰æ•°æ®ç»“æ„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a4/8c/a4b793f305410ee12964740a4958ba8c.jpg?wh=2943*912\" alt=\"\" title=\"ä¸åŒå†…å­˜åŒºåŸŸçš„åˆ’åˆ†\"></p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒSparkåœ¨å †å†…è¿˜ä¼šé¢„ç•™å‡ºä¸€å°éƒ¨åˆ†å†…å­˜ç©ºé—´ï¼Œå«åš<strong>Reserved Memory</strong>ï¼Œå®ƒè¢«ç”¨æ¥å­˜å‚¨å„ç§Sparkå†…éƒ¨å¯¹è±¡ï¼Œä¾‹å¦‚å­˜å‚¨ç³»ç»Ÿä¸­çš„BlockManagerã€DiskBlockManagerç­‰ç­‰ã€‚</p><p>å¯¹äºæ€§èƒ½è°ƒä¼˜æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨å‰ä¸‰å—å†…å­˜çš„åˆ©ç”¨ç‡ä¸Šæœ‰æ¯”è¾ƒå¤§çš„å‘æŒ¥ç©ºé—´ï¼Œå› ä¸ºä¸šåŠ¡åº”ç”¨ä¸»è¦æ¶ˆè€—çš„å°±æ˜¯å®ƒä»¬ï¼Œä¹Ÿå³Execution memoryã€Storage memoryå’ŒUser memoryã€‚è€Œé¢„ç•™å†…å­˜æˆ‘ä»¬å´åŠ¨ä¸å¾—ï¼Œå› ä¸ºè¿™å—å†…å­˜ä»…æœåŠ¡äºSparkå†…éƒ¨å¯¹è±¡ï¼Œä¸šåŠ¡åº”ç”¨ä¸ä¼šæŸ“æŒ‡ã€‚</p><p>å¥½äº†ï¼Œä¸åŒå†…å­˜åŒºåŸŸçš„åˆ’åˆ†ä¸è®¡ç®—ï¼Œæˆ‘ä¹ŸæŠŠå®ƒä»¬æ€»ç»“åˆ°äº†ä¸‹é¢çš„è¡¨æ ¼ä¸­ï¼Œæ–¹ä¾¿ä½ éšæ—¶æŸ¥é˜…ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/19/87/19aae02eb53ba1ec3f4141cb662b7d87.jpeg?wh=1879*866\" alt=\"\"></p><h3>æ‰§è¡Œä¸ç¼“å­˜å†…å­˜</h3><p>åœ¨æ‰€æœ‰çš„å†…å­˜åŒºåŸŸä¸­ï¼Œæœ€é‡è¦çš„æ— ç–‘æ˜¯ç¼“å­˜å†…å­˜å’Œæ‰§è¡Œå†…å­˜ï¼Œè€Œå†…å­˜è®¡ç®—çš„ä¸¤å±‚å«ä¹‰ä¹Ÿå°±æ˜¯æ•°æ®é›†ç¼“å­˜å’ŒStageå†…çš„æµæ°´çº¿è®¡ç®—ï¼Œå¯¹åº”çš„å°±æ˜¯Storage Memoryå’ŒExecution Memoryã€‚</p><p>åœ¨Spark 1.6ç‰ˆæœ¬ä¹‹å‰ï¼ŒExecution Memoryå’ŒStorage Memoryå†…å­˜åŒºåŸŸçš„ç©ºé—´åˆ’åˆ†æ˜¯é™æ€çš„ï¼Œä¸€æ—¦ç©ºé—´åˆ’åˆ†å®Œæ¯•ï¼Œä¸åŒå†…å­˜åŒºåŸŸçš„ç”¨é€”å°±å›ºå®šäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä¾¿ä½ æ²¡æœ‰ç¼“å­˜ä»»ä½•RDDæˆ–æ˜¯å¹¿æ’­å˜é‡ï¼ŒStorage MemoryåŒºåŸŸçš„ç©ºé—²å†…å­˜ä¹Ÿä¸èƒ½ç”¨æ¥æ‰§è¡ŒShuffleä¸­çš„æ˜ å°„ã€æ’åºæˆ–èšåˆç­‰æ“ä½œï¼Œå› æ­¤å®è´µçš„å†…å­˜èµ„æºå°±è¢«è¿™ä¹ˆç™½ç™½åœ°æµªè´¹æ‰äº†ã€‚</p><p>è€ƒè™‘åˆ°é™æ€å†…å­˜åˆ’åˆ†æ½œåœ¨çš„ç©ºé—´æµªè´¹ï¼Œåœ¨1.6ç‰ˆæœ¬ä¹‹åï¼ŒSparkæ¨å‡ºäº†ç»Ÿä¸€å†…å­˜ç®¡ç†æ¨¡å¼ã€‚<strong>ç»Ÿä¸€å†…å­˜ç®¡ç†æŒ‡çš„æ˜¯Execution Memoryå’ŒStorage Memoryä¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–</strong>ï¼Œå°½ç®¡ä¸¤ä¸ªåŒºåŸŸç”±é…ç½®é¡¹spark.memory.storageFractionåˆ’å®šäº†åˆå§‹å¤§å°ï¼Œä½†åœ¨è¿è¡Œæ—¶ï¼Œç»“åˆä»»åŠ¡è´Ÿè½½çš„å®é™…æƒ…å†µï¼ŒStorage MemoryåŒºåŸŸå¯èƒ½è¢«ç”¨äºä»»åŠ¡æ‰§è¡Œï¼ˆå¦‚Shuffleï¼‰ï¼ŒExecution MemoryåŒºåŸŸä¹Ÿæœ‰å¯èƒ½å­˜å‚¨RDDç¼“å­˜ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ‰§è¡Œä»»åŠ¡ç›¸æ¯”ç¼“å­˜ä»»åŠ¡ï¼Œåœ¨å†…å­˜æŠ¢å ä¸Šæœ‰ç€æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚é‚£ä½ æœ‰æ²¡æœ‰æƒ³è¿‡è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬å¸¦ç€â€œæ‰“ç ´ç ‚é”…é—®åˆ°åº•â€çš„ç²¾ç¥ï¼Œå»æ¢ç´¢å…¶ä¸­æ›´æ·±å±‚æ¬¡çš„åŸå› ã€‚</p><p>é¦–å…ˆï¼Œæ‰§è¡Œä»»åŠ¡ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š<strong>ä¸€ç±»æ˜¯Shuffle Mapé˜¶æ®µçš„æ•°æ®è½¬æ¢ã€æ˜ å°„ã€æ’åºã€èšåˆã€å½’å¹¶ç­‰æ“ä½œï¼›å¦ä¸€ç±»æ˜¯Shuffle Reduceé˜¶æ®µçš„æ•°æ®æ’åºå’Œèšåˆæ“ä½œã€‚å®ƒä»¬æ‰€æ¶‰åŠçš„æ•°æ®ç»“æ„ï¼Œéƒ½éœ€è¦æ¶ˆè€—æ‰§è¡Œå†…å­˜</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆå‡è®¾ï¼Œæ‰§è¡Œä»»åŠ¡ä¸ç¼“å­˜ä»»åŠ¡åœ¨å†…å­˜æŠ¢å ä¸Šéµå¾ªâ€œå…¬æ­£ã€å…¬å¹³å’Œå…¬å¼€â€çš„ä¸‰åŸåˆ™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºè°æŠ¢å äº†å¯¹æ–¹çš„å†…å­˜ï¼Œå½“å¯¹æ–¹æœ‰éœ€è¦æ—¶éƒ½ä¼šç«‹å³é‡Šæ”¾ã€‚æ¯”å¦‚è¯´ï¼Œåˆšå¼€å§‹åŒæ–¹çš„é¢„è®¾æ¯”ä¾‹æ˜¯äº”äº”å¼€ï¼Œä½†å› ä¸ºç¼“å­˜ä»»åŠ¡åœ¨åº”ç”¨ä¸­æ¯”è¾ƒé åçš„ä½ç½®ï¼Œæ‰€ä»¥æ‰§è¡Œä»»åŠ¡å…ˆå æ®äº†80%çš„å†…å­˜ç©ºé—´ï¼Œå½“ç¼“å­˜ä»»åŠ¡è¿½èµ¶ä¸Šæ¥ä¹‹åï¼Œæ‰§è¡Œä»»åŠ¡å°±éœ€è¦é‡Šæ”¾30%çš„å†…å­˜ç©ºé—´è¿˜ç»™ç¼“å­˜ä»»åŠ¡ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‡è®¾é›†ç¾¤èŒƒå›´å†…æ€»å…±æœ‰80ä¸ªCPUï¼Œä¹Ÿå°±æ˜¯é›†ç¾¤åœ¨ä»»æ„æ—¶åˆ»çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›æ˜¯80ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡ã€‚åœ¨æŠ¢å äº†80%å†…å­˜çš„æƒ…å†µä¸‹ï¼Œ80ä¸ªCPUå¯ä»¥å……åˆ†åˆ©ç”¨ï¼Œæ¯ä¸ªCPUçš„è®¡ç®—è´Ÿè½½éƒ½æ˜¯æ¯”è¾ƒé¥±æ»¡çš„ï¼Œè®¡ç®—å®Œä¸€ä¸ªä»»åŠ¡ï¼Œå†å»è®¡ç®—ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</p><p>ä½†æ˜¯ï¼Œç”±äºæœ‰30%çš„å†…å­˜è¦å½’è¿˜ç»™ç¼“å­˜ä»»åŠ¡ï¼Œè¿™æ„å‘³ç€æœ‰30ä¸ªå¹¶è¡Œçš„æ‰§è¡Œä»»åŠ¡æ²¡æœ‰å†…å­˜å¯ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ä¼šæœ‰30ä¸ªCPUä¸€ç›´å¤„åœ¨I/O waitçš„çŠ¶æ€ï¼Œæ²¡æ³•å¹²æ´»ï¼å®è´µçš„CPUè®¡ç®—èµ„æºå°±è¿™ä¹ˆç™½ç™½åœ°æµªè´¹æ‰äº†ï¼Œç®€ç›´æ˜¯æš´æ®„å¤©ç‰©ã€‚</p><p>å› æ­¤ï¼Œç›¸æ¯”äºç¼“å­˜ä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡çš„æŠ¢å ä¼˜å…ˆçº§ä¸€å®šè¦æ›´é«˜ã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å¼„æ¸…æ¥šå…¶ä¸­çš„åŸå› å‘¢ï¼Ÿæˆ‘è®¤ä¸ºï¼Œåªæœ‰å¼„æ¸…æ¥šæŠ¢å ä¼˜å…ˆçº§çš„èƒŒåé€»è¾‘ï¼Œæˆ‘ä»¬æ‰èƒ½ç†è§£ä¸ºä»€ä¹ˆè¦åŒæ—¶è°ƒèŠ‚CPUå’Œå†…å­˜çš„ç›¸å…³é…ç½®ï¼Œä¹Ÿæ‰æœ‰å¯èƒ½åšåˆ°ä¸åŒç¡¬ä»¶èµ„æºä¹‹é—´çš„ååŒä¸å¹³è¡¡ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿›è¡Œæ€§èƒ½è°ƒä¼˜è¦è¾¾åˆ°çš„æœ€ç»ˆæ•ˆæœã€‚</p><p>ä¸è¿‡ï¼Œå³ä½¿æ‰§è¡Œä»»åŠ¡çš„æŠ¢å ä¼˜å…ˆçº§æ›´é«˜ï¼Œä½†å®ƒä»¬åœ¨æŠ¢å å†…å­˜çš„æ—¶å€™ä¸€å®šä¹Ÿè¦éµå¾ªæŸäº›è§„åˆ™ã€‚é‚£ä¹ˆï¼Œè¿™äº›è§„åˆ™å…·ä½“æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢ï¼Œå’±ä»¬å°±æ¥ç€ä»¥åœ°ä¸»æ‹›ç§Ÿçš„æ•…äº‹ä¸ºä¾‹ï¼Œæ¥è¯´è¯´Execution memoryå’ŒStorage memoryä¹‹é—´æœ‰å“ªäº›æœ‰è¶£çš„è§„åˆ™ã€‚</p><h3>åœ°ä¸»æ‹›ç§Ÿï¼ˆä¸‹ï¼‰ï¼šç§Ÿåœ°åè®®</h3><p>é»„å››éƒæ‹›ç§Ÿçš„å‘Šç¤ºè´´å‡ºå»æ²¡å¤šä¹…ï¼Œæ‘å­é‡Œå°±æœ‰ä¸¤ä¸ªå¹´å¯ŒåŠ›å¼ºçš„å°ä¼™å­æ¥ç§Ÿç§ç”°åœ°ã€‚ä¸€ä¸ªå«é»„å°ä¹™ï¼Œæ˜¯é»„å››éƒçš„è¿œæˆ¿äº²æˆšï¼Œå‰ä¸ä¹…æ¥æŠ•å¥”é»„å››éƒã€‚å¦ä¸€ä¸ªå«å¼ éº»å­ï¼Œè™½æ˜¯å…«è¾ˆè´«å†œï¼Œå°æ—¥å­è¿‡å¾—ä¹Ÿç®—æ˜¯è’¸è’¸æ—¥ä¸Šã€‚å¼ éº»å­æ‰“ç®—æŠŠç”°åœ°ç§Ÿè¿‡æ¥ç§äº›å°éº¦ã€ç‰ç±³è¿™æ ·çš„åº„ç¨¼ã€‚é»„å°ä¹™å°±ä¸è¿™ä¹ˆæƒ³ï¼Œè¿™å°å­æŒºæœ‰å•†ä¸šå¤´è„‘ï¼Œä»–æŠŠç”°åœ°ç§Ÿè¿‡æ¥å‡†å¤‡ç§æ£‰èŠ±ã€å’–å•¡è¿™ç±»ç»æµä½œç‰©ã€‚</p><p>ä¸¤ä¸ªäººæ‘©æ‹³æ“¦æŒéƒ½æƒ³å¹²å‡ºä¸€ç•ªäº‹ä¸šï¼Œæ¨ä¸å¾—æŠŠé»„å››éƒçš„åœ°å…¨éƒ½åŒ…åœ†ï¼åœ°ä¸æ„ç§Ÿï¼Œé»„å››éƒè‡ªç„¶æ˜¯æ»¡å¿ƒæ¬¢å–œï¼Œä½†çƒ¦æ¼ä¹Ÿæ¥è¸µè€Œè‡³ï¼šâ€œæ—¢è¦ç…§é¡¾å°ä¹™è¿™å­©å­ï¼Œåˆä¸èƒ½æ‰“å‡»éº»å­çš„ç§¯ææ€§ï¼Œå¾—æƒ³ä¸ªä¸‡å…¨ä¹‹ç­–â€ã€‚</p><p>äºæ˜¯ï¼Œä»–çœ¼ç ä¸€è½¬ï¼Œè®¡ä¸Šå¿ƒæ¥ï¼šâ€œæŒ‰ç†è¯´å‘¢ï¼Œå’±ä»¬ä¸ˆé‡åœŸåœ°ä¹‹åï¼Œåº”è¯¥åœ¨ä½ ä»¬ä¸­é—´åˆ’ä¸€é“å®çº¿ï¼Œå¥½åŒºåˆ†ç”°åœ°çš„å½’å±æƒã€‚ä¸è¿‡å‘¢ï¼Œæ¯•ç«Ÿéº»å­ä½ æ˜¯æœ¬æ‘çš„ï¼Œå°ä¹™è¿œé“è€Œæ¥ï¼Œè¿œæ¥å³æ˜¯å®¢å˜›ï¼å’±ä»¬å¯¹å°ä¹™è¿˜æ˜¯å¾—å¤šå°‘ç…§é¡¾ç€ç‚¹â€ã€‚å¼ éº»å­å¿ƒç”Ÿä¸æ‚¦ï¼šâ€œæ€ä¹ˆç…§é¡¾ï¼Ÿâ€</p><p>é»„å››éƒæ¥ç€è¯´ï¼šâ€œ<strong>å¾ˆç®€å•ï¼ŒæŠŠå®çº¿æ”¹ä¸ºè™šçº¿ï¼Œå¤šåŠ³è€…å¤šå¾—</strong>ã€‚åŸæœ¬å‘¢ï¼Œä½ ä»¬åº”è¯¥åœ¨åˆ†ç•Œçº¿åˆ’å®šçš„é‚£ç‰‡ç”°åœ°é‡Œå„è‡ªåŠ³ä½œã€‚ä¸è¿‡å‘¢ï¼Œä½ ä»¬äºŒäººçš„è¿›åº¦å„ä¸ç›¸åŒå˜›ï¼Œæ‰€ä»¥ï¼Œ<strong>å‹¤å¥‹çš„äººï¼Œè‡ªå·±çš„ç”°åœ°ç§æ»¡äº†ä¹‹åï¼Œå¯ä»¥è·¨è¿‡åˆ†ç•Œçº¿ï¼Œå»å ç”¨å¯¹æ–¹è¿˜åœ¨ç©ºç€çš„ç”°åœ°</strong>ã€‚â€</p><p>é»„å°ä¹™ä¸è§£åœ°é—®ï¼šâ€œå››èˆ…ï¼Œè¿™ä¸æ˜¯æ¯”è°ç§å¾—å¿«å—ï¼Ÿä¹Ÿæ²¡å¯¹æˆ‘ç‰¹æ®Šç…§é¡¾å•Šï¼â€å¼ éº»å­çœ‰é—´ä¹Ÿæ‹§äº†ä¸ªç–™ç˜©ï¼šâ€œå¦‚æœç§å¾—æ…¢çš„äººåæ¥å±…ä¸Šï¼Œæƒ³è¦æŠŠè¢«å çš„ç”°åœ°æ”¶å›å»ï¼Œåˆ°æ—¶å€™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿâ€</p><p>é»„å››éƒå¾—æ„é“ï¼šâ€œåˆšæ‰è¯´äº†ï¼Œå’±ä»¬å¤šå¤šç…§é¡¾å°ä¹™ã€‚æ‰€ä»¥<strong>å¦‚æœéº»å­å‹¤å¿«ã€å¹²æ´»ä¹Ÿå¿«ï¼Œå…ˆå äº†å°ä¹™çš„åœ°ï¼Œç§ä¸Šäº†å°éº¦ã€ç‰ç±³ï¼Œå°ä¹™åæ¥å±…ä¸Šï¼Œæƒ³è¦æ”¶å›è‡ªå·±çš„åœ°ï¼Œé‚£ä¹ˆæ²¡è¯´çš„ï¼Œéº»å­å¾—æŠŠå¤šå çš„åœ°è®©å‡ºæ¥ã€‚ä¸ç®¡åº„ç¨¼ç†Ÿæ²¡ç†Ÿï¼Œéº»å­éƒ½å¾—æŠŠåœ°é“²å¹³ï¼Œè¿˜ç»™äººå®¶å°ä¹™ç§æ£‰èŠ±ã€å’–å•¡</strong>â€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/92/cc/92a3a3b0d69935a9f9770675ed6428cc.jpg?wh=1858*1208\" alt=\"\" title=\"é»„å°ä¹™ä¸å¼ éº»å­çš„å åœ°åè®®\"></p><p>é»„å››éƒå·çœ¼çœ‹äº†çœ‹ä¸¤äººçš„ååº”ï¼Œç»§ç»­è¯´ï¼šâ€œ<strong>åè¿‡æ¥ï¼Œå¦‚æœå°ä¹™æ›´å‹¤å¿«ï¼Œå…ˆå äº†éº»å­çš„åœ°ï¼Œéº»å­åæ¥å±…ä¸Šï¼Œæƒ³è¦æ”¶å›ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå’±ä»¬å°±å¾—å¤šç…§é¡¾ç…§é¡¾å°ä¹™ã€‚å°ä¹™æœ‰æƒç»§ç»­å ç”¨éº»å­çš„åœ°ï¼Œç›´åˆ°åœ°ä¸Šç§çš„æ£‰èŠ±ã€å’–å•¡éƒ½ä¸°æ”¶äº†ï¼Œå†æŠŠå¤šå çš„åœ°è®©å‡ºæ¥</strong>ã€‚ä½ ä»¬äºŒä½çœ‹æ€ä¹ˆæ ·ï¼Ÿâ€</p><p>é»„å°ä¹™å¬äº†å¤§å–œã€‚å¼ éº»å­è™½ç„¶å¿ƒé‡Œä¸çˆ½ï¼Œä½†ä¹Ÿæ¸…æ¥šé»„å››éƒå’Œé»„å°ä¹™ä¹‹é—´çš„äº²æˆšå…³ç³»ï¼Œä¹Ÿä¸å¥½å†å¤šè¯´ä»€ä¹ˆï¼Œå¿ƒæƒ³ï¼šâ€œåæ­£æˆ‘å‹¤å¿«äº›ï¼Œå…ˆæŠŠåœ°ç§æ»¡ä¹Ÿå°±æ˜¯äº†â€ã€‚äºæ˜¯ï¼Œä¸‰æ–¹å‡»æŒä¸ºèª“ï¼Œå°±æ­¤è¾¾æˆåè®®ã€‚</p><p>å¥½å•¦ï¼Œåœ°ä¸»æ‹›ç§Ÿçš„æ•…äº‹åˆ°è¿™é‡Œå°±è®²å®Œäº†ã€‚ä¸éš¾å‘ç°ï¼Œé»„å°ä¹™çš„åœ°ç±»æ¯”çš„æ˜¯Execution Memoryï¼Œå¼ éº»å­çš„åœ°å…¶å®å°±æ˜¯Storage Memoryã€‚ä»–ä»¬ä¹‹é—´çš„åè®®å…¶å®å°±æ˜¯Execution Memoryå’ŒStorage Memoryä¹‹é—´çš„æŠ¢å è§„åˆ™ï¼Œä¸€å…±å¯ä»¥æ€»ç»“ä¸º3æ¡ï¼š</p><ul>\n<li><strong>å¦‚æœå¯¹æ–¹çš„å†…å­˜ç©ºé—´æœ‰ç©ºé—²ï¼ŒåŒæ–¹å°±éƒ½å¯ä»¥æŠ¢å ï¼›</strong></li>\n<li><strong>å¯¹äºRDDç¼“å­˜ä»»åŠ¡æŠ¢å çš„æ‰§è¡Œå†…å­˜ï¼Œå½“æ‰§è¡Œä»»åŠ¡æœ‰å†…å­˜éœ€è¦æ—¶ï¼ŒRDDç¼“å­˜ä»»åŠ¡å¿…é¡»ç«‹å³å½’è¿˜æŠ¢å çš„å†…å­˜ï¼Œæ¶‰åŠçš„RDDç¼“å­˜æ•°æ®è¦ä¹ˆè½ç›˜ã€è¦ä¹ˆæ¸…é™¤ï¼›</strong></li>\n<li><strong>å¯¹äºåˆ†å¸ƒå¼è®¡ç®—ä»»åŠ¡æŠ¢å çš„Storage Memoryå†…å­˜ç©ºé—´ï¼Œå³ä¾¿RDDç¼“å­˜ä»»åŠ¡æœ‰æ”¶å›å†…å­˜çš„éœ€è¦ï¼Œä¹Ÿè¦ç­‰åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰èƒ½é‡Šæ”¾ã€‚</strong></li>\n</ul><p>åŒæ—¶ï¼Œæˆ‘ä¹ŸæŠŠè¿™ä¸ªä¾‹å­ä¸­çš„å…³é”®å†…å®¹å’ŒSparkä¹‹é—´çš„å¯¹åº”å…³ç³»æ€»ç»“åœ¨äº†ä¸‹é¢ï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ åŠ æ·±å°è±¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/69/21/692d78990aa9481b56bcc28522e9df21.jpg?wh=7824*2126\" alt=\"\" title=\"åœ°ä¸»æ‹›ç§Ÿä¸Sparkçš„ç±»æ¯”å…³ç³»\"></p><h2>ä»ä»£ç çœ‹å†…å­˜æ¶ˆè€—</h2><p>è¯´å®Œäº†ç†è®ºï¼Œæ¥ä¸‹æ¥ï¼Œå’±ä»¬å†ä»å®æˆ˜å‡ºå‘ï¼Œç”¨ä¸€ä¸ªå°ä¾‹å­æ¥ç›´è§‚åœ°æ„Ÿå—ä¸€ä¸‹ï¼Œåº”ç”¨ä¸­ä»£ç çš„ä¸åŒéƒ¨åˆ†éƒ½æ¶ˆè€—äº†å“ªäº›å†…å­˜åŒºåŸŸã€‚</p><p>ç¤ºä¾‹ä»£ç å¾ˆç®€å•ï¼Œç›®çš„æ˜¯è¯»å–words.csvæ–‡ä»¶ï¼Œç„¶åå¯¹å…¶ä¸­æŒ‡å®šçš„å•è¯è¿›è¡Œç»Ÿè®¡è®¡æ•°ã€‚</p><pre><code>val dict: List[String] = List(â€œsparkâ€, â€œscalaâ€)\nval words: RDD[String] = sparkContext.textFile(â€œ~/words.csvâ€)\nval keywords: RDD[String] = words.filter(word =&gt; dict.contains(word))\nkeywords.cache\nkeywords.count\nkeywords.map((_, 1)).reduceByKey(_ + _).collect\n</code></pre><p>æ•´ä¸ªä»£ç ç‰‡æ®µåŒ…å«6è¡Œä»£ç ï¼Œå’±ä»¬ä»ä¸Šåˆ°ä¸‹é€ä¸€åˆ†æã€‚</p><p>é¦–å…ˆï¼Œç¬¬ä¸€è¡Œå®šä¹‰äº†dictå­—å…¸ï¼Œè¿™ä¸ªå­—å…¸åœ¨Driverç«¯ç”Ÿæˆï¼Œå®ƒåœ¨åç»­çš„RDDè°ƒç”¨ä¸­ä¼šéšç€ä»»åŠ¡ä¸€èµ·åˆ†å‘åˆ°Executorç«¯ã€‚ç¬¬äºŒè¡Œè¯»å–words.csvæ–‡ä»¶å¹¶ç”ŸæˆRDD wordsã€‚<strong>ç¬¬ä¸‰è¡Œå¾ˆå…³é”®ï¼Œç”¨dictå­—å…¸å¯¹wordsè¿›è¡Œè¿‡æ»¤ï¼Œæ­¤æ—¶dictå·²åˆ†å‘åˆ°Executorç«¯ï¼ŒExecutorå°†å…¶å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼Œç”¨äºå¯¹wordsæ•°æ®åˆ†ç‰‡ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ã€‚Dictå­—å…¸å±äºå¼€å‘è€…è‡ªå®šä¹‰æ•°æ®ç»“æ„ï¼Œå› æ­¤ï¼ŒExecutorå°†å…¶å­˜å‚¨åœ¨User MemoryåŒºåŸŸã€‚</strong></p><p>æ¥ç€ï¼Œç¬¬å››è¡Œå’Œç¬¬äº”è¡Œç”¨cacheå’Œcountå¯¹keywords RDDè¿›è¡Œç¼“å­˜ï¼Œä»¥å¤‡åç»­é¢‘ç¹è®¿é—®ï¼Œåˆ†å¸ƒå¼æ•°æ®é›†çš„ç¼“å­˜å ç”¨çš„æ­£æ˜¯Storage Memoryå†…å­˜åŒºåŸŸã€‚åœ¨æœ€åä¸€è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨keywordsä¸Šè°ƒç”¨reduceByKeyå¯¹å•è¯åˆ†åˆ«è®¡æ•°ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒreduceByKeyç®—å­ä¼šå¼•å…¥Shuffleï¼Œè€ŒShuffleè¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„å†…éƒ¨æ•°æ®ç»“æ„ï¼Œå¦‚æ˜ å°„ã€æ’åºã€èšåˆç­‰æ“ä½œæ‰€ä»°ä»—çš„Bufferã€Arrayå’ŒHashMapï¼Œéƒ½ä¼šæ¶ˆè€—Execution MemoryåŒºåŸŸä¸­çš„å†…å­˜ã€‚</p><p>ä¸åŒä»£ç ä¸å…¶æ¶ˆè€—çš„å†…å­˜åŒºåŸŸï¼Œæˆ‘éƒ½æ•´ç†åˆ°äº†ä¸‹é¢çš„è¡¨æ ¼ä¸­ï¼Œæ–¹ä¾¿ä½ æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a0/ff/a05f77a27aaaf21d9d064aa1ca1be3ff.jpeg?wh=1920*735\" alt=\"\"></p><h2>å°ç»“</h2><p>æ·±å…¥ç†è§£å†…å­˜ç®¡ç†çš„æœºåˆ¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬å……åˆ†åˆ©ç”¨åº”ç”¨çš„å†…å­˜ï¼Œæå‡å…¶æ‰§è¡Œæ€§èƒ½ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬é‡ç‚¹å­¦ä¹ äº†å†…å­˜ç®¡ç†çš„åŸºç¡€çŸ¥è¯†ã€‚</p><p><strong>é¦–å…ˆæ˜¯å†…å­˜çš„ç®¡ç†æ–¹å¼ã€‚</strong>SparkåŒºåˆ†å †å†…å†…å­˜å’Œå †å¤–å†…å­˜ï¼šå¯¹äºå †å¤–å†…å­˜æ¥è¯´ï¼ŒSparké€šè¿‡è°ƒç”¨Java Unsafeçš„allocateMemoryå’ŒfreeMemoryæ–¹æ³•ï¼Œç›´æ¥åœ¨æ“ä½œç³»ç»Ÿå†…å­˜ä¸­ç”³è¯·ã€é‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œç®¡ç†æˆæœ¬è¾ƒé«˜ï¼›å¯¹äºå †å†…å†…å­˜æ¥è¯´ï¼Œæ— éœ€Sparkäº²è‡ªæ“åˆ€è€Œæ˜¯ç”±JVMä»£ç†ã€‚ä½†é¢‘ç¹çš„JVM GCå¯¹æ‰§è¡Œæ€§èƒ½æ¥è¯´æ˜¯ä¸€å¤§éšæ‚£ã€‚å¦å¤–ï¼ŒSparkå¯¹å †å†…å†…å­˜å ç”¨çš„é¢„ä¼°å¾€å¾€ä¸å¤Ÿç²¾ç¡®ï¼Œé«˜ä¼°å¯ç”¨å†…å­˜å¾€å¾€ä¼šä¸ºOOMåŸ‹ä¸‹éšæ‚£ã€‚</p><p><strong>å…¶æ¬¡æ˜¯ç»Ÿä¸€å†…å­˜ç®¡ç†ï¼Œä»¥åŠExecution Memoryå’ŒStorage Memoryä¹‹é—´çš„æŠ¢å è§„åˆ™</strong>ã€‚å®ƒä»¬å°±åƒé»„å››éƒæ‹›ç§Ÿæ•…äº‹ä¸­é»„å°ä¹™å’Œå¼ éº»å­çš„ç”°åœ°ï¼ŒæŠ¢å è§„åˆ™å°±åƒä»–ä»¬ä¹‹é—´çš„å åœ°åè®®ï¼Œä¸»è¦å¯ä»¥åˆ†ä¸º3æ¡ï¼š</p><ul>\n<li>å¦‚æœå¯¹æ–¹çš„å†…å­˜ç©ºé—´æœ‰ç©ºé—²ï¼Œé‚£ä¹ˆåŒæ–¹éƒ½å¯ä»¥æŠ¢å ï¼›</li>\n<li>å¯¹RDDç¼“å­˜ä»»åŠ¡æŠ¢å çš„æ‰§è¡Œå†…å­˜ï¼Œå½“æ‰§è¡Œä»»åŠ¡æœ‰å†…å­˜éœ€è¦æ—¶ï¼ŒRDDç¼“å­˜ä»»åŠ¡å¿…é¡»ç«‹å³å½’è¿˜æŠ¢å çš„å†…å­˜ï¼Œå…¶ä¸­æ¶‰åŠçš„RDDç¼“å­˜æ•°æ®è¦ä¹ˆè½ç›˜ã€è¦ä¹ˆæ¸…é™¤ï¼›</li>\n<li>å¯¹åˆ†å¸ƒå¼è®¡ç®—ä»»åŠ¡æŠ¢å çš„Storage Memoryå†…å­˜ç©ºé—´ï¼Œå³ä¾¿RDDç¼“å­˜ä»»åŠ¡æœ‰æ”¶å›å†…å­˜çš„éœ€è¦ï¼Œä¹Ÿè¦ç­‰åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰èƒ½é‡Šæ”¾ã€‚</li>\n</ul><p><strong>æœ€åæ˜¯ä¸åŒä»£ç å¯¹ä¸åŒå†…å­˜åŒºåŸŸçš„æ¶ˆè€—ã€‚</strong>å†…å­˜åŒºåŸŸåˆ†ä¸ºReserved Memoryã€User Memoryã€Execution Memoryå’ŒStorage Memoryã€‚å…¶ä¸­ï¼ŒReserved Memoryç”¨äºå­˜å‚¨Sparkå†…éƒ¨å¯¹è±¡ï¼ŒUser Memoryç”¨äºå­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ï¼ŒExecution Memoryç”¨äºåˆ†å¸ƒå¼ä»»åŠ¡æ‰§è¡Œï¼Œè€ŒStorage Memoryåˆ™ç”¨æ¥å®¹çº³RDDç¼“å­˜å’Œå¹¿æ’­å˜é‡ã€‚</p><p>å¥½äº†ï¼Œè¿™äº›å°±æ˜¯å†…å­˜ç®¡ç†çš„åŸºç¡€çŸ¥è¯†ã€‚å½“ç„¶äº†ï¼Œä¸å†…å­˜ç›¸å…³çš„è¯é¢˜è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å†…å­˜æº¢å‡ºã€RDDç¼“å­˜ã€å†…å­˜åˆ©ç”¨ç‡ï¼Œä»¥åŠæ‰§è¡Œå†…å­˜çš„å¹¶è¡Œè®¡ç®—ç­‰ç­‰ã€‚åœ¨æ€§èƒ½è°ƒä¼˜ç¯‡ï¼Œæˆ‘è¿˜ä¼šç»§ç»­ä»å†…å­˜è§†è§’å‡ºå‘ï¼Œå»å’Œä½ æ¢è®¨è¿™äº›è¯é¢˜ã€‚</p><h2>æ¯æ—¥ä¸€ç»ƒ</h2><ol>\n<li>ä½ çŸ¥é“å¯ç”¨off-heapä¹‹åï¼ŒSparkæœ‰å“ªäº›è®¡ç®—ç¯èŠ‚å¯ä»¥åˆ©ç”¨åˆ°å †å¤–å†…å­˜ï¼Ÿä½ èƒ½åˆ—ä¸¾å‡ºä¸€äº›ä¾‹å­å—ï¼Ÿ</li>\n<li>ç›¸æ¯”å †å†…å†…å­˜ï¼Œä¸ºä»€ä¹ˆåœ¨å †å¤–å†…å­˜ä¸­ï¼ŒSparkå¯¹äºå†…å­˜å ç”¨é‡çš„é¢„ä¼°æ›´å‡†ç¡®ï¼Ÿ</li>\n<li>ç»“åˆæˆ‘åœ¨ä¸‹é¢ç»™å®šçš„é…ç½®å‚æ•°ï¼Œä½ èƒ½åˆ†åˆ«è®¡ç®—ä¸åŒå†…å­˜åŒºåŸŸï¼ˆReservedã€Userã€Executionã€Storageï¼‰çš„å…·ä½“å¤§å°å—ï¼Ÿ</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/fd/66/fdb2fb17120e4d047d5ccd28d1434b66.jpeg?wh=1851*692\" alt=\"\"></p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼</p>","neighbors":{"left":{"article_title":"06 | å­˜å‚¨ç³»ç»Ÿï¼šç©ºé—´æ¢æ—¶é—´ï¼Œè¿˜æ˜¯æ—¶é—´æ¢ç©ºé—´ï¼Ÿ","id":355081},"right":{"article_title":"08 | åº”ç”¨å¼€å‘ä¸‰åŸåˆ™ï¼šå¦‚ä½•æ‹“å±•è‡ªå·±çš„å¼€å‘è¾¹ç•Œï¼Ÿ","id":357197}},"comments":[{"had_liked":false,"id":292397,"user_name":"-.-","can_delete":false,"product_type":"c1","uid":1357603,"ip_address":"","ucode":"3CDC606BDFDD80","user_header":"https://static001.geekbang.org/account/avatar/00/14/b7/23/ea83d6eb.jpg","comment_is_top":false,"comment_ctime":1620804704,"is_pvip":true,"replies":[{"id":"105895","content":"å…ˆæ¥è¯´è¯´è¿™ä¸ªspark.executor.memoryOverhead å“ˆï¼Œåœ¨yarnã€k8séƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œcontainerä¼šé¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ï¼Œå½¢å¼æ˜¯å †å¤–ï¼Œç”¨æ¥ä¿è¯ç¨³å®šæ€§ï¼Œä¸»è¦å­˜å‚¨nio bufferï¼Œå‡½æ•°æ ˆç­‰ä¸€äº›å¼€é”€ï¼Œæ‰€ä»¥ä½ çœ‹åå­—ï¼šover headã€‚è¿™éƒ¨åˆ†å†…å­˜ï¼Œä¸ç®¡å †å¤–è¿˜æ˜¯å †å†…ï¼Œå¼€å‘è€…ç”¨ä¸åˆ°ï¼Œsparkä¹Ÿç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä¸ç”¨å…³å¿ƒï¼Œåƒä¸‡ä¸æŒ‡æœ›è°ƒè¿™ä¸ªå‚æ•°å»æå‡æ€§èƒ½ï¼Œå®ƒçš„ç›®çš„æ˜¯ä¿æŒè¿è¡Œæ—¶çš„ç¨³å®šæ€§~<br><br>æƒ³åˆ©ç”¨å †å¤–è®©sparkå»ç®¡ç†æ•°æ®ã€åŠ é€Ÿæ‰§è¡Œæ•ˆç‡ï¼Œåªæœ‰off heapé‚£ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªç”¨æ¥enable(spark.memory.offHeap.enabled=true)ã€ä¸€ä¸ªæŒ‡å®šå¤§å°(spark.memory.offHeap.size)ã€‚è¿™ä¸¤ä¸ªæ‰æ˜¯æ­£å„¿å…«ç»çš„off heap key configsã€‚<br><br>å›ç­”ä½ çš„é—®é¢˜ï¼š<br>1. æ˜¯çš„ï¼Œæ²¡é”™ï¼Œå®ƒä¸æ˜¯Sparkç®¡ç†çš„å†…å­˜ç©ºé—´ï¼Œä¸ä¼šç”¨åˆ°Executionæˆ–æ˜¯Storage<br>2. ä¸ä¼šï¼Œè¿™éƒ¨åˆ†overheadæ˜¯å•ç‹¬åˆ’åˆ†çš„ï¼Œå®ƒä¸ä¼šå‚ä¸åˆ°Sparkè¯¸å¤šå†…å­˜ç©ºé—´çš„è®¡ç®—ï¼Œæ˜¯å®Œå…¨ç‹¬ç«‹çš„ä¸€å—åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„containeré¢„ç•™çš„â€œbufferâ€ã€‚æ‰€ä»¥å®Œå…¨ä¸ç”¨ç†å®ƒï¼Œå®ƒçš„ç›®çš„æ˜¯æä¾›ç¨³å®šæ€§ï¼Œä¸å‚ä¸Sparkä»»åŠ¡è®¡ç®—ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1620834499,"ip_address":"","comment_id":292397,"utype":1}],"discussion_count":3,"race_medal":0,"score":"70340281440","product_id":100073401,"comment_content":"å—ç›ŠåŒªæµ…ï¼Œå¼€å§‹çœ‹ç¬¬äºŒéäº†ï¼æœ‰ä¸ªé—®é¢˜æƒ³è¯·æ•™ä¸‹ï¼Œspark.executor.memoryOverheadæ§åˆ¶çš„æ˜¯å †å¤–å†…å­˜çš„å¤§å°ï¼Œå®˜æ–¹æ–‡æ¡£è§£é‡Šï¼šThis is memory that accounts for things like VM overheads, interned strings, other native overheads, etc.1. å¦‚æœè®¾ç½®spark.memory.offHeap.enabled=falseï¼Œè¿™å—å†…å­˜æ˜¯ä¸æ˜¯åªæ˜¯jvmçš„å †å¤–å†…å­˜è€Œä¸æ˜¯sparkç®¡ç†çš„å †å¤–å†…å­˜ï¼Œä¸ä¼šè¢«ç”¨äºæ‰§è¡Œå†…å­˜å’Œç¼“å­˜å†…å­˜ï¼Ÿ 2. å¦‚æœè®¾ç½®spark.memory.offHeap.enabled=true,è¿™å—å†…å­˜ä¸­æ˜¯ä¸æ˜¯ä¼šåŒ…å«offHeapSizeï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†ä¸ºJVMå †å¤–å†…å­˜ä¸€éƒ¨åˆ†ä¸ºoffHeapçš„æ‰§è¡Œå†…å­˜å’Œç¼“å­˜å†…å­˜ï¼Ÿ","like_count":16,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519812,"discussion_content":"å…ˆæ¥è¯´è¯´è¿™ä¸ªspark.executor.memoryOverhead å“ˆï¼Œåœ¨yarnã€k8séƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œcontainerä¼šé¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ï¼Œå½¢å¼æ˜¯å †å¤–ï¼Œç”¨æ¥ä¿è¯ç¨³å®šæ€§ï¼Œä¸»è¦å­˜å‚¨nio bufferï¼Œå‡½æ•°æ ˆç­‰ä¸€äº›å¼€é”€ï¼Œæ‰€ä»¥ä½ çœ‹åå­—ï¼šover headã€‚è¿™éƒ¨åˆ†å†…å­˜ï¼Œä¸ç®¡å †å¤–è¿˜æ˜¯å †å†…ï¼Œå¼€å‘è€…ç”¨ä¸åˆ°ï¼Œsparkä¹Ÿç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä¸ç”¨å…³å¿ƒï¼Œåƒä¸‡ä¸æŒ‡æœ›è°ƒè¿™ä¸ªå‚æ•°å»æå‡æ€§èƒ½ï¼Œå®ƒçš„ç›®çš„æ˜¯ä¿æŒè¿è¡Œæ—¶çš„ç¨³å®šæ€§~\n\næƒ³åˆ©ç”¨å †å¤–è®©sparkå»ç®¡ç†æ•°æ®ã€åŠ é€Ÿæ‰§è¡Œæ•ˆç‡ï¼Œåªæœ‰off heapé‚£ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªç”¨æ¥enable(spark.memory.offHeap.enabled=true)ã€ä¸€ä¸ªæŒ‡å®šå¤§å°(spark.memory.offHeap.size)ã€‚è¿™ä¸¤ä¸ªæ‰æ˜¯æ­£å„¿å…«ç»çš„off heap key configsã€‚\n\nå›ç­”ä½ çš„é—®é¢˜ï¼š\n1. æ˜¯çš„ï¼Œæ²¡é”™ï¼Œå®ƒä¸æ˜¯Sparkç®¡ç†çš„å†…å­˜ç©ºé—´ï¼Œä¸ä¼šç”¨åˆ°Executionæˆ–æ˜¯Storage\n2. ä¸ä¼šï¼Œè¿™éƒ¨åˆ†overheadæ˜¯å•ç‹¬åˆ’åˆ†çš„ï¼Œå®ƒä¸ä¼šå‚ä¸åˆ°Sparkè¯¸å¤šå†…å­˜ç©ºé—´çš„è®¡ç®—ï¼Œæ˜¯å®Œå…¨ç‹¬ç«‹çš„ä¸€å—åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„containeré¢„ç•™çš„â€œbufferâ€ã€‚æ‰€ä»¥å®Œå…¨ä¸ç”¨ç†å®ƒï¼Œå®ƒçš„ç›®çš„æ˜¯æä¾›ç¨³å®šæ€§ï¼Œä¸å‚ä¸Sparkä»»åŠ¡è®¡ç®—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620834499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168545,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/a1/8bc8e7e1.jpg","nickname":"èµŒç¥å¾ˆä½è°ƒ","note":"","ucode":"1066778E1EDF26","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558961,"discussion_content":"å¦‚æœæˆ‘è®¾å®šspark.memory.offHeap.sizeä¸º1G,spark.executor.memoryOverheadæ˜¯å¦ä¹Ÿå¿…é¡»è®¾ç½®ä¸º1G,ä¸ç„¶yarnä¸ä¼šåˆ†é…è¿™éƒ¨åˆ†å†…å­˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648531942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1745733,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/a3/45/65e7997f.jpg","nickname":"Cellophane","note":"","ucode":"4161CDAF760F4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557931,"discussion_content":"è€å¸ˆï¼Œæˆ‘çœ‹åˆ°åˆ«çš„æ–‡ç« æœ‰è¯´oomè¿˜æœ‰æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œè°ƒèŠ‚memoryOverheadæœ‰ç”¨ï¼Œè€å¸ˆèƒ½è¯¦ç»†è¯´è¯´å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648027994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285676,"user_name":"æ–¯ç›–ä¸¸","can_delete":false,"product_type":"c1","uid":1168504,"ip_address":"","ucode":"B881D14B028F14","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/78/66b3f2a2.jpg","comment_is_top":false,"comment_ctime":1616972076,"is_pvip":false,"replies":[{"id":"103655","content":"æ»¡åˆ†ğŸ’¯","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616979060,"ip_address":"","comment_id":285676,"utype":1}],"discussion_count":6,"race_medal":0,"score":"35976710444","product_id":100073401,"comment_content":"å †å†…å†…å­˜ä¸­ï¼šä¿ç•™å†…å­˜300Mï¼Œç”¨æˆ·å†…å­˜ä¸º20*0.2=4GBï¼ŒStorageå†…å­˜ä¸º20*0.8*0.6=9.6GBï¼ŒExecutionå†…å­˜ä¸º20*0.8*0.4=6.4GB<br>å †å¤–å†…å­˜ä¸­ï¼šStorageå†…å­˜ä¸º10*0.6=6Gï¼ŒExecutionå†…å­˜ä¸º10*0.4=4G","like_count":8,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517751,"discussion_content":"æ»¡åˆ†ğŸ’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616979060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014649,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/79/df384bdc.jpg","nickname":"ä¿®æ„¿ä¸‰ç§‹","note":"","ucode":"0AEE445D8DBFF4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362846,"discussion_content":"ç”¨æˆ·å†…å­˜ç­‰ä¸åº”è¯¥æ˜¯å‡äº†300Måå†ç®—ä¹ˆï¼Ÿæ¯”å¦‚ç”¨æˆ·å†…å­˜ä¸º(20g-0. 3g) *0. 2=3.94g","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617059311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1168504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/78/66b3f2a2.jpg","nickname":"æ–¯ç›–ä¸¸","note":"","ucode":"B881D14B028F14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1014649,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/79/df384bdc.jpg","nickname":"ä¿®æ„¿ä¸‰ç§‹","note":"","ucode":"0AEE445D8DBFF4","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":363198,"discussion_content":"è‚¯å®šè¦å‡300Mçš„ï¼Œåªä¸è¿‡ç®—èµ·æ¥å¤ªéº»çƒ¦äº†æ‰€ä»¥æ²¡å‡ğŸ˜†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1617144797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":362846,"ip_address":""},"score":363198,"extra":""},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1014649,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/79/df384bdc.jpg","nickname":"ä¿®æ„¿ä¸‰ç§‹","note":"","ucode":"0AEE445D8DBFF4","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":363650,"discussion_content":"å¯¹ï¼Œä¸¥æ ¼æ¥è¯´æ˜¯è¦è¿™ä¹ˆç®—æ‰å¯¹","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1617253898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":362846,"ip_address":""},"score":363650,"extra":""}]},{"author":{"id":2536655,"avatar":"","nickname":"Geek_74be61","note":"","ucode":"F348E20A050C84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362667,"discussion_content":"ä¸ºä»€ä¹ˆå †å†…å†…å­˜ä¸­æ¯ä¸ªåŒºåŸŸåˆ†é…çš„å†…å­˜å€¼åˆè®¡èµ·æ¥æ˜¯20G+300M?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617004252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2536655,"avatar":"","nickname":"Geek_74be61","note":"","ucode":"F348E20A050C84","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363651,"discussion_content":"300Mæ˜¯ä»20Gé‡Œé¢åˆ†å‡ºæ¥çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617253932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":362667,"ip_address":""},"score":363651,"extra":""}]}]},{"had_liked":false,"id":294412,"user_name":"Kendrick","can_delete":false,"product_type":"c1","uid":2406292,"ip_address":"","ucode":"5DF1269295D24E","user_header":"https://static001.geekbang.org/account/avatar/00/24/b7/94/22121c60.jpg","comment_is_top":false,"comment_ctime":1621932171,"is_pvip":false,"replies":[{"id":"106840","content":"å¥½é—®é¢˜ï¼Œå…¶å®sparkå®˜æ–¹å»ºè®®è°¨æ…ä½¿ç”¨å †å¤–å†…å­˜ï¼Œä¸ºå•¥å‘¢ï¼Ÿ<br><br>åŸå› å…¶å®å¾ˆç®€å•ï¼Œåœ¨äºå †å¤–å †å†…çš„ç©ºé—´äº’ä¸shareï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„taskæœ€å¼€å§‹ç”¨å †å¤–ï¼Œç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™å³ä½¿å †å†…è¿˜æœ‰ç©ºé—²ï¼Œtaskä¹Ÿæ²¡æ³•ç”¨ï¼Œæ‰€ä»¥ç…§æ ·ä¼šoomã€‚<br><br>å†…å­˜æœ¬æ¥å°±æœ‰é™ï¼Œå†å¼ºè¡Œåˆ’åˆ†å‡ºä¸¤å—éš”ç¦»çš„åŒºåŸŸï¼Œå…¶å®åè€Œå¢åŠ äº†ç®¡ç†éš¾åº¦ã€‚tungstenåœ¨å †å†…å…¶å®ä¹Ÿç”¨å†…å­˜é¡µç®¡ç†å†…å­˜ï¼ˆTungstençš„ç›¸å…³ä¼˜åŒ–ï¼Œå¯ä»¥å‚è€ƒåé¢Tungstené‚£ä¸€è®²ï¼‰ï¼Œä¹Ÿç”¨å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ç»“æ„ï¼Œå› æ­¤gcæ•ˆç‡å¾€å¾€å¯ä»¥ä¿éšœï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹æ¨èå°±ç”¨å †å†…å°±å¯ä»¥äº†ã€‚<br><br>å›ç­”ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¸è§‰å¾—æœ‰ä»€ä¹ˆåœºæ™¯ä¸€å®šè¦ç”¨å †å¤–ï¼Œå°±æˆ‘çœ‹æ¥ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå †å¤–æ›´å¤šåœ°æ˜¯ä¸€ç§å¤‡é€‰é¡¹ï¼Œæ˜¯Optionalçš„ã€‚ä¸è¿‡ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦çŸ¥é“å †å¤–ã€å †å†…å„è‡ªæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€ä¼˜åŠ£åŠ¿ï¼Œè¿™æ ·åœ¨ç»“åˆåº”ç”¨åœºæ™¯åšé€‰æ‹©çš„æ—¶å€™ï¼Œä¹Ÿèƒ½æœ‰çš„æ”¾çŸ¢~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1621952780,"ip_address":"","comment_id":294412,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31686703243","product_id":100073401,"comment_content":"æœ‰ç‚¹ç–‘æƒ‘ï¼Œæˆ‘æƒ³çŸ¥é“å †å¤–å†…å­˜å­˜åœ¨çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåœºæ™¯æ˜¯ä¸€å®šéœ€è¦å †å¤–å†…å­˜ä¹ˆï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520642,"discussion_content":"å¥½é—®é¢˜ï¼Œå…¶å®sparkå®˜æ–¹å»ºè®®è°¨æ…ä½¿ç”¨å †å¤–å†…å­˜ï¼Œä¸ºå•¥å‘¢ï¼Ÿ\n\nåŸå› å…¶å®å¾ˆç®€å•ï¼Œåœ¨äºå †å¤–å †å†…çš„ç©ºé—´äº’ä¸shareï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„taskæœ€å¼€å§‹ç”¨å †å¤–ï¼Œç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™å³ä½¿å †å†…è¿˜æœ‰ç©ºé—²ï¼Œtaskä¹Ÿæ²¡æ³•ç”¨ï¼Œæ‰€ä»¥ç…§æ ·ä¼šoomã€‚\n\nå†…å­˜æœ¬æ¥å°±æœ‰é™ï¼Œå†å¼ºè¡Œåˆ’åˆ†å‡ºä¸¤å—éš”ç¦»çš„åŒºåŸŸï¼Œå…¶å®åè€Œå¢åŠ äº†ç®¡ç†éš¾åº¦ã€‚tungstenåœ¨å †å†…å…¶å®ä¹Ÿç”¨å†…å­˜é¡µç®¡ç†å†…å­˜ï¼ˆTungstençš„ç›¸å…³ä¼˜åŒ–ï¼Œå¯ä»¥å‚è€ƒåé¢Tungstené‚£ä¸€è®²ï¼‰ï¼Œä¹Ÿç”¨å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ç»“æ„ï¼Œå› æ­¤gcæ•ˆç‡å¾€å¾€å¯ä»¥ä¿éšœï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹æ¨èå°±ç”¨å †å†…å°±å¯ä»¥äº†ã€‚\n\nå›ç­”ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¸è§‰å¾—æœ‰ä»€ä¹ˆåœºæ™¯ä¸€å®šè¦ç”¨å †å¤–ï¼Œå°±æˆ‘çœ‹æ¥ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå †å¤–æ›´å¤šåœ°æ˜¯ä¸€ç§å¤‡é€‰é¡¹ï¼Œæ˜¯Optionalçš„ã€‚ä¸è¿‡ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦çŸ¥é“å †å¤–ã€å †å†…å„è‡ªæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ã€ä¼˜åŠ£åŠ¿ï¼Œè¿™æ ·åœ¨ç»“åˆåº”ç”¨åœºæ™¯åšé€‰æ‹©çš„æ—¶å€™ï¼Œä¹Ÿèƒ½æœ‰çš„æ”¾çŸ¢~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621952780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1296063,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c6/bf/52b3f71d.jpg","nickname":"dawn","note":"","ucode":"1757B28F1EF5C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585488,"discussion_content":"æˆ‘è§‰å¾—å§ï¼Œjvméœ€è¦å›æ”¶çš„æ•°æ®ï¼Œä¹‹é—´çš„å…³ç³»éå¸¸å¤æ‚ï¼Œè€Œå¦‚æœç”¨å †å¤–å†…å­˜ï¼Œç”±äºæ›´å¤šæ˜¯rddç¼“å­˜ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šå¤æ‚çš„å…³ç³»é“¾ï¼Œé‚£ä¹ˆgcé‚£ä¸€å¥—ç®—æ³•ï¼Œæœªå¿…å°±æœ‰è‡ªå·±æ’¸ä¸€å¥—å›æ”¶ç®—æ³•å¼ºï¼Œè¿™ä¸ªæ—¶å€™å¼€è¾Ÿå †å¤–å¯¹å†…ï¼Œæ›´å¤šæ˜¯sparkç»™è‡ªå·±ç•™äº†ä¸€æ¡å¯ä»¥ä¼˜åŒ–çš„åè·¯ã€‚å½“ç„¶ï¼Œå¦å¤–ä¸€ä¸ªä¼˜åŒ–çš„æ€è·¯æ˜¯ï¼Œå¯»æ‰¾æ•ˆç‡æ›´é«˜çš„gcå›æ”¶å™¨ï¼Œå¯¹äºä½¿ç”¨è€…æ¥è¯´ï¼Œåè€…æ˜¾ç„¶æ›´åˆé€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1661590765,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286169,"user_name":"äº•å…ˆç”Ÿ","can_delete":false,"product_type":"c1","uid":2108294,"ip_address":"","ucode":"87FD735FA7BFC3","user_header":"https://static001.geekbang.org/account/avatar/00/20/2b/86/318e6ff3.jpg","comment_is_top":false,"comment_ctime":1617175761,"is_pvip":false,"replies":[{"id":"103898","content":"å…·ä½“å¤§å°å¯ä»¥é€šè¿‡å‚æ•°æ¥é…ç½®å“ˆï¼Œå †å†…ä¹Ÿä¸€æ ·ï¼Œéƒ½æ˜¯ç”¨å‚æ•°å¼€è°ƒæ§ã€‚ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå †å†…ã€å †å¤–çš„å†…å­˜ï¼Œäº’ç›¸ä¹‹é—´ä¸å…±äº«ã€‚ä¹Ÿå°±æ˜¯ä¸€å¼€å§‹ä½ çš„taskç”¨off heapï¼Œåæ¥ç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸èƒ½å»å æœ‰å †å†…å†…å­˜çš„ï¼Œæ‰€ä»¥å³ä¾¿å †å†…æœ‰ç©ºé—²ï¼Œä¹Ÿè¿˜æ˜¯ä¼šoomã€‚æ‰€ä»¥åœ¨åˆ’åˆ†å †å†…å †å¤–ä¹‹å‰ï¼Œè¦æå‰è®¡åˆ’å¥½ï¼Œå¦‚æœæ€•éº»çƒ¦ï¼Œå°±éƒ½ç”¨å †å†…ã€‚tungstenå¯¹äºå †å†…çš„å†…å­˜ç®¡ç†åšçš„ä¹Ÿå¾ˆå¥½ï¼Œå¤§å¤šæ•°åœºæ™¯éƒ½é—®é¢˜ä¸å¤§ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617239488,"ip_address":"","comment_id":286169,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31681946833","product_id":100073401,"comment_content":"è¯•è¯»äº†å‡ èŠ‚æœæ–­è®¢é˜…äº†ã€‚<br>å¼€å¯å †å¤–å†…å­˜åï¼Œåˆ†é…çš„å†…å­˜ç©ºé—´æ˜¯å¤šå¤§ï¼Ÿè¿™æ—¶å€™è¿˜ä¼šåˆ†é…å †å†…å†…å­˜å—ï¼Ÿè°¢è°¢","like_count":7,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517891,"discussion_content":"å…·ä½“å¤§å°å¯ä»¥é€šè¿‡å‚æ•°æ¥é…ç½®å“ˆï¼Œå †å†…ä¹Ÿä¸€æ ·ï¼Œéƒ½æ˜¯ç”¨å‚æ•°å¼€è°ƒæ§ã€‚ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå †å†…ã€å †å¤–çš„å†…å­˜ï¼Œäº’ç›¸ä¹‹é—´ä¸å…±äº«ã€‚ä¹Ÿå°±æ˜¯ä¸€å¼€å§‹ä½ çš„taskç”¨off heapï¼Œåæ¥ç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸èƒ½å»å æœ‰å †å†…å†…å­˜çš„ï¼Œæ‰€ä»¥å³ä¾¿å †å†…æœ‰ç©ºé—²ï¼Œä¹Ÿè¿˜æ˜¯ä¼šoomã€‚æ‰€ä»¥åœ¨åˆ’åˆ†å †å†…å †å¤–ä¹‹å‰ï¼Œè¦æå‰è®¡åˆ’å¥½ï¼Œå¦‚æœæ€•éº»çƒ¦ï¼Œå°±éƒ½ç”¨å †å†…ã€‚tungstenå¯¹äºå †å†…çš„å†…å­˜ç®¡ç†åšçš„ä¹Ÿå¾ˆå¥½ï¼Œå¤§å¤šæ•°åœºæ™¯éƒ½é—®é¢˜ä¸å¤§ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617239488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288500,"user_name":"è‹å­æµ©","can_delete":false,"product_type":"c1","uid":2486715,"ip_address":"","ucode":"8A842C9C2E53E8","user_header":"https://static001.geekbang.org/account/avatar/00/25/f1/bb/547b580a.jpg","comment_is_top":false,"comment_ctime":1618493684,"is_pvip":false,"replies":[{"id":"104753","content":"â€œreduceByKeyç®—å­ä¼šå¼•å…¥ Shuffleï¼Œè€Œ Shuffle è¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„å†…éƒ¨æ•°æ®ç»“æ„ï¼Œå¦‚æ˜ å°„ã€æ’åºã€èšåˆç­‰æ“ä½œæ‰€ä»°ä»—çš„ Bufferã€Array å’Œ HashMapï¼Œéƒ½ä¼šæ¶ˆè€— Execution Memory åŒºåŸŸä¸­çš„å†…å­˜ã€‚â€<br><br>å†…å­˜ï¼šä¸Šé¢è¯´çš„è¿™äº›æ“ä½œï¼Œéƒ½ä¼šæ¶ˆè€—å†…å­˜ç©ºé—´ï¼Œä¸è¿‡Mapé˜¶æ®µçš„æ¯ä¸€ä¸ªè®¡ç®—ç¯èŠ‚ï¼Œéƒ½æ˜¯ä¸ºäº†ç”Ÿæˆä¸­é—´æ–‡ä»¶ï¼ˆdataå’Œindexæ–‡ä»¶ï¼‰ï¼›<br><br>ç£ç›˜ï¼šåœ¨ç”Ÿæˆä¸­é—´æ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šæ¶‰åŠç£ç›˜ã€æ¶‰åŠdiskStoreçš„putByeså†™æ–‡ä»¶ã€‚æ¯”å¦‚ä¸´æ—¶æ–‡ä»¶æº¢å‡ºã€æ¯”å¦‚mergeå¾—åˆ°çš„ä¸­é—´æ–‡ä»¶ï¼Œç­‰ç­‰ã€‚<br><br>æˆ–è€…æ›´ç®€å•åœ°ï¼ŒShuffleè¿‡ç¨‹ä¸­ï¼Œåªæœ‰å†™ä¸´æ—¶æ–‡ä»¶ã€å’ŒShuffleä¸­é—´æ–‡ä»¶ï¼Œæ‰ä¼šæ¶‰åŠdiskStoreå’Œç›¸å…³çš„ç£ç›˜æ“ä½œã€‚å…¶ä»–çš„è®¡ç®—æ­¥éª¤ï¼Œéƒ½æ˜¯åœ¨å†…å­˜ä¸­å®Œæˆçš„ï¼Œä¼šæ¶ˆè€—å¦‚ä¸Šçš„æ•°æ®ç»“æ„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1618567608,"ip_address":"","comment_id":288500,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23093330164","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼æˆ‘æƒ³é—®ä¸€ä¸‹åœ¨æ–‡ä¸­æåˆ°â€œreduceByKeyç®—å­ä¼šå¼•å…¥ Shuffleï¼Œè€Œ Shuffle è¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„å†…éƒ¨æ•°æ®ç»“æ„ï¼Œå¦‚æ˜ å°„ã€æ’åºã€èšåˆç­‰æ“ä½œæ‰€ä»°ä»—çš„ Bufferã€Array å’Œ HashMapï¼Œéƒ½ä¼šæ¶ˆè€— Execution Memory åŒºåŸŸä¸­çš„å†…å­˜ã€‚â€ä¸Šä¸€èŠ‚è¯´åˆ°Shuffleçš„ä¸­é—´ç»“æœä¼šå†™å…¥ç£ç›˜ï¼šShuffle manageré€šè¿‡BlockManagerè°ƒç”¨DiskStoreçš„putBytes()æ–¹æ³•å°†æ•°æ®å—å†™å…¥æ–‡ä»¶ã€‚è¿™é‡Œçš„è”ç³»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨å†…å­˜å’Œç£ç›˜ä¸Šæœ‰ç‚¹ä¸ç†è§£ï¼Œä¸å¥½æ„æ€ï¼Œæ„Ÿè°¢è§£ç­”ï¼","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518642,"discussion_content":"â€œreduceByKeyç®—å­ä¼šå¼•å…¥ Shuffleï¼Œè€Œ Shuffle è¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„å†…éƒ¨æ•°æ®ç»“æ„ï¼Œå¦‚æ˜ å°„ã€æ’åºã€èšåˆç­‰æ“ä½œæ‰€ä»°ä»—çš„ Bufferã€Array å’Œ HashMapï¼Œéƒ½ä¼šæ¶ˆè€— Execution Memory åŒºåŸŸä¸­çš„å†…å­˜ã€‚â€\n\nå†…å­˜ï¼šä¸Šé¢è¯´çš„è¿™äº›æ“ä½œï¼Œéƒ½ä¼šæ¶ˆè€—å†…å­˜ç©ºé—´ï¼Œä¸è¿‡Mapé˜¶æ®µçš„æ¯ä¸€ä¸ªè®¡ç®—ç¯èŠ‚ï¼Œéƒ½æ˜¯ä¸ºäº†ç”Ÿæˆä¸­é—´æ–‡ä»¶ï¼ˆdataå’Œindexæ–‡ä»¶ï¼‰ï¼›\n\nç£ç›˜ï¼šåœ¨ç”Ÿæˆä¸­é—´æ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šæ¶‰åŠç£ç›˜ã€æ¶‰åŠdiskStoreçš„putByeså†™æ–‡ä»¶ã€‚æ¯”å¦‚ä¸´æ—¶æ–‡ä»¶æº¢å‡ºã€æ¯”å¦‚mergeå¾—åˆ°çš„ä¸­é—´æ–‡ä»¶ï¼Œç­‰ç­‰ã€‚\n\næˆ–è€…æ›´ç®€å•åœ°ï¼ŒShuffleè¿‡ç¨‹ä¸­ï¼Œåªæœ‰å†™ä¸´æ—¶æ–‡ä»¶ã€å’ŒShuffleä¸­é—´æ–‡ä»¶ï¼Œæ‰ä¼šæ¶‰åŠdiskStoreå’Œç›¸å…³çš„ç£ç›˜æ“ä½œã€‚å…¶ä»–çš„è®¡ç®—æ­¥éª¤ï¼Œéƒ½æ˜¯åœ¨å†…å­˜ä¸­å®Œæˆçš„ï¼Œä¼šæ¶ˆè€—å¦‚ä¸Šçš„æ•°æ®ç»“æ„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618567608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2486715,"avatar":"https://static001.geekbang.org/account/avatar/00/25/f1/bb/547b580a.jpg","nickname":"è‹å­æµ©","note":"","ucode":"8A842C9C2E53E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368765,"discussion_content":"è°¢è°¢è€å¸ˆçš„è§£ç­”ï¼æ˜ç™½äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618824953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290199,"user_name":"Zå®‡é”¤é”¤","can_delete":false,"product_type":"c1","uid":2188142,"ip_address":"","ucode":"7DB36E986A7A51","user_header":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","comment_is_top":false,"comment_ctime":1619427123,"is_pvip":true,"replies":[{"id":"105236","content":"æ˜¯çš„ï¼Œä¸è¿‡è¦æ˜¾ç¤ºåœ°ï¼ˆExplicitlyï¼‰æŒ‡å®šå­˜å‚¨çº§åˆ«ï¼šOFF_HEAP<br><br>rdd.persist(OFF_HEAP)","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1619513697,"ip_address":"","comment_id":290199,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14504329011","product_id":100073401,"comment_content":"å¯ç”¨off-heapä»¥åï¼ŒRDDå¯ä»¥ç›´æ¥ç¼“å­˜åˆ°off-heapä¸Šã€‚","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519136,"discussion_content":"æ˜¯çš„ï¼Œä¸è¿‡è¦æ˜¾ç¤ºåœ°ï¼ˆExplicitlyï¼‰æŒ‡å®šå­˜å‚¨çº§åˆ«ï¼šOFF_HEAP\n\nrdd.persist(OFF_HEAP)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619513697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285763,"user_name":"å¯¹æ–¹æ­£åœ¨è¾“å…¥ã€‚ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":1179298,"ip_address":"","ucode":"7B0DEB4D9B43D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/a2/5252a278.jpg","comment_is_top":false,"comment_ctime":1617005222,"is_pvip":false,"replies":[{"id":"103698","content":"å’Œæ•°æ®æºå­˜åœ¨å“ªå„¿å…³ç³»ä¸å¤§å“ˆï¼Œä¸»è¦çœ‹å®ƒç”¨äºå“ªç±»è®¡ç®—ï¼Œå¦‚æœæ˜¯çº¯è¿ç®—ï¼Œé‚£å°±æ˜¯execution memoryï¼›å¦‚æœç¼“å­˜ä¸‹æ¥ï¼Œå°±æ˜¯storage memoryã€‚å–å†³äºä½ çš„è®¡ç®—è´Ÿè½½ç±»å‹ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617014606,"ip_address":"","comment_id":285763,"utype":1}],"discussion_count":5,"race_medal":0,"score":"14501907110","product_id":100073401,"comment_content":"è€å¸ˆï¼Œstageçš„è¾“å…¥æ˜¯å¤–éƒ¨æ•°æ®æºçš„æƒ…å†µï¼Œæ¯”å¦‚s3çš„parquetæ–‡ä»¶ï¼Œæ˜¯ç”¨å“ªä¸€å—å†…å­˜æ¥ä¿å­˜è¯»å–çš„æ•°æ®å‘€","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517774,"discussion_content":"å’Œæ•°æ®æºå­˜åœ¨å“ªå„¿å…³ç³»ä¸å¤§å“ˆï¼Œä¸»è¦çœ‹å®ƒç”¨äºå“ªç±»è®¡ç®—ï¼Œå¦‚æœæ˜¯çº¯è¿ç®—ï¼Œé‚£å°±æ˜¯execution memoryï¼›å¦‚æœç¼“å­˜ä¸‹æ¥ï¼Œå°±æ˜¯storage memoryã€‚å–å†³äºä½ çš„è®¡ç®—è´Ÿè½½ç±»å‹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617014606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1629630,"avatar":"","nickname":"Geeker","note":"","ucode":"DC09B404F3EBB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364009,"discussion_content":"è€å¸ˆæœ‰ç‚¹ç–‘æƒ‘ï¼Œä»£ç ä¸­ç¬¬äºŒè¡Œè¯»å– words.csv æ–‡ä»¶å¹¶ç”Ÿæˆ RDD wordsï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„æ˜¯å“ªç§å†…å­˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617348969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1629630,"avatar":"","nickname":"Geeker","note":"","ucode":"DC09B404F3EBB0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366419,"discussion_content":"æ‰§è¡Œå†…å­˜ï¼ŒExecution memory","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618056903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":364009,"ip_address":""},"score":366419,"extra":""}]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362705,"discussion_content":"åˆ«å®¢æ°”~ ç»§ç»­å‚ä¸è®¨è®ºå“ˆ~ åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617014941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1179298,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fe/a2/5252a278.jpg","nickname":"å¯¹æ–¹æ­£åœ¨è¾“å…¥ã€‚ã€‚ã€‚","note":"","ucode":"7B0DEB4D9B43D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362701,"discussion_content":"sogaï¼è°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617014677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297538,"user_name":"feihui","can_delete":false,"product_type":"c1","uid":1007294,"ip_address":"","ucode":"13F1D4A82BC650","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/be/9ea55f46.jpg","comment_is_top":false,"comment_ctime":1623604495,"is_pvip":true,"replies":[{"id":"108253","content":"execution memoryã€storage memoryçš„åˆ’åˆ†æ˜¯é€»è¾‘ä¸Šçš„~ Sparkåœ¨JVMä¹‹ä¸Šçš„å†…å­˜ç®¡ç†ï¼Œå®é™…ä¸Šæ˜¯ä¸€ç§åŸºäºâ€œå®¡è®¡â€çš„ç®¡ç†ï¼Œä¹Ÿå°±æ˜¯Sparkä¼šè®°å½•ä¸åŒå†…å­˜åŒºåŸŸçš„å†…å­˜æ¶ˆè€—ï¼Œä½†å®é™…çš„å†…å­˜ç”³è¯·ä¸é‡Šæ”¾ï¼Œè¿˜æ˜¯ä¾èµ–JVMæœ¬èº«ï¼Œæ¯”å¦‚å¯¹è±¡çš„å®é™…åˆ é™¤ï¼Œæ˜¯è¦ç­‰åˆ°GCçš„æ—¶å€™ã€‚<br><br>å…³äºå¯¹è±¡å°ºå¯¸çš„é¢„ä¼°ï¼Œæˆ–è€…è¯´å¯ç”¨å†…å­˜çš„é¢„ä¼°ï¼Œè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨å­—èŠ‚æ•°ç»„ï¼Œç¡®å®å­˜åœ¨é¢„ä¼°ä¸å‡†çš„é—®é¢˜ï¼Œè€Œè¿™ï¼Œä¹Ÿæ˜¯è¯¸å¦‚å¹¿æ’­å˜é‡æ—¶è€Œç”Ÿæ•ˆã€æ—¶è€Œä¸ç”Ÿæ•ˆçš„åŸå› æ‰€åœ¨ã€‚å› æ­¤ï¼Œå¯¹äºå†…å­˜çš„ä½¿ç”¨ï¼Œæˆ–è€…åˆ’åˆ†ï¼Œæˆ‘ä»¬å¾€å¾€å€¾å‘äºç•™å‡ºä¸€äº›å¯Œè£•ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†é¿å…Sparkè¯¯åˆ¤å¯ç”¨å‰©ä½™å†…å­˜è€Œå¯¼è‡´OOMã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1624008950,"ip_address":"","comment_id":297538,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10213539087","product_id":100073401,"comment_content":"è€å¸ˆè¯·æ•™ä¸‹ï¼Œexecution memoryã€storage memory çš„å„ç±»åˆ’åˆ†çš„ memory åœ¨å†…å­˜ä¸Šé€»è¾‘ä¸Šè¿ç»­ç‰©ç†ä¸Šä¸è¿ç»­çš„å—ï¼Ÿæ­¤å¤–åƒå†…å­˜é‡çš„æ§åˆ¶ï¼Œç”¨å­—èŠ‚æ•°ç»„å€’æ˜¯å¾ˆå¥½é¢„ä¼°ï¼Œå¯¹äºé‚£äº›æ²¡æœ‰ç³»åˆ—åŒ–çš„æ•°æ®ï¼Œæ€ä¹ˆå»æ§åˆ¶ä½¿ç”¨çš„å†…å­˜é‡å‘¢ï¼Ÿå¯¹è±¡çš„å†…å­˜åˆ†é…æ˜¯ç”± JVM å»ç®¡ç†ï¼Œ spark çš„åˆ é™¤æ˜¯å°†å¼ºå¼•ç”¨è®¾ç½®ä¸º null å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521849,"discussion_content":"execution memoryã€storage memoryçš„åˆ’åˆ†æ˜¯é€»è¾‘ä¸Šçš„~ Sparkåœ¨JVMä¹‹ä¸Šçš„å†…å­˜ç®¡ç†ï¼Œå®é™…ä¸Šæ˜¯ä¸€ç§åŸºäºâ€œå®¡è®¡â€çš„ç®¡ç†ï¼Œä¹Ÿå°±æ˜¯Sparkä¼šè®°å½•ä¸åŒå†…å­˜åŒºåŸŸçš„å†…å­˜æ¶ˆè€—ï¼Œä½†å®é™…çš„å†…å­˜ç”³è¯·ä¸é‡Šæ”¾ï¼Œè¿˜æ˜¯ä¾èµ–JVMæœ¬èº«ï¼Œæ¯”å¦‚å¯¹è±¡çš„å®é™…åˆ é™¤ï¼Œæ˜¯è¦ç­‰åˆ°GCçš„æ—¶å€™ã€‚\n\nå…³äºå¯¹è±¡å°ºå¯¸çš„é¢„ä¼°ï¼Œæˆ–è€…è¯´å¯ç”¨å†…å­˜çš„é¢„ä¼°ï¼Œè¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨å­—èŠ‚æ•°ç»„ï¼Œç¡®å®å­˜åœ¨é¢„ä¼°ä¸å‡†çš„é—®é¢˜ï¼Œè€Œè¿™ï¼Œä¹Ÿæ˜¯è¯¸å¦‚å¹¿æ’­å˜é‡æ—¶è€Œç”Ÿæ•ˆã€æ—¶è€Œä¸ç”Ÿæ•ˆçš„åŸå› æ‰€åœ¨ã€‚å› æ­¤ï¼Œå¯¹äºå†…å­˜çš„ä½¿ç”¨ï¼Œæˆ–è€…åˆ’åˆ†ï¼Œæˆ‘ä»¬å¾€å¾€å€¾å‘äºç•™å‡ºä¸€äº›å¯Œè£•ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†é¿å…Sparkè¯¯åˆ¤å¯ç”¨å‰©ä½™å†…å­˜è€Œå¯¼è‡´OOMã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624008950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291147,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1620051252,"is_pvip":false,"replies":[{"id":"105488","content":"ç¬¬äºŒã€ä¸‰é¢˜å®Œç¾~ ğŸ’¯<br><br>ç¬¬ä¸€é¢˜ç­”å¾—ä¹Ÿä¸é”™~ ç­‰åˆ°çœ‹å®ŒShuffleé‚£è®²ï¼Œå¯ä»¥å†å›è¿‡å¤´æ¥æƒ³æƒ³ï¼Œéƒ½æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Œå¯ä»¥åˆ©ç”¨åˆ°å †å¤–å†…å­˜~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1620120250,"ip_address":"","comment_id":291147,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10209985844","product_id":100073401,"comment_content":"ç¬¬ä¸€é¢˜ï¼š<br>ç¼“å­˜rddï¼šrdd.persist(StorageLevel.OFF_HEAP)<br><br>ç¬¬äºŒé¢˜ï¼š<br>å› ä¸ºå †å†…å†…å­˜çš„ç”³è¯·å’Œé‡Šæ”¾æ˜¯ç”±JVMæ¥ç»Ÿä¸€ç®¡ç†ï¼Œå¯¹Sparkæ¥è¯´æ˜¯ä¸é‚£ä¹ˆé€æ˜å¯æ§çš„ï¼›è€Œå †å¤–å†…å­˜éœ€è¦è°ƒç”¨Unsafeçš„allocateMemoryå’ŒfreeMemoryæ–¹æ³•æ¥è¿›è¡Œå†…å­˜çš„ç”³è¯·å’Œé‡Šæ”¾ï¼Œå®Œå…¨ç”±Sparkæ¥æ§åˆ¶ï¼Œæ‰€ä»¥ä¼°ç®—ä¼šç›¸å¯¹æ›´ç²¾å‡†ã€‚<br><br>ç¬¬ä¸‰é¢˜ï¼š<br>- Reservedï¼š300M<br>- Userï¼š(20GB - 300MB) * (1 - 0.8)<br>- Executionï¼š(20GB - 300MB) * 0.8 * (1 - 0.6) + 10GB * (1 - 0.6)<br>- Storageï¼š(20GB - 300MB) * 0.8 * 0.6 + 10GB * 0.6","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519385,"discussion_content":"ç¬¬äºŒã€ä¸‰é¢˜å®Œç¾~ ğŸ’¯\n\nç¬¬ä¸€é¢˜ç­”å¾—ä¹Ÿä¸é”™~ ç­‰åˆ°çœ‹å®ŒShuffleé‚£è®²ï¼Œå¯ä»¥å†å›è¿‡å¤´æ¥æƒ³æƒ³ï¼Œéƒ½æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Œå¯ä»¥åˆ©ç”¨åˆ°å †å¤–å†…å­˜~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620120250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2162751,"avatar":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","nickname":"Sean","note":"","ucode":"69234046BFD81B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390024,"discussion_content":"çœ‹åˆ°è¿™ä¸ªå›ç­”,çªç„¶æƒ³é—®ä¸‹è€å¸ˆ,æ—¢ç„¶executor memory å’Œ storage memory ä¸¤å—å†…å­˜ä¸share,é‚£æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡persistæ¥æŒ‡å®šå‘¢,ä¸€éƒ¨åˆ†rddä½¿ç”¨execm ä¸€éƒ¨åˆ†rddä½¿ç”¨stormå‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629615282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288885,"user_name":"LYL","can_delete":false,"product_type":"c1","uid":2155021,"ip_address":"","ucode":"B95850B5A3E85B","user_header":"https://static001.geekbang.org/account/avatar/00/20/e2/0d/d7a012b7.jpg","comment_is_top":false,"comment_ctime":1618751176,"is_pvip":false,"replies":[{"id":"104852","content":"1. Tungstenç¡®å®ç»Ÿä¸€äº†å†…å­˜ç®¡ç†ï¼Œä½¿ç”¨Pageæ¥ç®¡ç†å†…å­˜ï¼Œè¿™æ ·åšå¾—ç›®çš„ï¼Œä¸»è¦åœ¨äºç»Ÿä¸€å†…å­˜å¯¹è±¡ï¼ˆå†…å­˜é¡µï¼‰æŠ½è±¡ã€‚å¯¹äºå †å†…æ¥è¯´ï¼Œå†…å­˜é¡µæœ¬è´¨ä¸Šå°±æ˜¯ä¸ªå¤§å¯¹è±¡ï¼Œæ²¡ä»€ä¹ˆæ–°é²œçš„ï¼›ä½†å¯¹äºå †å¤–æ¥è¯´ï¼Œé‚£å¯æ­£å„¿å…«ç»çš„æ˜¯OSçš„å†…å­˜å¯»å€ã€‚å› æ­¤ï¼Œä¸¤å—å†…å­˜ä¸èƒ½â€œåŒæ—¶â€ä½¿ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªä»»åŠ¡ï¼Œä¸ç®¡æ˜¯æ‰§è¡Œä»»åŠ¡ã€è¿˜æ˜¯ç¼“å­˜ä»»åŠ¡ï¼Œä½ è¦ä¹ˆç”¨å †å¤–ï¼Œè¦ä¹ˆç”¨å †å†…ï¼Œé©´å’Œç†ŠçŒ«ä¸å¯å…¼å¾—ï¼Œä¸èƒ½è„šè¸ä¸¤æ¡èˆ¹ã€‚<br><br>2. å¼€å¯å †å¤–ä¹‹åï¼Œæ‰§è¡Œä»»åŠ¡é»˜è®¤ä¼šèµ°å †å¤–ï¼Œå †å¤–ç”¨å°½äº†ï¼Œåç»­çš„ä»»åŠ¡æ‰ä¼šèµ°å †å†…ã€‚å¯¹äºç¼“å­˜æ¥è¯´ï¼Œå¦‚æœä½ æ˜ç¡®æŒ‡å®šäº†ç”¨off heapï¼Œé‚£å°±æ˜¯æ˜ç¡®èµ°å †å¤–ï¼Œå¦‚æœä½ ä¸æ˜ç¡®æŒ‡å®šï¼Œé‚£ä¹ˆé»˜è®¤èµ°å †å†…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1618758898,"ip_address":"","comment_id":288885,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10208685768","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæœ‰å‡ ä¸ªé—®é¢˜æˆ‘ä¸å¤ªæ˜ç™½ï¼Œ<br>1.tungstenä¸­çš„pageç”¨äºåŒä¸€ç®¡ç†off-heapå’Œon-heapï¼Œåˆ©ç”¨è¿™ä¸ªæœºåˆ¶å¯å¦åœ¨spark runtimeçš„æ—¶å€™shuffleåŒæ—¶ä½¿ç”¨å †å†…å’Œå †å¤–å†…å­˜ï¼Ÿ<br>2.åœ¨cache rddçš„æ—¶å€™æ˜¯å¦èƒ½æŒ‡å®šStorageLevelä¸ºoff_heapåœ¨spark runtimeæ—¶ä½¿ç”¨å †å¤–å†…å­˜ï¼Œmemory_onlyçš„æƒ…å†µä¸‹ä½¿ç”¨å †å†…å†…å­˜ï¼Œæˆ–è€…è¯´åœ¨é…ç½®å¼€å¯å †å¤–å†…å­˜çš„å‚æ•°ä¹‹åï¼Œæ‰€æœ‰å†…å­˜éƒ½æ˜¯èµ°å †å¤–å†…å­˜ï¼Œæ— æ³•ä½¿ç”¨å †å†…å†…å­˜","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518761,"discussion_content":"1. Tungstenç¡®å®ç»Ÿä¸€äº†å†…å­˜ç®¡ç†ï¼Œä½¿ç”¨Pageæ¥ç®¡ç†å†…å­˜ï¼Œè¿™æ ·åšå¾—ç›®çš„ï¼Œä¸»è¦åœ¨äºç»Ÿä¸€å†…å­˜å¯¹è±¡ï¼ˆå†…å­˜é¡µï¼‰æŠ½è±¡ã€‚å¯¹äºå †å†…æ¥è¯´ï¼Œå†…å­˜é¡µæœ¬è´¨ä¸Šå°±æ˜¯ä¸ªå¤§å¯¹è±¡ï¼Œæ²¡ä»€ä¹ˆæ–°é²œçš„ï¼›ä½†å¯¹äºå †å¤–æ¥è¯´ï¼Œé‚£å¯æ­£å„¿å…«ç»çš„æ˜¯OSçš„å†…å­˜å¯»å€ã€‚å› æ­¤ï¼Œä¸¤å—å†…å­˜ä¸èƒ½â€œåŒæ—¶â€ä½¿ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªä»»åŠ¡ï¼Œä¸ç®¡æ˜¯æ‰§è¡Œä»»åŠ¡ã€è¿˜æ˜¯ç¼“å­˜ä»»åŠ¡ï¼Œä½ è¦ä¹ˆç”¨å †å¤–ï¼Œè¦ä¹ˆç”¨å †å†…ï¼Œé©´å’Œç†ŠçŒ«ä¸å¯å…¼å¾—ï¼Œä¸èƒ½è„šè¸ä¸¤æ¡èˆ¹ã€‚\n\n2. å¼€å¯å †å¤–ä¹‹åï¼Œæ‰§è¡Œä»»åŠ¡é»˜è®¤ä¼šèµ°å †å¤–ï¼Œå †å¤–ç”¨å°½äº†ï¼Œåç»­çš„ä»»åŠ¡æ‰ä¼šèµ°å †å†…ã€‚å¯¹äºç¼“å­˜æ¥è¯´ï¼Œå¦‚æœä½ æ˜ç¡®æŒ‡å®šäº†ç”¨off heapï¼Œé‚£å°±æ˜¯æ˜ç¡®èµ°å †å¤–ï¼Œå¦‚æœä½ ä¸æ˜ç¡®æŒ‡å®šï¼Œé‚£ä¹ˆé»˜è®¤èµ°å †å†…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618758898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340066,"user_name":"èµŒç¥å¾ˆä½è°ƒ","can_delete":false,"product_type":"c1","uid":1168545,"ip_address":"","ucode":"1066778E1EDF26","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/a1/8bc8e7e1.jpg","comment_is_top":false,"comment_ctime":1648564722,"is_pvip":true,"replies":[{"id":"124386","content":"1ã€sparkä¸­å†…å­˜åˆ’åˆ†æ˜¯é€»è¾‘ä¸Šçš„ï¼ŒçœŸæ­£çš„ç®¡ç†è¿˜æ˜¯åœ¨jvmã€‚å¦‚user memoryå ç”¨å†…å­˜è¶…è¿‡è®¾å®šå€¼ï¼Œè¿˜æ˜¯ä¼šå ç”¨æ¡†æ¶å†…å­˜ã€‚ä½†æ¡†æ¶å†…å­˜ä¼šæ ¹æ®è®¾å®šå€¼è®©taskåšä¸€äº›é˜»å¡æˆ–spillæ“ä½œï¼Œæ‰€ä»¥ä»è¿™ä¸ªå±‚é¢ä¸Šè¯´ï¼Œæ¡†æ¶å†…å­˜çš„å€¼å¾—æ­£ç¡®è®¾ç½®ï¼Œå¦‚ç”¨æˆ·ä¸ä¼šç”¨åˆ°å¤§çš„listã€mapç­‰å†…å­˜é›†åˆï¼Œå°±è¦æŠŠç”¨æˆ·å†…å­˜ç©ºé—´è®¾ç½®å¾—å¤Ÿå°ï¼Œä»¥ä¿è¯æ¡†æ¶å†…å­˜(æ‰§è¡Œå†…å­˜+å­˜å‚¨å†…å­˜)è¶³å¤Ÿå¤§ï¼Œé¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–spillæ“ä½œï¼Ÿ<br><br>å›ç­”ï¼šæ˜¯çš„ï¼ŒSparkçš„å†…å­˜ç®¡ç†ï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§â€å®¡è®¡â€œä¸Šçš„ç®¡ç†ï¼Œåº•ä¸‹æœ‰JVMï¼ŒSparkå°±ä¸å¯èƒ½ç›´æ¥ç®¡ç†å†…å­˜ã€‚é€šè¿‡å†…å­˜ç®¡ç†æœºåˆ¶ï¼ŒSparkæ›´å¤šåœ°æ˜¯è®¾ç½®ä¸€äº›è½¯é™åˆ¶ï¼Œä»è€Œä»åº”ç”¨å±‚é¢æ¥å°†å†…å­˜åˆ’åˆ†ä¸ºä¸åŒåŒºåŸŸï¼Œè¿™äº›åŒºåŸŸï¼Œåœ¨JVMçœ‹æ¥ï¼Œæ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚å¦‚ä½ æ‰€è¯´ï¼šâ€å¦‚ç”¨æˆ·ä¸ä¼šç”¨åˆ°å¤§çš„listã€mapç­‰å†…å­˜é›†åˆï¼Œå°±è¦æŠŠç”¨æˆ·å†…å­˜ç©ºé—´è®¾ç½®å¾—å¤Ÿå°ï¼Œä»¥ä¿è¯æ¡†æ¶å†…å­˜(æ‰§è¡Œå†…å­˜+å­˜å‚¨å†…å­˜)è¶³å¤Ÿå¤§ï¼Œé¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–spillæ“ä½œâ€œï¼Œç¡®å®æ˜¯è¿™æ ·çš„ã€‚<br><br>2ã€å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜,å³ä½¿å †å¤–å†…å­˜ä¸å¤Ÿï¼Œå †å†…å†…å­˜å……è¶³ï¼Œtaskä¹Ÿåªä¼šç”¨å †å¤–å†…å­˜è€Œä¸ä¼šç”¨å †å†…å†…å­˜ï¼Ÿ<br>å›ç­”ï¼šå†…å­˜æ˜¯ç”¨å †å¤–ï¼Œè¿˜æ˜¯å †å†…ï¼Œæ˜¯ä»¥Jobä¸ºç²’åº¦çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦è®¾ç½®å †å¤–å†…å­˜ï¼Œæˆ‘ä»¬å¾—ç¡®ä¿å †å¤–å¤§å°è¶³ä»¥åº”å¯¹å½“å‰çš„ä½œä¸šï¼Œä½œä¸šé‡Œé¢æ‰€æœ‰çš„tasksï¼Œéƒ½åªèƒ½ç”¨å †å¤–ï¼ˆå¦‚æœä½œä¸šåœ¨å†…å­˜è®¾ç½®ä¸Šç”¨äº†å †å¤–ï¼‰ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼Œæ­¤æ—¶è·‘åœ¨å †å¤–çš„Jobï¼Œå‡è®¾å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œå³ä¾¿å †å†…è¿˜æœ‰å‰©ä½™ï¼Œä¹Ÿä¸ä¼šç»™è¿™ä¸ªJobç”¨ï¼Œè¿™ä¸ªJobè¿˜æ˜¯ä¼šæŠ›OOMã€‚<br><br>3ã€spark 2.xç‰ˆæœ¬ä¸­å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜ï¼Œå¹¶è®¾ç½®äº†spark.memory.offHeap.size=500mb,åœ¨yarnä¸Šè·‘çš„è¯spark.executor.memoryOverheadé™¤äº†é»˜è®¤éœ€è¦çš„10%æ˜¯å¦è¿˜æœ‰è¦åŠ ä¸Šè¿™500mbï¼Œå¦åˆ™containerä¸ä¼šåˆ†é…å †å¤–è¿™500mbçš„å†…å­˜ï¼Ÿçœ‹ç½‘ä¸Šè¯´3.0ä»¥ä¸Šå°±ä¸ç”¨åŠ äº†ã€‚<br>å›ç­”ï¼šå¯¹çš„ï¼Œå †å¤–å°±æ˜¯JVM heapä»¥å¤–çš„å†…å­˜ï¼Œä»¥å‰çš„è¯ï¼ŒyarnæŠŠè¿™éƒ¨åˆ†å†…å­˜ç®—åœ¨containeré‡Œé¢ï¼Œç°åœ¨ä¸ç®—åœ¨containeré‡Œé¢äº†ï¼Œä¸è¿‡è¿™æ ·å…¶å®æœ‰é£é™©ï¼Œå› ä¸ºå †å¤–å†…å­˜å¤§å°ï¼Œå¯¹äºyarnæ¥è¯´é€æ˜äº†ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶ï¼ŒSpark Jobè·‘ç€è·‘ç€ï¼Œå‘ç°OSæ ¹æœ¬åˆ†é…ä¸äº†500mbï¼Œé‚£è¿™ä¸ªäº‹æƒ…yarnæ˜¯ä¸è´Ÿè´£çš„ã€‚<br><br>4ã€taskä¼šåœ¨å“ªäº›åœºæ™¯ç”³è¯·å’Œé‡Šæ”¾å†…å­˜å‘¢ï¼Ÿåªæ˜¯shuffleçš„åœºæ™¯å—ï¼Ÿtransformeråœºæ™¯ä¼šå—ï¼Ÿ<br>å›ç­”ï¼šå‡¡æ˜¯åˆ©ç”¨åˆ°AppendOnlyMapï¼ŒPartitionPairBufferè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„çš„è®¡ç®—ï¼Œéƒ½è¦ç”³è¯·ã€é‡Šæ”¾å†…å­˜ï¼Œè·Ÿç®—å­æ²¡å•¥å…³ç³»å“ˆï¼Œä¸»è¦æ˜¯shuffle writeé˜¶æ®µçš„è®¡ç®—ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç¼–è¾‘","uid":"1501385","ctime":1648636107,"ip_address":"","comment_id":340066,"utype":2}],"discussion_count":1,"race_medal":0,"score":"5943532018","product_id":100073401,"comment_content":"è€å¸ˆå¥½ï¼Œæœ‰å‡ ä¸ªé—®é¢˜ä¸æ˜¯å¾ˆæ˜ç™½æƒ³é—®ä¸‹:<br>1ã€sparkä¸­å†…å­˜åˆ’åˆ†æ˜¯é€»è¾‘ä¸Šçš„ï¼ŒçœŸæ­£çš„ç®¡ç†è¿˜æ˜¯åœ¨jvmã€‚å¦‚user memoryå ç”¨å†…å­˜è¶…è¿‡è®¾å®šå€¼ï¼Œè¿˜æ˜¯ä¼šå ç”¨æ¡†æ¶å†…å­˜ã€‚ä½†æ¡†æ¶å†…å­˜ä¼šæ ¹æ®è®¾å®šå€¼è®©taskåšä¸€äº›é˜»å¡æˆ–spillæ“ä½œï¼Œæ‰€ä»¥ä»è¿™ä¸ªå±‚é¢ä¸Šè¯´ï¼Œæ¡†æ¶å†…å­˜çš„å€¼å¾—æ­£ç¡®è®¾ç½®ï¼Œå¦‚ç”¨æˆ·ä¸ä¼šç”¨åˆ°å¤§çš„listã€mapç­‰å†…å­˜é›†åˆï¼Œå°±è¦æŠŠç”¨æˆ·å†…å­˜ç©ºé—´è®¾ç½®å¾—å¤Ÿå°ï¼Œä»¥ä¿è¯æ¡†æ¶å†…å­˜(æ‰§è¡Œå†…å­˜+å­˜å‚¨å†…å­˜)è¶³å¤Ÿå¤§ï¼Œé¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–spillæ“ä½œï¼Ÿ\r<br>2ã€å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜,å³ä½¿å †å¤–å†…å­˜ä¸å¤Ÿï¼Œå †å†…å†…å­˜å……è¶³ï¼Œtaskä¹Ÿåªä¼šç”¨å †å¤–å†…å­˜è€Œä¸ä¼šç”¨å †å†…å†…å­˜ï¼Ÿ\r<br>3ã€spark 2.xç‰ˆæœ¬ä¸­å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜ï¼Œå¹¶è®¾ç½®äº†spark.memory.offHeap.size=500mb,åœ¨yarnä¸Šè·‘çš„è¯spark.executor.memoryOverheadé™¤äº†é»˜è®¤éœ€è¦çš„10%æ˜¯å¦è¿˜æœ‰è¦åŠ ä¸Šè¿™500mbï¼Œå¦åˆ™containerä¸ä¼šåˆ†é…å †å¤–è¿™500mbçš„å†…å­˜ï¼Ÿçœ‹ç½‘ä¸Šè¯´3.0ä»¥ä¸Šå°±ä¸ç”¨åŠ äº†ã€‚\r<br>4ã€taskä¼šåœ¨å“ªäº›åœºæ™¯ç”³è¯·å’Œé‡Šæ”¾å†…å­˜å‘¢ï¼Ÿåªæ˜¯shuffleçš„åœºæ™¯å—ï¼Ÿtransformeråœºæ™¯ä¼šå—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1501385,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e8/c9/59bcd490.jpg","nickname":"å¬æ°´çš„æ¹–","note":"","ucode":"B1759F90165D81","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559176,"discussion_content":"1ã€sparkä¸­å†…å­˜åˆ’åˆ†æ˜¯é€»è¾‘ä¸Šçš„ï¼ŒçœŸæ­£çš„ç®¡ç†è¿˜æ˜¯åœ¨jvmã€‚å¦‚user memoryå ç”¨å†…å­˜è¶…è¿‡è®¾å®šå€¼ï¼Œè¿˜æ˜¯ä¼šå ç”¨æ¡†æ¶å†…å­˜ã€‚ä½†æ¡†æ¶å†…å­˜ä¼šæ ¹æ®è®¾å®šå€¼è®©taskåšä¸€äº›é˜»å¡æˆ–spillæ“ä½œï¼Œæ‰€ä»¥ä»è¿™ä¸ªå±‚é¢ä¸Šè¯´ï¼Œæ¡†æ¶å†…å­˜çš„å€¼å¾—æ­£ç¡®è®¾ç½®ï¼Œå¦‚ç”¨æˆ·ä¸ä¼šç”¨åˆ°å¤§çš„listã€mapç­‰å†…å­˜é›†åˆï¼Œå°±è¦æŠŠç”¨æˆ·å†…å­˜ç©ºé—´è®¾ç½®å¾—å¤Ÿå°ï¼Œä»¥ä¿è¯æ¡†æ¶å†…å­˜(æ‰§è¡Œå†…å­˜+å­˜å‚¨å†…å­˜)è¶³å¤Ÿå¤§ï¼Œé¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–spillæ“ä½œï¼Ÿ\n\nå›ç­”ï¼šæ˜¯çš„ï¼ŒSparkçš„å†…å­˜ç®¡ç†ï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§â€å®¡è®¡â€œä¸Šçš„ç®¡ç†ï¼Œåº•ä¸‹æœ‰JVMï¼ŒSparkå°±ä¸å¯èƒ½ç›´æ¥ç®¡ç†å†…å­˜ã€‚é€šè¿‡å†…å­˜ç®¡ç†æœºåˆ¶ï¼ŒSparkæ›´å¤šåœ°æ˜¯è®¾ç½®ä¸€äº›è½¯é™åˆ¶ï¼Œä»è€Œä»åº”ç”¨å±‚é¢æ¥å°†å†…å­˜åˆ’åˆ†ä¸ºä¸åŒåŒºåŸŸï¼Œè¿™äº›åŒºåŸŸï¼Œåœ¨JVMçœ‹æ¥ï¼Œæ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚å¦‚ä½ æ‰€è¯´ï¼šâ€å¦‚ç”¨æˆ·ä¸ä¼šç”¨åˆ°å¤§çš„listã€mapç­‰å†…å­˜é›†åˆï¼Œå°±è¦æŠŠç”¨æˆ·å†…å­˜ç©ºé—´è®¾ç½®å¾—å¤Ÿå°ï¼Œä»¥ä¿è¯æ¡†æ¶å†…å­˜(æ‰§è¡Œå†…å­˜+å­˜å‚¨å†…å­˜)è¶³å¤Ÿå¤§ï¼Œé¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–spillæ“ä½œâ€œï¼Œç¡®å®æ˜¯è¿™æ ·çš„ã€‚\n\n2ã€å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜,å³ä½¿å †å¤–å†…å­˜ä¸å¤Ÿï¼Œå †å†…å†…å­˜å……è¶³ï¼Œtaskä¹Ÿåªä¼šç”¨å †å¤–å†…å­˜è€Œä¸ä¼šç”¨å †å†…å†…å­˜ï¼Ÿ\nå›ç­”ï¼šå†…å­˜æ˜¯ç”¨å †å¤–ï¼Œè¿˜æ˜¯å †å†…ï¼Œæ˜¯ä»¥Jobä¸ºç²’åº¦çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦è®¾ç½®å †å¤–å†…å­˜ï¼Œæˆ‘ä»¬å¾—ç¡®ä¿å †å¤–å¤§å°è¶³ä»¥åº”å¯¹å½“å‰çš„ä½œä¸šï¼Œä½œä¸šé‡Œé¢æ‰€æœ‰çš„tasksï¼Œéƒ½åªèƒ½ç”¨å †å¤–ï¼ˆå¦‚æœä½œä¸šåœ¨å†…å­˜è®¾ç½®ä¸Šç”¨äº†å †å¤–ï¼‰ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼Œæ­¤æ—¶è·‘åœ¨å †å¤–çš„Jobï¼Œå‡è®¾å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œå³ä¾¿å †å†…è¿˜æœ‰å‰©ä½™ï¼Œä¹Ÿä¸ä¼šç»™è¿™ä¸ªJobç”¨ï¼Œè¿™ä¸ªJobè¿˜æ˜¯ä¼šæŠ›OOMã€‚\n\n3ã€spark 2.xç‰ˆæœ¬ä¸­å¦‚æœå¼€å¯äº†å †å¤–å†…å­˜ï¼Œå¹¶è®¾ç½®äº†spark.memory.offHeap.size=500mb,åœ¨yarnä¸Šè·‘çš„è¯spark.executor.memoryOverheadé™¤äº†é»˜è®¤éœ€è¦çš„10%æ˜¯å¦è¿˜æœ‰è¦åŠ ä¸Šè¿™500mbï¼Œå¦åˆ™containerä¸ä¼šåˆ†é…å †å¤–è¿™500mbçš„å†…å­˜ï¼Ÿçœ‹ç½‘ä¸Šè¯´3.0ä»¥ä¸Šå°±ä¸ç”¨åŠ äº†ã€‚\nå›ç­”ï¼šå¯¹çš„ï¼Œå †å¤–å°±æ˜¯JVM heapä»¥å¤–çš„å†…å­˜ï¼Œä»¥å‰çš„è¯ï¼ŒyarnæŠŠè¿™éƒ¨åˆ†å†…å­˜ç®—åœ¨containeré‡Œé¢ï¼Œç°åœ¨ä¸ç®—åœ¨containeré‡Œé¢äº†ï¼Œä¸è¿‡è¿™æ ·å…¶å®æœ‰é£é™©ï¼Œå› ä¸ºå †å¤–å†…å­˜å¤§å°ï¼Œå¯¹äºyarnæ¥è¯´é€æ˜äº†ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶ï¼ŒSpark Jobè·‘ç€è·‘ç€ï¼Œå‘ç°OSæ ¹æœ¬åˆ†é…ä¸äº†500mbï¼Œé‚£è¿™ä¸ªäº‹æƒ…yarnæ˜¯ä¸è´Ÿè´£çš„ã€‚\n\n4ã€taskä¼šåœ¨å“ªäº›åœºæ™¯ç”³è¯·å’Œé‡Šæ”¾å†…å­˜å‘¢ï¼Ÿåªæ˜¯shuffleçš„åœºæ™¯å—ï¼Ÿtransformeråœºæ™¯ä¼šå—ï¼Ÿ\nå›ç­”ï¼šå‡¡æ˜¯åˆ©ç”¨åˆ°AppendOnlyMapï¼ŒPartitionPairBufferè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„çš„è®¡ç®—ï¼Œéƒ½è¦ç”³è¯·ã€é‡Šæ”¾å†…å­˜ï¼Œè·Ÿç®—å­æ²¡å•¥å…³ç³»å“ˆï¼Œä¸»è¦æ˜¯shuffle writeé˜¶æ®µçš„è®¡ç®—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648636107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":8}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317347,"user_name":"sparkjoy","can_delete":false,"product_type":"c1","uid":1000179,"ip_address":"","ucode":"827B3116EED3B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","comment_is_top":false,"comment_ctime":1634746706,"is_pvip":false,"replies":[{"id":"115140","content":"è¯„è®ºåŒºå¯¹äºå †å†…ã€å †å¤–çš„è®¨è®ºæ¯”è¾ƒå¤šï¼Œè€å¼Ÿå¯ä»¥å‚è€ƒä¸‹å“ˆ~<br><br>æ€»çš„æ¥è¯´ï¼Œå †å†…ã€å †å¤–æ˜¯ä»¥Jobä¸ºç²’åº¦åˆ’åˆ†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªJobï¼Œè¦ä¹ˆï¼Œä½ å…¨ç”¨å †å¤–ï¼Œè¦ä¹ˆï¼Œä½ å…¨ç”¨å †å†…ã€‚å †å¤–ã€å †å†…çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯ä¸èƒ½åœ¨åŒä¸€ä¸ªJobä¹‹å†…å…±äº«çš„ã€‚<br><br>è¿™éƒ¨åˆ†ï¼Œå¦‚æœçœ‹æºç çš„è¯ï¼Œå¯ä»¥æŠŠorg.apache.spark.memoryä¸‹é¢çš„æºç ï¼Œé€šè¯»ä¸€é~ å¦‚æœåªå…³æ³¨å †å¤–ã€å †å†…æ¶ˆè€—ç›¸å…³çš„æºç ï¼Œå¯ä»¥ä»è¿™ä¸ªæ–‡ä»¶å¼€å§‹ï¼šTaskMemoryManager.java","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634890916,"ip_address":"","comment_id":317347,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5929714002","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæ€ä¹ˆçŸ¥é“æ˜¯å †å¤–ç”¨å®Œäº†æ‰ç”¨å †å†…å‘¢ï¼Ÿèƒ½æŒ‡å¯¼ä¸€ä¸‹æºç çš„å‡ºå¤„ä¹ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528781,"discussion_content":"è¯„è®ºåŒºå¯¹äºå †å†…ã€å †å¤–çš„è®¨è®ºæ¯”è¾ƒå¤šï¼Œè€å¼Ÿå¯ä»¥å‚è€ƒä¸‹å“ˆ~\n\næ€»çš„æ¥è¯´ï¼Œå †å†…ã€å †å¤–æ˜¯ä»¥Jobä¸ºç²’åº¦åˆ’åˆ†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªJobï¼Œè¦ä¹ˆï¼Œä½ å…¨ç”¨å †å¤–ï¼Œè¦ä¹ˆï¼Œä½ å…¨ç”¨å †å†…ã€‚å †å¤–ã€å †å†…çš„å†…å­˜ç©ºé—´ï¼Œæ˜¯ä¸èƒ½åœ¨åŒä¸€ä¸ªJobä¹‹å†…å…±äº«çš„ã€‚\n\nè¿™éƒ¨åˆ†ï¼Œå¦‚æœçœ‹æºç çš„è¯ï¼Œå¯ä»¥æŠŠorg.apache.spark.memoryä¸‹é¢çš„æºç ï¼Œé€šè¯»ä¸€é~ å¦‚æœåªå…³æ³¨å †å¤–ã€å †å†…æ¶ˆè€—ç›¸å…³çš„æºç ï¼Œå¯ä»¥ä»è¿™ä¸ªæ–‡ä»¶å¼€å§‹ï¼šTaskMemoryManager.java","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634890916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1711247,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/1c/8f/a5e25ee4.jpg","nickname":"è±ª","note":"","ucode":"D0CE3C5B60C5E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414449,"discussion_content":"æºç æ•æ‰å®åŠ›è¿˜ä¸å¤Ÿå¼ºğŸ˜‚ï¼Œçœ‹äº†åŠå¤©æ²¡æ‰¾åˆ° ä¸€ä¸ªjobå †å¤–ä¸å¤Ÿç”¨æ—¶è½¬ç”¨å †å†… çš„æºç ï¼Œè€å¸ˆèƒ½æŒ‡ç‚¹ä¸‹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636769303,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308726,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":2162751,"ip_address":"","ucode":"69234046BFD81B","user_header":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","comment_is_top":false,"comment_ctime":1629772418,"is_pvip":false,"replies":[{"id":"112654","content":"1. persiståªèƒ½ç”¨æ¥æŒ‡å®šå­˜å‚¨æ¨¡å¼ï¼Œmemoryè¿˜æ˜¯diskï¼Œä½†ä¸ç®¡ä»€ä¹ˆç¼“å­˜ï¼Œéƒ½åªèƒ½æ¶ˆè€—Storage Memory<br>2. å¯¹çš„ï¼Œoff heapå¿…é¡»æ˜¾ç¤ºå¼€å¯æ‰è¡Œã€‚ä¸€æ—¦å¼€å¯off heapï¼Œä½œä¸šä¼šä¼˜å…ˆç”¨off heap<br>3. è¿™ä¸ªæ¯”è¾ƒéš¾ï¼Œoff heapã€on heapï¼Œæ˜¯ä»¥ä½œä¸šä¸ºæ§åˆ¶ç²’åº¦çš„ï¼Œä¸æ˜¯ä»¥taskä¸ºæ§åˆ¶ç²’åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªä½œä¸šï¼Œè¦ä¹ˆéƒ½ç”¨off heapï¼Œè¦ä¹ˆéƒ½ç”¨on heapï¼Œä¸å­˜åœ¨ä¸€ä¸ªä½œä¸šå†…éƒ¨ä¸åŒtaskï¼Œæœ‰çš„ç”¨å †å¤–ã€æœ‰çš„ç”¨å †å†…ã€‚è¿™ä¸ªå®ç°æœºåˆ¶å…¶å®æ˜¯æœ‰ä¼˜åŒ–ç©ºé—´çš„~<br>4. è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ç†è§£æ˜¯ç”¨æ¥blacklist executorsç”¨çš„ï¼Œä¹Ÿå°±æ˜¯å½“ä¸€äº›executorsé¢‘ç¹å¤±è´¥ï¼Œsparkä¼šæŠŠä»–ä»¬æ ‡è®°åˆ°blacklisté»‘åå•ï¼Œé¿å…ä¸‹æ¬¡DAGScheduleræŠŠä»»åŠ¡è°ƒåº¦åˆ°æ ‡è®°åˆ°blacklistçš„executorsä¸Šé¢å»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1630941123,"ip_address":"","comment_id":308726,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5924739714","product_id":100073401,"comment_content":"ä»ç¬¬ä¸€ç« çœ‹åˆ°äº†ç¬¬åä¸€ç« ,åœ¨ç•™è¨€å»é‡Œé¢å­¦ä¹ åˆ°äº†å¾ˆå¤š,è€å¸ˆå¯¹çŸ¥è¯†çš„ä¼ æˆä¹Ÿå¾ˆæœ‰æŠ€å·§,ä¸ªäººä¹Ÿæ˜¯å—ç›ŠåŒªæµ…,éšç€é˜…è¯»çš„æ…¢æ…¢æ·±å…¥çš„,æ€»ç»“äº†ä¸€äº›è‡ªå·±ç†è§£å’Œç–‘æƒ‘,ç°åœ¨åˆå›åˆ°äº†ç¬¬ä¸ƒç« ,æ€»ç»“äº†ä¸€äº›é—®é¢˜,å¸Œæœ›è€å¸ˆå¯ä»¥å¸®å¿™è§£æƒ‘,æ„Ÿè°¢!<br>1.åœ¨ç¼“å­˜rddæ—¶,æ—¢ç„¶executor memory å’Œ storage memory ä¸¤å—å†…å­˜ä¸å¯äº’ç›¸share,é‚£æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡persistæ¥æŒ‡å®šå‘¢,ä¸€éƒ¨åˆ†rddä½¿ç”¨execm ä¸€éƒ¨åˆ†rddä½¿ç”¨stormå‘¢?<br>2.åªè¦ä¸å¼€å¯off heap,sparkå°±æ— æ³•ä½¿ç”¨off heap,åŒ…æ‹¬yarn,k8sæ¨¡å¼åˆ©ç”¨off heapæå‡ç¨³å®šæ€§ä¹Ÿæ— æ³•ä½“ç°å‡ºæ¥,ä¸€æ—¦å¼€å¯äº†off heap,æ‰§è¡Œä»»åŠ¡ä¹Ÿå°±æ˜¯executor memoryä¼˜å…ˆä½¿ç”¨off heap,storage memoryè¿˜æ˜¯ä¼˜å…ˆå †å†…å†…å­˜,å¯ä»¥è¿™æ ·ç†è§£å—?<br>3.ä¾‹å¦‚ï¼šspark executorå¦‚æœé…ç½®äº†å †å†…å’Œå †å¤–å„4GBï¼Œexecutor coresé…ç½®ä¸º2ã€‚é‚£ä¹ˆè¯¥executorè¿è¡Œçš„ç¬¬ä¸€ä¸ªtaskåªä¼šä½¿ç”¨å †å¤–å†…å­˜ï¼Ÿè°ƒåº¦æ¥çš„ç¬¬äºŒä¸ªtaskï¼Œå“ªæ€•å †å¤–å‰©ä½™å‡ åMBï¼Œå®ƒä¹Ÿä¼šç”¨å †å¤–å†…å­˜ï¼Œå¦‚æœç¬¬äºŒä¸ªtaskå‘ç°å †å¤–ä¸å¤Ÿç”¨ï¼Œå°±ä¼šå†™ç£ç›˜,æˆ–æ¸…é™¤éƒ¨åˆ†å †å¤–å†…å­˜æ•°æ®å‘¢<br>4.shuffle é˜¶æ®µçš„ç¨³å®šæ€§å‚æ•° spark.excludeOnFailure.application.fetchFailure.enabled ä»å®˜ç½‘æè¿°ä¸Šæ¥çœ‹,è¿™ä¸ªå‚æ•°å¯¹fetch failedä¼šåˆ‡æ¢åˆ°åˆ«çš„èŠ‚ç‚¹,ç»“åˆå®é™…æƒ…å†µ,åœ¨Map é˜¶æ®µï¼šShuffle writer æŒ‰ç…§ Reducer çš„åˆ†åŒºè§„åˆ™å°†ä¸­é—´æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜è¿‡ç¨‹ä¸­,åˆšå¥½å†™äººçš„datanode çš„æ•°æ®å·æ•…éšœ,ä½†æ˜¯å¹¶æ²¡æœ‰è§¦å‘é‡è¯•æœºåˆ¶,è€Œæ˜¯ä¸€ç›´runingçŠ¶æ€,æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡å¯ç”¨application.fetchFailure.enabledæ¥è¯†åˆ«,ç›®å‰ä½¿ç”¨çš„æ˜¯ç‰©ç†æœº,è¿™ç§æƒ…å†µä¹Ÿæ˜¯å¶å°”å‘ç”Ÿä¸€æ¬¡,æ‰€ä»¥å¾ˆéš¾éªŒè¯","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525604,"discussion_content":"1. persiståªèƒ½ç”¨æ¥æŒ‡å®šå­˜å‚¨æ¨¡å¼ï¼Œmemoryè¿˜æ˜¯diskï¼Œä½†ä¸ç®¡ä»€ä¹ˆç¼“å­˜ï¼Œéƒ½åªèƒ½æ¶ˆè€—Storage Memory\n2. å¯¹çš„ï¼Œoff heapå¿…é¡»æ˜¾ç¤ºå¼€å¯æ‰è¡Œã€‚ä¸€æ—¦å¼€å¯off heapï¼Œä½œä¸šä¼šä¼˜å…ˆç”¨off heap\n3. è¿™ä¸ªæ¯”è¾ƒéš¾ï¼Œoff heapã€on heapï¼Œæ˜¯ä»¥ä½œä¸šä¸ºæ§åˆ¶ç²’åº¦çš„ï¼Œä¸æ˜¯ä»¥taskä¸ºæ§åˆ¶ç²’åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªä½œä¸šï¼Œè¦ä¹ˆéƒ½ç”¨off heapï¼Œè¦ä¹ˆéƒ½ç”¨on heapï¼Œä¸å­˜åœ¨ä¸€ä¸ªä½œä¸šå†…éƒ¨ä¸åŒtaskï¼Œæœ‰çš„ç”¨å †å¤–ã€æœ‰çš„ç”¨å †å†…ã€‚è¿™ä¸ªå®ç°æœºåˆ¶å…¶å®æ˜¯æœ‰ä¼˜åŒ–ç©ºé—´çš„~\n4. è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ç†è§£æ˜¯ç”¨æ¥blacklist executorsç”¨çš„ï¼Œä¹Ÿå°±æ˜¯å½“ä¸€äº›executorsé¢‘ç¹å¤±è´¥ï¼Œsparkä¼šæŠŠä»–ä»¬æ ‡è®°åˆ°blacklisté»‘åå•ï¼Œé¿å…ä¸‹æ¬¡DAGScheduleræŠŠä»»åŠ¡è°ƒåº¦åˆ°æ ‡è®°åˆ°blacklistçš„executorsä¸Šé¢å»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630941123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286002,"user_name":"ğŸš¤","can_delete":false,"product_type":"c1","uid":1460463,"ip_address":"","ucode":"95D7F773789B74","user_header":"https://static001.geekbang.org/account/avatar/00/16/48/ef/4750cb14.jpg","comment_is_top":false,"comment_ctime":1617099039,"is_pvip":false,"replies":[{"id":"103842","content":"å¯¹ï¼Œæ²¡é”™ï¼Œcountæ¥trigger actionã€‚<br><br>ç¬¬äºŒé¢˜æ»¡åˆ†ğŸ’¯ï¼Œ<br><br>ç¬¬ä¸‰é¢˜å †å¤–æ˜¯ä¸æ˜¯ç¬”è¯¯ï¼Œå†™åäº†ï¼Ÿexecutionå’Œstorageåº”è¯¥æ‰ä¸ªä¸ªå„¿ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617103157,"ip_address":"","comment_id":286002,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5912066335","product_id":100073401,"comment_content":"è€å¸ˆï¼Œcache ä¹‹å å†è¿›è¡Œcountï¼Œä¸»è¦æ˜¯å› ä¸ºcacheä¸æ˜¯actionç®—å­ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªactionç®—å­æ¥è§¦å‘ç¼“å­˜çš„ç”Ÿæ•ˆã€‚<br>æˆ‘è¿™æ ·å­ç†è§£å¯¹ä¹ˆï¼Ÿ<br><br>å›ç­”2ï¼š<br>å †å†…å†…å­˜ï¼šå› ä¸ºsparkåªæ˜¯å°†æ— ç”¨çš„å¯¹è±¡å¼•ç”¨åˆ é™¤ï¼Œä½†æ˜¯æ— ç”¨å¯¹è±¡çœŸæ­£çš„å›æ”¶è¿˜è¦ä¾èµ–äºJVMæ¥ç®¡ç†ã€‚Sparkåªæ˜¯åšäº†æ ‡è®°ï¼Œä½†æ˜¯çœŸæ­£ä»€ä¹ˆæ—¶å€™åˆ é™¤sparkå¹¶ä¸çŸ¥é“ï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ã€‚<br>ç›¸æ¯”è¾ƒå †å¤–å†…å­˜ï¼šsparkè‡ªå·±åšç®¡ç†å°±å¯ä»¥æ¸…æ¥šçš„çŸ¥é“å½“å‰è¿˜æœ‰å¤šå°‘å†…å­˜ç©ºé—´å¯ä»¥ä½¿ç”¨ã€‚<br><br>å›ç­”3ï¼š<br>å †å†…ï¼š<br>Reserved: 300MB<br>User: 4GB<br>Execution: 6.4GB<br>Storage: 9.6GB<br><br>å †å¤–ï¼š<br>Executionï¼š6GB<br>Storageï¼š4GB","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517842,"discussion_content":"å¯¹ï¼Œæ²¡é”™ï¼Œcountæ¥trigger actionã€‚\n\nç¬¬äºŒé¢˜æ»¡åˆ†ğŸ’¯ï¼Œ\n\nç¬¬ä¸‰é¢˜å †å¤–æ˜¯ä¸æ˜¯ç¬”è¯¯ï¼Œå†™åäº†ï¼Ÿexecutionå’Œstorageåº”è¯¥æ‰ä¸ªä¸ªå„¿ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617103157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363652,"discussion_content":"å“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617253954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1460463,"avatar":"https://static001.geekbang.org/account/avatar/00/16/48/ef/4750cb14.jpg","nickname":"ğŸš¤","note":"","ucode":"95D7F773789B74","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363045,"discussion_content":"ğŸ˜‚ğŸ˜‚å†™çº¸ä¸Š æŠ„åäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617104025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285787,"user_name":"L3nvy","can_delete":false,"product_type":"c1","uid":1271157,"ip_address":"","ucode":"0B74B27C121D56","user_header":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","comment_is_top":false,"comment_ctime":1617012520,"is_pvip":false,"replies":[{"id":"103772","content":"å‰ä¸¤é¢˜æ»¡åˆ†ğŸ’¯ï¼Œç¬¬ä¸‰é¢˜éœ€è¦æ³¨æ„ï¼Œå †å¤–ã€å †å†…è¦åˆ†å¼€è®¡ç®—ã€‚sparkåœ¨runtimeï¼Œå †å†…ã€å †å¤–äº’ç›¸ä¹‹é—´å¹¶ä¸shareï¼Œä¹Ÿå°±æ˜¯ä½ ä¸€ä¸ªtaskæœ€å¼€å§‹åœ¨å †å¤–è·‘ï¼Œè·‘ç€è·‘ç€å‘ç°å†…å­˜ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå³ä½¿å †å†…æœ‰å¯Œä½™ï¼Œtaskè¿˜æ˜¯ä¼šoomã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617067042,"ip_address":"","comment_id":285787,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5911979816","product_id":100073401,"comment_content":"1. å †å¤–å†…å­˜ä¸»è¦åˆ†ä¸ºExecution Memoryå’ŒStorage Memoryä¸¤éƒ¨åˆ†ï¼Œä½¿ç”¨åœºæ™¯åº”è¯¥æ˜¯å’Œå †å†…å†…å­˜çš„ä½¿ç”¨åœºæ™¯å‡ ä¹ä¸€è‡´ã€‚Execution Memoryç”¨åœ¨Shuffleã€Joinã€Sortã€Aggregationè®¡ç®—è¿‡ç¨‹ä¸­ï¼›Storage Memoryç”¨åœ¨RDDçš„ç¼“å­˜ã€é›†ç¾¤ä¸­å†…éƒ¨æ•°æ®çš„ä¼ æ’­<br>2. å †å†…å†…å­˜å› ä¸ºä¾èµ–JVMçš„GCè¿›è¡Œå†…å­˜å›æ”¶ï¼ŒSparkä¸èƒ½ä¿è¯å†…å­˜ç©ºé—´å·²ç»è¢«å›æ”¶ï¼›å †å¤–å†…å­˜å› ä¸ºæ˜¯æ‰‹åŠ¨è¿›è¡Œå†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾ï¼Œæ‰€ä»¥Sparkèƒ½å‡†ç¡®é¢„ä¼°å†…å­˜æš‚ç”¨é‡<br>3. <br>    1. Reserved Memory: 300 MB<br>    2. User Memory: 20 * 0.2  = 4 GB<br>    3. Execution Memory: 20 * 0.8 * 0.4 + 10 * 0.4 = 10.4 GB<br>    4. Storage Memory: 20 * 0.8 * 0.6 + 10 * 0.6  = 15.6 GB","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517781,"discussion_content":"å‰ä¸¤é¢˜æ»¡åˆ†ğŸ’¯ï¼Œç¬¬ä¸‰é¢˜éœ€è¦æ³¨æ„ï¼Œå †å¤–ã€å †å†…è¦åˆ†å¼€è®¡ç®—ã€‚sparkåœ¨runtimeï¼Œå †å†…ã€å †å¤–äº’ç›¸ä¹‹é—´å¹¶ä¸shareï¼Œä¹Ÿå°±æ˜¯ä½ ä¸€ä¸ªtaskæœ€å¼€å§‹åœ¨å †å¤–è·‘ï¼Œè·‘ç€è·‘ç€å‘ç°å†…å­˜ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå³ä½¿å †å†…æœ‰å¯Œä½™ï¼Œtaskè¿˜æ˜¯ä¼šoomã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617067042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354858,"user_name":"Geek_33c134","can_delete":false,"product_type":"c1","uid":1596647,"ip_address":"å¹¿ä¸œ","ucode":"C5BBA83AABD2AC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Ir1EdhB29109UhH7SGnVLEfEcKcGPDViaTpbS7BYXngqFghThYc093oFCTwsTLjVR7nHPokXJIPm7rbmPAU7TdQ/132","comment_is_top":false,"comment_ctime":1660824118,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660824118","product_id":100073401,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæƒ³é—®ä¸‹å¯¹äºæŸæ®µä»£ç driverè·å–åï¼Œä¼šäº¤ç»™å¤šä¸ªexecutoræ¥æ‰§è¡Œã€‚å¯¹äºä½ çš„æ•°æ®æºï¼šï¼šâ€œ~&#47;words.csvâ€å‡è®¾æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨å¤šä¸ªhdfsç£ç›˜å—ä¸Šé¢ï¼Œä¾‹å¦‚åˆ†æ­¥ç£ç›˜å—A,B,Cã€‚é‚£ä¹ˆ:<br>1.executoræ˜¯å¦ä¹Ÿåœ¨A,B,Cçš„æœºå™¨ä¸Šåˆ†åˆ«æ¥æ‰§è¡Œå‘¢(å‡è®¾èµ„æºè¶³å¤Ÿï¼Œæˆ‘ç†è§£æ˜¯æŒ‰ç…§ä¸ŠèŠ‚è¯¾çš„ç§»åŠ¨ä»£ç ä½†æ˜¯ä¸ç§»åŠ¨æ•°æ®æ¥åˆ†é…)ï¼Ÿ<br>2. å¯¹ä¸åœ¨Aæœºå™¨ä¸Šçš„executorï¼Œæ˜¯åªåŠ è½½ä¸‰åˆ†ä¹‹ä¸€çš„æ•°æ®åˆ°å†…å­˜é‡Œå—ï¼Ÿä¹Ÿå°±æ˜¯ç£ç›˜å—Açš„æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œexecutoræ˜¯çœ‹ä¸åˆ°ç£ç›˜å—B,Cçš„æ•°æ®çš„æ˜¯å—ï¼Ÿ  <br>3. words.filter(word =&gt; dict.contains(word)) å¯¹äºè¿™æ®µä»£ç çš„æ‰§è¡Œï¼Œdictåˆ†åˆ«åœ¨A,B,Cä¸‰å°æœºå™¨çš„executorä¸Šçš„user memoryå­˜å‚¨ï¼Œè¿™ä¸€æ®µçš„filteråº•å±‚æ˜¯forå¾ªç¯è¿›è¡Œæ¯ä¸ªwordè¿‡æ»¤ï¼Œæ˜¯å¦æ˜¯A,B,Cä¸‰å°æœºå™¨å„è¿‡æ»¤ä¸‰åˆ†ä¹‹ä¸€çš„æ•°æ®ï¼ˆä¾‹å¦‚æœ‰30äº¿ä¸ªå•è¯ï¼ŒAï¼ŒB, Cåˆ†åˆ«è¿‡æ»¤è‡ªå·±ç£ç›˜å—çš„10Wæ¡æ•°æ®ï¼‰ï¼Œå¹¶ä¸”å¹¶è¡Œæ‰§è¡Œå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":352369,"user_name":"ææ‚¦åŸ","can_delete":false,"product_type":"c1","uid":2328830,"ip_address":"","ucode":"F72974986FA015","user_header":"https://static001.geekbang.org/account/avatar/00/23/88/fe/157a2d11.jpg","comment_is_top":false,"comment_ctime":1658588534,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658588534","product_id":100073401,"comment_content":"è¯·æ•™è€å¸ˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœDriverçš„å †å¤–å†…å­˜çˆ†äº†ï¼Œé¢‘ç¹çš„GCï¼Œé‚£å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Œæ€ä¹ˆæ’æŸ¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":350280,"user_name":"åº·","can_delete":false,"product_type":"c1","uid":2621850,"ip_address":"","ucode":"C3E85292E026D5","user_header":"https://static001.geekbang.org/account/avatar/00/28/01/9a/d2831441.jpg","comment_is_top":false,"comment_ctime":1656745899,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656745899","product_id":100073401,"comment_content":"å´è€å¸ˆï¼Œå¯¹äºè¿™ä¸¤ä¸ªå‚æ•°ï¼Œè°ƒå¤§åä¼šæœ‰ä»€ä¹ˆå¼Šç«¯å—ï¼Œå…¶æ¬¡ï¼Œspillçš„ç¼“å†²åŒºæ˜¯ä½äºsparkå†…å­˜å“ªä¸ªåŒºåŸŸï¼Ÿè°¢è°¢è€å¸ˆ<br>-- å¢å¤§reducerä¸€æ¬¡æ€§readå¤§å°<br>spark.reducer.maxSizeInFlight<br>-- å¢åŠ spillç¼“å†²<br>set spark.shuffle.file.buffer","like_count":0},{"had_liked":false,"id":350278,"user_name":"åº·","can_delete":false,"product_type":"c1","uid":2621850,"ip_address":"","ucode":"C3E85292E026D5","user_header":"https://static001.geekbang.org/account/avatar/00/28/01/9a/d2831441.jpg","comment_is_top":false,"comment_ctime":1656745128,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656745128","product_id":100073401,"comment_content":"å´è€å¸ˆï¼Œspark.executor.memoryOverheadæ˜¯ä¸æ˜¯spark3.0ä¹‹åè¢«ç‹¬ç«‹å¼€äº†ï¼Œä¹‹å‰æˆ‘çœ‹è¿˜æœ‰spark.executor.memoryOverheadè¦å¤§äºç­‰äºspark.memory.offHeap.sizeçš„å»ºè®®ï¼Œç°åœ¨æ˜¯ä¸æ˜¯å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªå‚æ•°ä¸ºcontaineré¢„ç•™çš„ï¼Œé¢„é˜²é«˜å³°æœŸè¶…å‡ºcontainerè®¾å®šåå¯¼è‡´containerè¢«killï¼Ÿ","like_count":0},{"had_liked":false,"id":334782,"user_name":"é™Œç”Ÿçš„å¿ƒé…¸","can_delete":false,"product_type":"c1","uid":2829738,"ip_address":"","ucode":"2F221D93403D20","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2d/aa/e33e9edd.jpg","comment_is_top":false,"comment_ctime":1645110127,"is_pvip":false,"replies":[{"id":"122408","content":"æ»¡åˆ†ğŸ’¯~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645370021,"ip_address":"","comment_id":334782,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645110127","product_id":100073401,"comment_content":"2.é€šè¿‡java UnSafe API è¿›è¡Œå†…å­˜åˆ†é…å’Œå›æ”¶ï¼ŒåŠæ—¶ã€è‡ªè¡Œè¿›è¡Œå¯¹è±¡çš„å¼•ç”¨ã€å›æ”¶ï¼ŒåŠæ—¶è¿›è¡Œå†…å­˜çš„åˆ†é…å’Œç®¡ç†ï¼Œé¿å…åƒjvmé‚£æ ·è¿›è¡Œå®šæ—¶æ¸…ç†ï¼Œè¿›è¡Œæ ‡è®°ã€æ¸…é™¤æ“ä½œï¼Œæ•ˆç‡æ›´å¿«ï¼Œé€Ÿåº¦æ›´é«˜<br>3.<br>å †å†…å†…å­˜ï¼š<br>é¢„ç•™å†…å­˜ : (1-0.8)*20G = 4G ; æ‰§è¡Œå†…å­˜ï¼š 0.8*(1-0.6ï¼‰*20 = 6.4G ,å­˜å‚¨å†…å­˜ï¼š0.8*0.6*20 = 9.2G<br>å †å¤–å†…å­˜ï¼š<br>æ‰§è¡Œå†…å­˜ï¼š ï¼ˆ1-0.6ï¼‰ * 10G = 4G,å­˜å‚¨å†…å­˜ 0.6*10 = 6G<br>","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552267,"discussion_content":"æ»¡åˆ†ğŸ’¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645370021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334781,"user_name":"é™Œç”Ÿçš„å¿ƒé…¸","can_delete":false,"product_type":"c1","uid":2829738,"ip_address":"","ucode":"2F221D93403D20","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2d/aa/e33e9edd.jpg","comment_is_top":false,"comment_ctime":1645110123,"is_pvip":false,"replies":[{"id":"122409","content":"æ»¡åˆ†ğŸ’¯~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1645370032,"ip_address":"","comment_id":334781,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645110123","product_id":100073401,"comment_content":"2.é€šè¿‡java UnSafe API è¿›è¡Œå†…å­˜åˆ†é…å’Œå›æ”¶ï¼ŒåŠæ—¶ã€è‡ªè¡Œè¿›è¡Œå¯¹è±¡çš„å¼•ç”¨ã€å›æ”¶ï¼ŒåŠæ—¶è¿›è¡Œå†…å­˜çš„åˆ†é…å’Œç®¡ç†ï¼Œé¿å…åƒjvmé‚£æ ·è¿›è¡Œå®šæ—¶æ¸…ç†ï¼Œè¿›è¡Œæ ‡è®°ã€æ¸…é™¤æ“ä½œï¼Œæ•ˆç‡æ›´å¿«ï¼Œé€Ÿåº¦æ›´é«˜<br>3.<br>å †å†…å†…å­˜ï¼š<br>é¢„ç•™å†…å­˜ : (1-0.8)*20G = 4G ; æ‰§è¡Œå†…å­˜ï¼š 0.8*(1-0.6ï¼‰*20 = 6.4G ,å­˜å‚¨å†…å­˜ï¼š0.8*0.6*20 = 9.2G<br>å †å¤–å†…å­˜ï¼š<br>æ‰§è¡Œå†…å­˜ï¼š ï¼ˆ1-0.6ï¼‰ * 10G = 4G,å­˜å‚¨å†…å­˜ 0.6*10 = 6G<br>","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552268,"discussion_content":"æ»¡åˆ†ğŸ’¯~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645370032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326025,"user_name":"Cellophane","can_delete":false,"product_type":"c1","uid":1745733,"ip_address":"","ucode":"4161CDAF760F4C","user_header":"https://static001.geekbang.org/account/avatar/00/1a/a3/45/65e7997f.jpg","comment_is_top":false,"comment_ctime":1639315830,"is_pvip":false,"replies":[{"id":"118712","content":"è€å¼Ÿè¿™æ˜¯ä¸¤ä¸ªä¸“æ éƒ½è®¢é˜…å•¦ï¼Œæ„Ÿè°¢è€å¼Ÿçš„åé¦ˆ~<br>åŒä¸€ä¸ªåŸç†ï¼Œç¬¬ä¸€ä¸ªç±»æ¯”ç¡®å®å¾€å¾€å°è±¡ä¼šæ›´æ·±äº›ï¼Œèƒ½å¸®åˆ°è€å¼Ÿæ›´å¥½åœ°ç†è§£Sparkå†…å­˜ç®¡ç†å°±å¥½å“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1043100","ctime":1639667391,"ip_address":"","comment_id":326025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639315830","product_id":100073401,"comment_content":"æ„Ÿè§‰åœŸåœ°æ‹›ç§Ÿçš„ä¾‹å­æœ‰ç‚¹ç»•ï¼Œæ²¡æœ‰é›¶åŸºç¡€å…¥é—¨ Sparkä¸­é‚£ä¸ªæ–½å·¥çš„ä¾‹å­ç›´è§‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539324,"discussion_content":"è€å¼Ÿè¿™æ˜¯ä¸¤ä¸ªä¸“æ éƒ½è®¢é˜…å•¦ï¼Œæ„Ÿè°¢è€å¼Ÿçš„åé¦ˆ~\nåŒä¸€ä¸ªåŸç†ï¼Œç¬¬ä¸€ä¸ªç±»æ¯”ç¡®å®å¾€å¾€å°è±¡ä¼šæ›´æ·±äº›ï¼Œèƒ½å¸®åˆ°è€å¼Ÿæ›´å¥½åœ°ç†è§£Sparkå†…å­˜ç®¡ç†å°±å¥½å“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639667391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":321302,"user_name":"è±ª","can_delete":false,"product_type":"c1","uid":1711247,"ip_address":"","ucode":"D0CE3C5B60C5E5","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1c/8f/a5e25ee4.jpg","comment_is_top":false,"comment_ctime":1636771447,"is_pvip":false,"replies":[{"id":"116842","content":"å †å¤–ã€å †å†…çš„ä½¿ç”¨ï¼Œæ˜¯ä»¥Jobä¸ºç²’åº¦å“ˆã€‚å°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªJobå†…çš„æ‰€æœ‰Stagesã€æ‰€æœ‰ä½œä¸šï¼Œè¦ä¹ˆéƒ½ç”¨å †å¤–ï¼Œè¦ä¹ˆï¼Œéƒ½ç”¨å †å†…~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1637058465,"ip_address":"","comment_id":321302,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1636771447","product_id":100073401,"comment_content":"æºç æ•æ‰å®åŠ›è¿˜ä¸å¤Ÿå¼ºğŸ˜‚ï¼Œçœ‹äº†åŠå¤©æ²¡æ‰¾åˆ° ä¸€ä¸ªjobå †å¤–ä¸å¤Ÿç”¨æ—¶è½¬ç”¨å †å†… çš„æºç ï¼Œè€å¸ˆèƒ½æŒ‡ç‚¹ä¸‹å—","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530356,"discussion_content":"å †å¤–ã€å †å†…çš„ä½¿ç”¨ï¼Œæ˜¯ä»¥Jobä¸ºç²’åº¦å“ˆã€‚å°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªJobå†…çš„æ‰€æœ‰Stagesã€æ‰€æœ‰ä½œä¸šï¼Œè¦ä¹ˆéƒ½ç”¨å †å¤–ï¼Œè¦ä¹ˆï¼Œéƒ½ç”¨å †å†…~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637058465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1711247,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/1c/8f/a5e25ee4.jpg","nickname":"è±ª","note":"","ucode":"D0CE3C5B60C5E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":547365,"discussion_content":"åˆšçœ‹åˆ°è€å¸ˆçš„å›å¤ğŸ˜‚ã€‚è€å¸ˆè¯´çš„è¿™ä¸ªç‚¹æˆ‘æ‡‚ï¼Œæˆ‘ä¸æ¸…æ¥šçš„æ˜¯ï¼Œå½“æˆ‘å¯ç”¨å †å¤–å†…å­˜é…ç½®æ—¶ï¼Œä¸€ä¸ªjobå¦‚ä½•åˆ¤æ–­ä½¿ç”¨å †å¤–æˆ–è€…å †å†…å†…å­˜ï¼Ÿ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642648180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":530356,"ip_address":""},"score":547365,"extra":""}]}]},{"had_liked":false,"id":320072,"user_name":"ç¦","can_delete":false,"product_type":"c1","uid":2455712,"ip_address":"","ucode":"F2FC7AF5D433C6","user_header":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","comment_is_top":false,"comment_ctime":1636075657,"is_pvip":true,"replies":[{"id":"116035","content":"ä¸æ˜¯User Memoryï¼ŒRDDå°è£…äº†åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œå¦‚æœæ²¡æœ‰åŠ Cacheï¼Œè¿™äº›æ•°æ®åŠ è½½è¿›æ¥ä¹‹åï¼Œéƒ½ä¼šèµ°Execution Memoryï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå†…å­˜ã€‚<br><br>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›ä¸ªRDDï¼Œéƒ½æ˜¯â€œè™šâ€çš„ã€â€œåŠ¨æ€â€çš„ï¼Œå°±æ˜¯è¯´ä¸è¦ä¸€çœ‹åˆ°RDDï¼Œå°±è§‰å¾—è¿™äº›æ•°æ®æ˜¯é™æ€åœ°å­˜åœ¨å“ªä¸ªåœ°æ–¹ã€‚<br><br>è¿™äº›RDDéƒ½æ˜¯æ‰¹é‡ã€åƒæµä¸€æ ·ï¼ŒåŠ è½½åˆ°å†…å­˜å¹¶ä¸”æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œçš„ï¼Œå¾ˆå¤šåœ°æ–¹çš„RDDï¼Œåœ¨å†…å­˜ä¸­ç”šè‡³æ²¡æœ‰å½¢æ€ï¼Œå› ä¸ºä»£ç ç”Ÿæˆçš„ç¼˜æ•…ï¼Œæ•°æ®å½¢æ€å¯èƒ½ä»RDD1ç¬é—´å˜æ¢åˆ°RDD10ï¼Œå› ä¸ºä¸­é—´çš„å½¢æ€ï¼ˆRDD2åˆ°RDD<br>9ï¼‰ï¼Œéƒ½é€šè¿‡æ•´åˆçš„ä»£ç ï¼Œä¸€æ­¥åˆ°ä½åœ°å¤„ç†è¿‡äº†ã€‚<br><br>æ‰€ä»¥çœ‹åˆ°RDDï¼Œå°±è¦æƒ³åˆ°Sparkçš„DAGå’Œlineageï¼Œä¸èƒ½é™æ€ã€å­¤ç«‹åœ°çœ‹å¾…RDDå“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1636092716,"ip_address":"","comment_id":320072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636075657","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæƒ³è¯·é—®å“ˆæ‚¨ï¼Œç¬¬2è¡Œä»£ç ï¼Œval words: RDD[String] = sparkContext.textFile(â€œ~&#47;words.csvâ€)ï¼Œè¿™ä¸ªwordsçš„æ•°æ®ï¼Œæ˜¯ç”¨çš„å“ªé‡Œçš„å†…å­˜ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ç”¨æˆ·å®šä¹‰çš„å†…å­˜ï¼Œæ˜¯åœ¨userMemoryä¸­å˜›","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529862,"discussion_content":"ä¸æ˜¯User Memoryï¼ŒRDDå°è£…äº†åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œå¦‚æœæ²¡æœ‰åŠ Cacheï¼Œè¿™äº›æ•°æ®åŠ è½½è¿›æ¥ä¹‹åï¼Œéƒ½ä¼šèµ°Execution Memoryï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå†…å­˜ã€‚\n\néœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›ä¸ªRDDï¼Œéƒ½æ˜¯â€œè™šâ€çš„ã€â€œåŠ¨æ€â€çš„ï¼Œå°±æ˜¯è¯´ä¸è¦ä¸€çœ‹åˆ°RDDï¼Œå°±è§‰å¾—è¿™äº›æ•°æ®æ˜¯é™æ€åœ°å­˜åœ¨å“ªä¸ªåœ°æ–¹ã€‚\n\nè¿™äº›RDDéƒ½æ˜¯æ‰¹é‡ã€åƒæµä¸€æ ·ï¼ŒåŠ è½½åˆ°å†…å­˜å¹¶ä¸”æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œçš„ï¼Œå¾ˆå¤šåœ°æ–¹çš„RDDï¼Œåœ¨å†…å­˜ä¸­ç”šè‡³æ²¡æœ‰å½¢æ€ï¼Œå› ä¸ºä»£ç ç”Ÿæˆçš„ç¼˜æ•…ï¼Œæ•°æ®å½¢æ€å¯èƒ½ä»RDD1ç¬é—´å˜æ¢åˆ°RDD10ï¼Œå› ä¸ºä¸­é—´çš„å½¢æ€ï¼ˆRDD2åˆ°RDD\n9ï¼‰ï¼Œéƒ½é€šè¿‡æ•´åˆçš„ä»£ç ï¼Œä¸€æ­¥åˆ°ä½åœ°å¤„ç†è¿‡äº†ã€‚\n\næ‰€ä»¥çœ‹åˆ°RDDï¼Œå°±è¦æƒ³åˆ°Sparkçš„DAGå’Œlineageï¼Œä¸èƒ½é™æ€ã€å­¤ç«‹åœ°çœ‹å¾…RDDå“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636092716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309554,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":2162751,"ip_address":"","ucode":"69234046BFD81B","user_header":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","comment_is_top":false,"comment_ctime":1630228924,"is_pvip":false,"replies":[{"id":"112639","content":"memoryOverheadè¿™å‚æ•°æ˜¯sparkè¢«yarnè°ƒåº¦çš„æ—¶å€™ï¼Œcontaineré¢„ç•™å‡ºæ¥çš„å †å¤–å†…å­˜ï¼Œç”¨äºé¿å…spark executorå†…å­˜æº¢å‡ºï¼Œå¯¼è‡´containerå†…å­˜æº¢å‡ºä»è€Œè®©yarn killæ‰containerï¼Œç”šè‡³æ˜¯æ•´ä¸ªapplicationã€‚æ‰€ä»¥æ‰è¯´å®ƒæ˜¯ç”¨æ¥ä¿è¯ç¨³å®šæ€§çš„ã€‚è¿™ä¸ªå‚æ•°ï¼Œä¸sparkæœ¬èº«çš„å †å¤–ï¼Œæ²¡æœ‰å…³ç³»ã€‚<br><br>sparkç”¨åˆ°çš„å †å¤–ï¼Œå°±æ˜¯offheapç›¸å…³çš„é‚£å‡ ä¸ªå‚æ•°ï¼Œå¦‚æœç‰¹åˆ«æƒ³å¼€å¯å †å¤–çš„è¯ï¼ŒæŠŠé‚£ä¸¤ä¸ªåŒ…å«â€œoffheapâ€å…³é”®å­—çš„é…ç½®é¡¹å¼„å¥½å°±è¡Œ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1630938278,"ip_address":"","comment_id":309554,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1630228924","product_id":100073401,"comment_content":"äºŒåˆ·,æ¥ä¸Šä¸€ä¸ªç•™è¨€çš„é—®é¢˜2:<br>1.memoryOverheadè¿™ä¸ªå‚æ•°ä¸ç®¡æ˜¯ä½œç”¨åœ¨å †å†…è¿˜æ˜¯å †å¤–,éƒ½æ˜¯å ç”¨storage memoryè¿™éƒ¨åˆ†å†…å­˜å—,<br>2.ç£Šå“¥çš„å›å¤ä¸­æåˆ° &quot;ä¸ç®¡å †å¤–è¿˜æ˜¯å †å†…ï¼Œå¼€å‘è€…ç”¨ä¸åˆ°ï¼Œsparkä¹Ÿç”¨ä¸åˆ°ï¼Œæ‰€ä»¥ä¸ç”¨å…³å¿ƒï¼Œåƒä¸‡ä¸æŒ‡æœ›è°ƒè¿™ä¸ªå‚æ•°å»æå‡æ€§èƒ½ï¼Œå®ƒçš„ç›®çš„æ˜¯ä¿æŒè¿è¡Œæ—¶çš„ç¨³å®šæ€§~&quot;,ä¸ªäººä¸å¤ªç†è§£è¿™å¥è¯çš„ä¸ç”¨å…³å¿ƒ,å› ä¸ºæœ‰å‡ºç°è¿‡oom overheadçš„é—®é¢˜,å¯ä»¥ç†è§£ä¸ºæ˜¯ä½¿ç”¨åˆ°äº†memoryOverhead,é‚£ä¹ˆå°±éœ€è¦å»è°ƒæ•´å¯¹åº”çš„memoryOverheadå¤§å°,&quot;å¼€å‘è€…ç”¨ä¸åˆ°ï¼Œsparkä¹Ÿç”¨ä¸åˆ°&quot;,è¿™å¥è¯æˆ‘è¿˜æ²¡æœ‰getåˆ°,æ–—èƒ†åœ¨é—®ä¸€ä¸‹ç£Šå“¥,æ˜¯å“ªé‡Œç”¨åˆ°äº†è¿™ä¸ªå‚æ•°,æ¥æå‡ç¨³å®šæ€§å‘¢? <br>ä¸ªäººç†è§£ä¸å¤Ÿ,ç»™ç£Šå“¥æ·»éº»çƒ¦äº† o(â•¥ï¹â•¥)o  o(â•¥ï¹â•¥)o  o(â•¥ï¹â•¥)o","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525914,"discussion_content":"memoryOverheadè¿™å‚æ•°æ˜¯sparkè¢«yarnè°ƒåº¦çš„æ—¶å€™ï¼Œcontaineré¢„ç•™å‡ºæ¥çš„å †å¤–å†…å­˜ï¼Œç”¨äºé¿å…spark executorå†…å­˜æº¢å‡ºï¼Œå¯¼è‡´containerå†…å­˜æº¢å‡ºä»è€Œè®©yarn killæ‰containerï¼Œç”šè‡³æ˜¯æ•´ä¸ªapplicationã€‚æ‰€ä»¥æ‰è¯´å®ƒæ˜¯ç”¨æ¥ä¿è¯ç¨³å®šæ€§çš„ã€‚è¿™ä¸ªå‚æ•°ï¼Œä¸sparkæœ¬èº«çš„å †å¤–ï¼Œæ²¡æœ‰å…³ç³»ã€‚\n\nsparkç”¨åˆ°çš„å †å¤–ï¼Œå°±æ˜¯offheapç›¸å…³çš„é‚£å‡ ä¸ªå‚æ•°ï¼Œå¦‚æœç‰¹åˆ«æƒ³å¼€å¯å †å¤–çš„è¯ï¼ŒæŠŠé‚£ä¸¤ä¸ªåŒ…å«â€œoffheapâ€å…³é”®å­—çš„é…ç½®é¡¹å¼„å¥½å°±è¡Œ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630938278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2203494,"avatar":"https://static001.geekbang.org/account/avatar/00/21/9f/66/9973656e.jpg","nickname":"ç‹å¹³","note":"","ucode":"1F47D88C64997A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410928,"discussion_content":"&#34;ç”¨äºé¿å…spark executorå†…å­˜æº¢å‡º&#34;:   é‚£ä¹ˆé—®é¢˜æ˜¯å•¥æ—¶ä»¥åŠå¦‚ä½•åˆ¤æ–­ executorå†…å­˜æº¢å‡ºäº†ï¼Ÿå› ä¸ºå®é™…ç¢°åˆ°OOMï¼Œæˆ‘ä»¬ç”¨overHeadè¿™ä¸ªå‚æ•°ä¼¼ä¹éƒ½èƒ½è§£å†³é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635815740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299101,"user_name":"Bennan","can_delete":false,"product_type":"c1","uid":2427818,"ip_address":"","ucode":"8B6EE3DCBB1356","user_header":"https://static001.geekbang.org/account/avatar/00/25/0b/aa/09c1215f.jpg","comment_is_top":false,"comment_ctime":1624457454,"is_pvip":false,"replies":[{"id":"108496","content":"æ˜¯çš„ï¼Œè¿™ä¹ˆè®¡ç®—æ²¡é—®é¢˜ï¼Œå’Œå’±ä»¬æœ¬è®²çš„è®¡ç®—æ–¹æ³•ä¸å†²çªå“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1624504167,"ip_address":"","comment_id":299101,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624457454","product_id":100073401,"comment_content":"ä¸ºä»€ä¹ˆæˆ‘çœ‹æºç ï¼Œæ‰§è¡Œå†…å­˜+å­˜å‚¨æ¯æ¬¡=(spark.executor.memory-é¢„ç•™å†…å­˜300m)*spark.memory.fraction","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522326,"discussion_content":"æ˜¯çš„ï¼Œè¿™ä¹ˆè®¡ç®—æ²¡é—®é¢˜ï¼Œå’Œå’±ä»¬æœ¬è®²çš„è®¡ç®—æ–¹æ³•ä¸å†²çªå“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624504167,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291050,"user_name":"å†·èƒæµ®ä¹æœµ","can_delete":false,"product_type":"c1","uid":1134525,"ip_address":"","ucode":"5C3BCBD9E5973D","user_header":"https://static001.geekbang.org/account/avatar/00/11/4f/bd/e08af2e9.jpg","comment_is_top":false,"comment_ctime":1619965727,"is_pvip":false,"replies":[{"id":"105476","content":"æœ‰å…³ç³»ï¼ŒRDDç¼“å­˜çš„è¿‡ç¨‹ï¼Œå®é™…æ˜¯æŠŠæ•°æ®åˆ†åŒºè¿­ä»£å™¨ç‰©åŒ–ä¸ºMemoryEntryã€å¹¶å­˜å‚¨åˆ°MemoryStoreçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å½“ä¸­æ¶ˆè€—çš„å†…å­˜ï¼Œéƒ½ä¼šè®°å…¥Storage Memoryçš„è´¦ä¸Šã€‚<br><br>å…³äºRDDç¼“å­˜çš„è¯¦ç»†è¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒå­˜å‚¨ç³»ç»Ÿé‚£ä¸€è®²ï¼Œæˆ–æ˜¯åé¢çš„RDD Cacheé‚£ä¸€è®²~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1620115085,"ip_address":"","comment_id":291050,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619965727","product_id":100073401,"comment_content":"æƒ³é—®ä¸‹è¿™é‡Œè¯´çš„å†…å­˜ç®¡ç†å’ŒBlockManagerçš„MemoryStoreæœ‰å…³ç³»å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519353,"discussion_content":"æœ‰å…³ç³»ï¼ŒRDDç¼“å­˜çš„è¿‡ç¨‹ï¼Œå®é™…æ˜¯æŠŠæ•°æ®åˆ†åŒºè¿­ä»£å™¨ç‰©åŒ–ä¸ºMemoryEntryã€å¹¶å­˜å‚¨åˆ°MemoryStoreçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å½“ä¸­æ¶ˆè€—çš„å†…å­˜ï¼Œéƒ½ä¼šè®°å…¥Storage Memoryçš„è´¦ä¸Šã€‚\n\nå…³äºRDDç¼“å­˜çš„è¯¦ç»†è¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒå­˜å‚¨ç³»ç»Ÿé‚£ä¸€è®²ï¼Œæˆ–æ˜¯åé¢çš„RDD Cacheé‚£ä¸€è®²~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620115085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290188,"user_name":"Zå®‡é”¤é”¤","can_delete":false,"product_type":"c1","uid":2188142,"ip_address":"","ucode":"7DB36E986A7A51","user_header":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","comment_is_top":false,"comment_ctime":1619424344,"is_pvip":true,"replies":[{"id":"105202","content":"å“ˆå“ˆå“ˆï¼Œä¸å¹³ç­‰æ¡çº¦~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1619434299,"ip_address":"","comment_id":290188,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619424344","product_id":100073401,"comment_content":"æ„Ÿè§‰éº»å­å¹²ä¸è¿‡å°è‰ºï¼Œå°è‰ºçš„æ”¿ç­–å¤ªå¥½äº†ï¼Œè¶Šçº¿çš„åœ°ï¼Œå°è‰ºéœ€è¦éº»å­å°±è¦ç»™ã€‚å½“éº»å­çº¿å†…çš„åœ°ï¼Œå°è‰ºç§äº†å°±ä¸ç»™éº»å­è¿˜äº†ã€‚è°å«å°è‰ºçš„ä½œç‰©ç»æµä»·å€¼é«˜å‘¢ã€‚","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519133,"discussion_content":"å“ˆå“ˆå“ˆï¼Œä¸å¹³ç­‰æ¡çº¦~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619434299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288208,"user_name":"Geek_d794f8","can_delete":false,"product_type":"c1","uid":2485585,"ip_address":"","ucode":"1E20DA4FF8B800","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","comment_is_top":false,"comment_ctime":1618365147,"is_pvip":false,"replies":[{"id":"104644","content":"countæ˜¯ä¸ºäº†trigger cacheçš„è®¡ç®—ï¼Œè®¡ç®—cacheçš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å±•å¼€ï¼ˆUnrollï¼‰ä¹‹å‰ï¼Œä¼šæ¶ˆè€—Execution memoryï¼›å±•å¼€ä¹‹åï¼Œè½¬åŒ–ä¸ºMemoryEntryï¼Œæ¶ˆè€—çš„å°±æ˜¯Storage memoryã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1618394552,"ip_address":"","comment_id":288208,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618365147","product_id":100073401,"comment_content":"è€å¸ˆcacheç”¨çš„storage memoryï¼Œcountä¸åº”è¯¥æ˜¯ç”¨çš„execution memoryå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518548,"discussion_content":"countæ˜¯ä¸ºäº†trigger cacheçš„è®¡ç®—ï¼Œè®¡ç®—cacheçš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å±•å¼€ï¼ˆUnrollï¼‰ä¹‹å‰ï¼Œä¼šæ¶ˆè€—Execution memoryï¼›å±•å¼€ä¹‹åï¼Œè½¬åŒ–ä¸ºMemoryEntryï¼Œæ¶ˆè€—çš„å°±æ˜¯Storage memoryã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618394552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287403,"user_name":"å¿«è·‘","can_delete":false,"product_type":"c1","uid":1564645,"ip_address":"","ucode":"90ED7E6D40C58E","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/e5/65e37812.jpg","comment_is_top":false,"comment_ctime":1617932354,"is_pvip":false,"replies":[{"id":"104395","content":"é»˜è®¤ä¸ä¼šå¼€å¯ï¼Œä¸å¼€å¯å°±ä¸ä¼šç”¨ã€‚åªæœ‰å¼€å¯off heapï¼Œsparkæ‰ä¼šå°è¯•ç”¨å †å¤–ï¼Œå¦åˆ™å…¨éƒ¨ç”¨å †å†…ã€‚å®é™…ä¸Šï¼Œsparkç¤¾åŒºæ¨èç”¨å †å†…ï¼Œå› ä¸ºtungstençš„ä¼˜åŒ–æœºåˆ¶ï¼Œè‰¯å¥½çš„æ•°æ®ç»“æ„ï¼Œä¼šæŠŠgcçš„å¼€é”€é™åˆ°æœ€ä½ï¼Œå †å†…ä¹Ÿèƒ½å¾ˆå¥½åœ°å®Œæˆè®¡ç®—ã€‚è¿™éƒ¨åˆ†æˆ‘ä»¬åœ¨tungstenéƒ¨åˆ†è¿˜ä¼šå†å±•å¼€ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617953998,"ip_address":"","comment_id":287403,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617932354","product_id":100073401,"comment_content":"å¦‚æœæ²¡æœ‰å¼€å¯å †å¤–å†…å­˜spark.memory.offHeap.enabled=falseã€‚sparkä¼šç”¨å †å†…å†…å­˜ï¼Œé‚£è¿˜ä¼šç”¨åˆ°å †å¤–å†…å­˜ä¹ˆã€‚æ€ä¹ˆæ„Ÿè§‰ä¸€äº›åœ°æ–¹ä¼šç”¨åˆ°å‘¢ã€‚å¦åˆ™ä¹Ÿæ²¡å¿…è¦é¢„ç•™å †å¤–å†…å­˜å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518293,"discussion_content":"é»˜è®¤ä¸ä¼šå¼€å¯ï¼Œä¸å¼€å¯å°±ä¸ä¼šç”¨ã€‚åªæœ‰å¼€å¯off heapï¼Œsparkæ‰ä¼šå°è¯•ç”¨å †å¤–ï¼Œå¦åˆ™å…¨éƒ¨ç”¨å †å†…ã€‚å®é™…ä¸Šï¼Œsparkç¤¾åŒºæ¨èç”¨å †å†…ï¼Œå› ä¸ºtungstençš„ä¼˜åŒ–æœºåˆ¶ï¼Œè‰¯å¥½çš„æ•°æ®ç»“æ„ï¼Œä¼šæŠŠgcçš„å¼€é”€é™åˆ°æœ€ä½ï¼Œå †å†…ä¹Ÿèƒ½å¾ˆå¥½åœ°å®Œæˆè®¡ç®—ã€‚è¿™éƒ¨åˆ†æˆ‘ä»¬åœ¨tungstenéƒ¨åˆ†è¿˜ä¼šå†å±•å¼€ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617953998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2162751,"avatar":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","nickname":"Sean","note":"","ucode":"69234046BFD81B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390027,"discussion_content":"é’ˆå¯¹è€å¸ˆçš„å›å¤æ˜¯ä¸æ˜¯å°±å¯ä»¥ç†è§£ä¸º,åªè¦ä¸å¼€å¯off heap,sparkå°±æ— æ³•ä½¿ç”¨,åŒ…æ‹¬yarn,k8sæ¨¡å¼åˆ©ç”¨off heapæå‡ç¨³å®šæ€§ä¹Ÿæ— æ³•ä½“ç°å‡ºæ¥,ä¸€æ—¦å¼€å¯äº†off heap,æ‰§è¡Œä»»åŠ¡ä¹Ÿå°±æ˜¯executor memoryä¼˜å…ˆä½¿ç”¨off heap,storage memoryè¿˜æ˜¯ä¼˜å…ˆå †å†…å†…å­˜,å¯ä»¥è¿™æ ·ç†è§£å—?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629616114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286588,"user_name":"Geek_50f808","can_delete":false,"product_type":"c1","uid":2089363,"ip_address":"","ucode":"A7E47D32A3B148","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/vH3NV3dCKgCDrxfbwqeaaI3XYpZ6PqAxPQByH0zt6WNMOBoRjg3IvfWDYtib6flCpwqkP5iamd74c3WlM72ydLmw/132","comment_is_top":false,"comment_ctime":1617413948,"is_pvip":false,"replies":[{"id":"104101","content":"å¹¿æ’­é‚£ä¸€è®²ä¼šæœ‰è®²å“ˆï¼Œä¼šè®²çš„å¾ˆè¯¦ç»†ï¼Œåº”è¯¥ä¸‹å‘¨å°±ä¼šæ›´æ–°ï¼Œç¨å®‰å‹¿èºå“ˆï½ ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617441926,"ip_address":"","comment_id":286588,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617413948","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸‹dictä¼šå’Œä»»åŠ¡ä¸€èµ·å‘é€åˆ°executorï¼Œè¿™ç§æ–¹å¼æ–¹å¼å’Œå¹¿æ’­å˜é‡çš„æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518038,"discussion_content":"å¹¿æ’­é‚£ä¸€è®²ä¼šæœ‰è®²å“ˆï¼Œä¼šè®²çš„å¾ˆè¯¦ç»†ï¼Œåº”è¯¥ä¸‹å‘¨å°±ä¼šæ›´æ–°ï¼Œç¨å®‰å‹¿èºå“ˆï½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617441926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564645,"avatar":"https://static001.geekbang.org/account/avatar/00/17/df/e5/65e37812.jpg","nickname":"å¿«è·‘","note":"","ucode":"90ED7E6D40C58E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365802,"discussion_content":"åˆæ­¥è®¤è¯†å¹¿æ’­ä¹‹åï¼Œexecutorè¯»å–å˜é‡æ˜¯åœ¨executoræœ¬åœ°è·å–ã€‚æ²¡æœ‰å¹¿æ’­æ˜¯ä»driverç«¯è·å–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617885559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286173,"user_name":"é‡‘è§’å¤§ç‹","can_delete":false,"product_type":"c1","uid":1259375,"ip_address":"","ucode":"DFBA85FB2FD0B0","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/6f/b3337e6d.jpg","comment_is_top":false,"comment_ctime":1617178237,"is_pvip":false,"replies":[{"id":"103895","content":"ä¸å¤ªå¯¹å“ˆï¼Œä½ è¿˜è¦è€ƒè™‘spark.memory.fraction","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617238916,"ip_address":"","comment_id":286173,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617178237","product_id":100073401,"comment_content":"onHeapStorageRegionSize =<br>        (maxMemory * conf.getDouble(&quot;spark.memory.storageFraction&quot;, 0.5)).toLong","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517894,"discussion_content":"ä¸å¤ªå¯¹å“ˆï¼Œä½ è¿˜è¦è€ƒè™‘spark.memory.fraction","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617238916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259375,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/6f/b3337e6d.jpg","nickname":"é‡‘è§’å¤§ç‹","note":"","ucode":"DFBA85FB2FD0B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363578,"discussion_content":"å¥½çš„ï¼Œå¤šè°¢æŒ‡ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617239515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286047,"user_name":"é‡‘è§’å¤§ç‹","can_delete":false,"product_type":"c1","uid":1259375,"ip_address":"","ucode":"DFBA85FB2FD0B0","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/6f/b3337e6d.jpg","comment_is_top":false,"comment_ctime":1617118635,"is_pvip":false,"replies":[{"id":"103861","content":"å¥½é—®é¢˜ï¼Œå…¶å®sparkå®˜æ–¹å»ºè®®è°¨æ…ä½¿ç”¨å †å¤–å†…å­˜ï¼Œä¸ºå•¥å‘¢ï¼Ÿ<br><br>åŸå› å…¶å®å¾ˆç®€å•ï¼Œåœ¨äºå †å¤–å †å†…çš„ç©ºé—´äº’ä¸shareï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„taskæœ€å¼€å§‹ç”¨å †å¤–ï¼Œç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™å³ä½¿å †å†…è¿˜æœ‰ç©ºé—²ï¼Œtaskä¹Ÿæ²¡æ³•ç”¨ï¼Œæ‰€ä»¥ç…§æ ·ä¼šoomã€‚<br><br>å†…å­˜æœ¬æ¥å°±æœ‰é™ï¼Œå†å¼ºè¡Œåˆ’åˆ†å‡ºä¸¤å—éš”ç¦»çš„åŒºåŸŸï¼Œå…¶å®åè€Œå¢åŠ äº†ç®¡ç†éš¾åº¦ã€‚tungstenåœ¨å †å†…å…¶å®ä¹Ÿç”¨å†…å­˜é¡µç®¡ç†å†…å­˜ï¼Œä¹Ÿç”¨å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ç»“æ„ï¼Œå› æ­¤gcæ•ˆç‡å¾€å¾€å¯ä»¥ä¿éšœï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹æ¨èå°±ç”¨å †å†…ã€‚<br><br>å›ç­”ä½ çš„é—®é¢˜ï¼Œå¦‚æœå¼€è¾Ÿäº†å †å¤–ï¼Œsparkä¼šä¼˜å…ˆç”¨å †å¤–ï¼Œç›´åˆ°ç”¨å…‰äº†ä¸ºæ­¢ï¼Œå†å»ç”¨å †å†…ã€‚æ‰€ä»¥å¦‚æœå †å¤–ç©ºé—´ä¸å……åˆ†ï¼Œæ‰§è¡Œä»»åŠ¡å¯¹ç¼“å­˜ç©ºé—´çš„æŠ¢å ä¼šæ›´ä¸¥é‡ï¼Œoomçš„é£é™©ä¹Ÿè¶Šé«˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617154654,"ip_address":"","comment_id":286047,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1617118635","product_id":100073401,"comment_content":"è€å¸ˆï¼Œèƒ½è®²è§£ä¸‹Sparkä¸åŒä»»åŠ¡åœ¨å †å†…å †å¤–å†…å­˜çš„ä½¿ç”¨é€‰æ‹©ä¸Šçš„é€»è¾‘å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517854,"discussion_content":"å¥½é—®é¢˜ï¼Œå…¶å®sparkå®˜æ–¹å»ºè®®è°¨æ…ä½¿ç”¨å †å¤–å†…å­˜ï¼Œä¸ºå•¥å‘¢ï¼Ÿ\n\nåŸå› å…¶å®å¾ˆç®€å•ï¼Œåœ¨äºå †å¤–å †å†…çš„ç©ºé—´äº’ä¸shareï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ çš„taskæœ€å¼€å§‹ç”¨å †å¤–ï¼Œç”¨ç€ç”¨ç€å‘ç°ä¸å¤Ÿäº†ï¼Œè¿™ä¸ªæ—¶å€™å³ä½¿å †å†…è¿˜æœ‰ç©ºé—²ï¼Œtaskä¹Ÿæ²¡æ³•ç”¨ï¼Œæ‰€ä»¥ç…§æ ·ä¼šoomã€‚\n\nå†…å­˜æœ¬æ¥å°±æœ‰é™ï¼Œå†å¼ºè¡Œåˆ’åˆ†å‡ºä¸¤å—éš”ç¦»çš„åŒºåŸŸï¼Œå…¶å®åè€Œå¢åŠ äº†ç®¡ç†éš¾åº¦ã€‚tungstenåœ¨å †å†…å…¶å®ä¹Ÿç”¨å†…å­˜é¡µç®¡ç†å†…å­˜ï¼Œä¹Ÿç”¨å‹ç¼©çš„äºŒè¿›åˆ¶æ•°æ®ç»“æ„ï¼Œå› æ­¤gcæ•ˆç‡å¾€å¾€å¯ä»¥ä¿éšœï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹æ¨èå°±ç”¨å †å†…ã€‚\n\nå›ç­”ä½ çš„é—®é¢˜ï¼Œå¦‚æœå¼€è¾Ÿäº†å †å¤–ï¼Œsparkä¼šä¼˜å…ˆç”¨å †å¤–ï¼Œç›´åˆ°ç”¨å…‰äº†ä¸ºæ­¢ï¼Œå†å»ç”¨å †å†…ã€‚æ‰€ä»¥å¦‚æœå †å¤–ç©ºé—´ä¸å……åˆ†ï¼Œæ‰§è¡Œä»»åŠ¡å¯¹ç¼“å­˜ç©ºé—´çš„æŠ¢å ä¼šæ›´ä¸¥é‡ï¼Œoomçš„é£é™©ä¹Ÿè¶Šé«˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617154654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028956,"avatar":"","nickname":"å‹¿æ›´æ”¹ä»»ä½•ä¿¡æ¯","note":"","ucode":"575185C69C05A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364755,"discussion_content":"è€å¸ˆå‰é¢è¯´å †å¤–å †å†…ä¸å…±äº«ï¼Œä¸ºæ’’åé¢åˆè¯´ä¼šä¼˜å…ˆä½¿ç”¨å †å¤–ï¼Œç›´åˆ°ç”¨å…‰äº†åœ¨å»ç”¨å †å†…ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617593640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1357603,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b7/23/ea83d6eb.jpg","nickname":"-.-","note":"","ucode":"3CDC606BDFDD80","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373629,"discussion_content":"å¦‚æœå †å¤–å†…å­˜ç”¨å…‰äº†ä¸å°±oomäº†ï¼Œè¿™ä¸ªæ—¶å€™ä»»åŠ¡éƒ½æŒ‚äº†æ€ä¹ˆå†ç”¨å †å†…å†…å­˜å‘¢ï¼Ÿè¿™ä¸€ç‚¹ä¸å¤ªç†è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620806271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366420,"discussion_content":"å¯¹å‘€ï¼Œè¿™ä¸ªä¸çŸ›ç›¾å‘€ï¼Œå¼€äº†å †å¤–ï¼Œå°±ä¼˜å…ˆç”¨å †å¤–ï¼Œå †å¤–ä¸å †å†…ä¸å…±äº«ã€‚å¦‚æœä½ åœ¨å †å¤–çš„taskè·‘æŒ‚äº†ï¼Œå°±ç®—å †å†…è¿˜æœ‰å†…å­˜ï¼Œtaskè¿˜æ˜¯ä¼šfailï¼Œå°±æ˜¯å †å†…çš„å†…å­˜æœ‰ç›ˆä½™ï¼Œå®ƒä¹Ÿç”¨ä¸ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618057003,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285761,"user_name":"å¯¹æ–¹æ­£åœ¨è¾“å…¥ã€‚ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":1179298,"ip_address":"","ucode":"7B0DEB4D9B43D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/a2/5252a278.jpg","comment_is_top":false,"comment_ctime":1617005029,"is_pvip":false,"replies":[{"id":"103699","content":"è¿™å—æ˜¯æˆ‘æŒ–äº†ä¸ªå‘å“ˆï¼Œå¯èƒ½éœ€è¦å¯¹shuffleæœ‰ä¸€äº›ç†è§£ï¼Œä¼šæ›´å¥½å›ç­”ï¼Œshuffleé‚£ä¸€è®²ä¼šä»‹ç»è®¡ç®—è¿‡ç¨‹ä¸­æ¶‰åŠçš„å†…å­˜æ•°æ®ç»“æ„ï¼Œåˆ°æ—¶å€™å¯ä»¥å…³æ³¨ä¸‹å“ˆï½<br><br>è¿™é‡Œå‡ºè¿™é“é¢˜ï¼Œä¸»è¦æ˜¯æƒ³å¼•å‘å¤§å®¶å»æ·±å…¥æ€è€ƒï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617014885,"ip_address":"","comment_id":285761,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617005029","product_id":100073401,"comment_content":"è€å¸ˆï¼Œç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘çš„ç†è§£æ˜¯æ¶‰åŠåˆ°ioçš„æ“ä½œä¼šç”¨åˆ°å †å¤–å†…å­˜ï¼Œæ¯”å¦‚shuffle reduceé˜¶æ®µä»ä¸åŒçš„executoræ‹‰å–ä¸­é—´æ•°æ®æ—¶ï¼›æˆ–è€…rddä½¿ç”¨persiståˆ°ç£ç›˜æ—¶ï¼Œå…¶ä»–æƒ…å†µæˆ‘å°±ä¸å¾—è€ŒçŸ¥äº†","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517773,"discussion_content":"è¿™å—æ˜¯æˆ‘æŒ–äº†ä¸ªå‘å“ˆï¼Œå¯èƒ½éœ€è¦å¯¹shuffleæœ‰ä¸€äº›ç†è§£ï¼Œä¼šæ›´å¥½å›ç­”ï¼Œshuffleé‚£ä¸€è®²ä¼šä»‹ç»è®¡ç®—è¿‡ç¨‹ä¸­æ¶‰åŠçš„å†…å­˜æ•°æ®ç»“æ„ï¼Œåˆ°æ—¶å€™å¯ä»¥å…³æ³¨ä¸‹å“ˆï½\n\nè¿™é‡Œå‡ºè¿™é“é¢˜ï¼Œä¸»è¦æ˜¯æƒ³å¼•å‘å¤§å®¶å»æ·±å…¥æ€è€ƒï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617014885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285738,"user_name":"Jay","can_delete":false,"product_type":"c1","uid":1066131,"ip_address":"","ucode":"488BF5D01D3CFD","user_header":"https://static001.geekbang.org/account/avatar/00/10/44/93/2d3d5868.jpg","comment_is_top":false,"comment_ctime":1616997225,"is_pvip":false,"replies":[{"id":"103697","content":"countæ˜¯ç”¨äº†triggerç¼“å­˜çš„è®¡ç®—ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617014412,"ip_address":"","comment_id":285738,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616997225","product_id":100073401,"comment_content":"&quot;ç¬¬å››è¡Œå’Œç¬¬äº”è¡Œç”¨ cache å’Œ count å¯¹ keywords RDD è¿›è¡Œç¼“å­˜&quot; -- keywords.cacheç¼“å­˜èƒ½ç†è§£ï¼Œkeywords.countä¸ºå•¥ä¹Ÿå¯ä»¥ç¼“å­˜å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517768,"discussion_content":"countæ˜¯ç”¨äº†triggerç¼“å­˜çš„è®¡ç®—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617014412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285673,"user_name":"ç™½éŸ³","can_delete":false,"product_type":"c1","uid":2526221,"ip_address":"","ucode":"B83B0269B8E9A0","user_header":"https://static001.geekbang.org/account/avatar/00/26/8c/0d/42e16041.jpg","comment_is_top":false,"comment_ctime":1616969441,"is_pvip":false,"replies":[{"id":"103654","content":"æ»¡åˆ†ğŸ’¯","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616979054,"ip_address":"","comment_id":285673,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616969441","product_id":100073401,"comment_content":"è¯•ç­”3: <br>å †å†… 20G <br>Reserved Memory: 300MB <br>User Memory: 20 * 0.2 = 4GB  <br>Storage Memory:  20 * 0.8 * 0.6 = 9.6GB<br>Execution Memory:  20 * 0.8 * 0.4 = 6.4GB<br><br>å †å¤– 10GB<br>Storage Memory: 10 * 0.6 : 6GB<br>Execution Memory:  10 * 0.4 : 4GB ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517749,"discussion_content":"æ»¡åˆ†ğŸ’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616979054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}