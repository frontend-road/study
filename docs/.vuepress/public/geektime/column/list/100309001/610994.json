{"id":610994,"title":"20ï½œæ•°æ®å¼•æ“ï¼šç»Ÿä¸€ç¼“å­˜æ•°æ®å¹³å°","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾é•¿é¾™ã€‚</p><p>é€šè¿‡å‰å››ç« ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†ä¸åŒç±»å‹çš„ç³»ç»Ÿå¦‚ä½•ä¼˜åŒ–ï¼Œå…¶ä¸­æœ‰å“ªäº›å…³é”®æŠ€æœ¯ç‚¹ã€‚ä¸è¿‡é™¤äº†è¿™äº›åŸºç¡€çŸ¥è¯†ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è¦äº†è§£å¤§å‹äº’è”ç½‘æ˜¯å¦‚ä½•è®¾è®¡æ”¯æ’‘ä¸€ä¸ªé«˜å¹¶å‘ç³»ç»Ÿçš„ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªç« èŠ‚é‡Œæˆ‘ç²¾é€‰äº†å‡ ä¸ªæ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ æ‰“å¼€è§†é‡ï¼Œçœ‹çœ‹éƒ½æœ‰å“ªäº›å®ç”¨çš„å†…ç½‘æœåŠ¡è®¾è®¡ã€‚</p><p>ä»»ä½•ä¸€ä¸ªäº’è”ç½‘å…¬å¸éƒ½ä¼šæœ‰å‡ ä¸ªæ ¸å¿ƒç›ˆåˆ©çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç»™åŸºç¡€æ ¸å¿ƒä¸šåŠ¡åšä¸€äº›å¢å€¼æœåŠ¡ï¼Œä»¥æ­¤æ¥æ‰©å¤§æˆ‘ä»¬çš„æœåŠ¡èŒƒå›´ä»¥åŠæ„å»ºäº§ä¸šé“¾åŠäº§ä¸šç”Ÿæ€ï¼Œä½†æ˜¯è¿™äº›å¢å€¼æœåŠ¡éœ€è¦æ ¸å¿ƒé¡¹ç›®çš„æ•°æ®åŠäº¤äº’æ‰èƒ½æ›´å¥½åœ°æä¾›æœåŠ¡ã€‚</p><p>ä½†æ ¸å¿ƒç³»ç»Ÿå¦‚æœå¯¹å¢å€¼ä¸šåŠ¡ç³»ç»Ÿåšå¤ªå¤šçš„è€¦åˆé€‚é…ï¼Œå°±ä¼šå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿå˜å¾—ååˆ†å¤æ‚ï¼Œå¦‚ä½•èƒ½æ—¢è®©å¢å€¼æœåŠ¡æ‹¿åˆ°æ ¸å¿ƒç³»ç»Ÿçš„èµ„æºï¼Œåˆèƒ½å‡å°‘ç³»ç»Ÿä¹‹é—´çš„è€¦åˆï¼Ÿ</p><p>è¿™èŠ‚è¯¾æˆ‘ä¼šé‡ç‚¹å¸¦ä½ äº†è§£ä¸€æ¬¾å†…ç½‘ä¸»åŠ¨ç¼“å­˜æ”¯æ’‘çš„ä¸­é—´ä»¶ï¼Œé€šè¿‡è¿™ä¸ªä¸­é—´ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°é«˜æ€§èƒ½å®ä½“æ•°æ®è®¿é—®åŠç¼“å­˜æ›´æ–°ã€‚</p><h2>å›é¡¾ä¸´æ—¶ç¼“å­˜çš„å®ç°</h2><p>æˆ‘ä»¬å…ˆå›é¡¾ä¸‹ä¹‹å‰å±•ç¤ºçš„ä¸´æ—¶ç¼“å­˜å®ç°ï¼Œè¿™ä¸ªä»£ç æ‘˜è‡ªä¹‹å‰çš„<a href=\"https://time.geekbang.org/column/article/596644\">ç¬¬äºŒèŠ‚è¯¾</a>ã€‚</p><pre><code class=\"language-bash\">// å°è¯•ä»ç¼“å­˜ä¸­ç›´æ¥è·å–ç”¨æˆ·ä¿¡æ¯\nuserinfo, err := Redis.Get(\"user_info_9527\")\nif err != nil {\n  return nil, err\n}\n\n//ç¼“å­˜å‘½ä¸­æ‰¾åˆ°ï¼Œç›´æ¥è¿”å›ç”¨æˆ·ä¿¡æ¯\nif userinfo != nil {\n  return userinfo, nil\n}\n\n//æ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œä»æ•°æ®åº“ä¸­è·å–\nuserinfo, err := userInfoModel.GetUserInfoById(9527)\nif err != nil {\n  return nil, err\n}\n\n//æŸ¥æ‰¾åˆ°ç”¨æˆ·ä¿¡æ¯\nif userinfo != nil {\n  //å°†ç”¨æˆ·ä¿¡æ¯ç¼“å­˜ï¼Œå¹¶è®¾ç½®TTLè¶…æ—¶æ—¶é—´è®©å…¶60ç§’åå¤±æ•ˆ\n  Redis.Set(\"user_info_9527\", userinfo, 60)\n  return userinfo, nil\n}\n\n// æ²¡æœ‰æ‰¾åˆ°ï¼Œæ”¾ä¸€ä¸ªç©ºæ•°æ®è¿›å»ï¼ŒçŸ­æœŸå†…ä¸å†è®¿é—®æ•°æ®åº“\n// å¯é€‰ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥é¢„é˜²ç¼“å­˜ç©¿é€æŸ¥è¯¢æ”»å‡»çš„\nRedis.Set(\"user_info_9527\", \"\", 30)\nreturn nil, nil\n</code></pre><!-- [[[read_end]]] --><p>ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†ä¸´æ—¶ç¼“å­˜æé«˜è¯»æ€§èƒ½çš„å¸¸ç”¨æ–¹å¼ï¼šå³æŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯æ—¶ç›´æ¥ç”¨IDä»ç¼“å­˜ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœåœ¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆä¼šä»æ•°æ®åº“ä¸­å›æºæŸ¥æ‰¾æ•°æ®ï¼Œæ‰¾åˆ°æ•°æ®åï¼Œå†å°†æ•°æ®å†™å…¥ç¼“å­˜æ–¹ä¾¿ä¸‹æ¬¡æŸ¥è¯¢ã€‚</p><p>ç›¸å¯¹æ¥è¯´è¿™ä¸ªå®ç°å¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ‰€æœ‰ä¸šåŠ¡ä»£ç éƒ½éœ€è¦å»è¿™ä¹ˆå†™ï¼Œå·¥ä½œé‡è¿˜æ˜¯å¾ˆå¤§çš„ã€‚</p><p>å³ä¾¿æˆ‘ä»¬ä¼šå¯¹è¿™ç±»å®ç°åšä¸€äº›å°è£…ï¼Œä½†å°è£…çš„åŠŸèƒ½åœ¨é™æ€è¯­è¨€ä¸­å¹¶ä¸æ˜¯å¾ˆé€šç”¨ï¼Œæ€§èƒ½ä¹Ÿä¸å¥½ã€‚é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹å¼èƒ½ç»Ÿä¸€è§£å†³è¿™ç±»é—®é¢˜ï¼Œå‡å°‘æˆ‘ä»¬çš„é‡å¤å·¥ä½œé‡å‘¢ï¼Ÿ</p><h2>å®ä½“æ•°æ®ä¸»åŠ¨ç¼“å­˜</h2><p>ä¹‹å‰æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/596644\">ç¬¬äºŒèŠ‚è¯¾</a>è®²è¿‡<strong>å®ä½“æ•°æ®</strong>æœ€å®¹æ˜“åšç¼“å­˜ï¼Œå®ä½“æ•°æ®çš„ç¼“å­˜keyå¯ä»¥è®¾è®¡ä¸º<strong>å‰ç¼€+ä¸»é”®IDè¿™ç§å½¢å¼</strong> ã€‚é€šè¿‡è¿™ä¸ªè®¾è®¡ï¼Œæˆ‘ä»¬åªè¦æ‹¥æœ‰å®ä½“çš„IDï¼Œå°±å¯ä»¥ç›´æ¥åœ¨ç¼“å­˜ä¸­è·å–åˆ°å®ä½“çš„æ•°æ®äº†ã€‚</p><p>ä¸ºäº†é™ä½é‡å¤çš„å·¥ä½œé‡ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªæ–¹å¼åšä¸ªæç‚¼ï¼Œå•ç‹¬å°†è¿™ä¸ªæµç¨‹åšæˆä¸­é—´ä»¶ï¼Œå…·ä½“å®ç°å¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/09/02/095a50102cc42a37fa8543dd020b5d02.jpg?wh=1920x1626\" alt=\"å›¾ç‰‡\" title=\"é€šè¿‡canal ç›‘æ§ å®ç° ç®€å•çš„ä¸»åŠ¨æ¨é€æ•°æ®ç¼“å­˜\"></p><p>ç»“åˆä¸Šå›¾ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªä¸­é—´ä»¶çš„å·¥ä½œåŸç†ã€‚æˆ‘ä»¬é€šè¿‡canalæ¥ç›‘æ§MySQLæ•°æ®åº“çš„binlogæ—¥å¿—ï¼Œå½“æœ‰æ•°æ®å˜æ›´æ—¶ï¼Œæ¶ˆæ¯ç›‘å¬ç«¯ä¼šæ”¶åˆ°å˜æ›´é€šçŸ¥ã€‚</p><p>å› ä¸ºå˜æ›´æ¶ˆæ¯åŒ…å«å˜æ›´çš„è¡¨åå’Œæ‰€æœ‰å˜æ›´æ•°æ®çš„æ‰€æœ‰ä¸»é”®IDï¼Œæ‰€ä»¥è¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸»é”®IDï¼Œå›åˆ°æ•°æ®åº“ä¸»åº“æŸ¥è¯¢å‡ºæœ€æ–°çš„å®ä½“æ•°æ®ï¼Œå†æ ¹æ®éœ€è¦æ¥åŠ å·¥è¿™ä¸ªæ•°æ®ï¼Œå¹¶å°†å…¶æ¨é€æ•°æ®åˆ°ç¼“å­˜å½“ä¸­ã€‚</p><p>è€Œä»è¿‡å¾€ç»éªŒæ¥çœ‹ï¼Œå¾ˆå¤šåˆšå˜åŠ¨çš„æ•°æ®æœ‰å¾ˆå¤§æ¦‚ç‡ä¼šè¢«é©¬ä¸Šè¯»å–ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªå®ç°ä¼šæœ‰è¾ƒå¥½çš„ç¼“å­˜å‘½ä¸­ç‡ã€‚åŒæ—¶ï¼Œå½“æˆ‘ä»¬çš„æ•°æ®è¢«ç¼“å­˜åä¼šæ ¹æ®é…ç½®è®¾ç½®ä¸€ä¸ªTTLï¼Œç¼“å­˜åœ¨ä¸€æ®µæ—¶é—´æ²¡æœ‰è¢«è¯»å–çš„è¯ï¼Œå°±ä¼šè¢«LRUç­–ç•¥æ·˜æ±°æ‰ï¼Œè¿™æ ·è¿˜èƒ½èŠ‚çœç¼“å­˜ç©ºé—´ã€‚</p><p>å¦‚æœä½ ä»”ç»†æ€è€ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªè®¾è®¡è¿˜æ˜¯æœ‰ç¼ºé™·ï¼šå¦‚æœä¸šåŠ¡ç³»ç»Ÿæ— æ³•ä»ç¼“å­˜ä¸­æ‹¿åˆ°æ‰€éœ€æ•°æ®ï¼Œè¿˜æ˜¯è¦å›æ•°æ®åº“æŸ¥æ‰¾æ•°æ®ï¼Œå¹¶ä¸”å†æ¬¡å°†æ•°æ®æ”¾åˆ°ç¼“å­˜å½“ä¸­ã€‚è¿™å’Œæˆ‘ä»¬è®¾è®¡åˆè¡·ä¸ä¸€è‡´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é…å¥—ä¸€ä¸ªç¼“å­˜æŸ¥è¯¢æœåŠ¡ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c1/cb/c10415ec4034cc12yyab50b3c6e174cb.jpg?wh=2900x2456\" alt=\"\" title=\"ç¼“å­˜æŸ¥è¯¢åŠæ•°æ®ç¼“å­˜æœåŠ¡\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬æŸ¥æ‰¾ç¼“å­˜æ—¶å¦‚æœæ²¡æ‰¾åˆ°æ•°æ®ï¼Œä¸­é—´ä»¶å°±ä¼šé€šè¿‡Keyè¯†åˆ«å‡ºå¾…æŸ¥æ•°æ®å±äºæ•°æ®åº“çš„å“ªä¸ªè¡¨å’Œå¤„ç†è„šæœ¬ï¼Œå†æŒ‰é…ç½®æ‰§è¡Œè„šæœ¬æŸ¥è¯¢æ•°æ®åº“åšæ•°æ®åŠ å·¥ï¼Œç„¶åä¸­é—´ä»¶å°†è·å–çš„æ•°æ®å›å¡«åˆ°ç¼“å­˜å½“ä¸­ï¼Œæœ€åå†è¿”å›ç»“æœã€‚</p><p>ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå»ºè®®æŸ¥è¯¢æœåŠ¡ä½¿ç”¨ç±»ä¼¼Redisçš„çº¯æ–‡æœ¬é•¿é“¾æ¥åè®®ï¼ŒåŒæ—¶è¿˜éœ€è¦æ”¯æŒæ‰¹é‡è·å–åŠŸèƒ½ï¼Œæ¯”å¦‚Redisçš„mgetå®ç°ã€‚å¦‚æœæˆ‘ä»¬çš„æ•°æ®æ”¯æ’‘æ¶æ„å¾ˆå¤æ‚ï¼Œå¹¶ä¸”ä¸€æ¬¡æŸ¥è¯¢çš„æ•°æ®é‡å¾ˆå¤§ï¼Œè¿˜å¯ä»¥åšæˆæ‰¹é‡å¹¶å‘å¤„ç†æ¥æé«˜ç³»ç»Ÿååæ€§èƒ½ã€‚</p><p>è½åœ°ç¼“å­˜æœåŠ¡è¿˜æœ‰ä¸€äº›å®æ“çš„æŠ€å·§ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ã€‚</p><p>å¦‚æœæŸ¥è¯¢ç¼“å­˜æ—¶æ•°æ®ä¸å­˜åœ¨ï¼Œä¼šå¯¼è‡´è¯·æ±‚ç¼“å­˜ç©¿é€çš„é—®é¢˜ï¼Œè¯·æ±‚é‡å¾ˆå¤§æ ¸å¿ƒæ•°æ®åº“å°±ä¼šå´©æºƒã€‚ä¸ºäº†é¢„é˜²è¿™ç±»é—®é¢˜æˆ‘ä»¬éœ€è¦åœ¨ç¼“å­˜ä¸­åŠ ä¸€ä¸ªç‰¹æ®Šæ ‡å¿—ï¼Œè¿™æ ·æŸ¥è¯¢æœåŠ¡æŸ¥ä¸åˆ°æ•°æ®æ—¶ï¼Œå°±ä¼šç›´æ¥è¿”å›æ•°æ®ä¸å­˜åœ¨ã€‚</p><p>æˆ‘ä»¬è¿˜è¦è€ƒè™‘åˆ°ä¸‡ä¸€çœŸçš„å‡ºç°ç¼“å­˜ç©¿é€é—®é¢˜æ—¶ï¼Œè¦å¦‚ä½•é™åˆ¶æ•°æ®åº“çš„å¹¶å‘æ•°ï¼Œå»ºè®®ä½¿ç”¨SingleFlightåˆå¹¶å¹¶è¡Œè¯·æ±‚ï¼Œæ— éœ€ä½¿ç”¨å…¨å±€é”ï¼Œåªè¦åœ¨æ¯ä¸ªæœåŠ¡èŒƒå›´å†…å®ç°å³å¯ã€‚</p><p>æœ‰æ—¶è¦æŸ¥è¯¢çš„æ•°æ®åˆ†å¸ƒåœ¨<strong>æ•°æ®åº“çš„å¤šä¸ªè¡¨å†…ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¤šä¸ªè¡¨çš„æ•°æ®ç»„åˆèµ·æ¥</strong>æˆ–<strong>éœ€è¦åˆ·æ–°å¤šä¸ªç¼“å­˜</strong>ï¼Œæ‰€ä»¥è¿™è¦æ±‚æˆ‘ä»¬çš„ç¼“å­˜æœåŠ¡èƒ½æä¾›å®šåˆ¶è„šæœ¬ï¼Œè¿™æ ·æ‰èƒ½å®ç°ä¸šåŠ¡æ•°æ®çš„åˆ·æ–°ã€‚</p><p>å¦å¤–ï¼Œç”±äºæ˜¯æ•°æ®åº“å’Œç¼“å­˜è¿™ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„åŒæ­¥ï¼Œä¸ºäº†æ›´å¥½çš„æ’æŸ¥ç¼“å­˜åŒæ­¥é—®é¢˜ï¼Œå»ºè®®åœ¨æ•°æ®åº“ä¸­å’Œç¼“å­˜ä¸­éƒ½è®°å½•æ•°æ®æœ€åæ›´æ–°çš„æ—¶é—´ï¼Œæ–¹ä¾¿ä¹‹åå¯¹æ¯”ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æœåŠ¡å°±åŸºæœ¬å®Œæ•´äº†ã€‚å½“ä¸šåŠ¡éœ€è¦æŒ‰idæŸ¥æ‰¾æ•°æ®æ—¶ï¼Œç›´æ¥è°ƒç”¨æ•°æ®ä¸­é—´ä»¶å³å¯è·å–åˆ°æœ€æ–°çš„æ•°æ®ï¼Œè€Œæ— éœ€é‡å¤å®ç°ï¼Œå¼€å‘è¿‡ç¨‹å˜å¾—ç®€å•å¾ˆå¤šã€‚</p><h2>L1ç¼“å­˜åŠçƒ­ç‚¹ç¼“å­˜å»¶æœŸ</h2><p>ä¸Šé¢æˆ‘ä»¬è®¾è®¡çš„ç¼“å­˜ä¸­é—´ä»¶å·²ç»èƒ½å¤Ÿåº”ä»˜å¤§éƒ¨åˆ†<strong>ä¸´æ—¶ç¼“å­˜</strong>æ‰€éœ€çš„åœºæ™¯ã€‚ä½†å¦‚æœç¢°åˆ°å¤§å¹¶å‘æŸ¥è¯¢çš„åœºæ™¯ï¼Œç¼“å­˜å‡ºç°ç¼ºå¤±æˆ–è¿‡æœŸçš„æƒ…å†µï¼Œå°±ä¼šç»™æ•°æ®åº“é€ æˆå¾ˆå¤§å‹åŠ›ï¼Œä¸ºæ­¤è¿˜éœ€è¦ç»§ç»­æ”¹è¿›è¿™ä¸ªæœåŠ¡ã€‚</p><p>æ”¹è¿›æ–¹å¼å°±æ˜¯ç»Ÿè®¡æŸ¥è¯¢æ¬¡æ•°ï¼Œåˆ¤æ–­è¢«æŸ¥è¯¢çš„keyæ˜¯å¦æ˜¯çƒ­ç‚¹ç¼“å­˜ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚é€šè¿‡æ—¶é—´å—å¼‚æ­¥ç»Ÿè®¡5åˆ†é’Ÿå†…ç¼“å­˜keyè¢«è®¿é—®çš„æ¬¡æ•°ï¼Œå•ä½æ—¶é—´å†…è¶…è¿‡è®¾å®šæ¬¡æ•°ï¼ˆæ ¹æ®ä¸šåŠ¡å®ç°è®¾å®šï¼‰å°±æ˜¯çƒ­ç‚¹ç¼“å­˜ã€‚</p><p>å…·ä½“çš„çƒ­ç‚¹ç¼“å­˜ç»Ÿè®¡å’Œç»­çº¦æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ea/e8/eabcdf7b249a4714993dafc7231b68e8.jpg?wh=2821x1818\" alt=\"\" title=\"çƒ­ç‚¹ç¼“å­˜åŠç»­çº¦\"></p><p>å¯¹ç…§æµç¨‹å›¾å¯ä»¥çœ‹åˆ°ï¼Œçƒ­ç‚¹ç»Ÿè®¡æœåŠ¡è·å–äº†è¢«è®¤å®šæ˜¯çƒ­ç‚¹çš„keyä¹‹åï¼Œä¼šæŒ‰ç»Ÿè®¡æ¬¡æ•°å¤§å°åšåŒºåˆ†ã€‚å¦‚æœæ˜¯<strong>å¾ˆé«˜é¢‘ç‡</strong>è®¿é—®çš„keyä¼šè¢«å®šæœŸä»è„šæœ¬æ¨é€åˆ°L1ç¼“å­˜ä¸­ï¼ˆL1ç¼“å­˜å¯ä»¥éƒ¨ç½²åœ¨æ¯å°ä¸šåŠ¡æœåŠ¡å™¨ä¸Šï¼Œæˆ–æ¯å‡ å°ä¸šåŠ¡æœåŠ¡å™¨å…±ç”¨ä¸€ä¸ªL1ç¼“å­˜ï¼‰ã€‚</p><p>å½“ä¸šåŠ¡æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä¸šåŠ¡çš„æŸ¥è¯¢SDKé©±åŠ¨ä¼šé€šè¿‡çƒ­ç‚¹keyé…ç½®ï¼Œæ£€æµ‹å½“å‰keyæ˜¯å¦ä¸ºçƒ­ç‚¹keyï¼Œå¦‚æœæ˜¯ä¼šå»L1ç¼“å­˜è·å–ï¼Œå¦‚æœä¸æ˜¯çƒ­ç‚¹ç¼“å­˜ä¼šå»é›†ç¾¤ç¼“å­˜è·å–æ•°æ®ã€‚</p><p>è€Œ<strong>ç›¸å¯¹é¢‘ç‡è¾ƒé«˜</strong>çš„keyçƒ­ç‚¹ç¼“å­˜æœåŠ¡ï¼Œåªä¼šå®šæœŸé€šçŸ¥æŸ¥è¯¢æœåŠ¡åˆ·æ–°å¯¹åº”çš„keyï¼Œæˆ–åšTTLåˆ·æ–°ç»­æœŸçš„æ“ä½œã€‚</p><p>å½“æˆ‘ä»¬è¢«æŸ¥è¯¢çš„æ•°æ®é€€çƒ­åï¼Œæˆ‘ä»¬çš„æ•°æ®æ—¶é—´å—çš„è®¿é—®ç»Ÿè®¡æ•°å€¼ä¼šä¸‹é™ï¼Œè¿™æ—¶L1çƒ­ç‚¹ç¼“å­˜æ¨é€æˆ–TTLç»­æœŸä¼šåœæ­¢ç»§ç»­æ“ä½œï¼Œä¸ä¹…åæ•°æ®ä¼šTTLè¿‡æœŸã€‚</p><p>å¢åŠ è¿™ä¸ªåŠŸèƒ½åï¼Œè¿™ä¸ªç¼“å­˜ä¸­é—´ä»¶å°±å¯ä»¥æ”¹åå«åšæ•°æ®ç¼“å­˜å¹³å°äº†ï¼Œä¸è¿‡å®ƒå’ŒçœŸæ­£çš„å¹³å°è¿˜æœ‰ä¸€äº›å·®è·ï¼Œå› ä¸ºè¿™ä¸ªå¹³å°åªèƒ½æä¾›å®ä½“æ•°æ®çš„ç¼“å­˜ï¼Œæ— æ³•çµæ´»åŠ å·¥æ¨é€çš„æ•°æ®ï¼Œä¸€äº›ä¸šåŠ¡ç»“æ„ä»£ç è¿˜è¦äººå·¥å®ç°ã€‚</p><h2>å…³ç³»æ•°æ®ç¼“å­˜</h2><p>å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰æˆ‘ä»¬çš„ç¼“å­˜è¿˜ä»…é™äºå®ä½“æ•°æ®çš„ç¼“å­˜ï¼Œå¹¶ä¸æ”¯æŒå…³ç³»æ•°æ®åº“çš„ç¼“å­˜ã€‚</p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦<strong>æ”¹è¿›æ¶ˆæ¯ç›‘å¬æœåŠ¡</strong>ï¼Œå°†å®ƒåšæˆKafka Group ConsumeræœåŠ¡ï¼ŒåŒæ—¶å®ç°å¯åŠ¨æ€æ‰©å®¹ï¼Œè¿™èƒ½æå‡ç³»ç»Ÿçš„å¹¶è¡Œæ•°æ®å¤„ç†èƒ½åŠ›ï¼Œæ”¯æŒæ›´å¤§é‡çš„å¹¶å‘ä¿®æ”¹ã€‚</p><p>å…¶æ¬¡ï¼Œå¯¹äºé‡çº§æ›´é«˜çš„æ•°æ®ç¼“å­˜ç³»ç»Ÿï¼Œè¿˜å¯ä»¥å¼•å…¥å¤šç§æ•°æ®å¼•æ“å…±åŒæä¾›ä¸åŒçš„æ•°æ®æ”¯æ’‘æœåŠ¡ï¼Œæ¯”å¦‚ï¼š</p><ul>\n<li>luaè„šæœ¬å¼•æ“ï¼ˆå…·ä½“å¯ä»¥å›é¡¾<a href=\"https://time.geekbang.org/column/article/608526\">ç¬¬åä¸ƒèŠ‚è¯¾</a>ï¼‰æ˜¯æ•°æ®æ¨é€çš„â€œå‘åŠ¨æœºâ€ï¼Œèƒ½å¸®æˆ‘ä»¬æŠŠæ•°æ®åŠ¨æ€åŒæ­¥åˆ°å¤šä¸ªæ•°æ®æºï¼›</li>\n<li>Elasticsearchè´Ÿè´£æä¾›å…¨æ–‡æ£€ç´¢åŠŸèƒ½ï¼›</li>\n<li>Pikaè´Ÿè´£æä¾›å¤§å®¹é‡KVæŸ¥è¯¢åŠŸèƒ½ï¼›</li>\n<li>ClickHouseè´Ÿè´£æä¾›å®æ—¶æŸ¥è¯¢æ•°æ®çš„æ±‡æ€»ç»Ÿè®¡åŠŸèƒ½ï¼›</li>\n<li>MySQLå¼•æ“è´Ÿè´£æ”¯æ’‘æ–°ç»´åº¦çš„æ•°æ®æŸ¥è¯¢ã€‚</li>\n</ul><p>ä½ æœ‰æ²¡æœ‰å‘ç°è¿™å‡ ä¸ªå¼•æ“æˆ‘ä»¬åœ¨ä¹‹å‰çš„è¯¾é‡Œéƒ½æœ‰æ¶‰åŠï¼Ÿå”¯ä¸€ä½ å¯èƒ½æ„Ÿåˆ°æœ‰ç‚¹é™Œç”Ÿçš„å°±æ˜¯Pikaï¼Œä¸è¿‡å®ƒä¹Ÿæ²¡é‚£ä¹ˆå¤æ‚ï¼Œå¯ä»¥ç†è§£æˆRocksDBçš„åŠ å¼ºç‰ˆã€‚</p><p>è¿™é‡Œæˆ‘æ²¡æœ‰æŠŠæ¯ä¸ªå¼•æ“ä¸€ä¸€å±•å¼€ï¼Œä½†æ¦‚æ‹¬äº†å®ƒä»¬å„è‡ªæ“…é•¿çš„æ–¹é¢ã€‚å¦‚æœä½ æœ‰å…´è¶£æ·±å…¥ç ”ç©¶çš„è¯ï¼Œå¯ä»¥è‡ªè¡Œæ¢ç´¢ï¼Œçœ‹çœ‹ä¸åŒå¼•æ“é€‚åˆç”¨åœ¨ä»€ä¹ˆä¸šåŠ¡åœºæ™¯ä¸­ã€‚</p><h2>å¤šæ•°æ®å¼•æ“å¹³å°</h2><p>ä¸€ä¸ªç†æƒ³çŠ¶æ€çš„å¤šæ•°æ®å¼•æ“å¹³å°æ˜¯ååˆ†åºå¤§çš„ï¼Œéœ€è¦æŠ•å…¥å¾ˆå¤šäººåŠ›å»ºè®¾ï¼Œå®ƒèƒ½å¤Ÿç»™æˆ‘ä»¬æä¾›å¼ºå¤§çš„æ•°æ®æŸ¥è¯¢åŠåˆ†æèƒ½åŠ›ï¼Œå¹¶ä¸”æ¥å…¥ç®€å•æ–¹ä¾¿ï¼Œèƒ½å¤Ÿå¤§å¤§ä¿ƒè¿›æˆ‘ä»¬çš„ä¸šåŠ¡å¼€å‘æ•ˆç‡ã€‚</p><p>ä¸ºäº†è®©ä½ æœ‰ä¸ªæ•´ä½“è®¤çŸ¥ï¼Œè¿™é‡Œæˆ‘ç‰¹æ„ç”»äº†ä¸€å¼ å¤šæ•°æ®å¼•æ“å¹³å°çš„æ¶æ„å›¾ï¼Œå¸®åŠ©ä½ ç†è§£æ•°æ®å¼•æ“å’Œç¼“å­˜ä»¥åŠæ•°æ®æ›´æ–°ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/43/42/438612baefa2cbaf2be76b1715b75f42.jpg?wh=2067x2030\" alt=\"\" title=\"å¤šæ•°æ®å¼•æ“å¹³å°æ¶æ„å›¾\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ—¶åŸºç¡€æ•°æ®æœåŠ¡å·²ç»åšæˆäº†ä¸€ä¸ªå¹³å°ã€‚MySQLæ•°æ®æ›´æ–°æ—¶ï¼Œä¼šé€šè¿‡æˆ‘ä»¬è®¢é˜…çš„å˜æ›´æ¶ˆæ¯ï¼Œæ ¹æ®æ•°æ®åŠ å·¥è¿‡æ»¤è¿›ç¨‹ï¼Œå°†æ•°æ®æ¨é€åˆ°ä¸åŒçš„å¼•æ“å½“ä¸­ï¼Œå¯¹å¤–æä¾›æ•°æ®ç»Ÿè®¡ã€å¤§æ•°æ®KVã€å†…å­˜ç¼“å­˜ã€å…¨æ–‡æ£€ç´¢ä»¥åŠMySQLå¼‚æ„æ•°æ®æŸ¥è¯¢çš„æœåŠ¡ã€‚</p><p>å…·ä½“ä¸šåŠ¡éœ€è¦ç”¨åˆ°æ ¸å¿ƒä¸šåŠ¡åŸºç¡€æ•°æ®æ—¶ï¼Œéœ€è¦åœ¨è¯¥å¹³å°ç”³è¯·æ•°æ®è®¿é—®æˆæƒã€‚å¦‚æœè¿˜æœ‰ç‰¹æ®Šéœ€è¦ï¼Œå¯ä»¥å‘å¹³å°æäº¤æ•°æ®åŠ å·¥luaè„šæœ¬ã€‚é«˜æµé‡çš„ä¸šåŠ¡ç”šè‡³å¯ä»¥ç”³è¯·ç‹¬ç«‹éƒ¨ç½²ä¸€å¥—æ•°æ®æ”¯æ’‘å¹³å°ã€‚</p><h2>æ€»ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä¸€èµ·å­¦ä¹ äº†ç»Ÿä¸€ç¼“å­˜æ•°æ®å¹³å°çš„å®ç°æ–¹æ¡ˆï¼Œæœ‰äº†è¿™ä¸ªä¸­é—´ä»¶ï¼Œç ”å‘æ•ˆç‡ä¼šå¤§å¤§æé«˜ã€‚åœ¨ä½¿ç”¨æ•°æ®æ”¯æ’‘ç»„ä»¶ä¹‹å‰ï¼Œæ˜¯<strong>ä¸šåŠ¡è‡ªå·±å®ç°çš„ç¼“å­˜ä»¥åŠå¤šæ•°æ®æºçš„åŒæ­¥</strong>ï¼Œéœ€è¦æˆ‘ä»¬ä¸šåŠ¡é‡å¤å†™å¤§é‡å…³äºç¼“å­˜åˆ·æ–°çš„é€»è¾‘ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/52/b1/521f3920d2430b1b2957590c97cbf5b1.jpg?wh=2337x1818\" alt=\"\" title=\"è‡ªå®ç°å¤šæ•°æ®å¼•æ“åŒæ­¥åŠå¤šçº§ç¼“å­˜\"></p><p>è€Œä½¿ç”¨æ•°æ®ç¼“å­˜å¹³å°åï¼Œæˆ‘ä»¬çœå»äº†å¾ˆå¤šäººå·¥å®ç°çš„å·¥ä½œé‡ï¼Œç ”å‘åŒå­¦åªéœ€è¦åœ¨å¹³å°é‡Œåšå¥½é…ç½®ï¼Œå°±èƒ½åäº«ä¸­é—´ä»¶æä¾›çš„å¼ºå¤§å¤šçº§ç¼“å­˜åŠŸèƒ½ã€å¤šç§æ•°æ®å¼•æ“æä¾›çš„æ•°æ®æŸ¥è¯¢æœåŠ¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/d5/27/d59888a65ca981ae9c748b84cf325e27.jpg?wh=2067x1818\" alt=\"\" title=\"é€šè¿‡æ•°æ®ç¼“å­˜å¹³å°å¯¹å¤–æœåŠ¡\"></p><p>æˆ‘ä»¬å›é¡¾ä¸‹ä¸­é—´ä»¶çš„å·¥ä½œåŸç†ã€‚é¦–å…ˆæˆ‘ä»¬é€šè¿‡Canalè®¢é˜…MySQLæ•°æ®åº“çš„binlogï¼Œè·å–æ•°æ®çš„å˜æ›´æ¶ˆæ¯ã€‚ç„¶åï¼Œç¼“å­˜å¹³å°æ ¹æ®è®¢é˜…å˜æ›´ä¿¡æ¯å®ç°è§¦å‘å¼çš„ç¼“å­˜æ›´æ–°ã€‚å¦å¤–ï¼Œç»“åˆå®¢æˆ·ç«¯SDKåŠç¼“å­˜æŸ¥è¯¢æœåŠ¡å®ç°çƒ­ç‚¹æ•°æ®çš„è¯†åˆ«ï¼Œå³å¯å®ç°å¤šçº§ç¼“å­˜æœåŠ¡ã€‚</p><p>å¯ä»¥è¯´,æ•°æ®æ˜¯æˆ‘ä»¬ç³»ç»Ÿçš„å¿ƒè„ï¼Œå¦‚æ•°æ®å¼•æ“èƒ½åŠ›è¶³å¤Ÿå¼ºå¤§ï¼Œèƒ½åšçš„äº‹æƒ…ä¼šå˜å¾—æ›´å¤šã€‚æ•°æ®æ”¯æ’‘å¹³å°æœ€å¤§çš„ç‰¹ç‚¹åœ¨äºï¼Œå°†æˆ‘ä»¬çš„æ•°æ®å’Œå„ç§æ•°æ®å¼•æ“ç»“åˆèµ·æ¥ï¼Œä»è€Œå®ç°æ›´å¼ºå¤§çš„æ•°æ®æœåŠ¡èƒ½åŠ›ã€‚</p><p>å¤§å…¬å¸çš„æ ¸å¿ƒç³»ç»Ÿé€šå¸¸ä¼šç”¨å¤šå¼•æ“ç»„åˆçš„æ–¹å¼ï¼Œå…±åŒæä¾›æ•°æ®æ”¯æ’‘æ•°æ®æœåŠ¡ï¼Œç”šè‡³æœ‰äº›æœåŠ¡çš„æœåŠ¡ç«¯åªéœ€åšé…ç½®å°±å¯ä»¥å¾—åˆ°è¿™äº›åŠŸèƒ½ï¼Œè¿™æ ·ä¸šåŠ¡å®ç°æ›´è½»é‡ï¼Œèƒ½ç»™ä¸šåŠ¡åˆ›é€ æ›´å¹¿é˜”çš„å¢å€¼ç©ºé—´ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>L1ç¼“å­˜ä½¿ç”¨BloomFilteræ¥å‡å°‘L1ç¼“å­˜æŸ¥è¯¢ï¼Œé‚£ä¹ˆBloomFilterçš„hashåˆ—è¡¨å¦‚ä½•æ›´æ–°åˆ°å®¢æˆ·ç«¯å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸æˆ‘äº¤æµè®¨è®ºï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"19ï½œæµé‡è°ƒåº¦ï¼šDNSã€å…¨ç«™åŠ é€ŸåŠæœºæˆ¿è´Ÿè½½å‡è¡¡","id":610265},"right":{"article_title":"21ï½œä¸šåŠ¡ç¼“å­˜ï¼šå…ƒæ•°æ®æœåŠ¡å¦‚ä½•å®ç°ï¼Ÿ","id":611856}},"comments":[{"had_liked":false,"id":388500,"user_name":"é»„å ƒå¥","can_delete":false,"product_type":"c1","uid":2037522,"ip_address":"å¹¿ä¸œ","ucode":"B4AD5250A41B3A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/YbUxEV3741vKZAiasOXggWucQbmicJwIjg3HDE58oyibYXbSop9QQFqZ7X6OhynDoo6rDHwzK8njSeJjN9hx3pJXg/132","comment_is_top":false,"comment_ctime":1710293853,"is_pvip":false,"replies":[{"id":141457,"content":"ä½ å¥½ï¼Œå ƒå¥ï¼Œè¿™ä¸ªå®ç°æœ‰å¤šç§æ–¹å¼ã€‚ä¸¾ä¸ªä¾‹å­æˆ‘ä»¬å½“æ—¶ä½¿ç”¨kafkaåšäº†å¹¿æ’­ï¼Œå®šæœŸå‘é€æ¶ˆæ¯å‘Šè¯‰ç¼“å­˜ä¸­é—´å±‚æ‰€æœ‰æœ€æ–°åˆå¹¶åçš„å€¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŒ‰ä½ è¯´çš„æ–¹å¼å»åšï¼Œç¼ºç‚¹æ˜¯æ–°æ³¨å†Œçš„æœåŠ¡ä¼šç©¿é€ï¼ˆå› ä¸ºä»–éœ€è¦æœ‰åŠæ³•æ‹¿åˆ°å†å²æ‰€æœ‰çš„keyï¼‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1710318717,"ip_address":"åŒ—äº¬","comment_id":388500,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"è€å¸ˆï¼ŒL1 ç¼“å­˜ä½¿ç”¨ BloomFilter æ¥å‡å°‘ L1 ç¼“å­˜æŸ¥è¯¢ï¼Œé‚£ä¹ˆ BloomFilter çš„ hash åˆ—è¡¨å¦‚ä½•æ›´æ–°åˆ°å®¢æˆ·ç«¯å‘¢ï¼Ÿ\n\nè€å¸ˆ æˆ‘æ˜¯è¿™æ ·æ¨æµ‹çš„ï¼Œ ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯ä¸çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªçƒ­keyï¼ŒæœåŠ¡ç«¯è¿”å›æ•°æ®çš„æ—¶å€™ï¼Œå‡ºäº†è¿”å›ä¸šåŠ¡æ•°æ®ä¹‹å¤–ï¼Œå¸¦ä¸Šæ ‡å¿—ï¼Œå‘Šè¯‰å®ƒæ˜¯çƒ­keyã€‚ è¿™æ ·ï¼Œå®¢æˆ·ç«¯çŸ¥é“äº†å®ƒä»¥åå¯ä»¥é€šè¿‡ç›´æ¥åˆ°L1ç¼“å­˜æŸ¥è¯¢ï¼Œè‡ªå·±ä¸»åŠ¨æ›´æ–°è‡ªèº«çš„BloomFilter çš„ hashåˆ—è¡¨ã€‚","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":639136,"discussion_content":"ä½ å¥½ï¼Œå ƒå¥ï¼Œè¿™ä¸ªå®ç°æœ‰å¤šç§æ–¹å¼ã€‚ä¸¾ä¸ªä¾‹å­æˆ‘ä»¬å½“æ—¶ä½¿ç”¨kafkaåšäº†å¹¿æ’­ï¼Œå®šæœŸå‘é€æ¶ˆæ¯å‘Šè¯‰ç¼“å­˜ä¸­é—´å±‚æ‰€æœ‰æœ€æ–°åˆå¹¶åçš„å€¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŒ‰ä½ è¯´çš„æ–¹å¼å»åšï¼Œç¼ºç‚¹æ˜¯æ–°æ³¨å†Œçš„æœåŠ¡ä¼šç©¿é€ï¼ˆå› ä¸ºä»–éœ€è¦æœ‰åŠæ³•æ‹¿åˆ°å†å²æ‰€æœ‰çš„keyï¼‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1710318717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368760,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"å¹¿ä¸œ","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1676651266,"is_pvip":true,"replies":[{"id":134343,"content":"ç¬¬ä¸€å±‚ç¼“å­˜æµé‡æ›´å¤§ï¼Œæ¯”å¦‚å¯ä»¥10å°ä¸šåŠ¡æœåŠ¡å™¨æˆ–è€…3å°ä¸šåŠ¡æœåŠ¡å™¨å¯åŠ¨ä¸€ä¸ªredisä¾›ä»–ä»¬ä½¿ç”¨ï¼Œç›¸å¯¹æˆ‘ä»¬æ ¸å¿ƒä¸šåŠ¡ä½¿ç”¨çš„ç¼“å­˜ï¼Œæ›´åƒå¤–å­˜","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1676870079,"ip_address":"åŒ—äº¬","comment_id":368760,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"å¤šæ•°æ®å¼•æ“å¹³å°å›¾ä¸­ï¼Œç¬¬ä¸€å±‚çš„ä¸´æ—¶æŸ¥è¯¢ç¼“å­˜å’Œç¬¬äºŒå±‚ä¸­çš„redisé›†ç¾¤çš„å·®åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605802,"discussion_content":"ç¬¬ä¸€å±‚ç¼“å­˜æµé‡æ›´å¤§ï¼Œæ¯”å¦‚å¯ä»¥10å°ä¸šåŠ¡æœåŠ¡å™¨æˆ–è€…3å°ä¸šåŠ¡æœåŠ¡å™¨å¯åŠ¨ä¸€ä¸ªredisä¾›ä»–ä»¬ä½¿ç”¨ï¼Œç›¸å¯¹æˆ‘ä»¬æ ¸å¿ƒä¸šåŠ¡ä½¿ç”¨çš„ç¼“å­˜ï¼Œæ›´åƒå¤–å­˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1676870079,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605673,"discussion_content":"ç¬¬ä¸€å±‚çš„ç¼“å­˜ä¼šæ›´å¤šï¼Œä½†æ˜¯å®¹é‡å¾ˆå°ï¼Œå®ƒç”¨äºæ‰¿è½½ç”¨æˆ·é«˜å³°å‹åŠ›","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1676857141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1066752,"avatar":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","nickname":"piboye","note":"","ucode":"7CFD8712857A85","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606006,"discussion_content":"è°¢è°¢å¤§ä½¬æŒ‡ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676883925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368757,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"å¹¿ä¸œ","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1676647619,"is_pvip":true,"replies":[{"id":134342,"content":"ä½ å¥½ï¼Œåªè¦é¡¹ç›®é£é™©å¯æ§ï¼Œéƒ½å¯ä»¥å°è¯•ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1676869962,"ip_address":"åŒ—äº¬","comment_id":368757,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"luaè„šæœ¬ç”Ÿæ€å¤ªå°äº†ï¼Œæˆ‘æœ‰ä¸€ä¸ªæƒ³æ³• ç”¨quicjsåšè„šæ­¥å¼•æ“ï¼Œå¯¹å¤–æ¥å£ä½¿ç”¨httpï¼Œå¾ˆå¤šèšåˆæœåŠ¡å¯ä»¥ç”¨graphqlå¼•æ“æ›¿ä»£äº†ã€‚è€å¸ˆè§‰å¾—æ€ä¹ˆæ ·ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605800,"discussion_content":"ä½ å¥½ï¼Œåªè¦é¡¹ç›®é£é™©å¯æ§ï¼Œéƒ½å¯ä»¥å°è¯•ä¸€ä¸‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1676869962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368756,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"å¹¿ä¸œ","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1676647477,"is_pvip":true,"replies":[{"id":134339,"content":"åç»­è¿˜ä¼šæŒç»­åŠ é¤ï½ï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1676857084,"ip_address":"åŒ—äº¬","comment_id":368756,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"è¿™èŠ‚è¯¾çš„å›¾å¤ªæœ‰ä»·å€¼äº†ğŸ‘","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":605672,"discussion_content":"åç»­è¿˜ä¼šæŒç»­åŠ é¤ï½ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676857084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364586,"user_name":"å¾çŸ³å¤´","can_delete":false,"product_type":"c1","uid":1035885,"ip_address":"å†…è’™å¤","ucode":"D8FA8A64FB7E33","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/6d/530df0dd.jpg","comment_is_top":false,"comment_ctime":1671162627,"is_pvip":true,"replies":[{"id":132524,"content":"ä½ å¥½ï¼Œå¾ˆé«˜å…´æ”¶åˆ°ç•™è¨€ï¼Œè¿™é‡Œå¯ä»¥å…ˆçœ‹çœ‹canalï¼Œç„¶åçœ‹çœ‹luaå¼•æ“","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1671169852,"ip_address":"å†…è’™å¤","comment_id":364586,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"è¿™æ­£æ˜¯æˆ‘éœ€è¦çš„ï¼Œæ¯ä¸ªä¸šåŠ¡å¯¹è±¡éƒ½è¦å†™ä¸ªå·®ä¸å¤šçš„è¿‡ç¨‹ä»£ç ç¡®å®å¾ˆç¹çï¼šå…ˆæŸ¥ç¼“å­˜ï¼ŒæŸ¥ä¸åˆ°å»æŸ¥DBï¼Œå†åŒæ­¥æ•°æ®åˆ°ç¼“å­˜ï¼Œç„¶åè¿”å›å®¢æˆ·ç«¯ã€‚æ— æ³•å¯¹ç¼“å­˜åšé›†ä¸­ç®¡ç†ï¼Œå¾ˆç²—ç³™åˆ†æ•£åœ¨å„ä¸ªæœåŠ¡ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘çš„è®¾æƒ³æ˜¯ç»Ÿä¸€mysqlå’Œredisä½œä¸ºä¸€ä¸ªæ•°æ®æºï¼Œä¸šåŠ¡å±‚ä¸ç”¨å…³æ³¨åŸºç¡€è®¾æ–½æ˜¯mysqlè¿˜æ˜¯Redisï¼Œåªéœ€è¦ä»æ•°æ®æºè¯»å–ã€‚\nå¦‚æœè¦åšä¸€ä¸ªè¿™æ ·çš„æ•°æ®ç¼“å­˜å¹³å°ï¼Œåº”è¯¥æ€ä¹ˆå¼€å§‹ï¼Œä»å“ªé‡Œå…¥æ‰‹ï¼Œæœ‰å“ªäº›èµ„æ–™å‚è€ƒï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596643,"discussion_content":"ä½ å¥½ï¼Œå¾ˆé«˜å…´æ”¶åˆ°ç•™è¨€ï¼Œè¿™é‡Œå¯ä»¥å…ˆçœ‹çœ‹canalï¼Œç„¶åçœ‹çœ‹luaå¼•æ“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671169852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364021,"user_name":"Geek_xbye50","can_delete":false,"product_type":"c1","uid":1006424,"ip_address":"å†…è’™å¤","ucode":"0BF3780C247F22","user_header":"","comment_is_top":false,"comment_ctime":1670459018,"is_pvip":false,"replies":[{"id":132387,"content":"ä½ å¥½ï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•ä¿è¯éšæ—¶æ›´æ–°","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1670667423,"ip_address":"å†…è’™å¤","comment_id":364021,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"è·ŸLayneæƒ³æ³•ä¸€è‡´ï¼ä¸»è¦æ˜¯æ ¹æ®æ­¤æ¬¡è¯·æ±‚çš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯æ•°æ®å¹³å°éœ€è¦ç‰¹åˆ«å‘Šè¯‰å®¢æˆ·ç«¯è¿™æ¬¡è¯·æ±‚çš„æ˜¯çƒ­ç‚¹keyã€‚å†è€…ç»“åˆçƒ­ç‚¹keyçš„ttl å‘¨æœŸæ‹‰å–æ›´æ–°åˆ—è¡¨","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596120,"discussion_content":"ä½ å¥½ï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•ä¿è¯éšæ—¶æ›´æ–°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670667424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":363992,"user_name":"Layne","can_delete":false,"product_type":"c1","uid":1479934,"ip_address":"å†…è’™å¤","ucode":"1FEAACD900AB39","user_header":"https://static001.geekbang.org/account/avatar/00/16/94/fe/5fbf1bdc.jpg","comment_is_top":false,"comment_ctime":1670412606,"is_pvip":true,"replies":[{"id":132386,"content":"ä½ å¥½ï¼Œlayneå¦‚æœæœ‰æ›´æ–°ï¼Œå¦‚ä½•åŠ å¼ºä¸€è‡´æ€§","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1004527,"ctime":1670667375,"ip_address":"å†…è’™å¤","comment_id":363992,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100309001,"comment_content":"è¢«åŠ¨æ–¹å¼ï¼šæ ¹æ®ç¼“å­˜è¿”å›çŠ¶æ€ï¼Œå®¢æˆ·ç«¯æ›´æ–°åˆ—è¡¨ã€‚\nä¸»åŠ¨æ–¹å¼ï¼šå®šæœŸå»æ‹‰ä¸€ä¸‹åˆ—è¡¨","like_count":0,"discussions":[{"author":{"id":1004527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/53/ef/5cdaa18b.jpg","nickname":"thinkpc","note":"","ucode":"0EBF75B8707584","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":596119,"discussion_content":"ä½ å¥½ï¼Œlayneå¦‚æœæœ‰æ›´æ–°ï¼Œå¦‚ä½•åŠ å¼ºä¸€è‡´æ€§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1670667375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}