{"id":577864,"title":"10 | å®æˆ˜ 1ï¼šä» 0 åˆ° 1 å»ºç«‹ç³»ç»Ÿåº”ç”¨çš„å¯è§‚æµ‹æ€§","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç¿ä¸€ç£Šã€‚</p><p>åœ¨å‰é¢çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¾ˆå¤šå¯è§‚æµ‹æ€§çš„ç†è®ºçŸ¥è¯†ã€‚é‚£åŸºç¡€æ‰“å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±è¦çœŸåˆ€çœŸæªåœ°å»ºç«‹ç³»ç»Ÿå¼€å§‹å®æˆ˜äº†ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä¼šåŸºäºä¸€ä¸ªå…¸å‹çš„Spring&nbsp;Cloudçš„åº”ç”¨ï¼Œç»™ä½ è®²è§£å¦‚ä½•ä» 0 åˆ° 1 æ¥æ„å»ºç«¯åˆ°ç«¯çš„å…¨é“¾è·¯å¯è§‚æµ‹æ€§ï¼Œå¦‚ä½•æ‰“é€šå¯è§‚æµ‹æ€§æ•°æ®çš„è”åˆã€‚</p><h2>å®æˆ˜ä¸šåŠ¡ç³»ç»Ÿç®€ä»‹</h2><p>æˆ‘ä»¬è¿™ä¸ªå®æˆ˜é¡¹ç›®é‡‡ç”¨çš„ç³»ç»Ÿæ˜¯è‹¥ä¾ç³»ç»Ÿï¼Œè¿™æ˜¯ä¸€å¥—å¼€æºçš„åå°ç®¡ç†ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ª Java EE ä¼ä¸šçº§å¿«é€Ÿå¼€å‘å¹³å°ï¼Œå®ƒç”±å¤šä¸ªå¾®æœåŠ¡ç»„æˆï¼Œå†…ç½®æ¨¡å—è¯¸å¤šï¼Œå¦‚ï¼šéƒ¨é—¨ç®¡ç†ã€è§’è‰²ç”¨æˆ·ã€èœå•åŠæŒ‰é’®æˆæƒã€æ•°æ®æƒé™ã€ç³»ç»Ÿå‚æ•°ã€æ—¥å¿—ç®¡ç†ã€é€šçŸ¥å…¬å‘Šç­‰ã€‚å¦‚æœéœ€è¦é¡¹ç›®çš„<a href=\"https://gitee.com/y_project/RuoYi-Cloud\">å¼€æºåœ°å€</a>å’Œ<a href=\"http://demo.ruoyi.vip/login\">æ¼”ç¤ºåœ°å€</a>ï¼Œä½ å¯ä»¥ç‚¹å¼€é“¾æ¥æŸ¥çœ‹ã€‚</p><p>è‹¥ä¾ç³»ç»Ÿçš„æ¶æ„ä¸»è¦åŒ…æ‹¬ä¸‹é¢å‡ ç±»ã€‚</p><ul>\n<li>Web é¡µé¢ï¼šæ”¾ç½®åœ¨ Nginx ä¸­ã€‚</li>\n<li>æ³¨å†Œä¸­å¿ƒï¼šNacosã€‚</li>\n<li>ç½‘å…³ï¼šGatewayã€‚</li>\n<li>æœåŠ¡æ¨¡å—ï¼šAuthã€Systemã€‚</li>\n<li>æ•°æ®åº“ï¼šMySQLã€‚</li>\n<li>ç¼“å­˜ï¼šRedisã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/7f/76/7ff92b8b6fdaa7e9f66454fd6d531b76.jpg?wh=1874x1157\" alt=\"å›¾ç‰‡\"></p><p>é¡¹ç›®ä¸­æ¶‰åŠçš„æŠ€æœ¯æ ˆå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/14/71/14473a8a122895015ec986e05565ea71.jpg?wh=1920x1080\" alt=\"å›¾ç‰‡\"></p><p>æé†’ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸ºäº†æ„å»ºå¯è§‚æµ‹æ€§å®æˆ˜é€‰æ‹©çš„æ˜¯å•æœº Jar åŒ…ç‰ˆåº”ç”¨ï¼Œå®ƒå¯ä»¥å°†æ‰€æœ‰æœåŠ¡æ¨¡å—éƒ½éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œåˆ©ç”¨ä¸åŒç«¯å£å¯¹æœåŠ¡è¿›è¡Œè®¿é—®ã€‚</p><h2>å»ºç«‹ä¸šåŠ¡ç³»ç»Ÿçš„å¯è§‚æµ‹</h2><h3>æ¦‚è¿°</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·é’ˆå¯¹è‹¥ä¾è¿™ä¸ªç³»ç»Ÿå»ºç«‹å¯è§‚æµ‹æ€§ã€‚å¸‚é¢ä¸Šæœ‰ä¸å°‘çš„å¼€æºå·¥å…·å¯ä¾›é€‰æ‹©ï¼Œä½†æ˜¯ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œç›®å‰å¹¶æ²¡æœ‰ä¸€ä¸ªå¼€æºå·¥å…·èƒ½å¤Ÿå®Œæ•´åœ°è§£å†³å¯è§‚æµ‹æ€§çš„é—®é¢˜ï¼ŒåŸºæœ¬éƒ½éœ€è¦æŠŠå¤šä¸ªå·¥å…·æ‹¼å‡‘åˆ°ä¸€èµ·æ¥ç”¨ã€‚åœ¨é‡åˆ°ä¸€äº›ä¸šåŠ¡é—®é¢˜æ—¶ï¼Œä»ç„¶éœ€è¦è®¿é—®ä¸åŒçš„å·¥å…·æ¥åˆ†æé—®é¢˜ï¼Œç›¸å…³çš„æ—¥å¿—ã€é“¾è·¯ä»¥åŠæŒ‡æ ‡æ•°æ®ä¹Ÿæ²¡æœ‰å¾ˆå¥½åœ°èåˆï¼Œè¿™æ ·çš„æ“ä½œå¹¶ä¸èƒ½æœ‰æ•ˆå‡è½»è¿ç»´ä»¥åŠå¼€å‘äººå‘˜çš„åˆ†æè°ƒè¯•æˆæœ¬å’Œæ²Ÿé€šæˆæœ¬ã€‚</p><!-- [[[read_end]]] --><p>è€Œè§‚æµ‹äº‘æ˜¯ä¸€æ¬¾ä¸“é—¨ä¸º DevOps å›¢é˜Ÿæ‰“é€ çš„å¯è§‚æµ‹å¹³å°ï¼Œå®ƒå¯ä»¥è®©åŒ…æ‹¬å¼€å‘ã€æµ‹è¯•ã€è¿ç»´åœ¨å†…çš„æ‰€æœ‰å›¢é˜Ÿåœ¨ä¸€å¥—ç»Ÿä¸€çš„å¯è§‚æµ‹æ•°æ®ä½“ç³»ä¸‹å®¢è§‚åˆ†æä¸å®šä½æ•…éšœé—®é¢˜ï¼Œä¾¿äºé«˜æ•ˆåœ°åä½œã€‚å› æ­¤åœ¨è¿™ä¸ªå®æˆ˜çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä¼šé€šè¿‡è§‚æµ‹äº‘æ¥å…·ä½“ä»‹ç»ä¸€ä¸‹å¯è§‚æµ‹æ€§çš„å»ºç«‹è¿‡ç¨‹å’Œä½¿ç”¨æ•ˆæœï¼Œå°†æŒ‡æ ‡ã€é“¾è·¯ã€æ—¥å¿—æ‰€æœ‰çš„å¯è§‚æµ‹æ•°æ®é‡‡é›†ã€å…³è”ä»¥åŠæ•´åˆåˆ†æï¼Œå®ç°ç³»ç»Ÿå®Œæ•´çš„å¯è§‚æµ‹æ€§ã€‚ä½ å¯ä»¥<a href=\"https://www.guance.com\">å…è´¹æ³¨å†Œä¸€ä¸ªè´¦å·</a>ï¼Œè·Ÿæˆ‘ä¸€èµ·å®æˆ˜æ¼”ç»ƒã€‚</p><p><a href=\"https://www.datakit.tools/\">DataKit </a>æ˜¯è§‚æµ‹äº‘çš„æ•°æ®é‡‡é›†å™¨ï¼Œå®ƒä¸ä»…æ”¯æŒå°†æ•°æ®ä¼ è¾“åˆ°è§‚æµ‹äº‘ï¼Œä¹Ÿå…¼å®¹å…¶ä»–çš„åç«¯å­˜å‚¨ã€‚é’ˆå¯¹è‹¥ä¾ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¼šé‡‡é›† Nginxå’ŒMySQL ç­‰æŠ€æœ¯æ ˆç›¸å…³çš„æŒ‡æ ‡å’Œæ—¥å¿—ã€è‹¥ä¾ç³»ç»Ÿçš„æœåŠ¡æ—¥å¿—ã€åº”ç”¨æ€§èƒ½ç›‘æµ‹ APMä»¥åŠç”¨æˆ·è®¿é—®ç›‘æµ‹ RUMï¼Œæœ€ç»ˆé€šè¿‡ DataKit å°†è¿™äº›æ•°æ®æœ‰æ•ˆåœ°å…³è”èµ·æ¥ã€‚æˆ‘æŠŠéœ€è¦é‡‡é›†çš„æ•°æ®åˆ—äº†ä¸€å¼ è¡¨æ ¼ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/11/61/11fe74d8da1d08f09a4690e6c3559861.jpg?wh=1920x1080\" alt=\"å›¾ç‰‡\"></p><p>ä¸‹é¢æˆ‘ä»¬å°†é’ˆå¯¹å„é¡¹æŠ€æœ¯æ ˆä¸€ä¸€è¿›è¡Œä»‹ç»ã€‚</p><h3>Nginx</h3><p>Nginx ç›¸ä¿¡ä½ å·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚å› ä¸ºNginx çš„åº”ç”¨åœºæ™¯å¹¿æ³›ï¼Œæ‰€ä»¥å¯¹å¤§éƒ¨åˆ†ä¼ä¸šæ¥è¯´è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚å¦‚ä½•ä¿éšœ Nginx çš„å¥åº·ä¸ç¨³å®šä¹Ÿæ˜¯ä¼ä¸šå†…éƒ¨çš„è¿ç»´äººå‘˜éå¸¸å…³å¿ƒçš„ä¸€ä»¶äº‹ã€‚</p><p>Nginx è‡ªèº«æä¾›äº†ä¸å°‘æ•°æ®æºå¯ä»¥åé¦ˆè‡ªèº«çš„çŠ¶æ€ã€‚æ¯”æ–¹è¯´ï¼ŒNginx è‡ªå¸¦çš„æ€§èƒ½æŒ‡æ ‡æ¨¡å— with-http_stub_status_module å°±å¯ä»¥ç›´æ¥è·å–  Nginx  ç›¸å…³çš„æ•°æ®ï¼ˆä¾‹å¦‚è¯·æ±‚è¿æ¥æ•°ã€å¤„ç†è¿æ¥æ•°ç­‰ï¼‰ã€‚åŒæ—¶ï¼Œ Nginx æ—¥å¿—ï¼ˆåŒ…æ‹¬ access.log å’Œ error.logï¼‰å¯ä»¥ç”¨æ¥è¿›è¡Œå…·ä½“çš„è¯·æ±‚å±‚é¢çš„åˆ†æï¼Œåƒ PV æ•°é‡ã€UV æ•°é‡ã€è¯·æ±‚é”™è¯¯ç»Ÿè®¡ç­‰ã€‚æ€§èƒ½æŒ‡æ ‡ä¸æ—¥å¿—çš„ç»“åˆå°±å¯ä»¥å¿«é€Ÿäº†è§£ Nginx è‡ªèº«çš„å¾ˆå¤šçŠ¶æ€ã€‚</p><p>ä½†æ˜¯ï¼Œæ–‡æœ¬ç±»çš„æ—¥å¿—æ•°æ®æ ¼å¼è§‚çœ‹èµ·æ¥æ—¢ä¸æ–¹ä¾¿ä¹Ÿä¸ç¾è§‚ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œè¿™äº›æ•°æ®æ ¼å¼ä¸èƒ½å®æ—¶åæ˜  Nginx ç›¸å…³è¯·æ±‚æ•°æˆ–æœåŠ¡å™¨è¯·æ±‚çŠ¶æ€çš„å˜åŒ–è¶‹åŠ¿ã€‚<strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡é‡‡é›† Nginx çš„æ€§èƒ½çŠ¶æ€å’Œæ—¥å¿—ï¼ŒæŠŠæ•°æ®æ”¾åˆ°åŒä¸€å¹³å°åŒä¸€ç•Œé¢å±•ç°å‡ºæ¥ï¼Œå€Ÿæ­¤æé«˜ä½¿ç”¨äººå‘˜çš„å·¥ä½œæ•ˆç‡ã€‚</strong></p><p>Nginx ç›¸å…³çš„æ•°æ®å±•ç°æ•ˆæœå¦‚ä¸‹ï¼ˆè¿™æ˜¯è§‚æµ‹äº‘å†…ç½®çš„ä»ªè¡¨ç›˜ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œé€šè¿‡å†…ç½®çš„å„ç§è§†å›¾éƒ¨ä»¶è¿›è¡Œè‡ªå®šä¹‰ï¼‰ï¼Œè¿™æ ·å¯ä»¥å°†æ—¥å¿—ä¿¡æ¯å½¢æˆæŒ‡æ ‡ï¼ŒåŒæ—¶ä¹Ÿèƒ½å±•ç°å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œè§‚æµ‹äº‘ä¸­çš„ä»ªè¡¨ç›˜å¹¶ä¸ä»…ä»…åªæ˜¯é™æ€çš„è§†å›¾ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡Œç›¸å…³çš„ä¸‹é’»è·³è½¬ï¼Œä»è€Œä»æ›´å¤šç»´åº¦å¯¹æ•°æ®è¿›è¡Œåˆ†æã€‚åœ¨è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»æ•°æ®çš„æ¥å…¥ã€‚ä¸‹ä¸€è®²ï¼Œæˆ‘ä¼šè¿›ä¸€æ­¥è®²è§£æ¥å…¥ä¹‹åï¼Œå¦‚ä½•åˆ†æé—®é¢˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9c/df/9c3fde639f26060748796a162b688bdf.png?wh=1731x695\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/52/20/52655f2003cc1cc8f47554891b4f2420.png?wh=1730x660\" alt=\"å›¾ç‰‡\"></p><p>ä¸Šå›¾å±•ç°çš„æ˜¯è§‚æµ‹äº‘ä¸­æä¾›çš„å†…ç½®è§†å›¾æ¨¡æ¿ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è§£è¯»ä¸€ä¸‹å…·ä½“çš„æ¥å…¥æ–¹å¼ã€‚</p><p>åœ¨ Nginx çš„æ‰€åœ¨çš„ä¸»æœºä¸­å®‰è£…å¥½ DataKit ä¹‹åï¼Œï¼ˆæˆ–æ˜¯é€šè¿‡ DaemonSet éƒ¨ç½²æ¥æ”¯æŒ Kubernetes ç¯å¢ƒï¼‰ï¼Œéœ€è¦è¿›è¡Œå‡ æ­¥ç®€å•çš„é…ç½®ï¼š</p><ol>\n<li>å®‰è£… Nginx çš„ with-http_stub_status_module æ¨¡å—ï¼›</li>\n<li>åœ¨ Nginx.conf ä¸­å¢æ·» nginx_status çš„ location è½¬å‘ï¼›</li>\n</ol><pre><code class=\"language-plain\">$ cd /etc/nginx&nbsp; &nbsp;\n&nbsp; &nbsp;## nginx è·¯å¾„æ ¹æ®å®é™…æƒ…å†µè€Œå®š\n$ vim nginx.conf\n\n$&nbsp; server{\n&nbsp; &nbsp; &nbsp;listen 80;&nbsp; &nbsp;\n&nbsp; &nbsp; &nbsp;server_name localhost;\n&nbsp; &nbsp; &nbsp;##ç«¯å£å¯è‡ªå®šä¹‰\n&nbsp; &nbsp; &nbsp;\n&nbsp; &nbsp; &nbsp; location /nginx_status {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stub_status&nbsp; on;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allow 127.0.0.1;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; deny all;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&nbsp; &nbsp; &nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n</code></pre><ol start=\"3\">\n<li>å¯ç”¨ DataKit çš„ Nginx.confï¼Œå¹¶ä¿®æ”¹ inputsï¼š</li>\n</ol><pre><code class=\"language-plain\">$ cd /usr/local/datakit/conf.d/nginx/\n$ cp nginx.conf.sample nginx.conf\n$ vim&nbsp; nginx.conf\n\n#ä¿®æ”¹å¦‚ä¸‹å†…å®¹\n[[inputs.nginx]]\n&nbsp; &nbsp; &nbsp; &nbsp; url = http://localhost/nginx_status\n[inputs.nginx.log]\n&nbsp; &nbsp; &nbsp; &nbsp; files = [\"/var/log/nginx/access.log\",\"/var/log/nginx /error.log\"]\n\n#ä¿å­˜æ–‡ä»¶åé‡å¯ datakit&nbsp; &nbsp;&nbsp;\n$ service datakit restart\n</code></pre><h3>MySQL</h3><p>å†æ¥çœ‹ä¸‹MySQLã€‚MySQL ç›‘æµ‹åœºæ™¯ä¸»è¦å±•ç¤ºäº† MySQL çš„åŸºç¡€ä¿¡æ¯ã€é“¾æ¥ä¿¡æ¯ã€å­˜å‚¨ç©ºé—´ä¿¡æ¯ã€InnoDB ä¿¡æ¯ã€æ€§èƒ½ä¿¡æ¯ã€é”ä¿¡æ¯ä»¥åŠæ—¥å¿—ä¿¡æ¯ï¼ˆåŒ…æ‹¬ /var/log/mysql/*.logï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéœ€è¦ä¸ºç›‘æµ‹ MySQL åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è´¦å·ï¼Œèµ‹äºˆè¯¥ç”¨æˆ·åœ¨æœ¬åœ°æˆ–è¿œç¨‹è¯»å–æ•°æ®çš„æƒé™ã€‚</p><p>MySQLçš„è¯¦ç»†é…ç½®åœ¨è¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œå®ƒè·Ÿ Nginx ç±»ä¼¼ï¼Œåªè¦ä¿®æ”¹ DataKit çš„ MySQL inputs å°±å¯ä»¥äº†ã€‚å…·ä½“å¯ä»¥å‚è€ƒ<a href=\"https://www.yuque.com/dataflux/datakit/mysql\">ç›¸å…³æ–‡æ¡£</a>ã€‚</p><p>é‡‡é›†å¥½æ•°æ®åï¼Œå¯ä»¥åœ¨è§‚æµ‹äº‘ä¸Šçœ‹åˆ°è¿™æ ·çš„ä»ªè¡¨ç›˜ï¼ˆç±»ä¼¼ Nginxã€MySQL çš„ä»ªè¡¨ç›˜ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹ï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d3/a5/d3e69625e612cb1a2cbe4fb5d57465a5.png?wh=1728x533\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/e3/aa/e38df6100f13c2ac8fb60446a919beaa.png?wh=1722x418\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/a3/89/a36d13c30e83a81b8e77e5a31d577489.png?wh=1719x538\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/e1/9c/e19a30cf44f47cafc296eaa27ce8869c.png?wh=1718x215\" alt=\"å›¾ç‰‡\"></p><h3>Redis</h3><p>ç›‘è§† Redis å¯ä»¥å¸®åŠ©ä½ åœ¨ä¸¤ä¸ªæ–¹é¢å‘ç°é—®é¢˜ï¼šRedis æœ¬èº«çš„èµ„æºé—®é¢˜ä»¥åŠæ”¯æŒåŸºç¡€æ¶æ„ä¸­å…¶ä»–åœ°æ–¹å‡ºç°çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢å‡ ä¸ªç»´åº¦ä¸­å¯¹ Redis è¿›è¡Œç›‘æµ‹ï¼šæ€§èƒ½æŒ‡æ ‡ã€å†…å­˜æŒ‡æ ‡ã€åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ã€æŒç»­æ€§æŒ‡æ ‡ã€ä»¥åŠé”™è¯¯æŒ‡æ ‡ã€‚Redis çš„è¯¦ç»†é…ç½®å¯ä»¥å‚è€ƒ<a href=\"https://www.yuque.com/dataflux/datakit/redis\">ç›¸å…³æ–‡æ¡£</a>ã€‚</p><p>é‡‡é›†æ•°æ®ä¹‹åï¼Œåœ¨è§‚æµ‹äº‘å¯ä»¥æ±‡æ€»å‡ºä¸‹é¢è¿™æ ·çš„ä»ªè¡¨ç›˜ï¼ˆç±»ä¼¼ Nginxã€Redis ä»ªè¡¨ç›˜ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹ï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8f/dc/8f9a27c939905e42eebcc77830e75cdc.png?wh=1701x925\" alt=\"å›¾ç‰‡\"></p><h3>JVM</h3><p>è¿™é‡Œåªè¦åœ¨ Datakit ä¸­å¯ç”¨ JVM çš„ inputs å³å¯ï¼Œä¸éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚Java åº”ç”¨å¯åŠ¨çš„è„šæœ¬ï¼Œå°†åœ¨å¾…ä¼šè¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚</p><pre><code class=\"language-plain\">$ cd /usr/local/datakit/conf.d/statsd/\n$ cp statsd.conf.sample ddtrace-jvm-statsd.conf \n$ vim ddtrace-jvm-statsd.conf\n\n# é»˜è®¤ä¸éœ€è¦ä¿®æ”¹\n</code></pre><p>æ•°æ®é‡‡é›†å®Œæ¯•åï¼Œåœ¨è§‚æµ‹äº‘å¯ä»¥æ±‡æ€»å‡ºå¦‚ä¸‹ç•Œé¢ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/94/2a/94b4a71c0e495dab60f64292fd775c2a.png?wh=1701x596\" alt=\"å›¾ç‰‡\"></p><h3>æ—¥å¿—é‡‡é›†</h3><p>è¿™ä¸€æ­¥é‡‡é›†çš„ä¸ä»…ä»…æ˜¯æ ‡å‡†æ—¥å¿—ï¼ˆ Nginxã€MySQLã€Redis ç­‰ï¼‰ï¼Œä¹ŸåŒ…æ‹¬ä¸šåŠ¡æ—¥å¿—ï¼Œä¾‹å¦‚ï¼Œè‹¥ä¾ç³»ç»Ÿå°±æœ‰ system æœåŠ¡æ—¥å¿—ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡ä¸‹é¢è¿™æ ·æ–¹å¼æ¥é…ç½®æ—¥å¿—é‡‡é›†ã€‚</p><pre><code class=\"language-plain\">$ cd /usr/local/datakit/conf.d/log/\n$ cp logging.conf.sample logging.conf\n$ vim logging.conf\n\n## ä¿®æ”¹ log è·¯å¾„ä¸ºæ­£ç¡®çš„åº”ç”¨æ—¥å¿—çš„è·¯å¾„\n## source ä¸ service ä¸ºå¿…å¡«å­—æ®µï¼Œå¯ä»¥ç›´æ¥ç”¨åº”ç”¨åç§°ï¼Œç”¨ä»¥åŒºåˆ†ä¸åŒçš„æ—¥å¿—åç§°\n\n&nbsp; [inputs.logging]\n&nbsp; &nbsp; logfiles = [\n&nbsp; &nbsp; &nbsp; \"/usr/local/ruoyi/logs/ruoyi-system/error.log\",\n&nbsp; &nbsp; &nbsp; \"/usr/local/ruoyi/logs/ruoyi-system/info.log\",]\n&nbsp; &nbsp; source = \"ruoyi-system\"\n&nbsp; &nbsp; service = \"ruoyi-system\"\n &nbsp; pipeline = \"ruoyi-system.p\"\n</code></pre><p>è¿™é‡Œçš„ Pipeline å°±æ˜¯ grok è¯­å¥ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œä¸»è¦ç”¨æ¥è§£ææ–‡æœ¬æ—¥å¿—ï¼Œ å°†æ—¥å¿—ä¸­çš„å„ä¸ªå­—æ®µæå–å‡ºæ¥ï¼Œå½¢æˆç»“æ„åŒ–çš„æ•°æ®ã€‚</p><pre><code class=\"language-plain\">$ cd /usr/local/datakit/pipeline/\n$ vim ruoyi_system.p\n\n##ç¤ºä¾‹ï¼š\n#æ—¥å¿—æ ·å¼&nbsp;\n#2021-06-25 14:27:51.952 [http-nio-9201-exec-7] INFO&nbsp; c.r.s.c.SysUserController - [list,70] ruoyi-08-system 5430221015886118174 6503455222153372731 - æŸ¥è¯¢ç”¨æˆ·\n\n##ç¤ºä¾‹ grokï¼Œå¤åˆ¶å¦‚ä¸‹å†…å®¹è‡³ ruoyi_system.p ä¸­\n\ngrok(_, \"%{TIMESTAMP_ISO8601:time} %{NOTSPACE:thread_name} %{LOGLEVEL:level} \\\\s+%{NOTSPACE:class_name} - \\\\[%{NOTSPACE:method_name},%{NUMBER:line}\\\\] %{DATA:service} %{DATA:trace_id} %{DATA:span_id} - %{GREEDYDATA:msg}\")\n\ndefault_time(time)\n</code></pre><h3>åº”ç”¨æ€§èƒ½ç›‘æµ‹ APM</h3><p>APM çš„å…¨ç§°æ˜¯åº”ç”¨æ€§èƒ½ç›‘æµ‹ï¼ˆApplication Performance Monitoringï¼‰ï¼Œè¿™æ˜¯ä¸€ç§éšç€äº’è”ç½‘çš„å‘å±•è¡ç”Ÿå‡ºçš„ç›‘æ§æŠ€æœ¯ï¼Œå®ƒçš„å­˜åœ¨å°±æ˜¯ä¸ºäº†è§£å†³äº’è”ç½‘ç”¨æˆ·é«˜å¹¶å‘ã€å¤§æµé‡å¸¦æ¥çš„åº”ç”¨æ€§èƒ½ç“¶é¢ˆé—®é¢˜ï¼Œä»å¼€å‘å’Œè¿ç»´çš„è§’åº¦å°†åº”ç”¨ç¨‹åºçš„å±‚å±‚è°ƒç”¨é€»è¾‘é€æ˜åŒ–ï¼Œä»è€Œæ–¹ä¾¿ä¼ä¸šå¿«é€Ÿè¿›è¡Œæ•…éšœå®šä½ï¼Œé™ä½ MTTRï¼ˆMean time to repairï¼Œå¹³å‡æ•…éšœä¿®å¤æ—¶é—´ï¼‰ï¼Œæå‡æ•´ä½“çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>ä»æœ¬è´¨ä¸Šè®²ï¼ŒAPM ä¸ NPMï¼ˆæ—è·¯ç›‘å¬ï¼‰ã€æ—¥å¿—ç­‰éƒ¨ç½²æ–¹å¼æœ‰æ¯”è¾ƒå¤§çš„åŒºåˆ«ï¼Œåº”ç”¨åœºæ™¯ä¹Ÿç•¥æœ‰ä¸åŒã€‚APM çš„éƒ¨ç½²æ–¹å¼å¾€å¾€æ˜¯ä¾µå…¥å¼çš„ï¼ˆå­—èŠ‚ç æ³¨å…¥æˆ–è€… AOPï¼‰ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç ”å‘å’Œè¿ç»´æŸ¥çœ‹ç³»ç»Ÿæ•´ä½“è¿è¡ŒçŠ¶æ€ã€å¥åº·ç¨‹åº¦ä»¥åŠèµ„æºæ¶ˆè€—æˆ–å¼‚å¸¸é—®é¢˜ï¼ˆåŒ…æ‹¬å¤–éƒ¨ API ã€æ•°æ®åº“è°ƒç”¨ã€è‡ªèº«æ›´ç»†ç²’åº¦çš„ä»£ç åŠæ–¹æ³•è°ƒç”¨ï¼‰ï¼Œå®ƒæ›´åå‘äºåº”ç”¨ä¾§çš„ç³»ç»Ÿæ€§èƒ½åŠç¨³å®šæ€§ä¿éšœã€‚</p><p>è§‚æµ‹äº‘ç›®å‰æ”¯æŒæ‰€æœ‰æ”¯æŒ Opentracing åè®®çš„ APM ç›‘æ§å·¥å…·ï¼Œä¾‹å¦‚å¸‚é¢ä¸Šæ¯”è¾ƒæµè¡Œçš„ Skywalkingã€Zipkinã€Jaegerã€ddtrace ç­‰ï¼Œä»¥åŠ OpenTelemetryã€‚å…·ä½“æ¥å…¥æ–¹å¼ä¹Ÿä¸åŸå·¥å…·æ¥å…¥æ–¹å¼ä¸€è‡´ï¼ŒåŒæ—¶åœ¨ DataKit ä¸­å¼€å¯å¯¹åº”çš„é‡‡é›†é…ç½®ï¼Œå°±å¯ä»¥å°†é“¾è·¯æ•°æ®æ‰“è‡³è§‚æµ‹äº‘äº†ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ DataDog çš„å¼€æº ddtrace-agent å®ç°æ•°æ®é‡‡é›†ã€‚éœ€è¦å…ˆ kill æ‰åŸæœ‰åº”ç”¨å¯åŠ¨è¿›ç¨‹ï¼Œç„¶åæ·»åŠ  ddtrace å‚æ•°ï¼Œé‡å¯åº”ç”¨ã€‚å¯ä»¥ä½¿ç”¨ ps -ef | grep ruoyi æ¥æŸ¥æ‰¾è‹¥ä¾ç³»ç»Ÿçš„è¿›ç¨‹ã€‚</p><p>æ·»åŠ  ddtrace-agent åçš„åº”ç”¨å¯åŠ¨è„šæœ¬ç¤ºä¾‹å¦‚ä¸‹ï¼ˆè§‚æµ‹äº‘æ”¯æŒ ddtrace ä½œä¸º APM çš„æ¢é’ˆæ¥æ”¶é›†æ•°æ®ï¼‰ï¼š</p><pre><code class=\"language-plain\">$ cd /usr/local/ruoyi/\n$ nohup java -Dfile.encoding=utf-8 -javaagent:dd-java-agent-0.80.0.jar -XX:FlightRecorderOptions=stackdepth=256 -Ddd.logs.injection=true -Ddd.service=ruoyi-gateway -Ddd.service.mapping=redis:redis_ruoyi -Ddd.agent.port=9529 -Ddd.jmxfetch.enabled=true -Ddd.jmxfetch.check-period=1000&nbsp; -Ddd.jmxfetch.statsd.port=8125 -Ddd.version=1.0 -jar ruoyi-gateway.jar &gt; logs/gateway.log&nbsp; 2&gt;&amp;1 &amp;\n&nbsp;\n$ nohup java -Dfile.encoding=utf-8 -javaagent:dd-java-agent-0.80.0.jar&nbsp; -XX:FlightRecorderOptions=stackdepth=256 -Ddd.logs.injection=true -Ddd.service=ruoyi-auth -Ddd.service.mapping=redis:redis_ruoyi -Ddd.env=staging -Ddd.agent.port=9529 -Ddd.jmxfetch.enabled=true -Ddd.jmxfetch.check-period=1000 -Ddd.jmxfetch.statsd.port=8125 -Ddd.version=1.0 -jar ruoyi-auth.jar &gt; logs/auth.log&nbsp; 2&gt;&amp;1 &amp;&nbsp;\n&nbsp;\n$ nohup java -Dfile.encoding=utf-8 -javaagent:dd-java-agent-0.80.0.jar -XX:FlightRecorderOptions=stackdepth=256 -Ddd.logs.injection=true -Ddd.service=ruoyi-modules-system -Ddd.service.mapping=redis:redis_ruoyi,mysql:mysql_ruoyi -Ddd.env=dev -Ddd.agent.port=9529 -Ddd.jmxfetch.enabled=true -Ddd.jmxfetch.check-period=1000 -Ddd.jmxfetch.statsd.port=8125 -Ddd.version=1.0 -jar ruoyi-modules-system.jar &gt; logs/system.log&nbsp; 2&gt;&amp;1 &amp;&nbsp;\n</code></pre><p>å»ºç«‹APM ä¹‹åï¼Œå¯ä»¥è‡ªåŠ¨å‘ç°æœåŠ¡çš„æ‹“æ‰‘ã€äº’ç›¸é—´çš„å…³ç³»ï¼Œè¿˜èƒ½æŸ¥çœ‹é“¾è·¯çš„è¯¦ç»†ä¿¡æ¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b9/a3/b9e693aba9ac46a2f7c1e1f33d8ec8a3.png?wh=1342x1174\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/7c/6a/7c8aca39c525dd2yy2713fbe4208fe6a.png?wh=1920x434\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/00/c9/00bf32bf16d9746f1443c16c9c5675c9.png?wh=1920x996\" alt=\"å›¾ç‰‡\"></p><h3>ç”¨æˆ·è®¿é—®ç›‘æµ‹ RUM</h3><p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹RUMã€‚</p><p>RUMå…¨ç§°æ˜¯ Real User Monitoringï¼Œç”¨æˆ·è®¿é—®ç›‘æµ‹ã€‚éšç€ç§»åŠ¨äº’è”ç½‘çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„ä¼ä¸šæœ€ç»ˆçš„ä¸šåŠ¡è¡¨ç°å½¢å¼éƒ½æ±‡èšåˆ°äº†ç»ˆç«¯ç”¨æˆ·ä¾§ï¼Œä¹Ÿå°±æ˜¯RUMç«¯ã€‚å…·ä½“å½¢å¼æœ‰ Mobile Appã€Webé¡µé¢ã€å°ç¨‹åºï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®ã€å¤´æ¡ï¼‰ç­‰ã€‚çœŸå®ç”¨æˆ·çš„ç»ˆç«¯ä½“éªŒä¼šç›´æ¥å½±å“ç»ˆç«¯ç”¨æˆ·çš„æ–°å¢ã€ç•™å­˜ã€ä¼ä¸šå½¢è±¡ç”šè‡³ä¼ä¸šçš„è¥æ”¶ã€‚</p><p>é‚£å¦‚ä½•æå‡ç»ˆç«¯ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒå‘¢ï¼Ÿè¿™æ˜¯äº’è”ç½‘è¡Œä¸šä¹ƒè‡³æ­£åœ¨é€æ­¥è¿›è¡Œæ•°å­—åŒ–è½¬å‹çš„ä¼ ç»Ÿä¼ä¸šå¿…é¡»è¦è€ƒè™‘çš„ä¸€ä¸ªé—®é¢˜ã€‚</p><p>RUMé‡‡é›†æ•°æ®çš„æ–¹å¼ç»è¿‡äº†å¥½å‡ ä»£å˜æ›´ã€‚ç›®å‰å¸‚é¢ä¸Šå¸¸è§çš„æ˜¯åŸºäº W3Cï¼ˆä¸‡ç»´ç½‘è”ç›Ÿï¼‰å®šä¹‰çš„ <a href=\"https://www.w3.org/TR/navigation-timing/\">navigation-timing</a> æ ‡å‡†ï¼Œè¯¥æ ‡å‡†è¯¦ç»†å®šä¹‰äº†å„ç§æµè§ˆå™¨äº‹ä»¶ï¼Œé€šè¿‡æµè§ˆå™¨äº‹ä»¶çš„ç®€å•è®¡ç®—å°±å¯ä»¥ç®—å‡ºæ¥å‰ç«¯é¡µé¢çš„é¦–å±ã€ç™½å±ã€DOM åŠ è½½ã€HTML åŠ è½½ç­‰æ—¶é•¿ï¼Œèƒ½å¤Ÿæ¯”æµ‹è¯•ç¯å¢ƒçš„ F12 æ£€æŸ¥è€…æ¨¡å¼æ›´æœ‰æ•ˆåœ°æ”¶é›†ç”Ÿäº§ç¯å¢ƒä¸­çœŸå®ç”¨æˆ·çš„å‰ç«¯ä½“éªŒï¼Œå› æ­¤åœ¨å½“å‰ H5 åº”ç”¨åœºæ™¯è¶Šæ¥è¶Šå¤šçš„æƒ…å†µä¸‹æä¸ºæµè¡Œã€‚å›½å†…çš„å¾ˆå¤šå•†ä¸šè½¯ä»¶éƒ½æ˜¯ä¾èµ–è¿™ä¸ªæ ‡å‡†å®šåˆ¶çš„ Web ç›‘æµ‹ä½“ç³»ã€‚</p><p>ä½†æ˜¯ï¼Œéšç€æµè§ˆå™¨ï¼ˆå°¤å…¶æ˜¯ Chromeï¼‰ä»¥åŠå‰ç«¯æŠ€æœ¯çš„å‘å±•ï¼Œnavigation-timing çš„å±€é™æ€§è¶Šæ¥è¶Šæ˜æ˜¾ã€‚ä¾‹å¦‚ï¼Œå‰åç«¯åˆ†ç¦»ä¸‹å•é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼ŒåŸºäº navigation-timing è¿›è¡Œæ•°æ®é‡‡é›†ä¼šæ¯”è¾ƒç¹çã€‚å› æ­¤ï¼ŒW3C åˆæ¨å‡ºäº†ä¸€ä¸ªæ–°çš„æ ‡å‡†  <a href=\"https://github.com/w3c/paint-timing/\">PaintTiming-github</a>ã€‚</p><p>è¿™ä¸ªæ ‡å‡†æ–°æå‡ºäº†ä¸€äº›æŒ‡æ ‡ï¼ŒåŒ…æ‹¬ï¼šé¦–æ¬¡ç»˜åˆ¶ï¼ˆFirst Paintï¼‰ã€é¦–æ¬¡å†…å®¹ç»˜åˆ¶ï¼ˆFirst Contentful Paintï¼‰ç­‰ã€‚è¿™äº›æŒ‡æ ‡èƒ½å¤Ÿæ›´çœŸå®åœ°åæ˜ ç”¨æˆ·åœ¨è®¿é—® Web é¡µé¢æ—¶çš„çœŸå®ä½“éªŒã€‚æˆ‘ä»¬è¿™ä¸ªç¤ºä¾‹é‡‡ç”¨çš„å°±æ˜¯æ”¯æŒ PaingTiming è§„èŒƒçš„æ•°æ®é‡‡é›†ã€‚å¦‚æœä½ å¯¹è¿™ä¸ªè§„èŒƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥è¿›ä¸€æ­¥é˜…è¯» <a href=\"https://zhuanlan.zhihu.com/p/30389490\">ã€Šä½¿ç”¨ Paint Timing API æé«˜æ€§èƒ½ã€‹</a> <a href=\"https://www.w3cplus.com/performance/paint-timing-api.html\">ã€Šä½¿ç”¨ Paint Timing APIã€‹</a>è¿™ä¸¤ç¯‡æ–‡ç« ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨å‰ç«¯é¡µé¢ index.html ä¸­æ¥å…¥ RUM å¯è§‚æµ‹æ€§ JavaScript æ–‡ä»¶ï¼š</p><pre><code class=\"language-plain\">$ cd /usr/local/ruoyi/dist/\n\n// è®°å¾—å¤‡ä»½\n$ cp index.html index.html.bkd\n\n// åœ¨ index.html ä¸­æ·»åŠ  df-js\n// å¤åˆ¶ DF å¹³å°ä¸Šçš„ js å†…å®¹ï¼Œæ”¾è‡³ index.html å†…çš„ &lt;/head&gt; ä¹‹å‰ï¼Œç„¶åä¿å­˜æ–‡ä»¶,ç¤ºä¾‹å¦‚ä¸‹\n\n$ vim index.html\n\n&lt;script src=\"https://static.dataflux.cn/browser-sdk/v2/dataflux-rum.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script&gt;\n&nbsp; window.DATAFLUX_RUM &amp;&amp;\n&nbsp; &nbsp; window.DATAFLUX_RUM.init({\n&nbsp; &nbsp; &nbsp; applicationId: 'xxxxxxxxxxxxxxxxxxxxxxxxxx',\n&nbsp; &nbsp; &nbsp; datakitOrigin: 'xxx.xxx.xxx.xxx:9529',\n&nbsp; &nbsp; &nbsp; env: 'test',\n&nbsp; &nbsp; &nbsp; version: '1.0.0',\n&nbsp; &nbsp; &nbsp; trackInteractions: true,\n&nbsp; &nbsp; &nbsp; allowedDDTracingOrigins:[\"xxx.xxx.xxx.xxx\"]\n&nbsp; &nbsp; &nbsp; })\n&lt;/script&gt;&lt;/head&gt;&nbsp;\n</code></pre><p>è¯·æ³¨æ„ï¼Œä¸Šè¿°ä»£ç ä¸­çš„ â€œxxxâ€ éƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæ›´æ”¹ï¼Œæ›´æ”¹è¯´æ˜å¦‚ä¸‹ã€‚</p><ul>\n<li>datakitOriginï¼šdatakit åœ°å€ï¼ˆdatakit æ‰€åœ¨æœåŠ¡å™¨çš„ IP æˆ–åŸŸåï¼‰ï¼Œè§‚æµ‹äº‘ä¸­ RUM æ•°æ®æµå‘ä¸ºï¼šrum.js æ–‡ä»¶ -&gt; datakit -&gt; dataway -&gt; è§‚æµ‹äº‘å¹³å°ï¼Œå¦‚æœæ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¦å°†è¯¥ IP è®¾ç½®ä¸ºåŸŸåæˆ– SLB åœ°å€ï¼Œæµ‹è¯•ç¯å¢ƒéœ€å¡«å†™å†…ç½‘IPï¼Œå¯¹åº” datakit çš„æœåŠ¡å™¨ 9529 ç«¯å£ã€‚</li>\n<li>trackInteractionsï¼šç”¨æˆ·è¡Œä¸ºé‡‡é›†é…ç½®é¡¹ï¼Œå¯å®ç°é¡µé¢ç«¯ç”¨æˆ·æ“ä½œè¡Œä¸ºç»Ÿè®¡ã€‚</li>\n<li>allowedDDTracingOriginsï¼šæ‰“é€šå‰åç«¯ï¼ˆRUM ä¸APMï¼‰çš„é…ç½®é¡¹ï¼Œå¯æŒ‰éœ€è¿›è¡Œè®¾ç½®ï¼Œéœ€åœ¨æ­¤å¤„å¡«å†™ä¸å‰ç«¯é¡µé¢æœ‰äº¤äº’å…³ç³»çš„åç«¯æœåŠ¡å™¨æ‰€å¯¹åº”çš„åŸŸåæˆ–IPã€‚</li>\n</ul><p>è¿™æ ·åœ¨è‹¥ä¾ç³»ç»Ÿé¡µé¢æœ‰è®¿é—®ä¹‹åï¼Œå°±å¯ä»¥åœ¨è§‚æµ‹äº‘çš„ç”¨æˆ·è®¿é—®ç›‘æµ‹æ¨¡å—çœ‹åˆ°æ•°æ®ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/5f/a5/5f785acfed9d9ee482ec2147cb686fa5.png?wh=1920x1214\" alt=\"å›¾ç‰‡\"></p><p><img src=\"https://static001.geekbang.org/resource/image/58/f4/5872386a5ee4b146b6f3611b534089f4.png?wh=1920x787\" alt=\"å›¾ç‰‡\"></p><h3>RUM ä¸ APM æ•°æ®æ‰“é€š</h3><p>åœ¨æˆ‘ä»¬åˆ†æé—®é¢˜çš„æ—¶å€™ï¼Œå¾ˆå¤šæƒ…å†µä¸‹éœ€è¦ç»¼åˆå‰ç«¯ RUM å’Œåç«¯ APM çš„æƒ…å†µæ¥åšå…³è”åˆ†æï¼Œæ‰€ä»¥æ‰“é€š RUM å’Œ APM çš„æ•°æ®æ˜¯éå¸¸å¿…è¦çš„ã€‚</p><p>è¦æ‰“é€šæ•°æ®ï¼Œéœ€è¦åœ¨å‰ç«¯ HTML ä¸­å·²æ·»åŠ çš„ df-rum-js ä¸­æ·»åŠ  allowedDDTracingOrigins æ ‡ç­¾ï¼Œå¹¶å¡«å†™å‰ç«¯å¯¹åº”çš„åç«¯åŸŸåï¼Œä¾‹å¦‚è¦åœ¨ testobservability.local æ·»åŠ  RUM ç›‘æ§ï¼Œéœ€è¦åœ¨ allowedDDTracingOrigins é‡Œé…ç½® <a href=\"https://www\">https://www</a><a href=\"https://www.dataflux.cn/\">.</a>testobservability.localã€‚å¦‚æœå­˜åœ¨å¤šä¸ªåŸŸåï¼Œåˆ™éœ€è¦æŠŠè¿™äº›åŸŸåéƒ½è¿›è¡Œé…ç½®ï¼Œç”¨é€—å·éš”å¼€ï¼Œç¬¬ä¸‰æ–¹åŸŸåå¯ä»¥ä¸é…ç½®ã€‚</p><h3>æ—¥å¿—ä¸ APM å®ç°å…³è”</h3><p>åŒæ ·ï¼Œä¸ºäº†æ„å»ºæ•°æ®è”åˆçš„å¯è§‚æµ‹æ€§ï¼Œæˆ‘ä»¬ä¹Ÿè¦æŠŠæ—¥å¿—å’Œåº”ç”¨æ€§èƒ½ç›‘æµ‹å…³è”èµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹åº”ç”¨æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ï¼ˆéœ€å¼€å‘ä»‹å…¥ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨æ—¥å¿—è¾“å‡ºæ ¼å¼æ–‡ä»¶ä¸º logback/log4jï¼Œddtrace-agent  java-0.70 ç‰ˆæœ¬åä¼šè‡ªåŠ¨å°†è·Ÿè¸ªæ ‡è¯†æ³¨å…¥ï¼Œåªéœ€è¦ä¿®æ”¹ logback/log4j çš„ XMLæ–‡ä»¶ï¼Œåœ¨åº”ç”¨æ—¥å¿—çš„è¾“å‡ºå†…å®¹ä¸­æ·»åŠ  trace_id å­—æ®µå³å¯ã€‚æ›´è¯¦ç»†çš„è¯´æ˜ä½ å¯ä»¥å‚è€ƒ <a href=\"https://docs.datadoghq.com/logs/log_collection/java/?tab=logback\">datadog å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><pre><code class=\"language-plain\">## é¦–å…ˆåœ¨ pom.xml çš„ dependency ä¸­å¼•å…¥ datadog ä¾èµ–\n\n&lt;dependency&gt;\n   &lt;groupId&gt;com.datadoghq&lt;/groupId&gt; \n   &lt;artifactId&gt;dd-java-agent&lt;/artifactId&gt; \n   &lt;version&gt;0.83.0&lt;/version&gt; \n&lt;/dependency&gt;\n\n## 0.83.0 ä¸ºå¯¹åº” agent ç‰ˆæœ¬å·ï¼Œè¯·æŸ¥çœ‹datakit/data ä¸­çš„ agent ç‰ˆæœ¬å·\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/57/ec/579f85847ced585a5cf5b9f14a71d0ec.png?wh=1277x841\" alt=\"å›¾ç‰‡\"></p><p>å°†æ—¥å¿—å’Œ APM å…³è”åˆ°ä¸€èµ·ä¹‹åï¼Œåœ¨ APM é“¾è·¯æ•°æ®ä¸‹æ–¹çš„æ—¥å¿—æ¨¡å—ç›´æ¥æœç´¢ trace_idï¼Œå°±å¯ä»¥æŸ¥çœ‹æ­¤æ¬¡é“¾è·¯è°ƒç”¨å¯¹åº”äº§ç”Ÿçš„åº”ç”¨æ—¥å¿—äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/92/1c/92788e4a46ab748e68337db455e59b1c.png?wh=1920x909\" alt=\"å›¾ç‰‡\"></p><h2>å°ç»“</h2><p>åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä¸ºä½ ä»‹ç»äº†å¦‚ä½•é’ˆå¯¹ä¸€ä¸ªå¾®æœåŠ¡ç³»ç»Ÿï¼Œä»æŒ‡æ ‡ã€æ—¥å¿—ã€é“¾è·¯è¿½è¸ªã€å‰ç«¯ç”¨æˆ·è®¿é—®ç­‰å„ç»´åº¦æ¥é‡‡é›†å¯è§‚æµ‹æ€§çš„æ•°æ®ï¼Œå¹¶å»ºç«‹æ•°æ®ä¹‹é—´çš„å…³è”æ€§ã€‚</p><p>æœ‰äº†è¿™äº›æ•°æ®ä¹‹åï¼Œä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒä»¬åˆ†æå’Œæ’æŸ¥é—®é¢˜äº†ã€‚</p><h2>è¯¾åé¢˜</h2><p>åœ¨è¿™èŠ‚è¯¾çš„æœ€åï¼Œæˆ‘ç•™ç»™ä½ ä¸€é“ä½œä¸šé¢˜ã€‚</p><p>è¯·æ ¹æ®æˆ‘ä»¬è¿™èŠ‚è¯¾çš„å†…å®¹ï¼Œæ­å»ºä¸€ä¸ªæµ‹è¯•ç¯å¢ƒã€‚ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸€ä¸ªå¼€æºæˆ–æ˜¯ä½ æ­£åœ¨ç»´æŠ¤çš„ç³»ç»Ÿï¼Œæ¥é‡‡é›†å’Œå±•ç°å¯è§‚æµ‹æ€§ç›¸å…³çš„æ•°æ®ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµè®¨è®ºï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"09 | è·Ÿè¸ª SLOï¼šå¦‚ä½•åŸºäºé”™è¯¯é¢„ç®—é‡‡å–è¡ŒåŠ¨ï¼Ÿ","id":576727},"right":{"article_title":"11 | å®æˆ˜ 2ï¼šåŸºäºå¯è§‚æµ‹æ€§æ•°æ®è¿›è¡Œé—®é¢˜åˆ†æå’Œæ ¹å› å®šä½","id":578203}},"comments":[{"had_liked":false,"id":359116,"user_name":"ææ—","can_delete":false,"product_type":"c1","uid":2833829,"ip_address":"ä¸Šæµ·","ucode":"AD1066B71D1490","user_header":"https://static001.geekbang.org/account/avatar/00/2b/3d/a5/f09ac813.jpg","comment_is_top":false,"comment_ctime":1665277687,"is_pvip":false,"replies":[{"id":130619,"content":"æ„Ÿè°¢åé¦ˆï¼å…¶å®åœ¨å†™è¿™å‡ ç¯‡çš„æ—¶å€™ï¼Œä¹Ÿç¡®å®è€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ã€‚ä¸­ç«‹è½¯ä»¶ä¸»è¦æ˜¯å¼€æºè½¯ä»¶äº†ï¼Œä½†ç›®å‰ç¡®å®è¿˜æ²¡æœ‰èƒ½å¤Ÿæ¯”è¾ƒå®Œæ•´çš„æ„å»ºå¯è§‚æµ‹æ€§çš„ï¼Œå¯èƒ½éœ€è¦å‡ ä¸ªå·¥å…·æ¯ä¸ªæ¥è´Ÿè´£ä¸€å—ï¼›OpenTelemetry çš„è¯ï¼Œåœ¨ç¬¬ 4 è®²é‡Œé¢æœ‰ä¸“é—¨çš„ä»‹ç»ã€‚æ‰€ä»¥åœ¨å®æˆ˜çš„ç¯èŠ‚ï¼Œæ˜¯æƒ³å€ŸåŠ©ä¸€äº› demo ç³»ç»Ÿï¼Œä»¥åŠèƒ½å¤Ÿæ¯”è¾ƒç³»ç»Ÿæ€§åœ°å±•ç°å¯è§‚æµ‹æ€§çš„è½¯ä»¶æˆ–å·¥å…·ï¼Œæ¥æ•´ä½“åšä¸€äº›é˜è¿°ã€‚å¦ä¸€æ–¹é¢ï¼Œé€‰æ‹©çš„è½¯ä»¶ä¹Ÿæ˜¯å¯ä»¥å…è´¹æ³¨å†Œï¼Œå…¨åŠŸèƒ½ä½¿ç”¨ï¼Œä¸»è¦æ˜¯å¯ä»¥æ›´ç›´è§‚çš„æ¥çœ‹ä¸€ä¸‹æ•ˆæœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1044522,"ctime":1665308425,"ip_address":"ä¸Šæµ·","comment_id":359116,"utype":1}],"discussion_count":9,"race_medal":0,"score":2,"product_id":100121701,"comment_content":"å®æˆ˜è¿™ä¸¤ç¯‡æ„Ÿè§‰æ›´åƒæ˜¯åœ¨ä»‹ç»ä¸€æ¬¾è½¯ä»¶ï¼Œè€Œä¸æ˜¯è®²è§£å¯è§‚æµ‹æ€§æœ¬èº«ã€‚\næˆ‘è‡ªå·±å¸Œæœ›äº†è§£çš„æ˜¯æ›´ä¸­ç«‹çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸æ˜¯åªèƒ½ä¾é æŸä¸ªç‰¹å®šçš„å•†ç”¨è½¯ä»¶æ‰èƒ½å®ç°çš„å¯è§‚æµ‹æ€§ã€‚\nå¯¹äºä»˜è´¹æŠ€æœ¯æ–‡ç« æ¥è¯´ï¼Œæ›´å§”å©‰çš„å°èŒƒå›´çš„æœ‰æŠ€å·§çš„è®²è§£å•†ç”¨è½¯ä»¶ç‰¹é•¿ä¼˜åŠ¿æ˜¯ä¸æ˜¯æ›´ç¨³å¦¥ï¼Ÿ","like_count":15,"discussions":[{"author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589781,"discussion_content":"æ„Ÿè°¢åé¦ˆï¼å…¶å®åœ¨å†™è¿™å‡ ç¯‡çš„æ—¶å€™ï¼Œä¹Ÿç¡®å®è€ƒè™‘è¿‡è¿™ä¸ªé—®é¢˜ã€‚ä¸­ç«‹è½¯ä»¶ä¸»è¦æ˜¯å¼€æºè½¯ä»¶äº†ï¼Œä½†ç›®å‰ç¡®å®è¿˜æ²¡æœ‰èƒ½å¤Ÿæ¯”è¾ƒå®Œæ•´çš„æ„å»ºå¯è§‚æµ‹æ€§çš„ï¼Œå¯èƒ½éœ€è¦å‡ ä¸ªå·¥å…·æ¯ä¸ªæ¥è´Ÿè´£ä¸€å—ï¼›OpenTelemetry çš„è¯ï¼Œåœ¨ç¬¬ 4 è®²é‡Œé¢æœ‰ä¸“é—¨çš„ä»‹ç»ã€‚æ‰€ä»¥åœ¨å®æˆ˜çš„ç¯èŠ‚ï¼Œæ˜¯æƒ³å€ŸåŠ©ä¸€äº› demo ç³»ç»Ÿï¼Œä»¥åŠèƒ½å¤Ÿæ¯”è¾ƒç³»ç»Ÿæ€§åœ°å±•ç°å¯è§‚æµ‹æ€§çš„è½¯ä»¶æˆ–å·¥å…·ï¼Œæ¥æ•´ä½“åšä¸€äº›é˜è¿°ã€‚å¦ä¸€æ–¹é¢ï¼Œé€‰æ‹©çš„è½¯ä»¶ä¹Ÿæ˜¯å¯ä»¥å…è´¹æ³¨å†Œï¼Œå…¨åŠŸèƒ½ä½¿ç”¨ï¼Œä¸»è¦æ˜¯å¯ä»¥æ›´ç›´è§‚çš„æ¥çœ‹ä¸€ä¸‹æ•ˆæœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665308425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1201755,"avatar":"https://static001.geekbang.org/account/avatar/00/12/56/5b/42abdcac.jpg","nickname":"Leyoz","note":"","ucode":"2DCFB9CA42CE2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":597331,"discussion_content":"åº”è¯¥å›´ç»•OpenTelemetryå±•å¼€å®ç°ä¸€ä¸ªç‹¬ç«‹å¾—å¯è§‚æµ‹è¡Œçš„è½¯ä»¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671689314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":589781,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":597331,"extra":""},{"author":{"id":1087348,"avatar":"https://static001.geekbang.org/account/avatar/00/10/97/74/49d150d7.jpg","nickname":"å‘å…‰å¦‚æ˜Ÿ","note":"","ucode":"1176C2EB6CC401","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":640014,"discussion_content":"æ„Ÿè°¢åé¦ˆï¼Œæ‹’ä¸æ”¹æ­£ï¼Œäººå“æœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711069030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":589781,"ip_address":"æ±Ÿè‹","group_id":0},"score":640014,"extra":""}]},{"author":{"id":1507368,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/stIwwlk3jVf52IV58ibn6yIt851XbibeQlOn479kMvkZehK9ZhuxhWN2PU6AMq4dh9ZFwPeP3JKnuibIDq2kSPM4A/132","nickname":"Geek_36fe48","note":"","ucode":"8BCF159B579820","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591871,"discussion_content":"èŠ±é’±çœ‹å¹¿å‘Šçš„æ„Ÿè§‰","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1666880636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1211991,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7e/57/8c1051b6.jpg","nickname":"3.0çš„A7","note":"","ucode":"23C5F02B45CE39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1507368,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/stIwwlk3jVf52IV58ibn6yIt851XbibeQlOn479kMvkZehK9ZhuxhWN2PU6AMq4dh9ZFwPeP3JKnuibIDq2kSPM4A/132","nickname":"Geek_36fe48","note":"","ucode":"8BCF159B579820","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629460,"discussion_content":"çœŸç›¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697096515,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":591871,"ip_address":"åŒ—äº¬","group_id":0},"score":629460,"extra":""}]},{"author":{"id":1572461,"avatar":"","nickname":"Geek_0cf5f2","note":"","ucode":"A56A6D337E830C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592136,"discussion_content":"è¯¾ç¨‹ç¬¬ä¸€æ¬¡æè§‚æµ‹äº‘è¿™ä¸ªåå­—æˆ‘å°±æ‡‚äº†","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1667141277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè¥¿","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087348,"avatar":"https://static001.geekbang.org/account/avatar/00/10/97/74/49d150d7.jpg","nickname":"å‘å…‰å¦‚æ˜Ÿ","note":"","ucode":"1176C2EB6CC401","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":639947,"discussion_content":"æœ€å¥½çš„æ–¹æ¡ˆæ˜¯å¼€æºè½¯ä»¶æœ‰å“ªäº›éƒ¨åˆ†å¯ä»¥å®ç°ï¼Œè¿™æ ·çš„æ„Ÿè§‰å°±æ˜¯åšäº†ä¸ªå¹¿å‘Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711007928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2049011,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1znsUF88YEepJS9I58GGJict9NYTRybkz993KlPpvnC0sTibm3d6bWLIyhcETsYrVDPiakiaextmrXbnFkIsL7EfRQ/132","nickname":"æ²ˆå­ç š","note":"","ucode":"E00BE02AF51F11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590800,"discussion_content":"å“ªä½å¤§ç¥å¯¹datadogç†Ÿæ‚‰çš„ï¼Œè¯·åˆ†æä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666078258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1303472,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/b0/ffb32dfe.jpg","nickname":"Eric","note":"","ucode":"4101A16B77AB3A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590759,"discussion_content":"åŒæ„Ÿï¼Œå»ºè®®è¿˜æ˜¯ç”¨å¼€æºæ–¹æ¡ˆè®²å§ï¼Œå•†ç”¨çš„å°æå¯¹æ¯”ä¸‹ä¼˜åŠ¿å³å¯ã€‚è¦ä¸ç¡®å®æœ‰é‚£ä¹ˆä¸€ç‚¹æ€ªæ€ªçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666066828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368877,"user_name":"ğŸ€Ceezyï£¿","can_delete":false,"product_type":"c1","uid":1454017,"ip_address":"å¹¿ä¸œ","ucode":"BD57EF6DB13868","user_header":"https://static001.geekbang.org/account/avatar/00/16/2f/c1/ea40a9a9.jpg","comment_is_top":false,"comment_ctime":1676860481,"is_pvip":false,"replies":[{"id":134558,"content":"RUM è¿™å—çš„ä¾‹å­ä¼šåœ¨åç»­å®æˆ˜çš„ç« èŠ‚ä¸­è®²è§£","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1044522,"ctime":1677256103,"ip_address":"ä¸Šæµ·","comment_id":368877,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100121701,"comment_content":"RUM è¿™é‡Œæœ‰é’ˆå¯¹ App çš„ä¾‹å­å—ï¼Ÿ App å¦‚æœè¦åŠ å…¥åˆ°å¯è§‚æµ‹æ€§ä¸­ï¼Œä¸šç•Œæœ‰å“ªäº›è§£å†³æ–¹æ¡ˆæˆ–å·¥å…·å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606661,"discussion_content":"RUM è¿™å—çš„ä¾‹å­ä¼šåœ¨åç»­å®æˆ˜çš„ç« èŠ‚ä¸­è®²è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677256103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359141,"user_name":"singer_wang","can_delete":false,"product_type":"c1","uid":1108359,"ip_address":"ä¸Šæµ·","ucode":"E596F85A37A890","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/87/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1665287593,"is_pvip":false,"replies":[{"id":130620,"content":"è¿™å—å¯ä»¥å†å›é¡¾ä¸€ä¸‹ç¬¬ 7 è®²ï¼Œä¸»è¦åœ¨ä»‹ç»å¯è§‚æµ‹æ€§é©±åŠ¨çš„å¼€å‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1044522,"ctime":1665308493,"ip_address":"ä¸Šæµ·","comment_id":359141,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100121701,"comment_content":"è¯·æ•™ç¿è€å¸ˆï¼Œå¯è§‚æµ‹æ€§æ˜¯åº”ç”¨ç³»ç»Ÿè‡ªèº«çš„ä¸€ä¸ªå±æ€§ï¼Œé‚£ä¹ˆåº”ç”¨ç³»ç»Ÿå¼€å‘åº”è¯¥å¦‚ä½•åšï¼Œåšåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œæ‰èƒ½è¯´è¿™ä¸ªåº”ç”¨ç³»ç»Ÿçš„å¯è§‚æµ‹æ€§å¼ºå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589782,"discussion_content":"è¿™å—å¯ä»¥å†å›é¡¾ä¸€ä¸‹ç¬¬ 7 è®²ï¼Œä¸»è¦åœ¨ä»‹ç»å¯è§‚æµ‹æ€§é©±åŠ¨çš„å¼€å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665308494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1076264,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6c/28/a1f9f0ad.jpg","nickname":"é™ˆæ ‘ä¹‰","note":"","ucode":"AF83C4BDC192B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":590234,"discussion_content":"çœ‹äº†ä¸‹å¯è§‚æµ‹æ€§é©±åŠ¨å¼€å‘çš„æ€è·¯ï¼Œå…¶å®è·ŸæŒ‡æ ‡é©±åŠ¨å¼€å‘ä¸€æ ·ï¼Œæ²¡å•¥å¤ªå¤§åŒºåˆ«ã€‚  å…·ä½“è½åœ°åˆ°ç ”å‘è¡Œä¸ºä¸­ï¼Œæ„Ÿè§‰èƒ½åšçš„äº‹æƒ…æ¯”è¾ƒå°‘ï¼Œè¿™å—æ„Ÿè§‰å¯ä»¥å¤šè¡¥å……ä¸€ä¸‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665631086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":589782,"ip_address":"å¹¿ä¸œ","group_id":0},"score":590234,"extra":""}]}]},{"had_liked":false,"id":358855,"user_name":"E","can_delete":false,"product_type":"c1","uid":1075666,"ip_address":"ä¸Šæµ·","ucode":"80B68506B590EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/69/d2/8a53f0a3.jpg","comment_is_top":false,"comment_ctime":1664930302,"is_pvip":false,"replies":[{"id":130616,"content":"æ„Ÿè°¢æŒ‡å‡ºï¼Œå·²ä¿®æ”¹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1044522,"ctime":1665306377,"ip_address":"ä¸Šæµ·","comment_id":358855,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100121701,"comment_content":"Nginx é‚£ä¸€æ®µçš„ â€œacces.logâ€ åº”è¯¥æ˜¯ â€œaccess.logâ€","like_count":0,"discussions":[{"author":{"id":1044522,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f0/2a/8d6c3957.jpg","nickname":"Coffee Cat","note":"","ucode":"979B24B995F8DE","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589770,"discussion_content":"æ„Ÿè°¢æŒ‡å‡ºï¼Œå·²ä¿®æ”¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665306377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391087,"user_name":"é‡‘é¾Ÿ","can_delete":false,"product_type":"c1","uid":1228500,"ip_address":"å››å·","ucode":"1C7D35C8AE8D9D","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/d4/ff1c1319.jpg","comment_is_top":false,"comment_ctime":1717253589,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100121701,"comment_content":"æˆ‘æ³¨å†Œäº†ä¸€ä¸ªè§‚æµ‹äº‘è´¦å·ï¼Œæ€ä¹ˆå’Œä½ ä¸€èµ·å®æˆ˜ã€‚ã€‚ã€‚ã€‚ã€‚ä¸»æœºä¸Šä»€ä¹ˆéƒ½æ²¡æœ‰","like_count":1}]}