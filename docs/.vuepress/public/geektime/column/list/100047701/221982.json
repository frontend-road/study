{"id":221982,"title":"33 | åŠ é¤3ï¼šå®šä½åº”ç”¨é—®é¢˜ï¼Œæ’é”™å¥—è·¯å¾ˆé‡è¦","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚</p><p>å’±ä»¬è¿™ä¸ªè¯¾ç¨‹å·²ç»æ›´æ–°13è®²äº†ï¼Œæ„Ÿè°¢å„ä½åŒå­¦ä¸€ç›´åœ¨åšæŒå­¦ä¹ ï¼Œå¹¶åœ¨è¯„è®ºåŒºç•™ä¸‹äº†å¾ˆå¤šé«˜è´¨é‡çš„ç•™è¨€ã€‚è¿™äº›ç•™è¨€ï¼Œæœ‰çš„æ˜¯åˆ†äº«è‡ªå·±æ›¾ç»è¸©çš„å‘ï¼Œæœ‰çš„æ˜¯å¯¹è¯¾åæ€è€ƒé¢˜çš„è¯¦ç»†è§£ç­”ï¼Œè¿˜æœ‰çš„æ˜¯æå‡ºäº†éå¸¸å¥½çš„é—®é¢˜ï¼Œè¿›ä¸€æ­¥ä¸°å¯Œäº†è¿™ä¸ªè¯¾ç¨‹çš„å†…å®¹ã€‚</p><p>æœ‰åŒå­¦è¯´ï¼Œè¿™ä¸ªè¯¾ç¨‹çš„æ¡ˆä¾‹éå¸¸å®ç”¨ï¼Œéƒ½æ˜¯å·¥ä½œä¸­ä¼šé‡åˆ°çš„ã€‚æ­£å¦‚æˆ‘åœ¨å¼€ç¯‡è¯ä¸­æ‰€è¯´ï¼Œè¿™ä¸ªè¯¾ç¨‹æ¶‰åŠçš„100ä¸ªæ¡ˆä¾‹ã€çº¦130ä¸ªå°å‘ï¼Œæœ‰40%æ¥è‡ªäºæˆ‘ç»å†è¿‡æˆ–è€…æ˜¯è§è¿‡çš„200å¤šä¸ªçº¿ä¸Šç”Ÿäº§äº‹æ•…ï¼Œå‰©ä¸‹çš„60%æ¥è‡ªäºæˆ‘å¼€å‘ä¸šåŠ¡é¡¹ç›®ï¼Œä»¥åŠæ—¥å¸¸å®¡æ ¸åˆ«äººçš„ä»£ç å‘ç°çš„é—®é¢˜ã€‚ç¡®å®ï¼Œæˆ‘åœ¨æ•´ç†è¿™äº›æ¡ˆä¾‹ä¸ŠèŠ±è´¹äº†å¾ˆå¤šç²¾åŠ›ï¼Œä¹Ÿç‰¹åˆ«æ„Ÿè°¢å„ä½åŒå­¦çš„è®¤å¯ï¼Œæ›´å¸Œæœ›ä½ ä»¬èƒ½ç»§ç»­åšæŒå­¦ä¹ ï¼Œç»§ç»­åœ¨è¯„è®ºåŒºå’Œæˆ‘äº¤æµã€‚</p><p>ä¹Ÿæœ‰åŒå­¦åé¦ˆï¼Œæ’æŸ¥é—®é¢˜çš„æ€è·¯å¾ˆé‡è¦ï¼Œå¸Œæœ›è‡ªå·±é‡åˆ°é—®é¢˜æ—¶ï¼Œä¹Ÿèƒ½å¤Ÿä»å®¹ã€é«˜æ•ˆåœ°å®šä½åˆ°æ ¹å› ã€‚å› æ­¤ï¼Œä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘å°±ä¸ä½ è¯´è¯´æˆ‘åœ¨åº”æ€¥æ’é”™æ–¹é¢ç§¯ç´¯çš„å¿ƒå¾—ã€‚è¿™éƒ½æ˜¯æˆ‘å¤šå¹´æ‹…ä»»æŠ€æœ¯è´Ÿè´£äººå’Œæ¶æ„å¸ˆè‡ªå·±æ€»ç»“å‡ºæ¥çš„ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚å½“ç„¶äº†ï¼Œä¹ŸæœŸå¾…ä½ èƒ½ç•™è¨€ä¸æˆ‘è¯´è¯´ï¼Œè‡ªå·±å¹³æ—¶çš„æ’é”™å¥—è·¯ã€‚</p><h2>åœ¨ä¸åŒç¯å¢ƒæ’æŸ¥é—®é¢˜ï¼Œæœ‰ä¸åŒçš„æ–¹å¼</h2><p>è¦è¯´æ’æŸ¥é—®é¢˜çš„æ€è·¯ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—æ˜ç™½æ˜¯åœ¨ä»€ä¹ˆç¯å¢ƒæ’é”™ã€‚</p><ul>\n<li>å¦‚æœæ˜¯åœ¨è‡ªå·±çš„å¼€å‘ç¯å¢ƒæ’æŸ¥é—®é¢˜ï¼Œé‚£ä½ å‡ ä¹å¯ä»¥ä½¿ç”¨ä»»ä½•è‡ªå·±ç†Ÿæ‚‰çš„å·¥å…·æ¥æ’æŸ¥ï¼Œç”šè‡³å¯ä»¥è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚åªè¦é—®é¢˜èƒ½é‡ç°ï¼Œæ’æŸ¥å°±ä¸ä¼šå¤ªå›°éš¾ï¼Œæœ€å¤šå°±æ˜¯æŠŠç¨‹åºè°ƒè¯•åˆ°JDKæˆ–ä¸‰æ–¹ç±»åº“å†…éƒ¨è¿›è¡Œåˆ†æã€‚</li>\n<li>å¦‚æœæ˜¯åœ¨æµ‹è¯•ç¯å¢ƒæ’æŸ¥é—®é¢˜ï¼Œç›¸æ¯”å¼€å‘ç¯å¢ƒå°‘çš„æ˜¯è°ƒè¯•ï¼Œä¸è¿‡ä½ å¯ä»¥ä½¿ç”¨JDKè‡ªå¸¦çš„jvisualvmæˆ–é˜¿é‡Œçš„<a href=\"https://github.com/alibaba/arthas\">Arthas</a>ï¼Œé™„åŠ åˆ°è¿œç¨‹çš„JVMè¿›ç¨‹æ’æŸ¥é—®é¢˜ã€‚å¦å¤–ï¼Œæµ‹è¯•ç¯å¢ƒå…è®¸é€ æ•°æ®ã€é€ å‹åŠ›æ¨¡æ‹Ÿæˆ‘ä»¬éœ€è¦çš„åœºæ™¯ï¼Œå› æ­¤é‡åˆ°å¶å‘é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å»é€ ä¸€äº›åœºæ™¯è®©é—®é¢˜æ›´å®¹æ˜“å‡ºç°ï¼Œæ–¹ä¾¿æµ‹è¯•ã€‚</li>\n<li>å¦‚æœæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒæ’æŸ¥é—®é¢˜ï¼Œå¾€å¾€æ¯”è¾ƒéš¾ï¼šä¸€æ–¹é¢ï¼Œç”Ÿäº§ç¯å¢ƒæƒé™ç®¡æ§ä¸¥æ ¼ï¼Œä¸€èˆ¬ä¸å…è®¸è°ƒè¯•å·¥å…·ä»è¿œç¨‹é™„åŠ è¿›ç¨‹ï¼›å¦ä¸€æ–¹é¢ï¼Œç”Ÿäº§ç¯å¢ƒå‡ºç°é—®é¢˜è¦æ±‚ä»¥æ¢å¤ä¸ºå…ˆï¼Œéš¾ä»¥ç•™å‡ºå……è¶³çš„æ—¶é—´å»æ…¢æ…¢æ’æŸ¥é—®é¢˜ã€‚ä½†ï¼Œå› ä¸ºç”Ÿäº§ç¯å¢ƒçš„æµé‡çœŸå®ã€è®¿é—®é‡å¤§ã€ç½‘ç»œæƒé™ç®¡æ§ä¸¥æ ¼ã€ç¯å¢ƒå¤æ‚ï¼Œå› æ­¤æ›´å®¹æ˜“å‡ºé—®é¢˜ï¼Œä¹Ÿæ˜¯å‡ºé—®é¢˜æœ€å¤šçš„ç¯å¢ƒã€‚</li>\n</ul><!-- [[[read_end]]] --><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä¸ä½ è¯¦ç»†è¯´è¯´ï¼Œå¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒæ’æŸ¥é—®é¢˜å§ã€‚</p><h2>ç”Ÿäº§é—®é¢˜çš„æ’æŸ¥å¾ˆå¤§ç¨‹åº¦ä¾èµ–ç›‘æ§</h2><p>å…¶å®ï¼Œæ’æŸ¥é—®é¢˜å°±åƒåœ¨ç ´æ¡ˆï¼Œç”Ÿäº§ç¯å¢ƒå‡ºç°é—®é¢˜æ—¶ï¼Œå› ä¸ºè¦å°½å¿«æ¢å¤åº”ç”¨ï¼Œå°±ä¸å¯èƒ½ä¿ç•™å®Œæ•´ç°åœºç”¨äºæ’æŸ¥å’Œæµ‹è¯•ã€‚å› æ­¤ï¼Œæ˜¯å¦æœ‰å……è¶³çš„ä¿¡æ¯å¯ä»¥äº†è§£è¿‡å»ã€è¿˜åŸç°åœºå°±æˆäº†ç ´æ¡ˆçš„å…³é”®ã€‚è¿™é‡Œè¯´çš„ä¿¡æ¯ï¼Œä¸»è¦å°±æ˜¯æ—¥å¿—ã€ç›‘æ§å’Œå¿«ç…§ã€‚</p><p>æ—¥å¿—å°±ä¸ç”¨å¤šè¯´äº†ï¼Œä¸»è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ul>\n<li>ç¡®ä¿é”™è¯¯ã€å¼‚å¸¸ä¿¡æ¯å¯ä»¥è¢«å®Œæ•´åœ°è®°å½•åˆ°æ–‡ä»¶æ—¥å¿—ä¸­ï¼›</li>\n<li>ç¡®ä¿ç”Ÿäº§ä¸Šç¨‹åºçš„æ—¥å¿—çº§åˆ«æ˜¯INFOä»¥ä¸Šã€‚è®°å½•æ—¥å¿—è¦ä½¿ç”¨åˆç†çš„æ—¥å¿—ä¼˜å…ˆçº§ï¼ŒDEBUGç”¨äºå¼€å‘è°ƒè¯•ã€INFOç”¨äºé‡è¦æµç¨‹ä¿¡æ¯ã€WARNç”¨äºéœ€è¦å…³æ³¨çš„é—®é¢˜ã€ERRORç”¨äºé˜»æ–­æµç¨‹çš„é”™è¯¯ã€‚</li>\n</ul><p>å¯¹äºç›‘æ§ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæ’æŸ¥é—®é¢˜æ—¶ï¼Œé¦–å…ˆå°±éœ€è¦å¼€å‘å’Œè¿ç»´å›¢é˜Ÿåšå¥½å……è¶³çš„ç›‘æ§ï¼Œè€Œä¸”æ˜¯å¤šä¸ªå±‚æ¬¡çš„ç›‘æ§ã€‚</p><ul>\n<li>ä¸»æœºå±‚é¢ï¼Œå¯¹CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç­‰èµ„æºåšç›‘æ§ã€‚å¦‚æœåº”ç”¨éƒ¨ç½²åœ¨è™šæ‹Ÿæœºæˆ–Kubernetesé›†ç¾¤ä¸­ï¼Œé‚£ä¹ˆé™¤äº†å¯¹ç‰©ç†æœºåšåŸºç¡€èµ„æºç›‘æ§å¤–ï¼Œè¿˜è¦å¯¹è™šæ‹Ÿæœºæˆ–PodåšåŒæ ·çš„ç›‘æ§ã€‚ç›‘æ§å±‚æ•°å–å†³äºåº”ç”¨çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œæœ‰ä¸€å±‚OSå°±è¦åšä¸€å±‚ç›‘æ§ã€‚</li>\n<li>ç½‘ç»œå±‚é¢ï¼Œéœ€è¦ç›‘æ§ä¸“çº¿å¸¦å®½ã€äº¤æ¢æœºåŸºæœ¬æƒ…å†µã€ç½‘ç»œå»¶è¿Ÿã€‚</li>\n<li>æ‰€æœ‰çš„ä¸­é—´ä»¶å’Œå­˜å‚¨éƒ½è¦åšå¥½ç›‘æ§ï¼Œä¸ä»…ä»…æ˜¯ç›‘æ§è¿›ç¨‹å¯¹CPUã€å†…å­˜ã€ç£ç›˜IOã€ç½‘ç»œä½¿ç”¨çš„åŸºæœ¬æŒ‡æ ‡ï¼Œæ›´é‡è¦çš„æ˜¯ç›‘æ§ç»„ä»¶å†…éƒ¨çš„ä¸€äº›é‡è¦æŒ‡æ ‡ã€‚æ¯”å¦‚ï¼Œè‘—åçš„ç›‘æ§å·¥å…·Prometheusï¼Œå°±æä¾›äº†å¤§é‡çš„<a href=\"https://prometheus.io/docs/instrumenting/exporters/\">exporter</a>æ¥å¯¹æ¥å„ç§ä¸­é—´ä»¶å’Œå­˜å‚¨ç³»ç»Ÿã€‚</li>\n<li>åº”ç”¨å±‚é¢ï¼Œéœ€è¦ç›‘æ§JVMè¿›ç¨‹çš„ç±»åŠ è½½ã€å†…å­˜ã€GCã€çº¿ç¨‹ç­‰å¸¸è§æŒ‡æ ‡ï¼ˆæ¯”å¦‚ä½¿ç”¨<a href=\"https://micrometer.io/\">Micrometer</a>æ¥åšåº”ç”¨ç›‘æ§ï¼‰ï¼Œæ­¤å¤–è¿˜è¦ç¡®ä¿èƒ½å¤Ÿæ”¶é›†ã€ä¿å­˜åº”ç”¨æ—¥å¿—ã€GCæ—¥å¿—ã€‚</li>\n</ul><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹å¿«ç…§ã€‚è¿™é‡Œçš„â€œå¿«ç…§â€æ˜¯æŒ‡ï¼Œåº”ç”¨è¿›ç¨‹åœ¨æŸä¸€æ—¶åˆ»çš„å¿«ç…§ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä¸ºç”Ÿäº§ç¯å¢ƒçš„Javaåº”ç”¨è®¾ç½®-XX:+HeapDumpOnOutOfMemoryErrorå’Œ-XX:HeapDumpPath=â€¦è¿™2ä¸ªJVMå‚æ•°ï¼Œç”¨äºåœ¨å‡ºç°OOMæ—¶ä¿ç•™å †å¿«ç…§ã€‚è¿™ä¸ªè¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¤šæ¬¡ä½¿ç”¨MATå·¥å…·æ¥åˆ†æå †å¿«ç…§ã€‚</p><p>äº†è§£è¿‡å»ã€è¿˜åŸç°åœºåï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹çœ‹å®šä½é—®é¢˜çš„å¥—è·¯ã€‚</p><h2>åˆ†æå®šä½é—®é¢˜çš„å¥—è·¯</h2><p>å®šä½é—®é¢˜ï¼Œé¦–å…ˆè¦å®šä½é—®é¢˜å‡ºåœ¨å“ªä¸ªå±‚æ¬¡ä¸Šã€‚æ¯”å¦‚ï¼Œæ˜¯Javaåº”ç”¨ç¨‹åºè‡ªèº«çš„é—®é¢˜è¿˜æ˜¯å¤–éƒ¨å› ç´ å¯¼è‡´çš„é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å…ˆæŸ¥çœ‹ç¨‹åºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯ä¸€èˆ¬æ¯”è¾ƒå…·ä½“ï¼Œå¯ä»¥é©¬ä¸Šå®šä½åˆ°å¤§æ¦‚çš„é—®é¢˜æ–¹å‘ï¼›å¦‚æœæ˜¯ä¸€äº›èµ„æºæ¶ˆè€—å‹çš„é—®é¢˜å¯èƒ½ä¸ä¼šæœ‰å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡æ ‡ç›‘æ§é…åˆæ˜¾æ€§é—®é¢˜ç‚¹æ¥å®šä½ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç¨‹åºçš„é—®é¢˜æ¥è‡ªä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ã€‚</p><p>ç¬¬ä¸€ï¼Œç¨‹åºå‘å¸ƒåçš„Bugï¼Œå›æ»šåå¯ä»¥ç«‹å³è§£å†³ã€‚è¿™ç±»é—®é¢˜çš„æ’æŸ¥ï¼Œå¯ä»¥å›æ»šåå†æ…¢æ…¢åˆ†æç‰ˆæœ¬å·®å¼‚ã€‚</p><p>ç¬¬äºŒï¼Œå¤–éƒ¨å› ç´ ï¼Œæ¯”å¦‚ä¸»æœºã€ä¸­é—´ä»¶æˆ–æ•°æ®åº“çš„é—®é¢˜ã€‚è¿™ç±»é—®é¢˜çš„æ’æŸ¥æ–¹å¼ï¼ŒæŒ‰ç…§ä¸»æœºå±‚é¢çš„é—®é¢˜ã€ä¸­é—´ä»¶æˆ–å­˜å‚¨ï¼ˆç»Ÿç§°ç»„ä»¶ï¼‰çš„é—®é¢˜åˆ†ä¸ºä¸¤ç±»ã€‚</p><p>ä¸»æœºå±‚é¢çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ’æŸ¥ï¼š</p><ul>\n<li>CPUç›¸å…³é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨topã€vmstatã€pidstatã€psç­‰å·¥å…·æ’æŸ¥ï¼›</li>\n<li>å†…å­˜ç›¸å…³é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨freeã€topã€psã€vmstatã€cachestatã€sarç­‰å·¥å…·æ’æŸ¥ï¼›</li>\n<li>IOç›¸å…³é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨lsofã€iostatã€pidstatã€sarã€iotopã€dfã€duç­‰å·¥å…·æ’æŸ¥ï¼›</li>\n<li>ç½‘ç»œç›¸å…³é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ifconfigã€ipã€nslookupã€digã€pingã€tcpdumpã€iptablesç­‰å·¥å…·æ’æŸ¥ã€‚</li>\n</ul><p>ç»„ä»¶çš„é—®é¢˜ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ’æŸ¥ï¼š</p><ul>\n<li>æ’æŸ¥ç»„ä»¶æ‰€åœ¨ä¸»æœºæ˜¯å¦æœ‰é—®é¢˜ï¼›</li>\n<li>æ’æŸ¥ç»„ä»¶è¿›ç¨‹åŸºæœ¬æƒ…å†µï¼Œè§‚å¯Ÿå„ç§ç›‘æ§æŒ‡æ ‡ï¼›</li>\n<li>æŸ¥çœ‹ç»„ä»¶çš„æ—¥å¿—è¾“å‡ºï¼Œç‰¹åˆ«æ˜¯é”™è¯¯æ—¥å¿—ï¼›</li>\n<li>è¿›å…¥ç»„ä»¶æ§åˆ¶å°ï¼Œä½¿ç”¨ä¸€äº›å‘½ä»¤æŸ¥çœ‹å…¶è¿ä½œæƒ…å†µã€‚</li>\n</ul><p>ç¬¬ä¸‰ï¼Œå› ä¸ºç³»ç»Ÿèµ„æºä¸å¤Ÿé€ æˆç³»ç»Ÿå‡æ­»çš„é—®é¢˜ï¼Œé€šå¸¸éœ€è¦å…ˆé€šè¿‡é‡å¯å’Œæ‰©å®¹è§£å†³é—®é¢˜ï¼Œä¹‹åå†è¿›è¡Œåˆ†æï¼Œä¸è¿‡æœ€å¥½èƒ½ç•™ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºç°åœºã€‚ç³»ç»Ÿèµ„æºä¸å¤Ÿï¼Œä¸€èˆ¬ä½“ç°åœ¨CPUä½¿ç”¨é«˜ã€å†…å­˜æ³„æ¼æˆ–OOMçš„é—®é¢˜ã€IOé—®é¢˜ã€ç½‘ç»œç›¸å…³é—®é¢˜è¿™å››ä¸ªæ–¹é¢ã€‚</p><p>å¯¹äºCPUä½¿ç”¨é«˜çš„é—®é¢˜ï¼Œå¦‚æœç°åœºè¿˜åœ¨ï¼Œå…·ä½“çš„åˆ†ææµç¨‹æ˜¯ï¼š</p><ul>\n<li>é¦–å…ˆï¼Œåœ¨LinuxæœåŠ¡å™¨ä¸Šè¿è¡Œtop -Hp pidå‘½ä»¤ï¼Œæ¥æŸ¥çœ‹è¿›ç¨‹ä¸­å“ªä¸ªçº¿ç¨‹CPUä½¿ç”¨é«˜ï¼›</li>\n<li>ç„¶åï¼Œè¾“å…¥å¤§å†™çš„På°†çº¿ç¨‹æŒ‰ç…§ CPU ä½¿ç”¨ç‡æ’åºï¼Œå¹¶æŠŠæ˜æ˜¾å ç”¨CPUçš„çº¿ç¨‹IDè½¬æ¢ä¸º16è¿›åˆ¶ï¼›</li>\n<li>æœ€åï¼Œåœ¨jstackå‘½ä»¤è¾“å‡ºçš„çº¿ç¨‹æ ˆä¸­æœç´¢è¿™ä¸ªçº¿ç¨‹IDï¼Œå®šä½å‡ºé—®é¢˜çš„çº¿ç¨‹å½“æ—¶çš„è°ƒç”¨æ ˆã€‚</li>\n</ul><p>å¦‚æœæ²¡æœ‰æ¡ä»¶ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œtopå‘½ä»¤çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨é‡‡æ ·çš„æ–¹å¼å®šä½é—®é¢˜ï¼šé—´éš”å›ºå®šç§’æ•°ï¼ˆæ¯”å¦‚10ç§’ï¼‰è¿è¡Œä¸€æ¬¡jstackå‘½ä»¤ï¼Œé‡‡æ ·å‡ æ¬¡åï¼Œå¯¹æ¯”é‡‡æ ·å¾—å‡ºå“ªäº›çº¿ç¨‹å§‹ç»ˆå¤„äºè¿è¡ŒçŠ¶æ€ï¼Œåˆ†æå‡ºé—®é¢˜çš„çº¿ç¨‹ã€‚</p><p>å¦‚æœç°åœºæ²¡æœ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ’é™¤æ³•æ¥åˆ†æã€‚CPUä½¿ç”¨é«˜ï¼Œä¸€èˆ¬æ˜¯ç”±ä¸‹é¢çš„å› ç´ å¼•èµ·çš„ï¼š</p><ul>\n<li>çªå‘å‹åŠ›ã€‚è¿™ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åº”ç”¨ä¹‹å‰çš„è´Ÿè½½å‡è¡¡çš„æµé‡æˆ–æ—¥å¿—é‡æ¥ç¡®è®¤ï¼Œè¯¸å¦‚Nginxç­‰åå‘ä»£ç†éƒ½ä¼šè®°å½•URLï¼Œå¯ä»¥ä¾é ä»£ç†çš„Access Logè¿›è¡Œç»†åŒ–å®šä½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç›‘æ§è§‚å¯ŸJVMçº¿ç¨‹æ•°çš„æƒ…å†µã€‚å‹åŠ›é—®é¢˜å¯¼è‡´CPUä½¿ç”¨é«˜çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºçš„å„èµ„æºä½¿ç”¨æ²¡æœ‰æ˜æ˜¾ä¸æ­£å¸¸ï¼Œä¹‹åå¯ä»¥é€šè¿‡å‹æµ‹+Profilerï¼ˆjvisualvmå°±æœ‰è¿™ä¸ªåŠŸèƒ½ï¼‰è¿›ä¸€æ­¥å®šä½çƒ­ç‚¹æ–¹æ³•ï¼›å¦‚æœèµ„æºä½¿ç”¨ä¸æ­£å¸¸ï¼Œæ¯”å¦‚äº§ç”Ÿäº†å‡ åƒä¸ªçº¿ç¨‹ï¼Œå°±éœ€è¦è€ƒè™‘è°ƒå‚ã€‚</li>\n<li>GCã€‚è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡JVMç›‘æ§GCç›¸å…³æŒ‡æ ‡ã€GC Logè¿›è¡Œç¡®è®¤ã€‚å¦‚æœç¡®è®¤æ˜¯GCçš„å‹åŠ›ï¼Œé‚£ä¹ˆå†…å­˜ä½¿ç”¨ä¹Ÿå¾ˆå¯èƒ½ä¼šä¸æ­£å¸¸ï¼Œéœ€è¦æŒ‰ç…§å†…å­˜é—®é¢˜åˆ†ææµç¨‹åšè¿›ä¸€æ­¥åˆ†æã€‚</li>\n<li>ç¨‹åºä¸­æ­»å¾ªç¯é€»è¾‘æˆ–ä¸æ­£å¸¸çš„å¤„ç†æµç¨‹ã€‚è¿™ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆåº”ç”¨æ—¥å¿—åˆ†æã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½ä¼šäº§ç”Ÿä¸€äº›æ—¥å¿—ï¼Œå¯ä»¥é‡ç‚¹å…³æ³¨æ—¥å¿—é‡å¼‚å¸¸éƒ¨åˆ†ã€‚</li>\n</ul><p>å¯¹äºå†…å­˜æ³„éœ²æˆ–OOMçš„é—®é¢˜ï¼Œæœ€ç®€å•çš„åˆ†ææ–¹å¼ï¼Œå°±æ˜¯å †è½¬å‚¨åä½¿ç”¨MATåˆ†æã€‚å †è½¬å‚¨ï¼ŒåŒ…å«äº†å †ç°åœºå…¨è²Œå’Œçº¿ç¨‹æ ˆä¿¡æ¯ï¼Œä¸€èˆ¬è§‚å¯Ÿæ”¯é…æ ‘å›¾ã€ç›´æ–¹å›¾å°±å¯ä»¥é©¬ä¸Šçœ‹åˆ°å ç”¨å¤§é‡å†…å­˜çš„å¯¹è±¡ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°å†…å­˜ç›¸å…³é—®é¢˜ã€‚è¿™ä¸€ç‚¹æˆ‘ä»¬ä¼šåœ¨<a href=\"https://time.geekbang.org/column/article/230534\">ç¬¬5ç¯‡åŠ é¤</a>ä¸­è¯¦ç»†ä»‹ç»ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJavaè¿›ç¨‹å¯¹å†…å­˜çš„ä½¿ç”¨ä¸ä»…ä»…æ˜¯å †åŒºï¼Œè¿˜åŒ…æ‹¬çº¿ç¨‹ä½¿ç”¨çš„å†…å­˜ï¼ˆçº¿ç¨‹ä¸ªæ•°*æ¯ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ ˆï¼‰å’Œå…ƒæ•°æ®åŒºã€‚æ¯ä¸€ä¸ªå†…å­˜åŒºéƒ½å¯èƒ½äº§ç”ŸOOMï¼Œå¯ä»¥ç»“åˆç›‘æ§è§‚å¯Ÿçº¿ç¨‹æ•°ã€å·²åŠ è½½ç±»æ•°é‡ç­‰æŒ‡æ ‡åˆ†æã€‚å¦å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çœ‹ä¸€ä¸‹ï¼ŒJVMå‚æ•°çš„è®¾ç½®æ˜¯å¦æœ‰æ˜æ˜¾ä¸åˆç†çš„åœ°æ–¹ï¼Œé™åˆ¶äº†èµ„æºä½¿ç”¨ã€‚</p><p>IOç›¸å…³çš„é—®é¢˜ï¼Œé™¤éæ˜¯ä»£ç é—®é¢˜å¼•èµ·çš„èµ„æºä¸é‡Šæ”¾ç­‰é—®é¢˜ï¼Œå¦åˆ™é€šå¸¸éƒ½ä¸æ˜¯ç”±Javaè¿›ç¨‹å†…éƒ¨å› ç´ å¼•å‘çš„ã€‚</p><p>ç½‘ç»œç›¸å…³çš„é—®é¢˜ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ç”±å¤–éƒ¨å› ç´ å¼•èµ·çš„ã€‚å¯¹äºè¿é€šæ€§é—®é¢˜ï¼Œç»“åˆå¼‚å¸¸ä¿¡æ¯é€šå¸¸æ¯”è¾ƒå®¹æ˜“å®šä½ï¼›å¯¹äºæ€§èƒ½æˆ–ç¬æ–­é—®é¢˜ï¼Œå¯ä»¥å…ˆå°è¯•ä½¿ç”¨pingç­‰å·¥å…·ç®€å•åˆ¤æ–­ï¼Œå¦‚æœä¸è¡Œå†ä½¿ç”¨tcpdumpæˆ–Wiresharkæ¥åˆ†æã€‚</p><h2>åˆ†æå’Œå®šä½é—®é¢˜éœ€è¦æ³¨æ„çš„ä¹ä¸ªç‚¹</h2><p>æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬åˆ†æå’Œå®šä½é—®é¢˜æ—¶ï¼Œä¼šé™·å…¥è¯¯åŒºæˆ–æ˜¯æ‰¾ä¸åˆ°æ–¹å‘ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥å€Ÿé‰´ä¸‹æˆ‘çš„ä¹ä¸ªå¿ƒå¾—ã€‚</p><p><strong>ç¬¬ä¸€ï¼Œè€ƒè™‘â€œé¸¡â€å’Œâ€œè›‹â€çš„é—®é¢˜ã€‚</strong>æ¯”å¦‚ï¼Œå‘ç°ä¸šåŠ¡é€»è¾‘æ‰§è¡Œå¾ˆæ…¢ä¸”çº¿ç¨‹æ•°å¢å¤šçš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤ç§å¯èƒ½æ€§ï¼š</p><ul>\n<li>ä¸€æ˜¯ï¼Œç¨‹åºé€»è¾‘æœ‰é—®é¢˜æˆ–å¤–éƒ¨ä¾èµ–æ…¢ï¼Œä½¿å¾—ä¸šåŠ¡é€»è¾‘æ‰§è¡Œæ…¢ï¼Œåœ¨è®¿é—®é‡ä¸å˜çš„æƒ…å†µä¸‹éœ€è¦æ›´å¤šçš„çº¿ç¨‹æ•°æ¥åº”å¯¹ã€‚æ¯”å¦‚ï¼Œ10TPSçš„å¹¶å‘åŸå…ˆä¸€æ¬¡è¯·æ±‚1så¯ä»¥æ‰§è¡Œå®Œæˆï¼Œ10ä¸ªçº¿ç¨‹å¯ä»¥æ”¯æ’‘ï¼›ç°åœ¨æ‰§è¡Œå®Œæˆéœ€è¦10sï¼Œé‚£å°±éœ€è¦100ä¸ªçº¿ç¨‹ã€‚</li>\n<li>äºŒæ˜¯ï¼Œæœ‰å¯èƒ½æ˜¯è¯·æ±‚é‡å¢å¤§äº†ï¼Œä½¿å¾—çº¿ç¨‹æ•°å¢å¤šï¼Œåº”ç”¨æœ¬èº«çš„CPUèµ„æºä¸è¶³ï¼Œå†åŠ ä¸Šä¸Šä¸‹æ–‡åˆ‡æ¢é—®é¢˜å¯¼è‡´å¤„ç†å˜æ…¢äº†ã€‚</li>\n</ul><p>å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆå†…éƒ¨è¡¨ç°å’Œå…¥å£æµé‡ä¸€èµ·çœ‹ï¼Œç¡®è®¤è¿™é‡Œçš„â€œæ…¢â€åˆ°åº•æ˜¯æ ¹å› è¿˜æ˜¯ç»“æœã€‚</p><p><strong>ç¬¬äºŒï¼Œè€ƒè™‘é€šè¿‡åˆ†ç±»å¯»æ‰¾è§„å¾‹ã€‚</strong>åœ¨å®šä½é—®é¢˜æ²¡æœ‰å¤´ç»ªçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ€»ç»“è§„å¾‹ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰10å°åº”ç”¨æœåŠ¡å™¨åšè´Ÿè½½å‡è¡¡ï¼Œå‡ºé—®é¢˜æ—¶å¯ä»¥é€šè¿‡æ—¥å¿—åˆ†ææ˜¯å¦æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œè¿˜æ˜¯é—®é¢˜éƒ½å‡ºç°åœ¨1å°æœºå™¨ã€‚åˆæ¯”å¦‚ï¼Œåº”ç”¨æ—¥å¿—ä¸€èˆ¬ä¼šè®°å½•çº¿ç¨‹åç§°ï¼Œå‡ºé—®é¢˜æ—¶æˆ‘ä»¬å¯ä»¥åˆ†ææ—¥å¿—æ˜¯å¦é›†ä¸­åœ¨æŸä¸€ç±»çº¿ç¨‹ä¸Šã€‚å†æ¯”å¦‚ï¼Œå¦‚æœå‘ç°åº”ç”¨å¼€å¯äº†å¤§é‡TCPè¿æ¥ï¼Œé€šè¿‡netstatæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºä¸»è¦é›†ä¸­è¿æ¥åˆ°å“ªä¸ªæœåŠ¡ã€‚</p><p>å¦‚æœèƒ½æ€»ç»“å‡ºè§„å¾‹ï¼Œå¾ˆå¯èƒ½å°±æ‰¾åˆ°äº†çªç ´ç‚¹ã€‚</p><p><strong>ç¬¬ä¸‰ï¼Œåˆ†æé—®é¢˜éœ€è¦æ ¹æ®è°ƒç”¨æ‹“æ‰‘æ¥ï¼Œä¸èƒ½æƒ³å½“ç„¶ã€‚</strong>æ¯”å¦‚ï¼Œæˆ‘ä»¬çœ‹åˆ°Nginxè¿”å›502é”™è¯¯ï¼Œä¸€èˆ¬å¯ä»¥è®¤ä¸ºæ˜¯ä¸‹æ¸¸æœåŠ¡çš„é—®é¢˜å¯¼è‡´ç½‘å…³æ— æ³•å®Œæˆè¯·æ±‚è½¬å‘ã€‚å¯¹äºä¸‹æ¸¸æœåŠ¡ï¼Œä¸èƒ½æƒ³å½“ç„¶å°±è®¤ä¸ºæ˜¯æˆ‘ä»¬çš„Javaç¨‹åºï¼Œæ¯”å¦‚åœ¨æ‹“æ‰‘ä¸Šå¯èƒ½Nginxä»£ç†çš„æ˜¯Kubernetesçš„Traefik Ingressï¼Œé“¾è·¯æ˜¯Nginx-&gt;Traefik-&gt;åº”ç”¨ï¼Œå¦‚æœä¸€å‘³æ’æŸ¥Javaç¨‹åºçš„å¥åº·æƒ…å†µï¼Œé‚£ä¹ˆå§‹ç»ˆä¸ä¼šæ‰¾åˆ°æ ¹å› ã€‚</p><p>åˆæ¯”å¦‚ï¼Œæˆ‘ä»¬è™½ç„¶ä½¿ç”¨äº†Spring Cloud Feignæ¥è¿›è¡ŒæœåŠ¡è°ƒç”¨ï¼Œå‡ºç°è¿æ¥è¶…æ—¶ä¹Ÿä¸ä¸€å®šå°±æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ï¼Œæœ‰å¯èƒ½æ˜¯å®¢æˆ·ç«¯é€šè¿‡URLæ¥è°ƒç”¨æœåŠ¡ç«¯ï¼Œå¹¶ä¸æ˜¯é€šè¿‡Eurekaçš„æœåŠ¡å‘ç°å®ç°çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚æ¢å¥è¯è¯´ï¼Œå®¢æˆ·ç«¯è¿æ¥çš„æ˜¯Nginxä»£ç†è€Œä¸æ˜¯ç›´æ¥è¿æ¥åº”ç”¨ï¼Œå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å‡ºç°çš„è¶…æ—¶ï¼Œå…¶å®æ˜¯Nginxä»£ç†å®•æœºæ‰€è‡´ã€‚</p><p><strong>ç¬¬å››ï¼Œè€ƒè™‘èµ„æºé™åˆ¶ç±»é—®é¢˜ã€‚</strong>è§‚å¯Ÿå„ç§æ›²çº¿æŒ‡æ ‡ï¼Œå¦‚æœå‘ç°æ›²çº¿æ…¢æ…¢ä¸Šå‡ç„¶åç¨³å®šåœ¨ä¸€ä¸ªæ°´å¹³çº¿ä¸Šï¼Œé‚£ä¹ˆä¸€èˆ¬å°±æ˜¯èµ„æºè¾¾åˆ°äº†é™åˆ¶æˆ–ç“¶é¢ˆã€‚</p><p>æ¯”å¦‚ï¼Œåœ¨è§‚å¯Ÿç½‘ç»œå¸¦å®½æ›²çº¿çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å¸¦å®½ä¸Šå‡åˆ°120MBå·¦å³ä¸åŠ¨äº†ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½å°±æ˜¯æ‰“æ»¡äº†1GBçš„ç½‘å¡æˆ–ä¼ è¾“å¸¦å®½ã€‚åˆæ¯”å¦‚ï¼Œè§‚å¯Ÿåˆ°æ•°æ®åº“æ´»è·ƒè¿æ¥æ•°ä¸Šå‡åˆ°10ä¸ªå°±ä¸åŠ¨äº†ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯è¿æ¥æ± æ‰“æ»¡äº†ã€‚è§‚å¯Ÿç›‘æ§ä¸€æ—¦çœ‹åˆ°ä»»ä½•è¿™æ ·çš„æ›²çº¿ï¼Œéƒ½è¦å¼•èµ·é‡è§†ã€‚</p><p><strong>ç¬¬äº”ï¼Œè€ƒè™‘èµ„æºç›¸äº’å½±å“ã€‚</strong>CPUã€å†…å­˜ã€IOå’Œç½‘ç»œï¼Œè¿™å››ç±»èµ„æºå°±åƒäººçš„äº”è„å…­è…‘ï¼Œæ˜¯ç›¸è¾…ç›¸æˆçš„ï¼Œä¸€ä¸ªèµ„æºå‡ºç°äº†æ˜æ˜¾çš„ç“¶é¢ˆï¼Œå¾ˆå¯èƒ½ä¼šå¼•èµ·å…¶ä»–èµ„æºçš„è¿é”ååº”ã€‚</p><p>æ¯”å¦‚ï¼Œå†…å­˜æ³„éœ²åå¯¹è±¡æ— æ³•å›æ”¶ä¼šé€ æˆå¤§é‡Full GCï¼Œæ­¤æ—¶CPUä¼šå¤§é‡æ¶ˆè€—åœ¨GCä¸Šä»è€Œå¼•èµ·CPUä½¿ç”¨å¢åŠ ã€‚åˆæ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæŠŠæ•°æ®ç¼“å­˜åœ¨å†…å­˜é˜Ÿåˆ—ä¸­è¿›è¡Œå¼‚æ­¥IOå¤„ç†ï¼Œç½‘ç»œæˆ–ç£ç›˜å‡ºç°é—®é¢˜æ—¶ï¼Œå°±å¾ˆå¯èƒ½ä¼šå¼•èµ·å†…å­˜çš„æš´æ¶¨ã€‚å› æ­¤ï¼Œå‡ºé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥é¿å…è¯¯åˆ¤ã€‚</p><p><strong>ç¬¬å…­ï¼Œæ’æŸ¥ç½‘ç»œé—®é¢˜è¦è€ƒè™‘ä¸‰ä¸ªæ–¹é¢ï¼Œåˆ°åº•æ˜¯å®¢æˆ·ç«¯é—®é¢˜ï¼Œè¿˜æ˜¯æœåŠ¡ç«¯é—®é¢˜ï¼Œè¿˜æ˜¯ä¼ è¾“é—®é¢˜ã€‚</strong>æ¯”å¦‚ï¼Œå‡ºç°æ•°æ®åº“è®¿é—®æ…¢çš„ç°è±¡ï¼Œå¯èƒ½æ˜¯å®¢æˆ·ç«¯çš„åŸå› ï¼Œè¿æ¥æ± ä¸å¤Ÿå¯¼è‡´è¿æ¥è·å–æ…¢ã€GCåœé¡¿ã€CPUå æ»¡ç­‰ï¼›ä¹Ÿå¯èƒ½æ˜¯ä¼ è¾“ç¯èŠ‚çš„é—®é¢˜ï¼ŒåŒ…æ‹¬å…‰çº¤ã€é˜²ç«å¢™ã€è·¯ç”±è¡¨è®¾ç½®ç­‰é—®é¢˜ï¼›ä¹Ÿå¯èƒ½æ˜¯çœŸæ­£çš„æœåŠ¡ç«¯é—®é¢˜ï¼Œéœ€è¦é€ä¸€æ’æŸ¥æ¥è¿›è¡ŒåŒºåˆ†ã€‚</p><p>æœåŠ¡ç«¯æ…¢ä¸€èˆ¬å¯ä»¥çœ‹åˆ°MySQLå‡ºæ…¢æ—¥å¿—ï¼Œä¼ è¾“æ…¢ä¸€èˆ¬å¯ä»¥é€šè¿‡pingæ¥ç®€å•å®šä½ï¼Œæ’é™¤äº†è¿™ä¸¤ä¸ªå¯èƒ½ï¼Œå¹¶ä¸”ä»…ä»…æ˜¯éƒ¨åˆ†å®¢æˆ·ç«¯å‡ºç°è®¿é—®æ…¢çš„æƒ…å†µï¼Œå°±éœ€è¦æ€€ç–‘æ˜¯å®¢æˆ·ç«¯æœ¬èº«çš„é—®é¢˜ã€‚å¯¹äºç¬¬ä¸‰æ–¹ç³»ç»Ÿã€æœåŠ¡æˆ–å­˜å‚¨è®¿é—®å‡ºç°æ…¢çš„æƒ…å†µï¼Œä¸èƒ½å®Œå…¨å‡è®¾æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚</p><p><strong>ç¬¬ä¸ƒï¼Œå¿«ç…§ç±»å·¥å…·å’Œè¶‹åŠ¿ç±»å·¥å…·éœ€è¦ç»“åˆä½¿ç”¨ã€‚</strong>æ¯”å¦‚ï¼Œjstatã€topã€å„ç§ç›‘æ§æ›²çº¿æ˜¯è¶‹åŠ¿ç±»å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬è§‚å¯Ÿå„ä¸ªæŒ‡æ ‡çš„å˜åŒ–æƒ…å†µï¼Œå®šä½å¤§æ¦‚çš„é—®é¢˜ç‚¹ï¼›è€Œjstackå’Œåˆ†æå †å¿«ç…§çš„MATæ˜¯å¿«ç…§ç±»å·¥å…·ï¼Œç”¨äºè¯¦ç»†åˆ†ææŸä¸€æ—¶åˆ»åº”ç”¨ç¨‹åºæŸä¸€ä¸ªç‚¹çš„ç»†èŠ‚ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå…ˆä½¿ç”¨è¶‹åŠ¿ç±»å·¥å…·æ¥æ€»ç»“è§„å¾‹ï¼Œå†ä½¿ç”¨å¿«ç…§ç±»å·¥å…·æ¥åˆ†æé—®é¢˜ã€‚å¦‚æœåè¿‡æ¥å¯èƒ½å°±ä¼šè¯¯åˆ¤ï¼Œå› ä¸ºå¿«ç…§ç±»å·¥å…·åæ˜ çš„åªæ˜¯ä¸€ä¸ªç¬é—´ç¨‹åºçš„æƒ…å†µï¼Œä¸èƒ½ä»…ä»…é€šè¿‡åˆ†æå•ä¸€å¿«ç…§å¾—å‡ºç»“è®ºï¼Œå¦‚æœç¼ºå°‘è¶‹åŠ¿ç±»å·¥å…·çš„å¸®åŠ©ï¼Œé‚£è‡³å°‘ä¹Ÿè¦æå–å¤šä¸ªå¿«ç…§æ¥å¯¹æ¯”ã€‚</p><p><strong>ç¬¬å…«ï¼Œä¸è¦è½»æ˜“æ€€ç–‘ç›‘æ§ã€‚</strong>æˆ‘æ›¾çœ‹è¿‡ä¸€ä¸ªç©ºéš¾äº‹æ•…çš„åˆ†æï¼Œé£è¡Œå‘˜åœ¨ç©ºä¸­å‘ç°ä»ªè¡¨æ˜¾ç¤ºé£æœºæ‰€æœ‰æ²¹ç®±éƒ½å¤„äºç¼ºæ²¹çš„çŠ¶æ€ï¼Œä»–ç¬¬ä¸€æ—¶é—´çš„æ€€ç–‘æ˜¯æ²¹è¡¨å‡ºç°æ•…éšœäº†ï¼Œå§‹ç»ˆä¸æ„¿æ„ç›¸ä¿¡æ˜¯çœŸçš„ç¼ºæ²¹ï¼Œç»“æœé£è¡Œä¸ä¹…åå¼•æ“å°±æ–­æ²¹ç†„ç«äº†ã€‚åŒæ ·åœ°ï¼Œåœ¨åº”ç”¨å‡ºç°é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ä¼šæŸ¥çœ‹å„ç§ç›‘æ§ç³»ç»Ÿï¼Œä½†æœ‰äº›æ—¶å€™æˆ‘ä»¬å®æ„¿ç›¸ä¿¡è‡ªå·±çš„ç»éªŒï¼Œä¹Ÿä¸ç›¸ä¿¡ç›‘æ§å›¾è¡¨çš„æ˜¾ç¤ºã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬å®Œå…¨æœç€é”™è¯¯çš„æ–¹å‘æ¥æ’æŸ¥é—®é¢˜ã€‚</p><p>å¦‚æœä½ çœŸçš„æ€€ç–‘æ˜¯ç›‘æ§ç³»ç»Ÿæœ‰é—®é¢˜ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™å¥—ç›‘æ§ç³»ç»Ÿå¯¹äºä¸å‡ºé—®é¢˜çš„åº”ç”¨æ˜¾ç¤ºæ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœæ­£å¸¸é‚£å°±åº”è¯¥ç›¸ä¿¡ç›‘æ§è€Œä¸æ˜¯è‡ªå·±çš„ç»éªŒã€‚</p><p><strong>ç¬¬ä¹ï¼Œå¦‚æœå› ä¸ºç›‘æ§ç¼ºå¤±ç­‰åŸå› æ— æ³•å®šä½åˆ°æ ¹å› çš„è¯ï¼Œç›¸åŒé—®é¢˜å°±æœ‰å†å‡ºç°çš„é£é™©</strong>ï¼Œéœ€è¦åšå¥½ä¸‰é¡¹å·¥ä½œï¼š</p><ul>\n<li>åšå¥½æ—¥å¿—ã€ç›‘æ§å’Œå¿«ç…§è¡¥æ¼å·¥ä½œï¼Œä¸‹æ¬¡é‡åˆ°é—®é¢˜æ—¶å¯ä»¥å®šä½æ ¹å› ï¼›</li>\n<li>é’ˆå¯¹é—®é¢˜çš„ç—‡çŠ¶åšå¥½å®æ—¶æŠ¥è­¦ï¼Œç¡®ä¿å‡ºç°é—®é¢˜åå¯ä»¥ç¬¬ä¸€æ—¶é—´å‘ç°ï¼›</li>\n<li>è€ƒè™‘åšä¸€å¥—çƒ­å¤‡çš„æ–¹æ¡ˆï¼Œå‡ºç°é—®é¢˜åå¯ä»¥ç¬¬ä¸€æ—¶é—´åˆ‡æ¢åˆ°çƒ­å¤‡ç³»ç»Ÿå¿«é€Ÿè§£å†³é—®é¢˜ï¼ŒåŒæ—¶åˆå¯ä»¥ä¿ç•™è€ç³»ç»Ÿçš„ç°åœºã€‚</li>\n</ul><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ æ€»ç»“åˆ†äº«äº†åˆ†æç”Ÿäº§ç¯å¢ƒé—®é¢˜çš„å¥—è·¯ã€‚</p><p>ç¬¬ä¸€ï¼Œåˆ†æé—®é¢˜ä¸€å®šæ˜¯éœ€è¦ä¾æ®çš„ï¼Œé çŒœæ˜¯çŒœä¸å‡ºæ¥çš„ï¼Œéœ€è¦æå‰åšå¥½åŸºç¡€ç›‘æ§çš„å»ºè®¾ã€‚ç›‘æ§çš„è¯ï¼Œéœ€è¦åœ¨åŸºç¡€è¿ç»´å±‚ã€åº”ç”¨å±‚ã€ä¸šåŠ¡å±‚ç­‰å¤šä¸ªå±‚æ¬¡è¿›è¡Œã€‚å®šä½é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦å‚ç…§å¤šä¸ªç›‘æ§å±‚çš„æŒ‡æ ‡è¡¨ç°ç»¼åˆåˆ†æã€‚</p><p>ç¬¬äºŒï¼Œå®šä½é—®é¢˜è¦å…ˆå¯¹åŸå› è¿›è¡Œå¤§è‡´åˆ†ç±»ï¼Œæ¯”å¦‚æ˜¯å†…éƒ¨é—®é¢˜è¿˜æ˜¯å¤–éƒ¨é—®é¢˜ã€CPUç›¸å…³é—®é¢˜è¿˜æ˜¯å†…å­˜ç›¸å…³é—®é¢˜ã€ä»…ä»…æ˜¯Aæ¥å£çš„é—®é¢˜è¿˜æ˜¯æ•´ä¸ªåº”ç”¨çš„é—®é¢˜ï¼Œç„¶åå†å»è¿›ä¸€æ­¥ç»†åŒ–æ¢ç´¢ï¼Œä¸€å®šæ˜¯ä»å¤§åˆ°å°æ¥æ€è€ƒé—®é¢˜ï¼›åœ¨è¿½æŸ¥é—®é¢˜é‡åˆ°ç“¶é¢ˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé€€å‡ºç»†èŠ‚ï¼Œå†ä»å¤§çš„æ–¹é¢æ‹ä¸€ä¸‹æ¶‰åŠçš„ç‚¹ï¼Œå†é‡æ–°æ¥çœ‹é—®é¢˜ã€‚</p><p>ç¬¬ä¸‰ï¼Œåˆ†æé—®é¢˜å¾ˆå¤šæ—¶å€™é çš„æ˜¯ç»éªŒï¼Œå¾ˆéš¾æ‰¾åˆ°å®Œæ•´çš„æ–¹æ³•è®ºã€‚é‡åˆ°é‡å¤§é—®é¢˜çš„æ—¶å€™ï¼Œå¾€å¾€ä¹Ÿéœ€è¦æ ¹æ®ç›´è§‰æ¥ç¬¬ä¸€æ—¶é—´æ‰¾åˆ°æœ€æœ‰å¯èƒ½çš„ç‚¹ï¼Œè¿™é‡Œç”šè‡³æœ‰è¿æ°”æˆåˆ†ã€‚æˆ‘è¿˜å’Œä½ åˆ†äº«äº†æˆ‘çš„ä¹æ¡ç»éªŒï¼Œå»ºè®®ä½ åœ¨å¹³æ—¶è§£å†³é—®é¢˜çš„æ—¶å€™å¤šæ€è€ƒã€å¤šæ€»ç»“ï¼Œæç‚¼å‡ºæ›´å¤šè‡ªå·±åˆ†æé—®é¢˜çš„å¥—è·¯å’Œæ‹¿æ‰‹å·¥å…·ã€‚</p><p>æœ€åï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®šä½åˆ°é—®é¢˜åŸå› åï¼Œæˆ‘ä»¬è¦åšå¥½è®°å½•å’Œå¤ç›˜ã€‚æ¯ä¸€æ¬¡æ•…éšœå’Œé—®é¢˜éƒ½æ˜¯å®è´µçš„èµ„æºï¼Œå¤ç›˜ä¸ä»…ä»…æ˜¯è®°å½•é—®é¢˜ï¼Œæ›´é‡è¦çš„æ˜¯æ”¹è¿›ã€‚å¤ç›˜æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšåˆ°ä»¥ä¸‹å››ç‚¹ï¼š</p><ul>\n<li>è®°å½•å®Œæ•´çš„æ—¶é—´çº¿ã€å¤„ç†æªæ–½ã€ä¸ŠæŠ¥æµç¨‹ç­‰ä¿¡æ¯ï¼›</li>\n<li>åˆ†æé—®é¢˜çš„æ ¹æœ¬åŸå› ï¼›</li>\n<li>ç»™å‡ºçŸ­ã€ä¸­ã€é•¿æœŸæ”¹è¿›æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»£ç æ”¹åŠ¨ã€SOPã€æµç¨‹ï¼Œå¹¶è®°å½•è·Ÿè¸ªæ¯ä¸€ä¸ªæ–¹æ¡ˆè¿›è¡Œé—­ç¯ï¼›</li>\n<li>å®šæœŸç»„ç»‡å›¢é˜Ÿå›é¡¾è¿‡å»çš„æ•…éšœã€‚</li>\n</ul><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>å¦‚æœä½ ç°åœ¨æ‰“å¼€ä¸€ä¸ªAppåå‘ç°é¦–é¡µå±•ç¤ºäº†ä¸€ç‰‡ç©ºç™½ï¼Œé‚£è¿™åˆ°åº•æ˜¯å®¢æˆ·ç«¯å…¼å®¹æ€§çš„é—®é¢˜ï¼Œè¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜å‘¢ï¼Ÿå¦‚æœæ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ï¼Œåˆå¦‚ä½•è¿›ä¸€æ­¥ç»†åŒ–å®šä½å‘¢ï¼Ÿä½ æœ‰ä»€ä¹ˆåˆ†ææ€è·¯å—ï¼Ÿ</li>\n<li>å¯¹äºåˆ†æå®šä½é—®é¢˜ï¼Œä½ ä¼šåšå“ªäº›ç›‘æ§æˆ–æ˜¯ä½¿ç”¨å“ªäº›å·¥å…·å‘¢ï¼Ÿ</li>\n</ol><p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡ä»€ä¹ˆèŠ±äº†å¾ˆé•¿æ—¶é—´æ‰å®šä½åˆ°çš„ï¼Œæˆ–æ˜¯è®©ä½ å°è±¡æ·±åˆ»çš„é—®é¢˜æˆ–äº‹æ•…å‘¢ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","neighbors":{"left":{"article_title":"32 | åŠ é¤2ï¼šå¸¦ä½ åƒé€è¯¾ç¨‹ä¸­Java 8çš„é‚£äº›é‡è¦çŸ¥è¯†ç‚¹ï¼ˆäºŒï¼‰","id":212398},"right":{"article_title":"34 | åŠ é¤4ï¼šåˆ†æå®šä½Javaé—®é¢˜ï¼Œä¸€å®šè¦ç”¨å¥½è¿™äº›å·¥å…·ï¼ˆä¸€ï¼‰","id":224816}},"comments":[{"had_liked":false,"id":204387,"user_name":"hellojd","can_delete":false,"product_type":"c1","uid":1341697,"ip_address":"","ucode":"4E51807AE7E472","user_header":"https://static001.geekbang.org/account/avatar/00/14/79/01/e71510dc.jpg","comment_is_top":true,"comment_ctime":1586394614,"is_pvip":false,"replies":[{"id":"76425","content":"1ã€éœ€è¦æ˜ç™½ï¼Œxmxè®¾ç½®çš„å †åªæ˜¯javaè¿›ç¨‹ä½¿ç”¨å†…å­˜çš„ä¸€éƒ¨åˆ† https:&#47;&#47;stackoverflow.com&#47;questions&#47;53451103&#47;java-using-much-more-memory-than-heap-size-or-size-correctly-docker-memory-limi<br><br>æ‰€ä»¥ä½ éœ€è¦é€šè¿‡ç›‘æ§æ’æŸ¥åˆ°åº•å“ªéƒ¨åˆ†å†…å­˜è¶…é™ï¼Œä½†æ˜¯heapçš„oom dumpè‚¯å®šæ˜¯éœ€è¦åšçš„ï¼Œå¹¶ä¸”é…ç½®-XX:NativeMemoryTracking=detail -XX:+UnlockDiagnosticVMOptions -XX:+PrintNMTStatisticsï¼Œéœ€è¦çš„æ—¶å€™å¯ä»¥é€šè¿‡jcmd &lt;pid&gt; VM.native_memory summary&#47;detailæ’æŸ¥<br><br>2ã€åœ¨æ’æŸ¥æ¸…é—®é¢˜ä¹‹å‰å¯ä»¥é€‚å½“æ”¾å¼€k8sçš„limitï¼Œä»¥ä¾¿ä½ å¯ä»¥è§‚å¯Ÿåˆ°å†…å­˜å¢é•¿çš„åŒºåŸŸï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜<br><br>3ã€å¯ä»¥å’Œè¿ç»´æ²Ÿé€šä¸€ä¸‹ï¼Œåœ¨oom killedçš„æ—¶å€™ï¼ˆoom killedåº”è¯¥ä¼šè®©podçŠ¶æ€å˜ä¸ºunhealthï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è§¦å‘hookï¼‰èƒ½å¦åšä¸€ä¸‹heapdumpã€jstackç­‰ï¼Œæ•°æ®ä¸è¦ä¿å­˜åœ¨å®¹å™¨é‡Œ<br><br>å½“ç„¶ï¼ŒåƒDarrençš„å›å¤ï¼Œåœ¨æ­»ä¹‹å‰åšå‡ æ¬¡dumpä¹Ÿæ˜¯å¯ä»¥çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586401795,"ip_address":"","comment_id":204387,"utype":1}],"discussion_count":3,"race_medal":0,"score":"9.223372089980801e+18","product_id":100047701,"comment_content":"æˆ‘ä»¬çº¿ä¸Šk8sç®¡ç†æœåŠ¡ï¼Œæœ‰æ—¶å€™oomï¼ŒæœåŠ¡é‡å¯ç”±k8sè§¦å‘çš„ï¼Œè¿™å°†å¯¼è‡´è®¾ç½®çš„ç”Ÿæˆdump æ–‡ä»¶æ— æ•ˆã€‚æœ‰å¥½çš„æ€è·¯å—ï¼Ÿ","like_count":13,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491161,"discussion_content":"1ã€éœ€è¦æ˜ç™½ï¼Œxmxè®¾ç½®çš„å †åªæ˜¯javaè¿›ç¨‹ä½¿ç”¨å†…å­˜çš„ä¸€éƒ¨åˆ† https://stackoverflow.com/questions/53451103/java-using-much-more-memory-than-heap-size-or-size-correctly-docker-memory-limi\n\næ‰€ä»¥ä½ éœ€è¦é€šè¿‡ç›‘æ§æ’æŸ¥åˆ°åº•å“ªéƒ¨åˆ†å†…å­˜è¶…é™ï¼Œä½†æ˜¯heapçš„oom dumpè‚¯å®šæ˜¯éœ€è¦åšçš„ï¼Œå¹¶ä¸”é…ç½®-XX:NativeMemoryTracking=detail -XX:+UnlockDiagnosticVMOptions -XX:+PrintNMTStatisticsï¼Œéœ€è¦çš„æ—¶å€™å¯ä»¥é€šè¿‡jcmd &amp;lt;pid&amp;gt; VM.native_memory summary/detailæ’æŸ¥\n\n2ã€åœ¨æ’æŸ¥æ¸…é—®é¢˜ä¹‹å‰å¯ä»¥é€‚å½“æ”¾å¼€k8sçš„limitï¼Œä»¥ä¾¿ä½ å¯ä»¥è§‚å¯Ÿåˆ°å†…å­˜å¢é•¿çš„åŒºåŸŸï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜\n\n3ã€å¯ä»¥å’Œè¿ç»´æ²Ÿé€šä¸€ä¸‹ï¼Œåœ¨oom killedçš„æ—¶å€™ï¼ˆoom killedåº”è¯¥ä¼šè®©podçŠ¶æ€å˜ä¸ºunhealthï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è§¦å‘hookï¼‰èƒ½å¦åšä¸€ä¸‹heapdumpã€jstackç­‰ï¼Œæ•°æ®ä¸è¦ä¿å­˜åœ¨å®¹å™¨é‡Œ\n\nå½“ç„¶ï¼ŒåƒDarrençš„å›å¤ï¼Œåœ¨æ­»ä¹‹å‰åšå‡ æ¬¡dumpä¹Ÿæ˜¯å¯ä»¥çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586401795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558270,"discussion_content":"è€ƒè™‘ä¸‹ä½¿ç”¨äº‘ç›˜æ¥ä¿å­˜æ—¥å¿—ï¼Œè¿™æ ·å®¹å™¨é‡å»ºæ—¶ä¸ä¼šä¸¢æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648183318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266482,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/IIkdC2gohpcibib0AJvSdnJQefAuQYGlLySQOticThpF7Ck9WuDUQLJlgZ7ic13LIFnGBXXbMsSP3nZsbibBN98ZjGA/132","nickname":"batman","note":"","ucode":"73C30ACFC0D612","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383557,"discussion_content":"æŸ¥ä¸‹èŠ‚ç‚¹çš„/var/log/messages çœ‹ä¸‹killçš„æ˜¯å“ªä¸ªè¿›ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626156751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204430,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1586398779,"is_pvip":true,"replies":[{"id":"76422","content":"æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586400185,"ip_address":"","comment_id":204430,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78895810107","product_id":100047701,"comment_content":"é¦–å…ˆå…ˆè¯•ç€å›ç­”ä¸‹@hellojdç«¥é‹çš„é—®é¢˜ï¼Œä¸ä¸€å®šå¯¹ï¼Œä»…ä¾›å‚è€ƒï¼šk8såº”è¯¥åœ¨cpuæˆ–è€…å†…å­˜çš„ä½¿ç”¨ç‡ä¸ŠåšæŠ¥è­¦ï¼Œå¤§äº90%çš„æ—¶å€™å¯ä»¥dumpå’Œjstackä¸€æ¬¡ï¼Œç”šè‡³jstatä¹Ÿå¯ä»¥åšï¼Œç„¶å95%çš„æ—¶å€™ä¹ŸåŒæ ·æ‰§è¡Œä¸€æ¬¡ï¼Œ<br>ç”šè‡³98æˆ–è€…99çš„æ—¶å€™ä¹Ÿå¯ä»¥åšä¸€æ¬¡ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥ä¿ç•™ç°åœºï¼ŒåŒæ—¶è¿˜å¯ä»¥å¯¹æ¯”ã€‚å¯ä»¥æ›´å¥½çš„æ’æŸ¥é—®é¢˜ã€‚<br><br>è¯´è¯´é‡åˆ°çš„é—®é¢˜å§ï¼Œå‰å‡ å¤©åˆšåˆšå‘ç”Ÿçš„ï¼šä¸Šçº¿äº†ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ²¡äº‹ï¼Œä½†æ˜¯åªè¦è¿è¡Œæ–°ä¸šåŠ¡ï¼Œ<br>å°±å‘ç°å†…å­˜çš„ä½¿ç”¨ç‡æ…¢æ…¢å‡é«˜ï¼Œéšåå¯¼è‡´CPUçš„ä½¿ç”¨ç‡å‡é«˜ï¼Œæœ€åCPUçš„ä½¿ç”¨ç‡å¤§äº90%ï¼Œç›´æ¥å‡ºå‘æŠ¥è­¦ï¼Œæœ€åå¯¼è‡´æœåŠ¡æŒ‚äº†ï¼›<br>åœ¨åˆ†ææŒ‚ä¹‹å‰çš„dumpçš„æ—¶å€™å‘ç°ï¼ŒJDBCClientImplæœ‰å‡ åä¸‡ä¸ªï¼Œ4Gçš„dumpæ–‡ä»¶ä¸­ï¼ŒJDBCClientImplå°±å ç”¨äº†3Gå¤šï¼Œåœ¨åˆ†æjstatçš„æ–‡ä»¶ï¼Œå‘ç°full GCç‰¹åˆ«é¢‘ç¹ï¼Œä½†æ˜¯å›æ”¶æ•ˆæœå¹¶ä¸æ˜æ˜¾ï¼Œå¯¼è‡´CPUé£™å‡ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯vertxæ¡†æ¶ï¼Œconnectionæ˜¯æ‰‹åŠ¨ç®¡ç†ï¼›<br>æ–°åŠŸèƒ½æœ‰ä¸€ä¸ªæƒ…å†µæ˜¯Aæ–¹æ³•è·å–connectionï¼Œä½†æ˜¯Aæ–¹æ³•å†…éƒ¨ä¹Ÿè¦è°ƒç”¨Bæ–¹æ³•ï¼Œå°±æŠŠconnectionä¼ é€’ç»™Bæ–¹æ³•ï¼Œç„¶ååœ¨Bæ–¹æ³•ä¸­å…³é—­é“¾æ¥ï¼Œä½†æ˜¯Bæ–¹æ³•å¹¶ä¸æ˜¯æ¯æ¬¡éƒ½è¢«è°ƒç”¨ï¼Œæœ‰ifæ¡ä»¶ï¼Œå½“æ—¶æ˜¯ä¸ºäº†åšå¥å£®æ€§åˆ¤æ–­çš„ï¼Œç°åœ¨å¯¼è‡´ä¸è¿›Bæ–¹æ³•ï¼Œå¯¼è‡´æ•°æ®åº“è¿æ¥ä¸é‡Šæ”¾ï¼Œå†…å­˜ä½¿ç”¨ç‡é£™å‡ï¼Œfull GCæ‰§è¡Œå¤šæ¬¡è§¦å‘CPUæŠ¥è­¦ã€‚<br><br>è¿˜æœ‰ä¸€ä¸ªå…ƒæ•°æ®åŒºçš„é—®é¢˜ï¼ŒJDK8é»˜è®¤çš„å…ƒæ•°æ®åŒºå¤§å°æ˜¯20.8Mï¼Œå› ä¸ºclassç­‰éƒ½æ”¾åœ¨å…ƒæ•°æ®å»ï¼Œå½“åŠ è½½çš„calssæ–‡ä»¶å¤šçš„æ—¶å€™ï¼Œ20.8Mæ˜¯ä¸å¤Ÿçš„ï¼Œåªè¦å…ƒæ•°æ®æ‰©å®¹ï¼Œå¿…å®šå¼•èµ·full GCï¼Œå› æ­¤å»ºè®®åœ¨å¯åŠ¨çš„æ—¶å€™å¯¹äºå…ƒæ•°æ®åŒºè®¾å®šä¸€ä¸ªåˆé€‚çš„å¤§å°ã€‚<br><br>è¯•ç€å›ç­”ä¸‹é—®é¢˜ï¼š<br>1ã€APPçš„é—®é¢˜å°±ä¸å›ç­”äº†ï¼Œå› ä¸ºæ²¡æœ‰APPçš„ç»éªŒï¼›<br>2ã€ç›®å‰æˆ‘ä»¬çš„ç›‘æ§ä¸»è¦æ˜¯ï¼ˆSpringbooté¡¹ç›®ï¼‰spring boot actuator+Prometheus+Grafanaï¼›<br>spring boot actuatorç›‘æ§jvmå†…éƒ¨æƒ…å†µï¼›<br>è‡ªå®šä¹‰exporteré‡‡é›†ç¡¬ä»¶ä½¿ç”¨æƒ…å†µåŠå®¹å™¨å†…éƒ¨ä½¿ç”¨æƒ…å†µï¼Œç»Ÿä¸€ä¸ŠæŠ¥Prometheusï¼Œç„¶åGrafanaåšæ˜¾ç¤ºã€‚<br>éSpringbooté¡¹ç›®ï¼Œé‡‡ç”¨çš„æ˜¯è‡ªç ”ç±»ä¼¼spring boot actuatorçš„åŠŸèƒ½ï¼Œæš´éœ²ç›¸å…³çš„metricï¼Œä¹Ÿæ˜¯ä¸ŠæŠ¥Prometheusã€‚","like_count":18,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491178,"discussion_content":"æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586400185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204395,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1586395539,"is_pvip":false,"replies":[{"id":"76403","content":"æ€»ç»“çš„å¾ˆå¥½","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586396920,"ip_address":"","comment_id":204395,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44536068499","product_id":100047701,"comment_content":"æœ¬æ–‡ç†è§£ï¼š<br><br>åº”å¯¹å‡ºé”™å…¶å®ä¸»è¦å°±æ˜¯ä¸‰ä¸ªé˜¶æ®µã€‚<br><br>1. beforeï¼šä¿è¯ç•™æœ‰åˆç†çš„æ—¥å¿—<br><br>2. ingï¼šæä¾›åŠæ—¶çš„é¢„è­¦ä»¥åŠç›‘æ§<br><br>3. afterï¼šæœ‰å……è¶³çš„åº”å¯¹é—®é¢˜çš„åº”æ€¥é¢„æ¡ˆï¼Œç‰ˆæœ¬å›æ»šï¼ŒæœåŠ¡é™çº§ç­‰<br><br>å…³äºä¸ªäººçš„æ’é”™è¿‡ç¨‹ä¸»è¦æ˜¯çº¿æ€§çš„ã€‚ç«¯åˆ°ç«¯çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼šAè°ƒBï¼ŒBè°ƒCï¼ŒCè°ƒDã€‚æˆ‘çš„åšæ³•æ˜¯å…ˆçœ‹Aå’ŒDï¼Œä¸¤ä¸ªä¸šåŠ¡ç«¯æ˜¯å¦æ­£å¸¸ã€‚å¦‚æœéƒ½æ­£å¸¸ï¼ŒABCçš„é¡ºåºæŒ¨ä¸ªæ’æŸ¥ã€‚æ£€æŸ¥Aæ˜¯å¦æ¥æ”¶åˆ°è¿”å›ç»“æœï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ£€æŸ¥Bæ˜¯å¦æ¥æ”¶åˆ°è¿”å›ç»“æœã€‚æ¯”è¾ƒç²—æš´ï¼Œä½†åœ¨å°å‹ä¸šåŠ¡ç³»ç»Ÿé‡Œï¼Œä¸ªäººæ„Ÿè§‰å¤„ç†ä¹Ÿè¿˜å¥½ã€‚<br><br>å¯¹äºä¸æœåŠ¡å™¨ä¸ä¸€æ ·çš„é—®é¢˜ï¼Œé€šå¸¸ä¼šæ¨¡æ‹Ÿä¸€ä»½æœåŠ¡å™¨æ•°æ®ï¼Œç„¶åæœ¬åœ°åšå‹æµ‹æ¨¡æ‹ŸæœåŠ¡å™¨æµé‡ã€‚ä¿è¯é—®é¢˜çš„å¤ç°ï¼Œèƒ½åœ¨æœ¬åœ°å¤ç°é—®é¢˜ï¼Œæ’æŸ¥åŸºæœ¬ä¸Šå°±ä¸æ˜¯ä»€ä¹ˆéš¾äº‹äº†ã€‚è¿™ä¸€æ€è·¯åœ¨ å”æ‰¬ è€å¸ˆçš„ã€Šé«˜å¹¶å‘ç³»ç»Ÿè®¾è®¡40é—®ã€‹ ä¸­æœ‰æåˆ°ï¼Œæ¨¡æ‹ŸæœåŠ¡å™¨ç¯å¢ƒï¼Œå…¶å®å°±æ˜¯å°½é‡æŠŠæµé‡ï¼Œæ•°æ®åº“ç­‰ç¯å¢ƒï¼Œå°½é‡è´´è¿‘æœåŠ¡å™¨ç¯å¢ƒã€‚","like_count":10,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491165,"discussion_content":"æ€»ç»“çš„å¾ˆå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586396920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2378309,"avatar":"https://static001.geekbang.org/account/avatar/00/24/4a/45/e048531a.jpg","nickname":"è¿ªç±³ä¹Œæ ¼æ–¯","note":"","ucode":"1D4393746DCBCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376318,"discussion_content":"å—æ•™äº†, å°¤å…¶æ˜¯æ¨¡æ‹ŸæœåŠ¡å™¨è¿™ä¸€å¥—, æœ¬åœ°èƒ½å¤ç°çš„é—®é¢˜çš„ç¡®éƒ½ä¸æ˜¯é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622079612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204388,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1586394882,"is_pvip":false,"replies":[{"id":"76402","content":"ï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586396876,"ip_address":"","comment_id":204388,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35946133250","product_id":100047701,"comment_content":"çœŸä¸æ•¢ç›¸ä¿¡ï¼Œå¦‚æ­¤é«˜è´¨é‡çš„å†…å®¹ï¼Œç«Ÿç„¶åªæ˜¯é€‰å­¦çš„ä¸å®šæœŸåŠ é¤ï¼ï¼ï¼","like_count":8,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491162,"discussion_content":"ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586396876,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204575,"user_name":"yinchi_516564","can_delete":false,"product_type":"c1","uid":1903751,"ip_address":"","ucode":"52EBE5A3B3A8B5","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0c/87/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1586423572,"is_pvip":false,"replies":[{"id":"76481","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586428656,"ip_address":"","comment_id":204575,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27356227348","product_id":100047701,"comment_content":"åˆ†äº«å‡ ä¸ªé‡åˆ°çš„è¿ç»´çŠ¯çš„é”™è¯¯ï¼š<br>1ã€ç°è±¡ï¼šåŒä¸€ä¸ªè¯·æ±‚æœ‰æ—¶å€™èƒ½æŸ¥å‡ºç»“æœï¼Œæœ‰æ—¶å€™è¿”å›ä¸ºç©º<br>   åŸå› ï¼šç»æ’æŸ¥æ˜¯è¿ç»´æŠŠåº”æ€¥æ—¶å€™ç”¨çš„æœåŠ¡å™¨(ç›´æ¥è¿”å›200)è¯¯æ·»åŠ åœ¨äº†nginxä»£ç†ä¸­<br>2ã€ç°è±¡ï¼šåŒä¸€ç¬”è¯·æ±‚æœ‰æ—¶å€™å¾ˆå¿«ï¼Œæœ‰æ—¶å€™è¶…æ—¶60s<br>   åŸå› ï¼šè¿ç»´è·¯ç”±è§„åˆ™é…é”™å¯¼è‡´ åˆ°mongodb çš„å»ç¨‹å’Œå›ç¨‹è·¯å¾„ä¸ä¸€å¯¼è‡´åŸæ¥çš„mongoé“¾æ¥å¤±æ•ˆï¼Œclientåœ¨é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šä¸»åŠ¨æ”¶å›è¿™äº›é“¾æ¥ï¼Œå½“å†æ¬¡è¯»å†™æ—¶å°±å‡ºç°å¼‚å¸¸<br>3ã€ç°è±¡ï¼šåŒä¸€ç¬”è¯·æ±‚æœ‰æ—¶å€™æ…¢ï¼Œæœ‰æ—¶å€™å¿«<br>   åŸå› ï¼šå®¹å™¨éƒ¨ç½²çš„æœåŠ¡æœ‰ä¸¤ä¸ªapiå®ä¾‹å‡æ­»ï¼Œå¯¼è‡´è¯·æ±‚å›æºï¼Œæ‹‰ä½äº†æ¥å£æ•´ä½“å“åº”çš„é€Ÿåº¦<br><br>ç›®å‰ä½¿ç”¨åˆ°çš„å·¥å…·<br>Grafanaç›‘æ§ ä¸»è¦åšapiæ¥å£ç›‘æ§<br>Kibanaç›‘æ§ ä¸»è¦åšæ—¥å¿—ç›‘æ§ <br>å¬äº‘Server ä¸»è¦åšæœåŠ¡å™¨èµ„æºç›‘æ§<br>è¿˜ä¼šç”¨åˆ°arthasåŠMATåˆ†æå·¥å…·<br><br>æœ€åï¼Œå¬è€å¸ˆçš„è¯¾ç¨‹ï¼Œæ¶¨äº†ä¸å°‘çŸ¥è¯†ï¼Œæ—¥åå†™ä»£ç ã€åˆ†æé—®é¢˜æœ‰ç‚¹ç‚¹åº•æ°”äº†ï¼Œæ„Ÿè°¢è€å¸ˆæ— ç§çš„åˆ†äº«ï¼","like_count":6,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491218,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586428656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2671015,"avatar":"https://static001.geekbang.org/account/avatar/00/28/c1/a7/67c8530d.jpg","nickname":"Z. w","note":"","ucode":"E3066ADE516B6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533273,"discussion_content":"è¯·æ±‚å›æºæ˜¯ä»€ä¹ˆåœºæ™¯ï¼Ÿä¹‹å‰å¥½åƒé‡åˆ°è¿‡ä¸€æ¬¡(è¿ç»´åŒäº‹å‘ç°çš„)ï¼Œä½†æ˜¯ä¸ç†è§£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637829931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207145,"user_name":"æŠ€æœ¯éª¨å¹²","can_delete":false,"product_type":"c1","uid":1098720,"ip_address":"","ucode":"8FCF8DE6D29201","user_header":"https://static001.geekbang.org/account/avatar/00/10/c3/e0/3db22579.jpg","comment_is_top":false,"comment_ctime":1587016060,"is_pvip":false,"replies":[{"id":"77388","content":"åé¢æœ‰åŠ é¤ä¼šå¸¦ä½ è¯¦ç»†åˆ†æ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587016882,"ip_address":"","comment_id":207145,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18766885244","product_id":100047701,"comment_content":"å†…å­˜çš„é—®é¢˜ï¼Œæä»¥å‰æˆ‘åŸºæœ¬åˆ†æä¸å‡ºæ¥","like_count":4,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492023,"discussion_content":"åé¢æœ‰åŠ é¤ä¼šå¸¦ä½ è¯¦ç»†åˆ†æ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587016882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204399,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1586396193,"is_pvip":false,"replies":[{"id":"76404","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586397198,"ip_address":"","comment_id":204399,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18766265377","product_id":100047701,"comment_content":"å¦‚æœä½ ç°åœ¨æ‰“å¼€ä¸€ä¸ª App åå‘ç°é¦–é¡µå±•ç¤ºäº†ä¸€ç‰‡ç©ºç™½ï¼Œé‚£è¿™åˆ°åº•æ˜¯å®¢æˆ·ç«¯å…¼å®¹æ€§çš„é—®é¢˜ï¼Œè¿˜æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜å‘¢ï¼Ÿå¦‚æœæ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ï¼Œåˆå¦‚ä½•è¿›ä¸€æ­¥ç»†åŒ–å®šä½å‘¢ï¼Ÿä½ æœ‰ä»€ä¹ˆåˆ†ææ€è·¯å—ï¼Ÿ<br><br>é¦–å…ˆï¼Œåˆ‡æ¢è®¾å¤‡ï¼Œæˆ–è€…æ¨¡æ‹Ÿè¯·æ±‚ï¼ŒæŸ¥çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸è®¿é—®ã€‚ä»¥æ’é™¤å®¢æˆ·ç«¯é—®é¢˜ã€‚<br><br>ç¡®ä¿æœåŠ¡ç«¯æœåŠ¡å™¨çŠ¶æ€ï¼Œ1ç¡®ä¿æ­£åœ¨è¿è¡Œï¼Œ2èµ„æºå ç”¨å¤„äºæ­£å¸¸çŠ¶æ€ï¼Œæ²¡æœ‰å‡ºç°æ»¡è½½ï¼Œ3æœåŠ¡å™¨å¯ä»¥è¢«æ­£å¸¸è®¿é—®ï¼Œæ’é™¤ç½‘ç»œé—®é¢˜ã€‚éšåï¼Œå¤‡ä»½å³æ—¶çš„æ‰€æœ‰å¯èƒ½æœ‰éœ€è¦çš„æ—¥å¿—ï¼Œæ¡ä»¶å…è®¸å°è¯•é‡å¯æœåŠ¡æˆ–è€…å›æ»šï¼Œä¿è¯çº¿ä¸ŠæœåŠ¡æ­£å¸¸ä»¥åŠå®¢æˆ·ä½“éªŒã€‚æ—¶å€™æ ¹æ®é—ç•™æ—¥å¿—å°è¯•è¿›è¡Œæ’æŸ¥ã€‚å¦‚æœä¾ç„¶æ— æœï¼Œæ¨¡æ‹ŸæœåŠ¡å™¨ç¯å¢ƒå’Œæµé‡ï¼Œè¿›è¡ŒDebugã€‚<br><br><br><br>å¯¹äºåˆ†æå®šä½é—®é¢˜ï¼Œä½ ä¼šåšå“ªäº›ç›‘æ§æˆ–æ˜¯ä½¿ç”¨å“ªäº›å·¥å…·å‘¢ï¼Ÿ<br><br>æ— è®ºç›‘æ§è¿˜æ˜¯å®šä½ï¼Œå¯¹ä¸ªäººæ¥è¯´ï¼š<br><br>é¦–å½“å…¶å†²ï¼šTopï¼Œæ£€æŸ¥å†…å­˜CPUå ç”¨æƒ…å†µç­‰ç­‰ã€‚å®šæœŸä¸å®šæœŸæ£€æŸ¥ä¸€ä¸‹æœåŠ¡æ­£å¸¸è¿è¡Œï¼Œå¹¶ç¡®è®¤èµ„æºå ç”¨æƒ…å†µã€‚<br><br>å¯¹äºè¯·æ±‚ï¼Œä¸ªäººçš„ç›‘æ§æ˜¯ï¼Œè®°å½•æ‰€æœ‰æ…¢è¯·æ±‚ï¼ˆå¤„ç†æ—¶é—´è¿‡é•¿çš„è¯·æ±‚ï¼‰ã€‚é’ˆå¯¹æ…¢è¯·æ±‚çš„æƒ…å†µåˆ†æï¼Œæ¯”å¦‚è¯´ï¼Œä¸€ä¸ªç†åº”æå¿«çš„è¯·æ±‚å‡ºç°äº†æ…¢è¯·æ±‚çš„æƒ…å†µå°±éœ€è¦å»åˆ†æï¼Œç¼“å­˜é—®é¢˜ï¼Œç½‘ç»œé—®é¢˜ç­‰ç­‰ã€‚<br><br>æ›¾ç»çš„é¡¹ç›®ï¼Œä¼šç›‘æ§æœåŠ¡çŠ¶æ€ï¼ŒæœåŠ¡å¦‚æœå®•æœºäº†ä¼šç»™ç›¸åº”è´Ÿè´£äººå‘é€çŸ­ä¿¡é€šçŸ¥æ’æŸ¥ã€‚","like_count":4,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491167,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586397198,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204494,"user_name":"Husiun","can_delete":false,"product_type":"c1","uid":1448664,"ip_address":"","ucode":"F783484743BFE4","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/d8/9ae1bdb9.jpg","comment_is_top":false,"comment_ctime":1586408006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10176342598","product_id":100047701,"comment_content":"é«˜è´¨é‡å†…å®¹ï¼ŒæœŸå¾…è€å¸ˆçš„æ›´æ–°ï¼›ä¸ªäººåœ¨å®é™…åº”ç”¨ä¸­è¿˜ä¸»è¦æ˜¯topå®šä½ï¼Œè¯¾åé—®é¢˜1ä¸ªäººæ²¡æœ‰ç›¸å…³ç»éªŒï¼Œæˆ‘çš„æ€è·¯æ˜¯å…ˆå®šä½å®¢æˆ·ç«¯é—®é¢˜å†ä¸€æ­¥æ­¥æ’æŸ¥åˆ°æœåŠ¡ç«¯ï¼Œä¹‹åå†topå®šä½å…·ä½“æœåŠ¡é—®é¢˜","like_count":2},{"had_liked":false,"id":209803,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1587617814,"is_pvip":false,"replies":[{"id":"78245","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587621907,"ip_address":"","comment_id":209803,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5882585110","product_id":100047701,"comment_content":"ä¸€æ˜¯ï¼Œç¨‹åºé€»è¾‘æœ‰é—®é¢˜æˆ–å¤–éƒ¨ä¾èµ–æ…¢ï¼Œä½¿å¾—ä¸šåŠ¡é€»è¾‘æ‰§è¡Œæ…¢ï¼Œåœ¨è®¿é—®é‡ä¸å˜çš„æƒ…å†µä¸‹éœ€è¦æ›´å¤šçš„çº¿ç¨‹æ•°æ¥åº”å¯¹ã€‚æ¯”å¦‚ï¼Œ10TPS çš„å¹¶å‘åŸå…ˆä¸€æ¬¡è¯·æ±‚ 1s å¯ä»¥æ‰§è¡Œå®Œæˆï¼Œ10 ä¸ªçº¿ç¨‹å¯ä»¥æ”¯æ’‘ï¼›ç°åœ¨æ‰§è¡Œå®Œæˆéœ€è¦ 10sï¼Œé‚£å°±éœ€è¦ 100 ä¸ªçº¿ç¨‹ã€‚<br>-~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>æ¯ç§’éƒ½æ¥10è¯·æ±‚ï¼Œ10ç§’å°±æ˜¯100ä¸ªè¯·æ±‚ï¼Œæ•…éœ€è¦100ä¸ªçº¿ç¨‹ï¼Œç»ˆäºæƒ³æ˜ç™½äº†ï¼Œæˆ‘æ˜¯çœŸçš„å¥½ç¬¨ğŸ˜­ã€‚<br>è€å¸ˆçš„è¯¾ç ´10000ä¸æ˜¯äº‹å§ï¼Œè¢«ä½ä¼°äº†ï¼Œæˆ‘å»éƒ¨è½å†å–å†å–ã€‚","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492869,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587621907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":208001,"user_name":"Geek_3b1096","can_delete":false,"product_type":"c1","uid":1549364,"ip_address":"","ucode":"A6BD92B79B3632","user_header":"","comment_is_top":false,"comment_ctime":1587240680,"is_pvip":false,"replies":[{"id":"77641","content":"æ¬¢è¿è½¬å‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587257195,"ip_address":"","comment_id":208001,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5882207976","product_id":100047701,"comment_content":"éå¸¸å®ç”¨è°¢è°¢è€å¸ˆ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492312,"discussion_content":"æ¬¢è¿è½¬å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587257195,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205510,"user_name":"hanazawakana","can_delete":false,"product_type":"c1","uid":1251721,"ip_address":"","ucode":"E0F6FACBFE7D15","user_header":"https://static001.geekbang.org/account/avatar/00/13/19/89/20488013.jpg","comment_is_top":false,"comment_ctime":1586658839,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5881626135","product_id":100047701,"comment_content":"é—®é¢˜1ï¼Œé¦–å…ˆçœ‹ä¸‹å®¢æˆ·ç«¯çš„å´©æºƒç›‘æ§ï¼Œå†çœ‹ä¸‹æ˜¯ä¸æ˜¯åªæœ‰è¿™ä¸ªæœºå™¨æœ‰é—®é¢˜ï¼Œå¦‚æœä¸åŒæœºå‹ä¹Ÿæœ‰é—®é¢˜ï¼Œå†çœ‹ä¸‹æ˜¯ä¸æ˜¯æŸä¸ªæœºå™¨åº•å±‚æ“ä½œç³»ç»Ÿçš„é—®é¢˜ï¼Œæ¯”å¦‚Android Oï¼Œå†çœ‹ä¸‹æ˜¯ä¸æ˜¯æŸä¸ªå‚å•†æ“ä½œç³»ç»Ÿçš„é—®é¢˜ï¼Œå¦‚æœæ˜¯æ™®éå­˜åœ¨çš„ï¼Œè€ƒè™‘æœåŠ¡ç«¯é—®é¢˜ï¼Œçœ‹ä¸‹å¯¹åº”æ¥å£çš„æ—¥å¿—æœ‰æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ—¥å¿—ï¼Œå†åˆ†æä¸‹æ˜¯ä¸æ˜¯nginxæˆ–è€…ç½‘ç»œçš„é—®é¢˜","like_count":1},{"had_liked":false,"id":351920,"user_name":"äºŒé¥¼","can_delete":false,"product_type":"c1","uid":2415448,"ip_address":"","ucode":"48120565D135F7","user_header":"https://static001.geekbang.org/account/avatar/00/24/db/58/a7a0a85b.jpg","comment_is_top":false,"comment_ctime":1658295482,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1658295482","product_id":100047701,"comment_content":"æ„Ÿè°¢è€å¸ˆåˆ†äº«ï¼Œå¥½å¤šå¹²è´§ï¼å°è¯•åœ¨å·¥ä½œä¸­å¤šè¯•è¯•ã€‚","like_count":0},{"had_liked":false,"id":259376,"user_name":"Geek_a07e7d","can_delete":false,"product_type":"c1","uid":2274227,"ip_address":"","ucode":"1AFDCC8D021983","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJnib6n8RxpAJd9xFeoAAYZwbkM009k2OZoniaAJRSC1BLQMsZuByicEBSaZPx3K1VnOeSia3m1lLsuicg/132","comment_is_top":false,"comment_ctime":1604715398,"is_pvip":false,"replies":[{"id":"94342","content":"è¿™æ˜¯ä¸€æ ·çš„ è¿›å…¥dockerç¯å¢ƒåæ‰§è¡Œå‘½ä»¤ pidæ˜¯1","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1604792895,"ip_address":"","comment_id":259376,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1604715398","product_id":100047701,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œk8séƒ¨ç½²çš„æœåŠ¡æ€æ ·é€šè¿‡jvmè‡ªå¸¦å‘½ä»¤æŸ¥çœ‹å †æ ˆä¿¡æ¯","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508920,"discussion_content":"è¿™æ˜¯ä¸€æ ·çš„ è¿›å…¥dockerç¯å¢ƒåæ‰§è¡Œå‘½ä»¤ pidæ˜¯1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604792895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":241477,"user_name":"è†ä»™","can_delete":false,"product_type":"c1","uid":1064734,"ip_address":"","ucode":"8BF9D620BCA5DD","user_header":"https://static001.geekbang.org/account/avatar/00/10/3f/1e/8e184acb.jpg","comment_is_top":false,"comment_ctime":1597306546,"is_pvip":true,"replies":[{"id":"89175","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1597315255,"ip_address":"","comment_id":241477,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1597306546","product_id":100047701,"comment_content":"ä¸€èˆ¬å¦‚æœæ˜¯å…¼å®¹æ€§é—®é¢˜IOSæˆ–è€…å®‰å“åªä¼šåœ¨å…¶ä¸­ä¸€ç«¯å‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥åˆ†åˆ«ä½¿ç”¨iPhoneå’Œå®‰å“æœºæµ‹è¯•ã€‚å¦‚æœéƒ½æœ‰é—®é¢˜ï¼Œå¤§æ¦‚ç‡æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ã€‚å…¥è‚¡æ˜¯æœåŠ¡ç«¯é—®é¢˜ï¼Œå¯ä»¥å…ˆæŠ“åŒ…æˆ–è€…é€šè¿‡æ—¥å¿—çš„æ–¹å¼è·å–æœåŠ¡ç«¯çš„å“åº”æ•°æ®ï¼Œçœ‹å“åº”æ•°æ®æœ‰ä½•å¼‚å¸¸ï¼Œç„¶åå†ç»“åˆæ—¥å¿—æ’æŸ¥é—®é¢˜ã€‚","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503748,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597315255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228216,"user_name":"track6688","can_delete":false,"product_type":"c1","uid":1088040,"ip_address":"","ucode":"0A9E893F8FD379","user_header":"https://static001.geekbang.org/account/avatar/00/10/9a/28/03613c22.jpg","comment_is_top":false,"comment_ctime":1592616159,"is_pvip":false,"replies":[{"id":"84178","content":"åŠ é¤6","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1592640402,"ip_address":"","comment_id":228216,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592616159","product_id":100047701,"comment_content":"æˆ‘æƒ³è¯·æ•™è€å¸ˆï¼Œæ˜¯å¦‚ä½•æˆé•¿åˆ°è¿™ä¸ªåœ°æ­¥çš„ï¼Ÿå“ˆå“ˆå“ˆ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498960,"discussion_content":"åŠ é¤6","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592640402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223570,"user_name":"å²³å®œæ³¢","can_delete":false,"product_type":"c1","uid":1975581,"ip_address":"","ucode":"5043CA250FDCB1","user_header":"http://thirdwx.qlogo.cn/mmopen/2kpMNDYsSfCnhAYmvAsNcYKyNLUJG5iax9BKgXAJzxypEJGRVwhibjZ53S5icgEDibn8uqrqwsKcxzEXfRRUXTdqjA/132","comment_is_top":false,"comment_ctime":1591116493,"is_pvip":false,"replies":[{"id":"82351","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1591141586,"ip_address":"","comment_id":223570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591116493","product_id":100047701,"comment_content":"æˆ‘ä»¬å„ä¸ªç¯å¢ƒéƒ½ä¼šå¼€å¯ä¸€ä¸ªè°ƒè¯•å®ä¾‹ï¼Œåªæœ‰æ·»åŠ å›ºå®šçš„cookieçš„æ—¶å€™è¯·æ±‚æ‰ä¼šæ‰“åˆ°è°ƒè¯•å®ä¾‹ä¸Šï¼Œå¯ä»¥åœ¨è°ƒè¯•å®ä¾‹ä¸Šè¿œç¨‹è°ƒè¯•ï¼Œä¸å½±å“å…¶ä»–ç”¨æˆ·ä½¿ç”¨","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497169,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591141586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211033,"user_name":"Asha","can_delete":false,"product_type":"c1","uid":1796527,"ip_address":"","ucode":"69F227707A9EDD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/69/af/ceb4450c.jpg","comment_is_top":false,"comment_ctime":1587884227,"is_pvip":false,"replies":[{"id":"78502","content":"è¿™æ˜¯æ–‡ä¸­ä½œè€…çš„æ’æŸ¥æ€è·¯ ä½ ä¸ä¸€å®šéœ€è¦æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥ tomcatçš„å·¥ä½œçº¿ç¨‹ä¸ä¼šå›æ”¶ å¼•ç”¨çš„èµ„æºä¸ä¼šé‡Šæ”¾","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587892999,"ip_address":"","comment_id":211033,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587884227","product_id":100047701,"comment_content":"è€å¸ˆ éå¸¸æ„Ÿè°¢ä½ æä¾›çš„å…³äºç›´æ¥å­˜å‚¨å·®é—®é¢˜çš„æ–‡ç«  å¯å‘äº†å¾ˆå¤šã€‚æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å·²ç»çŸ¥é“æ˜¯ç›´æ¥å†…å­˜çš„é—®é¢˜äº†ï¼Œè¿˜éœ€è¦å…ˆå»çœ‹å †å†…å­˜å‘¢ ç¬¬äºŒä¸ªæ˜¯ä¸ºä»€ä¹ˆåœ¨thread localä¸­å¼•ç”¨çš„ç›´æ¥å†…å­˜åœ¨gcçš„æ—¶å€™ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾ å¤šè°¢","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493174,"discussion_content":"è¿™æ˜¯æ–‡ä¸­ä½œè€…çš„æ’æŸ¥æ€è·¯ ä½ ä¸ä¸€å®šéœ€è¦æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥ tomcatçš„å·¥ä½œçº¿ç¨‹ä¸ä¼šå›æ”¶ å¼•ç”¨çš„èµ„æºä¸ä¼šé‡Šæ”¾","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587892999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210977,"user_name":"Asha","can_delete":false,"product_type":"c1","uid":1796527,"ip_address":"","ucode":"69F227707A9EDD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/69/af/ceb4450c.jpg","comment_is_top":false,"comment_ctime":1587872842,"is_pvip":false,"replies":[{"id":"78480","content":"æ’æŸ¥æ–¹å¼å‚è€ƒ https:&#47;&#47;coldwalker.com&#47;2018&#47;12&#47;&#47;troubleshooter_directbytebuffer_memory_issue&#47;","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1587876046,"ip_address":"","comment_id":210977,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1587872842","product_id":100047701,"comment_content":"è€å¸ˆåŠåŒå­¦ä»¬ æˆ‘è¿™å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼ŒèƒŒæ™¯æ˜¯è¿™æ ·çš„ å°ä¼™ä¼´æ¯å¤©å®šæ—¶redisç¼“å­˜ä¸­çš„æ•°æ®æ¸…ç©ºï¼Œç„¶åé‡æ–°åŠ è½½ã€‚ç„¶åè¿‡ä¸€ä¸ªæœˆå·¦å³å°±ä¼šæŠ›oomä½†æ˜¯æ˜¯direct memory out of memory. ä¹‹å‰çŒœæµ‹æ˜¯ä¸æ˜¯rediså®¢æˆ·ç«¯ä»æœåŠ¡ç«¯æ‹¿æ•°æ®çš„æ—¶å€™ è¿æ¥æ•°å¤ªå¤šäº† åæ¥çœ‹redisçš„å®¢æˆ·ç«¯æ˜¯æœ‰ä¸€ä¸ªè¿æ¥æ± ç®¡ç†çš„ã€‚çƒ¦è¯·è€å¸ˆå’ŒåŒå­¦ä»¬æä¾›å¥½çš„æ€è·¯","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493163,"discussion_content":"æ’æŸ¥æ–¹å¼å‚è€ƒ https://coldwalker.com/2018/12//troubleshooter_directbytebuffer_memory_issue/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587876046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1575056,"avatar":"https://static001.geekbang.org/account/avatar/00/18/08/90/ce429e02.jpg","nickname":"sunshine","note":"","ucode":"0CF3A7F542FA9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394318,"discussion_content":"ç½‘å€æ‰“ä¸å¼€å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631840716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796527,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/69/af/ceb4450c.jpg","nickname":"Asha","note":"","ucode":"69F227707A9EDD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":248566,"discussion_content":"lè€å¸ˆ éå¸¸æ„Ÿè°¢ çœ‹äº†è¿™ç¯‡æ–‡ç« æ‰“å¼€äº†æ€è·¯ æœ‰ä¸ªé—®é¢˜ ä¸ºä»€ä¹ˆå·²ç»çŸ¥é“æ˜¯ç›´æ¥å†…å­˜äº† è¿˜éœ€è¦å†å»æŸ¥å †å†…å­˜æ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587879245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}