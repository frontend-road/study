{"id":14425,"title":"04 | 如何发布和引用服务？","content":"<p>从这期开始，我将陆续给你讲解微服务各个基本组件的原理和实现方式。</p>\n<p>今天我要与你分享的第一个组件是<span class=\"orange\">服务发布和引用</span>。我在前面说过，想要构建微服务，首先要解决的问题是，<strong>服务提供者如何发布一个服务，服务消费者如何引用这个服务</strong>。具体来说，就是这个服务的接口名是什么？调用这个服务需要传递哪些参数？接口的返回值是什么类型？以及一些其他接口描述信息。</p>\n<p>我前面说过，最常见的服务发布和引用的方式有三种：</p>\n<ul>\n<li>\n<p>RESTful API</p>\n</li>\n<li>\n<p>XML配置</p>\n</li>\n<li>\n<p>IDL文件</p>\n</li>\n</ul>\n<p>下面我就结合具体的实例，逐个讲解每一种方式的具体使用方法以及各自的应用场景，以便你在选型时作参考。</p>\n<h2>RESTful API</h2>\n<p>首先来说说RESTful API的方式，主要被<strong>用作HTTP或者HTTPS协议的接口定义</strong>，即使在非微服务架构体系下，也被广泛采用。</p>\n<p>下面是开源服务化框架<a href=\"http://github.com/weibocom/motan\">Motan</a>发布RESTful API的例子，它发布了三个RESTful格式的API，接口声明如下：</p>\n<pre><code>@Path(&quot;/rest&quot;)\n public interface RestfulService {\n     @GET\n     @Produces(MediaType.APPLICATION_JSON)\n     List&lt;User&gt; getUsers(@QueryParam(&quot;uid&quot;) int uid);\n \n     @GET\n     @Path(&quot;/primitive&quot;)\n     @Produces(MediaType.TEXT_PLAIN)\n     String testPrimitiveType();\n \n     @POST\n     @Consumes(MediaType.APPLICATION_FORM_URLENCODED)\n     @Produces(MediaType.APPLICATION_JSON)\n     Response add(@FormParam(&quot;id&quot;) int id, @FormParam(&quot;name&quot;) String name);\n</code></pre><!-- [[[read_end]]] -->\n<p>具体的服务实现如下：</p>\n<pre><code>public class RestfulServerDemo implements RestfulService {\n        \n     @Override\n     public List&lt;User&gt; getUsers(@CookieParam(&quot;uid&quot;) int uid) {\n         return Arrays.asList(new User(uid, &quot;name&quot; + uid));\n     }\n \n     @Override\n     public String testPrimitiveType() {\n         return &quot;helloworld!&quot;;\n     }\n \n     @Override\n     public Response add(@FormParam(&quot;id&quot;) int id, @FormParam(&quot;name&quot;) String name) {\n         return Response.ok().cookie(new NewCookie(&quot;ck&quot;, String.valueOf(id))).entity(new User(id, name)).build();\n     }\n</code></pre>\n<p>服务提供者这一端通过部署代码到Tomcat中，并配置Tomcat中如下的web.xml，就可以通过servlet的方式对外提供RESTful API。</p>\n<pre><code>&lt;listener&gt;\n     &lt;listener-class&gt;com.weibo.api.motan.protocol.restful.support.servlet.RestfulServletContainerListener&lt;/listener-class&gt;\n &lt;/listener&gt;\n\n &lt;servlet&gt;\n     &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n     &lt;servlet-class&gt;org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher&lt;/servlet-class&gt;\n     &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n     &lt;init-param&gt;\n         &lt;param-name&gt;resteasy.servlet.mapping.prefix&lt;/param-name&gt;\n         &lt;param-value&gt;/servlet&lt;/param-value&gt;  &lt;!-- 此处实际为servlet-mapping的url-pattern，具体配置见resteasy文档--&gt;\n     &lt;/init-param&gt;\n &lt;/servlet&gt;\n\n &lt;servlet-mapping&gt;\n     &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n     &lt;url-pattern&gt;/servlet/*&lt;/url-pattern&gt;\n &lt;/servlet-mapping&gt;\n</code></pre>\n<p>这样服务消费者就可以通过HTTP协议调用服务了，因为HTTP协议本身是一个公开的协议，对于服务消费者来说几乎没有学习成本，所以比较适合用作跨业务平台之间的服务协议。比如你有一个服务，不仅需要在业务部门内部提供服务，还需要向其他业务部门提供服务，甚至开放给外网提供服务，这时候采用HTTP协议就比较合适，也省去了沟通服务协议的成本。</p>\n<h2>XML配置</h2>\n<p>接下来再来给你讲下XML配置方式，这种方式的服务发布和引用主要分三个步骤：</p>\n<ul>\n<li>\n<p>服务提供者定义接口，并实现接口。</p>\n</li>\n<li>\n<p>服务提供者进程启动时，通过加载server.xml配置文件将接口暴露出去。</p>\n</li>\n<li>\n<p>服务消费者进程启动时，通过加载client.xml配置文件来引入要调用的接口。</p>\n</li>\n</ul>\n<p>我继续以服务化框架Motan为例，它还支持以XML配置的方式来发布和引用服务。</p>\n<p>首先，服务提供者定义接口。</p>\n<pre><code>public interface FooService {\n    public String hello(String name);\n}\n</code></pre>\n<p>然后服务提供者实现接口。</p>\n<pre><code>public class FooServiceImpl implements FooService {\n\n    public String hello(String name) {\n        System.out.println(name + &quot; invoked rpc service&quot;);\n        return &quot;hello &quot; + name;\n    }\n}\n</code></pre>\n<p>最后服务提供者进程启动时，加载server.xml配置文件，开启8002端口监听。</p>\n<p>server.xml配置如下：</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\n xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n xmlns:motan=&quot;http://api.weibo.com/schema/motan&quot;\n xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\n   http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd&quot;&gt;\n\n    &lt;!-- service implemention bean --&gt;\n    &lt;bean id=&quot;serviceImpl&quot; class=&quot;quickstart.FooServiceImpl&quot; /&gt;\n    &lt;!-- exporting service by Motan --&gt;\n    &lt;motan:service interface=&quot;quickstart.FooService&quot; ref=&quot;serviceImpl&quot; export=&quot;8002&quot; /&gt;\n&lt;/beans&gt;\n</code></pre>\n<p>服务提供者加载server.xml的代码如下：</p>\n<pre><code>import org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Server {\n\n    public static void main(String[] args) throws InterruptedException {\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext(&quot;classpath:motan_server.xml&quot;);\n        System.out.println(&quot;server start...&quot;);\n    }\n}\n</code></pre>\n<p>服务消费者要想调用服务，就必须在进程启动时，加载配置client.xml，引用接口定义，然后发起调用。</p>\n<p>client.xml配置如下：</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;\nxmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\nxmlns:motan=&quot;http://api.weibo.com/schema/motan&quot;\nxsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\n   http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd&quot;&gt;\n\n    &lt;!-- reference to the remote service --&gt;\n    &lt;motan:referer id=&quot;remoteService&quot; interface=&quot;quickstart.FooService&quot; directUrl=&quot;localhost:8002&quot;/&gt;\n&lt;/beans&gt;\n</code></pre>\n<p>服务消费者启动时，加载client.xml的代码如下。</p>\n<pre><code>import org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\n\npublic class Client {\n\n    public static void main(String[] args) throws InterruptedException {\n        ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;classpath:motan_client.xml&quot;);\n        FooService service = (FooService) ctx.getBean(&quot;remoteService&quot;);\n        System.out.println(service.hello(&quot;motan&quot;));\n    }\n}\n</code></pre>\n<p>就这样，通过在服务提供者和服务消费者之间维持一份对等的XML配置文件，来保证服务消费者按照服务提供者的约定来进行服务调用。在这种方式下，如果服务提供者变更了接口定义，不仅需要更新服务提供者加载的接口描述文件server.xml，还需要同时更新服务消费者加载的接口描述文件client.xml。</p>\n<p>一般是私有RPC框架会选择XML配置这种方式来描述接口，因为私有RPC协议的性能要比HTTP协议高，所以在对性能要求比较高的场景下，采用XML配置的方式比较合适。但这种方式对业务代码侵入性比较高，XML配置有变更的时候，服务消费者和服务提供者都要更新，所以适合公司内部联系比较紧密的业务之间采用。如果要应用到跨部门之间的业务调用，一旦有XML配置变更，需要花费大量精力去协调不同部门做升级工作。在我经历的实际项目里，就遇到过一次底层服务的接口升级，需要所有相关的调用方都升级，为此花费了大量时间去协调沟通不同部门之间的升级工作，最后经历了大半年才最终完成。所以对于XML配置方式的服务描述，一旦应用到多个部门之间的接口格式约定，如果有变更，最好是新增接口，不到万不得已不要对原有的接口格式做变更。</p>\n<h2>IDL文件</h2>\n<p>IDL就是接口描述语言（interface description language）的缩写，通过一种中立的方式来描述接口，使得在不同的平台上运行的对象和不同语言编写的程序可以相互通信交流。比如你用Java语言实现提供的一个服务，也能被PHP语言调用。</p>\n<p>也就是说IDL主要是<strong>用作跨语言平台的服务之间的调用</strong>，有两种最常用的IDL：一个是Facebook开源的<strong>Thrift协议</strong>，另一个是Google开源的<strong>gRPC协议</strong>。无论是Thrift协议还是gRPC协议，它们的工作原理都是类似的。</p>\n<p>接下来，我以gRPC协议为例，给你讲讲如何使用IDL文件方式来描述接口。</p>\n<p>gRPC协议使用Protobuf简称proto文件来定义接口名、调用参数以及返回值类型。</p>\n<p>比如文件helloword.proto定义了一个接口SayHello方法，它的请求参数是HelloRequest，它的返回值是HelloReply。</p>\n<pre><code>// The greeter service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n  rpc SayHelloAgain (HelloRequest) returns (HelloReply) {}\n\n}\n\n// The request message containing the user's name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}  \n</code></pre>\n<p>假如服务提供者使用的是Java语言，那么利用protoc插件即可自动生成Server端的Java代码。</p>\n<pre><code>private class GreeterImpl extends GreeterGrpc.GreeterImplBase {\n\n  @Override\n  public void sayHello(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver) {\n    HelloReply reply = HelloReply.newBuilder().setMessage(&quot;Hello &quot; + req.getName()).build();\n    responseObserver.onNext(reply);\n    responseObserver.onCompleted();\n  }\n\n  @Override\n  public void sayHelloAgain(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver) {\n    HelloReply reply = HelloReply.newBuilder().setMessage(&quot;Hello again &quot; + req.getName()).build();\n    responseObserver.onNext(reply);\n    responseObserver.onCompleted();\n  }\n}\n</code></pre>\n<p>假如服务消费者使用的也是Java语言，那么利用protoc插件即可自动生成Client端的Java代码。</p>\n<pre><code>public void greet(String name) {\n  logger.info(&quot;Will try to greet &quot; + name + &quot; ...&quot;);\n  HelloRequest request = HelloRequest.newBuilder().setName(name).build();\n  HelloReply response;\n  try {\n    response = blockingStub.sayHello(request);\n  } catch (StatusRuntimeException e) {\n    logger.log(Level.WARNING, &quot;RPC failed: {0}&quot;, e.getStatus());\n    return;\n  }\n  logger.info(&quot;Greeting: &quot; + response.getMessage());\n  try {\n    response = blockingStub.sayHelloAgain(request);\n  } catch (StatusRuntimeException e) {\n    logger.log(Level.WARNING, &quot;RPC failed: {0}&quot;, e.getStatus());\n    return;\n  }\n  logger.info(&quot;Greeting: &quot; + response.getMessage());\n}  \n</code></pre>\n<p>假如服务消费者使用的是PHP语言，那么利用protoc插件即可自动生成Client端的PHP代码。</p>\n<pre><code>    $request = new Helloworld\\HelloRequest();\n    $request-&gt;setName($name);\n    list($reply, $status) = $client-&gt;SayHello($request)-&gt;wait();\n    $message = $reply-&gt;getMessage();\n    list($reply, $status) = $client-&gt;SayHelloAgain($request)-&gt;wait();\n    $message = $reply-&gt;getMessage(); \n</code></pre>\n<p>由此可见，gRPC协议的服务描述是通过proto文件来定义接口的，然后再使用protoc来生成不同语言平台的客户端和服务端代码，从而具备跨语言服务调用能力。</p>\n<p>有一点特别需要注意的是，在描述接口定义时，IDL文件需要对接口返回值进行详细定义。如果接口返回值的字段比较多，并且经常变化时，采用IDL文件方式的接口定义就不太合适了。一方面可能会造成IDL文件过大难以维护，另一方面只要IDL文件中定义的接口返回值有变更，都需要同步所有的服务消费者都更新，管理成本就太高了。</p>\n<p>我在项目实践过程中，曾经考虑过采用Protobuf文件来描述微博内容接口，但微博内容返回的字段有几百个，并且有些字段不固定，返回什么字段是业务方自定义的，这种情况采用Protobuf文件来描述的话会十分麻烦，所以最终不得不放弃这种方式。</p>\n<h2>总结</h2>\n<p>今天我给你介绍了服务描述最常见的三种方式：RESTful API、XML配置以及IDL文件。</p>\n<p>具体采用哪种服务描述方式是根据实际情况决定的，通常情况下，如果只是企业内部之间的服务调用，并且都是Java语言的话，选择XML配置方式是最简单的。如果企业内部存在多个服务，并且服务采用的是不同语言平台，建议使用IDL文件方式进行描述服务。如果还存在对外开放服务调用的情形的话，使用RESTful API方式则更加通用。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/6f/99/6fb77c7f56052f945d09f1e8f20d0099.png?wh=628*160\" alt=\"\" /></p>\n<h2>思考题</h2>\n<p>针对你的业务场景思考一下，假如要进行服务化，你觉得使用哪种服务描述最合适？为什么？</p>\n<p>欢迎你在留言区写下自己的思考，与我一起讨论。</p>\n<p></p>\n","comments":[{"had_liked":false,"id":22296,"user_name":"李二木","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1535592904,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"237758794184","product_id":100014401,"comment_content":"老师可否提供一个微博的restfull api设计规范文档呢？想要学习下。","like_count":56,"discussions":[{"author":{"id":1676962,"avatar":"https://static001.geekbang.org/account/avatar/00/19/96/a2/c1596dd8.jpg","nickname":"🤔","note":"","ucode":"40ACB53BF3C6B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567632,"discussion_content":"Google API 接口设计指南","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650962293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1035064,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/cb/38/4c9cfdf4.jpg","nickname":"谢小路","note":"","ucode":"C9FE2EB10DC105","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376593,"discussion_content":"Github api 规范也是学习的范本哎。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622204064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22360,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1535628473,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"186219222201","product_id":100014401,"comment_content":"三种方式都用过：<br><br>A项目使用Consul，对应restful<br>B项目使用dubbo, 对应XML<br>C项目涉及java和python服务之间调用，使用thrift，对应IDL","like_count":44},{"had_liked":false,"id":22277,"user_name":"小胖狗","can_delete":false,"product_type":"c1","uid":1107423,"ip_address":"","ucode":"2C0CF3ED8E784A","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/df/0c8e3fdc.jpg","comment_is_top":false,"comment_ctime":1535590949,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"121794675237","product_id":100014401,"comment_content":"我们这边是这样的。同一个服务，对内提供的话就使用RPC，对外提供的话，就走Restful API","like_count":29,"discussions":[{"author":{"id":1438037,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f1/55/8ac4f169.jpg","nickname":"陈国林","note":"","ucode":"83D12F3E79F197","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":185362,"discussion_content":"目前应该大部分都是这样的方式，赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582620308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22276,"user_name":"钟悠","can_delete":false,"product_type":"c1","uid":1114612,"ip_address":"","ucode":"5AF2CAE1737927","user_header":"https://static001.geekbang.org/account/avatar/00/11/01/f4/3dc9bcce.jpg","comment_is_top":false,"comment_ctime":1535590887,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"91729904103","product_id":100014401,"comment_content":"边看文章，边想dubbo","like_count":22},{"had_liked":false,"id":22320,"user_name":"岳阳楼","can_delete":false,"product_type":"c1","uid":1059404,"ip_address":"","ucode":"62FCBBE5D4FC3B","user_header":"https://static001.geekbang.org/account/avatar/00/10/2a/4c/393ebc45.jpg","comment_is_top":false,"comment_ctime":1535599851,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"74550043883","product_id":100014401,"comment_content":"没理解说IDL兼容的问题，查了一下，Protobuf是支持版本兼容的，新增字段或者删除字段都可以兼容。能细致的讲一下您对这个的见解么，谢谢！","like_count":18},{"had_liked":false,"id":22256,"user_name":"郁","can_delete":false,"product_type":"c1","uid":1058787,"ip_address":"","ucode":"905D8D5FA60172","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ynEtBO8iayrGrbbekL9g8CJ7Mnl1u2Dom2Bt4XNPNZyTJ5woicYTewvxwTEhEyQ2UEBszRLEj5TkJxicaEb5rW0Cw/132","comment_is_top":false,"comment_ctime":1535589092,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"70255065828","product_id":100014401,"comment_content":"对内grpc，对外http+json","like_count":17},{"had_liked":false,"id":22265,"user_name":"明天更美好","can_delete":false,"product_type":"c1","uid":1180696,"ip_address":"","ucode":"F036B8718938BE","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg","comment_is_top":false,"comment_ctime":1535589621,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"35895327989","product_id":100014401,"comment_content":"我觉得我们如果做的话，xml方式适合，我们对性能要求交高，对在提供能力要求1.5wtps，响应60ms以内，所以xml比较合适，但是我还想请教胡老师一个问题，就是我们目前还是单体应用，有23接口，就认证接口并发交高，有必要做微服务吗？目前光tomcat部署了30多个，感觉好烦，每次升级换包老半天。而且是没网部署。","like_count":8,"discussions":[{"author":{"id":1177289,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f6/c9/4da2a82a.jpg","nickname":"黄大仙","note":"","ucode":"337B6E811CF47D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2042,"discussion_content":"通过http对外服务，拆出来路径映射即可。如果只是对内，从成本和收益考虑一下，单就部署而言，工作量肯定翻番。更不用说建立一个相对完备的微服务生产环境。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563196907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22526,"user_name":"heigh","can_delete":false,"product_type":"c1","uid":1213772,"ip_address":"","ucode":"740D17434C930D","user_header":"https://static001.geekbang.org/account/avatar/00/12/85/4c/400f817c.jpg","comment_is_top":false,"comment_ctime":1535766863,"is_pvip":false,"replies":[{"id":"8235","content":"idl跟通信协议无关，grpc用的是http2，可以理解是七层，thrift用的是tcp，四层","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536027174,"ip_address":"","comment_id":22526,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27305570639","product_id":100014401,"comment_content":"请教，idl走的七层还是四层协议？","like_count":6,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423149,"discussion_content":"idl跟通信协议无关，grpc用的是http2，可以理解是七层，thrift用的是tcp，四层","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536027174,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22316,"user_name":"王江华","can_delete":false,"product_type":"c1","uid":1024187,"ip_address":"","ucode":"7CADF4079A18BD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/bb/a7dc0dd3.jpg","comment_is_top":false,"comment_ctime":1535597189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27305400965","product_id":100014401,"comment_content":"目前我们用的php+thirft，还没有做服务注册，服务化刚刚开始，后续还有好多坑要趟","like_count":6},{"had_liked":false,"id":22231,"user_name":"Hurt","can_delete":false,"product_type":"c1","uid":1050946,"ip_address":"","ucode":"DCE7428CCF08EF","user_header":"https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg","comment_is_top":false,"comment_ctime":1535584607,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27305388383","product_id":100014401,"comment_content":"目前 微服务 还是以java为主吗 老师","like_count":6},{"had_liked":false,"id":71817,"user_name":"高进","can_delete":false,"product_type":"c1","uid":1271258,"ip_address":"","ucode":"BB78F1E377A82D","user_header":"https://static001.geekbang.org/account/avatar/00/13/65/da/0bcc39eb.jpg","comment_is_top":false,"comment_ctime":1551443131,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23026279611","product_id":100014401,"comment_content":"对外restful<br>对内xml<br>跨语言idl","like_count":5},{"had_liked":false,"id":22281,"user_name":"南山","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1535591572,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"18715460756","product_id":100014401,"comment_content":"一般是两种结合，各个服务之间的调用通过xml的形式，对外暴露restful接口，如给前端调用等。dubbo，pigeon， springboot实现两种不同形式的服务接口定义与调用。目前都是JAVA，还没有涉及到多语言。","like_count":4},{"had_liked":false,"id":24155,"user_name":"bert","can_delete":false,"product_type":"c1","uid":1021803,"ip_address":"","ucode":"2F89303AE5FB77","user_header":"https://static001.geekbang.org/account/avatar/00/0f/97/6b/c74c4a8e.jpg","comment_is_top":false,"comment_ctime":1536825593,"is_pvip":false,"replies":[{"id":"8871","content":"是的","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536850354,"ip_address":"","comment_id":24155,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14421727481","product_id":100014401,"comment_content":"微服务之间调用，使用xml配置。对外提供服务，如APP，H5，小程序等用Restful API.","like_count":4,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423862,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536850354,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22303,"user_name":"李二木","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1535593964,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14420495852","product_id":100014401,"comment_content":"现在的服务是通过dubbo xml配置服务访问。将以前的一个应用拆分成两个独立服务，一个基础服务，一个业务服务，业务依赖基础服务。基础服务只服务于业务，所以用xml配置引用比较高效。业务对外提供服务restfull api，共别的系统调用！","like_count":3},{"had_liked":false,"id":22857,"user_name":"耳东陈","can_delete":false,"product_type":"c1","uid":1206191,"ip_address":"","ucode":"B4690A79637BA9","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/af/b2df8ca6.jpg","comment_is_top":false,"comment_ctime":1536020551,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10125955143","product_id":100014401,"comment_content":"服务规范、服务描述之前通过文档规范，稍有改动跨部门沟通简直就是噩梦，现在使用Swagger 轻松解决问题","like_count":3},{"had_liked":false,"id":22609,"user_name":"搬砖匠","can_delete":false,"product_type":"c1","uid":1214120,"ip_address":"","ucode":"3D2D7C1FD14DB6","user_header":"https://static001.geekbang.org/account/avatar/00/12/86/a8/427879a9.jpg","comment_is_top":false,"comment_ctime":1535852011,"is_pvip":false,"replies":[{"id":"8182","content":"对，restful的优势就是开放耦合度低","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1535945596,"ip_address":"","comment_id":22609,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10125786603","product_id":100014401,"comment_content":"我们的服务会提供给前端的外网和公司内部其他业务部门之间内网的调用，所以restful API是更合适的选择，另外我觉得restful方式也相对较轻量级简单，服务端与客户端的依赖程度较低，开发使用上来说效率很高。","like_count":3,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423188,"discussion_content":"对，restful的优势就是开放耦合度低","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535945596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22374,"user_name":"feimeng0532","can_delete":false,"product_type":"c1","uid":1182786,"ip_address":"","ucode":"427B5C9D65C62A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/42/fbd028c2.jpg","comment_is_top":false,"comment_ctime":1535636172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10125570764","product_id":100014401,"comment_content":"微博内容不用protobuf，用的什么？","like_count":2},{"had_liked":false,"id":22370,"user_name":"何磊","can_delete":false,"product_type":"c1","uid":1047604,"ip_address":"","ucode":"78934C3ED4A342","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fc/34/c733b116.jpg","comment_is_top":false,"comment_ctime":1535634616,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10125569208","product_id":100014401,"comment_content":"一个微服务应该能够同时支持rpc与http协议的调用。","like_count":2},{"had_liked":false,"id":22299,"user_name":"oddrock","can_delete":false,"product_type":"c1","uid":1037506,"ip_address":"","ucode":"55BADA192250B0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d4/c2/910d231e.jpg","comment_is_top":false,"comment_ctime":1535593374,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"10125527966","product_id":100014401,"comment_content":"老师好，提一个问题。<br>您说：“在这种方式下，如果服务提供者变更了接口定义，不仅需要更新服务提供者加载的接口描述文件 server.xml，还需要同时更新服务消费者加载的接口描述文件 client.xml。”<br><br>Xml文件里其实只有一行bean的配置和一行服务描述的配置，改起来并不麻烦啊，不知道老师你说的xml配置修改会带来较大麻烦指的是什么。<br>另外，这种情况，是需要服务端和客户端共享接口定义java类的，一旦出现变动，接口定义java类也要都改动吧。<br>但我还是对这种方式变更起来麻烦没有直观认识。","like_count":2,"discussions":[{"author":{"id":1177289,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f6/c9/4da2a82a.jpg","nickname":"黄大仙","note":"","ucode":"337B6E811CF47D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2044,"discussion_content":"假定修改这个xml，涉及到不同业务的几百甚至几千个微服务，协调不同产品线进行更新，测试，部署，可以想想麻烦程度。尤其是文章里提到的“底层服务”。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563197891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22285,"user_name":"不够","can_delete":false,"product_type":"c1","uid":1157094,"ip_address":"","ucode":"AD0FEB54535311","user_header":"https://static001.geekbang.org/account/avatar/00/11/a7/e6/4ce4016f.jpg","comment_is_top":false,"comment_ctime":1535592031,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10125526623","product_id":100014401,"comment_content":"我司的微服务大多数都是内部调用，比较在意性能，采用的xml，依赖相同的api接口，有接口变更时，一般就升级接口","like_count":2},{"had_liked":false,"id":22503,"user_name":"long.mr","can_delete":false,"product_type":"c1","uid":1071784,"ip_address":"","ucode":"F808C4E62BBCF1","user_header":"https://static001.geekbang.org/account/avatar/00/10/5a/a8/f25ec64c.jpg","comment_is_top":false,"comment_ctime":1535731293,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5830698589","product_id":100014401,"comment_content":"老师，刚刚说的消息字段太多的时候proto文件中添加字段的修改成本很大，实际上指的的是编译 发布成本吗? 就是依赖该服务端模块需要重新编译是吧?那字段多的时候应该考虑哪种方式呢，xml配置起来好麻烦，restful的话 同样也需要告知业务方让他们修改对应的客户端。 感觉好难选择，个人认为内部的话统一使用proto，对外提供服务时候，用rpc搭建一个http的server也是挺方便的吧。","like_count":1},{"had_liked":false,"id":338444,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1647505348,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647505348","product_id":100014401,"comment_content":"请教老师， 是不是要有一个 服务描述的平台，<br>让大家上去看 都有哪些服务接口。<br>还是说 口头沟通， 人工传输 接口文件。","like_count":0},{"had_liked":false,"id":323303,"user_name":"去冰不要糖","can_delete":false,"product_type":"c1","uid":2351354,"ip_address":"","ucode":"EF84E66D42E00A","user_header":"","comment_is_top":false,"comment_ctime":1637826916,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637826916","product_id":100014401,"comment_content":"针对我们目前的业务场景，如果要进行服务化，我觉得XML 配置方式服务描述最合适：因为我们系统只与企业内部之间的服务进行调用，且都是 Java 语言，即使调用外部服务接口，也是通过一个中间服务平台去调用的，所以选择 XML 配置方式是最简单的","like_count":0},{"had_liked":false,"id":317125,"user_name":"越锋利","can_delete":false,"product_type":"c1","uid":2815900,"ip_address":"","ucode":"63E9E3F3C7D53D","user_header":"https://static001.geekbang.org/account/avatar/00/2a/f7/9c/69c5c5dc.jpg","comment_is_top":false,"comment_ctime":1634693014,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634693014","product_id":100014401,"comment_content":"咦？怎么没有人用 openAPI&#47;swagger codegen 的吗","like_count":0},{"had_liked":false,"id":309468,"user_name":"Sch0ng","can_delete":false,"product_type":"c1","uid":1145554,"ip_address":"","ucode":"73F6113931B1AC","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/d2/4ba67c0c.jpg","comment_is_top":false,"comment_ctime":1630150504,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630150504","product_id":100014401,"comment_content":"RESTful API对比IDL，都是跨平台跨语言，gRPC协议使用的protobuf性能更高，RESTful容错性兼容性更好。","like_count":0},{"had_liked":false,"id":307053,"user_name":"魏*_*琛","can_delete":false,"product_type":"c1","uid":1103233,"ip_address":"","ucode":"2300C25193BBE0","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/81/316c7c90.jpg","comment_is_top":false,"comment_ctime":1628841603,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628841603","product_id":100014401,"comment_content":"使用过thrift,就是一个修改，两边都要同步，比较麻烦","like_count":0},{"had_liked":false,"id":297861,"user_name":"菠萝吹雪—Code","can_delete":false,"product_type":"c1","uid":1650378,"ip_address":"","ucode":"A5B2FC661EE17D","user_header":"https://static001.geekbang.org/account/avatar/00/19/2e/ca/469f7266.jpg","comment_is_top":false,"comment_ctime":1623821253,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1623821253","product_id":100014401,"comment_content":"使用最多的是RESTful API、IDL","like_count":0},{"had_liked":false,"id":284294,"user_name":"Jason180915","can_delete":false,"product_type":"c1","uid":2425528,"ip_address":"","ucode":"44FC6729FBDDCA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK40RCxCdCaKfDiaz9Ia8g4nNyUM8wJxAGfm9ZmG5wSMQeuhgqjibGzaibBkYcGxDV8vpxhvoFcF1vyw/132","comment_is_top":false,"comment_ctime":1616152811,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1616152811","product_id":100014401,"comment_content":"以前的soap协议属于哪一种呢","like_count":0,"discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"程序员9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381992,"discussion_content":"xml","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625364629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230141,"user_name":"懵not萌de","can_delete":false,"product_type":"c1","uid":1538657,"ip_address":"","ucode":"58871D47527212","user_header":"https://static001.geekbang.org/account/avatar/00/17/7a/61/c2ffe31a.jpg","comment_is_top":false,"comment_ctime":1593273344,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1593273344","product_id":100014401,"comment_content":"http的可靠性和安全性没有另外两个好是不是","like_count":0},{"had_liked":false,"id":227087,"user_name":"张良","can_delete":false,"product_type":"c1","uid":1249479,"ip_address":"","ucode":"9E91B0C0082735","user_header":"https://static001.geekbang.org/account/avatar/00/13/10/c7/e766861a.jpg","comment_is_top":false,"comment_ctime":1592279036,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1592279036","product_id":100014401,"comment_content":"这里的对内和对外是什么意思","like_count":0,"discussions":[{"author":{"id":1257750,"avatar":"https://static001.geekbang.org/account/avatar/00/13/31/16/f2269e73.jpg","nickname":"better","note":"","ucode":"2B9BCCED753D7F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309073,"discussion_content":"对内，只面向公司内网，公司以外的网络无法调用或访问。   对外，面向外部的Internet网络(简单理解就是能上网的人，只要知道了对外接口，就能调用这个对外接口)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601185065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220892,"user_name":"蓝猫","can_delete":false,"product_type":"c1","uid":1128676,"ip_address":"","ucode":"A2E11FF854013C","user_header":"https://static001.geekbang.org/account/avatar/00/11/38/e4/17ffa30b.jpg","comment_is_top":false,"comment_ctime":1590334517,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590334517","product_id":100014401,"comment_content":"作为自动化办公系统，一般需要对外提供待办查询接口及待办工作办理等相关接口；接口调用方有内部的也有外部系统，而且对性能也要求不高，因此用restful api最合适","like_count":0},{"had_liked":false,"id":187315,"user_name":"祺超","can_delete":false,"product_type":"c1","uid":1001838,"ip_address":"","ucode":"C5501E502BDE5A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/6e/2923566c.jpg","comment_is_top":false,"comment_ctime":1584082391,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584082391","product_id":100014401,"comment_content":"我觉得这里可以把ServiceConfig的export过程简单展开讲讲，您这里说的XML方式只是基于Spring的服务发布方式，实际上Motan已经支持注解的方式去配置了，感觉这块容易产生误解，当然如果把编程模型与服务发布解耦开来讲又太抽象","like_count":0},{"had_liked":false,"id":185674,"user_name":"隰有荷","can_delete":false,"product_type":"c1","uid":1357944,"ip_address":"","ucode":"2BE9A32AB28963","user_header":"https://static001.geekbang.org/account/avatar/00/14/b8/78/2828195b.jpg","comment_is_top":false,"comment_ctime":1583660961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583660961","product_id":100014401,"comment_content":"摊牌了，那就用RESTful API吧","like_count":0},{"had_liked":false,"id":104090,"user_name":"Andrew DP","can_delete":false,"product_type":"c1","uid":1108673,"ip_address":"","ucode":"814BBD97587BC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/ea/c1/3a0eb385.jpg","comment_is_top":false,"comment_ctime":1560649052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560649052","product_id":100014401,"comment_content":"老师说的IDL 文件不适合字段比较多的接口定义，是不是可以将非常多的字段封装成一个特定格式对象，比如JSONObject，这样就不存在参数变更需要同步所有消费者的影响了","like_count":0},{"had_liked":false,"id":101201,"user_name":"Tattoo","can_delete":false,"product_type":"c1","uid":1036503,"ip_address":"","ucode":"CE926AC8582C96","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d0/d7/a09ef784.jpg","comment_is_top":false,"comment_ctime":1559740531,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559740531","product_id":100014401,"comment_content":"在想是不是应该还有 yaml ?？","like_count":0},{"had_liked":false,"id":101199,"user_name":"Tattoo","can_delete":false,"product_type":"c1","uid":1036503,"ip_address":"","ucode":"CE926AC8582C96","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d0/d7/a09ef784.jpg","comment_is_top":false,"comment_ctime":1559739520,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1559739520","product_id":100014401,"comment_content":"所有您对于您那个问题采取的是什么方式呐？","like_count":0},{"had_liked":false,"id":100630,"user_name":"sun","can_delete":false,"product_type":"c1","uid":1076100,"ip_address":"","ucode":"0358B9288D4018","user_header":"https://static001.geekbang.org/account/avatar/00/10/6b/84/d1e6eac9.jpg","comment_is_top":false,"comment_ctime":1559608161,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559608161","product_id":100014401,"comment_content":"单体应用响应要求这么高吗","like_count":0},{"had_liked":false,"id":96845,"user_name":"六维","can_delete":false,"product_type":"c1","uid":1022887,"ip_address":"","ucode":"EB1C15AC06A8DF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/a7/440aff07.jpg","comment_is_top":false,"comment_ctime":1558518871,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558518871","product_id":100014401,"comment_content":"因公司的技术栈，有PHP和Java，可采用RESTful API或者IDL文件服务描述，以目前业务上的取舍（业务需求变化较快，一个功能调整较为频繁），RESTful API的方式更为合适。另外也需要根据不同的项目来区分，个别的项目采用了IDL文件的服务描述方式。","like_count":0},{"had_liked":false,"id":48166,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1544377860,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1544377860","product_id":100014401,"comment_content":"作者写的挺清楚的，配合给出的示例代码看，效果更好。<br>之前的项目中，大部分用的都是RESTful，没有在实战中用过IDL，得先去找些相关资料熟悉一下，作为以后项目技术选型的技术储备。","like_count":0},{"had_liked":false,"id":30980,"user_name":"Douglas","can_delete":false,"product_type":"c1","uid":1073027,"ip_address":"","ucode":"CFDE3D76B9DAE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/83/bb728e53.jpg","comment_is_top":false,"comment_ctime":1539056215,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539056215","product_id":100014401,"comment_content":"老师我想问下，如果一个微服务同时提供 rpc 调用和 http 调用， 那工作线程岂不是要翻倍。对cpu 调度，以及内存 会有什么影响呢","like_count":0},{"had_liked":false,"id":30470,"user_name":"波波安","can_delete":false,"product_type":"c1","uid":1002452,"ip_address":"","ucode":"2A677908E5A75D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4b/d4/b7719327.jpg","comment_is_top":false,"comment_ctime":1538879659,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1538879659","product_id":100014401,"comment_content":"我们项目使用的是dubbo","like_count":0},{"had_liked":false,"id":29796,"user_name":"magic","can_delete":false,"product_type":"c1","uid":1024556,"ip_address":"","ucode":"A1BCF486381749","user_header":"","comment_is_top":false,"comment_ctime":1538543281,"is_pvip":false,"replies":[{"id":"10781","content":"看业务实际场景，对于大部分业务可以忽略，但对于一些延迟敏感型，比如接口本身耗时只有ms级别的，建议还是用rpc","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1538625181,"ip_address":"","comment_id":29796,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538543281","product_id":100014401,"comment_content":"不知道http比rpc性能差多少，有比较数据吗？","like_count":1,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425719,"discussion_content":"看业务实际场景，对于大部分业务可以忽略，但对于一些延迟敏感型，比如接口本身耗时只有ms级别的，建议还是用rpc","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538625181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25226,"user_name":"张鑫","can_delete":false,"product_type":"c1","uid":1030197,"ip_address":"","ucode":"9A0AE1DD952B59","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/35/86e333b9.jpg","comment_is_top":false,"comment_ctime":1537273041,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537273041","product_id":100014401,"comment_content":"想问下dubbo本质上也是采用xml方式提供服务的吧","like_count":0},{"had_liked":false,"id":24439,"user_name":"libocz","can_delete":false,"product_type":"c1","uid":1227392,"ip_address":"","ucode":"9DC917019EB2CA","user_header":"https://static001.geekbang.org/account/avatar/00/12/ba/80/2b427c9c.jpg","comment_is_top":false,"comment_ctime":1537006405,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1537006405","product_id":100014401,"comment_content":"三种方式不都是跨语言的吗？RESTful API采用http协议，XML采用RPC，这两者之间因为不同的协议存在效率问题可以理解。但是IDL文件这种方式好像相比前两种，没有特别的优势，还需要使用工具来生成不同语言的版本，相比前两种似乎更为麻烦，而又没有明显的优点。求老师点明<br><br> ","like_count":0},{"had_liked":false,"id":24338,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1198347,"ip_address":"","ucode":"C91BB475625B20","user_header":"https://static001.geekbang.org/account/avatar/00/12/49/0b/db412e36.jpg","comment_is_top":false,"comment_ctime":1536911258,"is_pvip":false,"replies":[{"id":"8937","content":"对，只增加是向前兼容的","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536995707,"ip_address":"","comment_id":24338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1536911258","product_id":100014401,"comment_content":"protobuf如果只是增加字段的话，可以向前兼容","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423944,"discussion_content":"对，只增加是向前兼容的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536995707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24142,"user_name":"Violin","can_delete":false,"product_type":"c1","uid":1140715,"ip_address":"","ucode":"25BA978F662744","user_header":"https://static001.geekbang.org/account/avatar/00/11/67/eb/9a041634.jpg","comment_is_top":false,"comment_ctime":1536822984,"is_pvip":false,"replies":[{"id":"8872","content":"也不算伪服务吧","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536850377,"ip_address":"","comment_id":24142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1536822984","product_id":100014401,"comment_content":"我们现在的系统属于&quot;伪微服务&quot;类型的，内部用thrift，对外用restful","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423858,"discussion_content":"也不算伪服务吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536850377,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":23239,"user_name":"招耳","can_delete":false,"product_type":"c1","uid":1001825,"ip_address":"","ucode":"D163E1A6377CF6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/61/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1536229265,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536229265","product_id":100014401,"comment_content":"proto的话，客户端和服务端语言不一样，客户端的依赖要怎么处理呢","like_count":0},{"had_liked":false,"id":23067,"user_name":"Fxjeep","can_delete":false,"product_type":"c1","uid":1213485,"ip_address":"","ucode":"6FF8E5B7119FCD","user_header":"https://static001.geekbang.org/account/avatar/00/12/84/2d/7f6555c7.jpg","comment_is_top":false,"comment_ctime":1536133639,"is_pvip":false,"replies":[{"id":"8356","content":"这个我不太了解啊，抱歉","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536144723,"ip_address":"","comment_id":23067,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1536133639","product_id":100014401,"comment_content":"能否略微提及一下.net下相应的工具和库？","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423399,"discussion_content":"这个我不太了解啊，抱歉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536144723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1091684,"avatar":"https://static001.geekbang.org/account/avatar/00/10/a8/64/965e0d9b.jpg","nickname":"王维","note":"","ucode":"836E6CDB1A56BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588090,"discussion_content":"restful通信用net下的webapi.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663551250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖南"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22860,"user_name":"耳东陈","can_delete":false,"product_type":"c1","uid":1206191,"ip_address":"","ucode":"B4690A79637BA9","user_header":"https://static001.geekbang.org/account/avatar/00/12/67/af/b2df8ca6.jpg","comment_is_top":false,"comment_ctime":1536020806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1536020806","product_id":100014401,"comment_content":"服务规范、服务描述之前通过文档规范的，服务稍有改动跨部门沟通是个烦心事，现在通过Swagger解决","like_count":0},{"had_liked":false,"id":22811,"user_name":"lgtao","can_delete":false,"product_type":"c1","uid":1022718,"ip_address":"","ucode":"5854B3CBAC87CC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9a/fe/3e37a60e.jpg","comment_is_top":false,"comment_ctime":1535981880,"is_pvip":false,"replies":[{"id":"8231","content":"前几期录音还没习惯，后面逐步调整过来了，辛苦听录音了","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536027074,"ip_address":"","comment_id":22811,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535981880","product_id":100014401,"comment_content":"胡老师的语速稍快","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423276,"discussion_content":"前几期录音还没习惯，后面逐步调整过来了，辛苦听录音了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536027074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22796,"user_name":"沈重华","can_delete":false,"product_type":"c1","uid":1213839,"ip_address":"","ucode":"1E872254196744","user_header":"https://static001.geekbang.org/account/avatar/00/12/85/8f/3d796345.jpg","comment_is_top":false,"comment_ctime":1535977140,"is_pvip":false,"replies":[{"id":"8233","content":"后面会有专门讲解xml方式服务发布与引用的过程","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1536027113,"ip_address":"","comment_id":22796,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535977140","product_id":100014401,"comment_content":"老师xml的方式，能更具体一些吗？","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423268,"discussion_content":"后面会有专门讲解xml方式服务发布与引用的过程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1536027113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22643,"user_name":"金hb.Ryan 冷空氣駕到","can_delete":false,"product_type":"c1","uid":1222233,"ip_address":"","ucode":"CAD363576696E4","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/59/1689ea0c.jpg","comment_is_top":false,"comment_ctime":1535881325,"is_pvip":false,"replies":[{"id":"8181","content":"可以理解http的描述语言是文档","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1535945504,"ip_address":"","comment_id":22643,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535881325","product_id":100014401,"comment_content":"有一个歧义，描述语言和通信协议没关系吧，只是http 协议不用再写stub所以省略了描述语言","like_count":1,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423204,"discussion_content":"可以理解http的描述语言是文档","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535945504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22596,"user_name":"樊铮","can_delete":false,"product_type":"c1","uid":1216032,"ip_address":"","ucode":"42F293BA437BE9","user_header":"https://static001.geekbang.org/account/avatar/00/12/8e/20/8aafbc00.jpg","comment_is_top":false,"comment_ctime":1535814767,"is_pvip":false,"replies":[{"id":"8183","content":"也是一个思路","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1535945618,"ip_address":"","comment_id":22596,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535814767","product_id":100014401,"comment_content":"把每个服务的api注册到 consul中，使用swoole 做rpc  。","like_count":1,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423181,"discussion_content":"也是一个思路","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535945618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22500,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1535727551,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1535727551","product_id":100014401,"comment_content":"目前项目在用RESTful，请问在性能方面，IDL会比RESTful快多少？有业界可对比案例和数据吗？","like_count":0},{"had_liked":false,"id":22476,"user_name":"。","can_delete":false,"product_type":"c1","uid":1222200,"ip_address":"","ucode":"75B163F01F20F3","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/38/55483b8c.jpg","comment_is_top":false,"comment_ctime":1535700473,"is_pvip":false,"replies":[{"id":"8118","content":"简单易读吧","user_name":"作者回复","user_name_real":"古月中心相心","uid":"1010144","ctime":1535814706,"ip_address":"","comment_id":22476,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535700473","product_id":100014401,"comment_content":"Spring cloud 为啥在服务内部也用restful api呢？","like_count":0,"discussions":[{"author":{"id":1010144,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/69/e0/ff8ee2e2.jpg","nickname":"胡忠想","note":"","ucode":"0792605FC265B4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423137,"discussion_content":"简单易读吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535814706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22389,"user_name":"blackpiglet","can_delete":false,"product_type":"c1","uid":1032928,"ip_address":"","ucode":"58AA8329C91767","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/e0/7188aa0a.jpg","comment_is_top":false,"comment_ctime":1535642357,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535642357","product_id":100014401,"comment_content":"如果是微服务，IDL理论上是最佳选择，原因是微服务间都是内部调用，需要考虑性能，所以 restful 不合适；另外微服务可能存在跨语言问题，那么xml 形式的大部分都是针对单一语言的，IDL 更有优势。<br>但到实际场景就不好说了，要根据具体情况来判断。","like_count":0},{"had_liked":false,"id":22335,"user_name":"面向加薪学习","can_delete":false,"product_type":"c1","uid":1108117,"ip_address":"","ucode":"5164A1DF058AC5","user_header":"https://static001.geekbang.org/account/avatar/00/10/e8/95/13b88119.jpg","comment_is_top":false,"comment_ctime":1535609189,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535609189","product_id":100014401,"comment_content":"以前有过一个项目通过thrift做的，Java和c#,java做服务端，c#做客户端","like_count":0},{"had_liked":false,"id":22297,"user_name":"michael","can_delete":false,"product_type":"c1","uid":1005835,"ip_address":"","ucode":"69738B5801F0FD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/59/0b/fb876077.jpg","comment_is_top":false,"comment_ctime":1535593005,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535593005","product_id":100014401,"comment_content":"老师，Restful和xml的实现方式，当服务端请求或返回数据改变时也存在消费端同步更新的问题吧？为什么说IDL方式修改成本更高呢？","like_count":0},{"had_liked":false,"id":22295,"user_name":"eason2017","can_delete":false,"product_type":"c1","uid":1009422,"ip_address":"","ucode":"E070BA624FA490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/0e/c77ad9b1.jpg","comment_is_top":false,"comment_ctime":1535592872,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535592872","product_id":100014401,"comment_content":"老师好，请问咱们的接口采用的什么方式呢？谢谢","like_count":0},{"had_liked":false,"id":22289,"user_name":"eason2017","can_delete":false,"product_type":"c1","uid":1009422,"ip_address":"","ucode":"E070BA624FA490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/0e/c77ad9b1.jpg","comment_is_top":false,"comment_ctime":1535592596,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535592596","product_id":100014401,"comment_content":"现在公司内部都是以http接口的方式进行通信的，主要源于公司内部基于dubbo封装后的框架存在很多问题，如果一定要用rpc方式，也是业务团队默默的采用了原生的dubbo框架，进而为调用方提供服务。","like_count":0},{"had_liked":false,"id":22287,"user_name":"松花皮蛋me","can_delete":false,"product_type":"c1","uid":1000054,"ip_address":"","ucode":"B0846CEEF6B0D1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/76/256bbd43.jpg","comment_is_top":false,"comment_ctime":1535592075,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1535592075","product_id":100014401,"comment_content":"还是推荐xml方式，可以优化为长连接","like_count":0,"discussions":[{"author":{"id":1257750,"avatar":"https://static001.geekbang.org/account/avatar/00/13/31/16/f2269e73.jpg","nickname":"better","note":"","ucode":"2B9BCCED753D7F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309074,"discussion_content":"如何优化呢，能举个例子么","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601185357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22286,"user_name":"王宏达达达","can_delete":false,"product_type":"c1","uid":1021829,"ip_address":"","ucode":"F6D2348EE216DE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/97/85/219709fd.jpg","comment_is_top":false,"comment_ctime":1535592068,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535592068","product_id":100014401,"comment_content":"我们用RESTful API来提供服务信息，首先简单高效，其次企内不需要太规范的情况下增加开发效率，最重要的是国内用的这种只需两个post和get其他都不需要用好像。我还是想问下，分布式是否就包含soa和微服务","like_count":0},{"had_liked":false,"id":22272,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1535590387,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1535590387","product_id":100014401,"comment_content":"服务的注册和发现，不是应该需要一个服务注册中心呢？","like_count":0},{"had_liked":false,"id":22264,"user_name":"stamaimer","can_delete":false,"product_type":"c1","uid":1014272,"ip_address":"","ucode":"A73B9DA55BDEFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/00/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1535589555,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535589555","product_id":100014401,"comment_content":"学习了","like_count":0},{"had_liked":false,"id":22261,"user_name":"stamaimer","can_delete":false,"product_type":"c1","uid":1014272,"ip_address":"","ucode":"A73B9DA55BDEFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/00/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1535589382,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535589382","product_id":100014401,"comment_content":"1.代码太多了<br>2.为什么对性能要求较高的场景就需要使用 XML，可以使用 JSON 之类的吗？<br>3.IDL 是一种语言，为什么最常见的 IDL 是两种协议？<br>4.Restful 也能实现跨语言调用，那么 Restful 和 IDL 在跨语言调用方面各有啥优缺点？","like_count":0},{"had_liked":false,"id":22258,"user_name":"stamaimer","can_delete":false,"product_type":"c1","uid":1014272,"ip_address":"","ucode":"A73B9DA55BDEFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/00/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1535589175,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535589175","product_id":100014401,"comment_content":"1.代码太多了<br>2.为什么对性能高就要使用 XML 描述接口，可以使用 JSON 吗？<br>3.IDL 是语言，为什么最常见的两种 IDL 是两种协议？<br>4.RESTful 也可以实现跨语言，RESTful 和 IDL 在跨语言调用方面各自的优缺点是什么？","like_count":0},{"had_liked":false,"id":22240,"user_name":"fish","can_delete":false,"product_type":"c1","uid":1065489,"ip_address":"","ucode":"16CE1FE1BF1921","user_header":"https://static001.geekbang.org/account/avatar/00/10/42/11/ce9e55ec.jpg","comment_is_top":false,"comment_ctime":1535587864,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1535587864","product_id":100014401,"comment_content":"采用protobuf如果遇到web前端是不是最佳实践还得在protobuf上面再封一层restful返回给页面","like_count":0}]}