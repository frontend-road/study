{"id":193617,"title":"43 | MongoDB典型案例（二）","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":189262,"user_name":"李英权","can_delete":false,"product_type":"c3","uid":1076081,"ip_address":"","ucode":"FECAC14A9C414B","user_header":"https://static001.geekbang.org/account/avatar/00/10/6b/71/e833b14a.jpg","comment_is_top":false,"comment_ctime":1584494344,"is_pvip":false,"replies":[{"id":73193,"content":"字节跳动","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1584626279,"ip_address":"","comment_id":189262,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"7个亿的dau，是腾讯吧？","like_count":4,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487654,"discussion_content":"字节跳动","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584626279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1747994,"avatar":"","nickname":"Explorer0","note":"","ucode":"73FB5833A7CDB2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273886,"discussion_content":"看到app很多我就知道，还有那个对象存储","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590506331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":178860,"user_name":"qbit","can_delete":false,"product_type":"c3","uid":1262927,"ip_address":"","ucode":"96C70A1E47B93D","user_header":"https://static001.geekbang.org/account/avatar/00/13/45/4f/f94caf47.jpg","comment_is_top":false,"comment_ctime":1581841907,"is_pvip":false,"replies":[{"id":69457,"content":"谢谢！","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1581858834,"ip_address":"","comment_id":178860,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"数据库组合占比图出自： https:&#47;&#47;scalegrid.io&#47;blog&#47;2019-database-trends-sql-vs-nosql-top-databases-single-vs-multiple-database-use&#47;","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483997,"discussion_content":"谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581858834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176086,"user_name":"小徐","can_delete":false,"product_type":"c3","uid":1303757,"ip_address":"","ucode":"522B5CD3732313","user_header":"https://static001.geekbang.org/account/avatar/00/13/e4/cd/fc140973.jpg","comment_is_top":false,"comment_ctime":1580953786,"is_pvip":false,"replies":[{"id":68554,"content":"总得有人吃螃蟹呀。。。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1581090673,"ip_address":"","comment_id":176086,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"这个改造都是涉及到事务吧，这个好多人还是担心mongo事务","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483013,"discussion_content":"总得有人吃螃蟹呀。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581090673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185156,"user_name":"奔奔奔跑","can_delete":false,"product_type":"c3","uid":1210265,"ip_address":"","ucode":"F86EC205DCAACE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Gswh7ibY4tubXhp0BXOmV2pXZ3XsXic1d942ZMAEgWrRSF99bDskOTsG1g172ibORXxSCWTn9HWUX5vSSUVWU5I4A/132","comment_is_top":false,"comment_ctime":1583500295,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，请教一个问题，我从开始跟着老师课程一直到这节课，我收获了mongo模型设计，索引设计，分片集群片键选择，感觉自己mongo的知识得到了爆炸式增长。但是实际工作中，因为用到mongo做各种数据花式聚合的机会少，导致自己mongo查询语句能力提升较慢，请问老师有什么好的方法可以提升我mongo查询语句编写能力呢？","like_count":1},{"had_liked":false,"id":358249,"user_name":"滴掉的华丽","can_delete":false,"product_type":"c3","uid":1986199,"ip_address":"北京","ucode":"1F0C3B66D4AE9B","user_header":"https://static001.geekbang.org/account/avatar/00/1e/4e/97/7da630b8.jpg","comment_is_top":false,"comment_ctime":1664115276,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"唐老师，网盘的应用案例里，2PB数据，只有100多个分片，那么每个分片要存储200T的数据，1是单个机器能挂这么大的硬盘吗？2是这样会影响查询效率吗？我隐约记得您说的单个机器存2到3T的数据比较合适，分片最多1024个，我还以为mongo适合存储的数据只有2到3PB","like_count":0},{"had_liked":false,"id":225168,"user_name":"周佳艺","can_delete":false,"product_type":"c3","uid":2010286,"ip_address":"","ucode":"6BBA7D7994B228","user_header":"","comment_is_top":false,"comment_ctime":1591671997,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"7个亿的dau，300TB，不是很大啊..存的不久吧","like_count":0,"discussions":[{"author":{"id":1003784,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/51/08/4b2d2499.jpg","nickname":"JohnnyB0Y","note":"","ucode":"805A3EF7B62227","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346088,"discussion_content":"300PB","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611855433,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183786,"user_name":"沈洪彬","can_delete":false,"product_type":"c3","uid":1458200,"ip_address":"","ucode":"F9911236D0BA1C","user_header":"https://static001.geekbang.org/account/avatar/00/16/40/18/cc3804e2.jpg","comment_is_top":false,"comment_ctime":1583133953,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"问个问题：\n    mongodb最大的优势时json类型的数据格式，可以减轻关系型的多表join这种无限冗余，那么mongodb在设计的时候有没有业界公认的层级限制（这里指的json一半最好限制多少层）。一般多少层支持都无压力，还是建议最好少于多少层（不考虑16M限制和超长内容字段）\n    层数是这个：   {&quot;a&quot;:{&quot;b&quot;:{&quot;c&quot;:{&quot;d&quot;:{&quot;e&quot;:{}}}}}}    这种json套json一般最好少于多少层\n                         {&quot;a&quot;:[&quot;xx&quot;,&quot;xx&quot;]}                   这种json套list是不是也有建议限制","like_count":0}]}