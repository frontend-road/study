{"id":137836,"title":"29 | 如何使用Medooze 实现多方视频会议？","content":"<p>前面我们通过两篇文章详细介绍了 Medooze 的实现逻辑，我相信你现在已经对 Medooze 有了非常深刻的认知。通过对Medooze实现原理和架构的了解，我们可以知道Medooze支持的功能非常多，如录制回放、推流、SFU 等，其中最主要的功能是 SFU 的实现。</p><p>实际上，<strong>我们要实现的多方音视频会议就是由 SFU 来实现的，或者你可以认为Medooz实现的 SFU 就是一个最简单的音视频会议系统</strong>。Medooze 提供的 SFU Demo 的地址为：<a href=\"https://github.com/medooze/sfu\">https://github.com/medooze/sfu</a> 。</p><p>由于 SFU 是一个 Node.js 项目，所以在环境部署、源码分析的时候，需要你有 JavaScript 基础，也需要掌握 NPM 和 Node 的常用命令，比如 npm install 等。接下来，我们主要从以下几方面向你介绍一下多方音视频会议（SFU）项目：</p><ul>\n<li>搭建多方音视频会议系统，让你感受一下多方通信；</li>\n<li>分析多方音视频会议实现的架构；</li>\n<li>分析 Medooze API 的具体使用；</li>\n<li>分析多方音视频会议的入会流程。</li>\n</ul><h2>多方音视频会议环境的搭建</h2><p>多方音视频会议（SFU）项目是纯 Node.js 实现的，可以说在目前所有的操作系统上都可以运行。然而，由于该系统依赖 medooze-media-server 项目，而该项目仅支持 macOS X 和 Linux 两种操作系统，所以 SFU 项目也只能在 macOS X 和 Linux 这两种操作系统下运行了。</p><!-- [[[read_end]]] --><p>本文我们所搭建的这个 Demo 的实验环境是在 Ubuntu 18.04 系统上，所以接下来的实验步骤和实验结论都是基于 Ubuntu 18.04 得出的，如果你在其他操作系统下搭建可能结果会略有不同，但具体步骤都是一模一样的。</p><p>下面我们就来分析下这个环境搭建的具体步骤。</p><p>第一步，打开 Linux 控制终端，下载 SFU 代码，命令如下：</p><pre><code>git clone https://github.com/medooze/sfu.git\n</code></pre><p>第二步，安装 SFU 依赖的所有包：</p><pre><code>cd sfu\nnpm install\n</code></pre><p>第三步，在 <code>sfu</code> 目录下生成自签名证书文件：</p><pre><code>openssl req -sha256 -days 3650 -newkey rsa:1024 -nodes -new -x509 -keyout server.key -out server.cert\n</code></pre><p>第四步，在 <code>sfu</code> 目录下启动服务：</p><pre><code>node index.js IP\n</code></pre><p>上面命令中的 IP 是测试机器的IP地址，如果用内网测试，你可以将它设置为 127.0.0.1。如果你想用外网访问，则可以指定你的云主机的外网IP地址。另外需要注意的是，该服务启动后默认监听的端口是 8084，<strong>所以你在访问该服务时要指定端口为8084</strong>。</p><p>通过上面的步骤，我们就将 Medooze 的 SFU 服务器搭建好了，下面我们来测试一下。</p><p>打开浏览器，在地址栏中输入以下地址就可以打开 Medooze SFU Demo 的测试界面了：</p><pre><code>https://IP:8084/index.html\n</code></pre><p>在这个地址中需要特别注意的是，<strong>必须使用 HTTPS 协议，否则浏览器无法访问本地音视频设备</strong>。此外，这个地址中的 IP 指的是SFU服务的主机的IP地址，可以是内网地址，也可以是外网地址。</p><p>当该地址执行后，会弹出登录界面，如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/df/73/dfb0c325dfa9eef91cd56041259f2a73.png?wh=1142*830\" alt=\"\"></p><center><span class=\"reference\">Medooze SFU 登录界面图</span></center><p>这是一个多人视频会议登录界面。关于登录界面，这里我们做一个简单的说明。</p><ul>\n<li>界面中的Room Id 和 Name 可以随机生成，也可以自己指定。如果需要随机生成，点击后面的 RANDOM 按钮即可。</li>\n<li>几个参会人若想要进入同一个房间，那么他们的 Room Id 必须相同。</li>\n<li>在 Audio Device 列出了所有麦克风，可供参会人选择。</li>\n<li>在Audio Device下面，有一个音量进度条，它可以测试麦克风是否正常工作。</li>\n<li>一切准备就绪后，点击右下角的“READY!”按钮，就可以加入房间了。此时，在浏览器左下角显示了自己的本地视频。</li>\n<li>由于这是基于浏览器的音视频应用，具有很好的跨平台性，因此你可选择 PC浏览器、手机浏览器一起测试。</li>\n</ul><p>上面我们就将 Medooze 的音视频会议系统的 Demo 环境搭建好了，并且你可以进行多人的音视频互动了。接下来我们就分析一下这个音视频会议系统（SFU） Demo 是如何实现的吧。</p><h2>SFU 目录结构</h2><p>首先我们来分析看一下 Medooze 的 SFU Demo 的目录结构，以及每个子目录中代码的作用，为我们后面的分析做好准备。</p><p><img src=\"https://static001.geekbang.org/resource/image/06/29/06c09b7ebbee5cdb4e9c1de8ef42f629.png?wh=960*130\" alt=\"\"></p><p>如上图所示，在 SFU Demo 目录下的文件非常少，我们来看一下每个文件或目录的具体作用吧！</p><p><img src=\"https://static001.geekbang.org/resource/image/be/8e/becbb861d9775ad282513b3c451e268e.png?wh=1142*290\" alt=\"\"></p><p>了解了 SFU Demo 的目录结构及其作用后，我们再来看一下 SFU Demo 的架构是什么样子。</p><h2>SFU 架构</h2><p>下图就是 Medooze SFU Demo 的架构图，你可以参考下：</p><p><img src=\"https://static001.geekbang.org/resource/image/fc/e4/fc4bcb1763ec26052cfe9de5ca2e58e4.png?wh=1142*914\" alt=\"\"></p><center><span class=\"reference\">SFU架构图</span></center><p>从图中你可以看出，SFU 架构包括了<strong>浏览器客户端</strong>和<strong>SFU服务端</strong>两部分。而SFU服务端又包括两部分功能：WWW 服务、WebSocket信令及业务管理。</p><p>接下来我们就来分析一下<strong>服务端的处理逻辑</strong>。</p><p>Node.js中的 Web 服务器（WWW）是在 index.js 文件中实现的。当我们执行<code>node index.js IP</code>命令时，该命令启动了一个 HTTPS 服务，监听的端口是 8084。当 HTTPS 启动后，我们就可以从它的 WWW 服务获取到客户端代码了。需要说明的是，HTTPS 服务依赖 server.key 和 server.crt 文件，这两个文件需要我们提前生成好（生成证书的命令在上面 SFU 环境搭建一节已经向你做了说明）。</p><p>至于WebSocket 服务及业务管理部分，逻辑会稍微复杂些。服务端启动WebSocket服务后，可以通过它来接收客户端发来的信令，同时也可以通过它向客户端发送通知消息；除了对信令的处理外，SFU的业务逻辑也是在这部分实现的，如 Room 和 Participator 实例的创建、参会人进入/离开房间等。</p><p>这里需要你注意的是，WebSocket服务和业务管理的代码也是在 index.js中实现的。换句话说，在服务端的 index.js 中，实现了 WWW 服务、WebSocket服务和SFU业务管理三块逻辑，这样“大杂烩”的代码实现也只是在 Demo 中才能这么写了。另外，index.js 的实现依赖了 websocket 和 transaction-manager 两个包。</p><p>分析完服务端的处理逻辑后，接下来我们再来看看<strong>客户端</strong>。浏览器首先从 Medooze SFU 的 WWW服务上获得 sfu.js 代码，在浏览器上运行 sfu.js就可以与 Medooze SFU 建立连接，并进行多方音视频通信了。在 sfu.js 中，主要实现了房间的登录、音频设备选择、采集音视频数据、共享音视频数据等功能。实际上，客户端的实现逻辑就是使用咱们专栏第一模块所介绍的知识，如 RTCPeerConnection 的建立、获取音视频流、媒体协商等。</p><p>此外，Medooze SFU 还实现了几个信令，如 join 用于加入会议、update 用于通知客户端重新进行媒体协商等等，这几个信令还是非常简单的，不过却非常重要。尤其是在阅读Medooze SFU 代码时，可以按照信令的流转来梳理SFU的代码逻辑，这样会大大提高你的工作效率。</p><p>以上就是Medooze SFU 的基本架构，接下来我们看一下 SFU 的逻辑处理。</p><h2>SFU 逻辑处理</h2><p>SFU 的实现很简单。在服务端有两个重要的类，即<strong>Room</strong> 和 <strong>Participator</strong>。它们分别抽象了多人会议中的<strong>房间</strong>和<strong>参会人</strong>。为便于你理解，我画了一个简单类图，如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/f2/ad/f23f501a0453d24157633c2a1e62abad.png?wh=1142*266\" alt=\"\"></p><center><span class=\"reference\">SFU 类图</span></center><p>从图中可以看到，index.js 中定义了一个<strong>全局对象 Rooms</strong>，保存多个房间（Room）实例。</p><p><strong>Room 类是对房间的抽象</strong>：</p><ul>\n<li>Endpoint 属性是 Medooze Endpoint 类型；</li>\n<li>Participators 属性是一个 Map 类型，保存本房间中所有 Participator 实例；</li>\n<li>该类还有两个重要方法，createParticipator 用于创建参会人实例，getStreams 获取所有参会人共享的媒体流。</li>\n</ul><p><strong>Participator 类是对参会人的抽象</strong>：</p><ul>\n<li>IncomingStreams 属性是 Map 类型，保存自己共享的媒体流，元素属性类型是 Medooze::IncomingStream；</li>\n<li>OutgoingStreams 属性是 Map 类型，保存自己观看的媒体流，元素属性类型是 Medooze::OutgoingStream；</li>\n<li>transport 属性是 Medooze::Transport 类型，表示 DTLS 传输；</li>\n<li>init() 方法，初始化 transport 实例等；</li>\n<li>publishStream() 方法用于发布自己共享的流，创建 IncomingStream；</li>\n<li>addStream() 方法用于观看其他参会人共享的流，创建 OutgoingStream 实例，并且 attachTo 到共享人的 IncomingStream 中。</li>\n</ul><h2>入会流程</h2><p>这里我们可以结合客户端和服务器的逻辑，分析一下参会人入会的大致流程，如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/97/92/97b0ecb3c212a626f2e29ed1dab84c92.jpg?wh=829*508\" alt=\"\"></p><center><span class=\"reference\">SFU 时序图</span></center><p>图中深粉部分是客户端实现，在 <code>www/js/sfu.js</code> 中；绿色部分是服务器实现，在 <code>index.js</code> 中；橘色是在 medooze 中实现。那具体的流程是怎样的呢？</p><p>首先，浏览器从 Node.js 服务器获取到 <code>www/index.html</code> 页面及引用的 JavaScript 脚本，然后执行 connect 方法。在 connect 方法中使用 WebSocket 与SFU服务（index.js）建立连接。</p><p>服务端收到 WebSocket 连接请求后，从 URL 中解析到 roomid 参数。然后，根据该参数判断房间是否在之前已经创建过。如果该房间已创建，则什么都不做；如果没创建，则尝试创建 Room 实例。</p><p>对于客户端来说，WebSocket 连接建立成功后，客户端会发送 join 信令到服务端。而服务端收到 join 信令后，创建 Participator（参与人）实例，并且调用它的 init 方法进行初始化。</p><p>之后，Participator 获取 Room 中所有已共享的媒体流，并调用它的 addStream 方法，这样它就可以订阅 Room 中所有的媒体流了。订阅成功后，媒体流的数据就被源源不断地发送给Participator对应的终端了。</p><p>上面的逻辑完成之后，服务端会通知客户端 join 已经成功。此时，客户端也可以共享它的音视频流给服务器了。</p><p>此外，在客户端将自己的媒体流推送给服务端之前，服务器会调用 publishStream 方法在服务端创建 IncomingStream 实例，这样当客户端的数据到达服务器端后，就可以将数据交给 IncomingStream 暂存起来，以备后面分发给其他终端。</p><p>通过上面的步骤，新加入的客户端就可以看到会议中其他人分享的音视频流了，同时还可以将自己的音视频推送到服务器了。但此时，其他参会人还看不到新加入用户的音视频流，因为还有关键的一步没有完成。</p><p>这<strong>关键的一步</strong>是，当新参会人一切准备就绪后，服务端要发送广播消息（update） 通知所有已经在会中的其他人，有新用户进来了，需要重新进行媒体协商。<strong>只有重新媒体协商之后，其他参会人才能看到新入会人的音视频流</strong>。</p><p>以上步骤就是一个新参会者加入会议的大致过程，同时也介绍了这个过程中其他已经在会中的参与人需要如何处理。</p><h2>小结</h2><p>本文我们首先介绍了通过 Medooze SFU 如何搭建最简单的音视频会议系统，该系统搭建好后就可以进行多人音视频互动的“实验”了。</p><p>然后，我们对Medooze 的 SFU 项目的逻辑做了详细介绍，分析了Medooze SFU的基本架构、逻辑处理、入会流程等。相信通过本文的学习，你对 Medooze 的使用和实现原理都会有更深刻的认识。</p><p>当然，如果你要想在自己的产品中更好地应用 Medooze，还需要掌握更多的细节，只有这样才能做到心中有数。比如：如何能够承担百万用户级的负载？如何为不同的的地区、不同的运营商的用户提供优质的服务？这些都是你需要进一步研究和学习的。</p><h2>思考时间</h2><p>今天留给你的思考题：一个多人存在的会议中，又有一个人加入进来，其他参会人是如何看到后加入人的视频流的呢？你清楚其中的原理吗？</p><p>欢迎在留言区与我分享你的想法，也欢迎你在留言区记录你的思考过程。感谢阅读，如果你觉得这篇文章对你有帮助的话，也欢迎把它分享给更多的朋友。</p><p></p>","comments":[{"had_liked":false,"id":261850,"user_name":"张昌海185","can_delete":false,"product_type":"c1","uid":1077784,"ip_address":"","ucode":"C047EEB16EF3DE","user_header":"https://static001.geekbang.org/account/avatar/00/10/72/18/a0b03020.jpg","comment_is_top":false,"comment_ctime":1605537740,"is_pvip":false,"replies":[{"id":"95275","content":"你看一下 SDP　那篇文章，里边有 SSRC，就是用这个来区分","user_name":"作者回复","comment_id":261850,"uid":"1507837","ip_address":"","utype":1,"ctime":1605767903,"user_name_real":"音视频专家-李超"}],"discussion_count":1,"race_medal":0,"score":"5900505036","product_id":100031801,"comment_content":"老师好，有个问题搞不清楚，就是sfu模式中多人通话，接收着怎么判断收到的媒体数据，是哪一个用户发出的呢？","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509636,"discussion_content":"你看一下 SDP　那篇文章，里边有 SSRC，就是用这个来区分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605767903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":151363,"user_name":"大魔王","can_delete":false,"product_type":"c1","uid":1308552,"ip_address":"","ucode":"5EB049D18E122F","user_header":"https://static001.geekbang.org/account/avatar/00/13/f7/88/da243c77.jpg","comment_is_top":false,"comment_ctime":1573706551,"is_pvip":false,"replies":[{"id":"58295","content":"medooze demo属于应用层，medooze-server-node是基础库，medooze demo 使用 meddoze-server-node 实现多人通信。","user_name":"作者回复","comment_id":151363,"uid":"1507837","ip_address":"","utype":1,"ctime":1573779776,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5868673847","product_id":100031801,"comment_content":"老师,这个和之前的medooze-server-node 区别是什么啊","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474455,"discussion_content":"medooze demo属于应用层，medooze-server-node是基础库，medooze demo 使用 meddoze-server-node 实现多人通信。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573779776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145699,"user_name":"No","can_delete":false,"product_type":"c1","uid":1470568,"ip_address":"","ucode":"542274058177E4","user_header":"https://static001.geekbang.org/account/avatar/00/16/70/68/0fc42e2d.jpg","comment_is_top":false,"comment_ctime":1572347923,"is_pvip":false,"replies":[{"id":"57405","content":"应该是 npm 版本的问题, 我这里的 npm 版本是 6.4.1","user_name":"作者回复","comment_id":145699,"uid":"1507837","ip_address":"","utype":1,"ctime":1573192088,"user_name_real":"garrylee"}],"discussion_count":5,"race_medal":0,"score":"5867315219","product_id":100031801,"comment_content":"&#47;src&#47;media-server_wrap.cxx: At global scope:<br>..&#47;src&#47;media-server_wrap.cxx:909:7: error: ‘Handle’ in namespace ‘v8’ does not name a template type<br>   v8::Handle&lt;v8::Value&gt; err;<br>       ^<br>..&#47;src&#47;media-server_wrap.cxx: In member function ‘virtual void OverloadErrorHandler::error(int, const char*)’:<br>..&#47;src&#47;media-server_wrap.cxx:904:5: error: ‘err’ was not declared in this scope<br>     err = v8::Exception::Error(SWIGV8_STRING_NEW(msg));<br>老师，我 npm install 的时候报错了。 这是nodejs 版本问题吗？<br><br>我的版本 <br> node -v v12.13.0<br> node-gyp -v v5.0.5<br>系统是 Ubuntu 16.04  ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472534,"discussion_content":"应该是 npm 版本的问题, 我这里的 npm 版本是 6.4.1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573192088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000620,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/ac/c84fa0c3.jpg","nickname":"Hadooper","note":"","ucode":"8F6ED4BF9E5AAB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":58398,"discussion_content":"我是同样的问题，换了npm还是一样的报错","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1574673507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2350496,"avatar":"https://static001.geekbang.org/account/avatar/00/23/dd/a0/a94a9c7d.jpg","nickname":"～😄 ～","note":"","ucode":"064418636AFFD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344747,"discussion_content":"这个问题解决了吗？怎么解决的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611567065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1988170,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/3giaicn2VaDJicDD7WnaT9mB5VbaF6J7aQszN4W9BVmSWmKoVFxTuN7iaDDgrKhlFp49k1iacvjMYSH3eejVbaH0Vhw/132","nickname":"sam","note":"","ucode":"D9DFFABC941E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290272,"discussion_content":"这个是node版本问题，退到11就行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594393842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1175405,"avatar":"","nickname":"Randy586","note":"","ucode":"36DB4174145F45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194291,"discussion_content":"李老师，我用v12.16.1，也是报这错，是不是必须回退到6.x的版本？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583203201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335470,"user_name":"expecting","can_delete":false,"product_type":"c1","uid":1377376,"ip_address":"","ucode":"1528740DC34DF4","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/60/20c6a3f2.jpg","comment_is_top":false,"comment_ctime":1645529963,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645529963","product_id":100031801,"comment_content":"sfu.js里的有些方法已经废弃，需要更新才能跑起来<br>createEncodedVideoStreams --&gt; createEncodedStreams<br>forceEncodedVideoInsertableStreams --&gt; encodedInsertableStreams<br>readableStream --&gt; readable<br>writableStream --&gt; writable","like_count":0},{"had_liked":false,"id":332227,"user_name":"强者之风","can_delete":false,"product_type":"c1","uid":1500643,"ip_address":"","ucode":"E7608F908B87E1","user_header":"https://static001.geekbang.org/account/avatar/00/16/e5/e3/06aa87b5.jpg","comment_is_top":false,"comment_ctime":1643100264,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643100264","product_id":100031801,"comment_content":"李老师我确认一下，sfu demo，是不是npm install 就可以了， 不需要另外编译medooze-server-node，sfu依赖有medooze-server-node,npm install 会自动编译。","like_count":0},{"had_liked":false,"id":318248,"user_name":"Geek_f6186b","can_delete":false,"product_type":"c1","uid":2825285,"ip_address":"","ucode":"C7CBC4D59B2403","user_header":"","comment_is_top":false,"comment_ctime":1635215428,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635215428","product_id":100031801,"comment_content":"老师，您好，请问下为什么登录不上去了呢？？我按照您的要求都搭建成功了。可是就登录不上去哇，","like_count":0},{"had_liked":false,"id":290158,"user_name":"阿良","can_delete":false,"product_type":"c1","uid":1969314,"ip_address":"","ucode":"AD8EBD69D38DC0","user_header":"https://static001.geekbang.org/account/avatar/00/1e/0c/a2/14c30983.jpg","comment_is_top":false,"comment_ctime":1619407503,"is_pvip":false,"replies":[{"id":"105419","content":"你的服务器部署在自己本机吗？","user_name":"作者回复","comment_id":290158,"uid":"1507837","ip_address":"","utype":1,"ctime":1619870593,"user_name_real":"音视频专家-李超"}],"discussion_count":2,"race_medal":0,"score":"1619407503","product_id":100031801,"comment_content":"老师你好，我搭建medooze之后，服务顺利跑起来了，但是只能看到自己的图像，而没法看到其他人的。我调试发现他们的video的id编码不一致，想往这方面调试，但是在评论区没看到小伙伴有这样的问题，所以想跟老师请教下，我遇到的这个问题有可能是什么引起的？如有可能，能否提供测试可以正常使用的demo，感谢~","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519127,"discussion_content":"你的服务器部署在自己本机吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619870593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1969314,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/0c/a2/14c30983.jpg","nickname":"阿良","note":"","ucode":"AD8EBD69D38DC0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580654,"discussion_content":"部署到内网服务器上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658306628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288627,"user_name":"Her later","can_delete":false,"product_type":"c1","uid":2033044,"ip_address":"","ucode":"85BDB2DC93C0F2","user_header":"https://static001.geekbang.org/account/avatar/00/1f/05/94/e55abef3.jpg","comment_is_top":false,"comment_ctime":1618566560,"is_pvip":false,"replies":[{"id":"105425","content":"服务端也是一个webrtc 客户端呀","user_name":"作者回复","comment_id":288627,"uid":"1507837","ip_address":"","utype":1,"ctime":1619871026,"user_name_real":"音视频专家-李超"}],"discussion_count":1,"race_medal":0,"score":"1618566560","product_id":100031801,"comment_content":"大佬 您好 ： <br>offer 和 answer 都是客户端自己创建的 ，那RTCPeerConnection  怎么知道要把流推到自己的中转服务器呢 。<br>服务器的配置信息是怎么得到的呢 ，是否offer和answer发送到信令服务器后 ，信令服务器对其进行了封装？ ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518687,"discussion_content":"服务端也是一个webrtc 客户端呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619871026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266844,"user_name":"会飞的猪","can_delete":false,"product_type":"c1","uid":1612014,"ip_address":"","ucode":"0C90B1DE7FB3E8","user_header":"https://static001.geekbang.org/account/avatar/00/18/98/ee/43bb6c11.jpg","comment_is_top":false,"comment_ctime":1607504120,"is_pvip":false,"replies":[{"id":"103811","content":"Medooze 录制出的应该是mp4v2 普通播放器放不了，你要用它提供的工具转一下","user_name":"作者回复","comment_id":266844,"uid":"1507837","ip_address":"","utype":1,"ctime":1617074294,"user_name_real":"音视频专家-李超"}],"discussion_count":1,"race_medal":0,"score":"1607504120","product_id":100031801,"comment_content":"老师，用medooze录制的mp4视频不能播放，您有遇到过吗？<br>const recorder = MediaServer.createRecorder (ts +&quot;.mp4&quot;,{<br>\t\t\trefresh : 1000,<br>\t\t\ttimeShift : 6000,<br>\t\t\tdisableHints : true,<br>\t\t\twaitForIntra: true<br>\t\t});<br>\t\trecorder.record(incomingStream);","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511407,"discussion_content":"Medooze 录制出的应该是mp4v2 普通播放器放不了，你要用它提供的工具转一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617074294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251946,"user_name":"张一画","can_delete":false,"product_type":"c1","uid":1935262,"ip_address":"","ucode":"53209E3BD46FC3","user_header":"https://static001.geekbang.org/account/avatar/00/1d/87/9e/e18f55ec.jpg","comment_is_top":false,"comment_ctime":1601995627,"is_pvip":false,"replies":[{"id":"94547","content":"证书有两个，一个是用于发布http客户端的证书；另一个是medooze自己传数据用的证书；<br><br>对于浏览器来说，必须用权威机构发布的，而medooze可以用自定义的。","user_name":"作者回复","comment_id":251946,"uid":"1507837","ip_address":"","utype":1,"ctime":1605004068,"user_name_real":"音视频专家-李超"}],"discussion_count":1,"race_medal":0,"score":"1601995627","product_id":100031801,"comment_content":"老师 我有一些不太理解 这一课里面的HTTPS证书为什么是自己生成 我记得您之前说必须是权威机构发布的证书","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506672,"discussion_content":"证书有两个，一个是用于发布http客户端的证书；另一个是medooze自己传数据用的证书；\n\n对于浏览器来说，必须用权威机构发布的，而medooze可以用自定义的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605004068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246527,"user_name":"Geek_sky","can_delete":false,"product_type":"c1","uid":1733288,"ip_address":"","ucode":"BBFE6FF1193873","user_header":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","comment_is_top":false,"comment_ctime":1599392412,"is_pvip":false,"replies":[{"id":"91441","content":"这是你自己的程序还是 demo报的错？","user_name":"作者回复","comment_id":246527,"uid":"1507837","ip_address":"","utype":1,"ctime":1600529678,"user_name_real":"音视频专家-李超"}],"discussion_count":3,"race_medal":0,"score":"1599392412","product_id":100031801,"comment_content":"老师，我这边连接的时候遇到这个问题：<br>VM479:1 Uncaught DOMException: Failed to execute &#39;createEncodedVideoStreams&#39; on &#39;RTCRtpSender&#39;: Encoded video streams not requested at PC initialization<br>    at eval (eval at ws.onopen (https:&#47;&#47;192.168.50.150:8084&#47;js&#47;sfu.js:264:36), &lt;anonymous&gt;:1:8)<br>    at WebSocket.ws.onopen (https:&#47;&#47;192.168.50.150:8084&#47;js&#47;sfu.js:264:36)<br>我换了createEncodedStreams，也不行。这是什么问题？chrome是不是需要设置什么？","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505174,"discussion_content":"这是你自己的程序还是 demo报的错？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600529678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1138916,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/e4/d2389115.jpg","nickname":"鉴鉴（Bill）","note":"","ucode":"D7CD780D817F68","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361965,"discussion_content":"这个方法已经被替换为 createEncodedStreams了，可以自己改下js。但是\nchrome浏览器和firefox的最新版都是会报错，估计需要老版本才行T_T","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616814463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1733288,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","nickname":"Geek_sky","note":"","ucode":"BBFE6FF1193873","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309400,"discussion_content":"是跑demo程序，使用chrome打开网页，在console中看到的报错。我接着就更新了chrome，发现还是有这个问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601279950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233701,"user_name":"sam","can_delete":false,"product_type":"c1","uid":1988170,"ip_address":"","ucode":"D9DFFABC941E6A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3giaicn2VaDJicDD7WnaT9mB5VbaF6J7aQszN4W9BVmSWmKoVFxTuN7iaDDgrKhlFp49k1iacvjMYSH3eejVbaH0Vhw/132","comment_is_top":false,"comment_ctime":1594394628,"is_pvip":false,"replies":[{"id":"87923","content":"可以打开浏览器的dev tools 看一下报啥错了","user_name":"作者回复","comment_id":233701,"uid":"1507837","ip_address":"","utype":1,"ctime":1596023911,"user_name_real":"音视频专家-李超"}],"discussion_count":2,"race_medal":0,"score":"1594394628","product_id":100031801,"comment_content":"跑起来后到页面加入房间，点ready后页面刷新一下还是弹窗让加入房间是什么情况，貌似也找不到log","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501137,"discussion_content":"可以打开浏览器的dev tools 看一下报啥错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596023911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1981915,"avatar":"","nickname":"宇宙之王","note":"","ucode":"5E6C28F8CCFF6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311119,"discussion_content":"哥们你是怎么跑起来的，怎么配置的啊能交流一下吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602228593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224056,"user_name":"行所当行","can_delete":false,"product_type":"c1","uid":1922457,"ip_address":"","ucode":"1B36BDA6D3562A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/WgRsoJMxcTMcDkRlR59jCDLux2JDdtz1G8Ophe3a7EnhP8lqOdFw8F7sURXkRTYXibzVicozrQ8HFYj578myJ0CA/132","comment_is_top":false,"comment_ctime":1591263657,"is_pvip":false,"replies":[{"id":"84442","content":"“insertable streams”，是最近的 端到端 加密技术，这个提示就你是chrome不支持，但不应该影响你正确的通话才对。","user_name":"作者回复","comment_id":224056,"uid":"1507837","ip_address":"","utype":1,"ctime":1592879069,"user_name_real":"音视频专家-李超"}],"discussion_count":8,"race_medal":0,"score":"1591263657","product_id":100031801,"comment_content":"老师你好，在客户端的chrome打开index.html，提示: Your browser does not support insertable streams，chrome版本83.0.4103.61(正式版本)(64位)，这个是浏览器版本问题吗？","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497348,"discussion_content":"“insertable streams”，是最近的 端到端 加密技术，这个提示就你是chrome不支持，但不应该影响你正确的通话才对。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592879069,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1768793,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/fd/59/7f653e69.jpg","nickname":"no ne","note":"","ucode":"15295B9864D4C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405656,"discussion_content":"这里面Crypto key不设置好像也行,报的错就是这个key值是空的.或者也可以把sfu.js里面的if (!supportsInsertableStreams)\n      dialog.querySelector(&#39;#key&#39;).parentElement.innerHTML =\n        &#39;<red>Your browser does not support insertable streams<red>&#39;注释掉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634613668,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1922457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/WgRsoJMxcTMcDkRlR59jCDLux2JDdtz1G8Ophe3a7EnhP8lqOdFw8F7sURXkRTYXibzVicozrQ8HFYj578myJ0CA/132","nickname":"行所当行","note":"","ucode":"1B36BDA6D3562A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285645,"discussion_content":"点了RANDOM按钮再点READY!按钮后，界面闪一下，标红了name的空栏，好像是想提示填写的名字有问题，可是具体什么问题不知道，换了几个名字也不行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592903438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103919,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d8/2f/43601694.jpg","nickname":"Patrick","note":"","ucode":"A49803CD6EB2C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280375,"discussion_content":"我也是这个问题，请问一下，解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591534365,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1922457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/WgRsoJMxcTMcDkRlR59jCDLux2JDdtz1G8Ophe3a7EnhP8lqOdFw8F7sURXkRTYXibzVicozrQ8HFYj578myJ0CA/132","nickname":"行所当行","note":"","ucode":"1B36BDA6D3562A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1103919,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d8/2f/43601694.jpg","nickname":"Patrick","note":"","ucode":"A49803CD6EB2C6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280836,"discussion_content":"没有，换了好几个版本的谷歌浏览器还是一样不行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591618845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":280375,"ip_address":""},"score":280836,"extra":""},{"author":{"id":1103919,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d8/2f/43601694.jpg","nickname":"Patrick","note":"","ucode":"A49803CD6EB2C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1922457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/WgRsoJMxcTMcDkRlR59jCDLux2JDdtz1G8Ophe3a7EnhP8lqOdFw8F7sURXkRTYXibzVicozrQ8HFYj578myJ0CA/132","nickname":"行所当行","note":"","ucode":"1B36BDA6D3562A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281418,"discussion_content":"checkout这个课程之前的最新版本就行了，我是这么搞的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591740992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":280836,"ip_address":""},"score":281418,"extra":""},{"author":{"id":1922457,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/WgRsoJMxcTMcDkRlR59jCDLux2JDdtz1G8Ophe3a7EnhP8lqOdFw8F7sURXkRTYXibzVicozrQ8HFYj578myJ0CA/132","nickname":"行所当行","note":"","ucode":"1B36BDA6D3562A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1103919,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d8/2f/43601694.jpg","nickname":"Patrick","note":"","ucode":"A49803CD6EB2C6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281597,"discussion_content":"麻烦问一下你具体用的哪个版本，我又试了69和77还是不行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591772504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":281418,"ip_address":""},"score":281597,"extra":""}]}]},{"had_liked":false,"id":215106,"user_name":"dayu","can_delete":false,"product_type":"c1","uid":1214458,"ip_address":"","ucode":"1C21338B85EADA","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/fa/403e82ea.jpg","comment_is_top":false,"comment_ctime":1588906044,"is_pvip":false,"replies":[{"id":"81388","content":"可以呀！","user_name":"作者回复","comment_id":215106,"uid":"1507837","ip_address":"","utype":1,"ctime":1590294332,"user_name_real":"音视频专家-李超"}],"discussion_count":1,"race_medal":0,"score":"1588906044","product_id":100031801,"comment_content":"老师，可以基于medooze开发安卓版的视频会议么？","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494318,"discussion_content":"可以呀！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590294332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194701,"user_name":"pyg","can_delete":false,"product_type":"c1","uid":1907014,"ip_address":"","ucode":"B236121671E113","user_header":"","comment_is_top":false,"comment_ctime":1585098302,"is_pvip":false,"replies":[{"id":"74303","content":"如果是本地的话一般不应该出现这个问题，你检查一下摄像头打开了吗？","user_name":"作者回复","comment_id":194701,"uid":"1507837","ip_address":"","utype":1,"ctime":1585204196,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1585098302","product_id":100031801,"comment_content":"老师我在本地运行了sfu服务，打开了两个Chrome窗口，但是互相看不见对方。哪些原因会导致这样呢？","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488875,"discussion_content":"如果是本地的话一般不应该出现这个问题，你检查一下摄像头打开了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585204196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1907014,"avatar":"","nickname":"pyg","note":"","ucode":"B236121671E113","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214663,"discussion_content":"是在外网，找到原因了，因为UDP端口没有开放。现在能看见对方了，但是貌似只能看见第一帧，后面视频就不动了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585223807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":194246,"user_name":"陈龙","can_delete":false,"product_type":"c1","uid":1859140,"ip_address":"","ucode":"FF9D40E72D3ED6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/xaL9uxibkT3AKspw9bPYXnsibQJztSjY1vxiceovK5UUHA3AsCCJEfJtR1fOzHxADz13OR8rktgQxIiaO1YOXsByiaQ/132","comment_is_top":false,"comment_ctime":1585041072,"is_pvip":false,"replies":[{"id":"74022","content":"你克隆代码时使用循环克隆试试，git clone --recursive https:&#47;&#47;xxxx.git","user_name":"作者回复","comment_id":194246,"uid":"1507837","ip_address":"","utype":1,"ctime":1585055971,"user_name_real":"garrylee"}],"discussion_count":4,"race_medal":0,"score":"1585041072","product_id":100031801,"comment_content":"老师，centOS 6.5 npm install 失败<br>make: *** [Release&#47;obj.target&#47;medooze-media-server&#47;src&#47;media-server_wrap.o] Error 1<br>make: *** Waiting for unfinished jobs....<br>..&#47;media-server&#47;src&#47;RTPTransport.cpp: In member function ‘int RTPTransport::SetLocalCryptoSDES(const char*, const uint8_t*, uint32_t)’:<br>..&#47;media-server&#47;src&#47;RTPTransport.cpp:219:22: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]<br>  if (len!=policy.rtp.cipher_key_len)<br>                      ^<br>..&#47;media-server&#47;src&#47;RTPTransport.cpp: In member function ‘int RTPTransport::SetRemoteCryptoSDES(const char*, const uint8_t*, uint32_t)’:<br>..&#47;media-server&#47;src&#47;RTPTransport.cpp:363:22: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]<br>  if (len!=policy.rtp.cipher_key_len)<br>                      ^<br>make: Leaving directory `&#47;home&#47;chenlong&#47;sfu-master&#47;node_modules&#47;medooze-media-server&#47;build&#39;<br>gyp ERR! build error <br>gyp ERR! stack Error: `make` failed with exit code: 2<br>gyp ERR! stack     at ChildProcess.onExit (&#47;home&#47;chenlong&#47;node-v12.16.1-linux-x64&#47;lib&#47;node_modules&#47;npm&#47;node_modules&#47;node-gyp&#47;lib&#47;build.js:194:23)<br>gyp ERR! stack     at ChildProcess.emit (events.js:311:20)<br>gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal&#47;child_process.js:275:12)<br>gyp ERR! System Linux 3.10.5-3.el6.x86_64<br>gyp ERR! command &quot;&#47;home&#47;chenlong&#47;node-v12.16.1-linux-x64&#47;bin&#47;node&quot; &quot;&#47;home&#47;chenlong&#47;node-v12.16.1-linux-x64&#47;lib&#47;node_modules&#47;npm&#47;node_modules&#47;node-gyp&#47;bin&#47;node-gyp.js&quot; &quot;rebuild&quot; &quot;--jobs=max&quot;<br>gyp ERR! cwd &#47;home&#47;chenlong&#47;sfu-master&#47;node_modules&#47;medooze-media-server<br>gyp ERR! node -v v12.16.1<br>gyp ERR! node-gyp -v v5.0.5<br>gyp ERR! not ok <br>npm ERR! code ELIFECYCLE<br>npm ERR! errno 1<br>npm ERR! medooze-media-server@0.27.2 install: `test -f build&#47;Release&#47;medooze-media-server.node || (node-gyp configure &amp;&amp; node-gyp rebuild --jobs=max)`<br>npm ERR! Exit status 1<br>npm ERR! <br>npm ERR! Failed at the medooze-media-server@0.27.2 install script.<br><br>","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488789,"discussion_content":"你克隆代码时使用循环克隆试试，git clone --recursive https://xxxx.git","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585055971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1935262,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/87/9e/e18f55ec.jpg","nickname":"张一画","note":"","ucode":"53209E3BD46FC3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310645,"discussion_content":"楼主后来解决了吗，我的centOS7也安装不行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601968877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225618,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b3/92/3fe36d79.jpg","nickname":"平衡之美","note":"","ucode":"810AE2EAF9918C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283251,"discussion_content":"怎么解决的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592223077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1859140,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/xaL9uxibkT3AKspw9bPYXnsibQJztSjY1vxiceovK5UUHA3AsCCJEfJtR1fOzHxADz13OR8rktgQxIiaO1YOXsByiaQ/132","nickname":"陈龙","note":"","ucode":"FF9D40E72D3ED6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216103,"discussion_content":"试过了，还是不行，可能这个项目最近有修改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585406235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":176420,"user_name":"檸檬稻","can_delete":false,"product_type":"c1","uid":1497893,"ip_address":"","ucode":"DD13B8793F024D","user_header":"https://static001.geekbang.org/account/avatar/00/16/db/25/47fd129d.jpg","comment_is_top":false,"comment_ctime":1581055410,"is_pvip":false,"replies":[{"id":"70156","content":"你在拉取代码时，要加个采用循环拉取的参数。这样它才能将依赖也下载下来。你试试看","user_name":"作者回复","comment_id":176420,"uid":"1507837","ip_address":"","utype":1,"ctime":1582429981,"user_name_real":"garrylee"}],"discussion_count":3,"race_medal":0,"score":"1581055410","product_id":100031801,"comment_content":"最后卡在，<br>我的版本<br> node 12.15.0&#47;10.13.0<br> npm 6.4.1<br>系统是 Ubuntu 18.04 &#47;Ubuntu 14.04<br>这些都试了，openSSL 两个版本也试了1.1.1与1.0.2d最后卡在 node运行不起来<br>internal&#47;modules&#47;cjs&#47;loader.js:717                                                                                      <br>  return process.dlopen(module, path.toNamespacedPath(filename));                                                       <br>                 ^                                                                                                      <br>                                                                                                                        <br>Error: &#47;root&#47;sfu&#47;node_modules&#47;medooze-media-server&#47;build&#47;Release&#47;medooze-media-server.node: undefined symbol: HMAC_CTX_i<br>nit                                                                                                                     <br>    at Object.Module._extensions..node (internal&#47;modules&#47;cjs&#47;loader.js:717:18)                                          <br>    at Module.load (internal&#47;modules&#47;cjs&#47;loader.js:598:32)                                                              <br>    at tryModuleLoad (internal&#47;modules&#47;cjs&#47;loader.js:537:12)                                                            <br>    at Function.Module._load (internal&#47;modules&#47;cjs&#47;loader.js:529:3)                                                     <br>    at Module.require (internal&#47;modules&#47;cjs&#47;loader.js:636:17)                                                           <br>    at require (internal&#47;modules&#47;cjs&#47;helpers.js:20:18)                                                                  <br>    at Object.&lt;anonymous&gt; (&#47;root&#47;sfu&#47;node_modules&#47;medooze-media-server&#47;lib&#47;Native.js:10:19)                             <br>    at Module._compile (internal&#47;modules&#47;cjs&#47;loader.js:688:30)                                             ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":483098,"discussion_content":"你在拉取代码时，要加个采用循环拉取的参数。这样它才能将依赖也下载下来。你试试看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582429981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225618,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b3/92/3fe36d79.jpg","nickname":"平衡之美","note":"","ucode":"810AE2EAF9918C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283279,"discussion_content":"老湿 怎么解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592227063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225618,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b3/92/3fe36d79.jpg","nickname":"平衡之美","note":"","ucode":"810AE2EAF9918C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283278,"discussion_content":"还是不得行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592227037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167793,"user_name":"ralph","can_delete":false,"product_type":"c1","uid":1145808,"ip_address":"","ucode":"7CAFE2B0B8E894","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/d0/e39b1875.jpg","comment_is_top":false,"comment_ctime":1577935674,"is_pvip":false,"replies":[{"id":"66414","content":"这个专栏里已经讲了呀","user_name":"作者回复","comment_id":167793,"uid":"1507837","ip_address":"","utype":1,"ctime":1578897913,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1577935674","product_id":100031801,"comment_content":"老师，能不能提高一个视频通信的例子，音频的看完，还是没想明白视频怎么弄.....","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479995,"discussion_content":"这个专栏里已经讲了呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578897913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166545,"user_name":"颜广杰","can_delete":false,"product_type":"c1","uid":1033508,"ip_address":"","ucode":"90FA7789DE7240","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/24/dbc4d29d.jpg","comment_is_top":false,"comment_ctime":1577492999,"is_pvip":false,"replies":[{"id":"66417","content":"应该是代码下载的有问题","user_name":"作者回复","comment_id":166545,"uid":"1507837","ip_address":"","utype":1,"ctime":1578898067,"user_name_real":"garrylee"}],"discussion_count":3,"race_medal":0,"score":"1577492999","product_id":100031801,"comment_content":"安装过程有报错，然后运行之后报错。root@iZwz9isydglfcdgnqd84a4Z:&#47;home&#47;sfu# node index.js 47.112.45.177<br>&#47;home&#47;sfu&#47;lib&#47;Room.js:59<br>                this.activeSpeakerDetector = MediaServer.createActiveSpeakerDetector();<br>                                                         ^<br><br>TypeError: MediaServer.createActiveSpeakerDetector is not a function<br>    at new Room (&#47;home&#47;sfu&#47;lib&#47;Room.js:59:44)<br>    at WebSocketServer.ws.on (&#47;home&#47;sfu&#47;index.js:116:10)<br>    at WebSocketServer.emit (events.js:198:13)<br>    at WebSocketServer.handleUpgrade (&#47;home&#47;sfu&#47;node_modules&#47;websocket&#47;lib&#47;WebSocketServer.js:213:14)<br>    at Server.emit (events.js:198:13)<br>    at onParserExecuteCommon (_http_server.js:555:14)<br>    at onParserExecute (_http_server.js:501:3)<br><br>","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479536,"discussion_content":"应该是代码下载的有问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578898067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1208340,"avatar":"https://static001.geekbang.org/account/avatar/00/12/70/14/96dbc740.jpg","nickname":"郭晓明","note":"","ucode":"DC438D6A91CB59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115521,"discussion_content":"已解决。删除package-lock.json 删除已下载的node_modules文件夹。重新npm install. ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578017333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1208340,"avatar":"https://static001.geekbang.org/account/avatar/00/12/70/14/96dbc740.jpg","nickname":"郭晓明","note":"","ucode":"DC438D6A91CB59","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115481,"discussion_content":"我也报这个错，兄弟解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578015570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166544,"user_name":"颜广杰","can_delete":false,"product_type":"c1","uid":1033508,"ip_address":"","ucode":"90FA7789DE7240","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/24/dbc4d29d.jpg","comment_is_top":false,"comment_ctime":1577492804,"is_pvip":false,"replies":[{"id":"66626","content":"没遇到你这个问题，是不是你的openssl的版本太低了？","user_name":"作者回复","comment_id":166544,"uid":"1507837","ip_address":"","utype":1,"ctime":1579016280,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1577492804","product_id":100031801,"comment_content":"..&#47;external&#47;mp4v2&#47;lib&#47;src&#47;itmf&#47;type.cpp:258:1: warning: missing initializer for member ‘mp4v2::impl::Enum&lt;mp4v2::impl::itmf::ContentRating, (mp4v2::impl::itmf::ContentRating)255&gt;::Entry::formal’ [-Wmissing-field-initializers]<br>..&#47;external&#47;mp4v2&#47;lib&#47;src&#47;itmf&#47;type.cpp:290:5: warning: missing initializer for member ‘mp4v2::impl::itmf::{anonymous}::ImageHeader::data’ [-Wmissing-field-initializers]<br>     };<br><br>..&#47;media-server&#47;src&#47;stunmessage.cpp: In static member function ‘static STUNMessage* STUNMessage::Parse(uint8_t*, uint32_t)’:<br>..&#47;media-server&#47;src&#47;stunmessage.cpp:106:8: warning: variable ‘posMessageIntegrity’ set but not used [-Wunused-but-set-variable]<br>  DWORD posMessageIntegrity = 0;<br>        ^~~~~~~~~~~~~~~~~~~<br><br>&#47;root&#47;.node-gyp&#47;10.18.0&#47;include&#47;node&#47;openssl&#47;ssl.h:1895:45: note: declared here<br> DEPRECATEDIN_1_1_0(__owur const SSL_METHOD *DTLSv1_method(void)) &#47;* DTLSv1.0 *&#47;<br>                                             ^<br>&#47;root&#47;.node-gyp&#47;10.18.0&#47;include&#47;node&#47;openssl&#47;.&#47;.&#47;archs&#47;linux-x86_64&#47;asm&#47;include&#47;openssl&#47;opensslconf.h:124:37: note: in definition of macro ‘DECLARE_DEPRECATED’<br>系统是 阿里云 Ubuntu 18.04<br>node v10.18.0<br>npm 6.4.1<br>老师，尝试了好几次，报了好多错。","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479535,"discussion_content":"没遇到你这个问题，是不是你的openssl的版本太低了？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579016280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155273,"user_name":"Hadooper","can_delete":false,"product_type":"c1","uid":1000620,"ip_address":"","ucode":"8F6ED4BF9E5AAB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/44/ac/c84fa0c3.jpg","comment_is_top":false,"comment_ctime":1574673206,"is_pvip":false,"replies":[{"id":"60309","content":"报什么错呢？","user_name":"作者回复","comment_id":155273,"uid":"1507837","ip_address":"","utype":1,"ctime":1575103512,"user_name_real":"garrylee"}],"discussion_count":3,"race_medal":0,"score":"1574673206","product_id":100031801,"comment_content":"不管用ubuntu18还是centos7，用12的nodejs怎么编译都失败，完全没办法","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475708,"discussion_content":"报什么错呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575103512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103540,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d6/b4/0808999d.jpg","nickname":"白马","note":"","ucode":"FD4DA715AC5984","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328831,"discussion_content":"得看具体错误是什么，我刚开始也编译失败，根据错误提示解决问题后成功编译了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606235137,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1981915,"avatar":"","nickname":"宇宙之王","note":"","ucode":"5E6C28F8CCFF6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311134,"discussion_content":"哥们你后来解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602232966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136283,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1053390,"ip_address":"","ucode":"ABB3F1A63E102A","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/ce/a8c8b5e8.jpg","comment_is_top":false,"comment_ctime":1569403009,"is_pvip":false,"replies":[{"id":"52388","content":"单台500人，主要还和你的带宽有很大关系。SFU架构图我更新一下，抱歉！抱歉！","user_name":"作者回复","comment_id":136283,"uid":"1507837","ip_address":"","utype":1,"ctime":1569493664,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1569403009","product_id":100031801,"comment_content":" 老师好，咱们搭建的medooze的demo能承担多少用户的负载？另外，sfu架构图有个别单词拼写错误，白璧微瑕^^","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468542,"discussion_content":"单台500人，主要还和你的带宽有很大关系。SFU架构图我更新一下，抱歉！抱歉！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569493664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135203,"user_name":"accessory","can_delete":false,"product_type":"c1","uid":1455454,"ip_address":"","ucode":"988A99ACF03611","user_header":"https://static001.geekbang.org/account/avatar/00/16/35/5e/7a584fed.jpg","comment_is_top":false,"comment_ctime":1569059205,"is_pvip":false,"replies":[{"id":"51881","content":"进入到 sfu，重新执行npm install 看看会报错吗","user_name":"作者回复","comment_id":135203,"uid":"1507837","ip_address":"","utype":1,"ctime":1569066254,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1569059205","product_id":100031801,"comment_content":"&#47;home&#47;toney&#47;source&#47;sfu&#47;lib&#47;Room.js:59<br>\t\tthis.activeSpeakerDetector = MediaServer.createActiveSpeakerDetector();<br>\t\t                                         ^<br><br>TypeError: MediaServer.createActiveSpeakerDetector is not a function<br>    at new Room (&#47;home&#47;toney&#47;source&#47;sfu&#47;lib&#47;Room.js:59:44)<br>    at WebSocketServer.ws.on (&#47;home&#47;toney&#47;source&#47;sfu&#47;index.js:116:10)<br>    at WebSocketServer.emit (events.js:198:13)<br>    at WebSocketServer.handleUpgrade (&#47;home&#47;toney&#47;source&#47;sfu&#47;node_modules&#47;websocket&#47;lib&#47;WebSocketServer.js:213:14)<br>    at Server.emit (events.js:198:13)<br>    at onParserExecuteCommon (_http_server.js:553:14)<br>    at onParserExecute (_http_server.js:499:3)<br><br>按照课程中搭建了服务，使用浏览器访问服务，输入 roomid，name，点击 ready 按钮，sfu 就 crash 了，请问老师改如何解决","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468093,"discussion_content":"进入到 sfu，重新执行npm install 看看会报错吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569066254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1455454,"avatar":"https://static001.geekbang.org/account/avatar/00/16/35/5e/7a584fed.jpg","nickname":"accessory","note":"","ucode":"988A99ACF03611","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18595,"discussion_content":"谢谢，已解决 把 package-lock.json 文件删除，重新 npm install 就可以了，猜测是是 package-lock.json 中 medooze-media-server 的版本太老了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1569071485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134741,"user_name":"frank","can_delete":false,"product_type":"c1","uid":1448674,"ip_address":"","ucode":"0D15C35E6A6A7F","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/e2/f88bf28f.jpg","comment_is_top":false,"comment_ctime":1568906913,"is_pvip":false,"replies":[{"id":"51879","content":"再仔细看看代码哈，这个知识点非常关键！","user_name":"作者回复","comment_id":134741,"uid":"1507837","ip_address":"","utype":1,"ctime":1569066146,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1568906913","product_id":100031801,"comment_content":"不懂nodejs，大致看了下，应该是participant.on(&#39;stream&#39; 这边，但是stream怎么触发就不知道了","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"音视频专家-李超","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467884,"discussion_content":"再仔细看看代码哈，这个知识点非常关键！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569066146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}