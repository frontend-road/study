{"id":629866,"title":"115｜怎样通过 MQTT 协议构建消息队列？","content":"<p><strong>课后习题</strong><br>\n请你使用 MQTT 协议，实现客户端和服务端通信。</p><p>注： 服务端可以采用 EMQX、HBMQTT 等 MQTT 服务端实现。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":368957,"user_name":"Cy23","can_delete":false,"product_type":"c3","uid":1591293,"ip_address":"辽宁","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1676949904,"is_pvip":false,"replies":[{"id":134607,"content":"动手能力值得鼓励！\n","user_name":"作者回复","user_name_real":"编辑","uid":1056235,"ctime":1677481656,"ip_address":"广东","comment_id":368957,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"我买的DHT11模块上是 + out - 3个引脚，+接3V3，out接数据数字那些，-接GND，屏幕没线，只能改下代码，就显示温度，检测MQTT接受到，循环2秒shell显示当前温度\nimport dht\nimport machine\nfrom time import sleep\n\nfrom umqtt.simple import MQTTClient\n\n\ndht11_data = machine.Pin(4)\nd = dht.DHT11(dht11_data)\n\nserver = &quot;broker-cn.emqx.io&quot; \nc = MQTTClient(&quot;umqtt_client&quot;, server)\nc.connect()\n\n\n\nwhile True:\n    d.measure()\n    temp = d.temperature()\n    print(f&#39;temperature is {temp} °C&#39;)\n    c.publish(b&quot;foo_topic&quot;, str(temp))\n    sleep(2)\n    \nc.disconnect()","like_count":2,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606902,"discussion_content":"动手能力值得鼓励！\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677481656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}