{"id":72638,"title":"20 | Sparkçš„æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹åˆ†æï¼ˆä¸‹ï¼‰","content":"<p>ä¸Šä¸€æœŸï¼Œæˆ‘è®²äº†è½¯ä»¶æ€§èƒ½ä¼˜åŒ–å¿…é¡»ç»è¿‡è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œå¹¶åœ¨äº†è§£è½¯ä»¶æ¶æ„å’ŒæŠ€æœ¯çš„åŸºç¡€ä¸Šè¿›è¡Œã€‚ä»Šå¤©ï¼Œ<span class=\"orange\">æˆ‘ä»¬é€šè¿‡å‡ ä¸ªSparkæ€§èƒ½ä¼˜åŒ–çš„æ¡ˆä¾‹ï¼Œçœ‹ä¸€çœ‹æ‰€è®²çš„æ€§èƒ½ä¼˜åŒ–åŸåˆ™å¦‚ä½•è½åœ°</span>ã€‚å¦‚æœä½ å¿˜è®°äº†æ€§èƒ½ä¼˜åŒ–çš„åŸåˆ™ï¼Œå¯ä»¥è¿”å›ä¸Šä¸€æœŸå¤ä¹ ä¸€ä¸‹ã€‚</p><p>åŸºäºè½¯ä»¶æ€§èƒ½ä¼˜åŒ–åŸåˆ™å’ŒSparkçš„ç‰¹ç‚¹ï¼ŒSparkæ€§èƒ½ä¼˜åŒ–å¯ä»¥åˆ†è§£ä¸ºä¸‹é¢å‡ æ­¥ã€‚</p><p>1.æ€§èƒ½æµ‹è¯•ï¼Œè§‚å¯ŸSparkæ€§èƒ½ç‰¹æ€§å’Œèµ„æºï¼ˆCPUã€Memoryã€Diskã€Netï¼‰åˆ©ç”¨æƒ…å†µã€‚</p><p>2.åˆ†æã€å¯»æ‰¾èµ„æºç“¶é¢ˆã€‚</p><p>3.åˆ†æç³»ç»Ÿæ¶æ„ã€ä»£ç ï¼Œå‘ç°èµ„æºåˆ©ç”¨å…³é”®æ‰€åœ¨ï¼Œæ€è€ƒä¼˜åŒ–ç­–ç•¥ã€‚</p><p>4.ä»£ç ã€æ¶æ„ã€åŸºç¡€è®¾æ–½è°ƒä¼˜ï¼Œä¼˜åŒ–ã€å¹³è¡¡èµ„æºåˆ©ç”¨ã€‚</p><p>5.æ€§èƒ½æµ‹è¯•ï¼Œè§‚å¯Ÿç³»ç»Ÿæ€§èƒ½ç‰¹æ€§ï¼Œæ˜¯å¦è¾¾åˆ°ä¼˜åŒ–ç›®çš„ï¼Œä»¥åŠå¯»æ‰¾ä¸‹ä¸€ä¸ªç“¶é¢ˆç‚¹ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä¸€èµ·è¿›å…¥è¯¦ç»†çš„æ¡ˆä¾‹åˆ†æï¼Œå¸Œæœ›é€šè¿‡è¿™å‡ ä¸ªæ¡ˆä¾‹ï¼Œå¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£Sparkçš„åŸç†ï¼Œä»¥åŠæ€§èƒ½ä¼˜åŒ–å¦‚ä½•å®è·µè½åœ°ï¼Œå¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p><h2>æ¡ˆä¾‹1ï¼šSparkä»»åŠ¡æ–‡ä»¶åˆå§‹åŒ–è°ƒä¼˜</h2><p>é¦–å…ˆè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œå‘ç°è¿™ä¸ªè§†é¢‘å›¾è°±Nåº¦çº§è”å…³ç³»åº”ç”¨åˆ†ä¸º5ä¸ªjobï¼Œæœ€åä¸€ä¸ªjobä¸ºä¿å­˜ç»“æœåˆ°HDFSï¼Œå…¶ä½™jobä¸ºåŒæ ·è®¡ç®—è¿‡ç¨‹çš„åå¤è¿­ä»£ã€‚ä½†æ˜¯å‘ç°ç¬¬ä¸€ä¸ªjobæ¯”å…¶ä»–jobåˆå¤šäº†ä¸ªè®¡ç®—é˜¶æ®µstageï¼Œå¦‚å›¾ä¸­çº¢åœˆæ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/88/6fd436e3c6c11106cd7754792e78ee88.png?wh=670*206\" alt=\"\"></p><p>é€šè¿‡é˜…è¯»ç¨‹åºä»£ç ï¼Œå‘ç°ç¬¬ä¸€ä¸ªjobéœ€è¦åˆå§‹åŒ–ä¸€ä¸ªç©ºæ•°ç»„ï¼Œä»è€Œäº§ç”Ÿäº†ä¸€ä¸ªstageï¼Œä½†æ˜¯è¿™ä¸ªstageåœ¨æ€§èƒ½æµ‹è¯•ç»“æœä¸Šæ˜¾ç¤ºï¼ŒèŠ±è´¹äº†14ç§’çš„æ—¶é—´ï¼Œè¿œè¿œè¶…å‡ºåˆç†çš„é¢„æœŸèŒƒå›´ã€‚åŒæ—¶ï¼Œå‘ç°è¿™æ®µæ—¶é—´ç½‘ç»œé€šä¿¡ä¹Ÿæœ‰ä¸€å®šå¼€é”€ï¼Œäº‹å®ä¸Šåªæ˜¯å†…å­˜æ•°æ®åˆå§‹åŒ–ï¼Œä»£ç ä¸Šçœ‹ä¸å‡ºéœ€è¦è¿›è¡Œç½‘ç»œé€šä¿¡çš„åœ°æ–¹ã€‚ä¸‹å›¾æ˜¯å…¶ä¸­ä¸€å°è®¡ç®—èŠ‚ç‚¹çš„é€šä¿¡å¼€é”€ï¼Œå‘ç°åœ¨ç¬¬ä¸€ä¸ªstageï¼Œå†™é€šä¿¡æ“ä½œå‡ ä¹æ²¡æœ‰ï¼Œè¯»é€šä¿¡æ“ä½œå¤§çº¦æ¯ç§’å‡ åMBçš„ä¼ è¾“é€Ÿç‡ã€‚</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/05/58/054abfc46ca040d3db8c441822a86558.png?wh=696*196\" alt=\"\"></p><p>åˆ†æSparkè¿è¡Œæ—¥å¿—ï¼Œå‘ç°è¿™ä¸ªstageä¸»è¦èŠ±è´¹æ—¶é—´å¹¶ä¸æ˜¯å¤„ç†åº”ç”¨çš„è®¡ç®—é€»è¾‘ï¼Œè€Œæ˜¯åœ¨ä»Driverè¿›ç¨‹ä¸‹è½½åº”ç”¨æ‰§è¡Œä»£ç ã€‚å‰é¢è¯´è¿‡ï¼ŒSparkå’ŒMapReduceéƒ½æ˜¯é€šè¿‡ç§»åŠ¨è®¡ç®—ç¨‹åºåˆ°æ•°æ®æ‰€åœ¨çš„æœåŠ¡å™¨èŠ‚ç‚¹ï¼Œä»è€ŒèŠ‚çœæ•°æ®ä¼ è¾“çš„ç½‘ç»œé€šä¿¡å¼€é”€ï¼Œå¹¶è¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—ï¼Œå³ç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´åˆ’ç®—ï¼Œè€Œç§»åŠ¨è®¡ç®—ç¨‹åºå°±æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µè¿›è¡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f8/18/f8828271641cb854a0e1e79b75ab8218.png?wh=1178*544\" alt=\"\"></p><p>è¿™ä¸ªè§†é¢‘å…³ç³»å›¾è°±è®¡ç®—ç¨‹åºå› ä¸ºä¾èµ–ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ç¨‹åºåŒ…ï¼Œæ•´ä¸ªè®¡ç®—ç¨‹åºæ‰“åŒ…åå¤§å°è¶…è¿‡17MBï¼Œè¿™ä¸ª17MBçš„JARåŒ…éœ€è¦éƒ¨ç½²åˆ°æ‰€æœ‰è®¡ç®—æœåŠ¡å™¨ä¸Šï¼Œå³WorkerèŠ‚ç‚¹ä¸Šã€‚ä½†æ˜¯åªä¼ è¾“17MBçš„æ•°æ®ä¸å¯èƒ½èŠ±è´¹è¿™ä¹ˆå¤šæ—¶é—´å•Šï¼Ÿ</p><p>è¿›ä¸€æ­¥åˆ†æSparkæ—¥å¿—å’Œä»£ç åå‘ç°ï¼Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šä¼šå¯åŠ¨å¤šä¸ªExecutorè¿›ç¨‹è¿›è¡Œè®¡ç®—ï¼Œè€ŒSparkçš„ç­–ç•¥æ˜¯æ¯ä¸ªExecutorè¿›ç¨‹è‡ªå·±å»ä¸‹è½½åº”ç”¨ç¨‹åºJARåŒ…ï¼Œå½“æ—¶æ¯å°æœºå™¨å¯åŠ¨äº†30ä¸ªExecutorè¿›ç¨‹ï¼Œè¿™æ ·å°±æ˜¯4Ã—30=120ä¸ªè¿›ç¨‹ä¸‹è½½ï¼Œè€ŒDriverè¿›ç¨‹æ‰€åœ¨æœºå™¨æ˜¯ä¸€å—åƒå…†ç½‘å¡ï¼Œå¯¼è‡´å°†è¿™äº›æ•°æ®ä¼ è¾“å®ŒæˆèŠ±è´¹äº†14ç§’çš„æ—¶é—´ã€‚</p><p>å‘ç°é—®é¢˜ä»¥åï¼Œè§£å†³åŠæ³•å°±æ˜¾è€Œæ˜“è§äº†ã€‚åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„å¤šä¸ªExecutorè¿›ç¨‹ä¸å¿…æ¯ä¸ªéƒ½é€šè¿‡ç½‘ç»œä¸‹è½½åº”ç”¨ç¨‹åºï¼Œåªéœ€è¦ä¸€ä¸ªè¿›ç¨‹ä¸‹è½½åˆ°æœ¬åœ°åï¼Œå…¶ä»–è¿›ç¨‹å°†è¿™ä¸ªæ–‡ä»¶copyåˆ°è‡ªå·±çš„å·¥ä½œè·¯å¾„å°±å¯ä»¥äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/82/f0/823fb2e270b7031542edeafd088d06f0.jpg?wh=1864*760\" alt=\"\"></p><p>è¿™æ®µä»£ç æœ‰ä¸ªæŠ€æœ¯å®ç°ç»†èŠ‚éœ€è¦å…³æ³¨ï¼Œå°±æ˜¯å¤šä¸ªè¿›ç¨‹åŒæ—¶å»ä¸‹è½½ç¨‹åºåŒ…çš„æ—¶å€™ï¼Œå¦‚ä½•ä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹å»ä¸‹è½½ï¼Œè€Œå…¶ä»–è¿›ç¨‹é˜»å¡ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹é—´çš„åŒæ­¥é—®é¢˜ã€‚</p><p>è§£å†³åŠæ³•æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ä½œä¸ºè¿›ç¨‹é—´åŒæ­¥çš„é”ï¼Œåªæœ‰è·å¾—æ–‡ä»¶é”çš„è¿›ç¨‹æ‰å»ä¸‹è½½ï¼Œå…¶ä»–è¿›ç¨‹å¾—ä¸åˆ°æ–‡ä»¶é”ï¼Œå°±é˜»å¡ç­‰å¾…ï¼Œé˜»å¡ç»“æŸåï¼Œæ£€æŸ¥æœ¬åœ°ç¨‹åºæ–‡ä»¶æ˜¯å¦å·²ç»ç”Ÿæˆã€‚</p><p>è¿™ä¸ªä¼˜åŒ–å®æµ‹æ•ˆæœè‰¯å¥½ï¼Œç¬¬ä¸€ä¸ªstageä»14ç§’ä¸‹é™åˆ°ä¸è¶³1ç§’ï¼Œæ•ˆæœæ˜¾è‘—ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ea/32/ea59ae5b5e70304ac6f1fcf1bacd3332.png?wh=614*218\" alt=\"\"></p><p>è¿™ä¸ªæ¡ˆä¾‹çš„å…·ä½“ä»£ç ä½ å¯ä»¥å‚è€ƒï¼š<br>\n<a href=\"https://github.com/apache/spark/pull/1616\">https://github.com/apache/spark/pull/1616</a></p><h2>æ¡ˆä¾‹2ï¼šSparkä»»åŠ¡è°ƒåº¦ä¼˜åŒ–</h2><p>ç»§ç»­å‰é¢çš„æ€§èƒ½æµ‹è¯•ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ–°çš„æ€§èƒ½ç“¶é¢ˆä»¥åŠæ€§èƒ½æŒ‡æ ‡ä¸åˆç†çš„åœ°æ–¹ã€‚æˆ‘ä»¬å°†4å°Workeræœºå™¨çš„CPUä½¿ç”¨ç‡è¿›è¡Œå¯¹æ¯”åˆ†æï¼Œå‘ç°CPUä½¿ç”¨ç‡æœ‰äº›è¹Šè··çš„åœ°æ–¹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/49/38/498e4d3d7aa0c23b6fc5807eb87b7638.png?wh=466*154\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/6e/64/6eb9b6f7ff05a9d521035898f830d964.png?wh=452*148\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/b6/00/b6e5868d6af8ffbd3ddc99a0ad9e4b00.png?wh=466*152\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/f8/5b/f82efd934ed0e1992cb7bb9460b9175b.png?wh=458*150\" alt=\"\"></p><p>ä»å›¾ä¸­çœ‹åˆ°ï¼Œåœ¨ç¬¬ä¸€ä¸ªjobçš„ç¬¬äºŒä¸ªé˜¶æ®µï¼Œç¬¬ä¸‰å°æœºå™¨çš„CPUä½¿ç”¨ç‡å’Œå…¶ä»–æœºå™¨æ˜æ˜¾ä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´è®¡ç®—èµ„æºåˆ©ç”¨ä¸å‡è¡¡ï¼Œ<strong>è¿™ç§æœ‰å¿™æœ‰é—²çš„èµ„æºåˆ†é…æ–¹å¼é€šå¸¸ä¼šå¼•èµ·æ€§èƒ½é—®é¢˜</strong>ã€‚</p><p>åˆ†æSparkè¿è¡Œæ—¥å¿—å’ŒSparkæºä»£ç ï¼Œå‘ç°å½“æœ‰ç©ºé—²è®¡ç®—èµ„æºçš„WorkerèŠ‚ç‚¹å‘Driveræ³¨å†Œçš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘Sparkçš„ä»»åŠ¡åˆ†é…ï¼Œåˆ†é…çš„æ—¶å€™ä½¿ç”¨è½®è¯¢æ–¹å¼ï¼Œæ¯ä¸ªWorkeréƒ½ä¼šè½®æµåˆ†é…ä»»åŠ¡ï¼Œä¿è¯ä»»åŠ¡åˆ†é…å‡è¡¡ï¼Œæ¯ä¸ªæœåŠ¡å™¨éƒ½èƒ½é¢†åˆ°ä¸€éƒ¨åˆ†ä»»åŠ¡ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå®æµ‹çš„ç»“æœå´æ˜¯åœ¨ç¬¬äºŒä¸ªstageï¼Œåªæœ‰ä¸€ä¸ªWorkeræœåŠ¡å™¨é¢†äº†ä»»åŠ¡ï¼Œè€Œå…¶ä»–æœåŠ¡å™¨æ²¡æœ‰ä»»ä½•ä»»åŠ¡å¯ä»¥æ‰§è¡Œï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/4c/63/4c69cb903334886ec12dc98b4af8b563.png?wh=1186*566\" alt=\"\"></p><p>è¿›ä¸€æ­¥åˆ†ææ—¥å¿—ï¼Œå‘ç°WorkerèŠ‚ç‚¹å‘Driveræ³¨å†Œæœ‰å…ˆæœ‰åï¼Œå…ˆæ³¨å†Œçš„Workerå¼€å§‹é¢†å–ä»»åŠ¡ï¼Œå¦‚æœéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ•°å°äºWorkeræä¾›çš„è®¡ç®—å•å…ƒæ•°ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªWorkeré¢†èµ°æ‰€æœ‰ä»»åŠ¡çš„æƒ…å†µã€‚</p><p>è€Œç¬¬ä¸€ä¸ªjobçš„ç¬¬äºŒä¸ªstageåˆšå¥½æ˜¯è¿™æ ·çš„æƒ…å†µï¼Œdemoæ•°æ®é‡ä¸å¤§ï¼ŒæŒ‰ç…§HDFSé»˜è®¤çš„Blockå¤§å°ï¼Œåªæœ‰17ä¸ªBlockï¼Œç¬¬äºŒä¸ªstageå°±æ˜¯åŠ è½½è¿™17ä¸ªBlockè¿›è¡Œåˆå§‹è¿­ä»£è®¡ç®—ï¼Œåªéœ€è¦17ä¸ªè®¡ç®—ä»»åŠ¡å°±èƒ½å®Œæˆï¼Œæ‰€ä»¥å½“ç¬¬ä¸‰å°æœåŠ¡å™¨å…ˆäºå…¶ä»–ä¸‰å°æœåŠ¡å™¨å‘Driveræ³¨å†Œçš„æ—¶å€™ï¼Œè§¦å‘Driverçš„ä»»åŠ¡åˆ†é…ï¼Œé¢†èµ°äº†æ‰€æœ‰17ä¸ªä»»åŠ¡ã€‚</p><p>åŒæ—¶ï¼Œä¸ºäº†é¿å…è¿™ç§ä¸€ä¸ªWorkerå…ˆæ³¨å†Œå…ˆé¢†èµ°å…¨éƒ¨ä»»åŠ¡çš„æƒ…å†µï¼Œæˆ‘ä»¬è€ƒè™‘çš„ä¸€ä¸ªä¼˜åŒ–ç­–ç•¥æ˜¯å¢åŠ ä¸€ä¸ªé…ç½®é¡¹ï¼Œåªæœ‰æ³¨å†Œçš„è®¡ç®—èµ„æºæ•°è¾¾åˆ°ä¸€å®šæ¯”ä¾‹æ‰å¼€å§‹åˆ†é…ä»»åŠ¡ï¼Œé»˜è®¤å€¼æ˜¯0.8ã€‚</p><pre><code>spark.scheduler.minRegisteredResourcesRatio = 0.8\n</code></pre><p>ä¸ºäº†é¿å…æ³¨å†Œè®¡ç®—èµ„æºè¾¾ä¸åˆ°æœŸæœ›èµ„æºæ¯”ä¾‹è€Œæ— æ³•å¼€å§‹åˆ†é…ä»»åŠ¡ï¼Œåœ¨å¯åŠ¨ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œåˆå¢åŠ äº†ä¸€ä¸ªé…ç½®é¡¹ï¼Œä¹Ÿå°±æ˜¯æœ€å°ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡æœ€å°ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œä¸ç®¡æ˜¯å¦è¾¾åˆ°æ³¨å†Œæ¯”ä¾‹ï¼Œéƒ½å¼€å§‹åˆ†é…ä»»åŠ¡ã€‚</p><pre><code>spark.scheduler.maxRegisteredResourcesWaitingTime = 3\n</code></pre><p>å¯ç”¨è¿™ä¸¤ä¸ªé…ç½®é¡¹åï¼Œç¬¬äºŒä¸ªstageçš„ä»»åŠ¡è¢«å‡åŒ€åˆ†é…åˆ°4ä¸ªWorkeræœåŠ¡å™¨ä¸Šï¼Œæ‰§è¡Œæ—¶é—´ç¼©çŸ­äº†1.32å€ã€‚è€Œ4å°WorkeræœåŠ¡å™¨çš„CPUåˆ©ç”¨ç‡ä¹Ÿå˜å¾—å¾ˆå‡è¡¡äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/80/c5/804e83b440d287343c49febe58b8c5c5.png?wh=552*156\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/2a/c1/2a005427e41e5e78bb15d08c39f057c1.png?wh=568*160\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/0c/4a/0ce1eab6a0d7800c80d8312b23cb854a.png?wh=568*160\" alt=\"\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/b5/70/b5557db2bcfad01dc9d6e5506d77ea70.png?wh=568*160?wh=568*160\" alt=\"\"></p><p>è¿™ä¸ªæ¡ˆä¾‹çš„å…·ä½“ä»£ç ä½ å¯ä»¥å‚è€ƒï¼š<a href=\"https://github.com/apache/spark/pull/900\">https://github.com/apache/spark/pull/900</a><br>\n<a href=\"https://github.com/apache/spark/pull/1525\">https://github.com/apache/spark/pull/1525</a></p><h2>æ¡ˆä¾‹3ï¼šSparkåº”ç”¨é…ç½®ä¼˜åŒ–</h2><p>çœ‹æ¡ˆä¾‹2çš„å‡ å¼ CPUåˆ©ç”¨ç‡çš„å›¾ï¼Œæˆ‘ä»¬è¿˜å‘ç°æ‰€æœ‰4ä¸ªWorkeræœåŠ¡å™¨çš„CPUåˆ©ç”¨ç‡æœ€å¤§åªèƒ½è¾¾åˆ°60%å¤šä¸€ç‚¹ã€‚ä¾‹å¦‚ä¸‹å›¾ï¼Œç»¿è‰²éƒ¨åˆ†å°±æ˜¯CPUç©ºé—²ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/70/b5557db2bcfad01dc9d6e5506d77ea70.png?wh=568*160?wh=568*160\" alt=\"\"></p><p>è¿™ç§èµ„æºåˆ©ç”¨ç“¶é¢ˆçš„åˆ†ææ— éœ€åˆ†æSparkæ—¥å¿—å’Œæºä»£ç ï¼Œæ ¹æ®Sparkçš„å·¥ä½œåŸç†ï¼Œç¨åŠ æ€è€ƒå°±å¯ä»¥å‘ç°ï¼Œå½“æ—¶ä½¿ç”¨çš„è¿™äº›æœåŠ¡å™¨çš„CPUçš„æ ¸å¿ƒæ•°æ˜¯48æ ¸ï¼Œè€Œåº”ç”¨é…ç½®çš„æœ€å¤§Executoræ•°ç›®æ˜¯120ï¼Œæ¯å°æœåŠ¡å™¨30ä¸ªä»»åŠ¡ï¼Œè™½ç„¶30ä¸ªä»»åŠ¡åœ¨æ¯ä¸ªCPUæ ¸ä¸Šéƒ½100%è¿è¡Œï¼Œä½†æ˜¯æ€»çš„CPUä½¿ç”¨ç‡ä»åªæœ‰60%å¤šã€‚</p><p>å…·ä½“ä¼˜åŒ–ä¹Ÿå¾ˆç®€å•ï¼Œè®¾ç½®åº”ç”¨å¯åŠ¨å‚æ•°çš„Executoræ•°ä¸º48Ã—4=192å³å¯ã€‚</p><h2>æ¡ˆä¾‹4ï¼šæ“ä½œç³»ç»Ÿé…ç½®ä¼˜åŒ–</h2><p>åœ¨æ€§èƒ½æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ï¼Œå½“ä½¿ç”¨ä¸åŒæœåŠ¡å™¨çš„æ—¶å€™ï¼ŒCPUèµ„æºåˆ©ç”¨æƒ…å†µä¹Ÿä¸åŒï¼ŒæŸäº›æœåŠ¡å™¨çš„CPUå¤„äºsysæ€ï¼Œå³ç³»ç»Ÿæ€è¿è¡Œçš„å æ¯”éå¸¸é«˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2e/c7/2e95c4c900c6afb7918e9efa6341bac7.png?wh=646*212\" alt=\"\"></p><p>å›¾ä¸­ç´«è‰²ä¸ºCPUå¤„äºsysæ€ï¼ŒæŸäº›æ—¶å€™sysæ€å äº†CPUæ€»ä½¿ç”¨ç‡çš„è¿‘80%ï¼Œè¿™ä¸ªæ¯”ä¾‹æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼Œè¡¨ç¤ºè™½ç„¶CPUå¾ˆå¿™ï¼Œä½†æ˜¯æ²¡æœ‰æ‰§è¡Œç”¨æˆ·è®¡ç®—ï¼Œè€Œæ˜¯åœ¨æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„è®¡ç®—ã€‚</p><p>é‚£ä¹ˆï¼Œæ“ä½œç³»ç»Ÿç©¶ç«Ÿåœ¨å¿™ä»€ä¹ˆï¼Œå ç”¨äº†è¿™ä¹ˆå¤šCPUæ—¶é—´ï¼Ÿé€šè¿‡è·Ÿè¸ªLinuxå†…æ ¸æ‰§è¡ŒæŒ‡ä»¤ï¼Œå‘ç°è¿™äº›sysæ€çš„æ‰§è¡ŒæŒ‡ä»¤å’ŒLinuxçš„é…ç½®å‚æ•°transparent huge pagesæœ‰å…³ã€‚</p><p>å½“transparent huge pagesæ‰“å¼€çš„æ—¶å€™ï¼Œsysæ€CPUæ¶ˆè€—å°±ä¼šå¢åŠ ï¼Œè€Œä¸åŒLinuxç‰ˆæœ¬çš„transparent huge pagesé»˜è®¤æ˜¯å¦æ‰“å¼€æ˜¯ä¸åŒçš„ï¼Œå¯¹äºé»˜è®¤æ‰“å¼€transparent huge pagesçš„Linuxæ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼Œå…³é—­transparent huge pagesã€‚</p><pre><code>echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled\necho never &gt; /sys/kernel/mm/ transparent_hugepage/defrag\n</code></pre><p>å…³é—­ä»¥åï¼Œå¯¹æ¯”å‰é¢çš„CPUæ¶ˆè€—ï¼Œsyså æ¯”æ˜æ˜¾ä¸‹é™ï¼Œæ€»çš„åº”ç”¨è€—æ—¶ä¹Ÿæœ‰æ˜æ˜¾ä¸‹é™ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/24/94/24b6e43e406ac4eae3f44a94ddd2fb94.png?wh=652*214\" alt=\"\"></p><h2>æ¡ˆä¾‹5ï¼šç¡¬ä»¶ä¼˜åŒ–</h2><p>åˆ†æç½‘å¡çš„èµ„æºæ¶ˆè€—ï¼Œå‘ç°ç½‘ç»œé€šä¿¡æ˜¯æ€§èƒ½çš„ç“¶é¢ˆï¼Œå¯¹æ•´ä¸ªåº”ç”¨çš„å½±å“éå¸¸æ˜æ˜¾ã€‚æ¯”å¦‚åœ¨ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªjobï¼Œç½‘ç»œé€šä¿¡æ¶ˆè€—é•¿è¾¾50ç§’çš„æ—¶é—´ï¼Œç½‘ç»œè¯»å†™é€šä¿¡éƒ½è¾¾åˆ°äº†ç½‘å¡çš„æœ€å¤§ååèƒ½åŠ›ï¼Œæ•´ä¸ªé›†ç¾¤éƒ½åœ¨ç­‰å¾…ç½‘ç»œä¼ è¾“ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/7d/84/7ddc70b5388ebc8a0b05959cbbf6f384.png?wh=690*226\" alt=\"\"></p><p>æˆ‘ä»¬çŸ¥é“åƒå…†ç½‘å¡çš„æœ€å¤§ä¼ è¾“é€Ÿç‡æ˜¯æ¯ç§’125MBï¼Œè¿™æ ·çš„é€Ÿç‡å’ŒCPUå†…å­˜å›ºç„¶æ²¡æ³•æ¯”ï¼Œè€Œè™½ç„¶æ¯”å•ä¸ªç£ç›˜å¿«ä¸€äº›ï¼Œä½†æ˜¯æœåŠ¡å™¨ç£ç›˜æ˜¯8å—ç£ç›˜ç»„æˆçš„é˜µåˆ—ï¼Œæ€»çš„ç£ç›˜ååé‡ä¾ç„¶ç¢¾å‹åƒå…†ç½‘å¡ï¼Œå› æ­¤ç½‘å¡ä¼ è¾“é€Ÿç‡çš„ç“¶é¢ˆå°±æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ç“¶é¢ˆã€‚</p><p>è€Œä¼˜åŒ–æ‰‹æ®µå…¶å®å¾ˆç®€å•ç²—æš´ï¼Œå°±æ˜¯å‡çº§ç½‘å¡ä½¿ç”¨ä¸‡å…†ç½‘å¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/44/0e/4495bc09fde62c856c2ff4316092c20e.png?wh=694*228\" alt=\"\"></p><p>ç¡¬ä»¶ä¼˜åŒ–çš„æ•ˆæœéå¸¸æ˜æ˜¾ï¼Œä»¥å‰éœ€è¦50å¤šç§’çš„ç½‘ç»œé€šä¿¡æ—¶é—´ï¼Œç¼©çŸ­ä¸º10ç§’å·¦å³ã€‚ä»æ€§èƒ½æ›²çº¿ä¸Šçœ‹ï¼Œç½‘ç»œé€šä¿¡åœ¨åˆšåˆšè§¦åŠç½‘å¡æœ€å¤§ä¼ è¾“é€Ÿç‡çš„æ—¶å€™ï¼Œå°±å®Œæˆäº†ä¼ è¾“ï¼Œæ€»çš„è®¡ç®—æ—¶é—´ç¼©çŸ­äº†è¿‘100ç§’ã€‚</p><h2>å°ç»“</h2><p>ä¸€èˆ¬è¯´æ¥ï¼Œå¤§æ•°æ®è½¯ä»¶æ€§èƒ½ä¼˜åŒ–ä¼šæ¶‰åŠç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€å¤§æ•°æ®äº§å“åŠå…¶é…ç½®ã€åº”ç”¨ç¨‹åºå¼€å‘å’Œéƒ¨ç½²å‡ ä¸ªæ–¹é¢ã€‚å½“æ€§èƒ½ä¸èƒ½æ»¡è¶³éœ€æ±‚çš„æ—¶å€™ï¼Œå…ˆçœ‹çœ‹å„é¡¹æ€§èƒ½æŒ‡æ ‡æ˜¯å¦åˆç†ï¼Œå¦‚æœèµ„æºæ²¡æœ‰å…¨é¢åˆ©ç”¨ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯é…ç½®ä¸åˆç†æˆ–è€…å¤§æ•°æ®åº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬SQLè¯­å¥ï¼‰éœ€è¦ä¼˜åŒ–ï¼›å¦‚æœæŸé¡¹èµ„æºåˆ©ç”¨å·²ç»è¾¾åˆ°æé™ï¼Œé‚£ä¹ˆå°±è¦å…·ä½“æ¥åˆ†æï¼Œæ˜¯é›†ç¾¤èµ„æºä¸è¶³ï¼Œéœ€è¦å¢åŠ æ–°çš„ç¡¬ä»¶æœåŠ¡å™¨ï¼Œè¿˜æ˜¯éœ€è¦å¯¹æŸé¡¹ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿæˆ–æ˜¯JVMï¼Œç”šè‡³æ˜¯å¯¹å¤§æ•°æ®äº§å“æºä»£ç è¿›è¡Œè°ƒä¼˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å…³äºç›®å‰çš„ä¸»è¦å¤§æ•°æ®äº§å“ï¼Œä½ åœ¨å­¦ä¹ ã€ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä»SQLå†™æ³•ã€åº”ç”¨ç¼–ç¨‹ã€å‚æ•°é…ç½®ï¼Œåˆ°å¤§æ•°æ®äº§å“è‡ªèº«çš„æ¶æ„åŸç†ä¸æºç å®ç°ï¼Œä½ æœ‰æ²¡æœ‰å‘ç°æœ‰å“ªäº›å¯ä»¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–çš„åœ°æ–¹ï¼Ÿ</p><p>æ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„æ–‡ç« åˆ†äº«ç»™å¥½å‹ã€‚ä¹Ÿæ¬¢è¿ä½ å†™ä¸‹è‡ªå·±çš„æ€è€ƒæˆ–ç–‘é—®ï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p>","neighbors":{"left":{"article_title":"19 | Sparkçš„æ€§èƒ½ä¼˜åŒ–æ¡ˆä¾‹åˆ†æï¼ˆä¸Šï¼‰","id":72056},"right":{"article_title":"21 | ä»é˜¿é‡Œå†…éƒ¨äº§å“çœ‹æµ·é‡æ•°æ®å¤„ç†ç³»ç»Ÿçš„è®¾è®¡ï¼ˆä¸Šï¼‰ï¼šDorisçš„ç«‹é¡¹","id":73047}},"comments":[{"had_liked":false,"id":49272,"user_name":"sunlight001","can_delete":false,"product_type":"c1","uid":1126975,"ip_address":"","ucode":"A72C4274D5DE8A","user_header":"https://static001.geekbang.org/account/avatar/00/11/32/3f/fa4ac035.jpg","comment_is_top":false,"comment_ctime":1544658976,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"87444004896","product_id":100020201,"comment_content":"åœ¨å…¬å¸é‡Œæ²¡æœ‰æ¥è§¦å¤§æ•°æ®çš„æœºä¼šï¼Œè¦æƒ³æ·±å…¥å­¦ä¹ çš„è¯ï¼Œéœ€è¦æ€ä¹ˆåŠå‘¢ï¼Œç°åœ¨ä¸ç®¡æ˜¯çœ‹ä¹¦ï¼Œçœ‹demoï¼Œç­‰æ€»æ˜¯æ„Ÿè§‰ä¸æ·±å…¥ï¼Œæœ‰ä»€ä¹ˆå¥½çš„åŠæ³•å—","like_count":21,"discussions":[{"author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265122,"discussion_content":"é™¤äº†çœ‹ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ï¼ˆç¬¬å››ç‰ˆï¼‰ã€ã€Šå¤§æ•°æ®æŠ€æœ¯ä½“ç³»è¯¦è§£ï¼šåŸç†ã€æ¶æ„ä¸å®è·µã€‹å’Œã€ŠSparkæƒå¨æŒ‡å—ã€‹ç­‰ä¹‹å¤–ï¼Œå°±åªèƒ½çœ‹è‹±æ–‡å®˜ç½‘å’Œå¯¹åº”ç»„ä»¶çš„æºç äº†ï¼Œå¤§æ•°æ®å¹³å°å¼€å‘è¿™ä¸ªå²—ä½ä¹Ÿå¾ˆé€‚åˆæ·±å…¥åŸç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589375583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49296,"user_name":"å´ç§‘ğŸ€","can_delete":false,"product_type":"c1","uid":1112547,"ip_address":"","ucode":"8F2C317887A323","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/e3/2529c7dd.jpg","comment_is_top":false,"comment_ctime":1544662062,"is_pvip":false,"replies":[{"id":"17776","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1544680884,"ip_address":"","comment_id":49296,"utype":1}],"discussion_count":2,"race_medal":0,"score":"61674204206","product_id":100020201,"comment_content":"æˆ‘ä»¬å…¬å¸é›†ç¾¤ä½œä¸šæœ€å¤šçš„å°±æ˜¯SQLä½œä¸šçº¦å 80%ï¼Œä¸ç®¡æ˜¯hive SQLè¿˜æ˜¯spark SQLï¼Œprestoçš„SQLå¼•æ“éƒ½ä¸æ˜¯å®Œç¾çš„ï¼Œæ‰§è¡Œä»»åŠ¡éƒ½æœ‰å¯èƒ½å¡ä½99%å°±ä¸åŠ¨äº†ã€‚ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ï¼ŒSQLçš„å†™æ³•æ˜¯å…³é”®ï¼Œå‡å°‘é‡å¤è®¡ç®—ï¼Œå…±ç”¨ä¸­é—´ç»“æœï¼Œè¿˜è¦æœ‰åˆ†åŒºè¡¨çš„æ„Ÿå¿µã€‚","like_count":15,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432562,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544680884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1150270,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8d/3e/239df6b2.jpg","nickname":"èƒ¡å°å‘","note":"","ucode":"CB893FCC99AA1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40924,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572306114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49528,"user_name":"bill","can_delete":false,"product_type":"c1","uid":1276071,"ip_address":"","ucode":"F71C4812EDEF4A","user_header":"https://static001.geekbang.org/account/avatar/00/13/78/a7/5b730eac.jpg","comment_is_top":false,"comment_ctime":1544706161,"is_pvip":false,"replies":[{"id":"18184","content":"è‡ªå·±å¼€å‘ï¼Œåé¢ä¼šè®²åˆ°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1545025590,"ip_address":"","comment_id":49528,"utype":1}],"discussion_count":3,"race_medal":0,"score":"48789346417","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæ–‡ä¸­çš„å›¾æ˜¯ç”¨ä»€ä¹ˆè½¯ä»¶å¾—å‡ºçš„ï¼Ÿ","like_count":12,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432649,"discussion_content":"è‡ªå·±å¼€å‘ï¼Œåé¢ä¼šè®²åˆ°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545025590,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1241185,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f0/61/fedca2e9.jpg","nickname":"(Kelen)","note":"","ucode":"C8578DB62E3B2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":181593,"discussion_content":"å“ªä¸€èŠ‚æœ‰è¿™ä¸ªç›‘æ§çš„å¼€å‘å•Š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1582376394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":265124,"discussion_content":"zabbixä¹Ÿå¯ä»¥å®ç°å¸¸è§çš„ç›‘æ§åŠŸèƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589375616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49558,"user_name":"æ°ä¹‹7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1544713599,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27314517375","product_id":100020201,"comment_content":"é€šè¿‡è¿™èŠ‚çš„é˜…è¯»å­¦ä¹ ï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªå¤§æ•°æ®å®æˆ˜äº§å“ï¼Œäº†è§£äº†æ€§èƒ½è°ƒä¼˜çš„ä¸€èˆ¬æµç¨‹ï¼Œé€šè¿‡æ€§èƒ½æµ‹è¯•ï¼Œåˆ†æèµ„æºç“¶é¢ˆï¼Œåˆ†æç³»ç»Ÿæ¶æ„åŠä»£ç ï¼Œé€šè¿‡æ¶æ„ï¼Œä»£ç åŠåŸºç¡€è®¾æ–½æ¥è¿›è¡Œè°ƒä¼˜ï¼Œæœ€ååœ¨è¿›è¡Œæµ‹è¯•ã€‚<br><br>è€å¸ˆé€šè¿‡5ä¸ªæ–¹é¢è¿›è¡Œçš„åˆ†æè¯´æ˜ï¼Œ1ï¼ŒSparkä»»åŠ¡æ–‡ä»¶åˆå§‹åŒ–è°ƒä¼˜ï¼Œ2ï¼ŒSparkä»»åŠ¡è°ƒåº¦ä¼˜åŒ–ï¼Œ3ï¼ŒSparkåº”ç”¨é…ç½®ä¼˜åŒ–ï¼Œ4ï¼Œæ“ä½œç³»ç»Ÿä¼˜åŒ–ï¼Œ5ï¼Œç¡¬ä»¶ä¼˜åŒ–ã€‚é€šè¿‡è¿™äº›ç»´åº¦çš„åˆ†æï¼Œæˆ‘è¿›ä¸€æ­¥çš„çŸ¥é“ï¼Œåšå¤§æ•°æ®å¼€å‘ï¼Œä¸€æ ·éœ€è¦æœ‰å¥½çš„è®¡ç®—æœºåŸºæœ¬åŠŸï¼Œè¿™æ˜¯æ¯ä¸€ä¸ªæŠ€æœ¯äººå‘˜çš„åº•å±‚èƒ½åŠ›ã€‚<br><br>æ‰€ä»¥å¤§æ•°æ®å¼€å‘ä¸­éƒ½ä¼šæ¶‰åŠåˆ°ç¡¬ä»¶ï¼Œç³»ç»Ÿï¼Œå¤§æ•°æ®äº§å“åŠå…¶é…ç½®ï¼Œåº”ç”¨ç¨‹åºå¼€å‘å’Œéƒ¨ç½²ç­‰å®é™…ç»éªŒï¼Œå­¦ä¹ åˆ°è¿™é‡Œï¼Œæˆ‘éœ€è¦çœŸæ­£åšä¸€åˆ¤æ–­ï¼Œæ˜¯çœŸæ­£å†³å®šèµ°æŠ€æœ¯è·¯ï¼Œåœ¨æ¥ä¸‹æ¥è‡³å°‘10å¹´çš„æ—¶é—´å»åšæŠ€æœ¯å‘¢ï¼Ÿè¿˜æ˜¯ä¸ºäº†ä»…ä»…ç†Ÿæ‚‰å¤§æ•°æ®æ–¹é¢çš„çŸ¥è¯†ï¼Œé€‚å¯è€Œæ­¢å‘¢ï¼Ÿ<br><br>æˆ‘ä½œä¸ºä¸€åå¹³å‡¡è€Œä¸æƒ³å¹³åº¸çš„äººï¼Œè¿‡ç¨‹ä¸­å†éš¾æˆ‘ä¹Ÿä¼šä¸€è·¯å‰è¡Œã€‚","like_count":7},{"had_liked":false,"id":183354,"user_name":"Knuth","can_delete":false,"product_type":"c1","uid":1083616,"ip_address":"","ucode":"21298EF9BBB91A","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/e0/292508a4.jpg","comment_is_top":false,"comment_ctime":1583028599,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18762897783","product_id":100020201,"comment_content":"æ“ä½œç³»ç»Ÿç©¶ç«Ÿåœ¨å¿™ä»€ä¹ˆï¼Œå ç”¨äº†è¿™ä¹ˆå¤š CPU æ—¶é—´ï¼Ÿé€šè¿‡è·Ÿè¸ª Linux å†…æ ¸æ‰§è¡ŒæŒ‡ä»¤ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br>å…·ä½“æ˜¯æ€ä¹ˆå‘ç°çš„å‘¢ï¼Œå¯ä»¥åˆ—ä¸€ä¸‹è¯¦ç»†çš„æ­¥éª¤ä¹ˆï¼Ÿ","like_count":5},{"had_liked":false,"id":49960,"user_name":"æš´é£é›ª","can_delete":false,"product_type":"c1","uid":1283139,"ip_address":"","ucode":"BF1523D69866FF","user_header":"https://static001.geekbang.org/account/avatar/00/13/94/43/46a7d0a8.jpg","comment_is_top":false,"comment_ctime":1544798384,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14429700272","product_id":100020201,"comment_content":"1.ç¬¬ä¸€ä¸ªæ¡ˆä¾‹çš„ä»£ç ï¼Œå…³äºæ–‡ä»¶é”çš„èŒƒå›´ï¼Œæˆ‘æœ‰å¼ºè¿«ç—‡ï¼Œå°±æ˜¯æŠŠé”çš„èŒƒå›´å†ç¼©å°ä¸€ç‚¹ï¼Œä»…ä»…é”ä½åˆ¤æ–­ä¸‹è½½çš„é‚£æ®µä»£ç å°±å¥½å•¦ã€‚<br>2.å…³äºæ¡ˆä¾‹5ï¼Œæˆ‘æœ‰ç‚¹çœ‹ä¸æ‡‚ç½‘ç»œä½¿ç”¨ç‡çš„å›¾ï¼Œä¸ºä»€ä¹ˆæ˜¯50å¤šç§’çš„å»¶è¿Ÿï¼Œèƒ½ä¸èƒ½ç”¨çº¢åœˆåœˆä¸€ä¸‹ã€‚","like_count":3,"discussions":[{"author":{"id":1587803,"avatar":"https://static001.geekbang.org/account/avatar/00/18/3a/5b/ce1724ca.jpg","nickname":"undefined","note":"","ucode":"867405CA5A9FB7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215820,"discussion_content":"X æ˜¯æŒç»­æ—¶é—´ï¼ŒY æ˜¯å½“å‰ååé‡ï¼ŒX è½´ä¸Šèƒ½çœ‹åˆ°ä¸€æ®µ 50s çš„é«˜å³°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585386586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":49350,"user_name":"æ¡ƒå›­æ‚ ç„¶åœ¨","can_delete":false,"product_type":"c1","uid":1017637,"ip_address":"","ucode":"704460D9CAD1CB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/25/898dea4e.jpg","comment_is_top":false,"comment_ctime":1544669561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10134604153","product_id":100020201,"comment_content":"ç¬¬ä¸‰æ­¥ã€åˆ†æç³»ç»Ÿæ¶æ„ã€ä»£ç ï¼Œå‘ç°èµ„æºåˆ©ç”¨å…³é”®æ‰€åœ¨ï¼Œæ€è€ƒä¼˜åŒ–ç­–ç•¥ã€‘æ€è€ƒè¿‡ç¨‹ä¸­å¯ä»¥æ‹¿é˜¿å§†è¾¾å°”æ³•åˆ™åšæŒ‡å¼•ï¼Œé€‰å‡ºä¼˜åŒ–æ”¶ç›Šæœ€å¤§çš„æ¨¡å—<br>","like_count":2},{"had_liked":false,"id":49300,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1544662777,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10134597369","product_id":100020201,"comment_content":"æ€ä¹ˆå®ç°æ“ä½œçš„ï¼Œè®²è§£å®‰åˆ©æœ‰ä»€ä¹ˆå…·ä½“æŒ‡æ ‡ï¼Ÿè¶…è¿‡å¤šå°‘ç®—ä¸åˆç†","like_count":3},{"had_liked":false,"id":57896,"user_name":"æœ¨ç™½","can_delete":false,"product_type":"c1","uid":1194009,"ip_address":"","ucode":"BEC459430B293C","user_header":"https://static001.geekbang.org/account/avatar/00/12/38/19/c8d72c61.jpg","comment_is_top":false,"comment_ctime":1546937009,"is_pvip":false,"replies":[{"id":"20869","content":"æ˜¯çš„ï¼Œæ•°æ®ä¼šæœ‰æ›´å¤šç§»åŠ¨","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1546938928,"ip_address":"","comment_id":57896,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5841904305","product_id":100020201,"comment_content":"åœ¨ç¬¬äºŒä¸ªæ¡ˆä¾‹ä¸­è¯´åˆ°ï¼Œå…ˆæ³¨å†Œçš„Executorå¯èƒ½ä¼šè®¤é¢†å…¨éƒ¨çš„ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶æ‰€åœ¨çš„ç‰©ç†æœºä¼šæŠŠé‚£ä¸ªstageçš„å…¨éƒ¨å·¥ä½œéƒ½åšäº†å—ï¼Ÿä½†æ˜¯æœ¬ç€â€œç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´åˆ’ç®—çš„ç†è®ºâ€ï¼Œå¦‚æœæ‰€æœ‰çš„ä»»åŠ¡éƒ½åœ¨ä¸€å°æœºå™¨ä¸Šåšå²‚ä¸æ˜¯ä¼šå¯¼è‡´æ•°æ®çš„ç§»åŠ¨ï¼Ÿä¸çŸ¥é“æˆ‘çš„ç†è§£æœ‰æ²¡æœ‰é”™å“ˆ","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435815,"discussion_content":"æ˜¯çš„ï¼Œæ•°æ®ä¼šæœ‰æ›´å¤šç§»åŠ¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546938928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228236,"user_name":"éƒ­å…°æ°","can_delete":false,"product_type":"c1","uid":2025014,"ip_address":"","ucode":"B6CB65C83D7744","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVxdKpjGwBPCyWkyoSib5YzHelnLPVhSEmDiaNEZy8OYOfBgRictaHXNqHJuOrMBff33orIHLINTc2Q/132","comment_is_top":false,"comment_ctime":1592621493,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592621493","product_id":100020201,"comment_content":"æœ‰å•¥æ¯”è¾ƒæ¨èçš„å¼€æºæ€§èƒ½ç›‘æµ‹å·¥å…·å—ï¼Ÿ","like_count":1},{"had_liked":false,"id":137248,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569666587,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569666587","product_id":100020201,"comment_content":"ğŸ˜œè¿˜æ²¡å®é™…ç”¨å¤§æ•°æ®çš„ä¸œè¥¿ï¼Œå…ˆè‡ªå·±å¼€é˜”è§†é‡å­¦ä¹ å­¦ä¹ ã€‚","like_count":0},{"had_liked":false,"id":132875,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1568257089,"is_pvip":false,"replies":[{"id":"50905","content":"^_^","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1568271125,"ip_address":"","comment_id":132875,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568257089","product_id":100020201,"comment_content":"åˆçœ‹äº†ä¸€éï¼Œè§‰å¾—è€å¸ˆåœ¨ä»£ç æ–¹é¢åŠŸåº•å¾ˆå¼ºï¼","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467156,"discussion_content":"^_^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568271125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61514,"user_name":"å°è€é¼ ","can_delete":false,"product_type":"c1","uid":1257460,"ip_address":"","ucode":"C663A0C863A515","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg","comment_is_top":false,"comment_ctime":1547711351,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547711351","product_id":100020201,"comment_content":"1ã€ä½ ä»¬ç”¨çš„æ˜¯ä»€ä¹ˆæ€§èƒ½æµ‹è¯•å·¥å…·ï¼Ÿ<br>2ã€hadoopã€sparkæ˜¯ç”¨javaè¯­è¨€å¼€å‘çš„å—ï¼Ÿè‹¥æ˜¯ç°åœ¨æ”¯æŒJDK9å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":49733,"user_name":"è¿½æ¢¦å°ä¹","can_delete":false,"product_type":"c1","uid":1035507,"ip_address":"","ucode":"82AB8A7F98389D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cc/f3/5e4b0315.jpg","comment_is_top":false,"comment_ctime":1544758540,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544758540","product_id":100020201,"comment_content":"æè€å¸ˆï¼Œæ¡ˆä¾‹2ä¸­è¯´çš„ Worker æä¾›çš„è®¡ç®—å•å…ƒæ•°   é»˜è®¤æ˜¯æœ‰å‡ åä¸ªçš„å—ï¼ŸåŒæ—¶æ˜¯ä¸æ˜¯å¯ä»¥æ ¹æ®spark.default.parallelismè¿™ä¸ªæ¥æŒ‡å®šçš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":49344,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1544668421,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1544668421","product_id":100020201,"comment_content":"ä»£ç ç›´æ¥æäº¤åˆ°apache?ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä¸‹æ‰¾","like_count":0}]}