{"id":287819,"title":"19 | æ³¢åŠ¨çš„å“åº”å»¶è¿Ÿï¼šå¦‚ä½•åº”å¯¹å˜æ…¢çš„Redisï¼Ÿï¼ˆä¸‹ï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è’‹å¾·é’§ã€‚</p><p>ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»‹ç»äº†åˆ¤æ–­Rediså˜æ…¢çš„ä¸¤ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯å“åº”å»¶è¿Ÿå’ŒåŸºçº¿æ€§èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»™ä½ åˆ†äº«äº†ä»Redisçš„è‡ªèº«å‘½ä»¤æ“ä½œå±‚é¢æ’æŸ¥å’Œè§£å†³é—®é¢˜çš„ä¸¤ç§æ–¹æ¡ˆã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœåœ¨æ’æŸ¥æ—¶ï¼Œä½ å‘ç°Redisæ²¡æœ‰æ‰§è¡Œå¤§é‡çš„æ…¢æŸ¥è¯¢å‘½ä»¤ï¼Œä¹Ÿæ²¡æœ‰åŒæ—¶åˆ é™¤å¤§é‡è¿‡æœŸkeysï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å°±æŸæ‰‹æ— ç­–äº†å‘¢ï¼Ÿ</p><p>å½“ç„¶ä¸æ˜¯ï¼æˆ‘è¿˜æœ‰å¾ˆå¤šâ€œé”¦å›Šå¦™è®¡â€ï¼Œå‡†å¤‡åœ¨è¿™èŠ‚è¯¾åˆ†äº«ç»™ä½ å‘¢ï¼</p><p>å¦‚æœä¸ŠèŠ‚è¯¾çš„æ–¹æ³•ä¸ç®¡ç”¨ï¼Œé‚£å°±è¯´æ˜ï¼Œä½ è¦å…³æ³¨å½±å“æ€§èƒ½çš„å…¶ä»–æœºåˆ¶äº†ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿå’Œæ“ä½œç³»ç»Ÿã€‚</p><p>Redisä¼šæŒä¹…åŒ–ä¿å­˜æ•°æ®åˆ°ç£ç›˜ï¼Œè¿™ä¸ªè¿‡ç¨‹è¦ä¾èµ–æ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆï¼Œæ‰€ä»¥ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†æ•°æ®å†™å›ç£ç›˜çš„æœºåˆ¶ï¼Œä¼šç›´æ¥å½±å“åˆ°RedisæŒä¹…åŒ–çš„æ•ˆç‡ã€‚è€Œä¸”ï¼Œåœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒRedisä¹Ÿè¿˜åœ¨æ¥æ”¶å…¶ä»–è¯·æ±‚ï¼ŒæŒä¹…åŒ–çš„æ•ˆç‡é«˜ä½åˆä¼šå½±å“åˆ°Rediså¤„ç†è¯·æ±‚çš„æ€§èƒ½ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼ŒRedisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå†…å­˜æ“ä½œéå¸¸é¢‘ç¹ï¼Œæ‰€ä»¥ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æœºåˆ¶ä¼šç›´æ¥å½±å“åˆ°Redisçš„å¤„ç†æ•ˆç‡ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœRedisçš„å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œæ“ä½œç³»ç»Ÿä¼šå¯åŠ¨swapæœºåˆ¶ï¼Œè¿™å°±ä¼šç›´æ¥æ‹–æ…¢Redisã€‚</p><p>é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å†ä»è¿™ä¸¤ä¸ªå±‚é¢ï¼Œç»§ç»­ç»™ä½ ä»‹ç»ï¼Œå¦‚ä½•è¿›ä¸€æ­¥è§£å†³Rediså˜æ…¢çš„é—®é¢˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/cd/06/cd026801924e197f5c79828c368cd706.jpg?wh=4242*3039\" alt=\"\"></p><h2>æ–‡ä»¶ç³»ç»Ÿï¼šAOFæ¨¡å¼</h2><p>ä½ å¯èƒ½ä¼šé—®ï¼ŒRedisæ˜¯ä¸ªå†…å­˜æ•°æ®åº“ï¼Œä¸ºä»€ä¹ˆå®ƒçš„æ€§èƒ½è¿˜å’Œæ–‡ä»¶ç³»ç»Ÿæœ‰å…³å‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><p>æˆ‘åœ¨å‰é¢è®²è¿‡ï¼Œä¸ºäº†ä¿è¯æ•°æ®å¯é æ€§ï¼ŒRedisä¼šé‡‡ç”¨AOFæ—¥å¿—æˆ–RDBå¿«ç…§ã€‚å…¶ä¸­ï¼ŒAOFæ—¥å¿—æä¾›äº†ä¸‰ç§æ—¥å¿—å†™å›ç­–ç•¥ï¼šnoã€everysecã€alwaysã€‚è¿™ä¸‰ç§å†™å›ç­–ç•¥ä¾èµ–æ–‡ä»¶ç³»ç»Ÿçš„ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨å®Œæˆï¼Œä¹Ÿå°±æ˜¯writeå’Œfsyncã€‚</p><p>writeåªè¦æŠŠæ—¥å¿—è®°å½•å†™åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œå°±å¯ä»¥è¿”å›äº†ï¼Œå¹¶ä¸éœ€è¦ç­‰å¾…æ—¥å¿—å®é™…å†™å›åˆ°ç£ç›˜ï¼›è€Œfsyncéœ€è¦æŠŠæ—¥å¿—è®°å½•å†™å›åˆ°ç£ç›˜åæ‰èƒ½è¿”å›ï¼Œæ—¶é—´è¾ƒé•¿ã€‚ä¸‹é¢è¿™å¼ è¡¨å±•ç¤ºäº†ä¸‰ç§å†™å›ç­–ç•¥æ‰€æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9f/a4/9f1316094001ca64c8dfca37c2c49ea4.jpg?wh=2720*598\" alt=\"\"></p><p>å½“å†™å›ç­–ç•¥é…ç½®ä¸ºeverysecå’Œalwaysæ—¶ï¼ŒRediséœ€è¦è°ƒç”¨fsyncæŠŠæ—¥å¿—å†™å›ç£ç›˜ã€‚ä½†æ˜¯ï¼Œè¿™ä¸¤ç§å†™å›ç­–ç•¥çš„å…·ä½“æ‰§è¡Œæƒ…å†µè¿˜ä¸å¤ªä¸€æ ·ã€‚</p><p>åœ¨ä½¿ç”¨everysecæ—¶ï¼ŒRediså…è®¸ä¸¢å¤±ä¸€ç§’çš„æ“ä½œè®°å½•ï¼Œæ‰€ä»¥ï¼ŒRedisä¸»çº¿ç¨‹å¹¶ä¸éœ€è¦ç¡®ä¿æ¯ä¸ªæ“ä½œè®°å½•æ—¥å¿—éƒ½å†™å›ç£ç›˜ã€‚è€Œä¸”ï¼Œfsyncçš„æ‰§è¡Œæ—¶é—´å¾ˆé•¿ï¼Œå¦‚æœæ˜¯åœ¨Redisä¸»çº¿ç¨‹ä¸­æ‰§è¡Œfsyncï¼Œå°±å®¹æ˜“é˜»å¡ä¸»çº¿ç¨‹ã€‚æ‰€ä»¥ï¼Œå½“å†™å›ç­–ç•¥é…ç½®ä¸ºeverysecæ—¶ï¼ŒRedisä¼šä½¿ç”¨åå°çš„å­çº¿ç¨‹å¼‚æ­¥å®Œæˆfsyncçš„æ“ä½œã€‚</p><p>è€Œå¯¹äºalwaysç­–ç•¥æ¥è¯´ï¼ŒRediséœ€è¦ç¡®ä¿æ¯ä¸ªæ“ä½œè®°å½•æ—¥å¿—éƒ½å†™å›ç£ç›˜ï¼Œå¦‚æœç”¨åå°å­çº¿ç¨‹å¼‚æ­¥å®Œæˆï¼Œä¸»çº¿ç¨‹å°±æ— æ³•åŠæ—¶åœ°çŸ¥é“æ¯ä¸ªæ“ä½œæ˜¯å¦å·²ç»å®Œæˆäº†ï¼Œè¿™å°±ä¸ç¬¦åˆalwaysç­–ç•¥çš„è¦æ±‚äº†ã€‚æ‰€ä»¥ï¼Œalwaysç­–ç•¥å¹¶ä¸ä½¿ç”¨åå°å­çº¿ç¨‹æ¥æ‰§è¡Œã€‚</p><p>å¦å¤–ï¼Œåœ¨ä½¿ç”¨AOFæ—¥å¿—æ—¶ï¼Œä¸ºäº†é¿å…æ—¥å¿—æ–‡ä»¶ä¸æ–­å¢å¤§ï¼ŒRedisä¼šæ‰§è¡ŒAOFé‡å†™ï¼Œç”Ÿæˆä½“é‡ç¼©å°çš„æ–°çš„AOFæ—¥å¿—æ–‡ä»¶ã€‚AOFé‡å†™æœ¬èº«éœ€è¦çš„æ—¶é—´å¾ˆé•¿ï¼Œä¹Ÿå®¹æ˜“é˜»å¡Redisä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥ï¼ŒRedisä½¿ç”¨å­è¿›ç¨‹æ¥è¿›è¡ŒAOFé‡å†™ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ½œåœ¨çš„é£é™©ç‚¹ï¼šAOFé‡å†™ä¼šå¯¹ç£ç›˜è¿›è¡Œå¤§é‡IOæ“ä½œï¼ŒåŒæ—¶ï¼Œfsyncåˆéœ€è¦ç­‰åˆ°æ•°æ®å†™åˆ°ç£ç›˜åæ‰èƒ½è¿”å›ï¼Œæ‰€ä»¥ï¼Œå½“AOFé‡å†™çš„å‹åŠ›æ¯”è¾ƒå¤§æ—¶ï¼Œå°±ä¼šå¯¼è‡´fsyncè¢«é˜»å¡ã€‚è™½ç„¶fsyncæ˜¯ç”±åå°å­çº¿ç¨‹è´Ÿè´£æ‰§è¡Œçš„ï¼Œä½†æ˜¯ï¼Œä¸»çº¿ç¨‹ä¼šç›‘æ§fsyncçš„æ‰§è¡Œè¿›åº¦ã€‚</p><p>å½“ä¸»çº¿ç¨‹ä½¿ç”¨åå°å­çº¿ç¨‹æ‰§è¡Œäº†ä¸€æ¬¡fsyncï¼Œéœ€è¦å†æ¬¡æŠŠæ–°æ¥æ”¶çš„æ“ä½œè®°å½•å†™å›ç£ç›˜æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹å‘ç°ä¸Šä¸€æ¬¡çš„fsyncè¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆå®ƒå°±ä¼šé˜»å¡ã€‚æ‰€ä»¥ï¼Œå¦‚æœåå°å­çº¿ç¨‹æ‰§è¡Œçš„fsyncé¢‘ç¹é˜»å¡çš„è¯ï¼ˆæ¯”å¦‚AOFé‡å†™å ç”¨äº†å¤§é‡çš„ç£ç›˜IOå¸¦å®½ï¼‰ï¼Œä¸»çº¿ç¨‹ä¹Ÿä¼šé˜»å¡ï¼Œå¯¼è‡´Redisæ€§èƒ½å˜æ…¢ã€‚</p><p>ä¸ºäº†å¸®åŠ©ä½ ç†è§£ï¼Œæˆ‘å†ç”»ä¸€å¼ å›¾æ¥å±•ç¤ºä¸‹åœ¨ç£ç›˜å‹åŠ›å°å’Œå‹åŠ›å¤§çš„æ—¶å€™ï¼Œfsyncåå°å­çº¿ç¨‹å’Œä¸»çº¿ç¨‹å—åˆ°çš„å½±å“ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/a6/2a47b3f6fd7beaf466a675777ebd28a6.jpg?wh=3000*1557\" alt=\"\"></p><p>å¥½äº†ï¼Œè¯´åˆ°è¿™é‡Œï¼Œä½ å·²ç»äº†è§£äº†ï¼Œç”±äºfsyncåå°å­çº¿ç¨‹å’ŒAOFé‡å†™å­è¿›ç¨‹çš„å­˜åœ¨ï¼Œä¸»IOçº¿ç¨‹ä¸€èˆ¬ä¸ä¼šè¢«é˜»å¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœåœ¨é‡å†™æ—¥å¿—æ—¶ï¼ŒAOFé‡å†™å­è¿›ç¨‹çš„å†™å…¥é‡æ¯”è¾ƒå¤§ï¼Œfsyncçº¿ç¨‹ä¹Ÿä¼šè¢«é˜»å¡ï¼Œè¿›è€Œé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´å»¶è¿Ÿå¢åŠ ã€‚ç°åœ¨ï¼Œæˆ‘æ¥ç»™å‡ºæ’æŸ¥å’Œè§£å†³å»ºè®®ã€‚</p><p>é¦–å…ˆï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸‹Redisé…ç½®æ–‡ä»¶ä¸­çš„appendfsyncé…ç½®é¡¹ï¼Œè¯¥é…ç½®é¡¹çš„å–å€¼è¡¨æ˜äº†Rediså®ä¾‹ä½¿ç”¨çš„æ˜¯å“ªç§AOFæ—¥å¿—å†™å›ç­–ç•¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/e9/ba770d1f25ffae79a101c13b9f8aa9e9.jpg?wh=2738*601\" alt=\"\"></p><p>å¦‚æœAOFå†™å›ç­–ç•¥ä½¿ç”¨äº†everysecæˆ–alwaysé…ç½®ï¼Œè¯·å…ˆç¡®è®¤ä¸‹ä¸šåŠ¡æ–¹å¯¹æ•°æ®å¯é æ€§çš„è¦æ±‚ï¼Œæ˜ç¡®æ˜¯å¦éœ€è¦æ¯ä¸€ç§’æˆ–æ¯ä¸€ä¸ªæ“ä½œéƒ½è®°æ—¥å¿—ã€‚æœ‰çš„ä¸šåŠ¡æ–¹ä¸äº†è§£Redis AOFæœºåˆ¶ï¼Œå¾ˆå¯èƒ½å°±ç›´æ¥ä½¿ç”¨æ•°æ®å¯é æ€§æœ€é«˜ç­‰çº§çš„alwaysé…ç½®äº†ã€‚å…¶å®ï¼Œåœ¨æœ‰äº›åœºæ™¯ä¸­ï¼ˆä¾‹å¦‚Redisç”¨äºç¼“å­˜ï¼‰ï¼Œæ•°æ®ä¸¢äº†è¿˜å¯ä»¥ä»åç«¯æ•°æ®åº“ä¸­è·å–ï¼Œå¹¶ä¸éœ€è¦å¾ˆé«˜çš„æ•°æ®å¯é æ€§ã€‚</p><p>å¦‚æœä¸šåŠ¡åº”ç”¨å¯¹å»¶è¿Ÿéå¸¸æ•æ„Ÿï¼Œä½†åŒæ—¶å…è®¸ä¸€å®šé‡çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆï¼Œå¯ä»¥æŠŠé…ç½®é¡¹no-appendfsync-on-rewriteè®¾ç½®ä¸ºyesï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>no-appendfsync-on-rewrite yes\n</code></pre><p>è¿™ä¸ªé…ç½®é¡¹è®¾ç½®ä¸ºyesæ—¶ï¼Œè¡¨ç¤ºåœ¨AOFé‡å†™æ—¶ï¼Œä¸è¿›è¡Œfsyncæ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒRediså®ä¾‹æŠŠå†™å‘½ä»¤å†™åˆ°å†…å­˜åï¼Œä¸è°ƒç”¨åå°çº¿ç¨‹è¿›è¡Œfsyncæ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›äº†ã€‚å½“ç„¶ï¼Œå¦‚æœæ­¤æ—¶å®ä¾‹å‘ç”Ÿå®•æœºï¼Œå°±ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚åä¹‹ï¼Œå¦‚æœè¿™ä¸ªé…ç½®é¡¹è®¾ç½®ä¸ºnoï¼ˆä¹Ÿæ˜¯é»˜è®¤é…ç½®ï¼‰ï¼Œåœ¨AOFé‡å†™æ—¶ï¼ŒRediså®ä¾‹ä»ç„¶ä¼šè°ƒç”¨åå°çº¿ç¨‹è¿›è¡Œfsyncæ“ä½œï¼Œè¿™å°±ä¼šç»™å®ä¾‹å¸¦æ¥é˜»å¡ã€‚</p><p>å¦‚æœçš„ç¡®éœ€è¦é«˜æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦é«˜å¯é æ•°æ®ä¿è¯ï¼Œæˆ‘å»ºè®®ä½ è€ƒè™‘<strong>é‡‡ç”¨é«˜é€Ÿçš„å›ºæ€ç¡¬ç›˜ä½œä¸ºAOFæ—¥å¿—çš„å†™å…¥è®¾å¤‡ã€‚</strong></p><p>é«˜é€Ÿå›ºæ€ç›˜çš„å¸¦å®½å’Œå¹¶å‘åº¦æ¯”ä¼ ç»Ÿçš„æœºæ¢°ç¡¬ç›˜çš„è¦é«˜å‡º10å€åŠä»¥ä¸Šã€‚åœ¨AOFé‡å†™å’Œfsyncåå°çº¿ç¨‹åŒæ—¶æ‰§è¡Œæ—¶ï¼Œå›ºæ€ç¡¬ç›˜å¯ä»¥æä¾›è¾ƒä¸ºå……è¶³çš„ç£ç›˜IOèµ„æºï¼Œè®©AOFé‡å†™å’Œfsyncåå°çº¿ç¨‹çš„ç£ç›˜IOèµ„æºç«äº‰å‡å°‘ï¼Œä»è€Œé™ä½å¯¹Redisçš„æ€§èƒ½å½±å“ã€‚</p><h2>æ“ä½œç³»ç»Ÿï¼šswap</h2><p>å¦‚æœRedisçš„AOFæ—¥å¿—é…ç½®åªæ˜¯noï¼Œæˆ–è€…å°±æ²¡æœ‰é‡‡ç”¨AOFæ¨¡å¼ï¼Œé‚£ä¹ˆï¼Œè¿˜ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å¯¼è‡´æ€§èƒ½å˜æ…¢å—ï¼Ÿ</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±å†è¯´ä¸€ä¸ªæ½œåœ¨çš„ç“¶é¢ˆï¼š<strong>æ“ä½œç³»ç»Ÿçš„å†…å­˜swap</strong>ã€‚</p><p>å†…å­˜swapæ˜¯æ“ä½œç³»ç»Ÿé‡Œå°†å†…å­˜æ•°æ®åœ¨å†…å­˜å’Œç£ç›˜é—´æ¥å›æ¢å…¥å’Œæ¢å‡ºçš„æœºåˆ¶ï¼Œæ¶‰åŠåˆ°ç£ç›˜çš„è¯»å†™ï¼Œæ‰€ä»¥ï¼Œä¸€æ—¦è§¦å‘swapï¼Œæ— è®ºæ˜¯è¢«æ¢å…¥æ•°æ®çš„è¿›ç¨‹ï¼Œè¿˜æ˜¯è¢«æ¢å‡ºæ•°æ®çš„è¿›ç¨‹ï¼Œå…¶æ€§èƒ½éƒ½ä¼šå—åˆ°æ…¢é€Ÿç£ç›˜è¯»å†™çš„å½±å“ã€‚</p><p>Redisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå†…å­˜ä½¿ç”¨é‡å¤§ï¼Œå¦‚æœæ²¡æœ‰æ§åˆ¶å¥½å†…å­˜çš„ä½¿ç”¨é‡ï¼Œæˆ–è€…å’Œå…¶ä»–å†…å­˜éœ€æ±‚å¤§çš„åº”ç”¨ä¸€èµ·è¿è¡Œäº†ï¼Œå°±å¯èƒ½å—åˆ°swapçš„å½±å“ï¼Œè€Œå¯¼è‡´æ€§èƒ½å˜æ…¢ã€‚</p><p>è¿™ä¸€ç‚¹å¯¹äºRediså†…å­˜æ•°æ®åº“è€Œè¨€ï¼Œæ˜¾å¾—æ›´ä¸ºé‡è¦ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼ŒRedisçš„æ“ä½œæ˜¯ç›´æ¥é€šè¿‡è®¿é—®å†…å­˜å°±èƒ½å®Œæˆï¼Œä¸€æ—¦swapè¢«è§¦å‘äº†ï¼ŒRedisçš„è¯·æ±‚æ“ä½œéœ€è¦ç­‰åˆ°ç£ç›˜æ•°æ®è¯»å†™å®Œæˆæ‰è¡Œã€‚è€Œä¸”ï¼Œå’Œæˆ‘åˆšæ‰è¯´çš„AOFæ—¥å¿—æ–‡ä»¶è¯»å†™ä½¿ç”¨fsyncçº¿ç¨‹ä¸åŒï¼Œswapè§¦å‘åå½±å“çš„æ˜¯Redisä¸»IOçº¿ç¨‹ï¼Œè¿™ä¼šæå¤§åœ°å¢åŠ Redisçš„å“åº”æ—¶é—´ã€‚</p><p>è¯´åˆ°è¿™å„¿ï¼Œæˆ‘æƒ³ç»™ä½ åˆ†äº«ä¸€ä¸ªæˆ‘æ›¾ç»é‡åˆ°è¿‡çš„å› ä¸ºswapè€Œå¯¼è‡´æ€§èƒ½é™ä½çš„ä¾‹å­ã€‚</p><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿è¡Œçš„ä¸€ä¸ªå®ä¾‹å®Œæˆ5000ä¸‡ä¸ªGETè¯·æ±‚æ—¶éœ€è¦300sï¼Œä½†æ˜¯ï¼Œæœ‰ä¸€æ¬¡ï¼Œè¿™ä¸ªå®ä¾‹å®Œæˆ5000ä¸‡GETè¯·æ±‚ï¼ŒèŠ±äº†å°†è¿‘4ä¸ªå°æ—¶çš„æ—¶é—´ã€‚ç»è¿‡é—®é¢˜å¤ç°ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå½“æ—¶Rediså¤„ç†è¯·æ±‚ç”¨äº†è¿‘4å°æ—¶çš„æƒ…å†µä¸‹ï¼Œè¯¥å®ä¾‹æ‰€åœ¨çš„æœºå™¨å·²ç»å‘ç”Ÿäº†swapã€‚ä»300såˆ°4ä¸ªå°æ—¶ï¼Œå»¶è¿Ÿå¢åŠ äº†å°†è¿‘48å€ï¼Œå¯ä»¥çœ‹åˆ°swapå¯¹æ€§èƒ½é€ æˆçš„ä¸¥é‡å½±å“ã€‚</p><p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™ä¼šè§¦å‘swapå‘¢ï¼Ÿ</p><p>é€šå¸¸ï¼Œè§¦å‘swapçš„åŸå› ä¸»è¦æ˜¯<strong>ç‰©ç†æœºå™¨å†…å­˜ä¸è¶³</strong>ï¼Œå¯¹äºRedisè€Œè¨€ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„æƒ…å†µï¼š</p><ul>\n<li>Rediså®ä¾‹è‡ªèº«ä½¿ç”¨äº†å¤§é‡çš„å†…å­˜ï¼Œå¯¼è‡´ç‰©ç†æœºå™¨çš„å¯ç”¨å†…å­˜ä¸è¶³ï¼›</li>\n<li>å’ŒRediså®ä¾‹åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œçš„å…¶ä»–è¿›ç¨‹ï¼Œåœ¨è¿›è¡Œå¤§é‡çš„æ–‡ä»¶è¯»å†™æ“ä½œã€‚æ–‡ä»¶è¯»å†™æœ¬èº«ä¼šå ç”¨ç³»ç»Ÿå†…å­˜ï¼Œè¿™ä¼šå¯¼è‡´åˆ†é…ç»™Rediså®ä¾‹çš„å†…å­˜é‡å˜å°‘ï¼Œè¿›è€Œè§¦å‘Rediså‘ç”Ÿswapã€‚</li>\n</ul><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¹Ÿç»™ä½ æä¾›ä¸€ä¸ªè§£å†³æ€è·¯ï¼š<strong>å¢åŠ æœºå™¨çš„å†…å­˜æˆ–è€…ä½¿ç”¨Redisé›†ç¾¤</strong>ã€‚</p><p>æ“ä½œç³»ç»Ÿæœ¬èº«ä¼šåœ¨åå°è®°å½•æ¯ä¸ªè¿›ç¨‹çš„swapä½¿ç”¨æƒ…å†µï¼Œå³æœ‰å¤šå°‘æ•°æ®é‡å‘ç”Ÿäº†swapã€‚ä½ å¯ä»¥å…ˆé€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹Redisçš„è¿›ç¨‹å·ï¼Œè¿™é‡Œæ˜¯5332ã€‚</p><pre><code>$ redis-cli info | grep process_id\nprocess_id: 5332\n</code></pre><p>ç„¶åï¼Œè¿›å…¥Redisæ‰€åœ¨æœºå™¨çš„/procç›®å½•ä¸‹çš„è¯¥è¿›ç¨‹ç›®å½•ä¸­ï¼š</p><pre><code>$ cd /proc/5332\n</code></pre><p>æœ€åï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹è¯¥Redisè¿›ç¨‹çš„ä½¿ç”¨æƒ…å†µã€‚åœ¨è¿™å„¿ï¼Œæˆ‘åªæˆªå–äº†éƒ¨åˆ†ç»“æœï¼š</p><pre><code>$cat smaps | egrep '^(Swap|Size)'\nSize: 584 kB\nSwap: 0 kB\nSize: 4 kB\nSwap: 4 kB\nSize: 4 kB\nSwap: 0 kB\nSize: 462044 kB\nSwap: 462008 kB\nSize: 21392 kB\nSwap: 0 kB\n</code></pre><p>æ¯ä¸€è¡ŒSizeè¡¨ç¤ºçš„æ˜¯Rediså®ä¾‹æ‰€ç”¨çš„ä¸€å—å†…å­˜å¤§å°ï¼Œè€ŒSizeä¸‹æ–¹çš„Swapå’Œå®ƒç›¸å¯¹åº”ï¼Œè¡¨ç¤ºè¿™å—Sizeå¤§å°çš„å†…å­˜åŒºåŸŸæœ‰å¤šå°‘å·²ç»è¢«æ¢å‡ºåˆ°ç£ç›˜ä¸Šäº†ã€‚å¦‚æœè¿™ä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œå°±è¡¨ç¤ºè¿™å—å†…å­˜åŒºåŸŸå·²ç»å®Œå…¨è¢«æ¢å‡ºåˆ°ç£ç›˜äº†ã€‚</p><p>ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼ŒRedisæœ¬èº«ä¼šä½¿ç”¨å¾ˆå¤šå¤§å°ä¸ä¸€çš„å†…å­˜å—ï¼Œæ‰€ä»¥ï¼Œä½ å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šSizeè¡Œï¼Œæœ‰çš„å¾ˆå°ï¼Œå°±æ˜¯4KBï¼Œè€Œæœ‰çš„å¾ˆå¤§ï¼Œä¾‹å¦‚462044KBã€‚<strong>ä¸åŒå†…å­˜å—è¢«æ¢å‡ºåˆ°ç£ç›˜ä¸Šçš„å¤§å°ä¹Ÿä¸ä¸€æ ·</strong>ï¼Œä¾‹å¦‚åˆšåˆšçš„ç»“æœä¸­çš„ç¬¬ä¸€ä¸ª4KBå†…å­˜å—ï¼Œå®ƒä¸‹æ–¹çš„Swapä¹Ÿæ˜¯4KBï¼Œè¿™è¡¨ç¤ºè¿™ä¸ªå†…å­˜å—å·²ç»è¢«æ¢å‡ºäº†ï¼›å¦å¤–ï¼Œ462044KBè¿™ä¸ªå†…å­˜å—ä¹Ÿè¢«æ¢å‡ºäº†462008KBï¼Œå·®ä¸å¤šæœ‰462MBã€‚</p><p>è¿™é‡Œæœ‰ä¸ªé‡è¦çš„åœ°æ–¹ï¼Œæˆ‘å¾—æé†’ä½ ä¸€ä¸‹ï¼Œå½“å‡ºç°ç™¾MBï¼Œç”šè‡³GBçº§åˆ«çš„swapå¤§å°æ—¶ï¼Œå°±è¡¨æ˜ï¼Œæ­¤æ—¶ï¼ŒRediså®ä¾‹çš„å†…å­˜å‹åŠ›å¾ˆå¤§ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå˜æ…¢ã€‚æ‰€ä»¥ï¼Œswapçš„å¤§å°æ˜¯æ’æŸ¥Redisæ€§èƒ½å˜æ…¢æ˜¯å¦ç”±swapå¼•èµ·çš„é‡è¦æŒ‡æ ‡ã€‚</p><p>ä¸€æ—¦å‘ç”Ÿå†…å­˜swapï¼Œæœ€ç›´æ¥çš„è§£å†³æ–¹æ³•å°±æ˜¯<strong>å¢åŠ æœºå™¨å†…å­˜</strong>ã€‚å¦‚æœè¯¥å®ä¾‹åœ¨ä¸€ä¸ªRedisåˆ‡ç‰‡é›†ç¾¤ä¸­ï¼Œå¯ä»¥å¢åŠ Redisé›†ç¾¤çš„å®ä¾‹ä¸ªæ•°ï¼Œæ¥åˆ†æ‘Šæ¯ä¸ªå®ä¾‹æœåŠ¡çš„æ•°æ®é‡ï¼Œè¿›è€Œå‡å°‘æ¯ä¸ªå®ä¾‹æ‰€éœ€çš„å†…å­˜é‡ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœRediså®ä¾‹å’Œå…¶ä»–æ“ä½œå¤§é‡æ–‡ä»¶çš„ç¨‹åºï¼ˆä¾‹å¦‚æ•°æ®åˆ†æç¨‹åºï¼‰å…±äº«æœºå™¨ï¼Œä½ å¯ä»¥å°†Rediså®ä¾‹è¿ç§»åˆ°å•ç‹¬çš„æœºå™¨ä¸Šè¿è¡Œï¼Œä»¥æ»¡è¶³å®ƒçš„å†…å­˜éœ€æ±‚é‡ã€‚å¦‚æœè¯¥å®ä¾‹æ­£å¥½æ˜¯Redisä¸»ä»é›†ç¾¤ä¸­çš„ä¸»åº“ï¼Œè€Œä»åº“çš„å†…å­˜å¾ˆå¤§ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘è¿›è¡Œä¸»ä»åˆ‡æ¢ï¼ŒæŠŠå¤§å†…å­˜çš„ä»åº“å˜æˆä¸»åº“ï¼Œç”±å®ƒæ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p><h2>æ“ä½œç³»ç»Ÿï¼šå†…å­˜å¤§é¡µ</h2><p>é™¤äº†å†…å­˜swapï¼Œè¿˜æœ‰ä¸€ä¸ªå’Œå†…å­˜ç›¸å…³çš„å› ç´ ï¼Œå³å†…å­˜å¤§é¡µæœºåˆ¶ï¼ˆTransparent Huge Page, THPï¼‰ï¼Œä¹Ÿä¼šå½±å“Redisæ€§èƒ½ã€‚</p><p>Linuxå†…æ ¸ä»2.6.38å¼€å§‹æ”¯æŒå†…å­˜å¤§é¡µæœºåˆ¶ï¼Œè¯¥æœºåˆ¶æ”¯æŒ2MBå¤§å°çš„å†…å­˜é¡µåˆ†é…ï¼Œè€Œå¸¸è§„çš„å†…å­˜é¡µåˆ†é…æ˜¯æŒ‰4KBçš„ç²’åº¦æ¥æ‰§è¡Œçš„ã€‚</p><p>å¾ˆå¤šäººéƒ½è§‰å¾—ï¼šâ€œRedisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå†…å­˜å¤§é¡µä¸æ­£å¥½å¯ä»¥æ»¡è¶³Redisçš„éœ€æ±‚å—ï¼Ÿè€Œä¸”åœ¨åˆ†é…ç›¸åŒçš„å†…å­˜é‡æ—¶ï¼Œå†…å­˜å¤§é¡µè¿˜èƒ½å‡å°‘åˆ†é…æ¬¡æ•°ï¼Œä¸ä¹Ÿæ˜¯å¯¹Rediså‹å¥½å—?â€</p><p>å…¶å®ï¼Œç³»ç»Ÿçš„è®¾è®¡é€šå¸¸æ˜¯ä¸€ä¸ªå–èˆè¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºtrade-offã€‚å¾ˆå¤šæœºåˆ¶é€šå¸¸éƒ½æ˜¯ä¼˜åŠ¿å’ŒåŠ£åŠ¿å¹¶å­˜çš„ã€‚Redisä½¿ç”¨å†…å­˜å¤§é¡µå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ã€‚</p><p>è™½ç„¶å†…å­˜å¤§é¡µå¯ä»¥ç»™Rediså¸¦æ¥å†…å­˜åˆ†é…æ–¹é¢çš„æ”¶ç›Šï¼Œä½†æ˜¯ï¼Œä¸è¦å¿˜äº†ï¼ŒRedisä¸ºäº†æä¾›æ•°æ®å¯é æ€§ä¿è¯ï¼Œéœ€è¦å°†æ•°æ®åšæŒä¹…åŒ–ä¿å­˜ã€‚è¿™ä¸ªå†™å…¥è¿‡ç¨‹ç”±é¢å¤–çš„çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ï¼Œæ­¤æ—¶ï¼ŒRedisä¸»çº¿ç¨‹ä»ç„¶å¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯å†™è¯·æ±‚ã€‚å®¢æˆ·ç«¯çš„å†™è¯·æ±‚å¯èƒ½ä¼šä¿®æ”¹æ­£åœ¨è¿›è¡ŒæŒä¹…åŒ–çš„æ•°æ®ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼ŒRediså°±ä¼šé‡‡ç”¨å†™æ—¶å¤åˆ¶æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦æœ‰æ•°æ®è¦è¢«ä¿®æ”¹ï¼ŒRediså¹¶ä¸ä¼šç›´æ¥ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ï¼Œè€Œæ˜¯å°†è¿™äº›æ•°æ®æ‹·è´ä¸€ä»½ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹ã€‚</p><p>å¦‚æœé‡‡ç”¨äº†å†…å­˜å¤§é¡µï¼Œé‚£ä¹ˆï¼Œå³ä½¿å®¢æˆ·ç«¯è¯·æ±‚åªä¿®æ”¹100Bçš„æ•°æ®ï¼ŒRedisä¹Ÿéœ€è¦æ‹·è´2MBçš„å¤§é¡µã€‚ç›¸åï¼Œå¦‚æœæ˜¯å¸¸è§„å†…å­˜é¡µæœºåˆ¶ï¼Œåªç”¨æ‹·è´4KBã€‚ä¸¤è€…ç›¸æ¯”ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚ä¿®æ”¹æˆ–æ–°å†™å…¥æ•°æ®è¾ƒå¤šæ—¶ï¼Œå†…å­˜å¤§é¡µæœºåˆ¶å°†å¯¼è‡´å¤§é‡çš„æ‹·è´ï¼Œè¿™å°±ä¼šå½±å“Redisæ­£å¸¸çš„è®¿å­˜æ“ä½œï¼Œæœ€ç»ˆå¯¼è‡´æ€§èƒ½å˜æ…¢ã€‚</p><p>é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå…³é—­å†…å­˜å¤§é¡µï¼Œå°±è¡Œäº†ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å…ˆæ’æŸ¥ä¸‹å†…å­˜å¤§é¡µã€‚æ–¹æ³•æ˜¯ï¼šåœ¨Rediså®ä¾‹è¿è¡Œçš„æœºå™¨ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</p><pre><code>cat /sys/kernel/mm/transparent_hugepage/enabled\n</code></pre><p>å¦‚æœæ‰§è¡Œç»“æœæ˜¯alwaysï¼Œå°±è¡¨æ˜å†…å­˜å¤§é¡µæœºåˆ¶è¢«å¯åŠ¨äº†ï¼›å¦‚æœæ˜¯neverï¼Œå°±è¡¨ç¤ºï¼Œå†…å­˜å¤§é¡µæœºåˆ¶è¢«ç¦æ­¢ã€‚</p><p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²æ—¶ï¼Œæˆ‘å»ºè®®ä½ ä¸è¦ä½¿ç”¨å†…å­˜å¤§é¡µæœºåˆ¶ï¼Œæ“ä½œä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†ï¼š</p><pre><code>echo never /sys/kernel/mm/transparent_hugepage/enabled\n</code></pre><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»æ–‡ä»¶ç³»ç»Ÿå’Œæ“ä½œç³»ç»Ÿä¸¤ä¸ªç»´åº¦ï¼Œç»™ä½ ä»‹ç»äº†åº”å¯¹Rediså˜æ…¢çš„æ–¹æ³•ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ä½ åº”ç”¨ï¼Œæˆ‘ç»™ä½ æ¢³ç†äº†ä¸€ä¸ªåŒ…å«9ä¸ªæ£€æŸ¥ç‚¹çš„Checklistï¼Œå¸Œæœ›ä½ åœ¨é‡åˆ°Redisæ€§èƒ½å˜æ…¢æ—¶ï¼ŒæŒ‰ç…§è¿™äº›æ­¥éª¤é€ä¸€æ£€æŸ¥ï¼Œé«˜æ•ˆåœ°è§£å†³é—®é¢˜ã€‚</p><ol>\n<li>è·å–Rediså®ä¾‹åœ¨å½“å‰ç¯å¢ƒä¸‹çš„åŸºçº¿æ€§èƒ½ã€‚</li>\n<li>æ˜¯å¦ç”¨äº†æ…¢æŸ¥è¯¢å‘½ä»¤ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œå°±ä½¿ç”¨å…¶ä»–å‘½ä»¤æ›¿ä»£æ…¢æŸ¥è¯¢å‘½ä»¤ï¼Œæˆ–è€…æŠŠèšåˆè®¡ç®—å‘½ä»¤æ”¾åœ¨å®¢æˆ·ç«¯åšã€‚</li>\n<li>æ˜¯å¦å¯¹è¿‡æœŸkeyè®¾ç½®äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Ÿå¯¹äºæ‰¹é‡åˆ é™¤çš„keyï¼Œå¯ä»¥åœ¨æ¯ä¸ªkeyçš„è¿‡æœŸæ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºæ•°ï¼Œé¿å…åŒæ—¶åˆ é™¤ã€‚</li>\n<li>æ˜¯å¦å­˜åœ¨bigkeyï¼Ÿ å¯¹äºbigkeyçš„åˆ é™¤æ“ä½œï¼Œå¦‚æœä½ çš„Redisæ˜¯4.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨å¼‚æ­¥çº¿ç¨‹æœºåˆ¶å‡å°‘ä¸»çº¿ç¨‹é˜»å¡ï¼›å¦‚æœæ˜¯Redis 4.0ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨SCANå‘½ä»¤è¿­ä»£åˆ é™¤ï¼›å¯¹äºbigkeyçš„é›†åˆæŸ¥è¯¢å’Œèšåˆæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨SCANå‘½ä»¤åœ¨å®¢æˆ·ç«¯å®Œæˆã€‚</li>\n<li>Redis AOFé…ç½®çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸šåŠ¡å±‚é¢æ˜¯å¦çš„ç¡®éœ€è¦è¿™ä¸€å¯é æ€§çº§åˆ«ï¼Ÿå¦‚æœæˆ‘ä»¬éœ€è¦é«˜æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿå…è®¸æ•°æ®ä¸¢å¤±ï¼Œå¯ä»¥å°†é…ç½®é¡¹no-appendfsync-on-rewriteè®¾ç½®ä¸ºyesï¼Œé¿å…AOFé‡å†™å’Œfsyncç«äº‰ç£ç›˜IOèµ„æºï¼Œå¯¼è‡´Rediså»¶è¿Ÿå¢åŠ ã€‚å½“ç„¶ï¼Œ å¦‚æœæ—¢éœ€è¦é«˜æ€§èƒ½åˆéœ€è¦é«˜å¯é æ€§ï¼Œæœ€å¥½ä½¿ç”¨é«˜é€Ÿå›ºæ€ç›˜ä½œä¸ºAOFæ—¥å¿—çš„å†™å…¥ç›˜ã€‚</li>\n<li>Rediså®ä¾‹çš„å†…å­˜ä½¿ç”¨æ˜¯å¦è¿‡å¤§ï¼Ÿå‘ç”Ÿswapäº†å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œå°±å¢åŠ æœºå™¨å†…å­˜ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨Redisé›†ç¾¤ï¼Œåˆ†æ‘Šå•æœºRedisçš„é”®å€¼å¯¹æ•°é‡å’Œå†…å­˜å‹åŠ›ã€‚åŒæ—¶ï¼Œè¦é¿å…å‡ºç°Rediså’Œå…¶ä»–å†…å­˜éœ€æ±‚å¤§çš„åº”ç”¨å…±äº«æœºå™¨çš„æƒ…å†µã€‚</li>\n<li>åœ¨Rediså®ä¾‹çš„è¿è¡Œç¯å¢ƒä¸­ï¼Œæ˜¯å¦å¯ç”¨äº†é€æ˜å¤§é¡µæœºåˆ¶ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œç›´æ¥å…³é—­å†…å­˜å¤§é¡µæœºåˆ¶å°±è¡Œäº†ã€‚</li>\n<li>æ˜¯å¦è¿è¡Œäº†Redisä¸»ä»é›†ç¾¤ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼ŒæŠŠä¸»åº“å®ä¾‹çš„æ•°æ®é‡å¤§å°æ§åˆ¶åœ¨2~4GBï¼Œä»¥å…ä¸»ä»å¤åˆ¶æ—¶ï¼Œä»åº“å› åŠ è½½å¤§çš„RDBæ–‡ä»¶è€Œé˜»å¡ã€‚</li>\n<li>æ˜¯å¦ä½¿ç”¨äº†å¤šæ ¸CPUæˆ–NUMAæ¶æ„çš„æœºå™¨è¿è¡ŒRediså®ä¾‹ï¼Ÿä½¿ç”¨å¤šæ ¸CPUæ—¶ï¼Œå¯ä»¥ç»™Rediså®ä¾‹ç»‘å®šç‰©ç†æ ¸ï¼›ä½¿ç”¨NUMAæ¶æ„æ—¶ï¼Œæ³¨æ„æŠŠRediså®ä¾‹å’Œç½‘ç»œä¸­æ–­å¤„ç†ç¨‹åºè¿è¡Œåœ¨åŒä¸€ä¸ªCPU Socketä¸Šã€‚</li>\n</ol><p>å®é™…ä¸Šï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½çš„å› ç´ è¿˜æœ‰å¾ˆå¤šï¼Œè¿™ä¸¤èŠ‚è¯¾ç»™ä½ è®²çš„éƒ½æ˜¯åº”å¯¹æœ€å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>å¦‚æœä½ é‡åˆ°äº†ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œä¹Ÿä¸è¦æ…Œï¼Œæˆ‘å†ç»™ä½ åˆ†äº«ä¸€ä¸ªå°æŠ€å·§ï¼šä»”ç»†æ£€æŸ¥ä¸‹æœ‰æ²¡æœ‰æ¼äººçš„â€œé‚»å±…â€ï¼Œå…·ä½“ç‚¹è¯´ï¼Œå°±æ˜¯Redisæ‰€åœ¨çš„æœºå™¨ä¸Šæœ‰æ²¡æœ‰ä¸€äº›å…¶ä»–å å†…å­˜ã€ç£ç›˜IOå’Œç½‘ç»œIOçš„ç¨‹åºï¼Œæ¯”å¦‚è¯´æ•°æ®åº“ç¨‹åºæˆ–è€…æ•°æ®é‡‡é›†ç¨‹åºã€‚å¦‚æœæœ‰çš„è¯ï¼Œæˆ‘å»ºè®®ä½ å°†è¿™äº›ç¨‹åºè¿ç§»åˆ°å…¶ä»–æœºå™¨ä¸Šè¿è¡Œã€‚</p><p>ä¸ºäº†ä¿è¯Redisé«˜æ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦ç»™Rediså……è¶³çš„è®¡ç®—ã€å†…å­˜å’ŒIOèµ„æºï¼Œç»™å®ƒæä¾›ä¸€ä¸ªâ€œå®‰é™â€çš„ç¯å¢ƒã€‚</p><h2>æ¯è¯¾ä¸€é—®</h2><p>è¿™ä¸¤èŠ‚è¯¾ï¼Œæˆ‘å‘ä½ ä»‹ç»äº†ç³»ç»Ÿæ€§å®šä½ã€æ’æŸ¥å’Œè§£å†³Rediså˜æ…¢çš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œæˆ‘æƒ³è¯·ä½ èŠä¸€èŠï¼Œä½ é‡åˆ°è¿‡Rediså˜æ…¢çš„æƒ…å†µå—ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œä½ æ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºåˆ†äº«ä¸€ä¸‹è‡ªå·±çš„ç»éªŒï¼Œå¦‚æœè§‰å¾—ä»Šå¤©çš„å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","neighbors":{"left":{"article_title":"18 | æ³¢åŠ¨çš„å“åº”å»¶è¿Ÿï¼šå¦‚ä½•åº”å¯¹å˜æ…¢çš„Redisï¼Ÿï¼ˆä¸Šï¼‰","id":286549},"right":{"article_title":"20 | åˆ é™¤æ•°æ®åï¼Œä¸ºä»€ä¹ˆå†…å­˜å ç”¨ç‡è¿˜æ˜¯å¾ˆé«˜ï¼Ÿ","id":289140}},"comments":[{"had_liked":false,"id":249385,"user_name":"Kaito","can_delete":false,"product_type":"c1","uid":1020042,"ip_address":"","ucode":"79775FA35A95F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","comment_is_top":false,"comment_ctime":1600617961,"is_pvip":true,"discussion_count":34,"race_medal":0,"score":"1899976162793","product_id":100056701,"comment_content":"å…³äºå¦‚ä½•åˆ†æã€æ’æŸ¥ã€è§£å†³Rediså˜æ…¢é—®é¢˜ï¼Œæˆ‘æ€»ç»“çš„checklistå¦‚ä¸‹ï¼š<br><br>1ã€ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤ï¼ˆä¾‹å¦‚SORT&#47;SUION&#47;ZUNIONSTORE&#47;KEYSï¼‰ï¼Œæˆ–ä¸€æ¬¡æŸ¥è¯¢å…¨é‡æ•°æ®ï¼ˆä¾‹å¦‚LRANGE key 0 Nï¼Œä½†Nå¾ˆå¤§ï¼‰<br><br>åˆ†æï¼ša) æŸ¥çœ‹slowlogæ˜¯å¦å­˜åœ¨è¿™äº›å‘½ä»¤ b) Redisè¿›ç¨‹CPUä½¿ç”¨ç‡æ˜¯å¦é£™å‡ï¼ˆèšåˆè¿ç®—å‘½ä»¤å¯¼è‡´ï¼‰<br><br>è§£å†³ï¼ša) ä¸ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤ï¼Œæˆ–ç”¨å…¶ä»–æ–¹å¼ä»£æ›¿å®ç°ï¼ˆæ”¾åœ¨å®¢æˆ·ç«¯åšï¼‰ b) æ•°æ®å°½é‡åˆ†æ‰¹æŸ¥è¯¢ï¼ˆLRANGE key 0 Nï¼Œå»ºè®®N&lt;=100ï¼ŒæŸ¥è¯¢å…¨é‡æ•°æ®å»ºè®®ä½¿ç”¨HSCAN&#47;SSCAN&#47;ZSCANï¼‰<br><br>2ã€æ“ä½œbigkey<br><br>åˆ†æï¼ša) slowlogå‡ºç°å¾ˆå¤šSET&#47;DELETEå˜æ…¢å‘½ä»¤ï¼ˆbigkeyåˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜å˜æ…¢ï¼‰ b) ä½¿ç”¨redis-cli -h $host -p $port --bigkeysæ‰«æå‡ºå¾ˆå¤šbigkey<br><br>è§£å†³ï¼ša) ä¼˜åŒ–ä¸šåŠ¡ï¼Œé¿å…å­˜å‚¨bigkey b) Redis 4.0+å¯å¼€å¯lazy-freeæœºåˆ¶<br><br>3ã€å¤§é‡keyé›†ä¸­è¿‡æœŸ<br><br>åˆ†æï¼ša) ä¸šåŠ¡ä½¿ç”¨EXPIREAT&#47;PEXPIREATå‘½ä»¤ b) Redis infoä¸­çš„expired_keysæŒ‡æ ‡çŸ­æœŸçªå¢<br><br>è§£å†³ï¼ša) ä¼˜åŒ–ä¸šåŠ¡ï¼Œè¿‡æœŸå¢åŠ éšæœºæ—¶é—´ï¼ŒæŠŠæ—¶é—´æ‰“æ•£ï¼Œå‡è½»åˆ é™¤è¿‡æœŸkeyçš„å‹åŠ› b) è¿ç»´å±‚é¢ï¼Œç›‘æ§expired_keysæŒ‡æ ‡ï¼Œæœ‰çŸ­æœŸçªå¢åŠæ—¶æŠ¥è­¦æ’æŸ¥<br><br>4ã€Rediså†…å­˜è¾¾åˆ°maxmemory<br><br>åˆ†æï¼ša) å®ä¾‹å†…å­˜è¾¾åˆ°maxmemoryï¼Œä¸”å†™å…¥é‡å¤§ï¼Œæ·˜æ±°keyå‹åŠ›å˜å¤§ b) Redis infoä¸­çš„evicted_keysæŒ‡æ ‡çŸ­æœŸçªå¢<br><br>è§£å†³ï¼ša) ä¸šåŠ¡å±‚é¢ï¼Œæ ¹æ®æƒ…å†µè°ƒæ•´æ·˜æ±°ç­–ç•¥ï¼ˆéšæœºæ¯”LRUå¿«ï¼‰ b) è¿ç»´å±‚é¢ï¼Œç›‘æ§evicted_keysæŒ‡æ ‡ï¼Œæœ‰çŸ­æœŸçªå¢åŠæ—¶æŠ¥è­¦ c) é›†ç¾¤æ‰©å®¹ï¼Œå¤šä¸ªå®ä¾‹å‡è½»æ·˜æ±°keyçš„å‹åŠ›<br><br>5ã€å¤§é‡çŸ­è¿æ¥è¯·æ±‚<br><br>åˆ†æï¼šRediså¤„ç†å¤§é‡çŸ­è¿æ¥è¯·æ±‚ï¼ŒTCPä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹ä¹Ÿä¼šå¢åŠ è€—æ—¶<br><br>è§£å†³ï¼šä½¿ç”¨é•¿è¿æ¥æ“ä½œRedis<br><br>6ã€ç”ŸæˆRDBå’ŒAOFé‡å†™forkè€—æ—¶ä¸¥é‡<br><br>åˆ†æï¼ša) Rediså˜æ…¢åªå‘ç”Ÿåœ¨ç”ŸæˆRDBå’ŒAOFé‡å†™æœŸé—´ b) å®ä¾‹å ç”¨å†…å­˜è¶Šå¤§ï¼Œforkæ‹·è´å†…å­˜é¡µè¡¨è¶Šä¹… c) Redis infoä¸­latest_fork_usecè€—æ—¶å˜é•¿<br><br>è§£å†³ï¼ša) å®ä¾‹å°½é‡å° b) Rediså°½é‡éƒ¨ç½²åœ¨ç‰©ç†æœºä¸Š c) ä¼˜åŒ–å¤‡ä»½ç­–ç•¥ï¼ˆä¾‹å¦‚ä½å³°æœŸå¤‡ä»½ï¼‰ d) åˆç†é…ç½®repl-backlogå’Œslave client-output-buffer-limitï¼Œé¿å…ä¸»ä»å…¨é‡åŒæ­¥ e) è§†æƒ…å†µè€ƒè™‘å…³é—­AOF f) ç›‘æ§latest_fork_usecè€—æ—¶æ˜¯å¦å˜é•¿<br><br>7ã€AOFä½¿ç”¨awalysæœºåˆ¶<br><br>åˆ†æï¼šç£ç›˜IOè´Ÿè½½å˜é«˜<br><br>è§£å†³ï¼ša) ä½¿ç”¨everysecæœºåˆ¶ b) ä¸¢å¤±æ•°æ®ä¸æ•æ„Ÿçš„ä¸šåŠ¡ä¸å¼€å¯AOF<br><br>8ã€ä½¿ç”¨Swap<br><br>åˆ†æï¼ša) æ‰€æœ‰è¯·æ±‚å…¨éƒ¨å¼€å§‹å˜æ…¢ b) slowlogå¤§é‡æ…¢æ—¥å¿— c) æŸ¥çœ‹Redisè¿›ç¨‹æ˜¯å¦ä½¿ç”¨åˆ°äº†Swap<br><br>è§£å†³ï¼ša) å¢åŠ æœºå™¨å†…å­˜ b) é›†ç¾¤æ‰©å®¹ c) Swapä½¿ç”¨æ—¶ç›‘æ§æŠ¥è­¦<br><br>9ã€è¿›ç¨‹ç»‘å®šCPUä¸åˆç†<br><br>åˆ†æï¼ša) Redisè¿›ç¨‹åªç»‘å®šä¸€ä¸ªCPUé€»è¾‘æ ¸ b) NUMAæ¶æ„ä¸‹ï¼Œç½‘ç»œä¸­æ–­å¤„ç†ç¨‹åºå’ŒRedisè¿›ç¨‹æ²¡æœ‰ç»‘å®šåœ¨åŒä¸€ä¸ªSocketä¸‹<br><br>è§£å†³ï¼ša) Redisè¿›ç¨‹ç»‘å®šå¤šä¸ªCPUé€»è¾‘æ ¸ b) ç½‘ç»œä¸­æ–­å¤„ç†ç¨‹åºå’ŒRedisè¿›ç¨‹ç»‘å®šåœ¨åŒä¸€ä¸ªSocketä¸‹<br><br>10ã€å¼€å¯é€æ˜å¤§é¡µæœºåˆ¶<br><br>åˆ†æï¼šç”ŸæˆRDBå’ŒAOFé‡å†™æœŸé—´ï¼Œä¸»çº¿ç¨‹å¤„ç†å†™è¯·æ±‚è€—æ—¶å˜é•¿ï¼ˆæ‹·è´å†…å­˜å‰¯æœ¬è€—æ—¶å˜é•¿ï¼‰<br><br>è§£å†³ï¼šå…³é—­é€æ˜å¤§é¡µæœºåˆ¶<br><br>11ã€ç½‘å¡è´Ÿè½½è¿‡é«˜<br><br>åˆ†æï¼ša) TCP&#47;IPå±‚å»¶è¿Ÿå˜å¤§ï¼Œä¸¢åŒ…é‡ä¼ å˜å¤š b) æ˜¯å¦å­˜åœ¨æµé‡è¿‡å¤§çš„å®ä¾‹å æ»¡å¸¦å®½<br><br>è§£å†³ï¼ša) æœºå™¨ç½‘ç»œèµ„æºç›‘æ§ï¼Œè´Ÿè½½è¿‡é«˜åŠæ—¶æŠ¥è­¦ b) æå‰è§„åˆ’éƒ¨ç½²ç­–ç•¥ï¼Œè®¿é—®é‡å¤§çš„å®ä¾‹éš”ç¦»éƒ¨ç½²<br><br>æ€»ä¹‹ï¼ŒRedisçš„æ€§èƒ½ä¸CPUã€å†…å­˜ã€ç½‘ç»œã€ç£ç›˜éƒ½æ¯æ¯ç›¸å…³ï¼Œä»»ä½•ä¸€å¤„å‘ç”Ÿé—®é¢˜ï¼Œéƒ½ä¼šå½±å“åˆ°Redisçš„æ€§èƒ½ã€‚<br><br>ä¸»è¦æ¶‰åŠåˆ°çš„åŒ…æ‹¬ä¸šåŠ¡ä½¿ç”¨å±‚é¢å’Œè¿ç»´å±‚é¢ï¼šä¸šåŠ¡äººå‘˜éœ€è¦äº†è§£RedisåŸºæœ¬çš„è¿è¡ŒåŸç†ï¼Œä½¿ç”¨åˆç†çš„å‘½ä»¤ã€è§„é¿bigkeé—®é¢˜å’Œé›†ä¸­è¿‡æœŸé—®é¢˜ã€‚è¿ç»´å±‚é¢éœ€è¦DBAæå‰è§„åˆ’å¥½éƒ¨ç½²ç­–ç•¥ï¼Œé¢„ç•™è¶³å¤Ÿçš„èµ„æºï¼ŒåŒæ—¶åšå¥½ç›‘æ§ï¼Œè¿™æ ·å½“å‘ç”Ÿé—®é¢˜æ—¶ï¼Œèƒ½å¤ŸåŠæ—¶å‘ç°å¹¶å°½å¿«å¤„ç†ã€‚","like_count":443,"discussions":[{"author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378011,"discussion_content":"å…³äºå¦‚ä½•åˆ†æã€æ’æŸ¥ã€è§£å†³ Redis å˜æ…¢é—®é¢˜ï¼Œæˆ‘æ–°å†™äº†ç¯‡æ–‡ç« ï¼ŒåŸºæœ¬è¦†ç›–äº†ä¼šé‡åˆ°çš„æ‰€æœ‰æ€§èƒ½é—®é¢˜ï¼Œåº”è¯¥å¯¹å¤§å®¶å¾ˆæœ‰å¸®åŠ©ï¼Œã€ŠRedisä¸ºä»€ä¹ˆå˜æ…¢äº†ï¼Ÿä¸€æ–‡è®²é€å¦‚ä½•æ’æŸ¥Redisiæ€§èƒ½é—®é¢˜ã€‹ï¼šhttps://mp.weixin.qq.com/s/Qc4t_-_pL4w8VlSoJhRDcg","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1622995953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2124243,"avatar":"https://static001.geekbang.org/account/avatar/00/20/69/d3/97510c5b.jpg","nickname":"èå“¥ | å‘¨ä¼˜å†›","note":"","ucode":"5DDD9CC85A2E6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":579986,"discussion_content":"è¯¾ä»£è¡¨ç»ˆäºå¼€è¯¾äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657789345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378011,"ip_address":""},"score":579986,"extra":""}]},{"author":{"id":1503506,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f1/12/7dac30d6.jpg","nickname":"ä½ ä¸ºå•¥é‚£ä¹ˆç‰›","note":"","ucode":"1ABC604A54A8F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340906,"discussion_content":"é€ä½ ä¸€æœµå°çº¢èŠ±","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1610197721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1434423,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e3/37/c132802f.jpg","nickname":"WESTWALL","note":"","ucode":"295A030F9D3BF4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406872,"discussion_content":"è€å¸ˆ+è¯¾ä»£è¡¨æ‰æ˜¯å®Œæ•´çš„è¯¾","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1634863304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377158,"discussion_content":"èµ·å§‹è¿™é‡Œçš„é—®é¢˜å¯ä»¥æ‰©å±•åˆ°å¾ˆå¤šç‚¹ å› ä¸ºæœ¬è´¨ä¸Šredisæ˜¯éƒ¨ç½²åœ¨linuxä¸Šçš„ã€‚é‚£ä¹ˆä½œä¸ºä¸€ä¸ªå†…å­˜æ•°æ®åº“å¿…ç„¶å—åˆ¶äºä¸¤ä¸ªå› ç´  ä¸€æ˜¯å†…å­˜åˆ†é… äºŒæ˜¯æ•°æ®æŒä¹…åŒ–ã€‚\n\næˆ‘ä»¬å…ˆæ¥çœ‹ å†…å­˜åˆ†é…ã€‚ä¹‹å‰è€å¸ˆè§£é‡Šè¿‡å†…å­˜åˆ†é…redisç”¨çš„jmalloc è¿™ç§ç‰¹æ€§ä¼šé€ æˆä¸€å®šçš„æ•°æ®ç¢ç‰‡ å¦å¤–ä¸freeç»“åˆä½¿ç”¨æ—¶ å®é™…ä¸Šæ˜¯å†…å­˜æ ‡è®°å›æ”¶æ‰€ä»¥å†…å­˜ç¢ç‰‡æ˜¯å¤©ç„¶å­˜åœ¨çš„ã€‚\n\nå†æ¥çœ‹æ•°æ®æŒä¹…åŒ– æ­¤å¤„ç”¨çš„æ˜¯fork &amp;&amp; fsync &amp;&amp; writeã€‚fsyncæ¯«æ— ç–‘é—®æ˜¯write throughçš„ è€Œwriteæ˜¾ç„¶æ˜¯write backã€‚ è¿™ä¸¤ç§æ¨¡å¼è‡ªèº«çš„é—®é¢˜å°±ä¸åšè®¨è®ºäº† æ¯•ç«Ÿä¸æ˜¯linuxè¯¾ç¨‹ã€‚æ‰€ä»¥å› ä¸ºæ–‡ä»¶ç³»ç»Ÿè‡ªèº«æœºåˆ¶å¦‚ext3 ext4ç­‰ä¹‹ç±»çš„é—®é¢˜ä¾ç„¶ä¼šé™åˆ¶rediså­è¿›ç¨‹è½ç›˜ å¯¼è‡´ä¸»è¿›ç¨‹ç›‘æ§æ—¶æœŸå¡é¡¿","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1622532367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129709,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/ed/9b42e3e2.jpg","nickname":"é¢å‘è¿æ°”å¼€å‘","note":"","ucode":"F23361FB85D02C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320251,"discussion_content":"è¯¾ä»£è¡¨å¥½ï¼è¯·æ•™ä¸€ä¸‹ ç¬¬äº”æ¡å¦‚ä½•ç›‘æ§çŸ­è¿æ¥ redisæ”¯æŒå—ï¼Ÿè¿˜æ˜¯å¾—ç”¨Linuxå·¥å…·","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1604301956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2148214,"avatar":"https://static001.geekbang.org/account/avatar/00/20/c7/76/9c6dc09c.jpg","nickname":"say goodbye","note":"","ucode":"51A88796DD77CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545810,"discussion_content":"å‡†å¤‡æ‹¿è¿™ä¸ªåŠæ‰“é¢è¯•å®˜äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1642056732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2185166,"avatar":"https://static001.geekbang.org/account/avatar/00/21/57/ce/ad3c3954.jpg","nickname":"é¹…é¹…é¹…","note":"","ucode":"6AFA3FCC7B5AEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374895,"discussion_content":"ç‰›é€¼æ–¯ç§‘æ‹‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1621404744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3201606,"avatar":"","nickname":"Geek_c5eb91","note":"","ucode":"650C7D09442F51","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590836,"discussion_content":"é“ä»”ï¼Œèƒ½å¦å€Ÿä¸€æ­¥å†è¯´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666097522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ±Ÿè¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3065276,"avatar":"","nickname":"Geek_b3b8da","note":"","ucode":"5461CD95B1D764","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590006,"discussion_content":"æˆ‘å‡†å¤‡æŠŠè¿™ä¸ªèƒŒä¼šäº†å»åŠæ‰“é¢è¯•å®˜å»å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665459882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207977,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6e/a9/e7b9e92e.jpg","nickname":"èœ—ç‰›æ¼«æ­¥","note":"","ucode":"825F27BAF9A194","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574728,"discussion_content":"ç‚¹èµæ”¶è—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654306836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2911084,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/6b/6c/3e80afaf.jpg","nickname":"HappyHasson","note":"","ucode":"B84CC43E349CFA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554779,"discussion_content":"è¯·æ•™ï¼š \nâ€œåˆ†æï¼ša) ä¸šåŠ¡ä½¿ç”¨EXPIREAT/PEXPIREATå‘½ä»¤ b) Redis infoä¸­çš„expired_keysæŒ‡æ ‡çŸ­æœŸçªå¢\n\nè§£å†³ï¼ša) ä¼˜åŒ–ä¸šåŠ¡ï¼Œè¿‡æœŸå¢åŠ éšæœºæ—¶é—´ï¼ŒæŠŠæ—¶é—´æ‰“æ•£ï¼Œå‡è½»åˆ é™¤è¿‡æœŸkeyçš„å‹åŠ›â€\n\nè¿™é‡Œçš„å°†æ—¶é—´æ‰“æ•£ï¼Œæ‰“æ•£çš„æ—¶é—´åŒºé—´åº”è¯¥ä¸ºå¤šå¤§ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Ÿ1sï¼Ÿ10sç­‰ç­‰ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646615666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1415619,"avatar":"https://static001.geekbang.org/account/avatar/00/15/99/c3/e4f408d4.jpg","nickname":"é™Œå…®","note":"","ucode":"00CE47CAECD5CD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553514,"discussion_content":"å‰å®³ï¼Œmark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645942382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1114878,"avatar":"https://static001.geekbang.org/account/avatar/00/11/02/fe/d539b96b.jpg","nickname":"æ›¹ç¿”","note":"","ucode":"B4D8B42DFB535C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549642,"discussion_content":"å»ºè®®å†™æ˜é‡‘å°å†Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644160227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1238337,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e5/41/ffe533ba.jpg","nickname":"å°šå¸","note":"","ucode":"6F1703FD5A23A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541236,"discussion_content":"æ€»ç»“ç‰›B","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640309869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1236156,"avatar":"https://static001.geekbang.org/account/avatar/00/12/dc/bc/3c5a1634.jpg","nickname":"Loyalty","note":"","ucode":"C23EE6878580C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407580,"discussion_content":"å‰å®³å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635065169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363903,"discussion_content":"æ”¶è—äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617324111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1180028,"avatar":"https://static001.geekbang.org/account/avatar/00/12/01/7c/836cf29e.jpg","nickname":"Yang.ğŸ­","note":"","ucode":"3A09F586CBC571","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362320,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616919643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2049478,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/45/c6/ba5176a6.jpg","nickname":"ä»ä¸å–èŒ","note":"","ucode":"E9B7B1C8FAFE0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350666,"discussion_content":"å¤ªç‰›çš®äº†..è†œæ‹œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613971574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1243429,"avatar":"https://static001.geekbang.org/account/avatar/00/12/f9/25/576088ef.jpg","nickname":"è½©æœˆ","note":"","ucode":"E5277B5718CA30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347083,"discussion_content":"æ¯èŠ‚è¯¾ä¼°è®¡çœ‹è¯¾ä»£è¡¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612148524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2172420,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/r2nR7Zkl5RP7LobsNKJ6wmmtyXrh4alNSAOldx1y1PSeFB1J2I14HE4I0BCgicPhubIOibPZAENzEpHEWTFjMNqg/132","nickname":"è‘£è‘£","note":"","ucode":"C222E275545158","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342789,"discussion_content":"å¤§ä½¬ï¼Œå¤§é‡keyé›†ä¸­è¿‡æœŸä¼šé˜»å¡ä¸»çº¿ç¨‹ä¹ˆï¼Œä¹‹å‰çš„è¯¾è¯´çš„ä¼šï¼Œä½†æ˜¯4.0ä¹‹åä¸æ˜¯ä½¿ç”¨å¼‚æ­¥è¿›è¡Œåˆ é™¤äº†ä¹ˆï¼Œæ€ä¹ˆè¿˜ä¼šé˜»å¡ä¸»çº¿ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610810503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":5,"child_discussions":[{"author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2172420,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/r2nR7Zkl5RP7LobsNKJ6wmmtyXrh4alNSAOldx1y1PSeFB1J2I14HE4I0BCgicPhubIOibPZAENzEpHEWTFjMNqg/132","nickname":"è‘£è‘£","note":"","ucode":"C222E275545158","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342795,"discussion_content":"4.0+ç‰ˆæœ¬éœ€è¦æ‰“å¼€lazy-freeï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1610811612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342789,"ip_address":""},"score":342795,"extra":""},{"author":{"id":1022411,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/99/cb/8964faab.jpg","nickname":"-åªæ˜¯å°å°é…è§’_","note":"","ucode":"EFC1CD54A23F39","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2172420,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/r2nR7Zkl5RP7LobsNKJ6wmmtyXrh4alNSAOldx1y1PSeFB1J2I14HE4I0BCgicPhubIOibPZAENzEpHEWTFjMNqg/132","nickname":"è‘£è‘£","note":"","ucode":"C222E275545158","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348886,"discussion_content":"æˆ‘çš„è®¤è¯†ï¼šRedisçš„å®šæœŸåˆ é™¤æœºåˆ¶ä¼šè‡ªåŠ¨æ‰«æè¿‡æœŸçš„keyå¹¶åˆ é™¤æ•°æ®é‡Šæ”¾å†…å­˜ï¼Œä½†å¤§é‡keyè¿‡æœŸçš„æ—¶å€™ï¼Œå®šæœŸåˆ é™¤æœºåˆ¶åˆ¤æ–­å‡ºè¿‡æœŸkeyçš„é‡å¤§äºæ€»keyçš„25%æ—¶ï¼Œä¼šæŒç»­çš„è¿›è¡Œåˆ é™¤è¿‡æœŸkeyï¼Œè¿™ä¸ªè¿‡ç¨‹å¦‚æœæŒç»­æ—¶é—´è¿‡é•¿ï¼Œå¯¹ä¸»çº¿ç¨‹çš„å†…å­˜æ“ä½œä¼šæœ‰å½±å“ï¼Œè¿™åº”è¯¥æ˜¯é˜»å¡çš„åŸå› å§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612769331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342789,"ip_address":""},"score":348886,"extra":""},{"author":{"id":1101762,"avatar":"https://static001.geekbang.org/account/avatar/00/10/cf/c2/a5b3ceaf.jpg","nickname":"helloworld","note":"","ucode":"003700A99A910B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1020042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/90/8a/288f9f94.jpg","nickname":"Kaito","note":"","ucode":"79775FA35A95F2","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":349014,"discussion_content":"è¯¾ä»£è¡¨,æˆ‘çœ‹äº†ä½ ä¸ŠèŠ‚è¯¾çš„æ€»ç»“,å¦‚æœå¤§äº†é›†ä¸­è¿‡æœŸçš„æ˜¯String ç±»å‹çš„å¤§ key,ä»–ä»¬çš„å†…å­˜æ˜¯è¿ç»­çš„,é‡Šæ”¾çš„ä»£ä»·å°,æ‰€ä»¥å³ä½¿å¼€å¯äº† lazy-free,é‡Šæ”¾å†…å­˜çš„æ“ä½œä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„å§,è¿™æ ·å°±ä¼šå¯¼è‡´ä¸»çº¿ç¨‹é˜»å¡äº†.","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612849620,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":342795,"ip_address":""},"score":349014,"extra":""}]},{"author":{"id":1620364,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b9/8c/b3820a21.jpg","nickname":"æ²‰å¯‚","note":"","ucode":"824ADCCB511019","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339379,"discussion_content":"å‰å®³ğŸ‘ğŸ»\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609651497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1049017,"avatar":"https://static001.geekbang.org/account/avatar/00/10/01/b9/73435279.jpg","nickname":"å­¦ä¹ å­¦ä¸ªå±","note":"","ucode":"DF2D61E6FB2FCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319863,"discussion_content":"è¯¾ä»£è¡¨~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604147735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2136414,"avatar":"https://static001.geekbang.org/account/avatar/00/20/99/5e/33481a74.jpg","nickname":"Lemon","note":"","ucode":"E52BB361B69825","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307524,"discussion_content":"æ¬å¥½å°æ¿å‡³æ¥è¯„è®ºåŒºè¡¥è¯¾äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600676229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1312184,"avatar":"https://static001.geekbang.org/account/avatar/00/14/05/b8/8d468842.jpg","nickname":"JulyRemember","note":"","ucode":"9E3D5D60D82999","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307472,"discussion_content":"è¿˜æ˜¯æƒ³é—®ä¸‹ä½ ä»¬ç”Ÿäº§æ€ä¹ˆä½¿ç”¨rediså‘½ä»¤å•Šï¼Œæˆ‘ä»¬ç”Ÿäº§æœºå™¨éƒ½æ²¡æœ‰æƒé™ï¼Œè¿˜æ˜¯ä¹°çš„é˜¿é‡Œäº‘ï¼Œåªèƒ½å‡ºç°é—®é¢˜åˆ°è¿ç»´é‚£çœ‹å§ï¼Œredisçš„ç›‘æ§è¿˜æ˜¯å¯ä»¥åœ¨é˜¿é‡Œäº‘çœ‹åˆ°çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600662485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1312184,"avatar":"https://static001.geekbang.org/account/avatar/00/14/05/b8/8d468842.jpg","nickname":"JulyRemember","note":"","ucode":"9E3D5D60D82999","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307519,"discussion_content":"æˆ‘è®°å¾—å¯ä»¥å¼€æ”¾æœ‰é™çš„å‘½ä»¤å‡ºæ¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600674954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307472,"ip_address":""},"score":307519,"extra":""},{"author":{"id":1811495,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","nickname":"å°è¢","note":"","ucode":"3F5D8721F577D9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1312184,"avatar":"https://static001.geekbang.org/account/avatar/00/14/05/b8/8d468842.jpg","nickname":"JulyRemember","note":"","ucode":"9E3D5D60D82999","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307612,"discussion_content":"æ²¡æœ‰å°±é—®ä»–ä»¬æ‹¿ï¼Œä»–ä»¬ä¸ç»™å°±è®©ä»–ä»¬æŸ¥é—®é¢˜ã€‚ä»˜è´¹äº†è¿˜è·Ÿä»–ä»¬å®¢æ°”ä»€ä¹ˆ","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1600696280,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307472,"ip_address":""},"score":307612,"extra":""},{"author":{"id":1998835,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/7f/f3/010d9634.jpg","nickname":"Owen Zhang","note":"","ucode":"48D2063B87AD8F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1811495,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a4/27/15e75982.jpg","nickname":"å°è¢","note":"","ucode":"3F5D8721F577D9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343619,"discussion_content":"è¯´æ˜¯è¿™æ ·è¯´ï¼Œä½†é‡åˆ°ç´§æ€¥äº‹ä»¶ï¼Œè®©ä»–ä»¬æŸ¥èŠ±æ—¶é—´å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611112326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":307612,"ip_address":""},"score":343619,"extra":""}]}]},{"had_liked":false,"id":249422,"user_name":"ê§å­åå®å®èŒèŒå“’ê§‚","can_delete":false,"product_type":"c1","uid":1165662,"ip_address":"","ucode":"3E5BBAF15064B6","user_header":"https://static001.geekbang.org/account/avatar/00/11/c9/5e/b79e6d5d.jpg","comment_is_top":false,"comment_ctime":1600653481,"is_pvip":false,"discussion_count":3,"race_medal":1,"score":"83205032105","product_id":100056701,"comment_content":"<br>echo never &#47;sys&#47;kernel&#47;mm&#47;transparent_hugepage&#47;enabled <br>è¿™ä¸ªæ˜¯ä¸æ˜¯å¾—æ”¹æˆ<br>echo never &gt; &#47;sys&#47;kernel&#47;mm&#47;transparent_hugepage&#47;enabled<br>è¿™æ ·ï¼Ÿ","like_count":20,"discussions":[{"author":{"id":1435733,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e8/55/92f82281.jpg","nickname":"MClink","note":"","ucode":"F479190923355C","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307793,"discussion_content":"å¯¹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600761044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581902,"discussion_content":"æ€ä¹ˆæ”¹å›æ¥ï¼Ÿ ableï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659064298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2340552,"avatar":"https://static001.geekbang.org/account/avatar/00/23/b6/c8/35948bf5.jpg","nickname":"æ—è“","note":"","ucode":"36E4445613E1C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585359,"discussion_content":"echo always &gt; /sys/kernel/mm/transparent_hugepage/enabled","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661499677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":581902,"ip_address":"åŒ—äº¬"},"score":585359,"extra":""}]}]},{"had_liked":false,"id":249871,"user_name":"ç‹ä¸–è‰º","can_delete":false,"product_type":"c1","uid":1899435,"ip_address":"","ucode":"04DA844568766B","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fb/ab/c0c29cda.jpg","comment_is_top":false,"comment_ctime":1600838904,"is_pvip":true,"discussion_count":5,"race_medal":0,"score":"61730381048","product_id":100056701,"comment_content":"çœ‹äº†ä¸‹ï¼Œè²Œä¼¼æ˜¯è¿™æ ·<br>redis æœ‰ä¸€ä¸ªaof_bufç¼“å­˜,ç”¨æ¥ç¼“å­˜æ–°çš„aofæ“ä½œä¿¡æ¯ã€‚<br>æ­£å¸¸æƒ…å†µä¸‹ä¸»çº¿ç¨‹æ¯æ¬¡å¾ªç¯éƒ½æ˜¯å…ˆå°†aof_buff writeï¼Œç„¶åaof_bufæ˜¯æ¸…ç©ºï¼Œ<br>ä¸»çº¿ç¨‹ä¼šç”¨å»fsyncï¼Œå·²ç»writeçš„å†…å®¹ã€‚<br>åˆ·ç›˜å½“æ—¶awaysçš„æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹å»ç›´æ¥è°ƒç”¨redis_fsyncã€‚<br>ä½†æ˜¯å½“ç­–ç•¥æ˜¯EVERYSECæ—¶ï¼Œä¸»çº¿ç¨‹ä¼šç”¨aof_background_fsyncä¸­çš„bioCreateBackgroundJob(BIO_AOF_FSYNC,(void*)(long)fd,NULL,NULL);åˆ›å»ºå­çº¿ç¨‹å»å®Œæˆã€‚<br><br>ä½†æ˜¯å½“ioå‹åŠ›å¤§çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯aof_bufæœ‰ç§¯å‹æ˜¯ã€‚ä¸»çº¿ç¨‹åœ¨EVERYSECæ¨¡å¼ä¸‹å›å»åˆ¤æ–­ã€‚æ˜¯å¦æœ‰aofwriteåœ¨æ‰§è¡Œï¼Œå¹¶è¶…è¿‡2s<br>å¦‚æœè¶…è¿‡2sä¸»çº¿ç¨‹ä¸ä¼šreturnï¼Œç»§ç»­å°†aof_buf write<br>ä»£ç ï¼šnwritten = aofWrite(server.aof_fd,server.aof_buf,sdslen(server.aof_buf));<br>ä½†æ˜¯å› ä¸ºå­çº¿ç¨‹åœ¨aof_fdä¸Šfsyncï¼Œæ‰€ä»¥write aof_fdçš„è¯·æ±‚ä¼šè¢«å µå¡,è¿™é‡Œwriteå…¨æ˜¯ä¸»çº¿ç¨‹åœ¨æ“ä½œï¼Œå µå¡ç›´åˆ°fsyncå®Œæˆï¼Œèƒ½æ”¹å˜æ–‡ä»¶æè¿°ç¬¦ï¼ˆaof_fdï¼‰,ä¸»çº¿ç¨‹æ‰å¯ä»¥ç»§ç»­å“åº”è¯·æ±‚","like_count":15,"discussions":[{"author":{"id":2131606,"avatar":"","nickname":"Geek_da4cfb","note":"","ucode":"DB59B24A249713","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321065,"discussion_content":"æ±‚å¤§ç¥è§£é‡Šä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604538918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2131606,"avatar":"","nickname":"Geek_da4cfb","note":"","ucode":"DB59B24A249713","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321063,"discussion_content":"æ²¡çœ‹æ‡‚å‘€ğ“€¤ğ“€¤ğ“€¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604538905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1784022,"avatar":"","nickname":"pippin","note":"","ucode":"F7619FCE24D481","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320398,"discussion_content":"ä¸çŸ¥é“æˆ‘è¿™æ ·è¯´çš„å¯¹ä¸å¯¹ï¼Œåœ¨everysecæ¨¡å¼ä¸‹ï¼Œå½“aof_buffå†…çš„æ•°æ®å¾ˆå¤šï¼Œä¹Ÿå°±æ˜¯æ¯ç§’äº§ç”Ÿçš„å†™æ“ä½œå¾ˆå¤šï¼Œä¸»çº¿ç¨‹ä¼šåˆ¤æ–­åå°å­è¿›ç¨‹çš„å†™æ“ä½œæ˜¯å¦æœ‰æ‰§è¡Œè¶…è¿‡ä¸¤ç§’çš„ï¼Œæœ‰çš„è¯ä¸»çº¿ç¨‹å°±ä¸ä¼šå†å¯åŠ¨ä¸€ä¸ªåå°å­è¿›ç¨‹ã€‚æˆ‘è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œå†™å…¥aofæ—¥å¿—çš„åå°å­è¿›ç¨‹æ˜¯åªæœ‰ä¸€ä¸ªè¿˜æ˜¯ä¼šæ¯ç§’åˆ›å»ºä¸€ä¸ªã€‚æŒ‰æ¥¼ä¸»è¯´çš„æ˜¯å†™å…¥aofæ—¥å¿—çš„è¿›ç¨‹åªä¼šæœ‰ä¸€ä¸ªï¼Œä½†å­è¿›ç¨‹æ‰§è¡Œè¶…è¿‡1ç§’ä½†æ²¡è¶…è¿‡ä¸¤ç§’ï¼Œåˆ™ä¸»çº¿ç¨‹è¿˜æ˜¯ä¼šreturnã€‚é‚£è¿™æ—¶å€™å‡ºç°å®•æœºæ˜¯ä¼šä¸¢å¤±ä¸¤ç§’çš„æ•°æ®å—ï¼Ÿè¿˜æœ‰å­è¿›ç¨‹æ‰§è¡Œè¶…è¿‡ä¸¤ç§’ï¼Œä¸»çº¿ç¨‹å°±ä¼šé˜»å¡å­è¿›ç¨‹ï¼Œè‡ªå·±æ¥å®Œæˆaofçš„æ—¥å¿—å†™å…¥ã€‚è¿™é‡Œçš„aof_fdæˆ‘å¯ä»¥ç†è§£ä¸ºaofæ—¥å¿—æ–‡ä»¶å—ï¼Œé‚£å­è¿›ç¨‹å†™å…¥éƒ½è¶…è¿‡ä¸¤ç§’äº†ï¼Œä¸»çº¿ç¨‹æ’æ‰‹æ€ä¹ˆä¿è¯æ•°æ®ä¸é‡å¤å†™å…¥ï¼Ÿæ€ä¹ˆä¿è¯æ•°æ®å†™å…¥çš„å‡†ç¡®æ€§ï¼Ÿè¿˜æœ‰ä¸»çº¿ç¨‹è‡ªå·±å»å†™å…¥aofæ—¥å¿—äº†ï¼Œé‚£è¿™æ—¶å€™rediså¯¹å¤–çš„è¯·æ±‚æ˜¯ä¸å“åº”çš„ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•ä¼˜åŒ–å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604362699,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1812201,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132","nickname":"æœ«æ—¥ï¼Œæˆæ¬¢","note":"","ucode":"BBAEBB9C93558A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1784022,"avatar":"","nickname":"pippin","note":"","ucode":"F7619FCE24D481","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559735,"discussion_content":"åªæœ‰1ä¸ªçº¿ç¨‹ï¼Œ ä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼Œ ç›¸å½“äºæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ç›‘æ§è¿™ä¸ªé˜Ÿåˆ—ï¼Œ å¦‚æœé˜Ÿåˆ—æœ‰äº†æ•°æ®ï¼Œ å°±æ‰§è¡Œaofæ—¥å¿—æ–‡ä»¶åŒæ­¥åˆ·ç›˜ã€‚\nå½“æ‰§è¡Œaofæ–‡ä»¶è¿½åŠ æ—¶ï¼Œä¸€èˆ¬æƒ…å†µå†™å…ˆæ”¾å˜åŠ¨æƒ…å†µåˆ°æ”¾åˆ°aof_bufï¼Œç„¶åå°†aof_bufçš„æ•°æ®å†™åˆ°aof_fdæè¿°ç¬¦ä¸­ï¼Œ åœ¨å°†aof_fdåŒæ­¥æˆ–å¼‚æ­¥åˆ·ç›˜ï¼Œ å½“å‘ç”Ÿæ—¥å¿—é‡å†™æ˜¯ï¼Œæ­¤æ—¶ç£ç›˜å‹åŠ›è¾ƒå¤§ï¼Œ fsyncåˆ·ç›˜ä¼šè¢«é˜»å¡ï¼Œredisä¼šåˆ¤æ–­ï¼Œ å¦‚æœå‘ç”Ÿé‡å†™æ—¶ï¼Œ é˜Ÿåˆ—ä¸­çš„æ•°é‡æ˜¯å¦è¶…è¿‡1ï¼Œ å¦‚æœè¶…è¿‡1 è¿˜å°äº2s, å°±ç›´æ¥è¿”å›ï¼Œ ç­‰å¾…ä¸‹ä¸€æ¬¡å†™æ—¥å¿—æˆ–è€…å®šæ—¶ä»»åŠ¡ï¼Œ è€Œå¦‚æœå·²ç»è¶…è¿‡äº†2s, å°±å¿…é¡»è¦æ‰§è¡Œäº†ï¼Œ å¦åˆ™å°±ä¼šå‡ºç°æ•°æ®ä¸¢å¤±å¤ªå¤šäº†ï¼Œ æ‰€ä»¥è¯´åœ¨æ—¥å¿—é‡å†™æ—¶ï¼Œä¼šä¸¢å¤±çš„æ•°æ®å°±å˜æˆäº†2s. è¿™é‡Œæ— æ³•ä¿è¯çš„ã€‚  è¿˜æœ‰ä½ è¯´çš„å­è¿›ç¨‹å†™å…¥è¶…è¿‡ä¸¤ç§’ï¼Œ è¿™é‡Œä¸æ˜¯å†™å…¥ã€‚ åå°çº¿ç¨‹åªæ˜¯åˆ·ç›˜ï¼Œ è¿›ç¨‹æ˜¯é‡å†™aofæ–‡ä»¶ï¼Œ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648898443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":320398,"ip_address":""},"score":559735,"extra":""}]},{"author":{"id":1784022,"avatar":"","nickname":"pippin","note":"","ucode":"F7619FCE24D481","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320397,"discussion_content":"ä¸çŸ¥é“æˆ‘è¿™æ ·è¯´çš„å¯¹ä¸å¯¹ï¼Œåœ¨everysecæ¨¡å¼ä¸‹ï¼Œå½“aof_buffå†…çš„æ•°æ®å¾ˆå¤šï¼Œä¹Ÿå°±æ˜¯æ¯ç§’äº§ç”Ÿçš„å†™æ“ä½œå¾ˆå¤šï¼Œä¸»çº¿ç¨‹ä¼šåˆ¤æ–­åå°å­è¿›ç¨‹çš„å†™æ“ä½œæ˜¯å¦æœ‰æ‰§è¡Œè¶…è¿‡ä¸¤ç§’çš„ï¼Œæœ‰çš„è¯ä¸»çº¿ç¨‹å°±ä¸ä¼šå†å¯åŠ¨ä¸€ä¸ªåå°å­è¿›ç¨‹ã€‚æˆ‘è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œå†™å…¥aofæ—¥å¿—çš„åå°å­è¿›ç¨‹æ˜¯åªæœ‰ä¸€ä¸ªè¿˜æ˜¯ä¼šæ¯ç§’åˆ›å»ºä¸€ä¸ªã€‚æŒ‰æ¥¼ä¸»è¯´çš„æ˜¯å†™å…¥aofæ—¥å¿—çš„è¿›ç¨‹åªä¼šæœ‰ä¸€ä¸ªï¼Œä½†å­è¿›ç¨‹æ‰§è¡Œè¶…è¿‡1ç§’ä½†æ²¡è¶…è¿‡ä¸¤ç§’ï¼Œåˆ™ä¸»çº¿ç¨‹è¿˜æ˜¯ä¼šreturnã€‚é‚£è¿™æ—¶å€™å‡ºç°å®•æœºæ˜¯ä¼šä¸¢å¤±ä¸¤ç§’çš„æ•°æ®å—ï¼Ÿè¿˜æœ‰å­è¿›ç¨‹æ‰§è¡Œè¶…è¿‡ä¸¤ç§’ï¼Œä¸»çº¿ç¨‹å°±ä¼šé˜»å¡å­è¿›ç¨‹ï¼Œè‡ªå·±æ¥å®Œæˆaofçš„æ—¥å¿—å†™å…¥ã€‚è¿™é‡Œçš„aof_fdæˆ‘å¯ä»¥ç†è§£ä¸ºaofæ—¥å¿—æ–‡ä»¶å—ï¼Œé‚£å­è¿›ç¨‹å†™å…¥éƒ½è¶…è¿‡ä¸¤ç§’äº†ï¼Œä¸»çº¿ç¨‹æ’æ‰‹æ€ä¹ˆä¿è¯æ•°æ®ä¸é‡å¤å†™å…¥ï¼Ÿæ€ä¹ˆä¿è¯æ•°æ®å†™å…¥çš„å‡†ç¡®æ€§ï¼Ÿè¿˜æœ‰ä¸»çº¿ç¨‹è‡ªå·±å»å†™å…¥aofæ—¥å¿—äº†ï¼Œé‚£è¿™æ—¶å€™rediså¯¹å¤–çš„è¯·æ±‚æ˜¯ä¸å“åº”çš„ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•ä¼˜åŒ–å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604362682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249405,"user_name":"yeek","can_delete":false,"product_type":"c1","uid":1020629,"ip_address":"","ucode":"A1C71023113CB9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/d5/699384a0.jpg","comment_is_top":false,"comment_ctime":1600649943,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"44550322903","product_id":100056701,"comment_content":"å¦‚æœredisæ˜¯ç‹¬ç«‹éƒ¨ç½²ï¼Œé‚£ä¹ˆå½“å†…å­˜ä¸è¶³æ—¶ï¼Œæ·˜æ±°ç­–ç•¥å’Œæ“ä½œç³»ç»Ÿçš„swapæœºåˆ¶ å“ªä¸ªä¼šä¼˜å…ˆæ‰§è¡Œï¼Ÿ<br><br>æ›¾é‡åˆ°è¿‡çº¿ä¸Šè§¦å‘å†…å­˜æ·˜æ±°çš„åœºæ™¯ï¼Œå¹¶æœªè§‚å¯Ÿå½“æ—¶çš„swapæƒ…å†µï¼Œæ„Ÿè°¢è€å¸ˆçš„å»ºè®®","like_count":10,"discussions":[{"author":{"id":1316758,"avatar":"https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg","nickname":"Richard","note":"","ucode":"893F958B9DD161","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333831,"discussion_content":"æˆ‘è®¤ä¸ºè¿™ä¸¤è€…å¹¶ä¸ç¡®å®šï¼Œå› ä¸ºæ·˜æ±°æ˜¯redisè‡ªå·±è´Ÿè´£ï¼Œè€Œswapæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„æœºåˆ¶ï¼Œredisåªæ˜¯è®¤ä¸ºè‡ªå·±æœ‰max_memoryçš„å†…å­˜å¯ç”¨ï¼Œè‡³äºè¿™é‡Œé¢çš„å†…å­˜å—å“ªäº›è¢«swapäº†ï¼Œredisæ˜¯ä¸çŸ¥é“ä¹Ÿä¸éœ€è¦å…³å¿ƒçš„ï¼Œå®ƒåªè¦ç»´æŠ¤å¥½è‡ªå·±éœ¸å çš„é‚£ä¸€å—å†…å­˜å°±è¡Œã€‚è€Œæ“ä½œç³»ç»Ÿå°±è¦ç»Ÿç­¹å…¨å±€ï¼Œå¦‚æœæœºå™¨å†…å­˜åƒç´§ï¼Œå®ƒä¼šé€‰æ‹©ä¸€äº›ä¸å¸¸ç”¨çš„å†…å­˜swapåˆ°ç£ç›˜ã€‚è€Œredisåœ¨è®¿é—®è¿™äº›è¢«swapçš„æ•°æ®æ—¶å®ƒæ˜¯ä¸çŸ¥é“è¢«äº¤æ¢åˆ°ç£ç›˜çš„ï¼Œè¿™æ—¶åç»­çš„æ“ä½œç”±æ“ä½œç³»ç»Ÿå†…æ ¸è´Ÿè´£ï¼Œè¿™ä¸ªæœºåˆ¶å«ç¼ºé¡µå¤„ç†ï¼Œå†…æ ¸å‘ç°æ•°æ®ä¸åœ¨å†…å­˜å°±ä¼šå‡ºå‘ç¼ºé¡µä¸­æ–­ï¼Œå»ç£ç›˜è¯»å–æ•°æ®åˆ°page cacheï¼Œä¹‹åå†copyåˆ°ç”¨æˆ·ç©ºé—´å†…å­˜ï¼Œç„¶åå†é€šçŸ¥å‘èµ·è¯»è°ƒç”¨çš„ç”¨æˆ·çº¿ç¨‹ï¼Œè€Œè¿™ä¸€æ®µæ—¶é—´é€šå¸¸å°±æ˜¯æˆ‘ä»¬è¯´çš„ioè°ƒç”¨å¼•èµ·çº¿ç¨‹é˜»å¡è¿›è€Œè¢«è°ƒåº¦å‡ºcpuçš„è¿‡ç¨‹ã€‚","likes_number":26,"is_delete":false,"is_hidden":false,"ctime":1607646325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377159,"discussion_content":"ä¸¤ä¸ªæ˜¯å¹¶è¡Œçš„ ä¸€ä¸ªæ˜¯redisè¿›ç¨‹ ä¸€ä¸ªæ˜¯æ“ä½œç³»ç»Ÿã€‚redisæ˜¯æ“ä½œç³»ç»Ÿä¸Šçš„ä¸€ä¸ªè¿›ç¨‹è€Œå·²","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622532474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311264,"discussion_content":"redis.confé…ç½®æ–‡ä»¶ä¸­æœç´¢maxmemoryï¼Œæœ‰é»˜è®¤redisèƒ½ä½¿ç”¨çš„æœ€å¤§å†…å­˜é…ç½®","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602294905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577471,"discussion_content":"æ“ä½œç³»ç»Ÿè‚¯å®šå¯¹åº”ç”¨ç¨‹åºé€æ˜å•Š, redisæ ¹æœ¬ä¸çŸ¥é“æœ‰ä»€ä¹ˆswap, æ— æ„ŸçŸ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656133918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277461,"user_name":"å°å¯","can_delete":false,"product_type":"c1","uid":1006735,"ip_address":"","ucode":"8834AF621FA67D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/8f/551b5624.jpg","comment_is_top":false,"comment_ctime":1612423067,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35972161435","product_id":100056701,"comment_content":"rediså˜æ…¢é—®é¢˜ä¼˜åŒ–è‡ªæˆ‘æ€»ç»“ï¼š<br>1.cpuï¼šrediså®ä¾‹ç»‘å®šåŒä¸€ä¸ªcpuç‰©ç†æ ¸ï¼›ç½‘ç»œä¸­æ–­å’Œrediså®ä¾‹ç»‘å®šåŒä¸€ä¸ªcpu socket<br>2.å†…å­˜ï¼šå…³é—­å¤§å†…å­˜é¡µï¼Œè§‚å¯Ÿswapï¼Œå¢åŠ ç‰©ç†å†…å­˜<br>3.ç£ç›˜ï¼šæ•°æ®ä¸¢å¤±å®¹å¿åº¦aofç­–ç•¥é€‰æ‹©ï¼›AOFä½¿ç”¨SDD<br>4.æ“ä½œï¼šé›†åˆæ“ä½œï¼Œbigkeyåˆ é™¤ï¼Œè¿”å›é›†åˆæ”¹ä¸ºSCANå¤šæ¬¡æ“ä½œ<br>5.è¿‡æœŸï¼šè¿‡æœŸæ—¶é—´åŠ éšæœºæ•°<br>6.ç›‘æ§ï¼šåŸºçº¿æ€§èƒ½--intrinsic-latency; monitor; ;latency","like_count":8},{"had_liked":false,"id":304998,"user_name":"èŠ±å„¿å°‘å¹´","can_delete":false,"product_type":"c1","uid":1318540,"ip_address":"","ucode":"CFE4F64243673B","user_header":"https://static001.geekbang.org/account/avatar/00/14/1e/8c/450fe5cb.jpg","comment_is_top":false,"comment_ctime":1627740828,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23102577308","product_id":100056701,"comment_content":"ä¹‹å‰å‡ºç°è¿‡rediså˜æ…¢çš„é—®é¢˜ï¼Œå¯¼è‡´ç³»ç»Ÿæ•´ä½“å˜æ…¢ï¼Œç³»ç»Ÿå¤§æ¦‚å‡ å°æ—¶å†…30%çš„è¯·æ±‚éƒ½å¾ˆæ…¢ï¼ŒåŸºæœ¬åˆ°ä¸å¯ç”¨çš„æƒ…å†µäº†ã€‚<br>å…·ä½“æƒ…å†µæ˜¯æŸåŒå­¦(æˆ‘)åœ¨æ–°ä¸šåŠ¡çš„æ—¶å€™æ·»åŠ äº†ä¸€ä¸ªæ–°çš„keyï¼Œç”±äºç¬¦åˆhashçš„ç‰¹æ€§äºæ˜¯ç›´æ¥ä½¿ç”¨äº†redission çš„mapï¼Œä¸Šçº¿åç”±äºé€»è¾‘é—®é¢˜å¹¶æ²¡æœ‰æ‰§è¡Œåˆ°ï¼Œä½†æ˜¯ç”±äºä»…ä»…æ˜¯ç¼“å­˜å˜›ï¼Œä¸šåŠ¡ä¹Ÿæ²¡é—®é¢˜ï¼Œåæ¥ç”±äºå¦å¤–çš„é¡¹ç›®ä¸­è¦†ç›–åˆ°è¿™ä¸ªcaseå‘ç°æœ‰é—®é¢˜ï¼Œç„¶åå°±æŠŠé€»è¾‘ä¿®å¤äº†ã€‚<br>ä¸Šçº¿åredisé›†ç¾¤çš„proxyèŠ‚ç‚¹çš„ä¸€ä¸¤ä¸ªèŠ‚ç‚¹cpuä½¿ç”¨ç‡é£™é«˜ï¼Œä½†æ˜¯æ²¡æƒ³æ˜ç™½ä¸ºå•¥ï¼Œæ‰€ä»¥ä¹Ÿæ²¡å›æ»šï¼Œç„¶åç¬¬äºŒå¤©ä¸­åˆæµé‡å˜å¤§äº†ï¼Œå°±ä¼šæœ‰æ›´å¤šçš„proxyèŠ‚ç‚¹cpuä½¿ç”¨ç‡100%ï¼Œè¿™ä¸ªæ—¶å€™ä¸šåŠ¡å°±å¼€å§‹å¤§é‡æŠ¥è­¦äº†ï¼Œå› ä¸ºæ¥å£å¼€å§‹éƒ¨åˆ†è¶…æ—¶ï¼Œç„¶åç´§æ€¥æŠŠé‚£å—ç¼“å­˜çš„ä»£ç åˆ é™¤å‘å¸ƒä¸Šçº¿ï¼Œç„¶åç³»ç»Ÿå°±æ¢å¤äº†ã€‚<br>è¿‡ç¨‹è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥è¯´åŸå› ï¼Œå…ˆè¯´ä¸‹redisé›†ç¾¤çš„æ¶æ„ï¼Œæµé‡ç»è¿‡proxyèŠ‚ç‚¹åˆ†å‘ç»™redisï¼Œä¸šåŠ¡ä»…æ„ŸçŸ¥åˆ°ä¸€ä¸ªvipèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼ŒproxyèŠ‚ç‚¹å°±éœ€è¦å¯¹å®¢æˆ·ç«¯çš„è¯·æ±‚è¿›è¡Œä¿åºçš„æ“ä½œï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´å…ˆåˆ°çš„è¯·æ±‚æ²¡è¿”å›æ—¶ï¼Œåæ¥çš„è¯·æ±‚ä¹Ÿä¸èƒ½è¿”å›ï¼›redissonçš„mapå®ç°æ˜¯åŠ å…¥äº†luaè„šæœ¬çš„ï¼ŒåŒæ—¶ä»£ç é‡Œå¯¹å•ä¸ªkeyè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´æ•´ä¸ªè„šæœ¬å¾ˆå¤æ‚å¾ˆæ¶ˆè€—æ€§èƒ½ï¼Œé‚£ä¹ˆredisæœ¬èº«å°±ä¼šå˜æ…¢ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼ŒåŒæ—¶åŠ ä¸ŠproxyèŠ‚ç‚¹ï¼Œè¿”å›åˆ°å®¢æˆ·ç«¯å°±å¾ˆæ…¢äº†ï¼ŒåŒæ—¶åŠ ä¸Šproxyä¿åºçš„ç‰¹ç‚¹ï¼Œæ›´åŠ å‰§äº†è€—æ—¶ã€‚redisæ˜¯åˆ†ç‰‡çš„ï¼Œæ‰€ä»¥é‡å°çš„æ—¶åªæœ‰å°‘éƒ¨åˆ†èŠ‚ç‚¹å—å½±å“ï¼Œä½†æ˜¯é‡å¤§æ—¶æ‰€æœ‰çš„åˆ†ç‰‡ä¸Šéƒ½æœ‰è¿™ç§æ…¢è¯·æ±‚ï¼Œæ‹–æ…¢äº†æ•´ä½“çš„æ€§èƒ½ã€‚ã€‚<br>è¡€æ³ªæ•™è®­ï¼Œä½¿ç”¨ä¸ç†Ÿæ‚‰çš„ç±»åº“æ—¶ï¼Œä¸€å®šè¦å¤šçœ‹çœ‹æºç ï¼Œå¯¹å…¬å¸çš„äº§å“çš„ç‰¹æ€§è¦ç†Ÿæ‚‰ï¼Œå¯¹éšæ‚£è¦åŠæ—¶æ­¢æŸï¼Œæƒ³ç€é—®é¢˜ä¸å¤§ä¹Ÿæ²¡å›æ»šï¼Œç®€ç›´å¤©çœŸã€‚<br>ä¸è¿‡redissonçœŸçš„å¥½ç”¨ã€‚yyds","like_count":6},{"had_liked":false,"id":249403,"user_name":"yeek","can_delete":false,"product_type":"c1","uid":1020629,"ip_address":"","ucode":"A1C71023113CB9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/d5/699384a0.jpg","comment_is_top":false,"comment_ctime":1600649461,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"18780518645","product_id":100056701,"comment_content":"å½“ä¸»çº¿ç¨‹ä½¿ç”¨åå°å­çº¿ç¨‹æ‰§è¡Œäº†ä¸€æ¬¡ fsyncï¼Œéœ€è¦å†æ¬¡æŠŠæ–°æ¥æ”¶çš„æ“ä½œè®°å½•å†™å›ç£ç›˜æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹å‘ç°ä¸Šä¸€æ¬¡çš„ fsync è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆå®ƒå°±ä¼šé˜»å¡ã€‚æ‰€ä»¥ï¼Œå¦‚æœåå°å­çº¿ç¨‹æ‰§è¡Œçš„ fsync é¢‘ç¹é˜»å¡çš„è¯ï¼ˆæ¯”å¦‚ AOF é‡å†™å ç”¨äº†å¤§é‡çš„ç£ç›˜ IO å¸¦å®½ï¼‰ï¼Œä¸»çº¿ç¨‹ä¹Ÿä¼šé˜»å¡ï¼Œå¯¼è‡´ Redis æ€§èƒ½å˜æ…¢ã€‚<br><br><br>è¿™æ®µæ²¡æ‡‚ï¼Œredisä¸»çº¿ç¨‹å’Œåå°å­çº¿ç¨‹ä¹‹é—´æœ‰çŠ¶æ€é€šä¿¡å—ï¼Ÿä¸»çº¿ç¨‹è°ƒç”¨fsyncå¯¹å­çº¿ç¨‹è€Œè¨€æ˜¯ä»»åŠ¡é˜Ÿåˆ—çš„æ–¹å¼è¿˜æ˜¯åŒæ­¥è°ƒç”¨çš„æ–¹å¼ï¼Ÿ æˆ‘å»çœ‹çœ‹æºç å§â€¦â€¦","like_count":4,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311273,"discussion_content":"ä¸»çº¿ç¨‹ä½¿ç”¨åå°å­çº¿ç¨‹æ‰§è¡Œfsyncã€‚\nå½“ä¸‹ä¸€æ¬¡ä¸»çº¿ç¨‹åˆè¦è®©å­çº¿ç¨‹æ‰§è¡Œfsyncçš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥ä¸Šæ¬¡çš„fsyncæ˜¯å¦å®Œæ¯•ï¼Œå¦‚æœæ²¡æœ‰å®Œæ¯•ï¼Œä¸»çº¿ç¨‹ä¼šé˜»å¡ã€‚\nå½±å“å­çº¿ç¨‹fsyncçš„æœ€å¤§å› ç´ å°±æ˜¯ç£ç›˜I/Oï¼Œå› æ­¤å½“å­˜åœ¨å…¶ä»–ä»»åŠ¡å’Œfsyncç«äº‰ç£ç›˜I/Oçš„æ—¶å€™ï¼Œå°±ä¼šå½±å“åˆ°ä¸»çº¿ç¨‹ï¼ˆé˜»å¡ï¼‰ã€‚å­¦åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œredisç”¨åˆ°ç£ç›˜I/Oçš„åœ°æ–¹æœ‰RDBå’ŒAOFã€‚\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602295721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581903,"discussion_content":"çº¿ç¨‹é—´é€šä¿¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659065632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1196293,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/05/5ba603f2.jpg","nickname":"å°æå­","note":"","ucode":"C5593E33CA6F4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345017,"discussion_content":"å­çº¿ç¨‹å µäº†å°±å µäº†ï¼Œä¸»çº¿ç¨‹ç›‘æ§å°±ç›‘æ§ï¼Œä¸ºä»€ä¹ˆè¦æŠŠè‡ªå·±ä¹Ÿç»™å µäº†ï¼Œè¿™é‡Œçš„ç¡®æ²¡è®²æ¸…æ¥š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611640120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1196293,"avatar":"https://static001.geekbang.org/account/avatar/00/12/41/05/5ba603f2.jpg","nickname":"å°æå­","note":"","ucode":"C5593E33CA6F4C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577472,"discussion_content":"å­çº¿ç¨‹å µäº†ä½ ä¸ç®¡å•Š? ç£ç›˜éƒ½å†™ä¸è¿‡æ¥äº†ä½ è¿˜ç»§ç»­åœ¨é‚£å¤„ç†ä¸šåŠ¡å•Š?  é‚£å°±ç”­ç®¡ç£ç›˜äº†å‘—, ä¸æŒä¹…åŒ–?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656134078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":345017,"ip_address":""},"score":577472,"extra":""}]},{"author":{"id":1589208,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTITcwicqBDYzXtLibUtian172tPs7rJpqG1Vab4oGjnguA9ziaYjDCILSGaS6qRiakvRdUEhdmSG0BGPKw/132","nickname":"å¤§é¥¶Raysir","note":"","ucode":"0AFA191420A30D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312411,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯åŒæ­¥ï¼Œä¸»çº¿ç¨‹åŒæ­¥è°ƒç”¨fsyncåï¼Œå­çº¿ç¨‹å¼‚æ­¥æ‰§è¡ŒIOä»»åŠ¡æ—¶ï¼Œç”±äºAOFé‡å†™å¯¼è‡´ç£ç›˜IOå¸¦å®½æ‰“æ»¡ï¼Œå­çº¿ç¨‹çš„IOä»»åŠ¡å°±ä¼šé˜»å¡ã€‚æ­¤æ—¶ä¸»çº¿ç¨‹é€šè¿‡å¯¹å­çº¿ç¨‹çš„ç›‘æ§æœºåˆ¶ï¼Œå‘ç°å­çº¿ç¨‹é˜»å¡ï¼Œç„¶åé˜»å¡è‡ªèº«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602679707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249397,"user_name":"ä¸œ","can_delete":false,"product_type":"c1","uid":1043947,"ip_address":"","ucode":"0FF5018422CEA9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ed/eb/88cac7a5.jpg","comment_is_top":false,"comment_ctime":1600648420,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14485550308","product_id":100056701,"comment_content":"â€œ8. æ˜¯å¦è¿è¡Œäº† Redis ä¸»ä»é›†ç¾¤ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼ŒæŠŠä¸»åº“å®ä¾‹çš„æ•°æ®é‡å¤§å°æ§åˆ¶åœ¨ 2~4GBï¼Œä»¥å…ä¸»ä»å¤åˆ¶æ—¶ï¼Œä»åº“å› åŠ è½½å¤§çš„ RDB æ–‡ä»¶è€Œé˜»å¡ã€‚â€ è¿™ä¸ª2~4Gçš„ç»éªŒå€¼å’Œä¸»åº“çš„å†…å­˜å¤§å°æ— å…³å—ï¼Ÿæ¯”å¦‚ä¸»ä»åº“å†…å­˜éƒ½æ˜¯64Gï¼Œ è¿™ä¸ªä¸»åº“æ•°æ®é‡ä¾ç„¶æ˜¯2~4Gï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1179028,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fd/94/0247f945.jpg","nickname":"å’¸é±¼","note":"","ucode":"5E79636DE48155","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307761,"discussion_content":"æ¶‰åŠåˆ°forkæ—¶ä¼šä¸ä¼šé˜»å¡çš„é—®é¢˜ï¼Œå’Œæœºå™¨çš„å®é™…å†…å­˜æ— å…³ï¼Œè¿™ä¹ˆè¯´æ¥å¤§å†…å­˜æ„ä¹‰ä¸å¤§","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1600752586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315663,"user_name":"æ—¥è½é»„æ˜ä¸‹","can_delete":false,"product_type":"c1","uid":1464032,"ip_address":"","ucode":"A97725B81D86BC","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/e0/d34f57b3.jpg","comment_is_top":false,"comment_ctime":1633939667,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5928906963","product_id":100056701,"comment_content":"é™¤äº†aofé‡å†™å¯èƒ½é€ æˆå µå¡ï¼Œåœ¨aof everysecæ—¶ï¼Œå¦‚æœå‘ç°æ­¤æ—¶æ­£åœ¨è¿›è¡Œfsyncï¼Œå¹¶ä¸”è¶…è¿‡2sæ—¶ï¼Œä¼šå µå¡ä¸»çº¿ç¨‹ç­‰å¾…ã€‚å¯ç›‘æ§aof-pending-bio-fsyncå’Œaof-delay-fsyncä¿¡æ¯ï¼Œå¹¶ä¸”ä¼šæœ‰aof fsync is taking too long çš„æ—¥å¿—ã€‚","like_count":1},{"had_liked":false,"id":306836,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1628739672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5923706968","product_id":100056701,"comment_content":"å¯¹äºSwapæœºåˆ¶,å…³é—­åº”è¯¥æ˜¯æœ€æ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆ,åŒ…æ‹¬åœ¨Kubernetesé›†ç¾¤ä¸­,å¯¹äºéƒ¨ç½²çš„èŠ‚ç‚¹ä¹Ÿæ˜¯è¦æ±‚å…³é—­swapçš„,å…³é—­æ–¹å¼å¦‚ä¸‹swapoff -a","like_count":1},{"had_liked":false,"id":286448,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1617324464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5912291760","product_id":100056701,"comment_content":"Redis å˜æ…¢ï¼ŸæŒ‰ï¼ˆè€å¸ˆ + Kaitoï¼‰ä¸€æ³¢æ“ä½œä¸‹æ¥ä¸å¿«ä¹Ÿå¾—å¿«ï¼","like_count":1},{"had_liked":false,"id":354402,"user_name":"Geek_b14c55","can_delete":false,"product_type":"c1","uid":2027632,"ip_address":"æµ™æ±Ÿ","ucode":"C98EAEC045F13D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/MOuCWWOnoQjOr8KjicQ84R7xu6DRcfDv3VAuHseGJ1gxXicKJboA24vOcrcJickTJPwFAU38VuwCGGkGq7f8WkTIg/132","comment_is_top":false,"comment_ctime":1660361336,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1660361336","product_id":100056701,"comment_content":"ä¸ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤ï¼Œæˆ–ç”¨å…¶ä»–æ–¹å¼ä»£æ›¿å®ç°ï¼ˆæ”¾åœ¨å®¢æˆ·ç«¯åšï¼‰ ï¼Œéº»çƒ¦è¯·é—®ä¸€ä¸‹å¤§å®¶ï¼Œè¿™ä¸ªå®¢æˆ·ç«¯æŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºå—","like_count":0,"discussions":[{"author":{"id":1527581,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/270T9KAFd4oCxXXB1giaMDaJuTQVib8gPt77VkM5dbS3hW60kwTNnxMYpVibwWVdnASCrymBbwT7HI77URia0KUylw/132","nickname":"Geek_7ee455","note":"","ucode":"76C69F26B0F653","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585143,"discussion_content":"æ˜¯çš„ï¼Œä¾‹å¦‚å–äº¤é›†ï¼Œä½ å¯ä»¥ç”¨javaåœ¨å†…å­˜é‡Œåšï¼Œè€Œä¸ç”¨redisçš„å‘½ä»¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661341939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350390,"user_name":"å¡å°”","can_delete":false,"product_type":"c1","uid":2887573,"ip_address":"","ucode":"B3F5506B938986","user_header":"https://static001.geekbang.org/account/avatar/00/2c/0f/95/275d534e.jpg","comment_is_top":false,"comment_ctime":1656872795,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656872795","product_id":100056701,"comment_content":"aofçš„everysecç­–ç•¥ä¸‹ï¼Œå­çº¿ç¨‹ä¼šå¯¼è‡´ä¸»çº¿ç¨‹é˜»å¡æˆ‘è¯´ä¸‹ä¸ªäººè§‚ç‚¹ã€‚<br>ä½œè€…çš„æ„æ€æ˜¯åœ¨ ererysecä¸‹ï¼Œå­çº¿ç¨‹æ¯ç§’å»fsyncï¼Œä½†æ˜¯ä¸»çº¿ç¨‹ä¼šç›‘æµ‹è¯¥å­çº¿ç¨‹çš„fsyncçš„æ‰§è¡Œæƒ…å†µã€‚æœ‰ä¸ªç­–ç•¥å°±æ˜¯ï¼Œè‹¥æ˜¯ä¸»çº¿ç¨‹å‘ç°å·²è¿‡2sï¼ˆä¹Ÿå°±æ˜¯ä¸Šæ¬¡æ²¡æ‰§è¡Œå®Œï¼‰äº†ï¼Œå­çº¿ç¨‹çš„ä¸Šä¸€æ¬¡çš„fsyncè¿˜æ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œä¸»çº¿ç¨‹å°±ä¼šé˜»å¡ï¼Œç›´åˆ°å­çº¿ç¨‹å½“å‰çš„fsyncå®Œæˆï¼Œæ‰è¿”å›ã€‚<br>å½“ç„¶å½±å“ å­çº¿ç¨‹çš„fsyncï¼Œå¯¼è‡´å…¶å˜æ…¢çš„å› ç´ æ˜¯ç£ç›˜ioçš„æ•ˆç‡è¾ƒä½ï¼Œå½“ç„¶å½±å“ç£ç›˜ioæ•ˆç‡çš„æœ‰å¾ˆå¤šï¼Œå…¶ä¸­aofé‡å†™å æ®å¤§é‡çš„ç£ç›˜ioèµ„æºå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚","like_count":0},{"had_liked":false,"id":346638,"user_name":"Geek_9adefb","can_delete":false,"product_type":"c1","uid":2980933,"ip_address":"","ucode":"DE7D4E98F892AE","user_header":"","comment_is_top":false,"comment_ctime":1653308954,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1653308954","product_id":100056701,"comment_content":"ä¸»ä»åŒæ­¥æœŸé—´ï¼Œä»èŠ‚ç‚¹èƒ½æ¥å—å®¢æˆ·ç«¯è¯·æ±‚å—","like_count":0,"discussions":[{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577474,"discussion_content":"è¦çœ‹å“ªä¸ªé˜¶æ®µ, ä»åº“å·²ç»åœ¨åŠ è½½rdbäº†å°±ä¸è¡Œäº†  åœ¨ä¸»çº¿ç¨‹æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656134201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342040,"user_name":"æ¯›è–›å¼º","can_delete":false,"product_type":"c1","uid":1788083,"ip_address":"","ucode":"DF632A3A881D0C","user_header":"https://static001.geekbang.org/account/avatar/00/1b/48/b3/fdefc913.jpg","comment_is_top":false,"comment_ctime":1649987683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649987683","product_id":100056701,"comment_content":"no-appendfsync-on-rewrite no çš„æ—¶å€™ä¸è°ƒç”¨fsyncï¼Œä½†æ˜¯ä¼šè°ƒç”¨writeå§ï¼Œå¦‚æœè°ƒç”¨äº†writeï¼Œé‚£ä¹ˆå®ä¾‹å®•æœºæ˜¯ä¸ä¼šä¸¢æ•°æ®çš„ï¼Œåªæœ‰æœåŠ¡å™¨å®•æœºæ‰ä¼šä¸¢æ•°æ®ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„å§","like_count":0},{"had_liked":false,"id":331335,"user_name":"Geek_0bba55","can_delete":false,"product_type":"c1","uid":2088137,"ip_address":"","ucode":"3B647E1EB3C707","user_header":"","comment_is_top":false,"comment_ctime":1642555819,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1642555819","product_id":100056701,"comment_content":"å¤§å†…å­˜é‚£é‡Œæœ‰ä¸ªç‚¹ä¸æ˜ç™½:Redisæ˜¯å•çº¿ç¨‹æ“ä½œï¼Œä¸å­˜åœ¨å¹¶å‘é—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨å†™æ—¶å¤åˆ¶çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1413864,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ib7YEKkLKotibRicGez0ZnydE9iczo8SMQlpkHNJeEFvzrJNMZZQKEhJHqd8lBG724jWZvSVO4deWARw4FzM5ibBJ4w/132","nickname":"zzsstt","note":"","ucode":"BA7F2BC4BCB169","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547724,"discussion_content":"è¿™ä¸ªæ˜¯linuxç³»ç»Ÿé‡Œé¢forkæœºåˆ¶ä¸€éƒ¨åˆ†ï¼ŒRDBæ–‡ä»¶ç”Ÿæˆè¿‡ç¨‹æ—¶æ˜¯é€šè¿‡Redisè¿›ç¨‹forkå‡ºæ–°çš„å­è¿›ç¨‹å¤„ç†çš„ï¼Œè¿™ä¸€å—å¯ä»¥çœ‹ç¬¬05ç¯‡æ–‡ç« çš„å†…å®¹ï¼Œå’Œä¸‹é¢è¯„è®ºé‡Œé¢æåˆ°çš„å¯¹forkçš„è§£é‡Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642839993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327324,"user_name":"æ ‘å¿ƒ","can_delete":false,"product_type":"c1","uid":1589523,"ip_address":"","ucode":"6C329F0FF798B9","user_header":"https://static001.geekbang.org/account/avatar/00/18/41/13/ab14ad25.jpg","comment_is_top":false,"comment_ctime":1640066373,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1640066373","product_id":100056701,"comment_content":"é€æ˜å¤§é¡µå’Œæ ‡å‡†å¤§é¡µçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":313277,"user_name":"è´ºå­","can_delete":false,"product_type":"c1","uid":2076283,"ip_address":"","ucode":"A64DC9D9CF7CCD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/ae/7b/47200692.jpg","comment_is_top":false,"comment_ctime":1632362889,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632362889","product_id":100056701,"comment_content":"è€å¸ˆè¯´çš„å…³é—­å¤§å¶çš„å‘½ä»¤æ˜¯å…³é—­é€æ˜å¤§å¶çš„å‘½ä»¤å§","like_count":0},{"had_liked":false,"id":296111,"user_name":"manatee","can_delete":false,"product_type":"c1","uid":1041112,"ip_address":"","ucode":"708D90E7A265BD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e2/d8/f0562ede.jpg","comment_is_top":false,"comment_ctime":1622767980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622767980","product_id":100056701,"comment_content":"è¯·é—®è€å¸ˆå¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ‰bigkeyå­˜åœ¨ï¼Ÿå½“å‰åº“ä¸­æœ‰çº¦4000ä¸‡ä¸ªkey","like_count":0},{"had_liked":false,"id":296003,"user_name":"Architect","can_delete":false,"product_type":"c1","uid":1311766,"ip_address":"","ucode":"6CA6BC22AB3213","user_header":"https://static001.geekbang.org/account/avatar/00/14/04/16/91e82e9e.jpg","comment_is_top":false,"comment_ctime":1622700461,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"1622700461","product_id":100056701,"comment_content":"å¤šå¤§çš„keyç®—bigkeyï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1721699,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/45/63/005d03b2.jpg","nickname":"QDè´¦å·","note":"","ucode":"C0C8ECA5AB3A20","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572868,"discussion_content":"è¿”å›æ•°æ®çš„æ—¶å€™æ˜¯redisé˜»å¡çš„å—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653019726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1318540,"avatar":"https://static001.geekbang.org/account/avatar/00/14/1e/8c/450fe5cb.jpg","nickname":"èŠ±å„¿å°‘å¹´","note":"","ucode":"CFE4F64243673B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386715,"discussion_content":"ä¸€èˆ¬è®¤ä¸ºå‡ ç™¾kbå°±æ¯”è¾ƒå¤§äº†ï¼Œ1mbå°±è¦å¥½ä¹…è¿”å›äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627740949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295654,"user_name":"å‡¯æ–‡å°çŒª","can_delete":false,"product_type":"c1","uid":1980201,"ip_address":"","ucode":"36D8AD0229547F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","comment_is_top":false,"comment_ctime":1622532382,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622532382","product_id":100056701,"comment_content":"å…¶å®è¿™é‡Œçš„é—®é¢˜å¯ä»¥æ‰©å±•åˆ°å¾ˆå¤šç‚¹ å› ä¸ºæœ¬è´¨ä¸Šredisæ˜¯éƒ¨ç½²åœ¨linuxä¸Šçš„ã€‚é‚£ä¹ˆä½œä¸ºä¸€ä¸ªå†…å­˜æ•°æ®åº“å¿…ç„¶å—åˆ¶äºä¸¤ä¸ªå› ç´  ä¸€æ˜¯å†…å­˜åˆ†é… äºŒæ˜¯æ•°æ®æŒä¹…åŒ–ã€‚<br><br>æˆ‘ä»¬å…ˆæ¥çœ‹ å†…å­˜åˆ†é…ã€‚ä¹‹å‰è€å¸ˆè§£é‡Šè¿‡å†…å­˜åˆ†é…redisç”¨çš„jmalloc è¿™ç§ç‰¹æ€§ä¼šé€ æˆä¸€å®šçš„æ•°æ®ç¢ç‰‡ å¦å¤–ä¸freeç»“åˆä½¿ç”¨æ—¶ å®é™…ä¸Šæ˜¯å†…å­˜æ ‡è®°å›æ”¶æ‰€ä»¥å†…å­˜ç¢ç‰‡æ˜¯å¤©ç„¶å­˜åœ¨çš„ã€‚<br><br>å†æ¥çœ‹æ•°æ®æŒä¹…åŒ– æ­¤å¤„ç”¨çš„æ˜¯fork &amp;&amp; fsync &amp;&amp; writeã€‚fsyncæ¯«æ— ç–‘é—®æ˜¯write throughçš„ è€Œwriteæ˜¾ç„¶æ˜¯write backã€‚ è¿™ä¸¤ç§æ¨¡å¼è‡ªèº«çš„é—®é¢˜å°±ä¸åšè®¨è®ºäº† æ¯•ç«Ÿä¸æ˜¯linuxè¯¾ç¨‹ã€‚æ‰€ä»¥å› ä¸ºæ–‡ä»¶ç³»ç»Ÿè‡ªèº«æœºåˆ¶å¦‚ext3 ext4ç­‰ä¹‹ç±»çš„é—®é¢˜ä¾ç„¶ä¼šé™åˆ¶rediså­è¿›ç¨‹è½ç›˜ å¯¼è‡´ä¸»è¿›ç¨‹ç›‘æ§æ—¶æœŸå¡é¡¿","like_count":0},{"had_liked":false,"id":294933,"user_name":"æ‚Ÿç©ºèŠæ¶æ„","can_delete":false,"product_type":"c1","uid":1123163,"ip_address":"","ucode":"C2F482A0CF8AF1","user_header":"https://static001.geekbang.org/account/avatar/00/11/23/5b/983408b9.jpg","comment_is_top":false,"comment_ctime":1622157644,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1622157644","product_id":100056701,"comment_content":"è€å¸ˆçš„æ€»ç»“å¤ªæ£’äº†","like_count":0},{"had_liked":false,"id":289327,"user_name":"Geek_e0c185","can_delete":false,"product_type":"c1","uid":2363997,"ip_address":"","ucode":"094D3ED137C437","user_header":"","comment_is_top":false,"comment_ctime":1618977585,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618977585","product_id":100056701,"comment_content":"å†…å­˜é¡µè¡¨å†™æ—¶å¤åˆ¶æŠ€æœ¯ä¸»çº¿ç¨‹åªéœ€è¦å¤åˆ¶æ”¹åŠ¨çš„æ•°æ®å³å¯ï¼Œè€å¸ˆè¯´å†…å­˜å¤§é¡µåœ¨å†™å®å¤åˆ¶æ—¶ä¼šå¤åˆ¶å†…å­˜å¤§é¡µçš„æ‰€æœ‰æ•°æ®ï¼Œä¼šä¸ä¼šæœ‰çŸ›ç›¾ï¼Ÿè¿˜æ˜¯è¯´å†…å­˜é¡µè¡¨å’Œå†…å­˜å¤§é¡µçš„å†™æ—¶å¤åˆ¶éœ€è¦å¤åˆ¶çš„æ•°æ®ä¸ä¸€æ ·ï¼Ÿ","like_count":0},{"had_liked":false,"id":285306,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1616730172,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"1616730172","product_id":100056701,"comment_content":"æ²¡æœ‰å‘ç°æ…¢æŸ¥è¯¢ï¼Œä¹Ÿæ²¡æœ‰åŒæ—¶åˆ é™¤å¤§é‡çš„ keysï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å‘¢ï¼Ÿ<br><br>ä½œä¸º Redis èœé¸Ÿï¼Œæˆ‘è§‰å¾—å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒAOF å†™å›ç­–ç•¥ä¸éœ€è¦ always çš„é…ç½®ã€‚<br><br>é«˜é€Ÿå›ºæ€ç¡¬ç›˜ SSD å·²ç»æˆä¸ºæ€§èƒ½ä¼˜åŒ–çš„â€œæ€æ‰‹é”â€ï¼Œå¦‚æœä¸å·®é’±â€¦â€¦<br><br>æ“ä½œç³»ç»Ÿå†…å­˜ swap è¢«è§¦å‘ä¹‹åï¼Œä¼šå½±å“ Redis ä¸» IO çº¿ç¨‹ï¼Œé‚£ä¹ˆå»¶ç»­ä¸Šé¢ SSD çš„æ€è·¯ï¼ŒåŠ å¤§å†…å­˜åº”è¯¥å¯ä»¥è§£å†³éƒ¨åˆ†é—®é¢˜ã€‚<br><br>å¯¹äºå…³é—­å†…å­˜å¤§é¡µæœºåˆ¶çš„åŠæ³•ï¼Œæˆ‘åœ¨ macOS ä¸Šæ²¡æœ‰æ‰¾åˆ° &#47;sys&#47;kernel ç›®å½•ã€‚<br><br>å°ç»“ä¸­çš„ 9 ä¸ªæ£€æŸ¥ç‚¹ Checklistï¼Œè®©æˆ‘è§‰å¾—ä¸“æ ç‰©è¶…æ‰€å€¼ã€‚è¯¾ä»£è¡¨ @kaito ä»¤äººå‘æŒ‡çš„ç»™å‡ºäº† 11 ä¸ªæ£€æŸ¥ç‚¹ï¼Œè®©æˆ‘æœ‰äº†ç§˜ç±åœ¨æ‰‹ï¼Œå¤©ä¸‹æˆ‘æœ‰çš„æ„Ÿè§‰ã€‚<br><br>å¯¹äºè¯¾åé¢˜ï¼Œæ²¡æœ‰é‡åˆ°è¿‡ Redis å˜æ…¢çš„æƒ…å†µï¼Œå¦‚æœä»¥åé‡åˆ°äº†ï¼Œå°±å›åˆ°è¿™ç¯‡ä¸“æ æ–‡ç« ï¼Œåº”è¯¥èƒ½æ‰¾åˆ°çº¿ç´¢ã€‚<br><br>è™½ç„¶æš‚æ—¶æ²¡æœ‰æ¥è§¦æˆ–è€…è¿ç»´ä¸šåŠ¡ä¸­çš„ Redis ï¼Œä½†æ˜¯è¿™ä¸ªä¸“æ åŒæ—¶ä¹Ÿè®²äº†å¾ˆå¤šæ“ä½œç³»ç»Ÿã€åº•å±‚æ¶æ„æ–¹é¢çš„å†…å®¹ï¼Œå­¦æµ·æ— æ¶¯ã€‚","like_count":0},{"had_liked":false,"id":284828,"user_name":"Geek_mysql45","can_delete":false,"product_type":"c1","uid":2084379,"ip_address":"","ucode":"DECFFE89B49974","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7MkIibc8UBwDt7dNeeNmx9IMqmI98Do8icxZcmfsMk99ibeXUo9ficwR1dxF5CrDHJ55603icCpKF7cxw/132","comment_is_top":false,"comment_ctime":1616488306,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616488306","product_id":100056701,"comment_content":"è¿™ä¸€èŠ‚è€å¸ˆæ€»ç»“çš„å®šä½æ€è·¯å¾ˆæ¸…æ™°æ˜äº†ï¼Œå­¦ä¹ äº†ã€‚æœç„¶è¿˜æ˜¯è¦å¯¹rediså„æ–¹é¢æœºåˆ¶éƒ½äº†è§£åï¼Œæ‰èƒ½é‡åˆ°é—®é¢˜ä¸æŠ“è€³æŒ è…®ï¼Œå¿ƒä¸­æœ‰redisç³»ç»Ÿæ¶æ„ï¼Œå†å»çœ‹é—®é¢˜å°±æœ‰äº†æ–¹å‘ã€‚","like_count":0},{"had_liked":false,"id":284528,"user_name":"é™Œå…®","can_delete":false,"product_type":"c1","uid":1415619,"ip_address":"","ucode":"00CE47CAECD5CD","user_header":"https://static001.geekbang.org/account/avatar/00/15/99/c3/e4f408d4.jpg","comment_is_top":false,"comment_ctime":1616320210,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1616320210","product_id":100056701,"comment_content":"&quot;å¦‚æœæ—¢éœ€è¦é«˜æ€§èƒ½åˆéœ€è¦é«˜å¯é æ€§ï¼Œæœ€å¥½ä½¿ç”¨é«˜é€Ÿå›ºæ€ç›˜ä½œä¸º AOF æ—¥å¿—çš„å†™å…¥ç›˜ã€‚&quot;<br>è€å¸ˆï¼Œè¿™ä¸€æ®µæœ‰ç‚¹ç–‘æƒ‘ï¼Œæ—¢ç„¶redisä¼šå­˜åœ¨é¢‘ç¹çš„aofæ–‡ä»¶é‡å†™ï¼Œé‚£ä¹ˆä½¿ç”¨ssdç›˜ä½œä¸ºaofçš„å†™å…¥ç›˜å°±ä¼šé¢‘ç¹çš„åˆ·æ–°ç£ç›˜æ•°æ®ã€‚å¯¹äºssdè¿™ç§æœ‰åˆ·ç›˜æ¬¡æ•°é™åˆ¶çš„å­˜å‚¨ç¡¬ç›˜æ¥è¯´ï¼Œé‚£ä¸æ˜¯å¾ˆå¿«å°±æŠ¥åºŸäº†ï¼Ÿè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æƒ³è¦è¯·æ•™ä¸‹ï¼šå…³äºaofå†™ç›˜æ˜¯å¦ä¸ºç£ç›˜é¡ºå†™ï¼Ÿæ„Ÿè§‰å¦‚æœæ˜¯é¡ºåºå†™å’Œé¡ºåºè¯»ï¼Œä½¿ç”¨æ™®é€šçš„æœºæ¢°ç¡¬ç›˜ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":284013,"user_name":"é£å«å¶","can_delete":false,"product_type":"c1","uid":1162800,"ip_address":"","ucode":"7AE8D3963343AB","user_header":"https://static001.geekbang.org/account/avatar/00/11/be/30/1154657e.jpg","comment_is_top":false,"comment_ctime":1616037263,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616037263","product_id":100056701,"comment_content":"çœ‹å®Œè¿™ç¯‡æœ‰ä¸€ç§ é†é†çŒé¡¶çš„ æ„Ÿè§‰","like_count":0},{"had_liked":false,"id":275998,"user_name":"æ¨±å°è·¯ä¾ç„¶","can_delete":false,"product_type":"c1","uid":1269957,"ip_address":"","ucode":"DBA9FF68015FE5","user_header":"https://static001.geekbang.org/account/avatar/00/13/60/c5/69286d58.jpg","comment_is_top":false,"comment_ctime":1611740664,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1611740664","product_id":100056701,"comment_content":"è™½ç„¶æ²¡é‡åˆ°è¿‡rediså˜æ…¢çš„é—®é¢˜,ä½†æ˜¯æˆ‘ä¹‹å‰å·¥ä½œä¸­é‡åˆ°è¿‡ rocketmq ç”±äºè¿‡å¤šä½¿ç”¨swapå¯¼è‡´å¡æ­»çš„é—®é¢˜,å½“æ—¶ç»è¿‡æ’æŸ¥é—®é¢˜å,ç”±äºå†…å­˜å……è¶³,æ²¡æœ‰å…¶ä»–åº”ç”¨åŒæœºéƒ¨ç½²,æ‰€ä»¥å½“æ—¶çš„å¤„ç†æ–¹å¼æ˜¯å°† swap å…³é—­äº†,æ²¡æœ‰æ·±ç©¶é—®é¢˜åŸå› ","like_count":0,"discussions":[{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370017,"discussion_content":"å¯èƒ½æ˜¯æŸä¸€ä¸ª cpu å†…å­˜ä¸è¶³ï¼Œç”¨ä¸Šäº† swap","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619253107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272724,"user_name":"é›¨æœè·¨å¢ƒ","can_delete":false,"product_type":"c1","uid":1453146,"ip_address":"","ucode":"87173F7DCBA0C5","user_header":"","comment_is_top":false,"comment_ctime":1610254638,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610254638","product_id":100056701,"comment_content":"ç¨‹åºä¸Šæœ‰äº›å¯ä»¥ä½¿ç”¨piplineå‡å°‘å¤šæ¬¡è¯·æ±‚ ç®—æ˜¯ä¸€ç§å—","like_count":0},{"had_liked":false,"id":272637,"user_name":"é›ªç‹¼ğŸ‡¨ğŸ‡³ğŸ‘£","can_delete":false,"product_type":"c1","uid":1011364,"ip_address":"","ucode":"EC807126C34D66","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6e/a4/c93e70f9.jpg","comment_is_top":false,"comment_ctime":1610182281,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610182281","product_id":100056701,"comment_content":"å…³é—­äº†aofå’Œrdbï¼Œåªå½“ä½œç¼“å­˜ä½¿ç”¨ï¼Œä½†æ˜¯å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­è¿˜æ˜¯ä¼šé‡åˆ°å“åº”å»¶è¿Ÿæœ‰æ³¢åŠ¨çš„æƒ…å†µï¼Œä¸€ä¸ªç©ºçš„redisçš„dbï¼Œå¯¹åŒä¸€ä¸ªkeyæ¯ç§’æŸ¥è¯¢ä¸€æ¬¡ï¼Œå®é™…ç»“æœåº”è¯¥æ˜¯è¿”å›ç©ºæ•°æ®ï¼Œæ­£å¸¸æƒ…å†µä¸‹å“åº”æ—¶é—´åœ¨å‡ msï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¼šæ³¢åŠ¨åˆ°800msä»¥ä¸Šã€‚<br>rediså’ŒæŸ¥è¯¢çš„ä»£ç éƒ¨ç½²åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œé€šè¿‡127.0.0.1è¿æ¥çš„ã€‚<br>å› ä¸ºredisé‡Œå®é™…å­˜çš„æ•°æ®æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥åº”è¯¥å’ŒæŸ¥è¯¢è€—æ—¶&amp;swapéƒ½æ²¡ä»€ä¹ˆå…³ç³»å§ï¼Ÿ<br>ç„¶åæ—¢ç„¶aofå’Œrdbéƒ½å…³é—­äº†ï¼Œé‚£åº”è¯¥è·Ÿå†™ç£ç›˜ä¹Ÿæ²¡ä»€ä¹ˆå…³ç³»ï¼Ÿ<br>è¿˜æœ‰ä»€ä¹ˆå¯èƒ½å¯¼è‡´è¿™ç§å“åº”çš„æ³¢åŠ¨å‘¢ï¼Ÿ<br>è„šæœ¬é‡Œä¼šå®šæ—¶è¯»å†™mysqlæ•°æ®åº“ï¼Œmysqlåº“éƒ¨ç½²åœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿç½‘ç»œIOï¼Œè¿™ä¸ªå¯¹æœ¬åœ°çš„redisçš„å“åº”å¯èƒ½æœ‰å½±å“å—ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":265626,"user_name":"èŒƒé—²","can_delete":false,"product_type":"c1","uid":1073125,"ip_address":"","ucode":"F21FD7DF6BA53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg","comment_is_top":false,"comment_ctime":1606964275,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606964275","product_id":100056701,"comment_content":"Redisæ€§èƒ½é—®é¢˜æ’æŸ¥æ€è·¯<br>1.åŸºçº¿æ€§èƒ½<br>2.æ…¢æŸ¥è¯¢å’Œé˜»å¡å‘½ä»¤ï¼ˆkeys)<br>3.keyåˆ é™¤<br>4.æŒä¹…åŒ–<br>5.å¤§å†…å­˜é¡µ<br>6.å†…å­˜ä¸è¶³","like_count":0},{"had_liked":false,"id":264973,"user_name":"èœ—ç‰›","can_delete":false,"product_type":"c1","uid":1300285,"ip_address":"","ucode":"A99C9C890F95E4","user_header":"https://static001.geekbang.org/account/avatar/00/13/d7/3d/a076faf1.jpg","comment_is_top":false,"comment_ctime":1606725397,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606725397","product_id":100056701,"comment_content":" ä¸¤ç§é…ç½®é¡¹<br>1ã€appendfsync everysec å’Œ no-appendfsync-on-rewrite yes<br>2ã€appendfsync no å’Œ no-appendfsync-on-rewrite no<br><br>è¿™ä¸¤ç§ä¼šæœ‰åŒºåˆ«å—ï¼Ÿæˆ‘ç†è§£çš„æ˜¯ éƒ½ä¸ä¼šè°ƒç”¨fsync","like_count":0},{"had_liked":false,"id":260635,"user_name":"æ•°å­¦æ±¤å®¶å‡¤","can_delete":false,"product_type":"c1","uid":2029485,"ip_address":"","ucode":"DE84E777C384AD","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f7/ad/4fd4d867.jpg","comment_is_top":false,"comment_ctime":1605075279,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1605075279","product_id":100056701,"comment_content":"å…³æ‰swapï¼Œä¸ä½¿ç”¨ AOFã€RDBï¼Œç®€ç®€å•å•å½“ä¸ªç¼“å­˜ç”¨","like_count":0},{"had_liked":false,"id":258391,"user_name":"yyl","can_delete":false,"product_type":"c1","uid":1170843,"ip_address":"","ucode":"1741DACDFCA9AF","user_header":"https://static001.geekbang.org/account/avatar/00/11/dd/9b/0bc44a78.jpg","comment_is_top":false,"comment_ctime":1604407615,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604407615","product_id":100056701,"comment_content":"é—®é¢˜ï¼šå¦‚æœè¯¥å®ä¾‹åœ¨ä¸€ä¸ª Redis åˆ‡ç‰‡é›†ç¾¤ä¸­ï¼Œå¯ä»¥å¢åŠ  Redis é›†ç¾¤çš„å®ä¾‹ä¸ªæ•°ï¼Œæ¥åˆ†æ‘Šæ¯ä¸ªå®ä¾‹æœåŠ¡çš„æ•°æ®é‡ï¼Œè¿›è€Œå‡å°‘æ¯ä¸ªå®ä¾‹æ‰€éœ€çš„å†…å­˜é‡ã€‚<br>è¿™é‡Œå¢åŠ å®ä¾‹ï¼Œæ˜¯æŒ‡é€šè¿‡å¢åŠ ç‰©ç†æœºå™¨æ¥éƒ¨ç½²å®ä¾‹å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":256878,"user_name":"å¤©ä¸‹","can_delete":false,"product_type":"c1","uid":2106744,"ip_address":"","ucode":"B33770BF714AC8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ico1JZVibIW4431SMBG9EIH7Gu4nweILy8kPXAtibWwZ2hQcuHUoFR1Y2Zg66hXY94xRbdkiaNRAIDBEkSunOtpibKA/132","comment_is_top":false,"comment_ctime":1603771298,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603771298","product_id":100056701,"comment_content":"æ”¶è·æ»¡æ»¡ï¼ï¼","like_count":0},{"had_liked":false,"id":250089,"user_name":"å°å–µå–µ","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1600930904,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600930904","product_id":100056701,"comment_content":"æœ‰æ—¶å€™éœ€è¦å†…å­˜å¤§é¡µæ€ä¹ˆåŠï¼Ÿå¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦å¯ç”¨å†…å­˜å¤§é¡µæœºåˆ¶å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":250077,"user_name":"å°å–µå–µ","can_delete":false,"product_type":"c1","uid":1062444,"ip_address":"","ucode":"FDBBB2A59DB8B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg","comment_is_top":false,"comment_ctime":1600926827,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1600926827","product_id":100056701,"comment_content":"è¯·é—®ä¸‹è€å¸ˆä»€ä¹ˆæ ·çš„keyå«bigkeyå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311266,"discussion_content":"valueå ç”¨å†…å­˜ä½¿ç”¨é‡å¤§çš„keyã€‚\nè¯¾ä»£è¡¨å‰é¢è¯´äº†ï¼ŒæŸ¥çœ‹å®ä¾‹ä¸­çš„bigkeyï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤\nredis-cli -h ${host} -p ${pt} -a {password} --bigkeys æ¥æŸ¥çœ‹ ï¼ˆå¦‚æœredisæ²¡æœ‰è®¾ç½®å¯†ç çš„è¯ï¼Œ-aå‚æ•°å¯ä»¥ä¸åŠ ï¼‰","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602295239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249759,"user_name":"Sunny","can_delete":false,"product_type":"c1","uid":1067570,"ip_address":"","ucode":"FE57B69A9CF91D","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/32/23db38ab.jpg","comment_is_top":false,"comment_ctime":1600780806,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1600780806","product_id":100056701,"comment_content":"set&#47;list ç±»å‹ç®—bigkey å—ï¼Ÿ è€ƒè™‘åˆ°ä¸»ä»åº“åŒæ­¥çš„æ—¶å€™ï¼Œæ“ä½œè¿™ä¸ªç±»å‹å¾ˆè€—æ—¶ï¼Œæ±‚è¯ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1388092,"avatar":"https://static001.geekbang.org/account/avatar/00/15/2e/3c/eae43616.jpg","nickname":"sid","note":"","ucode":"3D1F9169A19D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311269,"discussion_content":"æ˜¯ä¸æ˜¯bigkeyä¸æ˜¯çœ‹æ•°æ®ç±»å‹ï¼Œæœ¬è´¨æ˜¯çœ‹ä½ è¿™ä¸ªkeyçš„valueå­˜äº†å¤šå°‘æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602295318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249752,"user_name":"ç‹ä¸–è‰º","can_delete":false,"product_type":"c1","uid":1899435,"ip_address":"","ucode":"04DA844568766B","user_header":"https://static001.geekbang.org/account/avatar/00/1c/fb/ab/c0c29cda.jpg","comment_is_top":false,"comment_ctime":1600779538,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1600779538","product_id":100056701,"comment_content":"å½“ä¸»çº¿ç¨‹ä½¿ç”¨åå°å­çº¿ç¨‹æ‰§è¡Œäº†ä¸€æ¬¡ fsyncï¼Œéœ€è¦å†æ¬¡æŠŠæ–°æ¥æ”¶çš„æ“ä½œè®°å½•å†™å›ç£ç›˜æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹å‘ç°ä¸Šä¸€æ¬¡çš„ fsync è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆå®ƒå°±ä¼šé˜»å¡<br><br>è€å¸ˆè¿™æ®µä»£ç é€»è¾‘åœ¨å“ªé‡Œ","like_count":0,"discussions":[{"author":{"id":1108924,"avatar":"https://static001.geekbang.org/account/avatar/00/10/eb/bc/6ccac4bb.jpg","nickname":"æ­¦æ–‡æ–‡æ­¦","note":"","ucode":"5288366646A15B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364273,"discussion_content":"server. cæˆ–è€…aof. cï¼Œå¯ä»¥æœç´¢å…³é”®å­—:  write ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617428257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249604,"user_name":"äº‘å­¦","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":false,"comment_ctime":1600702533,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600702533","product_id":100056701,"comment_content":"é™¤äº†ç»‘å®šcpuä¹Ÿå¯ä»¥æå‡redisè¿›ç¨‹é™æ€ä¼˜å…ˆçº§ï¼Œå¾—åˆ°æ›´å¤šcpuè°ƒåº¦","like_count":0},{"had_liked":false,"id":249567,"user_name":"åœŸè±†ç™½èœ","can_delete":false,"product_type":"c1","uid":1029749,"ip_address":"","ucode":"D1551C729D33E0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b6/75/32c19395.jpg","comment_is_top":false,"comment_ctime":1600693984,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1600693984","product_id":100056701,"comment_content":"è€å¸ˆä¼šè®²å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":249421,"user_name":"tt","can_delete":false,"product_type":"c1","uid":1489957,"ip_address":"","ucode":"7753B79AD5A9AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg","comment_is_top":false,"comment_ctime":1600653377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600653377","product_id":100056701,"comment_content":"å¯ä»¥å†ä»”ç»†åˆ†æä¸€ä¸‹ï¼Œåœ¨è™šæ‹Ÿæœºä¸Šéƒ¨ç½²REDISå®ä¾‹æ—¶ï¼Œç”±äºè™šæ‹ŸåŒ–è½¯ä»¶æœ¬èº«çš„å†…å­˜ç®¡ç†ç®—æ³•å¯¼è‡´çš„SWAPåˆ†æè¿‡ç¨‹å’Œåœ¨ç‰©ç†æœºä¸Šéƒ¨ç½²æ—¶çš„ä¸åŒä¹ˆï¼Ÿ","like_count":0}]}