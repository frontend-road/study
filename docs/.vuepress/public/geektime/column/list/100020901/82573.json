{"id":82573,"title":"39 | æ¡ˆä¾‹ç¯‡ï¼šæ€ä¹ˆç¼“è§£ DDoS æ”»å‡»å¸¦æ¥çš„æ€§èƒ½ä¸‹é™é—®é¢˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘å¸¦ä½ å­¦ä¹ äº†tcpdump å’Œ Wireshark çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¹¶é€šè¿‡å‡ ä¸ªæ¡ˆä¾‹ï¼Œå¸¦ä½ ç”¨è¿™ä¸¤ä¸ªå·¥å…·å®é™…åˆ†æäº†ç½‘ç»œçš„æ”¶å‘è¿‡ç¨‹ã€‚ç¢°åˆ°ç½‘ç»œæ€§èƒ½é—®é¢˜ï¼Œä¸è¦å¿˜è®°å¯ä»¥ç”¨ tcpdump å’Œ Wireshark è¿™ä¸¤ä¸ªå¤§æ€å™¨ï¼ŒæŠ“å–å®é™…ä¼ è¾“çš„ç½‘ç»œåŒ…ï¼Œæ’æŸ¥æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆç¼“è§£ DDoSï¼ˆDistributed Denial of Serviceï¼‰å¸¦æ¥çš„æ€§èƒ½ä¸‹é™é—®é¢˜ã€‚</p><h2>DDoS ç®€ä»‹</h2><p>DDoS çš„å‰èº«æ˜¯ DoSï¼ˆDenail of Serviceï¼‰ï¼Œå³æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡åˆ©ç”¨å¤§é‡çš„åˆç†è¯·æ±‚ï¼Œæ¥å ç”¨è¿‡å¤šçš„ç›®æ ‡èµ„æºï¼Œä»è€Œä½¿ç›®æ ‡æœåŠ¡æ— æ³•å“åº”æ­£å¸¸è¯·æ±‚ã€‚</p><p>DDoSï¼ˆDistributed Denial of Serviceï¼‰ åˆ™æ˜¯åœ¨ DoS çš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨äº†åˆ†å¸ƒå¼æ¶æ„ï¼Œåˆ©ç”¨å¤šå°ä¸»æœºåŒæ—¶æ”»å‡»ç›®æ ‡ä¸»æœºã€‚è¿™æ ·ï¼Œå³ä½¿ç›®æ ‡æœåŠ¡éƒ¨ç½²äº†ç½‘ç»œé˜²å¾¡è®¾å¤‡ï¼Œé¢å¯¹å¤§é‡ç½‘ç»œè¯·æ±‚æ—¶ï¼Œè¿˜æ˜¯æ— åŠ›åº”å¯¹ã€‚</p><p>æ¯”å¦‚ï¼Œç›®å‰å·²çŸ¥çš„æœ€å¤§æµé‡æ”»å‡»ï¼Œæ­£æ˜¯å»å¹´ Github é­å—çš„ <a href=\"https://githubengineering.com/ddos-incident-report/\">DDoS æ”»å‡»</a>ï¼Œå…¶å³°å€¼æµé‡å·²ç»è¾¾åˆ°äº† 1.35Tbpsï¼ŒPPS æ›´æ˜¯è¶…è¿‡äº† 1.2 äº¿ï¼ˆ126.9 millionï¼‰ã€‚</p><p>ä»æ”»å‡»çš„åŸç†ä¸Šæ¥çœ‹ï¼ŒDDoS å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ç§ç±»å‹ã€‚</p><p>ç¬¬ä¸€ç§ï¼Œè€—å°½å¸¦å®½ã€‚æ— è®ºæ˜¯æœåŠ¡å™¨è¿˜æ˜¯è·¯ç”±å™¨ã€äº¤æ¢æœºç­‰ç½‘ç»œè®¾å¤‡ï¼Œå¸¦å®½éƒ½æœ‰å›ºå®šçš„ä¸Šé™ã€‚å¸¦å®½è€—å°½åï¼Œå°±ä¼šå‘ç”Ÿç½‘ç»œæ‹¥å µï¼Œä»è€Œæ— æ³•ä¼ è¾“å…¶ä»–æ­£å¸¸çš„ç½‘ç»œæŠ¥æ–‡ã€‚</p><!-- [[[read_end]]] --><p>ç¬¬äºŒç§ï¼Œè€—å°½æ“ä½œç³»ç»Ÿçš„èµ„æºã€‚ç½‘ç»œæœåŠ¡çš„æ­£å¸¸è¿è¡Œï¼Œéƒ½éœ€è¦ä¸€å®šçš„ç³»ç»Ÿèµ„æºï¼Œåƒæ˜¯CPUã€å†…å­˜ç­‰ç‰©ç†èµ„æºï¼Œä»¥åŠè¿æ¥è¡¨ç­‰è½¯ä»¶èµ„æºã€‚ä¸€æ—¦èµ„æºè€—å°½ï¼Œç³»ç»Ÿå°±ä¸èƒ½å¤„ç†å…¶ä»–æ­£å¸¸çš„ç½‘ç»œè¿æ¥ã€‚</p><p>ç¬¬ä¸‰ç§ï¼Œæ¶ˆè€—åº”ç”¨ç¨‹åºçš„è¿è¡Œèµ„æºã€‚åº”ç”¨ç¨‹åºçš„è¿è¡Œï¼Œé€šå¸¸è¿˜éœ€è¦è·Ÿå…¶ä»–çš„èµ„æºæˆ–ç³»ç»Ÿäº¤äº’ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸€ç›´å¿™äºå¤„ç†æ— æ•ˆè¯·æ±‚ï¼Œä¹Ÿä¼šå¯¼è‡´æ­£å¸¸è¯·æ±‚çš„å¤„ç†å˜æ…¢ï¼Œç”šè‡³å¾—ä¸åˆ°å“åº”ã€‚</p><p>æ¯”å¦‚ï¼Œæ„é€ å¤§é‡ä¸åŒçš„åŸŸåæ¥æ”»å‡» DNS æœåŠ¡å™¨ï¼Œå°±ä¼šå¯¼è‡´ DNS æœåŠ¡å™¨ä¸åœæ‰§è¡Œè¿­ä»£æŸ¥è¯¢ï¼Œå¹¶æ›´æ–°ç¼“å­˜ã€‚è¿™ä¼šæå¤§åœ°æ¶ˆè€— DNS æœåŠ¡å™¨çš„èµ„æºï¼Œä½¿ DNS çš„å“åº”å˜æ…¢ã€‚</p><p>æ— è®ºæ˜¯å“ªä¸€ç§ç±»å‹çš„ DDoSï¼Œå±å®³éƒ½æ˜¯å·¨å¤§çš„ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å¯ä»¥å‘ç°ç³»ç»Ÿé­å—äº† DDoS æ”»å‡»ï¼Œåˆè¯¥å¦‚ä½•åº”å¯¹è¿™ç§æ”»å‡»å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹ï¼Œä¸€èµ·æ¥çœ‹çœ‹è¿™äº›é—®é¢˜ã€‚</p><h2>æ¡ˆä¾‹å‡†å¤‡</h2><p>ä¸‹é¢çš„æ¡ˆä¾‹ä»ç„¶åŸºäº Ubuntu 18.04ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–çš„ Linux ç³»ç»Ÿã€‚æˆ‘ä½¿ç”¨çš„æ¡ˆä¾‹ç¯å¢ƒæ˜¯è¿™æ ·çš„ï¼š</p><ul>\n<li>\n<p>æœºå™¨é…ç½®ï¼š2 CPUï¼Œ8GB å†…å­˜ã€‚</p>\n</li>\n<li>\n<p>é¢„å…ˆå®‰è£… dockerã€sar ã€hping3ã€tcpdumpã€curl ç­‰å·¥å…·ï¼Œæ¯”å¦‚ apt-get install docker.io hping3 tcpdump curlã€‚</p>\n</li>\n</ul><p>è¿™äº›å·¥å…·ä½ åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚å…¶ä¸­ï¼Œhping3 åœ¨ <a href=\"https://time.geekbang.org/column/article/72147\">ç³»ç»Ÿçš„è½¯ä¸­æ–­CPUä½¿ç”¨ç‡å‡é«˜æ¡ˆä¾‹</a> ä¸­æ›¾ç»ä»‹ç»è¿‡ï¼Œå®ƒå¯ä»¥æ„é€  TCP/IP åè®®æ•°æ®åŒ…ï¼Œå¯¹ç³»ç»Ÿè¿›è¡Œå®‰å…¨å®¡è®¡ã€é˜²ç«å¢™æµ‹è¯•ã€DoS æ”»å‡»æµ‹è¯•ç­‰ã€‚</p><p>æœ¬æ¬¡æ¡ˆä¾‹ç”¨åˆ°ä¸‰å°è™šæ‹Ÿæœºï¼Œæˆ‘ç”»äº†ä¸€å¼ å›¾æ¥è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d6/12/d64dd4603a4bd90d110f382d313d8c12.png?wh=826*720\" alt=\"\"></p><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå…¶ä¸­ä¸€å°è™šæ‹Ÿæœºè¿è¡Œ Nginx ï¼Œç”¨æ¥æ¨¡æ‹Ÿå¾…åˆ†æçš„ Web æœåŠ¡å™¨ï¼›è€Œå¦å¤–ä¸¤å°ä½œä¸º Web æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ï¼Œå…¶ä¸­ä¸€å°ç”¨ä½œ DoS æ”»å‡»ï¼Œè€Œå¦ä¸€å°åˆ™æ˜¯æ­£å¸¸çš„å®¢æˆ·ç«¯ã€‚ä½¿ç”¨å¤šå°è™šæ‹Ÿæœºçš„ç›®çš„ï¼Œè‡ªç„¶è¿˜æ˜¯ä¸ºäº†ç›¸äº’éš”ç¦»ï¼Œé¿å…â€œäº¤å‰æ„ŸæŸ“â€ã€‚</p><blockquote>\n<p>ç”±äºæ¡ˆä¾‹åªä½¿ç”¨äº†ä¸€å°æœºå™¨ä½œä¸ºæ”»å‡»æºï¼Œæ‰€ä»¥è¿™é‡Œçš„æ”»å‡»ï¼Œå®é™…ä¸Šè¿˜æ˜¯ä¼ ç»Ÿçš„ DoS ï¼Œè€Œé DDoSã€‚</p>\n</blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸‰ä¸ªç»ˆç«¯ï¼Œåˆ†åˆ« SSH ç™»å½•åˆ°ä¸‰å°æœºå™¨ä¸Šï¼ˆä¸‹é¢çš„æ­¥éª¤ï¼Œéƒ½å‡è®¾ç»ˆç«¯ç¼–å·ä¸å›¾ç¤ºVM ç¼–å·ä¸€è‡´ï¼‰ï¼Œå¹¶å®‰è£…ä¸Šé¢æåˆ°çš„è¿™äº›å·¥å…·ã€‚</p><p>åŒä»¥å‰çš„æ¡ˆä¾‹ä¸€æ ·ï¼Œä¸‹é¢çš„æ‰€æœ‰å‘½ä»¤ï¼Œéƒ½é»˜è®¤ä»¥ root ç”¨æˆ·è¿è¡Œã€‚å¦‚æœä½ æ˜¯ç”¨æ™®é€šç”¨æˆ·èº«ä»½ç™»é™†ç³»ç»Ÿï¼Œè¯·è¿è¡Œ sudo su root å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¿›å…¥åˆ°æ¡ˆä¾‹æ“ä½œç¯èŠ‚ã€‚</p><h2>æ¡ˆä¾‹åˆ†æ</h2><p>é¦–å…ˆï¼Œåœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¿è¡Œæ¡ˆä¾‹ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨ä¸€ä¸ªæœ€åŸºæœ¬çš„ Nginx åº”ç”¨ï¼š</p><pre><code># è¿è¡ŒNginxæœåŠ¡å¹¶å¯¹å¤–å¼€æ”¾80ç«¯å£\n# --network=hostè¡¨ç¤ºä½¿ç”¨ä¸»æœºç½‘ç»œï¼ˆè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿åé¢æ’æŸ¥é—®é¢˜ï¼‰\n$ docker run -itd --name=nginx --network=host nginx\n</code></pre><p>ç„¶åï¼Œåœ¨ç»ˆç«¯äºŒå’Œç»ˆç«¯ä¸‰ä¸­ï¼Œä½¿ç”¨ curl è®¿é—® Nginx ç›‘å¬çš„ç«¯å£ï¼Œç¡®è®¤ Nginx æ­£å¸¸å¯åŠ¨ã€‚å‡è®¾ 192.168.0.30 æ˜¯ Nginx æ‰€åœ¨è™šæ‹Ÿæœºçš„ IP åœ°å€ï¼Œé‚£ä¹ˆè¿è¡Œ curl å‘½ä»¤åï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸‹é¢è¿™ä¸ªè¾“å‡ºç•Œé¢ï¼š</p><pre><code># -wè¡¨ç¤ºåªè¾“å‡ºHTTPçŠ¶æ€ç åŠæ€»æ—¶é—´ï¼Œ-oè¡¨ç¤ºå°†å“åº”é‡å®šå‘åˆ°/dev/null\n$ curl -s -w 'Http code: %{http_code}\\nTotal time:%{time_total}s\\n' -o /dev/null http://192.168.0.30/\n...\nHttp code: 200\nTotal time:0.002s\n</code></pre><p>ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¿é—® Nginx åªéœ€è¦ 2msï¼ˆ0.002sï¼‰ã€‚</p><p>æ¥ç€ï¼Œåœ¨ç»ˆç«¯äºŒä¸­ï¼Œè¿è¡Œ hping3 å‘½ä»¤ï¼Œæ¥æ¨¡æ‹Ÿ DoS æ”»å‡»ï¼š</p><pre><code># -Så‚æ•°è¡¨ç¤ºè®¾ç½®TCPåè®®çš„SYNï¼ˆåŒæ­¥åºåˆ—å·ï¼‰ï¼Œ-pè¡¨ç¤ºç›®çš„ç«¯å£ä¸º80\n# -i u10è¡¨ç¤ºæ¯éš”10å¾®ç§’å‘é€ä¸€ä¸ªç½‘ç»œå¸§\n$ hping3 -S -p 80 -i u10 192.168.0.30\n</code></pre><p>ç°åœ¨ï¼Œå†å›åˆ°ç»ˆç«¯ä¸€ï¼Œä½ å°±ä¼šå‘ç°ï¼Œç°åœ¨ä¸ç®¡æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ï¼Œéƒ½æ…¢äº†å¾ˆå¤šã€‚ä¸è¿‡ï¼Œåœ¨å®è·µæ—¶è¦æ³¨æ„ï¼š</p><ul>\n<li>\n<p>å¦‚æœä½ çš„ç°è±¡ä¸é‚£ä¹ˆæ˜æ˜¾ï¼Œé‚£ä¹ˆè¯·å°è¯•æŠŠå‚æ•°é‡Œé¢çš„ u10 è°ƒå°ï¼ˆæ¯”å¦‚è°ƒæˆ u1ï¼‰ï¼Œæˆ–è€…åŠ ä¸Šâ€“floodé€‰é¡¹ï¼›</p>\n</li>\n<li>\n<p>å¦‚æœä½ çš„ç»ˆç«¯ä¸€å®Œå…¨æ²¡æœ‰å“åº”äº†ï¼Œé‚£ä¹ˆè¯·é€‚å½“è°ƒå¤§ u10ï¼ˆæ¯”å¦‚è°ƒæˆ u30ï¼‰ï¼Œå¦åˆ™åé¢å°±ä¸èƒ½é€šè¿‡ SSH æ“ä½œ VM1ã€‚</p>\n</li>\n</ul><p>ç„¶åï¼Œåˆ°ç»ˆç«¯ä¸‰ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ¨¡æ‹Ÿæ­£å¸¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼š</p><pre><code># --connect-timeoutè¡¨ç¤ºè¿æ¥è¶…æ—¶æ—¶é—´\n$ curl -w 'Http code: %{http_code}\\nTotal time:%{time_total}s\\n' -o /dev/null --connect-timeout 10 http://192.168.0.30\n...\nHttp code: 000\nTotal time:10.001s\ncurl: (28) Connection timed out after 10000 milliseconds\n</code></pre><p>ä½ å¯ä»¥å‘ç°ï¼Œåœ¨ç»ˆç«¯ä¸‰ä¸­ï¼Œæ­£å¸¸å®¢æˆ·ç«¯çš„è¿æ¥è¶…æ—¶äº†ï¼Œå¹¶æ²¡æœ‰æ”¶åˆ° Nginx æœåŠ¡çš„å“åº”ã€‚</p><p>è¿™æ˜¯å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å†å›åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œæ£€æŸ¥ç½‘ç»œçŠ¶å†µã€‚ä½ åº”è¯¥è¿˜è®°å¾—æˆ‘ä»¬å¤šæ¬¡ç”¨è¿‡çš„ sarï¼Œå®ƒæ—¢å¯ä»¥è§‚å¯Ÿ PPSï¼ˆæ¯ç§’æ”¶å‘çš„æŠ¥æ–‡æ•°ï¼‰ï¼Œè¿˜å¯ä»¥è§‚å¯Ÿ BPSï¼ˆæ¯ç§’æ”¶å‘çš„å­—èŠ‚æ•°ï¼‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å›åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code>$ sar -n DEV 1\n08:55:49        IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s   %ifutil\n08:55:50      docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n08:55:50         eth0  22274.00    629.00   1174.64     37.78      0.00      0.00      0.00      0.02\n08:55:50           lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n</code></pre><p>å…³äº sar è¾“å‡ºä¸­çš„å„åˆ—å«ä¹‰ï¼Œæˆ‘åœ¨å‰é¢çš„ Linux ç½‘ç»œåŸºç¡€ä¸­å·²ç»ä»‹ç»è¿‡ï¼Œä½ å¯ä»¥ç‚¹å‡» <a href=\"https://time.geekbang.org/column/article/81057\">è¿™é‡Œ</a> æŸ¥çœ‹ï¼Œæˆ–è€…æ‰§è¡Œ man sar æŸ¥è¯¢æ‰‹å†Œã€‚</p><p>ä»è¿™æ¬¡ sar çš„è¾“å‡ºä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œç½‘ç»œæ¥æ”¶çš„ PPS å·²ç»è¾¾åˆ°äº† 20000 å¤šï¼Œä½†æ˜¯ BPS å´åªæœ‰ 1174 kBï¼Œè¿™æ ·æ¯ä¸ªåŒ…çš„å¤§å°å°±åªæœ‰ 54Bï¼ˆ1174*1024/22274=54ï¼‰ã€‚</p><p>è¿™æ˜æ˜¾å°±æ˜¯ä¸ªå°åŒ…äº†ï¼Œä¸è¿‡å…·ä½“æ˜¯ä¸ªä»€ä¹ˆæ ·çš„åŒ…å‘¢ï¼Ÿé‚£æˆ‘ä»¬å°±ç”¨ tcpdump æŠ“åŒ…çœ‹çœ‹å§ã€‚</p><p>åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ tcpdump å‘½ä»¤ï¼š</p><pre><code># -i eth0 åªæŠ“å–eth0ç½‘å¡ï¼Œ-nä¸è§£æåè®®åå’Œä¸»æœºå\n# tcp port 80è¡¨ç¤ºåªæŠ“å–tcpåè®®å¹¶ä¸”ç«¯å£å·ä¸º80çš„ç½‘ç»œå¸§\n$ tcpdump -i eth0 -n tcp port 80\n09:15:48.287047 IP 192.168.0.2.27095 &gt; 192.168.0.30: Flags [S], seq 1288268370, win 512, length 0\n09:15:48.287050 IP 192.168.0.2.27131 &gt; 192.168.0.30: Flags [S], seq 2084255254, win 512, length 0\n09:15:48.287052 IP 192.168.0.2.27116 &gt; 192.168.0.30: Flags [S], seq 677393791, win 512, length 0\n09:15:48.287055 IP 192.168.0.2.27141 &gt; 192.168.0.30: Flags [S], seq 1276451587, win 512, length 0\n09:15:48.287068 IP 192.168.0.2.27154 &gt; 192.168.0.30: Flags [S], seq 1851495339, win 512, length 0\n...\n</code></pre><p>è¿™ä¸ªè¾“å‡ºä¸­ï¼ŒFlags [S] è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª SYN åŒ…ã€‚å¤§é‡çš„ SYN åŒ…è¡¨æ˜ï¼Œè¿™æ˜¯ä¸€ä¸ª SYN Flood æ”»å‡»ã€‚å¦‚æœä½ ç”¨ä¸Šä¸€èŠ‚è®²è¿‡çš„ Wireshark æ¥è§‚å¯Ÿï¼Œåˆ™å¯ä»¥æ›´ç›´è§‚åœ°çœ‹åˆ° SYN Flood çš„è¿‡ç¨‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/13/f397305c87be6ae43e065d3262ec9113.png?wh=1048*574\" alt=\"\"></p><p>å®é™…ä¸Šï¼ŒSYN Flood  æ­£æ˜¯äº’è”ç½‘ä¸­æœ€ç»å…¸çš„ DDoS æ”»å‡»æ–¹å¼ã€‚ä»ä¸Šé¢è¿™ä¸ªå›¾ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ°å®ƒçš„åŸç†ï¼š</p><ul>\n<li>\n<p>å³å®¢æˆ·ç«¯æ„é€ å¤§é‡çš„ SYN åŒ…ï¼Œè¯·æ±‚å»ºç«‹ TCP è¿æ¥ï¼›</p>\n</li>\n<li>\n<p>è€ŒæœåŠ¡å™¨æ”¶åˆ°åŒ…åï¼Œä¼šå‘æº IP å‘é€ SYN+ACK æŠ¥æ–‡ï¼Œå¹¶ç­‰å¾…ä¸‰æ¬¡æ¡æ‰‹çš„æœ€åä¸€æ¬¡ACKæŠ¥æ–‡ï¼Œç›´åˆ°è¶…æ—¶ã€‚</p>\n</li>\n</ul><p>è¿™ç§ç­‰å¾…çŠ¶æ€çš„ TCP è¿æ¥ï¼Œé€šå¸¸ä¹Ÿç§°ä¸ºåŠå¼€è¿æ¥ã€‚ç”±äºè¿æ¥è¡¨çš„å¤§å°æœ‰é™ï¼Œå¤§é‡çš„åŠå¼€è¿æ¥å°±ä¼šå¯¼è‡´è¿æ¥è¡¨è¿…é€Ÿå æ»¡ï¼Œä»è€Œæ— æ³•å»ºç«‹æ–°çš„ TCP è¿æ¥ã€‚</p><p>å‚è€ƒä¸‹é¢è¿™å¼  TCP çŠ¶æ€å›¾ï¼Œä½ èƒ½çœ‹åˆ°ï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨ç«¯çš„ TCP è¿æ¥ï¼Œä¼šå¤„äº SYN_RECEIVED çŠ¶æ€ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/86/a2/86dabf9cc66b29133fa6a239cfee38a2.png?wh=796*600\" alt=\"\"></p><p>ï¼ˆå›¾ç‰‡æ¥è‡ª <a href=\"https://en.wikipedia.org/wiki/File:Tcp_state_diagram.png\">Wikipedia</a>ï¼‰</p><p>è¿™å…¶å®æç¤ºäº†æˆ‘ä»¬ï¼ŒæŸ¥çœ‹ TCP åŠå¼€è¿æ¥çš„æ–¹æ³•ï¼Œå…³é”®åœ¨äº SYN_RECEIVED çŠ¶æ€çš„è¿æ¥ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ netstat ï¼Œæ¥æŸ¥çœ‹æ‰€æœ‰è¿æ¥çš„çŠ¶æ€ï¼Œä¸è¿‡è¦æ³¨æ„ï¼ŒSYN_REVEIVED çš„çŠ¶æ€ï¼Œé€šå¸¸è¢«ç¼©å†™ä¸º SYN_RECVã€‚</p><p>æˆ‘ä»¬ç»§ç»­åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ netstat å‘½ä»¤ï¼š</p><pre><code># -nè¡¨ç¤ºä¸è§£æåå­—ï¼Œ-pè¡¨ç¤ºæ˜¾ç¤ºè¿æ¥æ‰€å±è¿›ç¨‹\n$ netstat -n -p | grep SYN_REC\ntcp        0      0 192.168.0.30:80          192.168.0.2:12503      SYN_RECV    -\ntcp        0      0 192.168.0.30:80          192.168.0.2:13502      SYN_RECV    -\ntcp        0      0 192.168.0.30:80          192.168.0.2:15256      SYN_RECV    -\ntcp        0      0 192.168.0.30:80          192.168.0.2:18117      SYN_RECV    -\n...\n</code></pre><p>ä»ç»“æœä¸­ï¼Œä½ å¯ä»¥å‘ç°å¤§é‡ SYN_RECV çŠ¶æ€çš„è¿æ¥ï¼Œå¹¶ä¸”æºIPåœ°å€ä¸º 192.168.0.2ã€‚</p><p>è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ wc å·¥å…·ï¼Œæ¥ç»Ÿè®¡æ‰€æœ‰ SYN_RECV çŠ¶æ€çš„è¿æ¥æ•°ï¼š</p><pre><code>$ netstat -n -p | grep SYN_REC | wc -l\n193\n</code></pre><p>æ‰¾å‡ºæº IP åï¼Œè¦è§£å†³ SYN æ”»å‡»çš„é—®é¢˜ï¼Œåªè¦ä¸¢æ‰ç›¸å…³çš„åŒ…å°±å¯ä»¥ã€‚è¿™æ—¶ï¼Œiptables å¯ä»¥å¸®ä½ å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ iptables å‘½ä»¤ï¼š</p><pre><code>$ iptables -I INPUT -s 192.168.0.2 -p tcp -j REJECT\n</code></pre><p>ç„¶åå›åˆ°ç»ˆç«¯ä¸‰ä¸­ï¼Œå†æ¬¡æ‰§è¡Œ curl å‘½ä»¤ï¼ŒæŸ¥çœ‹æ­£å¸¸ç”¨æˆ·è®¿é—® Nginx çš„æƒ…å†µï¼š</p><pre><code>$ curl -w 'Http code: %{http_code}\\nTotal time:%{time_total}s\\n' -o /dev/null --connect-timeout 10 http://192.168.0.30\nHttp code: 200\nTotal time:1.572171s\n</code></pre><p>ç°åœ¨ï¼Œä½ å¯ä»¥å‘ç°ï¼Œæ­£å¸¸ç”¨æˆ·ä¹Ÿå¯ä»¥è®¿é—® Nginx äº†ï¼Œåªæ˜¯å“åº”æ¯”è¾ƒæ…¢ï¼Œä»åŸæ¥çš„ 2ms å˜æˆäº†ç°åœ¨çš„ 1.5sã€‚</p><p>ä¸è¿‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒSYN Flood æ”»å‡»ä¸­çš„æº IP å¹¶ä¸æ˜¯å›ºå®šçš„ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åœ¨ hping3 å‘½ä»¤ä¸­ï¼ŒåŠ å…¥ --rand-source é€‰é¡¹ï¼Œæ¥éšæœºåŒ–æº IPã€‚ä¸è¿‡ï¼Œè¿™æ—¶ï¼Œåˆšæ‰çš„æ–¹æ³•å°±ä¸é€‚ç”¨äº†ã€‚</p><p>å¹¸å¥½ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œå®ç°ç±»ä¼¼çš„ç›®æ ‡ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼Œæ¥é™åˆ¶ syn åŒ…çš„é€Ÿç‡ï¼š</p><pre><code># é™åˆ¶synå¹¶å‘æ•°ä¸ºæ¯ç§’1æ¬¡\n$ iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT\n\n# é™åˆ¶å•ä¸ªIPåœ¨60ç§’æ–°å»ºç«‹çš„è¿æ¥æ•°ä¸º10\n$ iptables -I INPUT -p tcp --dport 80 --syn -m recent --name SYN_FLOOD --update --seconds 60 --hitcount 10 -j REJECT\n</code></pre><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»åˆæ­¥é™åˆ¶äº† SYN Flood æ”»å‡»ã€‚ä¸è¿‡è¿™è¿˜ä¸å¤Ÿï¼Œå› ä¸ºæˆ‘ä»¬çš„æ¡ˆä¾‹è¿˜åªæ˜¯å•ä¸ªçš„æ”»å‡»æºã€‚</p><p>å¦‚æœæ˜¯å¤šå°æœºå™¨åŒæ—¶å‘é€ SYN Floodï¼Œè¿™ç§æ–¹æ³•å¯èƒ½å°±ç›´æ¥æ— æ•ˆäº†ã€‚å› ä¸ºä½ å¾ˆå¯èƒ½æ— æ³• SSH ç™»å½•ï¼ˆSSH ä¹Ÿæ˜¯åŸºäº TCP çš„ï¼‰åˆ°æœºå™¨ä¸Šå»ï¼Œæ›´åˆ«ææ‰§è¡Œä¸Šè¿°æ‰€æœ‰çš„æ’æŸ¥å‘½ä»¤ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™è¿˜éœ€è¦ä½ äº‹å…ˆå¯¹ç³»ç»Ÿåšä¸€äº› TCP ä¼˜åŒ–ã€‚</p><p>æ¯”å¦‚ï¼ŒSYN Flood ä¼šå¯¼è‡´ SYN_RECV çŠ¶æ€çš„è¿æ¥æ€¥å‰§å¢å¤§ã€‚åœ¨ä¸Šé¢çš„ netstat å‘½ä»¤ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ° 190 å¤šä¸ªå¤„äºåŠå¼€çŠ¶æ€çš„è¿æ¥ã€‚</p><p>ä¸è¿‡ï¼ŒåŠå¼€çŠ¶æ€çš„è¿æ¥æ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤çš„åŠè¿æ¥å®¹é‡åªæœ‰ 256ï¼š</p><pre><code>$ sysctl net.ipv4.tcp_max_syn_backlog\nnet.ipv4.tcp_max_syn_backlog = 256\n</code></pre><p>æ¢å¥è¯è¯´ï¼Œ SYN åŒ…æ•°å†ç¨å¾®å¢å¤§ä¸€äº›ï¼Œå°±ä¸èƒ½ SSH ç™»å½•æœºå™¨äº†ã€‚ æ‰€ä»¥ï¼Œä½ è¿˜åº”è¯¥å¢å¤§åŠè¿æ¥çš„å®¹é‡ï¼Œæ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå°†å…¶å¢å¤§ä¸º 1024ï¼š</p><pre><code>$ sysctl -w net.ipv4.tcp_max_syn_backlog=1024\nnet.ipv4.tcp_max_syn_backlog = 1024\n</code></pre><p>å¦å¤–ï¼Œè¿æ¥æ¯ä¸ª SYN_RECV æ—¶ï¼Œå¦‚æœå¤±è´¥çš„è¯ï¼Œå†…æ ¸è¿˜ä¼šè‡ªåŠ¨é‡è¯•ï¼Œå¹¶ä¸”é»˜è®¤çš„é‡è¯•æ¬¡æ•°æ˜¯5æ¬¡ã€‚ä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°†å…¶å‡å°ä¸º 1 æ¬¡ï¼š</p><pre><code>$ sysctl -w net.ipv4.tcp_synack_retries=1\nnet.ipv4.tcp_synack_retries = 1\n</code></pre><p>é™¤æ­¤ä¹‹å¤–ï¼ŒTCP SYN Cookies ä¹Ÿæ˜¯ä¸€ç§ä¸“é—¨é˜²å¾¡ SYN Flood æ”»å‡»çš„æ–¹æ³•ã€‚SYN Cookies åŸºäºè¿æ¥ä¿¡æ¯ï¼ˆåŒ…æ‹¬æºåœ°å€ã€æºç«¯å£ã€ç›®çš„åœ°å€ã€ç›®çš„ç«¯å£ç­‰ï¼‰ä»¥åŠä¸€ä¸ªåŠ å¯†ç§å­ï¼ˆå¦‚ç³»ç»Ÿå¯åŠ¨æ—¶é—´ï¼‰ï¼Œè®¡ç®—å‡ºä¸€ä¸ªå“ˆå¸Œå€¼ï¼ˆSHA1ï¼‰ï¼Œè¿™ä¸ªå“ˆå¸Œå€¼ç§°ä¸º cookieã€‚</p><p>ç„¶åï¼Œè¿™ä¸ª cookie å°±è¢«ç”¨ä½œåºåˆ—å·ï¼Œæ¥åº”ç­” SYN+ACK åŒ…ï¼Œå¹¶é‡Šæ”¾è¿æ¥çŠ¶æ€ã€‚å½“å®¢æˆ·ç«¯å‘é€å®Œä¸‰æ¬¡æ¡æ‰‹çš„æœ€åä¸€æ¬¡ ACK åï¼ŒæœåŠ¡å™¨å°±ä¼šå†æ¬¡è®¡ç®—è¿™ä¸ªå“ˆå¸Œå€¼ï¼Œç¡®è®¤æ˜¯ä¸Šæ¬¡è¿”å›çš„ SYN+ACK çš„è¿”å›åŒ…ï¼Œæ‰ä¼šè¿›å…¥ TCP çš„è¿æ¥çŠ¶æ€ã€‚</p><p>å› è€Œï¼Œå¼€å¯ SYN Cookies åï¼Œå°±ä¸éœ€è¦ç»´æŠ¤åŠå¼€è¿æ¥çŠ¶æ€äº†ï¼Œè¿›è€Œä¹Ÿå°±æ²¡æœ‰äº†åŠè¿æ¥æ•°çš„é™åˆ¶ã€‚</p><blockquote>\n<p>æ³¨æ„ï¼Œå¼€å¯ TCP syncookies åï¼Œå†…æ ¸é€‰é¡¹ net.ipv4.tcp_max_syn_backlog ä¹Ÿå°±æ— æ•ˆäº†ã€‚</p>\n</blockquote><p>ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ï¼Œå¼€å¯ TCP SYN Cookiesï¼š</p><pre><code>$ sysctl -w net.ipv4.tcp_syncookies=1\nnet.ipv4.tcp_syncookies = 1\n</code></pre><p>æ³¨æ„ï¼Œä¸Šè¿° sysctl å‘½ä»¤ä¿®æ”¹çš„é…ç½®éƒ½æ˜¯ä¸´æ—¶çš„ï¼Œé‡å¯åè¿™äº›é…ç½®å°±ä¼šä¸¢å¤±ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯é…ç½®æŒä¹…åŒ–ï¼Œä½ è¿˜åº”è¯¥æŠŠè¿™äº›é…ç½®ï¼Œå†™å…¥ /etc/sysctl.conf æ–‡ä»¶ä¸­ã€‚æ¯”å¦‚ï¼š</p><pre><code>$ cat /etc/sysctl.conf\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_synack_retries = 1\nnet.ipv4.tcp_max_syn_backlog = 1024\n</code></pre><p>ä¸è¿‡è¦è®°å¾—ï¼Œå†™å…¥ /etc/sysctl.conf çš„é…ç½®ï¼Œéœ€è¦æ‰§è¡Œ sysctl -p å‘½ä»¤åï¼Œæ‰ä¼šåŠ¨æ€ç”Ÿæ•ˆã€‚</p><p>å½“ç„¶æ¡ˆä¾‹ç»“æŸåï¼Œåˆ«å¿˜äº†æ‰§è¡Œ docker rm -f nginx å‘½ä»¤ï¼Œæ¸…ç†æ¡ˆä¾‹å¼€å§‹æ—¶å¯åŠ¨çš„ Nginx åº”ç”¨ã€‚</p><h2>DDoSåˆ°åº•è¯¥æ€ä¹ˆé˜²å¾¡</h2><p>åˆ°è¿™é‡Œï¼Œä»Šå¤©çš„æ¡ˆä¾‹å°±ç»“æŸäº†ã€‚ä¸è¿‡ï¼Œä½ è‚¯å®šè¿˜æœ‰ç–‘é—®ã€‚ä½ åº”è¯¥æ³¨æ„åˆ°äº†ï¼Œä»Šå¤©çš„ä¸»é¢˜æ˜¯â€œç¼“è§£â€ï¼Œè€Œä¸æ˜¯â€œè§£å†³â€ DDoS é—®é¢˜ã€‚</p><p>ä¸ºä»€ä¹ˆä¸æ˜¯è§£å†³ DDoS ï¼Œè€Œåªæ˜¯ç¼“è§£å‘¢ï¼Ÿè€Œä¸”ä»Šå¤©æ¡ˆä¾‹ä¸­çš„æ–¹æ³•ï¼Œä¹Ÿåªæ˜¯è®© Nginx æœåŠ¡è®¿é—®ä¸å†è¶…æ—¶ï¼Œä½†è®¿é—®å»¶è¿Ÿè¿˜æ˜¯æ¯”ä¸€å¼€å§‹æ—¶çš„ 2ms å¤§å¾—å¤šã€‚</p><p>å®é™…ä¸Šï¼Œå½“ DDoS æŠ¥æ–‡åˆ°è¾¾æœåŠ¡å™¨åï¼ŒLinux æä¾›çš„æœºåˆ¶åªèƒ½ç¼“è§£ï¼Œè€Œæ— æ³•å½»åº•è§£å†³ã€‚å³ä½¿åƒæ˜¯ SYN Flood è¿™æ ·çš„å°åŒ…æ”»å‡»ï¼Œå…¶å·¨å¤§çš„ PPS ï¼Œä¹Ÿä¼šå¯¼è‡´ Linux å†…æ ¸æ¶ˆè€—å¤§é‡èµ„æºï¼Œè¿›è€Œå¯¼è‡´å…¶ä»–ç½‘ç»œæŠ¥æ–‡çš„å¤„ç†ç¼“æ…¢ã€‚</p><p>è™½ç„¶ä½ å¯ä»¥è°ƒæ•´å†…æ ¸å‚æ•°ï¼Œç¼“è§£ DDoS å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå´ä¹Ÿä¼šåƒæ¡ˆä¾‹è¿™æ ·ï¼Œæ— æ³•å½»åº•è§£å†³å®ƒã€‚</p><p>åœ¨ä¹‹å‰çš„ <a href=\"https://time.geekbang.org/column/article/81268\">C10Kã€C100K</a> <a href=\"https://time.geekbang.org/column/article/81268\">æ–‡ç« </a>  ä¸­ï¼Œæˆ‘ä¹Ÿæåˆ°è¿‡ï¼ŒLinux å†…æ ¸ä¸­å†—é•¿çš„åè®®æ ˆï¼Œåœ¨ PPS å¾ˆå¤§æ—¶ï¼Œå°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„è´Ÿæ‹…ã€‚å¯¹ DDoS æ”»å‡»æ¥è¯´ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ã€‚</p><p>æ‰€ä»¥ï¼Œå½“æ—¶æåˆ°çš„ C10M çš„æ–¹æ³•ï¼Œç”¨åˆ°è¿™é‡ŒåŒæ ·é€‚åˆã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åŸºäº XDP æˆ–è€… DPDKï¼Œæ„å»º DDoS æ–¹æ¡ˆï¼Œåœ¨å†…æ ¸ç½‘ç»œåè®®æ ˆå‰ï¼Œæˆ–è€…è·³è¿‡å†…æ ¸åè®®æ ˆï¼Œæ¥è¯†åˆ«å¹¶ä¸¢å¼ƒ DDoS æŠ¥æ–‡ï¼Œé¿å…DDoS å¯¹ç³»ç»Ÿå…¶ä»–èµ„æºçš„æ¶ˆè€—ã€‚</p><p>ä¸è¿‡ï¼Œå¯¹äºæµé‡å‹çš„ DDoS æ¥è¯´ï¼Œå½“æœåŠ¡å™¨çš„å¸¦å®½è¢«è€—å°½åï¼Œåœ¨æœåŠ¡å™¨å†…éƒ¨å¤„ç†å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚è¿™æ—¶ï¼Œåªèƒ½åœ¨æœåŠ¡å™¨å¤–éƒ¨çš„ç½‘ç»œè®¾å¤‡ä¸­ï¼Œè®¾æ³•è¯†åˆ«å¹¶é˜»æ–­æµé‡ï¼ˆå½“ç„¶å‰ææ˜¯ç½‘ç»œè®¾å¤‡è¦èƒ½æ‰›ä½æµé‡æ”»å‡»ï¼‰ã€‚æ¯”å¦‚ï¼Œè´­ç½®ä¸“ä¸šçš„å…¥ä¾µæ£€æµ‹å’Œé˜²å¾¡è®¾å¤‡ï¼Œé…ç½®æµé‡æ¸…æ´—è®¾å¤‡é˜»æ–­æ¶æ„æµé‡ç­‰ã€‚</p><p>æ—¢ç„¶ DDoS è¿™ä¹ˆéš¾é˜²å¾¡ï¼Œè¿™æ˜¯ä¸æ˜¯è¯´æ˜ï¼Œ Linux æœåŠ¡å™¨å†…éƒ¨å‹æ ¹å„¿å°±ä¸å…³æ³¨è¿™ä¸€ç‚¹ï¼Œè€Œæ˜¯å…¨éƒ¨äº¤ç»™ä¸“ä¸šçš„ç½‘ç»œè®¾å¤‡æ¥å¤„ç†å‘¢ï¼Ÿ</p><p>å½“ç„¶ä¸æ˜¯ï¼Œå› ä¸º DDoS å¹¶ä¸ä¸€å®šæ˜¯å› ä¸ºå¤§æµé‡æˆ–è€…å¤§ PPSï¼Œæœ‰æ—¶å€™ï¼Œæ…¢é€Ÿçš„è¯·æ±‚ä¹Ÿä¼šå¸¦æ¥å·¨å¤§çš„æ€§èƒ½ä¸‹é™ï¼ˆè¿™ç§æƒ…å†µç§°ä¸ºæ…¢é€Ÿ DDoSï¼‰ã€‚</p><p>æ¯”å¦‚ï¼Œå¾ˆå¤šé’ˆå¯¹åº”ç”¨ç¨‹åºçš„æ”»å‡»ï¼Œéƒ½ä¼šä¼ªè£…æˆæ­£å¸¸ç”¨æˆ·æ¥è¯·æ±‚èµ„æºã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚æµé‡å¯èƒ½æœ¬èº«å¹¶ä¸å¤§ï¼Œä½†å“åº”æµé‡å´å¯èƒ½å¾ˆå¤§ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºå†…éƒ¨ä¹Ÿå¾ˆå¯èƒ½è¦è€—è´¹å¤§é‡èµ„æºå¤„ç†ã€‚</p><p>è¿™æ—¶ï¼Œå°±éœ€è¦åº”ç”¨ç¨‹åºè€ƒè™‘è¯†åˆ«ï¼Œå¹¶å°½æ—©æ‹’ç»æ‰è¿™äº›æ¶æ„æµé‡ï¼Œæ¯”å¦‚åˆç†åˆ©ç”¨ç¼“å­˜ã€å¢åŠ  WAFï¼ˆWeb Application Firewallï¼‰ã€ä½¿ç”¨ CDN ç­‰ç­‰ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å­¦ä¹ äº†åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼ˆDDoSï¼‰æ—¶çš„ç¼“è§£æ–¹æ³•ã€‚DDoS åˆ©ç”¨å¤§é‡çš„ä¼ªé€ è¯·æ±‚ï¼Œä½¿ç›®æ ‡æœåŠ¡è€—è´¹å¤§é‡èµ„æºï¼Œæ¥å¤„ç†è¿™äº›æ— æ•ˆè¯·æ±‚ï¼Œè¿›è€Œæ— æ³•æ­£å¸¸å“åº”æ­£å¸¸çš„ç”¨æˆ·è¯·æ±‚ã€‚</p><p>ç”±äº DDoS çš„åˆ†å¸ƒå¼ã€å¤§æµé‡ã€éš¾è¿½è¸ªç­‰ç‰¹ç‚¹ï¼Œç›®å‰è¿˜æ²¡æœ‰æ–¹æ³•å¯ä»¥å®Œå…¨é˜²å¾¡ DDoS å¸¦æ¥çš„é—®é¢˜ï¼Œåªèƒ½è®¾æ³•ç¼“è§£è¿™ä¸ªå½±å“ã€‚</p><p>æ¯”å¦‚ï¼Œä½ å¯ä»¥è´­ä¹°ä¸“ä¸šçš„æµé‡æ¸…æ´—è®¾å¤‡å’Œç½‘ç»œé˜²ç«å¢™ï¼Œåœ¨ç½‘ç»œå…¥å£å¤„é˜»æ–­æ¶æ„æµé‡ï¼Œåªä¿ç•™æ­£å¸¸æµé‡è¿›å…¥æ•°æ®ä¸­å¿ƒçš„æœåŠ¡å™¨ä¸­ã€‚</p><p>åœ¨ Linux æœåŠ¡å™¨ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å†…æ ¸è°ƒä¼˜ã€DPDKã€XDP ç­‰å¤šç§æ–¹æ³•ï¼Œæ¥å¢å¤§æœåŠ¡å™¨çš„æŠ—æ”»å‡»èƒ½åŠ›ï¼Œé™ä½ DDoS å¯¹æ­£å¸¸æœåŠ¡çš„å½±å“ã€‚è€Œåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨å„çº§ç¼“å­˜ã€ WAFã€CDN ç­‰æ–¹å¼ï¼Œç¼“è§£ DDoS å¯¹åº”ç”¨ç¨‹åºçš„å½±å“ã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ã€‚</p><p>çœ‹åˆ°ä»Šå¤©çš„æ¡ˆä¾‹ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—çœ¼ç†Ÿã€‚å®é™…ä¸Šï¼Œå®ƒæ­£æ˜¯åœ¨ <a href=\"https://time.geekbang.org/column/article/72147\">ç³»ç»Ÿçš„è½¯ä¸­æ–­CPUä½¿ç”¨ç‡å‡é«˜æ¡ˆä¾‹</a> åŸºç¡€ä¸Šæ‰©å±•è€Œæ¥çš„ã€‚å½“æ—¶ï¼Œæˆ‘ä»¬æ˜¯ä»è½¯ä¸­æ–­ CPU ä½¿ç”¨ç‡çš„è§’åº¦æ¥åˆ†æçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒDDoS ä¼šå¯¼è‡´è½¯ä¸­æ–­ CPU ä½¿ç”¨ç‡ï¼ˆsoftirqï¼‰å‡é«˜ã€‚</p><p>å›æƒ³ä¸€ä¸‹å½“æ—¶çš„æ¡ˆä¾‹å’Œåˆ†ææ€è·¯ï¼Œå†ç»“åˆä»Šå¤©çš„æ¡ˆä¾‹ï¼Œä½ è§‰å¾—è¿˜æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¥æ£€æµ‹ DDoS æ”»å‡»å‘¢ï¼Ÿé™¤äº† tcpdumpï¼Œè¿˜æœ‰å“ªäº›æ–¹æ³•æŸ¥æ‰¾è¿™äº›æ”»å‡»çš„æºåœ°å€ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","neighbors":{"left":{"article_title":"38 | æ¡ˆä¾‹ç¯‡ï¼šæ€ä¹ˆä½¿ç”¨ tcpdump å’Œ Wireshark åˆ†æç½‘ç»œæµé‡ï¼Ÿ","id":82321},"right":{"article_title":"40 | æ¡ˆä¾‹ç¯‡ï¼šç½‘ç»œè¯·æ±‚å»¶è¿Ÿå˜å¤§äº†ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿ","id":82833}},"comments":[{"had_liked":false,"id":69332,"user_name":"æ€€ç‰¹","can_delete":false,"product_type":"c1","uid":1072331,"ip_address":"","ucode":"3DACB205798ED3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5c/cb/3ebdcc49.jpg","comment_is_top":false,"comment_ctime":1550718891,"is_pvip":true,"replies":[{"id":"24843","content":"å“ˆå“ˆï¼Œè°¢è°¢çƒ­å¿ƒå›å¤å’Œæ”¯æŒ","user_name":"ä½œè€…å›å¤","comment_id":69332,"uid":"1001282","ip_address":"","utype":1,"ctime":1550849799,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"117514835883","product_id":100020901,"comment_content":"è¿™ä¸ªä¸“æ å¤ªè¶…å€¼ï¼Œæˆ‘è·Ÿè¿½å‰§ä¸€æ ·çš„è¿½åˆ°ç°åœ¨ï¼Œæ”¶è·å·²ç»å·¨å¤§ï¼<br>è°¢è°¢å€ªå·¥çš„åˆ†äº«ã€‚<br>æ›´è°¢è°¢å€ªå·¥å¯¹ç•™è¨€ä¸€ä¸ä¸è‹Ÿçš„å›å¤---è¿™ä»½å¯¹å¬ä¼—çš„è€å¿ƒï¼Œå…¶ä»–ä¸“æ çš„ä½œè€…æ²¡æœ‰ä¸€ä¸ªèƒ½æ¯”å¾—ä¸Šçš„ã€‚<br>ç»§ç»­è¿½å‰§ï¼","like_count":28,"discussions":[{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312047,"discussion_content":"è¯·é—®å¹³æ—¶è¿½çš„ä»€ä¹ˆå‰§ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602574184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1110039,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/17/796a3d20.jpg","nickname":"è¨€åå¹´","note":"","ucode":"67B8B49C3A3B17","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393572,"discussion_content":"ç½‘ç»œå‰§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631498883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":312047,"ip_address":""},"score":393572,"extra":""}]},{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440064,"discussion_content":"å“ˆå“ˆï¼Œè°¢è°¢çƒ­å¿ƒå›å¤å’Œæ”¯æŒ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1550849799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215737,"user_name":"stackWarn","can_delete":false,"product_type":"c1","uid":1002005,"ip_address":"","ucode":"89672E452DEBA5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/15/106eaaa8.jpg","comment_is_top":false,"comment_ctime":1589092266,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"87488438186","product_id":100020901,"comment_content":"è®²çš„å¾ˆä¸é”™ã€‚è¡¥å……ä¸€ç‚¹ï¼ŒåŠè¿æ¥çŠ¶æ€ä¸åªè¿™ä¸€ä¸ªå‚æ•°net.ipv4.tcp_max_syn_backlog æ§åˆ¶ï¼Œå®é™…æ˜¯ è¿™ä¸ªï¼Œè¿˜æœ‰ç³»ç»Ÿsomaxconï¼Œä»¥åŠåº”ç”¨ç¨‹åºçš„backlogï¼Œä¸‰ä¸ªä¸€èµ·æ§åˆ¶çš„ã€‚å…·ä½“å¯ä»¥çœ‹ä¸‹ç›¸å…³çš„æºç ","like_count":21,"discussions":[{"author":{"id":1082187,"avatar":"https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg","nickname":"sky","note":"","ucode":"FC323371453C97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552050,"discussion_content":"ä½ è¯´çš„è¿™ä¸‰ä¸ªæˆ‘éƒ½é…ç½®äº†å‘€ï¼Œä½†è¿˜æ²¡èµ·ä½œç”¨å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645258576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68797,"user_name":"æç‡•å¹³Â²â°Â¹â¸","can_delete":false,"product_type":"c1","uid":1100680,"ip_address":"","ucode":"D34F2C257F561C","user_header":"https://static001.geekbang.org/account/avatar/00/10/cb/88/f9ae7bc9.jpg","comment_is_top":false,"comment_ctime":1550620551,"is_pvip":false,"replies":[{"id":"24527","content":"èµğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":68797,"uid":"1001282","ip_address":"","utype":1,"ctime":1550674536,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"48795260807","product_id":100020901,"comment_content":"æœåŠ¡å™¨æ’ä¸Šç½‘çº¿å°±åƒå¼€è½¦ä¸Šè·¯ã€‚<br><br>DDoSæ”»å‡»å¯ä»¥ç†è§£ä¸ºæ’è½¦ï¼Œæå‡æ±½è½¦æœ¬èº«çš„å®‰å…¨ç³»æ•°ä¼šæœ‰ç”¨ã€‚<br>å¤§é‡DDoSæ”»å‡»å¯ä»¥ç†è§£ä¸ºæ’ä¸Šå¤§è´§è½¦ï¼Œéœ€è¦æŠ¤å«è½¦é˜Ÿæ¥ä¿æŠ¤ä¸»è½¦ã€‚<br>","like_count":12,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439846,"discussion_content":"èµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550674536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71144,"user_name":"ichiro","can_delete":false,"product_type":"c1","uid":1086179,"ip_address":"","ucode":"D1708D87538F42","user_header":"https://static001.geekbang.org/account/avatar/00/10/92/e3/1be13204.jpg","comment_is_top":false,"comment_ctime":1551273354,"is_pvip":false,"replies":[{"id":"25717","content":"ä¼šçš„ï¼Œå®é™…ä¸Šä¼˜åŒ–ç½‘ç»œéƒ½ä¼šå ç”¨æ›´å¤šçš„cpuå’Œå†…å­˜ã€‚æ‰€ä»¥è¿˜è¦çœ‹ä¼˜åŒ–æ˜¯ä¸æ˜¯å€¼å¾—ï¼Œæ˜¯ä¸æ˜¯æœ€éœ€è¦ä¼˜åŒ–çš„ç“¶é¢ˆ","user_name":"ä½œè€…å›å¤","comment_id":71144,"uid":"1001282","ip_address":"","utype":1,"ctime":1551399713,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"44500946314","product_id":100020901,"comment_content":"æœ€è¿‘æœåŠ¡ä¼šå‡ºç°å¹²æ ¸ç°è±¡ï¼Œä¸€ä¸ªå•è¿›ç¨‹ç¨‹åºå‘ç°æŠŠä¸€ä¸ªcpuè€—å°½ï¼Œç”¨topå‘ç°ä¸€ä¸ªcpuçš„ï¼Œè½¯ä¸­æ–­å¾ˆé«˜ï¼Œé€šè¿‡watch -d cat &#47;proc&#47;softireqï¼Œå‘ç°ç½‘ç»œä¸­æ–­å¾ˆé«˜ï¼Œç„¶åé…ç½®å¤šç½‘å¡é˜Ÿåˆ—ï¼ŒæŠŠä¸­æ–­åˆ†æ•£åˆ°æ˜¯ä»–cpuï¼Œç¼“è§£äº†è¿›ç¨‹cpuçš„å‹åŠ›ï¼Œä½†åŒæ—¶å¸¦æ¥æ‹…å¿§ï¼Œé…ç½®å¤šç½‘å¡é˜Ÿåˆ—ç»‘å®šï¼Œä¼šä¸ä¼šå¸¦æ¥cpuåˆ‡æ¢ï¼Œç¼“å­˜å¤±æ•ˆç­‰è´Ÿé¢å½±å“ï¼Ÿå¦å¤–ï¼Œè€å¸ˆè¿˜æœ‰åˆ«çš„å»ºè®®å—ï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441010,"discussion_content":"ä¼šçš„ï¼Œå®é™…ä¸Šä¼˜åŒ–ç½‘ç»œéƒ½ä¼šå ç”¨æ›´å¤šçš„cpuå’Œå†…å­˜ã€‚æ‰€ä»¥è¿˜è¦çœ‹ä¼˜åŒ–æ˜¯ä¸æ˜¯å€¼å¾—ï¼Œæ˜¯ä¸æ˜¯æœ€éœ€è¦ä¼˜åŒ–çš„ç“¶é¢ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551399713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69184,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1550674495,"is_pvip":false,"replies":[{"id":"24840","content":"å—¯ï¼Œsarå’Œnetstatéƒ½æ˜¯æœ€å¸¸ç”¨çš„å·¥å…·","user_name":"ä½œè€…å›å¤","comment_id":69184,"uid":"1001282","ip_address":"","utype":1,"ctime":1550849520,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"40205380159","product_id":100020901,"comment_content":"æ£€æµ‹DDOSæ”»å‡»ï¼Œæˆ‘æ²¡æœ‰ä»€ä¹ˆè¿™æ–¹é¢ç»éªŒæƒ³äº†ä¸‹ï¼š<br>1ã€æ—¢ç„¶æ”»å‡»ï¼Œè‚¯å®šä¸æ˜¯æ­£å¸¸ä¸šåŠ¡ï¼Œæ‰€ä»¥åœ¨sar -n DEV 4 å‘½ä»¤çœ‹è¿è¡ŒåŒ…çš„æ—¶å€™ï¼Œä¸å…‰è¦æ³¨æ„æ”¶åˆ°çš„åŒ…çš„å¤§å°ï¼Œè¿˜è¦æ³¨æ„å¹³æ—¶åœ¨ç›‘æ§ä¸šåŠ¡çš„æ—¶å€™è§‚å¯Ÿæ­£å¸¸çš„ä¸šåŠ¡çš„æ”¶åŒ…é‡ï¼Œåšä¸€ä¸ªæ¨ªå‘æ¯”è¾ƒï¼Œç¡®å®šå¼‚å¸¸æµé‡ï¼›è¿˜æœ‰ä¸€ç‚¹ç‰¹åˆ«é‡è¦ï¼Œæˆ‘è§‰å¾—tcpè¿æ¥äº¤äº’åŸºæœ¬éƒ½æ˜¯åŒå‘çš„ï¼Œé‚£ä¹ˆå›åŒ…æ•°é‡å’Œå‘åŒ…çš„æ•°é‡ä¸èƒ½ç›¸å·®å¤ªå¤§ï¼Œå¦‚æœå¤ªå¤§äº†å¯èƒ½æœ‰é—®é¢˜ã€‚<br><br>2ã€è‡³äºæŸ¥çœ‹æºIPï¼Œé™¤äº†tcpdumpå¤–ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡netstat ç»“åˆwc ç»Ÿè®¡ä¸‹å„ç±»çŠ¶æ€çš„è¿æ¥æ•°ï¼Œå¦‚æœè¿æ¥æ•°è¶…è¿‡å¹³æ—¶çš„è¿æ¥æ•°å°±è¦æ³¨æ„ï¼Œå…³æ³¨çŠ¶æ€ä¸€è‡´çš„è¿æ¥æ•°ï¼Œè¿™é‡Œé¢ä¹Ÿæœ‰ipä¿¡æ¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åˆ¤æ–­æ¥æºã€‚<br>","like_count":10,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439988,"discussion_content":"å—¯ï¼Œsarå’Œnetstatéƒ½æ˜¯æœ€å¸¸ç”¨çš„å·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550849520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203076,"user_name":"æ€€æ£æ¢¦æƒ³çš„å­¦æ¸£","can_delete":false,"product_type":"c1","uid":1916685,"ip_address":"","ucode":"2349B9F4F6FDE3","user_header":"https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg","comment_is_top":false,"comment_ctime":1586136880,"is_pvip":true,"discussion_count":5,"race_medal":0,"score":"35945875248","product_id":100020901,"comment_content":"æˆ‘è§‚æ‘©è¿‡æˆ‘æ‰€åœ¨åŸå¸‚çš„éƒ¨åˆ†å­¦æ ¡ä»¥åŠéƒ¨åˆ†æ•™è‚²éƒ¨é—¨ç½‘ç«™çš„DDOSé˜²æŠ¤ï¼Œä»–ä»¬çš„æ–¹æ¡ˆæ˜¯å•ä¸ªIPå‘æ¥è®¿é—®è¯·æ±‚ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªæ£€æµ‹çš„ç•Œé¢ï¼Œå¦‚æœè¿™ä¸ªIPæ— æ­£å¸¸äº’åŠ¨å“åº”ï¼Œç›´æ¥æ‹‰é»‘1ä¸ªæœˆï¼Œå¦‚æœæƒ³è§£å°ï¼Œéœ€è¦è‡ªå·±å®åè®¤è¯å‘é‚®ä»¶åˆ°æ•™è‚²éƒ¨é—¨çš„å’¨è¯¢é‚®ç®±ç”³è¯·ã€‚è¿™ä¸ªåŠæ³•æ˜¯çœŸçš„æŒºç¥å¥‡çš„ã€‚æœ‰äº›å¥½å¥‡ï¼Œé€»è¾‘ä¸Šå¤–å±‚åŠ äº†ä¸€äº›é˜²ç«å¢™æˆ–è€…é˜²æŠ¤è®¾å¤‡ï¼Œé‚£å†…éƒ¨çš„æœåŠ¡å™¨è¿˜éœ€è¦é…ç½®ç½‘ç»œé˜²æŠ¤çš„ç­–ç•¥å—ã€‚","like_count":9,"discussions":[{"author":{"id":2068424,"avatar":"","nickname":"Geek_9815f1","note":"","ucode":"34EE8566A53F10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292743,"discussion_content":"æœ‰ç¼ºé™·å§ã€‚ æ¨¡æ‹Ÿéšæœºipï¼Œ ä¹Ÿå¯èƒ½ææ­»è‡ªå·±ã€‚ è¿™æ ·å¯¼è‡´æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½æ— æ³•è®¿é—® ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595321192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1916685,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg","nickname":"æ€€æ£æ¢¦æƒ³çš„å­¦æ¸£","note":"","ucode":"2349B9F4F6FDE3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2068424,"avatar":"","nickname":"Geek_9815f1","note":"","ucode":"34EE8566A53F10","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413279,"discussion_content":"æ£€æµ‹çš„æ˜¯åŒä¸€ä¸ªIPå¤šæ¬¡è®¿é—®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636435267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292743,"ip_address":""},"score":413279,"extra":""}]},{"author":{"id":1047423,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fb/7f/746a6f5e.jpg","nickname":"Q","note":"","ucode":"785546C617D3DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537273,"discussion_content":"è¿™ç§è¡Œæ”¿å’Œå…¬å…±éƒ¨é—¨çš„ç½‘ç«™å¯ä»¥è¿™ä¹ˆæï¼Œäº’è”ç½‘å…¬å¸ç«™ç‚¹è¿™ä¹ˆæï¼Œææ­»è‡ªå·±ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639017484,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1236002,"avatar":"https://static001.geekbang.org/account/avatar/00/12/dc/22/bb8e93b4.jpg","nickname":"æ™´å¤©é›¨ä¼","note":"","ucode":"F14D8133A1C077","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389293,"discussion_content":"æˆ‘è®°å¾—å¾ˆæ—©ä¹‹å‰å¬ä¸€ä¸ªè®²ç½‘ç»œçš„è€å¸ˆè¯´è¿‡ï¼Œæœ‰äº›ç‰©ç†é˜²ç«å¢™ä¼šå…ˆå¯¹å‘é€è¿‡æ¥çš„synæŠ¥æ–‡è¿›è¡Œæ¨¡æ‹Ÿå°è¯•ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœåœ¨ä¸€å®šæ¬¡æ•°å†…æ¡æ‰‹å¤±è´¥å°±ä¼šåˆ¤æ–­ä¸ºæ¶æ„è¯·æ±‚ã€‚ä»è€Œä¸€å®šæ—¶é—´å†…æ‹’ç»è¯¥ipå‘å‡ºæ¥çš„è¯·æ±‚ã€‚çœ‹ç€è·Ÿä½ ä»¬å­¦æ ¡çš„è¡Œä¸ºæœ‰ç‚¹ç›¸ä¼¼ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629206148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2068721,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/90/f1/7f2b5e16.jpg","nickname":"CHN-Lee-ç‰ç±³","note":"","ucode":"0A53080F38F229","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377276,"discussion_content":"å¦‚æœä¸é…ï¼Œä¸‡ä¸€æœ‰ä¸€å°ä¸­æ¯’äº†ï¼Œç›´æ¥å†…ç½‘æ¼«æ¸¸äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622569847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73378,"user_name":"dancer","can_delete":false,"product_type":"c1","uid":1019036,"ip_address":"","ucode":"B8D5641A3AC490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/9c/d48473ab.jpg","comment_is_top":false,"comment_ctime":1551873513,"is_pvip":false,"replies":[{"id":"26761","content":"èµï¼Œå¾ˆé«˜å…´ä¹Ÿçœ‹åˆ°å­¦ä»¥è‡´ç”¨","user_name":"ä½œè€…å›å¤","comment_id":73378,"uid":"1001282","ip_address":"","utype":1,"ctime":1551885834,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"35911611881","product_id":100020901,"comment_content":"é‡æ–°å¼€è¿½ï¼Œå‰ä¸¤å¤©ç€é‡çœ‹äº†cpuè°ƒä¼˜ï¼Œæ­£å¥½çº¿ä¸Šå‹æµ‹å‘ç°äº†cpu.useré£™é«˜çš„é—®é¢˜ï¼Œé€šè¿‡perfå’ŒpprofæŸ¥æ˜äº†æ˜¯ä¸€ä¸ªå¤æ‚jsonç»“æ„è§£æå¯¼è‡´çš„ï¼Œå­¦ä»¥è‡´ç”¨ä¸‹æ¥å°è±¡æ›´æ·±äº†ï¼è¿™ä¸¤å¤©å¼€å§‹çœ‹ç½‘ç»œï¼Œåé¢å†çœ‹ioå’Œå†…å­˜ç›¸å…³ï¼Œæ„Ÿè°¢ï¼","like_count":8,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442052,"discussion_content":"èµï¼Œå¾ˆé«˜å…´ä¹Ÿçœ‹åˆ°å­¦ä»¥è‡´ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551885834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77105,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1552834430,"is_pvip":false,"replies":[{"id":"28161","content":"REJECTè¿˜ä¼šç»™æ”»å‡»æºå‘é€å“åº”ï¼Œè¿™ä¹Ÿæ˜¯æ¶ˆè€—ç½‘ç»œèµ„æºçš„ï¼›è€ŒDROPæ²¡æœ‰ä»»ä½•å›åº”ï¼Œç›´æ¥ä¸¢å¼ƒ","user_name":"ä½œè€…å›å¤","comment_id":77105,"uid":"1001282","ip_address":"","utype":1,"ctime":1552903793,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14437736318","product_id":100020901,"comment_content":"REJECTæ”»å‡»IPæ‰€æœ‰æŠ¥æ–‡ï¼Œæ¥å£å“åº”æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œè¿˜æ˜¯127ç§’ï¼ŒDROPæŠ¥æ–‡åå“åº”æ—¶é—´æ‰æ¢å¤æ­£å¸¸ï¼ŒæŸ¥äº†REJECTå’ŒDROPçš„åŒºåˆ«ï¼ŒREJECTä¼šè¿”å›ä¸ªICMPåŒ…ç»™æºIPï¼Œæœ‰ç‚¹ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆä¸€ä¸ªICMPåŒ…å¯¼è‡´è¿™ä¹ˆå¤§çš„å·®å¼‚ã€‚<br><br># hping3å‘½ä»¤, u10æ•ˆæœä¸æ˜æ˜¾ï¼Œæ‰€ä»¥æ”¹æˆäº†u1æµ‹è¯•<br>$ hping3 -S -p 80  172.30.81.136 -I eno1 -i u1<br><br># è°ƒæ•´å†…æ ¸å‚æ•°æµ‹è¯•ç»“æœï¼Œæ¥å£å“åº”æ—¶é—´ä¸º127ç§’<br>$ curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;172.30.81.136&#47; <br>Http code: 000<br>Total time:127.109s<br><br># è°ƒæ•´å†…æ ¸å‚æ•°ã€iptablesé™åˆ¶synå¹¶å‘çš„æµ‹è¯•ç»“æœï¼Œæ¥å£å“åº”æ—¶é—´ä¸º127ç§’<br>$ curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;172.30.81.136&#47; <br>Http code: 000<br>Total time:127.106s<br><br># è°ƒæ•´å†…æ ¸å‚æ•°ã€iptablesé™åˆ¶synå¹¶å‘ã€å•IPè¿æ¥æ•°çš„æµ‹è¯•ç»“æœï¼Œæ¥å£å“åº”æ—¶é—´ä¸º127ç§’<br>$ curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;172.30.81.136&#47; <br>Http code: 000<br>Total time:127.097s<br><br># è°ƒæ•´å†…æ ¸å‚æ•°ã€iptablesé™åˆ¶synå¹¶å‘ã€å•IPè¿æ¥æ•°ã€DROPæ”»å‡»IPæ‰€æœ‰æŠ¥æ–‡çš„æµ‹è¯•ç»“æœï¼Œæ¥å£å“åº”æ—¶é—´ä¸º127ç§’<br>$ curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;172.30.81.136&#47; <br>Http code: 200<br>Total time:0.001s","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443581,"discussion_content":"REJECTè¿˜ä¼šç»™æ”»å‡»æºå‘é€å“åº”ï¼Œè¿™ä¹Ÿæ˜¯æ¶ˆè€—ç½‘ç»œèµ„æºçš„ï¼›è€ŒDROPæ²¡æœ‰ä»»ä½•å›åº”ï¼Œç›´æ¥ä¸¢å¼ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552903793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70365,"user_name":"forever","can_delete":false,"product_type":"c1","uid":1138693,"ip_address":"","ucode":"604A91C6611997","user_header":"https://static001.geekbang.org/account/avatar/00/11/60/05/3797d774.jpg","comment_is_top":false,"comment_ctime":1551086062,"is_pvip":false,"replies":[{"id":"25356","content":"ğŸ‘è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":70365,"uid":"1001282","ip_address":"","utype":1,"ctime":1551195086,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14435987950","product_id":100020901,"comment_content":"æˆ‘ä¹‹å‰åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é‡åˆ°è¿‡å¤šæ¬¡ddosæ”»å‡»ï¼Œæœ€å¥½çš„è¢«æ‰“åˆ°55G.æœ€åˆçš„æ—¶å€™é‡åˆ°æ”»å‡»æŸæ‰‹æ— ç­–ï¼Œè¿˜è¢«äººå‹’ç´¢è¿‡ï¼Œè¯´ç»™é’±å°±ä¸æ”»å‡»ï¼å“ˆå“ˆğŸ˜„å› ä¸ºæ²¡ç»éªŒï¼Œåæ¥å°±æ‰“æ¸¸å‡»æˆ˜ï¼Œé‚£æ—¶å€™æ”»å‡»çš„æ˜¯æˆ‘ä»¬è´Ÿè½½å‡è¡¡çš„ipï¼Œå½“æ”»å‡»å‘ç”Ÿæ—¶æˆ‘å°±æ¢ipè¿™æ ·èƒ½æš‚æ—¶ç¼“è§£ï¼Œå½“ç„¶æå‰è¦æŠŠipç»™å‡†å¤‡å¥½ï¼Œæ¯”å¦‚ç™½åå•æ·»åŠ ç­‰ï¼åæ¥ä¸šåŠ¡å£®å¤§ï¼Œæ¢ipçš„æ—¶é—´æˆæœ¬æ¯”ç½‘ç«™ä¸èƒ½è®¿é—®çš„æˆæœ¬è¦é«˜ï¼Œæœ€åæˆ‘ä»¬ç”¨äº†é˜¿é‡Œäº‘çš„é«˜é˜²ï¼Œå°±è¿™æ ·æ”»å‡»å°±å‘Šä¸€æ®µè½äº†ï¼è™½ç„¶é«˜é˜²å¾ˆè´µï¼Œä½†æ˜¯æ¯”èµ·è¢«æ”»å‡»çš„æŸå¤±ï¼Œè¿˜æ˜¯å€¼å¾—çš„ï¼","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440587,"discussion_content":"ğŸ‘è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551195086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":251473,"user_name":"Wen","can_delete":false,"product_type":"c1","uid":1367387,"ip_address":"","ucode":"892CB242BA9C04","user_header":"https://static001.geekbang.org/account/avatar/00/14/dd/5b/5461afad.jpg","comment_is_top":false,"comment_ctime":1601601689,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10191536281","product_id":100020901,"comment_content":"DDoSç®€ä»‹<br>DDoSï¼ˆDistributiedï¼‰çš„å‰èº«æ˜¯DoSï¼ˆDenail of Serviceï¼‰ï¼Œå³æ‹’ç»æœåŠ¡æ”»å‡»ï¼ŒæŒ‡åˆ©ç”¨å¤§é‡çš„åˆç†è¯·æ±‚ï¼Œæ¥å ç”¨è¿‡å¤šçš„ç›®æ ‡èµ„æºï¼Œä»è€Œä½¿ç›®æ ‡æœåŠ¡æ— æ³•å“åº”æ­£å¸¸çš„è¯·æ±‚ã€‚<br>DDosåœ¨Dosçš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨äº†åˆ†å¸ƒå¼æ¶æ„ï¼Œåˆ©ç”¨å¤šå°ä¸»æœºåŒæ—¶æ”»å‡»ç›®æ ‡ä¸»æœºã€‚<br>DDoSæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼š<br>aã€è€—å°½å®½å¸¦ã€‚<br>bã€æ¶ˆè€—æ“ä½œç³»ç»Ÿçš„èµ„æºã€‚<br>cã€æ¶ˆè€—åº”ç”¨ç¨‹åºçš„è¿è¡Œèµ„æºã€‚<br><br>DoSå®éªŒæ¨¡æ‹Ÿï¼š<br>VM1ç»ˆç«¯ä¸€ï¼šå¼€å¯webæœåŠ¡<br> docker run -itd --name=nginx --network=host nginx<br>VM2ç»ˆç«¯ä¸€ï¼šå¯¹æ¯”è¢«æ”»å‡»å‰åçš„webè®¿é—®æ—¶é—´ï¼š<br>curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;10.10.10.2&#47;<br>VM2ç»ˆç«¯äºŒï¼šæ¨¡æ‹ŸDosæ”»å‡»<br>hping3 -S -p 80 -i U10 --flood 10.10.10.2<br>VM1ç»ˆç«¯äºŒï¼šæŸ¥çœ‹ç½‘ç»œæ¥æ”¶åŒ…æƒ…å†µ<br>sar -n DEV 1<br>VM1ç»ˆç«¯ä¸‰ï¼štcpdumpæŠ“åŒ…<br>tcpdump -i eth0 -n tcp port 80<br>VM1ç»ˆç«¯4ï¼šç»Ÿè®¡SYN_RECè¿æ¥æ•°<br>netstat -n -p | grep SYN_REC | wc -l<br><br><br>è§£å†³Dosæ”»å‡»ï¼š<br>é˜²ç«å¢™æ–¹æ³•1ï¼šæ‹’ç»æºipè®¿é—®<br>iptables -I INPUT -s 10.10.10.4 -p tcp -j REJECT<br>é˜²ç«å¢™æ–¹æ³•2ï¼šé™åˆ¶ syn åŒ…çš„é€Ÿç‡<br># é™åˆ¶synå¹¶å‘æ•°ä¸ºæ¯ç§’1æ¬¡<br>$ iptables -A INPUT -p tcp --syn -m limit --limit 1&#47;s -j ACCEPT<br># é™åˆ¶å•ä¸ªIPåœ¨60ç§’æ–°å»ºç«‹çš„è¿æ¥æ•°ä¸º10<br>$ iptables -I INPUT -p tcp --dport 80 --syn -m recent --name SYN_FLOOD --update --seconds 60 --hitcount 10 -j REJECT<br>ä¼˜åŒ–ç³»ç»Ÿå†…æ ¸TCPå‚æ•°<br>æ–¹æ³•1ï¼šå¢å¤§synè¿æ¥æ•°<br>$ sysctl net.ipv4.tcp_max_syn_backlog<br>net.ipv4.tcp_max_syn_backlog = 256<br>$ sysctl -w net.ipv4.tcp_max_syn_backlog=1024<br>net.ipv4.tcp_max_syn_backlog = 1024<br>æ–¹æ³•2ï¼šå‡å°‘SYN_REVCé‡è¯•æ¬¡æ•°ä¸º1ï¼Œé»˜è®¤æ˜¯5<br>$ sysctl -w net.ipv4.tcp_synack_retries=1<br>net.ipv4.tcp_synack_retries = 1<br>æ–¹æ³•3ï¼šå¼€å¯TCP SYN Cookies<br>æ³¨æ„ï¼šå¼€å¯ TCP syncookies åï¼Œå†…æ ¸é€‰é¡¹ net.ipv4.tcp_max_syn_backlog ä¹Ÿå°±æ— æ•ˆäº†ã€‚<br>$ sysctl -w net.ipv4.tcp_syncookies=1<br>net.ipv4.tcp_syncookies = 1<br><br>æ°¸ä¹…ç”Ÿæ•ˆæ–¹å¼ï¼šå†™å…¥ &#47;etc&#47;sysctl.conf æ–‡ä»¶ä¸­ï¼š<br>$ cat &#47;etc&#47;sysctl.conf<br>net.ipv4.tcp_syncookies = 1<br>net.ipv4.tcp_synack_retries = 1<br>net.ipv4.tcp_max_syn_backlog = 1024<br> sysctl -p<br><br><br><br><br>","like_count":3},{"had_liked":false,"id":84968,"user_name":"å¤§åç‹ç‹¸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1554950347,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10144884939","product_id":100020901,"comment_content":"1 å¢å¤§é˜Ÿåˆ—SYNæœ€å¤§åŠè¿æ¥æ•°sysctl -w et.ipv4.tcp_max_syn_backlog=3000<br>2 å‡å°‘è¶…æ—¶å€¼ï¼šé€šè¿‡å‡å°‘è¶…æ—¶é‡ä¼ æ¬¡æ•°ï¼Œsysctl -w net.ipv4.tcp_synack_retries=1<br>3 SYN_COOKIE : å¼€å¯cookie echo &quot;1&quot; &gt; &#47; proc&#47;sys&#47;net&#47;ipv4&#47;tcp_syncookies ï¼ˆåŸæœ¬å¯¹cookieæœ‰è¯¯è§£ï¼Œçœ‹äº†æœ¬æ–‡æ‰æ¸…æ¥šï¼Œè°¢è°¢è€å¸ˆï¼‰<br>4 è¿‡æ»¤å¯ç–‘IPåœ°å€:  iptables -I INPUT -s 192.168.0.2 -p tcp -j REJECT  ç¦æ­¢ 0.2è®¿é—®<br>","like_count":2},{"had_liked":false,"id":83969,"user_name":"z.l","can_delete":false,"product_type":"c1","uid":1181055,"ip_address":"","ucode":"805CC5784D3F76","user_header":"https://static001.geekbang.org/account/avatar/00/12/05/7f/d35ab9a1.jpg","comment_is_top":false,"comment_ctime":1554740617,"is_pvip":false,"replies":[{"id":"30374","content":"å—¯ æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":83969,"uid":"1001282","ip_address":"","utype":1,"ctime":1554815156,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10144675209","product_id":100020901,"comment_content":"è¯·é—®è€å¸ˆä»Šå¤©è®²çš„ä¸‰ä¸ªtcpå†…æ ¸å‚æ•°è°ƒä¼˜èƒ½å¦ä½œä¸ºé€šç”¨çš„æé«˜æœåŠ¡å™¨æŠ—å¹¶å‘èƒ½åŠ›çš„ä¼˜åŒ–æ‰‹æ®µï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446195,"discussion_content":"å—¯ æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554815156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71615,"user_name":"Christmas","can_delete":false,"product_type":"c1","uid":1219172,"ip_address":"","ucode":"F48F6BE4A7595B","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/64/ad837224.jpg","comment_is_top":false,"comment_ctime":1551401292,"is_pvip":false,"replies":[{"id":"26304","content":"è¯·å‚è€ƒ syn cookie å’Œ netstat çš„æ–‡æ¡£ï¼Œè¿™äº›é…ç½®å’Œå­—æ®µçš„å«ä¹‰éƒ½æœ‰æ˜ç¡®çš„è¯´æ˜","user_name":"ä½œè€…å›å¤","comment_id":71615,"uid":"1001282","ip_address":"","utype":1,"ctime":1551703165,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10141335884","product_id":100020901,"comment_content":"Sysc backlogå¹¶ä¸æ˜¯åœ¨é…ç½®äº†sync cookieä¹‹åå°±å¤±æ•ˆäº†å§ï¼Œnetstat -s çœ‹åˆ°çš„listençŠ¶æ€çš„recv å’Œsendä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºè¿æ¥é˜Ÿåˆ—é…ç½®å’Œå½“å‰æ´»è·ƒé˜Ÿåˆ—é•¿åº¦å—ï¼Œæ¯”å¦‚ç›‘å¬æŸä¸ªç«¯å£çš„è¿›ç¨‹ä¸å“åº”äº†ï¼Œé‚£ä¹ˆè¿™é‡Œçš„recvé˜Ÿåˆ—å°±ä¼šæ…¢æ…¢å˜é•¿ç„¶åæº¢å‡ºã€‚æº¢å‡ºä¹‹åï¼Œlinuxå¯ä»¥é€‰æ‹©dropæ‰ä»€ä¹ˆä¹Ÿä¸åšï¼Œæˆ–è€…è¿”å›connection reseté€šçŸ¥å®¢æˆ·ç«¯","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441234,"discussion_content":"è¯·å‚è€ƒ syn cookie å’Œ netstat çš„æ–‡æ¡£ï¼Œè¿™äº›é…ç½®å’Œå­—æ®µçš„å«ä¹‰éƒ½æœ‰æ˜ç¡®çš„è¯´æ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551703165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68968,"user_name":"ä¸”å¬é£åŸ","can_delete":false,"product_type":"c1","uid":1024045,"ip_address":"","ucode":"BB49580519D117","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/2d/2fee2d83.jpg","comment_is_top":false,"comment_ctime":1550635312,"is_pvip":false,"replies":[{"id":"24530","content":"å—¯ï¼Œåé¢æœ‰çš„","user_name":"ä½œè€…å›å¤","comment_id":68968,"uid":"1001282","ip_address":"","utype":1,"ctime":1550674656,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10140569904","product_id":100020901,"comment_content":"net.ipv4.tcp_max_tw_buckets <br>net.ipv4.tcp_tw_reuse <br>net.ipv4.tcp_tw_recycle<br>net.ipv4.tcp_keepalive_time <br>net.ipv4.tcp_timestamps<br>æœŸå¾…ç»“åˆç”Ÿäº§ç¯å¢ƒå¯¹è¿™å‡ ä¸ªå†…æ ¸å‚æ•°çš„è®²è§£ã€‚ç›®å‰ç”Ÿäº§ç¯å¢ƒä¸‹phpæœåŠ¡å™¨time_waitç‰¹åˆ«å¤šï¼Œç½‘ç»œåŒ…çš„æµç¨‹ï¼š  NGINXä»£ç†&lt;â€”â€”&gt;PHPæœåŠ¡å™¨â€”â€”&gt;redis&#47;mysql.. <br>é«˜å³°æ—¶æœŸphpæœåŠ¡å™¨ä¸€å…±50k+çš„è¿æ¥ã€‚49k+çš„time_wait.ï¼Œ ä¸»è¦æ¥æºæ˜¯phpä½œä¸ºå®¢æˆ·ç«¯çš„è§’è‰²æ—¶è¿æ¥redisã€mysqlã€ç»™ä»£ç†NGINXå›åŒ…ã€phpæœåŠ¡å™¨å†…éƒ¨è°ƒç”¨ã€‚å¸Œæœ›è€å¸ˆèƒ½ç»™è§£å†³é—®é¢˜çš„æ€è·¯ã€‚<br>","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439894,"discussion_content":"å—¯ï¼Œåé¢æœ‰çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550674656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70213,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1551053773,"is_pvip":false,"replies":[{"id":"25349","content":"æ˜¯çš„ï¼Œæµé‡å‹DDoSè¿˜æ˜¯è¦é ç¡¬ä»¶æ¥æŠ—","user_name":"ä½œè€…å›å¤","comment_id":70213,"uid":"1001282","ip_address":"","utype":1,"ctime":1551194764,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5846021069","product_id":100020901,"comment_content":"æ‰“å¡day42<br>çœŸæ­£çš„ddosè¦é è¿è¥å•†çš„æµé‡æ¸…æ´—ä¹‹ç±»çš„äº†","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440495,"discussion_content":"æ˜¯çš„ï¼Œæµé‡å‹DDoSè¿˜æ˜¯è¦é ç¡¬ä»¶æ¥æŠ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551194764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69359,"user_name":"å®‰å°ä¾","can_delete":false,"product_type":"c1","uid":1101660,"ip_address":"","ucode":"A5C414C7B994FF","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/5c/d4e19eb6.jpg","comment_is_top":false,"comment_ctime":1550724937,"is_pvip":false,"replies":[{"id":"24844","content":"æ€»çš„æµé‡å¤§å°ä¸åŒï¼Œæ¯”å¦‚å•æœºå†æ€ä¹ˆéšæœºåŒ–æ€»æ˜¯å—é™äºç½‘ç»œå¸¦å®½ï¼Œè€Œå¤šæœºç»„åˆäº§ç”Ÿçš„æµé‡å°±è¦å¤§å¾—å¤šäº†","user_name":"ä½œè€…å›å¤","comment_id":69359,"uid":"1001282","ip_address":"","utype":1,"ctime":1550849929,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5845692233","product_id":100020901,"comment_content":"éšæœºåŒ–æº IP å’Œ å¤šå°æœºå™¨åˆ†å¸ƒå¼æ”»å‡» æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆé™åˆ¶ syn åŒ…é€Ÿç‡çš„æ–¹å¼ä¸é€‚ç”¨äºå¤šå°æœºå™¨åˆ†å¸ƒå¼çš„","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440080,"discussion_content":"æ€»çš„æµé‡å¤§å°ä¸åŒï¼Œæ¯”å¦‚å•æœºå†æ€ä¹ˆéšæœºåŒ–æ€»æ˜¯å—é™äºç½‘ç»œå¸¦å®½ï¼Œè€Œå¤šæœºç»„åˆäº§ç”Ÿçš„æµé‡å°±è¦å¤§å¾—å¤šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550849929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350244,"user_name":"spike","can_delete":false,"product_type":"c1","uid":1629867,"ip_address":"","ucode":"3FFEA6D2583561","user_header":"https://static001.geekbang.org/account/avatar/00/18/de/ab/e87f0e5e.jpg","comment_is_top":false,"comment_ctime":1656688414,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656688414","product_id":100020901,"comment_content":"ç”¨äº†hping3 -S -p 80 -i u1 192.168.0.30æŠŠå…¬å¸å†…ç½‘æ‰“ç‚¸äº†ã€‚ã€‚ã€‚æ„Ÿè°¢è€å¸ˆã€‚ã€‚è®¤è¯†åˆ°äº†synæ³›æ´ªçš„å¨åŠ›ã€‚ã€‚","like_count":1},{"had_liked":false,"id":346901,"user_name":"Shuai","can_delete":false,"product_type":"c1","uid":1642766,"ip_address":"","ucode":"BE705668C66225","user_header":"https://static001.geekbang.org/account/avatar/00/19/11/0e/23d6a88f.jpg","comment_is_top":false,"comment_ctime":1653529105,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653529105","product_id":100020901,"comment_content":"åˆ°æœåŠ¡å™¨çš„ç½‘ç»œå¦‚æœæ¯”å–»æˆè½¦é“çš„è¯ï¼Œæ„Ÿè§‰dosæ”»å‡»åƒæ˜¯æ¶æ„é˜»å¡è½¦é“çš„è½¦è¾†ï¼Œè€—å°½å¸¦å®½ã€è€—å°½æ“ä½œç³»ç»Ÿçš„èµ„æºã€æ¶ˆè€—åº”ç”¨ç¨‹åºçš„è¿è¡Œèµ„æºåˆ†åˆ«ç›¸å½“äºä¸»è½¦é“è¢«é˜»å¡ã€æœåŠ¡å™¨å®¶é™„è¿‘çš„è·¯è¢«é˜»å¡ã€æœåŠ¡å™¨å®¶é—¨å£çš„åœè½¦åœºè¢«é˜»å¡ï¼Œå¯¼è‡´çœŸæ­£å±äºæœåŠ¡å™¨çš„è½¦å¼€ä¸åˆ°å®¶é—¨å£ï¼›<br>äºæ˜¯é˜²æ²»ç­–ç•¥ä¸€ä¸ªæ˜¯ å®¶é—¨å£çš„åœè½¦åœºåŠ ä¸Šç®¡æ§ï¼Œå®¶é—¨å£é™„è¿‘çš„è·¯åŠ ä¸Šç®¡æ§ï¼Œåœ¨ä¸»å¹²é“ä¹‹å‰åŠ ä¸ŠWAFã€CDNç­‰æµé‡ç®¡æ§ï¼Œè®©æ¶æ„çš„è½¦è¾†è¿›å…¥ä¸»å¹²é“ä¹‹å‰å°±è¢«è¿‡æ»¤æ‰ã€‚","like_count":1},{"had_liked":false,"id":307924,"user_name":"é™ˆéº’æ–‡","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1629328657,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629328657","product_id":100020901,"comment_content":"åšæŒçœ‹åˆ°è¿™ï¼Œè„‘è¢‹ç“œæœ‰ä¸ªæ˜ åƒï¼Œå¤šä¸ªæ€è€ƒçš„æ–¹å‘","like_count":0},{"had_liked":false,"id":305508,"user_name":"ghostwritten","can_delete":false,"product_type":"c1","uid":1308196,"ip_address":"","ucode":"AE512F2E24A1A0","user_header":"https://static001.geekbang.org/account/avatar/00/13/f6/24/5a9277f1.jpg","comment_is_top":false,"comment_ctime":1628003210,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628003210","product_id":100020901,"comment_content":"1. DDoS ç±»å‹:è€—å°½å¸¦å®½ã€è€—å°½æ“ä½œç³»ç»Ÿçš„èµ„æºã€æ¶ˆè€—åº”ç”¨ç¨‹åºçš„è¿è¡Œèµ„æº<br>2. curl -s -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null http:&#47;&#47;192.168.0.30&#47;<br>curl -w &#39;Http code: %{http_code}\\nTotal time:%{time_total}s\\n&#39; -o &#47;dev&#47;null --connect-timeout 10 http:&#47;&#47;192.168.0.30<br>3. hping3 -S -p 80 -i u10 192.168.0.30<br>4. sar -n DEV 1<br>5. tcpdump -i eth0 -n tcp port 80<br>6. netstat -n -p | grep SYN_REC<br>7. iptables -I INPUT -s 192.168.0.2 -p tcp -j REJECT<br>8. iptables -A INPUT -p tcp --syn -m limit --limit 1&#47;s -j ACCEPT<br>9. iptables -I INPUT -p tcp --dport 80 --syn -m recent --name SYN_FLOOD --update --seconds 60 --hitcount 10 -j REJECT<br>10. sysctl net.ipv4.tcp_max_syn_backlog<br>sysctl -w net.ipv4.tcp_max_syn_backlog=1024<br>sysctl -w net.ipv4.tcp_synack_retries=1<br>sysctl -w net.ipv4.tcp_syncookies=1","like_count":0},{"had_liked":false,"id":287990,"user_name":"glimmer","can_delete":false,"product_type":"c1","uid":2110718,"ip_address":"","ucode":"48A16C52FB4C45","user_header":"https://static001.geekbang.org/account/avatar/00/20/34/fe/e5429b02.jpg","comment_is_top":false,"comment_ctime":1618241890,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618241890","product_id":100020901,"comment_content":"nginx backlogé»˜è®¤ä¸º512","like_count":0},{"had_liked":false,"id":271303,"user_name":"Geek_77a14f","can_delete":false,"product_type":"c1","uid":2116919,"ip_address":"","ucode":"EB71258E219A6D","user_header":"","comment_is_top":false,"comment_ctime":1609523362,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1609523362","product_id":100020901,"comment_content":" net.ipv4.tcp_synack_retries <br>è¡¨ç¤ºåº”ç”¨ç¨‹åºè¿›è¡Œconnect()ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œåœ¨å¯¹æ–¹ä¸è¿”å›SYN + ACKçš„æƒ…å†µä¸‹(ä¹Ÿå°±æ˜¯è¶…æ—¶çš„æƒ…å†µä¸‹)ï¼Œç¬¬ä¸€æ¬¡å‘é€ä¹‹åï¼Œå†…æ ¸æœ€å¤šé‡è¯•å‡ æ¬¡å‘é€SYNåŒ…;å¹¶ä¸”å†³å®šäº†ç­‰å¾…æ—¶é—´. è¿™ä¸ªæ˜¯é’ˆå¯¹tcpå®¢æˆ·ç«¯çš„ï¼Œé‚£å¯¹tcpæœåŠ¡é˜²æ­¢DDOSæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæ„Ÿè§‰æ²¡æœ‰è”ç³»ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662117,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7zuDYFIutbSPc4eEtcMhdNBTI1FRR7q0xrGh2X1QdiaNxvAV31HcRUsjPWLaaWftqgwTnVoiaica8Nw/132","nickname":"èƒœè¾‰ï¼ˆå¤§Vï¼‰","note":"","ucode":"3C13BFCD82D4EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399825,"discussion_content":"ä¼šå¢åŠ æœåŠ¡ç«¯å†…æ ¸å¼€é”€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633075647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252263,"user_name":"just do","can_delete":false,"product_type":"c1","uid":1516890,"ip_address":"","ucode":"6DECC3894F0519","user_header":"https://static001.geekbang.org/account/avatar/00/17/25/5a/c5771aa7.jpg","comment_is_top":false,"comment_ctime":1602217542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602217542","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œé˜²ç«å¢™å¯¹ipåšäº†é™åˆ¶åï¼Œè¯¥ipç”¨hping3å·¥å…·å‘èµ·å¤§é‡è¯·æ±‚ï¼Œæ­¤æ—¶ä¼šå‘é€å¤§é‡synåŒ…å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":234920,"user_name":"xiexy","can_delete":false,"product_type":"c1","uid":1834868,"ip_address":"","ucode":"2C0053A677C91F","user_header":"https://static001.geekbang.org/account/avatar/00/1b/ff/74/52261bc3.jpg","comment_is_top":false,"comment_ctime":1594825959,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1594825959","product_id":100020901,"comment_content":"SYNé˜Ÿåˆ—æ˜¯ç³»ç»Ÿå…¨å±€çš„ï¼Œè¿˜æ˜¯æ¯ä¸ªlistenç«¯å£æœ‰è‡ªå·±çš„SYNé˜Ÿåˆ—ï¼Ÿä¸ºä»€ä¹ˆè¯´â€œSYN åŒ…æ•°å†ç¨å¾®å¢å¤§ä¸€äº›ï¼Œå°±ä¸èƒ½ SSH ç™»å½•æœºå™¨äº†â€ï¼ŸSYN Floodåº”è¯¥åªæ˜¯æ”»å‡»ç›®æ ‡ç«¯å£å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2118161,"avatar":"https://static001.geekbang.org/account/avatar/00/20/52/11/af170b65.jpg","nickname":"éª‘é©´æ‰¾ä½ ","note":"","ucode":"FB9E7511C00BEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308503,"discussion_content":"å¯ä»¥å‚è€ƒä¸‹è¿™ä¸ªè§£ç­”ï¼š\nhttps://sites.google.com/site/beingroot/articles/apache/socket-backlog-tuning-for-apache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600963573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219212,"user_name":"younglinuxer","can_delete":false,"product_type":"c1","uid":1590541,"ip_address":"","ucode":"26CD19A86E19F2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJqGQOsBPCV7QvWFvGS19h6EQ17HyaJKFyHSStbbJrToRyHtbvc1EupHpafXuBicq5BiaicJFmK17wfg/132","comment_is_top":false,"comment_ctime":1589966966,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1589966966","product_id":100020901,"comment_content":"æœ€å¥½çš„åŠæ³•å°±æ˜¯é™é€Ÿ Nginxæ”¯æŒè®¿é—®é™åˆ¶ iptableså¯ä»¥è®¾ç½®æ¯ä¸ªIPè®¿é—®çš„é¢‘ç‡  æ•ˆæœæŒºå¥½çš„ å½“ä½ å‘ç°æŸä¸ªç«¯å£è¿æ¥ä¸æ­£å¸¸æ—¶ æŠ“ä¸‹åŒ…æŒºæœ‰ç”¨çš„","like_count":0,"discussions":[{"author":{"id":1662117,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7zuDYFIutbSPc4eEtcMhdNBTI1FRR7q0xrGh2X1QdiaNxvAV31HcRUsjPWLaaWftqgwTnVoiaica8Nw/132","nickname":"èƒœè¾‰ï¼ˆå¤§Vï¼‰","note":"","ucode":"3C13BFCD82D4EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399826,"discussion_content":"å¯¹äºæµé‡å‹ï¼ˆipå±‚ï¼‰å’ŒåŒ…é‡å‹ï¼ˆä¼ è¾“å±‚ï¼‰æ”»å‡»å°±æ— æ•ˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633075859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142164,"user_name":"Geek_ea21df","can_delete":false,"product_type":"c1","uid":1316537,"ip_address":"","ucode":"1FCCD97587DB97","user_header":"https://static001.geekbang.org/account/avatar/00/14/16/b9/a8a7a6af.jpg","comment_is_top":false,"comment_ctime":1571302631,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1571302631","product_id":100020901,"comment_content":"è€å¸ˆï¼Œå’¨è¯¢ä¸ªé—®é¢˜ï¼Œå½“åŠè¿æ¥é˜Ÿåˆ—è¢«å æ»¡åï¼Œå®¢æˆ·ç«¯ç»§ç»­å‘synï¼Œè¿™æ—¶æœåŠ¡å™¨ç«¯è¿˜ä¼šè¿”å›syn+ackå—ï¼Ÿç”±äºæ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯è¿”å›çš„ackï¼ŒåŠè¿æ¥é˜Ÿåˆ—é‡Œé¢çš„è¿æ¥ä¼šè¢«è¸¢å‡ºå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372131,"discussion_content":"1ï½¤ä¼šé‡è¯•2ä¼šè¶…æ—¶","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1620205121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141053,"user_name":"è¾‰æ™–","can_delete":false,"product_type":"c1","uid":1574062,"ip_address":"","ucode":"E5EC033EE4952B","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/ae/0118c132.jpg","comment_is_top":false,"comment_ctime":1571107468,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571107468","product_id":100020901,"comment_content":"--rand-source<br>ç”¨tcpdumpæŠ“åŒ…çœ‹åˆ°çš„è¿˜æ˜¯åŒæ ·çš„IPå‘€ï¼Œæ²¡æœ‰å‡ºç°éšæœº","like_count":0},{"had_liked":false,"id":137925,"user_name":"ä¹–ï¼Œæ‘¸æ‘¸å¤´","can_delete":false,"product_type":"c1","uid":1611745,"ip_address":"","ucode":"BD92741A11D3CD","user_header":"https://static001.geekbang.org/account/avatar/00/18/97/e1/0f4d90ff.jpg","comment_is_top":false,"comment_ctime":1569921744,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1569921744","product_id":100020901,"comment_content":"<br>æŠ“åŒ…è¢«æ”»å‡»ä¸»æœº<br>17:15:09.834282 IP 172.17.0.17.http &gt; 39.105.27.73.25213: Flags [S.], seq 3104982810, ack 1682132320, win 64240, options [mss 1460], length 0<br>17:15:09.834577 IP 39.105.27.73.25180 &gt; 172.17.0.17.http: Flags [R], seq 1552097248, win 0, length 0<br>17:15:09.835241 IP 39.105.27.73.25219 &gt; 172.17.0.17.http: Flags [S], seq 1495946800, win 512, length 0<br>17:15:09.835258 IP 172.17.0.17.http &gt; 39.105.27.73.25219: Flags [S.], seq 4115155724, ack 1495946801, win 64240, options [mss 1460], length 0<br>17:15:09.835319 IP 39.105.27.73.25215 &gt; 172.17.0.17.http: Flags [S], seq 472764723, win 512, length 0<br>17:15:09.835333 IP 172.17.0.17.http &gt; 39.105.27.73.25215: Flags [S.], seq 3536954741, ack 472764724, win 64240, options [mss 1460], length 0<br>17:15:09.837205 IP 39.105.27.73.25190 &gt; 172.17.0.17.http: Flags [R], seq 1357800982, win 0, length 0<br><br>æŠ“åŒ…å‘èµ·æ”»å‡»çš„ä¸»æœº å¥½å¤šå‘èµ·å¾—æ˜¯[R]<br>æŠ“åŒ…å‘èµ·æ”»å‡»çš„ä¸»æœº<br><br>17:17:36.904992 IP 172.17.115.106.5941 &gt; 49.234.232.49.http: Flags [S], seq 399367614, win 512, length 0<br>17:17:36.906033 IP 172.17.115.106.5942 &gt; 49.234.232.49.http: Flags [S], seq 591134454, win 512, length 0<br>17:17:36.907112 IP 172.17.115.106.5943 &gt; 49.234.232.49.http: Flags [S], seq 1780793513, win 512, length 0<br>17:17:36.908170 IP 172.17.115.106.5944 &gt; 49.234.232.49.http: Flags [S], seq 1999407364, win 512, length 0<br>17:17:36.908471 IP 49.234.232.49.http &gt; 172.17.115.106.5914: Flags [S.], seq 3104468759, ack 1898840089, win 64240, options [mss 1424], length 0<br>17:17:36.908485 IP 172.17.115.106.5914 &gt; 49.234.232.49.http: Flags [R], seq 1898840089, win 0, length 0<br><br>æˆ‘è¿™ä¸ªå¥½å¤šéƒ½æ˜¯å‘èµ·çš„[R]æ”»å‡» ","like_count":0},{"had_liked":false,"id":102036,"user_name":"å³°å›","can_delete":false,"product_type":"c1","uid":1173558,"ip_address":"","ucode":"4DB385E93749A7","user_header":"https://static001.geekbang.org/account/avatar/00/11/e8/36/5b018040.jpg","comment_is_top":false,"comment_ctime":1560124370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560124370","product_id":100020901,"comment_content":"æ‚¨å¥½ï¼Œè¯·é—®ç³»ç»Ÿclosedé£™é«˜ï¼Œå ç”¨å¤§é‡å¥æŸ„çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Œæœ‰è§£å†³æ–¹æ¡ˆä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":85393,"user_name":"zshanjun","can_delete":false,"product_type":"c1","uid":1182120,"ip_address":"","ucode":"0C99216D6FBDB8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oCx7GX9P4w5cml1cpbFD1x21Biad3MLCTOhTPJvicRW3xp9C8xTgdiaOSdpFyvibKSfcD1LL4miaT7VtqqKms6rgujg/132","comment_is_top":false,"comment_ctime":1555051289,"is_pvip":true,"replies":[{"id":"30631","content":"çœ‹èµ·æ¥åƒæ˜¯è¢«æ”»å‡»ä¸»æœºé…ç½®äº†é˜²DoSç­–ç•¥","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1555074468,"ip_address":"","comment_id":85393,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1555051289","product_id":100020901,"comment_content":"æˆ‘è¿™é‡Œdosæ”»å‡»æ²¡æœ‰ä»€ä¹ˆæ•ˆæœï¼Œæˆ‘æŸ¥çœ‹äº†ä¸€ä¸‹è¢«æ”»å‡»ä¸»æœºçš„tcpè¿æ¥çŠ¶æ€å‘ç°æ ¹æœ¬å°±æ²¡æœ‰å¤šå°‘SYN_RECçš„çŠ¶æ€ã€‚<br>ç„¶åé€šè¿‡æŠ“åŒ…å‘ç°ï¼Œæ˜¯æ”»å‡»ä¸»æœºä¸»åŠ¨å‘äº†ã€Rã€‘ï¼Œå¯¼è‡´è¢«æ”»å‡»ä¸»æœºçš„tcpçš„SYN_RECæ²¡æœ‰å †ç§¯èµ·æ¥ï¼š<br>06:38:15.452913 IP 192.168.38.4.15651 &gt; 192.168.38.5.80: Flags [S], seq 1206198085, win 512, length 0<br>06:38:15.452930 IP 192.168.38.5.80 &gt; 192.168.38.4.15651: Flags [S.], seq 1729577211, ack 1206198086, win 29200, options [mss 1460], length 0<br>06:38:15.453009 IP 192.168.38.4.15652 &gt; 192.168.38.5.80: Flags [S], seq 1185838297, win 512, length 0<br>06:38:15.453033 IP 192.168.38.5.80 &gt; 192.168.38.4.15652: Flags [S.], seq 1389286866, ack 1185838298, win 29200, options [mss 1460], length 0<br>06:38:15.453132 IP 192.168.38.4.15651 &gt; 192.168.38.5.80: Flags [R], seq 1206198086, win 0, length 0<br>06:38:15.453141 IP 192.168.38.4.15652 &gt; 192.168.38.5.80: Flags [R], seq 1185838298, win 0, length 0<br>06:38:15.453384 IP 192.168.38.4.15653 &gt; 192.168.38.5.80: Flags [S], seq 1851454908, win 512, length 0<br>06:38:15.453406 IP 192.168.38.5.80 &gt; 192.168.38.4.15653: Flags [S.], seq 128486955, ack 1851454909, win 29200, options [mss 1460], length 0<br>06:38:15.453479 IP 192.168.38.4.15653 &gt; 192.168.38.5.80: Flags [R], seq 1851454909, win 0, length 0<br>06:38:15.453719 IP 192.168.38.4.15654 &gt; 192.168.38.5.80: Flags [S], seq 700664781, win 512, length 0<br>06:38:15.453743 IP 192.168.38.5.80 &gt; 192.168.38.4.15654: Flags [S.], seq 3877145682, ack 700664782, win 29200, options [mss 1460], length 0<br>06:38:15.454017 IP 192.168.38.4.15654 &gt; 192.168.38.5.80: Flags [R], seq 700664782, win 0, length 0<br>06:38:15.454961 IP 192.168.38.4.15655 &gt; 192.168.38.5.80: Flags [S], seq 1751493720, win 512, length 0<br>06:38:15.454993 IP 192.168.38.5.80 &gt; 192.168.38.4.15655: Flags [S.], seq 1257904630, ack 1751493721, win 29200, options [mss 1460], length 0<br><br>è¯·é—®è¿™ç§æƒ…å†µæ˜¯hping3å·¥å…·çš„é—®é¢˜å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446656,"discussion_content":"çœ‹èµ·æ¥åƒæ˜¯è¢«æ”»å‡»ä¸»æœºé…ç½®äº†é˜²DoSç­–ç•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555074468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82672,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1554273713,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554273713","product_id":100020901,"comment_content":"DAY39ï¼Œæ‰“å¡","like_count":0},{"had_liked":false,"id":79179,"user_name":"Maxwell","can_delete":false,"product_type":"c1","uid":1086275,"ip_address":"","ucode":"720A00AD472616","user_header":"https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg","comment_is_top":false,"comment_ctime":1553396149,"is_pvip":false,"replies":[{"id":"29057","content":"çœ‹è¯·æ±‚é‡äº†ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ä¹Ÿç®—çš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553526874,"ip_address":"","comment_id":79179,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553396149","product_id":100020901,"comment_content":"å‹æµ‹è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å‘æœåŠ¡å™¨æ–½å‹ï¼Œä¹Ÿç®—æ˜¯DDOSæ”»å‡»å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444385,"discussion_content":"çœ‹è¯·æ±‚é‡äº†ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ä¹Ÿç®—çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553526874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75710,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1552453958,"is_pvip":true,"replies":[{"id":"28045","content":"åªå¯¹SYN Floodæœ‰æ•ˆï¼Œä½†å¾ˆå¤šé’ˆå¯¹åº”ç”¨å±‚çš„DoSåº”è¯¥è¿˜æ˜¯æ— æ•ˆçš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552749070,"ip_address":"","comment_id":75710,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552453958","product_id":100020901,"comment_content":"è€å¸ˆï¼Œå¦‚æœæŠŠtcp æ”¹ä¸ºsctp åè®®ï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä¼šå†å‘ç”ŸDDos æ”»å‡»äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442995,"discussion_content":"åªå¯¹SYN Floodæœ‰æ•ˆï¼Œä½†å¾ˆå¤šé’ˆå¯¹åº”ç”¨å±‚çš„DoSåº”è¯¥è¿˜æ˜¯æ— æ•ˆçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552749070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74294,"user_name":"Brownç¾Šç¾Š","can_delete":false,"product_type":"c1","uid":1315332,"ip_address":"","ucode":"354EC478E57DEE","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/04/5837b21c.jpg","comment_is_top":false,"comment_ctime":1552182990,"is_pvip":false,"replies":[{"id":"27332","content":"å—¯å—¯ï¼Œå¯¹æµé‡å‹æ— æ•ˆï¼›ä½†æ˜¯å¯ä»¥ç¼“è§£é’ˆå¯¹ä¸šåŠ¡çš„æ”»å‡»ï¼ˆè¿™ç§ä¸€èˆ¬è¯·æ±‚å°ä½†å“åº”å¤§æˆ–è€…å¤„ç†è€—æ—¶ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1552349376,"ip_address":"","comment_id":74294,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552182990","product_id":100020901,"comment_content":"net.ipv4.tcp_max_syn_backlog = 256 æ”¹æˆ1024 è¿™ä¸ªå¯¹DDoSæ”»å‡»æ— æ•ˆå§ï¼Œä¹Ÿä¸å·®è¿™å‡ ç™¾ä¸ªè¿æ¥","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442515,"discussion_content":"å—¯å—¯ï¼Œå¯¹æµé‡å‹æ— æ•ˆï¼›ä½†æ˜¯å¯ä»¥ç¼“è§£é’ˆå¯¹ä¸šåŠ¡çš„æ”»å‡»ï¼ˆè¿™ç§ä¸€èˆ¬è¯·æ±‚å°ä½†å“åº”å¤§æˆ–è€…å¤„ç†è€—æ—¶ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552349376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73359,"user_name":"wj","can_delete":false,"product_type":"c1","uid":1445765,"ip_address":"","ucode":"CF1965E9E13C90","user_header":"https://static001.geekbang.org/account/avatar/00/16/0f/85/0fa6f80f.jpg","comment_is_top":false,"comment_ctime":1551867595,"is_pvip":false,"replies":[{"id":"26760","content":"æˆ‘è®¾ç½®çš„è¯·æ±‚æ•°æ¯”è¾ƒä¿å®ˆï¼ˆè™šæœºæ€§èƒ½ä¸æ˜¯ç‰¹åˆ«å¥½ï¼‰ï¼ŒåŠ å¤§è¯·æ±‚è¯•è¯•","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1551885807,"ip_address":"","comment_id":73359,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551867595","product_id":100020901,"comment_content":"æˆ‘ä¹ŸæŒ‰ä¸Šé¢çš„æƒ…å†µå»æ¨¡æ‹Ÿäº†ï¼Œä½†æ˜¯æ²¡æœ‰è¾¾åˆ°èƒ½å¤ŸæŠŠæœåŠ¡å™¨åˆ·æ­»çš„é‚£ç§æ•ˆæœï¼Œè¯·æ±‚æ—¶é—´æ²¡ä»€ä¹ˆå˜åŒ–","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442040,"discussion_content":"æˆ‘è®¾ç½®çš„è¯·æ±‚æ•°æ¯”è¾ƒä¿å®ˆï¼ˆè™šæœºæ€§èƒ½ä¸æ˜¯ç‰¹åˆ«å¥½ï¼‰ï¼ŒåŠ å¤§è¯·æ±‚è¯•è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551885807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70032,"user_name":"hq","can_delete":false,"product_type":"c1","uid":1327892,"ip_address":"","ucode":"970EABB9C073A8","user_header":"https://static001.geekbang.org/account/avatar/00/14/43/14/4bb01de8.jpg","comment_is_top":false,"comment_ctime":1550970701,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1550970701","product_id":100020901,"comment_content":"å¾ˆå‰å®³ï¼Œè€å¸ˆã€‚ä¸€ç›´éƒ½æ²¡æœ‰ææ‡‚å¾ˆå¤šçš„åŸç†ï¼Œéƒ½æ˜¯æ¨¡ç³Šã€‚è¿ç»´éœ€è¦çš„çŸ¥è¯†å¤ªå¤šäº†ï¼Œç‰¹åˆ«æˆ‘ä»¬åˆ›ä¸šå…¬å¸ã€‚è·Ÿä½ ä¸€èµ·å­¦ä¹ ï¼Œæˆ‘å¯¹LINUXå¾ˆæœ‰å…´è¶£ã€‚","like_count":0},{"had_liked":false,"id":69295,"user_name":"è…¾è¾¾","can_delete":false,"product_type":"c1","uid":1079876,"ip_address":"","ucode":"72F9CFBA44FDEE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9hlAIKQ1sGDu16oWLOHyCSicr18XibygQSMLMjuDvKk73deDlH9aMphFsj41WYJh121aniaqBLiaMNg/132","comment_is_top":false,"comment_ctime":1550713675,"is_pvip":false,"replies":[{"id":"25326","content":"å—¯ æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1551193061,"ip_address":"","comment_id":69295,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550713675","product_id":100020901,"comment_content":"ä½¿ç”¨iptablesè¿‡æ»¤åŒ…ï¼Œå¹¶ä¸èƒ½ä½¿çš„ksoftirq&#47;0,è¿˜æœ‰softirqé‡Œçš„Net_Rxé™ä½ï¼Œæ˜¯è¿™æ ·å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440045,"discussion_content":"å—¯ æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551193061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69054,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1550652231,"is_pvip":false,"replies":[{"id":"24533","content":"ä½†è¿˜æœ‰ä¸€ç§æ˜¯åº”ç”¨å±‚çš„æ”»å‡»ï¼Œè¯·æ±‚æµé‡å¯èƒ½ä¸å¤§ï¼Œè€Œå“åº”æµé‡ç‰¹åˆ«å¤§ï¼Œè¿™ç§é—®é¢˜è¿˜æ˜¯éœ€è¦åº”ç”¨ç¨‹åºè€ƒè™‘çš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550674869,"ip_address":"","comment_id":69054,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1550652231","product_id":100020901,"comment_content":"[D39æ‰“å¡]<br>è€å¸ˆç•™çš„è¯¾åæ€è€ƒé¢˜,å›ç­”ä¸ä¸Šæ¥.ğŸ˜‚<br><br>ç›®å‰å› ä¸ºéƒ½æ˜¯äº‘æœåŠ¡å™¨,äº‘æœåŠ¡å•†ä¸€èˆ¬éƒ½ä¼šä¸»åŠ¨æ¨é€è¿™äº›è¢«æ”»å‡»çš„é£é™©ä¿¡æ¯.<br>ä¹‹å‰å·¥ä½œä¸­ç¡®å®é‡åˆ°è¿‡Ddosæ”»å‡».åŸºæœ¬ä¸Šéƒ½æ˜¯äº‘æœåŠ¡å™¨æŠŠäº‘ä¸»æœºçš„ipåŠ å…¥é»‘åå•,å°ç¦30åˆ†é’Ÿ.<br>ç”±äºæ”»å‡»æµé‡å¾ˆå¤§,ä¸€ä¸ªäº‘ä¸»æœºIPåœ¨å¾ˆçŸ­çš„æ—¶é—´é‡Œ(ä¸€åˆ†é’Ÿå·¦å³å§),å°±è¢«å°ç¦äº†.<br>åæ¥è™½ç„¶è´­ä¹°äº†é«˜é˜²IP,æ®è¯´ä¸€å¤©é˜²æŠ¤èƒ½åŠ›å‡ ç™¾G,ä½†æ˜¯ä¹Ÿä¸ç»ç”¨.<br><br>å¦‚æœä¸æ˜¯å±€åŸŸç½‘ä¸­æœ‰å…¶ä»–å…¥å£,è¿æœºå™¨éƒ½ç™»ä¸ä¸Šå».<br>ç­‰å‘ç°æ—¶,æœºå™¨çš„å…¬ç½‘å·²ç»è¢«åˆ‡æ–­,ä¹Ÿçœ‹ä¸åˆ°æœ‰ç”¨çš„ä¿¡æ¯äº†.","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439933,"discussion_content":"ä½†è¿˜æœ‰ä¸€ç§æ˜¯åº”ç”¨å±‚çš„æ”»å‡»ï¼Œè¯·æ±‚æµé‡å¯èƒ½ä¸å¤§ï¼Œè€Œå“åº”æµé‡ç‰¹åˆ«å¤§ï¼Œè¿™ç§é—®é¢˜è¿˜æ˜¯éœ€è¦åº”ç”¨ç¨‹åºè€ƒè™‘çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550674869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1688629,"avatar":"https://static001.geekbang.org/account/avatar/00/19/c4/35/2cc10d43.jpg","nickname":"Wade_é˜¿ä¼Ÿ","note":"","ucode":"5AE2E846A13443","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337682,"discussion_content":"è¿™ç§æƒ…å†µï¼Œå¯ä»¥è€ƒè™‘åœ¨äº‘ä¸Šé…ç½®å¤šä¸ªä¸»åŠ¨ä¸Šç½‘å‡ºå£ï¼Œé¿å…å› æŸä¸ªå‡ºå£ipè¢«æ”»å‡»ï¼Œå¯¼è‡´å†…ç½‘æœºå™¨æ— æ³•ä¸»åŠ¨ä¸Šç½‘ï¼Œæé«˜ä¸»åŠ¨ä¸Šç½‘å¯ç”¨æ€§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609040941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1205253,"avatar":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","nickname":"æˆ‘æ¥ä¹Ÿ","note":"","ucode":"773D6104F56767","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1688629,"avatar":"https://static001.geekbang.org/account/avatar/00/19/c4/35/2cc10d43.jpg","nickname":"Wade_é˜¿ä¼Ÿ","note":"","ucode":"5AE2E846A13443","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337881,"discussion_content":"æ˜¯çš„ åæ­£ipä¹Ÿä¸è´µã€‚2æ¯›é’±ä¸€å°æ—¶ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609116229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":337682,"ip_address":""},"score":337881,"extra":""}]}]},{"had_liked":false,"id":69025,"user_name":"å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1550647891,"is_pvip":false,"replies":[{"id":"24531","content":"QUICè·Ÿè§£å†³DDoSæ²¡å…³ç³»ï¼Œå®ƒçš„ç›®çš„æ˜¯é™ä½TCPå¸¦æ¥çš„å»¶è¿Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1550674732,"ip_address":"","comment_id":69025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550647891","product_id":100020901,"comment_content":"è°·æ­Œçš„QUIC åè®®å¯¹ DDoS æœ‰å¥½çš„åº”å¯¹åŠæ³•äº†å—ï¼Œå¯¹QUIC åè®®ç†è§£çš„ä¸æ˜¯å¾ˆé€å½»ï¼Œè¯·è€å¸ˆèµæ•™","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439921,"discussion_content":"QUICè·Ÿè§£å†³DDoSæ²¡å…³ç³»ï¼Œå®ƒçš„ç›®çš„æ˜¯é™ä½TCPå¸¦æ¥çš„å»¶è¿Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550674732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}