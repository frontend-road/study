{"id":88392,"title":"21 | Vuex最佳实践","content":"<h1>源代码及课件地址</h1><p><a href=\"https://gitee.com/geektime-geekbang/geektime-vue-1\">https://gitee.com/geektime-geekbang/geektime-vue-1</a></p>","comments":[{"had_liked":false,"id":147384,"user_name":"Kian","can_delete":false,"product_type":"c3","uid":1378726,"ip_address":"","ucode":"2647F415B8FFBB","user_header":"https://static001.geekbang.org/account/avatar/00/15/09/a6/6ff14750.jpg","comment_is_top":false,"comment_ctime":1572861524,"is_pvip":false,"replies":[{"id":57126,"content":"👍🏻","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1573007007,"ip_address":"","comment_id":147384,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"这个地方还是需要好好研究一下的，vuex的最佳实践方案。以及命名空间的使用，不过像vuex的一些api 比如mapMatations 这种老师没有讲过的还是需要自己去查一下如果使用。 老师的教案没有详细的备注，所以有些地方可能比较难懂。https:&#47;&#47;github.com&#47;Ccheng2729111&#47;vuex-demo  我这边上传了一份有详细备注的项目，并且加上了老师留下的课后习题。希望可以帮到有疑惑的同学。","like_count":22,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473236,"discussion_content":"👍🏻","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573007007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1855159,"avatar":"","nickname":"Geek_84e1a5","note":"","ucode":"D24EA641D100EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274935,"discussion_content":"您好，我是参考您带详细备注项目学习的，发现您的cart.js中addProductToCart的方法少一处Vue.set(cartItem, &#39;canAdd&#39;, product.canAdd)，否则同一个手机添加两次购物车时，quantity数量出现NaN","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1590634664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2055139,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5b/e3/7e88f66b.jpg","nickname":"bello","note":"","ucode":"2DC3A9B2E77DC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1855159,"avatar":"","nickname":"Geek_84e1a5","note":"","ucode":"D24EA641D100EC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349144,"discussion_content":"谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612928108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":274935,"ip_address":"","group_id":0},"score":349144,"extra":""}]}]},{"had_liked":false,"id":85082,"user_name":"冬天的雪好暖","can_delete":false,"product_type":"c3","uid":1467410,"ip_address":"","ucode":"97984111E1908D","user_header":"https://static001.geekbang.org/account/avatar/00/16/64/12/236f8cb5.jpg","comment_is_top":false,"comment_ctime":1554974329,"is_pvip":false,"replies":[{"id":30577,"content":"都用vuex ？ 不建议这么做，有句话是这么说的: 如果你不知道要不要用vuex ，那你大概率是不需要vuex的   \n\n组件的引用都在router？ 你这个要吗是项目简单，要吗是你的路由非常庞大！","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1554997729,"ip_address":"","comment_id":85082,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师您好，我想问问用了vuex，router以后还需要用前面父子组件之间的传值（例如props）吗？而且组件的引用都在router里面，插槽还能用吗？","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446551,"discussion_content":"都用vuex ？ 不建议这么做，有句话是这么说的: 如果你不知道要不要用vuex ，那你大概率是不需要vuex的   \n\n组件的引用都在router？ 你这个要吗是项目简单，要吗是你的路由非常庞大！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554997729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111208,"user_name":"tuyu","can_delete":false,"product_type":"c3","uid":1448863,"ip_address":"","ucode":"B235325B541408","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132","comment_is_top":false,"comment_ctime":1562511339,"is_pvip":false,"replies":[{"id":40832,"content":"Es6的扩展运算符  mapstate返回的是对象  可以任何搜索引擎搜索 es6扩展运算符 查看更多资料","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1562721144,"ip_address":"","comment_id":111208,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"作者你好, 那个 ...mapState({}) 中...是啥意思","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457284,"discussion_content":"Es6的扩展运算符  mapstate返回的是对象  可以任何搜索引擎搜索 es6扩展运算符 查看更多资料","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562721144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99704,"user_name":"Geek_redrain","can_delete":false,"product_type":"c3","uid":1487393,"ip_address":"","ucode":"11D32F5BBA0CFD","user_header":"","comment_is_top":false,"comment_ctime":1559282796,"is_pvip":false,"replies":[{"id":35974,"content":"👍","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1559452364,"ip_address":"","comment_id":99704,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"额，上了vuex的官方文档看了下，原来action函数接受一个与 store 实例具有相同方法和属性的 context 对象，我明白了。","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":452231,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559452364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95559,"user_name":"Lily","can_delete":false,"product_type":"c3","uid":1464414,"ip_address":"","ucode":"B5D49C8816D76E","user_header":"https://static001.geekbang.org/account/avatar/00/16/58/5e/47390406.jpg","comment_is_top":false,"comment_ctime":1558081529,"is_pvip":false,"replies":[{"id":34194,"content":"属性名表达式，这里有详解\nhttp:&#47;&#47;es6.ruanyifeng.com&#47;?search=%E8%A1%A8%E8%BE%BE%E5%BC%8F&amp;x=0&amp;y=0#docs&#47;object#%E5%B1%9E%E6%80%A7%E5%90%8D%E8%A1%A8%E8%BE%BE%E5%BC%8F","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1558102627,"ip_address":"","comment_id":95559,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"  [CART.SET_CART_ITEMS] (state, { items }) {\n    state.items = items\n  },\n\n  [CART.SET_CHECKOUT_STATUS] (state, status) {\n    state.checkoutStatus = status\n  }\n}\n    commit(CART.SET_CHECKOUT_STATUS, null)\n    &#47;&#47; empty cart\n    commit(CART.SET_CART_ITEMS, { items: [] })\n    shop.buyProducts(\n      products,\n      () =&gt; commit(CART.SET_CHECKOUT_STATUS, &#39;successful&#39;),\n      () =&gt; {\n        commit(CART.SET_CHECKOUT_STATUS, &#39;failed&#39;)\n        &#47;&#47; rollback to the cart saved before sending the request\n        commit(CART.SET_CART_ITEMS, { items: savedCartItems })\n      }\n    )\n\n老师您好，我想问下 [CART.SET_CHECKOUT_STATUS]  这样写是什么操作呢？\ncommit(CART.SET_CHECKOUT_STATUS, null)还有就是这样写？看不太懂","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450515,"discussion_content":"属性名表达式，这里有详解\nhttp://es6.ruanyifeng.com/?search=%E8%A1%A8%E8%BE%BE%E5%BC%8F&amp;amp;x=0&amp;amp;y=0#docs/object#%E5%B1%9E%E6%80%A7%E5%90%8D%E8%A1%A8%E8%BE%BE%E5%BC%8F","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558102627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92882,"user_name":"文哲","can_delete":false,"product_type":"c3","uid":1230050,"ip_address":"","ucode":"F443EEDF0567AB","user_header":"https://static001.geekbang.org/account/avatar/00/12/c4/e2/ca5932e1.jpg","comment_is_top":false,"comment_ctime":1557361693,"is_pvip":false,"replies":[{"id":33755,"content":"可以用  不过目前我还是喜欢原装的 ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1557809684,"ip_address":"","comment_id":92882,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师vuex-orm这个我觉得应该可以的呀","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449409,"discussion_content":"可以用  不过目前我还是喜欢原装的 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557809684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85806,"user_name":"young","can_delete":false,"product_type":"c3","uid":1472571,"ip_address":"","ucode":"4B5285A404E637","user_header":"https://static001.geekbang.org/account/avatar/00/16/78/3b/19ef632a.jpg","comment_is_top":false,"comment_ctime":1555241060,"is_pvip":false,"replies":[{"id":30848,"content":"可以补一下 es6的知识，\nimport {xxx} 是es6 模块化的知识，\nhttp:&#47;&#47;es6.ruanyifeng.com&#47;#docs&#47;module","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1555246571,"ip_address":"","comment_id":85806,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师，import { xxx } from &quot;vuex&quot; 为什么要用{}括号啊？前面的课程没有这样的语法","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446817,"discussion_content":"可以补一下 es6的知识，\nimport {xxx} 是es6 模块化的知识，\nhttp://es6.ruanyifeng.com/#docs/module","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555246571,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84087,"user_name":"Ronnie","can_delete":false,"product_type":"c3","uid":1385997,"ip_address":"","ucode":"75C1106CA67558","user_header":"https://static001.geekbang.org/account/avatar/00/15/26/0d/847722b2.jpg","comment_is_top":false,"comment_ctime":1554780520,"is_pvip":false,"replies":[{"id":30398,"content":"对的，这两个周期实际上都可以，如果你看官方的异步demo，基本也都在created中去做，只是如果需要SSR，created会在服务端也执行，就需要放在mounted中，如果你不考虑ssr，这两个还是很随意的","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1554820995,"ip_address":"","comment_id":84087,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"  created () {\n            this.$store.dispatch(&#39;products&#47;getAllProducts&#39;)\n        }，老师，这里其实就是在模拟了异步去取数据，那不是应该在mounted生命周期么？为什么这里在created里获取？","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446249,"discussion_content":"对的，这两个周期实际上都可以，如果你看官方的异步demo，基本也都在created中去做，只是如果需要SSR，created会在服务端也执行，就需要放在mounted中，如果你不考虑ssr，这两个还是很随意的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554820995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":84053,"user_name":"Mayao","can_delete":false,"product_type":"c3","uid":1391902,"ip_address":"","ucode":"047B4E4A9FD5EB","user_header":"https://static001.geekbang.org/account/avatar/00/15/3d/1e/29ee4ccc.jpg","comment_is_top":false,"comment_ctime":1554775762,"is_pvip":false,"replies":[{"id":30390,"content":"都能满足需求，mapGetters就像计算属性一样，涉及到多个state合并或计算时，可以使用，起到缓存的效果","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1554819629,"ip_address":"","comment_id":84053,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"请问下 什么场景用 mapState 取值 , 什么时候用 mapGetters 取值, 分不清这两者取回来的值有什么区别. \n不都是拿到state里的数据吗","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446232,"discussion_content":"都能满足需求，mapGetters就像计算属性一样，涉及到多个state合并或计算时，可以使用，起到缓存的效果","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554819629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83824,"user_name":"AMGMH","can_delete":false,"product_type":"c3","uid":1244948,"ip_address":"","ucode":"220D369345BD56","user_header":"https://static001.geekbang.org/account/avatar/00/12/ff/14/cbc78de6.jpg","comment_is_top":false,"comment_ctime":1554720681,"is_pvip":true,"replies":[{"id":30837,"content":"可以看 Mayao的问题回复","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1555234944,"ip_address":"","comment_id":83824,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"辅助函数mapState和mapGetters有哪些区别？是否可以将ProductList.vue文件中  \ncomputed: mapState({\n   products: state =&gt; state.products.all,\n})\n的写法改为在 product.js 文件更改getters如：\nconst getters = {\n   products: state =&gt; state.all\n}\n从而在ProductList.vue中使用\ncomputed: mapGetters(&#39;products&#39;, [&#39;products&#39;])","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":446155,"discussion_content":"可以看 Mayao的问题回复","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555234944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82741,"user_name":"帆帆","can_delete":false,"product_type":"c3","uid":1374166,"ip_address":"","ucode":"67C11DDCD287C8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIOyf5BbiaRd5N9SKyoOA3Wv2OLYdnEsXSHaffcSRnvVFx9ibnsq1fYUwYYZszy4sYTibwGWG3D6JqcQ/132","comment_is_top":false,"comment_ctime":1554293778,"is_pvip":false,"replies":[{"id":29936,"content":"这是给vuex内部用的，如果不加root: true，你在模块内提交的commit是该模块内的，加了之后便可以触发跟的mutation，示例中是在cart模块中commit一个products模块中的mutation","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1554339840,"ip_address":"","comment_id":82741,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"commit(`products&#47;${PRODUCTS.DECREMENT_PRODUCT_INVENTORY}`, { id: product.id }, { root: true })\n\n[PRODUCTS.DECREMENT_PRODUCT_INVENTORY] (state, { id }) {\n    const product = state.all.find(product =&gt; product.id === id)\n    product.inventory--\n  }\n\n老师不知道 { root: true } 这是什么意思，有什么用？没有看见使用的地方","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445707,"discussion_content":"这是给vuex内部用的，如果不加root: true，你在模块内提交的commit是该模块内的，加了之后便可以触发跟的mutation，示例中是在cart模块中commit一个products模块中的mutation","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554339840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82558,"user_name":"秦滈","can_delete":false,"product_type":"c3","uid":1073081,"ip_address":"","ucode":"EF696A2E33B605","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/b9/fe9c07f2.jpg","comment_is_top":false,"comment_ctime":1554251811,"is_pvip":false,"replies":[{"id":29932,"content":"多谢建议，会反馈给小编","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1554338690,"ip_address":"","comment_id":82558,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，你讲的很好。但是github的地址经常下载不了。能否在码云增加备份地址呢","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445636,"discussion_content":"多谢建议，会反馈给小编","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554338690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183554,"user_name":"Sean","can_delete":false,"product_type":"c3","uid":1272789,"ip_address":"","ucode":"BC0715BF423613","user_header":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","comment_is_top":false,"comment_ctime":1583065323,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"小米9没有货。。。太真实了。","like_count":15},{"had_liked":false,"id":173175,"user_name":"果然如此","can_delete":false,"product_type":"c3","uid":1210003,"ip_address":"","ucode":"C7543BD0A67505","user_header":"https://static001.geekbang.org/account/avatar/00/12/76/93/c78a132a.jpg","comment_is_top":false,"comment_ctime":1579446993,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"作业：\nproduct对象增加字段buy:1，默认购买1\n增加输入框和库存显示：\n库存：{{ product.inventory }}\n&lt;input :disabled=&quot;!product.inventory&quot; type=&quot;number&quot; v-model=&quot;product.buy&quot; style=&quot;width:30px;&quot;&gt;\n修改addProductToCart\naddProductToCart ({ state, commit }, product) {\n    console.log(&#39;addProductToCart&#39;,product.buy)\n    commit(CART.SET_CHECKOUT_STATUS, null)\n   &#47;&#47;增加超库存判断\n    if (product.buy&gt;product.inventory){\n      alert(&#39;库存不足&#39;+product.buy)\n      return\n    }\n    if (product.inventory &gt; 0) {\n      const cartItem = state.items.find(item =&gt; item.id === product.id)\n      if (!cartItem) {\n        commit(CART.PUSH_PRODUCT_TO_CART, { id: product.id, buy: product.buy })&#47;&#47;增加buy参数\n      } else {\n        commit(CART.INCREMENT_ITEM_QUANTITY, cartItem) &#47;&#47;cartItem中已有buy字段\n      }\n      &#47;&#47; remove 1 item from stock\n     &#47;&#47;扣减库存增加buy字段\n      commit(`products&#47;${PRODUCTS.DECREMENT_PRODUCT_INVENTORY}`, { id: product.id, buy: product.buy }, { root: true })\n    }\n  }\n}\n&#47;&#47;具体3个方法对product.buy进行增加或扣减\n1. 扣减库存buy \n[PRODUCTS.DECREMENT_PRODUCT_INVENTORY] (state, { id,buy }) {\n    const product = state.all.find(product =&gt; product.id === id)\n    &#47;&#47;product.inventory--\n    product.inventory -= buy\n  }\n2. 首次购买增加buy\n  [CART.PUSH_PRODUCT_TO_CART] (state, { id,buy }) {\n    state.items.push({\n      id,\n      &#47;&#47;quantity: 1\n      quantity:buy\n    })\n  },\n&#47;&#47;重复购买增加buy\n[CART.INCREMENT_ITEM_QUANTITY] (state, { id,buy }) {\n    const cartItem = state.items.find(item =&gt; item.id === id)\n    &#47;&#47;cartItem.quantity++\n    cartItem.quantity+=buy\n  },","like_count":2},{"had_liked":false,"id":285543,"user_name":"otakuhuang","can_delete":false,"product_type":"c3","uid":1541263,"ip_address":"","ucode":"283641975339AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/84/8f/a305cc1e.jpg","comment_is_top":false,"comment_ctime":1616877778,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"看了 es6 + vue 官方文档 + Kian 老哥的备注，终于看懂了点这个项目。\n附上课后习题：https:&#47;&#47;github.com&#47;otakuhuang&#47;vuex-demo-simplecarts\n第一次写，有点粗糙...","like_count":1},{"had_liked":false,"id":240552,"user_name":"Kiki","can_delete":false,"product_type":"c3","uid":1638865,"ip_address":"","ucode":"60AEA52B27BE20","user_header":"https://static001.geekbang.org/account/avatar/00/19/01/d1/1428201b.jpg","comment_is_top":false,"comment_ctime":1596971598,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"mutation-types.js是专门用来定义函数名的吗？是不是不用mutation-types.js也可以？用mutation-types.js有什么好处？","like_count":1},{"had_liked":false,"id":110863,"user_name":"院长。","can_delete":false,"product_type":"c3","uid":1153546,"ip_address":"","ucode":"DF56871F42A868","user_header":"https://static001.geekbang.org/account/avatar/00/11/9a/0a/da55228e.jpg","comment_is_top":false,"comment_ctime":1562380744,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"现在回复不知道还有没用，但是代码好像有错，ShoppingCart.vue文件中。   \n   &lt;ul&gt;\n      &lt;li\n        v-for=&quot;product in products&quot;\n        :key=&quot;product.id&quot;&gt;\n        {{ product.title }} - {{ product.price }} x {{ product.quantity }}\n      &lt;&#47;li&gt;\n    &lt;&#47;ul&gt;\n这里的key好想错了，你的代码逻辑里面product没有id。\ncartProducts: (state, getters, rootState) =&gt; {\n    return state.items.map(({ id, quantity }) =&gt; {\n      const product = rootState.products.all.find(product =&gt; product.id === id)\n      return {\n        title: product.title,\n        price: product.price,\n        quantity\n      }\n    })\n  },","like_count":1,"discussions":[{"author":{"id":1628953,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKfaQfj2oHpIawX80rIr0bAMuP77wN0BDdMW20HfyMyj2b6RlGSTRSRwX3F9rtevWoibSuoE4iaeEBg/132","nickname":"18625322963","note":"","ucode":"825472ECCDA3A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5512,"discussion_content":"商品id作为Key是比较好的方式，这是数据中的，比index更安全，比起动态操作列表来说","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566314002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99701,"user_name":"Geek_redrain","can_delete":false,"product_type":"c3","uid":1487393,"ip_address":"","ucode":"11D32F5BBA0CFD","user_header":"","comment_is_top":false,"comment_ctime":1559282424,"is_pvip":false,"replies":null,"discussion_count":4,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"大佬你好，在看源码的时候，有一个点没搞明白。products.js中的action, getAllProducts({commit})中的{commit}该如何理解。解构赋值明白，但是这个commit是从哪来的？不太理解。实际调用中productList.vue中的dispatch没有给出相关参数阿，网上找到一段说的是context.commit？","like_count":1,"discussions":[{"author":{"id":2066217,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/87/29/33c9fcd3.jpg","nickname":"後雨","note":"","ucode":"6BFC5C2B61D758","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384389,"discussion_content":"前面说了啊，context可以理解为this.$store，当然可以解构出state，commit，dispatch这些啦。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626548752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1490193,"avatar":"https://static001.geekbang.org/account/avatar/00/16/bd/11/ff68c199.jpg","nickname":"PT","note":"","ucode":"F74A42CDD03A15","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374441,"discussion_content":"getAllProducts(context)   这样的话,context里包含commit,  getAllProducts({commit})  直接可以拿到commit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621176536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2549659,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e7/9b/e8930453.jpg","nickname":"chris","note":"","ucode":"E1F3CB9A4E13A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371214,"discussion_content":"写成context，里面调用使用context.commit。就好理解了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619686099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2115402,"avatar":"","nickname":"Geek_bb8066","note":"","ucode":"8E506292F38322","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299128,"discussion_content":"我想退款了。。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597569972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90472,"user_name":"烟雨海花lwl","can_delete":false,"product_type":"c3","uid":1495437,"ip_address":"","ucode":"94106A70FF45A6","user_header":"https://static001.geekbang.org/account/avatar/00/16/d1/8d/d923fa4b.jpg","comment_is_top":false,"comment_ctime":1556529588,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"打卡","like_count":1},{"had_liked":false,"id":306742,"user_name":"圆圈！","can_delete":false,"product_type":"c3","uid":2333096,"ip_address":"","ucode":"573DB7C31A23B8","user_header":"https://static001.geekbang.org/account/avatar/00/23/99/a8/77902a56.jpg","comment_is_top":false,"comment_ctime":1628687729,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师你好，这节视频你说到vuex可以和router很好的配合是怎么样的一个配合作用呢？","like_count":0},{"had_liked":false,"id":258943,"user_name":"bugu","can_delete":false,"product_type":"c3","uid":1862545,"ip_address":"","ucode":"FEBF82A876C979","user_header":"https://static001.geekbang.org/account/avatar/00/1c/6b/91/168e10a1.jpg","comment_is_top":false,"comment_ctime":1604585428,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"多看几遍必有新收获","like_count":0},{"had_liked":false,"id":243088,"user_name":"KaKaKa","can_delete":false,"product_type":"c3","uid":1480732,"ip_address":"","ucode":"07D1980A71F321","user_header":"https://static001.geekbang.org/account/avatar/00/16/98/1c/d7a1439e.jpg","comment_is_top":false,"comment_ctime":1597947460,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"老师，请问下，vue-cli 4.5.4 创建的项目，是通过 createApp(App).mount(&#39;#app&#39;) 生成 dom，那 store 要怎么传进去，我网上搜了很多都没找到","like_count":0,"discussions":[{"author":{"id":1375520,"avatar":"https://static001.geekbang.org/account/avatar/00/14/fd/20/8b1ffed7.jpg","nickname":"@","note":"","ucode":"AE7B3F39E8AC30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320553,"discussion_content":".use(store)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604396363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204149,"user_name":"print","can_delete":false,"product_type":"c3","uid":1510181,"ip_address":"","ucode":"248F0A6CF7F95F","user_header":"https://static001.geekbang.org/account/avatar/00/17/0b/25/b40a7e78.jpg","comment_is_top":false,"comment_ctime":1586342154,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"老师 您好 项目启动后 页面提示state未定义 这是什么原因呢","like_count":0},{"had_liked":false,"id":174242,"user_name":"Danny","can_delete":false,"product_type":"c3","uid":1672090,"ip_address":"","ucode":"D90AF18E35C51F","user_header":"https://static001.geekbang.org/account/avatar/00/19/83/9a/bf8d7862.jpg","comment_is_top":false,"comment_ctime":1580106628,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"大神，我有个问题，判断 UA 这个操作的最佳实践是不是应该在store的actions里面操作？","like_count":0},{"had_liked":false,"id":155719,"user_name":"~鸵鸟蛋~","can_delete":false,"product_type":"c3","uid":1416642,"ip_address":"","ucode":"0A400EC8075955","user_header":"https://static001.geekbang.org/account/avatar/00/15/9d/c2/216fae0c.jpg","comment_is_top":false,"comment_ctime":1574743911,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"老师你好，请问自己实现的 vuex 的getters里，为什么是返回 this._vm._data.$$state，而不是this._vm.data.$$state？","like_count":0,"discussions":[{"author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":192151,"discussion_content":"因为vue会把选项中data内的属性，存储在实例的$data属性和_data属性下，可以通过vm.$data.PropertyName 或者 vm._data.propertyName来访问，vue实例中是没有data这个属性的。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1583065701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149041,"user_name":"Saki","can_delete":false,"product_type":"c3","uid":1143138,"ip_address":"","ucode":"CEA2E5D15D400E","user_header":"https://static001.geekbang.org/account/avatar/00/11/71/62/20df02b0.jpg","comment_is_top":false,"comment_ctime":1573130412,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"理解了，但暂时没想到哪里需要用到…跨多个页面且具有复杂操作时可以用对吧？如果只是简单的缓存数据应该用不上这个","like_count":0},{"had_liked":false,"id":95876,"user_name":"CrazyMuyang","can_delete":false,"product_type":"c3","uid":1161349,"ip_address":"","ucode":"C592928715EB9E","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/85/27aa9f63.jpg","comment_is_top":false,"comment_ctime":1558239629,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100024601,"comment_content":"用了那么久vue了，一直有一个疑问，所有的异步接口如果都放入action中请求的话，对于那种返回值需要多种条件（以及fail的情况）判断的该怎样处理？也要针对不同的情况将数据注入state中吗？\nvue项目下很早以前有过一个issue讨论过这个问题，但是我仍然没有从中得到很明确的答案。\nhttps:&#47;&#47;github.com&#47;vuejs&#47;vuex&#47;issues&#47;24\n望大哥解惑。","like_count":0}]}