{"id":521118,"title":"19 | 团队结构现代化： 团队拓扑学","content":"<p>你好，我是姚琪琳。</p><p>上节课，我们学习了遗留系统中最常见的单职能团队和技术组件团队，它们带来了很多问题。这些问题都体现在了软件的架构上，导致了大泥球架构，或按技术分层的多层架构。然后，我们深入讲解了可以解决这些问题的一些团队结构，如组件团队、特性团队和Spotify模型。</p><p>今天，我们来看看最近这几年来新诞生的组织结构模型——团队拓扑学（Team Topologies）。</p><h2>团队拓扑</h2><p>尽管组件团队、特性团队和Spotify模型，都为团队的组成提供了不错的建议，但团队的类型应该是什么样并没有一致的标准。如果所有团队都是特性团队，专注在某一个业务领域，那么业务领域开始变得复杂时，仍然僵化地专注于功能特性就会导致一些问题。</p><p>比如一个支付平台，它除了有源源不断的业务需求外，还有很多技术相关的事情要做，如数据的同步、分布式事务，或业务的回滚、对冲等。</p><p>假设按照系统的复杂度来判断，需要三十个人来维护这个平台，要是按照特性团队的思路来进行组织，就会分为三个特性团队，它们做着完全类似的业务开发。而对于复杂的技术问题，就可能无人问津了。尽管有了分会和协会可以一定程度上缓解，但这种自组织社区的执行力显然还不够。</p><p>这时，我们应该从<strong>团队优先（Team First）</strong>的角度去思考，将任务按照不同的复杂度来进行分解，并据此来创建团队。比如对于高复杂度的任务，应该建立一个以解决这些问题为KPI的专门团队，只有这样的团队才能真正解决这些复杂的问题。</p><!-- [[[read_end]]] --><p>有时候我们会觉得，团队无法满足开发的需要，是因为成员的能力不行，因此重点对人进行赋能，增加他的内在认知负载。但其实有可能是团队结构不合理，导致外在认知负载过高。</p><p>Matthew Skelton和Manuel Pais提出的<a href=\"https://teamtopologies.com\">团队拓扑学（Team Topologies）</a>，就从这一角度对团队的组成和沟通模式进行了大胆的尝试。</p><p><img src=\"https://static001.geekbang.org/resource/image/b3/27/b37f538799231cef80d74915000ba027.jpg?wh=1920x1369\" alt=\"图片\"></p><h3>团队拓扑类型</h3><p>他们提出了四种团队拓扑类型和三种交互模式。接下来我们就来重点学习一下。</p><p>第一种团队拓扑类型是<strong>业务流团队（Stream-aligned Team）</strong>，这里的“流”是指与业务、领域或组织能力对齐的工作流程，业务流团队的工作有可能是一个产品或服务，也可能是一组特性、一个用户旅程或一个用户画像。他们有能力快速、安全、独立地构建和交付用户价值，而不用将部分工作交给其他团队。</p><p>业务流团队是最主要的团队拓扑类型，你可以将它理解为特性团队，或Spotify中的小队，负责核心的价值交付。其他团队拓扑类型都是为了减轻业务流团队的负担，降低他们的认知负载而演进出来的。</p><p>比如，一个遗留系统想做微服务拆分，这是一项高难度的架构迁移工作。业务流团队的成员每天处于高强度的交付压力之下，根本没有时间去调研、探索和学习。这时候就诞生了第二种团队拓扑类型——<strong>赋能团队（Enabling Team）</strong>，它由特定技术领域或产品领域的专家组成。</p><p>赋能团队里的这些专家可以开展调研，尝试不同的方案，寻找最佳实践。然后对业务流团队进行赋能，使他们不需要太多的努力，就能具备拆分微服务的能力，大大降低了认知负载。</p><p>赋能团队并不会亲力亲为地解决具体技术问题，这些问题还是由业务流团队来处理。赋能团队主要关注的是，对组织中的所有业务流团队能力的提升。</p><p>相比Spotify模型中的分会和协会等松散的技术社区，赋能团队的工作内容更聚焦，可以有效地帮助业务流团队，解决某方面能力欠缺的问题。</p><p>不知道你的项目中是否有这样的模块，它的业务逻辑十分复杂，要想熟悉和理解需要极高的认知负载。比如视频的编解码、复杂的数学模型、语音识别算法等等。这时通常的解决办法是，由该领域的专家组成一个固定的团队，来维护这个复杂的模块。这种团队拓扑类型，就叫做<strong>复杂子系统团队（Complicated-Subsystem Team）</strong>。</p><p>在遗留系统中，如果有些复杂的计算位于存储过程，转换成Java十分困难，而且效率也不一定高。这时候可以考虑把它整体隔离出去，构建一个复杂子系统，再相应去组建一个复杂子系统团队，专门来维护它。团队自己可以决定是保持不变，还是将存储过程慢慢演进成代码。</p><p>业务流团队在和复杂子系统交互时，只需要使用复杂子系统团队提供的API，而不用费力地去理解这个复杂模块，同样可以降低认知负载。</p><p>然而有的时候，业务流团队不止需要访问复杂的业务模块，还要和一些组织内部的基础设施打交道，比如CI/CD服务器、各种容器和中间件等。</p><p>比如一个刚刚做到持续构建的遗留系统，很可能持续集成服务器并不稳定，动不动就会挂掉，但业务流团队没有精力去解决这些问题。这时候你需要的是第四种团队拓扑类型——<strong>平台团队（Platform Team）</strong>。它们负责解决底层问题，让业务流团队可以更专注于业务开发。</p><p>可以看到，<strong>团队拓扑的出发点是团队的认知负载</strong>，它所倡导的团队结构是认知负载最低的。它并没有尝试从不同的技术层面去解决团队的认知负载问题，这个角度仍然是在跨职能的业务流团队内部，通过不同的技术角色来解决的。因为业务流团队的成员虽然技术栈不同，但解决的都是价值流交付的问题。</p><p>团队拓扑建立了一个更高层次的抽象，按照技术和业务不同的复杂度，以及不同的团队目标来划分团队结构。</p><p>这是一种权衡。因为对个人来说，认知负载最低的一定是只从事自己最擅长的工作，也就是位于技术组件团队或职能团队中。但由于一个业务总是跨技术层级的，这就增加了沟通成本，导致了外在认知负载的升高；另一方面，特性团队虽然能很好地解决沟通问题，但不同层级的技术问题仍然会增加他们的认知负载，使他们无法专注在业务交付上，身心俱疲。</p><p>团队拓扑正是从这个角度，引入了另外三种团队类型，来解决特性团队的各种问题。</p><h3>团队交互模式</h3><p>在学习了四种团队拓扑类型之后，你可能会问，这些团队之间是如何交互的呢？团队拓扑学中给出了三种交互模式，分别是协作、服务和促进。</p><p><img src=\"https://static001.geekbang.org/resource/image/1c/5f/1c22c18d654d5cef43d942f0511b395f.jpg?wh=1920x581\" alt=\"图片\"></p><p><strong>协作（Collaboration）</strong>是指一个团队与另一个团队紧密合作。</p><p>比如前面提到的，业务流团队通过API来访问复杂子系统，当新的需求需要复杂子系统提供新的功能时，业务流团队就需要和复杂子系统团队通力合作，来完成这个需求；再比如一个用户登录功能，也需要业务流团队和平台团队的协作，业务流团队负责开发面向用户的界面和相应的后台，平台团队负责开发认证与鉴权功能，或者与其他单点登录系统集成。</p><p>协作也会增加沟通成本，但这种成本是系统的复杂性所导致的，并不是像按技术分组那样，是人为因素导致的。</p><p><strong>服务（X-as-a-Service）</strong>是指使用或提供某种服务，而尽量减少协作。比如如果复杂子系统已经提供了完成需求所用的API，业务流团队就无需与复杂子系统团队协作；如果平台团队已经封装好了用户认证和鉴权的所有功能，业务流团队也只需要“拿来主义”即可。由于API或服务开箱即用，业务流团队无需关注底层的实现细节，就可以快速地实现功能。</p><p><strong>促进（Facilitating）</strong>是指帮助其他团队清除障碍。这是赋能团队主要的交互模式，他们对外部团队提供支持和赋能，来提升他们的生产力和效率。</p><p><img src=\"https://static001.geekbang.org/resource/image/6f/ab/6fbd661c4d3cb6172790c104fd74b4ab.jpg?wh=1920x1105\" alt=\"图片\"></p><h2>逆康威定律</h2><p>学习完了特性团队、Spotify模型和团队拓扑，你可能会问，适合遗留系统的团队结构到底是什么样的呢？</p><p>我们前面提到了康威定律，即团队的结构会影响到系统的架构。假如你的系统包含四个团队，每个团队都包含前端和后端开发，而仅有一个DBA负责数据库变更。那么根据康威定律，你得到的软件架构一定是，拥有四个独立的应用，包含各自独立的用户界面和服务端，而它们共享一个单体数据库。</p><p><img src=\"https://static001.geekbang.org/resource/image/08/04/08be5d71ffe5fe4b8dd4944a74eb8304.jpg?wh=1920x800\" alt=\"图片\"></p><p>如果你在保持团队结构不变的情况下，企图拆分数据库，一定是办不到的。即使勉强拆分出来，也会很快腐化。正确的做法应该是，顺应康威定律，为每个团队配备一名DBA，然后再拆分数据库。每个应用的数据库由单独的DBA去维护，才能保证它不会腐化。</p><p>这种为得到理想的架构而改变团队结构的做法，叫做<a href=\"https://www.thoughtworks.com/radar/techniques/inverse-conway-maneuver\">逆康威定律（Inverse Conway Maneuver）</a>。也就是说，你想得到什么样的架构，就先把组织结构调整成那个样子，以此来推动组织变革。</p><p>在遗留系统中，你需要根据自己的目标架构来调整组织结构，同时参考特性团队、Spotify模型和团队拓扑。</p><p>康威定律不但会影响到架构形态，还会影响到架构师的技术决策。我发现很多架构师在做方案时，总是期望一步到位，这样会给原本简单的方案带来很多复杂度。</p><p>更合理的方式应该是，先用简单的方式run起来，尽早上线去交付价值，等发现问题再去修补和演进。这样更符合增量演进的原则，也更容易得到一个“刚刚好的架构”。而“一步到位”的想法则更容易导致过度设计。</p><p>产生“一步到位”这种想法的根本原因是什么？表面上，是架构师在做设计的时候可能不会想到那么多，只是一种先入为主或者说习惯的想法，但实际上背后可能隐藏着康威定律。</p><p>如果你有一个独立的团队去维护一个服务，这个团队能有足够的人力、有足够的上下文去守护这个服务的架构，你就会更倾向于构建一个可演进的架构。但如果团队接下来有哪些人你不确定，他们有没有能力演进同样不确定，那么主观上我们就会不自觉地倾向一步到位式的设计。因为如果现在不做，以后就可能没机会了。</p><p>如果你是项目的负责人，希望你能够主动改变团队的结构，以得到理想中的架构，并且潜移默化地改变团队中的各项技术决策。</p><h2>小结</h2><p>总结一下今天的内容。我们学习了近年来提出的一种全新的团队结构模型——团队拓扑学。我之所以在它后面加了一个“学”字，是因为它相比特性团队和Spotify模型，更接近一门学问。它提出的团队认知负载和团队优先的理念，更是超前于这个时代。</p><p>组件团队、特性团队、Spotify模型或团队拓扑，它们并不是相互替换的关系，而是可以按需合并和剪裁的。它们面向的问题域不同、目标不同、出发点不同，因此不存在谁比谁高明的情况。</p><p>我还准备了一张表格，总结几种讲过的团队类型，你可以做个参考。<br>\n<img src=\"https://static001.geekbang.org/resource/image/81/0c/810d309a3522da96889dec23f98df60c.jpg?wh=1920x959\" alt=\"图片\"></p><p>你应该根据自己团队的实际问题，找出合适的方案。比如你可以以特性团队为基础，并为几个特性团队配备平台团队和赋能团队，这样的几个团队组成一个部落，同时也有跨团队的各种技术社区。</p><p>比如很多组织的开发团队忙于需求开发，根本没有时间思考流程改进。这时候我们想推动类似主干开发这类实践，是很难有进展的，因为它需要很多配套的基础设施，开发团队没有时间去做这些。</p><p>业务部门也只要看到需求上线就行，根本不关心流程改进，毕竟开发的痛点跟他们没关系。业务方总是把开发团队当成工具人，而不是合作者。</p><p>现在很多大厂开始组建工程效能部门，负责开发工具、优化流程、改进基础设施，一定程度上解放了开发部门。虽然很难说这种工程效能部门是属于赋能团队还是平台团队，但至少都是在解决业务流团队平时没时间解决的痛点问题，为他们服务。这就是一种非常有价值的探索。</p><p>同时要记住的是，团队结构也要不断演进。虽然以不变应万变很酷，但当“应付”不了的时候，还是应当“应变”。因为业务在变化，架构自然需要跟着变化以支撑业务，那么根据逆康威定律，你也要调整团队结构，以支撑新的架构。</p><h2>思考题</h2><p>感谢你学完了今天的内容，今天的思考题是，请你来分享一下你所在团队的组成是什么样的？有没有类似赋能团队或平台团队这样的组织？你们是否会根据目标架构而演进自己的团队结构？</p><p>期待你的分享，如果你觉得这节课对你有帮助，别忘了分享给你的同事和朋友，我们一起来推动组织变革。</p>","neighbors":{"left":{"article_title":"18 | 团队结构现代化 ：从组件团队到Spotify模型","id":520553},"right":{"article_title":"20｜启动：如何开启一个遗留系统现代化项目？","id":521807}},"comments":[{"had_liked":false,"id":346609,"user_name":"子夜枯灯","can_delete":false,"product_type":"c1","uid":1359678,"ip_address":"","ucode":"5D84BFE7832038","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/3e/cdc36608.jpg","comment_is_top":false,"comment_ctime":1653282750,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"增长了知识面，感谢作者","like_count":2},{"had_liked":false,"id":346591,"user_name":"yyk","can_delete":false,"product_type":"c1","uid":1360234,"ip_address":"","ucode":"2EBE855AC995F5","user_header":"","comment_is_top":false,"comment_ctime":1653272186,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"高效能团队模式的精华都在这了","like_count":2},{"had_liked":false,"id":371032,"user_name":"可可","can_delete":false,"product_type":"c1","uid":1053294,"ip_address":"山东","ucode":"297A5D32949128","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ1VPGSQg7SqrN1Gutx31Kicks2icZjTCg1gZoDLfEcSSricYD6l5qQgE3MkMpqlhkM4gMicymOYzaudg/132","comment_is_top":false,"comment_ctime":1679473145,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"仅有一个 DBA 负责数据库变更，就只会共享一个单体数据库吗？一个DBA可以根据不同的业务团队建不同的数据库吧？","like_count":0},{"had_liked":false,"id":361692,"user_name":"白葡萄干","can_delete":false,"product_type":"c1","uid":2432499,"ip_address":"四川","ucode":"65B6DC2012D8E7","user_header":"https://static001.geekbang.org/account/avatar/00/25/1d/f3/101604ed.jpg","comment_is_top":false,"comment_ctime":1667787994,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"感觉我们的是按照业务区分的，实际也遇到了不少问题，比如很多公共服务的建设和使用，打包发布平台，配置中心等，造成大家的认知负载变高","like_count":0},{"had_liked":false,"id":359098,"user_name":"花花大脸猫","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"江苏","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1665237378,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"目前还是以组件型团队为主，会存在平台团队，都是以架构师为主，但是感觉也跟文中描述的不太像，会处理跨团队的需求也会处理基础平台型的技术方案，平时也是各自负责组件型团队内部的架构设计","like_count":0},{"had_liked":false,"id":347016,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1653618757,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100111101,"comment_content":"康威定律\n顺我者昌逆我者亡\n还是按套路来吧","like_count":0}]}