{"id":429826,"title":"07 | Torchvisionï¼ˆä¸­ï¼‰ï¼šæ•°æ®å¢å¼ºï¼Œè®©æ•°æ®æ›´åŠ å¤šæ ·æ€§","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æ–¹è¿œã€‚</p><p>ä¸Šä¸€èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä¸€åŒè¿ˆå‡ºäº†è®­ç»ƒå¼€å§‹çš„ç¬¬ä¸€æ­¥â€”â€”æ•°æ®è¯»å–ï¼Œåˆæ­¥è®¤è¯†äº†Torchvisionï¼Œå­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨Torchvisionè¯»å–æ•°æ®ã€‚ä¸è¿‡ä»…ä»…å°†æ•°æ®é›†ä¸­çš„å›¾ç‰‡è¯»å–å‡ºæ¥æ˜¯ä¸å¤Ÿçš„ï¼Œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œç¥ç»ç½‘ç»œæ¨¡å‹æ¥æ”¶çš„æ•°æ®ç±»å‹æ˜¯Tensorï¼Œè€Œä¸æ˜¯PILå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†æ“ä½œï¼Œæ¯”å¦‚å›¾åƒæ ¼å¼çš„è½¬æ¢ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼ŒåŠ è½½åçš„å›¾åƒæ•°æ®å¯èƒ½è¿˜éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å›¾åƒå˜æ¢ä¸å¢å¼ºæ“ä½œï¼Œä¾‹å¦‚è£åˆ‡è¾¹æ¡†ã€è°ƒæ•´å›¾åƒæ¯”ä¾‹å’Œå¤§å°ã€æ ‡å‡†åŒ–ç­‰ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ åˆ°æ•°æ®çš„ç‰¹å¾ã€‚è¿™äº›æ“ä½œéƒ½å¯ä»¥ä½¿ç”¨<code>torchvision.transforms</code>å·¥å…·å®Œæˆã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸€ä¸‹ï¼Œåˆ©ç”¨Torchvisionå¦‚ä½•è¿›è¡Œæ•°æ®é¢„å¤„ç†æ“ä½œï¼Œå¦‚ä½•è¿›è¡Œå›¾åƒå˜æ¢ä¸å¢å¼ºã€‚</p><h2>å›¾åƒå¤„ç†å·¥å…·ä¹‹torchvision.transforms</h2><p>Torchvisionåº“ä¸­çš„<code>torchvision.transforms</code>åŒ…ä¸­æä¾›äº†å¸¸ç”¨çš„å›¾åƒæ“ä½œï¼ŒåŒ…æ‹¬å¯¹Tensor åŠPIL Imageå¯¹è±¡çš„æ“ä½œï¼Œä¾‹å¦‚éšæœºåˆ‡å‰²ã€æ—‹è½¬ã€æ•°æ®ç±»å‹è½¬æ¢ç­‰ç­‰ã€‚</p><p>æŒ‰ç…§<code>torchvision.transforms</code> çš„åŠŸèƒ½ï¼Œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼šæ•°æ®ç±»å‹è½¬æ¢ã€å¯¹PIL.Image å’Œ Tensorè¿›è¡Œå˜åŒ–å’Œå˜æ¢çš„ç»„åˆã€‚ä¸‹é¢æˆ‘ä»¬ä¾æ¬¡æ¥å­¦ä¹ è¿™äº›ç±»åˆ«ä¸­çš„æ“ä½œã€‚</p><!-- [[[read_end]]] --><h3>æ•°æ®ç±»å‹è½¬æ¢</h3><p>åœ¨ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†è¯»å–æ•°æ®é›†ä¸­çš„å›¾ç‰‡ï¼Œè¯»å–åˆ°çš„æ•°æ®æ˜¯PIL.Imageçš„å¯¹è±¡ã€‚è€Œåœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µï¼Œéœ€è¦ä¼ å…¥Tensorç±»å‹çš„æ•°æ®ï¼Œç¥ç»ç½‘ç»œæ‰èƒ½è¿›è¡Œè¿ç®—ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•å°†PIL.Imageæˆ–Numpy.ndarrayæ ¼å¼çš„æ•°æ®è½¬åŒ–ä¸ºTensoræ ¼å¼å‘¢ï¼Ÿè¿™éœ€è¦ç”¨åˆ°<code>transforms.ToTensor()</code> ç±»ã€‚</p><p>è€Œåä¹‹ï¼Œå°†Tensor æˆ– Numpy.ndarray æ ¼å¼çš„æ•°æ®è½¬åŒ–ä¸ºPIL.Imageæ ¼å¼ï¼Œåˆ™ä½¿ç”¨<code>transforms.ToPILImage(mode=None)</code> ç±»ã€‚å®ƒåˆ™æ˜¯ToTensorçš„ä¸€ä¸ªé€†æ“ä½œï¼Œå®ƒèƒ½æŠŠTensoræˆ–Numpyçš„æ•°ç»„è½¬æ¢æˆPIL.Imageå¯¹è±¡ã€‚</p><p>å…¶ä¸­ï¼Œå‚æ•°modeä»£è¡¨PIL.Imageçš„æ¨¡å¼ï¼Œå¦‚æœmodeä¸ºNoneï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™æ ¹æ®è¾“å…¥æ•°æ®çš„ç»´åº¦è¿›è¡Œæ¨æ–­ï¼š</p><ul>\n<li>è¾“å…¥ä¸º3é€šé“ï¼šmodeä¸ºâ€™RGBâ€™ï¼›</li>\n<li>è¾“å…¥ä¸º4é€šé“ï¼šmodeä¸ºâ€™RGBAâ€™ï¼›</li>\n<li>è¾“å…¥ä¸º2é€šé“ï¼šmodeä¸ºâ€™LAâ€™;</li>\n<li>è¾“å…¥ä¸ºå•é€šé“ï¼šmodeæ ¹æ®è¾“å…¥æ•°æ®çš„ç±»å‹ç¡®å®šå…·ä½“æ¨¡å¼ã€‚</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/d3/0c/d3013753ef85937a39b64ef8f556df0c.jpg?wh=318x116\" alt=\"å›¾ç‰‡\"></p><p>è¯´å®Œç”¨æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­åŠ æ·±ç†è§£ã€‚ä»¥æå®¢æ—¶é—´çš„LOGOå›¾ç‰‡ï¼ˆæ–‡ä»¶åä¸ºï¼šjk.jpgï¼‰ä¸ºä¾‹ï¼Œè¿›è¡Œä¸€ä¸‹æ•°æ®ç±»å‹çš„ç›¸äº’è½¬æ¢ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n\n\nimg = Image.open('jk.jpg')&nbsp;\ndisplay(img)\nprint(type(img)) # PIL.Image.Imageæ˜¯PIL.JpegImagePlugin.JpegImageFileçš„åŸºç±»\n'''\nè¾“å‡º:&nbsp;\n&lt;class 'PIL.JpegImagePlugin.JpegImageFile'&gt;\n'''\n\n# PIL.Imageè½¬æ¢ä¸ºTensor\nimg1 = transforms.ToTensor()(img)\nprint(type(img1))\n'''\nè¾“å‡º:&nbsp;\n&lt;class 'torch.Tensor'&gt;\n'''\n\n# Tensorè½¬æ¢ä¸ºPIL.Image\nimg2 = transforms.ToPILImage()(img1)&nbsp; #PIL.Image.Image\nprint(type(img2))\n'''\nè¾“å‡º:&nbsp;\n&lt;class 'PIL.Image.Image'&gt;\n'''\n</code></pre><p>é¦–å…ˆç”¨è¯»å–å›¾ç‰‡ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å›¾ç‰‡çš„ç±»å‹ä¸ºPIL.JpegImagePlugin.JpegImageFileï¼Œè¿™é‡Œéœ€è¦æ³¨æ„<strong>ï¼ŒPIL.JpegImagePlugin.JpegImageFileç±»æ˜¯PIL.Image.Imageç±»çš„å­ç±»</strong>ã€‚ç„¶åï¼Œç”¨<code>transforms.ToTensor()</code> å°†PIL.Imageè½¬æ¢ä¸ºTensorã€‚æœ€åï¼Œå†å°†Tensorè½¬æ¢å›PIL.Imageã€‚</p><h3>å¯¹ PIL.Image å’Œ Tensor è¿›è¡Œå˜æ¢</h3><p><code>torchvision.transforms</code> æä¾›äº†ä¸°å¯Œçš„å›¾åƒå˜æ¢æ–¹æ³•ï¼Œä¾‹å¦‚ï¼šæ”¹å˜å°ºå¯¸ã€å‰ªè£ã€ç¿»è½¬ç­‰ã€‚å¹¶ä¸”è¿™äº›å›¾åƒå˜æ¢æ“ä½œå¯ä»¥æ¥æ”¶å¤šç§æ•°æ®æ ¼å¼ï¼Œä¸ä»…å¯ä»¥ç›´æ¥å¯¹PILæ ¼å¼çš„å›¾åƒè¿›è¡Œå˜æ¢ï¼Œä¹Ÿå¯ä»¥å¯¹Tensorè¿›è¡Œå˜æ¢ï¼Œæ— éœ€æˆ‘ä»¬å†å»åšé¢å¤–çš„æ•°æ®ç±»å‹è½¬æ¢ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä¾æ¬¡æ¥çœ‹ä¸€çœ‹ã€‚</p><h4>Resize</h4><p>å°†è¾“å…¥çš„ PIL Image æˆ– Tensor å°ºå¯¸è°ƒæ•´ä¸ºç»™å®šçš„å°ºå¯¸ï¼Œå…·ä½“å®šä¹‰ä¸ºï¼š</p><pre><code class=\"language-python\">torchvision.transforms.Resize(size, interpolation=2)\n</code></pre><p>æˆ‘ä»¬ä¾æ¬¡çœ‹ä¸‹ç›¸å…³çš„å‚æ•°ï¼š</p><ul>\n<li>sizeï¼šæœŸæœ›è¾“å‡ºçš„å°ºå¯¸ã€‚å¦‚æœ size æ˜¯ä¸€ä¸ªåƒ (h, w) è¿™æ ·çš„å…ƒç»„ï¼Œåˆ™å›¾åƒè¾“å‡ºå°ºå¯¸å°†ä¸ä¹‹åŒ¹é…ã€‚å¦‚æœ size æ˜¯ä¸€ä¸ª int ç±»å‹çš„æ•´æ•°ï¼Œå›¾åƒè¾ƒå°çš„è¾¹å°†è¢«åŒ¹é…åˆ°è¯¥æ•´æ•°ï¼Œå¦ä¸€æ¡è¾¹æŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚</li>\n<li>interpolationï¼šæ’å€¼ç®—æ³•ï¼Œintç±»å‹ï¼Œé»˜è®¤ä¸º2ï¼Œè¡¨ç¤º PIL.Image.BILINEARã€‚</li>\n</ul><p>æœ‰å…³Sizeä¸­æ˜¯tupleè¿˜æ˜¯intè¿™ä¸€ç‚¹è¯·ä½ ä¸€å®šè¦æ³¨æ„ã€‚</p><p>è®©æˆ‘è¯´æ˜ä¸€ä¸‹ï¼Œåœ¨æˆ‘ä»¬è®­ç»ƒæ—¶ï¼Œé€šå¸¸è¦æŠŠå›¾ç‰‡resizeåˆ°ä¸€å®šçš„å¤§å°ï¼Œæ¯”å¦‚è¯´128x128ï¼Œ256x256è¿™æ ·çš„ã€‚å¦‚æœç›´æ¥ç»™å®šresizeåçš„é«˜ä¸å®½ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†å¦‚æœè®¾å®šçš„æ˜¯ä¸€ä¸ªintå‹ï¼Œè¾ƒé•¿çš„è¾¹å°±ä¼šæŒ‰æ¯”ä¾‹ç¼©æ”¾ã€‚</p><p>åœ¨resizeä¹‹åå‘¢ï¼Œä¸€èˆ¬ä¼šæ¥ä¸€ä¸ªcropæ“ä½œï¼Œcropåˆ°æŒ‡å®šçš„å¤§å°ã€‚å¯¹äºé«˜ä¸å®½æ¥è¿‘çš„å›¾ç‰‡æ¥è¯´ï¼Œè¿™ä¹ˆåšé—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯é«˜ä¸å®½çš„å·®è·è¾ƒå¤§æ—¶ï¼Œå°±ä¼šcropæ‰å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åœ¨åç»­çš„å›¾åƒåˆ†ç±»éƒ¨åˆ†è¿˜ä¼šé‡åˆ°ï¼Œåˆ°æ—¶æˆ‘åœ¨è¯¦ç»†å±•å¼€ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥æå®¢æ—¶é—´çš„LOGOå›¾ç‰‡ä¸ºä¾‹ï¼Œä¸€èµ·çœ‹ä¸€ä¸‹Resizeçš„æ•ˆæœã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n# å®šä¹‰ä¸€ä¸ªResizeæ“ä½œ\nresize_img_oper = transforms.Resize((200,200), interpolation=2)\n\n# åŸå›¾\norig_img = Image.open('jk.jpg')&nbsp;\ndisplay(orig_img)\n\n# Resizeæ“ä½œåçš„å›¾\nimg = resize_img_oper(orig_img)\ndisplay(img)\n</code></pre><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªResizeæ“ä½œï¼Œè®¾ç½®å¥½å˜æ¢åçš„å°ºå¯¸ä¸º(200, 200)ï¼Œç„¶åå¯¹æå®¢æ—¶é—´LOGOå›¾ç‰‡è¿›è¡ŒResizeå˜æ¢ã€‚<br>\nåŸå›¾ä»¥åŠResizeå˜æ¢åçš„æ•ˆæœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/09/5611e53aaed88bb079909992db5c6d09.jpg?wh=1232x505\" alt=\"å›¾ç‰‡\"></p><h4>å‰ªè£</h4><p><code>torchvision.transforms</code>æä¾›äº†å¤šç§å‰ªè£æ–¹æ³•ï¼Œä¾‹å¦‚ä¸­å¿ƒå‰ªè£ã€éšæœºå‰ªè£ã€å››è§’å’Œä¸­å¿ƒå‰ªè£ç­‰ã€‚æˆ‘ä»¬ä¾æ¬¡æ¥çœ‹ä¸‹å®ƒä»¬çš„å®šä¹‰ã€‚</p><p>å…ˆè¯´ä¸­å¿ƒå‰ªè£ï¼Œé¡¾åæ€ä¹‰ï¼Œåœ¨ä¸­å¿ƒè£å‰ªæŒ‡å®šçš„ PIL Image æˆ– Tensorï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">torchvision.transforms.CenterCrop(size)\n</code></pre><p>å…¶ä¸­ï¼Œsizeè¡¨ç¤ºæœŸæœ›è¾“å‡ºçš„å‰ªè£å°ºå¯¸ã€‚å¦‚æœ size æ˜¯ä¸€ä¸ªåƒ (h, w) è¿™æ ·çš„å…ƒç»„ï¼Œåˆ™å‰ªè£åçš„å›¾åƒå°ºå¯¸å°†ä¸ä¹‹åŒ¹é…ã€‚å¦‚æœ&nbsp;size&nbsp;æ˜¯&nbsp;int&nbsp;ç±»å‹çš„æ•´æ•°ï¼Œå‰ªè£å‡ºæ¥çš„å›¾åƒæ˜¯&nbsp;(size, size)&nbsp;çš„æ­£æ–¹å½¢ã€‚</p><p>ç„¶åæ˜¯éšæœºå‰ªè£ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªéšæœºä½ç½®å‰ªè£æŒ‡å®šçš„ PIL Image æˆ– Tensorï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-python\">torchvision.transforms.RandomCrop(size, padding=None)\n</code></pre><p>å…¶ä¸­ï¼Œsizeä»£è¡¨æœŸæœ›è¾“å‡ºçš„å‰ªè£å°ºå¯¸ï¼Œç”¨æ³•åŒä¸Šã€‚è€Œpaddingè¡¨ç¤ºå›¾åƒçš„æ¯ä¸ªè¾¹æ¡†ä¸Šçš„å¯é€‰å¡«å……ã€‚é»˜è®¤å€¼æ˜¯ Noneï¼Œå³æ²¡æœ‰å¡«å……ã€‚é€šå¸¸æ¥è¯´ï¼Œä¸ä¼šç”¨paddingè¿™ä¸ªå‚æ•°ï¼Œè‡³å°‘å¯¹äºæˆ‘æ¥è¯´è‡³ä»Šæ²¡ç”¨è¿‡ã€‚</p><p>æœ€åè¦è¯´çš„æ˜¯FiveCropï¼Œæˆ‘ä»¬å°†ç»™å®šçš„ PIL Image  æˆ– Tensor ï¼Œåˆ†åˆ«ä»å››è§’å’Œä¸­å¿ƒè¿›è¡Œå‰ªè£ï¼Œå…±å‰ªè£æˆäº”å—ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>torchvision.transforms.FiveCrop(size)\n</code></pre><p>sizeå¯ä»¥æ˜¯intæˆ–tupleï¼Œç”¨æ³•åŒä¸Šã€‚<br>\næŒæ¡äº†å„ç§å‰ªè£çš„å®šä¹‰å’Œå‚æ•°ç”¨æ³•ä»¥åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™äº›å‰ªè£æ“ä½œå…·ä½“å¦‚ä½•è°ƒç”¨ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n# å®šä¹‰å‰ªè£æ“ä½œ\ncenter_crop_oper = transforms.CenterCrop((60,70))\nrandom_crop_oper = transforms.RandomCrop((80,80))\nfive_crop_oper = transforms.FiveCrop((60,70))\n\n# åŸå›¾\norig_img = Image.open('jk.jpg')&nbsp;\ndisplay(orig_img)\n\n# ä¸­å¿ƒå‰ªè£\nimg1 = center_crop_oper(orig_img)\ndisplay(img1)\n# éšæœºå‰ªè£\nimg2 = random_crop_oper(orig_img)\ndisplay(img2)\n# å››è§’å’Œä¸­å¿ƒå‰ªè£\nimgs = five_crop_oper(orig_img)\nfor img in imgs:\n&nbsp; &nbsp; display(img)\n</code></pre><p>æµç¨‹å’ŒResizeç±»ä¼¼ï¼Œéƒ½æ˜¯å…ˆå®šä¹‰å‰ªè£æ“ä½œï¼Œç„¶åå¯¹æå®¢æ—¶é—´LOGOå›¾ç‰‡è¿›è¡Œä¸åŒçš„å‰ªè£ã€‚<br>\nå…·ä½“å‰ªè£æ•ˆæœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/60/b5/60ca577c5f08eef4ca727c1f0aac9cb5.jpg?wh=1384x896\" alt=\"å›¾ç‰‡\"></p><h4>ç¿»è½¬</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ç¿»è½¬æ“ä½œã€‚<code>torchvision.transforms</code>æä¾›äº†ä¸¤ç§ç¿»è½¬æ“ä½œï¼Œåˆ†åˆ«æ˜¯ï¼šä»¥æŸä¸€æ¦‚ç‡éšæœºæ°´å¹³ç¿»è½¬å›¾åƒå’Œä»¥æŸä¸€æ¦‚ç‡éšæœºå‚ç›´ç¿»è½¬å›¾åƒã€‚æˆ‘ä»¬åˆ†åˆ«æ¥çœ‹å®ƒä»¬çš„å®šä¹‰ã€‚</p><p>ä»¥æ¦‚ç‡péšæœºæ°´å¹³ç¿»è½¬å›¾åƒï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">torchvision.transforms.RandomHorizontalFlip(p=0.5)\n</code></pre><p>ä»¥æ¦‚ç‡péšæœºå‚ç›´ç¿»è½¬å›¾åƒï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">torchvision.transforms.RandomVerticalFlip(p=0.5)\n</code></pre><p>å…¶ä¸­ï¼Œpè¡¨ç¤ºéšæœºç¿»è½¬çš„æ¦‚ç‡å€¼ï¼Œé»˜è®¤ä¸º0.5ã€‚<br>\nè¿™é‡Œçš„éšæœºç¿»è½¬ï¼Œæ˜¯ä¸ºæ•°æ®å¢å¼ºæä¾›æ–¹ä¾¿ã€‚å¦‚æœæƒ³è¦å¿…é¡»æ‰§è¡Œç¿»è½¬æ“ä½œçš„è¯ï¼Œå°†pè®¾ç½®ä¸º1å³å¯ã€‚</p><p>ä»¥æå®¢æ—¶é—´çš„LOGOå›¾ç‰‡ä¸ºä¾‹ï¼Œå›¾ç‰‡ç¿»è½¬çš„ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n# å®šä¹‰ç¿»è½¬æ“ä½œ\nh_flip_oper = transforms.RandomHorizontalFlip(p=1)\nv_flip_oper = transforms.RandomVerticalFlip(p=1)\n\n# åŸå›¾\norig_img = Image.open('jk.jpg')&nbsp;\ndisplay(orig_img)\n\n# æ°´å¹³ç¿»è½¬\nimg1 = h_flip_oper(orig_img)\ndisplay(img1)\n# å‚ç›´ç¿»è½¬\nimg2 = v_flip_oper(orig_img)\ndisplay(img2)\n</code></pre><p>ç¿»è½¬æ•ˆæœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/0d/84/0dc2543bb7bdfyy7803c353f2030f184.jpg?wh=1386x675\" alt=\"å›¾ç‰‡\"></p><h3>åªå¯¹Tensorè¿›è¡Œå˜æ¢</h3><p>ç›®å‰ç‰ˆæœ¬çš„Torchvisionï¼ˆv0.10.0ï¼‰å¯¹å„ç§å›¾åƒå˜æ¢æ“ä½œå·²ç»åŸºæœ¬åŒæ—¶æ”¯æŒ PIL Image å’Œ Tensor ç±»å‹äº†ï¼Œå› æ­¤åªé’ˆå¯¹Tensorçš„å˜æ¢æ“ä½œå¾ˆå°‘ï¼Œåªæœ‰4ä¸ªï¼Œåˆ†åˆ«æ˜¯LinearTransformationï¼ˆçº¿æ€§å˜æ¢ï¼‰ã€Normalizeï¼ˆæ ‡å‡†åŒ–ï¼‰ã€RandomErasingï¼ˆéšæœºæ“¦é™¤ï¼‰ã€ConvertImageDtypeï¼ˆæ ¼å¼è½¬æ¢ï¼‰ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹æœ€å¸¸ç”¨çš„ä¸€ä¸ªæ“ä½œï¼šæ ‡å‡†åŒ–ï¼Œå…¶ä»–3ä¸ªä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚</p><h4>æ ‡å‡†åŒ–</h4><p>æ ‡å‡†åŒ–æ˜¯æŒ‡æ¯ä¸€ä¸ªæ•°æ®ç‚¹å‡å»æ‰€åœ¨é€šé“çš„å¹³å‡å€¼ï¼Œå†é™¤ä»¥æ‰€åœ¨é€šé“çš„æ ‡å‡†å·®ï¼Œæ•°å­¦çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><p>$$output=(input-mean)/std$$</p><p>è€Œå¯¹å›¾åƒè¿›è¡Œæ ‡å‡†åŒ–ï¼Œå°±æ˜¯å¯¹å›¾åƒçš„æ¯ä¸ªé€šé“åˆ©ç”¨å‡å€¼å’Œæ ‡å‡†å·®è¿›è¡Œæ­£åˆ™åŒ–ã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯<strong>ä¸ºäº†ä¿è¯æ•°æ®é›†ä¸­æ‰€æœ‰çš„å›¾åƒåˆ†å¸ƒéƒ½ç›¸ä¼¼ï¼Œè¿™æ ·åœ¨è®­ç»ƒçš„æ—¶å€™æ›´å®¹æ˜“æ”¶æ•›ï¼Œæ—¢åŠ å¿«äº†è®­ç»ƒé€Ÿåº¦ï¼Œä¹Ÿæé«˜äº†è®­ç»ƒæ•ˆæœ</strong>ã€‚</p><p>è®©æˆ‘æ¥è§£é‡Šä¸€ä¸‹ï¼šé¦–å…ˆï¼Œæ ‡å‡†åŒ–æ˜¯ä¸€ä¸ªå¸¸è§„åšæ³•ï¼Œå¯ä»¥ç†è§£ä¸ºæ— è„‘è¿›è¡Œæ ‡å‡†åŒ–åå†è®­ç»ƒçš„æ•ˆæœï¼Œå¤§æ¦‚ç‡è¦å¥½äºä¸è¿›è¡Œæ ‡å‡†åŒ–ã€‚</p><p>æˆ‘æŠŠæå®¢æ—¶é—´çš„LOGOè¯»å…¥åï¼Œæ‰€æœ‰åƒç´ éƒ½å‡å»50ï¼Œè·å¾—ä¸‹å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/a1/3c3f30cee39ec09cc08fa91b4925e3a1.png?wh=640x234\" alt=\"å›¾ç‰‡\"></p><p>å¯¹äºæˆ‘ä»¬äººæ¥è¯´æ˜¯å¯ä»¥åˆ†è¾¨å‡ºï¼Œè¿™ä¹Ÿæ˜¯æå®¢æ—¶é—´çš„LOGOã€‚ä½†æ˜¯è®¡ç®—æœºï¼ˆä¹Ÿå°±æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼‰å°±ä¸ä¸€å®šèƒ½åˆ†è¾¨å‡ºæ¥äº†ï¼Œå› ä¸ºå·ç§¯ç¥ç»ç½‘ç»œæ˜¯é€šè¿‡å›¾åƒçš„åƒç´ è¿›è¡Œæå–ç‰¹å¾çš„ï¼Œè¿™ä¸¤å¼ å›¾ç‰‡åƒç´ çš„æ•°å€¼éƒ½ä¸ä¸€æ ·ï¼Œå‡­ä»€ä¹ˆè¿˜è®©ç¥ç»ç½‘ç»œè®¤ä¸ºæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Ÿ</p><p>è€Œæ ‡å‡†åŒ–åçš„æ•°æ®å°±ä¼šé¿å…è¿™ä¸€é—®é¢˜ï¼Œæ ‡å‡†åŒ–åä¼šå°†æ•°æ®æ˜ å°„åˆ°åŒä¸€åŒºé—´ä¸­ï¼Œä¸€ä¸ªç±»åˆ«çš„å›¾ç‰‡è™½è¯´æœ‰çš„åƒç´ å€¼å¯èƒ½æœ‰å·®å¼‚ï¼Œä½†æ˜¯å®ƒä»¬åˆ†å¸ƒéƒ½æ˜¯ç±»ä¼¼çš„åˆ†å¸ƒã€‚</p><p><code>torchvision.transforms</code>æä¾›äº†å¯¹Tensorè¿›è¡Œæ ‡å‡†åŒ–çš„å‡½æ•°ï¼Œå®šä¹‰å¦‚ä¸‹ã€‚</p><pre><code class=\"language-plain\">torchvision.transforms.Normalize(mean, std, inplace=False)\n</code></pre><p>å…¶ä¸­ï¼Œæ¯ä¸ªå‚æ•°çš„å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul>\n<li>meanï¼šè¡¨ç¤ºå„é€šé“çš„å‡å€¼ï¼›</li>\n<li>stdï¼šè¡¨ç¤ºå„é€šé“çš„æ ‡å‡†å·®ï¼›</li>\n<li>inplaceï¼šè¡¨ç¤ºæ˜¯å¦åŸåœ°æ“ä½œï¼Œé»˜è®¤ä¸ºå¦ã€‚</li>\n</ul><p>ä»¥æå®¢æ—¶é—´çš„LOGOå›¾ç‰‡ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»¥(R, G, B)å‡å€¼å’Œæ ‡å‡†å·®å‡ä¸º(0.5, 0.5, 0.5)æ¥æ ‡å‡†åŒ–å›¾ç‰‡åï¼Œæ˜¯ä»€ä¹ˆæ•ˆæœã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n# å®šä¹‰æ ‡å‡†åŒ–æ“ä½œ\nnorm_oper = transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))\n\n# åŸå›¾\norig_img = Image.open('jk.jpg')&nbsp;\ndisplay(orig_img)\n\n# å›¾åƒè½¬åŒ–ä¸ºTensor\nimg_tensor = transforms.ToTensor()(orig_img)\n\n# æ ‡å‡†åŒ–\ntensor_norm = norm_oper(img_tensor)\n\n# Tensorè½¬åŒ–ä¸ºå›¾åƒ\nimg_norm = transforms.ToPILImage()(tensor_norm)\ndisplay(img_norm)\n</code></pre><p>ä¸Šé¢ä»£ç çš„è¿‡ç¨‹æ˜¯ï¼Œé¦–å…ˆå®šä¹‰äº†å‡å€¼å’Œæ ‡å‡†å·®å‡ä¸º(0.5, 0.5, 0.5)çš„æ ‡å‡†åŒ–æ“ä½œï¼Œç„¶åå°†åŸå›¾è½¬åŒ–ä¸ºTensorï¼Œæ¥ç€å¯¹Tensorè¿›è¡Œæ ‡å‡†åŒ–ï¼Œæœ€åå†å°†Tensorè½¬åŒ–ä¸ºå›¾åƒè¾“å‡ºã€‚</p><p>æ ‡å‡†åŒ–çš„æ•ˆæœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f5/05/f58f3662e60501e02b31b12fa9f4e905.jpg?wh=1244x515\" alt=\"\"></p><h3>å˜æ¢çš„ç»„åˆ</h3><p>å…¶å®å‰é¢ä»‹ç»è¿‡çš„æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥ç”¨ Compose ç±»ç»„åˆèµ·æ¥ï¼Œè¿›è¡Œè¿ç»­æ“ä½œã€‚</p><p>Composeç±»æ˜¯å°†å¤šä¸ªå˜æ¢ç»„åˆåˆ°ä¸€èµ·ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ã€‚</p><pre><code class=\"language-plain\">torchvision.transforms.Compose(transforms)\n</code></pre><p>å…¶ä¸­ï¼Œtransformsæ˜¯ä¸€ä¸ªTransformå¯¹è±¡çš„åˆ—è¡¨ï¼Œè¡¨ç¤ºè¦ç»„åˆçš„å˜æ¢åˆ—è¡¨ã€‚<br>\næˆ‘ä»¬è¿˜æ˜¯ç»“åˆä¾‹å­åŠ¨æ‰‹è¯•è¯•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å°†å›¾ç‰‡å˜ä¸º200*200åƒç´ å¤§å°ï¼Œå¹¶ä¸”éšæœºè£åˆ‡æˆ80åƒç´ çš„æ­£æ–¹å½¢ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»„åˆResizeå’ŒRandomCropå˜æ¢ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-python\">from PIL import Image\nfrom torchvision import transforms&nbsp;\n\n# åŸå›¾\norig_img = Image.open('jk.jpg')&nbsp;\ndisplay(orig_img)\n\n# å®šä¹‰ç»„åˆæ“ä½œ\ncomposed = transforms.Compose([transforms.Resize((200, 200)),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transforms.RandomCrop(80)])\n\n# ç»„åˆæ“ä½œåçš„å›¾\nimg = composed(orig_img)\ndisplay(img)\n</code></pre><p>è¿è¡Œçš„ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œä¹Ÿæ¨èä½ åŠ¨æ‰‹è¯•è¯•çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6b/c1/6b3ce280815cff443734c9b8180fc6c1.jpg?wh=1046x505\" alt=\"å›¾ç‰‡\"></p><h2>ç»“åˆdatasetsä½¿ç”¨</h2><p>Composeç±»æ˜¯æœªæ¥æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­ç»å¸¸è¦ä½¿ç”¨åˆ°çš„ç±»ï¼Œç»“åˆ<code>torchvision.datasets</code>åŒ…ï¼Œå°±å¯ä»¥åœ¨è¯»å–æ•°æ®é›†çš„æ—¶å€™åšå›¾åƒå˜æ¢ä¸æ•°æ®å¢å¼ºæ“ä½œã€‚ä¸‹é¢è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€çœ‹ã€‚</p><p>è¿˜è®°å¾—<a href=\"https://time.geekbang.org/column/article/429048\">ä¸Šä¸€èŠ‚è¯¾</a>ä¸­ï¼Œåœ¨åˆ©ç”¨<code>torchvision.datasets</code> è¯»å–MNISTæ•°æ®é›†æ—¶ï¼Œæœ‰ä¸€ä¸ªå‚æ•°â€œtransformâ€å—ï¼Ÿå®ƒå°±æ˜¯ç”¨äºå¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†æ“ä½œçš„ï¼Œä¾‹å¦‚æ•°æ®å¢å¼ºã€å½’ä¸€åŒ–ã€æ—‹è½¬æˆ–ç¼©æ”¾ç­‰ã€‚è¿™é‡Œçš„â€œtransformâ€å°±å¯ä»¥æ¥æ”¶ä¸€ä¸ª<code>torchvision.transforms</code>æ“ä½œæˆ–è€…ç”±Composeç±»æ‰€å®šä¹‰çš„æ“ä½œç»„åˆã€‚</p><p>ä¸ŠèŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬åœ¨è¯»å–MNISTæ•°æ®é›†æ—¶ï¼Œç›´æ¥è¯»å–å‡ºæ¥çš„å›¾åƒæ•°æ®æ˜¯PIL.Image.Imageç±»å‹çš„ã€‚ä½†æ˜¯é‡åˆ°è¦è®­ç»ƒæ‰‹å†™æ•°å­—è¯†åˆ«æ¨¡å‹è¿™ç±»çš„æƒ…å†µï¼Œæ¨¡å‹æ¥æ”¶çš„æ•°æ®ç±»å‹æ˜¯Tensorï¼Œè€Œä¸æ˜¯PILå¯¹è±¡ã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨â€œtransformâ€å‚æ•°ï¼Œä½¿æ•°æ®åœ¨è¯»å–çš„åŒæ—¶åšç±»å‹è½¬æ¢ï¼Œè¿™æ ·è¯»å–å‡ºçš„æ•°æ®ç›´æ¥å°±å¯ä»¥æ˜¯Tensorç±»å‹äº†ã€‚</p><p>ä¸åªæ˜¯æ•°æ®ç±»å‹çš„è½¬æ¢ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¢åŠ å½’ä¸€åŒ–ç­‰æ•°æ®å¢å¼ºçš„æ“ä½œï¼Œåªéœ€è¦ä½¿ç”¨ä¸Šé¢ä»‹ç»è¿‡çš„Composeç±»è¿›è¡Œç»„åˆå³å¯ã€‚è¿™æ ·ï¼Œåœ¨è¯»å–æ•°æ®çš„åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå°±å®Œæˆäº†æ•°æ®é¢„å¤„ç†ã€æ•°æ®å¢å¼ºç­‰ä¸€ç³»åˆ—æ“ä½œã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥è¯»å–MNISTæ•°æ®é›†ä¸ºä¾‹ï¼Œçœ‹ä¸‹å¦‚ä½•åœ¨è¯»å–æ•°æ®çš„åŒæ—¶ï¼Œå®Œæˆæ•°æ®é¢„å¤„ç†ç­‰æ“ä½œã€‚å…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p><pre><code class=\"language-python\">from torchvision import transforms\nfrom torchvision import datasets\n\n# å®šä¹‰ä¸€ä¸ªtransform\nmy_transform = transforms.Compose([transforms.ToTensor(),\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transforms.Normalize((0.5), (0.5))\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ])\n# è¯»å–MNISTæ•°æ®é›† åŒæ—¶åšæ•°æ®å˜æ¢\nmnist_dataset = datasets.MNIST(root='./data',\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;train=False,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform=my_transform,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;target_transform=None,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;download=True)\n\n# æŸ¥çœ‹å˜æ¢åçš„æ•°æ®ç±»å‹\nitem = mnist_dataset.__getitem__(0)\nprint(type(item[0]))\n'''\nè¾“å‡ºï¼š\n&lt;class 'torch.Tensor'&gt;\n'''\n</code></pre><p>å½“ç„¶ï¼ŒMNISTæ•°æ®é›†éå¸¸ç®€å•ï¼Œæ ¹æœ¬ä¸è¿›è¡Œä»»ä½•å¤„ç†ç›´æ¥è¯»å…¥çš„è¯ï¼Œæ•ˆæœä¹Ÿéå¸¸å¥½ï¼Œä½†æ˜¯å®ƒç¡®å®é€‚åˆå­¦ä¹ æ¥ä½¿ç”¨ï¼Œä½ å¯ä»¥åœ¨åˆ©ç”¨å®ƒè¿›è¡Œå„ç§å°è¯•ã€‚</p><p>æˆ‘ä»¬ä¸‹é¢å…ˆæ¥çœ‹çœ‹ï¼Œåœ¨å›¾åƒåˆ†ç±»å®æˆ˜ä¸­ä½¿ç”¨çš„transformï¼Œå¯ä»¥æ„Ÿå—ä¸€ä¸‹å®é™…ä½¿ç”¨çš„transformsæ˜¯ä»€ä¹ˆæ ·å­ï¼š</p><pre><code class=\"language-python\">transform = transforms.Compose([\n&nbsp; &nbsp; transforms.RandomResizedCrop(dest_image_size),\n&nbsp; &nbsp; transforms.RandomHorizontalFlip(),\n&nbsp; &nbsp; transforms.ToTensor(),\n&nbsp; &nbsp; transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\n&nbsp; &nbsp; ])\n</code></pre><p>è¿™ä¹Ÿæ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„transformã€‚æ•°æ®å¢å¼ºçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¸è¿‡æ ¹æ®æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œå¹¶ä¸æ˜¯ç”¨çš„è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ã€‚</p><h2>å°ç»“</h2><p>æ­å–œä½ å®Œæˆäº†è¿™èŠ‚è¯¾çš„å­¦ä¹ ï¼Œæˆ‘æ¥ç»™ä½ åšä¸ªæ€»ç»“ã€‚</p><p><strong>ä»Šå¤©çš„é‡ç‚¹å†…å®¹å°±æ˜¯<code>torchvision.transforms</code>å·¥å…·çš„ä½¿ç”¨ã€‚åŒ…æ‹¬å¸¸ç”¨çš„å›¾åƒå¤„ç†æ“ä½œï¼Œä»¥åŠå¦‚ä½•ä¸<code>torchvision.datasets</code>ç»“åˆä½¿ç”¨</strong>ã€‚</p><p>å¸¸ç”¨çš„å›¾åƒå¤„ç†æ“ä½œåŒ…æ‹¬æ•°æ®ç±»å‹è½¬æ¢ã€å›¾åƒå°ºå¯¸å˜åŒ–ã€å‰ªè£ã€ç¿»è½¬ã€æ ‡å‡†åŒ–ç­‰ç­‰ã€‚Composeç±»è¿˜å¯ä»¥å°†å¤šä¸ªå˜æ¢æ“ä½œç»„åˆæˆä¸€ä¸ªTransformå¯¹è±¡çš„åˆ—è¡¨ã€‚</p><p><code>torchvision.transforms</code>ä¸<code>torchvision.datasets</code>ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥åœ¨æ•°æ®åŠ è½½çš„åŒæ—¶è¿›è¡Œä¸€ç³»åˆ—å›¾åƒå˜æ¢ä¸æ•°æ®å¢å¼ºæ“ä½œï¼Œä¸ä»…èƒ½å¤Ÿç›´æ¥å°†æ•°æ®é€å…¥æ¨¡å‹è®­ç»ƒï¼Œè¿˜å¯ä»¥åŠ å¿«æ¨¡å‹æ”¶æ•›é€Ÿåº¦ï¼Œè®©æ¨¡å‹æ›´å¥½åœ°å­¦ä¹ åˆ°æ•°æ®ç‰¹å¾ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬åœ¨å®é™…çš„é¡¹ç›®ä¸­ä¼šæœ‰è‡ªå·±çš„æ•°æ®ï¼Œè€Œä¸ä¼šä½¿ç”¨torchvision.datasetsä¸­æä¾›çš„å…¬å¼€æ•°æ®é›†ï¼Œæˆ‘ä»¬ä»Šå¤©è®²çš„<code>torchvision.transforms</code> åŒæ ·å¯ä»¥åœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ•°æ®é›†ä¸­ä½¿ç”¨ï¼Œå…³äºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä¼šåœ¨å›¾åƒåˆ†ç±»çš„å®æˆ˜ä¸­ç»§ç»­è®²è§£ã€‚</p><p>ä¸‹èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šä»‹ç»Torchvisionä¸­å…¶ä»–æœ‰è¶£çš„åŠŸèƒ½ã€‚åŒ…æ‹¬ç»å…¸ç½‘ç»œæ¨¡å‹çš„å®ä¾‹åŒ–ä¸å…¶ä»–æœ‰ç”¨çš„å‡½æ•°ã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>Torchvisionä¸­ transforms æ¨¡å—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè·Ÿæˆ‘äº¤æµè®¨è®ºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™è‡ªå·±çš„æœ‹å‹ï¼Œå’Œä»–ä¸€èµ·å°è¯•ä¸€ä¸‹Torchvisionçš„å„ç§åŠŸèƒ½ã€‚</p>","neighbors":{"left":{"article_title":"06 | Torchvisionï¼ˆä¸Šï¼‰ï¼šæ•°æ®è¯»å–ï¼Œè®­ç»ƒå¼€å§‹çš„ç¬¬ä¸€æ­¥","id":429048},"right":{"article_title":"08 | Torchvisionï¼ˆä¸‹ï¼‰ï¼šå…¶ä»–æœ‰è¶£çš„åŠŸèƒ½","id":431420}},"comments":[{"had_liked":false,"id":318049,"user_name":"Yuhan","can_delete":false,"product_type":"c1","uid":2767570,"ip_address":"","ucode":"38CC135D8BBF67","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3a/d2/cbd2c882.jpg","comment_is_top":false,"comment_ctime":1635132544,"is_pvip":false,"replies":[{"id":"115308","content":"ä½ å¥½ï¼ŒYuhanï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚<br>displayçš„æ¥æºæ˜¯ï¼š<br>from IPython.display import display<br>åœ¨jupyterä¸­å¯ä»¥ç›´æ¥è°ƒç”¨æ— éœ€importã€‚^^","user_name":"ä½œè€…å›å¤","user_name_real":"æ–¹è¿œ","uid":"2802608","ctime":1635152521,"ip_address":"","comment_id":318049,"utype":1}],"discussion_count":5,"race_medal":0,"score":"31699903616","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæ„Ÿè§‰åº”è¯¥æ³¨æ˜ä¸€ä¸‹displayå‡½æ•°çš„æ¥æºï¼Œæ˜¯Ipython.display é‡Œé¢çš„displayå‡½æ•°å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529078,"discussion_content":"ä½ å¥½ï¼ŒYuhanï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚\ndisplayçš„æ¥æºæ˜¯ï¼š\nfrom IPython.display import display\nåœ¨jupyterä¸­å¯ä»¥ç›´æ¥è°ƒç”¨æ— éœ€importã€‚^^","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635152521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2808296,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEfHicUxzxCSKVXiaibn7OrmXGUFQjkesgvODymZz4kibzqOGxuRq42t3sB2ibcBIIGWRgSg/132","nickname":"è¶…äººä¸ä¼šé£","note":"","ucode":"6F67096D5FFAFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407909,"discussion_content":"å¯ä»¥å¯¼å…¥matplotåŒ…ï¼Œimport matplotlib.pyplot as plt,,,,,,ç„¶åæ˜¾ç¤ºå›¾åƒçš„æ—¶å€™è¿™ä¹ˆå†™ï¼Œplt.imshow(img)      plt.show()    å°±èƒ½æ˜¾ç¤ºå‡ºæ¥äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635148794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028956,"avatar":"","nickname":"å‹¿æ›´æ”¹ä»»ä½•ä¿¡æ¯","note":"","ucode":"575185C69C05A3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408388,"discussion_content":"è€å¸ˆï¼Œä»£ç éƒ¨åˆ†åœ¨githubä¸Šæœ‰å®Œæ•´é“¾æ¥å˜›ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635239012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2028956,"avatar":"","nickname":"å‹¿æ›´æ”¹ä»»ä½•ä¿¡æ¯","note":"","ucode":"575185C69C05A3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560612,"discussion_content":"hiï¼Œä¸å¥½æ„æ€ï¼Œæˆ‘åˆšçœ‹åˆ°ã€‚\næ–°å¼€ä¸€ä¸ªè¯„è®ºæˆ‘æœ‰æç¤ºèƒ½çœ‹åˆ°ï¼Œåœ¨ç•™è¨€ä¸‹é¢çš„ç•™è¨€æˆ‘æ²¡æœ‰æç¤ºï¼Œçœ‹ä¸åˆ°ã€‚ğŸ˜‚\nåé¢çš„å›¾åƒåˆ†ç±»å’Œå›¾åƒåˆ†å‰²æœ‰ä»£ç ã€‚å…¶ä½™è¯¾ç¨‹çš„ä»£ç åŸºæœ¬éƒ½æ˜¯å¯è¿è¡Œçš„ä»£ç ï¼ŒæŠŠè¯¾ç¨‹é‡Œçš„ä»£ç copyåˆ°notebooké‡Œéƒ½å¯ä»¥è¿è¡Œ~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1649404039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":408388,"ip_address":""},"score":560612,"extra":""}]},{"author":{"id":2808296,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEfHicUxzxCSKVXiaibn7OrmXGUFQjkesgvODymZz4kibzqOGxuRq42t3sB2ibcBIIGWRgSg/132","nickname":"è¶…äººä¸ä¼šé£","note":"","ucode":"6F67096D5FFAFA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407910,"discussion_content":"æˆ–è€…ä½ ä¸å¯¼åŒ…ï¼Œå¯ä»¥ç›´æ¥å†™img.show()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635148819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324177,"user_name":"ä¸Šå²¸å§ï¼ŒAdagio","can_delete":false,"product_type":"c1","uid":2704740,"ip_address":"","ucode":"0224857DAE0F79","user_header":"https://static001.geekbang.org/account/avatar/00/29/45/64/ab1fada2.jpg","comment_is_top":false,"comment_ctime":1638327069,"is_pvip":false,"replies":[{"id":"117652","content":"Hiï¼Œæ„Ÿè°¢ä½ çš„æé—®ã€‚<br>transforms.ToTensor()  ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªToTensorçš„å®ä¾‹ã€‚<br>transforms.ToTensor()(img)  æ˜¯æ‰§è¡Œäº†ToTensorä¸­çš„__call__æ–¹æ³•ï¼ˆå¦‚ä¸‹é“¾æ¥ï¼‰ã€‚<br>https:&#47;&#47;github.com&#47;pytorch&#47;vision&#47;blob&#47;main&#47;torchvision&#47;transforms&#47;transforms.py#L123<br>è¿™éƒ¨åˆ†å±äºPythonçš„çŸ¥è¯†ï¼Œè¯¦ç»†çš„å†…å®¹ä½ å¯ä»¥çœ‹çœ‹Pythonä¸­__call__çš„ä½œç”¨ã€‚ç®€å•æ¥è¯´__call__çš„ä½œç”¨æ˜¯ä½¿å®ä¾‹èƒ½å¤Ÿåƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚<br>transforms.ToPILImage()åŒç†ã€‚^^","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":"2802608","ctime":1638337086,"ip_address":"","comment_id":324177,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27408130845","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®<br><br>img1 = transforms.ToTensor()(img)<br>img2 = transforms.ToPILImage()(img1)<br><br>æ˜¯æ€ä¹ˆä½¿ç”¨çš„å‘¢ï¼Ÿ<br>transforms.ToTensoræ˜¯ä¸€ä¸ªç±»ï¼Œä¸ºä»€ä¹ˆä¸æŠŠimgå½“åšå‚æ•°ä¼ ç»™è¿™ä¸ªç±»åšåˆå§‹åŒ–å‘¢ï¼Ÿ<br>transforms.ToTensor()æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡å—ï¼Ÿä¸ºä»€ä¹ˆåé¢åˆç›´æ¥ä¼ å…¥äº†(img)å‚æ•°å‘¢ï¼Ÿ<br>ä¸å¤ªæ‡‚è¿™ä¸€å—çš„ç»†èŠ‚ï¼Œè¯·è€å¸ˆå¸®å¿™è§£ç­”ä¸‹~<br>","like_count":7,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535029,"discussion_content":"Hiï¼Œæ„Ÿè°¢ä½ çš„æé—®ã€‚\ntransforms.ToTensor()  ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªToTensorçš„å®ä¾‹ã€‚\ntransforms.ToTensor()(img)  æ˜¯æ‰§è¡Œäº†ToTensorä¸­çš„__call__æ–¹æ³•ï¼ˆå¦‚ä¸‹é“¾æ¥ï¼‰ã€‚\nhttps://github.com/pytorch/vision/blob/main/torchvision/transforms/transforms.py#L123\nè¿™éƒ¨åˆ†å±äºPythonçš„çŸ¥è¯†ï¼Œè¯¦ç»†çš„å†…å®¹ä½ å¯ä»¥çœ‹çœ‹Pythonä¸­__call__çš„ä½œç”¨ã€‚ç®€å•æ¥è¯´__call__çš„ä½œç”¨æ˜¯ä½¿å®ä¾‹èƒ½å¤Ÿåƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚\ntransforms.ToPILImage()åŒç†ã€‚^^","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1638337086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318557,"user_name":"vcjmhg","can_delete":false,"product_type":"c1","uid":1526461,"ip_address":"","ucode":"B508D1E9B3F974","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/j24oyxHcpB5AMR9pMO6fITqnOFVOncnk2T1vdu1rYLfq1cN6Sj7xVrBVbCvHXUad2MpfyBcE4neBguxmjIxyiaQ/132","comment_is_top":false,"comment_ctime":1635333002,"is_pvip":false,"replies":[{"id":"115502","content":"ä½ å¥½ï¼Œè°¢è°¢ç•™è¨€ã€‚å®Œç¾ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ã€‚ï¼šï¼‰åŠ æ²¹~","user_name":"ä½œè€…å›å¤","user_name_real":"æ–¹è¿œ","uid":"2802608","ctime":1635338781,"ip_address":"","comment_id":318557,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18815202186","product_id":100093301,"comment_content":"Torchvision ä¸­ transforms æ¨¡å—çš„ä½œç”¨ï¼šå°è£…äº†å¸¸ç”¨çš„å›¾åƒæ“ä½œï¼Œä¾‹éšæœºåˆ‡å‰²ã€æ—‹è½¬ã€æ•°æ®ç±»å‹è½¬æ¢ã€tensor ä¸ numpy å’Œ PIL Image çš„äº’æ¢ç­‰ã€‚","like_count":5,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529297,"discussion_content":"ä½ å¥½ï¼Œè°¢è°¢ç•™è¨€ã€‚å®Œç¾ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ã€‚ï¼šï¼‰åŠ æ²¹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635338781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326999,"user_name":"å¤©å‡‰å¥½ä¸ªç§‹","can_delete":false,"product_type":"c1","uid":2842361,"ip_address":"","ucode":"C61A17A9591C24","user_header":"https://static001.geekbang.org/account/avatar/00/2b/5e/f9/96896116.jpg","comment_is_top":false,"comment_ctime":1639823081,"is_pvip":false,"replies":[{"id":"118980","content":"Hi,<br>æ˜¯resizeä¸­çš„interpolationå‚æ•°ã€‚<br>ä¾‹å¦‚ï¼Œtorchvision.transforms.Resize((128, 128),  interpolation=InterpolationMode.BICUBICï¼‰ã€‚<br>è¿™ä¸ªå‚æ•°æ¥æ”¶intä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯å½“intçš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥è¿™ä¸ªwarningã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1639961621,"ip_address":"","comment_id":326999,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14524724969","product_id":100093301,"comment_content":"è€å¸ˆä½ å¥½ï¼Œåœ¨ä½¿ç”¨ Resize çš„æ—¶å€™ï¼Œå‡ºç°ä»¥ä¸‹ warning:<br><br>UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.<br><br>åœ¨ä¹‹å‰çš„å›ç­”ä¸­ç»™çš„è§£å†³æ–¹æ¡ˆçš„ç¬¬äºŒæ¡ï¼šå°†Image.BICUBIC æ›¿æ¢ä¸ºInterpolationMode.BICUBICï¼Œè¿™ä¸ªæ˜¯åœ¨å“ªå„¿æ›¿æ¢?transforms.pyçš„æºä»£ç ä¸­ä¹Ÿæ²¡æœ‰ç›¸å…³ä»£ç ","like_count":3,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540094,"discussion_content":"Hi,\næ˜¯resizeä¸­çš„interpolationå‚æ•°ã€‚\nä¾‹å¦‚ï¼Œtorchvision.transforms.Resize((128, 128),  interpolation=InterpolationMode.BICUBICï¼‰ã€‚\nè¿™ä¸ªå‚æ•°æ¥æ”¶intä¹Ÿå¯ä»¥ï¼Œå°±æ˜¯å½“intçš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥è¿™ä¸ªwarningã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639961621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331611,"user_name":"æ±¤ç«ç«ç«","can_delete":false,"product_type":"c1","uid":1663497,"ip_address":"","ucode":"98C75FCF358AF9","user_header":"https://static001.geekbang.org/account/avatar/00/19/62/09/7fd0634a.jpg","comment_is_top":false,"comment_ctime":1642669585,"is_pvip":false,"replies":[{"id":"121158","content":"ä½ å¥½ï¼Œæ±¤ç«ç«ç«ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>éœ€è¦ï¼Œé¢„æµ‹æ—¶æ•°æ®åšçš„é¢„å¤„ç†ï¼ˆæ ‡å‡†åŒ–ä¹‹ç±»çš„ï¼‰æ“ä½œè¦ä¸è®­ç»ƒæ—¶åšçš„é¢„å¤„ç†æ“ä½œä¸€æ¯›ä¸€æ ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1642733900,"ip_address":"","comment_id":331611,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10232604177","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œåœ¨è®­ç»ƒæ—¶å¯¹å›¾åƒåšäº†æ ‡å‡†åŒ–ï¼Œé‚£æµ‹è¯•çš„æ—¶å€™éœ€è¦å¯¹æµ‹è¯•å›¾åƒåšæ ‡å‡†åŒ–å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547527,"discussion_content":"ä½ å¥½ï¼Œæ±¤ç«ç«ç«ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\néœ€è¦ï¼Œé¢„æµ‹æ—¶æ•°æ®åšçš„é¢„å¤„ç†ï¼ˆæ ‡å‡†åŒ–ä¹‹ç±»çš„ï¼‰æ“ä½œè¦ä¸è®­ç»ƒæ—¶åšçš„é¢„å¤„ç†æ“ä½œä¸€æ¯›ä¸€æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642733900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1257152,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2e/c0/7ec23600.jpg","nickname":"ç¿","note":"","ucode":"838790C3D01A21","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556040,"discussion_content":"è€å¸ˆï¼Œé‚£åƒç¿»è½¬ä¹‹ç±»çš„é¢„å¤„ç†ï¼Œ ä¹Ÿéœ€è¦é¢„æµ‹å’Œè®­ç»ƒè¿›è¡ŒåŒæ ·çš„æ“ä½œä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647177881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2822701,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/12/2d/aba06a9a.jpg","nickname":"ææ³½","note":"","ucode":"136225FC58F164","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1257152,"avatar":"https://static001.geekbang.org/account/avatar/00/13/2e/c0/7ec23600.jpg","nickname":"ç¿","note":"","ucode":"838790C3D01A21","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":580660,"discussion_content":"æˆ‘è®¤ä¸ºåº”è¯¥æ˜¯çš„ï¼Œç›¸å½“äºè®­ç»ƒå’Œé¢„æµ‹éƒ½æ˜¯åŒä¸€ä¸ªé‡çº²ä¸‹çš„æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658308318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":556040,"ip_address":""},"score":580660,"extra":""}]}]},{"had_liked":false,"id":345488,"user_name":"äºšæ—","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1652325242,"is_pvip":false,"replies":[{"id":"126114","content":"ä½ å¥½ï¼Œäºšæ—<br>æ˜¯è¯´æ ‡å‡†åŒ–çš„å‚æ•°å¦‚ä½•ç¡®å®šçš„æ˜¯å§ã€‚<br>é€šå¸¸æ¥è¯´å¦‚æœä½¿ç”¨å…¶ä»–äººçš„æ¨¡å‹åšå¾®è°ƒçš„è¯ï¼Œå°±è¦ä¸åŸä½œè€…çš„æ•°æ®å¤„ç†æ–¹å¼ä¸€è‡´ï¼Œä¾‹å¦‚åé¢çš„å›¾åƒåˆ†ç±»ä¸­è®²çš„EfficientNetã€‚æˆ‘æƒ³è¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ†ä¼šé‡åˆ°çš„æƒ…å†µã€‚<br>å¦‚æœæ˜¯å®Œå…¨è‡ªå·±é‡æ–°è®­ç»ƒçš„è¯ï¼Œå¯ä»¥å‚è€ƒä¸€äº›ImageNetä¸Šçš„é¢„å¤„ç†æ–¹å¼ï¼Œå…¶å®ä¹Ÿå°±é‚£å‡ ç§ï¼Œå‡å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ä¹‹ç±»çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1652409910,"ip_address":"","comment_id":345488,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5947292538","product_id":100093301,"comment_content":"Torchvision ä¸­ transforms æ¨¡å—çš„ä½œç”¨å›¾åƒæ•°æ®çš„é¢„å¤„ç†ã€‚æ€ä¹ˆæ ‡å‡†åŒ–ï¼Œè¿™äº›æ ‡å‡†åŒ–å‚æ•°æ˜¯å¦‚ä½•ç¡®å®šçš„ç±»ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571788,"discussion_content":"ä½ å¥½ï¼Œäºšæ—\næ˜¯è¯´æ ‡å‡†åŒ–çš„å‚æ•°å¦‚ä½•ç¡®å®šçš„æ˜¯å§ã€‚\né€šå¸¸æ¥è¯´å¦‚æœä½¿ç”¨å…¶ä»–äººçš„æ¨¡å‹åšå¾®è°ƒçš„è¯ï¼Œå°±è¦ä¸åŸä½œè€…çš„æ•°æ®å¤„ç†æ–¹å¼ä¸€è‡´ï¼Œä¾‹å¦‚åé¢çš„å›¾åƒåˆ†ç±»ä¸­è®²çš„EfficientNetã€‚æˆ‘æƒ³è¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ†ä¼šé‡åˆ°çš„æƒ…å†µã€‚\nå¦‚æœæ˜¯å®Œå…¨è‡ªå·±é‡æ–°è®­ç»ƒçš„è¯ï¼Œå¯ä»¥å‚è€ƒä¸€äº›ImageNetä¸Šçš„é¢„å¤„ç†æ–¹å¼ï¼Œå…¶å®ä¹Ÿå°±é‚£å‡ ç§ï¼Œå‡å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ä¹‹ç±»çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652409910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323714,"user_name":"å¿«å¿«ğŸ”¥","can_delete":false,"product_type":"c1","uid":2854084,"ip_address":"","ucode":"0B84A21884C25E","user_header":"https://static001.geekbang.org/account/avatar/00/2b/8c/c4/9fbe78cf.jpg","comment_is_top":false,"comment_ctime":1638110218,"is_pvip":false,"replies":[{"id":"117501","content":"hiï¼Œä½ å¥½ã€‚æ„Ÿè°¢ç•™è¨€ã€‚è¾“å…¥ç»™æ¨¡å‹çš„æ•°æ®æ˜¯è½¬æ¢åçš„æ•°æ®ã€‚åŸå§‹å›¾åƒä¸ä¼šå˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1638147901,"ip_address":"","comment_id":323714,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5933077514","product_id":100093301,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹ï¼Œåœ¨transform.dataset()ä¸­è¿›è¡Œtransformsçš„è½¬æ¢æ“ä½œï¼Œæ˜¯ä¼šå°†åŸå›¾åƒæ•°æ®è¦†ç›–æ‰å—ï¼Œè¿˜æ˜¯äº§ç”Ÿæ–°çš„è½¬æ¢åçš„æ•°æ®ã€‚","like_count":1,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534237,"discussion_content":"hiï¼Œä½ å¥½ã€‚æ„Ÿè°¢ç•™è¨€ã€‚è¾“å…¥ç»™æ¨¡å‹çš„æ•°æ®æ˜¯è½¬æ¢åçš„æ•°æ®ã€‚åŸå§‹å›¾åƒä¸ä¼šå˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638147901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357041,"user_name":"é—®é¼è‹ç©¹","can_delete":false,"product_type":"c1","uid":3169115,"ip_address":"åŒ—äº¬","ucode":"C059352076D92C","user_header":"https://static001.geekbang.org/account/avatar/00/30/5b/5b/1804b22f.jpg","comment_is_top":false,"comment_ctime":1662882319,"is_pvip":false,"replies":[{"id":"129995","content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚<br>åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æˆ‘æ²¡è¯•è¿‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1663055992,"ip_address":"åŒ—äº¬","comment_id":357041,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662882319","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œtransformsæ˜¯åªèƒ½å¯¹å›¾åƒçš„tensoræ•°æ®è¿›è¡Œå¤„ç†æ˜¯å§ï¼Œå¯¹äºè¡¨æ ¼ç±»å‹çš„æ•°æ®æ˜¯ä¸èƒ½è¿›è¡Œæ•°æ®å¢å¼ºçš„æ“ä½œæ˜¯å—ï¼Œå¦‚æœè¦å¯¹è¡¨æ ¼ç±»å‹çš„æ•°æ®è¿›è¡Œæ•°æ®å¢å¼ºåº”è¯¥å¦‚ä½•æ“ä½œå‘¢","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587439,"discussion_content":"ä½ å¥½ï¼Œæ„Ÿè°¢ç•™è¨€ã€‚\nåº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡æˆ‘æ²¡è¯•è¿‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663055993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356994,"user_name":"ğŸ°","can_delete":false,"product_type":"c1","uid":3169524,"ip_address":"åŒ—äº¬","ucode":"DB5753473F7E9E","user_header":"https://static001.geekbang.org/account/avatar/00/30/5c/f4/70270989.jpg","comment_is_top":false,"comment_ctime":1662809686,"is_pvip":false,"replies":[{"id":"129992","content":"ä½ å¥½ï¼Œåœ¨å“ªé‡Œè¿è¡Œçš„ï¼Ÿè¿è¡Œçš„å“ªä¸€æ®µä»£ç ï¼Ÿ<br>","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1663055494,"ip_address":"åŒ—äº¬","comment_id":356994,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1662809686","product_id":100093301,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œæˆ‘åœ¨è¿è¡Œæ—¶æœ€åç»“æœä¸æ˜¾ç¤ºå›¾ç‰‡åªæ˜¾ç¤ºæ ‡ç­¾æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587436,"discussion_content":"ä½ å¥½ï¼Œåœ¨å“ªé‡Œè¿è¡Œçš„ï¼Ÿè¿è¡Œçš„å“ªä¸€æ®µä»£ç ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663055494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353064,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"åŒ—äº¬","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1659108217,"is_pvip":true,"replies":[{"id":"128538","content":"ğŸ‘ğŸ»^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1659508632,"ip_address":"åŒ—äº¬","comment_id":353064,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1659108217","product_id":100093301,"comment_content":"åŠ ä¸Šé€—å·è§£å†³ï¼štoo many indices for tensor of dimension 0<br>The problem is that the mean and std have to be sequences (e.g., tuples), therefore you should add a comma after the values:<br><br><br># å®šä¹‰ä¸€ä¸ªtransform<br>my_transform = transforms.Compose([transforms.ToTensor(),<br>                                   transforms.Normalize((0.5,), (0.5,))<br><br>ref: https:&#47;&#47;stackoverflow.com&#47;questions&#47;56745486&#47;pytorch-dataloader-indexerror-too-many-indices-for-tensor-of-dimension-0","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582555,"discussion_content":"ğŸ‘ğŸ»^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659508632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":353063,"user_name":"John(æ˜“ç­‹)","can_delete":false,"product_type":"c1","uid":1180202,"ip_address":"é™•è¥¿","ucode":"BB4E58DD4B8F15","user_header":"https://static001.geekbang.org/account/avatar/00/12/02/2a/90e38b94.jpg","comment_is_top":false,"comment_ctime":1659107974,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1659107974","product_id":100093301,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ æ‰§è¡ŒæŠ¥é”™<br>my_transform = transforms.Compose([transforms.ToTensor(),<br>                                   transforms.Normalize((0.5), (0.5))<br>                                  ])<br>mnist_dataset = datasets.MNIST(root=&#39;.&#47;data&#39;,<br>                               train=False,<br>                               transform=my_transform,<br>                               target_transform=None,<br>                               download=True)<br>item = mnist_dataset.__getitem__(0)<br>print(type(item[0]))<br><br>---------<br>IndexError                                Traceback (most recent call last)<br>&lt;ipython-input-1-bc3a8de1cbd4&gt; in &lt;module&gt;<br>     14 <br>     15 # æŸ¥çœ‹å˜æ¢åçš„æ•°æ®ç±»å‹<br>---&gt; 16 item = mnist_dataset.__getitem__(0)<br>     17 print(type(item[0]))<br><br>~&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;torchvision&#47;datasets&#47;mnist.py in __getitem__(self, index)<br>     93 <br>     94         if self.transform is not None:<br>---&gt; 95             img = self.transform(img)<br>     96 <br>     97         if self.target_transform is not None:<br><br>~&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;torchvision&#47;transforms&#47;transforms.py in __call__(self, img)<br>     58     def __call__(self, img):<br>     59         for t in self.transforms:<br>---&gt; 60             img = t(img)<br>     61         return img<br>     62 <br><br>~&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;torchvision&#47;transforms&#47;transforms.py in __call__(self, tensor)<br>    161             Tensor: Normalized Tensor image.<br>    162         &quot;&quot;&quot;<br>--&gt; 163         return F.normalize(tensor, self.mean, self.std, self.inplace)<br>    164 <br>    165     def __repr__(self):<br><br>~&#47;opt&#47;anaconda3&#47;lib&#47;python3.8&#47;site-packages&#47;torchvision&#47;transforms&#47;functional.py in normalize(tensor, mean, std, inplace)<br>    206     mean = torch.tensor(mean, dtype=torch.float32)<br>    207     std = torch.tensor(std, dtype=torch.float32)<br>--&gt; 208     tensor.sub_(mean[:, None, None]).div_(std[:, None, None])<br>    209     return tensor<br>    210 <br><br>IndexError: too many indices for tensor of dimension 0<br>","like_count":0},{"had_liked":false,"id":339490,"user_name":"Geek_b454ca","can_delete":false,"product_type":"c1","uid":2953092,"ip_address":"","ucode":"BA54BEFEF42321","user_header":"","comment_is_top":false,"comment_ctime":1648128742,"is_pvip":false,"replies":[{"id":"124327","content":"ä½ å¥½ï¼Œä½ è¯´çš„æ˜¯è¡Œåˆ—äºŒç»´è¡¨é‚£ç§æ•°æ®å—ï¼Ÿ<br>ä¼¼ä¹æ˜¯æ²¡æœ‰ï¼Œä½ å¯ä»¥æŸ¥æŸ¥ã€‚^^","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1648540479,"ip_address":"","comment_id":339490,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648128742","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒTorchvisionä¸­æœ‰transformè¿™äº›å¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–çš„å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯è¦å¤„ç†å›¾åƒæ•°æ®ï¼Œåœ¨pytorchä¸­æ˜¯ä¸æ˜¯ä¹Ÿæœ‰ç±»ä¼¼çš„å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ç­‰transformæ“ä½œçš„å‡½æ•°å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558981,"discussion_content":"ä½ å¥½ï¼Œä½ è¯´çš„æ˜¯è¡Œåˆ—äºŒç»´è¡¨é‚£ç§æ•°æ®å—ï¼Ÿ\nä¼¼ä¹æ˜¯æ²¡æœ‰ï¼Œä½ å¯ä»¥æŸ¥æŸ¥ã€‚^^","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648540479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336918,"user_name":"é»‘æš—éª‘å£«","can_delete":false,"product_type":"c1","uid":2710847,"ip_address":"","ucode":"2A1C89298DD0D1","user_header":"https://static001.geekbang.org/account/avatar/00/29/5d/3f/ad1fed4a.jpg","comment_is_top":false,"comment_ctime":1646467152,"is_pvip":false,"replies":[{"id":"123173","content":"å—¯å—¯ï¼Œæ˜¯çš„ã€‚æ ‡ç­¾æ²¡æœ‰å˜ã€‚<br>åŸå§‹æ•°æ®æ˜¯(image, target) è¿™æ ·çš„å½¢å¼ï¼Œåªæ˜¯å¯¹imageè¿›è¡Œäº†å˜æ¢ï¼Œè€Œä¸æ˜¯æ–°å¢ä¸€äº›æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1646630775,"ip_address":"","comment_id":336918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646467152","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œ<br>è¿™èŠ‚è¯¾æˆ‘ä»¬å¯¹äºæ•°æ®æœ¬èº«è¿›è¡Œäº†ä¸€ç³»åˆ—æ“ä½œï¼Œè¯·é—®ç›¸åº”çš„æ ‡ç­¾å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæ˜¯ä¸æ˜¯ä¼šè‡ªåŠ¨åŒ¹é…ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554820,"discussion_content":"å—¯å—¯ï¼Œæ˜¯çš„ã€‚æ ‡ç­¾æ²¡æœ‰å˜ã€‚\nåŸå§‹æ•°æ®æ˜¯(image, target) è¿™æ ·çš„å½¢å¼ï¼Œåªæ˜¯å¯¹imageè¿›è¡Œäº†å˜æ¢ï¼Œè€Œä¸æ˜¯æ–°å¢ä¸€äº›æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646630775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323948,"user_name":"å¾æ´²æ›´","can_delete":false,"product_type":"c1","uid":1314643,"ip_address":"","ucode":"F8A323CB732D05","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/53/92a50f01.jpg","comment_is_top":false,"comment_ctime":1638237477,"is_pvip":true,"replies":[{"id":"117545","content":"ä½ å¥½ï¼Œå¾æ´²æ›´ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ•°æ®é›†ä¹Ÿå¯ä»¥ä½¿ç”¨transforms.Composeå¯¹æ•°æ®è¿›è¡Œå˜æ¢.<br>åœ¨å›¾åƒåˆ†ç±»(ä¸‹)ä¸­,å°±ä¼šç”¨åˆ°.","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1638250394,"ip_address":"","comment_id":323948,"utype":1},{"id":"117546","content":"ä½ å¥½ï¼Œå¾æ´²æ›´ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ•°æ®é›†ä¹Ÿå¯ä»¥ä½¿ç”¨transforms.Composeå¯¹æ•°æ®è¿›è¡Œå˜æ¢.<br>åœ¨å›¾åƒåˆ†ç±»(ä¸‹)ä¸­,å°±ä¼šç”¨åˆ°.","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2802608","ctime":1638250394,"ip_address":"","comment_id":323948,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1638237477","product_id":100093301,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå¯¹äºtorchvisionæä¾›çš„datasets, å¯ä»¥åº”ç”¨æˆ‘ä»¬å®šä¹‰çš„transforms.Compose, åœ¨è¯»å–æ—¶åŒæ—¶åšæ•°æ®å˜æ¢ã€‚ é‚£ä¹ˆå¯¹äºæˆ‘ä»¬è‡ªå·±çš„å›¾åƒæ•°æ®é›†ï¼Œæ˜¯ä¸æ˜¯åªèƒ½å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä¸€è¾¹è¯»å–æˆtensorï¼Œç„¶åä¸€è¾¹å¤„ç†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534650,"discussion_content":"ä½ å¥½ï¼Œå¾æ´²æ›´ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ•°æ®é›†ä¹Ÿå¯ä»¥ä½¿ç”¨transforms.Composeå¯¹æ•°æ®è¿›è¡Œå˜æ¢.\nåœ¨å›¾åƒåˆ†ç±»(ä¸‹)ä¸­,å°±ä¼šç”¨åˆ°.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638250394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534649,"discussion_content":"ä½ å¥½ï¼Œå¾æ´²æ›´ï¼Œæ„Ÿè°¢ä½ çš„ç•™è¨€ã€‚æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ•°æ®é›†ä¹Ÿå¯ä»¥ä½¿ç”¨transforms.Composeå¯¹æ•°æ®è¿›è¡Œå˜æ¢.\nåœ¨å›¾åƒåˆ†ç±»(ä¸‹)ä¸­,å°±ä¼šç”¨åˆ°.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638250394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320214,"user_name":"é©¬å…‹å›¾å¸ƒ","can_delete":false,"product_type":"c1","uid":1019274,"ip_address":"","ucode":"9E3879D6A55244","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/8a/ec29ca4a.jpg","comment_is_top":false,"comment_ctime":1636130517,"is_pvip":false,"replies":[{"id":"116179","content":"ä½ å¥½ï¼Œé©¬å…‹å›¾å¸ƒï¼Œè°¢è°¢ä½ çš„ç•™è¨€ã€‚<br>warningå¯ä»¥å¿½ç•¥ã€‚<br>è¿™ä¸»è¦æ˜¯ç”±äºpillowåŒ…&#47;ImageåŒ…æ’å€¼æ¨¡å¼é€ æˆçš„ã€‚<br>è§£å†³æ–¹æ¡ˆï¼š<br>1. å¯¼å…¥from torchvision.transforms import InterpolationMode<br>2. å°†Image.BICUBIC æ›¿æ¢ä¸ºInterpolationMode.BICUBIC","user_name":"ä½œè€…å›å¤","user_name_real":"æ–¹è¿œ","uid":"2802608","ctime":1636349479,"ip_address":"","comment_id":320214,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636130517","product_id":100093301,"comment_content":"è€å¸ˆï¼Œåœ¨ä½¿ç”¨ Resize çš„æ—¶å€™ï¼Œå‡ºç°ä»¥ä¸‹ warning:<br><br>UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.<br><br>è¿™ä¸ªæ˜¯å¯ä»¥ç›´æ¥å¿½ç•¥çš„å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529919,"discussion_content":"ä½ å¥½ï¼Œé©¬å…‹å›¾å¸ƒï¼Œè°¢è°¢ä½ çš„ç•™è¨€ã€‚\nwarningå¯ä»¥å¿½ç•¥ã€‚\nè¿™ä¸»è¦æ˜¯ç”±äºpillowåŒ…/ImageåŒ…æ’å€¼æ¨¡å¼é€ æˆçš„ã€‚\nè§£å†³æ–¹æ¡ˆï¼š\n1. å¯¼å…¥from torchvision.transforms import InterpolationMode\n2. å°†Image.BICUBIC æ›¿æ¢ä¸ºInterpolationMode.BICUBIC","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636349479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318256,"user_name":"æ —ç™½","can_delete":false,"product_type":"c1","uid":2810401,"ip_address":"","ucode":"8B0FBE195DA8B8","user_header":"https://static001.geekbang.org/account/avatar/00/2a/e2/21/3bb82a79.jpg","comment_is_top":false,"comment_ctime":1635217125,"is_pvip":false,"replies":[{"id":"115503","content":"ä½ å¥½ï¼Œã€‚ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»æ­£ç¡®^^ã€‚<br>åŒ…å«å¸¸ç”¨çš„å›¾åƒæ“ä½œï¼Œä¾‹å¦‚éšæœºåˆ‡å‰²ã€æ—‹è½¬ã€Tensor ä¸ Numpy å’Œ PIL Image çš„æ•°æ®ç±»å‹è½¬æ¢ç­‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æ–¹è¿œ","uid":"2802608","ctime":1635338828,"ip_address":"","comment_id":318256,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635217125","product_id":100093301,"comment_content":"æ˜¯å›¾åƒçš„é¢„å¤„ç†æ“ä½œã€‚","like_count":0,"discussions":[{"author":{"id":2802608,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1ZkL9L7CEicI87xicpIhXAIhVdVWpJKBsD8Jpzg9iaAwFcDEhTvdRwuKItJS14mYznT2w2YQvn8QsQ/132","nickname":"æ–¹è¿œ","note":"","ucode":"248B1DE180EB4C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529156,"discussion_content":"ä½ å¥½ï¼Œã€‚ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ»æ­£ç¡®^^ã€‚\nåŒ…å«å¸¸ç”¨çš„å›¾åƒæ“ä½œï¼Œä¾‹å¦‚éšæœºåˆ‡å‰²ã€æ—‹è½¬ã€Tensor ä¸ Numpy å’Œ PIL Image çš„æ•°æ®ç±»å‹è½¬æ¢ç­‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635338828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}