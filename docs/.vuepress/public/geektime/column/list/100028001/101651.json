{"id":101651,"title":"13 | å¤šçº¿ç¨‹ä¹‹é”ä¼˜åŒ–ï¼ˆä¸­ï¼‰ï¼šæ·±å…¥äº†è§£LockåŒæ­¥é”çš„ä¼˜åŒ–æ–¹æ³•","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>ä»Šå¤©è¿™è®²æˆ‘ä»¬ç»§ç»­æ¥èŠèŠé”ä¼˜åŒ–ã€‚ä¸Šä¸€è®²æˆ‘é‡ç‚¹ä»‹ç»äº†åœ¨JVMå±‚å®ç°çš„SynchronizedåŒæ­¥é”çš„ä¼˜åŒ–æ–¹æ³•ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåœ¨JDK1.5ä¹‹åï¼ŒJavaè¿˜æä¾›äº†LockåŒæ­¥é”ã€‚é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆä¼˜åŠ¿å‘¢ï¼Ÿ</p><p>ç›¸å¯¹äºéœ€è¦JVMéšå¼è·å–å’Œé‡Šæ”¾é”çš„SynchronizedåŒæ­¥é”ï¼ŒLockåŒæ­¥é”ï¼ˆä»¥ä¸‹ç®€ç§°Locké”ï¼‰éœ€è¦çš„æ˜¯æ˜¾ç¤ºè·å–å’Œé‡Šæ”¾é”ï¼Œè¿™å°±ä¸ºè·å–å’Œé‡Šæ”¾é”æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ã€‚<span class=\"orange\">Locké”çš„åŸºæœ¬æ“ä½œæ˜¯é€šè¿‡ä¹è§‚é”æ¥å®ç°çš„ï¼Œä½†ç”±äºLocké”ä¹Ÿä¼šåœ¨é˜»å¡æ—¶è¢«æŒ‚èµ·ï¼Œå› æ­¤å®ƒä¾ç„¶å±äºæ‚²è§‚é”ã€‚</span>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€å¼ å›¾æ¥ç®€å•å¯¹æ¯”ä¸‹ä¸¤ä¸ªåŒæ­¥é”ï¼Œäº†è§£ä¸‹å„è‡ªçš„ç‰¹ç‚¹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/8e/3d/8ec55dc637830f728e505c673fefde3d.jpg?wh=1238*660\" alt=\"\"></p><p>ä»æ€§èƒ½æ–¹é¢ä¸Šæ¥è¯´ï¼Œåœ¨å¹¶å‘é‡ä¸é«˜ã€ç«äº‰ä¸æ¿€çƒˆçš„æƒ…å†µä¸‹ï¼ŒSynchronizedåŒæ­¥é”ç”±äºå…·æœ‰åˆ†çº§é”çš„ä¼˜åŠ¿ï¼Œæ€§èƒ½ä¸Šä¸Locké”å·®ä¸å¤šï¼›ä½†åœ¨é«˜è´Ÿè½½ã€é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒSynchronizedåŒæ­¥é”ç”±äºç«äº‰æ¿€çƒˆä¼šå‡çº§åˆ°é‡é‡çº§é”ï¼Œæ€§èƒ½åˆ™æ²¡æœ‰Locké”ç¨³å®šã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ç»„ç®€å•çš„æ€§èƒ½æµ‹è¯•ï¼Œç›´è§‚åœ°å¯¹æ¯”ä¸‹ä¸¤ç§é”çš„æ€§èƒ½ï¼Œç»“æœè§ä¸‹æ–¹ï¼Œä»£ç å¯ä»¥åœ¨<a href=\"https://github.com/nickliuchao/syncLockTest\">Github</a>ä¸Šä¸‹è½½æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5c/b4/5c71e1402407e8970f51f9253fb716b4.jpg?wh=2120*922\" alt=\"\"></p><p>é€šè¿‡ä»¥ä¸Šæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šLocké”çš„æ€§èƒ½ç›¸å¯¹æ¥è¯´æ›´åŠ ç¨³å®šã€‚é‚£å®ƒä¸ä¸Šä¸€è®²çš„SynchronizedåŒæ­¥é”ç›¸æ¯”ï¼Œå®ç°åŸç†åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><h2>Locké”çš„å®ç°åŸç†</h2><p>Locké”æ˜¯åŸºäºJavaå®ç°çš„é”ï¼ŒLockæ˜¯ä¸€ä¸ªæ¥å£ç±»ï¼Œå¸¸ç”¨çš„å®ç°ç±»æœ‰ReentrantLockã€ReentrantReadWriteLockï¼ˆRRWï¼‰ï¼Œå®ƒä»¬éƒ½æ˜¯ä¾èµ–AbstractQueuedSynchronizerï¼ˆAQSï¼‰ç±»å®ç°çš„ã€‚</p><p>AQSç±»ç»“æ„ä¸­åŒ…å«ä¸€ä¸ªåŸºäºé“¾è¡¨å®ç°çš„ç­‰å¾…é˜Ÿåˆ—ï¼ˆCLHé˜Ÿåˆ—ï¼‰ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰é˜»å¡çš„çº¿ç¨‹ï¼ŒAQSä¸­è¿˜æœ‰ä¸€ä¸ªstateå˜é‡ï¼Œè¯¥å˜é‡å¯¹ReentrantLockæ¥è¯´è¡¨ç¤ºåŠ é”çŠ¶æ€ã€‚</p><p>è¯¥é˜Ÿåˆ—çš„æ“ä½œå‡é€šè¿‡CASæ“ä½œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€å¼ å›¾æ¥çœ‹ä¸‹æ•´ä¸ªè·å–é”çš„æµç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/22/33/222196b8c410ff4ffca7131faa19d833.jpg?wh=836*1240\" alt=\"\"></p><h2>é”åˆ†ç¦»ä¼˜åŒ–LockåŒæ­¥é”</h2><p>è™½ç„¶Locké”çš„æ€§èƒ½ç¨³å®šï¼Œä½†ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰çš„åœºæ™¯ä¸‹éƒ½é»˜è®¤ä½¿ç”¨ReentrantLockç‹¬å é”æ¥å®ç°çº¿ç¨‹åŒæ­¥ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºåŒä¸€ä»½æ•°æ®è¿›è¡Œè¯»å†™ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨è¯»æ•°æ®ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨å†™æ•°æ®ï¼Œé‚£ä¹ˆè¯»åˆ°çš„æ•°æ®å’Œæœ€ç»ˆçš„æ•°æ®å°±ä¼šä¸ä¸€è‡´ï¼›å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨å†™æ•°æ®ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿåœ¨å†™æ•°æ®ï¼Œé‚£ä¹ˆçº¿ç¨‹å‰åçœ‹åˆ°çš„æ•°æ®ä¹Ÿä¼šä¸ä¸€è‡´ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨è¯»å†™æ–¹æ³•ä¸­åŠ å…¥äº’æ–¥é”ï¼Œæ¥ä¿è¯ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè¯»æˆ–å†™æ“ä½œã€‚</p><p>åœ¨å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè¯»ä¸šåŠ¡æ“ä½œè¦è¿œè¿œå¤§äºå†™ä¸šåŠ¡æ“ä½œã€‚è€Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œè¯»æ“ä½œå¹¶ä¸ä¼šä¿®æ”¹å…±äº«èµ„æºçš„æ•°æ®ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹ä»…ä»…æ˜¯è¯»å–å…±äº«èµ„æºï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹å…¶å®æ²¡æœ‰å¿…è¦å¯¹èµ„æºè¿›è¡ŒåŠ é”ã€‚å¦‚æœä½¿ç”¨äº’æ–¥é”ï¼Œåå€’ä¼šå½±å“ä¸šåŠ¡çš„å¹¶å‘æ€§èƒ½ï¼Œé‚£ä¹ˆåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ä¼˜åŒ–ä¸‹é”çš„å®ç°æ–¹å¼å‘¢ï¼Ÿ</p><h3>1.è¯»å†™é”ReentrantReadWriteLock</h3><p>é’ˆå¯¹è¿™ç§è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼ŒJavaæä¾›äº†å¦å¤–ä¸€ä¸ªå®ç°Lockæ¥å£çš„è¯»å†™é”RRWã€‚æˆ‘ä»¬å·²çŸ¥ReentrantLockæ˜¯ä¸€ä¸ªç‹¬å é”ï¼ŒåŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œè€ŒRRWå…è®¸å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œä½†ä¸å…è®¸å†™çº¿ç¨‹å’Œè¯»çº¿ç¨‹ã€å†™çº¿ç¨‹å’Œå†™çº¿ç¨‹åŒæ—¶è®¿é—®ã€‚è¯»å†™é”å†…éƒ¨ç»´æŠ¤äº†ä¸¤ä¸ªé”ï¼Œä¸€ä¸ªæ˜¯ç”¨äºè¯»æ“ä½œçš„ReadLockï¼Œä¸€ä¸ªæ˜¯ç”¨äºå†™æ“ä½œçš„WriteLockã€‚</p><p>é‚£è¯»å†™é”åˆæ˜¯å¦‚ä½•å®ç°é”åˆ†ç¦»æ¥ä¿è¯å…±äº«èµ„æºçš„åŸå­æ€§å‘¢ï¼Ÿ</p><p>RRWä¹Ÿæ˜¯åŸºäºAQSå®ç°çš„ï¼Œå®ƒçš„è‡ªå®šä¹‰åŒæ­¥å™¨ï¼ˆç»§æ‰¿AQSï¼‰éœ€è¦åœ¨åŒæ­¥çŠ¶æ€stateä¸Šç»´æŠ¤å¤šä¸ªè¯»çº¿ç¨‹å’Œä¸€ä¸ªå†™çº¿ç¨‹çš„çŠ¶æ€ï¼Œè¯¥çŠ¶æ€çš„è®¾è®¡æˆä¸ºå®ç°è¯»å†™é”çš„å…³é”®ã€‚RRWå¾ˆå¥½åœ°ä½¿ç”¨äº†é«˜ä½ä½ï¼Œæ¥å®ç°ä¸€ä¸ªæ•´å‹æ§åˆ¶ä¸¤ç§çŠ¶æ€çš„åŠŸèƒ½ï¼Œè¯»å†™é”å°†å˜é‡åˆ‡åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œé«˜16ä½è¡¨ç¤ºè¯»ï¼Œä½16ä½è¡¨ç¤ºå†™ã€‚</p><p><strong>ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–å†™é”æ—¶ï¼Œ</strong>ä¼šå…ˆåˆ¤æ–­åŒæ­¥çŠ¶æ€stateæ˜¯å¦ä¸º0ã€‚å¦‚æœstateç­‰äº0ï¼Œè¯´æ˜æš‚æ—¶æ²¡æœ‰å…¶å®ƒçº¿ç¨‹è·å–é”ï¼›å¦‚æœstateä¸ç­‰äº0ï¼Œåˆ™è¯´æ˜æœ‰å…¶å®ƒçº¿ç¨‹è·å–äº†é”ã€‚</p><p>æ­¤æ—¶å†åˆ¤æ–­åŒæ­¥çŠ¶æ€stateçš„ä½16ä½ï¼ˆwï¼‰æ˜¯å¦ä¸º0ï¼Œå¦‚æœwä¸º0ï¼Œåˆ™è¯´æ˜å…¶å®ƒçº¿ç¨‹è·å–äº†è¯»é”ï¼Œæ­¤æ—¶è¿›å…¥CLHé˜Ÿåˆ—è¿›è¡Œé˜»å¡ç­‰å¾…ï¼›å¦‚æœwä¸ä¸º0ï¼Œåˆ™è¯´æ˜å…¶å®ƒçº¿ç¨‹è·å–äº†å†™é”ï¼Œæ­¤æ—¶è¦åˆ¤æ–­è·å–äº†å†™é”çš„æ˜¯ä¸æ˜¯å½“å‰çº¿ç¨‹ï¼Œè‹¥ä¸æ˜¯å°±è¿›å…¥CLHé˜Ÿåˆ—è¿›è¡Œé˜»å¡ç­‰å¾…ï¼›è‹¥æ˜¯ï¼Œå°±åº”è¯¥åˆ¤æ–­å½“å‰çº¿ç¨‹è·å–å†™é”æ˜¯å¦è¶…è¿‡äº†æœ€å¤§æ¬¡æ•°ï¼Œè‹¥è¶…è¿‡ï¼ŒæŠ›å¼‚å¸¸ï¼Œåä¹‹æ›´æ–°åŒæ­¥çŠ¶æ€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/1b/d1/1bba37b281d83cdf0c51095f473001d1.jpg?wh=814*1388\" alt=\"\"></p><p><strong>ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–è¯»é”æ—¶ï¼Œ</strong>åŒæ ·ä¼šå…ˆåˆ¤æ–­åŒæ­¥çŠ¶æ€stateæ˜¯å¦ä¸º0ã€‚å¦‚æœstateç­‰äº0ï¼Œè¯´æ˜æš‚æ—¶æ²¡æœ‰å…¶å®ƒçº¿ç¨‹è·å–é”ï¼Œæ­¤æ—¶åˆ¤æ–­æ˜¯å¦éœ€è¦é˜»å¡ï¼Œå¦‚æœéœ€è¦é˜»å¡ï¼Œåˆ™è¿›å…¥CLHé˜Ÿåˆ—è¿›è¡Œé˜»å¡ç­‰å¾…ï¼›å¦‚æœä¸éœ€è¦é˜»å¡ï¼Œåˆ™CASæ›´æ–°åŒæ­¥çŠ¶æ€ä¸ºè¯»çŠ¶æ€ã€‚</p><p>å¦‚æœstateä¸ç­‰äº0ï¼Œä¼šåˆ¤æ–­åŒæ­¥çŠ¶æ€ä½16ä½ï¼Œå¦‚æœå­˜åœ¨å†™é”ï¼Œåˆ™è·å–è¯»é”å¤±è´¥ï¼Œè¿›å…¥CLHé˜»å¡é˜Ÿåˆ—ï¼›åä¹‹ï¼Œåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦åº”è¯¥è¢«é˜»å¡ï¼Œå¦‚æœä¸åº”è¯¥é˜»å¡åˆ™å°è¯•CASåŒæ­¥çŠ¶æ€ï¼Œè·å–æˆåŠŸæ›´æ–°åŒæ­¥é”ä¸ºè¯»çŠ¶æ€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/52/46/52e77acc6999efbdf4113daaa5918d46.jpeg?wh=840*1378\" alt=\"\"></p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ±‚å¹³æ–¹çš„ä¾‹å­ï¼Œæ¥æ„Ÿå—ä¸‹RRWçš„å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class TestRTTLock {\n\n\tprivate double x, y;\n\n\tprivate ReentrantReadWriteLock lock = new ReentrantReadWriteLock();\n\t// è¯»é”\n\tprivate Lock readLock = lock.readLock();\n\t// å†™é”\n\tprivate Lock writeLock = lock.writeLock();\n\n\tpublic double read() {\n\t\t//è·å–è¯»é”\n\t\treadLock.lock();\n\t\ttry {\n\t\t\treturn Math.sqrt(x * x + y * y);\n\t\t} finally {\n\t\t\t//é‡Šæ”¾è¯»é”\n\t\t\treadLock.unlock();\n\t\t}\n\t}\n\n\tpublic void move(double deltaX, double deltaY) {\n\t\t//è·å–å†™é”\n\t\twriteLock.lock();\n\t\ttry {\n\t\t\tx += deltaX;\n\t\t\ty += deltaY;\n\t\t} finally {\n\t\t\t//é‡Šæ”¾å†™é”\n\t\t\twriteLock.unlock();\n\t\t}\n\t}\n\n}\n</code></pre><h3>2.è¯»å†™é”å†ä¼˜åŒ–ä¹‹StampedLock</h3><p>RRWè¢«å¾ˆå¥½åœ°åº”ç”¨åœ¨äº†è¯»å¤§äºå†™çš„å¹¶å‘åœºæ™¯ä¸­ï¼Œç„¶è€ŒRRWåœ¨æ€§èƒ½ä¸Šè¿˜æœ‰å¯æå‡çš„ç©ºé—´ã€‚åœ¨è¯»å–å¾ˆå¤šã€å†™å…¥å¾ˆå°‘çš„æƒ…å†µä¸‹ï¼ŒRRWä¼šä½¿å†™å…¥çº¿ç¨‹é­é‡é¥¥é¥¿ï¼ˆStarvationï¼‰é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´å†™å…¥çº¿ç¨‹ä¼šå› è¿Ÿè¿Ÿæ— æ³•ç«äº‰åˆ°é”è€Œä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚</p><p>åœ¨JDK1.8ä¸­ï¼ŒJavaæä¾›äº†StampedLockç±»è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚StampedLockä¸æ˜¯åŸºäºAQSå®ç°çš„ï¼Œä½†å®ç°çš„åŸç†å’ŒAQSæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åŸºäºé˜Ÿåˆ—å’Œé”çŠ¶æ€å®ç°çš„ã€‚ä¸RRWä¸ä¸€æ ·çš„æ˜¯ï¼Œ<span class=\"orange\">StampedLockæ§åˆ¶é”æœ‰ä¸‰ç§æ¨¡å¼: å†™ã€æ‚²è§‚è¯»ä»¥åŠä¹è§‚è¯»ï¼Œ</span>å¹¶ä¸”StampedLockåœ¨è·å–é”æ—¶ä¼šè¿”å›ä¸€ä¸ªç¥¨æ®stampï¼Œè·å–çš„stampé™¤äº†åœ¨é‡Šæ”¾é”æ—¶éœ€è¦æ ¡éªŒï¼Œåœ¨ä¹è§‚è¯»æ¨¡å¼ä¸‹ï¼Œstampè¿˜ä¼šä½œä¸ºè¯»å–å…±äº«èµ„æºåçš„äºŒæ¬¡æ ¡éªŒï¼Œåé¢æˆ‘ä¼šè®²è§£stampçš„å·¥ä½œåŸç†ã€‚</p><p>æˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªå®˜æ–¹çš„ä¾‹å­æ¥äº†è§£ä¸‹StampedLockæ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class Point {\n    private double x, y;\n    private final StampedLock s1 = new StampedLock();\n\n    void move(double deltaX, double deltaY) {\n        //è·å–å†™é”\n        long stamp = s1.writeLock();\n        try {\n            x += deltaX;\n            y += deltaY;\n        } finally {\n            //é‡Šæ”¾å†™é”\n            s1.unlockWrite(stamp);\n        }\n    }\n\n    double distanceFormOrigin() {\n        //ä¹è§‚è¯»æ“ä½œ\n        long stamp = s1.tryOptimisticRead();  \n        //æ‹·è´å˜é‡\n        double currentX = x, currentY = y;\n        //åˆ¤æ–­è¯»æœŸé—´æ˜¯å¦æœ‰å†™æ“ä½œ\n        if (!s1.validate(stamp)) {\n            //å‡çº§ä¸ºæ‚²è§‚è¯»\n            stamp = s1.readLock();\n            try {\n                currentX = x;\n                currentY = y;\n            } finally {\n                s1.unlockRead(stamp);\n            }\n        }\n        return Math.sqrt(currentX * currentX + currentY * currentY);\n    }\n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼šä¸€ä¸ªå†™çº¿ç¨‹è·å–å†™é”çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæ˜¯é€šè¿‡WriteLockè·å–ä¸€ä¸ªç¥¨æ®stampï¼ŒWriteLockæ˜¯ä¸€ä¸ªç‹¬å é”ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–è¯¥é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å–è¯¥é”åï¼Œå…¶å®ƒè¯·æ±‚çš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œå½“æ²¡æœ‰çº¿ç¨‹æŒæœ‰è¯»é”æˆ–è€…å†™é”çš„æ—¶å€™æ‰å¯ä»¥è·å–åˆ°è¯¥é”ã€‚è¯·æ±‚è¯¥é”æˆåŠŸåä¼šè¿”å›ä¸€ä¸ªstampç¥¨æ®å˜é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¯¥é”çš„ç‰ˆæœ¬ï¼Œå½“é‡Šæ”¾è¯¥é”çš„æ—¶å€™ï¼Œéœ€è¦unlockWriteå¹¶ä¼ é€’å‚æ•°stampã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªè¯»çº¿ç¨‹è·å–é”çš„è¿‡ç¨‹ã€‚é¦–å…ˆçº¿ç¨‹ä¼šé€šè¿‡ä¹è§‚é”tryOptimisticReadæ“ä½œè·å–ç¥¨æ®stamp ï¼Œå¦‚æœå½“å‰æ²¡æœ‰çº¿ç¨‹æŒæœ‰å†™é”ï¼Œåˆ™è¿”å›ä¸€ä¸ªé0çš„stampç‰ˆæœ¬ä¿¡æ¯ã€‚çº¿ç¨‹è·å–è¯¥stampåï¼Œå°†ä¼šæ‹·è´ä¸€ä»½å…±äº«èµ„æºåˆ°æ–¹æ³•æ ˆï¼Œåœ¨è¿™ä¹‹å‰å…·ä½“çš„æ“ä½œéƒ½æ˜¯åŸºäºæ–¹æ³•æ ˆçš„æ‹·è´æ•°æ®ã€‚</p><p>ä¹‹åæ–¹æ³•è¿˜éœ€è¦è°ƒç”¨validateï¼ŒéªŒè¯ä¹‹å‰è°ƒç”¨tryOptimisticReadè¿”å›çš„stampåœ¨å½“å‰æ˜¯å¦æœ‰å…¶å®ƒçº¿ç¨‹æŒæœ‰äº†å†™é”ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆvalidateä¼šè¿”å›0ï¼Œå‡çº§ä¸ºæ‚²è§‚é”ï¼›å¦åˆ™å°±å¯ä»¥ä½¿ç”¨è¯¥stampç‰ˆæœ¬çš„é”å¯¹æ•°æ®è¿›è¡Œæ“ä½œã€‚</p><p>ç›¸æ¯”äºRRWï¼ŒStampedLockè·å–è¯»é”åªæ˜¯ä½¿ç”¨ä¸æˆ–æ“ä½œè¿›è¡Œæ£€éªŒï¼Œä¸æ¶‰åŠCASæ“ä½œï¼Œå³ä½¿ç¬¬ä¸€æ¬¡ä¹è§‚é”è·å–å¤±è´¥ï¼Œä¹Ÿä¼šé©¬ä¸Šå‡çº§è‡³æ‚²è§‚é”ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸€ç›´è¿›è¡ŒCASæ“ä½œå¸¦æ¥çš„CPUå ç”¨æ€§èƒ½çš„é—®é¢˜ï¼Œå› æ­¤StampedLockçš„æ•ˆç‡æ›´é«˜ã€‚</p><h2>æ€»ç»“</h2><p>ä¸ç®¡ä½¿ç”¨SynchronizedåŒæ­¥é”è¿˜æ˜¯LockåŒæ­¥é”ï¼Œåªè¦å­˜åœ¨é”ç«äº‰å°±ä¼šäº§ç”Ÿçº¿ç¨‹é˜»å¡ï¼Œä»è€Œå¯¼è‡´çº¿ç¨‹ä¹‹é—´çš„é¢‘ç¹åˆ‡æ¢ï¼Œæœ€ç»ˆå¢åŠ æ€§èƒ½æ¶ˆè€—ã€‚å› æ­¤ï¼Œ<span class=\"orange\">å¦‚ä½•é™ä½é”ç«äº‰ï¼Œå°±æˆä¸ºäº†ä¼˜åŒ–é”çš„å…³é”®ã€‚</span></p><p>åœ¨SynchronizedåŒæ­¥é”ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†å¯ä»¥é€šè¿‡å‡å°é”ç²’åº¦ã€å‡å°‘é”å ç”¨æ—¶é—´æ¥é™ä½é”çš„ç«äº‰ã€‚åœ¨è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥åˆ©ç”¨Locké”çš„çµæ´»æ€§ï¼Œé€šè¿‡é”åˆ†ç¦»çš„æ–¹å¼æ¥é™ä½é”ç«äº‰ã€‚</p><p>Locké”å®ç°äº†è¯»å†™é”åˆ†ç¦»æ¥ä¼˜åŒ–è¯»å¤§äºå†™çš„åœºæ™¯ï¼Œä»æ™®é€šçš„RRWå®ç°åˆ°è¯»é”å’Œå†™é”ï¼Œåˆ°StampedLockå®ç°äº†ä¹è§‚è¯»é”ã€æ‚²è§‚è¯»é”å’Œå†™é”ï¼Œéƒ½æ˜¯ä¸ºäº†é™ä½é”çš„ç«äº‰ï¼Œä¿ƒä½¿ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½è¾¾åˆ°æœ€ä½³ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>StampedLockåŒRRWä¸€æ ·ï¼Œéƒ½é€‚ç”¨äºè¯»å¤§äºå†™æ“ä½œçš„åœºæ™¯ï¼ŒStampedLocké’å‡ºäºè“ç»“æœå´ä¸å¥½è¯´ï¼Œæ¯•ç«ŸRRWè¿˜åœ¨è¢«å¹¿æ³›åº”ç”¨ï¼Œå°±è¯´æ˜å®ƒè¿˜æœ‰StampedLockæ— æ³•æ›¿ä»£çš„ä¼˜åŠ¿ã€‚<span class=\"orange\">ä½ çŸ¥é“StampedLockæ²¡æœ‰è¢«å¹¿æ³›åº”ç”¨çš„åŸå› å—ï¼Ÿæˆ–è€…è¯´å®ƒè¿˜å­˜åœ¨å“ªäº›ç¼ºé™·å¯¼è‡´æ²¡æœ‰è¢«å¹¿æ³›åº”ç”¨ã€‚</span></p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„è§è§£ã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·å­¦ä¹ ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/67/bbe343640d6b708832c4133ec53ed967.jpg?wh=1110*659\" alt=\"unpreview\"></p>","neighbors":{"left":{"article_title":"12 | å¤šçº¿ç¨‹ä¹‹é”ä¼˜åŒ–ï¼ˆä¸Šï¼‰ï¼šæ·±å…¥äº†è§£SynchronizedåŒæ­¥é”çš„ä¼˜åŒ–æ–¹æ³•","id":101244},"right":{"article_title":"14 | å¤šçº¿ç¨‹ä¹‹é”ä¼˜åŒ–ï¼ˆä¸‹ï¼‰ï¼šä½¿ç”¨ä¹è§‚é”ä¼˜åŒ–å¹¶è¡Œæ“ä½œ","id":101995}},"comments":[{"had_liked":false,"id":104704,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1560819747,"is_pvip":false,"replies":[{"id":"38044","content":"å›ç­”å¾ˆå…¨é¢","user_name":"ä½œè€…å›å¤","comment_id":104704,"uid":"1228576","ip_address":"","utype":1,"ctime":1560906874,"user_name_real":"åˆ˜è¶…"}],"discussion_count":3,"race_medal":0,"score":"272143759395","product_id":100028001,"comment_content":"StampLockä¸æ”¯æŒé‡å…¥ï¼Œä¸æ”¯æŒæ¡ä»¶å˜é‡ï¼Œçº¿ç¨‹è¢«ä¸­æ–­æ—¶å¯èƒ½å¯¼è‡´CPUæš´æ¶¨","like_count":64,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454382,"discussion_content":"å›ç­”å¾ˆå…¨é¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560906874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1264111,"avatar":"https://static001.geekbang.org/account/avatar/00/13/49/ef/02401473.jpg","nickname":"æœˆè¿·æ´¥æ¸¡","note":"","ucode":"2B18B2FE3DAC3B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6405,"discussion_content":"çº¿ç¨‹ç»ˆç«¯å¯¼è‡´CPUæš´æ¶¨è¯¥æ€ä¹ˆç†è§£å‘¢ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1566889274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2051293,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","nickname":"Bumblebee","note":"","ucode":"B879C8A511D08D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1264111,"avatar":"https://static001.geekbang.org/account/avatar/00/13/49/ef/02401473.jpg","nickname":"æœˆè¿·æ´¥æ¸¡","note":"","ucode":"2B18B2FE3DAC3B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573118,"discussion_content":"æœ‰bugå†…éƒ¨whileå¾ªç¯æœ‰é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653210667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6405,"ip_address":""},"score":573118,"extra":""}]}]},{"had_liked":false,"id":110317,"user_name":"KingSwim","can_delete":false,"product_type":"c1","uid":1024043,"ip_address":"","ucode":"84DE14B7EB2580","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/2b/efa6dc2e.jpg","comment_is_top":false,"comment_ctime":1562229451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"194835757771","product_id":100028001,"comment_content":"é‡å¤æ˜¯å­¦ä¹ æœ€å¥½çš„æ–¹å¼â€”â€”æ²¡æœ‰ä¹‹ä¸€ã€‚è™½ç„¶å¥½å‡ ä¸ªJavaä¸“æ éƒ½ä¼šè®²åˆ°é”çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ¯æ¬¡çœ‹å®Œéƒ½æ˜¯åªèƒ½æ‡‚ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œæ¯çœ‹å®Œä¸€ä¸ªä¸“æ å°±æ¸…æ™°ä¸€ç‚¹ï¼Œåªæœ‰ä¸æ–­çš„é‡å¤ï¼Œæ‰èƒ½æŒæ¡å¥½ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚æ„Ÿè§‰å¤ä¹ åŒä¸€ä¸ªä¹Ÿä¼šæœ‰æ•ˆæœï¼ˆéƒ¨åˆ†ä¸“æ çœ‹è¿‡ 2 è¾¹ï¼Œæ„Ÿè§‰æœ‰ç‚¹è€½è¯¯æ—¶é—´ï¼Œä¸“æ å¤ªå¤šï¼‰ã€‚ä½†æ˜¯è¿˜æ˜¯ä¸å¦‚çœ‹æ–°çš„ä¸“æ ï¼Œå› ä¸ºåŒæ—¶è¿˜æœ‰å…¶ä»–çŸ¥è¯†ç‚¹çš„æ”¶è·ã€‚ç°åœ¨å¯¹æ¸©æ•…è€ŒçŸ¥æ–°çš„â€æ•…â€œæœ‰äº†æ–°çš„ç†è§£ã€‚å¦å¤–ï¼Œè€å¸ˆçš„ lock æ˜¯æˆ‘çœ‹è¿‡ä¸“æ é‡Œé¢è®²å¾—æœ€æ¸…æ™°çš„ã€‚","like_count":46},{"had_liked":false,"id":105330,"user_name":"æˆ‘çŸ¥é“äº†å—¯","can_delete":false,"product_type":"c1","uid":1138471,"ip_address":"","ucode":"9186EC1F32C490","user_header":"https://static001.geekbang.org/account/avatar/00/11/5f/27/a6873bc9.jpg","comment_is_top":false,"comment_ctime":1560987807,"is_pvip":false,"replies":[{"id":"51872","content":"å¯é‡å…¥é”æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªçº¿ç¨‹åœ¨å‰é¢æ–¹æ³•ä¸­å·²è·å–é”äº†ï¼Œå†è¿›å…¥è¯¥çº¿ç¨‹çš„å…¶ä»–æ–¹æ³•è·å–é”ï¼Œæ­¤æ—¶ä¸ä¼šå› ä¸ºä¹‹å‰è·å–é”è€Œé˜»å¡ã€‚<br>å¹³æ—¶æˆ‘ä»¬å¾ˆå°‘é‡åˆ°è¿™ç§æƒ…å†µï¼Œä¾‹å¦‚åœ¨Aæ–¹æ³•ä¸­ä½¿ç”¨äº†å¯¹è±¡é”ï¼ŒBæ–¹æ³•ä¸­ä¹Ÿä½¿ç”¨äº†è¯¥å¯¹è±¡é”ï¼Œå¹³æ—¶ä¸€èˆ¬éƒ½æ˜¯åˆ†åˆ«è°ƒç”¨Aæ–¹æ³•å’ŒBæ–¹æ³•ï¼Œè€Œåé¢ç”±äºä¸šåŠ¡éœ€æ±‚åˆšå¥½éœ€è¦åœ¨Aæ–¹æ³•ä¸­è°ƒç”¨Bæ–¹æ³•ï¼Œæ­¤æ—¶å°±ä¼šéœ€è¦é”æ”¯æŒå¯é‡å…¥æ€§ã€‚","user_name":"ä½œè€…å›å¤","comment_id":105330,"uid":"1228576","ip_address":"","utype":1,"ctime":1569055550,"user_name_real":"åˆ˜è¶…"}],"discussion_count":2,"race_medal":0,"score":"100345235615","product_id":100028001,"comment_content":"å¯é‡å…¥é”æ˜¯ä»€ä¹ˆï¼Ÿå¦å¤–ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨åˆ°ï¼Ÿ","like_count":23,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454636,"discussion_content":"å¯é‡å…¥é”æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªçº¿ç¨‹åœ¨å‰é¢æ–¹æ³•ä¸­å·²è·å–é”äº†ï¼Œå†è¿›å…¥è¯¥çº¿ç¨‹çš„å…¶ä»–æ–¹æ³•è·å–é”ï¼Œæ­¤æ—¶ä¸ä¼šå› ä¸ºä¹‹å‰è·å–é”è€Œé˜»å¡ã€‚\nå¹³æ—¶æˆ‘ä»¬å¾ˆå°‘é‡åˆ°è¿™ç§æƒ…å†µï¼Œä¾‹å¦‚åœ¨Aæ–¹æ³•ä¸­ä½¿ç”¨äº†å¯¹è±¡é”ï¼ŒBæ–¹æ³•ä¸­ä¹Ÿä½¿ç”¨äº†è¯¥å¯¹è±¡é”ï¼Œå¹³æ—¶ä¸€èˆ¬éƒ½æ˜¯åˆ†åˆ«è°ƒç”¨Aæ–¹æ³•å’ŒBæ–¹æ³•ï¼Œè€Œåé¢ç”±äºä¸šåŠ¡éœ€æ±‚åˆšå¥½éœ€è¦åœ¨Aæ–¹æ³•ä¸­è°ƒç”¨Bæ–¹æ³•ï¼Œæ­¤æ—¶å°±ä¼šéœ€è¦é”æ”¯æŒå¯é‡å…¥æ€§ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1569055550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048661,"avatar":"https://static001.geekbang.org/account/avatar/00/10/00/55/3f0bc345.jpg","nickname":"Ghost","note":"","ucode":"CC6FD1D460ED10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388776,"discussion_content":"é€’å½’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628948824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104721,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1560821930,"is_pvip":false,"replies":[{"id":"37881","content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¹³é”å’Œéå…¬å¹³é”çš„æƒ…å†µï¼Œå¦‚æœæ˜¯å…¬å¹³é”ï¼Œå³ä½¿æ— é”ç«äº‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ä¸­æ’é˜Ÿè·å–é”ï¼›å¦åˆ™ï¼Œä¼šç«‹å³CASè·å–åˆ°è¯»é”ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæ˜¯å…¬ç”¨çš„ï¼Œè¿™é‡ŒåŒæ ·æ¶‰åŠåˆ°äº†å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œè¯»å†™çº¿ç¨‹å¯¹äºç¨‹åºæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœæ˜¯éå…¬å¹³é”ï¼Œå¦‚æœæ²¡æœ‰é”ç«äº‰çš„æƒ…å†µä¸‹CASè·å–é”æˆåŠŸï¼Œæ˜¯æ— éœ€è¿›å…¥é˜»å¡é˜Ÿåˆ—ã€‚å¦‚æœæ˜¯å…¬å¹³é”ï¼Œéƒ½ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ã€‚","user_name":"ä½œè€…å›å¤","comment_id":104721,"uid":"1228576","ip_address":"","utype":1,"ctime":1560824777,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"74575265962","product_id":100028001,"comment_content":"è€å¸ˆå¥½!è¯»å†™é”é‚£ä¸ªæµç¨‹å›¾çœ‹ä¸å¤ªæ˜ç™½ï¼Œæ²¡æœ‰å†™çº¿ç¨‹çš„æ—¶å€™ï¼Œåˆ¤æ–­ä¸æ˜¯å½“å‰çº¿ç¨‹åœ¨è¯»å°±ä¼šè¿›å…¥CLFé˜»å¡ç­‰å¾…ã€‚<br>é—®é¢˜1:ä¸æ˜¯å¯ä»¥å¹¶å‘è¯»çš„å˜›?æŒ‰è¿™å›¾è¯»çº¿ç¨‹ä¹Ÿè¦é˜»å¡ç­‰å¾…çš„æ„æ€ä¹ˆ?<br>é—®é¢˜äºŒ:CLFé˜»å¡é˜Ÿåˆ—é‡Œæ˜¯è¯»å†™çº¿ç¨‹å…¬ç”¨çš„ä¹ˆ?é˜Ÿåˆ—é‡Œï¼Œè¯»å†™äº¤æ›¿å‡ºç°ã€‚é‚£ä¸å°±æ²¡æ³•å¹¶å‘è¯»äº†ä¹ˆ?","like_count":17,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454388,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¹³é”å’Œéå…¬å¹³é”çš„æƒ…å†µï¼Œå¦‚æœæ˜¯å…¬å¹³é”ï¼Œå³ä½¿æ— é”ç«äº‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ä¸­æ’é˜Ÿè·å–é”ï¼›å¦åˆ™ï¼Œä¼šç«‹å³CASè·å–åˆ°è¯»é”ã€‚\n\nç¬¬äºŒä¸ªé—®é¢˜ï¼Œæ˜¯å…¬ç”¨çš„ï¼Œè¿™é‡ŒåŒæ ·æ¶‰åŠåˆ°äº†å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œè¯»å†™çº¿ç¨‹å¯¹äºç¨‹åºæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚æœæ˜¯éå…¬å¹³é”ï¼Œå¦‚æœæ²¡æœ‰é”ç«äº‰çš„æƒ…å†µä¸‹CASè·å–é”æˆåŠŸï¼Œæ˜¯æ— éœ€è¿›å…¥é˜»å¡é˜Ÿåˆ—ã€‚å¦‚æœæ˜¯å…¬å¹³é”ï¼Œéƒ½ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560824777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104677,"user_name":"å¯†ç 123456","can_delete":false,"product_type":"c1","uid":1126593,"ip_address":"","ucode":"9889463CC0EA71","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg","comment_is_top":false,"comment_ctime":1560817266,"is_pvip":false,"replies":[{"id":"37877","content":"æ˜¯çš„ï¼ŒStampedLockä¸æ”¯æŒå¯é‡å…¥ã€‚å¦‚æœåœ¨ä¸€äº›éœ€è¦é‡å…¥çš„ä»£ç ä¸­ä½¿ç”¨StampedLockï¼Œä¼šå¯¼è‡´æ­»é”ã€é¥¿æ­»ç­‰æƒ…å†µå‡ºç°ã€‚","user_name":"ä½œè€…å›å¤","comment_id":104677,"uid":"1228576","ip_address":"","utype":1,"ctime":1560823941,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"48805457522","product_id":100028001,"comment_content":"ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºé”ä¸å¯é‡å…¥ï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454371,"discussion_content":"æ˜¯çš„ï¼ŒStampedLockä¸æ”¯æŒå¯é‡å…¥ã€‚å¦‚æœåœ¨ä¸€äº›éœ€è¦é‡å…¥çš„ä»£ç ä¸­ä½¿ç”¨StampedLockï¼Œä¼šå¯¼è‡´æ­»é”ã€é¥¿æ­»ç­‰æƒ…å†µå‡ºç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560823941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105139,"user_name":"è‹±é•¿","can_delete":false,"product_type":"c1","uid":1328342,"ip_address":"","ucode":"501CF122762F8C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/uXBAfhWDWhwMbMNbbVbENibOmeDNQ6dQuLKicP2emibGUTrt0Z311Mczh6oareppbuu5TTOPIwXs42ahwcWRQB4pw/132","comment_is_top":false,"comment_ctime":1560928205,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44510601165","product_id":100028001,"comment_content":"å¸Œæœ›è€å¸ˆèƒ½å¤šç»“åˆå®è·µè®²è®²åº”ç”¨åœºæ™¯","like_count":10},{"had_liked":false,"id":189225,"user_name":"ç å†œKevinäº®","can_delete":false,"product_type":"c1","uid":1116630,"ip_address":"","ucode":"D34562461CA0A1","user_header":"https://static001.geekbang.org/account/avatar/00/11/09/d6/5f366427.jpg","comment_is_top":false,"comment_ctime":1584490866,"is_pvip":false,"replies":[{"id":"73036","content":"åœ¨æŸäº›åœºæ™¯ä¸­ï¼ŒReentrantLockè¿™ç§è¯»å†™é”èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¯¹è±¡x,yè¢«volatileä¿®é¥°ï¼Œåœ¨Açº¿ç¨‹è°ƒç”¨å†™å…¥æ–¹æ³•ï¼Œxè¢«å†™å…¥åŠæ—¶æ›´æ–°åˆ°ç¼“å­˜ä¸­ï¼Œè€Œyæ²¡æœ‰ï¼Œæ­¤æ—¶Bçº¿ç¨‹åˆšå¥½è¯»å–x,yçš„å€¼ï¼Œæ­¤æ—¶è¯»å–çš„xå€¼æ˜¯è¢«ä¿®æ”¹è¿‡çš„ï¼Œè€Œyå€¼è¿˜æ˜¯åŸæ¥çš„å€¼ï¼Œå³x,yå­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„å¯èƒ½ã€‚","user_name":"ä½œè€…å›å¤","comment_id":189225,"uid":"1228576","ip_address":"","utype":1,"ctime":1584536304,"user_name_real":"åˆ˜è¶…"}],"discussion_count":4,"race_medal":0,"score":"31649261938","product_id":100028001,"comment_content":"è¯·é—®è€å¸ˆï¼Œåœ¨è¯»å†™é”çš„åœºæ™¯ä¸­ï¼Œæˆ‘åœ¨è¯»æ“ä½œæ—¶ä¸ºä»€ä¹ˆè¿˜è¦åŠ é”ï¼Ÿç›´æ¥è¯»ä¸å°±å¯ä»¥äº†ï¼Ÿå¦‚æœæ‹…å¿ƒæ•°æ®ä¸åˆ·æ–°ï¼Œé‚£åœ¨å˜é‡åŠ volatileæ˜¯ä¸æ˜¯å°±å¯ä»¥æ»¡è¶³ï¼Ÿè¯·è§£æƒ‘","like_count":7,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487639,"discussion_content":"åœ¨æŸäº›åœºæ™¯ä¸­ï¼ŒReentrantLockè¿™ç§è¯»å†™é”èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¯¹è±¡x,yè¢«volatileä¿®é¥°ï¼Œåœ¨Açº¿ç¨‹è°ƒç”¨å†™å…¥æ–¹æ³•ï¼Œxè¢«å†™å…¥åŠæ—¶æ›´æ–°åˆ°ç¼“å­˜ä¸­ï¼Œè€Œyæ²¡æœ‰ï¼Œæ­¤æ—¶Bçº¿ç¨‹åˆšå¥½è¯»å–x,yçš„å€¼ï¼Œæ­¤æ—¶è¯»å–çš„xå€¼æ˜¯è¢«ä¿®æ”¹è¿‡çš„ï¼Œè€Œyå€¼è¿˜æ˜¯åŸæ¥çš„å€¼ï¼Œå³x,yå­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„å¯èƒ½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584536304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"æ¯è«åœ","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578971,"discussion_content":"æˆ‘è§‰å¾—è¿™ä¸ªé—®é¢˜çš„ç—‡ç»“åœ¨äºè¦éµå¾ªhappens-beforeåŸåˆ™ï¼Œä¸€ä¸ªå†™ä¸€å®šè¦å‘ç”Ÿåœ¨ä¸€ä¸ªè¯»è¿™ä¸ªå†…å®¹ä¹‹å‰ã€‚è¯»å’Œè¯»ä¹‹é—´å¯ä»¥ä¸ç”¨åŠ é”ï¼Œä½†è‚¯å®šè¦å…ˆè®©å†™å®Œæˆï¼Œä½ è¯»åˆ°çš„æ‰æ˜¯å‡†ç¡®æ•°æ®ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1657104741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1161636,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b9/a4/e9d2f9ba.jpg","nickname":"W.YH","note":"","ucode":"9BBE1EE38CDCAF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289630,"discussion_content":"volatileä¿®é¥°çš„å˜é‡ä¸ä¼šè¿›å…¥ç¼“å­˜å§ï¼Œä»–ä»¬å…¨éƒ½åœ¨ä¸»å†…å­˜ä¸­åŠ è½½å’Œè¯»å–","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1594168780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1759325,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","nickname":"æ¯è«åœ","note":"","ucode":"4FA1D5CBBEF702","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578968,"discussion_content":"volatileç¦ç”¨äº†CPUç¼“å­˜ï¼Œæ˜¯ç›´æ¥è¯»å†™å†…å­˜ä¸­çš„å¯¹è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657104324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166270,"user_name":"ç‹åœ£å†›","can_delete":false,"product_type":"c1","uid":1395602,"ip_address":"","ucode":"1E13CF683137D1","user_header":"https://static001.geekbang.org/account/avatar/00/15/4b/92/03338a22.jpg","comment_is_top":false,"comment_ctime":1577429211,"is_pvip":false,"replies":[{"id":"65935","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","comment_id":166270,"uid":"1228576","ip_address":"","utype":1,"ctime":1578487521,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"31642200283","product_id":100028001,"comment_content":"è€å¸ˆè¿™é‡Œè¯´çš„å…¬å¹³é”å’Œéå…¬å¹³é”è®©æˆ‘æƒ³èµ·ä¸¤è€…æ˜¯è·å–æ–¹å¼ä¸åŒï¼Œéå…¬å¹³é”æ˜¯é¦–å…ˆå°±CASæ¥è·å–ä¸€æ¬¡ï¼ŒæˆåŠŸå°±æ‹¿åˆ°é”ï¼Œå¤±è´¥å°±æ”¾å…¥é˜Ÿåˆ—ï¼›å…¬å¹³é”ä¸ä¼šæœ‰è¿™æ­¥æ“ä½œï¼Œç›´æ¥æ”¾å…¥é˜Ÿåˆ—","like_count":8,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479468,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578487521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205012,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1586507571,"is_pvip":false,"replies":[{"id":"77118","content":"å¯¹çš„ï¼Œç†è§£å¾ˆåˆ°ä½ï¼Œå‘ç°äº†é—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":205012,"uid":"1228576","ip_address":"","utype":1,"ctime":1586865123,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"23061344051","product_id":100028001,"comment_content":"è·å–è¯»é”çš„æµç¨‹å›¾æœ‰é—®é¢˜å§ï¼Œåº”è¯¥æ˜¯åˆ¤æ–­å†™é”æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹ï¼Œè€Œä¸æ˜¯åˆ¤æ–­è¯»é”ã€‚","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491351,"discussion_content":"å¯¹çš„ï¼Œç†è§£å¾ˆåˆ°ä½ï¼Œå‘ç°äº†é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586865123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104714,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1560821292,"is_pvip":false,"replies":[{"id":"38045","content":"æ˜¯çš„ï¼Œå†™å¤šè¯»å°‘çš„æ€§èƒ½æ²¡æœ‰ä¼˜åŠ¿ã€‚","user_name":"ä½œè€…å›å¤","comment_id":104714,"uid":"1228576","ip_address":"","utype":1,"ctime":1560906942,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"23035657772","product_id":100028001,"comment_content":"StampedLockåœ¨å†™å¤šè¯»å°‘çš„æ—¶å€™æ€§èƒ½ä¼šå¾ˆå·®å§","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454386,"discussion_content":"æ˜¯çš„ï¼Œå†™å¤šè¯»å°‘çš„æ€§èƒ½æ²¡æœ‰ä¼˜åŠ¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560906942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104906,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1560867894,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18740737078","product_id":100028001,"comment_content":"è€å¸ˆè¿™ç¯‡å¹²è´§å¾ˆå¤šï¼Œçœ‹äº†2~3éï¼Œå¤§ä½“ç†è§£äº†åº•å±‚AQSé”åŸç†ï¼ŒæœŸå¾…è€å¸ˆå¤šå¤šåˆ†äº«æ›´å¤šç›¸å…³çš„æ–‡ç« ","like_count":4},{"had_liked":false,"id":104809,"user_name":"ä½ å¥½æ—…è¡Œè€…","can_delete":false,"product_type":"c1","uid":1154101,"ip_address":"","ucode":"5C72A428DC28F3","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/35/9dc79371.jpg","comment_is_top":false,"comment_ctime":1560844594,"is_pvip":false,"replies":[{"id":"38063","content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯è€å¸ˆç¬”è¯¯ï¼Œæé”™æ–¹å‘äº†ï¼Œç°åœ¨å·²æ›´æ­£ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚æœè¯»å¤šå†™å°‘çš„æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯å…¬å¹³é”ï¼Œä¹Ÿæ˜¯éœ€è¦é•¿æ—¶é—´ç­‰å¾…ï¼Œä¸æ˜¯æƒ³è·å–æ—¶å°±èƒ½ç«‹å³è·å–åˆ°é”ã€‚StampedLockå¦‚æœæ˜¯å¤„äºä¹è§‚è¯»æ—¶ï¼Œå†™é”æ˜¯å¯ä»¥éšæ—¶è·å–åˆ°é”ã€‚<br><br>ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼ŒStampedLockæºç ä¸­å­˜åœ¨å¤§é‡compareAndSwapObjectæ“ä½œæ¥ä¿è¯åŸå­æ€§ã€‚","user_name":"ä½œè€…å›å¤","comment_id":104809,"uid":"1228576","ip_address":"","utype":1,"ctime":1560909778,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"18740713778","product_id":100028001,"comment_content":"è€å¸ˆæˆ‘æœ‰å‡ ä¸ªé—®é¢˜ï¼š<br>1.åœ¨ReentrantLockä¸­ï¼Œstateè¿™ä¸ªå˜é‡ï¼Œä¸º0çš„æ—¶å€™è¡¨ç¤ºå½“å‰çš„é”æ˜¯æ²¡æœ‰è¢«å ç”¨çš„ã€‚è¿™ä¸ªæ—¶å€™çº¿ç¨‹åº”è¯¥ç”¨CASå°è¯•ä¿®æ”¹stateå˜é‡çš„å€¼å¯¹é”è¿›è¡ŒæŠ¢å æ‰å¯¹å‘€ï¼Œä¸ºä»€ä¹ˆåœ¨æ‚¨çš„å›¾é‡Œå½“state=0çš„æ—¶å€™è¿˜éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹å‘¢ï¼Ÿ<br>2.è€å¸ˆæåˆ°è¯»å†™é”åœ¨è¯»å¤šå†™å°‘çš„æƒ…å†µä¸‹ä¼šä½¿å¾—å†™çº¿ç¨‹é­é‡é¥¥é¥¿é—®é¢˜ï¼Œé‚£æˆ‘æ˜¯ä¸æ˜¯åªéœ€è¦å°†é”è®¾ç½®ä¸ºå…¬å¹³é”ï¼Œè¿™æ ·å…ˆç”³è¯·å†™é”çš„çº¿ç¨‹å°±å¯ä»¥å…ˆè·å¾—é”ï¼Œä»è€Œé¿å…é¥¥é¥¿é—®é¢˜å‘¢ï¼Ÿ<br>3.StampedLockä¸­å¼•å…¥äº†ä¸€ä¸ªstampç‰ˆæœ¬å¯¹ç‰ˆæœ¬è¿›è¡Œæ§åˆ¶ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸ªstampå˜é‡è¿›è¡Œå†™å…¥çš„æ—¶å€™æ˜¯å¦éœ€è¦ä½¿ç”¨CASæ“ä½œï¼Ÿå¦‚æœä¸æ˜¯ï¼Œé‚£å¦‚ä½•ä¿è¯å¯¹stampå˜é‡çš„è¯»å†™æ˜¯çº¿ç¨‹å®‰å…¨çš„å‘¢ï¼Ÿ<br>è°¢è°¢è€å¸ˆï¼<br>","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454431,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯è€å¸ˆç¬”è¯¯ï¼Œæé”™æ–¹å‘äº†ï¼Œç°åœ¨å·²æ›´æ­£ã€‚\n\nç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚æœè¯»å¤šå†™å°‘çš„æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯å…¬å¹³é”ï¼Œä¹Ÿæ˜¯éœ€è¦é•¿æ—¶é—´ç­‰å¾…ï¼Œä¸æ˜¯æƒ³è·å–æ—¶å°±èƒ½ç«‹å³è·å–åˆ°é”ã€‚StampedLockå¦‚æœæ˜¯å¤„äºä¹è§‚è¯»æ—¶ï¼Œå†™é”æ˜¯å¯ä»¥éšæ—¶è·å–åˆ°é”ã€‚\n\nç¬¬ä¸‰ä¸ªé—®é¢˜ï¼ŒStampedLockæºç ä¸­å­˜åœ¨å¤§é‡compareAndSwapObjectæ“ä½œæ¥ä¿è¯åŸå­æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560909778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":156629,"user_name":"å¥‹æ–—çš„å°ç™½é¼ ","can_delete":false,"product_type":"c1","uid":1743483,"ip_address":"","ucode":"752BB901FFB7CE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/icHicAP9M4M4DIjAvlj5FDdFxIeA0pR3J15QdvVjXQXbznwunDN8OvrYqnsFchtBTNrZCCfGTE2RpPzIxjkvFAKg/132","comment_is_top":false,"comment_ctime":1574926540,"is_pvip":false,"replies":[{"id":"60139","content":"locké”é˜»å¡ä¸ä¼šå¸¦æ¥è¿›ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒIOæµå­˜åœ¨çš„ï¼Œåœ¨09è®²ä¸­è®²åˆ°äº†","user_name":"ä½œè€…å›å¤","comment_id":156629,"uid":"1228576","ip_address":"","utype":1,"ctime":1574940611,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"14459828428","product_id":100028001,"comment_content":"è€å¸ˆï¼Œlocké”ä¸­çš„çº¿ç¨‹é˜»å¡è¿›è¡Œçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šè®¾è®¡ç³»ç»Ÿå†…æ ¸æ€å’Œç”¨æˆ·æ€çš„è½¬æ¢å—ï¼Ÿå•¥æ—¶å€™ä¼šå¼•èµ·ç³»ç»Ÿå†…æ ¸æ€å’Œç”¨æˆ·æ€è½¬æ¢æˆå•Šï¼Ÿ.ioæµç¼–ç¨‹ä¸­ä¼šå‡ºç°å—","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476179,"discussion_content":"locké”é˜»å¡ä¸ä¼šå¸¦æ¥è¿›ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒIOæµå­˜åœ¨çš„ï¼Œåœ¨09è®²ä¸­è®²åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574940611,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105922,"user_name":"æ¬§æ˜Ÿæ˜Ÿ","can_delete":false,"product_type":"c1","uid":1014347,"ip_address":"","ucode":"56365442E231A0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/4b/1a7b36ab.jpg","comment_is_top":false,"comment_ctime":1561105063,"is_pvip":false,"replies":[{"id":"38422","content":"å¯¹çš„ã€‚è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯æŒ‡ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„æ¥å›åˆ‡æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€æ—¦Synchronizedé”èµ„æºç«äº‰æ¿€çƒˆï¼Œçº¿ç¨‹å°†ä¼šè¢«é˜»å¡ï¼Œé˜»å¡çš„çº¿ç¨‹å°†ä¼šä»ç”¨æˆ·æ€è°ƒç”¨å†…æ ¸æ€ï¼Œå°è¯•è·å–mutexï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","user_name":"ä½œè€…å›å¤","comment_id":105922,"uid":"1228576","ip_address":"","utype":1,"ctime":1561255619,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"14446006951","product_id":100028001,"comment_content":"syncä½¿ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„Mutex Lockæ¥å®ç°çš„é”ï¼ŒLockæ˜¯ä½¿ç”¨çº¿ç¨‹ç­‰å¾…æ¥å®ç°é”çš„ï¼Œçº¿ç¨‹ä¹Ÿä¼šå­˜åœ¨ç”¨æˆ·æ€å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454870,"discussion_content":"å¯¹çš„ã€‚è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯æŒ‡ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„æ¥å›åˆ‡æ¢ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€æ—¦Synchronizedé”èµ„æºç«äº‰æ¿€çƒˆï¼Œçº¿ç¨‹å°†ä¼šè¢«é˜»å¡ï¼Œé˜»å¡çš„çº¿ç¨‹å°†ä¼šä»ç”¨æˆ·æ€è°ƒç”¨å†…æ ¸æ€ï¼Œå°è¯•è·å–mutexï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561255619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244460,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1598522632,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10188457224","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼ŒRRWçœŸçš„ä¼šå¯¼è‡´å†™é¥¥é¥¿å—ï¼Ÿæ‚¨è®²äº†è·å–è¯»é”æ—¶ä¼šå…ˆåˆ¤æ–­éœ€ä¸éœ€è¦é˜»å¡ã€‚æˆ‘çœ‹RRWçš„æºç å‘ç°ï¼Œåœ¨æ–°æ¥çš„çº¿ç¨‹å°è¯•è·å–è¯»é”çš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­é˜»å¡é˜Ÿåˆ—ä¸­ä¸‹ä¸€ä¸ªå‡†å¤‡è·å–é”çš„èŠ‚ç‚¹æ˜¯å¦å°è¯•è·å–å†™é”ï¼Œå¦‚æœä¸‹ä¸ªèŠ‚ç‚¹å°è¯•è·å–å†™é”ï¼Œè¿™ä¸ªæ–°æ¥çš„çº¿ç¨‹æ˜¯ä¸ä¼šæŠ¢é”çš„","like_count":2},{"had_liked":false,"id":240826,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1597077081,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10187011673","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼ŒLockçš„åŠ é”å’Œè§£é”ï¼Œæœ€ç»ˆä¼šé€šè¿‡è°ƒç”¨LockSupportçš„æ–¹æ³•è¿›è€Œè°ƒç”¨ UNSAFE.parkï¼Œæˆ–è€…UNSAFE.parkæ–¹æ³•ï¼Œæˆ‘æƒ³çŸ¥é“UNSAFEçš„è¿™äº›æ–¹æ³•ä¼šæœ‰å†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢å—","like_count":2,"discussions":[{"author":{"id":1181454,"avatar":"","nickname":"Carla","note":"","ucode":"29608BF359A567","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580721,"discussion_content":"synchronizedå’Œlockä¸¤è€…ç”¨çš„åŒä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå’Œsynchronizedçš„é‡é‡é”æ¯æ¬¡éƒ½è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ç›¸æ¯”ï¼Œlocké€šè¿‡caså‡å°‘äº†ç³»ç»Ÿè°ƒç”¨çš„å¯èƒ½ï¼Œè¿›è€Œé™ä½äº†æ•´ä½“çš„å¼€é”€ï¼Œå¦‚æœsynchronizedèƒ½æ”¯æŒé”é™çº§ï¼Œä¸¤è€…çš„æ€§èƒ½åº”è¯¥ä¼šå·®ä¸å¤šæŠŠï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658360315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237134,"user_name":"Gavin","can_delete":false,"product_type":"c1","uid":1616970,"ip_address":"","ucode":"A5735665E303FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2UXuSevhia94o9Eky4OfMuSictaldxcqpjGuvRCOcvjIIoVBAENLEZbv2lgwmwC8icK1ZrUcneNtiaeFBV8MT3uzNg/132","comment_is_top":false,"comment_ctime":1595687035,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10185621627","product_id":100028001,"comment_content":"ä¾‹å­ä¸­ï¼Œä¹è§‚è¯»æ—¶ï¼Œxå’Œyä¸æ˜¯volatileï¼Œè¯»çš„æ˜¯æœ¬åœ°å†…å­˜çš„ï¼Œæœ‰å¯èƒ½ä¸æ˜¯æœ€æ–°å€¼ï¼Œè¿™ä¸ªæ˜¯ä¸æ˜¯æœ‰é—®é¢˜å‘€ï¼Ÿ","like_count":2},{"had_liked":false,"id":149818,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1573389605,"is_pvip":false,"replies":[{"id":"57897","content":"ä»æºç åˆ†æï¼Œéƒ½ä¼šè¿›è¡Œé«˜ä½ä½çš„åˆ¤æ–­ï¼Œè·å–å†™é”æ—¶ï¼Œå¦‚æœstate!=0 and w==0ï¼Œå°±å¯ä»¥åˆ¤æ–­äº†æ­¤é”r!=0ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­äº†é«˜16ä½æœ‰æ²¡æœ‰è¯»é”äº†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":149818,"uid":"1228576","ip_address":"","utype":1,"ctime":1573559858,"user_name_real":"åˆ˜è¶…"}],"discussion_count":1,"race_medal":0,"score":"10163324197","product_id":100028001,"comment_content":"RRW åŠ å†™é” å’Œ è¯»é” éƒ½éœ€è¦åˆ¤æ–­ä½16ä½ï¼Ÿ è¿™å—å†™é”æ˜¯ä¸æ˜¯åº”è¯¥åˆ¤è¯»çš„æ˜¯é«˜16ä½æœ‰æ²¡æœ‰è¯»é”ï¼Œä»è€Œåˆ¤æ–­æœ‰æ²¡æœ‰å†²çªï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473988,"discussion_content":"ä»æºç åˆ†æï¼Œéƒ½ä¼šè¿›è¡Œé«˜ä½ä½çš„åˆ¤æ–­ï¼Œè·å–å†™é”æ—¶ï¼Œå¦‚æœstate!=0 and w==0ï¼Œå°±å¯ä»¥åˆ¤æ–­äº†æ­¤é”r!=0ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­äº†é«˜16ä½æœ‰æ²¡æœ‰è¯»é”äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573559858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105088,"user_name":"ä½ å¥½æ—…è¡Œè€…","can_delete":false,"product_type":"c1","uid":1154101,"ip_address":"","ucode":"5C72A428DC28F3","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/35/9dc79371.jpg","comment_is_top":false,"comment_ctime":1560914027,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10150848619","product_id":100028001,"comment_content":"è°¢è°¢è€å¸ˆçš„å›å¤ï¼å…³äºStampedLockï¼Œæˆ‘çš„ç†è§£æ˜¯ä¹è§‚è¯»çš„æ—¶å€™ï¼Œçº¿ç¨‹æŠŠstampçš„å€¼è¯»å‡ºæ¥ï¼Œé€šè¿‡ä¸è¿ç®—æ¥åˆ¤æ–­å½“å‰æ˜¯å¦å­˜åœ¨å†™æ“ä½œã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ¶‰åŠCASæ“ä½œçš„ã€‚å¯æ˜¯å¦‚æœæœ‰çº¿ç¨‹éœ€è¦ä¿®æ”¹å½“å‰çš„èµ„æºï¼Œè¦åŠ å†™é”ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨CASæ“ä½œä¿®æ”¹stampçš„å€¼ã€‚ä¸çŸ¥é“è¿™æ ·ç†è§£æ˜¯å¦å‡†ç¡®ã€‚<br>æ­¤å¤–ï¼Œå‰æ’@-W.LI-åŒå­¦æå‡ºçš„é‚£ä¸ªé—®é¢˜ï¼Œå¹¶å‘è¯»çš„æ—¶å€™ä¹Ÿéœ€è¦æŒ‰ç…§æ˜¯å¦æ˜¯å…¬å¹³é”è¿›å…¥CLHé˜Ÿåˆ—è¿›è¡Œé˜»å¡æˆ‘è¿˜ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œæ—¢ç„¶å¤§å®¶éƒ½æ˜¯è¯»æ“ä½œï¼Œäº’ç›¸ä¹‹é—´æ²¡æœ‰å†²çªï¼Œæˆ‘æ¯ä¸ªçº¿ç¨‹éƒ½ç›´æ¥ç”¨CASæ“ä½œè·å–é”ä¸å°±è¡Œäº†å—ï¼Œä¸ºä»€ä¹ˆè¿˜è¦è¿›é˜Ÿåˆ—é˜»å¡ç­‰å¾…å‘¢ï¼Ÿ","like_count":2},{"had_liked":false,"id":346522,"user_name":"Bumblebee","can_delete":false,"product_type":"c1","uid":2051293,"ip_address":"","ucode":"B879C8A511D08D","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","comment_is_top":false,"comment_ctime":1653211294,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5948178590","product_id":100028001,"comment_content":"ä»Šæ—¥æ€è€ƒ<br><br>StampedLockç›¸æ¯”äºReentrantReadWriteLockçš„ä¼˜ç‚¹ä¹‹ä¸€ï¼Œåœ¨è¯»å¤šå†™å°‘çš„åœºæ™¯ä¸‹ï¼Œå†™çº¿ç¨‹å¯èƒ½ä¼šé•¿æ—¶é—´è·å–ä¸åˆ°å†™é”ï¼ŒStampedLockåˆ©ç”¨ä¹è§‚è¯»ï¼ˆæ— é”åŒ–æ“ä½œï¼‰å½“å†™çº¿ç¨‹èƒ½ç”³è¯·é”æ—¶èƒ½åŠæ—¶è·å–é”ï¼Œä¸ä¼šåƒè¯»å†™é”é‚£æ ·å¯èƒ½é•¿æ—¶é—´è·å–ä¸åˆ°é”ã€‚<br><br>æˆ‘çš„æ„æ€å¤§å®¶åº”è¯¥æ˜ç™½äº†å§ğŸ˜‚ï¼ˆè¯´çš„ä¸å¯¹çš„å¤§å®¶å¤šå¤šæŒ‡æ­£ï¼‰","like_count":1},{"had_liked":false,"id":149260,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1573180292,"is_pvip":false,"replies":[{"id":"57610","content":"ä¸€èˆ¬å æœ‰é”æ—¶é—´éå¸¸çŸ­ï¼Œé˜Ÿåˆ—çš„é•¿åº¦ä¹Ÿä¸ä¼šå¤ªé•¿ï¼Œè¿™ä¸ªæ€§èƒ½å‡ ä¹å¯ä»¥å¿½ç•¥","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1573383724,"ip_address":"","comment_id":149260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5868147588","product_id":100028001,"comment_content":"è€å¸ˆï¼Œå…¬å¹³é”å› ä¸ºè¦ç»´æŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„é¡ºåºï¼Œæ˜¯ä¸æ˜¯æ€§èƒ½ç›¸å¯¹éå…¬å¹³é”å¼±ä¸€äº›ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473796,"discussion_content":"ä¸€èˆ¬å æœ‰é”æ—¶é—´éå¸¸çŸ­ï¼Œé˜Ÿåˆ—çš„é•¿åº¦ä¹Ÿä¸ä¼šå¤ªé•¿ï¼Œè¿™ä¸ªæ€§èƒ½å‡ ä¹å¯ä»¥å¿½ç•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573383724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132160,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568034483,"is_pvip":false,"replies":[{"id":"51137","content":"æˆ‘ä»¬è¿›å…¥åˆ°åº•å±‚ä»£ç ï¼Œå¯ä»¥å‘ç°å…¶å®å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦è¿›å…¥é˜Ÿåˆ—ï¼Œå…¬å¹³é”æ˜¯ä¼šè¿›å…¥åˆ°é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…å”¤é†’ï¼Œè€Œéå…¬å¹³é”åˆ™æ˜¯ç›´æ¥CASè·å–é”ã€‚<br><br>Locké”å¦‚æœç›‘æµ‹åˆ°ä¸­æ–­å°±ç›´æ¥throw new InterruptedException();æŠ›å‡ºæ¥äº†ï¼Œæ‰€ä»¥å¯ä»¥å“åº”ä¸­æ–­ã€‚<br><br>å…·ä½“å¯å‚è€ƒæºç ã€‚<br><br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568539623,"ip_address":"","comment_id":132160,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5863001779","product_id":100028001,"comment_content":"è¯¾åæ€è€ƒåŠé—®é¢˜<br>1ï¼šå…¬å¹³é”å’Œéå…¬å¹³é”å…·ä½“æŒ‡ä»€ä¹ˆï¼Ÿæ€ä¹ˆä½“ç°ï¼Ÿ<br><br>2ï¼šé”çš„çŠ¶æ€å¯ä¸­æ–­å’Œä¸å¯ä¸­æ–­å…·ä½“æ˜¯æŒ‡ä»€ä¹ˆæ„æ€ï¼Ÿ<br><br>æ™šä¸ŠåŠ ç­çŠ¶æ€å¯èƒ½ä¸å¤ªå¥½ï¼Œæ„Ÿè§‰è€å¸ˆä¸»è¦è®²è§£äº†å‡ ç§åŒæ­¥é”çš„å®ç°åŸç†ï¼Œä»¥åŠç‰¹ç‚¹ï¼Œå¦‚æœèƒ½åˆ—ä¸ªäºŒç»´è¡¨å°±æ›´å¥½å•¦!","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466796,"discussion_content":"æˆ‘ä»¬è¿›å…¥åˆ°åº•å±‚ä»£ç ï¼Œå¯ä»¥å‘ç°å…¶å®å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦è¿›å…¥é˜Ÿåˆ—ï¼Œå…¬å¹³é”æ˜¯ä¼šè¿›å…¥åˆ°é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…å”¤é†’ï¼Œè€Œéå…¬å¹³é”åˆ™æ˜¯ç›´æ¥CASè·å–é”ã€‚\n\nLocké”å¦‚æœç›‘æµ‹åˆ°ä¸­æ–­å°±ç›´æ¥throw new InterruptedException();æŠ›å‡ºæ¥äº†ï¼Œæ‰€ä»¥å¯ä»¥å“åº”ä¸­æ–­ã€‚\n\nå…·ä½“å¯å‚è€ƒæºç ã€‚\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568539623,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104772,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1560832080,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5855799376","product_id":100028001,"comment_content":"åˆšæƒ³åé¦ˆå›¾ç‰‡ä¸€ä¸ªå­—æ¯å†™åäº†ï¼Œåˆ·æ–°ä¸€ä¸‹ï¼Œç«‹é©¬è¢«ä¿®å¤äº†ï¼Œå‰å®³å‰å®³ï¼Œä½©æœè€å¸ˆçš„æ•ˆç‡","like_count":1},{"had_liked":false,"id":104743,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1560825659,"is_pvip":false,"replies":[{"id":"38046","content":"èµï¼Œè¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©é”ç±»å‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560907002,"ip_address":"","comment_id":104743,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855792955","product_id":100028001,"comment_content":"æˆ‘è§‰çš„ç¥¨æ®æœ¬æ¥å°±æ˜¯è¯»å†™é”å‡çº§ç‰ˆï¼Œæ€§èƒ½ç»é€¼æ˜¯ä¼˜äºè¯»å†™é”çš„ã€‚ç¡¬è¦è¯´ä¸å¦‚ï¼Œä¸å…è®¸é”é‡å…¥å’Œé˜»å¡æ—¶è°ƒç”¨interrupt()æœ‰CPUå½ªé«˜çš„bugç®—æ˜¯å­˜åœ¨çš„é—®é¢˜å§ã€‚å‰è€…ï¼Œæ¯•ç«Ÿç¥¨æ®å’Œè¯»å†™éƒ½æ˜¯ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œæ‰€ä»¥äº’æ–¥é”é‡å…¥è¿™å—æ„Ÿè§‰é‡ä¸å¤§ï¼Œæ²¡äº†å€’ä¹Ÿæ— ä¼¤å¤§é›…ã€‚è€Œåè€…bugå°±æ˜¯bugæ²¡å¾—è¯´ã€‚å…¶å®å¦‚æœæ˜¯å†™å¤šè¯»å°‘çš„åœºæ™¯ï¼Œéšå¼é”ä¼šæ¯”è¿™äº›è¯»å†™é”æ€§èƒ½æ›´å¥½ã€‚é‡ç‚¹è¿˜æ˜¯æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯å»é€‰æ‹©ã€‚<br><br>","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454403,"discussion_content":"èµï¼Œè¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©é”ç±»å‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560907002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104718,"user_name":"å­™å¿—å¼º","can_delete":false,"product_type":"c1","uid":1325997,"ip_address":"","ucode":"9C070F1E4EC6FF","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/ad/31193b83.jpg","comment_is_top":false,"comment_ctime":1560821651,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5855788947","product_id":100028001,"comment_content":"Stampedlockç‰ºç‰²äº†å¾®å°çš„æ•°æ®ä¸€è‡´æ€§æ¥æå‡æ€§èƒ½ã€‚","like_count":1},{"had_liked":false,"id":104643,"user_name":"å¼ å­¦ç£Š","can_delete":false,"product_type":"c1","uid":1250029,"ip_address":"","ucode":"F545F384A6F1E1","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eotSSnZic41tGkbflx0ogIg3ia6g2muFY1hCgosL2t3icZm7I8Ax1hcv1jNgr6vrZ53dpBuGhaoc6DKg/132","comment_is_top":false,"comment_ctime":1560812575,"is_pvip":false,"replies":[{"id":"37883","content":"è¿™å°±æ˜¯ä¸€ç§æŒ‰ç‰ˆæœ¬å·å®ç°çš„è¯»ä¹è§‚é”ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨æ•°æ®åº“æ›´æ–°æ“ä½œæ—¶ç”¨åˆ°è¿™ç§åŸºäºç‰ˆæœ¬å·å®ç°çš„å†™ä¹è§‚é”ã€‚<br><br>å¯¹çš„ï¼ŒStampedLockä¸æ”¯æŒé‡å…¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560825203,"ip_address":"","comment_id":104643,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855779871","product_id":100028001,"comment_content":"è€å¸ˆï¼ŒtryOptimisticReadæ“ä½œè·å–çš„ä¸åº”è¯¥å«ä¹è§‚è¯»é”ï¼Œåº”è¯¥æ˜¯ä¹è§‚è¯»ï¼Œæ˜¯æ— é”çš„ï¼›StampedLockåå­—ä¸­æ²¡æœ‰Reentrantï¼Œæ‰€ä»¥ä¸æ”¯æŒé‡å…¥ï¼›StampedLockä¹Ÿä¸æ”¯æŒæ¡ä»¶å˜é‡ã€‚","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454357,"discussion_content":"è¿™å°±æ˜¯ä¸€ç§æŒ‰ç‰ˆæœ¬å·å®ç°çš„è¯»ä¹è§‚é”ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨æ•°æ®åº“æ›´æ–°æ“ä½œæ—¶ç”¨åˆ°è¿™ç§åŸºäºç‰ˆæœ¬å·å®ç°çš„å†™ä¹è§‚é”ã€‚\n\nå¯¹çš„ï¼ŒStampedLockä¸æ”¯æŒé‡å…¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560825203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350706,"user_name":"æ¯è«åœ","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1657104799,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657104799","product_id":100028001,"comment_content":"å¹²è´§æŒºå¤šçš„ï¼Œä»¥è‡³äºè¯»çš„å¾ˆæ…¢ï¼Œä½†æ”¶è·ä¹Ÿå¤šã€‚","like_count":0},{"had_liked":false,"id":346520,"user_name":"Bumblebee","can_delete":false,"product_type":"c1","uid":2051293,"ip_address":"","ucode":"B879C8A511D08D","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","comment_is_top":false,"comment_ctime":1653211005,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653211005","product_id":100028001,"comment_content":"â‘  StampedLockä¸æ”¯æŒå¯é‡å…¥é”ï¼›<br><br>â‘¡ StampedLockè·å–çš„ä¸æ˜¯å¯ä¸­æ–­çš„è¯»å†™é”ï¼Œè°ƒç”¨ä¸­æ–­æ“ä½œæ—¶ï¼Œä¼šå¯¼è‡´çº¿ç¨‹æ‰€åœ¨CPUé£™å‡ï¼Œå¦‚æœä¸€å®šè¦æ‰§è¡Œä¸­æ–­æ“ä½œè¯·ä½¿ç”¨å¯ä¸­æ–­çš„æ‚²è§‚è¯»é”readLockInterruptibly() å’Œå†™é” writeLockInterruptibly()ï¼›<br><br>â‘¢ StampedLockä¸æ”¯æŒæ¡ä»¶å˜é‡ï¼›","like_count":0},{"had_liked":false,"id":323404,"user_name":"ç å“¥å­—èŠ‚","can_delete":false,"product_type":"c1","uid":1572356,"ip_address":"","ucode":"362103AD52C8E0","user_header":"https://static001.geekbang.org/account/avatar/00/17/fe/04/bb427e47.jpg","comment_is_top":false,"comment_ctime":1637890977,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637890977","product_id":100028001,"comment_content":"ä¸æ”¯æŒé”é‡å…¥ï¼Œæ— æ³•ä½¿ç”¨æ¡ä»¶ç­‰å¾…ï¼Œçº¿ç¨‹ä¸­æ–­å¯èƒ½ä¼šå¯¼è‡´CPUé£™å‡","like_count":0},{"had_liked":false,"id":302362,"user_name":"å‡¯æ–‡å°çŒª","can_delete":false,"product_type":"c1","uid":1980201,"ip_address":"","ucode":"36D8AD0229547F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","comment_is_top":false,"comment_ctime":1626179015,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626179015","product_id":100028001,"comment_content":"StampedLockæ˜¯ä¹è§‚è¯»å†™é”ã€‚è¯»çš„è¿‡ç¨‹ä¸­ä¹Ÿå…è®¸è·å–å†™é”åå†™å…¥ï¼è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬è¯»çš„æ•°æ®å°±å¯èƒ½ä¸ä¸€è‡´","like_count":0},{"had_liked":false,"id":289501,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1619055651,"is_pvip":false,"replies":[{"id":"105085","content":"åŒå­¦ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„åé¦ˆï¼Œæµç¨‹å›¾å·²æ›´æ­£ï¼","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç‹å†¬é’","uid":"1356014","ctime":1619144690,"ip_address":"","comment_id":289501,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1619055651","product_id":100028001,"comment_content":"è€å¸ˆï¼ŒRRW è·å–è¯»é”æµç¨‹å›¾ï¼Œå¯¹ state ä½ 16 ä½ä¸º 0 çš„åˆ¤æ–­ï¼Œ2ä¸ªåˆ¤æ–­æµç¨‹åäº†å§ï¼é«˜è¯»ä½å†™ï¼Œå¦‚æœä½ 16 ä½ä¸º 0ï¼Œè¯´æ˜é«˜ä½ä¸ä¸º 0ï¼Œæ­¤æ—¶æœ‰è¯»é”ï¼Œéœ€è¦åˆ¤æ–­è¯»é”æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹æŒæœ‰ã€‚<br>èƒ½å¦æ›´æ­£ä¸€ä¸‹æµç¨‹å›¾ï¼Œè°¢è°¢ï¼","like_count":0,"discussions":[{"author":{"id":1356014,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b0/ee/d0871efd.jpg","nickname":"å†¬é’","note":"","ucode":"14576781B499FB","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518934,"discussion_content":"åŒå­¦ä½ å¥½ï¼Œæ„Ÿè°¢ä½ çš„åé¦ˆï¼Œæµç¨‹å›¾å·²æ›´æ­£ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619144690,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282021,"user_name":"Eco","can_delete":false,"product_type":"c1","uid":1373230,"ip_address":"","ucode":"5459B494753183","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/x86UN2kFbJGGwiaw7yeVtyaf05y5eZmdOciaAF09WEBRVicbPGsej1b62UAH3icjeJqvibVc6aqB0EuFwDicicKKcF47w/132","comment_is_top":false,"comment_ctime":1615018755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615018755","product_id":100028001,"comment_content":"ä½ å¥½ï¼Œæ„Ÿè§‰æ–‡ç« å¯¹äºAQSçš„ç¯‡å¹…æœ‰ç‚¹å°‘ï¼Œä½†AQSåœ¨JDKçš„åŒæ­¥åŒ…ä¸­çš„ä½œç”¨æ˜¯éå¸¸å¤§çš„ã€‚","like_count":0},{"had_liked":false,"id":256664,"user_name":"è€ƒä¼‘","can_delete":false,"product_type":"c1","uid":1053955,"ip_address":"","ucode":"968DFC00D6D0CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","comment_is_top":false,"comment_ctime":1603700360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603700360","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼ŒRRWåªæœ‰æ˜¯éå…¬å¹³é”æ—¶æ‰ä¼šå¹¶å‘è¯»ï¼Œå¦åˆ™ä¹Ÿä¼šè¿›å…¥CLHé˜»å¡é˜Ÿåˆ—ã€‚è¯·é—®è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":249565,"user_name":"Wheat","can_delete":false,"product_type":"c1","uid":1260141,"ip_address":"","ucode":"7D99EA149B6DE8","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","comment_is_top":false,"comment_ctime":1600693900,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600693900","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹validateæ–¹æ³•ä¸­è°ƒç”¨äº†loadFenceï¼ŒæŸ¥äº†ä¸€ä¸‹å«â€œå†…å­˜å±éšœâ€ï¼Œæ˜¯ç”¨æ¥ä¿è¯å†…å­˜ä¸€è‡´æ€§å’Œé˜²æ­¢æŒ‡ä»¤é‡æ’çš„ï¼Œé‚£ä¸ºä»€ä¹ˆè¦åœ¨è¿™é‡Œè°ƒç”¨loadFenceå‘¢ï¼Œä¸€å…±å°±åªæœ‰stampå’Œstateä¸¤ä¸ªå˜é‡","like_count":0},{"had_liked":false,"id":245187,"user_name":"ç‘¶è€æ¿çš„å°å¼Ÿ","can_delete":false,"product_type":"c1","uid":1438863,"ip_address":"","ucode":"EA6CDB3165227F","user_header":"https://static001.geekbang.org/account/avatar/00/15/f4/8f/6b3d4370.jpg","comment_is_top":false,"comment_ctime":1598860045,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1598860045","product_id":100028001,"comment_content":"StampedLock è§£å†³å†™çº¿ç¨‹é¥¥é¥¿é—®é¢˜ï¼Ÿ<br>æ€ä¹ˆè§£å†³çš„ æ²¡çœ‹æ˜ç™½ã€‚","like_count":0,"discussions":[{"author":{"id":1260141,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3a/6d/910b2445.jpg","nickname":"Wheat","note":"","ucode":"7D99EA149B6DE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307610,"discussion_content":"è¯»çš„æ—¶å€™ä¸åŠ é”ï¼Œä¸ä¼šé˜»å¡å†™","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600695532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238290,"user_name":"é˜³æ˜¥é¢","can_delete":false,"product_type":"c1","uid":1693492,"ip_address":"","ucode":"27493CAD3D7EF3","user_header":"https://static001.geekbang.org/account/avatar/00/19/d7/34/b67c74b8.jpg","comment_is_top":false,"comment_ctime":1596112280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596112280","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä»€ä¹ˆæ—¶å€™ç”¨Synchronizedä»€ä¹ˆæ—¶å€™ç”¨lockã€‚ä¹‹å‰é¢è¯•æœ‰ç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œç­”äº†å‡ ä¸ªç‚¹ä½†æ€»æ„Ÿè§‰ä¸æ˜¯é¢è¯•å®˜æƒ³è¦çš„ç­”æ¡ˆã€‚","like_count":0},{"had_liked":false,"id":208673,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1587398092,"is_pvip":false,"replies":[{"id":"78612","content":"åœ¨è¯»&#47;è¯»çš„æƒ…å†µä¸‹ï¼Œå°±å‡å°‘ç«äº‰äº†ï¼Œåªæœ‰åœ¨è¯»&#47;å†™æˆ–è€…å†™&#47;å†™çš„æƒ…å†µä¸‹æ‰æœ‰ç«äº‰","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1587988260,"ip_address":"","comment_id":208673,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587398092","product_id":100028001,"comment_content":"è€å¸ˆåœ¨æ–‡ç« ä¸­è¯´ï¼šå¦‚æœå¤šä¸ªçº¿ç¨‹ä»…ä»…æ˜¯è¯»å–å…±äº«èµ„æºï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹å…¶å®æ²¡æœ‰å¿…è¦å¯¹èµ„æºè¿›è¡ŒåŠ é”ã€‚å¯æ˜¯è·å–è¯»é”çš„æµç¨‹å›¾ä¸­ï¼Œåœ¨è·å–è¯»é”çš„æ—¶å€™ï¼Œä»ç„¶éœ€è¦ç«äº‰ï¼Œç«äº‰å¤±è´¥è¿˜ä¼šè¿›è¡Œä¼‘çœ ï¼Œä¹‹åå†ç«äº‰ï¼Œè¿™å¥½åƒä¸ç¬¦åˆä¸Šæ–‡è¯´çš„â€œæ²¡å¿…è¦å¯¹èµ„æºè¿›è¡ŒåŠ é”&#39;è¿™å¥è¯å•Š","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492571,"discussion_content":"åœ¨è¯»/è¯»çš„æƒ…å†µä¸‹ï¼Œå°±å‡å°‘ç«äº‰äº†ï¼Œåªæœ‰åœ¨è¯»/å†™æˆ–è€…å†™/å†™çš„æƒ…å†µä¸‹æ‰æœ‰ç«äº‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587988260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204999,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1586505259,"is_pvip":false,"replies":[{"id":"77117","content":"è¿™ä¸ªæ—¶å€™åˆè¯»é”ï¼Œè¯»é”å’Œå†™é”æ˜¯äº’æ–¥çš„ï¼Œæ‰€ä»¥ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1586864832,"ip_address":"","comment_id":204999,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586505259","product_id":100028001,"comment_content":"return Math.sqrt(currentX * currentX + currentY * currentY);<br> å¦‚æœæ‰§è¡Œåˆ°è¿™ä¸ªæ­¥éª¤çš„æ—¶å€™ï¼Œå†™é”çªç„¶è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°å¹¶ä¸”ä¿®æ”¹äº†X,Yï¼Œæ­¤æ—¶ä¹Ÿæ— æ³•æ ¡éªŒäº†ï¼Œç®—å‡ºçš„æ•°è¿˜æ˜¯é”™çš„ï¼Œè¿™ä¸ªæ€ä¹ˆåŠï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491347,"discussion_content":"è¿™ä¸ªæ—¶å€™åˆè¯»é”ï¼Œè¯»é”å’Œå†™é”æ˜¯äº’æ–¥çš„ï¼Œæ‰€ä»¥ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586864832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195562,"user_name":"will","can_delete":false,"product_type":"c1","uid":1156207,"ip_address":"","ucode":"7A7DBE3E0EEAEB","user_header":"https://static001.geekbang.org/account/avatar/00/11/a4/6f/672a27d4.jpg","comment_is_top":false,"comment_ctime":1585197545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585197545","product_id":100028001,"comment_content":"ä¸€ç›´éƒ½æ˜¯åšç§»åŠ¨ç«¯ï¼Œæ²¡æ¥è§¦è¿‡è¿™äº›é”ï¼Œå¯ä»¥å¥½å¥½å­¦å­¦","like_count":0},{"had_liked":false,"id":170599,"user_name":"ã€‚ã€‚ã€‚ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":1612570,"ip_address":"","ucode":"985B1561AC9152","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Xibh27ZicBhXls5KsPibBXZI4RKlR0MUbUiaEuOS2ORibKaxWSicpIjd4lvWUWqtNAde7EeDDTpWKAiapGdHeaiaDqczWQ/132","comment_is_top":false,"comment_ctime":1578641426,"is_pvip":false,"replies":[{"id":"70528","content":"é—®é¢˜ä¸€ï¼šå› ä¸ºè¿™ä¸ªæ˜¯è¯»å†™é”ï¼Œè¯»é”å’Œå†™é”çš„é€»è¾‘æ˜¯åˆ†å¼€çš„ï¼›<br>é—®é¢˜äºŒï¼šå› ä¸ºReentrantReadWriteLockæ˜¯å…·æœ‰å…¬å¹³é”çš„ç‰¹æ€§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1582722835,"ip_address":"","comment_id":170599,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1578641426","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œ<br>é—®é¢˜ä¸€ï¼šé‚£ä¸¤ä¸ªæµç¨‹å›¾ï¼Œä¸ºä»€ä¹ˆåŒæ ·æ˜¯åˆ¤æ–­stateä½16ä½æ˜¯å¦ä¸º0ï¼Œä¸ºå¦æ—¶ï¼Œä¸€æ¬¡æ˜¯åˆ¤æ–­è·å–å†™é”çš„çº¿ç¨‹æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹ï¼Œä¸€æ¬¡æ˜¯åˆ¤æ–­è·å–è¯»é”çš„çº¿ç¨‹æ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹<br>é—®é¢˜äºŒï¼šå½“ä¸­é—´æŸä¸€æ­¥å°±å¯ä»¥çŸ¥é“é”è·å–å¤±è´¥ï¼ˆæ¯”å¦‚è·å–è¯»é”æµç¨‹ä¸­ï¼Œstateä½16ä½ä¸ä¸º0ï¼Œä¸”è·å–å†™é”çš„ä¸æ˜¯å½“å‰çº¿ç¨‹ï¼‰ï¼Œä¸æ˜¯å°±ç›´æ¥å¯ä»¥æ”¾å…¥é˜Ÿåˆ—äº†å—ï¼Œä¸ºä»€ä¹ˆè¿˜è¦åˆ¤æ–­æ˜¯å¦ä¸ºå…¬å¹³é”","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481035,"discussion_content":"é—®é¢˜ä¸€ï¼šå› ä¸ºè¿™ä¸ªæ˜¯è¯»å†™é”ï¼Œè¯»é”å’Œå†™é”çš„é€»è¾‘æ˜¯åˆ†å¼€çš„ï¼›\né—®é¢˜äºŒï¼šå› ä¸ºReentrantReadWriteLockæ˜¯å…·æœ‰å…¬å¹³é”çš„ç‰¹æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582722835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":149781,"user_name":"åˆåŒå’å•æ˜¯ä¸€å¹´å•Š","can_delete":false,"product_type":"c1","uid":1000015,"ip_address":"","ucode":"E067320E537DEE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/4f/ff1ac464.jpg","comment_is_top":false,"comment_ctime":1573376139,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1573376139","product_id":100028001,"comment_content":"è¯·æ•™ä¸‹ï¼Œéå…¬å¹³é”æ˜¯æ€ä¹ˆç©çš„éšæœºå”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹NodeèŠ‚ç‚¹çš„ï¼Œæ˜¯å‹æ ¹ä¸è€ƒè™‘CLHé˜Ÿåˆ—çš„é¡ºåºå—ï¼Ÿ è¿˜æ˜¯éå…¬å¹³é”å‹æ ¹ä¸æŠŠè·å–é”å¤±è´¥çš„çº¿ç¨‹å°è£…æˆNodeåŠ å…¥åˆ°CLHé˜Ÿåˆ—ä¸­ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":47631,"discussion_content":"ä¸ä¼šæ”¾å…¥CLHé˜Ÿåˆ—ï¼Œä¼šéšæœºæŠ¢å é”ï¼Œå»ºè®®å‚è€ƒæºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573383362,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127317,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1566650077,"is_pvip":false,"replies":[{"id":"47297","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566785813,"ip_address":"","comment_id":127317,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1566650077","product_id":100028001,"comment_content":"è€å¸ˆï¼Œéšå¼é”åªæœ‰synchronizedè¿™ä¸€ç§å—?","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464436,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566785813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114522,"user_name":"è¾‰","can_delete":false,"product_type":"c1","uid":1514658,"ip_address":"","ucode":"39D6CDEF00083A","user_header":"https://static001.geekbang.org/account/avatar/00/17/1c/a2/2c3572de.jpg","comment_is_top":false,"comment_ctime":1563328723,"is_pvip":false,"replies":[{"id":"41789","content":"ä½ å¯ä»¥è‡ªå·±æœç´¢äº†è§£ä¸‹ï¼Œæå®¢æ—¶é—´å…¶ä»–ä¸“æ ä¸­ä¹Ÿæœ‰ä»‹ç»ï¼ŒAppä¸­æœç´¢å¯ä»¥æ‰¾åˆ°ç›¸å…³èµ„æ–™ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"éƒ­è•¾","uid":"1000473","ctime":1563329926,"ip_address":"","comment_id":114522,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1563328723","product_id":100028001,"comment_content":"ä¸€ç›´ä¸æ˜ç™½è€å¸ˆè¯´çš„CASæ˜¯å•¥ä¸œä¸œã€‚å…·ä½“æè¿°ä¸‹","like_count":0,"discussions":[{"author":{"id":1000473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/44/19/17fadc62.jpg","nickname":"éƒ­è•¾","note":"","ucode":"34F4C07D1C5FE8","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458701,"discussion_content":"ä½ å¯ä»¥è‡ªå·±æœç´¢äº†è§£ä¸‹ï¼Œæå®¢æ—¶é—´å…¶ä»–ä¸“æ ä¸­ä¹Ÿæœ‰ä»‹ç»ï¼ŒAppä¸­æœç´¢å¯ä»¥æ‰¾åˆ°ç›¸å…³èµ„æ–™ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563329926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111966,"user_name":"å˜‰å˜‰â˜•","can_delete":false,"product_type":"c1","uid":1059771,"ip_address":"","ucode":"632A5CC4B53BB1","user_header":"https://static001.geekbang.org/account/avatar/00/10/2b/bb/5cf70df8.jpg","comment_is_top":false,"comment_ctime":1562643867,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562643867","product_id":100028001,"comment_content":"å¥½çš„ï¼Œè°¢è°¢è€å¸ˆï¼Œå°±æ˜¯çœ‹åˆ°å›¾å’Œæ–‡å­—æ˜¯ä¸ä¸€æ ·çš„ï¼Œç¡®è®¤ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":111725,"user_name":"å˜‰å˜‰â˜•","can_delete":false,"product_type":"c1","uid":1059771,"ip_address":"","ucode":"632A5CC4B53BB1","user_header":"https://static001.geekbang.org/account/avatar/00/10/2b/bb/5cf70df8.jpg","comment_is_top":false,"comment_ctime":1562590259,"is_pvip":false,"replies":[{"id":"40696","content":"è·å–å†™é”çš„æ¬¡æ•°ï¼Œä¹Ÿæ˜¯ç‹¬å çš„æ•°é‡","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1562636774,"ip_address":"","comment_id":111725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562590259","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·é—®<br>è·å–å†™é”çš„æµç¨‹ï¼Œæ–‡å­—æè¿°å’Œæµç¨‹å›¾ï¼Œæœ‰ä¸ªåœ°æ–¹ä¸å¤ªä¸€æ ·ï¼Œåˆ¤æ–­â€œè·å–å†™é”çš„æ¬¡æ•°â€è¿˜æ˜¯â€œè·å–è¯»é”çš„æ¬¡æ•°â€ï¼Ÿï¼Ÿ<br>è°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457427,"discussion_content":"è·å–å†™é”çš„æ¬¡æ•°ï¼Œä¹Ÿæ˜¯ç‹¬å çš„æ•°é‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562636774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110764,"user_name":"ä»»é¹æ–Œ","can_delete":false,"product_type":"c1","uid":1104086,"ip_address":"","ucode":"34319B05EA6E74","user_header":"https://static001.geekbang.org/account/avatar/00/10/d8/d6/47da34bf.jpg","comment_is_top":false,"comment_ctime":1562326843,"is_pvip":false,"replies":[{"id":"40389","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1562464640,"ip_address":"","comment_id":110764,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562326843","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œ1. è¯»å†™é” ReentrantReadWriteLockè·å–å†™é”çš„æ—¶å€™ä¹Ÿéœ€è¦ç­‰å¾…è¯»é”é‡Šæ”¾åæ‰èƒ½çœŸæ­£è·å–åˆ°æ˜¯å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457042,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562464640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109910,"user_name":"æœ¨æœ¨","can_delete":false,"product_type":"c1","uid":1091401,"ip_address":"","ucode":"14D8A2979D284E","user_header":"https://static001.geekbang.org/account/avatar/00/10/a7/49/9a2c8cfd.jpg","comment_is_top":false,"comment_ctime":1562131318,"is_pvip":false,"replies":[{"id":"39940","content":"è¿™é‡Œæ²¡æœ‰å…·ä½“è®²è§£å…±äº«é”å’Œç‹¬å é”çš„å®ç°ï¼Œåç»­æˆ‘åœ¨è¿™é‡Œè¡¥å……ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1562207758,"ip_address":"","comment_id":109910,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562131318","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè¯»é”æ˜¯ä¸€ä¸ªå…±äº«é”ï¼Œè€Œå†™é”æ˜¯ä¸€ä¸ªç‹¬å é”ï¼Œè¿™ä¸ªåœ¨æ–‡ç« ä¸­å“ªä¸€éƒ¨åˆ†æœ‰è®²è§£å‘¢ï¼Ÿçœ‹äº†ä¸¤éä¸æ˜¯å¾ˆç†è§£ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456636,"discussion_content":"è¿™é‡Œæ²¡æœ‰å…·ä½“è®²è§£å…±äº«é”å’Œç‹¬å é”çš„å®ç°ï¼Œåç»­æˆ‘åœ¨è¿™é‡Œè¡¥å……ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562207758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108080,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1561680714,"is_pvip":false,"replies":[{"id":"39150","content":"RRWçš„è¯»ä¹Ÿæ˜¯æœ‰é”çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦volatieä¿®é¥°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561684140,"ip_address":"","comment_id":108080,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561680714","product_id":100028001,"comment_content":"è€å¸ˆï¼ŒRRWé”çš„è¯»é”åœ¨è·å–é”çš„æ—¶å€™å¦‚æœæ²¡æœ‰å†™é”ï¼Œç›´æ¥å°±å¯ä»¥è·å–åˆ°é”ï¼Œåªä¸è¿‡è·å–é”çš„è¿‡ç¨‹ä¸­è¦ç”¨åˆ°CASæ“ä½œï¼Œç›¸æ¯”äºstampedlockï¼Œè¿™ä¸ªçš„ä¹è§‚é”æ“ä½œå…¶å®æ²¡ç”¨åˆ°ä»»ä½•é”æ“ä½œï¼Œtryçš„è¿‡ç¨‹åªæ˜¯åˆ¤æ–­æœ‰æ²¡æœ‰å†™é”ï¼Œæ²¡æœ‰åˆ™æŠŠå…±äº«å˜é‡çš„å€¼æ‹·è´åˆ°æ ˆé‡Œé¢ï¼Œåé¢çš„validateæ“ä½œï¼Œä¹Ÿæ˜¯å†åˆ¤æ–­æœ‰æ²¡æœ‰å†™é”ï¼Œæ²¡æœ‰åˆ™ç»§ç»­æ“ä½œï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿé‚£æ€è€ƒé¢˜é‡Œçš„é—®é¢˜ï¼Œæ˜¯å› ä¸ºä¹è§‚é”çš„è¿‡ç¨‹é™¤äº†tryå’Œvalidateæ“ä½œåˆ¤æ–­æœ‰æ²¡æœ‰å†™é”ï¼Œå®é™…æ›´æ–°å…±äº«å˜é‡çš„å€¼è¿‡ç¨‹ä¸­æ²¡æœ‰caså’Œé”çš„æ“ä½œï¼Œä¹è§‚é”çš„è¿‡ç¨‹ä¸­å…¶ä»–çº¿ç¨‹è¿˜æ˜¯å¯ä»¥è·å–åˆ°å†™é”ï¼Œæ²¡æ³•æ“ä½œç»“æœä¸€å®šæ­£ç¡®<br><br>æœ€åè¿˜æœ‰ä¸€ä¸ªé—®é¢˜è¿™ä¸¤ç§é”çš„è¯»é”çš„casæ“ä½œåªæ˜¯åœ¨ä¿è¯è·å–é”çš„è¿‡ç¨‹å’Œæ›´æ–°é”çŠ¶æ€çš„è¿‡ç¨‹å§ï¼ŒåŠ é”çš„è¿‡ç¨‹æœ¬èº«æ˜¯è¦æŠŠå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼æ›´æ–°åˆ°æ ˆä¸­ï¼Œå…±äº«å˜é‡æœ¬èº«ä¸ç”¨volatieä¿®é¥°ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455816,"discussion_content":"RRWçš„è¯»ä¹Ÿæ˜¯æœ‰é”çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦volatieä¿®é¥°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561684140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107661,"user_name":"Geek_ebda96","can_delete":false,"product_type":"c1","uid":1134862,"ip_address":"","ucode":"02912E6D95A5A6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoRiaKX0ulEibbbwM4xhjyMeza0Pyp7KO1mqvfJceiaM6ZNtGpXJibI6P2qHGwBP9GKwOt9LgHicHflBXw/132","comment_is_top":false,"comment_ctime":1561594536,"is_pvip":false,"replies":[{"id":"39210","content":"è¿™é‡Œçº æ­£ä¸€ä¸‹ï¼Œåº”è¯¥è¦å…ˆå»åˆ¤æ–­æ˜¯å¦æ˜¯å…¬å¹³é”ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›å…¥åˆ°CLHé˜Ÿåˆ—ä¸­ï¼Œå¦åˆ™ç›´æ¥CASè·å–é”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561694538,"ip_address":"","comment_id":107661,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561594536","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·é—®ä¸€ä¸‹ä¸ºä»€ä¹ˆrrwè·å–é”çš„æ—¶å€™ï¼ŒstateçŠ¶æ€ä¸º0è¿˜æ˜¯éœ€è¦æŠŠå½“å‰çº¿ç¨‹å…ˆåŠ å…¥clhç­‰å¾…é˜Ÿåˆ—ï¼Œä¸ç›´æ¥å»casæ›´æ–°çŠ¶æ€è·å–é”ï¼Œä¸ºäº†å…¬å¹³æ€§å—ï¼Œæ˜¯æ ¹æ®å‚æ•°è®¾ç½®çš„å€¼åˆ¤æ–­çš„å—","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455613,"discussion_content":"è¿™é‡Œçº æ­£ä¸€ä¸‹ï¼Œåº”è¯¥è¦å…ˆå»åˆ¤æ–­æ˜¯å¦æ˜¯å…¬å¹³é”ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›å…¥åˆ°CLHé˜Ÿåˆ—ä¸­ï¼Œå¦åˆ™ç›´æ¥CASè·å–é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561694538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107162,"user_name":"ä½™å†²","can_delete":false,"product_type":"c1","uid":1175598,"ip_address":"","ucode":"162AF434FA753B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f0/2e/b3c880b8.jpg","comment_is_top":false,"comment_ctime":1561471068,"is_pvip":false,"replies":[{"id":"38857","content":"æ²¡æœ‰é”™ï¼Œå¦‚æœstateä¸º0ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å ç”¨é”èµ„æºï¼Œè¿›å…¥CASè·å–é”ï¼›å¦åˆ™ï¼Œåˆ™éœ€è¦ç»§ç»­åˆ¤æ–­é«˜ä½ä½çŠ¶æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561523814,"ip_address":"","comment_id":107162,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561471068","product_id":100028001,"comment_content":"è€å¸ˆï¼Œä½ é‚£ä¸ªrrwè·å–å†™é”æ—¶çš„å›¾ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­åŠå…¶åé¢çš„åˆ¤æ–­ï¼Œç›´çº¿çš„é€»è¾‘ï¼Œåº”è¯¥æ˜¯:æ˜¯ã€‚å¦æ‰åŠ å…¥clhé˜Ÿåˆ—ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455393,"discussion_content":"æ²¡æœ‰é”™ï¼Œå¦‚æœstateä¸º0ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å ç”¨é”èµ„æºï¼Œè¿›å…¥CASè·å–é”ï¼›å¦åˆ™ï¼Œåˆ™éœ€è¦ç»§ç»­åˆ¤æ–­é«˜ä½ä½çŠ¶æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561523814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106564,"user_name":"å°å¸ƒä¸","can_delete":false,"product_type":"c1","uid":1253022,"ip_address":"","ucode":"A9907715455F58","user_header":"https://static001.geekbang.org/account/avatar/00/13/1e/9e/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1561345551,"is_pvip":false,"replies":[{"id":"38829","content":"æ˜¯çš„ï¼Œè¯»é”æ˜¯ä¸€ä¸ªå…±äº«é”ï¼Œè€Œå†™é”æ˜¯ä¸€ä¸ªç‹¬å é”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561514901,"ip_address":"","comment_id":106564,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561345551","product_id":100028001,"comment_content":"è€å¸ˆæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒRRWåœ¨æ²¡æœ‰å†™é”çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¹¶å‘è¯»ï¼Œæ—¢ç„¶å¯ä»¥å¹¶å‘è¯»ä¸ºä»€ä¹ˆè¿˜è¦è·å–é”å‘¢ï¼Ÿæ˜¯ä¸æ˜¯æ„å‘³ç€è¯»é”æ˜¯å¯ä»¥è¢«å¾ˆå¤šçº¿ç¨‹åŒæ—¶æ‹¥æœ‰çš„ï¼Ÿè€Œå†™é”å°±æ˜¯ç‹¬å çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455139,"discussion_content":"æ˜¯çš„ï¼Œè¯»é”æ˜¯ä¸€ä¸ªå…±äº«é”ï¼Œè€Œå†™é”æ˜¯ä¸€ä¸ªç‹¬å é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561514901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106123,"user_name":"å°æ©™æ©™","can_delete":false,"product_type":"c1","uid":1054923,"ip_address":"","ucode":"4F467210A15F66","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/cb/edb5a0a0.jpg","comment_is_top":false,"comment_ctime":1561182548,"is_pvip":false,"replies":[{"id":"38413","content":"è¿™é‡Œç”¨åˆ°stateé«˜ä½ä½è®¾è®¡ï¼Œå¯ä»¥ä¼˜åŒ–é”ç±»å‹çš„åˆ¤æ–­ï¼Œä¾‹å¦‚åªè¦è¢«è·å–é”ï¼Œstateçš„å˜é‡å°±ä¸ä¸º0ï¼Œä¹‹åå†å»é€šè¿‡stateçš„é«˜ä½ä½åˆ¤æ–­æ˜¯è¯»é”è¿˜æ˜¯å†™é”ã€‚<br><br>å½“ç„¶ç”¨æšä¸¾åˆ¤æ–­ä¹Ÿè¡Œï¼Œå¦‚æœç”¨ä¸€ä¸ªintç±»å‹èƒ½å®Œæˆçš„äº‹æƒ…ï¼Œé‚£å°±ä¸ç”¨å†å»ç”¨æšä¸¾ï¼Œè¿™æ ·ä¸ä»…é€»è¾‘æ¸…æ™°ï¼Œä¹ŸèŠ‚çº¦äº†å†…å­˜ç©ºé—´ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561254312,"ip_address":"","comment_id":106123,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561182548","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼ä¸ºä»€ä¹ˆè¯»å†™é”åˆ¤æ–­stateçš„åœ°æ–¹è¦ä½¿ç”¨é«˜ä½ä½è¿™ç§è®¾è®¡å‘¢ï¼Œç›´æ¥ä½¿ç”¨0ã€1ã€2è¿™æ ·çš„æšä¸¾åˆ¤æ–­ç†è§£ä¸Šä¸æ˜¯è¦æ›´ç®€å•å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454964,"discussion_content":"è¿™é‡Œç”¨åˆ°stateé«˜ä½ä½è®¾è®¡ï¼Œå¯ä»¥ä¼˜åŒ–é”ç±»å‹çš„åˆ¤æ–­ï¼Œä¾‹å¦‚åªè¦è¢«è·å–é”ï¼Œstateçš„å˜é‡å°±ä¸ä¸º0ï¼Œä¹‹åå†å»é€šè¿‡stateçš„é«˜ä½ä½åˆ¤æ–­æ˜¯è¯»é”è¿˜æ˜¯å†™é”ã€‚\n\nå½“ç„¶ç”¨æšä¸¾åˆ¤æ–­ä¹Ÿè¡Œï¼Œå¦‚æœç”¨ä¸€ä¸ªintç±»å‹èƒ½å®Œæˆçš„äº‹æƒ…ï¼Œé‚£å°±ä¸ç”¨å†å»ç”¨æšä¸¾ï¼Œè¿™æ ·ä¸ä»…é€»è¾‘æ¸…æ™°ï¼Œä¹ŸèŠ‚çº¦äº†å†…å­˜ç©ºé—´ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1561254312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1980201,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","nickname":"å‡¯æ–‡å°çŒª","note":"","ucode":"36D8AD0229547F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383606,"discussion_content":"å› ä¸ºæ¥å£å®šä¹‰æ—¶åªæœ‰ä¸€ä¸ªå˜é‡state stateä½œä¸ºé‡å…¥æ¬¡æ•°ã€‚ä½†æ˜¯è¯»å†™é”æ˜¾ç„¶æ˜¯ä¸¤æŠŠé” é‚£ä¹ˆåªèƒ½åœ¨ä½æ“ä½œä¸ŠåŠ¨è„‘é™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626179217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105501,"user_name":"shoo","can_delete":false,"product_type":"c1","uid":1482438,"ip_address":"","ucode":"5C0D00A979C9C9","user_header":"https://static001.geekbang.org/account/avatar/00/16/9e/c6/3e5aef4c.jpg","comment_is_top":false,"comment_ctime":1561016520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561016520","product_id":100028001,"comment_content":"    <br>æœ‰ä¸ªé—®é¢˜ï¼Œæœ€è¿‘åœ¨ä¼˜åŒ–ç¨‹åºï¼Œåˆšå¥½çœ‹åˆ°è¿™ä¸€èŠ‚<br>    private ReentrantReadWriteLock lock = new ReentrantReadWriteLock();<br><br>    &#47;&#47;å†™é”<br>    private Lock writeLock = lock.writeLock();<br><br>    writeLock.lock();&#47;&#47;è¿™é‡Œä¸ºä»€ä¹ˆå›æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸","like_count":0},{"had_liked":false,"id":104930,"user_name":"G","can_delete":false,"product_type":"c1","uid":1206873,"ip_address":"","ucode":"35A3A0CD1FF675","user_header":"https://static001.geekbang.org/account/avatar/00/12/6a/59/ba3cad16.jpg","comment_is_top":false,"comment_ctime":1560873227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560873227","product_id":100028001,"comment_content":"ä¸å¯é‡å…¥","like_count":0},{"had_liked":false,"id":104888,"user_name":"ä½ å¥½æ—…è¡Œè€…","can_delete":false,"product_type":"c1","uid":1154101,"ip_address":"","ucode":"5C72A428DC28F3","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/35/9dc79371.jpg","comment_is_top":false,"comment_ctime":1560864023,"is_pvip":false,"replies":[{"id":"38055","content":"åœ¨é”èµ„æºç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œå¶å°”éœ€è¦åŒæ­¥æ—¶ï¼Œä½¿ç”¨synchronizedæ—¢ç®€å•åˆæ–¹ä¾¿ï¼Œè€Œä¸”JVMçš„ç¼–è¯‘å™¨ä¼šå°½å¯èƒ½çš„ä¼˜åŒ–é”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560908085,"ip_address":"","comment_id":104888,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560864023","product_id":100028001,"comment_content":"æ—¢ç„¶Lockçš„æ€§èƒ½åˆæ¯”synchronizedå¥½ï¼Œåˆæä¾›äº†ä¸“é—¨ç”¨äºè¯»å¤šå†™å°‘åœºæ™¯ä¸‹çš„è¯»å†™é”å’ŒStampedLockï¼Œé‚£æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨synchronizedè€Œä¸ç”¨Lockå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454471,"discussion_content":"åœ¨é”èµ„æºç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œå¶å°”éœ€è¦åŒæ­¥æ—¶ï¼Œä½¿ç”¨synchronizedæ—¢ç®€å•åˆæ–¹ä¾¿ï¼Œè€Œä¸”JVMçš„ç¼–è¯‘å™¨ä¼šå°½å¯èƒ½çš„ä¼˜åŒ–é”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560908085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104882,"user_name":"é™†ç¦»","can_delete":false,"product_type":"c1","uid":1483932,"ip_address":"","ucode":"2C8C206CE36A81","user_header":"https://static001.geekbang.org/account/avatar/00/16/a4/9c/b32ed9e9.jpg","comment_is_top":false,"comment_ctime":1560862590,"is_pvip":false,"replies":[{"id":"38090","content":"ğŸ˜","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç‹å†¬é’","uid":"1356014","ctime":1560927736,"ip_address":"","comment_id":104882,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1560862590","product_id":100028001,"comment_content":"è¿™ä¸ªå£°éŸ³å¯ä»¥ã€‚","like_count":0,"discussions":[{"author":{"id":1356014,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b0/ee/d0871efd.jpg","nickname":"å†¬é’","note":"","ucode":"14576781B499FB","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454468,"discussion_content":"ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560927736,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104744,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1560825873,"is_pvip":false,"replies":[{"id":"38047","content":"å¦‚æœåµŒå¥—è°ƒç”¨åˆ™ä¼šå‡ºç°count1ä¸­çš„é”ä¸€ç›´åœ¨ç­‰å¾…countä¸­çš„é”é‡Šæ”¾ï¼Œè¿™ç§æƒ…å†µå°±å‡ºç°æ­»é”äº†ï¼š<br><br>\t\tpublic void count() {<br>\t\t\tlong stamp = s1.writeLock();<br>\t\t\ttry {<br>\t\t\t\tcount1();<br>\t\t\t\tcount++;<br>\t\t\t\t&#47;&#47; System.out.println(&quot;countï¼š&quot; + count);<br>\t\t\t} finally {<br>\t\t\t\ts1.unlockWrite(stamp);<br>\t\t\t}<br>\t\t}<br>\t\t<br>\t\tpublic void count1() {<br>\t\t\tlong stamp = s1.writeLock();<br>\t\t\ttry {<br>\t\t\t\tcount++;<br>\t\t\t\t&#47;&#47; System.out.println(&quot;countï¼š&quot; + count);<br>\t\t\t} finally {<br>\t\t\t\ts1.unlockWrite(stamp);<br>\t\t\t}<br>\t\t}","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560907169,"ip_address":"","comment_id":104744,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560825873","product_id":100028001,"comment_content":"@å¯†ç 123456 ä¸ºä»€ä¹ˆä¼šæœ‰æ­»é”ï¼Ÿçº¿ç¨‹é¥¥é¥¿æˆ‘èƒ½ç†è§£ï¼Œä½†æ­»é”åº”è¯¥æ˜¯ç”±äºäº¤å‰å–é”è¿™ç§å®ç°ç¼ºé™·å¯¼è‡´ã€‚è·Ÿä¸å¯é‡å…¥æœ‰å•¥å…³ç³»ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454404,"discussion_content":"å¦‚æœåµŒå¥—è°ƒç”¨åˆ™ä¼šå‡ºç°count1ä¸­çš„é”ä¸€ç›´åœ¨ç­‰å¾…countä¸­çš„é”é‡Šæ”¾ï¼Œè¿™ç§æƒ…å†µå°±å‡ºç°æ­»é”äº†ï¼š\n\n\t\tpublic void count() {\n\t\t\tlong stamp = s1.writeLock();\n\t\t\ttry {\n\t\t\t\tcount1();\n\t\t\t\tcount++;\n\t\t\t\t// System.out.println(&amp;quot;countï¼š&amp;quot; + count);\n\t\t\t} finally {\n\t\t\t\ts1.unlockWrite(stamp);\n\t\t\t}\n\t\t}\n\t\t\n\t\tpublic void count1() {\n\t\t\tlong stamp = s1.writeLock();\n\t\t\ttry {\n\t\t\t\tcount++;\n\t\t\t\t// System.out.println(&amp;quot;countï¼š&amp;quot; + count);\n\t\t\t} finally {\n\t\t\t\ts1.unlockWrite(stamp);\n\t\t\t}\n\t\t}","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1560907169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104701,"user_name":"nightmare","can_delete":false,"product_type":"c1","uid":1056314,"ip_address":"","ucode":"EF2E51C2122A86","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/3a/5b21c01c.jpg","comment_is_top":false,"comment_ctime":1560819640,"is_pvip":false,"replies":[{"id":"37879","content":"è¿™ä¸€è®²ä¸­çš„ç¬¬ä¸€ä¸ªæµç¨‹å›¾æ˜¯AQSçš„å®ç°åŸç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560824178,"ip_address":"","comment_id":104701,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560819640","product_id":100028001,"comment_content":"è€å¸ˆä¼šä¸ä¼šè®²AQSå‘¢ï¼Œéå¸¸æœŸå¾…","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454380,"discussion_content":"è¿™ä¸€è®²ä¸­çš„ç¬¬ä¸€ä¸ªæµç¨‹å›¾æ˜¯AQSçš„å®ç°åŸç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560824178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104699,"user_name":"nimil","can_delete":false,"product_type":"c1","uid":1197925,"ip_address":"","ucode":"19933068972746","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/65/cce8eb34.jpg","comment_is_top":false,"comment_ctime":1560819518,"is_pvip":false,"replies":[{"id":"37878","content":"éšç€ä¸šåŠ¡çš„å¤æ‚åŒ–ï¼Œæœ‰å¯èƒ½å‡ºç°æ–¹æ³•åµŒå¥—è·å–é”çš„å¯èƒ½ã€‚ä¾‹å¦‚ï¼š<br><br>void A(){<br>   synchronized(lockObj){<br>      do something...<br>      B();<br>   }<br>}<br> <br>void B(){<br>   synchronized(lockObj){<br>      do something...<br>   }","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560824072,"ip_address":"","comment_id":104699,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560819518","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä¸‹ä»€ä¹ˆæ—¶å€™å½“å‰çº¿ç¨‹ä¼šåœ¨è·å–åˆ°é”çš„æƒ…å†µä¸‹å°è¯•å†æ¬¡è·å–é”æ“ä½œå‘¢ï¼Ÿè¿™å—ä¸€ç›´ä¸æ˜¯å¾ˆæ‡‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454379,"discussion_content":"éšç€ä¸šåŠ¡çš„å¤æ‚åŒ–ï¼Œæœ‰å¯èƒ½å‡ºç°æ–¹æ³•åµŒå¥—è·å–é”çš„å¯èƒ½ã€‚ä¾‹å¦‚ï¼š\n\nvoid A(){\n   synchronized(lockObj){\n      do something...\n      B();\n   }\n}\n \nvoid B(){\n   synchronized(lockObj){\n      do something...\n   }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560824072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104691,"user_name":"å¤å¤©39åº¦","can_delete":false,"product_type":"c1","uid":1104979,"ip_address":"","ucode":"A929B422255547","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/53/ccb62ea0.jpg","comment_is_top":false,"comment_ctime":1560818793,"is_pvip":false,"replies":[{"id":"37884","content":"synchronized æ˜¯å¯é‡å…¥çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1560825318,"ip_address":"","comment_id":104691,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560818793","product_id":100028001,"comment_content":"è€å¸ˆï¼Œsyncæ˜¯ä¸å¯é‡å…¥çš„å§","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454377,"discussion_content":"synchronized æ˜¯å¯é‡å…¥çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1560825318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}