{"id":126169,"title":"33ä¸¨å¦‚ä½•ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·å®šä½SQLæ‰§è¡Œæ…¢çš„åŸå› ï¼Ÿ","content":"<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº†æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ŒçŸ¥é“åœ¨æŸ¥è¯¢ä¼˜åŒ–å™¨ä¸­ä¼šç»å†é€»è¾‘æŸ¥è¯¢ä¼˜åŒ–å’Œç‰©ç†æŸ¥è¯¢ä¼˜åŒ–ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨åªèƒ½åœ¨å·²ç»ç¡®å®šçš„æƒ…å†µä¸‹ï¼ˆSQLè¯­å¥ã€ç´¢å¼•è®¾è®¡ã€ç¼“å†²æ± å¤§å°ã€æŸ¥è¯¢ä¼˜åŒ–å™¨å‚æ•°ç­‰å·²çŸ¥çš„æƒ…å†µï¼‰å†³å®šæœ€ä¼˜çš„æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ã€‚</p><p>ä½†å®é™…ä¸ŠSQLæ‰§è¡Œèµ·æ¥å¯èƒ½è¿˜æ˜¯å¾ˆæ…¢ï¼Œé‚£ä¹ˆåˆ°åº•ä»å“ªé‡Œå®šä½SQLæŸ¥è¯¢æ…¢çš„é—®é¢˜å‘¢ï¼Ÿæ˜¯ç´¢å¼•è®¾è®¡çš„é—®é¢˜ï¼ŸæœåŠ¡å™¨å‚æ•°é…ç½®çš„é—®é¢˜ï¼Ÿè¿˜æ˜¯éœ€è¦å¢åŠ ç¼“å­˜çš„é—®é¢˜å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±ä»æ€§èƒ½åˆ†ææ¥å…¥æ‰‹ï¼Œå®šä½å¯¼è‡´SQLæ‰§è¡Œæ…¢çš„åŸå› ã€‚</p><p>ä»Šå¤©çš„å†…å®¹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol>\n<li>æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–åˆ†æçš„æ­¥éª¤æ˜¯æ€æ ·çš„ï¼Ÿä¸­é—´æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Ÿ</li>\n<li>å¦‚ä½•ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—æŸ¥æ‰¾æ‰§è¡Œæ…¢çš„SQLè¯­å¥ï¼Ÿ</li>\n<li>å¦‚ä½•ä½¿ç”¨EXPLAINæŸ¥çœ‹SQLæ‰§è¡Œè®¡åˆ’ï¼Ÿ</li>\n<li>å¦‚ä½•ä½¿ç”¨SHOW PROFILINGåˆ†æSQLæ‰§è¡Œæ­¥éª¤ä¸­çš„æ¯ä¸€æ­¥çš„æ‰§è¡Œæ—¶é—´ï¼Ÿ</li>\n</ol><h2>æ•°æ®åº“æœåŠ¡å™¨çš„ä¼˜åŒ–æ­¥éª¤</h2><p>å½“æˆ‘ä»¬é‡åˆ°æ•°æ®åº“è°ƒä¼˜é—®é¢˜çš„æ—¶å€™ï¼Œè¯¥å¦‚ä½•æ€è€ƒå‘¢ï¼Ÿæˆ‘æŠŠæ€è€ƒçš„æµç¨‹æ•´ç†æˆäº†ä¸‹é¢è¿™å¼ å›¾ã€‚</p><p>æ•´ä¸ªæµç¨‹åˆ’åˆ†æˆäº†è§‚å¯Ÿï¼ˆShow statusï¼‰å’Œè¡ŒåŠ¨ï¼ˆActionï¼‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚å­—æ¯Sçš„éƒ¨åˆ†ä»£è¡¨è§‚å¯Ÿï¼ˆä¼šä½¿ç”¨ç›¸åº”çš„åˆ†æå·¥å…·ï¼‰ï¼Œå­—æ¯Aä»£è¡¨çš„éƒ¨åˆ†æ˜¯è¡ŒåŠ¨ï¼ˆå¯¹åº”åˆ†æå¯ä»¥é‡‡å–çš„è¡ŒåŠ¨ï¼‰ã€‚<br>\n<img src=\"https://static001.geekbang.org/resource/image/99/37/998b1a255fe608856ac043eb9c36d237.png?wh=800*1523\" alt=\"\"><br>\næˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿäº†è§£æ•°æ®åº“æ•´ä½“çš„è¿è¡ŒçŠ¶æ€ï¼Œé€šè¿‡æ€§èƒ½åˆ†æå·¥å…·å¯ä»¥è®©æˆ‘ä»¬äº†è§£æ‰§è¡Œæ…¢çš„SQLéƒ½æœ‰å“ªäº›ï¼ŒæŸ¥çœ‹å…·ä½“çš„SQLæ‰§è¡Œè®¡åˆ’ï¼Œç”šè‡³æ˜¯SQLæ‰§è¡Œä¸­çš„æ¯ä¸€æ­¥çš„æˆæœ¬ä»£ä»·ï¼Œè¿™æ ·æ‰èƒ½å®šä½é—®é¢˜æ‰€åœ¨ï¼Œæ‰¾åˆ°äº†é—®é¢˜ï¼Œå†é‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚</p><!-- [[[read_end]]] --><p>æˆ‘æ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™å¼ å›¾ã€‚</p><p>é¦–å…ˆåœ¨S1éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦è§‚å¯ŸæœåŠ¡å™¨çš„çŠ¶æ€æ˜¯å¦å­˜åœ¨å‘¨æœŸæ€§çš„æ³¢åŠ¨ã€‚å¦‚æœå­˜åœ¨å‘¨æœŸæ€§æ³¢åŠ¨ï¼Œæœ‰å¯èƒ½æ˜¯å‘¨æœŸæ€§èŠ‚ç‚¹çš„åŸå› ï¼Œæ¯”å¦‚åŒåä¸€ã€ä¿ƒé”€æ´»åŠ¨ç­‰ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡A1è¿™ä¸€æ­¥éª¤è§£å†³ï¼Œä¹Ÿå°±æ˜¯åŠ ç¼“å­˜ï¼Œæˆ–è€…æ›´æ”¹ç¼“å­˜å¤±æ•ˆç­–ç•¥ã€‚</p><p>å¦‚æœç¼“å­˜ç­–ç•¥æ²¡æœ‰è§£å†³ï¼Œæˆ–è€…ä¸æ˜¯å‘¨æœŸæ€§æ³¢åŠ¨çš„åŸå› ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›ä¸€æ­¥åˆ†ææŸ¥è¯¢å»¶è¿Ÿå’Œå¡é¡¿çš„åŸå› ã€‚æ¥ä¸‹æ¥è¿›å…¥S2è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å¼€å¯æ…¢æŸ¥è¯¢ã€‚æ…¢æŸ¥è¯¢å¯ä»¥å¸®æˆ‘ä»¬å®šä½æ‰§è¡Œæ…¢çš„SQLè¯­å¥ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®<code>long_query_time</code>å‚æ•°å®šä¹‰â€œæ…¢â€çš„é˜ˆå€¼ï¼Œå¦‚æœSQLæ‰§è¡Œæ—¶é—´è¶…è¿‡äº†<code>long_query_time</code>ï¼Œåˆ™ä¼šè®¤ä¸ºæ˜¯æ…¢æŸ¥è¯¢ã€‚å½“æ”¶é›†ä¸Šæ¥è¿™äº›æ…¢æŸ¥è¯¢ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ†æå·¥å…·å¯¹æ…¢æŸ¥è¯¢æ—¥å¿—è¿›è¡Œåˆ†æã€‚</p><p>åœ¨S3è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†æ‰§è¡Œæ…¢çš„SQLè¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥é’ˆå¯¹æ€§åœ°ç”¨EXPLAINæŸ¥çœ‹å¯¹åº”SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œæˆ–è€…ä½¿ç”¨SHOW PROFILEæŸ¥çœ‹SQLä¸­æ¯ä¸€ä¸ªæ­¥éª¤çš„æ—¶é—´æˆæœ¬ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥äº†è§£SQLæŸ¥è¯¢æ…¢æ˜¯å› ä¸ºæ‰§è¡Œæ—¶é—´é•¿ï¼Œè¿˜æ˜¯ç­‰å¾…æ—¶é—´é•¿ã€‚</p><p>å¦‚æœæ˜¯SQLç­‰å¾…æ—¶é—´é•¿ï¼Œæˆ‘ä»¬è¿›å…¥A2æ­¥éª¤ã€‚åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒä¼˜æœåŠ¡å™¨çš„å‚æ•°ï¼Œæ¯”å¦‚é€‚å½“å¢åŠ æ•°æ®åº“ç¼“å†²æ± ç­‰ã€‚å¦‚æœæ˜¯SQLæ‰§è¡Œæ—¶é—´é•¿ï¼Œå°±è¿›å…¥A3æ­¥éª¤ï¼Œè¿™ä¸€æ­¥ä¸­æˆ‘ä»¬éœ€è¦è€ƒè™‘æ˜¯ç´¢å¼•è®¾è®¡çš„é—®é¢˜ï¼Ÿè¿˜æ˜¯æŸ¥è¯¢å…³è”çš„æ•°æ®è¡¨è¿‡å¤šï¼Ÿè¿˜æ˜¯å› ä¸ºæ•°æ®è¡¨çš„å­—æ®µè®¾è®¡é—®é¢˜å¯¼è‡´äº†è¿™ä¸€ç°è±¡ã€‚ç„¶ååœ¨è¿™äº›ç»´åº¦ä¸Šè¿›è¡Œå¯¹åº”çš„è°ƒæ•´ã€‚</p><p>å¦‚æœA2å’ŒA3éƒ½ä¸èƒ½è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ•°æ®åº“è‡ªèº«çš„SQLæŸ¥è¯¢æ€§èƒ½æ˜¯å¦å·²ç»è¾¾åˆ°äº†ç“¶é¢ˆï¼Œå¦‚æœç¡®è®¤æ²¡æœ‰è¾¾åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œå°±éœ€è¦é‡æ–°æ£€æŸ¥ï¼Œé‡å¤ä»¥ä¸Šçš„æ­¥éª¤ã€‚å¦‚æœå·²ç»è¾¾åˆ°äº†æ€§èƒ½ç“¶é¢ˆï¼Œè¿›å…¥A4é˜¶æ®µï¼Œéœ€è¦è€ƒè™‘å¢åŠ æœåŠ¡å™¨ï¼Œé‡‡ç”¨è¯»å†™åˆ†ç¦»çš„æ¶æ„ï¼Œæˆ–è€…è€ƒè™‘å¯¹æ•°æ®åº“åˆ†åº“åˆ†è¡¨ï¼Œæ¯”å¦‚å‚ç›´åˆ†åº“ã€å‚ç›´åˆ†è¡¨å’Œæ°´å¹³åˆ†è¡¨ç­‰ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æ•°æ®åº“è°ƒä¼˜çš„æµç¨‹æ€è·¯ã€‚å½“æˆ‘ä»¬å‘ç°æ‰§è¡ŒSQLæ—¶å­˜åœ¨ä¸è§„åˆ™å»¶è¿Ÿæˆ–å¡é¡¿çš„æ—¶å€™ï¼Œå°±å¯ä»¥é‡‡ç”¨åˆ†æå·¥å…·å¸®æˆ‘ä»¬å®šä½æœ‰é—®é¢˜çš„SQLï¼Œè¿™ä¸‰ç§åˆ†æå·¥å…·ä½ å¯ä»¥ç†è§£æ˜¯SQLè°ƒä¼˜çš„ä¸‰ä¸ªæ­¥éª¤ï¼šæ…¢æŸ¥è¯¢ã€EXPLAINå’ŒSHOW PROFILEã€‚</p><h2>ä½¿ç”¨æ…¢æŸ¥è¯¢å®šä½æ‰§è¡Œæ…¢çš„SQL</h2><p>æ…¢æŸ¥è¯¢å¯ä»¥å¸®æˆ‘ä»¬æ‰¾åˆ°æ‰§è¡Œæ…¢çš„SQLï¼Œåœ¨ä½¿ç”¨å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸‹æ…¢æŸ¥è¯¢æ˜¯å¦å·²ç»å¼€å¯ï¼Œä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤å³å¯ï¼š</p><pre><code>mysql &gt; show variables like '%slow_query_log';\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/9e/35/9efe05b732290a3ed0132597e2ca0f35.png?wh=1138*386\" alt=\"\"><br>\næˆ‘ä»¬èƒ½çœ‹åˆ°<code>slow_query_log=OFF</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ…¢æŸ¥è¯¢æ—¥å¿—æ­¤æ—¶æ˜¯å…³ä¸Šçš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ…¢æŸ¥è¯¢æ—¥å¿—æ‰“å¼€ï¼Œæ³¨æ„è®¾ç½®å˜é‡å€¼çš„æ—¶å€™éœ€è¦ä½¿ç”¨globalï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š</p><pre><code>mysql &gt; set global slow_query_log='ON';\n</code></pre><p>ç„¶åæˆ‘ä»¬å†æ¥æŸ¥çœ‹ä¸‹æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯ï¼Œä»¥åŠæ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶çš„ä½ç½®ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/20/11/20d327118c221ada2bb123a4ce975e11.png?wh=1253*425\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°è¿™æ—¶æ…¢æŸ¥è¯¢åˆ†æå·²ç»å¼€å¯ï¼ŒåŒæ—¶æ–‡ä»¶ä¿å­˜åœ¨DESKTOP-4BK02RP-slowæ–‡ä»¶ä¸­ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹æ…¢æŸ¥è¯¢çš„æ—¶é—´é˜ˆå€¼è®¾ç½®ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>mysql &gt; show variables like '%long_query_time%';\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/a7/7a/a752b54a3fa38af449b55ccd0e628e7a.png?wh=1203*388\" alt=\"\"></p><p>è¿™é‡Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠæ—¶é—´ç¼©çŸ­ï¼Œæ¯”å¦‚è®¾ç½®ä¸º3ç§’ï¼Œå¯ä»¥è¿™æ ·è®¾ç½®ï¼š</p><pre><code>mysql &gt; set global long_query_time = 3;\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/a1/49/a17e97c29e0c66177e2844ae96189449.png?wh=1205*533\" alt=\"\"><br>\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨MySQLè‡ªå¸¦çš„mysqldumpslowå·¥å…·ç»Ÿè®¡æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆè¿™ä¸ªå·¥å…·æ˜¯ä¸ªPerlè„šæœ¬ï¼Œä½ éœ€è¦å…ˆå®‰è£…å¥½Perlï¼‰ã€‚</p><p>mysqldumpslowå‘½ä»¤çš„å…·ä½“å‚æ•°å¦‚ä¸‹ï¼š</p><ul>\n<li>-sï¼šé‡‡ç”¨orderæ’åºçš„æ–¹å¼ï¼Œæ’åºæ–¹å¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§ã€‚åˆ†åˆ«æ˜¯cï¼ˆè®¿é—®æ¬¡æ•°ï¼‰ã€tï¼ˆæŸ¥è¯¢æ—¶é—´ï¼‰ã€lï¼ˆé”å®šæ—¶é—´ï¼‰ã€rï¼ˆè¿”å›è®°å½•ï¼‰ã€acï¼ˆå¹³å‡æŸ¥è¯¢æ¬¡æ•°ï¼‰ã€alï¼ˆå¹³å‡é”å®šæ—¶é—´ï¼‰ã€arï¼ˆå¹³å‡è¿”å›è®°å½•æ•°ï¼‰å’Œatï¼ˆå¹³å‡æŸ¥è¯¢æ—¶é—´ï¼‰ã€‚å…¶ä¸­atä¸ºé»˜è®¤æ’åºæ–¹å¼ã€‚</li>\n<li>-tï¼šè¿”å›å‰Næ¡æ•°æ® ã€‚</li>\n<li>-gï¼šåé¢å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚</li>\n</ul><p>æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æŒ‰ç…§æŸ¥è¯¢æ—¶é—´æ’åºï¼ŒæŸ¥çœ‹å‰ä¸¤æ¡SQLè¯­å¥ï¼Œè¿™æ ·å†™å³å¯ï¼š</p><pre><code>perl mysqldumpslow.pl -s t -t 2 &quot;C:\\ProgramData\\MySQL\\MySQL Server 8.0\\Data\\DESKTOP-4BK02RP-slow.log&quot;\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/5b/44/5bded5220b76bfe20c59bb2968cc3744.png?wh=1730*342\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°å¼€å¯äº†æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶è®¾ç½®äº†ç›¸åº”çš„æ…¢æŸ¥è¯¢æ—¶é—´é˜ˆå€¼ä¹‹åï¼Œåªè¦æŸ¥è¯¢æ—¶é—´å¤§äºè¿™ä¸ªé˜ˆå€¼çš„SQLè¯­å¥éƒ½ä¼šä¿å­˜åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡mysqldumpslowå·¥å…·æå–æƒ³è¦æŸ¥æ‰¾çš„SQLè¯­å¥äº†ã€‚</p><h2>å¦‚ä½•ä½¿ç”¨EXPLAINæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’</h2><p>å®šä½äº†æŸ¥è¯¢æ…¢çš„SQLä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨EXPLAINå·¥å…·åšé’ˆå¯¹æ€§çš„åˆ†æï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦äº†è§£product_commentå’Œuserè¡¨è¿›è¡Œè”æŸ¥çš„æ—¶å€™æ‰€é‡‡ç”¨çš„çš„æ‰§è¡Œè®¡åˆ’ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡è¯­å¥ï¼š</p><pre><code>EXPLAIN SELECT comment_id, product_id, comment_text, product_comment.user_id, user_name FROM product_comment JOIN user on product_comment.user_id = user.user_id \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/ab/13/ab63d280a507eeb327bf154a0e87bf13.png?wh=1729*96\" alt=\"\"><br>\nEXPLAINå¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£æ•°æ®è¡¨çš„è¯»å–é¡ºåºã€SELECTå­å¥çš„ç±»å‹ã€æ•°æ®è¡¨çš„è®¿é—®ç±»å‹ã€å¯ä½¿ç”¨çš„ç´¢å¼•ã€å®é™…ä½¿ç”¨çš„ç´¢å¼•ã€ä½¿ç”¨çš„ç´¢å¼•é•¿åº¦ã€ä¸Šä¸€ä¸ªè¡¨çš„è¿æ¥åŒ¹é…æ¡ä»¶ã€è¢«ä¼˜åŒ–å™¨æŸ¥è¯¢çš„è¡Œçš„æ•°é‡ä»¥åŠé¢å¤–çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯å¦ä½¿ç”¨äº†å¤–éƒ¨æ’åºï¼Œæ˜¯å¦ä½¿ç”¨äº†ä¸´æ—¶è¡¨ç­‰ï¼‰ç­‰ã€‚</p><p>SQLæ‰§è¡Œçš„é¡ºåºæ˜¯æ ¹æ®idä»å¤§åˆ°å°æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯idè¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼Œå½“idç›¸åŒæ—¶ï¼Œä»ä¸Šåˆ°ä¸‹æ‰§è¡Œã€‚</p><p>æ•°æ®è¡¨çš„è®¿é—®ç±»å‹æ‰€å¯¹åº”çš„typeåˆ—æ˜¯æˆ‘ä»¬æ¯”è¾ƒå…³æ³¨çš„ä¿¡æ¯ã€‚typeå¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/22/92/223e8c7b863bd15c83f25e3d93958692.png?wh=1106*606\" alt=\"\"><br>\nåœ¨è¿™äº›æƒ…å†µé‡Œï¼Œallæ˜¯æœ€åçš„æƒ…å†µï¼Œå› ä¸ºé‡‡ç”¨äº†å…¨è¡¨æ‰«æçš„æ–¹å¼ã€‚indexå’Œallå·®ä¸å¤šï¼Œåªä¸è¿‡indexå¯¹ç´¢å¼•è¡¨è¿›è¡Œå…¨æ‰«æï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ä¸å†éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œä½†æ˜¯å¼€é”€ä¾ç„¶å¾ˆå¤§ã€‚å¦‚æœæˆ‘ä»¬åœ¨Extralåˆ—ä¸­çœ‹åˆ°Using indexï¼Œè¯´æ˜é‡‡ç”¨äº†ç´¢å¼•è¦†ç›–ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•å¯ä»¥è¦†ç›–æ‰€éœ€çš„SELECTå­—æ®µï¼Œå°±ä¸éœ€è¦è¿›è¡Œå›è¡¨ï¼Œè¿™æ ·å°±å‡å°‘äº†æ•°æ®æŸ¥æ‰¾çš„å¼€é”€ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬å¯¹product_commentæ•°æ®è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè®¾è®¡äº†è”åˆç´¢å¼•<code>composite_index (user_id, comment_text)</code>ï¼Œç„¶åå¯¹æ•°æ®è¡¨ä¸­çš„<code>comment_id</code>ã€<code>comment_text</code>ã€<code>user_id</code>è¿™ä¸‰ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œæœ€åç”¨EXPLAINçœ‹ä¸‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT comment_id, comment_text, user_id FROM product_comment \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/07/8f/07a47b0146b0e881381f78812914568f.png?wh=1730*77\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°è¿™é‡Œçš„è®¿é—®æ–¹å¼é‡‡ç”¨äº†indexçš„æ–¹å¼ï¼Œkeyåˆ—é‡‡ç”¨äº†è”åˆç´¢å¼•ï¼Œè¿›è¡Œæ‰«æã€‚Extralåˆ—ä¸ºUsing indexï¼Œå‘Šè¯‰æˆ‘ä»¬ç´¢å¼•å¯ä»¥è¦†ç›–SELECTä¸­çš„å­—æ®µï¼Œä¹Ÿå°±ä¸éœ€è¦å›è¡¨æŸ¥è¯¢äº†ã€‚</p><p>rangeè¡¨ç¤ºé‡‡ç”¨äº†ç´¢å¼•èŒƒå›´æ‰«æï¼Œè¿™é‡Œä¸è¿›è¡Œä¸¾ä¾‹ï¼Œä»è¿™ä¸€çº§åˆ«å¼€å§‹ï¼Œç´¢å¼•çš„ä½œç”¨ä¼šè¶Šæ¥è¶Šæ˜æ˜¾ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°½é‡è®©SQLæŸ¥è¯¢å¯ä»¥ä½¿ç”¨åˆ°rangeè¿™ä¸€çº§åˆ«åŠä»¥ä¸Šçš„typeè®¿é—®æ–¹å¼ã€‚</p><p>index_mergeè¯´æ˜æŸ¥è¯¢åŒæ—¶ä½¿ç”¨äº†ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„ç´¢å¼•ï¼Œæœ€åå–äº†äº¤é›†æˆ–è€…å¹¶é›†ã€‚æ¯”å¦‚æƒ³è¦å¯¹<code>comment_id=500000</code> æˆ–è€…<code>user_id=500000</code>çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œæ•°æ®è¡¨ä¸­comment_idä¸ºä¸»é”®ï¼Œuser_idæ˜¯æ™®é€šç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT comment_id, product_id, comment_text, user_id FROM product_comment WHERE comment_id = 500000 OR user_id = 500000\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/4d/7e/4d07052ad81616f1d3b37bdb0a32067e.png?wh=1730*63\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°è¿™é‡ŒåŒæ—¶ä½¿ç”¨åˆ°äº†ä¸¤ä¸ªç´¢å¼•ï¼Œåˆ†åˆ«æ˜¯ä¸»é”®å’Œuser_idï¼Œé‡‡ç”¨çš„æ•°æ®è¡¨è®¿é—®ç±»å‹æ˜¯index_mergeï¼Œé€šè¿‡unionçš„æ–¹å¼å¯¹ä¸¤ä¸ªç´¢å¼•æ£€ç´¢çš„æ•°æ®è¿›è¡Œåˆå¹¶ã€‚</p><p>refç±»å‹è¡¨ç¤ºé‡‡ç”¨äº†éå”¯ä¸€ç´¢å¼•ï¼Œæˆ–è€…æ˜¯å”¯ä¸€ç´¢å¼•çš„éå”¯ä¸€æ€§å‰ç¼€ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦å¯¹<code>user_id=500000</code>çš„è¯„è®ºè¿›è¡ŒæŸ¥è¯¢ï¼Œä½¿ç”¨EXPLAINæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT comment_id, comment_text, user_id FROM product_comment WHERE user_id = 500000 \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/0a/b6/0a98105a776ce82bf6503fcad2ebe2b6.png?wh=1729*82\" alt=\"\"><br>\nè¿™é‡Œuser_idä¸ºæ™®é€šç´¢å¼•ï¼ˆå› ä¸ºuser_idåœ¨å•†å“è¯„è®ºè¡¨ä¸­å¯èƒ½æ˜¯é‡å¤çš„ï¼‰ï¼Œå› æ­¤é‡‡ç”¨çš„è®¿é—®ç±»å‹æ˜¯refï¼ŒåŒæ—¶åœ¨refåˆ—ä¸­æ˜¾ç¤ºconstï¼Œè¡¨ç¤ºè¿æ¥åŒ¹é…æ¡ä»¶æ˜¯å¸¸é‡ï¼Œç”¨äºç´¢å¼•åˆ—çš„æŸ¥æ‰¾ã€‚</p><p>eq_refç±»å‹æ˜¯ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ—¶äº§ç”Ÿçš„è®¿é—®æ–¹å¼ï¼Œé€šå¸¸ä½¿ç”¨åœ¨å¤šè¡¨è”æŸ¥ä¸­ã€‚å‡è®¾æˆ‘ä»¬å¯¹<code>product_comment</code>è¡¨å’Œuserè¡¨è¿›è¡Œè”æŸ¥ï¼Œå…³è”æ¡ä»¶æ˜¯ä¸¤å¼ è¡¨çš„user_idç›¸ç­‰ï¼Œä½¿ç”¨EXPLAINè¿›è¡Œæ‰§è¡Œè®¡åˆ’æŸ¥çœ‹ï¼š</p><pre><code>EXPLAIN SELECT * FROM product_comment JOIN user WHERE product_comment.user_id = user.user_id \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/59/33/59a1c808e79e2462fa6ffe5d7623d433.png?wh=1730*106\" alt=\"\"><br>\nconstç±»å‹è¡¨ç¤ºæˆ‘ä»¬ä½¿ç”¨äº†ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•ï¼ˆæ‰€æœ‰çš„éƒ¨åˆ†ï¼‰ä¸å¸¸é‡å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹<code>comment_id=500000</code>ï¼ŒæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT comment_id, comment_text, user_id FROM product_comment WHERE comment_id = 500000 \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/6c/34/6c95ac56a800f1a89e3fb461418a4334.png?wh=1730*77\" alt=\"\"><br>\néœ€è¦è¯´æ˜çš„æ˜¯constç±»å‹å’Œeq_reféƒ½ä½¿ç”¨äº†ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ï¼Œä¸è¿‡è¿™ä¸¤ä¸ªç±»å‹æœ‰æ‰€åŒºåˆ«ï¼Œconstæ˜¯ä¸å¸¸é‡è¿›è¡Œæ¯”è¾ƒï¼ŒæŸ¥è¯¢æ•ˆç‡ä¼šæ›´å¿«ï¼Œè€Œeq_refé€šå¸¸ç”¨äºå¤šè¡¨è”æŸ¥ä¸­ã€‚</p><p>systemç±»å‹ä¸€èˆ¬ç”¨äºMyISAMæˆ–Memoryè¡¨ï¼Œå±äºconstç±»å‹çš„ç‰¹ä¾‹ï¼Œå½“è¡¨åªæœ‰ä¸€è¡Œæ—¶è¿æ¥ç±»å‹ä¸ºsystemï¼ˆæˆ‘åœ¨GitHubä¸Šä¸Šä¼ äº†test_myisamæ•°æ®è¡¨ï¼Œè¯¥æ•°æ®è¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼Œä¸‹è½½åœ°å€ï¼š<a href=\"https://github.com/cystanford/SQL_MyISAM\">https://github.com/cystanford/SQL_MyISAM</a>ï¼‰ã€‚æˆ‘ä»¬æŸ¥çœ‹ä¸‹æ‰§è¡Œè®¡åˆ’ï¼š</p><pre><code>EXPLAIN SELECT * FROM test_myisam\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/9c/c6/9c2160c4f11d023ece153fcf34f639c6.png?wh=1730*90\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°é™¤äº†allç±»å‹å¤–ï¼Œå…¶ä»–ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨åˆ°ç´¢å¼•ï¼Œä½†æ˜¯ä¸åŒçš„è¿æ¥æ–¹å¼çš„æ•ˆç‡ä¹Ÿä¼šæœ‰æ‰€ä¸åŒï¼Œæ•ˆç‡ä»ä½åˆ°é«˜ä¾æ¬¡ä¸ºall &lt; index &lt; range &lt; index_merge &lt; ref &lt; eq_ref &lt; const/systemã€‚æˆ‘ä»¬åœ¨æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’çš„æ—¶å€™ï¼Œé€šå¸¸å¸Œæœ›æ‰§è¡Œè®¡åˆ’è‡³å°‘å¯ä»¥ä½¿ç”¨åˆ°rangeçº§åˆ«ä»¥ä¸Šçš„è¿æ¥æ–¹å¼ï¼Œå¦‚æœåªä½¿ç”¨åˆ°äº†allæˆ–è€…indexè¿æ¥æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä»SQLè¯­å¥å’Œç´¢å¼•è®¾è®¡çš„è§’åº¦ä¸Šè¿›è¡Œæ”¹è¿›ã€‚</p><h2>ä½¿ç”¨SHOW PROFILEæŸ¥çœ‹SQLçš„å…·ä½“æ‰§è¡Œæˆæœ¬</h2><p>SHOW PROFILEç›¸æ¯”EXPLAINèƒ½çœ‹åˆ°æ›´è¿›ä¸€æ­¥çš„æ‰§è¡Œè§£æï¼ŒåŒ…æ‹¬SQLéƒ½åšäº†ä»€ä¹ˆã€æ‰€èŠ±è´¹çš„æ—¶é—´ç­‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œprofilingæ˜¯å…³é—­çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¼šè¯çº§åˆ«å¼€å¯è¿™ä¸ªåŠŸèƒ½ã€‚</p><pre><code>mysql &gt; show variables like 'profiling';\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/db/96/db06756d6d8c0614c2a7574b0f6ba896.png?wh=1013*384\" alt=\"\"><br>\né€šè¿‡è®¾ç½®<code>profiling='ON'</code>æ¥å¼€å¯show profileï¼š</p><pre><code>mysql &gt; set profiling = 'ON';\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/11/bd/113b83ee204c9e9bbd4d8bd406abafbd.png?wh=1211*542\" alt=\"\"><br>\næˆ‘ä»¬å¯ä»¥çœ‹ä¸‹å½“å‰ä¼šè¯éƒ½æœ‰å“ªäº›profilesï¼Œä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š</p><pre><code>mysql &gt; show profiles;\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/d0/80/d0f2ceae31f260f7b3e5f4e2a96e7280.png?wh=1700*416\" alt=\"\"><br>\nä½ èƒ½çœ‹åˆ°å½“å‰ä¼šè¯ä¸€å…±æœ‰2ä¸ªæŸ¥è¯¢ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æŸ¥çœ‹ä¸Šä¸€ä¸ªæŸ¥è¯¢çš„å¼€é”€ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p><pre><code>mysql &gt; show profile;\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/80/0d/80a0962163ddd49e728f45d2bcd9fc0d.png?wh=1042*1197\" alt=\"\"><br>\næˆ‘ä»¬ä¹Ÿå¯ä»¥æŸ¥çœ‹æŒ‡å®šçš„Query IDçš„å¼€é”€ï¼Œæ¯”å¦‚<code>show profile for query 2</code>æŸ¥è¯¢ç»“æœæ˜¯ä¸€æ ·çš„ã€‚åœ¨SHOW PROFILEä¸­æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸åŒéƒ¨åˆ†çš„å¼€é”€ï¼Œæ¯”å¦‚cpuã€block.ioç­‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ec/83/ec4a633bff55a96aa831155a59bc1e83.png?wh=1730*863\" alt=\"\"><br>\né€šè¿‡ä¸Šé¢çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¼„æ¸…æ¥šæ¯ä¸€æ­¥éª¤çš„è€—æ—¶ï¼Œä»¥åŠåœ¨ä¸åŒéƒ¨åˆ†ï¼Œæ¯”å¦‚CPUã€block.io çš„æ‰§è¡Œæ—¶é—´ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å‡ºæ¥SQLåˆ°åº•æ…¢åœ¨å“ªé‡Œã€‚</p><p>ä¸è¿‡SHOW PROFILEå‘½ä»¤å°†è¢«å¼ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»information_schemaä¸­çš„profilingæ•°æ®è¡¨è¿›è¡ŒæŸ¥çœ‹ã€‚</p><h2>æ€»ç»“</h2><p>æˆ‘ä»Šå¤©æ¢³ç†äº†SQLä¼˜åŒ–çš„æ€è·¯ï¼Œä»æ­¥éª¤ä¸Šçœ‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¿›è¡Œè§‚å¯Ÿå’Œåˆ†æï¼Œåˆ†æå·¥å…·çš„ä½¿ç”¨åœ¨æ—¥å¸¸å·¥ä½œä¸­è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚ä»Šå¤©åªä»‹ç»äº†å¸¸ç”¨çš„ä¸‰ç§åˆ†æå·¥å…·ï¼Œå®é™…ä¸Šå¯ä»¥ä½¿ç”¨çš„åˆ†æå·¥å…·è¿˜æœ‰å¾ˆå¤šã€‚</p><p>æˆ‘åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ä»Šå¤©æ–‡ç« é‡Œæåˆ°çš„ä¸‰ç§åˆ†æå·¥å…·ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—å®šä½æ‰§è¡Œæ…¢çš„SQLï¼Œç„¶åé€šè¿‡EXPLAINåˆ†æè¯¥SQLè¯­å¥æ˜¯å¦ä½¿ç”¨åˆ°äº†ç´¢å¼•ï¼Œä»¥åŠå…·ä½“çš„æ•°æ®è¡¨è®¿é—®æ–¹å¼æ˜¯æ€æ ·çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨SHOW PROFILEè¿›ä¸€æ­¥äº†è§£SQLæ¯ä¸€æ­¥çš„æ‰§è¡Œæ—¶é—´ï¼ŒåŒ…æ‹¬I/Oå’ŒCPUç­‰èµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚</p><p><img src=\"\" alt=\"\"></p><p>ä»Šå¤©æˆ‘ä»‹ç»äº†EXPLAINå’ŒSHOW PROFILEè¿™ä¸¤ä¸ªå·¥å…·ï¼Œä½ è¿˜ä½¿ç”¨è¿‡å“ªäº›åˆ†æå·¥å…·å‘¢ï¼Ÿ</p><p>å¦å¤–æˆ‘ä»¬åœ¨è¿›è¡Œæ•°æ®è¡¨è¿æ¥çš„æ—¶å€™ï¼Œä¼šæœ‰å¤šç§è®¿é—®ç±»å‹ï¼Œä½ å¯ä»¥è®²ä¸€ä¸‹refã€eq_refå’Œ const è¿™ä¸‰ç§ç±»å‹çš„åŒºåˆ«å—ï¼ŸæŸ¥è¯¢æ•ˆç‡æœ‰ä½•ä¸åŒï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµè¿›æ­¥ã€‚</p>","neighbors":{"left":{"article_title":"32ä¸¨æŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ","id":125429},"right":{"article_title":"34ä¸¨ç­”ç–‘ç¯‡ï¼šå…³äºç´¢å¼•ä»¥åŠç¼“å†²æ± çš„ä¸€äº›è§£æƒ‘","id":127873}},"comments":[{"had_liked":false,"id":127725,"user_name":"DZ","can_delete":false,"product_type":"c1","uid":1132240,"ip_address":"","ucode":"452555FA0F9E0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/46/d0/6bafd7d4.jpg","comment_is_top":false,"comment_ctime":1566784750,"is_pvip":false,"replies":[{"id":"47661","content":"å¯¹çš„ï¼Œæ‰€ä»¥æ•ˆç‡ä¸Šæ¥è¯´ä¸€èˆ¬æ˜¯ ref &lt; eq_ref &lt; const","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1566900596,"ip_address":"","comment_id":127725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"151890640110","product_id":100029501,"comment_content":"å¦‚æœä¸¤è¡¨å…³è”æŸ¥è¯¢ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š<br><br>1. ref - åŒå±‚å¾ªç¯ï¼Œç›´åˆ°æ‰¾å‡ºæ‰€æœ‰åŒ¹é…ã€‚<br>2. eq_ref - åŒå±‚å¾ªç¯ï¼Œå€ŸåŠ©ç´¢å¼•çš„å”¯ä¸€æ€§ï¼Œæ‰¾åˆ°åŒ¹é…å°±é©¬ä¸Šé€€å‡ºå†…å±‚å¾ªç¯ã€‚<br>3. const: å•å±‚å¾ªç¯ã€‚<br><br>æŒ‰ç…§å¾ªç¯æ¬¡æ•°é€’å‡çš„é¡ºåºæ’åˆ—å®ƒä»¬ï¼Œåº”è¯¥æ˜¯ ref &gt; eq_ref &gt; constï¼Œå¾ªç¯æ¬¡æ•°è¶Šå°‘ï¼ŒæŸ¥è¯¢æ•ˆç‡è¶Šé«˜ã€‚","like_count":36,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464622,"discussion_content":"å¯¹çš„ï¼Œæ‰€ä»¥æ•ˆç‡ä¸Šæ¥è¯´ä¸€èˆ¬æ˜¯ ref &amp;lt; eq_ref &amp;lt; const","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566900596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128610,"user_name":"leslie","can_delete":false,"product_type":"c1","uid":1324255,"ip_address":"","ucode":"798E7C1CC98CC2","user_header":"https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg","comment_is_top":false,"comment_ctime":1566913483,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"121825997771","product_id":100029501,"comment_content":"      explainçœ‹çš„ä¸œè¥¿ä¸æ­¢è¿™ç‚¹å§ï¼šè€å¸ˆæ˜¯ä¸æ˜¯é’ˆå¯¹é”™äº†DBï¼Œè‡³å°‘ç°å®ç”Ÿäº§è¿™ç‚¹ä¸œè¥¿çš„å®šä½å®Œå…¨ä¸å¤Ÿï¼›è€å¸ˆåœ¨ç”Ÿäº§ä¸­ä¸çœ‹è¡¨çš„çŠ¶æ€å°±åšexplainä¹ˆï¼Ÿå¦‚æœè¡¨çš„DMLè¿‡é«˜çš„è¯ï¼Œexplainçš„æ“ä½œå®Œå…¨æ²¡æœ‰ä»·å€¼ã€‚<br>     å¦‚æœä¸€å¼ è¡¨çš„è‡ªå¢è·‘åˆ°äº†100ä¸‡ï¼Œæ•°æ®é‡åªæœ‰10ä¸‡ï¼›è¯´æ˜è¿™å¼ è¡¨å¯èƒ½å·²ç»æŸåäº†ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯ä¿®å¤è¡¨è€Œä¸æ˜¯ä¸€å¼€å§‹åšexplainã€‚å°±åƒæˆ‘ä»¬æ‹¿åˆ°ä¸€å°è®¾å¤‡ä¸æ˜¯å…ˆå»æµ‹åŠŸèƒ½ï¼Œé¦–å…ˆåº”å½“åšæŒè®¾å¤‡æ˜¯å¦å®Œå…¨OKå†å»æµ‹è¯•ï¼Œæ•°æ®åº“ä¸å¯èƒ½æ‹¿åˆ°çš„æ˜¯ä¸€å¼ å…¨æ–°çš„è¡¨ï¼›é¦–å…ˆåº”å½“æ˜¯è¡¨çš„æ€§èƒ½è¯„ä¼°ï¼Œç„¶åå†è¯´ç›¸å…³çš„æ£€æŸ¥å§ã€‚<br>       ä¸ªäººè§‰å¾—ä»Šå¤©çš„è®²è§£çš„æ—¶å€™æ¼äº†çœŸæ­£çš„ç¬¬ä¸€æ­¥ï¼šè®¾å¤‡æ²¡åšæŒå°±å¼€å§‹æ£€æŸ¥è®¾å¤‡æ€§èƒ½äº†ã€‚<br>    ","like_count":29,"discussions":[{"author":{"id":1716015,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/2f/2f/f434b676.jpg","nickname":"èƒŒé å’¸ğŸŸé‡è§ğŸ±","note":"","ucode":"30113675864F23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408822,"discussion_content":"è¡¨çš„æ€§èƒ½è¯„ä¼°æ˜¯æ€ä¹ˆè¿›è¡Œçš„å•Šã€‚ã€‚ã€‚ä¸æ‡‚å°±é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635327502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1364281,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d1/39/9feb690e.jpg","nickname":"-Destroyall","note":"","ucode":"182DE1018A3236","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387091,"discussion_content":"1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627979440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127701,"user_name":"åœŸåœŸäºº","can_delete":false,"product_type":"c1","uid":1045486,"ip_address":"","ucode":"6501B7D4F63E95","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/ee/33ef689b.jpg","comment_is_top":false,"comment_ctime":1566781971,"is_pvip":true,"replies":[{"id":"62751","content":"æœ‰çš„ï¼Œæ¯”å¦‚Oracleè‡ªå¸¦çš„AWRå·¥å…·","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577089111,"ip_address":"","comment_id":127701,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23041618451","product_id":100029501,"comment_content":"oracleæ˜¯å¦æœ‰å¯¹åº”å·¥å‘¢ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464613,"discussion_content":"æœ‰çš„ï¼Œæ¯”å¦‚Oracleè‡ªå¸¦çš„AWRå·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577089111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128176,"user_name":"LJK","can_delete":false,"product_type":"c1","uid":1199213,"ip_address":"","ucode":"12B2441099FF1D","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","comment_is_top":false,"comment_ctime":1566849248,"is_pvip":false,"replies":[{"id":"47660","content":"ä¸€èˆ¬æ¥è¯´sending dataç›¸æ¯”äºå…¶ä»–éƒ¨åˆ†ä¼šæ¯”è¾ƒé•¿ã€‚ä½ ä¹Ÿå¯ä»¥æŸ¥çœ‹ä¸åŒçš„æ¨¡å—æ—¶é—´ï¼Œæ¯”å¦‚SHOW PROFILE cpu,block_io for query ...","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1566900461,"ip_address":"","comment_id":128176,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18746718432","product_id":100029501,"comment_content":"SHOW PROFILEè¿˜ä¼šå†æœ‰ç»†è‡´ä¸€ç‚¹çš„è¯´æ˜ä¹ˆï¼Ÿä¸€èˆ¬çœ‹åˆ°éƒ½æ˜¯sending dataè¿™ä¸ªæ—¶é—´æœ€é•¿ï¼Œä¸çŸ¥é“åŒ…å«äº†å“ªäº›å…·ä½“æ“ä½œåœ¨é‡Œé¢ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464824,"discussion_content":"ä¸€èˆ¬æ¥è¯´sending dataç›¸æ¯”äºå…¶ä»–éƒ¨åˆ†ä¼šæ¯”è¾ƒé•¿ã€‚ä½ ä¹Ÿå¯ä»¥æŸ¥çœ‹ä¸åŒçš„æ¨¡å—æ—¶é—´ï¼Œæ¯”å¦‚SHOW PROFILE cpu,block_io for query ...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566900461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127774,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1566790857,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18746660041","product_id":100029501,"comment_content":"ä½ å¯ä»¥è®²ä¸€ä¸‹ refã€eq_ref å’Œ const è¿™ä¸‰ç§ç±»å‹çš„åŒºåˆ«å—ï¼ŸæŸ¥è¯¢æ•ˆç‡æœ‰ä½•ä¸åŒï¼Ÿ<br>ref æ˜¯ä½¿ç”¨äº†éå”¯ä¸€ç´¢å¼•<br>eq_ref æ˜¯ä½¿ç”¨äº†ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•ï¼Œä¸€èˆ¬åœ¨ä¸¤è¡¨è¿æ¥æŸ¥è¯¢ä¸­ç´¢å¼•<br>const æ˜¯ä½¿ç”¨äº†ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼• ä¸å¸¸é‡å€¼è¿›è¡Œæ¯”è¾ƒ<br><br>æŸ¥è¯¢æ•ˆç‡ ref &lt; eq_ref &lt; const","like_count":5},{"had_liked":false,"id":196622,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1585297681,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14470199569","product_id":100029501,"comment_content":"å½“å‰ä¼šè¯æ˜¯ä»£è¡¨ä»€ä¹ˆï¼Œå½“å‰äº‹åŠ¡ä¹ˆ","like_count":2},{"had_liked":false,"id":128375,"user_name":"å¬é›¨","can_delete":false,"product_type":"c1","uid":1254493,"ip_address":"","ucode":"252754F9FCFF0C","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","comment_is_top":false,"comment_ctime":1566876368,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10156810960","product_id":100029501,"comment_content":"ç”¨EXPLAINæŸ¥çœ‹SQLæ‰§è¡Œé¡ºåºï¼šå¦‚æœSQLä½¿ç”¨EXISTSåµŒå¥—å­æŸ¥è¯¢ï¼ŒæŒ‰è¯´ï¼Œæ‰§è¡Œé¡ºåºæ˜¯å…ˆæ‰§è¡Œä¸»æŸ¥è¯¢ï¼Œå†æ‰§è¡Œå­æŸ¥è¯¢ï¼Œä½†æ˜¯EXPLAINå‡ºæ¥çš„ç»“æœæ˜¯ä¸»æŸ¥è¯¢çš„idä¸º1ï¼Œå­æŸ¥è¯¢çš„idä¸º2ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯å…ˆæ‰§è¡Œçš„å­æŸ¥è¯¢ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢","like_count":3,"discussions":[{"author":{"id":2962599,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/34/a7/52c4ea60.jpg","nickname":"å¹´å°‘æŒ½æ»‘ç¨½ä¸–æ— åŒ","note":"","ucode":"793DCBDE25A07B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588407,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663745257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å››å·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127656,"user_name":"å®‰é™çš„boy","can_delete":false,"product_type":"c1","uid":1196475,"ip_address":"","ucode":"F5F44B75228A85","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/bb/21ce60d2.jpg","comment_is_top":false,"comment_ctime":1566775910,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10156710502","product_id":100029501,"comment_content":"index_mergeçš„é‚£ä¸ªä¾‹å­ä¸­ï¼ŒæŸ¥è¯¢çš„typeæ€ä¹ˆæ˜¯ref","like_count":2},{"had_liked":false,"id":290626,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1619664980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5914632276","product_id":100029501,"comment_content":"æƒ³é—®ä¸€ä¸‹ï¼Œè¿ç»´çš„é‚£ä¸ªMySQLæ…¢SQLçš„é¡µé¢æ€ä¹ˆå¼„å‡ºæ¥çš„çš„ï¼Œå°±æ˜¯ç”©ç»™æˆ‘ä¸€ä¸ªç½‘é¡µåœ°å€ï¼Œé‡Œé¢æ˜¯SLOW LOG PLATFORMé‡Œé¢çš„è¯¦ç»†æ…¢sqlæ—¥å¿—ï¼Œæ¯•ç«Ÿæ˜¯é¡µé¢ï¼Œæ„Ÿè§‰çœ‹èµ·æ¥è¦æ¯”å»æœåŠ¡å™¨çœ‹è¾“å‡ºå‹å¥½ä¸€ç‚¹ã€‚<br>æ˜¯ä»€ä¹ˆå·¥å…·ï¼Œæ­å»ºåœ¨è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¯ä»¥é€‰æ‹©æ•°æ®åº“ï¼Œé€‰æ‹©ç”¨æˆ·çš„æŸ¥çœ‹æ—¥å¿—è¯¦æƒ…ï¼Œè‡ªå·±ç©ï¼Œå®‰è£…çš„è¯å¯¹æœåŠ¡å™¨è¦æ±‚é«˜å—<br>","like_count":2},{"had_liked":false,"id":196893,"user_name":"æ±ªzZ","can_delete":false,"product_type":"c1","uid":1234757,"ip_address":"","ucode":"8B93062A683902","user_header":"https://static001.geekbang.org/account/avatar/00/12/d7/45/d1621188.jpg","comment_is_top":false,"comment_ctime":1585321762,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"5880289058","product_id":100029501,"comment_content":"EXPLAINé‚£é‡Œæœ‰äº›ä¸å¤ªæ¸…æ¥šï¼Œè¿˜æœ‰è¦æ˜¯æœ‰ä¸€äº›ç»éªŒä¸Šçš„é˜ˆå€¼åˆ†æå°±å¥½äº†","like_count":1},{"had_liked":false,"id":302746,"user_name":"andy","can_delete":false,"product_type":"c1","uid":1154153,"ip_address":"","ucode":"66FA6DABD5BD3B","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/69/d16ea710.jpg","comment_is_top":false,"comment_ctime":1626351880,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626351880","product_id":100029501,"comment_content":"ç­‰å¾…æ—¶é—´å’Œæ‰§è¡Œæ—¶é—´æ˜¯åœ¨å“ªé‡ŒæŸ¥ï¼Ÿ","like_count":0},{"had_liked":false,"id":263379,"user_name":"beyondzhao","can_delete":false,"product_type":"c1","uid":1003123,"ip_address":"","ucode":"439C944D5B1192","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/73/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1606120230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606120230","product_id":100029501,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸‹ï¼Œæ…¢æŸ¥è¯¢é‡Œæœ€åé‚£ä¸ªä¾‹å­é‡Œï¼Œé‡‡ç”¨ mysqldumpslow æŒ‰æ—¶é—´æ’åºæŸ¥çœ‹å‰ä¸¤æ¡ SQL æŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢ç»“æœé‡Œç¬¬äºŒæ¡æŸ¥è¯¢è¯­å¥ Time=164.04sï¼ˆ656sï¼‰ï¼Œæ‹¬å·é‡Œçš„656ç§’è¡¨ç¤ºä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå“ªä¸€ä¸ªæ‰æ˜¯è¿™æ¡ SQL è¯­å¥æŸ¥è¯¢çš„è€—æ—¶å‘¢?","like_count":0},{"had_liked":false,"id":203519,"user_name":"å¼ æ»”","can_delete":false,"product_type":"c1","uid":1322636,"ip_address":"","ucode":"87ABAFF0E861E0","user_header":"https://static001.geekbang.org/account/avatar/00/14/2e/8c/b261e15a.jpg","comment_is_top":false,"comment_ctime":1586226211,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586226211","product_id":100029501,"comment_content":"æˆ‘ç»™é¢†å¯¼æå‡ºçš„å»ºè®®æ˜¯å¼€å¯æ…¢æŸ¥è¯¢ï¼Œç„¶åæ ¹æ®æ…¢æŸ¥è¯¢æ¥ä¼˜åŒ–sqlï¼Œä½†é¢†å¯¼è¯´è¿™æ ·çš„è¯å·¥ä½œä¼šæ‹–æ‹–æ²“æ²“ï¼Œè¦æ±‚æˆ‘æŠŠæˆ‘ä»¬ç³»ç»Ÿçš„æ‰€æœ‰sqlæ•´ç†å‡ºæ¥è¿›è¡Œä¼˜åŒ–ï¼Œæ‚¨èµåŒæˆ‘é¢†å¯¼çš„åšæ³•å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1111183,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f4/8f/06bd9544.jpg","nickname":"AlphaGao","note":"","ucode":"862000415389FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305326,"discussion_content":"æ•´ç†å‡ºæ¥æ˜¯å‡†å¤‡è‚‰çœ¼ä¼˜åŒ–å—å“ˆå“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599878961,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195142,"user_name":"åšå¼ˆ","can_delete":false,"product_type":"c1","uid":1433344,"ip_address":"","ucode":"B1A69837E41972","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/EcYNib1bnDf5dz6JcrE8AoyZYMdqic2VNmbBtCcVZTO9EoDZZxqlQDEqQKo6klCCmklOtN9m0dTd2AOXqSneJYLw/132","comment_is_top":false,"comment_ctime":1585140443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585140443","product_id":100029501,"comment_content":"é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œäº†è§£äº†å¦‚ä½•ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·å®šä½SQLæ‰§è¡Œæ…¢çš„åŸå› ï¼Œå¸Œæœ›èƒ½åœ¨å®è·µä¸­è¿ç”¨ã€‚","like_count":0},{"had_liked":false,"id":163401,"user_name":"ç«¹å½±","can_delete":false,"product_type":"c1","uid":1532231,"ip_address":"","ucode":"40386DFA60F899","user_header":"https://static001.geekbang.org/account/avatar/00/17/61/47/0a6e9729.jpg","comment_is_top":false,"comment_ctime":1576717404,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576717404","product_id":100029501,"comment_content":"å¤šè¡¨è”æŸ¥çš„æ—¶å€™ï¼ŒSQLçš„æ‰§è¡Œé¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿwhereåä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼Ÿ","like_count":0},{"had_liked":false,"id":128921,"user_name":"law","can_delete":false,"product_type":"c1","uid":1037514,"ip_address":"","ucode":"3B664E2667ED63","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d4/ca/bdb348db.jpg","comment_is_top":false,"comment_ctime":1566984141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566984141","product_id":100029501,"comment_content":"ç”Ÿäº§ç¯å¢ƒé‡åˆ°ä¸€ç§æƒ…å†µï¼Œæœ‰ä¸¤ä¸ªç»„åˆç´¢å¼•ï¼šcoupon_code(tenant_id,coupon_code,platforms), idx_eq_coupon8(tenant_id,end_date,state),æœ‰ä¸ªæŸ¥è¯¢æ¡ä»¶æŒ‰ç…§ç¬¬äºŒä¸ªç»„åˆç´¢å¼•çš„æ¡ä»¶æŸ¥è¯¢ï¼Œä½†æ²¡æœ‰ç”¨åˆ°ç¬¬äºŒä¸ªç´¢å¼•ï¼Œè€Œæ˜¯ç”¨åˆ°äº†ç¬¬ä¸€ä¸ªï¼Œéº»çƒ¦è€å¸ˆå¸®å¿™åˆ†æä¸‹è¿™ç§æƒ…å†µæ€ä¹ˆå®šä½ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0},{"had_liked":false,"id":128771,"user_name":"Jack ä¹","can_delete":false,"product_type":"c1","uid":1205795,"ip_address":"","ucode":"D5E36481290E60","user_header":"https://static001.geekbang.org/account/avatar/00/12/66/23/d67cc01a.jpg","comment_is_top":false,"comment_ctime":1566960355,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1566960355","product_id":100029501,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼ç™¾ä¸‡çº§å¤§è¡¨åˆ›å»ºè”åˆç´¢å¼•ï¼Œå¯¼è‡´é˜»å¡ç°è±¡ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1135990,"avatar":"https://static001.geekbang.org/account/avatar/00/11/55/76/a55871ab.jpg","nickname":"å­™åº†è‰¯","note":"","ucode":"CA05C4CFEFB0F9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311191,"discussion_content":"é—®é¢˜å¤ªç²—äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602249165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}