{"id":352065,"title":"开篇词 | Spark性能调优，你该掌握这些“套路”","content":"<p>你好，我是吴磊，欢迎和我一起探索 Spark 应用的性能优化。</p><p>2020年6月，Spark正式发布了新版本，从2.4直接跨越到了3.0。这次大版本升级的亮点就在于性能优化，它添加了诸如自适应查询执行（AQE）、动态分区剪裁（DPP）、扩展的Join Hints等新特性。</p><p>其实，在3.0版本发布之前，Spark就已然成为了分布式数据处理技术的事实标准。在数据科学与机器学习魔力象限中，Gartner更是连续3年（2018~2020）将Databricks（Spark云原生商业版本）提名为Market Leader。</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/01/c98c4978a48fd52538a99583b48e6601.jpg?wh=1920*2133\" alt=\"\"></p><p>自然而然地，<strong>Spark也成为了各大头部互联网公司的标配，在海量数据处理上，扮演着不可或缺的关键角色</strong>。比如，字节跳动基于Spark构建的数据仓库去服务几乎所有的产品线，包括抖音、今日头条、西瓜视频、火山视频等。再比如，百度基于Spark推出BigSQL，为海量用户提供次秒级的即席查询。</p><p>可以预见的是，<strong>这次版本升级带来的新特性，会让Spark在未来5到10年继续雄霸大数据生态圈。</strong></p><p>而说到我和Spark的缘分，可以追溯到2014年。一次偶然的机会，我参与到了Spark的调研。深入研究之后，我对Spark高效的执行性能深深着迷，这也让我未来的职业发展都和Spark紧紧地绑在了一起。就这样，我从数据分析、数据挖掘领域，转移到了现在的商业智能和机器学习领域，一直不停地尝试探索数据中蕴含的核心价值。</p><!-- [[[read_end]]] --><p>目前，我在FreeWheel带领团队负责机器学习的应用与落地。我们所有已落地和正在启动的项目，都在使用Spark进行数据探索、数据处理、数据分析、特征工程和样本工程。除此之外，我们还会经常基于Spark在海量数据上进行模型训练和模型推理。</p><p>如果你也和我一样，正沿着数据规划自己的职业路径，那么精通Spark也必定是你的职业目标之一。</p><h2>精通Spark，你需要一把叫做“性能调优”的万能钥匙</h2><p>目前，Spark有海量批处理、实时流计算、图计算、数据分析和机器学习这5大应用场景，不论你打算朝哪个方向深入，性能调优都是你职业进阶必须要跨越的一步。</p><p><img src=\"https://static001.geekbang.org/resource/image/1b/be/1b271125207a917916f0a45389df75be.jpg?wh=1896*1446\" alt=\"\"></p><p>为什么这么说呢？原因很简单，<strong>对于这5大场景来说，提升执行性能是刚需</strong>。</p><p>图计算和机器学习往往需要上百次迭代才能收敛，如果没有性能保障，这类作业不可能完成计算。流计算和数据分析对于响应实时性的要求非常高，没有高效的执行性能，不可能做到在亚秒级完成处理。</p><p>相比其他场景，批处理对于执行效率的要求是最低的，但是，在日增数据量以TB、甚至PB为单位计数的当下，想要在小时级别完成海量数据处理，不做性能调优简直是天方夜谭。</p><p>因此，我认为这5大场景就像是5扇门，每扇门背后都别有洞天，而<strong>性能调优就像是一把“万能钥匙”</strong>。有了这把钥匙在手，你才能如入无人之境，去探索更广阔的世界。</p><h2>为什么性能调优不能“照葫芦画瓢”？</h2><p>其实，我身边很多开发人员也都意识到了这一点，他们会去网上搜集一些教程进行学习。但是，目前关于Spark性能调优的资料，大都不是很系统，或者只是在讲一些常规的调优技巧和方法。而对于一些大神分享的调优手段，我们往往“照葫芦画瓢”做出来的东西，也总是达不到预期的效果，比如：</p><ul>\n<li>明明都是内存计算，为什么我用了RDD/DataFrame Cache，性能反而更差了？</li>\n<li>网上吹得神乎其神的调优手段，为啥到了我这就不好使呢？</li>\n<li>并行度设置得也不低，为啥我的CPU利用率还是上不去？</li>\n<li>节点内存几乎全都划给Spark用了，为啥我的应用还是OOM？</li>\n</ul><p>这些问题看似简单，但真不是一两句话就能说得清的。<strong>这需要我们深入Spark的核心原理，不断去尝试每一个API、算子，设置不同的配置参数，最终找出最佳的排列组合。</strong></p><p>那么问题来了，这该怎么做呢？接下来，我就和你分享一下，我是怎么学习性能调优的。</p><p>刚刚接触Spark那会儿，我觉得它的开发效率是真高啊！MapReduce上千行代码才能实现的业务功能，Spark几十行代码就搞定了！</p><p>后来，随着客户要求的不断提高，以及我个人的“较真行为”，为了让应用能跑得更快，我几乎把所有的RDD API查了个遍，仔细研究每一个算子的含义和运行原理，汇总不同算子的适用场景，总结哪些算子会引入Shuffle，对比同类功能算子的差异与优劣势，比如map和mapPartitions，再比如groupByKey、reduceByKey和aggregateByKey。</p><p>除此之外，Spark官网的Configuration页面我也查阅了无数次，汇总与性能有关的配置项，不停地做对比实验，比较不同参数配置下的执行性能。遇到与认知不符的实验结果，就再回去反复咀嚼Spark的核心原理，从RDD和调度系统，到内存管理和存储系统，再到内存计算和Shuffle，如此往复，乐此不疲。</p><p>虽然失败的次数非常多，但成倍的性能提升带来的惊喜让我久久不能忘怀。后来，我就把我的经验分享给身边的同事，在帮助他们进行调优的过程中，我也有意识地把我接触到的案例整理了起来，<strong>从点到线、从线到面，</strong>我逐渐摸清了性能调优的脉络，最终总结出一套关于性能调优的方法论，也因此建立起了以性能为导向的开发习惯。</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/eb/b53099170df81c6dfb629254f5bf82eb.jpg?wh=2568*3066\" alt=\"\"></p><p><strong>遵循这套方法论，开发者可以按图索骥地去开展性能调优工作，做到有的放矢、事半功倍。</strong>我希望在这个专栏里把它分享给你。</p><h2>学得快，也要学得好</h2><p>结合方法论，我把专栏划分为了3个部分：原理篇、性能篇和实战篇。</p><p><span class=\"orange\">原理篇：聚焦Spark底层原理，打通性能调优的任督二脉</span></p><p>Spark的原理非常多，但我会聚焦于那些与性能调优息息相关的核心概念，包括<strong>RDD、DAG、调度系统、存储系统和内存管理</strong>。我会力求用最贴切的故事和类比、最少的篇幅，让你在最短的时间内掌握这5大概念的核心原理，为后续的性能调优打下坚实的基础。</p><p><span class=\"orange\">性能篇：实际案例驱动，多角度解读，全方位解析性能调优技巧</span></p><p>我们刚才说了，Spark的应用场景非常多，主要分为海量批处理、实时流计算、图计算、数据分析和机器学习这5个。但在所有的子框架里，Spark对Spark SQL的倾斜和倚重也是有目共睹，所以性能篇我主要分两部分来讲。</p><p><strong>一部分是讲解性能调优的通用技巧，包括应用开发的基本原则、配置项的设置、Shuffle的优化，以及资源利用率的提升。</strong>首先，我会从常见的例子入手，教你怎么在不改变代码逻辑的情况下快速提升执行能。其次，我会带你去归纳与执行效率相关的配置项。接着，针对Shuffle、数据关联这些典型场景，我们一起去分析有效的应对策略。最后，我们再从硬件视角出发，带你探讨如何最大化资源利用率，在整体上提升Spark的执行性能。</p><p>虽然，不同应用场景的开发API和运行原理都有所不同，但是性能调优的本质和方法论是一样的。因此，这类技巧不限定应用场景，适用于所有Spark子框架。</p><p><strong>另一部分我会专注于数据分析领域，借助如Tungsten、AQE这样的Spark内置优化项和数据关联这样的典型场景，来和你聊聊Spark SQL中的调优方法和技巧。</strong></p><p>首先，我会带你深入挖掘Tungsten、Catalyst优化器和Spark 3.0发布的诸多新特性，充分利用Spark已有的优化机制，让性能调优站到一个更高的起点上。接着，我会借助数据分析的典型场景案例，如数据清洗、数据关联、数据转换等等，带你case-by-case地去归纳调优的思路与方法。</p><p>值得一提的是，随着所有子框架的开发API陆续迁移到DataFrame，我们在每个子框架之上开发的应用，都将受益于Spark SQL的性能提升。换句话说，尽管这部分调优技巧围绕数据分析领域展开，但其中的思路和方法，也同样适用于其他子框架。</p><p><span class=\"orange\">实战篇：打造属于自己的分布式应用</span></p><p>在实战篇，为了帮助你实践我们的方法论和调优技巧。我会以2011~2019的《北京市汽油车摇号》数据为例，<strong>手把手教你打造一个分布式应用，带你从不同角度洞察汽油车摇号的趋势和走向</strong>。我相信，通过这个实战案例，你对性能调优技巧和思路的把控肯定会有一个“质的飞跃”。</p><p>除此之外，我还会不定期地针对一些热点话题进行加餐：比如和Flink、Presto相比，Spark有哪些优势；再比如Spark的一些新特性，以及业界对于Spark的新探索。这也能帮助我们更好地面对变化，把握先机。</p><p><img src=\"https://static001.geekbang.org/resource/image/88/1e/8886909e1eda59a1d7e7ab45243b991e.jpg?wh=1563*5760\" alt=\"\"></p><p>最后我想说，我一直希望把学习变成一件有趣又轻松的事情，所以在这个专栏里，我会用一个个小故事和实例，来帮助你理解Spark的核心原理，引导你建立以性能为导向的开发思维，以及从不同视角汇总性能调优的方法和技巧，<strong>让你像读小说一样去弄懂Spark</strong>。</p><p>我也期望，你能像小说里的主人公一样，利用“调优技巧和方法论”这本武功秘籍，一路过五关、斩六将，打败现实中层出不穷的开发问题，在职业发展中更上一层楼。</p><p>最后，欢迎你在这里畅所欲言，提出你的困惑和疑问，也欢迎多多给我留言，你们的鼓励是我的动力。让我们一起拿起性能调优这把万能钥匙，去开启全新的Spark职业生涯吧！</p>","comments":[{"had_liked":false,"id":283716,"user_name":"布兰特","can_delete":false,"product_type":"c1","uid":1526892,"ip_address":"","ucode":"EE3316C188EC3C","user_header":"https://static001.geekbang.org/account/avatar/00/17/4c/6c/11fb0f1d.jpg","comment_is_top":false,"comment_ctime":1615895597,"is_pvip":true,"replies":[{"id":"104443","content":"共同进步～","user_name":"作者回复","comment_id":283716,"uid":"1043100","ip_address":"","utype":1,"ctime":1618058074,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"44565568557","product_id":100073401,"comment_content":"四年Spark经验  乖乖的来听课","like_count":10,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517125,"discussion_content":"共同进步～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308508,"user_name":"zhongmin","can_delete":false,"product_type":"c1","uid":1265621,"ip_address":"","ucode":"C7AB10205A4F04","user_header":"https://static001.geekbang.org/account/avatar/00/13/4f/d5/1666b7d0.jpg","comment_is_top":false,"comment_ctime":1629652432,"is_pvip":true,"replies":[{"id":"111710","content":"把它当个手册或者字典，有需要的时候再查。内容太多了，没必要地毯式扫描，平时开发的时候，有API忘了，或者某个函数忘了，再去翻就是了。翻得多了，一些常用的机会记得比较牢了。<br><br>那些不太常用的，暂时不理他好了~ 没关系的。总之是问题导向、目的导向。","user_name":"作者回复","comment_id":308508,"uid":"1043100","ip_address":"","utype":1,"ctime":1629702514,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"14514554320","product_id":100073401,"comment_content":"老师平时是怎么利用spark的官网文档的呢？感觉官网文档很全，但是比较的多，看着看着就忘记了","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525512,"discussion_content":"把它当个手册或者字典，有需要的时候再查。内容太多了，没必要地毯式扫描，平时开发的时候，有API忘了，或者某个函数忘了，再去翻就是了。翻得多了，一些常用的机会记得比较牢了。\n\n那些不太常用的，暂时不理他好了~ 没关系的。总之是问题导向、目的导向。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629702514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290890,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1619838403,"is_pvip":false,"replies":[{"id":"105411","content":"没错，严重同意，调优的本质是“平衡”，是一门关于平衡的学问。光靠怼硬件是不对的，既不经济、也不划算，最重要的是，出不来效果。<br><br>看到你的名字，让我想起曾经打Dota的时光，哈哈哈！AOE（Area Of Effect）范围性技能，老弟五一节快乐！一起加油~","user_name":"作者回复","comment_id":290890,"uid":"1043100","ip_address":"","utype":1,"ctime":1619861037,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"14504740291","product_id":100073401,"comment_content":"这个五一打算把这门课从头开始学完赶上老师更新的进度。先分享下自己在使用Spark过程中的一些经验吧：很多的调优参数都是需要根据任务的数据量、计算量来动态调整的，很多时候并不是是说资源申请的越多性能就越好，有时候资源申请过多反而会出问题。","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519308,"discussion_content":"没错，严重同意，调优的本质是“平衡”，是一门关于平衡的学问。光靠怼硬件是不对的，既不经济、也不划算，最重要的是，出不来效果。\n\n看到你的名字，让我想起曾经打Dota的时光，哈哈哈！AOE（Area Of Effect）范围性技能，老弟五一节快乐！一起加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619861037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348128,"user_name":"淡C","can_delete":false,"product_type":"c1","uid":2696647,"ip_address":"","ucode":"046DE6F5301044","user_header":"https://static001.geekbang.org/account/avatar/00/29/25/c7/edd74dfb.jpg","comment_is_top":false,"comment_ctime":1654762492,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5949729788","product_id":100073401,"comment_content":"看完零基础入门Spark来的，老师零基础入门Spark+Spark性能调优感觉可以让我在简历上写熟悉Spark了，干货很多<br>","like_count":1},{"had_liked":false,"id":293470,"user_name":"威猛的小老虎","can_delete":false,"product_type":"c1","uid":1785715,"ip_address":"","ucode":"817F254E6D28E2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ2tyVlQiaqp5kEOf1LlZB6nJPicN8lzcEkAsSEDmicvib8T3xUEcDibRichLrh3Qiclo3UyuAhhKNGQxGmg/132","comment_is_top":false,"comment_ctime":1621398127,"is_pvip":false,"replies":[{"id":"106268","content":"咱们的专栏就是在讲Spark优化的套路呀~<br><br>先是方法论，然后是理论基础、调优技巧，技巧又分为通用技巧和Spark SQL技巧。希望专栏的内容能帮到你哈~","user_name":"作者回复","comment_id":293470,"uid":"1043100","ip_address":"","utype":1,"ctime":1621407441,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"5916365423","product_id":100073401,"comment_content":"老师，请问下你是如何系统的学习spark的优化。目前学习感觉没有什么切入点","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520229,"discussion_content":"咱们的专栏就是在讲Spark优化的套路呀~\n\n先是方法论，然后是理论基础、调优技巧，技巧又分为通用技巧和Spark SQL技巧。希望专栏的内容能帮到你哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621407441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292482,"user_name":"果子","can_delete":false,"product_type":"c1","uid":1051904,"ip_address":"","ucode":"0A669B6DE26F21","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PNmB3mOQ4jTSoDMGPwp5j8a2NL1Mibu4iaebBNnuDQltb2yZ3sygJpxTHuLrG9ewCDLEialorSK3pzXBCQ3JFCZPA/132","comment_is_top":false,"comment_ctime":1620837003,"is_pvip":false,"replies":[{"id":"105924","content":"这个范畴有点略大哈~ 具体指的哪方面呢？<br><br>我们确实是算法团队，做机器学习在计算广告业务的应用和落地，整条机器学习流水线上涉及的环节比较多，比如：<br>数据提取、处理、清洗、探索<br>特征工程、样本工程<br>模型训练、预测、验证<br><br>你说的数据探索和特征工程，具体想了解哪方面呢？是数据处理的逻辑、或者说功能上的用法？还是说性能上的调优？如果是性能调优的话，其实27、28、29讲会有不少真实的调优案例，那些都来自于我们平时的工作，到时候可以关注下哈~","user_name":"作者回复","comment_id":292482,"uid":"1043100","ip_address":"","utype":1,"ctime":1620888523,"user_name_real":"吴磊"}],"discussion_count":4,"race_medal":0,"score":"5915804299","product_id":100073401,"comment_content":"老师可不可以分享一下数据探索，特征工程的一些经验。","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519846,"discussion_content":"这个范畴有点略大哈~ 具体指的哪方面呢？\n\n我们确实是算法团队，做机器学习在计算广告业务的应用和落地，整条机器学习流水线上涉及的环节比较多，比如：\n数据提取、处理、清洗、探索\n特征工程、样本工程\n模型训练、预测、验证\n\n你说的数据探索和特征工程，具体想了解哪方面呢？是数据处理的逻辑、或者说功能上的用法？还是说性能上的调优？如果是性能调优的话，其实27、28、29讲会有不少真实的调优案例，那些都来自于我们平时的工作，到时候可以关注下哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620888523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377034,"discussion_content":"机器学习这块话题确实比较大，后面考虑看要不要单独开辟个机器学习相关的专栏~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622470499,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1645081,"avatar":"https://static001.geekbang.org/account/avatar/00/19/1a/19/440b0c7e.jpg","nickname":"学无止境","note":"","ucode":"BE6ADDF082AA69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":547036,"discussion_content":"期待老师的专栏呀~~~磊哥，你出啥我都看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642501149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":377034,"ip_address":""},"score":547036,"extra":""}]},{"author":{"id":1051904,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PNmB3mOQ4jTSoDMGPwp5j8a2NL1Mibu4iaebBNnuDQltb2yZ3sygJpxTHuLrG9ewCDLEialorSK3pzXBCQ3JFCZPA/132","nickname":"果子","note":"","ucode":"0A669B6DE26F21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374192,"discussion_content":"感谢老师的回复，就是如何构建特征工程，针对数据特点选取合适的算法，我们主要处理时序数据，针对时序数据处理有没有好的建议。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621057808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358974,"user_name":"Juha","can_delete":false,"product_type":"c1","uid":1347609,"ip_address":"北京","ucode":"5B9301CC960D84","user_header":"https://static001.geekbang.org/account/avatar/00/14/90/19/b3403815.jpg","comment_is_top":false,"comment_ctime":1665110079,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1665110079","product_id":100073401,"comment_content":"老师好，咨询一个比较基础的问题，咱们日常工作中，是使用纯Spark SQL多还是使用Scala写程序多呢","like_count":0},{"had_liked":false,"id":333529,"user_name":"lumos","can_delete":false,"product_type":"c1","uid":1158686,"ip_address":"","ucode":"62C2B223D324F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/ae/1e/8c6cb465.jpg","comment_is_top":false,"comment_ctime":1644394451,"is_pvip":false,"replies":[{"id":"121992","content":"欢迎欢迎~ 感谢认可哈~","user_name":"作者回复","comment_id":333529,"uid":"1043100","ip_address":"","utype":1,"ctime":1644671221,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1644394451","product_id":100073401,"comment_content":"从零基础入门spark来的，老师的课不仅知识含量丰富，也很有趣，能感受到字里行间都是对技术的热爱","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550686,"discussion_content":"欢迎欢迎~ 感谢认可哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644671221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329633,"user_name":"Ping E Lee","can_delete":false,"product_type":"c1","uid":2885040,"ip_address":"","ucode":"BDAEE5944BEFA6","user_header":"https://static001.geekbang.org/account/avatar/00/2c/05/b0/3f9fe47e.jpg","comment_is_top":false,"comment_ctime":1641452944,"is_pvip":false,"replies":[{"id":"120170","content":"可以的～ 课程深入浅出，有很多的故事、类比，帮助大家理解消化","user_name":"作者回复","comment_id":329633,"uid":"1043100","ip_address":"","utype":1,"ctime":1641624809,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1641452944","product_id":100073401,"comment_content":"没有Spark使用经验可以学习该课程吗?","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544664,"discussion_content":"可以的～ 课程深入浅出，有很多的故事、类比，帮助大家理解消化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641624809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327423,"user_name":"赵鹏举","can_delete":false,"product_type":"c1","uid":1260182,"ip_address":"","ucode":"B3785788D6176C","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/96/9fddfb4a.jpg","comment_is_top":false,"comment_ctime":1640133053,"is_pvip":false,"replies":[{"id":"119392","content":"敢问老兄是什么场景，需要存储几万列的宽表？一定要用这么大的宽表吗？是否可以考虑数仓中星型模型或是雪花模型的设计呢？","user_name":"作者回复","comment_id":327423,"uid":"1043100","ip_address":"","utype":1,"ctime":1640356065,"user_name_real":"编辑"}],"discussion_count":1,"race_medal":0,"score":"1640133053","product_id":100073401,"comment_content":"请问下对于几万列的标签表，应该如何存储？ 宽表本身会不会写入非常慢？是将所有字段打横到宽表还是压缩到map？业界有什么通用做法吗？","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541402,"discussion_content":"敢问老兄是什么场景，需要存储几万列的宽表？一定要用这么大的宽表吗？是否可以考虑数仓中星型模型或是雪花模型的设计呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640356065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319106,"user_name":"赵鹏举","can_delete":false,"product_type":"c1","uid":1260182,"ip_address":"","ucode":"B3785788D6176C","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/96/9fddfb4a.jpg","comment_is_top":false,"comment_ctime":1635586946,"is_pvip":false,"replies":[{"id":"115672","content":"有的~<br>","user_name":"作者回复","comment_id":319106,"uid":"1043100","ip_address":"","utype":1,"ctime":1635608389,"user_name_real":"吴磊"}],"discussion_count":3,"race_medal":0,"score":"1635586946","product_id":100073401,"comment_content":"请问有介绍如何能看懂sparksql执行计划吗？","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529501,"discussion_content":"有的~\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635608389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1260182,"avatar":"https://static001.geekbang.org/account/avatar/00/13/3a/96/9fddfb4a.jpg","nickname":"赵鹏举","note":"","ucode":"B3785788D6176C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":537996,"discussion_content":"作为数仓开发工程师平时写SQL比较多，但是材料看了一遍，讲得都是api写法，有没有地方介绍下将api优化应用到SQL上面？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639294204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":529501,"ip_address":""},"score":537996,"extra":""}]},{"author":{"id":1690884,"avatar":"https://static001.geekbang.org/account/avatar/00/19/cd/04/e27b7803.jpg","nickname":"小新","note":"","ucode":"DCAD04665E2CF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410516,"discussion_content":"在哪啊？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635698208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315400,"user_name":"浩然","can_delete":false,"product_type":"c1","uid":1805991,"ip_address":"","ucode":"1F2FC08382D396","user_header":"https://static001.geekbang.org/account/avatar/00/1b/8e/a7/92d1b90e.jpg","comment_is_top":false,"comment_ctime":1633880801,"is_pvip":false,"replies":[{"id":"114410","content":"互相学习~","user_name":"作者回复","comment_id":315400,"uid":"1043100","ip_address":"","utype":1,"ctime":1633962000,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1633880801","product_id":100073401,"comment_content":"用的比较多的是SparkSQL,大概是18年开始搞的。听课学习学习。","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527952,"discussion_content":"互相学习~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633962000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313685,"user_name":"黄神齐","can_delete":false,"product_type":"c1","uid":2726357,"ip_address":"","ucode":"D9B33A736B4FAF","user_header":"","comment_is_top":false,"comment_ctime":1632621233,"is_pvip":false,"replies":[{"id":"113612","content":"一起加油~","user_name":"作者回复","comment_id":313685,"uid":"1043100","ip_address":"","utype":1,"ctime":1632626410,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1632621233","product_id":100073401,"comment_content":"开始学习","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527437,"discussion_content":"一起加油~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632626410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288660,"user_name":"tommyCmd","can_delete":false,"product_type":"c1","uid":1208393,"ip_address":"","ucode":"4ADBB1FA44668D","user_header":"https://static001.geekbang.org/account/avatar/00/12/70/49/d7690979.jpg","comment_is_top":false,"comment_ctime":1618583456,"is_pvip":true,"replies":[{"id":"104776","content":"哈哈，咱们专栏的调优技巧，在Streaming场景中也适用哈~","user_name":"作者回复","comment_id":288660,"uid":"1043100","ip_address":"","utype":1,"ctime":1618637192,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1618583456","product_id":100073401,"comment_content":"期待讲解下spark streaming啊","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518699,"discussion_content":"哈哈，咱们专栏的调优技巧，在Streaming场景中也适用哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618637192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286920,"user_name":"Geek_d794f8","can_delete":false,"product_type":"c1","uid":2485585,"ip_address":"","ucode":"1E20DA4FF8B800","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","comment_is_top":false,"comment_ctime":1617680145,"is_pvip":false,"replies":[{"id":"104437","content":"喜欢就好哈～ 一起加油～","user_name":"作者回复","comment_id":286920,"uid":"1043100","ip_address":"","utype":1,"ctime":1618057987,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1617680145","product_id":100073401,"comment_content":"这个专栏真是良心和超值，虽然还在更新中，但我开始刷第二遍，每一遍都有收获，提的问题，老师也会耐心解答。感谢老师！","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518132,"discussion_content":"喜欢就好哈～ 一起加油～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618057987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285964,"user_name":"BigData～兰兴星","can_delete":false,"product_type":"c1","uid":2275664,"ip_address":"","ucode":"2D0CF9BCFF2493","user_header":"https://static001.geekbang.org/account/avatar/00/22/b9/50/30eea9a0.jpg","comment_is_top":false,"comment_ctime":1617089337,"is_pvip":false,"replies":[{"id":"104438","content":"多参与讨论哈～","user_name":"作者回复","comment_id":285964,"uid":"1043100","ip_address":"","utype":1,"ctime":1618058008,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1617089337","product_id":100073401,"comment_content":"像读小说一样去弄懂 Spark--希望弄懂spark就指定了","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517833,"discussion_content":"多参与讨论哈～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285662,"user_name":"cookie","can_delete":false,"product_type":"c1","uid":2322642,"ip_address":"","ucode":"F1E041723916D2","user_header":"https://static001.geekbang.org/account/avatar/00/23/70/d2/00d9e595.jpg","comment_is_top":false,"comment_ctime":1616945727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616945727","product_id":100073401,"comment_content":"一起学习，起飞！","like_count":0},{"had_liked":false,"id":283984,"user_name":"老A","can_delete":false,"product_type":"c1","uid":1806678,"ip_address":"","ucode":"6B3BB0851583BD","user_header":"https://static001.geekbang.org/account/avatar/00/1b/91/56/f714ad14.jpg","comment_is_top":false,"comment_ctime":1616030194,"is_pvip":false,"replies":[{"id":"104441","content":"一起加油～","user_name":"作者回复","comment_id":283984,"uid":"1043100","ip_address":"","utype":1,"ctime":1618058057,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1616030194","product_id":100073401,"comment_content":"上车学习了。","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517195,"discussion_content":"一起加油～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283614,"user_name":"Jefitar","can_delete":false,"product_type":"c1","uid":1370659,"ip_address":"","ucode":"D7ED9F32ADA5B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/ea/23/508f71e3.jpg","comment_is_top":false,"comment_ctime":1615857993,"is_pvip":false,"replies":[{"id":"104444","content":"一起加油～","user_name":"作者回复","comment_id":283614,"uid":"1043100","ip_address":"","utype":1,"ctime":1618058087,"user_name_real":"吴磊"}],"discussion_count":1,"race_medal":0,"score":"1615857993","product_id":100073401,"comment_content":"开始学习啦！目前SPARK性能调优只是稍有了解，相信跟着老师学习后，会达到熟练的程度！","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517092,"discussion_content":"一起加油～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058087,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283553,"user_name":"云超","can_delete":false,"product_type":"c1","uid":1581783,"ip_address":"","ucode":"63DFDDAB37A04F","user_header":"https://static001.geekbang.org/account/avatar/00/18/22/d7/ae0ed31f.jpg","comment_is_top":false,"comment_ctime":1615815600,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615815600","product_id":100073401,"comment_content":"开始学习了","like_count":0},{"had_liked":false,"id":283527,"user_name":"对方正在输入。。。","can_delete":false,"product_type":"c1","uid":1179298,"ip_address":"","ucode":"7B0DEB4D9B43D2","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/a2/5252a278.jpg","comment_is_top":false,"comment_ctime":1615808665,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615808665","product_id":100073401,"comment_content":"好激动，早就开始期待了，希望和老师一起学习","like_count":0},{"had_liked":false,"id":283521,"user_name":"Will","can_delete":false,"product_type":"c1","uid":1256770,"ip_address":"","ucode":"671FFBDF1A3E69","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/42/6e3be953.jpg","comment_is_top":false,"comment_ctime":1615806412,"is_pvip":false,"replies":[{"id":"104445","content":"一起加油～","user_name":"作者回复","user_name_real":"吴磊","uid":"1043100","ctime":1618058098,"ip_address":"","comment_id":283521,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615806412","product_id":100073401,"comment_content":"已经使用spark多年，有一定基础，希望可以跟随吴老师一同梳理下知识","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"吴磊","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517062,"discussion_content":"一起加油～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618058098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283520,"user_name":"Will","can_delete":false,"product_type":"c1","uid":1256770,"ip_address":"","ucode":"671FFBDF1A3E69","user_header":"https://static001.geekbang.org/account/avatar/00/13/2d/42/6e3be953.jpg","comment_is_top":false,"comment_ctime":1615806363,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615806363","product_id":100073401,"comment_content":"期待学习！","like_count":0}]}