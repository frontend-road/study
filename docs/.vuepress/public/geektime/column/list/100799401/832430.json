{"id":832430,"title":"åŸºç¡€ç¯‡ï½œè¯¾åé¢˜ç­”ç–‘","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿Šè¾¾ã€‚</p><p>è¿™ä¸€è®²ä¸»è¦æ˜¯å¯¹ä¸“æ åŸºç¡€ç¯‡ä¸­æ€è€ƒé¢˜çš„ä¸€ä¸ªç»Ÿä¸€çš„ç­”ç–‘ã€‚å®é™…ä¸Šåœ¨è¯„è®ºåŒºä¸­ï¼Œ æˆ‘ä¹Ÿçœ‹åˆ°äº†åŒå­¦ä»¬å¯¹å¾ˆå¤šæ€è€ƒé¢˜çš„ç²¾å½©è§£ç­”ã€‚è¿™é‡Œåšä¸€ä¸ªæ±‡æ€»å’Œè¡¥å……ï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥çœ‹ã€‚</p><h2>ç¬¬1è®²</h2><p>é—®é¢˜ï¼šæ—©æœŸçš„ç‰ˆæœ¬ä¸­ï¼Œç™»å½•æœåŠ¡å™¨æœ¬åœ°çš„MySQLé»˜è®¤ä¸éœ€è¦å¯†ç ã€‚è¿™å­˜åœ¨ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œå› ä¸ºä½ åªè¦èƒ½ç™»å½•åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼Œå°±èƒ½è®¿é—®è¿™å°æœåŠ¡å™¨ä¸Šçš„MySQLæ•°æ®åº“ã€‚ä»5.7ç‰ˆæœ¬å¼€å§‹ï¼Œç»™æ•°æ®åº“çš„rootè´¦å·è®¾ç½®äº†é»˜è®¤å¯†ç ï¼Œé¦–æ¬¡ç™»å½•æ—¶éœ€è¦å…ˆä¿®æ”¹å¯†ç ã€‚åœ¨éƒ¨ç½²ä¸€å¥—MySQLæ•°æ®åº“ç¯å¢ƒæ—¶ï¼Œå°æ˜æŒ‰è§„èŒƒä¿®æ”¹äº†æ•°æ®åº“rootè´¦å·çš„å¯†ç ï¼Œä½†æ˜¯å½“æ—¶å¿˜äº†å°†rootå¯†ç è®°å½•ä¸‹æ¥ï¼Œå› æ­¤å°æ˜å‘ä½ å¯»æ±‚å¸®åŠ©ã€‚ä½ æœ‰åŠæ³•å¸®å°æ˜è§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ</p><p>@é£’é£’ç§‹é£ åœ¨è¯„è®ºåŒºæä¾›äº†è¿™ä¸ªé—®é¢˜çš„æ ‡å‡†å¤„ç†æ–¹æ³•ã€‚</p><ol>\n<li>å…³é—­MySQLã€‚</li>\n</ol><pre><code class=\"language-plain\">kill &lt;mysqldè¿›ç¨‹çš„pid&gt;\n</code></pre><ol start=\"2\">\n<li>æ·»åŠ â€“skip-grant-tableså‚æ•°ï¼Œå¯åŠ¨MySQLã€‚</li>\n</ol><pre><code class=\"language-plain\">mysqld_safe --defaults-file=my.cnf --skip-grant-tables --skip-networking &amp;\n</code></pre><ol start=\"3\">\n<li>æ‰§è¡Œflush privilegesï¼ŒåŠ è½½æƒé™è¡¨ã€‚</li>\n</ol><pre><code class=\"language-plain\">flush privileges; \n</code></pre><ol start=\"4\">\n<li>æ‰§è¡Œalter userå‘½ä»¤ï¼Œä¿®æ”¹rootç”¨æˆ·å¯†ç </li>\n</ol><pre><code class=\"language-plain\">alter user 'root'@'localhost' identified by 'password';\n</code></pre><!-- [[[read_end]]] --><ol start=\"5\">\n<li>é‡æ–°å¯åŠ¨MySQLï¼Œå»æ‰â€“skip-grant-tableså‚æ•°ã€‚</li>\n</ol><p>ä½¿ç”¨å‚æ•°â€“skip-grant-tableså¯åŠ¨çš„MySQLï¼Œä¸æ ¡éªŒç”¨æˆ·åå’Œå¯†ç ï¼Œä¹Ÿä¸æ ¡éªŒç”¨æˆ·æƒé™ï¼Œå¯ä»¥æ‰§è¡Œä»»ä½•æ“ä½œã€‚å› æ­¤ä¸€èˆ¬å»ºè®®åŒæ—¶åŠ ä¸Šâ€“skip-networkingå‚æ•°ï¼Œè¿™æ ·å°±åªèƒ½åœ¨æœåŠ¡å™¨æœ¬åœ°ç™»é™†æ•°æ®åº“ã€‚ä¸è¿‡8.0ä½¿ç”¨â€“skip-grant-tablesæ—¶ï¼Œé»˜è®¤å°±åªèƒ½æœ¬åœ°è®¿é—®äº†ã€‚</p><p>è¦å…ˆæ‰§è¡Œflush privilegeså‘½ä»¤åŠ è½½æƒé™è¡¨ï¼Œç„¶åæ‰èƒ½ä¿®æ”¹å¯†ç ã€‚ä¿®æ”¹å®Œå¯†ç åï¼Œé‡æ–°å¯åŠ¨MySQLï¼Œè¿™æ¬¡å»æ‰â€“skip-grant-tableså‚æ•°ã€‚</p><h2>ç¬¬2è®²</h2><p>é—®é¢˜ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å»ºè®®å°†æ•°æ®åº“éƒ¨ç½²åˆ°å†…ç½‘ï¼Œå› ä¸ºå°†æ•°æ®åº“æš´éœ²åˆ°å…¬ç½‘ä¸Šæœ‰æ¯”è¾ƒå¤§çš„å®‰å…¨é£é™©ã€‚ä½†æ˜¯ä½ çš„å…¬å¸æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ä¸šåŠ¡ï¼Œå°±æ˜¯éœ€è¦é€šè¿‡å…¬ç½‘è®¿é—®MySQLæ•°æ®åº“ã€‚è¯·ä½ è¯„ä¼°ä¸‹å°†æ•°æ®åº“æ”¾åˆ°å…¬ç½‘æœ‰å“ªäº›é£é™©ï¼Ÿä½ åº”ä½¿ç”¨å“ªäº›æ–¹æ³•æ¥å°½é‡ä¿è¯æ•°æ®åº“å’Œæ•°æ®çš„å®‰å…¨ï¼Ÿ</p><p>@Geek_0126 @Amosãƒ¾çš„ç•™è¨€ä¸­ï¼Œéƒ½è®²åˆ°äº†æ•°æ®åº“å…¬ç½‘è®¿é—®çš„é£é™©å’Œè§£å†³æ–¹æ³•ã€‚</p><p>é£é™©1. æ•°æ®åº“è¢«å„ç§æ‰‹æ®µæ”»å‡»ï¼Œç”¨æˆ·å¯†ç è¢«ç ´è§£ã€‚</p><p>ä¸ºäº†é¿å…é£é™©ï¼Œé¦–å…ˆåœ¨ç½‘ç»œå±‚é™åˆ¶æ¥æºIPã€‚è¿™å’Œåˆ›å»ºMySQLç”¨æˆ·æ—¶æŒ‡å®šè®¿é—®IPè¿˜ä¸ä¸€æ ·ã€‚åˆ›å»ºç”¨æˆ·æ—¶æŒ‡å®šIPï¼Œå¹¶ä¸ä¼šé˜»æ­¢åœ¨ç½‘ç»œå±‚é¢è®¿é—®æ•°æ®åº“ç«¯å£ã€‚æ•°æ®åº“çš„ç”¨æˆ·å¯†ç è¦æœ‰ä¸€å®šçš„å¤æ‚åº¦ï¼Œé¿å…ä½¿ç”¨ç®€å•å¯†ç ã€‚åŒæ—¶ä¹Ÿè¦éµå¾ªæœ€å°æƒé™åŸåˆ™ã€‚</p><p>é£é™©2. ä¼ è¾“çš„æ•°æ®è¢«è¢«æ‹¦æˆªæ•è·ã€‚</p><p>å¦‚æœMySQLå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ è¾“çš„TCPæ•°æ®è¢«æ•è·ï¼Œå¹¶ä¸”æ²¡æœ‰ä½¿ç”¨åŠ å¯†ä¼ è¾“ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“è§£æå‡ºå®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤ã€æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨åŠ å¯†ä¼ è¾“ã€‚</p><p>è¿˜å¯ä»¥åœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼ŒæŒ‡å®šç”¨æˆ·å¿…é¡»ä½¿ç”¨åŠ å¯†ä¼ è¾“ï¼Œè¿˜å¯ä»¥è¦æ±‚éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦ã€‚</p><pre><code class=\"language-plain\">create user 'user1'@'%' identified by 'somepass' require ssl;\ncreate user 'user2'@'%' identified by 'somepass' require subject 'some subject';\n</code></pre><h2>ç¬¬3è®²</h2><p>é—®é¢˜ï¼šå¼€å‘åŒå­¦åé¦ˆè®¿é—®æ•°æ®åº“æ€»æ˜¯æŠ¥é”™ï¼Œå¹¶æä¾›äº†ä¸€äº›æŠ¥é”™æ—¥å¿—ã€‚ä½ åº”è¯¥æ€ä¹ˆæ¥åˆ†æå’Œè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><pre><code class=\"language-plain\">ERROR druid.sql.Statement -{conn-10094, stmt-26348} execute error. SELECT 1 FROM DUAL\ncom.mysql.cj.jdbc.exceptions.CommunicationsException: The last packet successfully received from the server was 11,394,944 milliseconds ago. The last packet sent successfully to the server was 11,394,950 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.\n\n\nThe last packet successfully received from the server was 899,883 milliseconds ago. The last packet sent successfully to the server was 899,890 milliseconds ago.\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\n\n\nThe last packet successfully received from the server was 1,799,883 milliseconds ago. The last packet sent successfully to the server was 1,799,891 milliseconds ago.\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\n</code></pre><p>è¿™æ˜¯ä½¿ç”¨JDBCè®¿é—®MySQLç»å¸¸ä¼šé‡åˆ°çš„ä¸€ä¸ªæŠ¥é”™ã€‚æŠ¥é”™ä¿¡æ¯â€œN milliseconds agoâ€é‡Œçš„æ—¶é—´æ˜¯ä¸€ä¸ªå…³é”®çš„ä¿¡æ¯ã€‚æ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„â€œ899,883 milliseconds agoâ€ï¼Œè¯´æ˜15åˆ†é’Ÿè¿æ¥å°±æ–­å¼€äº†ã€‚éœ€è¦æ£€æŸ¥ä¸‹wait_timeoutçš„å€¼ï¼Œæ˜¯ä¸æ˜¯çœŸçš„æ˜¯15åˆ†é’Ÿã€‚</p><p>wait_timeoutæ˜¯ä¸€ä¸ªä¼šè¯çº§çš„å˜é‡ï¼Œæ¯ä¸ªä¼šè¯å¯ä»¥è®¾ç½®æˆä¸åŒçš„å€¼ã€‚å› æ­¤éœ€è¦ç¡®è®¤è¢«æ–­å¼€çš„è¿æ¥ï¼Œwait_timeoutæ˜¯æ€ä¹ˆè®¾ç½®çš„ã€‚8.0ä¸­å¯ä»¥é€šè¿‡performance_schema.variables_by_threadè¡¨ï¼ŒæŸ¥çœ‹å…¶ä»–ä¼šè¯çš„å˜é‡å€¼ã€‚</p><pre><code class=\"language-plain\">mysql&gt;  select * from performance_schema.variables_by_thread \n    where variable_name = 'wait_timeout';\n+-----------+---------------+----------------+\n| THREAD_ID | VARIABLE_NAME | VARIABLE_VALUE |\n+-----------+---------------+----------------+\n|        64 | wait_timeout  | 28800          |\n|        65 | wait_timeout  | 3600           |\n+-----------+---------------+----------------+\n</code></pre><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–ä¸€äº›æ–¹æ³•æ¥éªŒè¯ç©ºé—²è¶…æ—¶æ—¶é—´ã€‚æ¯”å¦‚æŸ¥çœ‹processlistï¼Œçœ‹çœ‹commandä¸ºSleepçš„è¿æ¥ï¼Œæœ€å¤§çš„æ—¶é—´æ˜¯å¤šå°‘ã€‚æˆ–è€…æ‰§è¡Œselect sleep(N)ï¼Œçœ‹çœ‹æŸ¥è¯¢æ˜¯å¦èƒ½æ­£å¸¸å®Œæˆã€‚</p><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¼šè¯çš„wait_timeoutçš„è®¾ç½®æ˜¯å‡ ä¸‡ç§’ï¼Œå¹¶ä¸æ˜¯15åˆ†é’Ÿã€‚ä½†æ˜¯è¶…è¿‡15åˆ†é’Ÿï¼Œè¿æ¥å°±ä¼šè¢«æ–­å¼€ï¼ŒProcesslistä¸­çœ‹ä¸åˆ°ç©ºé—²æ—¶é—´è¶…è¿‡15åˆ†é’Ÿçš„ä¼šè¯ã€‚æ‰§è¡Œsleep(901)ä¹Ÿæ— æ³•æˆåŠŸã€‚</p><p>æœ€ç»ˆå®šä½çš„åŸå› æ˜¯ä½¿ç”¨äº†Nginxæ¥è®¿é—®MySQLï¼Œè€Œä»£ç†çš„è¶…æ—¶æ—¶é—´é…ç½®æˆäº†900ç§’ã€‚è¿æ¥æ± çš„keepaliveé…ç½®ä¹Ÿæ²¡æœ‰ç”Ÿæ•ˆã€‚</p><h2>ç¬¬4è®²</h2><p>é—®é¢˜ï¼šæˆ‘ä»¬å†™SQLè¯­å¥æ—¶ï¼Œå…³é”®å­—ä¸€èˆ¬ä¸åŒºåˆ†å¤§å°ï¼Œä¸åŒçš„äººå¯èƒ½æœ‰ä¸åŒçš„ä¹ æƒ¯ã€‚å¯¹äºåº“åã€è¡¨åã€åˆ—åï¼Œä¸åŒçš„æ•°æ®åº“æœ‰ä¸åŒçš„å¤„ç†æ–¹æ³•ã€‚æ¯”å¦‚Oracleä¸­ï¼Œè¡¨åé»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ã€‚åœ¨MySQLä¸­ï¼Œæ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒï¼Œè¡¨åå°±å¯èƒ½ä¼šåŒºåˆ†å¤§å°å†™ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show tables;\n+----------------+\n| Tables_in_db01 |\n+----------------+\n| Ta             |\n| ta             |\n+----------------+\n2 rows in set (0.01 sec)\n\n\nmysql&gt; select * from ta;\nEmpty set (0.01 sec)\n\n\nmysql&gt; SELECT * From tA;\nERROR 1146 (42S02): Table 'db01.tA' doesn't exist\n</code></pre><p>å‚æ•°lower_case_table_nameså¯ç”¨æ¥æ§åˆ¶è¡¨åæ˜¯å¦åŒºåˆ†å¤§å°å†™ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show variables like '%lower%';\n+------------------------+-------+\n| Variable_name          | Value |\n+------------------------+-------+\n| lower_case_file_system | OFF   |\n| lower_case_table_names | 0     |\n+------------------------+-------+\n</code></pre><p>MySQL 8.0ä¸­ï¼Œè¿™ä¸ªå‚æ•°åªèƒ½åœ¨æ•°æ®åº“åˆå§‹åŒ–ä¹‹å‰è®¾ç½®ï¼Œä¹‹åå°±ä¸èƒ½å†ä¿®æ”¹äº†ï¼Œä¿®æ”¹åæ•°æ®åº“éƒ½æ— æ³•å¯åŠ¨ã€‚</p><pre><code class=\"language-plain\">[ERROR] [MY-011087] [Server] Different lower_case_table_names settings for server ('1') and data dictionary ('0').\n[ERROR] [MY-010020] [Server] Data Dictionary initialization failed.\n</code></pre><p>ä½ è§‰å¾—è¿™ä¸ªå‚æ•°åº”è¯¥æ€æ ·è®¾ç½®ï¼ŸåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>MySQLä¼šæ ¹æ®æ“ä½œç³»ç»Ÿå’Œåº•å±‚æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§ï¼Œæ¥é€‰ä¸€ä¸ªé»˜è®¤çš„lower_case_table_nameså‚æ•°ã€‚ä½†æ˜¯æˆ‘è§‰å¾—è¿™å¹¶ä¸æ˜¯å¾ˆå¥½çš„ä¸€ç§åšæ³•ã€‚</p><p>ä¸€èˆ¬æˆ‘ä»¬å†™SQLæ—¶ï¼Œå¹¶ä¸ä¼šç‰¹åˆ«æ³¨æ„è¡¨åçš„å¤§å°å†™ï¼Œä¸åŒçš„äººå¯èƒ½æœ‰ä¸åŒçš„ä¹ æƒ¯ï¼Œæœ‰æ—¶ä½¿ç”¨å¤§å†™ï¼Œæœ‰æ—¶ä½¿ç”¨å°å†™ã€‚æ¯”å¦‚ä¸‹é¢è¿™3ä¸ªSQLï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šè®¤ä¸ºè¿™å…¶å®æ˜¯åŒä¸€ä¸ªSQLã€‚</p><pre><code class=\"language-plain\">select * from tab;\nselect * from TAB;\nselect * from Tab;\n</code></pre><p>ä½†æ˜¯linuxä¸‹ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„lower_case_table_names=0ï¼Œè¿™3ä¸ªSQLè®¿é—®äº†å®Œå…¨ä¸åŒçš„3ä¸ªè¡¨ã€‚</p><pre><code class=\"language-plain\">mysql&gt; show tables;\n+----------------+\n| Tables_in_db00 |\n+----------------+\n| TAB            |\n| Tab            |\n| tab            |\n+----------------+\n</code></pre><p>è¿™é™¤äº†å¼•èµ·æ··ä¹±ï¼Œè¿˜æœ‰å…¶ä»–ä»€ä¹ˆé‡è¦çš„ä½œç”¨å—ï¼Ÿ</p><p>æœ‰æ—¶ï¼Œè¿™ä¹Ÿä¼šç»™è·¨æ“ä½œç³»ç»Ÿçš„æ•°æ®åº“è¿ç§»å¸¦æ¥éº»çƒ¦ï¼Œæ¯”å¦‚å°†MySQLä»Windowsè¿ç§»åˆ°Linuxï¼Œæˆ–è€…åè¿‡æ¥è¿ç§»ã€‚æˆ‘çš„å»ºè®®æ˜¯æ‰€æœ‰ç¯å¢ƒçš„MySQLéƒ½å°†å‚æ•°lower_case_table_namesè®¾ç½®ä¸º1ï¼Œç»Ÿä¸€è½¬æ¢æˆå°å†™ã€‚</p><h2>ç¬¬5è®²</h2><p>é—®é¢˜ï¼šä½ åˆšåˆšæ¥åˆ°äº†1ä¸ªéœ€æ±‚ï¼Œè¦å¼€å‘ä¸€ä¸ªå‘˜å·¥ç®¡ç†ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿè®¡åˆ’ä½¿ç”¨MySQLæ•°æ®åº“ï¼Œè®¾è®¡äººå‘˜æä¾›äº†è¡¨ç»“æ„ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ä¸‹é¢è¿™2ä¸ªè¡¨ã€‚ä½œä¸ºä¸€ä½èµ„æ·±çš„MySQLä½¿ç”¨è€…ï¼Œä½ è§‰å¾—è¿™2ä¸ªè¡¨å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿä½ ä¼šæ€ä¹ˆæ”¹è¿›å‘¢ï¼Ÿ</p><pre><code class=\"language-plain\">create table t_employee(\n    emp_id int not null comment 'å‘˜å·¥ç¼–å·',\n    emp_name varchar(200) comment 'å‘˜å·¥å§“å',\n    birth_day varchar(200) comment 'å‡ºç”Ÿæ—¥æœŸ',\n    age int comment 'å¹´é¾„',\n    gender varchar(200) comment 'æ€§åˆ«',\n    address varchar(200) comment 'ä½å€',\n    photo blob comment 'å‘˜å·¥ç…§ç‰‡',\n    primary key(emp_id)\n) engine=innodb charset utf8;\n\n\ncreate table t_emp_salary(\n    emp_id varchar(30) not null comment 'å‘˜å·¥ç¼–å·',\n    effect_date varchar(200) comment 'ç”Ÿæ•ˆæ—¥æœŸ',\n    salary double comment 'è–ªèµ„',\n    descripton varchar(2000) comment 'å¤‡æ³¨',\n    primary key(emp_id, effect_date)\n) engine=innodb charset utf8;\n</code></pre><p>è¿™ä¸ªé—®é¢˜ è¯„è®ºåŒºä¸­@åƒè‹¹æœçš„è€ƒæ‹‰ @123 @Geek_0126 çš„å›ç­”éƒ½æ¯”è¾ƒå®Œæ•´äº†ã€‚</p><p>t_employeeè¡¨ï¼š</p><ul>\n<li>\n<p>emp_name varcharé•¿åº¦ä¸ç”¨è®¾ç½®å¾—è¿™ä¹ˆé•¿</p>\n</li>\n<li>\n<p>birth_day ä½¿ç”¨æ—¥æœŸç±»å‹æ›´å¥½</p>\n</li>\n<li>\n<p>age ä½¿ç”¨smallintä¹Ÿè¶³å¤Ÿäº†</p>\n</li>\n<li>\n<p>gender å¯ä»¥ä½¿ç”¨tinyintæˆ–enum</p>\n</li>\n<li>\n<p>photo å»ºè®®æ•°æ®åº“ä¸­å€¼ä¿å­˜ä¸€ä¸ªæ–‡ä»¶åœ°å€ã€‚å›¾ç‰‡å­˜å‚¨åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</p>\n</li>\n</ul><p>t_emp_salaryè¡¨ï¼š</p><ul>\n<li>\n<p>emp_idå’Œt_employeeä¿æŒä¸€è‡´</p>\n</li>\n<li>\n<p>effect_dateä½¿ç”¨æ—¥æœŸç±»å‹</p>\n</li>\n<li>\n<p>salaryä½¿ç”¨Decimalæˆ–intç±»å‹</p>\n</li>\n<li>\n<p>è”åˆä¸»é”®çš„é—®é¢˜ã€‚</p>\n</li>\n</ul><h2>ç¬¬6è®²</h2><p>é—®é¢˜ï¼šMySQLçš„å¤‡åº“å¤åˆ¶ä¸­æ–­äº†ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå‘ç°æ˜¯æœ‰ä¸€ä¸ªå»ºè¡¨çš„è¯­å¥æŠ¥é”™äº†ã€‚</p><pre><code class=\"language-plain\">Last_SQL_Error: Coordinator stopped because there were error(s) in the worker(s). The most recent failure being: Worker 1 failed executing transaction 'c1a67221-f9fc-11ed-bffd-fa8338b09400:106' at master log binlog.000020, end_log_pos 4203259. See error log and/or performance_schema.replication_applier_status_by_worker table for more details about this failure or others, if any.\n  Replicate_Ignore_Server_Ids:\n</code></pre><pre><code class=\"language-plain\">mysql&gt; select * from performance_schema.replication_applier_status_by_worker\\G\n*************************** 1. row ***************************\n                                           CHANNEL_NAME:\n                                              WORKER_ID: 1\n                                              THREAD_ID: NULL\n                                          SERVICE_STATE: OFF\n                                      LAST_ERROR_NUMBER: 1118\n                                     LAST_ERROR_MESSAGE: Worker 1 failed executing transaction 'c1a67221-f9fc-11ed-bffd-fa8338b09400:106' at master log binlog.000020, end_log_pos 4203259; Error 'Row size too large (&gt; 8126). Changing some columns to TEXT or BLOB or using ROW_FORMAT=DYNAMIC or ROW_FORMAT=COMPRESSED may help. In current row format, BLOB prefix of 768 bytes is stored inline.' on query. Default database: 'repl'. Query: 'create table t_inno1(\n       c01 varchar(768),\n       c02 varchar(768),\n       c03 varchar(768),\n       c04 varchar(768),\n       c05 varchar(768),\n       c06 varchar(768),\n       c07 varchar(768),\n       c08 varchar(768),\n       c09 varchar(768),\n       c10 varchar(768),\n       c11 varchar(398)\n    ) engine=innodb row_format=compact charset latin1'\n</code></pre><p>ä½†æ˜¯åˆ°ä¸»åº“ä¸ŠæŸ¥çœ‹åï¼Œå‘ç°è¿™ä¸ªè¡¨åˆ›å»ºæˆåŠŸäº†ã€‚</p><pre><code class=\"language-plain\">mysql &gt;show create table t_inno1\\G\n*************************** 1. row ***************************\n       Table: t_inno1\nCreate Table: CREATE TABLE `t_inno1` (\n  `c01` varchar(768) DEFAULT NULL,\n  `c02` varchar(768) DEFAULT NULL,\n  `c03` varchar(768) DEFAULT NULL,\n  `c04` varchar(768) DEFAULT NULL,\n  `c05` varchar(768) DEFAULT NULL,\n  `c06` varchar(768) DEFAULT NULL,\n  `c07` varchar(768) DEFAULT NULL,\n  `c08` varchar(768) DEFAULT NULL,\n  `c09` varchar(768) DEFAULT NULL,\n  `c10` varchar(768) DEFAULT NULL,\n  `c11` varchar(398) DEFAULT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 ROW_FORMAT=COMPACT\n1 row in set (0.00 sec)\n</code></pre><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ</p><p>è¿™é‡Œå…³é”®çš„æŠ¥é”™ä¿¡æ¯æ˜¯â€œRow size too large (&gt; 8126). Changing some columns to TEXT or BLOB or using ROW_FORMAT=DYNAMIC or ROW_FORMAT=COMPRESSED may help.â€ã€‚</p><p>å»ºè¡¨æ˜¯å¦æˆåŠŸå’Œå‚æ•°innodb_strict_modeçš„è®¾ç½®æœ‰å…³ã€‚åˆ†æè¿™ä¸ªé—®é¢˜æ—¶ï¼Œå…ˆå¯¹æ¯”ä¸»åº“å’Œå¤‡åº“ä¸Šinnodb_strict_modeçš„è®¾ç½®ã€‚</p><p>innodb_strict_modeå¯ä»¥åœ¨ä¼šè¯çº§åˆ«ä¿®æ”¹ï¼Œä¸»åº“ä¸Šå°†innodb_strict_modeçš„ä¼šè¯å€¼æ”¹æˆOFFï¼Œç„¶åå»ºè¡¨æˆåŠŸäº†ã€‚ä½†æ˜¯MySQLå¹¶æ²¡æœ‰æŠŠè¿™ä¸ªä¼šè¯å˜é‡è®°å½•åœ¨Binlogä¸­ï¼Œå¤‡åº“æ‰§è¡Œæ—¶ï¼Œinnodb_strict_mode=ONï¼Œå› æ­¤å¤±è´¥äº†ã€‚</p><p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯å¤‡åº“ä¸Šä¸´æ—¶å°†innodb_strict_modeçš„å…¨å±€å€¼ä¿®æ”¹æˆOFFï¼Œå†å¼€å¯å¤åˆ¶ã€‚</p><h2>ç¬¬7è®²</h2><p>é—®é¢˜ï¼šæŸä¸€ä¸ªé¡¹ç›®å‘å¸ƒæ—¶ï¼Œæ‰§è¡Œäº†ä»¥ä¸‹æ•°æ®åˆå§‹åŒ–è„šæœ¬ã€‚</p><pre><code class=\"language-plain\">mysql&gt; CREATE TABLE `t_b` (\n       `a` varchar(30) DEFAULT NULL\n     ) ENGINE=InnoDB DEFAULT CHARSET=gbk;\nQuery OK, 0 rows affected (0.03 sec)\n\nmysql&gt; set names gbk;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt;  insert into t_b values('ä¸­æ–‡ç¬¦å·');\nQuery OK, 1 row affected (0.00 sec)\n</code></pre><p>å¯¹æ•°æ®è¿›è¡Œæ£€æŸ¥åï¼Œæ²¡æœ‰å‘ç°ä»»ä½•é—®é¢˜ã€‚</p><pre><code class=\"language-plain\">mysql&gt; select * from t_b;\n+--------------+\n| a            |\n+--------------+\n| ä¸­æ–‡ç¬¦å·     |\n+--------------+\n1 row in set (0.00 sec)\n</code></pre><p>ä½†æ˜¯å¦å¤–ä¸€ä¸ªåŒäº‹æŸ¥è¯¢è¿™ä¸ªè¡¨æ—¶ï¼Œå‘ç°æ— è®ºæ€ä¹ˆè®¾ç½®å­—ç¬¦é›†ï¼ŒæŸ¥å‡ºæ¥éƒ½æ˜¯ä¹±ç ã€‚</p><pre><code class=\"language-plain\">mysql&gt; set names utf8;\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n\n\nmysql&gt; select * from t_b;\n+------------------+\n| a                |\n+------------------+\n| å¨‘??é‹å†ªç²­é”•è¤°? |\n+------------------+\n1 row in set (0.00 sec)\n\n\nmysql&gt; set names gbk;\nQuery OK, 0 rows affected (0.00 sec)\n\n\nmysql&gt; select * from t_b;\n+--------------+\n| a            |\n+--------------+\n| æ¶“î…Ÿæƒç»—ï¹€å½¿ |\n+--------------+\n1 row in set (0.00 sec)\n</code></pre><p>è¿™ä½åŒäº‹æ‰¾åˆ°äº†ä½ ï¼Œè¯·ä½ å¸®å¿™åˆ†æä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><p>@Shelly åœ¨è¯„è®ºåŒºä¸­ç»™å‡ºäº†è¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œset namesæŒ‡å®šçš„å­—ç¬¦é›†å’Œç»ˆç«¯å®é™…çš„ç¼–ç ä¸ä¸€è‡´ã€‚</p><p>utf-8çš„ç»ˆç«¯ä¸‹ï¼Œæ‰§è¡Œset names gbkåï¼Œè™½ç„¶å†™å…¥ã€è¯»å–ä¸­æ–‡å­—ç¬¦å¥½åƒæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å®é™…ä¸Šè¡¨é‡Œé¢å­˜çš„æ•°æ®å·²ç»ä¸å¯¹äº†ã€‚</p><pre><code class=\"language-plain\">mysql&gt; select a, hex(a), char_length(a) from t_b;\n+--------------+--------------------------+----------------+\n| a            | hex(a)                   | char_length(a) |\n+--------------+--------------------------+----------------+\n| ä¸­æ–‡ç¬¦å·     | E4B8ADE69687E7ACA6E58FB7 |              6 |\n+--------------+--------------------------+----------------+\n</code></pre><p>â€œä¸­æ–‡ç¬¦å·â€çš„GBKç¼–ç æ˜¯D6D0 CEC4 B7FB BAC5ï¼Œä½†æ˜¯è¡¨é‡Œé¢å­˜çš„å…¶å®æ˜¯â€œä¸­æ–‡ç¬¦å·â€çš„UTF8ç¼–ç ã€‚è¿™å’Œè¡¨çš„å­—ç¬¦é›†ä¸ä¸€è‡´äº†ï¼Œå› æ­¤æ‰§è¡Œchar_lengthè·å–çš„å­—ç¬¦æ•°ä¹Ÿä¸å¯¹äº†ã€‚</p><p>è¿™ç§é—®é¢˜è¦ä»æºå¤´ä¸Šè§£å†³ï¼ŒæŠŠé”™è¯¯çš„æ•°æ®ä¿®æ­£è¿‡æ¥ã€‚æ¯”å¦‚åˆ é™¤æœ‰é—®é¢˜çš„æ•°æ®ï¼Œè®¾ç½®æ­£ç¡®çš„å­—ç¬¦é›†åï¼Œé‡æ–°å†™å…¥æ•°æ®ã€‚</p><h2>ç¬¬8è®²</h2><p>é—®é¢˜ï¼šæºåº“ä¸­æœ‰ä¸€ä¸ªå¤§è¡¨ï¼Œè¡¨ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">create table big_table(\n    col1 varchar(32) not null,\n    col2 varchar(32) not null,\n    col3 varchar(32) not null,\n    col4 varchar(256),\n    col5 varchar(256),\n    ....\n    col10 varchar(512),\n    primary key(col1, col2, col3)\n) engine=innodb;\n</code></pre><p>è¿™ä¸ªè¡¨æ€»å…±æœ‰3000ä¸‡è¡Œæ•°æ®ï¼Œå¹³å‡è¡Œé•¿åº¦å¤§çº¦ä¸º2Kã€‚ç°åœ¨éœ€è¦å°†è¿™ä¸ªè¡¨å¤åˆ¶åˆ°ç›®æ ‡åº“ã€‚æºåº“å’Œç›®æ ‡åº“éƒ½æ˜¯MySQLã€‚æœ‰ä¸€å°4æ ¸8Gçš„ä¸­è½¬æœºå™¨ä¾›ä½ ä½¿ç”¨ã€‚è¯·é—®ä½ ä¼šæ€ä¹ˆè§£å†³è¿™ä¸ªéœ€æ±‚ï¼Ÿå¦‚æœè¦ä½ å†™ä¸€æ®µç¨‹åºæ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå¦‚ä½•æé«˜æ•°æ®å¤åˆ¶çš„é€Ÿåº¦ï¼Ÿ</p><p>è¯„è®ºåŒºä¸­@123 @dream ç»™å‡ºäº†å¤„ç†è¿™ä¸ªé—®é¢˜çš„ä¸€äº›æ€è·¯ã€‚è¿™é‡Œæˆ‘æ€»ç»“ä¸€ä¸‹ã€‚</p><ol>\n<li>\n<p>ä½¿ç”¨å¤šä¸ªçº¿ç¨‹æ¥å¤„ç†ã€‚ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£æŸ¥è¯¢æ•°æ®ï¼Œå°†è®°å½•ç¼“å­˜åœ¨å†…å­˜çš„ä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚å†ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è·å–æ•°æ®ï¼Œæ‰§è¡ŒInsertæ“ä½œã€‚Insertæ—¶ï¼Œå¯ä»¥ä½¿ç”¨MySQLçš„æ‰¹é‡æ’å…¥ï¼Œå°†å¤šæ¡æ•°æ®ï¼ˆæ¯”å¦‚100æ¡ï¼‰æ‹¼æ¥æˆä¸€ä¸ªInsert SQLå†æ‰§è¡Œã€‚</p>\n</li>\n<li>\n<p>ç”±äºè¡¨çš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå®¢æˆ·ç«¯æ— æ³•ä¸€æ¬¡æ€§å°†æ‰€æœ‰ç»“æœé›†éƒ½ç¼“å­˜èµ·æ¥ï¼Œè¦ä¹ˆä½¿ç”¨åˆ†é¡µçš„SQLï¼Œè¦ä¹ˆä½¿ç”¨æµå¼å¤„ç†ã€‚è¿™ä¸ªè¡¨ä½¿ç”¨äº†ç»„åˆä¸»é”®ï¼Œåˆ†é¡µSQLè¿˜ä¸å¤ªå¥½å†™ã€‚å¦‚æœæ˜¯ç”¨äº†è‡ªå¢ä¸»é”®ï¼Œåˆ†é¡µSQLå°±å¾ˆå®¹æ˜“å†™äº†ï¼Œè€Œä¸”ä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½¿ç”¨å¤šä¸ªçº¿ç¨‹åˆ†æ®µæŸ¥è¯¢æ•°æ®ã€‚</p>\n</li>\n</ol><h2>ç¬¬9è®²</h2><p>é—®é¢˜ï¼šè¿™ä¸€è®²æˆ‘ä»¬æåˆ°äº†mysqldumpçš„ä¸€ä¸ªé™åˆ¶ï¼šå¯¼å‡ºçš„æ•°æ®éƒ½å­˜åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¸æ–¹ä¾¿å¹¶è¡Œå¯¼å…¥ã€‚ä¸€æ¬¡ç´§æ€¥æ•…éšœä¸­ï¼Œéœ€è¦å°†mysqldumpå¤‡ä»½å‡ºæ¥çš„æ•°æ®æ¢å¤å‡ºæ¥ï¼Œæ•°æ®åº“æ¯”è¾ƒå¤§ï¼Œå•çº¿ç¨‹æ¢å¤çš„è¯ï¼Œè€—æ—¶åˆä¼šæ¯”è¾ƒä¹…ï¼Œä½ æœ‰å“ªäº›åŠæ³•æ¥åŠ å¿«æ¢å¤çš„é€Ÿåº¦ï¼Ÿ</p><p>@èŒƒç‰¹è¥¿ æåˆ°äº†å¯ä»¥è®¾ç½®æ•°æ®åº“çš„ä¸€äº›å‚æ•°æ¥æå‡æ¢å¤çš„é€Ÿåº¦ã€‚</p><p>å…¶å®mysqldumpç”Ÿæˆçš„æ–‡ä»¶ï¼Œæœ‰ä¸€äº›ç‰¹å®šçš„æ ¼å¼ï¼Œæ¯”å¦‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåˆ›å»ºæ•°æ®åº“ã€åˆ›å»ºè¡¨ã€Insertæ•°æ®å‰ï¼Œéƒ½æœ‰ç›¸åº”çš„æ³¨é‡Šæ–‡æœ¬ã€‚ä½ å¯ä»¥æ ¹æ®è¿™ä¸ªç‰¹ç‚¹ï¼Œå°†dumpæ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªæ–‡ä»¶ã€‚</p><pre><code class=\"language-plain\">--\n--  Database: `backme`\n--\n\nCREATE DATABASE /*!32312 IF NOT EXISTS*/ `backme` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;\n\nUSE `backme`;\n\n--\n-- Table structure for table `t_emoji`\n--\n\n/*!40101 SET @saved_cs_client     = @@character_set_client */;\n/*!50503 SET character_set_client = utf8mb4 */;\nCREATE TABLE `t_emoji` (\n  `a` varchar(30) DEFAULT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n/*!40101 SET character_set_client = @saved_cs_client */;\n\n--\n-- Dumping data for table `t_emoji`\n--\n\nLOCK TABLES `t_emoji` WRITE;\n/*!40000 ALTER TABLE `t_emoji` DISABLE KEYS */;\nINSERT INTO `t_emoji` VALUES (_binary 'ğŸ˜€ğŸ˜ƒ'),(_binary 'ä¸­æ–‡ç¬¦å·');\n/*!40000 ALTER TABLE `t_emoji` ENABLE KEYS */;\nUNLOCK TABLES;\n</code></pre><h2>ç¬¬10è®²</h2><p>é—®é¢˜ï¼šç”±äºå…¬å¸çš„ç­–ç•¥ï¼Œéœ€è¦å°†ä¸€ä¸ªæ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿçš„Oracleæ•°æ®åº“è¿ç§»åˆ°MySQLã€‚è¿™ä¸ªOracleæ•°æ®åº“å¤§æ¦‚æœ‰1Tæ•°æ®ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œè¦å°½å¯èƒ½ç¼©çŸ­ä¸šåŠ¡åœæœºçš„æ—¶é—´ï¼Œä¸šåŠ¡æ–¹èƒ½æ¥å—çš„æœ€å¤§åœæœºæ—¶é—´åœ¨1ï½2å°æ—¶ä¹‹å†…ã€‚è¯·ä½ è®¾è®¡ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°†æ•°æ®å¹³æ»‘åœ°è¿ç§»åˆ°MySQLã€‚ä½ éœ€è¦è€ƒè™‘å…¨é‡æ•°æ®å¦‚ä½•è¿ç§»ï¼Œä¸šåŠ¡è¿è¡ŒæœŸé—´æ–°äº§ç”Ÿçš„æ•°æ®å¦‚ä½•è¿ç§»ã€‚</p><p>@123 @ls @Geek_0126 åœ¨è¯„è®ºåŒºæä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€äº›æ•°æ®åŒæ­¥çš„å·¥å…·ã€‚</p><p>è¿™ä¸ªé—®é¢˜å’Œç¬¬8è®²çš„æ€è€ƒé¢˜æœ‰ä¸€äº›ç±»ä¼¼çš„åœ°æ–¹ï¼Œéƒ½éœ€è¦å°†æ•°æ®ä»ä¸€ä¸ªæ•°æ®åº“è¿ç§»åˆ°å¦å¤–ä¸€ä¸ªæ•°æ®åº“ã€‚è¿™ä¸ªé—®é¢˜å¤šäº†ä¸€äº›é™åˆ¶ï¼Œæºåº“å˜æˆäº†Oracleï¼Œæºç«¯å’Œç›®æ ‡ç«¯ä½¿ç”¨äº†ä¸åŒç±»å‹çš„æ•°æ®åº“ï¼Œè€Œä¸”è¿˜è¦è€ƒè™‘å¢é‡æ•°æ®ï¼Œè¦å°½é‡å‡å°‘åœæœºæ—¶é—´ã€‚</p><p>è¿™ç±»å¼‚æ„æ•°æ®è¿ç§»è¦è€ƒè™‘çš„å‡ ä¸ªé—®é¢˜ã€‚</p><ul>\n<li>\n<p>æ•°æ®ç±»å‹ï¼šä¸åŒçš„æ•°æ®åº“åœ¨æ•°æ®ç±»å‹ä¸Šä¼šæœ‰ä¸€äº›åŒºåˆ«ï¼Œéœ€è¦åšä¸€ä¸ªæ˜ å°„ã€‚æ¯”å¦‚Oracleçš„Numberç±»å‹ï¼Œæ ¹æ®ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥å¯¹åº”åˆ°MySQLä¸­çš„intç³»åˆ—ç±»å‹æˆ–decimalã€‚</p>\n</li>\n<li>\n<p>å…¨é‡æ•°æ®å¤„ç†ï¼šå…¨é‡æ•°æ®çš„åŒæ­¥æœ¬è´¨ä¸Šå°±æ˜¯Select+Insertã€‚ä¸è¿‡ç”±äºæ•°æ®é‡å¤§ï¼Œè¦è€ƒè™‘æ•ˆç‡é—®é¢˜ã€‚ä½¿ç”¨sqluldr2å°†Oracleçš„æ•°æ®å¯¼å‡ºæˆæ–‡æœ¬ï¼Œç„¶åå†ä½¿ç”¨load dataå‘½ä»¤å¯¼å…¥åˆ°MySQLæ˜¯æ•ˆç‡æ¯”è¾ƒé«˜çš„ä¸€ç§æ–¹æ³•ã€‚</p>\n</li>\n<li>\n<p>å¢é‡æ•°æ®å¤„ç†ï¼šå¢é‡æ•°æ®æœ‰å‡ ç§ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p>\n<ul>\n<li>\n<p>ä¸€ç§æ–¹å¼æ˜¯åœ¨ä¸šåŠ¡ä¾§å¤„ç†ï¼Œæ¯”å¦‚ä½¿ç”¨åŒå†™ï¼Œæˆ–è€…å°†æºç«¯æ‰€æœ‰çš„æ•°æ®ä¿®æ”¹éƒ½è®°å½•ä¸€ä»½åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†å†™ä¸€ä¸ªç¨‹åºè®¢é˜…æ¶ˆæ¯ï¼Œå°†å˜æ›´åŒæ­¥åˆ°ç›®æ ‡åº“ã€‚è¿™å¯¹åº”ç”¨æœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚ã€‚</p>\n</li>\n<li>\n<p>å¦ä¸€ç§æ–¹å¼æ˜¯è§£æOracleçš„Redoæ—¥å¿—ï¼ŒåŒæ­¥å¢é‡æ•°æ®ã€‚è¿™é€šå¸¸éœ€è¦å€ŸåŠ©ä¸€äº›å·¥å…·ï¼Œæ¯”å¦‚OGGã€‚è‡ªå·±è§£æRedoæœ‰æ¯”è¾ƒé«˜çš„æŠ€æœ¯é—¨æ§›ï¼Œä¸åŒç‰ˆæœ¬Oracle Redoæ ¼å¼å¯èƒ½è¿˜ä¼šæœ‰ä¸€äº›å·®å¼‚ã€‚å¯ä»¥å°è¯•Oracleçš„LogMinerã€‚</p>\n</li>\n<li>\n<p>è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ç‰©åŒ–è¯•å›¾ï¼Œæˆ–è€…ç»™æºç«¯çš„è¡¨å»ºç«‹è§¦å‘å™¨ï¼Œå°†æ•°æ®å˜åŠ¨è®°å½•åˆ°æ—¥å¿—è¡¨ï¼Œæ ¹æ®æ—¥å¿—è¡¨çš„æ•°æ®æ¥å¢é‡åŒæ­¥æ•°æ®ã€‚è¿™ä¼šå¯¹æºç«¯çš„å†™å…¥å¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ã€‚</p>\n</li>\n</ul>\n</li>\n</ul><p>ç»¼åˆæ¥çœ‹ï¼Œä½¿ç”¨ä¸€äº›æˆç†Ÿçš„å·¥å…·ï¼Œæ˜¯å®æ–½å¼‚æ„å¢é‡è¿ç§»æ¯”è¾ƒå¥½çš„ä¸€ä¸ªé€‰æ‹©ã€‚</p><h2>ç¬¬11è®²</h2><p>é—®é¢˜ï¼šåªä¿®æ”¹å…ƒæ•°æ®çš„DDLã€INSTANT DDLæ‰§è¡Œé€Ÿåº¦é€šå¸¸éƒ½å¾ˆå¿«ï¼Œä½†æ˜¯è¿™äº›DDLæ‰§è¡Œä¹Ÿæ˜¯éœ€è¦è·å–å…ƒæ•°æ®é”çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><ul>\n<li>ä¼šè¯1å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰§è¡Œä¸€ä¸ªselect for updateæ“ä½œã€‚</li>\n</ul><pre><code class=\"language-plain\">mysql&gt; desc t_ddl;\n+-------+------+------+-----+---------+-------+\n| Field | Type | Null | Key | Default | Extra |\n+-------+------+------+-----+---------+-------+\n| a     | int  | NO   | PRI | NULL    |       |\n| b     | int  | YES  |     | NULL    |       |\n+-------+------+------+-----+---------+-------+\n2 rows in set (0.01 sec)\n\n\nmysql&gt; begin;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; select * from t_ddl limit 1 for update;\nEmpty set (1.12 sec)\n</code></pre><ul>\n<li>ä¼šè¯2 æ‰§è¡Œä¸€ä¸ªinstant DDLã€‚</li>\n</ul><p>mysql&gt; alter table t_ddl add c int, algorithm=instant;</p><ul>\n<li>ä¼šè¯3 æ‰§è¡Œä¸€ä¸ªæ™®é€šçš„selectæ“ä½œã€‚</li>\n</ul><p>mysql&gt; select * from t_ddl limit 1;</p><p>ä½ ä¼šå‘ç°ï¼Œä¼šè¯2å’Œä¼šè¯3éƒ½è¢«é˜»å¡äº†ã€‚ä»processlistå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬éƒ½åœ¨ç­‰å¾…å…ƒæ•°æ®é”ã€‚ï¼ˆè¾“å‡ºç»“æœåšäº†ç®€åŒ–ï¼‰</p><pre><code class=\"language-plain\">mysql&gt; show processlist;\n+----+---------+------+---------------------------------+------------------------------------------------+\n| Id | Command | Time | State                           | Info                                           |\n+----+---------+------+---------------------------------+------------------------------------------------+\n|  8 | Sleep   |  116 |                                 | NULL                                           |\n| 11 | Query   |  105 | Waiting for table metadata lock | alter table t_ddl add c int, algorithm=instant |\n| 12 | Query   |   96 | Waiting for table metadata lock | select * from t_ddl limit 1                    |\n+----+---------+------+---------------------------------+------------------------------------------------+\n</code></pre><p>ä»performance_schema.metadata_locksä¹Ÿå¯ä»¥çœ‹åˆ°t_ddlè¡¨çš„å…ƒæ•°æ®æŒæœ‰å’Œè¯·æ±‚æƒ…å†µã€‚</p><pre><code class=\"language-plain\">mysql&gt; select * from metadata_locks where object_name = 't_ddl';\n-------------+-------------------+-------------+-------------------+-----------------+\n OBJECT_NAME | LOCK_TYPE         | LOCK_STATUS | SOURCE            | OWNER_THREAD_ID |\n-------------+-------------------+-------------+-------------------+-----------------+\n t_ddl       | SHARED_WRITE      | GRANTED     | sql_parse.cc:6093 |              49 |\n t_ddl       | SHARED_UPGRADABLE | GRANTED     | sql_parse.cc:6093 |              50 |\n t_ddl       | EXCLUSIVE         | PENDING     | mdl.cc:3753       |              50 |\n t_ddl       | SHARED_READ       | PENDING     | sql_parse.cc:6093 |              51 |\n-------------+-------------------+-------------+-------------------+-----------------+\n</code></pre><p>è¿˜æœ‰å“ªäº›æƒ…å†µä¼šå¯¼è‡´DDLæ— æ³•è·å–åˆ°å…ƒæ•°æ®é”ï¼Ÿæ€ä¹ˆå¿«é€Ÿå®šä½åˆ°å…ƒæ•°æ®é”çš„é˜»å¡æºï¼Ÿ</p><p>@å¶æ˜ @Shelly @Geek_0126 æä¾›äº†è¿™ä¸ªé—®é¢˜çš„è§£ç­”ã€‚è¿™é‡Œå†ç®€å•æ€»ç»“ä¸‹ã€‚</p><p>ä¸‹é¢è¿™å‡ ç§æƒ…å†µéƒ½ä¼šé˜»å¡DDLã€‚</p><ul>\n<li>\n<p>æœ‰æ…¢SQLè¿˜åœ¨è¿è¡Œä¸­ï¼Œè®¿é—®äº†è¿™ä¸ªè¡¨ã€‚</p>\n</li>\n<li>\n<p>äº‹åŠ¡ä¸­ï¼Œè®¿é—®è¿‡è¿™ä¸ªè¡¨ï¼ˆæŸ¥è¯¢æˆ–ä¿®æ”¹ï¼‰ï¼Œå¹¶ä¸”äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ã€‚</p>\n</li>\n<li>\n<p>å…¨å±€é”ï¼Œæ¯”å¦‚flush tables with read lockï¼Œlock instance for backup</p>\n</li>\n<li>\n<p>è¡¨é”ï¼Œlock tables</p>\n</li>\n</ul><p>ä»sys.schema_table_lock_waitsã€performance_schema.metadata_locksè¡¨æŸ¥çœ‹è¡¨é”ã€å…ƒæ•°æ®é”ã€‚</p><h2>ç¬¬12è®²</h2><p>é—®é¢˜ï¼šgh-ostæ˜¯æ¯”è¾ƒçŸ¥åçš„ä¸€æ¬¾åœ¨çº¿DDLå·¥å…·ï¼Œåœ¨å®ç°ä¸Šä¹Ÿéå¸¸æœ‰ç‰¹è‰²ã€‚gt-oståœ¨æ‰§è¡ŒDDLå˜æ›´æ—¶ï¼Œä¸éœ€è¦ç»™æºè¡¨å»ºè§¦å‘å™¨ï¼Œè€Œæ˜¯é€šè¿‡BINLOGæ¥æ•æ‰DDLå˜æ›´æœŸé—´å‘ç”Ÿè¿‡å˜åŒ–çš„æ•°æ®ã€‚æˆ‘å°è¯•åœ¨æµ‹è¯•ç¯å¢ƒåšäº†ä¸€ä¸ªå®éªŒã€‚</p><pre><code class=\"language-plain\">gh-ost -alter \"alter table employees_bak modify hire_date date\" \\\n  -user user_01 \\\n  -host 127.0.0.1 \\\n  -password somepass \\\n  -database employees \\\n  --allow-on-master \\\n  --execute \\\n  -heartbeat-interval-millis 1000\n</code></pre><p>åœ¨æ‰§è¡Œgh-ostå‰ï¼Œæˆ‘å…ˆå¼€å¯äº†general_logï¼Œæœ€ç»ˆåœ¨general logä¸­å‘ç°æœ‰ä»¥ä¸‹è¿™å‡ ç±»SQLã€‚</p><ul>\n<li>create table like</li>\n</ul><pre><code class=\"language-plain\">create /* gh-ost */ table `employees`.`_employees_bak_gho` \n  like `employees`.`employees_bak`\n</code></pre><ul>\n<li>alter table</li>\n</ul><p>alter /* gh-ost */ table <code>employees</code>.<code>_employees_bak_gho</code> modify hire_date date</p><ul>\n<li>select</li>\n</ul><pre><code class=\"language-plain\">select  /* gh-ost `employees`.`employees_bak` iteration:0 */\n    `emp_no`\nfrom `employees`.`employees_bak`\nwhere ((`emp_no` &gt; _binary'10001') or ((`emp_no` = _binary'10001'))) \nand ((`emp_no` &lt; _binary'20000') or ((`emp_no` = _binary'20000')))\norder by `emp_no` asc\nlimit 1\noffset 999\n</code></pre><ul>\n<li>insert ignore into</li>\n</ul><pre><code class=\"language-plain\">insert /* gh-ost `employees`.`employees_bak` */ \nignore into `employees`.`_employees_bak_gho` \n(`emp_no`, `birth_date`, `first_name`, `last_name`, `gender`, `hire_date`)\n( \n  select `emp_no`, `birth_date`, `first_name`, `last_name`, `gender`, `hire_date` \n  from `employees`.`employees_bak` force index (`PRIMARY`)\n  where (((`emp_no` &gt; _binary'10001') or ((`emp_no` = _binary'10001')))\n  and ((`emp_no` &lt; _binary'11000') or ((`emp_no` = _binary'11000')))) \n  lock in share mode\n)\n</code></pre><ul>\n<li>replace into</li>\n</ul><pre><code class=\"language-plain\">replace /* gh-ost `employees`.`_employees_bak_gho` */ into\n    `employees`.`_employees_bak_gho`(`emp_no`, `birth_date`, `first_name`, `last_name`, `gender`, `hire_date`)\nvalues (20001, '1962-05-16', _binary'Atreye', _binary'Eppinger', ELT(1, 'M','F'), '1990-04-18')\n</code></pre><ul>\n<li>rename table</li>\n</ul><p>rename /* gh-ost */ table <code>employees</code>.<code>employees_bak</code> to <code>employees</code>.<code>_employees_bak_del</code>, <code>employees</code>.<code>_employees_bak_gho</code> to <code>employees</code>.<code>employees_bak</code></p><p>ä¸Šé¢çš„è¿™å‡ ç±»SQLï¼Œåˆ†åˆ«èµ·åˆ°äº†ä»€ä¹ˆä½œç”¨ï¼Ÿinsert ignore intoå’Œreplace intoçš„æ‰§è¡Œé¡ºåºï¼Œå¯¹æœ€ç»ˆæ•°æ®çš„ä¸€è‡´æ€§æœ‰å½±å“å—ï¼Ÿæ‰§è¡Œinsert ignore into â€¦ select from â€¦ çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆè¦åŠ ä¸Šlock in share modeï¼Ÿ</p><p>@å¶æ˜ @Shelly @123 åœ¨è¯„è®ºåŒºæä¾›äº†è¿™ä¸ªé—®é¢˜çš„è§£ç­”ã€‚</p><ul>\n<li>\n<p>create table likeï¼šåˆ›å»ºä¸´æ—¶è¡¨ï¼Œå¤åˆ¶è¡¨ç»“æ„ã€‚</p>\n</li>\n<li>\n<p>alter tableï¼šæ ¹æ®å‘½ä»¤æ›´æ”¹è¡¨è¡¨ç»“æ„ã€‚</p>\n</li>\n<li>\n<p>selectï¼šå¹¶å‘è¯»å–æ•°æ®ï¼ˆçœ‹åˆ°äº†åç§»é‡ï¼Œåº”è¯¥æ˜¯å¤šçº¿ç¨‹ï¼‰å†™å…¥ä¸´æ—¶è¡¨ã€‚</p>\n</li>\n<li>\n<p>insert ignore intoï¼šä»æºè¡¨selectå‡ºæ¥çš„æ•°æ®ï¼Œä½¿ç”¨insert ignore intoæ’å…¥åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œå¿½ç•¥é‡å¤çš„æ•°æ®ã€‚</p>\n</li>\n<li>\n<p>updateï¼šbinlogä¸­çš„Updateäº‹ä»¶è§£æä¸ºUpdateè¯­å¥ã€‚</p>\n</li>\n<li>\n<p>replace intoï¼šbinlogä¸­çš„Insertäº‹ä»¶è§£æä¸ºreplace intoè¯­å¥ï¼Œå°†å¢é‡æ•°æ®å†™åˆ°ä¸´æ—¶è¡¨ã€‚</p>\n</li>\n<li>\n<p>deleteï¼šbinlogä¸­çš„Deleteäº‹ä»¶è§£æä¸ºDeleteè¯­å¥ã€‚</p>\n</li>\n<li>\n<p>rename tableï¼šå°†ä¸´æ—¶è¡¨å˜æ›´ä¸ºç”Ÿäº§è¡¨ã€‚</p>\n</li>\n</ul><p>lock in share modeæ˜¯ä¸ºäº†ä¿è¯å½±å­è¡¨æ•°æ®å’ŒåŸè¡¨ä¸€è‡´ã€‚ Binlogå¯è§å’Œäº‹ç‰©å¯è§ä¹‹é—´å­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®ï¼Œå¦‚æœä¸åŠ lock in shared modeï¼Œæºåº“æ‰§è¡Œdeleteè¯­å¥æ—¶ï¼Œbinlogä¸­è¯»åˆ°äº†deleteè¯­å¥ï¼Œä½†selectå¯èƒ½ä¼šè¯»å–åˆ°DELETEä¹‹å‰çš„æ•°æ®ã€‚è¿™æ ·ï¼Œå¦‚æœå…ˆå¯¹å½±å­è¡¨æ‰§è¡Œäº†deleteï¼Œç„¶åå†æ‰§è¡Œinsert ignore intoæ—¶ï¼Œä¼šæŠŠæœ¬æ¥åº”è¯¥å·²ç»deleteæ‰çš„æ•°æ®ï¼Œæ’å…¥åˆ°å½±å­è¡¨ï¼Œå°±å¤šæ•°æ®äº†ã€‚</p><h2>ç¬¬13è®²</h2><p>é—®é¢˜ï¼šå›½åº†èŠ‚å‡æœŸï¼ŒDBAå°æ˜çªç„¶æ¥åˆ°å¤§é‡æ•°æ®åº“å‘Šè­¦ï¼Œç™»å½•æ•°æ®åº“æ‰§è¡ŒSHOW PROCESSLISTåï¼Œå‘ç°å¤§é‡ä¼šè¯è¢«é˜»å¡äº†ã€‚ä¸‹é¢æä¾›äº†éƒ¨åˆ†ä¼šè¯çš„ä¿¡æ¯ã€‚è¯·ä½ æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œå¸®å°æ˜ä¸€èµ·åˆ†æä¸‹ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Ÿåº”è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæœ‰å“ªäº›åœ°æ–¹å¯ä»¥æ”¹è¿›ï¼Ÿ</p><pre><code class=\"language-plain\">Id: 1842782 \nUser: user_xx \nHost: xx.xx.xx.xx:59068 \ndb: db_xx \nCommand: Query \nTime: 2326 \nState: Waiting for table\nInfo: update stat_item_detail set sold=sold+1, money=money+19800, Gmt_create=now() where item_id=1234567801 and day='2011-10-07 00:00:00\n\n\nId: 1657130 \nUser: user_xx \nHost: yy.yy.yy.yy:40093 \ndb: db_xx \nCommand: Query \nTime: 184551 \nState: Sending data \nInfo: select item_id, sum(sold) as sold from stat_item_detail where item_id in (select item_id from stat_item_detail where Gmt_create &gt;= '2011-10-05 08:59:00') group by item_id\n\n\nId: 1044\nUser: system user\nHost:\ndb:\nCommand: Connect \nTime: 27406\nState: Flushing tables FLUSH TABLES\nInfo:\n</code></pre><p>@å¶æ˜ @binzhang æä¾›äº†è¿™ä¸ªé—®é¢˜çš„è§£ç­”ã€‚æˆ‘å†è¡¥å……ä¸€äº›ä¿¡æ¯ã€‚</p><ul>\n<li>\n<p>Idä¸º1657130çš„çº¿ç¨‹æ˜¯è¿™é‡Œçš„é˜»å¡æºã€‚è¿™ä¸ªSQLæ‰§è¡Œäº†2å¤©å¤šè¿˜æ²¡å®Œæˆã€‚å½“æ—¶ç”¨çš„åº”è¯¥æ˜¯MySQL 5.1è¿˜æ˜¯5.5ï¼ŒINå­æŸ¥è¯¢çš„æ•ˆç‡æ¯”è¾ƒä½ï¼Œä»¥ä¸»æŸ¥è¯¢ä½œä¸ºé©±åŠ¨è¡¨ï¼Œä½†æ˜¯ä¸»æŸ¥è¯¢ä¸Šåˆæ²¡æœ‰å…¶ä»–æœ‰æ•ˆçš„è¿‡æ»¤æ¡ä»¶ã€‚</p>\n</li>\n<li>\n<p>Idä¸º1044çš„çº¿ç¨‹æ‰§è¡Œäº†Flushing tables FLUSH TABLESï¼Œç”±äºIdä¸º1657130çš„çº¿ç¨‹ä¸€ç›´åœ¨æ‰§è¡ŒSQLï¼Œå› æ­¤è¢«é˜»å¡äº†ã€‚</p>\n</li>\n<li>\n<p>Idä¸º1044çš„Useræ˜¯system userï¼Œè¿™æ¯”è¾ƒæœ‰æ„æ€ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªSQLçº¿ç¨‹ï¼Œè¯´æ˜FLUSH TABLESè¿™ä¸ªæ“ä½œæ˜¯ä»ä¸»åº“ä¸­å¤åˆ¶è¿‡æ¥çš„ã€‚è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªMMæ¶æ„çš„ç¯å¢ƒï¼Œå¤‡åº“ä¸Šä½¿ç”¨mysqldumpå¤‡ä»½æ•°æ®ï¼Œå‘èµ·äº†FLUSH TABLESæ“ä½œï¼Œå¤åˆ¶åˆ°äº†ä¸šåŠ¡çš„ä¸»åº“ã€‚</p>\n</li>\n<li>\n<p>Idä¸º1842782çš„çº¿ç¨‹è®¿é—®è¡¨æ—¶ï¼Œè¢«é˜»å¡äº†ã€‚</p>\n</li>\n</ul><p>è¿™é‡Œå…¶å®è¿˜æš´éœ²äº†å½“æ—¶çš„ç›‘æ§ä¸å¤Ÿå®Œå–„ã€‚IDä¸º1657130çš„çº¿ç¨‹ï¼Œæ‰§è¡Œè¶…è¿‡äº†2å¤©ã€‚SQLæ‰§è¡Œæ—¶é—´è¶…è¿‡ä¸€å®šçš„é˜ˆå€¼å°±å¯ä»¥å‘Šè­¦å‡ºæ¥ã€‚</p><h2>ç¬¬14è®²</h2><p>é—®é¢˜ï¼šæœ‰ä¸€ä¸ªç”Ÿäº§ç¯å¢ƒçš„ç³»ç»Ÿï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°æ•°æ®åº“è¿æ¥è¶…æ—¶çš„æŠ¥é”™ã€‚ä»æŠ¥é”™çš„ä¿¡æ¯çœ‹ï¼Œè¶…æ—¶åº”è¯¥å’Œç½‘ç»œæœ‰ç‚¹å…³ç³»ã€‚é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œä½ ä¼šä½¿ç”¨å“ªäº›æ–¹æ³•æ¥å®šä½åŸå› å‘¢ï¼Ÿ</p><p>å¦‚æœä½ çŸ¥é“æ•°æ®åº“çš„è¿æ¥åœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç ï¼Œå°±å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯æµ‹è¯•æ•°æ®åº“æ˜¯å¦èƒ½æ­£å¸¸è¿æ¥ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½å¹¶ä¸çœŸæ­£çŸ¥é“æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯ï¼Œæ¯”å¦‚è¿æ¥åœ°å€å¯èƒ½ç¡¬ç¼–ç åœ¨ä»£ç ä¸­äº†ï¼Œæˆ–è€…è¿æ¥åœ°å€åœ¨å¤šä¸ªé…ç½®æ–‡ä»¶ä¸­ä¸ªå‘¢é…ç½®ï¼Œæˆ–è€…è¿æ¥åœ°å€ä¿¡æ¯å­˜åœ¨åœ¨æŸä¸ªæ•°æ®åº“ä¸­ã€‚</p><p>æœ‰æ—¶å€™ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿æ¥åˆ°äº†é”™è¯¯çš„IPåœ°å€ã€‚æœ‰ä»€ä¹ˆåŠæ³•æŸ¥çœ‹åº”ç”¨è¿æ¥äº†å“ªä¸ªIPå‘¢ï¼Ÿæœ‰å‡ ç§æ–¹æ³•å¯ä»¥å°è¯•ã€‚</p><ul>\n<li>\n<p>ä½¿ç”¨straceï¼Œæˆ–è€…å…¶ä»–traceå·¥å…·ï¼ˆå¦‚systemtapï¼‰ï¼ŒæŸ¥çœ‹åº”ç”¨ç¨‹åºçš„ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ†æç³»ç»Ÿè°ƒç”¨çš„å‚æ•°ã€‚</p>\n</li>\n<li>\n<p>ä½¿ç”¨net statæˆ–sså‘½ä»¤ï¼ŒæŸ¥çœ‹ç³»ç»Ÿä¸Šçš„TCPè¿æ¥ã€‚å¦‚æœç¨‹åºè¿æ¥äº†é”™è¯¯çš„IPï¼Œå¯èƒ½ä¼šçœ‹åˆ°æœ‰TCPè¿æ¥çš„çŠ¶æ€æ˜¯SYN_SENTã€‚</p>\n</li>\n<li>\n<p>ä½¿ç”¨tcpdumpæŠ“å–å’Œåˆ†æç½‘ç»œæµé‡ã€‚</p>\n</li>\n</ul><h2>ç¬¬15è®²</h2><p>é—®é¢˜ï¼šMySQLä¸­å­˜åœ¨è¿™ä¹ˆä¸€ä¸ªç°è±¡ï¼Œå¹³æ—¶æ‰§è¡Œå¾—å¥½å¥½çš„SQLï¼Œåœ¨æ•°æ®åº“å¾ˆç¹å¿™çš„æ—¶å€™ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿä¼šå˜å¾—å¾ˆå·®ï¼Œå½“ç„¶ï¼Œè¿™å¯ä»¥ç†è§£ã€‚ä½ ä»Processlistæˆ–æ…¢SQLæ—¥å¿—ä¸­çœ‹åˆ°æ‰§è¡Œè€—æ—¶æ¯”è¾ƒé•¿çš„SQLï¼Œå…¶ä¸­æœ‰äº›æ˜¯å¼•èµ·æ•°æ®åº“æ€§èƒ½é—®é¢˜çš„ç½ªé­ç¥¸é¦–ï¼Œæœ‰äº›åˆ™æ˜¯å—å®³è€…ã€‚ä½ åº”è¯¥æ€ä¹ˆåŒºåˆ†è¿™ä¸¤ç§æƒ…å†µï¼Œæ‰¾åˆ°çœŸæ­£éœ€è¦ä¼˜åŒ–çš„é‚£äº›SQLå‘¢ï¼Ÿ</p><p>@å¶æ˜ @èŒƒç‰¹è¥¿ æä¾›å¾ˆå¥½çš„ä¸€ä¸ªæ€è·¯ï¼Œæ ¹æ®SQLçš„æ‰«æå‡½æ•°æ¥åˆ¤æ–­ã€‚è¿˜å¯ä»¥æ ¹æ®SQLçš„æ‰§è¡Œå†å²æ¥è¿›è¡Œåˆ†æã€‚</p><p>å¦‚æœæœ‰ä¸€ä¸ªç©ºé—²çš„å¤‡åº“ï¼Œå¯ä»¥åˆ°å¤‡åº“ä¸Šæ‰§è¡ŒSQLï¼Œå¯¹æ¯”æ‰§è¡Œæ—¶é—´ã€‚</p><h2>ç¬¬16è®²</h2><p>é—®é¢˜ï¼šæœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨é€»è¾‘çš„æ–¹å¼æ¥å‡çº§æ•°æ®åº“ï¼Œæ¯”å¦‚å°†çº¿ä¸‹ä½ç‰ˆæœ¬çš„æ•°æ®åº“è¿ç§»åˆ°äº‘ä¸Šé«˜ç‰ˆæœ¬çš„å®ä¾‹ä¸­ã€‚ä½¿ç”¨é€»è¾‘çš„æ–¹å¼å‡çº§æˆ–é™çº§æ•°æ®åº“ï¼Œå¯èƒ½ä¼šå­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿæœ‰å“ªäº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Ÿ</p><p>ä½¿ç”¨é€»è¾‘å¤‡ä»½ï¼Œæ¯”å¦‚mysqldumpå¯¼å‡ºçš„sqlæ–‡ä»¶ï¼Œåˆ°ä½ç‰ˆæœ¬çš„MySQLä¸Šæ‰§è¡Œæ—¶ï¼Œå¯èƒ½ä¼šç”±äºæ•°æ®ç±»å‹ã€SQLè¯­æ³•ç­‰ä¸å…¼å®¹é—®é¢˜ï¼Œå‡ºç°å¯¼å…¥æŠ¥é”™çš„æƒ…å†µã€‚å¦‚æœé«˜ç‰ˆæœ¬çš„mysqlä¸­ä½¿ç”¨äº†ä¸€äº›æ–°çš„ç‰¹æ€§ï¼Œåœ¨ä½ç‰ˆæœ¬ä¸Šä¸æ”¯æŒï¼Œå°±å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚</p>","neighbors":{"left":{"article_title":"ç»“è¯¾æµ‹è¯•ï½œæ¥èµ´ä¸€åœºæ»¡åˆ†ä¹‹çº¦å§","id":830875},"right":{"article_title":"SQLä¼˜åŒ–ç¯‡ï½œè¯¾åé¢˜ç­”ç–‘","id":833063}},"comments":[]}