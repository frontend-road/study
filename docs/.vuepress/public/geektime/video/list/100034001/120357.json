{"id":120357,"title":"15 | 如何使用索引访问和修改字符串","content":"<p><strong>课件地址</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/swift-course\">https://gitee.com/geektime-geekbang/swift-course</a></p>","comments":[{"had_liked":false,"id":139562,"user_name":"John","can_delete":false,"product_type":"c3","uid":1454867,"ip_address":"","ucode":"4A8FC69DDB3659","user_header":"https://static001.geekbang.org/account/avatar/00/16/33/13/058abc7b.jpg","comment_is_top":false,"comment_ctime":1570679195,"is_pvip":false,"replies":[{"id":58047,"content":"解释地还是比较好的","user_name":"作者回复","user_name_real":"Geek_f72435","uid":1341726,"ctime":1573635665,"ip_address":"","comment_id":139562,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"可能很多同学有以下疑问。 我来回答以下。\n\n问：为什么Swift中的字符串在进行切片操作的时候不能像Python或者其他语言，使用数字下标？而使用String.Index这个结构体\n\n回答：\n在Unicode中， 一个我们可以看得见的单一字符，有可能并不是一个Unicdoe标量。例如【é】这个字符。它可以是一个Unicode标量【\\u{e9}】， 也有可能是二个Unicode标量【\\u{65}】和【\\u{301}】组合的结果。上述2个标量的情况在Swift计算中，仍然会被认为是1个字符。\n\n我们可以认为Swift中的charactor类型是一种扩展的类型。其由1个或者多个Unicode标量组成。不再是我们认为的1对1的对应关系。character是一个Unicode标量序列。\n\n正因如此。一个字符串的长度，或者随机访问，需要遍历这个字符串的char序列进行Combine计算后才能得到。所以Swift用String.Index这个结构体来抽象String中的char的index。Swift也就不能提供下标为数字的随机访问。而且仅提供Start和End2个默认的String.index。 这是因为它只能告诉你最开始的和最后的， 因为其他的都需要去从前或者从后进行遍历。在需要的时候进行Unicode变量组合计算后才能真正获知。\n\n那有没有方法我使用数字字面量来进行切片呢？\n答案是可以的。\n\n如下：\nextension String {\n    public subscript(intRange: Range&lt;Int&gt;) -&gt; String {\n        let start = self.index(startIndex, offsetBy: intRange.startIndex)\n        let end = self.index(startIndex, offsetBy: intRange.endIndex)\n        let range = start..&lt;end\n        return String(self[range])\n    }\n} \n\n我们使用扩展。来扩展String 类型的一个下标操作。传入的Range是Int类型的。\n\n这个解决方法里体现了Swift的面向协议思想、扩展特性、以及自定义操作符等等知识点。所以。Swift的学习门槛还是挺高的。 即使在讲解基础知识的时候。也融进去了Swift的高级编程特性、或者思想。\n\n学习的时候可以先把为什么记下来。 待学习完其他章节后，再回过头来自己尝试解决这些为什么。","like_count":9,"discussions":[{"author":{"id":1341726,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxtKhpmvzx2VB4iajicfJVFmQR3eP3xBpdpQEovpSqUfAOrNImvYwVb7P37ibI0ONziau9sbFEk8oDaA/132","nickname":"elfgate","note":"","ucode":"3C0B5F7C1F664C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470003,"discussion_content":"解释地还是比较好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573635665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":181011,"user_name":"o0oi1i","can_delete":false,"product_type":"c3","uid":1132312,"ip_address":"","ucode":"D1F6AD4AAEAFBE","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/18/293cd24d.jpg","comment_is_top":false,"comment_ctime":1582459249,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"打卡15","like_count":1},{"had_liked":false,"id":168130,"user_name":"微笑美男😄","can_delete":false,"product_type":"c3","uid":1010774,"ip_address":"","ucode":"E188923723703B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6c/56/07920099.jpg","comment_is_top":false,"comment_ctime":1578016909,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"selectedDay[selectedDay.startIndex] 现在通过这种方式取值错啊 Cannot convert value of type &#39;Character&#39; to specified type &#39;String&#39;报这个错误 最新怎么根据索引取值啊","like_count":1,"discussions":[{"author":{"id":1382587,"avatar":"https://static001.geekbang.org/account/avatar/00/15/18/bb/9299fab1.jpg","nickname":"Null","note":"","ucode":"A7D4DF2A43C7D8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552624,"discussion_content":"你是不是这么写的：let firstChar: String = selectedDay[selectedDay.startIndex]，这样肯定不行，读出来的是charactor类型，赋值到string类型了，直接let firstChar = selectedDay[selectedDay.startIndex] 就可以啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645528132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147387,"user_name":"不想太帅","can_delete":false,"product_type":"c3","uid":1470666,"ip_address":"","ucode":"8EAEECB8A62459","user_header":"https://static001.geekbang.org/account/avatar/00/16/70/ca/c3228cdb.jpg","comment_is_top":false,"comment_ctime":1572861640,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"为啥\nvar welcome = &quot;hello&quot;\nprint(welcome.insert(&quot;!&quot;, at: welcome.endIndex))\n这样打印的结果是\n()\n\nwelcome.insert(&quot;!&quot;, at: welcome.endIndex)\nprint(welcome)\n打印结果就是\nhello!\n\n这个完全和oc不一样~，oc这样也是可以打印的","like_count":1,"discussions":[{"author":{"id":1341726,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxtKhpmvzx2VB4iajicfJVFmQR3eP3xBpdpQEovpSqUfAOrNImvYwVb7P37ibI0ONziau9sbFEk8oDaA/132","nickname":"elfgate","note":"","ucode":"3C0B5F7C1F664C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49778,"discussion_content":"Swift里面insert不返回值","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573635260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139089,"user_name":"石山岭","can_delete":false,"product_type":"c3","uid":1456809,"ip_address":"","ucode":"CD1B2394B4A136","user_header":"https://static001.geekbang.org/account/avatar/00/16/3a/a9/6f4a9c59.jpg","comment_is_top":false,"comment_ctime":1570543335,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"感觉好麻烦，自己这一个扩展，用下标添加，删除字符串会方便好多，类似oc的写法","like_count":1,"discussions":[{"author":{"id":1341726,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLxtKhpmvzx2VB4iajicfJVFmQR3eP3xBpdpQEovpSqUfAOrNImvYwVb7P37ibI0ONziau9sbFEk8oDaA/132","nickname":"elfgate","note":"","ucode":"3C0B5F7C1F664C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":49779,"discussion_content":"可以看下John的回复，解释地比较好了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573635308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1470666,"avatar":"https://static001.geekbang.org/account/avatar/00/16/70/ca/c3228cdb.jpg","nickname":"不想太帅","note":"","ucode":"8EAEECB8A62459","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":43176,"discussion_content":"确实好麻烦，哪个再说Swift好简单的。。。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572861293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264659,"user_name":"奋斗的小朱","can_delete":false,"product_type":"c3","uid":1628186,"ip_address":"","ucode":"EB98E73E7DC6C9","user_header":"https://static001.geekbang.org/account/avatar/00/18/d8/1a/cf7cf45d.jpg","comment_is_top":false,"comment_ctime":1606565544,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"print(welcome.index(before: welcome.endIndex))\n打印的结果为Index(_rawBits: 262401)，为什么呢？\n","like_count":0},{"had_liked":false,"id":147364,"user_name":"不想太帅","can_delete":false,"product_type":"c3","uid":1470666,"ip_address":"","ucode":"8EAEECB8A62459","user_header":"https://static001.geekbang.org/account/avatar/00/16/70/ca/c3228cdb.jpg","comment_is_top":false,"comment_ctime":1572861008,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100034001,"comment_content":"为啥\nvar welcome = &quot;hello&quot;\nprint(welcome.insert(&quot;!&quot;, at: welcome.endIndex))\n这样打印的结果是\n（）","like_count":0}]}