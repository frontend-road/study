{"id":84529,"title":"45 | ç­”ç–‘ï¼ˆäº”ï¼‰ï¼šç½‘ç»œæ”¶å‘è¿‡ç¨‹ä¸­ï¼Œç¼“å†²åŒºä½ç½®åœ¨å“ªé‡Œï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸“æ æ›´æ–°è‡³ä»Šï¼Œå››å¤§åŸºç¡€æ¨¡å—çš„æœ€åä¸€ä¸ªæ¨¡å—â€”â€”ç½‘ç»œç¯‡ï¼Œæˆ‘ä»¬å°±å·²ç»å­¦å®Œäº†ã€‚å¾ˆå¼€å¿ƒä½ è¿˜æ²¡æœ‰æ‰é˜Ÿï¼Œä»ç„¶åœ¨ç§¯æå­¦ä¹ æ€è€ƒå’Œå®è·µæ“ä½œï¼Œçƒ­æƒ…åœ°ç•™è¨€å’Œäº’åŠ¨ã€‚è¿˜æœ‰ä¸å°‘åŒå­¦åˆ†äº«äº†åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç¢°åˆ°å„ç§æ€§èƒ½é—®é¢˜çš„åˆ†ææ€è·¯å’Œä¼˜åŒ–æ–¹æ³•ï¼Œè¿™é‡Œä¹Ÿè°¢è°¢ä½ ä»¬ã€‚</p><p>ä»Šå¤©æ˜¯æ€§èƒ½ä¼˜åŒ–ç­”ç–‘çš„ç¬¬äº”æœŸã€‚ç…§ä¾‹ï¼Œæˆ‘ä»ç½‘ç»œæ¨¡å—çš„ç•™è¨€ä¸­ï¼Œæ‘˜å‡ºäº†ä¸€äº›å…¸å‹é—®é¢˜ï¼Œä½œä¸ºä»Šå¤©çš„ç­”ç–‘å†…å®¹ï¼Œé›†ä¸­å›å¤ã€‚åŒæ ·çš„ï¼Œä¸ºäº†ä¾¿äºä½ å­¦ä¹ ç†è§£ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§æ–‡ç« é¡ºåºæ’åˆ—çš„ã€‚</p><p>æ¯ä¸ªé—®é¢˜ï¼Œæˆ‘éƒ½é™„ä¸Šäº†ç•™è¨€åŒºæé—®çš„æˆªå±ã€‚å¦‚æœä½ éœ€è¦å›é¡¾å†…å®¹åŸæ–‡ï¼Œå¯ä»¥æ‰«ææ¯ä¸ªé—®é¢˜å³ä¸‹æ–¹çš„äºŒç»´ç æŸ¥çœ‹ã€‚</p><h2>é—®é¢˜ 1ï¼šç½‘ç»œæ”¶å‘è¿‡ç¨‹ä¸­ç¼“å†²åŒºçš„ä½ç½®</h2><p><img src=\"https://static001.geekbang.org/resource/image/49/28/49649598767b9ef537169558ee6be128.png?wh=900*2514\" alt=\"\"></p><p>ç¬¬ä¸€ç‚¹ï¼Œæ˜¯ç½‘ç»œæ”¶å‘è¿‡ç¨‹ä¸­ï¼Œæ”¶å‘é˜Ÿåˆ—å’Œç¼“å†²åŒºä½ç½®çš„ç–‘é—®ã€‚</p><p>åœ¨ <a href=\"https://time.geekbang.org/column/article/80898\">å…³äº Linux ç½‘ç»œï¼Œä½ å¿…é¡»è¦çŸ¥é“è¿™äº›</a> ä¸­ï¼Œæˆ‘æ›¾ä»‹ç»è¿‡ Linux ç½‘ç»œçš„æ”¶å‘æµç¨‹ã€‚è¿™ä¸ªæµç¨‹æ¶‰åŠåˆ°äº†å¤šä¸ªé˜Ÿåˆ—å’Œç¼“å†²åŒºï¼ŒåŒ…æ‹¬ï¼š</p><ul>\n<li>\n<p>ç½‘å¡æ”¶å‘ç½‘ç»œåŒ…æ—¶ï¼Œé€šè¿‡ DMA æ–¹å¼äº¤äº’çš„<strong>ç¯å½¢ç¼“å†²åŒº</strong>ï¼›</p>\n</li>\n<li>\n<p>ç½‘å¡ä¸­æ–­å¤„ç†ç¨‹åºä¸ºç½‘ç»œå¸§åˆ†é…çš„ï¼Œå†…æ ¸æ•°æ®ç»“æ„ <strong>sk_buff ç¼“å†²åŒº</strong>ï¼›</p>\n</li>\n<li>\n<p>åº”ç”¨ç¨‹åºé€šè¿‡å¥—æ¥å­—æ¥å£ï¼Œä¸ç½‘ç»œåè®®æ ˆäº¤äº’æ—¶çš„<strong>å¥—æ¥å­—ç¼“å†²åŒºã€‚</strong></p>\n</li>\n</ul><p>ä¸è¿‡ç›¸åº”çš„ï¼Œå°±ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œè¿™äº›ç¼“å†²åŒºçš„ä½ç½®åœ¨å“ªå„¿ï¼Ÿæ˜¯åœ¨ç½‘å¡ç¡¬ä»¶ä¸­ï¼Œè¿˜æ˜¯åœ¨å†…å­˜ä¸­ï¼Ÿè¿™ä¸ªé—®é¢˜å…¶å®ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œå°±å¾ˆå®¹æ˜“æ˜ç™½â€”â€”è¿™äº›ç¼“å†²åŒºéƒ½å¤„äºå†…æ ¸ç®¡ç†çš„å†…å­˜ä¸­ã€‚</p><!-- [[[read_end]]] --><p>å…¶ä¸­ï¼Œ<strong>ç¯å½¢ç¼“å†²åŒº</strong>ï¼Œç”±äºéœ€è¦ DMA ä¸ç½‘å¡äº¤äº’ï¼Œç†åº”å±äºç½‘å¡è®¾å¤‡é©±åŠ¨çš„èŒƒå›´ã€‚</p><p><strong>sk_buff ç¼“å†²åŒº</strong>ï¼Œæ˜¯ä¸€ä¸ªç»´æŠ¤ç½‘ç»œå¸§ç»“æ„çš„åŒå‘é“¾è¡¨ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç½‘ç»œå¸§ï¼ˆPacketï¼‰ã€‚è™½ç„¶ TCP/IP åè®®æ ˆåˆ†äº†å¥½å‡ å±‚ï¼Œä½†ä¸Šä¸‹ä¸åŒå±‚ä¹‹é—´çš„ä¼ é€’ï¼Œå®é™…ä¸Šåªéœ€è¦æ“ä½œè¿™ä¸ªæ•°æ®ç»“æ„ä¸­çš„æŒ‡é’ˆï¼Œè€Œæ— éœ€è¿›è¡Œæ•°æ®å¤åˆ¶ã€‚</p><p><strong>å¥—æ¥å­—ç¼“å†²åŒº</strong>ï¼Œåˆ™å…è®¸åº”ç”¨ç¨‹åºï¼Œç»™æ¯ä¸ªå¥—æ¥å­—é…ç½®ä¸åŒå¤§å°çš„æ¥æ”¶æˆ–å‘é€ç¼“å†²åŒºã€‚åº”ç”¨ç¨‹åºå‘é€æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯å°†æ•°æ®å†™å…¥ç¼“å†²åŒºï¼›è€Œæ¥æ”¶æ•°æ®ï¼Œå…¶å®å°±æ˜¯ä»ç¼“å†²åŒºä¸­è¯»å–ã€‚è‡³äºç¼“å†²åŒºä¸­æ•°æ®çš„è¿›ä¸€æ­¥å¤„ç†ï¼Œåˆ™ç”±ä¼ è¾“å±‚çš„ TCP æˆ– UDP åè®®æ¥å®Œæˆã€‚</p><p>å…¶æ¬¡ï¼Œè¿™äº›ç¼“å†²åŒºï¼Œè·Ÿå‰é¢å†…å­˜éƒ¨åˆ†è®²åˆ°çš„ Buffer å’Œ Cache æœ‰ä»€ä¹ˆå…³è”å—ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜å…¶å®ä¹Ÿä¸éš¾å›ç­”ã€‚æˆ‘åœ¨å†…å­˜æ¨¡å—æ›¾æåˆ°è¿‡ï¼Œå†…å­˜ä¸­æåˆ°çš„ Buffer ï¼Œéƒ½è·Ÿå—è®¾å¤‡ç›´æ¥ç›¸å…³ï¼›è€Œå…¶ä»–çš„éƒ½æ˜¯ Cacheã€‚</p><p>å®é™…ä¸Šï¼Œsk_buffã€å¥—æ¥å­—ç¼“å†²ã€è¿æ¥è·Ÿè¸ªç­‰ï¼Œéƒ½é€šè¿‡ slab åˆ†é…å™¨æ¥ç®¡ç†ã€‚ä½ å¯ä»¥ç›´æ¥é€šè¿‡ /proc/slabinfoï¼Œæ¥æŸ¥çœ‹å®ƒä»¬å ç”¨çš„å†…å­˜å¤§å°ã€‚</p><h2>é—®é¢˜ 2ï¼šå†…æ ¸åè®®æ ˆï¼Œæ˜¯é€šè¿‡ä¸€ä¸ªå†…æ ¸çº¿ç¨‹çš„æ–¹å¼æ¥è¿è¡Œçš„å—</h2><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå†…æ ¸åè®®æ ˆçš„è¿è¡Œï¼Œæ˜¯æŒ‰ç…§ä¸€ä¸ªå†…æ ¸çº¿ç¨‹çš„æ–¹å¼å—ï¼Ÿåœ¨å†…æ ¸ä¸­ï¼Œåˆæ˜¯å¦‚ä½•æ‰§è¡Œç½‘ç»œåè®®æ ˆçš„å‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/9b/1c/9bea298bcc349e80f46c1a406472381c.png?wh=900*1050\" alt=\"\"></p><p>è¯´åˆ°ç½‘ç»œæ”¶å‘ï¼Œåœ¨ä¸­æ–­å¤„ç†æ–‡ç« ä¸­æˆ‘æ›¾è®²è¿‡ï¼Œå…¶ä¸­çš„è½¯ä¸­æ–­å¤„ç†ï¼Œå°±æœ‰ä¸“é—¨çš„å†…æ ¸çº¿ç¨‹ ksoftirqdã€‚æ¯ä¸ª CPU éƒ½ä¼šç»‘å®šä¸€ä¸ª ksoftirqd å†…æ ¸çº¿ç¨‹ï¼Œæ¯”å¦‚ï¼Œ 2 ä¸ªCPU æ—¶ï¼Œå°±ä¼šæœ‰ ksoftirqd/0 å’Œ ksoftirqd/1 è¿™ä¸¤ä¸ªå†…æ ¸çº¿ç¨‹ã€‚</p><p>ä¸è¿‡è¦æ³¨æ„ï¼Œå¹¶éæ‰€æœ‰ç½‘ç»œåŠŸèƒ½ï¼Œéƒ½åœ¨è½¯ä¸­æ–­å†…æ ¸çº¿ç¨‹ä¸­å¤„ç†ã€‚å†…æ ¸ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–æœºåˆ¶ï¼ˆæ¯”å¦‚ç¡¬ä¸­æ–­ã€kworkerã€slab ç­‰ï¼‰ï¼Œè¿™äº›æœºåˆ¶ä¸€èµ·ååŒå·¥ä½œï¼Œæ‰èƒ½ä¿è¯æ•´ä¸ªç½‘ç»œåè®®æ ˆçš„æ­£å¸¸è¿è¡Œã€‚</p><p>å…³äºå†…æ ¸ä¸­ç½‘ç»œåè®®æ ˆçš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•åŠ¨æ€è·Ÿè¸ªå†…æ ¸çš„æ‰§è¡Œæµç¨‹ï¼Œä¸“æ åç»­è¿˜æœ‰ä¸“é—¨çš„æ–‡ç« æ¥è®²ã€‚å¦‚æœå¯¹è¿™éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥å…ˆç”¨æˆ‘ä»¬æåˆ°è¿‡çš„ perfã€systemtapã€bcc-tools ç­‰ï¼Œè¯•ç€æ¥åˆ†æä¸€ä¸‹ã€‚</p><h2>é—®é¢˜ 3ï¼šæœ€å¤§è¿æ¥æ•°æ˜¯ä¸æ˜¯å—é™äº 65535 ä¸ªç«¯å£</h2><p><img src=\"https://static001.geekbang.org/resource/image/50/8c/504ddb710169cb247b349d0d8a32818c.png?wh=900*1050\" alt=\"\"><img src=\"https://static001.geekbang.org/resource/image/0a/70/0a5cb5d25a4b09c5f46ca8941e9fca70.png?wh=900*1314\" alt=\"\"></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ— è®º TCP è¿˜æ˜¯ UDPï¼Œç«¯å£å·éƒ½åªå  16 ä½ï¼Œä¹Ÿå°±è¯´å…¶æœ€å¤§å€¼ä¹Ÿåªæœ‰ 65535ã€‚é‚£æ˜¯ä¸æ˜¯è¯´ï¼Œå¦‚æœä½¿ç”¨ TCP åè®®ï¼Œåœ¨å•å°æœºå™¨ã€å•ä¸ª IP åœ°å€æ—¶ï¼Œå¹¶å‘è¿æ¥æ•°æœ€å¤§ä¹Ÿåªæœ‰ 65535 å‘¢ï¼Ÿ</p><p>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆä½ è¦çŸ¥é“ï¼ŒLinux åè®®æ ˆï¼Œé€šè¿‡äº”å…ƒç»„æ¥æ ‡å¿—ä¸€ä¸ªè¿æ¥ï¼ˆå³åè®®ï¼ŒæºIPã€æºç«¯å£ã€ç›®çš„IPã€ç›®çš„ç«¯å£)ã€‚</p><p>æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å°±æœ‰äº†æ€è·¯ã€‚æˆ‘ä»¬åº”è¯¥åˆ†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ï¼Œè¿™ä¸¤ç§åœºæ™¯æ¥åˆ†æã€‚</p><p>å¯¹å®¢æˆ·ç«¯æ¥è¯´ï¼Œæ¯æ¬¡å‘èµ· TCP è¿æ¥è¯·æ±‚æ—¶ï¼Œéƒ½éœ€è¦åˆ†é…ä¸€ä¸ªç©ºé—²çš„æœ¬åœ°ç«¯å£ï¼Œå»è¿æ¥è¿œç«¯çš„æœåŠ¡å™¨ã€‚ç”±äºè¿™ä¸ªæœ¬åœ°ç«¯å£æ˜¯ç‹¬å çš„ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æœ€å¤šåªèƒ½å‘èµ· 65535 ä¸ªè¿æ¥ã€‚</p><p>å¯¹æœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œå…¶é€šå¸¸ç›‘å¬åœ¨å›ºå®šç«¯å£ä¸Šï¼ˆæ¯”å¦‚ 80 ç«¯å£ï¼‰ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚æ ¹æ®äº”å…ƒç»„ç»“æ„ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå®¢æˆ·ç«¯çš„IPå’Œç«¯å£éƒ½æ˜¯å¯å˜çš„ã€‚å¦‚æœä¸è€ƒè™‘ IP åœ°å€åˆ†ç±»ä»¥åŠèµ„æºé™åˆ¶ï¼ŒæœåŠ¡å™¨ç«¯çš„ç†è®ºæœ€å¤§è¿æ¥æ•°ï¼Œå¯ä»¥è¾¾åˆ° 2 çš„ 48 æ¬¡æ–¹ï¼ˆIP ä¸º 32 ä½ï¼Œç«¯å£å·ä¸º 16 ä½ï¼‰ï¼Œè¿œå¤§äº65535ã€‚</p><p>æ‰€ä»¥ï¼Œç»¼åˆæ¥çœ‹ï¼Œå®¢æˆ·ç«¯æœ€å¤§æ”¯æŒ65535ä¸ªè¿æ¥ï¼Œè€ŒæœåŠ¡å™¨ç«¯å¯æ”¯æŒçš„è¿æ¥æ•°æ˜¯æµ·é‡çš„ã€‚å½“ç„¶ï¼Œç”±äº Linux åè®®æ ˆæœ¬èº«çš„æ€§èƒ½ï¼Œä»¥åŠå„ç§ç‰©ç†å’Œè½¯ä»¶çš„èµ„æºé™åˆ¶ç­‰ï¼Œè¿™ä¹ˆå¤§çš„è¿æ¥æ•°ï¼Œè¿˜æ˜¯è¿œè¿œè¾¾ä¸åˆ°çš„ï¼ˆå®é™…ä¸Šï¼ŒC10M å°±å·²ç»å¾ˆéš¾äº†ï¼‰ã€‚</p><h2>é—®é¢˜ 4ï¼š â€œå¦‚ä½•ä¼˜åŒ– NAT æ€§èƒ½â€è¯¾åæ€è€ƒ</h2><p><img src=\"https://static001.geekbang.org/resource/image/c6/a0/c623453e2e054d2f4407ab1e4a87f5a0.png?wh=1125*1981\" alt=\"\"></p><p>åœ¨ <a href=\"https://time.geekbang.org/column/article/83189\">å¦‚ä½•ä¼˜åŒ– NAT æ€§èƒ½</a> çš„æœ€åï¼Œ æˆ‘ç»™ä½ ç•™äº†ä¸¤ä¸ªæ€è€ƒé¢˜ã€‚</p><p>MASQUERADE æ˜¯æœ€å¸¸ç”¨çš„ SNAT è§„åˆ™ä¹‹ä¸€ï¼Œé€šå¸¸ç”¨æ¥ä¸ºå¤šä¸ªå†…ç½‘ IP åœ°å€ï¼Œæä¾›å…±äº«çš„å‡ºå£ IPã€‚å‡è®¾ç°åœ¨æœ‰ä¸€å° Linux æœåŠ¡å™¨ï¼Œç”¨äº† MASQUERADE æ–¹å¼ï¼Œä¸ºå†…ç½‘æ‰€æœ‰ IP æä¾›å‡ºå£è®¿é—®åŠŸèƒ½ã€‚é‚£ä¹ˆï¼Œ</p><ul>\n<li>\n<p>å½“å¤šä¸ªå†…ç½‘ IP åœ°å€çš„ç«¯å£å·ç›¸åŒæ—¶ï¼ŒMASQUERADE è¿˜èƒ½æ­£å¸¸å·¥ä½œå—ï¼Ÿ</p>\n</li>\n<li>\n<p>å†…ç½‘ IP åœ°å€æ•°é‡æˆ–è€…è¯·æ±‚æ•°æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œè¿™ç§ä½¿ç”¨æ–¹å¼æœ‰æ²¡æœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜å‘¢ï¼Ÿ</p>\n</li>\n</ul><p>å¯¹äºè¿™ä¸¤ä¸ªæ€è€ƒé¢˜ï¼Œæˆ‘æ¥ä¹Ÿã€ninuxer ç­‰åŒå­¦ï¼Œéƒ½ç»™å‡ºäº†ä¸é”™çš„ç­”æ¡ˆï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/24/52/245ba322ff2975e56db18206f0797d52.png?wh=900*2247\" alt=\"\"><img src=\"https://static001.geekbang.org/resource/image/f4/55/f41d8ad99120f22a7967e3afffe97555.png?wh=900*1050\" alt=\"\"></p><p>å…ˆçœ‹ç¬¬ä¸€ç‚¹ï¼Œå½“å¤šä¸ªå†…ç½‘ IP åœ°å€çš„ç«¯å£å·ç›¸åŒæ—¶ï¼ŒMASQUERADE å½“ç„¶ä»å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä¸è¿‡ï¼Œä½ è‚¯å®šä¹Ÿå¬è¯´è¿‡ï¼Œé…ç½® MASQUERADE åï¼Œéœ€è¦å„ä¸ªåº”ç”¨ç¨‹åºå»æ‰‹åŠ¨é…ç½®ä¿®æ”¹ç«¯å£å·ã€‚</p><p>å®é™…ä¸Šï¼ŒMASQUERADE é€šè¿‡ conntrack æœºåˆ¶ï¼Œè®°å½•äº†æ¯ä¸ªè¿æ¥çš„ä¿¡æ¯ã€‚è€Œåœ¨åˆšæ‰ç¬¬ä¸‰ä¸ªé—®é¢˜ ä¸­ï¼Œæˆ‘æåˆ°è¿‡ï¼Œæ ‡å¿—ä¸€ä¸ªè¿æ¥éœ€è¦äº”å…ƒç»„ï¼Œåªè¦è¿™äº”å…ƒç»„ä¸æ˜¯åŒæ—¶ç›¸åŒï¼Œç½‘ç»œè¿æ¥å°±å¯ä»¥æ­£å¸¸è¿›è¡Œã€‚</p><p>å†çœ‹ç¬¬äºŒç‚¹ï¼Œåœ¨å†…ç½‘ IP åœ°å€å’Œè¿æ¥æ•°æ¯”è¾ƒå°æ—¶ï¼Œè¿™ç§æ–¹å¼çš„é—®é¢˜ä¸å¤§ã€‚ä½†åœ¨ IP åœ°å€æˆ–å¹¶å‘è¿æ¥æ•°ç‰¹åˆ«å¤§çš„æƒ…å†µä¸‹ï¼Œå°±å¯èƒ½ç¢°åˆ°å„ç§å„æ ·çš„èµ„æºé™åˆ¶ã€‚</p><p>æ¯”å¦‚ï¼ŒMASQUERADE æ—¢ç„¶æŠŠå†…éƒ¨å¤šä¸ª IP ï¼Œè½¬æ¢æˆäº†ç›¸åŒçš„å¤–ç½‘ IPï¼ˆå³ SNATï¼‰ï¼Œé‚£ä¹ˆï¼Œä¸ºäº†ç¡®ä¿å‘é€å‡ºå»çš„æºç«¯å£ä¸é‡å¤ï¼ŒåŸæ¥ç½‘ç»œåŒ…çš„æºç«¯å£ä¹Ÿå¯èƒ½ä¼šè¢«é‡æ–°åˆ†é…ã€‚è¿™æ ·çš„è¯ï¼Œè½¬æ¢åçš„å¤–ç½‘ IP çš„ç«¯å£å·ï¼Œå°±æˆäº†é™åˆ¶è¿æ¥æ•°çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿æ¥è·Ÿè¸ªã€MASQUERADEæœºå™¨çš„ç½‘ç»œå¸¦å®½ç­‰ï¼Œéƒ½æ˜¯æ½œåœ¨çš„ç“¶é¢ˆï¼Œå¹¶ä¸”è¿˜å­˜åœ¨å•ç‚¹çš„é—®é¢˜ã€‚è¿™äº›æƒ…å†µï¼Œåœ¨æˆ‘ä»¬å®é™…ä½¿ç”¨ä¸­éƒ½éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚</p><p>ä»Šå¤©ä¸»è¦å›ç­”è¿™äº›é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ¬¢è¿ä½ ç»§ç»­åœ¨ç•™è¨€åŒºå†™ä¸‹ç–‘é—®å’Œæ„Ÿæƒ³ï¼Œæˆ‘ä¼šæŒç»­ä¸æ–­åœ°è§£ç­”ã€‚å¸Œæœ›å€ŸåŠ©æ¯ä¸€æ¬¡çš„ç­”ç–‘ï¼Œå¯ä»¥å’Œä½ ä¸€èµ·ï¼ŒæŠŠæ–‡ç« çŸ¥è¯†å†…åŒ–ä¸ºä½ çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸ä»…åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œä¹Ÿè¦åœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","comments":[{"had_liked":false,"id":76222,"user_name":"è®°å¿†","can_delete":false,"product_type":"c1","uid":1316682,"ip_address":"","ucode":"503DBE662BF544","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/4a/d8fd5563.jpg","comment_is_top":false,"comment_ctime":1552553020,"is_pvip":false,"replies":[{"id":"28166","content":"è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œå…·ä½“åˆ°æ•°æ®ä¸Šï¼Œå†…æ ¸åè®®æ ˆéƒ½æ˜¯æ“ä½œæŒ‡é’ˆï¼Œå¹¶ä¸ä¼šåœ¨ä¸åŒåè®®å±‚ä¹‹é—´å¤åˆ¶æ•°æ®","user_name":"ä½œè€…å›å¤","comment_id":76222,"uid":"1001282","ip_address":"","utype":1,"ctime":1552904524,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":6,"race_medal":0,"score":"70272029756","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¦‚æœsk_buff ç¼“å†²åŒº ï¼ˆsocket bufferï¼‰ä¸æ˜¯å¥—æ¥å­—ç¼“å†²å™¨åŒº,é‚£æ˜¯ä¸æ˜¯è¿˜è¦è¿›è¡Œä¸€æ¬¡æ•°æ®çš„copyåˆ°å¥—æ¥å­—ç¼“å†²åŒºï¼Œå†é€šçŸ¥åº”ç”¨ç¨‹åºæœ‰æŸä¸ªå¥—æ¥å­—æ•°æ®å¯è¯»äº†ï¼Ÿé‚£ä¸€å¸§æ•°æ®åˆ°æ¥ï¼Œéœ€è¦æ”¶åŒ…é˜Ÿåˆ—--&gt;sk_buff--&gt;å¥—æ¥å­—ç¼“å†²åŒº--&gt;åº”ç”¨ç¨‹åºç©ºé—´å†…å­˜é‡Œï¼Œæ‹·è´äº†3æ¬¡å‘¢ï¼Ÿ","like_count":16,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443222,"discussion_content":"è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œå…·ä½“åˆ°æ•°æ®ä¸Šï¼Œå†…æ ¸åè®®æ ˆéƒ½æ˜¯æ“ä½œæŒ‡é’ˆï¼Œå¹¶ä¸ä¼šåœ¨ä¸åŒåè®®å±‚ä¹‹é—´å¤åˆ¶æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552904524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1636551,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f8/c7/d0c0a613.jpg","nickname":"å¤§åœ°","note":"","ucode":"62D9098C0BCE13","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278668,"discussion_content":"è¿™è¿™ä¸ªè¿˜æ˜¯æ²¡æœ‰å›ç­”åˆ°åº•æ‹·è´äº†å‡ æ¬¡ï¼Œè¯·é—®æœ‰æœ€ç»ˆçš„ç»“è®ºä¹ˆï¼Ÿ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1591205009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1188710,"avatar":"https://static001.geekbang.org/account/avatar/00/12/23/66/413c0bb5.jpg","nickname":"LDxy","note":"","ucode":"956432CE7B7761","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1636551,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f8/c7/d0c0a613.jpg","nickname":"å¤§åœ°","note":"","ucode":"62D9098C0BCE13","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":304444,"discussion_content":"ç»è¿‡å‡ ä¸ªç¼“å†²åŒºå°±è¦æ‹·è´å‡ æ¬¡ï¼Œè¿™å¾ˆæ˜æ˜¾äº†ã€‚å¦åˆ™æ•°æ®æ€ä¹ˆä»ä¸€ä¸ªç¼“å†²åŒºåˆ°å¦ä¸€ä¸ªç¼“å†²åŒºå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599571976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278668,"ip_address":""},"score":304444,"extra":""},{"author":{"id":1009527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","nickname":"å‰‘è¡£æ¸…é£","note":"","ucode":"470CD81F6612F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1636551,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f8/c7/d0c0a613.jpg","nickname":"å¤§åœ°","note":"","ucode":"62D9098C0BCE13","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":347075,"discussion_content":"å‚è€ƒä¸‹è¿™ç¯‡æ–‡ç«  https://mp.weixin.qq.com/s/GoYDsfy9m0wRoXi_NCfCmg","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1612147380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278668,"ip_address":""},"score":347075,"extra":""},{"author":{"id":1105816,"avatar":"https://static001.geekbang.org/account/avatar/00/10/df/98/670d96c0.jpg","nickname":"æµå¹´ä¼¼æ°´","note":"","ucode":"048D320AFB576A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1009527,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","nickname":"å‰‘è¡£æ¸…é£","note":"","ucode":"470CD81F6612F4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586762,"discussion_content":"å¥½æ–‡ç« ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662479137,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":347075,"ip_address":"æ±Ÿè‹"},"score":586762,"extra":""}]},{"author":{"id":1333523,"avatar":"https://static001.geekbang.org/account/avatar/00/14/59/13/ff6f3ed5.jpg","nickname":"ç‹ç« æ¶›","note":"","ucode":"6EC55EC116A58D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552160,"discussion_content":"æ”¶åŒ…é˜Ÿåˆ—--&gt;sk_buff è¿™ä¸€å±‚éƒ½æ˜¯åœ¨å†…æ ¸é‡Œï¼Œå¹¶ä¸ä¼šæ‹·è´ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645331649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73149,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1551832454,"is_pvip":false,"replies":[{"id":"26748","content":"å—¯ï¼Œè°¢è°¢åˆ†äº«ã€‚ä¸è¿‡çº¿ä¸Šç¯å¢ƒä¹Ÿä¸æ¨èä¸€ç›´è¿è¡Œåœ¨è¾¾åˆ°èµ„æºæé™çš„åœºæ™¯ï¼Œæœ€å¥½æ˜¯é¢„ç•™ä¸€äº›èµ„æºä»¥ä¾¿åº”å¯¹å¼‚å¸¸æƒ…å†µ","user_name":"ä½œè€…å›å¤","comment_id":73149,"uid":"1001282","ip_address":"","utype":1,"ctime":1551883927,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"27321636230","product_id":100020901,"comment_content":"[D45æ‰“å¡]<br>å››å¤§æ¨¡å—å­¦å®Œäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯èä¼šè´¯é€šäº†ã€‚ğŸ˜„<br><br>ä»¥å‰ä¹ŸçŸ¥é“socketè¿æ¥æ˜¯é€šè¿‡äº”å…ƒç»„å”¯ä¸€ç¡®å®šçš„ï¼Œä½†å®é™…å†™æœåŠ¡ç«¯ç¨‹åºæ—¶ï¼Œè¿˜æ˜¯ä¼šæ ¹æ®ç»éªŒé™å®šåˆ°65530ã€‚<br>ç°åœ¨æƒ³æ¥ï¼Œå½“æ—¶è¿˜æ˜¯ç†è§£çš„ä¸å¤Ÿé€å½»ã€‚<br>è¿™ä¸ªç»éªŒå€¼å½“æ—¶æ˜¯æ ¹æ®å‹åŠ›æµ‹è¯•å¾—æ¥çš„ï¼Œå½“æ—¶åªç”¨äº†ä¸€å°æœºå™¨å»æµ‹è¿æ¥æ•°ã€‚ğŸ¤¦â€â™‚ï¸å¦‚æœç”¨å¤šä¸ªæœºå™¨æµ‹å¯èƒ½å¥½ç‚¹ã€‚<br>å¦ä¸€ä¸ªæ˜¯æœåŠ¡å™¨ç«¯å•è¿›ç¨‹åŒæ—¶æ‰“å¼€çš„æ–‡ä»¶æ•°é™åˆ¶ï¼Œå¹³å¸¸é™åˆ¶çš„ä¹Ÿæ˜¯65535ï¼ˆå¯ä»¥ç»§ç»­è°ƒå¤§ï¼‰ã€‚ä¸€ä¸ªè¿›ç¨‹é»˜è®¤è¿˜ä¼šæ‰“å¼€2ä¸ªæ–‡ä»¶ï¼Œstdout stderrï¼Œæ‰€ä»¥éœ€è¦å†å‡2ï¼Œå¦‚æœæœ‰ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œè¿˜éœ€è¦å†å‡1ã€‚<br>æœ‰ä¸€æ¬¡åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒåŒæ—¶è¿æ¥æ•°é™åˆ¶çš„æ˜¯65535ï¼Œç»“æœåˆ°65533ä¸ªè¿æ¥æ—¶ï¼ŒæŠŠç›‘å¬çš„ç«¯å£ç»™å…³é—­äº†ã€‚ï¼ˆå¯èƒ½æ˜¯æ‰€ç”¨æ¡†æ¶å¯¼è‡´çš„ï¼‰è™½ç„¶å·²æœ‰çš„è¿æ¥æœªå—å½±å“ï¼Œä½†ä¹‹åå°±æ— æ³•å†æ¥å—æ–°è¿æ¥äº†ã€‚","like_count":7,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441936,"discussion_content":"å—¯ï¼Œè°¢è°¢åˆ†äº«ã€‚ä¸è¿‡çº¿ä¸Šç¯å¢ƒä¹Ÿä¸æ¨èä¸€ç›´è¿è¡Œåœ¨è¾¾åˆ°èµ„æºæé™çš„åœºæ™¯ï¼Œæœ€å¥½æ˜¯é¢„ç•™ä¸€äº›èµ„æºä»¥ä¾¿åº”å¯¹å¼‚å¸¸æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551883927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90120,"user_name":"å‰‘è¡£æ¸…é£","can_delete":false,"product_type":"c1","uid":1009527,"ip_address":"","ucode":"470CD81F6612F4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","comment_is_top":false,"comment_ctime":1556419706,"is_pvip":false,"replies":[{"id":"32536","content":"ä¸ºå®¢æˆ·ç«¯åˆ†é…ä¸åŒçš„ç«¯å£å»è¿æ¥æœåŠ¡ç«¯ï¼Œè¯·æ±‚é‡å¤§çš„æ—¶å€™è¿˜éœ€è¦å¤šæœºæˆ–å¤šIPå¢å¤§è¯·æ±‚æ•°","user_name":"ä½œè€…å›å¤","comment_id":90120,"uid":"1001282","ip_address":"","utype":1,"ctime":1556635251,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"18736288890","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¯¹äºé—®é¢˜3æˆ‘æœ‰ä¸ªç–‘é—®<br><br>â€œå¯¹å®¢æˆ·ç«¯æ¥è¯´ï¼Œæ¯æ¬¡å‘èµ· TCP è¿æ¥è¯·æ±‚æ—¶ï¼Œéƒ½éœ€è¦åˆ†é…ä¸€ä¸ªç©ºé—²çš„æœ¬åœ°ç«¯å£ï¼Œå»è¿æ¥è¿œç«¯çš„æœåŠ¡å™¨ã€‚ç”±äºè¿™ä¸ªæœ¬åœ°ç«¯å£æ˜¯ç‹¬å çš„ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æœ€å¤šåªèƒ½å‘èµ· 65535 ä¸ªè¿æ¥ã€‚â€<br><br>é‚£åƒ ab è¿™æ ·çš„å‹æµ‹å·¥å…·ï¼Œæ˜¯å¦‚ä½•åšåˆ°å¹¶å‘å¯¹æœåŠ¡ç«¯æ¥å£å‹æµ‹çš„ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448396,"discussion_content":"ä¸ºå®¢æˆ·ç«¯åˆ†é…ä¸åŒçš„ç«¯å£å»è¿æ¥æœåŠ¡ç«¯ï¼Œè¯·æ±‚é‡å¤§çš„æ—¶å€™è¿˜éœ€è¦å¤šæœºæˆ–å¤šIPå¢å¤§è¯·æ±‚æ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556635251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254656,"avatar":"https://static001.geekbang.org/account/avatar/00/13/25/00/3afbab43.jpg","nickname":"88591","note":"","ucode":"04CE3E46455185","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52553,"discussion_content":"ä¸€å°ç‰©ç†æœºï¼Œå¯ä»¥å¢åŠ  ip åˆ«åã€‚æ¥æ‰©å……5å…ƒç»„çš„ä¸ªæ•°","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1574066382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2116245,"avatar":"https://static001.geekbang.org/account/avatar/00/20/4a/95/4f6f93c3.jpg","nickname":"çŸ¥è¡Œåˆä¸€","note":"","ucode":"A53A002DF3A652","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":364127,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617369330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73198,"user_name":"åˆ’æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1551838224,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14436740112","product_id":100020901,"comment_content":"æœ€è¿‘åœ¨å¹¿æ³›æ”¶é›†èµ„æ–™å­¦ä¹ è€å¸ˆè®²çš„C10Kåˆ°C1000Kçš„é—®é¢˜ï¼Œæ‰“å¡æ€»ç»“ã€‚","like_count":3},{"had_liked":false,"id":220872,"user_name":"å‘å—","can_delete":false,"product_type":"c1","uid":2007213,"ip_address":"","ucode":"F4D2AB9D5DDFD9","user_header":"","comment_is_top":false,"comment_ctime":1590332181,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10180266773","product_id":100020901,"comment_content":"åˆæ˜¯æ»¡æ»¡çš„å¹²è´§ï¼Œä¸“æ çš„å­¦ä¹ æœ‰ä¸€åŠçš„ç²¾ååœ¨è¯„è®ºåŒºå•Š","like_count":2},{"had_liked":false,"id":73140,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1551831182,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10141765774","product_id":100020901,"comment_content":"æ‰“å¡day47<br>å¾ˆé«˜å…´ä¸€ç›´æ²¡æ‰é˜Ÿï¼Œç½‘ç»œä¸€ç›´æ˜¯æˆ‘çš„çŸ­æ¿ï¼Œå¾—è¡¥è¡¥","like_count":2},{"had_liked":false,"id":78408,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1553141884,"is_pvip":false,"replies":[{"id":"28761","content":"å¯ä»¥ç®€å•è¿™ä¹ˆç†è§£ï¼Œä½†å®é™…ä¸Šä¹Ÿä¸å‡†ç¡®ï¼Œå¯¹åŒä¸€ä¸ªç½‘ç»œæŠ¥æ–‡æ¥è¯´ï¼Œä¸åŒåè®®æ ˆå±‚å¤„ç†çš„æ˜¯åŒä¸€ä¸ªpktä¸åŒä½ç½®çš„æ•°æ®ï¼ˆåŒä¸€ä¸ªstructå†…éƒ¨ï¼‰ï¼Œè€Œä¸æ˜¯é“¾è¡¨ä¸­çš„ä¸åŒitemã€‚çœŸè¦ç†è§£çš„è¯ï¼Œè¿˜æ˜¯æ¨èå»çœ‹ä¸€ä¸‹å†…æ ¸æºç ","user_name":"ä½œè€…å›å¤","comment_id":78408,"uid":"1001282","ip_address":"","utype":1,"ctime":1553318314,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5848109180","product_id":100020901,"comment_content":"@è®°å¿†çš„é—®é¢˜â€œè€å¸ˆä½ å¥½ï¼Œå¦‚æœsk_buff ç¼“å†²åŒº ï¼ˆsocket bufferï¼‰ä¸æ˜¯å¥—æ¥å­—ç¼“å†²å™¨åŒº,é‚£æ˜¯ä¸æ˜¯è¿˜è¦è¿›è¡Œä¸€æ¬¡æ•°æ®çš„copyåˆ°å¥—æ¥å­—ç¼“å†²åŒºï¼Œå†é€šçŸ¥åº”ç”¨ç¨‹åºæœ‰æŸä¸ªå¥—æ¥å­—æ•°æ®å¯è¯»äº†ï¼Ÿé‚£ä¸€å¸§æ•°æ®åˆ°æ¥ï¼Œéœ€è¦æ”¶åŒ…é˜Ÿåˆ—--&gt;sk_buff--&gt;å¥—æ¥å­—ç¼“å†²åŒº--&gt;åº”ç”¨ç¨‹åºç©ºé—´å†…å­˜é‡Œï¼Œæ‹·è´äº†3æ¬¡å‘¢ï¼Ÿâ€<br><br>è€å¸ˆçš„å›å¤æ˜¯â€œè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œå…·ä½“åˆ°æ•°æ®ä¸Šï¼Œå†…æ ¸åè®®æ ˆéƒ½æ˜¯æ“ä½œæŒ‡é’ˆï¼Œå¹¶ä¸ä¼šåœ¨ä¸åŒåè®®å±‚ä¹‹é—´å¤åˆ¶æ•°æ®â€ã€‚<br><br>æˆ‘çš„ç†è§£æ˜¯ï¼Œæ”¶åŒ…é˜Ÿåˆ—ã€sk_buffã€å¥—æ¥å­—ç¼“å†²åŒºã€åº”ç”¨ç¨‹åºç©ºé—´å†…å­˜ï¼Œéƒ½æ˜¯é“¾æ¥è¡¨ç»“æ„ï¼Œæ”¶ä¿é˜Ÿåˆ—-&gt;sk_buffçš„è¿‡ç¨‹ï¼Œæ˜¯sk_buffçš„æŒ‡é’ˆæŒ‡å‘æ”¶ä¿é˜Ÿåˆ—çš„é“¾å¤´ï¼Œå†é‡æ–°ç»™æ”¶åŒ…é˜Ÿåˆ—åˆ†é…ç©ºé“¾è¡¨ï¼Œå†…å­˜ä¸Šåªæ˜¯å•çº¯çš„æŒ‡é’ˆç§»åŠ¨ï¼Œå¹¶ä¸æ¶‰åŠæ•°æ®è¿ç§»ã€‚<br><br>ä¸çŸ¥é“ç†è§£å¯¹ä¸å¯¹ï¼Œè¿˜è¯·è€å¸ˆæŒ‡æ­£ã€‚","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444083,"discussion_content":"å¯ä»¥ç®€å•è¿™ä¹ˆç†è§£ï¼Œä½†å®é™…ä¸Šä¹Ÿä¸å‡†ç¡®ï¼Œå¯¹åŒä¸€ä¸ªç½‘ç»œæŠ¥æ–‡æ¥è¯´ï¼Œä¸åŒåè®®æ ˆå±‚å¤„ç†çš„æ˜¯åŒä¸€ä¸ªpktä¸åŒä½ç½®çš„æ•°æ®ï¼ˆåŒä¸€ä¸ªstructå†…éƒ¨ï¼‰ï¼Œè€Œä¸æ˜¯é“¾è¡¨ä¸­çš„ä¸åŒitemã€‚çœŸè¦ç†è§£çš„è¯ï¼Œè¿˜æ˜¯æ¨èå»çœ‹ä¸€ä¸‹å†…æ ¸æºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553318314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73391,"user_name":"è…¾è¾¾","can_delete":false,"product_type":"c1","uid":1079876,"ip_address":"","ucode":"72F9CFBA44FDEE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9hlAIKQ1sGDu16oWLOHyCSicr18XibygQSMLMjuDvKk73deDlH9aMphFsj41WYJh121aniaqBLiaMNg/132","comment_is_top":false,"comment_ctime":1551876489,"is_pvip":false,"replies":[{"id":"28036","content":"åé¢çš„æ¡ˆä¾‹è¿˜ä¼šè®²åˆ°timeoutçš„","user_name":"ä½œè€…å›å¤","comment_id":73391,"uid":"1001282","ip_address":"","utype":1,"ctime":1552748369,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5846843785","product_id":100020901,"comment_content":"èƒ½ä¸èƒ½å†å‡ºä¸€ä¸ªæœ‰å…³TIME_WAITã€peer resetã€socket read timeoutã€socket connect timeout æ–¹é¢æœ‰å…³çš„æ¡ˆä¾‹ï¼Ÿ ç±»ä¼¼javaã€phpã€nginxï¼Œåšåº”ç”¨å¼€å‘çš„ä¼šé‡åˆ°å¾ˆå¤šè¿™ç±»é—®é¢˜ã€‚ä¹‹å‰æœ‰ç½‘å‹æé—®ï¼šæœŸå¾…ç»“åˆç”Ÿäº§ç¯å¢ƒå¯¹è¿™å‡ ä¸ªå†…æ ¸å‚æ•°çš„è®²è§£ã€‚ç›®å‰ç”Ÿäº§ç¯å¢ƒä¸‹phpæœåŠ¡å™¨time_waitç‰¹åˆ«å¤šï¼Œç½‘ç»œåŒ…çš„æµç¨‹ï¼š NGINXä»£ç†&lt;â€”â€”&gt;PHPæœåŠ¡å™¨â€”â€”&gt;redis&#47;mysql.. <br>é«˜å³°æ—¶æœŸphpæœåŠ¡å™¨ä¸€å…±50k+çš„è¿æ¥ã€‚49k+çš„time_waitã€‚ æˆ‘çœ‹åˆ°è€å¸ˆå›å¤â€åé¢ä¼šæœ‰çš„â€œã€‚éš¾é“æ˜¯ã€Šæ¡ˆä¾‹ç¯‡ï¼šå¦‚ä½•ä¼˜åŒ–NATæ€§èƒ½ã€‹é‡Œä¸€ç¬”å¸¦è¿‡çš„æœ‰å…³TIME_WAITçš„ä¸œè¥¿ï¼Ÿ èƒ½å¦ä¸“é—¨å‡ºä¸€ä¸ªåå¼€å‘äººå‘˜æ–¹é¢çš„ç½‘ç»œæ¡ˆä¾‹ï¼Ÿ ç½‘ç»œç¯‡é‡Œçš„æ¡ˆä¾‹å¤§éƒ¨åˆ†äººéƒ½è¯´ä¸å¤ªè·Ÿçš„ä¸Šï¼ŒåŸºç¡€éƒ½ä¸å¥½ï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººéƒ½æ˜¯åå¼€å‘ï¼Œç½‘ç»œæ¥è§¦çš„å°‘ï¼ŒåƒNATæ›´æ˜¯å¾ˆå°‘äººæ¥è§¦äº†ã€‚å¸Œæœ›å†å‡ºä¸€ä¸ªåå¼€å‘äººå‘˜é€‚ç”¨çš„ç½‘ç»œçš„æ¡ˆä¾‹","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":442060,"discussion_content":"åé¢çš„æ¡ˆä¾‹è¿˜ä¼šè®²åˆ°timeoutçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1552748369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73165,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1551834519,"is_pvip":false,"replies":[{"id":"26749","content":"è¿™æ˜¯å¯é…ç½®çš„ï¼Œä¹Ÿå¯ä»¥å¼€å¯reuseportäº¤ç»™ä½ ç³»ç»Ÿæ¥é€‰æ‹©","user_name":"ä½œè€…å›å¤","comment_id":73165,"uid":"1001282","ip_address":"","utype":1,"ctime":1551884161,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5846801815","product_id":100020901,"comment_content":"è¯•ç€å›ç­”ä¸‹åŒå­¦çš„æé—®ã€‚<br>nginx forkå‡ºæ¥çš„å­è¿›ç¨‹æ•°æ˜¯å¯ä»¥é…ç½®çš„ã€‚<br>æœ‰è¿æ¥è¯·æ±‚æ—¶ï¼Œå¯èƒ½æ˜¯é€‰ä¸€ä¸ªå­è¿›ç¨‹å“åº”è¿æ¥è¯·æ±‚ï¼ˆè¿™ä¸ªä¸å¤ªç¡®å®šï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸»è¿›ç¨‹å»ºç«‹è¿æ¥äº†äº¤ç»™å­è¿›ç¨‹ï¼‰ã€‚","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441942,"discussion_content":"è¿™æ˜¯å¯é…ç½®çš„ï¼Œä¹Ÿå¯ä»¥å¼€å¯reuseportäº¤ç»™ä½ ç³»ç»Ÿæ¥é€‰æ‹©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551884161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357358,"user_name":"èƒ–å­ç½—","can_delete":false,"product_type":"c1","uid":1308729,"ip_address":"ä¸Šæµ·","ucode":"AF45AEED6064B3","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/39/4089c9b5.jpg","comment_is_top":false,"comment_ctime":1663201399,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663201399","product_id":100020901,"comment_content":"æœåŠ¡ç«¯æœ€å¤§è¿æ¥æ•°ä¸æ˜¯å’Œæ–‡ä»¶æè¿°ç¬¦æœ‰å…³ç³»å—","like_count":0},{"had_liked":false,"id":345168,"user_name":"lJ","can_delete":false,"product_type":"c1","uid":2562558,"ip_address":"","ucode":"CC29D06A16FF93","user_header":"https://static001.geekbang.org/account/avatar/00/27/19/fe/d31344db.jpg","comment_is_top":false,"comment_ctime":1652088002,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1652088002","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå…³äºâ€œç¯å½¢ç¼“å†²åŒºï¼Œç”±äºéœ€è¦ DMA ä¸ç½‘å¡äº¤äº’ï¼Œç†åº”å±äºç½‘å¡è®¾å¤‡é©±åŠ¨çš„èŒƒå›´â€<br><br>æˆ‘åœ¨<br>http:&#47;&#47;arthurchiao.art&#47;blog&#47;tuning-stack-rx-zh&#47;<br>  -&gt;2 æ”¶åŒ…è¿‡ç¨‹ä¿¯ç° éƒ¨åˆ†çš„ç¬¬ä¸‰ç‚¹ä¸­è¯´ ç½‘å¡ï¼ˆé€šè¿‡ DMAï¼‰å°†åŒ… copy åˆ°å†…æ ¸å†…å­˜ä¸­çš„ ring buffer<br>è¿™ä¸€å—æœ‰ç‚¹ç³Šæ¶‚äº†<br>","like_count":0,"discussions":[{"author":{"id":1642766,"avatar":"https://static001.geekbang.org/account/avatar/00/19/11/0e/23d6a88f.jpg","nickname":"Shuai","note":"","ucode":"BE705668C66225","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571782,"discussion_content":"https://stackoverflow.com/questions/47450231/what-is-the-relationship-of-dma-ring-buffer-and-tx-rx-ring-for-a-network-card","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652409081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344070,"user_name":"ç‹å­è™¾","can_delete":false,"product_type":"c1","uid":2667644,"ip_address":"","ucode":"22B1ABCF9FC671","user_header":"https://static001.geekbang.org/account/avatar/00/28/b4/7c/59e24b60.jpg","comment_is_top":false,"comment_ctime":1651221086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651221086","product_id":100020901,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜æ˜¯ï¼ŒæœåŠ¡å™¨èƒ½ã€åŒæ—¶ã€‘æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°<br>ä¸æ˜¯æœ‰ä¸€ä¸ªacceptå…¨è¿æ¥é˜Ÿåˆ—ä¹ˆï¼Œæ˜¯æœ‰128é™åˆ¶å§ï¼Ÿè¿™ä¸ªå’Œä¸Šé¢æ˜¯ä¸æ˜¯å’Œã€è€ŒæœåŠ¡å™¨ç«¯å¯æ”¯æŒçš„è¿æ¥æ•°æ˜¯æµ·é‡ã€‘çŸ›ç›¾å•Šï¼Œä¸æ˜¯è¿æ¥é˜Ÿåˆ—ä¼šçˆ†ä¹ˆ","like_count":0},{"had_liked":false,"id":337317,"user_name":"å±±å²­å°å·¨äºº","can_delete":false,"product_type":"c1","uid":1259567,"ip_address":"","ucode":"0F7905088B4C4D","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/2f/3b4c70cf.jpg","comment_is_top":false,"comment_ctime":1646751141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646751141","product_id":100020901,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¯¹äºæœ€å¤§è¿æ¥æ•°ä¼šä¸ä¼šè¶…è¿‡65535çš„é—®é¢˜ï¼Œåˆ¤æ–­çš„ä¾æ®åº”è¯¥æ˜¯ äº”å…ƒç»„æˆ–å››å…ƒç»„ï¼ˆä¸åŒ…å«åè®®ï¼‰å§ï¼Ÿ<br>å®¢æˆ·ç«¯å¦‚æœåªè¿æ¥åŒä¸€å°æœåŠ¡å™¨çš„åŒä¸€ä¸ªç«¯å£æ—¶ï¼Œè¿æ¥ä¸Šé™æ˜¯65535ï¼›<br>å¦‚æœå®¢æˆ·ç«¯ä¸ ServerA+Port 1 å·²ç»å»ºç«‹5ä¸‡ä¸ªè¿æ¥ï¼ŒåŒæ—¶è¿™ä¸ªå®¢æˆ·ç«¯åº”è¯¥è¿˜å¯ä»¥ ä¸ ServerB+Port2 å†å»ºç«‹5ä¸‡ä¸ªè¿æ¥ã€‚å› ä¸ºè¿™10ä¸‡ä¸ªè¿æ¥çš„ å››å…ƒç»„ ä¸åŒ","like_count":0},{"had_liked":false,"id":303548,"user_name":"tee","can_delete":false,"product_type":"c1","uid":1628215,"ip_address":"","ucode":"82E8D03E34ADAD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIYeenVcfUP2PhW4V1y4EDptWibKBDia8lpic1KUuqaXwuydbyrnfXq9Emfbjxkddf10X6tk7vCTA6Fw/132","comment_is_top":false,"comment_ctime":1626852281,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626852281","product_id":100020901,"comment_content":"é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜  ç”¨scpä¼ è¾“æ•°æ®  é»˜è®¤çš„22ç«¯å£å¾ˆæ…¢ï¼Œæ”¹æ‰sshçš„ç«¯å£åˆ°10000 ä¼ è¾“é€Ÿåº¦å°±å¾ˆå¿«äº†ï¼Œä¸­é—´æ²¡æœ‰å®‰å…¨è®¾å¤‡ï¼Œiptablesä¹Ÿæ²¡åšé™åˆ¶ã€‚è¿™ä¸ªä¼šæ˜¯å¥—æ¥å­—çš„ç¼“å†²åŒºåœ¨å½±å“å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":285799,"user_name":"xingtianbj","can_delete":false,"product_type":"c1","uid":1009911,"ip_address":"","ucode":"F57D9F347AD0FB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/68/f7/44bee670.jpg","comment_is_top":false,"comment_ctime":1617015517,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617015517","product_id":100020901,"comment_content":"sk_buff ç¼“å†²åŒºå’Œå¥—æ¥å­—ç¼“å†²åŒºæ˜¯ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼ŒæŸ¥äº†åŠå¤©èµ„æ–™ä¹Ÿæ²¡æ‰¾åˆ°è¿™ä¸¤è€…çš„åŒºåˆ«","like_count":0},{"had_liked":false,"id":282712,"user_name":"å¡æ‹‰è‚–å…‹","can_delete":false,"product_type":"c1","uid":1671071,"ip_address":"","ucode":"E0EC7616C35E5E","user_header":"https://static001.geekbang.org/account/avatar/00/19/7f/9f/257bd861.jpg","comment_is_top":false,"comment_ctime":1615372388,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615372388","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¿™è¾¹é‡åˆ°ä¸ªé—®é¢˜ï¼Œæ•°æ®å¡åœ¨send-Qï¼Œå‘é€ä¸å‡ºå»ï¼Œè¿æ¥è¿‡ä¸€ä¼šä¹Ÿæ–­å¼€äº†ï¼Œè¿™ä¸ªé—®é¢˜åº”è¯¥ä»å“ªå…¥æ‰‹å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":248529,"user_name":"Geek_03056e","can_delete":false,"product_type":"c1","uid":1509657,"ip_address":"","ucode":"6D4289AD71BC1A","user_header":"","comment_is_top":false,"comment_ctime":1600214751,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1600214751","product_id":100020901,"comment_content":"ç¼“å†²åŒºæœ‰å‡ ä¸ªï¼Œåœ¨ä»€ä¹ˆé˜¶æ®µï¼Œè¿™ä¸ªé—®é¢˜ï¼Œå›°æ‰°äº†å¾ˆé•¿æ—¶é—´äº†","like_count":0,"discussions":[{"author":{"id":1636551,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f8/c7/d0c0a613.jpg","nickname":"å¤§åœ°","note":"","ucode":"62D9098C0BCE13","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310707,"discussion_content":"ä¸€èˆ¬å›°æ‰°å¤§å®¶çš„éƒ½æ˜¯é‚£ä¸ªæ‰€è°“çš„socketç¼“å†²åŒºåˆ°åº•æ˜¯ä¸ªä»€ä¹ˆæ ·çš„ã€‚\n\n1 ç½‘å¡åˆ°å†…æ ¸çš„sk_buff(ç¬¬1æ¬¡copyï¼ŒDMA)\n2 å†…æ ¸åè®®æ ˆå¤„ç†å¯¹sk_buffè¿›è¡Œå¤„ç†ï¼Œç„¶ååˆ°ä¼ è¾“å±‚(ä»¥TCPä¸ºä¾‹)çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªsk_buffæŒ‚åœ¨sockç»“æ„ä½“çš„sk_receive_queueé˜Ÿåˆ—ä¸Š(ä¸æ¶‰åŠcopyæ“ä½œ)ï¼Œå¯ä»¥ç†è§£æˆè¿™ä¸ªé˜Ÿåˆ—å°±æ˜¯socketåœ¨å†…æ ¸é‡Œçš„ç¼“å†²åŒºã€‚\n3 å°†sk_receive_queueé˜Ÿåˆ—ä¸Šçš„æ•°æ®æ‹·è´åˆ°ç”¨æˆ·æ€çš„ç¼“å†²åŒº(ç¬¬2æ¬¡æ‹·è´ï¼Œä»å†…æ ¸æ€åˆ°ç”¨æˆ·æ€)\n\nå¯ä»¥çœ‹çœ‹è¿™ä¸ªå“¥ä»¬çš„æºç åˆ†æ(å‰åå‡ ç¯‡æœ‰å…³è”çš„å¯ä»¥éƒ½çœ‹ä¸€ä¸‹)ï¼š\nhttps://www.cnblogs.com/wanpengcoder/p/11752133.html","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1602010744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2268182,"avatar":"","nickname":"Geek_2a37b1","note":"","ucode":"A27487D7911D29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1636551,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f8/c7/d0c0a613.jpg","nickname":"å¤§åœ°","note":"","ucode":"62D9098C0BCE13","race_medal":1,"user_type":1,"is_pvip":false},"discussion":{"id":352145,"discussion_content":"æ­£è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614609188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":310707,"ip_address":""},"score":352145,"extra":""}]}]},{"had_liked":false,"id":225222,"user_name":"jorin@zou","can_delete":false,"product_type":"c1","uid":1564869,"ip_address":"","ucode":"A8CEF7CCF33570","user_header":"https://static001.geekbang.org/account/avatar/00/17/e0/c5/c324a7de.jpg","comment_is_top":false,"comment_ctime":1591686750,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591686750","product_id":100020901,"comment_content":"æ¥è·Ÿè¸ªã€MASQUERADE æœºå™¨çš„ç½‘ç»œå¸¦å®½ç­‰ï¼Œéƒ½æ˜¯æ½œåœ¨çš„ç“¶é¢ˆï¼Œå¹¶ä¸”è¿˜å­˜åœ¨å•ç‚¹çš„é—®é¢˜ï¼Ÿ<br>è¿™é‡Œçš„å•ç‚¹çš„é—®é¢˜å…·ä½“æ˜¯æŒ‡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1959822,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/e7/8e/318cfde0.jpg","nickname":"Spoon","note":"","ucode":"2FF9193AD482C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336011,"discussion_content":"åº”è¯¥æ˜¯MASQUERADEæœºå™¨ä¹‹é—´æ²¡æœ‰å…±äº«è½¬æ¢åçš„NATä¿¡æ¯ï¼Œä¸¾ä¸ªä¾‹å­server Aè¿æ¥åˆ°Nat a,å¦‚æœNat aå‡ºç°æ•…éšœï¼ŒNat bæ˜¯ä¸çŸ¥é“Server Açš„Natä¿¡æ¯çš„ã€‚æ‰€ä»¥ä¼šå­˜åœ¨å•ç‚¹é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608451601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120752,"user_name":"èƒ–èƒ–è™","can_delete":false,"product_type":"c1","uid":1139121,"ip_address":"","ucode":"9CA8F99CC82944","user_header":"https://static001.geekbang.org/account/avatar/00/11/61/b1/1261c177.jpg","comment_is_top":false,"comment_ctime":1564989715,"is_pvip":false,"replies":[{"id":"44391","content":"æ˜¯çš„ï¼Œé™¤äº†å†…å­˜æ‹·è´ä¼˜åŒ–ï¼Œè¿˜å‡å°‘äº†åŸæ¥å†—é•¿çš„ç½‘ç»œåè®®æ ˆå¤„ç†è¿‡ç¨‹","user_name":"ä½œè€…å›å¤","comment_id":120752,"uid":"1001282","ip_address":"","utype":1,"ctime":1565014535,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"1564989715","product_id":100020901,"comment_content":"è€å¸ˆï¼Œç°åœ¨æœ‰å¾ˆå¤šé›¶æ‹·è´çš„æŠ€æœ¯æ¯”å¦‚dpdkï¼Œæ¯”è¾ƒpf_ring_zcã€‚æˆ‘çš„ç†è§£æ˜¯ï¼Œè¿™äº›æŠ€æœ¯é€šè¿‡å†…å­˜æ˜ å°„çš„æ–¹æ³•ï¼Œç›´æ¥æŠŠç½‘å¡è®¾å¤‡ç¯å½¢ç¼“å†²é‡Œçš„æ•°æ®ç›´æ¥æ‹·è´åˆ°äº†ç”¨æˆ·æ€ï¼Œçœç•¥äº†å…ˆæ‹·è´åˆ°sk_buffï¼Œå†åˆ°socketç¼“å†²åŒºï¼Œå†åˆ°åº”ç”¨ç¨‹åºè¿™ä¸ªè¿‡ç¨‹ã€‚ä¸çŸ¥é“æˆ‘è¿™ä¸ªç†è§£æ˜¯å¦å‡†ç¡®ã€‚","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461460,"discussion_content":"æ˜¯çš„ï¼Œé™¤äº†å†…å­˜æ‹·è´ä¼˜åŒ–ï¼Œè¿˜å‡å°‘äº†åŸæ¥å†—é•¿çš„ç½‘ç»œåè®®æ ˆå¤„ç†è¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565014535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046745,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/d9/dc58bb9b.jpg","nickname":"SUNTOPO","note":"","ucode":"0DD7492725962C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":268319,"discussion_content":"é‚£ç½‘ç»œåè®®è¿˜æ˜¯è¦å¤„ç†æ‰è¡Œå‘€ï¼Œéš¾é“æŠŠå†…æ ¸å¤„ç†çš„æµç¨‹æ”¾åˆ°ç”¨æˆ·æ€å†æ‰§è¡Œä¸€éï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589762489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1139121,"avatar":"https://static001.geekbang.org/account/avatar/00/11/61/b1/1261c177.jpg","nickname":"èƒ–èƒ–è™","note":"","ucode":"9CA8F99CC82944","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1046745,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/d9/dc58bb9b.jpg","nickname":"SUNTOPO","note":"","ucode":"0DD7492725962C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306435,"discussion_content":"å¦‚æœæ˜¯ä½¿ç”¨å†…æ ¸bypassæŠ€æœ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦å¯¹æ•°æ®åŒ…è¿›è¡Œè½¬å‘ç­‰æ“ä½œï¼Œé‚£ä¹ˆåœ¨ç”¨æˆ·æ€å®ç°ç½‘ç»œåè®®æ ˆæ˜¯ä¸€ç§é€”å¾„ã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ç”¨æˆ·æ€å¤„ç†å®Œå†å¡å›å†…æ ¸ç»§ç»­åšå¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600267808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":268319,"ip_address":""},"score":306435,"extra":""}]}]},{"had_liked":false,"id":84972,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1554950581,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554950581","product_id":100020901,"comment_content":"DAY45ï¼Œæ‰“å¡<br>","like_count":0},{"had_liked":false,"id":78960,"user_name":"æˆ‘ä¸åƒç”œé£Ÿ","can_delete":false,"product_type":"c1","uid":1086808,"ip_address":"","ucode":"1718E6D78F2852","user_header":"https://static001.geekbang.org/account/avatar/00/10/95/58/95e9507d.jpg","comment_is_top":false,"comment_ctime":1553309375,"is_pvip":false,"replies":[{"id":"28781","content":"C10Kç¯‡é‡Œé¢å·²ç»è®²è¿‡äº†","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553319873,"ip_address":"","comment_id":78960,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553309375","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œèƒ½ä¸èƒ½è®²ä¸€ä¸‹selectï¼Œpollå’Œepollçš„æœ¬è´¨åŒºåˆ«ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444303,"discussion_content":"C10Kç¯‡é‡Œé¢å·²ç»è®²è¿‡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":73339,"user_name":"å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1551863174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551863174","product_id":100020901,"comment_content":"æœ‰ä¸€ç¯‡æ”¶è·æ»¡æ»¡","like_count":0},{"had_liked":false,"id":73219,"user_name":"xfan","can_delete":false,"product_type":"c1","uid":1315147,"ip_address":"","ucode":"48ED8D498D7F56","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","comment_is_top":false,"comment_ctime":1551842180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551842180","product_id":100020901,"comment_content":"è¿™ä¸€å¼ æ»¡æ»¡å¹²è´§ï¼Œ","like_count":0},{"had_liked":false,"id":73148,"user_name":"çˆ±å­¦ä¹ çš„å°å­¦ç”Ÿ","can_delete":false,"product_type":"c1","uid":1413556,"ip_address":"","ucode":"040AB71F0394F2","user_header":"https://static001.geekbang.org/account/avatar/00/15/91/b4/d5d9e4fb.jpg","comment_is_top":false,"comment_ctime":1551832416,"is_pvip":false,"replies":[{"id":"26746","content":"æ­£å¥½åæ­£ï¼Œå®¢æˆ·ç«¯ä¼šéšæœºä¸€ä¸ªç«¯å£å»è¿æ¥80ç«¯å£","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1551883762,"ip_address":"","comment_id":73148,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551832416","product_id":100020901,"comment_content":"å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯nginxè¿æ¥80ç«¯å£æ—¶ï¼Œnginxä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹é€‰ä¸€ä¸ªéšæœºç«¯å£ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441935,"discussion_content":"æ­£å¥½åæ­£ï¼Œå®¢æˆ·ç«¯ä¼šéšæœºä¸€ä¸ªç«¯å£å»è¿æ¥80ç«¯å£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551883762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}