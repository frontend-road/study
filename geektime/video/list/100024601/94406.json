{"id":94406,"title":"44 | 创建一个分步表单","content":"<h1>勘误</h1><p>分布表单 mutation 传参错误，导致无法正确降数据同步到store，修复方式如下:</p><p><a href=\"https://github.com/vueComponent/ant-design-vue-pro/commit/0f96ff027931b8a256f34f1f37fc5d5220f266ea\">https://github.com/vueComponent/ant-design-vue-pro/commit/0f96ff027931b8a256f34f1f37fc5d5220f266ea</a></p>","comments":[{"had_liked":false,"id":93796,"user_name":"jisi724","can_delete":false,"product_type":"c3","uid":1467363,"ip_address":"","ucode":"3D7AA5C18BDBF6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJh8zP773uF1RyCaA40spibkhlml0t3zzFqCkS5wG4kjTv1kR60pjEC0ZYb5xkShDGjKPiaDnazCcoQ/132","comment_is_top":false,"comment_ctime":1557615502,"is_pvip":false,"replies":[{"id":33475,"content":"多谢提醒，我们在视频下方补充了说明","user_name":"编辑回复","user_name_real":"张浩","uid":1000075,"ctime":1557617236,"ip_address":"","comment_id":93796,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"Hello 视频代码里有个小小的问题\n\nstore.form.action.submitStepForm 里直接传了解构的值 { payload }，所以再调用 `commit(&quot;saveStepFormData&quot;, payload);` 的时候传递到 mutation 里的其实就是 payload.payload，而 mutation 传参的时候又解构了一次，实际上传递的就是 payload.payload.payload 结果就是 undefined，导致 step2 里的 dispatch 实际上没有用.. \n\n视频里演示的时候其实没有把 password 提交到 store，所以没发现这个小错误，建议把 submitStepForm 改成\n\n  async submitStepForm({ commit }, payload) {\n    await request({\n      url: &quot;&#47;api&#47;form&quot;,\n      methods: &quot;POST&quot;,\n      data: payload.payload\n    });\n    commit(&quot;saveStepFormData&quot;, payload);\n    router.push(&quot;&#47;form&#47;step-form&#47;result&quot;);\n  }","like_count":13,"discussions":[{"author":{"id":1000075,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/8b/6ea91a1b.jpg","nickname":"Sean","note":"","ucode":"6D1A2F16FA4A41","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449775,"discussion_content":"多谢提醒，我们在视频下方补充了说明","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557617236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109899,"user_name":"Anastatica","can_delete":false,"product_type":"c3","uid":1472463,"ip_address":"","ucode":"3F3E1EEF1A05AC","user_header":"https://static001.geekbang.org/account/avatar/00/16/77/cf/e6a0aedf.jpg","comment_is_top":false,"comment_ctime":1562127450,"is_pvip":false,"replies":[{"id":40836,"content":"V-bind=&quot;obj&quot;   动态改变obj这个对象即可","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1562721312,"ip_address":"","comment_id":109899,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"vue怎么像react那样动态传参数？  每次传的数量都不一致，属性名也不一样","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456629,"discussion_content":"V-bind=&amp;quot;obj&amp;quot;   动态改变obj这个对象即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562721312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":95334,"user_name":"Geek_7af7ad","can_delete":false,"product_type":"c3","uid":1500150,"ip_address":"","ucode":"34AB370B3B3C0A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI59Ik7aURR18UmfibR017oU81nygq2dL9c2b6f3tTP7ib2V6ccLyxYHX9ERxsNZ0iapnBKXJaJwCXdQ/132","comment_is_top":false,"comment_ctime":1558020929,"is_pvip":false,"replies":[{"id":35058,"content":"要选中什么，就将 value 改变成什么 ","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1558878519,"ip_address":"","comment_id":95334,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"如何赋值给下拉框或者多选框  所有选项和当前选中项","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450416,"discussion_content":"要选中什么，就将 value 改变成什么 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558878519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94952,"user_name":"Geek 鱼","can_delete":false,"product_type":"c3","uid":1496424,"ip_address":"","ucode":"5A9F5EE888966C","user_header":"https://static001.geekbang.org/account/avatar/00/16/d5/68/a1da5fc0.jpg","comment_is_top":false,"comment_ctime":1557928596,"is_pvip":false,"replies":[{"id":34199,"content":"没区别，只要在使用“form前”，实例化“this后”创建即可","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1558103441,"ip_address":"","comment_id":94952,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"看到官网上创建表单是在 \n```\nbeforeCreate () {\n  this.form = this.$form.createForm(this, options)\n}\n```\n而视频中是在 data 的 return 前面创建，这有什么区别吗","like_count":1,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450270,"discussion_content":"没区别，只要在使用“form前”，实例化“this后”创建即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558103441,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230014,"user_name":"Geek_cb636c","can_delete":false,"product_type":"c3","uid":1947356,"ip_address":"","ucode":"3B2143CF379015","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/NGib8v9Lml2KjSHick5qMw9Vaibbb5l1qeTKE2BqbNDU8ibyhkhVFbxPmvKrhjKibKesvUYAQxbJ5wEc4aQLibBCfu6A/132","comment_is_top":false,"comment_ctime":1593242501,"is_pvip":false,"replies":[{"id":84895,"content":".你可以this.form123 =this.$xxxx  :form=&quot;form123&quot;","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1593256906,"ip_address":"","comment_id":230014,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师，你里面有一句“this.form = this.$form.createForm(this);” 这里的form哪个是关键字，哪个是上面:form传进来的属性啊？","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499736,"discussion_content":".你可以this.form123 =this.$xxxx  :form=&amp;quot;form123&amp;quot;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593256906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114170,"user_name":"cuikt","can_delete":false,"product_type":"c3","uid":1242702,"ip_address":"","ucode":"9A1DB426CEFEEA","user_header":"https://static001.geekbang.org/account/avatar/00/12/f6/4e/0066303c.jpg","comment_is_top":false,"comment_ctime":1563245228,"is_pvip":false,"replies":[{"id":42099,"content":"可以在仔细看下","user_name":"作者回复","user_name_real":"唐","uid":1316874,"ctime":1563522733,"ip_address":"","comment_id":114170,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"46节课程等router部分的配置，视频里没讲吧！感觉有断层。","like_count":0,"discussions":[{"author":{"id":1316874,"avatar":"https://static001.geekbang.org/account/avatar/00/14/18/0a/28206510.jpg","nickname":"唐金州","note":"","ucode":"563B97D87C66AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458538,"discussion_content":"可以在仔细看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563522733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119375,"user_name":"章泽楷","can_delete":false,"product_type":"c3","uid":1592210,"ip_address":"","ucode":"999CBA4CA84525","user_header":"https://static001.geekbang.org/account/avatar/00/18/4b/92/f70a8296.jpg","comment_is_top":false,"comment_ctime":1564574885,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"老师，step1进入页面的时候有报错\n&quot;browser.js?e834:49 Warning: You cannot set a form field before rendering a field associated with the value.&quot;\n但页面功能正常，请问是什么原因？","like_count":3,"discussions":[{"author":{"id":1346502,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLTYpERVj4wtwAwqz4SUiaoQXDIyhYaKjABMvkJbVXaI3kcJterXovCTqZZSQ1TnueIWX7VGvC3koA/132","nickname":"麦田里的守望者","note":"","ucode":"E2D35F3A628C06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":23171,"discussion_content":"我也碰到了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569765253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94213,"user_name":"顺其自然","can_delete":false,"product_type":"c3","uid":1030174,"ip_address":"","ucode":"941311E45967A7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/1e/f9bef7b1.jpg","comment_is_top":false,"comment_ctime":1557746013,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"computed里面取store里面的数据为什么不是this.$store.state.step而是this.$store.state.form.step呢？","like_count":1,"discussions":[{"author":{"id":1386393,"avatar":"https://static001.geekbang.org/account/avatar/00/15/27/99/20aea94e.jpg","nickname":"龍","note":"","ucode":"7240C43FB19CB7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351,"discussion_content":"因为在store中可能会有多个modules","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561469640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314929,"user_name":"😉","can_delete":false,"product_type":"c3","uid":2653390,"ip_address":"","ucode":"DD63239B217967","user_header":"https://static001.geekbang.org/account/avatar/00/28/7c/ce/d8a960f4.jpg","comment_is_top":false,"comment_ctime":1633591431,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"unknown mutation type: form&#47;saveStepFormData\n有遇到这种问题的同学吗，第二步点提交的时候报这个错\n","like_count":0,"discussions":[{"author":{"id":2952994,"avatar":"","nickname":"woJA1wCgAAIgEDahN4qC4BCXweAtm8cA","note":"","ucode":"4B6D8A6EB7E143","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571425,"discussion_content":"两种可能，要么mutations没有拼写对，要么没有namespaced: true","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652200355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286020,"user_name":"guopeng1129972","can_delete":false,"product_type":"c3","uid":2143239,"ip_address":"","ucode":"6ABDA16DAFA0CD","user_header":"https://static001.geekbang.org/account/avatar/00/20/b4/07/e51f0fbe.jpg","comment_is_top":false,"comment_ctime":1617108800,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024601,"comment_content":"Warning: You cannot set a form field before rendering a field associated with the value. You can use `getFieldDecorator(id, options)` instead `v-decorator=&quot;[id, options]&quot;` to register it before render.\n\n是为什么呢 没影响功能\n","like_count":0,"discussions":[{"author":{"id":1610241,"avatar":"https://static001.geekbang.org/account/avatar/00/18/92/01/2eb2a083.jpg","nickname":"vxfranky","note":"","ucode":"14110FD6D3198E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403593,"discussion_content":"表单初始化的时候没有指定初始值，需要用数据绑定先从vuex取值：<a-form layout=&#34;horizontal&#34; :form=&#34;form&#34;>","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634115083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262894,"user_name":"i_小休","can_delete":false,"product_type":"c3","uid":1001854,"ip_address":"","ucode":"4C0F9A27480826","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/7e/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1605871974,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"分步表单设置了 `hideChildrenInMenu: true`,\nchildren中的子菜单如果不设置`meta`属性，\n控制台报错：\n`[Vue warn]: Error in render: &quot;TypeError: Cannot read property &#39;icon&#39; of undefined&quot;`\n\n有遇到这个问题的同学吗","like_count":0},{"had_liked":false,"id":208428,"user_name":"怀英","can_delete":false,"product_type":"c3","uid":1394143,"ip_address":"","ucode":"E2838AF06FB300","user_header":"https://static001.geekbang.org/account/avatar/00/15/45/df/97a71dc8.jpg","comment_is_top":false,"comment_ctime":1587355290,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"#W#view表单，#H#viewrooter创建","like_count":0},{"had_liked":false,"id":166859,"user_name":"lovelytong","can_delete":false,"product_type":"c3","uid":1464664,"ip_address":"","ucode":"BC4B7F393E1FC4","user_header":"https://static001.geekbang.org/account/avatar/00/16/59/58/6ed1d751.jpg","comment_is_top":false,"comment_ctime":1577617262,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师你好，这个分布式表单把数据存在vuex里，在第二步页面刷新的时候，数据就没有了，但是还停留在当前路由，是不是会有bug","like_count":0},{"had_liked":false,"id":127447,"user_name":"枫叶","can_delete":false,"product_type":"c3","uid":1489847,"ip_address":"","ucode":"F915D040719240","user_header":"https://static001.geekbang.org/account/avatar/00/16/bb/b7/3125d62e.jpg","comment_is_top":false,"comment_ctime":1566717471,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"一个页面有两个form 表单，最后数据合在一起，该怎么操作呢？","like_count":0},{"had_liked":false,"id":118066,"user_name":"Geek_245804","can_delete":false,"product_type":"c3","uid":1615011,"ip_address":"","ucode":"B7B99F9F47A6B5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/F8TUzx6cFyLW2uhFFX87YaVzP5GYjOicFbBV5rKCPLeeK9vtOpQ1EbOUOicYeXUntZVW0g4rswJD5xh2BXd67A7g/132","comment_is_top":false,"comment_ctime":1564225786,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"就是数据量大于600条以上了，要求同时渲染出来，a-table组件很卡，除了懒加载和动态新增删除节点，有没有更好更快的方式完成这个需求啊","like_count":0},{"had_liked":false,"id":112024,"user_name":"黄杨","can_delete":false,"product_type":"c3","uid":1228105,"ip_address":"","ucode":"9C32FB6DE4FD05","user_header":"https://static001.geekbang.org/account/avatar/00/12/bd/49/b7c7e4be.jpg","comment_is_top":false,"comment_ctime":1562654998,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"请教老师：分步表单最重要的就是数据回显修改，用vuex方法，如果分步多 、表单项过多，那store代码也会增多，还有没有其它方法处理？","like_count":0},{"had_liked":false,"id":97216,"user_name":"huanghui","can_delete":false,"product_type":"c3","uid":1464865,"ip_address":"","ucode":"AD2AC528E2C63A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ericUvFT5gl0eEJCjcMXub9d6Z8TPjZOibJCjIyibZKOlhsQWkgcSvOoA5S0Vn6z0B6BKv2zR8HvLArA/132","comment_is_top":false,"comment_ctime":1558613550,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"老师，这边的密码初始值不正确\n     &lt;a-input\n          v-decorator=&quot;[\n            &#39;password&#39;,\n            {\n              initialValue: step.password,\n              rules: [{ required: true, message: &#39;请输入密码&#39; }]\n            }\n          ]&quot;\n          type=&quot;password&quot;\n          placeholder=&quot;请输入付款密码&quot;\n        &#47;&gt;","like_count":0},{"had_liked":false,"id":97160,"user_name":"huanghui","can_delete":false,"product_type":"c3","uid":1464865,"ip_address":"","ucode":"AD2AC528E2C63A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ericUvFT5gl0eEJCjcMXub9d6Z8TPjZOibJCjIyibZKOlhsQWkgcSvOoA5S0Vn6z0B6BKv2zR8HvLArA/132","comment_is_top":false,"comment_ctime":1558599493,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024601,"comment_content":"@我思我在\n应该是index.js里面，modules: {form}的原因\nimport Vue from &quot;vue&quot;;\nimport Vuex from &quot;vuex&quot;;\nimport form from &quot;.&#47;module&#47;form&quot;;\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {},\n  modules: {\n    form\n  }\n});\n\n \n","like_count":0}]}