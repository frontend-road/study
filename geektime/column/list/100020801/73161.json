{"id":73161,"title":"15 | ç­”ç–‘æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šæ—¥å¿—å’Œç´¢å¼•ç›¸å…³é—®é¢˜","content":"<p>åœ¨ä»Šå¤©è¿™ç¯‡ç­”ç–‘æ–‡ç« æ›´æ–°å‰ï¼ŒMySQLå®æˆ˜è¿™ä¸ªä¸“æ å·²ç»æ›´æ–°äº†14ç¯‡ã€‚åœ¨è¿™äº›æ–‡ç« ä¸­ï¼Œå¤§å®¶åœ¨è¯„è®ºåŒºç•™ä¸‹äº†å¾ˆå¤šé«˜è´¨é‡çš„ç•™è¨€ã€‚ç°åœ¨ï¼Œæ¯ç¯‡æ–‡ç« çš„è¯„è®ºåŒºéƒ½æœ‰çƒ­å¿ƒçš„åŒå­¦å¸®å¿™æ€»ç»“æ–‡ç« çŸ¥è¯†ç‚¹ï¼Œä¹Ÿæœ‰ä¸å°‘åŒå­¦æå‡ºäº†å¾ˆå¤šé«˜è´¨é‡çš„é—®é¢˜ï¼Œæ›´æœ‰ä¸€äº›åŒå­¦å¸®å¿™è§£ç­”å…¶ä»–åŒå­¦æå‡ºçš„é—®é¢˜ã€‚</p><p>åœ¨æµè§ˆè¿™äº›ç•™è¨€å¹¶å›å¤çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å€å—é¼“èˆï¼Œä¹Ÿå°½æˆ‘æ‰€çŸ¥åœ°å¸®åŠ©ä½ è§£å†³é—®é¢˜ã€å’Œä½ è®¨è®ºã€‚å¯ä»¥è¯´ï¼Œä½ ä»¬çš„ç•™è¨€æ´»è·ƒäº†æ•´ä¸ªä¸“æ çš„æ°›å›´ã€æå‡äº†æ•´ä¸ªä¸“æ çš„è´¨é‡ï¼Œè°¢è°¢ä½ ä»¬ã€‚</p><p>è¯„è®ºåŒºçš„å¤§å¤šæ•°ç•™è¨€æˆ‘éƒ½ç›´æ¥å›å¤äº†ï¼Œå¯¹äºéœ€è¦å±•å¼€è¯´æ˜çš„é—®é¢˜ï¼Œæˆ‘éƒ½æ‹¿å‡ºå°æœ¬å­è®°äº†ä¸‹æ¥ã€‚è¿™äº›è¢«è®°ä¸‹æ¥çš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¿™ç¯‡ç­”ç–‘æ–‡ç« çš„ç´ æäº†ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»æ”¶é›†äº†47ä¸ªé—®é¢˜ï¼Œå¾ˆéš¾é€šè¿‡ä»Šå¤©è¿™ä¸€ç¯‡æ–‡ç« å…¨éƒ¨å±•å¼€ã€‚æ‰€ä»¥ï¼Œæˆ‘å°±å…ˆä»ä¸­æ‰¾äº†å‡ ä¸ªè”ç³»éå¸¸ç´§å¯†çš„é—®é¢˜ï¼Œä¸²äº†èµ·æ¥ï¼Œå¸Œæœ›å¯ä»¥å¸®ä½ è§£å†³å…³äºæ—¥å¿—å’Œç´¢å¼•çš„ä¸€äº›ç–‘æƒ‘ã€‚è€Œå…¶ä»–é—®é¢˜ï¼Œæˆ‘ä»¬å°±ç•™ç€åé¢æ…¢æ…¢å±•å¼€å§ã€‚</p><h1>æ—¥å¿—ç›¸å…³é—®é¢˜</h1><p>æˆ‘åœ¨ç¬¬2ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/68633\">ã€Šæ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿã€‹</a>ä¸­ï¼Œå’Œä½ è®²åˆ°binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰å’Œredo logï¼ˆé‡åšæ—¥å¿—ï¼‰é…åˆå´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯åè¯æ³•ï¼Œè¯´æ˜äº†å¦‚æœæ²¡æœ‰ä¸¤é˜¶æ®µæäº¤ï¼Œä¼šå¯¼è‡´MySQLå‡ºç°ä¸»å¤‡æ•°æ®ä¸ä¸€è‡´ç­‰é—®é¢˜ã€‚</p><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸‹é¢ï¼Œå¾ˆå¤šåŒå­¦åœ¨é—®ï¼Œåœ¨ä¸¤é˜¶æ®µæäº¤çš„ä¸åŒç¬é—´ï¼ŒMySQLå¦‚æœå‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œæ˜¯æ€ä¹ˆä¿è¯æ•°æ®å®Œæ•´æ€§çš„ï¼Ÿ</p><!-- [[[read_end]]] --><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°±ä»è¿™ä¸ªé—®é¢˜å¼€å§‹å§ã€‚</p><p>æˆ‘å†æ”¾ä¸€æ¬¡ä¸¤é˜¶æ®µæäº¤çš„å›¾ï¼Œæ–¹ä¾¿ä½ å­¦ä¹ ä¸‹é¢çš„å†…å®¹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/2a/ee9af616e05e4b853eba27048351f62a.jpg?wh=1142*1522\" alt=\"\"></p><center><span class=\"reference\">å›¾1 ä¸¤é˜¶æ®µæäº¤ç¤ºæ„å›¾</span></center><p>è¿™é‡Œï¼Œæˆ‘è¦å…ˆå’Œä½ è§£é‡Šä¸€ä¸ªè¯¯ä¼šå¼çš„é—®é¢˜ã€‚æœ‰åŒå­¦åœ¨è¯„è®ºåŒºé—®åˆ°ï¼Œè¿™ä¸ªå›¾ä¸æ˜¯ä¸€ä¸ªupdateè¯­å¥çš„æ‰§è¡Œæµç¨‹å—ï¼Œæ€ä¹ˆè¿˜ä¼šè°ƒç”¨commitè¯­å¥ï¼Ÿ</p><p>ä»–äº§ç”Ÿè¿™ä¸ªç–‘é—®çš„åŸå› ï¼Œæ˜¯æŠŠ<strong>ä¸¤ä¸ªâ€œcommitâ€çš„æ¦‚å¿µ</strong>æ··æ·†äº†ï¼š</p><ul>\n<li>ä»–è¯´çš„â€œcommitè¯­å¥â€ï¼Œæ˜¯æŒ‡MySQLè¯­æ³•ä¸­ï¼Œç”¨äºæäº¤ä¸€ä¸ªäº‹åŠ¡çš„å‘½ä»¤ã€‚ä¸€èˆ¬è·Ÿbegin/start transaction é…å¯¹ä½¿ç”¨ã€‚</li>\n<li>è€Œæˆ‘ä»¬å›¾ä¸­ç”¨åˆ°çš„è¿™ä¸ªâ€œcommitæ­¥éª¤â€ï¼ŒæŒ‡çš„æ˜¯äº‹åŠ¡æäº¤è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªå°æ­¥éª¤ï¼Œä¹Ÿæ˜¯æœ€åä¸€æ­¥ã€‚å½“è¿™ä¸ªæ­¥éª¤æ‰§è¡Œå®Œæˆåï¼Œè¿™ä¸ªäº‹åŠ¡å°±æäº¤å®Œæˆäº†ã€‚</li>\n<li>â€œcommitè¯­å¥â€æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šåŒ…å«â€œcommit æ­¥éª¤â€ã€‚</li>\n</ul><p>è€Œæˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæ²¡æœ‰æ˜¾å¼åœ°å¼€å¯äº‹åŠ¡ï¼Œå› æ­¤è¿™ä¸ªupdateè¯­å¥è‡ªå·±å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œæˆåæäº¤äº‹åŠ¡æ—¶ï¼Œå°±ä¼šç”¨åˆ°è¿™ä¸ªâ€œcommitæ­¥éª¤â€œã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·åˆ†æä¸€ä¸‹<strong>åœ¨ä¸¤é˜¶æ®µæäº¤çš„ä¸åŒæ—¶åˆ»ï¼ŒMySQLå¼‚å¸¸é‡å¯ä¼šå‡ºç°ä»€ä¹ˆç°è±¡ã€‚</strong></p><p>å¦‚æœåœ¨å›¾ä¸­æ—¶åˆ»Açš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å†™å…¥redo log å¤„äºprepareé˜¶æ®µä¹‹åã€å†™binlogä¹‹å‰ï¼Œå‘ç”Ÿäº†å´©æºƒï¼ˆcrashï¼‰ï¼Œç”±äºæ­¤æ—¶binlogè¿˜æ²¡å†™ï¼Œredo logä¹Ÿè¿˜æ²¡æäº¤ï¼Œæ‰€ä»¥å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹åŠ¡ä¼šå›æ»šã€‚è¿™æ—¶å€™ï¼Œbinlogè¿˜æ²¡å†™ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šä¼ åˆ°å¤‡åº“ã€‚åˆ°è¿™é‡Œï¼Œå¤§å®¶éƒ½å¯ä»¥ç†è§£ã€‚</p><p>å¤§å®¶å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œä¸»è¦é›†ä¸­åœ¨æ—¶åˆ»Bï¼Œä¹Ÿå°±æ˜¯binlogå†™å®Œï¼Œredo logè¿˜æ²¡commitå‰å‘ç”Ÿcrashï¼Œé‚£å´©æºƒæ¢å¤çš„æ—¶å€™MySQLä¼šæ€ä¹ˆå¤„ç†ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å´©æºƒæ¢å¤æ—¶çš„åˆ¤æ–­è§„åˆ™ã€‚</p><ol>\n<li>\n<p>å¦‚æœredo logé‡Œé¢çš„äº‹åŠ¡æ˜¯å®Œæ•´çš„ï¼Œä¹Ÿå°±æ˜¯å·²ç»æœ‰äº†commitæ ‡è¯†ï¼Œåˆ™ç›´æ¥æäº¤ï¼›</p>\n</li>\n<li>\n<p>å¦‚æœredo logé‡Œé¢çš„äº‹åŠ¡åªæœ‰å®Œæ•´çš„prepareï¼Œåˆ™åˆ¤æ–­å¯¹åº”çš„äº‹åŠ¡binlogæ˜¯å¦å­˜åœ¨å¹¶å®Œæ•´ï¼š<br>\na.  å¦‚æœæ˜¯ï¼Œåˆ™æäº¤äº‹åŠ¡ï¼›<br>\nb.  å¦åˆ™ï¼Œå›æ»šäº‹åŠ¡ã€‚</p>\n</li>\n</ol><p>è¿™é‡Œï¼Œæ—¶åˆ»Bå‘ç”Ÿcrashå¯¹åº”çš„å°±æ˜¯2(a)çš„æƒ…å†µï¼Œå´©æºƒæ¢å¤è¿‡ç¨‹ä¸­äº‹åŠ¡ä¼šè¢«æäº¤ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬ç»§ç»­å»¶å±•ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚</p><h2>è¿½é—®1ï¼šMySQLæ€ä¹ˆçŸ¥é“binlogæ˜¯å®Œæ•´çš„?</h2><p>å›ç­”ï¼šä¸€ä¸ªäº‹åŠ¡çš„binlogæ˜¯æœ‰å®Œæ•´æ ¼å¼çš„ï¼š</p><ul>\n<li>statementæ ¼å¼çš„binlogï¼Œæœ€åä¼šæœ‰COMMITï¼›</li>\n<li>rowæ ¼å¼çš„binlogï¼Œæœ€åä¼šæœ‰ä¸€ä¸ªXID eventã€‚</li>\n</ul><p>å¦å¤–ï¼Œåœ¨MySQL 5.6.2ç‰ˆæœ¬ä»¥åï¼Œè¿˜å¼•å…¥äº†binlog-checksumå‚æ•°ï¼Œç”¨æ¥éªŒè¯binlogå†…å®¹çš„æ­£ç¡®æ€§ã€‚å¯¹äºbinlogæ—¥å¿—ç”±äºç£ç›˜åŸå› ï¼Œå¯èƒ½ä¼šåœ¨æ—¥å¿—ä¸­é—´å‡ºé”™çš„æƒ…å†µï¼ŒMySQLå¯ä»¥é€šè¿‡æ ¡éªŒchecksumçš„ç»“æœæ¥å‘ç°ã€‚æ‰€ä»¥ï¼ŒMySQLè¿˜æ˜¯æœ‰åŠæ³•éªŒè¯äº‹åŠ¡binlogçš„å®Œæ•´æ€§çš„ã€‚</p><h2>è¿½é—®2ï¼šredo log å’Œ binlogæ˜¯æ€ä¹ˆå…³è”èµ·æ¥çš„?</h2><p>å›ç­”ï¼šå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„æ•°æ®å­—æ®µï¼Œå«XIDã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œä¼šæŒ‰é¡ºåºæ‰«æredo logï¼š</p><ul>\n<li>å¦‚æœç¢°åˆ°æ—¢æœ‰prepareã€åˆæœ‰commitçš„redo logï¼Œå°±ç›´æ¥æäº¤ï¼›</li>\n<li>å¦‚æœç¢°åˆ°åªæœ‰parepareã€è€Œæ²¡æœ‰commitçš„redo logï¼Œå°±æ‹¿ç€XIDå»binlogæ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚</li>\n</ul><h2>è¿½é—®3ï¼šå¤„äºprepareé˜¶æ®µçš„redo logåŠ ä¸Šå®Œæ•´binlogï¼Œé‡å¯å°±èƒ½æ¢å¤ï¼ŒMySQLä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡?</h2><p>å›ç­”ï¼šå…¶å®ï¼Œè¿™ä¸ªé—®é¢˜è¿˜æ˜¯è·Ÿæˆ‘ä»¬åœ¨åè¯æ³•ä¸­è¯´åˆ°çš„æ•°æ®ä¸å¤‡ä»½çš„ä¸€è‡´æ€§æœ‰å…³ã€‚åœ¨æ—¶åˆ»Bï¼Œä¹Ÿå°±æ˜¯binlogå†™å®Œä»¥åMySQLå‘ç”Ÿå´©æºƒï¼Œè¿™æ—¶å€™binlogå·²ç»å†™å…¥äº†ï¼Œä¹‹åå°±ä¼šè¢«ä»åº“ï¼ˆæˆ–è€…ç”¨è¿™ä¸ªbinlogæ¢å¤å‡ºæ¥çš„åº“ï¼‰ä½¿ç”¨ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ä¸»åº“ä¸Šä¹Ÿè¦æäº¤è¿™ä¸ªäº‹åŠ¡ã€‚é‡‡ç”¨è¿™ä¸ªç­–ç•¥ï¼Œä¸»åº“å’Œå¤‡åº“çš„æ•°æ®å°±ä¿è¯äº†ä¸€è‡´æ€§ã€‚</p><h2>è¿½é—®4ï¼šå¦‚æœè¿™æ ·çš„è¯ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¸¤é˜¶æ®µæäº¤å‘¢ï¼Ÿå¹²è„†å…ˆredo logå†™å®Œï¼Œå†å†™binlogã€‚å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œå¿…é¡»å¾—ä¸¤ä¸ªæ—¥å¿—éƒ½å®Œæ•´æ‰å¯ä»¥ã€‚æ˜¯ä¸æ˜¯ä¸€æ ·çš„é€»è¾‘ï¼Ÿ</h2><p>å›ç­”ï¼šå…¶å®ï¼Œä¸¤é˜¶æ®µæäº¤æ˜¯ç»å…¸çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ï¼Œå¹¶ä¸æ˜¯MySQLç‹¬æœ‰çš„ã€‚</p><p>å¦‚æœå¿…é¡»è¦ä¸¾ä¸€ä¸ªåœºæ™¯ï¼Œæ¥è¯´æ˜è¿™ä¹ˆåšçš„å¿…è¦æ€§çš„è¯ï¼Œé‚£å°±æ˜¯äº‹åŠ¡çš„æŒä¹…æ€§é—®é¢˜ã€‚</p><p>å¯¹äºInnoDBå¼•æ“æ¥è¯´ï¼Œå¦‚æœredo logæäº¤å®Œæˆäº†ï¼Œäº‹åŠ¡å°±ä¸èƒ½å›æ»šï¼ˆå¦‚æœè¿™è¿˜å…è®¸å›æ»šï¼Œå°±å¯èƒ½è¦†ç›–æ‰åˆ«çš„äº‹åŠ¡çš„æ›´æ–°ï¼‰ã€‚è€Œå¦‚æœredo logç›´æ¥æäº¤ï¼Œç„¶åbinlogå†™å…¥çš„æ—¶å€™å¤±è´¥ï¼ŒInnoDBåˆå›æ»šä¸äº†ï¼Œæ•°æ®å’Œbinlogæ—¥å¿—åˆä¸ä¸€è‡´äº†ã€‚</p><p>ä¸¤é˜¶æ®µæäº¤å°±æ˜¯ä¸ºäº†ç»™æ‰€æœ‰äººä¸€ä¸ªæœºä¼šï¼Œå½“æ¯ä¸ªäººéƒ½è¯´â€œæˆ‘okâ€çš„æ—¶å€™ï¼Œå†ä¸€èµ·æäº¤ã€‚</p><h2>è¿½é—®5ï¼šä¸å¼•å…¥ä¸¤ä¸ªæ—¥å¿—ï¼Œä¹Ÿå°±æ²¡æœ‰ä¸¤é˜¶æ®µæäº¤çš„å¿…è¦äº†ã€‚åªç”¨binlogæ¥æ”¯æŒå´©æºƒæ¢å¤ï¼Œåˆèƒ½æ”¯æŒå½’æ¡£ï¼Œä¸å°±å¯ä»¥äº†ï¼Ÿ</h2><p>å›ç­”ï¼šè¿™ä½åŒå­¦çš„æ„æ€æ˜¯ï¼Œåªä¿ç•™binlogï¼Œç„¶åå¯ä»¥æŠŠæäº¤æµç¨‹æ”¹æˆè¿™æ ·ï¼šâ€¦ -&gt; â€œæ•°æ®æ›´æ–°åˆ°å†…å­˜â€ -&gt; â€œå†™ binlogâ€ -&gt; â€œæäº¤äº‹åŠ¡â€ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æä¾›å´©æºƒæ¢å¤çš„èƒ½åŠ›ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä¸å¯ä»¥ã€‚</p><p>å¦‚æœè¯´<strong>å†å²åŸå› </strong>çš„è¯ï¼Œé‚£å°±æ˜¯InnoDBå¹¶ä¸æ˜¯MySQLçš„åŸç”Ÿå­˜å‚¨å¼•æ“ã€‚MySQLçš„åŸç”Ÿå¼•æ“æ˜¯MyISAMï¼Œè®¾è®¡ä¹‹åˆå°±æœ‰æ²¡æœ‰æ”¯æŒå´©æºƒæ¢å¤ã€‚</p><p>InnoDBåœ¨ä½œä¸ºMySQLçš„æ’ä»¶åŠ å…¥MySQLå¼•æ“å®¶æ—ä¹‹å‰ï¼Œå°±å·²ç»æ˜¯ä¸€ä¸ªæä¾›äº†å´©æºƒæ¢å¤å’Œäº‹åŠ¡æ”¯æŒçš„å¼•æ“äº†ã€‚</p><p>InnoDBæ¥å…¥äº†MySQLåï¼Œå‘ç°æ—¢ç„¶binlogæ²¡æœ‰å´©æºƒæ¢å¤çš„èƒ½åŠ›ï¼Œé‚£å°±ç”¨InnoDBåŸæœ‰çš„redo logå¥½äº†ã€‚</p><p>è€Œå¦‚æœè¯´<strong>å®ç°ä¸Šçš„åŸå› </strong>çš„è¯ï¼Œå°±æœ‰å¾ˆå¤šäº†ã€‚å°±æŒ‰ç…§é—®é¢˜ä¸­è¯´çš„ï¼Œåªç”¨binlogæ¥å®ç°å´©æºƒæ¢å¤çš„æµç¨‹ï¼Œæˆ‘ç”»äº†ä¸€å¼ ç¤ºæ„å›¾ï¼Œè¿™é‡Œå°±æ²¡æœ‰redo logäº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/eb/63/eb838b87e9c20fa00aca50ef154f2a63.jpg?wh=1142*856\" alt=\"\"></p><center><span class=\"reference\">å›¾2 åªç”¨binlogæ”¯æŒå´©æºƒæ¢å¤</span></center><p>è¿™æ ·çš„æµç¨‹ä¸‹ï¼Œbinlogè¿˜æ˜¯ä¸èƒ½æ”¯æŒå´©æºƒæ¢å¤çš„ã€‚æˆ‘è¯´ä¸€ä¸ªä¸æ”¯æŒçš„ç‚¹å§ï¼šbinlogæ²¡æœ‰èƒ½åŠ›æ¢å¤â€œæ•°æ®é¡µâ€ã€‚</p><p>å¦‚æœåœ¨å›¾ä¸­æ ‡çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯binlog2å†™å®Œäº†ï¼Œä½†æ˜¯æ•´ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰commitçš„æ—¶å€™ï¼ŒMySQLå‘ç”Ÿäº†crashã€‚</p><p>é‡å¯åï¼Œå¼•æ“å†…éƒ¨äº‹åŠ¡2ä¼šå›æ»šï¼Œç„¶ååº”ç”¨binlog2å¯ä»¥è¡¥å›æ¥ï¼›ä½†æ˜¯å¯¹äºäº‹åŠ¡1æ¥è¯´ï¼Œç³»ç»Ÿå·²ç»è®¤ä¸ºæäº¤å®Œæˆäº†ï¼Œä¸ä¼šå†åº”ç”¨ä¸€æ¬¡binlog1ã€‚</p><p>ä½†æ˜¯ï¼ŒInnoDBå¼•æ“ä½¿ç”¨çš„æ˜¯WALæŠ€æœ¯ï¼Œæ‰§è¡Œäº‹åŠ¡çš„æ—¶å€™ï¼Œå†™å®Œå†…å­˜å’Œæ—¥å¿—ï¼Œäº‹åŠ¡å°±ç®—å®Œæˆäº†ã€‚å¦‚æœä¹‹åå´©æºƒï¼Œè¦ä¾èµ–äºæ—¥å¿—æ¥æ¢å¤æ•°æ®é¡µã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´åœ¨å›¾ä¸­è¿™ä¸ªä½ç½®å‘ç”Ÿå´©æºƒçš„è¯ï¼Œäº‹åŠ¡1ä¹Ÿæ˜¯å¯èƒ½ä¸¢å¤±äº†çš„ï¼Œè€Œä¸”æ˜¯æ•°æ®é¡µçº§çš„ä¸¢å¤±ã€‚æ­¤æ—¶ï¼Œbinlogé‡Œé¢å¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ›´æ–°ç»†èŠ‚ï¼Œæ˜¯è¡¥ä¸å›æ¥çš„ã€‚</p><p>ä½ å¦‚æœè¦è¯´ï¼Œé‚£æˆ‘ä¼˜åŒ–ä¸€ä¸‹binlogçš„å†…å®¹ï¼Œè®©å®ƒæ¥è®°å½•æ•°æ®é¡µçš„æ›´æ”¹å¯ä»¥å—ï¼Ÿä½†ï¼Œè¿™å…¶å®å°±æ˜¯åˆåšäº†ä¸€ä¸ªredo logå‡ºæ¥ã€‚</p><p>æ‰€ä»¥ï¼Œè‡³å°‘ç°åœ¨çš„binlogèƒ½åŠ›ï¼Œè¿˜ä¸èƒ½æ”¯æŒå´©æºƒæ¢å¤ã€‚</p><h2>è¿½é—®6ï¼šé‚£èƒ½ä¸èƒ½åè¿‡æ¥ï¼Œåªç”¨redo logï¼Œä¸è¦binlogï¼Ÿ</h2><p>å›ç­”ï¼šå¦‚æœåªä»å´©æºƒæ¢å¤çš„è§’åº¦æ¥è®²æ˜¯å¯ä»¥çš„ã€‚ä½ å¯ä»¥æŠŠbinlogå…³æ‰ï¼Œè¿™æ ·å°±æ²¡æœ‰ä¸¤é˜¶æ®µæäº¤äº†ï¼Œä½†ç³»ç»Ÿä¾ç„¶æ˜¯crash-safeçš„ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä½ äº†è§£ä¸€ä¸‹ä¸šç•Œå„ä¸ªå…¬å¸çš„ä½¿ç”¨åœºæ™¯çš„è¯ï¼Œå°±ä¼šå‘ç°åœ¨æ­£å¼çš„ç”Ÿäº§åº“ä¸Šï¼Œbinlogéƒ½æ˜¯å¼€ç€çš„ã€‚å› ä¸ºbinlogæœ‰ç€redo logæ— æ³•æ›¿ä»£çš„åŠŸèƒ½ã€‚</p><p>ä¸€ä¸ªæ˜¯å½’æ¡£ã€‚redo logæ˜¯å¾ªç¯å†™ï¼Œå†™åˆ°æœ«å°¾æ˜¯è¦å›åˆ°å¼€å¤´ç»§ç»­å†™çš„ã€‚è¿™æ ·å†å²æ—¥å¿—æ²¡æ³•ä¿ç•™ï¼Œredo logä¹Ÿå°±èµ·ä¸åˆ°å½’æ¡£çš„ä½œç”¨ã€‚</p><p>ä¸€ä¸ªå°±æ˜¯MySQLç³»ç»Ÿä¾èµ–äºbinlogã€‚binlogä½œä¸ºMySQLä¸€å¼€å§‹å°±æœ‰çš„åŠŸèƒ½ï¼Œè¢«ç”¨åœ¨äº†å¾ˆå¤šåœ°æ–¹ã€‚å…¶ä¸­ï¼ŒMySQLç³»ç»Ÿé«˜å¯ç”¨çš„åŸºç¡€ï¼Œå°±æ˜¯binlogå¤åˆ¶ã€‚</p><p>è¿˜æœ‰å¾ˆå¤šå…¬å¸æœ‰å¼‚æ„ç³»ç»Ÿï¼ˆæ¯”å¦‚ä¸€äº›æ•°æ®åˆ†æç³»ç»Ÿï¼‰ï¼Œè¿™äº›ç³»ç»Ÿå°±é æ¶ˆè´¹MySQLçš„binlogæ¥æ›´æ–°è‡ªå·±çš„æ•°æ®ã€‚å…³æ‰binlogçš„è¯ï¼Œè¿™äº›ä¸‹æ¸¸ç³»ç»Ÿå°±æ²¡æ³•è¾“å…¥äº†ã€‚</p><p>æ€»ä¹‹ï¼Œç”±äºç°åœ¨åŒ…æ‹¬MySQLé«˜å¯ç”¨åœ¨å†…çš„å¾ˆå¤šç³»ç»Ÿæœºåˆ¶éƒ½ä¾èµ–äºbinlogï¼Œæ‰€ä»¥â€œé¸ å é¹Šå·¢â€redo logè¿˜åšä¸åˆ°ã€‚ä½ çœ‹ï¼Œå‘å±•ç”Ÿæ€æ˜¯å¤šä¹ˆé‡è¦ã€‚</p><h2>è¿½é—®7ï¼šredo logä¸€èˆ¬è®¾ç½®å¤šå¤§ï¼Ÿ</h2><p>å›ç­”ï¼šredo logå¤ªå°çš„è¯ï¼Œä¼šå¯¼è‡´å¾ˆå¿«å°±è¢«å†™æ»¡ï¼Œç„¶åä¸å¾—ä¸å¼ºè¡Œåˆ·redo logï¼Œè¿™æ ·WALæœºåˆ¶çš„èƒ½åŠ›å°±å‘æŒ¥ä¸å‡ºæ¥äº†ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœæ˜¯ç°åœ¨å¸¸è§çš„å‡ ä¸ªTBçš„ç£ç›˜çš„è¯ï¼Œå°±ä¸è¦å¤ªå°æ°”äº†ï¼Œç›´æ¥å°†redo logè®¾ç½®ä¸º4ä¸ªæ–‡ä»¶ã€æ¯ä¸ªæ–‡ä»¶1GBå§ã€‚</p><h2>è¿½é—®8ï¼šæ­£å¸¸è¿è¡Œä¸­çš„å®ä¾‹ï¼Œæ•°æ®å†™å…¥åçš„æœ€ç»ˆè½ç›˜ï¼Œæ˜¯ä»redo logæ›´æ–°è¿‡æ¥çš„è¿˜æ˜¯ä»buffer poolæ›´æ–°è¿‡æ¥çš„å‘¢ï¼Ÿ</h2><p>å›ç­”ï¼šè¿™ä¸ªé—®é¢˜å…¶å®é—®å¾—éå¸¸å¥½ã€‚è¿™é‡Œæ¶‰åŠåˆ°äº†ï¼Œâ€œredo logé‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ã€‚</p><p>å®é™…ä¸Šï¼Œredo logå¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„å®Œæ•´æ•°æ®ï¼Œæ‰€ä»¥å®ƒå¹¶æ²¡æœ‰èƒ½åŠ›è‡ªå·±å»æ›´æ–°ç£ç›˜æ•°æ®é¡µï¼Œä¹Ÿå°±ä¸å­˜åœ¨â€œæ•°æ®æœ€ç»ˆè½ç›˜ï¼Œæ˜¯ç”±redo logæ›´æ–°è¿‡å»â€çš„æƒ…å†µã€‚</p><ol>\n<li>\n<p>å¦‚æœæ˜¯æ­£å¸¸è¿è¡Œçš„å®ä¾‹çš„è¯ï¼Œæ•°æ®é¡µè¢«ä¿®æ”¹ä»¥åï¼Œè·Ÿç£ç›˜çš„æ•°æ®é¡µä¸ä¸€è‡´ï¼Œç§°ä¸ºè„é¡µã€‚æœ€ç»ˆæ•°æ®è½ç›˜ï¼Œå°±æ˜¯æŠŠå†…å­˜ä¸­çš„æ•°æ®é¡µå†™ç›˜ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œç”šè‡³ä¸redo logæ¯«æ— å…³ç³»ã€‚</p>\n</li>\n<li>\n<p>åœ¨å´©æºƒæ¢å¤åœºæ™¯ä¸­ï¼ŒInnoDBå¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Œå°±ä¼šå°†å®ƒè¯»åˆ°å†…å­˜ï¼Œç„¶åè®©redo logæ›´æ–°å†…å­˜å†…å®¹ã€‚æ›´æ–°å®Œæˆåï¼Œå†…å­˜é¡µå˜æˆè„é¡µï¼Œå°±å›åˆ°äº†ç¬¬ä¸€ç§æƒ…å†µçš„çŠ¶æ€ã€‚</p>\n</li>\n</ol><h2>è¿½é—®9ï¼šredo log bufferæ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å…ˆä¿®æ”¹å†…å­˜ï¼Œè¿˜æ˜¯å…ˆå†™redo logæ–‡ä»¶ï¼Ÿ</h2><p>å›ç­”ï¼šè¿™ä¸¤ä¸ªé—®é¢˜å¯ä»¥ä¸€èµ·å›ç­”ã€‚</p><p>åœ¨ä¸€ä¸ªäº‹åŠ¡çš„æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæ—¥å¿—æ˜¯è¦å†™å¤šæ¬¡çš„ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªäº‹åŠ¡ï¼š</p><pre><code>begin;\ninsert into t1 ...\ninsert into t2 ...\ncommit;\n</code></pre><p>è¿™ä¸ªäº‹åŠ¡è¦å¾€ä¸¤ä¸ªè¡¨ä¸­æ’å…¥è®°å½•ï¼Œæ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ—¥å¿—éƒ½å¾—å…ˆä¿å­˜èµ·æ¥ï¼Œä½†åˆä¸èƒ½åœ¨è¿˜æ²¡commitçš„æ—¶å€™å°±ç›´æ¥å†™åˆ°redo logæ–‡ä»¶é‡Œã€‚</p><p>æ‰€ä»¥ï¼Œredo log bufferå°±æ˜¯ä¸€å—å†…å­˜ï¼Œç”¨æ¥å…ˆå­˜redoæ—¥å¿—çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªinsertçš„æ—¶å€™ï¼Œæ•°æ®çš„å†…å­˜è¢«ä¿®æ”¹äº†ï¼Œredo log bufferä¹Ÿå†™å…¥äº†æ—¥å¿—ã€‚</p><p>ä½†æ˜¯ï¼ŒçœŸæ­£æŠŠæ—¥å¿—å†™åˆ°redo logæ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œcommitè¯­å¥çš„æ—¶å€™åšçš„ã€‚</p><p>ï¼ˆè¿™é‡Œè¯´çš„æ˜¯äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šâ€œä¸»åŠ¨å»åˆ·ç›˜â€ï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„IOæ¶ˆè€—ã€‚ä½†æ˜¯å¯èƒ½ä¼šå‡ºç°â€œè¢«åŠ¨å†™å…¥ç£ç›˜â€ï¼Œæ¯”å¦‚å†…å­˜ä¸å¤Ÿã€å…¶ä»–äº‹åŠ¡æäº¤ç­‰æƒ…å†µã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¼šåœ¨åé¢ç¬¬22ç¯‡æ–‡ç« ã€ŠMySQLæœ‰å“ªäº›â€œé¥®é¸©æ­¢æ¸´â€çš„æé«˜æ€§èƒ½çš„æ–¹æ³•ï¼Ÿã€‹ä¸­å†è¯¦ç»†å±•å¼€ï¼‰ã€‚</p><p>å•ç‹¬æ‰§è¡Œä¸€ä¸ªæ›´æ–°è¯­å¥çš„æ—¶å€™ï¼ŒInnoDBä¼šè‡ªå·±å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨è¯­å¥æ‰§è¡Œå®Œæˆçš„æ—¶å€™æäº¤ã€‚è¿‡ç¨‹è·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ˜¯â€œå‹ç¼©â€åˆ°äº†ä¸€ä¸ªè¯­å¥é‡Œé¢å®Œæˆã€‚</p><p>ä»¥ä¸Šè¿™äº›é—®é¢˜ï¼Œå°±æ˜¯æŠŠå¤§å®¶æè¿‡çš„å…³äºredo logå’Œbinlogçš„é—®é¢˜ä¸²èµ·æ¥ï¼Œåšçš„ä¸€æ¬¡é›†ä¸­å›ç­”ã€‚å¦‚æœä½ è¿˜æœ‰é—®é¢˜ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºç»§ç»­ç•™è¨€è¡¥å……ã€‚</p><h1>ä¸šåŠ¡è®¾è®¡é—®é¢˜</h1><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å†å’Œä½ åˆ†äº«@ithunter åŒå­¦åœ¨ç¬¬8ç¯‡æ–‡ç« <a href=\"https://time.geekbang.org/column/article/70562\">ã€Š</a><a href=\"https://time.geekbang.org/column/article/70562\">äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„ï¼Ÿ</a><a href=\"https://time.geekbang.org/column/article/70562\">ã€‹</a>çš„è¯„è®ºåŒºæåˆ°çš„è·Ÿç´¢å¼•ç›¸å…³çš„ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘è§‰å¾—è¿™ä¸ªé—®é¢˜æŒºæœ‰è¶£ã€ä¹ŸæŒºå®ç”¨çš„ï¼Œå…¶ä»–åŒå­¦ä¹Ÿå¯èƒ½ä¼šç¢°ä¸Šè¿™æ ·çš„åœºæ™¯ï¼Œåœ¨è¿™é‡Œè§£ç­”å’Œåˆ†äº«ä¸€ä¸‹ã€‚</p><p>é—®é¢˜æ˜¯è¿™æ ·çš„ï¼ˆæˆ‘æ–‡å­—ä¸Šç¨å¾®åšäº†ç‚¹ä¿®æ”¹ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ï¼‰ï¼š</p><blockquote>\n<p>ä¸šåŠ¡ä¸Šæœ‰è¿™æ ·çš„éœ€æ±‚ï¼ŒAã€Bä¸¤ä¸ªç”¨æˆ·ï¼Œå¦‚æœäº’ç›¸å…³æ³¨ï¼Œåˆ™æˆä¸ºå¥½å‹ã€‚è®¾è®¡ä¸Šæ˜¯æœ‰ä¸¤å¼ è¡¨ï¼Œä¸€ä¸ªæ˜¯likeè¡¨ï¼Œä¸€ä¸ªæ˜¯friendè¡¨ï¼Œlikeè¡¨æœ‰user_idã€liker_idä¸¤ä¸ªå­—æ®µï¼Œæˆ‘è®¾ç½®ä¸ºå¤åˆå”¯ä¸€ç´¢å¼•å³uk_user_id_liker_idã€‚è¯­å¥æ‰§è¡Œé€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>\n</blockquote><blockquote>\n<p>ä»¥Aå…³æ³¨Bä¸ºä¾‹ï¼š<br>\nç¬¬ä¸€æ­¥ï¼Œå…ˆæŸ¥è¯¢å¯¹æ–¹æœ‰æ²¡æœ‰å…³æ³¨è‡ªå·±ï¼ˆBæœ‰æ²¡æœ‰å…³æ³¨Aï¼‰<br>\nselect * from like where user_id = B and liker_id = A;</p>\n</blockquote><blockquote>\n<p>å¦‚æœæœ‰ï¼Œåˆ™æˆä¸ºå¥½å‹<br>\ninsert into friend;</p>\n</blockquote><blockquote>\n<p>æ²¡æœ‰ï¼Œåˆ™åªæ˜¯å•å‘å…³æ³¨å…³ç³»<br>\ninsert into like;</p>\n</blockquote><blockquote>\n<p>ä½†æ˜¯å¦‚æœAã€BåŒæ—¶å…³æ³¨å¯¹æ–¹ï¼Œä¼šå‡ºç°ä¸ä¼šæˆä¸ºå¥½å‹çš„æƒ…å†µã€‚å› ä¸ºä¸Šé¢ç¬¬1æ­¥ï¼ŒåŒæ–¹éƒ½æ²¡å…³æ³¨å¯¹æ–¹ã€‚ç¬¬1æ­¥å³ä½¿ä½¿ç”¨äº†æ’ä»–é”ä¹Ÿä¸è¡Œï¼Œå› ä¸ºè®°å½•ä¸å­˜åœ¨ï¼Œè¡Œé”æ— æ³•ç”Ÿæ•ˆã€‚è¯·é—®è¿™ç§æƒ…å†µï¼Œåœ¨MySQLé”å±‚é¢æœ‰æ²¡æœ‰åŠæ³•å¤„ç†ï¼Ÿ</p>\n</blockquote><p>é¦–å…ˆï¼Œæˆ‘è¦å…ˆèµä¸€ä¸‹è¿™æ ·çš„æé—®æ–¹å¼ã€‚è™½ç„¶æå®¢æ—¶é—´ç°åœ¨çš„è¯„è®ºåŒºè¿˜ä¸èƒ½è¿½åŠ è¯„è®ºï¼Œä½†å¦‚æœå¤§å®¶èƒ½å¤Ÿä¸€æ¬¡ç•™è¨€å°±æŠŠé—®é¢˜è®²æ¸…æ¥šçš„è¯ï¼Œå…¶å®å½±å“ä¹Ÿä¸å¤§ã€‚æ‰€ä»¥ï¼Œæˆ‘å¸Œæœ›ä½ åœ¨ç•™è¨€æé—®çš„æ—¶å€™ï¼Œä¹Ÿèƒ½å€Ÿé‰´è¿™ç§æ–¹å¼ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘æŠŠ@ithunter åŒå­¦è¯´çš„è¡¨æ¨¡æ‹Ÿå‡ºæ¥ï¼Œæ–¹ä¾¿æˆ‘ä»¬è®¨è®ºã€‚</p><pre><code>CREATE TABLE `like` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `user_id` int(11) NOT NULL,\n  `liker_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_user_id_liker_id` (`user_id`,`liker_id`)\n) ENGINE=InnoDB;\n\nCREATE TABLE `friend` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `friend_1_id` int(11) NOT NULL,\n  `friend_2_id` int(11) NOT NULL,\n  UNIQUE KEY `uk_friend` (`friend_1_id`,`friend_2_id`),\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB;\n</code></pre><p>è™½ç„¶è¿™ä¸ªé¢˜å¹²ä¸­ï¼Œå¹¶æ²¡æœ‰è¯´åˆ°friendè¡¨çš„ç´¢å¼•ç»“æ„ã€‚ä½†æˆ‘çŒœæµ‹friend_1_idå’Œfriend_2_idä¹Ÿæœ‰ç´¢å¼•ï¼Œä¸ºä¾¿äºæè¿°ï¼Œæˆ‘ç»™åŠ ä¸Šå”¯ä¸€ç´¢å¼•ã€‚</p><p>é¡ºä¾¿è¯´æ˜ä¸€ä¸‹ï¼Œâ€œlikeâ€æ˜¯å…³é”®å­—ï¼Œæˆ‘ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨å…³é”®å­—ä½œä¸ºåº“åã€è¡¨åã€å­—æ®µåæˆ–ç´¢å¼•åã€‚</p><p>æˆ‘æŠŠä»–çš„ç–‘é—®ç¿»è¯‘ä¸€ä¸‹ï¼Œåœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼ŒåŒæ—¶æœ‰ä¸¤ä¸ªäººï¼Œè®¾ç½®ä¸ºå…³æ³¨å¯¹æ–¹ï¼Œå°±å¯èƒ½å¯¼è‡´æ— æ³•æˆåŠŸåŠ ä¸ºæœ‹å‹å…³ç³»ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ç”¨ä½ å·²ç»ç†Ÿæ‚‰çš„æ—¶åˆ»é¡ºåºè¡¨çš„å½¢å¼ï¼ŒæŠŠè¿™ä¸¤ä¸ªäº‹åŠ¡çš„æ‰§è¡Œè¯­å¥åˆ—å‡ºæ¥ï¼š<br>\n<img src=\"https://static001.geekbang.org/resource/image/c4/ed/c45063baf1ae521bf5d98b6d7c0e0ced.png?wh=1248*694\" alt=\"\"></p><center><span class=\"reference\">å›¾3 å¹¶å‘â€œå–œæ¬¢â€é€»è¾‘æ“ä½œé¡ºåº</span></center><p>ç”±äºä¸€å¼€å§‹Aå’ŒBä¹‹é—´æ²¡æœ‰å…³æ³¨å…³ç³»ï¼Œæ‰€ä»¥ä¸¤ä¸ªäº‹åŠ¡é‡Œé¢çš„selectè¯­å¥æŸ¥å‡ºæ¥çš„ç»“æœéƒ½æ˜¯ç©ºã€‚</p><p>å› æ­¤ï¼Œsession 1çš„é€»è¾‘å°±æ˜¯â€œæ—¢ç„¶Bæ²¡æœ‰å…³æ³¨Aï¼Œé‚£å°±åªæ’å…¥ä¸€ä¸ªå•å‘å…³æ³¨å…³ç³»â€ã€‚session 2ä¹ŸåŒæ ·æ˜¯è¿™ä¸ªé€»è¾‘ã€‚</p><p>è¿™ä¸ªç»“æœå¯¹ä¸šåŠ¡æ¥è¯´å°±æ˜¯bugäº†ã€‚å› ä¸ºåœ¨ä¸šåŠ¡è®¾å®šé‡Œé¢ï¼Œè¿™ä¸¤ä¸ªé€»è¾‘éƒ½æ‰§è¡Œå®Œæˆä»¥åï¼Œæ˜¯åº”è¯¥åœ¨friendè¡¨é‡Œé¢æ’å…¥ä¸€è¡Œè®°å½•çš„ã€‚</p><p>å¦‚æé—®é‡Œé¢è¯´çš„ï¼Œâ€œç¬¬1æ­¥å³ä½¿ä½¿ç”¨äº†æ’ä»–é”ä¹Ÿä¸è¡Œï¼Œå› ä¸ºè®°å½•ä¸å­˜åœ¨ï¼Œè¡Œé”æ— æ³•ç”Ÿæ•ˆâ€ã€‚ä¸è¿‡ï¼Œæˆ‘æƒ³åˆ°äº†å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œè¦ç»™â€œlikeâ€è¡¨å¢åŠ ä¸€ä¸ªå­—æ®µï¼Œæ¯”å¦‚å«ä½œ relation_shipï¼Œå¹¶è®¾ä¸ºæ•´å‹ï¼Œå–å€¼1ã€2ã€3ã€‚</p><blockquote>\n<p>å€¼æ˜¯1çš„æ—¶å€™ï¼Œè¡¨ç¤ºuser_id å…³æ³¨ liker_id;<br>\nå€¼æ˜¯2çš„æ—¶å€™ï¼Œè¡¨ç¤ºliker_id å…³æ³¨ user_id;<br>\nå€¼æ˜¯3çš„æ—¶å€™ï¼Œè¡¨ç¤ºäº’ç›¸å…³æ³¨ã€‚</p>\n</blockquote><p>ç„¶åï¼Œå½“ Aå…³æ³¨Bçš„æ—¶å€™ï¼Œé€»è¾‘æ”¹æˆå¦‚ä¸‹æ‰€ç¤ºçš„æ ·å­ï¼š</p><p>åº”ç”¨ä»£ç é‡Œé¢ï¼Œæ¯”è¾ƒAå’ŒBçš„å¤§å°ï¼Œå¦‚æœA&lt;Bï¼Œå°±æ‰§è¡Œä¸‹é¢çš„é€»è¾‘</p><pre><code>mysql&gt; begin; /*å¯åŠ¨äº‹åŠ¡*/\ninsert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1;\nselect relation_ship from `like` where user_id=A and liker_id=B;\n/*ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_shipï¼Œ\n  å¦‚æœæ˜¯1ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit\n  å¦‚æœæ˜¯3ï¼Œåˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥ï¼š\n  */\ninsert ignore into friend(friend_1_id, friend_2_id) values(A,B);\ncommit;\n</code></pre><p>å¦‚æœA&gt;Bï¼Œåˆ™æ‰§è¡Œä¸‹é¢çš„é€»è¾‘</p><pre><code>mysql&gt; begin; /*å¯åŠ¨äº‹åŠ¡*/\ninsert into `like`(user_id, liker_id, relation_ship) values(B, A, 2) on duplicate key update relation_ship=relation_ship | 2;\nselect relation_ship from `like` where user_id=B and liker_id=A;\n/*ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_shipï¼Œ\n  å¦‚æœæ˜¯2ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit\n  å¦‚æœæ˜¯3ï¼Œåˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥ï¼š\n*/\ninsert ignore into friend(friend_1_id, friend_2_id) values(B,A);\ncommit;\n</code></pre><p>è¿™ä¸ªè®¾è®¡é‡Œï¼Œè®©â€œlikeâ€è¡¨é‡Œçš„æ•°æ®ä¿è¯user_id &lt; liker_idï¼Œè¿™æ ·ä¸è®ºæ˜¯Aå…³æ³¨Bï¼Œè¿˜æ˜¯Bå…³æ³¨Aï¼Œåœ¨æ“ä½œâ€œlikeâ€è¡¨çš„æ—¶å€™ï¼Œå¦‚æœåå‘çš„å…³ç³»å·²ç»å­˜åœ¨ï¼Œå°±ä¼šå‡ºç°è¡Œé”å†²çªã€‚</p><p>ç„¶åï¼Œinsert â€¦ on duplicateè¯­å¥ï¼Œç¡®ä¿äº†åœ¨äº‹åŠ¡å†…éƒ¨ï¼Œæ‰§è¡Œäº†è¿™ä¸ªSQLè¯­å¥åï¼Œå°±å¼ºè¡Œå ä½äº†è¿™ä¸ªè¡Œé”ï¼Œä¹‹åçš„select åˆ¤æ–­relation_shipè¿™ä¸ªé€»è¾‘æ—¶å°±ç¡®ä¿äº†æ˜¯åœ¨è¡Œé”ä¿æŠ¤ä¸‹çš„è¯»æ“ä½œã€‚</p><p>æ“ä½œç¬¦ â€œ|â€ æ˜¯æŒ‰ä½æˆ–ï¼Œè¿åŒæœ€åä¸€å¥insertè¯­å¥é‡Œçš„ignoreï¼Œæ˜¯ä¸ºäº†ä¿è¯é‡å¤è°ƒç”¨æ—¶çš„å¹‚ç­‰æ€§ã€‚</p><p>è¿™æ ·ï¼Œå³ä½¿åœ¨åŒæ–¹â€œåŒæ—¶â€æ‰§è¡Œå…³æ³¨æ“ä½œï¼Œæœ€ç»ˆæ•°æ®åº“é‡Œçš„ç»“æœï¼Œä¹Ÿæ˜¯likeè¡¨é‡Œé¢æœ‰ä¸€æ¡å…³äºAå’ŒBçš„è®°å½•ï¼Œè€Œä¸”relation_shipçš„å€¼æ˜¯3ï¼Œ å¹¶ä¸”friendè¡¨é‡Œé¢ä¹Ÿæœ‰äº†Aå’ŒBçš„è¿™æ¡è®°å½•ã€‚</p><p>ä¸çŸ¥é“ä½ ä¼šä¸ä¼šåæ§½ï¼šä¹‹å‰æ˜æ˜è¿˜è¯´å°½é‡ä¸è¦ä½¿ç”¨å”¯ä¸€ç´¢å¼•ï¼Œç»“æœè¿™ä¸ªä¾‹å­ä¸€ä¸Šæ¥æˆ‘å°±åˆ›å»ºäº†ä¸¤ä¸ªã€‚è¿™é‡Œæˆ‘è¦å†å’Œä½ è¯´æ˜ä¸€ä¸‹ï¼Œä¹‹å‰æ–‡ç« æˆ‘ä»¬è®¨è®ºçš„ï¼Œæ˜¯åœ¨â€œä¸šåŠ¡å¼€å‘ä¿è¯ä¸ä¼šæ’å…¥é‡å¤è®°å½•â€çš„æƒ…å†µä¸‹ï¼Œç€é‡è¦è§£å†³æ€§èƒ½é—®é¢˜çš„æ—¶å€™ï¼Œæ‰å»ºè®®å°½é‡ä½¿ç”¨æ™®é€šç´¢å¼•ã€‚</p><p>è€Œåƒè¿™ä¸ªä¾‹å­é‡Œï¼ŒæŒ‰ç…§è¿™ä¸ªè®¾è®¡ï¼Œä¸šåŠ¡æ ¹æœ¬å°±æ˜¯ä¿è¯â€œæˆ‘ä¸€å®šä¼šæ’å…¥é‡å¤æ•°æ®ï¼Œæ•°æ®åº“ä¸€å®šè¦è¦æœ‰å”¯ä¸€æ€§çº¦æŸâ€ï¼Œè¿™æ—¶å°±æ²¡å•¥å¥½è¯´çš„äº†ï¼Œå”¯ä¸€ç´¢å¼•å»ºèµ·æ¥å§ã€‚</p><h1>å°ç»“</h1><p>è¿™æ˜¯ä¸“æ çš„ç¬¬ä¸€ç¯‡ç­”ç–‘æ–‡ç« ã€‚</p><p>æˆ‘é’ˆå¯¹å‰14ç¯‡æ–‡ç« ï¼Œå¤§å®¶åœ¨è¯„è®ºåŒºä¸­çš„ç•™è¨€ï¼Œä»ä¸­æ‘˜å–äº†å…³äºæ—¥å¿—å’Œç´¢å¼•çš„ç›¸å…³é—®é¢˜ï¼Œä¸²æˆäº†ä»Šå¤©è¿™ç¯‡æ–‡ç« ã€‚è¿™é‡Œæˆ‘ä¹Ÿè¦å†å’Œä½ è¯´ä¸€å£°ï¼Œæœ‰äº›æˆ‘ç­”åº”åœ¨ç­”ç–‘æ–‡ç« ä¸­è¿›è¡Œæ‰©å±•çš„è¯é¢˜ï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« æ²¡æ¥å¾—åŠæ‰©å±•ï¼Œåç»­æˆ‘ä¼šå†æ‰¾æœºä¼šä¸ºä½ è§£ç­”ã€‚æ‰€ä»¥ï¼Œç¯‡å¹…æ‰€é™ï¼Œè¯„è®ºåŒºè§å§ã€‚</p><p>æœ€åï¼Œè™½ç„¶è¿™ç¯‡æ˜¯ç­”ç–‘æ–‡ç« ï¼Œä½†è¯¾åé—®é¢˜è¿˜æ˜¯è¦æœ‰çš„ã€‚</p><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„è¡¨tï¼Œå¹¶æ’å…¥ä¸€è¡Œï¼Œç„¶åå¯¹è¿™ä¸€è¡Œåšä¿®æ”¹ã€‚</p><pre><code>mysql&gt; CREATE TABLE `t` (\n`id` int(11) NOT NULL primary key auto_increment,\n`a` int(11) DEFAULT NULL\n) ENGINE=InnoDB;\ninsert into t values(1,2);\n</code></pre><p>è¿™æ—¶å€™ï¼Œè¡¨té‡Œæœ‰å”¯ä¸€çš„ä¸€è¡Œæ•°æ®(1,2)ã€‚å‡è®¾ï¼Œæˆ‘ç°åœ¨è¦æ‰§è¡Œï¼š</p><pre><code>mysql&gt; update t set a=2 where id=1;\n</code></pre><p>ä½ ä¼šçœ‹åˆ°è¿™æ ·çš„ç»“æœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/36/70/367b3f299b94353f32f75ea825391170.png?wh=691*103\" alt=\"\"><br>\nç»“æœæ˜¾ç¤ºï¼ŒåŒ¹é…(rows matched)äº†ä¸€è¡Œï¼Œä¿®æ”¹(Changed)äº†0è¡Œã€‚</p><p>ä»…ä»ç°è±¡ä¸Šçœ‹ï¼ŒMySQLå†…éƒ¨åœ¨å¤„ç†è¿™ä¸ªå‘½ä»¤çš„æ—¶å€™ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ç§é€‰æ‹©ï¼š</p><ol>\n<li>\n<p>æ›´æ–°éƒ½æ˜¯å…ˆè¯»åå†™çš„ï¼ŒMySQLè¯»å‡ºæ•°æ®ï¼Œå‘ç°açš„å€¼æœ¬æ¥å°±æ˜¯2ï¼Œä¸æ›´æ–°ï¼Œç›´æ¥è¿”å›ï¼Œæ‰§è¡Œç»“æŸï¼›</p>\n</li>\n<li>\n<p>MySQLè°ƒç”¨äº†InnoDBå¼•æ“æä¾›çš„â€œä¿®æ”¹ä¸º(1,2)â€è¿™ä¸ªæ¥å£ï¼Œä½†æ˜¯å¼•æ“å‘ç°å€¼ä¸åŸæ¥ç›¸åŒï¼Œä¸æ›´æ–°ï¼Œç›´æ¥è¿”å›ï¼›</p>\n</li>\n<li>\n<p>InnoDBè®¤çœŸæ‰§è¡Œäº†â€œæŠŠè¿™ä¸ªå€¼ä¿®æ”¹æˆ(1,2)\"è¿™ä¸ªæ“ä½œï¼Œè¯¥åŠ é”çš„åŠ é”ï¼Œè¯¥æ›´æ–°çš„æ›´æ–°ã€‚</p>\n</li>\n</ol><p>ä½ è§‰å¾—å®é™…æƒ…å†µä¼šæ˜¯ä»¥ä¸Šå“ªç§å‘¢ï¼Ÿä½ å¯å¦ç”¨æ„é€ å®éªŒçš„æ–¹å¼ï¼Œæ¥è¯æ˜ä½ çš„ç»“è®ºï¼Ÿè¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥æ€è€ƒä¸€ä¸‹ï¼ŒMySQLä¸ºä»€ä¹ˆè¦é€‰æ‹©è¿™ç§ç­–ç•¥å‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ çš„éªŒè¯æ–¹æ³•å’Œæ€è€ƒå†™åœ¨ç•™è¨€åŒºé‡Œï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« çš„æœ«å°¾å’Œä½ è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸçš„é—®é¢˜æ˜¯ï¼Œç”¨ä¸€ä¸ªè®¡æ•°è¡¨è®°å½•ä¸€ä¸ªä¸šåŠ¡è¡¨çš„æ€»è¡Œæ•°ï¼Œåœ¨å¾€ä¸šåŠ¡è¡¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œéœ€è¦ç»™è®¡æ•°å€¼åŠ 1ã€‚</p><p>é€»è¾‘å®ç°ä¸Šæ˜¯å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰§è¡Œä¸¤ä¸ªè¯­å¥ï¼š</p><ol>\n<li>\n<p>insert into æ•°æ®è¡¨ï¼›</p>\n</li>\n<li>\n<p>update è®¡æ•°è¡¨ï¼Œè®¡æ•°å€¼åŠ 1ã€‚</p>\n</li>\n</ol><p>ä»ç³»ç»Ÿå¹¶å‘èƒ½åŠ›çš„è§’åº¦è€ƒè™‘ï¼Œæ€ä¹ˆå®‰æ’è¿™ä¸¤ä¸ªè¯­å¥çš„é¡ºåºã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ç›´æ¥å¤åˆ¶ @é˜¿å»º çš„å›ç­”è¿‡æ¥ä¾›ä½ å‚è€ƒï¼š</p><blockquote>\n<p>å¹¶å‘ç³»ç»Ÿæ€§èƒ½çš„è§’åº¦è€ƒè™‘ï¼Œåº”è¯¥å…ˆæ’å…¥æ“ä½œè®°å½•ï¼Œå†æ›´æ–°è®¡æ•°è¡¨ã€‚<br>\nçŸ¥è¯†ç‚¹åœ¨<a href=\"https://time.geekbang.org/column/article/70215\">ã€Šè¡Œé”åŠŸè¿‡ï¼šæ€ä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“ï¼Ÿã€‹</a><br>\nå› ä¸ºæ›´æ–°è®¡æ•°è¡¨æ¶‰åŠåˆ°è¡Œé”çš„ç«äº‰ï¼Œå…ˆæ’å…¥å†æ›´æ–°èƒ½æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº‹åŠ¡ä¹‹é—´çš„é”ç­‰å¾…ï¼Œæå‡å¹¶å‘åº¦ã€‚</p>\n</blockquote><p>è¯„è®ºåŒºæœ‰åŒå­¦è¯´ï¼Œåº”è¯¥æŠŠupdateè®¡æ•°è¡¨æ”¾åé¢ï¼Œå› ä¸ºè¿™ä¸ªè®¡æ•°è¡¨å¯èƒ½ä¿å­˜äº†å¤šä¸ªä¸šåŠ¡è¡¨çš„è®¡æ•°å€¼ã€‚å¦‚æœæŠŠupdateè®¡æ•°è¡¨æ”¾åˆ°äº‹åŠ¡çš„ç¬¬ä¸€ä¸ªè¯­å¥ï¼Œå¤šä¸ªä¸šåŠ¡è¡¨åŒæ—¶æ’å…¥æ•°æ®çš„è¯ï¼Œç­‰å¾…æ—¶é—´ä¼šæ›´é•¿ã€‚</p><p>è¿™ä¸ªç­”æ¡ˆçš„ç»“è®ºæ˜¯å¯¹çš„ï¼Œä½†æ˜¯ç†è§£ä¸å¤ªæ­£ç¡®ã€‚å³ä½¿æˆ‘ä»¬ç”¨ä¸€ä¸ªè®¡æ•°è¡¨è®°å½•å¤šä¸ªä¸šåŠ¡è¡¨çš„è¡Œæ•°ï¼Œä¹Ÿè‚¯å®šä¼šç»™è¡¨åå­—æ®µåŠ å”¯ä¸€ç´¢å¼•ã€‚ç±»ä¼¼äºä¸‹é¢è¿™æ ·çš„è¡¨ç»“æ„ï¼š</p><pre><code>CREATE TABLE `rows_stat` (\n  `table_name` varchar(64) NOT NULL,\n  `row_count` int(10) unsigned NOT NULL,\n  PRIMARY KEY (`table_name`)\n) ENGINE=InnoDB;\n</code></pre><p>åœ¨æ›´æ–°è®¡æ•°è¡¨çš„æ—¶å€™ï¼Œä¸€å®šä¼šä¼ å…¥where table_name=$table_nameï¼Œä½¿ç”¨ä¸»é”®ç´¢å¼•ï¼Œæ›´æ–°åŠ è¡Œé”åªä¼šé”åœ¨ä¸€è¡Œä¸Šã€‚</p><p>è€Œåœ¨ä¸åŒä¸šåŠ¡è¡¨æ’å…¥æ•°æ®ï¼Œæ˜¯æ›´æ–°ä¸åŒçš„è¡Œï¼Œä¸ä¼šæœ‰è¡Œé”ã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>\n<p>@åŒ—å¤©é­”ç‹¼ã€@æ–œé¢é•œå­ Bil å’Œ@Bin ç­‰åŒå­¦ï¼Œéƒ½ç»™å‡ºäº†æ­£ç¡®ç­”æ¡ˆï¼›<br>\n@æœç„¶å¦‚æ­¤ åŒå­¦æäº†ä¸€ä¸ªå¥½é—®é¢˜ï¼Œè™½ç„¶å¼•å…¥äº‹åŠ¡ï¼Œé¿å…çœ‹åˆ°â€ä¸šåŠ¡ä¸Šè¿˜æ²¡æäº¤çš„æ›´æ–°â€ï¼Œä½†æ˜¯Redisçš„è®¡æ•°è¢«æå‰çœ‹åˆ°äº†ã€‚æ ¸å¿ƒåŸå› è¿˜æ˜¯ä¸¤ä¸ªç³»ç»Ÿï¼Œä¸æ”¯æŒä¸€è‡´æ€§è§†å›¾ï¼›<br>\n@ å¸†å¸†å¸†å¸†å¸†å¸†å¸†å¸† åŒå­¦çš„é—®é¢˜æé†’äº†å¤§å®¶ï¼Œcount(id)ä¹Ÿæ˜¯å¯ä»¥èµ°æ™®é€šç´¢å¼•å¾—åˆ°çš„ã€‚</p>\n</blockquote>","comments":[{"had_liked":false,"id":50628,"user_name":"è¤ç«è™«","can_delete":false,"product_type":"c1","uid":1333142,"ip_address":"","ucode":"FA4AB9636C53C4","user_header":"https://static001.geekbang.org/account/avatar/00/14/57/96/b65bdf43.jpg","comment_is_top":true,"comment_ctime":1545017865,"is_pvip":false,"replies":[{"id":"18172","content":"åŠ æ²¹ã€‚<br><br>è¯´ä¸‹æˆ‘è‡ªå·±çš„ç†è§£ã€‚<br><br>æˆ‘åœ¨å¸¦æ–°äººçš„æ—¶å€™ï¼Œè¦æ±‚å¤§å®¶åœ¨å†™SQLè¯­å¥çš„æ—¶å€™ï¼Œå¿ƒé‡Œæ˜¯æœ‰æ•°çš„ï¼ŒçŸ¥é“æ¯ä¸ªè¯­å¥æ‰§è¡Œçš„ç»“æœï¼Œä»¥åŠè¿™äº›ä»£ç ä¼šæ¶ˆè€—ä»€ä¹ˆèµ„æºã€å¦‚æœæ…¢äº†ä¼šæ…¢åœ¨å“ªé‡Œã€æ¯ä¸ªè¯­å¥æ‰§è¡Œä¼šå ç”¨å“ªäº›é”ç­‰ç­‰ã€‚<br><br>æœ‰çš„æ–°äººä¼šé—®â€œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆéº»çƒ¦ï¼Œæˆ‘æ‰§è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹ç»“æœå¯¹ä¸å¯¹ï¼Œå¯¹äº†å°±è¡Œï¼Œä¸å¯¹å°±æ”¹ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ï¼Ÿâ€<br><br>æˆ‘è¯´ä¸å¯ä»¥ã€‚å› ä¸ºå¦‚æœè¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¼šå—åˆ°å¾ˆå¤šå±€é™ï¼Œå³ä½¿æˆ‘ä»¬å®šä½è‡ªå·±æ˜¯ä¸šåŠ¡å¼€å‘äººå‘˜ã€‚<br><br>è¿™é‡Œæˆ‘è¯´ä¸€ä¸ªé™åˆ¶ï¼š<br><br>è¿™ä¼šé™åˆ¶åŸºäºæ•°æ®åº“çš„ä¸šåŠ¡æ¶æ„èƒ½åŠ›ã€‚ä¸€ä¸ªè¯­å¥å¯ä»¥è¯•ï¼Œä¸€ä¸ªäº”ä¸ªè¯­å¥çš„äº‹åŠ¡åˆ†æå°±è¦è¯•å¾ˆå¤šæ¬¡ï¼Œä¸€ä¸ªå¤æ‚ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®åº“è®¾è®¡ï¼Œæ˜¯è¯•ä¸å‡ºæ¥çš„ã€‚<br><br>åŸç†å¯ä»¥å¸®æˆ‘ä»¬å‰ªæï¼Œæ’é™¤æ‰é‚£äº›ç†è®ºä¸Šæ˜æ˜¾é”™è¯¯çš„æ–¹æ¡ˆï¼Œè¿™æ ·æ‰æœ‰ç²¾åŠ›çœŸçš„å»è¯•é‚£äº›æœ‰é™çš„ã€å¯èƒ½æ­£ç¡®çš„æ–¹æ¡ˆã€‚<br><br><br>æˆ‘ä»¬ä¸éœ€è¦100%ç²¾é€šMySQL(æˆ‘è‡ªå·±ç¦»è¿™ä¸ªç›®æ ‡ä¹Ÿç›¸å»ç”šè¿œï¼‰ï¼Œä½†æ˜¯åªè¦å¤šçŸ¥é“ä¸€äº›åŸç†ï¼Œå°±èƒ½å¤šå‰ªä¸€äº›æï¼Œæ¶æ„è®¾è®¡å°±èƒ½å°‘ä¸€äº›é”™è¯¯é€‰é¡¹çš„å¹²æ‰°ï¼Œè®¾è®¡å‡ºæ¥çš„é¡¹ç›®æ¶æ„æ­£ç¡®çš„å¯èƒ½æ€§æ›´é«˜ã€‚<br><br>æˆ‘è‡ªå·±ç‰¹åˆ«å–œæ¬¢è¿™ä¸ªå‰ªæçš„è¿‡ç¨‹å’Œæ„Ÿè§‰ï¼Œä»–è¡¨ç¤ºæˆ‘ç”¨ä»¥å‰å­¦ä¹ çš„æ—¶é—´ï¼Œæ¥èŠ‚çœäº†ç°åœ¨å·¥ä½œçš„æ—¶é—´ã€‚<br><br><br>å½“ç„¶ï¼Œâ€œåŸç†â€æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ¦‚å¿µï¼Œæœ‰çš„åŸç†æ›´æ¥è¿‘å®æˆ˜ï¼Œæœ‰çš„è¿œä¸€äº›ã€‚è¿™ä¸ªä¸“æ æˆ‘æŒ‘çš„æ˜¯è·Ÿå¹³æ—¶ä½¿ç”¨ç›¸å…³çš„åŸç†ï¼Œä»¥ä¾¿å¤§å®¶å¯ä»¥æœ‰æœºä¼šè¾¹å­¦è¾¹ç”¨ã€‚<br><br>ä¸€èµ·åŠ æ²¹å§ğŸ¤<br><br>","user_name":"ä½œè€…å›å¤","comment_id":50628,"uid":"1264162","ip_address":"","utype":1,"ctime":1545020674,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":15,"race_medal":0,"score":"9.2233741858834002e+18","product_id":100020801,"comment_content":"æ—è€å¸ˆçš„æ¯æ¬¡æ›´æ–°æˆ‘éƒ½ä¼šè·Ÿç€çœ‹ è·Ÿç€å­¦ å·²ç»åšæŒ15èŠ‚è¯¾äº† å—ç›Šè‰¯å¤š åªæ˜¯å¿ƒé‡Œæœ‰æ—¶ä¼šåé—®è‡ªå·± åº•å±‚åŸç†æœ‰é‚£ä¹ˆé‡è¦å—ï¼Ÿ ä¼šç”¨ä¸å°±è¡Œäº†å—ï¼Ÿ è‡ªå·±ä¸çŸ¥é“è¯¥æ€ä¹ˆæ¨ç¿»è¿™äº›æƒ³æ³• åŠ ä¸Šè‡ªå·±æœ‰ä¸ªä¸å¥½çš„ä¹ æƒ¯ å°±æ˜¯å®¹æ˜“æ”¾å¼ƒ å¸Œæœ›è‡ªå·±èƒ½å¤ŸåšæŒåˆ°æœ€åã€‚ ","like_count":501,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433041,"discussion_content":"åŠ æ²¹ã€‚\n\nè¯´ä¸‹æˆ‘è‡ªå·±çš„ç†è§£ã€‚\n\næˆ‘åœ¨å¸¦æ–°äººçš„æ—¶å€™ï¼Œè¦æ±‚å¤§å®¶åœ¨å†™SQLè¯­å¥çš„æ—¶å€™ï¼Œå¿ƒé‡Œæ˜¯æœ‰æ•°çš„ï¼ŒçŸ¥é“æ¯ä¸ªè¯­å¥æ‰§è¡Œçš„ç»“æœï¼Œä»¥åŠè¿™äº›ä»£ç ä¼šæ¶ˆè€—ä»€ä¹ˆèµ„æºã€å¦‚æœæ…¢äº†ä¼šæ…¢åœ¨å“ªé‡Œã€æ¯ä¸ªè¯­å¥æ‰§è¡Œä¼šå ç”¨å“ªäº›é”ç­‰ç­‰ã€‚\n\næœ‰çš„æ–°äººä¼šé—®â€œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆéº»çƒ¦ï¼Œæˆ‘æ‰§è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹ç»“æœå¯¹ä¸å¯¹ï¼Œå¯¹äº†å°±è¡Œï¼Œä¸å¯¹å°±æ”¹ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ï¼Ÿâ€\n\næˆ‘è¯´ä¸å¯ä»¥ã€‚å› ä¸ºå¦‚æœè¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¼šå—åˆ°å¾ˆå¤šå±€é™ï¼Œå³ä½¿æˆ‘ä»¬å®šä½è‡ªå·±æ˜¯ä¸šåŠ¡å¼€å‘äººå‘˜ã€‚\n\nè¿™é‡Œæˆ‘è¯´ä¸€ä¸ªé™åˆ¶ï¼š\n\nè¿™ä¼šé™åˆ¶åŸºäºæ•°æ®åº“çš„ä¸šåŠ¡æ¶æ„èƒ½åŠ›ã€‚ä¸€ä¸ªè¯­å¥å¯ä»¥è¯•ï¼Œä¸€ä¸ªäº”ä¸ªè¯­å¥çš„äº‹åŠ¡åˆ†æå°±è¦è¯•å¾ˆå¤šæ¬¡ï¼Œä¸€ä¸ªå¤æ‚ä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®åº“è®¾è®¡ï¼Œæ˜¯è¯•ä¸å‡ºæ¥çš„ã€‚\n\nåŸç†å¯ä»¥å¸®æˆ‘ä»¬å‰ªæï¼Œæ’é™¤æ‰é‚£äº›ç†è®ºä¸Šæ˜æ˜¾é”™è¯¯çš„æ–¹æ¡ˆï¼Œè¿™æ ·æ‰æœ‰ç²¾åŠ›çœŸçš„å»è¯•é‚£äº›æœ‰é™çš„ã€å¯èƒ½æ­£ç¡®çš„æ–¹æ¡ˆã€‚\n\n\næˆ‘ä»¬ä¸éœ€è¦100%ç²¾é€šMySQL(æˆ‘è‡ªå·±ç¦»è¿™ä¸ªç›®æ ‡ä¹Ÿç›¸å»ç”šè¿œï¼‰ï¼Œä½†æ˜¯åªè¦å¤šçŸ¥é“ä¸€äº›åŸç†ï¼Œå°±èƒ½å¤šå‰ªä¸€äº›æï¼Œæ¶æ„è®¾è®¡å°±èƒ½å°‘ä¸€äº›é”™è¯¯é€‰é¡¹çš„å¹²æ‰°ï¼Œè®¾è®¡å‡ºæ¥çš„é¡¹ç›®æ¶æ„æ­£ç¡®çš„å¯èƒ½æ€§æ›´é«˜ã€‚\n\næˆ‘è‡ªå·±ç‰¹åˆ«å–œæ¬¢è¿™ä¸ªå‰ªæçš„è¿‡ç¨‹å’Œæ„Ÿè§‰ï¼Œä»–è¡¨ç¤ºæˆ‘ç”¨ä»¥å‰å­¦ä¹ çš„æ—¶é—´ï¼Œæ¥èŠ‚çœäº†ç°åœ¨å·¥ä½œçš„æ—¶é—´ã€‚\n\n\nå½“ç„¶ï¼Œâ€œåŸç†â€æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ¦‚å¿µï¼Œæœ‰çš„åŸç†æ›´æ¥è¿‘å®æˆ˜ï¼Œæœ‰çš„è¿œä¸€äº›ã€‚è¿™ä¸ªä¸“æ æˆ‘æŒ‘çš„æ˜¯è·Ÿå¹³æ—¶ä½¿ç”¨ç›¸å…³çš„åŸç†ï¼Œä»¥ä¾¿å¤§å®¶å¯ä»¥æœ‰æœºä¼šè¾¹å­¦è¾¹ç”¨ã€‚\n\nä¸€èµ·åŠ æ²¹å§ğŸ¤\n\n","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1545020674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":1180967,"avatar":"https://static001.geekbang.org/account/avatar/00/12/05/27/36c74bcd.jpg","nickname":"æ¨æº¢","note":"","ucode":"AC8D8896B3AAE0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":573372,"discussion_content":"æ—è€å¸ˆçœŸçš„å¾ˆè€å¿ƒä¸”å‹å–„ï¼Œç‚¹èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653380081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":433041,"ip_address":""},"score":573372,"extra":""},{"author":{"id":1296063,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c6/bf/52b3f71d.jpg","nickname":"dawn","note":"","ucode":"1757B28F1EF5C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":583379,"discussion_content":"å‰ç«¯æœ‰ä¸€æœ¬ä¹¦å«ã€Šé”‹åˆ©çš„jequeryã€‹ï¼Œä½œè€…çš„è§‚ç‚¹æ˜¯å­¦çš„è¶Šå¤šï¼Œå†™çš„è¶Šå¿«ï¼Œè¿™åªæ˜¯é’ˆå¯¹ä¸€äº›ç®€å•çš„è¯­æ³•ç±»çš„çŸ¥è¯†ã€‚å½“é‡åˆ°å¤æ‚é—®é¢˜æ—¶ï¼Œæœ€è‰°éš¾çš„ä¸€æ­¥æ˜¯æ ¹æ®è¡¨è±¡æŠ½ä¸å‰¥èŒ§ï¼Œæ‰¾åˆ°çœŸæ­£çš„åŸå› ã€‚æŸå¤§å‹è§†é¢‘å…¬å¸ï¼Œæœç´¢æœåŠ¡æŒ‚äº†ï¼Œå¯¼è‡´é¦–é¡µå®¢æˆ·ç«¯æœç´¢éƒ½ä¸å¯ç”¨ï¼Œä¸€çœ‹æœç´¢çš„æœºå™¨cpuè¢«æ‰“æ»¡ï¼ŒæŒ‰ç…§ç»éªŒçœ‹æ˜¯å‡ºç°äº†æ­»å¾ªç¯ï¼Œä½†è¿™äº›æœåŠ¡æœ€è¿‘ä¸€ä¸ªæœˆéƒ½æ²¡æœ‰å‘ç‰ˆï¼Œåªæœ‰æœ€è¿‘ä¸‹æ¸¸å‘å¸ƒäº†ä¸ªå®éªŒï¼Œæœ€åæŸ¥å‡ºæ¥æ˜¯ä¸‹æ¸¸å®éªŒï¼Œåœ¨å¾ˆä½é¢‘çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰æŒ‰ç…§çº¦å®šä¼ é€’å‚æ•°ï¼Œå¯¼è‡´æœç´¢æœåŠ¡ä½¿ç”¨ä½ç§»æ“ä½œç¬¦æ— æ³•æ­£ç¡®é€€å‡ºï¼Œè¿›å…¥äº†æ­»å¾ªç¯ã€‚\n\nå›å¤´çœ‹çœŸç®€å•çš„åŸå› ï¼Œä½†å‘å¸ƒäº†ä¸¤æ¬¡ï¼ŒèŠ±äº†ä¸€å¤©ï¼Œæ‹‰äº†ä¸‰å››ä¸ªå›¢é˜Ÿæ‰çœŸæ­£è§£å†³ï¼Œè¿™æ˜¯ç”±ç”Ÿäº§ç¯å¢ƒå¤æ‚æ€§å†³å®šçš„ã€‚ä½ å¹¶ä¸çŸ¥é“ä½ éœ€è¦é¢å¯¹æ€æ ·ä¸€åœºç¡¬ä»—ï¼Œä½ å”¯ä¸€èƒ½åšçš„ï¼Œå°±æ˜¯ç£¨å¥½ä½ çš„åˆ€ã€‚å¦‚æœä½ ä¸æƒ³ä¸€åˆ°æˆ˜åœºå°±æ‰‹è¶³æ— æªè¢«ä¹±åˆ€ç æ­»ï¼Œäº¦æˆ–è€…ä½ æƒ³æˆä¸ºé‚£ä¸ªé—ªç€å…‰çš„ç”·äººï¼Œéƒ½è¯·ç»ƒå¥½åŸºæœ¬åŠŸã€‚\n","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1660089894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":433041,"ip_address":"æ±Ÿè‹"},"score":583379,"extra":""}]},{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4751,"discussion_content":"è¯´åˆ°åº•è¿˜æ˜¯é¢å¾—å°‘ã€‚ã€‚ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1565704570,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2014285,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKNv880TlsNuKaWcKbxiaAZTQIBWfJAddC8wfOROnwRPRwJXaEGSTBH2sic4jK7IGpxZn79tTDcREjw/132","nickname":"Geek_7482f6","note":"","ucode":"F3565F78525D30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407560,"discussion_content":"å“ˆå“ˆå“ˆå“ˆï¼ŒçœŸå®ã€‚ä¸è¿‡ä¹Ÿèƒ½ç†è§£å•Š~ç†è§£è¿™äº›åº•å±‚çŸ¥è¯†è¿˜æ˜¯å¾ˆè´¹åŠ›çš„å°¤å…¶æ˜¯å¹³æ—¶è¿˜æ˜¯996çš„æƒ…å†µä¸‹ï¼Œå‘å‘ç‰¢éªšè¿˜æ˜¯è›®æ­£å¸¸çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635059643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4751,"ip_address":""},"score":407560,"extra":""}]},{"author":{"id":1018620,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8a/fc/d1dd57dd.jpg","nickname":"ipofss","note":"","ucode":"DE3061C9259F9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203076,"discussion_content":"æˆ‘è¦èƒ½é‡åˆ°è€å¸ˆè¿™æ ·çš„å¸¦äººæ–¹å¼å°±å¤ªå¥½äº†","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1583992387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35799,"discussion_content":"â€œæˆ‘ç”¨ä»¥å‰å­¦ä¹ çš„æ—¶é—´ï¼Œæ¥èŠ‚çœäº†ç°åœ¨å·¥ä½œçš„æ—¶é—´â€ä½ æ‰€æœ‰çš„åŠªåŠ›ä½•å°ä¸æ˜¯å¦‚æ­¤å‘¢ï¼Ÿï¼ä»è®¢é˜…ä¸“æ åˆ°ä¸€ç›´åšæŒåˆ°ç°åœ¨ï¼Œå¯¹äºæ¯ä¸€è®²ä¸æ‡‚çš„åœ°æ–¹éƒ½æŸ¥çœ‹è¯„è®ºï¼Œå»ç½‘ä¸Šæœç´¢ï¼Œæ„Ÿè§‰è‡ªå·±äº†è§£äº†å¾ˆå¤šï¼æ„Ÿè°¢","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1571305685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1302228,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg","nickname":"David.cui","note":"","ucode":"AB46F310403612","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3793,"discussion_content":"ç°åœ¨ä¸å­¦ä¹ åŸç†ï¼Œä»¥åå°±ç­‰ç€åŸ‹å‘å§ã€‚æˆ‘é‡åˆ°ä¸€ä¸ªå®¢æˆ·ï¼Œdeleteäº†ä¸Šäº¿æ¡æ•°æ®ï¼›ä»–å±…ç„¶ä¸çŸ¥é“truncateã€‚åŒæ ·çš„åŠŸèƒ½å¯ä»¥å®ç°ï¼Œä½†æ˜¯ä»–ä¸ç†è§£deleteçš„ä»£ä»·æœ‰å¤šå¤§","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1564815060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2039257,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/1d/d9/746e45be.jpg","nickname":"é»„æ—¶æ·","note":"","ucode":"C9FC8F8812F7B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1302228,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg","nickname":"David.cui","note":"","ucode":"AB46F310403612","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292090,"discussion_content":"truncateä¸æ˜¯drop+createå— è·Ÿdeleteæœ‰ä»€ä¹ˆå…³ç³»?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595079504,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":3793,"ip_address":""},"score":292090,"extra":""},{"author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2039257,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/1d/d9/746e45be.jpg","nickname":"é»„æ—¶æ·","note":"","ucode":"C9FC8F8812F7B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299774,"discussion_content":"truncateå’Œdetele all æ•ˆæœç±»ä¼¼ TRUNCATE TABLE is similar to a DELETE statement that deletes all rows, or a sequence of DROP TABLE and CREATE TABLE statements.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597812894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292090,"ip_address":""},"score":299774,"extra":""}]},{"author":{"id":1683256,"avatar":"https://static001.geekbang.org/account/avatar/00/19/af/38/37301993.jpg","nickname":"çˆ±çš„æ—…é€”","note":"","ucode":"1184646EFBDCE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381084,"discussion_content":"å¦‚æœä½ ä¸€è¾ˆå­æƒ³åšä¸€ä¸ªç å†œï¼Œå°±ä¸ç”¨å­¦åŸç†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1624889047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1183672,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0f/b8/d10bc2d4.jpg","nickname":"Ppã€x","note":"","ucode":"9623E33BE20C1E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309415,"discussion_content":"è€å¸ˆçœŸå¥½è¯¶ï¼Œå¯æƒœç¼–ç è·¯ä¸Šæ²¡æœ‰é‡åˆ°è¿‡è‰¯å¸ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601283510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1834181,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/fc/c5/ff8b770e.jpg","nickname":"BugBean","note":"","ucode":"B51232281AD9BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258232,"discussion_content":"å¬è€å¸ˆè¿™æ ·è®²é˜”ç„¶å¼€æœ—ï¼Œæœç„¶è¯„è®ºåŒºæ˜¯æœ€å¤§çš„å®è—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1588668393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052821,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/95/17a9a042.jpg","nickname":"coco","note":"","ucode":"7BC3AB84E8434E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536694,"discussion_content":"å¤šå¥½çš„æŒ‡ç‚¹ï¼Œæˆ‘ä¹‹å‰é‡åˆ°çš„éƒ½æ˜¯ä½ ç®¡é‚£ä¹ˆå¤šå¹²å˜›ï¼Œå…ˆè¿™ä¹ˆå¼„ï¼Œä»¥åæœ‰é—®é¢˜å†è¯´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638846912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1032000,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bf/40/94eaca1b.jpg","nickname":"wei","note":"","ucode":"8B14D27AE7C54E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394047,"discussion_content":"m","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631697947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50743,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":true,"comment_ctime":1545037678,"is_pvip":false,"replies":[{"id":"18225","content":"è€æ¿çœ‹å®Œæ¿ï¼Œæ­£è¦å‘ŠçŸ¥å­”ä¹™å·±ä»Šæ—¥æ€»è´¦æ˜¯èµŠè´¦äºŒä¸¤é…’ï¼Œ<br>å°äºŒè¿å¿™è¿‡æ¥æ‹¦ä½ï¼Œâ€œè€æ¿ï¼Œåˆšåˆšå­”ä¹™å·±åˆšåˆèµŠè´¦äº†ä¸€ç¢ŸèŒ´é¦™è±†ã€‚â€<br>è€æ¿å¤§æƒŠï¼Œâ€œå·®ç‚¹äºäº†æˆ‘ä¸€ç¢Ÿè±†å­ï¼æˆ‘æ€ä¸çŸ¥ï¼Ÿâ€<br>å°äºŒé“ï¼Œâ€œè€æ¿ä½ æ–¹æ‰çœ‹æ¿çš„ä¹‹æ—¶æ²¡æ‹¿è®°è´¦ç¬”ï¼Œæˆ‘çœ‹è®°è´¦ç¬”æ²¡äººä½¿ç”¨ï¼ŒæŒ‰åº—è§„è‡ªç„¶å¯ç”¨ã€‚è€æ¿ä½ è‡ªå·±æ²¡çœ‹â€<br><br>è€æ¿æƒŠå‘¼ï¼Œâ€œäºçš„ä½ å°å¿ƒâ€ã€‚<br><br>æš—åœ°æƒ³åº—è§„ç¡®æœ‰ä¸å¦¥ã€‚<br><br>äºæ˜¯æŠŠåº—è§„â€œå˜è´¦é¡»ç”¨è®°è´¦ç¬”ã€‚â€ æ”¹ä¸º<br>â€œæ”¹å¸å‡é¡»åŠ¨ç¬”ã€‚çºµä¸ºä¸å˜ä¹‹å¸ï¼Œä»éœ€è¦†å†™ä¹‹â€<br><br>ğŸ˜„","user_name":"ä½œè€…å›å¤","comment_id":50743,"uid":"1264162","ip_address":"","utype":1,"ctime":1545051054,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":10,"race_medal":0,"score":"9.2233741815885005e+18","product_id":100020801,"comment_content":"å­”ä¹™å·±æ¥åˆ°é…’é¦†å¤§å–Šä¸€å£°è€æ¿æ¥äºŒä¸¤é…’èµŠç€,é…’é¦†ç”Ÿæ„å¤ªå¥½,è€æ¿æŠŠå­”ä¹™å·±çš„æ¬ è´¦è®°å½•è®°åˆ°å°é»‘æ¿ä¸Šå¹¶è®°å½•äº†å­”ä¹™å·±ç‚¹çš„èœå•ã€‚å­”ä¹™å·±è·Ÿåˆ«äººå¹äº†ä¼šç‰›,å¿˜äº†å«çš„å‡ ä¸¤é…’äº†ã€‚åˆç»™è€æ¿è¯´,è€æ¿æŠŠé…’æ”¹æˆäºŒä¸¤ã€‚è€æ¿ä¹Ÿä¸ç¡®å®šå­”ä¹™å·±å«æ²¡å«é…’,å°±å»æŸ¥èœå•,å‘ç°å­”ä¹™å·±ç¡®å®ç‚¹äº†é…’,ä½†æ˜¯æœ¬æ¥å°±äºŒä¸¤,ä¹Ÿå°±éš¾å¾—éº»çƒ¦äº†,åˆè¦ä¿®æ”¹å°é»‘æ¿,åˆè¦æ”¹èœå•ã€‚ç›´æ¥å°±ç»™å­”ä¹™å·±è¯´å·²ç»æ”¹å¥½äº†ã€‚ğŸ˜„","like_count":499,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433079,"discussion_content":"è€æ¿çœ‹å®Œæ¿ï¼Œæ­£è¦å‘ŠçŸ¥å­”ä¹™å·±ä»Šæ—¥æ€»è´¦æ˜¯èµŠè´¦äºŒä¸¤é…’ï¼Œ\nå°äºŒè¿å¿™è¿‡æ¥æ‹¦ä½ï¼Œâ€œè€æ¿ï¼Œåˆšåˆšå­”ä¹™å·±åˆšåˆèµŠè´¦äº†ä¸€ç¢ŸèŒ´é¦™è±†ã€‚â€\nè€æ¿å¤§æƒŠï¼Œâ€œå·®ç‚¹äºäº†æˆ‘ä¸€ç¢Ÿè±†å­ï¼æˆ‘æ€ä¸çŸ¥ï¼Ÿâ€\nå°äºŒé“ï¼Œâ€œè€æ¿ä½ æ–¹æ‰çœ‹æ¿çš„ä¹‹æ—¶æ²¡æ‹¿è®°è´¦ç¬”ï¼Œæˆ‘çœ‹è®°è´¦ç¬”æ²¡äººä½¿ç”¨ï¼ŒæŒ‰åº—è§„è‡ªç„¶å¯ç”¨ã€‚è€æ¿ä½ è‡ªå·±æ²¡çœ‹â€\n\nè€æ¿æƒŠå‘¼ï¼Œâ€œäºçš„ä½ å°å¿ƒâ€ã€‚\n\næš—åœ°æƒ³åº—è§„ç¡®æœ‰ä¸å¦¥ã€‚\n\näºæ˜¯æŠŠåº—è§„â€œå˜è´¦é¡»ç”¨è®°è´¦ç¬”ã€‚â€ æ”¹ä¸º\nâ€œæ”¹å¸å‡é¡»åŠ¨ç¬”ã€‚çºµä¸ºä¸å˜ä¹‹å¸ï¼Œä»éœ€è¦†å†™ä¹‹â€\n\nğŸ˜„","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1545051054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1806081,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/8f/01/2fbc5cc9.jpg","nickname":"xiaozeng","note":"","ucode":"C517E55357315C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293250,"discussion_content":"æœ‰æ„æ€ åŒç°§","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1595492343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1134574,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","nickname":"ä¸€é­„","note":"","ucode":"71541125D4AA5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1806081,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/8f/01/2fbc5cc9.jpg","nickname":"xiaozeng","note":"","ucode":"C517E55357315C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401123,"discussion_content":"åŒç°§æ˜¯ä¸€ä¸ªäººåå‰é¢æ— å£°æ¼”ï¼Œä¸€ä¸ªäººèº²åé¢è¯´ã€‚:)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1633572033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293250,"ip_address":""},"score":401123,"extra":""}]},{"author":{"id":2120690,"avatar":"","nickname":"é£é—´","note":"","ucode":"2DA14C209AD31F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404302,"discussion_content":"æ‰€ä»¥è€æ¿æœ€ç»ˆçš„é€‰æ‹©æ˜¯ 3ï¼","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1634284017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1136267,"avatar":"https://static001.geekbang.org/account/avatar/00/11/56/8b/6f547e7d.jpg","nickname":"Mercury","note":"","ucode":"AE7A9DA3591A74","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388732,"discussion_content":"ğŸ‘ï¼Œè¢«è€½è¯¯çš„å°è¯´å®¶ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628929177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1966594,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/fs63ENRylGMQnk5giaSic6m3gRmhcUEGdIQgaTjAsTWetcSicEsxTOdMiaVHUdxy3WNA4LJkZy1cJ69sEMKzJw5PHg/132","nickname":"ç„¡é“è€…","note":"","ucode":"59DEABFE838C12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361773,"discussion_content":"è¯»ä¹¦äººï¼","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1616748607,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1314724,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/a4/0b49469f.jpg","nickname":"æœ¨å­00","note":"","ucode":"8F78CA722EB29B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306712,"discussion_content":"å‰å®³ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600352406,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300785,"discussion_content":"ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤æ˜¯ä¸ä¼šè¦†å†™çš„ï¼Œä½†æ˜¯å¯ä»¥é…ç½®ä¸ºè¦†å†™","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598264103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1019302,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/a6/22c37c91.jpg","nickname":"æ¥Š_å®µå¤œ","note":"","ucode":"7BA0CADC5F23BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308602,"discussion_content":"å¿…é¡»è¦†å†™, äº‹åŠ¡1updateåŒä¸€æ—¶åˆ», äº‹åŠ¡2ä¹Ÿupdate, äº‹åŠ¡1, 2éƒ½å¿…é¡»æŠ¢é”, æ‰èƒ½æ‰§è¡Œå„è‡ªçš„updateé€»è¾‘, ä¸ç®¡updateé€»è¾‘æ˜¯ä»€ä¹ˆ, éƒ½å¿…é¡»æŠ¢é”å†update.","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1601003483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300785,"ip_address":""},"score":308602,"extra":""}]},{"author":{"id":2678569,"avatar":"https://static001.geekbang.org/account/avatar/00/28/df/29/3c956177.jpg","nickname":"ä¸Šæµ·","note":"","ucode":"6A4F9D80D25028","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410915,"discussion_content":"å¥½æ´»ğŸ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635814767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50756,"user_name":"Gavin","can_delete":false,"product_type":"c1","uid":1134148,"ip_address":"","ucode":"0C7C27BC2736B6","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/44/66450d97.jpg","comment_is_top":true,"comment_ctime":1545040026,"is_pvip":false,"replies":[{"id":"18202","content":"æ¼‚äº®","user_name":"ä½œè€…å›å¤","comment_id":50756,"uid":"1264162","ip_address":"","utype":1,"ctime":1545041335,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":16,"race_medal":0,"score":"9.2233730047675003e+18","product_id":100020801,"comment_content":"è¯¾åé—®é¢˜ï¼š<br>åœ¨å‘½ä»¤è¡Œå…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ³¨æ„ä¸è¦æäº¤äº‹åŠ¡ï¼‰ï¼š<br>BEGIN;<br>UPDATE t SET a=2 WHERE id=1;<br><br>æ–°å»ºä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br>UPDATE t SET a=2 WHERE id=1;<br><br>ä»æ–°å»ºçš„å‘½ä»¤è¡Œç»ˆç«¯çš„æ‰§è¡Œç»“æœçœ‹ï¼Œè¿™æ¡æ›´æ–°è¯­å¥è¢«é˜»å¡äº†ï¼Œå¦‚æœæ—¶é—´è¶³å¤Ÿçš„è¯ï¼ˆInnoDBè¡Œé”é»˜è®¤ç­‰å¾…æ—¶é—´æ˜¯50ç§’ï¼‰ï¼Œè¿˜ä¼šæŠ¥é”ç­‰å¾…è¶…æ—¶çš„é”™è¯¯ã€‚<br>ç»¼ä¸Šï¼ŒMySQLåº”è¯¥æ˜¯é‡‡ç”¨ç¬¬3ç§æ–¹å¼å¤„ç†é¢˜è¿°åœºæ™¯ã€‚<br><br>å¯¹äºMySQLä¸ºä»€ä¹ˆé‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ã€Š08 | äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„ï¼Ÿã€‹å›¾5çš„æ›´æ–°é€»è¾‘å›¾æ¥è§£é‡Šï¼šå‡è®¾äº‹åŠ¡Cæ›´æ–°åaçš„å€¼å°±æ˜¯2ï¼Œè€Œäº‹åŠ¡Bæ‰§è¡Œå†æ‰§è¡ŒUPDATE t SET a=2 WHERE id=1;æ—¶ä¸æŒ‰ç¬¬3ç§æ–¹å¼å¤„ç†ï¼Œå³ä¸åŠ é”ä¸æ›´æ–°ï¼Œé‚£ä¹ˆåœ¨äº‹åŠ¡Bä¸­æ¥ä¸‹æ¥æŸ¥è¯¢açš„å€¼å°†è¿˜æ˜¯1ï¼Œå› ä¸ºå¯¹äº‹åŠ¡Bæ¥è¯´ï¼Œtrx_idä¸º102ç‰ˆæœ¬çš„æ•°æ®æ˜¯ä¸å¯è§çš„ï¼Œè¿™å°±è¿åäº†â€œå½“å‰è¯»çš„è§„åˆ™â€ã€‚<br><br>ä»¥ä¸Šæ˜¯æˆ‘çš„ç†è§£ä¸åˆ†æï¼Œä¸æ˜¯å¾ˆç¡®å®šå‡†ç¡®ä¸å¦ã€‚<br>","like_count":225,"discussions":[{"author":{"id":1237327,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e1/4f/00476b4c.jpg","nickname":"Rememberä¹ç¦»","note":"","ucode":"97EE6E6344689F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278939,"discussion_content":"ä¸æ˜¯å¾ˆæ‡‚ aä¸€ç›´æ˜¯2å•Šï¼Œå°±ç®—æ²¡æ›´æ–° aåœ¨åˆ›å»ºçš„æ—¶å€™ä¸å°±æ˜¯2å—","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1591261421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1762602,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/e5/2a/38e4c07e.jpg","nickname":"ZHI","note":"","ucode":"573BB83EC7086D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1237327,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e1/4f/00476b4c.jpg","nickname":"Rememberä¹ç¦»","note":"","ucode":"97EE6E6344689F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534135,"discussion_content":"ä»–å‡è®¾çš„aåˆå§‹ç­‰äº1ï¼Œäº‹åŠ¡Bå’Œäº‹åŠ¡Céƒ½å»æ›´æ–°è¿™ä¸ªå€¼ï¼Œç›¸äº’éš”ç¦»ä½†å†…éƒ¨èƒ½çœ‹åˆ°è‡ªå·±çš„ä¿®æ”¹ï¼Œéƒ½èƒ½è¯»åˆ°2ã€‚æ‰€ä»¥ä¸¤ä¸ªäº‹åŠ¡éƒ½åˆ‡å®åšå‡ºäº†æ›´æ–°æ“ä½œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638105677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278939,"ip_address":""},"score":534135,"extra":""}]},{"author":{"id":2035912,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/10/c8/325f1463.jpg","nickname":"å«ç»ƒ","note":"","ucode":"ABAFDFE0FAFEA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287708,"discussion_content":"æ˜¯çš„ï¼Œå‡å¦‚å¼€å¯äº†äº‹åŠ¡Aï¼Œå†å¼€å¯äº‹åŠ¡B,äº‹åŠ¡Bæ›´æ–°äº†ä¸€æ¡æ•°æ®å¹¶æäº¤äº‹åŠ¡Bï¼Œæ­¤æ—¶äº‹åŠ¡Aæ˜¯çœ‹ä¸åˆ°Bæ›´æ–°çš„æ•°æ®ï¼Œé‚£äº‹åŠ¡æ€ä¹ˆæ ·æ‰èƒ½çœ‹çš„åˆ°å‘¢ï¼Ÿäº‹åŠ¡Aæ›´æ–°ï¼Œä¼šåœ¨Bçš„ç‰ˆæœ¬åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œç§°ä¸ºå½“å‰è¯»ï¼ˆå…¶å®ä¹Ÿå°±æ˜¯åœ¨Bçš„åŸºç¡€ä¸Šå†åŠ ç‰ˆæœ¬ï¼‰ï¼Œå›åˆ°é—®é¢˜ï¼Œå¦‚æœæ­¤æ—¶Açš„updateä¸æ›´æ–°ï¼Œç›¸å½“äºå°±ä¸ä¼šåˆ›å»ºç‰ˆæœ¬ï¼Œé‚£äº‹åŠ¡Açš„å€¼ï¼Œè¿˜æ˜¯åŸå€¼ï¼Œå®Œå…¨çœ‹ä¸åˆ°äº†ï¼Œmvccç‰ˆæœ¬å¤±æ•ˆ","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1593515883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1477324,"avatar":"https://static001.geekbang.org/account/avatar/00/16/8a/cc/da9adc82.jpg","nickname":"å°å¤ªé˜³","note":"","ucode":"3B1C90425E485D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2035912,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/10/c8/325f1463.jpg","nickname":"å«ç»ƒ","note":"","ucode":"ABAFDFE0FAFEA2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319452,"discussion_content":"ç®€å•æ€»ç»“å°±æ˜¯è¯´:å¦‚æœä¸æ›´æ–°ï¼Œä¼šä½¿å½“å‰è¯»å¤±æ•ˆ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1604033605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287708,"ip_address":""},"score":319452,"extra":""}]},{"author":{"id":1210699,"avatar":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","nickname":"-W.LI-","note":"","ucode":"3556786538664F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6966,"discussion_content":"å¤§ä½¬æ€ä¹ˆæ‰èƒ½å’Œä½ è¿™ä¹ˆä¼˜ç§€","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1567229463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328262,"discussion_content":"ç”¨æ›´æ–°è¯­å¥çš„å½“å‰è¯»ç‰¹æ€§æ¥æµ‹è¯•è¿™ä¸ªæ›´æ–°ï¼Œåˆ°åº•æ›´æ–°æ²¡æ›´æ–°ï¼Œå‰å®³å‘€~","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606113954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433085,"discussion_content":"æ¼‚äº®","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1545041335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1710489,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/19/99/ba3719e1.jpg","nickname":"The brain is a good thing","note":"","ucode":"7CE2C85BC5C092","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287642,"discussion_content":"MVCCçœ‹æ¥ç¡®å®å½±å“äº†å¾ˆå¤šç­–ç•¥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593502044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1263932,"avatar":"https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg","nickname":"é™é™è†å¬","note":"","ucode":"0A8600CB928EFE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287580,"discussion_content":"æ€ä¹ˆæ‰èƒ½åƒä½ è¿™ä¹ˆä¼˜ç§€ï¼Œå¤§ä½¬","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593485300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":114108,"discussion_content":"é‚£æ€ä¹ˆè§£é‡Š Changed: 0 å‘¢ ï¼Ÿ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577958239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":187623,"discussion_content":"æ›´æ–°è¯­å¥è¿”å›çš„å½±å“çš„è¡Œæ•°æ•°æ®ä¸€è‡´çš„è¯å°±æ˜¯0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582757922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":114108,"ip_address":""},"score":187623,"extra":""},{"author":{"id":1155646,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","nickname":"ppd0705","note":"","ucode":"EB63D4E3FD1E9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299775,"discussion_content":"è¯·é—®ä¸€è‡´æ˜¯æ€ä¹ˆåˆ¤æ–­çš„å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597813200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":187623,"ip_address":""},"score":299775,"extra":""}]},{"author":{"id":2135401,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/b24L6aN3myzq1dTibqq40yQWq8kj6OZRc3PFZUtKVcHl8x69DAPERZibbuUBGCK8ibUiaic7adhB42HTAOnc0PqUuPw/132","nickname":"Geek_92b6bb","note":"","ucode":"ECDBF12771D0D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300791,"discussion_content":"è¿™ä¸ªä¸éœ€è¦å…³æ³¨bin log æ˜¯row è¿˜æ˜¯ statementå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598264878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2843604,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/d4/b63373c3.jpg","nickname":"é‡‘é‡‘","note":"","ucode":"807EDDCDB2E939","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2135401,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/b24L6aN3myzq1dTibqq40yQWq8kj6OZRc3PFZUtKVcHl8x69DAPERZibbuUBGCK8ibUiaic7adhB42HTAOnc0PqUuPw/132","nickname":"Geek_92b6bb","note":"","ucode":"ECDBF12771D0D4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560757,"discussion_content":"éœ€è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649432109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":300791,"ip_address":""},"score":560757,"extra":""}]},{"author":{"id":1599454,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLOKzDVXse2WibsBGOR27GVYOlv8WRtFBfQe4ekNia2S5986QibD6Wv17gyDpZqmQt3kJcAcbhl3rroQ/132","nickname":"itsxun","note":"","ucode":"69E6CEA3FCB4F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285500,"discussion_content":"æ¼‚äº®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592845037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1672786,"avatar":"https://static001.geekbang.org/account/avatar/00/19/86/52/91c7d112.jpg","nickname":"Garen","note":"","ucode":"0608C88F83EF0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":33519,"discussion_content":"æˆ‘æ€è€ƒäº†ä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä¼šæ²¡æƒ³åˆ°ï¼šè¿˜æ˜¯å› ä¸ºæˆ‘æ€ç»´å¤ªç‹­çª„ï¼Œæ²¡æƒ³è¿‡å¤šäº‹åŠ¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571131142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51096,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":true,"comment_ctime":1545113514,"is_pvip":false,"replies":[{"id":"18417","content":"â€œæˆ‘è¯´ï¼Œè¿™æ¬¡æŸ¥äº†ç¼“å­˜â€<br><br>å“ˆå“ˆï¼Œè¿™ä¸ªåœºæ™¯å¥½æ£’ï¼Œè¿™ä¸ªç”»é¢æ„Ÿï¼Œæœ‰ä¸€ç§æ‰«åœ°åƒ§çš„æ„Ÿè§‰ğŸ‘ğŸ¿<br><br>ä¸€èµ·åŠ æ²¹<br><br>","user_name":"ä½œè€…å›å¤","comment_id":51096,"uid":"1264162","ip_address":"","utype":1,"ctime":1545116709,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":11,"race_medal":0,"score":"9.2233727212996997e+18","product_id":100020801,"comment_content":"çœ‹åˆ°è‡ªå·±çš„é—®é¢˜ä¸Šæ¦œï¼Œè¿™æ˜¯å¯¹è‡ªå·±çš„æœ€å¤§é¼“åŠ±ã€‚<br><br>å­¦ä¹ ä¸“æ ä¹‹å‰ï¼Œè‡ªå·±åªæ˜¯ä¸€ä¸ª CRUD boyï¼Œå¹³æ—¶åŒäº‹é—´è®¨è®º MySQL çš„é—®é¢˜ï¼Œè‡ªå·±å®Œå…¨æ­ä¸ä¸Šè¯ï¼Œå› ä¸ºå¯¹ MySQL åº•å±‚åŸç†å®Œå…¨ä¸æ‡‚ã€‚å¯¹ MySQL çš„è®¤çŸ¥å°±ä»…é™ä¸€ç‚¹ï¼šç´¢å¼•èƒ½æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆèƒ½æé«˜ï¼Ÿä¸çŸ¥é“ï¼ï¼<br><br>ç°åœ¨å›æƒ³ï¼Œä»¥å‰çŠ¯è¿‡å¾ˆå¤šé”™è¯¯ï¼š<br>1. ä¸»é”®ä½¿ç”¨ UUIDï¼Œéè‡ªå¢ä¸»é”®ã€‚<br>2. æ»¥ç”¨ç´¢å¼•ï¼Œå…¶å®å¯ä»¥é€šè¿‡â€œæœ€å·¦å‰ç¼€åŸåˆ™â€æ¥ç²¾å‡ç´¢å¼•ã€‚<br>3. ä¸ç®¡ SQL è¯­å¥æ˜¯å¦åˆç†ï¼Œåªè¦èƒ½è¿”å›ç»“æœé›†å°±æ˜¯å¥½ SQLã€‚<br>4. å»ºè¡¨æ—¶å­—æ®µç±»å‹æ‹¿æä¸å‡†ã€‚<br><br>ç°åœ¨éƒ½ä¼šåå¤å­¦ä¹ ä¸“æ çš„æ¯ä¸€ç¯‡æ–‡ç« ï¼Œæ¯æ¬¡å­¦ä¹ éƒ½æœ‰ä¸ä¸€æ ·çš„æ”¶è·ã€‚<br>ç¬¬ä¸€æ¬¡å¯èƒ½æ˜¯ï¼šå–”ï¼ŒåŸæ¥æœ‰è¿™ä¹ˆä¸ªçŸ¥è¯†ç‚¹ï¼Œä½†å¯¹å®ƒçš„å®ç°åŸç†ä¸€çŸ¥åŠè§£ã€‚<br>ç¬¬äºŒæ¬¡å´æ˜¯ï¼šå¯¹å®ƒçš„å®ç°åŸç†æœ‰äº†æ›´æ·±çš„è®¤è¯†ï¼ŒåŠ å¼ºå¯¹çŸ¥è¯†çš„ç†è§£ï¼ŒåŸºæœ¬ä¼šå½¢æˆä¸€ä¸ªæ¯”è¾ƒæ¸…æ™°çš„é€»è¾‘ã€‚<br>ç¬¬ä¸‰æ¬¡æ˜¯ï¼ŒMySQL çš„è¿™ç§å®ç°åŸç†ï¼Œæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ç­‰ç­‰ã€‚<br><br>ç°åœ¨æ„Ÿè§‰æœ‰ç‚¹â€œèµ°ç«å…¥é­”â€äº†ï¼Œä»¥å‰æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œå…³æ³¨çš„å¤šä¹…èƒ½è¿”å›ç»“æœé›†ã€‚<br>ç°åœ¨å…³æ³¨çš„å´æ˜¯ï¼šè¿æ¥å™¨ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨å’Œ InnoDB å¼•æ“ã€‚<br>è¿æ¥æˆåŠŸåï¼Œè·å–æˆ‘çš„æƒé™ï¼ŒæŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­ç¼“å­˜ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿›è¡Œåç»­çš„æ“ä½œã€‚ï¼ˆè®°å¾—è€å¸ˆç•™è¨€åŒºå›å¤è¿‡ï¼šè¿æ¥å™¨å–æƒé™ï¼Œæ‰§è¡Œå™¨ç”¨æƒé™ã€‚è€Œç¼–å†™ç•™è¨€åˆ°è¿™äº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼šæŸ¥è¯¢ç¼“å­˜å‰ï¼Œåº”è¯¥ä¼šæ ¡éªŒæƒé™ï¼Œæ‰€ä»¥è¿æ¥å™¨ä¹Ÿä¼šç”¨æƒé™ï¼Ÿï¼‰<br>åˆ†æå™¨é˜¶æ®µè¿›è¡Œè¯æ³•åˆ†æï¼Œè§£æå…³é”®å­—ï¼Œå­—æ®µåï¼Œè¡¨åç­‰ã€‚è¯­æ³•åˆ†æåˆ¤æ–­è¯­æ³•æ˜¯å¦æ­£ç¡®ã€‚ï¼ˆè®°å¾—ç¬¬ä¸€ç¯‡ã€ŠåŸºç¡€æ¶æ„ã€‹ç•™è¨€æåˆ°è¯­ä¹‰åˆ†æï¼Œä»Šæ™šè¦æ‰¾èµ„æ–™å­¦ä¹ ä¸‹ï¼‰ã€‚<br>ä¼˜åŒ–å™¨é˜¶æ®µç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œé€‰æ‹©ç´¢å¼•ï¼ˆè¿™æ—¶ä¼šæ€€ç–‘ MySQL é€‰æ‹©çš„ç´¢å¼•æ˜¯å¦æœ€ä¼˜ï¼‰ï¼Œèƒ½å¦ä½¿ç”¨ç´¢å¼•ä¸‹æ¨å’Œè¦†ç›–ç´¢å¼•å‡å°‘å›è¡¨æŸ¥è¯¢ï¼Œæé«˜æ€§èƒ½ã€‚<br>æ‰§è¡Œå™¨é˜¶æ®µè°ƒç”¨å¼•æ“æ¥å£æŸ¥è¯¢æ•°æ®ï¼ŒServer å±‚è¦å•¥ï¼Œå¼•æ“ç»™å•¥ï¼ŒInnoDB åªç»™å¿…è¦çš„å€¼ã€‚<br>æŸ¥è¯¢ç»“æŸåï¼Œè¿”å›ç»“æœé›†ï¼Œå¹¶å°†ç»“æœé›†æ”¾å…¥æŸ¥è¯¢ç¼“å­˜ã€‚<br><br>æ›´æ–°è¯­å¥çš„å…³æ³¨ç‚¹æ˜¯éš”ç¦»æ€§ï¼Œè§†å›¾ï¼ŒMVCCï¼Œå›æ»šæ—¥å¿—ï¼Œredo logï¼Œbinlogï¼Œä¸¤é˜¶æ®µæäº¤ç­‰ã€‚<br>å†™ä¸šåŠ¡ä»£ç æ—¶ï¼Œä¼šè€ƒè™‘äº‹åŠ¡å†…çš„ SQL è¯­å¥ï¼Œèƒ½å¦è°ƒæ•´ SQL è¯­å¥çš„é¡ºåºï¼Œå‡å°‘æ›´æ–°è¡¨æ—¶è¡Œé”å¯¹æ€§èƒ½çš„å½±å“ã€‚<br>åœ¨å»ºè¡¨çš„æ—¶ï¼Œä¼šåå¤æ¨æ•²è¿™ä¸ªç´¢å¼•æ˜¯å¦åˆç†ã€‚ä½¿ç”¨æ™®é€šç´¢å¼•è¿˜æ˜¯å”¯ä¸€ç´¢å¼•æ›´ä¸ºåˆé€‚ã€‚èƒ½å¦é€šè¿‡â€œæœ€å·¦å‰ç¼€åŸåˆ™â€æ¥å‡å°‘åˆ›å»ºç´¢å¼•çš„ä¸ªæ•°ã€‚å¦‚æœç´¢å¼•å­—æ®µçš„ç±»å‹æ˜¯å­—ç¬¦ä¸²å¹¶é•¿åº¦å¤ªé•¿ï¼Œå¦‚ä½•ä¼˜åŒ–ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå‡å°‘ç©ºé—´å ç”¨ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚<br><br>å­¦ä¹ ä¸“æ åï¼ŒåŸºæœ¬ä¸Šæ¶‰åŠåˆ° MySQL çš„å†…å®¹ï¼Œè¿™äº›çŸ¥è¯†ç‚¹éƒ½ä¼šæµ®ç°åœ¨è„‘æµ·ä¸­ã€‚æ˜¨å¤©è¿˜å·®ç‚¹åº”ç”¨è¿™äº›çŸ¥è¯†ï¼Œå¸®åŒäº‹ä¼˜åŒ–ä»–çš„ SQL è¯­å¥ã€‚æ˜¨å¤©è·Ÿå¾€å¸¸ä¸€æ ·ï¼Œå½“å†™ä»£ç å†™ç´¯äº†ï¼Œå°±è·‘åˆ°åŒäº‹é‚£æºœè¾¾æºœè¾¾ã€‚<br>ä»–æ­£åœ¨çº¿ä¸Šçš„å¤‡åº“æµ‹è¯•æŸ¥è¯¢ç™¾ä¸‡æ•°æ®è¦å¤šä¹…ï¼Œå¦ä¸€ä½åŒäº‹å»ºè®®ä»–ä½¿ç”¨ force index å¼ºåˆ¶ç´¢å¼•ï¼Œè¿™æ¬¡æ‰§è¡Œ 5 ç§’ï¼Œå†æ‰§è¡Œé›¶ç‚¹å‡ ç§’ã€‚<br>ä»–æƒŠä¹ï¼Œä¸ºå•¥è¿™æ¬¡è¿™ä¹ˆå¿«ã€‚æˆ‘è¯´ï¼Œè¿™æ¬¡æŸ¥äº†ç¼“å­˜ã€‚æˆ‘è¿˜æƒ³å¸®ä»–çœ‹çœ‹ SQL è¯­å¥ï¼Œæ˜¯å¦ MySQL é€‰æ‹©é”™äº†ç´¢å¼•ï¼Œå¯¼è‡´ä½¿ç”¨ force index æ˜¾å¼æŒ‡å®šç´¢å¼•ã€‚è¯´ä¸å®šä½¿ç”¨ order by field å°±è§£å†³äº†å‘¢ï¼Œå“ˆå“ˆå“ˆå“ˆã€‚åé¢æœ‰äº‹ï¼Œæ²¡æœ‰ç»§ç»­è·Ÿè¿›ä»–è¿™é—®é¢˜äº†ã€‚<br><br>éå¸¸æ„Ÿæ©ï¼Œè·Ÿç€è€å¸ˆå­¦ä¹ ï¼Œè®©æˆ‘ä½“ä¼šåˆ°äº†å­¦ä¹ æ˜¯ä¸€ä»¶è‡ªç„¶è€Œåˆå……æ»¡é­…åŠ›çš„äº‹æƒ…ï¼Œä¹Ÿè®©æˆ‘ä»ä¸€ä¸ªåŸºç¡€ä¸ç‰¢å›ºçš„å°ç™½ï¼Œä¸€æ­¥æ­¥åœ°å……å®äº†è‡ªå·±çš„çŸ¥è¯†åº“ï¼Œå¦å¤–è€å¸ˆéå¸¸å°½è´£ï¼Œç»å¸¸åŠå¤œå›å¤ç­”ç–‘ï¼Œå¸Œæœ›è€å¸ˆä¿é‡èº«ä½“ã€‚è°¢è°¢ï¼ï¼","like_count":160,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433280,"discussion_content":"â€œæˆ‘è¯´ï¼Œè¿™æ¬¡æŸ¥äº†ç¼“å­˜â€\n\nå“ˆå“ˆï¼Œè¿™ä¸ªåœºæ™¯å¥½æ£’ï¼Œè¿™ä¸ªç”»é¢æ„Ÿï¼Œæœ‰ä¸€ç§æ‰«åœ°åƒ§çš„æ„Ÿè§‰ğŸ‘ğŸ¿\n\nä¸€èµ·åŠ æ²¹\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545116709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1262519,"avatar":"https://static001.geekbang.org/account/avatar/00/13/43/b7/74a91222.jpg","nickname":"å¯’æµ…","note":"","ucode":"6846680A3B04AD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4466,"discussion_content":"å®Œå…¨è¯´å‡ºäº†æˆ‘çš„å¿ƒå£°666","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1565442975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":163987,"discussion_content":"çœ‹åˆ°ä½ çš„è¯„è®ºï¼Œéå¸¸æ„ŸåŒèº«å—ï¼ä»¥åå¤šå¤šå‘ä½ å­¦ä¹ ","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1581133702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134574,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4f/ee/bd08cfab.jpg","nickname":"ä¸€é­„","note":"","ucode":"71541125D4AA5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401129,"discussion_content":"å…„å¼Ÿä¸´èµ°æ—¶åº”è¯¥æ¥å¥ï¼šä¸€ä¸‹å­èŠä¸å®Œï¼Œä½ è¦å¥½å¥‡çš„è¯ï¼Œå¯ä»¥å»æå®¢æ—¶é—´çœ‹ã€ŠMySQLå®æˆ˜45è®²ã€‹ã€‚:)","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1633572519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1941769,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/a1/09/5e21297f.jpg","nickname":"å°å¹³","note":"","ucode":"A0FAFEDDEFFEC2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":227133,"discussion_content":"8.0  query cache å·²ç»å¼ƒç”¨äº†ï¼Œè¿™ç”»é¢æ˜¯ä¸æ˜¯åº”è¯¥æ¶ˆå¤±äº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586456857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2009461,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a9/75/dbccd12d.jpg","nickname":"ç¨»è‰äºº","note":"","ucode":"6694EE2CD36B8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1941769,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/a1/09/5e21297f.jpg","nickname":"å°å¹³","note":"","ucode":"A0FAFEDDEFFEC2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327912,"discussion_content":"ä¸èƒ½è¿™ä¹ˆè¯´ï¼ŒçŸ¥é“8.0å¼ƒç”¨æŸ¥ç¼“å­˜æ˜¯è¦çš„ã€‚ä½†æ˜¯ç›®å‰æ¥è¯´ä¼ä¸šä¸ºäº†æ±‚ç¨³ï¼Œå¤§éƒ¨åˆ†ç”¨çš„è¿˜æ˜¯5.6-5.7ä¹‹ç±»çš„ç‰ˆæœ¬ï¼ŒæŸ¥ç¼“å­˜è¿˜æ˜¯åœ¨çš„ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1606016396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":227133,"ip_address":""},"score":327912,"extra":""},{"author":{"id":1926222,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/64/4e/83c61c7f.jpg","nickname":"é“ä»”","note":"","ucode":"077A290A2DCF42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1941769,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/a1/09/5e21297f.jpg","nickname":"å°å¹³","note":"","ucode":"A0FAFEDDEFFEC2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577010,"discussion_content":"æœ‰buffer_pool LRUç¼“å­˜é¡µ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655882121,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":227133,"ip_address":""},"score":577010,"extra":""},{"author":{"id":1780797,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/2c/3d/0bd58aa4.jpg","nickname":"Em","note":"","ucode":"32012A5C603C8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1941769,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/a1/09/5e21297f.jpg","nickname":"å°å¹³","note":"","ucode":"A0FAFEDDEFFEC2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577077,"discussion_content":"innodbè‡ªå·±æœ¬èº«å°±æœ‰ç¼“å­˜é¡µ  buffer_pool  å¼ƒç”¨çš„æ˜¯serverå±‚çš„cache","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655907412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":227133,"ip_address":""},"score":577077,"extra":""}]},{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":187626,"discussion_content":"å—¯ å¹³æ—¶å·¥ä½œè¿˜æ˜¯è¦å¤šå»æ€è€ƒ å¤šå¸®äººå»å¤„ç†é—®é¢˜,åªæœ‰çŸ¥è¯†å‚¨å¤‡è¶³å¤Ÿåº”å¯¹é—®é¢˜æ‰èƒ½ä¸æ‰‹å¿™è„šä¹±","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582758479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2821728,"avatar":"","nickname":"600988292","note":"","ucode":"24BAE2B7A7B1E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539635,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639794536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1974935,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/22/97/1aefb289.jpg","nickname":"å»¿ä¸€","note":"","ucode":"4B672E258C6B04","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388896,"discussion_content":"å¤§ä½¬äº†..","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629030656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52093,"user_name":"åŠ›æŒ½ç‹‚æ¾œçˆ†ç‚¸è¾“å‡ºçš„è‡­è‡­å®","can_delete":false,"product_type":"c1","uid":1155904,"ip_address":"","ucode":"E8D26181129BCA","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/40/e0df3b84.jpg","comment_is_top":true,"comment_ctime":1545309381,"is_pvip":false,"replies":[{"id":"18915","content":"æ˜¯çš„ï¼Œbinlogä¸€æ¥æ—¶æœºæ§åˆ¶ä¸å¥½ï¼ˆå°±æ˜¯ä½ è¯´çš„è¿™ä¸ªï¼‰ï¼ŒäºŒæ¥å†…å®¹çš„èƒ½åŠ›ä¸è¶³ï¼ˆæ²¡æœ‰é¡µé¢ä¿¡æ¯ï¼‰<br>ğŸ‘ğŸ¿<br>","user_name":"ä½œè€…å›å¤","comment_id":52093,"uid":"1264162","ip_address":"","utype":1,"ctime":1545315361,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":9,"race_medal":0,"score":"9.2233721715441009e+18","product_id":100020801,"comment_content":"é’ˆå¯¹ä¸èƒ½åªç”¨binlogå®Œæˆæ•°æ®æ¢å¤æˆ‘çš„ç†è§£ï¼š<br>æŒ‰ç…§æ–‡ä¸­è¿™ä¸ªè¯é¢˜ä¸‹çš„ç¤ºä¾‹ï¼Œå› ä¸ºMySQLå†™æ•°æ®æ˜¯å†™åœ¨å†…å­˜é‡Œçš„ï¼Œä¸ä¿è¯è½ç›˜ï¼Œæ‰€ä»¥commit1çš„æ•°æ®ä¹Ÿå¯èƒ½ä¸¢å¤±ï¼›ä½†æ˜¯æ¢å¤åªæ¢å¤binlogå¤±è´¥çš„ä¹Ÿå°±æ˜¯commit2çš„æ•°æ®ï¼Œæ‰€ä»¥æ•°æ®ä¼šä¸¢å¤±ã€‚<br>è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":31,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433737,"discussion_content":"æ˜¯çš„ï¼Œbinlogä¸€æ¥æ—¶æœºæ§åˆ¶ä¸å¥½ï¼ˆå°±æ˜¯ä½ è¯´çš„è¿™ä¸ªï¼‰ï¼ŒäºŒæ¥å†…å®¹çš„èƒ½åŠ›ä¸è¶³ï¼ˆæ²¡æœ‰é¡µé¢ä¿¡æ¯ï¼‰\nğŸ‘ğŸ¿\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545315361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293483,"discussion_content":"è½ç›˜ä¸€èˆ¬æ˜¯è°ƒç”¨linuxåº•å±‚çš„fsync  æ— éæ˜¯ æ˜¯ä¸»åŠ¨è°ƒç”¨è¿˜æ˜¯è‡ªåŠ¨çš„å‘¨æœŸæ€§çš„è°ƒç”¨fsync","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595556180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2142240,"avatar":"https://static001.geekbang.org/account/avatar/00/20/b0/20/6d0f4587.jpg","nickname":"ç¾å¥½çš„æœªæ¥","note":"","ucode":"2E2432913874D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387889,"discussion_content":"binlogçš„åˆ·ç›˜æ—¶æœºæ˜¯æœ‰é…ç½®çš„ï¼Œsync_binlog=1çš„æ—¶å€™æ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åˆ·ç›˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628488762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053553,"avatar":"https://static001.geekbang.org/account/avatar/00/10/13/71/3762b089.jpg","nickname":"stevensafin","note":"","ucode":"CC692A740C5FD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340387,"discussion_content":"è¿™é‡Œå¦‚æœè¯´binlogæ˜¯rowæ ¼å¼çš„è¯  æ˜¯ä¸æ˜¯å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜  rowæ ¼å¼çš„å¯èƒ½ä¼šå¯¼è‡´ä¸€ä¸ªæ•°æ®å¤šæ¬¡åˆ·ç›˜ï¼Œä½†æ˜¯æ•°æ®çš„å¯é æ€§åº”è¯¥æ˜¯ä¸ä¼šæœ‰æŸå¤±çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609991738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1685743,"avatar":"https://static001.geekbang.org/account/avatar/00/19/b8/ef/06dc955b.jpg","nickname":"ftuokl","note":"","ucode":"2C27EE145EDB5B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":32645,"discussion_content":"é‚£binlogä»€ä¹ˆæ—¶å€™æ‰è½ç›˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571054695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1685743,"avatar":"https://static001.geekbang.org/account/avatar/00/19/b8/ef/06dc955b.jpg","nickname":"ftuokl","note":"","ucode":"2C27EE145EDB5B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158838,"discussion_content":"binlogä¸è½ç›˜ï¼Œè½ç›˜é å†…å­˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1580632487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":32645,"ip_address":""},"score":158838,"extra":""},{"author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":187627,"discussion_content":"binlogè‡ªèº«æ˜¯ä¼šè½ç›˜çš„ ä½ è¯´çš„è½ç›˜é å†…å­˜æ˜¯å†…å­˜ä¸­è„é¡µæ•°æ®çš„è½ç›˜","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1582758567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":158838,"ip_address":""},"score":187627,"extra":""},{"author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1335293,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132","nickname":"å‘¨æ²»æ…§","note":"","ucode":"7D56C4E66BEE17","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328338,"discussion_content":"binlog cacheå†™å…¥binlogæ–‡ä»¶ï¼Œä½†ä¸ä¼šç«‹å³åˆ·ç›˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606124635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":187627,"ip_address":""},"score":328338,"extra":""}]}]},{"had_liked":false,"id":50714,"user_name":"äºæµ·","can_delete":false,"product_type":"c1","uid":1054754,"ip_address":"","ucode":"19C026AC2A5A9E","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/22/e817914c.jpg","comment_is_top":false,"comment_ctime":1545033908,"is_pvip":false,"replies":[{"id":"18206","content":"è°¢è°¢ğŸ™ <br>å¸Œæœ›å¤§å®¶éƒ½æœ‰æ”¶è·","user_name":"ä½œè€…å›å¤","comment_id":50714,"uid":"1264162","ip_address":"","utype":1,"ctime":1545041673,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"272127973556","product_id":100020801,"comment_content":"åœ¨æå®¢æ—¶é—´ä¹Ÿå­¦äº†ä¸å°‘è¯¾ç¨‹ï¼Œæ—è€å¸ˆæ˜¯è¿™å…¶ä¸­æœ€è®¤çœŸè´Ÿè´£çš„ï¼Œå¥½çš„è¯¾ç¨‹æ˜¯ç”¨â€œå¿ƒâ€å†™å‡ºæ¥çš„","like_count":63,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433071,"discussion_content":"è°¢è°¢ğŸ™ \nå¸Œæœ›å¤§å®¶éƒ½æœ‰æ”¶è·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545041673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50621,"user_name":"é™ˆæ–°ä»","can_delete":false,"product_type":"c1","uid":1309925,"ip_address":"","ucode":"C0F8E3BC334A45","user_header":"https://static001.geekbang.org/account/avatar/00/13/fc/e5/c26c67ea.jpg","comment_is_top":false,"comment_ctime":1545017207,"is_pvip":false,"replies":[{"id":"18189","content":"ä½ è¯´å¾—å¯¹ï¼Œæ˜¯æŒ‰ä½æˆ–ï¼Œçœ‹å¾—å¾ˆç»†è‡´ğŸ‘ğŸ¿<br><br>æˆ‘å‘ä¸ªå ªè¯¯","user_name":"ä½œè€…å›å¤","comment_id":50621,"uid":"1264162","ip_address":"","utype":1,"ctime":1545027363,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":9,"race_medal":0,"score":"224883316599","product_id":100020801,"comment_content":"ã€æ“ä½œç¬¦â€œ|â€æ˜¯é€»è¾‘æˆ–ï¼Œè¿åŒæœ€åä¸€å¥insertè¯­å¥é‡Œ...ã€‘<br>è€å¸ˆï¼Œâ€œ|â€ è¿™åº”è¯¥å«ä½è¿ç®—ç¬¦çš„æŒ‰ä½æˆ–æ“ä½œç¬¦ï¼Œé€»è¾‘æˆ–æ˜¯â€œ||â€å§ï¼Ÿ<br>è¿™é‡Œçš„å¹‚ç­‰æ€§åŸç†å°±æ˜¯ï¼šA &lt; B: relation_ship = 2 | 1; A &gt; B:relation_ship = 1 | 2ï¼›é‡å¤æ’å…¥ 3 | 1 æˆ–è€… 3 | 2 ã€‚ä½è¿ç®—ï¼š 2 | 1 == 1 | 2 == 3 | 1 == 3 | 2 == 3ã€‚æ„Ÿè§‰è¿™é‡Œæƒ³æ³•å¾ˆå·§å¦™ã€‚","like_count":52,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433039,"discussion_content":"ä½ è¯´å¾—å¯¹ï¼Œæ˜¯æŒ‰ä½æˆ–ï¼Œçœ‹å¾—å¾ˆç»†è‡´ğŸ‘ğŸ¿\n\næˆ‘å‘ä¸ªå ªè¯¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545027363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1159317,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erbUHD8KH3mYz39QuHj5BXB06VqCus5WR4oHfNuSYdPVLno3Tq61yhMiaugxpMicKibDFQ4KwX7icoDWQ/132","nickname":"ipromiseu","note":"","ucode":"775E2CC0E7CA69","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":131012,"discussion_content":"è¿™é‡Œçš„è®¾è®¡è™½æ˜¯å·§å¦™ï¼Œå•ä¸å…·å¤‡é€šç”¨æ€§ï¼Œä¸æ˜¯æ¯æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜éƒ½èƒ½æ‰¾åˆ°å·§å¦™çš„æ–¹æ¡ˆã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1578819194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2009461,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a9/75/dbccd12d.jpg","nickname":"ç¨»è‰äºº","note":"","ucode":"6694EE2CD36B8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1159317,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erbUHD8KH3mYz39QuHj5BXB06VqCus5WR4oHfNuSYdPVLno3Tq61yhMiaugxpMicKibDFQ4KwX7icoDWQ/132","nickname":"ipromiseu","note":"","ucode":"775E2CC0E7CA69","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327916,"discussion_content":"è®¾è®¡çš„æ€æƒ³æ˜¯é€šç”¨çš„ã€‚ã€‚ã€‚ç²¾å¦™çš„è®¾è®¡æ€è·¯æœ‰äº†ï¼Œå¯ä»¥ä¸¾ä¸€åä¸‰çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606016770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":131012,"ip_address":""},"score":327916,"extra":""}]},{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293485,"discussion_content":"å…¶å®æˆ‘ç†è§£ è¿™ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œä¸šåŠ¡æ›´å¥½è§„é¿ï¼Œæ¯”å¦‚æ¯æ¬¡åšå…³æ³¨åŠ¨ä½œä¹‹åå‘é€mqï¼Œç”±å¦å¤–ä¸€ä¸ªå¥½å‹æœåŠ¡æ£€æŸ¥æ˜¯å¦è¦æˆä¸ºå¥½å‹ï¼Œå¯ä»¥è®©mqæ¶ˆæ¯ä¸€å®šæ—¶é—´ä¹‹åæ¶ˆè´¹ã€‚å› ä¸ºæœ¬èº«è¿™ä¸ªä¸šåŠ¡é€»è¾‘å¹¶ä¸æ˜¯ä¸€å®šè¦å®æ—¶çš„ã€‚åªéœ€è¦åœ¨ä¸šåŠ¡å®¹è®¸èŒƒå›´æˆç«‹å³å¯ã€‚è¿™æ ·dbæ€§èƒ½è¶³å¤Ÿé«˜ï¼Œè®¾è®¡ä¹Ÿæ›´ç²¾ç®€ï¼Œå”¯ä¸€çš„ç¼ºé™·å°±æ˜¯å¯èƒ½ä¸é‚£ä¹ˆå³ä½¿ï¼Œä½†æ˜¯ å¦‚æœç©å¾®åšçš„çŸ¥é“ï¼Œä¸€èˆ¬å…³æ³¨å®Œä¹‹åï¼Œå†æ‰¾åˆ°å¥½å‹æ²Ÿé€šæ ï¼Œå†æœç´¢ï¼Œè¿™ä¸ªè€—æ—¶æå¤§ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595556342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2009461,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a9/75/dbccd12d.jpg","nickname":"ç¨»è‰äºº","note":"","ucode":"6694EE2CD36B8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327915,"discussion_content":"ä½†å…¶å®è¿˜æ˜¯æ²¡æœ‰ä»æ ¹æœ¬ä¸Šè§£å†³å¹¶å‘é—®é¢˜ï¼Œmqæ¶ˆæ¯è¿˜æ˜¯ä¼šæœ‰å¹¶å‘å¯èƒ½çš„ï¼šæ¯”å¦‚åˆšå¥½ä¸¤ä¸ªå¥½å‹å…³æ³¨çš„æ¶ˆæ¯åŒæ—¶åˆ°è¾¾ï¼Œå°±åˆè¿˜æ˜¯å›åˆ°æ–‡ç« çš„é—®é¢˜ä¸­ã€‚ã€‚ã€‚\nmqå¹¶ä¸èƒ½è§£å†³å¹¶å‘é—®é¢˜ï¼Œåªæ˜¯è¯´èƒ½èµ·åˆ°å‰Šå³°ã€å¼‚æ­¥ç­‰çš„ä½œç”¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606016693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293485,"ip_address":""},"score":327915,"extra":""}]},{"author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":114109,"discussion_content":"è¿™é‡Œçš„è®¾è®¡ç¡®å®å·§å¦™ï¼Œè€å¸ˆä¸ºä»€ä¹ˆåœ¨è¿™é‡Œè®¾ç½®çš„æ˜¯1 2 3 å‘¢ï¼Ÿ å¦‚æœè®¾ç½®å…¶ä»–å€¼ï¼Œä¼šä¸ä¼šä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ ï¼Ÿ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577958314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1997293,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/79/ed/4737a49b.jpg","nickname":"é›ªã®é›«Â·é›¨ã®éŸ³","note":"","ucode":"0693DA3939A321","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267330,"discussion_content":"åªè¦ä½ èƒ½æ‰¾åˆ° a | b = cçš„è¿™æ ·æ»¡è¶³å…³ç³»çš„ä¸‰ä¸ªæ•°å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589633146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":114109,"ip_address":""},"score":267330,"extra":""}]},{"author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37592,"discussion_content":"å¦‚æœæ˜¯æŒ‰ä½æˆ–çš„è¯2 | 1 ç»“æœåº”è¯¥ä¸º3å§ã€‚æˆ‘çœ‹@é™ˆæ–°ä»ç»™å‡ºçš„ç­”æ¡ˆæ˜¯1ï¼Œå³â€œ2 | 1 == 1â€ï¼Œæ˜¯æˆ‘è®¡ç®—é”™äº†å—ï¼Ÿè¯·æŒ‡æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571642859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1014615,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/57/18b61282.jpg","nickname":"dullduck","note":"","ucode":"25293558309704","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1015754,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","nickname":"helloworld","note":"","ucode":"00DF2FEC58D2E6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":51094,"discussion_content":"ä½ ç†è§£é”™äº†ï¼Œåˆ«äººæ˜¯è¯´ 2|1==1|2 ,ç»“æœéƒ½ç­‰äº3","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1573810196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":37592,"ip_address":""},"score":51094,"extra":""}]}]},{"had_liked":false,"id":50576,"user_name":"Eric","can_delete":false,"product_type":"c1","uid":1056767,"ip_address":"","ucode":"30300D7B752917","user_header":"https://static001.geekbang.org/account/avatar/00/10/1f/ff/aadcf237.jpg","comment_is_top":false,"comment_ctime":1545011230,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"190523572254","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å®åœ¨æ˜¯å¤ªè‰¯å¿ƒäº†ã€‚æ•´ç†è¿™äº›é—®é¢˜åº”è¯¥å¾ˆè´¹æ—¶é—´å§ã€‚çœ‹å®Œç­”ç–‘ä¹‹åæ„Ÿè§‰åˆåŠ æ·±äº†ä¸€éå°è±¡ã€‚åƒå¾ˆå¤šçŸ¥è¯†ç‚¹éƒ½éœ€è¦åå¤ç†è§£æ‰èƒ½çœŸæ­£æŒæ¡ã€‚ç­”ç–‘æ¥çš„å¾ˆåŠæ—¶ï¼Œæ„Ÿè°¢ï¼","like_count":44},{"had_liked":false,"id":52647,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1545466221,"is_pvip":false,"replies":[{"id":"19165","content":"1. åˆ·è„é¡µæ˜¯åªæŠŠå†…å­˜ä¸Šæœ€æ–°ç‰ˆæœ¬çš„æ•°æ®é¡µå†™åˆ°ç£ç›˜ä¸Šã€‚ ç¬¬ä¸€ä¸ªç¢°åˆ°çš„redologä¼šæŠŠè¿™ä¸ªè„é¡µåˆ·ä¸‹å»ï¼Œæ³¨æ„redologå¹¶æ²¡æœ‰ä¿®æ”¹å†…å­˜æ•°æ®é¡µçš„æ•°æ®ï¼ˆè¿™ä¸ªä¸æ˜¯å´©æºƒæ¢å¤è¿‡ç¨‹å“¦ï¼‰<br>åé¢å†ç¢°åˆ°è¿™ä¸ªé¡µé¢çš„redolog,è¿™ä¸ªé¡µé¢æ˜¯å¹²å‡€é¡µäº†ï¼Œä¸ç”¨åˆ·ç›´æ¥è·³è¿‡<br><br>2. ç¬¬äºŒä¸ªé—®é¢˜çš„ä¸¤ä¸ªé—®å·æ˜¯ä¸€ä¸ªç­”æ¡ˆï¼šä¸ç”¨æ¸…é™¤ã€‚ ä¸‹æ¬¡redo logæ¥åˆ·çš„æ—¶å€™çœ‹åˆ°æ˜¯å¹²å‡€é¡µå°±ç›´æ¥è¿‡äº†ã€‚<br><br>å¥½é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","comment_id":52647,"uid":"1264162","ip_address":"","utype":1,"ctime":1545478884,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":14,"race_medal":0,"score":"160459256173","product_id":100020801,"comment_content":"å…³äºåˆ·è„é¡µæœ‰ä¸¤ä¸ªé—®é¢˜è¯·æ•™è€å¸ˆ:<br>1. å½“redo logç©ºé—´ä¸è¶³æ—¶,  æŒ‰ç…§redo logçš„é¡ºåºæŠŠè„é¡µæ›´æ–°åˆ°ç£ç›˜, é‚£ä¹ˆå‡å¦‚ä¸€ä¸ªè„é¡µåœ¨ç¬¬1æ¡redo logä¸­å·²ç»è¢«æŒä¹…åŒ–åˆ°ç£ç›˜,  åé¢ç¬¬1000æ¡redo logåˆæœ‰è¿™ä¸ªå…³äºè¿™ä¸ªè„é¡µçš„ä¿¡æ¯, é‚£ä¹ˆinnoDBæ˜¯ç›´æ¥ä¸¢å¼ƒæ‰è¿™æ¡redo logçš„è®°å½•å—? è¿˜æœ‰è¿™ä¸ªæ—¶å€™, æ˜¯è¦æŠŠredo logä¸Šçš„å…¨éƒ¨å†…å®¹æ›´æ–°åˆ°ç£ç›˜å—, è¿˜æ˜¯æ›´æ–°ä¸€éƒ¨åˆ†?<br><br>2. å½“å†…å­˜ä¸è¶³å¼€å§‹åˆ·è„é¡µçš„æ—¶å€™, ä»¥å†…å­˜ä¸ºåˆ·è„é¡µå‘èµ·ç‚¹, è¿™æ—¶æ˜¯æŠŠæœ€ä¹…ä¸ä½¿ç”¨çš„æ•°æ®é¡µä»å†…å­˜ä¸­æ·˜æ±°æ‰, é‚£ä¹ˆè¿™ä¸ªæ—¶å€™, å¯¹åº”çš„é¢redo logæ˜¯ä¸æ˜¯ä¹Ÿä¼šæ¸…é™¤? è€Œå¯¹äºè¯¥è„é¡µçš„æ“ä½œå¯èƒ½åœ¨redo logä¸­å¹¶ä¸æ˜¯è¿ç»­çš„è®°å½•, redo logæœ‰åªèƒ½é¡ºåºè¯»å†™, é‚£ä¹ˆredo logæ˜¯æ€ä¹ˆæ¸…é™¤æ‰å…³äºè¿™ä¸ªè„é¡µçš„æ‰€æœ‰è®°å½•çš„?","like_count":37,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433936,"discussion_content":"1. åˆ·è„é¡µæ˜¯åªæŠŠå†…å­˜ä¸Šæœ€æ–°ç‰ˆæœ¬çš„æ•°æ®é¡µå†™åˆ°ç£ç›˜ä¸Šã€‚ ç¬¬ä¸€ä¸ªç¢°åˆ°çš„redologä¼šæŠŠè¿™ä¸ªè„é¡µåˆ·ä¸‹å»ï¼Œæ³¨æ„redologå¹¶æ²¡æœ‰ä¿®æ”¹å†…å­˜æ•°æ®é¡µçš„æ•°æ®ï¼ˆè¿™ä¸ªä¸æ˜¯å´©æºƒæ¢å¤è¿‡ç¨‹å“¦ï¼‰\nåé¢å†ç¢°åˆ°è¿™ä¸ªé¡µé¢çš„redolog,è¿™ä¸ªé¡µé¢æ˜¯å¹²å‡€é¡µäº†ï¼Œä¸ç”¨åˆ·ç›´æ¥è·³è¿‡\n\n2. ç¬¬äºŒä¸ªé—®é¢˜çš„ä¸¤ä¸ªé—®å·æ˜¯ä¸€ä¸ªç­”æ¡ˆï¼šä¸ç”¨æ¸…é™¤ã€‚ ä¸‹æ¬¡redo logæ¥åˆ·çš„æ—¶å€™çœ‹åˆ°æ˜¯å¹²å‡€é¡µå°±ç›´æ¥è¿‡äº†ã€‚\n\nå¥½é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545478884,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328351,"discussion_content":"çœ‹LSNå§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606125672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330536,"discussion_content":"ï¼‹1","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606642480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328351,"ip_address":""},"score":330536,"extra":""}]},{"author":{"id":2036924,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/14/bc/326284b1.jpg","nickname":"ambrella","note":"","ucode":"9C0019364DCBB5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390240,"discussion_content":"å¥½é—®é¢˜å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629725210,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1644104,"avatar":"https://static001.geekbang.org/account/avatar/00/19/16/48/09493874.jpg","nickname":"èŒ¶æ²¡å–å®Œ","note":"","ucode":"D72D88C42A1258","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332999,"discussion_content":"å¯¹ä¸€ä¸ªé¡µçš„å¤šæ¬¡ä¿®æ”¹åªè¦åˆ·ä¸€æ¬¡è„é¡µå°±è¡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607412926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328348,"discussion_content":"åˆ·è„é¡µæ˜¯æŠŠæœ€æ–°ç‰ˆæœ¬çš„æ•°æ®å†™åˆ°ç£ç›˜ä¸Šï¼Œä½†æ˜¯ä¹‹å‰ç‰ˆæœ¬ä¸å°±æ²¡äº†ï¼Ÿæ€ä¹ˆä¿è¯MVCC","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606125203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372301,"discussion_content":"MVCCæ˜¯è·Ÿundoç›¸å…³ï¼Œè·Ÿredoæ²¡å…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620279785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328348,"ip_address":""},"score":372301,"extra":""},{"author":{"id":2083187,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/c9/73/047f51d2.jpg","nickname":"ybonfire","note":"","ucode":"9A8D541DEFFBB4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2287841,"avatar":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","nickname":"LPF","note":"","ucode":"036C552D7251E9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380653,"discussion_content":"æœ€æ–°æ•°æ®+Undo Log","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624616715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328348,"ip_address":""},"score":380653,"extra":""}]},{"author":{"id":1282641,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/51/0505254d.jpg","nickname":"Fighter","note":"","ucode":"B1925EE400372D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310947,"discussion_content":"æ²¡å¤ªæ˜ç™½è€å¸ˆå¯¹è¿™ä¸¤ä¸ªé—®é¢˜çš„å›ç­”ï¼Œredo logé‡Œé¢é¡µä¸ä¸€å®šåœ¨å†…å­˜é‡Œï¼Œè¿˜æœ‰ä¸€äº›change bufferçš„å˜æ›´ï¼Œæ²¡æ¥å¾—åŠmergeçš„ï¼Œåœ¨write posè·Ÿcheckpointé‡åˆçš„æ—¶å€™å°±è¦å°†ç£ç›˜è¯»å–è¿™äº›é¡µï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯æƒ³é—®çš„æ˜¯å‡å¦‚æœ‰è¯¥é¡µçš„å¤šæ¡å˜æ›´çš„æƒ…å†µå¦‚ä½•å¤„ç†ï¼Œæˆ‘çš„ç†è§£æ˜¯ç§»åŠ¨checkpointçš„æ—¶å€™ï¼Œè¯»åˆ°æ“ä½œï¼Œmergeæ“ä½œåˆ°pageï¼Œæ­¤æ—¶pageå°±æ˜¯è„é¡µäº†ï¼Œåç»­å¯¹è¯¥é¡µæ›´æ–°è·Ÿè¯»éƒ½æ˜¯ä¾èµ–mvccï¼ˆundo redoï¼‰ï¼Ÿçƒ¦è¯·è€å¸ˆè§£ç­”ä¸‹ï¼Œè¿·ç³Šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602152442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1140175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/cf/326c0eea.jpg","nickname":"x-rayîŒº","note":"","ucode":"8363F0C4D0AC0B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1282641,"avatar":"https://static001.geekbang.org/account/avatar/00/13/92/51/0505254d.jpg","nickname":"Fighter","note":"","ucode":"B1925EE400372D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323614,"discussion_content":"æˆ‘çœ‹äº†å‡ éï¼Œè¯´ä¸‹æˆ‘çš„æƒ³æ³•ï¼Œredo logé‡Œé¢çš„é¡µï¼Œå¯èƒ½ç¡®å®ä¸ä¸€å®šåœ¨å†…å­˜é‡Œï¼Œå°±åƒä½ è¯´çš„ï¼Œå¯èƒ½ä¼šå…ˆå†™å…¥åˆ°chang bufferé‡Œã€‚æŒ‰ç…§åŸå…ˆçš„ç†è§£ï¼Œè¿™éƒ¨åˆ†æ•°æ®è¢«readçš„æ—¶å€™æ‰ä¼šmergeï¼Œç„¶åå˜æˆè„é¡µã€‚å¦‚æœåœ¨åˆ·ç›˜å‰ï¼Œå‘ç”Ÿè¯»äº‹ä»¶ï¼Œå¯¼è‡´mergeï¼Œé‚£åé¢åˆ·ç›˜çš„è¡Œä¸ºåº”è¯¥å’Œå…¶å®ƒè„é¡µä¸€æ ·ï¼Œè¿™ä¸ªæˆ‘è§‰å¾—é—®é¢˜ä¸å¤§ã€‚é—®é¢˜åœ¨äºï¼Œè¦åˆ·ç›˜æ—¶ï¼Œå¦‚æœè¿˜æ²¡æœ‰mergeï¼Œä¼šæ€ä¹ˆå¤„ç†ï¼Ÿ1.å¦‚æœæ˜¯redo log è¦æ“¦é™¤çš„éƒ¨åˆ†æ°å¥½æ˜¯change bufferçš„æ•°æ®ã€‚2.å¦‚æœæ˜¯å†…å­˜ä¸å¤Ÿï¼Œè¦æ·˜æ±°çš„å†…å­˜ï¼Œæ°å¥½æ˜¯change bufferçš„æ•°æ®ã€‚æˆ‘è§‰å¾—æ— è®ºå“ªä¸€ç§ï¼Œéƒ½åº”è¯¥ä¼šå¼ºè¡Œmergeï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™æ ·ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604975013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":310947,"ip_address":""},"score":323614,"extra":""},{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1140175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/cf/326c0eea.jpg","nickname":"x-rayîŒº","note":"","ucode":"8363F0C4D0AC0B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403075,"discussion_content":"1. redo æ“¦é™¤çš„æ—¶å€™ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š å¦‚æœé¡µåœ¨å†…å­˜ä¸­ï¼Œ é‚£è¿™ä¸ªé¡µè‚¯å®šæ˜¯mergeè¿‡äº†ï¼ˆé¡µè½½å…¥å†…å­˜çš„æ—¶å€™ï¼Œ å°±ä¼šå…ˆåº”ç”¨Change Bufferï¼‰ï¼Œè¿™ä¸ªæ—¶å€™åªéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºè„é¡µï¼Œå¦‚æœæ˜¯è„é¡µï¼Œ åˆ™åˆ·è„ï¼›å¦‚æœæ˜¯å¹²å‡€é¡µï¼Œåˆ™ç›´æ¥æ¸…é™¤redologã€‚  å¦‚æœé¡µä¸åœ¨å†…å­˜ä¸­ï¼Œ åˆ™ä¼šå…ˆå°†ç£ç›˜é¡µè½½å…¥åˆ°å†…å­˜ä¸­ ï¼Œ ç„¶ååº”ç”¨change bufferï¼ˆå¦‚æœ æœ‰çš„è¯ï¼‰ï¼Œ ç„¶åèµ°åˆ¤æ–­æ˜¯å¦ä¸ºè„é¡µçš„é€»è¾‘ã€‚\n2. è¦æ·˜æ±°çš„å†…å­˜æ˜¯change bufferçš„æ•°æ®ï¼Œ ä¹Ÿæ²¡å…³ç³»ï¼Œ change bufferä¹Ÿæœ‰è½ç›˜çš„ã€‚   \næ€»ä¹‹ï¼Œ ç£ç›˜é¡µè½½å…¥å†…å­˜çš„æ—¶å€™ï¼ˆä¸€èˆ¬æ˜¯æœ‰æŸ¥è¯¢è¯·æ±‚æ¶‰åŠåˆ°è¯¥é¡µï¼Œæˆ–è€…æ˜¯å´©æºƒæ¢å¤ï¼‰ï¼Œ ä¸€å®šä¼šè§¦å‘mergeæ“ä½œã€‚ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1634003729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":323614,"ip_address":""},"score":403075,"extra":""}]},{"author":{"id":1547667,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9d/93/4159edaa.jpg","nickname":"æœ´ç´ æŸ æª¬c","note":"","ucode":"2D4CBB70D801B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":245889,"discussion_content":"redologæ˜¯ä¸ªä¿åº•çš„ä¸œè¥¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587708689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145404,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7a/3c/87e015f8.jpg","nickname":"å µè½¦","note":"","ucode":"7BC1E50A4F8D3D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57592,"discussion_content":"mysqlæ€ä¹ˆåˆ¤æ–­è¿™ä¸ªé¡µæ˜¯å¹²å‡€é¡µï¼Œä¸éœ€è¦åˆ·ç£ç›˜ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574622601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1762252,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/e3/cc/0947ff0b.jpg","nickname":"nestle","note":"","ucode":"469800BED81B54","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1145404,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7a/3c/87e015f8.jpg","nickname":"å µè½¦","note":"","ucode":"7BC1E50A4F8D3D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":84934,"discussion_content":"LSN","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1576508646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":57592,"ip_address":""},"score":84934,"extra":""}]}]},{"had_liked":false,"id":82078,"user_name":"åˆ˜å¿—å…µ","can_delete":false,"product_type":"c1","uid":1441734,"ip_address":"","ucode":"A90C2FA49EDC23","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/c6/8b5cbe97.jpg","comment_is_top":false,"comment_ctime":1554115169,"is_pvip":false,"replies":[{"id":"30015","content":"æ˜¯è¿™æ ·çš„<br>ä¸€ä¸ªäº‹åŠ¡çš„binlogå¦‚æœå›æ”¾ï¼Œå°±æ˜¯é‡åšè¿™ä¸ªäº‹åŠ¡ï¼Œä¸€ä¸ªäº‹åŠ¡æ›´æ–°çš„å¯èƒ½ä¸æ­¢ä¸€ä¸ªpageã€‚<br><br>æ¯”å¦‚ä¸€ä¸ªäº‹åŠ¡æ›´æ–°äº†page ABC<br>ç„¶åå´©æºƒå›å¤äº†ï¼ŒBåäº†ï¼ŒACæ²¡é—®é¢˜ï¼Œè€Œä¸”ACè¿˜è½ç›˜äº†ã€‚<br>è¿™æ ·å¦‚æœé‡åšäº‹åŠ¡ï¼ŒBå¥½äº†ï¼ŒACåˆåäº†","user_name":"ä½œè€…å›å¤","comment_id":82078,"uid":"1264162","ip_address":"","utype":1,"ctime":1554432249,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":11,"race_medal":0,"score":"117518232161","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯»äº†å¾ˆä¹…å…¶ä»–é—®é¢˜éƒ½æ˜ç™½äº†ï¼Œè¿˜æ˜¯æ²¡å¤ªæ˜ç™½åªç”¨binlogä¸ºå•¥ä¸èƒ½æ¢å¤æ•°æ®ï¼Œæ ¹æœ¬åŸå› è¿˜æ˜¯å¯¹binlogå’Œredologéƒ½è®°å½•çš„å†…å®¹æ²¡æŒæ¡æ¸…æ¥šï¼Œæˆ‘çš„ç†è§£è·Ÿè¯„è®ºåŒºé‡Œâ€œå¾—ä¸åˆ°deé¢œè‰²â€è¯´çš„ä¸€æ ·ï¼Œå°±æ˜¯binlogä¹ŸåŒæ ·è®°å½•äº†ä¸€è¡Œæ•°æ®ï¼Œä½†æ˜¯ä¸çŸ¥é“è¯¥ä»å“ªé‡Œå›æ”¾ï¼Œæ‰€ä»¥æ²¡æ³•æ¢å¤ï¼Œä½†æ˜¯redo logå¯ä»¥ä»check_pointå¼€å§‹æ‰«ææ‰€ä»¥èƒ½æ¢å¤ï¼›<br>çœ‹åˆ°ä½ å›å¤çš„æ˜¯binlogæ²¡æœ‰èƒ½åŠ›åšå‡ºæ¥ä¸€é¡µçš„æ•°æ®ï¼Œåæ­£ç¼ºå¤±çš„æ•°æ®éƒ½è®°åœ¨binlogé‡Œäº†ï¼Œå¦‚æœèƒ½æœ‰åŠæ³•çŸ¥é“binlogä»å“ªé‡Œå›æ”¾ï¼Œå›æ”¾ä¸€éå°±å¯ä»¥äº†ï¼Œä¸ºå•¥ä¸€å®šè¦åšä¸€é¡µæ•°æ®å‡ºæ¥ï¼Œéº»çƒ¦è€å¸ˆè§£ç­”ä¸€ä¸‹ï¼Œè°¢è°¢","like_count":27,"discussions":[{"author":{"id":2278559,"avatar":"https://static001.geekbang.org/account/avatar/00/22/c4/9f/a01e4bd1.jpg","nickname":"æµ·æµª","note":"","ucode":"091941B3556B4B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326462,"discussion_content":"æ•°æ®çš„è½ç›˜æ˜¯ä»¥pageä¸ºæœ€å°å•ä½ï¼Œè€Œredo logè®°å½•çš„ç»´åº¦ä¹Ÿæ˜¯pageã€‚è€Œå¯¹äºbinglogï¼Œè®°å½•çš„ç»´åº¦å¤ªç²—ï¼Œæ˜¯ä»¥å•æ¡è¯­å¥çš„ç»´åº¦è®°å½•çš„ã€‚","likes_number":16,"is_delete":false,"is_hidden":false,"ctime":1605600073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1096248,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ba/38/cc5b50f6.jpg","nickname":"æ£®æ·¼ğŸ‘Œ","note":"","ucode":"B98AE9B22F50F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413162,"discussion_content":"binlogæ˜¯é€»è¾‘æ—¥å¿—ï¼Œå¯èƒ½åŒ…å«å¤šä¸ªpageï¼Œå‡è®¾è®°å½•äº†ä¸€æ¡é€»è¾‘æ—¥å¿—update table set a=a+1;å¤šæ¬¡é‡æ”¾åç»“æœä¸€å®šæ˜¯æœ‰é—®é¢˜çš„ã€‚å¦‚æœæ˜¯redo logï¼Œå®ƒå’Œå…·ä½“çš„pageæŒ‚é’©ï¼Œâ€œpage 111ï¼Œ table, a, old value 1, new value 5&#34;ï¼Œåƒè¿™æ¡ç‰©ç†æ—¥å¿—ä¸è®ºé‡æ”¾å¤šå°‘æ¬¡ï¼Œaçš„å€¼ç»“æœä¸ä¼šæœ‰é—®é¢˜","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1636387792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110149,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/85/fca692bf.jpg","nickname":"zhendecai","note":"","ucode":"DD27D314F8177D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":260052,"discussion_content":"å¦‚æœé‡‡ç”¨çš„rowï¼ŒåŒæ—¶è®°å½•æ‰€æœ‰è¡Œçš„ä¿¡æ¯ï¼Œç†è®ºä¸Šå›å†™çš„æ—¶å€™å¯ä»¥åšåˆ°å’Œredologä¸€æ ·çš„å¹‚ç­‰æ“ä½œå§ã€‚å…¶å®ä¹Ÿæ˜¯è¿™ä¸ªæ•°æ®é¡µåšäº†ä»€ä¹ˆæ“ä½œå˜æˆäº†ä»€ä¹ˆæ ·å­ï¼Œé‚£æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥åšæˆcrash-safe","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1588844315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":7,"child_discussions":[{"author":{"id":2036468,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/12/f4/c5cc59f0.jpg","nickname":"naadp","note":"","ucode":"2C853E7E89EC00","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1110149,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/85/fca692bf.jpg","nickname":"zhendecai","note":"","ucode":"DD27D314F8177D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287426,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„å‘¢ï¼Œæœ‰äº›ä¸ç†è§£ã€‚å¤§å“¥æƒ³æ˜ç™½äº†çš„è¯ï¼Œéº»çƒ¦å’Œæˆ‘è¯´å£°å„¿å“ˆã€‚è°¢è°¢æ‚¨ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593439081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":260052,"ip_address":""},"score":287426,"extra":""},{"author":{"id":1607318,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqWicbfC66qKRx32V1pNNSxJPhytPyZ612s9xN0uYHPnRJqNSWibdWg34jgKQn4YGLbs7hvAuHm0Sjg/132","nickname":"Geek_dc6fe6","note":"","ucode":"BA388E87D88D02","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2036468,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/12/f4/c5cc59f0.jpg","nickname":"naadp","note":"","ucode":"2C853E7E89EC00","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287942,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯è¿™æ ·ï¼ŒæŒ‰è€å¸ˆä¸Šé¢çš„ä¾‹å­ç»§ç»­è¯´ï¼š\næ¯”å¦‚ä¸€ä¸ªäº‹åŠ¡æ›´æ–°äº†page ABCï¼Œå´©æºƒäº†ä¹‹åï¼ŒBåäº†ï¼ŒACæ²¡é—®é¢˜ï¼Œè€Œä¸”ACè¿˜è½ç›˜äº†ï¼Œè¿™æ—¶å€™å¦‚æœç”¨redo logæ¢å¤ï¼Œåªç”¨å•ç‹¬æ¢å¤Bè¿™ä¸ªæ•°æ®é¡µï¼Œå°±ä¿è¯äº†ABC 3ä¸ªæ•°æ®é¡µéƒ½æ­£å¸¸ï¼Œè€Œbinlogå¹¶ä¸å…·å¤‡æ¢å¤å•ä¸ªæ•°æ®é¡µçš„èƒ½åŠ›ï¼Œæ‰€ä»¥å¦‚æœç”¨binlogæ¢å¤ï¼Œä¼šåŒæ—¶æ¢å¤ABCä¸‰ä¸ªæ•°æ®é¡µçš„å†…å®¹ï¼Œè€ŒACæ•°æ®é¡µæœ¬æ¥å†…å®¹å·²ç»æ˜¯å¯¹çš„ï¼Œè¿™æ ·æ¢å¤ååè€Œå°±åäº†ã€‚ï¼ˆæ¯”å¦‚åŸå…ˆå¯¹ACæ˜¯æ–°å¢æ“ä½œï¼Œé‚£ç­‰äºåˆå¯¹æ­£ç¡®æ•°æ®é”™è¯¯çš„æ–°å¢äº†ï¼‰","likes_number":25,"is_delete":false,"is_hidden":false,"ctime":1593596548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287426,"ip_address":""},"score":287942,"extra":""},{"author":{"id":1112491,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f9/ab/90f972d3.jpg","nickname":"ey","note":"","ucode":"5965D70E6A0F19","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1607318,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqWicbfC66qKRx32V1pNNSxJPhytPyZ612s9xN0uYHPnRJqNSWibdWg34jgKQn4YGLbs7hvAuHm0Sjg/132","nickname":"Geek_dc6fe6","note":"","ucode":"BA388E87D88D02","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":288589,"discussion_content":"ä½†å¦‚æœbinlogæ˜¯rowçº§åˆ«ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥åªæ¢å¤æ•°æ®é¡µBä¸Šçš„æ•°æ®è¡Œï¼Œè€Œä¸æ˜¯æ¢å¤ABCæ‰€æœ‰ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593806659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":287942,"ip_address":""},"score":288589,"extra":""}]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445458,"discussion_content":"æ˜¯è¿™æ ·çš„\nä¸€ä¸ªäº‹åŠ¡çš„binlogå¦‚æœå›æ”¾ï¼Œå°±æ˜¯é‡åšè¿™ä¸ªäº‹åŠ¡ï¼Œä¸€ä¸ªäº‹åŠ¡æ›´æ–°çš„å¯èƒ½ä¸æ­¢ä¸€ä¸ªpageã€‚\n\næ¯”å¦‚ä¸€ä¸ªäº‹åŠ¡æ›´æ–°äº†page ABC\nç„¶åå´©æºƒå›å¤äº†ï¼ŒBåäº†ï¼ŒACæ²¡é—®é¢˜ï¼Œè€Œä¸”ACè¿˜è½ç›˜äº†ã€‚\nè¿™æ ·å¦‚æœé‡åšäº‹åŠ¡ï¼ŒBå¥½äº†ï¼ŒACåˆåäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1554432249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50652,"user_name":"melon","can_delete":false,"product_type":"c1","uid":1023773,"ip_address":"","ucode":"7A80C20EBCAAA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/1d/ec173090.jpg","comment_is_top":false,"comment_ctime":1545024243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"74559468275","product_id":100020801,"comment_content":"æ€è€ƒé¢˜ï¼šåº”è¯¥æ˜¯ç¬¬ä¸‰ç§ï¼Œå› ä¸ºä¸¤ä¸ªäº‹åŠ¡å¹¶è¡Œæ‰§è¡Œè¯¥updateï¼Œæœ‰ä¸€ä¸ªä¼šå¡ä½ï¼Œè¯´æ˜æœ‰åŠ é”ï¼Œè€Œä¸”updateè¯­å¥æ‰§è¡Œåï¼ŒæŸ¥çœ‹ibdæ–‡ä»¶å’Œredo logæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´éƒ½æ›´æ–°äº†ã€‚é€šè¿‡show engine innodb status è¿›ä¸€æ­¥éªŒè¯ï¼ŒæŸ¥çœ‹LSNç¡®å®å¢åŠ äº†ï¼Œè€Œä¸”Number of rows updated ä¹ŸåŠ +1äº†ã€‚","like_count":17},{"had_liked":false,"id":50650,"user_name":"ä¿¡ä¿¡","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1545023651,"is_pvip":false,"replies":[{"id":"18279","content":"ä¸æ˜¯å“¦ï¼Œ<br>åœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´æ˜¯åœ¨redo log buffer.<br><br>åœ¨å›¾ä¸­å†™binlogä¹‹å‰ï¼Œå°±å·²ç»éƒ½å†™äº†ç›˜å¹¶ä¸”fsyncäº†","user_name":"ä½œè€…å›å¤","comment_id":50650,"uid":"1264162","ip_address":"","utype":1,"ctime":1545056146,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":13,"race_medal":0,"score":"65969533091","product_id":100020801,"comment_content":"å¦‚æœå›¾1çš„â€œå†™å…¥redo logâ€æ˜¯å†™å†…å­˜ï¼Œå½“æ—¶åˆ»Bå‘ç”Ÿcrashï¼Œé‡å¯åè¿™éƒ¨åˆ†redo logéƒ½ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆä½•è°ˆåˆ¤æ–­redo logæ˜¯å¦æœ‰å®Œæ•´çš„prepareè¿˜æ˜¯commitæ ‡å¿—å‘¢ï¼Ÿ","like_count":15,"discussions":[{"author":{"id":1060556,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2e/cc/964a8bcb.jpg","nickname":"ad","note":"","ucode":"7AC650031EB7A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":272453,"discussion_content":"æ–‡ä¸­ä¸æ˜¯è¯´â€œçœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„ã€‚â€ï¼Œè¿˜æ˜¯ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆåœ¨å†™binlogä¹‹å‰ï¼Œredo log bufferçš„æ•°æ®ä¸ºä»€ä¹ˆéƒ½è½ç›˜äº†","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1590310859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":6,"child_discussions":[{"author":{"id":1702886,"avatar":"https://static001.geekbang.org/account/avatar/00/19/fb/e6/1b9edb91.jpg","nickname":"ç»ƒä¹ ç”Ÿ","note":"","ucode":"60203A2AA0EA36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1060556,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2e/cc/964a8bcb.jpg","nickname":"ad","note":"","ucode":"7AC650031EB7A9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293955,"discussion_content":"è¿™å—æˆ‘ä¹Ÿæœ‰è¿·æƒ‘ã€‚åœ¨æ—¶åˆ»B crashæ—¶ï¼Œæ„Ÿè§‰å¯èƒ½ä¼šå‡ºç°binlogå·²ç»æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä½†ç”±äºä¹‹å‰çš„redologè¿˜æ˜¯è®°å½•åœ¨log bufferä¸­ï¼Œè€Œcrashå‘ç”Ÿåå†…å­˜ä¸­çš„æ•°æ®éƒ½å·²ç»ä¸¢å¤±äº†ã€‚å°±ä¼šé€ æˆåªæœ‰binlogï¼Œæ²¡æœ‰redoçš„æƒ…å†µï¼Œå¦‚æœä»åº“å¯¹Binlogè¿›è¡Œé‡æ”¾å°±ä¼šé€ æˆä¸»ä»æ•°æ®ä¸ä¸€è‡´çš„çŠ¶æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595739675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":272453,"ip_address":""},"score":293955,"extra":""},{"author":{"id":2131215,"avatar":"https://static001.geekbang.org/account/avatar/00/20/85/0f/5cb822d6.jpg","nickname":"shadow","note":"","ucode":"64DCFAEC37EFBC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1702886,"avatar":"https://static001.geekbang.org/account/avatar/00/19/fb/e6/1b9edb91.jpg","nickname":"ç»ƒä¹ ç”Ÿ","note":"","ucode":"60203A2AA0EA36","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301459,"discussion_content":"æ‰€ä»¥åœ¨å†™binlogæ˜¯ äº‹åŠ¡æäº¤äº† redo buffer ä¹Ÿè½ç›˜äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598530860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293955,"ip_address":""},"score":301459,"extra":""},{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1060556,"avatar":"https://static001.geekbang.org/account/avatar/00/10/2e/cc/964a8bcb.jpg","nickname":"ad","note":"","ucode":"7AC650031EB7A9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330548,"discussion_content":"å½“ä½ æ‰§è¡Œ commitè¯­å¥çš„æ—¶å€™ï¼Œå³ï¼Œå¼€å§‹æäº¤ï¼Œè¿™æ—¶æ‰§è¡Œå›¾ä¸­ å†™redo log fileï¼ŒæŠŠredo log bufferçš„å†…å®¹å†™å…¥ã€‚æ‰æœ‰åé¢çš„prepareç­‰ä¸€ç³»åˆ—æ“ä½œã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606644459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":272453,"ip_address":""},"score":330548,"extra":""}]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433053,"discussion_content":"ä¸æ˜¯å“¦ï¼Œ\nåœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´æ˜¯åœ¨redo log buffer.\n\nåœ¨å›¾ä¸­å†™binlogä¹‹å‰ï¼Œå°±å·²ç»éƒ½å†™äº†ç›˜å¹¶ä¸”fsyncäº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1545056146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1727799,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/5d/37/b3c7d6a0.jpg","nickname":"è£…ç¡çš„å°5éƒ","note":"","ucode":"F4CD1B8E65B6E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341798,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™ä¸ªç–‘é—®ï¼Œbinlogè½ç›˜äº†ï¼Œredologå¯èƒ½æ²¡è½ç›˜å‘€ï¼Œè¿™æ ·çš„è¯ä¸»ä»æ•°æ®å°±ä¸ä¸€è‡´äº†\nredologå’Œbinlogè½ç›˜æ˜¯ç”±å•ç‹¬çš„å‚æ•°æ§åˆ¶çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610526677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1727799,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/5d/37/b3c7d6a0.jpg","nickname":"è£…ç¡çš„å°5éƒ","note":"","ucode":"F4CD1B8E65B6E5","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372311,"discussion_content":"é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥è§£å†³çš„è¿™ä¸ªé—®é¢˜å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620284438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":341798,"ip_address":""},"score":372311,"extra":""}]},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587472,"discussion_content":"åŒ1æ‰èƒ½ä¿è¯ä¸ä¸¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663078082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1518795,"avatar":"","nickname":"Geek_2ac804","note":"","ucode":"EDF69B20030BB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570773,"discussion_content":"å¦‚æœbinlog_sync=1,innodb_flush_log_at_trx_commit=2ã€‚å°±å¯èƒ½å‡ºç°ä¸»æœºæ‰ç”µï¼Œredologä¸¢æ•°æ®ï¼Œä½†æ˜¯binlogä¸­çš„æ•°æ®æ˜¯æ²¡æœ‰ä¸¢çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651907602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2083270,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/c9/c6/cf8e9852.jpg","nickname":"dhlpj","note":"","ucode":"250ADDFEBC969D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387800,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628419597,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89481,"user_name":"greatcl","can_delete":false,"product_type":"c1","uid":1009449,"ip_address":"","ucode":"44D3C55394EC08","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/29/b0ec5430.jpg","comment_is_top":false,"comment_ctime":1556182723,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"57390757571","product_id":100020801,"comment_content":"çœ‹è¯„è®ºé‡Œæœ‰äººè¯´è¶³å¤Ÿæœ‰é’±æŠŠredo logè®¾ç½®æ— é™å¤§ï¼Œè€å¸ˆå·²ç»å›å¤è¯´ä¸èƒ½è®¾ç½®æ— é™å¤§ã€‚<br>åœ¨MySQLçš„ä¸€ä¸ªæ–‡æ¡£é‡Œhttps:&#47;&#47;dev.mysql.com&#47;doc&#47;refman&#47;5.6&#47;en&#47;innodb-init-startup-configuration.html#innodb-startup-log-file-configurationçœ‹åˆ°å…¨éƒ¨redo logæ–‡ä»¶çš„å¤§å°æ˜¯ä¸èƒ½è¶…è¿‡512GBçš„ã€‚<br>æ–‡æ¡£é‡Œå»ºè®®redo logå…¨éƒ¨æ–‡ä»¶æ€»å¤§å°çš„è®¾ç½®è¦èƒ½æ»¡è¶³ä¸šåŠ¡ç³»ç»Ÿä¸€ä¸ªå°æ—¶å†™æ“ä½œçš„é‡ï¼Œå½“ç„¶å¦‚æœç£ç›˜è¶³å¤Ÿè¿™ä¸ªæ˜¯èƒ½å°½é‡å¤§ç‚¹å°±å¤§ç‚¹çš„ã€‚<br>äºŒåˆ·èƒ½å­¦åˆ°æ›´å¤šçš„çŸ¥è¯†^_^","like_count":13,"discussions":[{"author":{"id":1770180,"avatar":"","nickname":"Geek_f5dbdf","note":"","ucode":"E21FBF68F7C6D0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572519,"discussion_content":"MARK","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652836647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1605161,"avatar":"https://static001.geekbang.org/account/avatar/00/18/7e/29/3ff55537.jpg","nickname":"èˆŸæ½‡","note":"","ucode":"01380F36DA7560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390517,"discussion_content":"redo logæ— é™å¤§æ˜¯ä¸æ˜¯æ„å‘³ç€å†…å­˜æ— é™å¤§...UÂ·ã‚§Â·U","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629872988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70465,"user_name":"Cy190622","can_delete":false,"product_type":"c1","uid":1381528,"ip_address":"","ucode":"578D804C29248E","user_header":"https://static001.geekbang.org/account/avatar/00/15/14/98/0251b8fd.jpg","comment_is_top":false,"comment_ctime":1551102701,"is_pvip":false,"replies":[{"id":"25198","content":"1. â€œflush æ“ä½œ:å°±æ˜¯åœ¨åˆ·æ–°change bufferä¸­æ•°æ®é¡µä¸Šçš„æ–°æ•°æ®ã€‚â€ é™¤äº†è¿™å¥ä¸å¤ªæ˜ç¡®å•¥æ„æ€ï¼Œ å…¶ä»–å¯¹çš„ã€‚<br>2. mergeæ˜¯change bufferåº”ç”¨åˆ°æ•°æ®é¡µï¼Œ   flushæ˜¯æ•°æ®é¡µä»å†…å­˜å†™åˆ°ç£ç›˜<br>","user_name":"ä½œè€…å›å¤","comment_id":70465,"uid":"1264162","ip_address":"","utype":1,"ctime":1551147958,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"48795742957","product_id":100020801,"comment_content":"è€å¸ˆæœ‰å‡ ä¸ªé—®é¢˜ï¼Œè¯·æ•™ä¸€ä¸‹ï¼š<br>ç–‘æƒ‘ç‚¹ï¼š<br>1. change bufferï¼šå­˜åœ¨buffer poolä¸­çš„æ•°æ®åº“ç¼“å­˜æ•°æ®ï¼Œé‡Œé¢çš„æ•°æ®å‘ˆæ•°æ®é¡µå½¢å¼å­˜åœ¨ï¼Œ<br>2.redo logï¼›å°†change buffer æ“ä½œæ•°æ®åº“çš„è¯­å¥æŒ‰ç…§é¡ºåºè®°å½•ï¼Œåå†é€‚å½“çš„æ—¶å€™ä¸€æ¬¡æäº¤ã€‚<br>æˆ‘çš„ç†è§£ä¸ºå¦ä¸€ç§ç¼“å­˜ã€‚<br>3.flush æ“ä½œ:å°±æ˜¯åœ¨åˆ·æ–°change bufferä¸­æ•°æ®é¡µä¸Šçš„æ–°æ•°æ®ã€‚<br>merge å°†change bufferä¸­çš„æ•°æ®åŒæ­¥åˆ°æ•°æ®åº“ï¼Œå¹¶è·å–æ–°çš„æ•°æ®é¡µçš„è¿‡ç¨‹ã€‚ <br><br>é—®é¢˜ï¼š1.éº»çƒ¦è€å¸ˆæŒ‡ä¸€ä¸‹å‰é¢æœ‰é”™è¯¯çš„åœ°æ–¹<br>\t  2.æ„Ÿè§‰merge å’Œflushä¸¤ä¸ªè¿‡ç¨‹å¾ˆè±¡ï¼Œè¿™ä¸¤ä¸ªæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<br>\t  æœ€åæ„Ÿè°¢è€å¸ˆçš„è€å¿ƒè§£ç­”ï¼Œè°¢è°¢æ‚¨ã€‚","like_count":11,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440648,"discussion_content":"1. â€œflush æ“ä½œ:å°±æ˜¯åœ¨åˆ·æ–°change bufferä¸­æ•°æ®é¡µä¸Šçš„æ–°æ•°æ®ã€‚â€ é™¤äº†è¿™å¥ä¸å¤ªæ˜ç¡®å•¥æ„æ€ï¼Œ å…¶ä»–å¯¹çš„ã€‚\n2. mergeæ˜¯change bufferåº”ç”¨åˆ°æ•°æ®é¡µï¼Œ   flushæ˜¯æ•°æ®é¡µä»å†…å­˜å†™åˆ°ç£ç›˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551147958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2805095,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/cd/67/8e8e65ce.jpg","nickname":"å®‰ä¹‹è‹¥ç´ ","note":"","ucode":"3B407E50680740","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558285,"discussion_content":"flush æ˜¯è½ç›˜ï¼Œ merge æ˜¯ä»ç£ç›˜å–å‡ºæ•°æ®é¡µåˆ°å†…å­˜ï¼Œå¯¹éƒ¨åˆ†æ•°æ®è¿›è¡Œæ›´æ–°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648190828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1785448,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/68/c2b2a285.jpg","nickname":"will","note":"","ucode":"6843B14B09192F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339524,"discussion_content":"Mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609720311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87022,"user_name":"å°ç™½","can_delete":false,"product_type":"c1","uid":1202143,"ip_address":"","ucode":"717B408EDC07FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Z8t0JKFjnmdx4s4wuRePZXRL2L9awEpicp0rjT9rfXmZKOBIleZuOC86OzZE0tSdkfy3LWWa7YU67MicWeiaFd3jA/132","comment_is_top":false,"comment_ctime":1555497740,"is_pvip":true,"discussion_count":8,"race_medal":0,"score":"35915236108","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¦æ¯”è¾ƒABçš„å¤§å°ï¼Œè¿™å¿«é€»è¾‘æ²¡æœ‰çœ‹æ‡‚<br><br>å¦‚æœæ˜¯ aå–œæ¬¢b  é‚£å°±insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1)<br>å¦‚æœæ˜¯ bå–œæ¬¢a  é‚£å°±insert into `like`(user_id, liker_id, relation_ship) values(B, A, 1)<br>ä¸æ˜¯åº”è¯¥è¿™ä¸ªé€»è¾‘ä¹ˆï¼Ÿæˆ‘ç†è§£é”™äº†å“ªé‡Œè€å¸ˆ<br>","like_count":8,"discussions":[{"author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":114120,"discussion_content":"è¿™ä¸ªåœ°æ–¹æˆ‘ä¹Ÿæ˜¯çœ‹äº†ä¸æ­¢ä¸€éï¼Œè¿™é‡Œçš„ABï¼Œå¹¶ä¸æ˜¯ç¡®åˆ‡çš„ç”¨æˆ·aå’Œç”¨æˆ·bï¼Œè€Œæ˜¯å¦‚æ–¹ç¨‹é‡Œé¢çš„å˜é‡xï¼Œyï¼Œå‡è®¾ï¼š\nç¬¬ä¸€æ¬¡çš„æ—¶å€™ï¼Œaçš„idä½3ï¼Œbçš„idä¸º4ï¼Œå½“aå…³æ³¨bæ—¶ï¼Œï¼ˆæ­¤æ—¶aå¯¹åº”çš„æ˜¯æ–‡ä¸­çš„Aï¼Œbå¯¹åº”çš„æ˜¯æ–‡ä¸­çš„Bï¼‰ç”±äºAçš„idå°äºBçš„idï¼Œæ‰€ä»¥é‡‡ç”¨ insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1)ï¼Œæ­¤æ—¶ like è¡¨ä¸­ user_id = 3,liker_id ä¸º4ï¼Œrelation_ship = 1ã€‚\nç¬¬äºŒæ¬¡çš„æ—¶å€™ï¼Œå½“bå…³æ³¨aæ—¶ï¼Œï¼ˆæ­¤æ—¶bå¯¹åº”çš„æ˜¯æ–‡ä¸­çš„Aï¼Œaå¯¹åº”çš„æ˜¯æ–‡ä¸­çš„Bï¼‰ï¼Œç”±äºAçš„idå¤§äºBçš„idï¼Œæ‰€ä»¥é‡‡ç”¨insert into `like`(user_id, liker_id, relation_ship) values(B, A, 2)ï¼ŒBå¯¹åº”çš„idä¸º3ï¼ŒAå¯¹åº”çš„idä¸º4ï¼Œrelation_ship = 2,ç”±äºé‡‡ç”¨äº†insert â€¦ on duplicateè¯­å¥ï¼Œæ­¤æ—¶relation_shipé‡‡ç”¨ä½è¿ç®— 1 ï½œ 2 ï¼Œç»“æœæ˜¯3ï¼Œå³ç”¨æˆ·aä¸ç”¨æˆ·bæ˜¯ç›¸äº’å–œæ¬¢ï¼Œå˜æˆäº†äº‹ä»¶3ï¼Œå°±ä¼šåœ¨friend è¡¨ä¸­æ·»åŠ ä¸¤è€…ç›¸äº’å–œæ¬¢çš„è®°å½•ã€‚","likes_number":18,"is_delete":false,"is_hidden":false,"ctime":1577958955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":163993,"discussion_content":"è°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581134878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":114120,"ip_address":""},"score":163993,"extra":""},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1723655,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/4d/07/7d331b04.jpg","nickname":"å°ç æ¸£","note":"","ucode":"8432409D9616D1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318961,"discussion_content":"è¯·é—®ä¸€ä¸‹ï¼Œä½ è§‰å¾—è€å¸ˆæ–¹æ¡ˆä¸­çš„è¿™æ®µsqlï¼Œå®é™…åœºæ™¯ä¸­å®ç°çš„è¯ç›´æ¥è‡ªå·±å°è£…åœ¨ä¸€ä¸ªmybatisçš„daoå±‚æ¥å£é‡Œé¢å—ï¼Ÿ\nmysql> begin; /*å¯åŠ¨äº‹åŠ¡*/\ninsert into `like`(user_id, liker_id, relation_ship) values(B, A, 2) on duplicate key update relation_ship=relation_ship | 2;\nselect relation_ship from `like` where user_id=B and liker_id=A;\n/*ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_shipï¼Œ\n  å¦‚æœæ˜¯2ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit\n  å¦‚æœæ˜¯3ï¼Œåˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥ï¼š\n*/\ninsert ignore into friend(friend_1_id, friend_2_id) values(B,A);\ncommit;\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603892780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":114120,"ip_address":""},"score":318961,"extra":""},{"author":{"id":2069957,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/95/c5/3307c1ca.jpg","nickname":"else","note":"","ucode":"201824A7615D6B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582257,"discussion_content":"è¿™ä¸ªè¿˜æ˜¯å¾—åŠ ä¸ªwhere åˆ¤æ–­ è¦ä¸ç„¶é‡å¤æ›´æ–°çš„æ—¶å€™ä¼šå‡ºç°é—®é¢˜ å› ä¸º|çš„æ—¶å€™æ˜¯å¢é‡çš„ åœ¨æ–°æ—§shipä¸ç›¸ç­‰çš„æ—¶å€™æ‰èƒ½æ›´æ–°æˆåŠŸå°±æ²¡é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659339268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":318961,"ip_address":"åŒ—äº¬"},"score":582257,"extra":""}]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"å­ç»","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318960,"discussion_content":"ä½ è¿™ç§ä¸æ˜¯è¿˜æ˜¯ä¼šå‡ºç°å¹¶å‘åœºæ™¯ä¸‹ï¼ŒA\\BåŒæ—¶å…³æ³¨å¯¹æ–¹ï¼Œç»“æœfriendè¡¨ä¸¢å¤±äº’ç›¸å…³æ³¨çš„é—®é¢˜å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603892276,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1674602,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJPHfGiaByESiaHPWbfQicjgap3unxDsxlG6JuUCNvEFJNLibNjeX4CQYNtsvXBXqTpBERUIPyiagGBXbg/132","nickname":"Geek_55a272","note":"","ucode":"7B12A9B322B3BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":136998,"discussion_content":"ä¸ºäº†ç»´æŠ¤å­—æ®µçš„å”¯ä¸€ç´¢å¼•å…³ç³»ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŸ¥è¯¢abçš„å¤§å°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579174658,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4756,"discussion_content":"ä¸ºäº†ç»´æŠ¤relation_shipçš„æ„ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565705047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1357056,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b5/00/f4e8fbaf.jpg","nickname":"chenpiing","note":"","ucode":"C847A30B3FDB8F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1885,"discussion_content":"åªç”¨ä¸€è¡Œè®°å½•è¡¨ç¤ºabä¹‹é—´çš„å…³ç³»ï¼Œè¿™æ ·abåŒæ—¶å…³æ³¨å¯¹æ–¹çš„æ—¶å€™éœ€è¦çš„æ˜¯åŒä¸€ä¸ªè¡Œé”ï¼Œå› æ­¤ä¸ä¼šä¸¢å¤±æ›´æ–°ï¼ŸåŠ ä¸Šrelation_shipæ˜¯ç”¨æŒ‰ä½ä¸æ›´æ–°çš„ï¼Œåªç”¨è¿™ä¸€ä¸ªå­—æ®µå°±çŸ¥é“abä¹‹é—´æ˜¯å•å‘å…³æ³¨è¿˜æ˜¯å¯ä»¥æˆä¸ºæœ‹å‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563033347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131038,"user_name":"leozhang","can_delete":false,"product_type":"c1","uid":1093819,"ip_address":"","ucode":"DAC9015821DAF1","user_header":"https://static001.geekbang.org/account/avatar/00/10/b0/bb/fc698888.jpg","comment_is_top":false,"comment_ctime":1567606457,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"31632377529","product_id":100020801,"comment_content":"åªè¦binlogåšå®•æœºæ¢å¤ï¼Œä¸çŸ¥é“æˆ‘ç†è§£å¯¹ä¸å¯¹ï¼Œè¯·è§£ç­”ä¸‹ï¼Œæˆ‘çœ‹ç•™è¨€ä¸­å¾ˆå¤šæœ‰å’Œæˆ‘ç±»ä¼¼çš„ç–‘é—®ï¼<br><br>å‡å¦‚ç°åœ¨æœ‰å†…å­˜ä¸­çš„æ•°æ®é¡µ pageA,pageB,pageC,<br>å‡å¦‚æ­¤æ—¶pageA æœ‰id=1,name=liu; pageBæœ‰id=2,name=liu; pageCæœ‰id=3,name=liuä¸‰ä¸ªè®°å½•ï¼Œ<br>åŒäº‹å’Œæ•°æ®åº“ç£ç›˜æ•°æ®ä¿æŒä¸€è‡´.å‡è®¾æ‰€æœ‰liuçš„åˆå§‹moneyä¸º0<br>æ­¤æ—¶æ‰§è¡Œupdate t set money=money+1 where name=liu;<br>è¿™ä¸ªæ—¶å€™å†™äº†binlogï¼Œå‡è®¾statementæ¨¡å¼åˆ™logæ—¥å¿—æ˜¯ update t set money=money+1 where name=liuï¼›<br>åŒæ—¶binlogæ—¥å¿—å†™ç£ç›˜æˆåŠŸï¼Œ<br>ç°åœ¨å»å§pageAï¼ŒpageBï¼ŒpageCåˆ·åˆ°ç£ç›˜ã€‚<br>åˆ·ç›˜çš„è¿‡ç¨‹ä¸­çªç„¶æ–­ç”µï¼ŒpageAï¼ŒpageBæˆåŠŸï¼ŒpageCå¤±è´¥äº†<br>æ­¤æ—¶å°±æ‚²å‚¬äº†ï¼ŒpageAå’ŒpageBçš„liu moneyä¸º1ï¼ŒpageCçš„liu moneyä¸º0<br>å‡è®¾æœ‰äº†binlogã€‚äº‹ç‰©æäº¤ï¼Œé‚£ä¹ˆè‚¯å®šå°±ä¸å¯¹äº†ï¼Œå› ä¸ºpageCæ•°æ®æ˜¯é”™è¯¯çš„<br>å‡å¦‚ç°åœ¨é‡åšäº‹ç‰©ï¼Œä¹Ÿå°±æ˜¯å†ä¸€æ¬¡æ‰§è¡Œåˆšåˆšbinlogçš„é‡åšæ—¥å¿—ã€‚<br>è¿™ä¸ªæ—¶å€™å¦‚æœé‡åšäº‹åŠ¡ï¼Œç»“æœä¹Ÿä¸å¯¹äº†ï¼Œæ˜¯ä¸æ˜¯pageCçš„ moneyå°±ä¸º-1äº†ï¼Œè¯·æŒ‡æ•™ï¼Œå¯èƒ½ä¸å¯¹<br><br>å…¶å®æœ€æ ¹æœ¬çš„è¿˜æ˜¯ï¼Œå½“åˆè®¾è®¡binlogçš„æ—¶å€™å°±æ²¡æƒ³crashæ¢å¤ï¼Œ<br>å†å°±æ˜¯binlogæ˜¯æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ”¹åŠ¨çš„ã€‚","like_count":7,"discussions":[{"author":{"id":1112676,"avatar":"https://static001.geekbang.org/account/avatar/00/10/fa/64/457325e6.jpg","nickname":"Sam Fu","note":"","ucode":"EA285A4943271F","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413105,"discussion_content":"æ„Ÿè§‰ä½ è¯´çš„å¯¹ redo logèƒ½åšåˆ°crash safe\næ˜¯å› ä¸ºã€‚è¿™æ˜¯æˆ‘å¯¹redo log çš„ç†è§£ï¼Œä¸çŸ¥é“å¯¹ä¸å¯¹ \n1. redo logæ˜¯è®°å½•çš„æŸä¸ªè¡¨ç©ºé—´ï¼ŒæŸä¸ªæ•°æ®é¡µçš„æŸåœ°å€åšäº†ä»€ä¹ˆä¿®æ”¹ã€‚\n2. redo logé€šè¿‡checkpointç»´æŠ¤å“ªäº›æ•°æ®è¿˜æœªåˆ·ç›˜ï¼Œæ¥å®ç°crash safeçš„èƒ½åŠ›ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1636382498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1215167,"avatar":"https://static001.geekbang.org/account/avatar/00/12/8a/bf/e9cc7d33.jpg","nickname":"ä½ å¯ä»¥çš„","note":"","ucode":"685A2307830876","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342604,"discussion_content":"æ‡‚äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610727253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":85177,"user_name":"Geek_maxwell","can_delete":false,"product_type":"c1","uid":1446442,"ip_address":"","ucode":"15FBD7BE46AC81","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbtcXw5PHzibHcXlupLmnZOYXBLR10U4Hvn5tib14EYlkMBERYgGlgZ63BxgFSBTQmUErfSXibcKl6w/132","comment_is_top":false,"comment_ctime":1554995016,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"31619766088","product_id":100020801,"comment_content":"çœ‹äº†ä¸€ç‚¹ç•™è¨€ï¼Œæœ‰å‡ ä¸ªé—®é¢˜æˆ‘æ€è€ƒåè€å¸ˆå¸®æˆ‘çœ‹çœ‹æ˜¯å¦æ­£ç¡®ï¼š<br>1 binlogä¸èƒ½æ¢å¤æ•°æ®ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºbinlogæ˜¯ä¸æ¸…æ¥šå­˜å‚¨å¼•æ“æœ‰å¤šå°‘å¢é‡æ²¡æœ‰å¤„ç†ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“å¯¹å®ƒæ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥binlogè®¾è®¡ä¹‹åˆå°±è®¤ä¸ºè¦æ¢å¤å°±æ˜¯å›æ”¾æ‰€æœ‰çš„binlogï¼Œæˆ–è€…ä»æŸä¸ªæ—¶é—´ç‚¹ä»åº“å¤‡ä»½å¼€å§‹æ¢å¤å‰©ä¸‹æ‰€æœ‰binlog<br>2 innodbå…·æœ‰æ¢å¤ï¼Œè¿™ä¸ªä¸»è¦æ˜¯å› ä¸ºå®ƒå°†æ•°æ®åˆ†ä¸ºå­˜é‡ï¼ˆè½ç›˜ï¼‰ + å¢é‡ï¼ˆchangeBuffer+å†…å­˜ä¸­è„é¡µï¼‰ï¼Œè€Œè¿™ä¸ªå¢ä¹Ÿæ­£å¥½æ˜¯WALä¸­çš„redolog + checkpointä¸¤ä¸ªæŒä¹…åŒ–çš„æ•°æ®ä»¥åŠå­˜é‡è”åˆå¾—åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå¢é‡çš„æ¢å¤å°±æ˜¯ä¸€ä¸ªå¯è¡Œæ€§å¾ˆé«˜ï¼Œä»£ä»·å¾ˆå°çš„æ“ä½œï¼Œå› æ­¤å°±æ˜¯å¯ä»¥å…·æœ‰æ•°æ®æ¢å¤èƒ½åŠ›<br>3 redologBufferï¼Œ è¿™ä¸ªæˆ‘æ„Ÿè§‰ä¸»è¦ä½œç”¨ä¸æ˜¯è¯´ä¸ºäº†prepareé˜¶æ®µåŠ é€Ÿï¼Œå› ä¸ºprepareå¿…ç„¶è¦sync ç£ç›˜ï¼Œå› ä¸ºäºŒé˜¶æ®µsyncä¹Ÿæ˜¯å…·æœ‰æŒä¹…åŒ–çš„ä¿è¯ï¼Œé‚£ä¹ˆå®ƒçš„åŠ é€Ÿåº”è¯¥æ˜¯ä¸ºäº†äº‹åŠ¡è¿‡ç¨‹ä¸­å¯¹äºå¿«é€Ÿå¾—åˆ°å¤šç‰ˆæœ¬ä¿¡æ¯å§ï¼Œå› ä¸ºéœ€è¦ç”¨åˆ°å¤šç‰ˆæœ¬çš„æƒ…å†µä¸‹ï¼Œæ‰€éœ€è¦å›æº¯çš„æ•°æ®æ€»ä¸èƒ½è¯»redologï¼Œé‚£å°±æ˜¯éšæœºè¯»äº†ï¼Œè€Œä¸”å¤šç‰ˆæœ¬ä¸€èˆ¬æƒ…å†µä¸‹å­˜åœ¨çš„é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨å†…å­˜ä¸­å­˜åœ¨ï¼Œè¿™æ˜¯ä¸ºäº†ä¼˜åŒ–éšæœºè¯»","like_count":7,"discussions":[{"author":{"id":1450778,"avatar":"https://static001.geekbang.org/account/avatar/00/16/23/1a/db7dd0e5.jpg","nickname":"æ¢§æ¡è¡—ç¯ä¸¶","note":"","ucode":"CC15DDDD933ABF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320305,"discussion_content":"å¤šç‰ˆæœ¬ä¿¡æ¯é‚£é‡Œï¼Œèƒ½ç»†è®²ä¸‹å—æ²¡çœ‹æ‡‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604316943,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1020492,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/92/4c/40783447.jpg","nickname":"ä½•éª§","note":"","ucode":"11DCC74CE2F300","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301148,"discussion_content":"ç¬¬ä¸‰ç‚¹æˆ‘è§‰å¾—å¾ˆæœ‰é“ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598424466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63907,"user_name":"linqw","can_delete":false,"product_type":"c1","uid":1134138,"ip_address":"","ucode":"09DCFE98C54DD8","user_header":"https://static001.geekbang.org/account/avatar/00/11/4e/3a/86196508.jpg","comment_is_top":false,"comment_ctime":1548590428,"is_pvip":false,"replies":[{"id":"22633","content":"<br><br>1. ä¸¤é˜¶æ®µæäº¤ä¸»è¦è¿˜æ˜¯å› ä¸ºæœ‰äº†ä¸¤ä»½æ—¥å¿—ğŸ˜†ï¼Œä¸¤ä»½æ—¥å¿—çš„å†å²åŸå› å¤šäº›ï¼›<br>2. å¯¹çš„ï¼ŒXID<br>3. æ˜¯ï¼Œè¦è€ƒè™‘binlogå’Œæ•°æ®çš„ä¸€è‡´æ€§ï¼›<br>4. å¯¹çš„<br>5. æ˜¯è„é¡µå“ˆ<br>6. ğŸ˜…<br>7. ä¸èƒ½è®¾ç½®æ— é™å¤§<br>8. æ˜¯ä¸æ˜¯æš—æ‹çš„å¦¹å­å‘ä½ è¡¨ç™½äº†ğŸ˜","user_name":"ä½œè€…å›å¤","comment_id":63907,"uid":"1264162","ip_address":"","utype":1,"ctime":1548637749,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":1,"race_medal":0,"score":"31613361500","product_id":100020801,"comment_content":"ç”±äºå·¥ä½œçš„åŸå› æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼Œæ²¡æœ‰çœ‹ï¼Œä¸ºæ­¤è¿™å‘¨æœ«èµ¶ç´§æ¶è¡¥äº†ä¸€ä¸‹ï¼Œåœ¨redo logå’Œbinlogçš„ç­”ç–‘ä¸­ï¼Œå†™ä¸‹è‡ªå·±çš„ç†è§£ï¼Œè€å¸ˆå¸®å¿™çœ‹ä¸‹å“¦<br>1ã€redo logå’Œbinlogé‡‡ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œç›®çš„æ˜¯ä¸ºäº†åŒæ–¹èƒ½å¤šä¸€ä¸ªé€‰æ‹©ï¼Œåœ¨mysqlå®•æœºæ—¶ï¼Œå¦‚æœredo logå¤„äºcommitï¼Œäº‹åŠ¡ç›´æ¥æäº¤ï¼Œå¦‚æœredo logå¤„äºprepareï¼Œbinlogå®Œæ•´äº‹åŠ¡ä¹Ÿæäº¤ï¼Œåªæœ‰åœ¨binlogä¸å®Œæ•´æ—¶ï¼Œäº‹åŠ¡ä¼šå›æ»šï¼Œä»¥å‰æ›´æ–°æ•°æ®é¡µä¼šä¸¢å¤±ã€‚<br>2ã€redo logå¦‚ä½•å’Œbinlogè”ç³»åœ¨ä¸€èµ·ï¼ŒXIDï¼Œåœ¨æœåŠ¡é‡å¯å¯åŠ¨æ—¶ï¼Œä¼šæ‰«æredo logä¸­xidå­—æ®µåˆ°binlogä¸­ï¼Œæ‰¾ç›¸å¯¹åº”çš„äº‹åŠ¡ï¼Œåˆ¤æ–­binlogçš„çŠ¶æ€æ˜¯å¦éœ€è¦æäº¤<br>3ã€èƒ½å¦åœ¨redo logå†™å®Œæ•´åœ¨å†™binlogä¹ˆï¼Ÿä¸è¡Œï¼Œå› ä¸ºredo logå†™å®Œï¼Œè¡¨ç¤ºäº‹åŠ¡å·²ç»æäº¤ï¼Œå¦‚æœåœ¨binlogå†™å…¥çš„è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œä¼šå¯¼è‡´redo logå’Œbinlogçš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå¦‚æœä½¿ç”¨binlogæ¢å¤åº“ï¼Œä¼šå¯¼è‡´ä¸»åº“å’Œä»åº“çš„æ•°æ®ä¸ä¸€è‡´ï¼Œå› ä¸ºredo logå·²æäº¤ï¼Œbinlogæ²¡æœ‰å†™å…¥æˆåŠŸï¼Œä¸ºæ­¤éœ€è¦é‡‡ç”¨ä¸¤é˜¶æ®µæäº¤ã€‚<br>4ã€redo logå’Œredo bufferçš„è”ç³»ï¼Ÿ<br>å³åœ¨æ•°æ®æ›´æ–°æ—¶ï¼Œä¼šå…ˆå†™redo bufferï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åœ¨å†™redo logæ—¶ï¼Œå…ˆæŠŠæ•°æ®ä¿å­˜èµ·æ¥ï¼Œåœ¨commitæ—¶åœ¨æŠŠæ•°æ®å†™å…¥redo logä¸­ï¼Œå› ä¸ºè¿™æ ·æ›´æ–°çš„æ—¶å€™ä¼šæ›´å¿«ï¼Œç›´æ¥æ›´æ–°å†…å­˜ï¼Œåœ¨äº‹åŠ¡å¤„äºcmmitæ—¶ï¼Œæ‰å°†å†…å­˜ä¸­çš„æ•°æ®å†™åˆ°redo logä¸­ã€‚<br>5ã€æ•°æ®é¡µå›å¤æ˜¯ä½¿ç”¨buffer poolè¿˜æ˜¯redo logï¼Ÿ<br>redo logåªæœ‰åœ¨æ•°æ®é¡µå‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œå°†å…¶æ‹¿æ¥æ¢å¤ä¸Šæ¬¡æ›´æ–°çš„æ•°æ®é¡µï¼Œä½†æ˜¯redo logæ²¡æœ‰è®°å½•å®Œæ•´çš„æ•°æ®é¡µæ•°æ®ï¼Œä¸ºæ­¤åœ¨æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œéƒ½æ²¡æœ‰ä½¿ç”¨redo logï¼Œæ˜¯ä½¿ç”¨buffer poolå°†èµ·å†…éƒ¨ä»¥å‰çš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼Œå…¶å®æƒ³è¯´ï¼Œè„ï¼ˆè¿™ä¸ªå­—ä¸ä¼šæ‰“ï¼Œå°´å°¬çš„ä¸€æ‰¹ï¼‰æ•°æ®ï¼Ÿ<br>6ã€redo logä¸€èˆ¬è®¾ç½®å¤šå¤§ï¼Ÿè¿™ä¸ªè€å¸ˆä¸Šé¢è¯´çš„å¾ˆæ¸…æ¥šï¼Œå¦‚æœç£ç›˜çš„å®¹é‡å¤§ï¼Œå°±å¤šæç‚¹ï¼Œå¦‚æœå°çš„è¯å¯ä»¥å‘å…¬å¸ç”³è¯·ä¹°å¥½è®¾å¤‡ï¼Œè¦æ˜¯ä¸åŒæ„çš„è¯ï¼Œå°±å¾—é—®ä½ ä»¬è€æ¿äº†ï¼Œé¡¹ç›®å·²siï¼Œå¼€ç©ç¬‘ï¼Œå“ˆå“ˆå“ˆã€‚<br>7ã€åªç”¨redo logï¼Ÿå…¶å®ä½ è¦æ˜¯å…¬å¸æœºå™¨å¤Ÿå¤§ï¼Œå¯ä»¥è®¾ç½®æˆæ— é™å¤§ï¼Œé¢ï¼Œå¯ä»¥å‡è£…binlogï¼Œé¢ï¼Œå¼€ç©ç¬‘çš„ï¼Œå› ä¸ºredo logåªæœ‰å¾ªç¯å†™ï¼Œæ²¡æ³•å½“åšbinlogï¼Œåªè¦æœ‰é’±å°±ä¸å¥½è¯´äº†ã€‚<br>8ã€åªç”¨binlogï¼Ÿä¸è¡Œï¼Œä¸ºå•¥ä¸è¡Œï¼Œç™¾åº¦å•Šï¼Œä¸è¡Œè°·æ­Œï¼Œå¥½å•¦ï¼Œå¼€ç©ç¬‘ï¼Œå‘ä¸€ä¸‹çƒ§ï¼Œå› ä¸ºå¦‚æœåœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢ï¼ŒåŒæ—¶å†™binlogï¼Œä½ çœ‹çœ‹ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸€ä¸ªæˆåŠŸæ‰§è¡Œï¼Œä¸€ä¸ªæ‰§è¡Œå¤±è´¥ï¼Œé‚£ä¼šå¯¼è‡´ä¸€ä¸ªbinlogå¯ä»¥å›å¤æ•°æ®é¡µï¼Œä¸€ä¸ªä¸è¡Œï¼Œä¸ºæ­¤ï¼Œå¯¼è‡´æ•°æ®é¡µä¸ä¸€è‡´ï¼Œå¥½äº†ï¼Œä»Šå¤©ä¸çŸ¥é“ä¸ºå•¥é‚£ä¹ˆå…´å¥‹ï¼Œé¢ï¼Œå¯èƒ½æ˜¯ï¼Œä½ çŒœå§ï¼Œå¥½äº†ï¼Œå†™å®Œæˆ‘ä¹Ÿå¿˜äº†ï¼Œä¸€èµ·æ‹ç –","like_count":7,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437758,"discussion_content":"\n\n1. ä¸¤é˜¶æ®µæäº¤ä¸»è¦è¿˜æ˜¯å› ä¸ºæœ‰äº†ä¸¤ä»½æ—¥å¿—ğŸ˜†ï¼Œä¸¤ä»½æ—¥å¿—çš„å†å²åŸå› å¤šäº›ï¼›\n2. å¯¹çš„ï¼ŒXID\n3. æ˜¯ï¼Œè¦è€ƒè™‘binlogå’Œæ•°æ®çš„ä¸€è‡´æ€§ï¼›\n4. å¯¹çš„\n5. æ˜¯è„é¡µå“ˆ\n6. ğŸ˜…\n7. ä¸èƒ½è®¾ç½®æ— é™å¤§\n8. æ˜¯ä¸æ˜¯æš—æ‹çš„å¦¹å­å‘ä½ è¡¨ç™½äº†ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548637749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50485,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":false,"comment_ctime":1544980948,"is_pvip":false,"replies":[{"id":"18171","content":"1. å—¯ï¼Œå®ƒæœ‰å•ç‹¬çš„å†…å­˜ï¼Œredo log buffer<br><br>2. Binlog cache sizeä¹Ÿæ˜¯global çš„å‘€ï¼Œæˆ‘è¿˜å»ç¡®è®¤äº†5.5ï½5.7ï¼Œä½ ç”¨çš„æ˜¯å“ªä¸ªç‰ˆæœ¬ï¼Ÿ<br><br>3. è¿™ä¸ªæ•°æ®æ˜¯æ€ä¹ˆå¾—åˆ°çš„ğŸ˜„<br><br>4. å†™å®Œç£ç›˜å°±å‘ï¼Œç„¶åå†å›æ¥flushã€‚ <br>     ä¸æ˜¯ï¼Œæ”¾åœ¨binlog cacheè¡¨ç¤ºâ€œè¿™äº‹åŠ¡è¿˜æ²¡åšå®Œâ€ï¼Œä¸å‘çš„","user_name":"ä½œè€…å›å¤","comment_id":50485,"uid":"1264162","ip_address":"","utype":1,"ctime":1545018930,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":9,"race_medal":0,"score":"27314784724","product_id":100020801,"comment_content":"è€å¸ˆæå‡ ä¸ªé—®é¢˜ï¼š<br>1.äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œbinlogæ˜¯å¦åƒredo logä¸€æ ·è®°å½•åˆ°binlog_cacheé‡Œï¼Ÿ<br>2.ä¸ºä»€ä¹ˆæŠŠredo log bufferè®¾ç½®æˆå…¨å±€å‚æ•°ï¼Œbinlog cacheè®¾ç½®ä¸ºäº‹åŠ¡çº§åˆ«å‚æ•°ï¼Ÿ<br>3.ä¸ºä»€ä¹ˆä¸€èˆ¬æ˜¯binlogè½ç›˜æ¯”redo logæ›´è€—æ—¶ï¼Ÿ<br>4.å¦‚æœsyncä¸º1ï¼Œdumpçº¿ç¨‹æ˜¯ç­‰åˆ°binlog æˆåŠŸflushï¼Œå†ä»binlog cacheä¸­æŠŠbinlog eventå‘é€ç»™ä»åº“ï¼Ÿå¦‚æœé1,æ˜¯åœ¨æœ€åxidå†™å…¥å°±ä»binlog cacheä¸­æŠŠbinlog eventå‘é€ç»™ä»åº“ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":432994,"discussion_content":"1. å—¯ï¼Œå®ƒæœ‰å•ç‹¬çš„å†…å­˜ï¼Œredo log buffer\n\n2. Binlog cache sizeä¹Ÿæ˜¯global çš„å‘€ï¼Œæˆ‘è¿˜å»ç¡®è®¤äº†5.5ï½5.7ï¼Œä½ ç”¨çš„æ˜¯å“ªä¸ªç‰ˆæœ¬ï¼Ÿ\n\n3. è¿™ä¸ªæ•°æ®æ˜¯æ€ä¹ˆå¾—åˆ°çš„ğŸ˜„\n\n4. å†™å®Œç£ç›˜å°±å‘ï¼Œç„¶åå†å›æ¥flushã€‚ \n     ä¸æ˜¯ï¼Œæ”¾åœ¨binlog cacheè¡¨ç¤ºâ€œè¿™äº‹åŠ¡è¿˜æ²¡åšå®Œâ€ï¼Œä¸å‘çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545018930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592754,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4d/b2/f6c20f2f.jpg","nickname":"åºšåˆé©¬","note":"","ucode":"F3FD8C8D8352AA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579406,"discussion_content":"è·¨IDCæˆ–è€…è·¨åŸåŠåŒæ­¥ï¼Œæˆ–è€…ä¸æ”¯æŒäº‹åŠ¡çš„Binlogäº‹ä»¶è§£æï¼Œè§¦å‘æ¦‚ç‡æ›´é«˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657433498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1107305,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e5/69/719ec5d0.jpg","nickname":"Jian","note":"","ucode":"17ED4919F22DEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335250,"discussion_content":"ç¬¬4ç‚¹ï¼Œæˆ‘ä»¬æœ€è¿‘åœ¨ä¸»ä»æ¶æ„ä¸‹ï¼Œå‡ºç°â¼€ç§å¾ˆæç«¯çš„æƒ…å†µï¼Œä»åº“æ”¶åˆ°binlogç„¶åè§£æé‡Œé¢çš„å†…å®¹ï¼Œå†æ ¹æ®é‡Œé¢çš„å†…å®¹å»ä¸»åº“æŸ¥ï¼Œæ­£å¸¸åº”è¯¥æ˜¯æœ€æ–°è®°å½•ï¼Œä½†æˆ‘ä»¬æŸ¥å‡ºäº†è€çš„è®°å½•ï¼Œæ€€ç–‘ä¸»åº“è¿˜æ²¡åˆ·ç›˜ï¼Œç°åœ¨è¿™ä¸ªé—®é¢˜è¿˜æ²¡å¾—è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608128112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":6,"child_discussions":[{"author":{"id":1308784,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","nickname":"æŸã€äºº","note":"","ucode":"ADB42AA12A11C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1107305,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e5/69/719ec5d0.jpg","nickname":"Jian","note":"","ucode":"17ED4919F22DEC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335405,"discussion_content":"å¦‚æœä¸»åº“æŸ¥ä¸åˆ°è®°å½•ï¼Œé‚£ä¹ˆè¯´æ˜ä¸»åº“ä¸Šè¯¥äº‹åŠ¡è¿˜æœªæäº¤æˆåŠŸï¼Œè·Ÿæ•°æ®é¡µåˆ·ä¸åˆ·ç›˜æ²¡æœ‰å…³ç³»ã€‚å¦‚æœæäº¤æˆåŠŸäº†ï¼Œéƒ½æ˜¯å…ˆæŸ¥buffer pool,æ²¡æœ‰æ‰ä¼šå»æŸ¥ç£ç›˜ã€‚è¿™ä¸ªæ˜¯ä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œæ‰ä¼šå‡ºç°ä½ è¯´çš„é—®é¢˜å‘¢ï¼Ÿä¸»åº“åŒæ­¥è¿‡ç¨‹ä¸­æŒ‚äº†å˜›ï¼Œè¿˜æ˜¯æäº¤è¿‡ç¨‹ä¸­hangä½äº†å•Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608185461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335250,"ip_address":""},"score":335405,"extra":""},{"author":{"id":1308784,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","nickname":"æŸã€äºº","note":"","ucode":"ADB42AA12A11C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1107305,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e5/69/719ec5d0.jpg","nickname":"Jian","note":"","ucode":"17ED4919F22DEC","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335406,"discussion_content":"sync binlogæ˜¯å¦ä¸ä¸º1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608185559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335250,"ip_address":""},"score":335406,"extra":""},{"author":{"id":1107305,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e5/69/719ec5d0.jpg","nickname":"Jian","note":"","ucode":"17ED4919F22DEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1308784,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","nickname":"æŸã€äºº","note":"","ucode":"ADB42AA12A11C1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335726,"discussion_content":"ä½ è¯´äº†å¯¹ï¼Œæ„Ÿè§‰æ˜¯ä¸»åº“çš„äº‹åŠ¡è¿˜æ²¡æäº¤æˆåŠŸã€‚ä½†binlogéƒ½è½ç›˜äº†ï¼Œè¿™æ—¶redo logæŠŠçŠ¶æ€è¯¥ä¸ºcommitåº”è¯¥å¾ˆå¿«å‘€ï¼Œä½†é€šè¿‡binlogé‡Œçš„å†…å®¹å†å»æŸ¥ä¸»åº“ï¼Œäº‹åŠ¡ç«Ÿç„¶è¿˜æ²¡æäº¤æˆåŠŸã€‚æ˜¯ä¸æ˜¯redo logå¿…é¡»æ˜¯è¦å…¨éƒ¨è½ç›˜æ‰ä¼šæ”¹çŠ¶æ€ä¸ºcommitå‘€ï¼Ÿå› ä¸ºæˆ‘ä»¬è¿™ä¸ªåœºæ™¯ç±»ä¼¼ä¸è¿™ç¯‡æ–‡ç« https://mp.weixin.qq.com/s/Wb5gpeXAJKs45zIKJKLzKwã€‚å¦å¤–æˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªå¤§äº‹åŠ¡é‡Œæ‰å‡ºç°è¿‡è¿™ç§æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608285399,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":335405,"ip_address":""},"score":335726,"extra":""}]}]},{"had_liked":false,"id":56311,"user_name":"è§‚å¼ˆé“äºº","can_delete":false,"product_type":"c1","uid":1016905,"ip_address":"","ucode":"F3BB619A33C605","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/49/47d48fd0.jpg","comment_is_top":false,"comment_ctime":1546419546,"is_pvip":false,"replies":[{"id":"20255","content":"ä¸æ˜¯Aå…³æ³¨Bï¼Œå°±æ˜¯Aå¤§äºBï¼Œè¯´çš„æ˜¯ç”¨æˆ·idå“¦","user_name":"ä½œè€…å›å¤","comment_id":56311,"uid":"1264162","ip_address":"","utype":1,"ctime":1546421215,"user_name_real":"æ—æ™“æ–Œ"}],"discussion_count":3,"race_medal":0,"score":"23021256026","product_id":100020801,"comment_content":"ä¸è€å¸ˆï¼Œä¸å¥½æ„æ€ï¼Œåˆšæ‰æçš„A &gt; B, A &lt; Bé—®é¢˜ï¼Œæˆ‘è¦å†é‡å¤ä¸€ä¸‹ã€‚A &gt; B: åº”è¯¥æ˜¯è¡¨ç¤ºå½“å‰ä¸šåŠ¡æ“ä½œä¸ºAç”¨æˆ·å…³æ³¨Bç”¨æˆ·, sqlä¸º: insert into like(&#39;a_user_id&#39;, &#39;b_user_id&#39;, 1), å¦‚æœåå‘å…³è”åˆ™ä¸ºinsert into like(&#39;b_user_id&#39;, &#39;a_user_id&#39;, 2), äº’ç›¸å…³è”åˆ™relation_ship update ä¸º3, æ‚¨çš„æ„æ€æ˜¯é€šè¿‡relation_shipè¡¨ç¤ºuser_id,liker_idå“ªä¸ªä¸ºè¢«å…³æ³¨æ–¹,å“ªä¸ªæ˜¯å…³æ³¨æ–¹ï¼Œæ‰€ä»¥ï¼Œæˆ‘è¿˜æ˜¯ç†è§£ A &gt; B ,ä¸åº”è¯¥ç†è§£æˆ A å¤§äº B,è€Œæ˜¯A å…³æ³¨ Bï¼Œæˆ‘è®¤ä¸ºA å¤§äº Bçš„æ¯”è¾ƒæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ¯”è¾ƒç–‘æƒ‘æˆ‘è¿™æ ·ç†è§£åå·®åœ¨å“ªé‡Œ?ğŸ˜–","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434982,"discussion_content":"ä¸æ˜¯Aå…³æ³¨Bï¼Œå°±æ˜¯Aå¤§äºBï¼Œè¯´çš„æ˜¯ç”¨æˆ·idå“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546421215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2457254,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/suQ8EerOp4VHR1NCIAnoc2xuUw4V4ticYZMeOZhZG3yDEH0o7Cnsc3IS2m3ES1cvmibekzjQCSZzsq63pjGicPdlg/132","nickname":"Geek_a733e5","note":"","ucode":"A556FCD8643347","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577672,"discussion_content":"åŒå­¦ï¼Œä½ ææ˜ç™½äº†æ²¡ï¼Ÿæˆ‘ä¹Ÿä¸æ‡‚ï¼Œä¸ºå•¥ user_idä¼šæœ‰å’Œlike_idçš„å¤§å°å…³ç³»ï¼Œå¤§äºï¼Œå°±æ˜¯1,","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656292738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1614499,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRXPleVJnXU4gib2Hib5xR7jMmAgVPs1GKuJ39ib8HvnVk79Q3k8STLhOcCcO2rjKSuuMLFRekCyL2A/132","nickname":"Geek_slk","note":"","ucode":"413CDBEF0B7679","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381344,"discussion_content":"ç”¨æˆ·id æŒ‡çš„userIDä¹ˆ è¿˜æ˜¯è¯´likeè¡¨çš„ä¸»é”®id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625018757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63257,"user_name":"å¿µä½ å¦‚æ˜”","can_delete":false,"product_type":"c1","uid":1323531,"ip_address":"","ucode":"FCAD88AB57D084","user_header":"https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg","comment_is_top":false,"comment_ctime":1548312923,"is_pvip":false,"replies":[{"id":"22412","content":"æ˜¯çš„ï¼Œæ‰€ä»¥å®ƒå«åšâ€œbufferâ€ï¼Œè¿˜ç®—æ˜¯é¡¾åæ€ä¹‰çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548321799,"ip_address":"","comment_id":63257,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18728182107","product_id":100020801,"comment_content":"å¯¹redo  log  buffer æ¥è¯´ï¼Œæˆ‘è®¤ä¸ºä»–å­˜åœ¨çš„å¿…è¦å°±æ˜¯ä»…ä»…æ˜¯åšä¸ªç¼“å­˜ä½¿ç”¨è€Œå·²ï¼Œä¹Ÿå°±æ˜¯è®©åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œdmlå¿«ç‚¹è€Œå·²ï¼Œæ¯•ç«Ÿå†™åˆ°bufferæ¯”ç›´æ¥å†™åˆ°redologfileå¿«ã€‚è€Œredo log buffer æ˜¯æœ‰è§¦å‘æœºåˆ¶çš„ï¼Œä¸€ä¸ªå¤§äº‹åŠ¡ä¸­ï¼Œå¦‚æœç”Ÿæˆçš„redologå¾ˆå¤šï¼Œåœ¨äº‹åŠ¡æœªæäº¤ä¹‹å‰ï¼Œlog æ˜¯è¿˜ä¼šä» redolog bufferå†™åˆ° redolog fileé‡Œçš„ã€‚","like_count":4,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437524,"discussion_content":"æ˜¯çš„ï¼Œæ‰€ä»¥å®ƒå«åšâ€œbufferâ€ï¼Œè¿˜ç®—æ˜¯é¡¾åæ€ä¹‰çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548321799,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51011,"user_name":"mahonebags","can_delete":false,"product_type":"c1","uid":1326752,"ip_address":"","ucode":"A5327768A558E9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqWbl76C5icKJ0NvTQ7hWMXZq99srhzUlpmD4xcatNFia9tdvbBGHSwXvnXo1Lhp8U9T2V3iauImSf7w/132","comment_is_top":false,"comment_ctime":1545098787,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14430000675","product_id":100020801,"comment_content":"æˆ‘ç»™è¡¨æ–°åŠ äº†ä¸€ä¸ªupdate_time on update current_timestampå­—æ®µï¼Œå‘ç°ä¼šåŠ é”ï¼Œä½†æ˜¯æäº¤åupdate_timeä¸ä¼šå˜åŒ–ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰binlogç”Ÿæˆï¼Œæ‰€ä»¥æ˜¯åŠ é”äº†ä½†æ˜¯å®é™…æ²¡æ›´æ–°ï¼Ÿ","like_count":3},{"had_liked":false,"id":50859,"user_name":"Laputa","can_delete":false,"product_type":"c1","uid":1079345,"ip_address":"","ucode":"64C157042CF138","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/31/c7f8d1db.jpg","comment_is_top":false,"comment_ctime":1545056031,"is_pvip":false,"replies":[{"id":"18285","content":"æœ‰ç´¢å¼•çš„è¯ï¼ŒåŠ ä¸€ä¸ªé—´éš™é”ï¼›<br>æ²¡ç´¢å¼•çš„è¯ï¼ŒåŠ æ‰€æœ‰è¡Œçš„è¡Œé”å’Œæ‰€æœ‰é—´éš™çš„é—´éš™é”","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545057027,"ip_address":"","comment_id":50859,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14429957919","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå¦‚æœç»™ä¸å­˜åœ¨çš„idåŠ é”ä¼šæ€æ ·ï¼Œä¼šåŠ ä¸ä¸Šé”è¿˜æ˜¯ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433145,"discussion_content":"æœ‰ç´¢å¼•çš„è¯ï¼ŒåŠ ä¸€ä¸ªé—´éš™é”ï¼›\næ²¡ç´¢å¼•çš„è¯ï¼ŒåŠ æ‰€æœ‰è¡Œçš„è¡Œé”å’Œæ‰€æœ‰é—´éš™çš„é—´éš™é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545057027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1788647,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","nickname":"æ±‰æ±Ÿ","note":"","ucode":"01622D984B8F9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342704,"discussion_content":"è€å¸ˆ  ä½ çš„å›ç­”åº”è¯¥è¦è¯´æ˜éš”ç¦»çº§åˆ«å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610783721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50696,"user_name":"éƒ­æ±Ÿä¼Ÿ","can_delete":false,"product_type":"c1","uid":1313994,"ip_address":"","ucode":"613D638619B5A2","user_header":"https://static001.geekbang.org/account/avatar/00/14/0c/ca/6173350b.jpg","comment_is_top":false,"comment_ctime":1545030826,"is_pvip":false,"replies":[{"id":"18278","content":"Hexdumpå‰æœ‰æ²¡æœ‰å…³é—­MySQL?","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055802,"ip_address":"","comment_id":50696,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14429932714","product_id":100020801,"comment_content":"åˆ›å»ºæµ‹è¯•æ•°æ®ï¼š<br>mysql&gt; create table t(id int primary key auto_increment,a int );<br>mysql&gt; insert into t values(1,2);<br>mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)<br>mysql&gt; update t set a=2 where id=1;<br>Query OK, 0 rows affected (0.00 sec)<br>æŸ¥çœ‹ç³»ç»Ÿé”æƒ…å†µï¼š<br>show engine innodb status<br>---TRANSACTION 958998, ACTIVE 51 sec<br>2 lock struct(s), heap size 1136, 1 row lock(s)<br>MySQL thread id 2, OS thread handle 139663691581184, query id 22 localhost root<br>mysql&gt; show processlist;<br>+----+------+-----------+--------------------+---------+------+----------+------------------+<br>| Id | User | Host      | db                 | Command | Time | State    | Info             |<br>+----+------+-----------+--------------------+---------+------+----------+------------------+<br>|  2 | root | localhost | sysbench           | Sleep   |  352 |          | NULL             |<br>|  3 | root | localhost | NULL               | Sleep   |  301 |          | NULL             |<br>+----+------+-----------+--------------------+---------+------+----------+------------------+<br>å…¶ä¸­Thread id=2 ä¸ºupdateä¼šè¯ï¼Œè¯´æ˜ç³»ç»Ÿæœ‰é”<br>å¦ä¸€ä¼šè¯æ‰§è¡Œ update t set a=2 where id=1;<br>ERROR 1205 (HY000): Unknown error 1205 MySQL error code 1205 (ER_LOCK_WAIT_TIMEOUT): Lock wait timeout exceeded; try restarting transaction<br>æäº¤ç¬¬ä¸€ä¸ªä¼šè¯æŸ¥çœ‹ç”Ÿæˆçš„binlog<br>### INSERT INTO `sysbench`.`t`<br>### SET<br>###   @1=1 &#47;* INT meta=0 nullable=0 is_null=0 *&#47;<br>###   @2=2 &#47;* INT meta=0 nullable=1 is_null=0 *&#47;<br># at 858<br>#181217 14:28:21 server id 9012  end_log_pos 889 CRC32 0xf96f7fcb \tXid = 20<br>COMMIT&#47;*!*&#47;;<br># at 889<br>#181217 14:42:14 server id 9012  end_log_pos 930 CRC32 0x3de034ba \tRotate to bin.000089  pos: 4<br>SET @@SESSION.GTID_NEXT= &#39;AUTOMATIC&#39; &#47;* added by mysqlbinlog *&#47; &#47;*!*&#47;;<br>DELIMITER ;<br># End of log file<br>&#47;*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*&#47;;<br>&#47;*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*&#47;;<br>å‘ç°æ²¡æœ‰updateçš„binlogäº§ç”Ÿï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥è¯­å¥åœ¨serverå±‚æ²¡æœ‰å®é™…æ‰§è¡Œ<br>ç”¨hexdumpå¯¹æ¯”updateå‰åçš„æ•°æ®è¡Œï¼Œå‘ç°äº‹åŠ¡idå’Œå›æ»šidä¹Ÿæ²¡å˜ï¼Œè¯´æ˜innodbæ²¡æœ‰å®é™…æ›´æ–°è¡Œã€‚<br>é‰´äºè¯¥è¯­å¥äº§ç”Ÿäº†è¡Œé”ï¼Œæœ‰äº‹åŠ¡ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å®é™…ä¿®æ”¹ï¼Œå¯åˆ¤æ–­innodbåœ¨æ›´æ–°å‰åå€¼ä¸€æ ·æ—¶ä¸ä¼šå®é™…æ›´æ–°æ•°æ®","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433063,"discussion_content":"Hexdumpå‰æœ‰æ²¡æœ‰å…³é—­MySQL?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231543,"user_name":"Geek_a9b0fb","can_delete":false,"product_type":"c1","uid":2054473,"ip_address":"","ucode":"C22079C38EB7D7","user_header":"","comment_is_top":false,"comment_ctime":1593702782,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10183637374","product_id":100020801,"comment_content":"éº»çƒ¦é—®ä¸‹ï¼šbinlog æ²¡æœ‰èƒ½åŠ›æ¢å¤â€œæ•°æ®é¡µâ€æ²¡æ˜ç™½è¿™å¥è¯å•¥æ„æ€ï¼Ÿæœ‰ç‚¹æ‡µ","like_count":2},{"had_liked":false,"id":206613,"user_name":"æµ·å¼º","can_delete":false,"product_type":"c1","uid":1645684,"ip_address":"","ucode":"EF4971CD58E4E5","user_header":"https://static001.geekbang.org/account/avatar/00/19/1c/74/eb472cc3.jpg","comment_is_top":false,"comment_ctime":1586910359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10176844951","product_id":100020801,"comment_content":"æˆ‘ç†è§£ï¼Œå¹¶ä¸æ˜¯è¯´binlogä¸èƒ½æ¢å¤å‡ºæ•°æ®ï¼Œä»æœ€è¿‘ä¸€ä¸ªå…¨é‡å¤‡ä»½å¼€å§‹ï¼Œé€ä¸ªå›æ”¾binlogæ˜¯å¯ä»¥æ¢å¤æ•°æ®çš„ï¼Œåªä¸è¿‡è¿™ä¸ªä»£ä»·å¾ˆé«˜ï¼Œä¸é€‚åˆç”¨äºå¹³æ—¶çš„å´©æºƒæ¢å¤ã€‚","like_count":2},{"had_liked":false,"id":96650,"user_name":"å¼€å°èœ","can_delete":false,"product_type":"c1","uid":1543595,"ip_address":"","ucode":"6C25DAB0C4E1B3","user_header":"https://static001.geekbang.org/account/avatar/00/17/8d/ab/4dcbbc63.jpg","comment_is_top":false,"comment_ctime":1558484180,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10148418772","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘æƒ³é—®ä¸ªæ—¥å¸¸dbaå’Œå¼€å‘äººå‘˜ç»å¸¸é—®çš„é—®é¢˜ã€‚æ…¢SQLç¬¬ä¸€æ¬¡æŸ¥è¯¢å¾ˆæ…¢ï¼Œå†è·‘å°±å¿«äº†ã€‚æŸ¥è¯¢ç¼“å­˜æ˜¯å…³é—­çš„ã€‚æˆ‘çš„è§£é‡Šæ˜¯æ•°æ®å’Œç´¢å¼•ç¼“å­˜åˆ°buffer poolï¼Œå› ä¸ºæœ‰æ—¶è¦æŸ¥çœ‹ä¼˜åŒ–åçš„æ•ˆæœï¼Œä½†ç”±äºæœ‰ç¼“å­˜è€Œä¸çŸ¥é“å®é™…çš„ä¼˜åŒ–æ•ˆæœã€‚æˆ‘é€‰æ‹©é‡å¯ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒé‡Œåšå®éªŒã€‚ä½†æ˜¯å‘ç°é‡å¯ååŸæ¥æ…¢SQLè¿˜æ˜¯å¿«äº†ã€‚æŸ¥äº†èµ„æ–™è¿é¢„çƒ­æ•°æ®é¢„åŠ è½½æ˜¯å…³é—­äº†çš„ã€‚æ‰¾äº†å¾ˆä¹…èµ„æ–™æ²¡æœ‰è§£å†³ã€‚æœŸé—´è¿˜è¯•è¿‡å¯¹è¡¨è¿›è¡Œddlæ“ä½œæ²¡æ•ˆæœï¼Œå„ç§flushæ“ä½œæ²¡æ•ˆæœï¼Œæ¯”å¦‚flush tablesã€‚ä¸çŸ¥é“å¦‚ä½•æ‰èƒ½è¿˜åŸSQLä¹‹å‰çš„æ…¢åœºæ™¯ï¼Œè°¢è°¢ã€‚","like_count":2,"discussions":[{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557317,"discussion_content":"å¯èƒ½æ˜¯é‚£æ¬¡æ…¢æŸ¥è¯¢çš„æ—¶å€™æ•°æ®åº“æœ¬èº«å‹åŠ›å°±å¾ˆå¤§\n","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1647763099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71396,"user_name":"Magic","can_delete":false,"product_type":"c1","uid":1272047,"ip_address":"","ucode":"FD9CEDAA419EB0","user_header":"https://static001.geekbang.org/account/avatar/00/13/68/ef/6264ca3d.jpg","comment_is_top":false,"comment_ctime":1551332502,"is_pvip":false,"replies":[{"id":"25558","content":"1. ä½ çš„ç†è§£æ˜¯å¯¹çš„ ã€‚ æˆ‘ä»¬å•ç‹¬å†™ä¸€ä¸ªupdateè¯­å¥çš„æ—¶å€™ï¼Œå°±é»˜è®¤æäº¤ï¼Œæˆ‘ä»¬çš„ä¸¤é˜¶æ®µï¼Œæ˜¯å‘ç”Ÿåœ¨â€œæäº¤é˜¶æ®µâ€çš„<br>   å¦‚æœæ˜¯æœ‰begin...commit; çš„è¯­å¥åºåˆ—ï¼Œé‚£æäº¤é˜¶æ®µæ˜¯åœ¨æ‰§è¡Œâ€œcommitâ€è¿™ä¸ªè¯­å¥çš„æ—¶å€™å‘ç”Ÿçš„<br><br>2. â€œå¦‚æœè¿™é‡Œæ˜¯ä»¥äº‹åŠ¡çš„ç²’åº¦åŒæ­¥redo logçš„è¯ï¼Œé‚£ä¹ˆå¦‚æœåœ¨commitä¹‹å‰ï¼Œmysql crashï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡å°±è‚¯å®šæ˜¯ä¸¢å¤±äº†çš„å§ï¼Ÿâ€ è¿™ä¸ªçœ‹ä¸‹23ç¯‡","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1551354025,"ip_address":"","comment_id":71396,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10141267094","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®ï¼šä¹‹å‰åœ¨ã€Šä¸€æ¡sqlæ›´æ–°è¯­è¨€çš„æ‰§è¡Œæµç¨‹ã€‹ä¸­æåˆ°çš„ä¸¤é˜¶æ®µæäº¤ä¸¾çš„ä¾‹å­æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè€å¸ˆè¯´åªæœ‰äº‹åŠ¡åœ¨commitçš„æ—¶å€™ï¼Œæ—¥å¿—æ‰ä¼šçœŸæ­£ä»redo log bufferå†™å…¥redo logã€‚è¿™é‡Œåˆ°åº•ä»¥å“ªä¸€ä¸ªä¸ºå‡†ï¼Ÿæˆ–è€…è¯´å‰é¢æåˆ°çš„updateè¯­å¥å…¶å®å°±æ˜¯æŒ‡çš„ä¸€ä¸ªäº‹åŠ¡ã€‚è€Œä¸¤é˜¶æ®µæµç¨‹å°±æ˜¯ç”±äº‹åŠ¡çš„commitè¯­å¥è§¦å‘çš„ï¼Ÿå¦‚æœè¿™é‡Œæ˜¯ä»¥äº‹åŠ¡çš„ç²’åº¦åŒæ­¥redo logçš„è¯ï¼Œé‚£ä¹ˆå¦‚æœåœ¨commitä¹‹å‰ï¼Œmysql crashï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡å°±è‚¯å®šæ˜¯ä¸¢å¤±äº†çš„å§ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441134,"discussion_content":"1. ä½ çš„ç†è§£æ˜¯å¯¹çš„ ã€‚ æˆ‘ä»¬å•ç‹¬å†™ä¸€ä¸ªupdateè¯­å¥çš„æ—¶å€™ï¼Œå°±é»˜è®¤æäº¤ï¼Œæˆ‘ä»¬çš„ä¸¤é˜¶æ®µï¼Œæ˜¯å‘ç”Ÿåœ¨â€œæäº¤é˜¶æ®µâ€çš„\n   å¦‚æœæ˜¯æœ‰begin...commit; çš„è¯­å¥åºåˆ—ï¼Œé‚£æäº¤é˜¶æ®µæ˜¯åœ¨æ‰§è¡Œâ€œcommitâ€è¿™ä¸ªè¯­å¥çš„æ—¶å€™å‘ç”Ÿçš„\n\n2. â€œå¦‚æœè¿™é‡Œæ˜¯ä»¥äº‹åŠ¡çš„ç²’åº¦åŒæ­¥redo logçš„è¯ï¼Œé‚£ä¹ˆå¦‚æœåœ¨commitä¹‹å‰ï¼Œmysql crashï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹åŠ¡å°±è‚¯å®šæ˜¯ä¸¢å¤±äº†çš„å§ï¼Ÿâ€ è¿™ä¸ªçœ‹ä¸‹23ç¯‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551354025,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1314724,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/a4/0b49469f.jpg","nickname":"æœ¨å­00","note":"","ucode":"8F78CA722EB29B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306721,"discussion_content":"ä½ å¯èƒ½æŠŠäº‹åŠ¡çš„commitå’Œä¸¤é˜¶æ®µæäº¤çš„commit ç†è§£é”™è¯¯äº†å§ã€‚\nè¿™é‡Œçš„commit æ˜¯äº‹åŠ¡çš„æäº¤ä¹‹åï¼ŒæŠŠredo log buffer å†™åˆ° redo log é‡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600356031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1314724,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0f/a4/0b49469f.jpg","nickname":"æœ¨å­00","note":"","ucode":"8F78CA722EB29B","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":372343,"discussion_content":"ä¸¤é˜¶æ®µæäº¤æ˜¯åœ¨commitè¯­å¥æ‰§è¡Œçš„æ—¶å€™å‘ç”Ÿçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620291138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":306721,"ip_address":""},"score":372343,"extra":""}]}]},{"had_liked":false,"id":70109,"user_name":"ä¸æƒ‘ing","can_delete":false,"product_type":"c1","uid":1207079,"ip_address":"","ucode":"AF04E417D38027","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/27/8c964e52.jpg","comment_is_top":false,"comment_ctime":1550998749,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"10140933341","product_id":100020801,"comment_content":"é—®ï¼š2.è¿½é—®5ï¼šbinlog1ä¸¢å¤±çš„åŸå› æ˜¯å› ä¸ºæ•°æ®è¿˜åœ¨å†…å­˜æ²¡åˆ·åˆ°ç£ç›˜ï¼Ÿå¦‚æœè®¾ç½®innodb_flush_log_at_trx_commit=1 æ¯æ¬¡commitéƒ½åˆ·åˆ°ç£ç›˜æ˜¯ä¸æ˜¯å°±ä¸ä¼šä¸¢å¤±äº†ï¼Ÿè¿™ä¸ªä¸¤ä¸ªç†è§£æœ‰é—®é¢˜ä¹ˆï¼Ÿ<br><br>Re:2. è¿½é—®5çš„å›ç­”çš„æ„æ€æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä¸¤é˜¶æ®µï¼Œredo logå…ˆæäº¤å®Œæˆå†å†™binlogçš„è¯ï¼Œå°±ä¼šå¯¼è‡´binlogå†™å…¥è¿‡ç¨‹å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ— æ³•å›æ»š<br><br>è€å¸ˆæ‚¨å¥½ï¼Œä¸å¥½æ„æ€æˆ‘æ²¡è¡¨è¾¾æ¸…æ¥šï¼Œéå¸¸æŠ±æ­‰ï¼Œé‡æ–°é—®ä¸€éï¼Œæ‚¨æ–‡ä¸­çš„æ„æ€æ˜¯ã€åªç”¨binlogåšå´©æºƒæ¢å¤ï¼Œåœ¨å›¾äºŒcrashä½ç½®ï¼Œæ— æ³•æŒå´©æºƒæ¢å¤ï¼Œå›¾ä¸­binlog1å·²ç»commitäº†ä¹Ÿä¼šä¸¢å¤±ã€‘ï¼Œ<br>è¿™æ®µæˆ‘æ²¡ç†è§£ï¼Œä¸ºå•¥binlog1å·²ç»commitäº†è¿˜ä¼šä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥å¼•å‘äº†åé¢çš„æ€è€ƒ<br>ã€binlog1ä¸¢å¤±çš„åŸå› æ˜¯å› ä¸ºæ•°æ®è¿˜åœ¨å†…å­˜æ²¡åˆ·åˆ°ç£ç›˜ï¼Ÿå¦‚æœè®¾ç½®innodb_flush_log_at_trx_commit=1 æ¯æ¬¡commitéƒ½åˆ·åˆ°ç£ç›˜æ˜¯ä¸æ˜¯å°±ä¸ä¼šä¸¢å¤±äº†ï¼Ÿã€‘","like_count":2,"discussions":[{"author":{"id":1786788,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJINWmZjibZA4eibL31PzMDia2yt1icOc9QnFWwTKuXbWTFCAZaMgCrqO7Oa5sZka81pHoibPgSM8nCjibA/132","nickname":"è¶…èƒ½åŠ›å…ˆç”Ÿ","note":"","ucode":"C042DB628CAA86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":118593,"discussion_content":"è¿™ä¸ªè®¾ç½®åº”è¯¥æ˜¯è®©binlogä¿å­˜ã€‚é‡å¯åä¸¢å¤±ä¸æ˜¯å› ä¸ºbinlogä¸¢å¤±äº†ï¼Œbinlogéƒ½åœ¨ï¼Œä½†æ˜¯æ•°æ®åº“ä¸çŸ¥é“å“ªäº›æ˜¯å·²ç»è½ç›˜çš„ï¼Œå“ªäº›æ˜¯æ²¡æœ‰è½ç›˜çš„ã€‚åªèƒ½é€‰æ‹©æ²¡æœ‰commitçš„è¿è¡Œï¼Œè¿™æ ·å·²ç»commitå´æœªè½ç›˜çš„å°±ä¸¢å¤±äº†æ‰€ä»¥éœ€è¦ä¸€ä¸ªcheck pointæ¥è®°å½•å“ªäº›è½ç›˜äº†ã€‚åªé€šè¿‡binlogä¹Ÿèƒ½å®Œå…¨æ¢å¤ ä½†æ˜¯å°±éœ€è¦ä»å…¨å¤‡ä»½ç‚¹å¼€å§‹ä¸€ä¸ªä¸€ä¸ªæ¥ï¼Œæ¯”èµ·redologä¼šå¾ˆæ…¢ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1578157328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1232273,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cd/91/3d6c53f8.jpg","nickname":"Nash.Z","note":"","ucode":"76B14722664402","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":27856,"discussion_content":"åŒé—®ï¼Œè¿™é‡Œæ²¡ææ‡‚ï¼Œä¸ºä»€ä¹ˆbinlog1å·²ç»commitäº†ï¼Œæ•°æ®è¿˜ä¼šä¸¢å¤±ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570677291,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022507,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOpANMwDibLmj5IGJh6dTw300sZ1BHM5sG3sZv1A1rvCHOiblPD3jgFOiaMVVujtctWnQbVFoNPpRgw/132","nickname":"alioo","note":"","ucode":"F36A38C1F5FFAB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7698,"discussion_content":"ä½ ç°åœ¨ææ‡‚äº†å—ï¼Ÿè¿™é‡Œæˆ‘ä¹Ÿæ²¡æœ‰ææ‡‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567644950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64451,"user_name":"å®¶æœ‰é‚¹å¤ª","can_delete":false,"product_type":"c1","uid":1320050,"ip_address":"","ucode":"5636BD37EB1A99","user_header":"https://static001.geekbang.org/account/avatar/00/14/24/72/9e2a651c.jpg","comment_is_top":false,"comment_ctime":1548806244,"is_pvip":false,"replies":[{"id":"22817","content":"è¿™ä¸ªå°±æ˜¯å †è¡¨å’Œç´¢å¼•ç»„ç»‡è¡¨çš„åŒºåˆ«å“ˆğŸ˜…","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548808606,"ip_address":"","comment_id":64451,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10138740836","product_id":100020801,"comment_content":"æœ‰ç‚¹ä¸å¤ªæ˜ç™½ï¼Œoracleï¼ŒDB2çš„æ¬¡çº§ç´¢å¼•å¶å­ç»“ç‚¹éƒ½æ˜¯åŒ…å«äº†rowidçš„ï¼Œè®¿é—®è·¯å¾„èµ°æ¬¡çº§ç´¢å¼•ä¹Ÿå¯ä»¥ç›´æ¥æ ¹æ®rowidå»æŸ¥è¡¨ï¼Œä¸ºå•¥mysqläºŒçº§ç´¢å¼•ä¸åŒ…å«rowidï¼Œè¿˜è¦è¿”å›ä¸»é”®ç´¢å¼•å†å»æŸ¥è¡¨ã€‚è€å¸ˆèƒ½å¸®å¿™è§£é‡Šä¸‹å—ï¼Ÿè°¢è°¢ï¼","like_count":2,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438004,"discussion_content":"è¿™ä¸ªå°±æ˜¯å †è¡¨å’Œç´¢å¼•ç»„ç»‡è¡¨çš„åŒºåˆ«å“ˆğŸ˜…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548808606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50760,"user_name":"éƒ­åˆš","can_delete":false,"product_type":"c1","uid":1292032,"ip_address":"","ucode":"22CB8ECE8E3DCA","user_header":"https://static001.geekbang.org/account/avatar/00/13/b7/00/12149f4e.jpg","comment_is_top":false,"comment_ctime":1545040494,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10134975086","product_id":100020801,"comment_content":"ç»“è®ºæ˜¯æ–¹å¼3ï¼š<br>autocommitè®¾ç½®çš„æ˜¯0<br><br>å®éªŒè¿‡ç¨‹ï¼š<br>session1:<br>mysql&gt; update t set a=2 where id=1;<br>Query OK, 0 rows affected (0.00 sec)<br>Rows matched: 1  Changed: 0  Warnings: 0<br>session2:<br>mysql&gt; update t set a=2 where id=1;<br>ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction","like_count":2},{"had_liked":false,"id":50601,"user_name":"miche","can_delete":false,"product_type":"c1","uid":1318659,"ip_address":"","ucode":"9B6B7E14008094","user_header":"","comment_is_top":false,"comment_ctime":1545015114,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10134949706","product_id":100020801,"comment_content":"è€å¸ˆï¼Œç»è¿‡å‰é¢çš„ç²¾å½©å†…å®¹ï¼Œredo logå’Œbinlogå·²ç»ç†è§£çš„å·®ä¸å¤šäº†ï¼Œèƒ½ä¸èƒ½è¯´ä¸€ä¸‹undo logæ˜¯æ€ä¹ˆå·¥ä½œçš„å—ï¼Ÿä¸€ä¸ªupdateè¯­å¥ä»å¼€å§‹åˆ°ç»“æŸï¼Œè¿™undoå’Œredoæ˜¯å…ˆå¼€å§‹å†™å“ªä¸ªæ—¥å¿—çš„ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1811277,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a3/4d/59390ba9.jpg","nickname":"æ’éª¨","note":"","ucode":"A413CF46211E1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570882,"discussion_content":"å…ˆå†™undo log,è¦å…ˆä¿å­˜æ•°æ®ä¿®æ”¹å‰çš„çŠ¶æ€,ç»™mvccä½¿ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651981948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158842,"discussion_content":"å¯ç»“åˆç¬¬8ç« æ¥çœ‹ï¼Œåº”è¯¥æ˜¯å…ˆå‰undoå§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580633060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330134,"user_name":"Geek_94045a","can_delete":false,"product_type":"c1","uid":2760780,"ip_address":"","ucode":"B8F23BA9D1411B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKghO4kJwQ5ccuBA2Yox1WlZmq0JUICpNAsgYlOHX0wHGv48xVRKSvF9a6Eic5l2UOjFjnvTnsibibiaw/132","comment_is_top":false,"comment_ctime":1641809679,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5936776975","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘ä»ä½ çš„æ–‡ç« é‡Œå‘ç°äº†å¥½å¤šç”¨æ¥é¢è¯•åˆ«äººçš„é¢˜ï¼Œè€Œä¸”è¿™äº›é¢˜ ä¸æ˜¯å…‰é èƒŒå…«è‚¡æ–‡è€Œä¸æ˜åŸç†å°±èƒ½å›ç­”çš„å‡ºæ¥çš„ å“ˆå“ˆ","like_count":1},{"had_liked":false,"id":326991,"user_name":"å»ºå¼º","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1639816327,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5934783623","product_id":100020801,"comment_content":"æ€è€ƒé¢˜ï¼š<br>update t set a=2 where id=1;<br>å¦‚æœç”¨ä¸€ä¸ªäº‹åŠ¡æ¥æ§åˆ¶è¿™ä¸ªæ›´æ–°æ“ä½œï¼Œåœ¨äº‹åŠ¡æœªæäº¤ä¹‹å‰ï¼Œå…¶ä»–è¿›ç¨‹å¦‚æœè¦æ›´æ–°id=1è¿™ä¸€è¡Œè®°å½•ï¼Œä»ç„¶æ˜¯è¢«é”ä½çš„ï¼Œå› æ­¤æ¨æ–­ï¼Œæ›´æ–°æ—¶å°½ç®¡æ›´æ–°åçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†mysqlä»ç„¶ä»¥è‡ªèº«çš„æ–¹å¼å¯¹è®°å½•è¿›è¡Œæ›´æ–°ï¼Œè¯¥åŠ é”æ—¶ä»ç„¶åŠ é”ï¼Œæ›´æ–°åçš„é‚£ä¸ªç»Ÿè®¡å€¼ï¼Œæˆ‘çš„ç†è§£æ˜¯æŒ‰æ›´æ–°åæœ‰å¤šå°‘è®°å½•çš„å€¼å‘ç”Ÿå˜åŒ–æ¥ç»Ÿè®¡çš„ï¼Œå¹¶ä¸æ˜¯mysqlå‘ç°å€¼ä¸€æ ·è€Œæ²¡æœ‰å»æ‰§è¡Œæ›´æ–°ã€‚","like_count":1},{"had_liked":false,"id":323364,"user_name":"å…‹é‡Œæ–¯","can_delete":false,"product_type":"c1","uid":1181844,"ip_address":"","ucode":"00B755C10AC1C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/94/2c22bd4e.jpg","comment_is_top":false,"comment_ctime":1637855064,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5932822360","product_id":100020801,"comment_content":"Redo Log Commitæ ‡è¯†æ˜¯ä»€ä¹ˆ?","like_count":1},{"had_liked":false,"id":268176,"user_name":"å‘¨ç¿”åœ¨å±±éº“ï¼ˆXiang Zhouï¼‰","can_delete":false,"product_type":"c1","uid":1609289,"ip_address":"","ucode":"E126273356E5B6","user_header":"https://static001.geekbang.org/account/avatar/00/18/8e/49/10ef002d.jpg","comment_is_top":false,"comment_ctime":1608091252,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5903058548","product_id":100020801,"comment_content":"æˆ‘è§‰å¾—æœ€åä¸€ä¸ªé—®é¢˜è§£å†³çš„å¹¶ä¸å¥½. åœ¨ä¸æ”¹å˜è¡¨ç»“æ„çš„æƒ…å†µä¸‹, å¯ä»¥æ”¹å˜ä¸šåŠ¡é€»è¾‘:<br><br>å½“A å»å…³æ³¨ B çš„æ—¶å€™:<br>1.åœ¨like è¡¨é‡Œæ’å…¥è®°å½•;<br>2.commit äº‹åŠ¡;<br>3.åˆ¤æ–­like è¡¨é‡Œæ˜¯å¦æœ‰Bå¯¹A çš„å…³æ³¨;<br>  a)å¦‚æœæœ‰, åœ¨friend é‡Œé¢æ’å…¥ä¸€æ¡è®°å½•;<br>  b)å¦‚æœæ²¡æœ‰, ç»“æŸ;<br>","like_count":1,"discussions":[{"author":{"id":1170486,"avatar":"https://static001.geekbang.org/account/avatar/00/11/dc/36/e63c115f.jpg","nickname":"edgewalk","note":"","ucode":"A576FAEA5A81BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583793,"discussion_content":"å¦‚æœæ‰§è¡Œç¬¬ä¸‰æ­¥æŠ¥é”™äº†,æ€ä¹ˆå›æ»š??","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660386171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258711,"user_name":"ytyee","can_delete":false,"product_type":"c1","uid":2018869,"ip_address":"","ucode":"05079CE049A8FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/FQQA0icGXUvJZicd7jX1r85MmH2XgpQUlkXNpB2u9OibCc1k3ITJwaqbZm7WQiaT93hWYDRBCJMsThuL62PLTaP5hQ/132","comment_is_top":false,"comment_ctime":1604542066,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5899509362","product_id":100020801,"comment_content":"å¦‚æœåœ¨å›¾ä¸­æ—¶åˆ» A çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å†™å…¥ redo log å¤„äº prepare é˜¶æ®µä¹‹åã€å†™ binlog ä¹‹å‰ï¼Œå‘ç”Ÿäº†å´©æºƒï¼ˆcrashï¼‰ï¼Œç”±äºæ­¤æ—¶ binlog è¿˜æ²¡å†™ï¼Œredo log ä¹Ÿè¿˜æ²¡æäº¤ï¼Œæ‰€ä»¥å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹åŠ¡ä¼šå›æ»šã€‚è¿™æ—¶å€™ï¼Œbinlog è¿˜æ²¡å†™ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šä¼ åˆ°å¤‡åº“ã€‚åˆ°è¿™é‡Œï¼Œå¤§å®¶éƒ½å¯ä»¥ç†è§£ã€‚<br>è¿™é‡Œæˆ‘è¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œå¦‚æœæŒ‰ç»„æäº¤çš„ç†è§£ï¼Œflushé˜¶æ®µç»“æŸï¼Œä¹Ÿå°±æ˜¯fsync redo logå®Œæˆäº†ï¼Œé‚£ä¹ˆwrite binlogä¸ä¹Ÿåº”è¯¥å®Œæˆäº†å—ï¼Œé‚£ä¹ˆå¦‚æœåªæ˜¯æ•°æ®åº“æŒ‚æ‰ï¼Œæ“ä½œç³»ç»Ÿè¿˜æ˜¯æ­£å¸¸ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¸å°±ä¼šå®šæ—¶æŠŠwrite page cacheè¿™éƒ¨åˆ†binlogåˆ·åˆ°ç£ç›˜å—ï¼Œä¸å°±æ²¡æœ‰ä¸¢å—ï¼Ÿ","like_count":1},{"had_liked":false,"id":229412,"user_name":"ä¹–ï¼Œæ‘¸æ‘¸å¤´","can_delete":false,"product_type":"c1","uid":1611745,"ip_address":"","ucode":"BD92741A11D3CD","user_header":"https://static001.geekbang.org/account/avatar/00/18/97/e1/0f4d90ff.jpg","comment_is_top":false,"comment_ctime":1592987833,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5887955129","product_id":100020801,"comment_content":"mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)<br><br>mysql&gt; select * from t where id=1;<br>+----+------+<br>| id | a    |<br>+----+------+<br>|  1 |    2 |<br>+----+------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; select * from t where id=1;<br>+----+------+<br>| id | a    |<br>+----+------+<br>|  1 |    2 |<br>+----+------+<br>1 row in set (0.00 sec)<br><br>mysql&gt; update t set a=3 where id=1;<br>Query OK, 0 rows affected (0.00 sec)<br>Rows matched: 1  Changed: 0  Warnings: 0<br><br>mysql&gt; select * from t where id=1;<br>+----+------+<br>| id | a    |<br>+----+------+<br>|  1 |    2 |<br>+----+------+<br>1 row in set (0.00 sec)<br><br>ä¸ºä»€ä¹ˆ update åè¿˜æ˜¯(1,2),æ­»æ´»æ²¡æƒ³é€š","like_count":1},{"had_liked":false,"id":208182,"user_name":"thomas","can_delete":false,"product_type":"c1","uid":1016777,"ip_address":"","ucode":"9AB945308F1B50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/c9/5d03981a.jpg","comment_is_top":false,"comment_ctime":1587294779,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5882262075","product_id":100020801,"comment_content":"è¿½é—® 1ï¼šMySQL æ€ä¹ˆçŸ¥é“ binlog æ˜¯å®Œæ•´çš„?å›ç­”ï¼šä¸€ä¸ªäº‹åŠ¡çš„ binlog æ˜¯æœ‰å®Œæ•´æ ¼å¼çš„ï¼šstatement æ ¼å¼çš„ binlogï¼Œæœ€åä¼šæœ‰ COMMITï¼›row æ ¼å¼çš„ binlogï¼Œæœ€åä¼šæœ‰ä¸€ä¸ª XID eventã€‚<br>----------------------------------------------------------------------------------<br>åœ¨MYSQL5.7.29ç‰ˆæœ¬è¯•éªŒï¼Œ binlogæ¨¡å¼ä¸ºstatementæˆ–rowæ¨¡å¼ï¼Œéƒ½ä¼šæœ‰XID event + COMMIT","like_count":1},{"had_liked":false,"id":161394,"user_name":"suke","can_delete":false,"product_type":"c1","uid":1007753,"ip_address":"","ucode":"C0287C31A4F45B","user_header":"","comment_is_top":false,"comment_ctime":1576201130,"is_pvip":false,"replies":[{"id":"61532","content":"å°±æ˜¯ä»–ä»¬çš„idå€¼","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1576213464,"ip_address":"","comment_id":161394,"utype":1}],"discussion_count":3,"race_medal":0,"score":"5871168426","product_id":100020801,"comment_content":"a bå¤§å°çš„æ¯”è¾ƒåˆ°åº•æ˜¯åœ¨æ¯”è¾ƒä»€ä¹ˆï¼Ÿæ²¡æœ‰è¯´æ¸…æ¥šå•Š å¾ˆè¿·æƒ‘","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477704,"discussion_content":"å°±æ˜¯ä»–ä»¬çš„idå€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576213464,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1007753,"avatar":"","nickname":"suke","note":"","ucode":"C0287C31A4F45B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":81062,"discussion_content":"å¥½çš„ ï¼Œæ˜ç™½äº†ï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576217066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1614499,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRXPleVJnXU4gib2Hib5xR7jMmAgVPs1GKuJ39ib8HvnVk79Q3k8STLhOcCcO2rjKSuuMLFRekCyL2A/132","nickname":"Geek_slk","note":"","ucode":"413CDBEF0B7679","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1007753,"avatar":"","nickname":"suke","note":"","ucode":"C0287C31A4F45B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381345,"discussion_content":"å“ªä¸ªè¡¨çš„idå€¼å•Š æ²¡æ‡‚å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625018817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":81062,"ip_address":""},"score":381345,"extra":""}]}]},{"had_liked":false,"id":149479,"user_name":"jian","can_delete":false,"product_type":"c1","uid":1185102,"ip_address":"","ucode":"21CDBBB8000F0C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/4e/4636a81d.jpg","comment_is_top":false,"comment_ctime":1573229699,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5868196995","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œå¦‚ä½•ç†è§£â€œå¯¹äº InnoDB å¼•æ“æ¥è¯´ï¼Œå¦‚æœ redo log æäº¤å®Œæˆäº†ï¼Œäº‹åŠ¡å°±ä¸èƒ½å›æ»šï¼ˆå¦‚æœè¿™è¿˜å…è®¸å›æ»šï¼Œå°±å¯èƒ½è¦†ç›–æ‰åˆ«çš„äº‹åŠ¡çš„æ›´æ–°ï¼‰ã€‚â€å…¶ä¸­çš„â€œè¿™è¿˜å…è®¸å›æ»šï¼Œå°±å¯èƒ½è¦†ç›–æ‰åˆ«çš„äº‹åŠ¡çš„æ›´æ–°â€ï¼Œå…·ä½“ ä»€ä¹ˆæ„æ€ï¼Ÿèƒ½å¦ä¸¾ä¸ªä¾‹å­ï¼Ÿ<br>éº»çƒ¦è§£ç­”ä¸€ä¸‹","like_count":1,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158845,"discussion_content":"äº‹åŠ¡éƒ½æäº¤äº†ï¼Œç›¸å½“äºå¯¹äºå¯¹åˆ«çš„äº‹åŠ¡æ˜¯å¯è§çš„ï¼Œå¦‚æœè¿˜å…è®¸å›æ»šï¼Œé‚£å°±ä¼šå°†åˆ«çš„äº‹åŠ¡åŸºäºè¿™ä¸ªäº‹åŠ¡æäº¤çš„æ•°æ®è€Œç®—å‡ºæ¥çš„æ›´æ–°è¿›è¡Œè¦†ç›–ï¼Œé‚£å°±æœ‰ç‚¹æ²¡æœ‰è§„çŸ©å¯è¨€äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1580633416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92481,"user_name":"jacy","can_delete":false,"product_type":"c1","uid":1103456,"ip_address":"","ucode":"0022A8759DDCE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","comment_is_top":false,"comment_ctime":1557280478,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"5852247774","product_id":100020801,"comment_content":"çœ‹å®Œé—®é¢˜åï¼Œæˆ‘å¯¹æ•°æ®è½ç›˜çš„ç†è§£å¦‚ä¸‹ï¼š<br>æ›´æ–°å†…å­˜é¡µå’Œredo logã€binlogæ˜¯åˆ†å¼€ç®¡ç†çš„ã€‚å†™çš„æ—¶å€™å†™å†…å­˜é¡µï¼Œå†™redo logã€binlogï¼Œå†…å­˜é¡µå˜ä¸ºè„é¡µï¼Œå†…å­˜ä¸è¶³æˆ–æ˜¯è´Ÿè½½è¾ƒä½æ—¶ç”±åå°åˆ·ç›˜ã€‚è¯»çš„æ—¶å€™è¯»å†…å­˜æ˜¯æœ€æ–°çš„æ•°æ®ï¼ˆæœ‰å¯èƒ½è¿˜æ˜¯è„é¡µï¼‰ã€‚æœŸé—´å¦‚æœå´©æºƒï¼Œå³ä½¿è„é¡µæ²¡æœ‰åˆ·ç›˜ï¼Œä½†è„é¡µçš„ä¿®æ”¹ä¸€å®šæ˜¯commitåˆ°äº†redo logï¼Œbinlogä¸Šï¼Œæ¢å¤æ—¶ä¼šè¯»å‡ºç£ç›˜æ•°æ®ï¼Œåº”ç”¨ä¿®æ”¹ï¼ˆå˜ä¸ºè„é¡µï¼Œï¼‰ï¼Œç­‰å¾…æŸä¸ªåˆ·ç›˜æ—¶æœºã€‚<br>å› æ­¤ï¼Œæ•°æ®è½ç›˜å’Œè®°å½•redo logã€binlogå¹¶éå¼ºç›¸å…³ï¼Œä½†è½ç›˜å‰ï¼Œä¸€å®šæ˜¯è®°å½•è¿‡redo logã€binlog","like_count":1},{"had_liked":false,"id":64820,"user_name":"åˆ˜åä¸€","can_delete":false,"product_type":"c1","uid":1035899,"ip_address":"","ucode":"5927D77D248E30","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/7b/fa0f9368.jpg","comment_is_top":false,"comment_ctime":1548918080,"is_pvip":false,"replies":[{"id":"22932","content":"æœ‰æ–‡åŒ–å‘€ï¼Œå¤šè°¢é¼“åŠ±ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548922492,"ip_address":"","comment_id":64820,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5843885376","product_id":100020801,"comment_content":"åœ¨å ‚é£Ÿå®¢çš†ä¹ç²¾å½©ï¼Œç²¾å½©ï½","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438194,"discussion_content":"æœ‰æ–‡åŒ–å‘€ï¼Œå¤šè°¢é¼“åŠ±ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548922492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63200,"user_name":"å¿µä½ å¦‚æ˜”","can_delete":false,"product_type":"c1","uid":1323531,"ip_address":"","ucode":"FCAD88AB57D084","user_header":"https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg","comment_is_top":false,"comment_ctime":1548297837,"is_pvip":false,"replies":[{"id":"22425","content":"æœ‰å¯èƒ½ä¼šçš„ï¼Œbinlogå†™å®Œäº†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548325431,"ip_address":"","comment_id":63200,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5843265133","product_id":100020801,"comment_content":"å¦‚æœä¸»åº“åœ¨Bä½ç½®ä¸»åº“æŒ‚æ‰äº†ï¼Œå¾ˆæ˜æ˜¾innodbè¿˜æ²¡æ¥çš„åŠåšcommitæ“ä½œï¼Œè¿™ä¸ªäº‹åŠ¡ä¼šä¸ä¼šåŒæ­¥åˆ°ä»åº“ä¸­å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437500,"discussion_content":"æœ‰å¯èƒ½ä¼šçš„ï¼Œbinlogå†™å®Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548325431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57355,"user_name":"çœ‹ä¸åˆ°deé¢œè‰²","can_delete":false,"product_type":"c1","uid":1162714,"ip_address":"","ucode":"88348CCAE81931","user_header":"https://static001.geekbang.org/account/avatar/00/11/bd/da/3d76ea74.jpg","comment_is_top":false,"comment_ctime":1546761735,"is_pvip":false,"replies":[{"id":"20673","content":"1. Binlogåªèƒ½â€œæ•´è¡Œé‡åšâ€ï¼Œä¸èƒ½å•ç‹¬åšä¸€ä¸ªæ•°æ®é¡µçš„ï¼Œæ²¡æœ‰ä¿¡æ¯<br>2. ä¸ç”¨å…¨éƒ¨å›æ”¾ã€‚ä»checkpoint çš„ä½ç½®å¼€å§‹åˆ°å½“å‰å†™å…¥ä½ç½®å°±å¯ä»¥äº†ã€‚ï¼ˆä¸è¿‡ç†è®ºä¸Šä¼šæ˜¯æ•´ä¸ªredo ç©ºé—´ï¼‰é—®é¢˜ä¸å¤§ï¼Œç°åœ¨ç¡¬ç›˜å¾ˆå¿«çš„ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546772847,"ip_address":"","comment_id":57355,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5841729031","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œå› ä¸ºä¸€äº›ç–‘æƒ‘è·³è¿‡äº†å‡ ç¯‡å…ˆæ¥çœ‹äº†ä¸‹ç­”ç–‘ã€‚å¯¹å¦‚æœåªç”¨binlogè€Œä¸ä½¿ç”¨redo logæ— æ³•è¿›è¡Œå¥”æºƒæ¢å¤è¿˜æ˜¯æœ‰äº›ç–‘æƒ‘ï¼Œæƒ³è¯·è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚<br>1.binlogå†…å®¹çš„èƒ½åŠ›ä¸è¶³ï¼ˆæ²¡æœ‰é¡µé¢ä¿¡æ¯ï¼‰ã€‚å°è±¡é‡Œåœ¨ç¬¬äºŒç¯‡æ–‡ç« é‡Œè¯´åˆ°binlogè®°å½•çš„æ˜¯é€»è¾‘ä¿®æ”¹ï¼Œè€Œredologè®°å½•çš„æ˜¯ç‰©ç†ä¿®æ”¹ã€‚é‚£ä¹ˆæœ€ç»ˆä¸éƒ½æ˜¯è®°å½•çš„ä¸€æ¡æ•°æ®çš„ä¿®æ”¹å—ï¼Ÿä¸ºä»€ä¹ˆbinlogå°±èƒ½åŠ›ä¸è¶³äº†å‘¢ï¼Ÿ<br>2.æˆ‘ç†è§£æ˜¯å¦‚æœä½¿ç”¨binlogè¿›è¡Œæ¢å¤ä¸ç¡®å®šä»å“ªä¸ªæ—¶é—´ç‚¹è¿›è¡Œæ•°æ®æ¢å¤æœ‰å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä½†æ˜¯redologä¹Ÿå¯ä»¥è®¾ç½®çš„å¾ˆå¤§ã€‚é‚£ä¹ˆç”¨redo logæ¢å¤ç›¸å½“äºæŠŠredo logå›æ”¾äº†ä¸€éå—ï¼Ÿ<br>å›°æƒ‘äº†å¥½ä¹…ï¼Œè¿˜æœ›è€å¸ˆå¯ä»¥ç™¾å¿™ä¹‹ä¸­æŠ½ç©ºè§£ç­”ä¸€ä¸‹ï¼Œæ„Ÿæ¿€ä¸å°½ã€‚","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435539,"discussion_content":"1. Binlogåªèƒ½â€œæ•´è¡Œé‡åšâ€ï¼Œä¸èƒ½å•ç‹¬åšä¸€ä¸ªæ•°æ®é¡µçš„ï¼Œæ²¡æœ‰ä¿¡æ¯\n2. ä¸ç”¨å…¨éƒ¨å›æ”¾ã€‚ä»checkpoint çš„ä½ç½®å¼€å§‹åˆ°å½“å‰å†™å…¥ä½ç½®å°±å¯ä»¥äº†ã€‚ï¼ˆä¸è¿‡ç†è®ºä¸Šä¼šæ˜¯æ•´ä¸ªredo ç©ºé—´ï¼‰é—®é¢˜ä¸å¤§ï¼Œç°åœ¨ç¡¬ç›˜å¾ˆå¿«çš„ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546772847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51162,"user_name":"Smile","can_delete":false,"product_type":"c1","uid":1021017,"ip_address":"","ucode":"2002460CB3D869","user_header":"https://static001.geekbang.org/account/avatar/00/0f/94/59/ac2aa72b.jpg","comment_is_top":false,"comment_ctime":1545123230,"is_pvip":true,"replies":[{"id":"18441","content":"æ˜¯çš„æ˜¯çš„ï¼Œ<br>æˆ‘ä»ä¸Šé¢æ‹·ä¸‹æ¥åæ³¨é‡Šå¿˜è®°æ”¹äº†ï¼Œ<br><br>ä½ çœ‹å¾—å¥½ç»†è‡´ğŸ‘ğŸ¿","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545126211,"ip_address":"","comment_id":51162,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840090526","product_id":100020801,"comment_content":"å¦‚æœ A&gt;Bï¼Œåˆ™æ‰§è¡Œä¸‹é¢çš„é€»è¾‘<br><br>&#47;* ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_ship.....<br>å¦‚æœæ˜¯ 1ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit<br>----------<br>è€å¸ˆï¼Œè¿™é‡Œåº”è¯¥ä¸º â€œå¦‚æœæ˜¯2â€ å§<br><br>","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433315,"discussion_content":"æ˜¯çš„æ˜¯çš„ï¼Œ\næˆ‘ä»ä¸Šé¢æ‹·ä¸‹æ¥åæ³¨é‡Šå¿˜è®°æ”¹äº†ï¼Œ\n\nä½ çœ‹å¾—å¥½ç»†è‡´ğŸ‘ğŸ¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545126211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51141,"user_name":"xmasye","can_delete":false,"product_type":"c1","uid":1067119,"ip_address":"","ucode":"7AB897FE157604","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/6f/cdf34b6b.jpg","comment_is_top":false,"comment_ctime":1545120439,"is_pvip":false,"replies":[{"id":"18517","content":"1. Mariadbæ”¯æŒç§’çº§åŠ åˆ—å¯ä»¥äº†è§£ä¸‹<br><br><br>2. é¢ï¼Œè¿™ä¸ªçœŸå¾—å…·ä½“é—®é¢˜æ‰èƒ½åˆ†æ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545158108,"ip_address":"","comment_id":51141,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840087735","product_id":100020801,"comment_content":"è€å¸ˆï¼Œé—®ç‚¹è¯¾å¤–é—®é¢˜ã€‚<br>1.ä¸šåŠ¡ä¸æ–­è¿­ä»£ï¼Œè¡¨ä¸€ç›´åŠ å­—æ®µï¼Œä¸€ä¸ªæ˜¯ç»´æŠ¤é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ä¼šé”è¡¨ã€‚æœ‰ä»€ä¹ˆå¸¸ç”¨çš„åšæ³•å—ï¼Ÿä¾‹å¦‚ç”¨Jsonå­—ç¬¦ä¸²ï¼ˆåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ¶ˆè€—ï¼‰ã€ä¾‹å¦‚ç”¨çºµè¡¨æ¥å­˜key&#47;valueï¼ˆé¢å¤–å¼€å‘æˆæœ¬ï¼‰ã€ä¸»å±æ€§æ”¾ä¸€å¼ è¡¨æ¯”è¾ƒæ‚çš„å±æ€§æ”¾å¦ä¸€å¼ è¡¨ï¼Œä¸»å±æ€§è¡¨å°±ä¸åŠ¨ï¼ˆå‚ç›´æ‹†è¡¨ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç»´æŠ¤é—®é¢˜å’Œé”è¡¨é—®é¢˜ï¼‰<br>2.ä¸€å¼ è¡¨çš„æ•°æ®é‡å¤šå¤§ä¼šæ˜æ˜¾å½±å“æ€§èƒ½ï¼Ÿæ˜æ˜¾å½±å“åæœ‰ä»€ä¹ˆæ–¹æ¡ˆï¼Ÿåˆ†åº“åˆ†è¡¨ï¼ˆæ®è¯´å¾ˆç—›è‹¦ï¼‰ã€ä¼˜åŒ–sqlç´¢å¼•ã€æ•°æ®å½’æ¡£ç­‰ç­‰ã€‚<br>è°¢è°¢ï¼","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433306,"discussion_content":"1. Mariadbæ”¯æŒç§’çº§åŠ åˆ—å¯ä»¥äº†è§£ä¸‹\n\n\n2. é¢ï¼Œè¿™ä¸ªçœŸå¾—å…·ä½“é—®é¢˜æ‰èƒ½åˆ†æ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545158108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51075,"user_name":"æ˜äº®","can_delete":false,"product_type":"c1","uid":1303015,"ip_address":"","ucode":"DAFB3424C4C2D7","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/e7/d1b2e914.jpg","comment_is_top":false,"comment_ctime":1545108912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5840076208","product_id":100020801,"comment_content":"æ¥ä¸Šä¸€ä¸ªæé—®ï¼Œå¦‚æœç»™redoæ€»ä½“å¤§å°è®¾ç½®4Gï¼Œè¿™æ—¶åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å†™10Gæ•°æ®æ˜¯å¦å¯æˆåŠŸè¡Œå‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":50896,"user_name":"æ˜äº®","can_delete":false,"product_type":"c1","uid":1303015,"ip_address":"","ucode":"DAFB3424C4C2D7","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/e7/d1b2e914.jpg","comment_is_top":false,"comment_ctime":1545062144,"is_pvip":false,"replies":[{"id":"18349","content":"ä¸ä¼šå‘€ï¼Œä¸­é—´å´©æºƒçš„ï¼Œbinlogè¿˜åœ¨binlog cacheé‡Œï¼Œæ²¡å‘ç»™ä»åº“å‘¢","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545101145,"ip_address":"","comment_id":50896,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840029440","product_id":100020801,"comment_content":"æˆ‘åœ¨è¿ç»´è¿‡ç¨‹ä¸­ æ€è€ƒè¿‡ä¸€ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªäº‹åŠ¡ç‰¹åˆ«å¤§ï¼Œä¸€æ¬¡å†™äº†1Gçš„æ•°æ®é‡ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœä¸»åº“å´©æºƒï¼Œè€Œredo logå¿…ç„¶æ²¡æœ‰åˆ·ç›˜ï¼Œä¸»åº“æ¢å¤åï¼Œæ˜¯ä¸æ˜¯ä¼šå¯¼è‡´ä¸»ä»ä¸ä¸€è‡´è€Œæ— æ³•åŒæ­¥å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433164,"discussion_content":"ä¸ä¼šå‘€ï¼Œä¸­é—´å´©æºƒçš„ï¼Œbinlogè¿˜åœ¨binlog cacheé‡Œï¼Œæ²¡å‘ç»™ä»åº“å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545101145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50881,"user_name":"Laputa","can_delete":false,"product_type":"c1","uid":1079345,"ip_address":"","ucode":"64C157042CF138","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/31/c7f8d1db.jpg","comment_is_top":false,"comment_ctime":1545060167,"is_pvip":false,"replies":[{"id":"18522","content":"è¿™çœŸæ˜¯ä¸ªå¥½é—®é¢˜ï¼Œç¬¬21ç¯‡ä¼šè®²åˆ°","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545158559,"ip_address":"","comment_id":50881,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840027463","product_id":100020801,"comment_content":"è€å¸ˆï¼Œé—´éš™é”æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ<br>å®é™…ä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š<br>å‡å¦‚æˆ‘æœ‰ä¸€å¼ è¡¨ table1ï¼Œidåˆ—ä¸ºä¸»é”®<br>äº‹åŠ¡1ï¼š<br>begin;<br>select * from table1 where id = 1 for update;<br>æ­¤æ—¶å¼€å§‹äº‹åŠ¡2ï¼š<br>begin;<br>select * from table1 where id = 1 for update;<br>äº‹åŠ¡1ç»§ç»­æ‰§è¡Œï¼š<br>#è‹¥idä¸º1çš„è®°å½•ä¸å­˜åœ¨åˆ™æ‰§è¡Œï¼š<br>insert into table1 values(1);<br>æ­¤æ—¶äº‹åŠ¡1ä¼šé˜»å¡,åº”è¯¥æ˜¯åœ¨è·å–é”ï¼›<br>ç„¶åäº‹åŠ¡2ä¹Ÿä¼šæ‰§è¡ŒåŒæ ·çš„é€»è¾‘ï¼Œå› ä¸ºidä¸º1çš„è®°å½•ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šæ‰§è¡Œæ’å…¥æ“ä½œï¼š<br>insert into table1 values(1);<br>æ­¤æ—¶äº‹åŠ¡2ä¼šæŠ¥æ­»é”ï¼Œäº‹åŠ¡1ä¼šæ‰§è¡ŒæˆåŠŸï¼š<br>Deadlock found when trying to get lock; try restarting transactionï¼›<br><br>ä¸šåŠ¡ä¸Šçš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š<br>æ ¹æ®IDæŸ¥æ‰¾å¯¹åº”çš„è®°å½•ï¼Œå¦‚æœä¸å­˜åœ¨å°±æ’å…¥å¯¹åº”çš„è®°å½•ï¼Œè‹¥å­˜åœ¨å°±æ›´æ–°å¯¹åº”çš„è®°å½•ï¼Œå½“æœ‰ä¸¤ä¸ªè¯·æ±‚åŒæ—¶æ‰§è¡Œæ­¤é€»è¾‘ä¸”å¯¹åº”IDä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™ï¼Œè€å¸ˆèƒ½ä¸è§£é‡Šä¸‹é—´éš™é”å’Œå¦‚ä½•é¿å…æ­¤ç§æƒ…å†µçš„æ­»é”ï¼Œè°¢è°¢","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433156,"discussion_content":"è¿™çœŸæ˜¯ä¸ªå¥½é—®é¢˜ï¼Œç¬¬21ç¯‡ä¼šè®²åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545158559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50818,"user_name":"å¤å¨œæ‹‰é»‘æš—ä¹‹ç¥Â·å·´å•¦å•¦èƒ½é‡Â·å •è½è¾¾","can_delete":false,"product_type":"c1","uid":1185642,"ip_address":"","ucode":"080BBCEF7DE985","user_header":"https://static001.geekbang.org/account/avatar/00/12/17/6a/c979163e.jpg","comment_is_top":false,"comment_ctime":1545050438,"is_pvip":false,"replies":[{"id":"18271","content":"1. å°±æ˜¯åˆ·è„é¡µï¼Œç„¶åæ”¹ä½ç½®ï¼Œä¸æ˜¯å¾ˆç®€å•ï¼Œè¿™ä¸ªè¿‡ç¨‹æŒºåƒèµ„æºçš„<br><br>2. ä¼šçš„ï¼Œæˆ‘ä»¬ä¹‹å‰æ–‡ç« ç®—R% é‚£ä¸ªå›¾ï¼Œå°±æ˜¯ç®—å®Œä»¥åï¼Œä½œä¸ºå¹³æ—¶æ¨â€œæ¨å¤šå¿«â€çš„ä¾æ®å“¦<br><br>å¹³æ—¶æ¨ä¹Ÿæ˜¯åˆ·è„é¡µã€‚<br><br>è€Œä¸”å®é™…ä¸Šï¼Œä¸€ä¸ªç³»ç»Ÿå¥åº·çš„çŠ¶æ€å°±æ˜¯çƒ¤å¹³æ—¶æ¨ï¼Œæ¥é¿å…redo logæ»¡äº†çš„æƒ…å†µ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055364,"ip_address":"","comment_id":50818,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840017734","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå¯¹äºredo logè¿˜æ˜¯æœ‰ä¸¤ä¸ªç–‘é—®ï¼Œæœ›èƒ½è§£ç­”ä¸€ä¸‹<br>1. å¦‚æœ redo log æ»¡äº†ï¼Œé‚£ä¹ˆæ•°æ®åº“ä¼šåœæ­¢æ‰€æœ‰æ›´æ–°æ“ä½œï¼ŒæŠŠ checkpoint å¾€å‰æ¨è¿›ï¼Œä¸ºredo log ç•™å‡ºç©ºé—´å¯ä»¥ç»§ç»­å†™ã€‚é‚£ä¹ˆè¦æŠŠcheckpointå¾€å‰æ¨è¿›å¤§æ¦‚éœ€è¦åšå“ªäº›æ“ä½œå‘¢ï¼Ÿéš¾é“å°±æ˜¯ç®€å•çš„åˆ·è„é¡µå—ï¼Ÿ<br>2. åœ¨å¹³å¸¸çš„æ—¶å€™ï¼Œcheckpointä¼šä¸ä¼šè‡ªåŠ¨å‘å‰æ¨è¿›å‘¢ï¼Ÿå¦‚æœå¹³å¸¸çš„æ—¶å€™ä¹Ÿå‘å‰æ¨è¿›ï¼Œé‚£ä¹ˆå®ƒå’Œå¹³æ—¶åˆ·è„é¡µæœ‰æ²¡æœ‰å…³ç³»ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433122,"discussion_content":"1. å°±æ˜¯åˆ·è„é¡µï¼Œç„¶åæ”¹ä½ç½®ï¼Œä¸æ˜¯å¾ˆç®€å•ï¼Œè¿™ä¸ªè¿‡ç¨‹æŒºåƒèµ„æºçš„\n\n2. ä¼šçš„ï¼Œæˆ‘ä»¬ä¹‹å‰æ–‡ç« ç®—R% é‚£ä¸ªå›¾ï¼Œå°±æ˜¯ç®—å®Œä»¥åï¼Œä½œä¸ºå¹³æ—¶æ¨â€œæ¨å¤šå¿«â€çš„ä¾æ®å“¦\n\nå¹³æ—¶æ¨ä¹Ÿæ˜¯åˆ·è„é¡µã€‚\n\nè€Œä¸”å®é™…ä¸Šï¼Œä¸€ä¸ªç³»ç»Ÿå¥åº·çš„çŠ¶æ€å°±æ˜¯çƒ¤å¹³æ—¶æ¨ï¼Œæ¥é¿å…redo logæ»¡äº†çš„æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50720,"user_name":"å¯¹æ–¹æ­£åœ¨è¾“å…¥ä¸­â€¦","can_delete":false,"product_type":"c1","uid":1210596,"ip_address":"","ucode":"D40224951C57E1","user_header":"https://static001.geekbang.org/account/avatar/00/12/78/e4/7978869e.jpg","comment_is_top":false,"comment_ctime":1545034556,"is_pvip":false,"replies":[{"id":"18205","content":"1. å¤§æ¦‚ç‡éƒ½åœ¨å†…å­˜é‡Œï¼ˆå†…å­˜ä¸å¤Ÿä¼šæ”¾ç£ç›˜ï¼‰<br><br>2. ä¹‹å","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545041616,"ip_address":"","comment_id":50720,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5840001852","product_id":100020801,"comment_content":"æ€»ç»“ä¸€ä¸‹ï¼š<br>redoé˜¶æ®µæœ‰ä¸¤ç§ï¼šredo prepareé˜¶æ®µå’Œredo commitã€‚<br>å†™binlogæœ‰ä¸¤ç§æƒ…å†µï¼šæœªå®Œæ•´å†™å®Œï¼Œå®Œæ•´å†™å®Œã€‚<br>æ€»ä½“æ¥è¯´mysqlç¡®è®¤äº‹åŠ¡éœ€è¦æ‰§è¡Œåªè®¤ä¸¤ç§æƒ…å†µï¼š<br>æƒ…å†µ1ï¼šredo commitå®Œæˆã€‚<br>æƒ…å†µ2ï¼šå®Œæ•´çš„redo prepare+å®Œæ•´çš„binlog(è¿™é‡ŒæŒ‡å†™å®Œ)ã€‚<br>crash recoveryï¼š<br>redo prepareä¸å®Œæ•´ï¼šäº‹åŠ¡ç›´æ¥å›æ»šã€‚<br>redo prepareå®Œæ•´ï¼Œæœªå®Œæˆredo commitï¼šæ‰¾binlogæ˜¯å¦å®Œæ•´ï¼Œå¦‚æœbinlogå®Œæ•´ï¼Œç”±äºä¸»ä»å¤åˆ¶ä¾é binlogä¼ è¾“å’Œåº”ç”¨ï¼Œæ‰€ä»¥ä»åº“å·²æ¥å—å¹¶åº”ç”¨binlogï¼Œä¸»åº“ä¹Ÿåº”æ‰§è¡Œè¯¥äº‹åŠ¡ã€‚binlogä¸å®Œæ•´ç›´æ¥å›æ»šã€‚<br>redo prepareå®Œæ•´ï¼Œredo commitå®Œæˆï¼šä¸ç®¡binlogæ˜¯å¦å®Œæ•´ï¼Œäº‹åŠ¡æäº¤ã€‚<br>æ³¨ï¼šredo prepareå®Œæ•´å’Œbinlogå®Œæ•´çš„æƒ…å†µåº”è¯¥æ˜¯è€å¸ˆè¯´çš„â€œä¸¤é˜¶æ®µæäº¤å°±æ˜¯ä¸ºäº†ç»™æ‰€æœ‰äººä¸€ä¸ªæœºä¼šï¼Œå½“æ¯ä¸ªäººéƒ½è¯´â€œæˆ‘ okâ€çš„æ—¶å€™ï¼Œå†ä¸€èµ·æäº¤â€œï¼Œåªä¸è¿‡åœ¨ä¸¤ä¸ªäººè¯´okå‰å°±æŒ‚äº†ã€‚<br>ç–‘é—®ï¼š<br>1ã€å¦‚æœauto_commit=0æ—¶ï¼Œåœ¨äº‹åŠ¡æœªcommitä¹‹å‰ï¼Œredo logå’Œbinlogçš„å†™å…¥çŠ¶æ€æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ<br>2ã€binlogæ˜¯åœ¨redo prepareå¼€å§‹æ—¶å†™å…¥è¿˜æ˜¯redo prepareå®Œæˆåå†™å…¥çš„ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433073,"discussion_content":"1. å¤§æ¦‚ç‡éƒ½åœ¨å†…å­˜é‡Œï¼ˆå†…å­˜ä¸å¤Ÿä¼šæ”¾ç£ç›˜ï¼‰\n\n2. ä¹‹å","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545041616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50656,"user_name":"ä¸œé’","can_delete":false,"product_type":"c1","uid":1001046,"ip_address":"","ucode":"D7FF3299721F19","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/56/5e83f44b.jpg","comment_is_top":false,"comment_ctime":1545024533,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5839991829","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹<br>1. redo logè·Ÿbinlogéƒ½æ˜¯åœ¨commité˜¶æ®µè¿›è¡Œsyncç£ç›˜æ“ä½œçš„å—ï¼ˆåŒ1ï¼‰<br>2. masterçº¿ç¨‹æ¯ç§’ä¹Ÿä¼šåˆ·ç›˜redo logè·Ÿcommité˜¶æ®µåˆ·ç›˜æ˜¯ä¸å†²çªçš„å§ã€‚<br>3. sync_binlogä¸º1æ—¶å‘é€binlogæ˜¯åœ¨syncåˆ°ç£ç›˜ä¹‹åå—ï¼Ÿåä¹‹æ˜¯åœ¨flushä¹‹åã€‚è¢«å‘é€çš„binlogæ˜¯ä»binlogæ–‡ä»¶è¯»å–å‡ºæ¥çš„ã€‚<br>æ„Ÿè°¢å›ç­”","like_count":1},{"had_liked":false,"id":50591,"user_name":"AstonPutting","can_delete":false,"product_type":"c1","uid":1303239,"ip_address":"","ucode":"1DB579A7922964","user_header":"https://static001.geekbang.org/account/avatar/00/13/e2/c7/d6a0927a.jpg","comment_is_top":false,"comment_ctime":1545013393,"is_pvip":false,"replies":[{"id":"18168","content":"å¬è¿‡è¿™ä¸ªè¯´æ³•ï¼Œä½†æ˜¯æ„Ÿè§‰æ€ªæ€ªçš„ï¼Œ<br><br>å—¯å—¯ï¼Œä¸è¿‡æœ‰ç”¨åˆ°è¿™ä¸ªè¯çš„åœ°æ–¹ç¡®å®æ˜¯2(a)çš„æ„æ€","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545015501,"ip_address":"","comment_id":50591,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5839980689","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·é—®å‰æ»šçš„æ„æ€æ˜¯ä¸æ˜¯æŒ‡çš„åœ¨ 2(a) çš„æƒ…å†µä¸‹ï¼Œæœªæäº¤çš„äº‹åŠ¡è¢«æäº¤çš„è¿‡ç¨‹ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433033,"discussion_content":"å¬è¿‡è¿™ä¸ªè¯´æ³•ï¼Œä½†æ˜¯æ„Ÿè§‰æ€ªæ€ªçš„ï¼Œ\n\nå—¯å—¯ï¼Œä¸è¿‡æœ‰ç”¨åˆ°è¿™ä¸ªè¯çš„åœ°æ–¹ç¡®å®æ˜¯2(a)çš„æ„æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545015501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50513,"user_name":"è‡§å¤©éœ¸","can_delete":false,"product_type":"c1","uid":1302804,"ip_address":"","ucode":"F53FB15E7BD17A","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/14/006e8b9b.jpg","comment_is_top":false,"comment_ctime":1545005321,"is_pvip":false,"replies":[{"id":"18310","content":"1ä¼šçš„,inplace æ‰§è¡Œå®Œæˆåä¼šè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡é‡å»ºç´¢å¼•ç»Ÿè®¡","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545075382,"ip_address":"","comment_id":50513,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5839972617","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æŠŠå‰é¢çš„é—®é¢˜æŒªè¿‡æ¥ï¼Œçƒ¦è¯·è§£æƒ‘ï¼š<br>1.alter table t engine = innodb;åè¡¨åŠç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯ä¹Ÿä¼šè·Ÿç€è‡ªåŠ¨é‡å»ºå—ï¼Ÿè”æƒ³åˆ°åœ¨oracleä¸­è¿ç§»å®Œæ•°æ®ï¼Œæ²¡æœ‰åŠæ—¶åšç»Ÿè®¡ä¿¡æ¯æ”¶é›†æ‰€å¼•å‘çš„äº‹æ•…äº†â€¦â€¦<br>2.å¦‚æœè¡¨åŠç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯æ²¡æœ‰è·Ÿç€è‡ªåŠ¨é‡å»ºï¼Œé‚£æ­¤æ—¶ä¼šä½¿ç”¨è¡¨åŠç´¢å¼•æ—§çš„ç»Ÿè®¡ä¿¡æ¯?æˆ–è€…æ˜¯è¾¾åˆ°ç»Ÿè®¡ä¿¡æ¯é‡æ–°æ”¶é›†é˜ˆå€¼åå†æ”¶é›†ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433005,"discussion_content":"1ä¼šçš„,inplace æ‰§è¡Œå®Œæˆåä¼šè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡é‡å»ºç´¢å¼•ç»Ÿè®¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545075382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158853,"discussion_content":"æ™®é€šç´¢å¼•æ²¡æœ‰é‡å»ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580634131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50487,"user_name":"å³°","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1544981732,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5839949028","product_id":100020801,"comment_content":"è¿½é—®5ä¸­ï¼Œè€å¸ˆè¯´åˆ°binlogæ²¡æœ‰èƒ½åŠ›æ¢å¤æ•°æ®é¡µï¼Œä½†è¿™å’Œå®ƒèƒ½ä¸èƒ½æ¢å¤æ•°æ®åº“æ˜¯ä¸¤å›äº‹å‘€ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯æ›´æ–°åœ¨å­˜å‚¨å±‚æ¬¡ä¸Šçš„å‡ ç§å±•ç°å—ï¼Ÿä¸€ä¸ªæ˜¯è®°å½•é¡¶å±‚æ•°æ®é¡µçš„å˜åŒ–ï¼Œä¸€ä¸ªæ˜¯è¡Œå˜åŒ–ã€‚<br><br>ä¸šåŠ¡è®¾è®¡é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®æŠ½è±¡ç‚¹å°±æ˜¯å†™å€¾æ–œé—®é¢˜ï¼Œç±»ä¼¼çš„é—®é¢˜åŸºæœ¬éƒ½ç¬¦åˆå…ˆselectè¯»ä¸ªä»€ä¹ˆä¸œä¸œå‡ºæ¥ï¼Œä½œä¸ºæ¡ä»¶ï¼Œç„¶åå†å†³å®šæ˜¯å¦å†™å…¥ã€‚è€å¸ˆçš„è§£å†³æ–¹æ³•æ ¸å¿ƒæ˜¯å®ä½“åŒ–å†²çªï¼ŒæŠŠåŸå…ˆä¸èƒ½åŠ é”çš„æ— è®°å½•ï¼Œäººä¸ºå¼•å…¥å¯åŠ é”çš„å¯¹è±¡ã€‚å½“ç„¶è¿˜æœ‰ç§è§£å†³æ–¹å¼å°±æ˜¯ç´¢å¼•åŒºé—´é”çš„æ–¹å¼ï¼Œå½“ç„¶è¿™æ˜¯ä¸²è¡ŒåŒ–çº§åˆ«ä¸‹çš„ä¸œä¸œäº†ã€‚è¿™ä¸ªé—®é¢˜è®©æˆ‘å¥½å¥½å›é¡¾äº†ä¸€ééš”ç¦»ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ”¶è·çš„ï¼Œä¹Ÿå¸Œæœ›è€å¸ˆèƒ½å¤ŸæŠŠ47ä¸ªé—®é¢˜ç§å‰©ä¸‹çš„ä¹Ÿå‘å‡ºæ¥ï¼Œä¸éœ€è¦å®Œæ•´çš„è§£ç­”ï¼Œç‚¹ç‚¹å°±å¥½ã€‚<br><br>ä»Šæ—¥é—®é¢˜ï¼šåœ¨ä¸¤ä¸ªäº‹åŠ¡ä¸­ï¼Œä¸€ä¸ªæ‰§è¡Œæ›´æ–°åï¼ˆæ²¡æäº¤ï¼‰ï¼Œå‘ç°å¦ä¸€ä¸ªäº‹åŠ¡å°±æ²¡åŠæ³•å¯¹ç›¸åŒè¡Œè¿›è¡Œæ›´æ–°äº†ã€‚æ‰€ä»¥å¤„ç†æ–¹å¼ä¸º3ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå¦‚æœè¯´æ›´æ–°æœ¨æ”¹å˜å°±ä¸åŠ é”ï¼Œï¼ˆ1ï¼‰è°ƒç”¨æ–¹å°±å¯èƒ½éœ€è¦ç¡®å®šè¿™ä¸ªæ›´æ–°æœ‰æœ¨æœ‰åŠ ä¸Šé”ï¼Œæ‰è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚ï¼ˆ2ï¼‰å¯¹ä»£ç å¼•å…¥ä¸å¿…è¦çš„å¤æ‚åº¦ã€‚ï¼ˆ3ï¼‰æƒ³çš„å¤´å¤§äº†ï¼Œæƒ³ä¸å‡ºæ¥äº†ã€‚ã€‚ã€‚ã€‚ğŸ˜”","like_count":1},{"had_liked":false,"id":360171,"user_name":"tailender","can_delete":false,"product_type":"c1","uid":1133837,"ip_address":"æ—¥æœ¬","ucode":"BCF8C43F9039E9","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/0d/f8b8c22e.jpg","comment_is_top":false,"comment_ctime":1666252259,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666252259","product_id":100020801,"comment_content":"åŠåŒæ­¥ å¦‚æœä¸€ä¸ªäº‹åŠ¡ä»åº“æ²¡æœ‰ack, ä¸»åº“crashå å…ˆåˆ æ‰binlog ç„¶åé‡å¯åº“å‘ç°è¿™ä¸ªäº‹åŠ¡æäº¤äº†<br>è¯·é—®è€å¸ˆ è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆ","like_count":0},{"had_liked":false,"id":359636,"user_name":"Geek_70a558","can_delete":false,"product_type":"c1","uid":3197432,"ip_address":"æ±Ÿè‹","ucode":"D256BF6FC26BFD","user_header":"","comment_is_top":false,"comment_ctime":1665719938,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1665719938","product_id":100020801,"comment_content":"è¿½é—®5å’Œ6, æˆ‘ç†è§£åº”è¯¥è¿˜æœ‰ä¸€äº›åŸå›  :<br>5. ä¸ºä»€ä¹ˆä¸èƒ½ä¸€æ¬¡redolog+ä¸€æ¬¡binlog ..  æ˜¯å› ä¸ºå¦‚æœå•æ¬¡çš„è¯, æ¯æ¬¡æ¢å¤è¦æŠŠredologåˆ·ç›˜, éƒ½éœ€è¦å¯¹æ¯”æ‰€æœ‰redologå’Œå¯¹åº”çš„binlog,  ä½†æ˜¯å¦‚æœæ˜¯ä¸¤æ®µcommitçš„è¯,  åªè¦æ£€æµ‹åˆ°commitä¸éœ€è¦å†å»binlogå†æ£€ç´¢ä¸€æ¬¡;<br>6. ä¸ºä»€ä¹ˆä¸èƒ½åªç”¨binlog...  å› ä¸ºredologæ˜¯å¯å¤ç”¨çš„ä¸€å—ç©ºé—´, å¹¶ä¸”æœ‰writePoså’ŒcheckPointè¿™æ ·çš„æ ‡è®°å¯ä»¥ç¡®å®šæ‰§è¡Œçš„èŒƒå›´, æ¢å¤çš„æ—¶å€™æŒ‰ç…§èŒƒå›´æ¢å¤å³å¯;  ä½†æ˜¯binlogæ˜¯è¿½åŠ å†™å…¥, æ²¡æœ‰åŠæ³•çŸ¥é“ä»å“ªé‡Œå¼€å§‹æ¢å¤, ä¾‹å¦‚æ–‡ä¸­è¯´çš„ä»ä¸Šä¸€ä¸ªcommitå¼€å§‹æ¢å¤ ,  ä½†æ˜¯ä¸Šä¸€ä¸ªcommitå¾ˆæœ‰å¯èƒ½ä¹Ÿæ²¡æœ‰æŒä¹…åŒ–åˆ°dataæ–‡ä»¶ä¸­;  ","like_count":0},{"had_liked":false,"id":350945,"user_name":"NeverSeeYouAgainBUG","can_delete":false,"product_type":"c1","uid":2930836,"ip_address":"","ucode":"1B0E8CA284C181","user_header":"https://static001.geekbang.org/account/avatar/00/2c/b8/94/d20583ef.jpg","comment_is_top":false,"comment_ctime":1657374027,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657374027","product_id":100020801,"comment_content":"é‚£ä¸ªä¸šåŠ¡ä¸Šå…³æ³¨ä¸å¥½å‹çš„é—®é¢˜ï¼Œæ‰§è¡Œå½“å‰è¯»å¯ä»¥è§£å†³å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":350602,"user_name":"Unknown element","can_delete":false,"product_type":"c1","uid":2028277,"ip_address":"","ucode":"34A129800D0238","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg","comment_is_top":false,"comment_ctime":1657033159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657033159","product_id":100020801,"comment_content":"é—®ä¸ªé—®é¢˜ï¼Œåœ¨æ–‡ç« å¼€å¤´çš„â€œæ—¥å¿—ç›¸å…³é—®é¢˜â€ä¸­æ‚¨è¯´ï¼šâ€œå›¾1ä¸­ç”¨åˆ°çš„è¿™ä¸ªâ€œcommit æ­¥éª¤â€ï¼ŒæŒ‡çš„æ˜¯äº‹åŠ¡æäº¤è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªå°æ­¥éª¤ï¼Œä¹Ÿæ˜¯æœ€åä¸€æ­¥ã€‚å½“è¿™ä¸ªæ­¥éª¤æ‰§è¡Œå®Œæˆåï¼Œè¿™ä¸ªäº‹åŠ¡å°±æäº¤å®Œæˆäº†â€ï¼›åœ¨è¿½é—®9ä¸­æ‚¨åˆè¯´â€œçœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„â€ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¯´commitè¯­å¥çš„æ‰§è¡Œå…¶å®åŒ…å«ä¸€ç³»åˆ—æ­¥éª¤ï¼Œè€Œæ•´ä¸ªä¸¤é˜¶æ®µæäº¤ï¼ˆredo log prepareçš„è½ç›˜ã€binlogçš„è½ç›˜ã€bin log commitçš„è½ç›˜ï¼‰éƒ½åŒ…å«åœ¨è¿™ä¸€ç³»åˆ—æ­¥éª¤ä¸­ï¼Ÿ<br>å¦å¤–å°±æ˜¯ç”¨æˆ·æ‰§è¡Œä¸€ä¸ªå¢åˆ æ”¹äº‹åŠ¡ï¼Œå®ƒçš„æ‰§è¡Œç»“æœä»€ä¹ˆæ—¶å€™è¿”å›å‘¢ï¼Ÿåªè¦è¿™ä¸ªäº‹åŠ¡å¯¹æ•°æ®åº“çš„æ“ä½œè¢«è®°å½•ä¸‹æ¥ï¼ˆå“ªæ€•åªæ˜¯æš‚æ—¶è®°å½•åœ¨å†…å­˜é‡Œï¼‰äº†å°±ç«‹å³è¿”å›äº‹åŠ¡æ‰§è¡ŒæˆåŠŸå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":348219,"user_name":"å°åˆ˜","can_delete":false,"product_type":"c1","uid":1625914,"ip_address":"","ucode":"8017FB710CCB09","user_header":"https://static001.geekbang.org/account/avatar/00/18/cf/3a/ba5b4375.jpg","comment_is_top":false,"comment_ctime":1654849862,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654849862","product_id":100020801,"comment_content":"æˆ‘ä»¬çŸ¥é“ï¼Œæ›´æ–°è¿‡ç¨‹ä¸­ï¼Œcommitæäº¤ä¹‹å‰ï¼Œæ—¥å¿—è¢«è®°å½•åœ¨redo log bufferä¸­ï¼Œå¦‚æœcommitä¹‹å‰ï¼Œå‘ç”Ÿcrash, éšåè¿›è¡Œå´©æºƒæ¢å¤ï¼Œ binlogå¦‚æœæ²¡æœ‰crash-safeçš„èƒ½åŠ›è¯ï¼Œåœ¨å´©æºƒæ¢å¤æ—¶ï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿä½¿ç”¨preparedé˜¶æ®µçš„redo log + å®Œæ•´binlogè¿›è¡Œå´©æºƒæ¢å¤ã€‚","like_count":0},{"had_liked":false,"id":348218,"user_name":"å°åˆ˜","can_delete":false,"product_type":"c1","uid":1625914,"ip_address":"","ucode":"8017FB710CCB09","user_header":"https://static001.geekbang.org/account/avatar/00/18/cf/3a/ba5b4375.jpg","comment_is_top":false,"comment_ctime":1654849838,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654849838","product_id":100020801,"comment_content":"æ±‚è§£ç­”ï¼Œæˆ‘å·²æ™•åœ¨å•æ‰€<br>æˆ‘ä»¬çŸ¥é“ï¼Œæ›´æ–°è¿‡ç¨‹ä¸­ï¼Œcommitæäº¤ä¹‹å‰ï¼Œæ—¥å¿—è¢«è®°å½•åœ¨redo log bufferä¸­ã€‚<br>å¦‚æœcommitä¹‹å‰ä¸”binlogå·²ç»å†™å…¥ï¼Œå‘ç”Ÿcrash, éšåè¿›è¡Œå´©æºƒæ¢å¤ï¼Œå› ä¸ºbinlogæ˜¯å®Œæ•´çš„ï¼Œæ‰€ä»¥è¯¥äº‹åŠ¡éœ€è¦è¿›è¡Œå´©æºƒæ¢å¤ã€‚<br>ä½†æ˜¯ï¼Œbinlogå¦‚æœæ²¡æœ‰crash-safeçš„èƒ½åŠ›è¯ï¼Œåœ¨å´©æºƒæ¢å¤æ—¶ï¼Œä¸ºä»€ä¹ˆèƒ½å¤Ÿä½¿ç”¨preparedé˜¶æ®µçš„redo log + å®Œæ•´binlogè¿›è¡Œå´©æºƒæ¢å¤ã€‚","like_count":0},{"had_liked":false,"id":347646,"user_name":"å‡è£…å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":2811767,"ip_address":"","ucode":"CBF1D121ECFF43","user_header":"https://static001.geekbang.org/account/avatar/00/2a/e7/77/c8c2008f.jpg","comment_is_top":false,"comment_ctime":1654246848,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1654246848","product_id":100020801,"comment_content":"æœ‰ä¸ªé—®é¢˜ä¸€ç›´æƒ³ä¸æ˜ç™½<br>binlogå¯ä»¥nä¸ªäº‹åŠ¡åˆ·ä¸€æ¬¡ç›˜ï¼Œè¿™æ ·å°±æœ‰å¯èƒ½åœ¨crashæ—¶å€™ä¸¢å¤±è¿˜æ²¡æœ‰æŒä¹…åŒ–çš„binlog<br>å¦‚æœé…ç½®redo logè®¾ç½®ä¸ºæ¯æ¬¡äº‹åŠ¡æäº¤fsyncåˆ°ç£ç›˜ä¸­ï¼Œä½†æ˜¯binlogè®¾ç½®ä¸º100æ¬¡äº‹åŠ¡fsyncä¸€æ¬¡ï¼Œè¿™å°±æœ‰ä¸€ç§å¯èƒ½ï¼šåœ¨binlogè¿˜æ²¡æœ‰æŒä¹…åŒ–çš„æ—¶å€™ï¼Œäº‹åŠ¡å·²ç»æäº¤ï¼Œredologå®Œæ•´ï¼Œæ­¤æ—¶å®•æœºã€‚ä½†æ˜¯æ­¤æ—¶redolog å´æ˜¯å®Œæ•´çš„ã€‚<br>è¿™ç§æƒ…å†µè¿˜ä¼šä¸¢å¤±æ•°æ®å—ï¼Ÿ<br>æˆ‘çš„ç†è§£æ˜¯ä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œåªæ˜¯é€ æˆäº†binloogä¸å®Œæ•´ï¼Œè¿™æ ·å°±ä¼šé€ æˆä¸»ä»åŒæ­¥å¤±è´¥ã€‚<br>ä½†æ˜¯æ—¢ç„¶redologå¯ä»¥æ¢å¤æ•°æ®ï¼Œæ˜¯ä¸æ˜¯èƒ½æŠŠä¸¢å¤±çš„binlog è¡¥ä¸Šå‘¢ï¼Ÿå¦‚æœå¯ä»¥è¡¥ä¸Šï¼Œé‚£ä¸¢å¤±çš„binlogæ˜¯å¦å°±æ— æ‰€è°“äº†å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":345859,"user_name":"Geek_669721","can_delete":false,"product_type":"c1","uid":1308502,"ip_address":"","ucode":"631471460ACFF3","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83erabhkvu3jKSia1Y3l7pvicBy1YibN6GuIxLuZmI9E9icR8zdjP7BZ570PsDXv7ZLlMTU4Xr3Xz6N9bZg/132","comment_is_top":false,"comment_ctime":1652653000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652653000","product_id":100020801,"comment_content":"ä¸çŸ¥é“è€å¸ˆæ‚¨è¿˜åœ¨å˜›ğŸ˜‚æˆ‘æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœbinlogå’Œredologçš„ä¸¤é˜¶æ®µæäº¤åœ¨binlogå†™æˆåŠŸä¹‹åå´©æºƒï¼Œä½†æ˜¯è¿˜æ²¡commitï¼Œæœ€åredologä¼šè¿›è¡Œå´©æºƒæ¢å¤ï¼Œè®©è¿™ä¸ªäº‹åŠ¡å®Œæˆã€‚ä½†æ˜¯å¯¹äºæ‰§è¡Œè¿™ä¸ªäº‹åŠ¡çš„å®¢æˆ·ç«¯æ¥è¯´è¿™ä¸ªäº‹åŠ¡ä¸æ˜¯æ²¡å®Œæˆå—ï¼Ÿå¯¹äºå®¢æˆ·ç«¯æ¥è¯´æ˜¯å¤±è´¥çš„ï¼Œé‚£å®¢æˆ·ç«¯ä¸æ˜¯ä¼šå›æ»šå—ï¼Ÿè¿™é‡Œå®¢æˆ·ç«¯å’ŒMySQLçš„çŠ¶æ€æ˜¯ä¸æ˜¯å°±ä¸ä¸€è‡´äº†","like_count":0},{"had_liked":false,"id":344155,"user_name":"ç½—æ–‡å½¬","can_delete":false,"product_type":"c1","uid":1390646,"ip_address":"","ucode":"17AB673A419ED0","user_header":"https://static001.geekbang.org/account/avatar/00/15/38/36/711a66d0.jpg","comment_is_top":false,"comment_ctime":1651308180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651308180","product_id":100020801,"comment_content":"ç›¸äº’å…³æ³¨æˆå¥½å‹å“ªé‡Œï¼Œä¸æ˜¯å¾ˆç†è§£ä¸ºå•¥è¦è¿™æ ·è®¾è®¡ä¸¤å¼ è¡¨ï¼Œè€Œä¸”å½“Aå’ŒBä¸é‡å¤å…³æ³¨çš„è¯é‚£ä¸æ˜¯æˆä¸äº†å¥½å‹äº†","like_count":0},{"had_liked":false,"id":341101,"user_name":"ä¸Šå–„è‹¥æ°´","can_delete":false,"product_type":"c1","uid":1116397,"ip_address":"","ucode":"F4EC3FA1F27594","user_header":"https://static001.geekbang.org/account/avatar/00/11/08/ed/fe5242fe.jpg","comment_is_top":false,"comment_ctime":1649346312,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1649346312","product_id":100020801,"comment_content":"A&gt;Bï¼Œinsert ignore into friend(friend_1_id, friend_2_id) values(B,A);<br>æ˜¯ä¸æ˜¯<br>åº”è¯¥æ”¹æˆ insert ignore into friend(friend_1_id, friend_2_id) values(A,B);<br>ä¸ç„¶ friend åªä¼šæœ‰ä¸€æ¡æ•°æ®äº†ã€‚ä¸çŸ¥é“æˆ‘çš„ç†è§£å¯¹ä¸å¯¹ã€‚","like_count":0,"discussions":[{"author":{"id":1324550,"avatar":"https://static001.geekbang.org/account/avatar/00/14/36/06/08c46bcd.jpg","nickname":"è‚åˆ©","note":"","ucode":"808E064089724D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586465,"discussion_content":"ä¼˜åŒ–åç»“æœæ˜¯åªæœ‰ä¸€æ¡è®°å½•ï¼Œå¢åŠ ä¸€ä¸ªå­—æ®µï¼Œç”¨çŠ¶æ€æ¥ä»£è¡¨å…³æ³¨æ–¹å‘ï¼Œè°å…³æ³¨è°ï¼ŒAå…³æ³¨Bä¸º1,Bå…³æ³¨Aä¸º2ï¼Œäº’ç›¸å…³æ³¨ä¸€å®šæ˜¯3ï¼Œè€å¸ˆæ²¡æœ‰è¯¦ç»†è¯´æ˜ï¼Œçœ‹ä»£ç å¯ä»¥æ¨æ•²å‡ºæ¥ï¼Œæˆ‘ä¹Ÿç†è§£äº†å¾ˆä¹…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662254669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339656,"user_name":"ã€‚ã€‚","can_delete":false,"product_type":"c1","uid":2853618,"ip_address":"","ucode":"A52A6043D27D87","user_header":"https://static001.geekbang.org/account/avatar/00/2b/8a/f2/6c6f7886.jpg","comment_is_top":false,"comment_ctime":1648279052,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648279052","product_id":100020801,"comment_content":"è¿½é—®8é‡Œé¢ï¼Œå¦‚æœæ˜¯ redolog æ»¡äº†å‘¢ï¼Œæ­¤æ—¶å°±ä¸å¾—ä¸å»åˆ·è„é¡µäº†ï¼Œè¿™ä¸ªä¹Ÿæ˜¯åˆ·å†…å­˜ä¸­çš„è„é¡µå—ï¼Ÿä¹‹å‰çš„ç†è§£å°±æ˜¯ redolog è‡ªå·±å†™åˆ°ç£ç›˜ï¼ŒæŠŠ fsync åˆ·åˆ°ç£ç›˜çš„éƒ½æ“¦æ‹­äº†ï¼Œæ˜¯ç†è§£é”™äº†å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":337632,"user_name":"Geek_0cfc2d","can_delete":false,"product_type":"c1","uid":2365133,"ip_address":"","ucode":"4E7A034578A19E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLR2YXdT0AticVATPbtpd1LLOAA0FE1uRJstglZeBs1bAiaPB2PkEnlibIFtUPg1gsseribTib5Oiaw0BBA/132","comment_is_top":false,"comment_ctime":1646924807,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646924807","product_id":100020801,"comment_content":"çœ‹äº†è¯„è®ºåŒºå’Œè€å¸ˆè¯´çš„ï¼Œä½¿ç”¨ redo log åšå´©æºƒæ¢å¤è€Œä¸èƒ½ä½¿ç”¨ binglog çš„åŸå› åº”è¯¥æ˜¯ï¼š<br>1ã€redo log è®°å½•çš„æ˜¯é¡µçº§çš„æ”¹åŠ¨ï¼Œåˆ·ç›˜ä¹Ÿæ˜¯æŒ‰é¡µå»åˆ·çš„ï¼ˆè„é¡µï¼‰ï¼Œä¸¤è€…å¯ä»¥å¯¹åº”ä¸Šï¼›<br>2ã€binglog çš„è®°å½•å¹¶ä¸å¯¹åº”å“ªä¸ªé¡µçš„æ”¹åŠ¨ï¼Œå¯èƒ½ä¸€æ¡æ›´æ–°å°±å¯¹åº”å¤šä¸ªé¡µï¼Œå´©æºƒäº†ä¹Ÿä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹æŠŠåŸå…ˆè¿˜æœªåˆ·ç›˜çš„æ•°æ®è¿˜åŸã€‚","like_count":0},{"had_liked":false,"id":337091,"user_name":"FireD","can_delete":false,"product_type":"c1","uid":1614735,"ip_address":"","ucode":"60D2A6057E6924","user_header":"https://static001.geekbang.org/account/avatar/00/18/a3/8f/0501a57a.jpg","comment_is_top":false,"comment_ctime":1646618946,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646618946","product_id":100020801,"comment_content":"åªè¦prepare redologå’Œå†™binlogä¹Ÿèƒ½åšåˆ°crash-safeå’Œä¸»ä»ä¸€è‡´å§<br>å‘ç°prepare redologï¼Œé€šè¿‡XIDæ‰¾binlogï¼Œæ‰¾åˆ°ä¸”å®Œæ•´å°±commitï¼Œæ²¡æ‰¾åˆ°æˆ–è€…ä¸å®Œæ•´å°±rollback<br>ä»åº“æ”¶åˆ°binlogå°±æ‰§è¡ŒåŒæ­¥","like_count":0},{"had_liked":false,"id":337090,"user_name":"FireD","can_delete":false,"product_type":"c1","uid":1614735,"ip_address":"","ucode":"60D2A6057E6924","user_header":"https://static001.geekbang.org/account/avatar/00/18/a3/8f/0501a57a.jpg","comment_is_top":false,"comment_ctime":1646618733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646618733","product_id":100020801,"comment_content":"å¦‚æœè¿™æ ·è®¾è®¡æ˜¯ä¸æ˜¯ä¸è¦commit redologï¼Ÿ","like_count":0},{"had_liked":false,"id":333017,"user_name":"å°å¦–","can_delete":false,"product_type":"c1","uid":1730626,"ip_address":"","ucode":"49C01DBFADF101","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJvm1JYIDcS74s4cEYxA1PXMqjortVXEjUKyGQcPvibNJ4EAuksIa6uoHgr6G1yRqAM2KtP3yicKgTA/132","comment_is_top":false,"comment_ctime":1643960204,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643960204","product_id":100020801,"comment_content":"æ–‡ä¸­æåˆ°äº†redo log buffer åŒæ—¶åˆè¯´redo logæ˜¯ä¸¤é˜¶æ®µæäº¤ã€‚æˆ‘è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œäº‹åŠ¡åœ¨å†™redo log buffer åï¼Œæ²¡æœ‰å†™å…¥redo logæ–‡ä»¶ï¼ˆæ²¡æœ‰æœ€ç»ˆcommitï¼‰ä¹‹å‰crashäº†ï¼Œé‚£ä¹ˆredologæ˜¯æ€ä¹ˆè®°å½•åˆ°prepareçŠ¶æ€çš„","like_count":0},{"had_liked":false,"id":330378,"user_name":"ä½ä½çœŸå›","can_delete":false,"product_type":"c1","uid":2761438,"ip_address":"","ucode":"CE6E1A08C30DB1","user_header":"https://static001.geekbang.org/account/avatar/00/2a/22/de/1351551d.jpg","comment_is_top":false,"comment_ctime":1641958244,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641958244","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘çš„ç–‘æƒ‘æ˜¯ä¸¤é˜¶æ®µæäº¤é‡Œçš„å†™binlogè¿™ä¸€æ­¥éª¤ï¼Œæ˜¯å†™åˆ°binlog cacheé‡Œè¿˜æ˜¯ç›´æ¥è½ç›˜ã€‚æˆ‘å°è±¡é‡Œbinlogçš„è½ç›˜å¿…é¡»æ˜¯åœ¨äº‹åŠ¡æäº¤åè¿›è¡Œçš„ï¼Œä½†æ˜¯çœ‹æ‚¨çš„æè¿°æ„Ÿè§‰commitä¹‹å‰çš„å†™binlogè¿™ä¸ªæ­¥éª¤æ˜¯è½ç›˜ã€‚","like_count":0},{"had_liked":false,"id":329980,"user_name":"æé¾™","can_delete":false,"product_type":"c1","uid":1323030,"ip_address":"","ucode":"7B85A27E40D261","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/16/4773d604.jpg","comment_is_top":false,"comment_ctime":1641712285,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641712285","product_id":100020801,"comment_content":"æ–‡ä¸­è¿™ä¸€å¥ï¼š&quot;çœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„&quot;ï¼Œå¦‚æœredo logä¸ºprepareçŠ¶æ€ï¼Œbinlogå·²å†™å…¥ï¼Œä½†äº‹åŠ¡è¿˜æœªæ‰§è¡Œcommitæ­¥éª¤ï¼Œæ­¤æ—¶æ•°æ®åº“æ‰€åœ¨æœåŠ¡å™¨æ‰ç”µå®•æœºï¼Œæ˜¯å¦æ„å‘³ç€redo log bufferæœªå†™å…¥binlogï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯binlogæœ‰è®°å½•ï¼Œredo logæ— è®°å½•ï¼Ÿè°¢è°¢","like_count":0},{"had_liked":false,"id":324405,"user_name":"Geek_aa9f6e","can_delete":false,"product_type":"c1","uid":2046557,"ip_address":"","ucode":"D2EAAC7244FA45","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epHrVsJzVH0LUFyMmU77Raj3fF3oXrl8OpD4v1wWhRHjPbs2iaeZE5qtw1ZoZWqq5oAeDkAwa8Nv6g/132","comment_is_top":false,"comment_ctime":1638416893,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638416893","product_id":100020801,"comment_content":"åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ï¼ŒInnoDB å¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Œå°±ä¼šåœ¨å…¶ä¸Šåº”ç”¨è¿™ä¸ªredo logï¼Œè®©å®ƒé‡æ–°æˆä¸ºè„é¡µã€‚<br>InnoDBæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ï¼Ÿå´©æºƒä¹‹åï¼Œbuffer poolæ˜¯ç©ºçš„ï¼Œåªå‡­å€Ÿredo logï¼Œå¦‚ä½•åˆ¤æ–­å…¶å¯¹åº”çš„æ•°æ®é¡µæ˜¯ä¸æ˜¯å¹²å‡€çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":323796,"user_name":"freesocean","can_delete":false,"product_type":"c1","uid":1529210,"ip_address":"","ucode":"CAD4C80CF569D3","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/7a/d44df1d6.jpg","comment_is_top":false,"comment_ctime":1638165197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638165197","product_id":100020801,"comment_content":"æˆ‘éªŒè¯çš„æ–¹æ³•æ˜¯é€šè¿‡binlogæ—¥å¿—ï¼šå¼€å¯bin-logåï¼Œè®¾ç½®ä¸ºStatementæ ¼å¼ï¼Œå‘ç°æœ‰å¯¹åº”çš„æ“ä½œæ—¥å¿—ã€‚<br>å› ä¸ºæ ¹æ®ä¹‹å‰æ–‡ç« æ›´æ–°çš„æµç¨‹ï¼Œæ›´æ–°çš„åŠ¨ä½œè‚¯å®šä¼šä¼ é€’åˆ°Innodbå±‚ï¼Œè‡³äºInnodbæœ‰æ²¡æœ‰åšï¼ŒæŒ‰è¯´åº”è¯¥<br>çœ‹redolog, ä½†æ˜¯redologæ˜¯ç‰©ç†æ—¥å¿—ï¼Œä¸å¥½æŸ¥çœ‹ï¼Œå¹¶ä¸”æäº¤äº†äº‹åŠ¡çš„commitï¼Œundoé¡µå¯èƒ½å·²ç»ä¼šå›æ”¶ã€‚è€Œbinlogå’Œredologçš„ä¸¤é˜¶æ®µæäº¤æ–¹å¼ï¼Œè¯´æ˜ä»binlogä¹Ÿèƒ½çœ‹åˆ°innodbçš„è¡Œä¸ºã€‚<br><br>è‡³äºä¸ºä½•è¿™ä¹ˆåšï¼Œæˆ‘æ²¡æƒ³å‡ºæ¯”è¾ƒå¥½çš„ç­”æ¡ˆã€‚è¯„è®ºåŒºé€šè¿‡äº‹åŠ¡è§’åº¦åˆ‡å…¥çœ‹è¿™ä¸ªé—®é¢˜ï¼Œæ„Ÿè§‰æ˜¯æ­£è§£ã€‚","like_count":0},{"had_liked":false,"id":323367,"user_name":"å…‹é‡Œæ–¯","can_delete":false,"product_type":"c1","uid":1181844,"ip_address":"","ucode":"00B755C10AC1C3","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/94/2c22bd4e.jpg","comment_is_top":false,"comment_ctime":1637855939,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1637855939","product_id":100020801,"comment_content":"Commité˜¶æ®µï¼Œå‘ç£ç›˜ä¸­çš„Redo Logå†™å…¥Commitæ ‡è¯†ï¼Œè¡¨ç¤ºäº‹åŠ¡æäº¤,å‘ƒå‘ƒï¼Œäº‘é‡Œé›¾é‡Œï¼ŒCommitæ ‡è¯†æ˜¯ä»€ä¹ˆï¼Ÿä¸ºå•¥æœ€é‡è¦çš„ä¸œè¥¿ä¸è¯´æ¸…æ¥šå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":322291,"user_name":"freesocean","can_delete":false,"product_type":"c1","uid":1529210,"ip_address":"","ucode":"CAD4C80CF569D3","user_header":"https://static001.geekbang.org/account/avatar/00/17/55/7a/d44df1d6.jpg","comment_is_top":false,"comment_ctime":1637291568,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637291568","product_id":100020801,"comment_content":"MySQL æŠ€æœ¯å†…å¹•æœ‰ä¸€å¥ï¼šå› ä¸ºé‡åšæ—¥å¿—å†™å…¥ç£ç›˜æ—¶æ˜¯æŒ‰ç…§512å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ‰‡åŒºçš„å¤§å°å†™å…¥ï¼Œæ‰‡åŒºæ˜¯å†™å…¥çš„æœ€å°å•ä½ï¼Œå› æ­¤å¯ä»¥ä¿è¯å¸å…¥å¿…å®šæ˜¯æˆåŠŸçš„ã€‚ æƒ³è¯·æ•™è€å¸ˆï¼Œä¸ºä½•ä»¥æ‰‡åŒºä¸ºå•ä½å†™ï¼Œå°±ä¸€å®šæ˜¯æˆåŠŸçš„ï¼Ÿï¼Ÿä¸€ç›´å¾ˆç–‘æƒ‘ã€‚æœ›è§£ç­”ã€‚","like_count":0},{"had_liked":false,"id":318877,"user_name":"ç“œç‰›","can_delete":false,"product_type":"c1","uid":2273620,"ip_address":"","ucode":"5EB7D2F4400A70","user_header":"https://static001.geekbang.org/account/avatar/00/22/b1/54/6d663b95.jpg","comment_is_top":false,"comment_ctime":1635472342,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635472342","product_id":100020801,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œbinlogæäº¤ä»¥åï¼Œä»åº“å¬åˆ°è¿™ä¸ªbinlogå¹¶æ‰§è¡Œäº†ï¼Œé‚£è¿™ä¸ªæ—¶å€™ä¸»åº“å†commitï¼Œé‚£ä¸»åº“ä¸å°±æ¯”ä»åº“æ…¢äº†å—ï¼Ÿä¸»ä»å°±ä¸ä¸€è‡´äº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":315716,"user_name":"å…‹å…‹","can_delete":false,"product_type":"c1","uid":2742451,"ip_address":"","ucode":"0FA7CA5AB26A6F","user_header":"https://static001.geekbang.org/account/avatar/00/29/d8/b3/38105dbb.jpg","comment_is_top":false,"comment_ctime":1633952056,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633952056","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä¸Šé¢è¯´çš„å…ˆå†™redo logå†å†™binlogçš„é—®é¢˜ï¼Œå¦‚æœredo logå¯ä»¥å›æ»šï¼Œä¸ºä»€ä¹ˆå¯èƒ½ä¼šè¦†ç›–åˆ«çš„è®°å½•å‘€ï¼Ÿ","like_count":0},{"had_liked":false,"id":314993,"user_name":"582726866","can_delete":false,"product_type":"c1","uid":1368458,"ip_address":"","ucode":"DED4D636F024C0","user_header":"https://static001.geekbang.org/account/avatar/00/14/e1/8a/ec2f38bd.jpg","comment_is_top":false,"comment_ctime":1633647574,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633647574","product_id":100020801,"comment_content":"è¡¨çš„å­—æ®µåå»ºè®®æ”¹ä¸€ä¸‹ï¼Œuser1,user2ã€‚å½“user1 like user2æ—¶, relationshipä¸º1ã€‚å½“user2 like user1æ—¶relationshipä¸º2ï¼Œäº’ç›¸likeæ—¶relationshipä¸º3","like_count":0},{"had_liked":false,"id":314265,"user_name":"æ€è€ƒçš„æŠ€æœ¯","can_delete":false,"product_type":"c1","uid":1109283,"ip_address":"","ucode":"4D1CEF299F8349","user_header":"https://static001.geekbang.org/account/avatar/00/10/ed/23/94158691.jpg","comment_is_top":false,"comment_ctime":1632922769,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632922769","product_id":100020801,"comment_content":"é«˜å¹¶å‘åœºæ™¯ç”¨è¡¨æ–¹å¼è®°å½•è¡¨æ€»è¡Œæ•°ï¼Œæ— ç–‘ä¼šé€ æˆæ€§èƒ½ä½ä¸‹","like_count":0},{"had_liked":false,"id":313701,"user_name":"ä¸å‡¡","can_delete":false,"product_type":"c1","uid":2031689,"ip_address":"","ucode":"28A3EC4C309C56","user_header":"","comment_is_top":false,"comment_ctime":1632623925,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632623925","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œåœ¨ä¸»ä»æ¨¡å¼åŠåŒæ­¥after_syncæƒ…å†µä¸‹ï¼ŒäºŒé˜¶æ®µæäº¤ä¸­binlogçš„xidå†™å…¥æ—¶æœºæ˜¯åœ¨å“ªä¸€æ­¥å†™å…¥çš„","like_count":0},{"had_liked":false,"id":312587,"user_name":"Geek_8226bc","can_delete":false,"product_type":"c1","uid":2147472,"ip_address":"","ucode":"9F67898DAC2223","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLbM6ZwjHTUuMNI1gIib8ZQTaljbnh1GxEE7RhffyO3SE5ibhh2fWwG1xkyb1XNnYzUhe5b2zaFYy8g/132","comment_is_top":false,"comment_ctime":1631877941,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631877941","product_id":100020801,"comment_content":"redologçš„prepareé˜¶æ®µæ˜¯æ€ä¹ˆå›æ»šçš„","like_count":0},{"had_liked":false,"id":312570,"user_name":"Geek_8226bc","can_delete":false,"product_type":"c1","uid":2147472,"ip_address":"","ucode":"9F67898DAC2223","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLbM6ZwjHTUuMNI1gIib8ZQTaljbnh1GxEE7RhffyO3SE5ibhh2fWwG1xkyb1XNnYzUhe5b2zaFYy8g/132","comment_is_top":false,"comment_ctime":1631869088,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631869088","product_id":100020801,"comment_content":"å…³äºä¸¤é˜¶æ®µæäº¤æœ‰ä¸ªé—®é¢˜æœ›è§£ç­”ï¼Œæ„Ÿè°¢ï¼<br>redo log çš„ prepare é˜¶æ®µæ•°æ®æ˜¯æ€ä¹ˆä¿ç•™çš„ï¼Ÿ<br>1ã€å¦‚æœæ˜¯å†…å­˜ï¼Œè¿˜æ²¡åˆ°æœ€åçš„commitï¼Œé‡å¯æ•°æ®ä¸¢å¤±<br>2ã€å¦‚æœæ˜¯ç£ç›˜ï¼ˆå‡å¦‚å°±æ˜¯redo logç£ç›˜ï¼Œåªæ˜¯çŠ¶æ€æ˜¯prepareï¼‰ï¼Œbinlogè¿˜æœªå†™å…¥ï¼Œé‡å¯éœ€è¦å›æ»šredo logï¼Œå¦‚ä½•å›æ»šï¼ˆæ­£å¦‚è€å¸ˆæ‰€è¯´çš„redologæ˜¯é¡ºåºå†™ï¼Œä¸èƒ½å›æ»šï¼‰","like_count":0},{"had_liked":false,"id":310860,"user_name":"Aî€² æ‹½ä¸«å¤´","can_delete":false,"product_type":"c1","uid":1470434,"ip_address":"","ucode":"F875D99D18DF6E","user_header":"https://static001.geekbang.org/account/avatar/00/16/6f/e2/f3b05833.jpg","comment_is_top":false,"comment_ctime":1630937673,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1630937673","product_id":100020801,"comment_content":"ç–‘é—®ï¼šåœ¨å¥”æºƒæ¢å¤çš„æ—¶å€™ï¼Œæ ¹æ®redo log  å’Œ bin log ç»“åˆä½¿ç”¨ï¼Œä½†æ˜¯æ€ä¹ˆçŸ¥é“ä»é‚£ä¸ªèŠ‚ç‚¹å¼€å§‹æ¢å¤æ•°æ®äº†ï¼Ÿæ˜¯æŒ‰ç…§redo log çš„æ•°æ®æ¥æ¢å¤çš„å—ï¼Ÿ æ¢å¤redo log ä¸­çš„æ‰€æœ‰çš„è®°å½•ï¼Ÿ  å¦‚æœæ˜¯çš„è¯ï¼Œæœ‰ä¸ªç–‘é—®ï¼Œredo log åœ¨è¢«åº”ç”¨åˆ°  change  buffer ä¸­ä¹‹åï¼Œåˆ·è„é¡µçš„æ—¶å€™æ˜¯ä»¥change buffer çš„æ•°æ®é¡µæ¥è€æ–°çš„ï¼Œé‚£ä¹ˆ redo log è¢«å½“å‰change buffer åº”ç”¨çš„log ï¼Œä¼šåˆ é™¤å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":309669,"user_name":"è¢«é’“çš„é±¼","can_delete":false,"product_type":"c1","uid":2748506,"ip_address":"","ucode":"A5AFC5D38B88FC","user_header":"https://static001.geekbang.org/account/avatar/00/29/f0/5a/e5bfa9ac.jpg","comment_is_top":false,"comment_ctime":1630295408,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630295408","product_id":100020801,"comment_content":"åˆ†å¸ƒå¼ä¸€è‡´æ€§çœŸçš„æ˜¯ä¸ªå¾ˆæ·±å…¥çš„è¯¾é¢˜, ä¸å­˜åœ¨å®Œç¾æ— ç¼ºçš„ä¸€è‡´æ€§, åªæœ‰æ€§èƒ½ä¸ä¸€è‡´æ€§ä¹‹é—´çš„æƒè¡¡, æç«¯ç†è®ºè®², ä»»ä½•é—´éš™æ€§æ“ä½œéƒ½å¯èƒ½å‡ºç°å®•æœº, ä¸ç®¡æ˜¯redo log bufferå’Œos bufferéƒ½åªæ˜¯æ¯”è¾ƒä¸€è‡´æ€§å’Œæ€§èƒ½çš„å¾—å¤±åçš„æ–¹æ¡ˆ, æ‰€ä»¥ç ”ç©¶è¿™ç§é—®é¢˜æ›´å¤šçš„åº”è¯¥å…³æ³¨å¹³è¡¡ç‚¹, è€Œä¸è¦è¿‡äºé’»ç ”ä¸€è‡´æ€§è€Œæ‰å…¥ç‰›è§’å°–ä¸­","like_count":0},{"had_liked":false,"id":308987,"user_name":"Geek_8cf0a3","can_delete":false,"product_type":"c1","uid":2109366,"ip_address":"","ucode":"D1ACDE82193AA2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLn1rhQ7nlmQgyEZhgfgH0s9BicusXhTG7J6Tcxib2oDVoKVTbia9CcNIkicj2L2a2xqQRicF4FhPepjqA/132","comment_is_top":false,"comment_ctime":1629882460,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1629882460","product_id":100020801,"comment_content":"å¤§ä½¬è¿˜ä¼šçœ‹è¯„è®ºåŒºå—ï¼Ÿæœ‰ä¸ªé—®é¢˜æƒ³é—®ä¸‹ã€‚MySQLä¼šåœ¨äºŒé˜¶æ®µæäº¤çš„ä»€ä¹ˆæ—¶å€™ç»™å®¢æˆ·ç«¯å“åº”æˆåŠŸå‘¢ï¼Ÿæˆ‘ç†è§£åº”è¯¥æ˜¯åœ¨æˆåŠŸcommitä»¥åã€‚é‚£å¦‚æœMySQLåœ¨binlog å†™å®Œï¼Œredo log è¿˜æ²¡ commit å‰å‘ç”Ÿ crashï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°çš„åº”è¯¥ä¼šæ˜¯ä¸€ä¸ªè¶…æ—¶ä¹‹ç±»çš„é”™è¯¯å“åº”ã€‚å¦‚æœMySQLé‡å¯åæ‰ä¼šæ ¹æ®binlogå®Œæ•´ç¨‹åº¦å†³å®šäº‹åŠ¡æ˜¯å¦æäº¤çš„è¯ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç æ˜¯ä¸æ˜¯å°±æ²¡åŠæ³•ç¡®å®šäº‹åŠ¡åˆ°åº•æ˜¯æˆåŠŸäº†è¿˜æ˜¯å¤±è´¥äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2112092,"avatar":"https://static001.geekbang.org/account/avatar/00/20/3a/5c/60fdf8e2.jpg","nickname":"wtdd","note":"","ucode":"26C64BF9CCA061","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392192,"discussion_content":"binlogå®Œæ•´ç¨‹åº¦ä»£è¡¨ç€äº‹åŠ¡å°±æ˜¯æˆåŠŸäº†ï¼Œè™½ç„¶å®é™…ä¸Šäº‹åŠ¡å¼‚å¸¸ç»ˆæ­¢äº†ï¼Œä½†æ˜¯æ—¥å¿—æ–‡ä»¶å®Œæ•´ï¼Œæ­¤æ—¶ä¼šé‡æ–°æäº¤äº‹åŠ¡ï¼Œå°†æœªå®Œæˆçš„äº‹åŠ¡å†æ‰§è¡Œä¸€æ¬¡ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630896064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307105,"user_name":"Miroticwillbeforever","can_delete":false,"product_type":"c1","uid":2488913,"ip_address":"","ucode":"1DDD8AECD93EA8","user_header":"https://static001.geekbang.org/account/avatar/00/25/fa/51/5da91010.jpg","comment_is_top":false,"comment_ctime":1628862250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628862250","product_id":100020801,"comment_content":"çœ‹äº†ä¹Ÿæœ‰ä¸ƒå…«é—¨è¯¾ç¨‹ï¼Œè¿™é—¨è¯¾ç¨‹è€å¸ˆçš„å›å¤ç¡®å®å°½å¿ƒå°½è´£ã€‚<br>å‰é¢15è®²è®¤çœŸçœ‹ï¼Œè®¤çœŸåšç¬”è®°ï¼Œæ”¶è·è¿˜æ˜¯æŒºå¤§çš„ï¼Œä½†æ˜¯æˆ‘æœ‰ä¸ªå°é—®é¢˜ï¼Œå¯¹äºåªä¼šç®€å•çš„ SQLè¯­å¥çš„äººæ¥è¯´ï¼Œæ¯”å¦‚é‚£äº›ç´¢å¼•éƒ½è¿˜å‚»å‚»åˆ†å¸ƒæ¸…ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œè€å¸ˆèƒ½å¦æä¾›ä¸€ä¸ªå°æ¿å—æ¨èä¸€äº›è¾…åŠ©èµ„æ–™ã€‚æ¯”å¦‚ä¹¦ç±æˆ–è€…åšå®¢ä¹‹ç±»çš„ï¼Œç°åœ¨æ–°æ‰‹å¾ˆéš¾ä»è¿™ä¹ˆå¤šçš„äº’è”ç½‘èµ„æºä¸­æ‹©ä¼˜æˆ–è€…è¾¨åˆ«å“ªä¸ªå¥½ï¼Œå“ªä¸ªä¸å¥½äº†ã€‚ã€‚","like_count":0},{"had_liked":false,"id":306943,"user_name":"å¢æœ¬ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1941856,"ip_address":"","ucode":"E03B9949016930","user_header":"https://static001.geekbang.org/account/avatar/00/1d/a1/60/98f81f78.jpg","comment_is_top":false,"comment_ctime":1628783701,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1628783701","product_id":100020801,"comment_content":"æˆ‘å°±æƒ³é—®ï¼Œä½ å†™å‡ºè¿™ç§åŠæˆå“å¥½æ„æ€å—ï¼Ÿå°±ä¸èƒ½å†™æˆä¸€ä¸ªç« èŠ‚ï¼ŒæŠŠæ—¥å¿—å†å¥½å¥½è®²è®²ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2112092,"avatar":"https://static001.geekbang.org/account/avatar/00/20/3a/5c/60fdf8e2.jpg","nickname":"wtdd","note":"","ucode":"26C64BF9CCA061","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392196,"discussion_content":"è¿™åªæ˜¯ç­”ç–‘ï¼Œå‰é¢çš„å·²ç»éƒ½è®²äº†ï¼Œè¿˜æœ‰ä¸ä¼šçš„è‡ªå·±å»æŸ¥ï¼Œä¸ºå•¥è¿˜è¦å†è®²æ—¥å¿—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630896449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306880,"user_name":"èµ´","can_delete":false,"product_type":"c1","uid":2675954,"ip_address":"","ucode":"D47B3179BE3950","user_header":"https://static001.geekbang.org/account/avatar/00/28/d4/f2/3c0bfa0e.jpg","comment_is_top":false,"comment_ctime":1628760717,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628760717","product_id":100020801,"comment_content":"å‡å¦‚æ²¡æœ‰æ‰“å¼€binlogæ˜¯ä¸æ˜¯redo-logè¦ä¹ˆcommitï¼Œè¦ä¹ˆä¸æˆåŠŸ","like_count":0},{"had_liked":false,"id":306496,"user_name":"BCool","can_delete":false,"product_type":"c1","uid":2689813,"ip_address":"","ucode":"E6C2B78F379988","user_header":"https://static001.geekbang.org/account/avatar/00/29/0b/15/d2b7d7be.jpg","comment_is_top":false,"comment_ctime":1628585642,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628585642","product_id":100020801,"comment_content":"å…³äºè¿½é—®5çš„å›¾2ä¾‹å­ï¼Œäº‹åŠ¡1æ—¢ç„¶å·²ç»commitäº†ï¼Œä¸ºä»€ä¹ˆä¹‹åçš„å´©æºƒå›å¤ä¼šä¸¢å¤±å®ƒå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":305421,"user_name":"cake","can_delete":false,"product_type":"c1","uid":1966533,"ip_address":"","ucode":"55A7FC6CC1204C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/01/c5/b48d25da.jpg","comment_is_top":false,"comment_ctime":1627966331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627966331","product_id":100020801,"comment_content":"æœ‰äººé—®å…ˆå†™å…¥redo log bufferç„¶åå†™binlog,binlogå†™å…¥ç£ç›˜,å´©æºƒäº†æ€ä¹ˆåŠå‘¢?<br>redo logä¼šè®°å½•å†…å­˜é¡µçš„ä¿®æ”¹,å¦‚æœæ­¤æ—¶å´©æºƒ,redo log bufferæ²¡äº†,æ•°æ®é¡µæ²¡äº†,binlogè¿˜åœ¨ã€‚å´©æºƒæ¢å¤çš„æ—¶å€™,ä¼šæŒ‰é¡ºåºæ‰«æ redo logæ¥æ¢å¤,æ²¡redo log é‚£å°±ä¸ç”¨æ¢å¤,ä½†äº‹åŠ¡æ²¡æœ‰æäº¤, å°±ä¼šé€šè¿‡undo logä¼šå›æ»šã€‚å› ä¸ºå†…å­˜æ•°æ®æ•°æ®é¡µæ²¡æœ‰åˆ·æ–°åˆ°ç£ç›˜,ä¹Ÿæ²¡ä»€ä¹ˆå…³ç³»ã€‚ä½†æ˜¯ä¸€æ—¦äº‹åŠ¡æäº¤äº†,å¿…é¡»é€šè¿‡é…ç½®æŠŠredo log åŒæ­¥åˆ°ç£ç›˜,ä¸ä»…ä»…æ˜¯å†™å…¥æ“ä½œç³»ç»Ÿç¼“å†²åŒºã€‚å¦‚æœè¿™æ—¶å€™å´©æºƒäº†,ç£ç›˜ä¸Šçš„redo logå°±ä¸æ˜¯å®Œæ•´çš„ã€‚ä¸ç”¨å´©æºƒæ¢å¤,å› ä¸ºè™½ç„¶äº‹åŠ¡æäº¤ä½†æ•°æ®æ²¡åˆ·åˆ°ç£ç›˜,æ‰€ä»¥æ²¡å½±å“ã€‚","like_count":0},{"had_liked":false,"id":305207,"user_name":"ğŸ¤©","can_delete":false,"product_type":"c1","uid":2063201,"ip_address":"","ucode":"9F0524A1BA1BE6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7b/61/b65f1438.jpg","comment_is_top":false,"comment_ctime":1627876882,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627876882","product_id":100020801,"comment_content":"â€œåœ¨å´©æºƒæ¢å¤åœºæ™¯ä¸­ï¼ŒInnoDB å¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Œå°±ä¼šå°†å®ƒè¯»åˆ°å†…å­˜ï¼Œç„¶åè®© redo log æ›´æ–°å†…å­˜å†…å®¹ã€‚æ›´æ–°å®Œæˆåï¼Œå†…å­˜é¡µå˜æˆè„é¡µï¼Œå°±å›åˆ°äº†ç¬¬ä¸€ç§æƒ…å†µçš„çŠ¶æ€ã€‚â€<br>æˆ‘å¯¹æ–‡å­—è¿™æ®µè¯æœ‰ç–‘é—®ï¼Œæ€ä¹ˆåˆ¤æ–­æ•°æ®é¡µåœ¨å¥”æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°å‘¢ï¼Ÿå› ä¸ºå†æ¬¡ä»ç£ç›˜å°†æ•°æ®è¯»åˆ°å†…å­˜ä¸­æ—¶ä¸€å®šæ˜¯å¹²å‡€é¡µ(ç£ç›˜å’Œå†…å­˜æ•°æ®ä¸€è‡´)ï¼Œæˆ‘è®°å¾—å‰é¢å‡ èŠ‚è®²è¿‡åœ¨å†…å­˜ä¸è¶³æˆ–å…¶ä»–åŸå› åˆ·è„é¡µçš„æ—¶å€™æ˜¯ä¸ä¼šå¯¹redo logä¸­çš„æ•°æ®æœ‰ä»»ä½•æ“ä½œçš„ï¼Œæ‰€ä»¥redo logåœ¨åˆ·å†…å­˜çš„æ—¶å€™è‹¥æ˜¯å¹²å‡€é¡µåˆ™è·³è¿‡ä¸å¤„ç†ã€‚","like_count":0},{"had_liked":false,"id":305206,"user_name":"ğŸ¤©","can_delete":false,"product_type":"c1","uid":2063201,"ip_address":"","ucode":"9F0524A1BA1BE6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7b/61/b65f1438.jpg","comment_is_top":false,"comment_ctime":1627876755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627876755","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œä½ å¥½:æ–‡ä¸­æœ‰ä¸€å¥è¯â€œåœ¨å´©æºƒæ¢å¤åœºæ™¯ä¸­ï¼ŒInnoDB å¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Œå°±ä¼šå°†å®ƒè¯»åˆ°å†…å­˜ï¼Œç„¶åè®© redo log æ›´æ–°å†…å­˜å†…å®¹ã€‚æ›´æ–°å®Œæˆåï¼Œå†…å­˜é¡µå˜æˆè„é¡µï¼Œå°±å›åˆ°äº†ç¬¬ä¸€ç§æƒ…å†µçš„çŠ¶æ€ã€‚â€<br>æˆ‘å¯¹æ–‡å­—è¿™æ®µè¯æœ‰ç–‘é—®ï¼Œæ€ä¹ˆåˆ¤æ–­æ•°æ®é¡µåœ¨å¥”æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°å‘¢ï¼Ÿå› ä¸ºå†æ¬¡ä»ç£ç›˜å°†æ•°æ®è¯»åˆ°å†…å­˜ä¸­æ—¶ä¸€å®šæ˜¯å¹²å‡€é¡µ(ç£ç›˜å’Œå†…å­˜æ•°æ®ä¸€è‡´)ï¼Œæˆ‘è®°å¾—å‰é¢å‡ èŠ‚è®²è¿‡åœ¨å†…å­˜ä¸è¶³æˆ–å…¶ä»–åŸå› åˆ·è„é¡µçš„æ—¶å€™æ˜¯ä¸ä¼šå¯¹redo logä¸­çš„æ•°æ®æœ‰ä»»ä½•æ“ä½œçš„ï¼Œæ‰€ä»¥redo logåœ¨åˆ·å†…å­˜çš„æ—¶å€™è‹¥æ˜¯å¹²å‡€é¡µåˆ™è·³è¿‡ä¸å¤„ç†ã€‚","like_count":0},{"had_liked":false,"id":302789,"user_name":"gsn99939","can_delete":false,"product_type":"c1","uid":2678962,"ip_address":"","ucode":"D32D25832CD47B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGOW1Crcle750QWghPE0lDQoHJYibh4KXFoMRF7qLhWde1nKaeOaaT4IKtC1urx44via16yntc9YdQ/132","comment_is_top":false,"comment_ctime":1626363968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626363968","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å°±æ˜¯åœ¨åˆ·è„é¡µçš„æ—¶å€™redo logæ—¥å¿—çš„checkpointä¼šè·Ÿç€æ¨è¿›å—ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":302133,"user_name":"ç†ŠçŒ«","can_delete":false,"product_type":"c1","uid":1080238,"ip_address":"","ucode":"23C85117A16BEF","user_header":"https://static001.geekbang.org/account/avatar/00/10/7b/ae/66ae403d.jpg","comment_is_top":false,"comment_ctime":1626094722,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626094722","product_id":100020801,"comment_content":"è€å¸ˆè¿™å¥:â€œå‹ç¼©â€åˆ°ä¸€ä¸ªè¯­å½•é‡Œé¢å®Œæˆï¼Œè¯´çš„å¤ªå¥½äº†ã€‚---å¥½å¤šç¨‹åºéƒ½å­˜åœ¨ç±»ä¼¼çš„â€œå‹ç¼©â€ï¼Œå‹ç¼©èƒŒåçš„åŸç†æ˜¾çš„æ ¼å¤–é‡è¦","like_count":0},{"had_liked":false,"id":300138,"user_name":"Geek_slk","can_delete":false,"product_type":"c1","uid":1614499,"ip_address":"","ucode":"413CDBEF0B7679","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRXPleVJnXU4gib2Hib5xR7jMmAgVPs1GKuJ39ib8HvnVk79Q3k8STLhOcCcO2rjKSuuMLFRekCyL2A/132","comment_is_top":false,"comment_ctime":1625019461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625019461","product_id":100020801,"comment_content":"è€å¸ˆ æ²¡æƒ³æ˜ç™½ ä¸ºå•¥è¦æ¯”è¾ƒA å’ŒBå‘¢ æ¯”è¾ƒä¸¤ä¸ªç”¨æˆ·çš„userId è¿™æ˜¯ä¸ºä»€ä¹ˆå•Š æƒ³ä¸æ˜ç™½å•Š","like_count":0},{"had_liked":false,"id":300133,"user_name":"Geek_slk","can_delete":false,"product_type":"c1","uid":1614499,"ip_address":"","ucode":"413CDBEF0B7679","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLRXPleVJnXU4gib2Hib5xR7jMmAgVPs1GKuJ39ib8HvnVk79Q3k8STLhOcCcO2rjKSuuMLFRekCyL2A/132","comment_is_top":false,"comment_ctime":1625018538,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625018538","product_id":100020801,"comment_content":"è€å¸ˆ æ²¡æƒ³æ˜ç™½ æ‚¨è¯´çš„A&gt;B æ˜¯æŒ‡ä»€ä¹ˆ Aæ€ä¹ˆå¤§äºBæ˜¯å“ªä¸ªå­—æ®µä¹ˆ","like_count":0},{"had_liked":false,"id":298802,"user_name":"èƒ¡æµ©ğŸ¸","can_delete":false,"product_type":"c1","uid":1157175,"ip_address":"","ucode":"F2184A31258439","user_header":"https://static001.geekbang.org/account/avatar/00/11/a8/37/00ed15af.jpg","comment_is_top":false,"comment_ctime":1624329412,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624329412","product_id":100020801,"comment_content":"ä¸å¥‡è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“ä½ è¿˜èƒ½çœ‹åˆ°ç•™è¨€ä¸ã€‚<br><br>a è¡¨ 353642331 æ¡æ•°æ®, b è¡¨ 462103637 æ¡æ•°æ®ï¼Œa è¡¨çš„ b_id æœ‰ç´¢å¼•ï¼Œ b è¡¨çš„ id æ˜¯ä¸»é”®ï¼Œ xxx ä¸Šä¹Ÿæœ‰ç´¢å¼•ï¼Œ<br>ä¸ºå•¥ä¸‹é¢è¿™æ¡è¯­å¥è·‘äº† 69 ä¸ªå°æ—¶è¿˜æ²¡ç»“æŸå‘€ï¼Ÿ<br><br>update a join b on a.b_id = b.id set a.xxx = b.xxx<br><br>innodb_trx é‡Œçœ‹åˆ° trx_rows_locked: 460259156 äº†ï¼Œæ˜¯è¦ç­‰åˆ° 462103637 æ‰èƒ½ç»“æŸå—ï¼Ÿ<br><br>ä¹‹å‰ a è¡¨çš„ b_id æ²¡ç´¢å¼•ï¼Œè·‘äº†ä¸€æ™šä¸Šæ²¡è·‘å®Œï¼Œæˆ‘å›æ»šäº†ï¼ŒåŠ äº†ä¸€ä¸ª b_id ç´¢å¼•ï¼Œç»“æœè¿˜æ˜¯è·‘äº†ä¸¤å¤©æ²¡è·‘å®Œï¼Œæˆ‘è¯¥æ€ä¹ˆåšèƒ½åŠ é€Ÿè¿™ä¸ª update è¯­å¥å‘¢ï¼Ÿ<br><br>é—®è¿‡ä¸€äº›æœ‹å‹ï¼Œå¤§å¤šæ¨èå†™è„šæœ¬åˆ†æ‰¹ä¸€ä¸‡ä¸€ä¸‡çš„updateï¼Œæˆ‘æƒ³çŸ¥é“æœ‰å…¶å®ƒçš„åŠæ³•å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":297478,"user_name":"ç‹åº·","can_delete":false,"product_type":"c1","uid":1416934,"ip_address":"","ucode":"DDFAA49639927C","user_header":"https://static001.geekbang.org/account/avatar/00/15/9e/e6/f362dad1.jpg","comment_is_top":false,"comment_ctime":1623572103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623572103","product_id":100020801,"comment_content":"â€œè¿™ä¸ªäº‹åŠ¡è¦å¾€ä¸¤ä¸ªè¡¨ä¸­æ’å…¥è®°å½•ï¼Œæ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ—¥å¿—éƒ½å¾—å…ˆä¿å­˜èµ·æ¥ï¼Œä½†åˆä¸èƒ½åœ¨è¿˜æ²¡ commit çš„æ—¶å€™å°±ç›´æ¥å†™åˆ° redo log æ–‡ä»¶é‡Œã€‚<br>æ‰€ä»¥ï¼Œredo log buffer å°±æ˜¯ä¸€å—å†…å­˜ï¼Œç”¨æ¥å…ˆå­˜ redo æ—¥å¿—çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œç¬¬ä¸€ä¸ª insert çš„æ—¶å€™ï¼Œæ•°æ®çš„å†…å­˜è¢«ä¿®æ”¹äº†ï¼Œredo log buffer ä¹Ÿå†™å…¥äº†æ—¥å¿—ã€‚<br>ä½†æ˜¯ï¼ŒçœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„ã€‚â€<br><br>è¿™éƒ¨åˆ†å†…å®¹æœ‰é—®é¢˜ï¼Œredoå¹¶ä¸æ˜¯commitæ—¶æ‰è½ç›˜ã€‚redo log bufferçš„ä½œç”¨æ›´å¤šæ˜¯ä¸ºäº†å¹¶å‘","like_count":0},{"had_liked":false,"id":296080,"user_name":"Sie Huai Gan","can_delete":false,"product_type":"c1","uid":1476433,"ip_address":"","ucode":"502BC3E07DA001","user_header":"https://static001.geekbang.org/account/avatar/00/16/87/51/a48f69e7.jpg","comment_is_top":false,"comment_ctime":1622734844,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1622734844","product_id":100020801,"comment_content":"ä¸è€å¸ˆï¼Œæƒ³è¯·é—®ä¸€ä¸‹ï¼Œå¦‚æœredolog åœ¨commit é˜¶æ®µå¤±è´¥çš„è¯ï¼Œè¿™ä¸ªäº‹åŠ¡ä¼šè¢«å›æ»šå—ï¼Ÿbinlog è¿˜å¯ä»¥å›æ»šå—ï¼Ÿ<br><br>å‡è®¾å¯ä»¥å›æ»šçš„è¯ï¼Œå¦‚ä½•ç¡®ä¿å›æ»šå‰çš„binlogè®°å½•ä¸ä¼šè¢«å¤åˆ¶åˆ°äº†å¤‡åº“å‘¢ï¼Ÿ<br><br>è°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":292947,"user_name":"å¤§è‰åŸ","can_delete":false,"product_type":"c1","uid":1301925,"ip_address":"","ucode":"F2FB4DD3E58694","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/a5/308c23cb.jpg","comment_is_top":false,"comment_ctime":1621089994,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621089994","product_id":100020801,"comment_content":"è¿½é—® 6ï¼šé‚£èƒ½ä¸èƒ½åè¿‡æ¥ï¼Œåªç”¨ redo logï¼Œä¸è¦ binlogï¼Ÿ<br>å¦‚æœredo logä¸æ˜¯å¾ªç¯å†™ï¼Œè€Œæ˜¯åƒbinlogä¸€æ ·é¡ºåºå†™ï¼Œæ‹¥æœ‰å½’æ¡£ä½œç”¨ã€‚ä¸»ä»å¤åˆ¶åŸºäºredo logæ¥å®ç°ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æ·˜æ±°binlogã€‚","like_count":0},{"had_liked":false,"id":291919,"user_name":"creasylai19","can_delete":false,"product_type":"c1","uid":1128420,"ip_address":"","ucode":"F9B04060FCFD3F","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/e4/5d7a32c6.jpg","comment_is_top":false,"comment_ctime":1620607602,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1620607602","product_id":100020801,"comment_content":"æ’å…¥æœ‹å‹å…³ç³»ä¹Ÿå¯ä»¥é€šè¿‡ä¸¤ä¸ªé”æ¥å®ç°ï¼Œå…ˆæ‹¿useridå°çš„é”ï¼Œå†æ‹¿useridå¤§çš„é”ï¼Œæˆ–è€…åè¿‡æ¥","like_count":0},{"had_liked":false,"id":291577,"user_name":"åˆæ™¨","can_delete":false,"product_type":"c1","uid":2557602,"ip_address":"","ucode":"7945DA6C62C741","user_header":"https://static001.geekbang.org/account/avatar/00/27/06/a2/c306c734.jpg","comment_is_top":false,"comment_ctime":1620373126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620373126","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸ªé—®é¢˜ ï¼Œmysql error logç»å¸¸æœ‰ Got an error reading communication packetsï¼Œè¿™ä¸ªå¯ä»¥æ€ä¹ˆå¤„ç† è°¢è°¢ã€‚","like_count":0},{"had_liked":false,"id":290328,"user_name":"æ–°æ‰‹","can_delete":false,"product_type":"c1","uid":1322121,"ip_address":"","ucode":"1C8007C09B8A5E","user_header":"https://static001.geekbang.org/account/avatar/00/14/2c/89/f64f3919.jpg","comment_is_top":false,"comment_ctime":1619501794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619501794","product_id":100020801,"comment_content":"è€å¸ˆå¥½,æœ‰å‡ ä¸ªé—®é¢˜æ²¡ç†è§£<br>1ã€ä½¿ç”¨on duplicate å¥½åƒæ˜¯é”è¡¨äº†å‘€... æˆ‘åœ¨è‡ªå·±æµ‹è¯•çš„æ—¶å€™ å¼€å¯äº†3ä¸ªäº‹åŠ¡ï¼Œinsert (C,D) ä¹Ÿæ˜¯ä¼šé”ä½çš„. æ‰€ä»¥è¿™ä¸€å—ä¸æ˜ç™½ä¸ºä»€ä¹ˆä½¿ç”¨è¿™ä¸ª...æ˜¯æƒ³è¦ä¸€è¡Œä¸€è¡Œæ¥æ‰§è¡Œå—?<br>2ã€æ­£å¸¸insert çš„è¯ ä¼šå‡ºç°3çš„æƒ…å†µå—,æˆ‘è¯•äº†ä¸€ä¸‹ ä¹Ÿä¸ä¼šå‡ºç°å•Š....<br>æƒ³äº†å¥½ä¹…ä¹Ÿæ²¡æ˜ç™½.. ä¸¾ä¾‹å®Œç»“å·²ç»å¾ˆä¹…äº†..ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰æœºä¼šè¹²åˆ°è€å¸ˆ..","like_count":0},{"had_liked":false,"id":286967,"user_name":"Geek_55e386","can_delete":false,"product_type":"c1","uid":1795793,"ip_address":"","ucode":"5A727F1323C2D0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/zxkns28cIAUZIt3WjDb8G26qiccT84d9GMr9ZpbYR60TU1ibqSj9NoYVHlJvGF1kOltkqNDmEfJCqPuYVkue3WHg/132","comment_is_top":false,"comment_ctime":1617708650,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617708650","product_id":100020801,"comment_content":"ç»“åˆè€å¸ˆçš„æ–‡ç« ,å’Œé˜¿é‡Œçš„polardb.æ‰æ˜ç™½ä¸ºå•¥,é˜¿é‡Œå¯ä»¥é€‰æ‹©å¿«ç…§+redologå®Œæˆå¿«é€Ÿå¤‡ä»½äº†,åŸæ¥binlogå¹¶ä¸æ˜¯å¿…é¡»çš„,","like_count":0},{"had_liked":false,"id":283740,"user_name":"ä¾é€å¾€æ˜”","can_delete":false,"product_type":"c1","uid":1336581,"ip_address":"","ucode":"5C62D22DD939D2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJM1M1iboffpY17I2eSJjlcyC4ibCJrNeB1EDMjticKospDeTOvZHdheib1tiadEicxGfyInzvJSn7PPqpA/132","comment_is_top":false,"comment_ctime":1615900318,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615900318","product_id":100020801,"comment_content":"ä¸šåŠ¡æ¶‰åŠé‚£ä¸ªä¾‹å­ï¼Œæ•°æ®ä¸å­˜åœ¨ï¼Œè¡Œé”æ— æ³•ç”Ÿæ•ˆï¼Œè¿™ä¸ªæ›´å‡†ç¡®è¯´ï¼Œåº”è¯¥æ˜¯read-committedéš”ç¦»çº§åˆ«ä¸‹ï¼Œåœ¨å¯é‡å¤è¯»çº§åˆ«ä¸‹ï¼Œæ˜¯å­˜åœ¨é—´éš™é”çš„ï¼ŒselectåŠ ä¸Šfor updateæ˜¯å¯ä»¥é”ä½çš„ï¼Œä¸Šè¿°ä¾‹å­ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªäº‹åŠ¡ä¼šæ­»é”å›æ»šï¼Œç„¶ååŠ ä¸Šé‡è¯•é€»è¾‘ï¼Œ,è¿™æ ·åœ¨ä¸šåŠ¡ä¸ä¿®æ”¹è¡¨ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å®ç°ä¸Šè¿°ç›®çš„ï¼Œå€Ÿæ–‡ä¸­è¡¨ç»“æ„å®éªŒå¦‚ä¸‹(éƒ½æ˜¯ç©ºè¡¨,æ ¼å¼ä¸å¥½è°ƒæ•´ï¼Œå‹‰å¼ºçœ‹ä¸‹)ï¼š<br>-----------------------------------------<br>session A                                                                               |  session B<br>set tx_isolation = &quot;repeatable-read&quot;;                                       |  set tx_isolation = &quot;repeatable-read&quot;;<br>begin;                                                                                    |  begin;<br>select * from `like` where user_id = 1 and liker_id = 2 for update;|<br>                                                                                              |  select * from `like` where user_id = 2 and liker_id = 1 for update;<br>                                                                                              |  insert into `like` (user_id, liker_id) values(1,2);<br>insert into `like` (user_id, liker_id) values(2,1);<br>  ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction|    Query OK, 1 row affected(æäº¤æˆåŠŸ)  <br>                                                                                             | commit;","like_count":0},{"had_liked":false,"id":283594,"user_name":"Hony","can_delete":false,"product_type":"c1","uid":1061082,"ip_address":"","ucode":"898C8C345A340D","user_header":"https://static001.geekbang.org/account/avatar/00/10/30/da/8ec33b04.jpg","comment_is_top":false,"comment_ctime":1615850355,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1615850355","product_id":100020801,"comment_content":"åªæœ‰prepareæ²¡æœ‰commitçš„redo logï¼Œå°±æ‹¿XIDå»binlogæ‰¾å¯¹åº”çš„äº‹åŠ¡ã€‚é‚£å¦‚æœæ˜¯biglogæ˜¯statementæ ¼å¼ä¸‹çš„æƒ…å†µï¼Œæ²¡æœ‰XIDæ€ä¹ˆå…³è”ï¼Ÿ","like_count":0},{"had_liked":false,"id":281440,"user_name":"æ°sir","can_delete":false,"product_type":"c1","uid":1098505,"ip_address":"","ucode":"80BB56B3BFB71A","user_header":"https://static001.geekbang.org/account/avatar/00/10/c3/09/dc368335.jpg","comment_is_top":false,"comment_ctime":1614751356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614751356","product_id":100020801,"comment_content":"å…³äºredo log bufferçš„é—®é¢˜æˆ‘æ€»ç»“ä¸‹æˆ‘çš„çœ‹æ³•ï¼ˆå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ï¼‰ï¼š<br>1ï¼Œmysql æœ¬åœ°äº‹åŠ¡ï¼šbegin&#47;commit åŒ…èµ·æ¥sqlè¯­å¥ï¼Œæ‰§è¡Œç»“æœæ…¢ACIDå±æ€§ã€‚<br>2ï¼Œä¸¤é˜¶æ®µæäº¤ï¼šmysqlæœ¬åœ°äº‹åŠ¡æ›´æ–°æ•°æ®é™¤äº†è¦åœ¨æœ¬åœ°æŒä¹…åŒ–ï¼Œè¿˜åœ¨é€šè¿‡binlogåŒæ­¥åˆ°å…¶ä»–å®ä¾‹ï¼Œè¦ä¿è¯æœ¬åœ°æ•°æ®å’Œå…¶ä»–å®ä¾‹æ•°æ®çš„ä¸€è‡´å°±æ˜¯ä¿è¯redo logå’Œbinlogä¸€è‡´ï¼Œè¿™ä¸ªä¸€è‡´å°±æ˜¯é€šè¿‡ä¸¤é˜¶æ®µæäº¤æ¥ä¿è¯ã€‚è€Œæœ¬åœ°äº‹åŠ¡çš„æŒä¹…åŒ–å°±æ˜¯åœ¨æœ¬åœ°äº‹åŠ¡commitæ—¶è§¦å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤é˜¶æ®µæäº¤æ˜¯åœ¨æœ¬åœ°äº‹åŠ¡commitæ—¶è§¦å‘çš„ã€‚<br><br>å›¾ 1 ä¸¤é˜¶æ®µæäº¤ç¤ºæ„å›¾ï¼Œè¿™ä¸ªå›¾é‡ŒçœŸæ­£çš„ä¸¤é˜¶æ®µæäº¤å…¶å®åªæœ‰æœ€å3æ­¥ï¼š<br>prepareé˜¶æ®µï¼ˆç¬¬ä¸€é˜¶æ®µï¼‰ï¼š(1) å†™å…¥relologï¼Œå¤„äºprepareé˜¶æ®µ, (2)å†™å…¥binlogã€‚<br>commit(ä¹Ÿå°±æ˜¯ç¬¬äºŒé˜¶æ®µ)ï¼šæäº¤äº‹åŠ¡å¤„äºcommité˜¶æ®µã€‚ï¼ˆè¿™äº†çš„æäº¤äº‹åŠ¡å¯èƒ½å®¹æ˜“å¼•èµ·è¯¯è§£ï¼Œæœ¬åœ°äº‹åŠ¡æäº¤åå°±è¿›å…¥äº†ä¸¤é˜¶æ®µæäº¤çš„ç¬¬ä¸€é˜¶æ®µï¼‰<br><br>è¿™é‡Œè™½ç„¶å«ä¸¤é˜¶æ®µæäº¤ï¼Œå…¶å®æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯åœ¨æœ¬åœ°äº‹åŠ¡çš„commité˜¶æ®µå®Œæˆçš„ã€‚<br><br>3ï¼Œredo log bufferï¼šå›¾ 1ç”»çš„æ˜¯ä¸€ä¸ªäº‹åŠ¡é‡Œåªæœ‰ä¸€æ¡updateè¯­å¥ï¼Œå¦‚æœæƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªäº‹åŠ¡é‡Œæœ‰å¤šä¸ªupdateè¯­å¥ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œæ¯æ¡updateè¯­å¥åœ¨å†…å­˜é‡Œå®Œæˆæ•°æ®æ›´æ–°åéƒ½éœ€è¦è®°å½•redo logï¼Œæ­¤æ—¶æ•°æ®è¿˜æ²¡æœ‰æäº¤ï¼Œredo logåªèƒ½ç¼“å­˜åœ¨å†…å­˜é‡Œï¼Œä¹Ÿå°±æ˜¯redo log buffer,ç­‰åˆ°æœ¬åœ°äº‹åŠ¡æäº¤,è§¦å‘ä¸¤é˜¶æ®µæäº¤æ—¶ï¼ŒæŠŠredo log bufferé‡Œçš„æ•°æ®å†™å…¥redo log fileã€‚","like_count":0},{"had_liked":false,"id":279600,"user_name":"sotondolphin","can_delete":false,"product_type":"c1","uid":1307088,"ip_address":"","ucode":"42198CE9B201FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QZBHia4nXtspEaRibpmMIMVcDA2HHkNypfvVJ2IllQC3FeFCt7f9iaHW7z5yQ4lcB79ibJwia6tNtpuFroufntMhc2g/132","comment_is_top":false,"comment_ctime":1613842554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613842554","product_id":100020801,"comment_content":"å¯¹äºä¸šåŠ¡æ¶‰åŠçš„é‚£ä¸ªåœºæ™¯ï¼Œç”¨ä¸€å¼ è¡¨å°±å¯ä»¥è§£å†³é—®é¢˜ï¼Œä¸éœ€è¦åˆ†å¼€liker &#47; friends. å¦‚æœA å–œæ¬¢Bï¼Œå°±åœ¨friends è¡¨é‡Œæ’å…¥ä¸€æ¡æ•°æ®ï¼Œå¦‚æœBå–œæ¬¢Aï¼Œä¹Ÿæ’å…¥ä¸€æ¡æ•°æ®ã€‚åœ¨æ¯æ¬¡æ’å…¥æˆåŠŸåï¼Œä¸ç®¡æ˜¯Aè¿˜æ˜¯Bï¼Œéƒ½åšä¸€ä¸ªæµ‹è¯•. æ¯”å¦‚Aå…³æ³¨äº†Bï¼Œåœ¨æ’å…¥ä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ select count(*) from t_friends where user=B and liker = A, å¦‚æœç»“æœæ˜¯0å°±ä¸ä¼šæ˜¾ç¤ºäº’ç›¸å…³æ³¨ã€‚<br>è¿™ä¸ªäº’ç›¸å…³æ³¨çš„çŠ¶æ€ä¸éœ€è¦å³æ—¶çš„æ›´æ–°ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªäººä¸éœ€è¦å¾ˆåŠæ—¶çš„çŸ¥é“å¯¹æ–¹å…³æ³¨äº†è‡ªå·±ã€‚æ‰€ä»¥å°±ç®—A,B åœ¨æŸ¥è¯¢æ—¶å› ä¸ºæŸäº›åŸå› éƒ½è¿”å›äº†0ï¼Œ åœ¨ä¸‹æ¬¡ç™»å½•çš„æ—¶å€™ç³»ç»Ÿéƒ½ä¼šåšä¸€æ¬¡åˆ·æ–°ï¼Œä¹Ÿä¼šæ˜¾ç¤ºå‡ºæ­£ç¡®çš„äº’è§‚çŠ¶æ€ã€‚","like_count":0},{"had_liked":false,"id":278066,"user_name":"Geek2014","can_delete":false,"product_type":"c1","uid":2028957,"ip_address":"","ucode":"9EB356D8DF287E","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f5/9d/104bb8ea.jpg","comment_is_top":false,"comment_ctime":1612749734,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612749734","product_id":100020801,"comment_content":"on duplicate key update ä¼šé€ æˆæ­»é”çš„å§","like_count":0},{"had_liked":false,"id":274008,"user_name":"æ±‰æ±Ÿ","can_delete":false,"product_type":"c1","uid":1788647,"ip_address":"","ucode":"01622D984B8F9B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/4a/e7/6c16af5d.jpg","comment_is_top":false,"comment_ctime":1610786677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610786677","product_id":100020801,"comment_content":"è€å¸ˆ è¯·æ•™å‡ ä¸ªé—®é¢˜ï¼š<br>1.æˆ‘ç†è§£çš„åœ¨begin&#47;commit çš„commitä¹‹å‰éƒ½ä¸æ˜¯å±äºäºŒé˜¶æ®µæäº¤çš„èŒƒå›´<br>2.é‚£å‡è®¾åœ¨begin ä¹‹åï¼Œcommit ä¹‹å‰åšäº†å¾ˆå¤š update ,deleteçš„æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™å†…å­˜é‡Œé¢çš„æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œç”Ÿæˆäº†è„é¡µï¼Œåˆšå¥½åˆšæ‰è¯¥åŠ¨çš„è¿™äº›å†…å­˜é‡Œé¢çš„è„é¡µåˆ·åˆ°äº†ç£ç›˜ï¼Œæ­¤æ—¶è¿™äº›æ“ä½œçš„æ—¥å¿—è¿˜åœ¨redologbuffer é‡Œé¢ è¿˜æ²¡æœ‰è½ç›˜ï¼Œåˆšå¥½ç³»ç»Ÿå´©æºƒé‡å¯ï¼Œé‚£å²‚ä¸æ˜¯è¿™ä¸ªçœ‹èµ·æ¥æœªæäº¤çš„äº‹åŠ¡æäº¤äº†","like_count":0},{"had_liked":false,"id":270167,"user_name":"mofee888","can_delete":false,"product_type":"c1","uid":2249670,"ip_address":"","ucode":"F1FB6F68DCF802","user_header":"","comment_is_top":false,"comment_ctime":1608965063,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608965063","product_id":100020801,"comment_content":"å¯¹äºè¿™ä¸ªä¸šåŠ¡çš„è®¾è®¡ï¼Œæ”¹å˜äº†è¡¨çš„ç»“æ„ï¼Œä¹Ÿè®¸ä¼šç»™ä¸è¿™ä¸ªè¡¨ç›¸å…³çš„å…¶ä»–ä¸šåŠ¡é€»è¾‘å¸¦æ¥ä¸å°çš„éº»çƒ¦ã€‚<br>æ‰€ä»¥å¯¹äºè¿™ç§å®æ—¶è¦æ±‚ä¸é«˜çš„å˜åŒ–ï¼Œéƒ½å¯ä»¥è½¬ä¸ºåå° task é—´éš” N åˆ†é’Ÿæ‰¾å‡ºç›¸å…³æ•°æ®è¿›è¡Œè¡¥æ•‘ï¼Œä»¥æ­¤ç®€åŒ–è¡¨ç»“æ„ï¼Œä¸šåŠ¡é€»è¾‘ã€‚","like_count":0},{"had_liked":false,"id":269593,"user_name":"David.cui","can_delete":false,"product_type":"c1","uid":1302228,"ip_address":"","ucode":"AB46F310403612","user_header":"https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg","comment_is_top":false,"comment_ctime":1608708921,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608708921","product_id":100020801,"comment_content":"å‚è€ƒå…¶ä»–æ•°æ®åº“ï¼Œmysqlåº”è¯¥å¯ä»¥è‡ªåŠ¨å¤‡ä»½redo logï¼Œå½“ä¸€ä¸ªå†™æ»¡ä¹‹åï¼Œè‡ªåŠ¨å½’æ¡£ï¼ŒåŒæ—¶ä¸šåŠ¡ç»§ç»­å†™å…¥ä¸‹ä¸€ä¸ªredo log fileï¼Œåœ¨æ¢å¤çš„æ—¶å€™å°±å¯ä»¥æŠ›å¼ƒbinlogã€‚ä½†æ˜¯mysqlå¥½åƒåšä¸äº†è¿™ä¸ªï¼Œå°±åªèƒ½æ˜¯redo log + binlogä¸€èµ·æ¥å®Œæˆè¿™ä¸ªäº‹æƒ…ã€‚<br>å¦å¤–binlogå…¶å®æ›´åƒå…¶ä»–æ•°æ®åº“çš„CDCæˆ–logminerçš„ï¼Œç”¨äºæ•°æ®å¤åˆ¶ä¹‹ç”¨ã€‚<br>åœ¨å•†ä¸šæ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“çš„å¤åˆ¶æŠ€æœ¯ï¼Œæ›´å¤šçš„æ˜¯åˆ©ç”¨redo logæ¥å»å®ç°ï¼Œè€Œå¾ˆå°‘é€šè¿‡ç±»ä¼¼binlogè¿™æ ·çš„æŠ€æœ¯å»å®ç°ã€‚","like_count":0},{"had_liked":false,"id":267057,"user_name":"å­¦å¥½ä¹ ï¼Œåšå¥½äºº","can_delete":false,"product_type":"c1","uid":1205294,"ip_address":"","ucode":"C991643DB458E2","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/2e/e70a317a.jpg","comment_is_top":false,"comment_ctime":1607584443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607584443","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œä»redo buffer å†™åˆ°redo logæ˜¯åœ¨å›¾1çš„æ—¶åˆ»Aè¿˜æ˜¯æ—¶åˆ»Bæ‰§è¡Œçš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":265199,"user_name":"æ¨ç£Š","can_delete":false,"product_type":"c1","uid":2130485,"ip_address":"","ucode":"8C06C02568E41D","user_header":"https://static001.geekbang.org/account/avatar/00/20/82/35/602e8bfc.jpg","comment_is_top":false,"comment_ctime":1606812103,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606812103","product_id":100020801,"comment_content":"è¿½é—®9é‡Œé¢ä¸ºä»€ä¹ˆè¯´åœ¨commitçš„æ—¶å€™æ‰ä¼šå†™å…¥redologï¼Ÿå›¾1ä¸¤æ®µå¼æäº¤ç¤ºæ„å›¾ä¸æ˜¯å†™å…¥å†…å­˜åå°±å¼€å§‹å†™å…¥redologäº†å—ï¼Ÿç„¶åå†commitçš„å•Š","like_count":0},{"had_liked":false,"id":265176,"user_name":"å¼ çˆ½","can_delete":false,"product_type":"c1","uid":1021129,"ip_address":"","ucode":"ED2969DA26E8E0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/94/c9/374a69f2.jpg","comment_is_top":false,"comment_ctime":1606805518,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606805518","product_id":100020801,"comment_content":"å¦‚æœredo log &amp; binlogæ˜¯åŒ1çš„é…ç½®ï¼Œredo log preapreé˜¶æ®µåˆ°åº•æ˜¯åœ¨ç£ç›˜ä¸Šè¿˜æ˜¯åœ¨redo log bufferé‡Œï¼Œè¿½é—® 9é‡Œè¯´çš„æ˜¯åœ¨redo log bufferï¼Œè€Œå›¾1çš„æ¡ˆä¾‹åˆè¯´æ˜¯åœ¨ç£ç›˜ä¸Šã€‚è¿˜æ˜¯è¯´å½“äº‹åŠ¡commitçš„æ—¶å€™ï¼Œå…ˆå†™redo logåˆ°ç£ç›˜æ˜¯prepareçŠ¶æ€ï¼Œç„¶åå†™binlog,æœ€åæäº¤ç£ç›˜ä¸Šçš„redo logä¸ºcommitçŠ¶æ€ï¼Œè¿˜è¯·è€å¸ˆè§£ç­”ã€‚","like_count":0},{"had_liked":false,"id":263840,"user_name":"é™ˆæ˜","can_delete":false,"product_type":"c1","uid":2183012,"ip_address":"","ucode":"10B28F6F8EEF86","user_header":"https://static001.geekbang.org/account/avatar/00/21/4f/64/93500a26.jpg","comment_is_top":false,"comment_ctime":1606277917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606277917","product_id":100020801,"comment_content":"MySQLè¡¨ä¸­æœ‰articleã€tagã€tag_in_articleä¸‰å¼ è¡¨ï¼Œæ–°å¢æ–‡ç« æ¥å£ï¼Œä¼šåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿›è¡Œï¼Œå…ˆå°†æ–‡ç« æ’å…¥æ•°æ®åº“ï¼Œå†å°†tagä¸articleå»ºç«‹å…³è”å…³ç³»æ—¶ï¼Œtag_in_articleæ’å…¥æ•°æ®ä¼šé¢‘ç¹æŠ¥Error 1062: Duplicate entry &#39;24-78&#39; for key &#39;tau_index&#39;&quot;ï¼Œtau_indexä¸ºtag_idä¸article_idåœ¨tag_in_articleè¡¨ä¸­çš„å”¯ä¸€ç´¢å¼•ã€‚<br>è¯·é—®è¿™ä¸ªé—®é¢˜æ˜¯ä»€ä¹ˆé€ æˆçš„ï¼Ÿä»£ç é€»è¾‘å±‚ä¸­ä¸å­˜åœ¨é‡è¯•é€»è¾‘ï¼›","like_count":0},{"had_liked":false,"id":263409,"user_name":"LPF","can_delete":false,"product_type":"c1","uid":2287841,"ip_address":"","ucode":"036C552D7251E9","user_header":"https://static001.geekbang.org/account/avatar/00/22/e8/e1/6045b299.jpg","comment_is_top":false,"comment_ctime":1606126872,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606126872","product_id":100020801,"comment_content":"MySQL æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰åœ¨commitæ—¶å¦‚ä½•å°†log bufferä¸­çš„æ—¥å¿—åˆ·log fileä¸­ã€‚è¿™ç§æ§åˆ¶é€šè¿‡å˜é‡innodb_flush_log_at_trx_commitçš„å€¼æ¥å†³å®šã€‚è¯¥å˜é‡æœ‰ 3 ç§å€¼ï¼š0ã€1ã€2ï¼Œé»˜è®¤ä¸º 1ã€‚ä½†æ³¨æ„ï¼Œè¿™ä¸ªå˜é‡åªæ˜¯æ§åˆ¶commitåŠ¨ä½œæ˜¯å¦åˆ·æ–°log bufferåˆ°ç£ç›˜ã€‚<br><br>å½“è®¾ç½®ä¸º 1 çš„æ—¶å€™ï¼Œäº‹åŠ¡æ¯æ¬¡æäº¤éƒ½ä¼šå°†log bufferä¸­çš„æ—¥å¿—å†™å…¥os bufferå¹¶è°ƒç”¨fsync()åˆ·åˆ°log file on diskä¸­ã€‚è¿™ç§æ–¹å¼å³ä½¿ç³»ç»Ÿå´©æºƒä¹Ÿä¸ä¼šä¸¢å¤±ä»»ä½•æ•°æ®ï¼Œä½†æ˜¯å› ä¸ºæ¯æ¬¡æäº¤éƒ½å†™å…¥ç£ç›˜ï¼ŒIO çš„æ€§èƒ½è¾ƒå·®ã€‚<br>å½“è®¾ç½®ä¸º 0 çš„æ—¶å€™ï¼Œäº‹åŠ¡æäº¤æ—¶ä¸ä¼šå°†log bufferä¸­æ—¥å¿—å†™å…¥åˆ°os bufferï¼Œè€Œæ˜¯æ¯ç§’å†™å…¥os bufferå¹¶è°ƒç”¨fsync()å†™å…¥åˆ°log file on diskä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´è®¾ç½®ä¸º 0 æ—¶æ˜¯æ¯ç§’åˆ·æ–°å†™å…¥åˆ°ç£ç›˜ä¸­çš„ï¼Œå½“ç³»ç»Ÿå´©æºƒï¼Œä¼šä¸¢å¤± 1 ç§’é’Ÿçš„æ•°æ®ã€‚<br>å½“è®¾ç½®ä¸º 2 çš„æ—¶å€™ï¼Œæ¯æ¬¡æäº¤éƒ½ä»…å†™å…¥åˆ°os bufferï¼Œç„¶åæ˜¯æ¯ç§’è°ƒç”¨fsync()å°†os bufferä¸­çš„æ—¥å¿—å†™å…¥åˆ°log file on diskã€‚<br>æ‰€ä»¥å³ä½¿binlogå®Œæ•´ï¼Œåªè¦æ²¡æœ‰commitï¼ŒMySQLå¼‚å¸¸é‡å¯ï¼Œredo log bufferéƒ½æ˜¯ä¸ä¼šå†™å…¥redologï¼Œé‚£redo log bufferå°±ä¼šæ¸…ç©ºï¼Œé‚£ä¹ˆredo logå¤„äºprepareå¹¶ä¸”binlogå®Œæ•´å°±ä¸å›æ»šè¿™ç§æƒ…å†µä¸å°±ä¸å­˜åœ¨äº†ï¼å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":260578,"user_name":"éœåå¾·æ–¯å¡”å…‹","can_delete":false,"product_type":"c1","uid":1072223,"ip_address":"","ucode":"4C947E5EA10F6A","user_header":"https://static001.geekbang.org/account/avatar/00/10/5c/5f/75284920.jpg","comment_is_top":false,"comment_ctime":1605064275,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1605064275","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘ä»¬çš„é¡¹ç›®æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬çš„äº§å“æ˜¯äº¤ä»˜ç»™å®¢æˆ·ï¼Œéƒ¨ç½²åœ¨å®¢æˆ·å„ä¸ªå•ä½çš„ã€‚è¿™äº›å•ä½ç»å¸¸é­é‡æ–­ç”µçš„é—®é¢˜ï¼Œä¸€æ—¦æ–­ç”µï¼ŒInnoDBæ•°æ®åº“æ–‡ä»¶ç»å¸¸ä¼šæŸåï¼Œæ•°æ®åº“å°±èµ·ä¸æ¥äº†ï¼Œéœ€è¦æ‰‹åŠ¨è¿ç»´æ¢å¤ï¼ˆè¿˜æœ‰ä¸€å®šæ¦‚ç‡æ¢å¤ä¸äº†ï¼‰ã€‚æŒ‰é“ç†è¯´ï¼ŒåŸºäºbinlogå’Œredo logåº”è¯¥å…·å¤‡å´©æºƒè‡ªåŠ¨æ¢å¤çš„èƒ½åŠ›ã€‚è¯·é—®è€å¸ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œæˆ–æ˜¯ä¸€äº›é…ç½®é¡¹ï¼Œèƒ½å¤Ÿæ–­ç”µåæ•°æ®åº“è‡ªåŠ¨æ¢å¤æ­£å¸¸å‘¢ï¼Ÿç›®å‰å¤„äºæˆæœ¬è€ƒè™‘ï¼Œå®¢æˆ·ä¸€èˆ¬ä¸æ„¿æ„é…ç½®UPSã€‚","like_count":0},{"had_liked":false,"id":260294,"user_name":"x-rayîŒº","can_delete":false,"product_type":"c1","uid":1140175,"ip_address":"","ucode":"8363F0C4D0AC0B","user_header":"https://static001.geekbang.org/account/avatar/00/11/65/cf/326c0eea.jpg","comment_is_top":false,"comment_ctime":1604978209,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604978209","product_id":100020801,"comment_content":"æ€»ç»“ä¸‹ç›®å‰ä¸ªäººçœ‹åˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼š<br>1.å†…å­˜è„é¡µåˆ·ç›˜åï¼ŒMySQLå¦‚ä½•å¤„ç†redo logä¸­è¢«åˆ·ç›˜çš„æ•°æ®ï¼Ÿ<br>ç­”ï¼šæ ¹æ®è€å¸ˆçš„å›ç­”ï¼Œæ˜¯ä¸å¤„ç†ï¼Œåªä¸è¿‡ä¸‹æ¬¡redo log å†™æ»¡äº†ï¼Œæ“¦é™¤æ—¶å‘ç”Ÿçš„åˆ·ç›˜ï¼Œä¼šå¯¹æ“¦é™¤çš„æ•°æ®è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸ºè„é¡µï¼Œæ˜¯è„é¡µå°±åˆ·ï¼Œæ˜¯å¹²å‡€é¡µå°±è·³è¿‡ã€‚<br><br>2.redo logä¸­æ¶‰åŠchange bufferçš„å†…å®¹ï¼Œå¦‚æœå‘ç”Ÿåˆ·ç›˜ï¼Œä¼šäº§ç”Ÿmergeè¡Œä¸ºå—ï¼Ÿ<br>ç­”ï¼šæ ¹æ®è€å¸ˆçš„å›ç­”ï¼Œä¸ä¼šã€‚æ— è®ºæ˜¯å†…å­˜ä¸è¶³å‘ç”Ÿçš„åˆ·ç›˜ï¼Œè¿˜æ˜¯redo logå†™æ»¡æ—¶å‘ç”Ÿçš„åˆ·ç›˜ï¼Œå¦‚æœæ¶‰åŠchange bufferï¼Œå°±æŠŠchange bufferå½“åšæ™®é€šçš„æ•°æ®åˆ·åˆ°ç£ç›˜ä¸Šã€‚å‰é¢æåˆ°è¿‡ï¼Œè¿™å°±æ˜¯change bufferçš„æŒä¹…åŒ–ã€‚è€Œmergeçš„è¡Œä¸ºå§‹ç»ˆå‘ç”Ÿåœ¨readæ—¶ã€‚","like_count":0},{"had_liked":false,"id":257625,"user_name":"123ä¹‹äºº","can_delete":false,"product_type":"c1","uid":1417637,"ip_address":"","ucode":"49F5CD8C8587BD","user_header":"https://static001.geekbang.org/account/avatar/00/15/a1/a5/8b01ed90.jpg","comment_is_top":false,"comment_ctime":1604045029,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604045029","product_id":100020801,"comment_content":"A&gt;B :<br>insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=3<br>B&gt;A:<br>insert into `like`(user_id, liker_id, relation_ship) values(B, A, 2) on duplicate key update relation_ship=3<br>æ„Ÿè§‰è¿™ä¸¤ä¸ªåœºæ™¯ç¬¬ä¸€å¥DMLä¸­on duplicate key update çš„relation_shipå›ºå®šä¸º3é¡µå¯ä»¥è¯¶<br>","like_count":0},{"had_liked":false,"id":254486,"user_name":"Demter","can_delete":false,"product_type":"c1","uid":1158439,"ip_address":"","ucode":"BE3B6F726916CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/27/5556ae50.jpg","comment_is_top":false,"comment_ctime":1603120201,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603120201","product_id":100020801,"comment_content":"çœ‹äº†ä¸€ç‚¹ï¼Œå°±å­¦åˆ°äº†å¾ˆå¤šï¼Œè°¢è°¢æ—è€å¸ˆï¼","like_count":0},{"had_liked":false,"id":253981,"user_name":"å¬é›¨","can_delete":false,"product_type":"c1","uid":1254493,"ip_address":"","ucode":"252754F9FCFF0C","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","comment_is_top":false,"comment_ctime":1603001234,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603001234","product_id":100020801,"comment_content":"InnoDB å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®é¡µæœ‰æ²¡æœ‰åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°å‘¢","like_count":0},{"had_liked":false,"id":253404,"user_name":"hey","can_delete":false,"product_type":"c1","uid":2054357,"ip_address":"","ucode":"ECD6D0EC04E50B","user_header":"https://static001.geekbang.org/account/avatar/00/1f/58/d5/6688e2a0.jpg","comment_is_top":false,"comment_ctime":1602729138,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602729138","product_id":100020801,"comment_content":"ä¸šåŠ¡è®¾è®¡ä¸¾çš„é‚£ä¸ªä¾‹å­ï¼Œå…ˆæŠŠå…³æ³¨è®°å½•æ’å¥½ï¼Œæäº¤ï¼Œç„¶åå†æŸ¥å¯¹é¢æœ‰æ²¡æœ‰å…³æ³¨è‡ªå·±æ€ä¹ˆæ ·ï¼Ÿ","like_count":0},{"had_liked":false,"id":252156,"user_name":"Fighter","can_delete":false,"product_type":"c1","uid":1282641,"ip_address":"","ucode":"B1925EE400372D","user_header":"https://static001.geekbang.org/account/avatar/00/13/92/51/0505254d.jpg","comment_is_top":false,"comment_ctime":1602150327,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1602150327","product_id":100020801,"comment_content":"redo log bufferé‚£å—æœ‰ç‚¹æ²¡æ˜ç™½ï¼Œcommitçš„æ—¶å€™æ‰å»çœŸæ­£ä¸‹redo-logï¼Œé‚£åœ¨commitå‰crashå²‚ä¸æ˜¯å°±ä¸¢æ•°æ®äº†ï¼Œè¿™ä¸redo logçš„è®¾è®¡åˆè¡·ä¸ä¹…çŸ›ç›¾äº†å—","like_count":0,"discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330640,"discussion_content":"éƒ½æ²¡æœ‰æ‰§è¡Œåˆ°æäº¤ï¼Œä¸¢å¤±æ˜¯æ­£å¸¸çš„å‘€ã€‚å›¾ä¸­è¯´çš„å†™redologçš„éƒ½æ˜¯æ‰§è¡Œåˆ°æäº¤åçš„æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606661017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":246666,"user_name":"Magic","can_delete":false,"product_type":"c1","uid":1272047,"ip_address":"","ucode":"FD9CEDAA419EB0","user_header":"https://static001.geekbang.org/account/avatar/00/13/68/ef/6264ca3d.jpg","comment_is_top":false,"comment_ctime":1599449395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599449395","product_id":100020801,"comment_content":"å®è·µç»“æœè¡¨æ˜mysql innodbé‡‡ç”¨çš„æ–¹å¼2ï¼Œå³è¯»å®Œåä¼šåŠ é”ï¼Œä½†å¹¶ä¸æ›´æ–°ã€‚è¿™æ ·åšçš„ç›®çš„è¿˜æ˜¯ä¸ºäº†ä¿è¯æ›´æ–°çš„ä¸€è‡´æ€§ï¼Œå¦‚æœä¸åŠ é”ï¼Œé‚£ä¹ˆåŒä¸€æ—¶é—´å³å…è®¸å…¶ä»–äº‹åŠ¡æ›´æ–°ï¼Œè¿™è¿èƒŒäº†updateçš„è¯­ä¹‰","like_count":0},{"had_liked":false,"id":243027,"user_name":"æ¸…è’¸ç»“å°¾é±¼","can_delete":false,"product_type":"c1","uid":2012721,"ip_address":"","ucode":"371AA2E17DB89C","user_header":"https://static001.geekbang.org/account/avatar/00/1e/b6/31/c801c289.jpg","comment_is_top":false,"comment_ctime":1597923495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597923495","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ï¼æœ‰ä¸ªé—®é¢˜æƒ³ä¸æ˜ç™½ï¼šæ—¢ç„¶binlogæ²¡æœ‰æ¢å¤æ•°æ®é¡µçš„èƒ½åŠ›ï¼Œæ²¡æœ‰ä¿å­˜æ•°æ®é¡µçš„ç»†èŠ‚ï¼Œåœ¨å¤‡åº“æ€ä¹ˆé‡æ”¾è¿›å»çš„ï¼Ÿè¾›è‹¦è€å¸ˆæ‹¨å†—è§£ç­”ä¸€ä¸‹å“ˆ","like_count":0},{"had_liked":false,"id":242010,"user_name":"Carter","can_delete":false,"product_type":"c1","uid":1030842,"ip_address":"","ucode":"1FD476D8F2BE27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/ba/83de3488.jpg","comment_is_top":false,"comment_ctime":1597560878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597560878","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œbinlogå¯ä»¥ä»å¤´å¼€å§‹æ¢å¤å®Œæ•´æ•°æ®ï¼›ä½†binlogä¸èƒ½ä»å·²è½ç›˜æ•°æ®æ¢å¤åˆ°å®Œæ•´æ•°æ®ï¼Œå› ä¸ºbinlogä¸çŸ¥é“é‚£äº›æ•°æ®å·²ç»è½ç›˜ï¼Œæ•°æ®æŒä¹…åŒ–æ—¶åªéœ€è¦å†™äº†redo logï¼Œä¸ä¸€å®šè½ç›˜ã€‚<br>binlogæ˜¯ä»0æ¢å¤æ•°æ®ï¼ˆå¤‡ä»½æ¢å¤ã€å¤šåº“åŒæ­¥ç­‰ï¼‰ï¼Œç£ç›˜æ•°æ®+redo logå¯ä»¥å¿«é€Ÿæ¢å¤å®Œæ•´æ•°æ®ã€‚","like_count":0},{"had_liked":false,"id":240603,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1207056,"ip_address":"","ucode":"5CEF9A1806298D","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/10/22f93764.jpg","comment_is_top":false,"comment_ctime":1596994820,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1596994820","product_id":100020801,"comment_content":"å…³äºä¸¤é˜¶æ®µæäº¤ï¼Œæœ‰ä¸€ä¸ªç‚¹è¿˜æ˜¯æ²¡æ˜ç™½ï¼Œä¸çŸ¥é“æˆ‘è¿™æ ·ç†è§£å¯¹ä¸å¯¹<br>1.prepareé˜¶æ®µæ—¶ï¼Œredologå®é™…å†™çš„æ˜¯redolog buffer(commitæ—¶æ‰ä¼šåˆ·ç›˜).<br>2.é‚£ä¹ˆå¦‚æœåœ¨binlogå†™æˆåŠŸåï¼Œcommitä¹‹å‰ï¼Œmysql crashäº†ï¼Œæˆ‘ç†è§£è¿™ä¸ªæ—¶å€™redologä¸¢å¤±äº†ï¼Œä½†æ˜¯binlogå·²ç»åŒæ­¥åˆ°å¤‡æœºåšäº†ä¿®æ”¹ã€‚ä¹Ÿå°±æ˜¯ä¼šå‡ºç°binlogä¸redologå¾—ä¸ä¸€è‡´ã€‚<br>å¸Œæœ›è€å¸ˆå’Œå„ä½å¤§ç¥å¸®å¿™è§£æƒ‘ï¼Œæ„Ÿè°¢","like_count":0,"discussions":[{"author":{"id":1450778,"avatar":"https://static001.geekbang.org/account/avatar/00/16/23/1a/db7dd0e5.jpg","nickname":"æ¢§æ¡è¡—ç¯ä¸¶","note":"","ucode":"CC15DDDD933ABF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":320306,"discussion_content":"åº”è¯¥å³ä¾¿æ˜¯ä½¿ç”¨äº†redolog bufferï¼Œåœ¨prepareå’Œcommitä¸¤é˜¶æ®µéƒ½å¿…é¡»æäº¤çš„ã€‚å¦åˆ™åœ¨prepareé˜¶æ®µå¦‚æœæ²¡æäº¤ï¼Œå‘ç”Ÿå®•æœºï¼Œæ–‡ä»¶ä¸­æ˜¯ä¸å¯èƒ½å«æœ‰prepareå­—æ®µçš„ï¼Œä¹‹å‰çš„å´©æºƒæ¢å¤åˆ¤æ–­æ¡ä»¶ä¹Ÿå…¨æ˜¯é”™çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604317227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":238249,"user_name":"jjyyun","can_delete":false,"product_type":"c1","uid":1592576,"ip_address":"","ucode":"8824654F673087","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLIzE6JOuXsOamCWiaq8sHHVyCK44bdIOEqnE42veoZPEqxs5IJ8RT1Hicz0ZlPQFcbEFSwjV7icrfEw/132","comment_is_top":false,"comment_ctime":1596102443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596102443","product_id":100020801,"comment_content":"â€œä½ å¯ä»¥æŠŠ binlog å…³æ‰ï¼Œè¿™æ ·å°±æ²¡æœ‰ä¸¤é˜¶æ®µæäº¤äº†ï¼Œä½†ç³»ç»Ÿä¾ç„¶æ˜¯ crash-safe çš„â€ï¼Œbinlogå…³äº†ï¼Œæ˜¯ä¸æ˜¯redologä¸­åªè®¤commitçš„äº‹åŠ¡ã€‚prepareçš„äº‹åŠ¡è®¤ä¸ºæ˜¯ä¸å®Œæ•´çš„ç›´æ¥å¿½ç•¥ã€‚ä½†æ˜¯åˆä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœbinlogä¹Ÿæ”¯æŒprepareå’Œcommit2ç§çŠ¶æ€ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿèƒ½æ”¯æŒcrash-safeäº†ã€‚redolog å’Œbinlogæ˜¯é€»è¾‘æ—¥å¿—è¿˜æ˜¯ç‰©ç†æ—¥å¿—å’Œcrash-safeæ˜¯ä¸æ˜¯å…³ç³»ä¸å¤§","like_count":0},{"had_liked":false,"id":238124,"user_name":"huanghuahh","can_delete":false,"product_type":"c1","uid":1063466,"ip_address":"","ucode":"2341E187E49D91","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK3AuPXcqmo2fydvJLUpgvWZJsk43gvHVoEialia68oeTyJ7GTK0UkrpMv89j4Tg4pCTCjobA5gq86Q/132","comment_is_top":false,"comment_ctime":1596074540,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596074540","product_id":100020801,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆï¼Œä¹‹å‰è¯´redo logæ˜¯åŸºäºWALï¼Œé¡ºåºå†™åŠ å¿«é€Ÿåº¦ï¼Œä¹‹åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯æµç¨‹é‡Œè¿˜æœ‰ä¸€ä¸ªå†™binlogçš„è¿‡ç¨‹ï¼Œè¯·é—®æ˜¯å†™å®Œredo logåè¯·æ±‚å°±è¿”å›å®¢æˆ·ç«¯ç„¶åå¼‚æ­¥å†™binlogå—ï¼Œä½†è¿™æ ·æ„Ÿè§‰æ— æ³•ä¿è¯å®¢æˆ·ç«¯æ”¶åˆ°çš„ç»“æœæ˜¯å¯¹çš„ï¼Œå› ä¸ºå¯èƒ½å›æ»šã€‚å¦‚æœå†™å®Œbinlogæäº¤åå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ„Ÿè§‰æ€§èƒ½ä¸Šåˆä¸ä¼šå¿«äº†ï¼Œæ‰€ä»¥æƒ³äº†è§£ä¸‹è¿™ä¸ªæµç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„","like_count":0},{"had_liked":false,"id":237532,"user_name":"whyly","can_delete":false,"product_type":"c1","uid":1798882,"ip_address":"","ucode":"D34D6B7164C982","user_header":"https://static001.geekbang.org/account/avatar/00/1b/72/e2/95b0543c.jpg","comment_is_top":false,"comment_ctime":1595856787,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595856787","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä¸Šé¢Aã€Bå…³æ³¨çš„é‚£ä¸ªåœºæ™¯ï¼Œå½“A&lt;Bï¼Œæ¯”å¦‚A=2ï¼ŒB=3ï¼Œé¦–å…ˆAå…³æ³¨Bï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯insert into `like`(user_id, liker_id, relation_ship) values(2, 3, 1) on duplicate key update relation_ship=relation_ship | 1;`like`è¡¨ä¸­user_idï¼Œliker_idå’Œrelation_shipå¯¹åº”çš„æ•°æ®æ˜¯2ï¼Œ3ï¼Œ1ï¼Œç„¶ååœ¨Bå…³æ³¨Aï¼Œæ‰§è¡Œè¯­å¥insert into `like`(user_id, liker_id, relation_ship) values(2, 3, 2) on duplicate key update relation_ship=relation_ship | 1;è¿™æ—¶å€™relation_ship= 1 | 1ï¼Œç»“æœæ˜¯1å•Šï¼Œä¸æ˜¯3ï¼Œä¸Šé¢çš„è¿‡ç¨‹å“ªé‡Œå‡ºäº†é—®é¢˜å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":234739,"user_name":"Garwen","can_delete":false,"product_type":"c1","uid":1045062,"ip_address":"","ucode":"C76346E1734AB8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/46/09c457eb.jpg","comment_is_top":false,"comment_ctime":1594784543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594784543","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¿™ä¸ªæ•°æ®é¡µè½ç›˜çš„é—®é¢˜è®©æˆ‘æ›´ç–‘æƒ‘äº†ï¼Œä¹‹å‰æ–‡ç« è®²è§£çš„ç”±redologæ¥è®°å½•æ›´æ–°ï¼Œä¹‹åæŠ½ç©ºå†å°†æ•°æ®çš„æ›´æ–°å†™å…¥ç£ç›˜ã€‚ç°åœ¨åˆè¯´ä»å†…å­˜æ›´æ–°è„é¡µç›´æ¥å†™å…¥ç£ç›˜æ²¡æœ‰redologä»€ä¹ˆäº‹ã€‚è¿™ä¸¤ä¸ªè¯´æ³•å°±æŠŠæˆ‘æè’™äº†ã€‚å“ªä½èƒ½è®²è§£ä¸€ä¸‹å•Šã€‚","like_count":0},{"had_liked":false,"id":233056,"user_name":"lleft","can_delete":false,"product_type":"c1","uid":1970443,"ip_address":"","ucode":"D573EB509455AE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","comment_is_top":false,"comment_ctime":1594207241,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594207241","product_id":100020801,"comment_content":"redo logåœ¨commitçš„æ—¶å€™ä»redo log bufferå†™å…¥åˆ°ç£ç›˜çš„redo logæ–‡ä»¶ï¼Œbinlogä¹Ÿæ˜¯åœ¨commitçš„æ—¶å€™å†™ï¼Œä¸€æ¬¡commitè¿™ä¸¤ä¸ªæ—¥å¿—åŒæ—¶å†™ï¼Ÿ","like_count":0},{"had_liked":false,"id":233048,"user_name":"Geek_07a5f9","can_delete":false,"product_type":"c1","uid":2058966,"ip_address":"","ucode":"7478945032C139","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKARWSGics4fJG6PNLvZz0Xy0F2UovamAWKAd7YgKaFmPhF2zml13TPWC1ubaLs2GTq2HUDZs5wI7Q/132","comment_is_top":false,"comment_ctime":1594201496,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594201496","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼šå‡è®¾å·²ç»åšäº†ä¸¤ä¸ªäº‹åŠ¡ï¼ŒT1å’ŒT2ï¼ŒT1ä¿®æ”¹äº†æ•°æ®é¡µ1ï¼Œå…ˆç”Ÿå­˜äº†LSN1ï¼Œç„¶åäº‹åŠ¡T2ä¿®æ”¹äº†æ•°æ®é¡µ2ï¼Œç”Ÿæˆäº†LSN2çš„ redologï¼Œ ç„¶åå‘ç”Ÿäº†checkpointï¼Œå‘ç°éœ€è¦æŠŠè„é¡µ2çš„æ•°æ®åˆ·åˆ°ç£ç›˜ï¼Œè¿™æ—¶å€™ç”±äºLSN2æ˜¯å¤§äºLSN1çš„ï¼Œé‚£ä¹ˆLSN1å¯¹åº”çš„è„æ•°æ®é¡µ1ä¹Ÿä¼šè¢«åŠ¨çš„åˆ·æ–°åˆ°ç£ç›˜å˜›","like_count":0},{"had_liked":false,"id":229251,"user_name":"æµ·é¸Ÿ","can_delete":false,"product_type":"c1","uid":1028311,"ip_address":"","ucode":"EBAF85D1EFFAAB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b0/d7/22ce0046.jpg","comment_is_top":false,"comment_ctime":1592931787,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592931787","product_id":100020801,"comment_content":"æœ€åçš„é—®é¢˜ä¸­ï¼Œå¦‚æœæ‰§è¡Œ update è¯­å¥ä¼šè¿”å›æœ€ç»ˆæ•°æ®æ›´æ–°çš„è¡Œæ•°ï¼Œæ¯”å¦‚ï¼š<br>Rows matched: 1  Changed: 0  Warnings: 0<br>è¿™é‡Œç»“åˆå‰é¢çš„çŸ¥è¯†ç‚¹æœ‰ç‚¹ç–‘æƒ‘äº†ï¼Œå‰é¢æåˆ°æ›´æ–°æ•°æ®æ—¶ä¼šä½¿ç”¨ chagne buffer ï¼Œè¿™æ ·å…¶å®æ•°æ®é¡µä¸ç”¨è¯»å–åˆ°å†…å­˜é¡µçš„ï¼Œé‚£ä¹ˆæ€ä¹ˆä¼šå®æ—¶åé¦ˆå®¢æˆ·ç«¯ changed ä¿¡æ¯çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":228383,"user_name":"å¸ƒå°”-æå®¢","can_delete":false,"product_type":"c1","uid":1265214,"ip_address":"","ucode":"FFB20E8632EE24","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKicxChCIAib1Qjo616J02icxDHc0BPFcPu31De1ONvYoXnkicfGJUrsozGBkib1ibbQ5onhhXfbovLlaDg/132","comment_is_top":false,"comment_ctime":1592653403,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592653403","product_id":100020801,"comment_content":"è€å¸ˆé’ˆå¯¹äº’å…³çš„é—®é¢˜çš„å®ç°æ–¹æ¡ˆæ˜¯å¦å¦‚ä¸‹çš„æ“ä½œï¼Œè¿™æ ·çš„è¯ï¼ŒæŸ¥è¯¢æŸäººå…³æ³¨çš„å¥½å‹çš„æ—¶å€™ä¼šæŒºéº»çƒ¦ã€‚<br>çº¦å®šuser_id&lt;liker_id,a&lt;bæ—¶ï¼Œa=10,b=20<br><br>sessionA:<br>insert into `like`(user_id, liker_id, relation_ship) values(10, 20, 1) on duplicate key update relation_ship=relation_ship | 1;<br>select relation_ship from `like` where user_id=10 and liker_id=20;<br>#1<br>commit;<br><br>sessionB:<br>insert into `like`(user_id, liker_id, relation_ship) values(10, 20, 2) on duplicate key update relation_ship=relation_ship | 2;<br>select relation_ship from `like` where user_id=10 and liker_id=20;<br>#3<br>insert ignore into friend(friend_1_id, friend_2_id) values(10,20);<br>commit;<br><br>select * from `like`;<br>+----+---------+----------+---------------+<br>| id | user_id | liker_id | relation_ship |<br>+----+---------+----------+---------------+<br>|  1 |      10 |       20 |             3 |<br>+----+---------+----------+---------------+<br><br>select * from `friend`;<br>+----+-------------+-------------+<br>| id | friend_1_id | friend_2_id |<br>+----+-------------+-------------+<br>|  1 |          10 |          20 |<br>+----+-------------+-------------+","like_count":0},{"had_liked":false,"id":227800,"user_name":"creasylai19","can_delete":false,"product_type":"c1","uid":1128420,"ip_address":"","ucode":"F9B04060FCFD3F","user_header":"https://static001.geekbang.org/account/avatar/00/11/37/e4/5d7a32c6.jpg","comment_is_top":false,"comment_ctime":1592484104,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1592484104","product_id":100020801,"comment_content":"ä¸šåŠ¡è®¾è®¡çš„è¿™ä¸ªé—®é¢˜ï¼Œç›®å‰æ˜¯ä¸‰ç§çŠ¶æ€ï¼Œä½æ“ä½œè®¾è®¡å¾—å¾ˆç²¾å·§ã€‚æä¾›ä¸€ç§æ€è·¯ï¼Œåˆ†ä¸¤ä¸ªäº‹åŠ¡ï¼Œå…ˆæ’å…¥ï¼Œæäº¤äº‹åŠ¡ã€‚ç„¶åå†æŸ¥è¯¢ï¼Œå¦‚æœå­˜åœ¨ç›¸äº’å…³æ³¨ï¼Œå°±insertæœ‹å‹è¡¨ï¼Œè¿™æ ·åº”è¯¥ä¹Ÿå¯ä»¥ã€‚ä¸¤ä¸ªå¹¶å‘çº¿ç¨‹ä¸­æœ€åcommitçš„é‚£ä¸ªæ€»æ˜¯å¯ä»¥æ‹¿åˆ°å…¨éƒ¨æ•°æ®","like_count":0},{"had_liked":false,"id":227739,"user_name":"é±¼","can_delete":false,"product_type":"c1","uid":1487584,"ip_address":"","ucode":"89EC9CE3AD0281","user_header":"https://static001.geekbang.org/account/avatar/00/16/b2/e0/d856f5a4.jpg","comment_is_top":false,"comment_ctime":1592467559,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592467559","product_id":100020801,"comment_content":"ï¼ˆå¼€å§‹å‡†å¤‡éšä¾¿å†™å†™ï¼Œä½†æ˜¯çœ‹è€å¸ˆè¿™ä¹ˆè®¤çœŸå›ç­”å¤§å®¶çš„é—®é¢˜ï¼Œæˆ‘ä¹Ÿç¨å¾®æ€»ç»“ä¸€ä¸‹ï¼‰<br>â€œä¸šåŠ¡è®¾è®¡é—®é¢˜â€ä¸­çš„æˆä¸ºå¥½å‹çš„é—®é¢˜ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ç§éå¸¸å…¸å‹çš„å†™å†²çªé—®é¢˜ï¼šä¸¤ä¸ªå¹¶å‘çš„å†™äº‹ç‰©ï¼Œä¸€ä¸ªäº‹ç‰©çš„å†™ä¿®æ”¹äº†å¦å¤–ä¸€ä¸ªäº‹ç‰©ï¼ˆå¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªæ•°æ®ï¼‰æ‰§è¡Œçš„å…ˆå†³æ¡ä»¶ã€‚<br>åœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯ äº‹ç‰©1ä¸­éœ€è¦åˆ¤æ–­Bæœ‰æ²¡æœ‰å–œæ¬¢Aï¼Œè€Œæ ¹æ®è¿™ä¸ªä¸šåŠ¡ä¸Šçš„çº¦æŸå»å†³å®šæ¥ä¸‹æ¥çš„æ“ä½œï¼Œè€Œäº‹ç‰©2å´ä¿®æ”¹äº†è¿™ä¸ªå‰ææ¡ä»¶ã€‚<br>é€šå¸¸è§£å†³è¿™ç±»éš”ç¦»è¦æ±‚æ›´é«˜çš„é—®é¢˜é—®é¢˜ï¼ˆéš”ç¦»çº§åˆ«é«˜äºä¸€è‡´æ€§è§†å›¾ï¼Œä¹Ÿå°±æ˜¯å¿«ç…§çº§åˆ«ï¼‰æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š<br>1. å®é™…ä¸²è¡Œæ‰§è¡Œ<br>2. ä¸¤é˜¶æ®µåŠ é”ï¼ˆFOR UPDATE é€šçŸ¥æ•°æ®åº“å¯¹æ‰€æœ‰è¿”å›çš„è¡ŒåŠ é”ï¼‰<br>3. å¦‚æœæ²¡æœ‰åŠ é”çš„å¯¹è±¡ï¼Œå¯ä»¥å®ä½“åŒ–å†²çª<br>4. ä¸šåŠ¡ä¸Šæ§åˆ¶ï¼ˆé”å®šå¼€æ”¯ï¼‰<br>5. å¯ä¸²è¡ŒåŒ–çš„å¿«ç…§éš”ç¦»SSI<br>è€å¸ˆå®é™…ä¸Šé‡‡ç”¨çš„æ˜¯ä¸€ç§å˜å½¢çš„å®ä½“åŒ–å†²çªçš„æ–¹å¼ï¼Œå°†åŸæ¥ä¸šåŠ¡å®šä¹‰çš„å†²çªé€»è¾‘å®ä½“åŒ–åˆ°æ•°æ®åº“ä¸­çš„ä¸€è¡Œè®°å½•ä¸Šå»ï¼Œä¹Ÿå°±æ˜¯<br>â€œå€¼æ˜¯ 1 çš„æ—¶å€™ï¼Œè¡¨ç¤º user_id å…³æ³¨ liker_id;å€¼æ˜¯ 2 çš„æ—¶å€™ï¼Œè¡¨ç¤º liker_id å…³æ³¨ user_id;å€¼æ˜¯ 3 çš„æ—¶å€™ï¼Œè¡¨ç¤ºäº’ç›¸å…³æ³¨ã€‚â€<br>è¿™éƒ¨åˆ†ï¼Œå€¼å¾—å­¦ä¹ ã€‚<br>","like_count":0},{"had_liked":false,"id":227735,"user_name":"é±¼","can_delete":false,"product_type":"c1","uid":1487584,"ip_address":"","ucode":"89EC9CE3AD0281","user_header":"https://static001.geekbang.org/account/avatar/00/16/b2/e0/d856f5a4.jpg","comment_is_top":false,"comment_ctime":1592466873,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592466873","product_id":100020801,"comment_content":"â€œä¸šåŠ¡è®¾è®¡é—®é¢˜â€ä¸­çš„ä¸¾ä¾‹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªéå¸¸å…¸å‹çš„å†™å€¾æ–œé—®é¢˜ï¼šä¸¤ä¸ªå¹¶å‘çš„å†™äº‹ç‰©ï¼Œä¸€ä¸ªäº‹ç‰©çš„å†™ä¿®æ”¹äº†å¦å¤–ä¸€ä¸ªäº‹ç‰©ï¼ˆå¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªæ•°æ®ï¼‰æ‰§è¡Œçš„å…ˆå†³æ¡ä»¶ã€‚","like_count":0},{"had_liked":false,"id":224029,"user_name":"æ­¦å…´ä¸š","can_delete":false,"product_type":"c1","uid":1092637,"ip_address":"","ucode":"9091C8B76AD2F0","user_header":"https://static001.geekbang.org/account/avatar/00/10/ac/1d/c695f03e.jpg","comment_is_top":false,"comment_ctime":1591258898,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591258898","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œmysql-bin.000001ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä»000001é‡æ–°è®¡æ•°å‘¢<br><br>å¦‚æœè¿è¡Œäº†å¥½å¤šå¹´ï¼Œè¿™ä¸ªä¼šé‡æ–°ä»000001å¼€å§‹å—","like_count":0,"discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372352,"discussion_content":"ä¼š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620294197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223106,"user_name":"é²ç­å¤§å¸ˆ","can_delete":false,"product_type":"c1","uid":1179156,"ip_address":"","ucode":"4F9615DF87B031","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/14/f1532dec.jpg","comment_is_top":false,"comment_ctime":1591002554,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591002554","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå›è¿‡å¤´æ¥é‡æ–°çœ‹ï¼Œå‘ç°undologæ²¡æ€ä¹ˆä»‹ç»ï¼Œæƒ³åˆ°ä¸€äº›é—®é¢˜ï¼Œundologå’Œredolog,binlogçš„å†™å…¥é¡ºåºï¼Ÿundologä½•æ—¶è½ç›˜ï¼Ÿæˆ‘ç†è§£undologä¹Ÿåº”è¯¥åœ¨ä¸¤é˜¶æ®µåè®®é‡Œå¤„ç†çš„å§","like_count":0},{"had_liked":false,"id":222021,"user_name":"yonglongk","can_delete":false,"product_type":"c1","uid":1980225,"ip_address":"","ucode":"AE3168B15BA5AF","user_header":"","comment_is_top":false,"comment_ctime":1590657356,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590657356","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œæ‚¨å¥½ï¼Œè¯·é—®ä¸Šé¢é‚£ä¸ªâ€œå…³æ³¨â€é—®é¢˜é‡Œé¢ï¼Œlikeè¡¨æ˜¯ä¸æ˜¯ A,Bé‡ç”¨æˆ·ç›¸äº’å…³æ³¨çš„è¯1ï¼Œ2,3è¿™ä¸‰ä¸ªçŠ¶æ€æ€»å…±æœ‰6æ¡å‘¢ï¼ŒåŒ…æ‹¬ç”¨AæŸ¥çš„ï¼Œ123ï¼Œç”¨BæŸ¥çš„123","like_count":0},{"had_liked":false,"id":221736,"user_name":"é™ˆæ–Œ","can_delete":false,"product_type":"c1","uid":1450358,"ip_address":"","ucode":"B3F3A2117F8455","user_header":"https://static001.geekbang.org/account/avatar/00/16/21/76/0e443bcb.jpg","comment_is_top":false,"comment_ctime":1590579346,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590579346","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªç–‘æƒ‘çš„åœ°æ–¹å°±æ˜¯ï¼Œæ‚¨æ–‡ä¸­çš„è¿™å¥æè¿°ï¼šâ€œæ­¤æ—¶ï¼Œbinlog é‡Œé¢å¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ›´æ–°ç»†èŠ‚ï¼Œæ˜¯è¡¥ä¸å›æ¥çš„â€ ï¼Œbinlogæ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ›´æ–°ç»†èŠ‚ï¼Œä½†æ˜¯binlogä¸æ˜¯æœ‰è®°å½•äº†æ¯ä¸€æ¡æ‰§è¡Œçš„sqlè¯­å¥å—ï¼Ÿå¯å¦ç”¨è®°å½•çš„æ¯ä¸€æ¡sqlæ¥æ¢å¤æ•°æ®å‘¢ï¼Ÿä¸€ç‚¹ç–‘æƒ‘ä¸€æ ·è€å¸ˆå¯ä»¥è§£ç­”ï¼Œè°¢è°¢","like_count":0},{"had_liked":false,"id":221088,"user_name":"talkyoung","can_delete":false,"product_type":"c1","uid":1613665,"ip_address":"","ucode":"8D231FA9004B64","user_header":"https://static001.geekbang.org/account/avatar/00/18/9f/61/c46b42f4.jpg","comment_is_top":false,"comment_ctime":1590402455,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590402455","product_id":100020801,"comment_content":"ä¸šåŠ¡æ¶‰åŠè¿™ä¸ªå°æ¨¡å—å®ç°çš„çœŸæ˜¯å¤ªå·§å¦™äº† å“ˆå“ˆ çœ‹ä¸¤éæ‰æ‡‚è¿™æ ·è®¾è®¡çš„åŸå› ","like_count":0},{"had_liked":false,"id":217854,"user_name":"é›ªã®é›«Â·é›¨ã®éŸ³","can_delete":false,"product_type":"c1","uid":1997293,"ip_address":"","ucode":"0693DA3939A321","user_header":"https://static001.geekbang.org/account/avatar/00/1e/79/ed/4737a49b.jpg","comment_is_top":false,"comment_ctime":1589630353,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589630353","product_id":100020801,"comment_content":"æˆ‘å¥½åƒæœ‰ç‚¹æ˜ç™½è€å¸ˆçš„æ„æ€äº†ã€‚ã€‚æ„æ€æ˜¯è¯´ï¼Œbinlogçš„æœ¬æ¥ç›®çš„åœ¨äºæ¢å¤æ•°æ®ï¼Œå…ˆè¯»å–æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®åº“å¤‡ä»½ï¼Œä»è¿™ä¸ªæ—¶é—´ç‚¹å¼€å§‹æŒ‰ç…§binlogè®°å½•çš„ä¿¡æ¯æ¢å¤æ•°æ®æ˜¯å¯ä»¥æ­£ç¡®æ¢å¤çš„ï¼›ä½†æ˜¯å¯¹äºæ•°æ®åº“crashç„¶åé‡å¯çš„æƒ…å†µï¼Œå®é™…ç£ç›˜é‡Œé¢çš„æ•°æ®æ›´æ–°æƒ…å†µæ˜¯éšæœºçš„ï¼ˆå¯èƒ½æœ‰çš„æ›´æ–°è½ç›˜äº†æœ‰çš„æ²¡è½ç›˜ï¼‰ï¼Œè€Œbinlogæ˜¯æ²¡æœ‰åŠæ³•åˆ¤æ–­è¿™ä¸ªæƒ…å†µçš„ã€‚è€Œå¯¹äºredologï¼Œå› ä¸ºæ•°æ®æ›´æ–°è½ç›˜äº†ä¹‹åä¼šåœ¨redologæœ‰ç›¸åº”è®°å½•ï¼Œæ‰€ä»¥redologå¯ä»¥æ ¹æ®å®é™…æ›´æ–°çš„è½ç›˜æƒ…å†µæ¥é’ˆå¯¹æ€§çš„æ¢å¤æ•°æ®ã€‚æ˜¯è¿™ä¸ªæ„æ€å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":213617,"user_name":"é›¨ä¸­æ¼«æ­¥","can_delete":false,"product_type":"c1","uid":1130927,"ip_address":"","ucode":"022AFC716E3CAA","user_header":"https://static001.geekbang.org/account/avatar/00/11/41/af/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1588492602,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1588492602","product_id":100020801,"comment_content":"æœ‰ä¸€ç‚¹è¿˜æ˜¯ä¸æ˜ç™½ï¼Œredo log æ˜¯åœ¨å¯¹åº”äº‹åŠ¡çš„è„é¡µæ•°æ®å†™å…¥ç£ç›˜åå¯è¢«è¦†ç›–ï¼Œé‚£å‡å¦‚è„é¡µå†™å…¥åˆ°ç£ç›˜ï¼Œç„¶åcrash ï¼Œæ²¡æœ‰æ¨è¿›checkpoint ï¼Œè¿›è¡Œæ•°æ®æ¢å¤çš„æ—¶å€™æ˜¯ä¸æ˜¯åˆä¼šé‡æ–°æ‰§è¡Œé‚£äº›å·²ç»æ‰§è¡Œè¿‡çš„æ“ä½œå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1110149,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/85/fca692bf.jpg","nickname":"zhendecai","note":"","ucode":"DD27D314F8177D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":260063,"discussion_content":"å› ä¸ºæ•°æ®æ˜¯å¹‚ç­‰çš„å•Šï¼Œredologä¿å­˜çš„æ˜¯å½“å‰æ•°æ®é¡µçš„ä¿¡æ¯å•Šï¼Œæ‰€ä»¥é‡å¤å¤šå°‘æ¬¡é—®é¢˜éƒ½ä¸å¤§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588845284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1526355,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4a/53/063f9d17.jpg","nickname":"moonfox","note":"","ucode":"902BFF40EFA9FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1110149,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f0/85/fca692bf.jpg","nickname":"zhendecai","note":"","ucode":"DD27D314F8177D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330638,"discussion_content":"è¿™é‡Œä¸ç­‰å¹‚æ€§æ— å…³ï¼Œæ²¡æœ‰æ¨è¿›ä¼šæ¨è¿›ï¼Œç„¶åé€šè¿‡lsnåˆ¤å®šè¿™ä¸ªredologå·²ç»æ‰§è¡Œè¿‡äº†ï¼Œå°±ç›´æ¥è·³è¿‡ï¼Œä¸ç”¨æ‰§è¡Œredologä¸­çš„å†…å®¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606660830,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":260063,"ip_address":""},"score":330638,"extra":""}]}]},{"had_liked":false,"id":209473,"user_name":"qwc","can_delete":false,"product_type":"c1","uid":1345393,"ip_address":"","ucode":"FACA3958F322BD","user_header":"","comment_is_top":false,"comment_ctime":1587555498,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1587555498","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜å¾ˆç–‘æƒ‘ï¼Œselect for update whereæˆ–è€…update where ï¼Œwhereæ¡ä»¶æ˜¯é€šè¿‡ç´¢å¼•æŸ¥è¯¢ã€‚æ­£å¸¸æƒ…å†µä¼šæœ‰è¡Œçº§é”ï¼Œå¦‚æœè¯´æŸ¥è¯¢æˆ–æ›´æ–°çš„è¡Œä¸å­˜åœ¨ï¼Œé‚£æ˜¯ä¸æ˜¯åº”è¯¥ä¸Šè¡¨çº§é”å‘€ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":199643,"user_name":"ä½™å‘å","can_delete":false,"product_type":"c1","uid":1119778,"ip_address":"","ucode":"263773616D2C83","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/22/2205cf0a.jpg","comment_is_top":false,"comment_ctime":1585493068,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585493068","product_id":100020801,"comment_content":"å½“æ—¶å¾ˆå¤šç–‘æƒ‘éƒ½èƒ½å¤Ÿè§£å¼€äº†ã€‚","like_count":0},{"had_liked":false,"id":197146,"user_name":"Xä¸¶æ¥“","can_delete":false,"product_type":"c1","uid":1079760,"ip_address":"","ucode":"F5402FBD150BC1","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/d0/63ac112e.jpg","comment_is_top":false,"comment_ctime":1585360246,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585360246","product_id":100020801,"comment_content":"ç­”ç–‘æ–‡ç« çœŸæ£’ï¼Œå‰é¢ä¸æ‡‚çš„ä¸€ä¸‹å­æ¸…æ™°äº†","like_count":0},{"had_liked":false,"id":193727,"user_name":"å¤å…´","can_delete":false,"product_type":"c1","uid":1363230,"ip_address":"","ucode":"C172A87873001A","user_header":"https://static001.geekbang.org/account/avatar/00/14/cd/1e/692c3313.jpg","comment_is_top":false,"comment_ctime":1584955380,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584955380","product_id":100020801,"comment_content":"â€œä½†æ˜¯ï¼ŒçœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„ã€‚â€œ ç¬¬äºŒç¯‡ä¸æ˜¯è¯´ å…ˆå†™redo log(prepare) å†å†™binlogï¼Œæœ€åcommitï¼Œè¿™é‡Œè¯´commitçš„æ—¶å€™ï¼Œæ‰å†™redo logã€‚","like_count":0},{"had_liked":false,"id":190298,"user_name":"è¿ç»´è€èƒ¡","can_delete":false,"product_type":"c1","uid":1227007,"ip_address":"","ucode":"DF398BEE296E11","user_header":"https://static001.geekbang.org/account/avatar/00/12/b8/ff/249da6da.jpg","comment_is_top":false,"comment_ctime":1584627680,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584627680","product_id":100020801,"comment_content":"ä¸»é”®ç´¢å¼•å¸¦æœ‰å¶å­èŠ‚ç‚¹çš„æ•°æ®ï¼Œåº”è¯¥æ˜¯å¼•æ“å±‚å‘ç°å€¼ä¸åŸæ¥ç›¸åŒï¼Œä¸æ›´æ–°ï¼Œç›´æ¥è¿”å›ã€‚","like_count":0},{"had_liked":false,"id":186982,"user_name":"youngButcher","can_delete":false,"product_type":"c1","uid":1563339,"ip_address":"","ucode":"2762D20F1E8D19","user_header":"","comment_is_top":false,"comment_ctime":1583983453,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583983453","product_id":100020801,"comment_content":"Aå’ŒBçš„å¤§å°æ¯”è¾ƒæ˜¯ä»€ä¹ˆæ„æ€å•Š","like_count":0},{"had_liked":false,"id":186871,"user_name":"å…ˆå¬","can_delete":false,"product_type":"c1","uid":1151409,"ip_address":"","ucode":"82D8DA7A2FEB4B","user_header":"https://static001.geekbang.org/account/avatar/00/11/91/b1/fb117c21.jpg","comment_is_top":false,"comment_ctime":1583942076,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1583942076","product_id":100020801,"comment_content":"äº’ç›¸å…³æ³¨åŠ å¥½å‹é‚£ä¸ªä¾‹å­ï¼Œè€å¸ˆç»™å‡ºçš„è®¾è®¡å¾ˆå·§å¦™ã€‚<br>å¦‚æœæ‰©å±•ä¸€ä¸‹æœ‰è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼š<br>å¯èƒ½ä¼šæœ‰ â€œæ‰¾å‡ºæŸäººuser_idxxxæ‰€å…³æ³¨çš„æ‰€æœ‰äººâ€<br><br>å¯ä»¥æŠŠuser_idå’Œliker_idæ¯”è¾ƒå¤§å°åï¼ŒæŠŠå¤§çš„ä½œä¸ºfriend_id1,å°çš„ä½œä¸ºfriend_id2æ’åˆ°friendè¡¨é‡Œé¢(å’Œlikeè¡¨åè¿‡æ¥). è¿™æ ·æ‹¿ç€user_idxxxåœ¨likeè¡¨å’Œfriendè¡¨é‡Œé¢åˆ†åˆ«æŸ¥ä¸€æ¬¡ç„¶ååˆå¹¶å°±å¯ä»¥å¾—åˆ°æƒ³è¦çš„ç»“æœäº†ã€‚","like_count":0,"discussions":[{"author":{"id":1151409,"avatar":"https://static001.geekbang.org/account/avatar/00/11/91/b1/fb117c21.jpg","nickname":"å…ˆå¬","note":"","ucode":"82D8DA7A2FEB4B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202866,"discussion_content":"å“¦ï¼Œæˆ‘çš„è¿™ä¸ªè¯´æ³•ä¸å¯¹ã€‚ä¼šæ¼æ‰idæ¯”user_idxxxå°ï¼Œä½†æ˜¯æ²¡æœ‰å…³æ³¨user_idxxxçš„äºº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583972283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183524,"user_name":"williamcai","can_delete":false,"product_type":"c1","uid":1158294,"ip_address":"","ucode":"B158F52C2D39BC","user_header":"https://static001.geekbang.org/account/avatar/00/11/ac/96/46b13896.jpg","comment_is_top":false,"comment_ctime":1583058054,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583058054","product_id":100020801,"comment_content":"ç¬¬ä¸€ç§ï¼ŒæŠŠè¡¨tåŠ ä¸€ä¸ªæ—¶é—´æˆ³å­—æ®µï¼Œå€¼è®¾ç½®ä¸ºå½“å‰æ—¶é—´æˆ³ï¼Œå‘ç°æ›´æ–°æ“ä½œåï¼Œæ—¶é—´æ²¡æœ‰å˜åŒ–","like_count":0},{"had_liked":false,"id":178852,"user_name":"åèç§‘æŠ€","can_delete":false,"product_type":"c1","uid":1808280,"ip_address":"","ucode":"B6BA3C47C05073","user_header":"","comment_is_top":false,"comment_ctime":1581840437,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1581840437","product_id":100020801,"comment_content":"è€å¸ˆå…³äºæœ¬ä¸»é¢˜çš„è¯¾åä½œä¸šä¸­ï¼Œä½ åˆ†æè¯´ä¸ºä»€ä¹ˆæ²¡æ³•åšç­‰å€¼å¯¹æ¯”åˆ†æã€‚å› ä¸º â€œMySQL åœ¨æ›´æ–°å‰æ˜¯è¿›è¡Œäº†ç­‰å€¼å¯¹æ¯”çš„ã€‚åªæ˜¯åœ¨è¿™ä¸ªè¯­å¥é‡Œé¢ï¼ŒMySQL è®¤ä¸ºè¯»å‡ºæ¥çš„å€¼ï¼Œåªæœ‰ä¸€ä¸ªç¡®å®šçš„ (id=1), è€Œè¦å†™çš„æ˜¯ (a=3)ï¼Œåªä»è¿™ä¸¤ä¸ªä¿¡æ¯æ˜¯çœ‹ä¸å‡ºæ¥â€œä¸éœ€è¦ä¿®æ”¹â€çš„ã€‚â€   æƒ³é—®ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆçœ‹ä¸å‡ºæ¥ ä¸éœ€è¦ä¿®æ”¹ï¼Ÿ ID ç¡®å®äº†å”¯ä¸€è¡Œï¼Œ a=3ç¡®è®¤äº†è¦æ›´æ–°çš„å€¼ï¼Œå®Œå…¨å¯ä»¥ä¸åŸè¡¨açš„å€¼è¿›è¡Œç­‰å€¼å¯¹æ¯”å‘€ï¼Ÿ","like_count":0},{"had_liked":false,"id":175697,"user_name":"ç‹ç››æ­¦","can_delete":false,"product_type":"c1","uid":1182516,"ip_address":"","ucode":"DE7EF246D3DCE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/0b/34/f41d73a4.jpg","comment_is_top":false,"comment_ctime":1580801888,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580801888","product_id":100020801,"comment_content":"&quot;InnoDB å¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°&quot;<br>å´©æºƒé‡å¯åï¼Œå¦‚ä½•åˆ¤æ–­è¯†åˆ«å‡ºä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Ÿ","like_count":0},{"had_liked":false,"id":175689,"user_name":"ã€è½å¶ä¸ºä½ èˆ","can_delete":false,"product_type":"c1","uid":1756562,"ip_address":"","ucode":"A196460774A33F","user_header":"https://static001.geekbang.org/account/avatar/00/1a/cd/92/f75a00dd.jpg","comment_is_top":false,"comment_ctime":1580800750,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580800750","product_id":100020801,"comment_content":"redo log bufferåªæœ‰åœ¨commitçŠ¶æ€æ‰ä¼šåˆ·ç›˜ï¼Œä¸ºä»€ä¹ˆredo logé‡Œæœ‰prepareçŠ¶æ€ï¼Ÿ","like_count":0},{"had_liked":false,"id":164983,"user_name":"æ ‹èƒ½","can_delete":false,"product_type":"c1","uid":1006849,"ip_address":"","ucode":"8BD9C939D3E8E1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/01/9cd84003.jpg","comment_is_top":false,"comment_ctime":1577123817,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577123817","product_id":100020801,"comment_content":"å¼•ç”¨ï¼šâ€œå¦‚æœå›¾1çš„å†™å…¥redo logæ˜¯å†™å†…å­˜ï¼Œå½“æ—¶åˆ»Bå‘ç”Ÿcrashï¼Œé‡å¯åè¿™éƒ¨åˆ†redo logéƒ½ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆä½•è°ˆåˆ¤æ–­redo logæ˜¯å¦æœ‰å®Œæ•´çš„prepareè¿˜æ˜¯commitæ ‡å¿—å‘¢ï¼Ÿâ€ ä½œè€…å›å¤ï¼šâ€œä¸æ˜¯å“¦ï¼Œ<br>åœ¨äº‹åŠ¡æ‰§è¡ŒæœŸé—´æ˜¯åœ¨redo log buffer.åœ¨å›¾ä¸­å†™binlogä¹‹å‰ï¼Œå°±å·²ç»éƒ½å†™äº†ç›˜å¹¶ä¸”fsyncäº†â€. æˆ‘ç†è§£æ˜¯commitæ—¶ï¼Œé™¤äº†æŠŠredo buffer log å†™å…¥äº†åˆ°äº†redo logï¼ˆè€Œæ–‡ä¸­åªè®²redo buffer log Commitçš„éƒ¨åˆ†ï¼Œå¹¶æ²¡è®²å®Œåç»­ï¼Œæ‰€ä»¥ä¼šæœ‰åœ¨Bç‚¹crashçš„å›°æƒ‘ï¼‰ï¼Œè¿˜ä¼šæŠŠredo logçŠ¶æ€è®¾ä¸ºprepareï¼Œç»§ç»­binlogå†™å…¥ï¼Œç»§ç»­åç»­æ“ä½œç­‰ï¼Œç›´åˆ°æœ€åå†commit.","like_count":0},{"had_liked":false,"id":160160,"user_name":"é‡è§","can_delete":false,"product_type":"c1","uid":1624590,"ip_address":"","ucode":"FAF53CD4C28494","user_header":"https://static001.geekbang.org/account/avatar/00/18/ca/0e/5009c5ff.jpg","comment_is_top":false,"comment_ctime":1575882584,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1575882584","product_id":100020801,"comment_content":"ç”±æ–‡ç« ä¸­æåˆ°çš„&quot;ç»“æœæ˜¾ç¤ºï¼ŒåŒ¹é… (rows matched) äº†ä¸€è¡Œï¼Œä¿®æ”¹ (Changed) äº† 0 è¡Œã€‚&quot;æƒ³åˆ°çš„ä¸€ç‚¹:<br><br>åœ¨ç¨‹åºçš„æ•°æ®åº“è¿æ¥åœ°å€ä¸­æœ‰ä¸€ä¸ªå‚æ•°, useAffectedRows, å¦‚æœè¿™ä¸ªå‚æ•°è®¾ç½®æˆäº†true, é‚£ä¹ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­, jdbc api æˆ–è€… mybatisæ¡†æ¶ çš„æ›´æ–°è¯­å¥è¿”å›çš„å—å½±å“è¡Œæ•°å°±æ˜¯0.<br><br>å¦‚æœè¿™æ—¶ç”¨ç¨‹åºè¿”å›çš„ jdbcæˆ–è€…mybatisæ¡†æ¶è¿”å›çš„ 0 æ¥åˆ¤æ–­æ˜¯å¦æ•°æ®åº“æ›´æ–°æˆåŠŸ, å°±ä¼šå‡ºç°æ˜æ˜æ•°æ®åº“æ›´æ–°æˆåŠŸäº†, ä½†æ˜¯ç¨‹åºå´è®¤ä¸ºæ²¡æœ‰æˆåŠŸ, ä»è€ŒæŠ›å‡ºå¼‚å¸¸, ä¸€è·¯åé¦ˆåˆ°ç”¨æˆ·ç«¯.<br><br>è™½ç„¶è¿™æ—¶è¦æ›´æ–°çš„æ•°æ®å’Œæ•°æ®åº“ä¸­çš„æ•°æ®æœ¬èº«å°±æ˜¯ä¸€æ ·çš„, ä¸å½±å“æ•°æ®çš„å‡†ç¡®æ€§, ä½†æ˜¯åœ¨ç¨‹åºçš„è¡Œä¸ºä¸Šæ˜¯æ¯”è¾ƒæ€ªå¼‚çš„.<br><br>ä¸€èˆ¬ç¨‹åºåœ¨åšæ›´æ–°æ“ä½œçš„æ—¶å€™, éƒ½ä¼šé€šè¿‡åˆ¤æ–­è¿”å›çš„è¡Œæ•°æ¥å¾—çŸ¥æ­¤æ¬¡æ›´æ–°æ“ä½œæ˜¯å¦æˆåŠŸ.<br>è€Œåœ¨æ›´æ–°ä¹‹å‰ä¸€èˆ¬éƒ½ä¸ä¼šåœ¨ä»£ç ä¸­åˆ¤æ–­è¦æ›´æ–°çš„å€¼å’Œæ•°æ®åº“çš„å½“å‰å€¼æ˜¯å¦ä¸€æ ·<br><br>å¦‚æœurlä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªå‚æ•°æˆ–è€…è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºfalse, jdbcåˆ™ä¼šè¿”å›rows matchedçš„å€¼, è¿™é‡Œå°±æ˜¯1. ç¨‹åºå¯ä»¥æ­£å¸¸æ®æ­¤åˆ¤æ–­.<br><br>è¿™å„¿å¯èƒ½æ˜¯ä¸€ä¸ªå‘.","like_count":0},{"had_liked":false,"id":155979,"user_name":"Geek_e0c36d","can_delete":false,"product_type":"c1","uid":1709425,"ip_address":"","ucode":"5FB004687DB2CB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/aM00uMFibmtMG9OcSiaB9HwRuRdRNUuMQibWNmmq7r33p7nibkY1CQbLicNYDufEjickLt82VQBtZ0BibrJ6X4RIer02A/132","comment_is_top":false,"comment_ctime":1574786751,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574786751","product_id":100020801,"comment_content":"é¢è€å¸ˆï¼Œå‰é¢çš„é—®é¢˜è¯·å¿½ç•¥ã€‚<br>æˆ‘çš„æ–°é—®é¢˜æ˜¯ï¼Œä¸€æ¡æ›´æ–°è¯­å¥æ‰§è¡Œï¼Œä½¿ç”¨WAL,åªå†™äº†å†…å­˜å’Œredo logå°±ç®—å®Œæˆäº†ã€‚ä¸¤é˜¶æ®µæäº¤ä½“ç°åœ¨å“ªï¼Ÿçº ç»“å•Š","like_count":0},{"had_liked":false,"id":152635,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1574054512,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574054512","product_id":100020801,"comment_content":"amazingğŸ¤©","like_count":0},{"had_liked":false,"id":152491,"user_name":"Ccc","can_delete":false,"product_type":"c1","uid":1691243,"ip_address":"","ucode":"EAEA0284948959","user_header":"https://static001.geekbang.org/account/avatar/00/19/ce/6b/ae7489a0.jpg","comment_is_top":false,"comment_ctime":1574035892,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574035892","product_id":100020801,"comment_content":"çœ‹åˆ°è€å¸ˆç”¨äº†on duplicate key updateï¼Œæƒ³é—®ä¸€ä¸ªç›¸å…³é—®é¢˜ï¼š<br>å‚æ•°innodb_autoinc_lock_modeå€¼ä¸º1çš„æ—¶å€™ï¼Œæ¯æ¬¡ç”¨on duplicate key updateæ—¶ï¼Œä¸ç®¡æ˜¯æ’å…¥è¿˜æ˜¯æ›´æ–°ï¼Œ<br>éƒ½ä¼šæ›´æ–°è¯¥è¡¨çš„è‡ªå¢idï¼›å¦‚æœè¿™ä¸ªæ“ä½œæ¯”è¾ƒé¢‘ç¹çš„è¯ï¼Œä¼šå¯¼è‡´ä¸»é”®idè‡ªå¢çš„å¾ˆå¿«ã€‚<br>ä¸‹é¢è¿™ä¸‰ç§åšæ³•åˆç†å—ï¼š<br>(1)æŠŠå‚æ•°innodb_autoinc_lock_modeæ”¹ä¸º0<br>(2)è‡ªå¢idç”¨bigintç±»å‹<br>(3)æŠŠè¿™æ¡è¯­å¥æ‹†æˆselect ,insert&#47;update  ä¸¤æ¡è¯­å¥<br><br>æœ‰æ²¡æœ‰å…¶ä»–æ›´å¥½çš„æ–¹å¼å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":149396,"user_name":"CcczzZ","can_delete":false,"product_type":"c1","uid":1019568,"ip_address":"","ucode":"5F46DA5053D2BB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/b0/ef201991.jpg","comment_is_top":false,"comment_ctime":1573210869,"is_pvip":false,"replies":[{"id":"57450","content":"ä½ è¯´å¾—å¯¹ï¼Œ<br>èµç»†è‡´<br>æˆ‘ä»¬å‹˜è¯¯ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1573224673,"ip_address":"","comment_id":149396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573210869","product_id":100020801,"comment_content":"æ–‡ç« é‡Œåˆ›å»ºfriendè¡¨è¯­å¥idå­—æ®µå°‘äº†ä¸€ä¸ªæ ‡ç‚¹å“ˆã€‚ã€Œid` int(11) NOT NULL AUTO_INCREMENTã€ã€‚<br>åº”è¯¥æ˜¯ `id` int(11) NOT NULL AUTO_INCREMENT","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473848,"discussion_content":"ä½ è¯´å¾—å¯¹ï¼Œ\nèµç»†è‡´\næˆ‘ä»¬å‹˜è¯¯ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573224673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145711,"user_name":"æ— è‡æœ‹å‹","can_delete":false,"product_type":"c1","uid":1035562,"ip_address":"","ucode":"80482C5F0464A3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/2a/bdbed6ed.jpg","comment_is_top":false,"comment_ctime":1572350451,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1572350451","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæœ‰ä¸€ä¸ªç–‘é—®ï¼Œmysqlåœ¨å¯¹äº‹åŠ¡è¿›è¡Œå›æ»šæ—¶ï¼Œåº”è¯¥æ˜¯æœ‰ä¸€äº›åˆ¤æ–­é€»è¾‘å§ï¼ˆæ¯”å¦‚æ ¹æ®undo logé‡Œæ•°æ®çš„æ›´æ”¹æ—¶åºï¼Ÿï¼‰ï¼Œä¸ç„¶å¯èƒ½ä¼šå‡ºç°è¦†ç›–åˆ«çš„äº‹åŠ¡çš„æ›´æ”¹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372351,"discussion_content":"mvccï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620294100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143194,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1015754,"ip_address":"","ucode":"00DF2FEC58D2E6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg","comment_is_top":false,"comment_ctime":1571645452,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1571645452","product_id":100020801,"comment_content":"è€å¸ˆå¯¹äºâ€œä¸šåŠ¡è®¾è®¡é—®é¢˜â€æ‚¨ç»™å‡ºçš„ç­”æ¡ˆï¼Œä¸ºä»€ä¹ˆè¦åŒºåˆ†A&gt;Bå’ŒA&lt;Bçš„æƒ…å†µå‘¢ï¼Ÿæ²¡æœ‰æ˜ç™½","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158858,"discussion_content":"å› ä¸ºa<bä¸º1ï¼Œa>bä¸º2ï¼Œå¤§äºå°äºåªæ˜¯ä¸€ç§å…³æ³¨å…³ç³»ï¼Œä½†æ˜¯å”¯ç´¢å¼•æ˜¯userid_likeridçš„å‰åå…³ç³»ï¼Œæ‰€ä»¥è¿™ç§å‰åä¸èƒ½å˜ï¼Œå˜çš„å°±æ˜¯å…³æ³¨å…³ç³»ï¼Œå› ä¸ºUKçš„å­˜åœ¨ï¼Œå¹¶å‘è§£å†³äº†ï¼Œç„¶åå‰©ä¸‹çš„å°±æ˜¯å½“è®°å½•ä¸­æœ‰1æˆ–è€…2æ—¶ï¼Œæ‰§è¡Œåˆ°ç¬¬äºŒæ­¥æ—¶å°±ç›¸å½“äºäº’ç›¸å…³æ³¨äº†ï¼Œæ­¤æ—¶æ”¹æˆ3ï¼ŒåŒæ—¶å‘friendè¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580634374,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135638,"user_name":"æ˜Ÿæ˜Ÿæ»´è“å¤©","can_delete":false,"product_type":"c1","uid":1465990,"ip_address":"","ucode":"2F2F56F93AD828","user_header":"https://static001.geekbang.org/account/avatar/00/16/5e/86/40877404.jpg","comment_is_top":false,"comment_ctime":1569232319,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569232319","product_id":100020801,"comment_content":"ä¸ªäººæ„Ÿè§‰â€œä½†æ˜¯å¦‚æœ Aã€B åŒæ—¶å…³æ³¨å¯¹æ–¹ï¼Œä¼šå‡ºç°ä¸ä¼šæˆä¸ºå¥½å‹çš„æƒ…å†µâ€è¿™ç§æœ€å¥½è¿˜æ˜¯åœ¨å¤–é¢ç”¨å…¶ä»–åˆ†å¸ƒå¼é”ä¿è¯ï¼Œç±»ä¼¼äºè®¢å•åŒä¸€æ—¶é—´æ”¯ä»˜ä¸€æ¬¡çš„æ•ˆæœã€‚æˆ–è€…æä¸ªå®šæ—¶ä»»åŠ¡åˆ¤æ–­ä¸‹æœ‰æ²¡æœ‰è¿™ç§å¼‚å¸¸æƒ…å†µå‘ç”Ÿï¼Œç„¶åå¤„ç†ä¸‹ã€‚","like_count":0},{"had_liked":false,"id":126455,"user_name":"æˆ‘å®¶é—¨å‰æœ‰åªçŒª","can_delete":false,"product_type":"c1","uid":1488035,"ip_address":"","ucode":"F8CF618CF4681E","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/a3/a159ca86.jpg","comment_is_top":false,"comment_ctime":1566388080,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1566388080","product_id":100020801,"comment_content":"ä¸ºä»€ä¹ˆwalå°±æ˜¯é¡ºåºå†™ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1022507,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOpANMwDibLmj5IGJh6dTw300sZ1BHM5sG3sZv1A1rvCHOiblPD3jgFOiaMVVujtctWnQbVFoNPpRgw/132","nickname":"alioo","note":"","ucode":"F36A38C1F5FFAB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7700,"discussion_content":"walæˆ‘ç†è§£æ˜¯å†™redologï¼Œåªæ˜¯è®°å½•æ—¥å¿—è€Œå·²ï¼Œç›´æ¥å¾€åæ’å…¥å°±è¡Œçš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567645474,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1022507,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOpANMwDibLmj5IGJh6dTw300sZ1BHM5sG3sZv1A1rvCHOiblPD3jgFOiaMVVujtctWnQbVFoNPpRgw/132","nickname":"alioo","note":"","ucode":"F36A38C1F5FFAB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372349,"discussion_content":"redo logæ˜¯å›ºå®šå¤§å°çš„è¿ç»­çš„å­˜å‚¨ç©ºé—´","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620293713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":7700,"ip_address":""},"score":372349,"extra":""}]}]},{"had_liked":false,"id":125970,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1566286907,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566286907","product_id":100020801,"comment_content":"â€ä½†æ˜¯ï¼ŒçœŸæ­£æŠŠæ—¥å¿—å†™åˆ° redo log æ–‡ä»¶ï¼ˆæ–‡ä»¶åæ˜¯ ib_logfile+ æ•°å­—ï¼‰ï¼Œæ˜¯åœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™åšçš„ã€‚â€<br><br>æˆ‘è®°å¾—è€å¸ˆè¯´è¿‡ï¼Œredo logå°±æ˜¯ä¸ºäº†å‡å°‘ç£ç›˜çš„éšæœºå†™ioï¼Œæå‡æ€§èƒ½ï¼Œä½†æ˜¯ä¸Šè¾¹çš„è¯ï¼Œæ¯æ¬¡æ›´æ–°ï¼Œæ—¢ç„¶æ›´æ–°ä¸€å®šä¼šæäº¤ï¼Œæäº¤åˆéƒ½è¦å†™ç›˜äº†(æˆ‘ç†è§£redo logæ–‡ä»¶ä¸€å®šæ˜¯è½ç›˜äº†)ï¼Œè¿™å¥½åƒå’Œè€å¸ˆè¯´çš„çŸ›ç›¾äº†ã€‚(å…ˆå†™redo log   redo logä¼šå®šæ—¶çš„è½ç›˜)","like_count":0},{"had_liked":false,"id":122527,"user_name":"nirvana","can_delete":false,"product_type":"c1","uid":1612674,"ip_address":"","ucode":"1DD07B5F2C6E03","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKT7Exm9wh9wtJYvB33mEwcUmNKfkzYjk56GrPUsllwc5iaklMSJ0eaaTbKuAFgQaFLtDSIfUcogGQ/132","comment_is_top":false,"comment_ctime":1565416381,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1565416381","product_id":100020801,"comment_content":"ä¸šåŠ¡ä¸Šæœ‰è¿™æ ·çš„éœ€æ±‚ï¼ŒAã€B ä¸¤ä¸ªç”¨æˆ·ï¼Œå¦‚æœäº’ç›¸å…³æ³¨ï¼Œåˆ™æˆä¸ºå¥½å‹<br>è¿™ä¸ªé—®é¢˜èƒ½å¦è¿™æ ·è§£å†³ï¼š<br>A like Bæ—¶ï¼š<br>begin;<br>insert into like(user_id, like_id) values(A, B);<br>commit;<br>begin;<br>select * from like where user_id = B and like_id = A;<br>å¦‚æœæœ‰è®°å½•<br>é‚£ä¹ˆ insert into friend...<br>commit<br><br>æ­¤æ—¶Aï¼ŒBåŒæ—¶äº’ç›¸likeæ—¶åº”å½“ä¸ä¼šå‡ºç°ä¸èƒ½æˆä¸ºfriendçš„æƒ…å†µï¼Œè¦å˜›Aèƒ½è¯»åˆ°Bæ’å…¥likeçš„è®°å½•ï¼Œè¦å˜›Bèƒ½è¯»åˆ°Aæ’å…¥åˆ°likeè¡¨çš„è®°å½•","like_count":0,"discussions":[{"author":{"id":1016917,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/55/1e40bd61.jpg","nickname":"shiziwen","note":"","ucode":"ADADC770D82D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266252,"discussion_content":"å¸Œæœ›è€å¸ˆå’ŒåŒå­¦ä»¬èƒ½æŒ‡å‡ºè¿™ç§è®¾è®¡çš„ä¸è¶³ä¹‹å¤„ï¼Œè°¢è°¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589481640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1016917,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/84/55/1e40bd61.jpg","nickname":"shiziwen","note":"","ucode":"ADADC770D82D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":266251,"discussion_content":"çœ‹æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”ï¼Œä¹Ÿæ˜¯è¿™ä¹ˆè®¾è®¡ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰éšè—çš„é—®é¢˜ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589481578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121099,"user_name":"Geek_4e4ec2","can_delete":false,"product_type":"c1","uid":1603078,"ip_address":"","ucode":"6DAD5EE4FFB195","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/zAZv4NyuS21Y1qk45j8JiaoEYdA5Zgc1PqpJsBokz5bZVmdkf6kNWvT4cUAAKAdH6TgN52DWZhiaH6wNFhw14nRg/132","comment_is_top":false,"comment_ctime":1565058014,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1565058014","product_id":100020801,"comment_content":"ç”¨æˆ·ç›¸äº’å…³æ³¨é—®é¢˜å¦‚æœidæ˜¯varcharç±»å‹åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¯·è€å¸ˆç»™ä¸ªæ€è·¯","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158859,"discussion_content":"varcharä¹Ÿæ˜¯å¯ä»¥æ¯”å¤§å°çš„å§ã€‚è¿™ä¸ªä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯é è¿™ç§å¤§å°æ¥æ˜ç¡®ä¸€ç§å…³ç³»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580634434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120150,"user_name":"å¸ƒè¡£ä¸èˆ","can_delete":false,"product_type":"c1","uid":1144495,"ip_address":"","ucode":"7576087DC22F3B","user_header":"https://static001.geekbang.org/account/avatar/00/11/76/af/c4e518ff.jpg","comment_is_top":false,"comment_ctime":1564799541,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1564799541","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œinnodbä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åˆ†è£‚æ—¶ä¼šæœ‰æ•°æ®ä»æ—§é¡µé¢è¿ç§»åˆ°æ–°çš„é¡µé¢ï¼Œè¿™ç§æƒ…å†µä¸‹æ˜¯ä¸æ˜¯ä¹Ÿè¦è®°å½•redoï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158860,"discussion_content":"ä¸ç”¨å§ï¼Œè¿™ä¸ªæœ‰å…³ç³»å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580634560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119291,"user_name":"thomas","can_delete":false,"product_type":"c1","uid":1016777,"ip_address":"","ucode":"9AB945308F1B50","user_header":"https://static001.geekbang.org/account/avatar/00/0f/83/c9/5d03981a.jpg","comment_is_top":false,"comment_ctime":1564551955,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1564551955","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰ä»€ä¹ˆå·¥å…·å¯ä»¥æŸ¥çœ‹ib_logfileæ–‡ä»¶å—","like_count":0},{"had_liked":false,"id":114447,"user_name":"ç©å‘½","can_delete":false,"product_type":"c1","uid":1106854,"ip_address":"","ucode":"68FEEA5F541B7E","user_header":"https://static001.geekbang.org/account/avatar/00/10/e3/a6/3f6f0cea.jpg","comment_is_top":false,"comment_ctime":1563319461,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563319461","product_id":100020801,"comment_content":"æœ€åä¸€å¥æ˜¯ä¸æ˜¯ä¸ä¼šæœ‰è¡¨é”","like_count":0},{"had_liked":false,"id":114129,"user_name":"Sancho","can_delete":false,"product_type":"c1","uid":1436391,"ip_address":"","ucode":"78849913082622","user_header":"https://static001.geekbang.org/account/avatar/00/15/ea/e7/9ce305ec.jpg","comment_is_top":false,"comment_ctime":1563240562,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563240562","product_id":100020801,"comment_content":"åŒæ—¶å…³æ³¨ï¼ŒåŠ ä¸ºå¥½å‹ï¼ŒæŒ‰è€å¸ˆæ€è·¯<br>å¦‚æœA&lt;Bæ—¶<br>Aå…³æ³¨B<br>mysql&gt; begin; &#47;* å¯åŠ¨äº‹åŠ¡ *&#47;<br>insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1;<br>select relation_ship from `like` where user_id=A and liker_id=B;<br>&#47;* ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_shipï¼Œ<br>  å¦‚æœæ˜¯ 1ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit<br>  å¦‚æœæ˜¯ 3ï¼Œåˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥ï¼š<br>  *&#47;<br>insert ignore into friend(friend_1_id, friend_2_id) values(A,B);<br>commit;<br><br>å¦‚æ­¤åŒæ—¶ï¼ŒBå…³æ³¨Aï¼ˆB&gt;Aï¼‰ï¼Œæ¨æ¼”(æ ¹æ®è€å¸ˆæ–‡ä¸­&quot;å¦‚æœA&gt;B,xxx&quot;)åº”è¯¥æ‰§è¡Œå¦‚ä¸‹é€»è¾‘ï¼š<br>mysql&gt; begin; &#47;* å¯åŠ¨äº‹åŠ¡ *&#47;<br>insert into `like`(user_id, liker_id, relation_ship) values(A, B, 2) on duplicate key update relation_ship=relation_ship | 2;<br>select relation_ship from `like` where user_id=A and liker_id=B;<br>&#47;* ä»£ç ä¸­åˆ¤æ–­è¿”å›çš„ relation_shipï¼Œ<br>  å¦‚æœæ˜¯ 2ï¼Œäº‹åŠ¡ç»“æŸï¼Œæ‰§è¡Œ commit<br>  å¦‚æœæ˜¯ 3ï¼Œåˆ™æ‰§è¡Œä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥ï¼š<br>*&#47;<br>insert ignore into friend(friend_1_id, friend_2_id) values(A,B);<br>commit;<br><br>æ¨æ¼”ç»“è®ºï¼š<br>ç”±äº`like`è¡¨ä¸­å¯¹(`friend_1_id`,`firned_2_id`)åŠ äº†å”¯ä¸€é”®ç´¢å¼•ï¼Œæ ¹æ®ä¸Šé¢æ¨æ¼”å‡ºæ¥çš„insert `like`è¯­å¥ï¼Œä¼šæœ‰å”¯ä¸€é”®å†²çªè€Œå¤±è´¥,ç„¶åinsert into `like`&quot;é™çº§&quot;ä¸º<br>update `like` set relation_ship=relation_ship | 2 where user_id=A and liker_id=B;<br><br>è¿™æ ·åŒæ—¶äº§ç”ŸAå…³æ³¨Bä¸Bå…³æ³¨Aæ—¶ï¼Œå°±ä¼šæ“ä½œåŒä¸€è¡Œè®°å½•ï¼Œå…ˆæ‰§è¡Œçš„äº‹åŠ¡ä¼šæ‰§è¡Œinsert into `like`ï¼ŒåŒæ—¶ä¸‹é¢çš„selectæŒæœ‰è¯¥è¡Œçš„è¯»é”ï¼›ååˆ°çš„å¦ä¸€ä¸ªäº‹åŠ¡ç”±äºå”¯ä¸€é”®å†²çªè¢«é™çº§ä¸ºupdateåï¼Œåªæœ‰ç­‰å¾…è¯¥è¡Œçš„è¡Œé”è¢«é‡Šæ”¾ã€‚<br><br>PSï¼šæœ¬æ¥å¯¹è€å¸ˆæ–‡ä¸­â€œè¡Œé”å†²çªâ€æœ‰ç–‘é—®ï¼Œå‡†å¤‡æŒ‰æ–‡ä¸­é€»è¾‘æ¨æ¼”æå‡ºé—®é¢˜ï¼Œç»“æœæ¨ç€æ¨ç€â€œè¡Œé”å†²çªâ€è‡ªå·±å°±å‡ºæ¥äº†ï¼Œå¼•èµ·æåº¦èˆ’é€‚","like_count":0},{"had_liked":false,"id":113501,"user_name":"chenpiing","can_delete":false,"product_type":"c1","uid":1357056,"ip_address":"","ucode":"C847A30B3FDB8F","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/00/f4e8fbaf.jpg","comment_is_top":false,"comment_ctime":1563035715,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563035715","product_id":100020801,"comment_content":"å…³äºä¸¤é˜¶æ®µæäº¤ä¸­prepareé˜¶æ®µé˜¶æ®µçš„ç–‘é—®<br><br>è¯·é—®prepareé˜¶æ®µæ˜¯ä¼šå°†ä¸€æ¡redoæ—¥å¿—å†™å…¥åˆ°redologä¸­å¹¶æ ‡è®°ä¸ºprepareï¼Œç„¶åäº‹åŠ¡æäº¤æˆåŠŸæ—¶å†å›redologä¸­æ‰¾åˆ°åˆšæ‰é‚£æ¡æ—¥å¿—æŠŠå®ƒæ ‡è®°ä¸ºcommitå—ï¼Ÿå¦‚æœåœ¨æ­¤æœŸé—´ç”±äºå…¶ä»–äº‹åŠ¡çš„æäº¤ä½¿å¾—redologçš„write poså¾€å‰æ¨äº†ä¸å°‘ï¼Œä¹‹å‰é‚£æ¡æ ‡è®°ä¸ºprepareçŠ¶æ€çš„redo logæ€ä¹ˆæ‰¾å‡ºæ¥å¹¶æ ‡ä¸ºcommitå‘¢ï¼Ÿ<br><br>è¿™é‡Œä¸æ˜¯å¾ˆç†è§£ï¼Œå¸Œæœ›è€å¸ˆå¸®å¿™è§£æƒ‘ï¼Œè°¢è°¢","like_count":0},{"had_liked":false,"id":110336,"user_name":"Geek","can_delete":false,"product_type":"c1","uid":1466335,"ip_address":"","ucode":"1B8EB2C26DE4EC","user_header":"https://static001.geekbang.org/account/avatar/00/16/5f/df/3c4881f0.jpg","comment_is_top":false,"comment_ctime":1562232085,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1562232085","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸‹ç¤¾äº¤å…³ç³»å»ºç«‹è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œè¿™ç§å¯ä»¥äº’ç›¸åŠ å¥½å‹çš„ä¸šåŠ¡ä¼šå¯¼è‡´æ•°æ®é‡éå¸¸å¤§ã€‚è¿™ç§æƒ…å†µä¸‹å¦‚ä½•è®¾è®¡è¡¨ç»“æ„å‘¢","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158861,"discussion_content":"æ•°æ®é‡å¤§ä¹Ÿå¯ä»¥æŒ‰ç…§æ­¤ç§è¡¨ç»“æ„æ¥è®¾è®¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580634627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109247,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1561987504,"is_pvip":false,"replies":[{"id":"39576","content":"æ·¡å®š~~å“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1562010178,"ip_address":"","comment_id":109247,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561987504","product_id":100020801,"comment_content":"äººä¸äººçš„å·®åˆ«æ ¸å¿ƒåœ¨äºè®¤çŸ¥ï¼ŒåŒæ ·æ˜¯äººåŒæ ·æ˜¯æŠ€æœ¯äººï¼Œä¸ºä»€ä¹ˆæœ‰äººæ˜¯å°ç™½ï¼Ÿä¸ºä»€ä¹ˆæœ‰äººæ˜¯å¤§ç¥ï¼Ÿæœ‰äººæœ‰è½¦æœ‰æˆ¿è¡£é£Ÿæ— å¿§ï¼Ÿæœ‰äººæ‹…å¿ƒè¢«è¾è¢«è£ï¼Ÿå¦‚æœæŠ€æœ¯å®åŠ›ï¼Œå¦‚æ—è€å¸ˆè¿™èˆ¬è¿˜ä¼šæœ‰è¿™ç§æ‹…å¿§å—ï¼Ÿ<br>ä¸ºä»€ä¹ˆå·®è·è¿™ä¹ˆå¤§å‘¢ï¼Ÿå¤©èµ‹ï¼ŸåŠªåŠ›ï¼Ÿå°±æ˜¯æ²¡åˆ«äººèªæ˜æ€ä¹ˆåŠï¼Ÿå°±æ˜¯æ²¡åˆ«äººå­¦ä¹ èƒ½åŠ›å¼ºæ€ä¹ˆåŠï¼ŸåŒæ ·çš„ä¸“æ å†…å®¹æœ‰äººè§‰å¾—å°å„¿ç§‘å¤ªè¿‡ç®€å•è¦æ±‚åœ¨æ·±å…¥ä¸€äº›ï¼Ÿæœ‰äººä¸€è„¸æ‡µé€¼å®Œå…¨ä¸çŸ¥æ‰€ä»¥ç„¶ï¼Ÿ<br>é‚£å’‹å¼„ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œæˆ‘åªçŸ¥é“äººå’Œäººæœ¬æ¥å°±æ˜¯æœ‰å·®å¼‚çš„ï¼Œäººæ— å®Œäººï¼Œè‡ªèº«æ›´ä¸ä¾‹å¤–ï¼ŒåŸºç¡€ä¸å¥½è¡¥åŸºç¡€ï¼Œä¸€éä¸ä¼šç¬¬äºŒéï¼Œä¿æŒå¿ƒæ€å¹³å’Œï¼Œå¤šæ€è€ƒå¤šæƒ³æƒ³éƒ­é–ã€‚<br>ç°åœ¨æ„Ÿè§‰è€å¸ˆå°±æ˜¯é©¬é’°ï¼","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456320,"discussion_content":"æ·¡å®š~~å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562010178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1022507,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOpANMwDibLmj5IGJh6dTw300sZ1BHM5sG3sZv1A1rvCHOiblPD3jgFOiaMVVujtctWnQbVFoNPpRgw/132","nickname":"alioo","note":"","ucode":"F36A38C1F5FFAB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7701,"discussion_content":"ä¸ºä»€ä¹ˆå·®è·è¿™ä¹ˆå¤§å‘¢ï¼Ÿå¤©èµ‹ï¼ŸåŠªåŠ›ï¼Ÿâ€”>æˆ‘æ¯”è¾ƒå¥½å¥‡ä½ æœ€åå¾—å‡ºçš„ç»“è®ºæ˜¯å•¥?ä½ è§‰å¾—å¤©èµ‹å’ŒåŠªåŠ›å“ªä¸ªæ›´é‡è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567645682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108423,"user_name":"å¾®ç¬‘","can_delete":false,"product_type":"c1","uid":1363834,"ip_address":"","ucode":"6E8E2964D0191F","user_header":"https://static001.geekbang.org/account/avatar/00/14/cf/7a/51951b07.jpg","comment_is_top":false,"comment_ctime":1561769551,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1561769551","product_id":100020801,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆ å†™ç›˜å’Œfsyncæ˜¯å•¥åŒºåˆ«  å†™ç›˜å°±å·²ç»è½ç›˜äº†å§  å¹²å˜›è¿˜è¦fsync","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158866,"discussion_content":"è½ç›˜æ˜¯ä¸€ç§æ¦‚å¿µï¼Œfsyncæ˜¯å®ç°çš„ä¸€ç§æ–¹å¼å§ã€‚ä¸ªäººè¿™ä¹ˆç†è§£å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101854,"user_name":"ã€€ã€€","can_delete":false,"product_type":"c1","uid":1560563,"ip_address":"","ucode":"0D736D44A24C56","user_header":"https://static001.geekbang.org/account/avatar/00/17/cf/f3/48fc6781.jpg","comment_is_top":false,"comment_ctime":1559997826,"is_pvip":false,"replies":[{"id":"36690","content":"æ–‡ç« å’Œé—®é¢˜ä¸­çš„ä¾‹å­å®éªŒä¸€ä¸‹ï¼Œçœ‹çœ‹å¥½ä¸å¥½å¥½äº›ï¼Œåç«¯å¼€å‘å·¥ç¨‹å¸ˆè¿˜æ˜¯è¿Ÿæ—©è¦æ¥è§¦è¿™äº›çš„<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1560003500,"ip_address":"","comment_id":101854,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559997826","product_id":100020801,"comment_content":"è€å¸ˆ æˆ‘æ˜¯åªæœ‰ä¸€å¹´å·¥ä½œç»éªŒçš„åç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œçœ‹äº†å‰é¢çš„15èŠ‚è¯¾ç¨‹ ï¼Œç»™æˆ‘çš„æ„Ÿè§‰ååˆ†çš„å¤æ‚ï¼Œç´¢å¼•å’Œè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹æˆ‘èƒ½å¤Ÿå¬æ‡‚ï¼Œä½†æ˜¯åœ¨å…³äºæ—¥å¿—ç‰‡çš„è¯¾ç¨‹ä¸­ï¼Œæ„Ÿè§‰åˆ°å‹åŠ›çœŸçš„å¥½å¤§ï¼ŒåŸºæœ¬ä¸Šéƒ½å¬ä¸æ‡‚ï¼Œæ‰€ä»¥æˆ‘æƒ³å’¨è¯¢ä¸€ä¸‹è€å¸ˆæ‚¨ï¼Œå¯¹äºæˆ‘ç›®å‰çš„è¿™ç§æƒ…å†µæœ‰å¿…é¡»ç»§ç»­å¾€ä¸‹å¬ä¸‹å»å— ï¼Ÿæˆ‘å†åšæŒ ä½†æ˜¯å¾ˆå¤šåœ°æ–¹éƒ½å¾ˆéš¾ç†è§£æˆ–è€…è¯´å¾ˆéš¾åœ¨ç°å®çš„æƒ…å†µä¸‹å»å®ç°è¿™ç§äº‹æƒ…ï¼Œ ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453145,"discussion_content":"æ–‡ç« å’Œé—®é¢˜ä¸­çš„ä¾‹å­å®éªŒä¸€ä¸‹ï¼Œçœ‹çœ‹å¥½ä¸å¥½å¥½äº›ï¼Œåç«¯å¼€å‘å·¥ç¨‹å¸ˆè¿˜æ˜¯è¿Ÿæ—©è¦æ¥è§¦è¿™äº›çš„\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560003500,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98642,"user_name":"ZHANG","can_delete":false,"product_type":"c1","uid":1442437,"ip_address":"","ucode":"BAFD110AE33328","user_header":"https://static001.geekbang.org/account/avatar/00/16/02/85/9a81a973.jpg","comment_is_top":false,"comment_ctime":1559047614,"is_pvip":false,"replies":[{"id":"35318","content":"ğŸ‘å¿«ä¹æœ€èµ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1559060797,"ip_address":"","comment_id":98642,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559047614","product_id":100020801,"comment_content":"å­¦ä¹ çš„æœ€å¿«ä¹çš„ä¸€ä¸ªä¸“æ ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451768,"discussion_content":"ğŸ‘å¿«ä¹æœ€èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559060797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96014,"user_name":"Socket","can_delete":false,"product_type":"c1","uid":1313213,"ip_address":"","ucode":"932CF3D692FFB5","user_header":"https://static001.geekbang.org/account/avatar/00/14/09/bd/cc31c95d.jpg","comment_is_top":false,"comment_ctime":1558312818,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558312818","product_id":100020801,"comment_content":"é—®ä¸€ä¸ªé—®é¢˜mvccå’Œredologæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿè¿½é—®9ä¸­æåˆ°äº‹åŠ¡è¿˜æ²¡æäº¤å‰ï¼Œæ’å…¥çš„æ•°æ®æ˜¯ä¸ä¼šå†™å…¥åˆ°redologã€‚é‚£ä¹ˆä¸€ä¸ªé•¿äº‹åŠ¡ä¸­æœ‰è®¸å¤šæ’å…¥å’Œæ›´æ–°è¿™äº›æ•°æ®éƒ½å†™å»å“ªé‡Œå‘¢ï¼Ÿæ€ä¹ˆåšåˆ°å¤šç‰ˆæœ¬æ§åˆ¶ï¼Ÿå¦‚æœä¸å†™åˆ°redologæ€ä¹ˆåšåˆ°äº‹åŠ¡å›æ»š","like_count":0},{"had_liked":false,"id":96000,"user_name":"GLADIATOR","can_delete":false,"product_type":"c1","uid":1448564,"ip_address":"","ucode":"6FE14E0BCD6240","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/74/8f7f8786.jpg","comment_is_top":false,"comment_ctime":1558309212,"is_pvip":false,"replies":[{"id":"36699","content":"å…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯ä¸€å¼€å§‹æ²¡è¿™ä¹ˆåš","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1560003896,"ip_address":"","comment_id":96000,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1558309212","product_id":100020801,"comment_content":"ç›´æ¥å½’æ¡£redologä¸è¡Œå—","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":450675,"discussion_content":"å…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯ä¸€å¼€å§‹æ²¡è¿™ä¹ˆåš","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560003896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1302064,"avatar":"https://static001.geekbang.org/account/avatar/00/13/de/30/b468b41d.jpg","nickname":"åŒ—è½ç‹®é—¨","note":"","ucode":"C5A951170001B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12972,"discussion_content":"8.0.17æ¢å¤äº†redologçš„å½’æ¡£åŠŸèƒ½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568622481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93172,"user_name":"ã€€","can_delete":false,"product_type":"c1","uid":1172538,"ip_address":"","ucode":"DBE2DB5CC52C91","user_header":"https://static001.geekbang.org/account/avatar/00/11/e4/3a/16545faf.jpg","comment_is_top":false,"comment_ctime":1557413706,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557413706","product_id":100020801,"comment_content":"åé¢çš„ä¾‹å­ä¸­<br><br>è¿™ä¸ªAã€Bå…³æ³¨çš„å…³ç³»ï¼ˆç”±ç”¨æˆ·ç‚¹å‡»çš„ï¼‰åœ¨æ•°æ®åº“é€»è¾‘ä¸­ä¸ºä»€ä¹ˆè·Ÿidå¤§å°æŒ‚é’©äº†ï¼Ÿåé¢çš„SQLè¯­å¥ä¹Ÿä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆè¦é‚£æ ·åšï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158867,"discussion_content":"å› ä¸ºa<bä¸º1ï¼Œa>bä¸º2ï¼Œå¤§äºå°äºåªæ˜¯ä¸€ç§å…³æ³¨å…³ç³»ï¼Œä½†æ˜¯å”¯ç´¢å¼•æ˜¯userid_likeridçš„å‰åå…³ç³»ï¼Œæ‰€ä»¥è¿™ç§å‰åä¸èƒ½å˜ï¼Œå˜çš„å°±æ˜¯å…³æ³¨å…³ç³»ï¼Œå› ä¸ºUKçš„å­˜åœ¨ï¼Œå¹¶å‘è§£å†³äº†ï¼Œç„¶åå‰©ä¸‹çš„å°±æ˜¯å½“è®°å½•ä¸­æœ‰1æˆ–è€…2æ—¶ï¼Œæ‰§è¡Œåˆ°ç¬¬äºŒæ­¥æ—¶å°±ç›¸å½“äºäº’ç›¸å…³æ³¨äº†ï¼Œæ­¤æ—¶æ”¹æˆ3ï¼ŒåŒæ—¶å‘friendè¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92150,"user_name":"Jason","can_delete":false,"product_type":"c1","uid":1306334,"ip_address":"","ucode":"B2F2E2F28397BC","user_header":"https://static001.geekbang.org/account/avatar/00/13/ee/de/eb2baece.jpg","comment_is_top":false,"comment_ctime":1557192125,"is_pvip":false,"replies":[{"id":"34320","content":"é€»è¾‘å°±æ˜¯è¯´ï¼Œ<br>å¦‚æœå…è®¸redo logå†™å®Œï¼Œå†å†™binlogï¼Œé‚£æ„å‘³ç€ï¼Œredo logå†™å®Œä»¥åï¼Œå°±ä¸è®©å›æ»šäº†ï¼›<br><br><br>é‚£binlogå†™å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br><br>è¿™ä¸ªæ„æ€å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1558261577,"ip_address":"","comment_id":92150,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557192125","product_id":100020801,"comment_content":"è€å¸ˆä½ çš„è¿½é—®4å¹¶ä¸èƒ½è‡ªåœ†å…¶è¯´å•Šã€‚<br><br>é—®çš„æ˜¯redo logå†™å®Œï¼Œå†å†™binlogï¼Œæœ€åæ‰æäº¤äº‹åŠ¡ï¼Œä¸ºä½•ä¸å¯ã€‚è€å¸ˆæ€ä¹ˆè§£é‡Šæˆï¼Œredo logå†™å®Œå°±æäº¤ï¼Œç„¶åbinlogå†™å¤±è´¥çš„æƒ…å†µäº†","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449160,"discussion_content":"é€»è¾‘å°±æ˜¯è¯´ï¼Œ\nå¦‚æœå…è®¸redo logå†™å®Œï¼Œå†å†™binlogï¼Œé‚£æ„å‘³ç€ï¼Œredo logå†™å®Œä»¥åï¼Œå°±ä¸è®©å›æ»šäº†ï¼›\n\n\né‚£binlogå†™å¤±è´¥æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\nè¿™ä¸ªæ„æ€å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558261577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89391,"user_name":"~ç²ç²ç²~å­~å“¥~","can_delete":false,"product_type":"c1","uid":1302741,"ip_address":"","ucode":"89379F3A0427EA","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/d5/7485e51f.jpg","comment_is_top":false,"comment_ctime":1556163002,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556163002","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½,åœ¨è·Ÿç€åšå®éªŒæ—¶,å¯¹å¥½å‹å…³æ³¨è¡¨æœ‰ç–‘é—®<br>å»ºè¡¨è¯­å¥`user_id` å’Œ `liker_id`éƒ½æ˜¯int(11),ä½†æ˜¯å®ä¾‹è¯­å¥æ˜¯<br>select relation_ship from `like` where user_id=A and liker_id=B;<br>å¦‚æœlikeè¡¨å­—æ®µéƒ½ä¸ºint, å‡è®¾user_idä¸º1å’Œ3çš„ä¸¤ä¸ªç”¨æˆ·ç›¸äº’å…³æ³¨æ¨¡æ‹Ÿå¦‚ä¸‹:<br>##session A<br>mysql&gt; begin;<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; insert into `like`(user_id, liker_id, relation_ship) values(1, 3, 1) on duplicate key update relation_ship=relation_ship | 1;<br>Query OK, 1 row affected (0.00 sec)<br><br>mysql&gt; select relation_ship from `like` where user_id=1 and liker_id=3;<br>+---------------+<br>| relation_ship |<br>+---------------+<br>|             1 |<br>+---------------+<br>1 row in set (0.00 sec)<br><br>##åœ¨æäº¤å‰åˆ‡æ¢åˆ°SESSION B<br>mysql&gt; begin;<br>Query OK, 0 rows affected (0.00 sec)<br><br>mysql&gt; insert into `like`(user_id, liker_id, relation_ship) values(3, 1, 2) on duplicate key  update relation_ship=relation_ship | 2;<br>Query OK, 1 row affected (53.42 sec)<br>æ³¨:è¿™æ—¶ç”±äºSESSION Aè¿˜æ²¡æœ‰æäº¤è¿›å…¥é”ç­‰å¾…, Aæäº¤åæ’å…¥æˆåŠŸ(53ç§’åŸå› æ˜¯ç­‰å¾…session A)<br><br>mysql&gt; select relation_ship from `like` where user_id=3 and liker_id=1;<br>+---------------+<br>| relation_ship |<br>+---------------+<br>|             2 |<br>+---------------+<br>1 row in set (0.00 sec)<br><br>1.è¿™é‡Œæœ‰è€å¸ˆè¯´çš„&quot;å¦‚æœåå‘çš„å…³ç³»å·²ç»å­˜åœ¨,å°±ä¼šå‡ºç°è¡Œé”å†²çª&quot;<br>ä½†æ˜¯on duplicate keyå´æ²¡æœ‰ç”Ÿæ•ˆ. ä¸çŸ¥é“å…¶ä¸­ç¼˜ç”±<br><br><br>2.insert ignore into friend(friend_1_id, friend_2_id) values(A,B)| values(B,A);<br>è®¾è®¡åˆå°±æ˜¯æƒ³é€šè¿‡friendè¡¨æŸ¥çœ‹æ˜¯å¦æ˜¯å¥½å‹, ä½†æ˜¯è¿™ç§æ’å…¥æ–¹å¼,æŸ¥çœ‹æ˜¯å¦æ˜¯å¥½å‹æ—¶,æ˜¯ä¸æ˜¯å°±åœ°å†™æˆ:<br>select * from friedn where (friend_1_id=A and  friend_2_id=B) or (friend_1_id=B and  friend_2_id=A);<br>è¿™æ ·åè€Œå½±å“æŸ¥è¯¢æ•ˆç‡äº†. <br><br>3.è¿˜æœ‰è¿™å¥&quot;è¿™ä¸ªè®¾è®¡é‡Œ,è®©&#39;like&#39;è¡¨é‡Œçš„æ•°æ®ä¿è¯user_id&lt;liker_id&quot; é€šè¿‡ä»€ä¹ˆæ¥ä¿è¯<br><br>","like_count":0},{"had_liked":false,"id":88818,"user_name":"å¾®å¾®ä¸€ç¬‘","can_delete":false,"product_type":"c1","uid":1250327,"ip_address":"","ucode":"CFA7ABE81D0B99","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/17/8763dced.jpg","comment_is_top":false,"comment_ctime":1556007716,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556007716","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªé—®é¢˜å¸Œæœ›ä½ èƒ½è§£ç­”ä¸‹ã€‚å½“æœåŠ¡å¼‚å¸¸é‡å¯æ—¶ï¼Œredologçš„checkpointä¼šå¾€åæ‰«ï¼Œå°†æ•°æ®é¡µåŠ è½½åˆ°å†…å­˜ä¸­ã€‚é—®é¢˜1ï¼Œcheckpointå¾€åæ‰«åˆ°å“ªé‡Œåœæ­¢å‘¢ï¼Ÿè¿˜æ˜¯æŠŠæ‰€æœ‰çš„redologéƒ½æ‰«å®Œï¼Ÿé—®é¢˜2ï¼šåœ¨å¾€åæ‰«çš„è¿‡ç¨‹ä¸­ï¼Œè¦å°†æ•°æ®åŠ è½½åˆ°bufferpoolä¸­ï¼Œå¦‚æœåŠ è½½è¿‡å¤šï¼Œå¯¼è‡´å†…å­˜ä¸å¤Ÿäº†è‚¿ä¹ˆåŠå‘¢ï¼Ÿåœä¸‹æ¥è¿›è¡Œåˆ·è„é¡µå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":88353,"user_name":"è‹¦è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1142081,"ip_address":"","ucode":"B77968684C1A51","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/41/3e1c2485.jpg","comment_is_top":false,"comment_ctime":1555909483,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1555909483","product_id":100020801,"comment_content":"è€å¸ˆ æˆ‘æƒ³é—®ä¸‹ï¼Œå¦‚æœä¸€å¼ è¡¨Tæœ‰ a,b,cä¸‰ä¸ªå­—æ®µï¼Œå”¯ä¸€ç´¢å¼•æ˜¯ï¼ˆaï¼Œbï¼Œcï¼‰,æ™®é€šç´¢å¼•æ˜¯(c),å½“æˆ‘select * from T where a = &quot;a&quot; and c=&quot;c&quot;,è¿™ä¸ªæ—¶å€™ï¼Œè¿™æ¡è¯­å¥èµ°çš„ç´¢å¼•æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158870,"discussion_content":"è¯´æ˜cè¿™ä¸ªç´¢å¼•çš„æ‰«æè¡Œæ•°æ¯”å”¯ä¸€ç´¢å¼•å°‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83670,"user_name":"dz617","can_delete":false,"product_type":"c1","uid":1221366,"ip_address":"","ucode":"5952846AB16744","user_header":"","comment_is_top":false,"comment_ctime":1554695402,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554695402","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œè¿™é‡Œè¯´åˆ°redo logçš„è½ç›˜ï¼Œæƒ³é—®ä¸‹undologæœ‰æ²¡æœ‰è½ç›˜è¿™ä¸ªæ¦‚å¿µï¼Ÿå¦‚æœæ²¡æœ‰çš„è¯ï¼Œè°ƒç”¨undoå›æ»šåˆæ˜¯æ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿ5.7ä»¥åundologä¹Ÿæœ‰è‡ªå·±çš„ç‹¬ç«‹ç‰©ç†æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢å­˜çš„åˆæ˜¯ä»€ä¹ˆå†…å®¹å‘¢ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":83439,"user_name":"æ¢¦æƒ³","can_delete":false,"product_type":"c1","uid":1286059,"ip_address":"","ucode":"71DE16FC85D868","user_header":"https://static001.geekbang.org/account/avatar/00/13/9f/ab/1b0dfa68.jpg","comment_is_top":false,"comment_ctime":1554601042,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1554601042","product_id":100020801,"comment_content":"&quot;æ•°æ®è½ç›˜ï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œç”šè‡³ä¸ redo log æ¯«æ— å…³ç³»&quot; è€å¸ˆè¿™æ€ä¹ˆç†è§£ï¼Ÿredologoä¸æ˜¯ç²‰æ¿å—ï¼Ÿæ€ä¹ˆå†™æ•°æ®è·Ÿä»–æ²¡å…³ç³»äº†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158873,"discussion_content":"è½ç›˜å†™æ•°æ®é å†…å­˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83419,"user_name":"darwin","can_delete":false,"product_type":"c1","uid":1368090,"ip_address":"","ucode":"2F93C0881AAC7B","user_header":"https://static001.geekbang.org/account/avatar/00/14/e0/1a/3a77856a.jpg","comment_is_top":false,"comment_ctime":1554569057,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1554569057","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæƒ³é—®é—®è¿˜æœ‰å¾ˆå¤šå…¬å¸æœ‰å¼‚æ„ç³»ç»Ÿï¼ˆæ¯”å¦‚ä¸€äº›æ•°æ®åˆ†æç³»ç»Ÿï¼‰ï¼Œè¿™äº›å¼‚æ„ç³»ç»Ÿè·Ÿmysqlæ˜¯æ€ä¹ˆå®ç°æ•°æ®åŒæ­¥çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158874,"discussion_content":"å·¥å…·è§£æbinlogå§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":82428,"user_name":"å˜»å˜»","can_delete":false,"product_type":"c1","uid":1325931,"ip_address":"","ucode":"E1EB75DD1C05E0","user_header":"","comment_is_top":false,"comment_ctime":1554208138,"is_pvip":false,"replies":[{"id":"30158","content":"prepareçš„æ—¶å€™å°±è¦è½ç›˜ä¸€æ¬¡çš„å“ˆï¼ˆå°±æ˜¯åŒ…å«äº†ä¸€æ¬¡å†™æ•°æ®åˆ°ç›˜ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1554616535,"ip_address":"","comment_id":82428,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1554208138","product_id":100020801,"comment_content":"è€å¸ˆï¼Œredo log bufferé‚£æ®µæœ‰ç–‘é—®ï¼Œå¦‚æœredo logå…ˆå†™å†…å­˜ï¼Œcommitæ‰å†™æ–‡ä»¶ï¼Œé‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜å­˜åœ¨å†™äº†prepareå’Œbinlogçš„åœºæ™¯ï¼Ÿbinlogä¹Ÿä¸æ˜¯ç›´æ¥å†™ç£ç›˜(sync_binlog=1)?","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445585,"discussion_content":"prepareçš„æ—¶å€™å°±è¦è½ç›˜ä¸€æ¬¡çš„å“ˆï¼ˆå°±æ˜¯åŒ…å«äº†ä¸€æ¬¡å†™æ•°æ®åˆ°ç›˜ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554616535,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81562,"user_name":"å”¯å¥¹å‘½","can_delete":false,"product_type":"c1","uid":1240398,"ip_address":"","ucode":"8F687E8D306840","user_header":"https://static001.geekbang.org/account/avatar/00/12/ed/4e/ef406442.jpg","comment_is_top":false,"comment_ctime":1553946978,"is_pvip":false,"replies":[{"id":"29640","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1554047622,"ip_address":"","comment_id":81562,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553946978","product_id":100020801,"comment_content":"çœ‹å®Œåé¢çš„ç« èŠ‚ï¼Œå†å›æ¥çœ‹è¿™ä¸€ç¯‡ï¼Œè±ç„¶å¼€æœ—å•Šï¼Œå¥½å¤šéƒ½åœ¨åé¢ç« èŠ‚è®²åˆ°äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445254,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554047622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78768,"user_name":"å–ä¸€ä¸ªé•¿é•¿é•¿é•¿çš„åå­—","can_delete":false,"product_type":"c1","uid":1387521,"ip_address":"","ucode":"8C39641B6EBCA1","user_header":"https://static001.geekbang.org/account/avatar/00/15/2c/01/636452b4.jpg","comment_is_top":false,"comment_ctime":1553236709,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1553236709","product_id":100020801,"comment_content":"ä¸šåŠ¡è®¾è®¡é—®é¢˜ï¼Œæˆ‘è§‰å¾—å…¶å®ä¸ç”¨é‚£ä¹ˆå¤æ‚ï¼Œå…¶å®åœ¨ä¸šåŠ¡ä»£ç ä¸­æŠŠinsert into `like`(user_id,lile_id) values(A,B)æ”¾åœ¨å‰é¢ï¼Œselect * form `like` where user_id = B and like_id = Aæ”¾åœ¨åé¢å»æ‰§è¡Œæ˜¯ä¸æ˜¯å°±è§£å†³äº†å‘¢ï¼Ÿå…¶å®è¿™ä¸ªé—®é¢˜æˆ‘è§‰å¾—è¿˜åº”å½“è¦å»è€ƒè™‘æ•°æ®åº“çš„ä¸»ä»åŒæ­¥çš„é—®é¢˜ï¼Œselectå¦‚æœæŸ¥è¯¢çš„æ˜¯ä»åº“çš„ä¹Ÿè¯ï¼Œä¹Ÿæœ‰å¯èƒ½ç”±äºä¸»ä»å»¶è¿Ÿï¼Œå¯¼è‡´æŸ¥è¯¢æ•°æ®ä¸ç¬¦åˆé€¾æœŸã€‚","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158880,"discussion_content":"é‚£å¦‚æœæ°å¥½å¹¶å‘æ—¶ï¼Œselect * form `like` where user_id = B and like_id = Aæ²¡æœ‰ï¼Œè¿”å›åï¼Œé©¬ä¸Šè¿›æ¥è¿™ç§å…³ç³»çš„ä¸€æ¡æ•°æ®ï¼Œå²‚ä¸æ˜¯åˆ¤æ–­ä¸å‡ºæ¥äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78017,"user_name":"cam","can_delete":false,"product_type":"c1","uid":1195618,"ip_address":"","ucode":"5C111E4914E0FA","user_header":"https://static001.geekbang.org/account/avatar/00/12/3e/62/d02d8f86.jpg","comment_is_top":false,"comment_ctime":1553055081,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553055081","product_id":100020801,"comment_content":"èµèµèµ","like_count":0},{"had_liked":false,"id":78005,"user_name":"ç½—é£","can_delete":false,"product_type":"c1","uid":1032310,"ip_address":"","ucode":"DA28B6D24A583E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c0/76/12203657.jpg","comment_is_top":false,"comment_ctime":1553052705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553052705","product_id":100020801,"comment_content":"è¿™äº›é—®é¢˜ï¼Œåªè¦æŠŠæ•°æ®åº“å®ç°åŸç†åŠjim gray çš„äº‹åŠ¡å¤„ç†è¯»ä¸€éï¼Œå…¨éƒ¨é€šé€ï¼ ","like_count":0},{"had_liked":false,"id":77348,"user_name":"æ‚Ÿç©ºWuKong","can_delete":false,"product_type":"c1","uid":1139455,"ip_address":"","ucode":"49AFD2B048C1BA","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/ff/f71034e9.jpg","comment_is_top":false,"comment_ctime":1552910563,"is_pvip":false,"replies":[{"id":"28807","content":"|  æ˜¯æŒ‰ä½æˆ–","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1553340125,"ip_address":"","comment_id":77348,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1552910563","product_id":100020801,"comment_content":"è¯·é—®è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼š... on duplicate key update relation_ship=relation_ship | 2;<br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443692,"discussion_content":"|  æ˜¯æŒ‰ä½æˆ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553340125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76735,"user_name":"æµªè¿¹å¤©æ¶¯çš„èœ—ç‰›","can_delete":false,"product_type":"c1","uid":1462230,"ip_address":"","ucode":"ABB3D1C542F777","user_header":"https://static001.geekbang.org/account/avatar/00/16/4f/d6/8371b5c3.jpg","comment_is_top":false,"comment_ctime":1552698336,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1552698336","product_id":100020801,"comment_content":"å…³äºredoæ—¥å¿—å’Œbinlogçš„ä¸¤é˜¶æ®µæœ‰ç‚¹æ²¡å¤ªæ˜ç™½ï¼Œå¦‚æœäº‹åŠ¡çš„æœ€åé˜¶æ®µæ˜¯rollbackï¼Œä½†æ˜¯ä½ çš„binlogå·²ç»å†™å…¥äº†ï¼Œè¿™æ—¶ä¸å°±ä¼šä¸ä¸€è‡´å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158885,"discussion_content":"æœ€årollbackè¯´æ˜ä¸€æ˜¯çœŸçš„è¦æ‰§è¡Œå›æ»šï¼Œåæ­£ä¸æ˜¯commitï¼›äºŒæ˜¯binlogæœ‰å¯èƒ½ä¸å®Œæ•´ï¼Œéœ€è¦å›æ»šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74941,"user_name":"å”¯å¥¹å‘½","can_delete":false,"product_type":"c1","uid":1240398,"ip_address":"","ucode":"8F687E8D306840","user_header":"https://static001.geekbang.org/account/avatar/00/12/ed/4e/ef406442.jpg","comment_is_top":false,"comment_ctime":1552317322,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1552317322","product_id":100020801,"comment_content":"binlog ä¸æ˜¯ä¿å­˜äº†sqlçš„æ‰§è¡Œé€»è¾‘å—ï¼Œä¸åº”è¯¥æ˜¯æƒ³æ€ä¹ˆæ¢å¤å°±æ€ä¹ˆæ¢å¤å—ï¼Œé‚£ä¸ºä»€ä¹ˆä¸€ç›´è¯´ â€œæ²¡æœ‰ä¿¡æ¯â€","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158886,"discussion_content":"binlogå­˜çš„æ˜¯è¡Œä¿¡æ¯ï¼Œredologæ˜¯é¡µä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580635807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":74835,"user_name":"å”¯å¥¹å‘½","can_delete":false,"product_type":"c1","uid":1240398,"ip_address":"","ucode":"8F687E8D306840","user_header":"https://static001.geekbang.org/account/avatar/00/12/ed/4e/ef406442.jpg","comment_is_top":false,"comment_ctime":1552302851,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552302851","product_id":100020801,"comment_content":"è€å¸ˆï¼Œbinlog é‡Œé¢å¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ›´æ–°ç»†èŠ‚   binlogé‡Œé¢ä¸æ˜¯ä¿å­˜äº†sqlæ‰§è¡Œé€»è¾‘å—ï¼Œä¸ºå•¥è¯´binlog é‡Œé¢å¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„æ›´æ–°ç»†èŠ‚ï¼Ÿ","like_count":0},{"had_liked":false,"id":73300,"user_name":"ã€‚","can_delete":false,"product_type":"c1","uid":1222200,"ip_address":"","ucode":"75B163F01F20F3","user_header":"https://static001.geekbang.org/account/avatar/00/12/a6/38/55483b8c.jpg","comment_is_top":false,"comment_ctime":1551854223,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1551854223","product_id":100020801,"comment_content":"æ—è€å¸ˆï¼Œå…³æ³¨å…³ç³»é‚£ä¸ªä¾‹å­ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ†å¸ƒå¼é”çš„æ–¹æ¡ˆè§£å†³å§ï¼Ÿæ¯”å¦‚redis","like_count":0},{"had_liked":false,"id":73016,"user_name":"å…«æ€ª","can_delete":false,"product_type":"c1","uid":1328234,"ip_address":"","ucode":"A9200AC057BDAD","user_header":"https://static001.geekbang.org/account/avatar/00/14/44/6a/49f026af.jpg","comment_is_top":false,"comment_ctime":1551777768,"is_pvip":false,"replies":[{"id":"26576","content":"Rowæ ¼å¼çš„binlogçš„è¯ï¼Œæ˜¯ä¸è°ƒç”¨çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1551814962,"ip_address":"","comment_id":73016,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1551777768","product_id":100020801,"comment_content":"percona 5.7.22ç‰ˆæœ¬æºç <br>ä¸å¥‡è€å¸ˆï¼Œæˆ‘ç®€å•åšäº†ä¸€ä¸‹debugå‘ç°è¿™ç§æƒ…å†µä¸ä¼šè°ƒç”¨table-&gt;file-&gt;ha_update_rowè¿›å…¥innodbå±‚è¿›è¡Œæ›´æ–°äº†å•Š<br>å½“ç„¶æ‰«ææ•°æ®åŠ é”è‚¯å®šæ˜¯è¦è¿›å…¥innodbå±‚ç„¶åè·å–æ•°æ®çš„ï¼Œmysqlå±‚å‘ç°ä¸¤ä¸ªå€¼æ˜¯ç›¸åŒçš„å°±ä¸è°ƒç”¨äº†ã€‚<br>æ„Ÿè§‰åƒæ˜¯innodbå±‚åŠ é”è·å–æ•°æ®å›mysqlå±‚è¿›è¡Œæ¯”è¾ƒï¼Œmysqlå±‚å‘ç°ç›¸åŒä¸å†è°ƒç”¨ha_update_rowæ¥å£äº†ä¸çŸ¥é“å¯¹å¦ã€‚<br>æˆ‘æ‰“äº†æ–­ç‚¹å¦‚ä¸‹ï¼š<br>row_upd_clust_step<br>row_upd<br>row_upd_step<br>row_update_for_mysql<br>ha_innobase::update_row<br>handler::ha_update_row<br>sql_update.cc:811<br><br>å‘ç°innodbå±‚çš„updateæ–¹æ³•éƒ½æ²¡è°ƒç”¨ï¼Œå…¶æ¬¡å‘ç°undo ä¹Ÿæ²¡æœ‰ç”Ÿæˆã€‚<br><br>debug sql_update.cc:811è¡Œå¼€å§‹å¦‚ä¸‹<br><br>(gdb) n<br>828             if (!records_are_comparable(table) || compare_records(table)) &#47;&#47;è¿™é‡Œmysqlå±‚æ¯”è¾ƒäº†è®°å½•ï¼Ÿè¿™é‡Œåˆ¤æ–­æ˜¯å¦è°ƒç”¨table-&gt;file-&gt;ha_update_row<br>(gdb) n<br>906             if (!error &amp;&amp; table-&gt;triggers &amp;&amp;<br>(gdb) n<br>914             if (!--limit &amp;&amp; using_limit)<br>(gdb) n<br>970           thd-&gt;get_stmt_da()-&gt;inc_current_row_for_condition();<br>(gdb) n<br>971           if (thd-&gt;is_error())<br>(gdb) n<br>809         while (true)<br>(gdb) n<br><br>Breakpoint 17, mysql_update (thd=0x7ffe7c000b70, fields=..., values=..., limit=18446744073709551614, handle_duplicates=DUP_ERROR, found_return=0x7fffec0f4bd8, <br>    updated_return=0x7fffec0f4bd0) at &#47;root&#47;mysqlall&#47;percona-server-locks-detail-5.7.22&#47;sql&#47;sql_update.cc:811<br>811           error= info.read_record(&amp;info);<br>(gdb) p compare_records(table)<br>$4 = false<br>(gdb) p records_are_comparable(table)<br>$5 = true<br>(gdb) <br><br>å¿˜è€å¸ˆçœ‹çœ‹ã€‚è°¢è°¢è€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441878,"discussion_content":"Rowæ ¼å¼çš„binlogçš„è¯ï¼Œæ˜¯ä¸è°ƒç”¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551814962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69434,"user_name":"ä¸æƒ‘ing","can_delete":false,"product_type":"c1","uid":1207079,"ip_address":"","ucode":"AF04E417D38027","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/27/8c964e52.jpg","comment_is_top":false,"comment_ctime":1550742614,"is_pvip":false,"replies":[{"id":"24987","content":"1.  redolog åŠ commitæ ‡è¯† &gt; binlog åŠ commitæ ‡è¯† ï¼Œ è¿™ä¸¤ä¸ªé¡ºåºè°ƒæ¢ä¸€ä¸‹<br><br>2. è¿½é—®5çš„å›ç­”çš„æ„æ€æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä¸¤é˜¶æ®µï¼Œredo logå…ˆæäº¤å®Œæˆå†å†™binlogçš„è¯ï¼Œå°±ä¼šå¯¼è‡´binlogå†™å…¥è¿‡ç¨‹å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ— æ³•å›æ»š<br><br>3. æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550996477,"ip_address":"","comment_id":69434,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550742614","product_id":100020801,"comment_content":"æ‚¨å¥½ï¼Œçœ‹å®Œåè¿˜æœ‰3ä¸ªç–‘é—®ä¸èƒ½ç¡®å®šï¼Œå¦‚æœçœ‹åˆ°ç•™è¨€å¸Œæœ›å¸®å¿™ç¡®è®¤ä¸€ä¸‹ï¼Œéå¸¸æ„Ÿè°¢<br><br>1.å›¾ä¸€ï¼šæœ€åcommitä¹‹åè¿˜ç»™redolog binlogå¢åŠ â€˜commitâ€™æ ‡è¯†ï¼Œå®Œæ•´æµç¨‹æ˜¯ ï¼š<br>å¼€å§‹commit &gt; redolog prepare &gt; binlog prepare &gt; è¿”å›äº‹ç‰©æäº¤æˆåŠŸ &gt; redolog åŠ commitæ ‡è¯† &gt; binlog åŠ commitæ ‡è¯†ã€‚<br>æ‰€ä»¥å¯¹åº”åˆ°æ–‡ç« ä¸­çš„2(a)çš„æƒ…å†µï¼Œè¿™ä¸ªç†è§£æœ‰é—®é¢˜ä¹ˆï¼Ÿ<br><br>2.è¿½é—®5ï¼šbinlog1ä¸¢å¤±çš„åŸå› æ˜¯å› ä¸ºæ•°æ®è¿˜åœ¨å†…å­˜æ²¡åˆ·åˆ°ç£ç›˜ï¼Ÿå¦‚æœè®¾ç½®innodb_flush_log_at_trx_commit=1 æ¯æ¬¡commitéƒ½åˆ·åˆ°ç£ç›˜æ˜¯ä¸æ˜¯å°±ä¸ä¼šä¸¢å¤±äº†ï¼Ÿè¿™ä¸ªä¸¤ä¸ªç†è§£æœ‰é—®é¢˜ä¹ˆï¼Ÿ<br><br>3.è¿½é—®5ï¼šæ ¹æ®â€˜å†å²åŸå› â€™é‚£æ®µæè¿°ç†è§£ï¼Œredologæ˜¯åœ¨InnerDBå¼•æ“å®ç°çš„  binlogæ˜¯åœ¨Serverå±‚å®ç°çš„ï¼Ÿè¿™ä¸ªç†è§£æœ‰é—®é¢˜ä¹ˆï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440120,"discussion_content":"1.  redolog åŠ commitæ ‡è¯† &amp;gt; binlog åŠ commitæ ‡è¯† ï¼Œ è¿™ä¸¤ä¸ªé¡ºåºè°ƒæ¢ä¸€ä¸‹\n\n2. è¿½é—®5çš„å›ç­”çš„æ„æ€æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä¸¤é˜¶æ®µï¼Œredo logå…ˆæäº¤å®Œæˆå†å†™binlogçš„è¯ï¼Œå°±ä¼šå¯¼è‡´binlogå†™å…¥è¿‡ç¨‹å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ— æ³•å›æ»š\n\n3. æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550996477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":69170,"user_name":"Jefitar","can_delete":false,"product_type":"c1","uid":1370659,"ip_address":"","ucode":"D7ED9F32ADA5B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/ea/23/508f71e3.jpg","comment_is_top":false,"comment_ctime":1550672682,"is_pvip":false,"replies":[{"id":"24559","content":"éƒ½è¦æ˜¯insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1; è¿™ä¹ˆå†™æ‰è¡Œå“¦<br><br>ä½ æ”¹äº†è¯­å¥å¯å°±ä¸ä¿è¯äº†ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550679709,"ip_address":"","comment_id":69170,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550672682","product_id":100020801,"comment_content":"æ„Ÿè°¢è€å¸ˆè¾›è‹¦åœ°è®²è§£ï¼æ¯ç¯‡æ–‡ç« éƒ½æœ‰æ”¶è·ï¼<br>å…³äºâ€œé‡å¤è°ƒç”¨æ—¶å¹‚ç­‰æ€§â€ï¼Œæˆ‘æ²¡ææ‡‚ã€‚ä»¥A&lt;Bä¸ºä¾‹ï¼Œä¸‹é¢çš„çš„ä¸¤æ¡è¯­å¥æ˜¯å¦‚ä½•ä¿è¯å¹‚ç­‰æ€§çš„ï¼Ÿ<br><br>insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1;<br>insert ignore into friend(friend_1_id, friend_2_id) values(A,B); ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439980,"discussion_content":"éƒ½è¦æ˜¯insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1; è¿™ä¹ˆå†™æ‰è¡Œå“¦\n\nä½ æ”¹äº†è¯­å¥å¯å°±ä¸ä¿è¯äº†ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550679709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67886,"user_name":"immortalCockroach","can_delete":false,"product_type":"c1","uid":1157912,"ip_address":"","ucode":"9A4F497BEA7DFB","user_header":"https://static001.geekbang.org/account/avatar/00/11/ab/18/b01e71d1.jpg","comment_is_top":false,"comment_ctime":1550310230,"is_pvip":false,"replies":[{"id":"24022","content":"å¯¹ï¼Œå°±æ˜¯åœ¨å´©æºƒçš„ç¬é—´ï¼Œç£ç›˜ä¸Šé‚£ä¸ªæ•°æ®é¡µ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550321349,"ip_address":"","comment_id":67886,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550310230","product_id":100020801,"comment_content":"è¿½é—®8ï¼šåœ¨å´©æºƒæ¢å¤åœºæ™¯ä¸­ï¼ŒInnoDB å¦‚æœåˆ¤æ–­åˆ°ä¸€ä¸ªæ•°æ®é¡µå¯èƒ½åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™ä¸¢å¤±äº†æ›´æ–°ï¼Œå°±ä¼šå°†å®ƒè¯»åˆ°å†…å­˜ï¼Œç„¶åè®© redo log æ›´æ–°å†…å­˜å†…å®¹ã€‚æ›´æ–°å®Œæˆåï¼Œå†…å­˜é¡µå˜æˆè„é¡µï¼Œå°±å›åˆ°äº†ç¬¬ä¸€ç§æƒ…å†µçš„çŠ¶æ€ã€‚<br><br>è¿™ä¸ª&quot;å°†å®ƒè¯»åˆ°å†…å­˜&quot;ä¸­çš„å®ƒæ˜¯åŸå§‹çš„è¡¨è®°å½•ä¿¡æ¯å—ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439411,"discussion_content":"å¯¹ï¼Œå°±æ˜¯åœ¨å´©æºƒçš„ç¬é—´ï¼Œç£ç›˜ä¸Šé‚£ä¸ªæ•°æ®é¡µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550321349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67725,"user_name":"ä¹¦è±ª","can_delete":false,"product_type":"c1","uid":1068091,"ip_address":"","ucode":"212FBDE59E8457","user_header":"https://static001.geekbang.org/account/avatar/00/10/4c/3b/2780fc51.jpg","comment_is_top":false,"comment_ctime":1550232917,"is_pvip":false,"replies":[{"id":"24013","content":"ä¸æ˜¯ï¼Œè¿™ä¸ªrelation_shipï¼Œå°±æ˜¯å­—æ®µåå“¦ï¼Œä¸ç”¨ä»£å…¥å‚æ•°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550299537,"ip_address":"","comment_id":67725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1550232917","product_id":100020801,"comment_content":"è€å¸ˆï¼Œåœ¨ä¸šåŠ¡è®¾è®¡é—®é¢˜ä¸­çš„å…³æ³¨é—®é¢˜ä¸­ï¼Œæ¯”å¦‚Aå°äºBçš„æƒ…å†µ<br>mysql&gt; begin; &#47;* å¯åŠ¨äº‹åŠ¡ *&#47;<br>insert into `like`(user_id, liker_id, relation_ship) values(A, B, 1) on duplicate key update relation_ship=relation_ship | 1;<br>select relation_ship from `like` where user_id=A and liker_id=B;<br>è¿™é‡Œçš„relation_ship=relation_ship | 1çš„relation_shipçš„å€¼æ˜¯ä»å“ªé‡Œå–å¾—çš„ï¼Œæ˜¯ä¸‹è¾¹selectè¯­å¥æ£€ç´¢å¾—åˆ°çš„å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œé‚£åº”è¯¥å°±æ˜¯æ’å…¥çš„å€¼1å§ï¼Ÿå°±æ˜¯å¯¹è¿™ä¸ªæ‰§è¡Œé€»è¾‘æœ‰ç‚¹ä¸æ¸…æ™°ï¼Œè¿˜å¸Œæœ›è€å¸ˆèƒ½æ¢³ç†ä¸€ä¸‹ã€‚<br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439346,"discussion_content":"ä¸æ˜¯ï¼Œè¿™ä¸ªrelation_shipï¼Œå°±æ˜¯å­—æ®µåå“¦ï¼Œä¸ç”¨ä»£å…¥å‚æ•°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550299537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66199,"user_name":"çª—å¤–","can_delete":false,"product_type":"c1","uid":1311172,"ip_address":"","ucode":"1E8F2D9439E7F3","user_header":"https://static001.geekbang.org/account/avatar/00/14/01/c4/21c2cde4.jpg","comment_is_top":false,"comment_ctime":1549891473,"is_pvip":false,"replies":[{"id":"25270","content":"æ–°å¹´å¥½ï¼ˆè™½ç„¶å…¶å®å·²ç»å…ƒå®µéƒ½è¿‡äº†ï¼Œä¸å¥½æ„æ€ï¼Œè¿™ä¸ªé—®é¢˜å›å¤ªæ™šå•¦ï¼‰<br><br>1. æ˜¯çŠ¶æ€æ”¹å˜ï¼ŒåŒæ—¶å†™redo logæ–‡ä»¶çš„ï¼Œå†™512å­—èŠ‚ã€‚<br>2. å¤šä¸ªredo åˆ·åŒä¸€ä¸ªçš„è¯ï¼Œç¬¬ä¸€ä¸ªredoå…ˆåˆ·ï¼Œå˜æˆå¹²å‡€é¡µã€‚ç„¶åä¹‹åå¦‚æœæ²¡æœ‰å†å¯¹è¿™ä¸ªé¡µé¢çš„æ›´æ–°ï¼Œé‚£ä»ç¬¬äºŒä¸ªredo logä½ç½®å¼€å§‹ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªå¹²å‡€é¡µï¼Œå°±è·³è¿‡äº†ã€‚<br>3. ç¬¬ä¸€ä¸ªé—®é¢˜çš„commitä½<br>4. ä¸èƒ½<br>5. çœ‹ä¸‹23ç¯‡<br>6. â€œä¸èƒ½æ¢å¤æ•°æ®é¡µâ€ï¼Œè¿™ä¸ªè¿˜æ˜¯å†…å®¹å¯¼è‡´çš„ã€‚binlogé‡Œé¢è®°å½•çš„æ˜¯é€»è¾‘æ“ä½œ<br>7. æ²¡äº‹ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µå¦‚æœå‡ºé—®é¢˜ï¼Œæ¯”å¦‚å®•æœºé‡å¯ï¼Œé‚£äº‹åŠ¡è¿˜æ²¡æœ‰åˆ°æäº¤é˜¶æ®µå‘¢ï¼Œäº‹åŠ¡æœ¬æ¥å°±å¯ä»¥ä¸¢æ‰<br>8. ç›®å‰è¿˜æ²¡æœ‰è¿™ä¸ªå‚æ•°é€‰é¡¹ã€‚è€ƒè™‘ä¸»å¤‡ä¸€è‡´æ€§ï¼Œè¿˜æ˜¯å¾—æäº¤","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1551187361,"ip_address":"","comment_id":66199,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549891473","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ–°å¹´å¿«ä¹å•Šï¼Œè¿‡å¹´æœŸé—´æ”’äº†å¥½äº›é—®é¢˜ï¼Œä¸æƒ³æ‰“æ‰°æ‚¨ï¼Œç°åœ¨é—®ä¸‹ï¼Œè¿˜è¯·è§£æƒ‘ï¼Œ<br><br>1. redo log åœ¨ prepare ä¸ commit ä¸¤å¤„æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä»…ä»…æ˜¯ä¸€ä¸ªçŠ¶æ€çš„æ”¹å˜å—ï¼Ÿ<br>2. åˆ·æ–° redo log æ—¶ï¼Œå¦‚æœå¤šä¸ª redo log å¯¹åº”çš„æ˜¯åŒä¸€ä¸ªè„é¡µï¼Œæ­¤æ—¶æ˜¯åˆå¹¶ redo log å†åˆ·æ–°è¿˜æ˜¯å•æ¡åˆ·æ–°ï¼Œå¦‚æœæ˜¯å•æ¡ redo log åˆ·æ–°ï¼Œé‚£è„é¡µä¸­çš„å…¶å®ƒè„æ•°æ®æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿå¦‚æœæ˜¯åˆå¹¶åˆ·æ–°é‚£è¿™äº› redo log ä¸è¿è´¯æ—¶æ€ä¹ˆå¤„ç†ï¼Œæ˜¯å¦ä¼šæ¶‰åŠåˆ°éšæœº io çš„æ¶ˆè€—ï¼Ÿä¸”åˆå¹¶åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢ï¼Ÿ<br>3. æ€ä¹ˆåˆ¤æ–­ redo log æ˜¯å®Œæ•´çš„ï¼Ÿåœ¨åˆ¤æ–­ binlog å®Œæ•´æ€§æ—¶ï¼Œæ˜¯åˆ¤æ–­å•ä¸ª binlog æ–‡ä»¶çš„å®Œæ•´æ€§è¿˜æ˜¯ binlog ä¸­æ¯ä¸ªäº‹åŠ¡çš„å®Œæ•´æ€§ï¼Ÿ<br>4. èƒ½å¦ç”¨ binlog æ¢å¤ redo logï¼Ÿå¦‚æœèƒ½ï¼Œredo log ä¸­åŒ…å«é¡µçš„ä¿¡æ¯ï¼Œè€Œ binlog ä¸­ä¸åŒ…å«ï¼Œè¿™äº›ä¿¡æ¯æ€ä¹ˆè·å–çš„ï¼Ÿ<br>5. å¦‚æœåˆ·æ–°è„é¡µä¸ redo log æ— å…³ï¼Œé‚£è„é¡µè½ç›˜ï¼Œredo log æ²¡è½ç›˜æ—¶ï¼ˆå‡è®¾ innodb_flush_log_at_trx_commit != 1ï¼Œäº‹åŠ¡æäº¤ï¼Œè„é¡µè½ç›˜ï¼Œä½† redo log æ²¡è½ç›˜ï¼‰ï¼Œæ­¤æ—¶å´©æºƒï¼Œæ•°æ®ä¸ºä»€ä¹ˆå¯èƒ½ä¼šä¸¢å¤±&#47;ä¸ä¸€è‡´ï¼Œå³è¯¥å‚æ•°ä¸º 1 çš„é‡è¦æ€§ï¼Ÿ<br>6. ä¸èƒ½åªç”¨ binlog æ¢å¤æ•°æ®ï¼Œæ˜¯å› ä¸º 1. æ—¶æœºä¸å¥½æ§åˆ¶ï¼Œé‚£è¿™åœ¨ redo log æ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿlsn å—? 2. ä¸èƒ½æ¢å¤æ•°æ®é¡µï¼Œæˆ‘çš„ç†è§£æ˜¯å¯ä»¥é€šè¿‡ binlog æ¢å¤æ•°æ®ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç”¨äºå´©æºƒåçš„æ¢å¤å‘¢ï¼Ÿä¸ºä»€ä¹ˆæ­¤æ—¶ä¸éœ€è¦ç›¸å…³é¡µçš„ä¿¡æ¯ï¼Ÿ<br>7. æ›´æ–°å†…å­˜çš„åŒæ—¶å†™ redo log bufferï¼Œæ­¤æ—¶æ˜¯æ€ä¹ˆä¿éšœä¸¤è€…çš†å†™æˆåŠŸå‘¢ï¼Œæ¯•ç«Ÿä¸€æ—¦ä¸€ä¸ªå†™å¤±è´¥å°±ä¼šå‡ºé—®é¢˜ï¼Ÿ<br>8. å½“å´©æºƒåï¼Œ3 æ­¥æäº¤ä¸­çš„å‰ 2 æ­¥å‡å·²å®Œæˆï¼Œç†è®ºä¸Šä¼šè‡ªåŠ¨æäº¤è¯¥äº‹åŠ¡ï¼Œæ­¤æ—¶èƒ½å¦è®¾ç½®è¯¥äº‹åŠ¡ä¸è‡ªåŠ¨æäº¤ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438748,"discussion_content":"æ–°å¹´å¥½ï¼ˆè™½ç„¶å…¶å®å·²ç»å…ƒå®µéƒ½è¿‡äº†ï¼Œä¸å¥½æ„æ€ï¼Œè¿™ä¸ªé—®é¢˜å›å¤ªæ™šå•¦ï¼‰\n\n1. æ˜¯çŠ¶æ€æ”¹å˜ï¼ŒåŒæ—¶å†™redo logæ–‡ä»¶çš„ï¼Œå†™512å­—èŠ‚ã€‚\n2. å¤šä¸ªredo åˆ·åŒä¸€ä¸ªçš„è¯ï¼Œç¬¬ä¸€ä¸ªredoå…ˆåˆ·ï¼Œå˜æˆå¹²å‡€é¡µã€‚ç„¶åä¹‹åå¦‚æœæ²¡æœ‰å†å¯¹è¿™ä¸ªé¡µé¢çš„æ›´æ–°ï¼Œé‚£ä»ç¬¬äºŒä¸ªredo logä½ç½®å¼€å§‹ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªå¹²å‡€é¡µï¼Œå°±è·³è¿‡äº†ã€‚\n3. ç¬¬ä¸€ä¸ªé—®é¢˜çš„commitä½\n4. ä¸èƒ½\n5. çœ‹ä¸‹23ç¯‡\n6. â€œä¸èƒ½æ¢å¤æ•°æ®é¡µâ€ï¼Œè¿™ä¸ªè¿˜æ˜¯å†…å®¹å¯¼è‡´çš„ã€‚binlogé‡Œé¢è®°å½•çš„æ˜¯é€»è¾‘æ“ä½œ\n7. æ²¡äº‹ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µå¦‚æœå‡ºé—®é¢˜ï¼Œæ¯”å¦‚å®•æœºé‡å¯ï¼Œé‚£äº‹åŠ¡è¿˜æ²¡æœ‰åˆ°æäº¤é˜¶æ®µå‘¢ï¼Œäº‹åŠ¡æœ¬æ¥å°±å¯ä»¥ä¸¢æ‰\n8. ç›®å‰è¿˜æ²¡æœ‰è¿™ä¸ªå‚æ•°é€‰é¡¹ã€‚è€ƒè™‘ä¸»å¤‡ä¸€è‡´æ€§ï¼Œè¿˜æ˜¯å¾—æäº¤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1551187361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":65521,"user_name":"devil","can_delete":false,"product_type":"c1","uid":1259625,"ip_address":"","ucode":"BB6090411BAA23","user_header":"https://static001.geekbang.org/account/avatar/00/13/38/69/864569a4.jpg","comment_is_top":false,"comment_ctime":1549427930,"is_pvip":false,"replies":[{"id":"23214","content":"ä¸åŒçš„æ•°æ®æ’å…¥çš„è¡Œä¸åŒï¼Œè¡Œé”ä¸åŒã€‚<br>ä½†æ˜¯æ›´æ–°æ˜¯ç”¨ä¸€è¡Œå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1549441584,"ip_address":"","comment_id":65521,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549427930","product_id":100020801,"comment_content":"å¦‚æœè¡¨ä¸­æœ‰è‡ªå¢å­—æ®µï¼Œinsert çš„æ—¶å€™ä¹Ÿä¼šæ‹¿åˆ°ä¸€ä¸ªé”å§ï¼Œå…ˆæ’å…¥å†æ›´æ–°ä¹Ÿæœ‰é”ç­‰å¾…å§ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438487,"discussion_content":"ä¸åŒçš„æ•°æ®æ’å…¥çš„è¡Œä¸åŒï¼Œè¡Œé”ä¸åŒã€‚\nä½†æ˜¯æ›´æ–°æ˜¯ç”¨ä¸€è¡Œå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549441584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63407,"user_name":"LIU","can_delete":false,"product_type":"c1","uid":1324845,"ip_address":"","ucode":"CB8BAB022F5B9F","user_header":"","comment_is_top":false,"comment_ctime":1548343894,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548343894","product_id":100020801,"comment_content":"ç”¨äº†å¾ˆå¤šå¹´    æ‰å…¥é—¨å•Š  ","like_count":0},{"had_liked":false,"id":62508,"user_name":"chitanda","can_delete":false,"product_type":"c1","uid":1235077,"ip_address":"","ucode":"B3E28E1C8E410B","user_header":"https://static001.geekbang.org/account/avatar/00/12/d8/85/21fd42fa.jpg","comment_is_top":false,"comment_ctime":1548077642,"is_pvip":false,"replies":[{"id":"22092","content":"å¤šè°¢é¼“åŠ±ï¼ï¼ï¼ ğŸ˜†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548077973,"ip_address":"","comment_id":62508,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1548077642","product_id":100020801,"comment_content":"è¿™ä¸ªå…³æ³¨ã€å–œæ¬¢è¡¨çš„è®²è§£ç›¸å½“ç²¾å¦™ï¼Œç®€ç›´å¦‚é†é†çŒé¡¶ï¼Œmysqlè¿˜æœ‰æˆ‘æ²¡ç”¨åˆ°çš„è¿™è®¸å¤šæ“ä½œï¼ŒåŒæ—¶ä¹Ÿå†æ¬¡ç¡®è®¤äº†è‡ªå·±çš„å±€é™å’Œä¸è¶³ã€‚<br>å¤šè°¢æ¬¾å¾…ï¼ï¼ï¼","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437244,"discussion_content":"å¤šè°¢é¼“åŠ±ï¼ï¼ï¼ ğŸ˜†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548077973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61397,"user_name":"Snake","can_delete":false,"product_type":"c1","uid":1034894,"ip_address":"","ucode":"C3E80DE87EACD1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ca/8e/5768649e.jpg","comment_is_top":false,"comment_ctime":1547690034,"is_pvip":false,"replies":[{"id":"21833","content":"å¦‚æœwhereæ¡ä»¶å¤šï¼Œå°½é‡ç”¨ä¸Šç´¢å¼•ï¼Œåˆ°æ•°æ®åº“ç›´æ¥æŸ¥å§ï¼Œåº”ç”¨å¤æ‚æ€§ä¹Ÿå°å¾ˆå¤šï¼Œ<br>æ˜¯åœ¨æ²¡è¾™ä¹Ÿåªèƒ½è¿™æ ·äº†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547694126,"ip_address":"","comment_id":61397,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547690034","product_id":100020801,"comment_content":"å…³äºcountå•è¡¨çš„æ€»è®°å½•æ•°ï¼Œç”¨ç‹¬ç«‹çš„ä¸šåŠ¡è®°æ•°è¡¨å»è®°å½•ç¡®å®å¯ä»¥æé€Ÿã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸šåŠ¡ä¸­ç»å¸¸å‡ºç°åŒ…å«å„ç§joinå’Œwhereçš„å¤æ‚æŸ¥è¯¢ï¼Œæˆ‘èƒ½æƒ³åˆ°çš„ä¸€ä¸ªä¸å¤ªå¥½çš„æ–¹æ³•æ˜¯æ ¹æ®sqlæŸ¥è¯¢è¯­å¥åšç»“æœç¼“å­˜ï¼Œä½†æ˜¯è¿™ä¸ªç¼“å­˜çš„å‘½ä¸­ç‡å¯èƒ½å°±ä¸è§å¾—æœ‰å¤šé«˜äº†ã€‚è€å¸ˆæœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•æ¨èå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436863,"discussion_content":"å¦‚æœwhereæ¡ä»¶å¤šï¼Œå°½é‡ç”¨ä¸Šç´¢å¼•ï¼Œåˆ°æ•°æ®åº“ç›´æ¥æŸ¥å§ï¼Œåº”ç”¨å¤æ‚æ€§ä¹Ÿå°å¾ˆå¤šï¼Œ\næ˜¯åœ¨æ²¡è¾™ä¹Ÿåªèƒ½è¿™æ ·äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547694126,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":60760,"user_name":"æ°ä¹‹7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1547544295,"is_pvip":false,"replies":[{"id":"21674","content":"èµï¼Œä¸€èµ·è¿›æ­¥~<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547552107,"ip_address":"","comment_id":60760,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547544295","product_id":100020801,"comment_content":"é€šè¿‡è¿™ä¸€èŠ‚ç­”ç–‘æ–‡ç« çš„é˜…è¯»ï¼Œè€å¸ˆå¸¦æˆ‘ä»¬å›é¡¾äº†è¿‡å»å…³äºæ—¥å¿—å’Œé”çš„ç›¸å…³é—®é¢˜ã€‚é˜…è¯»å®Œä¹‹åç»™æˆ‘çš„ä¸€ä¸ªä½“ä¼šæ˜¯ç†Ÿæ‚‰Mysqlçš„åŸç†æ˜¯éå¸¸é‡è¦çš„ï¼Œè®¸å¤šçš„ç»†èŠ‚éƒ½å¯ä»¥é€šMysqlçš„è®¾è®¡åŸç†å’ŒInnodbå¯»æ±‚ç­”æ¡ˆã€‚<br><br>åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜ä¸­ï¼Œå…³äºä¸¤é˜¶æ®µæäº¤ï¼Œå…³é”®æ˜¯çœ‹binlogæ˜¯å¦å­˜åœ¨å®Œæ•´æ€§ã€‚åœ¨è¿™ä¸ªé—®é¢˜åŸºç¡€ä¹‹ä¸Šï¼Œåˆä¸ºæˆ‘ä»¬å»¶ä¼¸äº†9ä¸ªé—®é¢˜ï¼Œ(1)binlogå®Œæ•´çš„æ ‡å¿—ï¼Œ(2)redo logä¸binlogçš„å…³è”,(3)redo logåŠ ä¸Šå®Œbinlogé‡å¯å°±èƒ½æ¢å¤,(4)ä¸¤é˜¶æ®µæäº¤çš„æ„ä¹‰,(5)(6),å•ç‹¬çš„binlogæˆ–redo logæ˜¯å¦å¯è¡Œ,(7)redo logçš„å¤§å°è®¾ç½®,(8)redo log è¿˜æ˜¯buffer poolæœ€ç»ˆè½ç›˜,(9) redo log bufferæ˜¯ä»€ä¹ˆ.æˆ‘è¯»è€å¸ˆçš„å›ç­”ï¼Œæˆ‘å¯¹ä¸Šè¿°çš„é—®é¢˜èƒ½ç†è§£ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜å…³äºç´¢å¼•åŒæ—¶å…³æ³¨çš„é—®é¢˜ï¼Œè€å¸ˆç»™çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯è§£ç­”3çš„è¿™ç§æƒ…å†µã€‚<br><br>çœ‹åˆ°è€å¸ˆä¸“é—¨è®°å½•æˆ‘ä»¬çš„é—®é¢˜ï¼Œæˆ‘å°±è§‰å¾—æœ‰ä¸€ç§å¹¸ç¦çš„æ„Ÿè§‰ï¼Œå› ä¸ºæœ‰è¿™ä¹ˆå¥½çš„è€å¸ˆä¸€åŒå‰è¡Œï¼ŒæŒç»­ä¸‹å»å¿…ä¼šæ¥å‡ºå¥½çš„æœå®ã€‚<br><br><br><br><br><br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436613,"discussion_content":"èµï¼Œä¸€èµ·è¿›æ­¥~\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547552107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58594,"user_name":"çœ‹ä¸åˆ°deé¢œè‰²","can_delete":false,"product_type":"c1","uid":1162714,"ip_address":"","ucode":"88348CCAE81931","user_header":"https://static001.geekbang.org/account/avatar/00/11/bd/da/3d76ea74.jpg","comment_is_top":false,"comment_ctime":1547128698,"is_pvip":false,"replies":[{"id":"21187","content":"ä½ è¯´å¾—å¯¹ï¼Œredo logå…¶å®è¿˜å¯ä»¥çš„ï¼Œå®ƒåªæ˜¯æ²¡æœ‰ä¿å­˜æ•´é¡µæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥è®°å½•é¡µé¢çº§åˆ«çš„å˜æ›´ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547140812,"ip_address":"","comment_id":58594,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547128698","product_id":100020801,"comment_content":"çœ‹å®Œè¿½é—®8ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼ŒInnodbå¯¹äºæ•°æ®çš„æŸ¥è¯¢åŠå­˜å‚¨éƒ½æ˜¯åŸºäºæ•´ä¸ªæ•°æ®é¡µçš„è€Œéå•æ¡æ•°æ®ã€‚<br>åœ¨çœ‹è¯„è®ºçš„æ—¶å€™çœ‹åˆ°è€å¸ˆæœ‰å›å¤è¯´ï¼šbinlogä¸€æ¥æ—¶æœºæ§åˆ¶ä¸å¥½ï¼ˆå°±æ˜¯ä½ è¯´çš„è¿™ä¸ªï¼‰ï¼ŒäºŒæ¥å†…å®¹çš„èƒ½åŠ›ä¸è¶³ï¼ˆæ²¡æœ‰é¡µé¢ä¿¡æ¯ã€‚é‚£ä¹ˆæŒ‰ç…§è¿½é—®8çš„è¯´æ³•ï¼Œredo logå®é™…ä¸Šèƒ½åŠ›ä¹Ÿåº”å½“æ˜¯ä¸è¶³çš„ã€‚ä½†æ˜¯redo logç”±äºè®°å½•çš„æ˜¯é¡µä¸Šçš„ç‰©ç†ä¿®æ”¹ï¼Œè‡ªå·±è‡ªèº«å¤§å°æœ‰é™ï¼Œæ‰€ä»¥ä¾¿äºå´©æºƒæ—¶çš„å›æ”¾ã€‚<br>ä¸çŸ¥ä¸Šé¢ä¸¤ç‚¹ç†è§£æ˜¯å¦å‡†ç¡®ã€‚è¿˜è¯·è€å¸ˆæŒ‡ç‚¹è¿·æ´¥ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436129,"discussion_content":"ä½ è¯´å¾—å¯¹ï¼Œredo logå…¶å®è¿˜å¯ä»¥çš„ï¼Œå®ƒåªæ˜¯æ²¡æœ‰ä¿å­˜æ•´é¡µæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥è®°å½•é¡µé¢çº§åˆ«çš„å˜æ›´ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547140812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58292,"user_name":"é“","can_delete":false,"product_type":"c1","uid":1100869,"ip_address":"","ucode":"B17CA7372C21C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/cc/45/73a0f7f8.jpg","comment_is_top":false,"comment_ctime":1547028052,"is_pvip":false,"replies":[{"id":"21009","content":"å¯¹å•Šï¼ŒåŒ1æ‰èƒ½ä¿è¯ä¸ä¸¢è€Œä¸”ä¸€è‡´ï¼Œä½ éƒ½è®¾ç½®æˆ0äº†â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547042925,"ip_address":"","comment_id":58292,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547028052","product_id":100020801,"comment_content":"æ‡µé€¼äº†ï¼ŒæŒ‰23èŠ‚çš„æ„æ€ï¼Œå¦‚æœæŠŠinnodb_flush_log_at_trx_commit å€¼è®¾ä¸º0ï¼ˆåªæœ‰åå°çº¿ç¨‹å®šæœŸå†™ç›˜redo logï¼‰ ï¼Œé‚£ä¹ˆä¸¤é˜¶æ®µæäº¤åœ¨æ—¶åˆ»bï¼Œæœ‰å¯èƒ½redo logäº‹åŠ¡æ²¡å†™ç¡¬ç›˜ï¼Œè€Œbinlogäº‹åŠ¡å†™ç¡¬ç›˜ä¸Šäº†ï¼Œè€Œæ­¤æ—¶æœºå™¨æŒ‚äº†ï¼Œé‡å¯åæ¢å¤åˆ°äº‹åŠ¡å‰çš„çŠ¶æ€ï¼Œæ­¤æ—¶binlogå°±ä¸ä¸€è‡´äº†å•Š","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435991,"discussion_content":"å¯¹å•Šï¼ŒåŒ1æ‰èƒ½ä¿è¯ä¸ä¸¢è€Œä¸”ä¸€è‡´ï¼Œä½ éƒ½è®¾ç½®æˆ0äº†â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547042925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":57392,"user_name":"ä¿¡ä¿¡","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1546778664,"is_pvip":false,"replies":[{"id":"20675","content":"å› ä¸ºbinlogå¯èƒ½å·²ç»å‘ç»™å¤‡åº“äº†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546782152,"ip_address":"","comment_id":57392,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546778664","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå›¾2ä¸‹æ–¹è¯´ï¼šé‡å¯åï¼Œå¼•æ“å†…éƒ¨äº‹åŠ¡ 2 ä¼šå›æ»šï¼Œç„¶ååº”ç”¨ binlog2 å¯ä»¥è¡¥å›æ¥ã€‚å¯æ˜¯æœªæäº¤çš„äº‹åŠ¡åœ¨å›æ»šä¹‹åï¼Œä¸ºå•¥è¿˜è¦é‡åšå‘¢ï¼Ÿåè¿‡æ¥è¯´ï¼Œå¦‚æœåˆ¤å®šè¿™ä¸ªäº‹åŠ¡æ»¡è¶³å·²æäº¤çš„æ¡ä»¶ï¼Œé‚£å°±ä¸ä¼šå›æ»šæ‰å¯¹å•Šã€‚è¯·è€å¸ˆæŒ‡æ­£ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435557,"discussion_content":"å› ä¸ºbinlogå¯èƒ½å·²ç»å‘ç»™å¤‡åº“äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546782152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56633,"user_name":"crazyone","can_delete":false,"product_type":"c1","uid":1115042,"ip_address":"","ucode":"705E34642E41F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/03/a2/ceb37046.jpg","comment_is_top":false,"comment_ctime":1546512063,"is_pvip":false,"replies":[{"id":"20418","content":"æ˜¯å¾—å®¢æˆ·ç«¯è‡ªå·±å†å»æŸ¥æ•°æ®åˆ¤æ–­çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546514751,"ip_address":"","comment_id":56633,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546512063","product_id":100020801,"comment_content":"ä¸€ç›´ä¸æ˜¯å¾ˆæ¸…æ¥šmysqlæ˜¯ä»€ä¹ˆæ—¶å€™è¿”å›å“åº”ç»™å®¢æˆ·ç«¯çš„ï¼Ÿå¯¹åº”äº‹åŠ¡çš„æäº¤ï¼Œæ˜¯æœ€åçš„commitå®Œæˆä¹‹å?é‚£å¦‚æœå‘ç”Ÿ å†™binlogåï¼Œcommitäº‹åŠ¡å‰ çš„crashï¼Œå®¢æˆ·ç«¯çš„æäº¤å“åº”æ˜¯ä¸€ä¸ªå¼‚å¸¸æ–­é“¾å§ï¼Œè¿™æ—¶æ•°æ®åº“æ¢å¤ä¼šæŠŠäº‹åŠ¡æ¢å¤å®Œå…¨ï¼Œå®¢æˆ·ç«¯å¦‚ä½•å¾—çŸ¥ä¹‹å‰çš„æäº¤æ˜¯okçš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435161,"discussion_content":"æ˜¯å¾—å®¢æˆ·ç«¯è‡ªå·±å†å»æŸ¥æ•°æ®åˆ¤æ–­çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546514751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":56520,"user_name":"è¿æ–¤æˆé£","can_delete":false,"product_type":"c1","uid":1350812,"ip_address":"","ucode":"BAFF69C29FDFA5","user_header":"https://static001.geekbang.org/account/avatar/00/14/9c/9c/e02a0daf.jpg","comment_is_top":false,"comment_ctime":1546481387,"is_pvip":false,"replies":[{"id":"20387","content":"è¿™ä¸ªç®—æ˜¯â€œè®¾è®¡å†…â€çš„ï¼Œä¸ç®—bug ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546486343,"ip_address":"","comment_id":56520,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546481387","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼Œupdate t set a=2 where Id=2 ä¸‡ï¼ŒçœŸå®çš„åšäº†æ›´æ–°ï¼Œé‚£æ‰§è¡ŒæˆåŠŸåç»“æœæ˜¾ç¤ºï¼ŒåŒ¹é… (rows matched) äº†ä¸€è¡Œï¼Œä¿®æ”¹ (Changed) äº† 0 è¡Œï¼Œ0è¡Œè¢«å½±å“ï¼Œæ˜¯å®¢æˆ·ç«¯æ˜¾ç¤ºé—®é¢˜ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":435089,"discussion_content":"è¿™ä¸ªç®—æ˜¯â€œè®¾è®¡å†…â€çš„ï¼Œä¸ç®—bug ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546486343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55756,"user_name":"Long","can_delete":false,"product_type":"c1","uid":1318970,"ip_address":"","ucode":"2417242560360A","user_header":"https://static001.geekbang.org/account/avatar/00/14/20/3a/90db6a24.jpg","comment_is_top":false,"comment_ctime":1546297290,"is_pvip":false,"replies":[{"id":"20096","content":"å¯¹æ²¡å†™å®Œæ•´çš„äº‹åŠ¡å°±å›æ»š","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546303514,"ip_address":"","comment_id":55756,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546297290","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½ã€‚  è·‘åˆ°è€è¯¾ç¨‹ä¸‹é—®ä¸ªé—®é¢˜ã€‚  å¦‚æœæŠŠsession æˆ–è€…global çš„binlogå…³é—­äº†ï¼Œé‚£ä¹ˆå¦‚æœæ‰§è¡Œäº‹åŠ¡æœŸé—´MySQL å´©æºƒäº†ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯åœ¨å´©æºƒæ¢å¤çš„æ—¶å€™å°±ä¼šç›´æ¥æŠŠredoé‡Œé¢å¤„äºprepareçŠ¶æ€çš„å›æ»šæ‰ï¼Ÿå› ä¸ºbinlogæ‰¾ä¸åˆ°è®°å½•ï¼Ÿ  å¤šè°¢ç­”å¤","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434840,"discussion_content":"å¯¹æ²¡å†™å®Œæ•´çš„äº‹åŠ¡å°±å›æ»š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546303514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55737,"user_name":"alias cd=rm -rf","can_delete":false,"product_type":"c1","uid":1318325,"ip_address":"","ucode":"E7B27D76305B75","user_header":"https://static001.geekbang.org/account/avatar/00/14/1d/b5/971261fd.jpg","comment_is_top":false,"comment_ctime":1546273944,"is_pvip":false,"replies":[{"id":"20094","content":"å¯èƒ½æ˜¯1æˆ–3ï¼Œ<br>çœ‹ä¸‹ä¸€ç¯‡å“ˆ<br><br>æ–°å¹´å¿«ä¹","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1546275132,"ip_address":"","comment_id":55737,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1546273944","product_id":100020801,"comment_content":"æ€è€ƒé¢˜ç­”æ¡ˆ<br>åº”è¯¥æ˜¯ï¼š1<br>åŸå› ï¼š<br>1ã€mysqlserverå±‚çš„ç›´æ¥è¿”å›ï¼Œå‡å°‘äº†å¼•æ“å±‚ä¸å¿…è¦çš„è¿ç®—ï¼Œä¾‹å¦‚ï¼šinnodbéœ€è¦äº›redologï¼Œundolog,å¹¶ä¸”åˆ·è„é¡µã€‚<br>2ã€ä¸ºä»€ä¹ˆè¿™æ­¥æ“ä½œä¸æ”¾åœ¨å¼•æ“å±‚ä¹Ÿå°±æ˜¯2çš„åŸå› æ˜¯ï¼šå¼•æ“å±‚çš„å®ç°serveræ— æ³•æ§åˆ¶ï¼Œä¸èƒ½ä¿è¯å¼•æ“çœ‹åˆ°å€¼ç›¸ç­‰ç›´æ¥è¿”å›ã€‚<br>éªŒè¯æ–¹å¼ï¼š<br>åœ¨myIsamçš„è¡¨ä¸­æ‰§è¡Œé€»è¾‘è¿”ç°ç»“æœå’Œinnodbä¸€æ ·","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434836,"discussion_content":"å¯èƒ½æ˜¯1æˆ–3ï¼Œ\nçœ‹ä¸‹ä¸€ç¯‡å“ˆ\n\næ–°å¹´å¿«ä¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1546275132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":55166,"user_name":"äº’è”ç½‘ç‰›ä»”","can_delete":false,"product_type":"c1","uid":1013536,"ip_address":"","ucode":"B866B0E497AD27","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/20/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1546054983,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546054983","product_id":100020801,"comment_content":"å…³äºè¿™ä¸ªé—®é¢˜ï¼šâ€œä¸šåŠ¡ä¸Šæœ‰è¿™æ ·çš„éœ€æ±‚ï¼ŒAã€B ä¸¤ä¸ªç”¨æˆ·ï¼Œå¦‚æœäº’ç›¸å…³æ³¨ï¼Œåˆ™æˆä¸ºå¥½å‹ã€‚â€<br>æ˜¯å¦å¯ä»¥åˆ†æˆä¸¤ä¸ªäº‹åŠ¡,å¹¶æŠŠinsert into likeï¼Œæå‰åˆ°select from likeä¹‹å‰,å¦‚ä¸‹ï¼š<br>SessionAï¼Œ<br>begin<br>insert into like;<br>end<br><br>begin<br>select from like<br>åˆ¤æ–­æ˜¯å¦ Bå…³æ³¨Aï¼Œå¦‚æœBå·²å…³æ³¨Aï¼Œåˆ™ï¼š<br>insert into friends<br>commit<br><br>Session Bç±»ä¼¼çš„æ“ä½œã€‚","like_count":0},{"had_liked":false,"id":54602,"user_name":"å°æå­","can_delete":false,"product_type":"c1","uid":1196293,"ip_address":"","ucode":"C5593E33CA6F4C","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/05/5ba603f2.jpg","comment_is_top":false,"comment_ctime":1545912230,"is_pvip":false,"replies":[{"id":"19816","content":"åªèƒ½åˆ†æˆå¤šä¸ªè¯­å¥ï¼Œæ¯ä¸ªè¯­å¥éƒ½è¿™ä¹ˆæ¥ä¸€ä¸‹ï¼Œç„¶åå–idçš„äº¤é›†äº†â€¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545917681,"ip_address":"","comment_id":54602,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545912230","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘çš„æ„æ€æ˜¯ ï¼Œä¾‹å¦‚ä¸‹é¢è¯­å¥ éœ€è¦å…¨æ¨¡ç³ŠåŒ¹é…<br>select * from people where name like &#39;%å¼ ä¸‰ä¸°%&#39; <br>åº”è¯¥å¯ä»¥åŠ å¤šä¸€ä¸ªå­—æ®µ name_ååº  å­˜å‚¨  name çš„å†…å®¹çš„ååºå­—ç¬¦ä¸²ï¼Œç„¶å<br>æŠŠå®ƒæ”¹å†™æˆ åæ¨¡ç³Š<br>select * from people where name like &#39;å¼ ä¸‰ä¸°%&#39;  <br>union all <br>select * from people where name_ååº like &#39;ä¸°ä¸‰å¼ %&#39;  ï¼Œ<br><br>æˆ‘çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸æ­¢ name è¿™ä¸ªå­—æ®µï¼Œè¿˜æœ‰å…¶ä»–çš„å­—æ®µä¹Ÿéœ€è¦å…¨æ¨¡ç³Šï¼Œæœ‰æ²¡æœ‰åŠæ³•åšåˆ°å¦‚ä¸Šç±»ä¼¼çš„å–å·§ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434507,"discussion_content":"åªèƒ½åˆ†æˆå¤šä¸ªè¯­å¥ï¼Œæ¯ä¸ªè¯­å¥éƒ½è¿™ä¹ˆæ¥ä¸€ä¸‹ï¼Œç„¶åå–idçš„äº¤é›†äº†â€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545917681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":54496,"user_name":"å°æå­","can_delete":false,"product_type":"c1","uid":1196293,"ip_address":"","ucode":"C5593E33CA6F4C","user_header":"https://static001.geekbang.org/account/avatar/00/12/41/05/5ba603f2.jpg","comment_is_top":false,"comment_ctime":1545882367,"is_pvip":false,"replies":[{"id":"19798","content":"å…¶å®ç¬¬ä¸€ä¸ªä¹Ÿä¸èƒ½å§ï¼Œæœ‰%åœ¨æœ€å‰é¢ï¼Œå¾—ç”¨å…¨æ–‡æ£€ç´¢ç´¢å¼•<br><br>å¦‚æœè¦ç”¨å„è‡ªå–idæ¥joinçš„è¯ï¼Œéœ€è¦å•ç‹¬å†™æˆå‡ ä¸ªå­æŸ¥è¯¢","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545903096,"ip_address":"","comment_id":54496,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545882367","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸€ä¸‹ï¼Œä¸€ä¸ªè¡¨æœ‰å¤šä¸ªå­—æ®µï¼Œéœ€è¦æ”¯æŒæ¨¡ç³Šç´¢å¼•ï¼Œä¾‹å¦‚ select * from people where name like &#39;%å¼ ä¸‰%&#39; and address like &#39;%å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒº%&#39;  ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°åŠ å¤šå‡ ä¸ªå†—ä½™å­—æ®µå­˜å‚¨ååºçš„å¾…æ¨¡ç³ŠåŒ¹é…å­—ç¬¦ï¼Œå°†å…¨æ¨¡ç³Šè½¬æ¢æˆå¤šä¸ªåæ¨¡ç³Šï¼Œä½†æ˜¯å¤šä¸ªæ¡ä»¶ä¹‹é—´çš„andï¼Œå¯¼è‡´åªæœ‰ç¬¬ä¸€ä¸ªåæ¨¡ç³Šæ‰èƒ½èµ°åˆ°ç´¢å¼•ï¼Œåé¢çš„éƒ½èµ°ä¸åˆ°ï¼Œè¯·é—®ç±»ä¼¼è¿™ç§é—®é¢˜ï¼Œåº”è¯¥ç”¨ä»€ä¹ˆæ–¹æ¡ˆæé«˜æ€§èƒ½æ¯”è¾ƒå¥½","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434476,"discussion_content":"å…¶å®ç¬¬ä¸€ä¸ªä¹Ÿä¸èƒ½å§ï¼Œæœ‰%åœ¨æœ€å‰é¢ï¼Œå¾—ç”¨å…¨æ–‡æ£€ç´¢ç´¢å¼•\n\nå¦‚æœè¦ç”¨å„è‡ªå–idæ¥joinçš„è¯ï¼Œéœ€è¦å•ç‹¬å†™æˆå‡ ä¸ªå­æŸ¥è¯¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545903096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53589,"user_name":"William","can_delete":false,"product_type":"c1","uid":1346215,"ip_address":"","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1545698441,"is_pvip":true,"replies":[{"id":"19482","content":"åé¢æ–‡ç« ä¼šè¯´åˆ°å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545702729,"ip_address":"","comment_id":53589,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545698441","product_id":100020801,"comment_content":"è¿½é—® 8ï¼šæ­£å¸¸è¿è¡Œä¸­çš„å®ä¾‹ï¼Œæ•°æ®å†™å…¥åçš„æœ€ç»ˆè½ç›˜ï¼Œæ˜¯ä» redo log æ›´æ–°è¿‡æ¥çš„è¿˜æ˜¯ä» buffer pool æ›´æ–°è¿‡æ¥çš„å‘¢ï¼Ÿ<br>å›ç­”ï¼šè¿™ä¸ªé—®é¢˜å…¶å®é—®å¾—éå¸¸å¥½ã€‚è¿™é‡Œæ¶‰åŠåˆ°äº†ï¼Œâ€œredo log é‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ã€‚<br><br>å®é™…ä¸Šï¼Œredo log å¹¶æ²¡æœ‰è®°å½•æ•°æ®é¡µçš„å®Œæ•´æ•°æ®ï¼Œæ‰€ä»¥å®ƒå¹¶æ²¡æœ‰èƒ½åŠ›è‡ªå·±å»æ›´æ–°ç£ç›˜æ•°æ®é¡µï¼Œä¹Ÿå°±ä¸å­˜åœ¨â€œæ•°æ®æœ€ç»ˆè½ç›˜ï¼Œæ˜¯ç”± redo log æ›´æ–°è¿‡å»â€çš„æƒ…å†µã€‚<br><br>å¦‚æœæ˜¯æ­£å¸¸è¿è¡Œçš„å®ä¾‹çš„è¯ï¼Œæ•°æ®é¡µè¢«ä¿®æ”¹ä»¥åï¼Œè·Ÿç£ç›˜çš„æ•°æ®é¡µä¸ä¸€è‡´ï¼Œç§°ä¸ºè„é¡µã€‚æœ€ç»ˆæ•°æ®è½ç›˜ï¼Œå°±æ˜¯æŠŠå†…å­˜ä¸­çš„æ•°æ®é¡µå†™ç›˜ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œç”šè‡³ä¸ redo log æ¯«æ— å…³ç³»ã€‚<br><br> è¯·é—®è€å¸ˆè¿™ä¸ªâ€œæ•°æ®è½ç›˜â€æ˜¯å¦‚æœè¿›è¡Œçš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434193,"discussion_content":"åé¢æ–‡ç« ä¼šè¯´åˆ°å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545702729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53586,"user_name":"William","can_delete":false,"product_type":"c1","uid":1346215,"ip_address":"","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1545698377,"is_pvip":true,"replies":[{"id":"19481","content":"æ²¡æœ‰åŠæ³•ï¼Œä¼šä¸¢","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545702705,"ip_address":"","comment_id":53586,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545698377","product_id":100020801,"comment_content":"è¿½é—® 5ï¼šä¸å¼•å…¥ä¸¤ä¸ªæ—¥å¿—ï¼Œä¹Ÿå°±æ²¡æœ‰ä¸¤é˜¶æ®µæäº¤çš„å¿…è¦äº†ã€‚åªç”¨ binlog æ¥æ”¯æŒå´©æºƒæ¢å¤ï¼Œåˆèƒ½æ”¯æŒå½’æ¡£ï¼Œä¸å°±å¯ä»¥äº†ï¼Ÿ<br>å›ç­”ï¼šè¿™ä½åŒå­¦çš„æ„æ€æ˜¯ï¼Œåªä¿ç•™ binlogï¼Œç„¶åå¯ä»¥æŠŠæäº¤æµç¨‹æ”¹æˆè¿™æ ·ï¼šâ€¦ -&gt; â€œæ•°æ®æ›´æ–°åˆ°å†…å­˜â€ -&gt; â€œå†™ binlogâ€ -&gt; â€œæäº¤äº‹åŠ¡â€ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æä¾›å´©æºƒæ¢å¤çš„èƒ½åŠ›ï¼Ÿ<br><br>ç­”æ¡ˆæ˜¯ä¸å¯ä»¥ã€‚<br><br>å¦‚æœè¯´å†å²åŸå› çš„è¯ï¼Œé‚£å°±æ˜¯ InnoDB å¹¶ä¸æ˜¯ MySQL çš„åŸç”Ÿå­˜å‚¨å¼•æ“ã€‚MySQL çš„åŸç”Ÿå¼•æ“æ˜¯ MyISAMï¼Œè®¾è®¡ä¹‹åˆå°±æœ‰æ²¡æœ‰æ”¯æŒå´©æºƒæ¢å¤ã€‚<br><br><br><br>é‚£ä¹ˆè¯·é—®è€å¸ˆMyISam å¦‚ä½•æ¢å¤æ•°æ®ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":434192,"discussion_content":"æ²¡æœ‰åŠæ³•ï¼Œä¼šä¸¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545702705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53322,"user_name":"äº§å“åŠ©ç†","can_delete":false,"product_type":"c1","uid":1019821,"ip_address":"","ucode":"39A76D346A96E9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/ad/6e3e9e15.jpg","comment_is_top":false,"comment_ctime":1545626294,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545626294","product_id":100020801,"comment_content":"https:&#47;&#47;blog.csdn.net&#47;pml18710973036&#47;article&#47;details&#47;78452688<br><br>insert ... on duplicate ä¼šå¯¼è‡´æ­»é”çš„é—®é¢˜ï¼Œæ€ä¹ˆé¿å…å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":52436,"user_name":"è‚–é¹","can_delete":false,"product_type":"c1","uid":1302602,"ip_address":"","ucode":"BE1B8BD7053B9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/4a/c0a3cb3f.jpg","comment_is_top":false,"comment_ctime":1545382096,"is_pvip":false,"replies":[{"id":"19129","content":"Binlogå†™ç›˜çš„æœ€åä¸€æ­¥ã€‚<br><br>ä¸ä¼šä¸åˆç†æˆ‘è§‰å¾—ã€‚å› ä¸ºä¸¤é˜¶æ®µæäº¤æœ¬æ¥å°±è¦å…ˆæœ‰ä¸€ä¸ªäººæäº¤çš„å‘€ï¼Œåªä¸è¿‡binlogå…ˆäº†","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545401805,"ip_address":"","comment_id":52436,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545382096","product_id":100020801,"comment_content":"è¯·æ•™ä¸€ä¸ªxaäº‹åŠ¡çš„é—®é¢˜ã€‚<br>XAäº‹åŠ¡çš„è¿‡ç¨‹<br>é˜¶æ®µ1ï¼šInnoDB äº‹åŠ¡è¿›å…¥ prepare çŠ¶æ€,InnoDB redo log å†™ç›˜ã€‚<br>é˜¶æ®µ2ï¼šbinlog å†™ç›˜ï¼ŒInooDB äº‹åŠ¡è¿›å…¥ commit çŠ¶æ€<br>æ¯ä¸ªäº‹åŠ¡binlogçš„æœ«å°¾ï¼Œä¼šè®°å½•ä¸€ä¸ª XID eventï¼Œæ ‡å¿—ç€äº‹åŠ¡æ˜¯å¦æäº¤æˆåŠŸã€‚<br>æˆ‘çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªxid eventæ˜¯ä»€ä¹ˆæ—¶é—´å†™å…¥çš„å‘¢ï¼Ÿå¦‚æœbinlogå†™ç›˜çš„æ—¶å€™å—ï¼Ÿè¿™ä¸ªæ—¶é—´ç‚¹ innodb commitè¿˜æœªæ‰§è¡Œï¼Œè¿™æ ·åšæ˜¯ä¸æ˜¯ä¸å¤ªåˆç†ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433872,"discussion_content":"Binlogå†™ç›˜çš„æœ€åä¸€æ­¥ã€‚\n\nä¸ä¼šä¸åˆç†æˆ‘è§‰å¾—ã€‚å› ä¸ºä¸¤é˜¶æ®µæäº¤æœ¬æ¥å°±è¦å…ˆæœ‰ä¸€ä¸ªäººæäº¤çš„å‘€ï¼Œåªä¸è¿‡binlogå…ˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545401805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51503,"user_name":"tzgsuccess","can_delete":false,"product_type":"c1","uid":1214837,"ip_address":"","ucode":"65CB561BF8B06D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJeHXNIicCRGMibkmSkr9tiaHpbCjS2MGaLrCIhIVjlicAdNusOAfMMDRosU4NRm2XKA2uetZR7xaSoWQ/132","comment_is_top":false,"comment_ctime":1545190531,"is_pvip":false,"replies":[{"id":"18616","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545191139,"ip_address":"","comment_id":51503,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545190531","product_id":100020801,"comment_content":"æœ€ç»ˆå†™å…¥ç£ç›˜ï¼Œç£ç›˜ä¹Ÿæœ‰ç¼“å†²åŒºï¼Œæ•°æ®åº“æœ€ç»ˆè°ƒç”¨çš„æ˜¯flushè¿™ç§æœ€ç»ˆè½ç›˜çš„ç¡¬å†™å§ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433483,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545191139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51156,"user_name":"Smile","can_delete":false,"product_type":"c1","uid":1021017,"ip_address":"","ucode":"2002460CB3D869","user_header":"https://static001.geekbang.org/account/avatar/00/0f/94/59/ac2aa72b.jpg","comment_is_top":false,"comment_ctime":1545122033,"is_pvip":true,"replies":[{"id":"18440","content":"å—¯ï¼Œä½ è¯´çš„å¯¹çš„ï¼Œæˆ‘å‘ç°è¿™å—æˆ‘è®²çš„æœ‰æ­§ä¹‰ã€‚åŠ äº†è¯´æ˜ï¼ŒåŸæ¥æ˜¯è®¡åˆ’åœ¨åé¢çš„æ–‡ç« å±•å¼€çš„ï¼Œè¿™é‡Œå°±ç®€è¦è¯´æ˜äº†ä¸‹ğŸ˜“","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545126039,"ip_address":"","comment_id":51156,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545122033","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œå…³äºredo log æœ‰ä¸€ä¸ªç–‘æƒ‘ï¼š<br>-----------------<br>è¿™ä¸ªäº‹åŠ¡è¦å¾€ä¸¤ä¸ªè¡¨ä¸­æ’å…¥è®°å½•ï¼Œæ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ—¥å¿—éƒ½å¾—å…ˆä¿å­˜èµ·æ¥ï¼Œä½†åˆä¸èƒ½åœ¨è¿˜æ²¡ commit çš„æ—¶å€™å°±ç›´æ¥å†™åˆ° redo log æ–‡ä»¶é‡Œã€‚<br>-----------------<br>1. æ¯”å¦‚äº‹ç‰©æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯redo log buffer æ»¡äº†ï¼Œå¦‚æœä¸å†™åˆ°redo log æ–‡ä»¶ï¼Œä¸å°±å°´å°¬äº†ä¹ˆ<br>2.  æˆ‘ä¹‹å‰çš„ç†è§£ï¼Œæ˜¯åœ¨äº‹ç‰©beginä»¥åï¼Œä¼šé€æ­¥å†™redo log åˆ° æ–‡ä»¶çš„ï¼ˆbinlog æ˜¯ä¼šåœ¨commitçš„ä¸€ç¬é—´æ‰å†™ï¼‰ï¼Œæˆ–è€… master çº¿ç¨‹ä¹Ÿä¼šæ¯ç§’åˆ·ä¸€æ¬¡redo log bufferåˆ°redoæ–‡ä»¶ã€‚ --- ä¸çŸ¥é“æ˜¯ä¸æ˜¯å…¶ä»–èµ„æ–™æœ‰è¯¯ï¼Œæœ›è€å¸ˆæŒ‡æ­£ã€‚<br><br><br>","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433312,"discussion_content":"å—¯ï¼Œä½ è¯´çš„å¯¹çš„ï¼Œæˆ‘å‘ç°è¿™å—æˆ‘è®²çš„æœ‰æ­§ä¹‰ã€‚åŠ äº†è¯´æ˜ï¼ŒåŸæ¥æ˜¯è®¡åˆ’åœ¨åé¢çš„æ–‡ç« å±•å¼€çš„ï¼Œè¿™é‡Œå°±ç®€è¦è¯´æ˜äº†ä¸‹ğŸ˜“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545126039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51130,"user_name":"leohuachao","can_delete":false,"product_type":"c1","uid":1148284,"ip_address":"","ucode":"02FC4FCB6CE775","user_header":"https://static001.geekbang.org/account/avatar/00/11/85/7c/03a268fe.jpg","comment_is_top":false,"comment_ctime":1545118787,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545118787","product_id":100020801,"comment_content":"ä¸ºä»€ä¹ˆsqlä¹Ÿè¦è€ƒè™‘â€œå¹‚ç­‰æ€§â€å‘¢ï¼Œsqlé‡Œæ”¾ä¸šåŠ¡é€»è¾‘ä¸å¥½å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158901,"discussion_content":"å½“ç„¶ä¸å¥½ï¼Œä¸è¿‡è¿™é‡Œåº”è¯¥æ˜¯ä¸ºäº†è¯´æ˜é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51112,"user_name":"â˜","can_delete":false,"product_type":"c1","uid":1302793,"ip_address":"","ucode":"6FAEF05F234D2A","user_header":"https://static001.geekbang.org/account/avatar/00/13/e1/09/9483f537.jpg","comment_is_top":false,"comment_ctime":1545116089,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1545116089","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>        redo bufferå¾€redo logé‡Œé¢å†™å…¥æ˜¯æœ‰æœºåˆ¶çš„å§ï¼Œå¹¶ä¸åªæ˜¯ç­‰å¾…commitæ‰ä¼šå†™å…¥å§ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–åœºæ™¯ä¹Ÿä¼šè§¦å‘ä»bufferä¸­å†™å…¥åˆ°redo fileä¸­æ‰å¯¹","like_count":0,"discussions":[{"author":{"id":1099170,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c5/a2/4ece341b.jpg","nickname":"Ivan.Qi","note":"","ucode":"36F46A4D1F0EAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":179854,"discussion_content":"https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_6\n1.6 æ—¥å¿—åˆ·ç›˜çš„è§„åˆ™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582256812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158902,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51106,"user_name":"ç»“å†°çš„æ°´æ»´","can_delete":false,"product_type":"c1","uid":1350505,"ip_address":"","ucode":"088108D4848353","user_header":"https://static001.geekbang.org/account/avatar/00/14/9b/69/b844df30.jpg","comment_is_top":false,"comment_ctime":1545114866,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1545114866","product_id":100020801,"comment_content":"redo log buffer çš„å†…å®¹åªæœ‰åœ¨ commitçš„æ—¶å€™æ‰ä¼šå†™åˆ°ib_logæ–‡ä»¶ä¹ˆï¼Ÿï¼Œå¦‚æœäº‹åŠ¡æ¯”è¾ƒå¤§ï¼Œredo log buffer æ»¡äº† æ€ä¹ˆåŠ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158903,"discussion_content":"ä¼šæœ‰ç›¸åº”çš„æœºåˆ¶å‘redo logå†™çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51003,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1082187,"ip_address":"","ucode":"FC323371453C97","user_header":"https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg","comment_is_top":false,"comment_ctime":1545098073,"is_pvip":false,"replies":[{"id":"18519","content":"è§¦å‘å™¨ä¸è¡Œï¼Œå¯ä»¥è€ƒè™‘å­˜å‚¨è¿‡ç¨‹ã€‚<br>ä½ è¿™ä¸ªä¸šåŠ¡é€»è¾‘æ„Ÿè§‰å­˜å‚¨è¿‡ç¨‹æ›´ç›´è§‚å‘€","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545158277,"ip_address":"","comment_id":51003,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545098073","product_id":100020801,"comment_content":"è€å¸ˆå¥½ï¼<br>æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šAã€Bä¸¤å¼ ä¸€æ ·çš„è¡¨ï¼Œå…¶ä¸­ä¸€ä¸ªè¡¨æ›´æ–°æˆ–è€…æ’å…¥æ—¶éƒ½èƒ½å¤Ÿè®©å¯¹æ–¹æ„ŸçŸ¥åˆ°å¹¶ä¸”ä¹Ÿåšç›¸åº”çš„æ›´æ–°æˆ–è€…æ’å…¥ï¼Œæ›´æ–°åˆ™ä»¥ä¸»é”®IDä¸ºæ¡ä»¶ã€‚<br>ä¸»è¦æ˜¯æƒ³åœ¨MySQLå±‚å»å®ç°ï¼Œæ‰€ä»¥æƒ³åˆ°äº†è§¦å‘å™¨ï¼Œä½†è§¦å‘å™¨ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼Œå³ï¼šä¸èƒ½è®©ä¸¤ä¸ªè§¦å‘å™¨è§¦å‘ä¸¤ä¸ªè¡¨ï¼Œå¹¶ä½¿ä¹‹å¾ªç¯ã€‚<br>å¦‚ï¼šè§¦å‘å™¨aè§¦å‘bè¡¨çš„insertæ“ä½œï¼Œå¹¶å¾€dè¡¨insertæ•°æ®ï¼›è§¦å‘å™¨cè§¦å‘dè¡¨çš„insertæ“ä½œï¼Œå¹¶å¾€è¡¨b insertæ•°æ®ï¼›è¿™æ—¶ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼šï¼ˆæ–¹æ¡ˆä¸€ï¼‰<br>Can&#39;t update table &#39;b&#39; in stored function&#47;trigger because it is already used by statement which invoked this stored function&#47;trigger.<br>äºæ˜¯æƒ³èƒ½ä¸èƒ½åœ¨å®é™…æ’å…¥ä¹‹å‰åšä¸ªåˆ¤æ–­ï¼Œå¦‚æœå­˜åœ¨å°±ä¸åšinsertï¼Œå¦åˆ™åšinsertã€‚ä½†å¥½åƒè¿™ä¸ªåˆ¤æ–­è¯­å¥åœ¨è¢«æ‰§è¡Œä¹‹å‰å°±æŠ¥ä¸Šé¢çš„é”™è¯¯äº†ã€‚ï¼ˆæ–¹æ¡ˆäºŒï¼‰<br><br>é—®é¢˜ï¼š<br>1.MySQLå±‚é¢è¿™ä¸ªéœ€æ±‚æ˜¯çœŸå®ç°ä¸äº†å—ï¼Œè¿˜æ˜¯è¯´éœ€è¦åšä»€ä¹ˆé…ç½®å‘¢<br>2.å¦‚æœèƒ½å®ç°çš„è¯ï¼Œä¼šå¯¹MySQLæœ¬èº«å¸¦æ¥ä»€ä¹ˆæ ·çš„å½±å“å—<br>3.å¦‚æœä¸èƒ½å®ç°çš„è¯ï¼Œå¯å¦å€Ÿç”¨ç¬¬ä¸‰æ–¹æ’ä»¶å»å®ç°å‘¢ <br><br>å¸Œæœ›è€å¸ˆèƒ½å¸®å¿™è§£ç­”ä¸‹é—®é¢˜ï¼Œè°¢è°¢ï¼<br><br>æ–¹æ¡ˆä¸€ï¼š<br>----------------------------------------------------<br>drop trigger if exists t_afterinsert_on_a$<br>create trigger t_afterinsert_on_a<br>after insert on a<br>for each row<br>begin<br>\tinsert into b values (new.id, new.name, new.city_id);<br>end$<br><br>drop trigger if exists t_afterinsert_on_b$<br>create trigger t_afterinsert_on_b<br>after insert on b<br>for each row<br>begin<br>\tinsert into a values (new.id, new.name, new.city_id);<br>end$<br>----------------------------------------------------<br>æ–¹æ¡ˆäºŒï¼š<br>----------------------------------------------------<br>drop trigger if exists t_before_insert_on_a$<br>create trigger t_before_insert_on_a<br>before insert on a<br>for each row<br>begin<br>declare c_id int default 0;<br>select max(id)+1 into c_id from a;<br>if not exists (select id from b where id = c_id) then<br>\tinsert into b values (c_id, new.name, new.city_id);<br>end if;<br>end$<br><br>drop trigger if exists t_before_insert_on_b$<br>create trigger t_before_insert_on_b<br>before insert on b<br>for each row<br>begin<br>declare c_id int default 0;<br>select max(id)+1 into c_id from b;<br>if not exists (select id from a where id = c_id) then<br>\tinsert into a values (c_id, new.name, new.city_id);<br>end if;<br>end$<br>----------------------------------------------------","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433225,"discussion_content":"è§¦å‘å™¨ä¸è¡Œï¼Œå¯ä»¥è€ƒè™‘å­˜å‚¨è¿‡ç¨‹ã€‚\nä½ è¿™ä¸ªä¸šåŠ¡é€»è¾‘æ„Ÿè§‰å­˜å‚¨è¿‡ç¨‹æ›´ç›´è§‚å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545158277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50951,"user_name":"å³°å“¥","can_delete":false,"product_type":"c1","uid":1301870,"ip_address":"","ucode":"CB0652D3EF49A1","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/6e/f3cfebc5.jpg","comment_is_top":false,"comment_ctime":1545093079,"is_pvip":false,"replies":[{"id":"18345","content":"å¦‚æœæ•¢å…³é—­binlog,ä¸€å®šæ˜¯å·²ç»èƒ½å¤Ÿç”¨redo logæ¥æ¢å¤æ•°æ®äº†å§","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545100721,"ip_address":"","comment_id":50951,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545093079","product_id":100020801,"comment_content":"é˜¿é‡Œäº‘çš„polarDBå®˜æ–¹è¯´æ˜ï¼šç”±äºæ˜¯åŸºäºredologçš„ç‰©ç†å¤åˆ¶æ„å»ºå¤åˆ¶å…³ç³»ï¼Œæ‰€ä»¥é»˜è®¤å…³é—­binlogã€‚<br>æˆ‘çš„ç†è§£æ˜¯ä¸»è¦è¿˜æ˜¯ä¸ºäº†æå‡æ€§èƒ½æ‰€ä»¥å…³é—­ï¼Œé‚£ä¹ˆå°±æ— æ³•åšåˆ°â€æ¢å¤åˆ°ä»»æ„ä¸€ç§’â€äº†å§;å¦å¤–å¦‚æœæ˜¯ç‰©ç†å¤åˆ¶redologï¼Œå¦‚æœredoæ–‡ä»¶æŸå,è¿˜æ˜¯ä¼šæœ‰æ•°æ®ä¸¢å¤±ï¼Œä¸çŸ¥é“polarDBæœ‰å“ªäº›æœºåˆ¶æ¥é¿å…ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433198,"discussion_content":"å¦‚æœæ•¢å…³é—­binlog,ä¸€å®šæ˜¯å·²ç»èƒ½å¤Ÿç”¨redo logæ¥æ¢å¤æ•°æ®äº†å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545100721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50870,"user_name":"éƒ­æ±Ÿä¼Ÿ","can_delete":false,"product_type":"c1","uid":1313994,"ip_address":"","ucode":"613D638619B5A2","user_header":"https://static001.geekbang.org/account/avatar/00/14/0c/ca/6173350b.jpg","comment_is_top":false,"comment_ctime":1545058276,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545058276","product_id":100020801,"comment_content":"æ— æ³•è¿½åŠ è¯„è®º ï¼Œæˆ‘ä¹‹å‰çš„ç•™è¨€è€å¸ˆé—®åˆ°è¿è¡Œhexdumpæ—¶æœ‰æ²¡æœ‰å…³é—­MySQL ã€‚ æ²¡å…³é—­<br>ä½†æ˜¯æˆ‘åœ¨updateåç´§æ¥ç€æ’å…¥ä¸€æ¡æ•°æ® hexdumpå¯ä»¥çœ‹åˆ°æ–°æ’å…¥çš„æ•°æ®","like_count":0},{"had_liked":false,"id":50861,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1545056252,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545056252","product_id":100020801,"comment_content":"redo log(é‡åšæ—¥å¿—)ä½œç”¨ï¼Œäº‹åŠ¡å›æ»šæˆ–è€…æ•°æ®åº“å´©æºƒã€‚bin log(å½’æ¡£æ—¥å¿—)ä½œç”¨ï¼Œä¸»ä»å¤åˆ¶ã€‚å…·ä½“çš„æäº¤é¡ºåºï¼Œ1 å…ˆå†™å…¥åˆ°redo logï¼Œå¤„äºprepareé˜¶æ®µï¼Œå†å†™å…¥åˆ°bin logï¼Œå†æäº¤ redo logæ‰“ä¸Šcommitæ ‡è®°ï¼Œè¿›è¡Œæäº¤ã€‚å¦‚æœredo logå¤„äºprepareé˜¶æ®µï¼Œéœ€è¦çœ‹ä¸‹bin logæ˜¯å¦å®Œæ•´ï¼Œå®Œæ•´åˆ™æäº¤ï¼Œä¸å®Œæ•´åˆ™å›æ»šã€‚","like_count":0},{"had_liked":false,"id":50855,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1545055196,"is_pvip":false,"replies":[{"id":"18283","content":"æˆ‘çš„è§£å†³å»ºè®®é‡Œå°±æ˜¯æœ‰è¿™ä¸ªå”¯ä¸€æ€§çº¦æŸå‘€","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545056386,"ip_address":"","comment_id":50855,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545055196","product_id":100020801,"comment_content":"è€å¸ˆ åé¢é‚£ä¸ªæ¡ˆä¾‹ï¼Œåœ¨ä¸šåŠ¡ä¸­è¯¥æ€ä¹ˆè®¾è®¡é¿å…ï¼›å¦‚æœæˆ‘ç»™like è¡¨é‡Œçš„ user_id å’Œ like_id ä¸€èµ·åŠ  unique çº¦æŸï¼Œåœ¨ä¸šåŠ¡ä¸­å¦‚æœæŠ¥å”¯ä¸€çº¦æŸçš„é”™å°±å†æ¬¡æŸ¥è¯¢æ›´æ–°æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433143,"discussion_content":"æˆ‘çš„è§£å†³å»ºè®®é‡Œå°±æ˜¯æœ‰è¿™ä¸ªå”¯ä¸€æ€§çº¦æŸå‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545056386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50847,"user_name":"åŒ…åŒ…up","can_delete":false,"product_type":"c1","uid":1073495,"ip_address":"","ucode":"A6F51A62A8B362","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/57/6f3c81dd.jpg","comment_is_top":false,"comment_ctime":1545054260,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545054260","product_id":100020801,"comment_content":"é€šè¿‡æ„é€ ä¸¤ä¸ªäº‹åŠ¡ï¼Œå…ˆåå»æäº¤updateè¯­å¥ï¼Œå‘ç°åæäº¤çš„äº‹åŠ¡åœ¨ç­‰å¾…é”ã€‚å¾—å‡ºmysqlé€‰æ‹©çš„ç­–ç•¥æ˜¯3.InnoDB è®¤çœŸæ‰§è¡Œäº†â€œæŠŠè¿™ä¸ªå€¼ä¿®æ”¹æˆ (1,2)&quot;è¿™ä¸ªæ“ä½œï¼Œè¯¥åŠ é”çš„åŠ é”ï¼Œè¯¥æ›´æ–°çš„æ›´æ–°ã€‚<br><br>åŸå› çš„è¯æˆ‘æƒ³åˆ°äº†ä¸€ä¸ªï¼Œåœ¨å¯é‡å¤è¯»æ¨¡å¼ä¸‹ï¼Œå¦‚æœä¸åŠ é”ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´æ›´æ–°ä¸¢å¤±ã€‚","like_count":0},{"had_liked":false,"id":50839,"user_name":"ç‹å­ç‘Alilokeæœ‰äº‹ç”µè”","can_delete":false,"product_type":"c1","uid":1249400,"ip_address":"","ucode":"9ABE8E475E336B","user_header":"https://static001.geekbang.org/account/avatar/00/13/10/78/29bd3f1e.jpg","comment_is_top":false,"comment_ctime":1545053306,"is_pvip":false,"replies":[{"id":"18269","content":"ä¸‹å‘¨å°±æ¥å•¦<br><br>é”æˆ‘ä»¬è¿˜æ²¡è®²å®Œï¼Œè¿˜æ²¡åˆ°æ€»ç»“çš„æ—¶å€™ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055161,"ip_address":"","comment_id":50839,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545053306","product_id":100020801,"comment_content":"è€å¸ˆï¼ŒæœŸå¾…æ‚¨å‡ºä¸€ç¯‡:mysqlé”çš„æ€»ç»“ï¼Œmysqlç´¢å¼•çš„æ€»ç»“~ä¸Šå‘¨è¢«é—®åˆ°èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•ï¼Œé—´éš™é”ï¼ŒğŸ˜‚æƒ­æ„§ï¼Œæ²¡ç­”å¥½ï¼Œæƒ³å¾ˆå¤šäººä¼šé‡åˆ°ï¼ŒæœŸå¾…æ‚¨çš„è§£è¯»ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433136,"discussion_content":"ä¸‹å‘¨å°±æ¥å•¦\n\né”æˆ‘ä»¬è¿˜æ²¡è®²å®Œï¼Œè¿˜æ²¡åˆ°æ€»ç»“çš„æ—¶å€™ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50836,"user_name":"ç‹å­ç‘Alilokeæœ‰äº‹ç”µè”","can_delete":false,"product_type":"c1","uid":1249400,"ip_address":"","ucode":"9ABE8E475E336B","user_header":"https://static001.geekbang.org/account/avatar/00/13/10/78/29bd3f1e.jpg","comment_is_top":false,"comment_ctime":1545053075,"is_pvip":false,"replies":[{"id":"18270","content":"ğŸ‘ğŸ¿<br><br>å¤§å®¶æœ‰æ”¶è·æˆ‘ç‰¹åˆ«å¼€å¿ƒ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055200,"ip_address":"","comment_id":50836,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545053075","product_id":100020801,"comment_content":"è€å¸ˆï¼ŒçœŸæ˜¯ç”±è¡·åœ°ä½©æœ:<br>1.æŠ€æœ¯ç‰›ï¼Œä½œä¸ºä¸€åjavaå¼€å‘ï¼Œå¸¸ç”¨mysqlï¼Œä½†ä¸çŸ¥å…¶åŸç†ã€‚è€å¸ˆçš„è®²æˆä¸ºæˆ‘å°†mysqlç ´å¼€äº†ï¼Œå‘ˆç°å…¶è„‰ç»œï¼Œå¹¶è¯¦ç»†è®²è§£ï¼<br>2.ç”¨å¿ƒæˆè¯¾:ä¸è¾è¾›åŠ³çš„ç­”ç–‘ï¼Œè¿˜ç‰¹æ„æ•´ç†äº†ç­”ç–‘å†…å®¹ã€‚è™½ç„¶ç°åœ¨è¿˜æ˜¯æœ‰äº›çŸ¥è¯†è§‰å¾—æ¯”è¾ƒæ·±ï¼Œéš¾æ‡‚ï¼Œç›¸ä¿¡è·Ÿç€è€å¸ˆï¼Œèƒ½ç²¾é€šmysqlã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433133,"discussion_content":"ğŸ‘ğŸ¿\n\nå¤§å®¶æœ‰æ”¶è·æˆ‘ç‰¹åˆ«å¼€å¿ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50811,"user_name":"æ…§é‘«coming","can_delete":false,"product_type":"c1","uid":1324385,"ip_address":"","ucode":"7BAC9CA255630E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLE4LYb3jrH63ZV98Zpc8DompwDgb1O3nffMoZCmiaibauRyEFv6NDNsST9RWxZExvMLMWb50zaanoQ/132","comment_is_top":false,"comment_ctime":1545049282,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545049282","product_id":100020801,"comment_content":"@ä¿¡ ä¿¡ï¼ŒåŒé—®<br>å¦‚æœå›¾1çš„â€œå†™å…¥redo logâ€æ˜¯å†™å†…å­˜ï¼Œå½“æ—¶åˆ»Bå‘ç”Ÿcrashï¼Œé‡å¯åè¿™éƒ¨åˆ†redo logéƒ½ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆä½•è°ˆåˆ¤æ–­redo logæ˜¯å¦æœ‰å®Œæ•´çš„prepareè¿˜æ˜¯commitæ ‡å¿—å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158906,"discussion_content":"prepareä¹Ÿæ˜¯è¦å°†é¡µå˜æ›´è½ç›˜åˆ°redo logä¸­å§ï¼Œä¸ä¼šåœ¨å†…å­˜é‡Œçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50809,"user_name":"é¹","can_delete":false,"product_type":"c1","uid":1209661,"ip_address":"","ucode":"B514BA450CB317","user_header":"","comment_is_top":false,"comment_ctime":1545049041,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545049041","product_id":100020801,"comment_content":"æ›´æ–°è®°å½•éƒ½æ˜¯å…ˆå†™åˆ°å†…å­˜é¡µä¸Šçš„ï¼Œä½†æ˜¯æ€ä¹ˆå®šä½åˆ°å†™åˆ°å“ªä¸€ä¸ªå†…å­˜é¡µå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158908,"discussion_content":"redo logåº”è¯¥è®°äº†å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50808,"user_name":"å«æ±Ÿ","can_delete":false,"product_type":"c1","uid":1101226,"ip_address":"","ucode":"DE2F7A6916F1A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/aa/33d48789.jpg","comment_is_top":false,"comment_ctime":1545049003,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545049003","product_id":100020801,"comment_content":"æ€è€ƒé¢˜ï¼Œæˆ‘æ„Ÿè§‰æ˜¯ç¬¬ä¸‰ç§ï¼Œå› ä¸ºå†™éƒ½æ˜¯å½“å‰è¯»ï¼Œè¿™æ ·æ‰ä¸ä¼šè¦†ç›–å…¶ä»–äº‹åŠ¡çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ï¼Œåœ¨å¯é‡å¤è¯»çš„äº‹åŠ¡éš”ç¦»ä¸‹ï¼Œåªæœ‰ç¬¬ä¸‰ç§æ‰èƒ½ä¿è¯ï¼ŒåŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ¥ä¸‹æ¥çš„è¯­å¥å¯ä»¥çœ‹åˆ°æœ€æ–°çš„å€¼ã€‚","like_count":0},{"had_liked":false,"id":50803,"user_name":"Ryoma","can_delete":false,"product_type":"c1","uid":1130590,"ip_address":"","ucode":"7F692369239692","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","comment_is_top":false,"comment_ctime":1545048801,"is_pvip":true,"replies":[{"id":"18275","content":"åˆ†å¸ƒå¼é”çœ‹ä¸Šå»æ›´å¤æ‚ï¼Œä¸é”™æ¥åˆ†äº«ä¸€ä¸‹ä½ çš„è§£å†³æ–¹æ¡ˆå§ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055498,"ip_address":"","comment_id":50803,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1545048801","product_id":100020801,"comment_content":"å…³ç³»ä¸šåŠ¡è®¾è®¡é—®é¢˜ï¼Œæˆ‘å€’æ˜¯æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œä¸ªäººè§‰å¾—ç”±MySQLåšè¿™ç§å¤æ‚çš„æ“ä½œä¸å¤ªåˆé€‚ï¼Œä¹Ÿä¸å¤ªå¥½ç†è§£ã€‚è¿™ä¸ªé—®é¢˜æœ¬è´¨å…¶å®æ˜¯å¹¶å‘é—®é¢˜ï¼Œè¿™ç§å…ˆcheckå†updateçš„åœºæ™¯å…¶å®æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€ä¸ªåˆ†å¸ƒå¼é”æ¥è§£å†³æ›´ç®€å•ä¸€ç‚¹ï¼Œä¿è¯åœ¨selectã€update çš„è¿‡ç¨‹ä¸­ä¸ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433114,"discussion_content":"åˆ†å¸ƒå¼é”çœ‹ä¸Šå»æ›´å¤æ‚ï¼Œä¸é”™æ¥åˆ†äº«ä¸€ä¸‹ä½ çš„è§£å†³æ–¹æ¡ˆå§ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055498,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50766,"user_name":"å³°å“¥","can_delete":false,"product_type":"c1","uid":1301870,"ip_address":"","ucode":"CB0652D3EF49A1","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/6e/f3cfebc5.jpg","comment_is_top":false,"comment_ctime":1545041704,"is_pvip":false,"replies":[{"id":"18217","content":"æ²¡æœ‰å§ï¼Ÿ<br><br>è€Œä¸”åƒæˆ‘æ–‡ä¸­è¯´çš„ï¼Œå…³é—­binlogå…¶å®å´©æºƒæ¢å¤æ²¡é—®é¢˜çš„ï¼Œ<br>å¦‚æœå·²ç»å®ç°äº†â€œç”¨redo logæ¥å½’æ¡£å’Œæ¢å¤å†å²æ•°æ®â€ï¼Œ å¤‡ä»½é—®é¢˜ä¹Ÿè§£å†³äº†, å®‰å…¨çº§åˆ«æ²¡é™ä½ã€‚ä¸è¿‡è¦è§£å†³ä¸‹æ¸¸æ¶ˆè´¹é—®é¢˜ã€‚<br><br>Archive æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545047131,"ip_address":"","comment_id":50766,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1545041704","product_id":100020801,"comment_content":"ç°åœ¨ä¸€äº›äº‘è®¡ç®—å‚å•†å¼€å‘çš„åŸºäºmysqlçš„äº‘æ•°æ®åº“ï¼Œä¸ºäº†æ€§èƒ½ï¼Œé»˜è®¤å…³é—­äº†binlog,é‚£ä¹ˆåœ¨å®‰å…¨çº§åˆ«ä¸Šæ˜¯å¦é™ä½äº†ï¼Ÿarchiveåˆæ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433090,"discussion_content":"æ²¡æœ‰å§ï¼Ÿ\n\nè€Œä¸”åƒæˆ‘æ–‡ä¸­è¯´çš„ï¼Œå…³é—­binlogå…¶å®å´©æºƒæ¢å¤æ²¡é—®é¢˜çš„ï¼Œ\nå¦‚æœå·²ç»å®ç°äº†â€œç”¨redo logæ¥å½’æ¡£å’Œæ¢å¤å†å²æ•°æ®â€ï¼Œ å¤‡ä»½é—®é¢˜ä¹Ÿè§£å†³äº†, å®‰å…¨çº§åˆ«æ²¡é™ä½ã€‚ä¸è¿‡è¦è§£å†³ä¸‹æ¸¸æ¶ˆè´¹é—®é¢˜ã€‚\n\nArchive æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545047131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158911,"discussion_content":"archiveåº”è¯¥æ˜¯æƒ³é—®redo logå¦‚ä½•åšåˆ°å½’æ¡£å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580637901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50741,"user_name":"æ–œé¢é•œå­ Bill","can_delete":false,"product_type":"c1","uid":1305242,"ip_address":"","ucode":"B5505F94540D52","user_header":"https://static001.geekbang.org/account/avatar/00/13/ea/9a/02d589f9.jpg","comment_is_top":false,"comment_ctime":1545037442,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545037442","product_id":100020801,"comment_content":"ä¼šé€‰æ‹©ç¬¬äºŒç§ï¼Œæ›´æ–°è™½ç„¶æ˜¯å…ˆè¯»åå†™çš„ï¼Œä½†æ˜¯åŸºäºâ€œå½“å‰è¯»â€å’Œâ€œå¿«ç…§è¯»â€çš„ç†è§£ï¼Œè¯»å’Œæ›´æ–°æ˜¯å®Œå…¨ä¸åŒçš„è·¯å¾„ï¼Œæ›´æ–°éœ€è¦æŒé”æ“ä½œï¼Œä¸€å®šéœ€è¦è¿›å…¥åˆ°å¼•æ“å±‚ï¼Œè‡³äºæ˜¯å¦é‡å¤æ›´æ–°æˆ‘ç†è§£ redoçºªå½•çš„æ˜¯ç‰©ç†é¡µçš„å˜æ›´ä¿¡æ¯ï¼Œå¦‚æœå˜æ›´å‰åå€¼ä¸æ”¹å˜ï¼Œredoå…¶å®æ˜¯æ²¡æœ‰å†…å®¹éœ€è¦çºªå½•çš„ï¼Œæ‰€ä»¥binlogä¹Ÿæ²¡æœ‰å†…å®¹ï¼Œæ‰€ä»¥å°±ç›´æ¥è¿”å›äº†ï¼","like_count":0},{"had_liked":false,"id":50717,"user_name":"Jadic","can_delete":false,"product_type":"c1","uid":1005121,"ip_address":"","ucode":"C6DE22C449B911","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/41/050144c7.jpg","comment_is_top":false,"comment_ctime":1545034346,"is_pvip":false,"replies":[{"id":"18276","content":"å—¯ï¼Œèƒ½ä¿æŒç®€å•æœ€å¥½äº†ã€‚<br><br>ä¸è¿‡ç¡®å®è¿™ä¸ªä¾‹å­é‡Œï¼Œè¦é¿å…å‡ºç°è¿™ä¸ªbug, æ˜¯éœ€è¦ä¸€äº›å¤æ‚åŒ–ä¿®æ”¹ã€‚<br><br>æ–¹æ¡ˆè‚¯å®šä¸æ­¢ä¸€ä¸ªğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545055583,"ip_address":"","comment_id":50717,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545034346","product_id":100020801,"comment_content":"æ¥å‰é¢ç•™è¨€é—æ¼éƒ¨åˆ†ã€‚<br>ç›¸äº’å…³æ³¨éœ€æ±‚åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ç»¼åˆè¯»ä¸šåŠ¡çš„éœ€æ±‚ï¼Œæ˜¯ä¸æ˜¯å°†åŸé¢˜ä¸»çš„è¯‰æ±‚åœ¨åº”ç”¨å±‚è§£å†³ï¼Œä¿æŒDBè¡¨ç»“æ„çš„ç®€å•åŒ–ï¼Œè¿™æ ·æ›´åŠ åˆç†ç‚¹ï¼Œè°¢è°¢ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433072,"discussion_content":"å—¯ï¼Œèƒ½ä¿æŒç®€å•æœ€å¥½äº†ã€‚\n\nä¸è¿‡ç¡®å®è¿™ä¸ªä¾‹å­é‡Œï¼Œè¦é¿å…å‡ºç°è¿™ä¸ªbug, æ˜¯éœ€è¦ä¸€äº›å¤æ‚åŒ–ä¿®æ”¹ã€‚\n\næ–¹æ¡ˆè‚¯å®šä¸æ­¢ä¸€ä¸ªğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545055583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50713,"user_name":"Jadic","can_delete":false,"product_type":"c1","uid":1005121,"ip_address":"","ucode":"C6DE22C449B911","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/41/050144c7.jpg","comment_is_top":false,"comment_ctime":1545033658,"is_pvip":false,"replies":[{"id":"18207","content":"å—¯ï¼Œä½ è¿™ä¸ªé—®é¢˜é—®å¾—å¥½ï¼Œ<br><br>å—¯ï¼Œè¿™æ ·æœ€å¥½å°±æ˜¯æŠŠorçš„æ¡ä»¶åˆ†æˆä¸¤ä¸ªè¯­å¥ï¼Œ<br>æˆ–è€…ç”¨union all çš„å†™æ³•ï¼Œ<br><br>User_idå’Œliker_idåˆ†åˆ«å•ç‹¬å»ºç´¢å¼•ã€‚<br><br><br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545042074,"ip_address":"","comment_id":50713,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1545033658","product_id":100020801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå…³äºç”¨æˆ·ç›¸äº’å…³æ³¨çš„è¿™ä¸ªä¸šåŠ¡è®¾è®¡æ–¹æ¡ˆå¾ˆå·§å¦™ï¼Œè§£å†³äº†å†²çªçš„é—®é¢˜ã€‚ä½†æˆ‘æƒ³åˆ°å¦ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ­£å¸¸ä¸šåŠ¡ä¸­åº”è¯¥ä¼šæœ‰æŸ¥è¯¢çš„éœ€æ±‚ï¼Œæ¯”å¦‚æŸ¥è¯¢æŸäººå…³æ³¨çš„ç”¨æˆ·æˆ–å…³æ³¨äº†æŸäººçš„ç”¨æˆ·æˆ–è€…å…³æ³¨æ•°ç­‰é«˜é¢‘åœºæ™¯çš„æ—¶å€™ï¼Œè¿™æ ·çš„æŸ¥è¯¢æ¡ä»¶ä¸­æ˜¯ä¸æ˜¯æœ‰ç»„åˆçš„æƒ…å†µï¼Œä¸çŸ¥é“å¦‚ä¸‹çš„æŸ¥è¯¢æ•ˆç‡æ€ä¹ˆæ ·:<br><br>-- ç”¨æˆ·1æ‰€å…³æ³¨çš„ç”¨æˆ·<br>select *<br>from like<br>where (user_id=1 and relation_ship &amp; 1=1)<br>       or (liker_id=1 and relation_ship &amp; 2=2)","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433070,"discussion_content":"å—¯ï¼Œä½ è¿™ä¸ªé—®é¢˜é—®å¾—å¥½ï¼Œ\n\nå—¯ï¼Œè¿™æ ·æœ€å¥½å°±æ˜¯æŠŠorçš„æ¡ä»¶åˆ†æˆä¸¤ä¸ªè¯­å¥ï¼Œ\næˆ–è€…ç”¨union all çš„å†™æ³•ï¼Œ\n\nUser_idå’Œliker_idåˆ†åˆ«å•ç‹¬å»ºç´¢å¼•ã€‚\n\n\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545042074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158912,"discussion_content":"useridå°±ä¸ç”¨å»ºç´¢å¼•äº†å§ï¼Œå¯ä»¥ç›´æ¥ç”¨UKçš„å‰ç¼€ç´¢å¼•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580638051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50638,"user_name":"ä¿¡ä¿¡","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1545020944,"is_pvip":false,"replies":[{"id":"18281","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545056201,"ip_address":"","comment_id":50638,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545020944","product_id":100020801,"comment_content":"è¿½é—®4æ€è€ƒï¼šä¸ºå•¥ä¸èƒ½å…ˆåˆ·ç›˜redoï¼Œç„¶åæ ¹æ®redoä¿®å¤binlogå‘¢ï¼Ÿæˆ‘æƒ³åŸå› æœ‰ä¸¤ç‚¹ï¼š1ã€è¿™æ˜¯éµå¾ªâ€œç­‰ä¸¤è€…éƒ½okâ€ç†å¿µï¼Œå‰é¢redoå·²ç»prepareäº†ï¼Œé‚£æ¥ä¸‹æ¥binlogå…ˆåˆ·ç›˜ï¼Œå‡ºé”™çš„æ¦‚ç‡å°±ä¼šå°ä¸€ç‚¹ï¼›2ã€ä¿®å¤binlogä¹‹å‰å·²ç»åŒæ­¥ç»™ä»æœåŠ¡å™¨äº†ï¼Œä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´ã€‚ä¸çŸ¥æˆ‘æƒ³çš„æ˜¯å¦æ­£ç¡®ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433047,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545056201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50636,"user_name":"ä¿¡ä¿¡","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1545020078,"is_pvip":false,"replies":[{"id":"18280","content":"å¯¹ï¼Œå›¾1é‡Œé¢æ˜¯å†™ç›˜","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1545056176,"ip_address":"","comment_id":50636,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1545020078","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œå›¾1çš„å†™å…¥redo logå’Œå†™binlogæŒ‡çš„æ˜¯åˆ·ç›˜ï¼Œä¸æ˜¯å†™å†…å­˜å—ï¼Ÿéšçº¦è®°å¾—binlogæ˜¯å…ˆä¸€æ­¥åˆ·ç›˜çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433046,"discussion_content":"å¯¹ï¼Œå›¾1é‡Œé¢æ˜¯å†™ç›˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545056176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50616,"user_name":"é“çš®","can_delete":false,"product_type":"c1","uid":1013200,"ip_address":"","ucode":"E20FB02D9ABD20","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/d0/0053c9ba.jpg","comment_is_top":false,"comment_ctime":1545016804,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545016804","product_id":100020801,"comment_content":"è¯¾åè§£ç­”ï¼š<br>   update t set a = 2 where id = 1;<br>ä¸ªäººè®¤ä¸ºåº”è¯¥æ˜¯ç¬¬äºŒç§ã€‚<br><br>æ„é€ å®éªŒæ–¹å¼ï¼š<br>1. å…ˆæ‰§è¡Œäº‹åŠ¡A<br>   start transaction;<br>   update t set a = a + 1 where id = 1;<br>2. ç„¶åæ‰§è¡Œäº‹åŠ¡B<br>    update t set a = 2 where id = 1;<br>å½“äº‹åŠ¡Aä¸æ‰§è¡Œcommit;æ—¶ï¼Œäº‹åŠ¡Bæ‰§è¡Œupdateè¯­å¥å°†è¢«é”ä½ã€‚é‚£è¯æ˜éœ€è¦åŠ é”çš„ï¼Œé‚£ä¹ˆç¬¬ä¸€ç§é€‰æ‹©æ˜¯é”™è¯¯çš„ã€‚å®ƒéœ€è¦è°ƒç”¨å¼•æ“æä¾›çš„æ¥å£æ¥ä¿è¯æ•°æ®çš„å®‰å…¨ã€‚<br><br>ä¸ºä»€ä¹ˆä¸æ˜¯ç¬¬ä¸‰ç§ï¼Ÿ<br>æˆ‘æ˜¯åœ¨æ‰§è¡Œupdate t set a = 2 where id = 1;è¯­å¥æ—¶å‘ç°ç»“æœçš„0 rows affectedçš„è¯ï¼Œbinlongå¹¶æ²¡æœ‰äº§ç”Ÿæ–°çš„æ•°æ®ã€‚é‚£ä¹ˆæˆ‘çŒœæƒ³çš„æ˜¯ï¼šMySQLè°ƒç”¨å¼•æ“æä¾›çš„æ¥å£è¿”å›çš„ç»“æœå°±æ˜¯0 rows affectedã€‚é‚£ä¹ˆMysqlå°±ä¸ä¼šå†™å…¥åˆ°binlogä¸­ï¼Œé‚£ä¹ˆredo logä¹Ÿåº”è¯¥ä¸ä¼šå†™ã€‚æ‰€ä»¥å¹¶æ²¡æœ‰æ›´æ–°ã€‚<br><br>ä»¥ä¸Šåªæ˜¯ä¸ªäººè§è§£ã€‚è¿˜è¯·è€å¸ˆç»™å‡ºæ„è§å“ˆã€‚<br><br>","like_count":0},{"had_liked":false,"id":50613,"user_name":"è ¢è ¢æ¬²åŠ¨çš„è…¹è‚Œ","can_delete":false,"product_type":"c1","uid":1007326,"ip_address":"","ucode":"B10550BF463017","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/de/4e7ec66d.jpg","comment_is_top":false,"comment_ctime":1545016487,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545016487","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä½ å¥½<br>åœ¨ä¸šåŠ¡è®¾è®¡é—®é¢˜çš„å®ç°æªæ–½ä¸­ï¼ŒAå…³æ³¨Bçš„æ—¶å€™ï¼Œé€»è¾‘æ”¹æˆå¦‚ä¸‹æ‰€ç¤ºçš„æ ·å­è¿™å¥è¯åè¾¹æ²¡æœ‰è·Ÿç€å›¾æˆ–è€…ç¤ºä¾‹ï¼Œæ˜¯æˆ‘è¿™è¾¹æ˜¾ç¤ºçš„é—®é¢˜å—ã€‚ã€‚<br><br>è¿˜æœ‰å°±æ˜¯æ²¡getåˆ°è§£å†³åŒæ—¶æ’å…¥é—®é¢˜çš„ç‚¹ï¼Œä»€ä¹ˆæ—¶å€™å˜æˆ3çš„çŠ¶æ€ï¼Œåˆæ€ä¹ˆä¿è¯useridå°äºlikeridï¼Œæœ›è€å¸ˆè§£ç­”","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158916,"discussion_content":"å¦‚æœå¹¶å‘ä¼šUKé˜»å¡ã€‚å¦‚æœå…ˆæœ‰2ï¼Œç„¶å1æ¥äº†å°±å¯ä»¥å°†è®°å½•æ›´ä¸º3ã€‚åä¹‹ä¹Ÿæ˜¯å¯ä»¥æ›´ä¸º3ï¼Œç„¶åå‘friendè¡¨æ’å…¥ä¸€æ¡è®°å½•ã€‚å¦‚æœæ²¡æœ‰è¿™ç§æƒ…å†µå°±æ— éæ˜¯æ’å…¥ä¸€æ¡1æˆ–è€…2çš„è®°å½•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580638355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50590,"user_name":"Bin","can_delete":false,"product_type":"c1","uid":1304406,"ip_address":"","ucode":"26BA010D2990C4","user_header":"https://static001.geekbang.org/account/avatar/00/13/e7/56/87f45704.jpg","comment_is_top":false,"comment_ctime":1545013388,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545013388","product_id":100020801,"comment_content":"ç­”: ç¬¬ä¸€ç§ã€‚<br>æ„é€ å®éªŒå¦‚ä¸‹:<br>mysql&gt; show master status\\G;<br>\tExecuted_Gtid_Set: b453f45b-ba9f-11e8-a29c-080027eb50c1:1-433437<br>\t1 row in set (0.00 sec)<br><br>mysql&gt; select a from t where id=1;<br>+------+<br>| a    |<br>+------+<br>| 2 |<br>+------+<br>1 row in set (0.00 sec)<br>\t<br>mysql&gt; update t set a=2 where id=1;<br>\tQuery OK, 0 rows affected (0.00 sec)<br>\tRows matched: 1  Changed: 0  Warnings: 0<br>       ï¼ˆChanged ä¸ç­‰äº0æ‰æ˜¯çœŸæ­£åšäº†ä¿®æ”¹ï¼‰<br>mysql&gt; show master status\\G;<br>\tExecuted_Gtid_Set: b453f45b-ba9f-11e8-a29c-080027eb50c1:1-433437<br>\t1 row in set (0.00 sec)<br><br>å¯ä»¥çœ‹åˆ°, å½“æ‰§è¡Œå®Œæˆ  &quot;update t set a=2 where id=1;&quot; ä¹‹å, é€šè¿‡ &quot;show master status\\G;&quot; å‘ç°æ²¡æœ‰äº§ç”Ÿæ–°çš„GTIDã€‚<br><br>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡:<br>\tè®¾è®¡çš„æ€è·¯å°±ç±»ä¼¼ç»“æœå­˜åœ¨å°±ä¸åšæ›´æ–°æ“ä½œ,è¿™æ ·å¯ä»¥èŠ‚çœå¼€é”€ï¼Œæé«˜æ€§èƒ½ã€‚<br><br> å¸Œæœ›è€å¸ˆæŒ‡æ­£.è°¢è°¢","like_count":0},{"had_liked":false,"id":50522,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1545006867,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1545006867","product_id":100020801,"comment_content":"æˆ‘è®¤ä¸ºæ˜¯ç¬¬ä¸€ç§ã€‚ç¬¬äºŒç§å¦‚æœå‡ºç°äº†è„é¡µï¼Œå†…å­˜ä¸­çš„æ•°æ®å’Œå’Œç£ç›˜ä¸­æ•°æ®ä¸ä¸€è‡´ï¼Œæœ€åè¿˜æ˜¯ä¼šè¢«ç£ç›˜ä¸­çš„æ•°æ®é¡µè¦†ç›–ã€‚ç¬¬ä¸‰ç§ï¼Œå†…å­˜ä¸­çš„æ•°æ®é¡µflushåˆ°ç£ç›˜ï¼Œæ˜¯æœ‰æœºåˆ¶çš„ï¼Œæ›´æ–°å†…å­˜é‡Œï¼Œå†ç»Ÿä¸€æŠŠå†…å­˜åˆ·åˆ°ç£ç›˜ä¸Šï¼Œæ€§èƒ½æ›´å¥½ï¼Œç¬¬ä¸‰ç§æ€§èƒ½ä¸å¥½ã€‚æ‰€ä»¥é€‰æ‹©ç¬¬ä¸€ç§","like_count":0},{"had_liked":false,"id":50521,"user_name":"amazon1011","can_delete":false,"product_type":"c1","uid":1001032,"ip_address":"","ucode":"BD745BDCBD7059","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/48/e959b1e0.jpg","comment_is_top":false,"comment_ctime":1545006353,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1545006353","product_id":100020801,"comment_content":"&quot;è¿™ä¸ªäº‹åŠ¡è¦å¾€ä¸¤ä¸ªè¡¨ä¸­æ’å…¥è®°å½•ï¼Œæ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„æ—¥å¿—éƒ½å¾—å…ˆä¿å­˜èµ·æ¥ï¼Œä½†åˆä¸èƒ½åœ¨è¿˜æ²¡ commit çš„æ—¶å€™å°±ç›´æ¥å†™åˆ° redo log æ–‡ä»¶é‡Œã€‚&quot;è€å¸ˆï¼Œå¦‚æœæ˜¯ä¸€ä¸ªé•¿äº‹åŠ¡å ç”¨äº†redo log buffer çš„1&#47;2çš„æ—¶å€™ä¸”äº‹åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œåå°çº¿ç¨‹å°±ç›´æ¥åˆ·åˆ°redo log file å§ã€‚","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":158917,"discussion_content":"åº”è¯¥æ˜¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580638381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}