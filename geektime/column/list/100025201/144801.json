{"id":144801,"title":"åŠ é¤ | å¦‚ä½•åšHTTPæœåŠ¡çš„æµ‹è¯•ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä¸ƒç‰›äº‘è®¸å¼ä¼Ÿã€‚</p><p>åŸºäº HTTP åè®®æä¾›æœåŠ¡çš„å¥½å¤„æ˜¯æ˜¾ç„¶çš„ã€‚é™¤äº† HTTP æœåŠ¡æœ‰å¾ˆå¤šç°æˆçš„å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯æ¡†æ¶å¯ä»¥ç›´æ¥ä½¿ç”¨å¤–ï¼Œåœ¨ HTTP æœåŠ¡çš„è°ƒè¯•ã€æµ‹è¯•ã€ç›‘æ§ã€è´Ÿè½½å‡è¡¡ç­‰é¢†åŸŸéƒ½æœ‰ç°æˆçš„ç›¸å…³å·¥å…·æ”¯æ’‘ã€‚</p><p>åœ¨ä¸ƒç‰›ï¼Œæˆ‘ä»¬ç»å¤§éƒ¨åˆ†çš„æœåŠ¡ï¼ŒåŒ…æ‹¬å†…éƒ¨æœåŠ¡ï¼Œéƒ½æ˜¯åŸºäº HTTP åè®®æ¥æä¾›æœåŠ¡ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ€è€ƒå¦‚ä½•æ›´æœ‰æ•ˆåœ°è¿›è¡Œ HTTP æœåŠ¡çš„æµ‹è¯•ã€‚</p><p>ä¸ƒç‰›æ—©æœŸ HTTP æœåŠ¡çš„æµ‹è¯•æ–¹æ³•å¾ˆæœ´ç´ ï¼šç¬¬ä¸€æ­¥å…ˆå†™å¥½æœåŠ¡ç«¯ï¼Œç„¶åå†™ä¸€ä¸ªå®¢æˆ·ç«¯ SDKï¼Œå†åŸºäºè¿™ä¸ªå®¢æˆ·ç«¯ SDK å†™æµ‹è¯•æ¡ˆä¾‹ã€‚</p><p>è¿™ç§æ–¹æ³•å¤šå¤šå°‘å°‘ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ã€‚é¦–å…ˆï¼Œå®¢æˆ·ç«¯ SDK çš„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´æµ‹è¯•æ¡ˆä¾‹ç¼–ä¸è¿‡ã€‚å…¶æ¬¡ï¼Œå®¢æˆ·ç«¯ SDK é€šå¸¸æ˜¯ä½¿ç”¨æ–¹å‹å¥½ï¼Œè€Œä¸æ˜¯æµ‹è¯•æ–¹å‹å¥½ã€‚æœåŠ¡ç«¯å¼€å‘è¿‡ç¨‹å’Œå®¢æˆ·ç«¯ SDK çš„è€¦åˆå®¹æ˜“è¿‡æ—©åœ°é™·å…¥â€œå®¢æˆ·ç«¯ SDK å¦‚ä½•æŠ½è±¡æ›´åˆç†â€ çš„ç»†èŠ‚ï¼Œè€Œä¸èƒ½ä¸“æ³¨äºæµ‹è¯•æœåŠ¡é€»è¾‘æœ¬èº«ã€‚</p><p>æˆ‘çš„æ ¸å¿ƒè¯‰æ±‚æ˜¯å¯¹æœåŠ¡ç«¯å¼€å‘è¿‡ç¨‹å’Œå®¢æˆ·ç«¯å¼€å‘è¿‡ç¨‹è¿›è¡Œè§£è€¦ã€‚åœ¨ç½‘ç»œåè®®å®šå¥½äº†ä»¥åï¼Œæ•´ä¸ªç³»ç»ŸåŸåˆ™ä¸Šå°±å¯ä»¥ç¼–å†™æµ‹è¯•æ¡ˆä¾‹ï¼Œè€Œä¸ç”¨ç­‰å®¢æˆ·ç«¯ SDKçš„æˆç†Ÿã€‚</p><p>ä¸å†™å®¢æˆ·ç«¯ SDK è€Œç›´æ¥åš HTTP æµ‹è¯•ï¼Œä¸€ä¸ªç›´è§‚çš„æ€è·¯æ˜¯ç›´æ¥åŸºäº http.Client ç±»æ¥å†™æµ‹è¯•æ¡ˆä¾‹ã€‚è¿™ç§æ–¹å¼çš„é—®é¢˜æ˜¯ä»£ç æ¯”è¾ƒå†—é•¿ï¼Œè€Œä¸”å®ƒçš„ä¸šåŠ¡é€»è¾‘è¡¨è¾¾ä¸ç›´è§‚ï¼Œå¾ˆéš¾ä¸€çœ¼å°±çœ‹å‡ºè¿™å¥è¯æƒ³å¹²ä»€ä¹ˆã€‚è™½ç„¶å¯ä»¥å†™ä¸€äº›è¾…åŠ©å‡½æ•°æ¥æ”¹è§‚ï¼Œä½†åšå¤šäº†å°±ä¼šé€æ¸æœ‰å†™æµ‹è¯•ä¸“ç”¨ SDK çš„å€¾å‘ã€‚è¿™ç§å†™æ³•çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆå¯å–ï¼Œæ¯•ç«Ÿä¸ºæµ‹è¯•å†™ä¸€ä¸ªä¸“é—¨çš„ SDKï¼Œçœ‹èµ·æ¥æˆæœ¬æœ‰äº›é«˜äº†ã€‚</p><!-- [[[read_end]]] --><p>ä¸ƒç‰›å½“å‰çš„åšæ³•æ˜¯å¼•å…¥ä¸€ç§ httptest DSL æ–‡æ³•ã€‚è¿™æ˜¯ä¸ƒç‰›ä¸º HTTP æµ‹è¯•è€Œå†™çš„é¢†åŸŸä¸“ç”¨è¯­è¨€ã€‚è¿™ä¸ª httptest å·¥å…·å½“å‰å·²ç»å¼€æºï¼Œé¡¹ç›®ä¸»é¡µä¸ºï¼š</p><ul>\n<li><a href=\"https://github.com/qiniu/httptest\">https://github.com/qiniu/httptest</a>ï¼ˆhttptest æ¡†æ¶ï¼‰</li>\n<li><a href=\"https://github.com/qiniu/qiniutest\">https://github.com/qiniu/qiniutest</a>ï¼ˆæ”¯æŒä¸ƒç‰›å¸å·ä¸æˆæƒæœºåˆ¶çš„ qiniutest å·¥å…·ï¼‰</li>\n</ul><h2>httptest åŸºç¡€æ–‡æ³•</h2><p>è¿™ä¸ªè¯­è¨€çš„æ–‡æ³•å¤§æ¦‚åœ¨ 2012 å¹´å°±å·²ç»è¢«åŠ å…¥åˆ°ä¸ƒç‰›çš„ä»£ç åº“ï¼Œåæ¥æœ‰ä¸ªåŒäº‹æ ¹æ®è¿™ä¸ª DSL æ–‡æ³•å†™äº†ç¬¬ä¸€ç‰ˆæœ¬ qiniutest ç¨‹åºã€‚åœ¨å†³å®šæ¨å¹¿ç”¨è¿™ä¸ª DSL æ¥è¿›è¡Œæµ‹è¯•çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯¹ DSL ä¸æ–­åœ°è¿›è¡Œäº†è°ƒæ•´å’ŒåŠ å¼ºã€‚è™½ç„¶æ€»ä½“æ€è·¯æ²¡æœ‰å˜åŒ–ï¼Œä½†æœ€ç»ˆå®šç¨¿çš„ DSL ä¸æœ€åˆç‰ˆæœ¬æœ‰è¾ƒå¤§çš„å·®å¼‚ã€‚ç›®å‰æ¥è¯´ï¼Œæˆ‘å·²ç»å¯ä»¥ååˆ†ç¡®å®šåœ°è¯´ï¼Œè¿™ä¸ªDSLå¯ä»¥æ»¡è¶³ 90% ä»¥ä¸Šçš„æµ‹è¯•éœ€æ±‚ã€‚å®ƒè¢«æ¨èåšä¸ºä¸ƒç‰›å†…éƒ¨çš„é¦–é€‰æµ‹è¯•æ–¹æ¡ˆã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/45/82/45e35f9cf7ab35fea48b6135160c0a82.png?wh=865*242\" alt=\"\"></p><p>ä¸Šå›¾æ˜¯è¿™å¥— DSL çš„ â€œhello worldâ€ ç¨‹åºã€‚å®ƒçš„æ‰§è¡Œé¢„æœŸæ˜¯ï¼šä¸‹è½½ www.qiniu.com é¦–é¡µï¼Œè¦æ±‚è¿”å›çš„ HTTP çŠ¶æ€ç ä¸º 200ã€‚å¦‚æœè¿”å›é 200ï¼Œæµ‹è¯•å¤±è´¥ï¼›å¦åˆ™æµ‹è¯•é€šè¿‡ï¼Œè¾“å‡ºè¿”å›åŒ…çš„æ­£æ–‡å†…å®¹ï¼ˆresp.body å˜é‡ï¼‰ã€‚è¾“å‡º resp.body çš„å†…å®¹é€šå¸¸æ˜¯è°ƒè¯•éœ€è¦ï¼Œè€Œä¸æ˜¯æµ‹è¯•éœ€è¦ã€‚è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä¸éœ€è¦å‘å±å¹•å»è¾“å‡ºä»€ä¹ˆçš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/ac/c761fdaac0a959f13a5ee14d4eaddaac.png?wh=865*664\" alt=\"\"></p><p>æˆ‘ä»¬å†çœ‹è¯¥ DSL çš„ä¸€ä¸ª â€œquick startï¼ˆå¿«é€Ÿå…¥é—¨ï¼‰â€ æ ·ä¾‹ã€‚ä»¥ # å¼€å§‹çš„å†…å®¹æ˜¯ç¨‹åºçš„æ³¨é‡Šéƒ¨åˆ†ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„æ³¨é‡Šï¼Œæè¿°äº†ä¸€ä¸ªåŸºæœ¬çš„ HTTP è¯·æ±‚æµ‹è¯•çš„æ„æˆã€‚åé¢æˆ‘ä»¬ä¼šå¯¹è¿™éƒ¨åˆ†å†…å®¹è¿›è¡Œè¯¦ç»†å±•å¼€ï¼Œè¿™é‡Œæš‚æ—¶è·³è¿‡ã€‚</p><p>è¿™æ®µä»£ç çš„ç¬¬ä¸€å¥è¯æ˜¯å®šä¹‰äº†ä¸€ä¸ª auth åˆ«åå« qiniutestï¼Œè¿™åªæ˜¯ä¸ºäº†è®©åé¢å…·ä½“çš„ HTTP è¯·æ±‚ä¸­æˆæƒè¯­å¥æ›´ç®€çŸ­ã€‚ç´§æ¥ç€æ˜¯å‘èµ·ä¸€ä¸ª POST è¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªå†…å®¹ä¸º {\"a\": \"value1\", \"b\": 1} çš„å¯¹è±¡ï¼Œå¹¶å°†è¿”å›çš„å¯¹è±¡ id èµ‹å€¼ç»™ä¸€ä¸ªåä¸º id1 çš„å˜é‡ã€‚åé¢æˆ‘ä»¬ä¼šè¯¦ç»†è§£é‡Šè¿™ä¸ªèµ‹å€¼è¿‡ç¨‹æ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚</p><p>æ¥ç€æˆ‘ä»¬å‘èµ·ä¸€ä¸ªè·å–å¯¹è±¡å†…å®¹çš„ GET è¯·æ±‚ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ GET çš„ URL ä¸­å¼•ç”¨äº† id1 å˜é‡çš„å€¼ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸æ˜¯è¦å–åˆ«çš„å¯¹è±¡çš„å†…å®¹ï¼Œè€Œæ˜¯å–åˆšåˆšåˆ›å»ºæˆåŠŸçš„å¯¹è±¡çš„å†…å®¹ï¼Œå¹¶ä¸”æˆ‘ä»¬æœŸæœ›è¿”å›çš„å¯¹è±¡å†…å®¹å’Œåˆšæ‰POSTä¸Šå»çš„ä¸€æ ·ï¼Œä¹Ÿæ˜¯ {\"a\": \"value1\", \"b\": 1}ã€‚è¿™å°±æ˜¯ä¸€ä¸ªæœ€åŸºç¡€çš„ HTTP æµ‹è¯•ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œç¡®è®¤åˆ›å»ºæˆåŠŸï¼Œå¹¶ä¸”å°è¯•å»å–å›è¿™ä¸ªå¯¹è±¡ï¼Œç¡®è®¤å†…å®¹ä¸æˆ‘ä»¬æœŸæœ›çš„ä¸€è‡´ã€‚è¿™é‡Œä¸Šä¸‹ä¸¤ä¸ªè¯·æ±‚æ˜¯é€šè¿‡ id1 è¿™ä¸ªå˜é‡æ¥å»ºç«‹å…³è”çš„ã€‚</p><p>å¯¹è¿™å¥—DSLæ–‡æ³•æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„å°è±¡åï¼Œæˆ‘ä»¬å¼€å§‹æ¥è§£å‰–å®ƒã€‚å…ˆæ¥çœ‹çœ‹å®ƒçš„è¯­æ³•ç»“æ„ã€‚é¦–å…ˆè¿™å¥— httptest DSL åŸºäºå‘½ä»¤è¡Œæ–‡æ³•ï¼š</p><pre><code>command switch1 switch2 â€¦ arg1 arg2 â€¦\n</code></pre><p>æ•´ä¸ªå‘½ä»¤è¡Œå…ˆæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œç„¶åç´§æ¥ç€æ˜¯ä¸€ä¸ªä¸ªå¼€å…³ï¼ˆå¯é€‰ï¼‰ï¼Œæœ€åæ˜¯ä¸€ä¸ªä¸ªçš„å‘½ä»¤å‚æ•°ã€‚å’Œå¤§å®¶ç†Ÿæ‚‰çš„å‘½ä»¤è¡Œæ¯”å¦‚ Linux Shell ä¸€æ ·ï¼Œå®ƒä¹Ÿä¼šæœ‰ä¸€äº›å‚æ•°éœ€è¦è½¬ä¹‰ï¼Œå¦‚æœå‚æ•°åŒ…å«ç©ºæ ¼æˆ–å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™å¯ä»¥ç”¨ \\ å‰ç¼€æ¥è¿›è¡Œè½¬ä¹‰ã€‚æ¯”å¦‚ '\\ ' è¡¨ç¤º ''ï¼ˆç©ºæ ¼ï¼‰ï¼Œâ€˜\\t'è¡¨ç¤º TAB ç­‰ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿæ”¯æŒç”¨ 'â€¦' æˆ–è€… \"â€¦\" å»ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œæ¯”å¦‚ json æ ¼å¼çš„å¤šè¡Œæ–‡æœ¬ã€‚åŒ Linux Shell ç±»ä¼¼ï¼Œ'â€¦' é‡Œé¢çš„å†…å®¹æ²¡æœ‰è½¬ä¹‰ï¼Œâ€˜\\ â€™ å°±æ˜¯  â€˜\\ â€™ï¼Œâ€˜\\t'å°±æ˜¯ '\\t'ï¼Œè€Œä¸æ˜¯ TABã€‚è€Œ \"â€¦\" åˆ™æ”¯æŒè½¬ä¹‰ã€‚</p><p>å’Œ Linux Shell ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬çš„ httptest DSL è™½ç„¶åŸºäºå‘½ä»¤è¡Œæ–‡æ³•ï¼Œä½†æ˜¯å®ƒçš„æ¯ä¸€ä¸ªå‚æ•°éƒ½æ˜¯æœ‰ç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯­è¨€æœ‰ç±»å‹ç³»ç»Ÿï¼Œè€Œä¸åƒ Linux Shell å‘½ä»¤è¡Œå‚æ•°åªæœ‰å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬çš„ httptest DSL æ”¯æŒä¸”ä»…æ”¯æŒæ‰€æœ‰ json æ”¯æŒçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š</p><ul>\n<li>stringï¼ˆå¦‚ï¼š\"a\"ã€application/json ç­‰ï¼Œåœ¨ä¸å¼•èµ·æ­§ä¹‰çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœç•¥åŒå¼•å·ï¼‰</li>\n<li>numberï¼ˆå¦‚ï¼š3.14159ï¼‰</li>\n<li>booleanï¼ˆå¦‚ï¼štrueã€falseï¼‰</li>\n<li>arrayï¼ˆå¦‚ï¼š[â€œaâ€, 200, {â€œbâ€: 2}]ï¼‰</li>\n<li>object/dictionaryï¼ˆå¦‚ï¼š{â€œaâ€: 1, â€œbâ€: 2}ï¼‰</li>\n</ul><p>å¦å¤–ï¼Œæˆ‘ä»¬çš„ httptest DSL ä¹Ÿæœ‰å­å‘½ä»¤çš„æ¦‚å¿µï¼Œå®ƒç›¸å½“äºä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥è¿”å›ä»»æ„ç±»å‹çš„æ•°æ®ã€‚æ¯”å¦‚ qiniu f2weae23e6c9f jg35fae526kbceè¿”å›ä¸€ä¸ª auth objectï¼Œè¿™æ˜¯ç”¨å¸¸è§„å­—ç¬¦ä¸²æ— æ³•è¡¨è¾¾çš„ã€‚</p><p>ç†è§£äº† httptest DSL åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è¡¨è¾¾ä¸€ä¸ª HTTP è¯·æ±‚ã€‚å®ƒçš„åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š</p><pre><code>req &lt;http-method&gt; &lt;url&gt;\nheader &lt;key1&gt; &lt;val11&gt; &lt;val12&gt;\nheader &lt;key2&gt; &lt;val21&gt; &lt;val22&gt;\nauth &lt;authorization&gt;\nbody &lt;content-type&gt; &lt;body-data&gt; \n</code></pre><p>ç¬¬ä¸€å¥æ˜¯ req æŒ‡ä»¤ï¼Œå¸¦ä¸¤ä¸ªå‚æ•°ï¼š ä¸€ä¸ªæ˜¯ http methodï¼Œå³ HTTP è¯·æ±‚çš„æ–¹æ³•ï¼Œå¦‚ GETã€POST ç­‰ã€‚å¦ä¸€ä¸ªæ˜¯è¦è¯·æ±‚çš„ URLã€‚</p><p>æ¥ç€æ˜¯ä¸€ä¸ªä¸ªè‡ªå®šä¹‰çš„ headerï¼ˆå¯é€‰ï¼‰ï¼Œæ¯ä¸ª header æŒ‡ä»¤åé¢è·Ÿä¸€ä¸ª keyï¼ˆé”®ï¼‰å’Œä¸€ä¸ªæˆ–å¤šä¸ª valueï¼ˆå€¼ï¼‰ã€‚</p><p>ç„¶åæ˜¯ä¸€ä¸ªå¯é€‰çš„ auth æŒ‡ä»¤ï¼Œç”¨æ¥æŒ‡ç¤ºè¿™ä¸ªè¯·æ±‚çš„æˆæƒæ–¹å¼ã€‚å¦‚æœæ²¡æœ‰ auth è¯­å¥ï¼Œé‚£ä¹ˆè¿™ä¸ª HTTP è¯·æ±‚æ˜¯åŒ¿åçš„ï¼Œå¦åˆ™è¿™å°±æ˜¯ä¸€ä¸ªå¸¦æˆæƒçš„è¯·æ±‚ã€‚</p><p>æœ€åä¸€å¥æ˜¯ body æŒ‡ä»¤ï¼Œé¡¾åæ€ä¹‰å®ƒç”¨æ¥æŒ‡å®š HTTP è¯·æ±‚çš„æ­£æ–‡ã€‚body æŒ‡ä»¤ä¹Ÿæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ content-typeï¼ˆå†…å®¹æ ¼å¼ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ body-dataï¼ˆè¯·æ±‚æ­£æ–‡ï¼‰ã€‚</p><p>è¿™æ ·è¯´æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸‹å®é™…çš„ä¾‹å­ï¼š</p><p>æ— æˆæƒçš„ GET è¯·æ±‚ï¼š</p><pre><code>req GET http://www.qiniu.com/\n</code></pre><p>å¸¦æˆæƒçš„ POST è¯·æ±‚ï¼š</p><pre><code>req POST http://foo.com/objects\nauth `qiniu f2weae23e6c9fjg35fae526kbce`\nbody application/json '{\n  &quot;a&quot;: &quot;hello1&quot;,\n  &quot;b&quot;:2\n}'\n</code></pre><p>ä¹Ÿå¯ä»¥ç®€å†™æˆï¼š</p><p>æ— æˆæƒçš„GETè¯·æ±‚ï¼š</p><pre><code>get http://www.qiniu.com/\n</code></pre><p>å¸¦æˆæƒçš„Postè¯·æ±‚ï¼š</p><pre><code>post http://foo.com/objects\nauth `qiniu f2weae23e6c9fjg35fae526kbce`\njson '{\n  &quot;a&quot;: &quot;hello1&quot;,\n  &quot;b&quot;:2\n}'\n</code></pre><p>å‘èµ·äº† HTTP è¯·æ±‚åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¶åˆ° HTTP è¿”å›åŒ…å¹¶å¯¹å†…å®¹è¿›è¡ŒåŒ¹é…ã€‚HTTP è¿”å›åŒ…åŒ¹é…çš„åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼š</p><pre><code>ret &lt;expected-status-code&gt;\nheader &lt;key1&gt; &lt;expected-val11&gt;&lt;expected-val12&gt;\nheader &lt;key2&gt; &lt;expected-val21&gt;&lt;expected-val22&gt;\nbody &lt;expected-content-type&gt;&lt;expected-body-data&gt; \n</code></pre><p>æˆ‘ä»¬å…ˆçœ‹ ret æŒ‡ä»¤ã€‚å®é™…ä¸Šï¼Œè¯·æ±‚å‘å‡ºå»çš„æ—¶é—´æ˜¯åœ¨ ret æŒ‡ä»¤æ‰§è¡Œçš„æ—¶å€™ã€‚å‰é¢ reqã€headerã€authã€body æŒ‡ä»¤ä»…ä»…è¡¨è¾¾äº† HTTP è¯·æ±‚ã€‚å¦‚æœæ²¡æœ‰è°ƒç”¨ ret æŒ‡ä»¤ï¼Œé‚£ä¹ˆç³»ç»Ÿä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚</p><p>ret æŒ‡ä»¤å¯ä»¥ä¸å¸¦å‚æ•°ã€‚ä¸å¸¦å‚æ•°çš„ ret æŒ‡ä»¤ï¼Œå…¶å«ä¹‰æ˜¯å‘èµ· HTTP è¯·æ±‚ï¼Œå¹¶å°†è¿”å›çš„ HTTP è¿”å›åŒ…è§£æå¹¶å­˜å‚¨åˆ° resp çš„å˜é‡ä¸­ã€‚è€Œå¯¹äºå¸¦å‚æ•°çš„ ret æŒ‡ä»¤ï¼š</p><pre><code>ret &lt;expected-status-code&gt;\n</code></pre><p>å®ƒç­‰ä»·äºï¼š</p><pre><code>ret\nmatch &lt;expected-status-code&gt; $(resp.code)\n</code></pre><h2>match æŒ‡ä»¤</h2><p>è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æŒ‡ä»¤ï¼šmatch æŒ‡ä»¤ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/c4/bac83312bf630b33c40f1f28ab1d3dc4.png?wh=865*486\" alt=\"\"></p><p>ä¸ƒç‰›æ‰€æœ‰ HTTP è¿”å›åŒ…åŒ¹é…çš„åŒ¹é…æ–‡æ³•ï¼Œéƒ½å¯ä»¥ç”¨è¿™ä¸ª match æ¥è¡¨è¾¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/52/60/52a851227b667cc52b8ada69667b4060.png?wh=865*443\" alt=\"\"></p><p>æ‰€ä»¥æœ¬è´¨ä¸Šæ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªä¸å¸¦å‚æ•°çš„ retï¼ŒåŠ ä¸Š match æŒ‡ä»¤ï¼Œå°±å¯ä»¥æå®šæ‰€æœ‰çš„è¿”å›åŒ…åŒ¹é…è¿‡ç¨‹ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¯´ match æŒ‡ä»¤æ˜¯è¿™å¥— DSL ä¸­æœ€æ ¸å¿ƒçš„æ¦‚å¿µçš„åŸå› ã€‚</p><p>å’Œå…¶ä»–è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ç±»ä¼¼ï¼Œè¿™å¥— DSL ä¹Ÿæä¾›äº†æ–­è¨€æ–‡æ³•ã€‚å®ƒç±»ä¼¼äº CppUnit æˆ– JUnit ä¹‹ç±»çš„æµ‹è¯•æ¡†æ¶æä¾› assertEqualã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><pre><code>equal &lt;expected&gt; &lt;source&gt;\n</code></pre><ul>\n<li>ä¸ match ä¸åŒï¼Œè¿™é‡Œ <code>&lt;expected&gt;ã€&lt;source&gt;</code>ä¸­éƒ½ä¸å…è®¸å‡ºç°æœªç»‘å®šçš„å˜é‡ã€‚</li>\n<li>ä¸ match ä¸åŒï¼Œequal è¦æ±‚<code>&lt;expected&gt;ã€&lt;source&gt;</code>çš„å€¼ç²¾ç¡®ç›¸ç­‰ã€‚</li>\n</ul><pre><code>equalSet &lt;expected&gt; &lt;source&gt;\n</code></pre><ul>\n<li>è¿™é‡Œ SET æ˜¯æŒ‡é›†åˆçš„æ„æ€ã€‚</li>\n<li>ä¸ equal ä¸åŒï¼ŒequalSet è¦æ±‚ <code>&lt;expected&gt;ã€&lt;source&gt;</code>éƒ½æ˜¯arrayï¼Œå¹¶ä¸”å¯¹ array çš„å…ƒç´ è¿›è¡Œæ’åºååˆ¤æ–­ä¸¤è€…æ˜¯å¦ç²¾ç¡®ç›¸ç­‰ã€‚</li>\n<li>equalSet çš„å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯æµ‹è¯• list ç±»çš„ APIï¼Œæ¯”å¦‚åˆ—å‡ºä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½ å¯èƒ½é¢„æœŸè¿™ä¸ªç›®å½•ä¸‹æœ‰å“ªäº›æ–‡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½é¢„æœŸä»–ä»¬ä¼šä»¥ä»€ä¹ˆæ ·çš„æ¬¡åºè¿”å›ã€‚</li>\n</ul><p>ä»¥ä¸Šä»‹ç»åŸºæœ¬ä¸Šå°±æ˜¯è¿™å¥— DSL æœ€æ ¸å¿ƒçš„å†…å®¹äº†ã€‚å†…å®¹éå¸¸ç²¾ç®€ï¼Œä½†æ»¡è¶³äº†ç»å¤§éƒ¨åˆ†æµ‹è¯•åœºæ™¯çš„éœ€æ±‚ã€‚</p><h2>æµ‹è¯•ç¯å¢ƒçš„å‚æ•°åŒ–</h2><p>ä¸‹é¢æˆ‘ä»¬è°ˆè°ˆæœ€åä¸€ä¸ªè¯é¢˜ï¼šæµ‹è¯•ç¯å¢ƒçš„å‚æ•°åŒ–ã€‚</p><p>ä¸ºäº†è®©æµ‹è¯•æ¡ˆä¾‹æ›´åŠ é€šç”¨ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æµ‹è¯•ä¾èµ–çš„ç¯å¢ƒè¿›è¡Œå‚æ•°åŒ–ã€‚æ¯”å¦‚ï¼Œä¸ºäº†è®©æµ‹è¯•è„šæœ¬èƒ½å¤ŸåŒæ—¶ç”¨äº stage ç¯å¢ƒå’Œ product ç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦æŠŠæœåŠ¡çš„ Host ä¿¡æ¯å‚æ•°åŒ–ã€‚å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•è„šæœ¬å…¥å£ï¼Œæˆ‘ä»¬é€šå¸¸è¿˜éœ€è¦æŠŠ ç”¨æˆ·å/å¯†ç ã€AK/SK ç­‰æ•æ„Ÿæ€§ä¿¡æ¯å‚æ•°åŒ–ï¼Œé¿å…ç›´æ¥ç¡¬ç¼–ç åˆ°æµ‹è¯•æ¡ˆä¾‹ä¸­ã€‚</p><p>ä¸ºäº†æŠŠæœåŠ¡å™¨çš„ Host ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡å™¨çš„ä½ç½®ï¼‰å‚æ•°åŒ–ï¼Œæˆ‘ä»¬å¼•å…¥äº† host æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼š</p><pre><code>host foo.com 127.0.0.1:8888\nget http://foo.com/objects/a325gea2kgfd\nauth qiniutest\nret 200\njson '{\n  &quot;a&quot;: &quot;hello1&quot;,\n  &quot;b&quot;:2\n}'\n</code></pre><p>è¿™æ ·ï¼Œåæ–‡æ‰€æœ‰å‡ºç°è¯·æ±‚ foo.com åœ°æ–¹ï¼Œéƒ½ä¼šæŠŠè¯·æ±‚å‘é€åˆ° 127.0.0.1:8888 è¿™æ ·ä¸€ä¸ªæœåŠ¡å™¨åœ°å€ã€‚è¦æƒ³è®©è„šæœ¬æµ‹è¯•å¦å¤–çš„æœåŠ¡å™¨å®ä¾‹ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒæ•´ host è¯­å¥ï¼Œå°† 127.0.0.1:8888 è°ƒæ•´æˆå…¶ä»–å³å¯ã€‚</p><p>é™¤äº†æœåŠ¡å™¨ Host éœ€è¦å‚æ•°åŒ–å¤–ï¼Œå…¶ä»–å¸¸è§çš„å‚æ•°åŒ–éœ€æ±‚æ˜¯ ç”¨æˆ·å/å¯†ç ã€AK/SK ç­‰ã€‚AK/SK è¿™æ ·çš„ä¿¡æ¯éå¸¸æ•æ„Ÿï¼Œå¦‚æœåœ¨æµ‹è¯•è„šæœ¬é‡Œé¢ç¡¬ç¼–ç è¿™äº›ä¿¡æ¯ï¼Œå°†ä¸åˆ©äºæµ‹è¯•è„šæœ¬ä»£ç çš„å…¥åº“ã€‚ä¸€ä¸ªå…¸å‹çš„æµ‹è¯•ç¯å¢ƒå‚æ•°åŒ–åçš„æµ‹è¯•è„šæœ¬æ ·ä¾‹å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/fb/a2d588df5daf9cb3535569a6f404acfb.png?wh=715*538\" alt=\"\"></p><p>å…¶ä¸­ï¼Œenv æŒ‡ä»¤ç”¨äºå–ç¯å¢ƒå˜é‡å¯¹åº”çš„å€¼ï¼ˆè¿”å›å€¼ç±»å‹æ˜¯ stringï¼‰ï¼Œenvdecode æŒ‡ä»¤åˆ™æ˜¯å…ˆå–å¾—ç¯å¢ƒå˜é‡å¯¹åº”çš„å€¼ï¼Œç„¶åå¯¹å€¼è¿›è¡Œ json decode å¾—åˆ°ç›¸åº”çš„ object/dictionaryã€‚æœ‰äº†<code>$(env)</code> è¿™ä¸ªå¯¹è±¡<code>(object)</code>ï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè·å¾—å„ç§æµ‹è¯•ç¯å¢ƒå‚æ•°ï¼Œæ¯”å¦‚ <code>$(env.FooHost)</code>ã€<code>$(env.AK)</code>ã€<code>$(env.SK)</code> ç­‰ã€‚</p><p>å†™å¥½äº†æµ‹è¯•è„šæœ¬åï¼Œåœ¨æ‰§è¡Œæµ‹è¯•è„šæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé…ç½®æµ‹è¯•ç¯å¢ƒï¼š</p><pre><code>export QiniuTestEnv_stage='{\n  &quot;FooHost&quot;: &quot;192.168.1.10:8888&quot;,\n  &quot;AK&quot;: &quot;â€¦&quot;,\n  &quot;SK&quot;: &quot;â€¦&quot;\n}'\n\nexport QiniuTestEnv_product='{\n  &quot;FooHost&quot;: &quot;foo.com&quot;,\n  &quot;AK&quot;: &quot;â€¦&quot;,\n  &quot;SK&quot;: &quot;â€¦&quot;\n}'\n\n</code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œæµ‹è¯•è„šæœ¬äº†ï¼š</p><p>æµ‹è¯• stage ç¯å¢ƒï¼š</p><pre><code>QiniuTestEnv=stage qiniutest ./testfoo.qtf\n</code></pre><p>æµ‹è¯• product ç¯å¢ƒï¼š</p><pre><code>QiniuTestEnv=product qiniutest ./testfoo.qtf\n</code></pre><h2>ç»“è¯­</h2><p>æµ‹è¯•æ˜¯è½¯ä»¶è´¨é‡ä¿éšœè‡³å…³é‡è¦çš„ä¸€ç¯ã€‚ä¸€ä¸ªå¥½çš„æµ‹è¯•å·¥å…·å¯¹æé«˜å¼€å‘æ•ˆç‡çš„ä½œç”¨å·¨å¤§ã€‚å¦‚æœèƒ½å¤Ÿè®©å¼€å‘äººå‘˜çš„å¼€å‘æ—¶é—´ä»ä¸€å°æ—¶å‡å°‘åˆ°åŠå°æ—¶ï¼Œé‚£ä¹ˆæ—¥ç§¯æœˆç´¯å°±ä¼šå¾—åˆ°æƒŠäººçš„æ•ˆæœã€‚</p><p>å»å…³æ³¨å¼€å‘äººå‘˜æ—¥å¸¸å·¥ä½œè¿‡ç¨‹ä¸­çš„ä¸çˆ½å’Œä½æ•ˆç‡æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚ä»»ä½•å¼€å‘æ•ˆç‡æå‡ç›¸å…³çš„å·¥ä½œï¼Œå…¶æ”¶ç›Šéƒ½æ˜¯æŒ‡æ•°çº§çš„ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€æ¨å´‡çš„åšäº‹é£æ ¼ã€‚å¦‚æœä½ å¯¹ä»Šå¤©çš„å†…å®¹æœ‰ä»€ä¹ˆæ€è€ƒä¸è§£è¯»ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚</p><p>å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ã€‚</p>","comments":[{"had_liked":false,"id":138324,"user_name":"debugtalk","can_delete":false,"product_type":"c1","uid":1005452,"ip_address":"","ucode":"D6F0E57E79808C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/8c/8fba0bdd.jpg","comment_is_top":false,"comment_ctime":1570164310,"is_pvip":false,"replies":[{"id":"53201","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1570165984,"ip_address":"","comment_id":138324,"utype":1}],"discussion_count":1,"race_medal":0,"score":"104649379414","product_id":100025201,"comment_content":"ä¹‹å‰æˆ‘åšçš„ä¸€ä¸ªå¼€æºé¡¹ç›® HttpRunner å’Œè¿™ä¸ªå€’æœ‰äº›ç›¸ä¼¼ä¹‹å¤„ã€‚<br>https:&#47;&#47;github.com&#47;httprunner&#47;httprunner<br><br>å¯¹äºDSLï¼Œæœ‰ä¸ªç—›ç‚¹å°±æ˜¯æ²¡æ³•åƒä»£ç é‚£æ ·è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚æ‰€ä»¥æˆ‘ä¹Ÿåœ¨HttpRunnerä¸­æ¢ç´¢äº†è¯­æ³•æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œä»¥åŠå’Œ pythonä»£ç çš„äº’è½¬","like_count":25,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469484,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570165984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138847,"user_name":"Aaron Cheung","can_delete":false,"product_type":"c1","uid":1079816,"ip_address":"","ucode":"03972759C53667","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","comment_is_top":false,"comment_ctime":1570490107,"is_pvip":false,"replies":[{"id":"53490","content":"æµ‹è¯•å…ˆè¡Œå¾ˆæœ‰å¿…è¦ã€‚æµ‹è¯•åˆ†é»‘ç›’ç™½ç›’ï¼Œé»‘ç›’å…³æ³¨ä¸šåŠ¡è¾¹ç•Œï¼Œç™½ç›’ä¸¤è€…éƒ½å…³æ³¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1570500459,"ip_address":"","comment_id":138847,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18750359291","product_id":100025201,"comment_content":"æµ‹è¯•å…ˆè¡Œåœ¨ç›®å‰çš„å¼€å‘ç¯å¢ƒä¸‹æœ‰æ— å¿…è¦ å¼€å‘äººå‘˜çš„è¾¹ç•Œæ¡ä»¶ä¹‹ç±»æœ‰å¯èƒ½æ²¡æœ‰è¦†ç›–ä¸šåŠ¡æ¡ä»¶","like_count":3,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469671,"discussion_content":"æµ‹è¯•å…ˆè¡Œå¾ˆæœ‰å¿…è¦ã€‚æµ‹è¯•åˆ†é»‘ç›’ç™½ç›’ï¼Œé»‘ç›’å…³æ³¨ä¸šåŠ¡è¾¹ç•Œï¼Œç™½ç›’ä¸¤è€…éƒ½å…³æ³¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570500459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140080,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/70/7e137498.jpg","nickname":"FOCUS","note":"","ucode":"DFE3078B632026","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541663,"discussion_content":"1/ å¼€å‘äººå‘˜çš„è¾¹ç•Œæ¡ä»¶ï¼Œä¸ã€Œä¸šåŠ¡æ¡ä»¶ã€æ˜¯å¦è¦†ç›–ï¼›\n2/ æµ‹è¯•å…ˆè¡Œï¼Œæ˜¯å¦ç¬¦åˆå½“å‰çš„å¼€å‘ç¯å¢ƒï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640508764,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":147136,"user_name":"ä¸ä¸å†é™©è®°","can_delete":false,"product_type":"c1","uid":1661704,"ip_address":"","ucode":"A43829E454C067","user_header":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","comment_is_top":false,"comment_ctime":1572824280,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14457726168","product_id":100025201,"comment_content":"ç¬”è®°<br>1  å‡†å¤‡ä¸Šç­åä¸‹è½½ä½¿ç”¨ï¼Œåšä¸­å­¦<br>2 å»å…³æ³¨å¼€å‘äººå‘˜æ—¥å¸¸å·¥ä½œè¿‡ç¨‹ä¸­çš„ä¸çˆ½å’Œä½æ•ˆç‡æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚ä»»ä½•å¼€å‘æ•ˆç‡æå‡ç›¸å…³çš„å·¥ä½œï¼Œå…¶æ”¶ç›Šéƒ½æ˜¯æŒ‡æ•°çº§çš„ã€‚","like_count":4},{"had_liked":false,"id":138878,"user_name":"Charles","can_delete":false,"product_type":"c1","uid":1001410,"ip_address":"","ucode":"32646D78CC0389","user_header":"https://static001.geekbang.org/account/avatar/00/0f/47/c2/e9fa4cf6.jpg","comment_is_top":false,"comment_ctime":1570497538,"is_pvip":false,"replies":[{"id":"53489","content":"ç”Ÿäº§ç¯å¢ƒä¸€èˆ¬ç”¨æµ‹è¯•è´¦å·ï¼Œæµ‹è¯•æ•°æ®ä¼šåœ¨æµ‹è¯•å‰è¿›è¡Œæ¸…ç†ã€‚æ¸…ç†çš„å¤„ç†é€»è¾‘ä¸€èˆ¬éƒ½åœ¨æµ‹è¯•ä»£ç ä¸­ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1570500373,"ip_address":"","comment_id":138878,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5865464834","product_id":100025201,"comment_content":"åŠ é¤åŠ çš„å¤ªå¥½äº†ï¼Œè°¢è°¢ï¼è¯·é—®ä¸‹è®¸è€å¸ˆï¼Œåç«¯å¯¹åº”çš„æ•°æ®åº“äº§ç”Ÿçš„æµ‹è¯•æ•°æ®å¦‚ä½•å¤„ç†çš„ï¼Ÿæµ‹è¯•ç¯å¢ƒè¿˜å¥½ï¼Œç”Ÿäº§ç¯å¢ƒå‘¢ï¼Ÿå¦‚æœæ˜¯ä»£ç å¤„ç†çš„è¯ï¼Œå¤„ç†é€»è¾‘æ˜¯æ”¾åœ¨åç«¯å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469682,"discussion_content":"ç”Ÿäº§ç¯å¢ƒä¸€èˆ¬ç”¨æµ‹è¯•è´¦å·ï¼Œæµ‹è¯•æ•°æ®ä¼šåœ¨æµ‹è¯•å‰è¿›è¡Œæ¸…ç†ã€‚æ¸…ç†çš„å¤„ç†é€»è¾‘ä¸€èˆ¬éƒ½åœ¨æµ‹è¯•ä»£ç ä¸­ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570500373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001410,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/c2/e9fa4cf6.jpg","nickname":"Charles","note":"","ucode":"32646D78CC0389","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25325,"discussion_content":"è€å¸ˆï¼ŒæŒ‰æ–‡ç« ä¸­æè¿°çš„sdkå®¢æˆ·ç«¯è¿›è¡ŒhttpæœåŠ¡æµ‹è¯•çš„è¯ï¼Œæ¸…ç†å¤„ç†æ”¾åœ¨å“ªé‡Œï¼Ÿè°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570501844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292119,"user_name":"ä¸æ¸©æš–å•Šä¸çº¯è‰¯","can_delete":false,"product_type":"c1","uid":2079117,"ip_address":"","ucode":"204474A214E00C","user_header":"https://static001.geekbang.org/account/avatar/00/1f/b9/8d/00bded19.jpg","comment_is_top":false,"comment_ctime":1620697268,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620697268","product_id":100025201,"comment_content":"è¯»å®Œç¬¬ä¸€æ®µçš„æ—¶å€™æˆ‘è„‘å­é‡Œå‡ºç°äº†ä¸€ä¸ªåœºæ™¯,ä¸€ä¸ªå«httpçš„åº—é“ºåœ¨è¡—ä¸Šå†å–:&quot;æœåŠ¡ä¾¿å®œå–,å®¢æˆ·ç«¯æœåŠ¡1å…ƒ1æ–¤,æœåŠ¡çš„æœåŠ¡2å…ƒ1æ–¤,æœåŠ¡åæµ‹è¯•&#47;è°ƒè¯•&#47;ç›‘æ§&#47;è´Ÿè½½å‡è¡¡ç­‰&quot;,ä¸€ä¸ªå«ä¸ƒç‰›çš„äººè¯´:&quot;æ¥ä¸ªæœåŠ¡ç«¯çš„æµ‹è¯•æœåŠ¡&quot;.æ¥ç€ä»–åˆæ‰¾åˆ°githubåº—é“º,çœ‹è§ä»Šæ—¥ç‰¹ä»·:httptest DSLæµ‹è¯•å·¥å…·,å¿ƒæƒ³:&#39;è¿™ä¸ªä¸é”™,åˆšå¥½å¥½httpæµ‹è¯•æœåŠ¡é…åˆç”¨,ä¹°å›å®¶æ”¹é€ æ”¹é€ &#39;.æ¥ç€å°±æ˜¯ä½¿ç”¨åœºæ™¯äº†,ä¸ƒç‰›æŠŠå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤ç»™äº†ä¸¤ä¸ªä¸åŒçš„äººå»å¹²,äºæ˜¯ç”¨httpæµ‹è¯•æœåŠ¡ä½¿å¾—ä»–ä¿©ä¸ç”¨åœ¨ä¸€èµ·å¹²æ´»,å°±èƒ½å®Œæˆäº’ç›¸æµ‹è¯•.æœ€åæ˜¯éšè—æ•æ„Ÿä¿¡æ¯,æµ‹è¯•ç”¨ä¾‹æ˜¯å†™å¥½äº†,ä½†ip&#47;å¯†ç &#47;AK&#47;SKç­‰ä¿¡æ¯ä¸€å®šè¦é…ç½®èµ·æ¥,äºæ˜¯å°±æœ‰äº†åé¢çš„ host foo.comç­‰ä»£è¡¨æ•æ„Ÿä¿¡æ¯çš„å•è¯.","like_count":0},{"had_liked":false,"id":281509,"user_name":"Run","can_delete":false,"product_type":"c1","uid":1371941,"ip_address":"","ucode":"6738D2F36ACFF6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLMDBq7lqg9ZasC4f21R0axKJRVCBImPKlQF8yOicLLXIsNgsZxsVyN1mbvFOL6eVPluTNgJofwZeA/132","comment_is_top":false,"comment_ctime":1614769694,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614769694","product_id":100025201,"comment_content":"å¾ˆå¥½","like_count":0},{"had_liked":false,"id":223895,"user_name":"Jowin","can_delete":false,"product_type":"c1","uid":1114356,"ip_address":"","ucode":"19017F7D06C22A","user_header":"https://static001.geekbang.org/account/avatar/00/11/00/f4/cc5f0896.jpg","comment_is_top":false,"comment_ctime":1591227481,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591227481","product_id":100025201,"comment_content":"æµ‹è¯•ç”¨ä¾‹æ˜¯ç§»å®šçš„ï¼ŒSDKæ˜¯ä¸æ–­å˜åŒ–çš„ã€‚","like_count":0},{"had_liked":false,"id":190979,"user_name":"å—å±±","can_delete":false,"product_type":"c1","uid":1119593,"ip_address":"","ucode":"94656FE4A6C378","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg","comment_is_top":false,"comment_ctime":1584715614,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1584715614","product_id":100025201,"comment_content":"æµ‹è¯•æ•°æ®ä¸€ç›´æ˜¯è€—è´¹ç²¾åŠ›çš„åœ°æ–¹","like_count":0},{"had_liked":false,"id":138413,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1570205871,"is_pvip":false,"replies":[{"id":"53224","content":"è¿™ä¸ªä¸å½±å“ï¼Œåªéœ€è¦åœ¨æµ‹è¯•å‰æ•°æ®åº“æ˜¯åœ¨è¿è¡Œä¸­çš„å°±è¡Œ","user_name":"ä½œè€…å›å¤","user_name_real":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","uid":"1228022","ctime":1570247906,"ip_address":"","comment_id":138413,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570205871","product_id":100025201,"comment_content":"å¦‚æœåç«¯æ˜¯è¿æ¥æ•°æ®åº“çš„ï¼Œæ€æ ·åšåŠ¨æ€çš„è‡ªåŠ¨åŒ–æµ‹è¯•å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228022,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bc/f6/e61d4b8f.jpg","nickname":"è®¸å¼ä¼Ÿ-ä¸ƒç‰›äº‘(å·²æ»¡)","note":"","ucode":"1A2F8AA6F6DB54","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469513,"discussion_content":"è¿™ä¸ªä¸å½±å“ï¼Œåªéœ€è¦åœ¨æµ‹è¯•å‰æ•°æ®åº“æ˜¯åœ¨è¿è¡Œä¸­çš„å°±è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570247906,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}