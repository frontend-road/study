{"id":366170,"title":"02ï½œSpring Bean ä¾èµ–æ³¨å…¥å¸¸è§é”™è¯¯ï¼ˆä¸Šï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å‚…å¥ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬æ¥èŠèŠ Spring @Autowiredã€‚</p><p>æåŠSpringçš„ä¼˜åŠ¿æˆ–ç‰¹æ€§ï¼Œæˆ‘ä»¬éƒ½ä¼šç«‹é©¬æƒ³èµ·â€œ<strong>æ§åˆ¶åè½¬ã€ä¾èµ–æ³¨å…¥</strong>â€è¿™å…«å­—çœŸè¨€ã€‚è€Œ@Autowiredæ­£æ˜¯ç”¨æ¥æ”¯æŒä¾èµ–æ³¨å…¥çš„æ ¸å¿ƒåˆ©å™¨ä¹‹ä¸€ã€‚è¡¨é¢ä¸Šçœ‹ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œåœ¨ä½¿ç”¨ä¸Šä¸åº”è¯¥å‡ºé”™ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šå‡ºç°å„å¼å„æ ·çš„é”™è¯¯ï¼Œè€Œä¸”éƒ½å ªç§°ç»å…¸ã€‚æ‰€ä»¥è¿™èŠ‚è¯¾æˆ‘å°±å¸¦ç€ä½ å­¦ä¹ ä¸‹è¿™äº›ç»å…¸é”™è¯¯åŠå…¶èƒŒåçš„åŸå› ï¼Œä»¥é˜²æ‚£äºæœªç„¶ã€‚</p><h2>æ¡ˆä¾‹1ï¼šè¿‡å¤šèµ äºˆï¼Œæ— æ‰€é€‚ä»</h2><p>åœ¨ä½¿ç”¨@Autowiredæ—¶ï¼Œä¸ç®¡ä½ æ˜¯èœé¸Ÿçº§è¿˜æ˜¯ä¸“å®¶çº§çš„Springä½¿ç”¨è€…ï¼Œéƒ½åº”è¯¥åˆ¶é€ æˆ–è€…é­é‡è¿‡ç±»ä¼¼çš„é”™è¯¯ï¼š</p><blockquote>\n<p>required a single bean, but 2 were found</p>\n</blockquote><p>é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬ä»…éœ€è¦ä¸€ä¸ªBeanï¼Œä½†å®é™…å´æä¾›äº†2ä¸ªï¼ˆè¿™é‡Œçš„â€œ2â€åœ¨å®é™…é”™è¯¯ä¸­å¯èƒ½æ˜¯å…¶å®ƒå¤§äº1çš„ä»»ä½•æ•°å­—ï¼‰ã€‚</p><p>ä¸ºäº†é‡ç°è¿™ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå†™ä¸€ä¸ªæ¡ˆä¾‹æ¥æ¨¡æ‹Ÿä¸‹ã€‚å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªå­¦ç±ç®¡ç†ç³»ç»Ÿæ¡ˆä¾‹ï¼Œéœ€è¦æä¾›ä¸€ä¸ªAPIæ ¹æ®å­¦ç”Ÿçš„å­¦å·ï¼ˆIDï¼‰æ¥ç§»é™¤å­¦ç”Ÿï¼Œå­¦ç”Ÿçš„ä¿¡æ¯ç»´æŠ¤è‚¯å®šéœ€è¦ä¸€ä¸ªæ•°æ®åº“æ¥æ”¯æ’‘ï¼Œæ‰€ä»¥å¤§ä½“ä¸Šå¯ä»¥å®ç°å¦‚ä¸‹ï¼š</p><pre><code>@RestController\n@Slf4j\n@Validated\npublic class StudentController {\n    @Autowired\n    DataService dataService;\n\n    @RequestMapping(path = &quot;students/{id}&quot;, method = RequestMethod.DELETE)\n    public void deleteStudent(@PathVariable(&quot;id&quot;) @Range(min = 1,max = 100) int id){\n        dataService.deleteStudent(id);\n    };\n}\n</code></pre><p>å…¶ä¸­DataServiceæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶å®ç°ä¾æ‰˜äºOracleï¼Œä»£ç ç¤ºæ„å¦‚ä¸‹ï¼š</p><pre><code>public interface DataService {\n    void deleteStudent(int id);\n}\n\n@Repository\n@Slf4j\npublic class OracleDataService implements DataService{\n    @Override\n    public void deleteStudent(int id) {\n        log.info(&quot;delete student info maintained by oracle&quot;);\n    }\n}\n</code></pre><!-- [[[read_end]]] --><p>æˆªæ­¢ç›®å‰ï¼Œè¿è¡Œå¹¶æµ‹è¯•ç¨‹åºæ˜¯æ¯«æ— é—®é¢˜çš„ã€‚ä½†æ˜¯éœ€æ±‚å¾€å¾€æ˜¯æºæºä¸æ–­çš„ï¼ŒæŸå¤©æˆ‘ä»¬å¯èƒ½æ¥åˆ°èŠ‚çº¦æˆæœ¬çš„éœ€æ±‚ï¼Œå¸Œæœ›æŠŠä¸€äº›éƒ¨åˆ†éæ ¸å¿ƒçš„ä¸šåŠ¡ä»Oracleè¿ç§»åˆ°ç¤¾åŒºç‰ˆCassandraï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªç„¶ä¼šå…ˆæ·»åŠ ä¸Šä¸€ä¸ªæ–°çš„DataServiceå®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>@Repository\n@Slf4j\npublic class CassandraDataService implements DataService{\n    @Override\n    public void deleteStudent(int id) {\n        log.info(&quot;delete student info maintained by cassandra&quot;);\n    }\n}\n</code></pre><p>å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬å®Œæˆæ”¯æŒå¤šä¸ªæ•°æ®åº“çš„å‡†å¤‡å·¥ä½œæ—¶ï¼Œç¨‹åºå°±å·²ç»æ— æ³•å¯åŠ¨äº†ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/80/36/80b14cf13b383e48f64f7052d6747836.png?wh=1745*464\" alt=\"\"></p><p>å¾ˆæ˜¾ç„¶ï¼Œä¸Šè¿°æŠ¥é”™ä¿¡æ¯æ­£æ˜¯æˆ‘ä»¬è¿™ä¸€å°èŠ‚è®¨è®ºçš„é”™è¯¯ï¼Œé‚£ä¹ˆè¿™ä¸ªé”™è¯¯åˆ°åº•æ˜¯æ€ä¹ˆäº§ç”Ÿçš„å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å…·ä½“åˆ†æä¸‹ã€‚</p><h3>æ¡ˆä¾‹è§£æ</h3><p>è¦æ‰¾åˆ°è¿™ä¸ªé—®é¢˜çš„æ ¹æºï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹@Autowiredå®ç°çš„ä¾èµ–æ³¨å…¥çš„åŸç†æœ‰ä¸€å®šçš„äº†è§£ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸‹ @Autowired  å‘ç”Ÿçš„ä½ç½®å’Œæ ¸å¿ƒè¿‡ç¨‹ã€‚</p><p>å½“ä¸€ä¸ªBeanè¢«æ„å»ºæ—¶ï¼Œæ ¸å¿ƒåŒ…æ‹¬ä¸¤ä¸ªåŸºæœ¬æ­¥éª¤ï¼š</p><ol>\n<li>æ‰§è¡ŒAbstractAutowireCapableBeanFactory#createBeanInstanceæ–¹æ³•ï¼šé€šè¿‡æ„é€ å™¨åå°„æ„é€ å‡ºè¿™ä¸ªBeanï¼Œåœ¨æ­¤æ¡ˆä¾‹ä¸­ç›¸å½“äºæ„å»ºå‡ºStudentControllerçš„å®ä¾‹ï¼›</li>\n<li>æ‰§è¡ŒAbstractAutowireCapableBeanFactory#populateæ–¹æ³•ï¼šå¡«å……ï¼ˆå³è®¾ç½®ï¼‰è¿™ä¸ªBeanï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œç›¸å½“äºè®¾ç½®StudentControllerå®ä¾‹ä¸­è¢«@Autowiredæ ‡è®°çš„dataServiceå±æ€§æˆå‘˜ã€‚</li>\n</ol><p>åœ¨æ­¥éª¤2ä¸­ï¼Œâ€œå¡«å……â€è¿‡ç¨‹çš„å…³é”®å°±æ˜¯æ‰§è¡Œå„ç§BeanPostProcessorå¤„ç†å™¨ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>protected void populateBean(String beanName, RootBeanDefinition mbd, @Nullable BeanWrapper bw) {\n      //çœç•¥éå…³é”®ä»£ç \n      for (BeanPostProcessor bp : getBeanPostProcessors()) {\n         if (bp instanceof InstantiationAwareBeanPostProcessor) {\n            InstantiationAwareBeanPostProcessor ibp = (InstantiationAwareBeanPostProcessor) bp;\n            PropertyValues pvsToUse = ibp.postProcessProperties(pvs, bw.getWrappedInstance(), beanName);\n          //çœç•¥éå…³é”®ä»£ç \n         }\n      }\n   }   \n}\n</code></pre><p>åœ¨ä¸Šè¿°ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› ä¸ºStudentControllerå«æœ‰æ ‡è®°ä¸ºAutowiredçš„æˆå‘˜å±æ€§dataServiceï¼Œæ‰€ä»¥ä¼šä½¿ç”¨åˆ°AutowiredAnnotationBeanPostProcessorï¼ˆBeanPostProcessorä¸­çš„ä¸€ç§ï¼‰æ¥å®Œæˆâ€œè£…é…â€è¿‡ç¨‹ï¼šæ‰¾å‡ºåˆé€‚çš„DataServiceçš„beanå¹¶è®¾ç½®ç»™StudentController#dataServiceã€‚å¦‚æœæ·±ç©¶è¿™ä¸ªè£…é…è¿‡ç¨‹ï¼Œåˆå¯ä»¥ç»†åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li>å¯»æ‰¾å‡ºæ‰€æœ‰éœ€è¦ä¾èµ–æ³¨å…¥çš„å­—æ®µå’Œæ–¹æ³•ï¼Œå‚è€ƒAutowiredAnnotationBeanPostProcessor#postProcessPropertiesä¸­çš„ä»£ç è¡Œï¼š</li>\n</ol><pre><code>InjectionMetadata metadata = findAutowiringMetadata(beanName, bean.getClass(), pvs);\n</code></pre><ol start=\"2\">\n<li>æ ¹æ®ä¾èµ–ä¿¡æ¯å¯»æ‰¾å‡ºä¾èµ–å¹¶å®Œæˆæ³¨å…¥ï¼Œä»¥å­—æ®µæ³¨å…¥ä¸ºä¾‹ï¼Œå‚è€ƒAutowiredFieldElement#injectæ–¹æ³•ï¼š</li>\n</ol><pre><code>@Override\nprotected void inject(Object bean, @Nullable String beanName, @Nullable PropertyValues pvs) throws Throwable {\n   Field field = (Field) this.member;\n   Object value;\n   //çœç•¥éå…³é”®ä»£ç \n      try {\n          DependencyDescriptor desc = new DependencyDescriptor(field, this.required);\n         //å¯»æ‰¾â€œä¾èµ–â€ï¼Œdescä¸º&quot;dataService&quot;çš„DependencyDescriptor\n         value = beanFactory.resolveDependency(desc, beanName, autowiredBeanNames, typeConverter);\n      }\n      \n   }\n   //çœç•¥éå…³é”®ä»£ç \n   if (value != null) {\n      ReflectionUtils.makeAccessible(field);\n      //è£…é…â€œä¾èµ–â€\n      field.set(bean, value);\n   }\n}\n</code></pre><p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬äº†è§£äº†@Autowiredè¿‡ç¨‹å‘ç”Ÿçš„ä½ç½®å’Œè¿‡ç¨‹ã€‚è€Œä¸”å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬æ¡ˆä¾‹ä¸­çš„é”™è¯¯å°±å‘ç”Ÿåœ¨ä¸Šè¿°â€œå¯»æ‰¾ä¾èµ–â€çš„è¿‡ç¨‹ä¸­ï¼ˆä¸Šè¿°ä»£ç çš„ç¬¬9è¡Œï¼‰ï¼Œé‚£ä¹ˆåˆ°åº•æ˜¯æ€ä¹ˆå‘ç”Ÿçš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç»§ç»­åˆ¨æ ¹é—®åº•ã€‚</p><p>ä¸ºäº†æ›´æ¸…æ™°åœ°å±•ç¤ºé”™è¯¯å‘ç”Ÿçš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨è°ƒè¯•çš„è§†è§’å±•ç¤ºå…¶ä½ç½®ï¼ˆå³DefaultListableBeanFactory#doResolveDependencyä¸­ä»£ç ç‰‡æ®µï¼‰ï¼Œå‚è€ƒä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4c/f9/4cb99e17967847995bfe1d7ec0fe75f9.png?wh=1426*358\" alt=\"\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬æ ¹æ®DataServiceè¿™ä¸ªç±»å‹æ¥æ‰¾å‡ºä¾èµ–æ—¶ï¼Œæˆ‘ä»¬ä¼šæ‰¾å‡º2ä¸ªä¾èµ–ï¼Œåˆ†åˆ«ä¸ºCassandraDataServiceå’ŒOracleDataServiceã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå¦‚æœåŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶åˆ™ä¼šæŠ›å‡ºæœ¬æ¡ˆä¾‹çš„é”™è¯¯ï¼š</p><ol>\n<li>è°ƒç”¨determineAutowireCandidateæ–¹æ³•æ¥é€‰å‡ºä¼˜å…ˆçº§æœ€é«˜çš„ä¾èµ–ï¼Œä½†æ˜¯å‘ç°å¹¶æ²¡æœ‰ä¼˜å…ˆçº§å¯ä¾æ®ã€‚å…·ä½“é€‰æ‹©è¿‡ç¨‹å¯å‚è€ƒDefaultListableBeanFactory#determineAutowireCandidateï¼š</li>\n</ol><pre><code>protected String determineAutowireCandidate(Map&lt;String, Object&gt; candidates, DependencyDescriptor descriptor) {\n   Class&lt;?&gt; requiredType = descriptor.getDependencyType();\n   String primaryCandidate = determinePrimaryCandidate(candidates, requiredType);\n   if (primaryCandidate != null) {\n      return primaryCandidate;\n   }\n   String priorityCandidate = determineHighestPriorityCandidate(candidates, requiredType);\n   if (priorityCandidate != null) {\n      return priorityCandidate;\n   }\n   // Fallback\n   for (Map.Entry&lt;String, Object&gt; entry : candidates.entrySet()) {\n      String candidateName = entry.getKey();\n      Object beanInstance = entry.getValue();\n      if ((beanInstance != null &amp;&amp; this.resolvableDependencies.containsValue(beanInstance)) ||\n            matchesBeanName(candidateName, descriptor.getDependencyName())) {\n         return candidateName;\n      }\n   }\n   return null;\n}\n</code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼Œä¼˜å…ˆçº§çš„å†³ç­–æ˜¯å…ˆæ ¹æ®@Primaryæ¥å†³ç­–ï¼Œå…¶æ¬¡æ˜¯@Priorityå†³ç­–ï¼Œæœ€åæ˜¯æ ¹æ®Beanåå­—çš„ä¸¥æ ¼åŒ¹é…æ¥å†³ç­–ã€‚å¦‚æœè¿™äº›å¸®åŠ©å†³ç­–ä¼˜å…ˆçº§çš„æ³¨è§£éƒ½æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œåå­—ä¹Ÿä¸ç²¾ç¡®åŒ¹é…ï¼Œåˆ™è¿”å›nullï¼Œå‘ŠçŸ¥æ— æ³•å†³ç­–å‡ºå“ªç§æœ€åˆé€‚ã€‚</p><ol start=\"2\">\n<li>@Autowiredè¦æ±‚æ˜¯å¿…é¡»æ³¨å…¥çš„ï¼ˆå³requiredä¿æŒé»˜è®¤å€¼ä¸ºtrueï¼‰ï¼Œæˆ–è€…æ³¨è§£çš„å±æ€§ç±»å‹å¹¶ä¸æ˜¯å¯ä»¥æ¥å—å¤šä¸ªBeançš„ç±»å‹ï¼Œä¾‹å¦‚æ•°ç»„ã€Mapã€é›†åˆã€‚è¿™ç‚¹å¯ä»¥å‚è€ƒDefaultListableBeanFactory#indicatesMultipleBeansçš„å®ç°ï¼š</li>\n</ol><pre><code>private boolean indicatesMultipleBeans(Class&lt;?&gt; type) {\n   return (type.isArray() || (type.isInterface() &amp;&amp;\n         (Collection.class.isAssignableFrom(type) || Map.class.isAssignableFrom(type))));\n}\n</code></pre><p>å¯¹æ¯”ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶å’Œæˆ‘ä»¬çš„æ¡ˆä¾‹ï¼Œå¾ˆæ˜æ˜¾ï¼Œæ¡ˆä¾‹ç¨‹åºèƒ½æ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œæ‰€ä»¥æŠ¥é”™å¹¶ä¸å¥‡æ€ªã€‚è€Œå¦‚æœæˆ‘ä»¬æŠŠè¿™äº›æ¡ä»¶æƒ³å¾—ç®€å•ç‚¹ï¼Œæˆ–è®¸æ›´å®¹æ˜“å¸®åŠ©æˆ‘ä»¬å»ç†è§£è¿™ä¸ªè®¾è®¡ã€‚å°±åƒæˆ‘ä»¬é­é‡å¤šä¸ªæ— æ³•æ¯”è¾ƒä¼˜åŠ£çš„é€‰æ‹©ï¼Œå´å¿…é¡»é€‰æ‹©å…¶ä¸€æ—¶ï¼Œä¸å…¶å·å·åœ°éšä¾¿é€‰æ‹©ä¸€ç§ï¼Œè¿˜ä¸å¦‚ç›´æ¥æŠ¥é”™ï¼Œèµ·ç å¯ä»¥é¿å…æ›´ä¸¥é‡çš„é—®é¢˜å‘ç”Ÿã€‚</p><h3>é—®é¢˜ä¿®æ­£</h3><p>é’ˆå¯¹è¿™ä¸ªæ¡ˆä¾‹ï¼Œæœ‰äº†æºç çš„å‰–æï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«æ‰¾åˆ°è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼š<strong>æ‰“ç ´ä¸Šè¿°ä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä»»ä½•ä¸€ä¸ªå³å¯ï¼Œå³è®©å€™é€‰é¡¹å…·æœ‰ä¼˜å…ˆçº§æˆ–å‹æ ¹å¯ä»¥ä¸å»é€‰æ‹©ã€‚</strong>ä¸è¿‡éœ€è¦ä½ æ³¨æ„çš„æ˜¯ï¼Œä¸æ˜¯æ¯ä¸€ç§æ¡ä»¶çš„æ‰“ç ´éƒ½æ»¡è¶³å®é™…éœ€æ±‚ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨æ ‡è®°@Primaryçš„æ–¹å¼æ¥è®©è¢«æ ‡è®°çš„å€™é€‰è€…æœ‰æ›´é«˜ä¼˜å…ˆçº§ï¼Œä»è€Œé¿å…æŠ¥é”™ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä¸€å®šç¬¦åˆä¸šåŠ¡éœ€æ±‚ï¼Œè¿™å°±å¥½æ¯”æˆ‘ä»¬æœ¬èº«éœ€è¦ä¸¤ç§æ•°æ®åº“éƒ½èƒ½ä½¿ç”¨ï¼Œè€Œä¸æ˜¯é¡¾æ­¤å¤±å½¼ã€‚</p><pre><code>@Repository\n@Primary\n@Slf4j\npublic class OracleDataService implements DataService{\n    //çœç•¥éå…³é”®ä»£ç \n}\n</code></pre><p>ç°åœ¨ï¼Œè¯·ä½ ä»”ç»†ç ”è¯»ä¸Šè¿°çš„ä¸¤ä¸ªæ¡ä»¶ï¼Œè¦åŒæ—¶æ”¯æŒå¤šç§DataServiceï¼Œä¸”èƒ½åœ¨ä¸åŒä¸šåŠ¡æƒ…æ™¯ä¸‹ç²¾ç¡®åŒ¹é…åˆ°è¦é€‰æ‹©åˆ°çš„DataServiceï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼å»ä¿®æ”¹ï¼š</p><pre><code>@Autowired\nDataService oracleDataService;\n</code></pre><p>å¦‚ä»£ç æ‰€ç¤ºï¼Œä¿®æ”¹æ–¹å¼çš„ç²¾é«“åœ¨äºå°†å±æ€§åå’ŒBeanåå­—ç²¾ç¡®åŒ¹é…ï¼Œè¿™æ ·å°±å¯ä»¥è®©æ³¨å…¥é€‰æ‹©ä¸çŠ¯éš¾ï¼šéœ€è¦Oracleæ—¶æŒ‡å®šå±æ€§åä¸ºoracleDataServiceï¼Œéœ€è¦Cassandraæ—¶åˆ™æŒ‡å®šå±æ€§åä¸ºcassandraDataServiceã€‚</p><h2>æ¡ˆä¾‹ 2ï¼šæ˜¾å¼å¼•ç”¨Beanæ—¶é¦–å­—æ¯å¿½ç•¥å¤§å°å†™</h2><p>é’ˆå¯¹æ¡ˆä¾‹1çš„é—®é¢˜ä¿®æ­£ï¼Œå®é™…ä¸Šè¿˜å­˜åœ¨å¦å¤–ä¸€ç§å¸¸ç”¨çš„è§£å†³åŠæ³•ï¼Œå³é‡‡ç”¨@Qualifieræ¥æ˜¾å¼æŒ‡å®šå¼•ç”¨çš„æ˜¯é‚£ç§æœåŠ¡ï¼Œä¾‹å¦‚é‡‡ç”¨ä¸‹é¢çš„æ–¹å¼ï¼š</p><pre><code>@Autowired()\n@Qualifier(&quot;cassandraDataService&quot;)\nDataService dataService;\n</code></pre><p>è¿™ç§æ–¹å¼ä¹‹æ‰€ä»¥èƒ½è§£å†³é—®é¢˜ï¼Œåœ¨äºå®ƒèƒ½è®©å¯»æ‰¾å‡ºçš„Beanåªæœ‰ä¸€ä¸ªï¼ˆå³ç²¾ç¡®åŒ¹é…ï¼‰ï¼Œæ‰€ä»¥å‹æ ¹ä¸ä¼šå‡ºç°åé¢çš„å†³ç­–è¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒDefaultListableBeanFactory#doResolveDependencyï¼š</p><pre><code>@Nullable\npublic Object doResolveDependency(DependencyDescriptor descriptor, @Nullable String beanName,\n      @Nullable Set&lt;String&gt; autowiredBeanNames, @Nullable TypeConverter typeConverter) throws BeansException {\n      //çœç•¥å…¶ä»–éå…³é”®ä»£ç \n      //å¯»æ‰¾beanè¿‡ç¨‹\n      Map&lt;String, Object&gt; matchingBeans = findAutowireCandidates(beanName, type, descriptor);\n      if (matchingBeans.isEmpty()) {\n         if (isRequired(descriptor)) {\n            raiseNoMatchingBeanFound(type, descriptor.getResolvableType(), descriptor);\n         }\n         return null;\n      }\n      //çœç•¥å…¶ä»–éå…³é”®ä»£ç \n      if (matchingBeans.size() &gt; 1) {\n         //çœç•¥å¤šä¸ªbeançš„å†³ç­–è¿‡ç¨‹ï¼Œå³æ¡ˆä¾‹1é‡ç‚¹ä»‹ç»å†…å®¹\n      } \n     //çœç•¥å…¶ä»–éå…³é”®ä»£ç \n}\n</code></pre><p>æˆ‘ä»¬ä¼šä½¿ç”¨@QualifieræŒ‡å®šçš„åç§°å»åŒ¹é…ï¼Œæœ€ç»ˆåªæ‰¾åˆ°äº†å”¯ä¸€ä¸€ä¸ªã€‚</p><p>ä¸è¿‡åœ¨ä½¿ç”¨@Qualifieræ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¼šçŠ¯å¦ä¸€ä¸ªç»å…¸çš„å°é”™è¯¯ï¼Œå°±æ˜¯æˆ‘ä»¬å¯èƒ½ä¼šå¿½ç•¥Beançš„åç§°é¦–å­—æ¯å¤§å°å†™ã€‚è¿™é‡Œæˆ‘ä»¬æŠŠæ ¡æ­£åçš„æ¡ˆä¾‹ç¨ç¨å˜å½¢å¦‚ä¸‹ï¼š</p><pre><code>@Autowired\n@Qualifier(&quot;CassandraDataService&quot;)\nDataService dataService;\n</code></pre><p>è¿è¡Œç¨‹åºï¼Œæˆ‘ä»¬ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š</p><blockquote>\n<p>Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'studentController': Unsatisfied dependency expressed through field 'dataService'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.spring.puzzle.class2.example2.DataService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true), @org.springframework.beans.factory.annotation.Qualifier(value=CassandraDataService)}</p>\n</blockquote><p>è¿™é‡Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š<strong>å¯¹äºBeançš„åå­—ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡æ˜ï¼Œå°±åº”è¯¥æ˜¯ç±»åï¼Œä¸è¿‡é¦–å­—æ¯åº”è¯¥å°å†™ã€‚</strong>ä½†æ˜¯è¿™ä¸ªè½»æ¾å¾—å‡ºçš„ç»“è®ºæˆç«‹ä¹ˆï¼Ÿ</p><p>ä¸å¦¨å†æµ‹è¯•ä¸‹ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ”¯æŒSQLiteè¿™ç§æ•°æ®åº“ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå‘½åä¸ºSQLiteDataServiceçš„å®ç°ï¼Œç„¶åå€Ÿé‰´ä¹‹å‰çš„ç»éªŒï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥å¼•ç”¨è¿™ä¸ªå®ç°ï¼š</p><pre><code>@Autowired\n@Qualifier(&quot;sQLiteDataService&quot;)\nDataService dataService;\n</code></pre><p>æ»¡æ€€ä¿¡å¿ƒè¿è¡Œå®Œä¸Šé¢çš„ç¨‹åºï¼Œä¾ç„¶ä¼šå‡ºç°ä¹‹å‰çš„é”™è¯¯ï¼Œè€Œå¦‚æœæ”¹æˆSQLiteDataServiceï¼Œåˆ™è¿è¡Œé€šè¿‡äº†ã€‚è¿™å’Œä¹‹å‰çš„ç»“è®ºåˆçŸ›ç›¾äº†ã€‚æ‰€ä»¥ï¼Œæ˜¾å¼å¼•ç”¨Beanæ—¶ï¼Œé¦–å­—æ¯åˆ°åº•æ˜¯å¤§å†™è¿˜æ˜¯å°å†™å‘¢ï¼Ÿ</p><h3>æ¡ˆä¾‹è§£æ</h3><p>å¯¹äºè¿™ç§é”™è¯¯çš„æŠ¥é”™ä½ç½®ï¼Œå…¶å®æˆ‘ä»¬æ­£å¥½åœ¨æœ¬æ¡ˆä¾‹çš„å¼€å¤´å°±è´´å‡ºäº†ï¼ˆå³ç¬¬äºŒæ®µä»£ç æ¸…å•çš„ç¬¬9è¡Œï¼‰ï¼š</p><pre><code>raiseNoMatchingBeanFound(type, descriptor.getResolvableType(), descriptor);\n</code></pre><p>å³å½“å› ä¸ºåç§°é—®é¢˜ï¼ˆä¾‹å¦‚å¼•ç”¨Beané¦–å­—æ¯æé”™äº†ï¼‰æ‰¾ä¸åˆ°Beanæ—¶ï¼Œä¼šç›´æ¥æŠ›å‡ºNoSuchBeanDefinitionExceptionã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦å…³å¿ƒçš„é—®é¢˜æ˜¯ï¼šä¸æ˜¾å¼è®¾ç½®åå­—çš„Beanï¼Œå…¶é»˜è®¤åç§°é¦–å­—æ¯åˆ°åº•æ˜¯å¤§å†™è¿˜æ˜¯å°å†™å‘¢ï¼Ÿ</p><p>çœ‹æ¡ˆä¾‹çš„è¯ï¼Œå½“æˆ‘ä»¬å¯åŠ¨åŸºäºSpring  Bootçš„åº”ç”¨ç¨‹åºæ—¶ï¼Œä¼šè‡ªåŠ¨æ‰«ææˆ‘ä»¬çš„Packageï¼Œä»¥æ‰¾å‡ºç›´æ¥æˆ–é—´æ¥æ ‡è®°äº†@Componentçš„Beançš„å®šä¹‰ï¼ˆå³BeanDefinitionï¼‰ã€‚ä¾‹å¦‚CassandraDataServiceã€SQLiteDataServiceéƒ½è¢«æ ‡è®°äº†@Repositoryï¼Œè€ŒRepositoryæœ¬èº«è¢«@Componentæ ‡è®°ï¼Œæ‰€ä»¥å®ƒä»¬éƒ½æ˜¯é—´æ¥æ ‡è®°äº†@Componentã€‚</p><p>ä¸€æ—¦æ‰¾å‡ºè¿™äº›Beançš„ä¿¡æ¯ï¼Œå°±å¯ä»¥ç”Ÿæˆè¿™äº›Beançš„åå­—ï¼Œç„¶åç»„åˆæˆä¸€ä¸ªä¸ªBeanDefinitionHolderè¿”å›ç»™ä¸Šå±‚ã€‚è¿™ä¸ªè¿‡ç¨‹å…³é”®æ­¥éª¤å¯ä»¥æŸ¥çœ‹ä¸‹å›¾çš„ä»£ç ç‰‡æ®µï¼ˆClassPathBeanDefinitionScanner#doScanï¼‰ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/27/49/277f3b2421a0e173a0eee56b7d65f849.png?wh=1270*418\" alt=\"\"></p><p>åŸºæœ¬åŒ¹é…æˆ‘ä»¬å‰é¢æè¿°çš„è¿‡ç¨‹ï¼Œå…¶ä¸­æ–¹æ³•è°ƒç”¨BeanNameGenerator#generateBeanNameå³ç”¨æ¥äº§ç”ŸBeançš„åå­—ï¼Œå®ƒæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚å› ä¸ºDataServiceçš„å®ç°éƒ½æ˜¯ä½¿ç”¨æ³¨è§£æ ‡è®°çš„ï¼Œæ‰€ä»¥Beanåç§°çš„ç”Ÿæˆé€»è¾‘æœ€ç»ˆè°ƒç”¨çš„å…¶å®æ˜¯AnnotationBeanNameGenerator#generateBeanNameè¿™ç§å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹å®ƒçš„å…·ä½“å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>@Override\npublic String generateBeanName(BeanDefinition definition, BeanDefinitionRegistry registry) {\n   if (definition instanceof AnnotatedBeanDefinition) {\n      String beanName = determineBeanNameFromAnnotation((AnnotatedBeanDefinition) definition);\n      if (StringUtils.hasText(beanName)) {\n         // Explicit bean name found.\n         return beanName;\n      }\n   }\n   // Fallback: generate a unique default bean name.\n   return buildDefaultBeanName(definition, registry);\n}\n</code></pre><p>å¤§ä½“æµç¨‹åªæœ‰ä¸¤æ­¥ï¼šçœ‹Beanæœ‰æ²¡æœ‰æ˜¾å¼æŒ‡æ˜åç§°ï¼Œå¦‚æœæœ‰åˆ™ç”¨æ˜¾å¼åç§°ï¼Œå¦‚æœæ²¡æœ‰åˆ™äº§ç”Ÿä¸€ä¸ªé»˜è®¤åç§°ã€‚å¾ˆæ˜æ˜¾ï¼Œåœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œæ˜¯æ²¡æœ‰ç»™BeanæŒ‡å®šåå­—çš„ï¼Œæ‰€ä»¥äº§ç”Ÿçš„Beançš„åç§°å°±æ˜¯ç”Ÿæˆçš„é»˜è®¤åç§°ï¼ŒæŸ¥çœ‹é»˜è®¤åçš„äº§ç”Ÿæ–¹æ³•buildDefaultBeanNameï¼Œå…¶å®ç°å¦‚ä¸‹ï¼š</p><pre><code>protected String buildDefaultBeanName(BeanDefinition definition) {\n   String beanClassName = definition.getBeanClassName();\n   Assert.state(beanClassName != null, &quot;No bean class name set&quot;);\n   String shortClassName = ClassUtils.getShortName(beanClassName);\n   return Introspector.decapitalize(shortClassName);\n}\n</code></pre><p>é¦–å…ˆï¼Œè·å–ä¸€ä¸ªç®€çŸ­çš„ClassNameï¼Œç„¶åè°ƒç”¨Introspector#decapitalizeæ–¹æ³•ï¼Œè®¾ç½®é¦–å­—æ¯å¤§å†™æˆ–å°å†™ï¼Œå…·ä½“å‚è€ƒä¸‹é¢çš„ä»£ç å®ç°ï¼š</p><pre><code>public static String decapitalize(String name) {\n    if (name == null || name.length() == 0) {\n        return name;\n    }\n    if (name.length() &gt; 1 &amp;&amp; Character.isUpperCase(name.charAt(1)) &amp;&amp;\n                    Character.isUpperCase(name.charAt(0))){\n        return name;\n    }\n    char chars[] = name.toCharArray();\n    chars[0] = Character.toLowerCase(chars[0]);\n    return new String(chars);\n}\n</code></pre><p>åˆ°è¿™ï¼Œæˆ‘ä»¬å¾ˆè½»æ¾åœ°æ˜ç™½äº†å‰é¢ä¸¤ä¸ªé—®é¢˜å‡ºç°çš„åŸå› ï¼š<strong>å¦‚æœä¸€ä¸ªç±»åæ˜¯ä»¥ä¸¤ä¸ªå¤§å†™å­—æ¯å¼€å¤´çš„ï¼Œåˆ™é¦–å­—æ¯ä¸å˜ï¼Œå…¶å®ƒæƒ…å†µä¸‹é»˜è®¤é¦–å­—æ¯å˜æˆå°å†™ã€‚</strong>ç»“åˆæˆ‘ä»¬ä¹‹å‰çš„æ¡ˆä¾‹ï¼ŒSQLiteDataServiceçš„Beanï¼Œå…¶åç§°åº”è¯¥å°±æ˜¯ç±»åæœ¬èº«ï¼Œè€ŒCassandraDataServiceçš„Beanåç§°åˆ™å˜æˆäº†é¦–å­—æ¯å°å†™ï¼ˆcassandraDataServiceï¼‰ã€‚</p><h3>é—®é¢˜ä¿®æ­£</h3><p>ç°åœ¨æˆ‘ä»¬å·²ç»ä»æºç çº§åˆ«äº†è§£äº†Beanåå­—äº§ç”Ÿçš„è§„åˆ™ï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°ä¿®æ­£æ¡ˆä¾‹ä¸­çš„ä¸¤ä¸ªé”™è¯¯äº†ã€‚ä»¥å¼•ç”¨CassandraDataServiceç±»å‹çš„Beançš„é”™è¯¯ä¿®æ­£ä¸ºä¾‹ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢è¿™ä¸¤ç§ä¿®æ”¹æ–¹å¼ï¼š</p><ol>\n<li>å¼•ç”¨å¤„çº æ­£é¦–å­—æ¯å¤§å°å†™é—®é¢˜ï¼š</li>\n</ol><pre><code>@Autowired\n@Qualifier(&quot;cassandraDataService&quot;)\nDataService dataService;\n</code></pre><ol start=\"2\">\n<li>å®šä¹‰å¤„æ˜¾å¼æŒ‡å®šBeanåå­—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿æŒå¼•ç”¨ä»£ç ä¸å˜ï¼Œè€Œé€šè¿‡æ˜¾å¼æŒ‡æ˜CassandraDataService çš„Beanåç§°ä¸ºCassandraDataServiceæ¥çº æ­£è¿™ä¸ªé—®é¢˜ã€‚</li>\n</ol><pre><code>@Repository(&quot;CassandraDataService&quot;)\n@Slf4j\npublic class CassandraDataService implements DataService {\n  //çœç•¥å®ç°\n}\n</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±å¯ä»¥ç²¾ç¡®åŒ¹é…åˆ°è¦æ‰¾çš„Beanäº†ã€‚æ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤ç§ä¿®æ”¹æ–¹æ³•çš„è¯ï¼Œå¦‚æœä½ ä¸å¤ªäº†è§£æºç ï¼Œä¸æƒ³çº ç»“äºé¦–å­—æ¯åˆ°åº•æ˜¯å¤§å†™è¿˜æ˜¯å°å†™ï¼Œå»ºè®®ä½ ç”¨ç¬¬äºŒç§æ–¹æ³•å»é¿å…å›°æ‰°ã€‚</p><h2>æ¡ˆä¾‹ 3ï¼šå¼•ç”¨å†…éƒ¨ç±»çš„Beané—å¿˜ç±»å</h2><p>è§£å†³å®Œæ¡ˆä¾‹2ï¼Œæ˜¯ä¸æ˜¯å°±æ„å‘³ç€æˆ‘ä»¬èƒ½æå®šæ‰€æœ‰Beançš„æ˜¾å¼å¼•ç”¨ï¼Œä¸å†çŠ¯é”™äº†å‘¢ï¼Ÿå¤©çœŸäº†ã€‚æˆ‘ä»¬å¯ä»¥æ²¿ç”¨ä¸Šé¢çš„æ¡ˆä¾‹ï¼Œç¨å¾®å†æ·»åŠ ç‚¹åˆ«çš„éœ€æ±‚ï¼Œä¾‹å¦‚æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªå†…éƒ¨ç±»æ¥å®ç°ä¸€ç§æ–°çš„DataServiceï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class StudentController {\n    @Repository\n    public static class InnerClassDataService implements DataService{\n        @Override\n        public void deleteStudent(int id) {\n          //ç©ºå®ç°\n        }\n    }\n    //çœç•¥å…¶ä»–éå…³é”®ä»£ç \n }\n</code></pre><p>é‡åˆ°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šå¾ˆè‡ªç„¶åœ°ç”¨ä¸‹é¢çš„æ–¹å¼ç›´æ¥å»æ˜¾å¼å¼•ç”¨è¿™ä¸ªBeanï¼š</p><pre><code>@Autowired\n@Qualifier(&quot;innerClassDataService&quot;)\nDataService innerClassDataService;\n</code></pre><p>å¾ˆæ˜æ˜¾ï¼Œæœ‰äº†æ¡ˆä¾‹2çš„ç»éªŒï¼Œæˆ‘ä»¬ä¸Šæ¥å°±ç›´æ¥é‡‡ç”¨äº†<strong>é¦–å­—æ¯å°å†™</strong>ä»¥é¿å…æ¡ˆä¾‹2ä¸­çš„é”™è¯¯ï¼Œä½†è¿™æ ·çš„ä»£ç æ˜¯ä¸æ˜¯å°±æ²¡é—®é¢˜äº†å‘¢ï¼Ÿå®é™…ä¸Šï¼Œä»ç„¶ä¼šæŠ¥é”™â€œæ‰¾ä¸åˆ°Beanâ€ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><h3>æ¡ˆä¾‹è§£æ</h3><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬é­é‡çš„æƒ…å†µæ˜¯â€œå¦‚ä½•å¼•ç”¨å†…éƒ¨ç±»çš„Beanâ€ã€‚è§£ææ¡ˆä¾‹2çš„æ—¶å€™ï¼Œæˆ‘æ›¾ç»è´´å‡ºäº†å¦‚ä½•äº§ç”Ÿé»˜è®¤Beanåçš„æ–¹æ³•ï¼ˆå³AnnotationBeanNameGenerator#buildDefaultBeanNameï¼‰ï¼Œå½“æ—¶æˆ‘ä»¬åªå…³æ³¨äº†é¦–å­—æ¯æ˜¯å¦å°å†™çš„ä»£ç ç‰‡æ®µï¼Œè€Œåœ¨æœ€åå˜æ¢é¦–å­—æ¯ä¹‹å‰ï¼Œæœ‰ä¸€è¡Œè¯­å¥æ˜¯å¯¹classåå­—çš„å¤„ç†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><blockquote>\n<p>String shortClassName = ClassUtils.getShortName(beanClassName);</p>\n</blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹å®ƒçš„å®ç°ï¼Œå‚è€ƒClassUtils#getShortNameæ–¹æ³•ï¼š</p><pre><code>public static String getShortName(String className) {\n   Assert.hasLength(className, &quot;Class name must not be empty&quot;);\n   int lastDotIndex = className.lastIndexOf(PACKAGE_SEPARATOR);\n   int nameEndIndex = className.indexOf(CGLIB_CLASS_SEPARATOR);\n   if (nameEndIndex == -1) {\n      nameEndIndex = className.length();\n   }\n   String shortName = className.substring(lastDotIndex + 1, nameEndIndex);\n   shortName = shortName.replace(INNER_CLASS_SEPARATOR, PACKAGE_SEPARATOR);\n   return shortName;\n}\n</code></pre><p>å¾ˆæ˜æ˜¾ï¼Œå‡è®¾æˆ‘ä»¬æ˜¯ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä¾‹å¦‚ä¸‹é¢çš„ç±»åï¼š</p><blockquote>\n<p>com.spring.puzzle.class2.example3.StudentController.InnerClassDataService</p>\n</blockquote><p>åœ¨ç»è¿‡è¿™ä¸ªæ–¹æ³•çš„å¤„ç†åï¼Œæˆ‘ä»¬å¾—åˆ°çš„å…¶å®æ˜¯ä¸‹é¢è¿™ä¸ªåç§°ï¼š</p><blockquote>\n<p>StudentController.InnerClassDataService</p>\n</blockquote><p>æœ€åç»è¿‡Introspector.decapitalizeçš„é¦–å­—æ¯å˜æ¢ï¼Œæœ€ç»ˆè·å–çš„Beanåç§°å¦‚ä¸‹ï¼š</p><blockquote>\n<p>studentController.InnerClassDataService</p>\n</blockquote><p>æ‰€ä»¥æˆ‘ä»¬åœ¨æ¡ˆä¾‹ç¨‹åºä¸­ï¼Œç›´æ¥ä½¿ç”¨  innerClassDataService  è‡ªç„¶æ‰¾ä¸åˆ°æƒ³è¦çš„Beanã€‚</p><h3>é—®é¢˜ä¿®æ­£</h3><p>é€šè¿‡æ¡ˆä¾‹è§£æï¼Œæˆ‘ä»¬å¾ˆå¿«å°±æ‰¾åˆ°äº†è¿™ä¸ªå†…éƒ¨ç±»ï¼ŒBeançš„å¼•ç”¨é—®é¢˜é¡ºæ‰‹å°±ä¿®æ­£äº†ï¼Œå¦‚ä¸‹ï¼š</p><pre><code>@Autowired\n@Qualifier(&quot;studentController.InnerClassDataService&quot;)\nDataService innerClassDataService;\n</code></pre><p>è¿™ä¸ªå¼•ç”¨çœ‹èµ·æ¥æœ‰äº›è®¸å¥‡æ€ªï¼Œä½†å®é™…ä¸Šæ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œåè€Œç›´æ¥ä½¿ç”¨  innerClassDataService  æ¥å¼•ç”¨å€’æ˜¯çœŸçš„ä¸å¯è¡Œã€‚</p><p>é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<strong>å¯¹æºç çš„å­¦ä¹ æ˜¯å¦å…¨é¢å†³å®šäº†æˆ‘ä»¬ä»¥åçŠ¯é”™çš„å¯èƒ½æ€§å¤§å°ã€‚</strong>å¦‚æœæˆ‘ä»¬åœ¨å­¦ä¹ æ¡ˆä¾‹2æ—¶ï¼Œå°±å¯¹classåç§°çš„å˜åŒ–éƒ¨åˆ†çš„æºç è¿›è¡Œäº†å­¦ä¹ ï¼Œé‚£ä¹ˆè¿™ç§é”™è¯¯æ˜¯ä¸å®¹æ˜“çŠ¯çš„ã€‚ä¸è¿‡æœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®å¾ˆéš¾ä¸€ä¸Šæ¥å°±æŠŠå­¦ä¹ å¼€å±•çš„å…¨é¢è€Œæ·±å…¥ï¼Œæ€»æ˜¯éœ€è¦æ—¶é—´å’Œé”™è¯¯å»é”¤ç‚¼çš„ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>çœ‹å®Œè¿™ä¸‰ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™äº›é”™è¯¯çš„ç›´æ¥ç»“æœéƒ½æ˜¯æ‰¾ä¸åˆ°åˆé€‚çš„Beanï¼Œä½†æ˜¯åŸå› å´ä¸å°½ç›¸åŒã€‚ä¾‹å¦‚æ¡ˆä¾‹1æ˜¯å› ä¸ºæä¾›çš„Beanè¿‡å¤šåˆæ— æ³•å†³ç­–é€‰æ‹©è°ï¼›æ¡ˆä¾‹2å’Œæ¡ˆä¾‹3æ˜¯å› ä¸ºæŒ‡å®šçš„åç§°ä¸è§„èŒƒå¯¼è‡´å¼•ç”¨çš„Beanæ‰¾ä¸åˆ°ã€‚</p><p>å®é™…ä¸Šï¼Œè¿™äº›é”™è¯¯åœ¨ä¸€äº›â€œèªæ˜çš„â€IDEä¼šè¢«æç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å®ƒä»¬åœ¨å…¶å®ƒä¸€äº›ä¸å¤ªæ™ºèƒ½çš„ä¸»æµIDEä¸­å¹¶ä¸èƒ½è¢«å‘Šè­¦å‡ºæ¥ã€‚ä¸è¿‡æ‚²å‰§çš„æ˜¯ï¼Œå³ä½¿èªæ˜çš„IDEä¹Ÿå­˜åœ¨è¯¯æŠ¥çš„æƒ…å†µï¼Œæ‰€ä»¥<strong>å®Œå…¨ä¾èµ–IDEæ˜¯ä¸é è°±çš„</strong>ï¼Œæ¯•ç«Ÿè¿™äº›é”™è¯¯éƒ½èƒ½ç¼–è¯‘è¿‡å»ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬çš„æ¡ˆä¾‹éƒ½æ˜¯ä¸€äº›ç®€åŒ–çš„åœºæ™¯ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºå’Œå‘ç°é—®é¢˜ï¼Œè€ŒçœŸå®çš„åœºæ™¯å¾€å¾€å¤æ‚å¾—å¤šã€‚ä¾‹å¦‚å¯¹äºæ¡ˆä¾‹1ï¼Œæˆ‘ä»¬çš„åŒç§ç±»å‹çš„å®ç°ï¼Œå¯èƒ½ä¸æ˜¯åŒæ—¶å‡ºç°åœ¨è‡ªå·±çš„é¡¹ç›®ä»£ç ä¸­ï¼Œè€Œæ˜¯æœ‰éƒ¨åˆ†å®ç°å‡ºç°åœ¨ä¾èµ–çš„Jaråº“ä¸­ã€‚æ‰€ä»¥ä½ ä¸€å®šè¦å¯¹æ¡ˆä¾‹èƒŒåçš„æºç å®ç°æœ‰ä¸€ä¸ªæ‰å®çš„äº†è§£ï¼Œè¿™æ ·æ‰èƒ½åœ¨å¤æ‚åœºæ™¯ä¸­å»è§„é¿è¿™äº›é—®é¢˜ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬çŸ¥é“äº†é€šè¿‡@Qualifierå¯ä»¥å¼•ç”¨æƒ³åŒ¹é…çš„Beanï¼Œä¹Ÿå¯ä»¥ç›´æ¥å‘½åå±æ€§çš„åç§°ä¸ºBeançš„åç§°æ¥å¼•ç”¨ï¼Œè¿™ä¸¤ç§æ–¹å¼å¦‚ä¸‹ï¼š</p><pre><code>//æ–¹å¼1ï¼šå±æ€§å‘½åä¸ºè¦è£…é…çš„beanåç§°\n@Autowired\nDataService oracleDataService;\n\n//æ–¹å¼2ï¼šä½¿ç”¨@Qualifierç›´æ¥å¼•ç”¨\n@Autowired\n@Qualifier(&quot;oracleDataService&quot;)\nDataService dataService;\n</code></pre><p>é‚£ä¹ˆå¯¹äºæ¡ˆä¾‹3çš„å†…éƒ¨ç±»å¼•ç”¨ï¼Œä½ è§‰å¾—å¯ä»¥ä½¿ç”¨ç¬¬1ç§æ–¹å¼åšåˆ°ä¹ˆï¼Ÿä¾‹å¦‚ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><blockquote>\n<p>@Autowired<br>\nDataService studentController.InnerClassDataService;</p>\n</blockquote><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"01ï½œSpring Bean å®šä¹‰å¸¸è§é”™è¯¯","id":364761},"right":{"article_title":"03ï½œSpring Bean ä¾èµ–æ³¨å…¥å¸¸è§é”™è¯¯ï¼ˆä¸‹ï¼‰","id":366930}},"comments":[{"had_liked":false,"id":289704,"user_name":"liuchao90h","can_delete":false,"product_type":"c1","uid":1747803,"ip_address":"","ucode":"30A89E766EED2B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ab/5b/eb3983f0.jpg","comment_is_top":false,"comment_ctime":1619147464,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"117583264456","product_id":100077001,"comment_content":"è¦æ˜¯å˜é‡ä¸­ä¹Ÿèƒ½åšåˆ°å¯ä»¥åŒ…å«.å·å°±å¯ä»¥äº†ï¼Œæˆ–è€…æºç ä¸­æŠŠåŒ…åˆ†éš”ç¬¦çš„.æ”¹æˆä¸‹åˆ’çº¿æ¥è§£å†³<br>å¯¹äºä¾‹å­ä¸­çš„com.spring.puzzle.class2.example3.StudentController.InnerClassDataServiceå»ºè®®æ¢æˆcom.spring.puzzle.class2.example3.StudentController$InnerClassDataServiceæ›´è§„èŒƒï¼Œå¦åˆ™å¯¹ç…§æºç æˆªå›¾æ˜¯ä¼šè¯¯è§£çš„ï¼Œæœ¬èº«ä¹Ÿä¸æ˜¯è¯­æ³•è§„èŒƒçš„å†™æ³•ï¼Œå°½ç®¡æ„æ€æ˜ç™½çš„äººéƒ½èƒ½æ˜ç™½è¿‡æ¥","like_count":28},{"had_liked":false,"id":289817,"user_name":"æ¥¼ä¸‹å°é»‘å“¥","can_delete":false,"product_type":"c1","uid":1014680,"ip_address":"","ucode":"453B099B0EE52E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7b/98/8f1aecf4.jpg","comment_is_top":false,"comment_ctime":1619188006,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27388991782","product_id":100077001,"comment_content":"å¥½å®¶ä¼™ï¼Œå’‹ä¸€çœ‹è¿™ä¸ªé—®é¢˜ï¼Œæ„Ÿè§‰è·Ÿ @Qualifier æ³¨è§£åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œåº”è¯¥å¯ä»¥ä½¿ç”¨å­—æ®µå tudentController.InnerClassDataService è¿™æ ·çš„æ–¹å¼ã€‚<br>ä½†æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹åˆ«æ‰­ï¼Œäºæ˜¯å¤åˆ¶åˆ° IDEA è¯•äº†ä¸‹ï¼ŒåŸæ¥è¿™æ ·è¯­æ³•æœ‰é—®é¢˜ï¼Œç›´æ¥å°±ä¼šæŠ¥é”™ğŸ˜‚ã€‚<br>å¤§æ„äº†~<br>èµåŒ @liuchao90h è¯´æ³•ï¼Œå†…éƒ¨ç±»å®é™…å–åˆ°åå­—åº”è¯¥ä¸º com.xxxx. StudentController$InnerClassDataService<br>","like_count":7},{"had_liked":false,"id":292265,"user_name":"æš–è‰²æµ®ä½™ç”Ÿ","can_delete":false,"product_type":"c1","uid":1593126,"ip_address":"","ucode":"ED943F2DF88896","user_header":"https://static001.geekbang.org/account/avatar/00/18/4f/26/f21afb83.jpg","comment_is_top":false,"comment_ctime":1620745780,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14505647668","product_id":100077001,"comment_content":"å…¶å®å¯ä»¥é€šè¿‡é‡å†™BeanNameGeneratoræ¥è‡ªå·±å®ç°beanåç§°çš„å®ç°ã€‚çœ‹äº†ä¸‹ComponentScanAnnotationParserçš„æºç ã€‚å‘ç°åœ¨parseæ–¹æ³•é‡Œé¢ä¼šè·å–æ³¨è§£ @ComponentScançš„nameGeneratorå±æ€§ã€‚è·å–åˆ°NameGeneratorçš„Classã€‚ç„¶åå®ä¾‹åŒ–è®¾ç½®åˆ°ClassPathBeanDefinitionScannerè¿™ä¸ªæ‰«æç±»çš„ BeanNameGeneratorå±æ€§ä¸Šé¢ã€‚ è¿™æ ·çš„è¯@AutowiredDataService innerClassDataServiceï¼›é€šè¿‡è‡ªå®šä¹‰çš„Beanåç§°ç”Ÿæˆå™¨æ¥æ³¨å…¥å°±å¯ä»¥äº†","like_count":4},{"had_liked":false,"id":299803,"user_name":"Niverkk","can_delete":false,"product_type":"c1","uid":2179875,"ip_address":"","ucode":"F9220C10107E44","user_header":"https://static001.geekbang.org/account/avatar/00/21/43/23/d98fb8f7.jpg","comment_is_top":false,"comment_ctime":1624866274,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"10214800866","product_id":100077001,"comment_content":"å†…éƒ¨ç±»ç±»åï¼šcom.spring.puzzle.class2.example3.StudentController.InnerClassDataService<br>åº”è¯¥æ˜¯ï¼šcom.spring.puzzle.class2.example3.StudentController$InnerClassDataService, &quot;.&quot;æ¢æˆ&quot;$&quot;","like_count":3,"discussions":[{"author":{"id":2188142,"avatar":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","nickname":"Zå®‡é”¤é”¤","note":"","ucode":"7DB36E986A7A51","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558693,"discussion_content":"åŠ è¿™ä¸ª$æœ‰ä»€ä¹ˆç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648435672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337223,"user_name":"å®‰è¿ªå¯†æ©","can_delete":false,"product_type":"c1","uid":1331611,"ip_address":"","ucode":"A6F3F67CF8E6F8","user_header":"https://static001.geekbang.org/account/avatar/00/14/51/9b/ccea47d9.jpg","comment_is_top":false,"comment_ctime":1646706028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5941673324","product_id":100077001,"comment_content":"å‚…å“¥ä½ å¥½ï¼Œç°åœ¨@Autowiredæ³¨è§£è¢«IDEAæ ‡è®°ä¸ºField injection is not recommendedã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿèƒ½å¦è¯·å‚…å“¥æ‰©å±•ä¸‹@Resourceçš„ç›¸å…³çŸ¥è¯†ç‚¹å‘¢ï¼Œè°¢è°¢ã€‚","like_count":2},{"had_liked":false,"id":297850,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1623813180,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5918780476","product_id":100077001,"comment_content":"1ã€@Priority(value=${number})çœ‹æºç ï¼šå€¼è¶Šå°ä¼˜å…ˆçº§è¶Šä½,å¯ä»¥ä¸ºè´Ÿæ•°,è‹¥å­˜åœ¨ä¸¤ä¸ªå€™é€‰ç›´æ¥æŠ›å¼‚å¸¸.<br>2ã€æ€è€ƒé¢˜ï¼šä¸å¯ä»¥ï¼Œå‘½åæ–¹å¼ä¸èƒ½é€šè¿‡","like_count":1},{"had_liked":false,"id":291926,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1620610278,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5915577574","product_id":100077001,"comment_content":"æœ‰2ä¸ªé—®é¢˜<br>1ã€beançš„ä¾èµ–å…³ç³»åœ¨å®ä¾‹åŒ–ä¹‹å‰å°±åº”è¯¥çŸ¥æ™“å§ï¼Ÿç„¶åå®‰è£…é¡ºåºåˆå§‹åŒ–<br>2ã€å¾ªç¯ä¾èµ–æ€ä¹ˆè§£å†³ï¼Ÿ<br>è°¢è°¢è€å¸ˆ","like_count":1,"discussions":[{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"æ¨å®‡","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539926,"discussion_content":"Springä½¿ç”¨â€œä¸‰çº§ç¼“å­˜â€æ¥è§£å†³å¾ªç¯ä¾èµ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639882363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291684,"user_name":"Utah","can_delete":false,"product_type":"c1","uid":1258455,"ip_address":"","ucode":"AD5EEFE68706A7","user_header":"https://static001.geekbang.org/account/avatar/00/13/33/d7/739e2f6d.jpg","comment_is_top":false,"comment_ctime":1620431821,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5915399117","product_id":100077001,"comment_content":"è¿™äº›é—®é¢˜ä¹‹å‰ç»å¸¸é‡åˆ°ï¼Œè§£å†³æ–¹å¼å°±æ˜¯ç™¾åº¦ï¼Œæ²¡æœ‰æ·±å…¥ç ”ç©¶è¿‡åŸç†ï¼Œå¸Œæœ›é€šè¿‡è¿™æ¬¡å­¦ä¹ ï¼Œä»¥åé‡åˆ°æ­¤ç±»é—®é¢˜çŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶","like_count":1},{"had_liked":false,"id":290215,"user_name":"å“¦å¼æ‰äº†","can_delete":false,"product_type":"c1","uid":1232599,"ip_address":"","ucode":"1F89B1BA1EEF52","user_header":"https://static001.geekbang.org/account/avatar/00/12/ce/d7/8168e1bf.jpg","comment_is_top":false,"comment_ctime":1619432908,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"5914400204","product_id":100077001,"comment_content":"é—®ä¸¤ä¸ªé—®é¢˜ï¼š<br>1.ä¸ºå•¥@Validatedæ³¨è§£å¿…é¡»æ”¾åœ¨ç±»ä¸Šï¼Œä¸ç„¶å°±æ ¡éªŒä¸ä½äº†ã€‚ å‚…å“¥å¼•å…¥çš„æ˜¯hibernateé‚£ä¸ªä¹ˆï¼Ÿ<br>2.æˆ‘çš„å°è±¡ä¸­ @Autowiredåªèƒ½æŒ‰ç…§ç±»å‹æ³¨å…¥ï¼Œè¿™é‡Œæœ‰ç‚¹é¢ è¦†è®¤çŸ¥  é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ@Resourceå’Œ@AutowiredåŒºåˆ«åˆ°åº•æ˜¯å•¥ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":2431311,"avatar":"https://static001.geekbang.org/account/avatar/00/25/19/4f/a0757e5f.jpg","nickname":"æ±Ÿå®XYZ","note":"","ucode":"D2D1C3DF0809F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372322,"discussion_content":"@autowiredä¼˜å…ˆbyTypeï¼Œæ‰¾ä¸åˆ°å°±byNameï¼Œ@Resourceä¼˜å…ˆByName","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1620286919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1366631,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/67/73a0c754.jpg","nickname":"gallifrey","note":"","ucode":"A4E5E0E7E2DEF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569424,"discussion_content":"1ã€ä¸ä¸€å®šæ˜¯æ”¾åœ¨æ§åˆ¶å™¨ç±»ä¸Šï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨å…¥å‚ä¸Šï¼Œæ˜¯hibernateçš„å¼•ç”¨\n2ã€Autowiredä¼˜å…ˆç±»å‹ï¼Œå†åç§°ã€‚Resourceä¼˜å…ˆåç§°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651423385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343384,"user_name":"KK","can_delete":false,"product_type":"c1","uid":1582420,"ip_address":"","ucode":"349FD35822DC8A","user_header":"https://static001.geekbang.org/account/avatar/00/18/25/54/ef2ca14f.jpg","comment_is_top":false,"comment_ctime":1650809718,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"1650809718","product_id":100077001,"comment_content":"ä¸ºä»€ä¹ˆä¸€å®šè¦çœ‹æºç ? <br>æºç ä¸æ˜¯ä¸€ç§å¥‘çº¦, æ˜¯å¯èƒ½å˜åŒ–çš„, è€Œä¸”å­¦ä¹ æˆæœ¬é«˜.  <br>å­¦ä¹ Springçš„å®˜æ–¹æ–‡æ¡£æ›´åŠ å¥½, å®˜æ–¹æ–‡æ¡£æ‰€é˜è¿°çš„ç‰¹æ€§, å¯ä»¥è®¤ä¸ºæ˜¯springçš„å¼€å‘è€…å’Œä½¿ç”¨è€…çš„å¥‘çº¦, æ˜¯ç›¸å¯¹ä¸å®¹æ˜“å˜åŒ–çš„. ","like_count":1,"discussions":[{"author":{"id":1366631,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/67/73a0c754.jpg","nickname":"gallifrey","note":"","ucode":"A4E5E0E7E2DEF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569422,"discussion_content":"å­¦ä¹ æºç ï¼Œæ˜¯è®©ç¨‹åºå‘˜ä»æ ¹æºä¸Šæ‰¾åˆ°é—®é¢˜ï¼Œå¯èƒ½æœ‰çš„æŠ€æœ¯æ²¡æœ‰æ–‡æ¡£ï¼Œæˆ–è€…æ–‡æ¡£ä¸å¤Ÿç»†èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651423252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1582420,"avatar":"https://static001.geekbang.org/account/avatar/00/18/25/54/ef2ca14f.jpg","nickname":"KK","note":"","ucode":"349FD35822DC8A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1366631,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/67/73a0c754.jpg","nickname":"gallifrey","note":"","ucode":"A4E5E0E7E2DEF9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569963,"discussion_content":"å¤§å¤šæ•°æˆ‘ä»¬ç”Ÿäº§ä½¿ç”¨çš„æ¡†æ¶å’Œåº“éƒ½æ˜¯æœ‰æ¯”è¾ƒå¥½çš„æ–‡æ¡£çš„å§ï¼Ÿ æˆ‘æ²¡æœ‰è¯´ä¸å»çœ‹æºç ï¼Œ åªæ˜¯è¯´å¦‚æœä»ä½¿ç”¨å‡ºå‘ï¼Œå­¦ä¹ å®˜æ–¹æ–‡æ¡£çš„ä¼˜å…ˆçº§è¦æ›´é«˜ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651624463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":569422,"ip_address":""},"score":569963,"extra":""}]}]},{"had_liked":false,"id":341616,"user_name":"å¯ä¹","can_delete":false,"product_type":"c1","uid":2969993,"ip_address":"","ucode":"2D82251AC1AB88","user_header":"https://static001.geekbang.org/account/avatar/00/2d/51/89/539096e2.jpg","comment_is_top":false,"comment_ctime":1649736019,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1649736019","product_id":100077001,"comment_content":"é—®é¢˜ï¼š<br><br>public interface DataService {<br>    void deleteStudent(int id);<br>}<br><br>è¿™ä¸ªæ¥å£å¹¶æ²¡æœ‰æ³¨å…¥beanï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç”¨autowireå»æ‰¾è¿™ä¸ªbeanå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1366631,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/67/73a0c754.jpg","nickname":"gallifrey","note":"","ucode":"A4E5E0E7E2DEF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569420,"discussion_content":"DataServiceæ¥å£çš„å®ç°ç±»ï¼ŒåŠ ä¸Šäº†è¯¸å¦‚@Serviceæˆ–è€…@Repositoryä¹‹ç±»çš„æ³¨è§£ï¼Œç”±äºè¿™äº›æ³¨è§£åˆåŒ…å«äº†@Componentæ³¨è§£ï¼Œä¼šè¢«Springæ‰«æåˆ°åæ³¨å…¥äº†å®¹å™¨ä¸­ï¼Œè¿™æ ·@Autowiredå°±å¯ä»¥æ‰¾åˆ°äº†ã€‚ï¼ˆè¿™é‡Œé¢åˆæ¶‰åŠåˆ°äº†å¤šæ€ï¼Œçˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼‰","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1651422969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332195,"user_name":"å­å¤œæ¯ç¯","can_delete":false,"product_type":"c1","uid":1359678,"ip_address":"","ucode":"5D84BFE7832038","user_header":"https://static001.geekbang.org/account/avatar/00/14/bf/3e/cdc36608.jpg","comment_is_top":false,"comment_ctime":1643093649,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643093649","product_id":100077001,"comment_content":"æ€è€ƒé¢˜ï¼šä¸å¯ä»¥ï¼Œå‘½åæ–¹å¼ä¸èƒ½é€šè¿‡","like_count":0},{"had_liked":false,"id":319287,"user_name":"if...else...","can_delete":false,"product_type":"c1","uid":2550743,"ip_address":"","ucode":"D0565908C99695","user_header":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","comment_is_top":false,"comment_ctime":1635733492,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635733492","product_id":100077001,"comment_content":"æ€è€ƒé¢˜åº”è¯¥ä¸èƒ½ç”¨æ–¹æ³•1ï¼Œå˜é‡åå¥½åƒä¸èƒ½æœ‰ç‚¹ç¬¦å·","like_count":0},{"had_liked":false,"id":318927,"user_name":"ä¸€æ­¥","can_delete":false,"product_type":"c1","uid":1295533,"ip_address":"","ucode":"5DA3CD38CDA439","user_header":"https://static001.geekbang.org/account/avatar/00/13/c4/ad/79b8a12c.jpg","comment_is_top":false,"comment_ctime":1635484349,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1635484349","product_id":100077001,"comment_content":"ææ‡‚Springæ˜¯å¦‚ä½•æ‰¾åˆ°beanï¼Œæ‰¾beançš„åŸåˆ™<br>ææ‡‚Springæ˜¯å¦‚ä½•ç®¡ç†å†…éƒ¨ç±»ï¼ˆbeanåŒ–ï¼‰<br>ææ‡‚autowrieå’Œqualiterçš„åŒºåˆ«","like_count":0},{"had_liked":false,"id":302853,"user_name":"å®‰çœ ","can_delete":false,"product_type":"c1","uid":2594123,"ip_address":"","ucode":"94AC6BE1FFD257","user_header":"https://static001.geekbang.org/account/avatar/00/27/95/4b/9b50efe3.jpg","comment_is_top":false,"comment_ctime":1626407573,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1626407573","product_id":100077001,"comment_content":"è¯·é—®æ¡ˆä¾‹ä¸€ä¸­æ‰€è¯´â€œ@Autowired è¦æ±‚æ˜¯å¿…é¡»æ³¨å…¥çš„ï¼ˆå³ required ä¿æŒé»˜è®¤å€¼ä¸º trueï¼‰ï¼Œæˆ–è€…æ³¨è§£çš„å±æ€§ç±»å‹å¹¶ä¸æ˜¯å¯ä»¥æ¥å—å¤šä¸ª Bean çš„ç±»å‹ï¼Œä¾‹å¦‚æ•°ç»„ã€Mapã€é›†åˆã€‚â€œå¦‚ä½•ç†è§£å‘¢ï¼Ÿå› ä¸ºæˆ‘è¯•äº†ä¸€ä¸‹å¯ä»¥æ³¨å…¥ä¸€ä¸ªé›†åˆï¼Œæ¯”å¦‚<br>@Autowired<br> List&lt;DataService&gt; dataServices;<br><br>æ‰“å°å‡ºæ¥ç»“æœ<br>[com.spring.puzzle.class2.example1.CassandraDataService@2a8fcfa5, com.spring.puzzle.class2.example1.OracleDataService@79330729]","like_count":0,"discussions":[{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"æ¨å®‡","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":539925,"discussion_content":"å¯¹äºé›†åˆç±»å‹ï¼Œç”±äºå¯ä»¥å®¹çº³å¤šä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿæœ¬æ¡ˆä¾‹æ‰€é¢„æœŸçš„æŠ¥é”™ç°è±¡ã€‚æ‰€ä»¥æ¡ä»¶2è¦ç‰¹æ®Šè¯´æ˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639882299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298129,"user_name":"é»‘ç™½é¢ å€’","can_delete":false,"product_type":"c1","uid":2167240,"ip_address":"","ucode":"E79D2540C3F668","user_header":"https://static001.geekbang.org/account/avatar/00/21/11/c8/889846a7.jpg","comment_is_top":false,"comment_ctime":1623919247,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623919247","product_id":100077001,"comment_content":"æ¡ˆä¾‹ä¸‰æˆ‘è§‰å¾—<br>@AutowiredDataService InnerClassDataService;å°±è¡Œ","like_count":0},{"had_liked":false,"id":294532,"user_name":"nimil","can_delete":false,"product_type":"c1","uid":1197925,"ip_address":"","ucode":"19933068972746","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/65/cce8eb34.jpg","comment_is_top":false,"comment_ctime":1621991590,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621991590","product_id":100077001,"comment_content":"è¿™è¯¾ç¨‹æœ‰æ„æ€ï¼Œå‡ ä¸ªå°é—®é¢˜ï¼Œå¼•å‡ºæºç è§£æ","like_count":0},{"had_liked":false,"id":292709,"user_name":"gaohw","can_delete":false,"product_type":"c1","uid":1213643,"ip_address":"","ucode":"6C30D86909FDE0","user_header":"https://static001.geekbang.org/account/avatar/00/12/84/cb/f04d632a.jpg","comment_is_top":false,"comment_ctime":1620948387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620948387","product_id":100077001,"comment_content":"ç»§ç»­åŠªåŠ› ç†è§£æºç  æ‹“å®½è§†é‡","like_count":0},{"had_liked":false,"id":292690,"user_name":"è™¹ç‚","can_delete":false,"product_type":"c1","uid":1600615,"ip_address":"","ucode":"9E28ACEBFB26D5","user_header":"https://static001.geekbang.org/account/avatar/00/18/6c/67/07bcc58f.jpg","comment_is_top":false,"comment_ctime":1620922383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1620922383","product_id":100077001,"comment_content":"ä¸èƒ½åšåˆ°ï¼Œå› ä¸ºä¼šæŠ¥ç¼–è¯‘é”™è¯¯ã€‚studentController.InnerClassDataService;  è¿™ä¸€å¥ã€‚","like_count":0},{"had_liked":false,"id":290136,"user_name":"Ball","can_delete":false,"product_type":"c1","uid":1521451,"ip_address":"","ucode":"1EE949E68D84CA","user_header":"https://static001.geekbang.org/account/avatar/00/17/37/2b/b32f1d66.jpg","comment_is_top":false,"comment_ctime":1619398403,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1619398403","product_id":100077001,"comment_content":"æ²¡æƒ³åˆ°ä¸€ä¸ªç®€å•çš„ bean name çš„é—®é¢˜åœ¨æºç é‡Œå±…ç„¶èƒ½æ‰¾åˆ°è¿™ä¹ˆç²¾å½©çš„ç­”æ¡ˆï¼","like_count":0,"discussions":[{"author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373085,"discussion_content":"æœ‰2ä¸ªé—®é¢˜\n1ã€spring beançš„ä¾èµ–å…³ç³»åœ¨å®ä¾‹åŒ–ä¹‹å‰å°±åº”è¯¥çŸ¥æ™“ï¼Ÿ\n2ã€å¾ªç¯ä¾èµ–springæ€ä¹ˆè§£å†³çš„ï¼Ÿ\nè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620610148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1366631,"avatar":"https://static001.geekbang.org/account/avatar/00/14/da/67/73a0c754.jpg","nickname":"gallifrey","note":"","ucode":"A4E5E0E7E2DEF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569421,"discussion_content":"å»ºè®®äº†è§£Springçš„ä¸‰çº§ç¼“å­˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651423101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":373085,"ip_address":""},"score":569421,"extra":""}]}]}]}