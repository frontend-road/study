{"id":9588,"title":"ç¬¬20è®² | å¹¶å‘åŒ…ä¸­çš„ConcurrentLinkedQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","content":"<p>åœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘åˆ†æäº†Javaå¹¶å‘åŒ…ä¸­çš„éƒ¨åˆ†å†…å®¹ï¼Œä»Šå¤©æˆ‘æ¥ä»‹ç»ä¸€ä¸‹çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ã€‚Javaæ ‡å‡†åº“æä¾›äº†éå¸¸å¤šçš„çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼Œå¾ˆå®¹æ˜“æ··æ·†ã€‚</p>\n<p>ä»Šå¤©æˆ‘è¦é—®ä½ çš„é—®é¢˜æ˜¯ï¼Œ<span class=\"orange\">å¹¶å‘åŒ…ä¸­çš„ConcurrentLinkedQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span></p>\n<h2>å…¸å‹å›ç­”</h2>\n<p>æœ‰æ—¶å€™æˆ‘ä»¬æŠŠå¹¶å‘åŒ…ä¸‹é¢çš„æ‰€æœ‰å®¹å™¨éƒ½ä¹ æƒ¯å«ä½œå¹¶å‘å®¹å™¨ï¼Œä½†æ˜¯ä¸¥æ ¼æ¥è®²ï¼Œç±»ä¼¼ConcurrentLinkedQueueè¿™ç§â€œConcurrent*â€å®¹å™¨ï¼Œæ‰æ˜¯çœŸæ­£ä»£è¡¨å¹¶å‘ã€‚</p>\n<p>å…³äºé—®é¢˜ä¸­å®ƒä»¬çš„åŒºåˆ«ï¼š</p>\n<ul>\n<li>\n<p>Concurrentç±»å‹åŸºäºlock-freeï¼Œåœ¨å¸¸è§çš„å¤šçº¿ç¨‹è®¿é—®åœºæ™¯ï¼Œä¸€èˆ¬å¯ä»¥æä¾›è¾ƒé«˜ååé‡ã€‚</p>\n</li>\n<li>\n<p>è€ŒLinkedBlockingQueueå†…éƒ¨åˆ™æ˜¯åŸºäºé”ï¼Œå¹¶æä¾›äº†BlockingQueueçš„ç­‰å¾…æ€§æ–¹æ³•ã€‚</p>\n</li>\n</ul>\n<p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œjava.util.concurrentåŒ…æä¾›çš„å®¹å™¨ï¼ˆQueueã€Listã€Setï¼‰ã€Mapï¼Œä»å‘½åä¸Šå¯ä»¥å¤§æ¦‚åŒºåˆ†ä¸ºConcurrent*ã€CopyOnWrite<em>å’ŒBlocking</em>ç­‰ä¸‰ç±»ï¼ŒåŒæ ·æ˜¯çº¿ç¨‹å®‰å…¨å®¹å™¨ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºï¼š</p>\n<ul>\n<li>\n<p>Concurrentç±»å‹æ²¡æœ‰ç±»ä¼¼CopyOnWriteä¹‹ç±»å®¹å™¨ç›¸å¯¹è¾ƒé‡çš„ä¿®æ”¹å¼€é”€ã€‚</p>\n</li>\n<li>\n<p>ä½†æ˜¯ï¼Œå‡¡äº‹éƒ½æ˜¯æœ‰ä»£ä»·çš„ï¼ŒConcurrentå¾€å¾€æä¾›äº†è¾ƒä½çš„éå†ä¸€è‡´æ€§ã€‚ä½ å¯ä»¥è¿™æ ·ç†è§£æ‰€è°“çš„å¼±ä¸€è‡´æ€§ï¼Œä¾‹å¦‚ï¼Œå½“åˆ©ç”¨è¿­ä»£å™¨éå†æ—¶ï¼Œå¦‚æœå®¹å™¨å‘ç”Ÿä¿®æ”¹ï¼Œè¿­ä»£å™¨ä»ç„¶å¯ä»¥ç»§ç»­è¿›è¡Œéå†ã€‚</p>\n</li>\n<li>\n<p>ä¸å¼±ä¸€è‡´æ€§å¯¹åº”çš„ï¼Œå°±æ˜¯æˆ‘ä»‹ç»è¿‡çš„åŒæ­¥å®¹å™¨å¸¸è§çš„è¡Œä¸ºâ€œfail-fastâ€ï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹åˆ°å®¹å™¨åœ¨éå†è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¿®æ”¹ï¼Œåˆ™æŠ›å‡ºConcurrentModificationExceptionï¼Œä¸å†ç»§ç»­éå†ã€‚</p>\n</li>\n<li>\n<p>å¼±ä¸€è‡´æ€§çš„å¦å¤–ä¸€ä¸ªä½“ç°æ˜¯ï¼Œsizeç­‰æ“ä½œå‡†ç¡®æ€§æ˜¯æœ‰é™çš„ï¼Œæœªå¿…æ˜¯100%å‡†ç¡®ã€‚</p>\n</li>\n<li>\n<p>ä¸æ­¤åŒæ—¶ï¼Œè¯»å–çš„æ€§èƒ½å…·æœ‰ä¸€å®šçš„ä¸ç¡®å®šæ€§ã€‚</p>\n</li>\n</ul><!-- [[[read_end]]] -->\n<h2>è€ƒç‚¹åˆ†æ</h2>\n<p>ä»Šå¤©çš„é—®é¢˜æ˜¯åˆæ˜¯ä¸€ä¸ªå¼•å­ï¼Œè€ƒå¯Ÿä½ æ˜¯å¦äº†è§£å¹¶å‘åŒ…å†…éƒ¨ä¸åŒå®¹å™¨å®ç°çš„è®¾è®¡ç›®çš„å’Œå®ç°åŒºåˆ«ã€‚</p>\n<p>é˜Ÿåˆ—æ˜¯éå¸¸é‡è¦çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­å¾ˆå¤šçº¿ç¨‹é—´æ•°æ®ä¼ é€’éƒ½è¦ä¾èµ–äºå®ƒï¼ŒExecutoræ¡†æ¶æä¾›çš„å„ç§çº¿ç¨‹æ± ï¼ŒåŒæ ·æ— æ³•ç¦»å¼€é˜Ÿåˆ—ã€‚é¢è¯•å®˜å¯ä»¥ä»ä¸åŒè§’åº¦è€ƒå¯Ÿï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li>\n<p>å“ªäº›é˜Ÿåˆ—æ˜¯æœ‰ç•Œçš„ï¼Œå“ªäº›æ˜¯æ— ç•Œçš„ï¼Ÿï¼ˆå¾ˆå¤šåŒå­¦åé¦ˆäº†è¿™ä¸ªé—®é¢˜ï¼‰</p>\n</li>\n<li>\n<p>é’ˆå¯¹ç‰¹å®šåœºæ™¯éœ€æ±‚ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„é˜Ÿåˆ—å®ç°ï¼Ÿ</p>\n</li>\n<li>\n<p>ä»æºç çš„è§’åº¦ï¼Œå¸¸è§çš„çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå¹¶è¿›è¡Œäº†å“ªäº›æ”¹è¿›ä»¥æé«˜æ€§èƒ½è¡¨ç°ï¼Ÿ</p>\n</li>\n</ul>\n<p>ä¸ºäº†èƒ½æ›´å¥½åœ°ç†è§£è¿™ä¸€è®²ï¼Œéœ€è¦ä½ æŒæ¡ä¸€äº›åŸºæœ¬çš„é˜Ÿåˆ—æœ¬èº«å’Œæ•°æ®ç»“æ„æ–¹é¢çŸ¥è¯†ï¼Œå¦‚æœè¿™æ–¹é¢çŸ¥è¯†æ¯”è¾ƒè–„å¼±ï¼Œã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æã€‹æ˜¯ä¸€æœ¬æ¯”è¾ƒå…¨é¢çš„å‚è€ƒä¹¦ï¼Œä¸“æ è¿˜æ˜¯å°½é‡ä¸“æ³¨äºJavaé¢†åŸŸçš„ç‰¹æ€§ã€‚</p>\n<h2>çŸ¥è¯†æ‰©å±•</h2>\n<p><strong>çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ä¸€è§ˆ</strong></p>\n<p>æˆ‘åœ¨<a href=\"http://time.geekbang.org/column/article/7810\">ä¸“æ ç¬¬8è®²</a>ä¸­ä»‹ç»è¿‡ï¼Œå¸¸è§çš„é›†åˆä¸­å¦‚LinkedListæ˜¯ä¸ªDequeï¼Œåªä¸è¿‡ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸‹é¢è¿™å¼ å›¾æ˜¯Javaå¹¶å‘ç±»åº“æä¾›çš„å„ç§å„æ ·çš„<strong>çº¿ç¨‹å®‰å…¨</strong>é˜Ÿåˆ—å®ç°ï¼Œæ³¨æ„ï¼Œå›¾ä¸­å¹¶æœªå°†éçº¿ç¨‹å®‰å…¨éƒ¨åˆ†åŒ…å«è¿›æ¥ã€‚</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/79/79/791750d6fe7ef88ecb3897e1d029f079.png?wh=851*359\" alt=\"\" /></p>\n<p>æˆ‘ä»¬å¯ä»¥ä»ä¸åŒçš„è§’åº¦è¿›è¡Œåˆ†ç±»ï¼Œä»åŸºæœ¬çš„æ•°æ®ç»“æ„çš„è§’åº¦åˆ†æï¼Œæœ‰ä¸¤ä¸ªç‰¹åˆ«çš„<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/Deque.html\">Deque</a>å®ç°ï¼ŒConcurrentLinkedDequeå’ŒLinkedBlockingDequeã€‚Dequeçš„ä¾§é‡ç‚¹æ˜¯æ”¯æŒå¯¹é˜Ÿåˆ—å¤´å°¾éƒ½è¿›è¡Œæ’å…¥å’Œåˆ é™¤ï¼Œæ‰€ä»¥æä¾›äº†ç‰¹å®šçš„æ–¹æ³•ï¼Œå¦‚:</p>\n<ul>\n<li>\n<p>å°¾éƒ¨æ’å…¥æ—¶éœ€è¦çš„<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/Deque.html#addLast-E-\">addLast(e)</a>ã€<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/Deque.html#offerLast-E-\">offerLast(e)</a>ã€‚</p>\n</li>\n<li>\n<p>å°¾éƒ¨åˆ é™¤æ‰€éœ€è¦çš„<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/Deque.html#removeLast--\">removeLast()</a>ã€<a href=\"https://docs.oracle.com/javase/9/docs/api/java/util/Deque.html#pollLast--\">pollLast()</a>ã€‚</p>\n</li>\n</ul>\n<p>ä»ä¸Šé¢è¿™äº›è§’åº¦ï¼Œèƒ½å¤Ÿç†è§£ConcurrentLinkedDequeå’ŒLinkedBlockingQueueçš„ä¸»è¦åŠŸèƒ½åŒºåˆ«ï¼Œä¹Ÿå°±è¶³å¤Ÿæ—¥å¸¸å¼€å‘çš„éœ€è¦äº†ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ·±å…¥ä¸€äº›ï¼Œé€šå¸¸ä¼šæ›´åŠ å…³æ³¨ä¸‹é¢è¿™äº›æ–¹é¢ã€‚</p>\n<p>ä»è¡Œä¸ºç‰¹å¾æ¥çœ‹ï¼Œç»å¤§éƒ¨åˆ†Queueéƒ½æ˜¯å®ç°äº†BlockingQueueæ¥å£ã€‚åœ¨å¸¸è§„é˜Ÿåˆ—æ“ä½œåŸºç¡€ä¸Šï¼ŒBlockingæ„å‘³ç€å…¶æä¾›äº†ç‰¹å®šçš„ç­‰å¾…æ€§æ“ä½œï¼Œè·å–æ—¶ï¼ˆtakeï¼‰ç­‰å¾…å…ƒç´ è¿›é˜Ÿï¼Œæˆ–è€…æ’å…¥æ—¶ï¼ˆputï¼‰ç­‰å¾…é˜Ÿåˆ—å‡ºç°ç©ºä½ã€‚</p>\n<pre><code> /**\n * è·å–å¹¶ç§»é™¤é˜Ÿåˆ—å¤´ç»“ç‚¹ï¼Œå¦‚æœå¿…è¦ï¼Œå…¶ä¼šç­‰å¾…ç›´åˆ°é˜Ÿåˆ—å‡ºç°å…ƒç´ \nâ€¦\n */\nE take() throws InterruptedException;\n\n/**\n * æ’å…¥å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™ç­‰å¾…ç›´åˆ°é˜Ÿåˆ—å‡ºç°ç©ºé—²ç©ºé—´\n Â Â â€¦\n */\nvoid put(E e) throws InterruptedException;  \n</code></pre>\n<p>å¦ä¸€ä¸ªBlockingQueueç»å¸¸è¢«è€ƒå¯Ÿçš„ç‚¹ï¼Œå°±æ˜¯æ˜¯å¦æœ‰ç•Œï¼ˆBoundedã€Unboundedï¼‰ï¼Œè¿™ä¸€ç‚¹ä¹Ÿå¾€å¾€ä¼šå½±å“æˆ‘ä»¬åœ¨åº”ç”¨å¼€å‘ä¸­çš„é€‰æ‹©ï¼Œæˆ‘è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<ul>\n<li>ArrayBlockingQueueæ˜¯æœ€å…¸å‹çš„çš„æœ‰ç•Œé˜Ÿåˆ—ï¼Œå…¶å†…éƒ¨ä»¥finalçš„æ•°ç»„ä¿å­˜æ•°æ®ï¼Œæ•°ç»„çš„å¤§å°å°±å†³å®šäº†é˜Ÿåˆ—çš„è¾¹ç•Œï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åˆ›å»ºArrayBlockingQueueæ—¶ï¼Œéƒ½è¦æŒ‡å®šå®¹é‡ï¼Œå¦‚</li>\n</ul>\n<pre><code>public ArrayBlockingQueue(int capacity, boolean fair)\n</code></pre>\n<ul>\n<li>\n<p>LinkedBlockingQueueï¼Œå®¹æ˜“è¢«è¯¯è§£ä¸ºæ— è¾¹ç•Œï¼Œä½†å…¶å®å…¶è¡Œä¸ºå’Œå†…éƒ¨ä»£ç éƒ½æ˜¯åŸºäºæœ‰ç•Œçš„é€»è¾‘å®ç°çš„ï¼Œåªä¸è¿‡å¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨åˆ›å»ºé˜Ÿåˆ—æ—¶å°±æŒ‡å®šå®¹é‡ï¼Œé‚£ä¹ˆå…¶å®¹é‡é™åˆ¶å°±è‡ªåŠ¨è¢«è®¾ç½®ä¸ºInteger.MAX_VALUEï¼Œæˆä¸ºäº†æ— ç•Œé˜Ÿåˆ—ã€‚</p>\n</li>\n<li>\n<p>SynchronousQueueï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥‡è‘©çš„é˜Ÿåˆ—å®ç°ï¼Œæ¯ä¸ªåˆ é™¤æ“ä½œéƒ½è¦ç­‰å¾…æ’å…¥æ“ä½œï¼Œåä¹‹æ¯ä¸ªæ’å…¥æ“ä½œä¹Ÿéƒ½è¦ç­‰å¾…åˆ é™¤åŠ¨ä½œã€‚é‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—çš„å®¹é‡æ˜¯å¤šå°‘å‘¢ï¼Ÿæ˜¯1å—ï¼Ÿå…¶å®ä¸æ˜¯çš„ï¼Œå…¶å†…éƒ¨å®¹é‡æ˜¯0ã€‚</p>\n</li>\n<li>\n<p>PriorityBlockingQueueæ˜¯æ— è¾¹ç•Œçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œè™½ç„¶ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼Œå…¶å¤§å°æ€»å½’æ˜¯è¦å—ç³»ç»Ÿèµ„æºå½±å“ã€‚</p>\n</li>\n<li>\n<p>DelayedQueueå’ŒLinkedTransferQueueåŒæ ·æ˜¯æ— è¾¹ç•Œçš„é˜Ÿåˆ—ã€‚å¯¹äºæ— è¾¹ç•Œçš„é˜Ÿåˆ—ï¼Œæœ‰ä¸€ä¸ªè‡ªç„¶çš„ç»“æœï¼Œå°±æ˜¯putæ“ä½œæ°¸è¿œä¹Ÿä¸ä¼šå‘ç”Ÿå…¶ä»–BlockingQueueçš„é‚£ç§ç­‰å¾…æƒ…å†µã€‚</p>\n</li>\n</ul>\n<p>å¦‚æœæˆ‘ä»¬åˆ†æä¸åŒé˜Ÿåˆ—çš„åº•å±‚å®ç°ï¼ŒBlockingQueueåŸºæœ¬éƒ½æ˜¯åŸºäºé”å®ç°ï¼Œä¸€èµ·æ¥çœ‹çœ‹å…¸å‹çš„LinkedBlockingQueueã€‚</p>\n<pre><code>/** Lock held by take, poll, etc */\nprivate final ReentrantLock takeLock = new ReentrantLock();\n\n/** Wait queue for waiting takes */\nprivate final Condition notEmpty = takeLock.newCondition();\n\n/** Lock held by put, offer, etc */\nprivate final ReentrantLock putLock = new ReentrantLock();\n\n/** Wait queue for waiting puts */\nprivate final Condition notFull = putLock.newCondition();\n</code></pre>\n<p>æˆ‘åœ¨ä»‹ç»ReentrantLockçš„æ¡ä»¶å˜é‡ç”¨æ³•çš„æ—¶å€™åˆ†æè¿‡ArrayBlockingQueueï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå…¶æ¡ä»¶å˜é‡ä¸LinkedBlockingQueueç‰ˆæœ¬çš„å®ç°æ˜¯æœ‰åŒºåˆ«çš„ã€‚notEmptyã€notFulléƒ½æ˜¯åŒä¸€ä¸ªå†å…¥é”çš„æ¡ä»¶å˜é‡ï¼Œè€ŒLinkedBlockingQueueåˆ™æ”¹è¿›äº†é”æ“ä½œçš„ç²’åº¦ï¼Œå¤´ã€å°¾æ“ä½œä½¿ç”¨ä¸åŒçš„é”ï¼Œæ‰€ä»¥åœ¨é€šç”¨åœºæ™¯ä¸‹ï¼Œå®ƒçš„ååé‡ç›¸å¯¹è¦æ›´å¥½ä¸€äº›ã€‚</p>\n<p>ä¸‹é¢çš„takeæ–¹æ³•ä¸ArrayBlockingQueueä¸­çš„å®ç°ï¼Œä¹Ÿæ˜¯æœ‰ä¸åŒçš„ï¼Œç”±äºå…¶å†…éƒ¨ç»“æ„æ˜¯é“¾è¡¨ï¼Œéœ€è¦è‡ªå·±ç»´æŠ¤å…ƒç´ æ•°é‡å€¼ï¼Œè¯·å‚è€ƒä¸‹é¢çš„ä»£ç ã€‚</p>\n<pre><code>public E take() throws InterruptedException {\n Â Â Â final E x;\n Â Â Â final int c;\n Â Â Â final AtomicInteger count = this.count;\n Â Â Â final ReentrantLock takeLock = this.takeLock;\n Â Â Â takeLock.lockInterruptibly();\n Â Â Â try {\n Â Â Â Â Â Â Â while (count.get() == 0) {\n Â Â Â Â Â Â Â Â Â Â Â notEmpty.await();\n Â Â Â Â Â Â Â }\n Â Â Â Â Â Â Â x = dequeue();\n Â Â Â Â Â Â Â c = count.getAndDecrement();\n Â Â Â Â Â Â Â if (c &gt; 1)\n Â Â Â Â Â Â Â Â Â Â Â notEmpty.signal();\n Â Â Â } finally {\n Â Â Â Â Â Â Â takeLock.unlock();\n Â Â Â }\n Â Â Â if (c == capacity)\n Â Â Â Â Â Â Â signalNotFull();\n Â Â Â return x;\n}\n</code></pre>\n<p>ç±»ä¼¼ConcurrentLinkedQueueç­‰ï¼Œåˆ™æ˜¯åŸºäºCASçš„æ— é”æŠ€æœ¯ï¼Œä¸éœ€è¦åœ¨æ¯ä¸ªæ“ä½œæ—¶ä½¿ç”¨é”ï¼Œæ‰€ä»¥æ‰©å±•æ€§è¡¨ç°è¦æ›´åŠ ä¼˜å¼‚ã€‚</p>\n<p>ç›¸å¯¹æ¯”è¾ƒå¦ç±»çš„SynchronousQueueï¼Œåœ¨Java 6ä¸­ï¼Œå…¶å®ç°å‘ç”Ÿäº†éå¸¸å¤§çš„å˜åŒ–ï¼Œåˆ©ç”¨CASæ›¿æ¢æ‰äº†åŸæœ¬åŸºäºé”çš„é€»è¾‘ï¼ŒåŒæ­¥å¼€é”€æ¯”è¾ƒå°ã€‚å®ƒæ˜¯Executors.newCachedThreadPool()çš„é»˜è®¤é˜Ÿåˆ—ã€‚</p>\n<p><strong>é˜Ÿåˆ—ä½¿ç”¨åœºæ™¯ä¸å…¸å‹ç”¨ä¾‹</strong></p>\n<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘æåˆ°è¿‡Queueè¢«å¹¿æ³›ä½¿ç”¨åœ¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…åœºæ™¯ï¼Œæ¯”å¦‚åˆ©ç”¨BlockingQueueæ¥å®ç°ï¼Œç”±äºå…¶æä¾›çš„ç­‰å¾…æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°‘æ“å¿ƒå¾ˆå¤šåè°ƒå·¥ä½œï¼Œä½ å¯ä»¥å‚è€ƒä¸‹é¢æ ·ä¾‹ä»£ç ï¼š</p>\n<pre><code>import java.util.concurrent.ArrayBlockingQueue;\nimport java.util.concurrent.BlockingQueue;\n\npublic class ConsumerProducer {\n Â Â Â public static final String EXIT_MSG Â = &quot;Good bye!&quot;;\n Â Â Â public static void main(String[] args) {\n// ä½¿ç”¨è¾ƒå°çš„é˜Ÿåˆ—ï¼Œä»¥æ›´å¥½åœ°åœ¨è¾“å‡ºä¸­å±•ç¤ºå…¶å½±å“\n Â Â Â Â Â Â Â BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(3);\n Â Â Â Â Â Â Â Producer producer = new Producer(queue);\n Â Â Â Â Â Â Â Consumer consumer = new Consumer(queue);\n Â Â Â Â Â Â Â new Thread(producer).start();\n Â Â Â Â Â Â Â new Thread(consumer).start();\n Â Â Â }\n\n\n Â Â Â static class Producer implements Runnable {\n Â Â Â Â Â Â Â private BlockingQueue&lt;String&gt; queue;\n Â Â Â Â Â Â Â public Producer(BlockingQueue&lt;String&gt; q) {\n Â Â Â Â Â Â Â Â Â Â Â this.queue = q;\n Â Â Â Â Â Â Â }\n\n Â Â Â Â Â Â Â @Override\n Â Â Â Â Â Â Â public void run() {\n Â Â Â Â Â Â Â Â Â Â Â for (int i = 0; i &lt; 20; i++) {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â try{\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(5L);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String msg = &quot;Message&quot; + i;\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(&quot;Produced new item: &quot; + msg);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â queue.put(msg);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } catch (InterruptedException e) {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\n Â Â Â Â Â Â Â Â Â Â Â }\n\n Â Â Â Â Â Â Â Â Â Â Â try {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(&quot;Time to say good bye!&quot;);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â queue.put(EXIT_MSG);\n Â Â Â Â Â Â Â Â Â Â Â } catch (InterruptedException e) {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();\n Â Â Â Â Â Â Â Â Â Â Â }\n Â Â Â Â Â Â Â }\n Â Â Â }\n\n Â Â Â static class Consumer implements Runnable{\n Â Â Â Â Â Â Â private BlockingQueue&lt;String&gt; queue;\n Â Â Â Â Â Â Â public Consumer(BlockingQueue&lt;String&gt; q){\n Â Â Â Â Â Â Â Â Â Â Â this.queue=q;\n Â Â Â Â Â Â Â }\n\n Â Â Â Â Â Â Â @Override\n Â Â Â Â Â Â Â public void run() {\n Â Â Â Â Â Â Â Â Â Â Â try{\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String msg;\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â while(!EXIT_MSG.equalsIgnoreCase( (msg = queue.take()))){\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(&quot;Consumed item: &quot; + msg);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread.sleep(10L);\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(&quot;Got exit message, bye!&quot;);\n Â Â Â Â Â Â Â Â Â Â Â }catch(InterruptedException e) {\n Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();\n Â Â Â Â Â Â Â Â Â Â Â }\n Â Â Â Â Â Â Â }\n Â Â Â }\n}\n</code></pre>\n<p>ä¸Šé¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ ·ä¾‹ï¼Œå¦‚æœä½¿ç”¨éBlockingçš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦è‡ªå·±å»å®ç°è½®è¯¢ã€æ¡ä»¶åˆ¤æ–­ï¼ˆå¦‚æ£€æŸ¥pollè¿”å›å€¼æ˜¯å¦nullï¼‰ç­‰é€»è¾‘ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„åœºæ™¯è¦æ±‚ï¼ŒBlockingå®ç°èµ·æ¥ä»£ç æ›´åŠ ç®€å•ã€ç›´è§‚ã€‚</p>\n<p>å‰é¢ä»‹ç»äº†å„ç§é˜Ÿåˆ—å®ç°ï¼Œåœ¨æ—¥å¸¸çš„åº”ç”¨å¼€å‘ä¸­ï¼Œå¦‚ä½•è¿›è¡Œé€‰æ‹©å‘¢ï¼Ÿ</p>\n<p>ä»¥LinkedBlockingQueueã€ArrayBlockingQueueå’ŒSynchronousQueueä¸ºä¾‹ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ï¼Œæ ¹æ®éœ€æ±‚å¯ä»¥ä»å¾ˆå¤šæ–¹é¢è€ƒé‡ï¼š</p>\n<ul>\n<li>\n<p>è€ƒè™‘åº”ç”¨åœºæ™¯ä¸­å¯¹é˜Ÿåˆ—è¾¹ç•Œçš„è¦æ±‚ã€‚ArrayBlockingQueueæ˜¯æœ‰æ˜ç¡®çš„å®¹é‡é™åˆ¶çš„ï¼Œè€ŒLinkedBlockingQueueåˆ™å–å†³äºæˆ‘ä»¬æ˜¯å¦åœ¨åˆ›å»ºæ—¶æŒ‡å®šï¼ŒSynchronousQueueåˆ™å¹²è„†ä¸èƒ½ç¼“å­˜ä»»ä½•å…ƒç´ ã€‚</p>\n</li>\n<li>\n<p>ä»ç©ºé—´åˆ©ç”¨è§’åº¦ï¼Œæ•°ç»„ç»“æ„çš„ArrayBlockingQueueè¦æ¯”LinkedBlockingQueueç´§å‡‘ï¼Œå› ä¸ºå…¶ä¸éœ€è¦åˆ›å»ºæ‰€è°“èŠ‚ç‚¹ï¼Œä½†æ˜¯å…¶åˆå§‹åˆ†é…é˜¶æ®µå°±éœ€è¦ä¸€æ®µè¿ç»­çš„ç©ºé—´ï¼Œæ‰€ä»¥åˆå§‹å†…å­˜éœ€æ±‚æ›´å¤§ã€‚</p>\n</li>\n<li>\n<p>é€šç”¨åœºæ™¯ä¸­ï¼ŒLinkedBlockingQueueçš„ååé‡ä¸€èˆ¬ä¼˜äºArrayBlockingQueueï¼Œå› ä¸ºå®ƒå®ç°äº†æ›´åŠ ç»†ç²’åº¦çš„é”æ“ä½œã€‚</p>\n</li>\n<li>\n<p>ArrayBlockingQueueå®ç°æ¯”è¾ƒç®€å•ï¼Œæ€§èƒ½æ›´å¥½é¢„æµ‹ï¼Œå±äºè¡¨ç°ç¨³å®šçš„â€œé€‰æ‰‹â€ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœæˆ‘ä»¬éœ€è¦å®ç°çš„æ˜¯ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´æ¥åŠ›æ€§ï¼ˆhandoffï¼‰çš„åœºæ™¯ï¼ŒæŒ‰ç…§<a href=\"http://time.geekbang.org/column/article/9373\">ä¸“æ ä¸Šä¸€è®²</a>çš„ä¾‹å­ï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©CountDownLatchï¼Œä½†æ˜¯<a href=\"http://www.baeldung.com/java-synchronous-queue\">SynchronousQueue</a>ä¹Ÿæ˜¯å®Œç¾ç¬¦åˆè¿™ç§åœºæ™¯çš„ï¼Œè€Œä¸”çº¿ç¨‹é—´åè°ƒå’Œæ•°æ®ä¼ è¾“ç»Ÿä¸€èµ·æ¥ï¼Œä»£ç æ›´åŠ è§„èŒƒã€‚</p>\n</li>\n<li>\n<p>å¯èƒ½ä»¤äººæ„å¤–çš„æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™SynchronousQueueçš„æ€§èƒ½è¡¨ç°ï¼Œå¾€å¾€å¤§å¤§è¶…è¿‡å…¶ä»–å®ç°ï¼Œå°¤å…¶æ˜¯åœ¨é˜Ÿåˆ—å…ƒç´ è¾ƒå°çš„åœºæ™¯ã€‚</p>\n</li>\n</ul>\n<p>ä»Šå¤©æˆ‘åˆ†æäº†Javaä¸­è®©äººçœ¼èŠ±ç¼­ä¹±çš„å„ç§çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼Œè¯•å›¾ä»å‡ ä¸ªè§’åº¦ï¼Œè®©æ¯ä¸ªé˜Ÿåˆ—çš„ç‰¹ç‚¹æ›´åŠ æ˜ç¡®ï¼Œè¿›è€Œå¸Œæœ›å‡å°‘ä½ åœ¨æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨æ—¶çš„å›°æ‰°ã€‚</p>\n<h2>ä¸€è¯¾ä¸€ç»ƒ</h2>\n<p>å…³äºä»Šå¤©æˆ‘ä»¬è®¨è®ºçš„é¢˜ç›®ä½ åšåˆ°å¿ƒä¸­æœ‰æ•°äº†å—ï¼Ÿ ä»Šå¤©çš„å†…å®¹ä¾§é‡äºJavaè‡ªèº«çš„è§’åº¦ï¼Œé¢è¯•å®˜ä¹Ÿå¯èƒ½ä»ç®—æ³•çš„è§’åº¦æ¥è€ƒå¯Ÿï¼Œæ‰€ä»¥ä»Šå¤©ç•™ç»™ä½ çš„æ€è€ƒé¢˜æ˜¯ï¼ŒæŒ‡å®šæŸç§ç»“æ„ï¼Œæ¯”å¦‚æ ˆï¼Œç”¨å®ƒå®ç°ä¸€ä¸ªBlockingQueueï¼Œå®ç°æ€è·¯æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p>\n<p>è¯·ä½ åœ¨ç•™è¨€åŒºå†™å†™ä½ å¯¹è¿™ä¸ªé—®é¢˜çš„æ€è€ƒï¼Œæˆ‘ä¼šé€‰å‡ºç»è¿‡è®¤çœŸæ€è€ƒçš„ç•™è¨€ï¼Œé€ç»™ä½ ä¸€ä»½å­¦ä¹ å¥–åŠ±ç¤¼åˆ¸ï¼Œæ¬¢è¿ä½ ä¸æˆ‘ä¸€èµ·è®¨è®ºã€‚</p>\n<p>ä½ çš„æœ‹å‹æ˜¯ä¸æ˜¯ä¹Ÿåœ¨å‡†å¤‡é¢è¯•å‘¢ï¼Ÿä½ å¯ä»¥â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„é¢˜ç›®åˆ†äº«ç»™å¥½å‹ï¼Œæˆ–è®¸ä½ èƒ½å¸®åˆ°ä»–ã€‚</p>\n<p></p>\n","neighbors":{"left":{"article_title":"ç¬¬19è®² | Javaå¹¶å‘åŒ…æä¾›äº†å“ªäº›å¹¶å‘å·¥å…·ç±»ï¼Ÿ","id":9373},"right":{"article_title":"ç¬¬21è®² | Javaå¹¶å‘ç±»åº“æä¾›çš„çº¿ç¨‹æ± æœ‰å“ªå‡ ç§ï¼Ÿ åˆ†åˆ«æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ","id":9712}},"comments":[{"had_liked":false,"id":13310,"user_name":"sunlight001","can_delete":false,"product_type":"c1","uid":1126975,"ip_address":"","ucode":"A72C4274D5DE8A","user_header":"https://static001.geekbang.org/account/avatar/00/11/32/3f/fa4ac035.jpg","comment_is_top":false,"comment_ctime":1529539149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"379486661197","product_id":100006701,"comment_content":"è¿™ä¸ªçœ‹ç€å¾ˆåƒåŠ›å•Šï¼Œéƒ½æ²¡æ¥è§¦è¿‡ğŸ˜‚","like_count":89},{"had_liked":false,"id":24221,"user_name":"ä¸˜å£‘","can_delete":false,"product_type":"c1","uid":1118203,"ip_address":"","ucode":"ECFEDA5A93828D","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/fb/68196d4c.jpg","comment_is_top":false,"comment_ctime":1536850162,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"194810378482","product_id":100006701,"comment_content":"æ ˆæ¥å®ç°blockqueueï¼Œä¸ªäººæ„Ÿè§‰æ¯”è¾ƒå¥½çš„æœ‰<br>æ–¹æ¡ˆä¸€ï¼šæ€»å…±3ä¸ªæ ˆï¼Œå…¶ä¸­2ä¸ªå†™å…¥æ ˆï¼ˆAã€Bï¼‰ï¼Œ1ä¸ªæ¶ˆè´¹æ ˆæ ˆCï¼ˆæ¶ˆè´¹æ•°æ®ï¼‰ï¼Œä½†æ˜¯æœ‰1ä¸ªå†™å…¥æ ˆæ˜¯ç©ºé—²çš„æ ˆï¼ˆBï¼‰ï¼Œéšæ—¶ç­‰å¾…å†™å…¥ï¼Œå½“æ¶ˆè´¹æ ˆ(C)ä¸­æ•°æ®ä¸ºç©ºçš„æ—¶å€™ï¼Œæ¶ˆè´¹çº¿ç¨‹ï¼ˆawaitï¼‰ï¼Œè§¦å‘æ•°æ®è½¬ç§»ï¼ŒåŸå†™å…¥æ ˆ(A)åœæ­¢å†™å…¥ï¼Œï¼Œç”±ç©ºé—²æ ˆï¼ˆBï¼‰æ¥å—å†™å…¥çš„å·¥ä½œï¼ŒåŸå†™å…¥æ ˆ(A)ä¸­çš„æ•°æ®è½¬ç§»åˆ°æ¶ˆè´¹æ ˆï¼ˆCï¼‰ä¸­ï¼Œè½¬ç§»å®Œæˆåç»§ç»­ï¼ˆsignï¼‰ç»§ç»­æ¶ˆè´¹ï¼Œ2ä¸ªå†™å…¥æ ˆï¼Œ1ä¸ªæ¶ˆè´¹æ ˆä¼˜ç‚¹æ˜¯ï¼šä¸ä¼šå µå¡å†™å…¥ï¼Œä½†æ˜¯æ¶ˆè´¹ä¼šæœ‰æš‚åœ<br><br>æ–¹æ¡ˆäºŒï¼šæ€»å…±4ä¸ªæ ˆï¼Œå…¶ä¸­2ä¸ªå†™å…¥æ ˆï¼ˆAã€Bï¼‰ï¼Œ2ä¸ªæ¶ˆè´¹æ ˆï¼ˆCã€Dï¼‰,å…¶ä¸­Bä¸ºç©ºé—²çš„å†™å…¥æ ˆï¼ŒDä¸ºç©ºé—²çš„æ¶ˆè´¹æ ˆï¼Œå½“æ¶ˆè´¹æ ˆï¼ˆCï¼‰ä¸­çš„æ•°æ®ä¸‹é™åˆ°ä¸€å®šçš„æ•°é‡ï¼Œåˆ™è§¦å‘æ•°æ®è½¬ç§»ï¼Œè¿™æ—¶å€™Aæ ˆåœæ­¢å†™å…¥ï¼Œç”±Bæ ˆæ¥å—å†™å…¥æ•°æ®ï¼Œç„¶åå°†Aæ ˆä¸­çš„æ•°æ®è½¬å…¥ç©ºé—²çš„æ¶ˆè´¹æ ˆDï¼Œå½“Cä¸­çš„æ•°æ®æ¶ˆè´¹å®Œäº†åï¼Œåˆ™Cæ ˆè½¬ä¸ºç©ºé—²ï¼ŒDæ ˆè½¬ä¸ºæ¿€æ´»æ¶ˆè´¹çŠ¶æ€ï¼Œå½“Dæ ˆä¸­çš„æ•°æ®æ¶ˆè´¹åˆ°ä¸€å®šæ¯”ä¾‹åï¼Œé‡å¤ä¸Šé¢è¿‡ç¨‹ï¼Œè¯¥æ–¹æ¡ˆä¼˜ç‚¹å³ä¸å µå¡å†™å…¥ï¼Œä¹Ÿä¸ä¼šé€ æˆæ¶ˆè´¹çº¿ç¨‹æš‚åœ<br><br><br>","like_count":46,"discussions":[{"author":{"id":1330065,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/N0NACGUr8dNAbN6BdiagPHBaB0EnyDsI9zWpwJteqTY38apOEnTOA7JkBAQnzYKJBgxu3Q8YMUILwLAB6camn4w/132","nickname":"Swing","note":"","ucode":"55FCA9ECEFBBEB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217396,"discussion_content":"æ²¡çœ‹æ‡‚ã€‚ã€‚ã€‚è®©è§†çº¿ blockingqueueã€‚ã€‚ã€‚å³ é˜Ÿåˆ—æ»¡æ—¶ å µå¡å†™ï¼Œé˜Ÿåˆ—ç©ºæ—¶ å µå¡è¯»ã€‚\n\nä½ è¿™ä¸€ä¸ªæ˜¯å®ç° ä¸å µå¡å†™ï¼Œå µå¡è¯»ï¼›ä¸€ä¸ªæ˜¯éƒ½ ä¸å µå¡ï¼Ÿï¼Ÿ\n\næ€è·¯ä¸é”™ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585554516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117302,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/76/0c07376d.jpg","nickname":"è’™å¥‡å›æ°","note":"","ucode":"2DBCECD149730F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308992,"discussion_content":"è¿™ç§å†—ä½™æ€§çš„è®¾è®¡æ€è·¯ï¼Œç¡®å®ä¸é”™ã€‚\nå’±ä»¬å¼€å‘ä¸­ä½¿ç”¨MQï¼ŒKafKaç­‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œ\nä»å¹¿ä¹‰ä¸Šæ¥è¯´ï¼Œä¹Ÿæ˜¯ä¸€ç§ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å†—ä½™ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601162977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1117302,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/76/0c07376d.jpg","nickname":"è’™å¥‡å›æ°","note":"","ucode":"2DBCECD149730F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384917,"discussion_content":"RocketMQå’ŒKafkaæ˜¯æ¶ˆè´¹è€…-ç”Ÿäº§è€…æ¨¡å¼ï¼ŒRabbitMQæ˜¯é˜Ÿåˆ—æ¨¡å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626792650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":308992,"ip_address":""},"score":384917,"extra":""}]},{"author":{"id":1298380,"avatar":"https://static001.geekbang.org/account/avatar/00/13/cf/cc/8de5007b.jpg","nickname":"å¾æ”¹","note":"","ucode":"82276A584AC602","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50882,"discussion_content":"å¾ˆåˆ‡å®é™…çš„æ€è·¯ã€‚ç‚¹ä¸ªèµï¼å­¦åˆ°äº†ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573782250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37598,"discussion_content":"666666","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571643363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104470,"avatar":"https://static001.geekbang.org/account/avatar/00/10/da/56/004a3240.jpg","nickname":"ilife","note":"","ucode":"25ECBC1BC0F021","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":210855,"discussion_content":"è®©æˆ‘æƒ³åˆ°äº†åˆ†ä»£æ”¶é›†ç®—æ³•çš„GCè¿‡ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584783479,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":45987,"user_name":"å•å€©","can_delete":false,"product_type":"c1","uid":1253300,"ip_address":"","ucode":"545518F3AA9788","user_header":"https://static001.geekbang.org/account/avatar/00/13/1f/b4/33099f97.jpg","comment_is_top":false,"comment_ctime":1543828634,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"74558272666","product_id":100006701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œåœ¨è¯»ArrayBlockingQueueæºç çš„æ—¶å€™ï¼Œå‘ç°å¾ˆå¤šåœ°æ–¹éƒ½æœ‰ final ReentrantLock lock = this.lock; è¿™æ ·çš„è¯­å¥ï¼Œå¤„äºä»€ä¹ˆåŸå› ä¼šå°†ç±»å˜é‡å¤åˆ¶ä¸€ä»½åˆ°å±€éƒ¨å˜é‡ï¼Œç„¶åå†ä½¿ç”¨å‘¢ï¼Ÿ","like_count":18,"discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384919,"discussion_content":"this.lockæ˜¯ç±»çš„æˆå‘˜å˜é‡ï¼Œä¸€èˆ¬éƒ½æ˜¯å­˜åˆ°å †ä¸Šï¼Œè®¿é—®å †ä¸Šçš„å˜é‡ä¼šæ¶‰åŠå†…å­˜åŒæ­¥çš„æ“ä½œ(è¿™ä¸ªå»ºè®®é€šè¿‡ç¼–è¯‘åçš„bytecodeè¿›è¡Œè§‚å¯Ÿ)ï¼Œè€Œå°†å…¶copyåˆ°æ ˆä¸Šï¼Œç„¶åè®¿é—®å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜äº†\n\nåœ¨è®¿é—®å †ä¸Šçš„this.lockæ—¶ï¼Œå¯¹äºå¤šä¸ªCPUï¼Œå¯èƒ½ä¼šå­˜åœ¨cacheå‘½ä¸­çš„é—®é¢˜ï¼Œè¿™æ ·å¿…ç„¶ä¼šå¯¼è‡´å†…å­˜é‡æ–°loadï¼Œè€Œcopyåˆ°æ ˆä¸Šï¼Œåˆ™ç›´æ¥æ˜¯çº¿ç¨‹ç›¸å…³çš„ï¼Œå°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜äº†ã€‚","likes_number":10,"is_delete":false,"is_hidden":false,"ctime":1626793153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1338531,"avatar":"https://static001.geekbang.org/account/avatar/00/14/6c/a3/11df679f.jpg","nickname":"é£å¹è¿‡wu","note":"","ucode":"27E3133A52EA7D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384396,"discussion_content":"å¼€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626566665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":90020,"user_name":"Lighters","can_delete":false,"product_type":"c1","uid":1229471,"ip_address":"","ucode":"AD6307C09DF273","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/9f/f8bc3520.jpg","comment_is_top":false,"comment_ctime":1556368553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48801008809","product_id":100006701,"comment_content":"å¸Œæœ›èƒ½å¤Ÿå¢åŠ ä¸€äº›å…·ä½“çš„ä¸šåŠ¡ä½¿ç”¨åœºæ™¯ï¼Œå¦åˆ™åªæ˜¯å•çº¯çš„åˆ†æï¼Œå¤ªæŠ½è±¡äº†<br>","like_count":12},{"had_liked":false,"id":13331,"user_name":"çŸ³å¤´ç‹®å­","can_delete":false,"product_type":"c1","uid":1118031,"ip_address":"","ucode":"3BABB93E552022","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/4f/c75c4889.jpg","comment_is_top":false,"comment_ctime":1529542968,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48774183224","product_id":100006701,"comment_content":"å®ç°è¯¾åé¢˜è¿‡ç¨‹ä¸­æŠŠæ¡ä»¥ä¸‹å‡ ä¸ªç»´åº¦ï¼Œ<br>1ï¼Œæ•°æ®æ“ä½œçš„é”ç²’åº¦ã€‚<br>2ï¼Œè®¡æ•°ï¼Œéå†æ–¹å¼ã€‚<br>3ï¼Œæ•°æ®ç»“æ„ç©ºï¼Œæ»¡æ—¶çº¿ç¨‹çš„ç­‰å¾…æ–¹å¼ï¼Œæœ‰é”æˆ–æ— é”æ–¹å¼ã€‚<br>4ï¼Œä½¿ç”¨ç¦»æ•£è¿˜æ˜¯è¿ç»­çš„å­˜å‚¨ç»“æ„ã€‚","like_count":12},{"had_liked":false,"id":13424,"user_name":"crazyone","can_delete":false,"product_type":"c1","uid":1115042,"ip_address":"","ucode":"705E34642E41F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/03/a2/ceb37046.jpg","comment_is_top":false,"comment_ctime":1529623732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31594394804","product_id":100006701,"comment_content":"ä»ä¸Šé¢è¿™äº›è§’åº¦ï¼Œèƒ½å¤Ÿç†è§£ ConcurrentLinkedDeque å’Œ LinkedBlockingQueue çš„ä¸»è¦åŠŸèƒ½åŒºåˆ«ã€‚  è¿™æ®µåº”è¯¥æ˜¯ &quot;ConcurrentLinkedDeque å’Œ LinkedBlockingDeque çš„ä¸»è¦åŠŸèƒ½åŒºåˆ«&quot;","like_count":8},{"had_liked":false,"id":13418,"user_name":"çŒ•çŒ´æ¡ƒ î„‡ç››å“¥","can_delete":false,"product_type":"c1","uid":1102535,"ip_address":"","ucode":"D652436CB1E506","user_header":"https://static001.geekbang.org/account/avatar/00/10/d2/c7/14d235bb.jpg","comment_is_top":false,"comment_ctime":1529601811,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"31594372883","product_id":100006701,"comment_content":"{<br>    &quot;test&quot;:[<br>        [<br>            89,<br>            90,<br>            [<br>                [<br>                    1093,<br>                    709<br>                ],<br>                [<br>                    1056,<br>                    709<br>                ]<br>            ]<br>        ]<br>    ]<br>}<br><br>æµ‹è¯•é¢˜ï¼šè¿™ä¸ªjsonç”¨javaå¯¹è±¡æ€ä¹ˆè¡¨ç¤ºï¼Ÿ","like_count":8,"discussions":[{"author":{"id":2289255,"avatar":"https://static001.geekbang.org/account/avatar/00/22/ee/67/e97fea7d.jpg","nickname":"[ThumbsUp]","note":"","ucode":"428818387DE5F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":325750,"discussion_content":"JSONObject å¥— JSONArray, JSONArrayåˆå¤šé‡åµŒå¥—ï¼Œå¥—å¨ƒå‘¢...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605423181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":151775,"discussion_content":"ç››å“¥ä½ å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579885065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13970,"user_name":"æ— å‘¢å¯ç§°","can_delete":false,"product_type":"c1","uid":1079979,"ip_address":"","ucode":"0AAB6A3CA6685B","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/ab/342ec0ca.jpg","comment_is_top":false,"comment_ctime":1530090087,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"14414991975","product_id":100006701,"comment_content":"@Jerryé“¶é“¶ã€‚ç”¨ä¸¤ä¸ªæ ˆå¯ä»¥å®ç°fifoçš„é˜Ÿåˆ—<br><br>","like_count":3,"discussions":[{"author":{"id":1368038,"avatar":"https://static001.geekbang.org/account/avatar/00/14/df/e6/bd1b3c0b.jpg","nickname":"Jesse","note":"","ucode":"727CA882B84DA0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219835,"discussion_content":"å¤§ç¥ï¼Œèƒ½å¦è¯¦ç»†è¯´æ˜ä¸‹ï¼Œä¸¤ä¸ªæ ˆå¦‚ä½•å®ç°fifoçš„é˜Ÿåˆ—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585816031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1658079,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/df/09d0eb0d.jpg","nickname":"å¸ƒè±å®‰æ‰˜","note":"","ucode":"D54973C93B6DE8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1368038,"avatar":"https://static001.geekbang.org/account/avatar/00/14/df/e6/bd1b3c0b.jpg","nickname":"Jesse","note":"","ucode":"727CA882B84DA0","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":265082,"discussion_content":"Aã€Bä¸¤ä¸ªæ ˆï¼Œå…ˆå†™Aæ ˆï¼ŒAæ ˆå†™æ»¡ä¹‹åå‡ºæ ˆå‹åˆ°Bæ ˆï¼ŒBæ ˆå†å‡ºæ ˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1589373223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":219835,"ip_address":""},"score":265082,"extra":""},{"author":{"id":1148845,"avatar":"https://static001.geekbang.org/account/avatar/00/11/87/ad/50a85a04.jpg","nickname":"hao","note":"","ucode":"997F2B57E2F556","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1658079,"avatar":"https://static001.geekbang.org/account/avatar/00/19/4c/df/09d0eb0d.jpg","nickname":"å¸ƒè±å®‰æ‰˜","note":"","ucode":"D54973C93B6DE8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323700,"discussion_content":"æœ‰é“ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604983151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":265082,"ip_address":""},"score":323700,"extra":""}]}]},{"had_liked":false,"id":13332,"user_name":"çŸ³å¤´ç‹®å­","can_delete":false,"product_type":"c1","uid":1118031,"ip_address":"","ucode":"3BABB93E552022","user_header":"https://static001.geekbang.org/account/avatar/00/11/0f/4f/c75c4889.jpg","comment_is_top":false,"comment_ctime":1529542969,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14414444857","product_id":100006701,"comment_content":"å®ç°è¯¾åé¢˜è¿‡ç¨‹ä¸­æŠŠæ¡ä»¥ä¸‹å‡ ä¸ªç»´åº¦ï¼Œ<br>1ï¼Œæ•°æ®æ“ä½œçš„é”ç²’åº¦ã€‚<br>2ï¼Œè®¡æ•°ï¼Œéå†æ–¹å¼ã€‚<br>3ï¼Œæ•°æ®ç»“æ„ç©ºï¼Œæ»¡æ—¶çº¿ç¨‹çš„ç­‰å¾…æ–¹å¼ï¼Œæœ‰é”æˆ–æ— é”æ–¹å¼ã€‚<br>4ï¼Œä½¿ç”¨ç¦»æ•£è¿˜æ˜¯è¿ç»­çš„å­˜å‚¨ç»“æ„ã€‚","like_count":3},{"had_liked":false,"id":18573,"user_name":"é…±äº†ä¸ªæ²¹","can_delete":false,"product_type":"c1","uid":1059627,"ip_address":"","ucode":"5A13CA4EAACB81","user_header":"https://static001.geekbang.org/account/avatar/00/10/2b/2b/bebf6eed.jpg","comment_is_top":false,"comment_ctime":1533461393,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10123395985","product_id":100006701,"comment_content":"é˜Ÿåˆ—çš„ä¸€ä¸ªé—®é¢˜æ˜¯ä¸èƒ½æŒä¹…åŒ–ã€ä¸èƒ½åšåˆ°åˆ†å¸ƒå¼ï¼Œæœ‰æ—¶å€™è€ƒè™‘åˆ°ç³»ç»Ÿå¯é æ€§ï¼Œä½¿ç”¨çš„æœºä¼šä¸å¤šã€‚æ¨è€å¸ˆå¯ä»¥ç»™ä¸€äº›ä½¿ç”¨é˜Ÿåˆ—çš„ä¾‹å­å—ï¼Ÿ","like_count":2},{"had_liked":false,"id":16118,"user_name":"æ±‰å½¬","can_delete":false,"product_type":"c1","uid":1122623,"ip_address":"","ucode":"088891C1D6C661","user_header":"https://static001.geekbang.org/account/avatar/00/11/21/3f/409aa5d2.jpg","comment_is_top":false,"comment_ctime":1531790386,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10121724978","product_id":100006701,"comment_content":"ç”¨æ ˆå®ç°BlockingQueueï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼šæ ˆæ˜¯LIFOï¼ŒBlockingQueueæ˜¯FIFOï¼Œå› æ­¤éœ€è¦ä¸¤ä¸ªæ ˆã€‚takeæ—¶å…ˆæŠŠæ ˆAå…¨éƒ¨å…¥æ ˆåˆ°æ ˆBï¼Œç„¶åæ ˆBå‡ºæ ˆå¾—åˆ°ç›®æ ‡å…ƒç´ ï¼›putæ—¶æŠŠæ ˆBå…¨éƒ¨å…¥æ ˆåˆ°æ ˆAï¼Œç„¶åæ ˆAå†å…¥æ ˆç›®æ ‡å…ƒç´ ã€‚ç›¸å½“äºå€’åºä¸€ä¸‹ã€‚<br><br>ä¸çŸ¥é“ç†è§£å¯¹ä¸å¯¹ï¼Œè¯·è€å¸ˆæŒ‡å‡ºã€‚","like_count":3},{"had_liked":false,"id":14676,"user_name":"çˆ±æ–°è§‰ç½—è€æµæ°“","can_delete":false,"product_type":"c1","uid":1005661,"ip_address":"","ucode":"B13AC4DA358C15","user_header":"https://static001.geekbang.org/account/avatar/00/0f/58/5d/8de7f8dc.jpg","comment_is_top":false,"comment_ctime":1530591964,"is_pvip":false,"replies":[{"id":"4981","content":"è°¢è°¢æŒ‡å‡ºï¼Œæˆ‘æŸ¥æŸ¥æ˜¯ä¸æ˜¯æˆ‘è®°åäº†","user_name":"ä½œè€…å›å¤","comment_id":14676,"uid":"1009360","ip_address":"","utype":1,"ctime":1530664819,"user_name_real":"æ¨æ™“å³°"}],"discussion_count":2,"race_medal":0,"score":"10120526556","product_id":100006701,"comment_content":"æ¨è€å¸ˆï¼Œâ€œä¸å¼±ä¸€è‡´æ€§å¯¹åº”çš„ï¼Œå°±æ˜¯æˆ‘ä»‹ç»è¿‡çš„åŒæ­¥å®¹å™¨å¸¸è§çš„è¡Œä¸ºâ€œfast-failâ€ï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹åˆ°å®¹å™¨åœ¨éå†è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¿®æ”¹ï¼Œåˆ™æŠ›å‡º ConcurrentModificationExceptionï¼Œä¸å†ç»§ç»­éå†ã€‚â€ <br>è¿™ä¸€æ®µè½é‡Œï¼Œå¿«é€Ÿå¤±è´¥çš„è‹±æ–‡åœ¨docä¸Šæ˜¯â€œfail-fastâ€ï¼Œåœ¨ArrayListæºç ä¸­æ–‡æ¡£å¯ä»¥æœåˆ°ã€‚<br>è¿˜æœ‰ï¼ŒåŒæ­¥å®¹å™¨ä¸åº”è¯¥æ˜¯â€œfail-safeâ€å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420088,"discussion_content":"è°¢è°¢æŒ‡å‡ºï¼Œæˆ‘æŸ¥æŸ¥æ˜¯ä¸æ˜¯æˆ‘è®°åäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530664819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1500880,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKvNozkiaiao1I945xyUGC0vXZSnibImBPbf7CtibqKoGDsbmZGnia62zibv4s3grqtVllO82tILEJ1Dh2w/132","nickname":"æƒŠè›°","note":"","ucode":"8A03CC80666787","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299314,"discussion_content":"æ˜¯è®°åäº†ï¼Œ åŒæ­¥å®¹æ˜“å› ä¸ºä¼šåŠ é”æ“ä½œï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ fail-safeçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597655554,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265296,"user_name":"jiahua","can_delete":false,"product_type":"c1","uid":1154783,"ip_address":"","ucode":"A2B85DA49DC69D","user_header":"https://static001.geekbang.org/account/avatar/00/11/9e/df/ac5c60b5.jpg","comment_is_top":false,"comment_ctime":1606840448,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5901807744","product_id":100006701,"comment_content":"ä¸¤ä¸ªæ ˆAå’ŒB, ä¸€ç›´å‘Aä¸­å†™ï¼Œä»Bä¸­è¯»ï¼ŒBä¸­æ²¡æœ‰æ—¶ï¼ŒæŠŠå½“å‰Aä¸­çš„æ”¾åˆ°Bä¸­","like_count":1},{"had_liked":false,"id":96230,"user_name":"æ‹¯æ•‘åœ°çƒå¥½ç´¯","can_delete":false,"product_type":"c1","uid":1339022,"ip_address":"","ucode":"7643439601EF4C","user_header":"https://static001.geekbang.org/account/avatar/00/14/6e/8e/5d309a85.jpg","comment_is_top":false,"comment_ctime":1558361093,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853328389","product_id":100006701,"comment_content":"ä»å‡ ä¸ªé—®é¢˜æ¥å­¦ä¹ æ–°çš„æ¡†æ¶æˆ–å·¥å…·ï¼š<br>1.ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿå¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ<br>2.jdkå†…éƒ¨æˆ–ç¬¬ä¸‰æ–¹æ¡†æ¶åœ¨ä»€ä¹ˆåœºæ™¯ä¸­å¦‚ä½•è¿ç”¨ï¼Ÿ<br>3.æœ‰å“ªå‡ ç§ç±»ä¼¼çš„å®ç°æˆ–å·¥å…·ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä½•åŒºåˆ«ï¼Ÿåœ¨ç»“æ„å±‚æ¬¡ä¸Šæœ‰ä½•è”ç³»ï¼Ÿ<br>4.ä»æºç ä¸Šçœ‹å…³é”®ä»£ç æœ‰å“ªå‡ ä¸ªåœ°æ–¹ï¼Ÿ","like_count":2},{"had_liked":false,"id":49839,"user_name":"å—åŒ—å°‘å¿","can_delete":false,"product_type":"c1","uid":1018958,"ip_address":"","ucode":"DFCC59F2BBD8CE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/4e/b81969fa.jpg","comment_is_top":false,"comment_ctime":1544778041,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5839745337","product_id":100006701,"comment_content":"æ¨è€å¸ˆ,ä½ å¥½,æœ€è¿‘æˆ‘debugè¿‡ConcurrentLinkedQueueçš„æºç ,ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™,ä¸ºä»€ä¹ˆheadæŒ‡å‘æ·»åŠ çš„å…ƒç´ ,è€ŒtailæŒ‡å‘è‡ªå·±,å§‹ç»ˆæä¸æ˜ç™½,ç»è¿‡p.casNext(null, newNode)æ“ä½œä¹‹å,è¿™ä¸­é—´çš„å˜åŒ–åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹?æ‚¨èƒ½è§£ç­”ä¸‹å—?æœ›æŒ‡ç‚¹.æˆ‘çš„å¾®ä¿¡å·:LEE794112629","like_count":1,"discussions":[{"author":{"id":2837603,"avatar":"","nickname":"Geek_18e6f5","note":"","ucode":"3700BC57DD6FF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413165,"discussion_content":"å…¶å®è¿™ä¸ªæ€è·¯å¾ˆç®€å•ï¼Œä½ ä¸å¯èƒ½è®©tailå’Œnextéƒ½åŸå­çš„ä¸€èµ·ä¿®æ”¹ä¸ºæ–°æ·»åŠ çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä»–å¹²è„†å°±ä¸è®©tailä¸€ç›´éƒ½æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œåªè¦nextæ˜¯å¯¹çš„å°±è¡Œäº†ï¼Œç„¶ååœ¨é€‚å½“çš„æ—¶å€™æŠŠtailæ›´æ–°ä¸€ä¸‹ï¼Œé˜²æ­¢tailè½åå¤ªå¤šã€‚ç„¶åä½ è¦æ‰¾lastnoåªè¦æ²¿ç€tailä¸€ç›´æ‰¾é‚£ä¸ªnextä¸ºç©ºçš„èŠ‚ç‚¹å°±æ˜¯å°¾èŠ‚ç‚¹äº†ï¼Œè‡³äºä¸ºå•¥ä¸æ¯æ¬¡éƒ½è¯»tailè€Œè¦æä¸€ä¸ªt(é”šç‚¹)å‡ºæ¥ï¼Œæ˜¯å› ä¸ºtailæ˜¯ä¸€ä¸ªvolatileå˜é‡ï¼Œè€Œä¸”tailæœ¬èº«å°±ä¸å‡†ç¡®ï¼Œåªåœ¨å¿…è¦çš„æ—¶å€™è¯»ä¸€ä¸‹tailæé«˜è¯»æ€§èƒ½ï¼Œè‡³äºä¸Šé¢è¯´çš„é€‚å½“æ—¶å€™ï¼Œå¿…è¦æ—¶å€™ï¼Œå°±æ˜¯ä»–çš„é‚£ä¸ªæ¾å¼›åº¦(å°±æ˜¯2)ã€‚å½“ç„¶ä¹Ÿä¸æ˜¯è¯´tailç¦»lastnodeä¸€å®šä¸è¶…è¿‡2ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¼šè¶…è¿‡2çš„ã€‚å‡ºé˜Ÿä¹Ÿæ˜¯åŒä¸€ä¸ªæ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636388179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37943,"user_name":"æ­å·","can_delete":false,"product_type":"c1","uid":1121604,"ip_address":"","ucode":"2E5E330FAB24FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIyqjqjTlaiavQb1I7d5au4A3mojticTXgBEu6picAv3qS7f1jhdq4bSS8mJpic1zWNhxaQWNPfYkQF0w/132","comment_is_top":false,"comment_ctime":1541819888,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5836787184","product_id":100006701,"comment_content":"æ¨è€å¸ˆä½ å¥½ï¼Œæˆ‘ç¢°åˆ°ä¸ªé—®é¢˜ï¼š 200ä¸ªçº¿ç¨‹æ±  é˜»å¡è¯»takeï¼ˆï¼‰linkblockingqueueé˜Ÿåˆ—ï¼Œå¶å°”ä¼šå‘ç°çº¿ç¨‹æ± ä¸­çš„é˜»å¡çº¿ç¨‹cpuçªé«˜ã€‚jstackçœ‹äº†æœ‰å¾ˆå¤šçš„lockã€‚æ€€ç–‘æ˜¯æ± ç¨‹ç¦»å¼€çº¿ç¨‹æ± å»å¹²åˆ«çš„æ´»ï¼Œå¹²äº†ä¸€åŠåˆå›åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå‡ºç°æ­»é”è¡¨ç°cpué«˜ã€‚ä¸çŸ¥é“æ˜¯ä»€ä¹ˆè¿™ä¸ªåŸå› ï¼Œä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Ÿ","like_count":1},{"had_liked":false,"id":13488,"user_name":"Jerryé“¶é“¶","can_delete":false,"product_type":"c1","uid":1008404,"ip_address":"","ucode":"80DA1172A2360A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/14/06eff9a4.jpg","comment_is_top":false,"comment_ctime":1529673015,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5824640311","product_id":100006701,"comment_content":"ç”¨æ ˆæ¥å®ç°BlockingQueueï¼Œæ¢å¥è¯æ˜¯è¯´ï¼Œç”¨å…ˆè¿›åå‡ºçš„æ•°æ®ç»“æ„æ¥å®ç°å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œæ€ä¹ˆæ„Ÿè§‰å¬èµ·æ¥ä¸é‚£ä¹ˆå¯¹åŠ²å‘¢ï¼Ÿè¯·æŒ‡ç‚¹","like_count":1,"discussions":[{"author":{"id":1088710,"avatar":"https://static001.geekbang.org/account/avatar/00/10/9c/c6/05a6798f.jpg","nickname":"è‹—","note":"","ucode":"5ECCC6C855E541","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":306790,"discussion_content":"åº”è¯¥è¿˜è€ƒäº†é€‚é…å™¨æ¨¡å¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600390455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13371,"user_name":"ç°é£ç°çŒªä¸ä¼šç°é£.çƒŸç­","can_delete":false,"product_type":"c1","uid":1127314,"ip_address":"","ucode":"FF9FB4C902D1F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/92/99530cee.jpg","comment_is_top":false,"comment_ctime":1529562586,"is_pvip":false,"replies":[{"id":"4509","content":"æ‰€è°“ç»“æŸæ˜¯æŒ‡terminatedï¼Ÿæ­£å¸¸çš„çº¿ç¨‹æ± ç§»é™¤å·¥ä½œçº¿ç¨‹ï¼Œè¦ä¹ˆçº¿ç¨‹æ„å¤–é€€å‡ºï¼Œæ¯”å¦‚ä»»åŠ¡æŠ›å¼‚å¸¸ï¼Œè¦ä¹ˆçº¿ç¨‹é—²ç½®ï¼Œåˆè§„å®šäº†é—²ç½®æ—¶é—´ï¼›çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ˜¯æŠŠé¢å¤–å°è£…çš„ï¼Œæœ¬æ¥ä¸‹ç« å†™äº†ï¼Œå†…å®¹ç¯‡å¹…è¶…æ ‡ç§»åˆ°åé¢äº†ï¼Œæ…¢æ…¢æ¥ï¼›æœ‰ï¼Œå»ºè®®å­¦ä¼šçœ‹æ–‡æ¡£ï¼Œè‡ªå·±æ‰¾ç­”æ¡ˆ","user_name":"ä½œè€…å›å¤","comment_id":13371,"uid":"1009360","ip_address":"","utype":1,"ctime":1529631556,"user_name_real":"æ¨æ™“å³°"}],"discussion_count":1,"race_medal":0,"score":"5824529882","product_id":100006701,"comment_content":"è€å¸ˆ çº¿ç¨‹æ± ä¸­å¦‚æœçº¿ç¨‹å·²ç»è¿è¡Œç»“æŸåˆ™åˆ é™¤è¯¥çº¿ç¨‹ã€‚å¦‚ä½•åˆ¤æ–­çº¿ç¨‹å·²ç»è¿è¡Œç»“æŸäº†å‘¢ï¼Ÿæºç ä¸­æˆ‘çœ‹è§æŒ‰ç…§çº¿ç¨‹çš„çŠ¶æ€ï¼Œæˆ‘ä¸æ¸…æ¥šè¿™äº›çŠ¶æ€å€¼å“ªæ¥çš„ã€‚javaä»£ç æœ‰åˆ¤æ–­çº¿ç¨‹çŠ¶æ€çš„æ–¹æ³•å—ï¼Ÿè°¢è°¢è€å¸ˆ","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419630,"discussion_content":"æ‰€è°“ç»“æŸæ˜¯æŒ‡terminatedï¼Ÿæ­£å¸¸çš„çº¿ç¨‹æ± ç§»é™¤å·¥ä½œçº¿ç¨‹ï¼Œè¦ä¹ˆçº¿ç¨‹æ„å¤–é€€å‡ºï¼Œæ¯”å¦‚ä»»åŠ¡æŠ›å¼‚å¸¸ï¼Œè¦ä¹ˆçº¿ç¨‹é—²ç½®ï¼Œåˆè§„å®šäº†é—²ç½®æ—¶é—´ï¼›çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ˜¯æŠŠé¢å¤–å°è£…çš„ï¼Œæœ¬æ¥ä¸‹ç« å†™äº†ï¼Œå†…å®¹ç¯‡å¹…è¶…æ ‡ç§»åˆ°åé¢äº†ï¼Œæ…¢æ…¢æ¥ï¼›æœ‰ï¼Œå»ºè®®å­¦ä¼šçœ‹æ–‡æ¡£ï¼Œè‡ªå·±æ‰¾ç­”æ¡ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529631556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296881,"user_name":"Geek_6ce7fa","can_delete":false,"product_type":"c1","uid":2290464,"ip_address":"","ucode":"D4F334284E4482","user_header":"","comment_is_top":false,"comment_ctime":1623209481,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1623209481","product_id":100006701,"comment_content":"PriorityBlockingQueueæ˜¯æœ‰ç•Œé˜Ÿåˆ—å§","like_count":0,"discussions":[{"author":{"id":2420294,"avatar":"https://static001.geekbang.org/account/avatar/00/24/ee/46/7d65ae37.jpg","nickname":"æœ¨å‡ ä¸¶","note":"","ucode":"FFDB958DA64F8C","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391002,"discussion_content":"æ— ç•Œçš„ï¼Œåªèƒ½è®¾ç½®åˆå§‹é•¿åº¦ï¼Œä¼šä¸æ–­æ‰©å®¹ï¼Œæ‰©å®¹ä¸Šé™æ˜¯MAX_VALUE-8ï¼Œç›¸å½“äºæ— ç•Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630225266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248697,"user_name":"Geek_154f14","can_delete":false,"product_type":"c1","uid":2181453,"ip_address":"","ucode":"F01FF696364E73","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAnje12Sebss1BwgLF48Wk57zaMtMSWdStbC6R7l0ssCev0ddLPYd2QqGXBmpfNL89NtahYKVkVg/132","comment_is_top":false,"comment_ctime":1600265436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600265436","product_id":100006701,"comment_content":"ä¸€èˆ¬æƒ…å†µä¸‹ç”¨linkedç¡®å®å¥½ç‚¹ï¼Œä»–æœ‰ä¿©æŠŠé”ï¼Œç²’åº¦ç»†æ•ˆç‡æ›´é«˜<br>","like_count":0},{"had_liked":false,"id":230245,"user_name":"å¤§æˆå°Šè€…","can_delete":false,"product_type":"c1","uid":1783367,"ip_address":"","ucode":"42473322052B11","user_header":"https://static001.geekbang.org/account/avatar/00/1b/36/47/8e80082c.jpg","comment_is_top":false,"comment_ctime":1593326672,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1593326672","product_id":100006701,"comment_content":"æŒ‡å®šæŸç§ç»“æ„ï¼Œæ¯”å¦‚æ ˆï¼Œç”¨å®ƒå®ç°ä¸€ä¸ª BlockingQueueï¼Œå®ç°æ€è·¯æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ<br>ç­”ï¼šä¸èƒ½å®ç°ã€‚å› ä¸ºæ ˆéµå¾ªçš„æ˜¯å…ˆè¿›åå‡ºï¼Œä½ ä¸Šé¢è¯´çš„ä¸ç®¡æ˜¯ArrayBlockingQueueè¿˜æ˜¯LinkedBlockingQueueï¼Œéƒ½æ˜¯æ”¯æŒå…ˆè¿›å…ˆå‡ºçš„ï¼Œæ ˆè¿™ä¸ªæ•°æ®ç»“æ„å°±ä¸æ”¯æŒå…ˆè¿›å…ˆå‡ºã€‚","like_count":0,"discussions":[{"author":{"id":1297112,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ca/d8/b109ed85.jpg","nickname":"Jack","note":"","ucode":"F3863DAEF449D5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365404,"discussion_content":"ç”¨ä¸¤ä¸ªæ ˆå°±å¯ä»¥äº†ï¼Œleetcode easyé¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617796013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224395,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1591365958,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591365958","product_id":100006701,"comment_content":"çœŸå¥½","like_count":1,"discussions":[{"author":{"id":2238635,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/ab/b8905658.jpg","nickname":"AsYouWish99","note":"","ucode":"A5CE38DAD56115","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579271,"discussion_content":"ç¡®å®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657273178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196609,"user_name":"ilovealt","can_delete":false,"product_type":"c1","uid":1113180,"ip_address":"","ucode":"35CB4FD836135B","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/5c/a3d42cdb.jpg","comment_is_top":false,"comment_ctime":1585297151,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585297151","product_id":100006701,"comment_content":"è¿™ä¸ªæœ‰ç‚¹åƒåŠ›ï¼Œä¸æ‡‚çš„å¾ˆå¤šï¼Œçœ‹æ¥æˆ‘æˆ‘è¿˜æ˜¯ä¸€ä¸ªèœé¸Ÿå•Šã€‚","like_count":0,"discussions":[{"author":{"id":2238635,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/ab/b8905658.jpg","nickname":"AsYouWish99","note":"","ucode":"A5CE38DAD56115","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579272,"discussion_content":"æ…¢æ…¢æ¥å‘—\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657273194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192199,"user_name":"ä»Šå¤©","can_delete":false,"product_type":"c1","uid":1532354,"ip_address":"","ucode":"F8577A2BABCD1F","user_header":"https://static001.geekbang.org/account/avatar/00/17/61/c2/94c1d4c9.jpg","comment_is_top":false,"comment_ctime":1584842950,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584842950","product_id":100006701,"comment_content":"å¹¶å‘éƒ½æœ‰æ¶ˆè€—ï¼Œå°±æ˜¯çœ‹å¦‚ä½•æ›´é€‚åˆçš„é™ä½","like_count":0},{"had_liked":false,"id":175346,"user_name":"Geek_8c5f9c","can_delete":false,"product_type":"c1","uid":1596047,"ip_address":"","ucode":"70CD441EAF490F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIlZ9AObDSXrfSEibY94uyQvMQ4tOvbb7iaQH9H7QQ6ibNaqFKUGq1TboaFpBSLuP0MCcSXvmqHNg0IA/132","comment_is_top":false,"comment_ctime":1580663437,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1580663437","product_id":100006701,"comment_content":"fail-fastä¸æ˜¯åŒæ­¥å®¹å™¨çš„è¡Œä¸ºï¼Œ fail-safeæ‰æ˜¯ã€‚","like_count":1,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":159586,"discussion_content":"å»ºè®®å†™æ®µä»£ç éªŒè¯ä¸€ä¸‹ï¼Œfail-fastç®€å•è¯´å°±æ˜¯ï¼šè¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå®¹å™¨å‘ç”Ÿç»“æ„å˜åŒ–ï¼Œä¾‹å¦‚æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œè¿­ä»£ä¼šæŠ›å‡ºConcurrentModificationExceptionã€‚åŒæ­¥å®¹å™¨è¡Œä¸ºå°±æ˜¯å¦‚æ­¤ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1580710918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2238635,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/ab/b8905658.jpg","nickname":"AsYouWish99","note":"","ucode":"A5CE38DAD56115","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579273,"discussion_content":"ç¡®å®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657273216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173333,"user_name":"Comdotwang","can_delete":false,"product_type":"c1","uid":1180791,"ip_address":"","ucode":"505C65CB8E0B92","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/77/b0dbd680.jpg","comment_is_top":false,"comment_ctime":1579506196,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579506196","product_id":100006701,"comment_content":"è€å¸ˆ æ‚¨å¥½ã€‚ æˆ‘çœ‹åˆ°SynchronousQueue ä¸èƒ½ç¼“å­˜ä»»ä½•å…ƒç´ ã€‚ ä½†æ˜¯æ®æˆ‘æ‰€çŸ¥ï¼ŒSynchronousQueue takeå’Œputæ“ä½œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªSNode æˆ– QNodeã€‚æ”¾å…¥æ ˆæˆ–é˜Ÿåˆ—ä¸­ã€‚è¿™äº›ä¸ç®—æ˜¯ç¼“å­˜ä¹ˆã€‚ æˆ‘æœ‰äº›ç–‘æƒ‘ã€‚","like_count":0},{"had_liked":false,"id":168489,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1578098501,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578098501","product_id":100006701,"comment_content":"20 ConcurrentLinkedQueueå’ŒLinkedBlockingQueueæœ‰ä»€ä¹ˆåŒºåˆ« 1 Java.util.concurrentåŒ…ä¸‹é¢çš„æ‰€æœ‰å®¹å™¨éƒ½å«å¹¶å‘å®¹å™¨ï¼Œconcurrentå¼€å¤´çš„å«å¹¶å‘å®¹å™¨ï¼ŒconcurrentåŸºäºlock-freeæ¨¡å¼ï¼Œåœ¨å¤šçº¿ç¨‹åœºæ™¯ï¼Œèƒ½æä¾›è¾ƒå¤§çš„ååé‡ ï¼ŒLinkedBlockingæ˜¯åŸºäºé”ï¼Œæä¾›äº†BlockingQueueçš„ç­‰å¾…æ–¹æ³• 2 çº¿ç¨‹å®‰å…¨å®¹å™¨å¤§æ¦‚å¯ä»¥åˆ†ä¸ºconcurrent*ï¼ŒCopyOnWriteå’ŒBlockingç­‰ä¸‰ç±»ï¼ŒCopyOnWriteéœ€è¦æ‹·è´ä¸€ä»½æ•°æ®ï¼Œåœ¨æ‹·è´æ•°æ®ä¸Šä¿®æ”¹ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œå¸¸è§çš„å®¹å™¨ï¼Œæœ‰æ¯”è¾ƒå¼ºçš„ä¸€è‡´æ€§ï¼Œå¦‚æœéå†è¿‡ç¨‹å‘ç”Ÿä¿®æ”¹ï¼Œä¼šæŠ›å‡ºConcurrentModificationExceptionï¼Œè€ŒConcurrent*å®¹å™¨å¯ä»¥ç»§ç»­éå†ã€‚3 BlockingåŒæ­¥å®¹å™¨ï¼Œéœ€è¦ç­‰å¾…ï¼Œä»¥ä»£ç ä¸ºä¾‹ ç”¨BlockingQueueå»å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…ï¼Œä¸ç”¨è‡ªå·±æ‰‹å·¥å»å®ç°è½®è¯¢ï¼Œæ¡ä»¶åˆ¤æ–­ç­‰é€»è¾‘ã€‚","like_count":1},{"had_liked":false,"id":155015,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1574627953,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574627953","product_id":100006701,"comment_content":"å¹¶å‘ä¸­çš„ä¸€è‡´æ€§æ˜¯æœ‰ä»£ä»·çš„ï¼Œå¦‚ä½•æ”¯ä»˜è¿™ä¸ªä»£ä»·å»¶ä¼¸å‡ºä¸åŒçš„å®ç°ã€‚ConcurrentLinkedQueue å°±æ˜¯æä¾›è¾ƒé«˜çš„ååç‡è€Œç‰ºç‰²ä¸€éƒ¨åˆ†ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯éå†çš„æ—¶å€™ï¼Œæ•°æ®è¢«ä¿®æ”¹äº†è€Œä¸æŸ¥ï¼Œsizeä¹Ÿæ²¡æœ‰100%æ­£ç¡®ã€‚è¦è·å¾—è¿™äº›ä¿è¯ï¼Œå°±è¦åŠ é”ç‰ºç‰²ååé‡ LinkedBlockingQueue å°±æ˜¯è¿™ç§é«˜å‡†ç¡®åº¦è€Œç›¸å¯¹è¾ƒä½ååé‡çš„è§£å†³æ–¹æ¡ˆã€‚åŠ å…¥å…¶ä»–ç»´åº¦ä¾‹å¦‚æ˜¯å¦æ— é™ï¼ŒJavaè¿˜æœ‰å…¶ä»–é€‰æ‹©ã€‚","like_count":0},{"had_liked":false,"id":135871,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1569291066,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569291066","product_id":100006701,"comment_content":"æ–‡ç« ä¸­å…³äºç”Ÿäº§è€…æ¶ˆè´¹è€…çš„ç¤ºä¾‹ä»£ç è¿è¡Œä¸èƒ½ä½“ç°å‡ºblocking queueçš„ç‰¹æ€§ï¼Œå› ä¸ºè¾“å‡ºè¯­å¥å’Œæ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œæ‰€ä»¥è¾“å‡ºé¡ºåºä¼šæœ‰é—®é¢˜","like_count":0},{"had_liked":false,"id":120674,"user_name":"wengyifa","can_delete":false,"product_type":"c1","uid":1158422,"ip_address":"","ucode":"C41E3894694D2B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/5fibB9p7PfndN4kU0lhHv4TyKRsibISvaxGdI4yviao0WcDS7rmEP9vqiaMiclxrs2GQJlRcCyZxTkRibK5r4uWQQBhg/132","comment_is_top":false,"comment_ctime":1564971893,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1564971893","product_id":100006701,"comment_content":"if (c == capacity)<br>            signalNotFull();<br>æœ‰ç‚¹çœ‹ä¸æ‡‚ take æ–¹æ³•ä¸­æœ€åä¸€æ®µçš„å†…å®¹ï¼Œä¸ºä½•æ˜¯åœ¨å®é™…å¤§å°ç­‰äºå®¹é‡æ—¶ï¼Œæ‰å»å”¤é†’æ·»åŠ çº¿ç¨‹ï¼Œè€Œä¸æ˜¯å®é™…å¤§å°å°äºå®¹é‡å°±å»å”¤é†’æ·»åŠ çº¿ç¨‹ã€‚åœ¨æºç ä¸­ put æ–¹æ³•ä¹Ÿçœ‹åˆ°ç±»ä¼¼çš„ç‰‡æ®µã€‚<br>if (c == 0)<br>            signalNotEmpty();<br>è€å¸ˆèƒ½å¦è§£ä¸‹æƒ‘ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1120345,"avatar":"https://static001.geekbang.org/account/avatar/00/11/18/59/daeb0b6c.jpg","nickname":"æ—¥å…‰å€¾åŸ","note":"","ucode":"E4329963F660DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9393,"discussion_content":"è¿™é‡Œåº”è¯¥æ˜¯æŒ‡åªæœ‰ä¸´ç•ŒçŠ¶æ€å˜åŒ–æ‰å‘å‡ºé€šçŸ¥ï¼Œæ¯”å¦‚ä»ç©ºå˜ä¸ºéç©ºï¼Œä»æ»¡å˜æˆéæ»¡çš„ä¸´ç•ŒçŠ¶æ€å˜åŒ–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568164249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113744,"avatar":"https://static001.geekbang.org/account/avatar/00/10/fe/90/19ef108d.jpg","nickname":"techwro","note":"","ucode":"7AF2B319F0AE1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4257,"discussion_content":"c = count.getAndDecrement();è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œç›´åˆ°å‡1æˆåŠŸä¸ºæ­¢ï¼Œä¸”è¿”å›æ—§å€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565255878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103734,"user_name":"colin","can_delete":false,"product_type":"c1","uid":1292206,"ip_address":"","ucode":"7A8849B8AE33E0","user_header":"https://static001.geekbang.org/account/avatar/00/13/b7/ae/a25fcb73.jpg","comment_is_top":false,"comment_ctime":1560499792,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560499792","product_id":100006701,"comment_content":"SynchronousQueueæ˜¯ä¸æ˜¯ç›¸å½“äºå»ºç«‹äº†ä¸€ä¸ªâ€œè™«æ´â€ï¼Ÿ","like_count":0},{"had_liked":false,"id":90007,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1556364222,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556364222","product_id":100006701,"comment_content":"å¤§è‡´æ€è·¯ï¼šï¼ˆåç»­éœ€è¦æ‰‹åŠ¨å®ç°ï¼‰<br>ä¸€æŠŠReentrantLock<br>ä¸¤ä¸ªCondition notEmpty notFull<br><br>æ ˆä¸ºç©º notEmpty.await() --- å‡ºæ ˆé˜»å¡<br>æ ˆå·²æ»¡ notFull.await()     --- å…¥æ ˆé˜»å¡<br><br>æ ˆä¸ä¸ºç©ºä¹Ÿä¸æ»¡ å‡ºæ ˆ å…¥æ ˆ ä¸é˜»å¡<br><br>å…¥æ ˆï¼š notEmpty.signal()<br>å‡ºæ ˆï¼š notFull.signal() <br><br>æºç å¾ˆç»å…¸ï¼Œè°¢è°¢è€å¸ˆï½ï¼  <br>å–œæ¬¢è¿™ä¸ªä¸“æ ï¼Œå¸Œæœ›ä»¥åè¿˜èƒ½çœ‹åˆ°æ‚¨å†™çš„ä¸“æ ï½ï¼<br><br><br>","like_count":0},{"had_liked":false,"id":37953,"user_name":"æ­å·","can_delete":false,"product_type":"c1","uid":1121604,"ip_address":"","ucode":"2E5E330FAB24FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIyqjqjTlaiavQb1I7d5au4A3mojticTXgBEu6picAv3qS7f1jhdq4bSS8mJpic1zWNhxaQWNPfYkQF0w/132","comment_is_top":false,"comment_ctime":1541824861,"is_pvip":false,"replies":[{"id":"13667","content":"æ²¡æœ‰å¤ªæ˜ç™½é—®é¢˜ï¼Œçº¿ç¨‹ç¦»å¼€çº¿ç¨‹æ± æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿâ€œå¾ˆå¥½â€æ˜¯å¾ˆâ€œé«˜â€å—ï¼Ÿå¾ˆå¤šâ€œé”â€ä½†å¹¶æ²¡æœ‰æ­»é”ï¼Œæˆ‘çš„ç†è§£å¯¹å—ï¼Ÿé…åˆtopï¼Œçœ‹çœ‹å cpuçš„çº¿ç¨‹æ ˆå…·ä½“æ˜¯ä»€ä¹ˆæƒ…å†µå§ï¼Œ","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1541905605,"ip_address":"","comment_id":37953,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541824861","product_id":100006701,"comment_content":"æ¨è€å¸ˆä½ å¥½ï¼Œé‡åˆ°ä¸ªé—®é¢˜ï¼Œ200ä¸ªå¹¶å‘çº¿ç¨‹æ± é˜»å¡è¯»linkBlockingQueueé˜Ÿåˆ—ï¼Œå¶å°”ä¼šå‡ºç°é˜»å¡æ—¶ä¼šçº¿ç¨‹cpuå¾ˆå¥½ã€‚jstackçœ‹äº†å¾ˆå¤šlockã€‚ä¼šä¸ä¼šå‡ºç°çº¿ç¨‹ç¦»å¼€çº¿ç¨‹æ± ï¼Œå»å¹²åˆ«çš„ä»»åŠ¡ï¼Œå¹²äº†ä¸€åŠåˆå›åˆ°çº¿ç¨‹æ± ä¸­å¹²æ´»ã€‚ä¸¤è¾¹å‡ºç°æ­»é”ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428538,"discussion_content":"æ²¡æœ‰å¤ªæ˜ç™½é—®é¢˜ï¼Œçº¿ç¨‹ç¦»å¼€çº¿ç¨‹æ± æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿâ€œå¾ˆå¥½â€æ˜¯å¾ˆâ€œé«˜â€å—ï¼Ÿå¾ˆå¤šâ€œé”â€ä½†å¹¶æ²¡æœ‰æ­»é”ï¼Œæˆ‘çš„ç†è§£å¯¹å—ï¼Ÿé…åˆtopï¼Œçœ‹çœ‹å cpuçš„çº¿ç¨‹æ ˆå…·ä½“æ˜¯ä»€ä¹ˆæƒ…å†µå§ï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541905605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":31565,"user_name":"å°é£å“¥ â€è¶…ç´šæœƒå“¡","can_delete":false,"product_type":"c1","uid":1110049,"ip_address":"","ucode":"417F9563B3005B","user_header":"https://static001.geekbang.org/account/avatar/00/10/f0/21/104b9565.jpg","comment_is_top":false,"comment_ctime":1539231440,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1539231440","product_id":100006701,"comment_content":"å‘æˆ‘ä»¬è¿™äº›å†™ä¸šåŠ¡ä»£ç çš„åº”è¯¥å¦‚ä½•ä½¿ç”¨å¹¶å‘ç±»å’Œæ¡†æ¶ï¼Ÿ","like_count":0},{"had_liked":false,"id":23742,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1536628560,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1536628560","product_id":100006701,"comment_content":"SynchronousQueueï¼Œåˆ é™¤æ“ä½œä¾èµ–æ’å…¥æ“ä½œï¼Œè€Œæ’å…¥æ“ä½œåˆä¾èµ–åˆ é™¤æ“ä½œï¼Œæ­»é”äº†ä¹ˆï¼Ÿ<br>SynchronousQueue ä¸€èˆ¬åº”ç”¨åœ¨å•¥åœºæ™¯å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1541386,"avatar":"https://static001.geekbang.org/account/avatar/00/17/85/0a/e564e572.jpg","nickname":"N_H","note":"","ucode":"109B67557AB3CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":10289,"discussion_content":"CachedThreadPoolExecutor","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568283148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16516,"user_name":"çº¯çˆ·ä»¬","can_delete":false,"product_type":"c1","uid":1105976,"ip_address":"","ucode":"E2F81E5076C850","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/38/c7b1e502.jpg","comment_is_top":false,"comment_ctime":1531999957,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1531999957","product_id":100006701,"comment_content":"Javaå¹¶å‘åŒ…é‡Œçš„ä¸œè¥¿å¹³æ—¶åŸºæœ¬æ²¡æ€ä¹ˆæ¥è§¦ï¼Œè¿™å—çŸ¥è¯†å¤ªç¼ºä¹äº†ï¼Œçœ‹è¿™ç¯‡æ–‡ç« ç—›è‹¦ï¼","like_count":0,"discussions":[{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":151776,"discussion_content":"æ‰€ä»¥ä¸å¤ªé€‚åˆä¸¤å¹´çš„çœ‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579885187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13956,"user_name":"Invocker.C","can_delete":false,"product_type":"c1","uid":1002492,"ip_address":"","ucode":"0C6610D0426548","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4b/fc/a535ce4f.jpg","comment_is_top":false,"comment_ctime":1530083852,"is_pvip":false,"replies":[{"id":"4654","content":"ä¸æ¸…æ¥šä½ çš„ç¡¬ä»¶ã€ä¸šåŠ¡ç‰¹ç‚¹ï¼Œä¸€ä¸ªå¤§æ¦‚åŸåˆ™æ˜¯å°½é‡è®©è¿›å’Œå‡ºçš„é€Ÿç‡ä¸€è‡´ï¼Œä¸ç„¶å‡ºæ…¢ï¼Œè¿›å°±blockï¼Œåè¿‡æ¥ä¹Ÿä¸å¥½ï¼›å®é™…æ“ä½œä¸Šï¼Œä½ è¯•è¯•æ‰¾æ—¶æœºæ£€æŸ¥remaincapacityï¼Œå°±å¯ä»¥åˆ¤æ–­è¿›å‡ºé€Ÿç‡çš„å¯¹æ¯”","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1530118645,"ip_address":"","comment_id":13956,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1530083852","product_id":100006701,"comment_content":"æ±‚è€å¸ˆè§£ç­”ä¸€ä¸ªå›°æ‰°å·²ä¹…çš„é—®é¢˜ï¼Œå°±æ˜¯åˆå§‹åŒ–arrayblockingqueueçš„æ—¶å€™ï¼Œcapacityçš„å¤§å°å¦‚ä½•è¯„ä¼°å’Œè®¾ç½®ï¼Ÿæœ›è§£ç­”","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419822,"discussion_content":"ä¸æ¸…æ¥šä½ çš„ç¡¬ä»¶ã€ä¸šåŠ¡ç‰¹ç‚¹ï¼Œä¸€ä¸ªå¤§æ¦‚åŸåˆ™æ˜¯å°½é‡è®©è¿›å’Œå‡ºçš„é€Ÿç‡ä¸€è‡´ï¼Œä¸ç„¶å‡ºæ…¢ï¼Œè¿›å°±blockï¼Œåè¿‡æ¥ä¹Ÿä¸å¥½ï¼›å®é™…æ“ä½œä¸Šï¼Œä½ è¯•è¯•æ‰¾æ—¶æœºæ£€æŸ¥remaincapacityï¼Œå°±å¯ä»¥åˆ¤æ–­è¿›å‡ºé€Ÿç‡çš„å¯¹æ¯”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530118645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1006922,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5d/4a/4b0d9ebc.jpg","nickname":"è¥¿ä¼¯åˆ©äºšé¼¯é¼ ","note":"","ucode":"311ADB023935E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382998,"discussion_content":"æˆ‘è§‰å¾—é˜Ÿåˆ—å®¹é‡ï¼Œåº”è¯¥è€ƒè™‘å¯¹åº”æŠµæ¶ˆã€æ¶ˆè´¹è€…å¤„ç†é€Ÿç‡çš„æŠ–åŠ¨æé™æ—¶é•¿ã€‘å’Œã€ç”Ÿäº§è€…è¢«é˜»å¡çš„è¶…æ—¶æ—¶é•¿ã€‘ã€‚å®¹é‡å¤ªå¤§ï¼Œå¯èƒ½å¯¼è‡´åè¿›çš„messageå¿…ç„¶è¢«è¶…æ—¶ï¼›å¤ªå°åˆ™å¯¼è‡´æ²¡èƒ½ç»™åˆ°æ¶ˆè´¹ä¾§è¶³å¤Ÿçš„bufferï¼Œé˜»å¡äº†ç”Ÿäº§è€…ï¼Œå½±å“ååã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625818762,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":13354,"user_name":"å¤æ´›å…‹çš„æ•‘èµ","can_delete":false,"product_type":"c1","uid":1021334,"ip_address":"","ucode":"44453DD27A3216","user_header":"https://static001.geekbang.org/account/avatar/00/0f/95/96/0020bd67.jpg","comment_is_top":false,"comment_ctime":1529550501,"is_pvip":false,"replies":[{"id":"4503","content":"ç¼–ç ï¼ŒåŒºåˆ†æ‹‰ä¸å’Œéæ‹‰ä¸è¯­ç³»","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529627663,"ip_address":"","comment_id":13354,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529550501","product_id":100006701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œé—®ä¸ªé¢˜å¤–é—®é¢˜ï¼Œåœ¨jdk10æºç   stringç±»ä¸­ï¼Œæˆå‘˜å˜é‡coderèµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Ÿå¦‚ä½•ç†è§£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419621,"discussion_content":"ç¼–ç ï¼ŒåŒºåˆ†æ‹‰ä¸å’Œéæ‹‰ä¸è¯­ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529627663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}