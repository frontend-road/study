{"id":722240,"title":"07ï½œç±»å‹ä¸ç±»å‹å‚æ•°ï¼šç»™Rustå°åŠ©æ‰‹æä¾›æ›´å¤šä¿¡æ¯","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeã€‚ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ Rustä¸­ç±»å‹ç›¸å…³çš„çŸ¥è¯†ã€‚</p><p>è¿™å—å„¿çŸ¥è¯†åœ¨å…¶ä»–å¤§éƒ¨åˆ†è¯­è¨€å…¥é—¨ææ–™ä¸­è®²å¾—ä¸å¤šï¼Œä½†æ˜¯å¯¹äºRustè€Œè¨€ï¼Œå´æ˜¯éå¸¸é‡è¦è€Œæœ‰è¶£çš„ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œè®¡ç®—æœºç¡¬ä»¶æ‰§è¡Œçš„ä»£ç å…¶å®æ˜¯äºŒè¿›åˆ¶åºåˆ—ã€‚è€Œ<strong>å¯¹ä¸€ä¸ªäºŒè¿›åˆ¶å€¼æ¥è¯´ï¼Œæ­£æ˜¯ç±»å‹èµ‹äºˆäº†å®ƒæ„ä¹‰</strong>ã€‚</p><p>æ¯”å¦‚ 01100001 è¿™ä¸ªäºŒè¿›åˆ¶æ•°å­—ï¼ŒåŒæ ·çš„å†…å­˜è¡¨ç¤ºï¼Œå¦‚æœæ˜¯æ•´æ•°ï¼Œå°±è¡¨ç¤º97ã€‚å¦‚æœæ˜¯å­—ç¬¦ï¼Œå°±è¡¨ç¤º <code>'a'</code> è¿™ä¸ª charã€‚å¦‚æœæ²¡æœ‰ç±»å‹å»èµ‹äºˆå®ƒé¢å¤–çš„ä¿¡æ¯ï¼Œå½“ä½ çœ‹åˆ°è¿™ä¸²äºŒè¿›åˆ¶ç¼–ç æ—¶ï¼Œæ˜¯ä¸çŸ¥é“å®ƒä»£è¡¨ä»€ä¹ˆçš„ã€‚</p><h2>ç±»å‹</h2><p>ã€ŠProgramming.with.Typesã€‹2019 è¿™æœ¬ä¹¦é‡Œå¯¹ç±»å‹åšäº†ä¸€ä¸ªå®šä¹‰ï¼Œç¿»è¯‘å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼šç±»å‹æ˜¯å¯¹æ•°æ®çš„åˆ†ç±»ï¼Œè¿™ä¸ªåˆ†ç±»å®šä¹‰äº†è¿™äº›æ•°æ®çš„æ„ä¹‰ã€è¢«å…è®¸çš„å€¼çš„é›†åˆï¼Œè¿˜æœ‰èƒ½åœ¨è¿™äº›æ•°æ®ä¸Šæ‰§è¡Œå“ªäº›æ“ä½œã€‚ç¼–è¯‘å™¨æˆ–è¿è¡Œæ—¶ä¼šæ£€æŸ¥ç±»å‹åŒ–è¿‡ç¨‹ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼Œå¯¹æ•°æ®æ–½åŠ è®¿é—®é™åˆ¶ï¼Œä»¥åŠæŠŠæ•°æ®æŒ‰ç¨‹åºå‘˜çš„æ„å›¾è¿›è¡Œè§£é‡Šã€‚</p><p>æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šç®€åŒ–è®¨è®ºï¼ŒæŠŠæ“ä½œéƒ¨åˆ†å¿½ç•¥æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç®€å•åœ°<strong>æŠŠç±»å‹çœ‹ä½œé›†åˆï¼Œè¿™ä¸ªé›†åˆè¡¨è¾¾äº†è¿™ä¸ªç±»å‹çš„å®ä¾‹èƒ½å–åˆ°çš„æ‰€æœ‰å¯èƒ½çš„å€¼</strong>ã€‚</p><h3>ç±»å‹ç³»ç»Ÿ</h3><p>è¿™æœ¬ä¹¦é‡Œè¿˜å®šä¹‰äº†ç±»å‹ç³»ç»Ÿçš„æ¦‚å¿µã€‚</p><p>ä¹¦é‡Œæ˜¯è¿™æ ·è¯´çš„ï¼šç±»å‹ç³»ç»Ÿæ˜¯ä¸€å¥—è§„åˆ™é›†â€”â€”æŠŠç±»å‹èµ‹äºˆå’Œæ–½åŠ åˆ°ç¼–ç¨‹è¯­è¨€çš„å…ƒç´ ä¸Šã€‚è¿™äº›å…ƒç´ å¯ä»¥æ˜¯å˜é‡ã€å‡½æ•°å’Œå…¶ä»–é«˜é˜¶ç»“æ„ã€‚ç±»å‹ç³»ç»Ÿé€šè¿‡ä½ åœ¨ä»£ç ä¸­æä¾›çš„æ ‡æ³¨æ¥ç»™å…ƒç´ èµ‹äºˆç±»å‹ï¼Œæˆ–è€…æ ¹æ®å®ƒçš„ä¸Šä¸‹æ–‡éšå¼åœ°æ¨å¯¼æŸä¸ªå…ƒç´ çš„ç±»å‹ã€‚ç±»å‹ç³»ç»Ÿå…è®¸åœ¨ç±»å‹é—´åšå„ç§è½¬æ¢ï¼ŒåŒæ—¶ç¦æ­¢å…¶ä»–çš„ä¸€äº›è½¬æ¢ã€‚</p><!-- [[[read_end]]] --><p>ä¸¾ä¾‹æ¥è¯´ï¼Œåˆšåˆšæˆ‘ä»¬æåˆ°çš„ç±»å‹çš„æ ‡æ³¨å°±åƒè¿™ç§ <code>let a: u32 = 10;</code>ã€‚æˆ‘ä»¬ç”¨ <code>: u32</code> è¿™ç§è¯­æ³•å¯¹å˜é‡aè¿›è¡Œäº†æ ‡æ³¨ï¼Œè¡¨æ˜å˜é‡açš„ç±»å‹æ˜¯ <code>u32</code> ç±»å‹ã€‚<code>u32</code> å¯ä»¥è½¬æ¢æˆ <code>u64</code>ã€‚</p><pre><code class=\"language-plain\">let b = a as u64;\n</code></pre><p>ä½†æ˜¯ <code>u32</code> ä¸èƒ½ç›´æ¥è½¬æ¢åˆ°Stringä¸Šå»ã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let a: u32 = 10;\n&nbsp; &nbsp; let b = a as String;    // é”™è¯¯çš„\n\n&nbsp; &nbsp; println!(\"{b}\");\n}\n</code></pre><h3>ç±»å‹åŒ–çš„å¥½å¤„</h3><p>ç±»å‹åŒ–æœ‰5å¤§å¥½å¤„ï¼šæ­£ç¡®æ€§ã€ä¸å¯å˜æ€§ã€å°è£…æ€§ã€ç»„åˆæ€§ã€å¯è¯»æ€§ã€‚è¿™5å¤§å¥½å¤„ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ˜¯è½¯ä»¶å·¥ç¨‹ç†è®ºæ¨å´‡çš„ã€‚</p><p>Rustè¯­è¨€éå¸¸å¼ºè°ƒ<strong>ç±»å‹åŒ–</strong>ï¼Œå®ƒçš„ç±»å‹ç³»ç»Ÿéå¸¸ä¸¥æ ¼ï¼Œéšå¼è½¬æ¢éå¸¸å°‘ï¼Œåœ¨æŸäº›ç®€å•åœºæ™¯ä¸‹ç”šè‡³ä¼šå¼•èµ·åˆå­¦è€…çš„ä¸é€‚ã€‚</p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä»£ç ï¼š</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let a = 1.0f32;\n&nbsp; &nbsp; let b = 10;\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; let c = a * b;\n}\n</code></pre><p>ç¼–è¯‘é”™è¯¯ï¼Œæç¤ºä½ ä¸èƒ½å°†ä¸€ä¸ªæµ®ç‚¹æ•°å’Œä¸€ä¸ªæ•´æ•°ç›¸ä¹˜ã€‚</p><pre><code class=\"language-plain\">error[E0277]: cannot multiply `f32` by `{integer}`\n --&gt; src/main.rs:5:15\n  |\n5 |     let c = a * b;\n  |               ^ no implementation for `f32 * {integer}`\n  |\n  = help: the trait `Mul&lt;{integer}&gt;` is not implemented for `f32`\n  = help: the following other types implement trait `Mul&lt;Rhs&gt;`:\n            &lt;&amp;'a f32 as Mul&lt;f32&gt;&gt;\n            &lt;&amp;f32 as Mul&lt;&amp;f32&gt;&gt;\n            &lt;f32 as Mul&lt;&amp;f32&gt;&gt;\n            &lt;f32 as Mul&gt;\n</code></pre><p>åˆå­¦è€…é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¾€å¾€ä¼šè§‰å¾—Rustè¿‡äºä¸¥è‹›ï¼Œä¸€ä¸ªå¾ˆè‡ªç„¶çš„æ“ä½œéƒ½ä¸è®©æˆ‘é€šè¿‡ï¼Œçƒ¦æ­»äº†ï¼Œé©¬ä¸Šå°±æƒ³æ”¾å¼ƒäº†ã€‚</p><p>å½“é‡åˆ°è¿™ç§åŸºç¡€ç±»å‹è½¬æ¢é”™è¯¯æ—¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ <strong>as æ“ä½œç¬¦</strong>æ˜¾å¼åœ°å°†ç±»å‹è½¬æˆä¸€è‡´ã€‚</p><p>ä¿®æ”¹ä¸Šè¿°ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let a = 1.0f32;\n&nbsp; &nbsp; let b = 10 as f32;    // æ·»åŠ äº† as f32\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; let c = a * b;\n}\n</code></pre><p>è¿™æ®µä»£ç å°±å¯ä»¥ç¼–è¯‘é€šè¿‡äº†ã€‚</p><p>è¿™é‡Œå…¶å®å±•ç¤ºå‡ºRustçš„ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„ç‰¹ç‚¹ï¼š<strong>å°½å¯èƒ½åœ°æ˜¾å¼åŒ–</strong>ã€‚æ˜¾å¼åŒ–åŒ…å«ä¸¤å±‚æ„æ€ã€‚</p><ol>\n<li>ä¸åšè‡ªåŠ¨éšå¼è½¬æ¢ã€‚</li>\n<li>æ²¡æœ‰å†…ç½®è½¬æ¢ç­–ç•¥ã€‚</li>\n</ol><p>ä¸åšè‡ªåŠ¨éšå¼è½¬æ¢ï¼Œå¯ä»¥è¿™æ ·æ¥ç†è§£ï¼Œæ¯”å¦‚å‰é¢çš„ç¤ºä¾‹ï¼Œå½“åˆ«äººæ¥çœ‹ä½ çš„ä»£ç çš„æ—¶å€™ï¼Œå¤šäº† <code>as f32</code> è¿™å‡ ä¸ªå­—ç¬¦ï¼Œä»–å°±æ˜ç™½ä½ æ˜¯åœ¨åšç±»å‹è½¬æ¢ï¼Œå°±ä¼šè‡ªç„¶åœ°è­¦è§‰èµ·æ¥ï¼Œåˆ†æä¸Šä¸‹æ–‡ï¼Œä¼°è®¡å‡ºä¸‹é¢ç®—å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆç±»å‹ã€‚è¿™ç›¸å½“äºç”±ç¨‹åºå‘˜ä¸ºç¼–è¯‘å™¨æ˜ç¡®åœ°æä¾›äº†ä¸€äº›é¢å¤–çš„ä¿¡æ¯ã€‚</p><p>æ²¡æœ‰å†…ç½®è½¬æ¢ç­–ç•¥è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿JavaScriptç¤¾åŒºä¸­æµä¼ çš„ä¸€å¼ æ¢—å›¾æ¥å¯¹æ¯”è¯´æ˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/be/4f0c8b5269e3e03e086ca762802860be.png?wh=572x650\" alt=\"å›¾ç‰‡\" title=\"å›¾ç‰‡æ¥æºï¼šhttps://www.codenong.com/cs107029540/\"></p><p>å–å›¾é‡Œçš„ä¸€ä¸ªç¤ºä¾‹ï¼Œåœ¨ JavaScript é‡Œï¼Œ<code>9 + \"1\"</code> è®¡ç®—å‡ºæ¥çš„ç»“æœæ˜¯ <code>\"91\"</code>ã€‚è¿™å…¶å®å°±æ¶‰åŠä¸¤ä¸ªä¸åŒç±»å‹ä¹‹é—´ç›¸åŠ å¦‚ä½•å¤„ç†çš„é—®é¢˜ã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸Šï¼ŒJavaScript è‡ªå·±å†…ç½®äº†ç­–ç•¥ï¼ŒæŠŠä¸¤ä¸ªä¸åŒç±»å‹çš„å€¼åŠ èµ·æ¥ï¼Œç¡¬ç”Ÿç”Ÿç®—å‡ºäº†ä¸€ä¸ªç»“æœã€‚è€Œå½“é‡åˆ° <code>91- \"1\"</code> æ—¶ï¼Œç­–ç•¥åˆå˜äº†ï¼Œç®—å‡ºäº†æ•°å­— 90ã€‚è¿™äº›å°±æ˜¯å†…ç½®ç±»å‹è½¬æ¢ç­–ç•¥çš„ä½“ç°ã€‚</p><p>è€Œåœ¨Rustä¸­ï¼Œ<code>9+\"1\"</code> æ˜¯ä¸å¯èƒ½é€šè¿‡ç¼–è¯‘çš„ï¼Œæ›´ä¸è¦è¯´è®¡ç®—å‡ºä¸€ä¸ªç¥å¥‡çš„ç»“æœäº†ã€‚å¦‚æœè¦å†™å‡ºç±»ä¼¼çš„ä»£ç ï¼Œåœ¨Rustä¸­å¯ä»¥è¿™æ ·åšã€‚</p><pre><code class=\"language-plain\">fn main() {\n&nbsp; &nbsp; let a = 9 + '1' as u8;\n&nbsp; &nbsp; let b = 9.to_string() + \"1\";\n}\n</code></pre><p>æœ‰æ²¡æœ‰è§‰å¾—ç‰¹åˆ«æ¸…æ™°ï¼æˆ‘ä»¬ä¸€çœ¼å°±èƒ½æ¨æ–­å‡º a å’Œ b çš„ç±»å‹ï¼Œaä¸ºu8ç±»å‹ï¼Œbä¸ºStringç±»å‹ã€‚</p><p>è¿™å°±æ˜¯Rustçš„ä¸¥è°¨ï¼Œå®ƒæœ‰ç€ä¸¥å¯†çš„ç±»å‹ä½“ç³»ï¼Œåœ¨ç±»å‹åŒ–ä¸Šç»ä¸å«ç³Šã€‚å®ƒä»åº•å±‚åˆ°ä¸Šå±‚æ„å»ºäº†ä¸€å¥—å®Œæ•´ä¸¥å¯†çš„ç±»å‹å¤§å¦ã€‚ä½ çš„é¡¹ç›®è¶Šå¤§ï¼Œä½¿ç”¨Rustæ„Ÿè§‰ä¹Ÿå°±è¶Šèˆ’æœï¼ŒåŸå› ä¹‹ä¸€å°±æ˜¯ä¸¥è°¨çš„ç±»å‹ç³»ç»Ÿåœ¨ä¸ºä½ ä¿é©¾æŠ¤èˆªã€‚</p><h2>ç±»å‹ä½œä¸ºä¸€ç§çº¦æŸ</h2><p>å‰é¢æåˆ°ï¼Œç±»å‹æ˜¯å˜é‡æ‰€æœ‰å¯èƒ½å–å¾—çš„å€¼çš„é›†åˆã€‚æ¢å¥è¯è¯´ï¼Œç±»å‹å®é™…ä¸Šé™åˆ¶æˆ–å®šä¹‰äº†å˜é‡çš„å–å€¼ç©ºé—´ã€‚å› æ­¤ï¼Œ<strong>ç±»å‹å¯¹äºå˜é‡æ¥è¯´ï¼Œä¹Ÿæ˜¯ä¸€ç§çº¦æŸ</strong>ã€‚</p><p>å®é™…ä¸Šï¼ŒRustä¸­çš„ : ï¼ˆå†’å·ï¼‰åœ¨è¯­æ³•å±‚é¢ä¸Šå°±æ˜¯çº¦æŸã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">let a: u8 = 10;\nlet b: String = \"123\".to_string();\n</code></pre><p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œå˜é‡aè¢«é™åˆ¶ä¸ºåªèƒ½åœ¨u8è¿™ä¸ªç±»å‹çš„å€¼ç©ºé—´å–å€¼ï¼Œä¹Ÿå°±æ˜¯0åˆ°255è¿™256ä¸ªæ•´æ•°é‡Œçš„ä¸€ä¸ªï¼Œè€Œ10å±äºè¿™ä¸ªç©ºé—´ã€‚å˜é‡bè¢«é™åˆ¶ä¸ºåªèƒ½åœ¨å­—ç¬¦ä¸²å€¼ç©ºé—´å†…å–å€¼ã€‚ä¸ç®¡å­—ç¬¦ä¸²çš„å€¼ç©ºé—´å¤šå¤§ï¼ˆå…¶å®æ˜¯æ— é™ï¼‰ï¼Œè¿™äº›å€¼ä¸u8ã€u32è¿™äº›ç±»å‹çš„å€¼ä¹Ÿæ˜¯ä¸åŒçš„ã€‚</p><p>å…³äº : ä½œä¸ºçº¦æŸçš„ä½“ç°ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢çš„è¯¾ç¨‹ä¸­ä¸æ–­çœ‹åˆ°ã€‚</p><h2>å¤šç§ç±»å‹å¦‚ä½•è¡¨ç¤ºï¼Ÿ</h2><p>å‰é¢æˆ‘ä»¬è®²åˆ°äº†ï¼Œç”¨ä¸€ç§ç±»å‹æ¥å¯¹å˜é‡çš„å–å€¼ç©ºé—´è¿›è¡Œçº¦æŸã€‚è¿™ç¡®å®éå¸¸å¥½ï¼Œæœ‰åˆ©äºç¨‹åºçš„å¥å£®æ€§ã€‚ä½†æœ‰æ—¶ä¹Ÿä¼šé‡åˆ°è¿™ç§æ–¹å¼ä¸å¤Ÿç”¨çš„åœºæ™¯ã€‚æ¯”å¦‚åœ¨Rustä¸­ï¼Œæˆ‘ä»¬æŠŠæ•´æ•°åˆ†æˆ u8ã€u16ã€u32ã€u64ã€‚ç°åœ¨æˆ‘æƒ³å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ”¯æŒæ•´æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´è¦åŒæ—¶èƒ½æ¥å—u8ã€u16ã€u32ã€u64è¿™å‡ ç§ç±»å‹çš„å€¼ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿå¦‚æœåªæ˜¯é‡‡ç”¨å‰é¢çš„ç†è®ºï¼Œè¿™ä¸ªéœ€æ±‚æ˜¯æ²¡æ³•åšåˆ°çš„ã€‚</p><p>å†çœ‹å¦å¤–ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ—¥å¿—å‡½æ•°ï¼Œå¯ä»¥ç»™è¿™ä¸ªå‡½æ•°ä¼ å…¥æ•°å­—ã€å­—ç¬¦ä¸²ç­‰ç±»å‹ã€‚è¿™ç§éœ€æ±‚å¾ˆå¸¸è§ã€‚å¦‚ä½•è®©è¿™ä¸€ä¸ªæ—¥å¿—å‡½æ•°åŒæ—¶æ”¯æŒæ•°å­—å’Œå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°å‘¢ï¼Ÿè¿™å°±å¾ˆå¤´ç—›äº†ã€‚</p><p>è¿™é‡Œå®é™…æå‡ºäº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š<strong>åœ¨Rustè¯­è¨€ä¸­ï¼Œæœ‰æ²¡æœ‰åŠæ³•ç”¨æŸç§æ–¹å¼æ¥è¡¨ç¤ºå¤šç§ç±»å‹ï¼Ÿ</strong>ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚</p><h2>ç±»å‹å‚æ•°</h2><p>åœ¨Rustè¯­è¨€ä¸­å®šä¹‰ç±»å‹çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<strong>ç±»å‹å‚æ•°</strong>ã€‚æ¯”å¦‚æ ‡å‡†åº“é‡Œå¸¸è§çš„ <code> Vec&lt;T&gt;</code>ï¼Œå°±å¸¦ä¸€ä¸ªç±»å‹å‚æ•°Tï¼Œå®ƒå¯ä»¥æ”¯æŒä¸åŒç±»å‹çš„åˆ—è¡¨ï¼Œå¦‚ <code>Vec&lt;u8&gt;</code>ã€<code>Vec&lt;u32&gt;</code>ã€<code>Vec&lt;String&gt;</code> ç­‰ã€‚è¿™é‡Œè¿™ä¸ª T å°±è¡¨ç¤ºä¸€ä¸ªç±»å‹å‚æ•°ï¼Œåœ¨å®šä¹‰æ—¶è¿˜ä¸çŸ¥é“å®ƒå…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ã€‚åªæœ‰åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šå¯¹è¿™ä¸ª T èµ‹äºˆä¸€ä¸ªå…·ä½“çš„ç±»å‹ã€‚</p><p>è¿™é‡Œè¿™ä¸ª <code>Vec&lt;T&gt;</code>ï¼Œæ˜¯ä¸€ä¸ªç±»å‹æ•´ä½“ï¼Œå•ç‹¬æ‹†å¼€æ¥è®²Vecç±»å‹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚Tæ˜¯ <code>Vec&lt;T&gt;</code> ä¸­çš„ç±»å‹å‚æ•°ï¼Œå®ƒå…¶å®ä¹Ÿæ˜¯ä¿¡æ¯ï¼Œæä¾›ç»™Rustç¼–è¯‘å™¨ä½¿ç”¨ã€‚è€Œå¸¦ç±»å‹å‚æ•°çš„ç±»å‹æ•´ä½“ï¼ˆæ¯”å¦‚ <code>Vec&lt;T&gt;</code>ï¼‰å°±å«åš<strong>æ³›å‹</strong>ï¼ˆgeneric typeï¼‰ã€‚</p><h3>ç»“æ„ä½“ä¸­çš„ç±»å‹å‚æ•°</h3><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªç»“æ„ä½“ <code>Point&lt;T&gt;</code>ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n</code></pre><p>è¿™æ˜¯ä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šçš„ç‚¹ï¼Œç”±xã€yä¸¤ä¸ªåæ ‡è½´æ¥å®šä¹‰ã€‚å› ä¸ºxã€yçš„å–å€¼æœ‰å¯èƒ½æ˜¯æ•´æ•°ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œç”šè‡³æœ‰å¯èƒ½æ˜¯å…¶ä»–å€¼ï¼Œæ¯”å¦‚æ— ç©·ç²¾åº¦çš„ç±»å‹ã€‚æ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»å‹å‚æ•° Tï¼Œå®šä¹‰çš„æ—¶å€™éœ€è¦æŠŠTæ”¾åœ¨ç»“æ„ä½“ç±»å‹åå­—åé¢ï¼Œç”¨ <code>&lt;&gt;</code> æ‹¬èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯ <code>struct Point&lt;T&gt;</code>ã€‚è¿™é‡Œçš„ <code>Point&lt;T&gt;</code> æ•´ä½“å°±æˆä¸ºäº†æ³›å‹ã€‚ç„¶åï¼Œæ ‡æ³¨ x å’Œ y åˆ†é‡çš„ç±»å‹éƒ½æ˜¯ Tã€‚å¯ä»¥çœ‹åˆ°ï¼ŒTå æ®äº†å†’å·åé¢å®šä¹‰ç±»å‹çš„ä½ç½®ã€‚æ‰€ä»¥è¯´å®ƒæ˜¯<strong>å ä½ç±»å‹</strong>ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p><p>å¯¹è¿™ä¸ªç»“æ„ä½“çš„ä¾‹å­æ¥è¯´ï¼Œå…¶å®è¿˜éšè—äº†ä¸€ä¸ªå¾ˆé‡è¦çš„ç»†èŠ‚ï¼šxå’Œyå­—æ®µçš„ç±»å‹éƒ½æ˜¯Tï¼Œæ„å‘³ç€ x å’Œ y ä¸¤ä¸ªåˆ†é‡çš„ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªPointç»“æ„ä½“ç±»å‹å¦‚ä½•å®ä¾‹åŒ–ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nfn main() {\n    let integer = Point { x: 5, y: 10 };     // ä¸€ä¸ªæ•´æ•°point\n    let float = Point { x: 1.0, y: 4.0 };    // ä¸€ä¸ªæµ®ç‚¹æ•°point\n}\n</code></pre><p>ç¬¦åˆæˆ‘ä»¬é¢„æœŸï¼Œæ­£å¸¸ç¼–è¯‘é€šè¿‡ã€‚é‚£å¦‚æœå®ä¾‹åŒ–çš„æ—¶å€™ï¼Œç»™xå’Œyèµ‹äºˆä¸åŒçš„ç±»å‹å€¼ä¼šæ€æ ·å‘¢ï¼Ÿæˆ‘ä»¬æ¥è¯•è¯•ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nfn main() {\n    let wont_work = Point { x: 5, y: 4.0 };\n}\n\n$ cargo run\n   Compiling chapter10 v0.1.0 (file:///projects/chapter10)\nerror[E0308]: mismatched types\n --&gt; src/main.rs:7:38\n  |\n7 |     let wont_work = Point { x: 5, y: 4.0 };\n  |                                      ^^^ expected integer, found floating-point number\n</code></pre><p>ç¼–è¯‘å™¨æ­£ç¡®åœ°æŒ‡å‡ºäº†é—®é¢˜ï¼Œè¯´æœŸæœ›æ•´æ•°å´æ”¶åˆ°äº†æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥ä¸é€šè¿‡ã€‚<br>\nè¿™é‡Œæœ‰ä¸ªç»†èŠ‚ï¼Œé‚£å°±æ˜¯ç¼–è¯‘å™¨å¯¹ <code>Point&lt;T&gt;</code> ä¸­çš„Tå‚æ•°è¿›è¡Œäº†æ¨å¯¼ï¼Œå› ä¸ºå®ƒé¦–å…ˆé‡åˆ°çš„æ˜¯xçš„å€¼ 5ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼Œå› æ­¤ç¼–è¯‘å™¨å°±æŠŠ T å…·ä½“åŒ–æˆäº†æ•´æ•°ç±»å‹ï¼ˆå…·ä½“å“ªä¸€ç§è¿˜æ²¡è¯´ï¼Œä¸è¿‡åœ¨è¿™é‡Œä¸é‡è¦ï¼‰ï¼Œå½“å†æ”¶åˆ°yåˆ†é‡çš„å€¼çš„æ—¶å€™ï¼Œå‘ç°æ˜¯æµ®ç‚¹æ•°ç±»å‹ï¼Œå’Œåˆšæ‰çš„æ•´æ•°ç±»å‹ä¸ä¸€è‡´äº†ã€‚è€ŒPointä¸­å®šä¹‰çš„æ—¶å€™ï¼Œåˆè¦æ±‚xå’Œyçš„ç±»å‹æ˜¯ç›¸åŒçš„ï¼Œè¿™ä¸ªæ—¶å€™å°±äº§ç”Ÿäº†å†²çªï¼Œäºæ˜¯æŠ¥é”™ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼ŸRustå¹¶æ²¡æœ‰é™åˆ¶æˆ‘ä»¬åªèƒ½å®šä¹‰ä¸€ä¸ªç±»å‹å‚æ•°å‘€ï¼å®šä¹‰å¤šä¸ªå°±å¥½äº†ï¼ŒæŠŠxåˆ†é‡å’Œyåˆ†é‡å®šä¹‰æˆä¸åŒçš„å‚æ•°åŒ–ç±»å‹ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T, U&gt; {\n    x: T,\n    y: U,\n}\n\nfn main() {\n    let both_integer = Point { x: 5, y: 10 };\n    let both_float = Point { x: 1.0, y: 4.0 };\n    let integer_and_float = Point { x: 5, y: 4.0 };\n}\n</code></pre><p>åƒè¿™æ ·ï¼Œä»£ç å°±å¯ä»¥é¡ºåˆ©é€šè¿‡ç¼–è¯‘äº†ã€‚</p><p>å†æ¬¡å¼ºè°ƒï¼Œå‰é¢ä¸¤ä¸ªç¤ºä¾‹é‡Œçš„ <code>Point&lt;T&gt;</code> å’Œ <code>Point&lt;T, U&gt;</code> éƒ½æ˜¯ä¸€ä¸ªç±»å‹æ•´ä½“ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä½ æŠŠ Point è¿™ä¸ªç¬¦å·æœ¬èº«å•ç‹¬æ‹¿å‡ºæ¥æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨turbofishè¯­æ³• <code>::&lt;&gt;</code> æ˜ç¡®åœ°ç»™æ³›å‹ï¼Œæˆ–è€…è¯´æ˜¯ç»™Rustç¼–è¯‘å™¨æä¾›ç±»å‹å‚æ•°ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä¸Šé¢ä¸¤ä¸ªç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n&nbsp; &nbsp; x: T,\n&nbsp; &nbsp; y: T,\n}\n\nfn main() {\n&nbsp; &nbsp; let integer = Point::&lt;u32&gt; { x: 5, y: 10 };&nbsp; &nbsp; &nbsp;\n&nbsp; &nbsp; let float = Point::&lt;f32&gt; { x: 1.0, y: 4.0 };&nbsp; &nbsp; \n}\n</code></pre><pre><code class=\"language-plain\">struct Point&lt;T, U&gt; {\n&nbsp; &nbsp; x: T,\n&nbsp; &nbsp; y: U,\n}\n\nfn main() {\n&nbsp; &nbsp; let both_integer = Point::&lt;u32, u32&gt; { x: 5, y: 10 };\n&nbsp; &nbsp; let both_float = Point::&lt;f32, f32&gt; { x: 1.0, y: 4.0 };\n&nbsp; &nbsp; let integer_and_float = Point::&lt;u32, f32&gt; { x: 5, y: 4.0 };\n}\n</code></pre><p>æ³¨æ„ï¼Œä½¿ç”¨æ—¶æä¾›ç±»å‹å‚æ•°ä¿¡æ¯ç”¨çš„æ˜¯<code>::&lt;&gt;</code>ï¼Œè€Œå®šä¹‰ç±»å‹å‚æ•°çš„æ—¶å€™åªç”¨åˆ°<code>&lt;&gt;</code>ï¼Œæ³¨æ„å®ƒä»¬çš„åŒºåˆ«ã€‚RustæŠŠå®šä¹‰å’Œä½¿ç”¨ä¸¤ä¸ªåœ°æ–¹é€šè¿‡è¯­æ³•æ˜ç¡®åœ°åŒºåˆ†å¼€äº†ï¼Œè€Œæœ‰çš„è¯­è¨€å¹¶æ²¡æœ‰åŒºåˆ†è¿™ä¸¤ä¸ªåœ°æ–¹ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¼šä½“ä¼šåˆ°ï¼Œç±»å‹å‚æ•°å­˜åœ¨ä¸¤ä¸ªè¿‡ç¨‹ï¼Œ<strong>ä¸€ä¸ªæ˜¯å®šä¹‰æ—¶ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨æ—¶</strong>ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹çš„åŒºåˆ†å¾ˆé‡è¦ã€‚è¿™é‡Œæ‰€è°“çš„â€œä½¿ç”¨æ—¶â€ï¼Œä»ç„¶æ˜¯åœ¨ç¼–è¯‘æœŸè¿›è¡Œåˆ†æçš„ï¼Œä¹Ÿå°±æ˜¯åˆ†æä½ åœ¨ä»£ç çš„æŸä¸ªåœ°æ–¹ç”¨åˆ°äº†è¿™ä¸ªå¸¦ç±»å‹å‚æ•°çš„ç±»å‹ï¼Œç„¶åæŠŠè¿™ä¸ªå‚æ•°å…·ä½“åŒ–ï¼Œä»è€Œå½¢æˆä¸€ä¸ªæœ€ç»ˆçš„ç±»å‹ç‰ˆæœ¬ã€‚</p><p>æ¯”å¦‚ <code>Point&lt;T&gt;</code> ç±»å‹çš„å…·åŒ–ç±»å‹å¯èƒ½æ˜¯ <code>Point&lt;u32&gt;</code>ã€<code>Point&lt;f32&gt;</code> ç­‰ç­‰ï¼›<code>Point&lt;T, U&gt;</code> ç±»å‹çš„å…·åŒ–ç±»å‹å¯èƒ½æ˜¯ <code>Point&lt;u32, u32&gt;</code>ã€<code>Point&lt;u32, f32&gt;</code>ã€<code>Point&lt;f32, u32&gt;</code>ã€<code>Point&lt;f32, f32&gt;</code> ç­‰ç­‰ã€‚åˆ°åº•æœ‰å¤šå°‘ç§å…·åŒ–ç‰ˆæœ¬ï¼Œæ˜¯çœ‹ä½ åœ¨åé¢ä»£ç ä½¿ç”¨æ—¶ï¼Œä¼šç”¨åˆ°å¤šå°‘ç§ä¸åŒçš„å…·ä½“ç±»å‹ã€‚è¿™ä¸ªæ•°ç›®æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨å¸®æˆ‘ä»¬è®¡ç®—å±•å¼€çš„ã€‚</p><p>è¿™ç§åœ¨ç¼–è¯‘æœŸé—´å®Œæˆçš„ç±»å‹å±•å¼€æˆå…·ä½“ç‰ˆæœ¬çš„è¿‡ç¨‹ï¼Œè¢«å«åš<strong>ç¼–è¯‘æœŸå•æ€åŒ–ã€‚</strong>å•æ€åŒ–çš„æ„æ€å°±æ˜¯æŠŠå¤„äºæ··æ²ŒæœªçŸ¥çš„çŠ¶æ€å…·ä½“åŒ–åˆ°ä¸€ä¸ªå•ä¸€çš„çŠ¶æ€ã€‚</p><h3>åœ¨æ³›å‹ä¸Šåšimpl</h3><p>å½“ç±»å‹æ˜¯ä¸€ä¸ªæ³›å‹æ—¶ï¼Œè¦å¯¹å…¶è¿›è¡Œimplçš„è¯ï¼Œéœ€è¦å¤„ç†ç±»å‹å‚æ•°ï¼Œå½¢å¼ç›¸æ¯”äºæˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/720991\">ç¬¬ 5 è®²</a>è®²åˆ°çš„impl ç»“æ„ä½“ï¼Œæœ‰ä¸€ç‚¹å˜åŒ–ã€‚è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨  <code>Point&lt;T&gt;</code> ä¸¾ä¾‹ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n&nbsp; &nbsp; x: T,\n&nbsp; &nbsp; y: T,\n}\n\nimpl&lt;T&gt; Point&lt;T&gt; {        // æ³¨æ„è¿™ä¸€è¡Œ\n&nbsp; &nbsp; fn play(n: T) {}      // æ³¨æ„è¿™ä¸€è¡Œ\n}\n</code></pre><p>åœ¨å¯¹ <code>Point&lt;T&gt;</code> åš impl çš„æ—¶å€™ï¼Œéœ€è¦åœ¨ impl åé¢åŠ ä¸€ä¸ª <code>&lt;T&gt;</code>ï¼Œè¡¨ç¤ºåœ¨impl çš„ block ä¸­å®šä¹‰ç±»å‹å‚æ•°Tï¼Œä¾›impl blockä¸­çš„å…ƒç´ ä½¿ç”¨ï¼Œè¿™äº›å…ƒç´ åŒ…æ‹¬ï¼š <code>impl&lt;T&gt; Point&lt;T&gt;</code> é‡Œ <code>Point&lt;T&gt;</code> ä¸­çš„Tå’Œæ•´ä¸ª impl çš„èŠ±æ‹¬å·bodyä¸­çš„ä»£ç ï¼Œå¦‚ <code>play()</code> å‡½æ•°çš„å‚æ•°å°±ç”¨åˆ°äº†è¿™ä¸ªTã€‚</p><p>æœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼š<code>struct Point&lt;T&gt;</code> é‡Œ <code>Point&lt;T&gt;</code> ä¸­çš„ T æ˜¯å®šä¹‰ç±»å‹å‚æ•°Tï¼Œ<code>impl&lt;T&gt; Point&lt;T&gt;</code> ä¸­çš„ <code>Point&lt;T&gt;</code> ä¸­çš„Tæ˜¯ä½¿ç”¨ç±»å‹å‚æ•°Tï¼Œè¿™ä¸ªTæ˜¯åœ¨implåé¢é‚£ä¸ªå°–æ‹¬å·ä¸­å®šä¹‰çš„ã€‚</p><p>åœ¨å¯¹æ³›å‹åšäº† impl åï¼Œå¯¹å…¶æŸä¸€ä¸ªå…·åŒ–ç±»å‹ç»§ç»­åš impl ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n&nbsp; &nbsp; x: T,\n&nbsp; &nbsp; y: T,\n}\n\nimpl&lt;T&gt; Point&lt;T&gt; {\n&nbsp; &nbsp; fn play(n: T) {}\n}\n\nimpl Point&lt;u32&gt; {      // è¿™é‡Œï¼Œå¯¹å…·åŒ–ç±»å‹ Point&lt;u32&gt; ç»§ç»­åš impl\n&nbsp; &nbsp; fn doit() {}\n}\n</code></pre><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“åœºæ™¯ä¸­çš„ç±»å‹å‚æ•°çš„ä½¿ç”¨ã€‚</p><h3>æšä¸¾ä¸­çš„ç±»å‹å‚æ•°</h3><p>å‰é¢è®²è¿‡ï¼Œæšä¸¾çš„å˜ä½“å¯ä»¥æŒ‚è½½ä»»æ„å…¶ä»–ç±»å‹ä½œä¸ºè´Ÿè½½ã€‚å› æ­¤æ¯ä¸ªè´Ÿè½½çš„ä½ç½®ï¼Œéƒ½å¯ä»¥å‡ºç°ç±»å‹å‚æ•°ã€‚æ¯”å¦‚æœ€å¸¸è§çš„ä¸¤ä¸ªæšä¸¾ï¼Œ<code>Option&lt;T&gt;</code> ä¸ <code>Result&lt;T, E&gt;</code>ï¼Œå°±æ˜¯æ³›å‹ã€‚</p><p><code>Option&lt;T&gt;</code> ç”¨æ¥è¡¨ç¤ºæœ‰æˆ–æ— ã€‚</p><pre><code class=\"language-plain\">enum Option&lt;T&gt; {\n    Some(T),\n    None,\n}\n</code></pre><p><code>Result&lt;T, E&gt;</code> ç”¨æ¥è¡¨ç¤ºç»“æœï¼Œæ­£ç¡®æˆ–é”™è¯¯ã€‚Okå˜ä½“å¸¦ç±»å‹å‚æ•°Tï¼ŒErrå˜ä½“å¸¦ç±»å‹å‚æ•°Eã€‚</p><pre><code class=\"language-plain\">enum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre><p>æˆ‘ä»¬åé¢ä¼šè¯¦ç»†é˜è¿° <code>Option&lt;T&gt;</code> å’Œ <code>Result&lt;T, E&gt;</code> çš„ç”¨æ³•ã€‚</p><p>ç°åœ¨å†çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„æšä¸¾ä¸­å¸¦ç±»å‹å‚æ•°çš„ä¾‹å­ã€‚</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nenum Aaa&lt;T, U&gt; {\n    V1(Point&lt;T&gt;),\n    V2(Vec&lt;U&gt;),\n}\n</code></pre><p>æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ï¼Œæšä¸¾ <code>Aaa&lt;T, U&gt;</code> çš„å˜ä½“ V1 å¸¦äº†ä¸€ä¸ª <code>Point&lt;T&gt;</code> çš„è´Ÿè½½ï¼Œå˜ä½“V2å¸¦äº†ä¸€ä¸ª <code>Vec&lt;U&gt;</code> çš„è´Ÿè½½ã€‚ç”±äºå‡ºç°äº†ä¸¤ä¸ªç±»å‹å‚æ•°Tå’ŒUï¼Œæ‰€ä»¥éœ€è¦åœ¨Aaaåé¢çš„å°–æ‹¬å·é‡Œå®šä¹‰è¿™ä¸¤ä¸ªç±»å‹å‚æ•°ã€‚</p><p>å®é™…ä¸Šï¼Œç±»å‹å‚æ•°ä¹Ÿæ˜¯ä¸€ç§å¤ç”¨ä»£ç çš„æ–¹å¼ï¼Œå¯ä»¥è®©å†™å‡ºçš„ä»£ç æ›´ç´§å‡‘ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“çš„åº”ç”¨åœºæ™¯ã€‚</p><h3>å‡½æ•°ä¸­çš„ç±»å‹å‚æ•°</h3><p>éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šå¾ˆå¤šä¸åŒçš„ç±»å‹ï¼Œå…¶å®å®ƒä»¬å®ç°æŸä¸ªé€»è¾‘æ—¶ï¼Œé€»è¾‘æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚å› æ­¤å¦‚æœæ²¡æœ‰ç±»å‹å‚æ•°ï¼Œå°±å¾—å¯¹æ¯ä¸ªå…·ä½“çš„ç±»å‹é‡æ–°å®ç°ä¸€æ¬¡åŒæ ·çš„é€»è¾‘ï¼Œè¿™æ ·å°±æ˜¾å¾—ä»£ç å¾ˆè‡ƒè‚¿ã€‚é‡å¤çš„ä»£ç ä¹Ÿä¸å¥½ç»´æŠ¤ï¼Œå®¹æ˜“å‡ºé”™ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">struct PointU32 {\n&nbsp; &nbsp; x: u32,\n&nbsp; &nbsp; y: u32,\n}\n\nstruct PointF32 {\n&nbsp; &nbsp; x: f32,\n&nbsp; &nbsp; y: f32,\n}\n\nfn print_u32(p: PointU32) {\n&nbsp; &nbsp; println!(\"Point {}, {}\", p.x, p.y);\n}\n\nfn print_f32(p: PointF32) {\n&nbsp; &nbsp; println!(\"Point {}, {}\", p.x, p.y);\n}\n\nfn main() {\n&nbsp; &nbsp; let p = PointU32 {x: 10, y: 20};\n&nbsp; &nbsp; print_u32(p);\n\n&nbsp; &nbsp; let p = PointF32 {x: 10.2, y: 20.4};\n&nbsp; &nbsp; print_f32(p);\n}\n</code></pre><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ç±»å‹å‚æ•°ï¼Œé‚£å°±å¾—é’ˆå¯¹ä¸åŒçš„å­—æ®µç±»å‹ï¼ˆu32ï¼Œf32ï¼‰åˆ†åˆ«å®šä¹‰ç»“æ„ä½“ï¼ˆPointU32ï¼ŒPointF32ï¼‰å’Œå¯¹åº”çš„æ‰“å°å‡½æ•°ï¼ˆprint_u32ï¼Œprint_f32ï¼‰ï¼Œå¹¶åˆ†åˆ«è°ƒç”¨ã€‚</p><p>è€Œæœ‰äº†ç±»å‹å‚æ•°çš„è¯ï¼Œè¿™æ ·çš„éœ€æ±‚ä»£ç åªéœ€è¦å†™ä¸€ä»½ï¼Œè®©ç¼–è¯‘å™¨æ¥å¸®æˆ‘ä»¬åˆ†æåˆ°æ—¶å€™è¦åº”ç”¨åˆ°å¤šå°‘ç§ä¸åŒçš„ç±»å‹ä¸Šã€‚</p><p>ä¸Šé¢çš„ä»£ç å¯ä»¥ä¼˜åŒ–æˆè¿™æ ·ï¼š</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n&nbsp; &nbsp; x: T,\n&nbsp; &nbsp; y: T,\n}\n\nfn print&lt;T: std::fmt::Display&gt;(p: Point&lt;T&gt;) {\n&nbsp; &nbsp; println!(\"Point {}, {}\", p.x, p.y);\n}\n\nfn main() {\n&nbsp; &nbsp; let p = Point {x: 10, y: 20};\n&nbsp; &nbsp; print(p);\n\n&nbsp; &nbsp; let p = Point {x: 10.2, y: 20.4};\n&nbsp; &nbsp; print(p);\n}\n</code></pre><p>æ˜¯ä¸æ˜¯æ¸…çˆ½å¤šäº†ï¼</p><p>å®é™…ä¸Šï¼Œæ¸…çˆ½åªæ˜¯æˆ‘ä»¬çœ‹åˆ°çš„æ ·å­ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼ŒRustç¼–è¯‘å™¨ä¼šå¸®åŠ©æˆ‘ä»¬æŠŠè¿™ç§æ³›å‹ä»£ç å±•å¼€æˆå‰é¢é‚£ä¸ªç¤ºä¾‹çš„æ ·å­ã€‚è¿™ç§è„æ´»ç´¯æ´»ï¼ŒRustç¼–è¯‘å™¨å¸®æˆ‘ä»¬å®Œæˆäº†ã€‚</p><p>ç»†å¿ƒçš„ä½ å¯èƒ½å‘ç°äº†ï¼Œprintå‡½æ•°çš„ç±»å‹å‚æ•°åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œå¤šäº†ä¸€ä¸ªä¸œè¥¿ã€‚</p><pre><code class=\"language-plain\">fn print&lt;T: std::fmt::Display&gt;(p: Point&lt;T&gt;) {\n</code></pre><p>è¿™é‡Œ <code>T: std::fmt::Display</code> çš„æ„æ€æ˜¯è¦æ±‚ T æ»¡è¶³æŸäº›æ¡ä»¶/çº¦æŸã€‚è¿™é‡Œå…·ä½“æ¥è¯´å°±æ˜¯ T è¦æ»¡è¶³å¯ä»¥è¢«æ‰“å°çš„æ¡ä»¶ã€‚å› ä¸ºæˆ‘ä»¬è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯æŠŠ x å’Œ y åˆ†é‡æ‰“å°å‡ºæ¥ï¼Œé‚£ä¹ˆå®ƒç¡®å®è¦èƒ½è¢«æ‰“å°æ‰è¡Œï¼Œæ¯”å¦‚å¾—èƒ½è½¬æ¢æˆäººç±»å¯è§çš„æŸç§æ ¼å¼ã€‚</p><p>å…³äºè¿™ç§çº¦æŸï¼Œæˆ‘ä»¬åé¢ä¼šè¯¦ç»†è®²è¿°ã€‚</p><h3>æ–¹æ³•ä¸­çš„ç±»å‹å‚æ•°</h3><p>ç»“æ„ä½“ä¸­å¯ä»¥æœ‰ç±»å‹å‚æ•°ï¼Œå‡½æ•°ä¸­ä¹Ÿå¯ä»¥æœ‰ç±»å‹å‚æ•°ï¼Œå®ƒä»¬ç»„åˆèµ·æ¥ï¼Œæ–¹æ³•ä¸Šå½“ç„¶ä¹Ÿå¯ä»¥æœ‰ç±»å‹å‚æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre><code class=\"language-plain\">struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nimpl&lt;T&gt; Point&lt;T&gt; {          // åœ¨implåå®šä¹‰impl blockä¸­è¦ç”¨åˆ°çš„ç±»å‹å‚æ•°\n    fn x(&amp;self) -&gt; &amp;T {     // è¿™é‡Œï¼Œåœ¨æ–¹æ³•çš„è¿”å›å€¼ä¸Šä½¿ç”¨äº†è¿™ä¸ªç±»å‹å‚æ•°\n        &amp;self.x\n    }\n}\n\nfn main() {\n    let p = Point { x: 5, y: 10 };\n    println!(\"p.x = {}\", p.x());\n}\n// è¾“å‡º \np.x = 5\n</code></pre><p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>Point&lt;T&gt;</code> çš„æ–¹æ³• <code>x()</code> çš„è¿”å›å€¼ç±»å‹å°±æ˜¯ &amp;Tï¼Œä½¿ç”¨åˆ°äº† <code>impl&lt;T&gt;</code> è¿™é‡Œå®šä¹‰çš„ç±»å‹å‚æ•°Tã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ç»§ç»­çœ‹æ›´å¤æ‚çš„å†…å®¹ï¼Œæ–¹æ³•ä¸­çš„ç±»å‹å‚æ•°å’Œç»“æ„ä½“ä¸­çš„ç±»å‹å‚æ•°å¯ä»¥ä¸åŒã€‚</p><pre><code class=\"language-plain\">struct Point&lt;X1, Y1&gt; {\n&nbsp; &nbsp; x: X1,\n&nbsp; &nbsp; y: Y1,\n}\n\n// è¿™é‡Œå®šä¹‰äº†impl blockä¸­å¯ä»¥ä½¿ç”¨çš„ç±»å‹å‚æ•°X3, Y3ï¼Œ\nimpl&lt;X3, Y3&gt; Point&lt;X3, Y3&gt; {\n&nbsp; &nbsp; // è¿™é‡Œå•ç‹¬ä¸ºmixupæ–¹æ³•å®šä¹‰äº†ä¸¤ä¸ªæ–°çš„ç±»å‹å‚æ•° X2, Y2\n&nbsp; &nbsp; // äºæ˜¯åœ¨mixupæ–¹æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨4ä¸ªç±»å‹å‚æ•°ï¼šX3, Y3, X2, Y2\n&nbsp; &nbsp; fn mixup&lt;X2, Y2&gt;(self, other: Point&lt;X2, Y2&gt;) -&gt; Point&lt;X3, Y2&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; Point {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x: self.x,\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y: other.y,\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; }\n}\n\nfn main() {\n&nbsp; &nbsp; let p1 = Point { x: 5, y: 10.4 };\n&nbsp; &nbsp; let p2 = Point { x: \"Hello\", y: 'c' };\n\n&nbsp; &nbsp; let p3 = p1.mixup(p2);\n\n&nbsp; &nbsp; println!(\"p3.x = {}, p3.y = {}\", p3.x, p3.y);\n}\n\n// è¾“å‡º \np3.x = 5, p3.y = c\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ <code>Point&lt;X3, Y3&gt;</code> çš„æ–¹æ³• <code>mixup()</code> ä¸Šæ–°å®šä¹‰äº†ä¸¤ä¸ªç±»å‹å‚æ•°X2ã€Y2ï¼Œäºæ˜¯åœ¨ <code>mixup()</code> æ–¹æ³•ä¸­ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨4ä¸ªç±»å‹å‚æ•°ï¼šX2ã€Y2ã€X3ã€Y3ã€‚ä½ å¯ä»¥å“å‘³ä¸€ä¸‹è¿™ä¸ªç¤ºä¾‹ï¼Œä¸è¿‡è¿™ç§å¤æ‚æƒ…å†µï¼Œç°åœ¨çš„ä½ åªéœ€è¦äº†è§£å°±å¯ä»¥äº†ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥èŠä¸€èŠRusté‡Œçš„ç±»å‹ä½“ç³»æ„å»ºæ–¹æ³•ã€‚</p><h2>ç±»å‹ä½“ç³»æ„å»ºæ–¹æ³•</h2><p>ç±»å‹ä½“ç³»æ„å»ºæŒ‡çš„æ˜¯å¦‚ä½•ä»æœ€åº•å±‚çš„å°ç –å—å¼€å§‹ï¼Œé€šè¿‡å°è£…ã€ç»„åˆã€é›†æˆï¼Œæœ€åä¿®å»ºæˆä¸€åº§ç±»å‹ä¸Šçš„æ‘©å¤©å¤§æ¥¼ã€‚åœ¨Rusté‡Œï¼Œä¸»è¦æœ‰å››å¤§åŸºç¡€è®¾æ–½å‚ä¸è¿™ä¸ªæ­å»ºçš„è¿‡ç¨‹ã€‚</p><ul>\n<li>struct ç»“æ„ä½“</li>\n<li>enum æšä¸¾</li>\n<li>æ´‹è‘±ç»“æ„</li>\n<li>type å…³é”®å­—</li>\n</ul><h3>structå’Œenum</h3><p>structæ˜¯Rusté‡ŒæŠŠç®€å•ç±»å‹ç»„åˆèµ·æ¥çš„ä¸»è¦ç»“æ„ã€‚structé‡Œçš„å­—æ®µå¯ä»¥æ˜¯åŸºç¡€ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç»“æ„ä½“æˆ–æšä¸¾ç­‰å¤åˆç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥ä¸€å±‚ä¸€å±‚å¾€ä¸Šå¥—ã€‚ç»“æ„ä½“structè¡¨è¾¾çš„æ˜¯ä¸€ç§å…ƒç´ é—´åŒæ—¶èµ·ä½œç”¨çš„ç»“æ„ã€‚</p><p>è€Œæšä¸¾enumè¡¨è¾¾çš„æ˜¯ä¸€ç§å…ƒç´ é—´åœ¨ä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ç§å…ƒç´ èµ·ä½œç”¨çš„ç»“æ„ã€‚å› æ­¤æšä¸¾ç±»å‹ç‰¹åˆ«é€‚åˆåšé…ç½®å’Œç±»å‹èšåˆä¹‹ç±»çš„å·¥ä½œã€‚</p><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„ç»¼åˆç¤ºä¾‹ï¼Œå®ƒæ˜¯å¯¹æŸä¸ªå­¦æ ¡çš„æ•°å­¦è¯¾ç¨‹å»ºæ¨¡çš„å±‚çº§æ¨¡å‹ã€‚</p><pre><code class=\"language-plain\">struct Point(u32, u32);  // å®šä¹‰ç‚¹\n\nstruct Rectangle {  // é•¿æ–¹å½¢ç”±ä¸¤ä¸ªç‚¹å†³å®š\n  p1: Point,\n  p2: Point,\n}\n\nstruct Triangle(Point, Point, Point);  // ä¸‰è§’å½¢ç”±ä¸‰ä¸ªç‚¹ç»„æˆ\n\nstruct Circle(Point, u32);  // åœ†ç”±ç‚¹å’ŒåŠå¾„ç»„æˆ\n\nenum Shape {   // ç”±æšä¸¾æŠŠé•¿æ–¹å½¢ï¼Œä¸‰è§’å½¢å’Œåœ†å½¢èšåˆåœ¨ä¸€èµ·\n  Rectangle(Rectangle),\n  Triangle(Triangle),\n  Circle(Circle),\n}\n\nstruct Axes;   // å®šä¹‰åæ ‡\n\nstruct Geometry {    // å‡ ä½•å­¦ç”±å½¢çŠ¶å’Œåæ ‡ç»„æˆ\n  shape: Shape,\n  axes: Axes,\n}\n\nstruct Algebra;      // å®šä¹‰ä»£æ•°\n\nenum Level {         // å®šä¹‰å­¦æ ¡çš„çº§åˆ«\n  Elementary,        // å°å­¦\n  Secondary,         // åˆä¸­\n  High,              // é«˜ä¸­\n}\n\nenum Course {          // æ•°å­¦è¦å­¦ä¹ å‡ ä½•å’Œä»£æ•°ï¼Œç”±æšä¸¾æ¥èšåˆ\n  Geometry(Geometry),\n  Algebra(Algebra),\n}\n\nstruct MathLesson {      // å®šä¹‰æ•°å­¦è¯¾ç¨‹ï¼ŒåŒ…æ‹¬æ•°å­¦çš„ç§‘ç›®å’Œçº§åˆ«\n  math: Course,\n  level: Level,\n}\n</code></pre><p>è¯·æ ¹æ®æ³¨é‡Šè®¤çœŸä½“ä¼šå…¶ä¸­ç±»å‹çš„å±‚çº§ç»“æ„ã€‚ä½ ç”šè‡³å¯ä»¥è¯•ç€å»ç¼–è¯‘ä¸€ä¸‹ä¸Šè¿°ä»£ç ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å¯ä»¥ç¼–è¯‘é€šè¿‡ã€‚</p><p><span class=\"reference\">å·å·å‘Šè¯‰ä½ ç­”æ¡ˆï¼šæ˜¯å¯ä»¥é€šè¿‡çš„ï¼</span></p><h3>newtype</h3><p>ç»“æ„ä½“è¿˜æœ‰ä¸€ç§å¸¸è§çš„å°è£…æ–¹æ³•ï¼Œé‚£å°±æ˜¯ç”¨å•å…ƒç´ çš„å…ƒç»„ç»“æ„ä½“ã€‚æ¯”å¦‚å®šä¹‰ä¸€ä¸ªåˆ—è¡¨ç±»å‹ <code>struct List(Vec&lt;u8&gt;);</code>ã€‚å®ƒå®é™…å°±æ˜¯ <code>Vec&lt;u8&gt;</code> ç±»å‹çš„ä¸€ä¸ªæ–°å°è£…ï¼Œç›¸å½“äºç»™é‡Œé¢åŸæ¥é‚£ç§ç±»å‹å–äº†ä¸€ä¸ªæ–°åå­—ï¼ŒåŒæ—¶ä¹ŸæŠŠåŸç±»å‹çš„å±æ€§å’Œæ–¹æ³•ç­‰å±è”½èµ·æ¥äº†ã€‚</p><p>æœ‰æ—¶ï¼Œä½ è¿˜å¯ä»¥çœ‹åˆ°æ²¡æœ‰å…·åŒ–ç±»å‹å‚æ•°çš„æƒ…å½¢ã€‚</p><pre><code class=\"language-plain\">struct List&lt;T&gt;(Vec&lt;T&gt;);\n</code></pre><p>è¿™ç§æ¨¡å¼éå¸¸å¸¸è§ï¼Œäºæ˜¯ä¸šç•Œç»™å®ƒå–äº†ä¸ªåå­—ï¼Œå«åš newtype æ¨¡å¼ï¼Œæ„æ€æ˜¯ç”¨æ–°çš„ç±»å‹åå­—æ›¿æ¢é‡Œé¢åŸæ¥é‚£ä¸ªç±»å‹åå­—ã€‚</p><h3>æ´‹è‘±ç»“æ„</h3><p>Rustä¸­çš„ç±»å‹è¿˜æœ‰å¦å¤–ä¸€ç§æ„å»ºæ–¹æ³•â€”â€”æ´‹è‘±ç»“æ„ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼Œæ³¨æ„ä»£ç é‡Œçš„typeå…³é”®å­—åœ¨è¿™é‡Œçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªç±»å‹é‡å‘½åï¼Œå–äº†ä¸€ä¸ªæ›´çŸ­çš„åå­—ã€‚</p><pre><code class=\"language-plain\">// ä½ å¯ä»¥è¯•ç€ç¼–è¯‘è¿™æ®µä»£ç \nuse std::collections::HashMap;\n\ntype AAA = HashMap&lt;String, Vec&lt;u8&gt;&gt;;\ntype BBB = Vec&lt;AAA&gt;;\ntype CCC = HashMap&lt;String, BBB&gt;;\ntype DDD = Vec&lt;CCC&gt;;\ntype EEE = HashMap&lt;String, DDD&gt;;\n</code></pre><p>æœ€åEEEå±•å¼€å°±æ˜¯è¿™æ ·çš„ï¼š</p><pre><code class=\"language-plain\">HashMap&lt;String, Vec&lt;HashMap&lt;String, Vec&lt;HashMap&lt;String, Vec&lt;u8&gt;&gt;&gt;&gt;&gt;&gt;;\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå°–æ‹¬å·çš„å±‚æ•°å¾ˆå¤šï¼Œåƒæ´‹è‘±ä¸€æ ·ä¸€å±‚ä¸€å±‚çš„ï¼Œå› æ­¤å«æ´‹è‘±ç±»å‹ç»“æ„ã€‚åªè¦ä½ å¼€å¿ƒï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªå±‚æ¬¡æ— é™æ‰©å±•ä¸‹å»ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªç»“åˆ newtype å’Œ struct çš„æ›´å¤æ‚çš„ç¤ºä¾‹ã€‚</p><pre><code class=\"language-plain\">use std::collections::HashMap;\n\nstruct AAA(Vec&lt;u8&gt;);\nstruct BBB {\n&nbsp; hashmap: HashMap&lt;String, AAA&gt;\n}\nstruct CCC(BBB);\ntype DDD = Vec&lt;CCC&gt;;\ntype EEE = HashMap&lt;String, Vec&lt;DDD&gt;&gt;;\n\næœ€åï¼ŒEEEå±•å¼€å°±ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼ˆä»…ç¤ºæ„ï¼Œæ— æ³•ç¼–è¯‘é€šè¿‡ï¼‰\nHashMap&lt;String, Vec&lt;Vec&lt;CCC(BBB {hashmap: HashMap&lt;String, AAA&lt;Vec&lt;u8&gt;&gt;&gt;})&gt;&gt;&gt;\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ´‹è‘±ç»“æ„åœ¨åµŒå¥—å±‚çº§å¤šäº†ä¹‹åï¼Œå±•å¼€æ˜¯ç›¸å½“å¤æ‚çš„ã€‚</p><h3>typeå…³é”®å­—</h3><p>typeå…³é”®å­—å¾ˆé‡è¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨æ´‹è‘±ç»“æ„è¡¨ç¤ºå¤ªé•¿äº†ä¹‹åï¼ŒæŠŠä¸€å¤§ä¸²ç±»å‹çš„è¡¨è¾¾ç®€åŒ–æˆä¸€ä¸ªç®€çŸ­çš„åå­—ã€‚åœ¨Rustä¸­ä½¿ç”¨typeå…³é”®å­—ï¼Œå¯ä»¥ä½¿ç±»å‹å¤§å¦çš„æ„å»ºè¿‡ç¨‹å˜å¾—æ¸…æ™°å¯æ§ã€‚</p><p>typeå…³é”®å­—è¿˜å¯ä»¥å¤„ç†æ³›å‹çš„æƒ…å†µï¼Œæ¯”å¦‚ï¼š</p><pre><code class=\"language-plain\">type MyType&lt;T&gt; = HashMap&lt;String, Vec&lt;HashMap&lt;String, Vec&lt;HashMap&lt;String, Vec&lt;T&gt;&gt;&gt;&gt;&gt;&gt;;\n</code></pre><p>å› ä¸ºæœ€é‡Œé¢é‚£ä¸ªæ˜¯ç±»å‹ <code>Vec&lt;T&gt;</code>ï¼ŒT ç±»å‹å‚æ•°è¿˜åœ¨ã€‚å› æ­¤ç»™è¿™ä¸ªæ´‹è‘±ç±»å‹é‡å‘½åçš„æ—¶å€™ï¼Œéœ€è¦æŠŠè¿™ä¸ª T å‚æ•°å¸¦ä¸Šï¼Œäºæ˜¯å°±å˜æˆäº† <code>MyType&lt;T&gt;</code>ã€‚</p><p>è¿™ç§å†™æ³•åœ¨æ ‡å‡†åº“é‡Œå¾ˆå¸¸è§ï¼Œæœ€ä½³ç¤ºä¾‹å°±æ˜¯å…³äºå„ç§ <code>Result*</code> çš„å®šä¹‰ã€‚</p><p>åœ¨ <code>std::io</code> æ¨¡å—é‡Œï¼Œå–äº†ä¸€ä¸ªä¸ <code>std::result::Result&lt;T, E&gt;</code> åŒåçš„ Result ç±»å‹ï¼ŒæŠŠ <code>std::result::Result&lt;T, E&gt;</code> å®šä¹‰ç®€åŒ–äº†ï¼Œå…·åŒ–å…¶Errorç±»å‹ä¸º <code>std::io::Error</code>ï¼ŒåŒæ—¶ä»ä¿ç•™äº†ç¬¬ä¸€ä¸ªç±»å‹å‚æ•° Tã€‚äºæ˜¯å¾—åˆ°äº† <code>Result&lt;T&gt;</code>ã€‚</p><pre><code class=\"language-plain\">pub type Result&lt;T&gt; = Result&lt;T, Error&gt;;\n</code></pre><p>åˆšå¼€å§‹æ¥è§¦Rustçš„æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šå¯¹è¿™ç§è¡¨è¾¾æ–¹å¼äº§ç”Ÿç–‘æƒ‘ï¼Œå…¶å®é“ç†å°±åœ¨è¿™é‡Œã€‚ä»¥åä½ åœ¨é˜…è¯»Rustç”Ÿæ€ä¸­å„ç§åº“çš„æºç æ—¶ï¼Œä¹Ÿä¼šç»å¸¸é‡åˆ°è¿™ç§å°è£…æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¹ æƒ¯å®ƒã€‚</p><p>å…³äºè¿™ç§å®šä¹‰æ›´å¤šçš„èµ„æ–™å‚è§ï¼š</p><p><a href=\"https://doc.rust-lang.org/std/result/enum.Result.html\">https://doc.rust-lang.org/std/result/enum.Result.html</a><br>\n<a href=\"https://doc.rust-lang.org/std/io/type.Result.html\">https://doc.rust-lang.org/std/io/type.Result.html</a><br>\n<a href=\"https://doc.rust-lang.org/std/io/struct.Error.html\">https://doc.rust-lang.org/std/io/struct.Error.html</a></p><h2>å°ç»“</h2><p><img src=\"https://static001.geekbang.org/resource/image/a8/db/a8b0ab1fabe5c6138f55d1effd4c7bdb.jpg?wh=1882x1480\" alt=\"\"></p><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å¯¹Rustä¸­ç±»å‹ç›¸å…³çš„çŸ¥è¯†åšäº†ä¸€ä¸ªä¸“é—¨çš„è®²è§£ã€‚ç°ä»£ç¼–ç¨‹è¯­è¨€çš„è¶‹åŠ¿æ˜¯è¶Šæ¥è¶Šå¼ºè°ƒç±»å‹åŒ–ï¼Œæ¯”å¦‚ TypeScriptã€Rustã€‚ä¸€ä¸ªæˆç†Ÿçš„ç±»å‹ç³»ç»Ÿå¯¹äºç¼–å†™å¥å£®çš„ç¨‹åºæ¥è¯´è‡³å…³é‡è¦ã€‚ç±»å‹å¯ä»¥çœ‹ä½œæ˜¯å¯¹å˜é‡å–å€¼ç©ºé—´çš„ä¸€ç§çº¦æŸã€‚</p><p>åœ¨Rustä¸­ï¼Œæœ‰å¾ˆå¤šå¯¹å¤šç§ç±»å‹åšç»Ÿä¸€å¤„ç†çš„éœ€æ±‚ï¼Œå› æ­¤å¼•å…¥äº†ç±»å‹å‚æ•°å’Œæ³›å‹çš„æ¦‚å¿µã€‚å®ƒä»¬å®é™…æ˜¯åœ¨ç±»å‹åŒ–é“è·¯ä¸Šçš„å¿…ç„¶é€‰æ‹©ï¼Œå› ä¸ºå•ä¸€çš„ç±»å‹ç¡®å®ä¸æ–¹ä¾¿ï¼Œæˆ–è€…ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ä½ è¦å…ˆå…‹æœå¯¹è¿™ç§å‚æ•°åŒ–è®¾è®¡çš„ç•æƒ§æ„Ÿï¼Œåªè¦èŠ±ä¸€äº›æ—¶é—´ç†Ÿæ‚‰è¿™èŠ‚è¯¾æˆ‘ä»¬æåˆ°çš„é‚£äº›å½¢å¼ï¼Œè¿™äº›æ¦‚å¿µå°±ä¸éš¾æŒæ¡ã€‚</p><p>ç„¶åï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬è¿˜è®²è§£äº†4ç§ç±»å‹ä½“ç³»å»ºæ¨¡æ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨åé¢çš„å®è·µè¿‡ç¨‹ä¸­æ…¢æ…¢åŠ æ·±ç†è§£ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¦‚æœä½ ç»™æŸä¸ªæ³›å‹å®ç°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆï¼Œè¿˜èƒ½ä¸ºå®ƒçš„ä¸€ä¸ªå…·åŒ–ç±»å‹å†å®ç°åŒæ ·çš„æ–¹æ³•å—ï¼Ÿ</p><p>æ¬¢è¿ä½ æŠŠæ€è€ƒåçš„ç»“æœåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p><h4>ã€ŠProgramming.with.Typesã€‹åŸæ–‡æ‘˜å½•</h4><p><img src=\"https://static001.geekbang.org/resource/image/e7/de/e7a9844641dd3fedeb43e5ce7d2558de.jpg?wh=1022x182\" alt=\"å›¾ç‰‡\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/03/e9/0315a018c95a61cd6d54bde9cace8ee9.jpg?wh=1114x126\" alt=\"å›¾ç‰‡\"><br>\n<img src=\"https://static001.geekbang.org/resource/image/50/6f/5005yy9ef73f713e299e5a322f301d6f.jpg?wh=1030x222\" alt=\"å›¾ç‰‡\"></p>","comments":[{"had_liked":false,"id":383400,"user_name":"å¤æ˜åœ°è§‰","can_delete":false,"product_type":"c1","uid":1528298,"ip_address":"ä¸­å›½å°æ¹¾","ucode":"31DA063A17FC27","user_header":"https://static001.geekbang.org/account/avatar/00/17/51/ea/d9a83bb3.jpg","comment_is_top":false,"comment_ctime":1698982456,"is_pvip":false,"replies":[{"id":139677,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699003209,"ip_address":"é‡åº†","comment_id":383400,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ€è€ƒé¢˜ï¼š&quot;ä¸ºæ³›å‹å®ç°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œèƒ½å¦å†ä¸ºå…·åŒ–ç±»å‹å®ç°ä¸€ä¸ªåŒåæ–¹æ³•&quot;ï¼Œå–å†³äºè¿™ä¸ªæ³›å‹èƒ½å¦è¡¨ç¤ºç›¸åº”çš„å…·åŒ–ç±»å‹ã€‚æ¯”å¦‚ä¸ºæ³›å‹ T å’Œ String å®ç°äº†ç›¸åŒçš„æ–¹æ³•ï¼Œç”±äº T æ²¡æœ‰æ–½åŠ ä»»ä½•çº¦æŸï¼Œå®ƒå¯ä»¥ä»£è¡¨ Stringã€‚é‚£ä¹ˆå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¯¹äºå…·åŒ–ç±»å‹ String æ¥è¯´ï¼Œè¦è°ƒç”¨å“ªä¸€ä¸ªå‘¢ï¼Ÿå› æ­¤ä¼šå‡ºç°æ­§ä¹‰ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼šæ–¹æ³•è¢«é‡å¤å®šä¹‰äº†ã€‚\n\nä½†å¦‚æœç»™æ³›å‹ T æ–½åŠ äº†ä¸€ä¸ª Copy çº¦æŸï¼Œè¦æ±‚ T å¿…é¡»å®ç°äº† Copy traitï¼Œé‚£ä¹ˆå°±ä¸ä¼šæŠ¥é”™äº†ï¼Œå› ä¸ºæ­¤æ—¶ T ä»£è¡¨ä¸äº† Stringï¼Œæ‰€ä»¥è°ƒç”¨æ–¹æ³•ä¸ä¼šå‡ºç°æ­§ä¹‰ã€‚ä½†å¦‚æœå†ä¸º i32 å®ç°ä¸€ä¸ªåŒåæ–¹æ³•å°±ä¼šæŠ¥é”™äº†ï¼Œå› ä¸º i32 å®ç°äº† Copyï¼Œå®ƒå¯ä»¥è¢« T è¡¨ç¤ºã€‚\n\nPSï¼šè€å¸ˆæˆ‘åœ¨ 06 è®²æäº†ä¸€ä¸ªé—®é¢˜ï¼Œä¹‹å‰åœ¨å­¦ Rust çš„æ—¶å€™å°±ä¸€ç›´å›°æ‰°ç€æˆ‘ï¼Œè¿˜éº»çƒ¦è€å¸ˆè§£ç­”ä¸€ä¸‹ã€‚","like_count":9,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630884,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699003209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":4017296,"avatar":"https://static001.geekbang.org/account/avatar/00/3d/4c/90/00336164.jpg","nickname":"çŸ¥è¶³","note":"","ucode":"27061A7B1C218F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653250,"discussion_content":"å¯¹äº T ä¸è‡ªå®šä¹‰ç±»å‹æ˜¯é€‚ç”¨çš„ï¼Œå¯¹äºTå’ŒStringä¸é€‚ç”¨äº†ï¼Œupstream crates may add a new impl of trait std::marker::Copy for type std::string::String in future versions","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1730471890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383399,"user_name":"ä¸€ä¸ªäººæ—…è¡Œ","can_delete":false,"product_type":"c1","uid":2555864,"ip_address":"åŒ—äº¬","ucode":"A708238B10B44B","user_header":"https://static001.geekbang.org/account/avatar/00/26/ff/d8/d48d6088.jpg","comment_is_top":false,"comment_ctime":1698981668,"is_pvip":false,"replies":[{"id":139671,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699001653,"ip_address":"é‡åº†","comment_id":383399,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"ä¸èƒ½ï¼Œç¼–è¯‘å™¨ä¼šæç¤ºduplicate definitions for XXXXXã€‚\nå¦‚æœæƒ³ä¸ºå…·åŒ–ç±»å‹å†å®ç°åŒæ ·çš„æ–¹æ³•ï¼Œåˆ™å¯ä»¥å®šä¹‰ä¸€ä¸ªtraitï¼Œç”¨å…·åŒ–ç±»å‹å®ç°è¿™ä¸ªtraitï¼Œæ¥è¾¾åˆ°&quot;ä¸ºå…·åŒ–ç±»å‹å†å®ç°åŒæ ·çš„æ–¹æ³•â€œçš„ç›®çš„ã€‚","like_count":5,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630875,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699001653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383685,"user_name":"-HedonğŸ­","can_delete":false,"product_type":"c1","uid":3176234,"ip_address":"æ¹–åŒ—","ucode":"FAE541E7A2B88F","user_header":"https://static001.geekbang.org/account/avatar/00/30/77/2a/0cd4c373.jpg","comment_is_top":false,"comment_ctime":1699447530,"is_pvip":false,"replies":[{"id":139936,"content":"å¾ˆæ£’","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699505407,"ip_address":"é‡åº†","comment_id":383685,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ€è€ƒé¢˜ï¼šæ ¸å¿ƒç‚¹å°±åœ¨äºä¸èƒ½ä¸ºåŒä¸€ä¸ªç±»å‹å®ç° 2 ä¸ªç›¸åŒå‡½æ•°ç­¾åçš„æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¼šå¼•èµ·æ–¹æ³•å†²çªã€‚\n\nç¼–è¯‘æŠ¥é”™å¦‚ä¸‹ï¼š\n\nerror[E0592]: duplicate definitions with name `print`\n  --&gt; examples&#47;generic.rs:7:5\n   |\n7  |     fn print(&amp;self) {\n   |     ^^^^^^^^^^^^^^^ duplicate definitions for `print`\n...\n13 |     fn print(&amp;self) {\n   |     --------------- other definition for `print`\n\n\næ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœ impl&lt;T&gt; åé¢çš„ T æ²¡æœ‰ä»»ä½•çš„çº¦æŸï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºä¸ºæ‰€æœ‰ç±»å‹çš„ T éƒ½å®ç°äº†æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ print()ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸èƒ½ä¸ºå…·åŒ–ç±»å‹å†æ¬¡å®ç° print() çš„ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™å°±äº§ç”Ÿäº†æ–¹æ³•å†²çªã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœ impl&lt;T: std::fmt:Display&gt; åé¢çš„ T æ˜¯æœ‰çº¦æŸçš„ï¼Œé‚£ä¹ˆå…¶å®åªä¸ºç¬¦åˆè¿™ä¸ªçº¦æŸçš„ç±»å‹å®ç°äº† print()ï¼Œå…¶ä½™ç±»å‹æ˜¯æ²¡æœ‰å®ç°çš„ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥ä¸ºå…¶ä½™å…·åŒ–ç±»å‹å®ç°ç›¸åŒçš„æ–¹æ³•çš„ã€‚\n\nå¦‚ï¼š\n\n```rust\nstruct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nstruct NotDisplay {\n    a: u32,\n}\n\nimpl&lt;T: std::fmt::Display&gt; Point&lt;T&gt; {\n    fn print(&amp;self) {\n        println!(&quot;Point: {}, {}&quot;, self.x, self.y);\n    }\n}\n\nimpl Point&lt;NotDisplay&gt; {\n    fn print(&amp;self) {\n        println!(&quot;not display&quot;);\n    }\n}\n```","like_count":3,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631403,"discussion_content":"å¾ˆæ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699505407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383397,"user_name":"Geek_de05b4","can_delete":false,"product_type":"c1","uid":2675374,"ip_address":"ä¸Šæµ·","ucode":"C88B30D2D79ADC","user_header":"","comment_is_top":false,"comment_ctime":1698980218,"is_pvip":false,"replies":[{"id":139670,"content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699001644,"ip_address":"é‡åº†","comment_id":383397,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"impl&lt;T: std::ops::Add&lt;Output = T&gt;&gt; Bar&lt;T&gt; {\n    fn plus(self, other: Bar&lt;T&gt;) -&gt; T {\n        self.value + other.value\n    }\n}\n\nimpl Bar&lt;u32&gt; {\n    fn plus(&amp;self, other: &amp;Bar&lt;u32&gt;) -&gt; u32 {\n        self.value + other.value\n    }\n}\n\n&#47;&#47;Output:\nerror[E0592]: duplicate definitions with name `plus`\n  --&gt; src&#47;main.rs:64:5\n   |\n64 |     fn plus(self, other: Bar&lt;T&gt;) -&gt; T {\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ duplicate definitions for `plus`\n...\n70 |     fn plus(&amp;self, other: &amp;Bar&lt;u32&gt;) -&gt; u32 {\n   |     --------------------------------------- other definition for `plus`\n\nä¸èƒ½","like_count":2,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630874,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699001644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383697,"user_name":"Noya","can_delete":false,"product_type":"c1","uid":1519230,"ip_address":"æµ™æ±Ÿ","ucode":"52EEB72E80BAF8","user_header":"https://static001.geekbang.org/account/avatar/00/17/2e/7e/a15b477c.jpg","comment_is_top":false,"comment_ctime":1699465229,"is_pvip":false,"replies":[{"id":139932,"content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2186062,"ctime":1699505252,"ip_address":"é‡åº†","comment_id":383697,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"æ€è€ƒé¢˜ï¼šé€šå¸¸æ˜¯ä¸èƒ½ï¼Œ ä½†æ˜¯å¯ä»¥é€šè¿‡ trait è¿›è¡Œç‰¹åŒ–","like_count":0,"discussions":[{"author":{"id":2186062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5b/4e/8e1f699e.jpg","nickname":"Mike Tang","note":"","ucode":"55775BCEDB5937","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":631399,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699505252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"é‡åº†","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383386,"user_name":"ä¼¯é˜³","can_delete":false,"product_type":"c1","uid":1596631,"ip_address":"åŒ—äº¬","ucode":"DBDC8735AA54AD","user_header":"https://static001.geekbang.org/account/avatar/00/18/5c/d7/3b92bb0d.jpg","comment_is_top":false,"comment_ctime":1698960775,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"å’ŒJavaçš„èŒƒå‹ç±»ä¼¼","like_count":1},{"had_liked":false,"id":395858,"user_name":"å¤","can_delete":false,"product_type":"c1","uid":1585570,"ip_address":"æµ™æ±Ÿ","ucode":"AD2B2D6A4E5CBF","user_header":"https://static001.geekbang.org/account/avatar/00/18/31/a2/16c3318d.jpg","comment_is_top":false,"comment_ctime":1732265578,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100626901,"comment_content":"let a = 9 + &#39;1&#39; as u8;\nç»“æœæ˜¯ 58,è®©æˆ‘å›°æƒ‘äº†:9+1 ç»“æœæ˜æ˜æ˜¯10,è¿™æ€ä¹ˆå°±58äº†.\nç„¶åå°±æƒ³:ä¸ºä»€ä¹ˆæ˜¯58è€Œä¸æ˜¯å…¶ä»–çš„å€¼,ç‰¹å¾æ˜¯è¿™ä¸ªæ•°å­—å°äº100,\né‚£ä¹ˆ&#39;1&#39; å°±æ˜¯ 58-9=49,æœ‰äº†ä¸€ä¸ªçŒœæƒ³&#39;1&#39; as u8 æ˜¯æŒ‡asciiç çš„1,è½¬ä¹‹åæ˜¯49, \nç„¶åå°±å»éªŒè¯,æŸ¥çœ‹ascii,æœç„¶&#39;1&#39;æ˜¯49.\n","like_count":0}]}