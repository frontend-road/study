{"id":99665,"title":"06 | 域名里有哪些门道？","content":"<p>在上一讲里，我们学习了HTTP协议使用的TCP/IP协议栈，知道了HTTP协议是运行在TCP/IP上的。</p><p>IP协议的职责是“网际互连”，它在MAC层之上，使用IP地址把MAC编号转换成了四位数字，这就对物理网卡的MAC地址做了一层抽象，发展出了许多的“新玩法”。</p><p>例如，分为A、B、C、D、E五种类型，公有地址和私有地址，掩码分割子网等。只要每个小网络在IP地址这个概念上达成一致，不管它在MAC层有多大的差异，都可以接入TCP/IP协议栈，最终汇合进整个互联网。</p><p>但接入互联网的计算机越来越多，IP地址的缺点也就暴露出来了，最主要的是它“对人不友好”，虽然比MAC的16进制数要好一点，但还是难于记忆和输入。</p><p>怎么解决这个问题呢？</p><p>那就“以其人之道还治其人之身”，在IP地址之上再来一次抽象，把数字形式的IP地址转换成更有意义更好记的名字，在字符串的层面上再增加“新玩法”。于是，DNS域名系统就这么出现了。</p><h2>域名的形式</h2><p>在第4讲曾经说过，域名是一个有层次的结构，是一串用“.”分隔的多个单词，最右边的被称为“顶级域名”，然后是“二级域名”，层级关系向左依次降低。</p><p>最左边的是主机名，通常用来表明主机的用途，比如“www”表示提供万维网服务、“mail”表示提供邮件服务，不过这也不是绝对的，名字的关键是要让我们容易记忆。</p><!-- [[[read_end]]] --><p>看一下极客时间的域名“time.geekbang.org”，这里的“org”就是顶级域名，“geekbang”是二级域名，“time”则是主机名。使用这个域名，DNS就会把它转换成相应的IP地址，你就可以访问极客时间的网站了。</p><p>域名不仅能够代替IP地址，还有许多其他的用途。</p><p>在Apache、Nginx这样的Web服务器里，域名可以用来标识虚拟主机，决定由哪个虚拟主机来对外提供服务，比如在Nginx里就会使用“server_name”指令：</p><pre><code>server {\n    listen 80;                       #监听80端口\n    server_name  time.geekbang.org;  #主机名是time.geekbang.org\n    ...\n}\n</code></pre><p>域名本质上还是个名字空间系统，使用多级域名就可以划分出不同的国家、地区、组织、公司、部门，每个域名都是独一无二的，可以作为一种身份的标识。</p><p>举个例子吧，假设A公司里有个小明，B公司里有个小强，于是他们就可以分别说是“小明.A公司”，“小强.B公司”，即使B公司里也有个小明也不怕，可以标记为“小明.B公司”，很好地解决了重名问题。</p><p>因为这个特性，域名也被扩展到了其他应用领域，比如Java的包机制就采用域名作为命名空间，只是它使用了反序。如果极客时间要开发Java应用，那么它的包名可能就是“org.geekbang.time”。</p><p>而XML里使用URI作为名字空间，也是间接使用了域名。</p><h2>域名的解析</h2><p>就像IP地址必须转换成MAC地址才能访问主机一样，域名也必须要转换成IP地址，这个过程就是“<strong>域名解析</strong>”。</p><p>目前全世界有几亿个站点，有几十亿网民，而每天网络上发生的HTTP流量更是天文数字。这些请求绝大多数都是基于域名来访问网站的，所以DNS就成了互联网的重要基础设施，必须要保证域名解析稳定可靠、快速高效。</p><p>DNS的核心系统是一个三层的树状、分布式服务，基本对应域名的结构：</p><ol>\n<li>根域名服务器（Root DNS Server）：管理顶级域名服务器，返回“com”“net”“cn”等顶级域名服务器的IP地址；</li>\n<li>顶级域名服务器（Top-level DNS Server）：管理各自域名下的权威域名服务器，比如com顶级域名服务器可以返回apple.com域名服务器的IP地址；</li>\n<li>权威域名服务器（Authoritative DNS Server）：管理自己域名下主机的IP地址，比如apple.com权威域名服务器可以返回www.apple.com的IP地址。</li>\n</ol><p><img src=\"https://static001.geekbang.org/resource/image/6b/f2/6b020454987543efdd1cf6ddec784bf2.png?wh=3000*1681\" alt=\"\"></p><p>在这里根域名服务器是关键，它必须是众所周知的，否则下面的各级服务器就无从谈起了。目前全世界共有13组根域名服务器，又有数百台的镜像，保证一定能够被访问到。</p><p>有了这个系统以后，任何一个域名都可以在这个树形结构里从顶至下进行查询，就好像是把域名从右到左顺序走了一遍，最终就获得了域名对应的IP地址。</p><p>例如，你要访问“www.apple.com”，就要进行下面的三次查询：</p><ol>\n<li>访问根域名服务器，它会告诉你“com”顶级域名服务器的地址；</li>\n<li>访问“com”顶级域名服务器，它再告诉你“apple.com”域名服务器的地址；</li>\n<li>最后访问“apple.com”域名服务器，就得到了“www.apple.com”的地址。</li>\n</ol><p>虽然核心的DNS系统遍布全球，服务能力很强也很稳定，但如果全世界的网民都往这个系统里挤，即使不挤瘫痪了，访问速度也会很慢。</p><p>所以在核心DNS系统之外，还有两种手段用来减轻域名解析的压力，并且能够更快地获取结果，基本思路就是“<strong>缓存</strong>”。</p><p>首先，许多大公司、网络运行商都会建立自己的DNS服务器，作为用户DNS查询的代理，代替用户访问核心DNS系统。这些“野生”服务器被称为“非权威域名服务器”，可以缓存之前的查询结果，如果已经有了记录，就无需再向根服务器发起查询，直接返回对应的IP地址。</p><p>这些DNS服务器的数量要比核心系统的服务器多很多，而且大多部署在离用户很近的地方。比较知名的DNS有Google的“8.8.8.8”，Microsoft的“4.2.2.1”，还有CloudFlare的“1.1.1.1”等等。</p><p>其次，操作系统里也会对DNS解析结果做缓存，如果你之前访问过“www.apple.com”，那么下一次在浏览器里再输入这个网址的时候就不会再跑到DNS那里去问了，直接在操作系统里就可以拿到IP地址。</p><p>另外，操作系统里还有一个特殊的“主机映射”文件，通常是一个可编辑的文本，在Linux里是“/etc/hosts”，在Windows里是“C:\\WINDOWS\\system32\\drivers\\etc\\hosts”，如果操作系统在缓存里找不到DNS记录，就会找这个文件。</p><p>有了上面的“野生”DNS服务器、操作系统缓存和hosts文件后，很多域名解析的工作就都不用“跋山涉水”了，直接在本地或本机就能解决，不仅方便了用户，也减轻了各级DNS服务器的压力，效率就大大提升了。</p><p>下面的这张图比较完整地表示了现在的DNS架构。</p><p><img src=\"https://static001.geekbang.org/resource/image/e5/ac/e51df3245609880641043af65bba94ac.png?wh=3000*1681\" alt=\"\"></p><p>在Nginx里有这么一条配置指令“resolver”，它就是用来配置DNS服务器的，如果没有它，那么Nginx就无法查询域名对应的IP，也就无法反向代理到外部的网站。</p><pre><code>resolver 8.8.8.8 valid=30s;  #指定Google的DNS，缓存30秒\n</code></pre><h2>域名的“新玩法”</h2><p>有了域名，又有了可以稳定工作的解析系统，于是我们就可以实现比IP地址更多的“新玩法”了。</p><p>第一种，也是最简单的，“重定向”。因为域名代替了IP地址，所以可以让对外服务的域名不变，而主机的IP地址任意变动。当主机有情况需要下线、迁移时，可以更改DNS记录，让域名指向其他的机器。</p><p>比如，你有一台“buy.tv”的服务器要临时停机维护，那你就可以通知DNS服务器：“我这个buy.tv域名的地址变了啊，原先是1.2.3.4，现在是5.6.7.8，麻烦你改一下。”DNS于是就修改内部的IP地址映射关系，之后再有访问buy.tv的请求就不走1.2.3.4这台主机，改由5.6.7.8来处理，这样就可以保证业务服务不中断。</p><p>第二种，因为域名是一个名字空间，所以可以使用bind9等开源软件搭建一个在内部使用的DNS，作为名字服务器。这样我们开发的各种内部服务就都用域名来标记，比如数据库服务都用域名“mysql.inner.app”，商品服务都用“goods.inner.app”，发起网络通信时也就不必再使用写死的IP地址了，可以直接用域名，而且这种方式也兼具了第一种“玩法”的优势。</p><p>第三种“玩法”包含了前两种，也就是基于域名实现的负载均衡。</p><p>这种“玩法”也有两种方式，两种方式可以混用。</p><p>第一种方式，因为域名解析可以返回多个IP地址，所以一个域名可以对应多台主机，客户端收到多个IP地址后，就可以自己使用轮询算法依次向服务器发起请求，实现负载均衡。</p><p>第二种方式，域名解析可以配置内部的策略，返回离客户端最近的主机，或者返回当前服务质量最好的主机，这样在DNS端把请求分发到不同的服务器，实现负载均衡。</p><p>前面我们说的都是可信的DNS，如果有一些不怀好意的DNS，那么它也可以在域名这方面“做手脚”，弄一些比较“恶意”的“玩法”，举两个例子：</p><ul>\n<li>“域名屏蔽”，对域名直接不解析，返回错误，让你无法拿到IP地址，也就无法访问网站；</li>\n<li>“域名劫持”，也叫“域名污染”，你要访问A网站，但DNS给了你B网站。</li>\n</ul><p>好在互联网上还是好人多，而且DNS又是互联网的基础设施，这些“恶意DNS”并不多见，你上网的时候不需要太过担心。</p><h2>小结</h2><p>这次我们学习了与HTTP协议有重要关系的域名和DNS，在这里简单小结一下今天的内容：</p><ol>\n<li><span class=\"orange\">域名使用字符串来代替IP地址，方便用户记忆，本质上一个名字空间系统；</span></li>\n<li><span class=\"orange\">DNS就像是我们现实世界里的电话本、查号台，统管着互联网世界里的所有网站，是一个“超级大管家”；</span></li>\n<li><span class=\"orange\">DNS是一个树状的分布式查询系统，但为了提高查询效率，外围有多级的缓存；</span></li>\n<li><span class=\"orange\">使用DNS可以实现基于域名的负载均衡，既可以在内网，也可以在外网。</span></li>\n</ol><h2>课下作业</h2><ol>\n<li>在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www.不存在.com”，试着解释一下它的DNS解析过程。</li>\n<li>如果因为某些原因，DNS失效或者出错了，会出现什么后果？</li>\n</ol><p>欢迎你把自己的答案写在留言区，与我和其他同学一起讨论。如果你觉得有所收获，也欢迎把文章分享给你的朋友。</p><p><img src=\"https://static001.geekbang.org/resource/image/78/36/7838e0e705864ddfeacc79e0aeb8f236.png?wh=1769*2627\" alt=\"unpreview\"></p><p></p>","comments":[{"had_liked":false,"id":102260,"user_name":"Yif","can_delete":false,"product_type":"c1","uid":1203937,"ip_address":"","ucode":"07050E6E871DC3","user_header":"https://static001.geekbang.org/account/avatar/00/12/5e/e1/aae8b8db.jpg","comment_is_top":false,"comment_ctime":1560171415,"is_pvip":false,"replies":[{"id":"36918","content":"……","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560215442,"ip_address":"","comment_id":102260,"utype":1}],"discussion_count":16,"race_medal":0,"score":"856258663319","product_id":100029001,"comment_content":"GFW就是使用了这些恶意的DNS","like_count":200,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453322,"discussion_content":"……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560215442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1332624,"avatar":"https://static001.geekbang.org/account/avatar/00/14/55/90/8df24b78.jpg","nickname":"遇見","note":"","ucode":"E67A3F88C24528","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":577080,"discussion_content":"瑟瑟发抖","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655908559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":453322,"ip_address":""},"score":577080,"extra":""}]},{"author":{"id":1229070,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/0e/2b987d54.jpg","nickname":"蜉蝣","note":"","ucode":"77CF92496855D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":14461,"discussion_content":"可把老师吓得😂😂😂","likes_number":19,"is_delete":false,"is_hidden":false,"ctime":1568763710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2032840,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/04/c8/3c7af100.jpg","nickname":"Javatar","note":"","ucode":"E216645CDF632C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299216,"discussion_content":"这只是一种方式。但似乎用的不多了，现在都是直接分析数据包的特征，疑似fq的流量会被过滤。","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1597597798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2165014,"avatar":"","nickname":"Simon","note":"","ucode":"E4A9DA30E39826","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312678,"discussion_content":"学以致用！赞","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1602766692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2047017,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKhOqyiahbWybDa8WWXJIibH2HgoMOTzJYWvnpUnwZCxgToEhRmOb8Luv4eoy1HMaReQVrUrF8U4oNg/132","nickname":"Geek_b0f77f","note":"","ucode":"B21723D0438711","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285890,"discussion_content":"兄弟，你还在吧，报个平安","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1592984040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1460339,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIL4v3siaOUVycicRfsWp364VDEsp37fwHt8ItRv3VibhPOuM0dqSgrro28gJ4fCXOibtia1H3yNxIRUwQ/132","nickname":"破瓦匠","note":"","ucode":"908E6A72DE100D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9714,"discussion_content":"秀儿","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1568207888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2029485,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f7/ad/4fd4d867.jpg","nickname":"数学汤家凤","note":"","ucode":"DE84E777C384AD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290241,"discussion_content":"老哥还在吗","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1594388081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1485845,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ac/15/935acedb.jpg","nickname":"iusugar","note":"","ucode":"1372E5AD2068D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":43100,"discussion_content":"开门！东风快递","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1572855166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135190,"avatar":"https://static001.geekbang.org/account/avatar/00/11/52/56/5abb4d94.jpg","nickname":"不知道该叫什么","note":"","ucode":"C0F72F6FF56DA1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40954,"discussion_content":"大兄弟你这有点刚🤣","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1572311674,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1524154,"avatar":"https://static001.geekbang.org/account/avatar/00/17/41/ba/ae028565.jpg","nickname":"YqY","note":"","ucode":"73FB936045DCB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267974,"discussion_content":"查水表了！","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1589719605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1488280,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","nickname":"Ronnyz","note":"","ucode":"9F34527B1D343D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":145977,"discussion_content":"以前还可以通过自己修改host来fq","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579591697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1643982,"avatar":"https://static001.geekbang.org/account/avatar/00/19/15/ce/e8f626df.jpg","nickname":"我是菜鸟","note":"","ucode":"8F6FBDE6F58C1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":38000,"discussion_content":"开门","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571712165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1120612,"avatar":"https://static001.geekbang.org/account/avatar/00/11/19/64/6f2b7b86.jpg","nickname":"01","note":"","ucode":"3229D8F060AFEC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573823,"discussion_content":"gfw 不对解析负责。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653663948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1186089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/19/29/4a8214b7.jpg","nickname":"Bug Killer","note":"","ucode":"2741A206F504E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":133720,"discussion_content":"完全不懂啥意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578983463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1524154,"avatar":"https://static001.geekbang.org/account/avatar/00/17/41/ba/ae028565.jpg","nickname":"YqY","note":"","ucode":"73FB936045DCB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1186089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/19/29/4a8214b7.jpg","nickname":"Bug Killer","note":"","ucode":"2741A206F504E1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267973,"discussion_content":"百度就知道，翻译过来就是防火墙的意思","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589719585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":133720,"ip_address":""},"score":267973,"extra":""}]}]},{"had_liked":false,"id":129755,"user_name":"Wendy","can_delete":false,"product_type":"c1","uid":1308653,"ip_address":"","ucode":"398DDC96B178F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","comment_is_top":false,"comment_ctime":1567240836,"is_pvip":false,"replies":[{"id":"48400","content":"整理的非常完善非常好，感谢补充！","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1567247242,"ip_address":"","comment_id":129755,"utype":1}],"discussion_count":11,"race_medal":0,"score":"843380830852","product_id":100029001,"comment_content":"比如你有一个网站要上线，你在域名注册商那里申请了abc.com,那么你的域名A记录就保存在这个域名注册商的DNS服务器上，该DNS服务器称为权威域名服务器。当客户端访问abc.com时，先查找浏览器DNS缓存，没有则查找操作系统DNS缓存，在这一阶段是操作系统dnscache clinet 服务进行DNS缓存的（你在任务管理器里面可以看到一个dns客户端进程，就是这玩意实现缓存的），如果还是没有则查找hosts文件中的域名记录。然后依然没有的话则访问电脑上设置的DNS服务器IP，比如三大营运商的dns服务器或者谷歌的8.8.8.8，此时这一层的DNS服务器称为“野生DNS缓存服务器”，也就是非权威域名服务器。如果还是没有则非权威域名服务器会去查找  根域名服务器-顶级域名服务器-二级域名服务器-权威域名服务器 ，这样客户端就在权威域名服务器上找到了abc.com对应的IP了，这个IP可以是多个，每次客户端请求的时候域名服务器会根据负载均衡算法分配一个IP给你。当DNS缓存失效了，则重新开始新一轮的域名请求。<br>总结如下：<br>浏览器缓存-&gt;操作系统dnscache -&gt;hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器。<br>其中非权威域名服务器还包括LDNS（企业内网DNS服务器），三大营运商DNS，谷歌公开的DNS，微软公开的DNS等。<br>另外DNS请求有两种方式：递归查询和迭代查询，这方面大家可以网上了解一下。LDNS往后面查询一般是递归查询，因为公司内网是有防火墙的，全部请求通过LDNS来递归查询然后把结果给内网用户。<br>以上为自己理解整理的，若有错误还请大家指正。","like_count":197,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465630,"discussion_content":"整理的非常完善非常好，感谢补充！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567247242,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345941,"discussion_content":"递归迭代查询说的不对\n客户端---本地DNS是递归查询\n本地DNS---外网DNS是迭代查询。","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1611819046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910747,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/27/db/c9f46e81.jpg","nickname":"半桶水","note":"","ucode":"84664F628D34B5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215741,"discussion_content":"厉害","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585376984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1237199,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e0/cf/43f201f2.jpg","nickname":"幼儿编程教学","note":"","ucode":"F13F3150E6CAE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589675,"discussion_content":"请教一下。这里的每一个节点，缓存时间大致是多少？如何使其失效？\n\n浏览器缓存-&gt;操作系统dnscache -&gt;hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665227954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1994380,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/6e/8c/49d94d09.jpg","nickname":"和光同尘","note":"","ucode":"E35F36CA298A98","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586627,"discussion_content":"1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662382261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖南"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2549962,"avatar":"https://static001.geekbang.org/account/avatar/00/26/e8/ca/6a2621d1.jpg","nickname":"坚持不懈","note":"","ucode":"63E462DA5B26D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582928,"discussion_content":"不管怎么样都是查找本地的host先的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659784911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1938247,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/93/47/ef2c3c4e.jpg","nickname":"何江涛","note":"","ucode":"844470733623BF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567082,"discussion_content":"浏览器缓存-&gt;操作系统dnscache -&gt;hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器-&gt;负载均衡返回ip","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650820578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1313115,"avatar":"https://static001.geekbang.org/account/avatar/00/14/09/5b/e9ee3b41.jpg","nickname":"音为","note":"","ucode":"D78E4CBCE6BF45","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":341922,"discussion_content":"多个了二级域名服务器，这个不对吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610543839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1442605,"avatar":"https://static001.geekbang.org/account/avatar/00/16/03/2d/404627dc.jpg","nickname":"Anryg Zhun","note":"","ucode":"76DF8560BA9D14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1313115,"avatar":"https://static001.geekbang.org/account/avatar/00/14/09/5b/e9ee3b41.jpg","nickname":"音为","note":"","ucode":"D78E4CBCE6BF45","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":355411,"discussion_content":"如果域名比较长，层级比较多的话，是很有可能存在二级域名的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615428304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":341922,"ip_address":""},"score":355411,"extra":""},{"author":{"id":3013303,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/fa/b7/0342db08.jpg","nickname":"大排泡饭","note":"","ucode":"30B882AAB67CC5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1442605,"avatar":"https://static001.geekbang.org/account/avatar/00/16/03/2d/404627dc.jpg","nickname":"Anryg Zhun","note":"","ucode":"76DF8560BA9D14","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573639,"discussion_content":"有资料出处可以查证吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653559238,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":355411,"ip_address":""},"score":573639,"extra":""}]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":137101,"discussion_content":"666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579178837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102923,"user_name":"初音未来","can_delete":false,"product_type":"c1","uid":1274518,"ip_address":"","ucode":"3AE23DBC649B97","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erKFNFAQl3ibwlic54a5SQYAMhQYeVtMnSmMahZZjyqG2d66whxbEE3I3IyD07pSmte5DSibr71m6A9g/132","comment_is_top":false,"comment_ctime":1560329413,"is_pvip":false,"replies":[{"id":"37217","content":"浏览器缓存-&gt;操作系统缓存-&gt;hosts-&gt;dns","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560331976,"ip_address":"","comment_id":102923,"utype":1}],"discussion_count":2,"race_medal":0,"score":"151884184773","product_id":100029001,"comment_content":"应该是先查找本地hosts文件，在查找缓存吧","like_count":35,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453652,"discussion_content":"浏览器缓存-&amp;gt;操作系统缓存-&amp;gt;hosts-&amp;gt;dns","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1560331976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2010313,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJH3dribPS9AibkGhjN0giaWAa45SD8lCxkStyQrJibl7CPJRDNicvicwM224tHd3gLq2wvWbMAQ70IF6IA/132","nickname":"X青年","note":"","ucode":"E6EB3CCA7DB1C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373743,"discussion_content":"老师，浏览器的dns缓存怎么查看？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620864135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103246,"user_name":"肥low","can_delete":false,"product_type":"c1","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1560403500,"is_pvip":false,"replies":[{"id":"37347","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560408792,"ip_address":"","comment_id":103246,"utype":1}],"discussion_count":4,"race_medal":0,"score":"147589291564","product_id":100029001,"comment_content":"老师好！<br><br>第一个问题：<br>    1、检查本地dns缓存是否存在解析&quot;www.不存在.com&quot;域名的ip<br>    2、如果没有找到继续查找本地hosts文件内是否有对应的固定记录<br>    3、如果hosts中还是没有那就根据本地网卡被分配的 dns server ip 来进行解析，dns server ip 一般是“非官方”的ip，比如谷歌的“8.8.8.8”，本身它也会对查找的域名解析结果进行缓存，如果它没有缓存或者缓存失效，则先去顶级域名服务器“com”去查找“不存在.com”的域名服务器ip，结果发现不存在，于是直接返回告诉浏览器域名解析错误，当然这两次查找过程是基于udp协议<br><br>第二个问题：如果dns失效或出错，那就访问不了了呗，我现在有个域名在国外某些国家每天都有不少访问失败的http请求，客户端直接报“Failed host lookup”的错误<br>","like_count":34,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453802,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560408792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1046118,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f6/66/991b7e3a.jpg","nickname":"贤蛋蛋","note":"","ucode":"0FCBCB15E94770","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4429,"discussion_content":"你好，没有被野生服务器解析并缓存的话，是直接去访问顶级服务器吗，不要先访问根域名服务器吗，求提点，谢谢～","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565414372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1299095,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/97/5f4cd8da.jpg","nickname":"虎虎生威的程坚强","note":"","ucode":"321C89298D3682","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1046118,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f6/66/991b7e3a.jpg","nickname":"贤蛋蛋","note":"","ucode":"0FCBCB15E94770","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394741,"discussion_content":"先根再顶级","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632027620,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4429,"ip_address":""},"score":394741,"extra":""}]},{"author":{"id":1235562,"avatar":"https://static001.geekbang.org/account/avatar/00/12/da/6a/6b96edbd.jpg","nickname":"学不动了","note":"","ucode":"6855C982ECC3A8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354089,"discussion_content":"你好，我想请问如果本地网卡设置的dns server ip是192.168.0.1这样的内网地址又是如何映射的？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615250854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102072,"user_name":"何用","can_delete":false,"product_type":"c1","uid":1377393,"ip_address":"","ucode":"B0C6E8176AE6FD","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/71/0b949a4c.jpg","comment_is_top":false,"comment_ctime":1560128937,"is_pvip":false,"replies":[{"id":"36794","content":"细节原因不好解释，简单来说是因为dns协议还有udp协议里包大小的限制，只有512字节，再除以dns记录长度，最多15组，再去掉buffer。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560130125,"ip_address":"","comment_id":102072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"134704115113","product_id":100029001,"comment_content":"为何全世界只有 13 组根域名服务器呢？","like_count":31,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453246,"discussion_content":"细节原因不好解释，简单来说是因为dns协议还有udp协议里包大小的限制，只有512字节，再除以dns记录长度，最多15组，再去掉buffer。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560130125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":108195,"user_name":"Chuan","can_delete":false,"product_type":"c1","uid":1438352,"ip_address":"","ucode":"FACEC5DAC36A7A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI4akcIyIOXB2OqibTe7FF90hwsBicxkjdicUNTMorGeIictdr3OoMxhc20yznmZWwAvQVThKPFWgOyMw/132","comment_is_top":false,"comment_ctime":1561693689,"is_pvip":false,"replies":[{"id":"39226","content":"是的，你学习的很仔细。<br><br>一般上网的时候都会有默认dns，都配置好了，所以通常都感觉不到。<br><br>但默认dns有的时候性能不好，所以才会有很多的免费dns。<br>","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1561705140,"ip_address":"","comment_id":108195,"utype":1}],"discussion_count":3,"race_medal":0,"score":"87461039609","product_id":100029001,"comment_content":"老师好：<br>对于DNS解析的过程：浏览器DNS缓存-&gt;操作系统缓存-&gt;Hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;权威域名服务器。一直对浏览器&#47;本机如何知道根服务器地址存在疑惑。<br>在查阅《计算机网络自顶向下方法》后发现，我们在连接某个ISP时，ISP一般会给我们提供一个IP地址，同时该地址拥有一台或多台DNS服务器地址（通过DHCP）。所以我们在Hosts文件中找不到时，会去查询这个局域网DNS服务器，如果没有查到，它会帮我们去查询根NDS服务器、顶级域名服务器和权威域名服务器，然后返回给本机，同时进行缓存。<br>个人认为，如果我们自己配置了非权威DNS服务器，如8.8.8.8，它应该也会帮我们去查询根NDS服务器、顶级域名服务器和权威域名服务器。<br>这些远程查询都是基于UDP协议，通常使用53号端口。<br>不知道以上理解是否正确?","like_count":20,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455867,"discussion_content":"是的，你学习的很仔细。\n\n一般上网的时候都会有默认dns，都配置好了，所以通常都感觉不到。\n\n但默认dns有的时候性能不好，所以才会有很多的免费dns。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561705140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6386,"discussion_content":"1-操作系统本地DNS缓存能否讲的具体一点，是缓存在哪里？怎么个缓存法？和dns客户端有什么关系？\n2-权威域名服务器是指企业购买域名时用于管理解析记录的DNS服务器吗？还是运营商的DNS服务器？\n3-hosts文件其实多为内部临时测试使用（普通用户用浏览器浏览网页一般用不到这个文件，这个文件基本不会去改动）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566876012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2028811,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f5/0b/73628618.jpg","nickname":"兔嘟嘟","note":"","ucode":"5A9042B4C7670C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384207,"discussion_content":"hosts文件配置过git.ws.com，以及git搞代理的时候也用过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626426252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6386,"ip_address":""},"score":384207,"extra":""}]}]},{"had_liked":false,"id":194078,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1585021640,"is_pvip":false,"replies":[{"id":"73931","content":"写的很用心，整理一下可以在公司内部开分享会了。<br><br>你提的这些问题其实是属于操作系统、浏览器、DNS服务器自己的问题，如何处理缓存、查找文件都有自己的策略，在协议层面是不太关心的，太细节的方面我也没办法回答，不过有好奇心和求知欲总是好事，有答案欢迎分享给大家。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585028846,"ip_address":"","comment_id":194078,"utype":1}],"discussion_count":3,"race_medal":0,"score":"61714563784","product_id":100029001,"comment_content":"1：在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>首先，非常感谢老师和评论区的同学，我的认知又被刷新了，之前只模糊认识到有一个翻译的过程，把域名解析成对应的IP地址，然而光域名解析这一个动作就有一长串组合拳，目的除了便于人类的记忆和理解，剩下的核心就是提速。<br>提速的关键是，第一尽可能的少做事情，第二是尽可能的少做慢动作，怎么来实现呢？合适的数据结构和算法＋缓存（可能是多级缓存），这里都是有体现的，比如：域名服务器的树行结构，各种缓存机制。<br>OK，回答问题，这里仅是整理，我之前确实不知道有这么多门道。<br>第一：拿着域名去浏览器缓存中查找，这里有些疑问，浏览器中缓存在哪里？过期时间大概多久？过期机制是什么？<br>第二：去操作系统缓存中去查找，同样的疑问，缓存在哪里？过期时间多久？过期机制是什么？怎么确认一下？<br>第三：去hosts文件中查找，这个文件还好进程修改，那么每个操作系统这个文件都必须在默认的路径下吗？否则就需要全部文件遍历一下啦？<br>第四：去非权威DNS服务器中查找，到此这些都可以认为是一种缓存思想的运用，把域名和IP的映射关系信息放在更快的存储设备之上，把这份信息放在离用户更近的地方，来加速用户通过域名获取IP的速度。<br>第五：去根域名DNS服务器中查找，注意，此时仅拿着根域名去查找，下面的查找过程有一定的层次结构，这样不仅查找的信息少存储的信息也会少，速度也会更快一些<br>第六：去顶级域名DNS服务器中查找，此时拿的信息是“com”查找“不存在.com”，确实查不到，然后就抛出异常，逐级返回了，最后把找不到的提升信息给到用户——无法访问此网站，找不到www.不存在.com的服务器IP地址<br>第七：假设第六步找到了，则会继续去二级域名DNS服务器去查找，根据“不存在.com”找“ww.不存在.com”<br>第八：去权威DNS服务器中找到“ww.不存在.com”对应的IP地址<br>第九：然后返回，在返回的过程中会更新操作系统缓存，浏览器缓存，不知道非权威DNS服务器中的域名和IP映射信息是怎么进去的，是定时加载嘛？<br><br>2：如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>会出现“无法访问此网站，找不到www.XXX.com的服务器IP地址”","like_count":14,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488751,"discussion_content":"写的很用心，整理一下可以在公司内部开分享会了。\n\n你提的这些问题其实是属于操作系统、浏览器、DNS服务器自己的问题，如何处理缓存、查找文件都有自己的策略，在协议层面是不太关心的，太细节的方面我也没办法回答，不过有好奇心和求知欲总是好事，有答案欢迎分享给大家。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585028846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346003,"discussion_content":"试着回答一下\n第一：拿着域名去浏览器缓存中查找，这里有些疑问，浏览器中缓存在哪里？过期时间大概多久？过期机制是什么？\n---chrome://net-internals/#dns\n看不到细节，依据是ttl,每个浏览器有固定的ttl\n测试可以参考，https://blog.csdn.net/weixin_45462681/article/details/113318571\n\n第二：去操作系统缓存中去查找，同样的疑问，缓存在哪里？过期时间多久？过期机制是什么？怎么确认一下？\n---查看ipconfig/displaydns， 依据是ttl,可以看到ttl在减少\n\n第三：去hosts文件中查找，这个文件还好进程修改，那么每个操作系统这个文件都必须在默认的路径下吗？否则就需要全部文件遍历一下啦？\n---固定默认位置\n\n第四：去非权威DNS服务器中查找，到此这些都可以认为是一种缓存思想的运用，把域名和IP的映射关系信息放在更快的存储设备之上，把这份信息放在离用户更近的地方，来加速用户通过域名获取IP的速度。\n第五：去根域名DNS服务器中查找，注意，此时仅拿着根域名去查找，下面的查找过程有一定的层次结构，这样不仅查找的信息少存储的信息也会少，速度也会更快一些\n第六：去顶级域名DNS服务器中查找，此时拿的信息是“com”查找“不存在.com”，确实查不到，然后就抛出异常，逐级返回了，最后把找不到的提升信息给到用户——无法访问此网站，找不到www.不存在.com的服务器IP地址\n第七：假设第六步找到了，则会继续去二级域名DNS服务器去查找，根据“不存在.com”找“ww.不存在.com”\n第八：去权威DNS服务器中找到“ww.不存在.com”对应的IP地址\n第九：然后返回，在返回的过程中会更新操作系统缓存，浏览器缓存，不知道非权威DNS服务器中的域名和IP映射信息是怎么进去的，是定时加载嘛？\n---DNS查找分递归和迭代，非权威DNS会执行迭代查找，简单说它最终会拿到结果，再返回给客户端，所以它更新缓存不是问题。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1611837168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1951652,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/c7/a4/c066b2f8.jpg","nickname":"咔唧啾唧","note":"","ucode":"5188ED2DC3A70A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352513,"discussion_content":"大佬，我对请求的过程有点疑问，望赐教：\n“\n     第七：假设第六步找到了，则会继续去二级域名DNS服务器去查找，根据“不存 \n在.com”找“ww.不存在.com”\n     第八：去权威DNS服务器中找到“ww.不存在.com”对应的IP地址\n”\n1. 在二级域名DNS服务器中查找到了域名“ww.不存在.com”，为什么还要再去权威DNS服务器中查找对应的IP地址呢？\n2. 二级域名DNS服务器中存储的是什么？不是对应域名和IP地址的映射关系吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614759676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233691,"user_name":"数学汤家凤","can_delete":false,"product_type":"c1","uid":2029485,"ip_address":"","ucode":"DE84E777C384AD","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f7/ad/4fd4d867.jpg","comment_is_top":false,"comment_ctime":1594388832,"is_pvip":true,"replies":[{"id":"86282","content":"great ","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1594423221,"ip_address":"","comment_id":233691,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31659159904","product_id":100029001,"comment_content":"域名解析过程<br>浏览器缓存 -&gt; OS 缓存 -&gt; hosts 文件 -&gt; 本地域名服务器 -&gt; 根域名服务器 -&gt; 顶级域名服务器 -&gt; 权威域名服务器<br>客户端向本地域名服务器获取，是递归查询<br>本地域名服务器向根域名服务器获取，可以是递归也可是迭代<br>递归就是你交给别人，让别人查到，在返回给你<br>迭代就是你找别人要，他叫你去别的地方找","like_count":7,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501135,"discussion_content":"great ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594423221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1281442,"avatar":"https://static001.geekbang.org/account/avatar/00/13/8d/a2/2bf8e497.jpg","nickname":"瑞","note":"","ucode":"72F4DB0B386ECF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369641,"discussion_content":"域名配置的ip映射，如何保证dns缓存一致性，浏览器缓存-os缓存-host-本地域名服务器-根域名服务-顶级域名服务器-权威域名服务器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619102912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1079816,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","nickname":"Aaron Cheung","note":"","ucode":"03972759C53667","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304042,"discussion_content":"汤家凤老师也来学习这个的吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599458446,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215765,"user_name":"海盗船长","can_delete":false,"product_type":"c1","uid":1363634,"ip_address":"","ucode":"ECB28BA21A4113","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/b2/1f914527.jpg","comment_is_top":false,"comment_ctime":1589099633,"is_pvip":false,"replies":[{"id":"79844","content":"这些小工具用来在实验环境测试很方便。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589110942,"ip_address":"","comment_id":215765,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27358903409","product_id":100029001,"comment_content":"chrome  chrome:&#47;&#47;net-internals&#47;#dns  查看和清空缓存<br><br>windows查看系统缓存：<br> ipconfig &#47;displaydns 显示已有缓存<br> ipconfig &#47;displaydns &gt; C:\\Users\\SDWQ\\Desktop\\1.txt 导出到再查看。<br> ipconfig &#47;flushdns 强制更新缓存","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494547,"discussion_content":"这些小工具用来在实验环境测试很方便。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589110942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103545,"user_name":"　　　　　　　鸟人","can_delete":false,"product_type":"c1","uid":1035165,"ip_address":"","ucode":"E504B22F336035","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/9d/2bc85843.jpg","comment_is_top":false,"comment_ctime":1560472438,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23035308918","product_id":100029001,"comment_content":"修改hosts绕过gfw","like_count":5,"discussions":[{"author":{"id":1460339,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIL4v3siaOUVycicRfsWp364VDEsp37fwHt8ItRv3VibhPOuM0dqSgrro28gJ4fCXOibtia1H3yNxIRUwQ/132","nickname":"破瓦匠","note":"","ucode":"908E6A72DE100D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9716,"discussion_content":"都2019了，你还在长者的年代吗？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1568208117,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1294359,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c0/17/033a9287.jpg","nickname":"Dongz","note":"","ucode":"05904B1DA70C86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1460339,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIL4v3siaOUVycicRfsWp364VDEsp37fwHt8ItRv3VibhPOuM0dqSgrro28gJ4fCXOibtia1H3yNxIRUwQ/132","nickname":"破瓦匠","note":"","ucode":"908E6A72DE100D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":161876,"discussion_content":"蛤蛤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580922336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":9716,"ip_address":""},"score":161876,"extra":""}]}]},{"had_liked":false,"id":102079,"user_name":"梦倚栏杆","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1560130004,"is_pvip":false,"replies":[{"id":"36800","content":"域名由专门的域名注册机构管理，终极的是ICANN。<br>IP地址的分配也由ICANN管理，当然有浪费，美国是互联网的发明国，所以占用ip地址最多。<br><br>ip地址查找由专门的协议，比如arp。<br><br>这些比较偏底层，离http比较远，可以再找其他资料学习。。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560131820,"ip_address":"","comment_id":102079,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23034966484","product_id":100029001,"comment_content":"老师好，我有两个疑问：<br>1.终极dns的解析是有谁实现的或者谁规定的：<br>比如乔布斯有个苹果域名：www.apple.com，苹果电脑的官网；张三也想为水果苹果申请个域名(www.apple.com)来展示他的苹果;结果我们几乎可以猜测到，他是申请失败的，原因已经有一个苹果存在了，谁来评判这个苹果域名已经被占用了呢？判断逻辑是如何来的，如果两个申请发生在同时呢？<br>2. ip地址的分配和身份证号一样吗？有地址在里面吗？<br>比如1-45属于美国的网段，或者属于哪个超大公司的网段。如果有，那是不是就以为着预分配，也就意味着部分ip段的浪费，如果没有，那ip地址从一个地方查找另外一个地方怎么找呢？莫非每个初始的线路都需要访问到根DNS<br>","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453248,"discussion_content":"域名由专门的域名注册机构管理，终极的是ICANN。\nIP地址的分配也由ICANN管理，当然有浪费，美国是互联网的发明国，所以占用ip地址最多。\n\nip地址查找由专门的协议，比如arp。\n\n这些比较偏底层，离http比较远，可以再找其他资料学习。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560131820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102012,"user_name":"zjajxzg","can_delete":false,"product_type":"c1","uid":1441304,"ip_address":"","ucode":"EF2FBD463F266B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKuLsA1AAjUSO7oPHIqbA8f8slVIUw7nhdiaOI4nBYH6RxlyxXyFNe2Bc0g7yMoMHxnlh2mf43aVXw/132","comment_is_top":false,"comment_ctime":1560099831,"is_pvip":false,"replies":[{"id":"36786","content":"第一个没说完，第二个问题可以再说的详细一些。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560129002,"ip_address":"","comment_id":102012,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23034936311","product_id":100029001,"comment_content":"1、操作系统缓存→本地hosts文件→非核心dns服务器→根域名服务器地址→顶级域名服务器地址→二级域名服务器地址。。。<br>2、无法访问相应的资源","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453219,"discussion_content":"第一个没说完，第二个问题可以再说的详细一些。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560129002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120910,"user_name":"Even","can_delete":false,"product_type":"c1","uid":1147948,"ip_address":"","ucode":"C3555903EE9525","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/2c/1b0926b4.jpg","comment_is_top":false,"comment_ctime":1565011854,"is_pvip":true,"replies":[{"id":"44454","content":"<br>1.具体不清楚，应该是都有<br><br>2.hosts文件是方便用户自己添加dns解析，与操作系统的目的不同，它不是缓存，而是一个简单的dns解析器。<br>","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565049512,"ip_address":"","comment_id":120910,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18744881038","product_id":100029001,"comment_content":"有个疑问，操作系统的dns缓存存在哪里？内存还是硬盘？为什么有hosts文件还需要操作系统的dns缓存。","like_count":4,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461527,"discussion_content":"\n1.具体不清楚，应该是都有\n\n2.hosts文件是方便用户自己添加dns解析，与操作系统的目的不同，它不是缓存，而是一个简单的dns解析器。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565049512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137033,"user_name":"- shadow -","can_delete":false,"product_type":"c1","uid":1676738,"ip_address":"","ucode":"97B68447A75354","user_header":"https://static001.geekbang.org/account/avatar/00/19/95/c2/afbb3f61.jpg","comment_is_top":false,"comment_ctime":1569579219,"is_pvip":false,"replies":[{"id":"52772","content":"域名的这些用法在现实中都有用到，但网站服务器变更时不会立即下线，而是等一段时间，当过了dns缓存有效期，新的dns解析结果全网生效时再把旧服务器下线，这时旧服务器已经没有dns解析后的流量了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1569720492,"ip_address":"","comment_id":137033,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14454481107","product_id":100029001,"comment_content":"想问问老师，域名的“新玩法”的第一种和第三种在现实环境中真的会使用吗？主要是各级缓存的存在，可能会导致找不到最新的IP，而拿到的是旧的IP呢？","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468913,"discussion_content":"域名的这些用法在现实中都有用到，但网站服务器变更时不会立即下线，而是等一段时间，当过了dns缓存有效期，新的dns解析结果全网生效时再把旧服务器下线，这时旧服务器已经没有dns解析后的流量了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569720492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1676738,"avatar":"https://static001.geekbang.org/account/avatar/00/19/95/c2/afbb3f61.jpg","nickname":"- shadow -","note":"","ucode":"97B68447A75354","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":34233,"discussion_content":"谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571186348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121526,"user_name":"听雨","can_delete":false,"product_type":"c1","uid":1254493,"ip_address":"","ucode":"252754F9FCFF0C","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","comment_is_top":false,"comment_ctime":1565153123,"is_pvip":false,"replies":[{"id":"44674","content":"权威域名服务器是专门解析某个站点域名的服务器，一个二级域名就要有一个对应的权威域名服务器。<br><br>所谓的权威，意思是这个域名如何解析我说了算，其他的都不能算是权威。<br><br>8.8.8.8这些域名服务器不是解析专门域名的服务器，需要访问dns解析系统获取各个域名的解析结果，所以是“非权威”。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565174503,"ip_address":"","comment_id":121526,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14450055011","product_id":100029001,"comment_content":"有一个问题：<br>权威域名服务器是因为公司大，用到的IP比较多，才给分的吗。那为什么谷歌不是权威域名服务器呢？不理解","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461837,"discussion_content":"权威域名服务器是专门解析某个站点域名的服务器，一个二级域名就要有一个对应的权威域名服务器。\n\n所谓的权威，意思是这个域名如何解析我说了算，其他的都不能算是权威。\n\n8.8.8.8这些域名服务器不是解析专门域名的服务器，需要访问dns解析系统获取各个域名的解析结果，所以是“非权威”。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565174503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346014,"discussion_content":"某个dns服务器，管理那个域名空间，如abc.com,它就是那个域名的权威服务器，其它dns服务器的数据来源都是从权威dns来的，自然就是非权威dns","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611838858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102151,"user_name":"小鸟淫太","can_delete":false,"product_type":"c1","uid":1247186,"ip_address":"","ucode":"AC44F552DDF93E","user_header":"https://static001.geekbang.org/account/avatar/00/13/07/d2/d7a200d5.jpg","comment_is_top":false,"comment_ctime":1560152018,"is_pvip":false,"replies":[{"id":"36846","content":"这个应该是浏览器的重连策略问题，dsn解析结果已经出来了，就已经跟dns无关了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560159553,"ip_address":"","comment_id":102151,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14445053906","product_id":100029001,"comment_content":"老师您好，之前碰到过这样一个问题<br>域名解析返回两个IP地址，其中一个IP无法正常访问。<br>Safari可以自动切换到正常的IP地址继续访问<br>Chrome会尝试TCP连接不正常的IP，大约1分多钟之后会连接另一个IP<br>最终导致Chrome页面访问速度缓慢。想问下这种问题是属于浏览器问题，还是DNS的问题呢？","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453282,"discussion_content":"这个应该是浏览器的重连策略问题，dsn解析结果已经出来了，就已经跟dns无关了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560159553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6389,"discussion_content":"跟浏览器没关系，跟DNS也没有关系，是你访问的服务端有问题，如果你想避开失效的IP，可以在hosts文件中添加域名解析记录，解析到对应的生效IP即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566877744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110070,"user_name":"missing~~","can_delete":false,"product_type":"c1","uid":1583675,"ip_address":"","ucode":"42DDDD1185BFFF","user_header":"https://static001.geekbang.org/account/avatar/00/18/2a/3b/3b938d03.jpg","comment_is_top":false,"comment_ctime":1562166105,"is_pvip":false,"replies":[{"id":"39917","content":"Nginx的里的resolver是给连接后端服务器用的，如果Nginx配置反向代理，用域名的方式指定后端服务器，就必须要用resolver把域名转换成ip地址。<br><br>这个指令不影响客户端，客户端是用本地dns解析出服务器的ip地址，连接网站。<br><br>","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562203287,"ip_address":"","comment_id":110070,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10152100697","product_id":100029001,"comment_content":"nginx中的resolve配置dns服务器，这个没太理解，我一直以为是先通过域名解析到ip之后，才找到相应的主机，加载nginx配置。老师，请教一下这个顺序关系","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456708,"discussion_content":"Nginx的里的resolver是给连接后端服务器用的，如果Nginx配置反向代理，用域名的方式指定后端服务器，就必须要用resolver把域名转换成ip地址。\n\n这个指令不影响客户端，客户端是用本地dns解析出服务器的ip地址，连接网站。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562203287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102305,"user_name":"极客时间","can_delete":false,"product_type":"c1","uid":1015564,"ip_address":"","ucode":"AF7565BB5EF164","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7f/0c/392ce255.jpg","comment_is_top":false,"comment_ctime":1560183989,"is_pvip":false,"replies":[{"id":"36917","content":"一个域名可以对应多个ip地址，不一定是一个，所以域名能够实现负载均衡。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560215424,"ip_address":"","comment_id":102305,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10150118581","product_id":100029001,"comment_content":"这句话不是太明白 “第一种方式，因为域名解析可以返回多个 IP 地址，所以一个域...<br><br>域名不是只能绑定一个ip地址吗？为什么解析的时候会返回多个ip呢？ 我是哪里读漏了吗？","like_count":2,"discussions":[{"author":{"id":2829842,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/2e/12/9170d2d1.jpg","nickname":"一人、一世界","note":"","ucode":"3CA9A3B7944809","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567626,"discussion_content":"mark","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1650961328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453351,"discussion_content":"一个域名可以对应多个ip地址，不一定是一个，所以域名能够实现负载均衡。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1560215424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340793,"discussion_content":"C:\\>nslookup www.sina.com\n服务器:  XiaoQiang\nAddress:  192.168.31.1\n\n非权威应答:\n名称:    ww1.sinaimg.cn.w.alikunlun.com\nAddresses:  240e:95c:3004:3:3::3fd\n          240e:95c:3004:3:3::3fe\n          116.211.183.141\n          116.211.183.213\n          116.211.183.135\n          116.211.183.212\n          27.19.248.241\n          116.211.183.215\n          116.211.183.142\n          27.19.248.244\n          27.19.248.242\n          116.211.183.214\n          116.211.183.139\n          116.211.183.136\n          27.19.248.240\n          116.211.183.137\n          27.19.248.243\nAliases:  www.sina.com\n          spool.grid.sinaedge.com\n\n\nC:\\>ping www.sina.com\n\n正在 Ping ww1.sinaimg.cn.w.alikunlun.com [27.19.248.243] 具有 32 字节的数据:\n来自 27.19.248.243 的回复: 字节=32 时间=7ms TTL=57\n来自 27.19.248.243 的回复: 字节=32 时间=11ms TTL=57\n\n27.19.248.243 的 Ping 统计信息:\n    数据包: 已发送 = 2，已接收 = 2，丢失 = 0 (0% 丢失)，\n往返行程的估计时间(以毫秒为单位):\n    最短 = 7ms，最长 = 11ms，平均 = 9ms\n\n以新浪为例，nslookup www.sina.com，可以返回多个ip，ping 它回应的是其中一个ip\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610160673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102060,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1560127568,"is_pvip":false,"replies":[{"id":"36791","content":"dns解析出ip后访问失败就不会再解析了。<br>浏览器的重试策略跟具体实现有关，这个我也不清楚。<br>dns是最终一致。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560129181,"ip_address":"","comment_id":102060,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10150062160","product_id":100029001,"comment_content":"老师好!1.2.3.4改成5.6.7.8后访问不到浏览器会自动重试解析DNS是么?从事的时候使用野生还是专业的有啥策略?重试几次，DNS集群的域名是最终一致还是强一致。<br>1.操作系统缓存不存在，host文件不存在，访问DNS服务器，根域名解析成功，二级域名解析失败，重试还是失败。浏览器返回错误。<br>2走失败策略，最终还是失败的就错误页面。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453239,"discussion_content":"dns解析出ip后访问失败就不会再解析了。\n浏览器的重试策略跟具体实现有关，这个我也不清楚。\ndns是最终一致。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560129181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346005,"discussion_content":"再次访问，若没有缓存就会重新发起DNS解析，dns缓存的ttl通常时间比较短，用户基本察觉不到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611837366,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217680,"user_name":"欧阳娜","can_delete":false,"product_type":"c1","uid":1183180,"ip_address":"","ucode":"36B839515A98B9","user_header":"https://static001.geekbang.org/account/avatar/00/12/0d/cc/dc05a073.jpg","comment_is_top":false,"comment_ctime":1589584169,"is_pvip":false,"replies":[{"id":"80522","content":"<br>1.应该是这样，具体怎么操作我不是很了解，可能是有协议来自动更新吧。<br><br>2.dns缓存都有有效期，过期了就会更新。<br><br>3.域名负载均衡是由dns服务器来执行，基于域名，而Nginx是在http协议上负载均衡，更灵活。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1589602009,"ip_address":"","comment_id":217680,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5884551465","product_id":100029001,"comment_content":"老师，请教一下，去域名注册商注册域名就要告诉它自己服务器的ip，那后面这个ip变了，再通知它更改吗？多级缓存怎么更新？域名负载均衡和nginx的负载均衡有什么差异？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495218,"discussion_content":"\n1.应该是这样，具体怎么操作我不是很了解，可能是有协议来自动更新吧。\n\n2.dns缓存都有有效期，过期了就会更新。\n\n3.域名负载均衡是由dns服务器来执行，基于域名，而Nginx是在http协议上负载均衡，更灵活。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589602009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199844,"user_name":"波塞冬","can_delete":false,"product_type":"c1","uid":1167148,"ip_address":"","ucode":"7F59E33955900D","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/2c/8aeb9b64.jpg","comment_is_top":false,"comment_ctime":1585496855,"is_pvip":false,"replies":[{"id":"74787","content":"人家要靠这个恰饭。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585530372,"ip_address":"","comment_id":199844,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880464151","product_id":100029001,"comment_content":"盗版操作系统很多域名劫持","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489886,"discussion_content":"人家要靠这个恰饭。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585530372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193739,"user_name":"Celine","can_delete":false,"product_type":"c1","uid":1926366,"ip_address":"","ucode":"63D5F2E8FB2130","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erwIgbTd3oy4GzkdCUBmz8lHGIIWBwoSIfibgQzwDlQuvTrLlqwTh7p99NBJIsu98ziaYoroQCSENwA/132","comment_is_top":false,"comment_ctime":1584956587,"is_pvip":false,"replies":[{"id":"73862","content":"etc&#47;hosts是给用户自定义用的，系统的域名缓存不会放到这里。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585011676,"ip_address":"","comment_id":193739,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879923883","product_id":100029001,"comment_content":"老师，问一个问题呀，etc&#47;hosts 文件里什么时候才会出现域名的缓存，比如我访问www.baidu.com, 这个时候hosts 文件里没有域名和IP的对应关系呀。这个时候是存在操作系统里了吗？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488641,"discussion_content":"etc/hosts是给用户自定义用的，系统的域名缓存不会放到这里。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585011676,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153243,"user_name":"keep it simple","can_delete":false,"product_type":"c1","uid":1574739,"ip_address":"","ucode":"72B8DC00247C9E","user_header":"https://static001.geekbang.org/account/avatar/00/18/07/53/05aa9573.jpg","comment_is_top":false,"comment_ctime":1574207608,"is_pvip":false,"replies":[{"id":"58857","content":"<br>1.的确有很多公司会搭建公共dns，给广大网民免费使用，出发点有很多，不能妄自猜测，但确实可以收集到数据。<br><br>2.dns解析域名可以内部定制策略，设置权重按优先级返回ip地址，但除非特殊说明，这些ip地址都是平等的。客户端也可以任意选择，双方都有各自的主动权。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1574211139,"ip_address":"","comment_id":153243,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5869174904","product_id":100029001,"comment_content":"老师，学完这课我有两个疑问：<br>1.大企业为什么要建设8.8.8.8这样的DNS服务器，他们有什么好处？是否是搜集更多用户流量，为自己的产品运营做大数据分析？<br>2.基于DNS的负载均衡中，比如一个域名同时返回两个IP，哪个在前哪个在后有关系吗？不同客户端是不是都会选择排在前面的那个IP来访问呢？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475090,"discussion_content":"\n1.的确有很多公司会搭建公共dns，给广大网民免费使用，出发点有很多，不能妄自猜测，但确实可以收集到数据。\n\n2.dns解析域名可以内部定制策略，设置权重按优先级返回ip地址，但除非特殊说明，这些ip地址都是平等的。客户端也可以任意选择，双方都有各自的主动权。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574211139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102647,"user_name":"蚂蚁内推+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1560271552,"is_pvip":false,"replies":[{"id":"37157","content":"回答的基本正确。<br><br>是的，课程里好像说了，浏览器内部也会缓存dns的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560302094,"ip_address":"","comment_id":102647,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855238848","product_id":100029001,"comment_content":"1. www.不存在.com -&gt; Hosts 文件 -&gt; 操作系统本地缓存 -&gt; 非权威域名服务器查询其缓存 -&gt; 查询根域名、顶级域名、以及域名服务器，当后面的查询得到结果时，将会写入本地缓存<br>2. - 首先，我们的目标的 IP 地址就会因此无法被正确解析到，因此将无法打开页面，即域名屏蔽；如果 DNS 错误得将域名解析道错误的 IP 地址上，即域名污染。<br><br>提问一下，浏览器本身是不是也会对 DNS 缓存以提高访问速度？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453518,"discussion_content":"回答的基本正确。\n\n是的，课程里好像说了，浏览器内部也会缓存dns的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560302094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102494,"user_name":"团结屯儿王二狗","can_delete":false,"product_type":"c1","uid":1171468,"ip_address":"","ucode":"C4E0CF37E58773","user_header":"https://static001.geekbang.org/account/avatar/00/11/e0/0c/c6151e22.jpg","comment_is_top":false,"comment_ctime":1560236637,"is_pvip":false,"replies":[{"id":"37013","content":"我个人觉得还是自己想出答案比较好，统一的“标准答案”反而不利于学习，其实留言里的很多都回答的挺好的。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560245036,"ip_address":"","comment_id":102494,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855203933","product_id":100029001,"comment_content":"建议把每节的课后作业，在下一节中，把答案给大家说一下。毕竟有说的不对的地方，也算个参考","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453450,"discussion_content":"我个人觉得还是自己想出答案比较好，统一的“标准答案”反而不利于学习，其实留言里的很多都回答的挺好的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560245036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102317,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1560191453,"is_pvip":false,"replies":[{"id":"36922","content":"“野生”dns服务器本质上只是缓存，它不能影响核心dns系统，而是核心dns改变它的值。<br><br>如果你自己搭dns服务器那么就没有这些问题了。<br><br>第二个，hosts文件需要人工维护，可以自己添加，而操作系统缓存是自动管理的。通常都不需要做修改，除非有些特殊域名被“攻击”，只能手动改hosts实现解析。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560215691,"ip_address":"","comment_id":102317,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855158749","product_id":100029001,"comment_content":"思考题：<br>1、操作系统首先会在其缓存和 HOST 文件中去找域名对应的 IP 地址，如果本地中没有记录，则会去 DNS 服务器中查找，按照 DNS 服务器的树状结构，层级进行访问查找，对于 “www.” 这样的请求，在第一层，也就是根域名服务器中是找不到下一层的域名服务器的，于是就返回错误给客户端，不继续往下找<br>2、看 DNS 服务器的返回错误内容吧，如果是返回错误请求或者内部错误告知的话，客户端这边可以相应地做一些响应异常处理；还有一种情况是 DNS 返回一个不存在的 IP 地址，或者是映射到错误的 IP 地址，个人认为前者的影响会小一些，顶多是请求页面 404 报错，后者的话则会误导用户，比如你输入了 “www.apple.com”，弹出的是 Google 搜索栏<br><br>这里想请教老师几个问题，可能有点超出 HTTP 的范畴，但是还是比较好奇<br>1、如果说我们应用域名的一些技术，比如文中说的重定向，负载均衡等等，这些技术都涉及到了域名和 IP 映射关系的改变，那么这些改变只是在其对应的 DNS 代理服务器上改变吗，还是说代理服务器立刻会将该改变内容发送到 DNS 核心服务器去？<br>2、另外就是操作系统的缓存和 HOST 文件是不是需要定期的人工检查，排除域名和 IP 对应的改变？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453356,"discussion_content":"“野生”dns服务器本质上只是缓存，它不能影响核心dns系统，而是核心dns改变它的值。\n\n如果你自己搭dns服务器那么就没有这些问题了。\n\n第二个，hosts文件需要人工维护，可以自己添加，而操作系统缓存是自动管理的。通常都不需要做修改，除非有些特殊域名被“攻击”，只能手动改hosts实现解析。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560215691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102094,"user_name":"我行我素","can_delete":false,"product_type":"c1","uid":1224678,"ip_address":"","ucode":"4C69542FAB0671","user_header":"https://static001.geekbang.org/account/avatar/00/12/af/e6/9c77acff.jpg","comment_is_top":false,"comment_ctime":1560135177,"is_pvip":false,"replies":[{"id":"36821","content":"域名解析有个ttl有效期，到期就会去上一级dns重新获取，当然也可以主动刷新。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560138494,"ip_address":"","comment_id":102094,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5855102473","product_id":100029001,"comment_content":"老师，想请问下，当域名所对应的ip发生变化的时候，因为本地或者&quot;野生&quot;域名服务器上的ip是怎么发生变化的呢？因为在域名所对应的ip发生变化的时候应该是通知的权威域名服务器吧","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453256,"discussion_content":"域名解析有个ttl有效期，到期就会去上一级dns重新获取，当然也可以主动刷新。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560138494,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359090,"user_name":"幼儿编程教学","can_delete":false,"product_type":"c1","uid":1237199,"ip_address":"北京","ucode":"F13F3150E6CAE9","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/cf/43f201f2.jpg","comment_is_top":false,"comment_ctime":1665228607,"is_pvip":false,"replies":[{"id":"130594","content":"这个要看dns协议了，我没有太深入地研究。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1665269994,"ip_address":"北京","comment_id":359090,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1665228607","product_id":100029001,"comment_content":"请教一下。这里的每一个节点，缓存时间大致是多少？如何使其失效？ <br><br>浏览器缓存-&gt;操作系统dnscache -&gt;hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589702,"discussion_content":"这个要看dns协议了，我没有太深入地研究。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1665269994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342959,"user_name":"宗麒麟","can_delete":false,"product_type":"c1","uid":1385772,"ip_address":"","ucode":"AC15E3AFAECE3B","user_header":"https://static001.geekbang.org/account/avatar/00/15/25/2c/8f61089f.jpg","comment_is_top":false,"comment_ctime":1650549878,"is_pvip":false,"replies":[{"id":"125317","content":"dns缓存有有效期，可以强制刷新，或者直接请求。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1650678998,"ip_address":"","comment_id":342959,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650549878","product_id":100029001,"comment_content":"还有个问题，如果dns已缓存，那么修改之后，怎么保证不走缓存而去重新请求呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566412,"discussion_content":"dns缓存有有效期，可以强制刷新，或者直接请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650678998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342958,"user_name":"宗麒麟","can_delete":false,"product_type":"c1","uid":1385772,"ip_address":"","ucode":"AC15E3AFAECE3B","user_header":"https://static001.geekbang.org/account/avatar/00/15/25/2c/8f61089f.jpg","comment_is_top":false,"comment_ctime":1650549605,"is_pvip":false,"replies":[{"id":"125316","content":"第一个应该是业务层面的事情，不好说。<br><br>第二个是由DNS协议决定的，需要一定的广播时间，我没有细了解过，可以去看看RFC里有没有说。","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1650678955,"ip_address":"","comment_id":342958,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650549605","product_id":100029001,"comment_content":"一个是配置多个IP会不会造成资源浪费？<br>另一个是更改dns配置有生效时间，如何保证这个实效性？或者怎么确认全球范围都已生效？<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566410,"discussion_content":"第一个应该是业务层面的事情，不好说。\n\n第二个是由DNS协议决定的，需要一定的广播时间，我没有细了解过，可以去看看RFC里有没有说。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650678956,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333594,"user_name":"Wesley","can_delete":false,"product_type":"c1","uid":1447393,"ip_address":"","ucode":"C7CBB2ADDA38AA","user_header":"https://static001.geekbang.org/account/avatar/00/16/15/e1/d199f33f.jpg","comment_is_top":false,"comment_ctime":1644414830,"is_pvip":false,"replies":[{"id":"121927","content":"awesome","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1644546875,"ip_address":"","comment_id":333594,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644414830","product_id":100029001,"comment_content":"扩展一下：<br>1、使用DNS实现机房级流量调度和灾备<br>- 阿里云GTM和F5本身是一个DNS服务端，根本客户端请求源IP实现不同地域或运营商给出相应的解析结果，同时支持后端健康检查，自动剔除异常入口节点或地址池<br><br>2、使用HTTP DNS实现应用级流量调度<br>- 传统DNS受LocalDNS和客户端缓存时间限制，仅能实现分钟级（时间）或域名级别（粒度）的流量调度<br>- 客户端集成HTTP DNS SDK，动态的向HTTP DNS获取最新的解析地址，同时协议支持字段扩展，如appid、zone等，可以将域名=xxx.xxx.com，zone=华东，appid=12345的流量，从北京机房调度到上海机房","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550445,"discussion_content":"awesome","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644546875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":331899,"user_name":"镜花.水月","can_delete":false,"product_type":"c1","uid":2529101,"ip_address":"","ucode":"DC86DA7BB888F3","user_header":"https://static001.geekbang.org/account/avatar/00/26/97/4d/636e5160.jpg","comment_is_top":false,"comment_ctime":1642859240,"is_pvip":true,"replies":[{"id":"121357","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1643068542,"ip_address":"","comment_id":331899,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642859240","product_id":100029001,"comment_content":"总结<br>域名的形式<br>\t域名是一个有层次的结构，是一串用“.”分隔的多个单词，最右边的被称为“顶级域名”，然后是“二级域名”，层级关系向左依次降低。<br>域名的解析<br>\t域名必须要解析成IP地址电脑才能识别，这个过程就是“域名解析”<br>\tDNS的核心系统是一个三层的树状，分布式服务，基本对应域名的结构：<br>\t\t1.根域名服务器(Root DNS Server)：管理顶级域名服务器，返回“com”,&quot;net&quot;,&quot;cn&quot;等顶级域名<br>\t\t2.权威域名服务器(Top-level DNS Server)：管理各自域名下的权威域名服务器，比如com顶级域名可以返回apple.com 域名服务器的IP地址。<br>\t\t3.权威域名服务器(Authoritative DNS Server)：管理自己域名下主机的IP地址，比如apple.com权威域名服务器可以返回www.apple.com的IP地址。<br>\t根域名服务器是关键，它必须是众所周知的，否则下面的各级服务器就无从谈起了。目前全世界共有 13 组根域名服务器，又有数百台的镜像，保证一定能够被访问到。<br>\t减轻域名解析压力基本思路还是靠“缓存”\t<br>多学一点系列<br>\t域名总长度限制在253个字符以内，每级域名长度不能超过63个字符<br>\t域名不区分字母大写，通常小写，www.baidu.com和Www.Baidu.Com 一样<br>\t域名层级过长难于记忆。一般三层，很少四层以及四成以上<br>1.在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>\t      浏览器先会获取地址，看到地址知道不是数字形式就是域名形式，域名形式会走域名解析的流程；流程如下<br>\tDNS首先会从com层级进行查找解析，在找“不存在”的域名，如果没有找到，将消息返回给本机，再由浏览器展示出加载失败等相关页面<br>\t不过顺序不是从根服务器开始，而是从浏览器缓存 ---&gt;操作系统缓存----&gt; 本机hosts文件 ----&gt; 局域网DNS服务器 ----&gt; 广域网DNs服务器 -----&gt; 权威DNS服务器 ---&gt; 根DNS服务器<br>2.如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>\t网站访问不了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548166,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643068542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330814,"user_name":"kelinlawu","can_delete":false,"product_type":"c1","uid":2475132,"ip_address":"","ucode":"96D18B71A33277","user_header":"https://static001.geekbang.org/account/avatar/00/25/c4/7c/fa60f86f.jpg","comment_is_top":false,"comment_ctime":1642174829,"is_pvip":false,"replies":[{"id":"120988","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1642476913,"ip_address":"","comment_id":330814,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642174829","product_id":100029001,"comment_content":"1. 查找浏览器自身的DNS缓存记录<br>2. 查找操作系统的DNS缓存记录<br>3. 查找hosts文件中域名记录<br>4. 访问非权威域名服务器缓存，如三大运营商的DNS域名服务器、企业内网DNS服务器等<br>5. 非权威域名服务器发起请求去查询根域名服务器<br>6. 查询顶级域名服务器<br>7. 查询权威域名服务器<br>8. 返回IP地址，如果还是查不到则返回查询错误：Failed host lookup","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546953,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642476914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328481,"user_name":"哎呦先生","can_delete":false,"product_type":"c1","uid":1200430,"ip_address":"","ucode":"24076486C75030","user_header":"https://static001.geekbang.org/account/avatar/00/12/51/2e/6f7b0e7c.jpg","comment_is_top":false,"comment_ctime":1640749846,"is_pvip":true,"replies":[{"id":"119721","content":"good","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1640827382,"ip_address":"","comment_id":328481,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640749846","product_id":100029001,"comment_content":"1，在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>答：个人理解，解析过程共分为了一下几个步骤。<br>     1，操作系统去缓存中查找ip，查找失败<br>      2，操作系统去host映射文件中查找ip，查找失败<br>      3，调取运营商配置的野生dns服务器查找、查找失败<br>      4、查找根级域名获取com顶级服务器ip、获取顶级服务器com 地址成功<br>       5、 在com顶级服务器中查找“不存在.com”对应地址，这里是查询不到，最终返回错误的状态，浏览器显示域名解析错误。<br>总结：一个错误的域名要经过好多次查询，返回了最终的错误结果，这也解释了为什么当在浏览器输入一个不存在的地址时，浏览器要加载好久才会显示错误。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542679,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640827382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328202,"user_name":"刘敏","can_delete":false,"product_type":"c1","uid":1417888,"ip_address":"","ucode":"AB3FB7D7093D71","user_header":"https://static001.geekbang.org/account/avatar/00/15/a2/a0/df09ef0f.jpg","comment_is_top":false,"comment_ctime":1640602166,"is_pvip":false,"replies":[{"id":"119530","content":"great","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1640645762,"ip_address":"","comment_id":328202,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640602166","product_id":100029001,"comment_content":"第一个问题：<br>（1）浏览器输入www.baidu.com<br>（2）先从浏览器DNS缓存查找，如果有则结束查找。如果没有则继续，浏览器DNS缓存有存活时间TTL和大小的限制，不同浏览器一般会有不同。<br>（3）查找操作系统中是否有存在缓存，这个时候主要是从hosts文件进行查找。不同系统存放位置不同<br>（4）本地DNS服务器查找，一般都是我们的网络提供商如电信联调或者校内网这样。<br>（5）如果还没找到，则向DNS根域名查找.com所在的服务器ip<br>（6）根据.com所在的服务器信息，查找顶级域名DNS服务器，返回.baidu.com的权威DNS域名ip<br>（7）根据顶级域名DNS服务器返回的ip查找权威域名服务器，返回www.baidu.com对应的ip并返回<br>（8）本地DNS服务器会缓存此次查找结果，如果此次查找对应多个ip，则会轮询发起请求。<br><br>第二个问题：如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>应该会无法访问次网站。<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542037,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640645763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323136,"user_name":"helloWorld","can_delete":false,"product_type":"c1","uid":2793822,"ip_address":"","ucode":"E7D28A9F456959","user_header":"https://static001.geekbang.org/account/avatar/00/2a/a1/5e/4c53cb49.jpg","comment_is_top":false,"comment_ctime":1637740923,"is_pvip":false,"replies":[{"id":"117319","content":"yes.","user_name":"作者回复","user_name_real":"编辑","uid":"1181974","ctime":1637881105,"ip_address":"","comment_id":323136,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637740923","product_id":100029001,"comment_content":"哈哈，互联网还是好人多","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533473,"discussion_content":"yes.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637881105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319546,"user_name":"HILLIEX","can_delete":false,"product_type":"c1","uid":2768497,"ip_address":"","ucode":"14DF652C759FC0","user_header":"https://static001.geekbang.org/account/avatar/00/2a/3e/71/98af2a83.jpg","comment_is_top":false,"comment_ctime":1635846459,"is_pvip":false,"replies":[{"id":"115825","content":"great","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1635895952,"ip_address":"","comment_id":319546,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635846459","product_id":100029001,"comment_content":"Q1：在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br><br>A: 前面提过，域名解析的过程是“自顶向下”，并且本地计算机、附近的DNS也会做缓存。所以解析过程是（发起访问&quot;www.不存在.com&quot; --&gt; 操作系统找缓存 --&gt; hosts文件映射 --&gt; 内部DNS缓存(如果有) --&gt; 网络运营商DNS缓存（非核心？） --&gt; 根域名服务器 --&gt; 顶级域名服务器（有继续，没有就返回） --&gt; 权威域名服务器（同理） ）<br><br>Q2：如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br><br>A:由A1得知，这个问题需要分析，本地是否由缓存，如果有，则无需转发至DNS，如果没有，返回错误<br><br>评论区补充发现：<br><br>查找是基于UDP协议查找的<br>ISP（Internet Service Provider）网络服务提供商、DHCP（Dynamic Host Configuration Protocol）动态主机配置协议<br>返回多个DNS，我发现有“8.8.8.8”和“114.114.114”<br>A1上面少了一层浏览器缓存","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529666,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635895952,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315972,"user_name":"。","can_delete":false,"product_type":"c1","uid":1723580,"ip_address":"","ucode":"BFEF2648FE8A85","user_header":"https://static001.geekbang.org/account/avatar/00/1a/4c/bc/d9ef313e.jpg","comment_is_top":false,"comment_ctime":1634090399,"is_pvip":false,"replies":[{"id":"114484","content":"缓存是计算机世界的基本工具，各个环节都会用到，所以在dns这么重要的场景下，每个地方都用缓存是很正常的。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1634102734,"ip_address":"","comment_id":315972,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634090399","product_id":100029001,"comment_content":"没动手以前，一直以为hosts-&gt;浏览器缓存-&gt;操作系统缓存-&gt;dns，自己将hosts中设置127.0.0.1 www.baidu.com ，百度还能正常访问。 但是  浏览器缓存-&gt;操作系统缓存 这个就不知道如何验证了","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528218,"discussion_content":"缓存是计算机世界的基本工具，各个环节都会用到，所以在dns这么重要的场景下，每个地方都用缓存是很正常的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634102734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310579,"user_name":"Y","can_delete":false,"product_type":"c1","uid":2753697,"ip_address":"","ucode":"97D9422B3086C5","user_header":"https://static001.geekbang.org/account/avatar/00/2a/04/a1/5614eedc.jpg","comment_is_top":false,"comment_ctime":1630752945,"is_pvip":false,"replies":[{"id":"112504","content":"great","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1630761109,"ip_address":"","comment_id":310579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630752945","product_id":100029001,"comment_content":"浏览器缓存-&gt;操作系统缓存-&gt;host缓存-&gt;非权威域名服务器缓存-&gt;根域名服务器-&gt;顶级域名服务器-&gt;权威域名服务器","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526282,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630761109,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304301,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1627346508,"is_pvip":false,"replies":[{"id":"110109","content":"这个可以参考：https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;107492241","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1627347574,"ip_address":"","comment_id":304301,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1627346508","product_id":100029001,"comment_content":"全世界一共有 13 组根域名服务器（注意并不是 13 台，每一组根域名都通过任播的方式建立了一大群镜像，根据维基百科的数据，迄今已经超过 1000 台根域名服务器的镜像了），之所以有 13 这个数字的限制是因为，DNS 主要是采用 UDP 传输协议（在需要稳定性保证的时候也可以采用 TCP）来进行数据交换的，未分片的 UDP 数据包在 IPv4 下最大有效值为 512 字节，最多可以存放 13 组地址记录。<br><br>----另外一门课里面的内容<br>请教一下老师，“未分片的 UDP 数据包在 IPv4 下最大有效值为 512 字节，最多可以存放 13 组地址记录。”   这句怎么理解，每组地址记录占用多大字节呢？查了些资料，不懂。<br>https:&#47;&#47;stackoverflow.com&#47;questions&#47;1098897&#47;what-is-the-largest-safe-udp-packet-size-on-the-internet","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524009,"discussion_content":"这个可以参考：https://zhuanlan.zhihu.com/p/107492241","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627347574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052859,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","nickname":"Demon.Lee","note":"","ucode":"7F0E5493A8E345","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385919,"discussion_content":"老师这效率 ！还是自己的检索能力不够，反思！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627348456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304299,"user_name":"Stitch","can_delete":false,"product_type":"c1","uid":1949818,"ip_address":"","ucode":"FCBA3C67404291","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c0/7a/d825744f.jpg","comment_is_top":false,"comment_ctime":1627345651,"is_pvip":false,"replies":[{"id":"110107","content":"当然了，www只是最早最常用的一个域名前缀，现在的名字都可以任意取。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1627347296,"ip_address":"","comment_id":304299,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627345651","product_id":100029001,"comment_content":"老师好 想问一下 现在很多域名都不是 www 开头的 例如 image.baidu.com 这种域名<br><br>如果到了权威服务器那一步进行查询 也会返回对应的ip 吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524008,"discussion_content":"当然了，www只是最早最常用的一个域名前缀，现在的名字都可以任意取。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627347296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297665,"user_name":"includestdio.h","can_delete":false,"product_type":"c1","uid":2314854,"ip_address":"","ucode":"5027BACE9319CD","user_header":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","comment_is_top":false,"comment_ctime":1623720473,"is_pvip":true,"replies":[{"id":"108091","content":"回答的很好，可再参考其他同学的答案。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1623728323,"ip_address":"","comment_id":297665,"utype":1}],"discussion_count":1,"race_medal":4,"score":"1623720473","product_id":100029001,"comment_content":"1.如果不考虑外围缓存，浏览器先会去根域名服务器找 不存在.com 的顶级域名服务器，根域名服务器发现无法找到，然后由根域名服务器返回找不到对应IP的报错<br><br>2.无法解析出IP，或解析出错误IP","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521898,"discussion_content":"回答的很好，可再参考其他同学的答案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623728323,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292132,"user_name":"o9","can_delete":false,"product_type":"c1","uid":1101332,"ip_address":"","ucode":"E373E82A39BBFE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ce/14/b488f241.jpg","comment_is_top":false,"comment_ctime":1620699000,"is_pvip":false,"replies":[{"id":"105760","content":"可能是dns出了问题，解析失败，或者被什么其他原因给阻断了，这里面具体什么原因就不好说了。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1620703072,"ip_address":"","comment_id":292132,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1620699000","product_id":100029001,"comment_content":"大佬您好，我有个问题咨询一下，为什么不常用的`顶级域名` 在有些手机上无法访问呢？想不通","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519695,"discussion_content":"可能是dns出了问题，解析失败，或者被什么其他原因给阻断了，这里面具体什么原因就不好说了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620703072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286721,"user_name":"Leolee","can_delete":false,"product_type":"c1","uid":1928428,"ip_address":"","ucode":"2EC31B0AE5B03D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8SdpYbicwXVXt0fIN7L0f2TSGIScQIhWXT7vTze9GHBsjTvDyyQW9KEPsKBpRNs4anV61oF59BZqHf586b3o4ibw/132","comment_is_top":false,"comment_ctime":1617525692,"is_pvip":false,"replies":[{"id":"104146","content":"基本正确，不过第二个问题回答的还不太详细，可参考其他答案。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617591101,"ip_address":"","comment_id":286721,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617525692","product_id":100029001,"comment_content":"作业：<br>1：输入网址→浏览器缓存→操作系统DNS缓存→hosts文件（主机映射文件）→非权威域名服务器→根域名服务器→顶级域名服务器→二级域名服务器→权威域名服务器→报错。<br>2：DNS失效或出错了就会停止，返回报错。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518073,"discussion_content":"基本正确，不过第二个问题回答的还不太详细，可参考其他答案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617591101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286587,"user_name":"Evan Xia","can_delete":false,"product_type":"c1","uid":2310344,"ip_address":"","ucode":"6800538102355E","user_header":"https://static001.geekbang.org/account/avatar/00/23/40/c8/17af3598.jpg","comment_is_top":false,"comment_ctime":1617413879,"is_pvip":false,"replies":[{"id":"104106","content":"域名劫持是指在dns层面上改变了ip地址，你说的这个情况感觉像是页面嵌入了恶意脚本的跳转。<br><br>当然换成HTTPS肯定会增强安全性。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617450043,"ip_address":"","comment_id":286587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617413879","product_id":100029001,"comment_content":"我们公司的网络，在浏览器访问后台系统时，经常莫名其妙的就跳转到了其他网站，这就是所谓的域名劫持吧？老师。我们域名是http的，如果换成https是不是就不会被劫持了？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518037,"discussion_content":"域名劫持是指在dns层面上改变了ip地址，你说的这个情况感觉像是页面嵌入了恶意脚本的跳转。\n\n当然换成HTTPS肯定会增强安全性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617450043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286504,"user_name":"黄嘉栋。","can_delete":false,"product_type":"c1","uid":1595831,"ip_address":"","ucode":"ACE2458F2F4A6C","user_header":"https://static001.geekbang.org/account/avatar/00/18/59/b7/ee7ca327.jpg","comment_is_top":false,"comment_ctime":1617349676,"is_pvip":false,"replies":[{"id":"104072","content":"good","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1617366669,"ip_address":"","comment_id":286504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617349676","product_id":100029001,"comment_content":"1，现在本地缓存查找-&gt;网络运营商非权威的DNS服务-&gt;权威DNS服务-&gt;无效域名<br>2，无法通过域名访问某些本机没有缓存的url地址","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518013,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617366669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282435,"user_name":"学不动了","can_delete":false,"product_type":"c1","uid":1235562,"ip_address":"","ucode":"6855C982ECC3A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/6a/6b96edbd.jpg","comment_is_top":false,"comment_ctime":1615251922,"is_pvip":true,"replies":[{"id":"102545","content":"<br>1.课程里讲的只是最基本的域名解析过程，实际上本地dns可能不会直接去找根dns，而是去找它的上一级dns服务器，但最终的解析必然要从根开始。<br><br>2.dns缓存的是域名解析的结果，也就是ip地址，但它作为一个服务器应用，也会保存一些其他dns服务器的信息，这两个不是一个事。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615255693,"ip_address":"","comment_id":282435,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615251922","product_id":100029001,"comment_content":"老师你好，关于域名解析的顺序我有点疑惑，在本地网卡设置的的域名服务器没有要访问的域名的缓存的时候，接下来是到根域名服务器去找还是顶级域名服务器？我看有的同学说的是到根域名服务器，有的是顶级域名服务器。DNS缓存中是否包含域名服务器？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516744,"discussion_content":"\n1.课程里讲的只是最基本的域名解析过程，实际上本地dns可能不会直接去找根dns，而是去找它的上一级dns服务器，但最终的解析必然要从根开始。\n\n2.dns缓存的是域名解析的结果，也就是ip地址，但它作为一个服务器应用，也会保存一些其他dns服务器的信息，这两个不是一个事。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615255693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282426,"user_name":"学不动了","can_delete":false,"product_type":"c1","uid":1235562,"ip_address":"","ucode":"6855C982ECC3A8","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/6a/6b96edbd.jpg","comment_is_top":false,"comment_ctime":1615249687,"is_pvip":true,"replies":[{"id":"102546","content":"域名和ip地址是多对多的关系，一个域名可以有多个ip地址，一个ip地址也可以是多个域名，互相随便映射。<br><br>具体怎么返回就看这个域名在dns里记录的是什么信息了，有多个ip地址，就相当于dns负载均衡。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1615255772,"ip_address":"","comment_id":282426,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1615249687","product_id":100029001,"comment_content":"域名和IP地址的关系不是N对1嘛？为什么说域名解析可以返回多个 IP 地址？这里说的返回多个IP地址是指多个域名服务器的地址，还是域名服务器下的主机地址？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516742,"discussion_content":"域名和ip地址是多对多的关系，一个域名可以有多个ip地址，一个ip地址也可以是多个域名，互相随便映射。\n\n具体怎么返回就看这个域名在dns里记录的是什么信息了，有多个ip地址，就相当于dns负载均衡。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615255772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1235562,"avatar":"https://static001.geekbang.org/account/avatar/00/12/da/6a/6b96edbd.jpg","nickname":"学不动了","note":"","ucode":"6855C982ECC3A8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":354277,"discussion_content":"受教了，对于http的认知都是从网上看的一些文章学来的，零散片面，还有一些是错误的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615266844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280014,"user_name":"🔥是希文er啊","can_delete":false,"product_type":"c1","uid":1349886,"ip_address":"","ucode":"0BA75A0646164C","user_header":"https://static001.geekbang.org/account/avatar/00/14/98/fe/4d112a94.jpg","comment_is_top":false,"comment_ctime":1614054117,"is_pvip":false,"replies":[{"id":"101749","content":"thanks","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1614128867,"ip_address":"","comment_id":280014,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614054117","product_id":100029001,"comment_content":"收获满满","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515955,"discussion_content":"thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614128867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276422,"user_name":"乘风破浪","can_delete":false,"product_type":"c1","uid":2406841,"ip_address":"","ucode":"937AF15F3FEBDC","user_header":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","comment_is_top":false,"comment_ctime":1611915676,"is_pvip":false,"replies":[{"id":"100444","content":"实践出真知，感谢补充！","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1612141738,"ip_address":"","comment_id":276422,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611915676","product_id":100029001,"comment_content":"做了一下实验修正了一下关于dns解析次序<br>多数人认知的dns解析次序<br>浏览器缓存-&gt;操作系统dnscache -&gt;hosts文件-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器。<br>实际次序<br>浏览器缓存-&gt;操作系统dnscache【包含hosts】 -&gt;-&gt;非权威域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;二级域名服务器-&gt;权威域名服务器。<br>主要区别在hosts,<br>win10会在启动时加载hosts中的条目到操作系统dns缓存<br>win10还会监视hosts文件的变化，并动态更新，如新加或删除条目，都会更新操作系统dns缓存<br>如果尝试解析一个未知的域名，win10并不会访问hosts,观察依据是hosts的访问时间不会更新。<br>其它系统，有条件的同学试一试。<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514695,"discussion_content":"实践出真知，感谢补充！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612141738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272570,"user_name":"乘风破浪","can_delete":false,"product_type":"c1","uid":2406841,"ip_address":"","ucode":"937AF15F3FEBDC","user_header":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","comment_is_top":false,"comment_ctime":1610161393,"is_pvip":false,"replies":[{"id":"98893","content":"这里的说法比较简化，因为是站在上层看，所以就没有涉及太多下层细节，感谢补充。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1610331528,"ip_address":"","comment_id":272570,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610161393","product_id":100029001,"comment_content":"使用 IP 地址把 MAC 编号转换成了四位数字”---感觉表述有点问题，<br>数据报文的一般形式是：mac+ip+tcp+http, mac有本地属性，即同一个广播域是唯一的，每经过一个网段都会被替换掉，即mac1-&gt;macn,报文形式上还是mac+ip+tcp+http，而不是被ip转换<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513314,"discussion_content":"这里的说法比较简化，因为是站在上层看，所以就没有涉及太多下层细节，感谢补充。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610331528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258420,"user_name":"Airsaid","can_delete":false,"product_type":"c1","uid":1115302,"ip_address":"","ucode":"5B90BC0044F376","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/a6/18c4f73c.jpg","comment_is_top":false,"comment_ctime":1604419514,"is_pvip":false,"replies":[{"id":"94112","content":"汗，这个相当于对全世界宣战了吧，不太可能发生。<br><br>而且这些根域名服务器都有很多镜像，可用度和可靠度都是很高的。<br><br>当然，也发生过一些根域名服务器被污染的情况，感兴趣可以搜一下了解。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1604454245,"ip_address":"","comment_id":258420,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1604419514","product_id":100029001,"comment_content":"老师您好，13 组根域名服务器如果被停了，那岂不是大家都上不了网了😂","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508647,"discussion_content":"汗，这个相当于对全世界宣战了吧，不太可能发生。\n\n而且这些根域名服务器都有很多镜像，可用度和可靠度都是很高的。\n\n当然，也发生过一些根域名服务器被污染的情况，感兴趣可以搜一下了解。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604454245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242891,"user_name":"xing.org1^","can_delete":false,"product_type":"c1","uid":1374066,"ip_address":"","ucode":"C68AEA172B1623","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","comment_is_top":false,"comment_ctime":1597886433,"is_pvip":false,"replies":[{"id":"89554","content":"ip地址通常是由运营商分配，但一般在内网，会由路由器、交换机自动分配获取。<br><br>ip地址就是一个数字，相当于一个身份证号，分到什么就是什么，ip地址是由国际组织ICANN管理的。<br><br>ip地址到mac是一个映射，两者没有直接关系，ip地址在ip层通信用，mac地址在链路层通信用。<br><br>这些知识有点底层，建议再看看相关的资料理清楚概念。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1597888842,"ip_address":"","comment_id":242891,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1597886433","product_id":100029001,"comment_content":"老师开篇说“IP 协议的职责是“网际互连”，它在 MAC 层之上，使用 IP 地址把 MAC 编号转换成了四位数字”<br>我的问题是ip地址是运营商分配的吗？如果是转换来的，那有转换规则吗？比如是否有类似域名解析那样，将固定字符串转为对应数字的规则？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504125,"discussion_content":"ip地址通常是由运营商分配，但一般在内网，会由路由器、交换机自动分配获取。\n\nip地址就是一个数字，相当于一个身份证号，分到什么就是什么，ip地址是由国际组织ICANN管理的。\n\nip地址到mac是一个映射，两者没有直接关系，ip地址在ip层通信用，mac地址在链路层通信用。\n\n这些知识有点底层，建议再看看相关的资料理清楚概念。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597888842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1374066,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f7/72/2d35f80c.jpg","nickname":"xing.org1^","note":"","ucode":"C68AEA172B1623","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301091,"discussion_content":"好，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598405447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236613,"user_name":"马哲富","can_delete":false,"product_type":"c1","uid":1107917,"ip_address":"","ucode":"D6BDDFE3CC07ED","user_header":"https://static001.geekbang.org/account/avatar/00/10/e7/cd/08088f14.jpg","comment_is_top":false,"comment_ctime":1595478720,"is_pvip":false,"replies":[{"id":"87428","content":"dns基于udp协议，在传输层之上，所以是应用层。<br><br>注意，一般我们说的应用层，都是基于tcp&#47;ip的四层模型来说的，iso七层中的5&#47;6一般很少用。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1595481214,"ip_address":"","comment_id":236613,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1595478720","product_id":100029001,"comment_content":"如果DNS是来把域名解析成IP地址的，根据网络7层模型，客户端发送一个请求，经过物理层，链路层，再到网络层，这个时候网络层用的是IP地址，那又为什么说DNS是作用在应用层呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502143,"discussion_content":"dns基于udp协议，在传输层之上，所以是应用层。\n\n注意，一般我们说的应用层，都是基于tcp/ip的四层模型来说的，iso七层中的5/6一般很少用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595481214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":235071,"user_name":"宝仔","can_delete":false,"product_type":"c1","uid":1013493,"ip_address":"","ucode":"A0F17DFF99DB21","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/f5/e3f5bd8d.jpg","comment_is_top":false,"comment_ctime":1594884551,"is_pvip":true,"replies":[{"id":"86736","content":"13个根域名服务器大都在美日欧，由权威机构维护，比如NASA、ICANN、VeriSign，还有其他的一些镜像站点分散在世界各地。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1594887292,"ip_address":"","comment_id":235071,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1594884551","product_id":100029001,"comment_content":"老师问一下,根域名服务器是谁在维护?","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501597,"discussion_content":"13个根域名服务器大都在美日欧，由权威机构维护，比如NASA、ICANN、VeriSign，还有其他的一些镜像站点分散在世界各地。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594887292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1013493,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/f5/e3f5bd8d.jpg","nickname":"宝仔","note":"","ucode":"A0F17DFF99DB21","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291690,"discussion_content":"好的，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594909146,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225808,"user_name":"潇潇雨歇","can_delete":false,"product_type":"c1","uid":1251429,"ip_address":"","ucode":"4BD52BF0F0A084","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","comment_is_top":false,"comment_ctime":1591864731,"is_pvip":false,"replies":[{"id":"83203","content":"<br>1.正确。<br><br>2.dns解析失败，拿不到ip，就无法建立连接发送请求。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1591879717,"ip_address":"","comment_id":225808,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591864731","product_id":100029001,"comment_content":"1、浏览器缓存-操作系统缓存-hosts-非权威域名服务器-根域名服务器-顶级域名服务器-权威域名服务器<br>2、访问不到或者访问到其他的资源","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497998,"discussion_content":"\n1.正确。\n\n2.dns解析失败，拿不到ip，就无法建立连接发送请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591879717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223866,"user_name":"Maske","can_delete":false,"product_type":"c1","uid":1696847,"ip_address":"","ucode":"A19BB41A47E852","user_header":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","comment_is_top":false,"comment_ctime":1591198801,"is_pvip":true,"replies":[{"id":"82440","content":"<br>1.漏了一个“野生”dns服务器。<br><br>2.dns解析失败不是访问超时，访问超时应该是获取ip地址后发送请求长时间无响应。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1591233062,"ip_address":"","comment_id":223866,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1591198801","product_id":100029001,"comment_content":"1.首先本机操作系统中是否有对该域名的缓存，如果没有就去主机映射文件寻找，如果再没有才会去请求服务器。首先请求根域名服务器 ，返回.com域名对应的ip地址，然后请求.com的顶级域名服务器，查询‘’.不存在‘’的ip地址 ，如果查询到了，最后才去请求权威域名服务器www。<br>2.无法将域名解析为正确的ip地址，导致访问超时。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497272,"discussion_content":"\n1.漏了一个“野生”dns服务器。\n\n2.dns解析失败不是访问超时，访问超时应该是获取ip地址后发送请求长时间无响应。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591233062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1696847,"avatar":"https://static001.geekbang.org/account/avatar/00/19/e4/4f/df6d810d.jpg","nickname":"Maske","note":"","ucode":"A19BB41A47E852","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278988,"discussion_content":"好的，感谢老师指正","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591268308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222174,"user_name":"Hale","can_delete":false,"product_type":"c1","uid":1129731,"ip_address":"","ucode":"1925955343FE94","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/03/b2d9a084.jpg","comment_is_top":false,"comment_ctime":1590712791,"is_pvip":true,"replies":[{"id":"81887","content":"关于域名商业方面的就不是太了解了，感觉应该不用。","user_name":"作者回复","user_name_real":"罗剑锋","uid":"1181974","ctime":1590714972,"ip_address":"","comment_id":222174,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590712791","product_id":100029001,"comment_content":"一些子域名也是单独购买的吗？例如对外的api.xxx.com&#47;的接口","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496703,"discussion_content":"关于域名商业方面的就不是太了解了，感觉应该不用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590714972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219604,"user_name":"易天行","can_delete":false,"product_type":"c1","uid":1583489,"ip_address":"","ucode":"1A2004CE3D485B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/IIbpOZiahJl6WTCBp64TyvtMJ0l7qC9Z17Xbat3adAVOwx9l8hCTdzB0xzWXKofp2n2nrkOw9iaYicH5RzpFz03Pw/132","comment_is_top":false,"comment_ctime":1590049860,"is_pvip":false,"replies":[{"id":"81158","content":"没错啊，根服务器=&gt;顶级服务器=&gt;权威服务器。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1590108661,"ip_address":"","comment_id":219604,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590049860","product_id":100029001,"comment_content":"www.apple.com dns解析过程不对吧，dig里看到是先找到13个根，在找到com的NS， 再找到apple.com的NS","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495871,"discussion_content":"没错啊，根服务器=&amp;gt;顶级服务器=&amp;gt;权威服务器。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590108661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207955,"user_name":"珈蓝白塔","can_delete":false,"product_type":"c1","uid":1131137,"ip_address":"","ucode":"FADBA4B1EC768D","user_header":"https://static001.geekbang.org/account/avatar/00/11/42/81/788cd471.jpg","comment_is_top":false,"comment_ctime":1587222145,"is_pvip":false,"replies":[{"id":"77798","content":"我对DNS系统其实不是特别了解，RFC没有太仔细看，专栏里只是采用了国内比较流行的说法。<br><br>我觉得这个你也不用太在意，只要大家在沟通的时候达成共识就行，说法不同也没有实质性影响，不必当“语言律师”。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1587344185,"ip_address":"","comment_id":207955,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1587222145","product_id":100029001,"comment_content":"前辈我又来问问题了，拿极客时间的域名 time.geekbang.org 来举例，文中说.com是顶级域名，其左侧的 geekbang 是二级域名；但可以看到很多说法是，geekbang 是一级域名，time 才是二级域名，比如很多讲跨域的文章，会说 api1.data.com 和 api2.data.com 受到同源策略限制，因为它们的二级域名不同，即这里紧挨着顶级域名 .com 的 data 被视作一级域名。我也查了相关资料，得到的结果是，这其实就是大家不同的称呼而已，并不是说“一级域名”的说法就是错的，也就是说不用太在乎这个，是这样吗，相关标准有明确的定义吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492296,"discussion_content":"我对DNS系统其实不是特别了解，RFC没有太仔细看，专栏里只是采用了国内比较流行的说法。\n\n我觉得这个你也不用太在意，只要大家在沟通的时候达成共识就行，说法不同也没有实质性影响，不必当“语言律师”。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587344185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2406841,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b9/b9/9e4d7aa4.jpg","nickname":"乘风破浪","note":"","ucode":"937AF15F3FEBDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340800,"discussion_content":"顶级域名，又称一级域名，常见的有&#34;.com&#34;、&#34;.org&#34;、&#34;.net&#34;、&#34;.cn&#34;等。\n&#34;二级域名&#34;就是在一级域名前再加一级，如&#34;baidu.com&#34;。\n参考：https://baike.baidu.com/item/%E9%A1%B6%E7%BA%A7%E5%9F%9F%E5%90%8D/2152551?fr=aladdin\n所以顶级域名就是一级域名，你的问题中\norg是顶级/一级域名\ngeekbang是二级域名\ntime是主机名\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610162393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1131137,"avatar":"https://static001.geekbang.org/account/avatar/00/11/42/81/788cd471.jpg","nickname":"珈蓝白塔","note":"","ucode":"FADBA4B1EC768D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240407,"discussion_content":"确实是，前辈说的有道理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587359966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206180,"user_name":"Joker","can_delete":false,"product_type":"c1","uid":1156592,"ip_address":"","ucode":"126AF848001A1E","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/f0/8648c464.jpg","comment_is_top":false,"comment_ctime":1586818086,"is_pvip":false,"replies":[{"id":"76984","content":"内部的DNS，不是CDN。<br><br>CDN是内容缓存，而DNS是名字服务。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1586825603,"ip_address":"","comment_id":206180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586818086","product_id":100029001,"comment_content":"第二种，因为域名是一个名字空间，所以可以使用 bind9 等开源软件搭建一个在内部使用的 DNS，作为名字服务器<br>---<br>相当于一个内网的CDN？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491703,"discussion_content":"内部的DNS，不是CDN。\n\nCDN是内容缓存，而DNS是名字服务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586825603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204137,"user_name":"王晓蘅","can_delete":false,"product_type":"c1","uid":1467926,"ip_address":"","ucode":"09B6D5D8A40CAA","user_header":"https://static001.geekbang.org/account/avatar/00/16/66/16/b8e6436c.jpg","comment_is_top":false,"comment_ctime":1586340220,"is_pvip":false,"replies":[{"id":"76390","content":"基本正确。前面少了本地dns的查询，后面不是返回无效的网址，而是dns解析失败。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1586394340,"ip_address":"","comment_id":204137,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586340220","product_id":100029001,"comment_content":"www.dontexist.com<br>先是通过com的顶级DNS域名解析，找到对应的dontexist的DNS，这个时候其实已经不存在，就直接返回无效的网址。<br>后果是访问不到指定资源","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491085,"discussion_content":"基本正确。前面少了本地dns的查询，后面不是返回无效的网址，而是dns解析失败。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586394340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201486,"user_name":"YsnowLove","can_delete":false,"product_type":"c1","uid":1439301,"ip_address":"","ucode":"70433D98592481","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/rMgAbbKiasa1qR35ht0GEfwsHXbusPZAe9JFgicDgVRy8vQET2hypuDgwtHoPVU23RUoMdK7qA7gibMlTExpYibtbw/132","comment_is_top":false,"comment_ctime":1585794942,"is_pvip":false,"replies":[{"id":"75391","content":"当然是公网ip了，不然你就无法访问了。<br><br>比起网站数量来说，其实ip地址还是很多的。而且还有虚拟主机技术，在一个ip上可以有多个域名。<br><br>可以在去了解一下tcp&#47;ip协议，看看ip地址的分配。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585810937,"ip_address":"","comment_id":201486,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585794942","product_id":100029001,"comment_content":"老师，域名绑定的IP地址是公网IP吗？但是公网IP地址很少？全世界网站这么多，这个时候如何映射？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490350,"discussion_content":"当然是公网ip了，不然你就无法访问了。\n\n比起网站数量来说，其实ip地址还是很多的。而且还有虚拟主机技术，在一个ip上可以有多个域名。\n\n可以在去了解一下tcp/ip协议，看看ip地址的分配。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585810937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199269,"user_name":"半桶水","can_delete":false,"product_type":"c1","uid":1910747,"ip_address":"","ucode":"84664F628D34B5","user_header":"https://static001.geekbang.org/account/avatar/00/1d/27/db/c9f46e81.jpg","comment_is_top":false,"comment_ctime":1585485330,"is_pvip":false,"replies":[{"id":"74798","content":"<br>1.需要配置，不过很多时候会自动配置一个默认的dns。<br><br>2.是的，有一个时间窗口，会逐渐转播到所有的dns服务器。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585530796,"ip_address":"","comment_id":199269,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585485330","product_id":100029001,"comment_content":"老师，你好我有两个问题:1.dns是怎么选择非权威域名服务器的？2.域名更换了绑定的ip，非权威域名服务器还没来得及更新时，是不是会还是解析到原ip","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489814,"discussion_content":"\n1.需要配置，不过很多时候会自动配置一个默认的dns。\n\n2.是的，有一个时间窗口，会逐渐转播到所有的dns服务器。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585530796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196830,"user_name":"Change","can_delete":false,"product_type":"c1","uid":1161260,"ip_address":"","ucode":"FB60D2378C9F02","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/2c/0f7baf3a.jpg","comment_is_top":false,"comment_ctime":1585316322,"is_pvip":false,"replies":[{"id":"74585","content":"根域名服务器必须是已知的，有固定的地址。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1585380281,"ip_address":"","comment_id":196830,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1585316322","product_id":100029001,"comment_content":"老师有个疑问，域名解析时，是根据什么找到的根域名服务器？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489399,"discussion_content":"根域名服务器必须是已知的，有固定的地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585380281,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175252,"user_name":"猫头鹰波波","can_delete":false,"product_type":"c1","uid":1019787,"ip_address":"","ucode":"573AC477FA869C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8f/8b/9080f1fa.jpg","comment_is_top":false,"comment_ctime":1580631593,"is_pvip":false,"replies":[{"id":"68257","content":"这事不能说太细……","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1580782843,"ip_address":"","comment_id":175252,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1580631593","product_id":100029001,"comment_content":"我们国家的防火墙机制就是DNS屏蔽对应的网站么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482666,"discussion_content":"这事不能说太细……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580782843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1910075,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/25/3b/a971fc8e.jpg","nickname":"阿感","note":"","ucode":"7BCB7E44A832D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217277,"discussion_content":"河蟹⚠️","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585536710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173544,"user_name":"Ronnyz","can_delete":false,"product_type":"c1","uid":1488280,"ip_address":"","ucode":"9F34527B1D343D","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg","comment_is_top":false,"comment_ctime":1579592263,"is_pvip":false,"replies":[{"id":"67303","content":"这个真不知道，抱歉啊。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1579649919,"ip_address":"","comment_id":173544,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579592263","product_id":100029001,"comment_content":"想请教下老师，修改host去广告的方法是怎样实现的？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482109,"discussion_content":"这个真不知道，抱歉啊。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579649919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166865,"user_name":"欧雄虎(Badguy）","can_delete":false,"product_type":"c1","uid":1573307,"ip_address":"","ucode":"D72B1CC455AA56","user_header":"https://static001.geekbang.org/account/avatar/00/18/01/bb/7d15d44a.jpg","comment_is_top":false,"comment_ctime":1577618614,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1577618614","product_id":100029001,"comment_content":"yes<br>","like_count":0},{"had_liked":false,"id":164236,"user_name":"Wr","can_delete":false,"product_type":"c1","uid":1713790,"ip_address":"","ucode":"738B316AA2AD66","user_header":"https://static001.geekbang.org/account/avatar/00/1a/26/7e/823c083e.jpg","comment_is_top":false,"comment_ctime":1576912841,"is_pvip":false,"replies":[{"id":"62544","content":"回答正确。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1577062683,"ip_address":"","comment_id":164236,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1576912841","product_id":100029001,"comment_content":"1. 根据本地缓存解析<br>2. 根据host文件解析<br>3. 根据本地网卡的DNS服务解析<br>4. 到达最近的DNS代理服务器进行解析（根域名-&gt;顶级域名-&gt;权威域名）<br><br>访问失败<br>","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478690,"discussion_content":"回答正确。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577062683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145313,"user_name":"蓝配鸡","can_delete":false,"product_type":"c1","uid":1348738,"ip_address":"","ucode":"C79A7CA8885B7C","user_header":"https://static001.geekbang.org/account/avatar/00/14/94/82/d0a417ba.jpg","comment_is_top":false,"comment_ctime":1572249363,"is_pvip":false,"replies":[{"id":"56047","content":"回答的很好。<br><br>不过学习进度也不要太快，适当休息，让大脑放松一下。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1572250160,"ip_address":"","comment_id":145313,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1572249363","product_id":100029001,"comment_content":"在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>沿着以下的顺序找， 谁先找到就返回并退出查找。<br>浏览器缓存 - 操作系统 - hosts文件 - 第三方resolver - 根域名 - 顶级域名 - 权威域名<br><br>如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>由于DNS是存在于应用层上的，我们可以假设数据的完整性。 所以出错了的情况可能只是返回一个错误码， 无法找到对应的IP。 浏览器就无法继续下一步了。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472334,"discussion_content":"回答的很好。\n\n不过学习进度也不要太快，适当休息，让大脑放松一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572250160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1348738,"avatar":"https://static001.geekbang.org/account/avatar/00/14/94/82/d0a417ba.jpg","nickname":"蓝配鸡","note":"","ucode":"C79A7CA8885B7C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":40644,"discussion_content":"其实我已经看过一遍了， 之前没有答题...现在来补一下巩固一下顺便加深一下映像。 谢谢老师的提醒和如此快的反馈！ 🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572250301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140539,"user_name":"CN....","can_delete":false,"product_type":"c1","uid":1228489,"ip_address":"","ucode":"2C265A33D4C642","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/c9/505bfb99.jpg","comment_is_top":false,"comment_ctime":1570978997,"is_pvip":false,"replies":[{"id":"54333","content":"可以，但服务器只认一个，哪一个有效要看服务器具体实现。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1571014932,"ip_address":"","comment_id":140539,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570978997","product_id":100029001,"comment_content":"host字段可以有两个吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470432,"discussion_content":"可以，但服务器只认一个，哪一个有效要看服务器具体实现。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571014932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140296,"user_name":"冫改♚网名♤","can_delete":false,"product_type":"c1","uid":1387974,"ip_address":"","ucode":"773673D200BC20","user_header":"https://static001.geekbang.org/account/avatar/00/15/2d/c6/d34990fb.jpg","comment_is_top":false,"comment_ctime":1570872484,"is_pvip":false,"replies":[{"id":"54340","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1571015683,"ip_address":"","comment_id":140296,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570872484","product_id":100029001,"comment_content":"1. 在浏览器器中输入不存在的域名后：DNS开始运作，依次查寻浏览器缓存--&gt;操作系统缓存--&gt;Hosts文件--&gt;域名解析服务器（根域名服务器--&gt;顶级域名服务器--&gt;权威域名服务器）,直到查到内容为止。<br>2. DNS系统出错了，域名不能被正确解析，则不能正常访问到目标。之后会根据当前解析到的信息做不同处理，域名屏蔽-提示用户不能访问该域名，域名污染-直接跳转到其它域名或者提供可点击的链接域名。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470334,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571015683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128588,"user_name":"Wendy","can_delete":false,"product_type":"c1","uid":1308653,"ip_address":"","ucode":"398DDC96B178F7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","comment_is_top":false,"comment_ctime":1566909591,"is_pvip":false,"replies":[{"id":"47746","content":"对","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1566951315,"ip_address":"","comment_id":128588,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566909591","product_id":100029001,"comment_content":"DNS解析的过程：<br>浏览器DNS缓存-&gt;操作系统缓存-&gt;Hosts文件-&gt;非权威域名服务器（缓存DNS服务器，比如我们每家每户上网设置的DNS服务器）-&gt;根域名服务器-&gt;顶级域名服务器-&gt;权威域名服务器（域名注册商的DNS服务器）","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465009,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566951315,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121106,"user_name":"ZeroIce","can_delete":false,"product_type":"c1","uid":1305369,"ip_address":"","ucode":"30133BA83CE349","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/19/0d990b03.jpg","comment_is_top":false,"comment_ctime":1565059412,"is_pvip":false,"replies":[{"id":"44522","content":"有缓存就会直接返回缓存的解析结果，等缓存过期了才会再去上级dns服务器获取新的地址。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565068082,"ip_address":"","comment_id":121106,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565059412","product_id":100029001,"comment_content":"老师，我有个疑问：某公司ip地址更新了，但是由于本地浏览器依然存在缓存。虽然说缓存也有过期时间，但是我在那个过期时间内去请求该域名，是否会解析到已更新的地址？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461629,"discussion_content":"有缓存就会直接返回缓存的解析结果，等缓存过期了才会再去上级dns服务器获取新的地址。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565068082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121104,"user_name":"candy","can_delete":false,"product_type":"c1","uid":1449024,"ip_address":"","ucode":"9CA127B28F1058","user_header":"","comment_is_top":false,"comment_ctime":1565059096,"is_pvip":false,"replies":[{"id":"44520","content":"<br>回答正确。<br>","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565065450,"ip_address":"","comment_id":121104,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565059096","product_id":100029001,"comment_content":"课后回答第一个问题：<br>1.输入www.不存在.com 先去本地缓存找 这个域名对应的ip地址，发现没有，查找本地hosts文件，也没有找到。<br>2.到根级域名服务器  找到 com 顶级域名服务器地址<br>3.到com 顶级域名服务器  查找  不存在.com  找不到这个域名服务器，返回解析错误<br><br>第二个问题<br>dns失效或出错了，dns失效了，可能需要机子上重新配置网络，指定dns域名地址，dns出错了，分很多情况，浏览器可能会提示你解决方式","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461628,"discussion_content":"\n回答正确。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565065450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120936,"user_name":"Even","can_delete":false,"product_type":"c1","uid":1147948,"ip_address":"","ucode":"C3555903EE9525","user_header":"https://static001.geekbang.org/account/avatar/00/11/84/2c/1b0926b4.jpg","comment_is_top":false,"comment_ctime":1565015471,"is_pvip":true,"replies":[{"id":"44455","content":"1.具体不清楚，应该是内存磁盘都有<br><br>2.hosts文件是方便用户自己添加dns解析，与操作系统的目的不同，它不是缓存，而是一个简单的dns解析器。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1565049650,"ip_address":"","comment_id":120936,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1565015471","product_id":100029001,"comment_content":"我有个疑问，操作系统的dns缓存存在哪里？内存吗?另外有hosts文件为什么还需要操作系统的缓存,难道是因为内存访问速度快于硬盘?","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461540,"discussion_content":"1.具体不清楚，应该是内存磁盘都有\n\n2.hosts文件是方便用户自己添加dns解析，与操作系统的目的不同，它不是缓存，而是一个简单的dns解析器。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565049650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120475,"user_name":"ly","can_delete":false,"product_type":"c1","uid":1221628,"ip_address":"","ucode":"5E2B85252DABF3","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/fc/379387a4.jpg","comment_is_top":false,"comment_ctime":1564909802,"is_pvip":false,"replies":[{"id":"44235","content":"是的，客户端拿到域名解析结果之后，想怎么用就是它自己的事情了，可以直接用第一个地址，也可以缓存一段时间，轮询使用。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1564962098,"ip_address":"","comment_id":120475,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1564909802","product_id":100029001,"comment_content":"老师，还有个疑问，关于给定一个域名，DNS系统会返回多个主机IP，这种负载均衡的情况：<br>请问DNS系统会直接将该域名绑定的多个主机的ip返回给浏览器，然后客户端（如浏览器）内部缓存这些ip地址，然后自己实现一个负载均衡算法，是这样么？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461350,"discussion_content":"是的，客户端拿到域名解析结果之后，想怎么用就是它自己的事情了，可以直接用第一个地址，也可以缓存一段时间，轮询使用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564962098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6976,"discussion_content":"DNS服务器每次只返回一个IP地址，当浏览器dns缓存过期了，客户端重新请求DNS服务器，DNS上保存的A记录进行负载均衡，比如轮询算法，对域名对应的多个IP进行轮询，选择一个IP返回给客户端","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567238723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120458,"user_name":"ly","can_delete":false,"product_type":"c1","uid":1221628,"ip_address":"","ucode":"5E2B85252DABF3","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/fc/379387a4.jpg","comment_is_top":false,"comment_ctime":1564906482,"is_pvip":false,"replies":[{"id":"44231","content":"<br>1.域名系统的设计也是计算机系统里常用的分层方式，如果是扁平化的，只用一个单一的域名数据库，那么就会非常庞大，难以维护。你可以对比一下现实中的大公司组织结构。<br><br>2.第二次访问时dns服务器是否会缓存这样的不命中结果不好说，如果这个域名恰好被注册生效了呢？要看dns服务的具体实现，通常会有一个有效期，过了有效期还是要去解析。<br><br>3.基本正确，因为没有ip地址，所以无法发起http请求。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1564961753,"ip_address":"","comment_id":120458,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564906482","product_id":100029001,"comment_content":"我对域名解析过程的理解：<br>我发起“www.baidu.com”的请求，如果这个域名没有在操作系统和其他野生服务器缓存，那么就会到核心DNS系统去查，先到root域名服务器，然后返回给浏览器com的域名服务器ip地址，接着浏览器再访问com域名服务器，然后返回给浏览器baidu.com的域名服务器ip地址，最后访问第3层域名服务器，然后返回给浏览器www.baidu.com的ip地址，DNS解析完成。<br>是否是像我这样理解的呢，如果是，DNS核心系统为什么非要浏览器一级一级的访问3次才能得到一个域名的ip地址呢，个人觉得是不是太费时间了，这样设计的好处是什么呢？请老师指点迷津！！！<br><br>另外关于老师的第1个问题（访问一个不存在的域名地址）：第1次访问的时候应该还是会像一个正常的域名一样，经过操作系统缓存、野生DNS服务器、核心DNS服务器去解析，当然最终是解析不到的；但是如果第2次访问的时候，这些DNS服务器应该会缓存这个不存在的域名，然后就会直接返回解析不到，不用再次走整个流程，这个情况有点类似编程中的“缓存击穿”；<br>第2个问题DNS失效：这个我猜测客户端应该会出现一个错误码，ip地址无法得到，这个http请求应该也无法发出去。<br>请老师点评！！！！","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461341,"discussion_content":"\n1.域名系统的设计也是计算机系统里常用的分层方式，如果是扁平化的，只用一个单一的域名数据库，那么就会非常庞大，难以维护。你可以对比一下现实中的大公司组织结构。\n\n2.第二次访问时dns服务器是否会缓存这样的不命中结果不好说，如果这个域名恰好被注册生效了呢？要看dns服务的具体实现，通常会有一个有效期，过了有效期还是要去解析。\n\n3.基本正确，因为没有ip地址，所以无法发起http请求。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564961753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118245,"user_name":"四月的紫色花","can_delete":false,"product_type":"c1","uid":1564190,"ip_address":"","ucode":"67863848E5D766","user_header":"https://static001.geekbang.org/account/avatar/00/17/de/1e/ca04d2c5.jpg","comment_is_top":false,"comment_ctime":1564300200,"is_pvip":false,"replies":[{"id":"43360","content":"第一个，dns解析每次都会先从缓存找起，也就是浏览器缓存--操作系统缓存--hosts文件，都没有才会去请求本地dns，再走核心dns系统。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1564361873,"ip_address":"","comment_id":118245,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564300200","product_id":100029001,"comment_content":"1.在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>如果是第一次登录这个网址，会先到根域名服务器去找com对应的顶级域名服务器，然后com顶级域名服务器会去找名字叫做“不存在.com”的权威域名服务器，“不存在.com”在返回 www.不存在.com<br>如果非首次登录，那会按下面顺序找：浏览器缓存--操作系统缓存--hosts文件<br><br>2.如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>结果肯定就是查不到了，因为域名无法解析，没办法找到IP，也就搞不到mac，找不到主机服务器😀","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460320,"discussion_content":"第一个，dns解析每次都会先从缓存找起，也就是浏览器缓存--操作系统缓存--hosts文件，都没有才会去请求本地dns，再走核心dns系统。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564361873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117421,"user_name":"温木","can_delete":false,"product_type":"c1","uid":1507210,"ip_address":"","ucode":"EAB6EDD6EDFE96","user_header":"","comment_is_top":false,"comment_ctime":1564043552,"is_pvip":false,"replies":[{"id":"43057","content":"thanks。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1564102738,"ip_address":"","comment_id":117421,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564043552","product_id":100029001,"comment_content":"讲的通俗易懂","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459959,"discussion_content":"thanks。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564102738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115544,"user_name":"狼的诱惑","can_delete":false,"product_type":"c1","uid":1257043,"ip_address":"","ucode":"AE89DFC5963C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/2e/53/bf62683f.jpg","comment_is_top":false,"comment_ctime":1563615810,"is_pvip":false,"replies":[{"id":"42325","content":"nginx可以做四层和七层负载均衡，而bind9是dns服务器，所以可能要在nginx里配置stream，转发udp报文。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1563757376,"ip_address":"","comment_id":115544,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563615810","product_id":100029001,"comment_content":"在浏览器地址栏里随便输入一个不存在的域名，比如就叫“www. 不存在.com”，试着解释一下它的 DNS 解析过程。<br>1、查询本地缓存，存在直接返回<br>2、本地缓存不存在，查询本地hosts配置文件，存在返回<br>3、本地hosts配置文件不存在，查询运营商dns缓存，存在返回<br>4、最后才是查询远程dns服务，按照根域名、顶级域名、权威域名依次查询解析，直到返回结果<br>如果因为某些原因，DNS 失效或者出错了，会出现什么后果？<br>这个直接返回找不到服务器 IP 地址，不会到传输层<br><br>1、hosts文件里的配置实际上就相当于远程的DNS服务器，但仅限于本地使用，比如自定义一个域名映射到一个经常需要访问的IP地址，或经常需要变更的IP地址<br>2、bind9 是不是许多公司都在内部使用，大家可以访问bind9来获取到公共的IP地址，代码里可直接写死域名即可，变更时不需要修改代码，重新上线<br><br>老师请教个问题：<br>bind9和nginx一起应用吗？怎么配合做负载均衡","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459152,"discussion_content":"nginx可以做四层和七层负载均衡，而bind9是dns服务器，所以可能要在nginx里配置stream，转发udp报文。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563757376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113252,"user_name":"Mr.Chen","can_delete":false,"product_type":"c1","uid":1559182,"ip_address":"","ucode":"2AF23AAF147037","user_header":"https://static001.geekbang.org/account/avatar/00/17/ca/8e/4b1d7063.jpg","comment_is_top":false,"comment_ctime":1562924649,"is_pvip":false,"replies":[{"id":"41230","content":"这方面我还真没有经验，因为域名属于重要的商业资源，不能谁都可以改，所以应该是有授权才能改吧。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562937306,"ip_address":"","comment_id":113252,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562924649","product_id":100029001,"comment_content":"老师好，如何自己去向dns服务器发送ip和域名映射关系呢，或者说就不能自己做，只能通过域名服务商做","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458132,"discussion_content":"这方面我还真没有经验，因为域名属于重要的商业资源，不能谁都可以改，所以应该是有授权才能改吧。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562937306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111031,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1562425899,"is_pvip":false,"replies":[{"id":"40524","content":"这个看dns服务器的内部实现机制，有简单的，也有复杂的。像你说的这种，要选择压力小的，就需要有一套后台的监控系统，这就比较复杂了，cdn就是这样。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562548509,"ip_address":"","comment_id":111031,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1562425899","product_id":100029001,"comment_content":"老师，DNS实现负载均衡第一种方式，返回多个ip让客户端选择么？我理解应该是服务器收到请求后，然后根据负载均衡算法，返回一个压力较小的服务器ip？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457186,"discussion_content":"这个看dns服务器的内部实现机制，有简单的，也有复杂的。像你说的这种，要选择压力小的，就需要有一套后台的监控系统，这就比较复杂了，cdn就是这样。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562548509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1221628,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a3/fc/379387a4.jpg","nickname":"ly","note":"","ucode":"5E2B85252DABF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3876,"discussion_content":"对老师的回答做一个简单求证，当DNS服务器实现负载均衡的时候，举个例子：假设www.a.com有2个ip绑定（1.1.1.1和2.2.2.2），用户A在请求www.a.com的时候，可以返回1.1.1.1的主机ip给用户A，因为缓存的存在，用户A下次应该不会再访问DNS服务器，直接用缓存找ip地址；用户B在请求www.a.com的时候，由于负载均衡的算法，DNS服务器会返回2.2.2.2的主机ip给用户B，用户B以后就用2.2.2.2来访问网站。\n老师看大致的原理是否和这样的类似呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564910755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":111013,"user_name":"尔冬橙","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1562421876,"is_pvip":false,"replies":[{"id":"40526","content":"你说的是不是uri后面的那些%形式的编码？可以看后面讲uri的课。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1562548612,"ip_address":"","comment_id":111013,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1562421876","product_id":100029001,"comment_content":"老师，可以讲下域名后面那些奇怪的字符么，面试被问到一脸懵逼","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457176,"discussion_content":"你说的是不是uri后面的那些%形式的编码？可以看后面讲uri的课。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562548612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"尔冬橙","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1365,"discussion_content":"对好的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562580912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105638,"user_name":"孙旗","can_delete":false,"product_type":"c1","uid":1554968,"ip_address":"","ucode":"DCED9A616139BE","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/18/0990c1d9.jpg","comment_is_top":false,"comment_ctime":1561046529,"is_pvip":false,"replies":[{"id":"38328","content":"缓存的域名有过期时间，也就是ttl，过期了就会回上一级dns取，这样就会变了。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1561125098,"ip_address":"","comment_id":105638,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561046529","product_id":100029001,"comment_content":"老师我有个疑问，A公司更新了自己的域名对应的IP地址，比如www.A.com的解析结果从1.1.1.1变成了2.2.2.2，然后它通知了根服务器更新，现在根服务器上的ip更新了，可是各级缓存的没有更新啊，如果有人访问www.A.com,然后某一级缓存发现自己有这个域名记录，给它返回了1.1.1.1，这个问题是怎么解决的呢？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454749,"discussion_content":"缓存的域名有过期时间，也就是ttl，过期了就会回上一级dns取，这样就会变了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561125098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308653,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/0PT9LxT8D6micyk0YbPuGQElQIeSax7puBBTXJDicJDhUHNibrbJPjEPJBRklVmcKG1PB7YV8JNh0BpsJjSicfibT5A/132","nickname":"Wendy","note":"","ucode":"398DDC96B178F7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6977,"discussion_content":"根服务器不会缓存吧，应该是权威域名服务器的A记录缓存在非权威域名服务器上比如三大运营商DNS或者谷歌8.8.8.8上，如果这些非权威域名服务器上找不到缓存记录，则开始请求根域名服务器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567238976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105536,"user_name":"我执","can_delete":false,"product_type":"c1","uid":1372261,"ip_address":"","ucode":"54A052C54BDE91","user_header":"https://static001.geekbang.org/account/avatar/00/14/f0/65/e1340d42.jpg","comment_is_top":false,"comment_ctime":1561023578,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561023578","product_id":100029001,"comment_content":"恶意DNS并不多见怪","like_count":0},{"had_liked":false,"id":103991,"user_name":"瑞","can_delete":false,"product_type":"c1","uid":1334600,"ip_address":"","ucode":"1C5945FD2D05C4","user_header":"https://static001.geekbang.org/account/avatar/00/14/5d/48/03abbbd1.jpg","comment_is_top":false,"comment_ctime":1560584278,"is_pvip":false,"replies":[{"id":"37623","content":"根和顶级dns由互联网组织ICANN管理，不属于任何公司。<br><br>根dns只管理顶级dns。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560601348,"ip_address":"","comment_id":103991,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560584278","product_id":100029001,"comment_content":"有个疑问，比如我备案了一个域名www.abc.com，是不是abc.com就会注册到根域名服务器上，这个根域名服务器，顶级域名服务器也是某个公司开发的吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":454082,"discussion_content":"根和顶级dns由互联网组织ICANN管理，不属于任何公司。\n\n根dns只管理顶级dns。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560601348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103396,"user_name":"Bryan","can_delete":false,"product_type":"c1","uid":1037208,"ip_address":"","ucode":"BA9D6A278609F3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/d3/98/60d13550.jpg","comment_is_top":false,"comment_ctime":1560428360,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1560428360","product_id":100029001,"comment_content":"1. 浏览器缓存 → 系统缓存 → HOSTS → DNS<br>DNS：非权威域名服务器 → 上层非权威域名服务器们 → 根域名服务器 → 顶级域名服务器 → 中间的各种域名服务器（NS 记录） → 权威域名服务器<br><br>2. 如果无本地缓存或缓存有问题那么会无法解析出 IP 地址导致无法访问相应网站","like_count":0},{"had_liked":false,"id":103286,"user_name":"福布斯第一","can_delete":false,"product_type":"c1","uid":1244851,"ip_address":"","ucode":"6DA11E1E6819F2","user_header":"https://static001.geekbang.org/account/avatar/00/12/fe/b3/964eb5ac.jpg","comment_is_top":false,"comment_ctime":1560409537,"is_pvip":false,"replies":[{"id":"37375","content":"在Windows上可以用命令行“ipconfig &#47;displaydns”看缓存的dns，存在系统内部。","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560418530,"ip_address":"","comment_id":103286,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560409537","product_id":100029001,"comment_content":"老师，这个域名的操作系统缓存能简单介绍一下吗？以前我只了解到浏览器-》hosts-〉本地域名服务器","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453818,"discussion_content":"在Windows上可以用命令行“ipconfig /displaydns”看缓存的dns，存在系统内部。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560418530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103256,"user_name":"nora","can_delete":false,"product_type":"c1","uid":1206539,"ip_address":"","ucode":"3A3EABF27D0261","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/0b/780b0aac.jpg","comment_is_top":false,"comment_ctime":1560405028,"is_pvip":false,"replies":[{"id":"37348","content":"√","user_name":"作者回复","user_name_real":"chrono","uid":"1181974","ctime":1560408803,"ip_address":"","comment_id":103256,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1560405028","product_id":100029001,"comment_content":"浏览器缓存 操作系统缓存 host文件 根域名 顶级域名 返回失败","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":453810,"discussion_content":"√","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1560408803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":102598,"user_name":"一粟","can_delete":false,"product_type":"c1","uid":1058773,"ip_address":"","ucode":"2EE966F3C36B5F","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/d5/0fd21753.jpg","comment_is_top":false,"comment_ctime":1560259972,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560259972","product_id":100029001,"comment_content":"原来Java的包名规则和域名一致，两者原理是一样的。熟悉的东西反而忽视了，终于打通了。","like_count":0},{"had_liked":false,"id":102585,"user_name":"徐海浪","can_delete":false,"product_type":"c1","uid":1078528,"ip_address":"","ucode":"21801C420D0610","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/00/618b20da.jpg","comment_is_top":false,"comment_ctime":1560258086,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1560258086","product_id":100029001,"comment_content":"1. 先从本地dns查找，找不到然后去hosts找，还找不到就去配置的dns服务器查找，解析不到就返回，立即提示域名无法解析。域名解析有一个生效时间，这个第三方域名从顶级域名同步的时间。<br>2. dns服务异常时，会在域名解析（比如用ping）的时出现等待，一段时间后提示域名无法解析。","like_count":0},{"had_liked":false,"id":102284,"user_name":"怀朔","can_delete":false,"product_type":"c1","uid":1006865,"ip_address":"","ucode":"52FAC1C2FD37B6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5d/11/e1f36640.jpg","comment_is_top":false,"comment_ctime":1560176113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560176113","product_id":100029001,"comment_content":"回答第二个问题：1、本地hosts绑定 2、野生dns服务器拦截 3、dns切换过程失效 4:ttl时间变动","like_count":0}]}