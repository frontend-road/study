{"id":102974,"title":"16 | å¤šçº¿ç¨‹è°ƒä¼˜ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•ä¼˜åŒ–å¤šçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>é€šè¿‡ä¸Šä¸€è®²çš„è®²è§£ï¼Œç›¸ä¿¡ä½ å¯¹ä¸Šä¸‹æ–‡åˆ‡æ¢å·²ç»æœ‰äº†ä¸€å®šçš„äº†è§£äº†ã€‚å¦‚æœæ˜¯å•ä¸ªçº¿ç¨‹ï¼Œåœ¨ CPU è°ƒç”¨ä¹‹åï¼Œé‚£ä¹ˆå®ƒåŸºæœ¬ä¸Šæ˜¯ä¸ä¼šè¢«è°ƒåº¦å‡ºå»çš„ã€‚å¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°è¿œå¤§äº CPU æ•°é‡ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿæœ€ç»ˆä¼šå°†æŸä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹è°ƒåº¦å‡ºæ¥ï¼Œä»è€Œä½¿å…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿä½¿ç”¨ CPU ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>è¿˜æœ‰ï¼Œåœ¨å¤šçº¿ç¨‹ä¸­å¦‚æœä½¿ç”¨äº†ç«äº‰é”ï¼Œå½“çº¿ç¨‹ç”±äºç­‰å¾…ç«äº‰é”è€Œè¢«é˜»å¡æ—¶ï¼ŒJVM é€šå¸¸ä¼šå°†è¿™ä¸ªçº¿ç¨‹æŒ‚èµ·ï¼Œå¹¶å…è®¸å®ƒè¢«äº¤æ¢å‡ºå»ã€‚å¦‚æœé¢‘ç¹åœ°å‘ç”Ÿé˜»å¡ï¼ŒCPU å¯†é›†å‹çš„ç¨‹åºå°±ä¼šå‘ç”Ÿæ›´å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨æŸäº›åœºæ™¯ä¸‹ä½¿ç”¨å¤šçº¿ç¨‹æ˜¯éå¸¸å¿…è¦çš„ï¼Œä½†å¤šçº¿ç¨‹ç¼–ç¨‹ç»™ç³»ç»Ÿå¸¦æ¥äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œå¢åŠ çš„æ€§èƒ½å¼€é”€ä¹Ÿæ˜¯å®æ‰“å®å­˜åœ¨çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•ä¼˜åŒ–å¤šçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»Šå¤©è¦å’Œä½ åˆ†äº«çš„è¯é¢˜ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»å‡ ç§å¸¸è§çš„ä¼˜åŒ–æ–¹æ³•ã€‚</p><h2>ç«äº‰é”ä¼˜åŒ–</h2><p>å¤§å¤šæ•°äººåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ç¢°åˆ°æ€§èƒ½é—®é¢˜ï¼Œç¬¬ä¸€ååº”å¤šæ˜¯æƒ³åˆ°äº†é”ã€‚</p><p>å¤šçº¿ç¨‹å¯¹é”èµ„æºçš„ç«äº‰ä¼šå¼•èµ·ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿˜æœ‰é”ç«äº‰å¯¼è‡´çš„çº¿ç¨‹é˜»å¡è¶Šå¤šï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å°±è¶Šé¢‘ç¹ï¼Œç³»ç»Ÿçš„æ€§èƒ½å¼€é”€ä¹Ÿå°±è¶Šå¤§ã€‚ç”±æ­¤å¯è§ï¼Œ<span class=\"orange\">åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œé”å…¶å®ä¸æ˜¯æ€§èƒ½å¼€é”€çš„æ ¹æºï¼Œç«äº‰é”æ‰æ˜¯ã€‚</span></p><p>ç¬¬11ï½13è®²ä¸­æˆ‘æ›¾é›†ä¸­è®²è¿‡é”ä¼˜åŒ–ï¼Œæˆ‘ä»¬çŸ¥é“é”çš„ä¼˜åŒ–å½’æ ¹ç»“åº•å°±æ˜¯å‡å°‘ç«äº‰ã€‚è¿™è®²ä¸­æˆ‘ä»¬å°±å†æ¥æ€»ç»“ä¸‹é”ä¼˜åŒ–çš„ä¸€äº›æ–¹å¼ã€‚</p><!-- [[[read_end]]] --><h3>1.å‡å°‘é”çš„æŒæœ‰æ—¶é—´</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œé”çš„æŒæœ‰æ—¶é—´è¶Šé•¿ï¼Œå°±æ„å‘³ç€æœ‰è¶Šå¤šçš„çº¿ç¨‹åœ¨ç­‰å¾…è¯¥ç«äº‰èµ„æºé‡Šæ”¾ã€‚å¦‚æœæ˜¯SynchronizedåŒæ­¥é”èµ„æºï¼Œå°±ä¸ä»…æ˜¯å¸¦æ¥çº¿ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿˜æœ‰å¯èƒ½ä¼šå¢åŠ è¿›ç¨‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>åœ¨ç¬¬12è®²ä¸­ï¼Œæˆ‘æ›¾åˆ†äº«è¿‡ä¸€äº›æ›´å…·ä½“çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥å°†ä¸€äº›ä¸é”æ— å…³çš„ä»£ç ç§»å‡ºåŒæ­¥ä»£ç å—ï¼Œå°¤å…¶æ˜¯é‚£äº›å¼€é”€è¾ƒå¤§çš„æ“ä½œä»¥åŠå¯èƒ½è¢«é˜»å¡çš„æ“ä½œã€‚</p><ul>\n<li>ä¼˜åŒ–å‰</li>\n</ul><pre><code>public synchronized void mySyncMethod(){  \n        businesscode1();  \n        mutextMethod();  \n        businesscode2();\n    }\n</code></pre><ul>\n<li>ä¼˜åŒ–å</li>\n</ul><pre><code>public void mySyncMethod(){  \n        businesscode1();  \n        synchronized(this)\n        {\n            mutextMethod();  \n        }\n        businesscode2();\n    }\n</code></pre><h3>2.é™ä½é”çš„ç²’åº¦</h3><p>åŒæ­¥é”å¯ä»¥ä¿è¯å¯¹è±¡çš„åŸå­æ€§ï¼Œ<span class=\"orange\">æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†é”ç²’åº¦æ‹†åˆ†å¾—æ›´å°ä¸€äº›ï¼Œä»¥æ­¤é¿å…æ‰€æœ‰çº¿ç¨‹å¯¹ä¸€ä¸ªé”èµ„æºçš„ç«äº‰è¿‡äºæ¿€çƒˆã€‚</span>å…·ä½“æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ul>\n<li>é”åˆ†ç¦»</li>\n</ul><p>ä¸ä¼ ç»Ÿé”ä¸åŒçš„æ˜¯ï¼Œè¯»å†™é”å®ç°äº†é”åˆ†ç¦»ï¼Œä¹Ÿå°±æ˜¯è¯´è¯»å†™é”æ˜¯ç”±â€œè¯»é”â€å’Œâ€œå†™é”â€ä¸¤ä¸ªé”å®ç°çš„ï¼Œå…¶è§„åˆ™æ˜¯å¯ä»¥å…±äº«è¯»ï¼Œä½†åªæœ‰ä¸€ä¸ªå†™ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹è¯»çš„æ—¶å€™ï¼Œè¯»è¯»æ˜¯ä¸äº’æ–¥çš„ï¼Œè¯»å†™æ˜¯äº’æ–¥çš„ï¼Œå†™å†™æ˜¯äº’æ–¥çš„ã€‚è€Œä¼ ç»Ÿçš„ç‹¬å é”åœ¨æ²¡æœ‰åŒºåˆ†è¯»å†™é”çš„æ—¶å€™ï¼Œè¯»å†™æ“ä½œä¸€èˆ¬æ˜¯ï¼šè¯»è¯»äº’æ–¥ã€è¯»å†™äº’æ–¥ã€å†™å†™äº’æ–¥ã€‚æ‰€ä»¥åœ¨è¯»è¿œå¤§äºå†™çš„å¤šçº¿ç¨‹åœºæ™¯ä¸­ï¼Œé”åˆ†ç¦»é¿å…äº†åœ¨é«˜å¹¶å‘è¯»æƒ…å†µä¸‹çš„èµ„æºç«äº‰ï¼Œä»è€Œé¿å…äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><ul>\n<li>é”åˆ†æ®µ</li>\n</ul><p>æˆ‘ä»¬åœ¨ä½¿ç”¨é”æ¥ä¿è¯é›†åˆæˆ–è€…å¤§å¯¹è±¡åŸå­æ€§æ—¶ï¼Œå¯ä»¥è€ƒè™‘å°†é”å¯¹è±¡è¿›ä¸€æ­¥åˆ†è§£ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä¹‹å‰è®²è¿‡çš„ Java1.8 ä¹‹å‰ç‰ˆæœ¬çš„ ConcurrentHashMap å°±ä½¿ç”¨äº†é”åˆ†æ®µã€‚</p><h3>3.éé˜»å¡ä¹è§‚é”æ›¿ä»£ç«äº‰é”</h3><p>volatileå…³é”®å­—çš„ä½œç”¨æ˜¯ä¿éšœå¯è§æ€§åŠæœ‰åºæ€§ï¼Œvolatileçš„è¯»å†™æ“ä½œä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå› æ­¤å¼€é”€æ¯”è¾ƒå°ã€‚ ä½†æ˜¯ï¼Œvolatileä¸èƒ½ä¿è¯æ“ä½œå˜é‡çš„åŸå­æ€§ï¼Œå› ä¸ºæ²¡æœ‰é”çš„æ’ä»–æ€§ã€‚</p><p>è€Œ CAS æ˜¯ä¸€ä¸ªåŸå­çš„ if-then-act æ“ä½œï¼Œ<span class=\"orange\">CAS æ˜¯ä¸€ä¸ªæ— é”ç®—æ³•å®ç°ï¼Œä¿éšœäº†å¯¹ä¸€ä¸ªå…±äº«å˜é‡è¯»å†™æ“ä½œçš„ä¸€è‡´æ€§ã€‚</span>CAS æ“ä½œä¸­æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œå†…å­˜å€¼ Vã€æ—§çš„é¢„æœŸå€¼ Aå’Œè¦ä¿®æ”¹çš„æ–°å€¼ Bï¼Œå½“ä¸”ä»…å½“ A å’Œ V ç›¸åŒæ—¶ï¼Œå°† V ä¿®æ”¹ä¸º Bï¼Œå¦åˆ™ä»€ä¹ˆéƒ½ä¸åšï¼ŒCAS ç®—æ³•å°†ä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚Java çš„ Atomic åŒ…å°±ä½¿ç”¨äº† CAS ç®—æ³•æ¥æ›´æ–°æ•°æ®ï¼Œå°±ä¸éœ€è¦é¢å¤–åŠ é”ã€‚</p><p>ä¸Šé¢æˆ‘ä»¬äº†è§£äº†å¦‚ä½•ä»ç¼–ç å±‚é¢å»ä¼˜åŒ–ç«äº‰é”ï¼Œé‚£ä¹ˆé™¤æ­¤ä¹‹å¤–ï¼ŒJVMå†…éƒ¨å…¶å®ä¹Ÿå¯¹SynchronizedåŒæ­¥é”åšäº†ä¼˜åŒ–ï¼Œæˆ‘åœ¨12è®²ä¸­æœ‰è¯¦ç»†åœ°è®²è§£è¿‡ï¼Œè¿™é‡Œç®€å•å›é¡¾ä¸€ä¸‹ã€‚</p><p>åœ¨JDK1.6ä¸­ï¼ŒJVMå°†SynchronizedåŒæ­¥é”åˆ†ä¸ºäº†åå‘é”ã€è½»é‡çº§é”ã€è‡ªæ—‹é”ä»¥åŠé‡é‡çº§é”ï¼Œä¼˜åŒ–è·¯å¾„ä¹Ÿæ˜¯æŒ‰ç…§ä»¥ä¸Šé¡ºåºè¿›è¡Œã€‚JIT ç¼–è¯‘å™¨åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼Œä¹Ÿä¼šé€šè¿‡é”æ¶ˆé™¤ã€é”ç²—åŒ–çš„æ–¹å¼æ¥ä¼˜åŒ–è¯¥åŒæ­¥é”ã€‚</p><h2>wait/notifyä¼˜åŒ–</h2><p>åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…åˆè°ƒç”¨ Object å¯¹è±¡çš„ wait()æ–¹æ³•å’Œ notify()æ–¹æ³•æˆ– notifyAll() æ–¹æ³•æ¥å®ç°çº¿ç¨‹é—´çš„é€šä¿¡ã€‚</p><p>åœ¨çº¿ç¨‹ä¸­è°ƒç”¨ wait()æ–¹æ³•ï¼Œå°†é˜»å¡ç­‰å¾…å…¶å®ƒçº¿ç¨‹çš„é€šçŸ¥ï¼ˆå…¶å®ƒçº¿ç¨‹è°ƒç”¨notify()æ–¹æ³•æˆ–notifyAll()æ–¹æ³•ï¼‰ï¼Œåœ¨çº¿ç¨‹ä¸­è°ƒç”¨ notify()æ–¹æ³•æˆ– notifyAll()æ–¹æ³•ï¼Œå°†é€šçŸ¥å…¶å®ƒçº¿ç¨‹ä» wait()æ–¹æ³•å¤„è¿”å›ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡wait() / notify()æ¥å®ç°ä¸€ä¸ªç®€å•çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æ¡ˆä¾‹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>public class WaitNotifyTest {\n    public static void main(String[] args) {\n        Vector&lt;Integer&gt; pool=new Vector&lt;Integer&gt;();\n        Producer producer=new Producer(pool, 10);\n        Consumer consumer=new Consumer(pool);\n        new Thread(producer).start();\n        new Thread(consumer).start();\n    }\n}\n\t/**\n\t * ç”Ÿäº§è€…\n\t * @author admin\n\t *\n\t */\n\tclass Producer implements Runnable{\n\t    private Vector&lt;Integer&gt; pool;\n\t    private Integer size;\n\t    \n\t    public Producer(Vector&lt;Integer&gt;  pool, Integer size) {\n\t        this.pool = pool;\n\t        this.size = size;\n\t    }\n\t    \n\t    public void run() {\n\t        for(;;){\n\t            try {\n\t                System.out.println(&quot;ç”Ÿäº§ä¸€ä¸ªå•†å“ &quot;);\n\t                produce(1);\n\t            } catch (InterruptedException e) {\n\t                // TODO Auto-generated catch block\n\t                e.printStackTrace();\n\t            }\n\t        }\n\t    }\n\t    private void produce(int i) throws InterruptedException{\n\t        while(pool.size()==size){\n\t            synchronized (pool) {\n\t                System.out.println(&quot;ç”Ÿäº§è€…ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹å•†å“,å½“å‰å•†å“æ•°é‡ä¸º&quot;+pool.size());\n\t                pool.wait();//ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹\n\t            }\n\t        }\n\t        synchronized (pool) {\n\t            pool.add(i);\n\t            pool.notifyAll();//ç”Ÿäº§æˆåŠŸï¼Œé€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹\n\t        }\n\t    }\n\t}\n\n\n\t/**\n\t * æ¶ˆè´¹è€…\n\t * @author admin\n\t *\n\t */\n\tclass Consumer implements Runnable{\n\t    private Vector&lt;Integer&gt;  pool;\n\t    public Consumer(Vector&lt;Integer&gt;  pool) {\n\t        this.pool = pool;\n\t    }\n\t    \n\t    public void run() {\n\t        for(;;){\n\t            try {\n\t                System.out.println(&quot;æ¶ˆè´¹ä¸€ä¸ªå•†å“&quot;);\n\t                consume();\n\t            } catch (InterruptedException e) {\n\t                // TODO Auto-generated catch block\n\t                e.printStackTrace();\n\t            }\n\t        }\n\t    }\n\t    \n\t    private void consume() throws InterruptedException{\n\t        synchronized (pool) {\n\t            while(pool.isEmpty()) {\n\t                System.out.println(&quot;æ¶ˆè´¹è€…ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§å•†å“,å½“å‰å•†å“æ•°é‡ä¸º&quot;+pool.size());\n\t                pool.wait();//ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§å•†å“\n\t            }\n\t        }\n\t        synchronized (pool) {\n\t            pool.remove(0);\n\t            pool.notifyAll();//é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§å•†å“\n\t            \n\t        }\n\t    }\n\n}\n</code></pre><h3>wait/notifyçš„ä½¿ç”¨å¯¼è‡´äº†è¾ƒå¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢</h3><p>ç»“åˆä»¥ä¸‹å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ¶ˆè´¹è€…ç¬¬ä¸€æ¬¡ç”³è¯·åˆ°é”ä¹‹å‰ï¼Œå‘ç°æ²¡æœ‰å•†å“æ¶ˆè´¹ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œ Object.wait() æ–¹æ³•ï¼Œè¿™é‡Œä¼šå¯¼è‡´çº¿ç¨‹æŒ‚èµ·ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¿™é‡Œä¸ºä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>å½“ç”Ÿäº§è€…è·å–åˆ°é”å¹¶æ‰§è¡ŒnotifyAll()ä¹‹åï¼Œä¼šå”¤é†’å¤„äºé˜»å¡çŠ¶æ€çš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œæ­¤æ—¶è¿™é‡Œåˆå‘ç”Ÿäº†ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>è¢«å”¤é†’çš„ç­‰å¾…çº¿ç¨‹åœ¨ç»§ç»­è¿è¡Œæ—¶ï¼Œéœ€è¦å†æ¬¡ç”³è¯·ç›¸åº”å¯¹è±¡çš„å†…éƒ¨é”ï¼Œæ­¤æ—¶ç­‰å¾…çº¿ç¨‹å¯èƒ½éœ€è¦å’Œå…¶å®ƒæ–°æ¥çš„æ´»è·ƒçº¿ç¨‹äº‰ç”¨å†…éƒ¨é”ï¼Œè¿™ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>å¦‚æœæœ‰å¤šä¸ªæ¶ˆè´¹è€…çº¿ç¨‹åŒæ—¶è¢«é˜»å¡ï¼Œç”¨notifyAll()æ–¹æ³•ï¼Œå°†ä¼šå”¤é†’æ‰€æœ‰é˜»å¡çš„çº¿ç¨‹ã€‚è€ŒæŸäº›å•†å“ä¾ç„¶æ²¡æœ‰åº“å­˜ï¼Œè¿‡æ—©åœ°å”¤é†’è¿™äº›æ²¡æœ‰åº“å­˜çš„å•†å“çš„æ¶ˆè´¹çº¿ç¨‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº¿ç¨‹å†æ¬¡è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œä»è€Œå¼•èµ·ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/60/0a/601517ef35af63a9e470b8531124bc0a.jpg?wh=1324*1210\" alt=\"\"></p><h3>ä¼˜åŒ–wait/notifyçš„ä½¿ç”¨ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å¤šä¸ªä¸åŒæ¶ˆè´¹åœºæ™¯ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Object.notify() æ›¿ä»£ Object.notifyAll()ã€‚ å› ä¸ºObject.notify() åªä¼šå”¤é†’æŒ‡å®šçº¿ç¨‹ï¼Œä¸ä¼šè¿‡æ—©åœ°å”¤é†’å…¶å®ƒæœªæ»¡è¶³éœ€æ±‚çš„é˜»å¡çº¿ç¨‹ï¼Œæ‰€ä»¥å¯ä»¥å‡å°‘ç›¸åº”çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>å…¶æ¬¡ï¼Œåœ¨ç”Ÿäº§è€…æ‰§è¡Œå®Œ Object.notify() / notifyAll()å”¤é†’å…¶å®ƒçº¿ç¨‹ä¹‹åï¼Œåº”è¯¥å°½å¿«åœ°é‡Šæ”¾å†…éƒ¨é”ï¼Œä»¥é¿å…å…¶å®ƒçº¿ç¨‹åœ¨å”¤é†’ä¹‹åé•¿æ—¶é—´åœ°æŒæœ‰é”å¤„ç†ä¸šåŠ¡æ“ä½œï¼Œè¿™æ ·å¯ä»¥é¿å…è¢«å”¤é†’çš„çº¿ç¨‹å†æ¬¡ç”³è¯·ç›¸åº”å†…éƒ¨é”çš„æ—¶å€™ç­‰å¾…é”çš„é‡Šæ”¾ã€‚</p><p>æœ€åï¼Œä¸ºäº†é¿å…é•¿æ—¶é—´ç­‰å¾…ï¼Œæˆ‘ä»¬å¸¸ä¼šä½¿ç”¨Object.wait (longï¼‰è®¾ç½®ç­‰å¾…è¶…æ—¶æ—¶é—´ï¼Œä½†çº¿ç¨‹æ— æ³•åŒºåˆ†å…¶è¿”å›æ˜¯ç”±äºç­‰å¾…è¶…æ—¶è¿˜æ˜¯è¢«é€šçŸ¥çº¿ç¨‹å”¤é†’ï¼Œä»è€Œå¯¼è‡´çº¿ç¨‹å†æ¬¡å°è¯•è·å–é”æ“ä½œï¼Œå¢åŠ äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>è¿™é‡Œæˆ‘å»ºè®®ä½¿ç”¨Locké”ç»“åˆCondition æ¥å£æ›¿ä»£Synchronizedå†…éƒ¨é”ä¸­çš„ wait / notifyï¼Œå®ç°ç­‰å¾…ï¼é€šçŸ¥ã€‚è¿™æ ·åšä¸ä»…å¯ä»¥è§£å†³ä¸Šè¿°çš„Object.wait(long) æ— æ³•åŒºåˆ†çš„é—®é¢˜ï¼Œè¿˜å¯ä»¥è§£å†³çº¿ç¨‹è¢«è¿‡æ—©å”¤é†’çš„é—®é¢˜ã€‚</p><p>Condition æ¥å£å®šä¹‰çš„ await æ–¹æ³• ã€signal æ–¹æ³•å’Œ signalAll æ–¹æ³•åˆ†åˆ«ç›¸å½“äº Object.wait()ã€ Object.notify()å’Œ Object.notifyAll()ã€‚</p><h2>åˆç†åœ°è®¾ç½®çº¿ç¨‹æ± å¤§å°ï¼Œé¿å…åˆ›å»ºè¿‡å¤šçº¿ç¨‹</h2><p><span class=\"orange\">çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡è®¾ç½®ä¸å®œè¿‡å¤§ï¼Œ</span>å› ä¸ºä¸€æ—¦çº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹æ€»æ•°è¶…è¿‡ç³»ç»Ÿæ‰€æ‹¥æœ‰çš„å¤„ç†å™¨æ•°é‡ï¼Œå°±ä¼šå¯¼è‡´è¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ›´å¤šå…³äºå¦‚ä½•åˆç†è®¾ç½®çº¿ç¨‹æ± æ•°é‡çš„å†…å®¹ï¼Œæˆ‘å°†åœ¨ç¬¬18è®²ä¸­è¯¦è§£ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯ï¼Œåœ¨æœ‰äº›åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹æ³•é‡Œï¼Œçº¿ç¨‹æ•°é‡è®¾ç½®ä¸ä¼šç›´æ¥æš´éœ²ç»™æˆ‘ä»¬ã€‚æ¯”å¦‚ï¼Œç”¨ Executors.newCachedThreadPool() åˆ›å»ºçš„çº¿ç¨‹æ± ï¼Œè¯¥çº¿ç¨‹æ± ä¼šå¤ç”¨å…¶å†…éƒ¨ç©ºé—²çš„çº¿ç¨‹æ¥å¤„ç†æ–°æäº¤çš„ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼ˆä¸å— MAX_VALUE é™åˆ¶ï¼‰ï¼Œè¿™æ ·çš„çº¿ç¨‹æ± å¦‚æœç¢°åˆ°å¤§é‡ä¸”è€—æ—¶é•¿çš„ä»»åŠ¡åœºæ™¯ï¼Œå°±ä¼šåˆ›å»ºéå¸¸å¤šçš„å·¥ä½œçº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å› æ­¤ï¼Œè¿™ç±»çº¿ç¨‹æ± å°±åªé€‚åˆå¤„ç†å¤§é‡ä¸”è€—æ—¶çŸ­çš„éé˜»å¡ä»»åŠ¡ã€‚</p><h2>ä½¿ç”¨åç¨‹å®ç°éé˜»å¡ç­‰å¾…</h2><p>ç›¸ä¿¡å¾ˆå¤šäººä¸€å¬åˆ°åç¨‹ï¼ˆCoroutinesï¼‰ï¼Œé©¬ä¸Šæƒ³åˆ°çš„å°±æ˜¯Goè¯­è¨€ã€‚åç¨‹å¯¹äºå¤§éƒ¨åˆ† Java ç¨‹åºå‘˜æ¥è¯´å¯èƒ½è¿˜æœ‰ç‚¹é™Œç”Ÿï¼Œä½†å…¶åœ¨ Go ä¸­çš„ä½¿ç”¨ç›¸å¯¹æ¥è¯´å·²ç»å¾ˆæˆç†Ÿäº†ã€‚</p><p>åç¨‹æ˜¯ä¸€ç§æ¯”çº¿ç¨‹æ›´åŠ è½»é‡çº§çš„ä¸œè¥¿ï¼Œç›¸æ¯”äºç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ¥ç®¡ç†çš„è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œ<span class=\"orange\">åç¨‹åˆ™å®Œå…¨ç”±ç¨‹åºæœ¬èº«æ‰€æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯åœ¨ç”¨æˆ·æ€æ‰§è¡Œã€‚</span>åç¨‹é¿å…äº†åƒçº¿ç¨‹åˆ‡æ¢é‚£æ ·äº§ç”Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåœ¨æ€§èƒ½æ–¹é¢å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ã€‚åç¨‹åœ¨å¤šçº¿ç¨‹ä¸šåŠ¡ä¸Šçš„è¿ç”¨ï¼Œæˆ‘ä¼šåœ¨ç¬¬18è®²ä¸­è¯¦è¿°ã€‚</p><h2>å‡å°‘Javaè™šæ‹Ÿæœºçš„åƒåœ¾å›æ”¶</h2><p>æˆ‘ä»¬åœ¨ä¸Šä¸€è®²è®²ä¸Šä¸‹æ–‡åˆ‡æ¢çš„è¯±å› æ—¶ï¼Œæ›¾æåˆ°è¿‡â€œåƒåœ¾å›æ”¶ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢â€ã€‚</p><p>å¾ˆå¤š JVM åƒåœ¾å›æ”¶å™¨ï¼ˆserialæ”¶é›†å™¨ã€ParNewæ”¶é›†å™¨ï¼‰åœ¨å›æ”¶æ—§å¯¹è±¡æ—¶ï¼Œä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œä»è€Œéœ€è¦è¿›è¡Œå†…å­˜æ•´ç†ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å°±éœ€è¦ç§»åŠ¨å­˜æ´»çš„å¯¹è±¡ã€‚è€Œç§»åŠ¨å†…å­˜å¯¹è±¡å°±æ„å‘³ç€è¿™äº›å¯¹è±¡æ‰€åœ¨çš„å†…å­˜åœ°å€ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤åœ¨ç§»åŠ¨å¯¹è±¡å‰éœ€è¦æš‚åœçº¿ç¨‹ï¼Œåœ¨ç§»åŠ¨å®Œæˆåéœ€è¦å†æ¬¡å”¤é†’è¯¥çº¿ç¨‹ã€‚å› æ­¤å‡å°‘ JVM åƒåœ¾å›æ”¶çš„é¢‘ç‡å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><h2>æ€»ç»“</h2><p>ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹æ€§èƒ½æ¶ˆè€—çš„åŸå› ä¹‹ä¸€ï¼Œè€Œç«äº‰é”ã€çº¿ç¨‹é—´çš„é€šä¿¡ä»¥åŠè¿‡å¤šåœ°åˆ›å»ºçº¿ç¨‹ç­‰å¤šçº¿ç¨‹ç¼–ç¨‹æ“ä½œï¼Œéƒ½ä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒI/Oé˜»å¡ä»¥åŠJVMçš„åƒåœ¾å›æ”¶ä¹Ÿä¼šå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œè¿‡äºé¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šå½±å“ç³»ç»Ÿçš„æ€§èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥é¿å…å®ƒã€‚å¦å¤–ï¼Œ<span class=\"orange\">æˆ‘ä»¬è¿˜å¯ä»¥å°†ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿä½œä¸ºç³»ç»Ÿçš„æ€§èƒ½å‚è€ƒæŒ‡æ ‡ï¼Œå¹¶å°†è¯¥æŒ‡æ ‡çº³å…¥åˆ°æœåŠ¡æ€§èƒ½ç›‘æ§ï¼Œé˜²æ‚£äºæœªç„¶ã€‚</span></p><h2>æ€è€ƒé¢˜</h2><p>é™¤äº†æˆ‘æ€»ç»“ä¸­æåˆ°çš„çº¿ç¨‹é—´ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä¸€äº›è¯±å› ï¼Œä½ è¿˜çŸ¥é“å…¶å®ƒè¯±å› å—ï¼Ÿå¯¹åº”çš„ä¼˜åŒ–æ–¹æ³•åˆæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„åˆ†äº«ã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·è®¨è®ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/67/bbe343640d6b708832c4133ec53ed967.jpg?wh=1110*659\" alt=\"unpreview\"></p>","comments":[{"had_liked":false,"id":106953,"user_name":"Geek_1f1a07","can_delete":false,"product_type":"c1","uid":1292406,"ip_address":"","ucode":"9C42A5B796AEDA","user_header":"https://static001.geekbang.org/account/avatar/00/13/b8/76/6f0c39c2.jpg","comment_is_top":false,"comment_ctime":1561428575,"is_pvip":false,"replies":[{"id":"38848","content":"å›ç­”å¾ˆå¥½ï¼Œèµä¸€ä¸ªã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561518983,"ip_address":"","comment_id":106953,"utype":1}],"discussion_count":1,"race_medal":0,"score":"229194695263","product_id":100028001,"comment_content":"Zedè¯´çš„ä¸å¯¹ï¼Œé¦–å…ˆï¼Œæ‰€æœ‰çš„é”ï¼Œæ— è®ºsynchronizeè¿˜æ˜¯lockï¼Œå¦‚æœå‘ç”Ÿç«äº‰æ¡ä»¶ï¼Œéƒ½å¯èƒ½é€ æˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¼˜åŒ–é”çš„ç›®çš„æ˜¯ä¸ºäº†å°½é‡é™ä½å‘ç”Ÿé”ç«äº‰çš„æ¦‚ç‡ï¼Œsynchronizeåšçš„ä¼˜åŒ–éƒ½æ˜¯æŠŠç«äº‰çš„å¯èƒ½æ¶ˆç­åœ¨å‰æœŸçš„åå‘é”ï¼Œè½»é‡çº§é”ï¼ŒæŠŠä¼šé€ æˆä¸Šä¸‹æ–‡åˆ‡æ¢çš„â€œè„æ´»â€ç•™åœ¨æœ€åã€‚lockçš„ä¹è§‚é”å¤§ä½“æ€è·¯ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ï¼Œä¸ä¼šè½»æ˜“è°ƒç”¨parkæ–¹æ³•ã€‚ä½†æ˜¯æœ¬è´¨ä¸Šjavaç›®å‰éƒ½æ˜¯åˆ©ç”¨å†…æ ¸çº¿ç¨‹ï¼Œæ‰€ä»¥éƒ½ä¼šæœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚é™¤éä½¿ç”¨åç¨‹çš„æŠ€æœ¯ï¼Œè¿™ä¸ªä»¥å‰æœ‰green threadï¼Œåæ¥ä¸ç”¨äº†ï¼ŒæœŸå¾…è€å¸ˆåé¢å¯¹åç¨‹çš„è®²è§£ã€‚","like_count":54,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455299,"discussion_content":"å›ç­”å¾ˆå¥½ï¼Œèµä¸€ä¸ªã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518983,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":135074,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1568996799,"is_pvip":false,"replies":[{"id":"51865","content":"volatileä¸»è¦æ˜¯ç”¨æ¥ä¿è¯å…±äº«å˜é‡é¢å¯è§æ€§ï¼Œä»¥åŠé˜²æ­¢æŒ‡ä»¤é‡æ’åºï¼Œä¿è¯æ‰§è¡Œçš„æœ‰åºæ€§ã€‚<br><br>é€šè¿‡ç”Ÿæˆ.classæ–‡ä»¶ä¹‹åï¼Œåç¼–è¯‘æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡volatileä¿®é¥°çš„å…±äº«å˜é‡ï¼Œåœ¨å†™å…¥æ“ä½œçš„æ—¶å€™ä¼šå¤šä¸€ä¸ªLockå‰ç¼€è¿™æ ·çš„æŒ‡ä»¤ï¼Œå½“æ“ä½œç³»ç»Ÿæ‰§è¡Œæ—¶ä¼šç”±äºè¿™ä¸ªæŒ‡ä»¤ï¼Œå°†å½“å‰å¤„ç†å™¨ç¼“å­˜çš„æ•°æ®å†™å›ç³»ç»Ÿå†…å­˜ä¸­ï¼Œå¹¶é€šçŸ¥å…¶ä»–å¤„ç†å™¨ä¸­çš„ç¼“å­˜å¤±æ•ˆã€‚<br><br>æ‰€ä»¥volatileä¸ä¼šå¸¦æ¥çº¿ç¨‹çš„æŒ‚èµ·æ“ä½œï¼Œä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569052490,"ip_address":"","comment_id":135074,"utype":1}],"discussion_count":1,"race_medal":0,"score":"74583440831","product_id":100028001,"comment_content":"volitileçš„è¯»å†™ä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ“ä½œç³»ç»Ÿå±‚é¢æ€ä¹ˆç†è§£å‘¢","like_count":17,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468032,"discussion_content":"volatileä¸»è¦æ˜¯ç”¨æ¥ä¿è¯å…±äº«å˜é‡é¢å¯è§æ€§ï¼Œä»¥åŠé˜²æ­¢æŒ‡ä»¤é‡æ’åºï¼Œä¿è¯æ‰§è¡Œçš„æœ‰åºæ€§ã€‚\n\né€šè¿‡ç”Ÿæˆ.classæ–‡ä»¶ä¹‹åï¼Œåç¼–è¯‘æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡volatileä¿®é¥°çš„å…±äº«å˜é‡ï¼Œåœ¨å†™å…¥æ“ä½œçš„æ—¶å€™ä¼šå¤šä¸€ä¸ªLockå‰ç¼€è¿™æ ·çš„æŒ‡ä»¤ï¼Œå½“æ“ä½œç³»ç»Ÿæ‰§è¡Œæ—¶ä¼šç”±äºè¿™ä¸ªæŒ‡ä»¤ï¼Œå°†å½“å‰å¤„ç†å™¨ç¼“å­˜çš„æ•°æ®å†™å›ç³»ç»Ÿå†…å­˜ä¸­ï¼Œå¹¶é€šçŸ¥å…¶ä»–å¤„ç†å™¨ä¸­çš„ç¼“å­˜å¤±æ•ˆã€‚\n\næ‰€ä»¥volatileä¸ä¼šå¸¦æ¥çº¿ç¨‹çš„æŒ‚èµ·æ“ä½œï¼Œä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569052490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106916,"user_name":"Zed","can_delete":false,"product_type":"c1","uid":1184951,"ip_address":"","ucode":"09947C76F55A46","user_header":"https://static001.geekbang.org/account/avatar/00/12/14/b7/bb6a1fd4.jpg","comment_is_top":false,"comment_ctime":1561424794,"is_pvip":false,"replies":[{"id":"38846","content":"å›ç­”å¾ˆå¥½ã€‚çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œä¸¤è€…éƒ½ä¼šå‘ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚Synchronizedä¸­é˜»å¡çº¿ç¨‹æ— è®ºä½•æ—¶å»è·å–é”ï¼Œéƒ½éœ€è¦è¿›å…¥åˆ°å†…æ ¸æ€ï¼Œè€ŒAQSä¸­ï¼Œé˜»å¡çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œæ˜¯é€šè¿‡stateä»¥åŠCASæ“ä½œåˆ¤æ–­ï¼Œåªæœ‰æ²¡æœ‰ç«äº‰æˆåŠŸæ—¶ï¼Œæ‰ä¼šå†æ¬¡è¢«æŒ‚èµ·ï¼Œè¿™æ ·å¯ä»¥å°½é‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561518114,"ip_address":"","comment_id":106916,"utype":1}],"discussion_count":1,"race_medal":0,"score":"65985934234","product_id":100028001,"comment_content":"å›ç­”è¶™è¡åŒå­¦<br><br>å¦‚ä½ æ‰€è¯´ï¼Œsynchronizedä¸»è¦æ˜¯å› ä¸ºæœ‰ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„äº¤äº’æ‰€ä»¥èƒ½åˆ°è¿›ç¨‹çº§åˆ«ã€‚<br><br>è€ŒLockæ˜¯é€šè¿‡AQSçš„stateçŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦æŒæœ‰é”ï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯åœ¨ç”¨æˆ·æ€æˆ–è€…è¯´çº¯javaå®ç°ã€‚<br><br>æœ€ålock.await()ä¹Ÿæ˜¯æŠŠå½“å‰çº¿ç¨‹æ”¾åˆ°å½“å‰æ¡ä»¶å˜é‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­å¹¶è®©å‡ºcpuã€‚é¡ºä¾¿æä¸‹ï¼Œlockæ”¯æŒå¤šæ¡ä»¶å˜é‡ã€‚","like_count":15,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455280,"discussion_content":"å›ç­”å¾ˆå¥½ã€‚çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œä¸¤è€…éƒ½ä¼šå‘ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚Synchronizedä¸­é˜»å¡çº¿ç¨‹æ— è®ºä½•æ—¶å»è·å–é”ï¼Œéƒ½éœ€è¦è¿›å…¥åˆ°å†…æ ¸æ€ï¼Œè€ŒAQSä¸­ï¼Œé˜»å¡çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œæ˜¯é€šè¿‡stateä»¥åŠCASæ“ä½œåˆ¤æ–­ï¼Œåªæœ‰æ²¡æœ‰ç«äº‰æˆåŠŸæ—¶ï¼Œæ‰ä¼šå†æ¬¡è¢«æŒ‚èµ·ï¼Œè¿™æ ·å¯ä»¥å°½é‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107205,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1561479684,"is_pvip":false,"replies":[{"id":"38807","content":"notify()å¯ä»¥ç»“åˆwaitï¼ˆlongï¼‰æ–¹æ³•ä½¿ç”¨ï¼Œè§£å†³æŸäº›æ²¡æœ‰é€šçŸ¥çš„çº¿ç¨‹è¢«é€šçŸ¥ä¸åˆ°çš„é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561512320,"ip_address":"","comment_id":107205,"utype":1}],"discussion_count":3,"race_medal":0,"score":"53101087236","product_id":100028001,"comment_content":"æˆ‘è§‰å¾—æœ‰äº›äººå»ºè®®ä½¿ç”¨notifyallçš„åŸå› æ˜¯ä½¿ç”¨notifyéœ€è¦æœ‰åè¶³çš„æŠŠæ¡å»ç¡®è®¤å“ªæ¡çº¿ç¨‹éœ€è¦å”¤é†’ï¼Œå› ä¸ºä¸€ä¸ç•™ç¥å°±å®¹æ˜“æé”™ï¼Œä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–æœ€åäº‹å€åŠŸåŠï¼Œæ‰€ä»¥å¤§å®¶æ‰ä¼šä½¿ç”¨notifyallä¸€åŠ³æ°¸é€¸ï¼Œæˆ‘å…¶å®æŒºè®¤åŒè€å¸ˆçš„è§‚ç‚¹ï¼Œè€å¸ˆï¼Œå…¨éƒ¨å”¤é†’ä¼šå¯¼è‡´æ›´å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ˜¯å¦è¦ä¼˜åŒ–è¿™ç‚¹ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾—çœ‹ä¸ªäººäº†å§ğŸ˜‚","like_count":13,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455416,"discussion_content":"notify()å¯ä»¥ç»“åˆwaitï¼ˆlongï¼‰æ–¹æ³•ä½¿ç”¨ï¼Œè§£å†³æŸäº›æ²¡æœ‰é€šçŸ¥çš„çº¿ç¨‹è¢«é€šçŸ¥ä¸åˆ°çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561512320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1086568,"avatar":"https://static001.geekbang.org/account/avatar/00/10/94/68/56794ea3.jpg","nickname":"Kian.Lee","note":"","ucode":"3FB08A00F2DFD7","race_medal":5,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3285,"discussion_content":"åªæ˜¯å…³æ³¨ç‚¹ä¸åŒè€Œå·²ï¼Œéš”å£ç‹å®ä»¤è€å¸ˆçš„å¹¶å‘ç¼–ç¨‹ä¸“æ æ¨èçš„æ˜¯å°½é‡ç”¨notifyAllä»£æ›¿notifyï¼Œä¸»è¦è€ƒè™‘çš„æ˜¯å®‰å…¨æ€§ï¼Œå› ä¸ºç³»ç»ŸåŒä¸€åŠŸèƒ½ä¸åŒæ—¶æœŸçš„ä»£ç å¯èƒ½æ˜¯ä¸ä¸€æ ·ï¼Œå¯èƒ½å¼€å‘è€…ä¸ä¸€æ ·æˆ–ä¾èµ–çš„ä¸‰æ–¹åº“ä»£ç ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå¯èƒ½å®‰å…¨å°±æ˜¯ç¬¬ä¸€ä½çš„ï¼Œæ¯•ç«Ÿæœ‰äº›å˜åŒ–æ˜¯å½“å‰ä¸å¯é¢„æµ‹çš„ã€‚åˆ˜è¶…è€å¸ˆè¯´notity ä»£æ›¿notifyAllä¸»è¦è€ƒè™‘çš„æ˜¯æ€§èƒ½ä¼˜å…ˆï¼Œåœ¨ä»–çš„æƒ…æ™¯ä¸‹ä¹Ÿæ˜¯åˆç†çš„ã€‚notifyAllä¹Ÿä¸æ˜¯ä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–ğŸ˜ï¼Œå¦‚ä½•æŠ‰æ‹©è¿˜æ˜¯è¦çœ‹è‡ªå·±çš„åº”ç”¨åœºæ™¯ã€‚","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1564375485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1006789,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg","nickname":"æ¢ä¸­å","note":"","ucode":"52FE40242CBAD0","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422,"discussion_content":"åº”è¯¥æ˜¯åªæœ‰è¦è¿›å…¥runningçš„çº¿ç¨‹æ‰éœ€è¦æŠŠå„ç§æš‚å­˜çš„ä¸Šçº¿æ–‡ä¿¡æ¯è°ƒå…¥å§ï¼Œå…¶ä»–è¢«notifyçš„çº¿ç¨‹è™½ç„¶è¢«å”¤é†’äº†ï¼Œä¹Ÿåªè¿›å…¥runnableçŠ¶æ€, å¹¶ä¸ä¼šå¯¼è‡´å®è´¨çš„ä¸Šçº¿æ–‡åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561542192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107121,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1561462918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"48806103174","product_id":100028001,"comment_content":"è€å¸ˆè¯·é—®ä¸€ä¸‹åœ¨ä¸€æ®µç¨‹åºä¸­é™¤äº†å·¥ä½œçº¿ç¨‹ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå®ˆæŠ¤çº¿ç¨‹, è¿™äº›çº¿ç¨‹åŠ èµ·æ¥çš„æ•°é‡å¿…ç„¶æ¯”cupçš„æ•°é‡ä¼šå¤šå¾ˆå¤š, é‚£ä¹ˆä¸ºä»€ä¹ˆåˆ›å»ºçº¿ç¨‹æ± çš„æ—¶å€™è¦å‚è€ƒCPUçš„æ•°é‡å‘¢, ä¸ºä»€ä¹ˆä¸æŠŠå®ˆæŠ¤çº¿ç¨‹ä¹Ÿè€ƒè™‘è¿›å»å‘¢?","like_count":12},{"had_liked":false,"id":106847,"user_name":"ä½ å¥½æ—…è¡Œè€…","can_delete":false,"product_type":"c1","uid":1154101,"ip_address":"","ucode":"5C72A428DC28F3","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/35/9dc79371.jpg","comment_is_top":false,"comment_ctime":1561397753,"is_pvip":false,"replies":[{"id":"38845","content":"AQSæŒ‚èµ·æ˜¯é€šè¿‡LockSupportä¸­çš„parkè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯å­˜åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ã€‚ä½†è¢«é˜»å¡çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œsynchronizedé˜»å¡çš„çº¿ç¨‹æ¯æ¬¡è·å–é”èµ„æºéƒ½è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨å†…æ ¸æ¥å®Œæˆï¼Œè¿™æ ·å°±æ¯”AQSé˜»å¡çš„çº¿ç¨‹æ›´æ¶ˆè€—ç³»ç»Ÿèµ„æºäº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561518004,"ip_address":"","comment_id":106847,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44511070713","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼åœ¨synchronizedä¸­ï¼Œâ€œæŒ‚èµ·â€è¿™ä¸ªåŠ¨ä½œæ˜¯ç”±JVMæ¥å®ç°çš„ï¼Œè·å–ä¸åˆ°é”çš„çº¿ç¨‹ä¼šè¢«è¿«è®©å‡ºCPUï¼Œç”±äºsynchronizedæ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„mutexæœºåˆ¶ï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æˆ‘æƒ³è¯·é—®è€å¸ˆï¼Œåœ¨JDKçš„Lockä¸­ï¼Œæˆ–è€…AQSä¸­ï¼Œçº¿ç¨‹â€œæŒ‚èµ·â€è¿™ä¸ªåŠ¨ä½œåˆæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸ä¼šäº§ç”Ÿè¿›ç¨‹çº§åˆ«çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å‘¢ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455252,"discussion_content":"AQSæŒ‚èµ·æ˜¯é€šè¿‡LockSupportä¸­çš„parkè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯å­˜åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ã€‚ä½†è¢«é˜»å¡çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œsynchronizedé˜»å¡çš„çº¿ç¨‹æ¯æ¬¡è·å–é”èµ„æºéƒ½è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨å†…æ ¸æ¥å®Œæˆï¼Œè¿™æ ·å°±æ¯”AQSé˜»å¡çš„çº¿ç¨‹æ›´æ¶ˆè€—ç³»ç»Ÿèµ„æºäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2311463,"avatar":"https://static001.geekbang.org/account/avatar/00/23/45/27/4fbf8f6a.jpg","nickname":"luke Y","note":"","ucode":"111F98D367235B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369176,"discussion_content":"m","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618967789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164019,"user_name":"td901105","can_delete":false,"product_type":"c1","uid":1348830,"ip_address":"","ucode":"32D42A4F36FA02","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/SM4fwn9uFicXU8cQ1rNF2LQdKNbZI1FX1jmdwaE2MTrBawbugj4TQKjMKWG0sGbmqQickyARXZFS8NZtobvoWTHA/132","comment_is_top":false,"comment_ctime":1576846890,"is_pvip":false,"replies":[{"id":"62975","content":"ä¸€æ ·ä¼šæœ‰ï¼Œç›¸å¯¹åŒæ­¥é”æ¥è¯´ï¼Œåªæ˜¯å‡å°‘äº†ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ã€‚Locké”è¢«é˜»å¡çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œsynchronizedé˜»å¡çš„çº¿ç¨‹æ¯æ¬¡è·å–é”èµ„æºéƒ½è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨å†…æ ¸æ¥å®Œæˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1577187101,"ip_address":"","comment_id":164019,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23051683370","product_id":100028001,"comment_content":"è€å¸ˆ,æ˜¯ä¸æ˜¯ä½¿ç”¨Locké”æœºåˆ¶ä¸ä¼šæœ‰ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢?è¿˜æ˜¯Lockæœ¬èº«é”æœºåˆ¶æ˜¯ä¸æ¶‰åŠç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢çš„,åªæ˜¯åœ¨æœªè·å–é”çš„æ—¶å€™éœ€è¦ä½¿ç”¨å†…æ ¸æ€çš„æ–¹æ³•æ¯”å¦‚parkæ–¹æ³•è¿›è¡Œçº¿ç¨‹çš„æŒ‚èµ·?","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478619,"discussion_content":"ä¸€æ ·ä¼šæœ‰ï¼Œç›¸å¯¹åŒæ­¥é”æ¥è¯´ï¼Œåªæ˜¯å‡å°‘äº†ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ã€‚Locké”è¢«é˜»å¡çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œsynchronizedé˜»å¡çš„çº¿ç¨‹æ¯æ¬¡è·å–é”èµ„æºéƒ½è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨å†…æ ¸æ¥å®Œæˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577187101,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115825,"user_name":"K","can_delete":false,"product_type":"c1","uid":1118374,"ip_address":"","ucode":"69831D1EFC083C","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/a6/4d2c933e.jpg","comment_is_top":false,"comment_ctime":1563755547,"is_pvip":false,"replies":[{"id":"42713","content":"è¿™é‡Œçš„vectoræ˜¯ä¸€ä¸ªå¯¹è±¡é”ï¼Œé”çš„æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œå¹¶ä¸æ˜¯ä¿è¯vectorçš„çº¿ç¨‹å®‰å…¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563932840,"ip_address":"","comment_id":115825,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23038592027","product_id":100028001,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æœ‰ä¸ªç‰¹åˆ«ç®€å•çš„å°é—®é¢˜ä¸å¤ªæ˜ç™½ã€‚æ—¢ç„¶ç”¨äº†vectorï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨synchronizeé”èµ·æ¥å•Šï¼Œvectoræœ¬èº«ä¸å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿè°¢è°¢è€å¸ˆå›ç­”ã€‚","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459301,"discussion_content":"è¿™é‡Œçš„vectoræ˜¯ä¸€ä¸ªå¯¹è±¡é”ï¼Œé”çš„æ˜¯ä¸€ä¸ªä»£ç å—ï¼Œå¹¶ä¸æ˜¯ä¿è¯vectorçš„çº¿ç¨‹å®‰å…¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563932840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2664121,"avatar":"https://static001.geekbang.org/account/avatar/00/28/a6/b9/6bdaf8ce.jpg","nickname":"rich_li","note":"","ucode":"B82495DDC942DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405579,"discussion_content":"vector åªæ˜¯ä¿è¯è‡ªèº«çš„çº¿ç¨‹å®‰å…¨ï¼Œè€Œæ— æ³•ä¿è¯è¿™æ•´ä¸ªä»£ç å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634605133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107936,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1561636249,"is_pvip":false,"replies":[{"id":"39187","content":"ä¸€ä¸ªJVMåœ¨æ“ä½œç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯è¿›ç¨‹ä¸­çš„æŸä¸ªè¿è¡Œçš„çº¿ç¨‹åœæ­¢ä½¿ç”¨CPUï¼Œåˆ‡æ¢åˆ°å†…æ ¸è·å–CPUè¿è¡Œï¼Œè€Œä¸æ˜¯è¯´åœæ­¢JVMï¼Œç„¶åè¿è¡Œå†…æ ¸ã€‚è¿™é‡Œçš„åˆ‡æ¢æ˜¯ç”¨æˆ·æ€ä½¿ç”¨CPUåˆ‡æ¢åˆ°äº†å†…æ ¸æ€ä½¿ç”¨CPUã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561691332,"ip_address":"","comment_id":107936,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23036472729","product_id":100028001,"comment_content":"è€å¸ˆè¯·é—®ä¸€ä¸‹, JVMåœ¨æ“ä½œç³»ç»Ÿå±‚é¢æ˜¯ä¸€ä¸ªè¿›ç¨‹è¿˜æ˜¯å¤šä¸ªè¿›ç¨‹, å¦‚æœæ˜¯ä¸€ä¸ªè¿›ç¨‹çš„è¯, é‚£synchronizeå’Œpark()æ–¹æ³•å‘ç”Ÿçš„æ˜¯è¿›ç¨‹çº§åˆ«çš„çŠ¶æ€åˆ‡æ¢çš„è¯æ˜¯æŒ‡æ“ä½œç³»ç»Ÿä¸è¿è¡ŒJVMäº†å—?","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455754,"discussion_content":"ä¸€ä¸ªJVMåœ¨æ“ä½œç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯è¿›ç¨‹ä¸­çš„æŸä¸ªè¿è¡Œçš„çº¿ç¨‹åœæ­¢ä½¿ç”¨CPUï¼Œåˆ‡æ¢åˆ°å†…æ ¸è·å–CPUè¿è¡Œï¼Œè€Œä¸æ˜¯è¯´åœæ­¢JVMï¼Œç„¶åè¿è¡Œå†…æ ¸ã€‚è¿™é‡Œçš„åˆ‡æ¢æ˜¯ç”¨æˆ·æ€ä½¿ç”¨CPUåˆ‡æ¢åˆ°äº†å†…æ ¸æ€ä½¿ç”¨CPUã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561691332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107145,"user_name":"çš®çš®","can_delete":false,"product_type":"c1","uid":1156624,"ip_address":"","ucode":"D692CFAA982137","user_header":"https://static001.geekbang.org/account/avatar/00/11/a6/10/3ff2e1a5.jpg","comment_is_top":false,"comment_ctime":1561467137,"is_pvip":true,"replies":[{"id":"38847","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561518531,"ip_address":"","comment_id":107145,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18741336321","product_id":100028001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œä¸€ç›´æœ‰ä¸ªç–‘é—®æƒ³è¯·æ•™ï¼Œå°±æ˜¯JDK1.5å¼•å…¥çš„locké”åº•å±‚å®ç°ä¹Ÿæ˜¯è°ƒç”¨äº†lockhelperçš„parkå’Œunparkæ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯å¦ä¹Ÿæ¶‰åŠåˆ°ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455384,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109505,"user_name":"å¥‡å¥‡","can_delete":false,"product_type":"c1","uid":1399097,"ip_address":"","ucode":"BC86B0CB55E35A","user_header":"","comment_is_top":false,"comment_ctime":1562046814,"is_pvip":true,"replies":[{"id":"39772","content":"åŒå­¦ä½ å¥½ï¼åé¢æœ‰ä¸ªé”ï¼Œä¸ä¼šåŒæ—¶è¿›å»removeã€‚å¦‚æœ‰ç–‘é—®ï¼Œå¯ç»§ç»­ç•™è¨€ã€‚","user_name":"ç¼–è¾‘å›å¤","user_name_real":"ç‹å†¬é’","uid":"1356014","ctime":1562116711,"ip_address":"","comment_id":109505,"utype":2}],"discussion_count":1,"race_medal":0,"score":"14446948702","product_id":100028001,"comment_content":"ä»£ç å†™é”™äº†<br>while(pool.isEmpty())ä¸èƒ½æ”¾åœ¨åŒæ­¥ä»£ç å—çš„å¤–é¢<br>å‡è®¾æ­¤æ—¶poolä¸ä¸ºç©ºå®¹é‡ä¸º1ï¼Œæ­¤æ—¶10ä¸ªçº¿ç¨‹çš„pool.isEmptyéƒ½ä¸ºfalseï¼Œæ­¤æ—¶å…¨éƒ¨è·³å‡ºå¾ªç¯ã€‚<br>å…¨éƒ¨æ‰§è¡Œpool.remove(0) é”™è¯¯","like_count":3,"discussions":[{"author":{"id":1356014,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b0/ee/d0871efd.jpg","nickname":"å†¬é’","note":"","ucode":"14576781B499FB","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456442,"discussion_content":"åŒå­¦ä½ å¥½ï¼åé¢æœ‰ä¸ªé”ï¼Œä¸ä¼šåŒæ—¶è¿›å»removeã€‚å¦‚æœ‰ç–‘é—®ï¼Œå¯ç»§ç»­ç•™è¨€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562116711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106863,"user_name":"ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾","can_delete":false,"product_type":"c1","uid":1044175,"ip_address":"","ucode":"89545632BDA56E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOBwR7MCVqwZbPA5RQ2mjUjd571jUXUcBCE7lY5vSMibWn8D5S4PzDZMaAhRPdnRBqYbVOBTJibhJg/132","comment_is_top":false,"comment_ctime":1561417919,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14446319807","product_id":100028001,"comment_content":"å¤šä¸ªè½¯ä»¶å…±åŒè¿è¡Œä¹Ÿæœ‰å¯èƒ½å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæœ‰äº›è½¯ä»¶è€ƒè™‘ä½¿ç”¨ç»‘å®šå›ºå®šcpuæ ¸æ–¹å¼è¿è¡Œ","like_count":3},{"had_liked":false,"id":107477,"user_name":"æ¢ä¸­å","can_delete":false,"product_type":"c1","uid":1006789,"ip_address":"","ucode":"52FE40242CBAD0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg","comment_is_top":false,"comment_ctime":1561542541,"is_pvip":true,"replies":[{"id":"39207","content":"å¹´è½»ä»£æ˜¯éƒ¨åˆ†å¯¹è±¡å¤åˆ¶è¿‡ç¨‹ï¼Œæ˜¯ä¸ä¼šå­˜åœ¨stop the worldçš„å‘ç”Ÿã€‚å¦‚æœå­˜åœ¨å¯¹è±¡ç§»åŠ¨ï¼Œä½¿ç”¨å¯¹è±¡çš„çº¿ç¨‹æ˜¯ä¼šè¢«æŒ‚èµ·çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å­˜åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561694279,"ip_address":"","comment_id":107477,"utype":1}],"discussion_count":2,"race_medal":1,"score":"10151477133","product_id":100028001,"comment_content":"åŸæ–‡ï¼šâ€œè€Œç§»åŠ¨å†…å­˜å¯¹è±¡å°±æ„å‘³ç€è¿™äº›å¯¹è±¡æ‰€åœ¨çš„å†…å­˜åœ°å€ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤åœ¨ç§»åŠ¨å¯¹è±¡å‰éœ€è¦æš‚åœçº¿ç¨‹ï¼Œåœ¨ç§»åŠ¨å®Œæˆåéœ€è¦å†æ¬¡å”¤é†’è¯¥çº¿ç¨‹â€ã€‚ è¿™å¥è¯æ˜¯ä¸æ˜¯ä¸å¤ªä¸¥å¯†ï¼Ÿæ¯æ¬¡ygcéƒ½ä¼šå¯¼è‡´å¹´è½»ä»£å†…å­˜åœ°å€å˜åŒ–ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´æš‚åœçº¿ç¨‹å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œé‚£çº¿ç¨‹åˆ‡æ¢ä¹Ÿå¤ªé¢‘ç¹äº†ï¼Œä¼¼ä¹å’Œäº‹å®ä¸ç¬¦å•Šã€‚ ","like_count":2,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455526,"discussion_content":"å¹´è½»ä»£æ˜¯éƒ¨åˆ†å¯¹è±¡å¤åˆ¶è¿‡ç¨‹ï¼Œæ˜¯ä¸ä¼šå­˜åœ¨stop the worldçš„å‘ç”Ÿã€‚å¦‚æœå­˜åœ¨å¯¹è±¡ç§»åŠ¨ï¼Œä½¿ç”¨å¯¹è±¡çš„çº¿ç¨‹æ˜¯ä¼šè¢«æŒ‚èµ·çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å­˜åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561694279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2080531,"avatar":"","nickname":"Geek_315d30","note":"","ucode":"B24DD20A180027","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552029,"discussion_content":"è€å¸ˆï¼Œè¿˜æ˜¯ä¸æ˜ç™½å•Šï¼Œä¸ç®¡æ˜¯å¯¹è±¡ç§»åŠ¨è¿˜æ˜¯å¤åˆ¶ï¼Œå¯¹è±¡çš„åœ°å€éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼ŒæŒ‰ç…§æ–‡ä¸­çš„è¯´è¯ï¼Œå²‚ä¸æ˜¯éƒ½ä¼šå¼•èµ·çº¿ç¨‹åˆ‡æ¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645238987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134655,"user_name":"Young","can_delete":false,"product_type":"c1","uid":1619635,"ip_address":"","ucode":"B6CD7E4CF3220D","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/b3/f626885f.jpg","comment_is_top":false,"comment_ctime":1568886900,"is_pvip":true,"replies":[{"id":"51648","content":"waitæ˜¯åœ¨é”ä»£ç å—é‡Œé¢ï¼Œæ‰€ä»¥ä¸€æ—¦è¶…æ—¶ï¼Œåˆ™ä¼šè·³å‡ºè¯¥åŒæ­¥é”ä»£ç å—","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568895107,"ip_address":"","comment_id":134655,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5863854196","product_id":100028001,"comment_content":"è¯·é—®è€å¸ˆï¼Œçº¿ç¨‹waitåŒºåˆ†æ˜¯ç”±äºç­‰å¾…è¶…æ—¶é‡æ–°è¿è¡Œä¸ºä»€ä¹ˆä¸éœ€è¦å†å»é‡æ–°è·å–é”å‘¢ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼Œwaitåé”è¢«é‡Šæ”¾äº†ï¼Œé‚£çº¿ç¨‹é‡æ–°æ¢å¤è¿è¡Œåæ— è®ºä»€ä¹ˆæƒ…å†µä¸‹éƒ½åº”è¯¥å…ˆå»è·å–é”","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467848,"discussion_content":"waitæ˜¯åœ¨é”ä»£ç å—é‡Œé¢ï¼Œæ‰€ä»¥ä¸€æ—¦è¶…æ—¶ï¼Œåˆ™ä¼šè·³å‡ºè¯¥åŒæ­¥é”ä»£ç å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568895107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132214,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568043660,"is_pvip":false,"replies":[{"id":"51139","content":"è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æŒ‡çš„æ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„ç›¸äº’åˆ‡æ¢ï¼Œåç»­è¡¥ä¸Šè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568539773,"ip_address":"","comment_id":132214,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5863010956","product_id":100028001,"comment_content":"è¿™èŠ‚å¾ˆä¸é”™ï¼Œä¸è¿‡ç–‘é—®è¿˜æ˜¯æœ‰çš„<br>æ„Ÿè§‰è€å¸ˆæ²¡æœ‰å®Œå…¨è®²æ¸…æ¥šè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿå¦å¤–ï¼Œè€å¸ˆå¯¹äºä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ä¸è”ç³»ä¹Ÿæ˜¯æ²¡æœ‰è®²çš„æ¯”è¾ƒç»†è‡´ï¼Ÿè¿™ä¸¤ä¸ªæ¦‚å¿µéå¸¸é‡è¦ï¼Œä¸è¿‡èƒ½é€šä¿—æ˜“æ‡‚çš„è®²æ˜ç™½çš„ä¸å¤šã€‚å¦å¤–ï¼Œä¸ç®¡è¿›ç¨‹è¿˜æ˜¯çº¿ç¨‹æˆ‘è®¤ä¸ºè‹¥æƒ³è¢«CPUæ‰§è¡Œï¼Œå°‘ä¸äº†è¦è¿›å…¥å†…æ ¸æ€ã€‚è¿›è¿›å‡ºå‡ºæ¯”è¾ƒè´¹åŠ²ä½†åˆä¸å¾—ä¸è¿›ï¼Œé‚£å°±å‡å°‘è¿›è¿›å‡ºå‡ºçš„æ¬¡æ•°ï¼Œå°‘è¿›ä¸ºå¦™ï¼Œå°‘è¿›çš„æ–¹æ³•å°±æ˜¯å°‘è§¦å‘é‚£äº›è¿›è¿›å‡ºå‡ºçš„æ¡ä»¶ã€‚æ¯”å¦‚ï¼šå‡å°‘é”æŒæœ‰æ—¶é—´ï¼Œå‡å°‘é”ç²’åº¦ï¼Œå°‘è§¦å‘é”ç«äº‰ï¼Œå‡å°‘FULL GCï¼Œå‡å°‘IOé˜»å¡ï¼Œåˆ›å»ºåˆé€‚çš„çº¿ç¨‹æ•°ç­‰ç­‰ã€‚","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466824,"discussion_content":"è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æŒ‡çš„æ˜¯ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„ç›¸äº’åˆ‡æ¢ï¼Œåç»­è¡¥ä¸Šè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568539773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225224,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","nickname":"å°”å†¬æ©™","note":"","ucode":"0B013A49BC18DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18072,"discussion_content":"ä½ è¯„è®ºé”™ç« èŠ‚äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569001012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107253,"user_name":"undifined","can_delete":false,"product_type":"c1","uid":1068920,"ip_address":"","ucode":"449CB4CD2DC089","user_header":"https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg","comment_is_top":false,"comment_ctime":1561508772,"is_pvip":false,"replies":[{"id":"38804","content":"notify()å¯ä»¥ç»“åˆwaitï¼ˆlongï¼‰æ–¹æ³•ä½¿ç”¨ï¼Œè§£å†³æŸäº›æ²¡æœ‰é€šçŸ¥çš„çº¿ç¨‹è¢«é€šçŸ¥ä¸åˆ°çš„é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561512160,"ip_address":"","comment_id":107253,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5856476068","product_id":100028001,"comment_content":"è€å¸ˆï¼Œåœ¨å¹¶å‘ç¼–ç¨‹é‚£ä¸ªä¸“æ ç¬¬ 6 è®²ä¸­è€å¸ˆæåˆ°ï¼šnotify() æ˜¯ä¼šéšæœºåœ°é€šçŸ¥ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œ notifyAll() ä¼šé€šçŸ¥ç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰çº¿ç¨‹ï¼›å³ä½¿ä½¿ç”¨ notifyAll()ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¿›å…¥ä¸´ç•ŒåŒºï¼›ä½†æ˜¯ notify() çš„é£é™©åœ¨äºå¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹æ°¸è¿œä¸ä¼šè¢«é€šçŸ¥åˆ°ï¼›æ‰€ä»¥é™¤éæœ‰ç‰¹æ®Šè€ƒè™‘ï¼Œå¦åˆ™å°½é‡ä½¿ç”¨notifyAll() <br><br>å¦‚æœç°åœ¨åˆè€ƒè™‘åˆ°é”ï¼Œåº”è¯¥æ€ä¹ˆåšé€‰æ‹©","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455439,"discussion_content":"notify()å¯ä»¥ç»“åˆwaitï¼ˆlongï¼‰æ–¹æ³•ä½¿ç”¨ï¼Œè§£å†³æŸäº›æ²¡æœ‰é€šçŸ¥çš„çº¿ç¨‹è¢«é€šçŸ¥ä¸åˆ°çš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561512160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107026,"user_name":"æ¬§æ˜Ÿæ˜Ÿ","can_delete":false,"product_type":"c1","uid":1014347,"ip_address":"","ucode":"56365442E231A0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/4b/1a7b36ab.jpg","comment_is_top":false,"comment_ctime":1561440391,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5856407687","product_id":100028001,"comment_content":"syncåœ¨ä½¿ç”¨é‡é‡çº§é”çš„æ—¶å€™ä¼šæœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œlockç”±äºå†…éƒ¨æ˜¯Javaå®ç°ï¼Œé”çš„ç­‰å¾…æ˜¯åŸºäºparkæ¥çš„ï¼Œæ‰€ä»¥åœ¨lockä¸­åªä¼šæœ‰çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„CPUä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ²¡æœ‰é”ç«äº‰çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ¯”syncå°‘ä¸€æ¬¡CPUä¸Šä¸‹æ–‡åˆ‡æ¢","like_count":1},{"had_liked":false,"id":106936,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1561426336,"is_pvip":false,"replies":[{"id":"38849","content":"g1åªæ˜¯å‡å°‘ï¼Œä¸èƒ½é¿å…å“¦ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561519018,"ip_address":"","comment_id":106936,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5856393632","product_id":100028001,"comment_content":"g1å¹¶è¡Œåƒåœ¾å›æ”¶ã€‚ä¸ä¸€å®šä¼šä¸Šä¸‹æ–‡åˆ‡æ¢å§ã€‚è‡³äºä¸Šä¸‹æ–‡åˆ‡æ¢è¿™ä¸ªï¼Œjavaè¿˜æœ‰ä¿¡å·é‡çš„å®ç°ã€‚","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455290,"discussion_content":"g1åªæ˜¯å‡å°‘ï¼Œä¸èƒ½é¿å…å“¦ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561519018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350884,"user_name":"æ¯è«åœ","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1657278762,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1657278762","product_id":100028001,"comment_content":"notifyå’Œnotifyallå„æœ‰å„çš„å¥½å¤„ï¼Œç”¨notifyæœ‰å¯èƒ½é€ æˆçº¿ç¨‹å§¬é¥¥é¥¿ã€‚","like_count":0},{"had_liked":false,"id":349218,"user_name":"keep_it_real","can_delete":false,"product_type":"c1","uid":2055554,"ip_address":"","ucode":"F5057CAF752FF3","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5d/82/81b2ba91.jpg","comment_is_top":false,"comment_ctime":1655807197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655807197","product_id":100028001,"comment_content":"é¢‘ç¹IOå°±æ˜¯è¯±å› ï¼Œé¢‘ç¹çš„æ•°æ®åº“æ“ä½œï¼Œå„ç§æ‹·è´ï¼Œéƒ½æ˜¯å¤§é‡çš„ä¸Šçº¿æ–‡åˆ‡æ¢ã€‚","like_count":0},{"had_liked":false,"id":345716,"user_name":"Bumblebee","can_delete":false,"product_type":"c1","uid":2051293,"ip_address":"","ucode":"B879C8A511D08D","user_header":"https://static001.geekbang.org/account/avatar/00/1f/4c/dd/c6035349.jpg","comment_is_top":false,"comment_ctime":1652522009,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1652522009","product_id":100028001,"comment_content":"äº‰è®®ç‚¹<br><br>æ–‡ä¸­è¯´åˆ°Object.notify() æ›¿ä»£Object.notifyAll()ã€‚ å› ä¸º Object.notify() åªä¼šå”¤é†’æŒ‡å®šçº¿ç¨‹ï¼Œä¸ä¼šè¿‡æ—©åœ°å”¤é†’å…¶å®ƒæœªæ»¡è¶³éœ€æ±‚çš„é˜»å¡çº¿ç¨‹ï¼Œæ‰€ä»¥å¯ä»¥å‡å°‘ç›¸åº”çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚<br><br>ä½†æ˜¯ï¼ŒObject.notify() æ˜¯ä¼šéšæœºåœ°é€šçŸ¥ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œ Object.notifyAll() ä¼šé€šçŸ¥ç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰çº¿ç¨‹ã€‚ä»æ„Ÿè§‰ä¸Šæ¥è®²ï¼Œåº”è¯¥æ˜¯ notify() æ›´å¥½ä¸€äº›ï¼Œå› ä¸ºå³ä¾¿é€šçŸ¥æ‰€æœ‰çº¿ç¨‹ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¿›å…¥ä¸´ç•ŒåŒºã€‚ä½†é‚£æ‰€è°“çš„æ„Ÿè§‰å¾€å¾€éƒ½è•´è—ç€é£é™©ï¼Œå®é™…ä¸Šä½¿ç”¨ notify() ä¹Ÿå¾ˆæœ‰é£é™©ï¼Œå®ƒçš„é£é™©åœ¨äºå¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹æ°¸è¿œä¸ä¼šè¢«é€šçŸ¥åˆ°ï¼ˆæ­¤è§‚ç‚¹æ¥æºäºæå®¢æ—¶é—´å¦ä¸€ä¸ªä¸“æ ï¼‰ã€‚<br><br>å¸Œæœ›è€å¸ˆè§£æƒ‘","like_count":0},{"had_liked":false,"id":313350,"user_name":"Jing","can_delete":false,"product_type":"c1","uid":2748637,"ip_address":"","ucode":"D06AC36B7DFC74","user_header":"https://static001.geekbang.org/account/avatar/00/29/f0/dd/62895468.jpg","comment_is_top":false,"comment_ctime":1632385675,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632385675","product_id":100028001,"comment_content":"vectorå¯ä»¥æ¢æˆArrayListå—","like_count":0},{"had_liked":false,"id":241727,"user_name":"æ”¾ä¸ä¸‹è£åå¯Œè´µ","can_delete":false,"product_type":"c1","uid":2053679,"ip_address":"","ucode":"9FE29C22B9ABE3","user_header":"https://static001.geekbang.org/account/avatar/00/1f/56/2f/4518f8e1.jpg","comment_is_top":false,"comment_ctime":1597402979,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1597402979","product_id":100028001,"comment_content":"ä¾‹å­ä¸­ï¼Œå¦‚æœä¸æ˜¯ç”¨ Vector ï¼Œè€Œæ˜¯arrayListï¼Œåº”è¯¥ä¼šå‡ºç°å¹¶å‘é—®é¢˜çš„å§","like_count":0},{"had_liked":false,"id":240953,"user_name":"å§šæ–‡é¾™","can_delete":false,"product_type":"c1","uid":1913434,"ip_address":"","ucode":"D36C9EC8EAFAAD","user_header":"","comment_is_top":false,"comment_ctime":1597131757,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597131757","product_id":100028001,"comment_content":"notify()å”¤é†’çš„æŒ‡å®šçº¿ç¨‹å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œæ˜¯ä¸æ˜¯ä¼šé€ æˆæ­»é”å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":237204,"user_name":"Gavin","can_delete":false,"product_type":"c1","uid":1616970,"ip_address":"","ucode":"A5735665E303FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2UXuSevhia94o9Eky4OfMuSictaldxcqpjGuvRCOcvjIIoVBAENLEZbv2lgwmwC8icK1ZrUcneNtiaeFBV8MT3uzNg/132","comment_is_top":false,"comment_ctime":1595738021,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595738021","product_id":100028001,"comment_content":"è¿™ä¸ªä¾‹å­åº”è¯¥ä¸éœ€è¦ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„Vectorï¼Œä½¿ç”¨ArrayListå°±å¯ä»¥äº†å§ï¼","like_count":0},{"had_liked":false,"id":211188,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1587911754,"is_pvip":false,"replies":[{"id":"78610","content":"é˜»å¡çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œæ˜¯é€šè¿‡stateä»¥åŠCASæ“ä½œåˆ¤æ–­ï¼Œåªæœ‰æ²¡æœ‰ç«äº‰æˆåŠŸæ—¶ï¼Œæ‰ä¼šå†æ¬¡è¢«æŒ‚èµ·ï¼Œè¿™æ ·å¯ä»¥å°½é‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å…·ä½“æºç å¦‚ä¸‹ï¼š<br>        final void lock() {<br>            if (compareAndSetState(0, 1))<br>                setExclusiveOwnerThread(Thread.currentThread());<br>            else<br>                acquire(1);<br>        }","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1587987848,"ip_address":"","comment_id":211188,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587911754","product_id":100028001,"comment_content":"è€å¸ˆåœ¨å›å¤ä¸­è¯´ï¼šAQSæŒ‚èµ·æ˜¯é€šè¿‡LockSupportä¸­çš„parkè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯å­˜åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ã€‚ä½†è¢«é˜»å¡çš„çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚<br>ä¸ºä»€ä¹ˆå†æ¬¡è·å–é”æ—¶ï¼Œä¸ä¼šäº§ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»£ç é‡Œå¯ä»¥çœ‹å‡ºæ¥å—ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493216,"discussion_content":"é˜»å¡çº¿ç¨‹å†æ¬¡è·å–é”æ—¶ï¼Œæ˜¯é€šè¿‡stateä»¥åŠCASæ“ä½œåˆ¤æ–­ï¼Œåªæœ‰æ²¡æœ‰ç«äº‰æˆåŠŸæ—¶ï¼Œæ‰ä¼šå†æ¬¡è¢«æŒ‚èµ·ï¼Œè¿™æ ·å¯ä»¥å°½é‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å…·ä½“æºç å¦‚ä¸‹ï¼š\n        final void lock() {\n            if (compareAndSetState(0, 1))\n                setExclusiveOwnerThread(Thread.currentThread());\n            else\n                acquire(1);\n        }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587987848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":210427,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1587742813,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587742813","product_id":100028001,"comment_content":"è°ƒç”¨notify()ï¼Œå¯èƒ½ä¼šå”¤é†’ä¸è¯¥å”¤é†’çš„çº¿ç¨‹ï¼Œå¯¼è‡´æ­»é”å§ã€‚","like_count":0},{"had_liked":false,"id":210046,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1242455,"ip_address":"","ucode":"0CCCA6F4DCC480","user_header":"https://static001.geekbang.org/account/avatar/00/12/f5/57/ce10fb1b.jpg","comment_is_top":false,"comment_ctime":1587656625,"is_pvip":false,"replies":[{"id":"78611","content":"æŒ‡é€šè¿‡CASè·å–åˆ°é”","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1587988171,"ip_address":"","comment_id":210046,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1587656625","product_id":100028001,"comment_content":"åœ¨å¤šçº¿ç¨‹ä¸­å¦‚æœä½¿ç”¨äº†ç«äº‰é”ï¼Œå½“çº¿ç¨‹ç”±äºç­‰å¾…ç«äº‰é”è€Œè¢«é˜»å¡æ—¶ï¼ŒJVM é€šå¸¸ä¼šå°†è¿™ä¸ªé”æŒ‚èµ·ï¼Œå¹¶å…è®¸å®ƒè¢«äº¤æ¢å‡ºå»ã€‚å¦‚æœé¢‘ç¹åœ°å‘ç”Ÿé˜»å¡ï¼ŒCPU å¯†é›†å‹çš„ç¨‹åºå°±ä¼šå‘ç”Ÿæ›´å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚è¿™ä¸ªè¢«äº¤æ¢å‡ºå»æ˜¯ä»€ä¹ˆæ„æ€?","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492925,"discussion_content":"æŒ‡é€šè¿‡CASè·å–åˆ°é”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587988171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166227,"user_name":"é˜¿æœ","can_delete":false,"product_type":"c1","uid":1066705,"ip_address":"","ucode":"349D3572F5ABE7","user_header":"https://static001.geekbang.org/account/avatar/00/10/46/d1/a1ddf49f.jpg","comment_is_top":false,"comment_ctime":1577418576,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577418576","product_id":100028001,"comment_content":"å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š1ï¼‰notifyä¼˜åŒ–ï¼Œå‡å°‘notifyè®¿é—®ï¼Œè®¾ç½®waitæ—¶é—´ï¼›2ï¼‰çº¿ç¨‹æ•°è®¾ç½®åˆç†ï¼›3ï¼‰å‡å°‘jvmåƒåœ¾å›æ”¶","like_count":0},{"had_liked":false,"id":137730,"user_name":"vivi","can_delete":false,"product_type":"c1","uid":1213764,"ip_address":"","ucode":"2F0005960F11F8","user_header":"https://wx.qlogo.cn/mmopen/vi_32/TaJVdWvc44qM6ABpA5KUHMGfje0OZ80pIib5AibrY23gf6DZWRibBGkTFI12Aumibga6tgQlM6wUHbBhz3beCk6UIg/132","comment_is_top":false,"comment_ctime":1569832528,"is_pvip":false,"replies":[{"id":"53042","content":"åœ¨äº‹åŠ¡å†…åŠ ï¼Œå…¶å®è¿™ç§æƒ…å†µä½¿ç”¨ä¹è§‚é”æ¥é”åº“å­˜ä¼šæ€§èƒ½å¥½ä¸€äº›","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569977466,"ip_address":"","comment_id":137730,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1569832528","product_id":100028001,"comment_content":"è¯·é—®ï¼Œé‚£äº‹ç‰©çš„å¼€å¯å’Œé”çš„æŒæœ‰æ—¶é—´è¯¥å¦‚ä½•æƒè¡¡ï¼Ÿä¾‹å¦‚æˆ‘æ–¹æ³•é‡Œè®¾è®¡åˆ°ä¸‰ä¸ªä¸åŒè¡¨çš„æ’å…¥æ›´æ–°æ“ä½œï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯åº“å­˜è¡¨ï¼Œæ˜¯è¯¥æŠŠé”åŠ åœ¨äº‹ç‰©å¤–é¢è¿˜æ˜¯åœ¨äº‹ç‰©ä¸­è¿›è¡Œåº“å­˜è¡¨çš„åŠ é”æ“ä½œ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469234,"discussion_content":"åœ¨äº‹åŠ¡å†…åŠ ï¼Œå…¶å®è¿™ç§æƒ…å†µä½¿ç”¨ä¹è§‚é”æ¥é”åº“å­˜ä¼šæ€§èƒ½å¥½ä¸€äº›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569977466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128615,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1566914313,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1566914313","product_id":100028001,"comment_content":"è€å¸ˆï¼Œå¦‚æœå°†æ–‡ä¸­çš„ä¾‹å­çš„waitï¼Œnotifyï¼ŒnotifyAllï¼Œå…¨éƒ¨æ¢æˆConditionçš„awaitï¼Œsignalå’ŒsignalAllæ–¹æ³•ã€‚æˆ‘è¯•äº†ä¸€ä¸‹ï¼Œåªè¦æŠŠsynchronizedæ¢æˆlocké”å°±å¯ä»¥å®ç°ç”Ÿäº§10ä¸ªæ•°æ®ï¼Œç„¶åæ¶ˆè´¹10ä¸ªæ•°æ®ã€‚æœ‰ä¸¤ä¸ªé—®é¢˜è¯·æ•™æ‚¨ï¼Œæœ›è€å¸ˆä¸åæŒ‡æ•™<br>1 .å°±è¿™ä¸ªåŠŸèƒ½æ¥è¯´ï¼Œç›´æ¥ä¸€å¯¹ä¸€æ›¿æ¢apiï¼Œæœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„åœ°æ–¹å—?æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨Condition<br>2 .å¦‚æœç”Ÿäº§è€…awaitç­‰å¾…è¶…æ—¶ï¼Œå†æ¬¡è·å–é”çš„è¡Œä¸ºï¼Œéœ€è¦æ€ä¹ˆåšå‘¢?","like_count":0},{"had_liked":false,"id":115616,"user_name":"devin.ou","can_delete":false,"product_type":"c1","uid":1064942,"ip_address":"","ucode":"C9AE50AFC2C194","user_header":"https://static001.geekbang.org/account/avatar/00/10/3f/ee/5ed997a6.jpg","comment_is_top":false,"comment_ctime":1563676030,"is_pvip":false,"replies":[{"id":"43572","content":"ä½ å¥½ devinï¼Œåœ¨ç¬¬29è®²ä¸­è®²åˆ°äº†å…·ä½“çš„ä¼˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1564452642,"ip_address":"","comment_id":115616,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563676030","product_id":100028001,"comment_content":"è€å¸ˆï¼Œèƒ½ç»™å‡ºwait&#47;notifyä¼˜å‘åçš„ä»£ç ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459192,"discussion_content":"ä½ å¥½ devinï¼Œåœ¨ç¬¬29è®²ä¸­è®²åˆ°äº†å…·ä½“çš„ä¼˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564452642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":113500,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1563034412,"is_pvip":false,"replies":[{"id":"41377","content":"ä½ å¥½DemonLeeåŒå­¦ï¼Œç¬¬ä¸€å¥æ˜¯åå‘é”ã€è½»é‡çº§é”ã€è‡ªæ—‹é”ä»¥åŠé‡é‡çº§é”ï¼›<br>ç¬¬22è®²ä¸­è¯¦ç»†è®²è§£äº†ä¼˜åŒ–åƒåœ¾å›æ”¶çš„å†…å®¹ï¼Œå¯ä»¥è·³è¿‡å»å…ˆäº†è§£ä¸‹ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563092290,"ip_address":"","comment_id":113500,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1563034412","product_id":100028001,"comment_content":"1.  â€˜â€™åœ¨ JDK1.6 ä¸­ï¼ŒJVM å°† Synchronized åŒæ­¥é”åˆ†ä¸ºäº†åå‘é”ã€è½»é‡çº§é”ã€åå‘é”ä»¥åŠé‡é‡çº§é”ï¼Œä¼˜åŒ–è·¯å¾„ä¹Ÿæ˜¯æŒ‰ç…§ä»¥ä¸Šé¡ºåºè¿›è¡Œã€‚â€˜â€™<br> è¿™å¥è¯é‡Œé¢æœ‰ä¸¤ä¸ªåå‘é”ï¼Œåä¸€ä¸ªæ˜¯ä¸æ˜¯â€œè‡ªæ—‹é”â€å‘€<br><br>2. è€å¸ˆåªè¯´äº†å‡å°‘åƒåœ¾å›æ”¶é¢‘ç‡å¯ä»¥å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ²¡è¯´å¦‚ä½•å‡å°‘å›æ”¶é¢‘ç‡ã€‚æ„Ÿè§‰ä¸æ˜¯ä¸ªå¥½é—®é¢˜ï¼Œç®—äº†ï¼Œæˆ‘è¿˜æ˜¯å…ˆå»Googleä¸‹æ‰¾ç­”æ¡ˆå§ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458250,"discussion_content":"ä½ å¥½DemonLeeåŒå­¦ï¼Œç¬¬ä¸€å¥æ˜¯åå‘é”ã€è½»é‡çº§é”ã€è‡ªæ—‹é”ä»¥åŠé‡é‡çº§é”ï¼›\nç¬¬22è®²ä¸­è¯¦ç»†è®²è§£äº†ä¼˜åŒ–åƒåœ¾å›æ”¶çš„å†…å®¹ï¼Œå¯ä»¥è·³è¿‡å»å…ˆäº†è§£ä¸‹ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563092290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":110111,"user_name":"æ—­ä¸œ(Frank)","can_delete":false,"product_type":"c1","uid":1024486,"ip_address":"","ucode":"176FA629800062","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg","comment_is_top":false,"comment_ctime":1562197860,"is_pvip":false,"replies":[{"id":"39950","content":"åŒ…æ‹¬äº†JDK1.6","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1562208442,"ip_address":"","comment_id":110111,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562197860","product_id":100028001,"comment_content":"åœ¨ JDK1.6 ä¸­ï¼ŒJVM å°† Synchronized åŒæ­¥é”åˆ†ä¸ºäº†åå‘é”ã€è½»é‡çº§é”ã€åå‘é”ä»¥åŠé‡é‡çº§é”ï¼Œä¼˜åŒ–è·¯å¾„ä¹Ÿæ˜¯æŒ‰ç…§ä»¥ä¸Šé¡ºåºè¿›è¡Œã€‚JIT ç¼–è¯‘å™¨åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼Œä¹Ÿä¼šé€šè¿‡é”æ¶ˆé™¤ã€é”ç²—åŒ–çš„æ–¹å¼æ¥ä¼˜åŒ–è¯¥åŒæ­¥é”ã€‚<br><br>è€å¸ˆï¼Œè¿™ä¸ªåªæ˜¯JDK1.6çš„ä¼˜åŒ–ï¼Œè¿˜æ˜¯1.6ä»¥åéƒ½æ˜¯è¿™ä¹ˆä¼˜åŒ–çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456728,"discussion_content":"åŒ…æ‹¬äº†JDK1.6","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562208442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109815,"user_name":"å¥‡å¥‡","can_delete":false,"product_type":"c1","uid":1399097,"ip_address":"","ucode":"BC86B0CB55E35A","user_header":"","comment_is_top":false,"comment_ctime":1562116789,"is_pvip":true,"replies":[{"id":"39959","content":"æ˜¯çš„ï¼Œè¿™ä¸ªå¾ªç¯åº”è¯¥æ”¾åˆ°é”é‡Œé¢ã€‚å·²ä¿®æ­£ï¼Œè°¢è°¢æé†’ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1562208970,"ip_address":"","comment_id":109815,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562116789","product_id":100028001,"comment_content":"ä¸åŒæ—¶æ‰§è¡Œremive ä½†æ˜¯ä¹Ÿä¼šè¿›å»æ‰§è¡Œremove(0)ä¹Ÿæ˜¯ä¸ç¬¦åˆè¯­ä¹‰çš„","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456586,"discussion_content":"æ˜¯çš„ï¼Œè¿™ä¸ªå¾ªç¯åº”è¯¥æ”¾åˆ°é”é‡Œé¢ã€‚å·²ä¿®æ­£ï¼Œè°¢è°¢æé†’ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562208970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107055,"user_name":"æ‹’ç»","can_delete":false,"product_type":"c1","uid":1335155,"ip_address":"","ucode":"CB0264C4D3FE17","user_header":"https://static001.geekbang.org/account/avatar/00/14/5f/73/bb3dc468.jpg","comment_is_top":false,"comment_ctime":1561449159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561449159","product_id":100028001,"comment_content":"ä½¿ç”¨notifyä¼šå¸¦æ¥çº¿ç¨‹é¥¥é¥¿ï¼Œè¯¥æ€æ ·é¿å…ï¼Ÿ","like_count":0},{"had_liked":false,"id":106954,"user_name":"CRann","can_delete":false,"product_type":"c1","uid":1542500,"ip_address":"","ucode":"45D569C9778BDA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqWicx6gYmNqGYC8V9xo31w9hjsJrZB1fogG6ibBc0KObo2q3n1xndl6BcriahzHKnGvWy3sgCxVlH1w/132","comment_is_top":false,"comment_ctime":1561428792,"is_pvip":false,"replies":[{"id":"38854","content":"å¯ä»¥æ ¹æ®æ¡ä»¶æ¥å”¤é†’ï¼Œä¾‹å¦‚ï¼Œå½“æœ‰åˆé€‚çš„åº“å­˜æ—¶ï¼Œä¾æ¬¡å”¤é†’å…¶ä»–çº¿ç¨‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561521359,"ip_address":"","comment_id":106954,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561428792","product_id":100028001,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹wait()çš„æ—¶å€™notify()æ€ä¹ˆå”¤é†’æŒ‡å®šçº¿ç¨‹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455300,"discussion_content":"å¯ä»¥æ ¹æ®æ¡ä»¶æ¥å”¤é†’ï¼Œä¾‹å¦‚ï¼Œå½“æœ‰åˆé€‚çš„åº“å­˜æ—¶ï¼Œä¾æ¬¡å”¤é†’å…¶ä»–çº¿ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561521359,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":106901,"user_name":"cricket1981","can_delete":false,"product_type":"c1","uid":1001715,"ip_address":"","ucode":"758262F5958DA4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/f3/f1034ffd.jpg","comment_is_top":false,"comment_ctime":1561423693,"is_pvip":false,"replies":[{"id":"38842","content":"å› ä¸ºnotifyç»“åˆwaitä½¿ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´æŸäº›çº¿ç¨‹æ²¡æœ‰è¢«å”¤é†’ï¼Œè€Œå¤„äºä¸€ç›´ç­‰å¾…çŠ¶æ€ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®è‡ªå·±çš„å…·ä½“ä¸šåŠ¡æ¥è¡¡é‡ä½¿ç”¨å“ªä¸€ä¸ªã€‚<br><br>åœ¨15è®²ä¸­ï¼Œæœ‰æåˆ°ä½¿ç”¨vmstatç›‘æµ‹è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»¥åŠpidstatç›‘æµ‹çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1561516895,"ip_address":"","comment_id":106901,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1561423693","product_id":100028001,"comment_content":"æ€æ ·ç›‘æ§ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿä¸ºä»€ä¹ˆæœ‰çš„å¹¶å‘ä¹¦å»ºè®®ç”¨notifyAllè€Œä¸æ˜¯notifyï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":455274,"discussion_content":"å› ä¸ºnotifyç»“åˆwaitä½¿ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´æŸäº›çº¿ç¨‹æ²¡æœ‰è¢«å”¤é†’ï¼Œè€Œå¤„äºä¸€ç›´ç­‰å¾…çŠ¶æ€ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®è‡ªå·±çš„å…·ä½“ä¸šåŠ¡æ¥è¡¡é‡ä½¿ç”¨å“ªä¸€ä¸ªã€‚\n\nåœ¨15è®²ä¸­ï¼Œæœ‰æåˆ°ä½¿ç”¨vmstatç›‘æµ‹è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»¥åŠpidstatç›‘æµ‹çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561516895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1224367,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ae/af/985298a8.jpg","nickname":"Michelle","note":"","ucode":"82B82C067F98F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":313,"discussion_content":"ä¸ºä»€ä¹ˆæœ‰çš„å¹¶å‘ä¹¦å»ºè®®ç”¨notifyAllè€Œä¸æ˜¯notifyï¼Ÿ\n\nå› ä¸ºnotify æ˜¯éšæœºé€šçŸ¥waitlistä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼ŒnotifyAllæ˜¯é€šçŸ¥waitlistä¸­å…¨éƒ¨çº¿ç¨‹ï¼Œæ‰€ä»¥æœ‰äº›çº¿ç¨‹ä¼šæ°¸è¿œä¸è¢«é€šçŸ¥åˆ°ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561443480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}