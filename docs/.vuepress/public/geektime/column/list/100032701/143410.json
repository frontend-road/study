{"id":143410,"title":"25 | ä½¿ç”¨é˜»å¡I/Oå’Œè¿›ç¨‹æ¨¡å‹ï¼šæœ€ä¼ ç»Ÿçš„æ–¹å¼","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç››å»¶æ•ï¼Œè¿™é‡Œæ˜¯ç½‘ç»œç¼–ç¨‹å®æˆ˜ç¬¬25è®²ï¼Œæ¬¢è¿å›æ¥ã€‚</p><p>ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°äº†C10Ké—®é¢˜ï¼Œå¹¶å¼•å…¥äº†è§£å†³C10Ké—®é¢˜çš„å„ç§è§£æ³•ã€‚å…¶ä¸­ï¼Œæœ€ç®€å•ä¹Ÿæ˜¯æœ€æœ‰æ•ˆçš„ä¸€ç§è§£å†³æ–¹æ³•å°±æ˜¯ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹å»æœåŠ¡ã€‚é‚£ä¹ˆï¼Œåˆ°åº•å¦‚ä½•ä¸ºæ¯ä¸ªè¿æ¥å®¢æˆ·åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ¥æœåŠ¡å‘¢ï¼Ÿåœ¨è¿™å…¶ä¸­ï¼Œåˆéœ€è¦ç‰¹åˆ«æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±å›´ç»•è¿™éƒ¨åˆ†å†…å®¹å±•å¼€ï¼ŒæœŸæœ›ç»è¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œä½ å¯¹çˆ¶å­è¿›ç¨‹ã€åƒµå°¸è¿›ç¨‹ã€ä½¿ç”¨è¿›ç¨‹å¤„ç†è¿æ¥ç­‰æœ‰ä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„ç†è§£ã€‚</p><h2>çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œè¿›ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹æœ‰å®Œæ•´çš„åœ°å€ç©ºé—´ã€ç¨‹åºè®¡æ•°å™¨ç­‰ï¼Œå¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œä½¿ç”¨å‡½æ•°forkå°±å¯ä»¥ã€‚</p><pre><code>pid_t fork(void)\nè¿”å›ï¼šåœ¨å­è¿›ç¨‹ä¸­ä¸º0ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­ä¸ºå­è¿›ç¨‹IDï¼Œè‹¥å‡ºé”™åˆ™ä¸º-1\n</code></pre><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œä½ ä¼šè§‰å¾—éš¾ä»¥ç†è§£çš„åœ°æ–¹åœ¨äºï¼Œè™½ç„¶æˆ‘ä»¬çš„ç¨‹åºè°ƒç”¨forkä¸€æ¬¡ï¼Œå®ƒå´åœ¨çˆ¶ã€å­è¿›ç¨‹é‡Œå„è¿”å›ä¸€æ¬¡ã€‚åœ¨è°ƒç”¨è¯¥å‡½æ•°çš„è¿›ç¨‹ï¼ˆå³ä¸ºçˆ¶è¿›ç¨‹ï¼‰ä¸­è¿”å›çš„æ˜¯æ–°æ´¾ç”Ÿçš„è¿›ç¨‹IDå·ï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å›çš„å€¼ä¸º0ã€‚æƒ³è¦çŸ¥é“å½“å‰æ‰§è¡Œçš„è¿›ç¨‹åˆ°åº•æ˜¯çˆ¶è¿›ç¨‹ï¼Œè¿˜æ˜¯å­è¿›ç¨‹ï¼Œåªèƒ½é€šè¿‡è¿”å›å€¼æ¥è¿›è¡Œåˆ¤æ–­ã€‚</p><p>forkå‡½æ•°å®ç°çš„æ—¶å€™ï¼Œå®é™…ä¸Šä¼šæŠŠå½“å‰çˆ¶è¿›ç¨‹çš„æ‰€æœ‰ç›¸å…³å€¼éƒ½å…‹éš†ä¸€ä»½ï¼ŒåŒ…æ‹¬åœ°å€ç©ºé—´ã€æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€ç¨‹åºè®¡æ•°å™¨ç­‰ï¼Œå°±è¿æ‰§è¡Œä»£ç ä¹Ÿä¼šæ‹·è´ä¸€ä»½ï¼Œæ–°æ´¾ç”Ÿçš„è¿›ç¨‹çš„è¡¨ç°è¡Œä¸ºå’Œçˆ¶è¿›ç¨‹è¿‘ä¹ä¸€æ ·ï¼Œå°±å¥½åƒæ˜¯æ´¾ç”Ÿè¿›ç¨‹è°ƒç”¨è¿‡forkå‡½æ•°ä¸€æ ·ã€‚ä¸ºäº†åŒºåˆ«ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œå®ç°è€…å¯ä»¥é€šè¿‡æ”¹å˜forkå‡½æ•°çš„æ ˆç©ºé—´å€¼æ¥åˆ¤æ–­ï¼Œå¯¹åº”åˆ°ç¨‹åºä¸­å°±æ˜¯è¿”å›å€¼çš„ä¸åŒã€‚</p><!-- [[[read_end]]] --><p>è¿™æ ·å°±å½¢æˆäº†ç¼–ç¨‹èŒƒå¼ï¼š</p><pre><code>if(fork() == 0){\n  do_child_process(); //å­è¿›ç¨‹æ‰§è¡Œä»£ç \n}else{\n  do_parent_process();  //çˆ¶è¿›ç¨‹æ‰§è¡Œä»£ç \n}\n</code></pre><p>å½“ä¸€ä¸ªå­è¿›ç¨‹é€€å‡ºæ—¶ï¼Œç³»ç»Ÿå†…æ ¸è¿˜ä¿ç•™äº†è¯¥è¿›ç¨‹çš„è‹¥å¹²ä¿¡æ¯ï¼Œæ¯”å¦‚é€€å‡ºçŠ¶æ€ã€‚è¿™æ ·çš„è¿›ç¨‹å¦‚æœä¸å›æ”¶ï¼Œå°±ä¼šå˜æˆåƒµå°¸è¿›ç¨‹ã€‚åœ¨Linuxä¸‹ï¼Œè¿™æ ·çš„â€œåƒµå°¸â€è¿›ç¨‹ä¼šè¢«æŒ‚åˆ°è¿›ç¨‹å·ä¸º1çš„initè¿›ç¨‹ä¸Šã€‚æ‰€ä»¥ï¼Œç”±çˆ¶è¿›ç¨‹æ´¾ç”Ÿå‡ºæ¥çš„å­è¿›ç¨‹ï¼Œä¹Ÿå¿…é¡»ç”±çˆ¶è¿›ç¨‹è´Ÿè´£å›æ”¶ï¼Œå¦åˆ™å­è¿›ç¨‹å°±ä¼šå˜æˆåƒµå°¸è¿›ç¨‹ã€‚åƒµå°¸è¿›ç¨‹ä¼šå ç”¨ä¸å¿…è¦çš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœé‡å¤šåˆ°äº†ä¸€å®šæ•°é‡çº§ï¼Œå°±ä¼šè€—å°½æˆ‘ä»¬çš„ç³»ç»Ÿèµ„æºã€‚</p><p>æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åœ¨å­è¿›ç¨‹é€€å‡ºåå›æ”¶èµ„æºï¼Œåˆ†åˆ«æ˜¯è°ƒç”¨waitå’Œwaitpidå‡½æ•°ã€‚</p><pre><code>pid_t wait(int *statloc);\npid_t waitpid(pid_t pid, int *statloc, int options);\n</code></pre><p>å‡½æ•°waitå’Œwaitpidéƒ½å¯ä»¥è¿”å›ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°è¿”å›å€¼ï¼Œè¡¨ç¤ºå·²ç»ˆæ­¢å­è¿›ç¨‹çš„è¿›ç¨‹IDå·ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯é€šè¿‡statlocæŒ‡é’ˆè¿”å›å­è¿›ç¨‹ç»ˆæ­¢çš„å®é™…çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€å¯èƒ½çš„å€¼ä¸ºæ­£å¸¸ç»ˆæ­¢ã€è¢«ä¿¡å·æ€æ­»ã€ä½œä¸šæ§åˆ¶åœæ­¢ç­‰ã€‚</p><p>å¦‚æœæ²¡æœ‰å·²ç»ˆæ­¢çš„å­è¿›ç¨‹ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹åœ¨æ­£å¸¸è¿è¡Œï¼Œé‚£ä¹ˆwaitå°†é˜»å¡ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªå­è¿›ç¨‹ç»ˆæ­¢ã€‚</p><p>waitpidå¯ä»¥è®¤ä¸ºæ˜¯waitå‡½æ•°çš„å‡çº§ç‰ˆï¼Œå®ƒçš„å‚æ•°æ›´å¤šï¼Œæä¾›çš„æ§åˆ¶æƒä¹Ÿæ›´å¤šã€‚pidå‚æ•°å…è®¸æˆ‘ä»¬æŒ‡å®šä»»æ„æƒ³ç­‰å¾…ç»ˆæ­¢çš„è¿›ç¨‹IDï¼Œå€¼-1è¡¨ç¤ºç­‰å¾…ç¬¬ä¸€ä¸ªç»ˆæ­¢çš„å­è¿›ç¨‹ã€‚optionså‚æ•°ç»™äº†æˆ‘ä»¬æ›´å¤šçš„æ§åˆ¶é€‰é¡¹ã€‚</p><p>å¤„ç†å­è¿›ç¨‹é€€å‡ºçš„æ–¹å¼ä¸€èˆ¬æ˜¯æ³¨å†Œä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼Œæ•æ‰ä¿¡å·SIGCHLDä¿¡å·ï¼Œç„¶åå†åœ¨ä¿¡å·å¤„ç†å‡½æ•°é‡Œè°ƒç”¨waitpidå‡½æ•°æ¥å®Œæˆå­è¿›ç¨‹èµ„æºçš„å›æ”¶ã€‚SIGCHLDæ˜¯å­è¿›ç¨‹é€€å‡ºæˆ–è€…ä¸­æ–­æ—¶ç”±å†…æ ¸å‘çˆ¶è¿›ç¨‹å‘å‡ºçš„ä¿¡å·ï¼Œé»˜è®¤è¿™ä¸ªä¿¡å·æ˜¯å¿½ç•¥çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³åœ¨å­è¿›ç¨‹é€€å‡ºæ—¶èƒ½å›æ”¶å®ƒï¼Œéœ€è¦åƒä¸‹é¢ä¸€æ ·ï¼Œæ³¨å†Œä¸€ä¸ªSIGCHLDå‡½æ•°ã€‚</p><pre><code>signal(SIGCHLD, sigchld_handler);ã€€ã€€\n</code></pre><h2>é˜»å¡I/Oçš„è¿›ç¨‹æ¨¡å‹</h2><p>ä¸ºäº†è¯´æ˜ä½¿ç”¨é˜»å¡I/Oå’Œè¿›ç¨‹æ¨¡å‹ï¼Œæˆ‘ä»¬å‡è®¾æœ‰ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨åˆå§‹ç›‘å¬åœ¨å¥—æ¥å­—lisnted_fdä¸Šã€‚å½“ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼Œè¿æ¥å»ºç«‹åäº§ç”Ÿå‡ºè¿æ¥å¥—æ¥å­—ï¼Œæ­¤æ—¶ï¼Œçˆ¶è¿›ç¨‹æ´¾ç”Ÿå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œåœ¨å­è¿›ç¨‹ä¸­ï¼Œä½¿ç”¨è¿æ¥å¥—æ¥å­—å’Œå®¢æˆ·ç«¯é€šä¿¡ï¼Œå› æ­¤å­è¿›ç¨‹ä¸éœ€è¦å…³å¿ƒç›‘å¬å¥—æ¥å­—ï¼Œåªéœ€è¦å…³å¿ƒè¿æ¥å¥—æ¥å­—ï¼›çˆ¶è¿›ç¨‹åˆ™ç›¸åï¼Œå°†å®¢æˆ·æœåŠ¡äº¤ç»™å­è¿›ç¨‹æ¥å¤„ç†ï¼Œå› æ­¤çˆ¶è¿›ç¨‹ä¸éœ€è¦å…³å¿ƒè¿æ¥å¥—æ¥å­—ï¼Œåªéœ€è¦å…³å¿ƒç›‘å¬å¥—æ¥å­—ã€‚</p><p>è¿™å¼ å›¾æè¿°äº†ä»è¿æ¥è¯·æ±‚åˆ°è¿æ¥å»ºç«‹ï¼Œçˆ¶è¿›ç¨‹æ´¾ç”Ÿå­è¿›ç¨‹ä¸ºå®¢æˆ·æœåŠ¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6c/a3/6cf70cf7f651273b38aac61cb61a88a3.png?wh=1398*598\" alt=\"\"><br>\nå‡è®¾çˆ¶è¿›ç¨‹ä¹‹ååˆæ¥æ”¶äº†æ–°çš„è¿æ¥è¯·æ±‚ï¼Œä»acceptè°ƒç”¨è¿”å›æ–°çš„å·²è¿æ¥å¥—æ¥å­—ï¼Œçˆ¶è¿›ç¨‹åˆæ´¾ç”Ÿå‡ºå¦ä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹ç”¨ç¬¬äºŒä¸ªå·²è¿æ¥å¥—æ¥å­—ä¸ºå®¢æˆ·ç«¯æœåŠ¡ã€‚</p><p>è¿™å¼ å›¾åŒæ ·æè¿°äº†è¿™ä¸ªè¿‡ç¨‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4f/08/4fb66c841fbca96f8b27c13c61a29608.png?wh=1366*718\" alt=\"\"><br>\nç°åœ¨ï¼ŒæœåŠ¡å™¨ç«¯çš„çˆ¶è¿›ç¨‹ç»§ç»­ç›‘å¬åœ¨å¥—æ¥å­—ä¸Šï¼Œç­‰å¾…æ–°çš„å®¢æˆ·è¿æ¥åˆ°æ¥ï¼›ä¸¤ä¸ªå­è¿›ç¨‹åˆ†åˆ«ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„è¿æ¥å¥—æ¥å­—ä¸ºä¸¤ä¸ªå®¢æˆ·æœåŠ¡ã€‚</p><h2>ç¨‹åºè®²è§£</h2><p>æˆ‘ä»¬å°†å‰é¢çš„å†…å®¹ä¸²è”èµ·æ¥ï¼Œå°±æ˜¯ä¸‹é¢å®Œæ•´çš„ä¸€ä¸ªåŸºäºè¿›ç¨‹æ¨¡å‹çš„æœåŠ¡å™¨ç«¯ç¨‹åºã€‚</p><pre><code>#include &quot;lib/common.h&quot;\n\n#define MAX_LINE 4096\n\nchar rot13_char(char c) {\n    if ((c &gt;= 'a' &amp;&amp; c &lt;= 'm') || (c &gt;= 'A' &amp;&amp; c &lt;= 'M'))\n        return c + 13;\n    else if ((c &gt;= 'n' &amp;&amp; c &lt;= 'z') || (c &gt;= 'N' &amp;&amp; c &lt;= 'Z'))\n        return c - 13;\n    else\n        return c;\n}\n\nvoid child_run(int fd) {\n    char outbuf[MAX_LINE + 1];\n    size_t outbuf_used = 0;\n    ssize_t result;\n\n    while (1) {\n        char ch;\n        result = recv(fd, &amp;ch, 1, 0);\n        if (result == 0) {\n            break;\n        } else if (result == -1) {\n            perror(&quot;read&quot;);\n            break;\n        }\n\n        if (outbuf_used &lt; sizeof(outbuf)) {\n            outbuf[outbuf_used++] = rot13_char(ch);\n        }\n\n        if (ch == '\\n') {\n            send(fd, outbuf, outbuf_used, 0);\n            outbuf_used = 0;\n            continue;\n        }\n    }\n}\n\nvoid sigchld_handler(int sig) {\n    while (waitpid(-1, 0, WNOHANG) &gt; 0);\n    return;\n}\n\nint main(int c, char **v) {\n    int listener_fd = tcp_server_listen(SERV_PORT);\n    signal(SIGCHLD, sigchld_handler);\n    while (1) {\n        struct sockaddr_storage ss;\n        socklen_t slen = sizeof(ss);\n        int fd = accept(listener_fd, (struct sockaddr *) &amp;ss, &amp;slen);\n        if (fd &lt; 0) {\n            error(1, errno, &quot;accept failed&quot;);\n            exit(1);\n        }\n\n        if (fork() == 0) {\n            close(listener_fd);\n            child_run(fd);\n            exit(0);\n        } else {\n            close(fd);\n        }\n    }\n\n    return 0;\n}\n</code></pre><p>ç¨‹åºçš„48è¡Œæ³¨å†Œäº†ä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼Œç”¨æ¥å›æ”¶å­è¿›ç¨‹èµ„æºã€‚å‡½æ•°sigchld_handlerï¼Œåœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…è°ƒç”¨äº†waitpidå‡½æ•°ï¼Œä»¥ä¾¿å›æ”¶æ‰€æœ‰å·²ç»ˆæ­¢çš„å­è¿›ç¨‹ã€‚è¿™é‡Œé€‰é¡¹WNOHANGç”¨æ¥å‘Šè¯‰å†…æ ¸ï¼Œå³ä½¿è¿˜æœ‰æœªç»ˆæ­¢çš„å­è¿›ç¨‹ä¹Ÿä¸è¦é˜»å¡åœ¨waitpidä¸Šã€‚æ³¨æ„è¿™é‡Œä¸å¯ä»¥ä½¿ç”¨waitï¼Œå› ä¸ºwaitå‡½æ•°åœ¨æœ‰æœªç»ˆæ­¢å­è¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰åŠæ³•ä¸é˜»å¡ã€‚</p><p>ç¨‹åºçš„58-62è¡Œï¼Œé€šè¿‡åˆ¤æ–­forkçš„è¿”å›å€¼ä¸º0ï¼Œè¿›å…¥å­è¿›ç¨‹å¤„ç†é€»è¾‘ã€‚æŒ‰ç…§å‰é¢çš„è®²è¿°ï¼Œå­è¿›ç¨‹ä¸éœ€è¦å…³å¿ƒç›‘å¬å¥—æ¥å­—ï¼Œæ•…è€Œåœ¨è¿™é‡Œå…³é—­æ‰ç›‘å¬å¥—æ¥å­—listen_fdï¼Œä¹‹åè°ƒç”¨child_runå‡½æ•°ä½¿ç”¨å·²è¿æ¥å¥—æ¥å­—fdæ¥è¿›è¡Œæ•°æ®è¯»å†™ã€‚ç¬¬63è¡Œï¼Œè¿›å…¥çš„æ˜¯çˆ¶è¿›ç¨‹å¤„ç†é€»è¾‘ï¼Œçˆ¶è¿›ç¨‹ä¸éœ€è¦å…³å¿ƒè¿æ¥å¥—æ¥å­—ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå…³é—­è¿æ¥å¥—æ¥å­—ã€‚</p><p>è¿˜è®°å¾—<a href=\"https://time.geekbang.org/column/article/126126\">ç¬¬11è®²</a>ä¸­è®²åˆ°çš„closeå‡½æ•°å—ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œä»çˆ¶è¿›ç¨‹æ´¾ç”Ÿå‡ºçš„å­è¿›ç¨‹ï¼ŒåŒæ—¶ä¹Ÿä¼šå¤åˆ¶ä¸€ä»½æè¿°å­—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿æ¥å¥—æ¥å­—å’Œç›‘å¬å¥—æ¥å­—çš„å¼•ç”¨è®¡æ•°éƒ½ä¼šè¢«åŠ 1ï¼Œè€Œè°ƒç”¨closeå‡½æ•°åˆ™ä¼šå¯¹å¼•ç”¨è®¡æ•°è¿›è¡Œå‡1æ“ä½œï¼Œè¿™æ ·åœ¨å¥—æ¥å­—å¼•ç”¨è®¡æ•°åˆ°0æ—¶ï¼Œæ‰å¯ä»¥å°†å¥—æ¥å­—èµ„æºå›æ”¶ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œçš„closeå‡½æ•°éå¸¸é‡è¦ï¼Œç¼ºå°‘äº†å®ƒä»¬ï¼Œå°±ä¼šå¼•èµ·æœåŠ¡å™¨ç«¯èµ„æºçš„æ³„éœ²ã€‚</p><p>child_runå‡½æ•°ä¸­ï¼Œé€šè¿‡ä¸€ä¸ªwhileå¾ªç¯æ¥ä¸æ–­å’Œå®¢æˆ·ç«¯è¿›è¡Œäº¤äº’ï¼Œä¾æ¬¡è¯»å‡ºå­—ç¬¦ä¹‹åï¼Œè¿›è¡Œäº†ç®€å•çš„è½¬ç ï¼Œå¦‚æœè¯»åˆ°å›è½¦ç¬¦ï¼Œåˆ™å°†è½¬ç ä¹‹åçš„ç»“æœé€šè¿‡è¿æ¥å¥—æ¥å­—å‘é€å‡ºå»ã€‚è¿™æ ·çš„å›æ˜¾æ–¹å¼ï¼Œæ˜¾å¾—æ¯”è¾ƒæœ‰â€œäº¤äº’æ„Ÿâ€ã€‚</p><h2>å®éªŒ</h2><p>æˆ‘ä»¬å¯åŠ¨è¯¥æœåŠ¡å™¨ï¼Œç›‘å¬åœ¨å¯¹åº”çš„ç«¯å£43211ä¸Šã€‚</p><pre><code>./fork01\n</code></pre><p>å†å¯åŠ¨ä¸¤ä¸ªtelnetå®¢æˆ·ç«¯ï¼Œè¿æ¥åˆ°43211ç«¯å£ï¼Œæ¯æ¬¡é€šè¿‡æ ‡å‡†è¾“å…¥å’ŒæœåŠ¡å™¨ç«¯ä¼ è¾“ä¸€äº›æ•°æ®ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„äº¤äº’æ­£å¸¸ã€‚</p><pre><code>$telnet 127.0.0.1 43211\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nafasfa\nnsnfsn\n]\ntelnet&gt; quit\nConnection closed.\n</code></pre><pre><code>$telnet 127.0.0.1 43211\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nagasgasg\nntnftnft\n]\ntelnet&gt; quit\nConnection closed.\n</code></pre><p>å®¢æˆ·ç«¯é€€å‡ºï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿåœ¨æ­£å¸¸å·¥ä½œï¼Œæ­¤æ—¶å¦‚æœå†é€šè¿‡telnetå»ºç«‹æ–°çš„è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„æ•°æ®ä¼ è¾“ä¹Ÿä¼šæ­£å¸¸è¿›è¡Œã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå®Œæ•´çš„æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œå¯ä»¥å¹¶å‘å¤„ç†å¤šä¸ªä¸åŒçš„å®¢æˆ·è¿æ¥ï¼Œäº’ä¸å¹²æ‰°ã€‚</p><h2>æ€»ç»“</h2><p>ä½¿ç”¨é˜»å¡I/Oå’Œè¿›ç¨‹æ¨¡å‹ï¼Œä¸ºæ¯ä¸€ä¸ªè¿æ¥åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å­è¿›ç¨‹æ¥è¿›è¡ŒæœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªéå¸¸ç®€å•æœ‰æ•ˆçš„å®ç°æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å¯èƒ½å¾ˆéš¾æ»¡è¶³é«˜æ€§èƒ½ç¨‹åºçš„éœ€æ±‚ï¼Œä½†å¥½å¤„åœ¨äºå®ç°ç®€å•ã€‚åœ¨å®ç°è¿™æ ·çš„ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ul>\n<li>è¦æ³¨æ„å¯¹å¥—æ¥å­—çš„å…³é—­æ¢³ç†ï¼›</li>\n<li>è¦æ³¨æ„å¯¹å­è¿›ç¨‹è¿›è¡Œå›æ”¶ï¼Œé¿å…äº§ç”Ÿä¸å¿…è¦çš„åƒµå°¸è¿›ç¨‹ã€‚</li>\n</ul><h2>æ€è€ƒé¢˜</h2><p>ç»™ä½ å‡ºä¸¤é“æ€è€ƒé¢˜ï¼š</p><p>ç¬¬ä¸€é“ï¼Œä½ å¯ä»¥æŸ¥æŸ¥èµ„æ–™ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ¯”è¾ƒè‘—åçš„ç¨‹åºæ˜¯ä½¿ç”¨è¿™æ ·çš„æ¨¡å¼æ¥æ„å»ºçš„ï¼Ÿ</p><p>ç¬¬äºŒé“ï¼Œç¨‹åºä¸­å¤„ç†SIGCHLDä¿¡å·æ—¶ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¾ªç¯æ¥å›æ”¶å¤„ç†ç»ˆæ­¢çš„å­è¿›ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿå¦‚æœä¸ä½¿ç”¨å¾ªç¯ä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œæˆ‘ä¼šå’Œä½ ä¸€èµ·äº¤æµï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµä¸€ä¸‹ã€‚</p>","neighbors":{"left":{"article_title":"24 | C10Ké—®é¢˜ï¼šé«˜å¹¶å‘æ¨¡å‹è®¾è®¡","id":143388},"right":{"article_title":"26 | ä½¿ç”¨é˜»å¡I/Oå’Œçº¿ç¨‹æ¨¡å‹ï¼šæ¢ä¸€ç§è½»é‡çš„æ–¹å¼","id":145464}},"comments":[{"had_liked":false,"id":139706,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1570709098,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"156189531754","product_id":100032701,"comment_content":"è¯»ä¹¦å°‘çš„äººåªèƒ½ç›´æ¥å›ç­”ç¬¬äºŒé—® ç¬¬ä¸€é—®å›ç­”ä¸äº†å“ˆå“ˆå“ˆ<br>æ˜¯å› ä¸ºå¦‚æœæœ‰å¤šä¸ªå­è¿›ç¨‹åŒæ—¶ç»“æŸçš„è¯å†…æ ¸åªä¼šäº§ç”Ÿä¸€æ¬¡SIGCHLDä¿¡å·è‡³å°‘ä¿¡å·å¤„ç†å‡½æ•°åªä¼šå”¤é†’ä¸€æ¬¡,å¦‚æœä¸å¾ªç¯å°±æ— æ³•å–å¾—æ‰€æœ‰å·²ç»ˆæ­¢çš„å­è¿›ç¨‹æ•°æ®","like_count":37},{"had_liked":false,"id":149351,"user_name":"rong","can_delete":false,"product_type":"c1","uid":1128740,"ip_address":"","ucode":"637A27C532D817","user_header":"https://static001.geekbang.org/account/avatar/00/11/39/24/ab14f6cf.jpg","comment_is_top":false,"comment_ctime":1573199744,"is_pvip":false,"replies":[{"id":"57497","content":"åœ¨Linuxé‡Œé¢ï¼Œçº¿ç¨‹å…¶å®å°±æ˜¯è½»é‡çº§è¿›ç¨‹(light-weighted process)ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨åŒæ ·çš„task_structç»“æ„ï¼Œæ— è®ºç”¨æˆ·è¿›ç¨‹(process), ç”¨æˆ·çº¿ç¨‹(thread)ï¼Œå°±åªæ˜¯åœ¨task_structçš„å¡«æ³•ä¸ä¸€æ ·è€Œå·²ã€‚<br><br>æ‰€ä»¥ï¼Œä»å†…æ ¸è§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯çº¿ç¨‹(task_struct)æ˜¯æœ€å°çš„ï¼Œä½†æ˜¯ä»ç”¨æˆ·è§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯è¿›ç¨‹æ˜¯æœ€å°æ‰§è¡Œçš„å•å…ƒï¼Œå› ä¸ºä¸å¯èƒ½æ²¡æœ‰è¿›ç¨‹ï¼Œå‡­ç©ºäº§ç”Ÿå‡ºçº¿ç¨‹æ¥ã€‚<br><br>çº¿ç¨‹å’Œè¿›ç¨‹éƒ½æœ‰å„è‡ªçš„PCè®¡æ•°å™¨ï¼Œå®é™…ä¸Šï¼Œæ— è®ºæ˜¯è¿™é‡Œçš„forkï¼Œè¿˜æ˜¯åé¢è®²åˆ°çš„çº¿ç¨‹pthread_createï¼Œæœ€ç»ˆåˆ°å†…æ ¸ä¸­éƒ½æ˜¯è°ƒç”¨do_forkæ¥äº§ç”Ÿtask_structç»“æ„çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1573285197,"ip_address":"","comment_id":149351,"utype":1}],"discussion_count":3,"race_medal":0,"score":"74587643776","product_id":100032701,"comment_content":"æ–‡ç« å¼€å¤´éƒ¨åˆ†ï¼Œåº”è¯¥æ˜¯çº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½å§ã€‚è¿›ç¨‹æ˜¯cpuåˆ†é…èµ„æºçš„æœ€å°å•ä½ã€‚è¿˜æœ‰ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œä¸æ˜¯æ¯ä¸ªè¿›ç¨‹ã€‚","like_count":17,"discussions":[{"author":{"id":1316758,"avatar":"https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg","nickname":"Richard","note":"","ucode":"893F958B9DD161","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":204228,"discussion_content":"è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„å•ä½","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1584147593,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473827,"discussion_content":"åœ¨Linuxé‡Œé¢ï¼Œçº¿ç¨‹å…¶å®å°±æ˜¯è½»é‡çº§è¿›ç¨‹(light-weighted process)ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨åŒæ ·çš„task_structç»“æ„ï¼Œæ— è®ºç”¨æˆ·è¿›ç¨‹(process), ç”¨æˆ·çº¿ç¨‹(thread)ï¼Œå°±åªæ˜¯åœ¨task_structçš„å¡«æ³•ä¸ä¸€æ ·è€Œå·²ã€‚\n\næ‰€ä»¥ï¼Œä»å†…æ ¸è§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯çº¿ç¨‹(task_struct)æ˜¯æœ€å°çš„ï¼Œä½†æ˜¯ä»ç”¨æˆ·è§’åº¦æ¥è¯´ï¼Œç¡®å®æ˜¯è¿›ç¨‹æ˜¯æœ€å°æ‰§è¡Œçš„å•å…ƒï¼Œå› ä¸ºä¸å¯èƒ½æ²¡æœ‰è¿›ç¨‹ï¼Œå‡­ç©ºäº§ç”Ÿå‡ºçº¿ç¨‹æ¥ã€‚\n\nçº¿ç¨‹å’Œè¿›ç¨‹éƒ½æœ‰å„è‡ªçš„PCè®¡æ•°å™¨ï¼Œå®é™…ä¸Šï¼Œæ— è®ºæ˜¯è¿™é‡Œçš„forkï¼Œè¿˜æ˜¯åé¢è®²åˆ°çš„çº¿ç¨‹pthread_createï¼Œæœ€ç»ˆåˆ°å†…æ ¸ä¸­éƒ½æ˜¯è°ƒç”¨do_forkæ¥äº§ç”Ÿtask_structç»“æ„çš„ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573285197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2184325,"avatar":"https://static001.geekbang.org/account/avatar/00/21/54/85/ab5148ce.jpg","nickname":"duckman","note":"","ucode":"0184C26C4B6C1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":334894,"discussion_content":"å¤ªæœ¬æœ¬ä¸»ä¹‰äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608021311,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139879,"user_name":"Kepler","can_delete":false,"product_type":"c1","uid":1214303,"ip_address":"","ucode":"0C9CA3DB8B3CF0","user_header":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","comment_is_top":false,"comment_ctime":1570759776,"is_pvip":true,"replies":[{"id":"55070","content":"æˆ‘çŸ¥é“æœ‰apacheæœåŠ¡å™¨ï¼Œå…¶ä»–çš„å¤§å®¶å¯ä»¥è¡¥å……ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1571450948,"ip_address":"","comment_id":139879,"utype":1}],"discussion_count":3,"race_medal":0,"score":"48815400032","product_id":100032701,"comment_content":"è¿™ç§å¤è€çš„å¤šè¿›ç¨‹æ–¹å¼æ¥å¤„ç†ioåº”è¯¥æ˜¯apacheæœåŠ¡å™¨äº†å§ï¼Œæ–°å‹çš„redis, nginxéƒ½æ˜¯äº‹ä»¶é©±åŠ¨epollæ¥å®ç°çš„ï¼›<br>é‡‡ç”¨whileå¾ªç¯æ˜¯ä¸ºäº†å›æ”¶æ‰€æœ‰å·²é€€å‡ºå­è¿›ç¨‹çš„çŠ¶æ€ã€‚<br>","like_count":11,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470154,"discussion_content":"æˆ‘çŸ¥é“æœ‰apacheæœåŠ¡å™¨ï¼Œå…¶ä»–çš„å¤§å®¶å¯ä»¥è¡¥å……ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571450948,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2184325,"avatar":"https://static001.geekbang.org/account/avatar/00/21/54/85/ab5148ce.jpg","nickname":"duckman","note":"","ucode":"0184C26C4B6C1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":338056,"discussion_content":"å¾ˆä¹…ä¹‹å‰çš„apache + cgiçš„å½¢å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609162684,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1252980,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1e/74/636ea0f3.jpg","nickname":"ä½ å¥½","note":"","ucode":"0B5E024BA58560","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258048,"discussion_content":"nginx ä¹Ÿä½¿ç”¨äº†å¤šä¸ªè¿›ç¨‹ï¼Œå› ä¸ºä¸€ä¸ªè¿›ç¨‹æŒ‚æ‰åä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹æ‰§è¡Œï¼Œä½†æ˜¯çº¿ç¨‹æŒ‚æ‰åæ•´ä¸ªè¿›ç¨‹å°±å´©äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588642667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138273,"user_name":"åˆ˜ä¸¹","can_delete":false,"product_type":"c1","uid":1081922,"ip_address":"","ucode":"66594D1C957E15","user_header":"https://static001.geekbang.org/account/avatar/00/10/82/42/8b04d489.jpg","comment_is_top":false,"comment_ctime":1570147699,"is_pvip":false,"replies":[{"id":"54296","content":"æ˜¯æˆ‘ç–å¿½äº†ï¼Œä¸è¿‡ç³»ç»Ÿå†…æ ¸ç¡®å®å¯ä»¥å›æ”¶ï¼Œæœ€å¥½è¿˜æ˜¯è‡ªå·±closeä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570970181,"ip_address":"","comment_id":138273,"utype":1}],"discussion_count":1,"race_medal":0,"score":"48814787955","product_id":100032701,"comment_content":"è¯·é—®ä¸»è¿›ç¨‹ç»“æŸçš„æ—¶å€™æ²¡æœ‰å…³é—­listener_fdï¼Œå­è¿›ç¨‹ç»“æŸçš„æ—¶å€™æ²¡æœ‰å…³é—­fdï¼Œæ˜¯è®©æ“ä½œç³»ç»Ÿåœ¨å…³é—­è¿›ç¨‹æ—¶è‡ªåŠ¨å›æ”¶èµ„æºå—ï¼Ÿ","like_count":11,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469462,"discussion_content":"æ˜¯æˆ‘ç–å¿½äº†ï¼Œä¸è¿‡ç³»ç»Ÿå†…æ ¸ç¡®å®å¯ä»¥å›æ”¶ï¼Œæœ€å¥½è¿˜æ˜¯è‡ªå·±closeä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570970181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159431,"user_name":"Geek_sky","can_delete":false,"product_type":"c1","uid":1619199,"ip_address":"","ucode":"7F85BEB76F34A9","user_header":"https://static001.geekbang.org/account/avatar/00/18/b4/ff/125e0787.jpg","comment_is_top":false,"comment_ctime":1575621983,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44525294943","product_id":100032701,"comment_content":"ä¸€ä¸ªå‘å‡ºè€Œæ²¡æœ‰è¢«æ¥æ”¶çš„ä¿¡å·å«åšå¾…å¤„ç†ä¿¡å·ï¼ˆpending signalï¼‰ã€‚åœ¨ä»»ä½•æ—¶åˆ»ï¼Œä¸€ç§ç±»å‹è‡³å¤šåªä¼šæœ‰ä¸€ä¸ªå¾…å¤„ç†ä¿¡å·ã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªç±»å‹ä¸ºkçš„å¾…å¤„ç†ä¿¡å·ï¼Œé‚£ä¹ˆä»»ä½•æ¥ä¸‹æ¥å‘é€åˆ°è¿™ä¸ªè¿›ç¨‹çš„ç±»å‹ä¸ºkçš„ä¿¡å·éƒ½ä¸ä¼šæ’é˜Ÿç­‰å¾…ï¼›å®ƒä»¬åªæ˜¯è¢«ç®€å•åœ°ä¸¢å¼ƒã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰é€‰æ‹©æ€§åœ°é˜»å¡æ¥æ”¶æŸç§ä¿¡å·ã€‚å½“ä¸€ç§ä¿¡å·è¢«é˜»å¡æ—¶ï¼Œå®ƒä»å¯ä»¥è¢«å‘é€ï¼Œä½†æ˜¯äº§ç”Ÿçš„å¾…å¤„ç†ä¿¡å·ä¸ä¼šè¢«æ¥æ”¶ï¼Œç›´åˆ°è¿›ç¨‹å–æ¶ˆå¯¹è¿™ç§ä¿¡å·çš„é˜»å¡ã€‚<br>ä¸€ä¸ªå¾…å¤„ç†ä¿¡å·æœ€å¤šåªèƒ½è¢«æ¥æ”¶ä¸€æ¬¡ã€‚å†…æ ¸ä¸ºæ¯ä¸ªè¿›ç¨‹åœ¨pendingä½å‘é‡ä¸­ç»´æŠ¤ç€å¾…å¤„ç†ä¿¡å·çš„é›†åˆï¼Œè€Œåœ¨blockedä½å‘é‡ä¸­ç»´æŠ¤ç€è¢«é˜»å¡çš„ä¿¡å·é›†åˆã€‚åªè¦ä¼ é€äº†ä¸€ä¸ªç±»å‹ä¸ºkçš„ä¿¡å·ï¼Œå†…æ ¸å°±ä¼šè®¾ç½®pendingä¸­çš„ç¬¬kä½ï¼Œè€Œåªè¦æ¥æ”¶äº†ä¸€ä¸ªç±»å‹ä¸ºkçš„ä¿¡å·ï¼Œå†…æ ¸å°±ä¼šæ¸…é™¤pendingä¸­çš„ç¬¬kä½ã€‚â€”â€”æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ","like_count":10},{"had_liked":false,"id":139712,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1570710203,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18750579387","product_id":100032701,"comment_content":"ä¸Šé¢è¯´é”™äº† ä¿¡å·ä¼šäº§ç”Ÿå¤šæ¬¡ ä¿¡å·å¤„ç†å‡½æ•°åªä¼šè°ƒç”¨ä¸€æ¬¡","like_count":5},{"had_liked":false,"id":138927,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1570509413,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14455411301","product_id":100032701,"comment_content":"1. æŒ‰è€å¸ˆè¯´çš„å»æœäº†ä¸€ä¸‹ï¼Œä¹Ÿçœ‹åˆ°è¯„è®ºåŒºå…¶ä»–åŒå­¦çš„ç•™è¨€ï¼Œå‘ç°redisçš„bgsaveä½¿ç”¨äº†forkåˆ›å»ºå­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®ã€‚<br><br>2.  ä¸ä½¿ç”¨whileå¾ªç¯ åœ¨å­è¿›ç¨‹é€€å‡ºæ—¶ï¼Œä¼šé”™è¿‡åœ¨å­è¿›ç¨‹çš„èµ„æºå›æ”¶å­","like_count":3},{"had_liked":false,"id":154881,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1574586788,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10164521380","product_id":100032701,"comment_content":"æˆ‘ç†è§£çš„è¿›ç¨‹å’Œçº¿ç¨‹<br>è¿›ç¨‹ï¼šOSçš„æœ€å°æ‰§è¡Œå•ä½<br>çº¿ç¨‹ï¼šOSçš„æœ€å°è°ƒåº¦å•ä½<br>çº¿ç¨‹åˆç§°è½»é‡çº§è¿›ç¨‹ï¼Œä»–ä»¬çš„æœ¬è´¨éƒ½æ˜¯ä¸€æ®µä»£ç æŒ‡ä»¤ï¼Œè¢«æ”¾åˆ°å†…å­˜ä¸­ç­‰å¾…æ‰§è¡Œï¼Œä¸è¿‡åŒºåˆ«åœ¨äºï¼Œè¿›ç¨‹é—´å®Œå…¨æ˜¯éš”ç¦»çš„äº’ä¸å½±å“ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹é—´æ˜¯å…±äº«å†…å­˜ç©ºé—´çš„ï¼Œå½“ç„¶çº¿ç¨‹ä¹Ÿæœ‰è‡ªå·±ç§æœ‰çš„ä¸€ä¸‹èµ„æºï¼Œæ¯”å¦‚æ ˆç©ºé—´å’ŒPCå¯„å­˜å™¨ç­‰ã€‚<br><br>é˜»å¡IO+å¤šè¿›ç¨‹çš„å®ç°å·²çŸ¥æœ‰apacheæœåŠ¡å™¨","like_count":2},{"had_liked":false,"id":239127,"user_name":"Simple life","can_delete":false,"product_type":"c1","uid":1571460,"ip_address":"","ucode":"1902D7F72FB43F","user_header":"https://static001.geekbang.org/account/avatar/00/17/fa/84/f01d203a.jpg","comment_is_top":false,"comment_ctime":1596442325,"is_pvip":false,"replies":[{"id":"89388","content":"åˆ©ç”¨äº†cpuå¤šæ ¸çš„èƒ½åŠ›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1597636307,"ip_address":"","comment_id":239127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5891409621","product_id":100032701,"comment_content":"è¿™ç§é˜»å¡è¿›ç¨‹æ¨¡å‹ä¸å•è¿›ç¨‹accept+å¤„ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä»…ä»…ä¸ºäº†ç¯å¢ƒéš”ç¦»?æ•ˆç‡ä¸Šå¹¶æ²¡æœ‰å¸¦æ¥æå‡ï¼Œè¿˜å¢åŠ äº†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ“ä½œï¼Œæ„Ÿè§‰æœ‰ç‚¹å¾—ä¸å¿å¤±","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502991,"discussion_content":"åˆ©ç”¨äº†cpuå¤šæ ¸çš„èƒ½åŠ›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597636307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138850,"user_name":"Hale","can_delete":false,"product_type":"c1","uid":1129731,"ip_address":"","ucode":"1925955343FE94","user_header":"https://static001.geekbang.org/account/avatar/00/11/3d/03/b2d9a084.jpg","comment_is_top":false,"comment_ctime":1570492629,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5865459925","product_id":100032701,"comment_content":"Nginxé‡‡ç”¨äº†è¿›åŸæ± çš„æ¨¡å¼æ¥å¤„ç†è¿æ¥ã€‚ä½¿ç”¨å¾ªç¯æ˜¯ä¸ºäº†å›æ”¶æ‰€æœ‰çš„å­è¿›ç¨‹èµ„æºï¼Œä¸€ç›´åˆ°é€€å‡ºï¼Œå¦åˆ™æ¥æ”¶å®Œä¸€ä¸ªå°±ç›´æ¥é€€å‡ºäº†ã€‚","like_count":1,"discussions":[{"author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":72933,"discussion_content":"åˆ«è¯¯å¯¼å‘€ï¼Œnginxä¸æ˜¯é‡‡ç”¨åŸºäºäº‹ä»¶çš„epollæ¨¡å‹æ¥å¤„ç†ç½‘ç»œIOçš„å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575543865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138350,"user_name":"å¼ ç«‹å","can_delete":false,"product_type":"c1","uid":1231713,"ip_address":"","ucode":"173B938DD9478A","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/61/b62d8a3b.jpg","comment_is_top":false,"comment_ctime":1570176109,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5865143405","product_id":100032701,"comment_content":"é¿å…åƒµå°¸è¿›ç¨‹ï¼Œä¸¤ç§æ–¹æ³•ï¼š1 å¿½ç•¥SIGCHLDï¼Œ 2 è°ƒç”¨waitæˆ–waitpid<br><br>åº”è¯¥è¯´ å¿½ç•¥SIGCHLDï¼Œæœ€çœäº‹å§","like_count":1,"discussions":[{"author":{"id":2123892,"avatar":"https://static001.geekbang.org/account/avatar/00/20/68/74/aea478ba.jpg","nickname":"æˆ‘æ˜¯ç®¡å°äº®","note":"","ucode":"A1C624CF9E1CA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299522,"discussion_content":"å¦‚ä½•æ¶ˆé™¤åƒµå°¸è¿›ç¨‹\n\n- å¤–éƒ¨æ¶ˆç­ï¼škillå‘é€SIGTERMæˆ–è€…SIGKILLä¿¡å·æ¶ˆç­äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„è¿›ç¨‹ï¼Œå®ƒäº§ç”Ÿçš„åƒµæ­»è¿›ç¨‹å°±å˜æˆäº†å­¤å„¿è¿›ç¨‹ï¼Œè¿™äº›å­¤å„¿è¿›ç¨‹ä¼šè¢«initè¿›ç¨‹æ¥ç®¡ï¼Œinit è¿›ç¨‹ä¼š wait()è¿™äº›å­¤å„¿è¿›ç¨‹ï¼Œé‡Šæ”¾å®ƒä»¬å ç”¨çš„ç³»ç»Ÿè¿›ç¨‹è¡¨ä¸­çš„èµ„æºã€‚\n\n- å†…éƒ¨è§£å†³ï¼šå­è¿›ç¨‹é€€å‡ºæ—¶å‘çˆ¶è¿›ç¨‹å‘é€SIGCHILDä¿¡å·ï¼Œçˆ¶è¿›ç¨‹å¤„ç†SIGCHILDä¿¡å·ã€‚åœ¨ä¿¡å·å¤„ç†å‡½æ•°ä¸­è°ƒç”¨waitè¿›è¡Œå¤„ç†åƒµå°¸è¿›ç¨‹ã€‚// fork ä¸¤æ¬¡ï¼ŒåŸç†æ˜¯å°†å­è¿›ç¨‹æˆä¸ºå­¤å„¿è¿›ç¨‹ï¼Œä»è€Œå…¶çš„çˆ¶è¿›ç¨‹å˜ä¸ºinitè¿›ç¨‹ï¼Œé€šè¿‡initè¿›ç¨‹å¯ä»¥å¤„ç†åƒµå°¸è¿›ç¨‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597721689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":72941,"discussion_content":"åœ¨ä¸ä½¿ç”¨wait/waitpidçš„æƒ…å†µä¸‹ï¼Œç›´æ¥å¿½ç•¥SIGCHLDï¼Œç»ˆæ­¢è¿›ç¨‹çš„èµ„æºè°æ¥å›æ”¶ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575544171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344677,"user_name":"èœé¸¡","can_delete":false,"product_type":"c1","uid":1683117,"ip_address":"","ucode":"A3102C3ECCA332","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLmWgscKlnjXiaBugNJ2ozMmZibAEKichZv7OfGwQX9voDicVy2qnKtlm5kWQAKZ414vFohR8FV5N9ZhA/132","comment_is_top":false,"comment_ctime":1651720602,"is_pvip":false,"replies":[{"id":"126191","content":"ä½ å¯ä»¥ä¸æ”¾è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä»”ç»†ç ”ç©¶ä¸€ä¸‹ï¼Œè¯„è®ºåŒºç­‰ä½ ......","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1652614459,"ip_address":"","comment_id":344677,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1651720602","product_id":100032701,"comment_content":"è¿™ä¸ªä»£ç æˆ‘è¿è¡Œäº†ä¸€ä¸‹ï¼Œå½“æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å…³é—­æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šå‡ºç°accept failed: Interrupted system call (4)ï¼Œç„¶åå…¶å®ƒå®¢æˆ·ç«¯å°±æ— æ³•å†è¿›è¡Œäº¤äº’äº†ï¼Œç›´åˆ°è¢«å¼ºåˆ¶å…³é—­","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572132,"discussion_content":"ä½ å¯ä»¥ä¸æ”¾è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä»”ç»†ç ”ç©¶ä¸€ä¸‹ï¼Œè¯„è®ºåŒºç­‰ä½ ......","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652614459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311263,"user_name":"Geek_842f07","can_delete":false,"product_type":"c1","uid":2698987,"ip_address":"","ucode":"ED772AF755FE7E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/WP4Ge8ABcINFkccKaNYKibicFnI0JAoojBBAUGrichNeRAgzm5RGbHG7GqYrFX3ELEzenuEbicQHJy2HZ72RxSOuMA/132","comment_is_top":false,"comment_ctime":1631149117,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631149117","product_id":100032701,"comment_content":"å¦‚æœåœ¨ä¿¡å·å¤„ç†ç¨‹åºæ‰§è¡ŒæœŸé—´æœ‰å…¶ä»–ä¸¤ä¸ªSIGCHIDä¿¡å·æ¥åˆ°ï¼Œåˆ™ä¿¡å·å¤„ç†ç¨‹åºåªä¼šå†æ‰§è¡Œä¸€æ¬¡ï¼Œå°‘å¤„ç†äº†ä¸€æ¬¡","like_count":0},{"had_liked":false,"id":246340,"user_name":"å¿†æ°´å¯’","can_delete":false,"product_type":"c1","uid":1147453,"ip_address":"","ucode":"E3F86BD8AA8903","user_header":"https://static001.geekbang.org/account/avatar/00/11/82/3d/356fc3d6.jpg","comment_is_top":false,"comment_ctime":1599285778,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599285778","product_id":100032701,"comment_content":"ç¬¬ä¸€é¢˜ï¼Œrediså’Œnginxåº•å±‚éƒ½æ˜¯åŸºäºepollå®ç°çš„ã€‚å½“ç„¶äº†ï¼Œåƒnodejs ä¹Ÿæ˜¯liveventå®ç°çš„ï¼Œåº•å±‚ä¹Ÿæ˜¯epollã€‚<br>ç¬¬äºŒé¢˜ï¼Œä½¿ç”¨å¾ªç¯çš„ç›®çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡çˆ¶è¿›ç¨‹åˆ›å»ºçš„å­è¿›ç¨‹ã€‚åé¢å­è¿›ç¨‹è¿˜ä¼šåˆ›å»ºå­è¿›ç¨‹ã€‚éœ€è¦å›æ”¶å…¨éƒ¨å­è¿›ç¨‹ã€‚<br>","like_count":0},{"had_liked":false,"id":187497,"user_name":"Richard","can_delete":false,"product_type":"c1","uid":1316758,"ip_address":"","ucode":"893F958B9DD161","user_header":"https://static001.geekbang.org/account/avatar/00/14/17/96/846fc11b.jpg","comment_is_top":false,"comment_ctime":1584147503,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584147503","product_id":100032701,"comment_content":"1. oracleçš„ä¸“ç”¨æ¨¡å¼å°±æ˜¯è¿™æ ·å®ç°çš„ï¼Œä¸€ä¸ªlistenerè¿›ç¨‹è¿›è¡Œç›‘å¬ï¼Œæ¥ä¸€ä¸ªsessionå°±åˆ›å»ºä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„pgaã€‚<br>2. å¾ˆå¤šäººéƒ½å·²ç»å›ç­”äº†ï¼Œå½“æœ‰å¤šä¸ªå­è¿›ç¨‹é€€å‡ºæ—¶ï¼Œéœ€è¦è€ƒè™‘å¤„ç†å¤šä¸ªä¿¡å·çš„æƒ…å†µã€‚<br>3. è¿™æ˜¯unpä¹¦é‡Œçš„ä¸€ä¸ªä¾‹å­ï¼Œå»ºè®®å¤§å®¶ä»”ç»†é˜…è¯»ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":181396,"user_name":"supermouse","can_delete":false,"product_type":"c1","uid":1321860,"ip_address":"","ucode":"88072D5F881827","user_header":"https://static001.geekbang.org/account/avatar/00/14/2b/84/07f0c0d6.jpg","comment_is_top":false,"comment_ctime":1582534853,"is_pvip":false,"replies":[{"id":"71038","content":"å› ä¸ºæˆ‘éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†åˆ¤æ–­ä¸€ä¸‹å›è½¦ç¬¦çš„å‡ºç°ï¼Œä½ å®Œå…¨å¯ä»¥æ”¹ä¸ºå…ˆè¯»å­—èŠ‚æµå†è§£æã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1583052863,"ip_address":"","comment_id":181396,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1582534853","product_id":100032701,"comment_content":"è¯·é—®è€å¸ˆï¼Œæ–‡ç¨¿ä¸­çš„ä»£ç child_runå‡½æ•°é‡Œé¢çš„recvæ˜¯ä¸€æ¬¡åªæ¥æ”¶ä¸€ä¸ªå­—ç¬¦å—ï¼Ÿä¸ºä»€ä¹ˆä¸ä¸€æ¬¡æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484989,"discussion_content":"å› ä¸ºæˆ‘éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†åˆ¤æ–­ä¸€ä¸‹å›è½¦ç¬¦çš„å‡ºç°ï¼Œä½ å®Œå…¨å¯ä»¥æ”¹ä¸ºå…ˆè¯»å­—èŠ‚æµå†è§£æã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583052863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138401,"user_name":"é”¦","can_delete":false,"product_type":"c1","uid":1468298,"ip_address":"","ucode":"CB0EB4B68C468B","user_header":"https://static001.geekbang.org/account/avatar/00/16/67/8a/babd74dc.jpg","comment_is_top":false,"comment_ctime":1570197907,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1570197907","product_id":100032701,"comment_content":"æˆ‘çŸ¥é“çš„ä½¿ç”¨å¤šè¿›ç¨‹æ¨¡å‹æœ‰Nginx,Redisï¼Œä¸è¿‡Redisæ˜¯ç”¨Reactoräº‹ä»¶é©±åŠ¨æ¨¡å‹æ¥å®ç°çš„","like_count":0,"discussions":[{"author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":72938,"discussion_content":"nginxçš„å¤šè¿›ç¨‹ï¼Œåªæ˜¯ä¸ºäº†å……åˆ†åˆ©ç”¨CPUå¤šæ ¸ç‰¹æ€§ï¼Œå’Œè€å¸ˆè¯´çš„ä¸€æ¡è¿æ¥å¯¹åº”ä¸€ä¸ªå¤„ç†è¿›ç¨‹ä¸æ˜¯ä¸€å›äº‹å§ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1575544071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1074310,"avatar":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","nickname":"å¤šè¥„ä¸¸","note":"","ucode":"1AA1497C5A293C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25269,"discussion_content":"redis æ˜¯ä½¿ç”¨ çˆ¶å­è¿›ç¨‹ + é˜»å¡å¼IO çš„æ¨¡å‹å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570494638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1184919,"avatar":"https://static001.geekbang.org/account/avatar/00/12/14/97/8a3aa317.jpg","nickname":"ç–¾é£çŸ¥åŠ²è‰","note":"","ucode":"B6E73CA240AA29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1074310,"avatar":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","nickname":"å¤šè¥„ä¸¸","note":"","ucode":"1AA1497C5A293C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":55692,"discussion_content":"ä¸æ˜¯ï¼Œredisæ˜¯å•çº¿ç¨‹ç¨‹åºåŠ å¤šè·¯å¤ç”¨åšæ•°æ®å­˜å–ï¼Œbgsaveæ‰ä¼šforkä¸€ä¸ªå­è¿›ç¨‹æ¥åšå¤‡ä»½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574389534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":25269,"ip_address":""},"score":55692,"extra":""}]}]},{"had_liked":false,"id":138338,"user_name":"ææ€ªè€…ğŸ˜˜ ğŸ˜’ ğŸ˜ ğŸ‘¿","can_delete":false,"product_type":"c1","uid":1300678,"ip_address":"","ucode":"40DFF5D3E3B24C","user_header":"https://static001.geekbang.org/account/avatar/00/13/d8/c6/2b2a58cf.jpg","comment_is_top":false,"comment_ctime":1570171032,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1570171032","product_id":100032701,"comment_content":"Nginxå’Œphpâ€“fpmå°±æ˜¯è¿™æ ·çš„æ¶æ„ã€‚<br><br>ä¸€ä¸ªwaitä¸è¶³å¤Ÿé˜»æ­¢åƒµå°¸è¿›ç¨‹ï¼Œå¦‚æœnä¸ªå­è¿›ç¨‹åŒæ—¶åœæ­¢ï¼Œé‚£ä¹ˆä¼šåŒæ—¶å‘å‡ºnä¸ªSIGCHILDä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œä½†æ˜¯ä¿¡å·å¤„ç†å‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºä¿¡å·ä¸€èˆ¬æ˜¯ä¸æ’é˜Ÿçš„ï¼Œå¤šä¸ªSIGCHILDåªä¼šå‘é€ä¸€æ¬¡ç»™çˆ¶è¿›ç¨‹ã€‚æ‰€ä»¥éœ€è¦ç”¨å¾ªç¯waitpidå¤„ç†ï¼Œè·å–æ‰€æœ‰ç»ˆæ­¢å­è¿›ç¨‹çŠ¶æ€ã€‚","like_count":0,"discussions":[{"author":{"id":1101405,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ce/5d/5297717a.jpg","nickname":"åˆè§","note":"","ucode":"06D7952CED37D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":59768,"discussion_content":"nginx æ˜¯ å­è¿›ç¨‹ epoll_wait æ¥æ”¶äº‹ä»¶åå¤„ç†è¯·æ±‚ï¼Œçˆ¶è¿›ç¨‹ä¸è´Ÿè´£ epoll_wait\nphp-fpm æ˜¯ å­è¿›ç¨‹ appect æ¥æ”¶è¿æ¥åå¤„ç†è¯·æ±‚ï¼Œçˆ¶è¿›ç¨‹ä¸è´Ÿè´£accept\n\næœ¬æ–‡è®²çš„æ˜¯ï¼Œçˆ¶è¿›ç¨‹ accept æ¥å—é“¾æ¥ï¼Œå°†è¿æ¥è½¬äº¤ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å¤„ç†è¯·æ±‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1574693821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1300678,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d8/c6/2b2a58cf.jpg","nickname":"ææ€ªè€…ğŸ˜˜ ğŸ˜’ ğŸ˜ ğŸ‘¿","note":"","ucode":"40DFF5D3E3B24C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1101405,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ce/5d/5297717a.jpg","nickname":"åˆè§","note":"","ucode":"06D7952CED37D3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":62016,"discussion_content":"æ˜¯çš„ï¼Œçˆ¶è¿›ç¨‹åœ¨è¿™é‡Œåªæ˜¯åšç®¡ç†ğŸ˜‚ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574813645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":59768,"ip_address":""},"score":62016,"extra":""}]},{"author":{"id":1101405,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ce/5d/5297717a.jpg","nickname":"åˆè§","note":"","ucode":"06D7952CED37D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":59745,"discussion_content":"å¾ˆé—æ†¾ï¼Œnginx å’Œ php-fpm éƒ½ä¸æ˜¯è¿™ç§æ¶æ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574693610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}