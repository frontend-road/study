{"id":212374,"title":"31 | åŠ é¤1ï¼šå¸¦ä½ åƒé€è¯¾ç¨‹ä¸­Java 8çš„é‚£äº›é‡è¦çŸ¥è¯†ç‚¹ï¼ˆä¸€ï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚</p><p>Java 8æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„JDKç‰ˆæœ¬ï¼Œåœ¨å¢å¼ºä»£ç å¯è¯»æ€§ã€ç®€åŒ–ä»£ç æ–¹é¢ï¼Œç›¸æ¯”Java 7å¢åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚Lambdaã€Streamæµæ“ä½œã€å¹¶è¡Œæµï¼ˆParallelStreamï¼‰ã€Optionalå¯ç©ºç±»å‹ã€æ–°æ—¥æœŸæ—¶é—´ç±»å‹ç­‰ã€‚</p><p>è¿™ä¸ªè¯¾ç¨‹ä¸­çš„æ‰€æœ‰æ¡ˆä¾‹ï¼Œéƒ½å……åˆ†ä½¿ç”¨äº†Java 8çš„å„ç§ç‰¹æ€§æ¥ç®€åŒ–ä»£ç ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¦‚æœä½ ä¸äº†è§£è¿™äº›ç‰¹æ€§çš„è¯ï¼Œç†è§£è¯¾ç¨‹å†…çš„Demoå¯èƒ½ä¼šæœ‰äº›å›°éš¾ã€‚å› æ­¤ï¼Œæˆ‘å°†è¿™äº›ç‰¹æ€§ï¼Œå•ç‹¬æ‹äº†å‡ºæ¥ç»„æˆäº†ä¸¤ç¯‡åŠ é¤ã€‚ç”±äºåé¢æœ‰å•ç‹¬ä¸€èŠ‚è¯¾å»è®²Java 8çš„æ—¥æœŸæ—¶é—´ç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><h2>å¦‚ä½•åœ¨é¡¹ç›®ä¸­ç”¨ä¸ŠLambdaè¡¨è¾¾å¼å’ŒStreamæ“ä½œï¼Ÿ</h2><p>Java 8çš„ç‰¹æ€§æœ‰å¾ˆå¤šï¼Œé™¤äº†è¿™ä¸¤ç¯‡åŠ é¤å¤–ï¼Œæˆ‘å†ç»™ä½ æ¨èä¸€æœ¬å…¨é¢ä»‹ç»Java 8çš„ä¹¦ï¼Œå«ã€ŠJavaå®æˆ˜ï¼ˆç¬¬äºŒç‰ˆï¼‰ã€‹ã€‚æ­¤å¤–ï¼Œæœ‰åŒå­¦åœ¨ç•™è¨€åŒºé—®ï¼Œæ€ä¹ˆæŠŠLambdaè¡¨è¾¾å¼å’ŒStreamæ“ä½œè¿ç”¨åˆ°é¡¹ç›®ä¸­ã€‚å…¶å®ï¼Œä¸šåŠ¡ä»£ç ä¸­å¯ä»¥ä½¿ç”¨è¿™äº›ç‰¹æ€§çš„åœ°æ–¹æœ‰å¾ˆå¤šã€‚</p><p>è¿™é‡Œï¼Œä¸ºäº†å¸®åŠ©ä½ å­¦ä¹ ï¼Œå¹¶æŠŠè¿™äº›ç‰¹æ€§ç”¨åˆ°ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘æœ‰ä¸‰ä¸ªå°å»ºè®®ã€‚</p><p>ç¬¬ä¸€ï¼Œä»Listçš„æ“ä½œå¼€å§‹ï¼Œå…ˆå°è¯•æŠŠéå†Listæ¥ç­›é€‰æ•°æ®å’Œè½¬æ¢æ•°æ®çš„æ“ä½œï¼Œä½¿ç”¨Streamçš„filterå’Œmapå®ç°ï¼Œè¿™æ˜¯Streamæœ€å¸¸ç”¨ã€æœ€åŸºæœ¬çš„ä¸¤ä¸ªAPIã€‚ä½ å¯ä»¥é‡ç‚¹çœ‹çœ‹æ¥ä¸‹æ¥ä¸¤èŠ‚çš„å†…å®¹æ¥å…¥é—¨ã€‚</p><!-- [[[read_end]]] --><p>ç¬¬äºŒï¼Œä½¿ç”¨é«˜çº§çš„IDEæ¥å†™ä»£ç ï¼Œä»¥æ­¤æ‰¾åˆ°å¯ä»¥åˆ©ç”¨Java 8è¯­è¨€ç‰¹æ€§ç®€åŒ–ä»£ç çš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼Œå¯¹äºIDEAï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŒ¿åç±»å‹ä½¿ç”¨Lambdaæ›¿æ¢çš„æ£€æµ‹è§„åˆ™ï¼Œè®¾ç½®ä¸ºErrorçº§åˆ«ä¸¥é‡ç¨‹åº¦ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/67/77/6707ccf4415c2d8715ed2529cfdec877.png?wh=2098*1304\" alt=\"\"></p><p>è¿™æ ·è¿è¡ŒIDEAçš„Inspect Codeçš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨Errorçº§åˆ«çš„é”™è¯¯ä¸­çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¼•èµ·æ›´å¤šå…³æ³¨ï¼Œå¸®åŠ©æˆ‘ä»¬å»ºç«‹ä½¿ç”¨Lambdaè¡¨è¾¾å¼çš„ä¹ æƒ¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/50/e4/5062b3ef6ec57ccde0f3f4b182811be4.png?wh=3190*624\" alt=\"\"></p><p>ç¬¬ä¸‰ï¼Œå¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•æŠŠåŒ¿åç±»è½¬æ¢ä¸ºLambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥å€ŸåŠ©IDEæ¥é‡æ„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/5a/e7/5a55c4284e4b10f659b7bcf0129cbde7.png?wh=1536*396\" alt=\"\"></p><p>åè¿‡æ¥ï¼Œå¦‚æœä½ åœ¨å­¦ä¹ è¯¾ç¨‹å†…æ¡ˆä¾‹æ—¶ï¼Œå¦‚æœæ„Ÿè§‰é˜…è¯»Lambdaè¡¨è¾¾å¼å’ŒStream APIæ¯”è¾ƒåƒåŠ›ï¼ŒåŒæ ·å¯ä»¥å€ŸåŠ©IDEæŠŠJava 8çš„å†™æ³•è½¬æ¢ä¸ºä½¿ç”¨å¾ªç¯çš„å†™æ³•ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/98/8a/98828a36d6bb7b7972a647b37a64f08a.png?wh=2330*602\" alt=\"\"></p><p>æˆ–è€…æ˜¯æŠŠLambdaè¡¨è¾¾å¼æ›¿æ¢ä¸ºåŒ¿åç±»ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ee/7c/ee9401683b19e57462cb2574c285d67c.png?wh=1996*340\" alt=\"\"></p><h2>Lambdaè¡¨è¾¾å¼</h2><p>Lambdaè¡¨è¾¾å¼çš„åˆè¡·æ˜¯ï¼Œè¿›ä¸€æ­¥ç®€åŒ–åŒ¿åç±»çš„è¯­æ³•ï¼ˆä¸è¿‡å®ç°ä¸Šï¼ŒLambdaè¡¨è¾¾å¼å¹¶ä¸æ˜¯åŒ¿åç±»çš„è¯­æ³•ç³–ï¼‰ï¼Œä½¿Javaèµ°å‘å‡½æ•°å¼ç¼–ç¨‹ã€‚å¯¹äºåŒ¿åç±»ï¼Œè™½ç„¶æ²¡æœ‰ç±»åï¼Œä½†è¿˜æ˜¯è¦ç»™å‡ºæ–¹æ³•å®šä¹‰ã€‚è¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼Œåˆ†åˆ«ä½¿ç”¨åŒ¿åç±»å’ŒLambdaè¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ‰“å°å­—ç¬¦ä¸²ï¼š</p><pre><code>//åŒ¿åç±»\nnew Thread(new Runnable(){\n    @Override\n    public void run(){\n        System.out.println(&quot;hello1&quot;);\n    }\n}).start();\n//Lambdaè¡¨è¾¾å¼\nnew Thread(() -&gt; System.out.println(&quot;hello2&quot;)).start();\n</code></pre><p>é‚£ä¹ˆï¼ŒLambdaè¡¨è¾¾å¼å¦‚ä½•åŒ¹é…Javaçš„ç±»å‹ç³»ç»Ÿå‘¢ï¼Ÿ</p><p>ç­”æ¡ˆå°±æ˜¯ï¼Œå‡½æ•°å¼æ¥å£ã€‚</p><p>å‡½æ•°å¼æ¥å£æ˜¯ä¸€ç§åªæœ‰å•ä¸€æŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œä½¿ç”¨@FunctionalInterfaceæ¥æè¿°ï¼Œå¯ä»¥éšå¼åœ°è½¬æ¢æˆ Lambda è¡¨è¾¾å¼ã€‚ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¥å®ç°å‡½æ•°å¼æ¥å£ï¼Œä¸éœ€è¦æä¾›ç±»åå’Œæ–¹æ³•å®šä¹‰ï¼Œé€šè¿‡ä¸€è¡Œä»£ç æä¾›å‡½æ•°å¼æ¥å£çš„å®ä¾‹ï¼Œå°±å¯ä»¥è®©å‡½æ•°æˆä¸ºç¨‹åºä¸­çš„å¤´ç­‰å…¬æ°‘ï¼Œå¯ä»¥åƒæ™®é€šæ•°æ®ä¸€æ ·ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ªå›ºå®šçš„ç±»ä¸­çš„å›ºå®šæ–¹æ³•ã€‚</p><p>é‚£ï¼Œå‡½æ•°å¼æ¥å£åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿjava.util.functionåŒ…ä¸­å®šä¹‰äº†å„ç§å‡½æ•°å¼æ¥å£ã€‚æ¯”å¦‚ï¼Œç”¨äºæä¾›æ•°æ®çš„Supplieræ¥å£ï¼Œå°±åªæœ‰ä¸€ä¸ªgetæŠ½è±¡æ–¹æ³•ï¼Œæ²¡æœ‰ä»»ä½•å…¥å‚ã€æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼š</p><pre><code>@FunctionalInterface\npublic interface Supplier&lt;T&gt; {\n\n    /**\n     * Gets a result.\n     *\n     * @return a result\n     */\n    T get();\n}\n</code></pre><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æˆ–æ–¹æ³•å¼•ç”¨ï¼Œæ¥å¾—åˆ°Supplieræ¥å£çš„å®ä¾‹ï¼š</p><pre><code>//ä½¿ç”¨Lambdaè¡¨è¾¾å¼æä¾›Supplieræ¥å£å®ç°ï¼Œè¿”å›OKå­—ç¬¦ä¸²\nSupplier&lt;String&gt; stringSupplier = ()-&gt;&quot;OK&quot;;\n//ä½¿ç”¨æ–¹æ³•å¼•ç”¨æä¾›Supplieræ¥å£å®ç°ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²\nSupplier&lt;String&gt; supplier = String::new;\n</code></pre><p>è¿™æ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿä¸ºäº†å¸®ä½ æŒæ¡å‡½æ•°å¼æ¥å£åŠå…¶ç”¨æ³•ï¼Œæˆ‘å†ä¸¾å‡ ä¸ªä½¿ç”¨Lambdaè¡¨è¾¾å¼æˆ–æ–¹æ³•å¼•ç”¨æ¥æ„å»ºå‡½æ•°çš„ä¾‹å­ï¼š</p><pre><code>//Predicateæ¥å£æ˜¯è¾“å…¥ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚æˆ‘ä»¬é€šè¿‡andæ–¹æ³•ç»„åˆä¸¤ä¸ªPredicateæ¡ä»¶ï¼Œåˆ¤æ–­æ˜¯å¦å€¼å¤§äº0å¹¶ä¸”æ˜¯å¶æ•°\nPredicate&lt;Integer&gt; positiveNumber = i -&gt; i &gt; 0;\nPredicate&lt;Integer&gt; evenNumber = i -&gt; i % 2 == 0;\nassertTrue(positiveNumber.and(evenNumber).test(2));\n\n//Consumeræ¥å£æ˜¯æ¶ˆè´¹ä¸€ä¸ªæ•°æ®ã€‚æˆ‘ä»¬é€šè¿‡andThenæ–¹æ³•ç»„åˆè°ƒç”¨ä¸¤ä¸ªConsumerï¼Œè¾“å‡ºä¸¤è¡Œabcdefg\nConsumer&lt;String&gt; println = System.out::println;\nprintln.andThen(println).accept(&quot;abcdefg&quot;);\n\n//Functionæ¥å£æ˜¯è¾“å…¥ä¸€ä¸ªæ•°æ®ï¼Œè®¡ç®—åè¾“å‡ºä¸€ä¸ªæ•°æ®ã€‚æˆ‘ä»¬å…ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼Œç„¶åé€šè¿‡andThenç»„åˆå¦ä¸€ä¸ªFunctionå®ç°å­—ç¬¦ä¸²æ‹¼æ¥\nFunction&lt;String, String&gt; upperCase = String::toUpperCase;\nFunction&lt;String, String&gt; duplicate = s -&gt; s.concat(s);\nassertThat(upperCase.andThen(duplicate).apply(&quot;test&quot;), is(&quot;TESTTEST&quot;));\n\n//Supplieræ˜¯æä¾›ä¸€ä¸ªæ•°æ®çš„æ¥å£ã€‚è¿™é‡Œæˆ‘ä»¬å®ç°è·å–ä¸€ä¸ªéšæœºæ•°\nSupplier&lt;Integer&gt; random = ()-&gt;ThreadLocalRandom.current().nextInt();\nSystem.out.println(random.get());\n\n//BinaryOperatoræ˜¯è¾“å…¥ä¸¤ä¸ªåŒç±»å‹å‚æ•°ï¼Œè¾“å‡ºä¸€ä¸ªåŒç±»å‹å‚æ•°çš„æ¥å£ã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡æ–¹æ³•å¼•ç”¨è·å¾—ä¸€ä¸ªæ•´æ•°åŠ æ³•æ“ä½œï¼Œé€šè¿‡Lambdaè¡¨è¾¾å¼å®šä¹‰ä¸€ä¸ªå‡æ³•æ“ä½œï¼Œç„¶åä¾æ¬¡è°ƒç”¨\nBinaryOperator&lt;Integer&gt; add = Integer::sum;\nBinaryOperator&lt;Integer&gt; subtraction = (a, b) -&gt; a - b;\nassertThat(subtraction.apply(add.apply(1, 2), 3), is(0));\n</code></pre><p>Predicateã€Functionç­‰å‡½æ•°å¼æ¥å£ï¼Œè¿˜ä½¿ç”¨defaultå…³é”®å­—å®ç°äº†å‡ ä¸ªé»˜è®¤æ–¹æ³•ã€‚è¿™æ ·ä¸€æ¥ï¼Œå®ƒä»¬æ—¢å¯ä»¥æ»¡è¶³å‡½æ•°å¼æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œåˆèƒ½ä¸ºæ¥å£æä¾›é¢å¤–çš„åŠŸèƒ½ï¼š</p><pre><code>@FunctionalInterface\npublic interface Function&lt;T, R&gt; {\n    R apply(T t);\n    default &lt;V&gt; Function&lt;V, R&gt; compose(Function&lt;? super V, ? extends T&gt; before) {\n        Objects.requireNonNull(before);\n        return (V v) -&gt; apply(before.apply(v));\n    }\n    default &lt;V&gt; Function&lt;T, V&gt; andThen(Function&lt;? super R, ? extends V&gt; after) {\n        Objects.requireNonNull(after);\n        return (T t) -&gt; after.apply(apply(t));\n    }\n}\n</code></pre><p>å¾ˆæ˜æ˜¾ï¼ŒLambdaè¡¨è¾¾å¼ç»™äº†æˆ‘ä»¬å¤ç”¨ä»£ç çš„æ›´å¤šå¯èƒ½æ€§ï¼šæˆ‘ä»¬å¯ä»¥æŠŠä¸€å¤§æ®µé€»è¾‘ä¸­å˜åŒ–çš„éƒ¨åˆ†æŠ½è±¡å‡ºå‡½æ•°å¼æ¥å£ï¼Œç”±å¤–éƒ¨æ–¹æ³•æä¾›å‡½æ•°å®ç°ï¼Œé‡ç”¨æ–¹æ³•å†…çš„æ•´ä½“é€»è¾‘å¤„ç†ã€‚</p><p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£ä¹‹å‰ï¼Œå¯ä»¥å…ˆç¡®è®¤ä¸‹<a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html\">java.util.functionåŒ…</a>ä¸­çš„43ä¸ªæ ‡å‡†å‡½æ•°å¼æ¥å£æ˜¯å¦èƒ½æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½é‡ç”¨è¿™äº›æ¥å£ï¼Œå› ä¸ºä½¿ç”¨å¤§å®¶ç†Ÿæ‚‰çš„æ ‡å‡†æ¥å£å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p><h2>ä½¿ç”¨Java 8ç®€åŒ–ä»£ç </h2><p>è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä¼šé€šè¿‡å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œå¸¦ä½ æ„Ÿå—ä¸€ä¸‹ä½¿ç”¨Java 8ç®€åŒ–ä»£ç çš„ä¸‰ä¸ªé‡è¦æ–¹é¢ï¼š</p><ul>\n<li>ä½¿ç”¨Streamç®€åŒ–é›†åˆæ“ä½œï¼›</li>\n<li>ä½¿ç”¨Optionalç®€åŒ–åˆ¤ç©ºé€»è¾‘ï¼›</li>\n<li>JDK8ç»“åˆLambdaå’ŒStreamå¯¹å„ç§ç±»çš„å¢å¼ºã€‚</li>\n</ul><h3>ä½¿ç”¨Streamç®€åŒ–é›†åˆæ“ä½œ</h3><p>Lambdaè¡¨è¾¾å¼å¯ä»¥å¸®æˆ‘ä»¬ç”¨ç®€çŸ­çš„ä»£ç å®ç°æ–¹æ³•çš„å®šä¹‰ï¼Œç»™äº†æˆ‘ä»¬å¤ç”¨ä»£ç çš„æ›´å¤šå¯èƒ½æ€§ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé›†åˆçš„æŠ•å½±ã€è½¬æ¢ã€è¿‡æ»¤ç­‰æ“ä½œæŠ½è±¡æˆé€šç”¨çš„æ¥å£ï¼Œç„¶åé€šè¿‡Lambdaè¡¨è¾¾å¼ä¼ å…¥å…¶å…·ä½“å®ç°ï¼Œè¿™ä¹Ÿå°±æ˜¯Streamæ“ä½œã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚è¿™é‡Œæœ‰ä¸€æ®µ20è¡Œå·¦å³çš„ä»£ç ï¼Œå®ç°äº†å¦‚ä¸‹çš„é€»è¾‘ï¼š</p><ul>\n<li>æŠŠæ•´æ•°åˆ—è¡¨è½¬æ¢ä¸ºPoint2Dåˆ—è¡¨ï¼›</li>\n<li>éå†Point2Dåˆ—è¡¨è¿‡æ»¤å‡ºYè½´&gt;1çš„å¯¹è±¡ï¼›</li>\n<li>è®¡ç®—Point2Dç‚¹åˆ°åŸç‚¹çš„è·ç¦»ï¼›</li>\n<li>ç´¯åŠ æ‰€æœ‰è®¡ç®—å‡ºçš„è·ç¦»ï¼Œå¹¶è®¡ç®—è·ç¦»çš„å¹³å‡å€¼ã€‚</li>\n</ul><pre><code>private static double calc(List&lt;Integer&gt; ints) {\n    //ä¸´æ—¶ä¸­é—´é›†åˆ\n    List&lt;Point2D&gt; point2DList = new ArrayList&lt;&gt;();\n    for (Integer i : ints) {\n        point2DList.add(new Point2D.Double((double) i % 3, (double) i / 3));\n    }\n    //ä¸´æ—¶å˜é‡ï¼Œçº¯ç²¹æ˜¯ä¸ºäº†è·å¾—æœ€åç»“æœéœ€è¦çš„ä¸­é—´å˜é‡\n    double total = 0;\n    int count = 0;\n\n    for (Point2D point2D : point2DList) {\n        //è¿‡æ»¤\n        if (point2D.getY() &gt; 1) {\n            //ç®—è·ç¦»\n            double distance = point2D.distance(0, 0);\n            total += distance;\n            count++;\n        }\n    }\n    //æ³¨æ„countå¯èƒ½ä¸º0çš„å¯èƒ½\n    return count &gt;0 ? total / count : 0;\n}\n</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Streamé…åˆLambdaè¡¨è¾¾å¼æ¥ç®€åŒ–è¿™æ®µä»£ç ã€‚ç®€åŒ–åä¸€è¡Œä»£ç å°±å¯ä»¥å®ç°è¿™æ ·çš„é€»è¾‘ï¼Œæ›´é‡è¦çš„æ˜¯ä»£ç å¯è¯»æ€§æ›´å¼ºäº†ï¼Œé€šè¿‡æ–¹æ³•åå°±å¯ä»¥çŸ¥æ™“å¤§æ¦‚æ˜¯åœ¨åšä»€ä¹ˆäº‹æƒ…ã€‚æ¯”å¦‚ï¼š</p><ul>\n<li>mapæ–¹æ³•ä¼ å…¥çš„æ˜¯ä¸€ä¸ªFunctionï¼Œå¯ä»¥å®ç°å¯¹è±¡è½¬æ¢ï¼›</li>\n<li>filteræ–¹æ³•ä¼ å…¥ä¸€ä¸ªPredicateï¼Œå®ç°å¯¹è±¡çš„å¸ƒå°”åˆ¤æ–­ï¼Œåªä¿ç•™è¿”å›trueçš„æ•°æ®ï¼›</li>\n<li>mapToDoubleç”¨äºæŠŠå¯¹è±¡è½¬æ¢ä¸ºdoubleï¼›</li>\n<li>é€šè¿‡averageæ–¹æ³•è¿”å›ä¸€ä¸ªOptionalDoubleï¼Œä»£è¡¨å¯èƒ½åŒ…å«å€¼ä¹Ÿå¯èƒ½ä¸åŒ…å«å€¼çš„å¯ç©ºdoubleã€‚</li>\n</ul><p>ä¸‹é¢çš„ç¬¬ä¸‰è¡Œä»£ç ï¼Œå°±å®ç°äº†ä¸Šé¢æ–¹æ³•çš„æ‰€æœ‰å·¥ä½œï¼š</p><pre><code>List&lt;Integer&gt; ints = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8);\ndouble average = calc(ints);\ndouble streamResult = ints.stream()\n        .map(i -&gt; new Point2D.Double((double) i % 3, (double) i / 3))\n        .filter(point -&gt; point.getY() &gt; 1)\n        .mapToDouble(point -&gt; point.distance(0, 0))\n        .average()\n        .orElse(0);\n//å¦‚ä½•ç”¨ä¸€è¡Œä»£ç æ¥å®ç°ï¼Œæ¯”è¾ƒä¸€ä¸‹å¯è¯»æ€§\nassertThat(average, is(streamResult));\n</code></pre><p>åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šé—®äº†ï¼ŒOptionalDoubleåˆæ˜¯æ€ä¹ˆå›äº‹å„¿ï¼Ÿ</p><h3>æœ‰å…³Optionalå¯ç©ºç±»å‹</h3><p>å…¶å®ï¼Œç±»ä¼¼OptionalDoubleã€OptionalIntã€OptionalLongç­‰ï¼Œæ˜¯æœåŠ¡äºåŸºæœ¬ç±»å‹çš„å¯ç©ºå¯¹è±¡ã€‚æ­¤å¤–ï¼ŒJava8è¿˜å®šä¹‰äº†ç”¨äºå¼•ç”¨ç±»å‹çš„Optionalç±»ã€‚ä½¿ç”¨Optionalï¼Œä¸ä»…å¯ä»¥é¿å…ä½¿ç”¨Streamè¿›è¡Œçº§è”è°ƒç”¨çš„ç©ºæŒ‡é’ˆé—®é¢˜ï¼›æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæä¾›äº†ä¸€äº›å®ç”¨çš„æ–¹æ³•å¸®æˆ‘ä»¬é¿å…åˆ¤ç©ºé€»è¾‘ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Optionalæ¥é¿å…ç©ºæŒ‡é’ˆï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒçš„fluent APIç®€åŒ–å†—é•¿çš„if-elseåˆ¤ç©ºé€»è¾‘ï¼š</p><pre><code>@Test(expected = IllegalArgumentException.class)\npublic void optional() {\n    //é€šè¿‡getæ–¹æ³•è·å–Optionalä¸­çš„å®é™…å€¼\n    assertThat(Optional.of(1).get(), is(1));\n    //é€šè¿‡ofNullableæ¥åˆå§‹åŒ–ä¸€ä¸ªnullï¼Œé€šè¿‡orElseæ–¹æ³•å®ç°Optionalä¸­æ— æ•°æ®çš„æ—¶å€™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼\n    assertThat(Optional.ofNullable(null).orElse(&quot;A&quot;), is(&quot;A&quot;));\n    //OptionalDoubleæ˜¯åŸºæœ¬ç±»å‹doubleçš„Optionalå¯¹è±¡ï¼ŒisPresentåˆ¤æ–­æœ‰æ— æ•°æ®\n    assertFalse(OptionalDouble.empty().isPresent());\n    //é€šè¿‡mapæ–¹æ³•å¯ä»¥å¯¹Optionalå¯¹è±¡è¿›è¡Œçº§è”è½¬æ¢ï¼Œä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆï¼Œè½¬æ¢åè¿˜æ˜¯ä¸€ä¸ªOptional\n    assertThat(Optional.of(1).map(Math::incrementExact).get(), is(2));\n    //é€šè¿‡filterå®ç°Optionalä¸­æ•°æ®çš„è¿‡æ»¤ï¼Œå¾—åˆ°ä¸€ä¸ªOptionalï¼Œç„¶åçº§è”ä½¿ç”¨orElseæä¾›é»˜è®¤å€¼\n    assertThat(Optional.of(1).filter(integer -&gt; integer % 2 == 0).orElse(null), is(nullValue()));\n    //é€šè¿‡orElseThrowå®ç°æ— æ•°æ®æ—¶æŠ›å‡ºå¼‚å¸¸\n    Optional.empty().orElseThrow(IllegalArgumentException::new);\n}\n</code></pre><p>æˆ‘æŠŠOptionalç±»çš„å¸¸ç”¨æ–¹æ³•æ•´ç†æˆäº†ä¸€å¼ å›¾ï¼Œä½ å¯ä»¥å¯¹ç…§æ¡ˆä¾‹å†å¤ä¹ ä¸€ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/c8/52/c8a901bb16b9fca07ae0fc8bb222b252.jpg?wh=2772*2263\" alt=\"\"></p><h3>Java 8ç±»å¯¹äºå‡½æ•°å¼APIçš„å¢å¼º</h3><p>é™¤äº†Streamä¹‹å¤–ï¼ŒJava 8ä¸­æœ‰å¾ˆå¤šç±»ä¹Ÿéƒ½å®ç°äº†å‡½æ•°å¼çš„åŠŸèƒ½ã€‚</p><p>æ¯”å¦‚ï¼Œè¦é€šè¿‡HashMapå®ç°ä¸€ä¸ªç¼“å­˜çš„æ“ä½œï¼Œåœ¨Java 8ä¹‹å‰æˆ‘ä»¬å¯èƒ½ä¼šå†™å‡ºè¿™æ ·çš„getProductAndCacheæ–¹æ³•ï¼šå…ˆåˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦æœ‰å€¼ï¼›å¦‚æœæ²¡æœ‰å€¼ï¼Œå°±ä»æ•°æ®åº“æœç´¢å–å€¼ï¼›æœ€åï¼ŒæŠŠæ•°æ®åŠ å…¥ç¼“å­˜ã€‚</p><pre><code>private Map&lt;Long, Product&gt; cache = new ConcurrentHashMap&lt;&gt;();\n\nprivate Product getProductAndCache(Long id) {\n    Product product = null;\n    //Keyå­˜åœ¨ï¼Œè¿”å›Value\n    if (cache.containsKey(id)) {\n        product = cache.get(id);\n    } else {\n        //ä¸å­˜åœ¨ï¼Œåˆ™è·å–Value\n        //éœ€è¦éå†æ•°æ®æºæŸ¥è¯¢è·å¾—Product\n        for (Product p : Product.getData()) {\n            if (p.getId().equals(id)) {\n                product = p;\n                break;\n            }\n        }\n        //åŠ å…¥ConcurrentHashMap\n        if (product != null)\n            cache.put(id, product);\n    }\n    return product;\n}\n\n@Test\npublic void notcoolCache() {\n    getProductAndCache(1L);\n    getProductAndCache(100L);\n\n    System.out.println(cache);\n    assertThat(cache.size(), is(1));\n    assertTrue(cache.containsKey(1L));\n}\n</code></pre><p>è€Œåœ¨Java 8ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ConcurrentHashMapçš„computeIfAbsentæ–¹æ³•ï¼Œç”¨ä¸€è¡Œä»£ç å°±å¯ä»¥å®ç°è¿™æ ·çš„ç¹çæ“ä½œï¼š</p><pre><code>private Product getProductAndCacheCool(Long id) {\n    return cache.computeIfAbsent(id, i -&gt; //å½“Keyä¸å­˜åœ¨çš„æ—¶å€™æä¾›ä¸€ä¸ªFunctionæ¥ä»£è¡¨æ ¹æ®Keyè·å–Valueçš„è¿‡ç¨‹\n            Product.getData().stream()\n                    .filter(p -&gt; p.getId().equals(i)) //è¿‡æ»¤\n                    .findFirst() //æ‰¾ç¬¬ä¸€ä¸ªï¼Œå¾—åˆ°Optional&lt;Product&gt;\n                    .orElse(null)); //å¦‚æœæ‰¾ä¸åˆ°Productï¼Œåˆ™ä½¿ç”¨null\n}\n\n@Test\npublic void coolCache()\n{\n    getProductAndCacheCool(1L);\n    getProductAndCacheCool(100L);\n\n    System.out.println(cache);\n    assertThat(cache.size(), is(1));\n    assertTrue(cache.containsKey(1L));\n}\n</code></pre><p>computeIfAbsentæ–¹æ³•åœ¨é€»è¾‘ä¸Šç›¸å½“äºï¼š</p><pre><code>if (map.get(key) == null) {\n\tV newValue = mappingFunction.apply(key);\n\tif (newValue != null)\n\t\tmap.put(key, newValue);\n}\n</code></pre><p>åˆæ¯”å¦‚ï¼Œåˆ©ç”¨Files.walkè¿”å›ä¸€ä¸ªPathçš„æµï¼Œé€šè¿‡ä¸¤è¡Œä»£ç å°±èƒ½å®ç°é€’å½’æœç´¢+grepçš„æ“ä½œã€‚æ•´ä¸ªé€»è¾‘æ˜¯ï¼šé€’å½’æœç´¢æ–‡ä»¶å¤¹ï¼ŒæŸ¥æ‰¾æ‰€æœ‰çš„.javaæ–‡ä»¶ï¼›ç„¶åè¯»å–æ–‡ä»¶æ¯ä¸€è¡Œå†…å®¹ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…public classå…³é”®å­—ï¼›æœ€åè¾“å‡ºæ–‡ä»¶åå’Œè¿™è¡Œå†…å®¹ã€‚</p><pre><code>@Test\npublic void filesExample() throws IOException {\n    //æ— é™æ·±åº¦ï¼Œé€’å½’éå†æ–‡ä»¶å¤¹\n    try (Stream&lt;Path&gt; pathStream = Files.walk(Paths.get(&quot;.&quot;))) {\n        pathStream.filter(Files::isRegularFile) //åªæŸ¥æ™®é€šæ–‡ä»¶\n                .filter(FileSystems.getDefault().getPathMatcher(&quot;glob:**/*.java&quot;)::matches) //æœç´¢javaæºç æ–‡ä»¶\n                .flatMap(ThrowingFunction.unchecked(path -&gt;\n                        Files.readAllLines(path).stream() //è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè½¬æ¢ä¸ºStream&lt;List&gt;\n                        .filter(line -&gt; Pattern.compile(&quot;public class&quot;).matcher(line).find()) //ä½¿ç”¨æ­£åˆ™è¿‡æ»¤å¸¦æœ‰public classçš„è¡Œ\n                        .map(line -&gt; path.getFileName() + &quot; &gt;&gt; &quot; + line))) //æŠŠè¿™è¡Œæ–‡ä»¶å†…å®¹è½¬æ¢ä¸ºæ–‡ä»¶å+è¡Œ\n                .forEach(System.out::println); //æ‰“å°æ‰€æœ‰çš„è¡Œ\n    }\n}\n</code></pre><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/84/12/84349a90ef4aaf30032d0a8f64ab4512.png?wh=2238*748\" alt=\"\"></p><p>æˆ‘å†å’Œä½ åˆ†äº«ä¸€ä¸ªå°æŠ€å·§å§ã€‚å› ä¸ºFiles.readAllLinesæ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªå—æ£€å¼‚å¸¸ï¼ˆIOExceptionï¼‰ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å‡½æ•°å¼æ¥å£ï¼Œç”¨ThrowingFunctionåŒ…è£…è¿™ä¸ªæ–¹æ³•ï¼ŒæŠŠå—æ£€å¼‚å¸¸è½¬æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œè®©ä»£ç æ›´æ¸…æ™°ï¼š</p><pre><code>@FunctionalInterface\npublic interface ThrowingFunction&lt;T, R, E extends Throwable&gt; {\n    static &lt;T, R, E extends Throwable&gt; Function&lt;T, R&gt; unchecked(ThrowingFunction&lt;T, R, E&gt; f) {\n        return t -&gt; {\n            try {\n                return f.apply(t);\n            } catch (Throwable e) {\n                throw new RuntimeException(e);\n            }\n        };\n    }\n\n    R apply(T t) throws E;\n}\n</code></pre><p>å¦‚æœç”¨Java 7å®ç°ç±»ä¼¼é€»è¾‘çš„è¯ï¼Œå¤§æ¦‚éœ€è¦å‡ åè¡Œä»£ç ï¼Œä½ å¯ä»¥å°è¯•ä¸‹ã€‚</p><h2>å¹¶è¡Œæµ</h2><p>å‰é¢æˆ‘ä»¬çœ‹åˆ°çš„Streamæ“ä½œéƒ½æ˜¯ä¸²è¡ŒStreamï¼Œæ“ä½œåªæ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ­¤å¤–Java 8è¿˜æä¾›äº†å¹¶è¡Œæµçš„åŠŸèƒ½ï¼šé€šè¿‡parallelæ–¹æ³•ï¼Œä¸€é”®æŠŠStreamè½¬æ¢ä¸ºå¹¶è¡Œæ“ä½œæäº¤åˆ°çº¿ç¨‹æ± å¤„ç†ã€‚</p><p>æ¯”å¦‚ï¼Œå¦‚ä¸‹ä»£ç é€šè¿‡çº¿ç¨‹æ± æ¥å¹¶è¡Œæ¶ˆè´¹å¤„ç†1åˆ°100ï¼š</p><pre><code>IntStream.rangeClosed(1,100).parallel().forEach(i-&gt;{\n    System.out.println(LocalDateTime.now() + &quot; : &quot; + i);\n    try {\n        Thread.sleep(1000);\n    } catch (InterruptedException e) { }\n});\n</code></pre><p>å¹¶è¡Œæµä¸ç¡®ä¿æ‰§è¡Œé¡ºåºï¼Œå¹¶ä¸”å› ä¸ºæ¯æ¬¡å¤„ç†è€—æ—¶1ç§’ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°åœ¨8æ ¸æœºå™¨ä¸Šï¼Œæ•°ç»„æ˜¯æŒ‰ç…§8ä¸ªä¸€ç»„1ç§’è¾“å‡ºä¸€æ¬¡ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f1/d6/f114d98aa2530c3f7e91b06aaa4ee1d6.png?wh=670*840\" alt=\"\"></p><p>åœ¨è¿™ä¸ªè¯¾ç¨‹ä¸­ï¼Œæœ‰å¾ˆå¤šç±»ä¼¼ä½¿ç”¨threadCountä¸ªçº¿ç¨‹å¯¹æŸä¸ªæ–¹æ³•æ€»è®¡æ‰§è¡ŒtaskCountæ¬¡æ“ä½œçš„æ¡ˆä¾‹ï¼Œç”¨äºæ¼”ç¤ºå¹¶å‘æƒ…å†µä¸‹çš„å¤šçº¿ç¨‹é—®é¢˜æˆ–å¤šçº¿ç¨‹å¤„ç†æ€§èƒ½ã€‚é™¤äº†ä¼šç”¨åˆ°å¹¶è¡Œæµï¼Œæˆ‘ä»¬æœ‰æ—¶ä¹Ÿä¼šä½¿ç”¨çº¿ç¨‹æ± æˆ–ç›´æ¥ä½¿ç”¨çº¿ç¨‹è¿›è¡Œç±»ä¼¼æ“ä½œã€‚ä¸ºäº†æ–¹ä¾¿ä½ å¯¹æ¯”å„ç§å®ç°ï¼Œè¿™é‡Œæˆ‘ä¸€æ¬¡æ€§ç»™å‡ºå®ç°æ­¤ç±»æ“ä½œçš„äº”ç§æ–¹å¼ã€‚</p><p>ä¸ºäº†æµ‹è¯•è¿™äº”ç§å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªåœºæ™¯ï¼šä½¿ç”¨20ä¸ªçº¿ç¨‹ï¼ˆthreadCountï¼‰ä»¥å¹¶è¡Œæ–¹å¼æ€»è®¡æ‰§è¡Œ10000æ¬¡ï¼ˆtaskCountï¼‰æ“ä½œã€‚å› ä¸ºå•ä¸ªä»»åŠ¡å•çº¿ç¨‹æ‰§è¡Œéœ€è¦10æ¯«ç§’ï¼ˆä»»åŠ¡ä»£ç å¦‚ä¸‹ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’ååé‡æ˜¯100ä¸ªæ“ä½œï¼Œé‚£20ä¸ªçº¿ç¨‹QPSæ˜¯2000ï¼Œæ‰§è¡Œå®Œ10000æ¬¡æ“ä½œæœ€å°‘è€—æ—¶5ç§’ã€‚</p><pre><code>private void increment(AtomicInteger atomicInteger) {\n    atomicInteger.incrementAndGet();\n    try {\n        TimeUnit.MILLISECONDS.sleep(10);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre><p>ç°åœ¨æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹è¿™äº”ç§æ–¹å¼ï¼Œæ˜¯å¦éƒ½å¯ä»¥åˆ©ç”¨æ›´å¤šçš„çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œæ“ä½œã€‚</p><p>ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨çº¿ç¨‹ã€‚ç›´æ¥æŠŠä»»åŠ¡æŒ‰ç…§çº¿ç¨‹æ•°å‡åŒ€åˆ†å‰²ï¼Œåˆ†é…åˆ°ä¸åŒçš„çº¿ç¨‹æ‰§è¡Œï¼Œä½¿ç”¨CountDownLatchæ¥é˜»å¡ä¸»çº¿ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½å®Œæˆæ“ä½œã€‚è¿™ç§æ–¹å¼ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åˆ†å‰²ä»»åŠ¡ï¼š</p><pre><code>private int thread(int taskCount, int threadCount) throws InterruptedException {\n    //æ€»æ“ä½œæ¬¡æ•°è®¡æ•°å™¨\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //ä½¿ç”¨CountDownLatchæ¥ç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆ\n    CountDownLatch countDownLatch = new CountDownLatch(threadCount);\n    //ä½¿ç”¨IntStreamæŠŠæ•°å­—ç›´æ¥è½¬ä¸ºThread\n    IntStream.rangeClosed(1, threadCount).mapToObj(i -&gt; new Thread(() -&gt; {\n        //æ‰‹åŠ¨æŠŠtaskCountåˆ†æˆtaskCountä»½ï¼Œæ¯ä¸€ä»½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ\n        IntStream.rangeClosed(1, taskCount / threadCount).forEach(j -&gt; increment(atomicInteger));\n        //æ¯ä¸€ä¸ªçº¿ç¨‹å¤„ç†å®Œæˆè‡ªå·±é‚£éƒ¨åˆ†æ•°æ®ä¹‹åï¼ŒcountDownä¸€æ¬¡\n        countDownLatch.countDown();\n    })).forEach(Thread::start);\n    //ç­‰åˆ°æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆ\n    countDownLatch.await();\n    //æŸ¥è¯¢è®¡æ•°å™¨å½“å‰å€¼\n    return atomicInteger.get();\n}\n</code></pre><p>ç¬¬äºŒç§æ–¹å¼æ˜¯ï¼Œä½¿ç”¨Executors.newFixedThreadPoolæ¥è·å¾—å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼Œä½¿ç”¨executeæäº¤æ‰€æœ‰ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ‰§è¡Œï¼Œæœ€åå…³é—­çº¿ç¨‹æ± ç­‰å¾…æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼š</p><pre><code>private int threadpool(int taskCount, int threadCount) throws InterruptedException {\n    //æ€»æ“ä½œæ¬¡æ•°è®¡æ•°å™¨\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //åˆå§‹åŒ–ä¸€ä¸ªçº¿ç¨‹æ•°é‡=threadCountçš„çº¿ç¨‹æ± \n    ExecutorService executorService = Executors.newFixedThreadPool(threadCount);\n    //æ‰€æœ‰ä»»åŠ¡ç›´æ¥æäº¤åˆ°çº¿ç¨‹æ± å¤„ç†\n    IntStream.rangeClosed(1, taskCount).forEach(i -&gt; executorService.execute(() -&gt; increment(atomicInteger)));\n    //æäº¤å…³é—­çº¿ç¨‹æ± ç”³è¯·ï¼Œç­‰å¾…ä¹‹å‰æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆ\n    executorService.shutdown();\n    executorService.awaitTermination(1, TimeUnit.HOURS);\n    //æŸ¥è¯¢è®¡æ•°å™¨å½“å‰å€¼\n    return atomicInteger.get();\n}\n</code></pre><p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯ï¼Œä½¿ç”¨ForkJoinPoolè€Œä¸æ˜¯æ™®é€šçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡ã€‚</p><p>ForkJoinPoolå’Œä¼ ç»Ÿçš„ThreadPoolExecutoråŒºåˆ«åœ¨äºï¼Œå‰è€…å¯¹äºnå¹¶è¡Œåº¦æœ‰nä¸ªç‹¬ç«‹é˜Ÿåˆ—ï¼Œåè€…æ˜¯å…±äº«é˜Ÿåˆ—ã€‚å¦‚æœæœ‰å¤§é‡æ‰§è¡Œè€—æ—¶æ¯”è¾ƒçŸ­çš„ä»»åŠ¡ï¼ŒThreadPoolExecutorçš„å•é˜Ÿåˆ—å°±å¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆã€‚è¿™æ—¶ï¼Œä½¿ç”¨ForkJoinPoolæ€§èƒ½ä¼šæ›´å¥½ã€‚</p><p>å› æ­¤ï¼ŒForkJoinPoolæ›´é€‚åˆå¤§ä»»åŠ¡åˆ†å‰²æˆè®¸å¤šå°ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œçš„åœºæ™¯ï¼Œè€ŒThreadPoolExecutoré€‚åˆè®¸å¤šç‹¬ç«‹ä»»åŠ¡å¹¶å‘æ‰§è¡Œçš„åœºæ™¯ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆè‡ªå®šä¹‰ä¸€ä¸ªå…·æœ‰æŒ‡å®šå¹¶è¡Œæ•°çš„ForkJoinPoolï¼Œå†é€šè¿‡è¿™ä¸ªForkJoinPoolå¹¶è¡Œæ‰§è¡Œæ“ä½œï¼š</p><pre><code>private int forkjoin(int taskCount, int threadCount) throws InterruptedException {\n    //æ€»æ“ä½œæ¬¡æ•°è®¡æ•°å™¨\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //è‡ªå®šä¹‰ä¸€ä¸ªå¹¶è¡Œåº¦=threadCountçš„ForkJoinPool\n    ForkJoinPool forkJoinPool = new ForkJoinPool(threadCount);\n    //æ‰€æœ‰ä»»åŠ¡ç›´æ¥æäº¤åˆ°çº¿ç¨‹æ± å¤„ç†\n    forkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, taskCount).parallel().forEach(i -&gt; increment(atomicInteger)));\n    //æäº¤å…³é—­çº¿ç¨‹æ± ç”³è¯·ï¼Œç­‰å¾…ä¹‹å‰æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆ\n    forkJoinPool.shutdown();\n    forkJoinPool.awaitTermination(1, TimeUnit.HOURS);\n    //æŸ¥è¯¢è®¡æ•°å™¨å½“å‰å€¼\n    return atomicInteger.get();\n}\n</code></pre><p>ç¬¬å››ç§æ–¹å¼æ˜¯ï¼Œç›´æ¥ä½¿ç”¨å¹¶è¡Œæµï¼Œå¹¶è¡Œæµä½¿ç”¨å…¬å…±çš„ForkJoinPoolï¼Œä¹Ÿå°±æ˜¯ForkJoinPool.commonPool()ã€‚</p><p>å…¬å…±çš„ForkJoinPoolé»˜è®¤çš„å¹¶è¡Œåº¦æ˜¯CPUæ ¸å¿ƒæ•°-1ï¼ŒåŸå› æ˜¯å¯¹äºCPUç»‘å®šçš„ä»»åŠ¡åˆ†é…è¶…è¿‡CPUä¸ªæ•°çš„çº¿ç¨‹æ²¡æœ‰æ„ä¹‰ã€‚ç”±äºå¹¶è¡Œæµè¿˜ä¼šä½¿ç”¨ä¸»çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä¹Ÿä¼šå ç”¨ä¸€ä¸ªCPUæ ¸å¿ƒï¼Œæ‰€ä»¥å…¬å…±ForkJoinPoolçš„å¹¶è¡Œåº¦å³ä½¿-1ä¹Ÿèƒ½ç”¨æ»¡æ‰€æœ‰CPUæ ¸å¿ƒã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡é…ç½®å¼ºåˆ¶æŒ‡å®šï¼ˆå¢å¤§ï¼‰äº†å¹¶è¡Œæ•°ï¼Œä½†å› ä¸ºä½¿ç”¨çš„æ˜¯å…¬å…±ForkJoinPoolï¼Œæ‰€ä»¥å¯èƒ½ä¼šå­˜åœ¨å¹²æ‰°ï¼Œä½ å¯ä»¥å›é¡¾ä¸‹<a href=\"https://time.geekbang.org/column/article/210337\">ç¬¬3è®²</a>æœ‰å…³çº¿ç¨‹æ± æ··ç”¨äº§ç”Ÿçš„é—®é¢˜ï¼š</p><pre><code>private int stream(int taskCount, int threadCount) {\n    //è®¾ç½®å…¬å…±ForkJoinPoolçš„å¹¶è¡Œåº¦\nSystem.setProperty(&quot;java.util.concurrent.ForkJoinPool.common.parallelism&quot;, String.valueOf(threadCount));\n    //æ€»æ“ä½œæ¬¡æ•°è®¡æ•°å™¨\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //ç”±äºæˆ‘ä»¬è®¾ç½®äº†å…¬å…±ForkJoinPoolçš„å¹¶è¡Œåº¦ï¼Œç›´æ¥ä½¿ç”¨parallelæäº¤ä»»åŠ¡å³å¯\n    IntStream.rangeClosed(1, taskCount).parallel().forEach(i -&gt; increment(atomicInteger));\n    //æŸ¥è¯¢è®¡æ•°å™¨å½“å‰å€¼\n    return atomicInteger.get();\n}\n</code></pre><p>ç¬¬äº”ç§æ–¹å¼æ˜¯ï¼Œä½¿ç”¨CompletableFutureæ¥å®ç°ã€‚CompletableFuture.runAsyncæ–¹æ³•å¯ä»¥æŒ‡å®šä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä¸€èˆ¬ä¼šåœ¨ä½¿ç”¨CompletableFutureçš„æ—¶å€™ç”¨åˆ°ï¼š</p><pre><code>private int completableFuture(int taskCount, int threadCount) throws InterruptedException, ExecutionException {\n    //æ€»æ“ä½œæ¬¡æ•°è®¡æ•°å™¨\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //è‡ªå®šä¹‰ä¸€ä¸ªå¹¶è¡Œåº¦=threadCountçš„ForkJoinPool\n    ForkJoinPool forkJoinPool = new ForkJoinPool(threadCount);\n    //ä½¿ç”¨CompletableFuture.runAsyncé€šè¿‡æŒ‡å®šçº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œä»»åŠ¡\n    CompletableFuture.runAsync(() -&gt; IntStream.rangeClosed(1, taskCount).parallel().forEach(i -&gt; increment(atomicInteger)), forkJoinPool).get();\n    //æŸ¥è¯¢è®¡æ•°å™¨å½“å‰å€¼\n    return atomicInteger.get();\n}\n</code></pre><p>ä¸Šé¢è¿™äº”ç§æ–¹æ³•éƒ½å¯ä»¥å®ç°ç±»ä¼¼çš„æ•ˆæœï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/77/cc/77c42149013fd82c18d39b5e0d0292cc.png?wh=1048*402\" alt=\"\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™5ç§æ–¹å¼æ‰§è¡Œå®Œ10000ä¸ªä»»åŠ¡çš„è€—æ—¶éƒ½åœ¨5.4ç§’åˆ°6ç§’ä¹‹é—´ã€‚è¿™é‡Œçš„ç»“æœåªæ˜¯è¯æ˜å¹¶è¡Œåº¦çš„è®¾ç½®æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸æ˜¯æ€§èƒ½æ¯”è¾ƒã€‚</p><p>å¦‚æœä½ çš„ç¨‹åºå¯¹æ€§èƒ½è¦æ±‚ç‰¹åˆ«æ•æ„Ÿï¼Œå»ºè®®é€šè¿‡æ€§èƒ½æµ‹è¯•æ ¹æ®åœºæ™¯å†³å®šé€‚åˆçš„æ¨¡å¼ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä½¿ç”¨çº¿ç¨‹æ± ï¼ˆç¬¬äºŒç§ï¼‰å’Œç›´æ¥ä½¿ç”¨å¹¶è¡Œæµï¼ˆç¬¬å››ç§ï¼‰çš„æ–¹å¼åœ¨ä¸šåŠ¡ä»£ç ä¸­æ¯”è¾ƒå¸¸ç”¨ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡ç”¨çº¿ç¨‹æ± ï¼Œè€Œä¸ä¼šåƒDemoä¸­é‚£æ ·åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ç›´æ¥å£°æ˜æ–°çš„çº¿ç¨‹æ± ï¼Œç­‰æ“ä½œå®Œæˆåå†å…³é—­ã€‚</p><p><strong>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä¸€å®šæ˜¯å…ˆè¿è¡Œstreamæ–¹æ³•å†è¿è¡Œforkjoinæ–¹æ³•ï¼Œå¯¹å…¬å…±ForkJoinPoolé»˜è®¤å¹¶è¡Œåº¦çš„ä¿®æ”¹æ‰èƒ½ç”Ÿæ•ˆã€‚</strong></p><p>è¿™æ˜¯å› ä¸ºForkJoinPoolç±»åˆå§‹åŒ–å…¬å…±çº¿ç¨‹æ± æ˜¯åœ¨é™æ€ä»£ç å—é‡Œï¼ŒåŠ è½½ç±»æ—¶å°±ä¼šè¿›è¡Œçš„ï¼Œå¦‚æœforkjoinæ–¹æ³•ä¸­å…ˆä½¿ç”¨äº†ForkJoinPoolï¼Œå³ä¾¿streamæ–¹æ³•ä¸­è®¾ç½®äº†ç³»ç»Ÿå±æ€§ä¹Ÿä¸ä¼šèµ·ä½œç”¨ã€‚å› æ­¤æˆ‘çš„å»ºè®®æ˜¯ï¼Œè®¾ç½®ForkJoinPoolå…¬å…±çº¿ç¨‹æ± é»˜è®¤å¹¶è¡Œåº¦çš„æ“ä½œï¼Œåº”è¯¥æ”¾åœ¨åº”ç”¨å¯åŠ¨æ—¶è®¾ç½®ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ ç®€å•ä»‹ç»äº†Java 8ä¸­æœ€é‡è¦çš„å‡ ä¸ªåŠŸèƒ½ï¼ŒåŒ…æ‹¬Lambdaè¡¨è¾¾å¼ã€Streamæµå¼æ“ä½œã€Optionalå¯ç©ºå¯¹è±¡ã€å¹¶è¡Œæµæ“ä½œã€‚è¿™äº›ç‰¹æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å†™å‡ºç®€å•æ˜“æ‡‚ã€å¯è¯»æ€§æ›´å¼ºçš„ä»£ç ã€‚ç‰¹åˆ«æ˜¯ä½¿ç”¨Streamçš„é“¾å¼æ–¹æ³•ï¼Œå¯ä»¥ç”¨ä¸€è¡Œä»£ç å®Œæˆä¹‹å‰å‡ åè¡Œä»£ç çš„å·¥ä½œã€‚</p><p>å› ä¸ºStreamçš„APIéå¸¸å¤šï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿæ˜¯åƒå˜ä¸‡åŒ–ï¼Œå› æ­¤æˆ‘ä¼šåœ¨ä¸‹ä¸€è®²å’Œä½ è¯¦ç»†ä»‹ç»Stream APIçš„ä¸€äº›ä½¿ç”¨ç»†èŠ‚ã€‚</p><p>ä»Šå¤©ç”¨åˆ°çš„ä»£ç ï¼Œæˆ‘éƒ½æ”¾åœ¨äº†GitHubä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»<a href=\"https://github.com/JosephZhu1983/java-common-mistakes\">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>æ£€æŸ¥ä¸‹ä»£ç ä¸­æ˜¯å¦æœ‰ä½¿ç”¨åŒ¿åç±»ï¼Œä»¥åŠé€šè¿‡éå†Listè¿›è¡Œæ•°æ®è¿‡æ»¤ã€è½¬æ¢å’Œèšåˆçš„ä»£ç ï¼Œçœ‹çœ‹èƒ½å¦ä½¿ç”¨Lambdaè¡¨è¾¾å¼å’ŒStreamæ¥é‡æ–°å®ç°å‘¢ï¼Ÿ</li>\n<li>å¯¹äºå¹¶è¡Œæµéƒ¨åˆ†çš„å¹¶è¡Œæ¶ˆè´¹å¤„ç†1åˆ°100çš„ä¾‹å­ï¼Œå¦‚æœæŠŠforEachæ›¿æ¢ä¸ºforEachOrderedï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</li>\n</ol><p>å…³äºJava 8ï¼Œä½ è¿˜æœ‰ä»€ä¹ˆä½¿ç”¨å¿ƒå¾—å—ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","comments":[{"had_liked":false,"id":188796,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":true,"comment_ctime":1584416607,"is_pvip":true,"replies":[{"id":"72822","content":"lambdaä¸æ™®é€šçš„åŒ¿åå†…éƒ¨ç±»çš„å®ç°æ–¹å¼ä¸ä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒä¸€äº›èµ„æ–™ï¼Œæ¯”å¦‚https:&#47;&#47;colobu.com&#47;2014&#47;11&#47;06&#47;secrets-of-java-8-lambda&#47;<br>è¿™ç¯‡æ€»ç»“çš„å¾ˆå¥½ï¼š<br><br>ç¼–è¯‘æ—¶ï¼š<br>- Lambda è¡¨è¾¾å¼ä¼šç”Ÿæˆä¸€ä¸ªæ–¹æ³•ï¼Œ æ–¹æ³•å®ç°äº†è¡¨è¾¾å¼çš„ä»£ç é€»è¾‘<br>- ç”ŸæˆinvokedynamicæŒ‡ä»¤ï¼Œ è°ƒç”¨bootstrapæ–¹æ³•ï¼Œ ç”±java.lang.invoke.LambdaMetafactory.metafactoryæ–¹æ³•å®ç°<br>è¿è¡Œæ—¶ï¼š<br>- invokedynamicæŒ‡ä»¤è°ƒç”¨metafactoryæ–¹æ³•ã€‚ å®ƒä¼šè¿”å›ä¸€ä¸ªCallSite, æ­¤CallSiteè¿”å›ç›®æ ‡ç±»å‹çš„ä¸€ä¸ªåŒ¿åå®ç°ç±»ï¼Œ æ­¤ç±»å…³è”ç¼–è¯‘æ—¶äº§ç”Ÿçš„æ–¹æ³•<br>- lambdaè¡¨è¾¾å¼è°ƒç”¨æ—¶ä¼šè°ƒç”¨åŒ¿åå®ç°ç±»å…³è”çš„æ–¹æ³•ã€‚<br><br>forEachOrderedä¼šè®©æ•´ä¸ªéå†è¿‡ç¨‹å¤±å»å¹¶è¡ŒåŒ–çš„æ•ˆèƒ½ï¼Œå¯ä»¥å‚è€ƒä»£ç ä¸­çš„ForEachOrderedTest","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584419542,"ip_address":"","comment_id":188796,"utype":1}],"discussion_count":3,"race_medal":0,"score":"9.2233721114535997e+18","product_id":100047701,"comment_content":"ç–‘é—®ï¼šåŒ¿åå†…éƒ¨ç±»å’ŒLambdaåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸ºä»€ä¹ˆåŒ¿åå†…éƒ¨ç±»ä¼šç”Ÿæˆ$1è¿™æ ·çš„classæ–‡ä»¶è€ŒLambdaå¹¶æ²¡æœ‰ï¼Ÿï¼Ÿï¼Ÿ<br>å›ç­”ä¸‹é—®é¢˜ï¼š<br>1.é¡¹ç›®ä¸­ç°åœ¨åŸºæœ¬éƒ½æ˜¯åœ¨ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œä¸»è¦æ˜¯å› ä¸ºä½¿ç”¨çš„vert.xå’ŒRxJava2ï¼Œå“åº”å¼å˜æˆåŸºæœ¬éƒ½æ˜¯Lambdaï¼›<br>2.å¹¶è¡Œæ•ˆæœæ¶ˆå¤±ï¼Œå’Œå»æ‰parallel()çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºforEachOrderedå°†æŒ‰ç…§å…¶æºæŒ‡å®šçš„é¡ºåºå¤„ç†æµçš„å…ƒç´ ï¼Œè€Œä¸ç®¡æµæ˜¯è¿ç»­çš„è¿˜æ˜¯å¹¶è¡Œçš„ã€‚<br><br>JavaDocï¼š<br>forEach:The behavior of this operation is explicitly nondeterministic. For parallel stream pipelines, this operation does not guarantee to respect the encounter order of the stream, as doing so would sacrifice the benefit of parallelism.<br>-------è°·æ­Œç¿»è¯‘------<br>æ­¤æ“ä½œçš„è¡Œä¸ºæ˜ç¡®åœ°æ˜¯ä¸ç¡®å®šçš„ã€‚ å¯¹äºå¹¶è¡Œæµç®¡é“ï¼Œæ­¤æ“ä½œä¸èƒ½ä¿è¯å°Šé‡æµçš„é‡åˆ°é¡ºåºï¼Œå› ä¸ºè¿™æ ·åšä¼šç‰ºç‰²å¹¶è¡Œæ€§çš„å¥½å¤„ã€‚ å¯¹äºä»»ä½•ç»™å®šçš„å…ƒç´ ï¼Œå¯ä»¥åœ¨åº“é€‰æ‹©çš„ä»»ä½•æ—¶é—´å’Œçº¿ç¨‹ä¸­æ‰§è¡Œæ“ä½œã€‚ å¦‚æœæ“ä½œè®¿é—®å…±äº«çŠ¶æ€ï¼Œåˆ™å®ƒè´Ÿè´£æä¾›æ‰€éœ€çš„åŒæ­¥ã€‚<br><br>forEachOrdered :Performs an action for each element of this stream, in the encounter order of the stream if the stream has a defined encounter order.<br>-------è°·æ­Œç¿»è¯‘-----<br>å¦‚æœæµå…·æœ‰å®šä¹‰çš„é‡åˆ°é¡ºåºï¼Œåˆ™æŒ‰æµçš„é‡åˆ°é¡ºåºå¯¹æ­¤æµçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œã€‚","like_count":18,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487531,"discussion_content":"lambdaä¸æ™®é€šçš„åŒ¿åå†…éƒ¨ç±»çš„å®ç°æ–¹å¼ä¸ä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒä¸€äº›èµ„æ–™ï¼Œæ¯”å¦‚https://colobu.com/2014/11/06/secrets-of-java-8-lambda/\nè¿™ç¯‡æ€»ç»“çš„å¾ˆå¥½ï¼š\n\nç¼–è¯‘æ—¶ï¼š\n- Lambda è¡¨è¾¾å¼ä¼šç”Ÿæˆä¸€ä¸ªæ–¹æ³•ï¼Œ æ–¹æ³•å®ç°äº†è¡¨è¾¾å¼çš„ä»£ç é€»è¾‘\n- ç”ŸæˆinvokedynamicæŒ‡ä»¤ï¼Œ è°ƒç”¨bootstrapæ–¹æ³•ï¼Œ ç”±java.lang.invoke.LambdaMetafactory.metafactoryæ–¹æ³•å®ç°\nè¿è¡Œæ—¶ï¼š\n- invokedynamicæŒ‡ä»¤è°ƒç”¨metafactoryæ–¹æ³•ã€‚ å®ƒä¼šè¿”å›ä¸€ä¸ªCallSite, æ­¤CallSiteè¿”å›ç›®æ ‡ç±»å‹çš„ä¸€ä¸ªåŒ¿åå®ç°ç±»ï¼Œ æ­¤ç±»å…³è”ç¼–è¯‘æ—¶äº§ç”Ÿçš„æ–¹æ³•\n- lambdaè¡¨è¾¾å¼è°ƒç”¨æ—¶ä¼šè°ƒç”¨åŒ¿åå®ç°ç±»å…³è”çš„æ–¹æ³•ã€‚\n\nforEachOrderedä¼šè®©æ•´ä¸ªéå†è¿‡ç¨‹å¤±å»å¹¶è¡ŒåŒ–çš„æ•ˆèƒ½ï¼Œå¯ä»¥å‚è€ƒä»£ç ä¸­çš„ForEachOrderedTest","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584419542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206671,"discussion_content":"æŠŠè€å¸ˆçš„é“¾æ¥å’Œçœ‹äº†ä¸€äº›ä¸œè¥¿ï¼Œæ•´ç†äº†ä¸‹ï¼Œæ„Ÿå…´è¶£çš„ç«¥é‹å¯ä»¥çœ‹çœ‹ï¼Œå¤§å®¶å¤šå¤šäº¤æµ\nhttps://github.com/y645194203/geektime-java-100/blob/master/TestLambda.java","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1584426273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103456,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","nickname":"jacy","note":"","ucode":"0022A8759DDCE6","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551014,"discussion_content":"åŒ¿åå†…éƒ¨ç±»ä¼šç”Ÿæˆ$1è¿™æ ·çš„classæ–‡ä»¶è€ŒLambdaå¹¶æ²¡æœ‰ã€‚æ˜¯å¦å¯ä»¥è¿™ä¹ˆç†è§£ï¼ŒåŒ¿åå†…éƒ¨ç±»æ˜¯åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆclassæ–‡ä»¶ï¼Œè€ŒLambdaæ˜¯åœ¨è¿è¡Œè¡Œç”Ÿæˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644849416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189495,"user_name":"å°é˜³","can_delete":false,"product_type":"c1","uid":1296135,"ip_address":"","ucode":"97A162992E6A81","user_header":"https://static001.geekbang.org/account/avatar/00/13/c7/07/5798c17e.jpg","comment_is_top":true,"comment_ctime":1584522299,"is_pvip":false,"replies":[{"id":"73022","content":"çœ‹ä¸€ä¸‹ForkJoinTask.fork()æ–¹æ³•ä½ å°±æ˜ç™½ä¸ºä»€ä¹ˆèƒ½ä½¿ç”¨åˆ°è‡ªå®šä¹‰çš„ForkJoinPooläº†ï¼š<br><br>public final ForkJoinTask&lt;V&gt; fork() {<br>        Thread t;<br>        if ((t = Thread.currentThread()) instanceof ForkJoinWorkerThread)<br>            ((ForkJoinWorkerThread)t).workQueue.push(this);<br>        else<br>            ForkJoinPool.common.externalPush(this);<br>        return this;<br>    }","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584523201,"ip_address":"","comment_id":189495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720727990006e+18","product_id":100047701,"comment_content":"ç–‘é—®ï¼š ä»£ç 3 çš„æ‰§è¡Œä»£ç  ï¼ŒforkJoinPool.execute(() -&gt; IntStream.rangeClosed(1, taskCount).parallel().forEach(i -&gt; increment(atomicInteger))); æˆ‘çš„ç†è§£æ˜¯ é€šè¿‡è‡ªå®šä¹‰çš„forkJoinPoolæ¥å°†å¹¶è¡Œä»»åŠ¡æäº¤åˆ°å…¬å…±çš„forkJoinPoolå»æ‰§è¡Œï¼Œå› ä¸º paraller().forEach()æ‰§è¡Œè¿‡ç¨‹ä¸­å¹¶æ²¡æä¾›åƒä»£ç 5é‚£æ ·è®¾ç½®ç”¨æˆ·çš„forkJoinPoolï¼Œæ‚¨è¯´æ˜¯åœ¨è‡ªå®šä¹‰çš„forkJoinPoolæ‰§è¡Œincrementï¼ˆatomicIntegerï¼‰çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ","like_count":9,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487710,"discussion_content":"çœ‹ä¸€ä¸‹ForkJoinTask.fork()æ–¹æ³•ä½ å°±æ˜ç™½ä¸ºä»€ä¹ˆèƒ½ä½¿ç”¨åˆ°è‡ªå®šä¹‰çš„ForkJoinPooläº†ï¼š\n\npublic final ForkJoinTask&amp;lt;V&amp;gt; fork() {\n        Thread t;\n        if ((t = Thread.currentThread()) instanceof ForkJoinWorkerThread)\n            ((ForkJoinWorkerThread)t).workQueue.push(this);\n        else\n            ForkJoinPool.common.externalPush(this);\n        return this;\n    }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584523201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188723,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":true,"comment_ctime":1584408694,"is_pvip":false,"replies":[{"id":"72804","content":"<br>forEachOrdered ä¼šè®©parallelStreamä¸§å¤±éƒ¨åˆ†çš„å¹¶è¡Œèƒ½åŠ›ï¼Œä¸»è¦æ˜¯forEachçš„é€»è¾‘æ— æ³•å¹¶è¡Œèµ·æ¥ï¼Œæ¯”è¾ƒï¼š<br><br> private void stream() {<br>        IntStream.rangeClosed(1, 10).filter(ForEachOrderedTest::filter).forEach(ForEachOrderedTest::consume);<br>    }<br><br>    private void parallelStream() {<br>        IntStream.rangeClosed(1, 10).parallel()<br>                .filter(ForEachOrderedTest::filter)<br>                .forEach(ForEachOrderedTest::consume);<br>    }<br><br>    private void parallelStreamForEachOrdered() {<br>        IntStream.rangeClosed(1, 10).parallel()<br>                .filter(ForEachOrderedTest::filter)<br>                .forEachOrdered(ForEachOrderedTest::consume);<br>    }","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584412841,"ip_address":"","comment_id":188723,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720470291005e+18","product_id":100047701,"comment_content":"æ£€æŸ¥ä¸‹ä»£ç ä¸­æ˜¯å¦æœ‰ä½¿ç”¨åŒ¿åç±»ï¼Œä»¥åŠé€šè¿‡éå† List è¿›è¡Œæ•°æ®è¿‡æ»¤ã€è½¬æ¢å’Œèšåˆçš„ä»£ç ï¼Œçœ‹çœ‹èƒ½å¦ä½¿ç”¨ Lambda è¡¨è¾¾å¼å’Œ Stream æ¥é‡æ–°å®ç°å‘¢ï¼Ÿ<br>å·²ç»ä½¿ç”¨lambdaï¼Œstreamå¿«ä¸€å¹´äº†ï¼ŒåŒ¿åç±»ï¼ŒåŸºæœ¬å°±é€šè¿‡ideaçš„è‡ªåŠ¨å¤„ç†ï¼Œè‡ªå·±ä½¿ç”¨çš„åŸºæœ¬ä¸Šå°±ï¼šforEachï¼Œfilterï¼Œmapï¼Œè¿™äº›ã€‚<br><br><br>å¯¹äºå¹¶è¡Œæµéƒ¨åˆ†çš„å¹¶è¡Œæ¶ˆè´¹å¤„ç† 1 åˆ° 100 çš„ä¾‹å­ï¼Œå¦‚æœæŠŠ forEach æ›¿æ¢ä¸º forEachOrderedï¼Œä½ è§‰å¾—ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ<br>ä¸ªäººçŒœæµ‹æ˜¯ä¼šè¢«æœ‰åºåŒ–åœ°å¤šçº¿ç¨‹æ‰§è¡Œï¼Œå››æ ¸CPUï¼Œ1234 ç­‰ä¸€ç§’5678 è¿™æ ·ã€‚<br>ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼Œå¹¶å‘èƒ½åŠ›è¢«ç›´æ¥ç§»é™¤ã€‚1ç­‰ä¸€ç§’ï¼Œ2ç­‰ä¸€ç§’ï¼Œ3......è¿™æ ·ã€‚ä¸ä¸¥è°¨çš„çŒœæµ‹ï¼ŒforEachOrdered å°†æœ¬æ¥çš„æ‰“å°åŠ ä¸Šäº†ç±»ä¼¼äºsynchronizedçš„æ•ˆæœã€‚","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487498,"discussion_content":"\nforEachOrdered ä¼šè®©parallelStreamä¸§å¤±éƒ¨åˆ†çš„å¹¶è¡Œèƒ½åŠ›ï¼Œä¸»è¦æ˜¯forEachçš„é€»è¾‘æ— æ³•å¹¶è¡Œèµ·æ¥ï¼Œæ¯”è¾ƒï¼š\n\n private void stream() {\n        IntStream.rangeClosed(1, 10).filter(ForEachOrderedTest::filter).forEach(ForEachOrderedTest::consume);\n    }\n\n    private void parallelStream() {\n        IntStream.rangeClosed(1, 10).parallel()\n                .filter(ForEachOrderedTest::filter)\n                .forEach(ForEachOrderedTest::consume);\n    }\n\n    private void parallelStreamForEachOrdered() {\n        IntStream.rangeClosed(1, 10).parallel()\n                .filter(ForEachOrderedTest::filter)\n                .forEachOrdered(ForEachOrderedTest::consume);\n    }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584412841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189417,"user_name":"é€€è€Œç»“ç½‘","can_delete":false,"product_type":"c1","uid":1126394,"ip_address":"","ucode":"48C99264CC3A5C","user_header":"https://static001.geekbang.org/account/avatar/00/11/2f/fa/191049df.jpg","comment_is_top":false,"comment_ctime":1584513722,"is_pvip":false,"replies":[{"id":"73015","content":"åç»­åŠ é¤å¹²è´§åŒæ ·å¾ˆå¤š","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584514006,"ip_address":"","comment_id":189417,"utype":1}],"discussion_count":1,"race_medal":0,"score":"66009023162","product_id":100047701,"comment_content":"è¿™ä¸ªè¯¾ç¨‹æœªå…ä¹Ÿå¤ªåˆ’ç®—äº†ï¼Œè¿™ä¸ªåŠ é¤å›Šæ‹¬äº†å¥½å¤šå…¶ä»–çš„å†…å®¹ï¼Œç‰©è¶…æ‰€å€¼ï¼Œä¸ºè€å¸ˆç‚¹èµï¼æ‰“call","like_count":16,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487692,"discussion_content":"åç»­åŠ é¤å¹²è´§åŒæ ·å¾ˆå¤š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584514006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188991,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1584442819,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57419017667","product_id":100047701,"comment_content":"æ„Ÿè§‰è€å¸ˆæ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘åŠ é¤ä¸‹æ³›å‹ï¼Œç®€å•çš„æ²¡å•¥é—®é¢˜ï¼Œä¸€å¤§å †çš„é‚£ç§çœ‹ç€å°±å¤´ç–¼ï¼Œå°¤å…¶æ˜¯æœ‰çš„è¿˜éœ€è¦è‡ªå·±å®šä¹‰ã€‚","like_count":14},{"had_liked":false,"id":188658,"user_name":"åˆ˜å¤§æ˜","can_delete":false,"product_type":"c1","uid":1035081,"ip_address":"","ucode":"83C063FBD9BF2B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/49/0b9ffc8e.jpg","comment_is_top":false,"comment_ctime":1584401019,"is_pvip":false,"replies":[{"id":"72757","content":"å…¶å®IDEAå·²ç»å¢åŠ äº†éå¸¸æ–¹ä¾¿çš„Streamè°ƒè¯•åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒhttps:&#47;&#47;www.jetbrains.com&#47;help&#47;idea&#47;analyze-java-stream-operations.html","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584403953,"ip_address":"","comment_id":188658,"utype":1}],"discussion_count":6,"race_medal":0,"score":"40239106683","product_id":100047701,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆ,æ—¢ç„¶Lambda è¡¨è¾¾å¼è¿™ä¹ˆç®€æ´,æ–¹ä¾¿,ä½†æ˜¯æˆ‘ä»¬é¡¹ç›®ç»ç†è¦æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä¸è¦ä½¿ç”¨ä»–,è¯´æ˜¯ä¸å¥½è°ƒè¯•.......è¿™ä¸ªæ˜¯ç†ç”±å—?","like_count":10,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487477,"discussion_content":"å…¶å®IDEAå·²ç»å¢åŠ äº†éå¸¸æ–¹ä¾¿çš„Streamè°ƒè¯•åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒhttps://www.jetbrains.com/help/idea/analyze-java-stream-operations.html","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584403953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2378309,"avatar":"https://static001.geekbang.org/account/avatar/00/24/4a/45/e048531a.jpg","nickname":"è¿ªç±³ä¹Œæ ¼æ–¯","note":"","ucode":"1D4393746DCBCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376239,"discussion_content":"æˆ‘è§‰å¾—åé¢æ¥æ‰‹çš„äººå¦‚æœè¿Streaméƒ½ä¸ä¼šçš„è¯, å¯¹äºé¡¹ç›®èƒ½åŠ›çš„æŠŠå…³ä¹Ÿå ªå¿§, æˆ‘ä¸ªäººå»ºè®®è¿˜æ˜¯å»å­¦ä¸€ä¸‹, Java8å·²ç»ç®—æ˜¯å¾ˆè€çš„ç‰ˆæœ¬äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622032381,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1397298,"avatar":"https://static001.geekbang.org/account/avatar/00/15/52/32/bb570f48.jpg","nickname":"å‘å¾€çš„ç”Ÿæ´»","note":"","ucode":"0E8DB45357820F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206723,"discussion_content":"åˆ˜è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584433970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1035081,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/cb/49/0b9ffc8e.jpg","nickname":"åˆ˜å¤§æ˜","note":"","ucode":"83C063FBD9BF2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1397298,"avatar":"https://static001.geekbang.org/account/avatar/00/15/52/32/bb570f48.jpg","nickname":"å‘å¾€çš„ç”Ÿæ´»","note":"","ucode":"0E8DB45357820F","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":206796,"discussion_content":"???","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584444794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":206723,"ip_address":""},"score":206796,"extra":""}]},{"author":{"id":1076652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6d/ac/6128225f.jpg","nickname":"jjn0703","note":"","ucode":"83AF403AC7DFB7","race_medal":5,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":206398,"discussion_content":"ä¸»è¦åé¢æ¥æ‰‹çš„äºº è¦æ˜¯ä¸ä¼šè¿™ä¸ª å°±éº»çƒ¦ å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584403720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1035081,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/cb/49/0b9ffc8e.jpg","nickname":"åˆ˜å¤§æ˜","note":"","ucode":"83C063FBD9BF2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1076652,"avatar":"https://static001.geekbang.org/account/avatar/00/10/6d/ac/6128225f.jpg","nickname":"jjn0703","note":"","ucode":"83AF403AC7DFB7","race_medal":5,"user_type":1,"is_pvip":true},"discussion":{"id":206795,"discussion_content":"ä¼°è®¡æ˜¯çš„ã€‚å¦‚æœåˆ«äººä¸ä¼šè¿™ä¸ªå°±æœ‰ç‚¹éº»çƒ¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584444780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":206398,"ip_address":""},"score":206795,"extra":""}]}]},{"had_liked":false,"id":189014,"user_name":"mgs2002","can_delete":false,"product_type":"c1","uid":1812970,"ip_address":"","ucode":"F5931108BD509B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","comment_is_top":false,"comment_ctime":1584446580,"is_pvip":false,"replies":[{"id":"72910","content":"å› ä¸ºfilterè¿˜æ˜¯å¹¶è¡Œçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584448991,"ip_address":"","comment_id":189014,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14469348468","product_id":100047701,"comment_content":"forEachOrdered ä¿è¯å…ƒç´ æŒ‰é¡ºåºæ‰§è¡Œï¼Œæˆ‘æµ‹è¯•äº†ä»£ç çš„ä¾‹å­ï¼Œå‘ç°å»æ‰parallelåæ‰§è¡Œæ—¶é—´è·ŸforEachå·®ä¸å¤šï¼ŒåŠ ä¸Šåæ‰§è¡Œæ—¶é—´å¿«äº†ä¸€å€å¤šï¼Œç»“è®ºæ˜¯forEachOrderedå¹¶æ²¡æœ‰ä½¿parallelå¹¶è¡ŒåŒ–æ•ˆæœå®Œå…¨æ¶ˆå¤±ï¼Œæ˜¯è¿™æ ·çš„å—ï¼Œä¹Ÿå°è¯•çœ‹äº†ä¸€ä¸‹æºç ï¼Œæœ‰ç‚¹è’™ã€‚ã€‚<br>ä»¥ä¸‹æ˜¯æˆ‘çš„æµ‹è¯•ç»“æœ<br>246810421086246810StopWatch &#39;&#39;: running time = 23068739988 ns<br>---------------------------------------------<br>ns         %     Task name<br>---------------------------------------------<br>15051360863  065%  stream<br>2010090132  009%  parallelStream<br>6007288993  026%  parallelStreamForEachOrdered","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487588,"discussion_content":"å› ä¸ºfilterè¿˜æ˜¯å¹¶è¡Œçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584448991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189414,"user_name":"å¤§å¤´","can_delete":false,"product_type":"c1","uid":1315367,"ip_address":"","ucode":"C1FB2C8A0FB0C0","user_header":"https://static001.geekbang.org/account/avatar/00/14/12/27/32746bbf.jpg","comment_is_top":false,"comment_ctime":1584513592,"is_pvip":true,"replies":[{"id":"73014","content":"æ˜¯ï¼Œä¸ä»…ä»…æ˜¯ç®€åŒ–ï¼Œå‡½æ•°å¼çš„æ¦‚å¿µå…¶å®ä»æ›´æœ¬ä¸Šå¯ä»¥æ”¹å˜è®¾è®¡çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584513993,"ip_address":"","comment_id":189414,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10174448184","product_id":100047701,"comment_content":"ä»ä¼ é€’å¯¹è±¡ï¼Œåˆ°ä¼ é€’åŒ¿åå†…éƒ¨ç±»ï¼Œå†åˆ°lambdaè¡¨è¾¾å¼çš„æ¼”åŒ–ï¼Œå»æ‰äº†é‡å¤çš„ä»£ç ï¼Œä»…ä¿ç•™æœ‰æ„ä¹‰çš„ä»£ç ï¼Œè¶Šæ¥è¶Šç®€æ´æ˜äº†äº†","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487689,"discussion_content":"æ˜¯ï¼Œä¸ä»…ä»…æ˜¯ç®€åŒ–ï¼Œå‡½æ•°å¼çš„æ¦‚å¿µå…¶å®ä»æ›´æœ¬ä¸Šå¯ä»¥æ”¹å˜è®¾è®¡çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584513993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189008,"user_name":"hanazawakana","can_delete":false,"product_type":"c1","uid":1251721,"ip_address":"","ucode":"E0F6FACBFE7D15","user_header":"https://static001.geekbang.org/account/avatar/00/13/19/89/20488013.jpg","comment_is_top":false,"comment_ctime":1584445863,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10174380455","product_id":100047701,"comment_content":"forEachä¸ä¿è¯å¾ªç¯çš„é¡ºåºï¼ŒforEachOrderedä¿è¯å¾ªç¯çš„é¡ºåº","like_count":3},{"had_liked":false,"id":188814,"user_name":"é™ˆå¤©æŸ±","can_delete":false,"product_type":"c1","uid":1696225,"ip_address":"","ucode":"917BFDC845760D","user_header":"https://static001.geekbang.org/account/avatar/00/19/e1/e1/441df85d.jpg","comment_is_top":false,"comment_ctime":1584420493,"is_pvip":false,"replies":[{"id":"72846","content":"å¯ä»¥æ¯”è¾ƒä¸€ä¸‹æºç ä¸­çš„ForEachOrderedTest","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584423644,"ip_address":"","comment_id":188814,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10174355085","product_id":100047701,"comment_content":"æˆ‘å®é™…å¼€å‘çš„æ—¶å€™ï¼Œæœ€å–œæ¬¢ç”¨çš„lambdaè¡¨è¾¾å¼å°±æ˜¯å°†ä¸€ä¸ªé›†åˆå¯¹è±¡è½¬æ¢æˆç”±è¯¥å¯¹è±¡çš„æŒ‡å®šå­—æ®µå€¼ç»„æˆçš„é›†åˆï¼Œä»¥å‰åªä¼šç”¨ï¼Œçœ‹äº†è€å¸ˆçš„æ–‡ç« ä»¥åæ‰æ„è¯†åˆ°å­¦ä¸œè¥¿è¿˜æ˜¯éœ€è¦ç³»ç»Ÿï¼<br>å…³äºç¬¬äºŒä¸ªæ€è€ƒé¢˜ï¼Œå°è¯•å»é˜…è¯»äº†ä¸€ä¸‹æºç ï¼Œå‘ç°å®Œå…¨æ‡µé€¼äº†ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ideaè·‘äº†ä¸€ä¸‹ä»£ç å‘ç°å¹¶è¡ŒæµforEachOrderdçš„æ•ˆæœç›´æ¥æ˜¯ä¸²è¡ŒåŒ–äº†ï¼Œè™½ç„¶ä½¿ç”¨äº†å¹¶è¡Œæµï¼Œä½†éœ€è¦è®©ä»»åŠ¡æœ‰åºåŒ–ï¼Œè®©æˆ‘æƒ³èµ·äº†RocketMqé‡Œçš„é¡ºåºæ¶ˆæ¯ã€‚","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487535,"discussion_content":"å¯ä»¥æ¯”è¾ƒä¸€ä¸‹æºç ä¸­çš„ForEachOrderedTest","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584423644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188728,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1584408937,"is_pvip":false,"replies":[{"id":"72803","content":"æ²¡é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584411788,"ip_address":"","comment_id":188728,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10174343529","product_id":100047701,"comment_content":"java8çš„Lambdaï¼Œç»™ç¨‹åºå‘˜æä¾›äº†æå¤§çš„ä¾¿åˆ©æ€§ï¼Œå’Œå¤§å¹…åº¦ç®€åŒ–ä»£ç çš„å¯èƒ½æ€§ã€‚å•çº¯ä½¿ç”¨çš„è¯ï¼Œå­¦ä¹ æˆæœ¬å¹¶ä¸é«˜ã€‚å¸¸ç”¨çš„ä¸»æµçš„æ“ä½œä¹Ÿå°±é‚£ä¹ˆå‡ ä¸ªã€‚<br>ä½†æ˜¯è¦è‡ªè¡Œå®šä¹‰ï¼Œå¹¶çµæ´»å˜é€šä½¿ç”¨ï¼Œè¿˜æ˜¯éœ€è¦èŠ±äº›åŠŸå¤«å»å­¦ä¹ ç»ƒä¹ çš„ã€‚","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487499,"discussion_content":"æ²¡é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584411788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188670,"user_name":"jjn0703","can_delete":false,"product_type":"c1","uid":1076652,"ip_address":"","ucode":"83AF403AC7DFB7","user_header":"https://static001.geekbang.org/account/avatar/00/10/6d/ac/6128225f.jpg","comment_is_top":false,"comment_ctime":1584403746,"is_pvip":true,"replies":[{"id":"72759","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584404295,"ip_address":"","comment_id":188670,"utype":1}],"discussion_count":1,"race_medal":5,"score":"10174338338","product_id":100047701,"comment_content":"Java8å®æˆ˜æ˜¯å‡ºç¬¬äºŒç‰ˆäº†å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487480,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584404295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188652,"user_name":"åˆ˜å¤§æ˜","can_delete":false,"product_type":"c1","uid":1035081,"ip_address":"","ucode":"83C063FBD9BF2B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cb/49/0b9ffc8e.jpg","comment_is_top":false,"comment_ctime":1584399047,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10174333639","product_id":100047701,"comment_content":"åŠ é¤æ¥çš„ å¤ªåŠæ—¶äº†","like_count":2,"discussions":[{"author":{"id":1865356,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL3UicUedUgydoiadXuOFaOpIhOicrMbGUBEGBRkbbQibgVgRTYEIP4QFCzeicaRO8Br8icnvzic1ic1tUR8Q/132","nickname":"å´å¤‡","note":"","ucode":"47808627279AB8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297453,"discussion_content":"ä½ å­¦ä¹ äº†ï¼Œç°åœ¨è–ªèµ„å¤šå°‘å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596942248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205345,"user_name":"é‡Œå­çš„å¿§ä¼¤","can_delete":false,"product_type":"c1","uid":1587392,"ip_address":"","ucode":"CB4C529635D434","user_header":"https://static001.geekbang.org/account/avatar/00/18/38/c0/04decf07.jpg","comment_is_top":false,"comment_ctime":1586595658,"is_pvip":false,"replies":[{"id":"76709","content":"å¹¶ä¸æ˜¯Functionå˜ä¸ºäº†ThrowingFunctionï¼Œå¾€ThrowingFunction.uncheckedæ–¹æ³•ä¼ å…¥çš„æœ¬èº«å°±æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œç¬¦åˆThrowingFunctionç­¾åè€Œå·²ï¼Œè¿”å›çš„æ˜¯Function&lt;T, R&gt;ï¼Œæ‰€ä»¥æ²¡é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586603994,"ip_address":"","comment_id":205345,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5881562954","product_id":100047701,"comment_content":"å°ç™½é—®é¢˜ï¼Œå¾€flatMap(ThrowingFunction.uncheckedé‡Œä¼ çš„å‚æ•°functionæ€ä¹ˆå°±å½“åšThrowingFunctionäº†å‘¢","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491453,"discussion_content":"å¹¶ä¸æ˜¯Functionå˜ä¸ºäº†ThrowingFunctionï¼Œå¾€ThrowingFunction.uncheckedæ–¹æ³•ä¼ å…¥çš„æœ¬èº«å°±æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œç¬¦åˆThrowingFunctionç­¾åè€Œå·²ï¼Œè¿”å›çš„æ˜¯Function&amp;lt;T, R&amp;gt;ï¼Œæ‰€ä»¥æ²¡é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586603994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197828,"user_name":"æ°å“¥é•¿å¾—å¸…","can_delete":false,"product_type":"c1","uid":1241993,"ip_address":"","ucode":"5A7FD1794F62D7","user_header":"https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg","comment_is_top":false,"comment_ctime":1585399971,"is_pvip":false,"replies":[{"id":"74634","content":"å› ä¸ºFunctionçš„ç­¾åä¸æŠ›å‡ºå—æ£€å¼‚å¸¸IOExceptionçš„ï¼Œæˆ‘ä»¬åªèƒ½åœ¨flatMapä¸­è¿›è¡Œtry...catch...äº†ï¼Œè¿™æ ·å°±å¾ˆä¸ä¼˜é›…è‡ƒè‚¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è½¬æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ¥å†™å®Œæ•´ä¸ªé€»è¾‘äº†","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585401760,"ip_address":"","comment_id":197828,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880367267","product_id":100047701,"comment_content":"æƒ³é—®ä¸€ä¸‹å¤§ä½¬ï¼ŒæŠŠå—æ£€å¼‚å¸¸è½¬æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œæœ‰ä»€ä¹ˆä½œç”¨å‘¢","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489604,"discussion_content":"å› ä¸ºFunctionçš„ç­¾åä¸æŠ›å‡ºå—æ£€å¼‚å¸¸IOExceptionçš„ï¼Œæˆ‘ä»¬åªèƒ½åœ¨flatMapä¸­è¿›è¡Œtry...catch...äº†ï¼Œè¿™æ ·å°±å¾ˆä¸ä¼˜é›…è‡ƒè‚¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è½¬æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ¥å†™å®Œæ•´ä¸ªé€»è¾‘äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585401760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190208,"user_name":"ç»ˆç»“è€…999å·","can_delete":false,"product_type":"c1","uid":1055854,"ip_address":"","ucode":"33ADE61580B6DD","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/6e/6c5f5734.jpg","comment_is_top":false,"comment_ctime":1584614786,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5879582082","product_id":100047701,"comment_content":"é»˜è®¤å¹¶è¡Œæµçš„ä¸€ä¸ªå°é—®é¢˜å°±æ˜¯é»˜è®¤æ‰€æœ‰æµæ“ä½œä½¿ç”¨åŒä¸€ä¸ªCommonPollï¼Œå¯èƒ½ä¼šåœ¨æœ‰çš„æ“ä½œæ¯”è¾ƒæ…¢çš„æ—¶å€™å½±å“å…¶ä»–çš„å¹¶è¡Œæ“ä½œã€‚ã€‚","like_count":1},{"had_liked":false,"id":189980,"user_name":"Geek_3b1096","can_delete":false,"product_type":"c1","uid":1549364,"ip_address":"","ucode":"A6BD92B79B3632","user_header":"","comment_is_top":false,"comment_ctime":1584588231,"is_pvip":false,"replies":[{"id":"73138","content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«è½¬å‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584599871,"ip_address":"","comment_id":189980,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879555527","product_id":100047701,"comment_content":"æ»¡æ»¡å¹²è´§","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487845,"discussion_content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«è½¬å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584599871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188818,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1584421119,"is_pvip":false,"replies":[{"id":"72844","content":"å…¶å®è¿˜æ˜¯ä¸åŒçš„ï¼Œ3æ˜¯å®Œå…¨è‡ªå®šä¹‰ä¸€ä¸ªForkJoinPoolï¼Œ4æ˜¯ä½¿ç”¨å…¬å…±çš„ForkJoinPoolï¼Œåªä¸è¿‡è®¾ç½®äº†æ›´å¤§çš„å¹¶è¡Œåº¦ï¼Œ5æ˜¯æ¼”ç¤ºCompletableFutureå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ForkJoinPoolã€‚æœ‰å…³CompletableFutureï¼Œæºç ä¸­æˆ‘ç»™å‡ºäº†ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ä¾‹å­ï¼Œä½†æ˜¯æ–‡ç« ä¸­æ²¡æœ‰è¯´æ˜ã€‚æ—¥å¸¸å¼€å‘æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥é€‰æ‹©ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584423561,"ip_address":"","comment_id":188818,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879388415","product_id":100047701,"comment_content":"å¤§ä½¬å‰å®³ï¼<br>IntStream.rangeClosed(1, taskCount).parallel().forEach(i -&gt; increment(atomicInteger)); <br>ä¸Šé¢çš„ä»£ç 3ã€4ã€5ä¸‰ç§æ–¹æ³•ä¸­å®Œå…¨ç›¸åŒï¼Œåªä¸è¿‡æ˜¯è‡ªå·±è°ƒç”¨å’Œæ”¾è¿›çº¿ç¨‹æ± è°ƒç”¨çš„åŒºåˆ«ï¼Œæ—¢ç„¶4éƒ½èƒ½è‡ªå·±ç”¨äº†ï¼Œè¿˜è¦3ã€5å¹²å•¥å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487537,"discussion_content":"å…¶å®è¿˜æ˜¯ä¸åŒçš„ï¼Œ3æ˜¯å®Œå…¨è‡ªå®šä¹‰ä¸€ä¸ªForkJoinPoolï¼Œ4æ˜¯ä½¿ç”¨å…¬å…±çš„ForkJoinPoolï¼Œåªä¸è¿‡è®¾ç½®äº†æ›´å¤§çš„å¹¶è¡Œåº¦ï¼Œ5æ˜¯æ¼”ç¤ºCompletableFutureå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ForkJoinPoolã€‚æœ‰å…³CompletableFutureï¼Œæºç ä¸­æˆ‘ç»™å‡ºäº†ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ä¾‹å­ï¼Œä½†æ˜¯æ–‡ç« ä¸­æ²¡æœ‰è¯´æ˜ã€‚æ—¥å¸¸å¼€å‘æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥é€‰æ‹©ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584423561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302304,"user_name":"tiger54910","can_delete":false,"product_type":"c1","uid":1500686,"ip_address":"","ucode":"F4D5BE1864E097","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Qq9IlgLjo8CVKTc93AHsicwDMJq3sbN4UsubLJXUQxWKDkEblaUHYviaq8TuVWygqkubwFEAa4qLiaQF6PyrfEQDg/132","comment_is_top":false,"comment_ctime":1626161304,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626161304","product_id":100047701,"comment_content":"getProductAndCacheCoolä¸­çš„å®ç°<br>cache.computeIfAbsent(id, i -&gt; &#47;&#47;å½“Keyä¸å­˜åœ¨çš„æ—¶å€™æä¾›ä¸€ä¸ªFunctionæ¥ä»£è¡¨æ ¹æ®Keyè·å–Valueçš„è¿‡ç¨‹            Product.getData().stream()                   <br>.filter(p -&gt; p.getId().equals(i)) &#47;&#47;è¿‡æ»¤                    <br>.findFirst() &#47;&#47;æ‰¾ç¬¬ä¸€ä¸ªï¼Œå¾—åˆ°Optional&lt;Product&gt;                   <br>.orElse(null)); &#47;&#47;å¦‚æœæ‰¾ä¸åˆ°Productï¼Œåˆ™ä½¿ç”¨null<br>è¿™æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":285612,"user_name":"bigzuo","can_delete":false,"product_type":"c1","uid":1224554,"ip_address":"","ucode":"448C258D31A8A6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/RQdib68D7dsoFlYXOweiaPqLrcyn2jD6DCGnz8nc2VFmhmX0bpGTeSrVM5M9Qs7ibIInAmt5MeLcpcNja5YjyZCIg/132","comment_is_top":false,"comment_ctime":1616920144,"is_pvip":false,"replies":[{"id":"103682","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1617012625,"ip_address":"","comment_id":285612,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616920144","product_id":100047701,"comment_content":"é€šè¿‡æœç´¢æ— æ„é—´æµè§ˆåˆ°æœ±æ™”è€å¸ˆçš„è¿™ä¸ªè¯¾ç¨‹ï¼Œçœ‹äº†ä¸€ä¸‹è„‘å›¾ï¼Œå…¶ä¸­å¾ˆå¤šå‘è‡ªå·±éƒ½è¸©è¿‡ã€‚ä½œä¸ºä¸€ä¸ªå·¥ä½œäº†å…«å¹´çš„ Java å·¥ç¨‹å¸ˆï¼Œå¯¹æ–‡ç« çš„å†…å®¹æœ‰ä¸ä¸€æ ·çš„è®¤åŒæ„Ÿã€‚","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517730,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617012625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280163,"user_name":"é˜¿å·Arc","can_delete":false,"product_type":"c1","uid":1978838,"ip_address":"","ucode":"4D990D6E3152A6","user_header":"https://static001.geekbang.org/account/avatar/00/1e/31/d6/4bfaa08c.jpg","comment_is_top":false,"comment_ctime":1614100394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614100394","product_id":100047701,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸€ä¸‹ç¬¬äº”ç§æ–¹å¼CompletableFutureå®ç°çš„æ—¶å€™ï¼ŒæŠŠforkjoinpoolæ¢æˆå…¶ä»–çº¿ç¨‹æ± æ—¶éœ€è¦æ‰§è¡Œshutdownç¨‹åºæ‰ç»“æŸï¼Œforkjoinpoolå´ä¸éœ€è¦å‘¢","like_count":0},{"had_liked":false,"id":279565,"user_name":"å¤ç›®ğŸ³","can_delete":false,"product_type":"c1","uid":1101227,"ip_address":"","ucode":"4ED932E1F66F76","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/ab/1c3dc64b.jpg","comment_is_top":false,"comment_ctime":1613824666,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1613824666","product_id":100047701,"comment_content":"å¦‚ä½•å°†ä»websocketæ”¶åˆ°çš„300000é•¿åº¦çš„æ¶ˆæ¯å­˜å‚¨åˆ°Stringä¸­ï¼Ÿ","like_count":0},{"had_liked":false,"id":261757,"user_name":"crossover  of   AI","can_delete":false,"product_type":"c1","uid":2107466,"ip_address":"","ucode":"8EE3289947808F","user_header":"https://static001.geekbang.org/account/avatar/00/20/28/4a/36d07533.jpg","comment_is_top":false,"comment_ctime":1605514678,"is_pvip":false,"replies":[{"id":"95006","content":"å¤šåˆ†äº«ç»™èº«è¾¹æœ‹å‹ä»¬","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1605521621,"ip_address":"","comment_id":261757,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1605514678","product_id":100047701,"comment_content":"çœŸçš„æ˜¯å¥å¥çœŸè¨€ è€å¸ˆå¨æ­¦","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509598,"discussion_content":"å¤šåˆ†äº«ç»™èº«è¾¹æœ‹å‹ä»¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605521621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253440,"user_name":"ä¾æ—§æœ¨ç“œ","can_delete":false,"product_type":"c1","uid":1364763,"ip_address":"","ucode":"A77CD9CE9F67EB","user_header":"https://static001.geekbang.org/account/avatar/00/14/d3/1b/94a0637b.jpg","comment_is_top":false,"comment_ctime":1602740505,"is_pvip":true,"replies":[{"id":"92584","content":"æ„Ÿè°¢è®¤å¯","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1602759729,"ip_address":"","comment_id":253440,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1602740505","product_id":100047701,"comment_content":"è¿™ä¸ªè¯¾ç¨‹æ”¶è´§å¾ˆå¤§ï¼Œéƒ½æ˜¯äº›å®æˆ˜ï¼ŒçœŸçœŸæ­£æ­£å¹³æ—¶éƒ½ç”¨çš„åˆ°çš„åœ°æ–¹ã€‚æœŸå¾…è€å¸ˆèƒ½å†å‡ºä¸€äº›è¯¾ç¨‹æ™®æƒ å¤§ä¼—","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507072,"discussion_content":"æ„Ÿè°¢è®¤å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602759729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1750549,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/b6/15/e2cfd10d.jpg","nickname":"ImYoursÂ°","note":"","ucode":"51F653129034C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385205,"discussion_content":"è€å¸ˆè¿˜æœ‰å…¶ä»–çš„è¯¾ç¨‹å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626942641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":250653,"user_name":"é²é¸£","can_delete":false,"product_type":"c1","uid":2152306,"ip_address":"","ucode":"974BA3C3E64630","user_header":"https://static001.geekbang.org/account/avatar/00/20/d7/72/cbef720d.jpg","comment_is_top":false,"comment_ctime":1601187322,"is_pvip":false,"replies":[{"id":"91753","content":"è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°æ¥å£","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1601198288,"ip_address":"","comment_id":250653,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1601187322","product_id":100047701,"comment_content":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæƒ³åˆ©ç”¨ä¸‰ä¸ªå‚æ•°çš„Functionæˆ–è€…æ˜¯Consumerï¼Œä¸ºä»€ä¹ˆjdkå°±é»˜è®¤å®ç°äº†1ä¸ªå‚æ•°çš„æˆ–è€…æ˜¯2ä¸ªå‚æ•°å‘¢ï¼Œå¤šä¸ªå‚æ•°è¦æ€ä¹ˆå®ç°å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506250,"discussion_content":"è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°æ¥å£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601198288,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":224416,"user_name":"Asura","can_delete":false,"product_type":"c1","uid":2004166,"ip_address":"","ucode":"E865D7FAFCF9B1","user_header":"https://static001.geekbang.org/account/avatar/00/1e/94/c6/a7c9f304.jpg","comment_is_top":false,"comment_ctime":1591372407,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1591372407","product_id":100047701,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆ æœ‰æ—¶ç”¨mybatisplusè¿™äº›å¯¹å•è¡¨æ“ä½œçš„è¯­å¥éœ€è¦newå¯¹è±¡setå€¼å»æŸ¥è¯¢  è¿™æ ·åˆ°å¤„newå¯¹è±¡å¾ˆéš¾çœ‹  æœ‰æ—¶ç›´æ¥ç”¨åŒæ‹¬å·åˆå§‹åŒ–å»ä»£æ›¿newå¯¹è±¡äº† ä½†æ˜¯ä¼šç”ŸæˆåŒ¿åå†…éƒ¨ç±» å¯èƒ½ä¼šæœ‰å†…å­˜æ³„éœ²é£é™© å¯ä»¥ç”¨lambdaæ€ä¹ˆå»ä»£æ›¿å—","like_count":0,"discussions":[{"author":{"id":2110938,"avatar":"https://static001.geekbang.org/account/avatar/00/20/35/da/8496da45.jpg","nickname":"é‡‘ä¼Ÿæ–Œ@","note":"","ucode":"AC12BF71F3EF63","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300655,"discussion_content":"builder","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598226360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219969,"user_name":"sunshine","can_delete":false,"product_type":"c1","uid":1690477,"ip_address":"","ucode":"A95679AB21566B","user_header":"https://static001.geekbang.org/account/avatar/00/19/cb/6d/1b47c15e.jpg","comment_is_top":false,"comment_ctime":1590127330,"is_pvip":false,"replies":[{"id":"81212","content":"è¿™ä¸ªä¸æ˜¯åœ¨å³é”®ï¼Œæ˜¯åœç•™ä¸€ä¼šï¼Œå·¦ä¾§å‡ºç°æ“ä½œ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1590139846,"ip_address":"","comment_id":219969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1590127330","product_id":100047701,"comment_content":"æŠŠæµå¼è¯­è¨€å˜æˆå¾ªç¯çš„æ²¡æ‰¾åˆ°åœ¨å“ªé‡Œï¼Œå³é”®æ²¡æœ‰show context action","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496009,"discussion_content":"è¿™ä¸ªä¸æ˜¯åœ¨å³é”®ï¼Œæ˜¯åœç•™ä¸€ä¼šï¼Œå·¦ä¾§å‡ºç°æ“ä½œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590139846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":215051,"user_name":"ç©å¸†èˆ¹çš„ä¸œéƒ­å›","can_delete":false,"product_type":"c1","uid":1860772,"ip_address":"","ucode":"F2F0DE3428E105","user_header":"https://static001.geekbang.org/account/avatar/00/1c/64/a4/9523350e.jpg","comment_is_top":false,"comment_ctime":1588898084,"is_pvip":false,"replies":[{"id":"79601","content":"Javaå®æˆ˜ ç¬¬2ç‰ˆ<br>[è‹±] æ‹‰ä¹Œå°”â€“åŠ å¸ƒé‡ŒåŸƒå°”Â·ä¹Œå°”ç›ï¼Œ[æ„] é©¬é‡Œå¥¥Â·å¯Œæ–¯ç§‘ï¼Œ[è‹±] è‰¾ä¼¦Â·ç±³å…‹ç½—å¤«ç‰¹ è‘—ï¼Œé™†æ˜åˆšï¼ŒåŠ³ä½³ è¯‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1588901469,"ip_address":"","comment_id":215051,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1588898084","product_id":100047701,"comment_content":"è€å¸ˆæ¨èçš„ä¹¦çš„å…¨åå«ä»€ä¹ˆï¼ŸJavaå®æˆ˜ç¬¬äºŒç‰ˆï¼Ÿå‡ºç‰ˆç¤¾å’Œä½œè€…æ˜¯å“ªä¸ªï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":494293,"discussion_content":"Javaå®æˆ˜ ç¬¬2ç‰ˆ\n[è‹±] æ‹‰ä¹Œå°”â€“åŠ å¸ƒé‡ŒåŸƒå°”Â·ä¹Œå°”ç›ï¼Œ[æ„] é©¬é‡Œå¥¥Â·å¯Œæ–¯ç§‘ï¼Œ[è‹±] è‰¾ä¼¦Â·ç±³å…‹ç½—å¤«ç‰¹ è‘—ï¼Œé™†æ˜åˆšï¼ŒåŠ³ä½³ è¯‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588901469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214524,"user_name":"äºŒç‹—","can_delete":false,"product_type":"c1","uid":1244288,"ip_address":"","ucode":"91C38887F4F07B","user_header":"https://static001.geekbang.org/account/avatar/00/12/fc/80/21d67b9b.jpg","comment_is_top":false,"comment_ctime":1588761519,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1588761519","product_id":100047701,"comment_content":"Lambda ä¸€ç›´æ²¡å•ƒä¸‹æ¥","like_count":0},{"had_liked":false,"id":203172,"user_name":"sky","can_delete":false,"product_type":"c1","uid":1049994,"ip_address":"","ucode":"C0859057592720","user_header":"https://static001.geekbang.org/account/avatar/00/10/05/8a/e7c5a7e2.jpg","comment_is_top":false,"comment_ctime":1586148216,"is_pvip":false,"replies":[{"id":"75961","content":"Preferences | Editor | Inspections","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586174692,"ip_address":"","comment_id":203172,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1586148216","product_id":100047701,"comment_content":"è€å¸ˆï¼Œideaè®¾ç½®æ²¡æŒ‰lambdaè¯­æ³•æŠ¥é”™çš„åœ°æ–¹åœ¨å“ªï¼Œæ²¡æ‰¾åˆ°","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490787,"discussion_content":"Preferences | Editor | Inspections","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586174692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197955,"user_name":"æ°å“¥é•¿å¾—å¸…","can_delete":false,"product_type":"c1","uid":1241993,"ip_address":"","ucode":"5A7FD1794F62D7","user_header":"https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg","comment_is_top":false,"comment_ctime":1585405182,"is_pvip":false,"replies":[{"id":"74672","content":"å¥½å¤„æ˜¯æ— éœ€åœ¨Streamé“¾å†…éƒ¨æ¥å¤„ç†å¼‚å¸¸ï¼Œåœ¨å¤–éƒ¨è‚¯å®šè¦å¤„ç†çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585442966,"ip_address":"","comment_id":197955,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585405182","product_id":100047701,"comment_content":"è°¢è°¢å¤§ç¥å¯¹æˆ‘ä¸Šä¸ªé—®é¢˜çš„è§£ç­”ï¼Œä½†æˆ‘è¿˜æ˜¯æœ‰ç–‘é—®ï¼š<br>å³ä½¿æŠŠå—æ£€å¼‚å¸¸è½¬æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸äº†ï¼Œä¹Ÿè¿˜æ˜¯è¦try catchæ•è·å¤„ç†çš„å§ã€‚ä¸ç„¶å³ä½¿æ”¹æˆæŠ›å‡ºRuntimeExceptionï¼Œç¨‹åºè¿è¡Œè¿˜æ˜¯ä¼šæœ‰é—®é¢˜å•Š","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489627,"discussion_content":"å¥½å¤„æ˜¯æ— éœ€åœ¨Streamé“¾å†…éƒ¨æ¥å¤„ç†å¼‚å¸¸ï¼Œåœ¨å¤–éƒ¨è‚¯å®šè¦å¤„ç†çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585442966,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192339,"user_name":"tripcom","can_delete":false,"product_type":"c1","uid":1884804,"ip_address":"","ucode":"CE01E51FA1D2A3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLsBXIu6pibTYZLf2ic5GSZMTIibMOTKGmp1gGRTdWMWaibzIpQ6r3qQ0ath6oGRh289XQrkXj53iaib8fg/132","comment_is_top":false,"comment_ctime":1584847158,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584847158","product_id":100047701,"comment_content":"å­¦ä¹ äº†","like_count":0}]}