{"id":352577,"title":"02 | æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼šè°ƒä¼˜çš„æ‰‹æ®µäº”èŠ±å…«é—¨ï¼Œè¯¥ä»å“ªé‡Œå…¥æ‰‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬æ¢è®¨äº†æ€§èƒ½è°ƒä¼˜çš„å¿…è¦æ€§ï¼Œç»“è®ºæ˜¯ï¼šå°½ç®¡Sparkè‡ªèº«è¿è¡Œé«˜æ•ˆï¼Œä½†ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦å¯¹åº”ç”¨è¿›è¡Œæ€§èƒ½è°ƒä¼˜ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€§èƒ½è°ƒä¼˜è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿé¢å¯¹æˆç™¾ä¸Šåƒè¡Œåº”ç”¨ä»£ç ã€è¿‘ç™¾ä¸ªSparké…ç½®é¡¹ï¼Œæˆ‘ä»¬è¯¥ä»å“ªé‡Œå…¥æ‰‹å‘¢ï¼Ÿæˆ‘è®¤ä¸ºï¼Œè¦æƒ³å¼„æ¸…æ€§èƒ½è°ƒä¼˜æ€ä¹ˆå…¥æ‰‹ï¼Œå¿…é¡»å…ˆå¾—ææ˜ç™½æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨æ˜¯ä»€ä¹ˆã€‚</p><p>æ‰€ä»¥ä»Šå¤©è¿™èŠ‚è¯¾ï¼Œå’±ä»¬å°±ä»ä¸€ä¸ªå…ˆå…¥ä¸ºä¸»çš„è°ƒä¼˜åä¾‹å…¥æ‰‹ï¼Œå¸¦ä½ ä¸€èµ·æ¢è®¨å¹¶å½’çº³æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Œæœ€ç»ˆå¸®ä½ å»ºç«‹èµ·ç³»ç»ŸåŒ–çš„æ€§èƒ½è°ƒä¼˜æ–¹æ³•è®ºã€‚</p><h2>å…ˆå…¥ä¸ºä¸»çš„åä¾‹</h2><p>åœ¨å…¸å‹çš„ETLåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œå„å¼å„æ ·çš„è½¬æ¢ï¼Œæœ‰çš„æ—¶å€™ï¼Œå› ä¸ºä¸šåŠ¡éœ€æ±‚å¤ªå¤æ‚ï¼Œæˆ‘ä»¬å¾€å¾€è¿˜éœ€è¦è‡ªå®šä¹‰UDFï¼ˆUser Defined Functionsï¼‰æ¥å®ç°ç‰¹å®šçš„è½¬æ¢é€»è¾‘ã€‚ä½†æ˜¯ï¼Œæ— è®ºæ˜¯Databricksçš„å®˜æ–¹åšå®¢ï¼Œè¿˜æ˜¯ç½‘ä¸Šæµ©å¦‚çƒŸæµ·çš„SparkæŠ€æœ¯æ–‡ç« ï¼Œéƒ½è­¦å‘Šæˆ‘ä»¬å°½é‡ä¸è¦è‡ªå®šä¹‰UDFæ¥å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œè¦å°½å¯èƒ½åœ°ä½¿ç”¨Sparkå†…ç½®çš„SQL functionsã€‚</p><p>åœ¨æ—¥å¸¸çš„å·¥ä½œä¸­ï¼Œæˆ‘å‘ç°è¿™äº›è­¦å‘Šè¢«åå¤åœ°ç”¨äºCode reviewä¸­ï¼ŒCode revieweråœ¨å®¡æŸ¥ä»£ç çš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°è‡ªå®šä¹‰çš„UDFï¼Œå°±æç¤ºå¼€å‘çš„åŒå­¦ç”¨SQL functionså»é‡å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¿™å‡ ä¹æˆäº†ä¸€ç§æ¡ä»¶åå°„ã€‚</p><!-- [[[read_end]]] --><p>ç”šè‡³ï¼Œå¼€å‘çš„åŒå­¦ä¹Ÿè§‰å¾—éå¸¸æœ‰é“ç†ã€‚äºæ˜¯ï¼Œä»–ä»¬èŠ±è´¹å¤§é‡æ—¶é—´ç”¨SQL functionsé‡æ„ä¸šåŠ¡ä»£ç ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œè¿™ä¹ˆåšä¹‹åETLä½œä¸šç«¯åˆ°ç«¯çš„æ‰§è¡Œæ€§èƒ½å¹¶æ²¡æœ‰ä»€ä¹ˆæ˜¾è‘—çš„æå‡ã€‚è¿™ç§æƒ…å†µå°±æ˜¯æ‰€è°“çš„æŠ•å…¥æ—¶é—´ä¸äº§å‡ºä¸æˆæ­£æ¯”çš„çª˜å¢ƒï¼š<strong>è°ƒä¼˜çš„æ—¶é—´æ²¡å°‘èŠ±ï¼Œå´æ²¡å•¥æ•ˆæœ</strong>ã€‚</p><p>ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæˆ‘è§‰å¾—ä¸»è¦åŸå› åœ¨äºCode reviewerå¯¹äºæ€§èƒ½è°ƒä¼˜çš„ç†è§£è¿˜åœç•™åœ¨ç…§æœ¬å®£ç§‘çš„å±‚æ¬¡ï¼Œæ²¡æœ‰å½¢æˆç³»ç»ŸåŒ–çš„æ–¹æ³•è®ºã€‚è¦å»ºç«‹ç³»ç»ŸåŒ–çš„æ–¹æ³•è®ºï¼Œæˆ‘ä»¬å°±å¿…é¡»å»æ¢ç©¶æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨åˆ°åº•æ˜¯ä»€ä¹ˆã€‚å¦åˆ™ï¼Œå¼€å‘è€…å°±åƒæ˜¯æ‰è¿›è¿·å®«çš„å°ä»“é¼ ï¼Œæ–—å¿—æ˜‚æ‰¬åœ°æ¨ªå†²ç›´æ’ï¼Œä½†å°±æ˜¯æ‰¾ä¸åˆ°å‡ºå£ã€‚</p><p>æ—¢ç„¶æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨è¿™ä¹ˆé‡è¦ï¼Œé‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><h2>æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨</h2><p>æ¢ç©¶ä»»ä½•ä¸€ä¸ªäº‹ç‰©çš„æœ¬è´¨ï¼Œéƒ½ç¦»ä¸å¼€ä»ä¸ªä¾‹è§‚å¯Ÿã€ç°è±¡å½’å› åˆ°æ€»ç»“å½’çº³çš„è¿‡ç¨‹ã€‚</p><p>å’±ä»¬ä¸å¦¨å…ˆæ¥åˆ†æåˆ†æä¸Šé¢çš„åä¾‹ï¼Œä¸ºä»€ä¹ˆç”¨SQL functionsé‡æ„UDFå¹¶æ²¡æœ‰åƒä¹¦æœ¬ä¸Šè¯´çš„é‚£ä¹ˆå¥æ•ˆï¼Ÿ</p><p>æ˜¯å› ä¸ºè¿™æ¡å»ºè®®æœ¬èº«å°±ä¸å¯¹å—ï¼Ÿè‚¯å®šä¸æ˜¯ã€‚é€šè¿‡å¯¹æ¯”æŸ¥è¯¢è®¡åˆ’ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ˜æ˜¾çœ‹åˆ°UDFä¸SQL functionsçš„åŒºåˆ«ã€‚Spark SQLçš„Catalyst Optimizerèƒ½å¤Ÿæ˜ç¡®æ„ŸçŸ¥SQL functionsæ¯ä¸€æ­¥åœ¨åšä»€ä¹ˆï¼Œå› æ­¤æœ‰è¶³å¤Ÿçš„ä¼˜åŒ–ç©ºé—´ã€‚ç›¸åï¼ŒUDFé‡Œé¢å°è£…çš„è®¡ç®—é€»è¾‘å¯¹äºCatalyst Optimizeræ¥è¯´å°±æ˜¯ä¸ªé»‘ç›’å­ï¼Œé™¤äº†æŠŠUDFå¡åˆ°é—­åŒ…é‡Œé¢å»ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå…¶ä»–å·¥ä½œå¯åšçš„ã€‚</p><p>é‚£ä¹ˆï¼Œæ˜¯å› ä¸ºUDFç›¸æ¯”SQL functionså…¶å®å¹¶æ²¡æœ‰æ€§èƒ½å¼€é”€å—ï¼Ÿä¹Ÿä¸æ˜¯ã€‚æˆ‘ä»¬å¯ä»¥åšä¸ªæ€§èƒ½å•å…ƒæµ‹è¯•ï¼Œä»ä½ çš„ETLåº”ç”¨ä¸­éšæ„æŒ‘å‡ºä¸€ä¸ªè‡ªå®šä¹‰çš„UDFï¼Œå°è¯•ç”¨SQL functionså»é‡å†™ï¼Œç„¶åå‡†å¤‡å•å…ƒæµ‹è¯•æ•°æ®ï¼Œæœ€ååœ¨å•æœºç¯å¢ƒä¸‹å¯¹æ¯”ä¸¤ç§ä¸åŒå®ç°çš„è¿è¡Œæ—¶é—´ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒUDFå®ç°ç›¸æ¯”SQL functionsä¼šæ…¢3%åˆ°5%ä¸ç­‰ã€‚æ‰€ä»¥ä½ çœ‹ï¼ŒUDFçš„æ€§èƒ½å¼€é”€è¿˜æ˜¯æœ‰çš„ã€‚</p><p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨SQL functionsä¼˜åŒ–UDFçš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰æ˜¾è‘—æå‡ç«¯åˆ°ç«¯ETLåº”ç”¨çš„æ•´ä½“æ€§èƒ½å‘¢ï¼Ÿ</p><p><strong>æ ¹æ®æœ¨æ¡¶ç†è®ºï¼Œæœ€çŸ­çš„æœ¨æ¿å†³å®šäº†æœ¨æ¡¶çš„å®¹é‡ï¼Œå› æ­¤ï¼Œå¯¹äºä¸€åªæœ‰çŸ­æ¿çš„æœ¨æ¡¶ï¼Œå…¶ä»–æœ¨æ¿è°ƒèŠ‚å¾—å†é«˜ä¹Ÿæ— æµäºäº‹ï¼Œæœ€çŸ­çš„æœ¨æ¿æ‰æ˜¯æœ¨æ¡¶å®¹é‡çš„ç“¶é¢ˆ</strong>ã€‚å¯¹äºETLåº”ç”¨è¿™æ”¯æœ¨æ¡¶æ¥è¯´ï¼ŒUDFåˆ°SQL functionsçš„è°ƒä¼˜ä¹‹æ‰€ä»¥å¯¹æ‰§è¡Œæ€§èƒ½çš„å½±å“å¾®ä¹å…¶å¾®ï¼Œæ ¹æœ¬åŸå› åœ¨äºå®ƒä¸æ˜¯é‚£å—æœ€çŸ­çš„æœ¨æ¿ã€‚æ¢å¥è¯è¯´ï¼ŒETLåº”ç”¨ç«¯åˆ°ç«¯æ‰§è¡Œæ€§èƒ½çš„ç“¶é¢ˆä¸æ˜¯å¼€å‘è€…è‡ªå®šä¹‰çš„UDFã€‚</p><p>ç»“åˆä¸Šé¢çš„åˆ†æï¼Œ<strong>æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨</strong>æˆ‘ä»¬å¯ä»¥å½’çº³ä¸º4ç‚¹ã€‚</p><ol>\n<li>æ€§èƒ½è°ƒä¼˜ä¸æ˜¯ä¸€é”¤å­ä¹°å–ï¼Œè¡¥é½ä¸€ä¸ªçŸ­æ¿ï¼Œå…¶ä»–æ¿å­å¯èƒ½ä¼šæˆä¸ºæ–°çš„çŸ­æ¿ã€‚å› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€ã€æŒç»­ä¸æ–­çš„è¿‡ç¨‹ã€‚</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„æ‰‹æ®µå’Œæ–¹æ³•æ˜¯å¦é«˜æ•ˆï¼Œå–å†³äºå®ƒé’ˆå¯¹çš„æ˜¯æœ¨æ¡¶çš„é•¿æ¿è¿˜æ˜¯ç“¶é¢ˆã€‚é’ˆå¯¹ç“¶é¢ˆï¼Œäº‹åŠåŠŸå€ï¼›é’ˆå¯¹é•¿æ¿ï¼Œäº‹å€åŠŸåŠã€‚</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œæ²¡æœ‰ä¸€å®šä¹‹è§„ï¼Œä¹Ÿä¸æ˜¯ä¸€æˆä¸å˜ï¼Œéšç€æœ¨æ¡¶çŸ­æ¿çš„æ­¤æ¶ˆå½¼é•¿éœ€è¦ç›¸åº”çš„åŠ¨æ€åˆ‡æ¢ã€‚</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„è¿‡ç¨‹æ”¶æ•›äºä¸€ç§æ‰€æœ‰æœ¨æ¿é½å¹³ã€æ²¡æœ‰ç“¶é¢ˆçš„çŠ¶æ€ã€‚</li>\n</ol><p>åŸºäºå¯¹æ€§èƒ½è°ƒä¼˜æœ¬è´¨çš„ç†è§£ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå¥½åœ°è§£é‡Šæ—¥å¸¸å·¥ä½œä¸­ä¸€äº›å¸¸è§çš„ç°è±¡ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸å‘ç°ï¼Œæ˜æ˜æ˜¯åŒæ ·ä¸€ç§è°ƒä¼˜æ–¹æ³•ï¼Œåœ¨ä½ é‚£å„¿å¥½ä½¿ï¼Œåœ¨æˆ‘è¿™å„¿å´ä¸å¥½ä½¿ã€‚å†æ¯”å¦‚ï¼Œä»ç½‘ä¸Šçœ‹åˆ°æŸä½Sparkå¤§ç¥å‘•å¿ƒæ²¥è¡€æ€»ç»“çš„è°ƒä¼˜å¿ƒå¾—ï¼Œä½ æ‹¿è¿‡æ¥ä¸€æ¡ä¸€æ¡åœ°è¯•ï¼Œå´å‘ç°æ•ˆæœå¹¶æ²¡æœ‰åšå®¢ä¸­è¯´çš„é‚£ä¹ˆæ˜¾è‘—ã€‚è¿™ä¹Ÿå¹¶ä¸æ„å‘³ç€é‚£ä½å¤§ç¥çš„æœ€ä½³å®è·µéƒ½æ˜¯ç©ºè°ˆï¼Œæ›´å¯èƒ½æ˜¯ä»–æ€»ç»“çš„é‚£äº›ç‚¹å¹¶æ²¡æœ‰è§¦è¾¾åˆ°ä½ çš„ç“¶é¢ˆã€‚</p><h2>å®šä½æ€§èƒ½ç“¶é¢ˆçš„é€”å¾„æœ‰å“ªäº›ï¼Ÿ</h2><p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæ—¢ç„¶è°ƒä¼˜çš„å…³é”®åœ¨äºç“¶é¢ˆï¼Œæˆ‘è¯¥å¦‚ä½•å®šä½æ€§èƒ½ç“¶é¢ˆå‘¢ï¼Ÿâ€æˆ‘è§‰å¾—ï¼Œè‡³å°‘æœ‰ä¸¤ç§é€”å¾„ï¼š<strong>ä¸€æ˜¯å…ˆéªŒçš„ä¸“å®¶ç»éªŒï¼ŒäºŒæ˜¯åéªŒçš„è¿è¡Œæ—¶è¯Šæ–­</strong>ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ä¸€ä¸€æ¥çœ‹ã€‚</p><p>æ‰€è°“ä¸“å®¶ç»éªŒæ˜¯æŒ‡åœ¨ä»£ç å¼€å‘é˜¶æ®µã€æˆ–æ˜¯åœ¨ä»£ç Reviewé˜¶æ®µï¼Œå‡­å€Ÿè¿‡å¾€çš„å®æˆ˜ç»éªŒå°±èƒ½å¤Ÿå¤§è‡´åˆ¤æ–­å“ªé‡Œå¯èƒ½æ˜¯æ€§èƒ½ç“¶é¢ˆã€‚æ˜¾ç„¶ï¼Œè¿™æ ·çš„ä¸“å®¶å¹¶ä¸å¥½æ‰¾ï¼Œä¸€åå¼€å‘è€…è¦ç»è¿‡å¤§é‡çš„ç§¯ç´¯æ‰èƒ½æˆä¸ºä¸“å®¶ï¼Œå¦‚æœä½ èº«è¾¹æœ‰è¿™æ ·çš„äººï¼Œä¸€å®šä¸è¦æ”¾è¿‡ä»–ï¼</p><p>ä½†ä½ ä¹Ÿå¯èƒ½ä¼šè¯´ï¼šâ€œæˆ‘èº«è¾¹è¦æ˜¯æœ‰è¿™æ ·çš„ä¸“å®¶ï¼Œå°±ä¸ç”¨æ¥è®¢é˜…è¿™ä¸ªä¸“æ äº†ã€‚â€æ²¡å…³ç³»ï¼Œå’±ä»¬è¿˜æœ‰ç¬¬äºŒç§é€”å¾„ï¼šè¿è¡Œæ—¶è¯Šæ–­ã€‚</p><p>è¿è¡Œæ—¶è¯Šæ–­çš„æ‰‹æ®µå’Œæ–¹æ³•åº”è¯¥è¯´åº”æœ‰å°½æœ‰ã€ä¸ä¸€è€Œè¶³ã€‚æ¯”å¦‚ï¼šå¯¹äºä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µï¼ŒSpark UIæä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–é¢æ¿ï¼Œæ¥å±•ç¤ºDAGã€Stagesåˆ’åˆ†ã€æ‰§è¡Œè®¡åˆ’ã€Executorè´Ÿè½½å‡è¡¡æƒ…å†µã€GCæ—¶é—´ã€å†…å­˜ç¼“å­˜æ¶ˆè€—ç­‰ç­‰è¯¦å°½çš„è¿è¡Œæ—¶çŠ¶æ€æ•°æ®ï¼›å¯¹äºç¡¬ä»¶èµ„æºæ¶ˆè€—ï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨Gangliaæˆ–è€…ç³»ç»Ÿçº§ç›‘æ§å·¥å…·ï¼Œå¦‚topã€vmstatã€iostatã€iftopç­‰ç­‰æ¥å®æ—¶ç›‘æµ‹ç¡¬ä»¶çš„èµ„æºåˆ©ç”¨ç‡ï¼›ç‰¹åˆ«åœ°ï¼Œé’ˆå¯¹GCå¼€é”€ï¼Œå¼€å‘è€…å¯ä»¥å°†GC logå¯¼å…¥åˆ°JVMå¯è§†åŒ–å·¥å…·ï¼Œä»è€Œä¸€è§ˆä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­GCçš„é¢‘ç‡å’Œå¹…åº¦ã€‚</p><p>å¯¹äºè¿™ä¸¤ç§å®šä½æ€§èƒ½ç“¶é¢ˆçš„é€”å¾„æ¥è¯´ï¼Œä¸“å®¶å°±å¥½æ¯”æ˜¯è€ä¸­åŒ»ï¼Œç»éªŒä¸°å¯Œã€ç«çœ¼é‡‘ç›ï¼Œå¾€å¾€é€šè¿‡æœ›ã€é—»ã€é—®ã€åˆ‡å°±èƒ½ä¸€çœ¼å®šä½åˆ°ç“¶é¢ˆæ‰€åœ¨ï¼›è€Œè¿è¡Œæ—¶è¯Šæ–­æ›´åƒæ˜¯è¥¿åŒ»ä¸­çš„å„ç§æ£€æµ‹ä»ªå™¨å’Œè®¾å¤‡ï¼Œå¦‚å¬è¯Šå™¨ã€Xå…‰ã€CTæ‰«æä»ªï¼Œéœ€è¦é€šè¿‡é‡åŒ–çš„æŒ‡æ ‡æ‰èƒ½è¿…é€Ÿå®šä½é—®é¢˜ã€‚äºŒè€…å¹¶æ— ä¼˜åŠ£ä¹‹åˆ†ï¼Œåè€Œæ˜¯ç»“åˆèµ·æ¥çš„æ•ˆç‡æ›´é«˜ã€‚å°±åƒä¸€ååŒ»æœ¯é«˜è¶…ã€ç»éªŒä¸°å¯Œçš„å¤§å¤«ï¼Œæ‰‹é‡Œæ‹¿ç€ä½ çš„è¡€æ¶²åŒ–éªŒå’ŒBè¶…ç»“æœï¼Œå¯¹äºç—…ç¶çš„åˆ¤å®šè‡ªç„¶æ›´æœ‰æŠŠæ¡ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼šâ€œå°½ç®¡æœ‰è¿™ä¸¤ç§é€”å¾„ï¼Œä½†æ˜¯å°±ç“¶é¢ˆå®šä½æ¥è¯´ï¼Œæˆ‘è¿˜æ˜¯ä¸çŸ¥é“å…·ä½“ä»å“ªé‡Œåˆ‡å…¥å‘€ï¼â€ç»“åˆè¿‡å¾€çš„è°ƒä¼˜ç»éªŒï¼Œæˆ‘è®¤ä¸ºï¼Œ<strong>ä»ç¡¬ä»¶èµ„æºæ¶ˆè€—çš„è§’åº¦åˆ‡å…¥ï¼Œå¾€å¾€æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©</strong>ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä»ç¡¬ä»¶çš„è§’åº¦å‡ºå‘ï¼Œè®¡ç®—è´Ÿè½½åˆ’åˆ†ä¸ºè®¡ç®—å¯†é›†å‹ã€å†…å­˜å¯†é›†å‹å’ŒIOå¯†é›†å‹ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ˜ç¡®æ‰‹ä¸­çš„åº”ç”¨å±äºå“ªç§ç±»å‹ï¼Œè‡ªç„¶èƒ½å¤Ÿç¼©å°æœç´¢èŒƒå›´ï¼Œä»è€Œæ›´å®¹æ˜“é”å®šæ€§èƒ½ç“¶é¢ˆã€‚</p><p>ä¸è¿‡ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰è´Ÿè½½éƒ½èƒ½æ˜ç¡®åˆ’åˆ†å‡ºèµ„æºå¯†é›†ç±»å‹ã€‚æ¯”å¦‚è¯´ï¼ŒShuffleã€æ•°æ®å…³è”è¿™äº›æ•°æ®åˆ†æé¢†åŸŸä¸­çš„å…¸å‹åœºæ™¯ï¼Œå®ƒä»¬å¯¹CPUã€å†…å­˜ã€ç£ç›˜ä¸ç½‘ç»œçš„è¦æ±‚éƒ½å¾ˆé«˜ï¼Œä»»ä½•ä¸€ä¸ªç¯èŠ‚ä¸ç»™åŠ›éƒ½æœ‰å¯èƒ½å½¢æˆç“¶é¢ˆã€‚å› æ­¤ï¼Œ<strong>å°±æ€§èƒ½ç“¶é¢ˆå®šä½æ¥è¯´ï¼Œé™¤äº†ä»ç¡¬ä»¶èµ„æºçš„è§†è§’å‡ºå‘ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨å…¸å‹åœºæ™¯</strong>ã€‚</p><h2>æ€§èƒ½è°ƒä¼˜çš„æ–¹æ³•ä¸æ‰‹æ®µ</h2><p>å‡è®¾ï¼Œé€šè¿‡è¿è¡Œæ—¶è¯Šæ–­æˆ‘ä»¬æˆåŠŸåœ°å®šä½åˆ°äº†æ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ï¼Œé‚£ä¹ˆï¼Œå…·ä½“è¯¥å¦‚ä½•è°ƒä¼˜å‘¢ï¼ŸSparkæ€§èƒ½è°ƒä¼˜çš„æ–¹æ³•å’Œæ‰‹æ®µä¸°å¯Œè€Œåˆåºæ‚ï¼Œå¦‚æœä¸€æ¡ä¸€æ¡åœ°å»ç½—åˆ—ï¼Œä¸ä»…çœ‹ä¸Šå»è®©äººæ˜æ˜æ¬²ç¡ï¼Œæ›´ä¸åˆ©äºå½¢æˆç³»ç»ŸåŒ–çš„è°ƒä¼˜æ–¹æ³•è®ºã€‚å°±åƒåŒ»ç”Ÿåœ¨æ²»ç–—æŸä¸ªç—…ç—‡çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šç»“åˆå†…æœã€å¤–ç”¨ç”šè‡³æ˜¯å¤–ç§‘æ‰‹æœ¯ï¼Œè¿™æ ·å¤šç®¡é½ä¸‹çš„æ–¹å¼æ¥è¾¾åˆ°è¯åˆ°ç—…é™¤çš„ç›®çš„ã€‚</p><p>å› æ­¤ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œ Sparkçš„æ€§èƒ½è°ƒä¼˜å¯ä»¥<strong>ä»åº”ç”¨ä»£ç å’ŒSparké…ç½®é¡¹</strong>è¿™2ä¸ªå±‚é¢å±•å¼€ã€‚</p><p>åº”ç”¨ä»£ç å±‚é¢æŒ‡çš„æ˜¯ä»ä»£ç å¼€å‘çš„è§’åº¦ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å–èˆï¼Œå¦‚ä½•ä»¥æ€§èƒ½ä¸ºå¯¼å‘è¿›è¡Œåº”ç”¨å¼€å‘ã€‚åœ¨<a href=\"https://time.geekbang.org/column/article/352035\">ä¸Šä¸€è®²</a>ä¸­æˆ‘ä»¬å·²ç»åšè¿‡å¯¹æ¯”ï¼Œå“ªæ€•æ˜¯ä¸¤ä»½åŠŸèƒ½å®Œå…¨ä¸€è‡´çš„ä»£ç ï¼Œåœ¨æ€§èƒ½ä¸Šä¹Ÿä¼šæœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œ<strong>å¼€å‘é˜¶æ®µéƒ½æœ‰å“ªäº›å¸¸è§„æ“ä½œã€å¸¸è§è¯¯åŒºï¼Œä»è€Œå°½é‡é¿å…åœ¨ä»£ç ä¸­ç•™ä¸‹æ€§èƒ½éšæ‚£</strong>ã€‚</p><p>Sparké…ç½®é¡¹æƒ³å¿…ä½ å¹¶ä¸é™Œç”Ÿï¼Œ<strong>Sparkå®˜ç½‘ä¸Šç½—åˆ—äº†è¿‘ç™¾ä¸ªé…ç½®é¡¹ï¼Œçœ‹å¾—äººçœ¼èŠ±ç¼­ä¹±ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„é…ç½®é¡¹éƒ½å’Œæ€§èƒ½è°ƒä¼˜æ¯æ¯ç›¸å…³ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å®ƒä»¬è¿›è¡Œç”„åˆ«ã€å½’ç±»</strong>ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œåœ¨æ—¥å¸¸çš„è°ƒä¼˜å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä»åº”ç”¨ä»£ç å’ŒSparké…ç½®é¡¹è¿™2ä¸ªå±‚é¢å‡ºå‘ã€‚æ‰€è°“ï¼šâ€œé—®é¢˜ä»ä»£ç ä¸­æ¥ï¼Œè§£å†³é—®é¢˜è¦åˆ°ä»£ç ä¸­å»â€ï¼Œåœ¨åº”ç”¨ä»£ç å±‚é¢è¿›è¡Œè°ƒä¼˜ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ•æ‰å’Œç§»é™¤æ€§èƒ½BUGçš„è¿‡ç¨‹ã€‚Sparké…ç½®é¡¹åˆ™ç»™äºˆäº†å¼€å‘è€…æå¤§çš„çµæ´»åº¦ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡é…ç½®é¡¹æ¥è°ƒæ•´ä¸åŒç¡¬ä»¶çš„èµ„æºåˆ©ç”¨ç‡ï¼Œä»è€Œé€‚é…åº”ç”¨çš„è¿è¡Œæ—¶è´Ÿè½½ã€‚</p><p>å¯¹äºåº”ç”¨ä»£ç å’ŒSparké…ç½®é¡¹å±‚é¢çš„è°ƒä¼˜æ–¹æ³•ä¸æŠ€å·§ï¼Œä»¥åŠè¿™äº›æŠ€å·§åœ¨å…¸å‹åœºæ™¯å’Œç¡¬ä»¶èµ„æºåˆ©ç”¨ç‡è°ƒæ§ä¸­çš„ç»¼åˆè¿ç”¨ï¼Œæˆ‘ä¼šåœ¨ã€Šæ€§èƒ½ç¯‡ã€‹é€ä¸€å±•å¼€è®²è§£ï¼Œä»ä¸åŒå±‚é¢ã€ä¸åŒåœºæ™¯ã€ä¸åŒè§†è§’å‡ºå‘ï¼Œå½’çº³å‡ºä¸€å¥—è°ƒä¼˜çš„æ–¹æ³•ä¸å¿ƒå¾—ï¼ŒåŠ›å›¾è®©ä½ èƒ½å¤ŸæŒ‰å›¾ç´¢éª¥ã€æœ‰ç« å¯å¾ªåœ°å»å¼€å±•æ€§èƒ½è°ƒä¼˜ã€‚</p><h2>æ€§èƒ½è°ƒä¼˜çš„ç»ˆç»“</h2><p>æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨å‘Šè¯‰æˆ‘ä»¬ï¼šæ€§èƒ½è°ƒä¼˜æ˜¯ä¸€ä¸ªåŠ¨æ€ã€æŒç»­ä¸æ–­çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè°ƒä¼˜çš„æ‰‹æ®µéœ€è¦éšç€ç“¶é¢ˆçš„æ­¤æ¶ˆå½¼é•¿è€Œç›¸åº”åœ°åˆ‡æ¢ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€§èƒ½è°ƒä¼˜åˆ°åº•ä»€ä¹ˆæ—¶å€™æ˜¯ä¸ªå¤´å„¿å‘¢ï¼Ÿå°±ç®—æ˜¯æŒç»­ä¸æ–­åœ°ï¼Œä¹Ÿæ€»å¾—æœ‰ä¸ªæ”¶æ•›æ¡ä»¶å§ï¼Ÿæ€»ä¸èƒ½ä¸€ç›´è¿™ä¹ˆæ— é™å¾ªç¯ä¸‹å»ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œ<strong>æ€§èƒ½è°ƒä¼˜çš„æœ€ç»ˆç›®çš„ï¼Œæ˜¯åœ¨æ‰€æœ‰å‚ä¸è®¡ç®—çš„ç¡¬ä»¶èµ„æºä¹‹é—´å¯»æ±‚ååŒä¸å¹³è¡¡ï¼Œè®©ç¡¬ä»¶èµ„æºè¾¾åˆ°ä¸€ç§å¹³è¡¡ã€æ— ç“¶é¢ˆçš„çŠ¶æ€</strong>ã€‚</p><p>æˆ‘ä»¬ä»¥å¤§æ•°æ®æœåŠ¡å…¬å¸Quboleçš„æ¡ˆä¾‹ä¸ºä¾‹ï¼Œä»–ä»¬æœ€è¿‘åœ¨Sparkä¸Šé›†æˆæœºå™¨å­¦ä¹ æ¡†æ¶XGBoostæ¥è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œåœ¨ç›¸åŒçš„ç¡¬ä»¶èµ„æºã€ç›¸åŒçš„æ•°æ®æºã€ç›¸åŒçš„è®¡ç®—ä»»åŠ¡ä¸­å¯¹æ¯”ä¸åŒé…ç½®ä¸‹çš„æ‰§è¡Œæ€§èƒ½ã€‚</p><p>ä»ä¸‹è¡¨ä¸­æˆ‘ä»¬å°±å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œæ‰§è¡Œæ€§èƒ½æœ€å¥½çš„è®­ç»ƒä»»åŠ¡å¹¶ä¸æ˜¯é‚£äº›æŠŠCPUåˆ©ç”¨ç‡å‹æ¦¨åˆ°100%ï¼Œä»¥åŠæŠŠå†…å­˜è®¾ç½®åˆ°æœ€å¤§çš„é…ç½®ç»„åˆï¼Œè€Œæ˜¯é‚£äº›ç¡¬ä»¶èµ„æºé…ç½®æœ€å‡è¡¡çš„è®¡ç®—ä»»åŠ¡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/33/07/338518a9afaa820e4517868f03aae507.jpeg?wh=1920*940\" alt=\"\"></p><h2>å°ç»“</h2><p>åªæœ‰ç†è§£Sparkæ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼Œå½¢æˆç³»ç»ŸåŒ–çš„æ–¹æ³•è®ºï¼Œæˆ‘ä»¬æ‰èƒ½é¿å…æŠ•å…¥æ—¶é—´ä¸äº§å‡ºä¸æˆæ­£æ¯”çš„çª˜å¢ƒã€‚</p><p>æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼Œæˆ‘æ€»ç»“ä¸º4ç‚¹ï¼š</p><ol>\n<li>æ€§èƒ½è°ƒä¼˜ä¸æ˜¯ä¸€é”¤å­ä¹°å–ï¼Œè¡¥é½ä¸€ä¸ªçŸ­æ¿ï¼Œå…¶ä»–æ¿å­å¯èƒ½ä¼šæˆä¸ºæ–°çš„çŸ­æ¿ã€‚å› æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€ã€æŒç»­ä¸æ–­çš„è¿‡ç¨‹ï¼›</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„æ‰‹æ®µå’Œæ–¹æ³•æ˜¯å¦é«˜æ•ˆï¼Œå–å†³äºå®ƒé’ˆå¯¹çš„æ˜¯æœ¨æ¡¶çš„é•¿æ¿è¿˜æ˜¯ç“¶é¢ˆã€‚é’ˆå¯¹ç“¶é¢ˆï¼Œäº‹åŠåŠŸå€ï¼›é’ˆå¯¹é•¿æ¿ï¼Œäº‹å€åŠŸåŠï¼›</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œæ²¡æœ‰ä¸€å®šä¹‹è§„ï¼Œä¹Ÿä¸æ˜¯ä¸€æˆä¸å˜ï¼Œéšç€æœ¨æ¡¶çŸ­æ¿çš„æ­¤æ¶ˆå½¼é•¿éœ€è¦ç›¸åº”åœ°åŠ¨æ€åˆ‡æ¢ï¼›</li>\n<li>æ€§èƒ½è°ƒä¼˜çš„è¿‡ç¨‹æ”¶æ•›äºä¸€ç§æ‰€æœ‰æœ¨æ¿é½å¹³ã€æ²¡æœ‰ç“¶é¢ˆçš„çŠ¶æ€ã€‚</li>\n</ol><p>ç³»ç»ŸåŒ–çš„æ€§èƒ½è°ƒä¼˜æ–¹æ³•è®ºï¼Œæˆ‘å½’çº³ä¸º4æ¡ï¼š</p><ol>\n<li>é€šè¿‡ä¸åŒçš„é€”å¾„å¦‚ä¸“å®¶ç»éªŒæˆ–è¿è¡Œæ—¶è¯Šæ–­æ¥å®šä½æ€§èƒ½ç“¶é¢ˆï¼›</li>\n<li>ä»ä¸åŒåœºæ™¯ï¼ˆå…¸å‹åœºæ™¯ï¼‰ã€ä¸åŒè§†è§’ï¼ˆç¡¬ä»¶èµ„æºï¼‰å‡ºå‘ï¼Œç»¼åˆè¿ç”¨ä¸åŒå±‚é¢ï¼ˆåº”ç”¨ä»£ç ã€Sparké…ç½®é¡¹ï¼‰çš„è°ƒä¼˜æ‰‹æ®µå’Œæ–¹æ³•ï¼›</li>\n<li>éšç€æ€§èƒ½ç“¶é¢ˆçš„æ­¤æ¶ˆå½¼é•¿ï¼ŒåŠ¨æ€çµæ´»åœ°åœ¨ä¸åŒå±‚é¢ä¹‹é—´åˆ‡æ¢è°ƒä¼˜æ–¹æ³•ï¼›</li>\n<li>è®©æ€§èƒ½è°ƒä¼˜çš„è¿‡ç¨‹æ”¶æ•›äºä¸åŒç¡¬ä»¶èµ„æºåœ¨è¿è¡Œæ—¶è¾¾åˆ°ä¸€ç§å¹³è¡¡ã€æ— ç“¶é¢ˆçš„çŠ¶æ€ã€‚</li>\n</ol><h2>æ¯æ—¥ä¸€ç»ƒ</h2><ol>\n<li>\n<p>ä½ è¿˜é‡åˆ°è¿‡å“ªäº›â€œç…§æœ¬å®£ç§‘â€çš„è°ƒä¼˜æ‰‹æ®µï¼Ÿ</p>\n</li>\n<li>\n<p>ä½ è®¤ä¸ºï¼Œå¯¹äºæ€§èƒ½è°ƒä¼˜çš„æ”¶æ•›çŠ¶æ€ï¼Œå³ç¡¬ä»¶èµ„æºå½¼æ­¤ä¹‹é—´å¹³è¡¡ã€æ— ç“¶é¢ˆçš„çŠ¶æ€ï¼Œéœ€è¦é‡åŒ–å—ï¼Ÿå¦‚ä½•é‡åŒ–å‘¢ï¼Ÿ</p>\n</li>\n</ol><p>å…³äºæ€§èƒ½è°ƒä¼˜ï¼Œä½ è¿˜æœ‰å“ªäº›çœ‹æ³•ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p>","neighbors":{"left":{"article_title":"01 | æ€§èƒ½è°ƒä¼˜çš„å¿…è¦æ€§ï¼šSparkæœ¬èº«å°±å¾ˆå¿«ï¼Œä¸ºå•¥è¿˜éœ€è¦æˆ‘è°ƒä¼˜ï¼Ÿ","id":352035},"right":{"article_title":"03 | RDDï¼šä¸ºä»€ä¹ˆä½ å¿…é¡»è¦ç†è§£å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Ÿ","id":353297}},"comments":[{"had_liked":false,"id":283867,"user_name":"October","can_delete":false,"product_type":"c1","uid":1137879,"ip_address":"","ucode":"CEDA78F4A5F8B1","user_header":"https://static001.geekbang.org/account/avatar/00/11/5c/d7/e4673fde.jpg","comment_is_top":false,"comment_ctime":1615965026,"is_pvip":false,"replies":[{"id":"103039","content":"å¥½é—®é¢˜ï¼Œä¸è¿‡ä¸“æ æœ€å¼€å§‹çš„è®¡åˆ’æ²¡æœ‰åŒ…å«è¿™éƒ¨åˆ†ï¼ŒåŸå› æ˜¯è¿™éƒ¨åˆ†å…¶å®ç½‘ä¸Šéƒ½èƒ½æŸ¥åˆ°ï¼Œä¸è¿‡å¦‚æœåç»­å¤§å®¶å¯¹è¿™å—ç–‘é—®è¾ƒå¤šï¼Œåˆ°æ—¶å€™å’±ä»¬ä¹Ÿå¯ä»¥åŠ é¤ï¼Œä¸“é—¨è¯´è¯´ç›‘æ§çš„äº‹å„¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616051295,"ip_address":"","comment_id":283867,"utype":1}],"discussion_count":20,"race_medal":0,"score":"83220343650","product_id":100073401,"comment_content":"è€å¸ˆè®²åˆ°å¯ä»¥é€šè¿‡è¿è¡Œæ—¶è¯Šæ–­æ¥å®šä½ç³»ç»Ÿç“¶é¢ˆï¼Œå¯å€ŸåŠ©äºspark uiä»¥åŠç³»ç»Ÿçº§ç›‘æ§å·¥å…·ï¼Œä½†æ˜¯æˆ‘ä¾ç„¶ä¸æ¸…æ¥šæ€æ ·æŸ¥çœ‹spark uiçš„å„ä¸ªæŒ‡æ ‡ï¼Œæ€æ ·æŸ¥çœ‹æ¯ä¸ªåº”ç”¨ç¨‹åºçš„å„ç§ç¡¬ä»¶è´Ÿè½½ï¼Œä¸çŸ¥é“è€å¸ˆåè¾¹çš„è¯¾ç¨‹æœ‰æ²¡æœ‰ç›¸å…³å†…å®¹","like_count":20,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517166,"discussion_content":"å¥½é—®é¢˜ï¼Œä¸è¿‡ä¸“æ æœ€å¼€å§‹çš„è®¡åˆ’æ²¡æœ‰åŒ…å«è¿™éƒ¨åˆ†ï¼ŒåŸå› æ˜¯è¿™éƒ¨åˆ†å…¶å®ç½‘ä¸Šéƒ½èƒ½æŸ¥åˆ°ï¼Œä¸è¿‡å¦‚æœåç»­å¤§å®¶å¯¹è¿™å—ç–‘é—®è¾ƒå¤šï¼Œåˆ°æ—¶å€™å’±ä»¬ä¹Ÿå¯ä»¥åŠ é¤ï¼Œä¸“é—¨è¯´è¯´ç›‘æ§çš„äº‹å„¿ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616051295,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404363,"discussion_content":"ä¸‹å‘¨ä¸Šçº¿Spark UIï¼ˆä¸Šã€ä¸‹ï¼‰~ ä¸å¥½æ„æ€ï¼Œå¤§å®¶ä¹…ç­‰å•¦","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1634293028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2455712,"avatar":"https://static001.geekbang.org/account/avatar/00/25/78/a0/7a248ddc.jpg","nickname":"ç¦","note":"","ucode":"F2FC7AF5D433C6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":405277,"discussion_content":"æ„Ÿè°¢å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634547105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":404363,"ip_address":""},"score":405277,"extra":""},{"author":{"id":1796594,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIZsIJl08iafzL3V19xIabhFAYxuRyRoSuiaY4scjVaBFzccelHVibB7cwn4J5q0zhE7HoNUPR0ciaX0A/132","nickname":"å®‹ç ç ","note":"","ucode":"753469888B36D5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":555204,"discussion_content":"å´è€å¸ˆã€‚spark uiæŒ‡æ ‡çš„è¯¾ç¨‹åœ¨å“ªé‡Œå‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646810402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":404363,"ip_address":""},"score":555204,"extra":""}]},{"author":{"id":2485585,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","nickname":"Geek_d794f8","note":"","ucode":"1E20DA4FF8B800","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361388,"discussion_content":"è¿™éƒ¨åˆ†éœ€æ±‚æŒºå¤§çš„ï¼Œå¹³æ—¶è™½ç„¶ä¹Ÿä¼šå»çœ‹spark UIï¼Œä½†æ˜¯ä¸€çŸ¥åŠè§£ï¼Œå¸Œæœ›è€å¸ˆèƒ½ç³»ç»Ÿçš„è®²ä¸€ä¸‹SparkUIçš„å„ä¸ªé‡è¦æŒ‡æ ‡çš„å«ä¹‰","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1616657946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2485585,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","nickname":"Geek_d794f8","note":"","ucode":"1E20DA4FF8B800","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362535,"discussion_content":"åé¢æ‰¾ä¸ªæœºä¼šå¼€ä¸ªè§†é¢‘ï¼Œæ¯”è¾ƒç›´è§‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1616979706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":361388,"ip_address":""},"score":362535,"extra":""},{"author":{"id":1168504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d4/78/66b3f2a2.jpg","nickname":"æ–¯ç›–ä¸¸","note":"","ucode":"B881D14B028F14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":368431,"discussion_content":"è€å¸ˆï¼Œç­‰ä½ å“¦ï¼ŒğŸ˜˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618709116,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":362535,"ip_address":""},"score":368431,"extra":""}]},{"author":{"id":2162751,"avatar":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","nickname":"Sean","note":"","ucode":"69234046BFD81B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387509,"discussion_content":"è¿™ä¸ªsparkuiçš„åŠ é¤ä¼šåŒæ­¥åˆ°è¯¾ç¨‹ç›®å½•ä¸­å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628224114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2162751,"avatar":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","nickname":"Sean","note":"","ucode":"69234046BFD81B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388740,"discussion_content":"å—¯å—¯ï¼Œä¼šçš„ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628932083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":387509,"ip_address":""},"score":388740,"extra":""}]},{"author":{"id":1267753,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo2GMhevabZrjINs2TKvIeGC7TJkicNlLvqTticuM5KL8ZN80OC2CnrsUyzPcZXO4uptj4Q1S4jT2lQ/132","nickname":"jerry guo","note":"","ucode":"179943AFCB93F8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":365499,"discussion_content":"å¸Œæœ›è€å¸ˆå¯ä»¥è®²ä¸€è®²","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1617808739,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1544692,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83errHypG6kuO0V0bRwp74rm8srjoQ4zXUBNNLMcY19uNdz8Ea3rOFuBJibXMHWePMwBYpGsyyxiav0ibw/132","nickname":"é—¯é—¯","note":"","ucode":"D32958F8EF26BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374880,"discussion_content":"å¸Œæœ›è®²ä¸€è®²","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621398955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1000179,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","nickname":"sparkjoy","note":"","ucode":"827B3116EED3B8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360447,"discussion_content":"è€å¸ˆå¯ä»¥ç»“åˆä¸€äº›å®ä¾‹é’ˆå¯¹æ€§çš„è®²ä¸€äº›ä¸å¤ªå®¹æ˜“ç†è§£çš„uiæŒ‡æ ‡ï¼ŒåŒ…æ‹¬å†…å­˜ä½¿ç”¨ï¼Œæ‰§è¡Œè®¡åˆ’å¯¹æ¯”ç­‰ï¼Œè°¢è°¢ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616458091,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1000179,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","nickname":"sparkjoy","note":"","ucode":"827B3116EED3B8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":360922,"discussion_content":"å¯ä»¥çš„ï¼Œåˆ°æ—¶å€™ç»Ÿä¸€è®²ä¸€è®²ï¼Œç”¨è§†é¢‘çš„å½¢å¼\n","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1616557808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360447,"ip_address":""},"score":360922,"extra":""},{"author":{"id":2485585,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIiaeebUYxl7e4jicPshDRKMbiculHUjKgZZ2ygDibn2S7bbsjeqYIdsEUdVyoryKNa43ZGnDQmWjv3ibQ/132","nickname":"Geek_d794f8","note":"","ucode":"1E20DA4FF8B800","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":361389,"discussion_content":"å¤§èµï¼Œsparkuiåˆ†æè¿™ä¸ªéœ€æ±‚å¾ˆå¼ºçƒˆï¼Œè°¢è°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616657997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360922,"ip_address":""},"score":361389,"extra":""},{"author":{"id":2725399,"avatar":"https://static001.geekbang.org/account/avatar/00/29/96/17/200c21f0.jpg","nickname":"ç‹—å“­","note":"","ucode":"56E48A6FC1298A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":388595,"discussion_content":"è€å¸ˆè¿™éƒ¨åˆ†è®²äº†å—ï¼Ÿåœ¨å“ªå¯ä»¥çœ‹åˆ°è§†é¢‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628843749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":360922,"ip_address":""},"score":388595,"extra":""}]},{"author":{"id":1199213,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4c/6d/c20f2d5a.jpg","nickname":"LJK","note":"","ucode":"12B2441099FF1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358790,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616050938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1705386,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/usX58SweWDFqjCmtkvPOWIfjqN2GqydQYqW53bIcFI4DGBmp6O2LZxZL1UYsVPRuEP03dEJcK3d9jHdYZVn8ug/132","nickname":"maben996","note":"","ucode":"95390116090D23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358700,"discussion_content":"æœ‰å¾ˆå¤šåšå®¢è®²è§£äº†uiçš„å„ä¸ªæŒ‡æ ‡å«ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616032316,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1137879,"avatar":"https://static001.geekbang.org/account/avatar/00/11/5c/d7/e4673fde.jpg","nickname":"October","note":"","ucode":"CEDA78F4A5F8B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1705386,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/usX58SweWDFqjCmtkvPOWIfjqN2GqydQYqW53bIcFI4DGBmp6O2LZxZL1UYsVPRuEP03dEJcK3d9jHdYZVn8ug/132","nickname":"maben996","note":"","ucode":"95390116090D23","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358774,"discussion_content":"ok","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616047732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":358700,"ip_address":""},"score":358774,"extra":""},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":1705386,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/usX58SweWDFqjCmtkvPOWIfjqN2GqydQYqW53bIcFI4DGBmp6O2LZxZL1UYsVPRuEP03dEJcK3d9jHdYZVn8ug/132","nickname":"maben996","note":"","ucode":"95390116090D23","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358802,"discussion_content":"æ²¡é”™\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616052467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":358700,"ip_address":""},"score":358802,"extra":""}]},{"author":{"id":1236429,"avatar":"https://static001.geekbang.org/account/avatar/00/12/dd/cd/9f9d29e9.jpg","nickname":"é¹¿æ¼«æ¼«éª‘ä¿®è¿œå…®","note":"","ucode":"CAA44C682C930F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":358370,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615973064,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283784,"user_name":"seed","can_delete":false,"product_type":"c1","uid":1178473,"ip_address":"","ucode":"63669455593CA3","user_header":"https://static001.geekbang.org/account/avatar/00/11/fb/69/979deb1d.jpg","comment_is_top":false,"comment_ctime":1615931954,"is_pvip":false,"replies":[{"id":"102968","content":"è¯´å¾—éå¸¸å¥½ï¼<br><br>1çš„åœºæ™¯éå¸¸å¸¸è§ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯çŸ¥å…¶ç„¶ï¼Œè€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œç¨€é‡Œç³Šæ¶‚å°±ç®—å®Œäº‹äº†ï¼Œäº¤å·®å°±è¡Œã€‚<br><br>2çš„å›ç­”æ»¡åˆ†ğŸ’¯ï¼Œæ— å¯æŒ‘å‰”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1615958517,"ip_address":"","comment_id":283784,"utype":1}],"discussion_count":3,"race_medal":0,"score":"57450506802","product_id":100073401,"comment_content":"1. è¿˜é‡åˆ°çš„è°ƒä¼˜æ‰‹æ®µï¼šç›´æ¥ä»ç½‘ä¸Šcopyè¿‡æ¥ä¸€äº›å‚æ•°ï¼Œåœ¨æ²¡æœ‰ç†è§£çœŸæ­£çš„åŸç†çš„æƒ…å†µä¸‹ï¼Œå…ˆæ€¼ä¸Šå»ï¼Œè·‘ä¸€ä¸‹ï¼Œä»»åŠ¡æ—¶é—´ç¼©çŸ­äº†å°±ç®—è°ƒä¼˜äº†<br>2. å¯¹äºæ€§èƒ½è°ƒä¼˜çš„æ”¶æ•›çŠ¶æ€ï¼Œéœ€è¦é‡åŒ–ï¼›å¦‚ä½•é‡åŒ–è¿™äº›æŒ‡æ ‡ï¼Ÿ<br>å…¶å®å°±æ˜¯ä»æˆ‘ä»¬éœ€è¦è°ƒä¼˜çš„ç‚¹å‡ºå‘ï¼›æ–‡ä¸­æåˆ°ï¼šä»ç¡¬ä»¶çš„è§’åº¦æ¥çœ‹ï¼Œè®¡ç®—è´Ÿè½½åˆ’åˆ†ä¸ºè®¡ç®—å¯†é›†å‹ã€å†…å­˜å¯†é›†å‹å’Œ IO å¯†é›†å‹ã€‚<br>é¦–å…ˆéœ€è¦ç¡®è®¤æˆ‘ä»¬çš„ä»»åŠ¡å±äºå“ªä¸€ç±»å‹çš„ä»»åŠ¡æˆ–è€…è¯´ä»»åŠ¡çš„çŸ­æ¿åœ¨å“ªä¸€å—<br>å…¶æ¬¡ä»Sparkä»»åŠ¡æ‰§è¡Œæ—¶é•¿ï¼Œç³»ç»Ÿçš„cpu&#47;memory&#47;ioç­‰æ–¹é¢æŒ‰ç…§ä»»åŠ¡ç±»å‹æœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œç›‘æ§<br>ç„¶åä»åº”ç”¨ä»£ç å’ŒSparké…ç½®é¡¹ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹è¿›è¡Œè°ƒä¼˜<br>æœ€ååœ¨æ¯æ¬¡è°ƒä¼˜åé‡ç‚¹å…³æ³¨ä»»åŠ¡æ—¶é—´æ˜¯å¦ä¸‹é™ï¼Œå¯¹æ¯”ä¸‹é™å‰åç³»ç»Ÿçš„cpu&#47;memory&#47;ioçš„ä½¿ç”¨é‡ï¼Œå°±å¯ä»¥åšåˆ°é‡åŒ–","like_count":14,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517145,"discussion_content":"è¯´å¾—éå¸¸å¥½ï¼\n\n1çš„åœºæ™¯éå¸¸å¸¸è§ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯çŸ¥å…¶ç„¶ï¼Œè€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œç¨€é‡Œç³Šæ¶‚å°±ç®—å®Œäº‹äº†ï¼Œäº¤å·®å°±è¡Œã€‚\n\n2çš„å›ç­”æ»¡åˆ†ğŸ’¯ï¼Œæ— å¯æŒ‘å‰”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615958517,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2188142,"avatar":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","nickname":"Zå®‡é”¤é”¤","note":"","ucode":"7DB36E986A7A51","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361944,"discussion_content":"å•¥æ˜¯å†…å­˜å¯†é›†å‹ã€ç¼“å­˜çš„æ•°æ®å¤ªå¤šäº†ä¹ˆï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616809840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":2188142,"avatar":"https://static001.geekbang.org/account/avatar/00/21/63/6e/6b971571.jpg","nickname":"Zå®‡é”¤é”¤","note":"","ucode":"7DB36E986A7A51","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":362539,"discussion_content":"ä¹Ÿä¸å®Œå…¨æ˜¯ï¼Œæ’åºã€èšåˆä¹Ÿæ˜¯å†…å­˜å¯†é›†å‹è®¡ç®—ï¼Œä¸»è¦çœ‹è®¡ç®—å¯¹äºå†…å­˜çš„ä¾èµ–ç¨‹åº¦ï¼Œä½ æ¯”å¦‚mapã€çº¯ç²¹çš„æ˜ å°„ï¼Œå°±ä¸æ˜¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616979810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":361944,"ip_address":""},"score":362539,"extra":""}]}]},{"had_liked":false,"id":284069,"user_name":"è£˜å…ƒé£","can_delete":false,"product_type":"c1","uid":1239145,"ip_address":"","ucode":"2D0A22C3DB06DD","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/69/5c3be4c0.jpg","comment_is_top":false,"comment_ctime":1616055627,"is_pvip":false,"replies":[{"id":"103089","content":"å¯ä»¥çš„ï¼Œåé¢æ‰¾æœºä¼šè®²ä¸€è®²ï¼Œåˆ°æ—¶å€™çœ‹å¤§å®¶éœ€è¦ï¼Œå¯ä»¥å¼€ä¸ªç›´æ’­å½“é¢è®²ï¼Œæ¯”è¾ƒç›´è§‚ï¼Œå›¾æ–‡è®²UIå¾ˆå¤šç»†èŠ‚éƒ½è¯´ä¸åˆ°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616115639,"ip_address":"","comment_id":284069,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40270761291","product_id":100073401,"comment_content":"å¸Œæœ›è€å¸ˆå¯ä»¥ç¨å¾®è®²ä¸€è®²ä¾‹å¦‚spark UIç­‰å·¥å…·å¦‚ä½•ç›‘æ§æŒ‡æ ‡ç­‰ï¼Œä¸»è¦å¾ˆå¤šæ—¶å€™éƒ½ä¸çŸ¥é“æœ‰è¿™äº›å·¥å…·çš„å­˜åœ¨ã€‚","like_count":10,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517223,"discussion_content":"å¯ä»¥çš„ï¼Œåé¢æ‰¾æœºä¼šè®²ä¸€è®²ï¼Œåˆ°æ—¶å€™çœ‹å¤§å®¶éœ€è¦ï¼Œå¯ä»¥å¼€ä¸ªç›´æ’­å½“é¢è®²ï¼Œæ¯”è¾ƒç›´è§‚ï¼Œå›¾æ–‡è®²UIå¾ˆå¤šç»†èŠ‚éƒ½è¯´ä¸åˆ°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616115639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283910,"user_name":"Shockang","can_delete":false,"product_type":"c1","uid":1263546,"ip_address":"","ucode":"B871D731F6E6B1","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/ba/d36340c1.jpg","comment_is_top":false,"comment_ctime":1615980664,"is_pvip":false,"replies":[{"id":"103035","content":"æ²¡é”™ï¼Œæ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼Œå…¶å®å°±æ˜¯ç”¨è½¯ä»¶é©±åŠ¨ç¡¬ä»¶ï¼Œè®©ç¡¬ä»¶åœ¨è¿è¡Œæ—¶èƒ½å¤Ÿé«˜æ•ˆååŒï¼Œå……åˆ†å‹æ¦¨æ¯ä¸€ç±»ç¡¬ä»¶èµ„æºçš„â€œå‰©ä½™ä»·å€¼â€ã€‚æœ€æ—©åœ¨IBMé‚£ä¼šï¼Œå¯èƒ½æ˜¯2011å¹´å§ï¼Œæˆ‘ä»¬åšIBMæ™ºèƒ½åˆ†æç³»ç»Ÿä¸€ä½“æœºï¼Œå°±æ˜¯ç”¨è½¯ç¡¬æ­é…çš„æ–¹å¼åšæ•°ä»“ã€‚é‚£ä¼šå¯¹äºç¡¬ä»¶èµ„æºçš„ååŒï¼Œæˆ‘ä»¬ç”šè‡³æœ‰é‡åŒ–çš„æ¯”ä¾‹ï¼Œæˆ‘è®°å¾—æ˜¯1:4:8ï¼Œ1cpuï¼š4gå†…å­˜ï¼š8å—SASç›˜ã€‚é‚£ä¼šå¾ˆæ—©äº†ï¼Œè¿˜ç”¨RAIDé˜µåˆ—æ¥æé«˜I&#47;Oæ•ˆç‡ï¼Œå½“æ—¶ç½‘ç»œç”¨äº†æœ€é«˜é…ç½®ï¼Œåº”è¯¥æ˜¯ä¸‡å…†ç½‘æˆ‘è®°å¾—ã€‚è™½ç„¶è¯´åœºæ™¯ä¸åŒï¼Œä½†æ˜¯ä»¥ç¡¬ä»¶èµ„æºå¹³è¡¡ä¸ºå¯¼å‘çš„æ€è·¯ï¼Œå¦‚å‡ºä¸€è¾™ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616050766,"ip_address":"","comment_id":283910,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35975719032","product_id":100073401,"comment_content":"ç‹å®¶æ—ï¼Œæ®µæ™ºåï¼Œå¤é˜³ç¼–è‘—çš„ã€ŠSparkå¤§æ•°æ®å•†ä¸šå®æˆ˜ä¸‰éƒ¨æ›²ã€‹é‡Œé¢æåˆ°â€”â€”å¤§æ•°æ®æ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ?ç­”æ¡ˆæ˜¯åŸºäºç¡¬ä»¶çš„è°ƒä¼˜,å³åŸºäºCPUã€Memoryã€I&#47;O(Disk&#47;Network)åŸºç¡€ä¸Šæ„å»ºç®—æ³•å’Œæ€§èƒ½è°ƒä¼˜! æ— è®ºæ˜¯Hadoop,è¿˜æ˜¯Spark,è¿˜æ˜¯å…¶ä»–æŠ€æœ¯,éƒ½æ— æ³•é€ƒè„±ã€‚  è€å¸ˆä¹Ÿåœ¨æ–‡ç« ä¸­æåˆ°â€”â€”æ€§èƒ½è°ƒä¼˜çš„æœ€ç»ˆç›®çš„ï¼Œæ˜¯åœ¨æ‰€æœ‰å‚ä¸è®¡ç®—çš„ç¡¬ä»¶èµ„æºä¹‹é—´å¯»æ±‚ååŒä¸å¹³è¡¡ï¼Œè®©ç¡¬ä»¶èµ„æºè¾¾åˆ°ä¸€ç§å¹³è¡¡ã€æ— ç“¶é¢ˆçš„çŠ¶æ€ã€‚ æˆ‘è®¤ä¸ºæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼ ","like_count":9,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517177,"discussion_content":"æ²¡é”™ï¼Œæ€§èƒ½è°ƒä¼˜çš„æœ¬è´¨ï¼Œå…¶å®å°±æ˜¯ç”¨è½¯ä»¶é©±åŠ¨ç¡¬ä»¶ï¼Œè®©ç¡¬ä»¶åœ¨è¿è¡Œæ—¶èƒ½å¤Ÿé«˜æ•ˆååŒï¼Œå……åˆ†å‹æ¦¨æ¯ä¸€ç±»ç¡¬ä»¶èµ„æºçš„â€œå‰©ä½™ä»·å€¼â€ã€‚æœ€æ—©åœ¨IBMé‚£ä¼šï¼Œå¯èƒ½æ˜¯2011å¹´å§ï¼Œæˆ‘ä»¬åšIBMæ™ºèƒ½åˆ†æç³»ç»Ÿä¸€ä½“æœºï¼Œå°±æ˜¯ç”¨è½¯ç¡¬æ­é…çš„æ–¹å¼åšæ•°ä»“ã€‚é‚£ä¼šå¯¹äºç¡¬ä»¶èµ„æºçš„ååŒï¼Œæˆ‘ä»¬ç”šè‡³æœ‰é‡åŒ–çš„æ¯”ä¾‹ï¼Œæˆ‘è®°å¾—æ˜¯1:4:8ï¼Œ1cpuï¼š4gå†…å­˜ï¼š8å—SASç›˜ã€‚é‚£ä¼šå¾ˆæ—©äº†ï¼Œè¿˜ç”¨RAIDé˜µåˆ—æ¥æé«˜I/Oæ•ˆç‡ï¼Œå½“æ—¶ç½‘ç»œç”¨äº†æœ€é«˜é…ç½®ï¼Œåº”è¯¥æ˜¯ä¸‡å…†ç½‘æˆ‘è®°å¾—ã€‚è™½ç„¶è¯´åœºæ™¯ä¸åŒï¼Œä½†æ˜¯ä»¥ç¡¬ä»¶èµ„æºå¹³è¡¡ä¸ºå¯¼å‘çš„æ€è·¯ï¼Œå¦‚å‡ºä¸€è¾™ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616050766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359327,"discussion_content":"åˆ«å®¢æ°”ï¼Œä»¥åå¤šè®¨è®ºå“ˆï½ 2:3:5ã€‚è®¨è®ºå äº†ä¸‰æˆï¼Œä¸€èµ·åŠ æ²¹ï¼Œç©è½¬Sparkï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616162677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1263546,"avatar":"https://static001.geekbang.org/account/avatar/00/13/47/ba/d36340c1.jpg","nickname":"Shockang","note":"","ucode":"B871D731F6E6B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359173,"discussion_content":"æ„Ÿè°¢è€å¸ˆçš„ç»éªŒåˆ†äº«ï¼Œä¹Ÿå¸Œæœ›ä»Šåçš„ä¸“æ é‡Œé¢èƒ½æœ‰ä¸€äº›ç»“åˆå®é™…å¼€å‘è¿›è¡Œè°ƒä¼˜çš„ç»éªŒåˆ†äº«ğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616127586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294663,"user_name":"Geek_32772e","can_delete":false,"product_type":"c1","uid":1446158,"ip_address":"","ucode":"2850EF64F4775F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoribOUgcicu1sOqZZVtPqpSDSS43vicxW0GesxQeBRjUC47CzulKSzYNj2aMg9YOZDdjPdAZxS3jNcQ/132","comment_is_top":false,"comment_ctime":1622036728,"is_pvip":false,"replies":[{"id":"106958","content":"å¤ªå¤šäº†ï¼Œå¯ä»¥éšä¾¿åœ¨æœç´¢å¼•æ“é‡Œé¢æœâ€œSpark UDF performanceâ€ä¹‹ç±»çš„å…³é”®å­—ï¼Œï¼ˆç”¨Googleæˆ–æ˜¯Bingçš„å›½é™…ç‰ˆï¼‰ï¼Œæ¯”å¦‚è¿™é‡Œï¼šhttps:&#47;&#47;stackoverflow.com&#47;questions&#47;38296609&#47;spark-functions-vs-udf-performanceï¼Œéå¸¸è¯¦å°½åœ°ä»‹ç»äº†UDFä¸SparkåŸç”Ÿçš„SQL functionsæ€§èƒ½å·®åœ¨å“ªé‡Œ~<br><br>å¦å¤–ï¼Œå»ºè®®å…³æ³¨Databrickså®˜æ–¹çš„æŠ€æœ¯åšå®¢ï¼Œé‡Œé¢ä¹Ÿæœ‰å‡ ç¯‡è®²åˆ°UDFä¸SparkåŸç”ŸSQL functionsä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œæˆ‘ç¨åç¿»åˆ°äº†å†å‘ç»™ä½ ~<br>","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1622042283,"ip_address":"","comment_id":294663,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18801905912","product_id":100073401,"comment_content":"å´è€å¸ˆï¼Œæˆ‘æ²¡å¬è¯´è¿‡æœ‰æ–‡ç« è¯´ä¸å»ºè®®ä½¿ç”¨UDFï¼Œæ‚¨èƒ½ç»™æˆ‘å‘å‡ ä¸ªé“¾æ¥è¯å®ä¸‹å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520760,"discussion_content":"å¤ªå¤šäº†ï¼Œå¯ä»¥éšä¾¿åœ¨æœç´¢å¼•æ“é‡Œé¢æœâ€œSpark UDF performanceâ€ä¹‹ç±»çš„å…³é”®å­—ï¼Œï¼ˆç”¨Googleæˆ–æ˜¯Bingçš„å›½é™…ç‰ˆï¼‰ï¼Œæ¯”å¦‚è¿™é‡Œï¼šhttps://stackoverflow.com/questions/38296609/spark-functions-vs-udf-performanceï¼Œéå¸¸è¯¦å°½åœ°ä»‹ç»äº†UDFä¸SparkåŸç”Ÿçš„SQL functionsæ€§èƒ½å·®åœ¨å“ªé‡Œ~\n\nå¦å¤–ï¼Œå»ºè®®å…³æ³¨Databrickså®˜æ–¹çš„æŠ€æœ¯åšå®¢ï¼Œé‡Œé¢ä¹Ÿæœ‰å‡ ç¯‡è®²åˆ°UDFä¸SparkåŸç”ŸSQL functionsä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œæˆ‘ç¨åç¿»åˆ°äº†å†å‘ç»™ä½ ~\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622042283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301260,"user_name":"Sandy","can_delete":false,"product_type":"c1","uid":1239815,"ip_address":"","ucode":"3097343BDAB831","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKkpApOjdIb81ZHxeAup1IGH97eaD8oiawlCtUJdvct1AP6UfmmpYlE6r25tNM5cgOCgM3oAzpic5Aw/132","comment_is_top":false,"comment_ctime":1625608611,"is_pvip":false,"replies":[{"id":"109463","content":"å¥½é—®é¢˜ï¼Œè¿™éƒ¨åˆ†å’±ä»¬ä¸»è¦æ˜¯ç»™å‡ºäº†æ–¹æ³•è®ºï¼Œç¡®å®æ²¡æœ‰ä»‹ç»å…·ä½“çš„ç›‘æ§æ–¹æ³•ã€‚æ˜¯è¿™æ ·çš„ï¼Œä¸€èˆ¬å®šä½æ€§èƒ½ç“¶é¢ˆï¼Œæˆ‘ä»¬éƒ½ä¼šä»ç¡¬ä»¶çš„è®¡ç®—èµ„æºå‡ºå‘ã€‚æˆ‘ä»¬å¾€å¾€æŠŠä¸€é¡¹æ“ä½œã€æˆ–è€…è®¡ç®—ï¼Œå½’ç±»ä¸ºCPUå¯†é›†å‹ã€å†…å­˜å¯†é›†å‹ã€I&#47;Oå¯†é›†å‹å’Œç½‘ç»œå¯†é›†å‹ã€‚å¯¹äºä¸åŒç¡¬ä»¶èµ„æºçš„æ¶ˆè€—ï¼Œæˆ‘ä»¬ä¼šæ¨èä½¿ç”¨ä¸åŒçš„ç³»ç»Ÿå‘½ä»¤ï¼Œæˆ–æ˜¯å¯è§†åŒ–çš„ç›‘æ§å·¥å…·ï¼ˆå¦‚Gangliaã€Prometheusç­‰ï¼‰ï¼Œå·¥å…·è¿™å—å’±ä»¬æ–‡ä¸­æœ‰ä¸¾ä¾‹ã€‚<br><br>è¿™å—ä¸å¤ªå¥½è®²ï¼Œéš¾ç‚¹åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆéå¸¸å…·ä½“çš„casesï¼Œæ¥ä»‹ç»å…·ä½“çš„æ–¹æ³•ï¼Œä½†æ˜¯ä»‹ç»çš„æ–¹æ³•ï¼Œä¸è§å¾—é€‚ç”¨ä½ æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„casesã€‚æ‰€ä»¥å’±ä»¬åªæŠ›å‡ºäº†æ–¹æ³•è®ºï¼Œå´æ²¡æœ‰æ·±å…¥ä»‹ç»å…·ä½“çš„æ–¹æ³•ã€‚<br><br>ä¸è¿‡ï¼Œå…¶å®å³ä¾¿æ²¡æœ‰è¿™äº›å·¥å…·è¾…åŠ©ï¼Œæˆ–è€…æ²¡æœ‰æ¡ˆä¾‹åˆ†æï¼Œç»“åˆç»éªŒï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤§æ¦‚çŸ¥é“å“ªäº›æ“ä½œå±äºå“ªç§å¯†é›†å‹æ“ä½œï¼Œä»è€Œæœ‰çš„æ”¾çŸ¢åœ°å»è°ƒæ•´ä¸åŒèµ„æºæ¶ˆè€—çš„å¹³è¡¡ï¼Œæ¯”æ–¹è¯´ï¼š<br><br>CPUå¯†é›†å‹ï¼šï¼ˆè§£ï¼‰å‹ç¼©ã€ï¼ˆåï¼‰åºåˆ—åŒ–ã€hashã€æ’åº<br>å†…å­˜å¯†é›†å‹ï¼šå¤§é‡çš„RDD Cacheã€DataFrame Cacheã€æ•°æ®å€¾æ–œåœºæ™¯ï¼Œç­‰ç­‰<br>ç£ç›˜å¯†é›†å‹ï¼šShuffle<br>ç½‘ç»œå¯†é›†å‹ï¼šShuffle<br><br>å®é™…ä¸Šï¼Œä¸æ­¢æ˜¯ç£ç›˜ä¸ç½‘ç»œï¼ŒShuffleä¼šæ¶ˆè€—æ‰€æœ‰çš„è®¡ç®—èµ„æºï¼Œå› æ­¤ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨Sparkçš„åº”ç”¨å½“ä¸­ï¼Œ99%çš„æ€§èƒ½ç“¶é¢ˆï¼Œéƒ½æ¥è‡ªShuffleã€‚å› æ­¤ï¼Œä¸€æ—¦æŠŠShuffleè¿™å¤´æ‹¦è·¯è™å¹²æ‰ï¼Œæ€§èƒ½å¾€å¾€å‘ˆæ•°é‡çº§åœ°æå‡ã€‚<br><br>ä¸œä¸€æ¦”å¤´ã€è¥¿ä¸€æ£’å­ï¼Œè¯´çš„æœ‰ç‚¹ä¹±ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½å›ç­”ä½ çš„å›°æƒ‘ï¼Œæœ‰é—®é¢˜å†è®¨è®ºå“ˆ~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1626250177,"ip_address":"","comment_id":301260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14510510499","product_id":100073401,"comment_content":"è€å¸ˆï¼Œå·²ç»å­¦å®Œè¯¾äº†ï¼Œå‘ç°æ²¡æœ‰è®²è¿è¡Œæ—¶è¯Šæ–­åˆ†ææå®šä½æ€§èƒ½ç“¶é¢ˆå‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522946,"discussion_content":"å¥½é—®é¢˜ï¼Œè¿™éƒ¨åˆ†å’±ä»¬ä¸»è¦æ˜¯ç»™å‡ºäº†æ–¹æ³•è®ºï¼Œç¡®å®æ²¡æœ‰ä»‹ç»å…·ä½“çš„ç›‘æ§æ–¹æ³•ã€‚æ˜¯è¿™æ ·çš„ï¼Œä¸€èˆ¬å®šä½æ€§èƒ½ç“¶é¢ˆï¼Œæˆ‘ä»¬éƒ½ä¼šä»ç¡¬ä»¶çš„è®¡ç®—èµ„æºå‡ºå‘ã€‚æˆ‘ä»¬å¾€å¾€æŠŠä¸€é¡¹æ“ä½œã€æˆ–è€…è®¡ç®—ï¼Œå½’ç±»ä¸ºCPUå¯†é›†å‹ã€å†…å­˜å¯†é›†å‹ã€I/Oå¯†é›†å‹å’Œç½‘ç»œå¯†é›†å‹ã€‚å¯¹äºä¸åŒç¡¬ä»¶èµ„æºçš„æ¶ˆè€—ï¼Œæˆ‘ä»¬ä¼šæ¨èä½¿ç”¨ä¸åŒçš„ç³»ç»Ÿå‘½ä»¤ï¼Œæˆ–æ˜¯å¯è§†åŒ–çš„ç›‘æ§å·¥å…·ï¼ˆå¦‚Gangliaã€Prometheusç­‰ï¼‰ï¼Œå·¥å…·è¿™å—å’±ä»¬æ–‡ä¸­æœ‰ä¸¾ä¾‹ã€‚\n\nè¿™å—ä¸å¤ªå¥½è®²ï¼Œéš¾ç‚¹åœ¨äºï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆéå¸¸å…·ä½“çš„casesï¼Œæ¥ä»‹ç»å…·ä½“çš„æ–¹æ³•ï¼Œä½†æ˜¯ä»‹ç»çš„æ–¹æ³•ï¼Œä¸è§å¾—é€‚ç”¨ä½ æ—¥å¸¸å¼€å‘ä¸­é‡åˆ°çš„casesã€‚æ‰€ä»¥å’±ä»¬åªæŠ›å‡ºäº†æ–¹æ³•è®ºï¼Œå´æ²¡æœ‰æ·±å…¥ä»‹ç»å…·ä½“çš„æ–¹æ³•ã€‚\n\nä¸è¿‡ï¼Œå…¶å®å³ä¾¿æ²¡æœ‰è¿™äº›å·¥å…·è¾…åŠ©ï¼Œæˆ–è€…æ²¡æœ‰æ¡ˆä¾‹åˆ†æï¼Œç»“åˆç»éªŒï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤§æ¦‚çŸ¥é“å“ªäº›æ“ä½œå±äºå“ªç§å¯†é›†å‹æ“ä½œï¼Œä»è€Œæœ‰çš„æ”¾çŸ¢åœ°å»è°ƒæ•´ä¸åŒèµ„æºæ¶ˆè€—çš„å¹³è¡¡ï¼Œæ¯”æ–¹è¯´ï¼š\n\nCPUå¯†é›†å‹ï¼šï¼ˆè§£ï¼‰å‹ç¼©ã€ï¼ˆåï¼‰åºåˆ—åŒ–ã€hashã€æ’åº\nå†…å­˜å¯†é›†å‹ï¼šå¤§é‡çš„RDD Cacheã€DataFrame Cacheã€æ•°æ®å€¾æ–œåœºæ™¯ï¼Œç­‰ç­‰\nç£ç›˜å¯†é›†å‹ï¼šShuffle\nç½‘ç»œå¯†é›†å‹ï¼šShuffle\n\nå®é™…ä¸Šï¼Œä¸æ­¢æ˜¯ç£ç›˜ä¸ç½‘ç»œï¼ŒShuffleä¼šæ¶ˆè€—æ‰€æœ‰çš„è®¡ç®—èµ„æºï¼Œå› æ­¤ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨Sparkçš„åº”ç”¨å½“ä¸­ï¼Œ99%çš„æ€§èƒ½ç“¶é¢ˆï¼Œéƒ½æ¥è‡ªShuffleã€‚å› æ­¤ï¼Œä¸€æ—¦æŠŠShuffleè¿™å¤´æ‹¦è·¯è™å¹²æ‰ï¼Œæ€§èƒ½å¾€å¾€å‘ˆæ•°é‡çº§åœ°æå‡ã€‚\n\nä¸œä¸€æ¦”å¤´ã€è¥¿ä¸€æ£’å­ï¼Œè¯´çš„æœ‰ç‚¹ä¹±ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½å›ç­”ä½ çš„å›°æƒ‘ï¼Œæœ‰é—®é¢˜å†è®¨è®ºå“ˆ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626250177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287379,"user_name":"è–›å³°","can_delete":false,"product_type":"c1","uid":2546023,"ip_address":"","ucode":"DA8CAF1473D2B9","user_header":"https://static001.geekbang.org/account/avatar/00/26/d9/67/9bca6a6e.jpg","comment_is_top":false,"comment_ctime":1617917338,"is_pvip":false,"replies":[{"id":"104396","content":"1. å¯¹ï¼Œä¸¤ä¸ªä¸é”™çš„ç›‘æ§å·¥å…·ï½ è¿è¡Œæ—¶ç›‘æ§ç³»ç»Ÿåˆ©ç”¨ç‡ã€‚å¦å¤–ï¼Œsparkåº”è¯¥è‡ªåŠ¨æ¸…é™¤ä¸´æ—¶ç›®å½•ï¼Œå¬ä¸Šå»æ˜¯ä¸ªbugã€‚<br><br>2. åéªŒæ˜¯æœ€å®åœ¨çš„æ–¹å¼ï¼Œä¸è¿‡è¿™å—ï¼Œå°±åƒä½ è¯´çš„ï¼Œè¦æ³¨æ„ç³»ç»Ÿè¯¯å·®ï¼Œä¹Ÿå°±æ˜¯ä½ å¾—ä¿è¯næ¬¡å°è¯•çš„è¿è¡Œæ—¶ç¯å¢ƒæ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™çš„è¯å¾ˆéš¾åˆ¤æ–­ï¼Œæ˜¯è°ƒä¼˜çš„ä½œç”¨ï¼Œè¿˜æ˜¯ç³»ç»Ÿå˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617954428,"ip_address":"","comment_id":287379,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14502819226","product_id":100073401,"comment_content":"ç¬¬ä¸€ä¸ªä¼°è®¡å¤§å®¶éƒ½æœ‰è¿‡é‚£æ ·çš„ç»éªŒ<br>ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ç”¨è¿‡ä¸¤ç§æ–¹æ³•ï¼š<br>1. ç”¨Prometheus+grafanaç›‘æ§ç³»ç»Ÿåˆ©ç”¨æƒ…å†µã€‚ç»“æœæ„å¤–å‘ç°sparkä¸ä¼šè‡ªåŠ¨æ¸…é™¤åº”ç”¨ç›®å½•ï¼Œå¯¼è‡´è¿‡æ®µæ—¶é—´ç£ç›˜éƒ½è¢«å¡æ»¡äº†ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºsparké…ç½®çš„é”™è¯¯å¯¼è‡´çš„ï¼Ÿ<br>2. ç”¨ä¸åŒçš„å‚æ•°è·‘åŒæ ·çš„æ•°æ®Næ¬¡ï¼Œç„¶åå¹³å‡å¤„ç†æ—¶é—´ï¼Œçœ‹çœ‹å“ªç§æœ€çŸ­ã€‚ä½†ç»å¸¸ä¼šå‘ç°è¿™ä¸ªè¿ç®—æ—¶é—´æœ‰è¾ƒå¤§å¹…åº¦çš„æµ®åŠ¨ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯è·Ÿawsç³»ç»Ÿæ•´ä½“çš„å¿™é—²æœ‰å…³ã€‚","like_count":4,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518282,"discussion_content":"1. å¯¹ï¼Œä¸¤ä¸ªä¸é”™çš„ç›‘æ§å·¥å…·ï½ è¿è¡Œæ—¶ç›‘æ§ç³»ç»Ÿåˆ©ç”¨ç‡ã€‚å¦å¤–ï¼Œsparkåº”è¯¥è‡ªåŠ¨æ¸…é™¤ä¸´æ—¶ç›®å½•ï¼Œå¬ä¸Šå»æ˜¯ä¸ªbugã€‚\n\n2. åéªŒæ˜¯æœ€å®åœ¨çš„æ–¹å¼ï¼Œä¸è¿‡è¿™å—ï¼Œå°±åƒä½ è¯´çš„ï¼Œè¦æ³¨æ„ç³»ç»Ÿè¯¯å·®ï¼Œä¹Ÿå°±æ˜¯ä½ å¾—ä¿è¯næ¬¡å°è¯•çš„è¿è¡Œæ—¶ç¯å¢ƒæ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™çš„è¯å¾ˆéš¾åˆ¤æ–­ï¼Œæ˜¯è°ƒä¼˜çš„ä½œç”¨ï¼Œè¿˜æ˜¯ç³»ç»Ÿå˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617954428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283835,"user_name":"L3nvy","can_delete":false,"product_type":"c1","uid":1271157,"ip_address":"","ucode":"0B74B27C121D56","user_header":"https://static001.geekbang.org/account/avatar/00/13/65/75/f9d7e8b7.jpg","comment_is_top":false,"comment_ctime":1615950464,"is_pvip":false,"replies":[{"id":"102967","content":"æ²¡é”™ï¼Œ1æ˜¯å…¸å‹çš„ç›²ç›®è°ƒä¼˜ï¼Œ2çš„æ€è·¯å¾ˆèµï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1615958324,"ip_address":"","comment_id":283835,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10205885056","product_id":100073401,"comment_content":"1. ä¸çŸ¥é“æ€ä¹ˆåˆ†ææ€§èƒ½ç“¶é¢ˆé—®é¢˜ï¼ŒæŒ‰ç…§è‡ªå·±çš„ç†è§£æŠŠä¸šåŠ¡é€»è¾‘Spark SQLé‡å†™äº†ä¸€éï¼Œè™½ç„¶æ—¶é—´ä¸‹é™äº†ï¼Œä½†æ˜¯å¼•å…¥äº†æ•°æ®è´¨é‡ç­‰é—®é¢˜ã€‚<br>2. éœ€è¦ç›‘æ§ç»„ä»¶å¯¹æœºå™¨çš„çŠ¶æ€å’Œç³»ç»Ÿmetricsè¿›è¡Œæ”¶é›†å¯¹æ¯”ä¼˜åŒ–æ•ˆæœ","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517159,"discussion_content":"æ²¡é”™ï¼Œ1æ˜¯å…¸å‹çš„ç›²ç›®è°ƒä¼˜ï¼Œ2çš„æ€è·¯å¾ˆèµï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615958324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290918,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1619859776,"is_pvip":false,"replies":[{"id":"105437","content":"å¯¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯éå¸¸çš„å…¸å‹case~<br>ç¬¬äºŒä¸ªç›‘æ§ä¹Ÿæ²¡é—®é¢˜ï¼Œå¯ä»¥ç»“åˆä½ è¯´çš„è¿™äº›å·¥å…·ï¼Œå¯¹ç¡¬ä»¶èµ„æºçš„æ¶ˆè€—æƒ…å†µè¿›è¡Œé‡åŒ–ç›‘æ§ï¼Œç°åœ¨çš„UIéƒ½åšå¾—æ¯”è¾ƒåˆ°ä½äº†ï¼ŒæŒ‡æ ‡æ—¢ä¸°å¯Œåˆç›´è§‚ã€‚<br><br>å¦å¤–ï¼Œåé¢çš„ç« èŠ‚å®‰æ’ï¼Œå¤§ä½“ä¸Šå°±æ˜¯æŒ‰ç…§ä½ è¯´çš„æ€è·¯å±•å¼€çš„å“ˆ~ ğŸ˜","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1619947203,"ip_address":"","comment_id":290918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5914827072","product_id":100073401,"comment_content":"1. æœ€åˆåœ¨å†™Sparkåº”ç”¨çš„æ—¶å€™ï¼Œç½‘ä¸Šæœä¸€äº›è°ƒä¼˜æ‰‹æ®µï¼ŒåŠ¨ä¸åŠ¨å°±æ˜¯è®©å¢åŠ å†…å­˜ã€å¢åŠ CPUï¼Œä»€ä¹ˆé—®é¢˜éƒ½æ˜¯å¢åŠ å†…å­˜CPU<br>2. å¦‚æœæ˜¯æ­å»ºçš„CDHå¹³å°çš„è¯ï¼Œå¯ä»¥ç»“åˆSpark WebUIå’ŒCloudera Manager Web UIåšä¸€äº›ç›‘æ§èµ„æºçš„å¯¹æ¯”ï¼Œæ¯”å¦‚ä»»åŠ¡è¿è¡Œæ—¶é—´ã€cpuä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ç­‰æŒ‡æ ‡ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥å®‰è£…Prometheus+Grafanaè¿›è¡Œæ›´ç²¾ç»†åŒ–çš„ç›‘æ§ã€‚<br><br>å¸Œæœ›è€å¸ˆåœ¨ä¹‹åçš„ç¯‡ç« ä¸­ï¼Œè®²å…·ä½“è°ƒä¼˜æ–¹æ³•çš„æ—¶å€™ï¼Œèƒ½å¤šç»“åˆä¸€ä¸‹åŸç†å’Œæºç æ¥åˆ†æä¸‹ä¸ºä»€ä¹ˆè¦è¿™æ ·è°ƒä¼˜ã€‚","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519323,"discussion_content":"å¯¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯éå¸¸çš„å…¸å‹case~\nç¬¬äºŒä¸ªç›‘æ§ä¹Ÿæ²¡é—®é¢˜ï¼Œå¯ä»¥ç»“åˆä½ è¯´çš„è¿™äº›å·¥å…·ï¼Œå¯¹ç¡¬ä»¶èµ„æºçš„æ¶ˆè€—æƒ…å†µè¿›è¡Œé‡åŒ–ç›‘æ§ï¼Œç°åœ¨çš„UIéƒ½åšå¾—æ¯”è¾ƒåˆ°ä½äº†ï¼ŒæŒ‡æ ‡æ—¢ä¸°å¯Œåˆç›´è§‚ã€‚\n\nå¦å¤–ï¼Œåé¢çš„ç« èŠ‚å®‰æ’ï¼Œå¤§ä½“ä¸Šå°±æ˜¯æŒ‰ç…§ä½ è¯´çš„æ€è·¯å±•å¼€çš„å“ˆ~ ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619947203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283836,"user_name":"Gnnn","can_delete":false,"product_type":"c1","uid":1682989,"ip_address":"","ucode":"FD8F68251F819A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKeaiat2pBEQlDDyUVvIAagP0zyUwEAHeaGEVaj9s3kl4AP4ZNsZqERSY0KCkIJK0n5Nh5s7X7pgmw/132","comment_is_top":false,"comment_ctime":1615950552,"is_pvip":false,"replies":[{"id":"102966","content":"æ²¡é”™ï¼Œå¹¶è¡Œåº¦éœ€è¦ç»“åˆå¾ˆå¤šä¸œè¥¿ã€å°¤å…¶æ˜¯cpuå’Œå†…å­˜æ–¹é¢çš„é…ç½®ä¸€èµ·è°ƒæ•´ï¼Œæ‰èƒ½èµ·ä½œç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1615958184,"ip_address":"","comment_id":283836,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5910917848","product_id":100073401,"comment_content":"ç®€å•çš„å¢åŠ å¹¶è¡Œåº¦å¾ˆå¤šæ—¶å€™æ˜¯æ²¡æœ‰å¤ªå¤§æ•ˆæœçš„","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517160,"discussion_content":"æ²¡é”™ï¼Œå¹¶è¡Œåº¦éœ€è¦ç»“åˆå¾ˆå¤šä¸œè¥¿ã€å°¤å…¶æ˜¯cpuå’Œå†…å­˜æ–¹é¢çš„é…ç½®ä¸€èµ·è°ƒæ•´ï¼Œæ‰èƒ½èµ·ä½œç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615958184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315405,"user_name":"æµ©ç„¶","can_delete":false,"product_type":"c1","uid":1805991,"ip_address":"","ucode":"1F2FC08382D396","user_header":"https://static001.geekbang.org/account/avatar/00/1b/8e/a7/92d1b90e.jpg","comment_is_top":false,"comment_ctime":1633882127,"is_pvip":false,"replies":[{"id":"114421","content":"å¥½é—®é¢˜ï¼Œæˆ‘å€’ä¸è§‰å¾—æ˜¯èµ„æºè°ƒåº¦çš„é—®é¢˜ï¼Œè€Œæ˜¯ä»»åŠ¡è°ƒåº¦çš„é—®é¢˜ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œæ•ˆç‡ä¸é«˜çš„å‡ ä¸ªcaseï¼Œéƒ½æŠŠå¹¶è¡Œåº¦è®¾ç½®çš„å¾ˆå¤§ï¼Œå¹¶è¡Œåº¦é«˜å°±ä¼šå­˜åœ¨ä»»åŠ¡è°ƒåº¦å¼€é”€è¿‡å¤§çš„éšæ‚£ï¼Œä»è€Œé€ æˆCPUçœ‹ä¸Šå»å¾ˆå¿™ï¼Œä½†å¿™çš„éƒ½ä¸æ˜¯â€œæ­£äº‹â€ï¼Œéƒ½å¿™ç€å»è°ƒåº¦ä»»åŠ¡äº†ï¼Œè€Œä¸æ˜¯å¿™ç€æ‰§è¡Œä»»åŠ¡ã€‚åé¢çš„CPUåˆ©ç”¨ç‡é‚£ä¸€è®²ï¼Œä¼šè¯¦ç»†èŠè¿™äº›å†…å®¹ï¼Œä¸å¦¨å…³æ³¨ä¸€ä¸‹~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1633964977,"ip_address":"","comment_id":315405,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633882127","product_id":100073401,"comment_content":"æˆ‘æƒ³è®¨è®ºä¸€ä¸ªé—®é¢˜ã€‚é‚£ä¸ª38åˆ†é’Ÿçš„æ‰§è¡Œç»“æœï¼Œèµ„æºé…ç½®ä¸Šå¾ˆè¶³ï¼Œä½†æ˜¯æ‰§è¡Œæ•ˆç‡ä¸å¥½ã€‚èƒ½è®¤ä¸ºæ˜¯æŠŠCPUç”¨çš„å¤ªå¤šäº†ï¼Œèµ„æºè°ƒåº¦æœ‰é—®é¢˜ï¼Ÿæ¯”å¦‚CASè‡ªæ—‹é”ä»¥åŠé”å‡çº§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527957,"discussion_content":"å¥½é—®é¢˜ï¼Œæˆ‘å€’ä¸è§‰å¾—æ˜¯èµ„æºè°ƒåº¦çš„é—®é¢˜ï¼Œè€Œæ˜¯ä»»åŠ¡è°ƒåº¦çš„é—®é¢˜ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œæ•ˆç‡ä¸é«˜çš„å‡ ä¸ªcaseï¼Œéƒ½æŠŠå¹¶è¡Œåº¦è®¾ç½®çš„å¾ˆå¤§ï¼Œå¹¶è¡Œåº¦é«˜å°±ä¼šå­˜åœ¨ä»»åŠ¡è°ƒåº¦å¼€é”€è¿‡å¤§çš„éšæ‚£ï¼Œä»è€Œé€ æˆCPUçœ‹ä¸Šå»å¾ˆå¿™ï¼Œä½†å¿™çš„éƒ½ä¸æ˜¯â€œæ­£äº‹â€ï¼Œéƒ½å¿™ç€å»è°ƒåº¦ä»»åŠ¡äº†ï¼Œè€Œä¸æ˜¯å¿™ç€æ‰§è¡Œä»»åŠ¡ã€‚åé¢çš„CPUåˆ©ç”¨ç‡é‚£ä¸€è®²ï¼Œä¼šè¯¦ç»†èŠè¿™äº›å†…å®¹ï¼Œä¸å¦¨å…³æ³¨ä¸€ä¸‹~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1633964977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297144,"user_name":"è¥¿å…³å…«å·","can_delete":false,"product_type":"c1","uid":1206406,"ip_address":"","ucode":"28016BF8391F97","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/86/3ef20498.jpg","comment_is_top":false,"comment_ctime":1623328312,"is_pvip":false,"replies":[{"id":"107939","content":"å¥½çš„ï¼Œå¥½çš„~ åé¢ä¼šç”¨åŠ é¤çš„å½¢å¼ï¼ŒæŠŠSpark UIè¿™éƒ¨åˆ†è¡¥ä¸Š~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1623380125,"ip_address":"","comment_id":297144,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623328312","product_id":100073401,"comment_content":"å¸Œæœ›è€å¸ˆå¯ä»¥ç¨å¾®è®²ä¸€è®²spark UIç­‰å·¥å…·å¦‚ä½•ç›‘æ§æŒ‡æ ‡","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521733,"discussion_content":"å¥½çš„ï¼Œå¥½çš„~ åé¢ä¼šç”¨åŠ é¤çš„å½¢å¼ï¼ŒæŠŠSpark UIè¿™éƒ¨åˆ†è¡¥ä¸Š~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623380125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286429,"user_name":"FendoraèŒƒä¸œ_","can_delete":false,"product_type":"c1","uid":1187106,"ip_address":"","ucode":"63EE9DBEE08D70","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/22/f04cea4c.jpg","comment_is_top":false,"comment_ctime":1617293018,"is_pvip":false,"replies":[{"id":"104044","content":"ä¸€èˆ¬æ¥è¯´ï¼Œsql funcä¼šæ¯”udfå¼º3%ï½5%ï¼Œä¸ç­‰ã€‚ä½†è¿™åªæ˜¯ä»–ä»¬æœ¬èº«çš„å¯¹æ¯”ï¼Œå®é™…åœ¨ç«¯åˆ°ç«¯çš„ä½œä¸šèƒ½æå‡å¤šå°‘ï¼Œå…·ä½“è¿˜æœ‰çœ‹åœºæ™¯ã€‚ä½†èƒ½ç”¨sql funcå°±å°½é‡ä¸ç”¨udfæŒ‡å®šæ˜¯æ²¡é”™ï½","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1617325268,"ip_address":"","comment_id":286429,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617293018","product_id":100073401,"comment_content":"ç£Šå“¥è¯´åˆ°äº†SQL functionsæŒ‡çš„æ˜¯sparkSQLå†…ç½®å‡½æ•°å§ã€‚<br>è¿˜æåˆ°äº†udfå’Œsql functionsçš„æ€§èƒ½å·®å¼‚ï¼Œé‚£å¦‚æœæˆ‘ç”¨å†…ç½®å‡½æ•°æ–¹å¼å¼€å‘udfï¼Œç†è®ºä¸Šæ€§èƒ½å°±æ˜¯ä¸€æ ·çš„ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517984,"discussion_content":"ä¸€èˆ¬æ¥è¯´ï¼Œsql funcä¼šæ¯”udfå¼º3%ï½5%ï¼Œä¸ç­‰ã€‚ä½†è¿™åªæ˜¯ä»–ä»¬æœ¬èº«çš„å¯¹æ¯”ï¼Œå®é™…åœ¨ç«¯åˆ°ç«¯çš„ä½œä¸šèƒ½æå‡å¤šå°‘ï¼Œå…·ä½“è¿˜æœ‰çœ‹åœºæ™¯ã€‚ä½†èƒ½ç”¨sql funcå°±å°½é‡ä¸ç”¨udfæŒ‡å®šæ˜¯æ²¡é”™ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617325268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284742,"user_name":"sparkjoy","can_delete":false,"product_type":"c1","uid":1000179,"ip_address":"","ucode":"827B3116EED3B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/f3/e945e4ac.jpg","comment_is_top":false,"comment_ctime":1616458376,"is_pvip":false,"replies":[{"id":"103306","content":"å¯ä»¥è€ƒè™‘ç»“åˆgangliaåšèµ„æºç›‘æ§å“ˆï½ UIæ¯”è¾ƒç›´è§‚","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1616474629,"ip_address":"","comment_id":284742,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616458376","product_id":100073401,"comment_content":"è€å¸ˆï¼Œsparkä½œä¸šè¿è¡Œçš„ç½‘ç»œæ€§èƒ½æ€ä¹ˆç›‘æ§ï¼Ÿç›®å‰æˆ‘ä»¬åªæœ‰shuffleè¯»å†™é‡å’Œé€Ÿç‡ç›¸å…³ï¼Œè¿˜æœ‰å…¶ä»–æ‰‹æ®µå—ï¼Ÿè°¢è°¢ï¼","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517450,"discussion_content":"å¯ä»¥è€ƒè™‘ç»“åˆgangliaåšèµ„æºç›‘æ§å“ˆï½ UIæ¯”è¾ƒç›´è§‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616474629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}