{"id":529800,"title":"10｜自动化的运维管理：探究Kubernetes工作机制的奥秘","content":"<p>你好，我是Chrono。</p><p>在上一次课里，我们看到容器技术只实现了应用的打包分发，到运维真正落地实施的时候仍然会遇到很多困难，所以就需要用容器编排技术来解决这些问题，而Kubernetes是这个领域的唯一霸主，已经成为了“事实标准”。</p><p>那么，Kubernetes凭什么能担当这样的领军重任呢？难道仅仅因为它是由Google主导开发的吗？</p><p>今天我就带你一起来看看Kubernetes的内部架构和工作机制，了解它能够傲视群雄的秘密所在。</p><h2>云计算时代的操作系统</h2><p>前面我曾经说过，Kubernetes是<strong>一个生产级别的容器编排平台和集群管理系统</strong>，能够创建、调度容器，监控、管理服务器。</p><p>容器是什么？容器是软件，是应用，是进程。服务器是什么？服务器是硬件，是CPU、内存、硬盘、网卡。那么，既可以管理软件，也可以管理硬件，这样的东西应该是什么？</p><p>你也许会脱口而出：这就是一个操作系统（Operating System）！</p><p>没错，从某种角度来看，Kubernetes可以说是一个集群级别的操作系统，主要功能就是资源管理和作业调度。但Kubernetes不是运行在单机上管理单台计算资源和进程，而是运行在多台服务器上管理几百几千台的计算资源，以及在这些资源上运行的上万上百万的进程，规模要大得多。</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/a0/f1/a09709bdf35516603yy377fc599e0af1.png?wh=800x418\" alt=\"图片\" title=\"图片来自网络\"></p><p>所以，你可以把Kubernetes与Linux对比起来学习，而这个新的操作系统里自然会有一系列新名词、新术语，你也需要使用新的思维方式来考虑问题，必要的时候还得和过去的习惯“说再见”。</p><p>Kubernetes这个操作系统与Linux还有一点区别你值得注意。Linux的用户通常是两类人：<strong>Dev</strong>和<strong>Ops</strong>，而在Kubernetes里则只有一类人：<strong>DevOps</strong>。</p><p>在以前的应用实施流程中，开发人员和运维人员分工明确，开发完成后需要编写详细的说明文档，然后交给运维去部署管理，两者之间不能随便“越线”。</p><p>而在Kubernetes这里，开发和运维的界限变得不那么清晰了。由于云原生的兴起，开发人员从一开始就必须考虑后续的部署运维工作，而运维人员也需要在早期介入开发，才能做好应用的运维监控工作。</p><p>这就会导致很多Kubernetes的新用户会面临身份的转变，一开始可能会有点困难。不过不用担心，这也非常正常，任何的学习过程都有个适应期，只要过了最初的概念理解阶段就好了。</p><h2>Kubernetes的基本架构</h2><p>操作系统的一个重要功能就是抽象，从繁琐的底层事务中抽象出一些简洁的概念，然后基于这些概念去管理系统资源。</p><p>Kubernetes也是这样，它的管理目标是大规模的集群和应用，必须要能够把系统抽象到足够高的层次，分解出一些松耦合的对象，才能简化系统模型，减轻用户的心智负担。</p><p>所以，Kubernetes扮演的角色就如同一个“大师级别”的系统管理员，具有丰富的集群运维经验，独创了自己的一套工作方式，不需要太多的外部干预，就能够自主实现原先许多复杂的管理工作。</p><p>下面我们就来看看这位资深管理员的“内功心法”。</p><p>Kubernetes官网上有一张架构图，但我觉得不是太清晰、重点不突出，所以另外找了一份（<a href=\"https://medium.com/@keshiha/k8s-architecture-bb6964767c12\">图片来源</a>）。虽然这张图有点“老”，但对于我们初学Kubernetes还是比较合适的。</p><p><img src=\"https://static001.geekbang.org/resource/image/34/b7/344e0c6dc2141b12f99e61252110f6b7.png?wh=1278x704\" alt=\"图片\"></p><p>Kubernetes采用了现今流行的“<strong>控制面/数据面</strong>”（Control Plane / Data Plane）架构，集群里的计算机被称为“<strong>节点</strong>”（Node），可以是实机也可以是虚机，少量的节点用作控制面来执行集群的管理维护工作，其他的大部分节点都被划归数据面，用来跑业务应用。</p><p>控制面的节点在Kubernetes里叫做<strong>Master Node</strong>，一般简称为<strong>Master</strong>，它是整个集群里最重要的部分，可以说是Kubernetes的大脑和心脏。</p><p>数据面的节点叫做<strong>Worker Node</strong>，一般就简称为<strong>Worker</strong>或者<strong>Node</strong>，相当于Kubernetes的手和脚，在Master的指挥下干活。</p><p>Node的数量非常多，构成了一个资源池，Kubernetes就在这个池里分配资源，调度应用。因为资源被“池化”了，所以管理也就变得比较简单，可以在集群中任意添加或者删除节点。</p><p>在这张架构图里，我们还可以看到有一个kubectl，它就是Kubernetes的客户端工具，用来操作Kubernetes，但它位于集群之外，理论上不属于集群。</p><p>你可以使用命令 <code>kubectl get node</code> 来查看Kubernetes的节点状态：</p><pre><code class=\"language-plain\">kubectl get node\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/33/38/33937b919cbc5d6fe4b4e0e203415538.png?wh=1472x180\" alt=\"图片\"></p><p>可以看到当前的minikube集群里只有一个Master，那Node怎么不见了？</p><p>这是因为Master和Node的划分不是绝对的。当集群的规模较小，工作负载较少的时候，Master也可以承担Node的工作，就像我们搭建的minikube环境，它就只有一个节点，这个节点既是Master又是Node。</p><h2>节点内部的结构</h2><p>Kubernetes的节点内部也具有复杂的结构，是由很多的模块构成的，这些模块又可以分成组件（Component）和插件（Addon）两类。</p><p>组件实现了Kubernetes的核心功能特性，没有这些组件Kubernetes就无法启动，而插件则是Kubernetes的一些附加功能，属于“锦上添花”，不安装也不会影响Kubernetes的正常运行。</p><p>接下来我先来讲讲Master和Node里的组件，然后再捎带提一下插件，理解了它们的工作流程，你就会明白为什么Kubernetes有如此强大的自动化运维能力。</p><h3>Master里的组件有哪些</h3><p>Master里有4个组件，分别是<strong>apiserver</strong>、<strong>etcd</strong>、<strong>scheduler</strong>、<strong>controller-manager</strong>。</p><p><img src=\"https://static001.geekbang.org/resource/image/33/c6/330e03a66f636657c0d8695397c508c6.jpg?wh=1278x704\" alt=\"图片\"></p><p>apiserver是Master节点——同时也是整个Kubernetes系统的唯一入口，它对外公开了一系列的RESTful API，并且加上了验证、授权等功能，所有其他组件都只能和它直接通信，可以说是Kubernetes里的联络员。</p><p>etcd是一个高可用的分布式Key-Value数据库，用来持久化存储系统里的各种资源对象和状态，相当于Kubernetes里的配置管理员。注意它只与apiserver有直接联系，也就是说任何其他组件想要读写etcd里的数据都必须经过apiserver。</p><p>scheduler负责容器的编排工作，检查节点的资源状态，把Pod调度到最适合的节点上运行，相当于部署人员。因为节点状态和Pod信息都存储在etcd里，所以scheduler必须通过apiserver才能获得。</p><p>controller-manager负责维护容器和节点等资源的状态，实现故障检测、服务迁移、应用伸缩等功能，相当于监控运维人员。同样地，它也必须通过apiserver获得存储在etcd里的信息，才能够实现对资源的各种操作。</p><p>这4个组件也都被容器化了，运行在集群的Pod里，我们可以用kubectl来查看它们的状态，使用命令：</p><pre><code class=\"language-plain\">kubectl get pod -n kube-system\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/86/99/868380a89077c45c6ac1918794632399.png?wh=1862x504\" alt=\"图片\"></p><p>注意命令行里要用 <code>-n kube-system</code> 参数，表示检查“kube-system”名字空间里的Pod，至于名字空间是什么，我们后面会讲到。</p><h3>Node里的组件有哪些</h3><p>Master里的apiserver、scheduler等组件需要获取节点的各种信息才能够作出管理决策，那这些信息该怎么来呢？</p><p>这就需要Node里的3个组件了，分别是<strong>kubelet</strong>、<strong>kube-proxy</strong>、<strong>container-runtime</strong>。</p><p>kubelet是Node的代理，负责管理Node相关的绝大部分操作，Node上只有它能够与apiserver通信，实现状态报告、命令下发、启停容器等功能，相当于是Node上的一个“小管家”。</p><p>kube-proxy的作用有点特别，它是Node的网络代理，只负责管理容器的网络通信，简单来说就是为Pod转发TCP/UDP数据包，相当于是专职的“小邮差”。</p><p>第三个组件container-runtime我们就比较熟悉了，它是容器和镜像的实际使用者，在kubelet的指挥下创建容器，管理Pod的生命周期，是真正干活的“苦力”。</p><p><img src=\"https://static001.geekbang.org/resource/image/87/35/87bab507ce8381325e85570f3bc1d935.jpg?wh=1278x704\" alt=\"图片\"></p><p>我们一定要注意，因为Kubernetes的定位是容器编排平台，所以它没有限定container-runtime必须是Docker，完全可以替换成任何符合标准的其他容器运行时，例如containerd、CRI-O等等，只不过在这里我们使用的是Docker。</p><p>这3个组件中只有kube-proxy被容器化了，而kubelet因为必须要管理整个节点，容器化会限制它的能力，所以它必须在container-runtime之外运行。</p><p>使用 <code>minikube ssh</code> 命令登录到节点后，可以用 <code>docker ps</code> 看到kube-proxy：</p><pre><code class=\"language-plain\">minikube ssh\ndocker ps |grep kube-proxy\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/1f/a4/1f08490fd66c91b4f5d2172d2d93eba4.png?wh=1920x141\" alt=\"图片\"></p><p>而kubelet用 <code>docker ps</code> 是找不到的，需要用操作系统的 <code>ps</code> 命令：</p><pre><code class=\"language-plain\">ps -ef|grep kubelet\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/ay/28/ayy7246d222fa723f5f4a1f8edc0eb28.png?wh=1920x95\" alt=\"图片\"></p><p>现在，我们再把Node里的组件和Master里的组件放在一起来看，就能够明白Kubernetes的大致工作流程了：</p><ul>\n<li>每个Node上的kubelet会定期向apiserver上报节点状态，apiserver再存到etcd里。</li>\n<li>每个Node上的kube-proxy实现了TCP/UDP反向代理，让容器对外提供稳定的服务。</li>\n<li>scheduler通过apiserver得到当前的节点状态，调度Pod，然后apiserver下发命令给某个Node的kubelet，kubelet调用container-runtime启动容器。</li>\n<li>controller-manager也通过apiserver得到实时的节点状态，监控可能的异常情况，再使用相应的手段去调节恢复。</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/34/b7/344e0c6dc2141b12f99e61252110f6b7.png?wh=1278x704\" alt=\"图片\"></p><p>其实，这和我们在Kubernetes出现之前的操作流程也差不了多少，但Kubernetes的高明之处就在于把这些都抽象化规范化了。</p><p>于是，这些组件就好像是无数个不知疲倦的运维工程师，把原先繁琐低效的人力工作搬进了高效的计算机里，就能够随时发现集群里的变化和异常，再互相协作，维护集群的健康状态。</p><h3>插件（Addons）有哪些</h3><p>只要服务器节点上运行了apiserver、scheduler、kubelet、kube-proxy、container-runtime等组件，就可以说是一个功能齐全的Kubernetes集群了。</p><p>不过就像Linux一样，操作系统提供的基础功能虽然“可用”，但想达到“好用”的程度，还是要再安装一些附加功能，这在Kubernetes里就是插件（Addon）。</p><p>由于Kubernetes本身的设计非常灵活，所以就有大量的插件用来扩展、增强它对应用和集群的管理能力。</p><p>minikube也支持很多的插件，使用命令 <code>minikube addons list</code> 就可以查看插件列表：</p><pre><code class=\"language-plain\">minikube addons list\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/db/2f/dbd588f0cca1ffb93a702a6d4c8f4c2f.png?wh=1920x987\" alt=\"图片\"></p><p>插件中我个人认为比较重要的有两个：<strong>DNS</strong>和<strong>Dashboard</strong>。</p><p>DNS你应该比较熟悉吧，它在Kubernetes集群里实现了域名解析服务，能够让我们以域名而不是IP地址的方式来互相通信，是服务发现和负载均衡的基础。由于它对微服务、服务网格等架构至关重要，所以基本上是Kubernetes的必备插件。</p><p>Dashboard就是仪表盘，为Kubernetes提供了一个图形化的操作界面，非常直观友好，虽然大多数Kubernetes工作都是使用命令行kubectl，但有的时候在Dashboard上查看信息也是挺方便的。</p><p>你只要在minikube环境里执行一条简单的命令，就可以自动用浏览器打开Dashboard页面，而且还支持中文：</p><pre><code class=\"language-plain\">minikube dashboard\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/60/e6/6077ff98a11705448f875ee00a1d8de6.png?wh=1920x957\" alt=\"图片\"></p><h2>小结</h2><p>好了，今天我们一起来研究了Kubernetes的内部架构和工作机制，可以看到它的功能非常完善，实现了大部分常见的运维管理工作，而且是全自动化的，能够节约大量的人力成本。</p><p>由于Kubernetes的抽象程度比较高，有很多陌生的新术语，不太好理解，所以我画了一张思维导图，你可以对照着再加深理解。</p><p><img src=\"https://static001.geekbang.org/resource/image/65/e1/65d38ac50b4f2f1fd4b6700d5b8e7be1.jpg?wh=1920x1096\" alt=\"图片\"></p><p>最后小结一下今天的要点：</p><ol>\n<li>Kubernetes能够在集群级别管理应用和服务器，可以认为是一种集群操作系统。它使用“控制面/数据面”的基本架构，Master节点实现管理控制功能，Worker节点运行具体业务。</li>\n<li>Kubernetes由很多模块组成，可分为核心的组件和选配的插件两类。</li>\n<li>Master里有4个组件，分别是apiserver、etcd、scheduler、controller-manager。</li>\n<li>Node里有3个组件，分别是kubelet、kube-proxy、container-runtime。</li>\n<li>通常必备的插件有DNS和Dashboard。</li>\n</ol><h2>课下作业</h2><p>最后是课下作业时间，给你留两个思考题：</p><ol>\n<li>你觉得Kubernetes算得上是一种操作系统吗？和真正的操作系统相比有什么差异？</li>\n<li>说说你理解的Kubernetes组件的作用，你觉得哪几个最重要？</li>\n</ol><p>欢迎积极留言或者提问，和其他同学一起参与讨论，我们下节课见。</p><p><img src=\"https://static001.geekbang.org/resource/image/63/e5/6390bdf6a447f77726866d95df1eafe5.jpg?wh=1920x2580\" alt=\"\"></p>","neighbors":{"left":{"article_title":"09｜走近云原生：如何在本机搭建小巧完备的Kubernetes环境","id":529780},"right":{"article_title":"11｜YAML：Kubernetes世界里的通用语","id":529813}},"comments":[{"had_liked":false,"id":351486,"user_name":"自由","can_delete":false,"product_type":"c1","uid":2576960,"ip_address":"","ucode":"4E3B53D29D86CA","user_header":"https://static001.geekbang.org/account/avatar/00/27/52/40/db9b0eb2.jpg","comment_is_top":false,"comment_ctime":1657847208,"is_pvip":false,"replies":[{"id":127837,"content":"amazing!","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657851185,"ip_address":"","comment_id":351486,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1. Kubernetes 算得上是一种操作系统吗？\n算。什么是 OS，例如在物理服务器上，它用于对物理服务器硬件资源的抽象，并对进程进行调度等等。那么 Kubernetes 就是对云上资源的抽象，并对云原生微服务应用进行调度。Kubernetes 可以对公有云、私有云进行统一抽象，并实现对负载的无缝迁移和均衡，不会永远被绑定在某一个特定的云上。\nOS，能屏蔽底层的复杂性，例如 Linux ，我们不用关心程序运行在哪个 CPU 核心上，OS 已经搞定了。Kubernetes 对云和应用程序进行了类似的管理，无须明确对应用程序在哪个节点或存储卷上进行硬编程。\n\n2.我理解的 Kubernetes 组件的作用\n2.1 主节点上的组件\n2.1.1 API Server\n负责集群中所有组件通信。访问它必须经过授权于认证。\n\n2.1.2 集群存储\n在控制平面中，只有集群存储是有状态的（会持久化的意思），存储集群的配置与状态。Kubernetes 底层用 etcd。etcd 认为一致性比可用性更加重要。对于所有分布式数据库，写操作性的一致性至关重要。etcd 使用 Raft 一致性算法解决这个问题。\n\n2.1.3 Controller 管理器\nController 管理器实现了控制循环，完成集群监控与事件响应。它负责创建 controller。一般控制循环包括：工作节点 controller、终端 controller 以及副本 controller。集群监控目的是保证集群当前状态与期望状态相匹配。集群监控基础逻辑大致如下：\n* 获取期望状态。\n* 观察当前状态。\n* 判断差异。\n* 变更消除差异点。\n\n2.1.4 调度器\n调度器职责是监听 API Server 来启动工作任务，并分配合适的节点。它的核心是排序系统，该系统有评分机制，将工作分配到分数最高的节点来运行任务。调度器确定可以执行任务的节点后，还会再进行前置校验，例如该节点是否仍然存在、分配的任务需要的端口当前选择的工作节点是否可以访问等，如果无法通过，该节点会被直接忽略，如果调度器最后无法找到合适的工作节点，则当前任务无法被调度，并被标记为暂停状态。 需要特别注意，调度器不负责运行任务，只为任务负责分配合适的工作节点。\n\n2.2 工作节点上的组件\n\n2.2.1 Kubelet\n工作节点的核心部分。新工作节点加入节点后，Kubelet 会被部署到新节点，然后 Kubelet 将当前节点注册到集群中。它还有一个职责，监听 API Server 分配的任务，监听到就执行该任务，并维护一个与控制平面的通信频道。\n\n2.2.2 容器运行时\n工作节点需要通过它来获取、启动、停止执行任务依赖的容器，它负责容器管理与运行逻辑。","like_count":61,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580052,"discussion_content":"amazing!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657851185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3786904,"avatar":"","nickname":"Geek_85c599","note":"","ucode":"93648B73E8C074","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":639036,"discussion_content":"太精辟了，把计算机节点当作一个CPU核心！！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1710210256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"中国香港","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1265707,"avatar":"https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg","nickname":"第一装甲集群司令克莱斯特","note":"","ucode":"4E8FBB23AD860B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":592215,"discussion_content":"课代表来了！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667209005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1807943,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/96/47/93838ff7.jpg","nickname":"青鸟飞鱼","note":"","ucode":"8C64517DA556FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588161,"discussion_content":"很厉害的总结","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663581134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"四川","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1660330,"avatar":"https://static001.geekbang.org/account/avatar/00/19/55/aa/a84c375b.jpg","nickname":"武安君","note":"","ucode":"81CC93A6D7A4BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583638,"discussion_content":"牛","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660265357,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581320,"discussion_content":"同学总结的真不错！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658720705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352480,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1658720993,"is_pvip":false,"replies":[{"id":128215,"content":"\n1.不能，etcd是分布式的，性能自然没有Redis好，用途不同。\n\n2.是的，不过也可以找准方向，没有必要什么都学，和Linux开发一样，先有个基础。\n\n3.是的，和http里的age差不多\n\n4.对。dns已经是必备插件了，不用单独安装。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658730957,"ip_address":"","comment_id":352480,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师，有几个小问题：\n\n1. etcd能取代redis的大部分功能吗？\n\n2.  在 Kubernetes 里则只有一类人：DevOps。是不是意味着以后对开发或者运维人员都有更大的挑战，毕竟Kubernetes的也很很庞杂的知识要去学习。\n\n3. 状态信息中的“AGE”代表启动时长吗？\n\n4. DNS插件在执行命令：minikube addons list 输出的列表中没看到。是不是说这个插件已经集成到k8s中了，不需要单独安装。","like_count":12,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581341,"discussion_content":"\n1.不能，etcd是分布式的，性能自然没有Redis好，用途不同。\n\n2.是的，不过也可以找准方向，没有必要什么都学，和Linux开发一样，先有个基础。\n\n3.是的，和http里的age差不多\n\n4.对。dns已经是必备插件了，不用单独安装。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658730957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352026,"user_name":"hiDaLao","can_delete":false,"product_type":"c1","uid":2917100,"ip_address":"","ucode":"3C2DC2A3A377E4","user_header":"https://static001.geekbang.org/account/avatar/00/2c/82/ec/99b480e8.jpg","comment_is_top":false,"comment_ctime":1658334938,"is_pvip":false,"replies":[{"id":127985,"content":"这个办法是可行的，但按理来说minikube会直接启动浏览器的，不需要这么麻烦，可以再找找原因。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658357487,"ip_address":"","comment_id":352026,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"执行minikube dashboard无法在本机自动用浏览器打开dashboard页面，网上搜到的解决办法：执行\nkubectl proxy --port=8888 --address=&#39;虚拟机ip&#39; --accept-hosts=&#39;^.*&#39; &amp;\n然后在本机打开http:&#47;&#47;虚拟机ip:8888&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;http:kubernetes-dashboard:&#47;proxy&#47;#&#47;workloads?namespace=default","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580717,"discussion_content":"这个办法是可行的，但按理来说minikube会直接启动浏览器的，不需要这么麻烦，可以再找找原因。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658357487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1903331,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0a/e3/fa396e5d.jpg","nickname":"青青大王","note":"","ucode":"EC3AB128F1178D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606455,"discussion_content":"我远程登录的虚拟机，打不开。需要在外部执行端口转发ssh -L 8001:localhost:34589 虚拟机用户名@192.168.0.100\n-然后再到外部访问http://localhost:8001/api/v1/namxxxxx\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677139042,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1074306,"avatar":"https://static001.geekbang.org/account/avatar/00/10/64/82/d1423f4c.jpg","nickname":"三刀","note":"","ucode":"A665C103B12876","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1903331,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0a/e3/fa396e5d.jpg","nickname":"青青大王","note":"","ucode":"EC3AB128F1178D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":648480,"discussion_content":"内部转口转发给外部：但网页看不了是forbiden\nssh -L 0.0.0.0:8001:127.0.0.1:36913  user@192.168.255.130端口能转发，但用192.168.255.130&gt;8001访问相应URL显示Forbidden，什么原因？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1721663773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":606455,"ip_address":"上海","group_id":0},"score":648480,"extra":""}]},{"author":{"id":1986211,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/4e/a3/e705111b.jpg","nickname":"Geek_fd0d9a","note":"","ucode":"609C110913F524","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582681,"discussion_content":"应该是在虚拟机上操作，dashboard只能localhost打开，所以需要做一个代理。vm操作界面不是很好，我通过nps 代理了一下，也是这样的情况。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659593913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1344431,"avatar":"https://static001.geekbang.org/account/avatar/00/14/83/af/1cb42cd3.jpg","nickname":"马以","note":"","ucode":"3FEA06CA14DE28","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581653,"discussion_content":"你远程登录虚拟机了吧？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658909293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581265,"discussion_content":"我的是自动打开的。没做额外的操作的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658676471,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351281,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1657676063,"is_pvip":false,"replies":[{"id":127763,"content":"\n1.如果有多台master节点，那就构成了一个master集群，这些组件就可以在多个节点里随意运行，它们都是独立的服务，用api接口通信，不必限制在同一台主机上。\n\n2.后面会再专门讲Pod概念。\n\n3.master负责调度管理，Pod运行在Node上，不是存储的意思，master下发命令给kubelet，kubelet在node上启动Pod。\n\n4.这个跟网络有关，只能说是凑巧一样。\n\n5.用kubectl get pod，后面会再讲pod的详细操作。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657677505,"ip_address":"","comment_id":351281,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"请教老师几个问题：\nQ1：Mater的四个组件运行在一台主机上吗？\n一个mater包括四个组件，这四个组件是运行在同一台主机上吗？即“一个Mater对应一个主机”。或者是另外一种理解：mater是个逻辑概念，可以对应一台主机，也可以对应多台主机，比如两个组件运行在一台主机，另外两个组件运行在另外一台主机，两台主机合起来才是mater。哪一种理解对？\nQ2：Pod与docker容器是什么关系？\n一个pod就对应一个docker容器吗？ 比如创建一个nginx容器，那么此容器就对应一个pod。\nQ3：Pod是集中存储在master上，由master分发到各个node运行吗？\nQ4：启动k8s后台管理系统后，”node list”查询出的IP是固定的吗？\n09课文章中，用“minikube node list”查询出来的结果中，IP是“192.168.49.2”。在我的笔记本上，查出来的也是“192.168.49.2”。 请问，这个IP是固定的吗？\nQ5：09课中，启动nginx后怎么验证启动成功？\n09课的最后，用“kubectl run ngx --image=nginx:alpine”这个命令启动了nginx，此命令中没有指定端口映射。 请问，怎么验证启动成功？  Localhost:80 吗？","like_count":9,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579761,"discussion_content":"\n1.如果有多台master节点，那就构成了一个master集群，这些组件就可以在多个节点里随意运行，它们都是独立的服务，用api接口通信，不必限制在同一台主机上。\n\n2.后面会再专门讲Pod概念。\n\n3.master负责调度管理，Pod运行在Node上，不是存储的意思，master下发命令给kubelet，kubelet在node上启动Pod。\n\n4.这个跟网络有关，只能说是凑巧一样。\n\n5.用kubectl get pod，后面会再讲pod的详细操作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657677506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1915533,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/3a/8d/f5e7a20d.jpg","nickname":"何以解忧","note":"","ucode":"4DFE2BDBAF4919","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629944,"discussion_content":"第一个问题特别好。我也想细问一下，一个节点上可以只有apiserver 其他组件都在其他节点吗？，这样构成一个master ,或者说某个节点如果有一个master 组件一定会有其他三个组件吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697868114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259323,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","nickname":"陈斯佳","note":"","ucode":"C236F874FC767A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587900,"discussion_content":"Pod相当于是Container group,是一群有关联的容器组群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663380755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"加拿大","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351567,"user_name":"dao","can_delete":false,"product_type":"c1","uid":1087879,"ip_address":"","ucode":"4181FB270462CF","user_header":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","comment_is_top":false,"comment_ctime":1657938054,"is_pvip":false,"replies":[{"id":127855,"content":"awesome","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657949604,"ip_address":"","comment_id":351567,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"课后思考：\n1. kubernetes 算得上是一种操作系统，正如它定位的就是 cloud native 一样。它与传统意义上的操作系统不同的是管理、调度的都是虚拟化&#47;池化的资源，与硬件之间隔了一层宿主操作系统（传统 OS）。\n2. 哈哈，我觉得这里面的组件没有一个是多余的——都重要。没有 etcd 就没有持久化信息&#47;配置；没有 apiserver 整个集群就失联、失控；没有 kubelet 该节点就失联了；没有节点里的 container runtime 就没有 Pod，也就是没有任何应用服务；没有 kube-proxy，节点的服务就是孤岛；没有 controller manager 就无法管理节点及 Pod ，也就无法对外提供应用服务；没有 scheduler 集群就处于失衡状态。这里 apiserver 、 kubelet 、 kube-proxy 充当不同的桥接作用。","like_count":8,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580169,"discussion_content":"awesome","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657949604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581305,"discussion_content":"同学思考的很不错！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658718661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352209,"user_name":"李一","can_delete":false,"product_type":"c1","uid":1524952,"ip_address":"","ucode":"EEB7C5099C566C","user_header":"https://static001.geekbang.org/account/avatar/00/17/44/d8/708a0932.jpg","comment_is_top":false,"comment_ctime":1658457187,"is_pvip":true,"replies":[{"id":128135,"content":"生产环境会有多个master节点，etcd会部署成高可用。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658461184,"ip_address":"","comment_id":352209,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"问一个小白问题，看架构图 ETCD是在Master节点上的，由于ETCD记录了节点信息、ConfigMap、Secret数据，如果Master 节点宕机或数据损坏，K8S 如何保证数据完整性？","like_count":6,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581022,"discussion_content":"生产环境会有多个master节点，etcd会部署成高可用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658461184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606457,"discussion_content":"首先master主节点你可以设置3台 6 台或者100台都可以只要是一个分布式集群，3个master节点down2台不会影响集群运行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677139405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352586,"user_name":"三溪","can_delete":false,"product_type":"c1","uid":2078022,"ip_address":"","ucode":"00807C1B166E5E","user_header":"https://static001.geekbang.org/account/avatar/00/1f/b5/46/2ac4b984.jpg","comment_is_top":false,"comment_ctime":1658797544,"is_pvip":false,"replies":[{"id":128259,"content":"thanks","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658811562,"ip_address":"","comment_id":352586,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"罗老师画思维导图是真的强","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581490,"discussion_content":"thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658811562,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351487,"user_name":"自由","can_delete":false,"product_type":"c1","uid":2576960,"ip_address":"","ucode":"4E3B53D29D86CA","user_header":"https://static001.geekbang.org/account/avatar/00/27/52/40/db9b0eb2.jpg","comment_is_top":false,"comment_ctime":1657847221,"is_pvip":false,"replies":[{"id":127836,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657851122,"ip_address":"","comment_id":351487,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"2.2.3 Kube-proxy\n负责本地集群网络，保障 Pod 间的网络路由与负载均衡","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580051,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657851122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606456,"discussion_content":"Kube-proxy是负责服务发现4层正向代理和反向代理，只能支持ip加端口的形式去访问，不支持7层解析","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677139333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351366,"user_name":"笨蛋小孩","can_delete":false,"product_type":"c1","uid":1659275,"ip_address":"","ucode":"48559E9D480C34","user_header":"https://static001.geekbang.org/account/avatar/00/19/51/8b/e3b827b7.jpg","comment_is_top":false,"comment_ctime":1657727752,"is_pvip":false,"replies":[{"id":127796,"content":"它是基于docker，用镜像启动了Kubernetes。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657750602,"ip_address":"","comment_id":351366,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"老师，是不是minikube的作用就是提供了以上的基础组件？","like_count":5,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579867,"discussion_content":"它是基于docker，用镜像启动了Kubernetes。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657750602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351360,"user_name":"朱雯","can_delete":false,"product_type":"c1","uid":1035744,"ip_address":"","ucode":"064C45FBF6B51F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg","comment_is_top":false,"comment_ctime":1657723536,"is_pvip":false,"replies":[{"id":127798,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657750632,"ip_address":"","comment_id":351360,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100114501,"comment_content":"1. 什么是操作系统？根据我所学到知识，操作系统是帮助人管理硬件的，具体来说就是管理内存，cpu，硬盘这些内容。文件是硬盘的抽象，内存是内存条的抽象，进程是运行程序的抽象。总的来说，操作系统就是硬件再软件层面如何被抽象和管理的工具。从这个角度来看，k8s不算操作系统，因为k8s并不直接控制硬件，而是控制更高级别的抽象软件。但从结果上来看，k8s可以管理，并且主要是为这个产生的，所以又算是操作系统。与传统的操作系统区别在于，传统操作系统管理可以更多是单机管理，无法跨机器跨集群管理，但k8s可以，因为k8s天然在云上。\n2. 对于一个操作系统来说，管理的重点在于，网络，计算和存储，网络方面会使用到kube-proxy和apiserver，计算方面有contonller-manager，scheduler，apiserver和kubelet，存储方面主要是etcd，我觉得都挺重要，缺少一环都无法成就操作系统的管理了，但硬要说最重要，可能还是etcd，毕竟其他的一关机就没了，但存储还在。","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579869,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657750632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351345,"user_name":"美妙的代码","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1657712442,"is_pvip":true,"replies":[{"id":127801,"content":"good","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657750821,"ip_address":"","comment_id":351345,"utype":1}],"discussion_count":3,"race_medal":1,"score":3,"product_id":100114501,"comment_content":"一直没有清楚  module 和addon 区别，今天总于明白了😂","like_count":3,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579872,"discussion_content":"good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657750821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581263,"discussion_content":"这里你说的 module 是指 文中的 “Component”吧？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1658675642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109562,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/3a/c0ad9c43.jpg","nickname":"杰","note":"","ucode":"036B010A45070A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580798,"discussion_content":"module是什么?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658375622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376545,"user_name":"mango","can_delete":false,"product_type":"c1","uid":3624685,"ip_address":"广东","ucode":"59E223BCA02914","user_header":"https://static001.geekbang.org/account/avatar/00/37/4e/ed/a15897e3.jpg","comment_is_top":false,"comment_ctime":1686905305,"is_pvip":false,"replies":[{"id":137287,"content":"命令行参数加载国内镜像源也可以，速度比较快。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1687142970,"ip_address":"北京","comment_id":376545,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"安装minikub碰到的问题，minikub start的时候，一直下载不了gcr.io&#47;k8s-minikube&#47;kicbase 。\n我的解决方法：下载其他代替镜像（anjone&#47;kicbase）\ndocker pull anjone&#47;kicbase\nminikube start --vm-driver=docker --base-image=&quot;anjone&#47;kicbase&quot; --kubernetes-version=&#39;v1.22.0&#39; \n\n","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621320,"discussion_content":"命令行参数加载国内镜像源也可以，速度比较快。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687142971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351478,"user_name":"Andrew","can_delete":false,"product_type":"c1","uid":1856849,"ip_address":"","ucode":"B1598E1E447EC6","user_header":"https://static001.geekbang.org/account/avatar/00/1c/55/51/c7bffc64.jpg","comment_is_top":false,"comment_ctime":1657820330,"is_pvip":false,"replies":[{"id":127832,"content":"任意一台机器，安装了kubectl，然后再有一个config，就可以访问集群。\n\n看第9讲的架构图，就是集群外面的console。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657839646,"ip_address":"","comment_id":351478,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"老师，在真实环境中需要登录到master node才能对集群进行操作吗？\n一般都会有一个kubeconfig文件，里面记录了server, user等信息，是通过本机直接和master node的api server进行交互吗？","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580033,"discussion_content":"任意一台机器，安装了kubectl，然后再有一个config，就可以访问集群。\n\n看第9讲的架构图，就是集群外面的console。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657839646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351355,"user_name":"psoracle","can_delete":false,"product_type":"c1","uid":1219195,"ip_address":"","ucode":"26F9B166508BBA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132","comment_is_top":false,"comment_ctime":1657718736,"is_pvip":false,"replies":[{"id":127806,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657751050,"ip_address":"","comment_id":351355,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"回答下思考题：\n1. 你觉得 Kubernetes 算得上是一种操作系统吗？\n都说Kubernetes是云原生时代的操作系统，研究不深，说下自己的感受。\nKubernetes的核心是容器编排，围绕着调度，发明了Pod，再通过声明式api、控制器这些概念将Pod高效地调度与运行起来。所以说它管理软件（容器，如业务容器，本质是Node OS上的一个进程），确实是的，它控制了Pod的启停、副本等；但说它管理硬件，倒没看出来，像CPU、内存、存储也只参与了调度算法而已。\n\n2. 和真正的操作系统相比有什么差异？说说你理解的 Kubernetes 组件的作用，你觉得哪几个最重要？\na. kube-apiserver，是k8s系统入口，类似于操作系统上的系统调用\nb. kube-scheduler，调度器，容器编排最主要的组件，负责Pod调度，类似于操作系统上的控制器\nc. kube-manage-controller，控制器，负责管理k8s中资源对象\nd. kubelet，Pod生命周期管理，负责Pod运行环境创建，包括各种CRI、CNI等各种manager的管理\n当然，etcd存储k8s所有对象配置，提供查询与订阅功能，并且性能优秀也是很重要的。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579877,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657751051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351274,"user_name":"星垂平野阔","can_delete":false,"product_type":"c1","uid":3010581,"ip_address":"","ucode":"036EC20979D406","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/WrANpwBMr6DsGAE207QVs0YgfthMXy3MuEKJxR8icYibpGDCI1YX4DcpDq1EsTvlP8ffK1ibJDvmkX9LUU4yE8X0w/132","comment_is_top":false,"comment_ctime":1657671160,"is_pvip":false,"replies":[{"id":127762,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657675507,"ip_address":"","comment_id":351274,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"1.k8s感觉上更像是一个介于操作系统和应用之间的服务，相比传统的操作系统，它提供了更强大的资源抽象功能。\n2.scheduler和kubelet比较重要。前者提供了pod调度功能，没有它服务就无法部署运行；kubelet是更基础的组件，没有它容器都无法运行，也无法上报节点状态。","like_count":2,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579758,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657675507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606458,"discussion_content":"最重要的是etcd，数据库都down了集群如何调度","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677139489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370649,"user_name":"GeekNeo","can_delete":false,"product_type":"c1","uid":1146405,"ip_address":"浙江","ucode":"1D355A9BEB8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/25/3932dafd.jpg","comment_is_top":false,"comment_ctime":1679054054,"is_pvip":false,"replies":[{"id":135243,"content":"出于学习的方便，还是安装桌面版比较省事，即可以ssh登录，也可以直接开浏览器。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1679059326,"ip_address":"上海","comment_id":370649,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"服务器是Ubuntu 22.04.2 LTS Server版本 最小化安装，没有Desktop 无法打开浏览器 故需要开启外部其他机器访问。\nkubectl proxy --port=8001 --address=&#39;172.17.40.174&#39; --accept-hosts=&#39;^.*&#39; &amp;\n\n--port 是指虚拟机端口\n--address 是指虚拟机IP\nhttp:&#47;&#47;172.17.40.174:8001&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;http:kubernetes-dashboard:&#47;proxy&#47;","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609627,"discussion_content":"出于学习的方便，还是安装桌面版比较省事，即可以ssh登录，也可以直接开浏览器。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679059326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":362377,"user_name":"Bachue Zhou","can_delete":false,"product_type":"c1","uid":1494491,"ip_address":"北京","ucode":"3175754775CA32","user_header":"https://static001.geekbang.org/account/avatar/00/16/cd/db/7467ad23.jpg","comment_is_top":false,"comment_ctime":1668474043,"is_pvip":false,"replies":[{"id":131809,"content":"可以参考第15讲里的Kubernetes结构图，各个组件之间的通信使用的是Restful API。\n","user_name":"作者回复","user_name_real":"作者","uid":1181974,"ctime":1668492789,"ip_address":"北京","comment_id":362377,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"请教下，容器被 scheduler 调度，但是实际对容器下发操作命令的是 kubelet，二者的通讯却是通过 apiserver 间接进行的，所以 apiserver 与 kubelet 之间是使用类似于 websocket 的流式通讯协议来通讯的吗？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593718,"discussion_content":"可以参考第15讲里的Kubernetes结构图，各个组件之间的通信使用的是Restful API。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1668492789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":359029,"user_name":"...","can_delete":false,"product_type":"c1","uid":1896681,"ip_address":"北京","ucode":"E3694D4CED77E0","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f0/e9/1ff0a3d5.jpg","comment_is_top":false,"comment_ctime":1665190144,"is_pvip":false,"replies":[{"id":130558,"content":"如果要在master节点上用kubectl操作Kubernetes就得安装，一般建议安装，操作起来方便，不装也可以。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1665197923,"ip_address":"北京","comment_id":359029,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"master节点需要安装kubectl插件吗","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589609,"discussion_content":"如果要在master节点上用kubectl操作Kubernetes就得安装，一般建议安装，操作起来方便，不装也可以。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665197923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351802,"user_name":"pyhhou","can_delete":false,"product_type":"c1","uid":1256496,"ip_address":"","ucode":"31EF8D50CF91A5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132","comment_is_top":false,"comment_ctime":1658201051,"is_pvip":false,"replies":[{"id":127932,"content":"\n1. Pod是应用程序，node是计算节点，所以Pod就被调度到node上运行。\n\n2.etcd是分布式数据库，一致性由它保证，一般会有多个master节点，和任意一个上面的apiserver通信，都会存到etcd里。\n\n3. kube-proxy是给Service对象用的，是四层的负载均衡。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1658206591,"ip_address":"","comment_id":351802,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"有几个问题想请教老师：\n\n1. Pod 和 Node 的关系是什么？可以理解为 Pod 在 Node 上运行和挂载吗？\n\n2. 当集群中有多个 Master 存在时，Master 和 Worker 是如何进行交流的？如果一个 Worker 可以和多个 Master 进行通信，那么 Master 之间是如何保证数据一致性的？如果 Worker 只能和某一个对应的 master 进行通信，那么 K8S 是如何处理单点故障的？\n\n3. kube-proxy 的作用和服务对象是谁？是同一个 node 上不同的 pod 吗？我在想 container-runtime 已经包含了对外的网络模块，这里的 kube-proxy 的作用对象应该是局限于集群内部？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580480,"discussion_content":"\n1. Pod是应用程序，node是计算节点，所以Pod就被调度到node上运行。\n\n2.etcd是分布式数据库，一致性由它保证，一般会有多个master节点，和任意一个上面的apiserver通信，都会存到etcd里。\n\n3. kube-proxy是给Service对象用的，是四层的负载均衡。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658206591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069269,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/d5/73334a95.jpg","nickname":"doos","note":"","ucode":"7C9AF67F90E65C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":606459,"discussion_content":"pod是k8s集群当中调度的最小单元，我理解为文件夹，一个pod可以拥有一个容器或者多个容器，node就是物理机或者虚拟机提供cpu 内存 网络等资源，pod是消费他的资源","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1677139905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351362,"user_name":"奕","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1657724861,"is_pvip":false,"replies":[{"id":127810,"content":"改名了，不叫master了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657764112,"ip_address":"","comment_id":351362,"utype":1}],"discussion_count":3,"race_medal":0,"score":3,"product_id":100114501,"comment_content":"mac 上执行 kubectl get node, 为什么没有显示 master 节点的？\nNAME       STATUS   ROLES           AGE   VERSION\nminikube   Ready    control-plane   2d    v1.24.1","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579900,"discussion_content":"改名了，不叫master了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657764112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581264,"discussion_content":"可能是v1.24.1改掉了吧。我这里v.1.23.3还有的。\n\nNAME       STATUS   ROLES                  AGE     VERSION\nminikube   Ready    control-plane,master   3d13h   v1.23.3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658676222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087879,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/87/5066026c.jpg","nickname":"dao","note":"","ucode":"4181FB270462CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580157,"discussion_content":"control-plane 的角色，不就算是 Master node ？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657935414,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351361,"user_name":"忧天小鸡","can_delete":false,"product_type":"c1","uid":1073947,"ip_address":"","ucode":"A1412BDC108FD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/1b/83ac7733.jpg","comment_is_top":false,"comment_ctime":1657724277,"is_pvip":false,"replies":[{"id":127799,"content":"master可以横向扩容，kubelet上报错误信息也有可能，但这个恐怕无法避免。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657750696,"ip_address":"","comment_id":351361,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"这个结构，会不会产生信息欺骗？\napiserver负责太多内容，会不会满负荷，监控面板从etcd读数据，\n如果kubelet如果一直上报错误的信息，是不是会产生监听错误的情况？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579870,"discussion_content":"master可以横向扩容，kubelet上报错误信息也有可能，但这个恐怕无法避免。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657750696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581266,"discussion_content":"同学，怎么理解这里的“信息欺骗”呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658676744,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351350,"user_name":"psoracle","can_delete":false,"product_type":"c1","uid":1219195,"ip_address":"","ucode":"26F9B166508BBA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132","comment_is_top":false,"comment_ctime":1657716060,"is_pvip":false,"replies":[{"id":127802,"content":"有的时候表述会省略，什么都说要经过apiserver也太麻烦了。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657750878,"ip_address":"","comment_id":351350,"utype":1}],"discussion_count":2,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"看图kubelet连接的是apiserver，可怎么又说kubelet也直接访问etcd呢？不是说apiserver是k8s集群中唯一访问etcd的组件吗？","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579873,"discussion_content":"有的时候表述会省略，什么都说要经过apiserver也太麻烦了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657750878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1219195,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132","nickname":"psoracle","note":"","ucode":"26F9B166508BBA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579916,"discussion_content":"解惑了，谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657772237,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351309,"user_name":"小林子","can_delete":false,"product_type":"c1","uid":1145383,"ip_address":"","ucode":"058C95ECBFE422","user_header":"https://static001.geekbang.org/account/avatar/00/11/7a/27/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1657690840,"is_pvip":false,"replies":[{"id":127773,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1657692897,"ip_address":"","comment_id":351309,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"我觉得 etcd 比较重要，它挂了，整个集群就躺了","like_count":1,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579787,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657692898,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394930,"user_name":"陆美芳","can_delete":false,"product_type":"c1","uid":2084000,"ip_address":"广东","ucode":"8C3F5FB3A8B3DA","user_header":"https://static001.geekbang.org/account/avatar/00/1f/cc/a0/bd31d495.jpg","comment_is_top":false,"comment_ctime":1728862873,"is_pvip":false,"replies":[{"id":143403,"content":"many thanks.","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1728894462,"ip_address":"上海","comment_id":394930,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"很不错的课程，最近刚好接触腾讯TKE，马上上来学，学完就可以用","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":652418,"discussion_content":"many thanks.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1728894462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391884,"user_name":"下一个我","can_delete":false,"product_type":"c1","uid":1206895,"ip_address":"重庆","ucode":"253756719D23C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/6a/6f/348b4bec.jpg","comment_is_top":false,"comment_ctime":1719329369,"is_pvip":false,"replies":[{"id":142503,"content":"minikube dashboard不需要kubectl proxy，可以看一下minikube的help。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1719725419,"ip_address":"北京","comment_id":391884,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"执行minikube dashboard --port=8001时，8001也做了映射的（kubectl proxy --port=8001 --address=&#39;0.0.0.0&#39; --accept-hosts=&#39;^.*&#39; &amp;）报错如下：\n🚀  正在启动代理...\n19:37:28.124784   28288 binary.go:76] Not caching binary, using https:&#47;&#47;dl.k8s.io&#47;release&#47;v1.23.3&#47;bin&#47;linux&#47;amd64&#47;kubectl?checksum=file:https:&#47;&#47;dl.k8s.io&#47;release&#47;v1.23.3&#47;bin&#47;linux&#47;amd64&#47;kubectl.sha256\n19:37:28.124830   28288 dashboard.go:152] Executing: &#47;home&#47;xxx&#47;.minikube&#47;cache&#47;linux&#47;amd64&#47;v1.23.3&#47;kubectl [&#47;home&#47;xxx&#47;.minikube&#47;cache&#47;linux&#47;amd64&#47;v1.23.3&#47;kubectl --context minikube proxy --port 8001]\n19:37:28.147686   28288 dashboard.go:157] Waiting for kubectl to output host:port ...\n19:37:28.318185   28288 out.go:239] ❌  因 HOST_KUBECTL_PROXY 错误而退出：kubectl proxy: readByteWithTimeout: EOF\n老师帮看看什么问题了，谢谢！","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647241,"discussion_content":"minikube dashboard不需要kubectl proxy，可以看一下minikube的help。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719725419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389456,"user_name":"LHANGRONG","can_delete":false,"product_type":"c1","uid":3871176,"ip_address":"四川","ucode":"8195E99C34786D","user_header":"https://static001.geekbang.org/account/avatar/00/3b/11/c8/9c92c1ac.jpg","comment_is_top":false,"comment_ctime":1712632078,"is_pvip":false,"replies":[{"id":141680,"content":"没遇见过，可以搜索一下这个错误消息。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1712652173,"ip_address":"上海","comment_id":389456,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"minikube dashboard failed to load module”canberra-gtk-module“这是什么问题呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641447,"discussion_content":"没遇见过，可以搜索一下这个错误消息。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712652173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":387635,"user_name":"承君此诺","can_delete":false,"product_type":"c1","uid":1159765,"ip_address":"山东","ucode":"1B25D59743C0AD","user_header":"https://static001.geekbang.org/account/avatar/00/11/b2/55/61b3e9e3.jpg","comment_is_top":false,"comment_ctime":1708313288,"is_pvip":false,"replies":[{"id":141270,"content":"good.","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1708848062,"ip_address":"北京","comment_id":387635,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"按评论里，通过kubectl proxy配置代理方式，没成功。我换了种方法，使用访问端配置ssh端口转发。\nssh -L 8001:127.0.0.1:42445 jxy@192.168.3.41 -N\njxy@192.168.3.41是虚拟机用户@ip；42445是dashboard port。\n本机（访问端）通过http:&#47;&#47;127.0.0.1:8001&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;http:kubernetes-dashboard:&#47;proxy&#47;#&#47;service?namespace=default，访问成功。","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":637708,"discussion_content":"good.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1708848062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":378461,"user_name":"牙小木","can_delete":false,"product_type":"c1","uid":1172050,"ip_address":"北京","ucode":"E5C12D37A62949","user_header":"https://static001.geekbang.org/account/avatar/00/11/e2/52/56dbb738.jpg","comment_is_top":false,"comment_ctime":1690279691,"is_pvip":false,"replies":[{"id":137928,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1690349953,"ip_address":"上海","comment_id":378461,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"dashboard 默认不会安装，需要执行\nkubectl apply -f https:&#47;&#47;raw.githubusercontent.com&#47;kubernetes&#47;dashboard&#47;v2.7.0&#47;aio&#47;deploy&#47;recommended.yaml\n...\n...\nThe ClusterRoleBinding &quot;kubernetes-dashboard&quot; is invalid: roleRef: Invalid value: rbac.RoleRef{APIGroup:&quot;rbac.authorization.k8s.io&quot;, Kind:&quot;ClusterRole&quot;, Name:&quot;kubernetes-dashboard&quot;}: cannot change roleRef\n需要 创建示例用户，参考 https:&#47;&#47;github.com&#47;kubernetes&#47;dashboard&#47;blob&#47;master&#47;docs&#47;user&#47;access-control&#47;creating-sample-user.md","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624227,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690349953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377928,"user_name":"芋头","can_delete":false,"product_type":"c1","uid":1070287,"ip_address":"广东","ucode":"390438CFF71F0A","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/cf/fddcf843.jpg","comment_is_top":false,"comment_ctime":1689563928,"is_pvip":false,"replies":[{"id":137733,"content":"后面会讲到如何自己安装dashboard，不过生产环境还是不能随便安装吧，用好命令行是基本功。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1689579038,"ip_address":"上海","comment_id":377928,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"老师，产线的机器都是基于命令行的，如何在生产环境打开dashboard呢","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623500,"discussion_content":"后面会讲到如何自己安装dashboard，不过生产环境还是不能随便安装吧，用好命令行是基本功。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689579038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377218,"user_name":"郑童文","can_delete":false,"product_type":"c1","uid":1030733,"ip_address":"四川","ucode":"3D193715CB8549","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ba/4d/7ba09ff0.jpg","comment_is_top":false,"comment_ctime":1688095924,"is_pvip":false,"replies":[{"id":137478,"content":"这个只要自己试一下就知道了，应该很容易得到答案。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1688174576,"ip_address":"北京","comment_id":377218,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100114501,"comment_content":"请问老师 Linux 系统重启后， 所有的服务都在stop状态，请问每次都要重新运行minikube start 吗？","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622383,"discussion_content":"这个只要自己试一下就知道了，应该很容易得到答案。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688174576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376168,"user_name":"原则","can_delete":false,"product_type":"c1","uid":3574650,"ip_address":"广东","ucode":"12E98F3728CC53","user_header":"https://static001.geekbang.org/account/avatar/00/36/8b/7a/ec36ff82.jpg","comment_is_top":false,"comment_ctime":1686439843,"is_pvip":false,"replies":[{"id":137214,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1686535503,"ip_address":"上海","comment_id":376168,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"通过外部浏览器访问：\n\n开启 proxy，并在后台运行：\nnohup minikube kubectl -- proxy --address=&#39;0.0.0.0&#39; --disable-filter=true --accept-hosts=&#39;^*$&#39; &amp;\n访问：\nhttp:&#47;&#47;&lt;服务器IP地址&gt;:8001&#47;api&#47;v1&#47;namespaces&#47;kubernetes-dashboard&#47;services&#47;http:kubernetes-dashboard:&#47;proxy&#47;","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620774,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686535503,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":375777,"user_name":"Panda","can_delete":false,"product_type":"c1","uid":1044216,"ip_address":"河北","ucode":"1C22CFD1652D9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/f8/bc5faaec.jpg","comment_is_top":false,"comment_ctime":1685956996,"is_pvip":false,"replies":[{"id":137171,"content":"换用最新版本的minikube试试，应该能够支持到1.26。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1686202591,"ip_address":"北京","comment_id":375777,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"由于防火墙的限制，执行minikube start 默认拉取境外面的镜像会失败。 采用如下cn的地区镜象， 默认杭州阿里云只支持到v1.23.0 \nminikube start --image-mirror-country=&#39;cn&#39; --kubernetes-version=v1.23.0","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620472,"discussion_content":"换用最新版本的minikube试试，应该能够支持到1.26。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1686202591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":374053,"user_name":"jone","can_delete":false,"product_type":"c1","uid":1318619,"ip_address":"广东","ucode":"00D0C54BE1005C","user_header":"https://static001.geekbang.org/account/avatar/00/14/1e/db/921367d6.jpg","comment_is_top":false,"comment_ctime":1683536453,"is_pvip":false,"replies":[{"id":136649,"content":"1.是的，kubelet是主机上的一个系统服务。\n\n2.kube-proxy也是只有一个，它来管理kubernetes的网络流量。\n\n3.可以登录节点，用ps -ef 来查看这几个进程。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1683688818,"ip_address":"上海","comment_id":374053,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"老师，咨询一个小问题，下面的几句话是否理解有问题呢。\n1    一个Node下只有一个kubelet  ，此kubelet管理该Node下的所有Pod  ？\n2    一个Node只有一个kube-proxy ，还是一个Pod就有一个kube-proxy，各自kube-proxy负责各自的Pod通信。 ","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":617580,"discussion_content":"1.是的，kubelet是主机上的一个系统服务。\n\n2.kube-proxy也是只有一个，它来管理kubernetes的网络流量。\n\n3.可以登录节点，用ps -ef 来查看这几个进程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1683688818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371362,"user_name":"抹茶拿铁","can_delete":false,"product_type":"c1","uid":2936546,"ip_address":"广东","ucode":"B964920A9F0722","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/RBqVHgaK2h8KibJnT0rYOrKX2t5RpRHcn0PpXnOgaw6Y8cOyYyphu7ZWWgl6SE1yphzvtpOW0j3kVJicMLwapBQw/132","comment_is_top":false,"comment_ctime":1679836412,"is_pvip":false,"replies":[{"id":135465,"content":"更换一下minikube的版本试试，这个不应该出错的。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1679901214,"ip_address":"上海","comment_id":371362,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"运行minikube dashboard，dashboard页面返回x509: certificate signed by unknown authority (possibly because of &quot;crypto&#47;rsa: verification error&quot; while trying to verify candidate authority certificate &quot;minikubeCA&quot;)错误你们有遇到过吗","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":611001,"discussion_content":"更换一下minikube的版本试试，这个不应该出错的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679901214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370646,"user_name":"GeekNeo","can_delete":false,"product_type":"c1","uid":1146405,"ip_address":"浙江","ucode":"1D355A9BEB8BEA","user_header":"https://static001.geekbang.org/account/avatar/00/11/7e/25/3932dafd.jpg","comment_is_top":false,"comment_ctime":1679047684,"is_pvip":false,"replies":[{"id":135245,"content":"一般来说命令都是差不多的，切换也比较容易。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1679059430,"ip_address":"上海","comment_id":370646,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"更换Containerd后，以往我们常用的docker命令也不再使用，取而代之的分别是 crictl 和 ctr 两个命令客户端\n\n文中的docker ps | grep kube-proxy 跟换为 sudo crictl ps ｜ grep kube-proxy","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":609630,"discussion_content":"一般来说命令都是差不多的，切换也比较容易。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1679059430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368205,"user_name":"Geek_f53815","can_delete":false,"product_type":"c1","uid":3507217,"ip_address":"广东","ucode":"45723773860EE9","user_header":"","comment_is_top":false,"comment_ctime":1676003181,"is_pvip":false,"replies":[{"id":134065,"content":"kubernetes使用service实现了pod之间的负载均衡，参见后面课程。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1676007099,"ip_address":"上海","comment_id":368205,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"负载均衡和k8s有什么关系么","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":603178,"discussion_content":"kubernetes使用service实现了pod之间的负载均衡，参见后面课程。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1676007099,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366711,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"四川","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1674096845,"is_pvip":false,"replies":[{"id":133606,"content":"我还在打工中啊，开篇词里就说了，在Kong公司当码农。","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1674119006,"ip_address":"北京","comment_id":366711,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"老师是自由职业吗？ip显示是天南海北","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":600224,"discussion_content":"我还在打工中啊，开篇词里就说了，在Kong公司当码农。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1674119006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365702,"user_name":"一行","can_delete":false,"product_type":"c1","uid":1305810,"ip_address":"北京","ucode":"849B58C31455DC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/prLO6VIcvsXMibOichyNgeMmgDlh8nS7q4F9a0PCkrL0OypFj0dQicDMRH0El7sdOF6srhJyKsfRNQJe10IJwHhoQ/132","comment_is_top":false,"comment_ctime":1672908471,"is_pvip":false,"replies":[{"id":133202,"content":"great","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1672966881,"ip_address":"北京","comment_id":365702,"utype":1}],"discussion_count":1,"race_medal":0,"score":5,"product_id":100114501,"comment_content":"第一个思考：你觉得 Kubernetes 算得上是一种操作系统吗？和真正的操作系统相比有什么差异？\n算是一种云操作系统，是面向业务的操作系统。 不过不能直接管理硬件，需要借助真正操作系统的才能管理硬件资源。 \n\n第二个思考：说说你理解的 Kubernetes 组件的作用，你觉得哪几个最重要？\napiserver : k8s资源的唯一入口，是信息联络员\netcd ：存储k8s集群对象与对象的状态。 是一个数据仓库。\ncontroller-manager ： 负责监控k8s集群对象的状态，并负责将状态调整到预期状态。 是一个监控管理人员\nschedule ： 负责pod调度到最合适的，期望的节点上。 是一个部署人员。\nkubelet ： 负责管理worker pod的管理，并向apiserver上报状态。 是worker节点的管理者\nkube-proxy ： 负责worker pod对外联络。 是pod的通信员。\ncontainer-runtime ： 负责直接管理worker上的pod，是pod的直接管理者。\n","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598619,"discussion_content":"great","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672966881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357505,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1663319991,"is_pvip":false,"replies":[{"id":130142,"content":"thanks","user_name":"作者回复","user_name_real":"编辑","uid":1181974,"ctime":1663396578,"ip_address":"北京","comment_id":357505,"utype":1}],"discussion_count":1,"race_medal":2,"score":5,"product_id":100114501,"comment_content":"老师讲得很清楚~","like_count":0,"discussions":[{"author":{"id":1181974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/16/1161017c.jpg","nickname":"罗剑锋","note":"","ucode":"95678C988F24AB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587942,"discussion_content":"thanks","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663396578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}