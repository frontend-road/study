{"id":111479,"title":"36 | 基于JWT令牌的安全认证架构","content":"<ul>\n<li>\n<p>代码：<a href=\"https://gitee.com/geektime-geekbang/staffjoy\">https://gitee.com/geektime-geekbang/staffjoy</a></p>\n</li>\n<li>\n<p>课件：<a href=\"https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ\">https://pan.baidu.com/s/1Q7eP3yZ1Vm8J2nhle5RzTQ</a> 提取码: 1aeh</p>\n</li>\n</ul>","comments":[{"had_liked":false,"id":119727,"user_name":"姑射仙人","can_delete":false,"product_type":"c3","uid":1008517,"ip_address":"","ucode":"3EFC1F3E592165","user_header":"https://static001.geekbang.org/account/avatar/00/0f/63/85/1dc41622.jpg","comment_is_top":false,"comment_ctime":1564666244,"is_pvip":false,"replies":[{"id":43927,"content":"不是单点部署，网关是无状态，可以集群部署，而且可以根据流量需要水平扩容部署，比如部署10台，不够再扩容到20&#47;30台，中间挂几台都没有关系。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1564674887,"ip_address":"","comment_id":119727,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师，如果网关成为高并发的瓶颈，该如何处理呢？感觉网关好像都是单节点部署的。","like_count":6,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461041,"discussion_content":"不是单点部署，网关是无状态，可以集群部署，而且可以根据流量需要水平扩容部署，比如部署10台，不够再扩容到20/30台，中间挂几台都没有关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564674887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120013,"user_name":"大老李","can_delete":false,"product_type":"c3","uid":1001670,"ip_address":"","ucode":"AE7487EB3A3302","user_header":"https://static001.geekbang.org/account/avatar/00/0f/48/c6/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1564755196,"is_pvip":false,"replies":[{"id":44138,"content":"把jwt在客户端缓存中清除可以实现登出。staffjoy采用的登录方式，jwt放在浏览器cookie中，登出把相应的cookie清除即可。","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1564840968,"ip_address":"","comment_id":120013,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"老师你好，如果jwt要是登出的话，如何实现","like_count":2,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461174,"discussion_content":"把jwt在客户端缓存中清除可以实现登出。staffjoy采用的登录方式，jwt放在浏览器cookie中，登出把相应的cookie清除即可。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564840968,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1025664,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a6/80/6ff7ea5f.jpg","nickname":"guoguo 👻","note":"","ucode":"874B0A1E0F7DEA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6079,"discussion_content":"客户端清除的话\n第一，服务端也应该清楚，没必要的存储\n第二，单点登录的场景，如果跨域的，客户端如何清除？各个域都清除？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566660772,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237261,"user_name":"future","can_delete":false,"product_type":"c3","uid":1130294,"ip_address":"","ucode":"6FA448FEAF931A","user_header":"https://static001.geekbang.org/account/avatar/00/11/3f/36/e51006d0.jpg","comment_is_top":false,"comment_ctime":1595758410,"is_pvip":false,"replies":[{"id":87838,"content":"把错误关键字贴到google里头去搜一下，看看有没有类似问题","user_name":"作者回复","user_name_real":"杨波","uid":1030344,"ctime":1595955405,"ip_address":"","comment_id":237261,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"Spring gateway部署在k8s压测出现过toomany open file问题，使用ulimit查看并没有限制？k8s节点打开最大文件数也挺大的，这个要怎么分析呢","like_count":0,"discussions":[{"author":{"id":1030344,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/c8/c94d38a7.jpg","nickname":"杨波","note":"","ucode":"FA3418BB703BCA","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502355,"discussion_content":"把错误关键字贴到google里头去搜一下，看看有没有类似问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595955405,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188773,"user_name":"钱","can_delete":false,"product_type":"c3","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1584414200,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"jwt可以看做是无状态认证鉴权思想的扩展，通俗点就是用户的状态信息存储在客户端，随请求一块传递到服务端，以实现认证鉴权。","like_count":2},{"had_liked":false,"id":347390,"user_name":"GeekCoder","can_delete":false,"product_type":"c3","uid":1523315,"ip_address":"","ucode":"14BB73CBE28545","user_header":"","comment_is_top":false,"comment_ctime":1653984878,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100031401,"comment_content":"JWT怎么让Token失效？比如我在B设备上登录了，我之前的A设备上的就得登出。","like_count":0}]}