{"id":93777,"title":"HTML·ARIA：可访问性是只给盲人用的特性么？","content":"<p>你好，我是winter。</p><p>我们都知道，HTML已经是一个完整的语义系统。在前面的课程中，我们围绕着HTML本身做了讲解，但是在实际应用中，我们还会用到一些它的扩展。今天我们要讲的ARIA就是其中重要的一部分。</p><p>ARIA全称为Accessible Rich Internet Applications，它表现为一组属性，是用于可访问性的一份标准。关于可访问性，它被提到最多的，就是它可以为视觉障碍用户服务，但是，这是一个误解。</p><p>实际上，可访问性其实是一个相当大的课题，它的定义包含了各种设备访问、各种环境、各种人群访问的友好性。不单单是永久性的残障人士需要用到可访问性，健康的人也可能在特定时刻处于需要可访问性的环境。</p><p>我们今天讲的ARIA，是以交互形式来标注各种元素的一类属性，所以，在ARIA属性中，你可以看到很多熟悉的面孔，交互形式往往跟我们直觉中的“控件”非常相似。</p><p>所以我们的课程，特意把ARIA加入还有一个原因：ARIA的角色对于我们UI系统的设计有重要的参考意义。</p><h2>综述</h2><p>我们先整体来看看，ARIA给HTML元素添加的一个核心属性就是role，我们来看一个例子：</p><pre><code class=\"language-HTML\">&lt;span role=\"checkbox\" aria-checked=\"false\" tabindex=\"0\" aria-labelledby=\"chk1-label\"&gt;\n&lt;/span&gt; &lt;label id=\"chk1-label\"&gt;Remember my preferences&lt;/label&gt;\n</code></pre><!-- [[[read_end]]] --><p>这里我们给一个span添加了checkbox角色，这样，表示我们这个span被用于checkbox，这意味着，我们可能已经用JS代码绑定了这个span的click事件，并且以checkbox的交互方式来处理用户操作。</p><p>同时，ARIA系统还提供了一系列ARIA属性给checkbox这个role，这意味着，<strong>我们可以通过HTML属性变化来理解这个JavaScript组件的状态</strong>，读屏软件等三方客户端，就可以理解我们的UI变化，这正是ARIA标准的意义。</p><p>role的定义是一个树形的继承关系，我们先来理解一下它的整体结构：</p><p><img src=\"https://static001.geekbang.org/resource/image/ae/69/aeccf64871b309735054912fbbb18a69.jpg?wh=697*316\" alt=\"\"></p><p>其中，widget表示一些可交互的组件，structure表示文档中的结构，window则代表窗体。</p><p>接下来，让我们分类了解一下重要的ARIA角色。</p><h2>Widget角色</h2><p>我们刚刚已经讲过一个widget role，就是checkbox。</p><p>这一类角色跟我们桌面开发中的控件类似，它表示一个可交互的组件，它们有：</p><p><img src=\"https://static001.geekbang.org/resource/image/10/dd/10ea9eb62d60fb4bfb18c27da50836dd.jpg?wh=984*585\" alt=\"\"></p><p>我们这里按照继承关系给出一份列表和简要说明：</p><p><img src=\"https://static001.geekbang.org/resource/image/03/f1/038e1152c9bddc7ed864d271691d17f1.jpeg?wh=1030*969\" alt=\"\"></p><p>ARIA role允许多继承，这里有些角色我没有重复写。</p><p>注意，这些role可以出现在任何一个HTML元素之上，同时要注意，这些ARIA属性，不会真实地改变任何一个元素的行为，比如，我们刚才讲的checkbox，即使我们给一个span添加了Checkbox角色，我们也需要用JavaScript编写相应的逻辑。</p><p>这些widget同时还会带来对应的ARIA属性，比如，我们的Checkbox角色，会带来两个属性：</p><ul>\n<li>aria-checked 表示复选框是否已经被选中；</li>\n<li>aria-labelledby 表示复选框对应的文字。</li>\n</ul><p>而Button角色，则会带来另外两个属性：</p><ul>\n<li>aria-pressed 按钮是否已经被按下；</li>\n<li>aria-expanded 按钮控制的目标是否已经被展开。</li>\n</ul><p>除了它们本身的属性之外，可交互组件还有继承来的属性，比如，switch角色继承了checkbox，因此，它也可以使用aria-checked属性。</p><p>在WAI-ARIA标准中，你可以找到所有的角色和对应的属性，我们这里就不一一列举了。</p><ul>\n<li><a href=\"https://www.w3.org/TR/wai-aria/\">https://www.w3.org/TR/wai-aria/</a></li>\n</ul><p>很多这些ARIA属性都是需要在JavaScript中维护的。</p><p>如果我们要实现一份组件库，这些widget role和它们对应的aria属性是非常好的参考。</p><p>如果你是组件的实现者，也希望你在实现组件时把对应的ARIA属性自动维护好。</p><p>除了简单的widget，还有一些比较复杂的角色，需要多个角色一起配合。我们来逐个了解一下。</p><p>Combobox 是一个带选项的输入框，我们常见的搜索引擎，一般都会提供这样的输入框，当输入时，它会提供若干提示选项。</p><p>Grid 是一个表格，它会分成行、列，行列又有行头和列头表示行、列的意义。</p><p>Tablist 是一个可切换的结构，一般被称为选项卡，它包含了tab头和tabpanel，在tab容器中，可能包含各种组件。</p><p>Listbox 是一个可选中的列表，它内部具有角色为Option的选项。</p><p>Menu 是指菜单，菜单中可以加入嵌套的菜单项（Menuitem角色），除了普通菜单项，还可以有Menuitemcheckbox 带复选框的菜单栏和Menuitemradio 带单选框的菜单栏。</p><p>Radiogroup 是一组互斥的单选框的容器，它的内部可以由若干个角色为radio的单选框。</p><p>Tree 是树形控件，它的内部含有 Treeitem 树形控件项，它还有一种升级形式是Treegrid。</p><h2>structure角色</h2><p>结构角色其实跟HTML5中不少新标签作用重合了，这里建议优先使用HTML5标签。</p><p>这部分角色的作用类似于语义化标签，但是内容稍微有些不同，我们这里就不详细讲解了，仅仅给出一张图供你参考：</p><p><img src=\"https://static001.geekbang.org/resource/image/b2/7a/b21a82fd68a885f751123f48a7e26b7a.jpg?wh=522*622\" alt=\"\"></p><p>注：separator在允许焦点时属于组件，在不允许焦点时属于文档结构。</p><p>这里我们需要特别提出Landmark角色这个概念，Landmark角色直接翻译是地标，它是ARIA标准中总结的Web网页中最常见的8个结构，Landmark角色实际上是section的子类，这些角色在生成页面摘要时有很大可能性需要被保留，它们是：</p><p><img src=\"https://static001.geekbang.org/resource/image/9a/75/9aee7029d4bf684a8679a6776d6e9075.jpg?wh=1042*625\" alt=\"\"></p><h2>window角色</h2><p>在我们的网页中，有些元素表示“新窗口”，这时候，会用到window角色。window系角色非常少，只有三个角色：</p><ul>\n<li>window\n<ul>\n<li>dialog\n<ul>\n<li>alertdialog</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul><p>dialog可能会产生“焦点陷阱”，也就是说，当这样的角色被激活时，焦点无法离开这个区域。</p><h2>总结</h2><p>今天我介绍了ARIA相关的知识，我们分几个部分学习了如何使用ARIA属性来提高页面的可访问性。</p><p>我们以ARIA角色为中心，讲解了ARIA定义的语义体系。我们可以把ARIA分为三类。</p><ul>\n<li>Widget角色：主要是各种可交互的控件。</li>\n<li>结构角色：文档的结构。</li>\n<li>窗体角色：弹出的窗体。</li>\n</ul><p>今天的课后小问题是，请找一个支持图结构可视化的JS库，把所有ARIA的继承关系用可视化的方式展现出来。</p><p></p>","comments":[{"had_liked":false,"id":147878,"user_name":"王小贱","can_delete":false,"product_type":"c1","uid":1244728,"ip_address":"","ucode":"91AE60138ACA97","user_header":"https://static001.geekbang.org/account/avatar/00/12/fe/38/b6995d69.jpg","comment_is_top":false,"comment_ctime":1572916706,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"83177295330","product_id":100023201,"comment_content":"几年前有改造过无障碍网站....真滴是枯燥，不过不改的话在美国会被投诉下架","like_count":20},{"had_liked":false,"id":92322,"user_name":"Artyhacker","can_delete":false,"product_type":"c1","uid":1026392,"ip_address":"","ucode":"1C4BCA763297F5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a9/58/9324f5cc.jpg","comment_is_top":false,"comment_ctime":1557232707,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40211938371","product_id":100023201,"comment_content":"感觉ARIA应该算一份前端UI组件库的实现标准吧，实际项目中除了一些简单的网页以外，大都直接用组件库了。以前专门学习了mdn里可访问性相关的文档，但实际项目还是从来没用到过，可能也和项目并非面向大众有关吧。。感觉很多东西你知道它好，也花时间学习了，但是实际项目就是不会去用。。","like_count":9},{"had_liked":false,"id":223677,"user_name":"Yully","can_delete":false,"product_type":"c1","uid":1254946,"ip_address":"","ucode":"66034995A6282F","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/22/dd505e6d.jpg","comment_is_top":false,"comment_ctime":1591154600,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31655925672","product_id":100023201,"comment_content":"看完了这篇文章，恍然大悟，原来公司大佬写的ui组件库里的那些看上去乱七八糟的东西是这个…大佬之前写的代码规规整整，尤其是ARIA这一块写的超级有条理，希望以后我再封装的时候也能用上ARIA","like_count":8,"discussions":[{"author":{"id":1266698,"avatar":"https://static001.geekbang.org/account/avatar/00/13/54/0a/9a002ad5.jpg","nickname":"Adam Lau","note":"","ucode":"7E542D6E789500","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340885,"discussion_content":"说的挺好，咋没人点赞评论，哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610193122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92078,"user_name":"亮亮","can_delete":false,"product_type":"c1","uid":1377843,"ip_address":"","ucode":"BD82BE508DCDD2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/rqh9unBPg1VnibWWplUtEm2GXuqd0Ye3yCF5MIuxvojXIzY0TOvbdXbGp7N8lw0vrmPS7jVj1BS2gdy3WQX9VAQ/132","comment_is_top":false,"comment_ctime":1557186771,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23032023251","product_id":100023201,"comment_content":"可访问性在开发中还是用的比较少，项目没要求，开发时间紧，没咋注重过！","like_count":6},{"had_liked":false,"id":92890,"user_name":"Apep","can_delete":false,"product_type":"c1","uid":1469678,"ip_address":"","ucode":"AE8393AFA8B6CD","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/ee/2ec78dbc.jpg","comment_is_top":false,"comment_ctime":1557362183,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1557362183","product_id":100023201,"comment_content":"最近react项目有这个需求 头痛","like_count":0,"discussions":[{"author":{"id":1382676,"avatar":"https://static001.geekbang.org/account/avatar/00/15/19/14/71cfa677.jpg","nickname":"宅神king","note":"","ucode":"9BFE977278D9F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":91410,"discussion_content":"你好，能具体聊聊这方面需求吗？ 我看完本文还是感觉不太理解其应用场景，去 MDN 也看了相关解释，总是似懂非懂的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576832719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":92049,"user_name":"cjd","can_delete":false,"product_type":"c1","uid":1448797,"ip_address":"","ucode":"B34BB18C370152","user_header":"https://static001.geekbang.org/account/avatar/00/16/1b/5d/1d5d1c00.jpg","comment_is_top":false,"comment_ctime":1557163313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557163313","product_id":100023201,"comment_content":"沙发","like_count":0}]}