{"id":109105,"title":"04 | å¯ä»¥æŠŠé‡‡é›†åˆ°çš„éŸ³è§†é¢‘æ•°æ®å½•åˆ¶ä¸‹æ¥å—ï¼Ÿ","content":"<p>åœ¨éŸ³è§†é¢‘ä¼šè®®ã€åœ¨çº¿æ•™è‚²ç­‰ç³»ç»Ÿä¸­ï¼Œ<strong>å½•åˆ¶</strong>æ˜¯ä¸€ä¸ªç‰¹åˆ«é‡è¦çš„åŠŸèƒ½ã€‚å°¤å…¶æ˜¯åœ¨çº¿æ•™è‚²ç³»ç»Ÿï¼ŒåŸºæœ¬ä¸Šæ¯ä¸€èŠ‚è¯¾éƒ½è¦å½•åˆ¶ä¸‹æ¥ï¼Œä»¥ä¾¿å­¦ç”Ÿå¯ä»¥éšæ—¶å›é¡¾ä¹‹å‰å­¦ä¹ çš„å†…å®¹ã€‚</p><p>å®ç°å½•åˆ¶åŠŸèƒ½æœ‰å¾ˆå¤šæ–¹å¼ï¼Œä¸€èˆ¬åˆ†ä¸º<strong>æœåŠ¡ç«¯å½•åˆ¶</strong>å’Œ<strong>å®¢æˆ·ç«¯å½•åˆ¶</strong>ï¼Œå…·ä½“ä½¿ç”¨å“ªç§æ–¹å¼è¿˜è¦ç»“åˆä½ è‡ªå·±çš„ä¸šåŠ¡ç‰¹ç‚¹æ¥é€‰æ‹©ã€‚</p><ul>\n<li>\n<p><strong>æœåŠ¡ç«¯å½•åˆ¶</strong>ï¼šä¼˜ç‚¹æ˜¯ä¸ç”¨æ‹…å¿ƒå®¢æˆ·å› è‡ªèº«ç”µè„‘é—®é¢˜é€ æˆå½•åˆ¶å¤±è´¥ï¼ˆå¦‚ç£ç›˜ç©ºé—´ä¸è¶³ï¼‰ï¼Œä¹Ÿä¸ä¼šå› å½•åˆ¶æ—¶æŠ¢å èµ„æºï¼ˆCPUå ç”¨ç‡è¿‡é«˜ï¼‰è€Œå¯¼è‡´å…¶ä»–åº”ç”¨å‡ºç°é—®é¢˜ç­‰ï¼›ç¼ºç‚¹æ˜¯å®ç°çš„å¤æ‚åº¦å¾ˆé«˜ã€‚ä¸è¿‡ç”±äºæœ¬æ–‡è¦é‡ç‚¹è®²è§£çš„æ˜¯æ¥ä¸‹æ¥çš„å®¢æˆ·ç«¯å½•åˆ¶ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å°±ä¸å†æ·±å…¥å±•å¼€è®²è§£äº†ï¼Œä½ åªéœ€è¦çŸ¥é“æœ‰æœåŠ¡ç«¯å½•åˆ¶è¿™å›äº‹å°±è¡Œäº†ï¼Œæˆ–è€…å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæœç´¢å­¦ä¹ ã€‚</p>\n</li>\n<li>\n<p><strong>å®¢æˆ·ç«¯å½•åˆ¶</strong>ï¼šä¼˜ç‚¹æ˜¯æ–¹ä¾¿å½•åˆ¶æ–¹ï¼ˆå¦‚è€å¸ˆï¼‰æ“æ§ï¼Œå¹¶ä¸”æ‰€å½•åˆ¶çš„è§†é¢‘æ¸…æ™°åº¦é«˜ï¼Œå®ç°ç›¸å¯¹ç®€å•ã€‚è¿™é‡Œå¯ä»¥å’ŒæœåŠ¡ç«¯å½•åˆ¶åšä¸ªå¯¹æ¯”ï¼Œä¸€èˆ¬å®¢æˆ·ç«¯æ‘„åƒå¤´çš„åˆ†è¾¨ç‡éƒ½éå¸¸é«˜çš„ï¼ˆå¦‚1280x720ï¼‰ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯å½•åˆ¶å¯ä»¥å½•åˆ¶å‡ºéå¸¸æ¸…æ™°çš„è§†é¢‘ï¼›ä½†æœåŠ¡ç«¯å½•åˆ¶è¦åšåˆ°è¿™ç‚¹å°±å¾ˆå›°éš¾äº†ï¼Œæœ¬åœ°é«˜æ¸…çš„è§†é¢‘åœ¨ä¸Šä¼ æœåŠ¡ç«¯æ—¶ç”±äºç½‘ç»œå¸¦å®½ä¸è¶³ï¼Œè§†é¢‘çš„åˆ†è¾¨ç‡å¾ˆæœ‰å¯èƒ½ä¼šè¢«è‡ªåŠ¨ç¼©å°åˆ°äº†640x360ï¼Œè¿™å°±å¯¼è‡´ç”¨æˆ·å›çœ‹æ—¶è§†é¢‘ç‰¹åˆ«æ¨¡ç³Šï¼Œç”¨æˆ·ä½“éªŒå·®ã€‚ä¸è¿‡å®¢æˆ·ç«¯å½•åˆ¶ä¹Ÿæœ‰å¾ˆæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„ç¼ºç‚¹å°±æ˜¯å½•åˆ¶å¤±è´¥ç‡é«˜ã€‚å› ä¸ºå®¢æˆ·ç«¯åœ¨è¿›è¡Œå½•åˆ¶æ—¶ä¼šå¼€å¯ç¬¬äºŒè·¯ç¼–ç å™¨ï¼Œè¿™æ ·ä¼šç‰¹åˆ«è€—CPUã€‚è€ŒCPUå ç”¨è¿‡é«˜åï¼Œå°±å¾ˆå®¹æ˜“é€ æˆåº”ç”¨ç¨‹åºå¡æ­»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒå¯¹å†…å­˜ã€ç¡¬ç›˜çš„è¦æ±‚ä¹Ÿç‰¹åˆ«é«˜ã€‚</p>\n</li>\n</ul><!-- [[[read_end]]] --><p>è¿™é‡Œéœ€è¦å†æ¬¡è¯´æ˜çš„æ˜¯ï¼Œç”±äºæœ¬ä¸“æ çš„æ–‡ç« æ˜¯<strong>èšç„¦åœ¨ WebRTC çš„ä½¿ç”¨ä¸Š</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè®²<strong>å¦‚ä½•ä½¿ç”¨ WebRTC åº“å®ç°å®¢æˆ·ç«¯å½•åˆ¶éŸ³è§†é¢‘æµ</strong>ã€‚è‡³äºæœåŠ¡ç«¯å½•åˆ¶çš„ç›¸å…³çŸ¥è¯†ï¼Œç”±äºä¸ WebRTCåº“æ— å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸åšè¿›ä¸€æ­¥è®²è§£äº†ã€‚</p><h2>åœ¨WebRTCå¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®</h2><p>åœ¨æ­£å¼è¿›å…¥ä¸»é¢˜ä¹‹å‰ï¼Œå’±ä»¬ä¾æ—§å…ˆæ¥çœ‹ä¸€ä¸‹æœ¬æ–‡åœ¨ WebRTC å¤„ç†è¿‡ç¨‹ä¸­çš„ä½ç½®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a6/43/a6026c3e5a50450d94839f5bc6ca5043.png?wh=1015*526\" alt=\"\"></p><center><span class=\"reference\">WebRTC 1å¯¹1éŸ³è§†é¢‘å®æ—¶é€šè¯è¿‡ç¨‹ç¤ºæ„å›¾</span></center><p>é€šè¿‡ä¸Šå›¾å¯ä»¥äº†è§£åˆ°ï¼Œå’±ä»¬æœ¬æ–‡æ‰€è®²çš„å†…å®¹å°±æ˜¯<strong>éŸ³è§†é¢‘é‡‡é›†</strong>ä¸‹é¢çš„<strong>å½•åˆ¶åŠŸèƒ½</strong>ã€‚</p><h2>åŸºæœ¬åŸç†</h2><p>å½•åˆ¶çš„åŸºæœ¬åŸç†è¿˜æ˜¯è›®ç®€å•çš„ï¼Œä½†è¦åšå¥½å´å¾ˆä¸å®¹æ˜“ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªé‡è¦çš„é—®é¢˜éœ€è¦ä½ ææ¸…æ¥šã€‚</p><p><strong>ç¬¬ä¸€ä¸ªï¼Œå½•åˆ¶åéŸ³è§†é¢‘æµçš„å­˜å‚¨æ ¼å¼æ˜¯ä»€ä¹ˆå‘¢</strong>ï¼Ÿæ¯”å¦‚ï¼Œæ˜¯ç›´æ¥å½•åˆ¶åŸå§‹æ•°æ®ï¼Œè¿˜æ˜¯å½•åˆ¶æˆæŸç§å¤šåª’ä½“æ ¼å¼ï¼ˆå¦‚ MP4 ï¼‰ï¼Ÿä½ å¯èƒ½ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆè¦è€ƒè™‘å­˜å‚¨æ ¼å¼é—®é¢˜å‘¢ï¼Ÿç›´æ¥é€‰æ‹©ä¸€ä¸ªä¸å°±å¥½äº†ï¼Ÿä½†å…¶å®<strong>å­˜å‚¨æ ¼å¼çš„é€‰æ‹©å¯¹äºå½•åˆ¶åçš„å›æ”¾è‡³å…³é‡è¦</strong>ï¼Œè¿™é‡Œæˆ‘å…ˆç•™ä¸ªæ‚¬å¿µä¸ç»†è¯´ï¼Œç­‰çœ‹åˆ°åé¢çš„å†…å®¹ä½ è‡ªç„¶å°±ä¼šç†è§£å®ƒçš„é‡è¦æ€§ä¸å±€é™æ€§äº†ã€‚</p><p><strong>ç¬¬äºŒä¸ªï¼Œå½•åˆ¶ä¸‹æ¥çš„éŸ³è§†é¢‘æµå¦‚ä½•æ’­æ”¾</strong>ï¼Ÿæ˜¯ä½¿ç”¨æ™®é€šçš„æ’­æ”¾å™¨æ’­æ”¾ï¼Œè¿˜æ˜¯ä½¿ç”¨ç§æœ‰æ’­æ”¾å™¨æ’­å‘¢ï¼Ÿå…¶å®ï¼Œè¿™ä¸ä½ çš„ä¸šåŠ¡æ¯æ¯ç›¸å…³ã€‚å¦‚æœä½ çš„ä¸šåŠ¡æ˜¯å¤šäººäº’åŠ¨ç±»å‹ï¼Œä¸”å›æ”¾æ—¶ä¹Ÿè¦å’Œç›´æ’­æ—¶ä¸€æ ·ï¼Œé‚£ä¹ˆä½ å°±å¿…é¡»ä½¿ç”¨ç§æœ‰æ’­æ”¾å™¨ï¼Œå› ä¸ºæ™®é€šæ’­æ”¾å™¨æ˜¯ä¸æ”¯æŒåŒæ—¶æ’­æ”¾å¤šè·¯è§†é¢‘çš„ã€‚è¿˜æœ‰ï¼Œå¦‚æœä½ æƒ³è®©æµè§ˆå™¨ä¹Ÿèƒ½è§‚çœ‹å›æ”¾ï¼Œé‚£ä¹ˆå°±éœ€è¦æä¾›ç½‘é¡µæ’­æ”¾å™¨ã€‚</p><p><strong>ç¬¬ä¸‰ä¸ªï¼Œå¯åŠ¨å½•åˆ¶åå¤šä¹…å¯ä»¥å›æ”¾å‘¢</strong>ï¼Ÿè¿™ä¸ªé—®é¢˜åˆåˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µã€‚</p><ul>\n<li>è¾¹å½•è¾¹çœ‹ï¼Œå³å¼€å§‹å½•åˆ¶å‡ åˆ†é’Ÿä¹‹åç”¨æˆ·å°±å¯ä»¥è§‚çœ‹äº†ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è§‚çœ‹ä¸€äº›é‡å¤§ä½“è‚²èµ›äº‹æ—¶ï¼ˆå¦‚ä¸–ç•Œæ¯ï¼‰ï¼Œä¸€èˆ¬éƒ½æ˜¯æ­£å¼å¼€å§‹ä¸€å°æ®µæ—¶é—´ä¹‹åè§‚ä¼—æ‰èƒ½çœ‹åˆ°ï¼Œä»¥ç¡®ä¿å‘ç”Ÿçªå‘äº‹ä»¶æ—¶å¯ä»¥åšç´§æ€¥å¤„ç†ã€‚</li>\n<li>å½•åˆ¶å®Œç«‹å³å›æ”¾ï¼Œå³å½“å½•åˆ¶ç»“æŸåï¼Œç”¨æˆ·å°±å¯ä»¥å›çœ‹å½•åˆ¶äº†ã€‚æ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸€äº›æŠ€æœ¯æ¯”è¾ƒå¥½çš„æ•™è‚²å…¬å¸çš„ç›´æ’­è¯¾ï¼Œå½•åˆ¶å®Œæˆåå°±å¯ä»¥ç›´æ¥çœ‹å›æ”¾äº†ã€‚</li>\n<li>å½•å®Œåè¿‡ä¸€æ®µæ—¶é—´å¯è§‚çœ‹ã€‚å¤§å¤šæ•°çš„ç›´æ’­ç³»ç»Ÿéƒ½æ˜¯å½•åˆ¶å®Œæˆåè¿‡ä¸€æ®µæ—¶é—´æ‰å¯ä»¥çœ‹å›æ”¾ï¼Œå› ä¸ºå½•åˆ¶å®Œæˆåè¿˜è¦å¯¹éŸ³è§†é¢‘åšä¸€äº›å‰ªè¾‘ã€è½¬ç ï¼Œåˆ¶ä½œå„ç§ä¸åŒçš„æ¸…æ™°åº¦çš„å›æ”¾ç­‰ç­‰ã€‚</li>\n</ul><p>æ¥ä¸‹æ¥ï¼Œå’±ä»¬å°±é’ˆå¯¹ä¸Šé¢çš„é—®é¢˜è¯¦ç»†åˆ†æä¸€ä¸‹ã€‚æˆ‘ä»¬å…ˆä»å­˜å‚¨æ ¼å¼çš„é‡è¦æ€§å’Œå±€é™æ€§åˆ‡å…¥ï¼Œä¹Ÿæ­£å¥½è§£ç­”ä¸‹å‰é¢æ‰€ç•™çš„æ‚¬å¿µã€‚</p><p>å½•åˆ¶åŸå§‹æ•°æ®çš„ä¼˜ç‚¹æ˜¯ä¸ç”¨åšè¿‡å¤šçš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¥ä»€ä¹ˆæ•°æ®å°±å½•åˆ¶ä»€ä¹ˆæ•°æ®ï¼Œè¿™æ ·å½•åˆ¶æ•ˆç‡é«˜ï¼Œä¸å®¹æ˜“å‡ºé”™ï¼›å¹¶ä¸”å½•åˆ¶æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¯ä»¥å°†éŸ³é¢‘æ•°æ®ä¸è§†é¢‘æ•°æ®åˆ†åˆ«å­˜æ”¾åˆ°ä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚æ–‡ä»¶ä¸­çš„æ¯ä¸€å—æ•°æ®å¯ä»¥ç”±ä¸‹é¢çš„ç»“æ„ä½“æè¿°ï¼š</p><pre><code>struct data \n    int media_type; // æ•°æ®ç±»å‹ï¼Œ0: éŸ³é¢‘ 1: è§†é¢‘\n    int64_t ts;     // timestampï¼Œè®°å½•æ•°æ®æ”¶åˆ°çš„æ—¶é—´\n    int data_size;  // æ•°æ®å¤§å°\n    char* data;     // æŒ‡å®šå…·ä½“çš„æ•°æ®\n}media_data;\n</code></pre><p>å½“å½•åˆ¶ç»“æŸåï¼Œå†å°†å½•åˆ¶å¥½çš„éŸ³è§†é¢‘äºŒè¿›åˆ¶æ–‡ä»¶æ•´åˆæˆæŸç§å¤šåª’ä½“æ–‡ä»¶ï¼Œå¦‚FLVã€MP4ç­‰ã€‚</p><p>ä½†å®ƒçš„å¼Šç«¯æ˜¯ï¼Œå½•åˆ¶å®Œæˆåç”¨æˆ·è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½çœ‹åˆ°å½•åˆ¶çš„è§†é¢‘ã€‚å› ä¸ºåœ¨å½•åˆ¶å®Œæˆåï¼Œå®ƒè¿˜è¦åšéŸ³è§†é¢‘åˆæµã€è¾“å‡ºå¤šåª’ä½“æ–‡ä»¶ç­‰å·¥ä½œã€‚</p><p>é‚£ç›´æ¥å½•åˆ¶æˆæŸç§å¤šåª’ä½“æ ¼å¼ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚æœä½ å¯¹å¤šåª’ä½“æ–‡ä»¶æ ¼å¼éå¸¸ç†Ÿæ‚‰çš„è¯ï¼Œåº”è¯¥çŸ¥é“ <strong>FLV</strong> æ ¼å¼ç‰¹åˆ«é€‚åˆå¤„ç†è¿™ç§æµå¼æ•°æ®ã€‚å› ä¸ºFLVåª’ä½“æ–‡ä»¶æœ¬èº«å°±æ˜¯æµå¼çš„ï¼Œä½ å¯ä»¥åœ¨FLVæ–‡ä»¶çš„ä»»ä½•ä½ç½®è¿›è¡Œè¯»å†™æ“ä½œï¼Œå®ƒéƒ½å¯ä»¥æ­£å¸¸è¢«å¤„ç†ã€‚å› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨ FLV çš„è¯ï¼Œå°±ä¸ç”¨åƒå‰é¢å½•åˆ¶åŸå§‹æ•°æ®é‚£æ ·å…ˆå°†äºŒåˆ¶æ•°æ®å­˜å‚¨ä¸‹æ¥ï¼Œä¹‹åå†è¿›è¡Œåˆæµã€è½¬ç é‚£ä¹ˆéº»çƒ¦äº†ã€‚</p><p>ä¸ä»…å¦‚æ­¤ï¼Œé‡‡ç”¨ FLV åª’ä½“æ ¼å¼è¿›è¡Œå½•åˆ¶ï¼Œä½ è¿˜å¯ä»¥å†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå°†ç›´æ’­çš„è§†é¢‘æŒ‰ <strong>N</strong> åˆ†é’Ÿä¸ºå•ä½ï¼Œå½•åˆ¶æˆä¸€æ®µä¸€æ®µçš„ FLVï¼Œç„¶åå½•å®Œä¸€æ®µæ’­ä¸€æ®µï¼Œè¿™æ ·å°±å®ç°äº†ä¸Šé¢æ‰€è®²çš„<strong>è¾¹å½•è¾¹çœ‹</strong>çš„æ•ˆæœäº†ã€‚</p><p>ä½†FLVä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ã€‚å¦‚æœä½ çš„åœºæ™¯æ¯”è¾ƒå¤æ‚ï¼ˆå¦‚å¤šäººäº’åŠ¨çš„åœºæ™¯ï¼‰ï¼Œå³åŒæ—¶å­˜åœ¨å¤šè·¯è§†é¢‘ï¼ŒFLV æ ¼å¼å°±æ— æ³•æ»¡è¶³ä½ çš„éœ€æ±‚äº†ï¼Œå› ä¸º FLV åªèƒ½åŒæ—¶å­˜åœ¨ä¸€è·¯è§†é¢‘å’Œä¸€è·¯éŸ³é¢‘ï¼Œè€Œä¸èƒ½åŒæ—¶å­˜åœ¨å¤šè·¯è§†é¢‘è¿™ç§æƒ…å†µã€‚æ­¤æ—¶ï¼Œæœ€å¥½çš„æ–¹æ³•è¿˜æ˜¯å½•åˆ¶åŸå§‹æ•°æ®ï¼Œç„¶åé€šè¿‡å®ç°ç§æœ‰æ’­æ”¾å™¨æ¥è¾¾åˆ°ç”¨æˆ·çš„éœ€æ±‚ã€‚</p><p>å½“ç„¶ï¼Œå³ä½¿æ˜¯å•è§†é¢‘çš„æƒ…å†µä¸‹ï¼ŒFLVçš„æ–¹æ¡ˆçœ‹ä¸Šå»å¾ˆå®Œç¾ï¼Œä½†å®é™…æƒ…å†µä¹Ÿä¸ä¸€å®šåƒä½ æƒ³è±¡çš„é‚£æ ·ç¾å¥½ã€‚å› ä¸ºå°†éŸ³è§†é¢‘æµå­˜æˆ FLV æ–‡ä»¶çš„å‰ææ¡ä»¶æ˜¯éŸ³è§†é¢‘æµæ˜¯æŒ‰é¡ºåºæ¥çš„ï¼Œè€Œå®é™…ä¸Šï¼ŒéŸ³è§†é¢‘æ•°æ®ç»è¿‡ UDP è¿™ç§ä¸å¯é ä¼ è¾“ç½‘ç»œæ—¶ï¼Œæ˜¯æ— æ³•ä¿è¯éŸ³è§†é¢‘æ•°æ®åˆ°è¾¾çš„å…ˆåé¡ºåºçš„ã€‚å› æ­¤ï¼Œåœ¨å¤„ç†éŸ³è§†é¢‘å½•åˆ¶æ—¶ï¼Œä½ ä¸ä»…è¦è€ƒè™‘å½•åˆ¶çš„äº‹æƒ…ï¼Œè¿˜è¦è‡ªå·±åšéŸ³è§†é¢‘æ•°æ®æ’åºçš„å·¥ä½œã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„å·¥ä½œéœ€è¦å¤„ç†ï¼Œè¿™é‡Œæˆ‘å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p><p>ä¸è¿‡ï¼Œå¥½åœ¨ WebRTC å·²ç»å¤„ç†å¥½äº†ä¸€åˆ‡ã€‚æœ‰äº† WebRTCï¼Œ ä½ ä¸ç”¨å†è€ƒè™‘å°†éŸ³è§†é¢‘ä¿å­˜æˆä»€ä¹ˆåª’ä½“æ ¼å¼çš„é—®é¢˜ï¼›æœ‰äº† WebRTC ï¼Œä½ ä¸ç”¨å†è€ƒè™‘ç½‘ç»œä¸¢åŒ…çš„é—®é¢˜ï¼›æœ‰äº†WebRTCï¼Œä½ ä¸ç”¨å†è€ƒè™‘éŸ³è§†é¢‘æ•°æ®ä¹±åºçš„é—®é¢˜â€¦â€¦è¿™ä¸€ç³»åˆ—æ¼äººçš„é—®é¢˜ï¼ŒWebRTC éƒ½å¸®ä½ æå®šäº†ã€‚ä¸‹é¢å°±è®©æˆ‘ä»¬èµ¶ç´§åº”ç”¨èµ·æ¥ï¼Œçœ‹ä¸€ä¸‹ WebRTC æ˜¯å¦‚ä½•è¿›è¡Œå®¢æˆ·ç«¯å½•åˆ¶çš„å§ï¼</p><h2>åŸºç¡€çŸ¥è¯†</h2><p>ä¸ºä¾¿äºä½ æ›´å¥½åœ°ç†è§£ï¼Œåœ¨å­¦ä¹ å¦‚ä½•ä½¿ç”¨ WebRTC å®ç°å®¢æˆ·ç«¯å½•åˆ¶ä¹‹å‰ï¼Œä½ è¿˜éœ€è¦å…ˆäº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚</p><p>åœ¨ JavaScript ä¸­ï¼Œæœ‰å¾ˆå¤šç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®çš„ç±»å‹ï¼Œè¿™äº›ç±»å‹åŒ…æ‹¬ï¼šArrayBufferã€ArrayBufferViewå’ŒBlobã€‚é‚£è¿™ä¸‰è€…ä¸æˆ‘ä»¬ä»Šå¤©è¦è®²çš„å½•åˆ¶éŸ³è§†é¢‘æµæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p><p><strong>WebRTC å½•åˆ¶éŸ³è§†é¢‘æµä¹‹åï¼Œæœ€ç»ˆæ˜¯é€šè¿‡ Blob å¯¹è±¡å°†æ•°æ®ä¿å­˜æˆå¤šåª’ä½“æ–‡ä»¶çš„</strong>ï¼›è€Œ Blob åˆä¸ArrayBufferæœ‰ç€å¾ˆå¯†åˆ‡çš„å…³ç³»ã€‚é‚£ArryaBuffer ä¸ ArrayBufferView åˆæœ‰ä»€ä¹ˆè”ç³»å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±äº†è§£ä¸€ä¸‹è¿™3ç§äºŒè¿›åˆ¶æ•°æ®ç±»å‹ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å§ã€‚</p><h3>1. ArrayBuffer</h3><p>ArrayBuffer å¯¹è±¡è¡¨ç¤ºé€šç”¨çš„ã€å›ºå®šé•¿åº¦çš„äºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒå­˜å‚¨å›¾ç‰‡ã€è§†é¢‘ç­‰å†…å®¹ã€‚</p><p>ä½†ä½ å¹¶ä¸èƒ½ç›´æ¥å¯¹ ArrayBuffer å¯¹è±¡è¿›è¡Œè®¿é—®ï¼Œç±»ä¼¼äº Java è¯­è¨€ä¸­çš„æŠ½è±¡ç±»ï¼Œåœ¨ç‰©ç†å†…å­˜ä¸­å¹¶ä¸å­˜åœ¨è¿™æ ·ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»ä½¿ç”¨å…¶<strong>å°è£…ç±»</strong>è¿›è¡Œå®ä¾‹åŒ–åæ‰èƒ½è¿›è¡Œè®¿é—®ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ ArrayBuffer åªæ˜¯æè¿°æœ‰è¿™æ ·ä¸€å—ç©ºé—´å¯ä»¥ç”¨æ¥å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®ï¼Œä½†åœ¨è®¡ç®—æœºçš„å†…å­˜ä¸­å¹¶æ²¡æœ‰çœŸæ­£åœ°ä¸ºå…¶åˆ†é…ç©ºé—´ã€‚åªæœ‰å½“å…·ä½“ç±»å‹åŒ–åï¼Œå®ƒæ‰çœŸæ­£åœ°å­˜åœ¨äºå†…å­˜ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>let buffer = new ArrayBuffer(16); // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º 16 çš„ buffer\nlet view = new Uint32Array(buffer);\n</code></pre><p>æˆ–</p><pre><code>let buffer = new Uint8Array([255, 255, 255, 255]).buffer;\nlet dataView = new DataView(buffer);\n</code></pre><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸€å¼€å§‹ç”Ÿæˆçš„bufferæ˜¯ä¸èƒ½è¢«ç›´æ¥è®¿é—®çš„ã€‚åªæœ‰å°†bufferåšä¸ºå‚æ•°ç”Ÿæˆä¸€ä¸ªå…·ä½“çš„ç±»å‹çš„æ–°å¯¹è±¡æ—¶ï¼ˆå¦‚ Uint32Array æˆ– DataViewï¼‰ï¼Œè¿™ä¸ªæ–°ç”Ÿæˆçš„å¯¹è±¡æ‰èƒ½è¢«è®¿é—®ã€‚</p><h3>2. ArrayBufferView</h3><p>ArrayBufferView å¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼Œè€Œæ˜¯ä»£è¡¨ä¸åŒç±»å‹çš„Arrayçš„æè¿°ã€‚è¿™äº›ç±»å‹åŒ…æ‹¬ï¼šInt8Arrayã€Uint8Arrayã€DataViewç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´Int8Arrayã€Uint8Arrayç­‰æ‰æ˜¯JavaScriptåœ¨å†…å­˜ä¸­çœŸæ­£å¯ä»¥åˆ†é…çš„å¯¹è±¡ã€‚</p><p>ä»¥ Int8Array ä¸ºä¾‹ï¼Œå½“ä½ å¯¹å…¶å®ä¾‹åŒ–æ—¶ï¼Œè®¡ç®—æœºå°±ä¼šåœ¨å†…å­˜ä¸­ä¸ºå…¶åˆ†é…ä¸€å—ç©ºé—´ï¼Œåœ¨è¯¥ç©ºé—´ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯8ä½çš„æ•´æ•°ã€‚å†ä»¥Uint8Arrayä¸ºä¾‹ï¼Œå®ƒè¡¨è¾¾çš„æ˜¯åœ¨å†…å­˜ä¸­åˆ†é…ä¸€å—æ¯ä¸ªå…ƒç´ å¤§å°ä¸º8ä½çš„æ— ç¬¦å·æ•´æ•°çš„ç©ºé—´ã€‚</p><p>é€šè¿‡è¿™ä¸Šé¢çš„æè¿°ï¼Œä½ ç°åœ¨åº”è¯¥çŸ¥é“ ArrayBuffer ä¸ ArrayBufferView çš„åŒºåˆ«äº†å§ï¼ŸArrayBufferView æŒ‡çš„æ˜¯ Int8Arrayã€Uint8Arrayã€DataViewç­‰ç±»å‹çš„æ€»ç§°ï¼Œè€Œè¿™äº›ç±»å‹éƒ½æ˜¯ä½¿ç”¨ ArrayBuffer ç±»å®ç°çš„ï¼Œå› æ­¤æ‰ç»Ÿç§°ä»–ä»¬ä¸º ArrayBufferViewã€‚</p><h3>3. Blob</h3><p>Blobï¼ˆBinary Large Objectï¼‰æ˜¯ JavaScript çš„å¤§å‹äºŒè¿›åˆ¶å¯¹è±¡ç±»å‹ï¼ŒWebRTC æœ€ç»ˆå°±æ˜¯ä½¿ç”¨å®ƒå°†å½•åˆ¶å¥½çš„éŸ³è§†é¢‘æµä¿å­˜æˆå¤šåª’ä½“æ–‡ä»¶çš„ã€‚è€Œå®ƒçš„åº•å±‚æ˜¯ç”±ä¸Šé¢æ‰€è®²çš„ ArrayBuffer å¯¹è±¡çš„å°è£…ç±»å®ç°çš„ï¼Œå³ Int8Arrayã€Uint8Arrayç­‰ç±»å‹ã€‚</p><p>Blob å¯¹è±¡çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><pre><code>var aBlob = new Blob( array, options );\n</code></pre><p>å…¶ä¸­ï¼Œarray å¯ä»¥æ˜¯<strong>ArrayBufferã€ArrayBufferViewã€Blobã€DOMString</strong>ç­‰ç±»å‹ ï¼›optionï¼Œç”¨äºæŒ‡å®šå­˜å‚¨æˆçš„åª’ä½“ç±»å‹ã€‚</p><p>ä»‹ç»å®Œäº†è¿™å‡ ä¸ªä½ éœ€è¦äº†è§£çš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¹¦å½’æ­£ä¼ ï¼Œçœ‹çœ‹å¦‚ä½•å½•åˆ¶æœ¬åœ°éŸ³è§†é¢‘ã€‚</p><h2>å¦‚ä½•å½•åˆ¶æœ¬åœ°éŸ³è§†é¢‘</h2><p>WebRTC ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ç±»ï¼Œå³ <strong>MediaRecorder</strong>ã€‚åˆ›å»º MediaRecorder å¯¹è±¡çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><pre><code>var mediaRecorder = new MediaRecorder(stream[, options]);\n</code></pre><p>å…¶å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š</p><ul>\n<li>streamï¼Œé€šè¿‡ getUserMedia è·å–çš„æœ¬åœ°è§†é¢‘æµæˆ–é€šè¿‡ RTCPeerConnection è·å–çš„è¿œç¨‹è§†é¢‘æµã€‚</li>\n<li>optionsï¼Œå¯é€‰é¡¹ï¼ŒæŒ‡å®šè§†é¢‘æ ¼å¼ã€ç¼–è§£ç å™¨ã€ç ç‡ç­‰ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ <code>mimeType: 'video/webm;codecs=vp8'</code>ã€‚</li>\n</ul><p>MediaRecorder å¯¹è±¡è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«é‡è¦çš„äº‹ä»¶ï¼Œå³ <strong>ondataavailable</strong> äº‹ä»¶ã€‚å½“MediaRecoderæ•è·åˆ°æ•°æ®æ—¶å°±ä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬æ‰èƒ½å°†éŸ³è§†é¢‘æ•°æ®å½•åˆ¶ä¸‹æ¥ã€‚</p><p>æœ‰äº†ä¸Šé¢è¿™äº›çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å…·ä½“è¯¥å¦‚ä½•ä½¿ç”¨ä¸Šé¢çš„å¯¹è±¡æ¥å½•åˆ¶éŸ³è§†é¢‘æµå§ï¼</p><h3>1. å½•åˆ¶éŸ³è§†é¢‘æµ</h3><p>é¦–å…ˆæ˜¯è·å–æœ¬åœ°éŸ³è§†é¢‘æµã€‚åœ¨<a href=\"https://time.geekbang.org/column/article/107948\">ã€Š01 | åŸæ¥é€šè¿‡æµè§ˆå™¨è®¿é—®æ‘„åƒå¤´è¿™ä¹ˆå®¹æ˜“ã€‹</a>ä¸€æ–‡ä¸­ï¼Œæˆ‘å·²ç»è®²è¿‡å¦‚ä½•é€šè¿‡æµè§ˆå™¨é‡‡é›†éŸ³è§†é¢‘æ•°æ®ï¼Œå…·ä½“å°±æ˜¯è°ƒç”¨æµè§ˆå™¨ä¸­çš„ <strong>getUserMedia</strong> æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p><p>è·å–åˆ°éŸ³è§†é¢‘æµåï¼Œä½ å¯ä»¥å°†è¯¥æµå½“ä½œå‚æ•°ä¼ ç»™ MediaRecorder å¯¹è±¡ï¼Œå¹¶å®ç° <strong>ondataavailable</strong> äº‹ä»¶ï¼Œæœ€ç»ˆå°†éŸ³è§†é¢‘æµå½•åˆ¶ä¸‹æ¥ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ HTML éƒ¨åˆ†ï¼š</p><pre><code>&lt;html&gt;\n...\n&lt;body&gt;\n    ...\n    &lt;button id=&quot;record&quot;&gt;Start Record&lt;/button&gt;\n    &lt;button id=&quot;recplay&quot; disabled&gt;Play&lt;/button&gt;\n    &lt;button id=&quot;download&quot; disabled&gt;Download&lt;/button&gt;\n    ...\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre><p>ä¸Šé¢çš„ HTML ä»£ç ç‰‡æ®µå®šä¹‰äº†ä¸‰ä¸ª <strong>button</strong>ï¼Œä¸€ä¸ªç”¨äºå¼€å¯å½•åˆ¶ï¼Œä¸€ä¸ªç”¨äºæ’­æ”¾å½•åˆ¶ä¸‹æ¥çš„å†…å®¹ï¼Œæœ€åä¸€ä¸ªç”¨äºå°†å½•åˆ¶çš„è§†é¢‘ä¸‹è½½ä¸‹æ¥ã€‚ç„¶åæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ JavaScript æ§åˆ¶éƒ¨åˆ†çš„ä»£ç ï¼š</p><pre><code>...\n\nvar buffer;\n\n...\n\n//å½“è¯¥å‡½æ•°è¢«è§¦å‘åï¼Œå°†æ•°æ®å‹å…¥åˆ°blobä¸­\nfunction handleDataAvailable(e){\n        if(e &amp;&amp; e.data &amp;&amp; e.data.size &gt; 0){\n                buffer.push(e.data);\n        }\n}\n\nfunction startRecord(){\n\n        buffer = [];\n\n        //è®¾ç½®å½•åˆ¶ä¸‹æ¥çš„å¤šåª’ä½“æ ¼å¼ \n        var options = {\n                mimeType: 'video/webm;codecs=vp8'\n        }\n\n        //åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒå½•åˆ¶\n        if(!MediaRecorder.isTypeSupported(options.mimeType)){\n                console.error(`${options.mimeType} is not supported!`);\n                return;\n        }\n\n        try{\n                //åˆ›å»ºå½•åˆ¶å¯¹è±¡\n                mediaRecorder = new MediaRecorder(window.stream, options);\n        }catch(e){\n                console.error('Failed to create MediaRecorder:', e);\n                return;\n        }\n\n        //å½“æœ‰éŸ³è§†é¢‘æ•°æ®æ¥äº†ä¹‹åè§¦å‘è¯¥äº‹ä»¶\n        mediaRecorder.ondataavailable = handleDataAvailable;\n        //å¼€å§‹å½•åˆ¶\n        mediaRecorder.start(10);\n}\n\n...\n</code></pre><p>å½“ä½ ç‚¹å‡» Record æŒ‰é’®çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨ <strong>startRecord</strong> å‡½æ•°ã€‚åœ¨è¯¥å‡½æ•°ä¸­é¦–å…ˆåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒæŒ‡å®šçš„å¤šåª’ä½“æ ¼å¼ï¼Œå¦‚ webmã€‚ å¦‚æœæ”¯æŒçš„è¯ï¼Œå†åˆ›å»º<br>\nMediaRecorder å¯¹è±¡ï¼Œå°†éŸ³è§†é¢‘æµå½•åˆ¶æˆæŒ‡å®šçš„åª’ä½“æ ¼å¼æ–‡ä»¶ã€‚</p><p>å®é™…å­˜å‚¨æ—¶ï¼Œæ˜¯é€šè¿‡ ondataavailable äº‹ä»¶æ“ä½œçš„ã€‚æ¯å½“ondataavailableäº‹ä»¶è§¦å‘æ—¶ï¼Œå°±ä¼šè°ƒç”¨handleDataAvailableå‡½æ•°ã€‚è¯¥å‡½æ•°çš„å®ç°å°±ç‰¹åˆ«ç®€å•äº†ï¼Œç›´æ¥å°†æ•°æ® push åˆ° buffer ä¸­ï¼Œå®é™…åœ¨æµè§ˆå™¨åº•å±‚ä½¿ç”¨çš„æ˜¯Blobå¯¹è±¡ã€‚</p><p>å¦å¤–ï¼Œåœ¨å¼€å¯å½•åˆ¶æ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªæ¯«ç§’çº§çš„æ—¶é—´ç‰‡ï¼Œè¿™æ ·å½•åˆ¶çš„åª’ä½“æ•°æ®ä¼šæŒ‰ç…§ä½ è®¾ç½®çš„å€¼åˆ†å‰²æˆä¸€ä¸ªä¸ªå•ç‹¬çš„åŒºå—ï¼Œå¦åˆ™é»˜è®¤çš„æ–¹å¼æ˜¯å½•åˆ¶ä¸€ä¸ªéå¸¸å¤§çš„æ•´å—å†…å®¹ã€‚åˆ†æˆä¸€å—ä¸€å—çš„åŒºå—ä¼šæé«˜æ•ˆç‡å’Œå¯é æ€§ï¼Œå¦‚æœæ˜¯ä¸€æ•´å—æ•°æ®ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ•°æ®å—è¶Šæ¥è¶Šå¤§ï¼Œè¯»å†™æ•ˆç‡å°±ä¼šå˜å·®ï¼Œè€Œä¸”å¢åŠ äº†å†™å…¥æ–‡ä»¶çš„å¤±è´¥ç‡ã€‚</p><h3>2. å›æ”¾å½•åˆ¶æ–‡ä»¶</h3><p>é€šè¿‡ä¸Šé¢çš„æ–¹æ³•å½•åˆ¶å¥½å†…å®¹åï¼Œåˆè¯¥å¦‚ä½•è¿›è¡Œå›æ”¾å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç å§ï¼</p><p>åœ¨ HTML ä¸­å¢åŠ ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code>...\n&lt;video id=&quot;recvideo&quot;&gt;&lt;/video&gt;\n...\n</code></pre><p>åœ¨HTMLä¸­åªå¢åŠ äº†ä¸€ä¸ª <code>&lt;video&gt;</code>æ ‡ç­¾ï¼Œç”¨äºæ’­æ”¾å½•åˆ¶çš„å†…å®¹ã€‚ä¸‹é¢çš„ JavaScript æ˜¯å°†å½•åˆ¶å†…å®¹ä¸<code>&lt;video&gt;</code>æ ‡ç­¾è”æ¥åˆ°ä¸€èµ·ï¼š</p><pre><code> var blob = new Blob(buffer, {type: 'video/webm'});\n recvideo.src = window.URL.createObjectURL(blob);\n recvideo.srcObject = null;\n recvideo.controls = true;\n recvideo.play();\n</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé¦–å…ˆæ ¹æ® buffer ç”Ÿæˆ Blob å¯¹è±¡ï¼›ç„¶åï¼Œæ ¹æ® Blob å¯¹è±¡ç”Ÿæˆ URLï¼Œå¹¶é€šè¿‡ <code>&lt;video&gt;</code> æ ‡ç­¾å°†å½•åˆ¶çš„å†…å®¹æ’­æ”¾å‡ºæ¥äº†ã€‚</p><h3>3. ä¸‹è½½å½•åˆ¶å¥½çš„æ–‡ä»¶</h3><p>é‚£å¦‚ä½•å°†å½•åˆ¶å¥½çš„è§†é¢‘æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å‘¢ï¼Ÿä»£ç å¦‚ä¸‹ï¼š</p><pre><code>btnDownload.onclick = ()=&gt; {\n        var blob = new Blob(buffer, {type: 'video/webm'});\n        var url = window.URL.createObjectURL(blob);\n        var a = document.createElement('a');\n\n        a.href = url;\n        a.style.display = 'none';\n        a.download = 'aaa.webm';\n        a.click();\n}\n</code></pre><p>å°†å½•åˆ¶å¥½çš„è§†é¢‘ä¸‹è½½ä¸‹æ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç‚¹å‡» <strong>download</strong> æŒ‰é’®åï¼Œå°±ä¼šè°ƒç”¨ä¸Šé¢çš„ä»£ç ã€‚åœ¨è¯¥ä»£ç ä¸­ï¼Œä¹Ÿæ˜¯å…ˆåˆ›å»ºä¸€ä¸ª Blob å¯¹è±¡ï¼Œå¹¶æ ¹æ® Blob å¯¹è±¡åˆ›å»º URLï¼›ç„¶åå†åˆ›å»ºä¸€ä¸ª <code>&lt;A&gt;</code> æ ‡ç­¾ï¼Œè®¾ç½® A æ ‡ç­¾çš„ href å’Œ downloadå±æ€§ã€‚è¿™æ ·å½“ç”¨æˆ·ç‚¹å‡»è¯¥æ ‡ç­¾ä¹‹åï¼Œå½•åˆ¶å¥½çš„æ–‡ä»¶å°±ä¸‹è½½ä¸‹æ¥äº†ã€‚</p><h2>å°ç»“</h2><p>åœ¨ç›´æ’­ç³»ç»Ÿä¸­ï¼Œä¸€èˆ¬ä¼šåŒ…æ‹¬æœåŠ¡ç«¯å½•åˆ¶å’Œå®¢æˆ·ç«¯å½•åˆ¶ï¼Œå®ƒä»¬å„æœ‰ä¼˜åŠ£ï¼Œå› æ­¤å¥½ç‚¹çš„ç›´æ’­ç³»ç»Ÿä¼šåŒæ—¶æ”¯æŒå®¢æˆ·ç«¯å½•åˆ¶ä¸æœåŠ¡ç«¯å½•åˆ¶ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œä½ åº”è¯¥å·²ç»äº†è§£äº†åœ¨æµè§ˆå™¨ä¸‹å¦‚ä½•å½•åˆ¶éŸ³è§†é¢‘æµäº†ï¼Œä½ åªéœ€è¦ä½¿ç”¨æµè§ˆå™¨ä¸­çš„ MediaRecorder å¯¹è±¡ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å½•åˆ¶æœ¬åœ°æˆ–è¿œç¨‹éŸ³è§†é¢‘æµã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä»‹ç»çš„å†…å®¹åªèƒ½å¤Ÿå®ç°ä¸€è·¯è§†é¢‘å’Œä¸€è·¯éŸ³è§†æµçš„æƒ…å†µï¼Œä½†åœ¨å®é™…çš„é¡¹ç›®ä¸­è¿˜è¦è€ƒè™‘å¤šè·¯éŸ³è§†é¢‘æµçš„æƒ…å†µï¼Œå¦‚æœ‰å¤šäººåŒæ—¶è¿›è¡ŒéŸ³è§†é¢‘äº’åŠ¨çš„æƒ…å†µï¼Œåœ¨è¿™ç§å¤æ‚åœºæ™¯ä¸‹è¯¥å¦‚ä½•å°†å®ƒä»¬å½•åˆ¶ä¸‹æ¥å‘¢ï¼Ÿå³ä½¿å½•åˆ¶ä¸‹æ¥åˆè¯¥å¦‚ä½•è¿›è¡Œå›æ”¾å‘¢ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œå¯¹äºå¤§å¤šæ•°é‡‡ç”¨å®¢æˆ·ç«¯å½•åˆ¶æ–¹æ¡ˆçš„å…¬å¸ï¼Œåœ¨å½•åˆ¶æ—¶ä¸€èˆ¬ä¸æ˜¯å½•åˆ¶éŸ³è§†é¢‘æ•°æ®ï¼Œè€Œæ˜¯å½•åˆ¶æ¡Œé¢åŠ éŸ³é¢‘ï¼Œè¿™æ ·å°±å¤§å¤§ç®€åŒ–äº†å®¢æˆ·ç«¯å®ç°å½•åˆ¶çš„å¤æ‚åº¦äº†ã€‚æˆ‘æƒ³ä½ ä¹Ÿä¸€å®šçŸ¥é“è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Œæ²¡é”™å°±æ˜¯å› ä¸ºåœ¨æ¡Œé¢ä¸Šæœ‰å…¶ä»–å‚ä¸äººçš„è§†é¢‘ï¼Œæ‰€ä»¥åªè¦å°†æ¡Œé¢å½•åˆ¶ä¸‹æ¥ï¼Œæ‰€æœ‰çš„è§†é¢‘å°±ä¸€åŒè¢«å½•åˆ¶ä¸‹æ¥äº†å“ˆï¼</p><h2>æ€è€ƒæ—¶é—´</h2><p>ä¸Šé¢æˆ‘å·²ç»ä»‹ç»äº†å¾ˆå¤šå½•åˆ¶éŸ³è§†é¢‘å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚ç°åœ¨ä½ æ€è€ƒä¸€ä¸‹ï¼Œæ˜¯å¦å¯ä»¥å°†å¤šè·¯éŸ³è§†é¢‘å½•åˆ¶åˆ°åŒä¸€ä¸ªå¤šåª’ä½“æ–‡ä»¶ä¸­å‘¢ï¼Ÿä¾‹å¦‚åœ¨å¤šäººçš„å®æ—¶ç›´æ’­ä¸­ï¼Œæœ‰ä¸‰ä¸ªäººåŒæ—¶å…±äº«è§†é¢‘ï¼Œæ˜¯å¦å¯ä»¥å°†è¿™ä¸‰ä¸ªäººçš„è§†é¢‘å†™å…¥åˆ°ä¸€ä¸ªå¤šåª’ä½“æ–‡ä»¶ä¸­å‘¢ï¼ˆå¦‚ MP4ï¼‰ï¼Ÿè¿™æ ·çš„MP4åœ¨æ’­æ”¾æ—¶ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p><a href=\"https://github.com/avdance/webrtc_web/tree/master/04_recorder/recorder\">æ‰€åšDemoçš„GitHubé“¾æ¥ï¼ˆæœ‰éœ€è¦å¯ä»¥ç‚¹è¿™é‡Œï¼‰</a></p><p></p>","comments":[{"had_liked":false,"id":116535,"user_name":"xiaoè±ª","can_delete":false,"product_type":"c1","uid":1026417,"ip_address":"","ucode":"F7969A9785E37B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a9/71/78796fd5.jpg","comment_is_top":false,"comment_ctime":1563865852,"is_pvip":false,"replies":[{"id":"42625","content":"éå¸¸æ£’ï¼","user_name":"ä½œè€…å›å¤","comment_id":116535,"uid":"1507837","ip_address":"","utype":1,"ctime":1563877932,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"27333669628","product_id":100031801,"comment_content":"ç¤ºä¾‹ä»£ç <br><br>var buffer;<br>&#47;&#47; åˆ›å»ºå½•åˆ¶å¯¹è±¡<br>var mediaRecorder;<br><br>&#47;&#47; å½“è¯¥å‡½æ•°è¢«è§¦å‘åï¼Œå°†æ•°æ®å‹å…¥åˆ° blob ä¸­<br>function handleDataAvailable(e){<br>    if(e &amp;&amp; e.data &amp;&amp; e.data.size &gt; 0){<br>            buffer.push(e.data);<br>    }<br>}<br><br>function startRecord(){<br>    &#47;&#47; é˜²æ­¢å¤šæ¬¡å¯åŠ¨æŠ¥é”™<br>    if(mediaRecorder &amp;&amp; mediaRecorder.state === &quot;recording&quot;){<br>        return;<br>    }<br><br>    buffer = [];<br><br>    &#47;&#47; è®¾ç½®å½•åˆ¶ä¸‹æ¥çš„å¤šåª’ä½“æ ¼å¼ <br>    var options = {<br>            mimeType: &#39;video&#47;webm;codecs=vp8&#39;<br>    }<br><br>    &#47;&#47; åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒå½•åˆ¶<br>    if(!MediaRecorder.isTypeSupported(options.mimeType)){<br>        console.error(`${options.mimeType} is not supported!`);<br>        return;<br>    }<br><br>    try{<br>        mediaRecorder = new MediaRecorder(videoplay.srcObject, options);<br>    }catch(e){<br>        console.error(&#39;Failed to create MediaRecorder:&#39;, e);<br>        return;<br>    }<br><br>    &#47;&#47; å½“æœ‰éŸ³è§†é¢‘æ•°æ®æ¥äº†ä¹‹åè§¦å‘è¯¥äº‹ä»¶<br>    mediaRecorder.ondataavailable = handleDataAvailable;<br>    &#47;&#47; å¼€å§‹å½•åˆ¶<br>    mediaRecorder.start(10);<br>}<br><br>function startRecplay(){<br>    console.log(mediaRecorder)<br>    var blob = new Blob(buffer, {type: &#39;video&#47;webm&#39;});<br>    recvideo.src = window.URL.createObjectURL(blob);<br>    recvideo.srcObject = null;<br>    recvideo.controls = true;<br>    recvideo.play();<br>}<br><br>function download(){<br>    var blob = new Blob(buffer, {type: &#39;video&#47;webm&#39;});<br>    var url = window.URL.createObjectURL(blob);<br>    var a = document.createElement(&#39;a&#39;);<br><br>    a.href = url;<br>    a.style.display = &#39;none&#39;;<br>    a.download = &#39;aaa.webm&#39;;<br>    a.click();<br>    a.remove();<br>}<br><br>function stop(){<br>    if(mediaRecorder &amp;&amp; (mediaRecorder.state === &quot;recording&quot; || mediaRecorder.state === &quot;paused&quot;)){<br>        mediaRecorder.stop();<br>    }<br>}","like_count":6,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459580,"discussion_content":"éå¸¸æ£’ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563877932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116546,"user_name":"è€³ä¸œ","can_delete":false,"product_type":"c1","uid":1081607,"ip_address":"","ucode":"ACD9870B93B96B","user_header":"https://static001.geekbang.org/account/avatar/00/10/81/07/dc9517b9.jpg","comment_is_top":false,"comment_ctime":1563867235,"is_pvip":false,"replies":[{"id":"42624","content":"ç»™ä½ ä¸ªå¤§å¤§çš„èµï¼","user_name":"ä½œè€…å›å¤","comment_id":116546,"uid":"1507837","ip_address":"","utype":1,"ctime":1563877913,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"23038703715","product_id":100031801,"comment_content":"Reactç‰ˆç¤ºä¾‹ä»£ç ï¼š<br>https:&#47;&#47;github.com&#47;baayso&#47;react-tic-tac-toe&#47;commits&#47;master&#47;src&#47;components&#47;Video&#47;Video.js","like_count":5,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459587,"discussion_content":"ç»™ä½ ä¸ªå¤§å¤§çš„èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563877913,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117056,"user_name":"æ‹ç€æ­Œ","can_delete":false,"product_type":"c1","uid":1001048,"ip_address":"","ucode":"CFDC00CB9965D9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/46/58/31205087.jpg","comment_is_top":false,"comment_ctime":1563960526,"is_pvip":false,"replies":[{"id":"42864","content":"ä¸é”™ï¼ ä¸é”™ï¼","user_name":"ä½œè€…å›å¤","comment_id":117056,"uid":"1507837","ip_address":"","utype":1,"ctime":1563981103,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"14448862414","product_id":100031801,"comment_content":"äº¤ä½œä¸š https:&#47;&#47;codepen.io&#47;htkar&#47;pen&#47;OKMbzV","like_count":3,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459795,"discussion_content":"ä¸é”™ï¼ ä¸é”™ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563981103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262540,"user_name":"è€çŒ´","can_delete":false,"product_type":"c1","uid":2269867,"ip_address":"","ucode":"79F0DB00386CFB","user_header":"https://static001.geekbang.org/account/avatar/00/22/a2/ab/02dc1f9c.jpg","comment_is_top":false,"comment_ctime":1605761085,"is_pvip":false,"replies":[{"id":"95274","content":"è¿™ä¸ªæ²¡æœ‰æ˜ç¡®è¯´æ˜ï¼Œæ—¶é—´é•¿äº†ä¸€å®šä¼šæœ‰å½±å“ã€‚ä½†åœ¨å¯åŠ¨å½•åˆ¶æ—¶å¯ä»¥è®¾ç½®ä¸€ä¸ªå‚æ•°ã€‚åœ¨ä¾‹å­ä¸­æˆ‘è®¾ç½®çš„æ˜¯10msã€‚åˆ°è¾¾åå°±ä¼šè§¦å‘äº‹ä»¶ï¼Œç„¶åä½ å°±å¯ä»¥å°†å½•åˆ¶çš„æ•°æ®ä¿å­˜èµ·æ¥äº†ã€‚mediaRecorder.start(10)ä¸­å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼šâ€œå¼€å§‹å½•åˆ¶åª’ä½“,è¿™ä¸ªæ–¹æ³•è°ƒç”¨æ—¶å¯ä»¥é€šè¿‡ç»™timesliceå‚æ•°è®¾ç½®ä¸€ä¸ªæ¯«ç§’å€¼,å¦‚æœè®¾ç½®è¿™ä¸ªæ¯«ç§’å€¼,é‚£ä¹ˆå½•åˆ¶çš„åª’ä½“ä¼šæŒ‰ç…§ä½ è®¾ç½®çš„å€¼è¿›è¡Œåˆ†å‰²æˆä¸€ä¸ªä¸ªå•ç‹¬çš„åŒºå—, è€Œä¸æ˜¯ä»¥é»˜è®¤çš„æ–¹å¼å½•åˆ¶ä¸€ä¸ªéå¸¸å¤§çš„æ•´å—å†…å®¹.â€","user_name":"ä½œè€…å›å¤","comment_id":262540,"uid":"1507837","ip_address":"","utype":1,"ctime":1605767865,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"10195695677","product_id":100031801,"comment_content":"å½•ä¸‹æ¥çš„æ•°æ®æ¨åˆ°äº†bufferä¸­ï¼Œè¿™ä¸ªbufferæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿæœ€å¤§èƒ½å½•å¤šå¤§æ•°æ®é‡çš„æ•°æ®ï¼Ÿæ—¶é—´é•¿äº†ï¼Œä¼šä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œæˆ–è€…è®©æµè§ˆå™¨ç”šè‡³æœºå™¨å˜æ…¢çš„é—®é¢˜ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509875,"discussion_content":"è¿™ä¸ªæ²¡æœ‰æ˜ç¡®è¯´æ˜ï¼Œæ—¶é—´é•¿äº†ä¸€å®šä¼šæœ‰å½±å“ã€‚ä½†åœ¨å¯åŠ¨å½•åˆ¶æ—¶å¯ä»¥è®¾ç½®ä¸€ä¸ªå‚æ•°ã€‚åœ¨ä¾‹å­ä¸­æˆ‘è®¾ç½®çš„æ˜¯10msã€‚åˆ°è¾¾åå°±ä¼šè§¦å‘äº‹ä»¶ï¼Œç„¶åä½ å°±å¯ä»¥å°†å½•åˆ¶çš„æ•°æ®ä¿å­˜èµ·æ¥äº†ã€‚mediaRecorder.start(10)ä¸­å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼šâ€œå¼€å§‹å½•åˆ¶åª’ä½“,è¿™ä¸ªæ–¹æ³•è°ƒç”¨æ—¶å¯ä»¥é€šè¿‡ç»™timesliceå‚æ•°è®¾ç½®ä¸€ä¸ªæ¯«ç§’å€¼,å¦‚æœè®¾ç½®è¿™ä¸ªæ¯«ç§’å€¼,é‚£ä¹ˆå½•åˆ¶çš„åª’ä½“ä¼šæŒ‰ç…§ä½ è®¾ç½®çš„å€¼è¿›è¡Œåˆ†å‰²æˆä¸€ä¸ªä¸ªå•ç‹¬çš„åŒºå—, è€Œä¸æ˜¯ä»¥é»˜è®¤çš„æ–¹å¼å½•åˆ¶ä¸€ä¸ªéå¸¸å¤§çš„æ•´å—å†…å®¹.â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605767865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340214,"user_name":"Leeing","can_delete":false,"product_type":"c1","uid":1374118,"ip_address":"","ucode":"5264B8340DE54F","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/a6/79a835ac.jpg","comment_is_top":false,"comment_ctime":1648661883,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5943629179","product_id":100031801,"comment_content":"æ€è€ƒé¢˜æƒ³äº†ä¸‰ç§æ–¹æ¡ˆï¼Œä¸çŸ¥é“å¯¹ä¸å¯¹<br>ä¸€ã€é€šè¿‡å¤šä¸ªmediarecorderå®ä¾‹å°†å¤šäººçš„éŸ³è§†é¢‘æµå½•åˆ¶æˆå¤šä»½éŸ³è§†é¢‘æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ffmpegåˆå¹¶ï¼Œä½†æ˜¯å¦‚ä½•ä¿è¯å¤šä»½éŸ³è§†é¢‘æ–‡ä»¶æ­£ç¡®æ’­æ”¾çš„æ—¶é—´æˆ³å‘¢ï¼Ÿ<br>äºŒã€é€šè¿‡è®°å½•å¤šäººçš„éŸ³è§†é¢‘äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶åè¿›è¡Œåˆæµã€è½¬ç ï¼Œä½†æ˜¯é—®é¢˜å°±æ›´å¤šäº†ï¼Œè§†é¢‘æ€ä¹ˆåˆæµã€éŸ³é¢‘æ€ä¹ˆåˆæµã€ä¸¢åŒ…æ€ä¹ˆå¤„ç†ã€é¡ºåºæ€ä¹ˆä¿éšœï¼ˆè®¾ç½®ç¼“å†²åŒºè¿›è¡Œé‡æ’ï¼Ÿï¼‰<br>ä¸‰ã€å°†å¤šä¸ªéŸ³è§†é¢‘æµæ¸²æŸ“åˆ°å„è‡ªçš„canvasä¸Šï¼Œå†å°†canvasåˆå¹¶ï¼Œæœ€åå°†åˆå¹¶åçš„canvasä¸‹è½½ä¸‹æ¥","like_count":1},{"had_liked":false,"id":289663,"user_name":"å°æ¨±æ¡ƒ","can_delete":false,"product_type":"c1","uid":1233618,"ip_address":"","ucode":"55D8B9F89567F5","user_header":"https://static001.geekbang.org/account/avatar/00/12/d2/d2/efd8cb3a.jpg","comment_is_top":false,"comment_ctime":1619137681,"is_pvip":false,"replies":[{"id":"105421","content":"æ¯ä¸ªrecoder åªèƒ½å½•åˆ¶ä¸€è·¯è§†é¢‘ï¼Œä½ éœ€è¦ç”¨ä¸¤ä¸ªrecoder åˆ†åˆ«å½•åˆ¶ï¼Œä¹‹åç”¨ffmpeg åˆæˆ","user_name":"ä½œè€…å›å¤","comment_id":289663,"uid":"1507837","ip_address":"","utype":1,"ctime":1619870757,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"5914104977","product_id":100031801,"comment_content":"åœ¨æµè§ˆå™¨é‡Œä½¿ç”¨äº†å½•åˆ¶ï¼Œå½•åˆ¶æœ¬åœ°è§†é¢‘æ˜¯æ­£å¸¸çš„ï¼Œå¯æ˜¯å½•åˆ¶è¿œç¨‹è§†é¢‘å´åªå½•åˆ¶äº†å£°éŸ³ï¼Œè§†é¢‘åªæœ‰ä¸€å¸§é™æ€å›¾ä¸çŸ¥é“ä¸ºä»€ä¹ˆğŸ˜£å¸Œæœ›è€å¸ˆçœ‹åˆ°èƒ½è§£ç­”ä¸€ä¸‹","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518986,"discussion_content":"æ¯ä¸ªrecoder åªèƒ½å½•åˆ¶ä¸€è·¯è§†é¢‘ï¼Œä½ éœ€è¦ç”¨ä¸¤ä¸ªrecoder åˆ†åˆ«å½•åˆ¶ï¼Œä¹‹åç”¨ffmpeg åˆæˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619870757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119557,"user_name":"hao11111205","can_delete":false,"product_type":"c1","uid":1617232,"ip_address":"","ucode":"E97F515CE3D7E3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/sIfDHQxDV6iaanrd8PcdVWZnke6nJmqBOLMx0iazR1yNN3FI6ib7PtXCfzicWcuEwSIqzfqiaFMf7PMYNPiaRibiaFHgcw/132","comment_is_top":false,"comment_ctime":1564625609,"is_pvip":false,"replies":[{"id":"43886","content":"å¦‚æœä½ ä¹‹å‰åœ¨æµè§ˆå™¨ä¸­æœ‰è®¾ç½®ä¿å­˜æ–‡ä»¶çš„é»˜è®¤è·¯å¾„å°±ä¼šè¿™æ ·å­","user_name":"ä½œè€…å›å¤","comment_id":119557,"uid":"1507837","ip_address":"","utype":1,"ctime":1564639723,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5859592905","product_id":100031801,"comment_content":"è€å¸ˆï¼Œåœ¨è°·æ­Œæµè§ˆå™¨ç‚¹å‡»ä¸‹è½½ï¼Œä¸å‡ºç°ä¿å­˜çª—å£ï¼Œç›´æ¥ä¸‹è½½ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460954,"discussion_content":"å¦‚æœä½ ä¹‹å‰åœ¨æµè§ˆå™¨ä¸­æœ‰è®¾ç½®ä¿å­˜æ–‡ä»¶çš„é»˜è®¤è·¯å¾„å°±ä¼šè¿™æ ·å­","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564639723,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116518,"user_name":"æè·ƒçˆ±å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1347792,"ip_address":"","ucode":"F25C038C86324A","user_header":"https://static001.geekbang.org/account/avatar/00/14/90/d0/48037ba6.jpg","comment_is_top":false,"comment_ctime":1563862628,"is_pvip":false,"replies":[{"id":"42622","content":"æˆ‘çœ‹ä¸€ä¸‹ handleDataAvailable è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘æ˜¯ç›´æ¥å°†å®ƒä¿å­˜åˆ°å†…å­˜ä¸­äº†ã€‚å¦‚æœä½ æƒ³ä¿å­˜æˆæ–‡ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹ä»£ç ï¼<br>","user_name":"ä½œè€…å›å¤","comment_id":116518,"uid":"1507837","ip_address":"","utype":1,"ctime":1563877621,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5858829924","product_id":100031801,"comment_content":"ä»äº§å“çš„è§’åº¦æ¥è®²ï¼Œ åº”è¯¥æ˜¯è®¾ç½®ä¿å­˜è·¯å¾„ï¼Œå¼€å§‹å½•åˆ¶ï¼Œç»“æŸå½•åˆ¶è¿™ä¹ˆæ“ä½œã€‚<br>ä½†æ˜¯çœ‹è€å¸ˆä»‹ç»çš„æ˜¯è¦ç‚¹å‡»ä¿å­˜ï¼Œå°±å°†å½“å‰blobçš„å†…å®¹ä¿å­˜ä¸‹æ¥ï¼Œ çœŸå®åœºæ™¯ä¸­ï¼Œè¦å½•åˆ¶å¾ˆé•¿æ—¶é—´ï¼Œå†…å­˜è‚¯å®šæ˜¯æ”¾ä¸ä¸‹å§ï¼Œæ‰€ä»¥æœ‰ç‚¹å›°æƒ‘ï¼Œå½•åˆ¶å¼€å§‹åæ˜¯å†™åˆ°ç£ç›˜äº†ï¼Œè¿˜æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459572,"discussion_content":"æˆ‘çœ‹ä¸€ä¸‹ handleDataAvailable è¿™ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­æˆ‘æ˜¯ç›´æ¥å°†å®ƒä¿å­˜åˆ°å†…å­˜ä¸­äº†ã€‚å¦‚æœä½ æƒ³ä¿å­˜æˆæ–‡ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹ä»£ç ï¼\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563877621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116434,"user_name":"å‰‘è¡£æ¸…é£","can_delete":false,"product_type":"c1","uid":1009527,"ip_address":"","ucode":"470CD81F6612F4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/77/c1310aad.jpg","comment_is_top":false,"comment_ctime":1563849674,"is_pvip":false,"replies":[{"id":"42865","content":"å¯ä»¥è¿è¡Œï¼Œä½ å†è¯•ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":116434,"uid":"1507837","ip_address":"","utype":1,"ctime":1563981147,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5858816970","product_id":100031801,"comment_content":"github é‡Œçš„ä»£ç å¯ä»¥è¿è¡Œä¹ˆï¼Ÿ<br><br>å…³äºè¿™è®²ï¼Œæ¨èçœ‹çœ‹è¿™ä¸ª  https:&#47;&#47;cloud.tencent.com&#47;developer&#47;article&#47;1366886 é‡Œçš„MediaRecorderä½¿ç”¨ç¤ºä¾‹ - æ‘„åƒå¤´ç‰ˆï¼Œæˆ–è€…ç›´æ¥æ‰“å¼€ https:&#47;&#47;wendychengc.github.io&#47;media-recorder-video-canvas&#47;cameracanvas.htmlï¼Œçœ‹çœ‹æºæ–‡ä»¶çš„ç›¸å…³ä»£ç å³å¯ã€‚","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459538,"discussion_content":"å¯ä»¥è¿è¡Œï¼Œä½ å†è¯•ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563981147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116363,"user_name":"lvxus","can_delete":false,"product_type":"c1","uid":1210917,"ip_address":"","ucode":"25891F9E96C670","user_header":"https://static001.geekbang.org/account/avatar/00/12/7a/25/be98886a.jpg","comment_is_top":false,"comment_ctime":1563844189,"is_pvip":false,"replies":[{"id":"42613","content":"åé¢çš„è¯¾ç¨‹æœ‰è®²ï¼Œåˆ«ç€æ€¥ï¼","user_name":"ä½œè€…å›å¤","comment_id":116363,"uid":"1507837","ip_address":"","utype":1,"ctime":1563865333,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"5858811485","product_id":100031801,"comment_content":"è€å¸ˆï¼Œæƒ³è¯·é—®ä¸€ä¸‹å½•åˆ¶æ¡Œé¢å…·ä½“æ˜¯ä»€ä¹ˆæ“ä½œ","like_count":1,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459506,"discussion_content":"åé¢çš„è¯¾ç¨‹æœ‰è®²ï¼Œåˆ«ç€æ€¥ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563865333,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360618,"user_name":"å¼ ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1517793,"ip_address":"å¹¿ä¸œ","ucode":"FC93F18DA8E54B","user_header":"https://static001.geekbang.org/account/avatar/00/17/28/e1/e53f6664.jpg","comment_is_top":false,"comment_ctime":1666690605,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1666690605","product_id":100031801,"comment_content":"æµè§ˆå™¨è°ƒç”¨çš„æ‘„åƒå¤´ä¸­çš„streamæ•°æ®æ˜¯åŸå§‹è§†é¢‘æ•°æ®å¯¹å§ï¼Ÿä¹Ÿå°±æ˜¯yuvè¿™ç§æ•°æ®ï¼Œå¦‚æœè¦å‘é€åˆ°åç«¯è¿›è¡Œå¤„ç†çš„è¯ï¼Œä¸ºä»€ä¹ˆmediaStreamæ²¡æœ‰æä¾›ç›‘å¬æµçš„äº‹ä»¶ï¼Œç”¨äºä¸ŠæŠ¥ï¼Œè¿˜éœ€è¦ä½¿ç”¨recorderæ¥è¿›è¡Œç›‘å¬å‘¢ï¼Ÿrecorderç›‘å¬æœ‰ä¸ªå¥½å¤„æ˜¯å¯ä»¥å°†åŸå§‹çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œæˆ‘è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":348538,"user_name":"å¼¥å‹’","can_delete":false,"product_type":"c1","uid":1231083,"ip_address":"","ucode":"B6ED15785975F7","user_header":"https://static001.geekbang.org/account/avatar/00/12/c8/eb/4e479446.jpg","comment_is_top":false,"comment_ctime":1655180817,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655180817","product_id":100031801,"comment_content":"é‚£ ArryaBuffer ä¸ ArrayBufferView åˆæœ‰ä»€ä¹ˆè”ç³»å‘¢ï¼Ÿ<br><br>ArrayBuffer å•è¯æ‹¼å†™é”™è¯¯","like_count":0},{"had_liked":false,"id":340216,"user_name":"Leeing","can_delete":false,"product_type":"c1","uid":1374118,"ip_address":"","ucode":"5264B8340DE54F","user_header":"https://static001.geekbang.org/account/avatar/00/14/f7/a6/79a835ac.jpg","comment_is_top":false,"comment_ctime":1648662781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648662781","product_id":100031801,"comment_content":"åˆæƒ³åˆ°ä¸€ä¸ªæ–¹æ¡ˆï¼Œé€šè¿‡getdisplaymediaçš„å±å¹•å…±äº«æµå½•åˆ¶æ•´ä¸ªé¡µé¢","like_count":0},{"had_liked":false,"id":339932,"user_name":"å†¤å¤§å¤´","can_delete":false,"product_type":"c1","uid":2440525,"ip_address":"","ucode":"692BD60A03D593","user_header":"","comment_is_top":false,"comment_ctime":1648468116,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1648468116","product_id":100031801,"comment_content":"var blob = new Blob(buffer, {type: &#39;video&#47;webm&#39;}); recvideo.src = window.URL.createObjectURL(blob); recvideo.srcObject = null;<br><br><br> recvideo.srcObject è¿™ä¸ªå±æ€§æ˜¯ä»€ä¹ˆæ„æ€","like_count":0},{"had_liked":false,"id":316271,"user_name":"ä¹å¤´è›‡","can_delete":false,"product_type":"c1","uid":1943646,"ip_address":"","ucode":"45D5487480A5D2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKYv1ESpImQz3wjJT4pCVmtG2nr9dsuNdmAcRaYUUXSOicLDeYVSkaENqibYSyib2dVnQCkAopQ6on6Q/132","comment_is_top":false,"comment_ctime":1634253934,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1634253934","product_id":100031801,"comment_content":"è€å¸ˆ æˆ‘æƒ³ç»™æˆ‘ä»¬å…¬å¸çš„NVRåšä¸€ä¸ªæ— æ’ä»¶ç½‘é¡µå®¢æˆ·ç«¯ å¯ä»¥åŒæ—¶é¢„è§ˆ16è·¯è§†é¢‘ å’±ä»¬è¿™ä¸ªä¸“æ è®²çš„æŠ€æœ¯ å¯ä»¥å®ç°å—","like_count":0},{"had_liked":false,"id":315189,"user_name":"î„£ä»°æ³³é±¼","can_delete":false,"product_type":"c1","uid":1055710,"ip_address":"","ucode":"341BE9160569CB","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/de/e63da460.jpg","comment_is_top":false,"comment_ctime":1633746277,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633746277","product_id":100031801,"comment_content":"è€å¸ˆä½ å¥½ã€‚è¯·é—®è¿™çš„å®¢æˆ·ç«¯å½•åˆ¶ï¼ˆé™¤äº†å½•åˆ¶æ¡Œé¢ï¼‰ï¼Œåœ¨1V1çš„æƒ…å†µä¸‹ï¼ˆä¹Ÿå°±æ˜¯webrtcæœ‰2è·¯è§†é¢‘äº†å¯¹å§ï¼‰ï¼Œé‚£æ˜¯å½•çš„è‡ªå·±  è¿˜æ˜¯å½•çš„å¯¹æ–¹ï¼Œ å¦‚æœæ”¯æŒå½•2å½•æ˜¯å¦ è¦ recoder1  recoder2 éƒ½æ¥ä¸€ä¸‹ã€‚<br>","like_count":0},{"had_liked":false,"id":310898,"user_name":"äº‘ä»”ç³•","can_delete":false,"product_type":"c1","uid":1807330,"ip_address":"","ucode":"858DD733F1D31E","user_header":"https://static001.geekbang.org/account/avatar/00/1b/93/e2/2044bafe.jpg","comment_is_top":false,"comment_ctime":1630976949,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1630976949","product_id":100031801,"comment_content":"è€å¸ˆï¼Œé‚£å¯ä¸å¯ä»¥å…ˆç”±å®¢æˆ·ç«¯å½•åˆ¶ï¼Œå®¢æˆ·ç«¯éƒ½å½•åˆ¶å¥½äº†ï¼Œå†ä¸Šä¼ åˆ°æœåŠ¡å™¨å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":303971,"user_name":"é™ˆä¿Šæ–°","can_delete":false,"product_type":"c1","uid":2063055,"ip_address":"","ucode":"DC50874EBE6484","user_header":"https://static001.geekbang.org/account/avatar/00/1f/7a/cf/fdb3504d.jpg","comment_is_top":false,"comment_ctime":1627132086,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627132086","product_id":100031801,"comment_content":"MP4ä¸€èˆ¬åªåŒ…æ‹¬ä¸€æ¡è§†é¢‘è½¨å’Œä¸€æ¡éŸ³é¢‘è½¨ï¼Œä¸å¯ä»¥å°†å¤šè·¯éŸ³è§†é¢‘å½•åˆ¶åˆ°åŒä¸€ä¸ªMP4æ–‡ä»¶ä¸­å§","like_count":0},{"had_liked":false,"id":288306,"user_name":"caidy","can_delete":false,"product_type":"c1","uid":1188783,"ip_address":"","ucode":"AEFB529C32C7EE","user_header":"https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg","comment_is_top":false,"comment_ctime":1618401832,"is_pvip":false,"replies":[{"id":"105428","content":"ç›´æ’­çš„æ—¶å€™ä¸ä¼šæŠŠå¤šè·¯è§†é¢‘ä¿å­˜æˆmp4 æ–‡ä»¶çš„","user_name":"ä½œè€…å›å¤","comment_id":288306,"uid":"1507837","ip_address":"","utype":1,"ctime":1619871367,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1618401832","product_id":100031801,"comment_content":"å‡å¦‚å¤šäººå®æ—¶ç›´æ’­ï¼Œå¯ä»¥æŠŠå¤šè·¯è§†é¢‘ä¿å­˜åˆ°ä¸€ä¸ªMP4æ–‡ä»¶ç”¨ï¼Œé‚£è¿™ä¸ªè§†é¢‘è¦æ€ä¹ˆåˆå¹¶å‘¢ï¼Ÿå‡å¦‚æ¯ä¸€è·¯éƒ½æ˜¯10åˆ†é’Ÿï¼Œè¦æ€ä¹ˆè®©åˆå¹¶çš„è§†é¢‘ä¹Ÿæ˜¯10åˆ†é’Ÿå‘¢ï¼ŸéŸ³é¢‘å¯ä»¥æ··éŸ³ï¼Œé‚£ä¹ˆè§†é¢‘å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518584,"discussion_content":"ç›´æ’­çš„æ—¶å€™ä¸ä¼šæŠŠå¤šè·¯è§†é¢‘ä¿å­˜æˆmp4 æ–‡ä»¶çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619871367,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268263,"user_name":"ç»¿æ¯›é¾ŸğŸ¢","can_delete":false,"product_type":"c1","uid":1622568,"ip_address":"","ucode":"B37A7F5C2D1674","user_header":"https://static001.geekbang.org/account/avatar/00/18/c2/28/2f3c2ed9.jpg","comment_is_top":false,"comment_ctime":1608116963,"is_pvip":false,"replies":[{"id":"103810","content":"è¿™ä¸ªè¦ä¸ä½ ç›´æ’­æ—¶çš„çœŸå®åœºæ™¯ä¸ºä¾æ®ï¼Œç›´æ’­æ—¶å¦‚æœæœ‰åŠ é€Ÿï¼Œé‚£å½•åˆ¶å‡ºæ¥çš„å°±åº”è¯¥ä¹Ÿæœ‰åŠ é€Ÿ","user_name":"ä½œè€…å›å¤","comment_id":268263,"uid":"1507837","ip_address":"","utype":1,"ctime":1617074218,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1608116963","product_id":100031801,"comment_content":"è€å¸ˆ æœ‰ä¸ªé—®é¢˜ æˆ‘åœ¨ä¸šåŠ¡ä¸­ä¹Ÿæœ‰ç”¨åˆ°è¿™ä¸ª MediaRecorder æ¥åšæœ¬åœ°å½•åˆ¶ ä½†æ˜¯å‡ºç°çš„é—®é¢˜æ˜¯<br>1ã€è§†é¢‘å˜é€Ÿé—®é¢˜ï¼Œåœ¨ä¸€äº›æ—¶é—´å†…å‡ºç°è§†é¢‘åŠ é€Ÿçš„æƒ…å†µ<br>2ã€èŠ±å±é—®é¢˜ï¼Œå¶ç°å½•åˆ¶çš„å†…å®¹å‡ºç°å·¨å¹…é©¬èµ›å…‹çš„æƒ…å†µ<br>è¿™ä¸¤ä¸ªé—®é¢˜ä¸€ç›´å®šä½ä¸åˆ°ï¼Œå°è¯•ä½¿ç”¨ ffmpeg æ¥å½•åˆ¶ä½†ä»€ä¹ˆä¹Ÿä¼šå‡ºç°è§†é¢‘åŠ é€Ÿçš„æƒ…å†µï¼Œè€å¸ˆèƒ½è§£ç­”ä¸€ä¸‹ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511891,"discussion_content":"è¿™ä¸ªè¦ä¸ä½ ç›´æ’­æ—¶çš„çœŸå®åœºæ™¯ä¸ºä¾æ®ï¼Œç›´æ’­æ—¶å¦‚æœæœ‰åŠ é€Ÿï¼Œé‚£å½•åˆ¶å‡ºæ¥çš„å°±åº”è¯¥ä¹Ÿæœ‰åŠ é€Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617074218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232535,"user_name":"ä¸­çº§éº¦","can_delete":false,"product_type":"c1","uid":1785333,"ip_address":"","ucode":"5FD2A5E88D1281","user_header":"https://static001.geekbang.org/account/avatar/00/1b/3d/f5/cb7497ac.jpg","comment_is_top":false,"comment_ctime":1594030343,"is_pvip":false,"replies":[{"id":"87921","content":"ä»¥åçš„è¶‹åŠ¿æ˜¯åœ¨ç»ˆç«¯æ‰“å¼€å°±æ˜¯æµè§ˆå™¨ï¼Œåœ¨æµè§ˆå™¨ä¸‹å¯ä»¥åšå„ç§äº‹æƒ…","user_name":"ä½œè€…å›å¤","comment_id":232535,"uid":"1507837","ip_address":"","utype":1,"ctime":1596023811,"user_name_real":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…"}],"discussion_count":1,"race_medal":0,"score":"1594030343","product_id":100031801,"comment_content":"æœ‰æ„æ€ï¼Œæ²¡æƒ³åˆ°æµè§ˆå™¨æœ‰è¿™ä¹ˆå¤šæœ‰è¶£çš„APIå¯ä»¥ç”¨ã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500682,"discussion_content":"ä»¥åçš„è¶‹åŠ¿æ˜¯åœ¨ç»ˆç«¯æ‰“å¼€å°±æ˜¯æµè§ˆå™¨ï¼Œåœ¨æµè§ˆå™¨ä¸‹å¯ä»¥åšå„ç§äº‹æƒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596023811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204417,"user_name":"æ¶‚æ»”","can_delete":false,"product_type":"c1","uid":1934631,"ip_address":"","ucode":"07264F622D5570","user_header":"","comment_is_top":false,"comment_ctime":1586397862,"is_pvip":false,"replies":[{"id":"76550","content":"ç›®å‰æ²¡æœ‰ï¼Œç­‰å„æµè§ˆå™¨å¯¹webrtc æ”¯æŒå…¨äº†å°±å¥½äº†","user_name":"ä½œè€…å›å¤","comment_id":204417,"uid":"1507837","ip_address":"","utype":1,"ctime":1586485424,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1586397862","product_id":100031801,"comment_content":"MediaRecorderè¿™ä¸ªapiå¥½åƒå…¼å®¹ä¸æ˜¯å¾ˆå¥½æ · ï¼Œæœ‰æ²¡æœ‰å…¶ä»–çš„å½•éŸ³çš„æ–¹æ³•å•Šè€å¸ˆ","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491174,"discussion_content":"ç›®å‰æ²¡æœ‰ï¼Œç­‰å„æµè§ˆå™¨å¯¹webrtc æ”¯æŒå…¨äº†å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586485424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120073,"user_name":"ZeroIce","can_delete":false,"product_type":"c1","uid":1305369,"ip_address":"","ucode":"30133BA83CE349","user_header":"https://static001.geekbang.org/account/avatar/00/13/eb/19/0d990b03.jpg","comment_is_top":false,"comment_ctime":1564774547,"is_pvip":false,"replies":[{"id":"44200","content":"èµï¼","user_name":"ä½œè€…å›å¤","comment_id":120073,"uid":"1507837","ip_address":"","utype":1,"ctime":1564919902,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1564774547","product_id":100031801,"comment_content":"ä½œä¸šï¼š https:&#47;&#47;codepen.io&#47;vicksiyi&#47;pen&#47;pMWybg","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461194,"discussion_content":"èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564919902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":117065,"user_name":"K","can_delete":false,"product_type":"c1","uid":1179273,"ip_address":"","ucode":"74A783491F6E95","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/89/ef7b5fe3.jpg","comment_is_top":false,"comment_ctime":1563961420,"is_pvip":true,"replies":[{"id":"42863","content":"æ˜å¤©ä¾‹å­å°±æ›´æ–°äº†ï¼Œä½ å¯¹ç…§ç€ä¾‹å­çœ‹ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","comment_id":117065,"uid":"1507837","ip_address":"","utype":1,"ctime":1563980985,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1563961420","product_id":100031801,"comment_content":"è§†å±å¯ä»¥ä¸‹è½½æ’­æ”¾ï¼Œä½†æ˜¯æ— æ³•å›æ”¾ã€‚ <br>rePlayVideo.src = window.URL.createObjectURL(blob); æç¤ºä¸èƒ½èµ‹å€¼srcä¸ºnull  t.js:75 Uncaught TypeError: Cannot set property &#39;src&#39; of null<br>æ§åˆ¶å°è¾“å‡ºwindow.URL.createObjectURL(blob);  æ˜¯blob:http:&#47;&#47;localhost:63342&#47;15434d88-60de-44fc-bd2e-b1ecd453cc5a<br><br>ä½†æ˜¯åŒæ ·çš„ä»£ç   æˆ‘æŠŠç”Ÿæˆçš„urlèµ‹å€¼ç»™aæ ‡ç­¾ ç„¶åæ˜¯å¯ä»¥ä¸‹è½½çš„  è€Œä¸”è§†å±æ˜¯æœ‰å†…å®¹çš„å•Š <br><br><br>è¿™æ˜¯ä»€ä¹ˆæƒ…å†µå•Š","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459799,"discussion_content":"æ˜å¤©ä¾‹å­å°±æ›´æ–°äº†ï¼Œä½ å¯¹ç…§ç€ä¾‹å­çœ‹ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563980985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116753,"user_name":"K","can_delete":false,"product_type":"c1","uid":1179273,"ip_address":"","ucode":"74A783491F6E95","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/89/ef7b5fe3.jpg","comment_is_top":false,"comment_ctime":1563904939,"is_pvip":true,"replies":[{"id":"42682","content":"æ˜å¤©demoä¼šè¢«æ”¾åˆ° git ä¸Šï¼Œåˆ°æ—¶å€™ä½ å¯¹ç…§ä¸€ä¸‹ demoçœ‹æ˜¯ä¸æ˜¯å“ªé‡Œå†™é”™äº†<br>","user_name":"ä½œè€…å›å¤","comment_id":116753,"uid":"1507837","ip_address":"","utype":1,"ctime":1563930529,"user_name_real":"garrylee"}],"discussion_count":2,"race_medal":0,"score":"1563904939","product_id":100031801,"comment_content":"ä¸ºå•¥æˆ‘å›æ”¾çš„æ—¶å€™æç¤ºæˆ‘recvideo æ˜¯null  blobçš„sizeæ˜¯0","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459673,"discussion_content":"æ˜å¤©demoä¼šè¢«æ”¾åˆ° git ä¸Šï¼Œåˆ°æ—¶å€™ä½ å¯¹ç…§ä¸€ä¸‹ demoçœ‹æ˜¯ä¸æ˜¯å“ªé‡Œå†™é”™äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563930529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3223,"discussion_content":"æˆ‘çš„ä¹Ÿæ˜¯ï¼Œè§£å†³äº†æ²¡ï¼Ÿ ä¹Ÿå¯¹ç…§äº†å¸ˆçš„ä»£ç ï¼Œæ²¡å‘ç°é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564318001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116641,"user_name":"CHY","can_delete":false,"product_type":"c1","uid":1234426,"ip_address":"","ucode":"C307A86133B19D","user_header":"https://static001.geekbang.org/account/avatar/00/12/d5/fa/b1cb4626.jpg","comment_is_top":false,"comment_ctime":1563884233,"is_pvip":false,"replies":[{"id":"42633","content":"ä¸€èˆ¬éƒ½ä¸ä½¿ç”¨ç§»åŠ¨ç«¯è¿›è¡Œå½•åˆ¶ã€‚å¦‚æœçœŸçš„è¦å½•åˆ¶çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ Native çš„æ–¹æ³•ã€‚","user_name":"ä½œè€…å›å¤","comment_id":116641,"uid":"1507837","ip_address":"","utype":1,"ctime":1563888093,"user_name_real":"garrylee"}],"discussion_count":1,"race_medal":0,"score":"1563884233","product_id":100031801,"comment_content":"åœ¨å®‰å“ç«¯ä¹Ÿæœ‰è¿™ç§ç°æˆçš„å½•åˆ¶è§†é¢‘çš„ç±»å—ï¼Ÿå¦‚æœæ²¡æœ‰çš„è¯æ˜¯ä¸æ˜¯éœ€è¦è‡ªå·±æ¥åˆæµå¹¶æ§åˆ¶æ—¶é—´æˆ³å‘¢ã€‚","like_count":0,"discussions":[{"author":{"id":1507837,"avatar":"https://static001.geekbang.org/account/avatar/00/17/01/fd/69869646.jpg","nickname":"éŸ³è§†é¢‘ä¸“å®¶-æè¶…","note":"","ucode":"5557943CF28441","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459624,"discussion_content":"ä¸€èˆ¬éƒ½ä¸ä½¿ç”¨ç§»åŠ¨ç«¯è¿›è¡Œå½•åˆ¶ã€‚å¦‚æœçœŸçš„è¦å½•åˆ¶çš„è¯ï¼Œéœ€è¦ä½¿ç”¨ Native çš„æ–¹æ³•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563888093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}