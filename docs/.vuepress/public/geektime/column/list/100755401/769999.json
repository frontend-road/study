{"id":769999,"title":"22ï½œé€šè¿‡æµ‹è¯•å·¥åºæé«˜LLMä»£ç è´¨é‡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å¾æ˜Šï¼Œä»Šå¤©æˆ‘ä»¬æ¥ç»§ç»­å­¦ä¹ AIæ—¶ä»£çš„è½¯ä»¶å·¥ç¨‹ã€‚</p><p>ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬è®²è§£äº†å¦‚ä½•å°†æ¶æ„æ¨¡å¼è½¬åŒ–ä¸ºæµ‹è¯•å·¥åºï¼Œä»¥åŠå·¥åºåœ¨æ¶æ„è½åœ°è¿‡ç¨‹ä¸­å‘æŒ¥çš„ä½œç”¨ã€‚æµ‹è¯•å·¥åºæœ‰åŠ©äºå°†æŠ½è±¡çš„æ¶æ„è®¾è®¡è½¬åŒ–ä¸ºå…·ä½“çš„å¼€å‘ä»»åŠ¡å’Œå®é™…çš„å·¥ä½œæµç¨‹ï¼Œå¸®åŠ©å›¢é˜Ÿæœ‰æ•ˆåœ°å®ç°æ¶æ„è®¾è®¡ï¼Œå¹¶æœ€ç»ˆäº§ç”Ÿè´¨é‡é«˜ã€å¯é æ€§å¼ºçš„è½¯ä»¶ç³»ç»Ÿã€‚</p><p>åŒæ ·ï¼Œé€šè¿‡æµ‹è¯•å·¥åºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®©LLMå¸®åŠ©æˆ‘ä»¬æœ‰æ•ˆåœ°å®ç°æ¶æ„è®¾è®¡ï¼Œå¹¶æé«˜LLMç”Ÿæˆä»£ç çš„è´¨é‡ã€‚è¿™èŠ‚è¯¾æˆ‘ä»¬å°±è®¨è®ºä¸€ä¸‹å¦‚ä½•å®ç°è¿™ä¸ªç›®æ ‡ã€‚</p><h2>å°†å·¥åºè½¬åŒ–ä¸ºæç¤ºè¯æ¨¡ç‰ˆ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†æµ‹è¯•å·¥åºè½¬åŒ–ä¸ºCoTï¼ˆChain of Thoughtï¼‰ï¼Œé€šè¿‡CoTæŒ‡å¯¼LLMæŒ‰ç…§æµ‹è¯•å·¥åºçš„è¦æ±‚ï¼Œå°†ç»™å®šçš„éœ€æ±‚åŠŸèƒ½æ‹†åˆ†æˆå¯¹åº”çš„ä»»åŠ¡åˆ—è¡¨ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æµ‹è¯•å·¥åºä»ç„¶æ˜¯å‰é¢æåˆ°çš„é‚£ä¸€ä¸ªï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/26/ee/26e48c8fc6ca29b39eb57366dbb42fee.jpg?wh=1833x932\" alt=\"\"></p><p>æˆ‘ä»¬å°†æ¶æ„ç»„ä»¶ä¸­çš„ä¸‰ç§ä¸åŒçš„ç»„ä»¶åˆ†åˆ«è¿›è¡Œæµ‹è¯•ï¼Œå…¶ä¸­Persistentå±‚ä¸­çš„ç»„ä»¶ï¼Œä½¿ç”¨å‡å¯¹è±¡ï¼ˆFakeï¼Œå†…å­˜æ•°æ®åº“ï¼‰ä½œä¸ºæµ‹è¯•æ›¿èº«ã€‚è€ŒHTTP interfaceå’ŒApplication Logicå±‚åˆ™é€šè¿‡å­˜æ ¹ï¼ˆStubï¼‰ä½œä¸ºæµ‹è¯•æ›¿èº«ã€‚æœ€åï¼Œå†é€šè¿‡åŠŸèƒ½æµ‹è¯•ï¼Œå¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡ŒéªŒè¯ã€‚</p><p>é‚£ä¹ˆè®©æˆ‘ä»¬æ¥æ„é€ CoTçš„æç¤ºè¯æ¨¡æ¿ï¼š</p><pre><code class=\"language-plain\">æ¶æ„æè¿°\n=======\nå½“å‰ç³»ç»ŸæŠ€æœ¯æ ˆä¸ºSpring Bootï¼ŒJerseyå’ŒMyBatisã€‚\n\nå½“å‰ç³»ç»Ÿé‡‡ç”¨å…¸å‹çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œåˆ†åˆ«ä¸º:\n- HTTP interfaceå±‚ï¼Œè´Ÿè´£æä¾›RESTful APIï¼Œå‘½åè§„åˆ™ä¸ºXXXAPIï¼Œæ¯”å¦‚OrdersAPIï¼›\n  - APIé€šè¿‡JAX-RSçš„Resourceå®ç°ï¼›\n  - HTTP interfaceå±‚è°ƒç”¨Application Logicå±‚çš„Serviceï¼Œå®ŒæˆåŠŸèƒ½ï¼›\n- Application Logicå±‚ï¼Œè´Ÿè´£æä¾›æ ¸å¿ƒé€»è¾‘ï¼Œå‘½åè§„åˆ™ä¸ºXXXServiceï¼Œæ¯”å¦‚OrderServiceï¼›\n  - ä½¿ç”¨Javaå®ç°ï¼ŒServiceä½¿ç”¨POJOä¸ºä¸»çš„é¢†åŸŸå¯¹è±¡ï¼›\n  - Application Logicå±‚è°ƒç”¨Persistentå±‚çš„DAOå®Œæˆå¯¹äºæ•°æ®çš„è®¿é—®ï¼›\n- Persistentå±‚ï¼Œè´Ÿè´£ä¸æŒä¹…åŒ–æ•°æ®äº¤äº’ï¼Œå‘½åè§„åˆ™ä¸ºXXXDAOï¼Œæ¯”å¦‚OrderDAOï¼›\n  - ä½¿ç”¨Javaå®ç°ï¼ŒDAOä½¿ç”¨DTOä¸ºä¸»çš„æ•°æ®å¯¹è±¡ï¼›\n  - DAOé€šè¿‡MyBatisçš„Mapperå®ç°\n \nå·¥åºè¯´æ˜\n=======\n  - å¦‚æœåŠŸèƒ½è¦æ±‚ä½¿ç”¨åˆ°HTTP interfaceå±‚ï¼Œé‚£ä¹ˆï¼š\n     - ä½¿ç”¨Application Logicå±‚ä¸­å¯¹åº”Serviceçš„Stubä½œä¸ºæµ‹è¯•æ›¿èº«ï¼›\n     - åˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°HTTP interfaceç»„ä»¶çš„åŠŸèƒ½ï¼ˆHTTP interfaceå±‚ç›®æ ‡åŠŸèƒ½ï¼‰ï¼›\n     - åˆ—å‡ºâ€œHTTP interfaceå±‚ç›®æ ‡åŠŸèƒ½â€éœ€è¦æµ‹è¯•çš„åœºæ™¯ï¼ˆHTTPå±‚ç›®æ ‡åœºæ™¯ï¼‰ï¼›\n\n  - å¦‚æœåŠŸèƒ½è¦æ±‚ä½¿ç”¨åˆ°Application Logicå±‚ï¼Œé‚£ä¹ˆï¼š\n     - ä½¿ç”¨Persistentå±‚ä¸­å¯¹åº”DAOçš„Stubä½œä¸ºæµ‹è¯•æ›¿èº«ï¼›\n     - åˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°Application Logicç»„ä»¶çš„åŠŸèƒ½ï¼ˆApplication Logicå±‚ç›®æ ‡åŠŸèƒ½ï¼‰ï¼›\n     - åˆ—å‡ºâ€œApplication Logicå±‚ç›®æ ‡åŠŸèƒ½â€è¦æµ‹è¯•çš„åœºæ™¯ï¼ˆApplication Logicå±‚ç›®æ ‡åœºæ™¯ï¼‰ï¼›\n\n  - å¦‚æœåŠŸèƒ½è¦æ±‚ä½¿ç”¨åˆ°Persistentå±‚ï¼Œé‚£ä¹ˆï¼š\n     - ä½¿ç”¨H2æ•°æ®åº“ä½œä¸ºfake implementationï¼›\n     - åˆ—å‡ºéœ€æ±‚æè¿°çš„åœºæ™¯ä½¿ç”¨åˆ°Persistentç»„ä»¶çš„åŠŸèƒ½ï¼ˆPersistentå±‚ç›®æ ‡åŠŸèƒ½ï¼‰ï¼›\n     - åˆ—å‡ºâ€œPersistentå±‚ç›®æ ‡åŠŸèƒ½â€è¦æµ‹è¯•çš„åœºæ™¯ï¼ˆPersistentå±‚ç›®æ ‡åœºæ™¯ï¼‰ï¼›\n\nåŠŸèƒ½éœ€æ±‚\n=======\n{functionalities}\n\nä»»åŠ¡\n====\né¦–å…ˆï¼Œåˆ—å‡ºæ¯ä¸€ä¸ªéªŒæ”¶åœºæ™¯ä»¥åŠå¯¹åº”çš„æµ‹è¯•æ•°æ®ï¼›\nç„¶åï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªéªŒæ”¶åœºæ™¯ï¼ŒæŒ‰ç…§æ¶æ„æè¿°å’Œå·¥åºè¯´æ˜çš„æŒ‡å¼•ï¼Œåˆ—å‡ºä»»åŠ¡åˆ—è¡¨ã€‚\n</code></pre><!-- [[[read_end]]] --><p>å½“æˆ‘ä»¬é’ˆå¯¹åˆ—å‡ºæ‰€æœ‰å•†å“çš„åŠŸèƒ½ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹çš„å›ç­”ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/a2/fc/a2c27e002fd44786ccdfc248a012fefc.jpg?wh=1070x2109\" alt=\"\"><br>\nå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶è¿™ä¸ªä»»åŠ¡åˆ—è¡¨ç¨æ˜¾ç²—ç•¥ï¼Œä½†æ˜¯å¯¹äºä»»åŠ¡çš„åˆ’åˆ†ï¼Œçš„ç¡®æ˜¯æŒ‰ç…§æˆ‘ä»¬ç»™å®šçš„å·¥åºè¿›è¡Œçš„ã€‚åœ¨è·å¾—ä»»åŠ¡åˆ—è¡¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å›´ç»•ä»»åŠ¡åˆ—è¡¨çš„æŒ‡å¼•ï¼Œè®©LLMå¸®åŠ©æˆ‘ä»¬å®Œæˆä»£ç çš„ç¼–å†™ï¼Œè¿™é‡Œæˆ‘åªå±•ç¤ºå¯¹äºæµ‹è¯•ä»£ç çš„ç¼–å†™ï¼š</p><pre><code class=\"language-plain\">è¯·æŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ï¼Œç¼–å†™http interfaceå±‚çš„æµ‹è¯•ä»£ç \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/2e/38/2e1699bc68fe93eed6a8ef8f8d3a4638.jpg?wh=1658x239\" alt=\"\"></p><pre><code class=\"language-plain\">import static org.junit.Assert.assertEquals;\nimport static org.mockito.Mockito.mock;\nimport static org.mockito.Mockito.when;\nimport javax.ws.rs.core.Response;\nimport org.junit.Before;\nimport org.junit.Test;\n\npublic class ProductsAPITest {\n  private ProductsAPI productsAPI;\n  \n  private OrderService orderServiceMock;\n  \n  @Before\n  public void setUp() {\n    // åˆ›å»º OrderService çš„ Mock å¯¹è±¡\n    orderServiceMock = mock(OrderService.class);\n    // åˆå§‹åŒ– ProductsAPI å¹¶æ³¨å…¥ Mock å¯¹è±¡\n    productsAPI = new ProductsAPI(orderServiceMock);\n  }\n\n  @Test\n  public void testGetProductCatalogList() {\n    // æ¨¡æ‹Ÿ OrderService è¿”å›çš„äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; mockProductCatalogList = new ArrayList&lt;&gt;();\n    // æ·»åŠ ä¸€äº›æµ‹è¯•æ•°æ®\n    mockProductCatalogList.add(new ProductCatalog(\"1\", \"Product 1\"));\n    mockProductCatalogList.add(new ProductCatalog(\"2\", \"Product 2\"));\n    // å½“è°ƒç”¨ orderServiceMock çš„æ–¹æ³•æ—¶ï¼Œè¿”å›æ¨¡æ‹Ÿçš„äº§å“ç›®å½•åˆ—è¡¨\n    when(orderServiceMock.getProductCatalogList()).thenReturn(mockProductCatalogList);\n    // å‘é€è·å–äº§å“ç›®å½•åˆ—è¡¨çš„è¯·æ±‚\n    Response response = productsAPI.getProductCatalogList();\n    // éªŒè¯å“åº”çŠ¶æ€ç æ˜¯å¦ä¸º 200 OK\n    assertEquals(Response.Status.OK.getStatusCode(), response.getStatus());\n    // éªŒè¯å“åº”å†…å®¹æ˜¯å¦ä¸æ¨¡æ‹Ÿæ•°æ®ä¸€è‡´\n    List&lt;ProductCatalog&gt; actualProductCatalogList = (List&lt;ProductCatalog&gt;) response.getEntity();\n    assertEquals(mockProductCatalogList.size(), actualProductCatalogList.size());\n    for (int i = 0; i &lt; mockProductCatalogList.size(); i++) {\n      assertEquals(mockProductCatalogList.get(i).getId(), actualProductCatalogList.get(i).getId());\n      assertEquals(mockProductCatalogList.get(i).getName(), actualProductCatalogList.get(i).getName());\n    }\n  }\n  \n  @Test\n  public void testGetEmptyProductCatalogList() {\n    // æ¨¡æ‹Ÿ OrderService è¿”å›ç©ºçš„äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; emptyProductCatalogList = new ArrayList&lt;&gt;();\n    // å½“è°ƒç”¨ orderServiceMock çš„æ–¹æ³•æ—¶ï¼Œè¿”å›ç©ºçš„äº§å“ç›®å½•åˆ—è¡¨\n    when(orderServiceMock.getProductCatalogList()).thenReturn(emptyProductCatalogList);\n    // å‘é€è·å–äº§å“ç›®å½•åˆ—è¡¨çš„è¯·æ±‚\n    Response response = productsAPI.getProductCatalogList();\n    // éªŒè¯å“åº”çŠ¶æ€ç æ˜¯å¦ä¸º 200 OK\n    assertEquals(Response.Status.OK.getStatusCode(), response.getStatus());\n    // éªŒè¯å“åº”å†…å®¹æ˜¯å¦ä¸ºç©ºåˆ—è¡¨\n    List&lt;ProductCatalog&gt; actualProductCatalogList = (List&lt;ProductCatalog&gt;) response.getEntity();\n    assertEquals(0, actualProductCatalogList.size());\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/df/d9/df259706632f7b8bccb32ff5399417d9.jpg?wh=1598x337\" alt=\"\"></p><pre><code class=\"language-plain\">è¯·æŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ï¼Œç¼–å†™application logicå±‚çš„æµ‹è¯•ä»£ç \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/2a/6a/2a60080f07f7319df2d0d61de5e3516a.jpg?wh=1696x229\" alt=\"\"></p><pre><code class=\"language-plain\">import static org.junit.Assert.assertEquals;\nimport static org.mockito.Mockito.mock;\nimport static org.mockito.Mockito.when;\nimport java.util.ArrayList;\nimport java.util.List;\nimport org.junit.Before;\nimport org.junit.Test;\n\npublic class OrderServiceTest {\n  private OrderService orderService;\n  private OrderDAO orderDAOMock;\n  \n  @Before\n  public void setUp() {\n    // åˆ›å»º OrderDAO çš„ Mock å¯¹è±¡\n    orderDAOMock = mock(OrderDAO.class);\n    // åˆå§‹åŒ– OrderService å¹¶æ³¨å…¥ Mock å¯¹è±¡\n    orderService = new OrderService(orderDAOMock);\n  }\n\n  @Test\n  public void testGetProductCatalogList() {\n    // æ¨¡æ‹Ÿ OrderDAO è¿”å›çš„äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; mockProductCatalogList = new ArrayList&lt;&gt;();\n    // æ·»åŠ ä¸€äº›æµ‹è¯•æ•°æ®\n    mockProductCatalogList.add(new ProductCatalog(\"1\", \"Product 1\"));\n    mockProductCatalogList.add(new ProductCatalog(\"2\", \"Product 2\"));\n    // å½“è°ƒç”¨ orderDAOMock çš„æ–¹æ³•æ—¶ï¼Œè¿”å›æ¨¡æ‹Ÿçš„äº§å“ç›®å½•åˆ—è¡¨\n    when(orderDAOMock.getProductCatalogList()).thenReturn(mockProductCatalogList);\n    // è°ƒç”¨ OrderService çš„æ–¹æ³•è·å–äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; actualProductCatalogList = orderService.getProductCatalogList();\n    // éªŒè¯è¿”å›çš„äº§å“ç›®å½•åˆ—è¡¨æ˜¯å¦ä¸æ¨¡æ‹Ÿæ•°æ®ä¸€è‡´\n    assertEquals(mockProductCatalogList.size(), actualProductCatalogList.size());\n    for (int i = 0; i &lt; mockProductCatalogList.size(); i++) {\n      assertEquals(mockProductCatalogList.get(i).getId(), actualProductCatalogList.get(i).getId());\n      assertEquals(mockProductCatalogList.get(i).getName(), actualProductCatalogList.get(i).getName());\n    }\n  }\n\n  @Test\n  public void testGetEmptyProductCatalogList() {\n    // æ¨¡æ‹Ÿ OrderDAO è¿”å›ç©ºçš„äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; emptyProductCatalogList = new ArrayList&lt;&gt;();\n    // å½“è°ƒç”¨ orderDAOMock çš„æ–¹æ³•æ—¶ï¼Œè¿”å›ç©ºçš„äº§å“ç›®å½•åˆ—è¡¨\n    when(orderDAOMock.getProductCatalogList()).thenReturn(emptyProductCatalogList);\n    // è°ƒç”¨ OrderService çš„æ–¹æ³•è·å–äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; actualProductCatalogList = orderService.getProductCatalogList();\n    // éªŒè¯è¿”å›çš„äº§å“ç›®å½•åˆ—è¡¨æ˜¯å¦ä¸ºç©ºåˆ—è¡¨\n    assertEquals(0, actualProductCatalogList.size());\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/56/b3/563d5ba66376967c6a4e9414bd46a5b3.jpg?wh=1640x330\" alt=\"\"></p><pre><code class=\"language-plain\">è¯·æŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ï¼Œç¼–å†™persistentå±‚çš„æµ‹è¯•ä»£ç \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/6f/69/6f03b6b550f58122625365f6c7d33169.jpg?wh=1708x262\" alt=\"\"></p><pre><code class=\"language-plain\">import static org.junit.Assert.assertEquals;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport java.util.List;\nimport org.junit.After;\nimport org.junit.Before;\nimport org.junit.Test;\n\npublic class OrderDAOTest {\n  private static final String DB_URL = \"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1\";\n  private static final String DB_USER = \"sa\";\n  private static final String DB_PASSWORD = \"\";\n  private OrderDAO orderDAO;\n\n  @Before\n  public void setUp() throws SQLException {\n    // åˆå§‹åŒ–å¹¶åˆ›å»ºå†…å­˜æ•°æ®åº“è¡¨\n    createTable();\n    // åˆå§‹åŒ– OrderDAO\n    orderDAO = new OrderDAO(DB_URL, DB_USER, DB_PASSWORD);\n  }\n\n  @After\n  public void tearDown() throws SQLException {\n    // åˆ é™¤å†…å­˜æ•°æ®åº“è¡¨\n    dropTable();\n  }\n\n  @Test\n  public void testGetProductCatalogList() throws SQLException {\n    // æ’å…¥æµ‹è¯•æ•°æ®åˆ°å†…å­˜æ•°æ®åº“\n    insertTestData();\n    // è°ƒç”¨ OrderDAO çš„æ–¹æ³•è·å–äº§å“ç›®å½•åˆ—è¡¨\n    List&lt;ProductCatalog&gt; productCatalogList = orderDAO.getProductCatalogList();\n    // éªŒè¯è¿”å›çš„äº§å“ç›®å½•åˆ—è¡¨æ˜¯å¦ä¸é¢„æœŸä¸€è‡´\n    assertEquals(2, productCatalogList.size());\n    assertEquals(\"1\", productCatalogList.get(0).getId());\n    assertEquals(\"Product 1\", productCatalogList.get(0).getName());\n    assertEquals(\"2\", productCatalogList.get(1).getId());\n    assertEquals(\"Product 2\", productCatalogList.get(1).getName());\n  }\n\n  private void createTable() throws SQLException {\n    try (Connection conn = DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);\n      Statement stmt = conn.createStatement()) {\n      stmt.execute(\"CREATE TABLE product_catalog (id VARCHAR(50), name VARCHAR(100))\");\n    }\n  }\n\n  private void dropTable() throws SQLException {\n    try (Connection conn = DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);\n      Statement stmt = conn.createStatement()) {\n      stmt.execute(\"DROP TABLE product_catalog\");\n    }\n  }\n\n  private void insertTestData() throws SQLException {\n    try (Connection conn = DriverManager.getConnection(DB_URL, DB_USER, DB_PASSWORD);\n      Statement stmt = conn.createStatement()) {\n      stmt.execute(\"INSERT INTO product_catalog VALUES ('1', 'Product 1')\");\n      stmt.execute(\"INSERT INTO product_catalog VALUES ('2', 'Product 2')\");\n    }\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/30/7c/303f6c0e47f068917cd63a60ef68297c.jpg?wh=1580x291\" alt=\"\"></p><p>è¯·æ³¨æ„è§‚å¯Ÿï¼Œä¸Šè¿°ä»£ç ä¸­å¯¹äºæµ‹è¯•ç­–ç•¥çš„åº”ç”¨ï¼Œæ˜¯ç¬¦åˆæˆ‘ä»¬å¯¹äºæµ‹è¯•å·¥åºçš„æè¿°çš„ã€‚åœ¨ç¡®è®¤æµ‹è¯•ä»£ç æ²¡æœ‰é—®é¢˜ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸LLMçš„äº¤äº’é…åˆï¼Œå®Œæˆç”Ÿäº§ä»£ç çš„ç¼–å†™ã€‚è¿™ä¸ªåœ¨å‰é¢çš„è¯¾ç¨‹é‡Œå·²ç»ç»™è¿‡äº†ä¾‹å­ï¼Œå°±ä¸å†é‡å¤äº†ã€‚</p><h2>å°†æµ‹è¯•å·¥åºæ¨¡ç‰ˆåŒ–</h2><p>å¯¹äºç®€å•çš„åœºæ™¯ï¼Œæˆ‘ä»¬é€šè¿‡CoTåŒ–çš„æµ‹è¯•å·¥åºï¼Œå°±è¶³ä»¥åº”å¯¹äº†ã€‚ä½†æ˜¯å¦‚æœå·¥åºæœ¬èº«å°±æœ‰å¾ˆå¤šç»†èŠ‚ï¼Œéœ€è¦æ›´å¤šçš„æŒ‡å¯¼æ—¶ï¼Œæˆ‘ä»¬è¦æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¿™æ ·çš„æµ‹è¯•å·¥åºæä¾›ç‹¬ç«‹çš„æç¤ºè¯æ¨¡æ¿ã€‚</p><p>æ¯”å¦‚ï¼Œå¯¹äºPersistentå±‚çš„æµ‹è¯•å·¥åºï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨flywayï¼Œåœ¨æµ‹è¯•å¼€å§‹ä¹‹å‰å®Œæˆå¯¹äºschemaçš„çŒæ³¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•å·¥åºæç¤ºè¯æ¨¡æ¿ï¼š</p><pre><code class=\"language-plain\">æŠ€æœ¯è¦æ±‚\n=======\nä½¿ç”¨H2æ•°æ®åº“ä½œä¸ºfake implementationï¼›\nåœ¨æ‰€æœ‰æµ‹è¯•å¼€å§‹ä¹‹å‰ï¼Œä½¿ç”¨flyway dbæ„å»ºè¡¨ç»“æ„ï¼›\nåœ¨æ‰€æœ‰æµ‹è¯•ç»“æŸåï¼Œæ¸…ç©ºæ•°æ®åº“ï¼›\n\néœ€æ±‚\n====\n{requirements}\n\nä»»åŠ¡åˆ—è¡¨\n====\n{task list}\n\nä»»åŠ¡\n===\næŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ï¼Œç¬¦åˆæŠ€æœ¯è¦æ±‚ï¼Œç¼–å†™æµ‹è¯•ä»£ç \n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/ff/32/ffb73ccb52c6689c13b099df6051d232.jpg?wh=1620x214\" alt=\"\"></p><pre><code class=\"language-plain\">import org.flywaydb.core.Flyway;\nimport org.h2.jdbcx.JdbcDataSource;\nimport org.junit.AfterClass;\nimport org.junit.BeforeClass;\nimport org.junit.Test;\nimport static org.junit.Assert.assertEquals;\nimport java.sql.Connection;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n\npublic class OrderDAOTest {\n  private static JdbcDataSource dataSource;\n  \n  private static OrderDAO orderDAO;\n  \n  @BeforeClass\n  public static void setupDatabase() throws SQLException {\n    // è®¾ç½®H2æ•°æ®åº“\n    dataSource = new JdbcDataSource();\n    dataSource.setURL(\"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1\");\n    // è¿è¡ŒFlywayæ¥åˆ›å»ºè¡¨ç»“æ„\n    Flyway flyway = Flyway.configure().dataSource(dataSource).load();\n    flyway.migrate();\n    // åˆå§‹åŒ–OrderDAO\n    orderDAO = new OrderDAO(dataSource);\n  }\n  \n  @AfterClass\n  public static void tearDownDatabase() throws SQLException {\n    // æ¸…ç©ºæ•°æ®åº“\n    try (Connection conn = dataSource.getConnection();\n      Statement stmt = conn.createStatement()) {\n      stmt.executeUpdate(\"DROP ALL OBJECTS DELETE FILES\");\n    }\n  }\n\n  @Test\n  public void testGetProductCatalogWhenNotEmpty() {\n    // æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®\n    insertTestDataIntoDatabase();\n    // æµ‹è¯•è·å–äº§å“ç›®å½•åˆ—è¡¨\n    assertEquals(2, orderDAO.getProductCatalog().size());\n  }\n  \n  @Test\n  public void testGetProductCatalogWhenEmpty() {\n    // æµ‹è¯•ç©ºäº§å“ç›®å½•åˆ—è¡¨æƒ…å†µ\n    assertEquals(0, orderDAO.getProductCatalog().size());\n  }\n\n  private void insertTestDataIntoDatabase() {\n    // åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®\n    // è¿™é‡Œå¯ä»¥ä½¿ç”¨ä»»ä½•æµ‹è¯•æ•°æ®æ¥æ¨¡æ‹Ÿå®é™…åœºæ™¯\n    // ç”±äºè¿™é‡Œåªæ˜¯ç¤ºä¾‹ï¼Œæˆ‘å°†ç®€å•åœ°æ’å…¥ä¸¤æ¡æ•°æ®ä½œä¸ºç¤ºä¾‹\n    // å®é™…é¡¹ç›®ä¸­åº”è¯¥æ ¹æ®éœ€è¦æ’å…¥æ›´å¤šçš„æµ‹è¯•æ•°æ®\n    try (Connection conn = dataSource.getConnection();\n      Statement stmt = conn.createStatement()) {\n      stmt.executeUpdate(\"INSERT INTO product_catalog (id, name) VALUES (1, 'Product 1')\");\n      stmt.executeUpdate(\"INSERT INTO product_catalog (id, name) VALUES (2, 'Product 2')\");\n    } catch (SQLException e) {\n      e.printStackTrace();\n    }\n  }\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e9/a3/e947eb686851666b85f8cb239c6904a3.jpg?wh=1536x271\" alt=\"\"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™ä¸ªæç¤ºè¯æ¨¡ç‰ˆä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¡«å…¥<strong>éœ€æ±‚</strong>å’Œ<strong>ä»»åŠ¡åˆ—è¡¨</strong>è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡ã€‚ä»è€Œä¿è¯CoTçš„æç¤ºè¯æ¨¡æ¿å’Œå…·ä½“æµ‹è¯•å·¥åºçš„æç¤ºè¯æ¨¡æ¿ï¼Œåœ¨ä¸Šä¸‹æ–‡ä¸­æ˜¯ç»Ÿä¸€çš„ã€‚åœ¨å¾—åˆ°ä¸Šé¢çš„å›ç­”æ—¶ï¼Œæˆ‘åˆ†åˆ«å¡«å…¥çš„ä¸Šä¸‹æ–‡æ˜¯ï¼š</p><pre><code class=\"language-plain\">éªŒæ”¶åœºæ™¯åŠæµ‹è¯•æ•°æ®\n\t\tç”¨æˆ·è¯·æ±‚è·å–äº§å“ç›®å½•åˆ—è¡¨ï¼š\nè¯·æ±‚ï¼šGET /products/catalog\né¢„æœŸå“åº”ï¼š200 OK\næµ‹è¯•æ•°æ®ï¼šæ— \n\t\tç©ºäº§å“ç›®å½•åˆ—è¡¨æƒ…å†µä¸‹çš„å“åº”ï¼š\nè¯·æ±‚ï¼šGET /products/catalog\né¢„æœŸå“åº”ï¼š200 OKï¼Œç©ºåˆ—è¡¨\næµ‹è¯•æ•°æ®ï¼šç©ºçš„äº§å“ç›®å½•åˆ—è¡¨\n</code></pre><pre><code class=\"language-plain\">ç”¨æˆ·è¯·æ±‚è·å–äº§å“ç›®å½•åˆ—è¡¨ï¼š\n  åˆ›å»ºåä¸º OrderDAO çš„ DAO ç±»ã€‚\n  å®ç°æ–¹æ³•ç”¨äºä»æ•°æ®åº“ä¸­è·å–äº§å“ç›®å½•åˆ—è¡¨ã€‚\n  åˆ›å»º H2 æ•°æ®åº“ä½œä¸º fake implementationã€‚\n  ç¼–å†™ SQL æŸ¥è¯¢ä»¥è·å–äº§å“ç›®å½•åˆ—è¡¨ã€‚\n  è¿”å›æŸ¥è¯¢ç»“æœï¼Œå¦‚æœä¸ºç©ºåˆ™è¿”å›ç©ºåˆ—è¡¨ã€‚\n</code></pre><h2>å°ç»“</h2><p>å½“ç„¶ï¼Œå¦ä¸€ä¸ªåšæ³•æ˜¯ï¼Œåœ¨å¾—åˆ°ä»»åŠ¡åˆ—è¡¨ä¹‹åã€‚ä¸LLMäº¤äº’ï¼Œè¿›å…¥åˆ°æŸä¸ªæµ‹è¯•å·¥åºæ—¶ï¼Œå°†è¯¥å·¥åºçš„æŠ€æœ¯è¦æ±‚ç›´æ¥è´´åˆ°LLMçš„å¯¹è¯ä¸­ï¼Œæ¯”å¦‚å‰é¢ç”¨åˆ°æŒä¹…å±‚å·¥åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿™æ ·æ¥å†™ï¼š</p><pre><code class=\"language-plain\">è¯·æŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ï¼Œç¼–å†™persistentå±‚çš„æµ‹è¯•ä»£ç ã€‚è¯·æ³¨æ„ï¼Œè¦ç¬¦åˆä¸‹åˆ—æŠ€æœ¯è¦æ±‚\n\næŠ€æœ¯è¦æ±‚\n=======\nä½¿ç”¨H2æ•°æ®åº“ä½œä¸ºfake implementationï¼›\nåœ¨æ‰€æœ‰æµ‹è¯•å¼€å§‹ä¹‹å‰ï¼Œä½¿ç”¨flyway dbæ„å»ºè¡¨ç»“æ„ï¼›\nåœ¨æ‰€æœ‰æµ‹è¯•ç»“æŸåï¼Œæ¸…ç©ºæ•°æ®åº“ï¼›\n</code></pre><p>è¿™æ ·å¯ä»¥é¿å…éœ€è¦äººå·¥ä¼ é€’ä¸Šä¸‹æ–‡çš„é—®é¢˜ã€‚æˆ‘ä¸å»ºè®®åœ¨CoTæ¨¡ç‰ˆä¸­æ”¾å…¥å¤ªå¤šçš„å…·ä½“å·¥åºç»†èŠ‚ï¼Œè¿™æ˜¯å› ä¸ºä»¥ç›®å‰ï¼ˆ2024å¹´3æœˆï¼‰LLMçš„èƒ½åŠ›ï¼Œå½“å·¥åºç»†èŠ‚è¿‡å¤šæ—¶ï¼Œå®ƒä¼šé—æ¼ä¸€äº›ç»†èŠ‚ã€‚è€Œç‹¬ç«‹çš„æµ‹è¯•å·¥åºæ¨¡ç‰ˆï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å‘ç°è¿™äº›ç»†èŠ‚ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¦ä¸€ä¸ªä½¿ç”¨ç‹¬ç«‹æµ‹è¯•å·¥åºæ¨¡ç‰ˆçš„å¥½å¤„æ˜¯ï¼Œæ›´å®¹æ˜“è¿‡æ¸¡åˆ°å¤§æ¨¡å‹é©±åŠ¨çš„è‡ªä¸»ä»£ç†æ¶æ„ï¼ˆLLM based Autonomous Agentï¼‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/a5/88/a51a7885590830fbe08a4da55b22d088.jpg?wh=2000x1078\" alt=\"\"></p><p>è¿™ç§ç”±ä¸€ä¸ªAgentæ§åˆ¶ä»»åŠ¡åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨å…¶ä»–Agentå®Œæˆå…·ä½“å·¥ä½œçš„æ¶æ„ï¼Œéå¸¸ç±»ä¼¼äºæœ€è¿‘ï¼ˆ2024å¹´3æœˆï¼‰ç«çƒ­çš„Devinã€‚è€Œåœ¨crewAIç­‰æ¡†æ¶çš„å¸®åŠ©ä¸‹ï¼Œè·å¾—ä¸€ä¸ªæ›´åŠ ç²¾å‡†çš„ã€ä¹Ÿç¬¦åˆæˆ‘ä»¬æ¶æ„è¦æ±‚çš„â€œå®šåˆ¶ç‰ˆDevinâ€ï¼Œæˆæœ¬æ˜¯éå¸¸ä½çš„ã€‚æˆ‘ä»¬åªè¦æ¢³ç†æ¸…æ¥šä¸æ¶æ„å¯¹åº”çš„æµ‹è¯•å·¥åºå³å¯ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>è¯·ä¿®æ”¹æœ¬æ–‡ä¸­çš„æ ·ä¾‹å·¥åºï¼Œå¹¶è°ƒæ•´CoTæ¨¡ç‰ˆï¼Œç”Ÿæˆç¬¦åˆå·¥åºè¦æ±‚çš„ä»»åŠ¡åˆ—è¡¨ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„æƒ³æ³•ï¼Œæˆ‘ä¼šè®©ç¼–è¾‘ç½®é¡¶ä¸€äº›ä¼˜è´¨å›ç­”ä¾›å¤§å®¶å­¦ä¹ è®¨è®ºã€‚</p>","neighbors":{"left":{"article_title":"21ï½œä»€ä¹ˆæ˜¯æµ‹è¯•å·¥åºï¼Ÿ","id":769164},"right":{"article_title":"23ï½œå›¢é˜Ÿå¼€å‘çš„æ ¸å¿ƒæ¨¡å¼","id":770627}},"comments":[{"had_liked":false,"id":390004,"user_name":"æœ¯å­ç±³å¾·","can_delete":false,"product_type":"c1","uid":1898023,"ip_address":"æµ™æ±Ÿ","ucode":"382EA7E2AF0B56","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg","comment_is_top":false,"comment_ctime":1714086899,"is_pvip":true,"replies":[{"id":141871,"content":"æ²¡ä»€ä¹ˆåŒºåˆ«","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":2537798,"ctime":1714109423,"ip_address":"å¹¿ä¸œ","comment_id":390004,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100755401,"comment_content":"ğŸ¤”â˜•ï¸ğŸ¤”â˜•ï¸ğŸ¤”\nã€Rã€‘åˆ—å‡ºï¼šéªŒæ”¶åœºæ™¯ + æµ‹è¯•æ•°æ® -&gt; ä»»åŠ¡åˆ—è¡¨\n-ã€‹æŒ‰ç…§ä»»åŠ¡åˆ—è¡¨ã€ç¬¦åˆæŠ€æœ¯è¦æ±‚ï¼Œç¼–å†™æµ‹è¯•ä»£ç ã€‚\nç‹¬ç«‹æµ‹è¯•å·¥åºæ¨¡æ¿ -&gt; å¤§æ¨¡å‹é©±åŠ¨çš„è‡ªä¸»ä»£ç†æ¶æ„ï¼ˆLLM based Autonomous Agentï¼‰ã€‚\nã€.I.ã€‘è¯¾ç¨‹åˆ°è¿™é‡Œï¼Œä¼¼ä¹è¶Šæ¥è¶Šæ·¡è–„äºæ˜¯å¦æœ‰ä¸€åªå¼€å‘å›¢é˜Ÿï¼Œè¿™æ˜¯ç§é”™è§‰ã€è¿˜æ˜¯ç§è¶‹åŠ¿ï¼Œæˆ‘ä¸å¤ªç¡®å®šã€‚è€Œä¸”ï¼Œå¼•å…¥LLMæ¥åŠ©æ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„è¿™äº›åœ°æ–¹ï¼Œé‚£ä¹ˆä½œä¸ºå…·ä½“çš„äººï¼Œåœ¨å“ªäº›åœ°æ–¹å‡ºç°ï¼Œä»¥åŠéœ€è¦å…·å¤‡æˆ–éœ€è¦æå‡çš„èƒ½åŠ›åœ¨å“ªäº›æ–¹é¢ï¼Œä¹Ÿå¾—è¯•ç€è¾¨åˆ«æ˜æ™°å‡ºæ¥ã€‚\nã€Qã€‘è¯¾ç¨‹ä¸­çš„CoTï¼Œè·Ÿä¸šç•Œçš„CoTçš„è”ç³»ä¸åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nâ€” by æœ¯å­ç±³å¾·@2024å¹´4æœˆ26æ—¥","like_count":0,"discussions":[{"author":{"id":2537798,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b9/46/758ecf4a.jpg","nickname":"å¾å…«å‰","note":"","ucode":"DA6D1EB08A7396","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":643176,"discussion_content":"æ²¡ä»€ä¹ˆåŒºåˆ«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1714109423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}