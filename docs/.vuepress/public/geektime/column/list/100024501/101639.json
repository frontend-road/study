{"id":101639,"title":"42 | iOSåŸç”Ÿã€å¤§å‰ç«¯å’ŒFlutteråˆ†åˆ«æ˜¯æ€ä¹ˆæ¸²æŸ“çš„ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æˆ´é“­ã€‚ä»Šå¤©ï¼Œæˆ‘æ¥å’Œä½ èŠèŠiOSåŸç”Ÿã€å¤§å‰ç«¯å’ŒFlutteråˆ†åˆ«æ˜¯æ€ä¹ˆæ¸²æŸ“çš„ã€‚</p><p>ç”¨æˆ·åœ¨ä½¿ç”¨ App æ—¶ï¼Œç•Œé¢çš„è®¾è®¡ã€æµç•…ç¨‹åº¦æ˜¯æœ€ç›´æ¥çš„ä½“éªŒã€‚ä¸ºæ­¤ï¼Œè‹¹æœå…¬å¸æä¾›äº†å„ä¸ªå±‚çº§çš„åº“ï¼Œæ¯”å¦‚ SwiftUIã€UIKitã€Core Animationã€Core Graphicã€OpenGL ï¼Œä»¥æ–¹ä¾¿Appç•Œé¢çš„å¼€å‘ã€‚</p><p>è¯´èµ·æ¥ï¼Œå³ä½¿ä½ ä¸äº†è§£è¿™äº›åº“çš„å®ç°åŸç†ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ƒä»¬æä¾›çš„æ˜“ç”¨æ¥å£ä¸Šæ‰‹å»å¼€å‘ Appï¼Œç‰¹åˆ«æ˜¯ SwiftUI å¤§å¤§ç®€åŒ–äº†ç•Œé¢çš„å¼€å‘ï¼Œä¹Ÿç¡®å®èƒ½å¤Ÿè§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦é‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œå®Œå…¨ä¾é æœç´¢è·å¾—çš„ä¸å®Œæ•´çš„ã€æ‹¼å‡‘æ¥çš„çŸ¥è¯†ï¼Œå¤§æ¦‚ç‡åªèƒ½è§£ä¸€æ—¶ä¹‹éœ€ï¼Œè¦æƒ³ç³»ç»Ÿåœ°è§£å†³é—®é¢˜ï¼Œè¿˜æ˜¯è¦çŸ¥é“è¿™äº›åº“çš„å®ç°åŸç†ã€‚</p><p>è€Œè¿™äº›ä¸ç•Œé¢ç›¸å…³çš„åº“ï¼ŒèƒŒåçš„çŸ¥è¯†å…¶å®å°±æ˜¯æ¸²æŸ“ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±å’Œä½ è¯´è¯´æ¸²æŸ“çš„åŸç†ã€‚</p><h2>æ¸²æŸ“åŸç†</h2><p>æˆ‘ä»¬çœ‹åˆ°çš„ App ç•Œé¢ï¼Œéƒ½æ˜¯ç”± CPU å’Œ GPU å…±åŒè®¡ç®—å¤„ç†çš„ã€‚</p><p>CPU å†…éƒ¨æµæ°´çº¿ç»“æ„æ‹¥æœ‰å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œä¸€èˆ¬ç”¨äºæ˜¾ç¤ºå†…å®¹çš„è®¡ç®—ã€‚è€Œ GPUçš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›æ›´å¼ºï¼Œèƒ½å¤Ÿé€šè¿‡è®¡ç®—å°†å›¾å½¢ç»“æœæ˜¾ç¤ºåœ¨å±å¹•åƒç´ ä¸­ã€‚å†…å­˜ä¸­çš„å›¾å½¢æ•°æ®ï¼Œç»è¿‡è½¬æ¢æ˜¾ç¤ºåˆ°å±å¹•ä¸Šçš„è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯æ¸²æŸ“ã€‚è€Œè´Ÿè´£æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹çš„ï¼Œå°±æ˜¯GPUã€‚</p><p>æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼ŒGPUéœ€è¦å¤„ç†å±å¹•ä¸Šçš„æ¯ä¸€ä¸ªåƒç´ ç‚¹ï¼Œå¹¶ä¿è¯è¿™äº›åƒç´ ç‚¹çš„æ›´æ–°æ˜¯æµç•…çš„ï¼Œè¿™å°±å¯¹ GPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›è¦æ±‚éå¸¸é«˜ã€‚</p><!-- [[[read_end]]] --><p>æ—©æœŸï¼Œå›¾å½¢æ¸²æŸ“æ˜¯ç”± VGAï¼ˆVideo Graphics Arrayï¼Œè§†é¢‘å›¾å½¢é˜µåˆ—ï¼‰æ¥å®Œæˆçš„ï¼Œéšç€3DåŠ é€Ÿçš„éœ€è¦ï¼Œå¸¦æ¥äº†æ¯”å¦‚ä¸‰è§’å½¢ç”Ÿæˆã€å…‰æ …åŒ–ã€çº¹ç†è´´å›¾ç­‰æŠ€æœ¯ã€‚å¤„ç†è¿™ä¸€ç³»åˆ—æŠ€æœ¯çš„å¤„ç†å™¨ï¼Œå°±è¢«ç»Ÿç§°ä¸º GPUã€‚</p><p>GPUçš„ä¸»è¦å·¥ä½œæ˜¯å°† 3D åæ ‡è½¬åŒ–æˆ 2D åæ ‡ï¼Œç„¶åå†æŠŠ2D åæ ‡è½¬æˆå®é™…åƒç´ ï¼Œå…·ä½“å®ç°å¯ä»¥åˆ†ä¸ºé¡¶ç‚¹ç€è‰²å™¨ï¼ˆç¡®å®šå½¢çŠ¶çš„ç‚¹ï¼‰ã€å½¢çŠ¶è£…é…ï¼ˆç¡®å®šå½¢çŠ¶çš„çº¿ï¼‰ã€å‡ ä½•ç€è‰²å™¨ï¼ˆç¡®å®šä¸‰è§’å½¢ä¸ªæ•°ï¼‰ã€å…‰æ …åŒ–ï¼ˆç¡®å®šå±å¹•åƒç´ ç‚¹ï¼‰ã€ç‰‡æ®µç€è‰²å™¨ï¼ˆå¯¹åƒç´ ç‚¹ç€è‰²ï¼‰ã€æµ‹è¯•ä¸æ··åˆï¼ˆæ£€æŸ¥æ·±åº¦å’Œé€æ˜åº¦è¿›è¡Œæ··åˆï¼‰å…­ä¸ªé˜¶æ®µã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°æ§åˆ¶ GPU çš„è¿ç®—ï¼ŒGPU çš„å¯ç¼–ç¨‹èƒ½åŠ›ä¹Ÿä¸æ–­åŠ å¼ºï¼Œå¼€å§‹æ”¯æŒ C å’Œ C++ è¯­è¨€ã€‚é€šè¿‡ OpenGL æ ‡å‡†å®šä¹‰çš„åº“ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°æ“ä½œ GPUã€‚</p><p>åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼ŒCPU ä¸“é—¨ç”¨æ¥å¤„ç†æ¸²æŸ“å†…å®¹çš„è®¡ç®—ï¼Œæ¯”å¦‚è§†å›¾åˆ›å»ºã€å¸ƒå±€ã€å›¾ç‰‡è§£ç ç­‰ï¼Œå†…å®¹è®¡ç®—å®Œæˆåï¼Œå†ä¼ è¾“ç»™ GPU è¿›è¡Œæ¸²æŸ“ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒCPU å’Œ GPU çš„ç›¸äº’ç»“åˆï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨æ‰‹æœºç¡¬ä»¶æ¥æå‡ç”¨æˆ·ä½¿ç”¨ App çš„ä½“éªŒã€‚å½“ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœCPU çš„è®¡ç®—æ—¶é—´è¶…è¿‡äº†å±å¹•åˆ·æ–°é¢‘ç‡è¦æ±‚çš„æ—¶é—´ï¼Œç•Œé¢æ“ä½œå°±ä¼šå˜å¾—ä¸æµç•…ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœä½ æƒ³è¦çŸ¥é“åŸç”Ÿã€å¤§å‰ç«¯å’Œ Flutter è°ä¼šæ›´æµç•…ï¼Œå°±è¦åˆ†åˆ«å»äº†è§£åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œè°çš„CPU è®¡ç®—å†…å®¹ä¼šæ›´å¿«ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹åŸç”Ÿæ¸²æŸ“ä¸­çš„è®¡ç®—ã€‚</p><h2>åŸç”Ÿæ¸²æŸ“</h2><p>åŸç”Ÿç•Œé¢æ›´æ–°æ¸²æŸ“çš„æµç¨‹ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››æ­¥ã€‚</p><p><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œæ›´æ–°è§†å›¾æ ‘ï¼ŒåŒæ­¥æ›´æ–°å›¾å±‚æ ‘ã€‚</p><p><strong>ç¬¬äºŒæ­¥</strong>ï¼ŒCPU è®¡ç®—è¦æ˜¾ç¤ºçš„å†…å®¹ï¼ŒåŒ…æ‹¬è§†å›¾åˆ›å»ºï¼ˆè®¾ç½® Layer çš„å±æ€§ï¼‰ã€å¸ƒå±€è®¡ç®—ã€è§†å›¾ç»˜åˆ¶ï¼ˆåˆ›å»º Layer çš„ Backing Imageï¼‰ã€å›¾åƒè§£ç è½¬æ¢ã€‚å½“ runloop åœ¨ BeforeWaiting å’Œ Exit æ—¶ï¼Œä¼šé€šçŸ¥æ³¨å†Œçš„ç›‘å¬ï¼Œç„¶åå¯¹å›¾å±‚æ‰“åŒ…ï¼Œæ‰“å®ŒåŒ…åï¼Œå°†æ‰“åŒ…æ•°æ®å‘é€ç»™ä¸€ä¸ªç‹¬ç«‹è´Ÿè´£æ¸²æŸ“çš„è¿›ç¨‹ Render Serverã€‚</p><p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼Œæ•°æ®åˆ°è¾¾ Render Serveråä¼šè¢«ååºåˆ—åŒ–ï¼Œå¾—åˆ°å›¾å±‚æ ‘ï¼ŒæŒ‰ç…§å›¾å±‚æ ‘ä¸­å›¾å±‚é¡ºåºã€RGBAå€¼ã€å›¾å±‚ frame è¿‡æ»¤å›¾å±‚ä¸­è¢«é®æŒ¡çš„éƒ¨åˆ†ï¼Œè¿‡æ»¤åå°†å›¾å±‚æ ‘è½¬æˆæ¸²æŸ“æ ‘ï¼Œæ¸²æŸ“æ ‘çš„ä¿¡æ¯ä¼šè½¬ç»™ OpenGL ES/Metalã€‚å‰é¢ CPU æ‰€å¤„ç†çš„è¿™äº›äº‹æƒ…ç»Ÿç§°ä¸º Commit Transactionã€‚</p><p><strong>ç¬¬å››æ­¥</strong>ï¼ŒRender Server ä¼šè°ƒç”¨ GPUï¼ŒGPU å¼€å§‹è¿›è¡Œå‰é¢æåˆ°çš„é¡¶ç‚¹ç€è‰²å™¨ã€å½¢çŠ¶è£…é…ã€å‡ ä½•ç€è‰²å™¨ã€å…‰æ …åŒ–ã€ç‰‡æ®µç€è‰²å™¨ã€æµ‹è¯•ä¸æ··åˆå…­ä¸ªé˜¶æ®µã€‚å®Œæˆè¿™å…­ä¸ªé˜¶æ®µçš„å·¥ä½œåï¼Œå†å°† CPU å’Œ GPU è®¡ç®—åçš„æ•°æ®æ˜¾ç¤ºåœ¨å±å¹•çš„æ¯ä¸ªåƒç´ ç‚¹ä¸Šã€‚</p><p>æ•´ä¸ªæ¸²æŸ“è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/d4/8f/d4ae58f7b0d09725757dca84ea7a318f.png?wh=1920*1080\" alt=\"\"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒCPU å¤„ç†å®Œæ¸²æŸ“å†…å®¹ä¼šè¾“å…¥åˆ° Render Server ä¸­ï¼Œç»å›¾å±‚æ ‘å’Œæ¸²æŸ“æ ‘çš„è½¬æ¢ï¼Œé€šè¿‡ OpenGL æ¥å£æä¾›ç»™ GPUï¼ŒGPU å¤„ç†å®Œååœ¨å±å¹•ä¸Šæ˜¾ç¤ºã€‚</p><p>æ¸²æŸ“è¿‡ç¨‹ä¸­ Commit Trasaction çš„å¸ƒå±€è®¡ç®—ä¼šé‡è½½è§†å›¾ LayoutSubviews æ–¹æ³•ï¼Œä»¥åŠæ‰§è¡Œ addSubview æ–¹æ³•æ¥æ·»åŠ è§†å›¾ã€‚è§†å›¾ç»˜åˆ¶ä¼šé‡è½½è§†å›¾çš„ drawRect æ–¹æ³•ã€‚è¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ iOS å¼€å‘ä¸­å¸¸ç”¨çš„ã€‚</p><p>ç§»åŠ¨è§†å›¾ä½ç½®ã€åˆ é™¤è§†å›¾ã€éšè—æˆ–æ˜¾ç¤ºè§†å›¾ã€è°ƒç”¨ setNeedsDisplay æˆ– setNeedsDisplayInRect æ–¹æ³•ï¼Œéƒ½ä¼šè§¦å‘ç•Œé¢æ›´æ–°ï¼Œæ‰§è¡Œæ¸²æŸ“æµç¨‹ã€‚</p><p>è¿™äº›å°±æ˜¯åŸç”Ÿæ¸²æŸ“è®¡ç®—çš„æ‰€æœ‰å†…å®¹äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†ä¸€èµ·çœ‹çœ‹å¤§å‰ç«¯çš„æ¸²æŸ“ã€‚</p><h2>å¤§å‰ç«¯æ¸²æŸ“</h2><p>å¤§å‰ç«¯çš„å¼€å‘æ¡†æ¶ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šç¬¬ä¸€ç±»æ˜¯åŸºäº WebView çš„ï¼Œç¬¬äºŒç±»æ˜¯ç±»ä¼¼ React Native çš„ã€‚</p><p>å¯¹äºç¬¬ä¸€ç±» WebView çš„å¤§å‰ç«¯æ¸²æŸ“ï¼Œä¸»è¦å·¥ä½œåœ¨ WebKit ä¸­å®Œæˆã€‚WebKit çš„æ¸²æŸ“å±‚æ¥è‡ªä»¥å‰ macOS çš„ Layer Rendering æ¶æ„ï¼Œè€ŒiOS ä¹Ÿæ˜¯åŸºäºè¿™ä¸€å¥—æ¶æ„ã€‚æ‰€ä»¥ï¼Œä»æœ¬è´¨ä¸Šæ¥çœ‹ï¼ŒWebKit å’Œ iOS åŸç”Ÿæ¸²æŸ“å·®åˆ«ä¸å¤§ã€‚</p><p>ç¬¬äºŒç±»çš„ç±»React Native æ›´ç®€å•ï¼Œæ¸²æŸ“ç›´æ¥èµ°çš„æ˜¯iOS åŸç”Ÿçš„æ¸²æŸ“ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šæ„Ÿè§‰ WebView å’Œç±»React Native æ¯”åŸç”Ÿæ¸²æŸ“å¾—æ…¢å‘¢ï¼Ÿ</p><p><strong>ä»ç¬¬ä¸€æ¬¡å†…å®¹åŠ è½½æ¥çœ‹</strong>ï¼Œå³ä½¿æ˜¯æœ¬åœ°åŠ è½½ï¼Œå¤§å‰ç«¯ä¹Ÿè¦æ¯”åŸç”Ÿå¤šå‡ºè„šæœ¬ä»£ç è§£æçš„å·¥ä½œã€‚</p><p>WebViewéœ€è¦é¢å¤–è§£æ HTML + CSS + JavaScript ä»£ç ï¼Œè€Œç±» React Nativeæ–¹æ¡ˆåˆ™éœ€è¦è§£æJSON + JavaScriptã€‚HTML + CSS çš„å¤æ‚åº¦è¦é«˜äº JSONï¼Œæ‰€ä»¥è§£æèµ·æ¥ä¼šæ¯” JSON æ…¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¦–æ¬¡å†…å®¹åŠ è½½æ—¶ï¼Œ WebView ä¼šæ¯”ç±»React Native æ…¢ã€‚</p><p><strong>ä»è¯­è¨€æœ¬èº«çš„è§£é‡Šæ‰§è¡Œæ€§èƒ½æ¥çœ‹</strong>ï¼Œå¤§å‰ç«¯åŠ è½½åçš„ç•Œé¢æ›´æ–°ä¼šé€šè¿‡ JavaScript è§£é‡Šæ‰§è¡Œï¼Œè€ŒJavaScript è§£é‡Šæ‰§è¡Œæ€§èƒ½è¦æ¯”åŸç”Ÿå·®ï¼Œç‰¹åˆ«æ˜¯è§£é‡Šæ‰§è¡Œå¤æ‚é€»è¾‘æˆ–å¤§é‡è®¡ç®—æ—¶ã€‚æ‰€ä»¥ï¼Œå¤§å‰ç«¯çš„è¿ç®—é€Ÿåº¦ï¼Œè¦æ¯”åŸç”Ÿæ…¢ä¸å°‘ã€‚</p><p>é™¤äº†é¦–æ¬¡åŠ è½½è§£æè¦è€—æ—¶ï¼Œä»¥åŠ JavaScript è¯­è¨€æœ¬èº«è§£é‡Šæ…¢å¯¼è‡´çš„æ€§èƒ½é—®é¢˜å¤–ï¼ŒWebView çš„æ¸²æŸ“è¿›ç¨‹æ˜¯å•ç‹¬çš„ï¼Œæ¯å¸§çš„æ›´æ–°éƒ½è¦é€šè¿‡ IPC è°ƒç”¨ GPU è¿›ç¨‹ã€‚é¢‘ç¹çš„IPC è¿›ç¨‹é€šä¿¡ä¹Ÿä¼šæœ‰æ€§èƒ½æŸè€—ã€‚</p><p>WebViewçš„å•ç‹¬æ¸²æŸ“è¿›ç¨‹è¿˜æ— æ³•è®¿é—® GPU çš„ contextï¼Œè¿™æ ·ä¸¤ä¸ªè¿›ç¨‹å°±æ²¡æœ‰åŠæ³•å…±äº«çº¹ç†èµ„æºã€‚çº¹ç†èµ„æºæ— æ³•ç›´æ¥ä½¿ç”¨ GPU çš„ Context å…‰æ …åŒ–ï¼Œé‚£å°±åªèƒ½é€šè¿‡ IPC ä¼ ç»™ GPU è¿›ç¨‹ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´ GPU æ— æ³•å‘æŒ¥è‡ªèº«çš„æ€§èƒ½ä¼˜åŠ¿ã€‚ç”±äº WebView çš„å…‰æ …åŒ–æ— æ³•åŠæ—¶åŒæ­¥åˆ° GPUï¼Œæ»‘åŠ¨æ—¶å®¹æ˜“å‡ºç°ç™½å±ï¼Œå°±å¾ˆéš¾é¿å…äº†ã€‚</p><p>è¯´å®Œäº†å¤§å‰ç«¯çš„æ¸²æŸ“ï¼Œä½ ä¼šå‘ç°ï¼Œç›¸å¯¹äºåŸç”Ÿæ¸²æŸ“ï¼Œæ— è®ºæ˜¯ WebView è¿˜æ˜¯ç±» React Nativeéƒ½ä¼šå› ä¸ºè„šæœ¬è¯­è¨€æœ¬èº«çš„æ€§èƒ½é—®é¢˜è€Œåœ¨å­˜åœ¨æ€§èƒ½å·®è·ã€‚é‚£ä¹ˆï¼Œå¯¹äº Flutter è¿™ç§æ²¡æœ‰ä½¿ç”¨è„šæœ¬è¯­è¨€ï¼Œå¹¶ä¸”æ¸²æŸ“å¼•æ“ä¹Ÿæ˜¯å…¨æ–°çš„æ¡†æ¶ï¼Œå…¶æ¸²æŸ“æ–¹å¼æœ‰ä»€ä¹ˆä¸åŒï¼Œæ€§èƒ½åˆæ€æ ·å‘¢ï¼Ÿ</p><h2>Flutter æ¸²æŸ“</h2><p>Flutter ç•Œé¢æ˜¯ç”± Widget ç»„æˆçš„ï¼Œæ‰€æœ‰ Widget ç»„æˆ Widget Treeï¼Œç•Œé¢æ›´æ–°æ—¶ä¼šæ›´æ–° Widget Treeï¼Œç„¶åå†æ›´æ–° Element Treeï¼Œæœ€åæ›´æ–° RenderObject Treeã€‚</p><p>æ¥ä¸‹æ¥çš„æ¸²æŸ“æµç¨‹ï¼ŒFlutter æ¸²æŸ“åœ¨ Framework å±‚ä¼šæœ‰ Buildã€Wiget Treeã€Element Treeã€RenderObject Treeã€Layoutã€Paintã€Composited Layer ç­‰å‡ ä¸ªé˜¶æ®µã€‚å°† Layer è¿›è¡Œç»„åˆï¼Œç”Ÿæˆçº¹ç†ï¼Œä½¿ç”¨ OpenGL çš„æ¥å£å‘ GPU æäº¤æ¸²æŸ“å†…å®¹è¿›è¡Œå…‰æ …åŒ–ä¸åˆæˆï¼Œæ˜¯åœ¨ Flutter çš„ C++ å±‚ï¼Œä½¿ç”¨çš„æ˜¯ Skia åº“ã€‚åŒ…æ‹¬æäº¤åˆ° GPU è¿›ç¨‹åï¼Œåˆæˆè®¡ç®—ï¼Œæ˜¾ç¤ºå±å¹•çš„è¿‡ç¨‹å’Œ iOS åŸç”ŸåŸºæœ¬æ˜¯ç±»ä¼¼çš„ï¼Œå› æ­¤æ€§èƒ½ä¹Ÿå·®ä¸å¤šã€‚</p><p>Flutter çš„ä¸»è¦ä¼˜åŠ¿ï¼Œåœ¨äºå®ƒèƒ½å¤ŸåŒæ—¶è¿è¡Œäº Android å’Œ iOSè¿™ä¸¤ä¸ªå¹³å°ã€‚ä½†æ˜¯ï¼Œè‹¹æœå…¬å¸åœ¨WWDC 2019 ä¸Šæ¨å‡º SwiftUI å’Œ Preview åï¼ŒFlutter åœ¨ç•Œé¢ç¼–å†™å’Œ Hot Reload ä¸Šçš„ä¼˜åŠ¿ä¼šé€æ¸é™ä½ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘é¦–å…ˆå’Œä½ è¯´äº†æ¸²æŸ“çš„åŸç†ï¼Œç„¶ååˆ†åˆ«å’Œä½ å±•å¼€äº†åŸç”Ÿã€å¤§å‰ç«¯ã€Flutter æ˜¯æ€ä¹ˆæ¸²æŸ“çš„ã€‚æ•´ä½“æ¥çœ‹ï¼Œå¤§å‰ç«¯ä¸­çš„ WebView æ–¹å¼æ¸²æŸ“æ€§èƒ½ä¼šå·®äº›ï¼ŒReact Native å’Œå…¶ä»–æ–¹æ¡ˆåœ¨æ¸²æŸ“ä¸Šçš„æ€§èƒ½éƒ½å·®ä¸å¤šã€‚</p><p>è€Œå…³äºå¦‚ä½•é€‰æ‹©è¿™ä¸‰ç§å¼€å‘æ–¹æ¡ˆï¼Œæˆ‘çš„å»ºè®®æ˜¯ç»“åˆè‡ªèº«æƒ…å†µå’Œå·¥ä½œéœ€è¦æ¥ç¡®å®šå°±å¥½ã€‚</p><p>å½“ä½ æ‰€åœ¨å›¢é˜Ÿå·²ç»åå‘äºå¤§å‰ç«¯æ—¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€‰æ‹©æ‹¥æŠ±å˜åŒ–ï¼Œæ¯•ç«Ÿå‰ç«¯æŠ€æœ¯ç”Ÿæ€å·²ç»éå¸¸å®Œå–„äº†ã€‚</p><p>å¦‚æœä½ å¼€å§‹å–œæ¬¢è°·æ­Œçš„æŠ€æœ¯ï¼Œä¹Ÿæƒ³å¤šäº†è§£ Android æˆ–è€…è°·æ­Œçš„æ–°æ“ä½œç³»ç»Ÿ Fuchsiaçš„è¯ï¼ŒFlutter æ— ç–‘æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ å’Œæˆ‘ä¸€æ ·æ˜¯ä¸€åæœç²‰çš„è¯ï¼Œé‚£æˆ‘ç›¸ä¿¡è‹¹æœå…¬å¸çš„äº§å“ä¼šä¸æ–­ç»™ä½ æƒŠå–œï¼Œå¯ä»¥ç»§ç»­ä½ çš„iOS åŸç”Ÿå¼€å‘ä¹‹æ—…ã€‚ç›¸ä¿¡åœ¨ SwiftUIã€Project Catalystã€Combine è¿™äº›é¡¹ç›®çš„å¸®åŠ©ä¸‹ï¼Œä½ ä¸€å®šèƒ½å¤Ÿå¼€å‘å‡ºæ›´å¤šã€æ›´ä¼˜ç§€çš„ App ã€‚</p><h2>è¯¾åä½œä¸š</h2><p>åœ¨ä½ çœ‹æ¥ï¼ŒChrome å’Œ WebKit çš„æ¸²æŸ“å¼•æ“ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºç»™æˆ‘ç•™è¨€åˆ†äº«ä½ çš„è§‚ç‚¹ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><p></p>","neighbors":{"left":{"article_title":"41 | åŸç”Ÿå¸ƒå±€è½¬åˆ°å‰ç«¯å¸ƒå±€ï¼Œå¼€å‘æ€è·¯æœ‰å“ªäº›è½¬å˜ï¼Ÿ","id":100760},"right":{"article_title":"43 | å‰–æä½¿ App å…·æœ‰åŠ¨æ€åŒ–å’Œçƒ­æ›´æ–°èƒ½åŠ›çš„æ–¹æ¡ˆ","id":101888}},"comments":[{"had_liked":false,"id":159848,"user_name":"ğŸš² åˆ˜å¤§æ¬¢","can_delete":false,"product_type":"c1","uid":1512859,"ip_address":"","ucode":"5B6907FEB0AD10","user_header":"https://static001.geekbang.org/account/avatar/00/17/15/9b/c5636ab7.jpg","comment_is_top":false,"comment_ctime":1575810802,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18755679986","product_id":100024501,"comment_content":"æ–—èƒ†å°è¯•å›ç­”ä¸€ä¸‹æ¥¼ä¸ŠåŒå­¦çš„é—®é¢˜ å±å¹•å¼€å§‹æ¸²æŸ“çš„æ—¶å€™ cpuä¼šåšåŒ…æ‹¬è§†å›¾åˆ›å»º å¸ƒå±€è®¡ç®— å›¾å±‚ç»˜åˆ¶ å›¾åƒè§£ç ç­‰ä¸€ç³»åˆ—äº‹æƒ… ç­‰æ„ä»¶å¥½å›¾å±‚æ ‘ æ¸²æŸ“å±‚æ‹¿åˆ°å¹¶ååºåˆ—åŒ–åæˆä¸ºæ¸²æŸ“æ ‘è°ƒç”¨openGLæ“ä½œgpuæŒ‡ä»¤æ—¶ å…¶å®åœ¨åºåˆ—åŒ–å®Œæˆ è¿™ä¸ªäº‹åŠ¡å·²ç»å®Œæˆäº† å‰©ä¸‹çš„å°±æ˜¯å±å¹•ä¸Šç»˜åˆ¶è¿™ä¸€å¸§çš„æ˜¾ç¤ºäº† ä½ è¯´çš„æ”¹å˜ä½ç½®åº”è¯¥æ˜¯ä¸‹å¸§çš„äº‹æƒ…äº† ä¸å¯èƒ½åœ¨åœ¨ä¸­é—´è¿˜æœ‰ç©¿æ’ä¸€æ¬¡æäº¤è¿™ä¹ˆä¸€è¯´å§ ","like_count":4},{"had_liked":false,"id":335199,"user_name":"Bo","can_delete":false,"product_type":"c1","uid":2076600,"ip_address":"","ucode":"D5DD3300310C02","user_header":"https://static001.geekbang.org/account/avatar/00/1f/af/b8/458866d3.jpg","comment_is_top":false,"comment_ctime":1645404632,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645404632","product_id":100024501,"comment_content":"Chromeæ¸²æŸ“å¼•æ“Blinkï¼šhttps:&#47;&#47;www.chromium.org&#47;blink&#47;","like_count":0},{"had_liked":false,"id":335198,"user_name":"Bo","can_delete":false,"product_type":"c1","uid":2076600,"ip_address":"","ucode":"D5DD3300310C02","user_header":"https://static001.geekbang.org/account/avatar/00/1f/af/b8/458866d3.jpg","comment_is_top":false,"comment_ctime":1645404570,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645404570","product_id":100024501,"comment_content":"å¥½åƒæ²¡æœ‰äººè®¨è®ºè¯¾åä½œä¸šï¼Œæš‚ä¸”æ”¾ä¸Šè‡ªå·±æœç´¢èµ„æ–™åå¾—åˆ°çš„å›ç­”ï¼š<br>Googleèµ·åˆä½¿ç”¨Webkitä½œä¸ºChromeæµè§ˆå™¨çš„å¼•æ“ï¼Œåæ¥ä»¥Webkitå¼•æ“ä¸ºåŸºç¡€åˆ›é€ äº†Blinkå¼•æ“ï¼Œå®ƒé’ˆå¯¹Webkitå†…æ ¸ï¼Œå»æ‰äº†å‡ åä¸‡è¡Œä¸ç›¸å…³çš„å¤æ‚ä»£ç ï¼Œè®©æ•ˆç‡æ›´é«˜ã€‚ç„¶åé’ˆå¯¹æœªæ¥çš„ç½‘é¡µæ ¼å¼ï¼Œåšäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå’Œæ•ˆç‡æå‡çš„å¤„ç†ã€‚<br>æ‰€ä»¥Chromeçš„Blinkå†…æ ¸å¯ä»¥çœ‹æˆæ˜¯Webkitçš„ç²¾ç®€é«˜æ•ˆå¼ºåŒ–ç‰ˆã€‚","like_count":1},{"had_liked":false,"id":245589,"user_name":"Geek_54260c","can_delete":false,"product_type":"c1","uid":1528641,"ip_address":"","ucode":"1F76CC242CD25A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epa5lcfaxArmZI1upDsVh9zmFdefuN79Lkox5fEVMhd5ANEfWtHStbONwvKKc1sL6tHX9iaFpNEyDQ/132","comment_is_top":false,"comment_ctime":1599003456,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1599003456","product_id":100024501,"comment_content":"åŸç”Ÿæ¯ä¸€å¸§çš„æ¸²æŸ“ä¸ä¹Ÿæ˜¯é€šè¿‡ipcä¼ é€’ç»™render serverçš„å˜›ï¼Ÿcore animation å’Œrender server ä¹Ÿæ˜¯ç‹¬ç«‹è¿›ç¨‹ï¼Œä¸ºä»€ä¹ˆè¿™å—ä¼šæ¯”webviewå¿«å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1267622,"avatar":"https://static001.geekbang.org/account/avatar/00/13/57/a6/2a55b1eb.jpg","nickname":"ææ±‚","note":"","ucode":"176477BA9EB7DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380966,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624844694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232860,"user_name":"SchrÃ¶dinger","can_delete":false,"product_type":"c1","uid":1471563,"ip_address":"","ucode":"D5A248760D0206","user_header":"https://static001.geekbang.org/account/avatar/00/16/74/4b/328b1c57.jpg","comment_is_top":false,"comment_ctime":1594132305,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1594132305","product_id":100024501,"comment_content":"åŸç”Ÿæ¸²æŸ“é‚£éƒ¨åˆ†æ„Ÿè§‰å†™å¾—æœ‰äº›é—®é¢˜","like_count":0,"discussions":[{"author":{"id":2076600,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/af/b8/458866d3.jpg","nickname":"Bo","note":"","ucode":"D5DD3300310C02","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552299,"discussion_content":"è¯·é—®æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645404647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":211506,"user_name":"Geek_9dbcb4","can_delete":false,"product_type":"c1","uid":1785940,"ip_address":"","ucode":"BB92D5E844A743","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/rWMGIQG1z13nekorr9I4PY1w7rlskssf949IQ24SvIewpM7mmZoH2QEZ2aKHu5tkmicGQ7KTGrN9vFYhrDsdp9w/132","comment_is_top":false,"comment_ctime":1587974729,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1587974729","product_id":100024501,"comment_content":"flutteræ˜¯æœ‰UIå±€éƒ¨åˆ·æ–°çš„åŠŸèƒ½ï¼Œæ¥æé«˜æ¸²æŸ“æ•ˆç‡ã€‚iOSçš„æ¸²æŸ“ï¼Œæ²¡æœ‰è¿™æ–¹é¢çš„ä¼˜åŒ–å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1023272,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9d/28/bcaf070d.jpg","nickname":"å£¹","note":"","ucode":"335D34216066E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":250764,"discussion_content":"setneedslayoutï¼Œsetneedsdisplay","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1588038850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":109429,"user_name":"æ–¹é‡‘å³°","can_delete":false,"product_type":"c1","uid":1079265,"ip_address":"","ucode":"1130BF377F588E","user_header":"https://static001.geekbang.org/account/avatar/00/10/77/e1/fa7fd9f3.jpg","comment_is_top":false,"comment_ctime":1562031675,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1562031675","product_id":100024501,"comment_content":"è€å¸ˆï¼Œé—®ä¸€ä¸‹å•Šï¼iOSçš„å›¾å±‚æ ‘ç»è¿‡åºåˆ—åŒ–å‘é€åˆ°æ¸²æŸ“æœåŠ¡è¿›ç¨‹ï¼Œæ¸²æŸ“æœåŠ¡è¿›ç¨‹ååºåˆ—åŒ–å¾—åˆ°å›¾å±‚æ ‘ï¼Œç„¶åç”Ÿæˆæ¸²æŸ“æ ‘ï¼Œè¿™é‡Œå¦‚æœå½“å‰åªæ”¹åŠ¨äº†ä¸€ä¸ªå›¾å±‚çš„ä½ç½®ï¼Œappå½“å‰è¿›ç¨‹ä¹Ÿä¼šå°†æ•´é¢—å›¾å±‚æ ‘åºåˆ—åŒ–å‘é€åˆ°æ¸²æŸ“æœåŠ¡è¿›ç¨‹ï¼Ÿå¦‚æœæ˜¯æ•´é¢—å›¾å±‚æ ‘è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºè¿›ç¨‹å’Œè¿›ç¨‹ä¹‹é—´çš„é€šè®¯ï¼Œæ•°æ®ä¼ è¾“æ˜¯ä¸€ä¸ªåˆ¶çº¦æ•ˆç‡çš„å› ç´ ï¼Œè¿™é‡Œèƒ½å¦è¯·è€å¸ˆå¸®å¿™è§£ç­”ä¸‹ï¼Œæˆ–æ˜¯æŒ‡æ˜ä¸‹å“ªé‡Œæœ‰è¿™æ–¹é¢ææ–™ï¼Œå¯ä»¥ç ”ç©¶ä¸‹ã€‚éº»çƒ¦äº†å•Šï¼","like_count":0,"discussions":[{"author":{"id":1785940,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/rWMGIQG1z13nekorr9I4PY1w7rlskssf949IQ24SvIewpM7mmZoH2QEZ2aKHu5tkmicGQ7KTGrN9vFYhrDsdp9w/132","nickname":"Geek_9dbcb4","note":"","ucode":"BB92D5E844A743","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":249917,"discussion_content":"flutteræ˜¯æœ‰UIå±€éƒ¨åˆ·æ–°çš„åŠŸèƒ½ï¼Œæ¥æé«˜æ¸²æŸ“æ•ˆç‡ã€‚iOSçš„æ¸²æŸ“ï¼Œæ²¡æœ‰è¿™æ–¹é¢çš„ä¼˜åŒ–å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587974703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}