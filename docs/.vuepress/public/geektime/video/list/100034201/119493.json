{"id":119493,"title":"06 | 使用ZooKeeper实现Master-Worker协同","content":"<p><strong>课件和Demo地址</strong></p><p><a href=\"https://gitee.com/geektime-geekbang/geekbang-zk-course\">https://gitee.com/geektime-geekbang/geekbang-zk-course</a></p>","comments":[{"had_liked":false,"id":137447,"user_name":"常山虎将","can_delete":false,"product_type":"c3","uid":1485915,"ip_address":"","ucode":"493A699B359200","user_header":"https://static001.geekbang.org/account/avatar/00/16/ac/5b/826e21a2.jpg","comment_is_top":false,"comment_ctime":1569743536,"is_pvip":false,"replies":[{"id":52905,"content":"是的。ZooKeeper的watch是one-time trigger。一个Watch收一次通知。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1569822427,"ip_address":"","comment_id":137447,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师，ls -w &#47;workers 是不是只监听第一个事件？我发现如果输入一次 ls -w &#47;workers，而worker变动多次，只有第一次master监听到了。视频中你每次变化都输入了ls -w &#47;workers，所以每次都监听到了。。","like_count":6,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469097,"discussion_content":"是的。ZooKeeper的watch是one-time trigger。一个Watch收一次通知。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569822427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127179,"user_name":"飞翔","can_delete":false,"product_type":"c3","uid":1068571,"ip_address":"","ucode":"65AF6AF292DAD6","user_header":"https://static001.geekbang.org/account/avatar/00/10/4e/1b/f4b786b9.jpg","comment_is_top":false,"comment_ctime":1566580147,"is_pvip":false,"replies":[{"id":47102,"content":"ls列出一个znode下的子znode列表，stat是返回一个znode的stat信息。\n\n-w选项是用来一个设置一个watch，适用于ls和stat。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1566646877,"ip_address":"","comment_id":127179,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"ls -w 和 stat -w 有啥区别啊 老师","like_count":2,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464359,"discussion_content":"ls列出一个znode下的子znode列表，stat是返回一个znode的stat信息。\n\n-w选项是用来一个设置一个watch，适用于ls和stat。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566646877,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139107,"user_name":"心流","can_delete":false,"product_type":"c3","uid":1052340,"ip_address":"","ucode":"11FA8F1C54521A","user_header":"https://static001.geekbang.org/account/avatar/00/10/0e/b4/6ecadbd3.jpg","comment_is_top":false,"comment_ctime":1570546731,"is_pvip":false,"replies":[{"id":54756,"content":"生产环境一般至少3个节点。2个节点的话，1个节点宕了，工作的节点个数就不是2的大多数了，没有容错能力。3个节点的话，1个节点宕了，集群还可以正常工作。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1571232832,"ip_address":"","comment_id":139107,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师，zookeeper，不是先要至少搭3台集群吗？","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469794,"discussion_content":"生产环境一般至少3个节点。2个节点的话，1个节点宕了，工作的节点个数就不是2的大多数了，没有容错能力。3个节点的话，1个节点宕了，集群还可以正常工作。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571232832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1052340,"avatar":"https://static001.geekbang.org/account/avatar/00/10/0e/b4/6ecadbd3.jpg","nickname":"心流","note":"","ucode":"11FA8F1C54521A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35070,"discussion_content":"老师上课就用两个结点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571234623,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":136611,"user_name":"Curry30 👆","can_delete":false,"product_type":"c3","uid":1631837,"ip_address":"","ucode":"49D7F870A90771","user_header":"https://static001.geekbang.org/account/avatar/00/18/e6/5d/ca625751.jpg","comment_is_top":false,"comment_ctime":1569481826,"is_pvip":false,"replies":[{"id":52469,"content":"在ZooKeeper上面创建&#47;master这个znode，如果&#47;master这个znode已经存在，这个创建就会失败。只有一个节点创建&#47;master节点成功了，它才可以确认自已成了master。因为master1节点先做的创建，所以它的创建成功了，它就成了master。因为master2后做的创建，它的创建就会失败，它就知道自己没能成为master。\n\n 多个节点必须遵循先成功创建&#47;master这个znode，再监听&#47;workers下的worker才能能保证master的唯一性。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1569512941,"ip_address":"","comment_id":136611,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师，您好，有两个疑问:\n1. 为什么第一个创建的znode:m1会成为master？这跟创建顺序有关系吗？\n2.我创建了两个znode来监听&#47;workers下的worker，两个znode都收到了监听消息，这跟您说的唯一master监听worker相悖了？","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":468724,"discussion_content":"在ZooKeeper上面创建/master这个znode，如果/master这个znode已经存在，这个创建就会失败。只有一个节点创建/master节点成功了，它才可以确认自已成了master。因为master1节点先做的创建，所以它的创建成功了，它就成了master。因为master2后做的创建，它的创建就会失败，它就知道自己没能成为master。\n\n 多个节点必须遵循先成功创建/master这个znode，再监听/workers下的worker才能能保证master的唯一性。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569512941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133311,"user_name":"_你说了不算","can_delete":false,"product_type":"c3","uid":1185159,"ip_address":"","ucode":"212F890565FE5C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/87/d22d8c3e.jpg","comment_is_top":false,"comment_ctime":1568511641,"is_pvip":false,"replies":[{"id":52039,"content":"Master-Worker协同服务的要求：\n\n- 系统中有最多有一个master。\n- 系统中可以有多个worker。\n\nmaster监控系统中的worker，通常为worker分配任务。\n\n这个后面我会专门再讲一下。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1569249015,"ip_address":"","comment_id":133311,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"workers 和master建立关系的过程没看懂啊","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467343,"discussion_content":"Master-Worker协同服务的要求：\n\n- 系统中有最多有一个master。\n- 系统中可以有多个worker。\n\nmaster监控系统中的worker，通常为worker分配任务。\n\n这个后面我会专门再讲一下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569249015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131633,"user_name":"陈敬丰","can_delete":false,"product_type":"c3","uid":1363378,"ip_address":"","ucode":"AB0BBD97A0B1E3","user_header":"https://static001.geekbang.org/account/avatar/00/14/cd/b2/f95f7c91.jpg","comment_is_top":false,"comment_ctime":1567828204,"is_pvip":false,"replies":[{"id":50527,"content":"提前使用&quot;create &#47;workers&quot;创建&#47;workers这个znode。不能带&quot;-e&quot;这个选项。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1568044564,"ip_address":"","comment_id":131633,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"老师好，我自己做实验遇到下面问题，&#47;workers这个znode是怎么来的，你创建完&#47;master之后直接就ls -w &#47;workers   不太懂，我自己创建了一个&#47;workers，create -e &#47;workers &quot;m2:2223&quot;，后面在创建create -e &#47;workers&#47;w1 &quot;w1:2224&quot;时报错Ephemerals cannot have children: &#47;workers&#47;w1，这是什么问题啊","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466549,"discussion_content":"提前使用&amp;quot;create /workers&amp;quot;创建/workers这个znode。不能带&amp;quot;-e&amp;quot;这个选项。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568044564,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1029473,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/61/9802a552.jpg","nickname":"ican_只会0到9","note":"","ucode":"9EE33C42EE519D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8252,"discussion_content":"临时的znode，是不能创建子znode，你创建一个的新的workers 就可以了：create  /workers ，然后再创建w1","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567854873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130355,"user_name":"绅士","can_delete":false,"product_type":"c3","uid":1583859,"ip_address":"","ucode":"5B58E5A958F489","user_header":"https://static001.geekbang.org/account/avatar/00/18/2a/f3/b9607a15.jpg","comment_is_top":false,"comment_ctime":1567431159,"is_pvip":false,"replies":[{"id":48959,"content":"1. &quot;create -e &#47;workers&#47;w1&quot;是创建&#47;workers&#47;w1这个znode。&#47;workers也是一个znode，这里用作目录。\n2. master监视&#47;workers下面代表worker的znode的变化。常见的场景是master在收到worker的变化通知时，进行任务分配，例如把任务分给新worker。例如Kafka的controller就承担master的角色，broker就是worker。controller会把partition分配给新启动的broker。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1567526096,"ip_address":"","comment_id":130355,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"疑问点，希望老师解答：\n1,create -e &#47;workers&#47;w1里面的workers是一个命令吗，还是说这个workers是一个节点名称，按照我的理解，这个workers是表示w1是workers的一个命令？\n2,老师创建的master和这两个workers有联系吗？如果有，是通过什么联系的？","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465918,"discussion_content":"1. &amp;quot;create -e /workers/w1&amp;quot;是创建/workers/w1这个znode。/workers也是一个znode，这里用作目录。\n2. master监视/workers下面代表worker的znode的变化。常见的场景是master在收到worker的变化通知时，进行任务分配，例如把任务分给新worker。例如Kafka的controller就承担master的角色，broker就是worker。controller会把partition分配给新启动的broker。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567526096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1583859,"avatar":"https://static001.geekbang.org/account/avatar/00/18/2a/f3/b9607a15.jpg","nickname":"绅士","note":"","ucode":"5B58E5A958F489","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7662,"discussion_content":"懂了，谢谢老师的解答","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567604246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127128,"user_name":"刘天庆","can_delete":false,"product_type":"c3","uid":1595095,"ip_address":"","ucode":"3EFD7C0D293B1D","user_header":"https://static001.geekbang.org/account/avatar/00/18/56/d7/c4b098a8.jpg","comment_is_top":false,"comment_ctime":1566564421,"is_pvip":false,"replies":[{"id":47103,"content":"workers使用&quot;create &#47;workers&quot;创建","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1566647342,"ip_address":"","comment_id":127128,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"workers节点是怎么来的   需要自己创建吗 ","like_count":1,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464332,"discussion_content":"workers使用&amp;quot;create /workers&amp;quot;创建","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566647342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1595095,"avatar":"https://static001.geekbang.org/account/avatar/00/18/56/d7/c4b098a8.jpg","nickname":"刘天庆","note":"","ucode":"3EFD7C0D293B1D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6263,"discussion_content":"那workers是要自己创建吗  因为在视频里 我没有看到老师有创见workers","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566815410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204060,"user_name":"友志","can_delete":false,"product_type":"c3","uid":1310564,"ip_address":"","ucode":"913344CDF17620","user_header":"https://static001.geekbang.org/account/avatar/00/13/ff/64/76b0dac8.jpg","comment_is_top":false,"comment_ctime":1586326872,"is_pvip":false,"replies":[{"id":79210,"content":"我猜您是使用持久化znode注册的服务。如果您希望在应用停止后，应用自动被注销，可以使用临时性znode。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1588558192,"ip_address":"","comment_id":204060,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"一个应用注册zk后，后面把这个应用给停了，在zk控制台上还能查到这个ip注册服务，请问是什么原因？","like_count":0,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491062,"discussion_content":"我猜您是使用持久化znode注册的服务。如果您希望在应用停止后，应用自动被注销，可以使用临时性znode。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588558192,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068432,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/90/25b6f544.jpg","nickname":"马文龙","note":"","ucode":"679B0F0AB402C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370833,"discussion_content":"我也想知道这个问题答案，不知道后面的课程里有解释吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619542384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1310564,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ff/64/76b0dac8.jpg","nickname":"友志","note":"","ucode":"913344CDF17620","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257326,"discussion_content":"使用持久化znode，应用停了上面还能查得到，这种情况下还会对外提供服务吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588559327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197242,"user_name":"乐朦","can_delete":false,"product_type":"c3","uid":1938739,"ip_address":"","ucode":"C5A666DB0521E0","user_header":"https://static001.geekbang.org/account/avatar/00/1d/95/33/7d4b08ec.jpg","comment_is_top":false,"comment_ctime":1585364836,"is_pvip":false,"replies":[{"id":75925,"content":"大家的问题也帮助我更深刻的理解ZooKeeper。谢谢大家。","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1586144621,"ip_address":"","comment_id":197242,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100034201,"comment_content":"看大家的留言和老师的回复，竟然有一种复习的感觉。","like_count":0,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489481,"discussion_content":"大家的问题也帮助我更深刻的理解ZooKeeper。谢谢大家。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586144621,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":184473,"user_name":"大大大熊myeh","can_delete":false,"product_type":"c3","uid":1139413,"ip_address":"","ucode":"4832C2E7CEB151","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/d5/1f5c5ab6.jpg","comment_is_top":false,"comment_ctime":1583324532,"is_pvip":false,"replies":[{"id":75917,"content":"您的ZooKeeper版本是不是太旧了？和我用的一样吗？","user_name":"作者回复","user_name_real":"Geek_215586","uid":1591870,"ctime":1586143249,"ip_address":"","comment_id":184473,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"老师，我创建master临时节点是成功了，在第二个zkCli中输入stat -w &#47;master命令去监听master节点的时候，报错了”Command failed: java.lang.IllegalArgumentException: Path must start with &#47; character“这是为啥？","like_count":0,"discussions":[{"author":{"id":1591870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJyDiaaDJrwRsdUia9HxA8EuWaDVLr4E1gMG5y2ZTxV7BNUhdNABCmH3GMZTzib796X5duibiaeuRmNXeg/132","nickname":"Geek_215586","note":"","ucode":"5916AC9CC5FBE2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486026,"discussion_content":"您的ZooKeeper版本是不是太旧了？和我用的一样吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586143249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1068432,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4d/90/25b6f544.jpg","nickname":"马文龙","note":"","ucode":"679B0F0AB402C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370835,"discussion_content":"这个确实是版本问题，我刚开始使用3.4的版本就是这样，3.4应该是ls /,但是3.4的版本如何递归看列表就不知道了，请大家赐教","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619542490,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":381287,"user_name":"长期规划","can_delete":false,"product_type":"c3","uid":1019332,"ip_address":"北京","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1694999023,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"学习了，HBase必须依赖ZK，用于选主，RegionServer监控和故障转移等。另外HDFS如果想实视HA高可用，也可以使用了ZK","like_count":0},{"had_liked":false,"id":354880,"user_name":"_patrick","can_delete":false,"product_type":"c3","uid":2220763,"ip_address":"浙江","ucode":"B24C6EEBCABB94","user_header":"https://static001.geekbang.org/account/avatar/00/21/e2/db/97c6f756.jpg","comment_is_top":false,"comment_ctime":1660842955,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"利用这个watch机制 可以实现微服务集群的注册中心啊","like_count":0},{"had_liked":false,"id":338674,"user_name":"Geek_809504","can_delete":false,"product_type":"c3","uid":2617948,"ip_address":"","ucode":"49300424CA5FE6","user_header":"","comment_is_top":false,"comment_ctime":1647655905,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"看了这两节的命令演示，《Zookeeper分布式过程协同技术详解》上说了这只是zkCli命令演示的教学目的，不能用于应用实现，对吧","like_count":0},{"had_liked":false,"id":290434,"user_name":"马文龙","can_delete":false,"product_type":"c3","uid":1068432,"ip_address":"","ucode":"679B0F0AB402C7","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/90/25b6f544.jpg","comment_is_top":false,"comment_ctime":1619542717,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"老师，WatchedEvent state:SyncConnected type:NodeChildrenChanged path:&#47;workers；这个回复不算是节点的变动通知吗，如果算的话，那使用了stat -w &#47;workers后，每次变化都有这个信息，用这个当作节点变化通知可以吗，还有如果是这样的话，之前说的one-time-trigger感觉就不对了啊","like_count":0},{"had_liked":false,"id":224012,"user_name":"Fis.","can_delete":false,"product_type":"c3","uid":1711895,"ip_address":"","ucode":"6168F5A759C069","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1f/17/f2a69e62.jpg","comment_is_top":false,"comment_ctime":1591255894,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100034201,"comment_content":"老师，请问为什么必须要通过zk来管理master和workers的状态呢，相比于他们自己之间互相通信、监听来更新状态有什么优势呀？","like_count":0}]}