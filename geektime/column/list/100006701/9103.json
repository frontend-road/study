{"id":9103,"title":"ç¬¬17è®² | ä¸€ä¸ªçº¿ç¨‹ä¸¤æ¬¡è°ƒç”¨start()æ–¹æ³•ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ","content":"<p>ä»Šå¤©æˆ‘ä»¬æ¥æ·±å…¥èŠèŠçº¿ç¨‹ï¼Œç›¸ä¿¡å¤§å®¶å¯¹äºçº¿ç¨‹è¿™ä¸ªæ¦‚å¿µéƒ½ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯Javaå¹¶å‘çš„åŸºç¡€å…ƒç´ ï¼Œç†è§£ã€æ“çºµã€è¯Šæ–­çº¿ç¨‹æ˜¯Javaå·¥ç¨‹å¸ˆçš„å¿…ä¿®è¯¾ï¼Œä½†æ˜¯ä½ çœŸçš„æŒæ¡çº¿ç¨‹äº†å—ï¼Ÿ</p>\n<p>ä»Šå¤©æˆ‘è¦é—®ä½ çš„é—®é¢˜æ˜¯ï¼Œ<span class=\"orange\">ä¸€ä¸ªçº¿ç¨‹ä¸¤æ¬¡è°ƒç”¨start()æ–¹æ³•ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿè°ˆè°ˆçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€è½¬ç§»ã€‚</span></p>\n<!-- [[[read_end]]] -->\n<h2>å…¸å‹å›ç­”</h2>\n<p>Javaçš„çº¿ç¨‹æ˜¯ä¸å…è®¸å¯åŠ¨ä¸¤æ¬¡çš„ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨å¿…ç„¶ä¼šæŠ›å‡ºIllegalThreadStateExceptionï¼Œè¿™æ˜¯ä¸€ç§è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¤šæ¬¡è°ƒç”¨startè¢«è®¤ä¸ºæ˜¯ç¼–ç¨‹é”™è¯¯ã€‚</p>\n<p>å…³äºçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒçŠ¶æ€ï¼Œåœ¨Java 5ä»¥åï¼Œçº¿ç¨‹çŠ¶æ€è¢«æ˜ç¡®å®šä¹‰åœ¨å…¶å…¬å…±å†…éƒ¨æšä¸¾ç±»å‹java.lang.Thread.Stateä¸­ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>\n<ul>\n<li>\n<p>æ–°å»ºï¼ˆNEWï¼‰ï¼Œè¡¨ç¤ºçº¿ç¨‹è¢«åˆ›å»ºå‡ºæ¥è¿˜æ²¡çœŸæ­£å¯åŠ¨çš„çŠ¶æ€ï¼Œå¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸ªJavaå†…éƒ¨çŠ¶æ€ã€‚</p>\n</li>\n<li>\n<p>å°±ç»ªï¼ˆRUNNABLEï¼‰ï¼Œè¡¨ç¤ºè¯¥çº¿ç¨‹å·²ç»åœ¨JVMä¸­æ‰§è¡Œï¼Œå½“ç„¶ç”±äºæ‰§è¡Œéœ€è¦è®¡ç®—èµ„æºï¼Œå®ƒå¯èƒ½æ˜¯æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯èƒ½è¿˜åœ¨ç­‰å¾…ç³»ç»Ÿåˆ†é…ç»™å®ƒCPUç‰‡æ®µï¼Œåœ¨å°±ç»ªé˜Ÿåˆ—é‡Œé¢æ’é˜Ÿã€‚</p>\n</li>\n<li>\n<p>åœ¨å…¶ä»–ä¸€äº›åˆ†æä¸­ï¼Œä¼šé¢å¤–åŒºåˆ†ä¸€ç§çŠ¶æ€RUNNINGï¼Œä½†æ˜¯ä»Java APIçš„è§’åº¦ï¼Œå¹¶ä¸èƒ½è¡¨ç¤ºå‡ºæ¥ã€‚</p>\n</li>\n<li>\n<p>é˜»å¡ï¼ˆBLOCKEDï¼‰ï¼Œè¿™ä¸ªçŠ¶æ€å’Œæˆ‘ä»¬å‰é¢ä¸¤è®²ä»‹ç»çš„åŒæ­¥éå¸¸ç›¸å…³ï¼Œé˜»å¡è¡¨ç¤ºçº¿ç¨‹åœ¨ç­‰å¾…Monitor lockã€‚æ¯”å¦‚ï¼Œçº¿ç¨‹è¯•å›¾é€šè¿‡synchronizedå»è·å–æŸä¸ªé”ï¼Œä½†æ˜¯å…¶ä»–çº¿ç¨‹å·²ç»ç‹¬å äº†ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹å°±ä¼šå¤„äºé˜»å¡çŠ¶æ€ã€‚</p>\n</li>\n<li>\n<p>ç­‰å¾…ï¼ˆWAITINGï¼‰ï¼Œè¡¨ç¤ºæ­£åœ¨ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡‡å–æŸäº›æ“ä½œã€‚ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯ç±»ä¼¼ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œå‘ç°ä»»åŠ¡æ¡ä»¶å°šæœªæ»¡è¶³ï¼Œå°±è®©å½“å‰æ¶ˆè´¹è€…çº¿ç¨‹ç­‰å¾…ï¼ˆwaitï¼‰ï¼Œå¦å¤–çš„ç”Ÿäº§è€…çº¿ç¨‹å»å‡†å¤‡ä»»åŠ¡æ•°æ®ï¼Œç„¶åé€šè¿‡ç±»ä¼¼notifyç­‰åŠ¨ä½œï¼Œé€šçŸ¥æ¶ˆè´¹çº¿ç¨‹å¯ä»¥ç»§ç»­å·¥ä½œäº†ã€‚Thread.join()ä¹Ÿä¼šä»¤çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</p>\n</li>\n<li>\n<p>è®¡æ—¶ç­‰å¾…ï¼ˆTIMED_WAITï¼‰ï¼Œå…¶è¿›å…¥æ¡ä»¶å’Œç­‰å¾…çŠ¶æ€ç±»ä¼¼ï¼Œä½†æ˜¯è°ƒç”¨çš„æ˜¯å­˜åœ¨è¶…æ—¶æ¡ä»¶çš„æ–¹æ³•ï¼Œæ¯”å¦‚waitæˆ–joinç­‰æ–¹æ³•çš„æŒ‡å®šè¶…æ—¶ç‰ˆæœ¬ï¼Œå¦‚ä¸‹é¢ç¤ºä¾‹ï¼š</p>\n</li>\n</ul>\n<pre><code>public final native void wait(long timeout) throws InterruptedException;\n</code></pre>\n<ul>\n<li>ç»ˆæ­¢ï¼ˆTERMINATEDï¼‰ï¼Œä¸ç®¡æ˜¯æ„å¤–é€€å‡ºè¿˜æ˜¯æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œçº¿ç¨‹å·²ç»å®Œæˆä½¿å‘½ï¼Œç»ˆæ­¢è¿è¡Œï¼Œä¹Ÿæœ‰äººæŠŠè¿™ä¸ªçŠ¶æ€å«ä½œæ­»äº¡ã€‚</li>\n</ul>\n<p>åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨start()æ–¹æ³•çš„æ—¶å€™ï¼Œçº¿ç¨‹å¯èƒ½å¤„äºç»ˆæ­¢æˆ–è€…å…¶ä»–ï¼ˆéNEWï¼‰çŠ¶æ€ï¼Œä½†æ˜¯ä¸è®ºå¦‚ä½•ï¼Œéƒ½æ˜¯ä¸å¯ä»¥å†æ¬¡å¯åŠ¨çš„ã€‚</p>\n<h2>è€ƒç‚¹åˆ†æ</h2>\n<p>ä»Šå¤©çš„é—®é¢˜å¯ä»¥ç®—æ˜¯ä¸ªå¸¸è§çš„é¢è¯•çƒ­èº«é¢˜ç›®ï¼Œå‰é¢çš„ç»™å‡ºçš„å…¸å‹å›ç­”ï¼Œç®—æ˜¯å¯¹åŸºæœ¬çŠ¶æ€å’Œç®€å•æµè½¬çš„ä¸€ä¸ªä»‹ç»ï¼Œå¦‚æœè§‰å¾—è¿˜ä¸å¤Ÿç›´è§‚ï¼Œæˆ‘åœ¨ä¸‹é¢åˆ†æä¼šå¯¹æ¯”ä¸€ä¸ªçŠ¶æ€å›¾è¿›è¡Œä»‹ç»ã€‚æ€»çš„æ¥è¯´ï¼Œç†è§£çº¿ç¨‹å¯¹äºæˆ‘ä»¬æ—¥å¸¸å¼€å‘æˆ–è€…è¯Šæ–­åˆ†æï¼Œéƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„åŸºç¡€ã€‚</p>\n<p>é¢è¯•å®˜å¯èƒ½ä¼šä»¥æ­¤ä¸ºå¥‘æœºï¼Œä»å„ç§ä¸åŒè§’åº¦è€ƒå¯Ÿä½ å¯¹çº¿ç¨‹çš„æŒæ¡ï¼š</p>\n<ul>\n<li>\n<p>ç›¸å¯¹ç†è®ºä¸€äº›çš„é¢è¯•å®˜å¯ä»¥ä¼šé—®ä½ çº¿ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆä»¥åŠJavaåº•å±‚å®ç°æ–¹å¼ã€‚</p>\n</li>\n<li>\n<p>çº¿ç¨‹çŠ¶æ€çš„åˆ‡æ¢ï¼Œä»¥åŠå’Œé”ç­‰å¹¶å‘å·¥å…·ç±»çš„äº’åŠ¨ã€‚</p>\n</li>\n<li>\n<p>çº¿ç¨‹ç¼–ç¨‹æ—¶å®¹æ˜“è¸©çš„å‘ä¸å»ºè®®ç­‰ã€‚</p>\n</li>\n</ul>\n<p>å¯ä»¥çœ‹å‡ºï¼Œä»…ä»…æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œå°±æœ‰éå¸¸å¤šçš„å†…å®¹éœ€è¦æŒæ¡ã€‚æˆ‘ä»¬é€‰æ‹©é‡ç‚¹å†…å®¹ï¼Œå¼€å§‹è¿›å…¥è¯¦ç»†åˆ†æã€‚</p>\n<h2>çŸ¥è¯†æ‰©å±•</h2>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ•´ä½“çœ‹ä¸€ä¸‹çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>ä»æ“ä½œç³»ç»Ÿçš„è§’åº¦ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºï¼Œçº¿ç¨‹æ˜¯ç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œä½œä¸ºä»»åŠ¡çš„çœŸæ­£è¿ä½œè€…ï¼Œæœ‰è‡ªå·±çš„æ ˆï¼ˆStackï¼‰ã€å¯„å­˜å™¨ï¼ˆRegisterï¼‰ã€æœ¬åœ°å­˜å‚¨ï¼ˆThread Localï¼‰ç­‰ï¼Œä½†æ˜¯ä¼šå’Œè¿›ç¨‹å†…å…¶ä»–çº¿ç¨‹å…±äº«æ–‡ä»¶æè¿°ç¬¦ã€è™šæ‹Ÿåœ°å€ç©ºé—´ç­‰ã€‚</p>\n<p>åœ¨å…·ä½“å®ç°ä¸­ï¼Œçº¿ç¨‹è¿˜åˆ†ä¸ºå†…æ ¸çº¿ç¨‹ã€ç”¨æˆ·çº¿ç¨‹ï¼ŒJavaçš„çº¿ç¨‹å®ç°å…¶å®æ˜¯ä¸è™šæ‹Ÿæœºç›¸å…³çš„ã€‚å¯¹äºæˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„Sun/Oracle JDKï¼Œå…¶çº¿ç¨‹ä¹Ÿç»å†äº†ä¸€ä¸ªæ¼”è¿›è¿‡ç¨‹ï¼ŒåŸºæœ¬ä¸Šåœ¨Java 1.2ä¹‹åï¼ŒJDKå·²ç»æŠ›å¼ƒäº†æ‰€è°“çš„<a href=\"https://en.wikipedia.org/wiki/Green_threads\">Green Thread</a>ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·è°ƒåº¦çš„çº¿ç¨‹ï¼Œç°åœ¨çš„æ¨¡å‹æ˜¯ä¸€å¯¹ä¸€æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹ã€‚</p>\n<p>å¦‚æœæˆ‘ä»¬æ¥çœ‹Threadçš„æºç ï¼Œä½ ä¼šå‘ç°å…¶åŸºæœ¬æ“ä½œé€»è¾‘å¤§éƒ½æ˜¯ä»¥JNIå½¢å¼è°ƒç”¨çš„æœ¬åœ°ä»£ç ã€‚</p>\n<pre><code>private native void start0();\nprivate native void setPriority0(int newPriority);\nprivate native void interrupt0();\n</code></pre>\n<p>è¿™ç§å®ç°æœ‰åˆ©æœ‰å¼Šï¼Œæ€»ä½“ä¸Šæ¥è¯´ï¼ŒJavaè¯­è¨€å¾—ç›Šäºç²¾ç»†ç²’åº¦çš„çº¿ç¨‹å’Œç›¸å…³çš„å¹¶å‘æ“ä½œï¼Œå…¶æ„å»ºé«˜æ‰©å±•æ€§çš„å¤§å‹åº”ç”¨çš„èƒ½åŠ›å·²ç»æ¯‹åº¸ç½®ç–‘ã€‚ä½†æ˜¯ï¼Œå…¶å¤æ‚æ€§ä¹Ÿæé«˜äº†å¹¶å‘ç¼–ç¨‹çš„é—¨æ§›ï¼Œè¿‘å‡ å¹´çš„Goè¯­è¨€ç­‰æä¾›äº†åç¨‹ï¼ˆ<a href=\"https://en.wikipedia.org/wiki/Coroutine\">coroutine</a>ï¼‰ï¼Œå¤§å¤§æé«˜äº†æ„å»ºå¹¶å‘åº”ç”¨çš„æ•ˆç‡ã€‚äºæ­¤åŒæ—¶ï¼ŒJavaä¹Ÿåœ¨<a href=\"http://openjdk.java.net/projects/loom/\">Loom</a>é¡¹ç›®ä¸­ï¼Œå­•è‚²æ–°çš„ç±»ä¼¼è½»é‡çº§ç”¨æˆ·çº¿ç¨‹ï¼ˆFiberï¼‰ç­‰æœºåˆ¶ï¼Œä¹Ÿè®¸åœ¨ä¸ä¹…çš„å°†æ¥å°±å¯ä»¥åœ¨æ–°ç‰ˆJDKä¸­ä½¿ç”¨åˆ°å®ƒã€‚</p>\n<p>ä¸‹é¢ï¼Œæˆ‘æ¥åˆ†æä¸‹çº¿ç¨‹çš„åŸºæœ¬æ“ä½œã€‚å¦‚ä½•åˆ›å»ºçº¿ç¨‹æƒ³å¿…ä½ å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>\n<pre><code>Runnable task = () -&gt; {System.out.println(&quot;Hello World!&quot;);};\nThread myThread = new Thread(task);\nmyThread.start();\nmyThread.join();\n</code></pre>\n<p>æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰©å±•Threadç±»ï¼Œç„¶åå®ä¾‹åŒ–ã€‚ä½†åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘é€‰å–äº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯å®ç°ä¸€ä¸ªRunnableï¼Œå°†ä»£ç é€»æ”¾åœ¨Runnableä¸­ï¼Œç„¶åæ„å»ºThreadå¹¶å¯åŠ¨ï¼ˆstartï¼‰ï¼Œç­‰å¾…ç»“æŸï¼ˆjoinï¼‰ã€‚</p>\n<p>Runnableçš„å¥½å¤„æ˜¯ï¼Œä¸ä¼šå—Javaä¸æ”¯æŒç±»å¤šç»§æ‰¿çš„é™åˆ¶ï¼Œé‡ç”¨ä»£ç å®ç°ï¼Œå½“æˆ‘ä»¬éœ€è¦é‡å¤æ‰§è¡Œç›¸åº”é€»è¾‘æ—¶ä¼˜ç‚¹æ˜æ˜¾ã€‚è€Œä¸”ï¼Œä¹Ÿèƒ½æ›´å¥½çš„ä¸ç°ä»£Javaå¹¶å‘åº“ä¸­çš„Executorä¹‹ç±»æ¡†æ¶ç»“åˆä½¿ç”¨ï¼Œæ¯”å¦‚å°†ä¸Šé¢startå’Œjoinçš„é€»è¾‘å®Œå…¨å†™æˆä¸‹é¢çš„ç»“æ„ï¼š</p>\n<pre><code>Future future = Executors.newFixedThreadPool(1)\n.submit(task)\n.get();\n</code></pre>\n<p>è¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ“å¿ƒçº¿ç¨‹çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä¹Ÿèƒ½åˆ©ç”¨Futureç­‰æœºåˆ¶æ›´å¥½åœ°å¤„ç†æ‰§è¡Œç»“æœã€‚çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸé€šå¸¸å’Œä¸šåŠ¡ä¹‹é—´æ²¡æœ‰æœ¬è´¨è”ç³»ï¼Œæ··æ·†å®ç°éœ€æ±‚å’Œä¸šåŠ¡éœ€æ±‚ï¼Œå°±ä¼šé™ä½å¼€å‘çš„æ•ˆç‡ã€‚</p>\n<p>ä»çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€å¼€å§‹å±•å¼€ï¼Œé‚£ä¹ˆåœ¨Javaç¼–ç¨‹ä¸­ï¼Œæœ‰å“ªäº›å› ç´ å¯èƒ½å½±å“çº¿ç¨‹çš„çŠ¶æ€å‘¢ï¼Ÿä¸»è¦æœ‰ï¼š</p>\n<ul>\n<li>\n<p>çº¿ç¨‹è‡ªèº«çš„æ–¹æ³•ï¼Œé™¤äº†startï¼Œè¿˜æœ‰å¤šä¸ªjoinæ–¹æ³•ï¼Œç­‰å¾…çº¿ç¨‹ç»“æŸï¼›yieldæ˜¯å‘Šè¯‰è°ƒåº¦å™¨ï¼Œä¸»åŠ¨è®©å‡ºCPUï¼›å¦å¤–ï¼Œå°±æ˜¯ä¸€äº›å·²ç»è¢«æ ‡è®°ä¸ºè¿‡æ—¶çš„resumeã€stopã€suspendä¹‹ç±»ï¼Œæ®æˆ‘æ‰€çŸ¥ï¼Œåœ¨JDKæœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œdestory/stopæ–¹æ³•å°†è¢«ç›´æ¥ç§»é™¤ã€‚</p>\n</li>\n<li>\n<p>åŸºç±»Objectæä¾›äº†ä¸€äº›åŸºç¡€çš„wait/notify/notifyAllæ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬æŒæœ‰æŸä¸ªå¯¹è±¡çš„Monitoré”ï¼Œè°ƒç”¨waitä¼šè®©å½“å‰çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹notifyæˆ–è€…notifyAllã€‚æ‰€ä»¥ï¼Œæœ¬è´¨ä¸Šæ˜¯æä¾›äº†Monitorçš„è·å–å’Œé‡Šæ”¾çš„èƒ½åŠ›ï¼Œæ˜¯åŸºæœ¬çš„çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚</p>\n</li>\n<li>\n<p>å¹¶å‘ç±»åº“ä¸­çš„å·¥å…·ï¼Œæ¯”å¦‚CountDownLatch.await()ä¼šè®©å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°latchè¢«åŸºæ•°ä¸º0ï¼Œè¿™å¯ä»¥çœ‹ä½œæ˜¯çº¿ç¨‹é—´é€šä¿¡çš„Signalã€‚</p>\n</li>\n</ul>\n<p>æˆ‘è¿™é‡Œç”»äº†ä¸€ä¸ªçŠ¶æ€å’Œæ–¹æ³•ä¹‹é—´çš„å¯¹åº”å›¾ï¼š</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/31/dc/3169b7ca899afeb0359f132fb77c29dc.png?wh=892*467\" alt=\"\" /></p>\n<p>Threadå’ŒObjectçš„æ–¹æ³•ï¼Œå¬èµ·æ¥ç®€å•ï¼Œä½†æ˜¯å®é™…åº”ç”¨ä¸­è¢«è¯æ˜éå¸¸æ™¦æ¶©ã€æ˜“é”™ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆJavaåæ¥åˆå¼•å…¥äº†å¹¶å‘åŒ…ã€‚æ€»çš„æ¥è¯´ï¼Œæœ‰äº†å¹¶å‘åŒ…ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å·²ç»ä¸å†éœ€è¦å»è°ƒç”¨wait/notifyä¹‹ç±»çš„æ–¹æ³•äº†ã€‚</p>\n<p>å‰é¢è°ˆäº†ä¸å°‘ç†è®ºï¼Œä¸‹é¢è°ˆè°ˆçº¿ç¨‹APIä½¿ç”¨ï¼Œæˆ‘ä¼šä¾§é‡äºå¹³æ—¶å·¥ä½œå­¦ä¹ ä¸­ï¼Œå®¹æ˜“è¢«å¿½ç•¥çš„ä¸€äº›æ–¹é¢ã€‚</p>\n<p>å…ˆæ¥çœ‹çœ‹å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰ï¼Œæœ‰çš„æ—¶å€™åº”ç”¨ä¸­éœ€è¦ä¸€ä¸ªé•¿æœŸé©»ç•™çš„æœåŠ¡ç¨‹åºï¼Œä½†æ˜¯ä¸å¸Œæœ›å…¶å½±å“åº”ç”¨é€€å‡ºï¼Œå°±å¯ä»¥å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¦‚æœJVMå‘ç°åªæœ‰å®ˆæŠ¤çº¿ç¨‹å­˜åœ¨æ—¶ï¼Œå°†ç»“æŸè¿›ç¨‹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢ä»£ç æ®µã€‚<strong>æ³¨æ„ï¼Œå¿…é¡»åœ¨çº¿ç¨‹å¯åŠ¨ä¹‹å‰è®¾ç½®ã€‚</strong></p>\n<pre><code>Thread daemonThread = new Thread();\ndaemonThread.setDaemon(true);\ndaemonThread.start();\n</code></pre>\n<p>å†æ¥çœ‹çœ‹<a href=\"https://en.wikipedia.org/wiki/Spurious_wakeup\">Spurious wakeup</a>ã€‚å°¤å…¶æ˜¯åœ¨å¤šæ ¸CPUçš„ç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹ç­‰å¾…å­˜åœ¨ä¸€ç§å¯èƒ½ï¼Œå°±æ˜¯åœ¨æ²¡æœ‰ä»»ä½•çº¿ç¨‹å¹¿æ’­æˆ–è€…å‘å‡ºä¿¡å·çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹å°±è¢«å”¤é†’ï¼Œå¦‚æœå¤„ç†ä¸å½“å°±å¯èƒ½å‡ºç°è¯¡å¼‚çš„å¹¶å‘é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç­‰å¾…æ¡ä»¶è¿‡ç¨‹ä¸­ï¼Œå»ºè®®é‡‡ç”¨ä¸‹é¢æ¨¡å¼æ¥ä¹¦å†™ã€‚</p>\n<pre><code>// æ¨è\nwhile ( isCondition()) {\nwaitForAConfition(...);\n}\n\n// ä¸æ¨èï¼Œå¯èƒ½å¼•å…¥bug\nif ( isCondition()) {\nwaitForAConfition(...);\n}\n\n</code></pre>\n<p>Thread.onSpinWait()ï¼Œè¿™æ˜¯Java 9ä¸­å¼•å…¥çš„ç‰¹æ€§ã€‚æˆ‘åœ¨<a href=\"http://time.geekbang.org/column/article/9042\">ä¸“æ ç¬¬16è®²</a>ç»™ä½ ç•™çš„æ€è€ƒé¢˜ä¸­ï¼Œæåˆ°â€œè‡ªæ—‹é”â€ï¼ˆspin-wait, busy-waitingï¼‰ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºå…¶ä¸ç®—æ˜¯ä¸€ç§é”ï¼Œè€Œæ˜¯ä¸€ç§é’ˆå¯¹çŸ­æœŸç­‰å¾…çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚â€œonSpinWait()â€æ²¡æœ‰ä»»ä½•è¡Œä¸ºä¸Šçš„ä¿è¯ï¼Œè€Œæ˜¯å¯¹JVMçš„ä¸€ä¸ªæš—ç¤ºï¼ŒJVMå¯èƒ½ä¼šåˆ©ç”¨CPUçš„pauseæŒ‡ä»¤è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œæ€§èƒ½ç‰¹åˆ«æ•æ„Ÿçš„åº”ç”¨å¯ä»¥å…³æ³¨ã€‚</p>\n<p>å†æœ‰å°±æ˜¯æ…ç”¨<a href=\"https://docs.oracle.com/javase/9/docs/api/java/lang/ThreadLocal.html\">ThreadLocal</a>ï¼Œè¿™æ˜¯Javaæä¾›çš„ä¸€ç§ä¿å­˜çº¿ç¨‹ç§æœ‰ä¿¡æ¯çš„æœºåˆ¶ï¼Œå› ä¸ºå…¶åœ¨æ•´ä¸ªçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸå†…æœ‰æ•ˆï¼Œæ‰€ä»¥å¯ä»¥æ–¹ä¾¿åœ°åœ¨ä¸€ä¸ªçº¿ç¨‹å…³è”çš„ä¸åŒä¸šåŠ¡æ¨¡å—ä¹‹é—´ä¼ é€’ä¿¡æ¯ï¼Œæ¯”å¦‚äº‹åŠ¡IDã€Cookieç­‰ä¸Šä¸‹æ–‡ç›¸å…³ä¿¡æ¯ã€‚</p>\n<p>å®ƒçš„å®ç°ç»“æ„ï¼Œå¯ä»¥å‚è€ƒ<a href=\"http://hg.openjdk.java.net/jdk/jdk/file/ee8524126794/src/java.base/share/classes/java/lang/ThreadLocal.java\">æºç </a>ï¼Œæ•°æ®å­˜å‚¨äºçº¿ç¨‹ç›¸å…³çš„ThreadLocalMapï¼Œå…¶å†…éƒ¨æ¡ç›®æ˜¯å¼±å¼•ç”¨ï¼Œå¦‚ä¸‹é¢ç‰‡æ®µã€‚</p>\n<pre><code>static class ThreadLocalMap {\n\tstatic class Entry extends WeakReference&lt;ThreadLocal&lt;?&gt;&gt; {\n Â Â Â \t/** The value associated with this ThreadLocal. */\n Â Â Â \tObject value;\n Â Â Â \tEntry(ThreadLocal&lt;?&gt; k, Object v) {\n Â Â Â Â Â Â Â \tsuper(k);\n    \tvalue = v;\n Â Â Â \t}\n Â Â Â Â Â }\n Â Â // â€¦\n}\n</code></pre>\n<p>å½“Keyä¸ºnullæ—¶ï¼Œè¯¥æ¡ç›®å°±å˜æˆâ€œåºŸå¼ƒæ¡ç›®â€ï¼Œç›¸å…³â€œvalueâ€çš„å›æ”¶ï¼Œå¾€å¾€ä¾èµ–äºå‡ ä¸ªå…³é”®ç‚¹ï¼Œå³setã€removeã€rehashã€‚</p>\n<p>ä¸‹é¢æ˜¯setçš„ç¤ºä¾‹ï¼Œæˆ‘è¿›è¡Œäº†ç²¾ç®€å’Œæ³¨é‡Šï¼š</p>\n<pre><code>private void set(ThreadLocal&lt;?&gt; key, Object value) {\n\tEntry[] tab = table;\n\tint len = tab.length;\n\tint i = key.threadLocalHashCode &amp; (len-1);\n\n\tfor (Entry e = tab[i];; â€¦) {\n Â Â Â \t//â€¦\n Â Â Â \tif (k == null) {\n// æ›¿æ¢åºŸå¼ƒæ¡ç›®\n Â Â Â Â Â Â Â \treplaceStaleEntry(key, value, i);\n Â Â Â Â Â Â Â \treturn;\n Â Â Â \t}\n Â Â Â Â Â Â }\n\n\ttab[i] = new Entry(key, value);\n\tint sz = ++size;\n// Â æ‰«æå¹¶æ¸…ç†å‘ç°çš„åºŸå¼ƒæ¡ç›®ï¼Œå¹¶æ£€æŸ¥å®¹é‡æ˜¯å¦è¶…é™\n\tif (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)\n Â Â Â \trehash();// æ¸…ç†åºŸå¼ƒæ¡ç›®ï¼Œå¦‚æœä»ç„¶è¶…é™ï¼Œåˆ™æ‰©å®¹ï¼ˆåŠ å€ï¼‰\n}  \n</code></pre>\n<p>å…·ä½“çš„æ¸…ç†é€»è¾‘æ˜¯å®ç°åœ¨cleanSomeSlotså’ŒexpungeStaleEntryä¹‹ä¸­ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥è‡ªè¡Œé˜…è¯»ã€‚</p>\n<p>ç»“åˆ<a href=\"http://time.geekbang.org/column/article/6970\">ä¸“æ ç¬¬4è®²</a>ä»‹ç»çš„å¼•ç”¨ç±»å‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªç‰¹åˆ«çš„åœ°æ–¹ï¼Œé€šå¸¸å¼±å¼•ç”¨éƒ½ä¼šå’Œå¼•ç”¨é˜Ÿåˆ—é…åˆæ¸…ç†æœºåˆ¶ä½¿ç”¨ï¼Œä½†æ˜¯ThreadLocalæ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚</p>\n<p>è¿™æ„å‘³ç€ï¼ŒåºŸå¼ƒé¡¹ç›®çš„å›æ”¶<strong>ä¾èµ–äºæ˜¾å¼åœ°è§¦å‘ï¼Œå¦åˆ™å°±è¦ç­‰å¾…çº¿ç¨‹ç»“æŸ</strong>ï¼Œè¿›è€Œå›æ”¶ç›¸åº”ThreadLocalMapï¼è¿™å°±æ˜¯å¾ˆå¤šOOMçš„æ¥æºï¼Œæ‰€ä»¥é€šå¸¸éƒ½ä¼šå»ºè®®ï¼Œåº”ç”¨ä¸€å®šè¦è‡ªå·±è´Ÿè´£removeï¼Œå¹¶ä¸”ä¸è¦å’Œçº¿ç¨‹æ± é…åˆï¼Œå› ä¸ºworkerçº¿ç¨‹å¾€å¾€æ˜¯ä¸ä¼šé€€å‡ºçš„ã€‚</p>\n<p>ä»Šå¤©ï¼Œæˆ‘ä»‹ç»äº†çº¿ç¨‹åŸºç¡€ï¼Œåˆ†æäº†ç”Ÿå‘½å‘¨æœŸä¸­çš„çŠ¶æ€å’Œå„ç§æ–¹æ³•ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œè¿™ä¹Ÿæœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°ç†è§£synchronizedå’Œé”çš„å½±å“ï¼Œå¹¶ä»‹ç»äº†ä¸€äº›éœ€è¦æ³¨æ„çš„æ“ä½œï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>\n<h2>ä¸€è¯¾ä¸€ç»ƒ</h2>\n<p>å…³äºä»Šå¤©æˆ‘ä»¬è®¨è®ºçš„é¢˜ç›®ä½ åšåˆ°å¿ƒä¸­æœ‰æ•°äº†å—ï¼Ÿä»Šå¤©æˆ‘å‡†å¤‡äº†ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜ï¼Œå†™ä¸€ä¸ªæœ€ç®€å•çš„æ‰“å°HelloWorldçš„ç¨‹åºï¼Œè¯´è¯´çœ‹ï¼Œè¿è¡Œè¿™ä¸ªåº”ç”¨ï¼ŒJavaè‡³å°‘ä¼šåˆ›å»ºå‡ ä¸ªçº¿ç¨‹å‘¢ï¼Ÿç„¶åæ€è€ƒä¸€ä¸‹ï¼Œå¦‚ä½•æ˜ç¡®éªŒè¯ä½ çš„ç»“è®ºï¼ŒçœŸå®æƒ…å†µå¾ˆå¯èƒ½ä»¤ä½ å¤§è·Œçœ¼é•œå“¦ã€‚</p>\n<p>è¯·ä½ åœ¨ç•™è¨€åŒºå†™å†™ä½ å¯¹è¿™ä¸ªé—®é¢˜çš„æ€è€ƒï¼Œæˆ‘ä¼šé€‰å‡ºç»è¿‡è®¤çœŸæ€è€ƒçš„ç•™è¨€ï¼Œé€ç»™ä½ ä¸€ä»½å­¦ä¹ å¥–åŠ±ç¤¼åˆ¸ï¼Œæ¬¢è¿ä½ ä¸æˆ‘ä¸€èµ·è®¨è®ºã€‚</p>\n<p>ä½ çš„æœ‹å‹æ˜¯ä¸æ˜¯ä¹Ÿåœ¨å‡†å¤‡é¢è¯•å‘¢ï¼Ÿä½ å¯ä»¥â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„é¢˜ç›®åˆ†äº«ç»™å¥½å‹ï¼Œæˆ–è®¸ä½ èƒ½å¸®åˆ°ä»–ã€‚</p>\n<p></p>\n","comments":[{"had_liked":false,"id":12667,"user_name":"é£åŠ¨é™æ³‰","can_delete":false,"product_type":"c1","uid":1113190,"ip_address":"","ucode":"34DEF4FF06A491","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/66/d7f7ad77.jpg","comment_is_top":false,"comment_ctime":1528949274,"is_pvip":false,"replies":[{"id":"4212","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990836,"ip_address":"","comment_id":12667,"utype":1}],"discussion_count":6,"race_medal":0,"score":"491155221018","product_id":100006701,"comment_content":"ä¸€è¯¾ä¸€ç»ƒ:<br>ä½¿ç”¨äº†ä¸¤ç§æ–¹å¼è·å–å½“å‰ç¨‹åºçš„çº¿ç¨‹æ•°ã€‚<br>1ã€ä½¿ç”¨çº¿ç¨‹ç®¡ç†å™¨MXBean<br>2ã€ç›´æ¥é€šè¿‡çº¿ç¨‹ç»„çš„activeCount<br>ç¬¬äºŒç§éœ€è¦æ³¨æ„ä¸æ–­å‘ä¸Šæ‰¾çˆ¶çº¿ç¨‹ç»„ï¼Œå¦åˆ™åªèƒ½è·å–å½“å‰çº¿ç¨‹ç»„ï¼Œç»“æœæ˜¯1<br><br>ç»“è®º:<br>ä½¿ç”¨ä»¥ä¸Šä¸¤ç§æ–¹å¼è·å–çš„çº¿ç¨‹æ€»æ•°éƒ½æ˜¯5ä¸ªã€‚<br>main<br>Attach Listener<br>Signal Dispatcher<br>Finalizer<br>Reference Handler<br><br>æ­¤å¤–ï¼Œå¦‚æœä½¿ç”¨çš„IDEæ˜¯IDEA ç›´æ¥è¿è¡Œä¼šå¤šä¸€ä¸ªMonitor Ctrl-breakçº¿ç¨‹ï¼Œè¿™ä¸ªæ˜¯IDEçš„åŸå› ã€‚debugæ¨¡å¼ä¸‹ä¸ä¼šæœ‰è¿™ä¸ªçº¿ç¨‹ã€‚","like_count":113,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419361,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990836,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2346885,"avatar":"https://static001.geekbang.org/account/avatar/00/23/cf/85/01d477d1.jpg","nickname":"é™ˆå®‡","note":"","ucode":"11CE4F953072C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548516,"discussion_content":"public static void main(String[] args) {\n        System.out.println(&#34;Hello World&#34;);\n        ThreadMXBean threadMXBean = ManagementFactory.getThreadMXBean();\n        long[] threadIds = threadMXBean.getAllThreadIds();\n        ThreadInfo[] threadInfos = threadMXBean.getThreadInfo(threadIds);\n        for (ThreadInfo threadInfo : threadInfos) {\n            System.out.println(threadInfo.getThreadId()+&#34;: &#34;+threadInfo.getThreadName());\n        }\n    ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1643246390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2346885,"avatar":"https://static001.geekbang.org/account/avatar/00/23/cf/85/01d477d1.jpg","nickname":"é™ˆå®‡","note":"","ucode":"11CE4F953072C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548515,"discussion_content":"Hello World\n4: Signal Dispatcher\n3: Finalizer\n2: Reference Handler\n1: main\nä¸ºå•¥æˆ‘è¿™åªæœ‰å››ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643246322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384801,"discussion_content":"&#34;main@1&#34; prio=5 tid=0x1 nid=NA runnable\n  java.lang.Thread.State: RUNNABLE\n\t  \n&#34;Finalizer@666&#34; daemon prio=8 tid=0x3 nid=NA waiting\n  java.lang.Thread.State: WAITING\n\t  at java.lang.Object.wait(Object.java:-1)\n\t  at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144)\n\t  at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165)\n\t  at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)\n\n&#34;Reference Handler@667&#34; daemon prio=10 tid=0x2 nid=NA waiting\n  java.lang.Thread.State: WAITING\n\t  at java.lang.Object.wait(Object.java:-1)\n\t  at java.lang.Object.wait(Object.java:502)\n\t  at java.lang.ref.Reference.tryHandlePending(Reference.java:191)\n\t  at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)\n\n&#34;Attach Listener@664&#34; daemon prio=5 tid=0x5 nid=NA runnable\n  java.lang.Thread.State: RUNNABLE\n\n&#34;Signal Dispatcher@665&#34; daemon prio=9 tid=0x4 nid=NA runnable\n  java.lang.Thread.State: RUNNABLE\n\nåˆšåˆšå¥½5ä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626758031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":155612,"discussion_content":"è¿™æ˜¯æ€ä¹ˆåˆ†æå‡ºæ¥çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580269106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1125281,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2b/a1/d40cc39d.jpg","nickname":"ç…œåŸéªç‰¹","note":"","ucode":"F4939490CF38FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":207830,"discussion_content":"idea debugå¯åŠ¨ï¼Œæ‰“æ–­ç‚¹ï¼ŒFramsä¸‹æ‹‰å¯ä»¥çœ‹åˆ°ï¼Œå®Œæ•´çš„5ä¸ªçº¿ç¨‹","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1584516926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":155612,"ip_address":""},"score":207830,"extra":""}]}]},{"had_liked":false,"id":12662,"user_name":"å°æ–‡åŒå­¦","can_delete":false,"product_type":"c1","uid":1001893,"ip_address":"","ucode":"48F2AEB989C12A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","comment_is_top":false,"comment_ctime":1528948597,"is_pvip":false,"replies":[{"id":"4211","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990796,"ip_address":"","comment_id":12662,"utype":1}],"discussion_count":5,"race_medal":0,"score":"336536397685","product_id":100006701,"comment_content":"åšäº†ä¸€ä¸ªteståˆ†æè€å¸ˆçš„é—®é¢˜ï¼Œè§‚å¯Ÿåˆ°çš„æƒ…å†µå¦‚ä¸‹ï¼š<br>JVM å¯åŠ¨ Hello Worldçš„çº¿ç¨‹åˆ†æ<br>ç¯å¢ƒï¼š<br>macOS + jdk8<br>æ£€æµ‹è·å¾—<br>Thread[Reference Handler,10,system]<br>Thread[Finalizer,8,system]<br>Thread[main,5,main]<br>Thread[Signal Dispatcher,9,system]<br>Hello World!<br>å…¶ä¸­ï¼š<br>Reference Handlerï¼šå¤„ç†å¼•ç”¨å¯¹è±¡æœ¬èº«çš„åƒåœ¾å›æ”¶<br>Finalizerï¼šå¤„ç†ç”¨æˆ·çš„Finalizeræ–¹æ³•<br>Signal Dispatcherï¼šå¤–éƒ¨jvmå‘½ä»¤çš„è½¬å‘å™¨<br><br>åœ¨jdk6ç¯å¢ƒä¸­<br>è¿˜æœ‰ä¸€ä¸ªAttach Listenerçš„çº¿ç¨‹<br>æ˜¯è´Ÿè´£æ¥æ”¶å¤–éƒ¨å‘½ä»¤çš„ï¼Œå¦‚jmapã€jstack<br><br>","like_count":79,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419359,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":155613,"discussion_content":"è¿™æ˜¯æ€ä¹ˆåˆ†æå‡ºæ¥çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580269111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":156424,"discussion_content":"æˆ‘ç•™è¨€å¾ˆä¹…äº†ï¼Œä¸“æ æ–‡ç« åº”è¯¥æœ‰æ­¥éª¤ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1580361823,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":155613,"ip_address":""},"score":156424,"extra":""},{"author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":180366,"discussion_content":"ä¸çŸ¥ä½ å¾®ä¿¡å¤šå°‘ï¼Ÿäº¤æµä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582293037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":156424,"ip_address":""},"score":180366,"extra":""},{"author":{"id":1001893,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg","nickname":"å°æ–‡åŒå­¦","note":"","ucode":"48F2AEB989C12A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1583833,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/E3XKbwTv6WTssolgqZjZCkiazHgl2IdBYfwVfAcB7Ff3krsIQeBIBFQLQE1Kw91LFbl3lic2EzgdfNiciaYDlJlELA/132","nickname":"rike","note":"","ucode":"920AAD0BD9245C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":200824,"discussion_content":"wenkangqiang ä¸€èµ·äº¤æµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583726749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":180366,"ip_address":""},"score":200824,"extra":""}]}]},{"had_liked":false,"id":12626,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1063734,"ip_address":"","ucode":"EA31201A7C5AE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg","comment_is_top":false,"comment_ctime":1528937424,"is_pvip":false,"replies":[{"id":"4207","content":"å‰é¢æ˜¯ç¿»è¯‘çªœäº†ï¼Œå·²ç»ä¿®æ­£ï¼›åé¢å¤§å®¶ç”¨äº†å¾ˆå¤šæ–¹æ³•ï¼ŒåŸºæœ¬éƒ½å¯ä»¥ï¼Œä¸»è¦ç›®çš„æ˜¯ç»“åˆå‰é¢çš„ä»‹ç»åŠ æ·±ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990422,"ip_address":"","comment_id":12626,"utype":1}],"discussion_count":1,"race_medal":0,"score":"96018217936","product_id":100006701,"comment_content":"â€œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªç‰¹åˆ«çš„åœ°æ–¹ï¼Œé€šå¸¸å¹»è±¡å¼•ç”¨éƒ½ä¼šå’Œå¼•ç”¨é˜Ÿåˆ—é…åˆæ¸…ç†æœºåˆ¶ä½¿ç”¨ï¼Œä½†æ˜¯ ThreadLocal æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚â€<br> è€å¸ˆï¼ŒEntryç»§æ‰¿çš„æ˜¯WeakReferenceï¼Œè¿™ä¸ªæ˜¯å¼±å¼•ç”¨å§ã€‚<br> main:<br>        System.out.println(&quot;hello world&quot;);<br>        ThreadGroup group = Thread.currentThread().getThreadGroup();<br>        ThreadGroup topGroup = group;<br>        while (group != null) {<br>            topGroup = group;<br>            group = group.getParent();<br>        }<br>        int nowThreads = topGroup.activeCount();<br>        Thread[] lstThreads = new Thread[nowThreads];<br>        topGroup.enumerate(lstThreads);<br>        for (int i = 0; i &lt; nowThreads; i++) {<br>            System.out.println(&quot;çº¿ç¨‹numberï¼š&quot; + i + &quot; = &quot; + lstThreads[i].getName());<br>        }<br>out:<br>çº¿ç¨‹numberï¼š0 = Reference Handler &#47;&#47; è®¡ç®—å¯¹è±¡æ˜¯å¦å¯è¾¾ï¼Ÿ<br>çº¿ç¨‹numberï¼š1 = Finalizer &#47;&#47; å›æ”¶å¯¹è±¡æ—¶è§¦å‘çš„finalizeæ–¹æ³•ï¼Ÿ<br>çº¿ç¨‹numberï¼š2 = Signal Dispatcher &#47;&#47; çº¿ç¨‹è°ƒåº¦å‘˜<br>çº¿ç¨‹numberï¼š3 = main<br>çº¿ç¨‹numberï¼š4 = Monitor Ctrl-Break &#47;&#47; ç›‘æ§å™¨ï¼Œé”ç›¸å…³","like_count":22,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419334,"discussion_content":"å‰é¢æ˜¯ç¿»è¯‘çªœäº†ï¼Œå·²ç»ä¿®æ­£ï¼›åé¢å¤§å®¶ç”¨äº†å¾ˆå¤šæ–¹æ³•ï¼ŒåŸºæœ¬éƒ½å¯ä»¥ï¼Œä¸»è¦ç›®çš„æ˜¯ç»“åˆå‰é¢çš„ä»‹ç»åŠ æ·±ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12576,"user_name":"çˆ±æŠ˜è…¾çš„è€æ–‘é¸ ","can_delete":false,"product_type":"c1","uid":1121408,"ip_address":"","ucode":"1DDAFA037FB03D","user_header":"https://static001.geekbang.org/account/avatar/00/11/1c/80/2bc29ca9.jpg","comment_is_top":false,"comment_ctime":1528933310,"is_pvip":true,"replies":[{"id":"4218","content":"å—¯ï¼Œçº¿ç¨‹æ± ä¸€èˆ¬ä¸å»ºè®®å’Œthread localé…åˆ...","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528991096,"ip_address":"","comment_id":12576,"utype":1}],"discussion_count":2,"race_medal":0,"score":"96018213822","product_id":100006701,"comment_content":"theadlocalé‡Œé¢çš„å€¼å¦‚æœæ˜¯çº¿ç¨‹æ± çš„çº¿ç¨‹é‡Œé¢è®¾ç½®çš„ï¼Œå½“ä»»åŠ¡å®Œæˆï¼Œçº¿ç¨‹å½’è¿˜çº¿ç¨‹æ± æ—¶ï¼Œè¿™ä¸ªthreadlocalé‡Œé¢çš„å€¼æ˜¯ä¸æ˜¯ä¸ä¼šè¢«å›æ”¶ï¼Ÿ","like_count":22,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419302,"discussion_content":"å—¯ï¼Œçº¿ç¨‹æ± ä¸€èˆ¬ä¸å»ºè®®å’Œthread localé…åˆ...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528991096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297630,"avatar":"https://static001.geekbang.org/account/avatar/00/13/cc/de/e28c01e1.jpg","nickname":"å‰‘å…«","note":"","ucode":"0A09F41DB8A4E7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400677,"discussion_content":"ä¸€èˆ¬è‡ªå·±åœ¨çº¿ç¨‹æ‰§è¡Œå®Œæ¸…ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633361808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":15279,"user_name":"é»„å¯èˆª","can_delete":false,"product_type":"c1","uid":1161541,"ip_address":"","ucode":"E070738CC7B287","user_header":"https://static001.geekbang.org/account/avatar/00/11/b9/45/c3d6fd51.jpg","comment_is_top":false,"comment_ctime":1531068494,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"65955577934","product_id":100006701,"comment_content":"æ¨è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘æœ‰ä¸ªç–‘é—®:<br><br>æ–‡ç« æœ€åè¯´&quot;å¼±å¼•ç”¨éƒ½ä¼šå’Œå¼•ç”¨é˜Ÿåˆ—é…åˆæ¸…ç†å·¥ä½œï¼Œä½†æ˜¯Threadlocalæ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚è¿™æ„å‘³ç€ï¼ŒåºŸå¼ƒé¡¹ç›®çš„å›æ”¶ä¾èµ–æ˜¾ç¤ºåœ°è§¦å‘ï¼Œå¦åˆ™å°±è¦ç­‰å¾…çº¿ç¨‹çš„ç»“æŸ&quot;  ã€‚<br><br>æˆ‘çš„ç–‘é—®ï¼šæ—¢ç„¶æ²¡æœ‰åˆ©ç”¨å¼•ç”¨é˜Ÿåˆ—æ¥å®ç°è‡ªåŠ¨æ¸…é™¤ï¼Œé‚£TheadLocalMapå†…éƒ¨çš„Entryç»§æ‰¿WeakReferenceæœ‰ä½•ç”¨æ„ï¼Ÿèƒ½èµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Ÿ<br>","like_count":16,"discussions":[{"author":{"id":1320592,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","nickname":"gwl","note":"","ucode":"24F334E9AC0313","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":281630,"discussion_content":"å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç«  \nhttps://www.cnblogs.com/aspirant/p/8991010.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591780880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1481811,"avatar":"https://static001.geekbang.org/account/avatar/00/16/9c/53/ade0afb0.jpg","nickname":"ub8","note":"","ucode":"0D937C3EAEB781","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":96966,"discussion_content":"è¿™å—æˆ‘ä¹Ÿä¸æ˜ç™½+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577101688,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12647,"user_name":"tyson","can_delete":false,"product_type":"c1","uid":1110943,"ip_address":"","ucode":"E88F630B53C743","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/9f/3e4e8d46.jpg","comment_is_top":false,"comment_ctime":1528941486,"is_pvip":true,"replies":[{"id":"4206","content":"ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990232,"ip_address":"","comment_id":12647,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44478614446","product_id":100006701,"comment_content":"1ã€ç«™åœ¨åº”ç”¨ç¨‹åºæ–¹é¢ï¼Œåªåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ã€‚<br>2ã€ç«™åœ¨jvmæ–¹é¢ï¼Œè‚¯å®šè¿˜æœ‰gcç­‰å…¶ä½™çº¿ç¨‹ã€‚<br><br>æ€»ç»“ï¼š<br>1ã€çº¿ç¨‹æ˜¯ç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒï¼Œåº”è¯¥æ˜¯è¿›ç¨‹å§ã€‚çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ä¼šæ‰“å¼€æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚<br>2ã€ resumeã€stopã€suspendç­‰å·²ç»è¢«åºŸå¼ƒäº†<br>3ã€çº¿ç¨‹çš„ç­‰å¾…å’Œå”¤é†’ï¼Œå»ºè®®ä½¿ç”¨reentrantlockçš„condition wait&#47;notifyæ–¹æ³•<br>4ã€å¯ä»¥ä½¿ç”¨çº¿ç¨‹çš„joinæ–¹æ³•ã€countdownlatchã€cyclicbarrierã€futureç­‰è¿›è¡Œçº¿ç¨‹çš„ç­‰å¾…","like_count":11,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419349,"discussion_content":"ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12811,"user_name":"æäºŒæœ¨","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1529049389,"is_pvip":true,"replies":[{"id":"4305","content":"åŒæ„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529169625,"ip_address":"","comment_id":12811,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35888787757","product_id":100006701,"comment_content":"ç°åœ¨è§‰å¾—è¸©å‘æ˜¯ä¸€ç§å¾ˆå¥½å­¦ä¹ æ–¹æ³•","like_count":9,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419419,"discussion_content":"åŒæ„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529169625,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213022,"user_name":"æé£","can_delete":false,"product_type":"c1","uid":1555180,"ip_address":"","ucode":"930458850AA05B","user_header":"https://static001.geekbang.org/account/avatar/00/17/ba/ec/2b1c6afc.jpg","comment_is_top":false,"comment_ctime":1588263019,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27358066795","product_id":100006701,"comment_content":"&#47;&#47;çº¿ç¨‹æ•°éªŒè¯<br>        System.out.println(&quot;hello world&quot;);<br>        int activeCount = Thread.activeCount();<br>        System.out.println(&quot;çº¿ç¨‹æ´»è·ƒæ•°ï¼š&quot; + activeCount);<br>        Set&lt;Thread&gt; threadSet = Thread.getAllStackTraces().keySet();<br>        for (Thread thread : threadSet) {<br>            System.out.println(&quot;çº¿ç¨‹&quot; + thread.getId() + &quot;:&quot; + thread.getName());<br>        }<br><br>è¾“å‡ºç»“æœï¼š<br>hello world<br>çº¿ç¨‹æ´»è·ƒæ•°ï¼š1<br>çº¿ç¨‹3:Finalizer<br>çº¿ç¨‹4:Signal Dispatcher<br>çº¿ç¨‹2:Reference Handler<br>çº¿ç¨‹5:Attach Listener<br>çº¿ç¨‹1:main","like_count":7},{"had_liked":false,"id":55380,"user_name":"è‹¦è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1055334,"ip_address":"","ucode":"726024A9A9CF44","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","comment_is_top":false,"comment_ctime":1546153785,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27315957561","product_id":100006701,"comment_content":"è¾¹çœ‹è€å¸ˆçš„è®²è¯¾ è¾¹åæ€å·¥ç¨‹ä»£ç  ","like_count":7},{"had_liked":false,"id":12623,"user_name":"é”","can_delete":false,"product_type":"c1","uid":1110915,"ip_address":"","ucode":"A245BA96C9471F","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/83/e2612d81.jpg","comment_is_top":false,"comment_ctime":1528937124,"is_pvip":false,"replies":[{"id":"4215","content":"å—¯ï¼Œä¸ºäº†ç”Ÿå‘½å‘¨æœŸçš„éœ€æ±‚","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990916,"ip_address":"","comment_id":12623,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23003773604","product_id":100006701,"comment_content":"é€šå¸¸å¼±å¼•ç”¨éƒ½ä¼šå’Œå¼•ç”¨é˜Ÿåˆ—é…åˆæ¸…ç†æœºåˆ¶ä½¿ç”¨ï¼Œä½†æ˜¯ ThreadLocal æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚<br><br>è¿™æ„å‘³ç€ï¼ŒåºŸå¼ƒé¡¹ç›®çš„å›æ”¶ä¾èµ–äºæ˜¾å¼åœ°è§¦å‘ï¼Œå¦åˆ™å°±è¦ç­‰å¾…çº¿ç¨‹ç»“æŸï¼Œè¿›è€Œå›æ”¶ç›¸åº” ThreadLocalMapï¼è¿™å°±æ˜¯å¾ˆå¤š OOM çš„æ¥æº<br><br>è¿™ä¸ªå¹³æ—¶è¿˜çœŸæ²¡æ³¨æ„","like_count":5,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419331,"discussion_content":"å—¯ï¼Œä¸ºäº†ç”Ÿå‘½å‘¨æœŸçš„éœ€æ±‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990916,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":42799,"user_name":"æ‰¬ï½","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1543048087,"is_pvip":false,"replies":[{"id":"15381","content":"èŒƒèŒƒè°ˆæœ‰ç‚¹æ™¦æ¶©ï¼Œå¯ä»¥ä»çº¿ç¨‹è¿›å…¥ã€é€€å‡ºblocked&#47;waitingçš„æ–¹æ³•&#47;æ¡ä»¶æ¥å¯¹æ¯”","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1543155696,"ip_address":"","comment_id":42799,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18722917271","product_id":100006701,"comment_content":"ç­‰å¾…ä¸é˜»å¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢","like_count":4,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430202,"discussion_content":"èŒƒèŒƒè°ˆæœ‰ç‚¹æ™¦æ¶©ï¼Œå¯ä»¥ä»çº¿ç¨‹è¿›å…¥ã€é€€å‡ºblocked/waitingçš„æ–¹æ³•/æ¡ä»¶æ¥å¯¹æ¯”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1543155696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"æ—…é€”","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291272,"discussion_content":"é˜»å¡ä¼šè¢«åˆ«äººå”¤é†’,ç­‰å¾…æ˜¯è‡ªå·±é†’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594750016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1266987,"avatar":"https://static001.geekbang.org/account/avatar/00/13/55/2b/b7927cc4.jpg","nickname":"è¶…è¶…è¶…è¶…è¶…å¸…è€¶ğŸŒ´","note":"","ucode":"931E23DC0ACB04","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"æ—…é€”","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553684,"discussion_content":"ä¹Ÿä¸æ˜¯å§ï¼Œé˜»å¡æ˜¯é”æ‹¿ä¸åˆ°ï¼Œä¸å¾—ä¸ç­‰ï¼Œç­‰å¾…æ˜¯ä»£ç é‡Œé¢è‡ªå·±waitäº†ï¼Œå¯èƒ½æ˜¯è§‰å¾—å…¶ä»–æ¡ä»¶ä¸æ»¡è¶³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646029380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":291272,"ip_address":""},"score":553684,"extra":""}]}]},{"had_liked":false,"id":12998,"user_name":"TonyEasy","can_delete":false,"product_type":"c1","uid":1115635,"ip_address":"","ucode":"CB455BA8915B64","user_header":"https://static001.geekbang.org/account/avatar/00/11/05/f3/4dd9e515.jpg","comment_is_top":false,"comment_ctime":1529276620,"is_pvip":false,"replies":[{"id":"4428","content":"ä¸æ˜¯çš„ï¼Œå·¥ä½œçº¿ç¨‹ä¸€èˆ¬ä¸é€€å‡ºçš„ï¼Œå¤ç”¨çš„æ˜¯ç±»ä¼¼runnableè¿™ç§","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529424233,"ip_address":"","comment_id":12998,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18709145804","product_id":100006701,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ç‚¹ç–‘é—®ï¼Œåœ¨çº¿ç¨‹æ± é‡Œå¤ç”¨çº¿ç¨‹æ—¶æ˜¯ä¸æ˜¯å¯¹åŒä¸€ä¸ªçº¿ç¨‹è°ƒç”¨äº†å¤šæ¬¡.start()æ–¹æ³•å‘¢ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419493,"discussion_content":"ä¸æ˜¯çš„ï¼Œå·¥ä½œçº¿ç¨‹ä¸€èˆ¬ä¸é€€å‡ºçš„ï¼Œå¤ç”¨çš„æ˜¯ç±»ä¼¼runnableè¿™ç§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529424233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12786,"user_name":"mongo","can_delete":false,"product_type":"c1","uid":1113124,"ip_address":"","ucode":"F39FE783793A17","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/24/7d43d807.jpg","comment_is_top":false,"comment_ctime":1529029281,"is_pvip":false,"replies":[{"id":"4306","content":"ä¸‹é¢ç« èŠ‚å°±ä¼šè¦†ç›–è¿™éƒ¨åˆ†ï¼Œæˆ‘è°ˆä¸‹è‡ªå·±çš„æ€è·¯ï¼šå¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆæ˜¯æ²¡æœ‰æœºä¼šåœ¨å·¥ä½œä¸­ï¼Œå…¨é¢ä½¿ç”¨å¹¶å‘çš„é‚£äº›ä¸œè¥¿çš„ï¼Œå°¤å…¶æ˜¯åé¦ˆè¯»è€…ä¸­åˆå­¦è€…ä¸å°‘ï¼›æ‰€ä»¥ï¼Œæˆ‘å»ºè®®æœ‰ä¸ªæ•´ä½“æ€§ä½“ç³»æœ‰ä¸ªäº†è§£ï¼Œåˆ†æ¸…å¤§ä½“éƒ½æœ‰ä»€ä¹ˆï¼›ç„¶åå¯ä»¥é€‰äº›å®è·µåœºæ™¯ï¼Œå»å®ç°ç”¨ä¾‹ä»£ç ã€‚é¢è¯•ä¸­å¤§ä½“ä¹Ÿå°±å¤Ÿäº†ï¼Œæ¯•ç«Ÿé¡¹ç›®ç»éªŒä¸æ˜¯æ•™ç¨‹èƒ½è§£å†³çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529170152,"ip_address":"","comment_id":12786,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18708898465","product_id":100006701,"comment_content":"æ¨è€å¸ˆè¯·æ•™ä½ ï¼Œå…³äºé«˜å¹¶å‘å’Œçº¿ç¨‹æ± ï¼Œæˆ‘åˆšåˆšå…¥é—¨ï¼Œå·¥ä½œä¸­æ²¡æœ‰æ¶‰åŠè¿‡è¿™ä¸€å—ã€‚æˆ‘é˜…è¯»äº†oracle java tutorial high level concurrency ç« èŠ‚ï¼Œé˜…è¯»å¹¶ç²—ç•¥ç†è§£äº†ã€Šå¹¶å‘ç¼–ç¨‹å®è·µã€‹è¿™æœ¬ä¹¦ï¼Œæƒ³è¿›ä¸€æ­¥æ¸…æ™°æˆ‘çš„ç†è§£ï¼Œæˆ‘ç°åœ¨è‹¦äºåœ¨å®è·µç»ƒä¹ æ–¹é¢ä¸çŸ¥é“æ€ä¹ˆè¿›è¡Œã€‚è€å¸ˆæœ‰ä»€ä¹ˆå…·ä½“å¯è¡Œçš„æ€è·¯æŒ‡ç‚¹ä¸€ä¸‹å—ï¼Ÿç•™è¨€åœˆé‡Œæœ‰å¥½å¤šå¤§ç¥ï¼Œåœ¨è¿™é‡ŒåŒæ—¶ä¹Ÿè¯·æ•™å…¶ä»–çš„æœ‹å‹ã€‚è°¢è°¢è€å¸ˆï¼Œè°¢è°¢å¤§å®¶ã€‚","like_count":4,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419408,"discussion_content":"ä¸‹é¢ç« èŠ‚å°±ä¼šè¦†ç›–è¿™éƒ¨åˆ†ï¼Œæˆ‘è°ˆä¸‹è‡ªå·±çš„æ€è·¯ï¼šå¤§éƒ¨åˆ†å·¥ç¨‹å¸ˆæ˜¯æ²¡æœ‰æœºä¼šåœ¨å·¥ä½œä¸­ï¼Œå…¨é¢ä½¿ç”¨å¹¶å‘çš„é‚£äº›ä¸œè¥¿çš„ï¼Œå°¤å…¶æ˜¯åé¦ˆè¯»è€…ä¸­åˆå­¦è€…ä¸å°‘ï¼›æ‰€ä»¥ï¼Œæˆ‘å»ºè®®æœ‰ä¸ªæ•´ä½“æ€§ä½“ç³»æœ‰ä¸ªäº†è§£ï¼Œåˆ†æ¸…å¤§ä½“éƒ½æœ‰ä»€ä¹ˆï¼›ç„¶åå¯ä»¥é€‰äº›å®è·µåœºæ™¯ï¼Œå»å®ç°ç”¨ä¾‹ä»£ç ã€‚é¢è¯•ä¸­å¤§ä½“ä¹Ÿå°±å¤Ÿäº†ï¼Œæ¯•ç«Ÿé¡¹ç›®ç»éªŒä¸æ˜¯æ•™ç¨‹èƒ½è§£å†³çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529170152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207581,"user_name":"æ‰¿é¦™å¢¨å½±","can_delete":false,"product_type":"c1","uid":1023750,"ip_address":"","ucode":"4D6A4D6E1ED29F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/06/287d77dd.jpg","comment_is_top":false,"comment_ctime":1587112431,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10177047023","product_id":100006701,"comment_content":"Java çº¿ç¨‹çŠ¶æ€åˆ‡æ¢çš„å›¾æœ‰é—®é¢˜ï¼ŒRunnable åˆ° Blocked ä¸åŒ…æ‹¬é˜»å¡ IOï¼Œåœ¨ Java å±‚é¢æ˜¯ä¸å…³å¿ƒæ˜¯å¦è°ƒç”¨äº† é˜»å¡API çš„ï¼Œæ­¤æ—¶ä¸ä¼šåˆ‡æ¢çº¿ç¨‹çŠ¶æ€ï¼Œä¾ç„¶ä¿æŒåœ¨ RUNNABLE ä¸­ã€‚","like_count":2},{"had_liked":false,"id":162906,"user_name":"å¤©ç‹","can_delete":false,"product_type":"c1","uid":1239337,"ip_address":"","ucode":"C074B2F9A5F007","user_header":"https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg","comment_is_top":false,"comment_ctime":1576630397,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10166564989","product_id":100006701,"comment_content":"17 ä¸€æ¬¡çº¿ç¨‹å¤šæ¬¡è°ƒç”¨startæ–¹æ³•ä¼šæç¤ºIllegnalThreadStateExceptionï¼Œ1 çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„å‡ ä¸ªçŠ¶æ€ï¼Œåœ¨Java.lang.thread.stateä¸­ï¼Œnewçº¿ç¨‹åˆšåˆ›å»ºè¿˜æ²¡çœŸæ­£å¯åŠ¨çš„çŠ¶æ€ï¼Œrunnable å°±ç»ª è¡¨ç¤ºè¯¥çº¿ç¨‹å·²ç»åœ¨jvmä¸­æ‰§è¡Œï¼Œæ‰§è¡Œéœ€è¦è®¡ç®—èµ„æºï¼Œå¯èƒ½æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯èƒ½æ­£åœ¨ç­‰å¾…cpuåˆ†é…cpuç‰‡æ®µï¼Œåœ¨å°±ç»ªé˜Ÿåˆ—æ’é˜Ÿï¼Œblockedï¼Œé˜»å¡ è¡¨ç¤ºå½“å‰çº¿ç¨‹å¤„äºMonitor lockï¼Œæ¯”å¦‚çº¿ç¨‹è¯•å›¾è·å–æŸä¸ªé”ï¼Œå‘ç°è¢«å…¶ä»–çº¿ç¨‹å äº†ï¼Œå°±ä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œç­‰å¾…waitingï¼Œæ¯”å¦‚ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ¶ˆè´¹è€…æ¡ä»¶æœªæ»¡è¶³ï¼Œè®©å½“å‰æ¶ˆè´¹è€…ç­‰å¾…ï¼Œç”Ÿäº§è€…å»å‡†å¤‡æ•°æ®ï¼Œé€šè¿‡notifyç­‰åŠ¨ä½œï¼Œé€šçŸ¥æ¶ˆè´¹è€…çº¿ç¨‹å¯ä»¥ç»§ç»­å·¥ä½œï¼Œè®¡æ—¶ç­‰å¾…ï¼Œå’Œè¿›å…¥ç­‰å¾…çš„æ¡ä»¶ä¸€æ ·ï¼Œè°ƒç”¨æ–¹æ³•æ˜¯ç­‰å¾…è¶…æ—¶çš„æ–¹æ³•ï¼Œç»ˆæ­¢ terminated ä¸ç®¡æ„å¤–é€€å‡ºè¿˜æ˜¯è‡ªåŠ¨ç»ˆæ­¢ï¼Œçº¿ç¨‹ç»ˆæ­¢è¿è¡Œï¼Œä¹Ÿå«æ­»äº¡ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨startçš„æ—¶å€™ï¼Œçº¿ç¨‹å·²ç»æ­»äº¡æˆ–è€…å¤„äºénewçš„çŠ¶æ€ï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºå¼‚å¸¸ 2 çº¿ç¨‹æ˜¯ä»€ä¹ˆ çº¿ç¨‹æ˜¯çº¿ç¨‹è°ƒåº¦çš„åŸºæœ¬å•å…ƒï¼Œä¸€ä¸ªè¿›åŸåŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œä½œä¸ºä»»åŠ¡çœŸæ­£çš„æ‰§è¡Œè€…ï¼Œæœ‰è‡ªå·±çš„æ ˆï¼Œå¯„å­˜å™¨å’Œæœ¬åœ°å­˜å‚¨ç­‰ï¼Œä½†æ˜¯ä¼šå’Œè¿›åŸä¸­å…¶ä»–çº¿ç¨‹å…±äº«æ–‡ä»¶æè¿°ç¬¦å’Œè™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œçº¿ç¨‹åˆ†ä¸ºå†…æ ¸çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ï¼Œçœ‹Threadçš„æºç ï¼Œä»¥JNIå½¢å¼è°ƒç”¨çš„æœ¬åœ°ä»£ç ï¼Œ3 åˆ›å»ºçº¿ç¨‹ new Thread().start() thread.join()ï¼Œçº¿ç¨‹çš„æ–¹æ³•ï¼Œæœ‰startï¼Œjoinç­‰å¾…çº¿ç¨‹ç»“æŸï¼Œyieldå‘Šè¯‰è°ƒåº¦å®¤ï¼Œä¸»åŠ¨è®©å‡ºCPUï¼ŒåŸºç±»Objectæä¾›äº†ä¸€äº›åŸºç¡€æ–¹æ³•ï¼Œwaitï¼Œnotifyï¼ŒnotifyAllç­‰æ–¹æ³•ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æŒæœ‰Minitoré”ï¼Œä¼šè®©å…¶ä»–çº¿ç¨‹å¤„äºwaitçŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹notifyæˆ–è€…notifyallï¼ŒDaemon Thread å®ˆæŠ¤çº¿ç¨‹ï¼Œé•¿æœŸå­˜åœ¨çš„æœåŠ¡çº¿ç¨‹","like_count":2},{"had_liked":false,"id":12622,"user_name":"é«˜æ°","can_delete":false,"product_type":"c1","uid":1123779,"ip_address":"","ucode":"2DA90479CD6D02","user_header":"https://static001.geekbang.org/account/avatar/00/11/25/c3/6569bd7d.jpg","comment_is_top":false,"comment_ctime":1528937092,"is_pvip":false,"replies":[{"id":"4208","content":"ç¿»è¯‘ä¿®æ­£äº†ï¼Œè°¢è°¢æŒ‡å‡ºï¼›ä½ è¯•è¯•ç”¨æ¯”å¦‚æœ€ç®€å•çš„jstackæŸ¥çœ‹ä¸‹ï¼Œä¸æ­¢è¿™äº›å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990531,"ip_address":"","comment_id":12622,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10118871684","product_id":100006701,"comment_content":"æœ‰å‡ ä¸ªå¼±å¼•ç”¨ï¼Œè™šå¼•ç”¨çš„åœ°æ–¹ï¼ŒéŸ³é¢‘å’Œæ–‡å­—å¯¹ä¸ä¸Šã€‚æŠŠæˆ‘ææ™•äº†ã€‚<br>åº”è¯¥æœ‰2ä¸ªçº¿ç¨‹ï¼Œè¿˜æœ‰jvmçš„gcçº¿ç¨‹ï¼Ÿè¿˜æœ‰ç¬¬ä¸‰ä¸ªçº¿ç¨‹å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419330,"discussion_content":"ç¿»è¯‘ä¿®æ­£äº†ï¼Œè°¢è°¢æŒ‡å‡ºï¼›ä½ è¯•è¯•ç”¨æ¯”å¦‚æœ€ç®€å•çš„jstackæŸ¥çœ‹ä¸‹ï¼Œä¸æ­¢è¿™äº›å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12580,"user_name":"sunlight001","can_delete":false,"product_type":"c1","uid":1126975,"ip_address":"","ucode":"A72C4274D5DE8A","user_header":"https://static001.geekbang.org/account/avatar/00/11/32/3f/fa4ac035.jpg","comment_is_top":false,"comment_ctime":1528934280,"is_pvip":false,"replies":[{"id":"4216","content":"ä¸ç”¨äº†ï¼Œæ˜ç¡®ç§»é™¤æ˜¯å¥½ä¹ æƒ¯","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990958,"ip_address":"","comment_id":12580,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10118868872","product_id":100006701,"comment_content":"threadlocalåœ¨æ”¾å…¥å€¼ä¹‹åï¼Œåœ¨getå‡ºæ¥ä¹‹åï¼Œéœ€è¦åšremoveæ“ä½œï¼Œæˆ‘è¿™ä¹ˆç†è§£å¯¹ä¹ˆï¼Ÿä»¥å‰å†™çš„ç¨‹åºéƒ½æ²¡removeğŸ˜„","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419304,"discussion_content":"ä¸ç”¨äº†ï¼Œæ˜ç¡®ç§»é™¤æ˜¯å¥½ä¹ æƒ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12579,"user_name":"é£ŸæŒ‡å¯çˆ±å¤š","can_delete":false,"product_type":"c1","uid":1045721,"ip_address":"","ucode":"B918E07F55AB9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f4/d9/e572ae4d.jpg","comment_is_top":false,"comment_ctime":1528934205,"is_pvip":true,"replies":[{"id":"4217","content":"å…¶ä»–å°±åŒ…æ‹¬æˆ‘ä»¬å‰é¢ç« èŠ‚è¯´è¿‡çš„finalizerï¼Œå„ç§cleanerç­‰ï¼Œè¿˜æœ‰äº‹ä»¶å¤„ç†ç­‰<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528991061,"ip_address":"","comment_id":12579,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10118868797","product_id":100006701,"comment_content":"æˆ‘äº†è§£ç¡®å®šçº¿ç¨‹æœ‰:ä»»åŠ¡çº¿ç¨‹ï¼ŒMainçº¿ç¨‹ï¼Œåƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œè¿˜æœ‰äº›çº¿ç¨‹æ²¡ç»†å¿ƒå…³æ³¨åå­—å’Œç”¨é€”ï¼Œæƒ­æ„§äº†ã€‚å¯ä»¥åœ¨ä¸šåŠ¡çº¿ç¨‹ä¸­ç­‰å¾…ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œç”¨jstackçœ‹çœ‹å½“å‰jvmçš„çº¿ç¨‹å †æ ˆã€‚","like_count":3,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419303,"discussion_content":"å…¶ä»–å°±åŒ…æ‹¬æˆ‘ä»¬å‰é¢ç« èŠ‚è¯´è¿‡çš„finalizerï¼Œå„ç§cleanerç­‰ï¼Œè¿˜æœ‰äº‹ä»¶å¤„ç†ç­‰\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528991061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12574,"user_name":"Eason","can_delete":false,"product_type":"c1","uid":1018519,"ip_address":"","ucode":"69C0ADAC7C5475","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/97/6c1e90f1.jpg","comment_is_top":false,"comment_ctime":1528933163,"is_pvip":false,"replies":[{"id":"4219","content":"waitå’Œblockedæ˜¯ä¸åŒçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528991160,"ip_address":"","comment_id":12574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10118867755","product_id":100006701,"comment_content":"â€œæ¯”å¦‚ï¼Œçº¿ç¨‹è¯•å›¾é€šè¿‡ synchronized å»è·å–æŸä¸ªé”ï¼Œä½†æ˜¯å…¶ä»–çº¿ç¨‹å·²ç»ç‹¬å äº†ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹å°±ä¼šå¤„äºé˜»å¡çŠ¶æ€â€è¿™ä¸ªä¾‹å­æ¢ä¸€ä¸ªç†è§£ï¼Œæ„Ÿè§‰ä¹Ÿæ˜¯åœ¨ç­‰å¾…å…¶ä»–çº¿ç¨‹åšæŸäº›æ“ä½œã€‚åœ¨â€œé˜»å¡â€ä¸­ä¹Ÿæ˜¯åœ¨â€œç­‰å¾…â€ä¸­ï¼Ÿï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419300,"discussion_content":"waitå’Œblockedæ˜¯ä¸åŒçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528991160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335026,"user_name":"å­™å‰‘å¹³","can_delete":false,"product_type":"c1","uid":1865124,"ip_address":"","ucode":"33C41928024997","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qc4pasMqznVJfdcpltOEbwVHH5zF1NUvKYuIzWvQMqxHEPUH6QpF8VDm0XNkaWwvHSWhEYTNCY3yNgCJSQQAvw/132","comment_is_top":false,"comment_ctime":1645259580,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5940226876","product_id":100006701,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘ä»¬ç¬¬äºŒæ¬¡è°ƒstaræ–¹æ³•æ˜¯æŠ¥é”™ï¼Œæˆ‘çœ‹æ˜¯æœ‰ä¸ªthreadStatusçš„å€¼å˜ä¸º2äº†ï¼Œæºç æ²¡æœ‰çœ‹åˆ°èµ‹å€¼çš„åœ°æ–¹ï¼Œè¿™å€¼æ˜¯ä»€ä¹ˆæ—¶å€™ä»0å˜ä¸º2çš„å‘¢ï¼Ÿ","like_count":1},{"had_liked":false,"id":16862,"user_name":"æ›²ä¸œæ–¹","can_delete":false,"product_type":"c1","uid":1177819,"ip_address":"","ucode":"6C3EA2F47A0B98","user_header":"https://static001.geekbang.org/account/avatar/00/11/f8/db/c4edf697.jpg","comment_is_top":false,"comment_ctime":1532263113,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5827230409","product_id":100006701,"comment_content":"å¤§æ¦‚10æ¥ä¸ªå§ï¼Œnativeå å¤šæ•°ã€‚å¤§è‡´åˆ†ä¸‹é¢å‡ ç±»<br>1. ç”¨æˆ·çº¿ç¨‹ï¼Œmain<br>2. GCç›¸å…³çº¿ç¨‹ï¼ŒåŒ…æ‹¬C1&#47;C2ï¼›ä¸è¿è¡Œæœºå™¨é…ç½®ã€æ“ä½œç³»ç»Ÿã€å¯åŠ¨å‚æ•°ç›¸å…³<br>3. ç¼–è¯‘å™¨&#47;è§£é‡Šå™¨ç›¸å…³çº¿ç¨‹ï¼›ä¸è¿è¡Œæœºå™¨é…ç½®ã€æ“ä½œç³»ç»Ÿã€å¯åŠ¨å‚æ•°ç›¸å…³<br>4.å¼•ç”¨åŠFinalizerå¤„ç†çº¿ç¨‹<br>6. VM Threadï¼šå¯ä»¥è¯´å®ƒç±»ä¼¼linuxçš„initè¿›ç¨‹<br>7. VM Periodic Task Threadï¼šJVMæ—¶é’Ÿæ¨¡æ‹Ÿçº¿ç¨‹<br>8. Signal Dispatcherï¼šJVMä¿¡å·å¤„ç†çº¿ç¨‹<br>9. Attach Listenerï¼šjdkå·¥å…·ç±»è¯·æ±‚å“åº”å¤„ç†çº¿ç¨‹<br>10. Service Threadï¼šä½å†…å­˜æ£€æµ‹ã€JVMTIäº‹ä»¶è½¬å‘çº¿ç¨‹","like_count":0},{"had_liked":false,"id":13953,"user_name":"tracer","can_delete":false,"product_type":"c1","uid":1124766,"ip_address":"","ucode":"AE2BC047DB7D7D","user_header":"https://static001.geekbang.org/account/avatar/00/11/29/9e/380a01ea.jpg","comment_is_top":false,"comment_ctime":1530083404,"is_pvip":false,"replies":[{"id":"4653","content":"ä¸çŸ¥é“ï¼Œæºç ...","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1530117930,"ip_address":"","comment_id":13953,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5825050700","product_id":100006701,"comment_content":"æœ‰è®²è§£é‚£äº”ä¸ªçº¿ç¨‹çš„èµ„æ–™å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419820,"discussion_content":"ä¸çŸ¥é“ï¼Œæºç ...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1530117930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":341308,"user_name":"L","can_delete":false,"product_type":"c1","uid":1142198,"ip_address":"","ucode":"AFF206EF3DF651","user_header":"https://static001.geekbang.org/account/avatar/00/11/6d/b6/67f8f097.jpg","comment_is_top":false,"comment_ctime":1649513886,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649513886","product_id":100006701,"comment_content":"ä¸æ˜ç™½ThreadLocalçš„å¼±å¼•ç”¨ä¸ºä»€ä¹ˆä¼šå¼•èµ·oomï¼Ÿ<br>è¿˜æœ‰çº¿ç¨‹æ± ä¸æ¨èä½¿ç”¨ThreadLocalæ˜¯å› ä¸ºæ€•ç¨‹åºå‘˜å¿˜è®°åšremoveæ“ä½œå—ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":246513,"user_name":"è’™å¥‡å›æ°","can_delete":false,"product_type":"c1","uid":1117302,"ip_address":"","ucode":"2DBCECD149730F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/76/0c07376d.jpg","comment_is_top":false,"comment_ctime":1599385237,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599385237","product_id":100006701,"comment_content":"ç¡®å®ï¼Œå°±åƒè¯„è®ºé‡Œè¯´çš„ï¼Œå¤§å¤šæ•°æ—¶å€™éƒ½åœ¨CURDï¼Œå¯¹è¿™äº›ç»†ææœ«èŠ‚çš„ç‚¹æ¥è§¦çš„æ¯”è¾ƒå°‘ï¼Œè‡ªç„¶å°±å®¹æ˜“å‡ºç°ä¸€é—®ä¸‰çŒœçš„æƒ…å†µäº†ã€‚ä¸ªäººè®¤ä¸ºï¼Œå¯¹è¿™äº›ä¸œè¥¿çš„ç†è§£æ‰æ˜¯æœ€é‡è¦çš„ï¼Œå³çŸ¥é“æœ‰å“ªäº›å°±æˆï¼Œä¸å¿…è¦å¤ªè¿‡ç»†è‡´çš„å»æ·±æŒ–æ¯ä¸€ä¸ªçº¿ç¨‹æ¦‚å¿µçš„å…·ä½“å®šä¹‰å’Œä½œç”¨ã€‚<br>è¿™é‡Œæˆ‘ç›´æ¥æ˜¯ç”¨è¯„è®ºåŒºæåˆ°çš„debugæ–¹æ³•æ¥æŸ¥çœ‹å¤šå°‘ä¸ªçº¿ç¨‹çš„ã€‚<br>ç¯å¢ƒï¼šIDEA-2018.2+JDK8.0<br>æ²¡è¿è¡Œç¨‹åºå‰ï¼Œé¦–å…ˆå°±åªæƒ³åˆ°äº†åº”ç”¨ç¨‹åºå±‚é¢çš„ä¸»çº¿ç¨‹ï¼Œå…¶æ¬¡å°±æ˜¯å¯èƒ½çš„JVMç¼–è¯‘ï¼ŒJVMæŒ‚è½½ç­‰çš„çº¿ç¨‹(è¿™ä¸¤éƒ¨åˆ†æ˜¯çŒœçš„)ã€‚<br>ä¸€è¯¾ä¸€ç»ƒ---&gt;<br>Mainâ€”â€”(åšå®äº‹)<br>Finalizer-å›æ”¶å™¨çº¿ç¨‹<br>Signal Dispatcherâ€”â€”(æŒ‡æ˜è¦åšä»€ä¹ˆ)<br>Reference Handlerâ€”â€”(æ£€æµ‹æ˜¯å¦éœ€è¦åŒå¤–éƒ¨çº¿ç¨‹åä½œ)<br>Attach Listenerâ€”â€”ï¼ˆæŒ‡æ˜åœ¨å“ªé‡Œå»åšï¼‰","like_count":0},{"had_liked":false,"id":236649,"user_name":"looper","can_delete":false,"product_type":"c1","uid":1238396,"ip_address":"","ucode":"DA4BCE83836C04","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/7c/2a5a418b.jpg","comment_is_top":false,"comment_ctime":1595490610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595490610","product_id":100006701,"comment_content":"win10+jdk11<br>ä½¿ç”¨hread.getAllStackTraces().forEach((thread, stackTraceElements) -&gt; System.out.println(thread.getName()));<br>è·å–åˆ°çš„çº¿ç¨‹ï¼š<br>Finalizer<br>main<br>Reference Handler<br>Common-Cleaner<br>Signal Dispatcher<br>Attach Listener","like_count":0},{"had_liked":false,"id":220004,"user_name":"é äººå“å»èµ¢","can_delete":false,"product_type":"c1","uid":1301286,"ip_address":"","ucode":"7A20F9EBE847E1","user_header":"https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg","comment_is_top":false,"comment_ctime":1590133859,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590133859","product_id":100006701,"comment_content":"ç»™å¤§å®¶è´´ä¸€ä¸‹ï¼Œçº¿ç¨‹çŠ¶æ€è§£é‡Šçš„æºç ï¼š<br> &#47;**<br>         * Thread state for a thread which has not yet started.<br>         *&#47;<br>        NEW,<br><br>        &#47;**<br>         * Thread state for a runnable thread.  A thread in the runnable<br>         * state is executing in the Java virtual machine but it may<br>         * be waiting for other resources from the operating system<br>         * such as processor.<br>         *&#47;<br>        RUNNABLE,<br><br>        &#47;**<br>         * Thread state for a thread blocked waiting for a monitor lock.<br>         * A thread in the blocked state is waiting for a monitor lock<br>         * to enter a synchronized block&#47;method or<br>         * reenter a synchronized block&#47;method after calling<br>         * {@link Object#wait() Object.wait}.<br>         *&#47;<br>        BLOCKED,","like_count":0},{"had_liked":false,"id":198412,"user_name":"æˆ‘çš„é»„é‡‘æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1062070,"ip_address":"","ucode":"D7825B45B372F4","user_header":"https://static001.geekbang.org/account/avatar/00/10/34/b6/0feb574b.jpg","comment_is_top":false,"comment_ctime":1585450045,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585450045","product_id":100006701,"comment_content":"        &#47;*<br>         * A zero status value corresponds to state &quot;NEW&quot;.<br>         *&#47;<br>        if (threadStatus != 0)<br>            throw new IllegalThreadStateException();<br>","like_count":0},{"had_liked":false,"id":192699,"user_name":"æŠ¤çˆ½ä½¿è€…","can_delete":false,"product_type":"c1","uid":1275464,"ip_address":"","ucode":"12DC35DD74671C","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/48/5ab89daa.jpg","comment_is_top":false,"comment_ctime":1584868869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584868869","product_id":100006701,"comment_content":"startæ˜¯çº¿ç¨‹å¯åŠ¨ï¼Œrun æ˜¯ç›´æ¥è°ƒç”¨","like_count":0},{"had_liked":false,"id":182977,"user_name":"FATMAN89","can_delete":false,"product_type":"c1","uid":1175430,"ip_address":"","ucode":"48A67FB47B3C5D","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/86/12f95d66.jpg","comment_is_top":false,"comment_ctime":1582901413,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1582901413","product_id":100006701,"comment_content":"è€å¸ˆï¼Œçº¿ç¨‹æ—¢ç„¶ä¸èƒ½startä¸¤æ¬¡ï¼Œé‚£ä¹ˆçº¿ç¨‹æ± æ˜¯å¦‚ä½•å¤ç”¨çº¿ç¨‹çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1330065,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/N0NACGUr8dNAbN6BdiagPHBaB0EnyDsI9zWpwJteqTY38apOEnTOA7JkBAQnzYKJBgxu3Q8YMUILwLAB6camn4w/132","nickname":"Swing","note":"","ucode":"55FCA9ECEFBBEB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217116,"discussion_content":"ç»™ ç©ºé—²çº¿ç¨‹ å¡ runnable å»æ‰§è¡Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585498665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175207,"user_name":"jackLee","can_delete":false,"product_type":"c1","uid":1234280,"ip_address":"","ucode":"720304AB76D9FB","user_header":"https://static001.geekbang.org/account/avatar/00/12/d5/68/af1682f1.jpg","comment_is_top":false,"comment_ctime":1580616004,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1580616004","product_id":100006701,"comment_content":"    &#47;**<br>     * Causes this thread to begin execution; the Java Virtual Machine<br>     * calls the &lt;code&gt;run&lt;&#47;code&gt; method of this thread.<br>     * &lt;p&gt;<br>     * The result is that two threads are running concurrently: the<br>     * current thread (which returns from the call to the<br>     * &lt;code&gt;start&lt;&#47;code&gt; method) and the other thread (which executes its<br>     * &lt;code&gt;run&lt;&#47;code&gt; method).<br>     * &lt;p&gt;<br>     * It is never legal to start a thread more than once.<br>     * In particular, a thread may not be restarted once it has completed<br>     * execution.<br>     *<br>     * @exception  IllegalThreadStateException  if the thread was already<br>     *               started.<br>     * @see        #run()<br>     * @see        #stop()<br>     *&#47;<br>    public synchronized void start() {<br>        &#47;**<br>         * This method is not invoked for the main method thread or &quot;system&quot;<br>         * group threads created&#47;set up by the VM. Any new functionality added<br>         * to this method in the future may have to also be added to the VM.<br>         *<br>         * A zero status value corresponds to state &quot;NEW&quot;.<br>         *&#47;<br>        if (threadStatus != 0)<br>            throw new IllegalThreadStateException();<br><br>        &#47;* Notify the group that this thread is about to be started<br>         * so that it can be added to the group&#39;s list of threads<br>         * and the group&#39;s unstarted count can be decremented. *&#47;<br>        group.add(this);<br><br>        boolean started = false;<br>        try {<br>            start0();<br>            started = true;<br>        } finally {<br>            try {<br>                if (!started) {<br>                    group.threadStartFailed(this);<br>                }<br>            } catch (Throwable ignore) {<br>                &#47;* do nothing. If start0 threw a Throwable then<br>                  it will be passed up the call stack *&#47;<br>            }<br>        }<br>    }","like_count":0},{"had_liked":false,"id":152948,"user_name":"Geek_032104","can_delete":false,"product_type":"c1","uid":1298282,"ip_address":"","ucode":"25542A2348F99F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/G61OS6hibNG7iakUmXeKmcY5VtFWnPpywzjOcUCm3t0HsibCibm3jzLNbdvjKQ8G8WSIkicBiaqoCsvHibn3M7wV4YbrA/132","comment_is_top":false,"comment_ctime":1574128481,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574128481","product_id":100006701,"comment_content":"blockedå’Œwaitingé™¤äº†ç­‰å¾…çš„å¯¹è±¡ä¸ä¸€æ ·ï¼ˆå‰è€…ç­‰å¾…é”ï¼Œåè€…ç­‰å¾…å…¶å®ƒçº¿ç¨‹ï¼‰ï¼Œè¿˜æœ‰åˆ«çš„åŒºåˆ«å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":149868,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1573418598,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573418598","product_id":100006701,"comment_content":"æœ‰äº†rxjavaä»¥åï¼ŒçœŸå¿ƒä¸å¤ªæƒ³å»ç›´æ¥å†™çº¿ç¨‹ä»£ç ã€‚","like_count":0},{"had_liked":false,"id":138626,"user_name":"aof","can_delete":false,"product_type":"c1","uid":1062864,"ip_address":"","ucode":"5815D63C4926BC","user_header":"https://static001.geekbang.org/account/avatar/00/10/37/d0/26975fba.jpg","comment_is_top":false,"comment_ctime":1570376479,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570376479","product_id":100006701,"comment_content":"è€å¸ˆï¼Œçº¿ç¨‹ç­‰å¾…æ—¶ä½äºå“ªä¸ªåŒºåŸŸï¼Ÿ","like_count":0},{"had_liked":false,"id":136123,"user_name":"å¼ ä¸‰","can_delete":false,"product_type":"c1","uid":1004092,"ip_address":"","ucode":"1155528FAE1546","user_header":"https://static001.geekbang.org/account/avatar/00/0f/52/3c/d6fcb93a.jpg","comment_is_top":false,"comment_ctime":1569370904,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569370904","product_id":100006701,"comment_content":"é‚£join(),yeild(),sleep(),è¿™ä¸‰ä¸ªæ–¹æ³•è°ƒç”¨åï¼Œåˆ†åˆ«è¿›å…¥ä»€ä¹ˆçŠ¶æ€ï¼Ÿ","like_count":0},{"had_liked":false,"id":116820,"user_name":"fcbçš„é±¼","can_delete":false,"product_type":"c1","uid":1243901,"ip_address":"","ucode":"88667EBF09CEC0","user_header":"https://static001.geekbang.org/account/avatar/00/12/fa/fd/ec24cba7.jpg","comment_is_top":false,"comment_ctime":1563929739,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563929739","product_id":100006701,"comment_content":"ç„¶è€Œå¹¶æ²¡æœ‰æ‰¾åˆ°çº¿ç¨‹çŠ¶æ€åœ¨å“ªè®¾ç½®çš„ï¼Ÿä¹Ÿå°±æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™ï¼ŒæŠŠçº¿ç¨‹çš„stateè®¾ç½®ä¸º0ï¼Œä»€ä¹ˆæ—¶å€™åˆæŠŠå€¼æ”¹å˜äº†ï¼Ÿä¸¤æ¬¡è°ƒç”¨startçš„æ—¶å€™ï¼Œå‘ç°çº¿ç¨‹çŠ¶æ€ä¸ä¸º0æ‰æŠ¥å¼‚å¸¸ï¼","like_count":0},{"had_liked":false,"id":90202,"user_name":"å¤šè¥„ä¸¸","can_delete":false,"product_type":"c1","uid":1074310,"ip_address":"","ucode":"1AA1497C5A293C","user_header":"https://static001.geekbang.org/account/avatar/00/10/64/86/f5a9403a.jpg","comment_is_top":false,"comment_ctime":1556446727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556446727","product_id":100006701,"comment_content":"è¿™æ˜¯æ€ä¹ˆæ£€æµ‹å‡ºæ¥ æœ‰å¤šå°‘ä¸ªçº¿ç¨‹åœ¨åå°è¿è¡Œçš„å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":84960,"user_name":"æµå…‰","can_delete":false,"product_type":"c1","uid":1434612,"ip_address":"","ucode":"2B41D1B890018D","user_header":"https://static001.geekbang.org/account/avatar/00/15/e3/f4/ecb33aef.jpg","comment_is_top":false,"comment_ctime":1554949620,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554949620","product_id":100006701,"comment_content":"åˆ›å»ºå•ä¾‹çº¿ç¨‹,Future o = Executors.newSingleThreadExecutor().submit(() -&gt; {<br>            return &quot;asdf&quot;;<br>        });<br>è¿™æ ·æ›´ä¼˜é›…äº›å§","like_count":0},{"had_liked":false,"id":82080,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1554115462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554115462","product_id":100006701,"comment_content":"è·Ÿæˆ‘ä»¬è®²ä¸‹åç¨‹ä¸»è¦æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œå¥½å—","like_count":0},{"had_liked":false,"id":76488,"user_name":"DL","can_delete":false,"product_type":"c1","uid":1349066,"ip_address":"","ucode":"4270976C29AB47","user_header":"https://static001.geekbang.org/account/avatar/00/14/95/ca/5e4580e7.jpg","comment_is_top":false,"comment_ctime":1552618725,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1552618725","product_id":100006701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå¯¹threadLocalçš„OOMæœ‰ä¸€äº›ç–‘é—®ã€‚æ—¢ç„¶Mapä¸­çš„keyæ˜¯å¼±å¼•ç”¨ï¼Œæ˜¯ä¸æ˜¯æ„å‘³ç€åªè¦æˆ‘ä»¬èƒ½å¤Ÿåœ¨ç¼–ç¨‹ä¸­æ³¨æ„å°†newå‡ºæ¥çš„å¯¹è±¡çš„å¼ºå¼•ç”¨å»æ‰ï¼ˆ=nullï¼‰ï¼Œåç»­çš„gcä¼šè‡ªåŠ¨æ¸…ç†æ‰å¼±å¼•ç”¨keyï¼Œå¯¹äºkey=nulçš„valueçš„æ¸…ç†åœ¨åç»­çš„setç­‰æ–¹æ³•ä¸­ä¼šæ¸…ç†ã€‚è¿™æ ·å³ä½¿åœ¨çº¿ç¨‹å¤ç”¨çš„æƒ…å†µä¸‹å¦‚ä½•ä¼šå‡ºç°OOMå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2330905,"avatar":"https://static001.geekbang.org/account/avatar/00/23/91/19/6a3e7efc.jpg","nickname":"ç¨‹åºå‘˜9527","note":"","ucode":"1A1609F6BEAD84","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384809,"discussion_content":"keyè¢«ThreadLocalå¼±å¼•ç”¨ï¼Œä¸ä¼šå‘ç”Ÿoomï¼Œä¼šå‘ç”Ÿoomçš„åœ°æ–¹æ˜¯value\n\nå¦‚æœæŠŠThreadLocalç½®ä¸ºnullï¼Œé‚£ä¹ˆæ„å‘³ç€Heapä¸­çš„ThreadLocalå®ä¾‹ä¸åœ¨æœ‰å¼ºå¼•ç”¨æŒ‡å‘ï¼Œåªæœ‰å¼±å¼•ç”¨å­˜åœ¨ï¼Œå› æ­¤GCæ˜¯å¯ä»¥å›æ”¶è¿™éƒ¨åˆ†ç©ºé—´çš„ï¼Œä¹Ÿå°±æ˜¯keyæ˜¯å¯ä»¥å›æ”¶çš„ã€‚\n\nä½†æ˜¯valueå´å­˜åœ¨ä¸€æ¡ä»Current Threadè¿‡æ¥çš„å¼ºå¼•ç”¨é“¾ã€‚å› æ­¤åªæœ‰å½“Current Threadé”€æ¯æ—¶ï¼Œvalueæ‰èƒ½å¾—åˆ°é‡Šæ”¾ã€‚\n\nå› æ­¤ï¼Œåªè¦è¿™ä¸ªçº¿ç¨‹å¯¹è±¡è¢«gcå›æ”¶ï¼Œå°±ä¸ä¼šå‡ºç°å†…å­˜æ³„éœ²ï¼Œä½†åœ¨threadLocalè®¾ä¸ºnullå’Œçº¿ç¨‹ç»“æŸè¿™æ®µæ—¶é—´å†…ä¸ä¼šè¢«å›æ”¶çš„ï¼Œå°±å‘ç”Ÿäº†æˆ‘ä»¬è®¤ä¸ºçš„å†…å­˜æ³„éœ²ã€‚æœ€è¦å‘½çš„æ˜¯çº¿ç¨‹å¯¹è±¡ä¸è¢«å›æ”¶çš„æƒ…å†µï¼Œæ¯”å¦‚ä½¿ç”¨çº¿ç¨‹æ± çš„æ—¶å€™ï¼Œçº¿ç¨‹ç»“æŸæ˜¯ä¸ä¼šé”€æ¯çš„ï¼Œå†æ¬¡ä½¿ç”¨çš„ï¼Œå°±å¯èƒ½å‡ºç°å†…å­˜æ³„éœ²ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1626761928,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1460942,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4a/ce/affe4307.jpg","nickname":"å«å•¥ä¸è¡Œ","note":"","ucode":"A84B9B6594BF35","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":48209,"discussion_content":"æˆ‘ç†è§£æ˜¯çº¿ç¨‹å¤ç”¨çš„è¯ keyä¸€ç›´ä¸ä¸ºnullï¼Œæ‰€ä»¥å“ªæ€•æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹ï¼Œthreadlocalä¹Ÿä¼šä¸€ç›´å ç”¨ä¸€éƒ¨åˆ†å†…å­˜ä¸é‡Šæ”¾ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573463530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":48747,"user_name":"å³»é“­","can_delete":false,"product_type":"c1","uid":1106202,"ip_address":"","ucode":"63AB23BADACA88","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/1a/20977779.jpg","comment_is_top":false,"comment_ctime":1544529437,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1544529437","product_id":100006701,"comment_content":"æˆ‘è¿˜æ˜¯æ²¡æ˜ç™½ä¸ºä»€ä¹ˆä¸èƒ½startä¸¤æ¬¡ï¼ŒçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶","like_count":0,"discussions":[{"author":{"id":1188176,"avatar":"https://static001.geekbang.org/account/avatar/00/12/21/50/265671fd.jpg","nickname":"LGY001","note":"","ucode":"29CA0F9501D3EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":28218,"discussion_content":"çœ‹ä¸‹Threadç±»çš„startæºç ä¼°è®¡ä½ å°±ç†è§£äº†ï¼Œjavaçº¿ç¨‹æœ‰6ä¸ªçŠ¶æ€ï¼Œåœ¨çº¿ç¨‹æ‰§è¡Œstartå‡½æ•°æ—¶ï¼Œé¦–å…ˆä¼šæ£€æŸ¥çº¿ç¨‹çš„çŠ¶æ€æ˜¯ä¸æ˜¯newï¼Œè‹¥ä¸æ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œè‹¥æ˜¯åˆ™å°†çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹ç»„ä¹‹ä¸­ï¼Œå¹¶è°ƒç”¨æœ¬åœ°nativeæ–¹æ³•æ¥é€šçŸ¥JVMåœ¨ç©ºé—²æ—¶é—´æ‰§è¡Œç›¸å…³ä»»åŠ¡é€»è¾‘ï¼Œstartåçº¿ç¨‹çš„çŠ¶æ€å°±å˜ä¸ºRUNNABLEäº†ï¼Œæ‰€ä»¥è°ƒç”¨ä¸¤æ¬¡å°±ä¼šæŠ›å‡ºå¼‚å¸¸IllegalThreadStateExceptionäº†ï¼Œè¿™æ˜¯æˆ‘çš„ç†è§£ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1570686979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":43598,"user_name":"ç‹å­ç‘Alilokeæœ‰äº‹ç”µè”","can_delete":false,"product_type":"c1","uid":1249400,"ip_address":"","ucode":"9ABE8E475E336B","user_header":"https://static001.geekbang.org/account/avatar/00/13/10/78/29bd3f1e.jpg","comment_is_top":false,"comment_ctime":1543243553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543243553","product_id":100006701,"comment_content":"é€šå¸¸å¼±å¼•ç”¨éƒ½ä¼šå’Œå¼•ç”¨é˜Ÿåˆ—é…åˆæ¸…ç†æœºåˆ¶ä½¿ç”¨ï¼Œä½†æ˜¯ ThreadLocal æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¹¶æ²¡æœ‰è¿™ä¹ˆåšã€‚<br><br>è¿™æ„å‘³ç€ï¼ŒåºŸå¼ƒé¡¹ç›®çš„å›æ”¶ä¾èµ–äºæ˜¾å¼åœ°è§¦å‘ï¼Œå¦åˆ™å°±è¦ç­‰å¾…çº¿ç¨‹ç»“æŸï¼Œè¿›è€Œå›æ”¶ç›¸åº” ThreadLocalMapï¼è¿™å°±æ˜¯å¾ˆå¤š OOM çš„æ¥æº<br><br>å°±åœ¨å‰å‡ å¤©ï¼Œè¸©äº†è¿™ä¸ªå‘ï¼Œé¡¹ç›®è·‘ç€è·‘ç€ï¼Œå°±OOMäº†ï¼Œåæ¥æ‰‹åŠ¨æŠŠsessionå¤±æ•ˆï¼Œäº¤ç»™GCå›æ”¶ã€‚","like_count":0},{"had_liked":false,"id":37995,"user_name":"Phoenix","can_delete":false,"product_type":"c1","uid":1005368,"ip_address":"","ucode":"C51BE4C948755B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/38/ba6a106f.jpg","comment_is_top":false,"comment_ctime":1541845867,"is_pvip":false,"replies":[{"id":"13671","content":"æ®æˆ‘æ‰€çŸ¥tomcatä¹Ÿæœ‰ç›¸å…³é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1541908922,"ip_address":"","comment_id":37995,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1541845867","product_id":100006701,"comment_content":"æƒ³è¦è¯·æ•™è€å¸ˆï¼Œå¯¹äºtomcatæœåŠ¡å™¨ä¸ºæ¯ä¸ªç”¨æˆ·è¯·æ±‚æ–°å»ºä¸€æ¡çº¿ç¨‹ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹çš„threadlocalä¹Ÿä¼šéšç€è¯·æ±‚ç»“æŸï¼Œçº¿ç¨‹è¢«å›æ”¶ï¼Œthreadlocalä¹Ÿä¼šç›¸åº”çš„è¢«å›æ”¶ï¼Œé‚£ä¹ˆæˆ‘ç†è§£çš„æ˜¯ï¼Œç±»ä¼¼tomcatè¯·æ±‚è¿™ç§çº¿ç¨‹æ¨¡å‹ï¼Œthreadlocalå³ä½¿ä¸è°ƒç”¨removeï¼Œä¹Ÿä¸ä¼šå‡ºç°OOMï¼Œè¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428554,"discussion_content":"æ®æˆ‘æ‰€çŸ¥tomcatä¹Ÿæœ‰ç›¸å…³é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541908922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37949,"user_name":"çº¦ä¹¦äºš","can_delete":false,"product_type":"c1","uid":1046714,"ip_address":"","ucode":"81EA27ADD9EC1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","comment_is_top":false,"comment_ctime":1541821914,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1541821914","product_id":100006701,"comment_content":"ç°åœ¨æ‰æ¥ä¸çŸ¥é“é—®çš„é—®é¢˜è¿˜èƒ½çœ‹åˆ°ä¸ï¼Ÿ<br>javaçº¿ç¨‹waitå¯¹åº”å®é™…çº¿ç¨‹çš„çŠ¶æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿjvmè°ƒåº¦éƒ½èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿä»runableçŠ¶æ€æ¥çœ‹ï¼Œjvmå¹¶ä¸çŸ¥é“ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦è·å–äº†cpuèµ„æºï¼Ÿ<br>ä»¥ä¸Šé—®é¢˜å¯¹åº”åˆ°posixä¸Šã€‚<br>ä¸ºä»€ä¹ˆthreadlocalçš„ entryä¸åˆ©ç”¨å¼•ç”¨é˜Ÿåˆ—æ¥ç½®ç©ºå¯¹valueçš„å¼•ç”¨å‘¢ï¼Ÿ<br>javaæœ‰æ²¡æœ‰è€ƒè™‘è¿‡å¼‚æ­¥è½¬åŒæ­¥çš„async&#47;awaitæ¨¡å¼å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":18577,"user_name":"clz1341521","can_delete":false,"product_type":"c1","uid":1179557,"ip_address":"","ucode":"3BDB4AB454C918","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/a5/eccc7653.jpg","comment_is_top":false,"comment_ctime":1533461852,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1533461852","product_id":100006701,"comment_content":"1ã€ç«™åœ¨åº”ç”¨ç¨‹åºæ–¹é¢ï¼Œåªåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ã€‚<br>2ã€ç«™åœ¨jvmæ–¹é¢ï¼Œè‚¯å®šè¿˜æœ‰gcç­‰å…¶ä½™çº¿ç¨‹ã€‚<br><br>æ€»ç»“ï¼š<br>1ã€çº¿ç¨‹æ˜¯ç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒï¼Œåº”è¯¥æ˜¯è¿›ç¨‹å§ã€‚çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ä¼šæ‰“å¼€æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚<br>2ã€ resumeã€stopã€suspendç­‰å·²ç»è¢«åºŸå¼ƒäº†<br>3ã€çº¿ç¨‹çš„ç­‰å¾…å’Œå”¤é†’ï¼Œå»ºè®®ä½¿ç”¨reentrantlockçš„condition wait&#47;notifyæ–¹æ³•<br>4ã€å¯ä»¥ä½¿ç”¨çº¿ç¨‹çš„joinæ–¹æ³•ã€countdownlatchã€cyclicbarrierã€futureç­‰è¿›è¡Œçº¿ç¨‹çš„ç­‰å¾…","like_count":0},{"had_liked":false,"id":13194,"user_name":"jacy","can_delete":false,"product_type":"c1","uid":1103456,"ip_address":"","ucode":"0022A8759DDCE6","user_header":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","comment_is_top":false,"comment_ctime":1529454434,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1529454434","product_id":100006701,"comment_content":"Threadlocalè¿›è¡Œçº¿ç¨‹éš”ç¦»ï¼Œçº¿ç¨‹æ‹¥æœ‰è‡ªå·±çš„æ•°æ®ç©ºé—´ï¼Œsynchronizeè¿›è¡Œçº¿ç¨‹åŒæ­¥ã€‚<br>å¦å¤–æƒ³é—®è€å¸ˆï¼Œè™šå‡å”¤é†’çš„æ·±å±‚æ¬¡åŸå› æ˜¯å•¥å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":12999,"user_name":"TonyEasy","can_delete":false,"product_type":"c1","uid":1115635,"ip_address":"","ucode":"CB455BA8915B64","user_header":"https://static001.geekbang.org/account/avatar/00/11/05/f3/4dd9e515.jpg","comment_is_top":false,"comment_ctime":1529276746,"is_pvip":false,"replies":[{"id":"4417","content":"å·¥ä½œçº¿ç¨‹ä¸€èˆ¬ä¸é€€å‡ºçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529423199,"ip_address":"","comment_id":12999,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529276746","product_id":100006701,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸€ç‚¹ç–‘é—®ï¼Œåœ¨çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹æ—¶ï¼Œå¯¹åŒä¸€çº¿ç¨‹è°ƒç”¨å¤šæ¬¡.start()æ–¹æ³•ï¼Œä¸ºä½•ä¸æŠ¥é”™å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419494,"discussion_content":"å·¥ä½œçº¿ç¨‹ä¸€èˆ¬ä¸é€€å‡ºçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529423199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12946,"user_name":"æ‰«åœ°åƒ§çš„åŠŸå¤«æ¢¦","can_delete":false,"product_type":"c1","uid":1081053,"ip_address":"","ucode":"3B775474594BC3","user_header":"https://static001.geekbang.org/account/avatar/00/10/7e/dd/e4e6718a.jpg","comment_is_top":false,"comment_ctime":1529196635,"is_pvip":false,"replies":[{"id":"4424","content":"å·²å›å¤ï¼Œä¸æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529423953,"ip_address":"","comment_id":12946,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1529196635","product_id":100006701,"comment_content":"è°ƒç”¨notify()&#47;notifyAll()æ–¹æ³•çº¿ç¨‹æ˜¯å˜ä¸ºé˜»å¡çŠ¶æ€å§ï¼Œå› ä¸ºçº¿ç¨‹è¿˜æ²¡è·å–åˆ°é”ã€‚","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419470,"discussion_content":"å·²å›å¤ï¼Œä¸æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529423953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12812,"user_name":"æäºŒæœ¨","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1529049480,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1529049480","product_id":100006701,"comment_content":"çœ‹äº†17è®²å›æ¥ç•™è¨€threadlocal","like_count":0},{"had_liked":false,"id":12688,"user_name":"è‚–ä¸€æ—","can_delete":false,"product_type":"c1","uid":1113317,"ip_address":"","ucode":"1DE45D906EB836","user_header":"https://static001.geekbang.org/account/avatar/00/10/fc/e5/605f423f.jpg","comment_is_top":false,"comment_ctime":1528960187,"is_pvip":false,"replies":[{"id":"4205","content":"çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸé•¿","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990112,"ip_address":"","comment_id":12688,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528960187","product_id":100006701,"comment_content":"threadlocalå’Œçº¿ç¨‹æ± ç»“åˆçš„é—®é¢˜çœŸçš„æ²¡è€ƒè™‘è¿‡","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419371,"discussion_content":"çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸé•¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12651,"user_name":"Miaozhe","can_delete":false,"product_type":"c1","uid":1113660,"ip_address":"","ucode":"62872E8C138B67","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/3c/13175251.jpg","comment_is_top":false,"comment_ctime":1528943625,"is_pvip":false,"replies":[{"id":"4308","content":"æˆ‘ç†è§£ä¸æ˜¯ä¸€å›äº‹ï¼Œopenjdkç›®å‰æ²¡æœ‰åç¨‹ï¼ŒLoomè¿‡ç¨‹åœ¨åšç›¸å…³äº‹æƒ…","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1529170985,"ip_address":"","comment_id":12651,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528943625","product_id":100006701,"comment_content":"é—®ä¸ªé—®é¢˜ï¼ŒNIO 2çš„å¼‚æ­¥æ˜¯ä¸æ˜¯åˆ©ç”¨åç¨‹çš„åŸç†è®¾è®¡çš„ï¼Ÿå®ƒå®é™…è¿è¡Œçš„æ˜¯å¤šçº¿ç¨‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419352,"discussion_content":"æˆ‘ç†è§£ä¸æ˜¯ä¸€å›äº‹ï¼Œopenjdkç›®å‰æ²¡æœ‰åç¨‹ï¼ŒLoomè¿‡ç¨‹åœ¨åšç›¸å…³äº‹æƒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1529170985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12643,"user_name":"tyson","can_delete":false,"product_type":"c1","uid":1110943,"ip_address":"","ucode":"E88F630B53C743","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/9f/3e4e8d46.jpg","comment_is_top":false,"comment_ctime":1528940880,"is_pvip":true,"replies":[{"id":"4213","content":"æ­£è§£","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990854,"ip_address":"","comment_id":12643,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528940880","product_id":100006701,"comment_content":"1ã€ç«™åœ¨åº”ç”¨ç¨‹åºæ–¹é¢ï¼Œåªåˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ã€‚<br>2ã€ç«™åœ¨jvmæ–¹é¢ï¼Œè‚¯å®šè¿˜æœ‰gcç­‰å…¶ä½™çº¿ç¨‹ã€‚<br><br>æ€»ç»“ï¼š<br>1ã€çº¿ç¨‹æ˜¯ç³»ç»Ÿè°ƒåº¦çš„æœ€å°å•å…ƒï¼Œåº”è¯¥æ˜¯è¿›ç¨‹å§ã€‚çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçš„èµ„æºï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ä¼šæ‰“å¼€æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚<br>2ã€ resumeã€stopã€suspendç­‰å·²ç»è¢«åºŸå¼ƒäº†<br>3ã€çº¿ç¨‹çš„ç­‰å¾…å’Œå”¤é†’ï¼Œå»ºè®®ä½¿ç”¨reentrantlockçš„condition wait&#47;notifyæ–¹æ³•<br>4ã€å¯ä»¥ä½¿ç”¨çº¿ç¨‹çš„joinæ–¹æ³•ã€countdownlatchã€cyclicbarrierã€futureç­‰è¿›è¡Œçº¿ç¨‹çš„ç­‰å¾…","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419346,"discussion_content":"æ­£è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12642,"user_name":"é›·éœ¹é›³çš„çˆ¸çˆ¸","can_delete":false,"product_type":"c1","uid":1119490,"ip_address":"","ucode":"99BBA6D83DD11F","user_header":"https://static001.geekbang.org/account/avatar/00/11/15/02/66f65388.jpg","comment_is_top":false,"comment_ctime":1528940548,"is_pvip":true,"replies":[{"id":"4214","content":"ä¸»è¦æ˜¯ä¸ºäº†åŠ æ·±ç†è§£ï¼Œè¿™ç§ä¹Ÿå°±æ˜¯è€å­¦ç©¶å…³å¿ƒï¼Œå“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990894,"ip_address":"","comment_id":12642,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528940548","product_id":100006701,"comment_content":"è€å¸ˆä»Šå¤©è¿™è¯¾åé¢˜ï¼Œåˆæ‰“è„¸äº†å¹³æ—¶å·¥ä½œä¸ä»”ç»†çš„åœ°æ–¹ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯å¥½æ­¹å¾—sleepä¸€ä¸‹æˆ–æ‰“ä¸ªæ–­ç‚¹ç”¨ç±»ä¼¼visualvmçš„å·¥å…·çœ‹ä¸‹ï¼Œæˆ–è€…topä¹‹ç±»æ•°ä¸€ä¸‹ï¼Œèµ¶ç€å‡ºé—¨ï¼Œå›æ¥è¯•ä¸‹","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419345,"discussion_content":"ä¸»è¦æ˜¯ä¸ºäº†åŠ æ·±ç†è§£ï¼Œè¿™ç§ä¹Ÿå°±æ˜¯è€å­¦ç©¶å…³å¿ƒï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12617,"user_name":"é˜¿ç”˜","can_delete":false,"product_type":"c1","uid":1122021,"ip_address":"","ucode":"B29CAB0EF4C474","user_header":"https://static001.geekbang.org/account/avatar/00/11/1e/e5/bee05364.jpg","comment_is_top":false,"comment_ctime":1528936910,"is_pvip":true,"replies":[{"id":"4210","content":"åè¾¹è™šæ‹Ÿæœºé‚£è¾¹ä»‹ç»","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990575,"ip_address":"","comment_id":12617,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528936910","product_id":100006701,"comment_content":"çº¿ç¨‹å¾—å†…å­˜åˆ†é…æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419327,"discussion_content":"åè¾¹è™šæ‹Ÿæœºé‚£è¾¹ä»‹ç»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12584,"user_name":"hanmshashou","can_delete":false,"product_type":"c1","uid":1147615,"ip_address":"","ucode":"3424FFBEDE6138","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/B5KGe7PEWv1m0ZdUSRBLaX65brD5Iice8ze7xpFDJIzOTQSN2JqCkCYwOnTMW5ApNCyicCAs8t48DUuX5t66VHBQ/132","comment_is_top":false,"comment_ctime":1528934636,"is_pvip":false,"replies":[{"id":"4209","content":"æ±—é¢œï¼Œå·²ä¿®æ­£","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528990547,"ip_address":"","comment_id":12584,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528934636","product_id":100006701,"comment_content":"weak åº”è¯¥ä¸æ˜¯å¹»è±¡å¼•ç”¨å§","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419308,"discussion_content":"æ±—é¢œï¼Œå·²ä¿®æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528990547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":12583,"user_name":"ç°é£ç°çŒªä¸ä¼šç°é£.çƒŸç­","can_delete":false,"product_type":"c1","uid":1127314,"ip_address":"","ucode":"FF9FB4C902D1F5","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/92/99530cee.jpg","comment_is_top":false,"comment_ctime":1528934535,"is_pvip":false,"replies":[{"id":"4221","content":"æ˜¯è¯´FutureTaskçš„å®ç°å—ï¼Ÿæˆ‘è®°å¾—æ˜¯æœ‰åŒºåˆ«çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ¨æ™“å³°","uid":"1009360","ctime":1528994106,"ip_address":"","comment_id":12583,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1528934535","product_id":100006701,"comment_content":"è€å¸ˆ futureæ¨¡å¼æ˜¯æ€ä¹ˆå¼‚æ­¥è¿”å›ç»“æœçš„å‘¢ï¼Ÿæ˜¯ä¸æ˜¯æŠŠæ¯ä¸ªçº¿ç¨‹çš„è¿è¡Œç»“æœæ”¾åˆ°queueä¸­ï¼Œç„¶åè½®è¯¢queueè¿”å›ç»“æœï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"æ¨æ™“å³°","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":419307,"discussion_content":"æ˜¯è¯´FutureTaskçš„å®ç°å—ï¼Ÿæˆ‘è®°å¾—æ˜¯æœ‰åŒºåˆ«çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1528994106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}