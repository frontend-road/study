{"id":78633,"title":"28 | æ¡ˆä¾‹ç¯‡ï¼šä¸€ä¸ªSQLæŸ¥è¯¢è¦15ç§’ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬åˆ†æäº†ä¸€ä¸ªå•è¯çƒ­åº¦åº”ç”¨å“åº”è¿‡æ…¢çš„æ¡ˆä¾‹ã€‚å½“ç”¨ topã€iostat åˆ†æäº†ç³»ç»Ÿçš„ CPU å’Œç£ç›˜ I/O ä½¿ç”¨æƒ…å†µåï¼Œæˆ‘ä»¬å‘ç°ç³»ç»Ÿå‡ºç°äº†ç£ç›˜çš„ I/O ç“¶é¢ˆï¼Œè€Œä¸”æ­£æ˜¯æ¡ˆä¾‹åº”ç”¨å¯¼è‡´çš„ã€‚</p><p>æ¥ç€ï¼Œåœ¨ä½¿ç”¨ strace å´æ²¡æœ‰ä»»ä½•å‘ç°åï¼Œæˆ‘åˆç»™ä½ ä»‹ç»äº†ä¸¤ä¸ªæ–°çš„å·¥å…· filetop å’Œ opensnoopï¼Œåˆ†æå®ƒä»¬å¯¹ç³»ç»Ÿè°ƒç”¨ write() å’Œ open() çš„è¿½è¸ªç»“æœã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œæ¡ˆä¾‹åº”ç”¨æ­£åœ¨è¯»å†™å¤§é‡çš„ä¸´æ—¶æ–‡ä»¶ï¼Œå› æ­¤äº§ç”Ÿäº†æ€§èƒ½ç“¶é¢ˆã€‚æ‰¾å‡ºç“¶é¢ˆåï¼Œæˆ‘ä»¬åˆç”¨æŠŠæ–‡ä»¶æ•°æ®éƒ½æ”¾åœ¨å†…å­˜çš„æ–¹æ³•ï¼Œè§£å†³äº†ç£ç›˜ I/O çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¤§é‡æ•°æ®è‚¯å®šæ˜¯è¦å­˜å…¥æ•°æ®åº“çš„ï¼Œè€Œä¸ä¼šç›´æ¥ç”¨æ–‡æœ¬æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚ä¸è¿‡ï¼Œæ•°æ®åº“ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ã€‚å½“æ•°æ®åº“å‡ºç°æ€§èƒ½é—®é¢˜æ—¶ï¼Œåˆè¯¥å¦‚ä½•åˆ†æå’Œå®šä½å®ƒçš„ç“¶é¢ˆå‘¢ï¼Ÿ</p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€èµ·åˆ†æä¸€ä¸ªæ•°æ®åº“çš„æ¡ˆä¾‹ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäº Python Flask çš„å•†å“æœç´¢åº”ç”¨ï¼Œå•†å“ä¿¡æ¯å­˜åœ¨ MySQL ä¸­ã€‚è¿™ä¸ªåº”ç”¨å¯ä»¥é€šè¿‡ MySQL æ¥å£ï¼Œæ ¹æ®å®¢æˆ·ç«¯æä¾›çš„å•†å“åç§°ï¼Œå»æ•°æ®åº“è¡¨ä¸­æŸ¥è¯¢å•†å“ä¿¡æ¯ã€‚</p><p>éå¸¸æ„Ÿè°¢å”¯å“ä¼šèµ„æ·±è¿ç»´å·¥ç¨‹å¸ˆé˜³ç¥¥ä¹‰ï¼Œå¸®åŠ©æä¾›äº†ä»Šå¤©çš„æ¡ˆä¾‹ã€‚</p><h2>æ¡ˆä¾‹å‡†å¤‡</h2><p>æœ¬æ¬¡æ¡ˆä¾‹è¿˜æ˜¯åŸºäº Ubuntu 18.04ï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–çš„ Linux ç³»ç»Ÿã€‚æˆ‘ä½¿ç”¨çš„æ¡ˆä¾‹ç¯å¢ƒå¦‚ä¸‹æ‰€ç¤ºï¼š</p><!-- [[[read_end]]] --><ul>\n<li>\n<p>æœºå™¨é…ç½®ï¼š2 CPUï¼Œ8GB å†…å­˜</p>\n</li>\n<li>\n<p>é¢„å…ˆå®‰è£… dockerã€sysstat ã€gitã€make ç­‰å·¥å…·ï¼Œå¦‚ apt install <a href=\"http://docker.io\">docker.io</a> sysstat make git</p>\n</li>\n</ul><p>å…¶ä¸­ï¼Œdocker å’Œ sysstat å·²ç»ç”¨è¿‡å¾ˆå¤šæ¬¡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼›git ç”¨æ¥æ‹‰å–æœ¬æ¬¡æ¡ˆä¾‹æ‰€éœ€è„šæœ¬ï¼Œè¿™äº›è„šæœ¬å­˜å‚¨åœ¨ Github ä»£ç ä»“åº“ä¸­ï¼›æœ€åçš„ make åˆ™æ˜¯ä¸€ä¸ªå¸¸ç”¨æ„å»ºå·¥å…·ï¼Œè¿™é‡Œç”¨æ¥è¿è¡Œä»Šå¤©çš„æ¡ˆä¾‹ã€‚</p><p>æ¡ˆä¾‹æ€»å…±ç”±ä¸‰ä¸ªå®¹å™¨ç»„æˆï¼ŒåŒ…æ‹¬ä¸€ä¸ª MySQL æ•°æ®åº“åº”ç”¨ã€ä¸€ä¸ªå•†å“æœç´¢åº”ç”¨ä»¥åŠä¸€ä¸ªæ•°æ®å¤„ç†çš„åº”ç”¨ã€‚å…¶ä¸­ï¼Œå•†å“æœç´¢åº”ç”¨ä»¥ HTTP çš„å½¢å¼æä¾›äº†ä¸€ä¸ªæ¥å£ï¼š</p><ul>\n<li>\n<p>/ï¼šè¿”å› Index Pageï¼›</p>\n</li>\n<li>\n<p>/db/insert/products/<num>ï¼šæ’å…¥æŒ‡å®šæ•°é‡çš„å•†å“ä¿¡æ¯ï¼›</num></p>\n</li>\n<li>\n<p>/products/<product>ï¼šæŸ¥è¯¢æŒ‡å®šå•†å“çš„ä¿¡æ¯ï¼Œå¹¶è¿”å›å¤„ç†æ—¶é—´ã€‚</product></p>\n</li>\n</ul><p>ç”±äºåº”ç”¨æ¯”è¾ƒå¤šï¼Œä¸ºäº†æ–¹ä¾¿ä½ è¿è¡Œå®ƒä»¬ï¼Œæˆ‘æŠŠå®ƒä»¬åŒæ ·æ‰“åŒ…æˆäº†å‡ ä¸ª Docker é•œåƒï¼Œå¹¶æ¨é€åˆ°äº† Github ä¸Šã€‚è¿™æ ·ï¼Œä½ åªéœ€è¦è¿è¡Œå‡ æ¡å‘½ä»¤ï¼Œå°±å¯ä»¥å¯åŠ¨äº†ã€‚</p><p>ä»Šå¤©çš„æ¡ˆä¾‹éœ€è¦ä¸¤å°è™šæ‹Ÿæœºï¼Œå…¶ä¸­ä¸€å°ä½œä¸ºæ¡ˆä¾‹åˆ†æçš„ç›®æ ‡æœºå™¨ï¼Œè¿è¡Œ Flask åº”ç”¨ï¼Œå®ƒçš„ IP åœ°å€æ˜¯ 192.168.0.10ï¼›å¦ä¸€å°åˆ™æ˜¯ä½œä¸ºå®¢æˆ·ç«¯ï¼Œè¯·æ±‚å•è¯çš„çƒ­åº¦ã€‚æˆ‘ç”»äº†ä¸€å¼ å›¾è¡¨ç¤ºå®ƒä»¬çš„å…³ç³»ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/5d/8c954570f6e46193505c2598a06cbc5d.png?wh=970*525\" alt=\"\"></p><p>æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œåˆ†åˆ« SSH ç™»å½•åˆ°è¿™ä¸¤å°è™šæ‹Ÿæœºä¸­ï¼Œå¹¶åœ¨ç¬¬ä¸€å°è™šæ‹Ÿæœºä¸­å®‰è£…ä¸Šè¿°å·¥å…·ã€‚</p><p>è·Ÿä»¥å‰ä¸€æ ·ï¼Œæ¡ˆä¾‹ä¸­æ‰€æœ‰å‘½ä»¤éƒ½é»˜è®¤ä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœä½ æ˜¯ç”¨æ™®é€šç”¨æˆ·èº«ä»½ç™»é™†ç³»ç»Ÿï¼Œè¯·è¿è¡Œ sudo su rootå‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p><p>åˆ°è¿™é‡Œï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥æ“ä½œç¯èŠ‚ã€‚</p><h2>æ¡ˆä¾‹åˆ†æ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ä¸­æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œæ‹‰å–æœ¬æ¬¡æ¡ˆä¾‹æ‰€éœ€è„šæœ¬ï¼š</p><pre><code>$ git clone https://github.com/feiskyer/linux-perf-examples\n$ cd linux-perf-examples/mysql-slow\n</code></pre><p>æ¥ç€ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œè¿è¡Œæœ¬æ¬¡çš„ç›®æ ‡åº”ç”¨ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼š</p><pre><code># æ³¨æ„ä¸‹é¢çš„éšæœºå­—ç¬¦ä¸²æ˜¯å®¹å™¨IDï¼Œæ¯æ¬¡è¿è¡Œå‡ä¼šä¸åŒï¼Œå¹¶ä¸”ä½ ä¸éœ€è¦å…³æ³¨å®ƒï¼Œå› ä¸ºæˆ‘ä»¬åªä¼šç”¨åˆ°åå­—\n$ make run\ndocker run --name=mysql -itd -p 10000:80 -m 800m feisky/mysql:5.6\nWARNING: Your kernel does not support swap limit capabilities or the cgroup is not mounted. Memory limited without swap.\n4156780da5be0b9026bcf27a3fa56abc15b8408e358fa327f472bcc5add4453f\ndocker run --name=dataservice -itd --privileged feisky/mysql-dataservice\nf724d0816d7e47c0b2b1ff701e9a39239cb9b5ce70f597764c793b68131122bb\ndocker run --name=app --network=container:mysql -itd feisky/mysql-slow\n81d3392ba25bb8436f6151662a13ff6182b6bc6f2a559fc2e9d873cd07224ab6\n</code></pre><p>ç„¶åï¼Œå†è¿è¡Œ docker ps å‘½ä»¤ï¼Œç¡®è®¤ä¸‰ä¸ªå®¹å™¨éƒ½å¤„åœ¨è¿è¡Œï¼ˆUpï¼‰çŠ¶æ€ï¼š</p><pre><code>$ docker ps\nCONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                             NAMES\n9a4e3c580963        feisky/mysql-slow          &quot;python /app.py&quot;         42 seconds ago      Up 36 seconds                                         app\n2a47aab18082        feisky/mysql-dataservice   &quot;python /dataserviceâ€¦&quot;   46 seconds ago      Up 41 seconds                                         dataservice\n4c3ff7b24748        feisky/mysql:5.6           &quot;docker-entrypoint.sâ€¦&quot;   47 seconds ago      Up 46 seconds       3306/tcp, 0.0.0.0:10000-&gt;80/tcp   mysql\n</code></pre><p>MySQL æ•°æ®åº“çš„å¯åŠ¨è¿‡ç¨‹ï¼Œéœ€è¦åšä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œè¿™é€šå¸¸éœ€è¦èŠ±è´¹å‡ åˆ†é’Ÿæ—¶é—´ã€‚ä½ å¯ä»¥è¿è¡Œ docker logs å‘½ä»¤ï¼ŒæŸ¥çœ‹å®ƒçš„å¯åŠ¨è¿‡ç¨‹ã€‚</p><p>å½“ä½ çœ‹åˆ°ä¸‹é¢è¿™ä¸ªè¾“å‡ºæ—¶ï¼Œè¯´æ˜ MySQL åˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥æ¥æ”¶å¤–éƒ¨è¯·æ±‚äº†ï¼š</p><pre><code>$ docker logs -f mysql\n...\n... [Note] mysqld: ready for connections.\nVersion: '5.6.42-log'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  MySQL Community Server (GPL)\n</code></pre><p>è€Œå•†å“æœç´¢åº”ç”¨åˆ™æ˜¯åœ¨ 10000 ç«¯å£ç›‘å¬ã€‚ä½ å¯ä»¥æŒ‰ Ctrl+C ï¼Œåœæ­¢ docker logs å‘½ä»¤ï¼›ç„¶åï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œç¡®è®¤å®ƒä¹Ÿå·²ç»æ­£å¸¸è¿è¡Œã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ° Index Page çš„è¾“å‡ºï¼š</p><pre><code>$ curl http://127.0.0.1:10000/\nIndex Page\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œè¿è¡Œ make init å‘½ä»¤ï¼Œåˆå§‹åŒ–æ•°æ®åº“ï¼Œå¹¶æ’å…¥ 10000 æ¡å•†å“ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œæ¯”å¦‚åœ¨æˆ‘çš„æœºå™¨ä¸­ï¼Œå°±èŠ±äº†åå‡ åˆ†é’Ÿæ—¶é—´ã€‚è€å¿ƒç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œä½ ä¼šçœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºï¼š</p><pre><code>$ make init\ndocker exec -i mysql mysql -uroot -P3306 &lt; tables.sql\ncurl http://127.0.0.1:10000/db/insert/products/10000\ninsert 10000 lines\n</code></pre><p>æ¥ç€ï¼Œæˆ‘ä»¬åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªç»ˆç«¯ï¼Œè®¿é—®ä¸€ä¸‹å•†å“æœç´¢çš„æ¥å£ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°æƒ³è¦çš„å•†å“ã€‚æ‰§è¡Œå¦‚ä¸‹çš„ curl å‘½ä»¤ï¼š</p><pre><code>$ curl http://192.168.0.10:10000/products/geektime\nGot data: () in 15.364538192749023 sec\n</code></pre><p>ç¨ç­‰ä¸€ä¼šå„¿ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ä¸ªæ¥å£è¿”å›çš„æ˜¯ç©ºæ•°æ®ï¼Œè€Œä¸”å¤„ç†æ—¶é—´è¶…è¿‡15 ç§’ã€‚è¿™ä¹ˆæ…¢çš„å“åº”é€Ÿåº¦è®©äººæ— æ³•å¿å—ï¼Œåˆ°åº•å‡ºäº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><p>æ—¢ç„¶ä»Šå¤©ç”¨äº† MySQLï¼Œä½ ä¼°è®¡ä¼šçŒœåˆ°æ˜¯æ…¢æŸ¥è¯¢çš„é—®é¢˜ã€‚</p><p>ä¸è¿‡åˆ«æ€¥ï¼Œåœ¨å…·ä½“åˆ†æå‰ï¼Œä¸ºäº†é¿å…åœ¨åˆ†æè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯çš„è¯·æ±‚ç»“æŸï¼Œæˆ‘ä»¬æŠŠ curl å‘½ä»¤æ”¾åˆ°ä¸€ä¸ªå¾ªç¯é‡Œæ‰§è¡Œã€‚åŒæ—¶ï¼Œä¸ºäº†é¿å…ç»™ç³»ç»Ÿè¿‡å¤§å‹åŠ›ï¼Œæˆ‘ä»¬è®¾ç½®åœ¨æ¯æ¬¡æŸ¥è¯¢åï¼Œéƒ½å…ˆç­‰å¾… 5 ç§’ï¼Œç„¶åå†å¼€å§‹æ–°çš„è¯·æ±‚ã€‚</p><p>æ‰€ä»¥ï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯äºŒä¸­ï¼Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code>$ while true; do curl http://192.168.0.10:10000/products/geektime; sleep 5; done\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œé‡æ–°å›åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œåˆ†ææ¥å£å“åº”é€Ÿåº¦æ…¢çš„åŸå› ã€‚ä¸è¿‡ï¼Œé‡å›ç»ˆç«¯ä¸€åï¼Œä½ ä¼šå‘ç°ç³»ç»Ÿå“åº”ä¹Ÿæ˜æ˜¾å˜æ…¢äº†ï¼Œéšä¾¿æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œéƒ½å¾—åœé¡¿ä¸€ä¼šå„¿æ‰èƒ½çœ‹åˆ°è¾“å‡ºã€‚</p><p>è¿™è·Ÿä¸Šä¸€èŠ‚çš„ç°è±¡å¾ˆç±»ä¼¼ï¼Œçœ‹æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—è§‚å¯Ÿä¸€ä¸‹ç³»ç»Ÿçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œæ¯”å¦‚CPUã€å†…å­˜å’Œç£ç›˜ I/O ç­‰çš„æƒ…å†µã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸€æ‰§è¡Œ top å‘½ä»¤ï¼Œåˆ†æç³»ç»Ÿçš„ CPU ä½¿ç”¨æƒ…å†µï¼š</p><pre><code>$ top\ntop - 12:02:15 up 6 days,  8:05,  1 user,  load average: 0.66, 0.72, 0.59\nTasks: 137 total,   1 running,  81 sleeping,   0 stopped,   0 zombie\n%Cpu0  :  0.7 us,  1.3 sy,  0.0 ni, 35.9 id, 62.1 wa,  0.0 hi,  0.0 si,  0.0 st\n%Cpu1  :  0.3 us,  0.7 sy,  0.0 ni, 84.7 id, 14.3 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  8169300 total,  7238472 free,   546132 used,   384696 buff/cache\nKiB Swap:        0 total,        0 free,        0 used.  7316952 avail Mem\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n27458 999       20   0  833852  57968  13176 S   1.7  0.7   0:12.40 mysqld\n27617 root      20   0   24348   9216   4692 S   1.0  0.1   0:04.40 python\n 1549 root      20   0  236716  24568   9864 S   0.3  0.3  51:46.57 python3\n22421 root      20   0       0      0      0 I   0.3  0.0   0:01.16 kworker/u\n</code></pre><p>è§‚å¯Ÿ top çš„è¾“å‡ºï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸¤ä¸ª CPU çš„ iowait éƒ½æ¯”è¾ƒé«˜ï¼Œç‰¹åˆ«æ˜¯ CPU0ï¼Œiowait å·²ç»è¶…è¿‡ 60%ã€‚è€Œå…·ä½“åˆ°å„ä¸ªè¿›ç¨‹ï¼Œ CPU ä½¿ç”¨ç‡å¹¶ä¸é«˜ï¼Œæœ€é«˜çš„ä¹Ÿåªæœ‰ 1.7%ã€‚</p><p>æ—¢ç„¶CPUçš„å«Œç–‘ä¸å¤§ï¼Œé‚£é—®é¢˜åº”è¯¥è¿˜æ˜¯å‡ºåœ¨äº† I/O ä¸Šã€‚æˆ‘ä»¬ä»ç„¶åœ¨ç¬¬ä¸€ä¸ªç»ˆç«¯ï¼ŒæŒ‰ä¸‹ Ctrl+Cï¼Œåœæ­¢ top å‘½ä»¤ï¼›ç„¶åï¼Œæ‰§è¡Œä¸‹é¢çš„ iostat å‘½ä»¤ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ I/O æ€§èƒ½é—®é¢˜ï¼š</p><pre><code>$ iostat -d -x 1\nDevice            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util\n...\nsda            273.00    0.00  32568.00      0.00     0.00     0.00   0.00   0.00    7.90    0.00   1.16   119.30     0.00   3.56  97.20\n</code></pre><p>iostat çš„è¾“å‡ºä½ åº”è¯¥éå¸¸ç†Ÿæ‚‰ã€‚è§‚å¯Ÿè¿™ä¸ªç•Œé¢ï¼Œæˆ‘ä»¬å‘ç°ï¼Œç£ç›˜ sda æ¯ç§’çš„è¯»æ•°æ®ä¸º 32 MBï¼Œ è€Œ I/O ä½¿ç”¨ç‡é«˜è¾¾ 97% ï¼Œæ¥è¿‘é¥±å’Œï¼Œè¿™è¯´æ˜ï¼Œç£ç›˜ sda çš„è¯»å–ç¡®å®ç¢°åˆ°äº†æ€§èƒ½ç“¶é¢ˆã€‚</p><p>é‚£è¦æ€ä¹ˆçŸ¥é“ï¼Œè¿™äº› I/Oè¯·æ±‚åˆ°åº•æ˜¯å“ªäº›è¿›ç¨‹å¯¼è‡´çš„å‘¢ï¼Ÿå½“ç„¶å¯ä»¥æ‰¾æˆ‘ä»¬çš„è€æœ‹å‹ï¼Œ pidstatã€‚æ¥ä¸‹æ¥ï¼Œåœ¨ç»ˆç«¯ä¸€ä¸­ï¼ŒæŒ‰ä¸‹ Ctrl+C åœæ­¢ iostat å‘½ä»¤ï¼Œç„¶åè¿è¡Œä¸‹é¢çš„ pidstat å‘½ä»¤ï¼Œè§‚å¯Ÿè¿›ç¨‹çš„ I/O æƒ…å†µï¼š</p><pre><code># -dé€‰é¡¹è¡¨ç¤ºå±•ç¤ºè¿›ç¨‹çš„I/Oæƒ…å†µ\n$ pidstat -d 1\n12:04:11      UID       PID   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command\n12:04:12      999     27458  32640.00      0.00      0.00       0  mysqld\n12:04:12        0     27617      4.00      4.00      0.00       3  python\n12:04:12        0     27864      0.00      4.00      0.00       0  systemd-journal\n</code></pre><p>ä» pidstat çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼ŒPID ä¸º 27458 çš„ mysqld è¿›ç¨‹æ­£åœ¨è¿›è¡Œå¤§é‡çš„è¯»ï¼Œè€Œä¸”è¯»å–é€Ÿåº¦æ˜¯ 32 MB/sï¼Œè·Ÿåˆšæ‰ iostat çš„å‘ç°ä¸€è‡´ã€‚ä¸¤ä¸ªç»“æœä¸€å¯¹æ¯”ï¼Œæˆ‘ä»¬è‡ªç„¶å°±æ‰¾åˆ°äº†ç£ç›˜ I/O ç“¶é¢ˆçš„æ ¹æºï¼Œå³ mysqld è¿›ç¨‹ã€‚</p><p>ä¸è¿‡ï¼Œè¿™äº‹å„¿è¿˜æ²¡å®Œã€‚æˆ‘ä»¬è‡ªç„¶è¦æ€€ç–‘ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆ mysqld ä¼šå»è¯»å–å¤§é‡çš„ç£ç›˜æ•°æ®å‘¢ï¼ŸæŒ‰ç…§å‰é¢çŒœæµ‹ï¼Œæˆ‘ä»¬æåˆ°è¿‡ï¼Œè¿™æœ‰å¯èƒ½æ˜¯ä¸ªæ…¢æŸ¥è¯¢é—®é¢˜ã€‚</p><p>å¯æ˜¯ï¼Œå›æƒ³ä¸€ä¸‹ï¼Œæ…¢æŸ¥è¯¢çš„ç°è±¡å¤§å¤šæ˜¯ CPU ä½¿ç”¨ç‡é«˜ï¼ˆæ¯”å¦‚ 100% ï¼‰ï¼Œä½†è¿™é‡Œçœ‹åˆ°çš„å´æ˜¯ I/O é—®é¢˜ã€‚çœ‹æ¥ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå•çº¯çš„æ…¢æŸ¥è¯¢é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰å¿…è¦åˆ†æä¸€ä¸‹ MySQL è¯»å–çš„æ•°æ®ã€‚</p><p>è¦åˆ†æè¿›ç¨‹çš„æ•°æ®è¯»å–ï¼Œå½“ç„¶è¿˜è¦é ä¸Šä¸€èŠ‚ç”¨åˆ°è¿‡çš„ strace+ lsof ç»„åˆã€‚</p><p>æ¥ä¸‹æ¥ï¼Œè¿˜æ˜¯åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œ strace å‘½ä»¤ï¼Œå¹¶ä¸”æŒ‡å®š mysqld çš„è¿›ç¨‹å· 27458ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒMySQL æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹çš„æ•°æ®åº“åº”ç”¨ï¼Œä¸ºäº†ä¸æ¼æ‰è¿™äº›çº¿ç¨‹çš„æ•°æ®è¯»å–æƒ…å†µï¼Œä½ è¦è®°å¾—åœ¨æ‰§è¡Œ stace å‘½ä»¤æ—¶ï¼ŒåŠ ä¸Š -f å‚æ•°ï¼š</p><pre><code>$ strace -f -p 27458\n[pid 28014] read(38, &quot;934EiwT363aak7VtqF1mHGa4LL4Dhbks&quot;..., 131072) = 131072\n[pid 28014] read(38, &quot;hSs7KBDepBqA6m4ce6i6iUfFTeG9Ot9z&quot;..., 20480) = 20480\n[pid 28014] read(38, &quot;NRhRjCSsLLBjTfdqiBRLvN9K6FRfqqLm&quot;..., 131072) = 131072\n[pid 28014] read(38, &quot;AKgsik4BilLb7y6OkwQUjjqGeCTQTaRl&quot;..., 24576) = 24576\n[pid 28014] read(38, &quot;hFMHx7FzUSqfFI22fQxWCpSnDmRjamaW&quot;..., 131072) = 131072\n[pid 28014] read(38, &quot;ajUzLmKqivcDJSkiw7QWf2ETLgvQIpfC&quot;..., 20480) = 20480\n</code></pre><p>è§‚å¯Ÿä¸€ä¼šï¼Œä½ ä¼šå‘ç°ï¼Œçº¿ç¨‹ 28014 æ­£åœ¨è¯»å–å¤§é‡æ•°æ®ï¼Œä¸”è¯»å–æ–‡ä»¶çš„æè¿°ç¬¦ç¼–å·ä¸º 38ã€‚è¿™å„¿çš„ 38 åˆå¯¹åº”ç€å“ªä¸ªæ–‡ä»¶å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸‹é¢çš„ lsof å‘½ä»¤ï¼Œå¹¶ä¸”æŒ‡å®šçº¿ç¨‹å· 28014 ï¼Œå…·ä½“æŸ¥çœ‹è¿™ä¸ªå¯ç–‘çº¿ç¨‹å’Œå¯ç–‘æ–‡ä»¶ï¼š</p><pre><code>$ lsof -p 28014\n</code></pre><p>å¥‡æ€ªçš„æ˜¯ï¼Œlsof å¹¶æ²¡æœ‰ç»™å‡ºä»»ä½•è¾“å‡ºã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ æŸ¥çœ‹ lsof å‘½ä»¤çš„è¿”å›å€¼ï¼Œå°±ä¼šå‘ç°ï¼Œè¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œå¤±è´¥äº†ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ SHELL ä¸­ï¼Œç‰¹æ®Šæ ‡é‡ $? è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤é€€å‡ºæ—¶çš„è¿”å›å€¼ã€‚æŸ¥çœ‹è¿™ä¸ªç‰¹æ®Šæ ‡é‡ï¼Œä½ ä¼šå‘ç°å®ƒçš„è¿”å›å€¼æ˜¯1ã€‚å¯æ˜¯åˆ«å¿˜äº†ï¼Œåœ¨ Linux ä¸­ï¼Œè¿”å›å€¼ä¸º 0 ï¼Œæ‰è¡¨ç¤ºå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚è¿”å›å€¼ä¸º1ï¼Œæ˜¾ç„¶è¡¨æ˜æ‰§è¡Œå¤±è´¥ã€‚</p><pre><code>$ echo $?\n1\n</code></pre><p>ä¸ºä»€ä¹ˆ lsof å‘½ä»¤æ‰§è¡Œå¤±è´¥äº†å‘¢ï¼Ÿè¿™é‡Œå¸Œæœ›ä½ æš‚åœå¾€ä¸‹ï¼Œè‡ªå·±å…ˆæ€è€ƒä¸€ä¸‹åŸå› ã€‚è®°ä½æˆ‘çš„é‚£å¥è¯ï¼Œé‡åˆ°ç°è±¡è§£é‡Šä¸äº†ï¼Œå…ˆå»æŸ¥æŸ¥å·¥å…·æ–‡æ¡£ã€‚</p><p>äº‹å®ä¸Šï¼Œé€šè¿‡æŸ¥è¯¢ lsof çš„æ–‡æ¡£ï¼Œä½ ä¼šå‘ç°ï¼Œ-p å‚æ•°éœ€è¦æŒ‡å®šè¿›ç¨‹å·ï¼Œè€Œæˆ‘ä»¬åˆšæ‰ä¼ å…¥çš„æ˜¯çº¿ç¨‹å·ï¼Œæ‰€ä»¥ lsof å¤±è´¥äº†ã€‚ä½ çœ‹ï¼Œä»»ä½•ä¸€ä¸ªç»†èŠ‚éƒ½å¯èƒ½æˆä¸ºæ€§èƒ½åˆ†æçš„â€œæ‹¦è·¯è™â€ã€‚</p><p>å›è¿‡å¤´æˆ‘ä»¬çœ‹ï¼Œmysqld çš„è¿›ç¨‹å·æ˜¯ 27458ï¼Œè€Œ 28014 åªæ˜¯å®ƒçš„ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œä¸”ï¼Œå¦‚æœä½ è§‚å¯Ÿ ä¸€ä¸‹mysqld è¿›ç¨‹çš„çº¿ç¨‹ï¼Œä½ ä¼šå‘ç°ï¼Œmysqld å…¶å®è¿˜æœ‰å¾ˆå¤šæ­£åœ¨è¿è¡Œçš„å…¶ä»–çº¿ç¨‹ï¼š</p><pre><code># -tè¡¨ç¤ºæ˜¾ç¤ºçº¿ç¨‹ï¼Œ-aè¡¨ç¤ºæ˜¾ç¤ºå‘½ä»¤è¡Œå‚æ•°\n$ pstree -t -a -p 27458\nmysqld,27458 --log_bin=on --sync_binlog=1\n...\n  â”œâ”€{mysqld},27922\n  â”œâ”€{mysqld},27923\n  â””â”€{mysqld},28014\n</code></pre><p>æ‰¾åˆ°äº†åŸå› ï¼Œlsofçš„é—®é¢˜å°±å®¹æ˜“è§£å†³äº†ã€‚æŠŠçº¿ç¨‹å·æ¢æˆè¿›ç¨‹å·ï¼Œç»§ç»­æ‰§è¡Œ lsof å‘½ä»¤ï¼š</p><pre><code>$ lsof -p 27458\nCOMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\n...\nâ€‹mysqld  27458      999   38u   REG    8,1 512440000 2601895 /var/lib/mysql/test/products.MYD\n</code></pre><p>è¿™æ¬¡æˆ‘ä»¬å¾—åˆ°äº†lsofçš„è¾“å‡ºã€‚ä»è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°ï¼Œ mysqld è¿›ç¨‹ç¡®å®æ‰“å¼€äº†å¤§é‡æ–‡ä»¶ï¼Œè€Œæ ¹æ®æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰çš„ç¼–å·ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæè¿°ç¬¦ä¸º 38 çš„æ˜¯ä¸€ä¸ªè·¯å¾„ä¸º /var/lib/mysql/test/products.MYD çš„æ–‡ä»¶ã€‚è¿™é‡Œæ³¨æ„ï¼Œ 38 åé¢çš„ u è¡¨ç¤ºï¼Œ mysqld ä»¥è¯»å†™çš„æ–¹å¼è®¿é—®æ–‡ä»¶ã€‚</p><p>çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œç†Ÿæ‚‰ MySQL çš„ä½ å¯èƒ½ç¬‘äº†ï¼š</p><ul>\n<li>\n<p>MYD æ–‡ä»¶ï¼Œæ˜¯ MyISAM å¼•æ“ç”¨æ¥å­˜å‚¨è¡¨æ•°æ®çš„æ–‡ä»¶ï¼›</p>\n</li>\n<li>\n<p>æ–‡ä»¶åå°±æ˜¯æ•°æ®è¡¨çš„åå­—ï¼›</p>\n</li>\n<li>\n<p>è€Œè¿™ä¸ªæ–‡ä»¶çš„çˆ¶ç›®å½•ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“çš„åå­—ã€‚</p>\n</li>\n</ul><p>æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å‘Šè¯‰æˆ‘ä»¬ï¼Œmysqld åœ¨è¯»å–æ•°æ®åº“ test ä¸­çš„ products è¡¨ã€‚</p><p>å®é™…ä¸Šï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹ mysqld åœ¨ç®¡ç†æ•°æ®åº“ test æ—¶çš„å­˜å‚¨æ–‡ä»¶ã€‚ä¸è¿‡è¦æ³¨æ„ï¼Œç”±äº MySQL è¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œä½ éœ€è¦é€šè¿‡ docker exec åˆ°å®¹å™¨ä¸­æŸ¥çœ‹ï¼š</p><pre><code>$ docker exec -it mysql ls /var/lib/mysql/test/\ndb.opt    products.MYD  products.MYI  products.frm\n</code></pre><p>ä»è¿™é‡Œä½ å¯ä»¥å‘ç°ï¼Œ/var/lib/mysql/test/ ç›®å½•ä¸­æœ‰å››ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p><ul>\n<li>\n<p>MYD æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„æ•°æ®ï¼›</p>\n</li>\n<li>\n<p>MYI æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„ç´¢å¼•ï¼›</p>\n</li>\n<li>\n<p>frm æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚è¡¨ç»“æ„ï¼‰ï¼›</p>\n</li>\n<li>\n<p>opt æ–‡ä»¶åˆ™ç”¨æ¥å­˜å‚¨æ•°æ®åº“çš„å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å­—ç¬¦é›†ã€å­—ç¬¦æ ¡éªŒè§„åˆ™ç­‰ï¼‰ã€‚</p>\n</li>\n</ul><p>å½“ç„¶ï¼Œçœ‹åˆ°è¿™äº›ï¼Œä½ å¯èƒ½è¿˜æœ‰ä¸€ä¸ªç–‘é—®ï¼Œé‚£å°±æ˜¯ï¼Œè¿™äº›æ–‡ä»¶åˆ°åº•æ˜¯ä¸æ˜¯ mysqld æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–‡ä»¶å‘¢ï¼Ÿæœ‰æ²¡æœ‰å¯èƒ½æ˜¯ä¸å†ä½¿ç”¨çš„æ—§æ•°æ®å‘¢ï¼Ÿå…¶å®ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç¡®è®¤ï¼ŒæŸ¥ä¸€ä¸‹ mysqld é…ç½®çš„æ•°æ®è·¯å¾„å³å¯ã€‚</p><p>ä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code>$ docker exec -i -t mysql mysql -e 'show global variables like &quot;%datadir%&quot;;'\n+---------------+-----------------+\n| Variable_name | Value           |\n+---------------+-----------------+\n| datadir       | /var/lib/mysql/ |\n+---------------+-----------------+\n</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ/var/lib/mysql/ ç¡®å®æ˜¯ mysqld æ­£åœ¨ä½¿ç”¨çš„æ•°æ®å­˜å‚¨ç›®å½•ã€‚åˆšæ‰åˆ†æå¾—å‡ºçš„æ•°æ®åº“ test å’Œæ•°æ®è¡¨ products ï¼Œéƒ½æ˜¯æ­£åœ¨ä½¿ç”¨ã€‚</p><blockquote>\n<p>æ³¨ï¼šå…¶å® lsof çš„ç»“æœå·²ç»å¯ä»¥ç¡®è®¤ï¼Œå®ƒä»¬éƒ½æ˜¯ mysqld æ­£åœ¨è®¿é—®çš„æ–‡ä»¶ã€‚å†æŸ¥è¯¢ datadir ï¼Œåªæ˜¯æƒ³æ¢ä¸€ä¸ªæ€è·¯ï¼Œè¿›ä¸€æ­¥ç¡®è®¤ä¸€ä¸‹ã€‚</p>\n</blockquote><p>æ—¢ç„¶å·²ç»æ‰¾å‡ºäº†æ•°æ®åº“å’Œè¡¨ï¼Œæ¥ä¸‹æ¥è¦åšçš„ï¼Œå°±æ˜¯å¼„æ¸…æ¥šæ•°æ®åº“ä¸­æ­£åœ¨æ‰§è¡Œä»€ä¹ˆæ ·çš„ SQL äº†ã€‚æˆ‘ä»¬ç»§ç»­åœ¨ç»ˆç«¯ä¸€ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ docker exec å‘½ä»¤ï¼Œè¿›å…¥ MySQL çš„å‘½ä»¤è¡Œç•Œé¢ï¼š</p><pre><code>$ docker exec -i -t mysql mysql\n...\nâ€‹\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\nâ€‹\nmysql&gt;\n</code></pre><p>ä¸‹ä¸€æ­¥ä½ åº”è¯¥å¯ä»¥æƒ³åˆ°ï¼Œé‚£å°±æ˜¯åœ¨ MySQL å‘½ä»¤è¡Œç•Œé¢ä¸­ï¼Œæ‰§è¡Œ show processlist å‘½ä»¤ï¼Œæ¥æŸ¥çœ‹å½“å‰æ­£åœ¨æ‰§è¡Œçš„ SQL è¯­å¥ã€‚</p><p>ä¸è¿‡ï¼Œä¸ºäº†ä¿è¯ SQL è¯­å¥ä¸æˆªæ–­ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ show full processlist å‘½ä»¤ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><pre><code>mysql&gt; show full processlist;\n+----+------+-----------------+------+---------+------+--------------+-----------------------------------------------------+\n| Id | User | Host            | db   | Command | Time | State        | Info                                                |\n+----+------+-----------------+------+---------+------+--------------+-----------------------------------------------------+\n| 27 | root | localhost       | test | Query   |    0 | init         | show full processlist                               |\n| 28 | root | 127.0.0.1:42262 | test | Query   |    1 | Sending data | select * from products where productName='geektime' |\n+----+------+-----------------+------+---------+------+--------------+-----------------------------------------------------+\n2 rows in set (0.00 sec)\n</code></pre><p>è¿™ä¸ªè¾“å‡ºä¸­ï¼Œ</p><ul>\n<li>\n<p>db è¡¨ç¤ºæ•°æ®åº“çš„åå­—ï¼›</p>\n</li>\n<li>\n<p>Command è¡¨ç¤º SQL ç±»å‹ï¼›</p>\n</li>\n<li>\n<p>Time è¡¨ç¤ºæ‰§è¡Œæ—¶é—´ï¼›</p>\n</li>\n<li>\n<p>State è¡¨ç¤ºçŠ¶æ€ï¼›</p>\n</li>\n<li>\n<p>è€Œ Info åˆ™åŒ…å«äº†å®Œæ•´çš„ SQL è¯­å¥ã€‚</p>\n</li>\n</ul><p>å¤šæ‰§è¡Œå‡ æ¬¡ show full processlist å‘½ä»¤ï¼Œä½ å¯çœ‹åˆ° select * from products where productName=â€˜geektimeâ€™ è¿™æ¡ SQL è¯­å¥çš„æ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ã€‚</p><p>å†å›å¿†ä¸€ä¸‹ï¼Œæ¡ˆä¾‹å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯äºŒæŸ¥è¯¢çš„äº§å“åç§° <a href=\"http://192.168.0.10:10000/products/geektime\">http://192.168.0.10:10000/products/geektime</a>ï¼Œå…¶ä¸­çš„ geektime ä¹Ÿç¬¦åˆè¿™æ¡æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒMySQL çš„æ…¢æŸ¥è¯¢é—®é¢˜ï¼Œå¾ˆå¯èƒ½æ˜¯æ²¡æœ‰åˆ©ç”¨å¥½ç´¢å¼•å¯¼è‡´çš„ï¼Œé‚£è¿™æ¡æŸ¥è¯¢è¯­å¥æ˜¯ä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿæˆ‘ä»¬åˆè¯¥æ€ä¹ˆç¡®è®¤ï¼ŒæŸ¥è¯¢è¯­å¥æ˜¯å¦åˆ©ç”¨äº†ç´¢å¼•å‘¢ï¼Ÿ</p><p>å…¶å®ï¼ŒMySQL å†…ç½®çš„ explain å‘½ä»¤ï¼Œå°±å¯ä»¥å¸®ä½ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç»§ç»­åœ¨ MySQL ç»ˆç«¯ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ explain å‘½ä»¤ï¼š</p><pre><code># åˆ‡æ¢åˆ°teståº“\nmysql&gt; use test;\n# æ‰§è¡Œexplainå‘½ä»¤\nmysql&gt; explain select * from products where productName='geektime';\n+----+-------------+----------+------+---------------+------+---------+------+-------+-------------+\n| id | select_type | table    | type | possible_keys | key  | key_len | ref  | rows  | Extra       |\n+----+-------------+----------+------+---------------+------+---------+------+-------+-------------+\n|  1 | SIMPLE      | products | ALL  | NULL          | NULL | NULL    | NULL | 10000 | Using where |\n+----+-------------+----------+------+---------------+------+---------+------+-------+-------------+\n1 row in set (0.00 sec)\n</code></pre><p>è§‚å¯Ÿè¿™æ¬¡çš„è¾“å‡ºã€‚è¿™ä¸ªç•Œé¢ä¸­ï¼Œæœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å­—æ®µéœ€è¦ä½ æ³¨æ„ï¼Œæˆ‘å°±ä»¥è¿™ä¸ªè¾“å‡ºä¸ºä¾‹ï¼Œåˆ†åˆ«è§£é‡Šä¸€ä¸‹ï¼š</p><ul>\n<li>\n<p>select_type è¡¨ç¤ºæŸ¥è¯¢ç±»å‹ï¼Œè€Œè¿™é‡Œçš„SIMPLE è¡¨ç¤ºæ­¤æŸ¥è¯¢ä¸åŒ…æ‹¬ UNION æŸ¥è¯¢æˆ–è€…å­æŸ¥è¯¢ï¼›</p>\n</li>\n<li>\n<p>table è¡¨ç¤ºæ•°æ®è¡¨çš„åå­—ï¼Œè¿™é‡Œæ˜¯ productsï¼›</p>\n</li>\n<li>\n<p>type è¡¨ç¤ºæŸ¥è¯¢ç±»å‹ï¼Œè¿™é‡Œçš„ ALL è¡¨ç¤ºå…¨è¡¨æŸ¥è¯¢ï¼Œä½†ç´¢å¼•æŸ¥è¯¢åº”è¯¥æ˜¯ index ç±»å‹æ‰å¯¹ï¼›</p>\n</li>\n<li>\n<p>possible_keys è¡¨ç¤ºå¯èƒ½é€‰ç”¨çš„ç´¢å¼•ï¼Œè¿™é‡Œæ˜¯ NULLï¼›</p>\n</li>\n<li>\n<p>key è¡¨ç¤ºç¡®åˆ‡ä¼šä½¿ç”¨çš„ç´¢å¼•ï¼Œè¿™é‡Œä¹Ÿæ˜¯ NULLï¼›</p>\n</li>\n<li>\n<p>rows è¡¨ç¤ºæŸ¥è¯¢æ‰«æçš„è¡Œæ•°ï¼Œè¿™é‡Œæ˜¯ 10000ã€‚</p>\n</li>\n</ul><p>æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šï¼Œè¿™æ¡æŸ¥è¯¢è¯­å¥å‹æ ¹å„¿æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢æ—¶ï¼Œä¼šæ‰«æå…¨è¡¨ï¼Œå¹¶ä¸”æ‰«æè¡Œæ•°é«˜è¾¾ 10000 è¡Œã€‚å“åº”é€Ÿåº¦é‚£ä¹ˆæ…¢ä¹Ÿå°±éš¾æ€ªäº†ã€‚</p><p>èµ°åˆ°è¿™ä¸€æ­¥ï¼Œä½ åº”è¯¥å¾ˆå®¹æ˜“æƒ³åˆ°ä¼˜åŒ–æ–¹æ³•ï¼Œæ²¡æœ‰ç´¢å¼•é‚£æˆ‘ä»¬å°±è‡ªå·±å»ºç«‹ï¼Œç»™ productName å»ºç«‹ç´¢å¼•å°±å¯ä»¥äº†ã€‚ä¸è¿‡ï¼Œå¢åŠ ç´¢å¼•å‰ï¼Œä½ éœ€è¦å…ˆå¼„æ¸…æ¥šï¼Œè¿™ä¸ªè¡¨ç»“æ„åˆ°åº•é•¿ä»€ä¹ˆæ ·å„¿ã€‚</p><p>æ‰§è¡Œä¸‹é¢çš„ MySQL å‘½ä»¤ï¼ŒæŸ¥è¯¢ products è¡¨çš„ç»“æ„ï¼Œä½ ä¼šçœ‹åˆ°ï¼Œå®ƒåªæœ‰ä¸€ä¸ª id ä¸»é”®ï¼Œå¹¶ä¸åŒ…æ‹¬ productName çš„ç´¢å¼•ï¼š</p><pre><code>mysql&gt; show create table products;\n...\n| products | CREATE TABLE `products` (\n  `id` int(11) NOT NULL,\n  `productCode` text NOT NULL COMMENT 'äº§å“ä»£ç ',\n  `productName` text NOT NULL COMMENT 'äº§å“åç§°',\n...\n  PRIMARY KEY (`id`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC |\n...\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™ productName å»ºç«‹ç´¢å¼•äº†ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œä¸‹é¢çš„ CREATE INDEX å‘½ä»¤ï¼š</p><pre><code>mysql&gt; CREATE INDEX products_index ON products (productName);\nERROR 1170 (42000): BLOB/TEXT column 'productName' used in key specification without a key length\n</code></pre><p>ä¸è¿‡ï¼Œé†’ç›®çš„ERRORå‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™æ¡å‘½ä»¤è¿è¡Œå¤±è´¥äº†ã€‚æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼ŒproductName æ˜¯ä¸€ä¸ª BLOB/TEXT ç±»å‹ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªé•¿åº¦ã€‚æ‰€ä»¥ï¼Œæƒ³è¦åˆ›å»ºç´¢å¼•ï¼Œå°±å¿…é¡»ä¸º productName æŒ‡å®šä¸€ä¸ªå‰ç¼€é•¿åº¦ã€‚</p><p>é‚£å‰ç¼€é•¿åº¦è®¾ç½®ä¸ºå¤šå¤§æ¯”è¾ƒåˆé€‚å‘¢ï¼Ÿè¿™é‡Œå…¶å®æœ‰ä¸“é—¨çš„ç®—æ³•ï¼Œå³é€šè¿‡è®¡ç®—å‰ç¼€é•¿åº¦çš„é€‰æ‹©æ€§ï¼Œæ¥ç¡®å®šç´¢å¼•çš„é•¿åº¦ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®ç®€åŒ–ä¸€ä¸‹ï¼Œç›´æ¥ä½¿ç”¨ä¸€ä¸ªå›ºå®šæ•°å€¼ï¼ˆæ¯”å¦‚ 64ï¼‰ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ›å»ºç´¢å¼•ï¼š</p><pre><code>mysql&gt; CREATE INDEX products_index ON products (productName(64));\nQuery OK, 10000 rows affected (14.45 sec)\nRecords: 10000  Duplicates: 0  Warnings: 0\n</code></pre><p>ç°åœ¨å¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼•å·²ç»å»ºå¥½äº†ã€‚èƒ½åšçš„éƒ½åšå®Œäº†ï¼Œæœ€åå°±è¯¥æ£€æŸ¥ä¸€ä¸‹ï¼Œæ€§èƒ½é—®é¢˜æ˜¯å¦å·²ç»è§£å†³äº†ã€‚</p><p>æˆ‘ä»¬åˆ‡æ¢åˆ°ç»ˆç«¯äºŒä¸­ï¼ŒæŸ¥çœ‹è¿˜åœ¨æ‰§è¡Œçš„ curl å‘½ä»¤çš„ç»“æœï¼š</p><pre><code>Got data: ()in 15.383180141448975 sec\nGot data: ()in 15.384996891021729 sec\nGot data: ()in 0.0021054744720458984 sec\nGot data: ()in 0.003951072692871094 sec\n</code></pre><p>æ˜¾ç„¶ï¼ŒæŸ¥è¯¢æ—¶é—´å·²ç»ä» 15 ç§’ç¼©çŸ­åˆ°äº† 3 æ¯«ç§’ã€‚çœ‹æ¥ï¼Œæ²¡æœ‰ç´¢å¼•æœç„¶å°±æ˜¯è¿™æ¬¡æ€§èƒ½é—®é¢˜çš„ç½ªé­ç¥¸é¦–ï¼Œè§£å†³äº†ç´¢å¼•ï¼Œå°±è§£å†³äº†æŸ¥è¯¢æ…¢çš„é—®é¢˜ã€‚</p><h2>æ¡ˆä¾‹æ€è€ƒ</h2><p>åˆ°è¿™é‡Œï¼Œå•†å“æœç´¢åº”ç”¨æŸ¥è¯¢æ…¢çš„é—®é¢˜å·²ç»å®Œç¾è§£å†³äº†ã€‚ä½†æ˜¯ï¼Œå¯¹äºè¿™ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘è¿˜æœ‰ä¸€ç‚¹æƒ³è¯´æ˜ä¸€ä¸‹ã€‚</p><p>ä¸çŸ¥é“ä½ è¿˜è®°ä¸è®°å¾—ï¼Œæ¡ˆä¾‹å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¯åŠ¨çš„å‡ ä¸ªå®¹å™¨åº”ç”¨ã€‚é™¤äº† MySQL å’Œå•†å“æœç´¢åº”ç”¨å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª DataService åº”ç”¨ã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªæ¡ˆä¾‹å¼€å§‹æ—¶ï¼Œè¦è¿è¡Œä¸€ä¸ªçœ‹èµ·æ¥æ¯«ä¸ç›¸å…³çš„åº”ç”¨å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼ŒDataService æ˜¯ä¸€ä¸ªä¸¥é‡å½±å“ MySQL æ€§èƒ½çš„å¹²æ‰°åº”ç”¨ã€‚æŠ›å¼€ä¸Šè¿°ç´¢å¼•ä¼˜åŒ–æ–¹æ³•ä¸è¯´ï¼Œè¿™ä¸ªæ¡ˆä¾‹è¿˜æœ‰ä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœæ­¢ DataService åº”ç”¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±åˆ é™¤æ•°æ®åº“ç´¢å¼•ï¼Œå›åˆ°åŸæ¥çš„çŠ¶æ€ï¼›ç„¶ååœæ­¢ DataService åº”ç”¨ï¼Œçœ‹çœ‹ä¼˜åŒ–æ•ˆæœå¦‚ä½•ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯äºŒä¸­åœæ­¢ curl å‘½ä»¤ï¼Œç„¶åå›åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤åˆ é™¤ç´¢å¼•ï¼š</p><pre><code># åˆ é™¤ç´¢å¼•\n$ docker exec -i -t mysql mysql\nâ€‹\nmysql&gt; use test;\nmysql&gt; DROP INDEX products_index ON products;\n</code></pre><p>æ¥ç€ï¼Œåœ¨ç»ˆç«¯äºŒä¸­é‡æ–°è¿è¡Œ curl å‘½ä»¤ã€‚å½“ç„¶ï¼Œè¿™æ¬¡ä½ ä¼šå‘ç°ï¼Œå¤„ç†æ—¶é—´åˆå˜æ…¢äº†ï¼š</p><pre><code>$ while true; do curl http://192.168.0.10:10000/products/geektime; sleep 5; done\nGot data: ()in 16.884345054626465 sec\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œå†æ¬¡å›åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåœæ­¢ DataService åº”ç”¨ï¼š</p><pre><code># åœæ­¢ DataService åº”ç”¨\n$ docker rm -f dataservice\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬å›åˆ°ç»ˆç«¯äºŒä¸­ï¼Œè§‚å¯Ÿ curl çš„ç»“æœï¼š</p><pre><code>Got data: ()in 16.884345054626465 sec\nGot data: ()in 15.238174200057983 sec\nGot data: ()in 0.12604427337646484 sec\nGot data: ()in 0.1101069450378418 sec\nGot data: ()in 0.11235237121582031 sec\n</code></pre><p>æœç„¶ï¼Œåœæ­¢ DataService åï¼Œå¤„ç†æ—¶é—´ä» 15 ç§’ç¼©çŸ­åˆ°äº† 0.1 ç§’ï¼Œè™½ç„¶æ¯”ä¸ä¸Šå¢åŠ ç´¢å¼•åçš„ 3 æ¯«ç§’ï¼Œä½†ç›¸å¯¹äº 15 ç§’æ¥è¯´ï¼Œä¼˜åŒ–æ•ˆæœè¿˜æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æœ‰æ²¡æœ‰ I/O ç“¶é¢ˆäº†å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬åˆ‡æ¢åˆ°ç»ˆç«¯ä¸€ä¸­ï¼Œè¿è¡Œä¸‹é¢çš„ vmstat å‘½ä»¤ï¼ˆæ³¨æ„ä¸æ˜¯ iostatï¼Œç¨åè§£é‡ŠåŸå› ï¼‰ï¼Œè§‚å¯Ÿ I/O çš„å˜åŒ–æƒ…å†µï¼š</p><pre><code>$ vmstat 1\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 0  1      0 6809304   1368 856744    0    0 32640     0   52  478  1  0 50 49  0\n 0  1      0 6776620   1368 889456    0    0 32640     0   33  490  0  0 50 49  0\n 0  0      0 6747540   1368 918576    0    0 29056     0   42  568  0  0 56 44  0\n 0  0      0 6747540   1368 918576    0    0     0     0   40  141  1  0 100  0  0\n 0  0      0 6747160   1368 918576    0    0     0     0   40  148  0  1 99  0  0\n</code></pre><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œç£ç›˜è¯»ï¼ˆbiï¼‰å’Œ iowaitï¼ˆwaï¼‰åˆšå¼€å§‹è¿˜æ˜¯æŒºå¤§çš„ï¼Œä½†æ²¡è¿‡å¤šä¹…ï¼Œå°±éƒ½å˜æˆäº† 0 ã€‚æ¢å¥è¯è¯´ï¼ŒI/O ç“¶é¢ˆæ¶ˆå¤±äº†ã€‚</p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› å…ˆç•™ä¸ªæ‚¬å¿µï¼Œä½œä¸ºä»Šå¤©çš„æ€è€ƒé¢˜ã€‚</p><p>å›è¿‡å¤´æ¥è§£é‡Šä¸€ä¸‹åˆšåˆšçš„æ“ä½œï¼Œåœ¨æŸ¥çœ‹ I/O æƒ…å†µæ—¶ï¼Œæˆ‘å¹¶æ²¡ç”¨ iostat å‘½ä»¤ï¼Œè€Œæ˜¯ç”¨äº† vmstatã€‚å…¶å®ï¼Œç›¸å¯¹äº iostat æ¥è¯´ï¼Œvmstat å¯ä»¥åŒæ—¶æä¾› CPUã€å†…å­˜å’Œ I/O çš„ä½¿ç”¨æƒ…å†µã€‚</p><p>åœ¨æ€§èƒ½åˆ†æè¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿç»¼åˆå¤šä¸ªæŒ‡æ ‡ï¼Œå¹¶ç»“åˆç³»ç»Ÿçš„å·¥ä½œåŸç†è¿›è¡Œåˆ†æï¼Œå¯¹è§£é‡Šæ€§èƒ½ç°è±¡é€šå¸¸ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„å¸®åŠ©ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬åˆ†æäº†ä¸€ä¸ªå•†å“æœç´¢çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å…ˆæ˜¯é€šè¿‡ topã€iostat åˆ†æäº†ç³»ç»Ÿçš„ CPU å’Œç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œå‘ç°äº†ç£ç›˜çš„ I/O ç“¶é¢ˆã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬å€ŸåŠ© pidstat ï¼Œå‘ç°ç“¶é¢ˆæ˜¯ mysqld å¯¼è‡´çš„ã€‚ç´§æ¥ç€ï¼Œæˆ‘ä»¬åˆé€šè¿‡ straceã€lsofï¼Œæ‰¾å‡ºäº† mysqld æ­£åœ¨è¯»çš„æ–‡ä»¶ã€‚åŒæ—¶ï¼Œæ ¹æ®æ–‡ä»¶çš„åå­—å’Œè·¯å¾„ï¼Œæˆ‘ä»¬æ‰¾å‡ºäº† mysqld æ­£åœ¨æ“ä½œçš„æ•°æ®åº“å’Œæ•°æ®è¡¨ã€‚ç»¼åˆè¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬åˆ¤æ–­ï¼Œè¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰åˆ©ç”¨ç´¢å¼•å¯¼è‡´çš„æ…¢æŸ¥è¯¢é—®é¢˜ã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬ç™»å½•åˆ° MySQL å‘½ä»¤è¡Œç»ˆç«¯ï¼Œç”¨æ•°æ®åº“åˆ†æå·¥å…·è¿›è¡ŒéªŒè¯ï¼Œå‘ç° MySQL æŸ¥è¯¢è¯­å¥è®¿é—®çš„å­—æ®µï¼Œæœç„¶æ²¡æœ‰ç´¢å¼•ã€‚æ‰€ä»¥ï¼Œå¢åŠ ç´¢å¼•ï¼Œå°±å¯ä»¥è§£å†³æ¡ˆä¾‹çš„æ€§èƒ½é—®é¢˜äº†ã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨æ¡ˆä¾‹æœ€åéƒ¨åˆ†æåˆ°è¿‡çš„ï¼Œåœæ­¢ DataService åï¼Œå•†å“æœç´¢åº”ç”¨çš„å¤„ç†æ—¶é—´ï¼Œä» 15 ç§’ç¼©çŸ­åˆ°äº† 0.1 ç§’ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ç»™ä¸ªå°å°çš„æç¤ºã€‚ä½ å¯ä»¥å…ˆæŸ¥çœ‹ <a href=\"http://dataservice.py\">dataservice.py</a> çš„<a href=\"https://github.com/feiskyer/linux-perf-examples/blob/master/mysql-slow/dataservice.py\">æºç </a>ï¼Œä½ ä¼šå‘ç°ï¼ŒDataService å®é™…ä¸Šæ˜¯åœ¨è¯»å†™ä¸€ä¸ªä»…åŒ…æ‹¬ â€œdataâ€ å­—ç¬¦ä¸²çš„å°æ–‡ä»¶ã€‚ä¸è¿‡åœ¨è¯»å–æ–‡ä»¶å‰ï¼Œå®ƒä¼šå…ˆæŠŠ /proc/sys/vm/drop_caches æ”¹æˆ 1ã€‚</p><p>è¿˜è®°å¾—è¿™ä¸ªæ“ä½œæœ‰ä»€ä¹ˆä½œç”¨å—ï¼Ÿå¦‚æœä¸è®°å¾—ï¼Œå¯ä»¥ç”¨ man æŸ¥è¯¢ proc æ–‡ä»¶ç³»ç»Ÿçš„æ–‡æ¡£ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","comments":[{"had_liked":false,"id":62887,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1548202814,"is_pvip":false,"replies":[{"id":"22341","content":"èµï¼Œæ­£è§£","user_name":"ä½œè€…å›å¤","comment_id":62887,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252127,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"426749965118","product_id":100020901,"comment_content":"æ‰“å¡day29<br>echo 1&gt;&#47;proc&#47;sys&#47;vm&#47;drop_cachesè¡¨ç¤ºé‡Šæ”¾pagecacheï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ç¼“å­˜ï¼Œè€Œmysqlè¯»ä¹¦çš„æ•°æ®å°±æ˜¯æ–‡ä»¶ç¼“å­˜ï¼Œdataserviceä¸åœçš„é‡Šæ”¾æ–‡ä»¶ç¼“å­˜ï¼Œå°±å¯¼è‡´MySQLéƒ½æ— æ³•åˆ©ç”¨ç£ç›˜ç¼“å­˜ï¼Œä¹Ÿå°±æ…¢äº†ï½","like_count":100,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437385,"discussion_content":"èµï¼Œæ­£è§£","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1548252127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284474,"avatar":"https://static001.geekbang.org/account/avatar/00/13/99/7a/558666a5.jpg","nickname":"AceslupK","note":"","ucode":"048F84D019CBBB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392143,"discussion_content":"å¯æœ‰å®šä½åˆ°DataServiceåº”ç”¨çš„ç—•è¿¹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630854746,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":66093,"user_name":"å¤§åç‹ç‹¸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1549876237,"is_pvip":false,"replies":[{"id":"23699","content":"èµï¼Œè°¢è°¢åˆ†äº«è¯¦ç»†çš„å‰ç¼€é€‰æ‹©ç®—æ³•","user_name":"ä½œè€…å›å¤","comment_id":66093,"uid":"1001282","ip_address":"","utype":1,"ctime":1550067893,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"190528437261","product_id":100020901,"comment_content":"è¿™ä¸ªåœ°æ–¹å› ä¸ºä¹‹å‰äº†è§£è¿‡ï¼Œæ‰€ä»¥æ¥æ‰“ä¸ªå¡ï¼Œè¿™ä¸ªç®—æ³•åœ¨é«˜æ€§èƒ½mysqlé‡Œæœ‰ä»‹ç»ï¼Œå«æœ€ä¼˜å‰ç¼€.<br>æœ‰æ—¶å€™éœ€è¦ç´¢å¼•å¾ˆé•¿çš„å­—ç¬¦åˆ—ï¼Œè¿™ä¼šè®©ç´¢å¼•å˜å¾—å¤§ä¸”æ…¢ã€‚é€šå¸¸å¯ä»¥ç´¢å¼•å¼€å§‹çš„éƒ¨åˆ†å­—ç¬¦ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§èŠ‚çº¦ç´¢å¼•ç©ºé—´ï¼Œä»è€Œæé«˜ç´¢å¼•æ•ˆç‡ã€‚ä½†è¿™æ ·ä¹Ÿä¼šé™ä½ç´¢å¼•çš„é€‰æ‹©æ€§ã€‚ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯æŒ‡ä¸é‡å¤çš„ç´¢å¼•å€¼ï¼ˆä¹Ÿç§°ä¸ºåŸºæ•°ï¼Œcardinality)å’Œæ•°æ®è¡¨çš„è®°å½•æ€»æ•°çš„æ¯”å€¼ï¼ŒèŒƒå›´ä»1&#47;#Tåˆ°1ä¹‹é—´ã€‚ç´¢å¼•çš„é€‰æ‹©æ€§è¶Šé«˜åˆ™æŸ¥è¯¢æ•ˆç‡è¶Šé«˜ï¼Œå› ä¸ºé€‰æ‹©æ€§é«˜çš„ç´¢å¼•å¯ä»¥è®©MySQLåœ¨æŸ¥æ‰¾æ—¶è¿‡æ»¤æ‰æ›´å¤šçš„è¡Œã€‚å”¯ä¸€ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯1ï¼Œè¿™æ˜¯æœ€å¥½çš„ç´¢å¼•é€‰æ‹©æ€§ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚<br><br>ä¸€èˆ¬æƒ…å†µä¸‹æŸä¸ªå‰ç¼€çš„é€‰æ‹©æ€§ä¹Ÿæ˜¯è¶³å¤Ÿé«˜çš„ï¼Œè¶³ä»¥æ»¡è¶³æŸ¥è¯¢æ€§èƒ½ã€‚å¯¹äºBLOBï¼ŒTEXTï¼Œæˆ–è€…å¾ˆé•¿çš„VARCHARç±»å‹çš„åˆ—ï¼Œå¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå› ä¸ºMySQLä¸å…è®¸ç´¢å¼•è¿™äº›åˆ—çš„å®Œæ•´é•¿åº¦ã€‚<br><br>è¯€çªåœ¨äºè¦é€‰æ‹©è¶³å¤Ÿé•¿çš„å‰ç¼€ä»¥ä¿è¯è¾ƒé«˜çš„é€‰æ‹©æ€§ï¼ŒåŒæ—¶åˆä¸èƒ½å¤ªé•¿ï¼ˆä»¥ä¾¿èŠ‚çº¦ç©ºé—´ï¼‰ã€‚å‰ç¼€åº”è¯¥è¶³å¤Ÿé•¿ï¼Œä»¥ä½¿å¾—å‰ç¼€ç´¢å¼•çš„é€‰æ‹©æ€§æ¥è¿‘äºç´¢å¼•çš„æ•´ä¸ªåˆ—ã€‚æ¢å¥è¯è¯´ï¼Œå‰ç¼€çš„â€åŸºæ•°â€œåº”è¯¥æ¥è¿‘äºå®Œæ•´çš„åˆ—çš„â€åŸºæ•°â€œã€‚<br>select count(distinct city)&#47;count(*) from city_demo; æ ¹æ®è¿™ä¸ªç®—å‡ºä¸€ä¸ªæ¯”ä¾‹ï¼Œç„¶å count(distinct left(city,3)) æŠŠè¿™ä¸ª3é€æ¸çš„åŠ å¤§ï¼Œä¸€ç›´åˆ°ç®—å‡ºæ¥çš„æ•°å€¼æ¥è¿‘ä¸Šé¢çš„æ¯”ä¾‹ï¼Œè¿™æ ·ç®—å‡ºæ¥çš„å‰ç¼€ç´¢å¼•æ˜¯æ€§èƒ½æœ€å¥½çš„ã€‚<br>","like_count":45,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438701,"discussion_content":"èµï¼Œè°¢è°¢åˆ†äº«è¯¦ç»†çš„å‰ç¼€é€‰æ‹©ç®—æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550067893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126072,"user_name":"ç‹æ˜Ÿæ——","can_delete":false,"product_type":"c1","uid":1026042,"ip_address":"","ucode":"F1C742527D3A05","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a7/fa/1dca9fd5.jpg","comment_is_top":false,"comment_ctime":1566305931,"is_pvip":false,"replies":[{"id":"47213","content":"æ‰§è¡Œå‘½ä»¤ä¹Ÿéœ€è¦IOæ“ä½œï¼ˆæ¯”å¦‚è¯»ç›®å½•æ‰¾åˆ°binaryï¼ŒåŠ è½½å‘½ä»¤å’Œä¾èµ–çš„åº“ç­‰ç­‰ï¼‰","user_name":"ä½œè€…å›å¤","comment_id":126072,"uid":"1001282","ip_address":"","utype":1,"ctime":1566743989,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"108940488331","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜å•Šï¼Œæ—¢ç„¶åªæ˜¯iowaitå æ¯”é«˜ï¼Œcpuå æ¯”ä¸é«˜ï¼Œä¸ºä»€ä¹ˆæ‰§è¡Œå…¶å®ƒå‘½ä»¤ä¼šæ„Ÿè§‰å¡å‘¢ï¼Ÿåœ¨ç­‰å¾…ioçš„æ—¶å€™ï¼ŒCPUä¸åº”è¯¥å»æ‰§è¡Œå…¶å®ƒè¿›ç¨‹å—ï¼Ÿ","like_count":26,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463814,"discussion_content":"æ‰§è¡Œå‘½ä»¤ä¹Ÿéœ€è¦IOæ“ä½œï¼ˆæ¯”å¦‚è¯»ç›®å½•æ‰¾åˆ°binaryï¼ŒåŠ è½½å‘½ä»¤å’Œä¾èµ–çš„åº“ç­‰ç­‰ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566743989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83033,"user_name":"rm -rf ğŸ˜Šà½²","can_delete":false,"product_type":"c1","uid":1070908,"ip_address":"","ucode":"BC448EC4206D95","user_header":"https://static001.geekbang.org/account/avatar/00/10/57/3c/081b89ec.jpg","comment_is_top":false,"comment_ctime":1554378503,"is_pvip":false,"replies":[{"id":"30190","content":"æ•°æ®åº“çš„ç¼“å­˜è¿˜è¦çœ‹é€‰æ‹©äº†å­˜å‚¨å¼•æ“ï¼ŒMyISAMä¸ä¼šç¼“å­˜æ•°æ®","user_name":"ä½œè€…å›å¤","comment_id":83033,"uid":"1001282","ip_address":"","utype":1,"ctime":1554639075,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"83158757127","product_id":100020901,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼Œè€å¸ˆä¹‹å‰ä¸æ˜¯è¯´è¿‡æ•°æ®åº“æœ‰è‡ªå·±ä¸€å¥—ç¼“å­˜æœºåˆ¶å—ï¼Ÿä¸ºä½•åˆ é™¤cachedä¹Ÿä¼šå½±å“åˆ°mysqlçš„è¯»å†™å‘¢","like_count":20,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445825,"discussion_content":"æ•°æ®åº“çš„ç¼“å­˜è¿˜è¦çœ‹é€‰æ‹©äº†å­˜å‚¨å¼•æ“ï¼ŒMyISAMä¸ä¼šç¼“å­˜æ•°æ®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554639075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543040,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/80/8702bd5f.jpg","nickname":"evan","note":"","ucode":"491B073D5AFEDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":317981,"discussion_content":"å°±ç®—æ˜¯innodb, ä¸å‘½ä¸­ç´¢å¼•, åœ¨myqlæ•°æ®è¡¨å¤šæ•°æ®è®°å½•å¤§çš„æƒ…å†µä¸‹, ä¹Ÿä¸ä¼šå°†æ•´ä¸ªè¡¨ç¼“å­˜è¿›buffer, è¿˜æ˜¯æœ‰å¯èƒ½ä¼šäº§ç”Ÿéšæœºio, ä¹Ÿä¼šå·¨æ…¢..","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1603625613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63310,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":false,"comment_ctime":1548320239,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"65972829679","product_id":100020901,"comment_content":"éå¸¸èµï¼Œè¿™ç¯‡æ¡ˆä¾‹å¾ˆå¥½çš„å±•ç¤ºäº†æ€ä¹ˆä»æ“ä½œç³»ç»Ÿå±‚é¢å»æ’æŸ¥æ…¢æŸ¥è¯¢çš„é—®é¢˜","like_count":15,"discussions":[{"author":{"id":2265187,"avatar":"","nickname":"ä¸Šå–„è‹¥æ°´","note":"","ucode":"219C6C9B75054A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":322260,"discussion_content":"ç›´æ¥çœ‹ä»£ç å²‚ä¸æ˜¯å¾ˆå¿«å°±å‘ç°æ²¡ç”¨ç´¢å¼•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604714959,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2131606,"avatar":"","nickname":"Geek_da4cfb","note":"","ucode":"DB59B24A249713","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310235,"discussion_content":"ä»MySQLè¿‡æ¥çš„å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601701502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":202159,"user_name":"æ–‘é©¬Z","can_delete":false,"product_type":"c1","uid":1500262,"ip_address":"","ucode":"ABB55B4652452F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK0K9AM6xxDzVV6pF66jyus5NuuxZzT9icad8AQDMKibwUOy3UnoZIZdyKIKd9sA06rgFnIWwiakSeOQ/132","comment_is_top":false,"comment_ctime":1585912442,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40240618106","product_id":100020901,"comment_content":"<br>æˆ‘çš„æœºå™¨æœ¬èº«é…ç½®è¾ƒé«˜ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰è®¾ç½®é—´éš”æ—¶é—´ï¼Œä¸€ç›´æ‰§è¡Œã€‚ç„¶åå›åˆ°ç¬¬ä¸€å°æœºå™¨ä¸Šï¼Œå…ˆçœ‹topï¼Œå‘ç° waæŒ‡æ ‡è¾ƒé«˜ï¼Œç„¶åç”¨iostat  -c -d 1 ï¼Œå‘ç°æ•´ä½“  kB_read&#47;s  è¾¾åˆ°114696.00ï¼Œåˆ¤å®šæ˜¯i&#47;oé—®é¢˜ï¼Œä½†æ˜¯åœ¨topä¸­çœ‹ä¸åˆ°ä½¿ç”¨cpuæˆ–è€…å†…å­˜ç‰¹åˆ«å¼‚å¸¸çš„ï¼ˆå› ä¸ºæˆ‘çš„æœºå™¨èµ·äº†k8sç­‰å¤§å‹é›†ç¾¤ï¼Œï¼‰ä¹‹åç”¨iotopï¼Œç›´æ¥å‘ç°å…ƒå‡¶ï¼Œ<br><br>  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND                                                                                     <br>29919 be&#47;4 systemd-  114.29 M&#47;s    0.00 B&#47;s  0.00 % 99.11 % mysqld --log_bin=on --sync_binlog=1<br><br><br>ç„¶å ps -ef|grep 29919 ä½†æ˜¯æ²¡æœ‰ç»“æœï¼Œæ€€ç–‘æ˜¯çº¿ç¨‹ï¼Œå°±åŠ  -T å‚æ•°æœ€ç»ˆæ‰¾åˆ° 30814 è¿™ä¸ªè¿›ç¨‹<br><br>systemd+ 30814 29919 30797  3 18:05 ?        00:01:20 mysqld --log_bin=on --sync_binlog=1<br><br><br>ç»“åˆä¸ŠèŠ‚è¯¾strace -fp  29919 ï¼Œå‘ç°è¯¥çº¿ç¨‹æ‰“å¼€äº†å¾ˆå¤š æè¿°ç¬¦ä¸º37çš„æ–‡ä»¶ï¼Œ<br><br><br>[pid 29919] read(37, &quot;LJYd0fil50ofyzdh1xgRyX8oW4QLmuik&quot;..., 20480) = 20480<br>[pid 29919] read(37, &quot;qA790gsUl1tylT15F3AuoNocQCnO40dm&quot;..., 131072) = 131072<br>[pid 29919] read(37, &quot;7nBGWv04k7dw0p3bhUFvFXCXqiMAEOa8&quot;..., 24576) = 24576<br> pidstat -r -p 30814 æŸ¥çœ‹æŒ‡æ ‡å‘ç°æ²¡å•¥å¼‚å¸¸ã€‚ï¼ˆæœ‰ç‚¹éƒé—·ï¼‰ï¼Œç»§ç»­ç”¨lsof -p 30814 æŸ¥çœ‹ï¼Œ<br><br>mysqld  30814 systemd-bus-proxy   37u   REG  253,1 512440000   502137 &#47;var&#47;lib&#47;mysql&#47;test&#47;products.MYD<br><br>çœ‹åˆ°è¿™é‡Œæ‰¾åˆ°æ–‡ä»¶ï¼Œä½†èƒ½åŠ›ä¸å¤Ÿæ— æ³•ç»§ç»­åˆ†æï¼Œè‡ªå·±mysqlä¹Ÿè–„å¼±çš„å¾ˆï¼ˆæ‰‹åŠ¨ç‹—å¤´ï¼‰ï¼ŒæŸ¥çœ‹è¯¾ç¨‹ï¼Œè€å¸ˆè¿™ä¹ˆè®²è§£<br><br><br>MYD æ–‡ä»¶ï¼Œæ˜¯ MyISAM å¼•æ“ç”¨æ¥å­˜å‚¨è¡¨æ•°æ®çš„æ–‡ä»¶ï¼›æ–‡ä»¶åå°±æ˜¯æ•°æ®è¡¨çš„åå­—ï¼›è€Œè¿™ä¸ªæ–‡ä»¶çš„çˆ¶ç›®å½•ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“çš„åå­—ã€‚<br>&#47;var&#47;lib&#47;mysql&#47;test&#47; ç›®å½•ä¸­æœ‰å››ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼šMYD æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„æ•°æ®ï¼›MYI æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„ç´¢å¼•ï¼›frm æ–‡ä»¶ç”¨æ¥å­˜å‚¨è¡¨çš„å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚è¡¨ç»“æ„ï¼‰ï¼›opt æ–‡ä»¶åˆ™ç”¨æ¥å­˜å‚¨æ•°æ®åº“çš„å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å­—ç¬¦é›†ã€å­—ç¬¦æ ¡éªŒè§„åˆ™ç­‰ï¼‰ã€‚<br><br><br>","like_count":8},{"had_liked":false,"id":63465,"user_name":"guoew","can_delete":false,"product_type":"c1","uid":1299148,"ip_address":"","ucode":"12EA3A8523921A","user_header":"https://static001.geekbang.org/account/avatar/00/13/d2/cc/d54b7e5b.jpg","comment_is_top":false,"comment_ctime":1548379978,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"23023216458","product_id":100020901,"comment_content":"ä»¥å‰é‡åˆ°æ•°æ®åº“æ…¢çš„é—®é¢˜éƒ½æ˜¯ç›´æ¥è¿›æ•°æ®åº“show processlist ï¼Œæ²¡æœ‰ä¸€ä¸ªå¾ªåºæ¸è¿›çš„è¿‡ç¨‹ã€‚æ„Ÿè°¢è€å¸ˆ","like_count":5,"discussions":[{"author":{"id":1349476,"avatar":"https://static001.geekbang.org/account/avatar/00/14/97/64/0b40f4d7.jpg","nickname":"çš“çš“","note":"","ucode":"41414708C8126A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309752,"discussion_content":"è¿˜æ˜¯å¾—ç›´æ¥å…ˆè§£å†³ï¼Œç­‰ä½ å¾ªåºæ¸è¿› åº“éƒ½è¢«æ‰“æŒ‚äº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1601431931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1299148,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/cc/d54b7e5b.jpg","nickname":"guoew","note":"","ucode":"12EA3A8523921A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1349476,"avatar":"https://static001.geekbang.org/account/avatar/00/14/97/64/0b40f4d7.jpg","nickname":"çš“çš“","note":"","ucode":"41414708C8126A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327755,"discussion_content":"å“ˆå“ˆå“ˆï¼Œæœ‰é“ç†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605937524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":309752,"ip_address":""},"score":327755,"extra":""}]},{"author":{"id":1349476,"avatar":"https://static001.geekbang.org/account/avatar/00/14/97/64/0b40f4d7.jpg","nickname":"çš“çš“","note":"","ucode":"41414708C8126A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309753,"discussion_content":"å“ˆå“ˆå“ˆã€‚ã€‚å…ˆè§£å†³ å†æŸ¥åŸå› ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1601431967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325101,"avatar":"https://static001.geekbang.org/account/avatar/00/14/38/2d/9c971119.jpg","nickname":"è‹¥ä¸¶ç›¸ä¾","note":"","ucode":"6482339C859C40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327384,"discussion_content":"topçœ‹ä¸ªå¤§æ¦‚ï¼Œä¹‹åè¿›æ•°æ®åº“ç›´æ¥æ‰¾æ…¢æŸ¥è¯¢sqlï¼Œä¼˜åŒ–æˆ–è€…å¹²æ­»ï¼Œåœ¨ä¹‹åè§‚å¯Ÿç³»ç»ŸçŠ¶æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605816553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63040,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1548234615,"is_pvip":false,"replies":[{"id":"22347","content":"ä¸ç”¨è€ƒè™‘é‚£ä¹ˆå¤šï¼Œæˆ‘è§‰å¾—æ‰“å¥½åŸºç¡€ï¼ŒæŒç»­æå‡è‡ªèº«çš„èƒ½åŠ›ï¼Œå¼€æ”¾çš„å¿ƒæ€æ¥æ”¶æ–°ä¸œè¥¿ï¼Œå·¥ä½œä¸ä¼šé‚£ä¹ˆå®¹æ˜“ä¸¢çš„ï¼ˆå³ä½¿ä¸¢äº†ä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°æ–°çš„ï¼‰","user_name":"ä½œè€…å›å¤","comment_id":63040,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252839,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":3,"race_medal":0,"score":"18728103799","product_id":100020901,"comment_content":"è€å¸ˆï¼Œé—®3ä¸ªå¾ˆé‡è¦çš„é¢˜å¤–é—®é¢˜ï¼š<br>1. å¤§ä¸“å­¦å†ï¼Œæƒ³ç›´æ¥è‡ªå­¦è€ƒæœ¬ç§‘æˆ–ç ”ç©¶ç”Ÿï¼Œè‡ªè€ƒå­¦å†ä¸­å¤§å‹å…¬å¸æ‰¿è®¤çš„å—ï¼Ÿ<br>2. å¤§å…¬å¸å¯¹å¹´é¾„æœ‰é™åˆ¶çš„å—ï¼Ÿ<br>3. 30å¤šå²ï¼Œè¿ç»´ï¼ˆç¼–ç¨‹è‡ªå­¦javaä¸€å¹´ï¼Œæ²¡é¡¹ç›®ç»éªŒï¼‰ï¼Œåªæœ‰å‡ å¹´å°å…¬å¸è¿ç»´ç»éªŒï¼ŒæŠ€æœ¯ä¸€èˆ¬ï¼Œå‘å±•æ–¹å‘æ˜¯ä»€ä¹ˆï¼Ÿå¾ˆå¤šITå…¬å¸å¥½åƒéƒ½ä¸è¦å¹´é¾„å¤§ç‚¹çš„~~äººç”Ÿ80ï¼Œé‚£ä¸æ˜¯40å²å°±æ²¡å¾—å·¥ä½œäº†ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437449,"discussion_content":"ä¸ç”¨è€ƒè™‘é‚£ä¹ˆå¤šï¼Œæˆ‘è§‰å¾—æ‰“å¥½åŸºç¡€ï¼ŒæŒç»­æå‡è‡ªèº«çš„èƒ½åŠ›ï¼Œå¼€æ”¾çš„å¿ƒæ€æ¥æ”¶æ–°ä¸œè¥¿ï¼Œå·¥ä½œä¸ä¼šé‚£ä¹ˆå®¹æ˜“ä¸¢çš„ï¼ˆå³ä½¿ä¸¢äº†ä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°æ–°çš„ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2321649,"avatar":"","nickname":"Geek_76c30e","note":"","ucode":"EFA86960BDCB95","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330253,"discussion_content":"åŒä¸º30çš„è¿ç»´ï¼ŒåŠ æ²¹å§ã€‚ã€‚æ—¶åˆ»ä¿æŒå­¦ä¹ çš„åŠ¨åŠ›ï¼Œä¸ä¼šè¢«æ·˜æ±°çš„ã€‚åé¢è€é¾„åŒ–å¸ç§ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸€ç›´å­¦ä¹ åœ¨åé¢ä¹Ÿä¼šæœ‰æ›´å¤šå‡†å¤‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606550355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1588770,"avatar":"https://static001.geekbang.org/account/avatar/00/18/3e/22/f91219a8.jpg","nickname":"wanlinwang","note":"","ucode":"C74C3CF0B5BF64","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5448,"discussion_content":"åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566280527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63016,"user_name":"æé€é¥","can_delete":false,"product_type":"c1","uid":1109750,"ip_address":"","ucode":"DB74823527E203","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/xzHDjCSFicNY3MUMECtNz6sM8yDJhBoyGk5IRoOtUat6ZIkGzxjqEqwqKYWMD3GjehScKvMjicGOGDog5FF18oyg/132","comment_is_top":false,"comment_ctime":1548228409,"is_pvip":false,"replies":[{"id":"22344","content":"å—¯å—¯ï¼Œæ…¢æŸ¥è¯¢æ¨èæ€»æ˜¯å¼€å¯","user_name":"ä½œè€…å›å¤","comment_id":63016,"uid":"1001282","ip_address":"","utype":1,"ctime":1548252416,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"18728097593","product_id":100020901,"comment_content":"mysqlæ‰“å¼€æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ’æŸ¥SQLæ€§èƒ½é—®é¢˜æ›´æ–¹ä¾¿","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437439,"discussion_content":"å—¯å—¯ï¼Œæ…¢æŸ¥è¯¢æ¨èæ€»æ˜¯å¼€å¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258454,"user_name":"äº¥æ—¶","can_delete":false,"product_type":"c1","uid":1001264,"ip_address":"","ucode":"8E8228C68C7CD7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epK1zyWib7IKYNOibHwHbO2QC0fRUQ69LYgNCxb0kOfhPEUuAiaGDiaq16N2Jmab9RH0noF4W5JTVNbiag/132","comment_is_top":false,"comment_ctime":1604451627,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10194386219","product_id":100020901,"comment_content":" åœ¨ä¸çŸ¥é“åˆ«äººä»£ç æ”¹äº†å•¥çš„æƒ…å†µä¸‹  è¿™ç§é’ˆå¯¹linux é€ä¸€æ’æŸ¥å®šä½çš„èƒ½åŠ›çœŸçš„å¾ˆé‡è¦","like_count":3},{"had_liked":false,"id":63768,"user_name":"å°è€é¼ ","can_delete":false,"product_type":"c1","uid":1257460,"ip_address":"","ucode":"C663A0C863A515","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg","comment_is_top":false,"comment_ctime":1548493600,"is_pvip":false,"replies":[{"id":"22594","content":"æ˜¯çš„ï¼Œåˆ©ç”¨ç¼“å­˜åæ€§èƒ½ä¼šæ›´å¥½","user_name":"ä½œè€…å›å¤","comment_id":63768,"uid":"1001282","ip_address":"","utype":1,"ctime":1548577172,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10138428192","product_id":100020901,"comment_content":"å³åœæ­¢DataService ï¼Œåˆå¢åŠ ç´¢3å¼•æ˜¯ä¸æ˜¯æ€§èƒ½ä¼šæ›´å¥½ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437713,"discussion_content":"æ˜¯çš„ï¼Œåˆ©ç”¨ç¼“å­˜åæ€§èƒ½ä¼šæ›´å¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548577172,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276568,"user_name":"fantastic_show","can_delete":false,"product_type":"c1","uid":2060088,"ip_address":"","ucode":"D2738135D086E4","user_header":"","comment_is_top":false,"comment_ctime":1612008543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5906975839","product_id":100020901,"comment_content":"è¯¾åé¢˜ï¼šMySQLä¼šç¼“å­˜æŸ¥è¯¢è¿‡çš„æ•°æ®ï¼Œåˆšå¼€å§‹è¦ä»ç£ç›˜è¯»å–ï¼Œåç»­çš„æŸ¥è¯¢å°±ç›´æ¥ä»å†…å­˜è·å–äº†","like_count":2},{"had_liked":false,"id":134896,"user_name":"è¾‰æ™–","can_delete":false,"product_type":"c1","uid":1574062,"ip_address":"","ucode":"E5EC033EE4952B","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/ae/0118c132.jpg","comment_is_top":false,"comment_ctime":1568947953,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5863915249","product_id":100020901,"comment_content":"mysqlè¿›ç¨‹æ¯ç§’å†™å…¥8M&#47;Sï¼Œuntilæ¥è¿‘100%ï¼Œiowaitæœ‰40%ã€‚å¯æ˜¯åå¤è¿è¡Œshow full processlist;ä¸€ç›´æŸ¥ä¸åˆ°è€—æ—¶é•¿ï¼ˆé™¤äº†Sleepï¼‰çš„è¯­å¥ï¼Œè¦æ€ä¹ˆæ’æŸ¥ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1443017,"avatar":"https://static001.geekbang.org/account/avatar/00/16/04/c9/ef585c96.jpg","nickname":"ç¢Œèˆ°è™¾","note":"","ucode":"B947C229E767D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569575,"discussion_content":"æŠ“åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651487689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109527,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ee/17/32183260.jpg","nickname":"é€é¥é­”å›","note":"","ucode":"6EDD906634D7CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224510,"discussion_content":"perfå·¥å…·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586312390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62935,"user_name":"nemo","can_delete":false,"product_type":"c1","uid":1148570,"ip_address":"","ucode":"5E6926A3404A6F","user_header":"https://static001.geekbang.org/account/avatar/00/11/86/9a/4231fb93.jpg","comment_is_top":false,"comment_ctime":1548209672,"is_pvip":false,"replies":[{"id":"22576","content":"æ£€æŸ¥ä¸‹ç£ç›˜æ˜¯å¦æœ‰ç¡¬ä»¶é”™è¯¯ï¼Œæ¯”å¦‚ä½¿ç”¨ smartctl","user_name":"ä½œè€…å›å¤","comment_id":62935,"uid":"1001282","ip_address":"","utype":1,"ctime":1548575747,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"5843176968","product_id":100020901,"comment_content":"Device:         rrqm&#47;s   wrqm&#47;s     r&#47;s     w&#47;s    rMB&#47;s    wMB&#47;s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>sda               0.00   160.00    0.00  618.00     0.00    12.86    42.60   144.44  224.37    0.00  224.37   1.62 100.00<br>dm-3              0.00     0.00    0.00    5.00     0.00     0.04    16.20     1.08  216.40    0.00  216.40  69.00  34.50<br>dm-5              0.00     0.00    0.00  761.00     0.00    11.83    31.84   203.54  283.46    0.00  283.46   1.31 100.00<br><br>Device:         rrqm&#47;s   wrqm&#47;s     r&#47;s     w&#47;s    rMB&#47;s    wMB&#47;s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>sda               0.00   220.00    0.00  483.00     0.00    11.23    47.64   143.94  214.15    0.00  214.15   2.07 100.00<br>dm-5              0.00     0.00    0.00  700.00     0.00    10.83    31.69   191.09  212.01    0.00  212.01   1.43 100.00<br><br>Device:         rrqm&#47;s   wrqm&#47;s     r&#47;s     w&#47;s    rMB&#47;s    wMB&#47;s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>sda               0.00   264.00    0.00  493.00     0.00    10.71    44.49   142.95  304.66    0.00  304.66   2.03 100.00<br>dm-5              0.00     0.00    0.00  776.00     0.00    12.11    31.97   193.24  244.70    0.00  244.70   1.29 100.00<br><br>Device:         rrqm&#47;s   wrqm&#47;s     r&#47;s     w&#47;s    rMB&#47;s    wMB&#47;s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>sda               0.00   249.00    0.00  287.00     0.00     7.54    53.77   144.36  434.90    0.00  434.90   3.48 100.00<br>dm-5              0.00     0.00    0.00  537.00     0.00     8.37    31.91   232.41  329.02    0.00  329.02   1.86 100.00<br>è¯·é—®ä¸‹è€å¸ˆ,è¿™ä¸ªä¸‡è½¬sasç£ç›˜åœ¨å†™ä¸åˆ°10MBçš„æƒ…å†µä¸‹,ä¸ºä»€ä¹ˆç£ç›˜ä½¿ç”¨ç‡100%,ç­‰å¾…æ—¶é—´ä¹Ÿç‰¹åˆ«é•¿?","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437411,"discussion_content":"æ£€æŸ¥ä¸‹ç£ç›˜æ˜¯å¦æœ‰ç¡¬ä»¶é”™è¯¯ï¼Œæ¯”å¦‚ä½¿ç”¨ smartctl","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548575747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1024805,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/a3/25/5da16c25.jpg","nickname":"coyang","note":"","ucode":"563687E0F6A441","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":194811,"discussion_content":"è¿˜æœ‰å¦å¤–ä¸€ç§å¯èƒ½æ˜¯ç£ç›˜çš„è¯»å†™cacheè¢«å…³æ‰äº†ï¼Œç”¨ hdparm æˆ–è€… sginfo çœ‹ä¸€ä¸‹ ğŸ˜ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583243410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352834,"user_name":"ä¸€çœå¾èº«","can_delete":false,"product_type":"c1","uid":1676631,"ip_address":"","ucode":"D902357160BBD9","user_header":"https://static001.geekbang.org/account/avatar/00/19/95/57/a2991536.jpg","comment_is_top":false,"comment_ctime":1658976221,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"1658976221","product_id":100020901,"comment_content":"man procæŸ¥äº†ä¸‹:<br>To free pagecache, use echo 1 &gt; &#47;proc&#47;sys&#47;vm&#47;drop_caches; to free dentries and inodes, use echo 2 &gt; &#47;proc&#47;sys&#47;vm&#47;drop_caches;  to  free  pagecache,  dentries  and  inodes,  use  echo  3  &gt;<br>              &#47;proc&#47;sys&#47;vm&#47;drop_caches.<br><br>","like_count":0},{"had_liked":false,"id":347249,"user_name":"Geek_36a5ef","can_delete":false,"product_type":"c1","uid":2949005,"ip_address":"","ucode":"F3BB89E18893FA","user_header":"https://static001.geekbang.org/account/avatar/00/2c/ff/8d/0674be36.jpg","comment_is_top":false,"comment_ctime":1653874569,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653874569","product_id":100020901,"comment_content":"&quot;æ…¢æŸ¥è¯¢çš„ç°è±¡å¤§å¤šæ˜¯ CPU ä½¿ç”¨ç‡é«˜ï¼ˆæ¯”å¦‚ 100% ï¼‰ï¼Œä½†è¿™é‡Œçœ‹åˆ°çš„å´æ˜¯ I&#47;O é—®é¢˜ã€‚&quot;ä½†æ˜¯æ–‡ç« æœ€åè¿˜æ˜¯è¯´äº†æ˜¯æ…¢æŸ¥è¯¢çš„é—®é¢˜ï¼Œè€Œä¸€å¼€å§‹æ˜¯iowaité«˜ï¼Œæ€ä¹ˆè§£é‡Š","like_count":0},{"had_liked":false,"id":322184,"user_name":"gecko","can_delete":false,"product_type":"c1","uid":1198048,"ip_address":"","ucode":"2B7122536F1A0E","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/e0/1ff26e99.jpg","comment_is_top":false,"comment_ctime":1637225707,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1637225707","product_id":100020901,"comment_content":"è¯·æ•™è€å¸ˆæˆ‘è¿™æœ‰å°æœåŠ¡å™¨ï¼Œæƒ…å†µæ˜¯mysql æ’å…¥æ•°æ®å¾ˆæ…¢ï¼Œ<br>iostat -x -d 1<br>sdb çš„ %util æ˜¯ 99.80<br>wkb&#47;s å€¼æ˜¯ 2580<br><br><br>ä½†æ˜¯mysql è¿›ç¨‹å†™çš„æ•°æ®ä¹Ÿä¸å¤šï¼Œè¯·æ•™è€å¸ˆè¿˜åº”è¯¥å’‹æŸ¥å‘¢","like_count":0,"discussions":[{"author":{"id":1013424,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/b0/14fec62f.jpg","nickname":"ä¸äº†å³°","note":"","ucode":"E23B96D6A3D4EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551574,"discussion_content":"çœ‹ä¸€ä¸‹ insert  è¯­å¥ï¼ŒåŠè¡¨ç»“æ„ä¸Šæœ‰å¤šå°‘ç´¢å¼•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645063984,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294184,"user_name":"noisyes","can_delete":false,"product_type":"c1","uid":2538540,"ip_address":"","ucode":"94EC310B284AD2","user_header":"https://static001.geekbang.org/account/avatar/00/26/bc/2c/963688bb.jpg","comment_is_top":false,"comment_ctime":1621820183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1621820183","product_id":100020901,"comment_content":"ç›´æ¥å°†&#47;proc&#47;sys&#47;vm&#47;drop_caches æ”¹æˆ 1ä¸å°±è¡Œäº†ï¼Œä¸ºä»€ä¹ˆè¦è¯»å†™ä¸€ä¸ªdataå­—ç¬¦ä¸²çš„æ–‡ä»¶å‘¢","like_count":0},{"had_liked":false,"id":244035,"user_name":"Wade_é˜¿ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1688629,"ip_address":"","ucode":"5AE2E846A13443","user_header":"https://static001.geekbang.org/account/avatar/00/19/c4/35/2cc10d43.jpg","comment_is_top":false,"comment_ctime":1598362374,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598362374","product_id":100020901,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘åœ¨æµ‹è¯•æ¡ˆä¾‹æ—¶ï¼Œç»™teståº“åˆ›å»ºç´¢å¼•æ—¶ï¼Œä¸€ç›´æ²¡è¿”å›ã€‚<br>mysql&gt; CREATE INDEX products_index ON products (productName(64));<br>æ‰§è¡Œä¸‹é¢æŸ¥è¯¢è¯­å¥ï¼Œå‘ç°è¿”å›Waiting for table metadata lock ä¿¡æ¯<br>mysql&gt; show full processlist;<br>+-----+------+-----------------+------+---------+------+---------------------------------+-----------------------------------------------------------+<br>| Id  | User | Host            | db   | Command | Time | State                           | Info                                                      |<br>+-----+------+-----------------+------+---------+------+---------------------------------+-----------------------------------------------------------+<br>|   4 | root | 127.0.0.1:49978 | test | Sleep   | 3148 |                                 | NULL                                                      |<br>| 205 | root | localhost       | test | Query   |   70 | Waiting for table metadata lock | CREATE INDEX products_index ON products (productName(64)) |<br>| 224 | root | localhost       | test | Query   |    0 | init                            | show full processlist                                     |<br>+-----+------+-----------------+------+---------+------+---------------------------------+-----------------------------------------------------------+<br>3 rows in set (0.01 sec)<br>è¯·é—®è¯¥å¦‚ä½•è§£å†³ï¼Ÿ","like_count":0},{"had_liked":false,"id":244034,"user_name":"Wade_é˜¿ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1688629,"ip_address":"","ucode":"5AE2E846A13443","user_header":"https://static001.geekbang.org/account/avatar/00/19/c4/35/2cc10d43.jpg","comment_is_top":false,"comment_ctime":1598362229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598362229","product_id":100020901,"comment_content":"mysql&gt; CREATE INDEX products_index ON products (productName(64));","like_count":0},{"had_liked":false,"id":215170,"user_name":"rsk","can_delete":false,"product_type":"c1","uid":1314383,"ip_address":"","ucode":"F51A8C075D9C16","user_header":"https://static001.geekbang.org/account/avatar/00/14/0e/4f/681f41bd.jpg","comment_is_top":false,"comment_ctime":1588920079,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1588920079","product_id":100020901,"comment_content":"æ•°æ®åº“æœåŠ¡å™¨å’Œä¸šåŠ¡æœåŠ¡å™¨æ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆæ…¢SQLä¼šå¢åŠ ä¸šåŠ¡æœåŠ¡å™¨çš„è´Ÿè½½å—ï¼Ÿï¼ˆå¹³å‡è´Ÿè½½æ˜¯æŒ‡å•ä½æ—¶é—´å†…ï¼Œç³»ç»Ÿå¤„äºå¯è¿è¡ŒçŠ¶æ€å’Œä¸å¯ä¸­æ–­çŠ¶æ€çš„å¹³å‡è¿›ç¨‹æ•°ã€‚æˆ‘æ„Ÿè§‰ä¸šåŠ¡æœåŠ¡å™¨åˆ°æ•°æ®åº“çš„è¿æ¥æ˜¯å¯ä»¥ä¸­æ–­çš„å§ã€‚ï¼‰","like_count":0,"discussions":[{"author":{"id":1013424,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/76/b0/14fec62f.jpg","nickname":"ä¸äº†å³°","note":"","ucode":"E23B96D6A3D4EC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551575,"discussion_content":"é—®é¢˜å°±åœ¨äºä¸šåŠ¡æœåŠ¡å™¨æ˜¯ä¸€ä¸ªè¿æ¥æ•°æ®åº“ï¼Œè¿˜æ˜¯æœ‰å¤šä¸ªè¿æ¥è¿æ•°æ®ã€‚å¦‚æœä¸€æ®µæ—¶é—´å†…sql æ‰§è¡Œæ…¢ï¼Œ å¯¼è‡´å¤§é‡çš„è¿æ¥åœ¨åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œè¿™ä¹Ÿæ˜¯å¢åŠ ä¸šåŠ¡å™¨çš„è´Ÿè½½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645064169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203115,"user_name":"å®‹èƒ–èƒ–","can_delete":false,"product_type":"c1","uid":1857496,"ip_address":"","ucode":"AA828F49CCEABA","user_header":"https://static001.geekbang.org/account/avatar/00/1c/57/d8/e9c8b923.jpg","comment_is_top":false,"comment_ctime":1586141507,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586141507","product_id":100020901,"comment_content":"æ‰“å¡å­¦ä¹ ï¼Œã€‚éš¾é“dataservice é‡Œçš„æ“ä½œæ—¶å…³é—­ç¼“å­˜åŠŸèƒ½ï¼Œåœæ­¢äº†dataserviceï¼ŒæŸ¥è¯¢çš„æ•°æ®åˆ°cacheé‡Œä¸‹æ¬¡æŸ¥è¯¢å°±å¿«äº†ã€‚vmstat è¾“å‡º cache ä» 889456 å‡é«˜åˆ°918576ã€‚io é‡Œçš„bi é™åˆ°0 ","like_count":0},{"had_liked":false,"id":201736,"user_name":"EncodedStar","can_delete":false,"product_type":"c1","uid":1504234,"ip_address":"","ucode":"03958CA7DDD6AE","user_header":"https://static001.geekbang.org/account/avatar/00/16/f3/ea/2b2adda5.jpg","comment_is_top":false,"comment_ctime":1585827984,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1585827984","product_id":100020901,"comment_content":"è€å¸ˆè¿™è®²æ‰“å¼€äº†æˆ‘è®¤çŸ¥æ–°ä¸–ç•Œå•Šï¼ŒçœŸçš„æ˜¯&#39;You do not know what you do not know&#39;","like_count":0,"discussions":[{"author":{"id":1002005,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4a/15/106eaaa8.jpg","nickname":"stackWarn","note":"","ucode":"89672E452DEBA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":257508,"discussion_content":"æœªçŸ¥çš„æœªçŸ¥ å“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588580369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197341,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1585369354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585369354","product_id":100020901,"comment_content":"mysqlé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¼“å­˜ã€‚","like_count":0},{"had_liked":false,"id":195229,"user_name":"linker","can_delete":false,"product_type":"c1","uid":1803259,"ip_address":"","ucode":"6C5799F2FC2C82","user_header":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","comment_is_top":false,"comment_ctime":1585147996,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585147996","product_id":100020901,"comment_content":"æ¸…ç¼“å­˜ï¼Œå¯¼è‡´æ¯æ¬¡å†™éƒ½æ˜¯ä»ç£ç›˜åº¦ï¼Œå‡ºç°ioé—®é¢˜","like_count":0},{"had_liked":false,"id":143222,"user_name":"tux","can_delete":false,"product_type":"c1","uid":1477811,"ip_address":"","ucode":"BB7202009FC885","user_header":"https://static001.geekbang.org/account/avatar/00/16/8c/b3/a74a7125.jpg","comment_is_top":false,"comment_ctime":1571651124,"is_pvip":false,"replies":[{"id":"55337","content":"é»˜è®¤çš„é•œåƒæ˜¯ä»dockerhubä¸Šé¢æ‹‰ä¸‹æ¥çš„ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œå¯ä»¥è¯•è¯•é€šè¿‡ä»£ç†è®¿é—®","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1571664610,"ip_address":"","comment_id":143222,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571651124","product_id":100020901,"comment_content":"å›é¡¾é˜¶æ®µï¼Œå†è¿è¡Œæ¡ˆä¾‹ï¼Œå‘ç°æ€»ä¼šå‡ºä¸¤ç§ç°è±¡ï¼š<br>1.å¡åœ¨ è¿›åº¦æ¡(å‡ºç°æœ€å¤š)<br>root@t-s:mysql-slow:: make run<br>...<br>1f212fb371f9: Downloading [==========================&gt;      ]  1.137MB&#47;1.27MB<br>...<br><br>2.å¡åœ¨ Waiting <br>root@t-s:mysql-slow:: make run<br>...<br>44fa5ea1d96b: Waiting <br>...<br><br><br>æ­¤ç¯‡ï¼Œä»ä¸Šå‘¨åˆ°è¿™å‘¨ï¼Œæ²¡æœ‰make runæˆåŠŸè¿‡ã€‚<br>I&#47;0æ€§èƒ½ç¯‡ï¼ŒæŠ›å¼€æ­¤ç¯‡ï¼Œå…¶å®ƒç¯‡éœ€è¦docker runå¥½å‡ æ¬¡ï¼Œæ‰èƒ½è¿è¡Œæ¡ˆä¾‹ã€‚<br><br>æ˜¯ä¸ªä¾‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471430,"discussion_content":"é»˜è®¤çš„é•œåƒæ˜¯ä»dockerhubä¸Šé¢æ‹‰ä¸‹æ¥çš„ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œå¯ä»¥è¯•è¯•é€šè¿‡ä»£ç†è®¿é—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571664610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126333,"user_name":"çƒ¨","can_delete":false,"product_type":"c1","uid":1564897,"ip_address":"","ucode":"2844E63958EAD1","user_header":"https://static001.geekbang.org/account/avatar/00/17/e0/e1/029768f1.jpg","comment_is_top":false,"comment_ctime":1566364876,"is_pvip":false,"replies":[{"id":"47201","content":"è°¢è°¢åˆ†äº«æ‚¨çš„æ­¥éª¤ï¼Œå¯èƒ½æ˜¯æœ‰çš„ç¯å¢ƒmysqlåˆå§‹åŒ–æ¯”è¾ƒæ…¢","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1566743090,"ip_address":"","comment_id":126333,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566364876","product_id":100020901,"comment_content":"ä¹‹å‰è¿è¡Œmake initçš„æ—¶å€™ï¼Œä¼šæŠ¥é”™è¿ä¸ä¸Šæœ¬åœ°æ•°æ®åº“ï¼Œåæ¥å‘ç°æ˜¯å› ä¸ºmysqlè¿˜æ²¡å¯åŠ¨å¥½ï¼Œappå°±å·²ç»å¯åŠ¨äº†ï¼Œæ‰€ä»¥ä¸€ç›´è¿ä¸ä¸Šã€‚å°†appé‡å¯ä¸€æ¬¡å°±å¥½äº†","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463942,"discussion_content":"è°¢è°¢åˆ†äº«æ‚¨çš„æ­¥éª¤ï¼Œå¯èƒ½æ˜¯æœ‰çš„ç¯å¢ƒmysqlåˆå§‹åŒ–æ¯”è¾ƒæ…¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566743090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":120707,"user_name":"ä¸€æƒ³å†æƒ³N","can_delete":false,"product_type":"c1","uid":1003453,"ip_address":"","ucode":"EA22728C2A43F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4f/bd/6d825f68.jpg","comment_is_top":false,"comment_ctime":1564979808,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1564979808","product_id":100020901,"comment_content":"å¯ä»¥æŠŠä¸èµ°ç´¢å¼•çš„æŸ¥è¯¢è®°å½•åˆ°æ—¥å¿—ä¸­å»","like_count":0},{"had_liked":false,"id":111427,"user_name":"è¥¿ç“œå°±å’¸èœ","can_delete":false,"product_type":"c1","uid":1586824,"ip_address":"","ucode":"DFE3F888F78751","user_header":"https://static001.geekbang.org/account/avatar/00/18/36/88/ad3a0126.jpg","comment_is_top":false,"comment_ctime":1562556628,"is_pvip":false,"replies":[{"id":"42003","content":"å†å¢åŠ æ•°æ®ï¼ˆæ¯”å¦‚10å€ï¼‰è¯•è¯•ï¼ŸğŸ˜“","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1563459351,"ip_address":"","comment_id":111427,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1562556628","product_id":100020901,"comment_content":"æˆ‘æŠŠinsertæ¡æ•°å¢å¤§åˆ°1000000ï¼Œcurl çš„å“åº”æ—¶é—´å¾ˆçŸ­ï¼Œ0.0011873245239257812 secï¼Œè·Ÿå®éªŒçš„ç»“æœä¸ä¸€æ ·ï¼Œæˆ‘çœ‹ç³»ç»Ÿçš„çŠ¶æ€ä¹Ÿæ²¡æœ‰ioé—®é¢˜ï¼Œé€šè¿‡pidstatä¹Ÿæ²¡æœ‰mysqlçš„ iodelay","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":457351,"discussion_content":"å†å¢åŠ æ•°æ®ï¼ˆæ¯”å¦‚10å€ï¼‰è¯•è¯•ï¼ŸğŸ˜“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563459351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":96133,"user_name":"Musisan","can_delete":false,"product_type":"c1","uid":1500498,"ip_address":"","ucode":"A9A9FE56AABEBA","user_header":"https://static001.geekbang.org/account/avatar/00/16/e5/52/35bc9c07.jpg","comment_is_top":false,"comment_ctime":1558340443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558340443","product_id":100020901,"comment_content":"manç¡®å®æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œä»¥å‰ç»™å¿½ç•¥äº†å“ˆï¼Œ^_^","like_count":0},{"had_liked":false,"id":95740,"user_name":"LYy","can_delete":false,"product_type":"c1","uid":1102062,"ip_address":"","ucode":"8D5C39B9531E71","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/ee/f5c5e191.jpg","comment_is_top":false,"comment_ctime":1558159515,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1558159515","product_id":100020901,"comment_content":"ç¡¬æ ¸ èµğŸ‘","like_count":0},{"had_liked":false,"id":89543,"user_name":"æ— åè€å’","can_delete":false,"product_type":"c1","uid":1348261,"ip_address":"","ucode":"48874CE670E122","user_header":"","comment_is_top":false,"comment_ctime":1556200570,"is_pvip":false,"replies":[{"id":"32220","content":"æ’å…¥æ›´å¤šçš„æ•°æ®è¯•è¯•ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1556370215,"ip_address":"","comment_id":89543,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1556200570","product_id":100020901,"comment_content":"å®ä¾‹æ’å…¥äº†3Wæ¡æ•°æ®ï¼Œè¿™æ ·å­æ‰ä½¿å¾—get dataçš„æ—¶é—´å˜å¤§äº†ä¸€äº›ï¼Œåé¢å¢åŠ äº†ç´¢å¼•ä¹‹åï¼Œå°±å˜æ­£å¸¸äº†ã€‚<br>```<br>root@fdm:~#while :;do curl http:&#47;&#47;192.168.254.131:10000&#47;products&#47;geektime;done<br>Got data: () in 2.335655689239502 sec<br>Got data: () in 2.3957033157348633 sec<br>Got data: () in 5.153362274169922 sec<br>Got data: () in 6.846464157104492 sec<br>Got data: () in 3.2172300815582275 sec<br>Got data: () in 0.04523611068725586 sec<br>Got data: () in 0.0017778873443603516 sec<br>Got data: () in 0.00156402587890625 sec<br>Got data: () in 0.0016543865203857422 sec<br>```<br><br>ä½†æ˜¯åé¢æŠŠdataserviceåœæ­¢ä¹‹åï¼Œè¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆæé«˜çš„æ•ˆæœï¼Œæ‰€ä»¥æœ‰å¯èƒ½ç¡¬ç›˜ä½¿ç”¨äº†SSDï¼Œä»¥åŠå†…å­˜åªæœ‰2Gçš„åŸå› å¯¼è‡´çš„ã€‚å¦å¤–è¯´æ˜ä¸€ç‚¹çš„æ˜¯ï¼Œæ’å…¥3Wæ¡æ•°æ®ä¹‹åï¼Œçœ‹åˆ°çš„products.MYDæœ‰1.5Gäº†~","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448168,"discussion_content":"æ’å…¥æ›´å¤šçš„æ•°æ®è¯•è¯•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556370215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88647,"user_name":"ç‹ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1046001,"ip_address":"","ucode":"ABA3781E6DD5DB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/f1/4b26ac7d.jpg","comment_is_top":false,"comment_ctime":1555978660,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555978660","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":82586,"user_name":"å¤§é£","can_delete":false,"product_type":"c1","uid":1320080,"ip_address":"","ucode":"2D98888FC63CA9","user_header":"","comment_is_top":false,"comment_ctime":1554254889,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1554254889","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":75725,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1552457703,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1552457703","product_id":100020901,"comment_content":"DAY28ï¼Œæ‰“å¡","like_count":0},{"had_liked":false,"id":65474,"user_name":"Geek_33409b","can_delete":false,"product_type":"c1","uid":1112756,"ip_address":"","ucode":"9C64C42F799403","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/b4/6892eabe.jpg","comment_is_top":false,"comment_ctime":1549383447,"is_pvip":false,"replies":[{"id":"23249","content":"è¯•è¯• echo 3","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1549636273,"ip_address":"","comment_id":65474,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1549383447","product_id":100020901,"comment_content":"æ‰“å¡day29 ï¼Œä¹‹å‰åœ¨å·¥ä½œä¸­é‡åˆ°è¿‡ é‡Šæ”¾ç¼“å­˜çš„æƒ…å†µï¼Œä½†æ˜¯ä¹Ÿä¼šå‘ç°echo 1åœ¨æŸäº›æƒ…å†µä¸‹æ²¡æœ‰åŠæ³•æœ‰æ•ˆåœ°é‡Šæ”¾ç¼“å­˜ï¼Œè¿™ä¼šæ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438460,"discussion_content":"è¯•è¯• echo 3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1549636273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":64894,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1548943154,"is_pvip":false,"replies":[{"id":"22992","content":"å—¯å—¯ï¼Œè¦çœ‹åœºæ™¯çš„ã€‚æ¯”å¦‚ï¼Œå¯¹ä¸€ä¸ªå®šæœŸè¯„ä¼°ç³»ç»Ÿæ€§èƒ½çš„å·¥å…·ï¼Œä¸ºäº†è·å¾—å‡†ç¡®çš„æŒ‡æ ‡ï¼Œå°±æœ‰å¯èƒ½è¿™ä¹ˆåšï¼ˆä¸è¿‡è¿™ç§åº”ç”¨è·Ÿå…¶ä»–ä¸šåŠ¡ä¸€èˆ¬éƒ½æ˜¯åˆ†å¼€éƒ¨ç½²ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548944583,"ip_address":"","comment_id":64894,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548943154","product_id":100020901,"comment_content":"[D28æ‰“å¡]<br>å±…ç„¶æ¼æ‰“å¡äº†ï¼Œå›æ¥è¡¥ä¸Šã€‚<br>å¹³å¸¸å¶å°”æ‰‹åŠ¨é‡Šæ”¾ç¼“å­˜è¿˜æœ‰å¯èƒ½ï¼Œä½†æŠŠè¿™ä¸ªæ“ä½œæ”¾åœ¨éœ€è¦é¢‘ç¹æ‰§è¡Œçš„ä»£ç ä¸­å°±æœ‰ç‚¹ä¸ç§‘å­¦äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":438223,"discussion_content":"å—¯å—¯ï¼Œè¦çœ‹åœºæ™¯çš„ã€‚æ¯”å¦‚ï¼Œå¯¹ä¸€ä¸ªå®šæœŸè¯„ä¼°ç³»ç»Ÿæ€§èƒ½çš„å·¥å…·ï¼Œä¸ºäº†è·å¾—å‡†ç¡®çš„æŒ‡æ ‡ï¼Œå°±æœ‰å¯èƒ½è¿™ä¹ˆåšï¼ˆä¸è¿‡è¿™ç§åº”ç”¨è·Ÿå…¶ä»–ä¸šåŠ¡ä¸€èˆ¬éƒ½æ˜¯åˆ†å¼€éƒ¨ç½²ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548944583,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63846,"user_name":"å”¯ç¾","can_delete":false,"product_type":"c1","uid":1263430,"ip_address":"","ucode":"9186A5B99DFBCA","user_header":"https://static001.geekbang.org/account/avatar/00/13/47/46/61f16147.jpg","comment_is_top":false,"comment_ctime":1548554386,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548554386","product_id":100020901,"comment_content":"æ‰“å¡Day27","like_count":0},{"had_liked":false,"id":63313,"user_name":"å®‰å°ä¾","can_delete":false,"product_type":"c1","uid":1101660,"ip_address":"","ucode":"A5C414C7B994FF","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/5c/d4e19eb6.jpg","comment_is_top":false,"comment_ctime":1548320687,"is_pvip":false,"replies":[{"id":"22584","content":"pipe æ˜¯ä¸€ä¸ªç®¡é“ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ lsof æ‰¾ä¸€ä¸‹ pipe çš„å¯¹ç«¯è¿›ç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548576569,"ip_address":"","comment_id":63313,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548320687","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œä¸Šæ¬¡ç•™è¨€è¯´ Java æ— æ³• strace æ‰“æ—¥å¿—çš„é—®é¢˜è§£å†³äº†ï¼ŒåŸæ¥ strace å¿…é¡»è·Ÿä¸Š -f é€‰é¡¹æ‰å¯ä»¥ï¼Œæœ€ç»ˆå®šä½åˆ°å½“ç–¯ç‹‚ System.out.println çš„æ—¶å€™ï¼ŒåŸæ¥æ˜¯å†™åˆ° pipe ç®¡é“é‡Œè¾¹å»äº†ï¼š<br><br>java    2794   zk    1w  FIFO               0,12      0t0  3626492 pipe<br><br>åˆ°è¿™ä¸ªåœ°æ–¹è¿˜æ˜¯ç†è§£ä¸äº†ï¼Œè¿™ä¸ª pipe æœ€ç»ˆæ˜¯å­˜æ”¾åœ¨å“ªé‡Œäº†å‘¢ï¼Ÿä¸ºä»€ä¹ˆç–¯ç‹‚æ‰“æ—¥å¿—ï¼Œä¼šæŠŠç£ç›˜æ‰“æ»¡å‘¢ï¼Ÿè°¢è°¢","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437542,"discussion_content":"pipe æ˜¯ä¸€ä¸ªç®¡é“ï¼Œè€Œä¸æ˜¯æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ lsof æ‰¾ä¸€ä¸‹ pipe çš„å¯¹ç«¯è¿›ç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63163,"user_name":"åˆ’æ—¶ä»£","can_delete":false,"product_type":"c1","uid":1061454,"ip_address":"","ucode":"9554CE2F83B77F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2o1Izf2YyJSnnI0ErZ51pYRlnrmibqUTaia3tCU1PjMxuwyXSKOLUYiac2TQ5pd5gNGvS81fVqKWGvDsZLTM8zhWg/132","comment_is_top":false,"comment_ctime":1548292153,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1548292153","product_id":100020901,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":63088,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1548248157,"is_pvip":false,"replies":[{"id":"22579","content":"å¢å¤§åˆå§‹åŒ–çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚å¢å¤§10å€ï¼‰å†è¯•è¯•å‘¢ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548576142,"ip_address":"","comment_id":63088,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1548248157","product_id":100020901,"comment_content":"centosä¸‹æ‰§è¡Œè¿™ä¸ªæ¡ˆä¾‹ï¼Œä¸ä¼šå‡ºç°æŸ¥è¯¢æ…¢çš„æƒ…å†µï¼Œå¾ˆæ­£å¸¸çš„ç»“æŸ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437467,"discussion_content":"å¢å¤§åˆå§‹åŒ–çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚å¢å¤§10å€ï¼‰å†è¯•è¯•å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284647,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9a/27/4b81bce5.jpg","nickname":"ç¬‘","note":"","ucode":"C91EAFAB88E5AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3454,"discussion_content":"ä¼šå‡ºç°çš„ï¼Œä¸è¿‡æ²¡æœ‰åå‡ ç§’é‚£ä¹ˆä¹…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564493842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63082,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1548246594,"is_pvip":false,"replies":[{"id":"22578","content":"çœ‹æ¥ä½ çš„ç³»ç»Ÿé…ç½®æ¯”è¾ƒé«˜ï¼Œå¢åŠ ä¸‹åˆå§‹åŒ–æ—¶çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚å¢åŠ 10å€ï¼‰å†è¯•è¯•ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548576100,"ip_address":"","comment_id":63082,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1548246594","product_id":100020901,"comment_content":"curl http:&#47;&#47;192.168.193.132:10000&#47;products&#47;geektime<br>Got data: () in 0.4080049991607666 sec <br>æ—¶é—´å¾ˆå¿«å¹¶æ²¡æœ‰å‡ºç°é•¿æ—¶é—´æŸ¥è¯¢çš„æƒ…å†µ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437463,"discussion_content":"çœ‹æ¥ä½ çš„ç³»ç»Ÿé…ç½®æ¯”è¾ƒé«˜ï¼Œå¢åŠ ä¸‹åˆå§‹åŒ–æ—¶çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚å¢åŠ 10å€ï¼‰å†è¯•è¯•ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548576100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1284647,"avatar":"https://static001.geekbang.org/account/avatar/00/13/9a/27/4b81bce5.jpg","nickname":"ç¬‘","note":"","ucode":"C91EAFAB88E5AC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3455,"discussion_content":"å‡ ç™¾æ¯«ç§’ä¹Ÿå¾ˆé•¿æ—¶é—´äº†å§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564493892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":63077,"user_name":"å¾€äº‹éšé£ï¼Œé¡ºå…¶è‡ªç„¶","can_delete":false,"product_type":"c1","uid":1235692,"ip_address":"","ucode":"F266EC6B143E38","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg","comment_is_top":false,"comment_ctime":1548245625,"is_pvip":false,"replies":[{"id":"22577","content":"mysql æ²¡æœ‰è¿è¡Œèµ·æ¥ï¼Œè¿è¡Œ docker logs mysql çœ‹çœ‹æŠ¥äº†ä»€ä¹ˆé”™è¯¯ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548575812,"ip_address":"","comment_id":63077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548245625","product_id":100020901,"comment_content":"make runæŠ¥é”™å¦‚ä¸‹ï¼š<br>flag provided but not defined: --network<br>mysql-slowè¿™ä¸ªæ²¡æ³•è¿è¡Œèµ·æ¥","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437460,"discussion_content":"mysql æ²¡æœ‰è¿è¡Œèµ·æ¥ï¼Œè¿è¡Œ docker logs mysql çœ‹çœ‹æŠ¥äº†ä»€ä¹ˆé”™è¯¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548575812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62969,"user_name":"ä»²é¬¼","can_delete":false,"product_type":"c1","uid":1314692,"ip_address":"","ucode":"DB1CD7052D5BA6","user_header":"https://static001.geekbang.org/account/avatar/00/14/0f/84/d8e63885.jpg","comment_is_top":false,"comment_ctime":1548216680,"is_pvip":false,"replies":[{"id":"22342","content":"ç¬¬2æ¡æœ‰å¯èƒ½ä¹Ÿæ˜¯å¾ˆæ…¢çš„ï¼Œå½“ç„¶æ…¢çš„ç¨‹åº¦å–å†³äºæ“ä½œå’Œæ•°æ®é‡çš„å¤§å°","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1548252296,"ip_address":"","comment_id":62969,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1548216680","product_id":100020901,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘è®¤ä¸ºexplainçš„ç»“æœå·²ç»èƒ½è¯´æ˜page cacheæœªç¼“å­˜MYDæ–‡ä»¶ã€‚<br><br>åŸå› ï¼š<br>1. typeä¸ºALLè¡¨ç¤ºä¸ä½¿ç”¨ç´¢å¼•ï¼Œå…¨è¡¨æŸ¥è¯¢ï¼›<br>2. keysä¸ºNULLè¡¨ç¤ºä¸ä½¿ç”¨ç´¢å¼•ã€‚<br>ç»“è®ºï¼šè¯¥è¯­å¥éœ€è¦æ‰«æå…¨è¡¨ã€‚<br><br>è¡¥å……MyISAMçš„ä¸€äº›é‡è¦ç‰¹ç‚¹ï¼š<br>1. æŸ¥è¯¢æ•°æ®æ—¶ï¼Œå¦‚æœèƒ½å‘½ä¸­ç´¢å¼•ï¼Œä¼šå…ˆåœ¨ç´¢å¼•ä¸­æŸ¥è¯¢åŒ¹é…è¡Œçš„ä½ç½®ï¼Œå†å»MYDæ–‡ä»¶ä¸­å–æ•°æ®ã€‚<br>2. MyISAMè‡ªå·±ç»´æŠ¤ç´¢å¼•ï¼ˆMYIæ–‡ä»¶ï¼‰çš„ç¼“å­˜ï¼Œåˆ©ç”¨page cacheç»´æŠ¤æ•°æ®ï¼ˆMYDæ–‡ä»¶ï¼‰çš„ç¼“å­˜ã€‚<br><br>ç»“åˆä¹‹å‰è¿”å›çš„ç©ºç»“æœï¼Œç‰¹ç‚¹1è¯´æ˜è¡¨ä¸­ä¸å­˜åœ¨åŒ¹é…è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‰ç†è¯´åªæŸ¥è¯¢ç´¢å¼•åº”è¯¥å¾ˆå¿«èƒ½å¾—åˆ°â€œç©ºç»“æœâ€ï¼Œæ‰€ä»¥â€œå“åº”æ…¢â€è¯´æ˜æœªå»ºç«‹ç›¸å…³ç´¢å¼•ã€‚<br>ä½†æ ¹æ®ç‰¹ç‚¹2ï¼Œå°±ç®—æ˜¯æœªå»ºç«‹ç´¢å¼•ï¼Œåœ¨page cacheä¸­é¡ºåºè¯»å…¨è¡¨æ•°æ®ä¹Ÿä¸ä¼šè¿™ä¹ˆæ…¢ï¼Œæ‰€ä»¥ï¼Œç‰¹ç‚¹2è¯´æ˜page cacheæœªç¼“å­˜MYDæ–‡ä»¶ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437421,"discussion_content":"ç¬¬2æ¡æœ‰å¯èƒ½ä¹Ÿæ˜¯å¾ˆæ…¢çš„ï¼Œå½“ç„¶æ…¢çš„ç¨‹åº¦å–å†³äºæ“ä½œå’Œæ•°æ®é‡çš„å¤§å°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548252296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}