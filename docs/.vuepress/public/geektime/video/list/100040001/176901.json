{"id":176901,"title":"22 | äº‹åŠ¡å¼€å‘ï¼šå¤šæ–‡æ¡£äº‹åŠ¡","content":"<p><strong>è¯¾ä»¶å’ŒDemoåœ°å€</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":163362,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c3","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1576713211,"is_pvip":false,"replies":[{"id":62380,"content":"è¿™ä¸ªå•æ–‡æ¡£äº‹åŠ¡å«æ³•èƒŒåçš„é€»è¾‘ï¼š\n\nå…³ç³»å‹é‡Œé¢ï¼Œç”¨æˆ·è¡¨å’Œç”¨æˆ·ç”µè¯æ˜¯åˆ†å¼€åœ¨ä¸¤å¼ è¡¨ã€‚å½“ä½ éœ€è¦æ–°å¢ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œä½ éœ€è¦ï¼š\n   insert into USER\n   insert into PHONE\nè¿™ä¸¤ä¸ªDMLéœ€è¦æ”¾åœ¨äº‹åŠ¡èŒƒå›´å†…ï¼Œä¿è¯ä¸¤æ¡æ•°æ®ï¼ˆå…¶å®æ˜¯ä¸€æ¡ï¼Œç”¨æˆ·æ•°æ®ï¼‰è¦ä¹ˆä¸€èµ·æˆåŠŸå†™å…¥ï¼Œè¦ä¹ˆå›æ»šã€‚\n\nåœ¨MongoDBé‡Œé¢ï¼Œç±»ä¼¼çš„æ“ä½œå˜æˆäº†ä¸€ä¸ªå•æ–‡æ¡£æ“ä½œï¼š\n\n   db.user.insert({ name: &quot;TJ&quot;ï¼Œphone: [&quot;1234&quot;]})\n\nè¿™ä¸ªæ“ä½œé‡Œé¢å…¶å®ç›¸å½“äºåšäº†ä¸¤ä¸ªäº‹æƒ…ï¼š1ï¼‰ æ·»åŠ ç”¨æˆ·  2ï¼‰ æ·»åŠ ç”µè¯å·ç ã€‚è¿™ä¸¤ä¸ªäº‹æƒ…æ˜¯æœ‰åŸå­äº‹åŠ¡æ€§çš„-è¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ã€‚\n\nè¿™ä¸ªæ˜¯mongoå•æ–‡æ¡£äº‹åŠ¡çš„ç”±æ¥ã€‚\n\n\n\n","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1576894733,"ip_address":"","comment_id":163362,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"MongoDBè¿˜æ˜¯å¾ˆå‰å®³çš„ï¼Œä¸€å¼€å§‹å°±æ”¯æŒå•æ–‡æ¡£äº‹åŠ¡ï¼Œ4.0æ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡ï¼Œ4.2æ”¯æŒæœ‰åˆ†ç‰‡çš„åˆ†å¸ƒå¼äº‹åŠ¡ã€‚ä¸è¿‡ï¼Œå•æ–‡æ¡£äº‹åŠ¡è¿™å«æ³•æœ‰ç‚¹é¸¡è‚‹ï¼Œè™½ç„¶ä¹Ÿçš„ç¡®æ˜¯äº‹åŠ¡ï¼Œä½†ä¸€èˆ¬æˆ‘ä»¬è®²äº‹åŠ¡æ—¶ï¼Œé»˜è®¤æ˜¯æŒ‡å¤šæ–‡æ¡£çš„ï¼Œå¯¹æ¯”MySQLå°±æ˜¯å¤šè¡Œã€‚å¦‚æœæˆ‘åœ¨3.2ä¸­ç”¨ä¸¤æ¡æ›´æ–°è¯­å¥æ›´æ–°ä¸€ä¸ªæ–‡æ¡£ï¼Œé‚£åº”è¯¥ä¹Ÿä¸æ˜¯äº‹åŠ¡å§ï¼Ÿå•æ–‡æ¡£äº‹åŠ¡è¿™å«æ³•ï¼Œç»™äººæ„Ÿè§‰åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸Šæ‰§è¡Œå¤šæ¡DMLï¼Œä½¿ç”¨çš„ä¸€ä¸ªäº‹åŠ¡ï¼Œä½†å…¶å®ä¸æ˜¯ã€‚å¦å¤–ï¼ŒMongoDBåœ¨æ²¡æœ‰æ˜¾å¼ä½¿ç”¨äº‹åŠ¡è¯­å¥æ—¶ï¼Œåº”è¯¥å°±æ˜¯è‡ªåŠ¨æäº¤å§ã€‚","like_count":8,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478365,"discussion_content":"è¿™ä¸ªå•æ–‡æ¡£äº‹åŠ¡å«æ³•èƒŒåçš„é€»è¾‘ï¼š\n\nå…³ç³»å‹é‡Œé¢ï¼Œç”¨æˆ·è¡¨å’Œç”¨æˆ·ç”µè¯æ˜¯åˆ†å¼€åœ¨ä¸¤å¼ è¡¨ã€‚å½“ä½ éœ€è¦æ–°å¢ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œä½ éœ€è¦ï¼š\n   insert into USER\n   insert into PHONE\nè¿™ä¸¤ä¸ªDMLéœ€è¦æ”¾åœ¨äº‹åŠ¡èŒƒå›´å†…ï¼Œä¿è¯ä¸¤æ¡æ•°æ®ï¼ˆå…¶å®æ˜¯ä¸€æ¡ï¼Œç”¨æˆ·æ•°æ®ï¼‰è¦ä¹ˆä¸€èµ·æˆåŠŸå†™å…¥ï¼Œè¦ä¹ˆå›æ»šã€‚\n\nåœ¨MongoDBé‡Œé¢ï¼Œç±»ä¼¼çš„æ“ä½œå˜æˆäº†ä¸€ä¸ªå•æ–‡æ¡£æ“ä½œï¼š\n\n   db.user.insert({ name: &amp;quot;TJ&amp;quot;ï¼Œphone: [&amp;quot;1234&amp;quot;]})\n\nè¿™ä¸ªæ“ä½œé‡Œé¢å…¶å®ç›¸å½“äºåšäº†ä¸¤ä¸ªäº‹æƒ…ï¼š1ï¼‰ æ·»åŠ ç”¨æˆ·  2ï¼‰ æ·»åŠ ç”µè¯å·ç ã€‚è¿™ä¸¤ä¸ªäº‹æƒ…æ˜¯æœ‰åŸå­äº‹åŠ¡æ€§çš„-è¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ã€‚\n\nè¿™ä¸ªæ˜¯mongoå•æ–‡æ¡£äº‹åŠ¡çš„ç”±æ¥ã€‚\n\n\n\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576894733,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1519881,"avatar":"https://static001.geekbang.org/account/avatar/00/17/31/09/f5d68957.jpg","nickname":"ç¤¼æ‹œä¸‰","note":"","ucode":"C36A84E76E163D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311029,"discussion_content":"åœ¨ MySQL ä¸­ä»»æ„ä¸€æ¡ SQL è¯­å¥éƒ½æ˜¯ä¸€ä¸ªäº‹åŠ¡å§ï¼Œä¾‹å¦‚ INSERT INTO table1 VALUE (1); å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ã€‚è¿™æ¡è¯­å¥å®é™…ä¸Šä¹Ÿä¼šé»˜è®¤æ‰§è¡Œ BEGIN + COMMIT ã€‚\n\nMySQL ä¸­æ˜¾å¼ä½¿ç”¨ BEGIN + COMMIT æ§åˆ¶äº‹åŠ¡å°±æ˜¯ä¾¿äºå¤šä¸ª SQL è¯­å¥åˆæˆä¸€ä¸ªäº‹åŠ¡ã€‚å…¶å®å•ä¸ª SQL è¯­å¥ä¹Ÿæ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè¿™å°±å’Œ MongoDB çš„å•æ–‡æ¡£äº‹åŠ¡ä¸€æ ·äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602176422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019332,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","nickname":"é•¿æœŸè§„åˆ’","note":"","ucode":"5EF65E9115834B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":93035,"discussion_content":"è°¢è°¢è€å¸ˆçš„è§£ç­”ï¼Œæˆ‘æ˜ç™½äº†ğŸ˜‰ğŸ‘ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576900468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":166788,"user_name":"Mao","can_delete":false,"product_type":"c3","uid":1060202,"ip_address":"","ucode":"14CC85BC590A71","user_header":"https://static001.geekbang.org/account/avatar/00/10/2d/6a/323163df.jpg","comment_is_top":false,"comment_ctime":1577595121,"is_pvip":false,"replies":[{"id":65200,"content":"äº‹åŠ¡æ€§æœ‰ACIDå››ä¸ªå±æ€§ï¼Œä½ ä¸Šé¢è®²çš„æ˜¯ACIDé‡Œé¢çš„Iï¼Œ Isolationã€‚Isolationéš”ç¦»æ€§å…³æ³¨çš„å°±æ˜¯è·Ÿè¯»ç›¸å…³çš„äº‹æƒ…ã€‚\n\nä½ è¯´çš„å¢åˆ æ”¹äº‹åŠ¡ï¼Œå¤šåŠæ˜¯å’ŒAç›¸å…³ï¼ŒAtomicityï¼ŒåŸå­æ€§ã€‚ä¸€èµ·æäº¤ï¼Œæˆ–è€…å…¨éƒ¨å›æ»šã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1577967851,"ip_address":"","comment_id":166788,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"äº‹åŠ¡å¼•å…¥çš„åˆè¡·ï¼Œæ˜¯ä¸ºäº†è§£å†³æœ‰å¤šä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°è„è¯»ï¼ˆdirty readï¼‰ã€\nä¸å¯é‡å¤è¯»ï¼ˆnon-repeatable readï¼‰ã€å¹»è¯»ï¼ˆphantom readï¼‰çš„é—®é¢˜\n\nMongoDBçš„äº‹åŠ¡åˆ†ä¸ºï¼š\navailableï¼šè¯»å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®\nlocalï¼šè¯»å–æ‰€æœ‰å¯ç”¨ä¸”å±äºå½“å‰åˆ†ç‰‡çš„æ•°æ®\nmajorityï¼šè¯»å–åœ¨å¤§å¤šæ•°èŠ‚ç‚¹ä¸Šæäº¤å®Œæˆçš„æ•°æ®\nlinearizableï¼šå¯çº¿æ€§åŒ–è¯»å–æ–‡æ¡£\nsnapshotï¼šè¯»å–æœ€è¿‘å¿«ç…§ä¸­çš„æ•°æ®\n\nMySQLçš„äº‹åŠ¡åˆ†ä¸ºï¼š\nè¯»æœªæäº¤ï¼ˆread uncommittedï¼‰\nè¯»æäº¤ï¼ˆread committedï¼‰\nå¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰\nä¸²è¡ŒåŒ–ï¼ˆserializable ï¼‰\n\næŒ‰ç…§å­—é¢ç†è§£ï¼Œæ— è®ºæ˜¯MongoDBè¿˜æ˜¯MySQLï¼Œå®ƒä»¬å¼•å…¥äº‹åŠ¡ä¼¼ä¹éƒ½æ˜¯ä¸ºäº†è§£å†³â€œè¯»â€çš„é—®é¢˜ã€‚\n\nä½†æ˜¯æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæ˜¯åœ¨å¤šæ–‡æ¡£&#47;è¡¨ çš„insertã€updateã€remove è¿™äº›â€œéè¯»â€çš„åœºæ™¯ä¸‹ä½¿ç”¨ã€‚\n\né‚£ä¹ˆæˆ‘æ˜¯å¦åº”è¯¥ç†è§£ä¸ºï¼Œæ‰€è°“çš„äº‹åŠ¡ï¼Œæ˜¯MongoDB&#47;MySQL çš„serviceå±‚åœ¨æ‰§è¡Œ insertã€updateã€remove\n\næ“ä½œå‰ï¼Œå¯¹å·²æœ‰æ•°æ®çš„ä¸€ä¸ªéªŒè¯å‘¢ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479625,"discussion_content":"äº‹åŠ¡æ€§æœ‰ACIDå››ä¸ªå±æ€§ï¼Œä½ ä¸Šé¢è®²çš„æ˜¯ACIDé‡Œé¢çš„Iï¼Œ Isolationã€‚Isolationéš”ç¦»æ€§å…³æ³¨çš„å°±æ˜¯è·Ÿè¯»ç›¸å…³çš„äº‹æƒ…ã€‚\n\nä½ è¯´çš„å¢åˆ æ”¹äº‹åŠ¡ï¼Œå¤šåŠæ˜¯å’ŒAç›¸å…³ï¼ŒAtomicityï¼ŒåŸå­æ€§ã€‚ä¸€èµ·æäº¤ï¼Œæˆ–è€…å…¨éƒ¨å›æ»šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577967851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1525840,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIUlVIL2Y7gVjfuubGmkKVXUv9LUlZURwK0fwnHz4xrzaqf2BjwwSXXNwLrTcxdRnnwhTlwnV1Xcg/132","nickname":"ç‚ç‚","note":"","ucode":"386E790507C66D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221671,"discussion_content":"æ¥ç€é—®é¢˜ï¼Œæƒ³ç»§ç»­è¯·åŠ è€å¸ˆï¼Œå¯ä»¥ç†è§£mysqlä¸­çš„â€œread committedâ€å¯¹åº”mongoä¸­çš„â€œmajorityâ€ã€‚ é‚£ä¹ˆæˆ‘çš„é—®é¢˜æ˜¯åªæœ‰â€œå¤åˆ¶é›†â€æ¨¡å¼ä¸‹æ‰æœ‰è¿™äº›å¯è§æ€§çš„åŒºåˆ†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586044256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":164555,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c3","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1577026511,"is_pvip":false,"replies":[{"id":62939,"content":"ä½ è¦é—®æˆ‘ï¼Œè‚¯å®šæ˜¯äº†ã€‚ä»CRUDæ“ä½œæ¥è¯´ï¼ŒJSON æ•°æ®åº“æ›´åŠ æ–¹ä¾¿ã€‚æ”¯æŒäº‹åŠ¡ä»¥åï¼Œç°åœ¨MongoDBå‰©ä¸‹çš„å°±æ˜¯ åšBIåˆ†æäº†è¿™ä¸€å—å¯èƒ½è¿˜ä¸ç®—å¤ªå¼ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1577181543,"ip_address":"","comment_id":164555,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œç½‘ä¸Šçœ‹åˆ°çš„æ–‡ç« éƒ½è¯´MySQLæ¯”MongoDBçš„æœ€å¤§ä¼˜åŠ¿æ˜¯æ”¯æŒäº‹åŠ¡ï¼ˆå¤šè¡¨ï¼‰ï¼Œä½†ç°åœ¨MongoDB 4.0ä¹‹åå·²ç»æ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡äº†ï¼Œé‚£æˆ‘æ„Ÿè§‰MySQLç›¸å¯¹MongoDBæ¥è¯´å°±æ²¡å•¥ä¼˜åŠ¿äº†ï¼Œå½“ç„¶ï¼ŒMySQLæœ‰å¤–é”®ï¼Œjoinç­‰æ›´å¼ºå¤§ä¸€äº›ï¼Œä½†è¿™äº›ç‰¹æ€§ä¸€èˆ¬ä¸æ˜¯é€‰æ‹©MySQLæ˜¯æ ¹æœ¬åŸå› ã€‚æˆ‘æ„Ÿè§‰æ‰€æœ‰åœºæ™¯ä¸‹ï¼Œéƒ½å¯ä»¥ç”¨MongoDBä»£æ›¿MySQLï¼Œæ˜¯è¿™æ ·å—","like_count":4,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478812,"discussion_content":"ä½ è¦é—®æˆ‘ï¼Œè‚¯å®šæ˜¯äº†ã€‚ä»CRUDæ“ä½œæ¥è¯´ï¼ŒJSON æ•°æ®åº“æ›´åŠ æ–¹ä¾¿ã€‚æ”¯æŒäº‹åŠ¡ä»¥åï¼Œç°åœ¨MongoDBå‰©ä¸‹çš„å°±æ˜¯ åšBIåˆ†æäº†è¿™ä¸€å—å¯èƒ½è¿˜ä¸ç®—å¤ªå¼ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577181543,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1019332,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","nickname":"é•¿æœŸè§„åˆ’","note":"","ucode":"5EF65E9115834B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":98699,"discussion_content":"å¤šè°¢è€å¸ˆè§£ç­”ğŸ‘ğŸ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577182697,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":165174,"user_name":"è“é­”ä¸¶","can_delete":false,"product_type":"c3","uid":1219438,"ip_address":"","ucode":"2AE4359E263558","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/6e/edd2da0c.jpg","comment_is_top":false,"comment_ctime":1577175532,"is_pvip":false,"replies":[{"id":65231,"content":"è¿™ä¸ªåé¦ˆå¯ä»¥å»jira.mongodb.org å»æä¸€ä¸ªIssue,å±äºäº§å“å»ºè®®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1577974262,"ip_address":"","comment_id":165174,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"\näº‹åŠ¡å†™å†²çªMongoDBçš„å¤„ç†æ–¹å¼ä¸ºä»€ä¹ˆä¼šæœ‰äº‹åŠ¡å†…aboutå’Œäº‹åŠ¡å¤–ç­‰å¾…ä¸¤ç§å¤„ç†æ–¹å¼ï¼Œä¸ºä»€ä¹ˆä¸ä¸å…³ç³»æ•°æ®åº“mysqlå¤„ç†æ–¹å¼ä¸€æ ·ä¸ç®¡äº‹åŠ¡å†…è¿˜æ˜¯äº‹åŠ¡å¤–éƒ½é‡‡ç”¨ç­‰å¾…è¶…æ—¶çš„ç­–ç•¥ï¼Œmysqlä¼šåœ¨å†™å†²çªæ—¶ç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œè€Œä¸”ä¿è¯æ˜¯å½“å‰è¯»æ“ä½œï¼Œèƒ½å¤Ÿä¿è¯äº‹åŠ¡æ›´æ–°çš„æ­£ç¡®æ€§ï¼Œå¦‚æœç­‰å¾…è¶…æ—¶ï¼Œåˆ™ä¼šç›´æ¥crashæ‰è¿™ä¸ªäº‹åŠ¡å¹¶ä¸ä¼šåƒMongoDBè¿™æ ·æŠ¥é”™aboutè¿˜æ²¡æœ‰æ¸…é™¤äº‹åŠ¡ï¼Œéœ€è¦æ‰‹åŠ¨åˆ é™¤ï¼Œè¿™ç§æ–¹å¼å¥½å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":479059,"discussion_content":"è¿™ä¸ªåé¦ˆå¯ä»¥å»jira.mongodb.org å»æä¸€ä¸ªIssue,å±äºäº§å“å»ºè®®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577974262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193508,"user_name":"ä¾ä¹ç¥","can_delete":false,"product_type":"c3","uid":1320243,"ip_address":"","ucode":"0FAE2C7FE1ECDB","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/33/290fcb42.jpg","comment_is_top":false,"comment_ctime":1584921913,"is_pvip":false,"replies":[{"id":74325,"content":"ä¼šäº§ç”Ÿæ—¥å¿—ã€‚æ—¥å¿—é‡Œæœ‰ä¸ªç‰¹æ®Šå­—æ®µä¼šæ ‡è®°å‡ºæ¥æ˜¯æ¥è‡ªäºchunk migration","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1585221599,"ip_address":"","comment_id":193508,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆé—®ä¸‹ï¼Œchunkè¿‡ç¨‹ä¸­å„ä¸ªåˆ†ç‰‡ä¸Šçš„oplogæ˜¯ä¼šå˜åŒ–çš„å—ï¼Ÿè¿™æ—¶å€™oplogè·Ÿåˆ†ç‰‡ä¸Šçš„æ•°æ®èƒ½å¯¹åº”èµ·æ¥å—ï¼Ÿè¿™éƒ¨åˆ†æ—¥å¿—æ˜¯ä¸æ˜¯æ— ç”¨çš„æ—¥å¿—å•Š","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488572,"discussion_content":"ä¼šäº§ç”Ÿæ—¥å¿—ã€‚æ—¥å¿—é‡Œæœ‰ä¸ªç‰¹æ®Šå­—æ®µä¼šæ ‡è®°å‡ºæ¥æ˜¯æ¥è‡ªäºchunk migration","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585221599,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180855,"user_name":"é•¿è„–å­æ ‘","can_delete":false,"product_type":"c3","uid":1182802,"ip_address":"","ucode":"D9090EF67EEB1B","user_header":"https://static001.geekbang.org/account/avatar/00/12/0c/52/f25c3636.jpg","comment_is_top":false,"comment_ctime":1582429840,"is_pvip":true,"replies":[{"id":70957,"content":"è¿™ä¸ªæ˜¯è®¾è®¡å¦‚æ­¤ï¼Œä¹Ÿæ˜¯åˆç†çš„ã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ¯ä¸ªæ“ä½œåº”ç”¨ä¸€æ ·çš„éš”ç¦»çº§åˆ«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1583029691,"ip_address":"","comment_id":180855,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆå¥½, æˆ‘åœ¨æœ¬èŠ‚è¯¾ç¨‹æœ€åçš„æ³¨æ„äº‹é¡¹ä¸­çœ‹åˆ°,  readConcern åªåº”è¯¥åœ¨äº‹åŠ¡çº§åˆ«ä¸­è®¾ç½®, ä¸èƒ½è®¾ç½®åœ¨æ¯æ¬¡è¯»å†™æ“ä½œä¸Š, \næŒ‡çš„æ˜¯åœ¨ session.startTransaction ä¸­è®¾ç½®ä¹ˆ?  ä¸ºä»€ä¹ˆ?","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484817,"discussion_content":"è¿™ä¸ªæ˜¯è®¾è®¡å¦‚æ­¤ï¼Œä¹Ÿæ˜¯åˆç†çš„ã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ¯ä¸ªæ“ä½œåº”ç”¨ä¸€æ ·çš„éš”ç¦»çº§åˆ«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583029691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":180790,"user_name":"cording","can_delete":false,"product_type":"c3","uid":1786385,"ip_address":"","ucode":"82063AEC231613","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlllSKrpQkhSXyNj0glDoCiaMKp23ey4Fw0nr54MKKhYAIxxU7toQuukJe2qZjwUC990ojdNmeicVQ/132","comment_is_top":false,"comment_ctime":1582389341,"is_pvip":false,"replies":[{"id":70141,"content":"ä½ è¿™ä¸ªä¸ç”¨åˆ†å¸ƒå¼äº‹åŠ¡å§ï¼Œç”¨  findAndModifyå°±å¯ä»¥å®ç°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1582421188,"ip_address":"","comment_id":180790,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³è¯·æ•™ä¸€ä¸‹mongodbæœ‰åˆ†å¸ƒå¼äº‹åŠ¡é”å—ï¼Ÿæˆ‘æƒ³å®ç°æŸä¸€å­—æ®µintå€¼è‡ªå¢ç”Ÿæˆå”¯ä¸€ä¸»é”®","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484791,"discussion_content":"ä½ è¿™ä¸ªä¸ç”¨åˆ†å¸ƒå¼äº‹åŠ¡å§ï¼Œç”¨  findAndModifyå°±å¯ä»¥å®ç°äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582421188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1786385,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlllSKrpQkhSXyNj0glDoCiaMKp23ey4Fw0nr54MKKhYAIxxU7toQuukJe2qZjwUC990ojdNmeicVQ/132","nickname":"cording","note":"","ucode":"82063AEC231613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":183500,"discussion_content":"è°¢è°¢è€å¸ˆï¼Œåœ¨mongodbåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œé«˜å¹¶å‘è·å–è¿™ç§è‡ªå¢ç”Ÿæˆçš„å”¯ä¸€ä¸»é”®ï¼Œä¸ä¼šé‡å¤å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582475256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186063,"user_name":"cicoding","can_delete":false,"product_type":"c3","uid":1046611,"ip_address":"","ucode":"07FAC3B7D31583","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/53/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1583748358,"is_pvip":false,"replies":[{"id":72145,"content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ï¼Œå¯ä»¥è¯¦ç»†æè¿°ä¸€äº›ä¹ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"è¿œèˆªçš„TJ å”å»ºæ³•","uid":1260017,"ctime":1584002328,"ip_address":"","comment_id":186063,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"ä½ å¥½è€å¸ˆï¼Œmongodbåœ¨javaä¸­å¼€å¯äº‹åŠ¡ï¼Œä¼šå¯¼è‡´mysqlçš„é£Ÿç‰©å¤±æ•ˆï¼Œè¿™ä¸ªæ€ä¹ˆè§£å†³å‘¢","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"è¿œèˆªçš„TJ å”å»ºæ³•","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486606,"discussion_content":"ä¸å¤ªæ˜ç™½ä½ çš„é—®é¢˜ï¼Œå¯ä»¥è¯¦ç»†æè¿°ä¸€äº›ä¹ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584002328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167368,"user_name":"ä¸€å…µä¸€å’","can_delete":false,"product_type":"c3","uid":1208184,"ip_address":"","ucode":"594B4441559209","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/78/69a862ee.jpg","comment_is_top":false,"comment_ctime":1577777378,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå¯é‡å¤è¯»Repeatable Readæˆ‘æ˜¯ç†è§£ä¸ºäº‹åŠ¡å†…çš„æŸ¥è¯¢æ“ä½œåœ¨äº‹åŠ¡æäº¤ä¹‹å‰ï¼Œå¯¹äº‹åŠ¡å¤–çš„æ›´æ–°æ“ä½œæ— æ„ŸçŸ¥ï¼Œè¿˜æ˜¯å¯ä»¥æŸ¥åˆ°ä¹‹å‰çš„æ•°æ®ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œå³ä½¿äº‹åŠ¡å¯åŠ¨session.startTransaction()ï¼Œä¸åŠ readConcern: {level: &quot;snapshot&quot;}ä¹Ÿæ˜¯å¯ä»¥å®ç°","like_count":2,"discussions":[{"author":{"id":2714469,"avatar":"","nickname":"å°è´±è´±","note":"","ucode":"436BD03904BEE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":566339,"discussion_content":"mongodb äº‹åŠ¡é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯snapshot ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650649715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":395546,"user_name":"dahai","can_delete":false,"product_type":"c3","uid":1762705,"ip_address":"å±±ä¸œ","ucode":"9F866FC42DF9A8","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIVR2wY9icec2CGzZ4VKPdwK2icytM5k1tHm08qSEysFOgl1y7lk2ccDqSCvzibHufo2Cb9c2hjr0LIg/132","comment_is_top":false,"comment_ctime":1731199617,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"è§†é¢‘é‡Œçš„åŸå­æ€§å•è¯å†™é”™äº†å§ï¼Ÿåº”è¯¥æ˜¯ Atomicity","like_count":0},{"had_liked":false,"id":365917,"user_name":"éæ´²é»‘çŒ´å­","can_delete":false,"product_type":"c3","uid":2639724,"ip_address":"ç¾å›½","ucode":"F5FEAC07D562E0","user_header":"https://static001.geekbang.org/account/avatar/00/28/47/6c/78184d19.jpg","comment_is_top":false,"comment_ctime":1673231590,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":1,"score":3,"product_id":100040001,"comment_content":"ä¸Šä¸€èŠ‚çš„è¿™ä¸ªæ“ä½œï¼š \ndb.orders.find({oid:101}).readPref(â€œsecondaryâ€).readConcern(&quot;majority&quot;)\nä¸å°±æ˜¯æŠŠreadConcernè®¾ç½®åœ¨äº†æŸä¸€æ¬¡è¯»å†™æ“ä½œä¸Šäº†ï¼Ÿè¿™æ˜¯ä¸æ˜¯è·Ÿæœ€åä¸€æ¡æ³¨æ„äº‹é¡¹å†²çªäº†ï¼Ÿè°¢è°¢","like_count":0},{"had_liked":false,"id":334894,"user_name":"waponx","can_delete":false,"product_type":"c3","uid":1362351,"ip_address":"","ucode":"6DBA05835519D0","user_header":"https://static001.geekbang.org/account/avatar/00/14/c9/af/0e7f0c16.jpg","comment_is_top":false,"comment_ctime":1645173356,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œmongoä¸­é‡‡ç”¨mvccæ¶æ„ï¼Œé‚£ä¹ˆæ—§ç‰ˆæœ¬çš„æ•°æ®ï¼Œæ˜¯æ€ä¹ˆå›æ”¶ï¼Œç”±è°æ¥å›æ”¶ï¼Ÿ","like_count":0},{"had_liked":false,"id":280876,"user_name":"Ruby","can_delete":false,"product_type":"c3","uid":1741877,"ip_address":"","ucode":"78DCC0843B7F92","user_header":"https://static001.geekbang.org/account/avatar/00/1a/94/35/a5ace6ae.jpg","comment_is_top":false,"comment_ctime":1614434052,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"è¯·é—®mongodbä¸ºä»€ä¹ˆä¸æ”¯æŒå•èŠ‚ç‚¹éƒ¨ç½²çš„å¤šæ–‡æ¡£äº‹åŠ¡å‘¢ï¼Ÿæˆ‘å•èŠ‚ç‚¹ï¼Œæ“ä½œAå’ŒBè¡¨ï¼Œä¹Ÿæƒ³æœ‰åŸå­æ€§ï¼Œä¸å¯ä»¥å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":277708,"user_name":"Ruby","can_delete":false,"product_type":"c3","uid":1741877,"ip_address":"","ucode":"78DCC0843B7F92","user_header":"https://static001.geekbang.org/account/avatar/00/1a/94/35/a5ace6ae.jpg","comment_is_top":false,"comment_ctime":1612521551,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œè¯·é—®æ‚¨å¦‚ä½•çœ‹å¾… infoQé‡Œ å…³äº å¿«ç…§éš”ç¦»è€ŒéACIDï¼ŒMongoDBæ•°æ®ä¸€è‡´æ€§èƒ½åŠ›é­è´¨ç–‘è¿™ç¯‡æ–‡ç« ï¼Ÿ\nç¼–è€…æŒ‰ï¼Œä½¿ç”¨&quot;majority&quot;å†™é€‰é¡¹çš„äº‹åŠ¡å¯¼è‡´å…¶ä»–é—®é¢˜ã€‚\n","like_count":0},{"had_liked":false,"id":273245,"user_name":"å…”å­è¹¬é¹°","can_delete":false,"product_type":"c3","uid":2072549,"ip_address":"","ucode":"81E50CD71468BC","user_header":"https://static001.geekbang.org/account/avatar/00/1f/9f/e5/41378e64.jpg","comment_is_top":false,"comment_ctime":1610508119,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰é—®é¢˜æ±‚è§£ç­”ã€‚\næ®æˆ‘çš„äº†è§£ï¼ˆå¯èƒ½ä¸ä¸€å®šå¯¹å“ˆï¼‰ï¼ŒCAPç†è®ºä¸­ï¼ŒACIDäº‹åŠ¡å¯ä»¥æ»¡è¶³CAï¼ŒBASEæœ€ç»ˆä¸€è‡´æ€§ç†è®ºå¯ä»¥æ»¡è¶³APã€‚\nä½†æ˜¯å¦‚æœè¯´mongodbå¯ä»¥å®ç°â€œåˆ†å¸ƒå¼åˆ†ç‰‡é›†ç¾¤çš„ACIDâ€äº‹åŠ¡ï¼Œè¿™ä¸ªæˆ‘å°±æ‡µæ‰äº†ã€‚ã€‚ã€‚\næƒ³é—®ä¸‹mongodbåˆ†ç‰‡é›†ç¾¤äº‹åŠ¡åº”è¯¥ä¸æ˜¯å¼ºä¸€è‡´æ€§å§ï¼Ÿå¸Œæœ›è€å¸ˆå¸®å¿™è§£ç­”ä¸‹è¿™éƒ¨åˆ†ç›¸å…³çš„çŸ¥è¯†ï¼Œæ‹œæ‰˜å•¦ã€‚","like_count":0},{"had_liked":false,"id":270699,"user_name":"Geek_7c4953","can_delete":false,"product_type":"c3","uid":1809168,"ip_address":"","ucode":"359745D4725D4F","user_header":"","comment_is_top":false,"comment_ctime":1609222395,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"å¦‚æœåœ¨ä¸€ä¸ªé«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œéœ€è¦å¯¹ä¸€ä¸ªå­—æ®µè¿›è¡Œå¢å‡æ“ä½œåº”è¯¥æ€ä¹ˆåšï¼Ÿ\næ¯”å¦‚å•†å“äº¤æ˜“æ—¶ï¼Œéœ€è¦å°†å•†å“å‰©ä½™æ•°é‡-=1ï¼Œé‚£ä¹ˆåœ¨è¯»å–å’Œå†™å…¥ä¹‹é—´ï¼Œå…¶ä»–çš„æ‰£å‡å‰©ä½™æ•°é‡çš„è¯»å†™æ“ä½œåº”è¯¥éƒ½ä¸èƒ½è¿›è¡Œã€‚\nè¿™æ—¶å€™åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„MongoDBäº‹åŠ¡çº§åˆ«ï¼Ÿ","like_count":0},{"had_liked":false,"id":241474,"user_name":"æ¨æ¾","can_delete":false,"product_type":"c3","uid":1512517,"ip_address":"","ucode":"FB3C73BC44C94D","user_header":"https://static001.geekbang.org/account/avatar/00/17/14/45/adf079ae.jpg","comment_is_top":false,"comment_ctime":1597306037,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"å”è€å¸ˆï¼Œè¯·é—®springçš„äº‹åŠ¡ç®¡ç†æ³¨è§£æ˜¯å¦å¯ä»¥ç”¨åœ¨MongoDBä¸Šï¼Ÿ","like_count":0},{"had_liked":false,"id":213591,"user_name":"è‘«èŠ¦å¨ƒ-Dear","can_delete":false,"product_type":"c3","uid":1743582,"ip_address":"","ucode":"606C2E1D80B612","user_header":"https://static001.geekbang.org/account/avatar/00/1a/9a/de/abd008f3.jpg","comment_is_top":false,"comment_ctime":1588485149,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"æ“ä½œæ­¥éª¤:\nrs0:PRIMARY&gt; db.tx.insert([{x:1},{x:2}])\nBulkWriteResult({\n\t&quot;writeErrors&quot; : [ ],\n\t&quot;writeConcernErrors&quot; : [ ],\n\t&quot;nInserted&quot; : 2,\n\t&quot;nUpserted&quot; : 0,\n\t&quot;nMatched&quot; : 0,\n\t&quot;nModified&quot; : 0,\n\t&quot;nRemoved&quot; : 0,\n\t&quot;upserted&quot; : [ ]\n})\nrs0:PRIMARY&gt; var session=db.getMongo().startSession()\nrs0:PRIMARY&gt; session.startTransaction()\nrs0:PRIMARY&gt; var coll=session.getDatabase(&quot;test&quot;).getCollection(&quot;tx&quot;)\nrs0:PRIMARY&gt; coll.update({x:1},{$set:{y:1}})\nWriteCommandError({\n\t&quot;errorLabels&quot; : [\n\t\t&quot;TransientTransactionError&quot;\n\t],\n\t&quot;operationTime&quot; : Timestamp(1588484702, 1),\n\t&quot;ok&quot; : 0,\n\t&quot;errmsg&quot; : &quot;Given transaction number 0 does not match any in-progress transactions. The active transaction number is -1&quot;,\n\t&quot;code&quot; : 251,\n\t&quot;codeName&quot; : &quot;NoSuchTransaction&quot;,\n\t&quot;$clusterTime&quot; : {\n\t\t&quot;clusterTime&quot; : Timestamp(1588484702, 1),\n\t\t&quot;signature&quot; : {\n\t\t\t&quot;hash&quot; : BinData(0,&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAA=&quot;),\n\t\t\t&quot;keyId&quot; : NumberLong(0)\n\t\t}\n\t}\n})\næ‰§è¡Œupdateï¼Œè¿”å›é”™è¯¯ï¼Œinsertä¹Ÿè¿”å›è¿™ä¸ªé”™è¯¯","like_count":0,"discussions":[{"author":{"id":2876787,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/e5/73/622e9438.jpg","nickname":"é˜¿å°”ä¼¯ç‰¹æ³¢","note":"","ucode":"60B86EE085190D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568652,"discussion_content":"äº‹åŠ¡é»˜è®¤å¿…é¡»åœ¨60 ç§’ï¼ˆå¯è°ƒï¼‰å†…å®Œæˆï¼Œå¦åˆ™å°†è¢«å–æ¶ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651194492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163565,"user_name":"æœˆè¿·æ´¥æ¸¡","can_delete":false,"product_type":"c3","uid":1264111,"ip_address":"","ucode":"2B18B2FE3DAC3B","user_header":"https://static001.geekbang.org/account/avatar/00/13/49/ef/02401473.jpg","comment_is_top":false,"comment_ctime":1576745771,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"æé—®ä¸ªé—®é¢˜å†Repeatable Readè¿™ä¾‹å­é‡Œ å…ˆå¯åŠ¨äº‹åŠ¡ ç„¶åäº‹åŠ¡å¤–ä¿®æ”¹æ•°æ®ï¼Œäº‹åŠ¡å†…çš„å¤šæ¬¡è¯»æ“ä½œæ°¸è¿œè¯»åˆ°çš„æ˜¯å¯åŠ¨äº‹åŠ¡æ—¶çš„snapshot(x:1, y:1)ã€‚é‚£æˆ‘çš„é—®é¢˜æ˜¯å½“äº‹åŠ¡è¿™æ—¶æäº¤æ—¶ æ˜¯ä¸æ˜¯å…ˆæ‹¿äº‹åŠ¡å†…çš„ä¿®æ”¹(æ¯”å¦‚è¯´æ”¹æˆ{x:2,y:1})å’Œäº‹åŠ¡å¤–çš„ä¿®æ”¹æ¯”å¦‚è¯´æ”¹æˆ(x:1:y2)ä¸¤è€…åšåˆå¹¶ç„¶åæ²¡å†²çªçš„è¯å†æäº¤ã€‚æœ€åè®°å½•æ˜¯{x:2,y:2}","like_count":0}]}