{"id":78134,"title":"29 | å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®åº“æ˜¯ä¸æ˜¯å‡ºé—®é¢˜äº†ï¼Ÿ","content":"<p>æˆ‘åœ¨ç¬¬<a href=\"https://time.geekbang.org/column/article/76795\">25</a>å’Œ<a href=\"https://time.geekbang.org/column/article/77427\">27</a>ç¯‡æ–‡ç« ä¸­ï¼Œå’Œä½ ä»‹ç»äº†ä¸»å¤‡åˆ‡æ¢æµç¨‹ã€‚é€šè¿‡è¿™äº›å†…å®¹çš„è®²è§£ï¼Œä½ åº”è¯¥å·²ç»å¾ˆæ¸…æ¥šäº†ï¼šåœ¨ä¸€ä¸»ä¸€å¤‡çš„åŒMæ¶æ„é‡Œï¼Œä¸»å¤‡åˆ‡æ¢åªéœ€è¦æŠŠå®¢æˆ·ç«¯æµé‡åˆ‡åˆ°å¤‡åº“ï¼›è€Œåœ¨ä¸€ä¸»å¤šä»æ¶æ„é‡Œï¼Œä¸»å¤‡åˆ‡æ¢é™¤äº†è¦æŠŠå®¢æˆ·ç«¯æµé‡åˆ‡åˆ°å¤‡åº“å¤–ï¼Œè¿˜éœ€è¦æŠŠä»åº“æ¥åˆ°æ–°ä¸»åº“ä¸Šã€‚</p><p>ä¸»å¤‡åˆ‡æ¢æœ‰ä¸¤ç§åœºæ™¯ï¼Œä¸€ç§æ˜¯ä¸»åŠ¨åˆ‡æ¢ï¼Œä¸€ç§æ˜¯è¢«åŠ¨åˆ‡æ¢ã€‚è€Œå…¶ä¸­è¢«åŠ¨åˆ‡æ¢ï¼Œå¾€å¾€æ˜¯å› ä¸ºä¸»åº“å‡ºé—®é¢˜äº†ï¼Œç”±HAç³»ç»Ÿå‘èµ·çš„ã€‚</p><p>è¿™ä¹Ÿå°±å¼•å‡ºäº†æˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„é—®é¢˜ï¼šæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªä¸»åº“å‡ºé—®é¢˜äº†ï¼Ÿ</p><p>ä½ ä¸€å®šä¼šè¯´ï¼Œè¿™å¾ˆç®€å•å•Šï¼Œè¿ä¸ŠMySQLï¼Œæ‰§è¡Œä¸ªselect 1å°±å¥½äº†ã€‚ä½†æ˜¯select 1æˆåŠŸè¿”å›äº†ï¼Œå°±è¡¨ç¤ºä¸»åº“æ²¡é—®é¢˜å—ï¼Ÿ</p><h1>select 1åˆ¤æ–­</h1><p>å®é™…ä¸Šï¼Œselect 1æˆåŠŸè¿”å›ï¼Œåªèƒ½è¯´æ˜è¿™ä¸ªåº“çš„è¿›ç¨‹è¿˜åœ¨ï¼Œå¹¶ä¸èƒ½è¯´æ˜ä¸»åº“æ²¡é—®é¢˜ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ã€‚</p><pre><code>set global innodb_thread_concurrency=3;\n\nCREATE TABLE `t` (\n  `id` int(11) NOT NULL,\n  `c` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB;\n\n insert into t values(1,1)\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/35/55/35076dd3d0a0d44d22b76d2a29885255.png?wh=932*290\" alt=\"\"></p><center><span class=\"reference\">å›¾1 æŸ¥è¯¢blocked</span></center><p>æˆ‘ä»¬è®¾ç½®innodb_thread_concurrencyå‚æ•°çš„ç›®çš„æ˜¯ï¼Œæ§åˆ¶InnoDBçš„å¹¶å‘çº¿ç¨‹ä¸Šé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦å¹¶å‘çº¿ç¨‹æ•°è¾¾åˆ°è¿™ä¸ªå€¼ï¼ŒInnoDBåœ¨æ¥æ”¶åˆ°æ–°è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°æœ‰çº¿ç¨‹é€€å‡ºã€‚</p><p>è¿™é‡Œï¼Œæˆ‘æŠŠinnodb_thread_concurrencyè®¾ç½®æˆ3ï¼Œè¡¨ç¤ºInnoDBåªå…è®¸3ä¸ªçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œã€‚è€Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå‰ä¸‰ä¸ªsession ä¸­çš„sleep(100)ï¼Œä½¿å¾—è¿™ä¸‰ä¸ªè¯­å¥éƒ½å¤„äºâ€œæ‰§è¡Œâ€çŠ¶æ€ï¼Œä»¥æ­¤æ¥æ¨¡æ‹Ÿå¤§æŸ¥è¯¢ã€‚</p><!-- [[[read_end]]] --><p>ä½ çœ‹åˆ°äº†ï¼Œ session Dé‡Œé¢ï¼Œselect 1æ˜¯èƒ½æ‰§è¡ŒæˆåŠŸçš„ï¼Œä½†æ˜¯æŸ¥è¯¢è¡¨tçš„è¯­å¥ä¼šè¢«å µä½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¿™æ—¶å€™æˆ‘ä»¬ç”¨select 1æ¥æ£€æµ‹å®ä¾‹æ˜¯å¦æ­£å¸¸çš„è¯ï¼Œæ˜¯æ£€æµ‹ä¸å‡ºé—®é¢˜çš„ã€‚</p><p>åœ¨InnoDBä¸­ï¼Œinnodb_thread_concurrencyè¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼æ˜¯0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¹¶å‘çº¿ç¨‹æ•°é‡ã€‚ä½†æ˜¯ï¼Œä¸é™åˆ¶å¹¶å‘çº¿ç¨‹æ•°è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚å› ä¸ºï¼Œä¸€ä¸ªæœºå™¨çš„CPUæ ¸æ•°æœ‰é™ï¼Œçº¿ç¨‹å…¨å†²è¿›æ¥ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬å°±ä¼šå¤ªé«˜ã€‚</p><p>æ‰€ä»¥ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å»ºè®®æŠŠinnodb_thread_concurrencyè®¾ç½®ä¸º64~128ä¹‹é—´çš„å€¼ã€‚è¿™æ—¶ï¼Œä½ ä¸€å®šä¼šæœ‰ç–‘é—®ï¼Œå¹¶å‘çº¿ç¨‹ä¸Šé™æ•°è®¾ç½®ä¸º128å¤Ÿå¹²å•¥ï¼Œçº¿ä¸Šçš„å¹¶å‘è¿æ¥æ•°åŠ¨ä¸åŠ¨å°±ä¸Šåƒäº†ã€‚</p><p>äº§ç”Ÿè¿™ä¸ªç–‘é—®çš„åŸå› ï¼Œæ˜¯ææ··äº†<strong>å¹¶å‘è¿æ¥å’Œå¹¶å‘æŸ¥è¯¢ã€‚</strong></p><p>å¹¶å‘è¿æ¥å’Œå¹¶å‘æŸ¥è¯¢ï¼Œå¹¶ä¸æ˜¯åŒä¸€ä¸ªæ¦‚å¿µã€‚ä½ åœ¨show processlistçš„ç»“æœé‡Œï¼Œçœ‹åˆ°çš„å‡ åƒä¸ªè¿æ¥ï¼ŒæŒ‡çš„å°±æ˜¯å¹¶å‘è¿æ¥ã€‚è€Œâ€œå½“å‰æ­£åœ¨æ‰§è¡Œâ€çš„è¯­å¥ï¼Œæ‰æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å¹¶å‘æŸ¥è¯¢ã€‚</p><p>å¹¶å‘è¿æ¥æ•°è¾¾åˆ°å‡ åƒä¸ªå½±å“å¹¶ä¸å¤§ï¼Œå°±æ˜¯å¤šå ä¸€äº›å†…å­˜è€Œå·²ã€‚æˆ‘ä»¬åº”è¯¥å…³æ³¨çš„æ˜¯å¹¶å‘æŸ¥è¯¢ï¼Œå› ä¸ºå¹¶å‘æŸ¥è¯¢å¤ªé«˜æ‰æ˜¯CPUæ€æ‰‹ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è®¾ç½®innodb_thread_concurrencyå‚æ•°çš„åŸå› ã€‚</p><p>ç„¶åï¼Œä½ å¯èƒ½è¿˜ä¼šæƒ³èµ·æˆ‘ä»¬åœ¨<a href=\"https://time.geekbang.org/column/article/70215\">ç¬¬7ç¯‡æ–‡ç« </a>ä¸­è®²åˆ°çš„çƒ­ç‚¹æ›´æ–°å’Œæ­»é”æ£€æµ‹çš„æ—¶å€™ï¼Œå¦‚æœæŠŠinnodb_thread_concurrencyè®¾ç½®ä¸º128çš„è¯ï¼Œé‚£ä¹ˆå‡ºç°åŒä¸€è¡Œçƒ­ç‚¹æ›´æ–°çš„é—®é¢˜æ—¶ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¿«å°±æŠŠ128æ¶ˆè€—å®Œäº†ï¼Œè¿™æ ·æ•´ä¸ªç³»ç»Ÿæ˜¯ä¸æ˜¯å°±æŒ‚äº†å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œ<strong>åœ¨çº¿ç¨‹è¿›å…¥é”ç­‰å¾…ä»¥åï¼Œå¹¶å‘çº¿ç¨‹çš„è®¡æ•°ä¼šå‡ä¸€</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ç­‰è¡Œé”ï¼ˆä¹ŸåŒ…æ‹¬é—´éš™é”ï¼‰çš„çº¿ç¨‹æ˜¯ä¸ç®—åœ¨128é‡Œé¢çš„ã€‚</p><p>MySQLè¿™æ ·è®¾è®¡æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚å› ä¸ºï¼Œè¿›å…¥é”ç­‰å¾…çš„çº¿ç¨‹å·²ç»ä¸åƒCPUäº†ï¼›æ›´é‡è¦çš„æ˜¯ï¼Œå¿…é¡»è¿™ä¹ˆè®¾è®¡ï¼Œæ‰èƒ½é¿å…æ•´ä¸ªç³»ç»Ÿé”æ­»ã€‚</p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå‡è®¾å¤„äºé”ç­‰å¾…çš„çº¿ç¨‹ä¹Ÿå å¹¶å‘çº¿ç¨‹çš„è®¡æ•°ï¼Œä½ å¯ä»¥è®¾æƒ³ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼š</p><ol>\n<li>\n<p>çº¿ç¨‹1æ‰§è¡Œbegin; update t set c=c+1 where id=1, å¯åŠ¨äº†äº‹åŠ¡trx1ï¼Œ ç„¶åä¿æŒè¿™ä¸ªçŠ¶æ€ã€‚è¿™æ—¶å€™ï¼Œçº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€ï¼Œä¸ç®—åœ¨å¹¶å‘çº¿ç¨‹é‡Œé¢ã€‚</p>\n</li>\n<li>\n<p>çº¿ç¨‹2åˆ°çº¿ç¨‹129éƒ½æ‰§è¡Œ update t set c=c+1 where id=1; ç”±äºç­‰è¡Œé”ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚è¿™æ ·å°±æœ‰128ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼›</p>\n</li>\n<li>\n<p>å¦‚æœå¤„äºé”ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹è®¡æ•°ä¸å‡ä¸€ï¼ŒInnoDBå°±ä¼šè®¤ä¸ºçº¿ç¨‹æ•°ç”¨æ»¡äº†ï¼Œä¼šé˜»æ­¢å…¶ä»–è¯­å¥è¿›å…¥å¼•æ“æ‰§è¡Œï¼Œè¿™æ ·çº¿ç¨‹1ä¸èƒ½æäº¤äº‹åŠ¡ã€‚è€Œå¦å¤–çš„128ä¸ªçº¿ç¨‹åˆå¤„äºé”ç­‰å¾…çŠ¶æ€ï¼Œæ•´ä¸ªç³»ç»Ÿå°±å µä½äº†ã€‚</p>\n</li>\n</ol><p>ä¸‹å›¾2æ˜¾ç¤ºçš„å°±æ˜¯è¿™ä¸ªçŠ¶æ€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/32/1d/3206ea18b8a24b546515b1b95dc4a11d.png?wh=1142*856\" alt=\"\"></p><center><span class=\"reference\">å›¾2 ç³»ç»Ÿé”æ­»çŠ¶æ€ï¼ˆå‡è®¾ç­‰è¡Œé”çš„è¯­å¥å ç”¨å¹¶å‘è®¡æ•°ï¼‰</span></center><p>è¿™æ—¶å€™InnoDBä¸èƒ½å“åº”ä»»ä½•è¯·æ±‚ï¼Œæ•´ä¸ªç³»ç»Ÿè¢«é”æ­»ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰çº¿ç¨‹éƒ½å¤„äºç­‰å¾…çŠ¶æ€ï¼Œæ­¤æ—¶å ç”¨çš„CPUå´æ˜¯0ï¼Œè€Œè¿™æ˜æ˜¾ä¸åˆç†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¯´InnoDBåœ¨è®¾è®¡æ—¶ï¼Œé‡åˆ°è¿›ç¨‹è¿›å…¥é”ç­‰å¾…çš„æƒ…å†µæ—¶ï¼Œå°†å¹¶å‘çº¿ç¨‹çš„è®¡æ•°å‡1çš„è®¾è®¡ï¼Œæ˜¯åˆç†è€Œä¸”æ˜¯å¿…è¦çš„ã€‚</p><p>è™½ç„¶è¯´ç­‰é”çš„çº¿ç¨‹ä¸ç®—åœ¨å¹¶å‘çº¿ç¨‹è®¡æ•°é‡Œï¼Œä½†å¦‚æœå®ƒåœ¨çœŸæ­£åœ°æ‰§è¡ŒæŸ¥è¯¢ï¼Œå°±æ¯”å¦‚æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­å‰ä¸‰ä¸ªäº‹åŠ¡ä¸­çš„select sleep(100) from tï¼Œè¿˜æ˜¯è¦ç®—è¿›å¹¶å‘çº¿ç¨‹çš„è®¡æ•°çš„ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŒæ—¶åœ¨æ‰§è¡Œçš„è¯­å¥è¶…è¿‡äº†è®¾ç½®çš„innodb_thread_concurrencyçš„å€¼ï¼Œè¿™æ—¶å€™ç³»ç»Ÿå…¶å®å·²ç»ä¸è¡Œäº†ï¼Œä½†æ˜¯é€šè¿‡select 1æ¥æ£€æµ‹ç³»ç»Ÿï¼Œä¼šè®¤ä¸ºç³»ç»Ÿè¿˜æ˜¯æ­£å¸¸çš„ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨select 1çš„åˆ¤æ–­é€»è¾‘è¦ä¿®æ”¹ä¸€ä¸‹ã€‚</p><h1>æŸ¥è¡¨åˆ¤æ–­</h1><p>ä¸ºäº†èƒ½å¤Ÿæ£€æµ‹InnoDBå¹¶å‘çº¿ç¨‹æ•°è¿‡å¤šå¯¼è‡´çš„ç³»ç»Ÿä¸å¯ç”¨æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªè®¿é—®InnoDBçš„åœºæ™¯ã€‚ä¸€èˆ¬çš„åšæ³•æ˜¯ï¼Œåœ¨ç³»ç»Ÿåº“ï¼ˆmysqlåº“ï¼‰é‡Œåˆ›å»ºä¸€ä¸ªè¡¨ï¼Œæ¯”å¦‚å‘½åä¸ºhealth_checkï¼Œé‡Œé¢åªæ”¾ä¸€è¡Œæ•°æ®ï¼Œç„¶åå®šæœŸæ‰§è¡Œï¼š</p><pre><code>mysql&gt; select * from mysql.health_check; \n</code></pre><p>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æµ‹å‡ºç”±äºå¹¶å‘çº¿ç¨‹è¿‡å¤šå¯¼è‡´çš„æ•°æ®åº“ä¸å¯ç”¨çš„æƒ…å†µã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬é©¬ä¸Šè¿˜ä¼šç¢°åˆ°ä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œå³ï¼šç©ºé—´æ»¡äº†ä»¥åï¼Œè¿™ç§æ–¹æ³•åˆä¼šå˜å¾—ä¸å¥½ä½¿ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ›´æ–°äº‹åŠ¡è¦å†™binlogï¼Œè€Œä¸€æ—¦binlogæ‰€åœ¨ç£ç›˜çš„ç©ºé—´å ç”¨ç‡è¾¾åˆ°100%ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ›´æ–°è¯­å¥å’Œäº‹åŠ¡æäº¤çš„commitè¯­å¥å°±éƒ½ä¼šè¢«å µä½ã€‚ä½†æ˜¯ï¼Œç³»ç»Ÿè¿™æ—¶å€™è¿˜æ˜¯å¯ä»¥æ­£å¸¸è¯»æ•°æ®çš„ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯æŠŠè¿™æ¡ç›‘æ§è¯­å¥å†æ”¹è¿›ä¸€ä¸‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹æŠŠæŸ¥è¯¢è¯­å¥æ”¹æˆæ›´æ–°è¯­å¥åçš„æ•ˆæœã€‚</p><h1>æ›´æ–°åˆ¤æ–­</h1><p>æ—¢ç„¶è¦æ›´æ–°ï¼Œå°±è¦æ”¾ä¸ªæœ‰æ„ä¹‰çš„å­—æ®µï¼Œå¸¸è§åšæ³•æ˜¯æ”¾ä¸€ä¸ªtimestampå­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºæœ€åä¸€æ¬¡æ‰§è¡Œæ£€æµ‹çš„æ—¶é—´ã€‚è¿™æ¡æ›´æ–°è¯­å¥ç±»ä¼¼äºï¼š</p><pre><code>mysql&gt; update mysql.health_check set t_modified=now();\n</code></pre><p>èŠ‚ç‚¹å¯ç”¨æ€§çš„æ£€æµ‹éƒ½åº”è¯¥åŒ…å«ä¸»åº“å’Œå¤‡åº“ã€‚å¦‚æœç”¨æ›´æ–°æ¥æ£€æµ‹ä¸»åº“çš„è¯ï¼Œé‚£ä¹ˆå¤‡åº“ä¹Ÿè¦è¿›è¡Œæ›´æ–°æ£€æµ‹ã€‚</p><p>ä½†ï¼Œå¤‡åº“çš„æ£€æµ‹ä¹Ÿæ˜¯è¦å†™binlogçš„ã€‚ç”±äºæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠæ•°æ®åº“Aå’ŒBçš„ä¸»å¤‡å…³ç³»è®¾è®¡ä¸ºåŒMç»“æ„ï¼Œæ‰€ä»¥åœ¨å¤‡åº“Bä¸Šæ‰§è¡Œçš„æ£€æµ‹å‘½ä»¤ï¼Œä¹Ÿè¦å‘å›ç»™ä¸»åº“Aã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä¸»åº“Aå’Œå¤‡åº“Béƒ½ç”¨ç›¸åŒçš„æ›´æ–°å‘½ä»¤ï¼Œå°±å¯èƒ½å‡ºç°è¡Œå†²çªï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨çœ‹æ¥mysql.health_check è¿™ä¸ªè¡¨å°±ä¸èƒ½åªæœ‰ä¸€è¡Œæ•°æ®äº†ã€‚</p><p>ä¸ºäº†è®©ä¸»å¤‡ä¹‹é—´çš„æ›´æ–°ä¸äº§ç”Ÿå†²çªï¼Œæˆ‘ä»¬å¯ä»¥åœ¨mysql.health_checkè¡¨ä¸Šå­˜å…¥å¤šè¡Œæ•°æ®ï¼Œå¹¶ç”¨Aã€Bçš„server_idåšä¸»é”®ã€‚</p><pre><code>mysql&gt; CREATE TABLE `health_check` (\n  `id` int(11) NOT NULL,\n  `t_modified` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB;\n\n/* æ£€æµ‹å‘½ä»¤ */\ninsert into mysql.health_check(id, t_modified) values (@@server_id, now()) on duplicate key update t_modified=now();\n</code></pre><p>ç”±äºMySQLè§„å®šäº†ä¸»åº“å’Œå¤‡åº“çš„server_idå¿…é¡»ä¸åŒï¼ˆå¦åˆ™åˆ›å»ºä¸»å¤‡å…³ç³»çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ä¸»ã€å¤‡åº“å„è‡ªçš„æ£€æµ‹å‘½ä»¤ä¸ä¼šå‘ç”Ÿå†²çªã€‚</p><p>æ›´æ–°åˆ¤æ–­æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ¡ˆäº†ï¼Œä¸è¿‡ä¾ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œâ€œåˆ¤å®šæ…¢â€ä¸€ç›´æ˜¯è®©DBAå¤´ç–¼çš„é—®é¢˜ã€‚</p><p>ä½ ä¸€å®šä¼šç–‘æƒ‘ï¼Œ<strong>æ›´æ–°è¯­å¥ï¼Œå¦‚æœå¤±è´¥æˆ–è€…è¶…æ—¶ï¼Œå°±å¯ä»¥å‘èµ·ä¸»å¤‡åˆ‡æ¢äº†ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæœ‰åˆ¤å®šæ…¢çš„é—®é¢˜å‘¢ï¼Ÿ</strong></p><p>å…¶å®ï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„æ˜¯æœåŠ¡å™¨IOèµ„æºåˆ†é…çš„é—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œæ‰€æœ‰çš„æ£€æµ‹é€»è¾‘éƒ½éœ€è¦ä¸€ä¸ªè¶…æ—¶æ—¶é—´Nã€‚æ‰§è¡Œä¸€æ¡updateè¯­å¥ï¼Œè¶…è¿‡Nç§’åè¿˜ä¸è¿”å›ï¼Œå°±è®¤ä¸ºç³»ç»Ÿä¸å¯ç”¨ã€‚</p><p>ä½ å¯ä»¥è®¾æƒ³ä¸€ä¸ªæ—¥å¿—ç›˜çš„IOåˆ©ç”¨ç‡å·²ç»æ˜¯100%çš„åœºæ™¯ã€‚è¿™æ—¶å€™ï¼Œæ•´ä¸ªç³»ç»Ÿå“åº”éå¸¸æ…¢ï¼Œå·²ç»éœ€è¦åšä¸»å¤‡åˆ‡æ¢äº†ã€‚</p><p>ä½†æ˜¯ä½ è¦çŸ¥é“ï¼ŒIOåˆ©ç”¨ç‡100%è¡¨ç¤ºç³»ç»Ÿçš„IOæ˜¯åœ¨å·¥ä½œçš„ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æœ‰æœºä¼šè·å¾—IOèµ„æºï¼Œæ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡ã€‚è€Œæˆ‘ä»¬çš„æ£€æµ‹ä½¿ç”¨çš„updateå‘½ä»¤ï¼Œéœ€è¦çš„èµ„æºå¾ˆå°‘ï¼Œæ‰€ä»¥å¯èƒ½åœ¨æ‹¿åˆ°IOèµ„æºçš„æ—¶å€™å°±å¯ä»¥æäº¤æˆåŠŸï¼Œå¹¶ä¸”åœ¨è¶…æ—¶æ—¶é—´Nç§’æœªåˆ°è¾¾ä¹‹å‰å°±è¿”å›ç»™äº†æ£€æµ‹ç³»ç»Ÿã€‚</p><p>æ£€æµ‹ç³»ç»Ÿä¸€çœ‹ï¼Œupdateå‘½ä»¤æ²¡æœ‰è¶…æ—¶ï¼Œäºæ˜¯å°±å¾—åˆ°äº†â€œç³»ç»Ÿæ­£å¸¸â€çš„ç»“è®ºã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ—¶å€™åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸Šæ­£å¸¸çš„SQLè¯­å¥å·²ç»æ‰§è¡Œå¾—å¾ˆæ…¢äº†ï¼Œä½†æ˜¯DBAä¸Šå»ä¸€çœ‹ï¼ŒHAç³»ç»Ÿè¿˜åœ¨æ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”è®¤ä¸ºä¸»åº“ç°åœ¨å¤„äºå¯ç”¨çŠ¶æ€ã€‚</p><p>ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ä¸ªç°è±¡ï¼Œæ ¹æœ¬åŸå› æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´çš„æ‰€æœ‰æ–¹æ³•ï¼Œéƒ½æ˜¯åŸºäºå¤–éƒ¨æ£€æµ‹çš„ã€‚å¤–éƒ¨æ£€æµ‹å¤©ç„¶æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯éšæœºæ€§ã€‚</p><p>å› ä¸ºï¼Œå¤–éƒ¨æ£€æµ‹éƒ½éœ€è¦å®šæ—¶è½®è¯¢ï¼Œæ‰€ä»¥ç³»ç»Ÿå¯èƒ½å·²ç»å‡ºé—®é¢˜äº†ï¼Œä½†æ˜¯å´éœ€è¦ç­‰åˆ°ä¸‹ä¸€ä¸ªæ£€æµ‹å‘èµ·æ‰§è¡Œè¯­å¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰æœ‰å¯èƒ½å‘ç°é—®é¢˜ã€‚è€Œä¸”ï¼Œå¦‚æœä½ çš„è¿æ°”ä¸å¤Ÿå¥½çš„è¯ï¼Œå¯èƒ½ç¬¬ä¸€æ¬¡è½®è¯¢è¿˜ä¸èƒ½å‘ç°ï¼Œè¿™å°±ä¼šå¯¼è‡´åˆ‡æ¢æ…¢çš„é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘è¦å†å’Œä½ ä»‹ç»ä¸€ç§åœ¨MySQLå†…éƒ¨å‘ç°æ•°æ®åº“é—®é¢˜çš„æ–¹æ³•ã€‚</p><h1>å†…éƒ¨ç»Ÿè®¡</h1><p>é’ˆå¯¹ç£ç›˜åˆ©ç”¨ç‡è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœMySQLå¯ä»¥å‘Šè¯‰æˆ‘ä»¬ï¼Œå†…éƒ¨æ¯ä¸€æ¬¡IOè¯·æ±‚çš„æ—¶é—´ï¼Œé‚£æˆ‘ä»¬åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å‡ºé—®é¢˜çš„æ–¹æ³•å°±å¯é å¾—å¤šäº†ã€‚</p><p>å…¶å®ï¼ŒMySQL 5.6ç‰ˆæœ¬ä»¥åæä¾›çš„performance_schemaåº“ï¼Œå°±åœ¨file_summary_by_event_nameè¡¨é‡Œç»Ÿè®¡äº†æ¯æ¬¡IOè¯·æ±‚çš„æ—¶é—´ã€‚</p><p>file_summary_by_event_nameè¡¨é‡Œæœ‰å¾ˆå¤šè¡Œæ•°æ®ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹event_name='wait/io/file/innodb/innodb_log_fileâ€™è¿™ä¸€è¡Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/75/dd/752ccfe43b4eab155be17401838c62dd.png?wh=1535*641\" alt=\"\"></p><center><span class=\"reference\">å›¾3 performance_schema.file_summary_by_event_nameçš„ä¸€è¡Œ</span></center><p>å›¾ä¸­è¿™ä¸€è¡Œè¡¨ç¤ºç»Ÿè®¡çš„æ˜¯redo logçš„å†™å…¥æ—¶é—´ï¼Œç¬¬ä¸€åˆ—EVENT_NAME è¡¨ç¤ºç»Ÿè®¡çš„ç±»å‹ã€‚</p><p>æ¥ä¸‹æ¥çš„ä¸‰ç»„æ•°æ®ï¼Œæ˜¾ç¤ºçš„æ˜¯redo logæ“ä½œçš„æ—¶é—´ç»Ÿè®¡ã€‚</p><p>ç¬¬ä¸€ç»„äº”åˆ—ï¼Œæ˜¯æ‰€æœ‰IOç±»å‹çš„ç»Ÿè®¡ã€‚å…¶ä¸­ï¼ŒCOUNT_STARæ˜¯æ‰€æœ‰IOçš„æ€»æ¬¡æ•°ï¼Œæ¥ä¸‹æ¥å››åˆ—æ˜¯å…·ä½“çš„ç»Ÿè®¡é¡¹ï¼Œ å•ä½æ˜¯çš®ç§’ï¼›å‰ç¼€SUMã€MINã€AVGã€MAXï¼Œé¡¾åæ€ä¹‰æŒ‡çš„å°±æ˜¯æ€»å’Œã€æœ€å°å€¼ã€å¹³å‡å€¼å’Œæœ€å¤§å€¼ã€‚</p><p>ç¬¬äºŒç»„å…­åˆ—ï¼Œæ˜¯è¯»æ“ä½œçš„ç»Ÿè®¡ã€‚æœ€åä¸€åˆ—SUM_NUMBER_OF_BYTES_READç»Ÿè®¡çš„æ˜¯ï¼Œæ€»å…±ä»redo logé‡Œè¯»äº†å¤šå°‘ä¸ªå­—èŠ‚ã€‚</p><p>ç¬¬ä¸‰ç»„å…­åˆ—ï¼Œç»Ÿè®¡çš„æ˜¯å†™æ“ä½œã€‚</p><p>æœ€åçš„ç¬¬å››ç»„æ•°æ®ï¼Œæ˜¯å¯¹å…¶ä»–ç±»å‹æ•°æ®çš„ç»Ÿè®¡ã€‚åœ¨redo logé‡Œï¼Œä½ å¯ä»¥è®¤ä¸ºå®ƒä»¬å°±æ˜¯å¯¹fsyncçš„ç»Ÿè®¡ã€‚</p><p>åœ¨performance_schemaåº“çš„file_summary_by_event_nameè¡¨é‡Œï¼Œbinlogå¯¹åº”çš„æ˜¯event_name = \"wait/io/file/sql/binlog\"è¿™ä¸€è¡Œã€‚å„ä¸ªå­—æ®µçš„ç»Ÿè®¡é€»è¾‘ï¼Œä¸redo logçš„å„ä¸ªå­—æ®µå®Œå…¨ç›¸åŒã€‚è¿™é‡Œï¼Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p><p>å› ä¸ºæˆ‘ä»¬æ¯ä¸€æ¬¡æ“ä½œæ•°æ®åº“ï¼Œperformance_schemaéƒ½éœ€è¦é¢å¤–åœ°ç»Ÿè®¡è¿™äº›ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªç»Ÿè®¡åŠŸèƒ½æ˜¯æœ‰æ€§èƒ½æŸè€—çš„ã€‚</p><p>æˆ‘çš„æµ‹è¯•ç»“æœæ˜¯ï¼Œå¦‚æœæ‰“å¼€æ‰€æœ‰çš„performance_schemaé¡¹ï¼Œæ€§èƒ½å¤§æ¦‚ä¼šä¸‹é™10%å·¦å³ã€‚æ‰€ä»¥ï¼Œæˆ‘å»ºè®®ä½ åªæ‰“å¼€è‡ªå·±éœ€è¦çš„é¡¹è¿›è¡Œç»Ÿè®¡ã€‚ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ‰“å¼€æˆ–è€…å…³é—­æŸä¸ªå…·ä½“é¡¹çš„ç»Ÿè®¡ã€‚</p><p>å¦‚æœè¦æ‰“å¼€redo logçš„æ—¶é—´ç›‘æ§ï¼Œä½ å¯ä»¥æ‰§è¡Œè¿™ä¸ªè¯­å¥ï¼š</p><pre><code>mysql&gt; update setup_instruments set ENABLED='YES', Timed='YES' where name like '%wait/io/file/innodb/innodb_log_file%';\n</code></pre><p>å‡è®¾ï¼Œç°åœ¨ä½ å·²ç»å¼€å¯äº†redo logå’Œbinlogè¿™ä¸¤ä¸ªç»Ÿè®¡ä¿¡æ¯ï¼Œé‚£è¦æ€ä¹ˆæŠŠè¿™ä¸ªä¿¡æ¯ç”¨åœ¨å®ä¾‹çŠ¶æ€è¯Šæ–­ä¸Šå‘¢ï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œä½ å¯ä»¥é€šè¿‡MAX_TIMERçš„å€¼æ¥åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å‡ºé—®é¢˜äº†ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è®¾å®šé˜ˆå€¼ï¼Œå•æ¬¡IOè¯·æ±‚æ—¶é—´è¶…è¿‡200æ¯«ç§’å±äºå¼‚å¸¸ï¼Œç„¶åä½¿ç”¨ç±»ä¼¼ä¸‹é¢è¿™æ¡è¯­å¥ä½œä¸ºæ£€æµ‹é€»è¾‘ã€‚</p><pre><code>mysql&gt; select event_name,MAX_TIMER_WAIT  FROM performance_schema.file_summary_by_event_name where event_name in ('wait/io/file/innodb/innodb_log_file','wait/io/file/sql/binlog') and MAX_TIMER_WAIT&gt;200*1000000000;\n</code></pre><p>å‘ç°å¼‚å¸¸åï¼Œå–åˆ°ä½ éœ€è¦çš„ä¿¡æ¯ï¼Œå†é€šè¿‡ä¸‹é¢è¿™æ¡è¯­å¥ï¼š</p><pre><code>mysql&gt; truncate table performance_schema.file_summary_by_event_name;\n</code></pre><p>æŠŠä¹‹å‰çš„ç»Ÿè®¡ä¿¡æ¯æ¸…ç©ºã€‚è¿™æ ·å¦‚æœåé¢çš„ç›‘æ§ä¸­ï¼Œå†æ¬¡å‡ºç°è¿™ä¸ªå¼‚å¸¸ï¼Œå°±å¯ä»¥åŠ å…¥ç›‘æ§ç´¯ç§¯å€¼äº†ã€‚</p><h1>å°ç»“</h1><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ ä»‹ç»äº†æ£€æµ‹ä¸€ä¸ªMySQLå®ä¾‹å¥åº·çŠ¶æ€çš„å‡ ç§æ–¹æ³•ï¼Œä»¥åŠå„ç§æ–¹æ³•å­˜åœ¨çš„é—®é¢˜å’Œæ¼”è¿›çš„é€»è¾‘ã€‚</p><p>ä½ çœ‹å®Œåå¯èƒ½ä¼šè§‰å¾—ï¼Œselect 1è¿™æ ·çš„æ–¹æ³•æ˜¯ä¸æ˜¯å·²ç»è¢«æ·˜æ±°äº†å‘¢ï¼Œä½†å®é™…ä¸Šä½¿ç”¨éå¸¸å¹¿æ³›çš„MHAï¼ˆMaster High Availabilityï¼‰ï¼Œé»˜è®¤ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ã€‚</p><p>MHAä¸­çš„å¦ä¸€ä¸ªå¯é€‰æ–¹æ³•æ˜¯åªåšè¿æ¥ï¼Œå°±æ˜¯ â€œå¦‚æœè¿æ¥æˆåŠŸå°±è®¤ä¸ºä¸»åº“æ²¡é—®é¢˜â€ã€‚ä¸è¿‡æ®æˆ‘æ‰€çŸ¥ï¼Œé€‰æ‹©è¿™ä¸ªæ–¹æ³•çš„å¾ˆå°‘ã€‚</p><p>å…¶å®ï¼Œæ¯ä¸ªæ”¹è¿›çš„æ–¹æ¡ˆï¼Œéƒ½ä¼šå¢åŠ é¢å¤–æŸè€—ï¼Œå¹¶ä¸èƒ½ç”¨â€œå¯¹é”™â€åšç›´æ¥åˆ¤æ–­ï¼Œéœ€è¦ä½ æ ¹æ®ä¸šåŠ¡å®é™…æƒ…å†µå»åšæƒè¡¡ã€‚</p><p>æˆ‘ä¸ªäººæ¯”è¾ƒå€¾å‘çš„æ–¹æ¡ˆï¼Œæ˜¯ä¼˜å…ˆè€ƒè™‘updateç³»ç»Ÿè¡¨ï¼Œç„¶åå†é…åˆå¢åŠ æ£€æµ‹performance_schemaçš„ä¿¡æ¯ã€‚</p><p>æœ€åï¼Œåˆåˆ°äº†æˆ‘ä»¬çš„æ€è€ƒé¢˜æ—¶é—´ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘æƒ³é—®ä½ çš„æ˜¯ï¼šä¸šåŠ¡ç³»ç»Ÿä¸€èˆ¬ä¹Ÿæœ‰é«˜å¯ç”¨çš„éœ€æ±‚ï¼Œåœ¨ä½ å¼€å‘å’Œç»´æŠ¤è¿‡çš„æœåŠ¡ä¸­ï¼Œä½ æ˜¯æ€ä¹ˆåˆ¤æ–­æœåŠ¡æœ‰æ²¡æœ‰å‡ºé—®é¢˜çš„å‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥æŠŠä½ ç”¨åˆ°çš„æ–¹æ³•å’Œåˆ†æå†™åœ¨ç•™è¨€åŒºï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­é€‰å–æœ‰è¶£çš„æ–¹æ¡ˆä¸€èµ·æ¥åˆ†äº«å’Œåˆ†æã€‚æ„Ÿè°¢ä½ çš„æ”¶å¬ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚</p><h1>ä¸ŠæœŸé—®é¢˜æ—¶é—´</h1><p>ä¸ŠæœŸçš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä½¿ç”¨GTIDç­‰ä½ç‚¹çš„æ–¹æ¡ˆåšè¯»å†™åˆ†ç¦»ï¼Œåœ¨å¯¹å¤§è¡¨åšDDLçš„æ—¶å€™ä¼šæ€ä¹ˆæ ·ã€‚</p><p>å‡è®¾ï¼Œè¿™æ¡è¯­å¥åœ¨ä¸»åº“ä¸Šè¦æ‰§è¡Œ10åˆ†é’Ÿï¼Œæäº¤åä¼ åˆ°å¤‡åº“å°±è¦10åˆ†é’Ÿï¼ˆå…¸å‹çš„å¤§äº‹åŠ¡ï¼‰ã€‚é‚£ä¹ˆï¼Œåœ¨ä¸»åº“DDLä¹‹åå†æäº¤çš„äº‹åŠ¡çš„GTIDï¼Œå»å¤‡åº“æŸ¥çš„æ—¶å€™ï¼Œå°±ä¼šç­‰10åˆ†é’Ÿæ‰å‡ºç°ã€‚</p><p>è¿™æ ·ï¼Œè¿™ä¸ªè¯»å†™åˆ†ç¦»æœºåˆ¶åœ¨è¿™10åˆ†é’Ÿä¹‹å†…éƒ½ä¼šè¶…æ—¶ï¼Œç„¶åèµ°ä¸»åº“ã€‚</p><p>è¿™ç§é¢„æœŸå†…çš„æ“ä½œï¼Œåº”è¯¥åœ¨ä¸šåŠ¡ä½å³°æœŸçš„æ—¶å€™ï¼Œç¡®ä¿ä¸»åº“èƒ½å¤Ÿæ”¯æŒæ‰€æœ‰ä¸šåŠ¡æŸ¥è¯¢ï¼Œç„¶åæŠŠè¯»è¯·æ±‚éƒ½åˆ‡åˆ°ä¸»åº“ï¼Œå†åœ¨ä¸»åº“ä¸ŠåšDDLã€‚ç­‰å¤‡åº“å»¶è¿Ÿè¿½ä¸Šä»¥åï¼Œå†æŠŠè¯»è¯·æ±‚åˆ‡å›å¤‡åº“ã€‚</p><p>é€šè¿‡è¿™ä¸ªæ€è€ƒé¢˜ï¼Œæˆ‘ä¸»è¦æƒ³è®©å…³æ³¨çš„æ˜¯ï¼Œå¤§äº‹åŠ¡å¯¹ç­‰ä½ç‚¹æ–¹æ¡ˆçš„å½±å“ã€‚</p><p>å½“ç„¶äº†ï¼Œä½¿ç”¨gh-ostæ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p><p>è¯„è®ºåŒºç•™è¨€ç‚¹èµæ¿ï¼š</p><blockquote>\n<p>@æ›¾å‰‘ã€@max åŒå­¦æåˆ°çš„å¤‡åº“å…ˆåšï¼Œå†åˆ‡ä¸»åº“çš„æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>\n</blockquote><p></p>","neighbors":{"left":{"article_title":"28 | è¯»å†™åˆ†ç¦»æœ‰å“ªäº›å‘ï¼Ÿ","id":77636},"right":{"article_title":"30 | ç­”ç–‘æ–‡ç« ï¼ˆäºŒï¼‰ï¼šç”¨åŠ¨æ€çš„è§‚ç‚¹çœ‹åŠ é”","id":78427}},"comments":[{"had_liked":false,"id":62230,"user_name":"æŸã€äºº","can_delete":false,"product_type":"c1","uid":1308784,"ip_address":"","ucode":"ADB42AA12A11C1","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg","comment_is_top":false,"comment_ctime":1547989025,"is_pvip":false,"replies":[{"id":"22018","content":"1. è™½ç„¶ç†è®ºä¸Šæ˜¯æ ¸æ•°çš„2å€å·¦å³æœ€å¥½ï¼Œä½†æ˜¯ç°åœ¨å¾ˆå¤šäººæŠŠMySQLåˆ›å»ºåœ¨è™šæ‹Ÿæœºä¸Šï¼Œå°±åˆ†1~2ä¸ªæ ¸ï¼Œæˆ‘æ€•é‚£ä¹ˆå†™ï¼Œæœ‰åŒå­¦ä¼šè®¤ä¸ºinnodb_thread_concurrencyå»ºè®®è®¾ç½®æˆ4ã€‚ã€‚<br><br>2. ç©ºé—´æ»¡æœ¬èº«æ˜¯ä¸ä¼šå¯¼è‡´è¿ä¸ä¸Šçš„ã€‚ä½†æ˜¯å› ä¸ºç©ºé—´æ»¡ï¼Œäº‹åŠ¡æ— æ³•æäº¤ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¥ä¸‹æ¥å¤–éƒ¨äº‹åŠ¡é‡è¯•ï¼Œæ–°é‡è¯•çš„ä¸šåŠ¡è¿˜æ˜¯å µåœ¨æäº¤é˜¶æ®µï¼ŒæŒç»­ç´¯ç§¯å¯èƒ½ä¼šæŠŠè¿æ¥æ•°ç”¨æ»¡","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548008290,"ip_address":"","comment_id":62230,"utype":1}],"discussion_count":4,"race_medal":0,"score":"302195699745","product_id":100020801,"comment_content":"ç›®å‰æ˜¯åªæœ‰ä¸€å°æœåŠ¡å™¨æ¥åšåˆ¤æ–­,æ˜¯å¦æ•°æ®åº“å‡ºé—®é¢˜äº†,å°±æ˜¯é‡‡ç”¨çš„updateçš„æ–¹å¼ã€‚å¦‚æœæ˜¯ä¸»ä»æ¶æ„å°±ä¸€æ¡è¯­å¥,å¦‚æœæ˜¯åŒä¸»çš„è¯å°±æ˜¯ä¸¤æ¡updateè¯­å¥ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼æœ‰å¾ˆå¤§çš„å¼Šç«¯,åªæœ‰ä¸€ä¸ªè¿›ç¨‹æ¥åˆ¤æ–­æ•°æ®åº“å‡ºé—®é¢˜çš„è¯,ä¼šå‡ºç°å•ç‚¹åˆ¤æ–­çš„é—®é¢˜ã€‚æ‰€ä»¥åç»­å‡†å¤‡å¤šä¸ªå•æ•°è¿›ç¨‹æ¥åšåˆ¤æ–­,å¦‚æœè¶…è¿‡äº†åŠæ•°ä»¥ä¸Šçš„ç›‘æ§è¿›ç¨‹éƒ½è®¤ä¸ºæ•°æ®åº“å‡ºé—®é¢˜,æ‰åšåˆ‡æ¢ã€‚<br>è€å¸ˆæˆ‘æœ‰ä¸¤ä¸ªé—®é¢˜:<br>1.innodb_thread_concurrencyçš„è®¾ç½®æ˜¯ä¸æ˜¯åº”è¯¥è·Ÿè®¡ç®—æœºæ ¸æ•°æˆæ­£æ¯”,ä¸€èˆ¬æ˜¯1.5å€-2å€å·¦å³ï¼Ÿ<br>2.æ€ä¹ˆä¹‹å‰é‡åˆ°ç©ºé—´æ»¡äº†,æ•°æ®åº“éƒ½ç™»ä¸ä¸Šäº†,æ‰€æœ‰çš„è¿æ¥éƒ½è¿ä¸ä¸Š,æ›´ä¸ç”¨æ‰§è¡Œselectè¯­å¥äº†,è¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å•Šï¼Ÿ","like_count":71,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437146,"discussion_content":"1. è™½ç„¶ç†è®ºä¸Šæ˜¯æ ¸æ•°çš„2å€å·¦å³æœ€å¥½ï¼Œä½†æ˜¯ç°åœ¨å¾ˆå¤šäººæŠŠMySQLåˆ›å»ºåœ¨è™šæ‹Ÿæœºä¸Šï¼Œå°±åˆ†1~2ä¸ªæ ¸ï¼Œæˆ‘æ€•é‚£ä¹ˆå†™ï¼Œæœ‰åŒå­¦ä¼šè®¤ä¸ºinnodb_thread_concurrencyå»ºè®®è®¾ç½®æˆ4ã€‚ã€‚\n\n2. ç©ºé—´æ»¡æœ¬èº«æ˜¯ä¸ä¼šå¯¼è‡´è¿ä¸ä¸Šçš„ã€‚ä½†æ˜¯å› ä¸ºç©ºé—´æ»¡ï¼Œäº‹åŠ¡æ— æ³•æäº¤ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¥ä¸‹æ¥å¤–éƒ¨äº‹åŠ¡é‡è¯•ï¼Œæ–°é‡è¯•çš„ä¸šåŠ¡è¿˜æ˜¯å µåœ¨æäº¤é˜¶æ®µï¼ŒæŒç»­ç´¯ç§¯å¯èƒ½ä¼šæŠŠè¿æ¥æ•°ç”¨æ»¡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548008290,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008582,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/63/c6/d6ea3df3.jpg","nickname":"æ—è‚¯","note":"","ucode":"D2C97220230DE5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299776,"discussion_content":"æ‰€ä»¥åç»­å‡†å¤‡å¤šä¸ªå•æ•°è¿›ç¨‹æ¥åšåˆ¤æ–­,å¦‚æœè¶…è¿‡äº†åŠæ•°ä»¥ä¸Šçš„ç›‘æ§è¿›ç¨‹éƒ½è®¤ä¸ºæ•°æ®åº“å‡ºé—®é¢˜,æ‰åšåˆ‡æ¢ã€‚â€”â€”è¿™ä¸ªæ˜¯rediså“¨å…µçš„æ€è·¯","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1597813247,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1303409,"avatar":"https://static001.geekbang.org/account/avatar/00/13/e3/71/45eb3475.jpg","nickname":"è€æ±Ÿ","note":"","ucode":"7033BBF9AF43A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490,"discussion_content":"é—®é¢˜2ï¼Œå¦ä¸€ç§åœºæ™¯ï¼Œå°±æ˜¯æœ‰äº›æ•°æ®åº“å¼€äº†ç™»å½•åŠŸèƒ½è®°å½•çš„è¯ï¼Œè¿™ä¸ªæ—¶å€™ä¹Ÿä¼šå†™æ•°æ®ï¼Œä¸€æ ·ä¼šå¡ä½","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1561618926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1239557,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ea/05/c0d8014d.jpg","nickname":"ä¸€é“é˜³å…‰","note":"","ucode":"F35207CCCEC6E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":131102,"discussion_content":"åº”è¯¥æœ‰linuxç›‘æ§å§ï¼Œå¦‚æœç£ç›˜ä½¿ç”¨ç©ºé—´è¾¾åˆ°ç™¾åˆ†æ¯”åï¼Œä¼šäº§ç”Ÿå‘Šè­¦ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1578826725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":67928,"user_name":"StarkYanng","can_delete":false,"product_type":"c1","uid":1079296,"ip_address":"","ucode":"C95598A4F90528","user_header":"https://static001.geekbang.org/account/avatar/00/10/78/00/31a6dd80.jpg","comment_is_top":false,"comment_ctime":1550325337,"is_pvip":false,"replies":[{"id":"24085","content":"å¯¹ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ¬è´¨ä¸Šæ˜¯â€œå†…éƒ¨æŠŠä¸€æ®µæ—¶é—´å†…çš„ç»Ÿè®¡ä¿¡æ¯å­˜åœ¨è¿™é‡Œâ€ï¼Œåªæ˜¯â€œå®šæœŸæ¥å–â€ï¼Œå»åˆ°çš„æ˜¯â€œä¸€æ®µæ—¶é—´å†…çš„ä¿¡æ¯â€<br><br>è€Œå‰é¢çš„å‡ ç§æ–¹æ³•ï¼Œéƒ½æ˜¯â€œæ£€æµ‹é‚£ä¸ªæ—¶é—´ç‚¹çš„ä¿¡æ¯â€","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1550333859,"ip_address":"","comment_id":67928,"utype":1}],"discussion_count":2,"race_medal":0,"score":"212003722841","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ä¸ªç–‘é—®ï¼Œæ‚¨è¯´å¤–éƒ¨æ£€æµ‹æ˜¯é‡‡ç”¨å®šæ—¶è½®è¯¢çš„æ–¹å¼ã€‚é‚£å†…éƒ¨æ£€æµ‹é€šè¿‡&#39;mysql&gt; select event_name,MAX_TIMER_WAIT  FROM performance_schema.file_summary_by_event_name where event_name in (&#39;wait&#47;io&#47;file&#47;innodb&#47;innodb_log_file&#39;,&#39;wait&#47;io&#47;file&#47;sql&#47;binlog&#39;) and MAX_TIMER_WAIT&gt;200*1000000000;<br>&#39;çš„æ–¹æ³•ï¼Œä¸æ˜¯ä¹Ÿéœ€è¦å®šæ—¶è½®è¯¢æ¥æ‰§è¡Œè¿™ä¸ªè¯­å¥ä¹ˆï¼Ÿ","like_count":50,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439431,"discussion_content":"å¯¹ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ¬è´¨ä¸Šæ˜¯â€œå†…éƒ¨æŠŠä¸€æ®µæ—¶é—´å†…çš„ç»Ÿè®¡ä¿¡æ¯å­˜åœ¨è¿™é‡Œâ€ï¼Œåªæ˜¯â€œå®šæœŸæ¥å–â€ï¼Œå»åˆ°çš„æ˜¯â€œä¸€æ®µæ—¶é—´å†…çš„ä¿¡æ¯â€\n\nè€Œå‰é¢çš„å‡ ç§æ–¹æ³•ï¼Œéƒ½æ˜¯â€œæ£€æµ‹é‚£ä¸ªæ—¶é—´ç‚¹çš„ä¿¡æ¯â€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550333859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2389270,"avatar":"https://static001.geekbang.org/account/avatar/00/24/75/16/6e28bf17.jpg","nickname":"åˆæ™¨","note":"","ucode":"C5D95D13E49127","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590762,"discussion_content":"å¥½é—®é¢˜ã€‚  ä¸€ä¸ªæ˜¯å–è¿™ä¸ªæ—¶é—´ç‚¹çš„ä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯å–å·²ç»è®°å½•çš„ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666067675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"é™•è¥¿"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61694,"user_name":"è€æ¨åŒå¿—","can_delete":false,"product_type":"c1","uid":1246199,"ip_address":"","ucode":"3F334F0CFD3DE6","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/f7/3a493bec.jpg","comment_is_top":false,"comment_ctime":1547776409,"is_pvip":false,"replies":[{"id":"21986","content":"å¾ˆå¥½çš„å®è·µåˆ†äº«ã€‚<br>æ˜¯ä¸æ˜¯è¿˜æœ‰é…å¥—ä¸€äº›æœåŠ¡çš„RTæ—¶é—´çš„æŠ¥å‘Šï¼Ÿ<br>æ¯•ç«Ÿechoæ˜¯ä¸€ä¸ªæ¯”è¾ƒè½»é‡çš„è°ƒç”¨ï¼Œæ­£ç¡®ç‡å¯èƒ½æ¯”å®é™…ä¸šåŠ¡è°ƒç”¨çš„æ­£ç¡®ç‡é«˜","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547962569,"ip_address":"","comment_id":61694,"utype":1}],"discussion_count":4,"race_medal":0,"score":"117511893401","product_id":100020801,"comment_content":"ç°åœ¨å¾ˆå¤šå…¬å¸éƒ½æ˜¯ä½¿ç”¨dubboæˆ–è€…ç±»ä¼¼dubboçš„rpcè°ƒç”¨ã€‚è¯´è¯´æˆ‘å¯¹dubboçš„ç†è§£        <br>dubbo å­˜æ´»æ£€æµ‹æ„Ÿè§‰åˆ†ä¸ºä¸‹é¢ä¸‰ä¸ªå±‚é¢<br>æœåŠ¡ç«¯ä¸æ³¨å†Œä¸­å¿ƒçš„é“¾æ¥çŠ¶æ€<br>\t  é€šå¸¸æ³¨å†Œä¸­å¿ƒæ˜¯zookeeperï¼ŒæœåŠ¡ç«¯æ³¨å†Œä¸´æ—¶èŠ‚ç‚¹ï¼Œå®¢æˆ·ç«¯æ³¨å†Œè¿™ä¸ªèŠ‚ç‚¹çš„watchäº‹ä»¶ï¼Œä¸€ä½†æœåŠ¡ç«¯å¤±è”ï¼Œ<br>\t  å®¢æˆ·ç«¯å°†æŠŠè¯¥æœåŠ¡ä»è‡ªå·±å¯ç”¨æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤ã€‚ï¼ˆä¸€ä¸ªæœåŠ¡é€šå¸¸æœ‰å¤šä¸ªæä¾›è€…ï¼Œåªæ˜¯æŠŠå¤±è”çš„æä¾›è€…ç§»é™¤ï¼‰ã€‚<br>\t  zookeeperæ˜¯é€šè¿‡å¿ƒè·³å‘ç°æœåŠ¡æä¾›è€…å¤±è”çš„ï¼Œå¿ƒè·³å®é™…ä¸Šå°±æ˜¯ä»¥å›ºå®šçš„é¢‘ç‡ï¼ˆæ¯”å¦‚æ¯ç§’ï¼‰å‘é€æ£€æµ‹çš„æ•°æ®åŒ…ï¼›<br><br>å®¢æˆ·ç«¯ä¸æ³¨å†Œä¸­å¿ƒçš„é“¾æ¥çŠ¶æ€<br>\t\tå®¢æˆ·ç«¯ä¸zookeeperå¤±è”ï¼Œä¼šæš‚æ—¶ä½¿ç”¨è‡ªå·±ç¼“å­˜çš„æœåŠ¡æä¾›è€…åˆ—è¡¨ã€‚å¦‚æœæ¯ä¸ªæä¾›è€…å¤šæ¬¡è°ƒä¸é€šï¼ŒæŠŠå®ƒç§»é™¤ã€‚<br><br>å®¢æˆ·ç«¯ä¸æœåŠ¡å•çš„é“¾æ¥çŠ¶æ€<br>    æœåŠ¡ç«¯æä¾›ç±»ä¼¼äºechoçš„æ–¹æ³•ï¼Œå®¢æˆ·å®šæ—¶è°ƒç”¨ã€‚éƒ¨åˆ†è¿”å›æ­£å¸¸ï¼Œè®¤ä¸ºæœåŠ¡å¤„äºäºšå¥åº·çŠ¶æ€ï¼Œå¦‚æœè¶…è¿‡é˜€å€¼ï¼Œä¼šè¢«é™çº§<br>    ä»æœåŠ¡æä¾›è€…åˆ—è¡¨ç§»é™¤ã€‚è¢«ç§»é™¤çš„æ–¹æ³•å¯èƒ½ä¼šåœ¨è¶…è¿‡ä¸€å®šæ—¶é—´åï¼Œæ‹¿å›æ¥é‡è¯•ï¼Œå¯ä»¥æ¢å¤æˆæ­£å¸¸æœåŠ¡ï¼Œä¹Ÿå¯èƒ½ç»§ç»­é™çº§ã€‚","like_count":27,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436955,"discussion_content":"å¾ˆå¥½çš„å®è·µåˆ†äº«ã€‚\næ˜¯ä¸æ˜¯è¿˜æœ‰é…å¥—ä¸€äº›æœåŠ¡çš„RTæ—¶é—´çš„æŠ¥å‘Šï¼Ÿ\næ¯•ç«Ÿechoæ˜¯ä¸€ä¸ªæ¯”è¾ƒè½»é‡çš„è°ƒç”¨ï¼Œæ­£ç¡®ç‡å¯èƒ½æ¯”å®é™…ä¸šåŠ¡è°ƒç”¨çš„æ­£ç¡®ç‡é«˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547962569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1158349,"avatar":"https://static001.geekbang.org/account/avatar/00/11/ac/cd/fda6374f.jpg","nickname":"Louis","note":"","ucode":"BC667839F17937","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300255,"discussion_content":"å¥½å¤šé”™åˆ«å­—ã€‚ã€‚è¯»å¾—çœŸéš¾å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598000127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376548,"discussion_content":"zookeeperæ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼æ£€æµ‹mysqlæ˜¯å¦æ­£å¸¸çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622186379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2014285,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKNv880TlsNuKaWcKbxiaAZTQIBWfJAddC8wfOROnwRPRwJXaEGSTBH2sic4jK7IGpxZn79tTDcREjw/132","nickname":"Geek_7482f6","note":"","ucode":"F3565F78525D30","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410307,"discussion_content":"å¿ƒè·³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635657459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376548,"ip_address":""},"score":410307,"extra":""}]}]},{"had_liked":false,"id":64258,"user_name":"IceGeek17","can_delete":false,"product_type":"c1","uid":1103101,"ip_address":"","ucode":"1B42D7260449B4","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/fd/43802282.jpg","comment_is_top":false,"comment_ctime":1548727750,"is_pvip":false,"replies":[{"id":"22952","content":"æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¯´DDLï¼Œä¸€èˆ¬æ˜¯æŒ‡åŠ å‡ç´¢å¼•ï¼Œå¢åŠ å­—æ®µåœ¨æœ€åä¸€åˆ—ï¼Œè¿™ç§æ“ä½œâ€¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548940606,"ip_address":"","comment_id":64258,"utype":1}],"discussion_count":7,"race_medal":0,"score":"57383302598","product_id":100020801,"comment_content":"å¯¹äºä½¿ç”¨ GTID ç­‰ä½ç‚¹çš„æ–¹æ¡ˆåšè¯»å†™åˆ†ç¦»ï¼Œå¯¹å¤§è¡¨åšDDLçš„é—®é¢˜ï¼Œ<br>æœ‰ä¸€ç§åšæ³•æ˜¯å…ˆåœ¨ä»åº“ä¸Šè®¾ç½® set_log_bin = offï¼Œåœ¨ä»åº“ä¸Šå…ˆåšDDLï¼Œå®Œæˆååšä¸€ä¸‹ä¸»ä»åˆ‡æ¢ã€‚ç„¶åå†åœ¨ä¹‹å‰çš„ä¸»åº“ä¸ŠåŒæ ·æ“ä½œä¸€éã€‚<br>ä½†è¿™ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“å…ˆåœ¨ä»åº“ä¸ŠåšDDLï¼ˆå¤§è¡¨DDLæ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œæ¯”å¦‚10åˆ†é’Ÿï¼‰ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…ï¼Œæ­¤æ—¶å¦‚æœè¯»å†™è¯·æ±‚éƒ½èµ°ä¸»åº“çš„è¯ï¼Œå¦‚æœå†™è¯·æ±‚å¯¹äºDDLçš„æ”¹åŠ¨æ˜¯æœ‰ä¾èµ–çš„ï¼Œé‚£è¿™äº›å†™è¯·æ±‚åœ¨ä¸»åº“å°±å¯èƒ½ä¼šå¤±è´¥ï¼›åŒæ ·æ­¤æ—¶å¯¹äºä¸»åº“ä¸Šçš„è¯»è¯·æ±‚ï¼Œä¹Ÿå¯èƒ½ä¼šè¯»åˆ°â€œè¿‡æœŸâ€çš„æ•°æ®ï¼ˆè¯»è¯·æ±‚å¸Œæœ›è¯»åˆ°DDLä¹‹åçš„æ•°æ®ï¼Œä½†æ­¤æ—¶DDLåœ¨ä»åº“æ‰§è¡Œï¼Œä¸»åº“ä¸Šè¿˜æ˜¯DDLä¹‹å‰çš„ï¼‰ï¼Œè€å¸ˆæ€ä¹ˆçœ‹è¿™ä¸ªé—®é¢˜ ï¼Ÿ<br><br>","like_count":13,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437925,"discussion_content":"æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¯´DDLï¼Œä¸€èˆ¬æ˜¯æŒ‡åŠ å‡ç´¢å¼•ï¼Œå¢åŠ å­—æ®µåœ¨æœ€åä¸€åˆ—ï¼Œè¿™ç§æ“ä½œâ€¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548940606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1303145,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKa0PdjFnEpvGFBcED2P28ugPmwwRoCbeUfulpGEye8964F4nwChQyVfgVUia74TyDISvXTYJfQpA/132","nickname":"Nick","note":"","ucode":"D453E42B9A8429","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":254476,"discussion_content":"åˆ‡æ¢ä¸»ä»ä»£ä»· è¾ƒé«˜ ï¼ŒåŠ ç´¢å¼•ã€åŠ å­—æ®µåœ¨æœ€åä¸€åˆ—ï¼Œä¸è®°binlogçš„æ–¹å¼ï¼Œç›´æ¥åˆ†åˆ«åœ¨ä¸»ä»æ‰§è¡Œï¼Œä¹Ÿæ²¡é—®é¢˜å§ã€‚ ä¸€èˆ¬æ•°æ®åº“æ“ä½œå®Œæˆåæ‰ä¼šå‘ç‰ˆï¼Œä¸å½±å“åº”ç”¨ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1588329569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1303145,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIKa0PdjFnEpvGFBcED2P28ugPmwwRoCbeUfulpGEye8964F4nwChQyVfgVUia74TyDISvXTYJfQpA/132","nickname":"Nick","note":"","ucode":"D453E42B9A8429","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376549,"discussion_content":"åœ¨ä¸»åº“æ‰§è¡ŒDDLä¼šé€ æˆä»åº“çš„è¿‡æœŸè¯»é—®é¢˜ã€‚è¿™æ ·ä¸å°±å½±å“å½“å‰çš„ä¸šåŠ¡äº†å‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622186538,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":254476,"ip_address":""},"score":376549,"extra":""}]},{"author":{"id":1229114,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c1/3a/2ce09963.jpg","nickname":"å¼ å…ˆç”Ÿ","note":"","ucode":"E5E11D15CAC1D6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571540,"discussion_content":"DDLä¸æ˜¯ä¼šé”è¡¨å—ï¼Ÿè¿˜æ€ä¹ˆæŸ¥ä¸»åº“ï¼Ÿæˆ‘æœ‰ç‚¹è’™äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652261148,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2082118,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/P1y2k6dcoAWtlXkMcKFGeAmykTKCOKEicKsN0TX4eT6icibATfqnlsDyjicfjvo1zAa9lAS4ZGkSEGjeUUUmy9Qofg/132","nickname":"xyy_Li","note":"","ucode":"81A647AB5F757A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385228,"discussion_content":"è¯·é—®ä¸€ä¸‹å¢åŠ çš„æ•°æ®å­—æ®µæ”¾åœ¨æŸä¸ªå­—æ®µä¹‹åæˆ–è€…åŠ åœ¨æœ€åä¸€ä¸ªå­—æ®µä¹‹åï¼Œè¿™ä¸ªDDLçš„æ•ˆç‡ä¼šæœ‰ä»€ä¹ˆä¸åŒå—ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626947891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1367546,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dd/fa/6108000a.jpg","nickname":"Matzoh","note":"","ucode":"E92D6035230CDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269780,"discussion_content":"æˆ‘è®°å¾—è€å¸ˆè¯´è¿‡ï¼Œå¯ä»¥ç”¨ GTID çš„æ–¹å¼è¿›è¡Œä¸»ä»åˆ‡æ¢ï¼ŒåŒæ—¶ä¿è¯ binlog æœ‰è®°å½•ï¼Œä¸ºä»€ä¹ˆä¸ç”¨è¿™ä¸ªæ–¹æ¡ˆå‘¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589949387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1970443,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIx1V1QAxC4NHaxYZGyuibBN8lcURJWc5nrnO4yic1kxnDemYV2FJGialf47kYX9qtDnZZOfe1SJeLicg/132","nickname":"lleft","note":"","ucode":"D573EB509455AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1367546,"avatar":"https://static001.geekbang.org/account/avatar/00/14/dd/fa/6108000a.jpg","nickname":"Matzoh","note":"","ucode":"E92D6035230CDE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376550,"discussion_content":"ä»–è¯´çš„é‡ç‚¹æ˜¯åšDDLä¹‹åï¼Œå¯¹ä¸šåŠ¡SQLæœ‰å½±å“çš„æƒ…å†µï¼Œæ¯”å¦‚åˆ é™¤äº†ä¸€ä¸ªè¡¨å­—æ®µï¼Œä½†æ˜¯ä¸šåŠ¡SQLè¿˜è¦å¾€è¿™ä¸ªå­—æ®µå†™å€¼ï¼Œè¿™æ ·å°±ä¼šæŠ¥é”™çš„é—®é¢˜ã€‚è€å¸ˆè¯´çš„åŠ å‡ç´¢å¼•ã€å¢åŠ å­—æ®µåœ¨æœ€åä¸€åˆ—å¯¹åŸæ¥çš„ä¸šåŠ¡SQLæ²¡æœ‰å½±å“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622186688,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":269780,"ip_address":""},"score":376550,"extra":""}]}]},{"had_liked":false,"id":61683,"user_name":"å¼ºå“¥","can_delete":false,"product_type":"c1","uid":1206726,"ip_address":"","ucode":"3B8DC780FE4EF9","user_header":"https://static001.geekbang.org/account/avatar/00/12/69/c6/513df085.jpg","comment_is_top":false,"comment_ctime":1547774289,"is_pvip":false,"replies":[{"id":"21898","content":"ğŸ‘ï¼Œè¿™é‡Œçš„â€œè¶…æ—¶ç›‘æ§â€ï¼Œæ˜¯æ€ä¹ˆå¾—åˆ°çš„ï¼Ÿ<br>æ˜¯å•ç‹¬æœ‰å‘½ä»¤æ£€æµ‹ï¼Œè¿˜æ˜¯å»çœ‹ä¸šåŠ¡è¯·æ±‚çš„è¿”å›æ—¶é—´ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547782788,"ip_address":"","comment_id":61683,"utype":1}],"discussion_count":2,"race_medal":0,"score":"53087381841","product_id":100020801,"comment_content":"1.åŸºç¡€ç›‘æ§ï¼ŒåŒ…æ‹¬ç¡¬ç›˜ï¼ŒCPUï¼Œç½‘ç»œï¼Œå†…å­˜ç­‰ã€‚<br>2.æœåŠ¡ç›‘æ§ï¼ŒåŒ…æ‹¬jvmï¼ŒæœåŠ¡ç«¯å£ï¼Œæ¥å…¥ä¸Šä¸‹æ¸¸æœåŠ¡çš„è¶…æ—¶ç›‘æ§ç­‰ã€‚<br>3.ä¸šåŠ¡ç›‘æ§ï¼Œä¸»è¦æ˜¯ç›‘æ§ä¸šåŠ¡çš„æµç¨‹æ˜¯å¦å‡ºç°é—®é¢˜ã€‚","like_count":13,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436950,"discussion_content":"ğŸ‘ï¼Œè¿™é‡Œçš„â€œè¶…æ—¶ç›‘æ§â€ï¼Œæ˜¯æ€ä¹ˆå¾—åˆ°çš„ï¼Ÿ\næ˜¯å•ç‹¬æœ‰å‘½ä»¤æ£€æµ‹ï¼Œè¿˜æ˜¯å»çœ‹ä¸šåŠ¡è¯·æ±‚çš„è¿”å›æ—¶é—´ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1547782788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1063308,"avatar":"https://static001.geekbang.org/account/avatar/00/10/39/8c/089525aa.jpg","nickname":"å°ä¹™å“¥","note":"","ucode":"C77E79BEA0C325","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404331,"discussion_content":"ä¸€èˆ¬çœ‹æœåŠ¡çš„RTæ¯”è¾ƒå¤šã€‚æœåŠ¡å¼‚å¸¸å¾€å¾€è¡¨ç°å‡ºRTå˜é•¿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634289102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61678,"user_name":"é•¿æ°","can_delete":false,"product_type":"c1","uid":1312212,"ip_address":"","ucode":"DD52C9494005F7","user_header":"https://static001.geekbang.org/account/avatar/00/14/05/d4/e06bf86d.jpg","comment_is_top":false,"comment_ctime":1547773641,"is_pvip":false,"replies":[{"id":"21897","content":"å¦‚æœset sql_log_bin=0ï¼Œ å°±ä¸è®°å½•binlogï¼Œå°±ä¸ä¼šç»™è¿™ä¸ªäº‹åŠ¡åˆ†é…gtidã€‚<br><br>ä½ è¯´å¾—å¯¹ï¼Œdropåˆ—æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œå°½é‡ä¸åšã€‚æ¯•ç«Ÿä¸šåŠ¡ä»£ç ç›´æ¥æ— è§†è¿™ä¸ªåˆ—å°±å¥½äº†ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547782567,"ip_address":"","comment_id":61678,"utype":1}],"discussion_count":2,"race_medal":0,"score":"48792413897","product_id":100020801,"comment_content":"è€å¸ˆè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨gtidæ¨¡å¼ä¸‹ï¼Œå¯¹äºå¤§çš„ddlæ“ä½œï¼Œé‡‡ç”¨åœ¨å¤‡åº“æ‰§è¡Œsql_log_bin=0çš„æ–¹å¼å…ˆæ‰§è¡Œï¼Œç„¶åå†åˆ‡æ¢ä¸»å¤‡çš„æ–¹å¼åœ¨ä¸»åº“å†æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œddlæ“ä½œæ˜¯ä¸è®°å½•binlogçš„ï¼Œä¸çŸ¥é“å¯¹gtidçš„è®¡æ•°æœ‰ä»€ä¹ˆå½±å“ï¼Œæ˜¯æŒ‰é¡ºåºé€’å¢è¿˜æ˜¯ä¼šè·³è¿‡è¿™ä¸ªåºåˆ—å·ï¼Ÿ<br>å¦å¤–è¡¥å……ä¸€ä¸‹æœ‰äº›dlæ“ä½œæ˜¯ä¸é€‚åˆè¿™ä¸ªä¸»å¤‡åˆ‡æ¢çš„æ–¹å¼ï¼Œæ¯”å¦‚dropä¸€ä¸ªåˆ—ï¼Œå¦‚æœå…ˆåœ¨å¤‡åº“æ‰§è¡Œå°±å¯èƒ½å¯¼è‡´ä¸»å¤‡åŒæ­¥å¼‚å¸¸ã€‚è¿™ä¸ªåœºæ™¯é€‚åˆoscæ–¹å¼æˆ–æŠŠè¯»è¯·æ±‚åˆ‡åˆ°ä¸»åº“ï¼Œå…ˆåœ¨ä¸»åº“æ‰§è¡Œè¿™ä¸¤ç§æ–¹æ¡ˆã€‚","like_count":11,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436949,"discussion_content":"å¦‚æœset sql_log_bin=0ï¼Œ å°±ä¸è®°å½•binlogï¼Œå°±ä¸ä¼šç»™è¿™ä¸ªäº‹åŠ¡åˆ†é…gtidã€‚\n\nä½ è¯´å¾—å¯¹ï¼Œdropåˆ—æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œå°½é‡ä¸åšã€‚æ¯•ç«Ÿä¸šåŠ¡ä»£ç ç›´æ¥æ— è§†è¿™ä¸ªåˆ—å°±å¥½äº†ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547782567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410282,"discussion_content":"ä¸ºäº†å‘å‰å…¼å®¹ï¼Œä¸€èˆ¬ç›´æ¥æ— è§†è¿™ä¸ªåˆ—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635649058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81610,"user_name":"ä¸“æ ç”¨æˆ·","can_delete":false,"product_type":"c1","uid":1212492,"ip_address":"","ucode":"621C14A2BE0443","user_header":"https://static001.geekbang.org/account/avatar/00/12/80/4c/a0043823.jpg","comment_is_top":false,"comment_ctime":1553961550,"is_pvip":false,"replies":[{"id":"29643","content":"è¿™ä¸ªæ˜¯æ¡†æ¶åšçš„å§ï¼Ÿ <br><br>æˆ‘çŸ¥é“æœ‰äº›æ¡†æ¶å–œæ¬¢ç”¨<br>set autocommit=0, è¡¨ç¤ºå¼€å¯äº‹åŠ¡<br>set autocommit=1ï¼Œè¡¨ç¤ºæäº¤äº‹åŠ¡<br>è™½ç„¶ä¹Ÿå¯¹ï¼Œ<br><br>ä½†æ¯”è¾ƒå»ºè®®ç”¨begin å’Œ commit","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1554047856,"ip_address":"","comment_id":81610,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44503634510","product_id":100020801,"comment_content":"é—®ä¸ªå’Œæœ¬è¯¾ä¸å¤ªç›¸å…³çš„é—®é¢˜ï¼Œè‡ªå·±å¼€äº†general logï¼Œç„¶åçœ‹åˆ°æœ‰å¾ˆå¤šset autocommit=0,ä¹‹åset autocommit=1çš„æ—¥å¿—ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œçœ‹è¯´æ˜¯å…³é—­&#47;å¼€å¯è‡ªåŠ¨æäº¤æ¨¡å¼ï¼Œæ‰€ä»¥å°±æœ‰ç‚¹ä¸æ‡‚ä¸ºä½•ä¼šçˆ±æŒ¨ç€å‡ºç°è¿™ä¸¤ä¸ªè¯­å¥ï¼Ÿ","like_count":10,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445268,"discussion_content":"è¿™ä¸ªæ˜¯æ¡†æ¶åšçš„å§ï¼Ÿ \n\næˆ‘çŸ¥é“æœ‰äº›æ¡†æ¶å–œæ¬¢ç”¨\nset autocommit=0, è¡¨ç¤ºå¼€å¯äº‹åŠ¡\nset autocommit=1ï¼Œè¡¨ç¤ºæäº¤äº‹åŠ¡\nè™½ç„¶ä¹Ÿå¯¹ï¼Œ\n\nä½†æ¯”è¾ƒå»ºè®®ç”¨begin å’Œ commit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554047856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62804,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":false,"comment_ctime":1548162976,"is_pvip":false,"replies":[{"id":"22256","content":"å•Š ä¸»é”®å†²çªä¸ºå•¥æ²¡å…³ç³»ï¼Ÿ<br>æ˜¯è¿™æ ·çš„ï¼Œè¿™ä¸¤ä¸ªè¯­å¥å¦‚æœåŒæ—¶æ‰§è¡Œï¼Œé‚£ä¹ˆåœ¨ä¸»åº“å’Œå¤‡åº“ä¸Šå°±éƒ½æ˜¯â€œinsertè¡Œä¸ºâ€<br>å†™åˆ°binlogé‡Œé¢å°±éƒ½æ˜¯Write rows event<br>è¿™ä¸ªå†²çªå°±ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548224477,"ip_address":"","comment_id":62804,"utype":1}],"discussion_count":6,"race_medal":0,"score":"40202868640","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>å…³äº ä¸»å¤‡åŒæ­¥åœæ­¢ çš„é—®é¢˜ï¼Œçœ‹äº†æ‚¨çš„å›å¤ã€‚<br>æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼š<br>insert into mysql.health_check(id, t_modified) values (1, now()) on duplicate key update t_modified=now(); <br>æŒ‰ç…§æ‚¨è¯´çš„åœºæ™¯ï¼Œä¸»å¤‡åˆ†åˆ«æ‰§è¡Œè¿™å¥è¯åï¼Œå¤åˆ¶ç»™å½¼æ­¤ã€‚<br>å¦‚æœå•å•çœ‹è¿™å¥è¯ï¼Œå°±ç®—æ˜¯ä¸»åº“æ‰§è¡Œå¤‡åº“å¤åˆ¶è¿‡æ¥çš„è¿™å¥è¯ï¼Œä¹Ÿä¸ä¼šå‡ºç°å¼‚å¸¸å‘€ã€‚ï¼ˆå› ä¸ºå¦‚æœä¸»é”®å†²çªå°±ä¼šæ›´æ–°æ—¶é—´ï¼‰<br>ä½†æ˜¯è¿™ç§åœºæ™¯ä¼šå¯¼è‡´ ä¸»å¤‡åŒæ­¥åœæ­¢ï¼Œ æ‰€ä»¥å®é™…ä¸Šä¸»åº“åœ¨åº”ç”¨å¤‡åº“è¿™å¥è¯çš„binlogçš„æ—¶å€™ï¼Œå‘ç°ä¸»é”®å†²çªï¼Œè‡ªç„¶å°±ä¼šæŠ¥é”™ã€‚<br><br>ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºå¦‚æœå•å•çœ‹è¿™å¥sqlï¼Œå³ä½¿ä¸»é”®å†²çªä¹Ÿæ²¡å…³ç³»å‘€ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437356,"discussion_content":"å•Š ä¸»é”®å†²çªä¸ºå•¥æ²¡å…³ç³»ï¼Ÿ\næ˜¯è¿™æ ·çš„ï¼Œè¿™ä¸¤ä¸ªè¯­å¥å¦‚æœåŒæ—¶æ‰§è¡Œï¼Œé‚£ä¹ˆåœ¨ä¸»åº“å’Œå¤‡åº“ä¸Šå°±éƒ½æ˜¯â€œinsertè¡Œä¸ºâ€\nå†™åˆ°binlogé‡Œé¢å°±éƒ½æ˜¯Write rows event\nè¿™ä¸ªå†²çªå°±ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548224477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1030209,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b8/41/302f8cd4.jpg","nickname":"çº¤è·¯","note":"","ucode":"CDBAA49ED9D9E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":399473,"discussion_content":"å…¶å®å§ï¼Œä¸»è¦æ˜¯çº¿ä¸Šä¸€èˆ¬éƒ½æ˜¯è®¾ç½®binlog=row, è¿™ç§æƒ…å†µä¸‹ï¼Œè®°å½•æ˜¯å®é™…æ“ä½œçš„æ•°æ®è¡Œï¼Œå¦‚æœéƒ½æ˜¯insertï¼›é‚£ä¹ˆæœ€ç»ˆåœ¨ä¸»åº“æ‰§è¡Œå¤‡åº“å¤åˆ¶è¿‡æ¥binlog, å°±ä¼šå‡ºç°ä¸»é”®å†²çªï¼› å¦‚æœbinlog=statement,å“²å®æƒ…å†µä¸‹ï¼Œæ˜¯ä¸ä¼šå‡ºç°ä¸»é”®å†²çªï¼›ä½†æ˜¯å§ï¼Œçº¿ä¸Šä¸€èˆ¬ä¸å»ºè®®è®¾ç½®binlog=statementï¼›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632972556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117597,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0d/9d/58d09086.jpg","nickname":"è¾¾è¾¾é˜Ÿé•¿","note":"","ucode":"1C3F2E4F6B7637","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":264558,"discussion_content":"å†™åŒä¸€è¡Œå°±å›å†²çªï¼Ÿ ä¸»é”®å†²çªï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589333371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1953123,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKSIk2jfbj0wPzJVqY3DYia8vzWEJomX2NiazdwYqBKrTsPXWut11OUo2PJThssY3d36c1C1aHQKKCg/132","nickname":"Geek_da282e","note":"","ucode":"1CD940A1ECCA3D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262363,"discussion_content":"readonlyå¯¹superæƒé™çš„ç”¨æˆ·æ— æ•ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589080584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1276795,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7b/7b/5b39b47b.jpg","nickname":"TIAN","note":"","ucode":"CCCF80602C1753","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":239170,"discussion_content":"è¯·é—®å¤‡åº“ä¸éœ€è¦è®¾ç½®readonlyå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587280888,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2009624,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/aa/18/78b5d152.jpg","nickname":"ä»™äººæŒ","note":"","ucode":"102B3CE9B8222E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1276795,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7b/7b/5b39b47b.jpg","nickname":"TIAN","note":"","ucode":"CCCF80602C1753","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350187,"discussion_content":"æµ‹å¯ç”¨åº”è¯¥ä¼šç”¨ç®¡ç†å‘˜è´¦å·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613740722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":239170,"ip_address":""},"score":350187,"extra":""}]}]},{"had_liked":false,"id":62591,"user_name":"æ…§é‘«coming","can_delete":false,"product_type":"c1","uid":1324385,"ip_address":"","ucode":"7BAC9CA255630E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLE4LYb3jrH63ZV98Zpc8DompwDgb1O3nffMoZCmiaibauRyEFv6NDNsST9RWxZExvMLMWb50zaanoQ/132","comment_is_top":false,"comment_ctime":1548118253,"is_pvip":false,"replies":[{"id":"22160","content":"å¥½é—®é¢˜<br><br>æ¯”å¦‚ä¸¤ä¸ªè¡¨åˆšå¼€å§‹éƒ½æ˜¯ç©ºè¡¨ï¼Œ<br>ç„¶åç¬¬ä¸€ä¸ªè¯­å¥æ‰§è¡Œ<br>insert into mysql.health_check(id, t_modified) values (1, now()) on duplicate key update t_modified=now();<br><br>å°±ä¼šä¸¤è¾¹å„å†™å…¥ä¸€ä¸ªinsertè¯­å¥çš„binlogæ—¥å¿—ï¼Œä¼ åˆ°å¯¹é¢å°±å¯¼è‡´åŒæ­¥åœæ­¢äº†<br><br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548124225,"ip_address":"","comment_id":62591,"utype":1}],"discussion_count":10,"race_medal":0,"score":"40202823917","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæ–‡ä¸­æåˆ°çš„â€œä½†æ˜¯ï¼Œå¦‚æœä¸»åº“ A å’Œå¤‡åº“ B éƒ½ç”¨ç›¸åŒçš„æ›´æ–°å‘½ä»¤ï¼Œå°±å¯èƒ½å‡ºç°è¡Œå†²çªï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢ã€‚â€ï¼Œè¿™ä¸ªèƒ½å±•å¼€è¯´ä¸€ä¸‹å—ï¼Œè¿™ä¸ªè¡Œå†²çªæŒ‡ä»€ä¹ˆï¼Ÿå®ƒä»¬ä¼šéƒ½æ›´æ–°å„è‡ªæ£€æµ‹è¡¨çš„åŒä¸€å­—æ®µæˆ‘è§‰å¾—ä¼šå¸¦æ¥ä¸å‡†ç¡®çš„é—®é¢˜ï¼Œæ€ä¹ˆå¯¼è‡´ä¸»ä»åŒæ­¥åœæ­¢äº†å‘¢ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437268,"discussion_content":"å¥½é—®é¢˜\n\næ¯”å¦‚ä¸¤ä¸ªè¡¨åˆšå¼€å§‹éƒ½æ˜¯ç©ºè¡¨ï¼Œ\nç„¶åç¬¬ä¸€ä¸ªè¯­å¥æ‰§è¡Œ\ninsert into mysql.health_check(id, t_modified) values (1, now()) on duplicate key update t_modified=now();\n\nå°±ä¼šä¸¤è¾¹å„å†™å…¥ä¸€ä¸ªinsertè¯­å¥çš„binlogæ—¥å¿—ï¼Œä¼ åˆ°å¯¹é¢å°±å¯¼è‡´åŒæ­¥åœæ­¢äº†\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548124225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1587282,"avatar":"https://static001.geekbang.org/account/avatar/00/18/38/52/526c10f9.jpg","nickname":"é˜¿ä¸ƒ","note":"","ucode":"B14B05BD0EB78A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":36938,"discussion_content":"æ„æ€æ˜¯binlogé‡Œè®°è½½çš„å°±ç­æœ‰â€˜on duplicate key update t_modified=now()&#39;è¿™ä¸ªä¿¡æ¯äº†å—","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571466552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2497728,"avatar":"https://static001.geekbang.org/account/avatar/00/26/1c/c0/b8ff566a.jpg","nickname":"æˆ‘æ˜¯å¤§æ©™å­132","note":"","ucode":"61660568CF07C9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1587282,"avatar":"https://static001.geekbang.org/account/avatar/00/18/38/52/526c10f9.jpg","nickname":"é˜¿ä¸ƒ","note":"","ucode":"B14B05BD0EB78A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576126,"discussion_content":"å¯¹çš„ï¼Œéƒ½æ˜¯æ’å…¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655287685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":36938,"ip_address":""},"score":576126,"extra":""}]},{"author":{"id":1986739,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/50/b3/9269cd59.jpg","nickname":"LWD","note":"","ucode":"DDA444DB113C01","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587979,"discussion_content":"ä¸ºä»€ä¹ˆä¸åœ¨å»ºç«‹åŒä¸»å‰å°±å…ˆåˆå§‹åŒ–å‘¢ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663420855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1261530,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKDKsicmpne7xQNocwRQ80DDZ3CzjsDoVIcH0SBiaYzS056oVOx4pEeEVeCaXE3QtsjUIEI0x1xQVTw/132","nickname":"muggle","note":"","ucode":"D78087BCAD0860","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536790,"discussion_content":"åº”è¯¥æ˜¯è¿™ä¸ªæ„æ€ï¼Œåœ¨å®¢æˆ·ç«¯åšçš„å®šæ—¶å™¨ï¼Œä¼šè¿æ¥ä¸»ä»ï¼Œåœ¨ä¸»ä»ä¸¤è¾¹éƒ½æ‰§è¡Œè¯¥è¯­å¥ï¼Œè™½ç„¶ä¹‹å‰æœ‰ç”¨server_idæ¥è§£å†³MMç»“æ„ä¸‹çš„ä¸»å¤‡åŒæ­¥æ—¥å¿—é—®é¢˜ï¼Œä½†ä¹Ÿä»…é™äºä¸€è¾¹ä¸»åŠ¨æ‰§è¡Œï¼Œå¦ä¸€è¾¹éä¸»åŠ¨æ‰§è¡Œçš„æƒ…å†µï¼Œè€Œå¦‚æœä¸¤è¾¹åŒæ—¶æ‰§è¡Œï¼Œå°±ä¼šä¸¤è¾¹éƒ½äº’ç›¸åŒæ­¥ï¼Œå¯¼è‡´æŠ¥é”™ï¼Œè¿›è€Œä¸­æ­¢å®šæ—¶å™¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638868632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":292984,"discussion_content":"æˆ‘ä¹Ÿæœ‰ç‚¹è’™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595404452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2101988,"avatar":"https://static001.geekbang.org/account/avatar/00/20/12/e4/57ade29a.jpg","nickname":"dva","note":"","ucode":"EE27DAFCBF198D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301937,"discussion_content":"æˆ‘è§‰å¾—åº”è¯¥æ˜¯åŒmç»“æ„ä¸¤ç¬”éƒ½è¦æ£€æµ‹çŠ¶æ€ï¼Œæ‰€ä»¥ä¸¤è¾¹éƒ½è¿è¡Œç€æ¡è¯­å¥ï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªidçš„è¯å°±ä¼šæŠ¥é”™ï¼Œæ‰éœ€è¦ç”¨@@server_id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598712008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292984,"ip_address":""},"score":301937,"extra":""},{"author":{"id":1644104,"avatar":"https://static001.geekbang.org/account/avatar/00/19/16/48/09493874.jpg","nickname":"èŒ¶æ²¡å–å®Œ","note":"","ucode":"D72D88C42A1258","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351235,"discussion_content":"è¿™ä¸ªè¯­å¥è®°å½•åˆ°binlogå°±æ˜¯ä¸€æ¡insertè¯­å¥ï¼ŒåŒ…å«å®Œæ•´çš„æ’å…¥æ•°æ®ï¼Œæ²¡æœ‰ on duplicate key updateç›¸å…³çš„ä¿¡æ¯äº†ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ä¸»é”®å†²çª","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614186316,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":292984,"ip_address":""},"score":351235,"extra":""}]},{"author":{"id":1031845,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/be/a5/df917d18.jpg","nickname":"ward-wolf","note":"","ucode":"BC41D01301263A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217935,"discussion_content":"è€å¸ˆçš„æ„æ€éš¾é“æ˜¯ä¸»é”®å†²çªå°±ä¼šå¯¼è‡´ä¸»ä»åŒæ­¥åœæ­¢ä¹ˆï¼Ÿæˆ‘ä¹Ÿæœ‰ç‚¹æ‡µæ‡µçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585585356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1672786,"avatar":"https://static001.geekbang.org/account/avatar/00/19/86/52/91c7d112.jpg","nickname":"Garen","note":"","ucode":"0608C88F83EF0C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":41386,"discussion_content":"åšä¸»ä»ï¼Œbinlogä¸€èˆ¬éƒ½ä¸ç”¨STATEMENTæ ¼å¼ã€‚å¦ä¸¤ç§æ ¼å¼è¦ä¹ˆè®°insertï¼Œè¦ä¹ˆè®°updateã€‚ä¸ä¼šè®°å®Œæ•´çš„sqlã€‚æˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572417963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88940,"user_name":"è·¯å¹³","can_delete":false,"product_type":"c1","uid":1068133,"ip_address":"","ucode":"92A970D8635D3F","user_header":"https://static001.geekbang.org/account/avatar/00/10/4c/65/24df4f11.jpg","comment_is_top":false,"comment_ctime":1556030034,"is_pvip":false,"replies":[{"id":"32651","content":"å¦‚æœä½ æ˜¯è¦ä¿å­˜â€œå†å²â€ï¼Œå¯ä»¥åŠ ä¸¤ä¸ªå­—æ®µï¼šç‰ˆæœ¬å·å’ŒçŠ¶æ€ï¼ˆè¡¨ç¤ºæ˜¯å¦åˆ é™¤ï¼‰<br><br>ã€ç¼–è¾‘è·Ÿæˆ‘è¯´ä¼šæœ‰æé†’~ã€‘","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1556851105,"ip_address":"","comment_id":88940,"utype":1}],"discussion_count":3,"race_medal":0,"score":"35915768402","product_id":100020801,"comment_content":"ä½ å¥½ï¼Œè¿™ä¸¤å¤©ä¸€è·¯çœ‹ä¸‹æ¥ï¼Œæ”¶è·ä¸å°‘ã€‚<br>æä¸ªè¡¨è®¾è®¡ç›¸å…³çš„é—®é¢˜ï¼š<br>ç”¨ä¸€ä¸ªè¡¨å­˜å‚¨æ–‡ä»¶å…¨è·¯å¾„ï¼Œåˆ é™¤æŸä¸ªæ–‡ä»¶ï¼ˆä¸€è¡Œè®°å½•ï¼‰æ—¶ä½¿ç”¨é€»è¾‘åˆ é™¤ã€‚æ€ä¹ˆè®¾è®¡è¡¨åŠå…¶ç´¢å¼•ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Ÿ<br>éœ€è¦è€ƒè™‘ï¼š<br>1. æ–‡ä»¶è¢«åˆ é™¤åæœ‰å¯èƒ½ä¼šå†åˆ›å»ºä¸€ä¸ªåŒåçš„æ–‡ä»¶ï¼›<br>2. æ–°åˆ›å»ºçš„æ–‡ä»¶ä¹Ÿå¯èƒ½å†æ¬¡è¢«é€»è¾‘åˆ é™¤ï¼›<br>3. ç¬¬äºŒä¸ªæ–‡ä»¶è¢«åˆ é™¤åè¿˜å¯èƒ½åˆ›å»ºç¬¬ä¸‰åŒåæ–‡ä»¶ï¼Œä»¥æ­¤ç±»æ¨ï¼›<br>4. æœªåˆ é™¤çš„æ–‡ä»¶è·¯å¾„ä¸èƒ½æœ‰é‡å¤å€¼ã€‚<br><br>ä¸çŸ¥é“ä½œè€…æ˜¯å¦è¿˜ä¼šå›å¤ç•™è¨€ã€‚å¦‚æœå›å¤äº†ï¼Œæˆ‘æ˜¯ä¼šæ”¶åˆ°æé†’å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":2704955,"avatar":"","nickname":"Geek_aad518","note":"","ucode":"8EE7A18A46F983","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540654,"discussion_content":"is_deletedå­—æ®µ  0ï¼šæœªåˆ é™¤ï¼›æ—¶é—´æˆ³ï¼šå·²åˆ é™¤ã€‚ï¼ˆç”¨æ—¶é—´æˆ³è¿˜èƒ½çŸ¥é“åˆ é™¤çš„å…·ä½“æ—¶é—´ï¼‰ã€‚ç„¶åå»ºå”¯ä¸€ç´¢å¼•ï¼ˆname, is_deletedï¼‰ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1640104712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447954,"discussion_content":"å¦‚æœä½ æ˜¯è¦ä¿å­˜â€œå†å²â€ï¼Œå¯ä»¥åŠ ä¸¤ä¸ªå­—æ®µï¼šç‰ˆæœ¬å·å’ŒçŠ¶æ€ï¼ˆè¡¨ç¤ºæ˜¯å¦åˆ é™¤ï¼‰\n\nã€ç¼–è¾‘è·Ÿæˆ‘è¯´ä¼šæœ‰æé†’~ã€‘","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1556851105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1042507,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e8/4b/57fa0e34.jpg","nickname":"brianway","note":"","ucode":"E05738C88829C2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554178,"discussion_content":"æ¥¼ä¸Šè¯´çš„åŸºæœ¬æ­£ç¡®ï¼ŒåŠ ä¸€åˆ—detele_timeï¼Œè¡¨ç¤ºåˆ é™¤æ—¶é—´ï¼Œé»˜è®¤NULLï¼Œè¡¨ç¤ºæœªåˆ é™¤ï¼Œä½œç”¨ç­‰åŒäºè€å¸ˆè¯´çš„ç‰ˆæœ¬å·ã€‚ å”¯ä¸€ç´¢å¼•ï¼š(path,delete_time)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646236268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62462,"user_name":"ä¸€å¤§åªğŸ˜´","can_delete":false,"product_type":"c1","uid":1310960,"ip_address":"","ucode":"92F3D2B7F63568","user_header":"https://static001.geekbang.org/account/avatar/00/14/00/f0/08409e78.jpg","comment_is_top":false,"comment_ctime":1548062889,"is_pvip":false,"replies":[{"id":"22101","content":"Thread running æ˜¯åŒ…å«â€œé”ç­‰å¾…â€çŠ¶æ€çš„çº¿ç¨‹çš„ï¼Œ<br>è¶…è¿‡ç‚¹ä¹Ÿæ²¡äº‹ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548087407,"ip_address":"","comment_id":62462,"utype":1}],"discussion_count":2,"race_medal":0,"score":"27317866665","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹ï¼Œæˆ‘çš„ECSä¸Šæ˜¯8æ ¸CPUï¼Œåªè·‘ä¸€ä¸ªMySQLå®ä¾‹ï¼Œé‚£innodb_thread_concurrencyå¦‚æœè®¾æˆ2å€ï¼Œé‚£å°±æ˜¯16å“ˆã€‚çœ‹å¹¶å‘æŸ¥è¯¢çš„æ•°é‡ï¼Œæ˜¯ä¸æ˜¯å…³æ³¨Threads_runningæ˜¯å¦è¶…è¿‡innodb_thread_concurrencyå°±å¯ä»¥äº†ã€‚","like_count":6,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437223,"discussion_content":"Thread running æ˜¯åŒ…å«â€œé”ç­‰å¾…â€çŠ¶æ€çš„çº¿ç¨‹çš„ï¼Œ\nè¶…è¿‡ç‚¹ä¹Ÿæ²¡äº‹ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548087407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368688,"discussion_content":"Threads connected means the total number of client processes (threads) connected to the database server. This includes the count for threads running.\n\nThread running means the total number of client processes (threads) currently executing on the database server. The server is holding these connections while the client is waiting for a reply. These thread may be consuming IO/CPU, while others may do nothing while waiting for a table lock to be released. When the database is finished executing the thread, the client gets a reply, and the thread is changed from status &#34;running&#34; to &#34;connected&#34;.\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618803050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":62676,"user_name":"Mr.Strive.Z.H.L","can_delete":false,"product_type":"c1","uid":1030198,"ip_address":"","ucode":"6D97E159E2EECD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg","comment_is_top":false,"comment_ctime":1548128475,"is_pvip":false,"replies":[{"id":"22192","content":"æ¯”å¦‚ä¸¤ä¸ªè¡¨åˆšå¼€å§‹éƒ½æ˜¯ç©ºè¡¨ï¼Œ<br>ç„¶åç¬¬ä¸€ä¸ªè¯­å¥æ‰§è¡Œ<br>insert into mysql.health_check(id, t_modified) values (1, now()) on duplicate key update t_modified=now();<br><br>å°±ä¼šä¸¤è¾¹å„å†™å…¥ä¸€ä¸ªinsertè¯­å¥çš„binlogæ—¥å¿—ï¼Œä¼ åˆ°å¯¹é¢å°±å¯¼è‡´åŒæ­¥åœæ­¢äº†<br>","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1548139036,"ip_address":"","comment_id":62676,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23022964955","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br><br>æœ¬ç« æœ‰ä¸ªç–‘æƒ‘ï¼š<br>â€å¤–éƒ¨æ£€æµ‹çš„æ—¶å€™ï¼Œä¸»å¤‡ä½¿ç”¨åŒä¸€æ¡æ›´æ–°è¯­å¥ï¼Œé€ æˆè¡Œå†²çªï¼Œå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢â€<br><br>ä¸Šé¢è¿™å¥è¯å®åœ¨æƒ³ä¸é€šã€‚å¤–éƒ¨æ£€æµ‹æ˜¯åªæ˜¯çœ‹æ›´æ–°è¯­å¥çš„è¿”å›æ—¶é—´ï¼Œhealth_checkè¡¨åœ¨ä¸»åº“å¤‡åº“éƒ½æœ‰ï¼Œä¸ºå•¥ä¼šé€ æˆè¡Œå†²çªï¼Ÿä¸ºå•¥ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢ï¼Ÿå³ä½¿æ˜¯ç›¸åŒçš„binlogï¼Œä¹Ÿæ²¡å•¥å½±å“å‘€ã€‚","like_count":5,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437300,"discussion_content":"æ¯”å¦‚ä¸¤ä¸ªè¡¨åˆšå¼€å§‹éƒ½æ˜¯ç©ºè¡¨ï¼Œ\nç„¶åç¬¬ä¸€ä¸ªè¯­å¥æ‰§è¡Œ\ninsert into mysql.health_check(id, t_modified) values (1, now()) on duplicate key update t_modified=now();\n\nå°±ä¼šä¸¤è¾¹å„å†™å…¥ä¸€ä¸ªinsertè¯­å¥çš„binlogæ—¥å¿—ï¼Œä¼ åˆ°å¯¹é¢å°±å¯¼è‡´åŒæ­¥åœæ­¢äº†\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1548139036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138098,"user_name":"lzh","can_delete":false,"product_type":"c1","uid":1336951,"ip_address":"","ucode":"C3D83DF4230109","user_header":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","comment_is_top":false,"comment_ctime":1570023267,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"14454925155","product_id":100020801,"comment_content":"éš¾é“å°±æ²¡äººé—®ä¸ºå•¥SELECT 1ä¸ç®—å…¥å¹¶å‘çº¿ç¨‹ä¸­å—ï¼Ÿéš¾é“å› ä¸ºæ²¡æŸ¥è¡¨å—ï¼Ÿåªæœ‰æŸ¥äº†è¡¨æ¶‰åŠIOçš„æ‰ä¼šç®—å…¥å¹¶å‘çº¿ç¨‹ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1062848,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","nickname":"walleæ–Œ","note":"","ucode":"0DB3243004951F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296307,"discussion_content":"åŒä¸Šï¼Œæˆ‘åœ¨è‡ªå·±çš„ç¬”è®°å°±å†™çš„æ˜¯ select 1 åœ¨æ‰§è¡Œå™¨å°±è¿”å›äº†ï¼Œå‹æ ¹æ²¡å€’innodbå¼•æ“ï¼Œæ›´ä¸ç”¨è¯´å ç”¨å¹¶å‘æ•°äº†","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1596506862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":125574,"discussion_content":"æˆ‘çš„ç†è§£æ˜¯ select 1, æ²¡æœ‰è¿›å…¥åˆ°å¼•æ“æ‰§è¡Œï¼Œåœ¨æ‰§è¡Œå™¨æ‰§è¡Œåå°±è¿”å›äº†","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1578490125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1971077,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLG44I6sZyAQQLiazlJicx3b4NJpXrKzAGTsrWPm5DiaR6fmDqmIP2C9GkIZSrvf79zcmcU2S98iaiaGhQ/132","nickname":"Geek_0eb798","note":"","ucode":"6DB450F9C647C7","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390300,"discussion_content":"innodb_thread_concurrency çœ‹è¿™ä¸ªå‚æ•°åï¼Œåº”è¯¥æ˜¯åªå¯¹innodbå¼•æ“ç”Ÿæ•ˆå§ï¼Œè€Œselect 1å¹¶ä¸ä¼šç”¨åˆ°innodbå¼•æ“ï¼Œæ‰€ä»¥ä¸ä¼šé™åˆ¶","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629768057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543162,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/fa/103e6900.jpg","nickname":"å±±é¬¼è°£","note":"","ucode":"E25F498B85A01B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535037,"discussion_content":"select 1ç¡®å®ä¸ä¼šåˆ°å¼•æ“å±‚ï¼›å®˜æ–¹æ–‡æ¡£ä¸­æœ‰ä¸ªä¾‹å­ï¼šSELECT 1 + 1 è¾“å‡ºçš„æ˜¯2ã€‚ä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œå™¨å¯ä»¥ç”¨æ¥å½“è®¡ç®—å™¨æ¥ç”¨ï¼Œå³ç¡®å®å­˜åœ¨ä¸éœ€è¦è®¿é—®å¼•æ“çš„åœºæ™¯ã€‚\nhttps://dev.mysql.com/doc/refman/5.6/en/select.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638340092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410284,"discussion_content":"ç‰›é€¼ç‰›é€¼ï¼Œç¡®å®ä»¥innodbå¼€å¤´çš„å‚æ•°éƒ½æ˜¯æ§åˆ¶innodbå¼•æ“ä¾§ç›¸å…³çš„åŠŸèƒ½ï¼Œå¦‚æœè¯­å¥æ²¡åˆ°å¼•æ“å±‚ç¡®å®é™åˆ¶ä¸åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635649713,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2640551,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4a/a7/ab7998b1.jpg","nickname":"zachary","note":"","ucode":"B22B95FCECD6E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378913,"discussion_content":"æˆ‘ä¹Ÿæœ‰åŒæ ·çš„ç–‘é—®ï¼Œç›®å‰è¿™ä¸ªè§£é‡Šè²Œä¼¼èƒ½è¯´çš„é€šå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623507312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61944,"user_name":"heat nan","can_delete":false,"product_type":"c1","uid":1153826,"ip_address":"","ucode":"52D5CB17CE80E5","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/22/dd04892a.jpg","comment_is_top":false,"comment_ctime":1547863989,"is_pvip":false,"replies":[{"id":"21952","content":"â€œå› ä¸ºå†…å­˜ä¸­çš„é¡µå¯èƒ½æ˜¯åˆ†æ•£çš„ï¼Œå¯èƒ½ä¸æ„æˆä¸€ä¸ªå®Œæˆçš„ç´¢å¼•ç»“æ„ï¼Œå¯èƒ½ä¸èƒ½åˆ©ç”¨b+æ ‘å¶å­èŠ‚ç‚¹çš„è·¯ç”±åŠŸèƒ½ã€‚â€<br><br>è¿™é‡Œä¸å¯¹å“ˆ<br><br>æ”¾åœ¨å†…å­˜é‡Œæ˜¯b+æ ‘ç»„ç»‡çš„ï¼Œå¯ä»¥åˆ©ç”¨b+æ ‘å¶å­èŠ‚ç‚¹çš„è·¯ç”±åŠŸèƒ½çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547867135,"ip_address":"","comment_id":61944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14432765877","product_id":100020801,"comment_content":"è€å¸ˆï¼Œä¸€ç›´æœ‰ä¸ªç–‘é—®ï¼Œæƒ³å’¨è¯¢ä¸‹ã€‚innodb buffer ä¼šç¼“å­˜è¡¨çš„æ•°æ®é¡µå’Œç´¢å¼•é¡µã€‚ç°åœ¨æˆ‘æƒ³çŸ¥é“å¦‚ä½•ç¡®è®¤ä¸€ä¸ªæŸ¥è¯¢çš„è¡Œå·²ç»è¢«ç¼“å­˜åœ¨å†…å­˜ä¸­äº†ã€‚  æˆ‘æƒ³äº†ä¸€ä¸‹ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯ç›´æ¥å»å†…å­˜ä¸­éå†è¿™ä¸ªè¡¨ç›¸å…³çš„æ•°æ®é¡µã€‚è¿™æ ·çš„è¯ï¼Œå› ä¸ºå†…å­˜ä¸­çš„é¡µå¯èƒ½æ˜¯åˆ†æ•£çš„ï¼Œå¯èƒ½ä¸æ„æˆä¸€ä¸ªå®Œæˆçš„ç´¢å¼•ç»“æ„ï¼Œå¯èƒ½ä¸èƒ½åˆ©ç”¨b+æ ‘å¶å­èŠ‚ç‚¹çš„è·¯ç”±åŠŸèƒ½ã€‚ è¿™é‡Œæœ‰ç‚¹æ¨¡ç³Šï¼Œå¸Œæœ›è€å¸ˆæœ‰ç©ºå¯ä»¥è§£é‡Šä¸€ä¸‹","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":437044,"discussion_content":"â€œå› ä¸ºå†…å­˜ä¸­çš„é¡µå¯èƒ½æ˜¯åˆ†æ•£çš„ï¼Œå¯èƒ½ä¸æ„æˆä¸€ä¸ªå®Œæˆçš„ç´¢å¼•ç»“æ„ï¼Œå¯èƒ½ä¸èƒ½åˆ©ç”¨b+æ ‘å¶å­èŠ‚ç‚¹çš„è·¯ç”±åŠŸèƒ½ã€‚â€\n\nè¿™é‡Œä¸å¯¹å“ˆ\n\næ”¾åœ¨å†…å­˜é‡Œæ˜¯b+æ ‘ç»„ç»‡çš„ï¼Œå¯ä»¥åˆ©ç”¨b+æ ‘å¶å­èŠ‚ç‚¹çš„è·¯ç”±åŠŸèƒ½çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547867135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61759,"user_name":"å¸ƒè¡£éª‡å®¢","can_delete":false,"product_type":"c1","uid":1256280,"ip_address":"","ucode":"5226B0F67090D1","user_header":"https://static001.geekbang.org/account/avatar/00/13/2b/58/11c05ccb.jpg","comment_is_top":false,"comment_ctime":1547792967,"is_pvip":false,"replies":[{"id":"21914","content":"æœ‰DBAå°±ä¸è¦è‡ªå·±å»ä¿®æ”¹çº¿ä¸Šçš„å‚æ•°å•¦<br><br>å¦‚æœè¯´è§‚å¯Ÿï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç®¡æ§ç³»ç»Ÿï¼Œæ˜¯ä¼šèƒ½å¤Ÿè®©ä½ çœ‹åˆ°è¿™äº›å€¼çš„<br><br>å¦‚æœæ²¡æœ‰ï¼Œå°±è®©dbaç»™ä½ ä¸€ä»½çº¿ä¸Šçš„my.cnfçš„é…ç½®ï¼Œç„¶åä½ åœ¨æµ‹è¯•ç¯å¢ƒè‡ªå·±ç”¨è¿™ä¸ªé…ç½®å¯åŠ¨å®ä¾‹æ¥è§‚å¯Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547802721,"ip_address":"","comment_id":61759,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14432694855","product_id":100020801,"comment_content":"ä½œä¸ºä¸€ä¸ªå¼€å‘æˆ‘ä¹Ÿå¾ˆæƒ³äº†è§£ä¸€ä¸‹æˆ‘ä»¬è‡ªå·±ç”Ÿäº§åº“ä¸Šçš„ç›‘æ§æƒ…å†µï¼Œæ¥è§¦åˆ°æœ€å¤šçš„å°±æ˜¯Datasource,ä»¥åŠuserï¼Œpassword,portï¼ˆåŸºæœ¬ä¸Šæ˜¯åŸºäºè¿æ¥é‚£ç§çº§åˆ«ï¼Œæœ€å¤šå°±æ˜¯åŠ é”ï¼‰ï¼Œç­‰ç­‰å‚æ•°ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯åŸºäºä¸šåŠ¡å¼€å‘ã€‚ç«™åœ¨ä¸ªäººå±‚é¢æˆ–è€…ä¸šåŠ¡å¼€å‘å±‚é¢ï¼ˆå¾ˆå°‘èƒ½æ¥è§¦åˆ°DBAï¼Œä»¥åŠçœ‹åˆ°DBAæ˜¯æ€ä¹ˆè®¾ç½®è¿™äº›å‚æ•°æƒ…å†µï¼Œé™¤éåº“æŒ‚æ‰äº†å°±ä¼šå’ŒDBAä¸€èµ·çœ‹è¿™äº›ï¼‰æ€ä¹ˆå»ä¿®æ”¹å’Œè§‚çœ‹ä»¥åŠä½¿ç”¨è¿™äº›å‚æ•°é¸­","like_count":3,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436979,"discussion_content":"æœ‰DBAå°±ä¸è¦è‡ªå·±å»ä¿®æ”¹çº¿ä¸Šçš„å‚æ•°å•¦\n\nå¦‚æœè¯´è§‚å¯Ÿï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ç®¡æ§ç³»ç»Ÿï¼Œæ˜¯ä¼šèƒ½å¤Ÿè®©ä½ çœ‹åˆ°è¿™äº›å€¼çš„\n\nå¦‚æœæ²¡æœ‰ï¼Œå°±è®©dbaç»™ä½ ä¸€ä»½çº¿ä¸Šçš„my.cnfçš„é…ç½®ï¼Œç„¶åä½ åœ¨æµ‹è¯•ç¯å¢ƒè‡ªå·±ç”¨è¿™ä¸ªé…ç½®å¯åŠ¨å®ä¾‹æ¥è§‚å¯Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547802721,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61681,"user_name":"Ryoma","can_delete":false,"product_type":"c1","uid":1130590,"ip_address":"","ucode":"7F692369239692","user_header":"https://static001.geekbang.org/account/avatar/00/11/40/5e/b8fada94.jpg","comment_is_top":false,"comment_ctime":1547773863,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"10137708455","product_id":100020801,"comment_content":"ç°åœ¨çš„æœåŠ¡ä¸­åªåŠ äº†ä¸€ä¸ªhealthCheckçš„æ¥å£ï¼Œå’ŒMySQLä¸­ä½¿ç”¨selectåˆ¤æ–­æ¯”è¾ƒç±»ä¼¼ã€‚å½“æœåŠ¡ä¾èµ–çš„MySQLåŠRedisç­‰ç¬¬ä¸‰æ–¹èµ„æºå‘ç”Ÿé—®é¢˜æ—¶ï¼Œè¿˜æ˜¯ä¸èƒ½æœ‰æ•ˆçš„åˆ¤æ–­","like_count":2},{"had_liked":false,"id":121595,"user_name":"Shikiç ","can_delete":false,"product_type":"c1","uid":1605496,"ip_address":"","ucode":"79DD60ED42C2F1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wVJLKmibyYdqv3Uu4zCrN3iaucoMTGqppPvC1VMcAFSToz8BIiagnx6AcEFvDmd0533rRS7sa0dO47mCdkhfHOXRw/132","comment_is_top":false,"comment_ctime":1565164400,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"5860131696","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼è¯·æ•™ä¸‹ï¼Œæˆ‘ä»¬è¿™è¾¹æ¯å¤©ç™½å¤©å‡ ä¹æ¯ä¸ªæ•´ç‚¹ï¼Œä¸šåŠ¡é‚£è¾¹æœ‰å®šæ—¶æ‰¹é‡ä»»åŠ¡ï¼Œé‚£å‡ åˆ†é’Ÿå†…CPUä¼šå½ªåˆ°100%ã€‚æ´»è·ƒçº¿ç¨‹æ•°ä¹Ÿåœ¨200å·¦å³ï¼ŒQPSå³°å€¼20000+ï¼Œæ­¤æ—¶ä¹Ÿä¼šå‡ºç°å¹³æ—¶ä¸æ…¢çš„â€œæ…¢sqlâ€ï¼Œå¦‚æœæŠŠinnodb_thread_concurrencyä»0æ”¹ä¸º128æˆ–è€…æ›´ä½ï¼Œæ˜¯å¦ä¼šæœ‰æ‰€ç¼“è§£å‘¢?ä½†æ˜¯å¦‚æœé™åˆ¶äº†é‚£æœ‰å¾ˆå¤šè¿æ¥ä¼šæ’é˜Ÿç­‰å¾…æ˜¯å¦ä¼šå»¶è¿Ÿï¼Œè€Œé€ æˆä¸šåŠ¡å¾ˆæ…¢å‘¢?","like_count":1,"discussions":[{"author":{"id":2542376,"avatar":"https://static001.geekbang.org/account/avatar/00/26/cb/28/21a8a29e.jpg","nickname":"å¤å¤©","note":"","ucode":"5F224DDAC94DFF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368691,"discussion_content":"å¦‚æœæŠŠinnodb_thread_concurrencyä»0æ”¹ä¸º128æˆ–è€…æ›´ä½ï¼Œæ˜¯å¦ä¼šæœ‰æ‰€ç¼“è§£å‘¢?ä½†æ˜¯å¦‚æœé™åˆ¶äº†é‚£æœ‰å¾ˆå¤šè¿æ¥ä¼šæ’é˜Ÿç­‰å¾…æ˜¯å¦ä¼šå»¶è¿Ÿï¼Œè€Œé€ æˆä¸šåŠ¡å¾ˆæ…¢å‘¢?\n\n---\nCPU å·²ç» 100% äº†ã€‚æ”¹è¿™äº›å‚æ•°æ²¡ç”¨çš„ã€‚å¦‚æœä¸æƒ³æ‰“çˆ† CPUï¼Œå¯ä»¥è°ƒä½ã€‚ä½†æ˜¯ä¼šæœ‰æ›´å¤šè¯·æ±‚åœ¨æ’é˜Ÿã€‚ä¸šåŠ¡ä¼šå“åº”å˜æ…¢ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618803646,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1960963,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoXoqDLvF3l8OzIwDBVlbgZ2FtbPFoncicFjQPqMFkKqdG5BnRVIxxrN40zUhTkynsd6yLhqqYiblAQ/132","nickname":"ä»»å›½å®","note":"","ucode":"FE47D8DB5FA4C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308301,"discussion_content":"æŠŠå®šæ—¶ä»»åŠ¡æ‰“æ•£ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å‚è€ƒé™æµç®—æ³•ï¼Œå®šæ—¶ä»»åŠ¡å¯åŠ¨åï¼ŒæŒ‰ç…§è®¾å®šçš„é€Ÿç‡æ‰§è¡Œå‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600911408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2092079,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/ec/2f/a8745999.jpg","nickname":"å°è·","note":"","ucode":"A1EF42B4C39F81","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298331,"discussion_content":"åŒé—®åƒè·‘å®šæ—¶ä»»åŠ¡é€ æˆçš„èµ„æºé£™å‡æœ‰ä»€ä¹ˆå¥½çš„ä¼˜åŒ–æ‰‹æ®µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597247136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118540,"user_name":"ITæ©˜å­","can_delete":false,"product_type":"c1","uid":1066932,"ip_address":"","ucode":"1DBEE96BAF8B0B","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/b4/e8b3f53f.jpg","comment_is_top":false,"comment_ctime":1564383811,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859351107","product_id":100020801,"comment_content":"è€å¸ˆï¼Œå½“innodbå¹¶å‘çº¿ç¨‹æ•°è¿‡å¤šå¯¼è‡´çš„ç³»ç»Ÿä¸å¯ç”¨é—®é¢˜ï¼Œè¿›è¡Œä¸»å¤‡åˆ‡æ¢åé—®é¢˜å°±å¯ä»¥è§£å†³å—ï¼Ÿå¤‡åº“ä¸Šçš„innodbå¹¶å‘çº¿ç¨‹ä¼šä¸ä¼šä¹Ÿåœ¨ä¸€æ®µæ—¶é—´ä¹‹åä¹Ÿè¾¾åˆ°é˜ˆå€¼å‘¢ï¼Ÿ<br>","like_count":1},{"had_liked":false,"id":66288,"user_name":"alias cd=rm -rf","can_delete":false,"product_type":"c1","uid":1318325,"ip_address":"","ucode":"E7B27D76305B75","user_header":"https://static001.geekbang.org/account/avatar/00/14/1d/b5/971261fd.jpg","comment_is_top":false,"comment_ctime":1549904739,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5844872035","product_id":100020801,"comment_content":"1ã€åˆ¤æ–­è¿›ç¨‹æ˜¯å¦å¯ç”¨ï¼špingçš„æ–¹æ¡ˆï¼ˆç±»ä¼¼select 1ï¼‰<br>2ã€æ ¹æ®ä¸šåŠ¡çš„éœ€æ±‚ä¸€èˆ¬ä¼šè®¾ç½®ä¸€ä¸ªé˜ˆå€¼ä»¥åŠç­–ç•¥ï¼ˆå¦‚ï¼šå•ä½æ—¶é—´å¤±è´¥çš„æ¬¡æ•°ï¼Œå“åº”æ—¶é—´è¶…è¿‡å¤šå°‘é˜ˆå€¼ï¼‰å¦‚ä½•è¿›è¡Œç†”æ–­ã€æ‰©å®¹ç­‰æ–¹æ¡ˆã€‚","like_count":1},{"had_liked":false,"id":354847,"user_name":"åˆ˜é‡‘ç”Ÿ","can_delete":false,"product_type":"c1","uid":1191973,"ip_address":"æ±Ÿè‹","ucode":"3388B5D8BF9355","user_header":"https://static001.geekbang.org/account/avatar/00/12/30/25/178759a2.jpg","comment_is_top":false,"comment_ctime":1660818350,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660818350","product_id":100020801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œé—®ä¸‹æœ€è¿‘çº¿ä¸Šç¯å¢ƒå‡ºç°waiting for table flushå¯¼è‡´è¿æ¥æ± æ»¡äº†ï¼Œç„¶åä¹Ÿæ²¡å‘ç°å¤ªå¤šæ…¢sqlï¼Œè¯·é—®æ˜¯å’‹å›äº‹","like_count":0},{"had_liked":false,"id":319750,"user_name":"wuxbeyond","can_delete":false,"product_type":"c1","uid":1318668,"ip_address":"","ucode":"F665896CF1DC3D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/fC4DvPtDPjJjWsMkrRTk4oC9aXnmH7PfBpL3YXichibuib7BXmqteiaQ09jWb7jOFPI5omZCXSmicnmoKXiacYZhqibxg/132","comment_is_top":false,"comment_ctime":1635928387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1635928387","product_id":100020801,"comment_content":"proxysql å¯ä»¥æ ¹æ®å»¶æ—¶åˆ¤æ–­èµ° ä¸»åº“ è¿˜æ˜¯ä»åº“ã€‚","like_count":0},{"had_liked":false,"id":315159,"user_name":"å®™æ–¯","can_delete":false,"product_type":"c1","uid":2041396,"ip_address":"","ucode":"80DF36BAD298AD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/26/34/891dd45b.jpg","comment_is_top":false,"comment_ctime":1633711163,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1633711163","product_id":100020801,"comment_content":"ä¸šåŠ¡å±‚é¢é€šè¿‡å†…ç½®å¿ƒè·³æ£€æŸ¥åœ°å€ï¼Œè‹¥OKè¯´æ˜è¯·æ±‚èƒ½æ­£å¸¸è¢«å¤„ç†ï¼Œè¯·æ±‚å¤„ç†è€—æ—¶æ˜¯æ­£å¸¸çš„","like_count":0},{"had_liked":false,"id":304365,"user_name":"zhangm365","can_delete":false,"product_type":"c1","uid":1657561,"ip_address":"","ucode":"60E7DEFB3F5840","user_header":"https://static001.geekbang.org/account/avatar/00/19/4a/d9/b8046b4b.jpg","comment_is_top":false,"comment_ctime":1627373482,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1627373482","product_id":100020801,"comment_content":"ä¸¤ä¸ªåŸºæœ¬çš„ç–‘é—®ï¼š<br>1. ä¸ºä»€ä¹ˆä¸€å¼€å§‹çš„ä¾‹å­ä¸­ï¼šäº‹åŠ¡1å¤„ç†ç©ºé—²æ—¶ï¼Œä¸ç®—å¹¶å‘çº¿ç¨‹å•Šï¼Ÿ<br>2. select 1 æ–¹æ³•ä¸æ˜¯æ£€æŸ¥å‡ºåº“å‡ºé—®é¢˜äº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜æœ‰ç”¨çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":301168,"user_name":"å†²å†²å†²","can_delete":false,"product_type":"c1","uid":2676330,"ip_address":"","ucode":"4DA7596B5AFD51","user_header":"https://static001.geekbang.org/account/avatar/00/28/d6/6a/1d844a27.jpg","comment_is_top":false,"comment_ctime":1625561912,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625561912","product_id":100020801,"comment_content":"è€å¸ˆæˆ‘æœ‰ä¸ªé—®é¢˜<br>å°±æ˜¯æ›´æ–°åˆ¤æ–­ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ—¶é—´æˆ³çš„ï¼Œä¸»å¤‡åŒæ­¥ï¼Œå› ä¸ºå¤‡åº“ä¼šæŠŠbinlogå‘é€ç»™ä¸»åº“ï¼Œå¯èƒ½ä¼šå‡ºç°åŒä¸€è¡Œæ”¹åŠ¨ï¼Œå°±ä¼šå‘ç”Ÿè¡Œå†²çªï¼Œè¿™ä¸ªæ—¶å€™ç­‰é”ç»“æŸä¸è¡Œå—ï¼Ÿï¼Œå°±ç›´æ¥æŠŠä¸»å¤‡åŒæ­¥åœæ­¢äº†å—","like_count":0},{"had_liked":false,"id":286201,"user_name":"promoter","can_delete":false,"product_type":"c1","uid":1252990,"ip_address":"","ucode":"46C320FCD65F04","user_header":"https://static001.geekbang.org/account/avatar/00/13/1e/7e/a4c4bcd0.jpg","comment_is_top":false,"comment_ctime":1617188370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617188370","product_id":100020801,"comment_content":"è¯·æ•™ä¸€ä¸ªä¸¥é‡é—®é¢˜ æ“ä½œç³»ç»Ÿå¼‚å¸¸é‡å¯ æœ‰å¾ˆå¤§æ¦‚ç‡å¯¼è‡´MySQLè¡¨è¢«æŸå æ€æ ·é¿å…è¿™ç§é—®é¢˜ æˆ–è€…æ€ä¹ˆå¿«é€Ÿè¿›è¡Œè‡ªåŠ¨ä¿®å¤ã€‚","like_count":0},{"had_liked":false,"id":286085,"user_name":"å¨å¸ˆå¼ ","can_delete":false,"product_type":"c1","uid":1485677,"ip_address":"","ucode":"90BDAC2AC1CC88","user_header":"https://static001.geekbang.org/account/avatar/00/16/ab/6d/d5d44dac.jpg","comment_is_top":false,"comment_ctime":1617153928,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617153928","product_id":100020801,"comment_content":"å¦‚ä½•åˆ¤æ–­ä¸»åº“ä¸å¯ç”¨çš„å‰ææ˜¯ä¸»åº“ä¸å¯ç”¨çš„å®šä¹‰ä»€ä¹ˆï¼Ÿæ˜¯çº¯ç«™åœ¨dbaçš„è§’åº¦è€ƒè™‘è¿˜æ˜¯æ¶‰åŠåˆ°ä¸šåŠ¡ä¸Šçš„è€ƒè™‘ã€‚æ–‡ä¸­ä¸¾çš„å¹¶å‘è¿æ¥æ•°è¾¾åˆ°ä¸Šé™å’Œé”ç­‰å¾…è¶…æ—¶çš„ä¾‹å­å¹¶ä¸æ°å½“ã€‚ç±»ä¼¼çš„é—®é¢˜åº”è¯¥å±äºä¸šåŠ¡çš„èŒƒç•´å‘ç°äº†ï¼Œéœ€è¦ä¸šåŠ¡å»æ”¹é€ ä¼˜åŒ–ã€‚å¦å¤–dbçš„æ€§èƒ½ä¸æœåŠ¡å™¨çš„ç›‘æ§æ˜¯é‡è¦ä¸€ç¯æ–‡ä¸­å¹¶æ²¡æœ‰è¿‡å¤šæåŠï¼Œç£ç›˜ç©ºé—´ä½¿ç”¨ç‡éƒ½å·²ç»100%æ‰å»å¤„ç†ï¼ŒæŠ¥è­¦æ—©å°±è¯¥æŠ¥å‡ºæ¥äº†ï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­ä¹Ÿä¸æ˜¯å¾ˆæ°å½“","like_count":0},{"had_liked":false,"id":259478,"user_name":"ç‹¼çš„è¯±æƒ‘","can_delete":false,"product_type":"c1","uid":1257043,"ip_address":"","ucode":"AE89DFC5963C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/2e/53/bf62683f.jpg","comment_is_top":false,"comment_ctime":1604735275,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604735275","product_id":100020801,"comment_content":"è€å¸ˆè¯·æ•™ä¸¤ä¸ªé—®é¢˜ï¼š<br>1ã€æ•°æ®åº“TPSå‹æµ‹ä¸Šä¸å»ï¼š<br>æ•°æ®åº“é…ç½® 56æ ¸128G è¿æ¥æ•°1000 <br>åº”ç”¨æœåŠ¡é…ç½® 4æ ¸8G  å…±24å°å®ä¾‹<br>è¿æ¥æ± ä½¿ç”¨Duridæœ€æ–°ç‰ˆæœ¬ 1.2.1 <br>æ¯å°åº”ç”¨çš„é“¾æ¥æ± é…ç½®ï¼š<br>sharding.druid.initialSize=12<br>sharding.druid.maxActive=24<br>sharding.druid.minIdle=12<br>sharding.druid.removeAbandoned=false<br>sharding.druid.useUnfairLock=true<br><br>æ•°æ®åº“ä¸»è¦æ˜¯ä¸¤ä¸ªè¡¨åŒæ—¶æ’å…¥ï¼Œæ¯ä¸ªè¡¨åˆ†ä¸º100å¼ è¡¨ï¼Œä¸»è¡¨ä¸­æœ‰ä¸€ä¸ªå”¯ä¸€ç´¢å¼•<br>å‹æµ‹<br>2å°å‹æµ‹æœºï¼Œä¸€å°500å¼€å¯500çº¿ç¨‹ï¼Œå…±1000å¹¶å‘<br>ç»“æœï¼š<br>TPSï¼š6000å·¦å³<br>æ•°æ®åº“æ˜¾ç¤ºæ— å‹åŠ›ï¼Œä½†åº”ç”¨çš„è¿æ¥æ± ä¼šçˆ†æ»¡ï¼Œä½†è°ƒå¤§é“¾æ¥æ± çš„æœ€å¤§é“¾æ¥ä¸º36æ—¶ï¼ŒTPSå¹¶ä¸ä¼šæå‡<br>ä¸çŸ¥é“æ˜¯å·²ç»åˆ°äº†åº”ç”¨çš„æœ€å¤§æ€§èƒ½ï¼Œè¿˜æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Ÿ<br><br>2ã€åŸºäºé—®é¢˜1è€ƒè™‘ï¼Œè¿›è¡Œäº†åˆ†åº“åˆ†è¡¨ï¼Œç®—æ³•é—®é¢˜ï¼š<br>æ”¯ä»˜è¡¨ä¸­æœ‰userIdã€orderNoã€tradeNo å…¶ä¸­orderNoå’ŒtradeNoæ‹¼æ¥çš„éƒ½æ˜¯userIdçš„åä¸¤ä½ï¼Œ<br>ä¸šåŠ¡åˆ†åˆ«ä¼šæ ¹æ®orderNoï¼ŒtradeNoï¼ŒuserIdè¿›è¡ŒæŸ¥è¯¢ã€‚ ç›®å‰æ˜¯ä¸€ä¸ªåº“åˆ†äº†ä¸€ç™¾å¼ è¡¨ï¼Œç°åœ¨å¸Œæœ›åˆ†æˆ4ä¸ªåº“æ¯ä¸ªåº“ä¸€ç™¾å¼ è¡¨ã€‚<br>ç›®å‰çœ‹åä¸¤ä½å†æ€ä¹ˆå†™ç®—æ³•ä¹Ÿåªèƒ½æ˜¯0-99 è¿™100ä¸ªæ•°ï¼Œå¦‚ä½•åˆ†æ•£åˆ°å››ä¸ªåº“æ¯ä¸ªåº“100å¼ è¡¨å‘¢ï¼Ÿæˆ–æ˜¯æœ‰å…¶ä»–çš„è§£å†³æ€è·¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":259476,"user_name":"ç‹¼çš„è¯±æƒ‘","can_delete":false,"product_type":"c1","uid":1257043,"ip_address":"","ucode":"AE89DFC5963C42","user_header":"https://static001.geekbang.org/account/avatar/00/13/2e/53/bf62683f.jpg","comment_is_top":false,"comment_ctime":1604735061,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604735061","product_id":100020801,"comment_content":"è€å¸ˆè¯·æ•™ä¸¤ä¸ªé—®é¢˜ï¼š<br>1ã€æ•°æ®åº“TPSå‹æµ‹ï¼š<br>æ•°æ®åº“é…ç½® 56æ ¸128G è¿æ¥æ•°1000 <br>æ•°æ®åº“åˆ†ä¸º100ä¸ªè¡¨<br>åº”ç”¨æœåŠ¡é…ç½® 4æ ¸8G  å…±24å°å®ä¾‹<br>è¿æ¥æ± ä½¿ç”¨Duridæœ€æ–°ç‰ˆæœ¬ 1.2.1 <br>æ¯å°åº”ç”¨çš„é“¾æ¥æ± é…ç½®ï¼š<br>sharding.druid.initialSize=12<br>sharding.druid.maxActive=24<br>sharding.druid.minIdle=12<br>sharding.druid.removeAbandoned=false<br>sharding.druid.useUnfairLock=true<br>æ•°æ®åº“ä¸»è¦æ˜¯ä¸¤ä¸ªè¡¨ï¼Œæ¯ä¸ªè¡¨åˆ†ä¸º100å¼ è¡¨ï¼Œä¸»è¡¨ä¸­æœ‰ä¸€ä¸ªå”¯ä¸€ç´¢å¼•<br><br>å‹æµ‹<br>2å°å‹æµ‹æœºï¼Œå…±1000å¹¶å‘<br>ç»“æœï¼š<br>TPSï¼š6000å·¦å³<br>æ•°æ®åº“æ˜¾ç¤ºæ— å‹åŠ›ï¼Œä½†åº”ç”¨çš„è¿æ¥æ± ä¼šçˆ†æ»¡ï¼Œä½†è°ƒå¤§é“¾æ¥æ± çš„æœ€å¤§é“¾æ¥ä¸º36æ—¶ï¼ŒTPSå¹¶ä¸ä¼šæå‡<br><br>ä¸çŸ¥é“æ˜¯å·²ç»åˆ°äº†åº”ç”¨çš„æœ€å¤§æ€§èƒ½ï¼Œè¿˜æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Ÿ<br><br>2ã€åŸºäºä»¥ä¸Šçš„é—®é¢˜è¿›è¡Œäº†åˆ†åº“åˆ†è¡¨ï¼Œç®—æ³•é—®é¢˜ï¼š<br>æ”¯ä»˜è¡¨ä¸­æœ‰userIdã€orderNoã€tradeNo å…¶ä¸­orderNoå’ŒtradeNoæ‹¼æ¥çš„éƒ½æ˜¯userIdçš„åä¸¤ä½ï¼Œ<br>ä¸šåŠ¡åˆ†åˆ«ä¼šæ ¹æ®orderNoï¼ŒtradeNoï¼ŒuserIdè¿›è¡ŒæŸ¥è¯¢ã€‚ ç›®å‰æ˜¯ä¸€ä¸ªåº“åˆ†äº†ä¸€ç™¾å¼ è¡¨ï¼Œç°åœ¨å¸Œæœ›åˆ†æˆ4ä¸ªåº“æ¯ä¸ªåº“ä¸€ç™¾å¼ è¡¨ã€‚<br>ç›®å‰çœ‹åä¸¤ä½å†æ€ä¹ˆå†™ç®—æ³•ä¹Ÿåªèƒ½æ˜¯0-99 è¿™100ä¸ªæ•°ï¼Œå¦‚ä½•åˆ†æ•£åˆ°å››ä¸ªåº“æ¯ä¸ªåº“100å¼ è¡¨å‘¢ï¼Ÿæˆ–æ˜¯æœ‰å…¶ä»–çš„è§£å†³æ€è·¯å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":254294,"user_name":"ç´«æ—¥","can_delete":false,"product_type":"c1","uid":1207410,"ip_address":"","ucode":"73A8DEE323AC19","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqXSb2jAzlMM0JdTjWrNiaq2uR9eeloBYp906POddb9evmuj5f4CUoO6ge8TibibwtZicnl1sRHic9rW7g/132","comment_is_top":false,"comment_ctime":1603096815,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1603096815","product_id":100020801,"comment_content":"åˆ¤æ–­æ•°æ®æ˜¯å¦å‡ºé—®é¢˜æ–¹å¼å¾ˆå¤šï¼Œselect 1 ä¸€äº›æƒ…å†µæ—¶æ— æ•ˆçš„ï¼Œè¦æƒ³æœ‰æ•ˆå°±æ¶‰åŠæ›´å¤šæ•°æ®åº“èµ„æºï¼Œæ•°æ®åº“å¾ˆæ…¢æ—¶ï¼Œï¼Œè¿™ä¸ªéªŒè¯ä¹Ÿå¾ˆæ…¢ï¼Œæœ‰æ²¡æœ‰ä¸€èˆ¬ç®€å•æœ‰æ•ˆçš„æ–¹æ³•å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":247404,"user_name":"lobby","can_delete":false,"product_type":"c1","uid":1181960,"ip_address":"","ucode":"8D81722BE36AD4","user_header":"https://static001.geekbang.org/account/avatar/00/12/09/08/f3547e77.jpg","comment_is_top":false,"comment_ctime":1599702542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1599702542","product_id":100020801,"comment_content":"çœ‹åˆ°è€å¸ˆè¯´ï¼Œinnodb_thread_concurrencyå»ºè®®è®¾ç½®ä¸ºæ ¸æ•°çš„2å€å·¦å³ä¸ºå¥½ï¼Œæƒ³åˆ°nettyçš„workgroupæ•°é‡é»˜è®¤è®¾ç½®ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œæ„Ÿå—åˆ°çŸ¥è¯†æ˜¯ç›¸åŒçš„","like_count":0},{"had_liked":false,"id":245046,"user_name":"nofrish","can_delete":false,"product_type":"c1","uid":1111037,"ip_address":"","ucode":"8A5A47FE242891","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/fd/ca3a1b4a.jpg","comment_is_top":false,"comment_ctime":1598794250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1598794250","product_id":100020801,"comment_content":"å…³äºä¸šåŠ¡ç›‘æ§çš„é—®é¢˜ï¼Œæˆ‘åœ¨è‡ªå·±çš„çŸ¥ä¹é‡Œå†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œæ¨èä¸€ä¸‹ï¼šhttps:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;27437421<br><br>è¯·è€å¸ˆå¸®æˆ‘ç½®é¡¶~ ","like_count":0},{"had_liked":false,"id":242791,"user_name":"å®¶ç¦","can_delete":false,"product_type":"c1","uid":1948238,"ip_address":"","ucode":"19699FE6751EF0","user_header":"https://static001.geekbang.org/account/avatar/00/1d/ba/4e/0e3604d3.jpg","comment_is_top":false,"comment_ctime":1597842416,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597842416","product_id":100020801,"comment_content":"å¦‚æœç”¨æ›´æ–°æ¥æ£€æµ‹ä¸»åº“çš„è¯ï¼Œé‚£ä¹ˆå¤‡åº“ä¹Ÿè¦è¿›è¡Œæ›´æ–°æ£€æµ‹ã€‚ä½†ï¼Œå¤‡åº“çš„æ£€æµ‹ä¹Ÿæ˜¯è¦å†™ binlog çš„ã€‚ç”±äºæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠæ•°æ®åº“ A å’Œ B çš„ä¸»å¤‡å…³ç³»è®¾è®¡ä¸ºåŒ M ç»“æ„ï¼Œæ‰€ä»¥åœ¨å¤‡åº“ B ä¸Šæ‰§è¡Œçš„æ£€æµ‹å‘½ä»¤ï¼Œä¹Ÿè¦å‘å›ç»™ä¸»åº“ Aã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸»åº“ A å’Œå¤‡åº“ B éƒ½ç”¨ç›¸åŒçš„æ›´æ–°å‘½ä»¤ï¼Œå°±å¯èƒ½å‡ºç°è¡Œå†²çªï¼Œä¹Ÿå°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢ã€‚<br>è¿™ä¸€æ®µä¸æ˜¯é‚£ä¹ˆç†è§£ï¼Œå¤‡åº“ B ä¸Šæ‰§è¡Œçš„æ£€æµ‹å‘½ä»¤å‘ç»™ä¸»åº“Aæ˜¯ä»€ä¹ˆå‘½ä»¤ï¼Ÿ     éƒ½æœ‰ç›¸åŒçš„æ›´æ–°å‘½ä»¤ä¸ºä»€ä¹ˆå‡ºç°è¡Œå†²çªï¼Ÿ","like_count":0},{"had_liked":false,"id":240711,"user_name":"å¯†çš„","can_delete":false,"product_type":"c1","uid":1356304,"ip_address":"","ucode":"D1A3E9962C7715","user_header":"","comment_is_top":false,"comment_ctime":1597043216,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1597043216","product_id":100020801,"comment_content":"æœ‰ä¸ªç–‘é—®ï¼Œæ±‚è§£æƒ‘ï¼Œæ–‡ç« ä¸­æœ‰2ä¸ªåœ°æ–¹æ˜¯è¿™æ ·å†™çš„ï¼š<br>â€œMySQL è¿™æ ·è®¾è®¡æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ã€‚å› ä¸ºï¼Œè¿›å…¥é”ç­‰å¾…çš„çº¿ç¨‹å·²ç»ä¸åƒ CPU äº†â€<br>â€œç”±äºæ‰€æœ‰çº¿ç¨‹éƒ½å¤„äºç­‰å¾…çŠ¶æ€ï¼Œæ­¤æ—¶å ç”¨çš„ CPU å´æ˜¯ 0â€<br>å½“MYSQLçš„çº¿ç¨‹å¤„äºé”ç­‰å¾…çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¼šå¯¹CPUé€ æˆå ç”¨çš„å§ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1621432,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/WxLKJlXCibwqO92vB8XTicLQiahrhuUEqP7yT9dearZxLzbia7oMdsLmon5J4LJyTfIWchHY3bKfibm1lS1aZarZs4Q/132","nickname":"jie","note":"","ucode":"E93A1818AB2459","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575480,"discussion_content":"æ˜¯ä¸æ˜¯sleepäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654863190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239333,"user_name":"walleæ–Œ","can_delete":false,"product_type":"c1","uid":1062848,"ip_address":"","ucode":"0DB3243004951F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","comment_is_top":false,"comment_ctime":1596505309,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596505309","product_id":100020801,"comment_content":"å‰å¹´çš„æ—¶å€™spring bootè¿˜æ˜¯1.xï¼Œé»˜è®¤æ³¨å†Œä¸­å¿ƒæ˜¯eurekaï¼Œå½“æ—¶å°±é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œeurekaç»Ÿè®¡æŸä¸ªå¾®æœåŠ¡æ˜¯å¦æ´»ç€çš„æ ‡è®°æ˜¯å„ä¸ªå¾®æœåŠ¡æ˜¯å¦åœ¨ä¸€å®šæ—¶é—´å†…ä¸ŠæŠ¥è‡ªå·±çš„çŠ¶æ€ï¼Œå½“æ—¶é‡åˆ°å¾®æœåŠ¡çš„bugï¼Œå…¶å®æ˜¯ç”±äºdbå…¨è¢«hangä½ï¼Œæ‹–å¾—æœåŠ¡ä¹Ÿè¢«hangä½ï¼Œå…¶å®å·²ç»ä¸å¯ç”¨ï¼Œä½†æ˜¯ç”¨è¿‡eurekaçš„çŸ¥é“ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸ŠæŠ¥è‡ªå·±çš„çŠ¶æ€ï¼Œæ˜¯å†…éƒ¨èµ·äº†ä¸€ä¸ªçº¿ç¨‹ä¸ŠæŠ¥ï¼Œæ‰€ä»¥ä»eurekaçœ‹å¯ç”¨ï¼Œä½†æ˜¯å®é™…å·²ç»ä¸å¯ç”¨äº†ã€‚<br>å½“æ—¶åšçš„æ”¹è¿›ï¼Œç¬¬ä¸€åŠ æœåŠ¡çš„å¿ƒè·³å¥åº·æ£€æŸ¥ï¼Œç¬¬äºŒï¼Œå½“æ—¶1.Xä½“ç³»ï¼Œå¯¹äºå†…åµŒçš„tomcatç›‘æ§ä¸åˆ°ä½ï¼Œæ‰€ä»¥é¢å¤–åŠ å…¥äº†tomcatçš„ç›‘æ§ï¼Œé‡ç‚¹ç›‘æ§çš„å°±æ˜¯ï¼Œæ ¸å¿ƒçº¿ç¨‹æ± ï¼Œé˜»å¡é˜Ÿåˆ—é•¿åº¦ï¼Œè¯·æ³¨æ„tomcatçº¿ç¨‹æ± ä¸jdkçš„çº¿ç¨‹æ± æœ‰æ‰€åŒºåˆ«ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°è¶³å¤Ÿçœ‹æ˜ç™½é—®é¢˜äº†ã€‚<br>å½“ç„¶ç°åœ¨spring bootå‡çº§åˆ°2.xä»¥åçš„actuator ç›‘æ§è¶³å¤Ÿäº†ï¼Œä¸åƒä¹‹å‰é‚£ä¹ˆå°´å°¬äº†ã€‚","like_count":0},{"had_liked":false,"id":236378,"user_name":"mgs2002","can_delete":false,"product_type":"c1","uid":1812970,"ip_address":"","ucode":"F5931108BD509B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","comment_is_top":false,"comment_ctime":1595404143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595404143","product_id":100020801,"comment_content":"æˆ‘æ‰€åœ¨çš„å…¬å¸æ˜¯è¿™æ ·çš„:<br>1. æ¯ä¸ªä¸ªé¡¹ç›®æä¾›ä¸€ä¸ªå¥åº·ç›‘æµ‹æ¥å£ï¼Œè¿”å›å›ºå®šçš„å€¼ï¼Œé¡¹ç›®ä¸Šçº¿åä¼šå®šæ—¶è°ƒç”¨è¯¥æ¥å£ï¼Œå¦‚æœæ— å“åº”æˆ–è€…è¶…æ—¶å°±è¯´æ˜æœ‰é—®é¢˜ã€‚<br>2. é¡¹ç›®æ—¥å¿—é‡Œé¢åˆ†æ‹†ä¸€ä¸ªæ¥å£æ€§èƒ½æ—¥å¿—ï¼Œç»Ÿè®¡å‡ºæ¥å£å“åº”è¶…è¿‡è®¾ç½®çš„å“åº”æ—¶é—´é˜€å€¼ï¼ˆæ¯”å¦‚500msï¼‰ï¼Œå®šæœŸå»çœ‹è¿™ä¸ªæ—¥å¿—ï¼Œç„¶åè¿›è¡Œä¼˜åŒ–","like_count":0},{"had_liked":false,"id":235847,"user_name":"hhhh","can_delete":false,"product_type":"c1","uid":1256101,"ip_address":"","ucode":"9E87017424B382","user_header":"https://static001.geekbang.org/account/avatar/00/13/2a/a5/625c0a2e.jpg","comment_is_top":false,"comment_ctime":1595221063,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1595221063","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œè´Ÿè´£mysql ä¸»å¤‡åˆ‡æ¢çš„è¿™ç§haç³»ç»Ÿï¼Œå„ä¸ªå…¬å¸éƒ½æ˜¯è‡ªå·±å†™çš„å—ï¼Œè¿˜æ˜¯æœ‰å¤§å®¶éƒ½åœ¨ç”¨çš„å¼€æºè§£å†³æ–¹æ¡ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1301833,"avatar":"https://static001.geekbang.org/account/avatar/00/13/dd/49/2a24dc77.jpg","nickname":"çŸ³æ™“åšÂ²â°Â¹9","note":"","ucode":"38F92A9275E4B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359495,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616209848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233166,"user_name":"slark","can_delete":false,"product_type":"c1","uid":1143574,"ip_address":"","ucode":"7E8DE962AA23A7","user_header":"https://static001.geekbang.org/account/avatar/00/11/73/16/595b0342.jpg","comment_is_top":false,"comment_ctime":1594254794,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594254794","product_id":100020801,"comment_content":"CPUã€å†…å­˜ã€Threads_runningã€å½“å‰æ‰“å¼€çš„è¿æ¥æ•°ï¼Œå¹³æ—¥é‡Œæ›´å…³æ³¨è¿™å‡ ä¸ª<br>è¿™ä¸ªinnodb_thread_concurrencyæ˜¯ä¸æ˜¯æ²¡å‰é¢çš„æ›´å®¹æ˜“ä½“ç°é—®é¢˜","like_count":0},{"had_liked":false,"id":218617,"user_name":"æ˜ŸæœŸå…«","can_delete":false,"product_type":"c1","uid":1440429,"ip_address":"","ucode":"D8C66E7F61B0D1","user_header":"https://static001.geekbang.org/account/avatar/00/15/fa/ad/3fa02ac7.jpg","comment_is_top":false,"comment_ctime":1589846368,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589846368","product_id":100020801,"comment_content":"æŸ¥è¯¢<br>æ›´æ–°<br>å†…éƒ¨ç»Ÿè®¡","like_count":0},{"had_liked":false,"id":203245,"user_name":"æµ®ç”Ÿé†‰","can_delete":false,"product_type":"c1","uid":1783354,"ip_address":"","ucode":"7549E41BD65511","user_header":"https://static001.geekbang.org/account/avatar/00/1b/36/3a/335db90a.jpg","comment_is_top":false,"comment_ctime":1586160190,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586160190","product_id":100020801,"comment_content":"å‡è®¾ï¼Œè¿™æ¡è¯­å¥åœ¨ä¸»åº“ä¸Šè¦æ‰§è¡Œ 10 åˆ†é’Ÿï¼Œæäº¤åä¼ åˆ°å¤‡åº“å°±è¦ 10 åˆ†é’Ÿï¼ˆå…¸å‹çš„å¤§äº‹åŠ¡ï¼‰ã€‚é‚£ä¹ˆï¼Œåœ¨ä¸»åº“ DDL ä¹‹åå†æäº¤çš„äº‹åŠ¡çš„ GTIDï¼Œå»å¤‡åº“æŸ¥çš„æ—¶å€™ï¼Œå°±ä¼šç­‰ 10 åˆ†é’Ÿæ‰å‡ºç°ã€‚<br><br>æœ‰ä¸ªç–‘é—®<br>é‚£10minæ˜¯ç­‰DDLæ‰§è¡Œå®Œï¼Œå¹¶å†™å®Œbinlogå¯ä»¥å‘é€åˆ°ä»åº“ï¼ŒæœŸé—´å…¶ä»–æ›´æ–°SQLåœ¨ä¸»åº“ä¸æ˜¯ä¹Ÿå¯ä»¥æ­£å¸¸æ‰§è¡Œå—ï¼Œé‚£ç›¸å…³çš„æ“ä½œä¸æ˜¯ä¹Ÿèƒ½å†™å…¥binlog,ä¸ºä»€ä¹ˆä¸èƒ½å‘é€ç»™ä»åº“æ‰§è¡Œå•Š","like_count":0},{"had_liked":false,"id":199805,"user_name":"é£é›ªå¤œå½’äºº","can_delete":false,"product_type":"c1","uid":1583347,"ip_address":"","ucode":"40B4C6DB4351EB","user_header":"https://static001.geekbang.org/account/avatar/00/18/28/f3/103b5bec.jpg","comment_is_top":false,"comment_ctime":1585496202,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585496202","product_id":100020801,"comment_content":"æ‰“å¡æ‰“å¡","like_count":0},{"had_liked":false,"id":191670,"user_name":"æ˜æ­Œ","can_delete":false,"product_type":"c1","uid":1445986,"ip_address":"","ucode":"2E91A2203052B6","user_header":"https://static001.geekbang.org/account/avatar/00/16/10/62/335856f7.jpg","comment_is_top":false,"comment_ctime":1584788934,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584788934","product_id":100020801,"comment_content":"è¯·é—®è€å¸ˆï¼Œå¯¹äºåº”ç”¨ç«¯æ•°æ®åº“è¿æ¥æ± è®¾ç½®çš„è¿æ¥æ•°åº”è¯¥æ€ä¹ˆè¡¡é‡ï¼Ÿæ˜¯å¦åº”è¯¥ä¸ºæ•°æ®åº“æœåŠ¡å™¨cpuæ ¸æ•°çš„2å€ï¼Ÿ","like_count":0},{"had_liked":false,"id":171647,"user_name":"88591","can_delete":false,"product_type":"c1","uid":1254656,"ip_address":"","ucode":"04CE3E46455185","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/00/3afbab43.jpg","comment_is_top":false,"comment_ctime":1578986022,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578986022","product_id":100020801,"comment_content":"åˆ†å¸ƒå¼æœåŠ¡ä¸€èˆ¬ä¸ç½‘ç»œæœ‰å…³ï¼Œå¯ä»¥åœ¨ç½‘ç»œåè®®ä¸åŒå±‚æ¬¡æ¥åˆ¤æ–­ï¼Œæ¯”å¦‚ ping ï¼Œtelnet , curl, ã€‚å¦‚æœè¿˜è¦æ›´å‡†ç¡®ï¼Œå°±æµ‹è¯•æœåŠ¡å™¨å†…éƒ¨æ‰§è¡Œé€»è¾‘æ˜¯å¦okã€‚","like_count":0},{"had_liked":false,"id":125038,"user_name":"çˆ±å› è¯—è´¤","can_delete":false,"product_type":"c1","uid":1528379,"ip_address":"","ucode":"150C439B87CED1","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/3b/7a2610a6.jpg","comment_is_top":false,"comment_ctime":1566049960,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566049960","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘æŠŠmysql5.5å‡çº§åˆ°mysql8.0å¯¼è‡´å¤§é‡è¯­æ³•æŠ¥é”™ï¼Œè¯·é—®æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•","like_count":0},{"had_liked":false,"id":120488,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1564911447,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564911447","product_id":100020801,"comment_content":"ç›‘æ§ç³»ç»Ÿç›‘æ§ï¼Œè¾¾åˆ°ä¸€å®šæ¡ä»¶ä¹Ÿä¼šè§¦å‘æŠ¥è­¦ï¼Œæ¯”å¦‚ï¼šæ…¢SQLçš„ä¿¡æ¯ï¼Œç£ç›˜ç©ºé—´çš„ä¿¡æ¯ã€‚<br>è¿™äº›éƒ½æ˜¯å…¬å¸åŸºç¡€æ¶æ„éƒ¨åšçš„ï¼Œå–å¾—ä¿¡æ¯ä¼°è®¡å’Œè€å¸ˆè®²çš„ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¸»è¦æŠ¥è­¦ä¿¡æ¯å°±è¡Œã€‚","like_count":0},{"had_liked":false,"id":112359,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1562723243,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562723243","product_id":100020801,"comment_content":"åŸæ–‡ï¼š<br>å¦‚æœå¤„äºé”ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹è®¡æ•°ã€ä¸ã€å‡ä¸€ï¼ŒInnoDB å°±ä¼šè®¤ä¸ºçº¿ç¨‹æ•°ç”¨æ»¡äº†ï¼Œä¼šé˜»æ­¢å…¶ä»–è¯­å¥è¿›å…¥å¼•æ“æ‰§è¡Œï¼Œè¿™æ ·çº¿ç¨‹ 1 ä¸èƒ½æäº¤äº‹åŠ¡ã€‚<br><br>åº”è¯¥æ˜¯ï¼šå¦‚æœå¤„äºé”ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹è®¡æ•°å‡ä¸€ï¼Ÿ","like_count":0},{"had_liked":false,"id":106756,"user_name":"æ˜¯æˆ‘çš„æµ·","can_delete":false,"product_type":"c1","uid":1197457,"ip_address":"","ucode":"4BCE240829676A","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/91/afda3094.jpg","comment_is_top":false,"comment_ctime":1561383995,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1561383995","product_id":100020801,"comment_content":"æƒ³é—®ä¸‹è€å¸ˆä¹‹å‰è®²çš„ç¬¬ä¸ƒç« é‚£ä¸ªæ­»é”æ£€æµ‹çš„æ¡ˆä¾‹ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®äº†å¹¶å‘çº¿ç¨‹æ•°ï¼Œæ˜¯ä¸æ˜¯å°±ä¸ä¼šå‡ºç°çƒ­ç‚¹æ›´æ–°ä¸€è¡Œæ­»é”çš„æƒ…å†µï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":175804,"discussion_content":"è¯¥æœ‰è¿˜æ˜¯ä¼šæœ‰çš„å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581995893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":105819,"user_name":"å†¥ç‹æ˜Ÿ","can_delete":false,"product_type":"c1","uid":1311603,"ip_address":"","ucode":"CA43C381A69736","user_header":"https://static001.geekbang.org/account/avatar/00/14/03/73/38397da1.jpg","comment_is_top":false,"comment_ctime":1561088078,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1561088078","product_id":100020801,"comment_content":"ä½¿ç”¨å•è¡Œæ•°æ®çš„updateæ“ä½œæ¥è¿›è¡Œæ•°æ®åº“çš„å¥åº·æ£€æŸ¥çš„æ—¶å€™ï¼Œéš¾é“è¯´ä¸»å¤‡åº“ä¹‹é—´ä¸èƒ½ä½¿ç”¨GTIDæœºåˆ¶æ”¾ç½®æ›´æ–°æ“ä½œçš„å†²çªä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1065351,"avatar":"https://static001.geekbang.org/account/avatar/00/10/41/87/d26efb2e.jpg","nickname":"SuperSnow","note":"","ucode":"84C89AA8083E6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":175809,"discussion_content":"è¿™ç§æ˜¯ä¸»å¤‡åŒæ—¶æ“ä½œå†™å…¥binlogçš„ï¼Œè¦æ±‚éƒ½æ£€æµ‹ï¼Œæ€ä¹ˆç”¨gtidå‘¢ï¼Œä¸€ä¸ªä¸å†™ï¼Ÿé‚£å°±æ˜¯æ„å‘³ç€ä¸€æ–¹ä¸æ£€æµ‹äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581996058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":104363,"user_name":"è‹¦è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1055334,"ip_address":"","ucode":"726024A9A9CF44","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","comment_is_top":false,"comment_ctime":1560737411,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560737411","product_id":100020801,"comment_content":"ä¿®æ”¹å¤§è¡¨ç»“æ„ä¼šç›´æ¥å¯¼è‡´ä¸å¯ç”¨ ","like_count":0},{"had_liked":false,"id":85715,"user_name":"ä¹”çº³æ£®","can_delete":false,"product_type":"c1","uid":1045107,"ip_address":"","ucode":"51EC9FAE071388","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/73/1c7bceae.jpg","comment_is_top":false,"comment_ctime":1555210723,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555210723","product_id":100020801,"comment_content":"æˆ‘çš„mysqlç‰ˆæœ¬æ˜¯percona 5.7.24-27","like_count":0},{"had_liked":false,"id":85709,"user_name":"ä¹”çº³æ£®","can_delete":false,"product_type":"c1","uid":1045107,"ip_address":"","ucode":"51EC9FAE071388","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/73/1c7bceae.jpg","comment_is_top":false,"comment_ctime":1555209020,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1555209020","product_id":100020801,"comment_content":"è€å¸ˆï¼Œè¯·æ•™æ‚¨ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ç°åœ¨é‡åˆ°ä¸€ä¸ªçº¿ä¸ŠMySQLæ— æ³•å»ºè¿çš„æƒ…å†µï¼š<br>1. tcpå»ºè¿åï¼Œæ²¡æœ‰æŠŠæ•°æ®åŒ…ä¸Šäº¤ç»™mysql, æŠ“åŒ…å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰syn åŒ…ï¼Œæ²¡æœ‰å‘å®¢æˆ·ç«¯è¦å¯†ç ã€‚<br>2. strace å»ºè¿è¿‡ç¨‹å¯ä»¥çœ‹åˆ°ï¼Œmysqlå·²ç»åˆ†é…çº¿ç¨‹äº†ï¼Œä½†ä¹‹åå°±æ²¡æ¶ˆæ¯<br>3. å½“ç„¶mysql æœ‰5000+çš„çº¿ç¨‹æ•°ï¼Œå¼‚å¸¸ä¹‹å‰æŠ¥è¿‡too many connections, ç»è¿‡ä¸€å¤œï¼Œè¿æ¥è‚¯å®šè¢«å…³é—­äº†ï¼Œnetstatå¯ä»¥çœ‹åˆ°500+ close_wait è¿æ¥ï¼Œæ— establishedè¿æ¥<br>4. <br>è¯·é—®ä½ æœ‰ä»€ä¹ˆæ€è·¯å—ï¼Ÿå·²ç»æ˜¯3æœˆä»¥æ¥ï¼Œç¬¬ä¸‰æ¬¡å‡ºç°äº†ã€‚","like_count":0},{"had_liked":false,"id":81596,"user_name":"ä¸“æ ç”¨æˆ·","can_delete":false,"product_type":"c1","uid":1212492,"ip_address":"","ucode":"621C14A2BE0443","user_header":"https://static001.geekbang.org/account/avatar/00/12/80/4c/a0043823.jpg","comment_is_top":false,"comment_ctime":1553957695,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553957695","product_id":100020801,"comment_content":"æˆ‘æ˜¯åˆå…¥é—¨çš„å¼€å‘ï¼ˆå½“ç„¶ä¹Ÿä¸æ˜¯DBAï¼‰ï¼Œé‡åˆ°è¿‡ä¸€æ¬¡selectæ²¡é—®é¢˜ä½†updateæœ‰é—®é¢˜çš„æƒ…å†µï¼Œå½“æ—¶å°±æ˜¯ä¸¤çœ¼ä¸€æ‘¸é»‘ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":61783,"user_name":"å°æ©™æ©™","can_delete":false,"product_type":"c1","uid":1054923,"ip_address":"","ucode":"4F467210A15F66","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/cb/edb5a0a0.jpg","comment_is_top":false,"comment_ctime":1547799225,"is_pvip":false,"replies":[{"id":"21920","content":"ï¼Ÿè¿™ä¸¤ä¸ªä¸æ˜¯ä¸€è‡´çš„å—<br><br>æ„æ€å°±æ˜¯ä½ è¦upateçš„è¯­å¥æ‰¾ä¸åˆ°å‘€<br>ä½ æŠŠupdateæ”¹æˆselectï¼Œå…ˆç¡®å®šä¸€ä¸‹æ˜¯ä¸æ˜¯èƒ½çœ‹åˆ°ä½ è¦æ›´æ–°çš„æ•°æ®ï¼ˆæ ¹æ®ä½ è¿™ä¸ªæè¿°ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547803028,"ip_address":"","comment_id":61783,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547799225","product_id":100020801,"comment_content":"è€å¸ˆï¼Œæˆ‘å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œjavaå®¢æˆ·ç«¯æ‰§è¡ŒæŸ¥è¯¢è¯­å¥æŠ¥é”™ï¼šResultSet is from UPDATE. No Dataã€‚ç”¨navicatæ‰§è¡Œç›¸åŒè¯­å¥ï¼Œå¾ˆå¿«å°±æŸ¥è¯¢ç»“æŸï¼Œä½†æ˜¯æ²¡æœ‰ç»“æœæ˜¾ç¤ºã€‚è¯·é—®å¯èƒ½ä»€ä¹ˆé—®é¢˜é€ æˆçš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436993,"discussion_content":"ï¼Ÿè¿™ä¸¤ä¸ªä¸æ˜¯ä¸€è‡´çš„å—\n\næ„æ€å°±æ˜¯ä½ è¦upateçš„è¯­å¥æ‰¾ä¸åˆ°å‘€\nä½ æŠŠupdateæ”¹æˆselectï¼Œå…ˆç¡®å®šä¸€ä¸‹æ˜¯ä¸æ˜¯èƒ½çœ‹åˆ°ä½ è¦æ›´æ–°çš„æ•°æ®ï¼ˆæ ¹æ®ä½ è¿™ä¸ªæè¿°ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547803028,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61773,"user_name":"ä¸ƒä¸ƒ","can_delete":false,"product_type":"c1","uid":1301937,"ip_address":"","ucode":"277BACE2330C54","user_header":"https://static001.geekbang.org/account/avatar/00/13/dd/b1/7323beb9.jpg","comment_is_top":false,"comment_ctime":1547797505,"is_pvip":true,"replies":[{"id":"21918","content":"æœ‰çš„ï¼Œ æ•¬è¯·æœŸå¾…<br><br>ä¸è¿‡buffer poolå†…éƒ¨ç»†èŠ‚å¾ˆå¤šï¼Œåªèƒ½æŒ‘å¤§å®¶ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šç”¨åˆ°çš„çŸ¥è¯†ç‚¹æ¥è®²å“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547802926,"ip_address":"","comment_id":61773,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547797505","product_id":100020801,"comment_content":"å¯ä»¥å¤§è‡´ä»DBç›‘æ§å›¾ä¸Šåˆ¤æ–­ä¸šåŠ¡æœ‰æ²¡æœ‰é—®é¢˜ï¼š<br>QPS&#47;è¿æ¥æ•°&#47;æ…¢æŸ¥è¯¢&#47;æŸ¥è¯¢å“åº”æ—¶é—´(query_response_timeæ’ä»¶)ç­‰........<br><br>è€å¸ˆè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼š <br>ç‰©ç†æœºå™¨æ˜¯128Gå†…å­˜ï¼ŒDBå®ä¾‹æ•°æ®é‡æ˜¯1.2Tï¼Œç£ç›˜æ˜¯pcie ssd<br>ä¸šåŠ¡æŸ¥è¯¢åœºæ™¯æ˜¯ç®€å•çš„select * from table where id in (1,2,3....);<br>å®ä¾‹QPSåœ¨1000ä»¥ä¸‹æ—¶,æ•°æ®åº“çœ‹ä¸Šå»ä¸€åˆ‡æ­£å¸¸<br>å½“QPSå¤§äº2000+æ—¶, %utilæŒç»­90+, r&#47;sæŒç»­2Wå·¦å³, rMB&#47;sæŒç»­600+, ä¼´éšç€è¿æ¥æ•°&#47;æ…¢æŸ¥è¯¢ç­‰æŠ¥è­¦<br>è¿™ä¸ªæ—¶å€™è¿™ä¸ªæ•°æ®åº“å®ä¾‹å¯ä»¥è¯´æ˜¯å‡ºé—®é¢˜äº†å§ï¼Œè¿™ç±»é—®é¢˜è¯¥æ€ä¹ˆæ’æŸ¥æ ¹å› å‘¢ï¼Ÿ<br>æ˜¯ç”±äºbuffer poolä¸ç£ç›˜å¤§é‡æ¢å…¥æ¢å‡ºå†·æ•°æ®å¯¼è‡´çš„å—ï¼Œæœ‰ç›¸å…³çš„çŠ¶æ€å€¼ç›‘æ§é¡¹å¯ä»¥æŸ¥å—ï¼Ÿ<br><br>innodb buffer poolæ˜¯mysqlå¾ˆé‡è¦çš„ä¸€ä¸ªæ¨¡å—ï¼Œè€å¸ˆåé¢æœ‰å•ç‹¬çš„ç« èŠ‚æ¥è§£æƒ‘å—ï¼ŒæœŸå¾… ï¼ï¼","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436987,"discussion_content":"æœ‰çš„ï¼Œ æ•¬è¯·æœŸå¾…\n\nä¸è¿‡buffer poolå†…éƒ¨ç»†èŠ‚å¾ˆå¤šï¼Œåªèƒ½æŒ‘å¤§å®¶ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šç”¨åˆ°çš„çŸ¥è¯†ç‚¹æ¥è®²å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547802926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":61670,"user_name":"çˆ¸çˆ¸å›æ¥äº†","can_delete":false,"product_type":"c1","uid":1305016,"ip_address":"","ucode":"30B8C927C04D66","user_header":"","comment_is_top":false,"comment_ctime":1547771424,"is_pvip":false,"replies":[{"id":"21896","content":"è·Ÿselect 1 å±äºä¸€ç±»","user_name":"ä½œè€…å›å¤","user_name_real":"æ—æ™“æ–Œ","uid":"1264162","ctime":1547782371,"ip_address":"","comment_id":61670,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1547771424","product_id":100020801,"comment_content":"ä¹‹å‰ä¹Ÿç”¨select 1ã€‚åæ¥å‘ç°ï¼Œç¡¬ç›˜æ„å¤–å¡æ»¡æ—¶ï¼Œæœ¬åœ°é“¾æ¥å¾ˆæœ‰å¯èƒ½è¶…æ—¶å¯¼è‡´åˆ¤æ–­å¤±è´¥ã€‚<br>æƒ³é—®é—®è€å¸ˆï¼Œmysqladmin pingè¿™ä¸ªæœºåˆ¶ç”¨æ¥åˆ¤æ–­å¦‚ä½•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1264162,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4a/22/2681d602.jpg","nickname":"æ—æ™“æ–Œ","note":"","ucode":"CDE42D44F26240","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":436946,"discussion_content":"è·Ÿselect 1 å±äºä¸€ç±»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1547782371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}