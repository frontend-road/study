{"id":132412,"title":"41ä¸¨åˆè¯†Redisï¼šRedisä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå¿«ï¼Ÿ","content":"<p>ä¹‹å‰æˆ‘ä»¬è®²è§£äº†ä¸€äº›RDBMSçš„ä½¿ç”¨ï¼Œæ¯”å¦‚MySQLã€Oracleã€SQL Serverå’ŒSQLiteç­‰ï¼Œå®é™…ä¸Šåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šæ¥è§¦åˆ°ä¸€äº›NoSQLç±»å‹çš„æ•°æ®åº“ã€‚å¦‚æœå¯¹æ¯”RDBMSå’ŒNoSQLæ•°æ®åº“ï¼Œä½ ä¼šå‘ç°RDBMSå»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šï¼Œå¼ºè°ƒæ•°æ®çš„ä¸€è‡´æ€§å’Œå„ç§çº¦æŸæ¡ä»¶ï¼Œè€ŒNoSQLçš„è§„åˆ™æ˜¯â€œåªæä¾›ä½ æƒ³è¦çš„â€ï¼Œæ•°æ®æ¨¡å‹çµæ´»ï¼ŒæŸ¥è¯¢æ•ˆç‡é«˜ï¼Œæˆæœ¬ä½ã€‚ä½†åŒæ—¶ï¼Œç›¸æ¯”RDBMSï¼ŒNoSQLæ•°æ®åº“æ²¡æœ‰ç»Ÿä¸€çš„æ¶æ„å’Œæ ‡å‡†è¯­è¨€ï¼Œæ¯ç§æ•°æ®åº“ä¹‹é—´å·®å¼‚è¾ƒå¤§ï¼Œå„æœ‰æ‰€é•¿ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬è¦è®²è§£çš„Rediså±äºé”®å€¼ï¼ˆkey-valueï¼‰æ•°æ®åº“ï¼Œé”®å€¼æ•°æ®åº“ä¼šä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨é”®å€¼å’Œæ•°æ®ï¼Œå…¶ä¸­keyä½œä¸ºå”¯ä¸€çš„æ ‡è¯†ï¼Œè€Œä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»ä½•çš„å†…å®¹ï¼Œä¸è®ºæ˜¯ç®€å•çš„å¯¹è±¡è¿˜æ˜¯å¤æ‚çš„å¯¹è±¡éƒ½å¯ä»¥å­˜å‚¨ã€‚é”®å€¼æ•°æ®åº“çš„æŸ¥è¯¢æ€§èƒ½é«˜ï¼Œæ˜“äºæ‰©å±•ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥äº†è§£ä¸‹Redisï¼Œå…·ä½“çš„å†…å®¹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol>\n<li>Redisæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä½¿ç”¨Redisä¼šéå¸¸å¿«ï¼Ÿ</li>\n<li>Redisæ”¯æŒçš„æ•°æ®ç±»å‹éƒ½æœ‰å“ªäº›ï¼Ÿ</li>\n<li>å¦‚ä½•é€šè¿‡Pythonå’ŒRedisè¿›è¡Œäº¤äº’ï¼Ÿ</li>\n</ol><h2>Redisæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h2><p>Rediså…¨ç§°æ˜¯REmote DIctionary Serverï¼Œä»åå­—ä¸­ä½ ä¹Ÿèƒ½çœ‹å‡ºæ¥å®ƒç”¨å­—å…¸ç»“æ„å­˜å‚¨æ•°æ®ï¼Œä¹Ÿå°±æ˜¯key-valueç±»å‹çš„æ•°æ®ã€‚</p><!-- [[[read_end]]] --><p>Redisçš„æŸ¥è¯¢æ•ˆç‡éå¸¸é«˜ï¼Œæ ¹æ®å®˜æ–¹æä¾›çš„æ•°æ®ï¼ŒRedisæ¯ç§’æœ€å¤šå¤„ç†çš„è¯·æ±‚å¯ä»¥è¾¾åˆ°10ä¸‡æ¬¡ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«å‘¢ï¼Ÿ</p><p>Redisé‡‡ç”¨ANSI Cè¯­è¨€ç¼–å†™ï¼Œå®ƒå’ŒSQLiteä¸€æ ·ã€‚é‡‡ç”¨Cè¯­è¨€è¿›è¡Œç¼–å†™çš„å¥½å¤„æ˜¯åº•å±‚ä»£ç æ‰§è¡Œæ•ˆç‡é«˜ï¼Œä¾èµ–æ€§ä½ï¼Œå› ä¸ºä½¿ç”¨Cè¯­è¨€å¼€å‘çš„åº“æ²¡æœ‰å¤ªå¤šè¿è¡Œæ—¶ï¼ˆRuntimeï¼‰ä¾èµ–ï¼Œè€Œä¸”ç³»ç»Ÿçš„å…¼å®¹æ€§å¥½ï¼Œç¨³å®šæ€§é«˜ã€‚</p><p>æ­¤å¤–ï¼ŒRedisæ˜¯åŸºäºå†…å­˜çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬ä¹‹å‰è®²åˆ°è¿‡ï¼Œè¿™æ ·å¯ä»¥é¿å…ç£ç›˜I/Oï¼Œå› æ­¤Redisä¹Ÿè¢«ç§°ä¸ºç¼“å­˜å·¥å…·ã€‚</p><p>å…¶æ¬¡ï¼Œæ•°æ®ç»“æ„ç»“æ„ç®€å•ï¼ŒRedisé‡‡ç”¨Key-Valueæ–¹å¼è¿›è¡Œå­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨Hashç»“æ„è¿›è¡Œæ“ä½œï¼Œæ•°æ®çš„æ“ä½œå¤æ‚åº¦ä¸ºO(1)ã€‚</p><p>ä½†Rediså¿«çš„åŸå› è¿˜ä¸æ­¢è¿™äº›ï¼Œå®ƒé‡‡ç”¨å•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å‹ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯é¿å…äº†ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œä¸å¿…è¦çš„çº¿ç¨‹ä¹‹é—´å¼•èµ·çš„èµ„æºç«äº‰ã€‚</p><p>åœ¨æŠ€æœ¯ä¸ŠRedisè¿˜é‡‡ç”¨äº†å¤šè·¯I/Oå¤ç”¨æŠ€æœ¯ã€‚è¿™é‡Œçš„å¤šè·¯æŒ‡çš„æ˜¯å¤šä¸ªsocketç½‘ç»œè¿æ¥ï¼Œå¤ç”¨æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚é‡‡ç”¨å¤šè·¯I/Oå¤ç”¨æŠ€æœ¯çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†å¤šä¸ªI/Oè¯·æ±‚ï¼Œå°½é‡å‡å°‘ç½‘ç»œI/Oçš„æ¶ˆè€—ï¼Œæå‡ä½¿ç”¨æ•ˆç‡ã€‚</p><h2>Redisçš„æ•°æ®ç±»å‹</h2><p>ç›¸æ¯”Memcachedï¼ŒRedisæœ‰ä¸€ä¸ªéå¸¸å¤§çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯æ”¯æŒå¤šç§æ•°æ®ç±»å‹ã€‚Redisæ”¯æŒçš„æ•°æ®ç±»å‹åŒ…æ‹¬å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆç­‰ã€‚</p><p>å­—ç¬¦ä¸²ç±»å‹æ˜¯Redisæä¾›çš„æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå¯¹åº”çš„ç»“æ„æ˜¯key-valueã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è®¾ç½®æŸä¸ªé”®çš„å€¼ï¼Œä½¿ç”¨æ–¹æ³•ä¸º<code>set key value</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦ç»™nameè¿™ä¸ªé”®è®¾ç½®å€¼ä¸ºzhangfeiï¼Œå¯ä»¥å†™æˆ<code>set name zhangfei</code>ã€‚å¦‚æœæƒ³è¦å–æŸä¸ªé”®çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>get key</code>ï¼Œæ¯”å¦‚æƒ³å–nameçš„å€¼ï¼Œå†™æˆget nameå³å¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/55/30/554243f80e4029e82ffd60c4b0303030.png?wh=866*209\" alt=\"\"><br>\nå“ˆå¸Œï¼ˆhashï¼‰æä¾›äº†å­—æ®µå’Œå­—æ®µå€¼çš„æ˜ å°„ï¼Œå¯¹åº”çš„ç»“æ„æ˜¯key-field-valueã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è®¾ç½®æŸä¸ªé”®çš„å“ˆå¸Œå€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>hset key field value</code>ï¼Œå¦‚æœæƒ³è¦ç»™user1è®¾ç½®usernameä¸ºzhangfeiï¼Œageä¸º28ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>hset user1 username zhangfei\nhset user1 age 28\n</code></pre><p>å¦‚æœæˆ‘ä»¬æƒ³è¦åŒæ—¶å°†å¤šä¸ªfield-valueè®¾ç½®ç»™æŸä¸ªé”®keyçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨<code>hmset key field value [field value...]</code>ï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªå¯ä»¥å†™æˆï¼š</p><pre><code>Hmset user1 username zhangfei age 28\n\n</code></pre><p>å¦‚æœæƒ³è¦å–æŸä¸ªé”®çš„æŸä¸ªfieldå­—æ®µå€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>hget key field</code>ï¼Œæ¯”å¦‚æƒ³è¦å–user1çš„usernameï¼Œé‚£ä¹ˆå†™æˆ<code>hget user1 username</code>å³å¯ã€‚</p><p>å¦‚æœæƒ³è¦ä¸€æ¬¡è·å–æŸä¸ªé”®çš„å¤šä¸ªfieldå­—æ®µå€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>hmget key field[field...]</code>ï¼Œæ¯”å¦‚æƒ³è¦å–user1çš„usernameå’Œageï¼Œå¯ä»¥å†™æˆ<code>hmget user1 username age</code>ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4a/3c/4aac95f8536f67f97f1c913a3633aa3c.png?wh=1122*306\" alt=\"\"><br>\nå­—ç¬¦ä¸²åˆ—è¡¨ï¼ˆlistï¼‰çš„åº•å±‚æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘åˆ—è¡¨çš„ä¸¤ç«¯æ·»åŠ å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(1)ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–åˆ—è¡¨ä¸­çš„æŸä¸ªç‰‡æ®µã€‚</p><p>å¦‚æœæƒ³è¦å‘åˆ—è¡¨å·¦ä¾§å¢åŠ å…ƒç´ å¯ä»¥ä½¿ç”¨ï¼š<code>LPUSH key value [...]</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»™heroListåˆ—è¡¨å‘å·¦ä¾§æ·»åŠ zhangfeiã€guanyuå’Œliubeiè¿™ä¸‰ä¸ªå…ƒç´ ï¼Œå¯ä»¥å†™æˆï¼š</p><pre><code>LPUSH heroList zhangfei guanyu liubei\n</code></pre><p>åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>RPUSH key value [...]</code>å‘åˆ—è¡¨å³ä¾§æ·»åŠ å…ƒç´ ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»™heroListåˆ—è¡¨å‘å³ä¾§æ·»åŠ dianweiã€lvbuè¿™ä¸¤ä¸ªå…ƒç´ ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>RPUSH heroList dianwei lvbu\n\n</code></pre><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–åˆ—è¡¨ä¸­æŸä¸€ç‰‡æ®µçš„å†…å®¹ï¼Œä½¿ç”¨<code>LRANGE key start stop</code>å³å¯ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦è·å–heroListä»0åˆ°4ä½ç½®çš„æ•°æ®ï¼Œå†™æˆ<code>LRANGE heroList 0 4</code>å³å¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/d8/26/d87d2a6b0f858b0a5c88aa4417707a26.png?wh=1366*506\" alt=\"\"><br>\nå­—ç¬¦ä¸²é›†åˆï¼ˆsetï¼‰æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ— åºé›†åˆï¼Œä¸åˆ—è¡¨ï¼ˆlistï¼‰çš„åŒºåˆ«åœ¨äºé›†åˆä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ï¼ŒåŒæ—¶å…ƒç´ ä¸èƒ½é‡å¤ã€‚</p><p>å¦‚æœæƒ³è¦åœ¨é›†åˆä¸­æ·»åŠ å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>SADD key member [...]</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»™heroSeté›†åˆæ·»åŠ zhangfeiã€guanyuã€liubeiã€dianweiå’Œlvbuè¿™äº”ä¸ªå…ƒç´ ï¼Œå¯ä»¥å†™æˆï¼š</p><pre><code>SADD heroSet zhangfei guanyu liubei dianwei lvbu\n</code></pre><p>å¦‚æœæƒ³è¦åœ¨é›†åˆä¸­åˆ é™¤æŸå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>SREM key member [...]</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬ä»heroSeté›†åˆä¸­åˆ é™¤liubeiå’Œlvbuè¿™ä¸¤ä¸ªå…ƒç´ ï¼Œå¯ä»¥å†™æˆï¼š</p><pre><code>SREM heroSet liubei lvbu\n</code></pre><p>å¦‚æœæƒ³è¦è·å–é›†åˆä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>SMEMBERS key</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦è·å–heroSeté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå†™æˆ<code>SMEMBERS heroSet</code>å³å¯ã€‚</p><p>å¦‚æœæƒ³è¦åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>SISMEMBER key member</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦åˆ¤æ–­heroSeté›†åˆä¸­æ˜¯å¦å­˜åœ¨zhangfeiå’Œliubeiï¼Œå°±å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>SISMEMBER heroSet zhangfei\nSISMEMBER heroSet liubei\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/e6/0f/e69e7249b48194e0f76a8f351287390f.png?wh=1613*606\" alt=\"\"><br>\næˆ‘ä»¬å¯ä»¥æŠŠæœ‰åºå­—ç¬¦ä¸²é›†åˆï¼ˆSortedSetï¼Œç®€ç§°ZSETï¼‰ç†è§£æˆé›†åˆçš„å‡çº§ç‰ˆã€‚å®é™…ä¸ŠZSETæ˜¯åœ¨é›†åˆçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ªåˆ†æ•°å±æ€§ï¼Œè¿™ä¸ªå±æ€§åœ¨æ·»åŠ ä¿®æ”¹å…ƒç´ çš„æ—¶å€™å¯ä»¥è¢«æŒ‡å®šã€‚æ¯æ¬¡æŒ‡å®šåï¼ŒZSETéƒ½ä¼šæŒ‰ç…§åˆ†æ•°æ¥è¿›è¡Œè‡ªåŠ¨æ’åºï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨ç»™é›†åˆkeyæ·»åŠ memberçš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šscoreã€‚</p><p>æœ‰åºé›†åˆä¸åˆ—è¡¨æœ‰ä¸€å®šçš„ç›¸ä¼¼æ€§ï¼Œæ¯”å¦‚è¿™ä¸¤ç§æ•°æ®ç±»å‹éƒ½æ˜¯æœ‰åºçš„ï¼Œéƒ½å¯ä»¥è·å¾—æŸä¸€èŒƒå›´çš„å…ƒç´ ã€‚ä½†å®ƒä¿©åœ¨æ•°æ®ç»“æ„ä¸Šæœ‰å¾ˆå¤§çš„ä¸åŒï¼Œé¦–å…ˆåˆ—è¡¨listæ˜¯é€šè¿‡åŒå‘é“¾è¡¨å®ç°çš„ï¼Œåœ¨æ“ä½œå·¦å³ä¸¤ä¾§çš„æ•°æ®æ—¶ä¼šéå¸¸å¿«ï¼Œè€Œå¯¹äºä¸­é—´çš„æ•°æ®æ“ä½œåˆ™ç›¸å¯¹è¾ƒæ…¢ã€‚æœ‰åºé›†åˆé‡‡ç”¨hashè¡¨çš„ç»“æ„æ¥å®ç°ï¼Œè¯»å–æ’åºåœ¨ä¸­é—´éƒ¨åˆ†çš„æ•°æ®ä¹Ÿä¼šå¾ˆå¿«ã€‚åŒæ—¶æœ‰åºé›†åˆå¯ä»¥é€šè¿‡scoreæ¥å®Œæˆå…ƒç´ ä½ç½®çš„è°ƒæ•´ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹åˆ—è¡¨è¿›è¡Œå…ƒç´ ä½ç½®çš„è°ƒæ•´åˆ™ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨æœ‰åºé›†åˆä¸­æ·»åŠ å…ƒç´ å’Œåˆ†æ•°ï¼Œä½¿ç”¨<code>ZADD key score member [...]</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»™heroScoreé›†åˆæ·»åŠ ä¸‹é¢5ä¸ªè‹±é›„çš„hp_maxæ•°å€¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/2b/54/2b8db8619d37452b4608e8dbe91cba54.png?wh=530*320\" alt=\"\"><br>\né‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>ZADD heroScore 8341 zhangfei 7107 guanyu 6900 liubei 7516 dianwei 7344 lvbu\n</code></pre><p>å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–æŸä¸ªå…ƒç´ çš„åˆ†æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>ZSCORE key member</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦è·å–guanyuçš„åˆ†æ•°ï¼Œå†™æˆ<code>ZSCORE heroScore guanyu</code>å³å¯ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³è¦åˆ é™¤ä¸€ä¸ªæˆ–å¤šå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ZREM key member [member ...]ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦åˆ é™¤guanyuè¿™ä¸ªå…ƒç´ ï¼Œä½¿ç”¨<code>ZREM heroScore guanyu</code>å³å¯ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–æŸä¸ªèŒƒå›´çš„å…ƒç´ åˆ—è¡¨ã€‚å¦‚æœæƒ³è¦åˆ†æ•°ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œä½¿ç”¨<code>ZRANGE key start stop [WITHSCORES]</code>ï¼Œå¦‚æœåˆ†æ•°ä»å¤§åˆ°å°è¿›è¡Œæ’åºï¼Œä½¿ç”¨<code>ZREVRANGE key start stop [WITHSCORES]</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒWITHSCORESæ˜¯ä¸ªå¯é€‰é¡¹ï¼Œå¦‚æœä½¿ç”¨WITHSCORESä¼šå°†åˆ†æ•°ä¸€åŒæ˜¾ç¤ºå‡ºæ¥ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢heroScoreè¿™ä¸ªæœ‰åºé›†åˆä¸­åˆ†æ•°æ’åå‰3çš„è‹±é›„åŠæ•°å€¼ï¼Œå†™æˆ<code>ZREVRANGE heroScore 0 2 WITHSCORES</code>å³å¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/10/85/106083c4b4872fadb6b91f46b3e74485.png?wh=1729*617\" alt=\"\"><br>\né™¤äº†è¿™5ç§æ•°æ®ç±»å‹ä»¥å¤–ï¼ŒRedisè¿˜æ”¯æŒä½å›¾ï¼ˆBitmapsï¼‰æ•°æ®ç»“æ„ï¼Œåœ¨2.8ç‰ˆæœ¬ä¹‹åï¼Œå¢åŠ äº†åŸºæ•°ç»Ÿè®¡ï¼ˆHyperLogLogï¼‰ï¼Œ3.2ç‰ˆæœ¬ä¹‹ååŠ å…¥äº†åœ°ç†ç©ºé—´ï¼ˆGeospatialï¼‰ä»¥åŠç´¢å¼•åŠå¾„æŸ¥è¯¢çš„åŠŸèƒ½ï¼Œåœ¨5.0ç‰ˆæœ¬å¼•ç”¨äº†æ•°æ®æµï¼ˆStreamsï¼‰æ•°æ®ç±»å‹ã€‚</p><h2>å¦‚ä½•ä½¿ç”¨Redis</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨Pythonä¸­ç›´æ¥æ“ä½œRedisï¼Œåœ¨ä½¿ç”¨å‰éœ€è¦ä½¿ç”¨<code>pip install redis</code>å®‰è£…å·¥å…·åŒ…ï¼Œå®‰è£…å¥½ä¹‹åï¼Œåœ¨ä½¿ç”¨å‰æˆ‘ä»¬éœ€è¦ä½¿ç”¨import redisè¿›è¡Œå¼•ç”¨ã€‚</p><p>åœ¨Pythonä¸­æä¾›äº†ä¸¤ç§è¿æ¥Redisçš„æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯ç›´æ¥è¿æ¥ï¼Œä½¿ç”¨ä¸‹é¢è¿™è¡Œå‘½ä»¤å³å¯ã€‚</p><pre><code>r = redis.Redis(host='localhost', port= 6379)\n</code></pre><p>ç¬¬äºŒç§æ˜¯è¿æ¥æ± æ–¹å¼ã€‚</p><pre><code>pool = redis.ConnectionPool(host='localhost', port=6379)\nr = redis.Redis(connection_pool=pool)\n</code></pre><p>ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œè¿™ä¸¤ç§è¿æ¥æ–¹å¼æœ‰ä»€ä¹ˆä¸åŒï¼Ÿç›´æ¥è¿æ¥å¯èƒ½ä¼šè€—è´¹æ‰å¾ˆå¤šèµ„æºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨è¿æ¥Redisçš„æ—¶å€™ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªRedisè¿æ¥ï¼Œé€šè¿‡å®ƒæ¥å®ŒæˆRedisæ“ä½œï¼Œå®Œæˆä¹‹åå†é‡Šæ”¾æ‰ã€‚ä½†æ˜¯åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·åšéå¸¸ä¸ç»æµï¼Œå› ä¸ºæ¯æ¬¡è¿æ¥å’Œé‡Šæ”¾éƒ½éœ€è¦æ¶ˆè€—éå¸¸å¤šçš„èµ„æºã€‚</p><h3>ä¸ºä»€ä¹ˆé‡‡ç”¨è¿æ¥æ± æœºåˆ¶</h3><p>åŸºäºç›´æ¥è¿æ¥çš„å¼Šç«¯ï¼ŒRedisæä¾›äº†è¿æ¥æ± çš„æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶å¯ä»¥è®©æˆ‘ä»¬äº‹å…ˆåˆ›å»ºå¥½å¤šä¸ªè¿æ¥ï¼Œå°†å…¶æ”¾åˆ°è¿æ¥æ± ä¸­ï¼Œå½“æˆ‘ä»¬éœ€è¦è¿›è¡ŒRedisæ“ä½œçš„æ—¶å€™å°±ç›´æ¥ä»è¿æ¥æ± ä¸­è·å–ï¼Œå®Œæˆä¹‹åä¹Ÿä¸ä¼šç›´æ¥é‡Šæ”¾æ‰è¿æ¥ï¼Œè€Œæ˜¯å°†å®ƒè¿”å›åˆ°è¿æ¥æ± ä¸­ã€‚</p><p>è¿æ¥æ± æœºåˆ¶å¯ä»¥é¿å…é¢‘ç¹åˆ›å»ºå’Œé‡Šæ”¾è¿æ¥ï¼Œæå‡æ•´ä½“çš„æ€§èƒ½ã€‚</p><h3>è¿æ¥æ± æœºåˆ¶çš„åŸç†</h3><p>åœ¨è¿æ¥æ± çš„å®ä¾‹ä¸­ä¼šæœ‰ä¸¤ä¸ªlistï¼Œä¿å­˜çš„æ˜¯<code>_available_connections</code>å’Œ<code>_in_use_connections</code>ï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨è¿æ¥æ± ä¸­å¯ä»¥ä½¿ç”¨çš„è¿æ¥é›†åˆå’Œæ­£åœ¨ä½¿ç”¨çš„è¿æ¥é›†åˆã€‚å½“æˆ‘ä»¬æƒ³è¦åˆ›å»ºè¿æ¥çš„æ—¶å€™ï¼Œå¯ä»¥ä»<code>_available_connections</code>ä¸­è·å–ä¸€ä¸ªè¿æ¥è¿›è¡Œä½¿ç”¨ï¼Œå¹¶å°†å…¶æ”¾åˆ°<code>_in_use_connections</code>ä¸­ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨çš„è¿æ¥ï¼Œæ‰ä¼šåˆ›å»ºä¸€ä¸ªæ–°è¿æ¥ï¼Œå†å°†å…¶æ”¾åˆ°<code>_in_use_connections</code>ä¸­ã€‚å¦‚æœè¿æ¥ä½¿ç”¨å®Œæ¯•ï¼Œä¼šä»<code>_in_use_connections</code>ä¸­åˆ é™¤ï¼Œæ·»åŠ åˆ°<code>_available_connections</code>ä¸­ï¼Œä¾›åç»­ä½¿ç”¨ã€‚</p><p>Redisåº“æä¾›äº†Rediså’ŒStrictRedisç±»ï¼Œå®ƒä»¬éƒ½å¯ä»¥å®ç°Rediså‘½ä»¤ï¼Œä¸åŒä¹‹å¤„åœ¨äºRedisæ˜¯StrictRedisçš„å­ç±»ï¼Œå¯ä»¥å¯¹æ—§ç‰ˆæœ¬è¿›è¡Œå…¼å®¹ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨è¿æ¥æ± æœºåˆ¶ï¼Œç„¶åç”¨StrictRedisè¿›è¡Œå®ä¾‹åŒ–ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>import redis \npool = redis.ConnectionPool(host='localhost', port=6379)\nr = redis.StrictRedis(connection_pool=pool)\n</code></pre><h3>å®éªŒï¼šä½¿ç”¨Pythonç»Ÿè®¡Redisè¿›è¡Œ1ä¸‡æ¬¡å†™è¯·æ±‚å’Œ1ä¸‡æ¬¡è¯»è¯·æ±‚çš„æ—¶é—´</h3><p>äº†è§£äº†å¦‚ä½•ä½¿ç”¨Pythonåˆ›å»ºRedisè¿æ¥ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹æ€æ ·ä½¿ç”¨Pythonå¯¹Redisè¿›è¡Œæ•°æ®çš„å†™å…¥å’Œè¯»å–ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨HMSETå‡½æ•°åŒæ—¶å°†å¤šä¸ª<code>field-value</code>å€¼å­˜å…¥åˆ°é”®ä¸­ã€‚æ¨¡æ‹Ÿ1ä¸‡æ¬¡çš„å†™è¯·æ±‚é‡Œï¼Œè®¾ç½®äº†ä¸åŒçš„keyï¼Œå’Œç›¸åŒçš„<code>field-value</code>å€¼ï¼Œç„¶ååœ¨1ä¸‡æ¬¡è¯»è¯·æ±‚ä¸­ï¼Œå°†è¿™äº›ä¸åŒçš„keyä¸­ä¿å­˜çš„<code>field-value</code>å€¼è¯»å–å‡ºæ¥ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>import redis\nimport time\n# åˆ›å»ºredisè¿æ¥\npool = redis.ConnectionPool(host='localhost', port=6379)\nr = redis.StrictRedis(connection_pool=pool)\n# è®°å½•å½“å‰æ—¶é—´\ntime1 = time.time()\n# 1ä¸‡æ¬¡å†™\nfor i in range(10000):\n    data = {'username': 'zhangfei', 'age':28}\n    r.hmset(&quot;users&quot;+str(i), data)\n# ç»Ÿè®¡å†™æ—¶é—´\ndelta_time = time.time()-time1\nprint(delta_time)\n# ç»Ÿè®¡å½“å‰æ—¶é—´\ntime1 = time.time()\n# 1ä¸‡æ¬¡è¯»\nfor i in range(10000):\n    result = r.hmget(&quot;users&quot;+str(i), ['username', 'age'])\n# ç»Ÿè®¡è¯»æ—¶é—´\ndelta_time = time.time()-time1\nprint(delta_time)\n</code></pre><p>è¿è¡Œç»“æœï¼š</p><pre><code>2.0041146278381348\n0.9920568466186523\n</code></pre><p>ä½ èƒ½çœ‹åˆ°1ä¸‡æ¬¡å†™è¯·æ±‚å·®ä¸å¤šç”¨æ—¶2ç§’é’Ÿï¼Œè€Œ1ä¸‡æ¬¡è¯»è¯·æ±‚ç”¨æ—¶ä¸åˆ°1ç§’é’Ÿï¼Œè¯»å†™æ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ã€‚</p><h2>æ€»ç»“</h2><p>NoSQLæ•°æ®åº“ç§ç±»éå¸¸å¤šï¼Œäº†è§£Redisæ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç»å¸¸å°†RDBMSå’ŒRedisä¸€èµ·ä½¿ç”¨ï¼Œä¼˜åŠ¿äº’è¡¥ã€‚</p><p>ä½œä¸ºå¸¸è§çš„NoSQLæ•°æ®åº“ï¼ŒRedisæ”¯æŒçš„æ•°æ®ç±»å‹æ¯”Memcachedä¸°å¯Œå¾—å¤šï¼Œåœ¨I/Oæ€§èƒ½ä¸Šï¼ŒRedisé‡‡ç”¨çš„æ˜¯å•çº¿ç¨‹I/Oå¤ç”¨æ¨¡å‹ï¼Œè€ŒMemcachedæ˜¯å¤šçº¿ç¨‹ï¼Œå¯ä»¥åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ã€‚è€Œä¸”åœ¨æŒä¹…åŒ–ä¸Šï¼ŒRedisæä¾›äº†ä¸¤ç§æŒä¹…åŒ–çš„æ¨¡å¼ï¼Œå¯ä»¥è®©æ•°æ®æ°¸ä¹…ä¿å­˜ï¼Œè¿™æ˜¯Memcachedä¸å…·å¤‡çš„ã€‚</p><p><img src=\"\" alt=\"\"></p><p>ä½ ä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆRedisé‡‡ç”¨äº†å•çº¿ç¨‹å·¥ä½œæ¨¡å¼ï¼Ÿæœ‰å“ªäº›æœºåˆ¶å¯ä»¥ä¿è¯Rediså³ä½¿é‡‡ç”¨å•çº¿ç¨‹æ¨¡å¼æ•ˆç‡ä¹Ÿå¾ˆé«˜å‘¢ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµä¸€ä¸‹ã€‚</p>","comments":[{"had_liked":false,"id":132501,"user_name":"å¢¨ç¦¾","can_delete":false,"product_type":"c1","uid":1216590,"ip_address":"","ucode":"81BA44231AABE8","user_header":"https://static001.geekbang.org/account/avatar/00/12/90/4e/efaea936.jpg","comment_is_top":false,"comment_ctime":1568153730,"is_pvip":false,"replies":[{"id":"51479","content":"è§£é‡Šçš„å¾ˆå¥½ï¼Œå¤§å®¶éƒ½å¯ä»¥çœ‹ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568791217,"ip_address":"","comment_id":132501,"utype":1}],"discussion_count":6,"race_medal":0,"score":"181956780162","product_id":100029501,"comment_content":"ä¸ºä»€ä¹ˆè¦è®¾è®¡æˆå•çº¿ç¨‹ï¼Ÿ<br>1.å•çº¿ç¨‹å‡å°‘äº†cpuèµ„æºçš„äº‰ç”¨ï¼Œé¿å…äº†ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ã€‚<br>2.åŸºäºå†…å­˜è¯»å†™ï¼Œå•çº¿ç¨‹è¯»å†™è€—æ—¶æ›´å°‘ã€‚<br><br>ä¸ºå•¥rediså•çº¿ç¨‹æ¨¡å‹ä¹Ÿèƒ½æ•ˆç‡è¿™ä¹ˆé«˜ï¼Ÿ<br><br>1ï¼‰çº¯å†…å­˜æ“ä½œ<br>2ï¼‰æ ¸å¿ƒæ˜¯åŸºäºéé˜»å¡çš„IOå¤šè·¯å¤ç”¨æœºåˆ¶<br>3ï¼‰å•çº¿ç¨‹åè€Œé¿å…äº†å¤šçº¿ç¨‹çš„é¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢é—®é¢˜","like_count":43,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466974,"discussion_content":"è§£é‡Šçš„å¾ˆå¥½ï¼Œå¤§å®¶éƒ½å¯ä»¥çœ‹ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568791217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1425456,"avatar":"https://static001.geekbang.org/account/avatar/00/15/c0/30/53965ee0.jpg","nickname":"åˆ˜ä¼Ÿ","note":"","ucode":"26A77D2F6429F0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":248411,"discussion_content":"ç­‰äºæ²¡è®²","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1587868483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1425456,"avatar":"https://static001.geekbang.org/account/avatar/00/15/c0/30/53965ee0.jpg","nickname":"åˆ˜ä¼Ÿ","note":"","ucode":"26A77D2F6429F0","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378152,"discussion_content":"æˆ‘ä¹Ÿçœ‹ä¸å¤ªæ‡‚ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯è‡ªå·±ç¼ºäº†ä¸€äº›è®¡ç®—æœºç»„æˆåŸç†çš„çŸ¥è¯†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623071510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":248411,"ip_address":""},"score":378152,"extra":""}]},{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378153,"discussion_content":"åœ¨æŠ€æœ¯ä¸Š Redis è¿˜é‡‡ç”¨äº†å¤šè·¯ I/O å¤ç”¨æŠ€æœ¯ã€‚è¿™é‡Œçš„å¤šè·¯æŒ‡çš„æ˜¯å¤šä¸ª socket ç½‘ç»œè¿æ¥ï¼Œå¤ç”¨æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚é‡‡ç”¨å¤šè·¯ I/O å¤ç”¨æŠ€æœ¯çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†å¤šä¸ª I/O è¯·æ±‚ï¼Œå°½é‡å‡å°‘ç½‘ç»œ I/O çš„æ¶ˆè€—ï¼Œæå‡ä½¿ç”¨æ•ˆç‡ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623071609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1394726,"avatar":"https://static001.geekbang.org/account/avatar/00/15/48/26/93fd21d5.jpg","nickname":"ä¹¦ç—•","note":"","ucode":"8367371EF89D61","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":45993,"discussion_content":"å¦‚æœå°†Redisçº¿ç¨‹å›ºå®šåˆ°CPUæŸä¸ªå†…æ ¸ä¸Šï¼Œæ€§èƒ½å¯èƒ½ä¼šæ›´é«˜å§","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1573107547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1365206,"avatar":"https://static001.geekbang.org/account/avatar/00/14/d4/d6/1d4543ac.jpg","nickname":"äº‘æµ·","note":"","ucode":"0C6CA0BE58EA21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1394726,"avatar":"https://static001.geekbang.org/account/avatar/00/15/48/26/93fd21d5.jpg","nickname":"ä¹¦ç—•","note":"","ucode":"8367371EF89D61","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":396603,"discussion_content":"æ˜¯çš„ï¼Œæ€§èƒ½ä¼šæ›´é«˜ï¼Œä¸å­˜åœ¨CPUä¿¡æ¯é‡æ–°åˆ‡æ¢åŠ è½½ï¼Œä½†ä¹Ÿè¦æ³¨æ„é£é™©ã€‚\nredisæ”¯æŒç»‘æ ¸æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°±æŠŠ Redis å®ä¾‹ç»‘åœ¨äº† 0 å·æ ¸ä¸Šï¼Œå…¶ä¸­ï¼Œâ€œ-câ€é€‰é¡¹ç”¨äºè®¾ç½®è¦ç»‘å®šçš„æ ¸ç¼–å·ã€‚\ntaskset -c 0 ./redis-server\n\nå½“æˆ‘ä»¬æŠŠ Redis å®ä¾‹ç»‘åˆ°ä¸€ä¸ª CPU é€»è¾‘æ ¸ä¸Šæ—¶ï¼Œå°±ä¼šå¯¼è‡´å­è¿›ç¨‹ã€åå°çº¿ç¨‹å’Œ Redis ä¸»çº¿ç¨‹ç«äº‰ CPU èµ„æºï¼Œä¸€æ—¦å­è¿›ç¨‹æˆ–åå°çº¿ç¨‹å ç”¨ CPU æ—¶ï¼Œä¸»çº¿ç¨‹å°±ä¼šè¢«é˜»å¡ï¼Œå¯¼è‡´ Redis è¯·æ±‚å»¶è¿Ÿå¢åŠ ã€‚\n\næ–¹æ¡ˆä¸€ï¼šä¸€ä¸ª Redis å®ä¾‹å¯¹åº”ç»‘ä¸€ä¸ªç‰©ç†æ ¸ï¼Œ\næ–¹æ¡ˆäºŒï¼šä¼˜åŒ– Redis æºç ï¼Œé€šè¿‡ä¿®æ”¹ Redis æºç ï¼ŒæŠŠå­è¿›ç¨‹å’Œåå°çº¿ç¨‹ç»‘åˆ°ä¸åŒçš„ CPU æ ¸ä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632460063,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":45993,"ip_address":""},"score":396603,"extra":""}]}]},{"had_liked":false,"id":131827,"user_name":"jxs1211","can_delete":false,"product_type":"c1","uid":1101006,"ip_address":"","ucode":"B7F1F2D84389E7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKELX1Rd1vmLRWibHib8P95NA87F4zcj8GrHKYQL2RcLDVnxNy1ia2geTWgW6L2pWn2kazrPNZMRVrIg/132","comment_is_top":false,"comment_ctime":1567925031,"is_pvip":false,"replies":[{"id":"53378","content":"Redisæ˜¯Key-Valueæ•°æ®åº“ï¼Œæ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼ŒæŸ¥è¯¢å’Œå†™å…¥éƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œã€‚å½“ç„¶Redisä¹Ÿæ”¯æŒæŒä¹…åŒ–ï¼Œåªæ˜¯æŒä¹…åŒ–åªæ˜¯Redisçš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¹¶ä¸æ˜¯Redisçš„å¼ºé¡¹ã€‚é€šå¸¸ï¼Œä½ å¯ä»¥æŠŠRedisç§°ä¹‹ä¸ºç¼“å­˜ã€‚æ”¯æŒçš„æ•°æ®ç±»å‹ä¸°å¯Œï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆï¼ŒåŒæ—¶è¿˜æ”¯æŒåŸºæ•°ç»Ÿè®¡ï¼Œåœ°ç†ç©ºé—´ä»¥åŠç´¢å¼•åŠå¾„æŸ¥è¯¢ï¼Œæ•°æ®æµç­‰ã€‚<br>MongoDBæ˜¯é¢å‘æ–‡æ¡£æ•°æ®åº“ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯éå…³ç³»å‹æ•°æ®åº“ä¸­æœ€åƒå…³ç³»å‹æ•°æ®åº“çš„ï¼Œå¤„ç†å¢åˆ æ”¹æŸ¥ä¹Ÿå¯ä»¥å¢åŠ æ¡ä»¶ï¼Œç±»ä¼¼äºRDBMSä¸€æ ·çµæ´»ã€‚<br>åœ¨å­˜å‚¨æ–¹å¼ä¸Šï¼ŒRediså°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œé€šè¿‡RDBæˆ–è€…AOFæ–¹å¼è¿›è¡ŒæŒä¹…åŒ–ã€‚<br>è€ŒMongoDBå®é™…ä¸Šæ•°æ®æ˜¯å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ï¼Œåªæ˜¯é€šè¿‡mmapè°ƒç”¨å°†æ•°æ®æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°†mmapç†è§£æˆä¸ºåŠ é€Ÿçš„æ–¹å¼ã€‚mmapè°ƒç”¨å¯ä»¥ä½¿å¾—å¯¹æ™®é€šæ–‡ä»¶çš„æ“ä½œåƒæ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œè¯»å†™ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå°†æ–‡ä»¶æ˜ å°„åˆ°è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ï¼Œå®ç°äº†æ–‡ä»¶æ‰€åœ¨çš„ç£ç›˜ç‰©ç†åœ°å€ä¸è¿›ç¨‹ç©ºé—´çš„è™šæ‹Ÿåœ°å€ä¸€ä¸€æ˜ å°„çš„å…³ç³»ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œï¼Œç„¶åå†™å®Œæˆä¹‹ååŒæ­¥ä¸€ä¸‹å°±å¯ä»¥å­˜æ”¾åˆ°æ–‡ä»¶ä¸­ï¼Œæ•ˆç‡éå¸¸é«˜ã€‚<br>ä¸è¿‡åœ¨ä½¿ç”¨é€‰æ‹©çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°† MongoDB å½’ä¸ºæ•°æ®åº“ï¼Œè€ŒRediså½’ä¸ºç¼“å­˜ã€‚<br>æ€»çš„æ¥è¯´ï¼ŒRediså°±åƒæ˜¯ä¸€æ¶é£æœºä¸€æ ·ï¼ŒæŸ¥è¯¢åŠå†™å…¥æ€§èƒ½æä½³ï¼Œä½†æ˜¯å­˜å‚¨çš„æ•°æ®è§„æ¨¡æœ‰é™ã€‚<br>MongoDBå°±åƒæ˜¯é«˜é“ä¸€æ ·ï¼Œåœ¨å¤„ç†è´§ç‰©ï¼ˆæ•°æ®ï¼‰çš„åŠŸèƒ½ä¸Šå¼ºäºRedisï¼ŒåŒæ—¶èƒ½æ‰¿è½½çš„æ•°æ®é‡ä¹Ÿå¾ˆå¤§ï¼Œè¿œé«˜äºRedisï¼Œä½†æ˜¯æŸ¥è¯¢åŠå†™å…¥çš„æ•ˆç‡ä¸åŠRedisã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1570431016,"ip_address":"","comment_id":131827,"utype":1}],"discussion_count":2,"race_medal":0,"score":"143301845799","product_id":100029501,"comment_content":"è€å¸ˆèƒ½å¦è®²ä¸‹mongodbï¼Œä»¥åŠrediså’Œmongodbçš„å·®åˆ«ï¼Œå®é™…ä½¿ç”¨æ—¶é€‰æ‹©åº”è¯¥åšå“ªäº›æ–¹é¢çš„è€ƒè™‘","like_count":33,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466635,"discussion_content":"Redisæ˜¯Key-Valueæ•°æ®åº“ï¼Œæ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼ŒæŸ¥è¯¢å’Œå†™å…¥éƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œã€‚å½“ç„¶Redisä¹Ÿæ”¯æŒæŒä¹…åŒ–ï¼Œåªæ˜¯æŒä¹…åŒ–åªæ˜¯Redisçš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¹¶ä¸æ˜¯Redisçš„å¼ºé¡¹ã€‚é€šå¸¸ï¼Œä½ å¯ä»¥æŠŠRedisç§°ä¹‹ä¸ºç¼“å­˜ã€‚æ”¯æŒçš„æ•°æ®ç±»å‹ä¸°å¯Œï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆï¼ŒåŒæ—¶è¿˜æ”¯æŒåŸºæ•°ç»Ÿè®¡ï¼Œåœ°ç†ç©ºé—´ä»¥åŠç´¢å¼•åŠå¾„æŸ¥è¯¢ï¼Œæ•°æ®æµç­‰ã€‚\nMongoDBæ˜¯é¢å‘æ–‡æ¡£æ•°æ®åº“ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ˜¯éå…³ç³»å‹æ•°æ®åº“ä¸­æœ€åƒå…³ç³»å‹æ•°æ®åº“çš„ï¼Œå¤„ç†å¢åˆ æ”¹æŸ¥ä¹Ÿå¯ä»¥å¢åŠ æ¡ä»¶ï¼Œç±»ä¼¼äºRDBMSä¸€æ ·çµæ´»ã€‚\nåœ¨å­˜å‚¨æ–¹å¼ä¸Šï¼ŒRediså°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œé€šè¿‡RDBæˆ–è€…AOFæ–¹å¼è¿›è¡ŒæŒä¹…åŒ–ã€‚\nè€ŒMongoDBå®é™…ä¸Šæ•°æ®æ˜¯å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ï¼Œåªæ˜¯é€šè¿‡mmapè°ƒç”¨å°†æ•°æ®æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°†mmapç†è§£æˆä¸ºåŠ é€Ÿçš„æ–¹å¼ã€‚mmapè°ƒç”¨å¯ä»¥ä½¿å¾—å¯¹æ™®é€šæ–‡ä»¶çš„æ“ä½œåƒæ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œè¯»å†™ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå°†æ–‡ä»¶æ˜ å°„åˆ°è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ï¼Œå®ç°äº†æ–‡ä»¶æ‰€åœ¨çš„ç£ç›˜ç‰©ç†åœ°å€ä¸è¿›ç¨‹ç©ºé—´çš„è™šæ‹Ÿåœ°å€ä¸€ä¸€æ˜ å°„çš„å…³ç³»ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œï¼Œç„¶åå†™å®Œæˆä¹‹ååŒæ­¥ä¸€ä¸‹å°±å¯ä»¥å­˜æ”¾åˆ°æ–‡ä»¶ä¸­ï¼Œæ•ˆç‡éå¸¸é«˜ã€‚\nä¸è¿‡åœ¨ä½¿ç”¨é€‰æ‹©çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°† MongoDB å½’ä¸ºæ•°æ®åº“ï¼Œè€ŒRediså½’ä¸ºç¼“å­˜ã€‚\næ€»çš„æ¥è¯´ï¼ŒRediså°±åƒæ˜¯ä¸€æ¶é£æœºä¸€æ ·ï¼ŒæŸ¥è¯¢åŠå†™å…¥æ€§èƒ½æä½³ï¼Œä½†æ˜¯å­˜å‚¨çš„æ•°æ®è§„æ¨¡æœ‰é™ã€‚\nMongoDBå°±åƒæ˜¯é«˜é“ä¸€æ ·ï¼Œåœ¨å¤„ç†è´§ç‰©ï¼ˆæ•°æ®ï¼‰çš„åŠŸèƒ½ä¸Šå¼ºäºRedisï¼ŒåŒæ—¶èƒ½æ‰¿è½½çš„æ•°æ®é‡ä¹Ÿå¾ˆå¤§ï¼Œè¿œé«˜äºRedisï¼Œä½†æ˜¯æŸ¥è¯¢åŠå†™å…¥çš„æ•ˆç‡ä¸åŠRedisã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570431016,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378155,"discussion_content":"è€å¸ˆçœŸå‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623071816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145200,"user_name":"Coool","can_delete":false,"product_type":"c1","uid":1701702,"ip_address":"","ucode":"1D1AB3270B02B9","user_header":"https://static001.geekbang.org/account/avatar/00/19/f7/46/209ca424.jpg","comment_is_top":false,"comment_ctime":1572229067,"is_pvip":false,"replies":[{"id":"62688","content":"å¯¹ æ€»ç»“çš„ä¸é”™","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1577084532,"ip_address":"","comment_id":145200,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27342032843","product_id":100029501,"comment_content":"ä¸ºä»€ä¹ˆä½¿ç”¨å•çº¿ç¨‹ï¼Ÿ<br>1ã€ä»£ç æ›´æ¸…æ™°ï¼Œå¤„ç†é€»è¾‘æ›´ç®€å•<br>2ã€ä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—<br>3ã€ä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€—CPU","like_count":6,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472285,"discussion_content":"å¯¹ æ€»ç»“çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577084532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134975,"user_name":"xcoder","can_delete":false,"product_type":"c1","uid":1207135,"ip_address":"","ucode":"2C70ED36B4AC8E","user_header":"https://static001.geekbang.org/account/avatar/00/12/6b/5f/cec1e980.jpg","comment_is_top":false,"comment_ctime":1568966813,"is_pvip":false,"replies":[{"id":"53357","content":"Pythonåœ¨ä¸“æ é‡Œç¡®å®æ²¡æœ‰è®²è§£ï¼Œå¦‚æœä¹‹å‰æœ‰ç¼–ç¨‹è¯­è¨€åŸºç¡€ï¼ŒæŒæ¡èµ·æ¥ä¸éš¾ã€‚ä¸“æ é‡Œä½¿ç”¨åˆ°çš„ä¹Ÿæ˜¯åŸºç¡€çš„è¯­æ³•ã€‚Rediså¦‚æœä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ï¼Œåˆ°æ˜¯ä¸å½±å“ï¼Œå› ä¸ºè¿™èŠ‚ä¸»è¦æ˜¯Redisåˆè¯†ï¼Œå¯ä»¥è·Ÿç€åšéç»ƒä¹ ï¼Œå¯¹Rediså¤šä¸€äº›äº†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1570426887,"ip_address":"","comment_id":134975,"utype":1}],"discussion_count":6,"race_medal":0,"score":"14453868701","product_id":100029501,"comment_content":"ä¸å¥½æ„æ€ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªè¯¾ç¨‹å¯¹åˆå­¦è€…ï¼Œæˆ–è€…å®Œå…¨æ²¡æ¥è§¦è¿‡pythonå’Œredisçš„åŒå­¦æ¥è¯´ä¸å¤ªå‹å¥½å§ã€‚è¿˜å¾—è¡¥å……å¾ˆå¤šçŸ¥è¯†ï¼Œå®‰è£…pythonå’Œredisï¼Œå¦‚ä½•æ“ä½œç­‰ç­‰ã€‚ã€‚ã€‚è¿™äº›éƒ½è¿˜éœ€è¦ç½‘ä¸Šæ‰¾ä¸‹æ•™ç¨‹ï¼Œè™½ç„¶æœ€è¿‘éƒ½æœ‰åœ¨çœ‹èµ·æ¥ï¼Œä½†è§‰å¾—å­¦èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹åŠ›ä¸ä»å¿ƒï¼Œè¶Šåˆ°åé¢æ„Ÿè§‰è¯„è®ºçš„äººä¹Ÿè¶Šæ¥è¶Šå°‘äº†ï¼Œä¸çŸ¥é“åé¢çš„è¯¾æ—¶å­¦çš„äººä¹Ÿæ˜¯ä¸æ˜¯è¶Šæ¥è¶Šå°‘äº†","like_count":3,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467986,"discussion_content":"Pythonåœ¨ä¸“æ é‡Œç¡®å®æ²¡æœ‰è®²è§£ï¼Œå¦‚æœä¹‹å‰æœ‰ç¼–ç¨‹è¯­è¨€åŸºç¡€ï¼ŒæŒæ¡èµ·æ¥ä¸éš¾ã€‚ä¸“æ é‡Œä½¿ç”¨åˆ°çš„ä¹Ÿæ˜¯åŸºç¡€çš„è¯­æ³•ã€‚Rediså¦‚æœä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ï¼Œåˆ°æ˜¯ä¸å½±å“ï¼Œå› ä¸ºè¿™èŠ‚ä¸»è¦æ˜¯Redisåˆè¯†ï¼Œå¯ä»¥è·Ÿç€åšéç»ƒä¹ ï¼Œå¯¹Rediså¤šä¸€äº›äº†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570426887,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1125885,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2d/fd/cfc952f5.jpg","nickname":"å¤§ç§‘çˆ±åƒè‚‰","note":"","ucode":"4C243A5729A848","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":21226,"discussion_content":"ä¸å°±æ˜¯å› ä¸ºæ²¡æ¥è§¦æ‰çœ‹çš„å—...","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1569455771,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1207135,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6b/5f/cec1e980.jpg","nickname":"xcoder","note":"","ucode":"2C70ED36B4AC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1125885,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2d/fd/cfc952f5.jpg","nickname":"å¤§ç§‘çˆ±åƒè‚‰","note":"","ucode":"4C243A5729A848","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":22883,"discussion_content":"æˆ‘çš„æƒ³æ³•æ˜¯å¸Œæœ›ä½œè€…èƒ½åŠ å…¥æ›´å¤šç»†èŠ‚çŸ¥è¯†å¼•ç”¨çš„é“¾æ¥ç­‰ï¼Œå¯¹äºä¸€äº›åˆå­¦è€…å»æ‰¾ç»†èŠ‚ä¸Šçš„èµ„æ–™ä¼šå¾ˆè¾›è‹¦ï¼Œæœ‰æ—¶ä¼šåƒæ— å¤´è‹è‡ï¼ŒèŠ±äº†å¤§æŠŠæ—¶é—´ï¼Œæ•ˆç‡ä¹Ÿä¸é«˜ï¼Œå¯èƒ½è¿˜æ˜¯ä¸€ç›´æä¸å®šé—®é¢˜ï¼Œæ¸æ¸å°±ä¼šå¤±å»å­¦ä¹ çš„åŠ¨åŠ›ï¼Œå½“ç„¶èƒ½ä¸èƒ½åšæŒä¸‹å»è¿˜æ˜¯çœ‹ä¸ªäººçš„","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1569722969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":21226,"ip_address":""},"score":22883,"extra":""},{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"éª‘è¡Œçš„æŒæŸœJ","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1207135,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6b/5f/cec1e980.jpg","nickname":"xcoder","note":"","ucode":"2C70ED36B4AC8E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274193,"discussion_content":"æ‰€ä»¥æˆ‘è§‰å¾—ä½ å¯ä»¥çœ‹çœ‹æˆ‘çš„åšå®¢ï¼ˆhttps://blog.csdn.net/weixin_41013322ï¼‰\nä¸€åŠå†…å®¹éƒ½æ˜¯å¯¹é™ˆè€å¸ˆçš„ä¸“æ è¿›è¡Œçš„ç»†èŠ‚è¡¥å…… ğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590552203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":22883,"ip_address":""},"score":274193,"extra":""},{"author":{"id":1919541,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/4a/35/66caeed9.jpg","nickname":"å®Œç¾åšæŒ","note":"","ucode":"AE0261D8DDEF64","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"éª‘è¡Œçš„æŒæŸœJ","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378157,"discussion_content":"åœ¨ä½ çš„åšå®¢é‡Œä¸å¤ªå¥½æ‰¾é™ˆè€å¸ˆä¸“æ ç›¸å…³çš„å†…å®¹ï¼ˆæˆ‘çŸ¥é“è‚¯å®šæœ‰ï¼Œä½†æ˜¯æˆ‘åŠå¤©ç¿»ä¸åˆ°ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623072031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":274193,"ip_address":""},"score":378157,"extra":""}]}]},{"had_liked":false,"id":221749,"user_name":"éª‘è¡Œçš„æŒæŸœJ","can_delete":false,"product_type":"c1","uid":1474214,"ip_address":"","ucode":"3163102651C653","user_header":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","comment_is_top":false,"comment_ctime":1590582172,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10180516764","product_id":100029501,"comment_content":"ç”¨Pythonè¿æ¥RedisæŠ¥é”™â€œConnectionRefusedError: [WinError 10061]ç”±äºç›®æ ‡è®¡ç®—æœºç§¯ææ‹’ç»ï¼Œæ— æ³•è¿æ¥ã€‚â€çš„è§£å†³åŠæ³• ï¼š<br>https:&#47;&#47;blog.csdn.net&#47;weixin_41013322&#47;article&#47;details&#47;106387319<br>å¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©","like_count":2},{"had_liked":false,"id":183875,"user_name":"å››å–œ","can_delete":false,"product_type":"c1","uid":1071389,"ip_address":"","ucode":"C5EBED19C0F332","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/1d/c89abcd8.jpg","comment_is_top":false,"comment_ctime":1583152425,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10173087017","product_id":100029501,"comment_content":"æˆ‘çš„é€Ÿåº¦æ˜¯è€å¸ˆçš„1&#47;10","like_count":2},{"had_liked":false,"id":131349,"user_name":"æœ‰æ‰€æ€","can_delete":false,"product_type":"c1","uid":1045956,"ip_address":"","ucode":"FA3FF98D3DC69B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/c4/f2d7ce76.jpg","comment_is_top":false,"comment_ctime":1567728873,"is_pvip":false,"discussion_count":8,"race_medal":0,"score":"10157663465","product_id":100029501,"comment_content":"è€å¸ˆï¼Œä¸ºä»€ä¹ˆä½ è®²çš„Redisåº•å±‚æ•°æ®ç»“æ„å’Œç‹äº‰è®²çš„æ•°æ®ç»“æ„ä¸ç®—æ³•è¯¾é‡Œé¢çš„æœ‰äº›ä¸ä¸€æ ·ï¼Œä»–è¯´çš„é‡Œé¢redisä¼šæ ¹æ®æ•°æ®å¤§å°å’Œæ•°é‡é€‰æ‹©ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œè€Œä¸”æœ‰åºé›†åˆç”¨çš„æ˜¯è·³è¡¨å®ç°ï¼Œæœ‰ç‚¹è’™","like_count":2,"discussions":[{"author":{"id":1190150,"avatar":"https://static001.geekbang.org/account/avatar/00/12/29/06/0b327738.jpg","nickname":"Gankki","note":"","ucode":"399C6F74286590","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":11244,"discussion_content":"Implementation note: Sorted sets are implemented via a dual-ported data structure containing both a skip list and a hash table, so every time we add an element Redis performs an O(log(N)) operation   ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1568371558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1437425,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ee/f1/16545faf.jpg","nickname":"å­¦ä¹ ","note":"","ucode":"CDFB71E0D1508B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7931,"discussion_content":"æ•°æ®ç»“æ„è¯´çš„æ˜¯Redisçš„æ•°æ®ç»“æ„æ˜¯æ€æ ·çš„ï¼Œç®€å•æ¥è¯´ï¼Œä¸€ä¸ªæ˜¯æ•™ä½ å¦‚ä½•é€ ä¸€ä¸ªRedisï¼Œä¸€ä¸ªæ˜¯æ•™ä½ å¦‚ä½•ä½¿ç”¨Redis","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567732679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1229516,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","nickname":"è“å£«é’¦","note":"","ucode":"726EB5C8EF1249","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327821,"discussion_content":"è€å¸ˆè¿™é‡Œè®²çš„æ˜¯Redisçš„5ç§å€¼ç±»å‹ï¼Œä¸åŒå€¼ç±»å‹ä½å±‚éƒ½æœ‰å¯¹åº”çš„æ•°æ®å­˜å‚¨ç»“æ„ï¼Œæ¯”å¦‚è·³è¡¨ç­‰ã€‚å»ºè®®ä½ é˜…è¯»æå®¢æ—¶é—´çš„Redisä¸“æ ä¼šæœ‰æ‰€æ”¶è·ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605961854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1188793,"avatar":"https://static001.geekbang.org/account/avatar/00/12/23/b9/8d182f13.jpg","nickname":"èµ·é£äº†","note":"","ucode":"9A8A2E51E198EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305720,"discussion_content":"zsetæ˜¯ç”± skiplist+dict å…±åŒå®ç°çš„ã€‚dict è´Ÿè´£ä¿å­˜æ•°æ®åˆ° score çš„å¯¹åº”å…³ç³»ï¼Œé”®æ˜¯æ•°æ®çš„å€¼ï¼Œå€¼æ˜¯scoreï¼›skiplist ä¿å­˜æ•°æ®ã€‚dict å®ç°äº†å¿«é€Ÿåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨å’Œè¿”å›å…ƒç´ çš„ scoreã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600069149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"æ—…é€”","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":112426,"discussion_content":"ä½ æ‡‚ä»€ä¹ˆå«åº•å±‚å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577862011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1582134,"avatar":"https://static001.geekbang.org/account/avatar/00/18/24/36/1c4af368.jpg","nickname":"TheOne","note":"","ucode":"2A359780156A8B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"æ—…é€”","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392572,"discussion_content":"æˆ‘æ˜¯ä½ çˆ¹","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1631063393,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":112426,"ip_address":""},"score":392572,"extra":""},{"author":{"id":2815900,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/f7/9c/69c5c5dc.jpg","nickname":"è¶Šé”‹åˆ©","note":"","ucode":"63E9E3F3C7D53D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1212902,"avatar":"https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg","nickname":"æ—…é€”","note":"","ucode":"5022477E8E9441","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533059,"discussion_content":"å‹å–„çš„è¯„è®ºæ˜¯äº¤æµçš„èµ·ç‚¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637764400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":112426,"ip_address":""},"score":533059,"extra":"{\"user_type\":1}"}]},{"author":{"id":1005391,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","nickname":"ä¸€æ­¥","note":"","ucode":"73CEA468CE70C3","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8367,"discussion_content":"æœ‰åºé›†åˆåº•å±‚æ˜¯è·³è·ƒè¡¨å®ç°çš„ï¼Œä½†æ˜¯è·³è·ƒè¡¨çš„å®ç°åŸºç¡€æ˜¯é“¾è¡¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567950077,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":223858,"user_name":"ä¸€è·¯å‰è¡Œ","can_delete":false,"product_type":"c1","uid":1288985,"ip_address":"","ucode":"32D3C715690783","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcFhGY0NV4kFzOSXWDHR2lrI2UbUP4Y016GOnpTH7dqSbicqJarX0pHxMsfLopRiacKEPXLx7IHHqg/132","comment_is_top":false,"comment_ctime":1591197514,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5886164810","product_id":100029501,"comment_content":"redis6.0ï¼Œé‡‡ç”¨äº†å¤šçº¿ç¨‹æ¨¡å¼ï¼Œè€å¸ˆæ€ä¹ˆçœ‹ï¼Ÿï¼Ÿï¼Ÿ","like_count":1},{"had_liked":false,"id":131512,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1567775177,"is_pvip":false,"replies":[{"id":"50429","content":"åŠ æ²¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568004375,"ip_address":"","comment_id":131512,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862742473","product_id":100029501,"comment_content":"è·Ÿç€è€å¸ˆä¸€èµ·ç²¾è¿›ã€‚åŠ æ²¹ã€‚","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466494,"discussion_content":"åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568004375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":131364,"user_name":"å­¦ä¹ ","can_delete":false,"product_type":"c1","uid":1437425,"ip_address":"","ucode":"CDFB71E0D1508B","user_header":"https://static001.geekbang.org/account/avatar/00/15/ee/f1/16545faf.jpg","comment_is_top":false,"comment_ctime":1567730979,"is_pvip":false,"replies":[{"id":"50434","content":"æ˜¯fieldï¼Œä»£è¡¨å­—æ®µçš„å«ä¹‰","user_name":"ä½œè€…å›å¤","user_name_real":"cy","uid":"1306094","ctime":1568005268,"ip_address":"","comment_id":131364,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862698275","product_id":100029501,"comment_content":"æ–‡ä¸­å¤šæ¬¡æåˆ°key-filed-valueï¼Œæ˜¯fieldè¿˜æ˜¯filedå•Šï¼ï¼ï¼ï¼<br><br>Redisé‡‡ç”¨å•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å‹ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯é¿å…äº†ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œä¸å¿…è¦çš„çº¿ç¨‹ä¹‹é—´å¼•èµ·çš„èµ„æºç«äº‰ã€‚è¿™æ ·å°±ä¼šå¾ˆå¿«ã€‚<br><br>Redisé‡‡ç”¨å¤šè·¯I&#47;Oå¤ç”¨æŠ€æœ¯ï¼Œè¿™æ ·å°±ä¼šè§£å†³å•çº¿ç¨‹æ…¢æ•ˆç‡å¼Šç«¯ï¼Œå…¶ä¸­æœ‰ä¸ªé›†ç¾¤æ¨¡å¼ï¼Œèƒ½æ”¯æŒå¤šå®¢æˆ·ç«¯ä½¿ç”¨","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466412,"discussion_content":"æ˜¯fieldï¼Œä»£è¡¨å­—æ®µçš„å«ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568005268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360282,"user_name":"æ˜æœˆ","can_delete":false,"product_type":"c1","uid":1070166,"ip_address":"é™•è¥¿","ucode":"E180B0EC24EFE8","user_header":"https://static001.geekbang.org/account/avatar/00/10/54/56/5a5098d1.jpg","comment_is_top":false,"comment_ctime":1666397381,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666397381","product_id":100029501,"comment_content":"ä½¿ç”¨å•çº¿ç¨‹ï¼Œæ˜¯ä¸æ˜¯åŸç†å°±æ˜¯ç±»ä¼¼JavaScriptçš„çº¿ç¨‹æ¨¡å‹ï¼Œé‡‡ç”¨è½®è¯¢ä¸€ä¸ªé˜Ÿåˆ—çš„æ–¹å¼","like_count":0},{"had_liked":false,"id":358105,"user_name":"è¿½é£ç­çš„äºº","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"é™•è¥¿","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1663912743,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663912743","product_id":100029501,"comment_content":"1. Redisç”¨ä½œç¼“å­˜æ•°æ®åº“<br>2.å•çº¿ç¨‹IOå¤ç”¨æ¨¡å‹<br>3.æŒä¹…åŒ–æ–¹å¼æœ‰RDB,AOF , ä¸€èˆ¬å¼€å¯aof ","like_count":0},{"had_liked":false,"id":260345,"user_name":"å°è™¾ç±³","can_delete":false,"product_type":"c1","uid":1619943,"ip_address":"","ucode":"7F0AAF55F602DC","user_header":"","comment_is_top":false,"comment_ctime":1604988360,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604988360","product_id":100029501,"comment_content":"1.0412158966064453<br>1.049706220626831<br><br><br>æ„Ÿè°¢è€å¸ˆï¼Œåˆè¯†redis","like_count":0},{"had_liked":false,"id":206272,"user_name":"å‡Œç©ºé£èµ·çš„å‰ªåˆ€è…¿","can_delete":false,"product_type":"c1","uid":1243680,"ip_address":"","ucode":"16FBBF4A3B54C6","user_header":"https://static001.geekbang.org/account/avatar/00/12/fa/20/0f06b080.jpg","comment_is_top":false,"comment_ctime":1586832010,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586832010","product_id":100029501,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼š<br>      Redisç”¨è·³è¡¨æ¥å®ç°æœ‰åºé›†åˆçš„ï¼Œä¸æ˜¯ä½¿ç”¨hashè¡¨æ¥å®ç°æœ‰åºé›†åˆå§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1188793,"avatar":"https://static001.geekbang.org/account/avatar/00/12/23/b9/8d182f13.jpg","nickname":"èµ·é£äº†","note":"","ucode":"9A8A2E51E198EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305721,"discussion_content":"zsetæ˜¯ç”± skiplist+dict å…±åŒå®ç°çš„ã€‚dict è´Ÿè´£ä¿å­˜æ•°æ®åˆ° score çš„å¯¹åº”å…³ç³»ï¼Œé”®æ˜¯æ•°æ®çš„å€¼ï¼Œå€¼æ˜¯scoreï¼›skiplist ä¿å­˜æ•°æ®ã€‚dict å®ç°äº†å¿«é€Ÿåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨å’Œè¿”å›å…ƒç´ çš„ scoreã€‚æºç ï¼š\ntypedef struct zset {\n    dict *dict;\n    zskiplist *zsl;\n} zset;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600069227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148295,"user_name":"æš®é›¨","can_delete":false,"product_type":"c1","uid":1176426,"ip_address":"","ucode":"4B7F4932446EF7","user_header":"https://static001.geekbang.org/account/avatar/00/11/f3/6a/6d82e7a3.jpg","comment_is_top":false,"comment_ctime":1572969111,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572969111","product_id":100029501,"comment_content":"redisçš„å•çº¿ç¨‹æ€ä¹ˆç†è§£ï¼ŸæŸ¥çœ‹redisæœåŠ¡ä¸è‡³ä¸€ä¸ªçº¿ç¨‹","like_count":0}]}