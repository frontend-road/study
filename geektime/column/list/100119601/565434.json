{"id":565434,"title":"08ï½œç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼šReactæ–°è€ç‰ˆæœ¬ä¸­ç”Ÿå‘½å‘¨æœŸçš„æ¼”åŒ–","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å®‹ä¸€ç®ï¼Œæ¬¢è¿å›åˆ°Reactç»„ä»¶çš„å­¦ä¹ ã€‚</p><p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬æš‚æ—¶è·³å‡ºReactçš„æ ¸å¿ƒæ¦‚å¿µï¼Œäº†è§£äº†å¦‚ä½•åˆ©ç”¨ <code>CSS-in-JS</code> æŠ€æœ¯å°†Reactç»„ä»¶çš„CSSæ ·å¼ä¹Ÿç»„ä»¶åŒ–ï¼Œå¹¶ä»¥ <code>emotion</code> æ¡†æ¶ä¸ºä¾‹ï¼Œä¸€èµ·æ”¹å†™äº† <code>oh-my-kanban</code> é¡¹ç›®çš„éƒ¨åˆ†CSSã€‚</p><p>åˆ°è¿™é‡Œï¼Œå¯¹äºç»„ä»¶çš„ç»“æ„å’Œæ ·å¼ï¼Œæˆ‘ä»¬å·²ç»ç»™äºˆäº†è¶³å¤Ÿå……åˆ†çš„å­¦ä¹ å’Œå…³æ³¨ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°†ç”¨å…­èŠ‚è¯¾çš„æ—¶é—´ï¼Œæ¥å­¦ä¹ å¦‚ä½•ä¸ºç»„ä»¶ç¼–å†™é€»è¾‘ã€‚</p><p>ç»„ä»¶çš„é€»è¾‘ä»£ç åº”è¯¥å†™åœ¨å“ªé‡Œå‘¢ï¼Ÿä¸å¦¨å‚è€ƒä¸€ä¸‹å¼€æºé¡¹ç›®Reactç»„ä»¶åº“AntDã€‚æ ¹æ®åœ¨AntDçš„v3.26.20ç‰ˆæœ¬æºä»£ç ä¸­ç»Ÿè®¡å‡½æ•°ä¸ªæ•°ï¼Œè‡³å°‘æœ‰<strong>35%<strong>çš„å‡½æ•°æ˜¯</strong>Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong>ã€‚è¿™å°±å¼•å‡ºäº†è¿™èŠ‚è¯¾çš„ä¸»é¢˜ï¼Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚</p><p>å¯ä»¥è¯´ï¼Œç”Ÿå‘½å‘¨æœŸä¸€ç›´éƒ½æ˜¯å‰ç«¯æŠ€æœ¯ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒReactä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨Reactè¿™é‡Œï¼Œå°¤å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¹¶ä¸ç­‰åŒäºç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong>ã€‚</p><p>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé¦–å…ˆæ˜¯ä¸€ç»„æŠ½è±¡æ¦‚å¿µï¼Œç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’ŒHooks APIéƒ½å¯ä»¥çœ‹ä½œæ˜¯è¿™ç»„æ¦‚å¿µçš„å¯¹å¤–æ¥å£ã€‚å› æ­¤ï¼Œæ— è®ºæ˜¯é€‰æ‹©å‡½æ•°ç»„ä»¶åŠ Hooksï¼Œè¿˜æ˜¯åœ¨ç±»ç»„ä»¶ä¸Šä¸€æ¡è·¯èµ°åˆ°é»‘ï¼Œéƒ½è¦å­¦ä¹ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚</p><p>é‚£ä¹ˆè¿™èŠ‚è¯¾æˆ‘ä»¬å°±å…ˆä»ç±»ç»„ä»¶å…¥æ‰‹ï¼Œé€šè¿‡ä»‹ç»ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¸¦ä½ äº†è§£èƒŒåçš„Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œç„¶åå†ä»å®é™…å‡ºå‘ï¼Œè®²è§£å¯¹åº”çš„Hooksç”¨æ³•ã€‚</p><!-- [[[read_end]]] --><h2>ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h2><p>æ€»ä½“æ¥çœ‹ï¼Œä¸€ä¸ªç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŒ…å«<strong>æŒ‚è½½</strong>ï¼ˆMountingï¼‰ã€<strong>æ›´æ–°</strong>ï¼ˆUpdatingï¼‰ã€<strong>å¸è½½</strong>ï¼ˆUnmountingï¼‰ä¸‰ä¸ªé˜¶æ®µï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ª<strong>é”™è¯¯å¤„ç†</strong>ï¼ˆError Handlingï¼‰é˜¶æ®µã€‚ç±»ç»„ä»¶åœ¨è¿™å››ä¸ªé˜¶æ®µåˆ†åˆ«æä¾›äº†ä¸€äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œç±»ç»„ä»¶æœ€é‡è¦çš„ <code>render()</code> æ–¹æ³•ä¹Ÿæ˜¯ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p><p>è™½ç„¶ç›®å‰åœ¨ <code>oh-my-kanban</code> é¡¹ç›®ä¸­ä¸ä¼šç”¨åˆ°ï¼Œä½†è¿™é‡Œä¸ºäº†æ–¹ä¾¿ä½ ç†è§£ï¼Œè¿˜æ˜¯è´´ä¸€æ®µå¹¶ä¸å®Œæ•´çš„ç±»ç»„ä»¶ä»£ç ï¼š</p><pre><code class=\"language-javascript\">class LegacyKanbanCard extends React.Component {\n  constructor(props) {\n&nbsp; &nbsp; super(props);\n&nbsp; &nbsp; // ...çœç•¥\n&nbsp; }\n\n&nbsp; componentDidMount() {\n    // ...çœç•¥\n&nbsp; }\n\n  // ...å…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•\n\n&nbsp; componentWillUnmount() {\n    // ...çœç•¥\n&nbsp; }\n\n&nbsp; render() {\n&nbsp; &nbsp; return (&lt;div&gt;KanbanCard {this.props.title}&lt;/div&gt;);\n&nbsp; }\n}\n</code></pre><p>è¿™äº›æ–¹æ³•ä¹‹é—´çš„å…ˆåå…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/48/5b/489d8288ceab64a1810f236b4ce6b35b.jpg?wh=1600x1086\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬å…ˆæ¥çœ‹<strong>æŒ‚è½½é˜¶æ®µ</strong>ã€‚å½“ç»„ä»¶é¦–æ¬¡è¢«åŠ å…¥åˆ°è™šæ‹ŸDOMæ—¶ï¼Œç±»ç»„ä»¶ä¼šè¢«å®ä¾‹åŒ–ï¼Œæ¥ç€ä¼šè§¦å‘æŒ‚è½½é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ŒåŒ…æ‹¬å¦‚ä¸‹å››ç§ã€‚</p><ol>\n<li>ç»„ä»¶æ„é€ å‡½æ•°ã€‚å¦‚æœä½ éœ€è¦ä¸ºç±»ç»„ä»¶çš„stateè®¾ç½®åˆå§‹å€¼ï¼Œæˆ–è€…å°†ç±»æ–¹æ³•çš„ <code>this</code> ç»‘å®šåˆ°ç±»å®ä¾‹ä¸Šï¼Œé‚£ä¹ˆä½ å¯ä»¥ä¸ºç±»ç»„ä»¶å®šä¹‰æ„é€ å‡½æ•°ï¼›å¦‚æœä¸éœ€è¦è®¾ç½®æˆ–ç»‘å®šçš„è¯ï¼Œå°±å¯ä»¥çœç•¥æ‰æ„é€ å‡½æ•°ã€‚</li>\n<li><code>static getDerivedStateFromProps</code> ã€‚å¦‚æœç±»ç»„ä»¶å®šä¹‰äº†è¿™ä¸ªé™æ€æ–¹æ³•ï¼Œåœ¨ç»„ä»¶æŒ‚è½½è¿‡ç¨‹ä¸­ï¼ŒReactä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ ¹æ®è¿”å›å€¼æ¥è®¾ç½®stateã€‚</li>\n<li><code>render</code> ï¼Œç±»ç»„ä»¶å¿…é¡»è¦å®ç°è¿™ä¸ªæ–¹æ³•ã€‚é€šå¸¸åœ¨è¿”å›å€¼ä¸­ä¼šä½¿ç”¨JSXè¯­æ³•ï¼ŒReactåœ¨æŒ‚è½½è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨ <code>render</code> æ–¹æ³•è·å¾—ç»„ä»¶çš„å…ƒç´ æ ‘ã€‚æ ¹æ®å…ƒç´ æ ‘ï¼ŒReactæœ€ç»ˆä¼šç”Ÿæˆå¯¹åº”çš„DOMæ ‘ã€‚</li>\n<li><code>componentDidMount</code> ã€‚å½“Reacté¦–æ¬¡å®Œæˆå¯¹åº”DOMæ ‘çš„åˆ›å»ºï¼Œä¼šè°ƒç”¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ä½ å¯ä»¥åœ¨é‡Œé¢è®¿é—®çœŸå®DOMå…ƒç´ ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ <code>this.setState()</code> è§¦å‘å†æ¬¡æ¸²æŸ“ï¼Œä½†è¦æ³¨æ„é¿å…æ€§èƒ½é—®é¢˜ã€‚</li>\n</ol><p>ç„¶åæ˜¯<strong>æ›´æ–°é˜¶æ®µ</strong>ã€‚å½“ç»„ä»¶æ¥æ”¶åˆ°æ–°propsï¼Œæˆ–è€…å†…éƒ¨è°ƒç”¨ <code>setState()</code> ä¿®æ”¹äº†çŠ¶æ€ï¼Œç»„ä»¶ä¼šè¿›å…¥æ›´æ–°é˜¶æ®µï¼Œè§¦å‘æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ŒåŒ…æ‹¬å¦‚ä¸‹äº”ç§ã€‚</p><ol>\n<li><code>static getDerivedStateFromProps</code> ã€‚è¿™ä¸ªé™æ€æ–¹æ³•ä¸ä»…ä¼šåœ¨æŒ‚è½½æ—¶è¢«è°ƒç”¨ï¼Œä¹Ÿä¼šåœ¨æ›´æ–°æ—¶è°ƒç”¨ï¼Œè€Œä¸”æ— è®ºç»„ä»¶propsæ˜¯å¦æœ‰æ›´æ”¹ï¼Œåªè¦æ¸²æŸ“ç»„ä»¶ï¼Œéƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªç‰¹æ€§æœ‰å¯èƒ½é€ æˆç»„ä»¶å†…éƒ¨çš„stateè¢«æ„å¤–è¦†ç›–ï¼Œæ ¹æ®Reactå®˜æ–¹çš„å»ºè®®ï¼Œåº”è°¨æ…ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li>\n<li><code>shouldComponentUpdate</code> ã€‚å¦‚æœç±»ç»„ä»¶å®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ä¸”è¿”å›å€¼æ˜¯ <code>false</code> ï¼Œåˆ™ç»„ä»¶åœ¨è¿™ä¸€æ¬¡æ›´æ–°é˜¶æ®µä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œåç»­çš„renderç­‰æ–¹æ³•ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡æ›´æ–°ã€‚è¿™åœ¨Reactæ—©æœŸç‰ˆæœ¬æ˜¯æœ€å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ³•ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æœ€å¸¸å†™å‡ºBugçš„APIä¹‹ä¸€ã€‚ä¸ºäº†å°½é‡é¿å…è·³è¿‡å¿…è¦æ›´æ–°ï¼Œåº”ä¼˜å…ˆä½¿ç”¨Reactçš„<a href=\"https://zh-hans.reactjs.org/docs/react-api.html#reactpurecomponent\">PureComponentç»„ä»¶</a>ã€‚</li>\n<li><code>render</code>ã€‚æ˜¯çš„ï¼Œåªè¦æ²¡æœ‰è¢«å‰é¢ <code>shouldComponentUpdate</code> æ–¹æ³•è¿”å› <code>false</code> æ‰€å–æ¶ˆï¼Œ<code>render</code> æ–¹æ³•åœ¨æ›´æ–°é˜¶æ®µä¹Ÿä¼šè¢«è°ƒç”¨ï¼Œè°ƒç”¨çš„è¿”å›å€¼ä¼šå½¢æˆæ–°çš„DOMæ ‘ã€‚</li>\n<li><code>getSnapshotBeforeUpdate</code> ã€‚åœ¨æœ¬æ¬¡æ›´æ–°çœŸå®DOMä¹‹å‰ï¼Œä½ æœ‰ä¸€æ¬¡è®¿é—®åŸå§‹DOMæ ‘çš„æœºä¼šï¼Œå°±æ˜¯è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¸è¿‡ä¸å¸¸ç”¨ã€‚</li>\n<li><code>componentDidUpdate</code> ã€‚ç»„ä»¶å®Œæˆæ›´æ–°æ—¶ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ“ä½œDOMï¼Œä¹Ÿå¯ä»¥å¤„ç†ç½‘ç»œè¯·æ±‚ï¼Œä½†è¦æ³¨æ„ï¼Œä½ éœ€è¦é€šè¿‡æ¯”å¯¹æ–°æ—§propsæˆ–stateæ¥é¿å…æ­»å¾ªç¯ã€‚</li>\n</ol><p>æ­¤å¤–ï¼Œæ˜¾å¼è°ƒç”¨ <code>forceUpdate()</code> ä¹Ÿå¯ä»¥ä»¤ç»„ä»¶æ›´æ–°ã€‚ä½†å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªæ¥å£æ›´åå‘å‘½ä»¤å¼ï¼Œä¸Reactå£°æ˜å¼çš„å¼€å‘æ–¹å¼æœ‰æ‰€åŒºåˆ«ï¼Œå› æ­¤è¦å°½é‡å‡å°‘ä½¿ç”¨ã€‚</p><p>å†æ¥ç€æ˜¯<strong>å¸è½½é˜¶æ®µ</strong>ã€‚å½“ç»„ä»¶å³å°†è¢«ä»è™šæ‹ŸDOMä¸­ç§»é™¤æ—¶ï¼Œä¼šè§¦å‘å¸è½½é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä»…åŒ…æ‹¬<code>componentWillUnmount</code> ã€‚ç»„ä»¶å³å°†è¢«å¸è½½æ—¶ï¼ŒReactä¼šè°ƒç”¨å®ƒçš„ <code>componentWillUnmount</code> æ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ¸…ç†å®šæ—¶å™¨ã€å–æ¶ˆä¸å—Reactç®¡ç†çš„äº‹ä»¶è®¢é˜…ç­‰ã€‚</p><p>ç”¨å¥½è¿™ä¸ªæ–¹æ³•ï¼Œå¯¹é¿å…ç±»ä¼¼å†…å­˜æ³„éœ²è¿™æ ·ä¸¥é‡çš„Bugå¾ˆæœ‰å¸®åŠ©ã€‚</p><p>å…¶å®åœ¨ä¸Šé¢ä¸‰ä¸ªé˜¶æ®µä¸­ï¼Œè¿˜æœ‰ä¸€äº›åå­—ä»¥ <code>UNSAFE_componentWill*</code> å¼€å¤´çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå®ƒä»¬å³å°†åœ¨æœªæ¥Reactç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸å†å±•å¼€ã€‚</p><p>æœ€åæ˜¯<strong>é”™è¯¯å¤„ç†é˜¶æ®µ</strong>ã€‚å½“ç»„ä»¶åœ¨æ¸²æŸ“æ—¶ã€æ‰§è¡Œå…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ—¶ã€æˆ–è€…æ˜¯æ‰§è¡ŒHooksæ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿›å…¥é”™è¯¯å¤„ç†é˜¶æ®µã€‚</p><p>å¦‚æœç»„ä»¶æœ¬èº«å®šä¹‰äº† <code>static getDerivedStateFromError</code> å’Œ <code>componentDidCatch</code> è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­çš„ä¸€ä¸ªï¼Œæˆ–è€…ä¸¤ä¸ªéƒ½å®šä¹‰äº†ï¼Œè¿™ä¸ªç»„ä»¶å°±æˆä¸ºäº†<strong>é”™è¯¯è¾¹ç•Œ</strong>ï¼ˆError Boundaryï¼‰ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¼šè¢«Reactè°ƒç”¨æ¥å¤„ç†é”™è¯¯ã€‚</p><p>å¦‚æœå½“å‰ç»„ä»¶ä¸æ˜¯é”™è¯¯è¾¹ç•Œï¼ŒReactå°±ä¼šå»æ‰¾çˆ¶ç»„ä»¶ï¼›å¦‚æœçˆ¶ç»„ä»¶ä¹Ÿä¸æ˜¯ï¼Œå°±ä¼šç»§ç»­å¾€ä¸Šï¼Œç›´åˆ°æ ¹ç»„ä»¶ï¼›å¦‚æœè°éƒ½æ²¡æ¥ä½ï¼Œåº”ç”¨å°±æŒ‚äº†ã€‚æ³¨æ„ï¼Œæˆªæ­¢åˆ°React v18.2.0ï¼Œåªæœ‰ç±»ç»„ä»¶æ‰èƒ½æˆä¸ºé”™è¯¯è¾¹ç•Œï¼Œå‡½æ•°ç»„ä»¶æ˜¯ä¸è¡Œçš„ã€‚</p><p>ä»¥ä¸Šæ‰€æœ‰è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œï¼Œåªæœ‰ <code>render()</code> æ˜¯å¿…é¡»å®ç°çš„ï¼Œå…¶ä»–å‡ä¸ºå¯é€‰ã€‚</p><p>ä¸ºäº†è®©ä½ å¯¹è¿™äº›æ–¹æ³•çš„ä½¿ç”¨é¢‘ç‡æœ‰ä¸€ä¸ªæ„Ÿæ€§è®¤è¯†ï¼Œæˆ‘ä»¬ä»æ¥çœ‹ä¸€ä¸ªç²—ç•¥çš„ç»Ÿè®¡ã€‚</p><p>AntDå³Ant Designï¼Œæ˜¯éå¸¸è‘—åçš„Reactç»„ä»¶åº“ï¼ˆ<a href=\"https://ant.design/\">å®˜ç½‘</a>ï¼‰ã€‚åœ¨AndDçš„v3.26.20ç‰ˆæœ¬æºä»£ç ä¸­ï¼ˆåŒ…å«<code>components/**/*.{ts,tsx,js,jsx}</code> å¹¶æ’é™¤<code>__tests__</code> ï¼‰ï¼Œç»Ÿè®¡å‡½æ•°ä¸ªæ•°ï¼ˆæœç´¢æ­£åˆ™è¡¨è¾¾å¼<code>[\\w\\d]+\\(.*\\) ?\\{</code>ï¼‰ ï¼Œè‡³å°‘æœ‰<strong>35%</strong>çš„å‡½æ•°æ˜¯Reactç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p><p>æˆ‘æ ¹æ®ä»Reactå®˜æ–¹ä¸‹è½½çš„æºç åšäº†ä¸€äº›ç»Ÿè®¡ï¼Œç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e3/58/e304f837671acbc548e7c525a41df458.png?wh=1142x640\" alt=\"\" title=\"ç»Ÿè®¡ç»“æœæ¥æºäºï½œç°ä»£React Webå¼€å‘å®æˆ˜@å®‹ä¸€ç®\"></p><p><img src=\"https://static001.geekbang.org/resource/image/3d/68/3dcb188edb36285e6dab3f7e57085868.png?wh=350x356\" alt=\"\" title=\"ç»Ÿè®¡ç»“æœæ¥æºäºï½œç°ä»£React Webå¼€å‘å®æˆ˜@å®‹ä¸€ç®\"></p><p>ä»è¿™ä¸¤å¼ å›¾å¯ä»¥çœ‹å‡ºï¼Œé™¤äº† <code>render</code> å’Œæ„é€ å‡½æ•°ï¼Œå‡ºç°æœ€å¤šçš„ä¾æ¬¡æ˜¯ <code>componentDidMount</code> ã€ <code>componentWillUnmount</code> ã€ <code>getDerivedStateFromProps</code> ã€‚</p><p>ä»¥ä¸Šç»Ÿè®¡æ•°æ®ä¹Ÿå¯ä»¥ä½œä¸ºä½ å­¦ä¹ ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„å‚è€ƒã€‚</p><h2>æ¸²æŸ“é˜¶æ®µä¸æäº¤é˜¶æ®µ</h2><p>å†å›åˆ°è¿™èŠ‚è¯¾å¼€å¤´é‚£å¼ å›¾ï¼Œæˆ‘å°†åœ¨å·¦ä¾§æ–°åŠ å…¥çš„<strong>æ¸²æŸ“</strong>ï¼ˆRenderï¼‰å’Œ<strong>æäº¤</strong>ï¼ˆCommitï¼‰ä¸¤ä¸ªé˜¶æ®µï¼Œè¿™ä¸¤ä¸ªé˜¶æ®µ<strong>ä¸å‰é¢ä»‹ç»çš„æŒ‚è½½ã€æ›´æ–°ã€å¸è½½é˜¶æ®µæ˜¯é‡åˆå åŠ çš„å…³ç³»ã€‚</strong></p><p>æ¯”å¦‚ç»„ä»¶æŒ‚è½½æ—¶è°ƒç”¨çš„æ„é€ å‡½æ•°ã€ <code>render</code> å‘ç”Ÿåœ¨æ¸²æŸ“é˜¶æ®µï¼Œè€Œ <code>componentDidMount</code> å‘ç”Ÿåœ¨æäº¤é˜¶æ®µã€‚ç±»ä¼¼çš„ï¼Œç»„ä»¶æ›´æ–°çš„ <code>shouldComponentUpdate</code> ã€ <code>render</code> ä¹Ÿå‘ç”Ÿåœ¨æ¸²æŸ“é˜¶æ®µï¼Œ <code>componentDidUpdate</code> å‘ç”Ÿåœ¨æäº¤é˜¶æ®µã€‚</p><p>æˆ‘åœ¨ç”»è¿™å¼ å›¾æ—¶ï¼Œçªç„¶æƒ³åˆ°å¯ä»¥ç”¨äº¤é€šä¿¡å·ç¯æ¥åšç±»æ¯”ï¼Œä¾¿ç”¨é»„ç¯æ¥è¡¨ç¤ºæ¸²æŸ“é˜¶æ®µã€ç»¿ç¯è¡¨ç¤ºæäº¤é˜¶æ®µï¼Œçº¢ç¯è¡¨ç¤ºé”™è¯¯å¤„ç†ã€‚å³ä¾§ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„èƒŒæ™¯è‰²é»„ã€ç»¿ã€çº¢ï¼Œè·Ÿå·¦ä¾§ä¿¡å·ç¯çš„é¢œè‰²ä¹Ÿæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p><p>æˆå›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/yy/c6/yya4441c53157a5yyc042c24c6f561c6.jpg?wh=1600x1086\" alt=\"å›¾ç‰‡\"></p><p>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œæ¸²æŸ“é˜¶æ®µå’Œæäº¤é˜¶æ®µä¸ä»…æ˜¯ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ›´æ˜¯æ•´ä¸ªReactè¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸã€‚</p><p>è´¸ç„¶å¼•å…¥è¿™ä¸¤ä¸ªé˜¶æ®µä¼šè®©äººå›°æƒ‘ï¼Œè¿™é‡Œå…ˆè¦ä»‹ç»ä¸€ä¸‹å®ƒä»¬çš„æ¥ç”±ã€‚å¦‚æœä½ è¿˜è®°å¾—ç¬¬6è®²ä¸­æåˆ°çš„ï¼ŒReact v16å¼•å…¥çš„<strong>Fiberåè°ƒå¼•æ“</strong>ï¼Œé‚£è¯·ä½ ç»§ç»­å›å¿†ä¸€ä¸‹ï¼Œè¿™ä¸ªå¼•æ“æ¯”èµ·è€ç‰ˆæœ¬æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¯¹äº†ï¼Œä¸ºäº†æé«˜åè°ƒæ•ˆç‡ï¼Œå‡å°‘é¡µé¢äº¤äº’å¡é¡¿ï¼ŒReactçš„Fiberå¼•æ“æŠŠ<strong>åè°ƒä»åŒæ­¥è¿‡ç¨‹æ”¹è¿›æˆäº†å¼‚æ­¥è¿‡ç¨‹</strong>ã€‚</p><p>æˆ‘ä»¬åœ¨è¿™é‡Œä¸å±•å¼€ä»‹ç»ç®—æ³•å’Œåº•å±‚å®ç°ï¼Œåªæå‡ºç»“è®ºï¼š</p><ul>\n<li><strong>æ¸²æŸ“é˜¶æ®µæ˜¯å¼‚æ­¥è¿‡ç¨‹</strong>ï¼Œä¸»è¦è´Ÿè´£<strong>æ›´æ–°è™šæ‹ŸDOM</strong>ï¼ˆ <code>FiberNode</code> ï¼‰æ ‘ï¼Œè€Œä¸ä¼šæ“ä½œçœŸå®DOMï¼Œè¿™ä¸€è¿‡ç¨‹å¯èƒ½ä¼šè¢«Reactæš‚åœå’Œæ¢å¤ï¼Œç”šè‡³å¹¶å‘å¤„ç†ï¼Œå› æ­¤è¦æ±‚æ¸²æŸ“é˜¶æ®µçš„<strong>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å¿…é¡»æ˜¯æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨</strong>ï¼ˆSide-effectï¼‰<strong>çš„çº¯å‡½æ•°</strong>ï¼ˆPure Functionï¼‰ï¼›</li>\n<li><strong>æäº¤é˜¶æ®µæ˜¯åŒæ­¥è¿‡ç¨‹</strong>ï¼Œæ ¹æ®æ¸²æŸ“é˜¶æ®µçš„æ¯”å¯¹ç»“æœä¿®æ”¹çœŸå®DOMï¼Œè¿™ä¸€é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å¯ä»¥åŒ…å«å‰¯ä½œç”¨ã€‚</li>\n</ul><p>è¿™ä¹ˆçœ‹æ¥ï¼Œæ˜¯ä¸æ˜¯ç”¨é»„ç¯ä»£è¡¨æ¸²æŸ“é˜¶æ®µï¼Œå’Œç”¨ç»¿ç¯ä»£è¡¨æäº¤é˜¶æ®µè¿˜æŒºåˆé€‚çš„ï¼Ÿé»„ç¯äº®èµ·ï¼ŒReactä¸ºç»„ä»¶ä»¬è§„åˆ’å¥½å‘è½¦é¡ºåºå’Œè¡Œè½¦è·¯çº¿ï¼Œä¸€æ—¦ç»¿ç¯äº®èµ·ï¼Œç»„ä»¶ä»¬ä¸€ä¸ªä¸ªå†²å‡ºèµ·ç‚¹ï¼Œäº‰å…ˆæåæ¥åˆ°ç”¨æˆ·é¢å‰ï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€äº›ç»„ä»¶åŸåœ°æ‰“è½¬ï¼Œè¿˜æœ‰ä¸€äº›è¢«åŸåœ°æ‹†é™¤â€¦â€¦</p><p>ä¸è¿‡è¦å¼ºè°ƒä¸€ç‚¹ï¼Œä¸ç°å®ä¸­é»„ç¯æ—¶é—´çŸ­ã€ç»¿ç¯æ—¶é—´é•¿ä¸åŒï¼ŒReactçš„æäº¤é˜¶æ®µä¸€èˆ¬ä¼šå¾ˆå¿«ï¼Œä½†æ¸²æŸ“é˜¶æ®µæœ‰å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œè¿™ä¹Ÿæ­£æ˜¯å°†å®ƒå¼‚æ­¥åŒ–çš„åŸå› ã€‚</p><h2>ç”¨Hookså®šä¹‰å‡½æ•°ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h2><p>å‰é¢æˆ‘ä»¬ä»‹ç»äº†ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¹¶ç”¨AntDçš„æºä»£ç åšäº†ä¸€ä¸ªç²—ç•¥çš„ç»Ÿè®¡ï¼Œè¿™æ ·ä½ å¯¹è¿™äº›æ–¹æ³•åº”è¯¥å¤šå°‘æœ‰äº†ä¸€äº›å¥½æ„Ÿã€‚</p><p>ç„¶è€Œåœ¨AntDçš„v4.xç‰ˆæœ¬å°±æ²¡åŠæ³•åšè¿™æ ·çš„ç»Ÿè®¡äº†ï¼Œå› ä¸ºv4.xä¹‹åï¼ŒAntDæºä»£ç å¼€å§‹æ··ç”¨ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„æ¯”ä¾‹é™ä½äº†ï¼Œè½¬è€Œå¤§é‡ä½¿ç”¨Hooksï¼Œä»v4.0.0åˆ°v4.21.6å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨React Hooksçš„ä¸ªæ•°æ›´æ˜¯å¢åŠ äº†4å€ã€‚</p><p>è¿™æ ·çš„å˜åŒ–ä¹Ÿå¾ˆæ­£å¸¸ã€‚æ­£å¦‚è¿™èŠ‚è¯¾å¼€å§‹æ—¶æåˆ°çš„ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸ç­‰åŒäºç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œè™½ç„¶å‡å°‘äº†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ä½¿ç”¨ï¼Œä½†å®ç°ç»„ä»¶çš„åŠŸèƒ½ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¿˜æ˜¯è¦ä¾é ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€‚Reactå‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶å­˜åœ¨æ›¿ä»£å…³ç³»ï¼Œè€Œç›¸å¯¹åº”åœ°ï¼ŒHooksä¹Ÿä¸ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å­˜åœ¨ä¸€å®šçš„æ›¿ä»£å…³ç³»ï¼Œæ‰€ä»¥ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå°±ç”±Hooksæ¥è¡¥ä½äº†ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹Hooksé‡Œæœ‰å“ªäº›APIä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæœ‰å…³ï¼Œä»¥åŠå®ƒä»¬è·Ÿç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯å¦‚ä½•å¯¹åº”çš„ã€‚</p><p>è¯·çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼Œä¹ä¸€çœ‹è·Ÿç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸè¿˜è›®åƒçš„ï¼Œå°¤å…¶æ˜¯æ¸²æŸ“é˜¶æ®µå’Œæäº¤é˜¶æ®µï¼Œä½†ä»”ç»†çœ‹å³ä¾§ï¼Œç»†èŠ‚å·®åˆ«è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/41/f8/41d2498402b49dd3fbbff5108eaa62f8.png?wh=1752x998\" alt=\"\"></p><ol>\n<li>æŒ‚è½½é˜¶æ®µã€‚Reactä¼šæ‰§è¡Œç»„ä»¶å‡½æ•°ï¼Œåœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„ <code>useState</code> ã€ <code>useMemo</code> ç­‰Hooksä¾æ¬¡æŒ‚è½½åˆ°FiberNodeä¸Šï¼ŒuseEffectå…¶å®ä¹Ÿä¼šè¢«æŒ‚è½½ï¼Œä½†å®ƒåŒ…å«çš„å‰¯ä½œç”¨ï¼ˆSide-effectï¼Œåœ¨Fiberå¼•æ“ä¸­ç§°ä¸ºEffectï¼‰ä¼šä¿ç•™åˆ°æäº¤é˜¶æ®µã€‚</li>\n</ol><p>ç»„ä»¶å‡½æ•°çš„è¿”å›å€¼é€šå¸¸ä¼šä½¿ç”¨JSXè¯­æ³•ï¼ŒReactåœ¨æ¸²æŸ“é˜¶æ®µæ ¹æ®è¿”å›å€¼åˆ›å»ºFiberNodeæ ‘ã€‚åœ¨æäº¤é˜¶æ®µï¼ŒReactæ›´æ–°çœŸå®DOMä¹‹å‰ä¼šä¾æ¬¡æ‰§è¡Œå‰é¢å®šä¹‰çš„Effectã€‚</p><ol start=\"2\">\n<li>æ›´æ–°é˜¶æ®µã€‚å½“ç»„ä»¶æ¥æ”¶åˆ°æ–°propsï¼Œè°ƒç”¨ <code>useState</code> è¿”å›çš„ <code>setter</code> æˆ–è€… <code>useReducer</code> è¿”å›çš„ <code>dispatch</code> ä¿®æ”¹äº†çŠ¶æ€ï¼Œç»„ä»¶ä¼šè¿›å…¥æ›´æ–°é˜¶æ®µã€‚ç»„ä»¶å‡½æ•°æœ¬èº«ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼ŒHooksä¼šä¾æ¬¡ä¸FiberNodeä¸Šå·²ç»æŒ‚è½½çš„Hooksä¸€ä¸€åŒ¹é…ï¼Œå¹¶æ ¹æ®éœ€è¦æ›´æ–°ã€‚ç»„ä»¶å‡½æ•°çš„è¿”å›å€¼ç”¨æ¥æ›´æ–°FiberNodeæ ‘ã€‚</li>\n</ol><p>è¿›å…¥æäº¤é˜¶æ®µï¼ŒReactä¼šæ›´æ–°çœŸå®DOMã€‚éšåReactä¼šå…ˆæ‰§è¡Œä¸Šä¸€è½®Effectçš„æ¸…é™¤å‡½æ•°ï¼Œç„¶åå†æ¬¡æ‰§è¡ŒEffectã€‚è¿™é‡Œçš„EffectåŒ…æ‹¬ <code>useEffect</code> ä¸<code>useLayoutEffect</code> ï¼Œä¸¤è€…ç‰¹æ€§å¾ˆç›¸åƒã€‚å…¶ä¸­<code>useLayoutEffect</code> çš„Effectæ˜¯åœ¨æ›´æ–°çœŸå®DOMä¹‹ååŒæ­¥æ‰§è¡Œçš„ï¼Œä¸ç±»ç»„ä»¶çš„ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> æ›´ç›¸ä¼¼ä¸€äº›ï¼›è€Œ <code>useEffect</code> çš„Effectæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä¸€èˆ¬æ™šäº <code>useLayoutEffect</code> ã€‚</p><ol start=\"3\">\n<li>å¸è½½é˜¶æ®µã€‚ä¸»è¦æ˜¯æ‰§è¡ŒEffectçš„æ¸…é™¤å‡½æ•°ã€‚</li>\n</ol><p>å‡½æ•°ç»„ä»¶ä¹Ÿæœ‰é”™è¯¯å¤„ç†é˜¶æ®µï¼Œä½†æ²¡æœ‰å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸHooksï¼Œé”™è¯¯å¤„ç†ä¾èµ–äºçˆ¶ç»„ä»¶æˆ–ç¥–å…ˆç»„ä»¶æä¾›çš„é”™è¯¯è¾¹ç•Œã€‚</p><p>ä»å†…éƒ¨å®ç°æ¥çœ‹ï¼Œç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå·²ç»æœ‰äº†æ¯”è¾ƒå¤§çš„åŒºåˆ«ã€‚æˆ‘ä»¬åœ¨ä¸‹èŠ‚è¯¾ï¼Œä¼šå±•å¼€èŠä¸€ä¸‹ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’ŒHooksçš„ç›¸äº’å¯¹åº”å…³ç³»ã€‚</p><h2>ç”Ÿå‘½å‘¨æœŸçš„å¸¸è§ä½¿ç”¨åœºæ™¯</h2><p>å‰é¢è®²è§£äº†è¿™ä¹ˆå¤šç”Ÿå‘½å‘¨æœŸæ¦‚å¿µå’ŒAPIï¼Œé‚£ä¹ˆå…·ä½“è¯¥ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹å‘¢ï¼Ÿå…¶å®åœ¨å‰é¢ä»‹ç»å•ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–è€…æ˜¯Hooksæ—¶ï¼Œéƒ½ä»‹ç»äº†å®ƒä»¬å„è‡ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯ã€‚è€Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿˜æœ‰ä¸€äº›<strong>ç»„åˆå¤šä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µçš„æ¨¡å¼</strong>ã€‚</p><p>æ¯”å¦‚<strong>â€œåœ¨ç»„ä»¶æŒ‚è½½æ—¶XXXï¼Œå¸è½½æ—¶YYYâ€æ¨¡å¼</strong>ã€‚ç°åœ¨è¯·ä½ è·Ÿç€æˆ‘ï¼Œåˆ©ç”¨è¿™ä¸ªæ¨¡å¼ä¸º <code>oh-my-kanban</code> é¡¹ç›®å¢åŠ ä¸€ä¸ªå°åŠŸèƒ½ï¼š</p><ul>\n<li>ç›®å‰çœ‹æ¿åˆ—çš„å¡ç‰‡å³ä¸‹è§’æ˜¾ç¤ºäº†å¡ç‰‡çš„åˆ›å»ºæ—¶é—´ï¼Œä¸ºçªå‡ºçœ‹æ¿ä½œä¸ºå®æ—¶åä½œå·¥å…·çš„ç‰¹æ€§ï¼Œéœ€è¦æŠŠåˆ›å»ºæ—¶é—´æ”¹ä¸ºç›¸å¯¹æ—¶é—´ï¼Œå³ï¼šâ€œåˆšåˆšâ€ã€â€œ1åˆ†é’Ÿå‰â€ã€â€œ1å°æ—¶å‰â€ã€â€œ1å¤©å‰â€ï¼›</li>\n<li>çœ‹æ¿åœ¨æ— äººæ“ä½œçš„çŠ¶æ€ä¸‹ï¼Œéšç€æ—¶é—´çš„æµé€ï¼Œå¡ç‰‡ä¸Šçš„ç›¸å¯¹æ—¶é—´åº”è‡ªåŠ¨åˆ·æ–°ã€‚</li>\n</ul><p>ä½ è™½ç„¶åœ¨å¿ƒé‡Œåæ§½â€œéš¾é“æ²¡æœ‰å…¶ä»–æ›´é‡è¦çš„éœ€æ±‚äº†å—â€ï¼Œä½†è¿˜æ˜¯è®¤çœŸåœ°åšèµ·äº†éœ€æ±‚åˆ†æã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å®šæ—¶å™¨éœ€æ±‚ï¼Œæ¯å›ºå®šé—´éš”ä¼šè®¾ç½®ä¸€æ¬¡stateã€‚å¯ä»¥é€‰æ‹©ä¸ºæ¯å¼ å¡ç‰‡åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œä¹Ÿå¯ä»¥ä¸ºæ‰€æœ‰å¡ç‰‡åˆ›å»ºä¸€ä¸ªå…±äº«çš„å®šæ—¶å™¨ã€‚æˆ‘ä»¬è¿™é‡Œé€‰æ‹©å‰è€…ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼Œå…ˆå¯¼å…¥ <code>useEffect</code> å‡½æ•°ï¼Œé¡ºä¾¿ä¿®æ­£ä¸€ä¸‹ä¹‹å‰çš„æ—¥æœŸå­—ç¬¦ä¸²æ ¼å¼ï¼Œå¦åˆ™ <code>Date</code> è®¤ä¸å‡ºæ¥ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/77/c3/77ecaab85191f5b8a2b339ecd739bec3.png?wh=1332x376\" alt=\"å›¾ç‰‡\"></p><p>åœ¨<code>KanbanCard</code> ç»„ä»¶å†…å®šä¹‰ä¸€ä¸ªåä¸º <code>displayTime</code> çš„stateã€‚è€Œä½œä¸º <code>useEffect</code> ç¬¬ä¸€ä¸ªå‚æ•°çš„å›è°ƒå‡½æ•°ï¼Œåœ¨ç»„ä»¶é¦–æ¬¡æŒ‚è½½æ—¶ä¼šè¢«è°ƒç”¨ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªå‡½æ•°çš„å†…å®¹æ˜¯æ ¹æ®å¡ç‰‡åˆ›å»ºæ—¶é—´è®¡ç®—ç›¸å¯¹æ—¶é—´ï¼Œå¹¶æ¯åˆ†é’Ÿä¸€æ¬¡è®¾ç½®åˆ° <code>displayTime</code> ä¸Šï¼Œå¡ç‰‡éšå³æ›´æ–°ã€‚</p><p>è¿™ä¸ªå›è°ƒå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸€ä¸ª <code>cleanup</code> å‡½æ•°ï¼Œè´Ÿè´£åœ¨ç»„ä»¶è¢«å¸è½½æ—¶æ¸…é™¤å®šæ—¶å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class=\"language-javascript\">const MINUTE = 60 * 1000;\nconst HOUR = 60 * MINUTE;\nconst DAY = 24 * HOUR;\nconst UPDATE_INTERVAL = MINUTE;\nconst KanbanCard = ({ title, status }) =&gt; {\n  const [displayTime, setDisplayTime] = useState(status);\n  useEffect(() =&gt; {\n    const updateDisplayTime = () =&gt; {\n      const timePassed = new Date() - new Date(status);\n      let relativeTime = 'åˆšåˆš';\n      if (MINUTE &lt;= timePassed &amp;&amp; timePassed &lt; HOUR) {\n        relativeTime = `${Math.ceil(timePassed / MINUTE)} åˆ†é’Ÿå‰`;\n      } else if (HOUR &lt;= timePassed &amp;&amp; timePassed &lt; DAY) {\n        relativeTime = `${Math.ceil(timePassed / HOUR)} å°æ—¶å‰`;\n      } else if (DAY &lt;= timePassed) {\n        relativeTime = `${Math.ceil(timePassed / DAY)} å¤©å‰`;\n      }\n      setDisplayTime(relativeTime);\n    };\n    const intervalId = setInterval(updateDisplayTime, UPDATE_INTERVAL);\n    updateDisplayTime();\n\n    return function cleanup() {\n      clearInterval(intervalId);\n    };\n  }, [status]);\n\n  return (\n    &lt;li css={kanbanCardStyles}&gt;\n      &lt;div css={kanbanCardTitleStyles}&gt;{title}&lt;/div&gt;\n      &lt;div css={css`/*çœç•¥*/`} title={status}&gt;{displayTime}&lt;/div&gt;\n    &lt;/li&gt;\n  );\n};\n</code></pre><p>è¿è¡Œ <code>npm start</code> ï¼Œæµè§ˆå™¨ä¸­æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b9/09/b98c5966e5e483268730d43f8a312209.png?wh=1312x712\" alt=\"å›¾ç‰‡\"></p><p>ä½ å¯ä»¥ç•™æ„ä¸€ä¸‹ï¼Œä¸Šé¢ä»£ç ä¸­ <code>useEffect</code> è¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ˜¯ä¸€ä¸ªåŒ…å« <code>status</code> å±æ€§å€¼çš„æ•°ç»„ï¼Œè¿™ä¸ªå‚æ•°çš„ç”¨é€”æˆ‘ä»¬ä¼šåœ¨ä¸‹èŠ‚è¯¾è®²è§£ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚æ— è®ºæ˜¯ä¼ ç»Ÿçš„ç±»ç»„ä»¶ï¼Œè¿˜æ˜¯åæ¥å±…ä¸Šçš„å‡½æ•°ç»„ä»¶åŠ Hooksï¼Œéƒ½æä¾›äº†ä¸ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„APIï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨è¿™äº›APIä¸ºç»„ä»¶ç¼–å†™äº¤äº’æˆ–è€…ä¸šåŠ¡é€»è¾‘ã€‚</p><p>æˆ‘ä»¬ä»ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å…¥æ‰‹ï¼Œè®²è§£äº†ç»„ä»¶çš„æŒ‚è½½ã€æ›´æ–°ã€å¸è½½ã€é”™è¯¯å¤„ç†å››ä¸ªé˜¶æ®µï¼Œåˆç»“åˆFiberåè°ƒå¼•æ“çš„ç‰¹ç‚¹ï¼Œä»‹ç»äº†æ›´é«˜å±‚æ¬¡çš„æ¸²æŸ“å’Œæäº¤ä¸¤ä¸ªé˜¶æ®µã€‚ç„¶åæˆ‘ä»¬å»¶ç»­è¿™ä¸ªæ€è·¯ï¼Œåˆ†æäº†å‡½æ•°ç»„ä»¶å’ŒHooksçš„ç”Ÿå‘½å‘¨æœŸã€‚ä½œä¸ºå®ä¾‹ï¼Œä½ åˆ©ç”¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå’Œå®šæ—¶å™¨ï¼Œä¸º <code>oh-my-kanban</code> é¡¹ç›®åŠ å…¥äº†ä¸€ä¸ªæ˜¾ç¤ºç›¸å¯¹æ—¶é—´çš„å°åŠŸèƒ½ã€‚</p><p>ä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†æ¥åˆ°ä»¤äººå…´å¥‹çš„Hooksï¼Œåœ¨å­¦ä¹ å‡ ä¸ªå¸¸ç”¨Hooks APIçš„åŒæ—¶ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆHooksåŠ å‡½æ•°ç»„ä»¶ï¼Œèƒ½æ›¿ä»£ç±»ç»„ä»¶æˆä¸ºReactå¼€å‘çš„ä¸»æµæ–¹æ¡ˆã€‚</p><p>æœ€åä¹Ÿé™„ä¸Šæœ¬èŠ‚è¯¾æ‰€æ¶‰åŠçš„é¡¹ç›®æºä»£ç ï¼š<a href=\"https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.8.0\">https://gitee.com/evisong/geektime-column-oh-my-kanban/releases/tag/v0.8.0</a></p><h2>æ€è€ƒé¢˜</h2><p>å‰é¢çš„è¯¾ç¨‹ä¸­æˆ‘ä»¬ä¸€ç›´æåˆ°ç»„ä»¶æ ‘ï¼Œè¿™èŠ‚è¯¾åˆäº†è§£äº†ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œé‚£åœ¨ç»„ä»¶æ ‘ä¸­ï¼Œå­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ€æ ·çš„ï¼Ÿçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶çš„å„ä¸ªç”Ÿå‘½å‘¨æœŸçš„å‘ç”Ÿé¡ºåºåˆæ˜¯æ€æ ·çš„ï¼Ÿ</p><p>æ¬¢è¿æŠŠä½ çš„æƒ³æ³•åˆ†äº«åœ¨è¯„è®ºåŒºï¼Œç›¸ä¿¡ç»è¿‡æ€è€ƒå’Œè¾“å‡ºï¼Œä½ çš„å­¦ä¹ æ•ˆæœä¼šæ›´å¥½ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","comments":[{"had_liked":false,"id":357295,"user_name":"ğŸ‘","can_delete":false,"product_type":"c1","uid":2189689,"ip_address":"åŒ—äº¬","ucode":"DE34B3B14287D1","user_header":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","comment_is_top":true,"comment_ctime":1663140702,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"ä½ å¥½ï¼Œæˆ‘æ˜¯ã€Šç°ä»£React Webå¼€å‘å®æˆ˜ã€‹çš„ç¼–è¾‘è¾°æ´‹ï¼Œè¿™æ˜¯ğŸ‘‡é¡¹ç›®çš„æºä»£ç é“¾æ¥ï¼Œä¾›ä½ å­¦ä¹ ä¸å‚è€ƒï¼š https:&#47;&#47;gitee.com&#47;evisong&#47;geektime-column-oh-my-kanban&#47;releases&#47;tag&#47;v0.8.0","like_count":1},{"had_liked":false,"id":357016,"user_name":"å­¦ä¹ å‰ç«¯-react","can_delete":false,"product_type":"c1","uid":1331001,"ip_address":"å†…è’™å¤","ucode":"6C873AF98F3498","user_header":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1662862954,"is_pvip":false,"replies":[{"id":129970,"content":"ä½ å¥½ï¼ŒGeek_8aba0dï¼Œä½ çš„æ„Ÿè§‰è·Ÿå¾ˆå¤šäººæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬åˆšæ¥è§¦Hooksæ—¶çš„æˆ‘ã€‚\n\nuseEffectçš„è¯¦ç»†å†…å®¹åœ¨åé¢ç¬¬10èŠ‚è¯¾ä¼šè®²ï¼Œåˆ°æ”¾åœ¨è¿™èŠ‚è¯¾æœ‰ç‚¹è¶…çº²ï¼Œä¸è¿‡åœ¨è¿™é‡Œæˆ‘å¯ä»¥å…ˆå‰§é€ä¸€ä¸‹ã€‚\n\nè¿™é‡Œä¹‹æ‰€ä»¥å¤§å®¶ä¼šè®¤ä¸ºåç›´è§‰ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºå¤§å®¶æŠŠcomponentDidMount å’Œ componentWillUnmount è¿™ä¸€å¯¹ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å½“ä½œäº†å‚ç…§ç‰©ã€‚å¦‚æœè¿™æ ·çœ‹çš„è¯ï¼Œä»¿ä½›æ˜¯åœ¨è¯´åŒä¸€ä¸ªç»„ä»¶çš„ componentWillUnmount å‘ç”Ÿåœ¨äº† componentDidMount ä¹‹å‰ï¼Œä¸åˆé€»è¾‘ï¼Œç†åº”å‡ºé”™çš„ã€‚\n\næˆ‘å»ºè®®è¿™é‡Œå…ˆæš‚æ—¶ä¸è¦è€ƒè™‘ç±»ç»„ä»¶ï¼Œç›´æ¥ç”¨å‰¯ä½œç”¨è¿™ä¸ªæ¦‚å¿µæ¥ç†è§£ã€‚useEffectä¸ºå‡½æ•°ç»„ä»¶å£°æ˜äº†å‰¯ä½œç”¨ï¼Œåœ¨ä¸åŠ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–å€¼æ•°ç»„ï¼‰çš„å‰æä¸‹ï¼Œæ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œï¼Œå³æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šäº§ç”Ÿæ–°çš„å‰¯ä½œç”¨ï¼ˆåŒ…å«æ–°çš„é—­åŒ…ï¼‰ï¼Œå¹¶ç•™åˆ°è¿™æ¬¡çš„æäº¤é˜¶æ®µæ‰§è¡Œï¼Œå½“æ‰§è¡Œçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯è¿™æ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ã€‚\n\nå¦‚ç¬¬Næ¬¡æ¸²æŸ“ï¼Œå°±ä¼šåœ¨æäº¤é˜¶æ®µæ‰§è¡Œç¬¬Næ¬¡å‰¯ä½œç”¨ï¼Œè¿”å›ç¬¬Næ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ï¼›ä¸‹æ¬¡ç¬¬N+1æ¬¡æ¸²æŸ“ï¼Œä¼šåœ¨æäº¤é˜¶æ®µå…ˆæ‰§è¡Œç¬¬Næ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ï¼Œç„¶åæ‰æ˜¯æ‰§è¡Œç¬¬N+1æ¬¡å‰¯ä½œç”¨ï¼Œè¿”å›ç¬¬N+1æ¬¡çš„æ¸…ç†å‡½æ•°ï¼›ä»¥æ­¤ç±»æ¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1662976161,"ip_address":"å†…è’™å¤","comment_id":357016,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"ä½ å¥½ï¼Œ&quot;è¿›å…¥æäº¤é˜¶æ®µï¼ŒReact ä¼šå…ˆæ‰§è¡Œ Effect çš„æ¸…ç†å‡½æ•°ï¼Œç„¶åå†æ¬¡æ‰§è¡Œ Effectã€‚&quot;\næ²¡ç†è§£è¿™é‡Œä¸ºå•¥è¦effect çš„æ¸…ç†å‡½æ•°ï¼Œç„¶åæ‰§è¡ŒEffectï¼Œå¾ˆåç›´è§‰ã€‚æ˜¯ä¸ºäº†æ‰§è¡Œåäº§ç”Ÿç¬¦åˆé¢„æœŸçš„å€¼å—ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587324,"discussion_content":"ä½ å¥½ï¼ŒGeek_8aba0dï¼Œä½ çš„æ„Ÿè§‰è·Ÿå¾ˆå¤šäººæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬åˆšæ¥è§¦Hooksæ—¶çš„æˆ‘ã€‚\n\nuseEffectçš„è¯¦ç»†å†…å®¹åœ¨åé¢ç¬¬10èŠ‚è¯¾ä¼šè®²ï¼Œåˆ°æ”¾åœ¨è¿™èŠ‚è¯¾æœ‰ç‚¹è¶…çº²ï¼Œä¸è¿‡åœ¨è¿™é‡Œæˆ‘å¯ä»¥å…ˆå‰§é€ä¸€ä¸‹ã€‚\n\nè¿™é‡Œä¹‹æ‰€ä»¥å¤§å®¶ä¼šè®¤ä¸ºåç›´è§‰ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºå¤§å®¶æŠŠcomponentDidMount å’Œ componentWillUnmount è¿™ä¸€å¯¹ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å½“ä½œäº†å‚ç…§ç‰©ã€‚å¦‚æœè¿™æ ·çœ‹çš„è¯ï¼Œä»¿ä½›æ˜¯åœ¨è¯´åŒä¸€ä¸ªç»„ä»¶çš„ componentWillUnmount å‘ç”Ÿåœ¨äº† componentDidMount ä¹‹å‰ï¼Œä¸åˆé€»è¾‘ï¼Œç†åº”å‡ºé”™çš„ã€‚\n\næˆ‘å»ºè®®è¿™é‡Œå…ˆæš‚æ—¶ä¸è¦è€ƒè™‘ç±»ç»„ä»¶ï¼Œç›´æ¥ç”¨å‰¯ä½œç”¨è¿™ä¸ªæ¦‚å¿µæ¥ç†è§£ã€‚useEffectä¸ºå‡½æ•°ç»„ä»¶å£°æ˜äº†å‰¯ä½œç”¨ï¼Œåœ¨ä¸åŠ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–å€¼æ•°ç»„ï¼‰çš„å‰æä¸‹ï¼Œæ¯æ¬¡ç»„ä»¶æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œï¼Œå³æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šäº§ç”Ÿæ–°çš„å‰¯ä½œç”¨ï¼ˆåŒ…å«æ–°çš„é—­åŒ…ï¼‰ï¼Œå¹¶ç•™åˆ°è¿™æ¬¡çš„æäº¤é˜¶æ®µæ‰§è¡Œï¼Œå½“æ‰§è¡Œçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯è¿™æ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ã€‚\n\nå¦‚ç¬¬Næ¬¡æ¸²æŸ“ï¼Œå°±ä¼šåœ¨æäº¤é˜¶æ®µæ‰§è¡Œç¬¬Næ¬¡å‰¯ä½œç”¨ï¼Œè¿”å›ç¬¬Næ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ï¼›ä¸‹æ¬¡ç¬¬N+1æ¬¡æ¸²æŸ“ï¼Œä¼šåœ¨æäº¤é˜¶æ®µå…ˆæ‰§è¡Œç¬¬Næ¬¡å‰¯ä½œç”¨çš„æ¸…ç†å‡½æ•°ï¼Œç„¶åæ‰æ˜¯æ‰§è¡Œç¬¬N+1æ¬¡å‰¯ä½œç”¨ï¼Œè¿”å›ç¬¬N+1æ¬¡çš„æ¸…ç†å‡½æ•°ï¼›ä»¥æ­¤ç±»æ¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1662976161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357027,"user_name":"å­¦ä¹ å‰ç«¯-react","can_delete":false,"product_type":"c1","uid":1331001,"ip_address":"å†…è’™å¤","ucode":"6C873AF98F3498","user_header":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1662868614,"is_pvip":false,"replies":[{"id":129968,"content":"ä½ å¥½ï¼ŒGeek_8aba0dï¼Œéå¸¸æ£’çš„ç­”æ¡ˆã€‚\n\nçˆ¶å­ç»„ä»¶å‡ä¸ºç±»ç»„ä»¶æ—¶ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„æ‰§è¡Œé¡ºåºæ­£å¦‚ä½ æ‰€æè¿°çš„ã€‚è‡³äºå‡½æ•°ç»„ä»¶+Hooksï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥åŠ å…¥ä¸€äº›useEffectï¼ˆè™½ç„¶ç¬¬10èŠ‚è¯¾æ‰ä¼šè®²ï¼‰æ‰“console.logæ¥è§‚å¯Ÿä¸€ä¸‹ã€‚\n\nFiberåè°ƒå¼•æ“é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ï¼Œæˆ‘äº‰å–åœ¨æœ€è¿‘çš„è¯¾ç¨‹åŠ é¤ä¸­å®‰æ’è¿›æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1662974837,"ip_address":"å†…è’™å¤","comment_id":357027,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"é™„å’Œï¼ä¹‹å‰å¸¸è§åœ¨vue2ä¸­ç»å¸¸ä¼šå»ç†è§£çˆ¶å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ‰§è¡Œé¡ºåºã€‚å¦‚createdï¼ˆçˆ¶ï¼‰ - createdï¼ˆå­ï¼‰- mountedï¼ˆå­ï¼‰- createdï¼ˆçˆ¶ï¼‰ã€‚å¯¹äºreact  created ä»£è¡¨renderå‰ï¼Œmounted ä»£è¡¨renderåã€‚æ‰€ä»¥react ç”Ÿå‘½å‘¨æœŸçš„æ‰§è¡Œé¡ºåºä¸ºã€‚\n\nclass ç»„ä»¶ï¼š\nconstructorï¼ˆçˆ¶ï¼‰ - render (çˆ¶) - constructorï¼ˆå­ï¼‰ - render(å­) - componentdidmountedï¼ˆå­ï¼‰- ComponentDidMountedï¼ˆçˆ¶ï¼‰ã€‚\nhooks ç»„ä»¶ï¼šç”Ÿå‘½å‘¨æœŸä¸æ˜¾ã€‚","like_count":4,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587318,"discussion_content":"ä½ å¥½ï¼ŒGeek_8aba0dï¼Œéå¸¸æ£’çš„ç­”æ¡ˆã€‚\n\nçˆ¶å­ç»„ä»¶å‡ä¸ºç±»ç»„ä»¶æ—¶ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„æ‰§è¡Œé¡ºåºæ­£å¦‚ä½ æ‰€æè¿°çš„ã€‚è‡³äºå‡½æ•°ç»„ä»¶+Hooksï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥åŠ å…¥ä¸€äº›useEffectï¼ˆè™½ç„¶ç¬¬10èŠ‚è¯¾æ‰ä¼šè®²ï¼‰æ‰“console.logæ¥è§‚å¯Ÿä¸€ä¸‹ã€‚\n\nFiberåè°ƒå¼•æ“é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ï¼Œæˆ‘äº‰å–åœ¨æœ€è¿‘çš„è¯¾ç¨‹åŠ é¤ä¸­å®‰æ’è¿›æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662974837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1331001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","nickname":"å­¦ä¹ å‰ç«¯-react","note":"","ucode":"6C873AF98F3498","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587973,"discussion_content":"andï¼Œæˆ‘çœ‹ä¸Šé¢çš„hooks æ‰§è¡Œæµç¨‹å›¾æ—¶ï¼Œå‘ç°Effect æ˜¯åœ¨å®é™…æ›´æ–°DOMä¹‹å‰ï¼Œä½†æˆ‘é€šè¿‡æ‰“å°å‘ç°Effectæ˜¯å¯ä»¥æ‰“å°å‡ºæ¥çœŸå®DOMçš„ã€‚æ‰€ä»¥çœŸå®DOMæ¸²æŸ“ä¹‹åã€‚ä¸”useLayoutEffect æ˜¯åœ¨useEffect ä¹‹å‰æ‰“å°ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663413724,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1331001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","nickname":"å­¦ä¹ å‰ç«¯-react","note":"","ucode":"6C873AF98F3498","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587970,"discussion_content":"å¯¹äºhooksæ¥è¯´ï¼Œå…¶å®æ²¡æœ‰å¼ºå£°æ˜å‘¨æœŸçš„æ¦‚å¿µï¼ŒuseEffect /useLayoutEffect é‡Œå¯ä»¥æ¨¡æ‹Ÿç»„ä»¶çš„ componentDidMounted ï¼ˆrenderåï¼‰ å’Œ componentWillUnMount ï¼ˆå¸è½½å‰ï¼‰ã€‚ä½†æ˜¯åˆä¸å¤ªä¸€æ ·çš„æ˜¯ï¼Œæ¯æ¬¡effect çš„å‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œä¹‹å‰éƒ½ä¼šå»æ‰§è¡Œä»¥ä¸‹é”€æ¯å‡½æ•°ï¼ˆcleanup functionï¼‰ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1663411639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370835,"user_name":"æ—åäºŒXII","can_delete":false,"product_type":"c1","uid":1375054,"ip_address":"åŒ—äº¬","ucode":"0C52FB9925A78C","user_header":"https://static001.geekbang.org/account/avatar/00/14/fb/4e/6762d56f.jpg","comment_is_top":false,"comment_ctime":1679309902,"is_pvip":true,"replies":[{"id":139723,"content":"ä½ å¥½ï¼Œæ—åäºŒXIIï¼Œæ„Ÿè°¢æ¨èã€‚Reactæ–°ç‰ˆå®˜æ–¹æ–‡æ¡£çš„è´¨é‡éå¸¸é«˜ï¼Œæˆ‘æ¨èå¤§å®¶æœ‰æœºä¼šéƒ½å»è¯»ä¸€è¯»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1699159268,"ip_address":"åŒ—äº¬","comment_id":370835,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100119601,"comment_content":"https:&#47;&#47;react.dev&#47;learn&#47;render-and-commit\nç»“åˆreactæ–°ç‰ˆæ–‡æ¡£, å¯ä»¥æ›´å®¹æ˜“ç†è§£å‡½æ•°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ","like_count":2,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630973,"discussion_content":"ä½ å¥½ï¼Œæ—åäºŒXIIï¼Œæ„Ÿè°¢æ¨èã€‚Reactæ–°ç‰ˆå®˜æ–¹æ–‡æ¡£çš„è´¨é‡éå¸¸é«˜ï¼Œæˆ‘æ¨èå¤§å®¶æœ‰æœºä¼šéƒ½å»è¯»ä¸€è¯»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699159268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":361622,"user_name":"CondorHero","can_delete":false,"product_type":"c1","uid":1528334,"ip_address":"åŒ—äº¬","ucode":"BD850FE812D22F","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/0e/c5ff46d2.jpg","comment_is_top":false,"comment_ctime":1667715909,"is_pvip":false,"replies":[{"id":131609,"content":"ä½ å¥½ï¼ŒCondorHeroï¼Œæ”¶åˆ°ï¼Œçœ‹æ¥æ–‡ç¨¿é‡Œåº”è¯¥ç”¨å…¨å°å†™çš„â€œantdâ€ï¼Œè°¢è°¢æŒ‡æ­£ã€‚æˆ‘å’Œä¸“æ ç¼–è¾‘å…ˆè®°å½•ä¸€ä¸‹ï¼Œä¸‹æ¬¡ä¸€èµ·æ›´æ–°æ–‡ç¨¿ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1667886678,"ip_address":"åŒ—äº¬","comment_id":361622,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"antd å†™æ³•è¯´æ˜ï¼Œæ¥è‡ªå®˜ç½‘\n\nHow to spell Ant Design correctly?#\nâœ… Ant Design: Capitalized with space, for the design language.\n\nâœ… antd: all lowercase, for the React UI library.\n\nâœ… ant.designï¼šFor ant.design website url.\n\nHere are some typical wrong examples:\n\nâŒ AntD\n\nâŒ antD\n\nâŒ Antd\n\nâŒ ant design\n\nâŒ AntDesign\n\nâŒ antdesign\n\nâŒ Antdesign","like_count":2,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":593007,"discussion_content":"ä½ å¥½ï¼ŒCondorHeroï¼Œæ”¶åˆ°ï¼Œçœ‹æ¥æ–‡ç¨¿é‡Œåº”è¯¥ç”¨å…¨å°å†™çš„â€œantdâ€ï¼Œè°¢è°¢æŒ‡æ­£ã€‚æˆ‘å’Œä¸“æ ç¼–è¾‘å…ˆè®°å½•ä¸€ä¸‹ï¼Œä¸‹æ¬¡ä¸€èµ·æ›´æ–°æ–‡ç¨¿ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1667886678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357747,"user_name":"01","can_delete":false,"product_type":"c1","uid":1120612,"ip_address":"åŒ—äº¬","ucode":"3229D8F060AFEC","user_header":"https://static001.geekbang.org/account/avatar/00/11/19/64/6f2b7b86.jpg","comment_is_top":false,"comment_ctime":1663596364,"is_pvip":false,"replies":[{"id":130401,"content":"ä½ å¥½ï¼Œ01ï¼Œä½ è¯´å¾—å¯¹ã€‚åœ¨Fiberåè°ƒå¼•æ“ä¸­ï¼ŒçœŸæ­£ä¸»å¯¼çš„ç”Ÿå‘½å‘¨æœŸå…¶å®å°±æ˜¯æ¸²æŸ“é˜¶æ®µå’Œæäº¤é˜¶æ®µï¼Œæ‰€æœ‰ç»„ä»¶å®Œæˆæ¸²æŸ“é˜¶æ®µæ‰èƒ½è¿›å…¥æäº¤é˜¶æ®µï¼Œå®Œæˆæäº¤é˜¶æ®µæ‰è¿›å…¥ä¸‹ä¸€è½®æ¸²æŸ“é˜¶æ®µã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œä¼ ç»Ÿçš„æŒ‚è½½ã€æ›´æ–°ã€å¸è½½ä¸‰ä¸ªç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨çˆ¶å­ç»„ä»¶é—´ç¡®å®æ˜¯äº¤å‰è¿›è¡Œçš„ã€‚\n\nä¸è¿‡å¦‚æœæŠŠè§†è§’æ”¾å›å•ä¸ªç»„ä»¶ä¸Šï¼ŒæŒ‚è½½ã€æ›´æ–°ã€å¸è½½ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥å¯¹åº”åˆ°ä¸å°‘Fiberåœ¨ç»„ä»¶å±‚é¢çš„å†…éƒ¨å®ç°ï¼Œè¿˜æ˜¯æœ‰æŒæ¡çš„å¿…è¦çš„ã€‚\n\næ­£å¦‚ä½ æ‰€è¯´ï¼Œåœ¨æäº¤é˜¶æ®µï¼ŒuseLayoutEffectçš„å‰¯ä½œç”¨å›è°ƒå’Œæ¸…é™¤å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œè€ŒuseEffectçš„çš„å‰¯ä½œç”¨å›è°ƒå’Œæ¸…é™¤å‡½æ•°æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚æˆ‘å·²ç»æ›´æ–°äº†æ–‡ç¨¿ä¸­çš„é…å›¾ï¼Œè™½ç„¶ä¾æ—§çœç•¥äº†ä¸€äº›ç»†èŠ‚ï¼Œä½†æ¯”ä¹‹å‰çš„ç‰ˆæœ¬æ›´å‡†ç¡®åœ°è¡¨è¾¾äº†useEffectæ‰§è¡Œçš„æ—¶æœºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1664210679,"ip_address":"åŒ—äº¬","comment_id":357747,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ˜¯äº¤å‰è¿›è¡Œçš„ï¼Œ useLayoutEffect å’Œ useEffect å…¶å®ä¸å¤ªä¸€æ ·ï¼Œ useEffectå…¶å®æ˜¯å¼‚æ­¥çš„","like_count":0,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588918,"discussion_content":"ä½ å¥½ï¼Œ01ï¼Œä½ è¯´å¾—å¯¹ã€‚åœ¨Fiberåè°ƒå¼•æ“ä¸­ï¼ŒçœŸæ­£ä¸»å¯¼çš„ç”Ÿå‘½å‘¨æœŸå…¶å®å°±æ˜¯æ¸²æŸ“é˜¶æ®µå’Œæäº¤é˜¶æ®µï¼Œæ‰€æœ‰ç»„ä»¶å®Œæˆæ¸²æŸ“é˜¶æ®µæ‰èƒ½è¿›å…¥æäº¤é˜¶æ®µï¼Œå®Œæˆæäº¤é˜¶æ®µæ‰è¿›å…¥ä¸‹ä¸€è½®æ¸²æŸ“é˜¶æ®µã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œä¼ ç»Ÿçš„æŒ‚è½½ã€æ›´æ–°ã€å¸è½½ä¸‰ä¸ªç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨çˆ¶å­ç»„ä»¶é—´ç¡®å®æ˜¯äº¤å‰è¿›è¡Œçš„ã€‚\n\nä¸è¿‡å¦‚æœæŠŠè§†è§’æ”¾å›å•ä¸ªç»„ä»¶ä¸Šï¼ŒæŒ‚è½½ã€æ›´æ–°ã€å¸è½½ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå¯ä»¥å¯¹åº”åˆ°ä¸å°‘Fiberåœ¨ç»„ä»¶å±‚é¢çš„å†…éƒ¨å®ç°ï¼Œè¿˜æ˜¯æœ‰æŒæ¡çš„å¿…è¦çš„ã€‚\n\næ­£å¦‚ä½ æ‰€è¯´ï¼Œåœ¨æäº¤é˜¶æ®µï¼ŒuseLayoutEffectçš„å‰¯ä½œç”¨å›è°ƒå’Œæ¸…é™¤å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œè€ŒuseEffectçš„çš„å‰¯ä½œç”¨å›è°ƒå’Œæ¸…é™¤å‡½æ•°æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚æˆ‘å·²ç»æ›´æ–°äº†æ–‡ç¨¿ä¸­çš„é…å›¾ï¼Œè™½ç„¶ä¾æ—§çœç•¥äº†ä¸€äº›ç»†èŠ‚ï¼Œä½†æ¯”ä¹‹å‰çš„ç‰ˆæœ¬æ›´å‡†ç¡®åœ°è¡¨è¾¾äº†useEffectæ‰§è¡Œçš„æ—¶æœºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664210679,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356836,"user_name":"èˆ¹é•¿","can_delete":false,"product_type":"c1","uid":3170712,"ip_address":"å†…è’™å¤","ucode":"EBC0CCDB341E35","user_header":"https://static001.geekbang.org/account/avatar/00/30/61/98/0d6b499d.jpg","comment_is_top":false,"comment_ctime":1662627462,"is_pvip":false,"replies":[{"id":129967,"content":"ä½ å¥½ï¼Œèˆ¹é•¿ï¼Œä½ çš„ç†è§£ä»æ¦‚å¿µä¸Šæ˜¯å¯¹çš„ã€‚çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–Hooksçš„æ‰§è¡Œéµå®ˆè¿™ä¸ªé¡ºåºã€‚Fiberåè°ƒå¼•æ“é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ï¼Œæˆ‘äº‰å–åœ¨æœ€è¿‘çš„è¯¾ç¨‹åŠ é¤ä¸­å®‰æ’è¿›æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1033973,"ctime":1662974394,"ip_address":"å†…è’™å¤","comment_id":356836,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"æ€è€ƒé¢˜ï¼šæœ‰ç‚¹æœ¦èƒ§çš„æ„Ÿè§‰ï¼Œæ„Ÿè§‰æ˜¯åƒé€’å½’é‚£æ ·ï¼Œçˆ¶ç»„ä»¶é‡åˆ°å­ç»„ä»¶ï¼Œå…ˆæ‰§è¡Œå­ç»„ä»¶ï¼Œç­‰å­ç»„ä»¶æ‰§è¡Œå®Œäº†å†å»æ‰§è¡Œçˆ¶ç»„ä»¶","like_count":0,"discussions":[{"author":{"id":1033973,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c6/f5/dae613e0.jpg","nickname":"å®‹ä¸€ç®","note":"","ucode":"55E5B710556C1E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587314,"discussion_content":"ä½ å¥½ï¼Œèˆ¹é•¿ï¼Œä½ çš„ç†è§£ä»æ¦‚å¿µä¸Šæ˜¯å¯¹çš„ã€‚çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–Hooksçš„æ‰§è¡Œéµå®ˆè¿™ä¸ªé¡ºåºã€‚Fiberåè°ƒå¼•æ“é‡Œæœ‰ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚ï¼Œæˆ‘äº‰å–åœ¨æœ€è¿‘çš„è¯¾ç¨‹åŠ é¤ä¸­å®‰æ’è¿›æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662974394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å†…è’™å¤","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1331001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4f/39/791d0f5e.jpg","nickname":"å­¦ä¹ å‰ç«¯-react","note":"","ucode":"6C873AF98F3498","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587181,"discussion_content":"åŠ 1","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1662868548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³å—","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":384877,"user_name":"momo","can_delete":false,"product_type":"c1","uid":3789448,"ip_address":"å¹¿ä¸œ","ucode":"2A1D9A9F621211","user_header":"https://static001.geekbang.org/account/avatar/00/39/d2/88/7ea5d21b.jpg","comment_is_top":false,"comment_ctime":1701739077,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"è€å¸ˆèƒ½è®²ä¸‹ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼ˆSide-effectï¼‰å—ï¼ŸåŒ…å«å“ªäº›ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1072798,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5e/9e/43a604b1.jpg","nickname":"Mttao","note":"","ucode":"7BFC712BBD405D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649442,"discussion_content":"å¾€åé¢çœ‹çš„çŸ¥é“ï¼Œç¬¬10èŠ‚æœ‰è§£é‡Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723382912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":370833,"user_name":"æ—åäºŒXII","can_delete":false,"product_type":"c1","uid":1375054,"ip_address":"åŒ—äº¬","ucode":"0C52FB9925A78C","user_header":"https://static001.geekbang.org/account/avatar/00/14/fb/4e/6762d56f.jpg","comment_is_top":false,"comment_ctime":1679309859,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":1,"score":2,"product_id":100119601,"comment_content":"https:&#47;&#47;react.dev&#47;learn&#47;render-and-commit","like_count":0},{"had_liked":false,"id":368744,"user_name":"æ½®æ±","can_delete":false,"product_type":"c1","uid":1042208,"ip_address":"å¹¿ä¸œ","ucode":"F5E4F6DF9CEA9E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e7/20/70a95f94.jpg","comment_is_top":false,"comment_ctime":1676634946,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100119601,"comment_content":"ç»„ä»¶å‡½æ•°çš„è¿”å›å€¼é€šå¸¸ä¼šä½¿ç”¨ JSX è¯­æ³•ï¼ŒReact åœ¨æ¸²æŸ“é˜¶æ®µæ ¹æ®è¿”å›å€¼åˆ›å»º FiberNode æ ‘ã€‚åœ¨æäº¤é˜¶æ®µï¼ŒReact æ›´æ–°çœŸå® DOM ä¹‹å‰ä¼šä¾æ¬¡æ‰§è¡Œå‰é¢å®šä¹‰çš„ Effectã€‚\n\nè¯·é—®è€å¸ˆï¼Œè¿™å¥è¯æœ€åè¯´åœ¨Reactæ›´æ–°çœŸæ˜¯DOMä¹‹å‰ä¾æ¬¡æ‰§è¡Œå‰é¢å®šä¹‰çš„Effectï¼Œä¸æ˜¯åº”è¯¥åœ¨æ›´æ–°DOMä¹‹åå—ï¼ˆæŒ‰ç…§å›¾ä¸­æ‰€ç¤ºï¼‰","like_count":0},{"had_liked":false,"id":367072,"user_name":"æ–©å°½æ»¡é™¢æ¡ƒèŠ±","can_delete":false,"product_type":"c1","uid":2749115,"ip_address":"æ²³å—","ucode":"2BEA98FB669172","user_header":"https://static001.geekbang.org/account/avatar/00/29/f2/bb/28727280.jpg","comment_is_top":false,"comment_ctime":1674892957,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100119601,"comment_content":"è€å¸ˆï¼Œæœ‰ç‚¹ä¸å¤ªç†è§£æ–‡ç¨¿ä¸­â€œå…¶ä¸­useLayoutEffect çš„ Effect æ˜¯åœ¨æ›´æ–°çœŸå® DOM ä¹‹ååŒæ­¥æ‰§è¡Œçš„ï¼Œä¸ç±»ç»„ä»¶çš„ componentDidMountã€componentDidUpdate æ›´ç›¸ä¼¼ä¸€äº›ï¼›è€Œ useEffect çš„ Effect æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä¸€èˆ¬æ™šäº useLayoutEffect ã€‚â€è¿™å¥è¯é‡Œæåˆ°çš„useLayoutEffectæ˜¯åœ¨çœŸå®domä¹‹ååŒæ­¥æ‰§è¡Œï¼ŒuseEffectæ˜¯å¼‚æ­¥çš„æ˜¯ä»€ä¹ˆæ„æ€","like_count":0},{"had_liked":false,"id":361621,"user_name":"CondorHero","can_delete":false,"product_type":"c1","uid":1528334,"ip_address":"ä¸Šæµ·","ucode":"BD850FE812D22F","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/0e/c5ff46d2.jpg","comment_is_top":false,"comment_ctime":1667715287,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100119601,"comment_content":"antd åº”è¯¥å…¨éƒ¨å°å†™ï¼Œå‚è€ƒå…¶å®˜ç½‘ã€‚","like_count":0}]}