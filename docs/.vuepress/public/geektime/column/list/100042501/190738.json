{"id":190738,"title":"春节策划丨快来挑战一下自己的分析逻辑吧！","content":"<p>Hi，我之前给你出了一套试卷，不知道你答得怎么样了呢？</p><p>今天我们继续来挑战！</p><p>在性能测试分析的过程中，有两个关键点是做分析的人必须要关注的，第一点就是，在压力工具执行完成之后，要学会判断瓶颈是否出现，以及是否应该继续加压。其次，在分析中，要学会分段会层，如果发现是某个节点出现了问题，就要学会从已有问题的计数器顺藤摸瓜找到具体的证据链。</p><p>要想做到这一点，就需要有基础知识的积累和清晰的判断思路。</p><p>鉴于此，选择题之外，我又想了两道主观题，帮助你复习一下我们之前讲到的核心思路。</p><ol>\n<li>从压力工具中的响应时间和TPS图，如何判断出性能瓶颈？说明判断逻辑。</li>\n<li>从操作系统的us CPU高或者wa CPU高，如何判断出根本原因，请画出你的分析逻辑证据链。</li>\n</ol><p>你可以从专栏的第2篇、第6篇和第17篇找到相关的线索。</p><p>这是一个可简单、可复杂的主观题。在面试中，我经常会问到这样的问题，一般来说，回答都会反应出面试者的综合能力。有的人可能三两句就说完了，那显然功底不够，而有的人会有很多的经验可以分享，逻辑清晰。本专栏从前到后都在描述着一个完整的分析蓝图，而这个蓝图就是靠证据链来完成的。</p><p>所以对这个题目的回答就体现了你对性能分析理念的理解程度。</p><!-- [[[read_end]]] --><p>把你想到的判断逻辑放到GitHub上吧！我会查看这些答案，与你一起交流！</p>","comments":[{"had_liked":false,"id":272320,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1610029433,"is_pvip":true,"replies":[{"id":"98732","content":"非专业都说得这么专业了。专业的得抓紧学习了。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1610033815,"ip_address":"","comment_id":272320,"utype":1}],"discussion_count":2,"race_medal":1,"score":"10199964025","product_id":100042501,"comment_content":"1: TPS 不再增加，响应时间随着线程数增加而增加，最后可能超时<br>2: CPU 使用率过高，应该先找到是哪个进程占用的CPU 过高，然后在排查进程对应的具体代码逻辑<br><br>&gt; 非专业性能测试工程师的思路","like_count":3,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513236,"discussion_content":"非专业都说得这么专业了。专业的得抓紧学习了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610033815,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2664463,"avatar":"https://static001.geekbang.org/account/avatar/00/28/a8/0f/689cb851.jpg","nickname":"王欣","note":"","ucode":"8D4D2CF85E8B3D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381822,"discussion_content":"这里的us高还是跟你并发送多少有一定关系，当然并发数低的时候us高大概率是代码问题比如递归深、循环层次多等等问题  不知道这样的说法正确不？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625225537,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346010,"user_name":"hello. world","can_delete":false,"product_type":"c1","uid":1410056,"ip_address":"","ucode":"3579A0BE22C0A8","user_header":"https://static001.geekbang.org/account/avatar/00/15/84/08/c88a9683.jpg","comment_is_top":false,"comment_ctime":1652764900,"is_pvip":false,"replies":[{"id":"126617","content":"还是写了很多尝试的理解，就是需要动手实操了。","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1653834495,"ip_address":"","comment_id":346010,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652764900","product_id":100042501,"comment_content":"1.系统的吞吐能力取决于Tps，如果压力工具中的Tps下降，并不代表系统的处理能力下降，而是说明系统的处理能力达到瓶颈，系统每秒能处理的事物数就这么多，压力增长请求的事物在排队处理，就会导致响应时间变长。和游泳池排水是一样的道理，泳池代表的是压力源，排水管代表系统的处理能力最大Tps，每秒能排出的水量就只有这么多，如果要把所有的水排干，泳池里面的水只能排队处理，造成响应处理的时间长，想要快速排水减少响应处理时间，可以增加排水口，这就是性能调优。<br><br>2.top命令查看us CPU 高或者 wa CPU 高，可以了解到这个系统可能是属于Cpu计算型的系统，wa Cpu高存在磁盘的读写wait时间长，可以排查下句柄数上下文的切换，或者看下磁盘是否需要扩容，如果都不存在问题得查看程序进程再具体分析了。<br><br>受限于经验和知识能力只能片面的回答，希望老师可以解决相关疑惑。","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574112,"discussion_content":"还是写了很多尝试的理解，就是需要动手实操了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653834495,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":346004,"user_name":"hello. world","can_delete":false,"product_type":"c1","uid":1410056,"ip_address":"","ucode":"3579A0BE22C0A8","user_header":"https://static001.geekbang.org/account/avatar/00/15/84/08/c88a9683.jpg","comment_is_top":false,"comment_ctime":1652763109,"is_pvip":false,"replies":[{"id":"126616","content":"好像说的是对的呀。 ","user_name":"作者回复","user_name_real":"编辑","uid":"1785562","ctime":1653834428,"ip_address":"","comment_id":346004,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652763109","product_id":100042501,"comment_content":"1.系统的吞吐能力取决于Tps，如果压力工具中TPS下降，并不代表服务器处理能力下降，而是说明系统的处理能力已经达到了瓶颈，每秒处理的事物数就这么多。当系统处于瓶颈时随着压力的增长系统保持最大的Tps处理这些事物，剩余未处理完的事物(请求)在排队处理，造成响应时间也增长","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574111,"discussion_content":"好像说的是对的呀。 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653834428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280724,"user_name":"bolo","can_delete":false,"product_type":"c1","uid":1357170,"ip_address":"","ucode":"7C91CEA2F1970E","user_header":"https://static001.geekbang.org/account/avatar/00/14/b5/72/bb10f3d0.jpg","comment_is_top":false,"comment_ctime":1614327801,"is_pvip":false,"replies":[{"id":"103250","content":"wa cpu理解上有点问题。这个计数器只是说cpu等io的周期。","user_name":"作者回复","user_name_real":"高楼(Zee)","uid":"1785562","ctime":1616422843,"ip_address":"","comment_id":280724,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614327801","product_id":100042501,"comment_content":"1、结合TPS曲线去，响应时间图，及线程数图分析。当TPS随着线程不再增加，而响应时间一直再正大，则表示系统已经达到了瓶颈。<br><br>2、us cpu 代表的是用户占用的CPU大小<br>wa  cpu 代表是等待用户输入输出的占用空间大小。<br><br>wa 过高是指等待CPU等待磁盘写入的时间过久，表示磁盘繁忙，这样用服务器就无法处理其他的业务请求了。<br>","like_count":0,"discussions":[{"author":{"id":1785562,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/da/e686a72b.jpg","nickname":"高楼(Zee)","note":"","ucode":"149202404A5ABC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516192,"discussion_content":"wa cpu理解上有点问题。这个计数器只是说cpu等io的周期。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616422843,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}