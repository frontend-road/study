{"id":120160,"title":"39 | æ•°æ®åº“å‚æ•°è®¾ç½®ä¼˜åŒ–ï¼Œå¤±ä¹‹æ¯«å˜å·®ä¹‹åƒé‡Œ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>MySQLæ˜¯ä¸€ä¸ªçµæ´»æ€§æ¯”è¾ƒå¼ºçš„æ•°æ®åº“ç³»ç»Ÿï¼Œæä¾›äº†å¾ˆå¤šå¯é…ç½®å‚æ•°ï¼Œä¾¿äºæˆ‘ä»¬æ ¹æ®åº”ç”¨å’ŒæœåŠ¡å™¨ç¡¬ä»¶æ¥åšå®šåˆ¶åŒ–æ•°æ®åº“æœåŠ¡ã€‚å¦‚æœç°åœ¨è®©ä½ å›æƒ³ï¼Œä½ å¯èƒ½è§‰å¾—åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å¾ˆå°‘å»è°ƒæ•´MySQLçš„é…ç½®å‚æ•°ï¼Œä½†æˆ‘ä»Šå¤©æƒ³è¯´çš„æ˜¯æˆ‘ä»¬å¾ˆæœ‰å¿…è¦å»æ·±å…¥äº†è§£å®ƒä»¬ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ•°æ®åº“ä¸»è¦æ˜¯ç”¨æ¥å­˜å–æ•°æ®çš„ï¼Œè€Œå­˜å–æ•°æ®æ¶‰åŠåˆ°äº†ç£ç›˜I/Oçš„è¯»å†™æ“ä½œï¼Œæ‰€ä»¥æ•°æ®åº“ç³»ç»Ÿä¸»è¦çš„æ€§èƒ½ç“¶é¢ˆå°±æ˜¯I/Oè¯»å†™çš„ç“¶é¢ˆäº†ã€‚<span class=\"orange\">MySQLæ•°æ®åº“ä¸ºäº†å‡å°‘ç£ç›˜I/Oçš„è¯»å†™æ“ä½œï¼Œåº”ç”¨äº†å¤§é‡å†…å­˜ç®¡ç†æ¥ä¼˜åŒ–æ•°æ®åº“æ“ä½œï¼ŒåŒ…æ‹¬å†…å­˜ä¼˜åŒ–æŸ¥è¯¢ã€æ’åºä»¥åŠå†™å…¥æ“ä½œã€‚</span></p><p>ä¹Ÿè®¸ä½ ä¼šæƒ³ï¼Œæˆ‘ä»¬æŠŠå†…å­˜è®¾ç½®å¾—è¶Šå¤§è¶Šå¥½ï¼Œæ•°æ®åˆ·æ–°åˆ°ç£ç›˜è¶Šå¿«è¶Šå¥½ï¼Œä¸å°±å¯¹äº†å—ï¼Ÿå…¶å®ä¸ç„¶ï¼Œå†…å­˜è®¾ç½®è¿‡å¤§ï¼ŒåŒæ ·ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒInnoDBä¸­çš„æ•°æ®å’Œç´¢å¼•ç¼“å­˜ï¼Œå¦‚æœè®¾ç½®è¿‡å¤§ï¼Œå°±ä¼šå¼•å‘SWAPé¡µäº¤æ¢ã€‚è¿˜æœ‰æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¹Ÿä¸æ˜¯è¶Šå¿«è¶Šå¥½ï¼Œæˆ‘ä»¬æœŸæœ›çš„æ˜¯åœ¨é«˜å¹¶å‘æ—¶ï¼Œæ•°æ®èƒ½å‡åŒ€åœ°å†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œä»è€Œé¿å…I/Oæ€§èƒ½ç“¶é¢ˆã€‚</p><blockquote>\n<p>SWAPé¡µäº¤æ¢ï¼šSWAPåˆ†åŒºåœ¨ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠç‰©ç†å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´é‡Šæ”¾å‡ºæ¥ï¼Œä»¥ä¾›å½“å‰è¿è¡Œçš„ç¨‹åºä½¿ç”¨ã€‚è¢«é‡Šæ”¾çš„ç©ºé—´å¯èƒ½æ¥è‡ªä¸€äº›å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä»€ä¹ˆæ“ä½œçš„ç¨‹åºï¼Œè¿™äº›è¢«é‡Šæ”¾çš„ç©ºé—´çš„æ•°æ®è¢«ä¸´æ—¶ä¿å­˜åˆ°SWAPåˆ†åŒºä¸­ï¼Œç­‰åˆ°é‚£äº›ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œå†ä»SWAPåˆ†åŒºä¸­æ¢å¤ä¿å­˜çš„æ•°æ®åˆ°å†…å­˜ä¸­ã€‚</p>\n</blockquote><!-- [[[read_end]]] --><p>æ‰€ä»¥ï¼Œè¿™äº›å‚æ•°çš„è®¾ç½®è·Ÿæˆ‘ä»¬çš„åº”ç”¨æœåŠ¡ç‰¹æ€§ä»¥åŠæœåŠ¡å™¨ç¡¬ä»¶æœ‰å¾ˆå¤§çš„å…³ç³»ã€‚MySQLæ˜¯ä¸€ä¸ªé«˜å®šåˆ¶åŒ–çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€æ±‚æ¥è°ƒæ•´å‚æ•°ï¼Œå®šåˆ¶æ€§èƒ½æœ€ä¼˜çš„æ•°æ®åº“ã€‚</p><p>ä¸è¿‡æƒ³è¦äº†è§£è¿™äº›å‚æ•°çš„å…·ä½“ä½œç”¨ï¼Œæˆ‘ä»¬å…ˆå¾—äº†è§£æ•°æ®åº“çš„ç»“æ„ä»¥åŠä¸åŒå­˜å‚¨å¼•æ“çš„å·¥ä½œåŸç†ã€‚</p><h2>MySQLä½“ç³»ç»“æ„</h2><p>æˆ‘ä»¬ä¸€èˆ¬å¯ä»¥å°†MySQLçš„ç»“æ„åˆ†ä¸ºå››å±‚ï¼Œæœ€ä¸Šå±‚ä¸ºå®¢æˆ·ç«¯è¿æ¥å™¨ï¼Œä¸»è¦åŒ…æ‹¬äº†æ•°æ®åº“è¿æ¥ã€æˆæƒè®¤è¯ã€å®‰å…¨ç®¡ç†ç­‰ï¼Œè¯¥å±‚å¼•ç”¨äº†çº¿ç¨‹æ± ï¼Œä¸ºæ¥å…¥çš„è¿æ¥è¯·æ±‚æé«˜çº¿ç¨‹å¤„ç†æ•ˆç‡ã€‚</p><p>ç¬¬äºŒå±‚æ˜¯Serverå±‚ï¼Œä¸»è¦å®ç°SQLçš„ä¸€äº›åŸºç¡€åŠŸèƒ½ï¼ŒåŒ…æ‹¬SQLè§£æã€ä¼˜åŒ–ã€æ‰§è¡Œä»¥åŠç¼“å­˜ç­‰ï¼Œå…¶ä¸­ä¸æˆ‘ä»¬è¿™ä¸€è®²ä¸»è¦ç›¸å…³çš„å°±æ˜¯ç¼“å­˜ã€‚</p><p>ç¬¬ä¸‰å±‚åŒ…æ‹¬äº†å„ç§å­˜å‚¨å¼•æ“ï¼Œä¸»è¦è´Ÿè´£æ•°æ®çš„å­˜å–ï¼Œè¿™ä¸€å±‚æ¶‰åŠåˆ°çš„Bufferç¼“å­˜ï¼Œä¹Ÿå’Œè¿™ä¸€è®²å¯†åˆ‡ç›¸å…³ã€‚</p><p>æœ€ä¸‹é¢ä¸€å±‚æ˜¯æ•°æ®å­˜å‚¨å±‚ï¼Œä¸»è¦è´Ÿè´£å°†æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/52/a5/5297b9556d527dec788b5298d4810fa5.jpg?wh=1408*1120\" alt=\"\"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥äº†è§£ä¸‹ï¼Œå½“æ•°æ®æ¥æ”¶åˆ°ä¸€ä¸ªSQLè¯­å¥æ—¶ï¼Œæ˜¯å¦‚ä½•å¤„ç†çš„ã€‚</p><h3>1. æŸ¥è¯¢è¯­å¥</h3><p>ä¸€ä¸ªåº”ç”¨æœåŠ¡éœ€è¦é€šè¿‡ç¬¬ä¸€å±‚çš„è¿æ¥å’Œæˆæƒè®¤è¯ï¼Œå†å°†SQLè¯·æ±‚å‘é€è‡³SQLæ¥å£ã€‚SQLæ¥å£æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šå…ˆæ£€æŸ¥æŸ¥è¯¢SQLæ˜¯å¦å‘½ä¸­Cacheç¼“å­˜ä¸­çš„æ•°æ®ï¼Œå¦‚æœå‘½ä¸­ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„ç»“æœï¼›å¦åˆ™ï¼Œéœ€è¦è¿›å…¥è§£æå™¨ã€‚</p><p>è§£æå™¨ä¸»è¦å¯¹SQLè¿›è¡Œè¯­æ³•ä»¥åŠè¯æ³•åˆ†æï¼Œä¹‹åï¼Œä¾¿ä¼šè¿›å…¥åˆ°ä¼˜åŒ–å™¨ä¸­ï¼Œä¼˜åŒ–å™¨ä¼šç”Ÿæˆå¤šç§æ‰§è¡Œè®¡åˆ’æ–¹æ¡ˆï¼Œå¹¶é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆæ‰§è¡Œã€‚</p><p>ç¡®å®šäº†æœ€ä¼˜æ‰§è¡Œè®¡åˆ’æ–¹æ¡ˆä¹‹åï¼Œæ‰§è¡Œå™¨ä¼šæ£€æŸ¥è¿æ¥ç”¨æˆ·æ˜¯å¦æœ‰è¯¥è¡¨çš„æ‰§è¡Œæƒé™ï¼Œæœ‰åˆ™æŸ¥çœ‹Bufferä¸­æ˜¯å¦å­˜åœ¨è¯¥ç¼“å­˜ï¼Œå­˜åœ¨åˆ™è·å–é”ï¼ŒæŸ¥è¯¢è¡¨æ•°æ®ï¼›å¦åˆ™é‡æ–°æ‰“å¼€è¡¨æ–‡ä»¶ï¼Œé€šè¿‡æ¥å£è°ƒç”¨ç›¸åº”çš„å­˜å‚¨å¼•æ“å¤„ç†ï¼Œè¿™æ—¶å­˜å‚¨å¼•æ“å°±ä¼šè¿›å…¥åˆ°å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿä¸­è·å–ç›¸åº”çš„æ•°æ®ï¼Œå¹¶è¿”å›ç»“æœé›†ã€‚</p><h3>2. æ›´æ–°è¯­å¥</h3><p>æ•°æ®åº“æ›´æ–°SQLçš„æ‰§è¡Œæµç¨‹å…¶å®è·ŸæŸ¥è¯¢SQLå·®ä¸å¤šï¼Œåªä¸è¿‡æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ—¶å€™å¤šäº†è®°å½•æ—¥å¿—çš„æ­¥éª¤ã€‚åœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶MySQLä¼šå°†æ“ä½œçš„æ—¥å¿—è®°å½•åˆ° binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ä¸­ï¼Œè¿™ä¸ªæ­¥éª¤æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æœ‰ã€‚è€ŒInnoDBé™¤äº†è¦è®°å½• binlog ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¤šè®°å½•ä¸€ä¸ª  redo logï¼ˆé‡åšæ—¥å¿—ï¼‰ã€‚</p><p>redo log  ä¸»è¦æ˜¯ä¸ºäº†è§£å†³  crash-safe  é—®é¢˜è€Œå¼•å…¥çš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå½“æ•°æ®åº“åœ¨å­˜å‚¨æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯å­˜å‚¨çš„æ•°æ®è¦ä¹ˆå­˜å‚¨æˆåŠŸï¼Œè¦ä¹ˆå­˜å‚¨å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œè¿™å°±æ˜¯crash-safeäº†ã€‚</p><p>æˆ‘ä»¬åœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶ï¼Œé¦–å…ˆä¼šæŸ¥è¯¢ç›¸å…³çš„æ•°æ®ï¼Œä¹‹åé€šè¿‡æ‰§è¡Œå™¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œå¹¶å°†æ‰§è¡Œç»“æœå†™å…¥åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶è®°å½•æ›´æ–°æ“ä½œåˆ°redo logçš„ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶redo logä¸­çš„è®°å½•çŠ¶æ€ä¸ºprepareï¼Œå¹¶é€šçŸ¥æ‰§è¡Œå™¨æ›´æ–°å®Œæˆï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚æ‰§è¡Œå™¨æ”¶åˆ°é€šçŸ¥åä¼šæ‰§è¡Œbinlogçš„å†™å…¥æ“ä½œï¼Œæ­¤æ—¶çš„binlogæ˜¯è®°å½•åœ¨ç¼“å­˜ä¸­çš„ï¼Œå†™å…¥æˆåŠŸåä¼šè°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œæ›´æ–°è®°å½•çŠ¶æ€ä¸ºcommitã€‚ä¹‹åï¼Œå†…å­˜ä¸­çš„redo logä»¥åŠbinlogéƒ½ä¼šåˆ·æ–°åˆ°ç£ç›˜æ–‡ä»¶ä¸­ã€‚</p><h2>å†…å­˜è°ƒä¼˜</h2><p>åŸºäºä»¥ä¸Šä¸¤ä¸ªSQLæ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨æ‰§è¡ŒæŸ¥è¯¢SQLè¯­å¥æ—¶ï¼Œä¼šæ¶‰åŠåˆ°ä¸¤ä¸ªç¼“å­˜ã€‚ç¬¬ä¸€ä¸ªç¼“å­˜æ˜¯åˆšè¿›æ¥æ—¶çš„Query Cacheï¼Œå®ƒç¼“å­˜çš„æ˜¯SQLè¯­å¥å’Œå¯¹åº”çš„ç»“æœé›†ã€‚è¿™é‡Œçš„ç¼“å­˜æ˜¯ä»¥æŸ¥è¯¢SQLçš„Hashå€¼ä¸ºkeyï¼Œè¿”å›ç»“æœé›†ä¸ºvalueçš„é”®å€¼å¯¹ï¼Œåˆ¤æ–­ä¸€æ¡SQLæ˜¯å¦å‘½ä¸­ç¼“å­˜ï¼Œæ˜¯é€šè¿‡åŒ¹é…æŸ¥è¯¢SQLçš„Hashå€¼æ¥å®ç°çš„ã€‚</p><p>å¾ˆæ˜æ˜¾ï¼ŒQuery Cacheå¯ä»¥ä¼˜åŒ–æŸ¥è¯¢SQLè¯­å¥ï¼Œå‡å°‘å¤§é‡å·¥ä½œï¼Œç‰¹åˆ«æ˜¯å‡å°‘äº†I/Oè¯»å–æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªä¸»è¦çš„è®¾ç½®å‚æ•°æ¥ä¼˜åŒ–æŸ¥è¯¢æ“ä½œï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/db/dd/db97c34b74f0903673badc256ba46cdd.jpg?wh=1240*512\" alt=\"\"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®åˆé€‚çš„ query_cache_min_res_unit æ¥å‡å°‘ç¢ç‰‡ï¼Œè¿™ä¸ªå‚æ•°æœ€åˆé€‚çš„å¤§å°å’Œåº”ç”¨ç¨‹åºæŸ¥è¯¢ç»“æœçš„å¹³å‡å¤§å°ç›´æ¥ç›¸å…³ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—æ‰€å¾—ï¼š</p><p>ï¼ˆquery_cache_size - Qcache_free_memoryï¼‰/  Qcache_queries_in_cache</p><p>Qcache_free_memory  å’Œ  Qcache_queries_in_cache  çš„å€¼å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢ï¼š</p><pre><code>show status like 'Qcache%'\n</code></pre><p>Query Cacheè™½ç„¶å¯ä»¥ä¼˜åŒ–æŸ¥è¯¢æ“ä½œï¼Œä½†ä¹Ÿä»…é™äºä¸å¸¸ä¿®æ”¹çš„æ•°æ®ï¼Œå¦‚æœä¸€å¼ è¡¨æ•°æ®ç»å¸¸è¿›è¡Œæ–°å¢ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼Œåˆ™ä¼šé€ æˆQuery Cacheçš„å¤±æ•ˆç‡éå¸¸é«˜ï¼Œä»è€Œå¯¼è‡´é¢‘ç¹åœ°æ¸…é™¤Cacheä¸­çš„æ•°æ®ï¼Œç»™ç³»ç»Ÿå¢åŠ é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</p><p>è¿™ä¹Ÿä¼šå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡éå¸¸ä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸ŠæŸ¥è¯¢çŠ¶æ€çš„å‘½ä»¤æŸ¥çœ‹ Qcache_hitsï¼Œè¯¥å€¼è¡¨ç¤ºç¼“å­˜å‘½ä¸­ç‡ã€‚å¦‚æœç¼“å­˜å‘½ä¸­ç‡ç‰¹åˆ«ä½çš„è¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡query_cache_size = 0æˆ–è€…query_cache_typeæ¥å…³é—­æŸ¥è¯¢ç¼“å­˜ã€‚</p><p>ç»è¿‡äº†Query Cacheç¼“å­˜ä¹‹åï¼Œè¿˜ä¼šä½¿ç”¨åˆ°å­˜å‚¨å¼•æ“ä¸­çš„Bufferç¼“å­˜ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“ï¼Œä½¿ç”¨çš„Bufferä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®²è§£ä¸¤ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ã€‚</p><h3>1. MyISAMå­˜å‚¨å¼•æ“å‚æ•°è®¾ç½®è°ƒä¼˜</h3><p>MyISAMå­˜å‚¨å¼•æ“ä½¿ç”¨key bufferç¼“å­˜ç´¢å¼•å—ï¼ŒMyISAMè¡¨çš„æ•°æ®å—åˆ™æ²¡æœ‰ç¼“å­˜ï¼Œå®ƒæ˜¯ç›´æ¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡key_buffer_sizeè®¾ç½®key bufferç¼“å­˜çš„å¤§å°ï¼Œè€Œå®ƒçš„å¤§å°å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½ã€‚æ­£å¦‚æˆ‘å‰é¢æ‰€è®²çš„ï¼Œkey bufferç¼“å­˜è®¾ç½®è¿‡å¤§ï¼Œå®é™…åº”ç”¨å´ä¸å¤§çš„è¯ï¼Œå°±å®¹æ˜“é€ æˆå†…å­˜æµªè´¹ï¼Œè€Œä¸”ç³»ç»Ÿä¹Ÿå®¹æ˜“å‘ç”ŸSWAPé¡µäº¤æ¢ï¼Œä¸€èˆ¬æˆ‘æ˜¯å»ºè®®å°†æœåŠ¡å™¨å†…å­˜ä¸­å¯ç”¨å†…å­˜çš„1/4åˆ†é…ç»™key bufferã€‚</p><p>å¦‚æœè¦æ›´å‡†ç¡®åœ°è¯„ä¼°key bufferçš„è®¾ç½®æ˜¯å¦åˆç†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç¼“å­˜ä½¿ç”¨ç‡å…¬å¼æ¥è®¡ç®—ï¼š</p><p>1-((key_blocks_unused*key_cache_block_size)/key_buffer_size)</p><blockquote>\n<p>key_blocks_unusedè¡¨ç¤ºæœªä½¿ç”¨çš„ç¼“å­˜ç°‡ï¼ˆblocksï¼‰æ•°<br>\nkey_cache_block_sizeè¡¨ç¤ºkey_buffer_sizeè¢«åˆ†å‰²çš„åŒºåŸŸå¤§å°key_blocks_unused*key_cache_block_sizeåˆ™è¡¨ç¤ºå‰©ä½™çš„å¯ç”¨ç¼“å­˜ç©ºé—´ï¼ˆä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜ä½¿ç”¨ç‡åœ¨80%ä½œç”¨æ¯”è¾ƒåˆé€‚ï¼‰ã€‚</p>\n</blockquote><h3>2. InnoDBå­˜å‚¨å¼•æ“å‚æ•°è®¾ç½®è°ƒä¼˜</h3><p>InnoDB Buffer Poolï¼ˆç®€ç§°IBPï¼‰æ˜¯InnoDBå­˜å‚¨å¼•æ“çš„ä¸€ä¸ªç¼“å†²æ± ï¼Œä¸MyISAMå­˜å‚¨å¼•æ“ä½¿ç”¨key bufferç¼“å­˜ä¸åŒï¼Œå®ƒä¸ä»…å­˜å‚¨äº†è¡¨ç´¢å¼•å—ï¼Œè¿˜å­˜å‚¨äº†è¡¨æ•°æ®ã€‚æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒIBPå…è®¸å¿«é€Ÿè¿”å›é¢‘ç¹è®¿é—®çš„æ•°æ®ï¼Œè€Œæ— éœ€è®¿é—®ç£ç›˜æ–‡ä»¶ã€‚InnoDBè¡¨ç©ºé—´ç¼“å­˜è¶Šå¤šï¼ŒMySQLè®¿é—®ç‰©ç†ç£ç›˜çš„é¢‘ç‡å°±è¶Šä½ï¼Œè¿™è¡¨ç¤ºæŸ¥è¯¢å“åº”æ—¶é—´æ›´å¿«ï¼Œç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ä¹Ÿæœ‰æ‰€æé«˜ã€‚</p><p>æˆ‘ä»¬ä¸€èˆ¬å¯ä»¥é€šè¿‡å¤šä¸ªè®¾ç½®å‚æ•°æ¥è°ƒæ•´IBPï¼Œä¼˜åŒ–InnoDBè¡¨æ€§èƒ½ã€‚</p><ul>\n<li><strong>innodb_buffer_pool_size</strong></li>\n</ul><p>IBPé»˜è®¤çš„å†…å­˜å¤§å°æ˜¯128Mï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°innodb_buffer_pool_sizeæ¥è®¾ç½®IBPçš„å¤§å°ï¼ŒIBPè®¾ç½®å¾—è¶Šå¤§ï¼ŒInnoDBè¡¨æ€§èƒ½å°±è¶Šå¥½ã€‚ä½†æ˜¯ï¼Œå°†IBPå¤§å°è®¾ç½®å¾—è¿‡å¤§ä¹Ÿä¸å¥½ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå‘ç”ŸSWAPé¡µäº¤æ¢ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨IBPå¤§å°å’Œå…¶å®ƒç³»ç»ŸæœåŠ¡æ‰€éœ€å†…å­˜å¤§å°ä¹‹é—´å–å¾—å¹³è¡¡ã€‚MySQLæ¨èé…ç½®IBPçš„å¤§å°ä¸ºæœåŠ¡å™¨ç‰©ç†å†…å­˜çš„80%ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è®¡ç®—InnoDBç¼“å†²æ± çš„å‘½ä¸­ç‡æ¥è°ƒæ•´IBPå¤§å°ï¼š</p><p>(1-innodb_buffer_pool_reads/innodb_buffer_pool_read_request)*100</p><p>ä½†å¦‚æœæˆ‘ä»¬å°†IBPçš„å¤§å°è®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„80%ä»¥åï¼Œå‘ç°å‘½ä¸­ç‡è¿˜æ˜¯å¾ˆä½ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±åº”è¯¥è€ƒè™‘æ‰©å……å†…å­˜æ¥å¢åŠ IBPçš„å¤§å°ã€‚</p><ul>\n<li><strong>innodb_buffer_pool_instances</strong></li>\n</ul><p>InnoDBä¸­çš„IBPç¼“å†²æ± è¢«åˆ’åˆ†ä¸ºäº†å¤šä¸ªå®ä¾‹ï¼Œå¯¹äºå…·æœ‰æ•°åƒå…†å­—èŠ‚çš„ç¼“å†²æ± çš„ç³»ç»Ÿæ¥è¯´ï¼Œå°†ç¼“å†²æ± åˆ’åˆ†ä¸ºå•ç‹¬çš„å®ä¾‹å¯ä»¥å‡å°‘ä¸åŒçº¿ç¨‹è¯»å–å’Œå†™å…¥ç¼“å­˜é¡µé¢æ—¶çš„äº‰ç”¨ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¹¶å‘æ€§ã€‚è¯¥å‚æ•°é¡¹ä»…åœ¨å°†innodb_buffer_pool_sizeè®¾ç½®ä¸º1GBæˆ–æ›´å¤§æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚</p><p>åœ¨windows 32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œå¦‚æœinnodb_buffer_pool_sizeçš„å¤§å°è¶…è¿‡1.3GBï¼Œinnodb_buffer_pool_instancesé»˜è®¤å¤§å°å°±ä¸ºinnodb_buffer_pool_size/128MBï¼›å¦åˆ™ï¼Œé»˜è®¤ä¸º1ã€‚</p><p>è€Œåœ¨å…¶å®ƒæ“ä½œç³»ç»Ÿä¸­ï¼Œå¦‚æœinnodb_buffer_pool_sizeå¤§å°è¶…è¿‡1GBï¼Œinnodb_buffer_pool_instanceså€¼å°±é»˜è®¤ä¸º8ï¼›å¦åˆ™ï¼Œé»˜è®¤ä¸º1ã€‚</p><p>ä¸ºäº†è·å–æœ€ä½³æ•ˆç‡ï¼Œå»ºè®®æŒ‡å®šinnodb_buffer_pool_instancesçš„å¤§å°ï¼Œå¹¶ä¿è¯æ¯ä¸ªç¼“å†²æ± å®ä¾‹è‡³å°‘æœ‰1GBå†…å­˜ã€‚é€šå¸¸ï¼Œå»ºè®®innodb_buffer_pool_instancesçš„å¤§å°ä¸è¶…è¿‡innodb_read_io_threads + innodb_write_io_threadsä¹‹å’Œï¼Œå»ºè®®å®ä¾‹å’Œçº¿ç¨‹æ•°é‡æ¯”ä¾‹ä¸º1:1ã€‚</p><ul>\n<li><strong>innodb_read_io_threads</strong> / <strong>innodb_write_io_threads</strong></li>\n</ul><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQLåå°çº¿ç¨‹åŒ…æ‹¬äº†ä¸»çº¿ç¨‹ã€IOçº¿ç¨‹ã€é”çº¿ç¨‹ä»¥åŠç›‘æ§çº¿ç¨‹ç­‰ï¼Œå…¶ä¸­è¯»å†™çº¿ç¨‹å±äºIOçº¿ç¨‹ï¼Œä¸»è¦è´Ÿè´£æ•°æ®åº“çš„è¯»å–å’Œå†™å…¥æ“ä½œï¼Œè¿™äº›çº¿ç¨‹åˆ†åˆ«è¯»å–å’Œå†™å…¥innodb_buffer_pool_instancesåˆ›å»ºçš„å„ä¸ªå†…å­˜é¡µé¢ã€‚MySQLæ”¯æŒé…ç½®å¤šä¸ªè¯»å†™çº¿ç¨‹ï¼Œå³é€šè¿‡innodb_read_io_threadså’Œinnodb_write_io_threadsè®¾ç½®è¯»å†™çº¿ç¨‹æ•°é‡ã€‚</p><p>è¯»å†™çº¿ç¨‹æ•°é‡å€¼é»˜è®¤ä¸º4ï¼Œä¹Ÿå°±æ˜¯æ€»å…±æœ‰8ä¸ªçº¿ç¨‹åŒæ—¶åœ¨åå°è¿è¡Œã€‚innodb_read_io_threadså’Œinnodb_write_io_threadsè®¾ç½®çš„è¯»å†™çº¿ç¨‹æ•°é‡ï¼Œä¸innodb_buffer_pool_instancesçš„å¤§å°æœ‰å…³ï¼Œä¸¤è€…çš„ååŒä¼˜åŒ–æ˜¯æé«˜ç³»ç»Ÿæ€§èƒ½çš„ä¸€ä¸ªå…³é”®å› ç´ ã€‚</p><p>åœ¨ä¸€äº›å†…å­˜ä»¥åŠCPUå†…æ ¸è¶…å¤§å‹çš„æ•°æ®åº“æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿è¯è¶³å¤Ÿå¤§çš„IBPå†…å­˜çš„å‰æä¸‹ï¼Œé€šè¿‡ä»¥ä¸‹å…¬å¼ï¼ŒååŒå¢åŠ ç¼“å­˜å®ä¾‹æ•°é‡ä»¥åŠè¯»å†™çº¿ç¨‹ã€‚</p><p>( innodb_read_io_threads + innodb_write_io_threads ) = innodb_buffe_pool_instances</p><p>å¦‚æœæˆ‘ä»¬ä»…ä»…æ˜¯å°†è¯»å†™çº¿ç¨‹æ ¹æ®ç¼“å­˜å®ä¾‹æ•°é‡å¯¹åŠæ¥åˆ†ï¼Œå³è¯»çº¿ç¨‹å’Œå†™çº¿ç¨‹å„ä¸ºå®ä¾‹å¤§å°çš„ä¸€åŠï¼Œè‚¯å®šæ˜¯ä¸åˆç†çš„ã€‚ä¾‹å¦‚æˆ‘ä»¬çš„åº”ç”¨æœåŠ¡è¯»å–æ•°æ®åº“çš„æ•°æ®å¤šäºå†™å…¥æ•°æ®åº“çš„æ•°æ®ï¼Œé‚£ä¹ˆå¢åŠ å†™å…¥çº¿ç¨‹åè€Œæ²¡æœ‰ä¼˜åŒ–æ•ˆæœã€‚æˆ‘ä»¬ä¸€èˆ¬å¯ä»¥é€šè¿‡MySQLæœåŠ¡å™¨ä¿å­˜çš„å…¨å±€ç»Ÿè®¡ä¿¡æ¯ï¼Œæ¥ç¡®å®šç³»ç»Ÿçš„è¯»å–å’Œå†™å…¥æ¯”ç‡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æŸ¥è¯¢æ¥ç¡®å®šè¯»å†™æ¯”ç‡ï¼š</p><pre><code>SHOW GLOBAL STATUS LIKE 'Com_select';//è¯»å–æ•°é‡\n\nSHOW GLOBAL STATUS WHERE Variable_name IN ('Com_insert', 'Com_update', 'Com_replace', 'Com_delete');//å†™å…¥æ•°é‡\n</code></pre><p>å¦‚æœè¯»å¤§äºå†™ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘å°†è¯»çº¿ç¨‹çš„æ•°é‡è®¾ç½®å¾—å¤§ä¸€äº›ï¼Œå†™çº¿ç¨‹æ•°é‡å°ä¸€äº›ï¼›å¦åˆ™ï¼Œåä¹‹ã€‚</p><ul>\n<li><strong>innodb_log_file_size</strong></li>\n</ul><p>é™¤äº†ä»¥ä¸ŠInnoDBç¼“å­˜ç­‰å› ç´ ä¹‹å¤–ï¼ŒInnoDBçš„æ—¥å¿—ç¼“å­˜å¤§å°ã€æ—¥å¿—æ–‡ä»¶å¤§å°ä»¥åŠæ—¥å¿—æ–‡ä»¶æŒä¹…åŒ–åˆ°ç£ç›˜çš„ç­–ç•¥éƒ½å½±å“ç€InnnoDBçš„æ€§èƒ½ã€‚ InnoDBä¸­æœ‰ä¸€ä¸ªredo logæ–‡ä»¶ï¼ŒInnoDBç”¨å®ƒæ¥å­˜å‚¨æœåŠ¡å™¨å¤„ç†çš„æ¯ä¸ªå†™è¯·æ±‚çš„é‡åšæ´»åŠ¨ã€‚æ‰§è¡Œçš„æ¯ä¸ªå†™å…¥æŸ¥è¯¢éƒ½ä¼šåœ¨æ—¥å¿—æ–‡ä»¶ä¸­è·å¾—é‡åšæ¡ç›®ï¼Œä»¥ä¾¿åœ¨å‘ç”Ÿå´©æºƒæ—¶å¯ä»¥æ¢å¤æ›´æ”¹ã€‚</p><p>å½“æ—¥å¿—æ–‡ä»¶å¤§å°å·²ç»è¶…è¿‡æˆ‘ä»¬å‚æ•°è®¾ç½®çš„æ—¥å¿—æ–‡ä»¶å¤§å°æ—¶ï¼ŒInnoDBä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œç”±äºé‡åšæ—¥å¿—æ˜¯ä¸€ä¸ªå¾ªç¯ä½¿ç”¨çš„ç¯ï¼Œåœ¨åˆ‡æ¢æ—¶ï¼Œå°±éœ€è¦å°†æ–°çš„æ—¥å¿—æ–‡ä»¶è„é¡µçš„ç¼“å­˜æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼ˆè§¦å‘æ£€æŸ¥ç‚¹ï¼‰ã€‚</p><p>ç†è®ºä¸Šæ¥è¯´ï¼Œinnodb_log_file_sizeè®¾ç½®å¾—è¶Šå¤§ï¼Œç¼“å†²æ± ä¸­éœ€è¦çš„æ£€æŸ¥ç‚¹åˆ·æ–°æ´»åŠ¨å°±è¶Šå°‘ï¼Œä»è€ŒèŠ‚çœç£ç›˜I/Oã€‚é‚£æ˜¯ä¸æ˜¯å°†è¿™ä¸ªæ—¥å¿—æ–‡ä»¶è®¾ç½®å¾—è¶Šå¤§è¶Šå¥½å‘¢ï¼Ÿå¦‚æœæ—¥å¿—æ–‡ä»¶è®¾ç½®å¾—å¤ªå¤§ï¼Œæ¢å¤æ—¶é—´å°±ä¼šå˜é•¿ï¼Œè¿™æ ·ä¸ä¾¿äºDBAç®¡ç†ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ—¥å¿—æ–‡ä»¶å¤§å°è®¾ç½®ä¸º1GBå°±è¶³å¤Ÿäº†ã€‚</p><ul>\n<li><strong>innodb_log_buffer_size</strong></li>\n</ul><p>è¿™ä¸ªå‚æ•°å†³å®šäº†InnoDBé‡åšæ—¥å¿—ç¼“å†²æ± çš„å¤§å°ï¼Œé»˜è®¤å€¼ä¸º8MBã€‚å¦‚æœé«˜å¹¶å‘ä¸­å­˜åœ¨å¤§é‡çš„äº‹åŠ¡ï¼Œè¯¥å€¼è®¾ç½®å¾—å¤ªå°ï¼Œå°±ä¼šå¢åŠ å†™å…¥ç£ç›˜çš„I/Oæ“ä½œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢å¤§è¯¥å‚æ•°æ¥å‡å°‘å†™å…¥ç£ç›˜æ“ä½œï¼Œä»è€Œæé«˜å¹¶å‘æ—¶çš„äº‹åŠ¡æ€§èƒ½ã€‚</p><ul>\n<li><strong>innodb_flush_log_at_trx_commit</strong></li>\n</ul><p>è¿™ä¸ªå‚æ•°å¯ä»¥æ§åˆ¶é‡åšæ—¥å¿—ä»ç¼“å­˜å†™å…¥æ–‡ä»¶åˆ·æ–°åˆ°ç£ç›˜ä¸­çš„ç­–ç•¥ï¼Œé»˜è®¤å€¼ä¸º1ã€‚</p><p>å½“è®¾ç½®è¯¥å‚æ•°ä¸º0æ—¶ï¼ŒInnoDBæ¯ç§’ç§å°±ä¼šè§¦å‘ä¸€æ¬¡ç¼“å­˜æ—¥å¿—å†™å…¥åˆ°æ–‡ä»¶ä¸­å¹¶åˆ·æ–°åˆ°ç£ç›˜çš„æ“ä½œï¼Œè¿™æœ‰å¯èƒ½åœ¨æ•°æ®åº“å´©æºƒåï¼Œä¸¢å¤±1sçš„æ•°æ®ã€‚</p><p>å½“è®¾ç½®è¯¥å‚æ•°ä¸º 1 æ—¶ï¼Œåˆ™è¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„ redo log éƒ½ä¼šç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ MySQL å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p><p>å½“è®¾ç½®è¯¥å‚æ•°ä¸º  2  æ—¶ï¼Œæ¯æ¬¡äº‹åŠ¡çš„ redo log éƒ½ä¼šç›´æ¥å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå†å°†æ–‡ä»¶åˆ·æ–°åˆ°ç£ç›˜ã€‚</p><p>åœ¨ä¸€äº›å¯¹æ•°æ®å®‰å…¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„åœºæ™¯ä¸­ï¼Œæ˜¾ç„¶è¯¥å€¼éœ€è¦è®¾ç½®ä¸º1ï¼›è€Œåœ¨ä¸€äº›å¯ä»¥å®¹å¿æ•°æ®åº“å´©æºƒæ—¶ä¸¢å¤±1sæ•°æ®çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥å€¼è®¾ç½®ä¸º0æˆ–2ï¼Œè¿™æ ·å¯ä»¥æ˜æ˜¾åœ°å‡å°‘æ—¥å¿—åŒæ­¥åˆ°ç£ç›˜çš„I/Oæ“ä½œã€‚</p><h2>æ€»ç»“</h2><p>MySQLæ•°æ®åº“çš„å‚æ•°è®¾ç½®éå¸¸å¤šï¼Œä»Šå¤©æˆ‘ä»¬ä»…ä»…æ˜¯äº†è§£äº†ä¸å†…å­˜ä¼˜åŒ–ç›¸å…³çš„å‚æ•°è®¾ç½®ã€‚é™¤äº†è¿™äº›å‚æ•°è®¾ç½®ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„æé«˜MySQLå¹¶å‘çš„ç›¸å…³å‚æ•°è®¾ç½®ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/be/4c/be83083a261bf1302aca81c122b0ac4c.jpg?wh=1164*634\" alt=\"\"></p><h2>æ€è€ƒé¢˜</h2><p>æˆ‘ä»¬çŸ¥é“ï¼ŒInnoDBçš„IBPçš„å†…å­˜å¤§å°æ˜¯æœ‰é™çš„ï¼Œ<span class=\"orange\">ä½ çŸ¥é“InnoDBæ˜¯å¦‚ä½•å°†çƒ­ç‚¹æ•°æ®ç•™åœ¨å†…å­˜ä¸­ï¼Œæ·˜æ±°éçƒ­ç‚¹æ•°æ®çš„å—ï¼Ÿ</span></p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„ç­”æ¡ˆã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·è®¨è®ºã€‚</p><p></p>","neighbors":{"left":{"article_title":"38 | ç”µå•†ç³»ç»Ÿè¡¨è®¾è®¡ä¼˜åŒ–æ¡ˆä¾‹åˆ†æ","id":119070},"right":{"article_title":"40 | ç­”ç–‘è¯¾å ‚ï¼šMySQLä¸­InnoDBçš„çŸ¥è¯†ç‚¹ä¸²è®²","id":121710}},"comments":[{"had_liked":false,"id":125721,"user_name":"å¼ å­¦ç£Š","can_delete":false,"product_type":"c1","uid":1250029,"ip_address":"","ucode":"F545F384A6F1E1","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eotSSnZic41tGkbflx0ogIg3ia6g2muFY1hCgosL2t3icZm7I8Ax1hcv1jNgr6vrZ53dpBuGhaoc6DKg/132","comment_is_top":false,"comment_ctime":1566233013,"is_pvip":false,"replies":[{"id":"46234","content":"å¯¹çš„ï¼ŒMySQLåŸºäºLRUç®—æ³•æ¥å®ç°æ·˜æ±°éçƒ­ç‚¹æ•°æ®ï¼Œä½†ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„LRUç®—æ³•ä¸åŒçš„æ˜¯ï¼ŒMySQLæ–°å¢äº†ä¸€ä¸ªmidpoint insertion startegyç­–ç•¥ï¼Œå°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯»å–åˆ°çš„æ–°é¡µå¹¶ä¸æ˜¯ç›´æ¥æ”¾å…¥çš„LRUåˆ—è¡¨çš„é¦–éƒ¨ï¼Œè€Œæ˜¯LRUåˆ—è¡¨é•¿åº¦çš„5&#47;8å¤„ï¼Œç›®çš„æ˜¯ä¸ºäº†é¿å…ç”±äºä¸€äº›ä¸å¸¸æŸ¥è¯¢SQLå¶å°”ä¸€æ¬¡æŸ¥è¯¢å°±æŠŠä¹‹å‰çƒ­ç‚¹æ•°æ®æ·˜æ±°çš„æƒ…å†µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566265855,"ip_address":"","comment_id":125721,"utype":1}],"discussion_count":4,"race_medal":0,"score":"160480022965","product_id":100028001,"comment_content":"é€šè¿‡åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªé“¾è¡¨ï¼Œå¹¶ä½¿ç”¨LRU(æœ€è¿‘æœ€å°‘ä½¿ç”¨)ç®—æ³•æ·˜æ±°éçƒ­ç‚¹æ•°æ®","like_count":38,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463672,"discussion_content":"å¯¹çš„ï¼ŒMySQLåŸºäºLRUç®—æ³•æ¥å®ç°æ·˜æ±°éçƒ­ç‚¹æ•°æ®ï¼Œä½†ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„LRUç®—æ³•ä¸åŒçš„æ˜¯ï¼ŒMySQLæ–°å¢äº†ä¸€ä¸ªmidpoint insertion startegyç­–ç•¥ï¼Œå°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯»å–åˆ°çš„æ–°é¡µå¹¶ä¸æ˜¯ç›´æ¥æ”¾å…¥çš„LRUåˆ—è¡¨çš„é¦–éƒ¨ï¼Œè€Œæ˜¯LRUåˆ—è¡¨é•¿åº¦çš„5/8å¤„ï¼Œç›®çš„æ˜¯ä¸ºäº†é¿å…ç”±äºä¸€äº›ä¸å¸¸æŸ¥è¯¢SQLå¶å°”ä¸€æ¬¡æŸ¥è¯¢å°±æŠŠä¹‹å‰çƒ­ç‚¹æ•°æ®æ·˜æ±°çš„æƒ…å†µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566265855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1320592,"avatar":"https://static001.geekbang.org/account/avatar/00/14/26/90/f68608f3.jpg","nickname":"gwl","note":"","ucode":"24F334E9AC0313","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291585,"discussion_content":"å“ˆå“ˆï¼Œmysqlæ‰‹å†Œä¸Šæœ‰è¯´æ˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594879130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1210699,"avatar":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","nickname":"-W.LI-","note":"","ucode":"3556786538664F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5424,"discussion_content":"é“¾è¡¨é‡Œé¢å­˜çš„æ˜¯sqlçš„hashä¹ˆ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566261330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1250029,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eotSSnZic41tGkbflx0ogIg3ia6g2muFY1hCgosL2t3icZm7I8Ax1hcv1jNgr6vrZ53dpBuGhaoc6DKg/132","nickname":"å¼ å­¦ç£Š","note":"","ucode":"F545F384A6F1E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1210699,"avatar":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","nickname":"-W.LI-","note":"","ucode":"3556786538664F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5428,"discussion_content":"é“¾è¡¨é‡Œé¢å­˜å‚¨çš„æ˜¯ä»¥é¡µ(16K)ä¸ºå•ä½çš„æ•°æ®","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566262857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5424,"ip_address":""},"score":5428,"extra":""}]}]},{"had_liked":false,"id":126183,"user_name":"lik","can_delete":false,"product_type":"c1","uid":1103027,"ip_address":"","ucode":"9565C94A9B773A","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/b3/96847546.jpg","comment_is_top":false,"comment_ctime":1566346596,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"134710332772","product_id":100028001,"comment_content":"è¿™ä¸ªä¸“æ çš„ç»¼åˆè´¨é‡çœŸçš„å¾ˆé«˜ï¼Œ ä¸æ‡‚ä¸ºä»€ä¹ˆè®¢é˜…é‡è¿™ä¹ˆå°‘ã€‚","like_count":31,"discussions":[{"author":{"id":1132448,"avatar":"https://static001.geekbang.org/account/avatar/00/11/47/a0/f12115b7.jpg","nickname":"Sam.å¼ æœ","note":"","ucode":"FB20554D94B250","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302861,"discussion_content":"å› ä¸ºçœ‹ä¸æ‡‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1599049890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2388888,"avatar":"https://static001.geekbang.org/account/avatar/00/24/73/98/ec4d22af.jpg","nickname":"é˜¿K","note":"","ucode":"C9E1B6D50135D3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578314,"discussion_content":"éƒ½æ˜¯äº›æ¦‚æ‹¬æ€§çš„ä¸œè¥¿ï¼Œä¸ä¼šçš„äººå¬ä¸æ‡‚ï¼Œä¼šçš„ä¸å¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656655465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2532285,"avatar":"","nickname":"Geek_926921","note":"","ucode":"51C3B0178D77E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382603,"discussion_content":"æˆ‘æ˜¯çœ‹äº†ä¸€çœ¼ç›®å½•å°±è§‰å¾—è¿™ä¸ªä¸“æ çœŸçš„ä¸é”™ï¼Œç„¶åå­¦ä¹ äº†ä¹‹åå‘ç°ç¡®å®çœŸçš„ä¸é”™ï¼ŒçœŸé¦™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625644160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134861,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","nickname":"James","note":"","ucode":"48B0F2A334D1C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350774,"discussion_content":"æ²¡ä¼˜æƒ åˆ¸å§..","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614003426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1053955,"avatar":"https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg","nickname":"è€ƒä¼‘","note":"","ucode":"968DFC00D6D0CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":50428,"discussion_content":"ä»ä¸€äº›ç¤ºä¾‹ä¸Šæ¥çœ‹ï¼Œè€å¸ˆæ‡‚å¾—å¾ˆå¤šï¼Œæ›´é‡è¦çš„æ˜¯æ¯é¡¹æŠ€èƒ½éƒ½å¾ˆä¼˜ç§€ï¼Œå‘è€å¸ˆå­¦ä¹ ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573719757,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126344,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1566369021,"is_pvip":false,"replies":[{"id":"47075","content":"è§£é‡Šçš„æ¯”æˆ‘å…¨é¢ï¼Œèµ","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566614487,"ip_address":"","comment_id":126344,"utype":1}],"discussion_count":1,"race_medal":0,"score":"83170747645","product_id":100028001,"comment_content":"mysqlçš„ç¼“å†²æ± ï¼ˆbuffer_poolï¼‰ä½¿ç”¨æ”¹è¿›ç‰ˆçš„lruç®—æ³•æ¥ç¼“å­˜æ•°æ®ï¼Œå¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„lruç®—æ³•ï¼Œä¼šå­˜åœ¨é¢„è¯»å¤±æ•ˆå’Œç¼“å†²æ± æ±¡æŸ“çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³é¢„è¯»å¤±æ•ˆé—®é¢˜ï¼Œmysqlå°†lruåˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ï¼Œä¸ºäº†è§£å†³ç¼“å†²æ± æ±¡æŸ“çš„é—®é¢˜ï¼Œå¼•å…¥è€ç”Ÿä»£åœç•™æ—¶é—´çª—å£ï¼Œåªæœ‰å¤§äºè®¾ç½®çš„å€¼ï¼Œæ‰èƒ½åŠ å…¥æ–°ç”Ÿä»£å¤´éƒ¨","like_count":19,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463948,"discussion_content":"è§£é‡Šçš„æ¯”æˆ‘å…¨é¢ï¼Œèµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566614487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187137,"user_name":"Mr.wang","can_delete":false,"product_type":"c1","uid":1224805,"ip_address":"","ucode":"86F341A5316BBC","user_header":"https://static001.geekbang.org/account/avatar/00/12/b0/65/90387745.jpg","comment_is_top":false,"comment_ctime":1584024275,"is_pvip":false,"replies":[{"id":"73035","content":"redo log æ˜¯ InnoDB å­˜å‚¨å¼•æ“å±‚çš„æ—¥å¿—ï¼Œä¸»è¦è®°å½•çš„æ˜¯è¯¥å¼•æ“çš„æ•°æ®å˜æ›´è®°å½•ï¼Œæœ‰äº†redo logï¼Œå½“æ•°æ®åº“å‘ç”Ÿå®•æœºé‡å¯åï¼Œå¯é€šè¿‡redo logå°†æœªè½ç›˜çš„æ•°æ®æ¢å¤ï¼Œå³ä¿è¯å·²ç»æäº¤çš„äº‹åŠ¡è®°å½•ä¸ä¼šä¸¢å¤±ã€‚<br><br>è€Œbinlog å±äºé€»è¾‘æ—¥å¿—ï¼Œå±äºserverå±‚çš„æ—¥å¿—ï¼Œå¯ä»¥è®°å½•å„ä¸ªå­˜å‚¨å¼•æ“çš„æ•°æ®å˜æ›´è®°å½•ï¼Œæ˜¯äº‹åŠ¡æäº¤ä¹‹åçš„æ•°æ®å˜æ›´æ—¥å¿—ã€‚<br>redo logå¯ä»¥ä½œä¸ºå¼‚å¸¸downæœºæˆ–è€…ä»‹è´¨æ•…éšœåçš„æ•°æ®æ¢å¤ä½¿ç”¨ï¼Œè€Œbinlogå¯ä»¥ä½œä¸ºè¯¯åˆ æ•°æ®æ¢å¤æ•°æ®ä½¿ç”¨ï¼Œ binlogæ—¥å¿—è¿˜ç”¨äºä¸»ä»æ•°æ®åº“çš„æ•°æ®åŒæ­¥ã€‚<br>","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1584534588,"ip_address":"","comment_id":187137,"utype":1}],"discussion_count":1,"race_medal":1,"score":"61713566419","product_id":100028001,"comment_content":"åˆ˜è€å¸ˆï¼Œæ‚¨å¯ä»¥è¯¦ç»†è®²ä¸€ä¸‹redologå’Œbinlogå—ï¼Œä»¥åä»–ä»¬çš„ä½¿ç”¨åœºæ™¯å—ï¼Ÿ","like_count":14,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487005,"discussion_content":"redo log æ˜¯ InnoDB å­˜å‚¨å¼•æ“å±‚çš„æ—¥å¿—ï¼Œä¸»è¦è®°å½•çš„æ˜¯è¯¥å¼•æ“çš„æ•°æ®å˜æ›´è®°å½•ï¼Œæœ‰äº†redo logï¼Œå½“æ•°æ®åº“å‘ç”Ÿå®•æœºé‡å¯åï¼Œå¯é€šè¿‡redo logå°†æœªè½ç›˜çš„æ•°æ®æ¢å¤ï¼Œå³ä¿è¯å·²ç»æäº¤çš„äº‹åŠ¡è®°å½•ä¸ä¼šä¸¢å¤±ã€‚\n\nè€Œbinlog å±äºé€»è¾‘æ—¥å¿—ï¼Œå±äºserverå±‚çš„æ—¥å¿—ï¼Œå¯ä»¥è®°å½•å„ä¸ªå­˜å‚¨å¼•æ“çš„æ•°æ®å˜æ›´è®°å½•ï¼Œæ˜¯äº‹åŠ¡æäº¤ä¹‹åçš„æ•°æ®å˜æ›´æ—¥å¿—ã€‚\nredo logå¯ä»¥ä½œä¸ºå¼‚å¸¸downæœºæˆ–è€…ä»‹è´¨æ•…éšœåçš„æ•°æ®æ¢å¤ä½¿ç”¨ï¼Œè€Œbinlogå¯ä»¥ä½œä¸ºè¯¯åˆ æ•°æ®æ¢å¤æ•°æ®ä½¿ç”¨ï¼Œ binlogæ—¥å¿—è¿˜ç”¨äºä¸»ä»æ•°æ®åº“çš„æ•°æ®åŒæ­¥ã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584534588,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125960,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1566283322,"is_pvip":false,"replies":[{"id":"50392","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567947251,"ip_address":"","comment_id":125960,"utype":1}],"discussion_count":1,"race_medal":0,"score":"53105890874","product_id":100028001,"comment_content":"æˆ‘æ¥å›ç­”ä¸€ä¸‹æ€è€ƒé¢˜ï¼š<br>InnoDB çš„ç¼“å­˜æ·˜æ±°ç­–ç•¥æ˜¯åˆ†ä»£çš„ï¼Œåˆ†ä¸ºè€å¹´ä»£å’Œæ–°ç”Ÿä»£ï¼Œå¤§è‡´æ˜¯7ï¼š3ï¼Œæ–°æ•°æ®æ€»æ˜¯å…ˆåŠ å…¥åˆ°æ–°ç”Ÿä»£ï¼Œå¦‚æœåœ¨ä¸€å®šæ—¶é—´å†…æœ‰è¢«å†æ¬¡æŸ¥è¯¢ï¼Œæ‰ä¼šè¿›å…¥åˆ°è€å¹´ä»£ã€‚è€å¹´ä»£å’Œæ–°ç”Ÿä»£å†…éƒ¨éƒ½æ˜¯LRUç®—æ³•æ¥æ·˜æ±°ç¼“å­˜é¡µçš„ã€‚","like_count":13,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463767,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567947251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126285,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1566357050,"is_pvip":false,"replies":[{"id":"46833","content":"æ˜¯çš„ï¼ŒMySQL8.0ç‰ˆæœ¬å·²ç»ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼Œæˆ‘ä»¬æ–‡ä¸­ä¹Ÿæåˆ°äº†å…¶ä¸­çš„å¼Šç«¯ã€‚MySQLå®˜æ–¹å»ºè®®ä½¿ç”¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ç¼“å­˜æˆ–ProxySQLä½œä¸ºä¸­é—´ç¼“å­˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566439727,"ip_address":"","comment_id":126285,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23041193530","product_id":100028001,"comment_content":"mysql8.0å·²ç»æ²¡æœ‰ç”¨æŸ¥è¯¢ç¼“å­˜äº†","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463924,"discussion_content":"æ˜¯çš„ï¼ŒMySQL8.0ç‰ˆæœ¬å·²ç»ä¸æ”¯æŒæŸ¥è¯¢ç¼“å­˜ï¼Œæˆ‘ä»¬æ–‡ä¸­ä¹Ÿæåˆ°äº†å…¶ä¸­çš„å¼Šç«¯ã€‚MySQLå®˜æ–¹å»ºè®®ä½¿ç”¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ç¼“å­˜æˆ–ProxySQLä½œä¸ºä¸­é—´ç¼“å­˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566439727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307497,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg","nickname":"ä¹¦ç­–ç¨ æµŠ","note":"","ucode":"A29875CE15FDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390815,"discussion_content":"æ–‡ä¸­å¥½åƒä¹Ÿæ²¡è¯´åˆ°æœ‰å•¥å¼Šç«¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630056330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125888,"user_name":"LW","can_delete":false,"product_type":"c1","uid":1325297,"ip_address":"","ucode":"89820332658E98","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/f1/996a070d.jpg","comment_is_top":false,"comment_ctime":1566268556,"is_pvip":false,"replies":[{"id":"50393","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567947278,"ip_address":"","comment_id":125888,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23041105036","product_id":100028001,"comment_content":"IBPé€šè¿‡LRUé“¾è¡¨ç®¡ç†çƒ­ç‚¹æ•°æ®å’Œæ·˜æ±°éçƒ­ç‚¹æ•°æ®ï¼ŒLRUæœ¬èº«åˆ†ä¸ºä¸¤å¤§åŒºåŸŸï¼ŒyoungåŒºåŸŸå’ŒoldåŒºåŸŸï¼Œçƒ­ç‚¹æ•°æ®åœ¨youngåŒºï¼Œéçƒ­ç‚¹æ•°æ®åœ¨oldåŒºã€‚å…¶å®LRUçš„åˆ’åˆ†è¿˜æ›´ç»†è‡´ï¼ŒyoungåŒºè¿˜åˆ’åˆ†æˆå‡ ä¸ªä¸åŒçš„åŒºåŸŸã€‚","like_count":5,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463736,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567947278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":125771,"user_name":"è¶…å¨ä¸¶","can_delete":false,"product_type":"c1","uid":1180753,"ip_address":"","ucode":"1A18DE885D3C44","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/51/da465a93.jpg","comment_is_top":false,"comment_ctime":1566259855,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23041096335","product_id":100028001,"comment_content":"å…¶å®å†…å­˜åˆ†é…ä¹Ÿæ˜¯åˆ†äº†æ–°è€åŒºï¼Œé˜²æ­¢å¤§é‡çš„å†å²æ•°æ®æ•°æ®çš„æŸ¥è¯¢å ç”¨æ•´ä¸ªå†…å­˜ï¼Œçƒ­ç‚¹æ•°æ®ç¼“å­˜å‘½ä¸­ç‡é™ä½ï¼Œä¸æ­¢æ˜¯LRUæ·˜æ±°è¿™ä¹ˆç®€å•","like_count":5},{"had_liked":false,"id":125813,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1566262042,"is_pvip":false,"replies":[{"id":"50395","content":"æœ‰ä¸åŒçš„ç­–ç•¥ï¼Œå¯ä»¥å®ç°åŒæ­¥å’Œå¼‚æ­¥","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567947654,"ip_address":"","comment_id":125813,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14451163930","product_id":100028001,"comment_content":"è€å¸ˆå¥½!é—®ä¸ªé—®é¢˜ï¼Œè¿™äº›IOæ“ä½œï¼Œæ˜¯åŒæ­¥é˜»å¡ï¼Œè¿˜æ˜¯åŒæ­¥éé˜»å¡å•Š?","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463702,"discussion_content":"æœ‰ä¸åŒçš„ç­–ç•¥ï¼Œå¯ä»¥å®ç°åŒæ­¥å’Œå¼‚æ­¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567947654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1211223,"avatar":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","nickname":"QQæ€ª","note":"","ucode":"1A39B8433D9208","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5485,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566296661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":352384,"user_name":"å†‰","can_delete":false,"product_type":"c1","uid":1136462,"ip_address":"","ucode":"72E88C227C02CD","user_header":"https://static001.geekbang.org/account/avatar/00/11/57/4e/dd45e359.jpg","comment_is_top":false,"comment_ctime":1658630587,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658630587","product_id":100028001,"comment_content":"è¯´å®è¯è€å¸ˆè¿™ä¸ªä¸“æ çš„è´¨é‡ç¡®å®å¾ˆé«˜ï¼Œå¹²è´§æ»¡æ»¡ï¼Œè¿™æ˜¯æˆ‘çœ‹ç¬¬äºŒéï¼Œæ¯æ¬¡çœ‹éƒ½æœ‰æ”¶è·","like_count":0},{"had_liked":false,"id":270886,"user_name":"æƒ˜ é—»","can_delete":false,"product_type":"c1","uid":1181650,"ip_address":"","ucode":"C5909F034BF072","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","comment_is_top":false,"comment_ctime":1609312411,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1609312411","product_id":100028001,"comment_content":"innodb_flush_log_at_trx_commit<br>å½“è®¾ç½®è¯¥å‚æ•°ä¸º  2  æ—¶ï¼Œæ¯æ¬¡äº‹åŠ¡çš„ redo log éƒ½ä¼šç›´æ¥å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå†å°†æ–‡ä»¶åˆ·æ–°åˆ°ç£ç›˜ã€‚<br>è€Œåœ¨ä¸€äº›å¯ä»¥å®¹å¿æ•°æ®åº“å´©æºƒæ—¶ä¸¢å¤± 1s æ•°æ®çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥å€¼è®¾ç½®ä¸º 0 æˆ– 2ï¼Œè¿™æ ·å¯ä»¥æ˜æ˜¾åœ°å‡å°‘æ—¥å¿—åŒæ­¥åˆ°ç£ç›˜çš„ I&#47;O æ“ä½œã€‚<br>è€å¸ˆè¿™é‡Œè®¾ç½®ä¸ºäºŒæ˜¯å…ˆå†™å…¥ç¼“å­˜æ–‡ä»¶ä¸­,ç„¶åè¿‡æ®µæ—¶é—´å†åˆ·å…¥ç£ç›˜å—?<br><br><br>","like_count":0,"discussions":[{"author":{"id":2166073,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/k3YD3y3BzGDSdrwRJyJY4BXsNJibfM4uzOdDVKIAlFApR2FZCLg2ibrZtJ4vuahA3LHLW9GKzH5CMGqCDhWjhZqg/132","nickname":"æˆ’é…’çš„æç™½","note":"","ucode":"744E1A22761647","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574742,"discussion_content":"2æ˜¯æŒ‡å†™å…¥æ“ä½œç³»ç»ŸPage Cacheåç›´æ¥è¿”å›ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚æ“ä½œç³»ç»Ÿä¼šå®šæœŸè°ƒç”¨fsyncå°†Page Cacheä¸­çš„å†…å®¹åˆ·æ–°åˆ°ç£ç›˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654311596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264764,"user_name":"æ°´æµ´æ¸…é£","can_delete":false,"product_type":"c1","uid":1133926,"ip_address":"","ucode":"36EF5179E6F952","user_header":"https://static001.geekbang.org/account/avatar/00/11/4d/66/28742ad4.jpg","comment_is_top":false,"comment_ctime":1606637266,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606637266","product_id":100028001,"comment_content":"åœ¨æ›´æ–°æ“ä½œæ—¶ï¼Œæ—¢ç„¶å·²ç»è®°å½•äº†binlogï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦redoæ—¥å¿—ï¼Œbinlogä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯crash-safe","like_count":0},{"had_liked":false,"id":229209,"user_name":"Better me","can_delete":false,"product_type":"c1","uid":1261959,"ip_address":"","ucode":"CADF08D357489A","user_header":"https://static001.geekbang.org/account/avatar/00/13/41/87/46d7e1c2.jpg","comment_is_top":false,"comment_ctime":1592923754,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1592923754","product_id":100028001,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸‹å½“innodb_flush_log_at_trx_commit=2ï¼ŒMySQLå¼‚å¸¸å®•æœºæ˜¯ä¼šå‘ç”Ÿä¸¢æ•°æ®çš„æƒ…å†µå—","like_count":0,"discussions":[{"author":{"id":1189225,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIlRVTQ1mpTLY34BAje4xRY0PFSJk6J1su2jicrtEQASP3DakQ7lQkWZNADoh8mLibwATLJB9EMrIVQ/132","nickname":"Z","note":"","ucode":"C199B14177A951","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298144,"discussion_content":"æ•°æ®åº“å®•æœºä¸ä¼šä¸¢ï¼Œæ“ä½œç³»ç»Ÿå®•æœºä¼šä¸¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1597203204,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226296,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1592027892,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1592027892","product_id":100028001,"comment_content":"è€å¸ˆï¼Œé€šå¸¸ï¼Œå»ºè®® innodb_buffer_pool_instances çš„å¤§å°ä¸è¶…è¿‡ innodb_read_io_threads + innodb_write_io_threads ä¹‹å’Œï¼Œå»ºè®®å®ä¾‹å’Œçº¿ç¨‹æ•°é‡æ¯”ä¾‹ä¸º 1:1ã€‚  <br><br>è¿™ä¸ªå»ºè®®å…·ä½“æ˜¯æ ¹æ®ä»€ä¹ˆæ¥åšçš„åˆ¤æ–­å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":226295,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1592027778,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1592027778","product_id":100028001,"comment_content":"è€å¸ˆinnodb_buffer_pool_instances çš„å€¼æ˜¯æŒ‡ ç¼“å†²æ± åˆ’åˆ†åçš„åŒºåŸŸå®ä¾‹çš„æ•°é‡å§ã€‚è€Œå•ä¸ªåŒºåŸŸå®ä¾‹çš„å¤§å°æ€ä¹ˆç¡®å®šå“¦ï¼Ÿ æ˜¯innodb_buffer_pool_size &#47; innodb_buffer_pool_instances  çš„å€¼å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":226286,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1592022363,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1592022363","product_id":100028001,"comment_content":"è€å¸ˆï¼Œå½“Linuxç³»ç»Ÿæ²¡æœ‰é…ç½®SWAP åˆ†åŒºçš„æƒ…å†µä¸‹ï¼Œmysqlåº”è¯¥ä¸ä¼šäº§ç”ŸSWAP é¡µäº¤æ¢å§ã€‚","like_count":0},{"had_liked":false,"id":206959,"user_name":"è¾¾è¾¾é˜Ÿé•¿","can_delete":false,"product_type":"c1","uid":1117597,"ip_address":"","ucode":"1C3F2E4F6B7637","user_header":"https://static001.geekbang.org/account/avatar/00/11/0d/9d/58d09086.jpg","comment_is_top":false,"comment_ctime":1586963760,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1586963760","product_id":100028001,"comment_content":"è€å¸ˆï¼šæ—¥å¿—æ–‡ä»¶è„é¡µçš„ç¼“å­˜æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼Œè„é¡µæ•°æ®æŒ‡çš„æ˜¯ä»€ä¹ˆå‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1622022,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJia6zEsh2u119zJicmq7wApvnricZEKiawaZicice1cOzujWdFicFwPtavlHiaVpCNgCpxBtdl7ynd3y0wkQ/132","nickname":"james_xu","note":"","ucode":"12E50291F5BA89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370030,"discussion_content":"å½“å†…å­˜æ•°æ®é¡µè·Ÿç£ç›˜æ•°æ®é¡µå†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºâ€œè„é¡µâ€ã€‚å†…å­˜æ•°æ®å†™å…¥åˆ°ç£ç›˜åï¼Œå†…å­˜å’Œç£ç›˜ä¸Šçš„æ•°æ®é¡µçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619257452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133334,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568519462,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568519462","product_id":100028001,"comment_content":"å°´å°¬ MySQL ä¸€ç›´ç”¨ä¸è¿‡è‡ªå·±åˆ°æ²¡æ€ä¹ˆè°ƒæ•´è¿‡ä»–çš„é…ç½®å‚æ•°ï¼Œæœ¬åœ°åº“æ²¡ä»€ä¹ˆé—®é¢˜å°±æ˜¯å¼€å‘ä½¿ç”¨ï¼Œç”Ÿäº§åº“åŸºæœ¬å±äºçœ‹ä¸è§æ‘¸ä¸ç€çš„çŠ¶æ€æœ‰ä¸“é—¨çš„DBAæ¥ç»´æŠ¤ï¼ŒOKï¼Œæ‰“å¡ï¼Œè‡ªå·±åœ¨æœ¬åœ°ä¹Ÿå¯ä»¥ç©ä¸€æŠŠ!","like_count":0},{"had_liked":false,"id":132756,"user_name":"DY","can_delete":false,"product_type":"c1","uid":1459006,"ip_address":"","ucode":"55536A524A99B4","user_header":"https://static001.geekbang.org/account/avatar/00/16/43/3e/960d12cb.jpg","comment_is_top":false,"comment_ctime":1568214113,"is_pvip":false,"replies":[{"id":"51122","content":"è¿™ä¸ªæ“ä½œä¸ä¼šå¼•èµ·å›è¡¨","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568536971,"ip_address":"","comment_id":132756,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1568214113","product_id":100028001,"comment_content":"è€å¸ˆï¼Œä½ å¥½ã€‚æœ‰ä¸ªé—®é¢˜è¯·æ•™ä¸‹ã€‚select id from order_detail where order_id between 5000 and 10000ï¼›è¿™ç§sqlæ ¹æ®ç´¢å¼•æŸ¥è¯¢ï¼Œä¸ºä»€ä¹ˆå½“æ¡ä»¶æ˜¯=æ—¶ä¸å›è¡¨ï¼Œæ˜¯åŒºé—´æ®µæ—¶å°±å›è¡¨ã€‚éèšç°‡ç´¢å¼•çš„å¶å­ç»“ç‚¹å­˜æ”¾çš„ä¸æ˜¯ä¸»é”®å—ï¼Ÿæ€ä¹ˆç´¢å¼•æŸ¥è¯¢åŒºé—´æ®µæ—¶å°±å›è¡¨äº†","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467108,"discussion_content":"è¿™ä¸ªæ“ä½œä¸ä¼šå¼•èµ·å›è¡¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568536971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20415,"discussion_content":"ä½ æŸ¥çš„å°±æ˜¯ä¸»é”®ï¼Œå¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ­£å¥½å°±æ˜¯ä½ çš„ä¸»é”®ï¼Œä¸éœ€è¦å›è¡¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569312476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1459006,"avatar":"https://static001.geekbang.org/account/avatar/00/16/43/3e/960d12cb.jpg","nickname":"DY","note":"","ucode":"55536A524A99B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":12751,"discussion_content":"ä½†æ˜¯æ‰§è¡Œè®¡åˆ’æ˜¾ç¤ºçš„æ˜¯Using Where","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568568452,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130697,"user_name":"å¼ å¾·","can_delete":false,"product_type":"c1","uid":1101929,"ip_address":"","ucode":"31FE63E8725EFC","user_header":"https://static001.geekbang.org/account/avatar/00/10/d0/69/5dbdc245.jpg","comment_is_top":false,"comment_ctime":1567513103,"is_pvip":false,"replies":[{"id":"49139","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567596391,"ip_address":"","comment_id":130697,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567513103","product_id":100028001,"comment_content":"è®°å¾—å¥½åƒæ˜¯lruç®—æ³•  æ–°æ—§æ¯”ä¾‹å¥½åƒæ˜¯5æ¯”3","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466074,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567596391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126297,"user_name":"æ™“æ°","can_delete":false,"product_type":"c1","uid":1441546,"ip_address":"","ucode":"1174C88EEBF8A6","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg","comment_is_top":false,"comment_ctime":1566358171,"is_pvip":false,"replies":[{"id":"46834","content":"redo logæ˜¯æ ¹æ®innodb_flush_log_at_trx_commitå‚æ•°æ¥è®¾ç½®åˆ·æ–°åˆ°ç£ç›˜çš„ç­–ç•¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1566440141,"ip_address":"","comment_id":126297,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566358171","product_id":100028001,"comment_content":"è€å¸ˆï¼Œredo logå’Œbin logå¥½åƒä¸æ˜¯åœ¨æ›´æ–°è¯­å¥æäº¤äº‹åŠ¡æˆåŠŸå°±åˆ·æ–°åˆ°ç£ç›˜çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463930,"discussion_content":"redo logæ˜¯æ ¹æ®innodb_flush_log_at_trx_commitå‚æ•°æ¥è®¾ç½®åˆ·æ–°åˆ°ç£ç›˜çš„ç­–ç•¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566440141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}